head	1.61;
access;
symbols
	OPENBSD_4_8:1.56.0.4
	OPENBSD_4_8_BASE:1.56
	OPENBSD_4_7:1.56.0.2
	OPENBSD_4_7_BASE:1.56
	OPENBSD_4_6:1.53.0.2
	OPENBSD_4_6_BASE:1.53
	OPENBSD_4_5:1.52.0.2
	OPENBSD_4_5_BASE:1.52
	OPENBSD_4_4:1.46.0.2
	OPENBSD_4_4_BASE:1.46
	OPENBSD_4_3:1.43.0.2
	OPENBSD_4_3_BASE:1.43
	OPENBSD_4_2:1.39.0.2
	OPENBSD_4_2_BASE:1.39
	OPENBSD_4_1:1.33.0.2
	OPENBSD_4_1_BASE:1.33
	OPENBSD_4_0:1.20.0.2
	OPENBSD_4_0_BASE:1.20
	OPENBSD_3_9:1.16.0.2
	OPENBSD_3_9_BASE:1.16
	OPENBSD_3_8:1.4.0.2
	OPENBSD_3_8_BASE:1.4
	jolan_2005-may-25:1.1.1.1
	jolan:1.1.1;
locks; strict;
comment	@# @;


1.61
date	2010.10.26.09.09.34;	author landry;	state dead;
branches;
next	1.60;

1.60
date	2010.10.24.21.40.10;	author ajacoutot;	state Exp;
branches;
next	1.59;

1.59
date	2010.10.11.08.19.04;	author jasper;	state Exp;
branches;
next	1.58;

1.58
date	2010.09.30.07.21.20;	author ajacoutot;	state Exp;
branches;
next	1.57;

1.57
date	2010.09.26.20.08.12;	author martynas;	state Exp;
branches;
next	1.56;

1.56
date	2010.01.30.19.08.30;	author jolan;	state Exp;
branches;
next	1.55;

1.55
date	2009.12.22.13.02.12;	author sthen;	state Exp;
branches;
next	1.54;

1.54
date	2009.08.10.06.34.56;	author kili;	state Exp;
branches;
next	1.53;

1.53
date	2009.06.22.10.43.58;	author sthen;	state Exp;
branches;
next	1.52;

1.52
date	2009.02.03.22.22.11;	author martynas;	state Exp;
branches;
next	1.51;

1.51
date	2008.12.19.11.48.26;	author martynas;	state Exp;
branches;
next	1.50;

1.50
date	2008.11.13.17.01.56;	author martynas;	state Exp;
branches;
next	1.49;

1.49
date	2008.10.24.21.01.11;	author jasper;	state Exp;
branches;
next	1.48;

1.48
date	2008.09.26.19.04.26;	author martynas;	state Exp;
branches;
next	1.47;

1.47
date	2008.08.23.22.12.21;	author martynas;	state Exp;
branches;
next	1.46;

1.46
date	2008.07.17.15.38.25;	author martynas;	state Exp;
branches;
next	1.45;

1.45
date	2008.07.08.20.37.30;	author martynas;	state Exp;
branches;
next	1.44;

1.44
date	2008.04.15.09.56.29;	author martynas;	state Exp;
branches;
next	1.43;

1.43
date	2008.02.18.17.10.15;	author martynas;	state Exp;
branches;
next	1.42;

1.42
date	2007.11.13.21.24.47;	author martynas;	state Exp;
branches;
next	1.41;

1.41
date	2007.10.27.23.44.41;	author ajacoutot;	state Exp;
branches;
next	1.40;

1.40
date	2007.09.15.20.38.22;	author merdely;	state Exp;
branches;
next	1.39;

1.39
date	2007.08.08.17.34.41;	author martynas;	state Exp;
branches;
next	1.38;

1.38
date	2007.06.09.17.59.52;	author martynas;	state Exp;
branches;
next	1.37;

1.37
date	2007.06.05.17.39.32;	author ajacoutot;	state Exp;
branches;
next	1.36;

1.36
date	2007.04.07.11.55.17;	author martynas;	state Exp;
branches;
next	1.35;

1.35
date	2007.04.01.13.19.58;	author martynas;	state Exp;
branches;
next	1.34;

1.34
date	2007.04.01.09.36.15;	author martynas;	state Exp;
branches;
next	1.33;

1.33
date	2007.03.04.23.37.27;	author robert;	state Exp;
branches;
next	1.32;

1.32
date	2007.02.23.18.17.17;	author robert;	state Exp;
branches;
next	1.31;

1.31
date	2007.02.22.00.40.59;	author naddy;	state Exp;
branches;
next	1.30;

1.30
date	2007.01.04.20.19.54;	author steven;	state Exp;
branches;
next	1.29;

1.29
date	2006.12.27.16.21.59;	author jolan;	state Exp;
branches;
next	1.28;

1.28
date	2006.12.27.02.55.24;	author jolan;	state Exp;
branches;
next	1.27;

1.27
date	2006.12.23.08.12.45;	author jolan;	state Exp;
branches;
next	1.26;

1.26
date	2006.12.16.12.22.35;	author espie;	state Exp;
branches;
next	1.25;

1.25
date	2006.12.04.09.47.54;	author jolan;	state Exp;
branches;
next	1.24;

1.24
date	2006.11.30.21.07.40;	author kurt;	state Exp;
branches;
next	1.23;

1.23
date	2006.11.17.19.03.14;	author kurt;	state Exp;
branches;
next	1.22;

1.22
date	2006.10.01.22.23.47;	author brad;	state Exp;
branches;
next	1.21;

1.21
date	2006.09.18.12.00.00;	author espie;	state Exp;
branches;
next	1.20;

1.20
date	2006.08.04.00.10.42;	author espie;	state Exp;
branches;
next	1.19;

1.19
date	2006.06.13.13.34.56;	author bernd;	state Exp;
branches;
next	1.18;

1.18
date	2006.04.24.20.03.00;	author kurt;	state Exp;
branches;
next	1.17;

1.17
date	2006.03.27.04.23.29;	author pvalchev;	state Exp;
branches;
next	1.16;

1.16
date	2006.01.17.17.47.26;	author steven;	state Exp;
branches;
next	1.15;

1.15
date	2006.01.14.00.07.31;	author espie;	state Exp;
branches;
next	1.14;

1.14
date	2006.01.11.00.58.56;	author pvalchev;	state Exp;
branches;
next	1.13;

1.13
date	2006.01.10.17.58.47;	author naddy;	state Exp;
branches;
next	1.12;

1.12
date	2005.11.16.11.45.33;	author wilfried;	state Exp;
branches;
next	1.11;

1.11
date	2005.11.08.07.19.07;	author jolan;	state Exp;
branches;
next	1.10;

1.10
date	2005.10.20.16.18.26;	author jolan;	state Exp;
branches;
next	1.9;

1.9
date	2005.10.20.05.32.01;	author jolan;	state Exp;
branches;
next	1.8;

1.8
date	2005.10.02.16.21.10;	author jolan;	state Exp;
branches;
next	1.7;

1.7
date	2005.10.01.00.04.44;	author jolan;	state Exp;
branches;
next	1.6;

1.6
date	2005.09.29.14.45.02;	author jolan;	state Exp;
branches;
next	1.5;

1.5
date	2005.09.20.07.33.00;	author jolan;	state Exp;
branches;
next	1.4;

1.4
date	2005.08.04.05.06.54;	author jolan;	state Exp;
branches;
next	1.3;

1.3
date	2005.07.13.04.49.56;	author jolan;	state Exp;
branches;
next	1.2;

1.2
date	2005.06.09.01.57.22;	author jolan;	state Exp;
branches;
next	1.1;

1.1
date	2005.05.25.06.59.10;	author jolan;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2005.05.25.06.59.10;	author jolan;	state Exp;
branches;
next	;


desc
@@


1.61
log
@Minimo 1.8.1.19 was released >2 years ago, its codebase is ffx-2.x,
unmaintained upstream, etc. Another mozilla port bites the dust.
(i'll port its descendant fennec once ffx4 works, if it works someday..)

no objections from zaurus/arm users (sthen, kili, deraadt, todd...)
agreed by stephan@@ & steven@@ at trofea
@
text
@# $OpenBSD: Makefile,v 1.60 2010/10/24 21:40:10 ajacoutot Exp $

ONLY_FOR_ARCHS=	alpha amd64 arm i386 powerpc sparc64
SHARED_ONLY=	Yes

COMMENT=	small, simple, and powerful web browser for mobile devices
DISTNAME=	minimo-1.8.1.19
REVISION=	5
EPOCH=		0

CATEGORIES=	www
MASTER_SITES=	http://openbsddistfiles.com/martynas/mozilla/minimo/
 
HOMEPAGE=	http://www-archive.mozilla.org/projects/minimo/

MAINTAINER=	Martynas Venckus <martynas@@openbsd.org>

# MPL
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes

MODULES=	devel/gettext

BUILD_DEPENDS=	:zip->=2.3:archivers/zip \
		:unzip-*:archivers/unzip \
		:libIDL-*:devel/libIDL
LIB_DEPENDS=	jpeg.>=62::graphics/jpeg \
		png.>=3::graphics/png \
		gdk-x11-2.0.>=600.0,gtk-x11-2.0.>=600.0::x11/gtk+2 \
		nspr4.>=17,plc4.>=17,plds4.>=17:nspr->=4.6.4p1:devel/nspr \
		nss3.>=19,nssutil3.>=22,smime3.>=19,softokn3.>=19,ssl3.>=19:nss->=3.11.4p1:security/nss
WANTLIB=	X11 Xcomposite Xcursor Xdamage Xext Xfixes Xft Xi Xinerama \
		Xrandr Xrender Xt Xau Xdmcp expat c fontconfig freetype m \
		pthread pthread-stubs xcb z gdk_pixbuf-2.0 \
		atk-1.0.>=1011.0 glib-2.0.>=600.0 gmodule-2.0.>=600.0 \
		gobject-2.0.>=600.0 pango-1.0.>=800.0 pangocairo-1.0 \
		pangoft2-1.0 pixman-1 cairo stdc++ gio-2.0
RUN_DEPENDS=	::devel/desktop-file-utils

NO_REGRESS=	Yes
USE_GMAKE=	Yes
VMEM_WARNING=	Yes

WRKDIST=	${WRKDIR}/mozilla

MODGNU_CONFIG_GUESS_DIRS=	${WRKSRC}/build/autoconf

AUTOCONF_VERSION=2.13
CONFIGURE_STYLE=autoconf no-autoheader
# use system libs
CONFIGURE_ARGS=	--with-system-jpeg=${LOCALBASE}	\
		--with-system-png=${LOCALBASE}	\
		--with-system-zlib=/usr/lib	\
		--with-system-nspr		\
		--with-system-nss		\
		--with-pthreads			\
		--disable-native-uconv

# minimo mozconfig
CONFIGURE_ARGS+=--enable-application=minimo	\
		--enable-default-toolkit=gtk2	\
		--enable-xft			\
		--disable-freetype2		\
		--disable-optimize		\
		--enable-strip			\
		--disable-debug			\
		--disable-shared		\
		--enable-static			\
		--disable-plugins
# things we dont want
CONFIGURE_ARGS+=--disable-installer		\
		--disable-updater		\
		--disable-gnomeui		\
		--disable-gnomevfs		\
		--disable-tests			\
		--disable-reorder
CONFIGURE_ARGS+=--enable-crypto

FLAVORS=debug
FLAVOR?=

.if ${FLAVOR:L:Mdebug}
CONFIGURE_ARGS+=--disable-strip --enable-debug --enable-optimize=-O0
INSTALL_STRIP=
.endif

MAKE_ENV=	MOZ_CO_PROJECT=minimo \
		LD_LIBRARY_PATH="${WRKSRC}/dist/bin" \
		BUILD_OFFICIAL=1 \
		MOZILLA_OFFICIAL=1
CONFIGURE_ENV=	${MAKE_ENV} \
		PKG_CONFIG_PATH="${LOCALBASE}/lib/pkgconfig:${X11BASE}/lib/pkgconfig" \
		topsrcdir=${WRKSRC}

MOB=		${WRKSRC}/dist/bin
MOZ=		${PREFIX}/share/minimo

pre-configure:
	${SUBST_CMD} ${WRKSRC}/embedding/minimo/ipkg/minimo.desktop

do-install:
	${INSTALL_DATA_DIR} ${MOZ}
	${INSTALL_PROGRAM} ${MOB}/minimo ${PREFIX}/bin/
	${INSTALL_DATA_DIR} ${MOZ}/chrome
	${INSTALL_DATA} ${MOB}/chrome/classic.{jar,manifest} \
		${MOB}/chrome/en-US.{jar,manifest} \
		${MOB}/chrome/minimo.{jar,manifest} \
		${MOB}/chrome/minimo-skin.{jar,manifest} \
		${MOB}/chrome/minimo-skin-vga.{jar,manifest} \
		${MOB}/chrome/toolkit.{jar,manifest} \
		${MOB}/chrome/pippki.{jar,manifest} ${MOZ}/chrome/
	${INSTALL_DATA_DIR} ${MOZ}/components
	${INSTALL_DATA} ${MOB}/components/nsHelperAppDlg.js \
		${MOB}/components/nsProgressDialog.js \
		${MOB}/extensions/spatial-navigation@@extensions.mozilla.org/components/* \
		${MOZ}/components/
	${INSTALL_DATA_DIR} ${MOZ}/greprefs
	${INSTALL_DATA} ${MOB}/greprefs/* ${MOZ}/greprefs/
	${INSTALL_DATA_DIR} ${MOZ}/res
	@@cp -fr ${MOB}/res/* ${MOZ}/res/
	@@rm -fr ${MOZ}/res/{samples,throbber,viewer.properties,viewsource.css,hiddenWindow.html,bloatcycle.html}
	${INSTALL_DATA_DIR} ${MOZ}/plugins
	${MOB}/xpt_link ${MOZ}/components/all.xpt ${MOB}/components/*.xpt
	@@cd ${MOZ}/chrome && \
		${UNZIP} classic.jar && \
		rm -rf classic.jar && \
		rm -rf skin/classic/communicator && \
		rm -rf skin/classic/editor && \
		rm -rf skin/classic/messenger && \
		rm -rf skin/classic/navigator && \
		zip -r classic.jar skin && \
		rm -rf skin && \
		${UNZIP} en-US.jar && \
		rm -rf en-US.jar && \
		rm -rf locale/en-US/communicator && \
		rm -rf locale/en-US/navigator && \
		zip -r en-US.jar locale && \
		rm -rf locale
	@@cp -f ${WRKSRC}/minimo/customization/all.js ${MOZ}/greprefs/
	@@cat ${WRKSRC}/minimo/customization/ua.css.additions >> ${MOZ}/res/ua.css
	${INSTALL_DATA_DIR} ${PREFIX}/share/applications/
	${INSTALL_DATA} ${WRKSRC}/embedding/minimo/ipkg/minimo.desktop \
		${PREFIX}/share/applications/
	${INSTALL_DATA_DIR} ${PREFIX}/share/pixmaps/
	${INSTALL_DATA} ${WRKSRC}/embedding/minimo/ipkg/minimo.png \
		${PREFIX}/share/pixmaps/

.include <bsd.port.mk>
@


1.60
log
@Remove USE_X11.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59 2010/10/11 08:19:04 jasper Exp $
@


1.59
log
@- fix WANTLIB after cairo update.

(please note chromium is still broken, but will be dealt with soon)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2010/09/30 07:21:20 ajacoutot Exp $
a43 1
USE_X11=	Yes
@


1.58
log
@Fix DEPENDS after gtk+2 and gdk-pixbuf split.

ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.57 2010/09/26 20:08:12 martynas Exp $
d8 2
a9 1
PKGNAME=	${DISTNAME}p4v0
d39 1
a39 1
		pangoft2-1.0 pixman-1 cairo glitz stdc++ gio-2.0
@


1.57
log
@switch master_sites to openbsddistfiles.com so that the ports are
fetchable again.  reported by hal.gi@@t-online.de via miod@@.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2010/01/30 19:08:30 jolan Exp $
d8 1
a8 1
PKGNAME=	${DISTNAME}p3v0
d30 1
a30 1
		gdk-x11-2.0.>=600.0,gdk_pixbuf-2.0.>=600.0,gtk-x11-2.0.>=600.0::x11/gtk+2 \
d35 1
a35 1
		pthread pthread-stubs xcb z \
@


1.56
log
@fix MASTER_SITES, ok naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55 2009/12/22 13:02:12 sthen Exp $
d11 1
a11 1
MASTER_SITES=	http://openbsddistfiles.org/martynas/mozilla/minimo/
@


1.55
log
@Use @@unexec-delete instead of @@unexec for the *-update-* goos.
prodded by espie@@
discussed with espie@@ ajacoutot@@ landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.54 2009/08/10 06:34:56 kili Exp $
d11 1
a11 1
MASTER_SITES=	http://mirrors.protection.cx/~martynas/mozilla/minimo/
@


1.54
log
@WANTLIB changes after xcb addition and bump.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2009/06/22 10:43:58 sthen Exp $
d8 1
a8 1
PKGNAME=	${DISTNAME}p2v0
@


1.53
log
@sync wantlib, bump.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.52 2009/02/03 22:22:11 martynas Exp $
d8 1
a8 1
PKGNAME=	${DISTNAME}p1v0
d35 1
a35 1
		pthread z \
@


1.52
log
@fix endianness on arm.  tested by, and ok kili@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 2008/12/19 11:48:26 martynas Exp $
d8 1
a8 1
PKGNAME=	${DISTNAME}p0v0
d38 1
a38 1
		pangoft2-1.0 pixman-1 cairo glitz stdc++
@


1.51
log
@update to minimo-1.8.1.19.  this is the last security update for
1.8 branch.  ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2008/11/13 17:01:56 martynas Exp $
d8 1
a8 1
PKGNAME=	${DISTNAME}v0
@


1.50
log
@- security update to minimo-1.8.1.18;  and take maintainer
ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2008/10/24 21:01:11 jasper Exp $
d7 1
a7 1
DISTNAME=	minimo-1.8.1.18
@


1.49
log
@- add .desktop file for minimo

tweak and ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2008/09/26 19:04:26 martynas Exp $
d7 2
a8 2
DISTNAME=	minimo-1.8.1.17
PKGNAME=	${DISTNAME}p0v0
d14 2
@


1.48
log
@security update to minimo-1.8.1.17.  ok kili@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2008/08/23 22:12:21 martynas Exp $
d8 1
a8 1
PKGNAME=	${DISTNAME}v0
d37 1
d98 3
d141 6
@


1.47
log
@- use system libm
- update LIB_DEPENDS, to include nssutil3
- change HOMEPAGE to a working one (www-archive.mozilla.org)
- bump package name
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2008/07/17 15:38:25 martynas Exp $
d7 2
a8 2
DISTNAME=	minimo-1.8.1.16
PKGNAME=	${DISTNAME}p0v0
@


1.46
log
@security update to minimo-1.8.1.16.  MFSA 2008-35, MFSA 2008-34
tested by and ok kili@@, sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2008/07/08 20:37:30 martynas Exp $
d8 1
a8 1
PKGNAME=	${DISTNAME}v0
d13 1
a13 1
HOMEPAGE=	http://www.mozilla.org/projects/minimo/
d30 1
a30 1
		nss3.>=19,smime3.>=19,softokn3.>=19,ssl3.>=19:nss->=3.11.4p1:security/nss
@


1.45
log
@- start normal versioning;  stick with branches of firefox 2 releases,
so that we don't end up with non-stable versions
- security update to minimo-1.8.1.15v0
tested by kili@@ and sthen@@ on arm, i386
ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2008/04/15 09:56:29 martynas Exp $
d7 1
a7 1
DISTNAME=	minimo-1.8.1.15
@


1.44
log
@security update to minimo-20080410
MFSA 2008-19, MFSA 2008-18, MFSA 2008-17, MFSA 2008-16, MFSA 2008-15,
MFSA 2008-14.
ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2008/02/18 17:10:15 martynas Exp $
d7 2
a8 1
DISTNAME=	minimo-20080410
d11 1
a11 2
MASTER_SITES=	http://mirrors.protection.cx/~martynas/mozilla/minimo/ \
		http://www.bsdfrog.org/OpenBSD/distfiles/mozilla/minimo/
d36 1
a36 1
		pangoft2-1.0 cairo glitz stdc++
@


1.43
log
@update to minimo-20080210;  tested on arm by kili@@ and sthen@@
ok kili@@ and sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2007/11/13 21:24:47 martynas Exp $
d7 1
a7 1
DISTNAME=	minimo-20080210
@


1.42
log
@update to minimo-20071108;  testing on zaurus and ok kili@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2007/10/27 23:44:41 ajacoutot Exp $
d7 1
a7 1
DISTNAME=	minimo-20071108
@


1.41
log
@- domain name change; fix MASTER_SITES
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2007/09/15 20:38:22 merdely Exp $
d7 1
a7 1
DISTNAME=	minimo-20070804
d31 3
a33 2
WANTLIB=	X11 Xcursor Xext Xfixes Xft Xi Xinerama Xrandr Xrender \
		Xt Xau Xdmcp expat c fontconfig freetype m pthread z \
a95 3

post-extract:
	@@cp ${FILESDIR}/xptc* ${WRKSRC}/xpcom/reflect/xptcall/src/md/unix/
@


1.40
log
@Remove surrounding quotes from
COMMENT-*/ERRORS/NO_REGRESS/PERMIT_*/REGRESS_IS_INTERACTIVE

Change '.include "bsd.port.mk"' to '.include <bsd.port.mk>' while here
(ok naddy@@)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2007/08/08 17:34:41 martynas Exp $
d11 1
a11 1
		http://www.obsd.fr/OpenBSD/distfiles/mozilla/minimo/
@


1.39
log
@security update to minimo-20070804 which fixes recent gecko
vulnerabilities (and has some minimo-2.0 interface fixes);  ok naddy@@
tested by kili@@ on zaurus, thank you.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2007/06/09 17:59:52 martynas Exp $
d6 1
a6 1
COMMENT=	"small, simple, and powerful web browser for mobile devices"
@


1.38
log
@structurise mirror and s/~jolan/~martynas/; thanks jolan@@ for this
great service
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2007/06/05 17:39:32 ajacoutot Exp $
d7 1
a7 2
DISTNAME=	minimo-20070320
PKGNAME=	${DISTNAME}p0
d31 2
a32 2
WANTLIB=	X11 Xft Xrender Xt Xau Xdmcp expat \
		c fontconfig freetype m pthread z \
@


1.37
log
@- change mirror structure
suggested by martynas@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2007/04/07 11:55:17 martynas Exp $
d11 1
a11 1
MASTER_SITES=	http://mirrors.protection.cx/~jolan/ \
@


1.36
log
@ajacoutot@@ provides mirror too!
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2007/04/01 13:19:58 martynas Exp $
d12 1
a12 1
		http://www.obsd.fr/OpenBSD/distfiles/
@


1.35
log
@more work on minimo:
- WANTLIB for xenocara;
- fix initxpcom crashes with HACK_AROUND_NONREENTRANT_INITXPCOM;
- respect the layout, data files belong to /usr/local/share/minimo;
- respect homepage;
- cleanup;
"looks ok" robert@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2007/04/01 09:36:15 martynas Exp $
d11 2
a12 1
MASTER_SITES=	http://mirrors.protection.cx/~jolan/
@


1.34
log
@- update to minimo-20070320 -- 4 months with lots of changes, including
security fixes, and the wholly new interface;
- don't force optimizations;
- use external nss;
ok kili@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2007/03/04 23:37:27 robert Exp $
d8 1
a8 1
SO_VERSION=	4.0
d31 1
a31 1
WANTLIB=	X11 Xext Xft Xrender Xt Xcursor Xfixes Xi Xinerama Xrandr \
d88 1
a88 2
		MOZILLA_OFFICIAL=1 \
		SO_VERSION=${SO_VERSION}
d94 1
a94 1
MOZ=		${PREFIX}/minimo
d101 1
a101 1
	${INSTALL_PROGRAM} ${MOB}/minimo ${MOZ}/
a138 3
	${INSTALL_SCRIPT} ${FILESDIR}/minimo ${PREFIX}/bin/ && \
		perl -pi -e 's|!!LOCALBASE!!|${LOCALBASE}|g' \
			${PREFIX}/bin/minimo
@


1.33
log
@use more saner defaults for minimo:
- disable SSR mode
- set the default page to a blank one
- do not hide the nav-bar in full screen mode

ok pvalchev@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2007/02/23 18:17:17 robert Exp $
d7 1
a7 2
DISTNAME=	minimo-20061120
PKGNAME=	${DISTNAME}p6
a8 5
# NOTE: Must bump minor version if any shlib's are removed from the
# components dir to avoid pkg_add -r issues.
.for _lib in freebl3 nssckbi softokn3 nss3 smime3 ssl3
SHARED_LIBS+=	${_lib} ${SO_VERSION}
.endfor
d29 3
a31 2
		nspr4.>=17,plc4.>=17,plds4.>=17:nspr->=4.6.4p1:devel/nspr
WANTLIB=	X11 Xext Xft Xrender Xt \
d35 1
a35 2
		pangoft2-1.0 cairo glitz
WANTLIB+=	stdc++
d53 1
d62 1
a62 1
		--enable-optimize=-Os		\
d89 1
a89 2
		SO_VERSION=${SO_VERSION} \
		NSS_ENABLE_ECC=1
d91 2
a92 1
		PKG_CONFIG_PATH="${LOCALBASE}/lib/pkgconfig:${X11BASE}/lib/pkgconfig"
a101 3
	@@cd ${MOB} && ${TAR} -chf - *.so.${SO_VERSION} | \
		${TAR} -xf - -C ${MOZ}
	@@chmod 444 ${MOZ}/*.so.${SO_VERSION}
@


1.32
log
@implement xptcinvoke and xptcstubs for arm based on the linux code,
and fix an endianess issue that makes minimo work on arm based
architectures;

the problem has been fixed by Martynas Venckus;
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2007/02/22 00:40:59 naddy Exp $
d8 1
a8 1
PKGNAME=	${DISTNAME}p5
@


1.31
log
@LP64 fix for XUL templates builder; from Martynas Venckus
ok sturm@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2007/01/04 20:19:54 steven Exp $
d8 1
a8 1
PKGNAME=	${DISTNAME}p4
@


1.30
log
@fix WANTLIB of ports using gtk, needed after switch to our own pkg-config
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2006/12/27 16:21:59 jolan Exp $
d8 1
a8 1
PKGNAME=	${DISTNAME}p3
@


1.29
log
@- fix xml parser
- let it run on sparc64 again

from martynas venckus
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2006/12/27 02:55:24 jolan Exp $
d8 1
a8 1
PKGNAME=	${DISTNAME}p2
d40 1
a40 1
		pangoft2-1.0 cairo
@


1.28
log
@add back debug flavor
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2006/12/23 08:12:45 jolan Exp $
d8 1
a8 1
PKGNAME=	${DISTNAME}p1
@


1.27
log
@make startup homepage override work properly, from martynas venckus
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2006/12/16 12:22:35 espie Exp $
d8 1
a8 1
PKGNAME=	${DISTNAME}p0
d81 8
@


1.26
log
@say goodbye to GNU land.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2006/12/04 09:47:54 jolan Exp $
d8 1
@


1.25
log
@update to 20061120, from Martynas Venckus
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2006/11/17 19:03:14 kurt Exp $
d30 1
a30 2
		:libIDL-*:devel/libIDL \
		:pkgconfig-*:devel/pkgconfig
@


1.24
log
@- require nspr with PR_GetLibraryName fix
- bump major due to previous nspr removal
@
text
@d3 1
a3 1
ONLY_FOR_ARCHS=	alpha amd64 i386 powerpc sparc64 arm
d6 3
a8 4
COMMENT=	"mini mozilla"
DISTNAME=	minimo-20050802
PKGNAME=	${DISTNAME}p11
SO_VERSION=	3.0
d11 1
a11 7
.for _lib in DebugRobot MyService caps chrmlite docshell editor \
	embedcomponents gfx_gtk gkgfx gklayout gtkembedmoz gtkxtbin htmlpars \
	i18n imglib2 jar50 jsj mork mozjs necko nsappshell nss3 nssckbi \
	oji pipboot pipnss popuplite pref remoteservice \
	searchservice smime3 softkey softokn3 ssl3 testdynamic txmgr uconv \
	webbrwsr widget_gtk2 xpcom xpcom_compat xpcom_compat_c xpcom_core \
	xpcomsample xpconnect xpctest
d36 1
a36 1
WANTLIB=	ICE SM X11 Xext Xft Xrender Xt \
a46 1
SUBST_VARS=	LOCALBASE SO_VERSION
d50 1
a50 2
MODGNU_CONFIG_GUESS_DIRS=	${WRKSRC}/build/autoconf \
				${WRKSRC}/directory/c-sdk/config/autoconf
d52 38
a89 59
AUTOCONF_VERSION= 2.13
CONFIGURE_STYLE= autoconf no-autoheader
CONFIGURE_ARGS+=						\
		--with-system-jpeg=${LOCALBASE}			\
		--with-system-png=${LOCALBASE}			\
		--with-system-zlib=/usr/lib			\
		--with-system-nspr				\
		--with-pthreads					\
		--enable-optimize=-Os				\
		--disable-pedantic				\
		--disable-debug					\
		--disable-v1-string-abi				\
		--enable-default-toolkit=gtk2			\
		--enable-xft					\
		--disable-freetype2				\
		--disable-xul					\
		--disable-profilesharing			\
		--disable-profilelocking			\
		--enable-single-profile				\
		--disable-extensions				\
		--disable-accessibility				\
		--disable-composer				\
		--enable-plaintext-editor-only			\
		--disable-mailnews				\
		--disable-ldap					\
		--disable-postscript				\
		--disable-mathml				\
		--disable-jsd					\
		--disable-jsloader				\
		--disable-installer				\
		--disable-xpinstall				\
		--disable-xpfe-components			\
		--disable-xprint				\
		--disable-necko-disk-cache			\
		--disable-plugins				\
		--enable-necko-small-buffers			\
		--disable-dtd-debug				\
		--disable-logging				\
		--disable-tests					\
		--enable-crypto					\
		--enable-necko-protocols=http,file,res,jar	\
		--enable-image-decoders=png,gif,jpeg 		\
		--enable-application=suite

FLAVORS=	debug
FLAVOR?=

.if ${FLAVOR:L:Mdebug}
CONFIGURE_ARGS+=--enable-debug --enable-optimize=-O0 --enable-tests
INSTALL_STRIP=
.endif

CONFIGURE_ENV=	PKG_CONFIG_PATH="${LOCALBASE}/lib/pkgconfig:${X11BASE}/lib/pkgconfig" \
		MINIMO=1 \
		SO_VERSION=${SO_VERSION}

MAKE_ENV=	LD_LIBRARY_PATH="${WRKSRC}/dist/bin" \
		MINIMO=1 \
		SO_VERSION=${SO_VERSION}
d91 1
a91 1
MOB=		${WRKSRC}/dist
a96 12
pre-configure:
	@@cd ${WRKSRC}/directory/c-sdk && ${SETENV} ${AUTOCONF_ENV} ${AUTOCONF}
	@@perl -pi -e 's|_LOCALBASE_|${LOCALBASE}|g; s|_X11BASE_|${X11BASE}|g' \
		${WRKSRC}/xpfe/bootstrap/mozilla.in
	@@perl -pi -e 's|_SO_VERSION_|${SO_VERSION}|g' \
		${WRKSRC}/xpcom/components/nsNativeComponentLoader.cpp
	touch ${WRKSRC}/embedding/minimo/chrome/skin/m.jpg

post-build:
	cd ${WRKSRC}/embedding/config && ${MAKE_PROGRAM}
	cd ${WRKSRC}/embedding/config && ${MAKE_PROGRAM} merge_xpt

d98 5
a102 3
	mkdir -p ${WRKDIR}/chrome
	${UNZIP} -jod ${WRKDIR}/chrome \
		${WRKSRC}/dist/Embed/chrome/embed.jar
d104 12
a115 6
	${INSTALL_DATA} ${WRKDIR}/chrome/* ${MOZ}/chrome
.for dir in components greprefs res
	${INSTALL_DATA_DIR} ${MOZ}/${dir}
	@@cd ${MOB}/bin && ${TAR} -chf - ${dir} | \
		${TAR} -xf - -C ${MOZ}
.endfor
d117 26
a142 13
	${INSTALL_DATA} ${MOB}/bin/greprefs/* ${MOZ}/greprefs
	${INSTALL_DATA} ${WRKSRC}/embedding/minimo/all.js \
		${MOZ}/greprefs
	@@cd ${MOB}/bin && ${TAR} -chf - *.so.?.? | \
		${TAR} -xf - -C ${MOZ}
	@@chmod 444 ${MOZ}/*.so.?.? ${MOZ}/components/*.so.?.? ${MOZ}/components/*.js
	${INSTALL_PROGRAM} ${MOB}/bin/regxpcom ${MOZ}
	${INSTALL_PROGRAM} ${MOB}/bin/Minimo ${MOZ}/minimo-bin
	sed s,mozilla-bin,minimo-bin,g ${MOB}/bin/run-mozilla.sh > \
		${MOB}/bin/run-minimo.sh
	${INSTALL_DATA} ${WRKSRC}/LICENSE ${FILESDIR}/TODO ${MOZ}
	${INSTALL_SCRIPT} ${MOB}/bin/run-minimo.sh ${MOZ}
	${INSTALL_SCRIPT} ${FILESDIR}/minimo ${PREFIX}/bin
@


1.23
log
@use devel/nspr instead of internal nspr. now using libc strtod and __dtoa
via devel/nspr. okay pvalchev@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2006/10/01 22:23:47 brad Exp $
d8 2
a9 2
PKGNAME=	${DISTNAME}p10
SO_VERSION=	2.0
d42 1
a42 1
		nspr4.>=17,plc4.>=17,plds4.>=17:nspr->=4.6.3p2:devel/nspr
@


1.22
log
@stop using the gcc3 module on the alpha architecture.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2006/09/18 12:00:00 espie Exp $
d8 1
a8 1
PKGNAME=	${DISTNAME}p9
d14 2
a15 2
	i18n imglib2 jar50 jsj mork mozjs necko nsappshell nspr4 nss3 nssckbi \
	oji pipboot pipnss plc4 plds4 popuplite pref remoteservice \
d41 2
a42 1
		gdk-x11-2.0.>=600.0,gdk_pixbuf-2.0.>=600.0,gtk-x11-2.0.>=600.0::x11/gtk+2
a58 1
				${WRKSRC}/nsprpub/build/autoconf \
d67 1
a68 1
		--without-system-nspr				\
a127 1
	@@cd ${WRKSRC}/nsprpub && ${SETENV} ${AUTOCONF_ENV} ${AUTOCONF}
a131 1
		${WRKSRC}/nsprpub/pr/include/md/_openbsd.h \
@


1.21
log
@zap .0.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2006/08/04 00:10:42 espie Exp $
d8 1
a8 1
PKGNAME=	${DISTNAME}p8
d33 1
a33 3
MODULES=	devel/gettext gcc3
MODGCC3_ARCHES=	alpha
MODGCC3_LANGS=	C++
a46 1
.if empty(MACHINE_ARCH:Malpha)
a47 1
.endif
@


1.20
log
@new lib specs
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2006/06/13 13:34:56 bernd Exp $
d47 2
a48 2
		gobject-2.0.>=600.0 pango-1.0.>=800.0 pangocairo-1.0.0.0 \
		pangoft2-1.0.0.0 cairo
@


1.19
log
@Fix WANTLIB after gtk+2 upgrade.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2006/04/24 20:03:00 kurt Exp $
d41 3
a43 3
LIB_DEPENDS=	jpeg.62::graphics/jpeg \
		png.3::graphics/png \
		gdk-x11-2.0.600.0,gdk_pixbuf-2.0.600.0,gtk-x11-2.0.600.0::x11/gtk+2
d46 2
a47 2
		atk-1.0.1011.0 glib-2.0.600.0 gmodule-2.0.600.0 \
		gobject-2.0.600.0 pango-1.0.800.0 pangocairo-1.0.0.0 \
@


1.18
log
@remove freedtoa call since our strtod(3) implementation uses a static var
to handle result allocation, but doesn't always return it. Restore use
of locks to protect use of static vars and add one for dtoa return value
too. fixes build on sparc64 and should help with stablility too.

looks correct pvalchev@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2006/03/27 04:23:29 pvalchev Exp $
d8 1
a8 1
PKGNAME=	${DISTNAME}p7
d47 2
a48 2
		gobject-2.0.600.0 pango-1.0.800.0 pangox-1.0.0.0 \
		pangoxft-1.0.0.0 pangoft2-1.0.0.0
@


1.17
log
@check XftLockFace() for NULL return to avoid a crash, see
https://bugzilla.mozilla.org/show_bug.cgi?id=331077
from Tobias Ulmer <tobiasu@@tmux.org>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2006/01/17 17:47:26 steven Exp $
d8 1
a8 1
PKGNAME=	${DISTNAME}p6
@


1.16
log
@fix WANTLIB after gtk+2 downgrade
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2006/01/14 00:07:31 espie Exp $
d8 1
a8 1
PKGNAME=	${DISTNAME}p5
@


1.15
log
@more C++ libs bumps. Done thru mail, plus lizards.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2006/01/11 00:58:56 pvalchev Exp $
d8 1
a8 1
PKGNAME=	${DISTNAME}p4
d44 5
a48 4
WANTLIB=	ICE SM X11 Xft Xrender Xt c fontconfig freetype m pthread z \
		atk-1.0.1011.0 cairo glib-2.0.600.0 gmodule-2.0.600.0 \
		gobject-2.0.600.0 pango-1.0.800.0 pangocairo-1.0.0.0 \
		pangoft2-1.0.0.0
@


1.14
log
@add ARM configuration and enable on arm; tested on zaurus
XPCOM asm glue still missing, but basically functional
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2006/01/10 17:58:47 naddy Exp $
d8 2
a9 2
PKGNAME=	${DISTNAME}p3
SO_VERSION=	1.0
@


1.13
log
@SHARED_LIBS
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2005/11/16 11:45:33 wilfried Exp $
d3 1
a3 1
ONLY_FOR_ARCHS=	alpha amd64 i386 powerpc sparc64
d8 1
a8 1
PKGNAME=	${DISTNAME}p2
@


1.12
log
@fix wantlib + bump
@
text
@d1 2
a2 1
# $OpenBSD: Makefile,v 1.11 2005/11/08 07:19:07 jolan Exp $
d9 13
a23 4

# NOTE: Must bump minor version if any shlib's are removed from the
# components dir to avoid pkg_add -r issues.
SO_VERSION=	1.0
@


1.11
log
@split debug stuff into a flavor, shrinks minimo by a factor of ten
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2005/10/20 16:18:26 jolan Exp $
d7 1
a7 1
PKGNAME=	${DISTNAME}p1
d35 3
a37 3
		atk-1.0.1011.0 glib-2.0.600.0 gmodule-2.0.600.0 \
		gobject-2.0.600.0 pango-1.0.800.0 pangox-1.0.800.0 \
		pangoxft-1.0.800.0
@


1.10
log
@might as well make this work on i386 too
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2005/10/20 05:32:01 jolan Exp $
d3 1
d7 1
a7 1
PKGNAME=	${DISTNAME}p0
d98 4
d104 1
a108 1
#ac_cv_cpp_dynamic_cast_void_ptr="no"
@


1.9
log
@remove 'don't close dlopened objects' ld.so workaround like kurt
did for other mozillaware
@
text
@d1 2
a2 2
# $OpenBSD: Makefile,v 1.8 2005/10/02 16:21:10 jolan Exp $
ONLY_FOR_ARCHS=	alpha amd64 powerpc sparc64
@


1.8
log
@enable on powerpc
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2005/10/01 00:04:44 jolan Exp $
d6 1
@


1.7
log
@add alpha support
@
text
@d1 2
a2 2
# $OpenBSD: Makefile,v 1.6 2005/09/29 14:45:02 jolan Exp $
ONLY_FOR_ARCHS=	alpha amd64 sparc64
@


1.6
log
@enable on sparc64
@
text
@d1 2
a2 2
# $OpenBSD: Makefile,v 1.5 2005/09/20 07:33:00 jolan Exp $
ONLY_FOR_ARCHS=	amd64 sparc64
d21 3
a23 1
MODULES=	devel/gettext
d32 1
a32 2
WANTLIB=	ICE SM X11 Xft Xrender Xt c fontconfig freetype m pthread \
		stdc++ z \
d36 3
@


1.5
log
@enable minimo since it works on amd64
@
text
@d1 2
a2 2
# $OpenBSD: Makefile,v 1.4 2005/08/04 05:06:54 jolan Exp $
ONLY_FOR_ARCHS=	amd64
@


1.4
log
@update to 20050802 and add some more debug stuff based on what kurt said
on ports@@
@
text
@d1 2
a2 2
# $OpenBSD: Makefile,v 1.3 2005/07/13 04:49:56 jolan Exp $
ONLY_FOR_ARCHS= alpha i386 sparc sparc64 amd64 powerpc
@


1.3
log
@update to 20050712
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2005/06/09 01:57:22 jolan Exp $
d5 1
a5 1
DISTNAME=	minimo-20050712
d92 1
a92 1
CONFIGURE_ARGS+=--enable-debug
d118 1
@


1.2
log
@freshen
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2005/05/25 06:59:10 jolan Exp $
d5 1
a5 1
DISTNAME=	minimo-20050608
d11 1
a11 1
SO_VERSION=	2.0
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.87 2005/04/16 23:54:53 kurt Exp $
d5 1
a5 1
DISTNAME=	minimo-20050524
@


1.1.1.1
log
@minimo-20050524, mini mozilla

this is smaller than firefox and has special handling for small screens
which is useful for machines like the zaurus.  unfortunately, it's not
there yet, see the TODO.  please don't add this to the www Makefile yet.
@
text
@@
