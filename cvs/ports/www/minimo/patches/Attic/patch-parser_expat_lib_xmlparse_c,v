head	1.2;
access;
symbols
	OPENBSD_4_1:1.1.0.2
	OPENBSD_4_1_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2007.04.01.09.36.15;	author martynas;	state dead;
branches;
next	1.1;

1.1
date	2006.12.27.16.21.59;	author jolan;	state Exp;
branches;
next	;


desc
@@


1.2
log
@- update to minimo-20070320 -- 4 months with lots of changes, including
security fixes, and the wholly new interface;
- don't force optimizations;
- use external nss;
ok kili@@
@
text
@$OpenBSD: patch-parser_expat_lib_xmlparse_c,v 1.1 2006/12/27 16:21:59 jolan Exp $
--- parser/expat/lib/xmlparse.c.orig	Sat Nov 11 00:10:16 2006
+++ parser/expat/lib/xmlparse.c	Tue Dec 26 19:10:19 2006
@@@@ -1477,6 +1477,7 @@@@ XML_Parse(XML_Parser parser, const char 
     if (errorCode == XML_ERROR_SUSPENDED) {
       parseEndByteIndex -= parseEndPtr - eventPtr; /* Remove what we haven't read. */
       parseEndPtr = bufferPtr = eventPtr;
+      bufferEnd = (char*)bufferPtr; /* We'll pass in the same data again later. */
       XmlUpdatePosition(encoding, positionPtr, eventPtr, &position);
       return XML_STATUS_ERROR;
     }
@@@@ -1575,6 +1576,7 @@@@ XML_ParseBuffer(XML_Parser parser, int l
   else if (errorCode == XML_ERROR_SUSPENDED) {
     parseEndByteIndex -= parseEndPtr - eventPtr; /* Remove what we haven't read. */
     parseEndPtr = bufferPtr = eventPtr;
+    bufferEnd = (char*)bufferPtr; /* We'll pass in the same data again later. */
     XmlUpdatePosition(encoding, positionPtr, eventPtr, &position);
     return XML_STATUS_ERROR;
   }
@


1.1
log
@- fix xml parser
- let it run on sparc64 again

from martynas venckus
@
text
@d1 1
a1 1
$OpenBSD$
@

