head	1.2;
access;
symbols
	OPENBSD_5_2:1.1.0.8
	OPENBSD_5_2_BASE:1.1
	OPENBSD_5_1_BASE:1.1
	OPENBSD_5_1:1.1.0.6
	OPENBSD_5_0:1.1.0.4
	OPENBSD_5_0_BASE:1.1
	OPENBSD_4_9:1.1.0.2
	OPENBSD_4_9_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2012.12.04.21.10.12;	author landry;	state dead;
branches;
next	1.1;

1.1
date	2011.01.28.21.38.12;	author landry;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Retire www/firefox35.

You served us well but you're EOL'ed upstream since 18 months, and your
only reason d'etre was the java plugin from jdk 1.6. But those days this
one doesnt receive updates from oracle, and icedtea-web seems to do a
good job at running java crapplets.
Users will be upgraded for free to www/mozilla-firefox !

General agreement/yays from ajacoutot@@ tobiasu@@ dcoppa@@ krw@@ kurt@@
@
text
@$OpenBSD: patch-gfx_qcms_iccread_c,v 1.1 2011/01/28 21:38:12 landry Exp $
Fix crash on sparc64
https://bugzilla.mozilla.org/show_bug.cgi?id=629057
http://hg.mozilla.org/mozilla-central/rev/e8207773d54d
--- gfx/qcms/iccread.c.orig	Tue Nov 30 14:49:19 2010
+++ gfx/qcms/iccread.c	Thu Jan 27 23:31:50 2011
@@@@ -87,7 +87,9 @@@@ static uint32_t read_u32(struct mem_source *mem, size_
 		invalid_source(mem, "Invalid offset");
 		return 0;
 	} else {
-		return be32_to_cpu(*(__be32*)(mem->buf + offset));
+		__be32 k;
+		memcpy(&k, mem->buf + offset, sizeof(__be32));
+		return be32_to_cpu(k);
 	}
 }
 
@@@@ -97,7 +99,9 @@@@ static uint16_t read_u16(struct mem_source *mem, size_
 		invalid_source(mem, "Invalid offset");
 		return 0;
 	} else {
-		return be16_to_cpu(*(__be16*)(mem->buf + offset));
+		__be16 k;
+		memcpy(&k, mem->buf + offset, sizeof(__be16));
+		return be16_to_cpu(k);
 	}
 }
 
@


1.1
log
@Fix an unaligned access on sparc64 leading to random crashes when
mozilla tries to read a malformed ICC profile on random image content
found on the web.
backport of http://hg.mozilla.org/mozilla-central/rev/e8207773d54d
ref: https://bugzilla.mozilla.org/show_bug.cgi?id=629057
issue reported and fix found by naddy@@
ok naddy@@ ajacoutot@@
@
text
@d1 1
a1 1
$OpenBSD$
@

