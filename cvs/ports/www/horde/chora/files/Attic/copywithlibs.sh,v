head	1.2;
access;
symbols
	OPENBSD_5_5:1.1.1.1.0.14
	OPENBSD_5_5_BASE:1.1.1.1
	OPENBSD_5_4:1.1.1.1.0.12
	OPENBSD_5_4_BASE:1.1.1.1
	OPENBSD_5_3:1.1.1.1.0.10
	OPENBSD_5_3_BASE:1.1.1.1
	OPENBSD_5_2:1.1.1.1.0.8
	OPENBSD_5_2_BASE:1.1.1.1
	OPENBSD_5_1_BASE:1.1.1.1
	OPENBSD_5_1:1.1.1.1.0.6
	OPENBSD_5_0:1.1.1.1.0.4
	OPENBSD_5_0_BASE:1.1.1.1
	OPENBSD_4_9:1.1.1.1.0.2
	OPENBSD_4_9_BASE:1.1.1.1
	sthen_20100818:1.1.1.1
	sthen:1.1.1;
locks; strict;
comment	@# @;


1.2
date	2014.07.11.00.03.06;	author sthen;	state dead;
branches;
next	1.1;
commitid	XjjZzcN2Fvzlt6Ri;

1.1
date	2010.08.18.15.04.05;	author sthen;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2010.08.18.15.04.05;	author sthen;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Unhook www/horde - these ports are for Horde 3 which is EOL and doesn't work
well with current PHP versions - Horde 5 is maintained upstream but it's split
in 132 pieces which doesn't really fit well with ports, especially as it's
strongly advised to be installed from their PEAR server. For more information,
see http://www.horde.org/apps/groupware/docs/INSTALL

Reminded by Adam Thompson.
@
text
@#!/bin/sh -e
# Copy an executable file/s, complete with libraries, into a chroot jail.
#
# $OpenBSD: copywithlibs.sh,v 1.1 2010/08/18 15:04:05 sthen Exp $
# Copyright (c) 2010 Stuart Henderson <sthen@@openbsd.org>
#
# Permission to use, copy, modify, and distribute this software for any
# purpose with or without fee is hereby granted, provided that the above
# copyright notice and this permission notice appear in all copies.
#
# THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
# WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
# MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
# ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
# WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
# ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
# OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.

MYNAME=`basename $0`
DEST=/var/www

copy_to() {
	local _to=$1
	while [ -n "$2" ]; do
		shift
		if ! diff $1 ${_to} > /dev/null 2>&1; then
			echo copying $1
			install -C $1 ${_to}
		fi
	done
}

copy_with_libs() {
	local _file="$1"
	local _lddmsg
	local _libs
	local _static

	if ! _lddmsg=`ldd "${_file}" 2>&1`; then
		# allow static binaries to be copied, bail for other errors
		if ! echo ${_lddmsg} |
		    fgrep 'not a dynamic executable' > /dev/null; then
			echo $MYNAME: ${_lddmsg}
			return
		fi
	fi

	copy_to ${DEST}/usr/bin ${_file}

	_libs=`ldd "${_file}" 2>/dev/null |
	    awk '/\/usr(\/local)?\/lib\/.*\.so\./ { print $7; }'`

	[ -n "${_libs}" ] && copy_to ${DEST}/usr/lib ${_libs}
}

if [ -z "$1" ]; then
	echo usage: $MYNAME /path/to/program
	exit 1
fi

if [ ! -d "${DEST}" ]; then
	echo $MYNAME: ${DEST} not a directory
	exit 1
fi

if [ ! -w "${DEST}" ]; then
	echo $MYNAME: ${DEST} not writable
	exit 1
fi

install -d ${DEST}/usr/bin ${DEST}/usr/lib ${DEST}/usr/libexec
install -C /usr/libexec/ld.so ${DEST}/usr/libexec

while [ -n "$1" ]; do
	copy_with_libs $1
	shift
done
@


1.1
log
@Initial revision
@
text
@d4 1
a4 1
# $OpenBSD$
@


1.1.1.1
log
@update chora, taking MAINTAINER, and reimport under ports/www/horde/chora.
agreed with avsm@@

Chora is a tool for viewing code repositories that are managed
using the CVS or Subversion source control systems. It aims to
provide a high degree of integration with CVS, SVN and the other
Horde web-based tools.
@
text
@@
