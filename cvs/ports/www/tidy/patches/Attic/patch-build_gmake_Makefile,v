head	1.4;
access;
symbols
	OPENBSD_4_9:1.3.0.18
	OPENBSD_4_9_BASE:1.3
	OPENBSD_4_8:1.3.0.16
	OPENBSD_4_8_BASE:1.3
	OPENBSD_4_7:1.3.0.14
	OPENBSD_4_7_BASE:1.3
	OPENBSD_4_6:1.3.0.12
	OPENBSD_4_6_BASE:1.3
	OPENBSD_4_5:1.3.0.10
	OPENBSD_4_5_BASE:1.3
	OPENBSD_4_4:1.3.0.8
	OPENBSD_4_4_BASE:1.3
	OPENBSD_4_3:1.3.0.6
	OPENBSD_4_3_BASE:1.3
	OPENBSD_4_2:1.3.0.4
	OPENBSD_4_2_BASE:1.3
	OPENBSD_4_1:1.3.0.2
	OPENBSD_4_1_BASE:1.3
	OPENBSD_4_0:1.2.0.6
	OPENBSD_4_0_BASE:1.2
	OPENBSD_3_9:1.2.0.4
	OPENBSD_3_9_BASE:1.2
	OPENBSD_3_8:1.2.0.2
	OPENBSD_3_8_BASE:1.2
	OPENBSD_3_7:1.1.0.6
	OPENBSD_3_7_BASE:1.1
	OPENBSD_3_6:1.1.0.4
	OPENBSD_3_6_BASE:1.1
	OPENBSD_3_5:1.1.0.2
	OPENBSD_3_5_BASE:1.1;
locks; strict;
comment	@# @;


1.4
date	2011.03.15.19.50.52;	author jasper;	state dead;
branches;
next	1.3;

1.3
date	2006.10.18.18.22.56;	author pvalchev;	state Exp;
branches;
next	1.2;

1.2
date	2005.07.19.08.10.10;	author aanriot;	state Exp;
branches;
next	1.1;

1.1
date	2004.03.02.21.20.12;	author xsa;	state Exp;
branches;
next	;


desc
@@


1.4
log
@be gone...unmaintained tidy, superseded by tidyp!

ok sthen@@
@
text
@--- build/gmake/Makefile.orig	Fri Jul 15 08:58:10 2005
+++ build/gmake/Makefile	Wed Oct 18 19:34:22 2006
@@@@ -58,8 +58,8 @@@@ SHELL=/bin/sh
 PROJECT=tidy
 
 # Installation variables.  Spaces OK, only dir create and file copy operations.
-runinst_prefix=/usr/local
-devinst_prefix=/usr/local
+runinst_prefix=${PREFIX}
+devinst_prefix=${PREFIX}
 
 bininst = ${runinst_prefix}/bin
 libinst = ${devinst_prefix}/lib
@@@@ -79,13 +79,13 @@@@ DOCDIR = ${TOPDIR}/htmldoc
 # CFLAGS etc..
 # For optimised builds, flags such as "-O2" should be added and -D_DEBUG=1
 # disabled.
-CC= gcc
-CFLAGS= -g -Wall -Wno-switch -Wno-parentheses -I $(INCDIR)
+#CC= gcc
+CFLAGS+= -fPIC -I $(INCDIR)
 # flags only supported with gcc 3.x
 # CFLAGS += -Wunused-parameter
 
 OTHERCFLAGS=
-OTHERCFLAGS+= -D_DEBUG=1
+#OTHERCFLAGS+= -D_DEBUG=1
 # OTHERCFLAGS+= -DSUPPORT_ACCESSIBILITY_CHECKS=1 -DSUPPORT_UTF16_ENCODINGS=1 -DSUPPORT_ASIAN_ENCODINGS=1
 ifdef SUPPORT_UTF16_ENCODINGS
 CFLAGS += -DSUPPORT_UTF16_ENCODINGS=$(SUPPORT_UTF16_ENCODINGS)
@@@@ -112,10 +112,12 @@@@ TIDY_MINOR = 0
 # This will come from autoconf again
 LIBPREFIX = lib
 LIBSUFFIX = .a
+SHAREDLIBSUFFIX = .so
 OBJSUF = .o
 
 LIBRARY = $(LIBDIR)/$(LIBPREFIX)$(PROJECT)$(LIBSUFFIX)
-AR=ar -r
+SHAREDLIBRARY = $(LIBDIR)/$(LIBPREFIX)$(PROJECT)$(SHAREDLIBSUFFIX).$(TIDY_MAJOR).$(TIDY_MINOR)
+#AR=ar -r
 
 XSLTPROC = xsltproc
 
@@@@ -158,17 +160,21 @@@@ LIBHFILES= \
         $(SRCDIR)/tidy-int.h
 
 
-all:    $(LIBRARY) $(EXES)
+all:    $(LIBRARY) $(SHAREDLIBRARY) $(EXES)
 
 doc:    $(DOCS)
 
 $(LIBRARY): $(OBJFILES)
 	if [ ! -d $(LIBDIR) ]; then mkdir $(LIBDIR); fi
-	$(AR) $@@ $(OBJFILES)
+	$(AR) -r $@@ $(OBJFILES)
 ifdef RANLIB
 	$(RANLIB) $@@
 endif
 
+$(SHAREDLIBRARY): $(OBJFILES)
+	if [ ! -d $(LIBDIR) ]; then mkdir $(LIBDIR); fi
+	$(CC) -shared -fPIC -o $(SHAREDLIBRARY) $(OBJFILES)
+
 $(OBJDIR)/%$(OBJSUF):	$(SRCDIR)/%.c $(HFILES) $(LIBHFILES) Makefile
 	if [ ! -d $(OBJDIR) ]; then mkdir $(OBJDIR); fi
 	$(CC) $(CFLAGS) $(OTHERCFLAGS) -o $@@ -c $<
@@@@ -182,10 +188,10 @@@@ $(BINDIR)/tab2space: $(APPDIR)/tab2space
 	$(CC) $(CFLAGS) $(OTHERCFLAGS) -o $@@ $(APPDIR)/tab2space.c $(LIBS)
 
 $(HELPXML): $(BINDIR)/$(PROJECT)
-	$(BINDIR)/$(PROJECT) -xml-help > $@@
+	LD_LIBRARY_PATH=$(libinst) $(bininst)/$(PROJECT) -xml-help > $@@
 
 $(CONFIGXML): $(BINDIR)/$(PROJECT)
-	$(BINDIR)/$(PROJECT) -xml-config > $@@
+	LD_LIBRARY_PATH=$(libinst) $(bininst)/$(PROJECT) -xml-config > $@@
 
 $(DOCDIR)/quickref.html: $(DOCDIR)/quickref-html.xsl $(CONFIGXML)
 	$(XSLTPROC) -o $@@ $(DOCDIR)/quickref-html.xsl $(CONFIGXML)
@@@@ -205,19 +211,20 @@@@ clean:
 	if [ "$(BINDIR)" != "$(TOPDIR)" -a -d $(BINDIR) ]; then rmdir $(BINDIR); fi
 
 installhdrs: $(HFILES)
-	if [ ! -d "$(incinst)" ]; then mkdir -p "$(incinst)"; fi
+	if [ ! -d "$(incinst)" ]; then ${BSD_INSTALL_DATA_DIR} "$(incinst)"; fi
 	cp -f $(HFILES) "$(incinst)/"
 
 installib: $(LIBRARY)
 	if [ ! -d "$(libinst)" ]; then mkdir -p "$(libinst)"; fi
-	cp -f $(LIBRARY) "$(libinst)/"
+	${BSD_INSTALL_DATA} $(LIBRARY) "$(libinst)/"
+	${BSD_INSTALL_DATA} $(SHAREDLIBRARY) "$(libinst)/"
 
 installexes: $(EXES)
-	if [ ! -d "$(bininst)" ]; then mkdir -p "$(bininst)"; fi
-	cp -f $(EXES) "$(bininst)/"
+	if [ ! -d "$(bininst)" ]; then ${BSD_INSTALL_PROGRAM_DIR} "$(bininst)"; fi
+	${BSD_INSTALL_PROGRAM} $(EXES) "$(bininst)/"
 
 installmanpage: $(DOCDIR)/tidy.1
-	if [ ! -d "$(maninst)/man1" ]; then mkdir -p "$(maninst)/man1"; fi;
-	cp -f $(DOCDIR)/tidy.1 "$(maninst)/man1/tidy.1";
+	if [ ! -d "$(maninst)/man1" ]; then ${BSD_INSTALL_MAN_DIR} "$(maninst)/man1"; fi;
+	${BSD_INSTALL_MAN} $(DOCDIR)/tidy.1 "$(maninst)/man1/tidy.1";
 
-install: installhdrs installib installmanpage installexes
+install: installib installexes installmanpage installhdrs
@


1.3
log
@update to tidy-051026
build shared library (to be used by outside apps like php, etc)
fix makefile to allow fake to work w/ that.

based on diff from Dan Brosemer <odin@@svartalfheim.net>, thx
@
text
@@


1.2
log
@update to 050705, from Bernd Ahlers <b.ahlers@@ba-net.org>.

ok alek@@
@
text
@d1 2
a2 3
$OpenBSD: patch-build_gmake_Makefile,v 1.1 2004/03/02 21:20:12 xsa Exp $
--- build/gmake/Makefile.orig	Tue May  3 08:58:08 2005
+++ build/gmake/Makefile	Tue Jul 12 12:03:54 2005
d21 1
a21 1
+CFLAGS+= -I $(INCDIR)
d31 5
a35 1
@@@@ -115,7 +115,7 @@@@ LIBSUFFIX = .a
d40 1
d45 8
a52 1
@@@@ -164,7 +164,7 @@@@ doc:    $(DOCS)
d61 22
a82 1
@@@@ -205,19 +205,19 @@@@ clean:
d94 1
d108 2
a109 1
 install: installhdrs installib installmanpage installexes
@


1.1
log
@
update to 040205 snapshot; based on a diff from new MAINTAINER
Eduardo Alvarenga <eduardo at thrx.org> via and ok rohee@@.
@
text
@d1 3
a3 3
$OpenBSD$
--- build/gmake/Makefile.orig	2003-04-12 08:57:03.000000000 +0200
+++ build/gmake/Makefile	2004-03-01 19:50:56.000000000 +0100
d15 1
a15 3
@@@@ -76,8 +76,8 @@@@ LIBDIR = ${TOPDIR}/lib
 BINDIR = ${TOPDIR}/bin
 
d17 2
d20 1
a20 1
-CFLAGS= -Wall -Wno-switch -Wno-parentheses -Wno-unused -I $(INCDIR)
d23 2
d26 4
a29 1
 # OTHERCFLAGS= -DSUPPORT_ACCESSIBILITY_CHECKS=1 -DSUPPORT_UTF16_ENCODINGS=1 -DSUPPORT_ASIAN_ENCODINGS=1
d31 3
a33 2
@@@@ -107,7 +107,7 @@@@ LIBPREFIX = lib
 LIBSUFFIX = .a
d39 1
a39 1
 EXES = $(BINDIR)/$(PROJECT) $(BINDIR)/tab2space
d41 1
a41 1
@@@@ -148,7 +148,7 @@@@ all:    $(LIBRARY) $(EXES)
d48 1
a48 1
 	$(RANLIB) $@@ 
d50 1
a50 1
@@@@ -177,21 +177,21 @@@@ clean:
a54 1
-	cp -f $(HFILES) "$(incinst)/"
d56 1
a56 1
+	${BSD_INSTALL_DATA} $(HFILES) "$(incinst)/"
d59 1
a59 1
-	if [ ! -d "$(libinst)" ]; then mkdir -p "$(libinst)"; fi
a60 1
+	if [ ! -d "$(libinst)" ]; then ${BSD_INSTALL_DATA_DIR} "$(libinst)"; fi
d69 6
a74 8
 installmanpage:
 	if [ -f "$(TOPDIR)/htmldoc/man_page.txt" ] ; then \
-    	if [ ! -d "$(maninst)/man1" ]; then mkdir -p "$(maninst)/man1"; fi; \
-    	cp -f $(TOPDIR)/htmldoc/man_page.txt "$(maninst)/man1/tidy.1"; \
+    	if [ ! -d "$(maninst)/man1" ]; then ${BSD_INSTALL_MAN_DIR} "$(maninst)/man1"; fi; \
+    	${BSD_INSTALL_MAN} $(TOPDIR)/htmldoc/man_page.txt "$(maninst)/man1/tidy.1"; \
 	fi
    
@

