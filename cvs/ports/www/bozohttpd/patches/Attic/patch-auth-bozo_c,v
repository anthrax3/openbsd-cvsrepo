head	1.1;
access;
symbols
	OPENBSD_5_5:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2014.07.22.08.22.30;	author jasper;	state dead;
branches
	1.1.2.1;
next	;
commitid	PnPjD4PoAWJR81pa;

1.1.2.1
date	2014.07.22.08.22.30;	author jasper;	state Exp;
branches;
next	;
commitid	PnPjD4PoAWJR81pa;


desc
@@


1.1
log
@file patch-auth-bozo_c was initially added on branch OPENBSD_5_5.
@
text
@@


1.1.2.1
log
@Security fix for CVE-2014-5015
bozohttpd: basic http authentication bypass

ok benoit@@ (MAINTAINER), sthen@@
@
text
@a0 26
$OpenBSD$

Security fix for CVE-2014-5015,
bozohttpd: basic http authentication bypass

--- auth-bozo.c.orig	Thu Jul 11 10:52:21 2013
+++ auth-bozo.c	Tue Jul 22 09:54:42 2014
@@@@ -1,4 +1,4 @@@@
-/*	$NetBSD: auth-bozo.c,v 1.10 2011/11/18 09:51:31 mrg Exp $	*/
+/*	$NetBSD: auth-bozo.c,v 1.13 2014/07/08 14:01:21 mrg Exp $	*/
 
 /*	$eterna: auth-bozo.c,v 1.17 2011/11/18 09:21:15 mrg Exp $	*/
 
@@@@ -74,7 +74,11 @@@@ bozo_auth_check(bozo_httpreq_t *request, const char *f
 	}
 	request->hr_authrealm = bozostrdup(httpd, dir);
 
-	snprintf(authfile, sizeof(authfile), "%s/%s", dir, AUTH_FILE);
+	if ((size_t)snprintf(authfile, sizeof(authfile), "%s/%s", dir, AUTH_FILE) >= 
+	  sizeof(authfile)) {
+		return bozo_http_error(httpd, 404, request,
+			"authfile path too long");
+	}
 	if (stat(authfile, &sb) < 0) {
 		debug((httpd, DEBUG_NORMAL,
 		    "bozo_auth_check realm `%s' dir `%s' authfile `%s' missing",
@

