head	1.1;
access;
symbols
	OPENBSD_5_8:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2016.01.15.10.41.12;	author jasper;	state dead;
branches
	1.1.2.1;
next	;
commitid	ZwmhQmdOVfFkHNCY;

1.1.2.1
date	2016.01.15.10.41.12;	author jasper;	state Exp;
branches;
next	;
commitid	ZwmhQmdOVfFkHNCY;


desc
@@


1.1
log
@file patch-cgit_c was initially added on branch OPENBSD_5_8.
@
text
@@


1.1.2.1
log
@Address multiple security issues: CVE-2016-1899, CVE-2016-1900, CVE-2016-1901.
With additional hardening related to CVE-2016-1899.
@
text
@a0 24
$OpenBSD$

Security fix for CVE-2016-1899, CVE-2016-1901

--- cgit.c.orig	Fri Mar 13 16:22:11 2015
+++ cgit.c	Fri Jan 15 11:35:17 2016
@@@@ -312,8 +312,6 @@@@ static void querystring_cb(const char *name, const cha
 		ctx.qry.path = trim_end(value, '/');
 	} else if (!strcmp(name, "name")) {
 		ctx.qry.name = xstrdup(value);
-	} else if (!strcmp(name, "mimetype")) {
-		ctx.qry.mimetype = xstrdup(value);
 	} else if (!strcmp(name, "s")) {
 		ctx.qry.sort = xstrdup(value);
 	} else if (!strcmp(name, "showmsg")) {
@@@@ -652,7 +650,7 @@@@ static inline void open_auth_filter(const char *functi
 static inline void authenticate_post(void)
 {
 	char buffer[MAX_AUTHENTICATION_POST_BYTES];
-	int len;
+	unsigned int len;
 
 	open_auth_filter("authenticate-post");
 	len = ctx.env.content_length;
@

