head	1.2;
access;
symbols
	OPENBSD_6_1:1.2.0.6
	OPENBSD_6_1_BASE:1.2
	OPENBSD_6_0:1.2.0.4
	OPENBSD_6_0_BASE:1.2
	OPENBSD_5_9:1.2.0.2
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.1.0.4
	OPENBSD_5_8_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2016.01.14.22.09.15;	author sthen;	state Exp;
branches;
next	1.1;
commitid	GiuwEoLIWowUBg2r;

1.1
date	2015.04.05.22.07.59;	author landry;	state Exp;
branches;
next	;
commitid	DIpognqQwBcuhbDN;


desc
@@


1.2
log
@update to cgit-0.12, ok landry

Fixes some XSS and header injection problems and an int overflow in
CONTENT_LENGTH resulting in buffer overflow
@
text
@$OpenBSD: patch-filter_c,v 1.1 2015/04/05 22:07:59 landry Exp $
Wtf.
--- filter.c.orig	Thu Jan 14 14:43:54 2016
+++ filter.c	Thu Jan 14 14:53:04 2016
@@@@ -148,12 +148,13 @@@@ static struct cgit_filter *current_write_filter = NULL
 
 void cgit_init_filters(void)
 {
+	return;
 	libc_write = dlsym(RTLD_NEXT, "write");
 	if (!libc_write)
 		die("Could not locate libc's write function");
 }
 
-ssize_t write(int fd, const void *buf, size_t count)
+ssize_t wtf__write(int fd, const void *buf, size_t count)
 {
 	if (fd != STDOUT_FILENO || !filter_write)
 		return libc_write(fd, buf, count);
@


1.1
log
@Update to cgit 0.11.2, tested in "production" on 5.6.

Consolidate info from cgit.conf and MESSAGE into a README, and add a
config snippet for a vhost on nginx.
Disable the filter feature as it wouldnt work with the way cgit.cgi is
built statically for us.
@
text
@d1 1
a1 1
$OpenBSD$
d3 3
a5 3
--- filter.c.orig	Fri Mar 13 16:22:11 2015
+++ filter.c	Sun Apr  5 23:11:50 2015
@@@@ -51,12 +51,13 @@@@ void cgit_cleanup_filters(void)
@

