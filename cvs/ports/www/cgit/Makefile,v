head	1.22;
access;
symbols
	OPENBSD_6_1:1.22.0.2
	OPENBSD_6_1_BASE:1.22
	OPENBSD_6_0:1.21.0.2
	OPENBSD_6_0_BASE:1.21
	OPENBSD_5_9:1.17.0.2
	OPENBSD_5_9_BASE:1.17
	OPENBSD_5_8:1.16.0.4
	OPENBSD_5_8_BASE:1.16
	OPENBSD_5_7:1.14.0.4
	OPENBSD_5_7_BASE:1.14
	OPENBSD_5_6:1.14.0.2
	OPENBSD_5_6_BASE:1.14
	OPENBSD_5_5:1.13.0.2
	OPENBSD_5_5_BASE:1.13
	OPENBSD_5_4:1.12.0.2
	OPENBSD_5_4_BASE:1.12
	OPENBSD_5_3:1.8.0.2
	OPENBSD_5_3_BASE:1.8
	OPENBSD_5_2:1.5.0.2
	OPENBSD_5_2_BASE:1.5
	OPENBSD_5_1_BASE:1.4
	OPENBSD_5_1:1.4.0.4
	OPENBSD_5_0:1.4.0.2
	OPENBSD_5_0_BASE:1.4
	landry_20110403:1.1.1.1
	landry:1.1.1;
locks; strict;
comment	@# @;


1.22
date	2017.03.22.20.23.52;	author landry;	state Exp;
branches;
next	1.21;
commitid	maaHHQR2MKsMTkUz;

1.21
date	2016.06.17.07.22.39;	author landry;	state Exp;
branches;
next	1.20;
commitid	SGHh6YiMMQnXC8hq;

1.20
date	2016.04.29.09.40.51;	author sthen;	state Exp;
branches;
next	1.19;
commitid	lRbXouNtjYHM69O8;

1.19
date	2016.04.09.20.14.49;	author naddy;	state Exp;
branches;
next	1.18;
commitid	v3xsXUgHi26KLfAN;

1.18
date	2016.03.16.08.56.02;	author sthen;	state Exp;
branches;
next	1.17;
commitid	ZIgt9DRY5guftP3x;

1.17
date	2016.01.14.22.09.15;	author sthen;	state Exp;
branches;
next	1.16;
commitid	GiuwEoLIWowUBg2r;

1.16
date	2015.04.05.22.07.59;	author landry;	state Exp;
branches
	1.16.4.1;
next	1.15;
commitid	DIpognqQwBcuhbDN;

1.15
date	2015.03.14.20.52.46;	author naddy;	state Exp;
branches;
next	1.14;
commitid	jnrLBcPmz76yfcWI;

1.14
date	2014.05.30.13.14.09;	author sthen;	state Exp;
branches;
next	1.13;

1.13
date	2013.08.07.21.32.46;	author naddy;	state Exp;
branches;
next	1.12;

1.12
date	2013.07.15.07.00.49;	author jasper;	state Exp;
branches;
next	1.11;

1.11
date	2013.07.05.09.34.35;	author jasper;	state Exp;
branches;
next	1.10;

1.10
date	2013.05.05.19.24.13;	author jasper;	state Exp;
branches;
next	1.9;

1.9
date	2013.03.11.11.44.41;	author espie;	state Exp;
branches;
next	1.8;

1.8
date	2012.11.15.19.58.48;	author sthen;	state Exp;
branches;
next	1.7;

1.7
date	2012.10.01.16.13.23;	author landry;	state Exp;
branches;
next	1.6;

1.6
date	2012.09.17.19.37.09;	author landry;	state Exp;
branches;
next	1.5;

1.5
date	2012.03.06.17.17.09;	author landry;	state Exp;
branches;
next	1.4;

1.4
date	2011.07.27.13.34.05;	author jasper;	state Exp;
branches;
next	1.3;

1.3
date	2011.05.03.13.57.26;	author stsp;	state Exp;
branches;
next	1.2;

1.2
date	2011.04.03.21.32.49;	author jasper;	state Exp;
branches;
next	1.1;

1.1
date	2011.04.03.10.27.24;	author landry;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2011.04.03.10.27.24;	author landry;	state Exp;
branches;
next	;

1.16.4.1
date	2016.01.15.10.41.12;	author jasper;	state Exp;
branches;
next	;
commitid	ZwmhQmdOVfFkHNCY;


desc
@@


1.22
log
@Update to cgit 1.1, from Hiltjo Posthuma, thanks!

- pass the option NO_GETTEXT=1 to git to disable gettext support.
- add a patch patches/patch-setup_c to not open /dev/null in the chroot.
- add a OpenBSD httpd (with slowcgi) example to the README.
- add an explanation a static gzip binary is required for .tar.gz snapshot support.

(and fix RCS Ids while here)
@
text
@# $OpenBSD: Makefile,v 1.21 2016/06/17 07:22:39 landry Exp $

COMMENT =	web frontend for git repositories

DISTNAME =	cgit-1.1
CATEGORIES =	www devel

DISTFILES =	${DISTNAME}.tar.gz:0 \
		git-2.10.2.tar.gz:1

MASTER_SITES0 =		https://git.zx2c4.com/cgit/snapshot/
MASTER_SITES1 =		https://www.kernel.org/pub/software/scm/git/
HOMEPAGE =		https://git.zx2c4.com/cgit/about/

# GPLv2
PERMIT_PACKAGE_CDROM =	Yes

USE_GMAKE =	yes

LIB_DEPENDS =	converters/libiconv

PREFIX =	${VARBASE}/www
MAKE_FLAGS +=	V=1 NO_GETTEXT=1 NO_LUA=1 LDFLAGS+='${STATIC} -L${LOCALBASE}/lib'

post-extract:
	rmdir ${WRKSRC}/git
	mv ${WRKDIR}/git-* ${WRKSRC}/git

post-install:
	mv ${PREFIX}/htdocs ${PREFIX}/cgit

.include <bsd.port.mk>
@


1.21
log
@Update to cgit-1.0.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2016/04/29 09:40:51 sthen Exp $
d5 1
a5 1
DISTNAME =	cgit-1.0
d9 1
a9 1
		git-2.8.3.tar.gz:1
d11 1
a11 1
MASTER_SITES0 =		http://git.zx2c4.com/cgit/snapshot/
d13 1
a13 1
HOMEPAGE =		http://git.zx2c4.com/cgit/about/
d23 1
a23 1
MAKE_FLAGS +=	V=1 NO_LUA=1 LDFLAGS+='${STATIC} -L${LOCALBASE}/lib'
@


1.20
log
@adjust following apache1 removal
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2016/04/09 20:14:49 naddy Exp $
d5 1
a5 2
DISTNAME =	cgit-0.12
REVISION =	1
d9 1
a9 1
		git-2.7.2.tar.gz:1
a16 2

WANTLIB =	iconv
@


1.19
log
@replace libiconv module with library dependency; no bump needed
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2016/03/16 08:56:02 sthen Exp $
d6 1
a6 1
REVISION =	0
@


1.18
log
@update the version of git in cgit to 2.7.2, upstream have done this in
their tree which isn't hugely different to the 0.12 release that we have.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2016/01/14 22:09:15 sthen Exp $
d19 2
d23 1
a23 1
MODULES =	converters/libiconv
@


1.17
log
@update to cgit-0.12, ok landry

Fixes some XSS and header injection problems and an int overflow in
CONTENT_LENGTH resulting in buffer overflow
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2015/04/05 22:07:59 landry Exp $
d6 1
d10 1
a10 1
		git-2.7.0.tar.gz:1
@


1.16
log
@Update to cgit 0.11.2, tested in "production" on 5.6.

Consolidate info from cgit.conf and MESSAGE into a README, and add a
config snippet for a vhost on nginx.
Disable the filter feature as it wouldnt work with the way cgit.cgi is
built statically for us.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2015/03/14 20:52:46 naddy Exp $
d5 1
a5 1
DISTNAME =	cgit-0.11.2
d9 1
a9 1
		git-2.3.2.tar.gz:1
@


1.16.4.1
log
@Address multiple security issues: CVE-2016-1899, CVE-2016-1900, CVE-2016-1901.
With additional hardening related to CVE-2016-1899.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2015/04/05 22:07:59 landry Exp $
a5 1
REVISION =	0
@


1.15
log
@switch from "-static" to "${STATIC}, i.e., build static PIE executables
on most archs
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2014/05/30 13:14:09 sthen Exp $
d5 1
a5 2
DISTNAME =	cgit-0.9.2
REVISION =	1
d9 1
a9 1
		git-1.8.3.2.tar.gz:1
d12 1
a12 1
MASTER_SITES1 =		https://git-core.googlecode.com/files/
d23 1
a23 1
MAKE_FLAGS +=	V=1 NEEDS_LIBICONV=1 LDFLAGS+='${STATIC} -L${LOCALBASE}/lib'
d30 1
a30 2
	${INSTALL_DATA_DIR} ${PREFIX}/conf/modules.sample
	${INSTALL_DATA} ${FILESDIR}/cgit.conf ${PREFIX}/conf/modules.sample/cgit.conf.dist
@


1.14
log
@/var/www/conf/modules.sample is no longer provided by base; noticed by florian@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2013/08/07 21:32:46 naddy Exp $
d6 1
a6 1
REVISION =	0
d24 1
a24 1
MAKE_FLAGS +=	V=1 NEEDS_LIBICONV=1 LDFLAGS+='-static -L${LOCALBASE}/lib'
@


1.13
log
@move http://code.google.com, *.googlecode.com, and sites.google.com to https
suggested by bentley@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2013/07/15 07:00:49 jasper Exp $
d6 1
@


1.12
log
@- update to cgit-0.9.2
- bump git to 1.8.3.2
- sync MASTER_SITES with the git port

ok landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2013/07/05 09:34:35 jasper Exp $
d12 1
a12 1
MASTER_SITES1 =		http://git-core.googlecode.com/files/
@


1.11
log
@use ${VARBASE} instead of hardcoding /var
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2013/05/05 19:24:13 jasper Exp $
d5 1
a5 2
DISTNAME =	cgit-0.9.1
REVISION =	0
d8 2
a9 2
DISTFILES =	cgit-0.9.1.tar.gz:0 \
		git-1.7.4.5.tar.gz:1
d12 1
a12 4
MASTER_SITES1 =		http://ftp.kernel.org/pub/software/scm/git/ \
			ftp://ftp.kernel.org/pub/software/scm/git/ \
			ftp://ftp.de.kernel.org/pub/software/scm/git/ \
			ftp://ftp.au.kernel.org/pub/software/scm/git/
a20 1
WANTLIB +=	c crypto pthread z
d27 1
a27 1
	ln -s ${WRKDIR}/git-* ${WRKSRC}/git
@


1.10
log
@modules.sample/ always lives in /var/www, so no need for ${PREFIX} here.

as discussed with aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2013/03/11 11:44:41 espie Exp $
d27 1
a27 1
PREFIX =	/var/www
@


1.9
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2012/11/15 19:58:48 sthen Exp $
d6 1
@


1.8
log
@update to cgit 0.9.1; new upstream site.  ok landry
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2012/10/01 16:13:23 landry Exp $
a19 3
PERMIT_PACKAGE_FTP =	Yes
PERMIT_DISTFILES_CDROM =	Yes
PERMIT_DISTFILES_FTP =	Yes
@


1.7
log
@Fix for heap overflow/stack-smashing, see
http://hjemli.net/pipermail/cgit/2012-July/000652.html
http://git.zx2c4.com/cgit/commit/?id=7757d1b046ecb67b830151d20715c658867df1ec
https://bugzilla.redhat.com/show_bug.cgi?id=820733
from oss-sec via sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2012/09/17 19:37:09 landry Exp $
d5 1
a5 2
DISTNAME =	cgit-0.9.0.2
REVISION =	1
d8 1
a8 1
DISTFILES = 	cgit-0.9.0.2.tar.gz:0 \
d11 3
a13 2
MASTER_SITES0 =		http://distfiles.bsdfrog.org/
MASTER_SITES1 =		ftp://ftp.kernel.org/pub/software/scm/git/ \
d16 1
a16 1
HOMEPAGE =	http://hjemli.net/git/cgit/about/
@


1.6
log
@Build cgit static by default to ease upgrades within the httpd chroot.

Prompted by a diff from Olivier Mehani on ports@@
looks good to sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2012/03/06 17:17:09 landry Exp $
d6 1
a6 1
REVISION =	0
@


1.5
log
@Update to cgit 0.9.0.2
thx ajacoutot@@ for hosting the distfile.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2011/07/27 13:34:05 jasper Exp $
d6 1
d30 1
a30 1
MAKE_FLAGS +=	V=1 NEEDS_LIBICONV=1 LDFLAGS+=-L${LOCALBASE}/lib
@


1.4
log
@Security fix for CVE-2011-2711, cgit Rename Hint Script Insertion Vulnerability

from upstream
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2011/05/03 13:57:26 stsp Exp $
d5 1
a5 2
DISTNAME =	cgit-0.8.3.5
REVISION = 	1
d8 1
a8 1
DISTFILES = 	cgit-0.8.3.5.tar.gz:0 \
d11 1
a11 1
MASTER_SITES0 =		http://distfiles.nl/
@


1.3
log
@Unbreak cgit following the devel/git update to 1.7.5.
Link to git-1.7.4.5 instead of build-depending on devel/git until upstream
resolves issues caused by API changes in git-1.7.5.
ok landry
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2011/04/03 21:32:49 jasper Exp $
d6 1
a6 1
REVISION = 	0
@


1.2
log
@mirror the distfile, as the tarball changes checksum at each fetch

requested by landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2011/04/03 10:27:24 landry Exp $
d6 1
d9 7
a15 1
MASTER_SITES =	http://distfiles.nl/
a26 1
BUILD_DEPENDS =	devel/git:patch
d34 1
a34 1
	ln -s ${WRKDIR}/devel/git/git-* ${WRKSRC}/git
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2010/11/11 12:35:09 sthen Exp $
d8 1
a8 1
MASTER_SITES =	http://hjemli.net/git/cgit/snapshot/
@


1.1.1.1
log
@Import cgit 0.8.3.5:

cgit is a fast web interface for the git scm, using a builtin cache to
decrease server io-pressure.

With tweaks from and ok sthen@@ jasper@@
@
text
@@
