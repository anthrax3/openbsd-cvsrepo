head	1.2;
access;
symbols;
locks; strict;
comment	@# @;


1.2
date	2009.10.23.10.10.54;	author espie;	state dead;
branches;
next	1.1;

1.1
date	2009.07.24.19.31.14;	author espie;	state Exp;
branches;
next	;


desc
@@


1.2
log
@a few minor updates
@
text
@$OpenBSD: patch-filefield_module,v 1.1 2009/07/24 19:31:14 espie Exp $
--- filefield.module.orig	Fri Jul  3 22:53:07 2009
+++ filefield.module	Fri Jul 24 21:15:41 2009
@@@@ -180,7 +180,8 @@@@ function filefield_file_download($file) {
       if (isset($nodes[$content['nid']])) {
         continue; // Don't check the same node twice.
       }
-      if ($denied == FALSE && $node = node_load($content['nid']) && node_access('view', $node)) {
+      $node = node_load($content['nid']);
+      if ($denied == FALSE && node_access('view', $node) == FALSE) {
         // You don't have permission to view the node this file is attached to.
         $denied = TRUE;
       }
@


1.1
log
@rather important fix to only allow access if users can see the node.
@
text
@d1 1
a1 1
$OpenBSD$
@

