head	1.11;
access;
symbols
	OPENBSD_6_0:1.6.0.8
	OPENBSD_6_0_BASE:1.6
	OPENBSD_5_9:1.6.0.4
	OPENBSD_5_9_BASE:1.6
	OPENBSD_5_8:1.6.0.6
	OPENBSD_5_8_BASE:1.6
	OPENBSD_5_7:1.6.0.2
	OPENBSD_5_7_BASE:1.6
	OPENBSD_5_6:1.5.0.2
	OPENBSD_5_6_BASE:1.5
	OPENBSD_5_5:1.4.0.2
	OPENBSD_5_5_BASE:1.4
	sthen_20131220:1.1.1.1
	sthen:1.1.1;
locks; strict;
comment	@# @;


1.11
date	2017.03.02.17.30.15;	author espie;	state Exp;
branches;
next	1.10;
commitid	GD33jwr9g6sp0jy8;

1.10
date	2016.12.10.14.12.21;	author sthen;	state Exp;
branches;
next	1.9;
commitid	8PtD0TKpMwShDk6g;

1.9
date	2016.09.10.13.03.43;	author ajacoutot;	state Exp;
branches;
next	1.8;
commitid	4KcvAK91uGdTLejD;

1.8
date	2016.08.19.19.36.01;	author sthen;	state Exp;
branches;
next	1.7;
commitid	yjZ1Aqm02qWxhoYp;

1.7
date	2016.08.19.09.49.24;	author sthen;	state Exp;
branches;
next	1.6;
commitid	NyrAmWbNMqhDdjVM;

1.6
date	2014.11.03.14.42.41;	author landry;	state Exp;
branches;
next	1.5;
commitid	US6NKmbTDL1g6ltb;

1.5
date	2014.03.18.14.19.54;	author ajacoutot;	state Exp;
branches;
next	1.4;

1.4
date	2014.01.28.11.37.52;	author sthen;	state Exp;
branches;
next	1.3;

1.3
date	2014.01.15.08.41.37;	author sthen;	state Exp;
branches;
next	1.2;

1.2
date	2014.01.11.11.47.20;	author sthen;	state Exp;
branches;
next	1.1;

1.1
date	2013.12.20.00.54.05;	author sthen;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2013.12.20.00.54.05;	author sthen;	state Exp;
branches;
next	;


desc
@@


1.11
log
@unhardcode g++
regen other patch, bump
@
text
@# $OpenBSD: Makefile,v 1.10 2016/12/10 14:12:21 sthen Exp $

USE_WXNEEDED =		Yes

ONLY_FOR_ARCHS =	i386 amd64
DPB_PROPERTIES =	parallel nojunk
# nojunk: qmake include parser is bogus, c.f. x11/qt4

COMMENT =		headless WebKit scriptable with a JavaScript API

DISTNAME =		phantomjs-1.9.8
REVISION =		3

CATEGORIES =		www
HOMEPAGE =		http://phantomjs.org/
MAINTAINER =		Francisco de Borja Lopez Rio <borja@@codigo23.net>

# phantomjs: BSD, but statically linked to patched qt4 (LGPL) and webkit
PERMIT_PACKAGE_CDROM =	Yes

WANTLIB +=		ICE SM X11 Xext Xi Xinerama Xrender c fontconfig \
			freetype m pthread stdc++

MASTER_SITES = 		https://bitbucket.org/ariya/phantomjs/downloads/
EXTRACT_SUFX =		-source.zip

BUILD_DEPENDS =		shells/bash

MAKE_ENV =		C_INCLUDE_PATH=${X11BASE}/include/ \
			CPLUS_INCLUDE_PATH=${X11BASE}/include/ \
                        SUBLIBS=-L${WRKSRC}/src/qt/lib \
			MAKEFLAGS="-j${MAKE_JOBS}" \
			OSTYPE="openbsd"

do-configure:
	cd ${WRKSRC}/src/qt && env -i ${MAKE_ENV} \
		./preconfig.sh --jobs ${MAKE_JOBS} --qt-config

pre-build:
	cd ${WRKSRC}/src/qt && env -i ${MAKE_ENV} ${MAKE} -j${MAKE_JOBS}
	cd ${WRKSRC}/src/qt/src/plugins/codecs && \
		env -i ${MAKE_ENV} ${MAKE} -j${MAKE_JOBS}
	cd ${WRKSRC} && env -i ${MAKE_ENV} ./src/qt/bin/qmake

do-install:
	${INSTALL_PROGRAM} ${WRKSRC}/bin/phantomjs ${PREFIX}/bin/phantomjs
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/phantomjs
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/phantomjs
	${INSTALL_DATA} ${WRKSRC}/examples/* ${PREFIX}/share/examples/phantomjs
	${INSTALL_DATA} ${WRKSRC}/LICENSE.BSD ${PREFIX}/share/doc/phantomjs

# Tests fail as of version 1.9.2 (in different platforms and OSes)
do-test:
	cd ${WRKSRC}/test && ${WRKSRC}/bin/phantomjs run-tests.js

.include <bsd.port.mk>
@


1.10
log
@Fix USE_WXNEEDED and bump. The contents of the variable had a trailing space
("USE_WXNEEDED = Yes # comment") and "Yes " doesn't match "Yes".
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2016/09/10 13:03:43 ajacoutot Exp $
d12 1
a12 1
REVISION =		2
@


1.9
log
@First pass at pre-entively fixing ports that would break once guenther's header
pollution diff is in.

lang/squeak/vm does not build but it's due to the recent audio changes
games/xbattle: also fixes some conflicting implicit decl
print/hplip: also fixes some conflicting implicit decl
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2016/08/19 19:36:01 sthen Exp $
d3 1
a3 1
USE_WXNEEDED =		Yes # bundled webkit
d12 1
a12 1
REVISION =		1
@


1.8
log
@add comment "bundled webkit", prompted by a mail from aja
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2016/08/19 09:49:24 sthen Exp $
d12 1
a12 1
REVISION =		0
@


1.7
log
@phantomjs needs wxneeded, from Caspar Schutijser
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2014/11/03 14:42:41 landry Exp $
d3 1
a3 1
USE_WXNEEDED =		Yes
@


1.6
log
@Update toh phantomjs 1.9.8.

From MAINTAINER Francisco de Borja Lopez Rio <borja /codigo23 /net>,
also tested by Eric Radman.
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.5 2014/03/18 14:19:54 ajacoutot Exp $
d12 1
@


1.5
log
@Drop uneeded substitution.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2014/01/28 11:37:52 sthen Exp $
d9 1
a9 1
DISTNAME =		phantomjs-1.9.7
@


1.4
log
@update to phantomjs 1.9.7, from maintainer Francisco de Borja Lopez Rio
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2014/01/15 08:41:37 sthen Exp $
a32 2
	perl -pi -e 's,^#!/usr/bin/env bash,#!${LOCALBASE}/bin/bash,g' \
		${WRKSRC}/src/qt/preconfig.sh
@


1.3
log
@build the bundled/patched copy of qt as part of the main build, not in
configure. reported by espie@@, ok Francisco de Borja Lopez Rio (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2014/01/11 11:47:20 sthen Exp $
d9 1
a9 1
DISTNAME =		phantomjs-1.9.2
d21 1
a21 1
MASTER_SITES =		http://phantomjs.googlecode.com/files/
@


1.2
log
@use DPB_PROPERTIES=nojunk, this has the usual problem with qmake where it
picks up installed headers even where they're not actually used
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2013/12/20 00:54:05 sthen Exp $
a31 3
# Passed via environment rather than on the command line to make
PARALLEL_BUILD =	No

d35 1
a35 1
	@@cd ${WRKSRC}/src/qt && env -i ${MAKE_ENV} \
d37 6
a42 1
	@@cd ${WRKSRC} && env -i ${MAKE_ENV} ./src/qt/bin/qmake
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.template,v 1.68 2013/10/02 07:34:45 ajacoutot Exp $
d4 2
a5 1
DPB_PROPERTIES =	parallel
@


1.1.1.1
log
@import ports/www/phantomjs, from maintainer Francisco de Borja Lopez Rio
<borja@@codigo23.net>, ok abieber@@ - apologies for the extra copies of
WebKit and Qt but they are stripped-down so not horribly slow to build,
and have various fixes that phantomjs upstream haven't been able to get
into the various libraries yet.

"PhantomJS is a headless WebKit scriptable with a JavaScript API.
It has fast and native support for various web standards: DOM
handling, CSS selector, JSON, Canvas, and SVG."

(useful for various things including automated testing of web sites,
and screen scraping of complex web apps)
@
text
@@
