head	1.15;
access;
symbols
	OPENBSD_5_6:1.14.0.2
	OPENBSD_5_6_BASE:1.14
	OPENBSD_5_5:1.13.0.2
	OPENBSD_5_5_BASE:1.13
	OPENBSD_5_4:1.12.0.2
	OPENBSD_5_4_BASE:1.12
	OPENBSD_5_3:1.10.0.2
	OPENBSD_5_3_BASE:1.10
	OPENBSD_5_2:1.6.0.2
	OPENBSD_5_2_BASE:1.6
	OPENBSD_5_1_BASE:1.2
	OPENBSD_5_1:1.2.0.2
	OPENBSD_5_0:1.1.0.2
	OPENBSD_5_0_BASE:1.1;
locks; strict;
comment	@# @;


1.15
date	2014.09.09.21.27.17;	author landry;	state dead;
branches;
next	1.14;
commitid	QBOfzQIodOXPY6Bg;

1.14
date	2014.03.24.21.34.21;	author landry;	state Exp;
branches;
next	1.13;

1.13
date	2013.12.12.19.58.39;	author landry;	state Exp;
branches;
next	1.12;

1.12
date	2013.07.11.16.23.39;	author landry;	state Exp;
branches;
next	1.11;

1.11
date	2013.03.03.17.39.15;	author landry;	state Exp;
branches;
next	1.10;

1.10
date	2013.01.11.23.17.32;	author landry;	state Exp;
branches;
next	1.9;

1.9
date	2012.10.10.21.03.40;	author landry;	state Exp;
branches;
next	1.8;

1.8
date	2012.09.01.14.10.03;	author landry;	state Exp;
branches;
next	1.7;

1.7
date	2012.08.07.09.02.33;	author landry;	state Exp;
branches;
next	1.6;

1.6
date	2012.06.11.15.38.33;	author landry;	state Exp;
branches;
next	1.5;

1.5
date	2012.04.30.15.38.09;	author landry;	state Exp;
branches;
next	1.4;

1.4
date	2012.03.16.21.38.33;	author landry;	state Exp;
branches;
next	1.3;

1.3
date	2012.02.20.20.20.00;	author landry;	state Exp;
branches;
next	1.2;

1.2
date	2011.08.23.20.25.25;	author landry;	state Exp;
branches;
next	1.1;

1.1
date	2011.07.24.07.31.57;	author landry;	state Exp;
branches;
next	;


desc
@@


1.15
log
@(Long awaited) update to seamonkey 2.29 / lightning 3.4.

- See http://www.seamonkey-project.org/releases/seamonkey2.29/
- this is based on gecko 32, so contains all the new changes since gecko
  20 (which was the basis for seamonkey 2.26)
- remove patches to fix lightning display (merged in #1001985)
- remove mozilla/browser/components/certerror/content/aboutCertError.xhtml,
boring patch.
- add intl/icu patch from #990196
- remove
  patch-mozilla_toolkit_components_downloads_nsDownloadManager_cpp and
patch-mozilla_xpcom_io_SpecialSystemDirectory_cpp, they neved made any
sense to me and this is the wrong place to modify this.
@
text
@$OpenBSD: patch-mozilla_toolkit_components_downloads_nsDownloadManager_cpp,v 1.14 2014/03/24 21:34:21 landry Exp $
--- mozilla/toolkit/components/downloads/nsDownloadManager.cpp.orig	Wed Mar  5 00:34:36 2014
+++ mozilla/toolkit/components/downloads/nsDownloadManager.cpp	Sun Mar  9 00:00:11 2014
@@@@ -1409,7 +1409,7 @@@@ nsDownloadManager::GetDefaultDownloadsDirectory(nsIFil
     rv = downloadDir->Exists(&exists);
     NS_ENSURE_SUCCESS(rv, rv);
     if (!exists) {
-      rv = downloadDir->Create(nsIFile::DIRECTORY_TYPE, 0755);
+      rv = downloadDir->Create(nsIFile::DIRECTORY_TYPE, 0700);
       NS_ENSURE_SUCCESS(rv, rv);
     }
   }
@@@@ -1508,7 +1508,7 @@@@ nsDownloadManager::GetUserDownloadsDirectory(nsIFile *
           (void)customDirectory->Exists(&exists);
 
           if (!exists) {
-            rv = customDirectory->Create(nsIFile::DIRECTORY_TYPE, 0755);
+            rv = customDirectory->Create(nsIFile::DIRECTORY_TYPE, 0700);
             if (NS_SUCCEEDED(rv)) {
               customDirectory.forget(aResult);
               return NS_OK;
@


1.14
log
@Update to seamonkey 2.25.

- See http://www.seamonkey-project.org/releases/seamonkey2.25/
- Fixes MFSA-2014-15->32 (except 21,24,25, not relevant to SM?)
- Remove enigmail subpackage, build goo & patches, will be
superseded by mail/enigmail,-seamonkey
- add an all-openbsd.js file to customize default preferences and
install it in defaults/pref/. Use it to set
extensions.autoDisableScopes to 3, so that extensions installed in
${LOCALBASE}/lib/mozilla/extensions/${APPID} are enabled by default.
- remove libffi patches, were merged upstream in #928390 and #928381
@
text
@d1 1
a1 1
$OpenBSD: patch-mozilla_toolkit_components_downloads_nsDownloadManager_cpp,v 1.13 2013/12/12 19:58:39 landry Exp $
@


1.13
log
@Update to seamonkey 2.23.

- See http://www.seamonkey-project.org/releases/seamonkey2.23/
- Fixes MFSA-2013-104 -> 117 (all but 105, in fact)
- remove patch-ipc_chromium_src_base_dir_reader_bsd_h (#909005),
  the getdents() patch has been merged upstream.
- temporarly add a config/config.mk patch to reinstate XPIDL_LINK,
  fallout from http://hg.mozilla.org/releases/comm-release/rev/a6ab55f00e21
  (this is needed for enigmail to build fine.)
@
text
@d1 4
a4 4
$OpenBSD: patch-mozilla_toolkit_components_downloads_nsDownloadManager_cpp,v 1.12 2013/07/11 16:23:39 landry Exp $
--- mozilla/toolkit/components/downloads/nsDownloadManager.cpp.orig	Sat Dec  7 16:13:21 2013
+++ mozilla/toolkit/components/downloads/nsDownloadManager.cpp	Sun Dec  8 11:09:52 2013
@@@@ -1408,7 +1408,7 @@@@ nsDownloadManager::GetDefaultDownloadsDirectory(nsIFil
d13 1
a13 1
@@@@ -1507,7 +1507,7 @@@@ nsDownloadManager::GetUserDownloadsDirectory(nsIFile *
@


1.12
log
@Update to seamonkey 2.19 / enigmail 1.5.2 / lightning 2.4b1.

- See http://www.seamonkey-project.org/releases/seamonkey2.19/
- Fixes more or less the same list of MFSA fixed in ffx 22
- Finally back on track after missing 2.18 due to build infra issues
- Add a patch to workaround #886095 (which puzzled me for 3 weeks)
- remove no longer needed sydneyaudio patches
- add TERM=xterm hack to workaround mozbuild issue
- reenable clang on i386, using --disable-debug-symbols
- sync patch-mozilla_gfx_thebes_gfxPlatform_cpp which the one from ffx
@
text
@d1 4
a4 4
$OpenBSD: patch-mozilla_toolkit_components_downloads_nsDownloadManager_cpp,v 1.11 2013/03/03 17:39:15 landry Exp $
--- mozilla/toolkit/components/downloads/nsDownloadManager.cpp.orig	Fri Apr 19 05:30:25 2013
+++ mozilla/toolkit/components/downloads/nsDownloadManager.cpp	Sat Apr 27 17:16:53 2013
@@@@ -1370,7 +1370,7 @@@@ nsDownloadManager::GetDefaultDownloadsDirectory(nsIFil
d13 1
a13 1
@@@@ -1478,7 +1478,7 @@@@ nsDownloadManager::GetUserDownloadsDirectory(nsIFile *
@


1.11
log
@Update to seamonkey 2.16 / enigmail 1.5.1

- see http://www.seamonkey-project.org/releases/seamonkey2.16/
- fixes MFSA 2013-21->28
- provides a builtin pdf viewer (pdf.js)
- remove patch-mozilla_toolkit_system_gnome_nsGIOService_cpp (#805202), firefox
now properly links with gio instead of dlopening it
- remove patch-mozilla_toolkit_xre_nsXREDirProvider_cpp and
patch-mozilla_xpcom_io_nsAppFileLocationProvider_cpp, merged upstream (#803955)
@
text
@d1 4
a4 4
$OpenBSD: patch-mozilla_toolkit_components_downloads_nsDownloadManager_cpp,v 1.10 2013/01/11 23:17:32 landry Exp $
--- mozilla/toolkit/components/downloads/nsDownloadManager.cpp.orig	Mon Feb 18 05:06:48 2013
+++ mozilla/toolkit/components/downloads/nsDownloadManager.cpp	Sun Feb 24 10:22:32 2013
@@@@ -1390,7 +1390,7 @@@@ nsDownloadManager::GetDefaultDownloadsDirectory(nsIFil
d13 1
a13 1
@@@@ -1498,7 +1498,7 @@@@ nsDownloadManager::GetUserDownloadsDirectory(nsIFile *
@


1.10
log
@Update to seamonkey 2.15/enigmail 1.5.0/lightning 2.0beta1

- see http://www.seamonkey-project.org/releases/seamonkey2.15/
- fixes MFSA 2013-01 -> 20
- build with clang on i386/amd64 and with gcc 4.6 on powerpc. Required
since upstream dropped support for gcc < 4.4.
- don't build against systemwide jpeg anymore since it now needs its
internal libjpeg-turbo.
- add a stub method to sydney_audio_sndio.c in post-patch.
- add patch-mozilla_toolkit_mozapps_installer_packager_mk to fix a tar
  vs $(TAR) usage (bug #815793)
- remove patch-ipc_chromium_src_base_atomicops_h, not needed anymore
- remove enigmail genxpi patch, and to a SUBST_VARS dance with an
XPCOM_ABI variable for the consistent naming of the new internal
libsuprocess ipc lib.
- add an enigmail patch to link with -shared
@
text
@d1 4
a4 4
$OpenBSD: patch-mozilla_toolkit_components_downloads_nsDownloadManager_cpp,v 1.9 2012/10/10 21:03:40 landry Exp $
--- mozilla/toolkit/components/downloads/nsDownloadManager.cpp.orig	Thu Dec 20 05:56:01 2012
+++ mozilla/toolkit/components/downloads/nsDownloadManager.cpp	Wed Jan  2 20:39:30 2013
@@@@ -1167,7 +1167,7 @@@@ nsDownloadManager::GetDefaultDownloadsDirectory(nsIFil
d13 1
a13 1
@@@@ -1275,7 +1275,7 @@@@ nsDownloadManager::GetUserDownloadsDirectory(nsIFile *
@


1.9
log
@Update to seamonkey 2.13/enigmail 1.4.5/lightning 1.8b1.

- see http://www.seamonkey-project.org/releases/seamonkey2.13/ for details
- remove patch-mozilla_build_unix_mozilla_in, useless since bin/seamonkey
is not a script anymore since a while
- remove patch-mozilla_build_unix_run-mozilla_sh, seamonkey can be directly
debugged in gdb now. update README accordingly
- fix plugin path in README
@
text
@d1 4
a4 4
$OpenBSD: patch-mozilla_toolkit_components_downloads_nsDownloadManager_cpp,v 1.8 2012/09/01 14:10:03 landry Exp $
--- mozilla/toolkit/components/downloads/nsDownloadManager.cpp.orig	Fri Aug 31 07:56:38 2012
+++ mozilla/toolkit/components/downloads/nsDownloadManager.cpp	Sun Sep  2 12:45:42 2012
@@@@ -1165,7 +1165,7 @@@@ nsDownloadManager::GetDefaultDownloadsDirectory(nsIFil
d13 1
a13 1
@@@@ -1273,7 +1273,7 @@@@ nsDownloadManager::GetUserDownloadsDirectory(nsIFile *
@


1.8
log
@Update to seamonkey 2.12.

- see http://www.seamonkey-project.org/releases/seamonkey2.12/
- garbage collect nsSound.cpp, the original one uses libcanberra
properly and thus sndio.
- remove patch from #750620, merged upstream (mfbt/double-conversion)
- remove patches from #691898, merged upstream (yarr jit ppc)
- remove useless crashreporter patch, we don't have breakpad
@
text
@d1 4
a4 4
$OpenBSD: patch-mozilla_toolkit_components_downloads_nsDownloadManager_cpp,v 1.7 2012/08/07 09:02:33 landry Exp $
--- mozilla/toolkit/components/downloads/nsDownloadManager.cpp.orig	Mon Aug 27 06:49:30 2012
+++ mozilla/toolkit/components/downloads/nsDownloadManager.cpp	Sat Sep  1 02:00:15 2012
@@@@ -1165,7 +1165,7 @@@@ nsDownloadManager::GetDefaultDownloadsDirectory(nsILoc
d13 1
a13 1
@@@@ -1273,7 +1273,7 @@@@ nsDownloadManager::GetUserDownloadsDirectory(nsILocalF
@


1.7
log
@Update to seamonkey 2.11/enigmail 1.4.3.

- see http://www.seamonkey-project.org/releases/seamonkey2.11/
- remove the -rpath hack, not needed since matthew's ld.so fix from
  12/06
- backport cset from #750620 to fix ppc (and other exotic archs) build.
- force-disable gconf in configure.in (bug #765556)
- remove the chunk from #763408, packaging was fixed
@
text
@d1 4
a4 4
$OpenBSD: patch-mozilla_toolkit_components_downloads_nsDownloadManager_cpp,v 1.6 2012/06/11 15:38:33 landry Exp $
--- mozilla/toolkit/components/downloads/nsDownloadManager.cpp.orig	Wed Jun 13 03:45:36 2012
+++ mozilla/toolkit/components/downloads/nsDownloadManager.cpp	Sun Jun 17 19:57:21 2012
@@@@ -1197,7 +1197,7 @@@@ nsDownloadManager::GetDefaultDownloadsDirectory(nsILoc
d13 1
a13 1
@@@@ -1305,7 +1305,7 @@@@ nsDownloadManager::GetUserDownloadsDirectory(nsILocalF
@


1.6
log
@Update to seamonkey 2.10.

See http://www.seamonkey-project.org/releases/seamonkey2.10/ for details
- Update lightning to 1.5b1 and enigmail to 1.4.2
- add the rpath hack to workaround #668869
- dont make packaging warnings errors (#763181)
@
text
@d1 4
a4 4
$OpenBSD: patch-mozilla_toolkit_components_downloads_nsDownloadManager_cpp,v 1.4 2012/04/30 15:32:06 landry Exp $
--- mozilla/toolkit/components/downloads/nsDownloadManager.cpp.orig	Fri May 18 06:11:04 2012
+++ mozilla/toolkit/components/downloads/nsDownloadManager.cpp	Fri May 18 09:27:59 2012
@@@@ -1162,7 +1162,7 @@@@ nsDownloadManager::GetDefaultDownloadsDirectory(nsILoc
d13 1
a13 1
@@@@ -1270,7 +1270,7 @@@@ nsDownloadManager::GetUserDownloadsDirectory(nsILocalF
@


1.5
log
@Update to seamonkey 2.9.1/lightning 1.4b1/enigmail 1.5pre.

- See http://www.seamonkey-project.org/releases/seamonkey2.9/
- add patch-suite_installer_Makefile_in to avoid installing the SDk
  (corollary of Tb's patch-mail_installer_Makefile_in)
- use MOZ_DEBUG_FLAGS="-Os" on ppc as done in Tb to avoid a
  relocation overflow when linking libxul on ppc (reminded by aja@@)
@
text
@d1 4
a4 4
$OpenBSD: patch-mozilla_toolkit_components_downloads_nsDownloadManager_cpp,v 1.3 2012/02/20 20:17:49 landry Exp $
--- mozilla/toolkit/components/downloads/nsDownloadManager.cpp.orig	Sat Apr 21 00:40:23 2012
+++ mozilla/toolkit/components/downloads/nsDownloadManager.cpp	Wed Apr 25 17:50:16 2012
@@@@ -1165,7 +1165,7 @@@@ nsDownloadManager::GetDefaultDownloadsDirectory(nsILoc
d13 1
a13 1
@@@@ -1273,7 +1273,7 @@@@ nsDownloadManager::GetUserDownloadsDirectory(nsILocalF
@


1.4
log
@Update to seamonkey 2.8. (and enigmail 1.4/lightning 1.3b1)
- Fixes MFSA 2012-12->19
- see http://www.seamonkey-project.org/releases/seamonkey2.8/
- complete patchset for #691898, still fixes build on ppc (and hopefully
commited in firefox 14...)
- add patchset from #706955, workarounds #669050 (xpcshell hangs during
make install and chokes on CSPUtils.csm, threads related..)
- remove obsolete/commited patches
@
text
@d2 3
a4 3
--- mozilla/toolkit/components/downloads/nsDownloadManager.cpp.orig	Wed Jan 18 10:44:14 2012
+++ mozilla/toolkit/components/downloads/nsDownloadManager.cpp	Sun Jan 22 22:18:19 2012
@@@@ -1164,7 +1164,7 @@@@ nsDownloadManager::GetDefaultDownloadsDirectory(nsILoc
d13 1
a13 1
@@@@ -1272,7 +1272,7 @@@@ nsDownloadManager::GetUserDownloadsDirectory(nsILocalF
@


1.3
log
@Update to seamonkey 2.7.2.

Same comments as for thunderbird, and remove i18n xpis from the port,
they bring 20Mb to the package without reason and will be better as
no-arch in www/seamonkey-i18n.
@
text
@d1 1
a1 1
$OpenBSD: patch-mozilla_toolkit_components_downloads_nsDownloadManager_cpp,v 1.2 2011/08/23 20:19:33 landry Exp $
@


1.2
log
@Update to seamonkey 2.3/lightning 1.0b5/enigmail 1.3
See http://www.seamonkey-project.org/releases/seamonkey2.3/.
Remove patches merges upstream, enigmail update lifted from nigel@@'s tb update
@
text
@d1 4
a4 4
$OpenBSD: patch-mozilla_toolkit_components_downloads_nsDownloadManager_cpp,v 1.1 2011/07/24 07:31:57 landry Exp $
--- mozilla/toolkit/components/downloads/nsDownloadManager.cpp.orig	Mon Aug  1 04:57:49 2011
+++ mozilla/toolkit/components/downloads/nsDownloadManager.cpp	Thu Aug  4 23:24:42 2011
@@@@ -1159,7 +1159,7 @@@@ nsDownloadManager::GetDefaultDownloadsDirectory(nsILoc
d13 1
a13 1
@@@@ -1267,7 +1267,7 @@@@ nsDownloadManager::GetUserDownloadsDirectory(nsILocalF
@


1.1
log
@Update to seamonkey 2.2, based on Firefox/Thunderbird/Gecko 5.
See http://www.seamonkey-project.org/releases/seamonkey2.2/ for details.
- sync ipc patches from Firefox
- remove a bunch of useless patches
- install under lib/seamonkey-2.2 instead of using our homegrown install
  target.
- install langpacks as plain xpi instead of unzipping them, greatly
  shrinking PLIST
@
text
@d1 4
a4 4
$OpenBSD$
--- mozilla/toolkit/components/downloads/nsDownloadManager.cpp.orig	Mon May 30 14:31:20 2011
+++ mozilla/toolkit/components/downloads/nsDownloadManager.cpp	Mon May 30 14:31:36 2011
@@@@ -1170,7 +1170,7 @@@@ nsDownloadManager::GetDefaultDownloadsDirectory(nsILoc
d13 1
a13 1
@@@@ -1278,7 +1278,7 @@@@ nsDownloadManager::GetUserDownloadsDirectory(nsILocalF
@

