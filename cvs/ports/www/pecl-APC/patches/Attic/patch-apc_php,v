head	1.3;
access;
symbols
	OPENBSD_4_9:1.2.0.8
	OPENBSD_4_9_BASE:1.2
	OPENBSD_4_8:1.2.0.6
	OPENBSD_4_8_BASE:1.2
	OPENBSD_4_7:1.2.0.4
	OPENBSD_4_7_BASE:1.2
	OPENBSD_4_6:1.2.0.2
	OPENBSD_4_6_BASE:1.2
	OPENBSD_4_5:1.1.0.2
	OPENBSD_4_5_BASE:1.1;
locks; strict;
comment	@# @;


1.3
date	2011.03.13.17.39.36;	author jasper;	state dead;
branches;
next	1.2;

1.2
date	2009.04.22.21.24.09;	author jasper;	state Exp;
branches;
next	1.1;

1.1
date	2008.12.20.01.06.50;	author sthen;	state Exp;
branches;
next	;


desc
@@


1.3
log
@- update to 3.1.7

from brad
ok william@@ (MAINTAINER)
@
text
@$OpenBSD: patch-apc_php,v 1.2 2009/04/22 21:24:09 jasper Exp $

"Get rid of very contrived local-user XSS - can't be triggered from external"
from upstream CVS

--- apc.php.orig	Fri Dec 12 12:37:26 2008
+++ apc.php	Wed Apr 22 10:32:53 2009
@@@@ -61,7 +61,7 @@@@ function defaults($d,$v) {
 
 // rewrite $PHP_SELF to block XSS attacks
 //
-$PHP_SELF= isset($_SERVER['PHP_SELF']) ? htmlentities(strip_tags($_SERVER['PHP_SELF'],''), ENT_QUOTES) : '';
+$PHP_SELF= isset($_SERVER['PHP_SELF']) ? htmlentities(strip_tags($_SERVER['PHP_SELF'],''), ENT_QUOTES, 'UTF-8') : '';
 $time = time();
 $host = getenv('HOSTNAME');
 if($host) { $host = '('.$host.')'; }
@@@@ -1091,7 +1091,7 @@@@ EOB;
 		}
 		if (!$AUTHENTICATED) {
 			// hide all path entries if not logged in
-			$list[$k.$entry[$fieldname]]=preg_replace('/^.*(\\/|\\\\)/','<i>&lt;hidden&gt;</i>/',$entry);
+			$list[$k.$entry[$fieldname]]=preg_replace('/^.*(\\/|\\\\)/','*hidden*/',$entry);
 		} else {
 			$list[$k.$entry[$fieldname]]=$entry;
 		}
@@@@ -1110,9 +1110,10 @@@@ EOB;
 		$i=0;
 		foreach($list as $k => $entry) {
       if(!$MYREQUEST['SEARCH'] || preg_match($MYREQUEST['SEARCH'], $entry[$fieldname]) != 0) {  
+        $field_value = htmlentities(strip_tags($entry[$fieldname],''), ENT_QUOTES, 'UTF-8');
         echo
           '<tr class=tr-',$i%2,'>',
-          "<td class=td-0><a href=\"$MY_SELF&OB=",$MYREQUEST['OB'],"&SH=",md5($entry[$fieldkey]),"\">",$entry[$fieldname],'</a></td>',
+          "<td class=td-0><a href=\"$MY_SELF&OB=",$MYREQUEST['OB'],"&SH=",md5($entry[$fieldkey]),"\">",$field_value,'</a></td>',
           '<td class="td-n center">',$entry['num_hits'],'</td>',
           '<td class="td-n right">',$entry['mem_size'],'</td>',
           '<td class="td-n center">',date(DATE_FORMAT,$entry['access_time']),'</td>',
@


1.2
log
@- update pecl-APC to 3.1.2

"reads fine" William Yodlowsky (MAINTAINER)
@
text
@d1 1
a1 1
$OpenBSD: patch-apc_php,v 1.1 2008/12/20 01:06:50 sthen Exp $
@


1.1
log
@security, avoid an XSS in the apc.php web management interface.
It can only be triggered by a _local_ user on the webserver.

from maintainer on ports@@.
@
text
@d1 2
d6 3
a8 4
$OpenBSD$
--- apc.php.orig	Thu May 15 02:45:28 2008
+++ apc.php	Fri Dec 19 19:29:50 2008
@@@@ -59,7 +59,7 @@@@ function defaults($d,$v) {
d17 1
a17 1
@@@@ -1078,7 +1078,7 @@@@ EOB;
d26 1
a26 1
@@@@ -1097,9 +1097,10 @@@@ EOB;
@

