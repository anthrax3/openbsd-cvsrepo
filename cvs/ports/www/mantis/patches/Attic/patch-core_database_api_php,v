head	1.2;
access;
symbols
	OPENBSD_5_1_BASE:1.1
	OPENBSD_5_1:1.1.0.14
	OPENBSD_5_0:1.1.0.12
	OPENBSD_5_0_BASE:1.1
	OPENBSD_4_9:1.1.0.10
	OPENBSD_4_9_BASE:1.1
	OPENBSD_4_8:1.1.0.8
	OPENBSD_4_8_BASE:1.1
	OPENBSD_4_7:1.1.0.6
	OPENBSD_4_7_BASE:1.1
	OPENBSD_4_6:1.1.0.4
	OPENBSD_4_6_BASE:1.1
	OPENBSD_4_5:1.1.0.2
	OPENBSD_4_5_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2012.06.13.00.41.39;	author sthen;	state dead;
branches;
next	1.1;

1.1
date	2008.12.23.10.51.02;	author mbalmer;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Major update to Mantis 1.2.11, many (including SECURITY) fixes since
the previous version in tree which was rather outdated.  ok jasper@@
@
text
@$OpenBSD: patch-core_database_api_php,v 1.1 2008/12/23 10:51:02 mbalmer Exp $
--- core/database_api.php.orig	Tue Dec 23 11:40:48 2008
+++ core/database_api.php	Tue Dec 23 11:41:35 2008
@@@@ -248,11 +248,12 @@@@
 
 	# --------------------
 	# return the last inserted id
-	function db_insert_id($p_table = null) {
+	function db_insert_id($p_table = null,$p_column = "id") {
 		global $g_db;
 
 		if ( isset($p_table) && db_is_pgsql() ) {
 			$query = "SELECT currval('".$p_table."_id_seq')";
+			$query = "SELECT currval('" . $p_table . "_" . $p_column . "_seq')"; 
 			$result = db_query( $query );
 			return db_result($result);
 		}
@


1.1
log
@Update to version 1.1.6 and add a patch so that new users can sign up.
(See http://www.mantisbt.org/forums/viewtopic.php?f=3&t=4146 for details)

Fix found by Mischa Diehm.
@
text
@d1 1
a1 1
$OpenBSD$
@

