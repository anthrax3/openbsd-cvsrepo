head	1.1;
access;
symbols
	OPENBSD_4_8:1.1.0.4
	OPENBSD_4_7:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2010.09.21.02.31.07;	author william;	state dead;
branches
	1.1.2.1
	1.1.4.1;
next	;

1.1.2.1
date	2010.09.21.02.31.07;	author william;	state Exp;
branches;
next	;

1.1.4.1
date	2010.09.21.02.32.35;	author william;	state Exp;
branches;
next	;


desc
@@


1.1
log
@file patch-bin_lwp-download was initially added on branch OPENBSD_4_7.
@
text
@@


1.1.4.1
log
@SECURITY FIX

Resolves CVE-2010-2253

from jasper@@, thanks!
@
text
@a0 19
$OpenBSD$

SECURITY FIX

Resolves CVE-2010-2253


--- bin/lwp-download.orig	Wed Sep 15 22:33:09 2010
+++ bin/lwp-download	Wed Sep 15 22:32:50 2010
@@@@ -138,7 +138,8 @@@@ my $res = $ua->request(HTTP::Request->new(GET => $url)
 	      # validate that we don't have a harmful filename now.  The server
 	      # might try to trick us into doing something bad.
 	      if (!length($file) ||
-                  $file =~ s/([^a-zA-Z0-9_\.\-\+\~])/sprintf "\\x%02x", ord($1)/ge)
+                  $file =~ s/([^a-zA-Z0-9_\.\-\+\~])/sprintf "\\x%02x", ord($1)/ge ||
+                  $file =~ /^\./
               {
 		  die "Will not save <$url> as \"$file\".\nPlease override file name on the command line.\n";
 	      }
@


1.1.2.1
log
@SECURITY FIX

Resolves CVE-2010-2253

from jasper@@, thanks!
@
text
@a0 19
$OpenBSD$

SECURITY FIX

Resolves CVE-2010-2253


--- bin/lwp-download.orig	Wed Sep 15 22:33:09 2010
+++ bin/lwp-download	Wed Sep 15 22:32:50 2010
@@@@ -138,7 +138,8 @@@@ my $res = $ua->request(HTTP::Request->new(GET => $url)
 	      # validate that we don't have a harmful filename now.  The server
 	      # might try to trick us into doing something bad.
 	      if (!length($file) ||
-                  $file =~ s/([^a-zA-Z0-9_\.\-\+\~])/sprintf "\\x%02x", ord($1)/ge)
+                  $file =~ s/([^a-zA-Z0-9_\.\-\+\~])/sprintf "\\x%02x", ord($1)/ge ||
+                  $file =~ /^\./
               {
 		  die "Will not save <$url> as \"$file\".\nPlease override file name on the command line.\n";
 	      }
@

