head	1.29;
access;
symbols
	OPENBSD_5_4:1.27.0.2
	OPENBSD_5_4_BASE:1.27
	OPENBSD_5_3:1.24.0.4
	OPENBSD_5_3_BASE:1.24
	OPENBSD_5_2:1.24.0.2
	OPENBSD_5_2_BASE:1.24
	OPENBSD_5_1_BASE:1.18
	OPENBSD_5_1:1.18.0.2
	OPENBSD_5_0:1.11.0.2
	OPENBSD_5_0_BASE:1.11
	ajacoutot_20110321:1.1.1.1
	ajacoutot:1.1.1;
locks; strict;
comment	@# @;


1.29
date	2013.09.19.15.54.54;	author ajacoutot;	state dead;
branches;
next	1.28;

1.28
date	2013.08.12.04.11.22;	author robert;	state Exp;
branches;
next	1.27;

1.27
date	2013.07.05.09.34.36;	author jasper;	state Exp;
branches;
next	1.26;

1.26
date	2013.06.13.13.39.00;	author sthen;	state Exp;
branches;
next	1.25;

1.25
date	2013.03.11.11.44.50;	author espie;	state Exp;
branches;
next	1.24;

1.24
date	2012.06.21.07.00.20;	author ajacoutot;	state Exp;
branches;
next	1.23;

1.23
date	2012.06.11.08.33.58;	author ajacoutot;	state Exp;
branches;
next	1.22;

1.22
date	2012.06.07.10.26.38;	author robert;	state Exp;
branches;
next	1.21;

1.21
date	2012.06.04.08.22.13;	author ajacoutot;	state Exp;
branches;
next	1.20;

1.20
date	2012.04.22.11.41.55;	author ajacoutot;	state Exp;
branches;
next	1.19;

1.19
date	2012.03.28.07.47.47;	author sthen;	state Exp;
branches;
next	1.18;

1.18
date	2012.02.01.12.59.06;	author ajacoutot;	state Exp;
branches;
next	1.17;

1.17
date	2012.01.31.08.59.29;	author ajacoutot;	state Exp;
branches;
next	1.16;

1.16
date	2012.01.11.22.27.26;	author sthen;	state Exp;
branches;
next	1.15;

1.15
date	2011.11.24.15.12.25;	author ajacoutot;	state Exp;
branches;
next	1.14;

1.14
date	2011.11.16.15.56.38;	author robert;	state Exp;
branches;
next	1.13;

1.13
date	2011.10.16.15.20.33;	author ajacoutot;	state Exp;
branches;
next	1.12;

1.12
date	2011.09.16.12.00.09;	author espie;	state Exp;
branches;
next	1.11;

1.11
date	2011.07.28.09.24.35;	author ajacoutot;	state Exp;
branches;
next	1.10;

1.10
date	2011.07.22.10.20.11;	author sthen;	state Exp;
branches;
next	1.9;

1.9
date	2011.07.08.23.01.39;	author robert;	state Exp;
branches;
next	1.8;

1.8
date	2011.06.02.13.41.42;	author ajacoutot;	state Exp;
branches;
next	1.7;

1.7
date	2011.03.28.13.38.38;	author ajacoutot;	state Exp;
branches;
next	1.6;

1.6
date	2011.03.28.13.24.51;	author ajacoutot;	state Exp;
branches;
next	1.5;

1.5
date	2011.03.23.21.01.33;	author ajacoutot;	state Exp;
branches;
next	1.4;

1.4
date	2011.03.23.07.41.45;	author ajacoutot;	state Exp;
branches;
next	1.3;

1.3
date	2011.03.22.15.43.53;	author ajacoutot;	state Exp;
branches;
next	1.2;

1.2
date	2011.03.22.13.02.35;	author ajacoutot;	state Exp;
branches;
next	1.1;

1.1
date	2011.03.21.18.01.08;	author ajacoutot;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2011.03.21.18.01.08;	author ajacoutot;	state Exp;
branches;
next	;


desc
@@


1.29
log
@It makes no sense to distribute some webapps using the pkg tools when it's
just a matter of following upstream and untarring under htdocs.
webapp as a pkg needs to have some added value and no, 'pkg_add webapp' is
not easier if the app has actually no maintainer -- it is safer to follow
upstream.
webacula is one of them and is not even maintained upstream, so zap it.

discusssed with and ok sthen@@
@
text
@# $OpenBSD: Makefile,v 1.28 2013/08/12 04:11:22 robert Exp $

COMMENT=	bacula(8) web interface

DISTNAME=	webacula-5.5.1
REVISION=	7

CATEGORIES=	www sysutils

HOMEPAGE=	http://webacula.sourceforge.net/

# GPLv3
PERMIT_PACKAGE_CDROM=	Yes

MASTER_SITES=	${MASTER_SITE_SOURCEFORGE:=webacula/}

MODULES=	lang/php
RUN_DEPENDS=	lang/php/${MODPHP_VERSION},-gd \
		www/zendframework>=1.10.8p1 \
		sysutils/bacula,-main

NO_BUILD=	Yes
NO_TEST=	Yes
PKG_ARCH=	*

PREFIX=		${VARBASE}/www
INSTDIR=	${PREFIX}/webacula
TINSTDIR=	${TRUEPREFIX}/webacula
SUBST_VARS=	INSTDIR TINSTDIR

pre-configure:
	perl -pi -e 's,bin/bash,/bin/sh,g' \
		${WRKSRC}/install/{MySql,PostgreSql}/{10_make_tables.sh,20_acl_make_tables.sh}

do-install:
	mv ${WRKSRC} ${INSTDIR}
	${SUBST_CMD} ${INSTDIR}/application/config.ini \
		${INSTDIR}/install/apache/webacula.conf
.for i in install/db.conf application/config.ini html/.htaccess
	mv ${INSTDIR}/$i ${INSTDIR}/$i.dist
.endfor
	${SUBST_CMD} -c ${FILESDIR}/webacula-chroot-bconsole.sh \
		${INSTDIR}/webacula-chroot-bconsole
	find ${INSTDIR} -type f -name \*.orig -or -name \*.gitignore \
		-or -name \*.project -or -name \*.beforesubst \
		-or -name \*.original | xargs rm
	chown -R ${BINOWN}:${BINGRP} ${INSTDIR}

.include <bsd.port.mk>
@


1.28
log
@bump REVISION due to the php update
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2013/07/05 09:34:36 jasper Exp $
@


1.27
log
@use ${VARBASE} instead of hardcoding /var
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2013/06/13 13:39:00 sthen Exp $
d6 1
a6 1
REVISION=	6
@


1.26
log
@increase last_ip to varchar(40) so ipv6 fits, ok aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2013/03/11 11:44:50 espie Exp $
d26 1
a26 1
PREFIX=		/var/www
@


1.25
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2012/06/21 07:00:20 ajacoutot Exp $
d6 1
a6 1
REVISION=	5
@


1.24
log
@Adapt now that pdo_sqlite is part of main php.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2012/06/11 08:33:58 ajacoutot Exp $
a13 3
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM= Yes
PERMIT_DISTFILES_FTP=	Yes
d23 1
a23 1
NO_REGRESS=	Yes
@


1.23
log
@Use the bacula db user, not "postgres".
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2012/06/07 10:26:38 robert Exp $
d6 1
a6 1
REVISION=	4
a21 1
		php-pdo_pgsql-${MODPHP_VSPEC}|php-pdo_mysql-${MODPHP_VSPEC}|php-pdo_sqlite-${MODPHP_VSPEC}:lang/php/${MODPHP_VERSION},-pdo_pgsql \
@


1.22
log
@modify the README so that webacula can properly be configured with pgsql

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2012/06/04 08:22:13 ajacoutot Exp $
d6 1
a6 1
REVISION=	3
@


1.21
log
@Typo in comment.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2012/04/22 11:41:55 ajacoutot Exp $
d6 1
a6 1
REVISION=	2
@


1.20
log
@Use RCDIR instead of /etc/rc.d when refering to packages rc scripts.

discussed with espie and sthen
ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2012/03/28 07:47:47 sthen Exp $
d6 1
a6 1
REVISION=	1
@


1.19
log
@Remove duplicated /webacula/webacula in a path in the README. ok aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2012/02/01 12:59:06 ajacoutot Exp $
d6 1
a6 1
REVISION=	0
@


1.18
log
@Update to webacula-5.5.1 and add a couple of saner defaults to that it
works out of the box with our current version of bacula.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2012/01/31 08:59:29 ajacoutot Exp $
d6 1
@


1.17
log
@Unbreak runtime: set the CATALOG version to match the bacula version we
have in tree.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2012/01/11 22:27:26 sthen Exp $
d5 1
a5 2
DISTNAME=	webacula-5.5
REVISION=	5
d34 4
d42 1
a42 1
.for i in install/db.conf application/config.ini
d48 2
a49 1
		-or -name \*.project -or -name \*.beforesubst | xargs rm
@


1.16
log
@use MODPHP_VSPEC for either|or dependencies on php5 extension modules
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2011/11/24 15:12:25 ajacoutot Exp $
d6 1
a6 1
REVISION=	4
@


1.15
log
@Depends on bacula-client now that bconsole moved there.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2011/11/16 15:56:38 robert Exp $
d6 1
a6 1
REVISION=	3
d22 1
a22 1
		php-pdo_pgsql-*|php-pdo_mysql-*|php-pdo_sqlite-*:lang/php/${MODPHP_VERSION},-pdo_pgsql \
@


1.14
log
@switch php to version 5.3 by default
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2011/10/16 15:20:33 ajacoutot Exp $
d6 1
a6 1
REVISION=	2
d24 1
a24 1
		sysutils/bacula,pgsql,-server
@


1.13
log
@php5 -> php.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2011/09/16 12:00:09 espie Exp $
d6 1
a6 1
REVISION=	1
@


1.12
log
@normalize pkgpath
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2011/07/28 09:24:35 ajacoutot Exp $
d6 1
a6 1
REVISION=	0
@


1.11
log
@Update to webacula-5.5.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2011/07/22 10:20:11 sthen Exp $
d6 1
@


1.10
log
@Bump for PKGSPEC changes in ports/lang/php/Makefile.inc
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2011/07/08 23:01:39 robert Exp $
d5 1
a5 3
DISTNAME=	webacula-5.0.3

REVISION=	8
d37 2
a38 5
		${INSTDIR}/install/webacula.conf
.for i in install/webacula_mysql_create_database.sh \
	install/webacula_postgresql_create_database.sh \
	install/webacula_postgresql_make_tables.sh \
	application/config.ini
@


1.9
log
@switch to lang/php
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2011/06/02 13:41:42 ajacoutot Exp $
d7 1
a7 1
REVISION=	7
@


1.8
log
@Add a consistent header that substitutes FULLPKGNAME for the READMEs.

ok jasper@@ sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2011/03/28 13:38:38 ajacoutot Exp $
d7 1
a7 1
REVISION=	6
d21 3
a23 2
RUN_DEPENDS=	www/php5/extensions,-gd \
		php5-pdo_pgsql-*|php5-pdo_mysql-*|php5-pdo_sqlite-*:www/php5/extensions,-pdo_pgsql \
@


1.7
log
@Do not try to load rewrite_module if it's already loaded.
Tighten zendframework dependency.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2011/03/28 13:24:51 ajacoutot Exp $
d7 1
a7 1
REVISION=	5
@


1.6
log
@Remove now unneeded patch.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2011/03/23 21:01:33 ajacoutot Exp $
d7 1
a7 1
REVISION=	4
d23 1
a23 1
		www/zendframework \
@


1.5
log
@Simplify: this step is not needed anymore.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2011/03/23 07:41:45 ajacoutot Exp $
d7 1
a7 1
REVISION=	3
@


1.4
log
@Better webacula.conf.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2011/03/22 15:43:53 ajacoutot Exp $
d7 1
a7 1
REVISION=	2
@


1.3
log
@If no bacula-server is present, depend on bacula,pgsql,-server by default
since we also use the pdo_pgsql module for php by default.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2011/03/22 13:02:35 ajacoutot Exp $
d7 1
a7 1
REVISION=	1
d37 2
a38 1
	${SUBST_CMD} ${INSTDIR}/application/config.ini
a44 2
	${SUBST_CMD} -c ${FILESDIR}/webacula.conf \
		${INSTDIR}/webacula.conf.dist
@


1.2
log
@Add missing (obvious) dependency...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2011/03/21 18:01:08 ajacoutot Exp $
d7 1
a7 1
REVISION=	0
d24 1
a24 1
		sysutils/bacula,-server
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d7 2
d23 2
a24 1
		www/zendframework
@


1.1.1.1
log
@Import webacula-5.0.3.

Webacula, i.e. Web + Bacula is a web interface for the Bacula backup
system.

ok sthen@@ robert@@
@
text
@@
