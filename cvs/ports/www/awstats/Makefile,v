head	1.14;
access;
symbols
	OPENBSD_6_2:1.14.0.4
	OPENBSD_6_2_BASE:1.14
	OPENBSD_6_1:1.14.0.2
	OPENBSD_6_1_BASE:1.14
	OPENBSD_6_0:1.13.0.2
	OPENBSD_6_0_BASE:1.13
	OPENBSD_5_9:1.12.0.2
	OPENBSD_5_9_BASE:1.12
	OPENBSD_5_8:1.11.0.4
	OPENBSD_5_8_BASE:1.11
	OPENBSD_5_7:1.10.0.4
	OPENBSD_5_7_BASE:1.10
	OPENBSD_5_6:1.10.0.2
	OPENBSD_5_6_BASE:1.10
	OPENBSD_5_5:1.9.0.2
	OPENBSD_5_5_BASE:1.9
	OPENBSD_5_4:1.7.0.2
	OPENBSD_5_4_BASE:1.7
	OPENBSD_5_3:1.4.0.2
	OPENBSD_5_3_BASE:1.4
	rpe_20121118:1.1.1.1
	rpe:1.1.1;
locks; strict;
comment	@# @;


1.14
date	2016.12.19.17.31.45;	author rpe;	state Exp;
branches;
next	1.13;
commitid	fyqQOC1k1IMfbxwM;

1.13
date	2016.05.08.15.55.13;	author rpe;	state Exp;
branches;
next	1.12;
commitid	fllAfWtfeJdWTrFa;

1.12
date	2015.10.24.09.13.18;	author ajacoutot;	state Exp;
branches;
next	1.11;
commitid	IK7jITZGneLnzEtv;

1.11
date	2015.07.28.16.47.24;	author rpe;	state Exp;
branches;
next	1.10;
commitid	P5r0DiVWQvglPYKi;

1.10
date	2014.05.30.13.14.09;	author sthen;	state Exp;
branches;
next	1.9;

1.9
date	2014.02.07.18.14.46;	author rpe;	state Exp;
branches;
next	1.8;

1.8
date	2013.08.09.23.55.54;	author rpe;	state Exp;
branches;
next	1.7;

1.7
date	2013.07.05.09.34.35;	author jasper;	state Exp;
branches;
next	1.6;

1.6
date	2013.03.16.11.52.34;	author rpe;	state Exp;
branches;
next	1.5;

1.5
date	2013.03.11.11.44.41;	author espie;	state Exp;
branches;
next	1.4;

1.4
date	2012.12.28.18.13.51;	author rpe;	state Exp;
branches;
next	1.3;

1.3
date	2012.12.09.22.05.25;	author rpe;	state Exp;
branches;
next	1.2;

1.2
date	2012.11.19.07.35.04;	author jasper;	state Exp;
branches;
next	1.1;

1.1
date	2012.11.18.10.53.30;	author rpe;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2012.11.18.10.53.30;	author rpe;	state Exp;
branches;
next	;


desc
@@


1.14
log
@Update www/awstats to version 7.6

Noteable changes:
- Security fix: "|" not allowed into DirLang parameter.
- Security fix: More restrictive rule for using AWSTATS_ENABLE_CONFIG_DIR.

OK @@aja
@
text
@# $OpenBSD: Makefile,v 1.13 2016/05/08 15:55:13 rpe Exp $

COMMENT=		free real-time logfile analyzer

DISTNAME=		awstats-7.6

CATEGORIES=		www

HOMEPAGE=		http://awstats.sourceforge.net/

MAINTAINER=		Robert Peichaer <rpe@@openbsd.org>

# GPLv3+
PERMIT_PACKAGE_CDROM=	Yes

MASTER_SITES=		${MASTER_SITE_SOURCEFORGE:=awstats/}

RUN_DEPENDS=		net/p5-Geo-IP \
			www/p5-libwww

NO_BUILD=		Yes
NO_TEST=		Yes

PKG_ARCH=		*

PREFIX=			${VARBASE}/www
INSTDIR=		${PREFIX}/awstats

ACCESSLOG=		LogFile="${PREFIX}/logs/access.log"
GEOIPDAT=		${LOCALBASE}/share/examples/GeoIP/GeoIP.dat
GEOIPPLUGIN=		LoadPlugin="geoip GEOIP_STANDARD ${GEOIPDAT}"

pre-configure:
	sed -i -e "s,/usr/local/awstats,${INSTDIR},g;" \
		-e "s,/var/lib/awstats,${INSTDIR}/data,g;" \
		${WRKSRC}/docs/*.html \
		${WRKSRC}/tools/{httpd_conf,*.pl} \
		${WRKSRC}/wwwroot/cgi-bin/awstats.{pl,model.conf}
	sed -i -e 's,^LogFile="/var/log/httpd/mylog.log",${ACCESSLOG},g;' \
		-e 's,^SiteDomain="",SiteDomain="localhost",g;' \
		-e 's,^DirData=".",DirData="${INSTDIR}/data",g;' \
		-e 's,^DirCgi="/cgi-bin",DirCgi="/awstats/cgi-bin",g;' \
		-e 's,^DirIcons="/icon",DirIcons="/awstats/icon",g;' \
		-e 's,^#LoadPlugin="geoip GEOIP_STANDARD /pathto/GeoIP.dat",${GEOIPPLUGIN},g;' \
		${WRKSRC}/wwwroot/cgi-bin/awstats.model.conf
	rm ${WRKSRC}/tools/webmin/.gitignore

do-install:
	${INSTALL_DATA_DIR} ${INSTDIR}/data
	cp -R ${WRKSRC}/* ${INSTDIR}/
	chown -R ${SHAREOWN}:${SHAREGRP} ${INSTDIR}
	find ${INSTDIR} -name '*.pl' -type f -exec chmod u=rwx,go=rx {} +
	find ${INSTDIR} ! -name '*.pl' -type f -exec chmod u=rw,go=r {} +

.include <bsd.port.mk>
@


1.13
log
@Update www/awstats to 7.5

OK aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2015/10/24 09:13:18 ajacoutot Exp $
d5 1
a5 1
DISTNAME=		awstats-7.5
@


1.12
log
@typo: ngix -> nginx
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2015/07/28 16:47:24 rpe Exp $
d5 1
a5 2
DISTNAME=		awstats-7.4
REVISION=		0
@


1.11
log
@Update www/awstats to 7.4
- use sed -i instead of perl
- make the port work with nginx
- change README to reflect that

feedback and OK aja@@
OK sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2014/05/30 13:14:09 sthen Exp $
d6 1
@


1.10
log
@/var/www/conf/modules.sample is no longer provided by base; noticed by florian@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2014/02/07 18:14:46 rpe Exp $
d5 1
a5 2
DISTNAME=		awstats-7.3
REVISION=		0
d26 1
a26 1
PREFIX=		${VARBASE}/www
d29 1
a29 1
ACCESSLOG=		LogFile="${PREFIX}/logs/access_log"
d34 1
a34 2
	@@perl -pi \
		-e "s,/usr/local/awstats,${INSTDIR},g;" \
d37 3
a39 6
		${WRKSRC}/tools/*.pl \
		${WRKSRC}/tools/httpd_conf \
		${WRKSRC}/wwwroot/cgi-bin/awstats.model.conf \
		${WRKSRC}/wwwroot/cgi-bin/awstats.pl
	@@perl -pi \
		-e 's,^LogFile="/var/log/httpd/mylog.log",${ACCESSLOG},g;' \
d42 2
a43 2
		-e 's,^DirCgi="/cgi-bin",DirCgi="/awstats",g;' \
		-e 's,^DirIcons="/icon",DirIcons="/awstatsicons",g;' \
d46 1
a46 1
	@@rm ${WRKSRC}/tools/webmin/.gitignore
@


1.9
log
@Update awstats to 7.3

OK aja@@ sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2013/08/09 23:55:54 rpe Exp $
d6 1
d10 1
a10 1
HOMEPAGE=	 	http://awstats.sourceforge.net/
@


1.8
log
@update awstats to 7.2 and change license marker to GPLv3+

ok ajacoutot@@, sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2013/07/05 09:34:35 jasper Exp $
d5 1
a5 1
DISTNAME=		awstats-7.2
d50 1
@


1.7
log
@use ${VARBASE} instead of hardcoding /var
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2013/03/16 11:52:34 rpe Exp $
d5 1
a5 1
DISTNAME=		awstats-7.1.1
d13 1
a13 1
# GPLv2
@


1.6
log
@update to awstats-7.1.1

New features:
- Add windows 8 detection
- Add support of %time5 for iso date times.
- Fix problems with Perl 5.14

ok aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2013/03/11 11:44:41 espie Exp $
d26 1
a26 1
PREFIX=			/var/www
@


1.5
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2012/12/28 18:13:51 rpe Exp $
d5 1
a5 1
DISTNAME=		awstats-7.1
@


1.4
log
@- update to awstats-7.1

New features/improvements:
- Update translations.
- Update browsers list.
- Add example of nginx setup.
- Add some patches from debian package.
- Rename domain name into documentation to awstats.org
- Can allow urls with awredir without using md5 key parameter.
- Usage of databasebreak option possible with awstats_buildstaticpages.
- Add rel=nofollow on links.
- Add option AddLinkToExternalCGIWrapper to add link to a wrapper script
  into each title of Dolibarr reports. This can be used to add a wrapper
  to download data into a CSV file for example.

Fixes:
- Security fix into awredir.pl
- Fix: Case of uk in googlechart api.
- Fix: Compatibility with recent perl version.

ok ajacoutot@@ kirby@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2012/12/09 22:05:25 rpe Exp $
a14 3
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM= Yes
PERMIT_DISTFILES_FTP=	Yes
d22 1
a22 1
NO_REGRESS=		Yes
@


1.3
log
@- set NO_REGRESS=Yes
- mark as arch independed
- make the pre-configure/do-install blocks more compact using vars
- adjust paths in docs/*.html too to reflect the installation
- mention in README, that the default config works for localhost
  httpd out of the box and how to access the reports
- bump REVISION

feedback from and ok kirby@@, sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2012/11/19 07:35:04 jasper Exp $
d5 1
a5 2
DISTNAME=		awstats-7.0
REVISION=		1
d58 1
@


1.2
log
@Security fix for CVE-2012-4547,
awstats: potentially susceptible to XSS attacks

ok rpe@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2012/11/18 10:53:30 rpe Exp $
d6 1
a6 1
REVISION=		0
d26 3
d31 5
d39 3
a41 1
		-e "s,/usr/local/awstats,/var/www/awstats,g;" \
d44 1
d47 1
a47 5
		-e "s,/var/lib/awstats,/var/www/awstats/data,g;" \
		${WRKSRC}/wwwroot/cgi-bin/awstats.model.conf \
		${WRKSRC}/tools/*.pl
	@@perl -pi \
		-e 's,^LogFile="/var/log/httpd/mylog.log",LogFile="/var/www/logs/access_log",g;' \
d49 1
a49 1
		-e 's,^DirData=".",DirData="/var/www/awstats/data",g;' \
d52 1
a52 1
		-e 's,^#LoadPlugin="geoip GEOIP_STANDARD /pathto/GeoIP.dat",LoadPlugin="geoip GEOIP_STANDARD /usr/local/share/examples/GeoIP/GeoIP.dat",g;' \
d56 4
a59 4
	${INSTALL_DATA_DIR} ${PREFIX}/awstats/data
	cp -R ${WRKSRC}/* ${PREFIX}/awstats
	chown -R ${SHAREOWN}:${SHAREGRP} ${PREFIX}/awstats
	find ${PREFIX}/awstats ! -name '*.pl' -type f -exec chmod u=rw,go=r {} +
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d6 1
@


1.1.1.1
log
@import awstats-7.0

AWStats is a free powerful and featureful tool that generates
advanced web, streaming, ftp or mail server statistics, graphically.

This log analyzer works as a CGI or from command line and shows you
all possible information your log contains, in few graphical web
pages. It uses a partial information file to be able to process
large log files, often and quickly. It can analyze log files from
all major server tools like Apache log files (NCSA combined/XLF/ELF
log format or common/CLF log format), WebStar, IIS (W3C log format)
and a lot of other web, proxy, wap, streaming servers, mail servers
and some ftp servers.

with help and ok ajacoutot@@ sthen@@
@
text
@@
