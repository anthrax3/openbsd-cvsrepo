head	1.1;
access;
symbols
	OPENBSD_6_2:1.1.0.22
	OPENBSD_6_2_BASE:1.1
	OPENBSD_6_1:1.1.0.20
	OPENBSD_6_1_BASE:1.1
	OPENBSD_6_0:1.1.0.18
	OPENBSD_6_0_BASE:1.1
	OPENBSD_5_9:1.1.0.14
	OPENBSD_5_9_BASE:1.1
	OPENBSD_5_8:1.1.0.16
	OPENBSD_5_8_BASE:1.1
	OPENBSD_5_7:1.1.0.12
	OPENBSD_5_7_BASE:1.1
	OPENBSD_5_6:1.1.0.10
	OPENBSD_5_6_BASE:1.1
	OPENBSD_5_5:1.1.0.8
	OPENBSD_5_5_BASE:1.1
	OPENBSD_5_4:1.1.0.6
	OPENBSD_5_4_BASE:1.1
	OPENBSD_5_3:1.1.0.4
	OPENBSD_5_3_BASE:1.1
	OPENBSD_5_2:1.1.0.2
	OPENBSD_5_2_BASE:1.1;
locks; strict;
comment	@# @;


1.1
date	2012.03.16.22.01.37;	author sthen;	state Exp;
branches;
next	;


desc
@@


1.1
log
@Rename getline, drop USE_GROFF, more exact license marker
@
text
@$OpenBSD$
--- request.c.orig	Fri Mar 16 21:59:09 2012
+++ request.c	Fri Mar 16 21:59:24 2012
@@@@ -49,7 +49,7 @@@@
 
 static int      read_header(int, struct req *);
 static char     sgetc(int);
-static size_t   getline(int, char[], int);
+static size_t   my_getline(int, char[], int);
 static int      do_request(int, struct req *);
 
 void
@@@@ -63,7 +63,7 @@@@ keep_alive:
 	(void) memset(&r, 0, sizeof(r));
 	r.cl = clinfo;
 
-	if (getline(cl, buf, sizeof(buf)) < 1)
+	if (my_getline(cl, buf, sizeof(buf)) < 1)
 		*buf = '\0';
 
 	if ((http_url(&r, buf)) == 0) {
@@@@ -189,7 +189,7 @@@@ read_header(int cl, struct req * r)
 	char           *b, *p;
 
 	i = 0;
-	while ((len = getline(cl, buf, sizeof(buf))) > 0 && i < sizeof(r->header) - 1) {
+	while ((len = my_getline(cl, buf, sizeof(buf))) > 0 && i < sizeof(r->header) - 1) {
 		b = buf;
 		while (isspace((int) *b) && *(b++) != '\0');
 		if (*b == '\0')
@@@@ -228,7 +228,7 @@@@ sgetc(int s)
 }
 
 static          size_t
-getline(int s, char buf[], int len)
+my_getline(int s, char buf[], int len)
 {
 	int             c;
 	size_t          i;
@@@@ -493,7 +493,7 @@@@ do_request(int cl, struct req * r)
 	}
 	if (r->type != CONNECT) {
 		i = 0;
-		while ((len = getline(s, buf, sizeof(buf))) > 0 && i < sizeof(r->header) - 1) {
+		while ((len = my_getline(s, buf, sizeof(buf))) > 0 && i < sizeof(r->header) - 1) {
 			DEBUG(("do_request() => got remote header line: (%s)", buf));
 			r->header[i] = (char *) my_alloc(len + 1);
 			(void) strcpy(r->header[i++], buf);
@
