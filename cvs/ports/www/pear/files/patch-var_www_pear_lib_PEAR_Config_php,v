head	1.3;
access;
symbols
	OPENBSD_6_2:1.3.0.6
	OPENBSD_6_2_BASE:1.3
	OPENBSD_6_1:1.3.0.4
	OPENBSD_6_1_BASE:1.3
	OPENBSD_6_0:1.3.0.2
	OPENBSD_6_0_BASE:1.3
	OPENBSD_5_9:1.2.0.16
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.2.0.18
	OPENBSD_5_8_BASE:1.2
	OPENBSD_5_7:1.2.0.14
	OPENBSD_5_7_BASE:1.2
	OPENBSD_5_6:1.2.0.12
	OPENBSD_5_6_BASE:1.2
	OPENBSD_5_5:1.2.0.10
	OPENBSD_5_5_BASE:1.2
	OPENBSD_5_4:1.2.0.8
	OPENBSD_5_4_BASE:1.2
	OPENBSD_5_3:1.2.0.6
	OPENBSD_5_3_BASE:1.2
	OPENBSD_5_2:1.2.0.4
	OPENBSD_5_2_BASE:1.2
	OPENBSD_5_1_BASE:1.2
	OPENBSD_5_1:1.2.0.2
	OPENBSD_5_0:1.1.0.2
	OPENBSD_5_0_BASE:1.1;
locks; strict;
comment	@# @;


1.3
date	2016.04.01.18.46.06;	author sthen;	state Exp;
branches;
next	1.2;
commitid	80YllD0oDPOwc9KE;

1.2
date	2011.11.16.13.29.13;	author robert;	state Exp;
branches;
next	1.1;

1.1
date	2011.07.08.18.40.45;	author robert;	state Exp;
branches;
next	;


desc
@@


1.3
log
@Switch pear to a newer version. We previously used a tarball with a slightly
modified version of the go-pear php script but this was awkward to generate
and newer versions no longer support recent PHP. So instead I have changed
to using an unmodified go-pear.phar archive (mirrored to include a version
number, but there are no changes to the upstream file).

go-pear.phar is normally interactive and doesn't allow presetting parameters
or just piping a simple list of answers, so I am driving it with Expect.pm
instead.

Some bumps/updates to follow as XML-Util moved to the main pear distro.

ok robert@@
@
text
@$OpenBSD: patch-var_www_pear_lib_PEAR_Config_php,v 1.2 2011/11/16 13:29:13 robert Exp $
--- var/www/pear/lib/PEAR/Config.php.orig	Wed Mar 30 22:25:04 2016
+++ var/www/pear/lib/PEAR/Config.php	Wed Mar 30 22:25:05 2016
@@@@ -79,11 +79,7 @@@@ if (getenv('PHP_PEAR_HTTP_PROXY')) {
 if (getenv('PHP_PEAR_INSTALL_DIR')) {
     define('PEAR_CONFIG_DEFAULT_PHP_DIR', getenv('PHP_PEAR_INSTALL_DIR'));
 } else {
-    if (@@file_exists($PEAR_INSTALL_DIR) && is_dir($PEAR_INSTALL_DIR)) {
-        define('PEAR_CONFIG_DEFAULT_PHP_DIR', $PEAR_INSTALL_DIR);
-    } else {
-        define('PEAR_CONFIG_DEFAULT_PHP_DIR', $PEAR_INSTALL_DIR);
-    }
+    define('PEAR_CONFIG_DEFAULT_PHP_DIR', '/var/www/pear'.'/lib');
 }
 
 // Default for metadata_dir
@@@@ -113,8 +109,7 @@@@ if (getenv('PHP_PEAR_EXTENSION_DIR')) {
 if (getenv('PHP_PEAR_DOC_DIR')) {
     define('PEAR_CONFIG_DEFAULT_DOC_DIR', getenv('PHP_PEAR_DOC_DIR'));
 } else {
-    define('PEAR_CONFIG_DEFAULT_DOC_DIR',
-           $PEAR_INSTALL_DIR.DIRECTORY_SEPARATOR.'docs');
+    define('PEAR_CONFIG_DEFAULT_DOC_DIR', '/var/www/pear'.'/doc');
 }
 
 // Default for bin_dir
@@@@ -128,8 +123,7 @@@@ if (getenv('PHP_PEAR_BIN_DIR')) {
 if (getenv('PHP_PEAR_DATA_DIR')) {
     define('PEAR_CONFIG_DEFAULT_DATA_DIR', getenv('PHP_PEAR_DATA_DIR'));
 } else {
-    define('PEAR_CONFIG_DEFAULT_DATA_DIR',
-           $PEAR_INSTALL_DIR.DIRECTORY_SEPARATOR.'data');
+    define('PEAR_CONFIG_DEFAULT_DATA_DIR', '/var/www/pear'.'/data');
 }
 
 // Default for cfg_dir
@@@@ -164,8 +158,7 @@@@ if (getenv('PHP_PEAR_MAN_DIR')) {
 if (getenv('PHP_PEAR_TEST_DIR')) {
     define('PEAR_CONFIG_DEFAULT_TEST_DIR', getenv('PHP_PEAR_TEST_DIR'));
 } else {
-    define('PEAR_CONFIG_DEFAULT_TEST_DIR',
-           $PEAR_INSTALL_DIR.DIRECTORY_SEPARATOR.'tests');
+    define('PEAR_CONFIG_DEFAULT_TEST_DIR', '/var/www/pear'.'/tests');
 }
 
 // Default for temp_dir
@@@@ -242,9 +235,7 @@@@ if (getenv('PHP_PEAR_SIG_TYPE')) {
 if (getenv('PHP_PEAR_SIG_BIN')) {
     define('PEAR_CONFIG_DEFAULT_SIG_BIN', getenv('PHP_PEAR_SIG_BIN'));
 } else {
-    define('PEAR_CONFIG_DEFAULT_SIG_BIN',
-           System::which(
-               'gpg', OS_WINDOWS ? 'c:\gnupg\gpg.exe' : '/usr/local/bin/gpg'));
+    define('PEAR_CONFIG_DEFAULT_SIG_BIN', PHP_PREFIX . '/bin/gpg');
 }
 
 // Default for sig_keydir
@


1.2
log
@update to 1.9.4
@
text
@d1 4
a4 4
$OpenBSD$
--- var/www/pear/lib/PEAR/Config.php.orig	Wed Nov 16 14:18:34 2011
+++ var/www/pear/lib/PEAR/Config.php	Wed Nov 16 14:20:26 2011
@@@@ -80,11 +80,7 @@@@
d16 2
a17 2
 // Default for ext_dir
@@@@ -107,8 +103,7 @@@@
d27 1
a27 1
@@@@ -122,8 +117,7 @@@@
d37 1
a37 1
@@@@ -146,8 +140,7 @@@@
d47 1
a47 1
@@@@ -224,9 +217,7 @@@@
@


1.1
log
@cope with changed php binary path
@
text
@d1 4
a4 3
--- ./var/www/pear/lib/PEAR/Config.php.orig	Fri Jul  8 20:29:44 2011
+++ ./var/www/pear/lib/PEAR/Config.php	Fri Jul  8 20:29:44 2011
@@@@ -84,12 +84,7 @@@@
d8 2
a9 3
-    if (file_exists($PEAR_INSTALL_DIR) && is_dir($PEAR_INSTALL_DIR)) {
-        define('PEAR_CONFIG_DEFAULT_PHP_DIR',
-               $PEAR_INSTALL_DIR);
d17 1
a17 1
@@@@ -112,8 +107,7 @@@@
d27 1
a27 1
@@@@ -127,8 +121,7 @@@@
d37 1
a37 1
@@@@ -151,8 +144,7 @@@@
d47 1
a47 12
@@@@ -168,9 +160,7 @@@@
 if (getenv('PHP_PEAR_CACHE_DIR')) {
     define('PEAR_CONFIG_DEFAULT_CACHE_DIR', getenv('PHP_PEAR_CACHE_DIR'));
 } else {
-    define('PEAR_CONFIG_DEFAULT_CACHE_DIR',
-           System::tmpdir() . DIRECTORY_SEPARATOR . 'pear' .
-           DIRECTORY_SEPARATOR . 'cache');
+    define('PEAR_CONFIG_DEFAULT_CACHE_DIR', '/var/www/pear'.'/cache');
 }
 
 // Default for download_dir
@@@@ -229,9 +219,7 @@@@
@

