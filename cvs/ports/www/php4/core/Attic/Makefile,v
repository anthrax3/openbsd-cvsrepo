head	1.39;
access;
symbols
	OPENBSD_4_3:1.38.0.2
	OPENBSD_4_3_BASE:1.38
	OPENBSD_4_2:1.36.0.2
	OPENBSD_4_2_BASE:1.36
	OPENBSD_4_1:1.35.0.2
	OPENBSD_4_1_BASE:1.35
	OPENBSD_4_0:1.34.0.2
	OPENBSD_4_0_BASE:1.34
	OPENBSD_3_9:1.32.0.2
	OPENBSD_3_9_BASE:1.32
	OPENBSD_3_8:1.29.0.2
	OPENBSD_3_8_BASE:1.29
	OPENBSD_3_7:1.27.0.2
	OPENBSD_3_7_BASE:1.27
	OPENBSD_3_6:1.19.0.2
	OPENBSD_3_6_BASE:1.19
	OPENBSD_3_5:1.17.0.2
	OPENBSD_3_5_BASE:1.17
	OPENBSD_3_4:1.16.0.2
	OPENBSD_3_4_BASE:1.16
	OPENBSD_3_3:1.7.0.2
	OPENBSD_3_3_BASE:1.7
	OPENBSD_3_2:1.6.0.2
	OPENBSD_3_2_BASE:1.6
	avsm_2002-06-24:1.1.1.1
	avsm:1.1.1;
locks; strict;
comment	@# @;


1.39
date	2008.05.27.07.07.28;	author jasper;	state dead;
branches;
next	1.38;

1.38
date	2008.01.04.17.48.38;	author espie;	state Exp;
branches;
next	1.37;

1.37
date	2007.09.15.20.38.25;	author merdely;	state Exp;
branches;
next	1.36;

1.36
date	2007.05.07.13.46.59;	author bernd;	state Exp;
branches;
next	1.35;

1.35
date	2006.11.23.20.08.32;	author espie;	state Exp;
branches;
next	1.34;

1.34
date	2006.08.04.00.10.42;	author espie;	state Exp;
branches;
next	1.33;

1.33
date	2006.07.18.21.22.56;	author alek;	state Exp;
branches;
next	1.32;

1.32
date	2006.02.08.04.54.50;	author david;	state Exp;
branches;
next	1.31;

1.31
date	2005.11.07.21.33.58;	author bernd;	state Exp;
branches;
next	1.30;

1.30
date	2005.11.01.11.09.31;	author mbalmer;	state Exp;
branches;
next	1.29;

1.29
date	2005.08.31.22.12.54;	author robert;	state Exp;
branches
	1.29.2.1;
next	1.28;

1.28
date	2005.04.04.21.11.42;	author robert;	state Exp;
branches;
next	1.27;

1.27
date	2005.02.06.13.10.38;	author wilfried;	state Exp;
branches
	1.27.2.1;
next	1.26;

1.26
date	2005.01.30.15.29.07;	author alek;	state Exp;
branches;
next	1.25;

1.25
date	2004.12.20.16.28.57;	author robert;	state Exp;
branches;
next	1.24;

1.24
date	2004.12.20.16.25.56;	author robert;	state Exp;
branches;
next	1.23;

1.23
date	2004.12.18.14.15.55;	author robert;	state Exp;
branches;
next	1.22;

1.22
date	2004.12.11.13.29.22;	author alek;	state Exp;
branches;
next	1.21;

1.21
date	2004.11.24.19.03.15;	author robert;	state Exp;
branches;
next	1.20;

1.20
date	2004.11.18.16.36.18;	author robert;	state Exp;
branches;
next	1.19;

1.19
date	2004.08.03.12.54.40;	author espie;	state Exp;
branches
	1.19.2.1;
next	1.18;

1.18
date	2004.06.08.15.59.54;	author robert;	state Exp;
branches;
next	1.17;

1.17
date	2004.01.05.17.51.29;	author avsm;	state Exp;
branches
	1.17.2.1;
next	1.16;

1.16
date	2003.08.28.22.30.38;	author avsm;	state Exp;
branches
	1.16.2.1;
next	1.15;

1.15
date	2003.08.21.15.05.21;	author espie;	state Exp;
branches;
next	1.14;

1.14
date	2003.08.21.13.42.22;	author espie;	state Exp;
branches;
next	1.13;

1.13
date	2003.05.30.23.46.16;	author avsm;	state Exp;
branches;
next	1.12;

1.12
date	2003.05.27.22.10.59;	author avsm;	state Exp;
branches;
next	1.11;

1.11
date	2003.05.23.20.06.22;	author avsm;	state Exp;
branches;
next	1.10;

1.10
date	2003.05.07.14.13.01;	author avsm;	state Exp;
branches;
next	1.9;

1.9
date	2003.05.02.19.49.00;	author avsm;	state Exp;
branches;
next	1.8;

1.8
date	2003.04.03.10.26.25;	author avsm;	state Exp;
branches;
next	1.7;

1.7
date	2003.02.06.05.28.49;	author brad;	state Exp;
branches;
next	1.6;

1.6
date	2002.09.11.23.16.48;	author avsm;	state Exp;
branches
	1.6.2.1;
next	1.5;

1.5
date	2002.08.12.04.27.41;	author avsm;	state Exp;
branches;
next	1.4;

1.4
date	2002.07.12.10.13.56;	author avsm;	state Exp;
branches;
next	1.3;

1.3
date	2002.07.09.19.47.43;	author avsm;	state Exp;
branches;
next	1.2;

1.2
date	2002.07.08.21.33.33;	author avsm;	state Exp;
branches;
next	1.1;

1.1
date	2002.06.24.19.23.41;	author avsm;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2002.06.24.19.23.41;	author avsm;	state Exp;
branches;
next	;

1.6.2.1
date	2003.02.06.05.35.34;	author brad;	state Exp;
branches;
next	;

1.16.2.1
date	2004.07.20.23.23.06;	author robert;	state Exp;
branches;
next	;

1.17.2.1
date	2005.04.20.14.34.52;	author robert;	state Exp;
branches;
next	;

1.19.2.1
date	2005.04.20.14.32.53;	author robert;	state Exp;
branches;
next	1.19.2.2;

1.19.2.2
date	2005.07.23.13.37.20;	author robert;	state Exp;
branches;
next	1.19.2.3;

1.19.2.3
date	2005.09.12.19.23.43;	author sturm;	state Exp;
branches;
next	;

1.27.2.1
date	2005.05.23.20.21.31;	author robert;	state Exp;
branches;
next	1.27.2.2;

1.27.2.2
date	2005.09.12.19.29.14;	author sturm;	state Exp;
branches;
next	1.27.2.3;

1.27.2.3
date	2005.11.03.09.24.50;	author sturm;	state Exp;
branches;
next	1.27.2.4;

1.27.2.4
date	2005.11.10.21.22.26;	author robert;	state Exp;
branches;
next	;

1.29.2.1
date	2005.11.03.09.26.15;	author sturm;	state Exp;
branches;
next	1.29.2.2;

1.29.2.2
date	2005.11.10.21.21.24;	author robert;	state Exp;
branches;
next	;


desc
@@


1.39
log
@it's a sunny day....and the right time to kill php4.

it has been unlinked from the builds for some monthts now, and everybody
should've upgraded to php5 a long time ago.

from brad@@, ok robert@@
@
text
@# $OpenBSD: Makefile,v 1.38 2008/01/04 17:48:38 espie Exp $

MULTI_PACKAGES=	-main -pear

COMMENT-main=	server-side HTML-embedded scripting language
COMMENT-pear=	base classes for common PHP tasks
PKGNAME-main=	php4-core-${V}p3
FULLPKGNAME-pear= php4-pear-${V}p2

CONFIGURE_ARGS+= --with-apxs=/usr/sbin/apxs \
		--without-mysql \
		--enable-xml \
		--enable-wddx \
		--enable-cli \
		--with-iconv=${LOCALBASE} \
		--with-gettext=${LOCALBASE} \
		--enable-dio \
		--with-pear=${PEAR_DIR} \
		--enable-bcmath \
		--enable-session \
		--enable-trans-sid \
		--enable-calendar \
		--enable-ctype \
		--enable-ftp \
		--with-pcre-regex \
		--with-posix \
		--enable-sockets \
		--enable-sysvsem \
		--enable-sysvshm \
		--enable-yp \
		--enable-exif

# some variables to substitute
SUBST_VARS=	PHP_CONFIG_FILE
PHP_VERSION=	${V}

.for i in TRUEPREFIX PHP_CONFIG_FILE MODULES_DIR PHP_VERSION APACHE_MODULE_DIR
PHPXS_SUBST+= -e 's,${i},${${i}},'
.endfor

WANTLIB-main=	c crypto des m ssl stdc++ z pthread
MODULES=	devel/gettext

.if ${MACHINE_ARCH} == "i386"
LIB_DEPENDS-main=${LIB_DEPENDS} recode::converters/recode
CONFIGURE_ARGS+= --with-recode=${LOCALBASE}
.endif

PREFIX-pear=		${CHROOT_DIR}
RUN_DEPENDS-pear=	:php4-core-${V}:www/php4/core
LIB_DEPENDS-pear=

pre-fake:
	${INSTALL_DATA_DIR} ${PREFIX}/${APACHE_MODULE_SUBDIR}

INSTALL_TARGET= install-pear install-headers install-build install-programs
DESTDIRNAME=	INSTALL_ROOT

pre-configure:
	@@perl -p -i.orig -e "s,OPENBSD_PEAR_ROOT,'${CHROOT_DIR}/pear',g" \
	    ${WRKSRC}/pear/PEAR/Config.php ${WRKSRC}/scripts/phpize.in \
	    ${WRKSRC}/scripts/php-config.in

post-install:
	${INSTALL_DATA} ${WRKBUILD}/.libs/libphp4.so ${PREFIX}/${APACHE_MODULE_SUBDIR}
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/php4
	${INSTALL_PROGRAM} ${WRKBUILD}/sapi/cli/php ${PREFIX}/bin
.for i in dist recommended
	@@sed -e 's,MODULES_DIR,${MODULES_DIR},' \
	     -e 's,OPENBSD_INCLUDE_PATH,/pear/lib:${CHROOT_DIR}/pear/lib,' \
		<${WRKSRC}/php.ini-${i} \
		>${PREFIX}/share/examples/php4/php.ini-${i}
.endfor
	@@sed ${PHPXS_SUBST} <${FILESDIR}/phpxs >${PREFIX}/sbin/phpxs
	@@chown ${BINOWN}:${BINGRP} ${PREFIX}/sbin/phpxs
	@@chmod ${BINMODE} ${PREFIX}/sbin/phpxs
	${INSTALL_MAN} ${WRKSRC}/sapi/cli/php.1 ${PREFIX}/man/man1

.include <bsd.port.mk>
@


1.38
log
@tweak FAKE_FLAGS semantics to saner defaults.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2007/09/15 20:38:25 merdely Exp $
@


1.37
log
@Remove surrounding quotes from
COMMENT-*/ERRORS/NO_REGRESS/PERMIT_*/REGRESS_IS_INTERACTIVE

Change '.include "bsd.port.mk"' to '.include <bsd.port.mk>' while here
(ok naddy@@)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2007/05/07 13:46:59 bernd Exp $
d57 1
a57 1
FAKE_FLAGS= 	INSTALL_ROOT=${DESTDIR}
@


1.36
log
@Add @@conflict markers. robert@@ will teach php4 how to use the pear port
later.

ok robert@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2006/11/23 20:08:32 espie Exp $
d5 2
a6 2
COMMENT-main=	"server-side HTML-embedded scripting language"
COMMENT-pear=	"base classes for common PHP tasks"
@


1.35
log
@new MULTI_PACKAGES. mark pear files as belonging to daemon since they
live under www (quickest fix for now)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2006/08/04 00:10:42 espie Exp $
d7 2
a8 2
PKGNAME-main=	php4-core-${V}p2
FULLPKGNAME-pear= php4-pear-${V}p1
@


1.34
log
@new lib specs
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2006/07/18 21:22:56 alek Exp $
d3 1
a3 2
MULTI_PACKAGES=	-pear
SUBPACKAGE?=
d5 1
a5 1
COMMENT=	"server-side HTML-embedded scripting language"
d7 2
a8 2
PKGNAME=	php4-core-${V}p1
FULLPKGNAME-pear= php4-pear-${V}p0
a32 2
MODULES=	devel/gettext

d41 3
d45 1
a45 1
LIB_DEPENDS+=	recode::converters/recode
d49 3
a51 8
.if defined(PACKAGING) && !empty(SUBPACKAGE)
PREFIX=		${CHROOT_DIR}
RUN_DEPENDS=	:php4-core-${V}:www/php4/core
LIB_DEPENDS=
MODULES=
.else
WANTLIB=	c crypto des m ssl stdc++ z pthread
.endif
@


1.33
log
@Make it work after recent iodbc changes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2006/02/08 04:54:50 david Exp $
d45 1
a45 1
LIB_DEPENDS+=	recode.0::converters/recode
@


1.32
log
@move any perl or sed substitutions from post-patch to pre-configure
(fixes make update-patches)
ok sturm@@; "looks reasonable" steven@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2005/11/07 21:33:58 bernd Exp $
d8 1
a8 1
PKGNAME=	php4-core-${V}p0
d55 1
a55 1
WANTLIB=	c crypto des m ssl stdc++ z
@


1.31
log
@Fix a nasty bug in the new php-4.4.1 release. Some php applications
are badly broken without this patch. (e.g. squirrelmail and phpadsnew)

Fix from php cvs. (BugID #35067)

http://bugs.php.net/bug.php?id=35067
http://marc.theaimsgroup.com/?l=php-cvs&m=113095430113617&w=2

ok robert@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2005/11/01 11:09:31 mbalmer Exp $
d64 1
a64 1
post-patch:
@


1.30
log
@Update to PHP4 version 4.4.1.

The complete changelog is available at http://www.php.net/ChangeLog-4.php#4.4.1

SECURITY: This version fixes a vulnerability described in detail
at http://www.hardened-php.net/advisory_202005.79.html and
http://www.hardened-php.net/index.76.html

ok robert@@, bernd@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2005/08/31 22:12:54 robert Exp $
d8 2
a9 2
PKGNAME=	php4-core-${V}
FULLPKGNAME-pear= php4-pear-${V}
@


1.29
log
@SECURITY: fix a heap overflow in internal pcre; bump PKGNAME
http://www.vuxml.org/openbsd/b552a55a-136d-11da-a0d4-00065bd5b0b6.html

ok pvalchev@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2005/04/04 21:11:42 robert Exp $
d8 1
a8 1
PKGNAME=	php4-core-${V}p0
@


1.29.2.1
log
@MFC:
Update to PHP4 version 4.4.1.

The complete changelog is available at http://www.php.net/ChangeLog-4.php#4.4.1

SECURITY: This version fixes a vulnerability described in detail
at http://www.hardened-php.net/advisory_202005.79.html and
http://www.hardened-php.net/index.76.html
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2005/08/31 22:12:54 robert Exp $
d8 1
a8 1
PKGNAME=	php4-core-${V}
@


1.29.2.2
log
@Fix a nasty bug in the new php-4.4.1 release. Some php applications
are badly broken without this patch. (e.g. squirrelmail and phpadsnew)

Fix from php cvs. (BugID #35067)

http://bugs.php.net/bug.php?id=35067
http://marc.theaimsgroup.com/?l=php-cvs&m=113095430113617&w=2

ok sturm@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29.2.1 2005/11/03 09:26:15 sturm Exp $
d8 2
a9 2
PKGNAME=	php4-core-${V}p0
FULLPKGNAME-pear= php4-pear-${V}p0
@


1.28
log
@update to 4.3.11;
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2005/02/06 13:10:38 wilfried Exp $
d8 1
a8 1
PKGNAME=	php4-core-${V}
@


1.27
log
@kill whitespace at eol, ok robert@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2005/01/30 15:29:07 alek Exp $
d8 2
a9 2
PKGNAME=	php4-core-${V}p1
FULLPKGNAME-pear= php4-pear-${V}p0
@


1.27.2.1
log
@SECURITY: update to 4.3.11
fixes multiple vulnerabilities
http://www.vuxml.org/openbsd/c6f452e8-b00a-11d9-825c-00065bd5b0b6.html

ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2005/02/06 13:10:38 wilfried Exp $
d8 2
a9 2
PKGNAME=	php4-core-${V}
FULLPKGNAME-pear= php4-pear-${V}
@


1.27.2.2
log
@MFC:
SECURITY: fix a heap overflow in internal pcre; bump PKGNAME
http://www.vuxml.org/openbsd/b552a55a-136d-11da-a0d4-00065bd5b0b6.html

ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27.2.1 2005/05/23 20:21:31 robert Exp $
d8 1
a8 1
PKGNAME=	php4-core-${V}p0
@


1.27.2.3
log
@MFC:
Update to PHP4 version 4.4.1.

The complete changelog is available at http://www.php.net/ChangeLog-4.php#4.4.1

SECURITY: This version fixes a vulnerability described in detail
at http://www.hardened-php.net/advisory_202005.79.html and
http://www.hardened-php.net/index.76.html
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27.2.2 2005/09/12 19:29:14 sturm Exp $
d8 1
a8 1
PKGNAME=	php4-core-${V}
@


1.27.2.4
log
@Fix a nasty bug in the new php-4.4.1 release. Some php applications
are badly broken without this patch. (e.g. squirrelmail and phpadsnew)

Fix from php cvs. (BugID #35067)

http://bugs.php.net/bug.php?id=35067
http://marc.theaimsgroup.com/?l=php-cvs&m=113095430113617&w=2

ok sturm@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27.2.3 2005/11/03 09:24:50 sturm Exp $
d8 2
a9 2
PKGNAME=	php4-core-${V}p0
FULLPKGNAME-pear= php4-pear-${V}p0
@


1.26
log
@- Fix WANTLIB
- Fix dependencies
- Bump PKGNAME

help & ok wilfried@@, robert@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2004/12/20 16:28:57 robert Exp $
d36 1
a36 1
# some variables to substitute 
d51 1
a51 1
RUN_DEPENDS=	:php4-core-${V}:www/php4/core 
d55 1
a55 1
WANTLIB=	c crypto des m ssl stdc++ z 
@


1.25
log
@add libstdc++ to WANTLIB
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2004/12/20 16:25:56 robert Exp $
d9 1
a9 1
FULLPKGNAME-pear= php4-pear-${V}
a35 2
WANTLIB=	c crypto des m ssl stdc++ z 

d52 4
@


1.24
log
@fix PLIST-pear
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2004/12/18 14:15:55 robert Exp $
d36 1
a36 1
WANTLIB=	c crypto des m ssl z 
@


1.23
log
@SECURITY:
update to 4.3.10; fixes several vulnerabilites;
move to a central checksum file;
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2004/12/11 13:29:22 alek Exp $
d8 1
a8 1
PKGNAME=	php4-core-${V}
@


1.22
log
@Add WANTLIB markers
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2004/11/24 19:03:15 robert Exp $
d8 1
a8 1
PKGNAME=	php4-core-${V}p2
@


1.21
log
@switch to MESSAGE and UNMESSAGE; fix the redefinition of socklen_t;
Put correct paths into php-config and phpize scripts;
bump PKGNAME
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2004/11/18 16:36:18 robert Exp $
d35 2
@


1.20
log
@Let's use ${LOCALBASE}/share/examples/php4/ for the example configuration
files. requested by f@@obiit.org
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2004/08/03 12:54:40 espie Exp $
d8 1
a8 1
PKGNAME=	php4-core-${V}p1
d61 3
a63 1
	@@perl -p -i.orig -e "s,OPENBSD_PEAR_ROOT,'${CHROOT_DIR}/pear',g" ${WRKSRC}/pear/PEAR/Config.php
@


1.19
log
@MODULES=www/php4/pear
okay maintainer(s)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2004/06/08 15:59:54 robert Exp $
d8 1
a8 1
PKGNAME=	php4-core-${V}
d65 1
a65 1
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/php4
d71 1
a71 1
		>${PREFIX}/share/doc/php4/php.ini-${i}
@


1.19.2.1
log
@Put correct paths into php-config and phpize scripts; now these scripts are
useable; bump PKGNAME; requested by wilfried@@, ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2004/08/03 12:54:40 espie Exp $
d8 1
a8 1
PKGNAME=	php4-core-${V}p0
d61 1
a61 3
	@@perl -p -i.orig -e "s,OPENBSD_PEAR_ROOT,'${CHROOT_DIR}/pear',g" \
	    ${WRKSRC}/pear/PEAR/Config.php ${WRKSRC}/scripts/phpize.in \
	    ${WRKSRC}/scripts/php-config.in
@


1.19.2.2
log
@upgrade to 4.4.0;

This release also includes PEAR XML-RPC version 1.3.1 which
fixes a security vulnerability.
For more information, please visit:
http://www.vuxml.org/openbsd/b9d96cbe-f2d2-11d9-82d5-00065bd5b0b6.html

ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19.2.1 2005/04/20 14:32:53 robert Exp $
d8 1
a8 1
PKGNAME=	php4-core-${V}
@


1.19.2.3
log
@MFC:
SECURITY: fix a heap overflow in internal pcre; bump PKGNAME
http://www.vuxml.org/openbsd/b552a55a-136d-11da-a0d4-00065bd5b0b6.html

ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19.2.2 2005/07/23 13:37:20 robert Exp $
d8 1
a8 1
PKGNAME=	php4-core-${V}p0
@


1.18
log
@take over maintainance; remove some unnecessary line;
remove iconv from MODULES because gettext includes it

ok jolan@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2004/01/05 17:51:29 avsm Exp $
d34 1
a34 1
MODULES=	gettext
@


1.17
log
@activate the exif extension, requested and tested by
Tai Lee <tai_lee at mrmachine.net>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2003/08/28 22:30:38 avsm Exp $
d34 1
a34 1
MODULES=	gettext iconv
@


1.17.2.1
log
@Put correct paths into php-config and phpize scripts; now these scripts are
useable; bump PKGNAME; requested by wilfried@@, ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2004/01/05 17:51:29 avsm Exp $
d8 1
a8 1
PKGNAME=	php4-core-${V}p0
d61 1
a61 3
	@@perl -p -i.orig -e "s,OPENBSD_PEAR_ROOT,'${CHROOT_DIR}/pear',g" \
	    ${WRKSRC}/pear/PEAR/Config.php ${WRKSRC}/scripts/phpize.in \
	    ${WRKSRC}/scripts/php-config.in
@


1.16
log
@Update to php-4.3.3; tested by many on ports@@, thanks folks!
naddy@@ ok
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2003/08/21 15:05:21 espie Exp $
d31 2
a32 1
		--enable-yp
@


1.16.2.1
log
@Update to 4.3.8:
SECURITY: PHP memory_limit remote vulnerability
http://security.e-matters.de/advisories/112004.html
It contains a lot of other fixes too, check the
changelog at http://www.php.net/ChangeLog-4.php#4.3.8 .

ok pvalchev@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2004/01/05 17:51:29 avsm Exp $
d31 1
a31 2
		--enable-yp \
		--enable-exif
@


1.15
log
@fix blasted installroot ignored.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2003/08/21 13:42:22 espie Exp $
a4 1
#BROKEN=	'writes all over /var/www'
@


1.14
log
@Fake, my ass
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2003/05/30 23:46:16 avsm Exp $
d5 1
a5 1
BROKEN=	'writes all over /var/www'
@


1.13
log
@install a php man page as well, for the command line binary
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2003/05/27 22:10:59 avsm Exp $
d5 1
@


1.12
log
@the php4-pear package should depend on the php4-core package
noticed by naddy during bulk build
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2003/05/23 20:06:22 avsm Exp $
d75 1
@


1.11
log
@upgrade to php4-4.3.2RC4.  this is the final release candidate for
4.3.2, and should be a hell of a lot more stable than 4.3.1, especially
on 64-bit architectures

this commit also merges the pear/ stuff into a subpackage of core;
its no longer necessary to have a separate directory just for the pear libs.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2003/05/07 14:13:01 avsm Exp $
d49 2
a50 2
PREFIX=${CHROOT_DIR}
RUN_DEPENDS=  # pear doesnt need anything to run
@


1.10
log
@enable wddx as well
@
text
@d1 4
a4 1
# $OpenBSD: Makefile,v 1.9 2003/05/02 19:49:00 avsm Exp $
d7 1
d9 1
d43 10
d56 1
a56 1
INSTALL_TARGET=	install-programs install-pear
d59 3
a74 5

.if ${MACHINE_ARCH} == "i386"
LIB_DEPENDS+=	recode.0::converters/recode
CONFIGURE_ARGS+= --with-recode=${LOCALBASE}
.endif
@


1.9
log
@Make php chroot-friendly by default; the default pear directory is
/var/www/pear and php modules go into /var/www/lib/php.

Everything else still lives outside the chroot

Also tidy up the pkg/INSTALL message while I'm here
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2003/04/03 10:26:25 avsm Exp $
d9 1
@


1.8
log
@Update to php4-core-4.3.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2003/02/06 05:28:49 brad Exp $
d33 1
a33 1
.for i in TRUEPREFIX PHP_CONFIG_FILE MODULES_DIR PHP_VERSION
d38 1
a38 1
	${INSTALL_DATA_DIR} ${PREFIX}/${MODULES_SUBDIR}
d40 5
a44 2
do-install:
	${INSTALL_DATA} ${WRKBUILD}/.libs/libphp4.so ${PREFIX}/${MODULES_SUBDIR}
d48 2
a49 1
	@@sed 's,MODULES_DIR,${MODULES_DIR},' \
@


1.7
log
@Fix a buffer overflow in PHP's built-in wordwrap() function.

If you use the wordwrap() function on user-supplied input, a
specially-crafted input can overflow the allocated buffer and
overwrite the heap.  Exploit looks very difficult, but still
theoretically possible.

http://marc.theaimsgroup.com/?l=bugtraq&m=104102689503192
http://bugs.php.net/bug.php?id=20927
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2002/09/11 23:16:48 avsm Exp $
d4 1
a4 1
PKGNAME=	php4-core-${V}p1
d8 1
a8 1
		--without-xml \
d13 1
a13 1
		--without-pear \
@


1.6
log
@- update to php4-4.2.3
- include the domxml extension as a subpackage
- include some extra modules with PEAR which also disappeared
- only link against freetype1, not freetype2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2002/08/12 04:27:41 avsm Exp $
d4 1
a4 1
PKGNAME=	php4-core-${V}
@


1.6.2.1
log
@Fix a buffer overflow in PHP's built-in wordwrap() function.

If you use the wordwrap() function on user-supplied input, a
specially-crafted input can overflow the allocated buffer and
overwrite the heap.  Exploit looks very difficult, but still
theoretically possible.

http://marc.theaimsgroup.com/?l=bugtraq&m=104102689503192
http://bugs.php.net/bug.php?id=20927
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2002/09/11 23:16:48 avsm Exp $
d4 1
a4 1
PKGNAME=	php4-core-${V}p1
@


1.5
log
@- remove dependency on external libtool
- ltmain patch no longer needed
- move the php.ini extension lines to the end of the file
- introduce a new 'phpxs' command which enables/disables
  modules from a shell without needing to manually edit php.ini
- libphp4.so now installs into the same module dir as the extensions
- php4-enable is now done by 'phpxs -s' so remove it

tested by wilfried@@, feedback from naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2002/07/12 10:13:56 avsm Exp $
a58 1

@


1.4
log
@- move bundled extensions to core/ to save build time
- MACHINE_ARCH is predefined; jcs@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2002/07/09 19:47:43 avsm Exp $
d29 11
d41 1
a41 1
	${INSTALL_DATA} ${WRKBUILD}/.libs/libphp4.so ${PREFIX}/lib/libphp4.so
d44 1
d46 6
a51 9
		<${WRKSRC}/php.ini-dist \
		>${PREFIX}/share/doc/php4/php.ini-dist
	@@sed 's,MODULES_DIR,${MODULES_DIR},' \
		<${WRKSRC}/php.ini-recommended \
		>${PREFIX}/share/doc/php4/php.ini-recommended
	@@sed 's,y0y0y0,${TRUEPREFIX},' \
		<${FILESDIR}/php4-enable >${PREFIX}/sbin/php4-enable
	@@chown ${BINOWN}:${BINGRP} ${PREFIX}/sbin/php4-enable
	@@chmod ${BINMODE} ${PREFIX}/sbin/php4-enable
@


1.3
log
@activate direct i/o functions by default
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2002/07/08 21:33:33 avsm Exp $
d7 19
a25 3
		--without-mysql --without-xml --enable-cli \
		--with-iconv=${LOCALBASE} --with-gettext=${LOCALBASE} \
		--enable-dio --without-pear
a43 2
.include <bsd.port.mk>

d48 3
@


1.2
log
@restrict building recode to i386 until someone figures out what
the problem is on other arches
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2002/06/24 19:23:41 avsm Exp $
d9 1
a9 1
		--without-pear
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d9 1
a9 1
		--with-recode=${LOCALBASE} --without-pear
a11 1
LIB_DEPENDS+=	recode.0::converters/recode
d29 5
@


1.1.1.1
log
@Import php4-core-4.2.1

Installs the barebones php4 with only the gettext, iconv and recode
modules compiled in.

All of the other modules have to be installed as shared modules on
top of this.

In addition to the Apache module, this package also includes a php
command-line binary which can be used in shell scripts.  The binary
uses the same /var/www/conf/php.ini file as the Apache module.

There is some non-i386 breakage at the moment (notably macppc).

Work by wilfried@@ and me.  espie@@ ok
@
text
@@
