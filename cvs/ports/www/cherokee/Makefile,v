head	1.59;
access;
symbols
	OPENBSD_6_0:1.59.0.2
	OPENBSD_6_0_BASE:1.59
	OPENBSD_5_9:1.56.0.2
	OPENBSD_5_9_BASE:1.56
	OPENBSD_5_8:1.55.0.4
	OPENBSD_5_8_BASE:1.55
	OPENBSD_5_7:1.52.0.2
	OPENBSD_5_7_BASE:1.52
	OPENBSD_5_6:1.49.0.2
	OPENBSD_5_6_BASE:1.49
	OPENBSD_5_5:1.47.0.2
	OPENBSD_5_5_BASE:1.47
	OPENBSD_5_4:1.46.0.2
	OPENBSD_5_4_BASE:1.46
	OPENBSD_5_3:1.37.0.2
	OPENBSD_5_3_BASE:1.37
	OPENBSD_5_2:1.34.0.2
	OPENBSD_5_2_BASE:1.34
	OPENBSD_5_1_BASE:1.33
	OPENBSD_5_1:1.33.0.2
	OPENBSD_5_0:1.30.0.2
	OPENBSD_5_0_BASE:1.30
	OPENBSD_4_9:1.23.0.2
	OPENBSD_4_9_BASE:1.23
	OPENBSD_4_8:1.13.0.2
	OPENBSD_4_8_BASE:1.13
	OPENBSD_4_7:1.11.0.2
	OPENBSD_4_7_BASE:1.11
	OPENBSD_4_6:1.9.0.2
	OPENBSD_4_6_BASE:1.9
	OPENBSD_4_5:1.2.0.2
	OPENBSD_4_5_BASE:1.2
	ajacoutot_20080905:1.1.1.1
	ajacoutot:1.1.1;
locks; strict;
comment	@# @;


1.59
date	2016.03.19.23.59.15;	author naddy;	state Exp;
branches;
next	1.58;
commitid	f78UdaLw3Lb0ClLt;

1.58
date	2016.03.11.20.28.32;	author naddy;	state Exp;
branches;
next	1.57;
commitid	UYLP8TE6V7RS2GhJ;

1.57
date	2016.03.01.00.07.17;	author sthen;	state Exp;
branches;
next	1.56;
commitid	QBhOYg1ODJRuhu7C;

1.56
date	2015.08.12.22.27.31;	author sthen;	state Exp;
branches;
next	1.55;
commitid	SHEFBfUb4YY8KIkG;

1.55
date	2015.07.15.23.29.57;	author ajacoutot;	state Exp;
branches;
next	1.54;
commitid	vq4hx7arUqZcQCc0;

1.54
date	2015.06.05.06.00.22;	author robert;	state Exp;
branches;
next	1.53;
commitid	PS9YXjRm9KQkIZjT;

1.53
date	2015.04.28.06.35.06;	author ajacoutot;	state Exp;
branches;
next	1.52;
commitid	tr3XsOq5EJv6iti7;

1.52
date	2015.02.16.22.57.13;	author naddy;	state Exp;
branches;
next	1.51;
commitid	0dx3c9ckf7dE4tx1;

1.51
date	2014.11.06.17.13.40;	author sthen;	state Exp;
branches;
next	1.50;
commitid	ig1O4RkSPXzTZYwZ;

1.50
date	2014.09.13.18.09.22;	author brad;	state Exp;
branches;
next	1.49;
commitid	PpbRjVZdAmlrmi8q;

1.49
date	2014.07.23.20.14.07;	author jca;	state Exp;
branches;
next	1.48;
commitid	D7t5ul7CxZzn9O6Z;

1.48
date	2014.04.21.13.03.40;	author sthen;	state Exp;
branches;
next	1.47;

1.47
date	2013.08.12.04.11.21;	author robert;	state Exp;
branches
	1.47.2.1;
next	1.46;

1.46
date	2013.06.20.08.26.14;	author ajacoutot;	state Exp;
branches;
next	1.45;

1.45
date	2013.06.20.06.54.37;	author ajacoutot;	state Exp;
branches;
next	1.44;

1.44
date	2013.06.18.17.02.37;	author sthen;	state Exp;
branches;
next	1.43;

1.43
date	2013.06.17.19.28.37;	author ajacoutot;	state Exp;
branches;
next	1.42;

1.42
date	2013.06.12.20.36.34;	author brad;	state Exp;
branches;
next	1.41;

1.41
date	2013.05.25.00.33.10;	author brad;	state Exp;
branches;
next	1.40;

1.40
date	2013.04.25.15.57.18;	author sthen;	state Exp;
branches;
next	1.39;

1.39
date	2013.03.21.08.48.55;	author ajacoutot;	state Exp;
branches;
next	1.38;

1.38
date	2013.03.11.11.44.41;	author espie;	state Exp;
branches;
next	1.37;

1.37
date	2013.01.21.05.21.30;	author brad;	state Exp;
branches;
next	1.36;

1.36
date	2012.12.12.02.17.40;	author brad;	state Exp;
branches;
next	1.35;

1.35
date	2012.09.24.06.51.59;	author jasper;	state Exp;
branches;
next	1.34;

1.34
date	2012.04.28.10.52.08;	author ajacoutot;	state Exp;
branches;
next	1.33;

1.33
date	2011.12.17.22.01.13;	author sthen;	state Exp;
branches;
next	1.32;

1.32
date	2011.12.15.15.04.32;	author nigel;	state Exp;
branches;
next	1.31;

1.31
date	2011.09.16.12.00.06;	author espie;	state Exp;
branches;
next	1.30;

1.30
date	2011.07.22.10.20.10;	author sthen;	state Exp;
branches;
next	1.29;

1.29
date	2011.07.20.15.26.00;	author sthen;	state Exp;
branches;
next	1.28;

1.28
date	2011.07.09.00.42.02;	author robert;	state Exp;
branches;
next	1.27;

1.27
date	2011.06.24.11.17.05;	author sthen;	state Exp;
branches;
next	1.26;

1.26
date	2011.06.08.18.15.28;	author rpointel;	state Exp;
branches;
next	1.25;

1.25
date	2011.04.18.22.41.37;	author sthen;	state Exp;
branches;
next	1.24;

1.24
date	2011.03.29.23.22.17;	author jakemsr;	state Exp;
branches;
next	1.23;

1.23
date	2011.01.08.08.47.53;	author landry;	state Exp;
branches;
next	1.22;

1.22
date	2010.12.27.14.50.24;	author ajacoutot;	state Exp;
branches;
next	1.21;

1.21
date	2010.12.24.10.40.06;	author ajacoutot;	state Exp;
branches;
next	1.20;

1.20
date	2010.12.22.07.28.04;	author ajacoutot;	state Exp;
branches;
next	1.19;

1.19
date	2010.12.20.07.51.58;	author ajacoutot;	state Exp;
branches;
next	1.18;

1.18
date	2010.11.22.08.36.47;	author espie;	state Exp;
branches;
next	1.17;

1.17
date	2010.11.11.12.35.09;	author sthen;	state Exp;
branches;
next	1.16;

1.16
date	2010.10.19.08.02.53;	author espie;	state Exp;
branches;
next	1.15;

1.15
date	2010.09.10.22.39.12;	author robert;	state Exp;
branches;
next	1.14;

1.14
date	2010.08.30.22.15.24;	author sthen;	state Exp;
branches;
next	1.13;

1.13
date	2010.07.12.06.22.45;	author ajacoutot;	state Exp;
branches;
next	1.12;

1.12
date	2010.03.22.01.18.26;	author sthen;	state Exp;
branches;
next	1.11;

1.11
date	2010.01.13.08.47.57;	author ajacoutot;	state Exp;
branches;
next	1.10;

1.10
date	2009.07.27.17.06.16;	author sthen;	state Exp;
branches;
next	1.9;

1.9
date	2009.05.15.06.57.18;	author sthen;	state Exp;
branches;
next	1.8;

1.8
date	2009.05.14.08.53.36;	author sthen;	state Exp;
branches;
next	1.7;

1.7
date	2009.04.22.00.59.16;	author sthen;	state Exp;
branches;
next	1.6;

1.6
date	2009.04.22.00.28.54;	author sthen;	state Exp;
branches;
next	1.5;

1.5
date	2009.04.17.23.17.07;	author sthen;	state Exp;
branches;
next	1.4;

1.4
date	2009.04.08.21.30.54;	author sthen;	state Exp;
branches;
next	1.3;

1.3
date	2009.03.16.17.11.42;	author sthen;	state Exp;
branches;
next	1.2;

1.2
date	2008.11.26.09.05.31;	author ajacoutot;	state Exp;
branches;
next	1.1;

1.1
date	2008.09.05.11.19.48;	author ajacoutot;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2008.09.05.11.19.48;	author ajacoutot;	state Exp;
branches;
next	;

1.47.2.1
date	2014.07.23.20.22.56;	author jca;	state Exp;
branches;
next	;
commitid	AsAuqt5tMQGrWw3s;


desc
@@


1.59
log
@remove SHARED_ONLY from PHP ports, unused
@
text
@# $OpenBSD: Makefile,v 1.58 2016/03/11 20:28:32 naddy Exp $

COMMENT-main =	fast, flexible and easy to configure web server
COMMENT-geoip =	GeoIP module for Cherokee web server
COMMENT-ldap =	LDAP module for Cherokee web server
COMMENT-mysql =	MySQL module for Cherokee web server
COMMENT-streaming = Streaming module for Cherokee web server

DIR =		1.2
VERSION =	${DIR}.101
DISTNAME =	cherokee-${VERSION}

PKGNAME-main =	${DISTNAME}
PKGNAME-ldap =	cherokee-ldap-${VERSION}
PKGNAME-mysql =	cherokee-mysql-${VERSION}
PKGNAME-geoip =	cherokee-geoip-${VERSION}
PKGNAME-streaming = cherokee-streaming-${VERSION}

REVISION-main =		6
REVISION-geoip =	3
REVISION-ldap =		6
REVISION-mysql =	6
REVISION-streaming =	5

SHARED_LIBS =	cherokee-base		0.0 \
		cherokee-client		0.0 \
		cherokee-server		0.0

CATEGORIES =	www

HOMEPAGE =	http://www.cherokee-project.com/

MAINTAINER =	Fernando Quintero <fernando.a.quintero@@gmail.com>

# GPLv2
PERMIT_PACKAGE_CDROM =	Yes

MASTER_SITES =	${HOMEPAGE}download/${DIR}/${VERSION}/ \
		http://ftp.heanet.ie/mirrors/cherokee/${DIR}/${VERSION}/ \
		http://www.ring.gr.jp/archives/net/cherokee/${DIR}/${VERSION}/ \
		http://cherokee.osuosl.org/${DIR}/${VERSION}/

MULTI_PACKAGES =-main -ldap -mysql -geoip -streaming

MODULES =	lang/php \
		lang/python

BUILD_DEPENDS =	textproc/py-docutils \
		lang/php/${MODPHP_VERSION},-fastcgi

LIB_DEPENDS-main =	devel/pcre
WANTLIB-main =		c crypto pcre pthread ssl
RUN_DEPENDS-main =	${RUN_DEPENDS} \
			www/spawn-fcgi \
			net/rrdtool

LIB_DEPENDS-geoip =	net/GeoIP
WANTLIB-geoip =		crypto GeoIP>=6
RUN_DEPENDS-geoip =	${BASE_PKGPATH}

LIB_DEPENDS-ldap =	databases/openldap
WANTLIB-ldap =		crypto lber-2.4 ldap-2.4 sasl2 ssl
RUN_DEPENDS-ldap =	${BASE_PKGPATH}

LIB_DEPENDS-mysql =	databases/mariadb
WANTLIB-mysql =		crypto m mysqlclient pthread ssl stdc++ z
RUN_DEPENDS-mysql =	${BASE_PKGPATH}

LIB_DEPENDS-streaming =	graphics/ffmpeg>=20121026 \
			archivers/bzip2
WANTLIB-streaming += avcodec avformat avutil bz2 crypto m gsm
WANTLIB-streaming += mp3lame ogg pthread speex vorbis vorbisenc
WANTLIB-streaming += vpx x264 xvidcore z opus ssl
WANTLIB-streaming += stdc++ swresample x265
RUN_DEPENDS-streaming = ${BASE_PKGPATH}

USE_GMAKE =	Yes
LIBTOOL_FLAGS =	--tag=disable-static

FAKE_FLAGS =	cherokeeconfdir="${PREFIX}/share/examples/cherokee/etc" \
		cherokeewwwdir="${PREFIX}/share/examples/cherokee/www" \
		cherokeewwwimagesdir="${PREFIX}/share/examples/cherokee/www/images"

CONFIGURE_STYLE =	autoconf
AUTOCONF_VERSION =	2.68
CONFIGURE_ENV =		CPPFLAGS="-I${LOCALBASE}/include" \
			LDFLAGS="-L${LOCALBASE}/lib" \
			ac_cv_header_execinfo_h=no
CONFIGURE_ARGS =	--disable-static \
			--enable-tmpdir=/tmp \
			--sysconfdir=${SYSCONFDIR} \
			--with-cgiroot=/var/cherokee/cgi-bin \
			--with-wwwroot=/var/cherokee \
			--with-wwwuser=_cherokee \
			--with-wwwgroup=_cherokee \
			--disable-nls \
			--disable-pam \
			--with-ffmpeg \
			--with-geoip \
			--with-ldap \
			--with-mysql \
			--with-php=${LOCALBASE}/bin/php-fastcgi-${MODPHP_VERSION} \
			--with-python=${MODPY_BIN}

.ifdef DEBUG
CONFIGURE_ARGS +=	--enable-trace
.endif

MODPY_ADJ_FILES=admin/CTK/CTK-run.pre admin/upgrade_config.py \
		cherokee/cherokee-admin-launcher \
		cherokee/cherokee-tweak doc/test_images.py \
		po/po_stats.py admin/server.py qa/run-tests.py \
		contrib/tracelor.py

LANGUAGES =	en es de nl sv_SE zh_CN fr pt_BR pl ca it gl

pre-configure:
	@@${SUBST_CMD} ${WRKSRC}/cherokee/main_admin.c

post-install:
	cd ${PREFIX}/share/cherokee/admin && find . -name "*.py" | \
		xargs ${MODPY_BIN} ${MODPY_LIBDIR}/py_compile.py
	touch ${PREFIX}/share/examples/cherokee/blank
.for i in ${LANGUAGES}
	${INSTALL_DATA_DIR} ${PREFIX}/share/locale/$i/LC_MESSAGES
	${INSTALL_DATA} ${WRKSRC}/po/admin/$i.gmo \
		${PREFIX}/share/locale/$i/LC_MESSAGES/cherokee.mo
.endfor
	@@find ${PREFIX}/lib/cherokee -name '*.la' -print | xargs rm

.include <bsd.port.mk>
@


1.58
log
@garbage collect CONFIGURE_SHARED
@
text
@d1 1
a1 3
# $OpenBSD: Makefile,v 1.57 2016/03/01 00:07:17 sthen Exp $

SHARED_ONLY=	Yes
@


1.57
log
@bump (GeoIP pkgpath change)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2015/08/12 22:27:31 sthen Exp $
d91 1
a91 2
CONFIGURE_ARGS =	${CONFIGURE_SHARED} \
			--disable-static \
@


1.56
log
@sync WANTLIB
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55 2015/07/15 23:29:57 ajacoutot Exp $
d22 1
a22 1
REVISION-geoip =	2
@


1.55
log
@Fix daemon and pexp.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.54 2015/06/05 06:00:22 robert Exp $
d24 2
a25 2
REVISION-mysql =	5
REVISION-streaming =	4
d68 1
a68 1
WANTLIB-mysql =		crypto m mysqlclient ssl z
d76 1
@


1.54
log
@bump revision due to the change of the default php version to 5.6
ok aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2015/04/28 06:35:06 ajacoutot Exp $
d21 1
a21 1
REVISION-main =		5
@


1.53
log
@Cope with FFmpeg 20150412.

from brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.52 2015/02/16 22:57:13 naddy Exp $
d21 1
a21 1
REVISION-main =		4
@


1.52
log
@Drop USE_GROFF from ports where the formatting differences are acceptable
or mandoc provides the more useful output.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 2014/11/06 17:13:40 sthen Exp $
d25 1
a25 1
REVISION-streaming =	3
d74 2
a75 3
WANTLIB-streaming += mp3lame ogg orc-0.4 pthread schroedinger-1.0
WANTLIB-streaming += speex theoradec theoraenc vorbis vorbisenc vpx
WANTLIB-streaming += x264 xvidcore z opus ssl
@


1.51
log
@bump REVISION for php version switch
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2014/09/13 18:09:22 brad Exp $
a78 1
USE_GROFF =	Yes
@


1.50
log
@Switch from using MySQL to using MariaDB attempt #2. MariaDB is a drop-in replacement.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2014/07/23 20:14:07 jca Exp $
d21 1
a21 1
REVISION-main =		3
@


1.49
log
@SECURITY fix for CVE-2014-4668.  The LDAP authenticator considered
successful LDAP bindings as a proper authentication, without checking
the length of the user's password.  But the LDAP server configuration
might allow password-less bindings to retrieve public information.
ok naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2014/04/21 13:03:40 sthen Exp $
d24 1
a24 1
REVISION-mysql =	4
d67 2
a68 2
LIB_DEPENDS-mysql =	databases/mysql
WANTLIB-mysql =		crypto m mysqlclient>=19 ssl z
@


1.48
log
@sync WANTLIB-ldap
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2013/08/12 04:11:21 robert Exp $
d23 1
a23 1
REVISION-ldap =		5
@


1.47
log
@bump REVISION due to the php update
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2013/06/20 08:26:14 ajacoutot Exp $
d23 1
a23 1
REVISION-ldap =		4
d64 1
a64 2
WANTLIB-ldap =		asn1 com_err crypto gssapi krb5 lber-2.4 ldap-2.4 sasl2 ssl \
			heimbase roken wind
@


1.47.2.1
log
@MFC security fix for CVE-2014-4668.  ok jasper@@

Original log message:
  The LDAP authenticator considered successful LDAP bindings as a proper
  authentication, without checking the length of the user's password.
  But the LDAP server configuration might allow password-less bindings
  to retrieve public information. ok naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2013/08/12 04:11:21 robert Exp $
d23 1
a23 1
REVISION-ldap =		5
@


1.46
log
@No need for pthread.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2013/06/20 06:54:37 ajacoutot Exp $
d21 1
a21 1
REVISION-main =		2
@


1.45
log
@Unbreak after hx509 and ntlm removal from Kerberos.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2013/06/18 17:02:37 sthen Exp $
d23 1
a23 1
REVISION-ldap =		3
d65 1
a65 1
			heimbase pthread roken wind
@


1.44
log
@bump
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2013/06/17 19:28:37 ajacoutot Exp $
d21 5
a25 5
REVISION-main =		1
REVISION-geoip =	1
REVISION-ldap =		2
REVISION-mysql =	3
REVISION-streaming =	2
d65 1
a65 1
			heimbase heimntlm hx509 pthread roken wind
@


1.43
log
@Some trivial WANTLIB and tweaks to unbreak after the Heimdal update.
Stop hardcoding the Kerberos libs and use krb5-config(1).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2013/06/12 20:36:34 brad Exp $
d23 1
a23 1
REVISION-ldap =		1
d25 1
a25 1
REVISION-streaming =	1
@


1.42
log
@Revert back to using MySQL 5.1 for the time being. MariaDB 5.5 introduces
a new libmysqlclient non-blocking API which utilizes co-routines. The X86
specific GCC ASM co-routine support hid the fact that there was an issue.
The only fallback code so far is POSIX user contexts which OpenBSD does not
support.

Input from and Ok sthen@@ jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2013/05/25 00:33:10 brad Exp $
d64 2
a65 1
WANTLIB-ldap =		asn1 com_err crypto gssapi krb5 lber-2.4 ldap-2.4 sasl2 ssl
d77 1
a77 1
WANTLIB-streaming += x264 xvidcore z
@


1.41
log
@Switch from using MySQL to using MariaDB. MariaDB is a drop-in replacement.


ok sthen aja
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2013/04/25 15:57:18 sthen Exp $
d24 1
a24 1
REVISION-mysql =	2
d67 1
a67 1
LIB_DEPENDS-mysql =	databases/mariadb
@


1.40
log
@handle a "long long"-sized time_t.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2013/03/21 08:48:55 ajacoutot Exp $
a12 1
REVISION =	1
d21 6
d67 1
a67 1
LIB_DEPENDS-mysql =	databases/mysql
@


1.39
log
@USE_LIBTOOL=Yes is the default now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2013/03/11 11:44:41 espie Exp $
d13 1
a13 1
REVISION =	0
d82 2
a83 1
CONFIGURE_STYLE =	gnu
@


1.38
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2013/01/21 05:21:30 brad Exp $
a75 1
USE_LIBTOOL =	Yes
@


1.37
log
@Update for newer FFmpeg API.

ok MAINTAINER
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2012/12/12 02:17:40 brad Exp $
a33 3
PERMIT_PACKAGE_FTP =	Yes
PERMIT_DISTFILES_CDROM =Yes
PERMIT_DISTFILES_FTP =	Yes
@


1.36
log
@Upgrade to cherokee 1.2.101.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2012/09/24 06:51:59 jasper Exp $
d13 1
d69 1
a69 1
LIB_DEPENDS-streaming =	graphics/ffmpeg \
@


1.35
log
@- remove -lpthread vs. -pthread patches/chunks.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2012/04/28 10:52:08 ajacoutot Exp $
d5 1
a5 1
COMMENT-main =	fast, flexible and easy to configure Web Server
d11 2
a12 2
DIR =		1.0
VERSION =	${DIR}.14
a20 6
REVISION-main =	9
REVISION-geoip = 4
REVISION-ldap =	5
REVISION-mysql = 4
REVISION-streaming = 7

d44 2
a45 1
MODULES =	lang/python lang/php
d71 3
a73 3
WANTLIB-streaming += mp3lame ogg orc-0.4 schroedinger-1.0 speex
WANTLIB-streaming += theoradec theoraenc vorbis vorbisenc vpx
WANTLIB-streaming += x264 z pthread xvidcore
d76 2
a79 1
USE_GROFF =	Yes
a87 2
			PHPCGI="${LOCALBASE}/bin/php-fastcgi-${MODPHP_VERSION}" \
			ac_cv_func_getgrnam_r=no \
d91 1
d93 1
d99 1
d103 2
a104 1
			--with-ffmpeg
a106 1
CFLAGS +=		-O0 -g3
d110 1
a110 1
MODPY_ADJ_FILES= admin/CTK/CTK-run.pre admin/upgrade_config.py \
d113 2
a114 2
		gitlog2changelog.py po/po_stats.py svnlog2changelog.py \
		admin/server.py qa/run-tests.py contrib/tracelor.py
d119 1
a119 1
	${SUBST_CMD} ${WRKSRC}/cherokee/main_admin.c
d130 1
@


1.34
log
@--localstatedir=/var is the default now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2011/12/17 22:01:13 sthen Exp $
d21 5
a25 5
REVISION-main =	8
REVISION-geoip = 3
REVISION-ldap =	4
REVISION-mysql = 3
REVISION-streaming = 6
d78 1
a78 1
WANTLIB-streaming += x264 z
@


1.33
log
@Where a program with an rc script _requires_ a certain command line
parameter to daemonize, move the parameter from daemon to daemon_flags,
so that the user cannot inadvertently prevent it from daemonizing by
adjusting the flags.

Discussed with ajacoutot and schwarze, this method was suggested
by schwarze@@ as a simpler alternative to my diff. ok aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2011/12/15 15:04:32 nigel Exp $
a97 1
			--localstatedir=/var \
@


1.32
log
@fix build issue with dpb spotted by jasper@@ disable detecting execinfo.h

Ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2011/09/16 12:00:06 espie Exp $
d21 1
a21 1
REVISION-main =	7
@


1.31
log
@normalize pkgpath
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2011/07/22 10:20:10 sthen Exp $
d93 2
a94 1
			ac_cv_func_getgrnam_r=no
@


1.30
log
@Bump for PKGSPEC changes in ports/lang/php/Makefile.inc
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2011/07/20 15:26:00 sthen Exp $
d21 5
a25 5
REVISION-main =	6
REVISION-geoip = 2
REVISION-ldap =	3
REVISION-mysql = 2
REVISION-streaming = 5
@


1.29
log
@openbsd4 -> openbsd
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2011/07/09 00:42:02 robert Exp $
d21 5
a25 5
REVISION-main =	5
REVISION-geoip = 1
REVISION-ldap =	2
REVISION-mysql = 1
REVISION-streaming = 4
@


1.28
log
@fix deps
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2011/06/24 11:17:05 sthen Exp $
d21 1
a21 1
REVISION-main =	4
@


1.27
log
@Chase ffmpeg dep changes. Mostly from Brad ok dcoppa@@, plus opencv from me.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2011/06/08 18:15:28 rpointel Exp $
d21 5
a25 5
REVISION-main =	3
REVISION-geoip = 0
REVISION-ldap =	1
REVISION-mysql = 0
REVISION-streaming = 3
d38 4
a41 4
PERMIT_PACKAGE_CDROM =	Yes 
PERMIT_PACKAGE_FTP =	Yes 
PERMIT_DISTFILES_CDROM =Yes 
PERMIT_DISTFILES_FTP =	Yes 
d50 1
a50 1
MODULES =	lang/python
d53 1
a53 1
		www/php5/core,-fastcgi
d89 1
a89 1
CONFIGURE_STYLE =	gnu	
d92 1
a92 1
			PHPCGI="${LOCALBASE}/bin/php-fastcgi" \
d106 1
a106 1
			--with-ffmpeg 
@


1.26
log
@bump after default python version switch
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2011/04/18 22:41:37 sthen Exp $
d25 1
a25 1
REVISION-streaming = 2
d75 4
a78 4
WANTLIB-streaming += avcodec avformat avutil bz2 crypto m faac
WANTLIB-streaming += gsm mp3lame ogg orc-0.4 schroedinger-1.0
WANTLIB-streaming += speex theoradec theoraenc vorbis vorbisenc
WANTLIB-streaming += vpx x264 z
@


1.25
log
@sync WANTLIB (re: ffmpeg update), from Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2011/03/29 23:22:17 jakemsr Exp $
d21 5
a25 3
REVISION-main =	2
REVISION-ldap =	0
REVISION-streaming = 1
@


1.24
log
@more ports that need faad removed from WANTLIB after ffmpeg update,
as noted on ports@@.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2011/01/08 08:47:53 landry Exp $
d23 1
a23 1
REVISION-streaming = 0
d73 4
a76 3
WANTLIB-streaming += avcodec>=13 avformat>=12 avutil>=6 bz2 crypto m
WANTLIB-streaming += faac gsm mp3lame ogg orc-0.4 schroedinger-1.0
WANTLIB-streaming += speex theora vorbis vorbisenc x264 z
@


1.23
log
@Fix WANTLIB. For some reason this one was not catched in bulks with
openldap 2.4.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2010/12/27 14:50:24 ajacoutot Exp $
d21 3
a23 2
REVISION-main=	2
REVISION-ldap=	0
d74 1
a74 1
WANTLIB-streaming += faac faad gsm mp3lame ogg orc-0.4 schroedinger-1.0
@


1.22
log
@Simplify after recent rc.subr change.
The framework is now stable and we will start documenting it (at last).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2010/12/24 10:40:06 ajacoutot Exp $
d22 1
d63 1
a63 1
WANTLIB-ldap =		asn1 com_err crypto gssapi krb5 lber-2.3 ldap-2.3 sasl2 ssl
@


1.21
log
@Cope with recent rc.subr changes.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2010/12/22 07:28:04 ajacoutot Exp $
d21 1
a21 1
REVISION-main=	1
@


1.20
log
@Install language files.

from Fernando Quintero (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2010/12/20 07:51:58 ajacoutot Exp $
d21 1
a21 1
REVISION-main=	0
@


1.19
log
@Update to cherokee-1.0.14.

From Fernando Quintero (maintainer).
Several fixes/tweaks as well as the rc script added by myself.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2010/11/22 08:36:47 espie Exp $
d21 2
d114 2
d123 5
@


1.18
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2010/11/11 12:35:09 sthen Exp $
d12 1
a12 1
VERSION =	${DIR}.8
a22 1
		cherokee-config		0.0 \
d60 1
a60 1
WANTLIB-ldap =		asn1 com_err crypto gssapi krb5 lber>=9 ldap sasl2 ssl
d69 3
a71 1
WANTLIB-streaming =	avcodec>=13 avformat>=12 avutil>=6 bz2 crypto m
d106 5
a110 3
SUBST_PY =		admin/server.py qa/fcgi.py qa/run-tests.py \
			contrib/06to07.py contrib/tracelor.py \
			contrib/07to08.py contrib/05to06.py
d113 1
a113 3
.for i in ${SUBST_PY}
	@@perl -pi -e 's,/usr/bin/env python,${MODPY_BIN},s' ${WRKSRC}/${i}
.endfor
@


1.17
log
@new-style LIB_DEPENDS/REVISION/WANTLIB
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2010/10/19 08:02:53 espie Exp $
d47 2
a48 2
BUILD_DEPENDS =	::textproc/py-docutils \
		::www/php5/core,-fastcgi
d50 1
a50 1
LIB_DEPENDS-main =	::devel/pcre
d53 2
a54 2
			::www/spawn-fcgi \
			::net/rrdtool
d56 16
a71 16
LIB_DEPENDS-geoip =	::net/GeoIP
WANTLIB-geoip =		crypto GeoIP.>=6
RUN_DEPENDS-geoip =	::${BASE_PKGPATH}

LIB_DEPENDS-ldap =	::databases/openldap
WANTLIB-ldap =		asn1 com_err crypto gssapi krb5 lber.>=9 ldap sasl2 ssl
RUN_DEPENDS-ldap =	::${BASE_PKGPATH}

LIB_DEPENDS-mysql =	::databases/mysql
WANTLIB-mysql =		crypto m mysqlclient.>=19 ssl z
RUN_DEPENDS-mysql =	::${BASE_PKGPATH}

LIB_DEPENDS-streaming =	::graphics/ffmpeg \
			::archivers/bzip2
WANTLIB-streaming =	avcodec.>=13 avformat.>=12 avutil.>=6 bz2 crypto m
RUN_DEPENDS-streaming = ::${BASE_PKGPATH}
@


1.16
log
@USE_GROFF=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2010/09/10 22:39:12 robert Exp $
d50 2
a51 2
LIB_DEPENDS-main =	pcre::devel/pcre
WANTLIB-main =		c crypto pthread ssl
d56 2
a57 2
LIB_DEPENDS-geoip =	GeoIP.>=6::net/GeoIP
WANTLIB-geoip =		crypto
d60 2
a61 2
LIB_DEPENDS-ldap =	lber.>=9,ldap::databases/openldap
WANTLIB-ldap =		asn1 com_err crypto gssapi krb5 sasl2 ssl
d64 2
a65 2
LIB_DEPENDS-mysql =	mysqlclient.>=19::databases/mysql
WANTLIB-mysql =		crypto m ssl z
d68 3
a70 3
LIB_DEPENDS-streaming =	avutil.>=6,avcodec.>=13,avformat.>=12::graphics/ffmpeg \
			bz2::archivers/bzip2
WANTLIB-streaming =	crypto m
@


1.15
log
@Update to 1.0.8 and search for php-fastcgi in the correct place
so that the admin interface can find it and use it.

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2010/08/30 22:15:24 sthen Exp $
d75 1
@


1.14
log
@python bumps
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2010/07/12 06:22:45 ajacoutot Exp $
d12 1
a12 1
VERSION =	${DIR}.5
a20 6
REVISION-main =	0
REVISION-ldap =	0
REVISION-mysql = 0
REVISION-geoip = 0
REVISION-streaming = 0

a88 1
			--enable-tls=openssl \
@


1.13
log
@Major update to cherokee-1.0.5.

successfully tested by Fernando Quintero (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2010/03/22 01:18:26 sthen Exp $
d20 6
@


1.12
log
@- fix RUN_DEPENDS-main to pull in ${RUN_DEPENDS}, so python gets
installed, needed for the admin interface. ok ajacoutot@@

- install blank sample logfiles, rather than make them a copy of
the sample index.html

- unbreak sample rc.local lines in MESSAGE-main (foo-bar isn't
a valid shell variable, foo_bar is)

all found by Rod Whitworth, thanks!
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2010/01/13 08:47:57 ajacoutot Exp $
d11 2
a12 2
DIR =		0.99
VERSION =	${DIR}.39
d15 1
a15 1
PKGNAME-main =	${DISTNAME}p0
@


1.11
log
@SECURITY: CVE-2009-4489
http://www.vupen.com/english/advisories/2010/0090
(thanks fgsch@@ for the link/notice)

Update to cherokee-0.99.39.
Remove debug FLAVOR and use ifdef DEBUG.
Add rrdtool to run_depends.
Byte-compile python modules so that they are registered in the PLIST.

Be careful as cherokee is not started using ${PREFIX}/sbin/cherokee, not
cherokee-guardian anymore.

Fernando Quintero (maintainer) ok
MESSAGE tweak and ok sthen@@, ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2009/07/27 17:06:16 sthen Exp $
d15 1
a15 1
PKGNAME-main =	${DISTNAME}
d52 2
a53 1
RUN_DEPENDS-main =	::www/spawn-fcgi \
d117 1
@


1.10
log
@- update to 0.99.20

- unbreak group setting; Cherokee assumed a fixed size 1k buffer for
getgrnam_r which is insufficient on some OS, including OpenBSD. symptom
was that group setting resulted in ERANGE. This just bumps the buffer
to 8k which isn't a perfect fix, but serves our purposes for now;
see ports@@ archives at http://marc.info/?t=124832494600002&r=1&w=2
for more discussion.

maintainer ok.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2009/05/15 06:57:18 sthen Exp $
a10 1
VERSION =	0.99.20
d12 1
d52 2
a53 1
RUN_DEPENDS-main =	::www/spawn-fcgi
a71 3
FLAVORS =	debug
FLAVOR ?=

d90 2
d99 1
a99 1
.if ${FLAVOR:L:Mdebug}
d112 4
@


1.9
log
@bugfix update to 0.99.15 from Brad, maintainer ok.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2009/05/14 08:53:36 sthen Exp $
d11 1
a11 1
VERSION =	0.99.15
d68 1
a68 1
WANTLIB-streaming =	crypto
d84 2
a85 1
			PHPCGI="${LOCALBASE}/bin/php-fastcgi"
@


1.8
log
@make -streaming depend on -main. from Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2009/04/22 00:59:16 sthen Exp $
d11 1
a11 1
VERSION =	0.99.10
d15 1
a15 1
PKGNAME-main =	${DISTNAME}p0
d19 1
a19 1
PKGNAME-streaming = cherokee-streaming-${VERSION}p1
d21 4
a24 4
SHARED_LIBS +=	cherokee-base        0.0
SHARED_LIBS +=	cherokee-client      0.0
SHARED_LIBS +=	cherokee-config      0.0
SHARED_LIBS +=	cherokee-server      0.0
d91 1
@


1.7
log
@remove unnecessary RUN_DEPENDS from -streaming, bump.
pointed out by Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2009/04/22 00:28:54 sthen Exp $
d19 1
a19 1
PKGNAME-streaming = cherokee-streaming-${VERSION}p0
d69 1
@


1.6
log
@- add -streaming module for video streaming
- add "debug" flavour enabling the CHEROKEE_TRACE feature
- bump affected -main subpackage

based on a diff from Valery Masiutsin
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2009/04/17 23:17:07 sthen Exp $
d19 1
a19 1
PKGNAME-streaming = cherokee-streaming-${VERSION}
a68 1
RUN_DEPENDS-streaming =	::graphics/ffmpeg
@


1.5
log
@- update to 0.99.10 from Brad; maintainer timeout.
- fix typo in alternative MASTER_SITES line.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2009/04/08 21:30:54 sthen Exp $
d9 1
d15 5
a19 4
PKGNAME-main =	${DISTNAME}
PKGNAME-ldap=   cherokee-ldap-${VERSION}
PKGNAME-mysql=  cherokee-mysql-${VERSION}
PKGNAME-geoip=  cherokee-geoip-${VERSION}
d38 1
a38 1
MASTER_SITES  =	${HOMEPAGE}download/${DIR}/${VERSION}/ \
d43 1
a43 1
MULTI_PACKAGES =-main -ldap -mysql -geoip
d50 1
a50 2
LIB_DEPENDS-main =	pcre::devel/pcre \
			bz2::archivers/bzip2
d66 8
d94 2
a95 1
			--with-mysql
d97 8
a104 3
SUBST_PY=	admin/server.py qa/fcgi.py qa/run-tests.py \
		contrib/06to07.py contrib/tracelor.py \
		contrib/07to08.py contrib/05to06.py
@


1.4
log
@update to 0.99.0, remove conflict with spawn-fcgi/old lighttpd.
maintainer unresponsive, ok ajacoutot
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2009/03/16 17:11:42 sthen Exp $
d10 2
a11 2
VERSION =	0.99.0
DIR =		${VERSION:C/..$//}
d19 4
a22 4
SHARED_LIBS +=	cherokee-base        0.0      # .0.1
SHARED_LIBS +=	cherokee-client      0.0      # .0.1
SHARED_LIBS +=	cherokee-config      0.0      # .0.1
SHARED_LIBS +=	cherokee-server      0.0      # .0.1
d38 1
a38 1
		http://www.ring.gr.jp/arcvhies/net/cherokee/${DIR}/${VERSION}/ \
@


1.3
log
@conflict with spawn-fcgi and lighttpd. bump.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2008/11/26 09:05:31 ajacoutot Exp $
d10 2
a11 1
VERSION =	0.8.1
d14 1
a14 1
PKGNAME-main =	${DISTNAME}p1
d36 4
a39 2
MASTER_SITES  =	${HOMEPAGE}/download/${VERSION:R}/${VERSION}/ \
		http://cherokee.osuosl.org/${VERSION:R}/${VERSION}/
d48 2
a49 1
LIB_DEPENDS-main =	pcre::devel/pcre
d51 1
@


1.2
log
@- fix a typo in MESSAGE-main
from Daniele Pilenga
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2008/09/05 11:19:48 ajacoutot Exp $
d13 1
a13 1
PKGNAME-main =	${DISTNAME}p0
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d13 1
a13 1
PKGNAME-main =	${DISTNAME}
@


1.1.1.1
log
@Import cherokee-0.8.1

Cherokee is a very fast, flexible and easy to configure Web Server. It
supports the widespread technologies nowadays: FastCGI, SCGI, PHP, CGI,
TLS and SSL encrypted connections, Virtual hosts, Authentication, on the
fly encoding, Load balancing, Apache compatible log files, and much
more.

based on a submission from Fernando Quintero (MAINTAINER)
testing, feedback and ok sthen@@
@
text
@@
