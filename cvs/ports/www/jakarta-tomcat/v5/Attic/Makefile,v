head	1.10;
access;
symbols
	OPENBSD_4_0:1.9.0.2
	OPENBSD_4_0_BASE:1.9
	OPENBSD_3_9:1.6.0.2
	OPENBSD_3_9_BASE:1.6
	OPENBSD_3_8:1.4.0.2
	OPENBSD_3_8_BASE:1.4
	OPENBSD_3_7:1.3.0.2
	OPENBSD_3_7_BASE:1.3
	naddy_20041104:1.1.1.1
	naddy:1.1.1;
locks; strict;
comment	@# @;


1.10
date	2006.10.25.18.19.32;	author kurt;	state dead;
branches;
next	1.9;

1.9
date	2006.08.13.16.14.25;	author kurt;	state Exp;
branches;
next	1.8;

1.8
date	2006.08.10.18.26.23;	author kurt;	state Exp;
branches;
next	1.7;

1.7
date	2006.08.03.19.38.51;	author kurt;	state Exp;
branches;
next	1.6;

1.6
date	2005.12.13.18.59.09;	author kurt;	state Exp;
branches;
next	1.5;

1.5
date	2005.12.06.17.07.02;	author ian;	state Exp;
branches;
next	1.4;

1.4
date	2005.06.17.21.34.20;	author kurt;	state Exp;
branches;
next	1.3;

1.3
date	2005.03.15.22.46.21;	author kurt;	state Exp;
branches;
next	1.2;

1.2
date	2005.03.03.21.50.43;	author kurt;	state Exp;
branches;
next	1.1;

1.1
date	2004.11.04.21.46.04;	author naddy;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2004.11.04.21.46.04;	author naddy;	state Exp;
branches;
next	;


desc
@@


1.10
log
@replaced by www/tomcat
@
text
@# $OpenBSD: Makefile,v 1.9 2006/08/13 16:14:25 kurt Exp $

COMMENT=	"Java servlet 2.4 and Java server pages 2.0 server"
COMMENT-examples="example applications and documentation"

V=		5.0.28
DISTNAME=	jakarta-tomcat-${V}
PKGNAME=	${DISTNAME}p5
PKGNAME-examples=jakarta-tomcat-examples-${V}p5
CATEGORIES=	www

MASTER_SITES=	${MASTER_SITE_APACHE:=tomcat/tomcat-5/v$V/bin/} \
		http://archive.apache.org/dist/tomcat/tomcat-5/archive/v${V}/bin/

HOMEPAGE=	http://tomcat.apache.org/

MAINTAINER=	Kurt Miller <kurt@@openbsd.org>

MULTI_PACKAGES=	-examples
SUBPACKAGE?=

MODULES=	java
MODJAVA_VER=	1.3+

BUILD_DEPENDS=	::archivers/gtar

RUN_DEPENDS=	::java/javaPathHelper

.if defined(PACKAGING) && ${SUBPACKAGE} == "-examples"
PREFIX=		${CATALINA_BASE}
RUN_DEPENDS=    ::www/jakarta-tomcat/v5
.endif

# Apache Software License 2.0
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes

TAR=		${LOCALBASE}/bin/gtar

NO_BUILD=	Yes
NO_REGRESS=	Yes

CONFDIR=	${SYSCONFDIR}/tomcat
CATALINA_BASE=	/var/tomcat
SAMPLEDIR=	${PREFIX}/share/examples/tomcat
SUBST_VARS+=	DISTNAME CONFDIR CATALINA_BASE

do-install:
	${INSTALL_DATA_DIR} ${PREFIX}/${DISTNAME}
	cd ${WRKDIST} && \
		tar cf - bin common server `find * -prune -type f` | \
		tar -C ${PREFIX}/${DISTNAME} -xf -
	${INSTALL_DATA_DIR} ${SAMPLEDIR}
	${INSTALL_DATA} `find ${WRKDIST}/conf/* -prune -type f` ${SAMPLEDIR}
	${INSTALL_DATA_DIR} ${WRKINST}/${CATALINA_BASE}
	cd ${WRKDIST} && \
		tar cf - webapps | \
		tar -C ${WRKINST}/${CATALINA_BASE} -xf -
	${INSTALL_DATA_DIR} ${WRKINST}/${CONFDIR}/Catalina/localhost
	${INSTALL_DATA} ${WRKDIST}/conf/Catalina/localhost/* \
		${WRKINST}/${CONFDIR}/Catalina/localhost
	find ${WRKINST} -name \*.orig -or -name \*.bat -or -name \*.exe | \
		xargs rm
	@@perl -pi -e 's,%%SYSCONFDIR%%,${SYSCONFDIR},' \
		${PREFIX}/${DISTNAME}/bin/setclasspath.sh
	@@sed -e 's,%%PREFIX%%,${TRUEPREFIX},' \
		-e 's,%%DISTNAME%%,${DISTNAME},' \
		-e 's,%%SYSCONFDIR%%,${SYSCONFDIR},' \
		-e 's,%%CATALINA_BASE%%,${CATALINA_BASE},' \
		< ${FILESDIR}/README.OpenBSD \
		> ${PREFIX}/${DISTNAME}/README.OpenBSD
	@@sed -e 's,%%PREFIX%%,${TRUEPREFIX},' \
		-e 's,%%DISTNAME%%,${DISTNAME},' \
		-e 's,%%CATALINA_BASE%%,${CATALINA_BASE},' \
		< ${FILESDIR}/tomcat.rc > ${SAMPLEDIR}/tomcat.rc

.include "bsd.port.mk"
@


1.9
log
@javaPathHelper should be in RUN_DEPENDS not BUILD_DEPENDS. okay nikolay@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2006/08/10 18:26:23 kurt Exp $
@


1.8
log
@pkg bump all 1.3 and 1.4 java ports that haven't been yet since the
java.port.mk changes. okay naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2006/08/03 19:38:51 kurt Exp $
d8 2
a9 2
PKGNAME=	${DISTNAME}p4
PKGNAME-examples=jakarta-tomcat-examples-${V}p4
d25 3
a27 2
BUILD_DEPENDS=	::archivers/gtar \
		::java/javaPathHelper
@


1.7
log
@convert tomcat.rc to use javaPathHelper for JAVA_HOME
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2005/12/13 18:59:09 kurt Exp $
d8 2
a9 2
PKGNAME=	${DISTNAME}p3
PKGNAME-examples=jakarta-tomcat-examples-${V}p3
@


1.6
log
@fix MASTER_SITES. also fixed issue when pkg_delete both -examples
and base package at the same time. pkg bumped.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2005/12/06 17:07:02 ian Exp $
d8 2
a9 2
PKGNAME=	${DISTNAME}p2
PKGNAME-examples=jakarta-tomcat-examples-${V}p2
d25 2
a26 1
BUILD_DEPENDS=	::archivers/gtar
a74 1
		-e 's,%%JAVA_HOME%%,${JAVA_HOME},' \
@


1.5
log
@New homepage, ok kurt@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2005/06/17 21:34:20 kurt Exp $
d8 2
a9 2
PKGNAME=	${DISTNAME}p1
PKGNAME-examples=jakarta-tomcat-examples-${V}p1
d12 2
a13 2
MASTER_SITES=	${MASTER_SITE_APACHE:=jakarta/tomcat-5/v$V/bin/} \
		http://archive.apache.org/dist/jakarta/tomcat-5/archive/v${V}/bin/
d59 1
a59 1
	${INSTALL_DATA_DIR} ${WRKINST}/${CATALINA_BASE}/conf/Catalina/localhost
d61 1
a61 1
		${WRKINST}/${CATALINA_BASE}/conf/Catalina/localhost
@


1.4
log
@- begin using java MODULE
- bump pkgnames
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2005/03/15 22:46:21 kurt Exp $
d15 1
a15 1
HOMEPAGE=	http://jakarta.apache.org/
@


1.3
log
@- put back ONLY_FOR_ARCHS=i386 to avoid packages being built on !i386
  (the jvm as a RUN_DEPEND is not enough to prevent packages from being
   created)

okay naddy@@
@
text
@d1 1
a1 4
# $OpenBSD: Makefile,v 1.2 2005/03/03 21:50:43 kurt Exp $

# Requires a JVM
ONLY_FOR_ARCHS=	i386
d8 2
a9 2
PKGNAME=	${DISTNAME}p0
PKGNAME-examples=jakarta-tomcat-examples-${V}p0
d22 3
a25 3

JAVA_HOME=	${LOCALBASE}/jdk1.3.1-linux
RUN_DEPENDS=	:jdk*->=1.3:devel/jdk/1.3-linux
@


1.2
log
@- Change install to DISTNAME instead of PKGNAME
- Kill INSTALL (from alek@@)
- Move examples and documentation to -examples sub-package

with help and ok from nikolay@@
@
text
@d1 4
a4 1
# $OpenBSD: Makefile,v 1.1.1.1 2004/11/04 21:46:04 naddy Exp $
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d4 1
a4 3

# Requires a JVM
ONLY_FOR_ARCHS=	i386
d8 2
d17 4
a20 1
MAINTAINER=	Kurt Miller <truk@@apache.org>
d27 5
d46 1
a46 1
SUBST_VARS+=	PKGNAME CONFDIR CATALINA_BASE SAMPLEDIR
d49 1
a49 1
	${INSTALL_DATA_DIR} ${PREFIX}/${PKGNAME}
d52 1
a52 1
		tar -C ${PREFIX}/${PKGNAME} -xf -
d54 2
d57 6
a62 3
		tar cf - conf webapps | \
		tar -C ${SAMPLEDIR} -xf -
	find ${WRKINST} -name *.orig -or -name *.bat -or -name *.exe | \
d65 1
a65 1
		${PREFIX}/${PKGNAME}/bin/setclasspath.sh
d67 1
a67 1
		-e 's,%%PKGNAME%%,${PKGNAME},' \
d69 1
d71 1
a71 1
		> ${PREFIX}/${PKGNAME}/README.OpenBSD
d73 1
a73 1
		-e 's,%%PKGNAME%%,${PKGNAME},' \
d75 2
a76 1
		< ${FILESDIR}/tomcat.rc > ${SAMPLEDIR}/conf/tomcat.rc
@


1.1.1.1
log
@Import Jakarta Tomcat 5.0.28; submitted by Kurt Miller <truk@@apache.org>.

Tomcat 5 is a Servlet/JSP container that implements the Servlet 2.4
and JavaServer Pages 2.0 specifications from the Java Community 
Process.  Tomcat can be run as a standalone web server with 
Servlet and JSP support, or using Apache HTTP Server as its web 
server via the mod_jk Apache module (the www/mod_jk package).
@
text
@@
