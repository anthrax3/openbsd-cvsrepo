head	1.12;
access;
symbols
	OPENBSD_6_0:1.11.0.2
	OPENBSD_6_0_BASE:1.11
	OPENBSD_5_9:1.10.0.4
	OPENBSD_5_9_BASE:1.10
	OPENBSD_5_8:1.10.0.6
	OPENBSD_5_8_BASE:1.10
	OPENBSD_5_7:1.10.0.2
	OPENBSD_5_7_BASE:1.10
	OPENBSD_5_6:1.9.0.2
	OPENBSD_5_6_BASE:1.9
	OPENBSD_5_5:1.7.0.2
	OPENBSD_5_5_BASE:1.7
	OPENBSD_5_4:1.6.0.2
	OPENBSD_5_4_BASE:1.6
	OPENBSD_5_3:1.4.0.2
	OPENBSD_5_3_BASE:1.4
	OPENBSD_5_2:1.3.0.2
	OPENBSD_5_2_BASE:1.3
	OPENBSD_5_1_BASE:1.1
	OPENBSD_5_1:1.1.0.2;
locks; strict;
comment	@# @;


1.12
date	2016.09.01.16.28.11;	author robert;	state Exp;
branches;
next	1.11;
commitid	0duujWXlyOCBrehm;

1.11
date	2016.03.06.10.51.14;	author robert;	state Exp;
branches;
next	1.10;
commitid	Upms3IeOsaLsGxbP;

1.10
date	2014.09.11.19.04.52;	author robert;	state Exp;
branches;
next	1.9;
commitid	WrglT9ERNBhPArdd;

1.9
date	2014.07.20.17.22.33;	author robert;	state Exp;
branches;
next	1.8;
commitid	yFSQqywU9tg3Fhqe;

1.8
date	2014.04.17.16.27.53;	author robert;	state Exp;
branches;
next	1.7;

1.7
date	2013.10.29.06.51.34;	author robert;	state Exp;
branches;
next	1.6;

1.6
date	2013.04.03.08.19.10;	author robert;	state Exp;
branches;
next	1.5;

1.5
date	2013.03.15.08.30.33;	author robert;	state Exp;
branches;
next	1.4;

1.4
date	2012.11.07.06.59.45;	author robert;	state Exp;
branches;
next	1.3;

1.3
date	2012.07.10.09.22.34;	author robert;	state Exp;
branches;
next	1.2;

1.2
date	2012.02.17.10.19.50;	author robert;	state Exp;
branches;
next	1.1;

1.1
date	2011.12.14.16.58.19;	author robert;	state Exp;
branches;
next	;


desc
@@


1.12
log
@update to 53.0.2785.89
@
text
@$OpenBSD: patch-chrome_browser_chrome_browser_main_posix_cc,v 1.11 2016/03/06 10:51:14 robert Exp $
--- chrome/browser/chrome_browser_main_posix.cc.orig.port	Thu Sep  1 00:03:27 2016
+++ chrome/browser/chrome_browser_main_posix.cc	Thu Sep  1 11:12:19 2016
@@@@ -275,6 +275,11 @@@@ void ChromeBrowserMainPartsPosix::PostMainMessageLoopS
     g_pipe_pid = getpid();
     g_shutdown_pipe_read_fd = pipefd[0];
     g_shutdown_pipe_write_fd = pipefd[1];
+#if defined(OS_OPENBSD)
+    // PTHREAD_STACK_MIN causes chromium to crash under FreeBSD,
+    // we request the default pthread stack size by specifying 0 here.
+    const size_t kShutdownDetectorThreadStackSize = 0;
+#else
 #if !defined(ADDRESS_SANITIZER) && !defined(KEEP_SHADOW_STACKS)
     const size_t kShutdownDetectorThreadStackSize = PTHREAD_STACK_MIN * 2;
 #else
@@@@ -282,6 +287,7 @@@@ void ChromeBrowserMainPartsPosix::PostMainMessageLoopS
     // shadow stacks) bloat the stack frames, so we need to increase the stack
     // size to avoid hitting the guard page.
     const size_t kShutdownDetectorThreadStackSize = PTHREAD_STACK_MIN * 4;
+#endif
 #endif
     // TODO(viettrungluu,willchan): crbug.com/29675 - This currently leaks, so
     // if you change this, you'll probably need to change the suppression.
@


1.11
log
@update to 49.0.2623.75
@
text
@d1 4
a4 4
$OpenBSD: patch-chrome_browser_chrome_browser_main_posix_cc,v 1.10 2014/09/11 19:04:52 robert Exp $
--- chrome/browser/chrome_browser_main_posix.cc.orig.port	Wed Feb 24 00:01:58 2016
+++ chrome/browser/chrome_browser_main_posix.cc	Thu Mar  3 09:43:25 2016
@@@@ -274,6 +274,11 @@@@ void ChromeBrowserMainPartsPosix::PostMainMessageLoopS
d16 1
a16 1
@@@@ -281,6 +286,7 @@@@ void ChromeBrowserMainPartsPosix::PostMainMessageLoopS
@


1.10
log
@update to 37.0.2062.120
@
text
@d1 4
a4 4
$OpenBSD$
--- chrome/browser/chrome_browser_main_posix.cc.orig.port	Wed Sep 10 22:14:04 2014
+++ chrome/browser/chrome_browser_main_posix.cc	Wed Sep 10 22:14:59 2014
@@@@ -270,6 +270,11 @@@@ void ChromeBrowserMainPartsPosix::PostMainMessageLoopS
d16 1
a16 1
@@@@ -277,6 +282,7 @@@@ void ChromeBrowserMainPartsPosix::PostMainMessageLoopS
@


1.9
log
@update to 36.0.1985.125;

from this release Chromium uses Aura instead of Gtk+ so the UI will look
a bit different, and that is completely normal.
@
text
@d1 4
a4 13
$OpenBSD: patch-chrome_browser_chrome_browser_main_posix_cc,v 1.8 2014/04/17 16:27:53 robert Exp $
--- chrome/browser/chrome_browser_main_posix.cc.orig.port	Tue Jul 15 13:01:31 2014
+++ chrome/browser/chrome_browser_main_posix.cc	Thu Jul 17 12:25:31 2014
@@@@ -283,7 +283,7 @@@@ void ChromeBrowserMainPartsPosix::PreEarlyInitializati
   if (!fd_limit_string.empty()) {
     base::StringToInt(fd_limit_string, &fd_limit);
   }
-#if defined(OS_MACOSX)
+#if defined(OS_BSD)
   // We use quite a few file descriptors for our IPC, and the default limit on
   // the Mac is low (256), so bump it up if there is no explicit override.
   if (fd_limit == 0) {
@@@@ -305,6 +305,11 @@@@ void ChromeBrowserMainPartsPosix::PostMainMessageLoopS
d12 1
a12 1
+#else 
d16 1
a16 1
@@@@ -312,6 +317,7 @@@@ void ChromeBrowserMainPartsPosix::PostMainMessageLoopS
@


1.8
log
@update to 34.0.1847.116 and disable Werror for the future clang update
@
text
@d1 4
a4 4
$OpenBSD: patch-chrome_browser_chrome_browser_main_posix_cc,v 1.7 2013/10/29 06:51:34 robert Exp $
--- chrome/browser/chrome_browser_main_posix.cc.orig.port	Wed Apr  2 21:04:38 2014
+++ chrome/browser/chrome_browser_main_posix.cc	Sat Apr 12 09:40:41 2014
@@@@ -292,7 +292,7 @@@@ void ChromeBrowserMainPartsPosix::PreEarlyInitializati
d13 1
a13 1
@@@@ -314,6 +314,11 @@@@ void ChromeBrowserMainPartsPosix::PostMainMessageLoopS
d25 1
a25 1
@@@@ -321,6 +326,7 @@@@ void ChromeBrowserMainPartsPosix::PostMainMessageLoopS
@


1.7
log
@update to 30.0.1599.101
@
text
@d1 4
a4 4
$OpenBSD: patch-chrome_browser_chrome_browser_main_posix_cc,v 1.6 2013/04/03 08:19:10 robert Exp $
--- chrome/browser/chrome_browser_main_posix.cc.orig.port	Fri Oct 11 19:29:35 2013
+++ chrome/browser/chrome_browser_main_posix.cc	Sun Oct 20 18:52:07 2013
@@@@ -291,7 +291,7 @@@@ void ChromeBrowserMainPartsPosix::PreEarlyInitializati
d13 1
a13 1
@@@@ -313,6 +313,11 @@@@ void ChromeBrowserMainPartsPosix::PostMainMessageLoopS
d23 1
a23 1
     const size_t kShutdownDetectorThreadStackSize = PTHREAD_STACK_MIN;
d25 1
a25 1
@@@@ -320,6 +325,7 @@@@ void ChromeBrowserMainPartsPosix::PostMainMessageLoopS
@


1.6
log
@- update to 26.0.1410.43
- switch chromium to use clang/llvm instead of gcc
- switch back to the internal libvpx because it's an unreleased version
  at this point
- re-enable SSE2 support
@
text
@d1 4
a4 4
$OpenBSD$
--- chrome/browser/chrome_browser_main_posix.cc.orig.port	Fri Mar 22 02:14:04 2013
+++ chrome/browser/chrome_browser_main_posix.cc	Tue Apr  2 21:05:17 2013
@@@@ -288,7 +288,7 @@@@ void ChromeBrowserMainPartsPosix::PreEarlyInitializati
d13 20
@


1.5
log
@update to 25.0.1364.160
@
text
@d1 4
a4 4
$OpenBSD: patch-chrome_browser_chrome_browser_main_posix_cc,v 1.4 2012/11/07 06:59:45 robert Exp $
--- chrome/browser/chrome_browser_main_posix.cc.orig	Thu Mar  7 21:02:17 2013
+++ chrome/browser/chrome_browser_main_posix.cc	Fri Mar  8 18:09:13 2013
@@@@ -220,7 +220,7 @@@@ void ChromeBrowserMainPartsPosix::PreEarlyInitializati
@


1.4
log
@update to 23.0.1271.64
@
text
@d1 4
a4 4
$OpenBSD: patch-chrome_browser_chrome_browser_main_posix_cc,v 1.3 2012/07/10 09:22:34 robert Exp $
--- chrome/browser/chrome_browser_main_posix.cc.orig	Wed Oct 31 20:02:26 2012
+++ chrome/browser/chrome_browser_main_posix.cc	Tue Nov  6 22:45:22 2012
@@@@ -212,7 +212,7 @@@@ void ChromeBrowserMainPartsPosix::PreEarlyInitializati
@


1.3
log
@update to 20.0.1132.47
@
text
@d1 4
a4 4
$OpenBSD$
--- chrome/browser/chrome_browser_main_posix.cc.orig	Fri Jun  1 06:14:35 2012
+++ chrome/browser/chrome_browser_main_posix.cc	Fri Jun  1 06:14:42 2012
@@@@ -216,7 +216,7 @@@@ void ChromeBrowserMainPartsPosix::PreEarlyInitializati
@


1.2
log
@update to 17.0.963.56
@
text
@d1 4
a4 4
$OpenBSD: patch-chrome_browser_chrome_browser_main_posix_cc,v 1.1 2011/12/14 16:58:19 robert Exp $
--- chrome/browser/chrome_browser_main_posix.cc.orig	Fri Jan 27 09:02:34 2012
+++ chrome/browser/chrome_browser_main_posix.cc	Wed Feb 15 16:42:39 2012
@@@@ -210,7 +210,7 @@@@ void ChromeBrowserMainPartsPosix::PreEarlyInitializati
d9 1
a9 1
+#if defined(OS_MACOSX) || defined(OS_OPENBSD)
a12 9
@@@@ -231,7 +231,7 @@@@ void ChromeBrowserMainPartsPosix::PostMainMessageLoopS
   } else {
     g_shutdown_pipe_read_fd = pipefd[0];
     g_shutdown_pipe_write_fd = pipefd[1];
-    const size_t kShutdownDetectorThreadStackSize = 4096;
+    const size_t kShutdownDetectorThreadStackSize = PTHREAD_STACK_MIN;
     // TODO(viettrungluu,willchan): crbug.com/29675 - This currently leaks, so
     // if you change this, you'll probably need to change the suppression.
     if (!base::PlatformThread::CreateNonJoinable(
@


1.1
log
@update to 16.0.912.63
@
text
@d1 4
a4 4
$OpenBSD$
--- chrome/browser/chrome_browser_main_posix.cc.orig	Tue Dec 13 21:31:50 2011
+++ chrome/browser/chrome_browser_main_posix.cc	Tue Dec 13 21:31:59 2011
@@@@ -205,7 +205,7 @@@@ void ChromeBrowserMainPartsPosix::PreEarlyInitializati
d13 9
@

