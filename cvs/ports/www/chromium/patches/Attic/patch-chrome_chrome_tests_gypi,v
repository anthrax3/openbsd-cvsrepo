head	1.3;
access;
symbols
	OPENBSD_4_9:1.2.0.2
	OPENBSD_4_9_BASE:1.2;
locks; strict;
comment	@# @;


1.3
date	2011.03.15.11.38.05;	author robert;	state dead;
branches;
next	1.2;

1.2
date	2011.02.08.09.43.02;	author espie;	state Exp;
branches;
next	1.1;

1.1
date	2010.12.13.09.51.45;	author espie;	state Exp;
branches;
next	;


desc
@@


1.3
log
@update to 10.0.648.133
@
text
@$OpenBSD: patch-chrome_chrome_tests_gypi,v 1.2 2011/02/08 09:43:02 espie Exp $
--- chrome/chrome_tests.gypi.orig	Fri Jan 21 10:20:41 2011
+++ chrome/chrome_tests.gypi	Sun Jan 23 23:27:33 2011
@@@@ -138,7 +138,7 @@@@
         'test/unit/chrome_test_suite.h',
       ],
       'conditions': [
-        ['OS=="linux"', {
+        ['OS=="linux" or OS=="openbsd"', {
           'dependencies': [
             '../build/linux/system.gyp:gtk',
             '../build/linux/system.gyp:nss',
@@@@ -188,7 +188,7 @@@@
         'test/ui/ui_test_suite.h',
       ],
       'conditions': [
-        ['OS=="linux"', {
+        ['OS=="linux" or OS=="openbsd"', {
           'dependencies': [
             '../build/linux/system.gyp:gtk',
           ],
@@@@ -212,7 +212,7 @@@@
         'test/unit/run_all_unittests.cc',
       ],
       'conditions': [
-        ['OS=="linux"', {
+        ['OS=="linux" or OS=="openbsd"', {
           'dependencies': [
             # Needed for the following #include chain:
             #   test/unit/run_all_unittests.cc
@@@@ -247,7 +247,7 @@@@
         'test/automated_ui_tests/automated_ui_tests.h',
       ],
       'conditions': [
-        ['OS=="linux"', {
+        ['OS=="linux" or OS=="openbsd"', {
           'dependencies': [
             '../tools/xdisplaycheck/xdisplaycheck.gyp:xdisplaycheck',
           ],
@@@@ -325,7 +325,7 @@@@
         'test/unit/chrome_test_suite.h',
       ],
       'conditions': [
-        ['OS=="linux"', {
+        ['OS=="linux" or OS=="openbsd"', {
           'dependencies': [
             '../build/linux/system.gyp:gtk',
             '../build/linux/system.gyp:nss',
@@@@ -545,12 +545,12 @@@@
             '../webkit/webkit.gyp:copy_npapi_pepper_test_plugin',
           ],
         }],
-        ['OS=="linux"', {
+        ['OS=="linux" or OS=="openbsd"', {
           'dependencies': [
             '../build/linux/system.gyp:gtk',
             '../tools/xdisplaycheck/xdisplaycheck.gyp:xdisplaycheck',
           ],
-        }, { # else: OS != "linux"
+        }, { # else: OS != ("linux" or "openbsd")
           'sources!': [
             'browser/process_singleton_linux_uitest.cc',
           ],
@@@@ -706,7 +706,7 @@@@
         'test/webdriver/commands/webdriver_command.cc',
       ],
       'conditions': [
-        ['OS=="linux"', {
+        ['OS=="linux" or OS=="openbsd"', {
           'dependencies': [
             '../build/linux/system.gyp:gtk',
             '../tools/xdisplaycheck/xdisplaycheck.gyp:xdisplaycheck',
@@@@ -1695,7 +1695,7 @@@@
             ['exclude', '^browser/chromeos/'],
           ],
         }],
-        ['OS=="linux"', {
+        ['OS=="linux" or OS=="openbsd"', {
           'conditions': [
             ['gcc_version==44', {
               # Avoid gcc 4.4 strict aliasing issues in stl_tree.h when
@@@@ -1732,7 +1732,7 @@@@
           'sources!': [
             'browser/printing/print_job_unittest.cc',
           ],
-        }, { # else: OS != "linux"
+        }, { # else: OS != ("linux" or "openbsd")
           'sources!': [
             'browser/gtk/tabs/tab_renderer_gtk_unittest.cc',
             'browser/renderer_host/gtk_key_bindings_handler_unittest.cc',
@@@@ -2191,7 +2191,7 @@@@
             'browser/renderer_host/test/render_view_host_manager_browsertest.cc',
           ],
         }],
-        ['OS=="linux"', {
+        ['OS=="linux" or OS=="openbsd"', {
           'dependencies': [
             '../build/linux/system.gyp:gtk',
             '../build/linux/system.gyp:nss',
@@@@ -2343,7 +2343,7 @@@@
         'test/startup/startup_test.cc',
       ],
       'conditions': [
-        ['OS=="linux"', {
+        ['OS=="linux" or OS=="openbsd"', {
           'dependencies': [
             '../build/linux/system.gyp:gtk',
             '../tools/xdisplaycheck/xdisplaycheck.gyp:xdisplaycheck',
@@@@ -2433,7 +2433,7 @@@@
             },
           },
         },],
-        ['OS=="linux"', {
+        ['OS=="linux" or OS=="openbsd"', {
           'dependencies': [
             '../build/linux/system.gyp:gtk',
           ],
@@@@ -2459,7 +2459,7 @@@@
         'test/page_cycler/page_cycler_test.cc',
       ],
       'conditions': [
-        ['OS=="linux"', {
+        ['OS=="linux" or OS=="openbsd"', {
           'dependencies': [
             '../build/linux/system.gyp:gtk',
             '../tools/xdisplaycheck/xdisplaycheck.gyp:xdisplaycheck',
@@@@ -2496,7 +2496,7 @@@@
         'test/tab_switching/tab_switching_test.cc',
       ],
       'conditions': [
-        ['OS=="linux"', {
+        ['OS=="linux" or OS=="openbsd"', {
           'dependencies': [
             '../build/linux/system.gyp:gtk',
             '../tools/xdisplaycheck/xdisplaycheck.gyp:xdisplaycheck',
@@@@ -2530,7 +2530,7 @@@@
         'test/memory_test/memory_test.cc',
       ],
       'conditions': [
-        ['OS=="linux"', {
+        ['OS=="linux" or OS=="openbsd"', {
           'dependencies': [
             '../build/linux/system.gyp:gtk',
             '../tools/xdisplaycheck/xdisplaycheck.gyp:xdisplaycheck',
@@@@ -2683,7 +2683,7 @@@@
             'browser/sync/util/data_encryption_unittest.cc',
           ],
         }],
-        ['OS=="linux"', {
+        ['OS=="linux" or OS=="openbsd"', {
           'dependencies': [
             '../build/linux/system.gyp:gtk',
             '../build/linux/system.gyp:nss',
@@@@ -2801,7 +2801,7 @@@@
       ],
       'conditions': [
         # Plugin code.
-        ['OS=="linux" or OS=="win"', {
+        ['OS=="linux" or OS=="openbsd" or OS=="win"', {
           'dependencies': [
             'plugin',
            ],
@@@@ -2809,7 +2809,7 @@@@
             'plugin',
           ],
         }],
-        ['OS=="linux"', {
+        ['OS=="linux" or OS=="openbsd"', {
            'dependencies': [
              '../build/linux/system.gyp:gtk',
              '../build/linux/system.gyp:nss',
@@@@ -2940,7 +2940,7 @@@@
             'test/perf/url_parse_perftest.cc',
           ],
           'conditions': [
-            ['OS=="linux"', {
+            ['OS=="linux" or OS=="openbsd"', {
               'dependencies': [
                 '../build/linux/system.gyp:gtk',
                 '../tools/xdisplaycheck/xdisplaycheck.gyp:xdisplaycheck',
@


1.2
log
@late update to chromium 9, robert@@ did the work, but he doesn't have the
time right now.
Tree is still locked!
Reasons for the update:
- good work that can be used now
- only builds on i386/amd64, and they're fast
- multiple security problems in old chrome
- old chrome half working, can't break it more than it was.

This one requires resources (see MESSAGE), but it's ways more stable.

Again, discussed with sthen@@, jasper@@, naddy@@, miod@@
@
text
@d1 1
a1 1
$OpenBSD$
@


1.1
log
@cut the "monster patches" into small pieces. pval can fix it to his liking
if he comes back.
In the mean time, fix build of chromium by adding the required
-I/usr/local/includes to gyp glue where needed.
@
text
@d2 4
a5 4
--- chrome/chrome_tests.gypi.orig	Tue Mar 30 07:31:34 2010
+++ chrome/chrome_tests.gypi	Sun Nov 28 00:11:31 2010
@@@@ -122,7 +122,7 @@@@
         'test/ui_test_utils_win.cc',
d9 1
a9 1
+        ['OS=="linux" or OS=="freebsd" or OS=="openbsd"', {
d12 2
a13 2
           ],
@@@@ -167,7 +167,7 @@@@
d18 1
a18 1
+        ['OS=="linux" or OS=="freebsd" or OS=="openbsd"', {
d22 1
a22 1
@@@@ -197,7 +197,7 @@@@
d27 1
a27 1
+        ['OS=="linux" or OS=="freebsd" or OS=="openbsd"', {
d31 1
a31 1
@@@@ -232,7 +232,7 @@@@
d36 1
a36 1
+        ['OS=="linux" or OS=="freebsd" or OS=="openbsd"', {
d40 11
a50 2
@@@@ -333,7 +333,7 @@@@
             '../webkit/webkit.gyp:npapi_test_plugin',
d54 16
a69 1
+        ['OS=="linux" or OS=="freebsd" or OS=="openbsd"', {
d73 2
a74 2
@@@@ -982,7 +982,7 @@@@
             '../sandbox/sandbox.gyp:*',
d78 1
a78 1
+        ['OS=="linux" or OS=="freebsd" or OS=="openbsd"', {
d80 1
a80 1
             [ 'gcc_version==44', {
d82 12
a93 3
@@@@ -1297,7 +1297,7 @@@@
             },
           }
d96 1
a96 1
+        ['OS=="linux" or OS=="freebsd" or OS=="openbsd"', {
d99 2
a100 11
             '../tools/xdisplaycheck/xdisplaycheck.gyp:xdisplaycheck',
@@@@ -1311,7 +1311,7 @@@@
             '<@@(browser_tests_sources_views_specific)',
           ],
         }],
-        ['OS=="linux" and toolkit_views==0 and chromeos==0', {
+        ['(OS=="linux" or OS=="freebsd" or OS=="openbsd") and toolkit_views==0 and chromeos==0', {
           'sources': [
             'browser/extensions/browser_action_test_util_gtk.cc',
             'browser/gtk/view_id_util_browsertest.cc',
@@@@ -1371,7 +1371,7 @@@@
d105 1
a105 1
+        ['OS=="linux" or OS=="freebsd" or OS=="openbsd"', {
d109 3
a111 3
@@@@ -1431,7 +1431,7 @@@@
             '<(allocator_target)',
           ],
d114 1
a114 1
+        ['OS=="linux" or OS=="freebsd" or OS=="openbsd"', {
d118 1
a118 1
@@@@ -1457,7 +1457,7 @@@@
d123 1
a123 1
+        ['OS=="linux" or OS=="freebsd" or OS=="openbsd"', {
d127 1
a127 1
@@@@ -1494,7 +1494,7 @@@@
d132 1
a132 1
+        ['OS=="linux" or OS=="freebsd" or OS=="openbsd"', {
d136 1
a136 1
@@@@ -1528,7 +1528,7 @@@@
d141 1
a141 1
+        ['OS=="linux" or OS=="freebsd" or OS=="openbsd"', {
d145 1
a145 1
@@@@ -1666,7 +1666,7 @@@@
d150 1
a150 1
+        ['OS=="linux" or OS=="freebsd" or OS=="openbsd"', {
d153 2
a154 2
             'packed_resources'
@@@@ -1736,7 +1736,7 @@@@
d159 1
a159 1
+        ['OS=="linux" or OS=="freebsd" or OS=="openbsd" or OS=="win"', {
d163 2
a164 1
@@@@ -1745,7 +1745,7 @@@@
a166 1
         # Linux-specific rules.
d168 1
a168 1
+        ['OS=="linux" or OS=="freebsd" or OS=="openbsd"', {
d171 2
a172 2
            ],
@@@@ -1816,7 +1816,7 @@@@
d177 1
a177 1
+            ['OS=="linux" or OS=="freebsd" or OS=="openbsd"', {
a180 9
@@@@ -1955,7 +1955,7 @@@@
       ]},  # 'targets'
     ],  # OS=="win"
     # Build on linux x86_64 only if linux_fpic==1
-    ['OS=="mac" or OS=="win" or (OS=="linux" and target_arch==python_arch '
+    ['OS=="mac" or OS=="win" or ((OS=="linux" or OS=="freebsd" or OS=="openbsd") and target_arch==python_arch '
      'and (target_arch!="x64" or linux_fpic==1))', {
       'targets': [
         {
@

