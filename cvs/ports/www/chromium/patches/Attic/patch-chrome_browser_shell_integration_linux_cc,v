head	1.9;
access;
symbols
	OPENBSD_5_2:1.8.0.2
	OPENBSD_5_2_BASE:1.8
	OPENBSD_5_1_BASE:1.5
	OPENBSD_5_1:1.5.0.2
	OPENBSD_5_0:1.4.0.2
	OPENBSD_5_0_BASE:1.4
	OPENBSD_4_9:1.2.0.2
	OPENBSD_4_9_BASE:1.2;
locks; strict;
comment	@# @;


1.9
date	2012.08.12.15.13.57;	author fgsch;	state dead;
branches;
next	1.8;

1.8
date	2012.07.10.09.22.34;	author robert;	state Exp;
branches;
next	1.7;

1.7
date	2012.04.03.13.59.35;	author robert;	state Exp;
branches;
next	1.6;

1.6
date	2012.02.17.10.19.50;	author robert;	state Exp;
branches;
next	1.5;

1.5
date	2011.09.19.08.55.26;	author robert;	state Exp;
branches;
next	1.4;

1.4
date	2011.06.08.20.36.56;	author robert;	state Exp;
branches;
next	1.3;

1.3
date	2011.03.15.11.38.05;	author robert;	state Exp;
branches;
next	1.2;

1.2
date	2011.02.08.09.43.02;	author espie;	state Exp;
branches;
next	1.1;

1.1
date	2010.12.13.09.51.45;	author espie;	state Exp;
branches;
next	;


desc
@@


1.9
log
@- Better fix for the cups API deprecation issue
- Remove unneeded patch since we have openat(5) now (and from 5.0)
- Bump revision

ajacoutot@@ robert@@ (maintainer) ok.
@
text
@$OpenBSD: patch-chrome_browser_shell_integration_linux_cc,v 1.8 2012/07/10 09:22:34 robert Exp $
--- chrome/browser/shell_integration_linux.cc.orig	Sat Jul  7 15:52:44 2012
+++ chrome/browser/shell_integration_linux.cc	Sat Jul  7 15:58:16 2012
@@@@ -122,6 +122,8 @@@@ bool CreateShortcutOnDesktop(const FilePath& shortcut_
   if (!PathService::Get(chrome::DIR_USER_DESKTOP, &desktop_path))
     return false;
 
+#if !defined(OS_OPENBSD)
+// BSD: Linux-specific calls like openat are used so defined out for BSD.
   int desktop_fd = open(desktop_path.value().c_str(), O_RDONLY | O_DIRECTORY);
   if (desktop_fd < 0)
     return false;
@@@@ -150,6 +152,7 @@@@ bool CreateShortcutOnDesktop(const FilePath& shortcut_
 
   if (HANDLE_EINTR(close(desktop_fd)) < 0)
     PLOG(ERROR) << "close";
+#endif
 
   return true;
 }
@


1.8
log
@update to 20.0.1132.47
@
text
@d1 1
a1 1
$OpenBSD$
@


1.7
log
@update to 18.0.1025.142; requires gcc 4.6 from now on
@
text
@d1 4
a4 4
$OpenBSD: patch-chrome_browser_shell_integration_linux_cc,v 1.6 2012/02/17 10:19:50 robert Exp $
--- chrome/browser/shell_integration_linux.cc.orig	Tue Mar 27 03:02:19 2012
+++ chrome/browser/shell_integration_linux.cc	Sun Apr  1 20:04:43 2012
@@@@ -123,6 +123,8 @@@@ void CreateShortcutOnDesktop(const FilePath& shortcut_
d6 1
a6 1
     return;
d12 2
a13 2
     return;
@@@@ -151,6 +153,7 @@@@ void CreateShortcutOnDesktop(const FilePath& shortcut_
d17 3
a19 1
+#endif  // !defined(OS_OPENBSD)
a20 2
 
 void CreateShortcutInApplicationsMenu(const FilePath& shortcut_filename,
@


1.6
log
@update to 17.0.963.56
@
text
@d1 4
a4 4
$OpenBSD: patch-chrome_browser_shell_integration_linux_cc,v 1.5 2011/09/19 08:55:26 robert Exp $
--- chrome/browser/shell_integration_linux.cc.orig	Fri Jan 27 09:02:34 2012
+++ chrome/browser/shell_integration_linux.cc	Thu Feb  9 09:31:06 2012
@@@@ -124,6 +124,8 @@@@ void CreateShortcutOnDesktop(const FilePath& shortcut_
d13 1
a13 1
@@@@ -152,6 +154,7 @@@@ void CreateShortcutOnDesktop(const FilePath& shortcut_
@


1.5
log
@update to 14.0.835.163
@
text
@d1 4
a4 4
$OpenBSD: patch-chrome_browser_shell_integration_linux_cc,v 1.4 2011/06/08 20:36:56 robert Exp $
--- chrome/browser/shell_integration_linux.cc.orig	Tue Aug 23 10:29:13 2011
+++ chrome/browser/shell_integration_linux.cc	Wed Aug 24 10:54:22 2011
@@@@ -122,6 +122,8 @@@@ void CreateShortcutOnDesktop(const FilePath& shortcut_
d13 1
a13 1
@@@@ -150,6 +152,7 @@@@ void CreateShortcutOnDesktop(const FilePath& shortcut_
@


1.4
log
@Update to the new stable branch: 12.0.742.91
http://googlechromereleases.blogspot.com/2011/06/chrome-stable-release.html
@
text
@d1 4
a4 4
$OpenBSD: patch-chrome_browser_shell_integration_linux_cc,v 1.3 2011/03/15 11:38:05 robert Exp $
--- chrome/browser/shell_integration_linux.cc.orig	Mon Jun  6 11:12:10 2011
+++ chrome/browser/shell_integration_linux.cc	Wed Jun  8 09:58:36 2011
@@@@ -118,6 +118,8 @@@@ void CreateShortcutOnDesktop(const FilePath& shortcut_
d13 1
a13 1
@@@@ -146,6 +148,7 @@@@ void CreateShortcutOnDesktop(const FilePath& shortcut_
@


1.3
log
@update to 10.0.648.133
@
text
@d1 4
a4 4
$OpenBSD: patch-chrome_browser_shell_integration_linux_cc,v 1.2 2011/02/08 09:43:02 espie Exp $
--- chrome/browser/shell_integration_linux.cc.orig	Fri Mar 11 10:01:43 2011
+++ chrome/browser/shell_integration_linux.cc	Mon Mar 14 10:55:37 2011
@@@@ -117,6 +117,8 @@@@ void CreateShortcutOnDesktop(const FilePath& shortcut_
d13 1
a13 1
@@@@ -145,6 +147,7 @@@@ void CreateShortcutOnDesktop(const FilePath& shortcut_
@


1.2
log
@late update to chromium 9, robert@@ did the work, but he doesn't have the
time right now.
Tree is still locked!
Reasons for the update:
- good work that can be used now
- only builds on i386/amd64, and they're fast
- multiple security problems in old chrome
- old chrome half working, can't break it more than it was.

This one requires resources (see MESSAGE), but it's ways more stable.

Again, discussed with sthen@@, jasper@@, naddy@@, miod@@
@
text
@d1 4
a4 4
$OpenBSD$
--- chrome/browser/shell_integration_linux.cc.orig	Fri Jan 21 10:20:26 2011
+++ chrome/browser/shell_integration_linux.cc	Sun Jan 23 23:27:31 2011
@@@@ -119,6 +119,8 @@@@ void CreateShortcutOnDesktop(const FilePath& shortcut_
d13 1
a13 1
@@@@ -147,6 +149,7 @@@@ void CreateShortcutOnDesktop(const FilePath& shortcut_
@


1.1
log
@cut the "monster patches" into small pieces. pval can fix it to his liking
if he comes back.
In the mean time, fix build of chromium by adding the required
-I/usr/local/includes to gyp glue where needed.
@
text
@d2 3
a4 3
--- chrome/browser/shell_integration_linux.cc.orig	Tue Mar 30 07:29:49 2010
+++ chrome/browser/shell_integration_linux.cc	Sun Nov 28 00:11:31 2010
@@@@ -131,6 +131,8 @@@@ void CreateShortcutOnDesktop(const FilePath& shortcut_
d13 1
a13 2
@@@@ -156,6 +158,7 @@@@ void CreateShortcutOnDesktop(const FilePath& shortcut_
   }
d15 2
a16 1
   HANDLE_EINTR(close(desktop_fd));
@

