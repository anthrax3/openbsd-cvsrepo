head	1.2;
access;
symbols;
locks; strict;
comment	@# @;


1.2
date	2011.02.08.09.48.26;	author espie;	state dead;
branches;
next	1.1;

1.1
date	2010.12.13.09.51.45;	author espie;	state Exp;
branches;
next	;


desc
@@


1.2
log
@... and ditch older patches too
@
text
@$OpenBSD: patch-chrome_browser_renderer_host_backing_store_x_cc,v 1.1 2010/12/13 09:51:45 espie Exp $
--- chrome/browser/renderer_host/backing_store_x.cc.orig	Tue Mar 30 07:29:15 2010
+++ chrome/browser/renderer_host/backing_store_x.cc	Sun Nov 28 00:11:31 2010
@@@@ -48,6 +48,9 @@@@ static void DestroySharedImage(Display* display,
   XShmDetach(display, shminfo);
   XDestroyImage(image);
   shmdt(shminfo->shmaddr);
+#if defined(OS_OPENBSD)
+  shmctl(shminfo->shmid, IPC_RMID, 0);
+#endif
 }
 
 BackingStoreX::BackingStoreX(RenderWidgetHost* widget,
@@@@ -304,7 +307,9 @@@@ bool BackingStoreX::CopyFromBackingStore(const gfx::Re
     }
 
     void* mapped_memory = shmat(shminfo.shmid, NULL, SHM_RDONLY);
+#if !defined(OS_OPENBSD)
     shmctl(shminfo.shmid, IPC_RMID, 0);
+#endif
     if (mapped_memory == (void*)-1) {
       XDestroyImage(image);
       return false;
@


1.1
log
@cut the "monster patches" into small pieces. pval can fix it to his liking
if he comes back.
In the mean time, fix build of chromium by adding the required
-I/usr/local/includes to gyp glue where needed.
@
text
@d1 1
a1 1
$OpenBSD$
@

