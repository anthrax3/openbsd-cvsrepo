head	1.10;
access;
symbols
	OPENBSD_6_1:1.8.0.2
	OPENBSD_6_1_BASE:1.8
	OPENBSD_6_0:1.2.0.2
	OPENBSD_6_0_BASE:1.2;
locks; strict;
comment	@# @;


1.10
date	2017.09.09.19.16.43;	author robert;	state Exp;
branches;
next	1.9;
commitid	o4y7MpMU3y8aR1pv;

1.9
date	2017.06.25.21.53.56;	author robert;	state Exp;
branches;
next	1.8;
commitid	l6xAjqoVop0UE8Em;

1.8
date	2017.03.14.12.18.54;	author robert;	state Exp;
branches;
next	1.7;
commitid	FgEdsLreTqAdn1i5;

1.7
date	2017.01.26.17.08.26;	author robert;	state Exp;
branches;
next	1.6;
commitid	SWz5LewWpip0ZZLw;

1.6
date	2016.12.10.15.35.25;	author robert;	state Exp;
branches;
next	1.5;
commitid	D24Pj03ujnweitOe;

1.5
date	2016.10.26.06.22.08;	author robert;	state Exp;
branches;
next	1.4;
commitid	Dt81be1Osjz00Uwx;

1.4
date	2016.09.01.16.28.11;	author robert;	state Exp;
branches;
next	1.3;
commitid	0duujWXlyOCBrehm;

1.3
date	2016.07.31.13.11.44;	author robert;	state Exp;
branches;
next	1.2;
commitid	dRegVegviFQGKQZc;

1.2
date	2016.05.27.06.28.21;	author robert;	state Exp;
branches;
next	1.1;
commitid	cpiCcJ3vjht5tEkH;

1.1
date	2016.04.26.14.22.24;	author robert;	state Exp;
branches;
next	;
commitid	qCqOPZ55nJ1pWebp;


desc
@@


1.10
log
@update to 61.0.3163.79
@
text
@$OpenBSD: patch-media_base_video_frame_cc,v 1.9 2017/06/25 21:53:56 robert Exp $

Index: media/base/video_frame.cc
--- media/base/video_frame.cc.orig
+++ media/base/video_frame.cc
@@@@ -63,7 +63,7 @@@@ static std::string StorageTypeToString(
       return "OWNED_MEMORY";
     case VideoFrame::STORAGE_SHMEM:
       return "SHMEM";
-#if defined(OS_LINUX)
+#if defined(OS_LINUX) || defined(OS_BSD)
     case VideoFrame::STORAGE_DMABUFS:
       return "DMABUFS";
 #endif
@@@@ -79,7 +79,7 @@@@ static std::string StorageTypeToString(
 // static
 static bool IsStorageTypeMappable(VideoFrame::StorageType storage_type) {
   return
-#if defined(OS_LINUX)
+#if defined(OS_LINUX) || defined(OS_BSD)
       // This is not strictly needed but makes explicit that, at VideoFrame
       // level, DmaBufs are not mappable from userspace.
       storage_type != VideoFrame::STORAGE_DMABUFS &&
@@@@ -334,7 +334,7 @@@@ scoped_refptr<VideoFrame> VideoFrame::WrapExternalYuva
   return frame;
 }
 
-#if defined(OS_LINUX)
+#if defined(OS_LINUX) || defined(OS_BSD)
 // static
 scoped_refptr<VideoFrame> VideoFrame::WrapExternalDmabufs(
     VideoPixelFormat format,
@@@@ -446,7 +446,7 @@@@ scoped_refptr<VideoFrame> VideoFrame::WrapVideoFrame(
     wrapping_frame->data_[i] = frame->data(i);
   }
 
-#if defined(OS_LINUX)
+#if defined(OS_LINUX) || defined(OS_BSD)
   // If there are any |dmabuf_fds_| plugged in, we should duplicate them.
   if (frame->storage_type() == STORAGE_DMABUFS) {
     std::vector<int> original_fds;
@@@@ -732,7 +732,7 @@@@ size_t VideoFrame::shared_memory_offset() const {
   return shared_memory_offset_;
 }
 
-#if defined(OS_LINUX)
+#if defined(OS_LINUX) || defined(OS_BSD)
 int VideoFrame::DmabufFd(size_t plane) const {
   DCHECK_EQ(storage_type_, STORAGE_DMABUFS);
   DCHECK(IsValidPlane(plane, format_));
@


1.9
log
@update to 59.0.3071.109
@
text
@d1 1
a1 1
$OpenBSD$
d6 1
a6 1
@@@@ -53,7 +53,7 @@@@ static std::string StorageTypeToString(
d15 1
a15 1
@@@@ -69,7 +69,7 @@@@ static std::string StorageTypeToString(
d24 1
a24 1
@@@@ -324,7 +324,7 @@@@ scoped_refptr<VideoFrame> VideoFrame::WrapExternalYuva
d33 1
a33 1
@@@@ -436,7 +436,7 @@@@ scoped_refptr<VideoFrame> VideoFrame::WrapVideoFrame(
d42 1
a42 1
@@@@ -722,7 +722,7 @@@@ size_t VideoFrame::shared_memory_offset() const {
@


1.8
log
@update to 57.0.2987.98
@
text
@d1 5
a5 3
$OpenBSD: patch-media_base_video_frame_cc,v 1.7 2017/01/26 17:08:26 robert Exp $
--- media/base/video_frame.cc.orig.port	Thu Mar  9 21:04:34 2017
+++ media/base/video_frame.cc	Fri Mar 10 07:46:24 2017
d48 1
a48 1
 int VideoFrame::dmabuf_fd(size_t plane) const {
@


1.7
log
@update to 56.0.2924.76
@
text
@d1 3
a3 3
$OpenBSD: patch-media_base_video_frame_cc,v 1.6 2016/12/10 15:35:25 robert Exp $
--- media/base/video_frame.cc.orig.port	Thu Dec 15 00:02:10 2016
+++ media/base/video_frame.cc	Tue Jan  3 20:30:00 2017
d22 1
a22 1
@@@@ -323,7 +323,7 @@@@ scoped_refptr<VideoFrame> VideoFrame::WrapExternalYuva
d31 1
a31 1
@@@@ -435,7 +435,7 @@@@ scoped_refptr<VideoFrame> VideoFrame::WrapVideoFrame(
d40 1
a40 1
@@@@ -720,7 +720,7 @@@@ size_t VideoFrame::shared_memory_offset() const {
@


1.6
log
@update to 55.0.2883.75; add lpr support to the system dialog while here
@
text
@d1 3
a3 3
$OpenBSD: patch-media_base_video_frame_cc,v 1.5 2016/10/26 06:22:08 robert Exp $
--- media/base/video_frame.cc.orig.port	Fri Dec  2 00:02:14 2016
+++ media/base/video_frame.cc	Fri Dec  2 17:44:55 2016
d13 1
a13 1
@@@@ -71,7 +71,7 @@@@ static std::string StorageTypeToString(
d22 1
a22 1
@@@@ -325,7 +325,7 @@@@ scoped_refptr<VideoFrame> VideoFrame::WrapExternalYuva
d31 1
a31 1
@@@@ -437,7 +437,7 @@@@ scoped_refptr<VideoFrame> VideoFrame::WrapVideoFrame(
d40 2
a41 2
@@@@ -729,7 +729,7 @@@@ VideoFrame::gpu_memory_buffer_handles() const {
   return gpu_memory_buffer_handles_;
@


1.5
log
@update to 54.0.2840.71
@
text
@d1 3
a3 3
$OpenBSD: patch-media_base_video_frame_cc,v 1.4 2016/09/01 16:28:11 robert Exp $
--- media/base/video_frame.cc.orig.port	Wed Oct 12 21:03:00 2016
+++ media/base/video_frame.cc	Wed Oct 19 12:56:06 2016
d13 1
a13 1
@@@@ -75,7 +75,7 @@@@ static std::string StorageTypeToString(
d22 1
a22 1
@@@@ -329,7 +329,7 @@@@ scoped_refptr<VideoFrame> VideoFrame::WrapExternalYuva
d31 1
a31 1
@@@@ -441,7 +441,7 @@@@ scoped_refptr<VideoFrame> VideoFrame::WrapVideoFrame(
d40 1
a40 1
@@@@ -750,7 +750,7 @@@@ VideoFrame::gpu_memory_buffer_handles() const {
@


1.4
log
@update to 53.0.2785.89
@
text
@d1 3
a3 3
$OpenBSD: patch-media_base_video_frame_cc,v 1.3 2016/07/31 13:11:44 robert Exp $
--- media/base/video_frame.cc.orig.port	Thu Sep  1 00:03:32 2016
+++ media/base/video_frame.cc	Thu Sep  1 11:12:23 2016
d40 1
a40 1
@@@@ -726,7 +726,7 @@@@ VideoFrame::gpu_memory_buffer_handles() const {
@


1.3
log
@update to 52.0.2743.82
@
text
@d1 3
a3 3
$OpenBSD: patch-media_base_video_frame_cc,v 1.2 2016/05/27 06:28:21 robert Exp $
--- media/base/video_frame.cc.orig.port	Wed Jul 20 21:03:25 2016
+++ media/base/video_frame.cc	Thu Jul 21 10:25:30 2016
d22 1
a22 1
@@@@ -287,7 +287,7 @@@@ scoped_refptr<VideoFrame> VideoFrame::WrapExternalYuvG
d31 1
a31 1
@@@@ -399,7 +399,7 @@@@ scoped_refptr<VideoFrame> VideoFrame::WrapVideoFrame(
d40 1
a40 1
@@@@ -684,7 +684,7 @@@@ VideoFrame::gpu_memory_buffer_handles() const {
@


1.2
log
@update to 51.0.2704.63
@
text
@d1 4
a4 4
$OpenBSD: patch-media_base_video_frame_cc,v 1.1 2016/04/26 14:22:24 robert Exp $
--- media/base/video_frame.cc.orig.port	Wed May 25 21:01:03 2016
+++ media/base/video_frame.cc	Thu May 26 08:09:47 2016
@@@@ -49,7 +49,7 @@@@ static std::string StorageTypeToString(
d13 1
a13 1
@@@@ -71,7 +71,7 @@@@ static std::string StorageTypeToString(
d22 1
a22 1
@@@@ -311,7 +311,7 @@@@ scoped_refptr<VideoFrame> VideoFrame::WrapExternalYuvG
d31 1
a31 1
@@@@ -427,7 +427,7 @@@@ scoped_refptr<VideoFrame> VideoFrame::WrapVideoFrame(
d40 1
a40 1
@@@@ -712,7 +712,7 @@@@ VideoFrame::gpu_memory_buffer_handles() const {
@


1.1
log
@enable webrtc support and fix video recording. the only thing
that's missing from working video conferencing is the sndio
input support, which is being worked on
@
text
@d1 4
a4 4
$OpenBSD$
--- media/base/video_frame.cc.orig.port	Mon Apr 25 18:28:58 2016
+++ media/base/video_frame.cc	Mon Apr 25 18:29:16 2016
@@@@ -60,7 +60,7 @@@@ static std::string StorageTypeToString(
d13 1
a13 1
@@@@ -87,7 +87,7 @@@@ static bool IsValidPlane(size_t plane, VideoPixelForma
d22 1
a22 1
@@@@ -416,7 +416,7 @@@@ scoped_refptr<VideoFrame> VideoFrame::WrapExternalYuvG
d31 1
a31 1
@@@@ -526,7 +526,7 @@@@ scoped_refptr<VideoFrame> VideoFrame::WrapVideoFrame(
d40 1
a40 1
@@@@ -811,7 +811,7 @@@@ VideoFrame::gpu_memory_buffer_handles() const {
@

