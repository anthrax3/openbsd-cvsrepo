head	1.4;
access;
symbols
	OPENBSD_6_1:1.2.0.2
	OPENBSD_6_1_BASE:1.2;
locks; strict;
comment	@# @;


1.4
date	2017.06.25.21.53.56;	author robert;	state Exp;
branches;
next	1.3;
commitid	l6xAjqoVop0UE8Em;

1.3
date	2017.04.28.14.21.00;	author robert;	state Exp;
branches;
next	1.2;
commitid	XFDnyB7tGNawHUbl;

1.2
date	2017.03.14.12.18.54;	author robert;	state Exp;
branches;
next	1.1;
commitid	FgEdsLreTqAdn1i5;

1.1
date	2017.01.26.17.08.26;	author robert;	state Exp;
branches;
next	;
commitid	SWz5LewWpip0ZZLw;


desc
@@


1.4
log
@update to 59.0.3071.109
@
text
@$OpenBSD: patch-net_socket_udp_socket_posix_cc,v 1.3 2017/04/28 14:21:00 robert Exp $
Index: net/socket/udp_socket_posix.cc
--- net/socket/udp_socket_posix.cc.orig
+++ net/socket/udp_socket_posix.cc
@@@@ -60,7 +60,7 @@@@ const int kBindRetries = 10;
 const int kPortStart = 1024;
 const int kPortEnd = 65535;
 
-#if defined(OS_MACOSX)
+#if defined(OS_MACOSX) || defined(OS_BSD)
 
 // Returns IPv4 address in network order.
 int GetIPv4AddressFromIndex(int socket, uint32_t index, uint32_t* address) {
@@@@ -759,7 +759,7 @@@@ int UDPSocketPosix::SetMulticastOptions() {
   if (multicast_interface_ != 0) {
     switch (addr_family_) {
       case AF_INET: {
-#if !defined(OS_MACOSX)
+#if !defined(OS_MACOSX) && !defined(OS_BSD)
         ip_mreqn mreq;
         mreq.imr_ifindex = multicast_interface_;
         mreq.imr_address.s_addr = htonl(INADDR_ANY);
@@@@ -834,7 +834,7 @@@@ int UDPSocketPosix::JoinGroup(const IPAddress& group_a
       if (addr_family_ != AF_INET)
         return ERR_ADDRESS_INVALID;
 
-#if !defined(OS_MACOSX)
+#if !defined(OS_MACOSX) && !defined(OS_BSD)
       ip_mreqn mreq;
       mreq.imr_ifindex = multicast_interface_;
       mreq.imr_address.s_addr = htonl(INADDR_ANY);
@


1.3
log
@update to 58.0.3029.81
@
text
@d1 5
a5 4
$OpenBSD: patch-net_socket_udp_socket_posix_cc,v 1.2 2017/03/14 12:18:54 robert Exp $
--- net/socket/udp_socket_posix.cc.orig.port	Wed Apr 19 21:06:36 2017
+++ net/socket/udp_socket_posix.cc	Thu Apr 27 19:56:03 2017
@@@@ -59,7 +59,7 @@@@ const int kBindRetries = 10;
d14 1
a14 1
@@@@ -765,7 +765,7 @@@@ int UDPSocketPosix::SetMulticastOptions() {
d23 1
a23 1
@@@@ -840,7 +840,7 @@@@ int UDPSocketPosix::JoinGroup(const IPAddress& group_a
@


1.2
log
@update to 57.0.2987.98
@
text
@d1 3
a3 3
$OpenBSD: patch-net_socket_udp_socket_posix_cc,v 1.1 2017/01/26 17:08:26 robert Exp $
--- net/socket/udp_socket_posix.cc.orig.port	Thu Mar  9 21:04:35 2017
+++ net/socket/udp_socket_posix.cc	Fri Mar 10 07:46:24 2017
d13 1
a13 1
@@@@ -763,7 +763,7 @@@@ int UDPSocketPosix::SetMulticastOptions() {
d22 1
a22 1
@@@@ -838,7 +838,7 @@@@ int UDPSocketPosix::JoinGroup(const IPAddress& group_a
@


1.1
log
@update to 56.0.2924.76
@
text
@d1 4
a4 4
$OpenBSD$
--- net/socket/udp_socket_posix.cc.orig.port	Tue Jan  3 20:49:16 2017
+++ net/socket/udp_socket_posix.cc	Tue Jan  3 20:49:42 2017
@@@@ -58,7 +58,7 @@@@ const int kBindRetries = 10;
d13 1
a13 1
@@@@ -762,7 +762,7 @@@@ int UDPSocketPosix::SetMulticastOptions() {
d22 1
a22 1
@@@@ -837,7 +837,7 @@@@ int UDPSocketPosix::JoinGroup(const IPAddress& group_a
@

