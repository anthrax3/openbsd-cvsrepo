head	1.3;
access;
symbols
	OPENBSD_6_1:1.2.0.2
	OPENBSD_6_1_BASE:1.2;
locks; strict;
comment	@# @;


1.3
date	2017.06.25.21.53.56;	author robert;	state Exp;
branches;
next	1.2;
commitid	l6xAjqoVop0UE8Em;

1.2
date	2017.03.14.12.18.54;	author robert;	state Exp;
branches;
next	1.1;
commitid	FgEdsLreTqAdn1i5;

1.1
date	2016.12.10.15.35.25;	author robert;	state Exp;
branches;
next	;
commitid	D24Pj03ujnweitOe;


desc
@@


1.3
log
@update to 59.0.3071.109
@
text
@$OpenBSD: patch-gpu_ipc_service_gpu_init_cc,v 1.2 2017/03/14 12:18:54 robert Exp $
Index: gpu/ipc/service/gpu_init.cc
--- gpu/ipc/service/gpu_init.cc.orig
+++ gpu/ipc/service/gpu_init.cc
@@@@ -113,7 +113,7 @@@@ void CollectGraphicsInfo(gpu::GPUInfo& gpu_info) {
 }
 #endif  // defined(OS_MACOSX)
 
-#if defined(OS_LINUX) && !defined(OS_CHROMEOS)
+#if defined(OS_LINUX) && !defined(OS_CHROMEOS) && !defined(OS_BSD)
 bool CanAccessNvidiaDeviceFile() {
   bool res = true;
   base::ThreadRestrictions::AssertIOAllowed();
@@@@ -169,7 +169,7 @@@@ bool GpuInit::InitializeAndStartSandbox(const base::Co
   // Get vendor_id, device_id, driver_version from browser process through
   // commandline switches.
   GetGpuInfoFromCommandLine(gpu_info_, command_line);
-#if defined(OS_LINUX) && !defined(OS_CHROMEOS)
+#if defined(OS_LINUX) && !defined(OS_CHROMEOS) && !defined(OS_BSD)
   if (gpu_info_.gpu.vendor_id == 0x10de &&  // NVIDIA
       gpu_info_.driver_vendor == "NVIDIA" && !CanAccessNvidiaDeviceFile())
     return false;
@@@@ -181,7 +181,7 @@@@ bool GpuInit::InitializeAndStartSandbox(const base::Co
 
   sandbox_helper_->PreSandboxStartup();
 
-#if defined(OS_LINUX)
+#if defined(OS_LINUX) || defined(OS_BSD)
   // On Chrome OS ARM Mali, GPU driver userspace creates threads when
   // initializing a GL context, so start the sandbox early.
   if (command_line.HasSwitch(switches::kGpuSandboxStartEarly))
@


1.2
log
@update to 57.0.2987.98
@
text
@d1 5
a5 4
$OpenBSD: patch-gpu_ipc_service_gpu_init_cc,v 1.1 2016/12/10 15:35:25 robert Exp $
--- gpu/ipc/service/gpu_init.cc.orig.port	Thu Mar  9 21:04:33 2017
+++ gpu/ipc/service/gpu_init.cc	Fri Mar 10 07:46:24 2017
@@@@ -97,7 +97,7 @@@@ void CollectGraphicsInfo(gpu::GPUInfo& gpu_info) {
d14 1
a14 1
@@@@ -153,7 +153,7 @@@@ bool GpuInit::InitializeAndStartSandbox(const base::Co
d23 1
a23 1
@@@@ -165,7 +165,7 @@@@ bool GpuInit::InitializeAndStartSandbox(const base::Co
@


1.1
log
@update to 55.0.2883.75; add lpr support to the system dialog while here
@
text
@d1 4
a4 4
$OpenBSD$
--- gpu/ipc/service/gpu_init.cc.orig.port	Sat Dec  3 11:24:12 2016
+++ gpu/ipc/service/gpu_init.cc	Sat Dec  3 11:24:56 2016
@@@@ -96,7 +96,7 @@@@ void CollectGraphicsInfo(gpu::GPUInfo& gpu_info) {
d13 1
a13 1
@@@@ -151,7 +151,7 @@@@ bool GpuInit::InitializeAndStartSandbox(const base::Co
d22 1
a22 1
@@@@ -160,7 +160,7 @@@@ bool GpuInit::InitializeAndStartSandbox(const base::Co
@

