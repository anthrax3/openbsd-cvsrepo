head	1.1;
access;
symbols
	OPENBSD_4_0:1.1.0.4
	OPENBSD_4_1:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2007.06.17.07.54.58;	author sturm;	state dead;
branches
	1.1.2.1
	1.1.4.1;
next	;

1.1.2.1
date	2007.06.17.07.54.58;	author sturm;	state Exp;
branches;
next	;

1.1.4.1
date	2007.06.17.07.55.53;	author sturm;	state Exp;
branches;
next	;


desc
@@


1.1
log
@file patch-main_streams_filter_c was initially added on branch OPENBSD_4_1.
@
text
@@


1.1.4.1
log
@assorted security patches, from debian
@
text
@a0 13
$OpenBSD$
--- main/streams/filter.c.orig	Fri May 19 12:24:19 2006
+++ main/streams/filter.c	Sun Jun 10 16:14:06 2007
@@@@ -264,7 +264,8 @@@@ PHPAPI php_stream_filter *php_stream_fil
 		/* try a wildcard */
 		char *wildname;
 
-		wildname = estrdup(filtername);
+		wildname = emalloc(n+3);
+		memcpy(wildname, filtername, n+1);
 		period = wildname + (period - filtername);
 		while (period && !filter) {
 			*period = '\0';
@


1.1.2.1
log
@assorted security patches, from debian
@
text
@a0 13
$OpenBSD$
--- main/streams/filter.c.orig	Fri May 19 12:24:19 2006
+++ main/streams/filter.c	Sun Jun 10 16:14:06 2007
@@@@ -264,7 +264,8 @@@@ PHPAPI php_stream_filter *php_stream_fil
 		/* try a wildcard */
 		char *wildname;
 
-		wildname = estrdup(filtername);
+		wildname = emalloc(n+3);
+		memcpy(wildname, filtername, n+1);
 		period = wildname + (period - filtername);
 		while (period && !filter) {
 			*period = '\0';
@

