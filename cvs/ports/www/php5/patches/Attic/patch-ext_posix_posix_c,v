head	1.3;
access;
symbols;
locks; strict;
comment	@# @;


1.3
date	2007.05.11.15.05.15;	author robert;	state dead;
branches;
next	1.2;

1.2
date	2007.04.01.21.37.27;	author robert;	state Exp;
branches;
next	1.1;

1.1
date	2007.03.22.22.43.20;	author robert;	state Exp;
branches;
next	;


desc
@@


1.3
log
@update to version 5.2.2;
fixes many vulnerabilities http://www.php.net/ChangeLog-5.php#5.2.2

from Lawrence Teo <lteo.openbsd1@@calyptix.com>;
@
text
@$OpenBSD: patch-ext_posix_posix_c,v 1.2 2007/04/01 21:37:27 robert Exp $
--- ext/posix/posix.c.orig	Fri Jan 12 02:46:11 2007
+++ ext/posix/posix.c	Sun Apr  1 13:42:42 2007
@@@@ -884,7 +884,7 @@@@ PHP_FUNCTION(posix_getgrgid)
 	if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, "l", &gid) == FAILURE) {
 		RETURN_FALSE;
 	}
-#ifdef HAVE_GETGRGID_R
+#if defined(ZTS) && defined(HAVE_GETGRGID_R) && defined(_SC_GETGR_R_SIZE_MAX)
 	
 	grbuflen = sysconf(_SC_GETGR_R_SIZE_MAX);
 	grbuf = emalloc(grbuflen);
@@@@ -909,7 +909,7 @@@@ PHP_FUNCTION(posix_getgrgid)
 		php_error_docref(NULL TSRMLS_CC, E_WARNING, "unable to convert posix group struct to array");
 		RETVAL_FALSE;
 	}
-#ifdef HAVE_GETGRGID_R
+#if defined(ZTS) && defined(HAVE_GETGRGID_R) && defined(_SC_GETGR_R_SIZE_MAX)
 	efree(grbuf);
 #endif
 }
@


1.2
log
@- add a fastcgi subpackage to core because now we are able to build
more than one php binaries within one workdir (idea from FreeBSD)
- move pdo_sqlite support from core to extensions and also add a pdo_mysql
and a pdo_sqlite subpackage
- regen patches while here
- bump PKGNAMEs
@
text
@d1 1
a1 1
$OpenBSD: patch-ext_posix_posix_c,v 1.1 2007/03/22 22:43:20 robert Exp $
@


1.1
log
@- update to php 5.2.1 and suhosin 0.9.2.6
- remove the pear subpackage as it is now replaced with www/pear
- the filepro extension is no longer available

tested by a couple of people
@
text
@d1 4
a4 4
$OpenBSD$
--- ext/posix/posix.c.orig	Tue Mar 20 00:38:18 2007
+++ ext/posix/posix.c	Tue Mar 20 00:39:48 2007
@@@@ -884,7 +884,7 @@@@
d13 1
a13 1
@@@@ -909,7 +909,7 @@@@
@

