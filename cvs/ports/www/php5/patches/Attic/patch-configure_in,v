head	1.15;
access;
symbols
	OPENBSD_4_9:1.13.0.2
	OPENBSD_4_9_BASE:1.13
	OPENBSD_4_8:1.12.0.8
	OPENBSD_4_8_BASE:1.12
	OPENBSD_4_7:1.12.0.6
	OPENBSD_4_7_BASE:1.12
	OPENBSD_4_6:1.12.0.4
	OPENBSD_4_6_BASE:1.12
	OPENBSD_4_5:1.12.0.2
	OPENBSD_4_5_BASE:1.12
	OPENBSD_4_4:1.11.0.2
	OPENBSD_4_4_BASE:1.11
	OPENBSD_4_3:1.10.0.2
	OPENBSD_4_3_BASE:1.10
	OPENBSD_4_2:1.9.0.2
	OPENBSD_4_2_BASE:1.9
	OPENBSD_4_1:1.5.0.4
	OPENBSD_4_1_BASE:1.5
	OPENBSD_4_0:1.5.0.2
	OPENBSD_4_0_BASE:1.5
	OPENBSD_3_9:1.4.0.2
	OPENBSD_3_9_BASE:1.4
	OPENBSD_3_8:1.2.0.2
	OPENBSD_3_8_BASE:1.2
	OPENBSD_3_7:1.1.1.1.0.2
	OPENBSD_3_7_BASE:1.1.1.1
	robert_20041002:1.1.1.1
	robert:1.1.1;
locks; strict;
comment	@# @;


1.15
date	2011.07.09.00.28.54;	author robert;	state dead;
branches;
next	1.14;

1.14
date	2011.06.18.19.49.22;	author sthen;	state Exp;
branches;
next	1.13;

1.13
date	2011.01.03.15.03.03;	author robert;	state Exp;
branches;
next	1.12;

1.12
date	2008.12.09.21.52.31;	author robert;	state Exp;
branches;
next	1.11;

1.11
date	2008.04.05.05.45.19;	author sturm;	state Exp;
branches;
next	1.10;

1.10
date	2007.09.05.09.11.34;	author robert;	state Exp;
branches;
next	1.9;

1.9
date	2007.07.02.08.53.17;	author robert;	state Exp;
branches;
next	1.8;

1.8
date	2007.05.11.15.05.15;	author robert;	state Exp;
branches;
next	1.7;

1.7
date	2007.04.03.12.17.34;	author robert;	state Exp;
branches;
next	1.6;

1.6
date	2007.04.01.21.37.27;	author robert;	state Exp;
branches;
next	1.5;

1.5
date	2006.05.09.14.15.40;	author robert;	state Exp;
branches
	1.5.2.1
	1.5.4.1;
next	1.4;

1.4
date	2005.12.29.23.07.19;	author sturm;	state Exp;
branches;
next	1.3;

1.3
date	2005.12.21.15.42.06;	author robert;	state Exp;
branches;
next	1.2;

1.2
date	2005.04.04.21.13.22;	author robert;	state Exp;
branches;
next	1.1;

1.1
date	2004.10.02.11.32.37;	author robert;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2004.10.02.11.32.37;	author robert;	state Exp;
branches
	1.1.1.1.2.1;
next	;

1.1.1.1.2.1
date	2005.05.23.20.20.08;	author robert;	state Exp;
branches;
next	;

1.5.2.1
date	2007.06.17.07.55.52;	author sturm;	state Exp;
branches;
next	;

1.5.4.1
date	2007.06.17.07.54.58;	author sturm;	state Exp;
branches;
next	;


desc
@@


1.15
log
@bye bye
@
text
@$OpenBSD: patch-configure_in,v 1.14 2011/06/18 19:49:22 sthen Exp $
--- configure.in.orig.port	Sat Jun 18 12:14:51 2011
+++ configure.in	Sat Jun 18 12:17:02 2011
@@@@ -352,8 +352,8 @@@@ AC_CHECK_LIB(m, sin)
 
 dnl Check for resolver routines.
 dnl Need to check for both res_search and __res_search
-dnl in -lc, -lbind, -lresolv and -lsocket
-PHP_CHECK_FUNC(res_search, resolv, bind, socket)
+dnl in -lc, -lresolv and -lsocket
+PHP_CHECK_FUNC(res_search, resolv, socket)
 
 dnl Check for inet_aton and dn_skipname
 dnl in -lc, -lbind and -lresolv
@@@@ -940,7 +940,7 @@@@ enable_static=yes
 
 case $php_build_target in
   program|static)
-    standard_libtool_flag='-prefer-non-pic -static'
+    standard_libtool_flag=''
     if test -z "$PHP_MODULES" && test -z "$PHP_ZEND_EX"; then
         enable_shared=no
     fi
@@@@ -949,10 +949,10 @@@@ case $php_build_target in
     enable_static=no
     case $with_pic in
       yes)
-        standard_libtool_flag='-prefer-pic'
+        standard_libtool_flag=''
         ;;
       no)
-        standard_libtool_flag='-prefer-non-pic'
+        standard_libtool_flag=''
         ;;
     esac
     EXTRA_LDFLAGS="$EXTRA_LDFLAGS -avoid-version -module"
@@@@ -1146,7 +1146,7 @@@@ EXPANDED_SYSCONFDIR=`eval echo $sysconfdir`
 EXPANDED_DATADIR=$datadir
 EXPANDED_PHP_CONFIG_FILE_PATH=`eval echo "$PHP_CONFIG_FILE_PATH"`
 EXPANDED_PHP_CONFIG_FILE_SCAN_DIR=`eval echo "$PHP_CONFIG_FILE_SCAN_DIR"`
-INCLUDE_PATH=.:$EXPANDED_PEAR_INSTALLDIR
+INCLUDE_PATH=.:$libdir
 
 exec_prefix=$old_exec_prefix
 libdir=$old_libdir
@@@@ -1357,7 +1357,8 @@@@ CFLAGS="\$(CFLAGS_CLEAN) $standard_libtool_flag"
 INLINE_CFLAGS="$INLINE_CFLAGS $standard_libtool_flag"
 CXXFLAGS="$CXXFLAGS $standard_libtool_flag"
 
-all_targets="$lcov_target \$(OVERALL_TARGET) \$(PHP_MODULES) \$(PHP_ZEND_EX) \$(PHP_CLI_TARGET)"
+all_targets="$lcov_target \$(OVERALL_TARGET) \$(PHP_MODULES) \$(PHP_CLI_TARGET) \$(PHP_CGI_TARGET)"
+
 install_targets="$install_modules install-build install-headers install-programs $install_pear"
 
 case $PHP_SAPI in
@@@@ -1401,7 +1402,7 @@@@ esac
 PHP_ADD_SOURCES(Zend, \
     zend_language_parser.c zend_language_scanner.c \
     zend_ini_parser.c zend_ini_scanner.c \
-    zend_alloc.c zend_compile.c zend_constants.c zend_dynamic_array.c \
+    zend_compile.c zend_constants.c zend_dynamic_array.c \
     zend_execute_API.c zend_highlight.c zend_llist.c \
     zend_opcode.c zend_operators.c zend_ptr_stack.c zend_stack.c \
     zend_variables.c zend.c zend_API.c zend_extensions.c zend_hash.c \
@@@@ -1422,6 +1423,7 @@@@ else
 fi
 
 PHP_ADD_SOURCES_X(Zend, zend_execute.c,,PHP_GLOBAL_OBJS,,$flag)
+PHP_ADD_SOURCES_X(Zend, zend_alloc.c,,PHP_GLOBAL_OBJS,,"-O0")
 
 PHP_ADD_BUILD_DIR(main main/streams)
 PHP_ADD_BUILD_DIR(regex)
@


1.14
log
@Use PATCHORIG, regen patches and rename the files which didn't match the
normal update-patches filenames. This avoids update-patches picking up the
.orig files in PHP distfiles and make it easier to keep in-sync. ok robert@@
@
text
@d1 1
a1 1
$OpenBSD$
@


1.13
log
@Update to 5.2.16
@
text
@d1 3
a3 2
--- configure.in.orig	Mon Jan  3 14:34:43 2011
+++ configure.in	Mon Jan  3 14:34:45 2011
@


1.12
log
@update to php-5.2.8 and fix the no_suhosin flavor
@
text
@d1 3
a3 3
--- configure.in.orig	Tue Dec  9 22:04:42 2008
+++ configure.in	Tue Dec  9 22:07:03 2008
@@@@ -354,8 +354,8 @@@@
d14 1
a14 1
@@@@ -931,7 +931,7 @@@@
d23 1
a23 1
@@@@ -940,10 +940,10 @@@@
d36 1
a36 1
@@@@ -1136,7 +1136,7 @@@@
d45 1
a45 1
@@@@ -1344,7 +1344,8 @@@@
d55 1
a55 1
@@@@ -1388,7 +1389,7 @@@@
d64 1
a64 1
@@@@ -1409,6 +1410,7 @@@@
@


1.11
log
@unbreak build if libbind happens to be installed by not pulling it in

from brad@@, w/o objections from robert@@ (maintainer)
@
text
@d1 14
a14 23
$OpenBSD: patch-configure_in,v 1.10 2007/09/05 09:11:34 robert Exp $
--- configure.in.orig	Wed Sep  5 10:38:41 2007
+++ configure.in	Wed Sep  5 10:39:20 2007
+@@@@ -325,13 +325,13 @@@@ AC_CHECK_LIB(m, sin)
+
+ dnl Check for resolver routines.
+ dnl Need to check for both res_search and __res_search
+-dnl in -lc, -lbind, -lresolv and -lsocket
+-PHP_CHECK_FUNC(res_search, resolv, bind, socket)
++dnl in -lc, -lresolv and -lsocket
++PHP_CHECK_FUNC(res_search, resolv, socket)
+
+ dnl Check for inet_aton and dn_skipname
+-dnl in -lc, -lbind and -lresolv
+-PHP_CHECK_FUNC(inet_aton, resolv, bind)
+-PHP_CHECK_FUNC(dn_skipname, resolv, bind)
++dnl in -lc and -lresolv
++PHP_CHECK_FUNC(inet_aton, resolv)
++PHP_CHECK_FUNC(dn_skipname, resolv)
+
+
+ dnl Then headers.
@@@@ -893,7 +893,7 @@@@ enable_static=yes
d17 1
a17 1
 program|static)
d20 1
a20 1
     if test -z "$PHP_MODULES"; then
d23 1
a23 2
@@@@ -901,8 +901,8 @@@@ program|static)
 shared)
d26 8
a33 4
-      yes) standard_libtool_flag='-prefer-pic';;
-      no)  standard_libtool_flag='-prefer-non-pic';;
+      yes) standard_libtool_flag='';;
+      no)  standard_libtool_flag='';;
d36 1
a36 2
 ;;
@@@@ -1095,7 +1095,7 @@@@ EXPANDED_SYSCONFDIR=`eval echo $sysconfdir`
d45 1
a45 1
@@@@ -1278,7 +1278,7 @@@@ CFLAGS="\$(CFLAGS_CLEAN) $standard_libtool_flag"
d49 1
a49 1
-all_targets="$lcov_target \$(OVERALL_TARGET) \$(PHP_MODULES) \$(PHP_CLI_TARGET)"
d51 1
d55 1
a55 1
@@@@ -1322,7 +1322,7 @@@@ esac
d64 1
a64 1
@@@@ -1344,6 +1344,7 @@@@ else
@


1.10
log
@update to version 5.2.4 and remove some obsolete CONFIGURE_ARGS;
@
text
@d1 1
a1 1
$OpenBSD: patch-configure_in,v 1.9 2007/07/02 08:53:17 robert Exp $
d4 19
@


1.9
log
@update to version 5.2.3;
fixes many vulnerabilities just as usual. for more information
read http://www.php.net/releases/5_2_3.php

add a no_suhosin pseudo-flavor because horde has some problems
with the suhosin security patchset
@
text
@d1 4
a4 4
$OpenBSD$
--- configure.in.orig	Mon Jul  2 10:34:20 2007
+++ configure.in	Mon Jul  2 10:34:35 2007
@@@@ -921,7 +921,7 @@@@ enable_static=yes
d13 1
a13 1
@@@@ -929,8 +929,8 @@@@ program|static)
d24 1
a24 1
@@@@ -1123,7 +1123,7 @@@@ EXPANDED_SYSCONFDIR=`eval echo $sysconfdir`
d33 1
a33 1
@@@@ -1295,7 +1295,7 @@@@ CFLAGS="\$(CFLAGS_CLEAN) $standard_libtool_flag"
d42 1
a42 1
@@@@ -1339,7 +1339,7 @@@@ esac
d51 1
a51 1
@@@@ -1361,6 +1361,7 @@@@ else
@


1.8
log
@update to version 5.2.2;
fixes many vulnerabilities http://www.php.net/ChangeLog-5.php#5.2.2

from Lawrence Teo <lteo.openbsd1@@calyptix.com>;
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.7 2007/04/03 12:17:34 robert Exp $
--- configure.in.orig	Wed Feb  7 01:45:04 2007
+++ configure.in	Tue Apr  3 12:14:04 2007
@@@@ -918,7 +918,7 @@@@ enable_static=yes
d13 1
a13 1
@@@@ -934,8 +934,8 @@@@ program|static)
d24 1
a24 1
@@@@ -1128,7 +1128,7 @@@@ EXPANDED_SYSCONFDIR=`eval echo $sysconfdir`
d33 1
a33 1
@@@@ -1300,7 +1300,7 @@@@ CFLAGS="\$(CFLAGS_CLEAN) $standard_libtool_flag"
d42 1
a42 3
@@@@ -1348,7 +1348,7 @@@@ PHP_ADD_SOURCES(/Zend, zend_language_parser.c zend_lan
     zend_ini_parser.c zend_ini_scanner.c)
 
d44 2
d51 1
a51 1
@@@@ -1370,6 +1370,7 @@@@ else
@


1.7
log
@compile zend_alloc.c with -O0 to prevent a compiler bug on sparc64
and regen patches while here; bump PKGNAMEs
@
text
@d1 1
a1 1
$OpenBSD: patch-configure_in,v 1.6 2007/04/01 21:37:27 robert Exp $
d13 1
a13 1
@@@@ -926,8 +926,8 @@@@ program|static)
d24 1
a24 1
@@@@ -1120,7 +1120,7 @@@@ EXPANDED_SYSCONFDIR=`eval echo $sysconfdir`
d33 1
a33 1
@@@@ -1292,7 +1292,7 @@@@ CFLAGS="\$(CFLAGS_CLEAN) $standard_libtool_flag"
d42 1
a42 1
@@@@ -1340,7 +1340,7 @@@@ PHP_ADD_SOURCES(/Zend, zend_language_parser.c zend_lan
d51 1
a51 1
@@@@ -1362,6 +1362,7 @@@@ else
@


1.6
log
@- add a fastcgi subpackage to core because now we are able to build
more than one php binaries within one workdir (idea from FreeBSD)
- move pdo_sqlite support from core to extensions and also add a pdo_mysql
and a pdo_sqlite subpackage
- regen patches while here
- bump PKGNAMEs
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.5 2006/05/09 14:15:40 robert Exp $
--- configure.in.orig	Sun Apr  1 15:15:11 2007
+++ configure.in	Sun Apr  1 15:18:07 2007
@@@@ -919,7 +919,7 @@@@ enable_static=yes
d13 1
a13 1
@@@@ -927,8 +927,8 @@@@ program|static)
d24 1
a24 1
@@@@ -1121,7 +1121,7 @@@@ EXPANDED_SYSCONFDIR=`eval echo $sysconfdir`
d33 1
a33 1
@@@@ -1293,7 +1293,7 @@@@ CFLAGS="\$(CFLAGS_CLEAN) $standard_libtool_flag"
d42 17
@


1.5
log
@Update to version 5.1.4;

Add a hardened flavor for both core and extensions (inspired by niallo@@);
Use our own way to install pear because the bundled installer is totally
broken and upstream refuses to fix it.

Add a mysqli subpackage which can be used to access the functionality
provided by MySQL 4.1 and above.

Other minor changes and fixes are also included.

ok sturm@@; tested by many
@
text
@d1 4
a4 4
$OpenBSD$
--- configure.in.orig	Tue Nov 29 16:01:38 2005
+++ configure.in	Tue Nov 29 16:02:41 2005
@@@@ -816,7 +816,7 @@@@
d13 1
a13 1
@@@@ -824,8 +824,8 @@@@
d24 1
a24 1
@@@@ -1009,7 +1009,7 @@@@
d33 9
@


1.5.2.1
log
@assorted security patches, from debian
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.5 2006/05/09 14:15:40 robert Exp $
--- configure.in.orig	Thu May  4 01:30:02 2006
+++ configure.in	Sun Jun 10 19:33:53 2007
@@@@ -885,7 +885,7 @@@@ enable_static=yes
d13 1
a13 1
@@@@ -893,8 +893,8 @@@@ program|static)
d24 1
a24 1
@@@@ -1078,7 +1078,7 @@@@ EXPANDED_SYSCONFDIR=`eval echo $sysconfd
@


1.5.4.1
log
@assorted security patches, from debian
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.5 2006/05/09 14:15:40 robert Exp $
--- configure.in.orig	Sun Jun 10 18:10:52 2007
+++ configure.in	Sun Jun 10 18:11:14 2007
@@@@ -886,7 +886,7 @@@@ enable_static=yes
d13 1
a13 1
@@@@ -894,8 +894,8 @@@@ program|static)
d24 1
a24 1
@@@@ -1079,7 +1079,7 @@@@ EXPANDED_SYSCONFDIR=`eval echo $sysconfd
@


1.4
log
@more
@
text
@d1 4
a4 15
$OpenBSD: patch-configure_in,v 1.2 2005/04/04 21:13:22 robert Exp $
--- configure.in.orig	Wed Mar 30 23:43:12 2005
+++ configure.in	Sun Apr  3 12:37:35 2005
@@@@ -31,9 +31,7 @@@@
 AC_INIT(README.CVS-RULES)
 
 PHP_CONFIG_NICE(config.nice)
-for arg in $0 "$@@"; do
-  CONFIGURE_COMMAND="$CONFIGURE_COMMAND '$arg'"
-done
+CONFIGURE_COMMAND="Built via the OpenBSD Ports Tree"
 
 PHP_CANONICAL_HOST
 AC_CONFIG_HEADER(main/php_config.h)
@@@@ -876,7 +874,7 @@@@
d9 1
a9 1
+    standard_libtool_flag='-static'
d13 1
a13 1
@@@@ -884,8 +882,8 @@@@
d24 1
a24 1
@@@@ -1070,7 +1068,7 @@@@
@


1.3
log
@Update to php-5.1.1;
for more information please check
http://www.php.net/ChangeLog-5.php#5.1.1
and
http://www.php.net/ChangeLog-5.php#5.1.0

The port now uses a CVS snapshot of PEAR;
@
text
@d1 15
a15 4
$OpenBSD$
--- configure.in.orig	Tue Nov 29 16:01:38 2005
+++ configure.in	Tue Nov 29 16:02:41 2005
@@@@ -816,7 +816,7 @@@@
d20 1
a20 1
+    standard_libtool_flag=''
d24 1
a24 1
@@@@ -824,8 +824,8 @@@@
d35 1
a35 1
@@@@ -1009,7 +1009,7 @@@@
@


1.2
log
@update to 5.0.4;
@
text
@d2 3
a4 14
--- configure.in.orig	Wed Mar 30 23:43:12 2005
+++ configure.in	Sun Apr  3 12:37:35 2005
@@@@ -31,9 +31,7 @@@@
 AC_INIT(README.CVS-RULES)
 
 PHP_CONFIG_NICE(config.nice)
-for arg in $0 "$@@"; do
-  CONFIGURE_COMMAND="$CONFIGURE_COMMAND '$arg'"
-done
+CONFIGURE_COMMAND="Built via the OpenBSD Ports Tree"
 
 PHP_CANONICAL_HOST
 AC_CONFIG_HEADER(main/php_config.h)
@@@@ -876,7 +874,7 @@@@
d9 1
a9 1
+    standard_libtool_flag='-static'
d13 1
a13 1
@@@@ -884,8 +882,8 @@@@
d24 1
a24 1
@@@@ -1070,7 +1068,7 @@@@
@


1.1
log
@Initial revision
@
text
@d2 2
a3 2
--- configure.in.orig	Mon Jul 26 23:07:27 2004
+++ configure.in	Mon Jul 26 23:08:27 2004
d13 1
a13 1
 AC_CANONICAL_HOST
d15 1
a15 1
@@@@ -830,14 +828,14 @@@@
d24 1
a24 1
 ;;
d27 6
a32 2
-    standard_libtool_flag=-prefer-pic
+    standard_libtool_flag=
d35 1
a35 2
 esac
@@@@ -1019,7 +1017,7 @@@@
@


1.1.1.1
log
@Import php-5.0.2;

PHP5 is a widely-used general-purpose scripting language 
that is especially suited for Web development and can be 
embedded into HTML. 
@
text
@@


1.1.1.1.2.1
log
@SECURITY: update to 5.0.4
fixes multiple vulnerabilities
http://www.vuxml.org/openbsd/7612fe54-b00c-11d9-9c1d-00065bd5b0b6.html

ok brad@@
@
text
@d2 2
a3 2
--- configure.in.orig	Wed Mar 30 23:43:12 2005
+++ configure.in	Sun Apr  3 12:37:35 2005
d13 1
a13 1
 PHP_CANONICAL_HOST
d15 1
a15 1
@@@@ -876,7 +874,7 @@@@
d24 1
a24 1
@@@@ -884,8 +882,8 @@@@
d27 2
a28 6
     case $with_pic in
-      yes) standard_libtool_flag='-prefer-pic';;
-      no)  standard_libtool_flag='-prefer-non-pic';;
+      yes) standard_libtool_flag='';;
+      no)  standard_libtool_flag='';;
     esac
d31 2
a32 1
@@@@ -1070,7 +1068,7 @@@@
@

