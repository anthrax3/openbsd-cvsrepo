head	1.3;
access;
symbols
	OPENBSD_6_2:1.3.0.2
	OPENBSD_6_2_BASE:1.3
	OPENBSD_6_1:1.1.0.2
	OPENBSD_6_1_BASE:1.1;
locks; strict;
comment	@# @;


1.3
date	2017.04.28.22.22.36;	author robert;	state Exp;
branches;
next	1.2;
commitid	hEiDsbcK5ON7rnmo;

1.2
date	2017.04.19.05.16.46;	author robert;	state Exp;
branches;
next	1.1;
commitid	jpW2BiKwA9H7U7d6;

1.1
date	2016.10.27.18.30.40;	author robert;	state Exp;
branches;
next	;
commitid	lED1Oks5HVh03mCa;


desc
@@


1.3
log
@update to 58.0
@
text
@$OpenBSD: patch-base_trace_event_malloc_dump_provider_cc,v 1.6 2017/04/28 14:21:00 robert Exp $
--- base/trace_event/malloc_dump_provider.cc.orig.port	Wed Apr 19 21:06:28 2017
+++ base/trace_event/malloc_dump_provider.cc	Thu Apr 27 19:55:58 2017
@@@@ -20,6 +20,8 @@@@
 
 #if defined(OS_MACOSX)
 #include <malloc/malloc.h>
+#elif defined(OS_BSD)
+#include <stdlib.h>
 #else
 #include <malloc.h>
 #endif
@@@@ -234,6 +236,9 @@@@ bool MallocDumpProvider::OnMemoryDump(const MemoryDump
   resident_size = main_heap_info.committed_size;
   allocated_objects_size = main_heap_info.allocated_size;
   allocated_objects_count = main_heap_info.block_count;
+#elif defined(OS_BSD)
+  total_virtual_size = 0;
+  allocated_objects_size = 0;
 #else
   struct mallinfo info = mallinfo();
   DCHECK_GE(info.arena + info.hblkhd, info.uordblks);
@


1.2
log
@update to 57.0
@
text
@d1 3
a3 3
$OpenBSD: patch-base_trace_event_malloc_dump_provider_cc,v 1.5 2017/03/14 12:18:53 robert Exp $
--- base/trace_event/malloc_dump_provider.cc.orig.port	Fri Mar 10 08:38:26 2017
+++ base/trace_event/malloc_dump_provider.cc	Fri Mar 10 08:39:07 2017
d13 1
a13 1
@@@@ -187,6 +189,9 @@@@ bool MallocDumpProvider::OnMemoryDump(const MemoryDump
@


1.1
log
@update to 54.0
@
text
@d1 4
a4 4
$OpenBSD: patch-base_trace_event_malloc_dump_provider_cc,v 1.2 2016/10/26 06:22:07 robert Exp $
--- base/trace_event/malloc_dump_provider.cc.orig.port	Wed Oct 19 13:24:08 2016
+++ base/trace_event/malloc_dump_provider.cc	Wed Oct 19 13:25:19 2016
@@@@ -19,6 +19,8 @@@@
d13 4
a16 4
@@@@ -224,6 +226,9 @@@@ bool MallocDumpProvider::OnMemoryDump(const MemoryDump
   resident_size = all_heap_info.committed_size;
   allocated_objects_size = all_heap_info.allocated_size;
   allocated_objects_count = all_heap_info.block_count;
@

