head	1.2;
access;
symbols;
locks; strict;
comment	@# @;


1.2
date	2015.06.07.16.00.38;	author robert;	state dead;
branches;
next	1.1;
commitid	CkhQ471W2ygWkRcA;

1.1
date	2015.06.03.16.00.01;	author robert;	state Exp;
branches;
next	;
commitid	xNbJSvhV0D7pjxeU;


desc
@@


1.2
log
@update to 43.3
@
text
@$OpenBSD: patch-components_update_client_update_checker_cc,v 1.1 2015/06/03 16:00:01 robert Exp $
--- components/update_client/update_checker.cc.orig.port	Wed Jun  3 17:43:07 2015
+++ components/update_client/update_checker.cc	Wed Jun  3 17:43:17 2015
@@@@ -131,13 +131,20 @@@@ bool UpdateCheckerImpl::CheckForUpdates(
 
 void UpdateCheckerImpl::OnRequestSenderComplete(const net::URLFetcher* source) {
   DCHECK(thread_checker_.CalledOnValidThread());
-
-  const GURL original_url(source->GetOriginalURL());
-  VLOG(1) << "Update check request went to: " << original_url.spec();
-
   int error = 0;
   std::string error_message;
   UpdateResponse update_response;
+  if (source == NULL) {
+    VLOG(1) << "Update request disabled";
+    request_sender_.reset();
+    const GURL tmp_url;
+    update_check_callback_.Run(tmp_url, error, error_message,
+                               update_response.results());
+    return;
+  }
+
+  const GURL original_url(source->GetOriginalURL());
+  VLOG(1) << "Update check request went to: " << original_url.spec();
 
   if (FetchSuccess(*source)) {
     std::string xml;
@


1.1
log
@add a patch to avoid a crash on startup
@
text
@d1 1
a1 1
$OpenBSD$
@

