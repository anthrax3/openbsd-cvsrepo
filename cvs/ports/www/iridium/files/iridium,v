head	1.2;
access;
symbols
	OPENBSD_6_0:1.2.0.4
	OPENBSD_6_0_BASE:1.2
	OPENBSD_5_9:1.2.0.2
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.1.1.1.0.4
	OPENBSD_5_8_BASE:1.1.1.1
	robert_20150503:1.1.1.1
	robert:1.1.1;
locks; strict;
comment	@# @;


1.2
date	2015.08.12.10.56.13;	author robert;	state Exp;
branches;
next	1.1;
commitid	WokHnx1ONPqT4wiW;

1.1
date	2015.05.03.15.35.35;	author robert;	state Exp;
branches
	1.1.1.1;
next	;
commitid	O1GeKHU5BcsYea8a;

1.1.1.1
date	2015.05.03.15.35.35;	author robert;	state Exp;
branches;
next	;
commitid	O1GeKHU5BcsYea8a;


desc
@@


1.2
log
@update to iridium-44.0 and also incorporate a patch from dcoppa@@
for the startup script that still had references to chromium directories.
@
text
@#!/bin/sh
# $OpenBSD: iridium,v 1.1.1.1 2015/05/03 15:35:35 robert Exp $

DATASIZE="716800"
OPENFILES="400"

xm_log() {
	echo -n "$@@\nDo you want to run Iridium anyway?\n\
(If you don't increase these limits, Iridium might fail to work properly.)" | \
		${X11BASE}/bin/xmessage -file - -center -buttons yes:0,no:1 -default no
}

if [ $(ulimit -Sd) -lt ${DATASIZE} ]; then
	ulimit -Sd ${DATASIZE} || \
		xm_log "Cannot increase datasize-cur to at least ${DATASIZE}"
		[ $? -eq 0 ] || exit
fi

if [ $(ulimit -Sn) -lt ${OPENFILES} ]; then
	ulimit -Sn ${OPENFILES} || \
		xm_log "Cannot increase openfiles-cur to at least ${OPENFILES}"
		[ $? -eq 0 ] || exit
fi

#
# Temporary workaround for the case when iridium crashes and leaves
# the SingletonLock, which prevents iridium to start up.
#
if [ -h ${HOME}/.config/iridium/SingletonLock ]; then
	_pid=`readlink ${HOME}/.config/iridium/SingletonLock | cut -d '-' -f 2`
	kill -0 ${_pid} 2>/dev/null
	if [ $? -gt 0 ]; then
		rm ${HOME}/.config/iridium/SingletonLock
	fi
fi

#
# Issue #395446
# https://code.google.com/p/chromium/issues/detail?id=395446
#
[ -z ${LANG} ] && _l=en_US.UTF-8 || _l=${LANG}

LANG=${_l} exec "/usr/local/iridium/iridium" "${@@}"
@


1.1
log
@Initial revision
@
text
@d2 1
a2 1
# $OpenBSD: chrome,v 1.13 2015/02/22 11:33:57 robert Exp $
d26 2
a27 2
# Temporary workaround for the case when chromium crashes and leaves
# the SingletonLock, which prevents chromium to start up.
d29 2
a30 2
if [ -h ${HOME}/.config/chromium/SingletonLock ]; then
	_pid=`readlink ${HOME}/.config/chromium/SingletonLock | cut -d '-' -f 2`
d33 1
a33 1
		rm ${HOME}/.config/chromium/SingletonLock
@


1.1.1.1
log
@import of iridium-41.2:

Iridium is a free, open, and libre browser modification of the Chromium code base,
with privacy being enhanced in several key areas.
Automatic transmission of partial queries, keywords, metrics to central services
inhibited and only occurs with consent.
In addition, all our builds are reproducible, and modifications are auditable,
setting the project ahead of other secure browser providers.

For more information, visit: https://iridiumbrowser.de/about

ok ajacoutot@@
@
text
@@
