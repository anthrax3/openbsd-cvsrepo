head	1.24;
access;
symbols
	OPENBSD_6_1:1.24.0.4
	OPENBSD_6_1_BASE:1.24
	OPENBSD_6_0:1.24.0.2
	OPENBSD_6_0_BASE:1.24
	OPENBSD_5_9:1.21.0.2
	OPENBSD_5_9_BASE:1.21
	OPENBSD_5_8:1.20.0.4
	OPENBSD_5_8_BASE:1.20
	OPENBSD_5_7:1.19.0.4
	OPENBSD_5_7_BASE:1.19
	OPENBSD_5_6:1.19.0.2
	OPENBSD_5_6_BASE:1.19
	OPENBSD_5_5:1.18.0.2
	OPENBSD_5_5_BASE:1.18
	OPENBSD_5_4:1.17.0.2
	OPENBSD_5_4_BASE:1.17
	OPENBSD_5_3:1.16.0.4
	OPENBSD_5_3_BASE:1.16
	OPENBSD_5_2:1.16.0.2
	OPENBSD_5_2_BASE:1.16
	OPENBSD_5_1_BASE:1.14
	OPENBSD_5_1:1.14.0.4
	OPENBSD_5_0:1.14.0.2
	OPENBSD_5_0_BASE:1.14
	OPENBSD_4_9:1.13.0.2
	OPENBSD_4_9_BASE:1.13
	OPENBSD_4_8:1.10.0.2
	OPENBSD_4_8_BASE:1.10
	OPENBSD_4_7:1.9.0.2
	OPENBSD_4_7_BASE:1.9
	OPENBSD_4_6:1.8.0.2
	OPENBSD_4_6_BASE:1.8
	OPENBSD_4_5:1.7.0.2
	OPENBSD_4_5_BASE:1.7
	OPENBSD_4_4:1.6.0.2
	OPENBSD_4_4_BASE:1.6
	OPENBSD_4_3:1.5.0.2
	OPENBSD_4_3_BASE:1.5
	OPENBSD_4_2:1.4.0.4
	OPENBSD_4_2_BASE:1.4
	OPENBSD_4_1:1.4.0.2
	OPENBSD_4_1_BASE:1.4
	OPENBSD_4_0:1.3.0.4
	OPENBSD_4_0_BASE:1.3
	OPENBSD_3_9:1.3.0.2
	OPENBSD_3_9_BASE:1.3
	OPENBSD_3_8:1.2.0.2
	OPENBSD_3_8_BASE:1.2
	mk_20050527:1.1.1.1
	mk:1.1.1;
locks; strict;
comment	@# @;


1.24
date	2016.06.27.19.36.50;	author sthen;	state Exp;
branches;
next	1.23;
commitid	1RO6om9TZZ6Nb40O;

1.23
date	2016.04.28.16.18.29;	author sthen;	state Exp;
branches;
next	1.22;
commitid	vHbS7j5PrANgdwvS;

1.22
date	2016.03.20.19.57.13;	author naddy;	state Exp;
branches;
next	1.21;
commitid	WXJcpbKc0PauxEav;

1.21
date	2015.12.30.10.01.26;	author ajacoutot;	state Exp;
branches;
next	1.20;
commitid	70nO8w9Ckt7hbcu6;

1.20
date	2015.05.08.09.08.44;	author espie;	state Exp;
branches;
next	1.19;
commitid	8WaxsMNN6opOzn9t;

1.19
date	2014.04.13.01.01.39;	author naddy;	state Exp;
branches;
next	1.18;

1.18
date	2013.09.01.21.02.32;	author landry;	state Exp;
branches;
next	1.17;

1.17
date	2013.03.11.11.44.44;	author espie;	state Exp;
branches;
next	1.16;

1.16
date	2012.03.19.07.31.11;	author landry;	state Exp;
branches;
next	1.15;

1.15
date	2012.03.10.10.55.27;	author landry;	state Exp;
branches;
next	1.14;

1.14
date	2011.06.02.13.41.41;	author ajacoutot;	state Exp;
branches;
next	1.13;

1.13
date	2010.11.22.08.36.49;	author espie;	state Exp;
branches;
next	1.12;

1.12
date	2010.11.15.17.39.47;	author jasper;	state Exp;
branches;
next	1.11;

1.11
date	2010.10.19.08.02.54;	author espie;	state Exp;
branches;
next	1.10;

1.10
date	2010.07.13.20.14.23;	author sthen;	state Exp;
branches;
next	1.9;

1.9
date	2009.12.23.18.58.54;	author landry;	state Exp;
branches;
next	1.8;

1.8
date	2009.05.03.15.58.10;	author landry;	state Exp;
branches;
next	1.7;

1.7
date	2008.10.08.13.14.15;	author jasper;	state Exp;
branches;
next	1.6;

1.6
date	2008.06.15.01.51.11;	author ajacoutot;	state Exp;
branches;
next	1.5;

1.5
date	2007.09.15.20.38.22;	author merdely;	state Exp;
branches;
next	1.4;

1.4
date	2007.01.16.17.52.06;	author simon;	state Exp;
branches;
next	1.3;

1.3
date	2005.10.11.17.02.25;	author mbalmer;	state Exp;
branches;
next	1.2;

1.2
date	2005.05.28.03.31.30;	author msf;	state Exp;
branches;
next	1.1;

1.1
date	2005.05.27.16.07.43;	author msf;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2005.05.27.16.07.43;	author msf;	state Exp;
branches;
next	;


desc
@@


1.24
log
@Replace httpd references with Apache, and fix rc script names.
From Caspar Schutijser, thanks!
@
text
@# $OpenBSD: Makefile,v 1.23 2016/04/28 16:18:29 sthen Exp $

COMMENT=		mod_perl Apache gallery handler

MODULES=		cpan
PKG_ARCH=		*
DISTNAME=		Apache-Gallery-1.0.2
EPOCH=			0
REVISION=		4
CATEGORIES=		www
HOMEPAGE=		http://www.apachegallery.dk/
MASTER_SITES=		${HOMEPAGE}/download/

# Artistic
PERMIT_PACKAGE_CDROM=	Yes

RUN_DEPENDS=		www/p5-URI \
			graphics/p5-Image-Info \
			graphics/p5-Image-Size>=3.1.1 \
			textproc/p5-Text-Template \
			graphics/p5-Image-Imlib2 \
			www/ap2-mod_perl \
			www/p5-libapreq2

BUILD_DEPENDS=		${RUN_DEPENDS}
TEST_DEPENDS=		devel/p5-Test-Pod \
			devel/p5-Test-MockObject

TEMPLATESDIR=   ${PREFIX}/share/Apache-Gallery/templates
ICONSDIR=       ${PREFIX}/share/Apache-Gallery/icons
DOCSDIR=        ${PREFIX}/share/doc/Apache-Gallery

MAKE_ENV=	MOD_PERL_API_VERSION=2

post-install:
	${INSTALL_DATA_DIR} ${TEMPLATESDIR}
.for i in bright new default
	${INSTALL_DATA_DIR} ${TEMPLATESDIR}/${i}
	${INSTALL_DATA} ${WRKSRC}/templates/${i}/*.tpl ${TEMPLATESDIR}/${i}
	${INSTALL_DATA} ${WRKSRC}/templates/bright/navdirectory.tpl ${TEMPLATESDIR}/${i}
	${INSTALL_DATA} ${WRKSRC}/templates/${i}/gallery.css \
		${TEMPLATESDIR}/${i}
.endfor
	${INSTALL_DATA_DIR} ${ICONSDIR}
	${INSTALL_DATA} ${WRKSRC}/htdocs/*.png ${ICONSDIR}
	${INSTALL_DATA_DIR} ${DOCSDIR}
	${INSTALL_DATA} ${WRKSRC}/{README,INSTALL} ${DOCSDIR}

	${SUBST_CMD} -m 0644 -c ${FILESDIR}/apache-gallery.conf \
		${DOCSDIR}/apache-gallery.conf.dist
	chown ${SHAREOWN}:${SHAREGRP} ${DOCSDIR}/apache-gallery.conf.dist

.include <bsd.port.mk>
@


1.23
log
@switch to mod_perl2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2016/03/20 19:57:13 naddy Exp $
d9 1
a9 1
REVISION=		3
@


1.22
log
@Remove SHARED_ONLY from all CPAN Perl ports and the cpan and perl MODULES.
Add WANTLIB+=perl and PKG_ARCH=* as appropriate.
@
text
@d1 1
a1 2
# $OpenBSD: Makefile,v 1.21 2015/12/30 10:01:26 ajacoutot Exp $

d8 2
a9 2
EPOCH =			0
REVISION =		2
d12 1
a12 1
MASTER_SITES =		${HOMEPAGE}/download/
d22 2
a23 2
			www/mod_perl \
			www/p5-libapreq>=1.0
d26 1
a26 1
TEST_DEPENDS=	devel/p5-Test-Pod \
d32 2
@


1.21
log
@@@sample /var/www/conf/modules.sample/

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2015/05/08 09:08:44 espie Exp $
d7 1
@


1.20
log
@don't depend on modes in the ports tree being what we want installed
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2014/04/13 01:01:39 naddy Exp $
d9 1
a9 1
REVISION =		1
@


1.19
log
@Drop USE_GROFF since groff and mandoc produce identical output.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2013/09/01 21:02:32 landry Exp $
d47 1
a47 1
	${SUBST_CMD} -c ${FILESDIR}/apache-gallery.conf \
@


1.18
log
@libcrypto is also needed when populating the chroot. Noticed when going
through the time_t warp.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2013/03/11 11:44:44 espie Exp $
d8 2
a9 2
EPOCH =	0
REVISION =	1
a10 1
USE_GROFF =		Yes
@


1.17
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2012/03/19 07:31:11 landry Exp $
d9 1
a9 1
REVISION =	0
@


1.16
log
@Oops, looks like i forgot to update PLIST..
- add rss.tpl & rss_item.tpl
- install the new 'bright' template
- copy navdirectory.tpl from 'bright' to other templates since it's
  missing (also debian bug #645356)
- bump
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2012/03/10 10:55:27 landry Exp $
a16 3
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
d27 1
a27 1
REGRESS_DEPENDS=	devel/p5-Test-Pod \
@


1.15
log
@Update to Apache::Gallery 1.0.2, 7 years after previous releases..

- huge cleanup of README, use PKG_DBDIR pkg_add -B to hint people how to
  properly install A::G and its deps in apache's chroot, instead of
manually copying the deps/modules.
- set EPOCH=0, since 1.0RC3 wasn't a proper version
- provide an apache-gallery.conf @@sample in conf/modules.sample, as other
  www ports do, instead of a VHost to copy/paste
- add UNMESSAGE telling how to completely disable/remove A::G

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2011/06/02 13:41:41 ajacoutot Exp $
d9 1
d39 1
a39 1
.for i in new default
d42 1
@


1.14
log
@Add a consistent header that substitutes FULLPKGNAME for the READMEs.

ok jasper@@ sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2010/11/22 08:36:49 espie Exp $
d7 2
a8 2
DISTNAME=		Apache-Gallery-1.0RC3
REVISION=		2
a10 1

d12 1
d48 4
@


1.13
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2010/11/15 17:39:47 jasper Exp $
d8 1
a8 1
REVISION=		1
@


1.12
log
@- switch to pkg-readmes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2010/10/19 08:02:54 espie Exp $
d10 1
a10 1
USE_GROFF =	Yes
d20 7
a26 7
RUN_DEPENDS=		::www/p5-URI \
			::graphics/p5-Image-Info \
			:p5-Image-Size->=3.1.1:graphics/p5-Image-Size \
			::textproc/p5-Text-Template \
			::graphics/p5-Image-Imlib2 \
			:mod_perl-*:www/mod_perl \
			:p5-libapreq->=1.0:www/p5-libapreq
d29 2
a30 2
REGRESS_DEPENDS=	::devel/p5-Test-Pod \
			::devel/p5-Test-MockObject
@


1.11
log
@USE_GROFF=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2010/07/13 20:14:23 sthen Exp $
d8 1
a8 1
REVISION=		0
a47 2
	${SUBST_CMD} -c ${FILESDIR}/README.chroot ${DOCSDIR}/README.chroot
	chown ${SHAREOWN}:${SHAREGRP} ${DOCSDIR}/README.chroot
@


1.10
log
@use REVISION
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2009/12/23 18:58:54 landry Exp $
d10 1
@


1.9
log
@update README.chroot : xcb and pthread-stubs are also needed
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2009/05/03 15:58:10 landry Exp $
d8 1
a8 1
PKGNAME=		p5-${DISTNAME}p0
@


1.8
log
@Update to Apache::Gallery 1.0RC3 :
- remove a patch merged upstream
- simplify SUBST_CMD/INSTALL_DATA dance
- fix dependencies in README.chroot, which shows it wasn't tested since
  at least imlib2 1.3.0 update more than two years ago..

joint work with and ok simon@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2008/10/08 13:14:15 jasper Exp $
d8 1
@


1.7
log
@- use newer p5-Image-Size to fix issues with perl 5.10
- use SUBST_CMD
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2008/06/15 01:51:11 ajacoutot Exp $
d7 1
a7 2
DISTNAME=		Apache-Gallery-0.9.1
PKGNAME=		p5-${DISTNAME}p2
d46 2
a47 3
	${INSTALL_DATA} ${FILESDIR}/README.chroot ${DOCSDIR}
	${SUBST_CMD} ${DOCSDIR}/README.chroot && \
		rm ${DOCSDIR}/README.chroot.bak
@


1.6
log
@- remove MAINTAINER as per his request
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2007/09/15 20:38:22 merdely Exp $
d8 1
a8 1
PKGNAME=		p5-${DISTNAME}p1
d21 1
a21 1
			::graphics/p5-Image-Size \
a34 4
pre-configure:
	@@sed -e 's,%%LOCALBASE%%,${LOCALBASE},g;' \
		${FILESDIR}/README.chroot > ${WRKSRC}/README.chroot

d47 3
a49 1
	${INSTALL_DATA} ${WRKSRC}/README.chroot ${DOCSDIR}
@


1.5
log
@Remove surrounding quotes from
COMMENT-*/ERRORS/NO_REGRESS/PERMIT_*/REGRESS_IS_INTERACTIVE

Change '.include "bsd.port.mk"' to '.include <bsd.port.mk>' while here
(ok naddy@@)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2007/01/16 17:52:06 simon Exp $
d8 1
a8 1
PKGNAME=		p5-${DISTNAME}p0
a10 1
MAINTAINER=		Michael Knudsen <mk@@molioner.dk>
@


1.4
log
@cpanify, use SHARED_ONLY and set one license

looks ok to jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2005/10/11 17:02:25 mbalmer Exp $
d4 1
a4 1
COMMENT=		"mod_perl Apache gallery handler"
@


1.3
log
@Update MAINTAINER information.
Change Michael Knudsen's email address and two ports and mk takes
maintainership of editors/hexcurse with the previous maintainers consent.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2005/05/28 03:31:30 msf Exp $
d6 1
d8 2
a9 2
PKGNAME=		p5-${DISTNAME}
CATEGORIES=		www perl5
a19 2
MASTER_SITES=		http://apachegallery.dk/download/

d28 1
a28 1
BUILD_DEPENDS= ${RUN_DEPENDS}
a30 2

CONFIGURE_STYLE=	perl
@


1.2
log
@- correct improper RUN_DEPENDS
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2005/05/27 16:07:43 msf Exp $
d10 1
a10 1
MAINTAINER=		Michael Knudsen <e@@molioner.dk>
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d26 2
a27 2
			mod_perl-*::www/mod_perl \
			p5-libapreq->=1.0::www/p5-libapreq
@


1.1.1.1
log
@- initial import of Apache-Gallery 0.9.1

Apache::Gallery creates an thumbnail index of each directory and allows
viewing pictures in different resolutions. Pictures are resized on the
fly and cached.

from submitter Michael Knudsen thanks
@
text
@@
