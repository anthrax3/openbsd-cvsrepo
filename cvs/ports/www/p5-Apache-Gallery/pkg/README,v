head	1.5;
access;
symbols
	OPENBSD_6_0:1.5.0.2
	OPENBSD_6_0_BASE:1.5
	OPENBSD_5_9:1.4.0.8
	OPENBSD_5_9_BASE:1.4
	OPENBSD_5_8:1.4.0.10
	OPENBSD_5_8_BASE:1.4
	OPENBSD_5_7:1.4.0.6
	OPENBSD_5_7_BASE:1.4
	OPENBSD_5_6:1.4.0.4
	OPENBSD_5_6_BASE:1.4
	OPENBSD_5_5:1.4.0.2
	OPENBSD_5_5_BASE:1.4
	OPENBSD_5_4:1.3.0.6
	OPENBSD_5_4_BASE:1.3
	OPENBSD_5_3:1.3.0.4
	OPENBSD_5_3_BASE:1.3
	OPENBSD_5_2:1.3.0.2
	OPENBSD_5_2_BASE:1.3
	OPENBSD_5_1_BASE:1.2
	OPENBSD_5_1:1.2.0.4
	OPENBSD_5_0:1.2.0.2
	OPENBSD_5_0_BASE:1.2
	OPENBSD_4_9:1.1.0.2
	OPENBSD_4_9_BASE:1.1;
locks; strict;
comment	@# @;


1.5
date	2016.06.27.19.36.50;	author sthen;	state Exp;
branches;
next	1.4;
commitid	1RO6om9TZZ6Nb40O;

1.4
date	2013.09.01.21.02.32;	author landry;	state Exp;
branches;
next	1.3;

1.3
date	2012.03.10.10.55.27;	author landry;	state Exp;
branches;
next	1.2;

1.2
date	2011.06.02.13.41.41;	author ajacoutot;	state Exp;
branches;
next	1.1;

1.1
date	2010.11.15.17.39.47;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.5
log
@Replace httpd references with Apache, and fix rc script names.
From Caspar Schutijser, thanks!
@
text
@$OpenBSD: README,v 1.4 2013/09/01 21:02:32 landry Exp $

+-----------------------------------------------------------------------
| Running ${FULLPKGNAME} on OpenBSD
+-----------------------------------------------------------------------

Installing in a chroot
======================

In order to make A::G operate in a chrooted environment, it is
necessary to copy all of the relevant libraries and perl modules
that it employs into /var/www.

First, create the basic directory structure:

$ cd /var/www
# mkdir -p tmp usr
# chown www:www tmp	(needs to be writeable for the www user)

$ cd /var/www/
# mkdir -p .${LOCALBASE}/lib

$ cd /var/www/usr
# mkdir -p libdata/perl5 libexec {.,X11R6}/lib

Next, the run-time link-editor:

$ cd /var/www/usr/libexec
# cp -p /usr/libexec/ld.so .

Next, the required shared libraries:

$ cd /var/www/usr/lib
# cp -p /usr/lib/lib{c,crypto,m,z,util,perl,ssl,stdc++}.so* .

$ cd /var/www/usr/X11R6/lib
# cp -p /usr/X11R6/lib/lib{Xext,freetype,X11,Xau,Xdmcp,xcb,pthread-stubs}.so.* .

Next, the Perl base:

$ cd /var/www/usr/libdata
# cp -pR /usr/libdata/perl5 .

Finally, install p5-Apache-Gallery and all its deps in the chroot

# env PKG_DBDIR=/var/www/var/db/pkg pkg_add -B /var/www p5-Apache-Gallery

Setting up Apache
=================

To enable gallery you need to edit /var/www/conf/modules.sample/apache-gallery.conf
to fit your needs then create a symlink like this :

# ln -s ../modules.sample/apache-gallery.conf \
        /var/www/conf/modules
# /etc/rc.d/apache2 restart

Finally, create a /var/www/htdocs/gallery directory, put your favourite
pictures inside it, and browse to your.server.tld/gallery.
@


1.4
log
@libcrypto is also needed when populating the chroot. Noticed when going
through the time_t warp.
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.3 2012/03/10 10:55:27 landry Exp $
d48 2
a49 2
Setting up httpd
================
d56 1
a56 1
# /etc/rc.d/httpd restart
@


1.3
log
@Update to Apache::Gallery 1.0.2, 7 years after previous releases..

- huge cleanup of README, use PKG_DBDIR pkg_add -B to hint people how to
  properly install A::G and its deps in apache's chroot, instead of
manually copying the deps/modules.
- set EPOCH=0, since 1.0RC3 wasn't a proper version
- provide an apache-gallery.conf @@sample in conf/modules.sample, as other
  www ports do, instead of a VHost to copy/paste
- add UNMESSAGE telling how to completely disable/remove A::G

ok ajacoutot@@
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.2 2011/06/02 13:41:41 ajacoutot Exp $
d34 1
a34 1
# cp -p /usr/lib/lib{c,m,z,util,perl,ssl,stdc++}.so* .
@


1.2
log
@Add a consistent header that substitutes FULLPKGNAME for the READMEs.

ok jasper@@ sthen@@
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.1 2010/11/15 17:39:47 jasper Exp $
d7 3
d34 1
a34 7
# cp -p /usr/lib/lib{c,m,z,util,perl}.so* .

$ cd /var/www${LOCALBASE}/lib
# cp -p ${LOCALBASE}/lib/lib{jpeg,png,bz2,tiff,tiffxx,gif,Imlib2,ltdl,id3tag}.so* .
# mkdir -p imlib2/{loaders,filters}
# cp -pR ${LOCALBASE}/lib/imlib2/loaders/*.so imlib2/loaders
# cp -pR ${LOCALBASE}/lib/imlib2/filters/*.so imlib2/filters
d44 1
a44 30
Next, the A::G images and templates:

$ cd /var/www${LOCALBASE}
# mkdir -p share libdata/perl5/site_perl/`machine`-openbsd
# cp -pR ${TRUEPREFIX}/share/Apache-Gallery share

Next, the non-base Perl stuff:

$ cd /var/www${LOCALBASE}/libdata/perl5/site_perl/
# mkdir -p {,`machine`-openbsd/{,auto/}}Apache
# cp -p ${TRUEPREFIX}/libdata/perl5/site_perl/Apache/Gallery.pm Apache
# cp -pR ${LOCALBASE}/libdata/perl5/site_perl/`machine`-openbsd/Apache* \
	`machine`-openbsd
# cp -pR ${LOCALBASE}/libdata/perl5/site_perl/`machine`-openbsd/auto/Apache \
	`machine`-openbsd/auto
# cp -p ${LOCALBASE}/libdata/perl5/site_perl/`machine`-openbsd/mod_perl*.pm \
	`machine`-openbsd

# mkdir -p {,`machine`-openbsd/}{,auto/}Image
# cp -pR ${LOCALBASE}/libdata/perl5/site_perl/Image .
# cp -pR ${LOCALBASE}/libdata/perl5/site_perl/auto/Image/Size auto/Image
# cp -pR ${LOCALBASE}/libdata/perl5/site_perl/`machine`-openbsd/Image* \
	`machine`-openbsd
# cp -pR ${LOCALBASE}/libdata/perl5/site_perl/`machine`-openbsd/auto/Image \
	`machine`-openbsd/auto

# mkdir -p Text URI IO
# cp -pR ${LOCALBASE}/libdata/perl5/site_perl/Text/Template* Text
# cp -pR ${LOCALBASE}/libdata/perl5/site_perl/IO/String* String
# cp -pR ${LOCALBASE}/libdata/perl5/site_perl/URI* .
d46 1
a49 28
<VirtualHost *>
	ServerAdmin webmaster@@host.some_domain.com
	DocumentRoot /var/www/htdocs
	ErrorLog    logs/gallery-error
	CustomLog   logs/gallery-access combined
	ServerName  gallery.site.tld
	Alias /icons/gallery/ "${TRUEPREFIX}/share/Apache-Gallery/icons/"
	Alias /gallery.css "${TRUEPREFIX}/share/Apache-Gallery/templates/new/gallery.css"
	# This is necessary.
	Options -Indexes
	PerlSetVar  GalleryCacheDir '/tmp/'
	PerlSetVar  GalleryTemplateDir '${TRUEPREFIX}/share/Apache-Gallery/templates/new/'
	PerlSetVar  GalleryInfo 'Picture Taken => DateTimeOriginal, Flash => Flash'
	PerlSetVar  GallerySizes '640 1024'
	PerlSetVar GalleryThumbnailSize '100x75'

	# Note that you will want to change this.
	PerlSetVar GalleryCopyrightImage '${LOCALBASE}/share/Apache-Gallery/icons/c.png'

	<Directory ${TRUEPREFIX}/share/Apache-Gallery>
		order allow,deny
		allow from all
	</Directory>

	<Location />
		SetHandler perl-script
		PerlHandler Apache::Gallery
	</Location>
d51 6
a56 1
</VirtualHost>
d58 2
@


1.1
log
@- switch to pkg-readmes
@
text
@d1 1
a1 1
$OpenBSD: README.chroot,v 1.4 2009/12/23 18:58:54 landry Exp $
d3 3
a5 2
Running KnowledgeTree in a chroot on OpenBSD
============================================
d80 1
a80 1
------------------------------
@

