head	1.4;
access;
symbols
	OPENBSD_4_7:1.3.0.6
	OPENBSD_4_7_BASE:1.3
	OPENBSD_4_6:1.3.0.4
	OPENBSD_4_6_BASE:1.3
	OPENBSD_4_5:1.3.0.2
	OPENBSD_4_5_BASE:1.3
	OPENBSD_4_4:1.1.0.2
	OPENBSD_4_4_BASE:1.1;
locks; strict;
comment	@# @;


1.4
date	2010.07.30.11.28.22;	author sthen;	state dead;
branches;
next	1.3;

1.3
date	2008.12.07.12.36.06;	author mbalmer;	state Exp;
branches;
next	1.2;

1.2
date	2008.11.08.11.23.07;	author mbalmer;	state Exp;
branches;
next	1.1;

1.1
date	2008.05.08.09.57.56;	author mbalmer;	state Exp;
branches;
next	;


desc
@@


1.4
log
@Drop the old horde ports, new versions are now in ports/www/horde
which is also linked to the build with this commit.
@
text
@$OpenBSD: patch-lib_Driver_sql_php,v 1.3 2008/12/07 12:36:06 mbalmer Exp $
--- lib/Driver/sql.php.orig	Wed Sep  3 22:29:54 2008
+++ lib/Driver/sql.php	Sun Dec  7 13:33:33 2008
@@@@ -307,16 +307,16 @@@@ class Kronolith_Driver_sql extends Kronolith_Driver {
         $etime = sprintf('%04d-%02d-%02d 00:00:00', $endInterval->year, $endInterval->month, $endInterval->mday);
         if (isset($startInterval)) {
             $stime = sprintf('%04d-%02d-%02d 00:00:00', $startInterval->year, $startInterval->month, $startInterval->mday);
-            $q .= 'event_end > ? AND ';
+            $q .= 'event_end > CAST(? as timestamp) AND ';
             $values[] = $stime;
         }
-        $q .= 'event_start < ?) OR (';
+        $q .= 'event_start < CAST(? as timestamp)) OR (';
         $values[] = $etime;
         if (isset($stime)) {
-            $q .= 'event_recurenddate >= ? AND ';
+            $q .= 'event_recurenddate >= CAST(? as timestamp) AND ';
             $values[] = $stime;
         }
-        $q .= 'event_start <= ?' .
+        $q .= 'event_start <= CAST(? as timestamp)' .
             ' AND event_recurtype <> ?))';
         array_push($values, $etime, HORDE_DATE_RECUR_NONE);
 
@


1.3
log
@Remove an unneeded cast.
@
text
@d1 1
a1 1
$OpenBSD: patch-lib_Driver_sql_php,v 1.2 2008/11/08 11:23:07 mbalmer Exp $
@


1.2
log
@Forgot to regen the patch, somehow.
@
text
@d1 1
a1 1
$OpenBSD: patch-lib_Driver_sql_php,v 1.1 2008/05/08 09:57:56 mbalmer Exp $
d3 2
a4 2
+++ lib/Driver/sql.php	Sat Nov  8 12:21:21 2008
@@@@ -307,17 +307,17 @@@@ class Kronolith_Driver_sql extends Kronolith_Driver {
a20 1
-            ' AND event_recurtype <> ?))';
d22 1
a22 1
+            ' AND event_recurtype <> CAST(? as varchar)))';
a24 1
         /* Log the query at a DEBUG log level. */
@


1.1
log
@Minor security update to Kronolith 2.1.8.  Change the way the package
is built by first unpacking the distfile so it can be patched.
Sprinkle a few SQL typecasts where needed to make Kronolith happy
again with PostgreSQL 8.3.x.  Discussed with simon.
@
text
@d1 4
a4 4
$OpenBSD$
--- lib/Driver/sql.php.orig	Thu Mar  8 14:52:35 2007
+++ lib/Driver/sql.php	Thu May  8 11:47:41 2008
@@@@ -271,17 +271,17 @@@@ class Kronolith_Driver_sql extends Kronolith_Driver {
d24 1
a24 1
         array_push($values, $etime, KRONOLITH_RECUR_NONE);
d26 1
a26 1
         // Log the query at a DEBUG log level.
@

