head	1.2;
access;
symbols
	OPENBSD_5_4:1.1.0.10
	OPENBSD_5_4_BASE:1.1
	OPENBSD_5_3:1.1.0.8
	OPENBSD_5_3_BASE:1.1
	OPENBSD_5_2:1.1.0.6
	OPENBSD_5_2_BASE:1.1
	OPENBSD_5_1_BASE:1.1
	OPENBSD_5_1:1.1.0.4
	OPENBSD_5_0:1.1.0.2;
locks; strict;
comment	@# @;


1.2
date	2013.11.11.18.17.27;	author robert;	state dead;
branches;
next	1.1;

1.1
date	2012.02.03.07.48.41;	author ajacoutot;	state Exp;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2012.02.03.07.49.41;	author ajacoutot;	state Exp;
branches;
next	1.1.2.2;

1.1.2.2
date	2012.02.04.08.02.27;	author ajacoutot;	state Exp;
branches;
next	;


desc
@@


1.2
log
@update to 1.2.3 and fallback to using the openssl binary if available instead of deprecated mhash() functions
@
text
@$OpenBSD: patch-lib_QueryRender_php,v 1.1 2012/02/03 07:48:41 ajacoutot Exp $

phpLDAPadmin "base" Cross-Site Scripting Vulnerability
http://secunia.com/advisories/47852/
upstream: http://phpldapadmin.git.sourceforge.net/git/gitweb.cgi?p=phpldapadmin/phpldapadmin;a=commit;h=7dc8d57d6952fe681cb9e8818df7f103220457bd

--- lib/QueryRender.php.orig	Wed May 11 11:40:18 2011
+++ lib/QueryRender.php	Fri Feb  3 07:29:28 2012
@@@@ -497,7 +497,7 @@@@ class QueryRender extends PageRender {
 				$this->getAjaxRef($base),
 				$this->getAjaxRef($base),
 				($show == $this->getAjaxRef($base) ? '#F0F0F0' : '#E0E0E0'),
-				$base);
+				htmlspecialchars($base));
 		}
 		echo '</tr>';
 		echo '</table>';
@@@@ -545,7 +545,7 @@@@ class QueryRender extends PageRender {
 		echo ' ]</small>';
 
 		echo '<br />';
-		printf('<small>%s: <b>%s</b></small>',_('Base DN'),$base);
+		printf('<small>%s: <b>%s</b></small>',_('Base DN'),htmlspecialchars($base));
 
 		echo '<br />';
 		printf('<small>%s: <b>%s</b></small>',_('Filter performed'),htmlspecialchars($this->template->resultsdata[$base]['filter']));
@


1.1
log
@Add a patch from upstream to fix:
phpLDAPadmin "base" Cross-Site Scripting Vulnerability
http://secunia.com/advisories/47852/

ok sthen@@
@
text
@d1 1
a1 1
$OpenBSD$
@


1.1.2.1
log
@Add a patch from upstream to fix:
phpLDAPadmin "base" Cross-Site Scripting Vulnerability
http://secunia.com/advisories/47852/

ok sthen@@
@
text
@a26 26
$OpenBSD$

phpLDAPadmin "base" Cross-Site Scripting Vulnerability
http://secunia.com/advisories/47852/
upstream: http://phpldapadmin.git.sourceforge.net/git/gitweb.cgi?p=phpldapadmin/phpldapadmin;a=commit;h=7dc8d57d6952fe681cb9e8818df7f103220457bd

--- lib/QueryRender.php.orig	Wed May 11 11:40:18 2011
+++ lib/QueryRender.php	Fri Feb  3 07:29:28 2012
@@@@ -497,7 +497,7 @@@@ class QueryRender extends PageRender {
 				$this->getAjaxRef($base),
 				$this->getAjaxRef($base),
 				($show == $this->getAjaxRef($base) ? '#F0F0F0' : '#E0E0E0'),
-				$base);
+				htmlspecialchars($base));
 		}
 		echo '</tr>';
 		echo '</table>';
@@@@ -545,7 +545,7 @@@@ class QueryRender extends PageRender {
 		echo ' ]</small>';
 
 		echo '<br />';
-		printf('<small>%s: <b>%s</b></small>',_('Base DN'),$base);
+		printf('<small>%s: <b>%s</b></small>',_('Base DN'),htmlspecialchars($base));
 
 		echo '<br />';
 		printf('<small>%s: <b>%s</b></small>',_('Filter performed'),htmlspecialchars($this->template->resultsdata[$base]['filter']));
@


1.1.2.2
log
@Regen pach to unbreak... that will teach me committing from the wrong dir.
spotted by ian@@
@
text
@d1 1
a1 1
$OpenBSD: patch-lib_QueryRender_php,v 1.1.2.1 2012/02/03 07:49:41 ajacoutot Exp $
d7 3
a9 3
--- lib/QueryRender.php.orig	Sat Feb  4 08:55:28 2012
+++ lib/QueryRender.php	Sat Feb  4 08:56:36 2012
@@@@ -493,7 +493,7 @@@@ class QueryRender extends PageRender {
d18 27
a44 1
@@@@ -541,7 +541,7 @@@@ class QueryRender extends PageRender {
@


