head	1.11;
access;
symbols
	OPENBSD_4_7:1.10.0.6
	OPENBSD_4_7_BASE:1.10
	OPENBSD_4_6:1.10.0.4
	OPENBSD_4_6_BASE:1.10
	OPENBSD_4_5:1.10.0.2
	OPENBSD_4_5_BASE:1.10
	OPENBSD_4_4:1.9.0.2
	OPENBSD_4_4_BASE:1.9
	OPENBSD_4_3:1.8.0.2
	OPENBSD_4_3_BASE:1.8
	OPENBSD_4_2:1.7.0.2
	OPENBSD_4_2_BASE:1.7
	OPENBSD_4_1:1.6.0.2
	OPENBSD_4_1_BASE:1.6
	OPENBSD_4_0:1.5.0.4
	OPENBSD_4_0_BASE:1.5
	OPENBSD_3_9:1.5.0.2
	OPENBSD_3_9_BASE:1.5
	OPENBSD_3_8:1.2.0.4
	OPENBSD_3_8_BASE:1.2
	OPENBSD_3_7:1.2.0.2
	OPENBSD_3_7_BASE:1.2
	OPENBSD_3_6:1.1.1.1.0.4
	OPENBSD_3_6_BASE:1.1.1.1
	OPENBSD_3_5:1.1.1.1.0.2
	OPENBSD_3_5_BASE:1.1.1.1
	wilfried_2004-04-15:1.1.1.1
	wilfried:1.1.1;
locks; strict;
comment	@# @;


1.11
date	2010.04.26.19.55.58;	author landry;	state dead;
branches;
next	1.10;

1.10
date	2008.11.20.23.41.32;	author martynas;	state Exp;
branches;
next	1.9;

1.9
date	2008.07.20.09.49.00;	author claudio;	state Exp;
branches;
next	1.8;

1.8
date	2007.11.28.20.22.25;	author martynas;	state Exp;
branches;
next	1.7;

1.7
date	2007.06.12.16.45.37;	author martynas;	state Exp;
branches;
next	1.6;

1.6
date	2007.03.01.22.46.06;	author robert;	state Exp;
branches
	1.6.2.1;
next	1.5;

1.5
date	2005.12.20.23.44.00;	author bernd;	state Exp;
branches
	1.5.4.1;
next	1.4;

1.4
date	2005.10.13.04.32.41;	author bernd;	state Exp;
branches;
next	1.3;

1.3
date	2005.09.24.16.19.29;	author bernd;	state Exp;
branches;
next	1.2;

1.2
date	2004.11.26.18.29.15;	author pvalchev;	state Exp;
branches
	1.2.2.1
	1.2.4.1;
next	1.1;

1.1
date	2004.02.15.19.37.25;	author wilfried;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2004.02.15.19.37.25;	author wilfried;	state Exp;
branches;
next	;

1.2.2.1
date	2006.04.24.15.46.58;	author sturm;	state Exp;
branches;
next	;

1.2.4.1
date	2006.04.24.15.48.59;	author sturm;	state Exp;
branches;
next	;

1.5.4.1
date	2007.06.27.06.12.27;	author sturm;	state Exp;
branches;
next	;

1.6.2.1
date	2007.07.04.17.11.48;	author sturm;	state Exp;
branches;
next	;


desc
@@


1.11
log
@Update www/mozilla-firefox from 3.0.19 to 3.6.3, merging the wip done in
www/firefox36 mostly by martynas@@ and naddy@@.
Note that the java plugin from devel/jdk currently doesn't work with this
version of firefox, in the meantime users really needed it will have to
use www/firefox35.
ok naddy@@
@
text
@$OpenBSD: patch-browser_app_mozilla_in,v 1.10 2008/11/20 23:41:32 martynas Exp $
--- browser/app/mozilla.in.orig	Fri Oct  5 10:29:26 2007
+++ browser/app/mozilla.in	Sat Nov 17 16:13:18 2007
@@@@ -52,6 +52,11 @@@@
 #uncomment for debugging
 #set -x
 
+LIMIT=`ulimit -n`
+if [ $LIMIT -lt 128 -a "${LIMIT}" != "unlimited" ]; then
+	ulimit -Sn 128
+fi
+
 moz_libdir=%MOZAPPDIR%
 
 # Use run-mozilla.sh in the current dir if it exists
@@@@ -130,6 +135,12 @@@@ do
       ;;
   esac
 done
+
+if [ `_X11BASE_/bin/fc-list | wc -l` -eq 0 ]; then
+	export GDK_USE_XFT=0
+fi
+
+export MOZ_PLUGIN_PATH=${MOZ_PLUGIN_PATH:=_LOCALBASE_/lib/mozilla-plugins}
 
 if [ $debugging = 1 ]
 then
@


1.10
log
@it is the right time to update to mozilla-firefox-3.0.4, which has
been tested good enough, and i've fixed all the issues i'm aware
of.  furthermore 2.0 branch has basically reached eol, since there
will be only one minor update (2.0.0.19)
discussed with kurt@@, naddy@@ and porters
pkgname change handling help naddy@@
ok naddy@@
@
text
@d1 1
a1 1
$OpenBSD: patch-browser_app_mozilla_in,v 1.2 2008/07/25 01:55:40 martynas Exp $
@


1.9
log
@Don't overwrite MOZ_PLUGIN_PATH in the startup script if it has been already
been set. This allows to load plugins on demand, especially interesting when
using multiple profiles with the -no-remote option.
OK martynas@@
@
text
@d1 4
a4 4
$OpenBSD: patch-browser_app_mozilla_in,v 1.8 2007/11/28 20:22:25 martynas Exp $
--- browser/app/mozilla.in.orig	Thu Nov  8 10:53:19 2007
+++ browser/app/mozilla.in	Tue Nov 27 11:43:00 2007
@@@@ -92,7 +92,13 @@@@ moz_pis_startstop_scripts()
a13 2
+MOZ_PLUGIN_PATH=${MOZ_PLUGIN_PATH:=_LOCALBASE_/lib/mozilla-plugins}
 MRE_HOME=%MREDIR%
d16 2
a17 1
@@@@ -172,7 +178,11 @@@@ do
d20 1
a20 2
 
-export MRE_HOME
d25 1
a25 1
+export MOZ_PLUGIN_PATH MRE_HOME
d27 2
a28 2
 ## Start addon scripts
 moz_pis_startstop_scripts "start"
@


1.8
log
@- security update to mozilla-firefox-2.0.0.10:
http://www.mozilla.org/projects/security/known-vulnerabilities.html#firefox2.0.0.10
- fix canvas.drawImage regression.
ok kurt@@, kili@@
@
text
@d1 1
a1 1
$OpenBSD: patch-browser_app_mozilla_in,v 1.7 2007/06/12 16:45:37 martynas Exp $
d14 1
a14 1
+MOZ_PLUGIN_PATH=_LOCALBASE_/lib/mozilla-plugins
@


1.7
log
@- set fd soft limit to 128 if it's lower: helps for people who
upgraded and didn't use mergemaster;
- remove lines, related to debug build and fd in README.OpenBSD;
help from sturm@@, kurt@@, espie@@, naddy@@
ok kurt@@, sturm@@
@
text
@d1 3
a3 3
$OpenBSD: patch-browser_app_mozilla_in,v 1.6 2007/03/01 22:46:06 robert Exp $
--- browser/app/mozilla.in.orig	Wed Sep 21 00:13:03 2005
+++ browser/app/mozilla.in	Tue Jun 12 18:24:57 2007
d18 1
a18 1
@@@@ -171,7 +177,11 @@@@ do
@


1.6
log
@- update to version 2.0.0.2 and apply several security fixes,
therefore bump the PKGNAME to p0 now;
- enable official branding by default
- fix some WANTLIB markers

work done by Martynas Venckus; thanks.

tested by many many people; ok pvalchev@@
@
text
@d1 1
a1 1
$OpenBSD: patch-browser_app_mozilla_in,v 1.5 2005/12/20 23:44:00 bernd Exp $
d3 3
a5 2
+++ browser/app/mozilla.in	Sat Feb 24 18:46:11 2007
@@@@ -93,6 +93,7 @@@@ moz_pis_startstop_scripts()
d8 5
d18 1
a18 1
@@@@ -171,7 +172,11 @@@@ do
@


1.6.2.1
log
@MFC:
- set fd soft limit to 128 if it's lower
@
text
@d1 4
a4 5
$OpenBSD: patch-browser_app_mozilla_in,v 1.6 2007/03/01 22:46:06 robert Exp $
--- browser/app/mozilla.in.orig	Tue Sep 20 23:13:03 2005
+++ browser/app/mozilla.in	Wed Jul  4 16:47:25 2007
@@@@ -92,7 +92,13 @@@@ moz_pis_startstop_scripts()
 #uncomment for debugging
a6 5
+LIMIT=`ulimit -n`
+if [ $LIMIT -lt 128 -a "${LIMIT}" != "unlimited" ]; then
+	ulimit -Sn 128
+fi
+
d12 1
a12 1
@@@@ -171,7 +177,11 @@@@ do
@


1.5
log
@Update to Firefox 1.5.

Team work by wilfried@@, kurt@@ and me.

Tested by many. Thanks a lot!

ok kurt@@ krw@@ jolan@@ ian@@ pvalchev@@
@
text
@d1 3
a3 3
$OpenBSD: patch-browser_app_mozilla_in,v 1.4 2005/10/13 04:32:41 bernd Exp $
--- browser/app/mozilla.in.orig	Tue Sep 20 23:13:03 2005
+++ browser/app/mozilla.in	Fri Oct 21 21:19:52 2005
d12 1
a12 9
@@@@ -130,6 +131,7 @@@@ if [ $found = 0 ]; then
   # Check default compile-time libdir
   if [ -x "$moz_libdir/run-mozilla.sh" ]; then
     dist_bin="$moz_libdir"
+    run_moz="$dist_bin/run-mozilla.sh"
   else 
     echo "Cannot find mozilla runtime directory. Exiting."
     exit 1
@@@@ -171,7 +173,11 @@@@ do
d17 2
a18 2
+if [ `_X11BASE_/bin/fc-list | wc -l` -eq 0 ]
+then export GDK_USE_XFT=0
@


1.5.4.1
log
@security update to firefox 1.5.0.12
set soft fd to 128
backport an nss fix for a deadlock
@
text
@d1 1
a1 1
$OpenBSD: patch-browser_app_mozilla_in,v 1.5 2005/12/20 23:44:00 bernd Exp $
d3 2
a4 3
+++ browser/app/mozilla.in	Wed Jun 27 07:27:17 2007
@@@@ -92,7 +92,13 @@@@ moz_pis_startstop_scripts()
 #uncomment for debugging
a6 5
+LIMIT=`ulimit -n`
+if [ $LIMIT -lt 128 -a "${LIMIT}" != "unlimited" ]; then
+	ulimit -Sn 128
+fi
+
d12 1
a12 1
@@@@ -130,6 +136,7 @@@@ if [ $found = 0 ]; then
d20 1
a20 1
@@@@ -171,7 +178,11 @@@@ do
@


1.4
log
@If we start a second firefox, don't show the profile chooser but open a
new browser window instead. (The same for thunderbird and mozilla.)

Idea from Marc Winiger <mw at msys.ch>, thanks!

suggestions, tests & ok kurt@@
@
text
@d1 4
a4 4
$OpenBSD: patch-browser_app_mozilla_in,v 1.3 2005/09/24 16:19:29 bernd Exp $
--- browser/app/mozilla.in.orig	Tue Sep 20 23:10:28 2005
+++ browser/app/mozilla.in	Wed Oct 12 13:06:37 2005
@@@@ -73,6 +73,7 @@@@ moz_pis_startstop_scripts()
d12 1
a12 1
@@@@ -110,6 +111,7 @@@@ if [ $found = 0 ]; then
d20 1
a20 1
@@@@ -217,7 +219,11 @@@@ do
@


1.3
log
@update to mozilla-firefox-1.0.7

comments & ok kurt@@
@
text
@d1 1
a1 1
$OpenBSD: patch-browser_app_mozilla_in,v 1.2 2004/11/26 18:29:15 pvalchev Exp $
d3 1
a3 1
+++ browser/app/mozilla.in	Thu Sep 22 10:26:21 2005
d12 9
a20 1
@@@@ -217,7 +218,11 @@@@ do
@


1.2
log
@mozilla-firefox-1.0; based on work by wilfried/robert/naddy
@
text
@d1 3
a3 3
$OpenBSD: patch-browser_app_mozilla_in,v 1.1.1.1 2004/02/15 19:37:25 wilfried Exp $
--- browser/app/mozilla.in.orig	Tue Oct 26 11:26:11 2004
+++ browser/app/mozilla.in	Thu Oct 28 17:20:22 2004
d12 1
a12 1
@@@@ -214,7 +215,11 @@@@ do
a21 1
 eval "set -- $moreargs"
d24 1
@


1.2.4.1
log
@update to firefox 1.0.8
several security related fixes
@
text
@d1 3
a3 3
$OpenBSD: patch-browser_app_mozilla_in,v 1.2 2004/11/26 18:29:15 pvalchev Exp $
--- browser/app/mozilla.in.orig	Tue Sep 20 23:10:28 2005
+++ browser/app/mozilla.in	Wed Apr 19 08:10:50 2006
d12 1
a12 1
@@@@ -217,7 +218,11 @@@@ do
d22 1
a24 1
 moz_pis_startstop_scripts "start"
@


1.2.2.1
log
@update to firefox 1.0.8
several security related fixes
@
text
@d1 3
a3 3
$OpenBSD: patch-browser_app_mozilla_in,v 1.2 2004/11/26 18:29:15 pvalchev Exp $
--- browser/app/mozilla.in.orig	Tue Sep 20 23:10:28 2005
+++ browser/app/mozilla.in	Tue Apr 18 22:31:27 2006
d12 1
a12 1
@@@@ -217,7 +218,11 @@@@ do
d22 1
a24 1
 moz_pis_startstop_scripts "start"
@


1.1
log
@Initial revision
@
text
@d1 4
a4 4
$OpenBSD: patch-browser_app_mozilla_in,v 1.7 2004/01/19 14:36:48 wilfried Exp $
--- browser/app/mozilla.in.orig	2003-07-26 09:51:05.000000000 +0200
+++ browser/app/mozilla.in	2004-01-19 15:19:46.000000000 +0100
@@@@ -33,6 +33,7 @@@@
d12 1
a12 1
@@@@ -106,7 +107,11 @@@@ do
d23 2
a24 2
 if [ $debugging = 1 ]
 then
@


1.1.1.1
log
@import of mozilla firefox 0.8
@
text
@@
