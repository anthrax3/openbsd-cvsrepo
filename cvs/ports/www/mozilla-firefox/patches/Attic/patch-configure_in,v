head	1.30;
access;
symbols
	OPENBSD_5_6:1.29.0.2
	OPENBSD_5_6_BASE:1.29
	OPENBSD_5_4:1.27.0.2
	OPENBSD_5_0:1.22.0.2
	OPENBSD_5_0_BASE:1.22
	OPENBSD_4_9:1.18.0.4
	OPENBSD_4_9_BASE:1.18
	OPENBSD_4_8:1.18.0.2
	OPENBSD_4_8_BASE:1.18
	OPENBSD_4_7:1.16.0.4
	OPENBSD_4_7_BASE:1.16
	OPENBSD_4_6:1.16.0.2
	OPENBSD_4_6_BASE:1.16
	OPENBSD_4_5:1.15.0.2
	OPENBSD_4_5_BASE:1.15
	OPENBSD_4_4:1.13.0.4
	OPENBSD_4_4_BASE:1.13
	OPENBSD_4_3:1.13.0.2
	OPENBSD_4_3_BASE:1.13
	OPENBSD_4_2:1.10.0.2
	OPENBSD_4_2_BASE:1.10
	OPENBSD_4_1:1.9.0.2
	OPENBSD_4_1_BASE:1.9
	OPENBSD_4_0:1.7.0.2
	OPENBSD_4_0_BASE:1.7
	OPENBSD_3_9:1.5.0.2
	OPENBSD_3_9_BASE:1.5
	OPENBSD_3_8:1.4.0.2
	OPENBSD_3_8_BASE:1.4
	OPENBSD_3_7:1.3.0.2
	OPENBSD_3_7_BASE:1.3
	OPENBSD_3_6:1.1.1.1.0.4
	OPENBSD_3_6_BASE:1.1.1.1
	OPENBSD_3_5:1.1.1.1.0.2
	OPENBSD_3_5_BASE:1.1.1.1
	wilfried_2004-04-15:1.1.1.1
	wilfried:1.1.1;
locks; strict;
comment	@# @;


1.30
date	2014.09.02.16.43.04;	author landry;	state dead;
branches;
next	1.29;
commitid	oUjXdZ5B9Zpw9SaL;

1.29
date	2014.07.24.18.03.00;	author landry;	state Exp;
branches;
next	1.28;
commitid	k2YGqYP6dSDkuIKd;

1.28
date	2014.06.14.13.03.31;	author landry;	state Exp;
branches;
next	1.27;
commitid	5JfKMLDsRpzthlIZ;

1.27
date	2012.11.24.10.21.50;	author landry;	state dead;
branches
	1.27.2.1;
next	1.26;

1.26
date	2012.10.10.20.56.14;	author landry;	state Exp;
branches;
next	1.25;

1.25
date	2012.09.01.13.56.45;	author landry;	state Exp;
branches;
next	1.24;

1.24
date	2012.08.07.08.55.40;	author landry;	state Exp;
branches;
next	1.23;

1.23
date	2011.08.23.20.14.52;	author landry;	state dead;
branches;
next	1.22;

1.22
date	2011.06.28.05.43.57;	author landry;	state Exp;
branches;
next	1.21;

1.21
date	2011.05.02.15.08.28;	author jasper;	state Exp;
branches;
next	1.20;

1.20
date	2011.04.15.11.43.46;	author landry;	state Exp;
branches;
next	1.19;

1.19
date	2011.03.30.21.39.14;	author landry;	state Exp;
branches;
next	1.18;

1.18
date	2010.06.28.21.24.22;	author landry;	state Exp;
branches;
next	1.17;

1.17
date	2010.04.26.19.55.58;	author landry;	state Exp;
branches;
next	1.16;

1.16
date	2009.06.11.14.10.37;	author martynas;	state Exp;
branches;
next	1.15;

1.15
date	2008.11.20.23.41.32;	author martynas;	state Exp;
branches;
next	1.14;

1.14
date	2008.11.13.16.57.14;	author martynas;	state Exp;
branches;
next	1.13;

1.13
date	2008.02.11.18.13.44;	author bernd;	state Exp;
branches;
next	1.12;

1.12
date	2007.11.28.20.22.25;	author martynas;	state Exp;
branches;
next	1.11;

1.11
date	2007.10.23.20.13.26;	author martynas;	state Exp;
branches;
next	1.10;

1.10
date	2007.06.01.08.03.42;	author martynas;	state Exp;
branches;
next	1.9;

1.9
date	2007.03.01.22.46.06;	author robert;	state Exp;
branches
	1.9.2.1;
next	1.8;

1.8
date	2007.01.12.21.46.17;	author kurt;	state Exp;
branches;
next	1.7;

1.7
date	2006.07.31.09.32.19;	author bernd;	state Exp;
branches;
next	1.6;

1.6
date	2006.05.05.10.14.21;	author bernd;	state Exp;
branches;
next	1.5;

1.5
date	2005.12.20.23.44.00;	author bernd;	state Exp;
branches
	1.5.2.1;
next	1.4;

1.4
date	2005.04.09.15.43.47;	author wilfried;	state Exp;
branches;
next	1.3;

1.3
date	2005.01.13.15.57.26;	author wilfried;	state Exp;
branches
	1.3.2.1;
next	1.2;

1.2
date	2004.11.26.18.29.15;	author pvalchev;	state dead;
branches;
next	1.1;

1.1
date	2004.02.15.19.37.25;	author wilfried;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2004.02.15.19.37.25;	author wilfried;	state Exp;
branches;
next	;

1.3.2.1
date	2005.06.06.20.30.29;	author robert;	state Exp;
branches;
next	;

1.5.2.1
date	2006.05.07.19.52.04;	author sturm;	state Exp;
branches;
next	1.5.2.2;

1.5.2.2
date	2006.08.02.19.23.14;	author sturm;	state Exp;
branches;
next	;

1.9.2.1
date	2007.06.17.13.13.40;	author sturm;	state Exp;
branches;
next	;

1.27.2.1
date	2013.12.01.22.06.19;	author jasper;	state Exp;
branches;
next	1.27.2.2;

1.27.2.2
date	2013.12.15.13.52.17;	author jasper;	state Exp;
branches;
next	1.27.2.3;

1.27.2.3
date	2014.02.05.08.07.24;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.30
log
@Update to firefox 32.0

- see https://www.mozilla.org/en-US/firefox/32.0/releasenotes/
- remove patch-toolkit_components_downloads_nsDownloadManager_cpp and
  patch-xpcom_io_SpecialSystemDirectory_cpp fiddling with modes when
creating user dirs, they never made sense to me, and this is the wrong
place to touch this.
- remove patch-webapprt_moz_build, patch-webapprt_gtk2_Makefile_in and
  patch-configure_in from #1012447, merged upstream
@
text
@$OpenBSD: patch-configure_in,v 1.29 2014/07/24 18:03:00 landry Exp $
webapprt gtk3 https://bugzilla.mozilla.org/show_bug.cgi?id=1012447
--- configure.in.orig	Thu Jul 17 03:45:08 2014
+++ configure.in	Mon Jul 21 20:44:51 2014
@@@@ -6292,7 +6292,7 @@@@ MOZ_ARG_DISABLE_BOOL(webapp-runtime,
 [  --disable-webapp-runtime  Disable Web App Runtime],
     MOZ_WEBAPP_RUNTIME=,
     MOZ_WEBAPP_RUNTIME=1)
-if test "$MOZ_WIDGET_TOOLKIT" != "windows" -a "$MOZ_WIDGET_TOOLKIT" != "cocoa" -a "$MOZ_WIDGET_TOOLKIT" != "gtk2"; then
+if test "$MOZ_WIDGET_TOOLKIT" != "windows" -a "$MOZ_WIDGET_TOOLKIT" != "cocoa" -a -z "$MOZ_WIDGET_GTK" ; then
     MOZ_WEBAPP_RUNTIME=
 fi
 if test "$OS_ARCH" = "WINNT" -a -z "$MAKENSISU" -a -n "$CROSS_COMPILE"; then
@


1.29
log
@Update to firefox 31.0.

- See https://www.mozilla.org/en-US/firefox/31.0/releasenotes/
- Fixes MFSA 2014-56->66
- rm/add aboutcerterror/aboutCertError.xhtml patch, corresponding code
  moved - i'm still pondering why we keep that patch..
- remove patch-browser_branding_official_Makefile_in, merged (#992613)
- remove chunk 1 of patch-configure_in, merged (#991686)
- improve skia/i386/sse3 patches from #1028827, for something simpler and
  closer to what will be commited upstream
- fix README to point users to gstreamer1-plugins-libav instead of
  gstreamer-ffmpeg, reminded by jturner@@ a while ago

ok sthen@@ jasper@@ naddy@@
@
text
@d1 1
a1 1
$OpenBSD: patch-configure_in,v 1.28 2014/06/14 13:03:31 landry Exp $
@


1.28
log
@Update to firefox 30.0.

- See http://www.mozilla.org/en-US/firefox/30.0/releasenotes/
- Fixes MFSA 2014-48->54
- Switch to use gstreamer 1.0 by default
- Add a bunch of patches from #992613, #991613, #1012447 to build
  properly with gtk3
- Note that this fixes runtime on ppc which was broken since 29 (see
  #961488), which was quite a hairy one
- Still running fine on sparc64 !
@
text
@d1 5
a5 16
$OpenBSD$
https://bugzilla.mozilla.org/show_bug.cgi?id=991686
fx31
chunk2: webapprt gtk3 https://bugzilla.mozilla.org/show_bug.cgi?id=1012447
--- configure.in.orig	Thu May 15 23:21:18 2014
+++ configure.in	Mon May 19 21:17:40 2014
@@@@ -4866,7 +4866,7 @@@@ dnl ==================================================
 dnl = GNOME component (mozgnome)
 dnl ========================================================
 
-if test "$MOZ_ENABLE_GTK2"
+if test "$MOZ_ENABLE_GTK"
 then
     MOZ_ENABLE_GNOME_COMPONENT=1
 fi
@@@@ -6181,7 +6181,7 @@@@ MOZ_ARG_DISABLE_BOOL(webapp-runtime,
@


1.27
log
@Update to firefox 17.0.

- see http://www.mozilla.org/en-US/firefox/17.0/releasenotes/ for details
- enable the gio/libnotify interaction, since it brings no additional
  dep. libnotify will be dlopened at runtime if present, and gio is
already in the dependency chain. The latter will interact with the gio mime
database for file associations, and firefox will ask the user if he
wants to register it as the default http:// handler. The former will
show a notify popup upon download completion, among others.
- add build depends on yasm in i386/amd64 for webm
- remove patch-browser_app_profile_firefox_js, the updater is already disabled
- remove gstreamer patches from #776838, #777696 & #747257, merged upstream
- remove ipc_message_utils.h patch from #775428, commited upstream
- remove mozalloc.cpp patch, <sys/types.h> is already included above
- remove xpcshell hang patchset from #706955, cant reproduce anymore
- remove patch-security_manager_ssl_src_Makefile_in, unneeded
- remove OS.File extra logging from #785200, merged upstream
- add patch-toolkit_system_gnome_nsGIOService_cpp, workaround for
  #805202 (libgio-2.0.so dlopening), to be removed in fx 19
- remove xpcom arm patch from #783875, merged upstream

ok sthen@@
@
text
@d1 24
a24 13
$OpenBSD: patch-configure_in,v 1.26 2012/10/10 20:56:14 landry Exp $
https://bugzilla.mozilla.org/show_bug.cgi?id=776838
--- configure.in.orig	Tue Aug 28 17:34:04 2012
+++ configure.in	Sun Sep  2 00:10:35 2012
@@@@ -5616,7 +5616,7 @@@@ if test "$MOZ_GSTREAMER"; then
                       gstreamer-plugins-base-$GST_API_VERSION)
     if test -n "$GSTREAMER_LIBS"; then
        _SAVE_LDFLAGS=$LDFLAGS
-       LDFLAGS="$LDFLAGS -lgstvideo-$GST_API_VERSION"
+       LDFLAGS="$LDFLAGS $GSTREAMER_LIBS -lgstvideo-$GST_API_VERSION"
        AC_TRY_LINK(,[return 0;],_HAVE_LIBGSTVIDEO=1,_HAVE_LIBGSTVIDEO=)
        if test -n "$_HAVE_LIBGSTVIDEO" ; then
           GSTREAMER_LIBS="$GSTREAMER_LIBS -lgstvideo-$GST_API_VERSION"
@


1.27.2.1
log
@update to mozilla-firefox 24.1.1esr which includes fixes for MFSA2013-103

ok landry@@
@
text
@d1 13
a13 16
$OpenBSD$

Lower nspr dependency which is not strictly needed as the security fixes have been
backported to 4.10.

--- configure.in.orig	Sun Dec  1 10:59:42 2013
+++ configure.in	Sun Dec  1 11:00:08 2013
@@@@ -3826,7 +3826,7 @@@@ MOZ_ARG_WITH_BOOL(system-nspr,
     _USE_SYSTEM_NSPR=1 )
 
 if test -n "$_USE_SYSTEM_NSPR"; then
-    AM_PATH_NSPR(4.10.2, [MOZ_NATIVE_NSPR=1], [AC_MSG_ERROR([your don't have NSPR installed or your version is too old])])
+    AM_PATH_NSPR(4.10, [MOZ_NATIVE_NSPR=1], [AC_MSG_ERROR([your don't have NSPR installed or your version is too old])])
 fi
 
 if test -n "$MOZ_NATIVE_NSPR"; then
@


1.27.2.2
log
@- update to firefox-24.2.0esr
@
text
@d1 1
a1 1
$OpenBSD: patch-configure_in,v 1.27.2.1 2013/12/01 22:06:19 jasper Exp $
d6 3
a8 3
--- configure.in.orig	Fri Dec  6 03:21:00 2013
+++ configure.in	Wed Dec 11 10:01:44 2013
@@@@ -3828,7 +3828,7 @@@@ MOZ_ARG_WITH_BOOL(system-nspr,
@


1.27.2.3
log
@update to firefox-esr 24.3.0

ok landry@@
@
text
@d1 1
a1 1
$OpenBSD: patch-configure_in,v 1.27.2.2 2013/12/15 13:52:17 jasper Exp $
d6 3
a8 3
--- configure.in.orig	Fri Jan 31 18:39:51 2014
+++ configure.in	Thu Jan 16 18:58:47 2014
@@@@ -3833,7 +3833,7 @@@@ MOZ_ARG_WITH_BOOL(system-nspr,
a16 9
@@@@ -3944,7 +3944,7 @@@@ MOZ_ARG_WITH_BOOL(system-nss,
     _USE_SYSTEM_NSS=1 )
 
 if test -n "$_USE_SYSTEM_NSS"; then
-    AM_PATH_NSS(3.15.4, [MOZ_NATIVE_NSS=1], [AC_MSG_ERROR([you don't have NSS installed or your version is too old])])
+    AM_PATH_NSS(3.15.3.1, [MOZ_NATIVE_NSS=1], [AC_MSG_ERROR([you don't have NSS installed or your version is too old])])
 fi
 
 if test -n "$MOZ_NATIVE_NSS"; then
@


1.26
log
@Update to firefox 16.0.

- see http://www.mozilla.org/en-US/firefox/16.0/releasenotes/ for details
- install an icon into share/pixmaps to fix desktop file icon path
- garbage collect patch-browser_installer_Makefile_in, and
  patch-browser_installer_package-manifest_in, were from upstream
- remove patch-build_unix_mozilla_in, useless since bin/firefox is not a
  script anymore since a while
- remove patch-build_unix_run-mozilla_sh, firefox can be directly
  debugged in gdb now. update README accordingly
- remove patch-config_autoconf_mk_in, XCFLAGS are already passed
- update patch-content_media_gstreamer_nsGStreamerReader_cpp to fix
  gstreamer on BE archs (#777696)
- update patch-extensions_spellcheck_hunspell_src_mozHunspell_cpp after
  nsILocalFile api removal
- remove useless patch-gfx_thebes_Makefile_in pangox patch
- fix PLIST to use proper MOZILLA_VERSION instead of beta MOZILLA_VER
@
text
@d1 1
a1 1
$OpenBSD: patch-configure_in,v 1.25 2012/09/01 13:56:45 landry Exp $
@


1.25
log
@Update to firefox 15.0.

- see http://www.mozilla.org/en-US/firefox/15.0/releasenotes/
- add -Os hack to fix a relocation error when linking on ppc (as was
  done in tb since 10..)
- garbage collect nsSound.cpp, the original one uses libcanberra
  properly and thus sndio.
- remove patch from #750620, merged upstream (mfbt/double-conversion)
- remove patches from #747257, merged upstream (gstreamer fix)
- remove patches from #691898, merged upstream (yarr jit ppc)
@
text
@d1 1
a1 1
$OpenBSD: patch-configure_in,v 1.24 2012/08/07 08:55:40 landry Exp $
d3 3
a5 3
--- configure.in.orig	Wed Aug 15 07:47:09 2012
+++ configure.in	Sun Aug 19 13:30:26 2012
@@@@ -5909,7 +5909,7 @@@@ if test "$MOZ_GSTREAMER"; then
@


1.24
log
@Update to firefox 14.0.1.

- see http://www.mozilla.org/en-US/firefox/14.0.1/releasenotes/
- enable H.264 video support through gstreamer. Mention that one needs to
  manually install gstreamer-ffmpeg. Not all videos/sites will work.
- backport cset from #776838 & #747257 for various gst fixes.
- backport cset from #750620 to fix ppc (and other exotic archs) build.
- backport cset from #752895 to fix packaging issues.
- remove patch-content_xslt_src_base_txDouble_cpp, useless since mozilla
  switched to mfbt/double-conversion.
- remove nss opening hack in Sync, it works fine without it.
- remove the -rpath hack, not needed since matthew's ld.so fix from 12/06
@
text
@d1 1
a1 1
$OpenBSD$
d3 3
a5 3
--- configure.in.orig	Tue Jul 24 11:02:39 2012
+++ configure.in	Tue Jul 24 11:02:51 2012
@@@@ -5825,7 +5825,7 @@@@ if test "$MOZ_GSTREAMER"; then
@


1.23
log
@Update to firefox 6.0.

See http://www.mozilla.com/en-US/firefox/6.0/releasenotes/.
Remove patches merged upstream (#648721, #651461, #643122, #634609 and
maybe others).
ok rpointel@@
@
text
@d1 13
a13 43
$OpenBSD: patch-configure_in,v 1.22 2011/06/28 05:43:57 landry Exp $
https://bugzilla.mozilla.org/show_bug.cgi?id=648721
--- configure.in.orig	Fri May 27 18:11:56 2011
+++ configure.in	Tue May 31 23:13:14 2011
@@@@ -2626,7 +2626,12 @@@@ ia64*-hpux*)
 	;;
 
 *-openbsd*)
-    DLL_SUFFIX=".so.1.0"
+    if test "$SO_VERSION"; then
+        DLL_SUFFIX=".so.$SO_VERSION"
+    else
+        DLL_SUFFIX=".so.1.0"
+    fi
+    MOZ_FIX_LINK_PATHS='-Wl,-rpath-link,$(LIBXUL_DIST)/bin -Wl,-rpath-link,$(prefix)/lib -Wl,-rpath-link,$(if $(X11BASE),$(X11BASE),/usr/X11R6)/lib'
     DSO_CFLAGS=''
     DSO_PIC_CFLAGS='-fPIC'
     DSO_LDOPTS='-shared -fPIC'
@@@@ -4451,7 +4456,7 @@@@ if test "$ac_cv_thread_keyword" = yes; then
       :
       ;;
     *)
-      AC_DEFINE(HAVE_THREAD_TLS_KEYWORD)
+dnl      AC_DEFINE(HAVE_THREAD_TLS_KEYWORD)
       ;;
   esac
 fi
@@@@ -5734,14 +5739,7 @@@@ dnl ==================================================
 
 # The GNOME component is built if one of 
 # gnome-vfs, gio, gconf or libnotify is available.
-if test "$MOZ_ENABLE_GCONF" -o \
-   "$MOZ_ENABLE_GNOMEVFS" -o \
-   "$MOZ_ENABLE_GIO" -o \
-   "$MOZ_ENABLE_LIBNOTIFY"; then
-    MOZ_ENABLE_GNOME_COMPONENT=1
-else
-    MOZ_ENABLE_GNOME_COMPONENT=
-fi
+MOZ_ENABLE_GNOME_COMPONENT=
 AC_SUBST(MOZ_ENABLE_GNOME_COMPONENT)
 
 dnl ========================================================
@


1.22
log
@Update to mozilla-firefox 5.0:

That's the first release following the new fast scheme of one major
release every 6 weeks..
Check out http://www.mozilla.com/en-US/firefox/5.0/releasenotes/ for
release notes. Note that it's still badly broken on sparc64, and
unlikely to be fixed soon... you still have www/firefox36.

Tested by (at least, probably forgetting some..) rpointel@@, pea@@,
ckuethe@@ and myself on amd64, bluhm@@ on i386 and ajacoutot@@ on macppc
(thanks!)
ok rpointel@@
@
text
@d1 1
a1 1
$OpenBSD: patch-configure_in,v 1.21 2011/05/02 15:08:28 jasper Exp $
@


1.21
log
@regen patches
@
text
@d1 1
a1 1
$OpenBSD: patch-configure_in,v 1.20 2011/04/15 11:43:46 landry Exp $
d3 3
a5 3
--- configure.in.orig	Thu Apr 14 07:28:22 2011
+++ configure.in	Mon May  2 17:07:42 2011
@@@@ -2676,7 +2676,8 @@@@ ia64*-hpux*)
d10 5
a14 1
+    DLL_SUFFIX='.so.$(if $(SO_VERSION),$(SO_VERSION),1.0)'
d19 1
a19 1
@@@@ -4525,7 +4526,7 @@@@ if test "$ac_cv_thread_keyword" = yes; then
d28 1
a28 1
@@@@ -5792,14 +5793,7 @@@@ dnl ==================================================
@


1.20
log
@Better patches for rpath-link as submitted upstream, cf
https://bugzilla.mozilla.org/show_bug.cgi?id=648721
While here grab js/src/Makefile.in patch from
https://bug638056.bugzilla.mozilla.org/attachment.cgi?id=520157
and add the hg rev of the commited sparc64 fix for opentype
@
text
@d1 1
a1 1
$OpenBSD: patch-configure_in,v 1.19 2011/03/30 21:39:14 landry Exp $
d3 2
a4 2
--- configure.in.orig	Sat Mar 19 00:33:33 2011
+++ configure.in	Mon Apr 11 10:48:46 2011
d15 1
a15 1
@@@@ -4524,7 +4525,7 @@@@ if test "$ac_cv_thread_keyword" = yes; then
d24 1
a24 1
@@@@ -5791,14 +5792,7 @@@@ dnl ==================================================
@


1.19
log
@Lo and behold, update to mozilla-firefox 4.0 !
Too much changes to list them, just enjoy it. Thanks to the ones who
tested the betas/rc.
ok jasper@@
@
text
@d1 5
a5 13
$OpenBSD: patch-configure_in,v 1.18 2010/06/28 21:24:22 landry Exp $
--- configure.in.orig	Thu Mar  3 23:11:21 2011
+++ configure.in	Thu Mar 10 15:39:57 2011
@@@@ -1229,7 +1229,7 @@@@ MOZ_PNG_LIBS='$(call EXPAND_LIBNAME_PATH,mozpng,$(DEPT
 MOZ_JS_STATIC_LIBS='-L$(LIBXUL_DIST)/bin -ljs_static'
 MOZ_JS_SHARED_LIBS='-L$(LIBXUL_DIST)/bin -lmozjs'
 DYNAMIC_XPCOM_LIBS='-L$(LIBXUL_DIST)/bin -lxpcom -lxpcom_core -lmozalloc'
-MOZ_FIX_LINK_PATHS='-Wl,-rpath-link,$(LIBXUL_DIST)/bin -Wl,-rpath-link,$(prefix)/lib'
+MOZ_FIX_LINK_PATHS='-Wl,-rpath-link,$(LIBXUL_DIST)/bin -Wl,-rpath-link,$(prefix)/lib -L$(LIBXUL_DIST)/bin'
 XPCOM_FROZEN_LDOPTS='-L$(LIBXUL_DIST)/bin -lxpcom -lmozalloc'
 LIBXUL_LIBS='$(XPCOM_FROZEN_LDOPTS) -lxul'
 XPCOM_GLUE_LDOPTS='$(LIBXUL_DIST)/lib/$(LIB_PREFIX)xpcomglue_s.$(LIB_SUFFIX) $(XPCOM_FROZEN_LDOPTS)'
@@@@ -2676,7 +2676,7 @@@@ ia64*-hpux*)
d10 2
a11 1
+    DLL_SUFFIX=".so.${SO_VERSION}"
d15 1
a15 1
@@@@ -4524,7 +4524,7 @@@@ if test "$ac_cv_thread_keyword" = yes; then
d24 1
a24 1
@@@@ -5791,14 +5791,7 @@@@ dnl ==================================================
@


1.18
log
@Update to mozilla-firefox 3.6.6. Fixes a bunch of MFSA, see
http://www.mozilla.org/security/known-vulnerabilities/firefox36.html
The new plugin sandboxing code is disabled because :
- it only supports binary blobs plugins we don't have
- it is an horrible maze of #ifdef linux-apple-win32 coming straight
  from an old version of chromium. Future versions should have better BSD
support..
tested by several on ports@@, thanks!
@
text
@d1 7
a7 7
$OpenBSD: patch-configure_in,v 1.17 2010/04/26 19:55:58 landry Exp $
--- configure.in.orig	Fri Jun 11 22:41:30 2010
+++ configure.in	Thu Jun 24 10:08:43 2010
@@@@ -1059,7 +1059,7 @@@@ MOZ_PNG_LIBS='$(call EXPAND_LIBNAME_PATH,mozpng,$(DEPT
 
 MOZ_JS_LIBS='-L$(LIBXUL_DIST)/bin -lmozjs'
 DYNAMIC_XPCOM_LIBS='-L$(LIBXUL_DIST)/bin -lxpcom -lxpcom_core'
d10 1
a10 1
 XPCOM_FROZEN_LDOPTS='-L$(LIBXUL_DIST)/bin -lxpcom'
d13 1
a13 1
@@@@ -2403,7 +2403,7 @@@@ case "$target" in
d22 20
a41 6
@@@@ -4132,9 +4132,9 @@@@ AC_CACHE_CHECK(for __thread keyword for TLS variables,
                             ac_cv_thread_keyword=yes,
                             ac_cv_thread_keyword=no)])
 LDFLAGS=$_SAVE_LDFLAGS
-if test "$ac_cv_thread_keyword" = yes; then
-  AC_DEFINE(HAVE_THREAD_TLS_KEYWORD)
d43 2
a44 3
+dnl if test "$ac_cv_thread_keyword" = yes; then
+dnl   AC_DEFINE(HAVE_THREAD_TLS_KEYWORD)
+dnl fi
d46 1
a46 2
 dnl End of C++ language/feature checks
 AC_LANG_C
@


1.17
log
@Update www/mozilla-firefox from 3.0.19 to 3.6.3, merging the wip done in
www/firefox36 mostly by martynas@@ and naddy@@.
Note that the java plugin from devel/jdk currently doesn't work with this
version of firefox, in the meantime users really needed it will have to
use www/firefox35.
ok naddy@@
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.1.1.1 2010/03/29 20:44:09 naddy Exp $
--- configure.in.orig	Tue Mar 16 10:53:59 2010
+++ configure.in	Sat Mar 27 16:32:01 2010
@@@@ -1063,7 +1063,7 @@@@ MOZ_PNG_LIBS='$(call EXPAND_LIBNAME_PATH,mozpng,$(DEPT
d13 1
a13 1
@@@@ -2404,7 +2404,7 @@@@ case "$target" in
d22 1
a22 1
@@@@ -4133,9 +4133,9 @@@@ AC_CACHE_CHECK(for __thread keyword for TLS variables,
@


1.16
log
@mozilla-firefox-3.0.11
@
text
@d1 13
a13 4
$OpenBSD: patch-configure_in,v 1.15 2008/11/20 23:41:32 martynas Exp $
--- configure.in.orig	Fri Apr 17 21:10:52 2009
+++ configure.in	Thu Jun 11 16:09:20 2009
@@@@ -2223,7 +2223,7 @@@@ case "$target" in
d22 10
a31 7
@@@@ -4047,7 +4047,7 @@@@ MOZ_ARG_WITH_BOOL(system-nss,
     _USE_SYSTEM_NSS=1 )
 
 if test -n "$_USE_SYSTEM_NSS"; then
-    AM_PATH_NSS(3.12.0, [MOZ_NATIVE_NSS=1], [MOZ_NATIVE_NSS=])
+    AM_PATH_NSS(3.12, [MOZ_NATIVE_NSS=1], [MOZ_NATIVE_NSS=])
 fi
d33 2
a34 1
 if test -n "$MOZ_NATIVE_NSS"; then
@


1.15
log
@it is the right time to update to mozilla-firefox-3.0.4, which has
been tested good enough, and i've fixed all the issues i'm aware
of.  furthermore 2.0 branch has basically reached eol, since there
will be only one minor update (2.0.0.19)
discussed with kurt@@, naddy@@ and porters
pkgname change handling help naddy@@
ok naddy@@
@
text
@d1 3
a3 12
$OpenBSD: patch-configure_in,v 1.2 2008/09/24 19:25:40 martynas Exp $
--- configure.in.orig	Thu Aug 14 13:00:32 2008
+++ configure.in	Tue Sep 23 20:37:31 2008
@@@@ -128,7 +128,7 @@@@ LIBGNOME_VERSION=2.0
 STARTUP_NOTIFICATION_VERSION=0.8
 DBUS_VERSION=0.60
 LCMS_VERSION=1.17
-SQLITE_VERSION=3.5.9
+SQLITE_VERSION=3.5
 
 MSMANIFEST_TOOL=
 
@


1.14
log
@security update to mozilla-firefox-2.0.0.18.  MFSA 2008-58; MFSA
2008-57; MFSA 2008-56; MFSA 2008-55; MFSA 2008-54; MFSA 2008-53;
MFSA 2008-52; MFSA 2008-50; MFSA 2008-49; MFSA 2008-48; MFSA 2008-47.
http://www.mozilla.org/security/known-vulnerabilities/firefox20.html#firefox2.0.0.18
ok naddy@@
@
text
@d1 13
a13 4
$OpenBSD: patch-configure_in,v 1.13 2008/02/11 18:13:44 bernd Exp $
--- configure.in.orig	Sun Oct 19 19:14:06 2008
+++ configure.in	Wed Nov 12 21:01:21 2008
@@@@ -2030,7 +2030,7 @@@@ case "$target" in
d22 2
a23 11
@@@@ -3880,7 +3880,7 @@@@ _SAVE_LIBS=$LIBS
 CFLAGS="$ZLIB_CFLAGS $CFLAGS"
 LDFLAGS="$ZLIB_LIBS -lz $LDFLAGS"
 if test -n "${PNG_DIR}" -a "${PNG_DIR}" != "yes"; then
-    CFLAGS="-I${PNG_DIR}/include $CFLAGS"
+    CFLAGS="-I${PNG_DIR}/include/libpng $CFLAGS"
     LDFLAGS="-L${PNG_DIR}/lib $LDFLAGS"
 fi
 if test -z "$PNG_DIR" -o "$PNG_DIR" = no; then
@@@@ -3910,7 +3910,7 @@@@ LDFLAGS=$_SAVE_LDFLAGS
 LIBS=$_SAVE_LIBS
d25 3
a27 4
 if test "${PNG_DIR}" -a -d "${PNG_DIR}" -a "$SYSTEM_PNG" = 1; then
-    PNG_CFLAGS="-I${PNG_DIR}/include"
+    PNG_CFLAGS="-I${PNG_DIR}/include/libpng"
     PNG_LIBS="-L${PNG_DIR}/lib ${PNG_LIBS}"
d30 1
@


1.13
log
@Security update to mozilla-firefox-2.0.0.12.

Fixes multiple vulnerabilities:

CVE-2008-0412
CVE-2008-0413
CVE-2008-0414
CVE-2008-0415
CVE-2008-0419
CVE-2008-0591
CVE-2008-0593

More infos:
http://secunia.com/advisories/28758/

Tested by some people on ports@@. Thanks!

ok martynas@@, laurent@@, steven@@
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.12 2007/11/28 20:22:25 martynas Exp $
--- configure.in.orig	Tue Dec 18 22:34:10 2007
+++ configure.in	Fri Feb  8 13:28:28 2008
@@@@ -2028,7 +2028,7 @@@@ case "$target" in
d13 1
a13 1
@@@@ -3878,7 +3878,7 @@@@ _SAVE_LIBS=$LIBS
d22 1
a22 1
@@@@ -3908,7 +3908,7 @@@@ LDFLAGS=$_SAVE_LDFLAGS
@


1.12
log
@- security update to mozilla-firefox-2.0.0.10:
http://www.mozilla.org/projects/security/known-vulnerabilities.html#firefox2.0.0.10
- fix canvas.drawImage regression.
ok kurt@@, kili@@
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.11 2007/10/23 20:13:26 martynas Exp $
--- configure.in.orig	Thu Nov  8 21:13:08 2007
+++ configure.in	Tue Nov 27 11:43:26 2007
@@@@ -1994,7 +1994,7 @@@@ case "$target" in
d13 1
a13 1
@@@@ -3892,7 +3892,7 @@@@ _SAVE_LIBS=$LIBS
d22 1
a22 1
@@@@ -3922,7 +3922,7 @@@@ LDFLAGS=$_SAVE_LDFLAGS
@


1.11
log
@security update to mozilla-firefox-2.0.0.8:
http://www.mozilla.org/projects/security/known-vulnerabilities.html#firefox2.0.0.8
ok kurt@@, naddy@@
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.10 2007/06/01 08:03:42 martynas Exp $
--- configure.in.orig	Thu Sep 13 06:48:33 2007
+++ configure.in	Fri Oct 19 14:29:21 2007
@@@@ -1979,7 +1979,7 @@@@ case "$target" in
d13 1
a13 1
@@@@ -3877,7 +3877,7 @@@@ _SAVE_LIBS=$LIBS
d22 1
a22 1
@@@@ -3907,7 +3907,7 @@@@ LDFLAGS=$_SAVE_LDFLAGS
@


1.10
log
@security update to mozilla-firefox-2.0.0.4
http://www.mozilla.org/projects/security/known-vulnerabilities.html#firefox2.0.0.4

- WANTLIB for xenocara;
- use the combination of find(1) and install(1) to install the
{DATA,DIST}FILES, as suggested by kurt@@;
- remove the two patches that are already upstream;
- fmt;

ok kurt@@, naddy@@
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.9 2007/03/01 22:46:06 robert Exp $
--- configure.in.orig	Tue Apr  3 18:40:02 2007
+++ configure.in	Thu May 31 15:51:10 2007
@@@@ -1974,7 +1974,7 @@@@ case "$target" in
d13 1
a13 1
@@@@ -3872,7 +3872,7 @@@@ _SAVE_LIBS=$LIBS
d22 1
a22 1
@@@@ -3902,7 +3902,7 @@@@ LDFLAGS=$_SAVE_LDFLAGS
@


1.9
log
@- update to version 2.0.0.2 and apply several security fixes,
therefore bump the PKGNAME to p0 now;
- enable official branding by default
- fix some WANTLIB markers

work done by Martynas Venckus; thanks.

tested by many many people; ok pvalchev@@
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.8 2007/01/12 21:46:17 kurt Exp $
--- configure.in.orig	Fri Sep 15 16:13:01 2006
+++ configure.in	Fri Nov  3 22:36:05 2006
@@@@ -1931,7 +1931,7 @@@@ case "$target" in
d13 1
a13 1
@@@@ -3804,7 +3804,7 @@@@ _SAVE_LIBS=$LIBS
d22 1
a22 1
@@@@ -3834,7 +3834,7 @@@@ LDFLAGS=$_SAVE_LDFLAGS
@


1.9.2.1
log
@MFC:
security update to mozilla-firefox-2.0.0.4
http://www.mozilla.org/projects/security/known-vulnerabilities.html#firefox2.0.0.4

- use the combination of find(1) and install(1) to install the
{DATA,DIST}FILES, as suggested by kurt@@;
- remove the two patches that are already upstream;
- fmt;
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.9 2007/03/01 22:46:06 robert Exp $
--- configure.in.orig	Tue Apr  3 17:40:02 2007
+++ configure.in	Sun Jun 17 12:10:08 2007
@@@@ -1974,7 +1974,7 @@@@ case "$target" in
d13 1
a13 1
@@@@ -3872,7 +3872,7 @@@@ _SAVE_LIBS=$LIBS
d22 1
a22 1
@@@@ -3902,7 +3902,7 @@@@ LDFLAGS=$_SAVE_LDFLAGS
@


1.8
log
@- update to 2.0.0.1 from Martynas Venckus <martynas at altroot.org>
- add a -devel sub-package for vlc plugin
input and testing from many - thanks! okay naddy@@ pvalchev@@
@
text
@d1 1
a1 1
$OpenBSD: patch-configure_in,v 1.7 2006/07/31 09:32:19 bernd Exp $
a3 15
@@@@ -1317,10 +1317,10 @@@@ dnl Get mozilla version from central mil
 MOZILLA_VERSION=`$PERL $srcdir/config/milestone.pl -topsrcdir $srcdir`
 
 dnl Get version of various core apps from the version files.
-FIREFOX_VERSION=`cat $topsrcdir/browser/config/version.txt`
-THUNDERBIRD_VERSION=`cat $topsrcdir/mail/config/version.txt`
-SUNBIRD_VERSION=`cat $topsrcdir/calendar/sunbird/config/version.txt`
-SEAMONKEY_VERSION=`cat $topsrcdir/xpfe/bootstrap/version.txt`
+FIREFOX_VERSION=`cat ./browser/config/version.txt`
+THUNDERBIRD_VERSION=`cat ./mail/config/version.txt`
+SUNBIRD_VERSION=`cat ./calendar/sunbird/config/version.txt`
+SEAMONKEY_VERSION=`cat ./xpfe/bootstrap/version.txt`
 
 AC_DEFINE_UNQUOTED(MOZILLA_VERSION,"$MOZILLA_VERSION")
 AC_DEFINE_UNQUOTED(MOZILLA_VERSION_U,$MOZILLA_VERSION)
a30 9
@@@@ -4243,7 +4243,7 @@@@ suite)
 
 browser)
   MOZ_APP_NAME=firefox
-  MOZ_APP_DISPLAYNAME=BonEcho
+  MOZ_APP_DISPLAYNAME=FirefoxCommunityEdition
   MOZ_XUL_APP=1
   MOZ_PHOENIX=1
   MOZ_SAFE_BROWSING=1
@


1.7
log
@Security update to mozilla-firefox-1.5.0.5.

This update fixes multiple security vulnerabilities.

For detailed information see:

http://www.mozilla.org/projects/security/known-vulnerabilities.html#firefox1.5.0.5

ok steven@@
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.6 2006/05/05 10:14:21 bernd Exp $
--- configure.in.orig	Thu Jun 15 15:29:32 2006
+++ configure.in	Thu Jul 27 10:21:22 2006
@@@@ -1291,9 +1291,9 @@@@ dnl Get mozilla version from central mil
d10 1
d14 1
d19 1
a19 1
@@@@ -1863,7 +1863,7 @@@@ case "$target" in
d28 1
a28 1
@@@@ -3647,7 +3647,7 @@@@ _SAVE_LIBS=$LIBS
d37 1
a37 1
@@@@ -3677,7 +3677,7 @@@@ LDFLAGS=$_SAVE_LDFLAGS
d46 1
a46 1
@@@@ -4079,7 +4079,7 @@@@ suite)
d50 1
a50 1
-  MOZ_APP_DISPLAYNAME=DeerPark
d54 1
a54 1
   MOZ_APP_VERSION=$FIREFOX_VERSION
@


1.6
log
@Update to 1.5.0.3. Security fixes inside...

More info:

CVE-2006-1993
http://secunia.com/advisories/19802/

tested by many
"go ahead" jolan@@
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.5 2005/12/20 23:44:00 bernd Exp $
--- configure.in.orig	Sun Feb 26 00:07:41 2006
+++ configure.in	Wed May  3 13:26:33 2006
@@@@ -1287,9 +1287,9 @@@@ dnl Get mozilla version from central mil
d17 1
a17 1
@@@@ -1859,7 +1859,7 @@@@ case "$target" in
d26 1
a26 1
@@@@ -3643,7 +3643,7 @@@@ _SAVE_LIBS=$LIBS
d35 1
a35 1
@@@@ -3673,7 +3673,7 @@@@ LDFLAGS=$_SAVE_LDFLAGS
d44 1
a44 1
@@@@ -4075,7 +4075,7 @@@@ suite)
@


1.5
log
@Update to Firefox 1.5.

Team work by wilfried@@, kurt@@ and me.

Tested by many. Thanks a lot!

ok kurt@@ krw@@ jolan@@ ian@@ pvalchev@@
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.5 2005/04/09 08:11:19 wilfried Exp $
--- configure.in.orig	Tue Oct  4 07:53:49 2005
+++ configure.in	Thu Dec  1 18:37:21 2005
@@@@ -1225,9 +1225,9 @@@@ dnl Get mozilla version from central mil
d17 1
a17 1
@@@@ -1801,7 +1801,7 @@@@ case "$target" in
d26 1
a26 1
@@@@ -3582,7 +3582,7 @@@@ _SAVE_LIBS=$LIBS
d35 1
a35 1
@@@@ -3612,7 +3612,7 @@@@ LDFLAGS=$_SAVE_LDFLAGS
d44 1
a44 1
@@@@ -4013,7 +4013,7 @@@@ suite)
@


1.5.2.1
log
@MFC:
Update to 1.5.0.3. Security fixes inside...

More info:
CVE-2006-1993
http://secunia.com/advisories/19802/
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.5 2005/12/20 23:44:00 bernd Exp $
--- configure.in.orig	Sun Feb 26 00:07:41 2006
+++ configure.in	Sun May  7 03:25:48 2006
@@@@ -1287,9 +1287,9 @@@@ dnl Get mozilla version from central mil
d17 1
a17 1
@@@@ -1859,7 +1859,7 @@@@ case "$target" in
d26 1
a26 1
@@@@ -3643,7 +3643,7 @@@@ _SAVE_LIBS=$LIBS
d35 1
a35 1
@@@@ -3673,7 +3673,7 @@@@ LDFLAGS=$_SAVE_LDFLAGS
d44 1
a44 1
@@@@ -4075,7 +4075,7 @@@@ suite)
@


1.5.2.2
log
@MFC:
Security update to mozilla-firefox-1.5.0.5.

This update fixes multiple security vulnerabilities.

For detailed information see:

http://www.mozilla.org/projects/security/known-vulnerabilities.html#firefox1.5.0.5
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.5.2.1 2006/05/07 19:52:04 sturm Exp $
--- configure.in.orig	Thu Jun 15 15:29:32 2006
+++ configure.in	Wed Aug  2 20:14:44 2006
@@@@ -1291,9 +1291,9 @@@@ dnl Get mozilla version from central mil
d17 1
a17 1
@@@@ -1863,7 +1863,7 @@@@ case "$target" in
d26 1
a26 1
@@@@ -3647,7 +3647,7 @@@@ _SAVE_LIBS=$LIBS
d35 1
a35 1
@@@@ -3677,7 +3677,7 @@@@ LDFLAGS=$_SAVE_LDFLAGS
d44 1
a44 1
@@@@ -4079,7 +4079,7 @@@@ suite)
@


1.4
log
@- bump major shlib version
- move INSTALL/DEINSTALL code to PLIST
- remove unused ldap config/patches
@
text
@d1 17
a17 4
$OpenBSD: patch-configure_in,v 1.3 2005/01/13 15:57:26 wilfried Exp $
--- configure.in.orig	Sun Oct 31 08:17:58 2004
+++ configure.in	Wed Apr  6 19:06:20 2005
@@@@ -1349,7 +1349,7 @@@@ case "$target" in
d26 1
a26 1
@@@@ -3103,7 +3103,7 @@@@ _SAVE_LIBS=$LIBS
d29 1
a29 1
 if test -n "${PNG_DIR}"; then
d35 1
a35 1
@@@@ -3133,7 +3133,7 @@@@ LDFLAGS=$_SAVE_LDFLAGS
d44 9
@


1.3
log
@fix system png include path
@
text
@d1 1
a1 1
$OpenBSD$
d3 10
a12 1
+++ configure.in	Fri Jan  7 11:44:14 2005
@


1.3.2.1
log
@Sync the port with the current one. It takes the port to firefox 1.0.4.
It fixes a lot of security vulnerabilities. For more information please visit:
http://www.mozilla.org/projects/security/known-vulnerabilities.html

ok brad@@
@
text
@d3 1
a3 10
+++ configure.in	Wed Apr  6 19:06:20 2005
@@@@ -1349,7 +1349,7 @@@@ case "$target" in
 	;;
 
 *-openbsd*)
-    DLL_SUFFIX=".so.1.0"
+    DLL_SUFFIX=".so.${SO_VERSION}"
     DSO_CFLAGS=''
     DSO_PIC_CFLAGS='-fPIC'
     DSO_LDOPTS='-shared -fPIC'
@


1.2
log
@mozilla-firefox-1.0; based on work by wilfried/robert/naddy
@
text
@d1 20
a20 32
$OpenBSD: patch-configure_in,v 1.1 2004/02/15 19:37:25 wilfried Exp $
--- configure.in.orig	2003-12-11 17:30:36.000000000 -0600
+++ configure.in	2004-02-11 22:49:28.000000000 -0600
@@@@ -1286,12 +1286,11 @@@@ case "$target" in
     DLL_SUFFIX=".so.1.0"
     DSO_CFLAGS=''
     DSO_PIC_CFLAGS='-fPIC'
-    DSO_LDOPTS='-shared -h $@@'
-    MKSHLIB='$(LD) $(DSO_LDOPTS) -o $@@'
-    MKCSHLIB='$(LD) $(DSO_LDOPTS) -o $@@'
-    if $CC -E - -dM </dev/null | grep -v __ELF__ >/dev/null; then
-	DSO_LDOPTS="-Bshareable /usr/lib/c++rt0.o"
-    fi
+    DSO_LDOPTS='-shared -fPIC'
+    MKSHLIB='$(CXX) $(DSO_LDOPTS) -o $@@'
+    MKCSHLIB='$(CC) $(DSO_LDOPTS) -o $@@'
+    MKSHLIB_FORCE_ALL=''
+    MKSHLIB_UNFORCE_ALL=''
     if test "$LIBRUNPATH"; then
 	DSO_LDOPTS="-R$LIBRUNPATH $DSO_LDOPTS"
     fi
@@@@ -2159,9 +2158,8 @@@@ then
 			AC_DEFINE(_THREAD_SAFE)
 			dnl -pthread links in -lc_r, so don't specify it explicitly.
 			if test "$ac_cv_have_dash_pthread" = "yes"; then
-				_PTHREAD_LDFLAGS=""
-			else
-				_PTHREAD_LDFLAGS="-lc_r"
+				_PTHREAD_LDFLAGS="-pthread"
+                LDFLAGS="${_PTHREAD_LDFLAGS} ${LDFLAGS}"
 			fi
 			;;
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
$OpenBSD: patch-configure_in,v 1.2 2004/01/18 11:51:10 wilfried Exp $
@


1.1.1.1
log
@import of mozilla firefox 0.8
@
text
@@
