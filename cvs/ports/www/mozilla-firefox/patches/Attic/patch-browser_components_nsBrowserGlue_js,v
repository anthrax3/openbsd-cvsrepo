head	1.5;
access;
symbols
	OPENBSD_4_9:1.3.0.4
	OPENBSD_4_9_BASE:1.3
	OPENBSD_4_8:1.3.0.2
	OPENBSD_4_8_BASE:1.3
	OPENBSD_4_7:1.2.0.6
	OPENBSD_4_7_BASE:1.2
	OPENBSD_4_6:1.2.0.4
	OPENBSD_4_6_BASE:1.2
	OPENBSD_4_5:1.2.0.2
	OPENBSD_4_5_BASE:1.2;
locks; strict;
comment	@# @;


1.5
date	2011.06.19.21.41.41;	author landry;	state dead;
branches;
next	1.4;

1.4
date	2011.03.30.21.39.14;	author landry;	state Exp;
branches;
next	1.3;

1.3
date	2010.04.26.19.55.58;	author landry;	state Exp;
branches;
next	1.2;

1.2
date	2008.12.18.19.27.13;	author martynas;	state Exp;
branches;
next	1.1;

1.1
date	2008.11.20.23.41.32;	author martynas;	state Exp;
branches;
next	;


desc
@@


1.5
log
@Remove patches - let's stick to the sane defaults upstream provides.
@
text
@$OpenBSD: patch-browser_components_nsBrowserGlue_js,v 1.4 2011/03/30 21:39:14 landry Exp $
--- browser/components/nsBrowserGlue.js.orig	Tue Jan 11 04:25:41 2011
+++ browser/components/nsBrowserGlue.js	Sat Jan 15 01:03:01 2011
@@@@ -397,9 +397,6 @@@@ BrowserGlue.prototype = {
 
   // Browser startup complete. All initial windows have opened.
   _onBrowserStartup: function BG__onBrowserStartup() {
-    // Show about:rights notification, if needed.
-    if (this._shouldShowRights())
-      this._showRightsNotification();
 
     // Show update notification, if needed.
     if (Services.prefs.prefHasUserValue("app.update.postupdate"))
@


1.4
log
@Lo and behold, update to mozilla-firefox 4.0 !
Too much changes to list them, just enjoy it. Thanks to the ones who
tested the betas/rc.
ok jasper@@
@
text
@d1 1
a1 1
$OpenBSD: patch-browser_components_nsBrowserGlue_js,v 1.3 2010/04/26 19:55:58 landry Exp $
@


1.3
log
@Update www/mozilla-firefox from 3.0.19 to 3.6.3, merging the wip done in
www/firefox36 mostly by martynas@@ and naddy@@.
Note that the java plugin from devel/jdk currently doesn't work with this
version of firefox, in the meantime users really needed it will have to
use www/firefox35.
ok naddy@@
@
text
@d1 5
a5 4
$OpenBSD: patch-browser_components_nsBrowserGlue_js,v 1.1.1.1 2010/03/29 20:44:09 naddy Exp $
--- browser/components/nsBrowserGlue.js.orig	Wed Jan  6 05:35:10 2010
+++ browser/components/nsBrowserGlue.js	Sun Jan 10 17:49:03 2010
@@@@ -307,10 +307,6 @@@@ BrowserGlue.prototype = {
d7 1
a7 2
   _onBrowserStartup: function()
   {
a10 83
-
     // If new add-ons were installed during startup open the add-ons manager.
     if (this._prefs.prefHasUserValue(PREF_EM_NEW_ADDONS_LIST)) {
       var args = Cc["@@mozilla.org/supports-array;1"].
@@@@ -464,79 +460,6 @@@@ BrowserGlue.prototype = {
     }
   },
 
-  /*
-   * _shouldShowRights - Determines if the user should be shown the
-   * about:rights notification. The notification should *not* be shown if
-   * we've already shown the current version, or if the override pref says to
-   * never show it. The notification *should* be shown if it's never been seen
-   * before, if a newer version is available, or if the override pref says to
-   * always show it.
-   */
-  _shouldShowRights : function () {
-    // Look for an unconditional override pref. If set, do what it says.
-    // (true --> never show, false --> always show)
-    try {
-      return !this._prefs.getBoolPref("browser.rights.override");
-    } catch (e) { }
-    // Ditto, for the legacy EULA pref.
-    try {
-      return !this._prefs.getBoolPref("browser.EULA.override");
-    } catch (e) { }
-
-#ifndef OFFICIAL_BUILD
-    // Non-official builds shouldn't shouldn't show the notification.
-    return false;
-#endif
-
-    // Look to see if the user has seen the current version or not.
-    var currentVersion = this._prefs.getIntPref("browser.rights.version");
-    try {
-      return !this._prefs.getBoolPref("browser.rights." + currentVersion + ".shown");
-    } catch (e) { }
-
-    // Legacy: If the user accepted a EULA, we won't annoy them with the
-    // equivalent about:rights page until the version changes.
-    try {
-      return !this._prefs.getBoolPref("browser.EULA." + currentVersion + ".accepted");
-    } catch (e) { }
-
-    // We haven't shown the notification before, so do so now.
-    return true;
-  },
-
-  _showRightsNotification : function () {
-    // Stick the notification onto the selected tab of the active browser window.
-    var win = this.getMostRecentBrowserWindow();
-    var browser = win.gBrowser; // for closure in notification bar callback
-    var notifyBox = browser.getNotificationBox();
-
-    var brandBundle  = this._bundleService.createBundle("chrome://branding/locale/brand.properties");
-    var rightsBundle = this._bundleService.createBundle("chrome://global/locale/aboutRights.properties");
-
-    var buttonLabel      = rightsBundle.GetStringFromName("buttonLabel");
-    var buttonAccessKey  = rightsBundle.GetStringFromName("buttonAccessKey");
-    var productName      = brandBundle.GetStringFromName("brandFullName");
-    var notifyRightsText = rightsBundle.formatStringFromName("notifyRightsText", [productName], 1);
-    
-    var buttons = [
-                    {
-                      label:     buttonLabel,
-                      accessKey: buttonAccessKey,
-                      popup:     null,
-                      callback: function(aNotificationBar, aButton) {
-                        browser.selectedTab = browser.addTab("about:rights");
-                      }
-                    }
-                  ];
-
-    // Set pref to indicate we've shown the notification.
-    var currentVersion = this._prefs.getIntPref("browser.rights.version");
-    this._prefs.setBoolPref("browser.rights." + currentVersion + ".shown", true);
-
-    var box = notifyBox.appendNotification(notifyRightsText, "about-rights", null, notifyBox.PRIORITY_INFO_LOW, buttons);
-    box.persistence = 3; // arbitrary number, just so bar sticks around for a bit
-  },
-  
   _showPluginUpdatePage : function () {
     this._prefs.setBoolPref(PREF_PLUGINS_NOTIFYUSER, false);
d12 2
@


1.2
log
@security update to mozilla-firefox-3.0.5.  MFSA 2008-69; MFSA
2008-68; MFSA 2008-67; MFSA 2008-66; MFSA 2008-65; MFSA 2008-64;
MFSA 2008-63; MFSA 2008-60.
tested by sthen@@ and naddy@@.  ok naddy@@
@
text
@d1 4
a4 4
$OpenBSD: patch-browser_components_nsBrowserGlue_js,v 1.1 2008/11/20 23:41:32 martynas Exp $
--- browser/components/nsBrowserGlue.js.orig	Wed Dec 17 07:51:28 2008
+++ browser/components/nsBrowserGlue.js	Wed Dec 17 07:45:42 2008
@@@@ -221,10 +221,6 @@@@ BrowserGlue.prototype = {
a11 2
     var prefBranch = Cc["@@mozilla.org/preferences-service;1"].
                      getService(Ci.nsIPrefBranch);
d13 3
a15 3
@@@@ -363,81 +359,6 @@@@ BrowserGlue.prototype = {
       }
       break;
d17 2
a18 2
-  },
-
d61 1
a61 1
-    var win = this._getMostRecentBrowserWindow();
d65 7
a71 9
-    var bundleService = Cc["@@mozilla.org/intl/stringbundle;1"].
-                        getService(Ci.nsIStringBundleService);
-    var brandBundle  = bundleService.createBundle("chrome://branding/locale/brand.properties");
-    var rightsBundle = bundleService.createBundle("chrome://browser/locale/aboutRights.properties");
-
-    var buttonLabel     = rightsBundle.GetStringFromName("buttonLabel");
-    var buttonAccessKey = rightsBundle.GetStringFromName("buttonAccessKey");
-    var productName     = brandBundle.GetStringFromName("brandFullName");
-    var notifyText      = rightsBundle.formatStringFromName("notifyText", [productName], 1);
d88 6
a93 3
-    var box = notifyBox.appendNotification(notifyText, "about-rights", null, notifyBox.PRIORITY_INFO_LOW, buttons);
-    box.persistence = 3; // // arbitrary number, just so bar sticks around for a bit
   },
a94 1
   // returns the (cached) Sanitizer constructor
@


1.1
log
@it is the right time to update to mozilla-firefox-3.0.4, which has
been tested good enough, and i've fixed all the issues i'm aware
of.  furthermore 2.0 branch has basically reached eol, since there
will be only one minor update (2.0.0.19)
discussed with kurt@@, naddy@@ and porters
pkgname change handling help naddy@@
ok naddy@@
@
text
@d1 6
a6 6
$OpenBSD: patch-browser_components_nsBrowserGlue_js,v 1.2 2008/09/24 19:25:40 martynas Exp $
--- browser/components/nsBrowserGlue.js.orig	Tue Sep 16 22:07:25 2008
+++ browser/components/nsBrowserGlue.js	Tue Sep 23 20:40:15 2008
@@@@ -175,33 +175,6 @@@@ BrowserGlue.prototype = {
   // profile startup handler (contains profile initialization routines)
   _onProfileStartup: function() 
d8 3
a10 1
-    // Check to see if the EULA must be shown on startup
d12 41
a52 3
-    var prefBranch = Cc["@@mozilla.org/preferences-service;1"].
-                     getService(Ci.nsIPrefBranch);
-    var mustDisplayEULA = false;
d54 43
a96 24
-      mustDisplayEULA = !prefBranch.getBoolPref("browser.EULA.override");
-    } catch (e) {
-      // Pref might not exist
-    }
-
-    // Make sure it hasn't already been accepted
-    if (mustDisplayEULA) {
-      try {
-        var EULAVersion = prefBranch.getIntPref("browser.EULA.version");
-        mustDisplayEULA = !prefBranch.getBoolPref("browser.EULA." + EULAVersion + ".accepted");
-      } catch(ex) {
-      }
-    }
-
-    if (mustDisplayEULA) {
-      var ww2 = Cc["@@mozilla.org/embedcomp/window-watcher;1"].
-                getService(Ci.nsIWindowWatcher);
-      ww2.openWindow(null, "chrome://browser/content/EULA.xul", 
-                     "_blank", "chrome,centerscreen,modal,resizable=yes", null);
-    }
-
     this.Sanitizer.onStartup();
     // check if we're in safe mode
     var app = Cc["@@mozilla.org/xre/app-info;1"].getService(Ci.nsIXULAppInfo).
@

