head	1.2;
access;
symbols
	OPENBSD_4_1:1.1.0.6
	OPENBSD_4_1_BASE:1.1
	OPENBSD_4_0:1.1.0.4
	OPENBSD_4_0_BASE:1.1
	OPENBSD_3_9:1.1.0.2
	OPENBSD_3_9_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2007.03.17.18.54.40;	author pedro;	state dead;
branches;
next	1.1;

1.1
date	2005.09.06.16.51.44;	author pedro;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Remove ports that still lack a proper update to Lua 5.1 after more than
a year, okay sturm@@
@
text
@$OpenBSD: patch-src_xavante_server_lua,v 1.1 2005/09/06 16:51:44 pedro Exp $
--- src/xavante/server.lua.orig	Wed Jun 22 15:24:49 2005
+++ src/xavante/server.lua	Thu Aug 18 13:50:52 2005
@@@@ -14,6 +14,7 @@@@
 module ("xavante")
 
 require "copas"
+require "posix"
 require "xavante.httpd"
 
 -- Meta information is public even begining with an "_"
@@@@ -49,6 +50,11 @@@@ function HTTP(config)
     config.server = config.server or {host = "*", port = 80}
     
     xavante.httpd.register(config.server.host, config.server.port, _VERSION)
+
+    -- Drop privileges.
+    assert(posix.setgid(552))
+    assert(posix.setuid(552))
+
     if config.defaultHost then
         _addRules(config.defaultHost.rules, "_")
     end
@


1.1
log
@Privilege separation support for Xavante, okay jolan@@
@
text
@d1 1
a1 1
$OpenBSD$
@

