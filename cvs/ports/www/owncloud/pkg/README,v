head	1.47;
access;
symbols
	OPENBSD_6_1:1.45.0.2
	OPENBSD_6_1_BASE:1.45
	OPENBSD_6_0:1.44.0.2
	OPENBSD_6_0_BASE:1.44
	OPENBSD_5_9:1.43.0.2
	OPENBSD_5_9_BASE:1.43
	OPENBSD_5_8:1.39.0.4
	OPENBSD_5_8_BASE:1.39
	OPENBSD_5_7:1.33.0.2
	OPENBSD_5_7_BASE:1.33
	OPENBSD_5_6:1.28.0.2
	OPENBSD_5_6_BASE:1.28
	OPENBSD_5_5:1.20.0.2
	OPENBSD_5_5_BASE:1.20
	OPENBSD_5_4:1.17.0.2
	OPENBSD_5_4_BASE:1.17
	OPENBSD_5_3:1.12.0.2
	OPENBSD_5_3_BASE:1.12
	OPENBSD_5_2:1.8.0.2
	OPENBSD_5_2_BASE:1.8
	ajacoutot_20120315:1.1.1.1
	ajacoutot:1.1.1;
locks; strict;
comment	@# @;


1.47
date	2017.04.28.10.41.45;	author ajacoutot;	state Exp;
branches;
next	1.46;
commitid	kSRxgUj8eSASIZpf;

1.46
date	2017.04.28.10.20.38;	author ajacoutot;	state Exp;
branches;
next	1.45;
commitid	E837o8dWG90knTfE;

1.45
date	2016.07.30.14.25.37;	author ajacoutot;	state Exp;
branches;
next	1.44;
commitid	sISn6meSLM2fbfeC;

1.44
date	2016.04.26.12.05.19;	author ajacoutot;	state Exp;
branches;
next	1.43;
commitid	7tlV0q2JayuNVsl1;

1.43
date	2015.12.30.08.53.07;	author ajacoutot;	state Exp;
branches;
next	1.42;
commitid	KPS5JjAiubB5JNFM;

1.42
date	2015.12.30.06.44.34;	author ajacoutot;	state Exp;
branches;
next	1.41;
commitid	sgcZTxlrBXwe1Qj1;

1.41
date	2015.12.30.06.37.02;	author ajacoutot;	state Exp;
branches;
next	1.40;
commitid	Czk9v51SREOzUbB0;

1.40
date	2015.11.26.07.38.34;	author ajacoutot;	state Exp;
branches;
next	1.39;
commitid	XeHWJmVfVJ1xbcdg;

1.39
date	2015.07.30.16.04.38;	author kirby;	state Exp;
branches;
next	1.38;
commitid	CobrGyRqI8XXTuwy;

1.38
date	2015.07.17.17.39.54;	author ajacoutot;	state Exp;
branches;
next	1.37;
commitid	PtcJ7vxXu3OKwMMa;

1.37
date	2015.07.09.10.22.43;	author ajacoutot;	state Exp;
branches;
next	1.36;
commitid	7mnumw2p2KKwcH7F;

1.36
date	2015.07.09.08.09.06;	author ajacoutot;	state Exp;
branches;
next	1.35;
commitid	sNI1i9Babm3lY9Pd;

1.35
date	2015.04.04.15.31.44;	author ajacoutot;	state Exp;
branches;
next	1.34;
commitid	77HKf1TX4pboNlll;

1.34
date	2015.03.15.08.49.10;	author ajacoutot;	state Exp;
branches;
next	1.33;
commitid	4aevEx9F7sgDyQ3Z;

1.33
date	2014.12.01.10.16.06;	author ajacoutot;	state Exp;
branches;
next	1.32;
commitid	98jGDuwwze60ZMKx;

1.32
date	2014.11.16.22.15.02;	author sthen;	state Exp;
branches;
next	1.31;
commitid	Sk5gAOPcpXgRSLJf;

1.31
date	2014.09.14.05.58.07;	author ajacoutot;	state Exp;
branches;
next	1.30;
commitid	Wm0mDRCXhQhfZWj1;

1.30
date	2014.08.27.06.58.00;	author ajacoutot;	state Exp;
branches;
next	1.29;
commitid	LV57HYD4QXzcqbWn;

1.29
date	2014.08.14.06.55.42;	author ajacoutot;	state Exp;
branches;
next	1.28;
commitid	u8GgVtDqY86a9wVU;

1.28
date	2014.06.24.08.49.14;	author ajacoutot;	state Exp;
branches;
next	1.27;
commitid	kVyAweiHRzkUhIJ7;

1.27
date	2014.04.11.16.28.17;	author ajacoutot;	state Exp;
branches;
next	1.26;

1.26
date	2014.03.28.10.30.28;	author ajacoutot;	state Exp;
branches;
next	1.25;

1.25
date	2014.03.24.16.50.43;	author ajacoutot;	state Exp;
branches;
next	1.24;

1.24
date	2014.03.24.15.09.16;	author ajacoutot;	state Exp;
branches;
next	1.23;

1.23
date	2014.03.22.09.40.21;	author ajacoutot;	state Exp;
branches;
next	1.22;

1.22
date	2014.03.16.09.58.10;	author ajacoutot;	state Exp;
branches;
next	1.21;

1.21
date	2014.03.09.22.25.02;	author ajacoutot;	state Exp;
branches;
next	1.20;

1.20
date	2013.12.13.15.33.18;	author ajacoutot;	state Exp;
branches
	1.20.2.1;
next	1.19;

1.19
date	2013.09.18.00.04.33;	author sthen;	state Exp;
branches;
next	1.18;

1.18
date	2013.09.09.10.18.22;	author ajacoutot;	state Exp;
branches;
next	1.17;

1.17
date	2013.06.01.20.30.41;	author stsp;	state Exp;
branches;
next	1.16;

1.16
date	2013.05.01.07.16.15;	author jasper;	state Exp;
branches;
next	1.15;

1.15
date	2013.04.27.15.50.39;	author stsp;	state Exp;
branches;
next	1.14;

1.14
date	2013.04.03.17.40.48;	author robert;	state Exp;
branches;
next	1.13;

1.13
date	2013.03.07.17.41.38;	author stsp;	state Exp;
branches;
next	1.12;

1.12
date	2012.10.26.12.09.13;	author ajacoutot;	state Exp;
branches
	1.12.2.1;
next	1.11;

1.11
date	2012.10.25.12.26.40;	author ajacoutot;	state Exp;
branches;
next	1.10;

1.10
date	2012.10.16.09.43.11;	author ajacoutot;	state Exp;
branches;
next	1.9;

1.9
date	2012.10.16.09.19.23;	author ajacoutot;	state Exp;
branches;
next	1.8;

1.8
date	2012.06.21.07.00.20;	author ajacoutot;	state Exp;
branches;
next	1.7;

1.7
date	2012.06.18.14.12.02;	author ajacoutot;	state Exp;
branches;
next	1.6;

1.6
date	2012.06.18.14.02.24;	author ajacoutot;	state Exp;
branches;
next	1.5;

1.5
date	2012.06.16.11.18.29;	author ajacoutot;	state Exp;
branches;
next	1.4;

1.4
date	2012.06.16.08.35.13;	author ajacoutot;	state Exp;
branches;
next	1.3;

1.3
date	2012.06.02.06.54.57;	author ajacoutot;	state Exp;
branches;
next	1.2;

1.2
date	2012.04.24.10.15.57;	author ajacoutot;	state Exp;
branches;
next	1.1;

1.1
date	2012.03.15.16.50.45;	author ajacoutot;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2012.03.15.16.50.45;	author ajacoutot;	state Exp;
branches;
next	;

1.12.2.1
date	2013.05.01.09.30.56;	author jasper;	state Exp;
branches;
next	1.12.2.2;

1.12.2.2
date	2013.05.14.14.04.45;	author ajacoutot;	state Exp;
branches;
next	;

1.20.2.1
date	2014.03.14.14.39.58;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.47
log
@Forgot a patch in previous.
Mention the rewrite_module in readme while here.
@
text
@$OpenBSD: README,v 1.46 2017/04/28 10:20:38 ajacoutot Exp $

+-----------------------------------------------------------------------
| Running ${FULLPKGNAME} on OpenBSD
+-----------------------------------------------------------------------

ownCloud is installed under
    ${INSTDIR}

Official documentation is available at:
    https://doc.owncloud.org/server/${VR}/admin_manual/

Post-installation instructions
==============================

*** It is highly recommended to use SSL on the webserver (HTTPS).

chroot(2)
---------
When running ownCloud with a chrooted web server, the UTF-8 locale files must be
copied under the /var/www chroot to prevent warning messages in the admin
configuration page and logs:
    # mkdir -p /var/www/usr/share/locale/UTF-8/
    # cp /usr/share/locale/UTF-8/LC_CTYPE \
        /var/www/usr/share/locale/UTF-8/

OpenBSD HTTP daemon
-------------------
See:
    https://github.com/reyk/httpd/wiki/Running-ownCloud-with-httpd-on-OpenBSD

nginx
-----
See:
    https://doc.owncloud.org/server/${VR}/admin_manual/installation/nginx_examples.html

Apache HTTPD
------------
Apache configuration for ownCloud is stored under:
    ${PREFIX}/conf/modules.sample/httpd-owncloud.conf

It needs to be enabled by running the following command after the apache-httpd
package is installed:
# ln -s ../modules.sample/httpd-owncloud.conf /var/www/conf/modules
# rcctl restart apache2

The rewrite_module needs to be enabled by uncommenting the following line in
${SYSCONFDIR}/apache2/httpd2.conf:
    #LoadModule rewrite_module /usr/local/lib/apache2/mod_rewrite.so

Apache also needs

PHP
---
Default PHP values for Apache are set under:
    ${TINSTDIR}/.htaccess

OpenBSD HTTP daemon users can match these .htaccess file values by editing
${SYSCONFDIR}/php-${MODPHP_VERSION}.ini or ${SYSCONFDIR}/php-fpm.conf.

nginx users can match these .htaccess file values by configuring fastcgi_param
with a PHP_VALUE in ${SYSCONFDIR}/nginx/nginx.conf.

For enhanced performance, a PHP opcode cache can be used, either use "opcache"
built-in to PHP 5.5+, enable "opcache.ini" to use it)
or install xcache.

Database configuration
----------------------
See the following URL for setting up a database for ownCloud:
    https://doc.owncloud.org/server/${VR}/admin_manual/configuration_database/linux_database_configuration.html

ownCloud can work with a PostgreSQL, MariaDB or SQLite3 database. Support for
SQLite3 is included with the main php package; to use another database, the
corresponding package needs to be installed *before* setting up ownCloud:
    php-pgsql or php-pdo_mysql

Configuration file
------------------
Configuration is done under:
    ${INSTDIR}/config/config.php
and the default "datadirectory" is set to:
    ${TINSTDIR}/data
When running chrooted, /var/www must be stripped from the paths.

Cron job
--------
ownCloud needs to run background jobs on a regular basis. By default, it will
execute one task with each page loaded ("AJAX" option in the admin interface).
The prefered way is to use a cron(8) job instead.
(see https://<hostname>/owncloud/index.php/settings/admin#backgroundjobs)
e.g.
*/15	*	*	*	*	su -m www -c "${LOCALBASE}/bin/php-5.6 -f ${INSTDIR}/cron.php"

Memory caching and file locking
-------------------------------
ownCloud server performance can be significantly improved with memory caching
and memory-based locking. Distributed caching and Transactional File Locking is
provided by Redis, an in-memory data structure store. More information and
configuration example are available at:
    https://doc.owncloud.org/server/${VR}/admin_manual/configuration_server/caching_configuration.html#id4

TL;DR
You need a redis server running (available in the redis package) then adapt and
append the following to:
    ${INSTDIR}/config/config.php

  'filelocking.enabled' => true,
  'memcache.local' => '\OC\Memcache\Redis',
  'memcache.locking' => '\OC\Memcache\Redis',
  'redis' => array(
    'host' => 'localhost',
    'port' => 6379,
    'timeout' => 0.0,
    'password' => '', // Optional, if not defined no password will be used.
  ),

Authentication backends
-----------------------
When using a non-default user authentication backend (LDAP, IMAP, ...), extra
packages may be needed (e.g. php-ldap, php-imap).

Finishing and validating the installation
-----------------------------------------
Make sure the web server can resolve its hostname (e.g. if chrooted, by creating
/var/www/etc/hosts and/or /var/www/etc/resolv.conf).

Accessing https://<hostname>/owncloud with a Web browser will finish the
installation and create a new admin user.

Updating
========
Before updating to a new release, read:
    https://doc.owncloud.org/server/${VR}/admin_manual/maintenance/upgrade.html

When using a PostgreSQL or MariaDB, the corresponding MDB2 php package must be
installed to properly upgrade the database:
    php-pgsql or php-mysql

WebDAV access
=============
The personal WebDAV share can be accessed using the following URL (e.g. with
Nautilus, Thunar or Doplhin) and the corresponding user and password for the
share:
    https://<hostname>/owncloud/remote.php/webdav/

Synchronization
===============
The "owncloudclient" package (net/owncloudclient) is a graphical (QT)
application to synchronize with an ownCloud server.

Apps and dependencies
=====================
To keep dependencies to a minimum, not all dependencies for all installed apps
are enforced. It is the job of the administrator to manually install required
packages according to the non-default apps he wants to enable.
@


1.46
log
@Update to owncloud-10.0.0.
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.45 2016/07/30 14:25:37 ajacoutot Exp $
d46 6
@


1.45
log
@Update to owncloud-9.1.0.
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.44 2016/04/26 12:05:19 ajacoutot Exp $
d20 3
a22 4
ownCloud attempts to use the UTF-8 locale, which does not work by
default inside the /var/www chroot. This causes warning messages in
ownCloud's admin configuration page and logs. To prevent this problem,
run the following as root:
d35 1
a35 1
    https://doc.owncloud.org/server/${VR}/admin_manual/installation/nginx_owncloud_9x.html
d50 1
a50 1
    ${TINSTDIR}/config/.htaccess
d59 1
a59 1
(built-in to PHP 5.5+, enable "opcache.ini" to use it)
d67 4
a70 5
ownCloud can work with a PostgreSQL, MariaDB or SQLite3 database.
Support for SQLite3 is included with the main php package; to use
another database, the corresponding package needs to be installed
*before* setting up ownCloud:
    php-pdo_pgsql or php-pdo_mysql
d82 3
a84 3
ownCloud needs to run background jobs on a regular basis. By default, it
will execute one task with each page loaded ("AJAX" option in the admin
interface). The prefered way is to use a cron(8) job instead.
d87 1
a87 1
*/15	*	*	*	*	/usr/bin/ftp -Vo - https://<hostname>/owncloud/cron.php >/dev/null
d89 6
a94 7
Memory caching
--------------
ownCloud server performance can be significantly improved with memory caching,
where frequently-requested objects are stored in memory for faster retrieval.
Distributed caching and Transactional File Locking is provided by Redis, an
in-memory data structure store.
More information and configuration example are available at:
d102 1
d104 1
d109 1
d114 2
a115 2
When using a non-default user authentication backend (LDAP, IMAP, ...),
extra packages may be needed (e.g. php-ldap, php-imap).
d119 2
a120 2
Make sure the web server can resolve its hostname (e.g. if chrooted, by
creating /var/www/etc/hosts and/or /var/www/etc/resolv.conf).
d130 2
a131 2
When using a PostgreSQL or MariaDB, the corresponding MDB2 php package
must be installed to properly upgrade the database:
d136 3
a138 3
The personal WebDAV share can be accessed using the following URL (e.g.
with Nautilus, Thunar or Doplhin) and the corresponding user and
password for the share:
d148 3
a150 4
To keep dependencies to a minimum, not all dependencies for all
installed apps are enforced. It is the job of the administrator to
manually install required packages according to the non-default apps he
wants to enable.
@


1.44
log
@Update to owncloud-9.0.1.
Probably needs more love to be able to work under nginx|httpd.
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.43 2015/12/30 08:53:07 ajacoutot Exp $
d11 1
a11 1
    http://doc.owncloud.org/server/${VR}/admin_manual/
d16 1
a16 2
*** It is highly recommended to use SSL on the webserver so that access is done
*** over https instead of http!
a29 1
TBD
a34 1
TBD
d36 1
a36 1
    https://doc.owncloud.org/server/${VR}/admin_manual/installation/nginx_configuration.html
d38 3
a40 3
Apache2
-------
Apache2 configuration for ownCloud is stored under:
d50 1
a50 1
Default PHP values for Apache2 are set under:
d53 2
a54 2
OpenBSD HTTP daemon users can match these .htaccess file values by
editing ${SYSCONFDIR}/php-${MODPHP_VERSION}.ini or ${SYSCONFDIR}/php-fpm.conf.
d56 2
a57 2
nginx users can match these .htaccess file values by configuring
fastcgi_param with a PHP_VALUE in ${SYSCONFDIR}/nginx/nginx.conf.
d59 2
a60 2
For enhanced performance, a PHP opcode cache can be used, either
use "opcache" (built-in to PHP 5.5+, enable "opcache.ini" to use it)
d74 2
d87 1
a87 1
(see http://<hostname>/owncloud/index.php/settings/admin#backgroundjobs)
d89 1
a89 1
*/15	*	*	*	*	/usr/bin/ftp -Vo - http://<hostname>/owncloud/cron.php >/dev/null
d122 1
a122 1
Accessing http://<hostname>/owncloud with a Web browser will finish the
d128 1
a128 1
    http://doc.owncloud.org/server/${VR}/admin_manual/maintenance/upgrade.html
d139 1
a139 1
    http://<hostname>/owncloud/remote.php/webdav/
@


1.43
log
@Better handle /var/www/conf/modules/httpd-owncloud.conf.
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.42 2015/12/30 06:44:34 ajacoutot Exp $
d32 2
d37 3
a39 44
This configuration chunk can be adapted and used in a server{} block:

-8<---------------------------------------------------------------------
        client_max_body_size 10G; # set max upload size
        fastcgi_buffers 64 4K;
        rewrite ^/caldav(.*)$ /remote.php/caldav$1 redirect;
        rewrite ^/carddav(.*)$ /remote.php/carddav$1 redirect;
        rewrite ^/webdav(.*)$ /remote.php/webdav$1 redirect;
        error_page 403 /core/templates/403.php;
        error_page 404 /core/templates/404.php;


        location ~ ^(.+?\.php)(/.*)?$ {
            try_files $1 = 404;
            include fastcgi_params;
            fastcgi_param SCRIPT_FILENAME $document_root$1;
            fastcgi_param PATH_INFO $2;
            fastcgi_pass   unix:run/php-fpm.sock;
        }

        location ~ ^/(data|config|\.ht|db_structure\.xml|README) {
                deny all;
        }

        location / {
            # The following 2 rules are only needed with webfinger
            rewrite ^/.well-known/host-meta /public.php?service=host-meta last;
            rewrite ^/.well-known/host-meta.json /public.php?service=host-meta-json last;

            rewrite ^/.well-known/carddav /remote.php/carddav/ redirect;
            rewrite ^/.well-known/caldav /remote.php/caldav/ redirect;

            rewrite ^(/core/doc/[^\/]+/)$ $1/index.html;

            try_files $uri $uri/ index.php;
        }

        # Optional: set long EXPIRES header on static assets
        location ~* ^.+\.(jpg|jpeg|gif|bmp|ico|png|css|js|swf)$ {
            expires 30d;
            # Optional: Don't log access to assets
            access_log off;
        }
-8<---------------------------------------------------------------------
d46 2
a47 1
It needs to be enabled by running the following command:
d102 3
a104 1
Adapt and append the following to: ${INSTDIR}/config/config.php
@


1.42
log
@Tweaks.
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.41 2015/12/30 06:37:02 ajacoutot Exp $
d85 3
a87 2
It needs to be included by adding the following to ${SYSCONFDIR}/apache2/httpd2.conf:
    Include ${PREFIX}/conf/modules.sample/httpd-owncloud.conf
@


1.41
log
@Add sample redis configuration.
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.40 2015/11/26 07:38:34 ajacoutot Exp $
d16 3
d141 6
a146 6
'memcache.local' => '\OC\Memcache\Redis',
'redis' => array(
     'host' => '<redis_server_host>',
     'port' => 6379,
     'timeout' => 0.0,
      ),
a175 3

NOTE that it is highly recommended to use SSL on the webserver so that
access is done over https instead of http.
@


1.40
log
@Depends on databases/pecl-redis.
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.39 2015/07/30 16:04:38 kirby Exp $
d134 10
@


1.39
log
@mention new desktop client for owncloud. noticed by zhuk@@
remove couple of trailing white spaces while here.
OK ajacoutot@@, maintainer.
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.38 2015/07/17 17:39:54 ajacoutot Exp $
d125 9
@


1.38
log
@Set ownership to the "www" user.
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.37 2015/07/09 10:22:43 ajacoutot Exp $
d85 2
a86 2
PHP  
---              
d160 2
a161 2
The "mirall" package (net/mirall) is a graphical (QT) application to
synchronize with an ownCloud server.
@


1.37
log
@Encryption works without the need for openssl(1).
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.36 2015/07/09 08:09:06 ajacoutot Exp $
d82 1
a82 3
The Apache user group must be set to "www".

Both can be done by editing ${SYSCONFDIR}/apache2/httpd2.conf:
a83 1
    Group www
@


1.36
log
@SECURITY update to owncloud-8.1.0.
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.35 2015/04/04 15:31:44 ajacoutot Exp $
a164 21

Encryption app and chroot
=========================
To provide server side-encryption, the "Encryption" app can be enabled
in the ownCloud admin interface. When running a chrooted web server,
some manual steps are required to make it work.

openssl(1)
----------
The openssl binary and dependent libraries must be installed in the
chroot. As root:
    mkdir /var/www/etc
    mkdir -p /var/www/usr/{bin,lib,libexec}
    cp /usr/bin/openssl /var/www/usr/bin/
    cp /etc/ssl/openssl.cnf /var/www/etc/ssl/openssl.cnf # edit accordingly
    for i in $(ldd /usr/bin/openssl | grep 'lib/' | awk '{ print $7 }'); do
    > cp -p $i /var/www$i
    > done

Make sure to update the openssl binary and libraries in the chroot
whenever they are updated on the system.
@


1.35
log
@Stop talking about ocsync; it's going to be removed at some point since it
was merged into mirall upstream.
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.34 2015/03/15 08:49:10 ajacoutot Exp $
d82 1
a82 1
The httpd2 user group must be set to "www".
d105 3
d118 1
a118 1
When running chrooted, /var/www must be stripped from paths.
d124 3
a126 7
interface).
The prefered way is to use a cron(8) job instead. Two options are
available and both require to edit the web server user's crontab(5).
e.g. "crontab -u www -e"
(swap "www" with the user the web server runs as)

-> "Webcron" (works in chroot)
a127 3

-> "Cron" (does *not* work in chroot)
*/15	*	*	*	*	${MODPHP_BIN} -f ${INSTDIR}/cron.php
@


1.34
log
@Update to owncloud-8.0.2.
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.33 2014/12/01 10:16:06 ajacoutot Exp $
a166 9

CLI
---
The "ocsync" package (net/ocsync) can be installed to synchronize with
an ownCloud server. e.g.
    $ ocsync /path/to/localdir ownclouds://<username>:<password>@@<hostname>/files/webdav.php/remotedir/

GUI
---
@


1.33
log
@Reword a bit (triggered by an email from Johan Huldtgren).
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.32 2014/11/16 22:15:02 sthen Exp $
a8 2
It should point to the root directory of the HTTP server. e.g.
    # ln -s ../owncloud /var/www/htdocs/owncloud
d10 2
a11 2
Official installation intructions are available at:
    http://doc.owncloud.org/server/${VR}/admin_manual/installation/installation_source.html
d15 3
d22 7
a28 3
  # mkdir -p /var/www/usr/share/locale/UTF-8/
  # cp /usr/share/locale/UTF-8/LC_CTYPE \
          /var/www/usr/share/locale/UTF-8/
d30 2
a31 2
nginx(8) configuration
----------------------
d77 21
a97 9
PHP configuration
-----------------
Default PHP values should be adapted according to the setup by editing:
   ${SYSCONFDIR}/php-${MODPHP_VERSION}.ini

allow_url_fopen = On
memory_limit = 512M
upload_max_filesize = 513M	# to accept large files upload
post_max_size = 513M		# sync with above value	
d113 2
a116 4
By default, "datadirectory" is set to:
    /owncloud-data
which expends to ${PREFIX}/owncloud-data outside the chroot.

d149 1
a149 1
    http://doc.owncloud.org/server/${VR}/admin_manual/maintenance/update.html
@


1.32
log
@Tweak owncloud's readme, pecl-APC went away. OK aja@@
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.31 2014/09/14 05:58:07 ajacoutot Exp $
d118 4
a121 4
LDAP user backend
-----------------
If the LDAP user backend is enabled, the "php-ldap" package will need to
be installed.
@


1.31
log
@MySQL -> MariaDB in READMEs.
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.30 2014/08/27 06:58:00 ajacoutot Exp $
d82 3
a84 2
For enhanced performance one of these PHP packages can be installed:
    pecl-APC or xcache
@


1.30
log
@Cope with openssl(1) move from /usr/sbin to /usr/bin

ok landry@@
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.29 2014/08/14 06:55:42 ajacoutot Exp $
d87 1
a87 1
ownCloud can work with a PostgreSQL, MySQL or SQLite3 database.
d135 1
a135 1
When using a PostgreSQL or MySQL, the corresponding MDB2 php package
@


1.29
log
@Update to owncloud-7.0.1.
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.28 2014/06/24 08:49:14 ajacoutot Exp $
d174 2
a175 2
    mkdir -p /var/www/usr/{lib,libexec,sbin}
    cp /usr/sbin/openssl /var/www/usr/sbin/
d177 1
a177 1
    for i in $(ldd /usr/sbin/openssl | grep 'lib/' | awk '{ print $7 }'); do
@


1.28
log
@Talk about mirall.
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.27 2014/04/11 16:28:17 ajacoutot Exp $
d13 1
a13 1
    http://doc.owncloud.org/server/6.0/admin_manual/installation/installation_source.html
d133 1
a133 1
    http://doc.owncloud.org/server/6.0/admin_manual/maintenance/update.html
@


1.27
log
@5.0 -> 6.0 in URL

spotted by "rgouveia"
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.26 2014/03/28 10:30:28 ajacoutot Exp $
d151 5
a155 2
The "ocsync" package (net/ocsync) can be installed to synchronize local
files with ownCloud. e.g.
d157 5
@


1.26
log
@Cope with recent php and nginx default configuration changes.
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.25 2014/03/24 16:50:43 ajacoutot Exp $
d133 1
a133 1
    http://doc.owncloud.org/server/5.0/admin_manual/maintenance/update.html
@


1.25
log
@Add and fix links to doc.owncloud.org.
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.24 2014/03/24 15:09:16 ajacoutot Exp $
d27 1
a27 1
The following configuration chunk must be added to the server {} block:
d44 1
a44 1
            fastcgi_pass   127.0.0.1:9000;
@


1.24
log
@Remove empty line.
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.23 2014/03/22 09:40:21 ajacoutot Exp $
d12 3
d133 1
a133 1
    http://owncloud.org/support/upgrade/
@


1.23
log
@Rework this port to make it work with nginx(8) by default.
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.22 2014/03/16 09:58:10 ajacoutot Exp $
a23 1

@


1.22
log
@Do not use "@@owner www" but "@@group www"; this allows swapping between
different web servers more easily by adding the corresponding httpd user
to the www group.
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.21 2014/03/09 22:25:02 ajacoutot Exp $
d9 2
d14 3
a16 20
With Apache, AllowOverride settings are required on the ${INSTDIR}
directory. You can configure this as follows:
    # ln -sf /var/www/conf/modules.sample/owncloud.conf /var/www/conf/modules

"allow_url_fopen" needs to be enabled in PHP using _one_ of the
following methods:
    1. ${SYSCONFDIR}/php-${MODPHP_VERSION}.ini
    allow_url_fopen = On
    2. /var/www/conf/httpd.conf (main server or VirtualHost)
    php_admin_value allow_url_fopen 1

The maximum upload size for files can be modified in
    ${INSTDIR}/.htaccess

When not using Apache, make _sure_ to set the data directory to a
location outside of the document root.

ownCloud attempts to use the UTF-8 locale, which does not work inside
the /var/www chroot by default. This causes warning messages in
ownCloud's admin configuration page and log. To prevent this problem,
d22 62
a83 1
Database Configuration
d88 1
a88 2
*before* setting up ownCloud (the web server will also need to be
restarted to detect the new PHP module):
d95 4
d115 1
a115 1
LDAP User Backend
d123 1
a123 1
creating /var/www/etc/hosts).
a154 1

d172 1
a172 1
whenever they get updated on the system.
@


1.21
log
@SECURITY update to owncloud-6.0.2.
Rework README to fix cronjobs and add a section about encryption and chroot.
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.20 2013/12/13 15:33:18 ajacoutot Exp $
d58 1
@


1.20
log
@MAJOR update to owncloud-6.0.0.
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.19 2013/09/18 00:04:33 sthen Exp $
d46 4
d52 9
a60 3
If "backgroundjobs" is configured to "Cron" (as opposed to the default
"AJAX") in the Admin menu, a cron(8) job must be added to the root's
crontab(5):
d62 1
d72 3
d102 22
@


1.20.2.1
log
@SECURITY update to owncloud-6.0.2.
Rework README to fix cronjobs and add a section about encryption and chroot.
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.21 2014/03/09 22:25:02 ajacoutot Exp $
a45 4
Configuration is done under:
    ${INSTDIR}/config/config.php
When running chrooted, /var/www must be stripped from paths.

d48 3
a50 9
ownCloud needs to run background jobs on a regular basis. By default, it
will execute one task with each page loaded ("AJAX" option in the admin
interface).
The prefered way is to use a cron(8) job instead. Two options are
available and both require to edit the web server user's crontab(5).
e.g. "crontab -u www -e"

-> "Webcron" (works in chroot)
*/15	*	*	*	*	/usr/bin/ftp -Vo - http://<hostname>/owncloud/cron.php >/dev/null
a51 1
-> "Cron" (does *not* work in chroot)
a60 3
Make sure the web server can resolve its hostname (e.g. if chrooted, by
creating /var/www/etc/hosts).

a87 22

Encryption app and chroot
=========================

To provide server side-encryption, the "Encryption" app can be enabled
in the ownCloud admin interface. When running a chrooted web server,
some manual steps are required to make it work.

openssl(1)
----------
The openssl binary and dependent libraries must be installed in the
chroot. As root:
    mkdir /var/www/etc
    mkdir -p /var/www/usr/{lib,libexec,sbin}
    cp /usr/sbin/openssl /var/www/usr/sbin/
    cp /etc/ssl/openssl.cnf /var/www/etc/ssl/openssl.cnf # edit accordingly
    for i in $(ldd /usr/sbin/openssl | grep 'lib/' | awk '{ print $7 }'); do
    > cp -p $i /var/www$i
    > done

Make sure to update the openssl binary and libraries in the chroot
whenever they get updated on the system.
@


1.19
log
@tweak owncloud README, ok aja
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.18 2013/09/09 10:18:22 ajacoutot Exp $
a36 3
To finish the installation, point your browser to:
    http://<hostname>/owncloud/

d41 3
a43 1
another database, the corresponding package needs to be installed:
a45 5
When using SQLite, no further configuration is required. However, with
MySQL or PostgreSQL, the file ${INSTDIR}/config/config.sample.php will
need to be copied to ${INSTDIR}/config/config.php and configured
accordingly.

d48 2
a49 2
If "backgroundjobs" is configured to "Cron" (as opposed to "AJAX" or
"Webcron") in the Admin menu, a cron(8) job must be added to the root's
@


1.18
log
@Better cronjob task.
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.17 2013/06/01 20:30:41 stsp Exp $
d47 1
a47 1
When using SQLite, not further configuration is required. However, with
d81 1
a81 1
The personnal WebDAV share can be accessed using the following URL (e.g.
@


1.17
log
@Update UTF-8 locale workaround in owncloud's README to account for
/usr/share/locale layout changes.
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.16 2013/05/01 07:16:15 jasper Exp $
d58 1
a58 1
*/5	*	*	*	*	${MODPHP_BIN} ${INSTDIR}/cron.php
@


1.16
log
@modules.sample/ always lives in /var/www, so no need for ${PREFIX} here.

as discussed with aja@@ (MAINTAINER)
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.15 2013/04/27 15:50:39 stsp Exp $
d33 3
a35 3
  # mkdir -p /var/www/usr/share/locale/en_US.UTF-8/
  # cp /usr/share/locale/en_US.UTF-8/LC_CTYPE \
          /var/www/usr/share/locale/en_US.UTF-8/
@


1.15
log
@Document a workaround for the UTF-8 locale problem in owncloud 5. ok aja
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.14 2013/04/03 17:40:48 robert Exp $
d14 1
a14 1
    # ln -sf ${PREFIX}/conf/modules.sample/owncloud.conf ${PREFIX}/conf/modules
@


1.14
log
@update to 5.0.3, based on ajacoutot@@'s diff

ok ajacoutot@@ (MAINTAINER)
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.13 2013/03/07 17:41:38 stsp Exp $
d29 9
a37 1
To finish the installation, point you browser to:
@


1.13
log
@Fix typos in README for www/owncloud. ok ajacoutot
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.12 2012/10/26 12:09:13 ajacoutot Exp $
d76 1
a76 1
    http://<hostname>/files/webdav.php
@


1.12
log
@Document the cron(8) job.
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.11 2012/10/25 12:26:40 ajacoutot Exp $
d18 1
a18 1
    1. ${SYSCONFDIR}/php-{MODPHP_VERSION}.ini
d40 2
a41 2
MySQL or PostgreSQL, the file ${INSTADIR}/config/config.sample.php will
need to be copied to ${INSTADIR}/config/config.php and configured
@


1.12.2.1
log
@security update to owncloud-5.0.3, includes fixes for CVE-2013-1822
CVE-2013-1850 CVE-2013-1851
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.16 2013/05/01 07:16:15 jasper Exp $
d14 1
a14 1
    # ln -sf /var/www/conf/modules.sample/owncloud.conf /var/www/conf/modules
d18 1
a18 1
    1. ${SYSCONFDIR}/php-${MODPHP_VERSION}.ini
d29 1
a29 9
ownCloud attempts to use the UTF-8 locale, which does not work inside
the /var/www chroot by default. This causes warning messages in
ownCloud's admin configuration page and log. To prevent this problem,
run the following as root:
  # mkdir -p /var/www/usr/share/locale/en_US.UTF-8/
  # cp /usr/share/locale/en_US.UTF-8/LC_CTYPE \
          /var/www/usr/share/locale/en_US.UTF-8/

To finish the installation, point your browser to:
d40 2
a41 2
MySQL or PostgreSQL, the file ${INSTDIR}/config/config.sample.php will
need to be copied to ${INSTDIR}/config/config.php and configured
d76 1
a76 1
    http://<hostname>/owncloud/remote.php/webdav/
@


1.12.2.2
log
@MFC:
SECURITY update to owncloud-5.0.6.
Details at: http://owncloud.org/changelog/
@
text
@@


1.11
log
@Extend the upgrade section.
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.10 2012/10/16 09:43:11 ajacoutot Exp $
d43 8
@


1.10
log
@csync -> ocsync
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.9 2012/10/16 09:19:23 ajacoutot Exp $
d58 4
@


1.9
log
@Major update to owncloud-4.5.0.
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.8 2012/06/21 07:00:20 ajacoutot Exp $
d71 1
a71 1
The "csync" package (net/csync) can be installed to synchronize local
d73 1
a73 1
    $ csync /path/to/localdir ownclouds://<username>:<password>@@<hostname>/files/webdav.php/remotedir/
@


1.8
log
@Adapt now that pdo_sqlite is part of main php.
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.7 2012/06/18 14:12:02 ajacoutot Exp $
d54 5
d74 7
@


1.7
log
@Make the example more readable.
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.6 2012/06/18 14:02:24 ajacoutot Exp $
d34 5
d42 1
a42 2
accordingly with the corresponding php database access extension
installed (i.e. "php-pdo_mysql" or "php-pdo_pgsql").
@


1.6
log
@Add an example to use csync to synchronize owncloud with a local dir.
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.5 2012/06/16 11:18:29 ajacoutot Exp $
d64 1
a64 1
    $ csync /path/to/localdir ownclouds://username:password@@<hostname>/files/webdav.php/remotedir/
@


1.5
log
@The apps directory needs to be writable by the web server, pointed out by
robert at peichaer dot org.
While here, add a few tweaks to the README.
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.4 2012/06/16 08:35:13 ajacoutot Exp $
d63 2
a64 1
files with ownCloud.
@


1.4
log
@Mention csync (upcoming package).
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.3 2012/06/02 06:54:57 ajacoutot Exp $
d28 3
@


1.3
log
@Update to owncloud-4.0.0.
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.2 2012/04/24 10:15:57 ajacoutot Exp $
d48 1
a48 1
-------------
d56 5
@


1.2
log
@Config/doc tweaks.
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.1.1.1 2012/03/15 16:50:45 ajacoutot Exp $
d14 1
a14 2
    # ln -s ${PREFIX}/conf/modules.sample/owncloud.conf \
        ${PREFIX}/conf/modules
d18 1
a18 1
    1. ${SYSCONFDIR}/etc/php-{MODPHP_VERSION}.ini
d32 4
a35 3
MySQL or PostgreSQL, the ${INSTADIR}/config/config.php file will need to
be configured accordingly and the corresponding php database access
extension installed (i.e. "php-mysql" or "php-pgsql").
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
$OpenBSD$
d26 3
@


1.1.1.1
log
@Import owncloud-3.0.0.

ownCloud gives you easy and universal access to all of your files.
It also provides a platform to easily view, sync and share your
contacts, calendars, bookmarks and files across all your devices.

ok robert@@
@
text
@@
