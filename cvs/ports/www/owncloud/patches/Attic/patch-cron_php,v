head	1.1;
access;
symbols
	OPENBSD_5_7:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2015.03.30.08.59.12;	author ajacoutot;	state dead;
branches
	1.1.2.1;
next	;
commitid	JS7zzk9IJ8sViiZ2;

1.1.2.1
date	2015.03.30.08.59.12;	author ajacoutot;	state Exp;
branches;
next	1.1.2.2;
commitid	JS7zzk9IJ8sViiZ2;

1.1.2.2
date	2015.05.04.09.33.36;	author ajacoutot;	state dead;
branches;
next	;
commitid	k2GbNYaPRB3IPxQD;


desc
@@


1.1
log
@file patch-cron_php was initially added on branch OPENBSD_5_7.
@
text
@@


1.1.2.1
log
@SECURITY update to owncloud-7.0.5.
@
text
@a0 22
$OpenBSD$

From c716776a90da02e463040c507ea8a3f34d871cfd Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Thomas=20M=C3=BCller?= <thomas.mueller@@tmit.eu>
Date: Thu, 12 Mar 2015 21:03:26 +0100
Subject: [PATCH] cron shall not operate in case we are in maintenance mode - fixes #14843

--- cron.php.orig	Thu Mar  5 22:28:55 2015
+++ cron.php	Mon Mar 30 10:53:28 2015
@@@@ -50,7 +50,11 @@@@ try {
 
 	if (\OCP\Util::needUpgrade()) {
 		\OCP\Util::writeLog('cron', 'Update required, skipping cron', \OCP\Util::DEBUG);
-		exit();
+		exit;
+	}
+	if (\OC::$server->getSystemConfig()->getValue('maintenance', false)) {
+		\OCP\Util::writeLog('cron', 'We are in maintenance mode, skipping cron', \OCP\Util::DEBUG);
+		exit;
 	}
 
 	// load all apps to get all api routes properly setup
@


1.1.2.2
log
@Remove bogus patch that prevented cron.php from working properly.
reported by Todd Mortimer, thanks!
@
text
@d1 1
a1 1
$OpenBSD: patch-cron_php,v 1.1.2.1 2015/03/30 08:59:12 ajacoutot Exp $
@


