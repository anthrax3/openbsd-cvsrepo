head	1.1;
access;
symbols
	OPENBSD_6_2:1.1.0.4
	OPENBSD_6_2_BASE:1.1
	OPENBSD_6_1:1.1.0.2
	OPENBSD_6_1_BASE:1.1;
locks; strict;
comment	@# @;


1.1
date	2017.02.23.17.49.50;	author jca;	state Exp;
branches;
next	;
commitid	GwCw43cWFthVtg7R;


desc
@@


1.1
log
@Unbreak on archs who don't provide atomic builtins.

The build system previously added -march=i486 if __sync_* atomics were
missing...

ok jeremy@@ (maintainer)
@
text
@$OpenBSD$
--- ext/raindrops/extconf.rb.orig	Wed Feb 22 13:17:45 2017
+++ ext/raindrops/extconf.rb	Wed Feb 22 13:18:16 2017
@@@@ -31,18 +31,6 @@@@ SRC
   if try_link(src)
     $defs.push(format("-DHAVE_GCC_ATOMIC_BUILTINS"))
     true
-  else
-    # some compilers still target 386 by default, but we need at least 486
-    # to run atomic builtins.
-    prev_cflags = $CFLAGS
-    $CFLAGS += " -march=i486 "
-    if try_link(src)
-      $defs.push(format("-DHAVE_GCC_ATOMIC_BUILTINS"))
-      true
-    else
-      prev_cflags = $CFLAGS
-      false
-    end
   end
 end or have_header('atomic_ops.h') or abort <<-SRC
 
@
