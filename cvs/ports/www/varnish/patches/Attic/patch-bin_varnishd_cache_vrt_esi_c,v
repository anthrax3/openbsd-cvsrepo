head	1.2;
access;
symbols
	OPENBSD_4_7:1.1.0.2
	OPENBSD_4_7_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2010.06.30.21.49.37;	author jim;	state dead;
branches;
next	1.1;

1.1
date	2009.12.12.17.38.19;	author fgsch;	state Exp;
branches;
next	;


desc
@@


1.2
log
@update to 2.1.2, take maintainer, and correct homepage.  putting in tree to get more eyes on it.

ok robert@@
@
text
@Fixes #585: ESI produces wrong backend requests.

$OpenBSD: patch-bin_varnishd_cache_vrt_esi_c,v 1.1 2009/12/12 17:38:19 fgsch Exp $
--- bin/varnishd/cache_vrt_esi.c.orig	Sat Dec 12 16:20:24 2009
+++ bin/varnishd/cache_vrt_esi.c	Sat Dec 12 16:20:39 2009
@@@@ -384,7 +384,7 @@@@ esi_handle_include(struct esi_work *ew)
 			memcpy(c, val.b, Tlen(val));
 			val.b = c;
 			val.e = val.b + s;
-			*val.e = '\0';
+			val.e[-1] = '\0';
 		}
 
 		if (Tlen(val) > 7 && !memcmp(val.b, "http://", 7)) {
@


1.1
log
@Fix esi and disable stack protector for all functions.
Not connected to build yet, so no bump.
@
text
@d3 1
a3 1
$OpenBSD$
@

