head	1.28;
access;
symbols
	OPENBSD_6_0:1.23.0.2
	OPENBSD_6_0_BASE:1.23
	OPENBSD_5_9:1.21.0.2
	OPENBSD_5_9_BASE:1.21
	OPENBSD_5_8:1.19.0.4
	OPENBSD_5_8_BASE:1.19
	OPENBSD_5_7:1.18.0.2
	OPENBSD_5_7_BASE:1.18
	OPENBSD_5_6:1.16.0.4
	OPENBSD_5_6_BASE:1.16
	OPENBSD_5_5:1.16.0.2
	OPENBSD_5_5_BASE:1.16
	OPENBSD_5_4:1.14.0.2
	OPENBSD_5_4_BASE:1.14
	OPENBSD_5_3:1.12.0.2
	OPENBSD_5_3_BASE:1.12
	OPENBSD_5_2:1.11.0.2
	OPENBSD_5_2_BASE:1.11
	OPENBSD_5_1_BASE:1.10
	OPENBSD_5_1:1.10.0.2
	OPENBSD_5_0:1.8.0.4
	OPENBSD_5_0_BASE:1.8
	OPENBSD_4_9:1.8.0.2
	OPENBSD_4_9_BASE:1.8
	OPENBSD_4_8:1.5.0.2
	OPENBSD_4_8_BASE:1.5
	OPENBSD_4_7:1.4.0.2
	OPENBSD_4_7_BASE:1.4
	fgsch_20091123:1.1.1.1
	fgsch:1.1.1;
locks; strict;
comment	@# @;


1.28
date	2017.03.16.15.44.06;	author gonzalo;	state Exp;
branches;
next	1.27;
commitid	PUfQClNzuIi37C2t;

1.27
date	2017.01.18.13.43.46;	author gonzalo;	state Exp;
branches;
next	1.26;
commitid	RZDZeQw5mjr1M0gS;

1.26
date	2016.12.30.21.09.07;	author jca;	state Exp;
branches;
next	1.25;
commitid	ZsjwaCMc9b0tv1Fp;

1.25
date	2016.12.28.21.31.08;	author jca;	state Exp;
branches;
next	1.24;
commitid	MOrlpWAsGigzHSIk;

1.24
date	2016.08.23.13.48.23;	author gonzalo;	state Exp;
branches;
next	1.23;
commitid	dHmqHaOj5ROcvvEk;

1.23
date	2016.03.16.21.19.39;	author naddy;	state Exp;
branches;
next	1.22;
commitid	eS3Ayl3CL8hkKETd;

1.22
date	2016.03.15.15.07.36;	author gonzalo;	state Exp;
branches;
next	1.21;
commitid	9IQiJVicldlfbw7C;

1.21
date	2015.12.08.23.35.22;	author gonzalo;	state Exp;
branches;
next	1.20;
commitid	gKgu1AZgmBCJrXmw;

1.20
date	2015.09.28.02.42.39;	author gonzalo;	state Exp;
branches;
next	1.19;
commitid	pVZtMghlbD6VtRja;

1.19
date	2015.07.16.00.43.36;	author ajacoutot;	state Exp;
branches;
next	1.18;
commitid	gYK5bZN05l1Mx4Rw;

1.18
date	2015.01.15.18.14.04;	author landry;	state Exp;
branches;
next	1.17;
commitid	FJioZiWIe0kMhWnL;

1.17
date	2014.12.17.14.51.35;	author gonzalo;	state Exp;
branches;
next	1.16;
commitid	ViWl7bioKTJONDcm;

1.16
date	2014.01.04.16.52.09;	author fgsch;	state Exp;
branches;
next	1.15;

1.15
date	2013.09.23.08.23.15;	author jasper;	state Exp;
branches;
next	1.14;

1.14
date	2013.03.21.08.48.55;	author ajacoutot;	state Exp;
branches;
next	1.13;

1.13
date	2013.03.11.11.44.50;	author espie;	state Exp;
branches;
next	1.12;

1.12
date	2012.10.19.16.27.47;	author sthen;	state Exp;
branches;
next	1.11;

1.11
date	2012.04.28.10.52.09;	author ajacoutot;	state Exp;
branches;
next	1.10;

1.10
date	2011.12.26.22.26.39;	author fgsch;	state Exp;
branches;
next	1.9;

1.9
date	2011.12.23.13.06.30;	author jasper;	state Exp;
branches;
next	1.8;

1.8
date	2010.11.22.08.36.55;	author espie;	state Exp;
branches;
next	1.7;

1.7
date	2010.10.19.08.02.57;	author espie;	state Exp;
branches;
next	1.6;

1.6
date	2010.09.11.13.03.46;	author jim;	state Exp;
branches;
next	1.5;

1.5
date	2010.06.30.21.49.37;	author jim;	state Exp;
branches;
next	1.4;

1.4
date	2009.12.12.17.38.19;	author fgsch;	state Exp;
branches;
next	1.3;

1.3
date	2009.11.30.09.29.30;	author fgsch;	state Exp;
branches;
next	1.2;

1.2
date	2009.11.25.11.36.55;	author bernd;	state Exp;
branches;
next	1.1;

1.1
date	2009.11.23.00.28.10;	author fgsch;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2009.11.23.00.28.10;	author fgsch;	state Exp;
branches;
next	;


desc
@@


1.28
log
@Update for Varnish to 5.1.0

OK benoit@@
@
text
@# $OpenBSD: Makefile,v 1.27 2017/01/18 13:43:46 gonzalo Exp $

COMMENT =		high-performance HTTP accelerator

DISTNAME =		varnish-5.1.0
CATEGORIES =		www

SHARED_LIBS =		varnishapi	1.0

HOMEPAGE =		http://www.varnish-cache.org/

MAINTAINER =		Jim Razmus II <jim@@openbsd.org> \
			Gonzalo L. Rodriguez <gonzalo@@openbsd.org>

# BSD
PERMIT_PACKAGE_CDROM =	Yes

WANTLIB += c execinfo m ncursesw pcre pthread readline termcap

MASTER_SITES =		http://repo.varnish-cache.org/source/

BUILD_DEPENDS =		textproc/py-docutils
LIB_DEPENDS = 		devel/pcre
# The internal backtrace implementation fails to build with -Werror on arm/hppa
LIB_DEPENDS +=		devel/libexecinfo

CONFIGURE_STYLE =	gnu
CONFIGURE_ENV =		CPPFLAGS="-I${LOCALBASE}/include" \
			LDFLAGS="-L${LOCALBASE}/lib ${LDFLAGS}"

TEST_TARGET =		check

post-install:
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/varnish
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/varnish
	cp ${WRKDIST}${SYSCONFDIR}/{example,builtin}.vcl \
	    ${PREFIX}/share/examples/varnish
	rm -f ${PREFIX}/lib/varnish/{vmods,}/*.{a,la}

.include <bsd.port.mk>
@


1.27
log
@Fix Makefile
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2016/12/30 21:09:07 jca Exp $
d5 1
a5 1
DISTNAME =		varnish-5.0.0
@


1.26
log
@Unbreak on arm and hppa.

The internal backtrace implementation uses __builtin_return_address with
a non-zero argument, which doesn't work on arm and hppa.  Instead of
applying a fix in varnish, detect and depend on devel/libexecinfo which
already has the logic to handle those architectures.  ok gonzalo@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2016/12/28 21:31:08 jca Exp $
d5 1
a5 2
DISTNAME =		varnish-4.1.3
REVISION =		0
d12 2
a13 1
MAINTAINER =		Jim Razmus II <jim@@openbsd.org>
@


1.25
log
@BROKEN on arm too, unsupported argument to '__builtin_return_address'
@
text
@d1 1
a1 4
# $OpenBSD: Makefile,v 1.24 2016/08/23 13:48:23 gonzalo Exp $

# execinfo.c:144: warning: unsupported argument to '__builtin_return_address' + Werror
NOT_FOR_ARCHS =	arm hppa
d6 1
d18 1
a18 1
WANTLIB += c m ncursesw pcre pthread readline termcap
d24 2
d28 2
@


1.24
log
@Update for Varnish to 4.1.3:

https://github.com/varnishcache/varnish-cache/blob/4.1/doc/changes.rst

OK benoit@@
@
text
@d1 4
a4 1
# $OpenBSD: Makefile,v 1.23 2016/03/16 21:19:39 naddy Exp $
a5 1
BROKEN-hppa =	execinfo.c:144: warning: unsupported argument to '__builtin_return_address' + Werror
@


1.23
log
@remove SHARED_ONLY from ports that use only the gnu module
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2016/03/15 15:07:36 gonzalo Exp $
d6 1
a6 1
DISTNAME =		varnish-4.1.2
@


1.22
log
@Update for Varnish to 4.1.2:

https://github.com/varnishcache/varnish-cache/blob/4.1/doc/changes.rst

OK benoit@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2015/12/08 23:35:22 gonzalo Exp $
a2 1
SHARED_ONLY =		Yes
@


1.21
log
@Update for Varnish to 4.1.0:

https://www.varnish-cache.org/content/varnish-cache-410

OK benoit@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2015/09/28 02:42:39 gonzalo Exp $
d7 1
a7 1
DISTNAME =		varnish-4.1.0
@


1.20
log
@Update for Varnish to 4.0.3:

https://www.varnish-cache.org/trac/browser/doc/changes.rst?rev=b8c4a34

Maintainer timeout.

OK jung@@ benoit@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2015/07/16 00:43:36 ajacoutot Exp $
d7 1
a7 1
DISTNAME =		varnish-4.0.3
@


1.19
log
@Fix pexp.
Put rc_reload where it belongs.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2015/01/15 18:14:04 landry Exp $
d7 1
a7 2
DISTNAME =		varnish-4.0.2
REVISION =		0
@


1.18
log
@BROKEN-hppa =   execinfo.c:144: warning: unsupported argument to '__builtin_return_address' + Werror
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2014/12/17 14:51:35 gonzalo Exp $
d8 1
@


1.17
log
@Update for Varnish to 4.0.2

https://www.varnish-cache.org/trac/browser/doc/changes.rst?rev=bfe7cd

Tested by Jason Tubnor (Thanks!) and me.

jim@@ maintainer timeout.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2014/01/04 16:52:09 fgsch Exp $
d4 1
a4 1

@


1.16
log
@Update to varnish 3.0.5.
From maintainer with minor tweaks.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2013/09/23 08:23:15 jasper Exp $
d7 1
a7 1
DISTNAME =		varnish-3.0.5
d19 1
a19 1
WANTLIB = 		c curses m pcre pthread readline termcap
d33 1
a33 1
	mv ${WRKINST}${SYSCONFDIR}/varnish/default.vcl \
@


1.15
log
@- update to varnish 3.0.4
- add rc script

rc script ok aja@@
maintainer timed-out
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2013/03/21 08:48:55 ajacoutot Exp $
d7 1
a7 1
DISTNAME =		varnish-3.0.4
d12 2
a15 2
HOMEPAGE =		http://www.varnish-cache.org/

d21 2
d26 1
a26 5
MASTER_SITES =		http://repo.varnish-cache.org/source/

USE_GROFF =		Yes
CONFIGURE_STYLE =	autoconf
AUTOCONF_VERSION =	2.69
d35 1
a35 2
	@@find ${PREFIX}/lib/varnish -name '*.a' -print | xargs rm
	@@find ${PREFIX}/lib/varnish -name '*.la' -print | xargs rm
@


1.14
log
@USE_LIBTOOL=Yes is the default now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2013/03/11 11:44:50 espie Exp $
d7 1
a7 1
DISTNAME =		varnish-3.0.2
d19 1
a19 1
WANTLIB = 		c curses edit m pcre pthread
d28 1
a28 1
AUTOCONF_VERSION =	2.68
d30 1
a30 1
TEST_TARGET =	check
@


1.13
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2012/10/19 16:27:47 sthen Exp $
a25 1
USE_LIBTOOL =		Yes
@


1.12
log
@BUILD_DEPENDS on py-docutils (for rst2man)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2012/04/28 10:52:09 ajacoutot Exp $
a17 3
PERMIT_PACKAGE_FTP =	Yes
PERMIT_DISTFILES_CDROM =Yes
PERMIT_DISTFILES_FTP =	Yes
d31 1
a31 1
REGRESS_TARGET =	check
@


1.11
log
@--localstatedir=/var is the default now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2011/12/26 22:26:39 fgsch Exp $
d24 1
@


1.10
log
@re-enable regress as discussed with maintainer and Gonzalo L. R.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2011/12/23 13:06:30 jasper Exp $
a31 1
CONFIGURE_ARGS =	--localstatedir=/var
@


1.9
log
@- update to 3.0.2

from Gonzalo L. R.
maintainer timed-out
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2010/11/22 08:36:55 espie Exp $
d33 2
@


1.8
log
@new depends
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.7 2010/10/19 08:02:57 espie Exp $
d7 1
a7 1
DISTNAME =		varnish-2.1.3
d10 2
a13 5
SHARED_LIBS +=		varnish		0.0
SHARED_LIBS +=		varnishapi	0.0
SHARED_LIBS +=		varnishcompat	0.0
SHARED_LIBS +=		vcl		0.0

d19 1
a19 1
PERMIT_DISTFILES_CDROM = Yes
d22 2
a23 1
WANTLIB = 		c curses m pcre pthread
d26 1
a26 1
MASTER_SITES =		${MASTER_SITE_SOURCEFORGE:=varnish/}
d30 2
a31 2

CONFIGURE_STYLE =	gnu
a33 2
REGRESS_TARGET =	check

d39 2
a40 2
	${INSTALL_DATA} ${WRKSRC}/doc/getting-started.html \
	    ${PREFIX}/share/doc/varnish
@


1.7
log
@USE_GROFF=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2010/09/11 13:03:46 jim Exp $
d24 1
a24 1
LIB_DEPENDS = 		::devel/pcre
d29 1
a29 1
USE_GROFF =	Yes
@


1.6
log
@update to 2.1.3 inspired by patch from Marius ROMAN <marius.roman at gmail.com>, modifications by me with input from ajacoutot@@

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD$
d29 1
@


1.5
log
@update to 2.1.2, take maintainer, and correct homepage.  putting in tree to get more eyes on it.

ok robert@@
@
text
@d5 1
a5 1
DISTNAME =		varnish-2.1.2
d23 2
a24 2
WANTLIB = 		c curses m pthread
LIB_DEPENDS = 		pcre::devel/pcre
@


1.4
log
@Fix esi and disable stack protector for all functions.
Not connected to build yet, so no bump.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2009/11/30 09:29:30 fgsch Exp $
d5 1
a5 2
DISTNAME =		varnish-2.0.5
PKGNAME =		${DISTNAME}p0
d8 1
a8 4
SHARED_LIBS =		varnish		0.0 \
			varnishapi	0.0 \
			varnishcompat	0.0 \
			vcl		0.0
d10 6
a15 1
HOMEPAGE =		http://varnish.projects.linpro.no/
d24 1
@


1.3
log
@Enable regression tests.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2009/11/25 11:36:55 bernd Exp $
d29 1
a29 2
CONFIGURE_ARGS =	--enable-stack-protector \
			--localstatedir=/var
@


1.2
log
@Fix HOMEPAGE and bump.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2009/11/23 00:28:10 fgsch Exp $
d31 2
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d6 1
d14 1
a14 1
HOMEPAGE =		http://varnish.projects.linpro.org/
@


1.1.1.1
log
@Import varnish 2.0.5. Originally from Jim Razmus <jim at bonetruck dot org>.
Not linked yet but added so other people can work on it.
@
text
@@
