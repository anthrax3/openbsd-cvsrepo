head	1.5;
access;
symbols
	OPENBSD_6_2:1.5.0.2
	OPENBSD_6_2_BASE:1.5
	OPENBSD_6_1:1.1.1.1.0.2
	OPENBSD_6_1_BASE:1.1.1.1
	gonzalo_20171403:1.1.1.1
	gonzalo:1.1.1;
locks; strict;
comment	@# @;


1.5
date	2017.09.13.13.20.30;	author gonzalo;	state Exp;
branches;
next	1.4;
commitid	OlNjpxVgmgT4DKgq;

1.4
date	2017.08.21.19.29.20;	author danj;	state Exp;
branches;
next	1.3;
commitid	WeqzasOnQIebMnDN;

1.3
date	2017.05.28.20.03.16;	author gonzalo;	state Exp;
branches;
next	1.2;
commitid	YEsXqfmvANTh6KyI;

1.2
date	2017.04.27.03.00.54;	author gonzalo;	state Exp;
branches;
next	1.1;
commitid	GyqockbZXqu2TKNa;

1.1
date	2017.03.14.16.19.01;	author gonzalo;	state Exp;
branches
	1.1.1.1;
next	;
commitid	7tZetj8ZX3iz7yc3;

1.1.1.1
date	2017.03.14.16.19.01;	author gonzalo;	state Exp;
branches;
next	;
commitid	7tZetj8ZX3iz7yc3;


desc
@@


1.5
log
@Update for Nextcloud to 12.0.2:

https://nextcloud.com/changelog/

OK kirby@@
@
text
@# $OpenBSD: Makefile,v 1.4 2017/08/21 19:29:20 danj Exp $

COMMENT=		easy and universal access to shared and/or personal files

V=			12.0.2
DISTNAME=		nextcloud-${V}
EXTRACT_SUFX=		.tar.bz2

CATEGORIES=		www

HOMEPAGE=		http://nextcloud.com/


# AGPLv3 (GNU Affero Public License)
# jQuery: MIT / GPLv3
# HTTP: 3 clause BSD
# MDB2: BSD-like
# User: AGPL
# XML/RPC: MIT / PHP
# Silk icons: Creative Commons Attribution
PERMIT_PACKAGE_CDROM=	Yes

MASTER_SITES=		http://download.nextcloud.com/server/releases/

MODULES=		lang/php

NO_BUILD=		Yes
NO_TEST=		Yes
PKG_ARCH=		*

WRKDIST=		${WRKDIR}/nextcloud

PREFIX=			${VARBASE}/www
INSTDIR=		${PREFIX}/nextcloud
TINSTDIR=		${TRUEPREFIX}/nextcloud
VR=			${V:R}
MAJOR=			${VR:R}
SUBST_VARS=		INSTDIR TINSTDIR MODPHP_BIN VR MAJOR

RUN_DEPENDS=		lang/php/${MODPHP_VERSION},-gd \
			lang/php/${MODPHP_VERSION},-zip

# http user authentication
RUN_DEPENDS +=		lang/php/${MODPHP_VERSION},-curl

# apps extraction
RUN_DEPENDS +=		lang/php/${MODPHP_VERSION},-bz2

# sorting of non-ASCII characters
RUN_DEPENDS +=		lang/php/${MODPHP_VERSION},-intl

# increase file encryption performance
RUN_DEPENDS +=		lang/php/${MODPHP_VERSION},-mcrypt

# distributed caching and Transactional File Locking
RUN_DEPENDS +=		databases/pecl-redis

do-install:
	cp -Rp ${WRKSRC} ${INSTDIR}
	mv ${INSTDIR}/.htaccess ${INSTDIR}/.htaccess.dist
	find ${INSTDIR} -name '*.orig' -print0 | xargs -r0 rm
	chown -R ${BINOWN}:${BINGRP} ${INSTDIR}

	chmod +x ${INSTDIR}/occ
	perl -pi -e '$$. == 1 && s|^.*env php.*$$|\#!${MODPHP_BIN}|;' \
		-e 'close ARGV if eof;' \
		${INSTDIR}/occ

	${INSTALL_DATA_DIR} ${PREFIX}/conf/modules.sample
	${SUBST_CMD} -m 0644 -c ${FILESDIR}/apache-nextcloud.conf.dist.in \
		${PREFIX}/conf/modules.sample/apache-nextcloud.conf.dist
	${SUBST_CMD} -m 0644 -c ${FILESDIR}/httpd-nextcloud.conf.dist.in \
		${PREFIX}/conf/modules.sample/httpd-nextcloud.conf.dist

.include <bsd.port.mk>
@


1.4
log
@Fix httpd config sample, problem reported by Vaelatern on #openbsd

ok sthen
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2017/05/28 20:03:16 gonzalo Exp $
d5 1
a5 1
V=			12.0.0
a7 1
REVISION=		0
d37 1
a37 1
MAJOR=			11
@


1.3
log
@Upgrade for Nextcloud to 12.0.0:

https://nextcloud.com/changelog/

OK kirby@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2017/04/27 03:00:54 gonzalo Exp $
d8 1
@


1.2
log
@Update to 11.0.3.

OK kirby@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2017/03/14 16:19:01 gonzalo Exp $
d5 1
a5 1
V=			11.0.3
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD:$
d5 1
a5 1
V=			11.0.2
@


1.1.1.1
log
@Owncloud fork, Store your documents, calendar, contacts and photos on a server.

Initial port from Johan Huldtgren with some tweaks by me.

OK kirby@@
@
text
@@
