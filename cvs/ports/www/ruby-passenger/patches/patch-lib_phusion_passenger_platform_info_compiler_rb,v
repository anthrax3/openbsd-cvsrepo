head	1.5;
access;
symbols
	OPENBSD_6_0:1.5.0.6
	OPENBSD_6_0_BASE:1.5
	OPENBSD_5_9:1.5.0.2
	OPENBSD_5_9_BASE:1.5
	OPENBSD_5_8:1.5.0.4
	OPENBSD_5_8_BASE:1.5
	OPENBSD_5_2:1.3.0.4
	OPENBSD_5_2_BASE:1.3
	OPENBSD_5_1_BASE:1.3
	OPENBSD_5_1:1.3.0.2
	OPENBSD_5_0:1.2.0.2
	OPENBSD_5_0_BASE:1.2
	OPENBSD_4_9:1.1.0.2
	OPENBSD_4_9_BASE:1.1;
locks; strict;
comment	@# @;


1.5
date	2015.07.26.01.33.26;	author jeremy;	state Exp;
branches;
next	1.4;
commitid	XHDvbHl3gYXQ5RX5;

1.4
date	2012.09.24.06.51.59;	author jasper;	state dead;
branches;
next	1.3;

1.3
date	2011.12.13.18.38.18;	author jeremy;	state Exp;
branches;
next	1.2;

1.2
date	2011.05.17.03.25.18;	author william;	state Exp;
branches;
next	1.1;

1.1
date	2010.11.08.23.47.37;	author jeremy;	state Exp;
branches;
next	;


desc
@@


1.5
log
@Update to passenger 5.0.14

Remove subpackages, revert to a single package, since standalone package
is now only 10% the size of the main package.
@
text
@$OpenBSD$
--- lib/phusion_passenger/platform_info/compiler.rb.orig	Sat Jul 18 19:06:41 2015
+++ lib/phusion_passenger/platform_info/compiler.rb	Sat Jul 18 19:06:52 2015
@@@@ -223,7 +223,7 @@@@ module PhusionPassenger
         f.close
         begin
           command = create_compiler_command(language,
-            "-v -c '#{filename}' -o '#{filename}.o'",
+            "-I${LOCALBASE}/include -v -c '#{filename}' -o '#{filename}.o'",
             flags)
           if result = run_compiler("Checking for #{header_name}", command, filename, source, true)
             result[:output] =~ /^#include <...> search starts here:$(.+?)^End of search list\.$/m
@


1.4
log
@- remove -lpthread vs. -pthread patches/chunks.
@
text
@d1 12
a12 12
$OpenBSD: patch-lib_phusion_passenger_platform_info_compiler_rb,v 1.3 2011/12/13 18:38:18 jeremy Exp $
--- lib/phusion_passenger/platform_info/compiler.rb.orig	Wed Dec 31 16:00:00 1969
+++ lib/phusion_passenger/platform_info/compiler.rb	Wed Nov 30 10:51:43 2011
@@@@ -172,6 +172,8 @@@@ module PlatformInfo
 	def self.portability_ldflags
 		if RUBY_PLATFORM =~ /solaris/
 			result = '-lxnet -lrt -lsocket -lnsl -lpthread'
+		elsif RUBY_PLATFORM =~ /openbsd/
+			result = '-pthread'
 		else
 			result = '-lpthread'
 		end
@


1.3
log
@Update to 3.0.11.  Support by the standalone version of passenger by
splitting into a multipackage, with a subpackage for the standalone
version (which embeds a version of nginx).  The standalone version
operates much like other ruby webservers, serving a single ruby/rack
application.

Switch to using the gem version of passenger.  Because the gem
installs into a versioned directory, setup symlinks to the
versioned directory so that nginx configuration files don't need
to be modified when the version is updated.
@
text
@d1 1
a1 1
$OpenBSD: patch-lib_phusion_passenger_platform_info_compiler_rb,v 1.2 2011/05/17 03:25:18 william Exp $
@


1.2
log
@Update to passenger 3.0.7

Ignore EINVAL from sigaltstack, seems to be what ruby itself does in 1.9

committing on behalf of jeremy@@, who did all the work,
tested on i386 and tested packaging on amd64.  All so I can commit a
simple nginx update... THANKS.

ok jasper
@
text
@d1 4
a4 4
$OpenBSD: patch-lib_phusion_passenger_platform_info_compiler_rb,v 1.1 2010/11/08 23:47:37 jeremy Exp $
--- lib/phusion_passenger/platform_info/compiler.rb.orig	Mon Apr 11 03:22:54 2011
+++ lib/phusion_passenger/platform_info/compiler.rb	Wed Apr 27 10:43:02 2011
@@@@ -156,6 +156,8 @@@@ module PlatformInfo
@


1.1
log
@Update ruby-passenger to 3.0.0.  Switch the directory name from
phusion_passenger to phusion-passenger, since that's the name used
by upstream. Also tested by Pierre-Yves Ritschard.

OK landry@@
@
text
@d1 4
a4 4
$OpenBSD$
--- lib/phusion_passenger/platform_info/compiler.rb.orig	Wed Oct 27 15:34:10 2010
+++ lib/phusion_passenger/platform_info/compiler.rb	Wed Oct 27 15:34:16 2010
@@@@ -149,6 +149,8 @@@@ module PlatformInfo
d7 1
a7 1
 			return '-lxnet -lrt -lsocket -lnsl -lpthread'
d9 1
a9 1
+			return '-pthread'
d11 1
a11 1
 			return '-lpthread'
@

