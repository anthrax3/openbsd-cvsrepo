head	1.40;
access;
symbols
	OPENBSD_5_0:1.39.0.6
	OPENBSD_5_0_BASE:1.39
	OPENBSD_4_9:1.39.0.4
	OPENBSD_4_9_BASE:1.39
	OPENBSD_4_8:1.39.0.2
	OPENBSD_4_8_BASE:1.39
	OPENBSD_4_7:1.38.0.2
	OPENBSD_4_7_BASE:1.38
	OPENBSD_4_6:1.37.0.6
	OPENBSD_4_6_BASE:1.37
	OPENBSD_4_5:1.37.0.4
	OPENBSD_4_5_BASE:1.37
	OPENBSD_4_4:1.37.0.2
	OPENBSD_4_4_BASE:1.37
	OPENBSD_4_3:1.36.0.2
	OPENBSD_4_3_BASE:1.36
	OPENBSD_4_2:1.35.0.2
	OPENBSD_4_2_BASE:1.35
	OPENBSD_4_1:1.32.0.2
	OPENBSD_4_1_BASE:1.32
	OPENBSD_4_0:1.28.0.2
	OPENBSD_4_0_BASE:1.28
	OPENBSD_3_9:1.25.0.2
	OPENBSD_3_9_BASE:1.25
	OPENBSD_3_8:1.22.0.2
	OPENBSD_3_8_BASE:1.22
	OPENBSD_3_7:1.21.0.2
	OPENBSD_3_7_BASE:1.21
	OPENBSD_3_6:1.20.0.2
	OPENBSD_3_6_BASE:1.20
	OPENBSD_3_5:1.17.0.4
	OPENBSD_3_5_BASE:1.17
	OPENBSD_3_4:1.17.0.2
	OPENBSD_3_4_BASE:1.17
	OPENBSD_3_3:1.15.0.2
	OPENBSD_3_3_BASE:1.15
	OPENBSD_3_2:1.14.0.2
	OPENBSD_3_2_BASE:1.14
	OPENBSD_3_1:1.9.0.2
	OPENBSD_3_1_BASE:1.9
	OPENBSD_3_0:1.3.0.2
	OPENBSD_3_0_BASE:1.3
	OPENBSD_2_9_TRACKING_SWITCH:1.1.1.1
	matt_2001-08-05:1.1.1.1
	matt:1.1.1;
locks; strict;
comment	@# @;


1.40
date	2011.12.15.22.19.51;	author fgsch;	state dead;
branches;
next	1.39;

1.39
date	2010.04.14.00.08.16;	author fgsch;	state Exp;
branches;
next	1.38;

1.38
date	2010.02.01.17.00.14;	author espie;	state Exp;
branches;
next	1.37;

1.37
date	2008.03.20.11.37.47;	author winiger;	state Exp;
branches;
next	1.36;

1.36
date	2007.09.15.20.38.26;	author merdely;	state Exp;
branches;
next	1.35;

1.35
date	2007.04.28.18.43.30;	author sturm;	state Exp;
branches;
next	1.34;

1.34
date	2007.03.26.19.39.01;	author mbalmer;	state Exp;
branches;
next	1.33;

1.33
date	2007.03.26.06.10.30;	author mbalmer;	state Exp;
branches;
next	1.32;

1.32
date	2006.11.20.20.37.51;	author bernd;	state Exp;
branches
	1.32.2.1;
next	1.31;

1.31
date	2006.10.05.10.19.36;	author mbalmer;	state Exp;
branches;
next	1.30;

1.30
date	2006.10.04.21.41.48;	author mbalmer;	state Exp;
branches;
next	1.29;

1.29
date	2006.10.03.09.16.16;	author mbalmer;	state Exp;
branches;
next	1.28;

1.28
date	2006.07.22.18.18.36;	author steven;	state Exp;
branches
	1.28.2.1;
next	1.27;

1.27
date	2006.06.17.15.23.57;	author naddy;	state Exp;
branches;
next	1.26;

1.26
date	2006.03.16.09.53.55;	author mbalmer;	state Exp;
branches;
next	1.25;

1.25
date	2005.11.06.20.20.58;	author mbalmer;	state Exp;
branches
	1.25.2.1;
next	1.24;

1.24
date	2005.10.07.12.02.19;	author aanriot;	state Exp;
branches;
next	1.23;

1.23
date	2005.09.10.19.42.53;	author espie;	state Exp;
branches;
next	1.22;

1.22
date	2005.03.27.00.18.28;	author naddy;	state Exp;
branches;
next	1.21;

1.21
date	2005.01.20.17.13.28;	author mbalmer;	state Exp;
branches;
next	1.20;

1.20
date	2004.08.06.08.03.39;	author xsa;	state Exp;
branches;
next	1.19;

1.19
date	2004.08.06.07.35.11;	author xsa;	state Exp;
branches;
next	1.18;

1.18
date	2004.08.03.10.16.36;	author xsa;	state Exp;
branches;
next	1.17;

1.17
date	2003.06.21.07.49.24;	author pvalchev;	state Exp;
branches;
next	1.16;

1.16
date	2003.05.14.21.35.52;	author krw;	state Exp;
branches;
next	1.15;

1.15
date	2002.10.18.20.53.01;	author naddy;	state Exp;
branches;
next	1.14;

1.14
date	2002.09.29.06.02.18;	author brad;	state Exp;
branches;
next	1.13;

1.13
date	2002.07.09.12.32.34;	author matt;	state Exp;
branches;
next	1.12;

1.12
date	2002.04.25.18.47.57;	author matt;	state Exp;
branches;
next	1.11;

1.11
date	2002.04.25.15.38.54;	author matt;	state Exp;
branches;
next	1.10;

1.10
date	2002.04.17.16.04.01;	author naddy;	state Exp;
branches;
next	1.9;

1.9
date	2002.04.10.01.39.08;	author matt;	state Exp;
branches
	1.9.2.1;
next	1.8;

1.8
date	2002.03.26.02.50.23;	author matt;	state Exp;
branches;
next	1.7;

1.7
date	2002.02.15.19.55.56;	author matt;	state Exp;
branches;
next	1.6;

1.6
date	2001.11.21.01.33.12;	author matt;	state Exp;
branches;
next	1.5;

1.5
date	2001.11.10.15.00.52;	author espie;	state Exp;
branches;
next	1.4;

1.4
date	2001.11.02.03.35.11;	author matt;	state Exp;
branches;
next	1.3;

1.3
date	2001.10.09.22.58.50;	author matt;	state Exp;
branches
	1.3.2.1;
next	1.2;

1.2
date	2001.09.26.00.55.26;	author matt;	state Exp;
branches;
next	1.1;

1.1
date	2001.08.05.20.44.41;	author matt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2001.08.05.20.44.41;	author matt;	state Exp;
branches;
next	;

1.3.2.1
date	2002.03.05.00.39.53;	author matt;	state Exp;
branches;
next	1.3.2.2;

1.3.2.2
date	2002.04.18.13.41.19;	author matt;	state Exp;
branches;
next	;

1.9.2.1
date	2002.04.18.13.43.43;	author matt;	state Exp;
branches;
next	1.9.2.2;

1.9.2.2
date	2002.09.29.19.37.22;	author brad;	state Exp;
branches;
next	;

1.25.2.1
date	2007.03.28.21.46.28;	author sturm;	state Exp;
branches;
next	1.25.2.2;

1.25.2.2
date	2007.04.01.15.48.37;	author sturm;	state Exp;
branches;
next	;

1.28.2.1
date	2007.04.02.11.51.02;	author sturm;	state Exp;
branches;
next	;

1.32.2.1
date	2007.05.01.16.25.30;	author sturm;	state Exp;
branches;
next	;


desc
@@


1.40
log
@Kill Zope and friends that only run under python 2.4.
ok by many.
@
text
@# $OpenBSD: Makefile,v 1.39 2010/04/14 00:08:16 fgsch Exp $

SUBDIR =
SUBDIR +=	2.10

.include <bsd.port.subdir.mk>
@


1.39
log
@Remove old and not longer supported Zope 2.9.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2010/02/01 17:00:14 espie Exp $
@


1.38
log
@SUBDIR += is wrong: it means the makefile will pick up SUBDIR from env, thus
breaking cd /usr/ports && SUBDIR=some/path make something for
category makefiles. While there, also put spaces around += uniformously.
okay naddy@@, jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2008/03/20 11:37:47 winiger Exp $
a3 1
SUBDIR +=	2.9
@


1.37
log
@split port into multiple versions, unbreaks www/plone

ok mbalmer@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2007/09/15 20:38:26 merdely Exp $
d3 3
a5 2
SUBDIR+=	2.9
SUBDIR+=	2.10
@


1.36
log
@Remove surrounding quotes from
COMMENT-*/ERRORS/NO_REGRESS/PERMIT_*/REGRESS_IS_INTERACTIVE

Change '.include "bsd.port.mk"' to '.include <bsd.port.mk>' while here
(ok naddy@@)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2007/04/28 18:43:30 sturm Exp $
d3 2
a4 1
SHARED_ONLY=	Yes
d6 1
a6 57
COMMENT=	object-oriented web application server

VERSION=	2.10.3
DISTNAME=	Zope-${VERSION}-final
PKGNAME=	${DISTNAME:S/-final//:L}p1
CATEGORIES=     www

HOMEPAGE=	http://www.zope.org/

MAINTAINER=	Marc Balmer <mbalmer@@openbsd.org>

# Zope Public License
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes

MASTER_SITES=	${HOMEPAGE}Products/Zope/${VERSION}/
EXTRACT_SUFX=	.tgz

MODPY_VERSION=	2.4
MODULES=	lang/python

RUN_DEPENDS+=	${MODPY_EXPAT_DEPENDS}

BUILD_ARGS=		--build-base=${WRKSRC} \
			--build-lib="${WRKSRC}/build-lib" \
			--build-scripts="${WRKSRC}/build-scripts" \
			--build-temp="${WRKSRC}/build-temp"

ZOPEHOME=	${PREFIX}/lib/zope
ZOPELIBDIR=	${ZOPEHOME}/lib/python
ZOPEPRODUCTSDIR=${ZOPELIBDIR}/Products
ZOPEUSER=	_zope
ZOPEGROUP=	_zope

MODPY_DISTUTILS_BUILD=	build ${BUILD_ARGS}
MODPY_DISTUTILS_INSTALL=	install --prefix=${ZOPEHOME} ${BUILD_ARGS}

SUBST_VARS+=	PYTHON_VER ZOPEHOME ZOPEUSER ZOPEGROUP

pre-configure:
	@@perl -pi -e 's,%%ZOPEPRODUCTSDIR%%,${ZOPEPRODUCTSDIR},g;' \
		-e 's,%%ZOPEUSER%%,${ZOPEUSER},g' \
			${WRKSRC}/skel/etc/zope.conf.in
	@@sed -e 's,%%ZOPEHOME%%,${ZOPEHOME},g' \
		< ${FILESDIR}/README.OpenBSD > ${WRKSRC}/README.OpenBSD

post-install:
	${INSTALL_DATA} ${WRKSRC}/README.OpenBSD ${ZOPEHOME}/doc
	@@find ${WRKINST} -type f -exec chmod 755 {} \;

do-regress: fake
	${PYTHON_BIN} ${WRKINST}/${ZOPEHOME}/bin/test.py \
		--all -vv -p --libdir ${WRKINST}/${ZOPELIBDIR}

.include <bsd.port.mk>
@


1.35
log
@no longer RUN_DEPENDS on expat
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2007/03/26 19:39:01 mbalmer Exp $
d5 1
a5 1
COMMENT=	"object-oriented web application server"
@


1.34
log
@Our friends at www.zope.org had a little mishap...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2007/03/26 06:10:30 mbalmer Exp $
d9 1
a9 1
PKGNAME=	${DISTNAME:S/-final//:L}p0
d28 1
a28 2
RUN_DEPENDS+=	::textproc/expat \
		${MODPY_EXPAT_DEPENDS}
@


1.33
log
@Update to Zope 2.10.3, this is a bugfix releasse and includes the hotfix
published some days ago:

 http://www.zope.org/Products/Zope/Hotfix-2007-03-20

SECURITY:  This fixes a XSS vulnerability.

Thanks to Ingo Schwarze for the ApplicationManager patch.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2006/11/20 20:37:51 bernd Exp $
d9 1
a9 1
PKGNAME=	${DISTNAME:S/-final//:L}
@


1.32
log
@Fix BUILD_DEPENDS and RUN_DEPENDS.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2006/10/05 10:19:36 mbalmer Exp $
d7 1
a7 1
VERSION=	2.10.0
d9 1
a9 1
PKGNAME=	${DISTNAME:S/-final//:L}p2
@


1.32.2.1
log
@MFC:
Update to Zope 2.10.3, this is a bugfix releasse and includes the hotfix
published some days ago:

http://www.zope.org/Products/Zope/Hotfix-2007-03-20
---
Our friends at www.zope.org had a little mishap...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2006/11/20 20:37:51 bernd Exp $
d7 1
a7 1
VERSION=	2.10.3
d9 1
a9 1
PKGNAME=	${DISTNAME:S/-final//:L}p0
@


1.31
log
@Record RUN_DEPENDS to lang/python,-expat.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2006/10/04 21:41:48 mbalmer Exp $
d9 1
a9 1
PKGNAME=	${DISTNAME:S/-final//:L}p1
d28 1
a28 1
RUN_DEPENDS+=	expat::textproc/expat \
@


1.30
log
@the zope darlings changed the distfile, I bumped the packagename and naddy
gets the cookie for letting me know.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2006/10/03 09:16:16 mbalmer Exp $
d9 1
a9 1
PKGNAME=	${DISTNAME:S/-final//:L}p0
d28 2
a29 3
.if !defined(NO_SHARED_LIBS) || ${NO_SHARED_LIBS:U} != YES
RUN_DEPENDS+=	expat::textproc/expat
.endif
@


1.29
log
@Update to Zope-2.10.0.

See http://www.zope.org/Products/Zope/2.10.0/Zope-2_10_0_released for the
complete release notes.

ok xsa
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2006/07/22 18:18:36 steven Exp $
d9 1
a9 1
PKGNAME=	${DISTNAME:S/-final//:L}
@


1.28
log
@remove NO_CONFIGURE which has been obsolete for ages.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2006/06/17 15:23:57 naddy Exp $
d7 1
a7 1
VERSION=	2.8.6
d9 1
a9 1
PKGNAME=	${DISTNAME:S/-final//:L}p0
d57 1
@


1.28.2.1
log
@Update to Zope 2.8.9.1, this is a bugfix releasse and includes the hotfix
published some days ago:

http://www.zope.org/Products/Zope/Hotfix-2007-03-20

SECURITY:  This fixes a XSS vulnerability.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2006/07/22 18:18:36 steven Exp $
d7 1
a7 1
VERSION=	2.8.9.1
d9 1
a9 1
PKGNAME=	${DISTNAME:S/-final//:L}
a26 1
RUN_DEPENDS=	${MODPY_EXPAT_DEPENDS}
@


1.27
log
@mark as successor to zope-btreefolder2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2006/03/16 09:53:55 mbalmer Exp $
a30 2

NO_CONFIGURE=Yes
@


1.26
log
@Zope-2.8.6, latest stable release of the Zope 2.8 branch.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2005/11/06 20:20:58 mbalmer Exp $
d9 1
a9 1
PKGNAME=	${DISTNAME:S/-final//:L}
@


1.25
log
@Update to Zope 2.8.4 and switch to Python 2.4
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2004/08/06 08:03:39 xsa Exp $
d7 1
a7 1
VERSION=	2.8.4
@


1.25.2.1
log
@Update to Zope 2.8.9, this is a bugfix releasse and includes the hotfix
published some days ago:

http://www.zope.org/Products/Zope/Hotfix-2007-03-20

SECURITY:  This fixes a XSS vulnerability.

Thanks to Ingo Schwarze for the ApplicationManager patch.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2005/11/06 20:20:58 mbalmer Exp $
d7 1
a7 1
VERSION=	2.8.9
@


1.25.2.2
log
@update to zope 2.8.9.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25.2.1 2007/03/28 21:46:28 sturm Exp $
d7 1
a7 1
VERSION=	2.8.9.1
a26 1
RUN_DEPENDS=	${MODPY_EXPAT_DEPENDS}
@


1.24
log
@add a fallback mirror (hosted by martin@@) as zope.org is in trouble.

ok mbalmer@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2005/09/10 19:42:53 espie Exp $
d7 3
a9 3
VERSION=	2.7.4
DISTNAME=	Zope-${VERSION}-0
PKGNAME=	${DISTNAME:S/-0//g:L}p0
d22 1
a22 2
MASTER_SITES=	${HOMEPAGE}Products/Zope/${VERSION}/ \
		http://catai.net/distfiles/
d25 2
a26 2
PYTHON_VER=	2.3
PYTHON_BIN=	${LOCALBASE}/bin/python${PYTHON_VER}
d28 10
a37 14
BUILD_DEPENDS=	${RUN_DEPENDS}
RUN_DEPENDS=	:python-${PYTHON_VER}*:lang/python/${PYTHON_VER} \
		:python-expat-${PYTHON_VER}*:lang/python/${PYTHON_VER},-expat

LIB_DEPENDS=	python2.3.0.0::lang/python/${PYTHON_VER}
WANTLIB=	m c stdc++ pthread util

CONFIGURE_STYLE=simple
CONFIGURE_ARGS=	--with-python=${LOCALBASE}/bin/python${PYTHON_VER} \
		--prefix=${WRKINST}/${ZOPEHOME} \
		--build-base=${WRKSRC}

MAKE_FILE=	makefile
ALL_TARGET=	build
d44 3
@


1.23
log
@fix WANTLIBS
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2005/03/27 00:18:28 naddy Exp $
d22 2
a23 1
MASTER_SITES=	${HOMEPAGE}Products/Zope/${VERSION}/
@


1.22
log
@remove redundant and ineffectual test
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2005/01/20 17:13:28 mbalmer Exp $
d9 1
a9 1
PKGNAME=	${DISTNAME:S/-0//g:L}
d31 3
@


1.21
log
@Update to Zope-2.7.4.

ok xsa@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2004/08/06 08:03:39 xsa Exp $
d29 2
a30 5
RUN_DEPENDS=	:python-${PYTHON_VER}*:lang/python/${PYTHON_VER}

.if !defined(NO_SHARED_LIBS) || ${NO_SHARED_LIBS:U} != YES
RUN_DEPENDS+=	:python-expat-${PYTHON_VER}*:lang/python/${PYTHON_VER},-expat
.endif
@


1.20
log
@
better depends.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2004/08/06 07:35:11 xsa Exp $
d7 1
a7 1
VERSION=	2.7.2
d14 1
a14 1
MAINTAINER=	Marc Balmer <marc@@msys.ch>
@


1.19
log
@
deal with python,-expat on no shared libs archs..
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2004/08/03 10:16:36 xsa Exp $
d29 1
a29 1
RUN_DEPENDS=	::lang/python/${PYTHON_VER}
d32 1
a32 1
RUN_DEPENDS+=	::lang/python/${PYTHON_VER},-expat
@


1.18
log
@
update to zope-2.7.2!!!
new MAINTAINER timeout ...
some input from Aleksander Piotrowski;
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2003/06/21 07:49:24 pvalchev Exp $
d3 1
a3 1
NOT_FOR_ARCHS=	${NO_SHARED_ARCHS}
d29 5
a33 2
RUN_DEPENDS=	::lang/python/${PYTHON_VER} \
		::lang/python/${PYTHON_VER},-expat
@


1.17
log
@maintainership taken by Maurice Nonnekes <maurice@@amaze.nl>
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.16 2003/05/14 21:35:52 krw Exp $
d7 3
a9 5
VERSION=	2.6.1
PORT_VERSION=	${VERSION}

DISTNAME=	Zope-${VERSION}-src
PKGNAME=	zope-${PORT_VERSION}
d14 3
a16 1
# Zope Public License (ZPL) 2.0 <http://www.zope.org/Resources/ZPL>
d22 1
a22 3
MAINTAINER=	Maurice Nonnekes <maurice@@amaze.nl>

MASTER_SITES=	http://www.zope.org/Products/Zope/${VERSION}/
d25 2
a26 8
DIST_SUBDIR=	zope

#MASTER_SITES0=	http://www.zope.org/Members/zigg/UnixSecurityPatch/
#PATCHFILES=	Zope-${VERSION}-unix-security.patch:0
#PATCH_DIST_STRIP=-p1

#HOTFIX_DATE1= 	2002-06-14
#MASTER_SITES1=	http://www.zope.org/Products/Zope/Hotfix_${HOTFIX_DATE1}/
d28 8
a35 1
DISTFILES=	${DISTNAME}${EXTRACT_SUFX}
d37 2
a38 10
BUILD_DEPENDS=	:python->=2.1.3,<2.2:lang/python/2.1
RUN_DEPENDS=	:python->=2.1.3,<2.2:lang/python/2.1

# Note that the configure script is really just for pcgi, but it's
# the only one in the package.

CONFIGURE_STYLE=gnu

WRKBUILD=			${WRKSRC}/pcgi
MODGNU_CONFIG_GUESS_DIRS=	${WRKBUILD}
d41 20
a60 45
PRODUCTSDIR=	${ZOPEHOME}/lib/python/Products

do-build:
	cd ${WRKSRC} && \
		ZDIR=${ZOPEHOME} ${LOCALBASE}/bin/python2.1 w_pcgi.py && \
		ZDIR=${ZOPEHOME} ${LOCALBASE}/bin/python2.1 \
			-O inst/compilezpy.py
	sed -e "s%@@@@PREFIX@@@@%${PREFIX}%g" \
		-e "s%@@@@LOCALBASE@@@@%${LOCALBASE}%g" \
		< ${FILESDIR}/zope-instance > ${WRKSRC}/zope-instance

# All this should give us what closely resembles a zope.org binary
# installation and allow us to rely as much as possible on make
# plist to update to newer versions.

do-install:
	${INSTALL_SCRIPT} ${WRKSRC}/zope-instance ${PREFIX}/bin
	${INSTALL_PROGRAM_DIR} ${ZOPEHOME}
	cp -Rp ${WRKSRC}/* ${ZOPEHOME}
	chown -R ${BINOWN}:${BINGRP} ${ZOPEHOME}
	cd ${ZOPEHOME}/lib && ln -fs ../../python2.1
	rm -r ${ZOPEHOME}/*.txt ${ZOPEHOME}/doc ${ZOPEHOME}/lib/Components \
		${ZOPEHOME}/pcgi/Win32
	find ${ZOPEHOME} -name \*.orig -or -name \*.o -or -name .cvsignore \
		-or -name sedscript -or -name \*.old | xargs rm
	find ${ZOPEHOME}/lib/python -name config.c -or -name Makefile \
		-or -name Makefile.pre -or -name Makefile.pre.in | xargs rm
	rm ${ZOPEHOME}/pcgi/Makefile \
		${ZOPEHOME}/pcgi/config.log ${ZOPEHOME}/pcgi/config.status \
		${ZOPEHOME}/pcgi/config.cache ${ZOPEHOME}/zope-instance \
		${ZOPEHOME}/w*_pcgi.py*
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/zope/changenotes 
	${INSTALL_DATA} ${WRKSRC}/*.txt ${WRKSRC}/doc/*.txt \
		${PREFIX}/share/doc/zope
	${INSTALL_DATA} ${WRKSRC}/doc/changenotes/* \
		${PREFIX}/share/doc/zope/changenotes
	echo "Zope ${VERSION} (OpenBSD package zope-${PORT_VERSION})" \
		> ${PREFIX}/lib/zope/lib/python/version.txt
#	${INSTALL_DATA_DIR} ${PRODUCTSDIR}/Hotfix_${HOTFIX_DATE1}
#	${INSTALL_DATA} \
#		${WRKDIR}/lib/python/Products/Hotfix_${HOTFIX_DATE1}/* \
#		${PRODUCTSDIR}/Hotfix_${HOTFIX_DATE1}

do-regress:
	cd ${WRKSRC} && ${LOCALBASE}/bin/python2.1 utilities/testrunner.py -a
@


1.16
log
@Update to 2.6.1.

MAINTAINER has moved on so remove his name.

ok naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2002/10/18 20:53:01 naddy Exp $
d19 2
@


1.15
log
@Our tar now handles the GNU @@LongLink extension.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2002/09/29 06:02:18 brad Exp $
d5 2
a6 2
VERSION=	2.5.1
PORT_VERSION=	${VERSION}p1
a13 2
MAINTAINER=	Chris Humphries <chumphries@@drauku.net>

d25 3
a27 3
MASTER_SITES0=	http://www.zope.org/Members/zigg/UnixSecurityPatch/
PATCHFILES=	Zope-${VERSION}-unix-security.patch:0
PATCH_DIST_STRIP=-p1
d29 2
a30 2
HOTFIX_DATE1= 	2002-06-14
MASTER_SITES1= 	http://www.zope.org/Products/Zope/Hotfix_${HOTFIX_DATE1}/
d32 1
a32 2
DISTFILES=	${DISTNAME}${EXTRACT_SUFX} \
		Hotfix_${HOTFIX_DATE1}.tgz:1
d34 2
a35 2
BUILD_DEPENDS=	:python->=2.1.2,<2.2:lang/python/2.1
RUN_DEPENDS=	:python->=2.1.2,<2.2:lang/python/2.1
d65 2
a66 2
	chown -R 0:0 ${ZOPEHOME}
	cd ${ZOPEHOME}/lib && ln -s ../../python2.1
d73 1
a73 1
	rm ${ZOPEHOME}/lib/python/Setup ${ZOPEHOME}/pcgi/Makefile \
d84 4
a87 4
	${INSTALL_DATA_DIR} ${PRODUCTSDIR}/Hotfix_${HOTFIX_DATE1}
	${INSTALL_DATA} \
		${WRKDIR}/lib/python/Products/Hotfix_${HOTFIX_DATE1}/* \
		${PRODUCTSDIR}/Hotfix_${HOTFIX_DATE1}
@


1.14
log
@SECURITY: add 2002-06-14 hotfix

The issue involves the security of the indexes of ZCatalog objects. A flaw
in the security settings of ZCatalog allows anonymous users to call arbitrary
methods of catalog indexes. The vulnerability also allows untrusted code to
do the same.
--
From: MAINTAINER
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2002/07/09 12:32:34 matt Exp $
a23 1
EXTRACT_CASES=	*.tgz) gtar zxf ${FULLDISTDIR}/$$archive ;;
d37 1
a37 2
BUILD_DEPENDS=	:python->=2.1.2,<2.2:lang/python/2.1 \
		:gtar-*:archivers/gtar					
@


1.13
log
@taken by Chris Humphries <chumphries@@drauku.net>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2002/04/25 18:47:57 matt Exp $
d6 1
a6 1
PORT_VERSION=	${VERSION}
d26 2
d32 6
d89 4
@


1.12
log
@fix python not being called with full path; noticed by Dean Nevins
<openbsd@@castlebartech.com>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2002/04/25 15:38:54 matt Exp $
a10 1
NEED_VERSION=	1.516
d14 1
a14 1
MAINTAINER=	Matt Behrens <matt@@openbsd.org>
@


1.11
log
@- 2.5.1
- make "prominent notices" in changed files for 100% license compliance
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2002/04/17 16:04:01 naddy Exp $
d48 3
a50 2
		ZDIR=${ZOPEHOME} python2.1 w_pcgi.py && \
		ZDIR=${ZOPEHOME} python2.1 -O inst/compilezpy.py
d84 1
a84 1
	cd ${WRKSRC} && python2.1 utilities/testrunner.py -a
@


1.10
log
@SECURITY:  Add hotfix; from matt@@

The issue involves a vulnerability involving "through the web code"
inadvertently allowing an untrusted user to remotely shut down a
Zope server by allowing the user to inject special headers into the
response. If you allow untrusted users to write "through the web"
code like Python Scripts, DTML Methods, or Page Templates, your
Zope server is vulnerable.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2002/04/10 01:39:08 matt Exp $
d5 2
a6 2
VERSION=	2.5.1b1
PORT_VERSION=	${VERSION}.1
d17 1
a30 6
HOTFIX_DATE1=	2002-04-15
MASTER_SITES1=	http://www.zope.org/Products/Zope/Hotfix_${HOTFIX_DATE1}/

DISTFILES=	${DISTNAME}${EXTRACT_SUFX} \
		Hotfix_${HOTFIX_DATE1}.tgz:1

a80 4
	${INSTALL_DATA_DIR} ${PRODUCTSDIR}/Hotfix_${HOTFIX_DATE1}
	${INSTALL_DATA} \
		${WRKDIR}/lib/python/Products/Hotfix_${HOTFIX_DATE1}/* \
		${PRODUCTSDIR}/Hotfix_${HOTFIX_DATE1}
@


1.9
log
@correct python dependency spec; ok naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2002/03/26 02:50:23 matt Exp $
d6 1
a6 1
PORT_VERSION=	${VERSION}
d30 6
d86 4
a94 1

@


1.9.2.1
log
@SECURITY: add 2002-04-15 hotfix

This issue involves a vulnerability involving "through the web code"
inadvertently allowing an untrusted user to remotely shut down a
Zope server by allowing the user to inject special headers into the
response.  If you allow untrusted users to write "through the web"
code like Python Scripts, DTML Methods, or Page Templates, your
Zope server is vulnerable.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2002/04/10 01:39:08 matt Exp $
d6 1
a6 1
PORT_VERSION=	${VERSION}.1
a29 6
HOTFIX_DATE1=	2002-04-15
MASTER_SITES1=	http://www.zope.org/Products/Zope/Hotfix_${HOTFIX_DATE1}/

DISTFILES=	${DISTNAME}${EXTRACT_SUFX} \
		Hotfix_${HOTFIX_DATE1}.tgz:1

a79 4
	${INSTALL_DATA_DIR} ${PRODUCTSDIR}/Hotfix_${HOTFIX_DATE1}
	${INSTALL_DATA} \
		${WRKDIR}/lib/python/Products/Hotfix_${HOTFIX_DATE1}/* \
		${PRODUCTSDIR}/Hotfix_${HOTFIX_DATE1}
@


1.9.2.2
log
@MFC:
Zope 2.5.1
+
SECURITY: add 2002-06-14 hotfix

The issue involves the security of the indexes of ZCatalog objects. A flaw
in the security settings of ZCatalog allows anonymous users to call arbitrary
methods of catalog indexes. The vulnerability also allows untrusted code to
do the same.
--
From: MAINTAINER
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9.2.1 2002/04/18 13:43:43 matt Exp $
d5 2
a6 2
VERSION=	2.5.1
PORT_VERSION=	${VERSION}p1
d15 1
a15 1
MAINTAINER=	Chris Humphries <chumphries@@drauku.net>
a16 1
# Zope Public License (ZPL) 2.0 <http://www.zope.org/Resources/ZPL>
a25 2
DIST_SUBDIR=	zope

d30 2
a31 2
HOTFIX_DATE1= 	2002-06-14
MASTER_SITES1= 	http://www.zope.org/Products/Zope/Hotfix_${HOTFIX_DATE1}/
d53 2
a54 3
		ZDIR=${ZOPEHOME} ${LOCALBASE}/bin/python2.1 w_pcgi.py && \
		ZDIR=${ZOPEHOME} ${LOCALBASE}/bin/python2.1 \
			-O inst/compilezpy.py
d92 1
a92 1
	cd ${WRKSRC} && ${LOCALBASE}/bin/python2.1 utilities/testrunner.py -a
d95 1
@


1.8
log
@Upgrade to 2.5.1b1, as it's got a few important fixes, and nobody
knows if 2.5.1 is going to come out in time for the release.

Also add my patch to fix setuid support (not used by default) and
set our own version string to distinguish this from an "official"
Zope release.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2002/02/15 19:55:56 matt Exp $
d30 1
a30 1
BUILD_DEPENDS=	:python->=2.1.2:lang/python/2.1 \
d32 1
a32 1
RUN_DEPENDS=	:python->=2.1.2:lang/python/2.1
@


1.7
log
@zope 2.5.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2001/11/21 01:33:12 matt Exp $
d5 3
a7 1
VERSION=	2.5.0
d9 1
a9 1
PKGNAME=	zope-${VERSION}
d11 1
a11 1
NEED_VERSION=	1.504
d26 5
a30 1
BUILD_DEPENDS=	:python-2.1*:lang/python/2.1 \
d32 1
a32 1
RUN_DEPENDS=	:python-2.1*:lang/python/2.1
d78 2
@


1.6
log
@- update to 2.4.3
- package spec for gtar
- distinfo
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2001/11/10 15:00:52 espie Exp $
d5 1
a5 1
VERSION=	2.4.3
d9 1
a9 1
NEED_VERSION=	1.498
d24 1
a24 1
BUILD_DEPENDS=	:python-2.1*-threads:lang/python \
d26 1
a26 1
RUN_DEPENDS=	:python-2.1*-threads:lang/python
d41 2
a42 2
		ZDIR=${ZOPEHOME} python w_pcgi.py && \
		ZDIR=${ZOPEHOME} python -O inst/compilezpy.py
d74 1
a74 1
	cd ${WRKSRC} && python utilities/testrunner.py -a
@


1.5
log
@Kill first component of BUILD_DEPENDS.

Fix sawfish comment while I'm at it.
`window manager for the X windows system'.
Like DUH ! It's going to be a window manager for my microwave oven ?
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2001/11/02 03:35:11 matt Exp $
d5 1
a5 1
VERSION=	2.4.2
d9 1
a9 1
NEED_VERSION=	1.488
d25 1
a25 1
		::archivers/gtar					
@


1.4
log
@- update to 2.4.2
- regress
- add zope-instance relative path support
- do optimizing compile on python files too, like lang/python, and use optimized in default zope-instance start script
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2001/10/09 22:58:50 matt Exp $
d24 3
a26 3
BUILD_DEPENDS=	python2.1:python-2.1*-threads:lang/python \
		gtar::archivers/gtar					
RUN_DEPENDS=	python2.1:python-2.1*-threads:lang/python
@


1.3
log
@- update to 2.4.1.1 (add 2001-09-28 hotfix for dtml-var fmt security checks)
- CONFIGURE_STYLE=gnu (spotted by naddy@@)
- MODGNU_CONFIG_GUESS_DIRS even though it's not actually used by this configure script
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2001/09/26 00:55:26 matt Exp $
d5 1
a5 1
VERSION=	2.4.1
d7 1
a7 1
PKGNAME=	zope-${VERSION}.1
d9 1
a9 1
NEED_VERSION=	1.419
a23 5
HOTFIX_DATE0=	2001-09-28
MASTER_SITES0=	http://www.zope.org/Products/Zope/Hotfix_${HOTFIX_DATE0}/
DISTFILES=	${DISTNAME}${EXTRACT_SUFX} \
		Hotfix_${HOTFIX_DATE0}.tgz:0

d40 3
a42 1
	cd ${WRKSRC} && ZDIR=${ZOPEHOME} python w_pcgi.py
d72 3
a74 4
	${INSTALL_DATA_DIR} ${PRODUCTSDIR}/Hotfix_${HOTFIX_DATE0}
	${INSTALL_DATA} \
		${WRKDIR}/lib/python/Products/Hotfix_${HOTFIX_DATE0}/* \
		${PRODUCTSDIR}/Hotfix_${HOTFIX_DATE0}
@


1.3.2.1
log
@SECURITY FIX: add 2002-03-01 hotfix.

The issue involves the checking of security for objects with proxy
roles. The context of the owner user that created the object with
proxy roles was not being taken into account when determining access
to the object with proxy roles. This flaw could allow users defined
in subfolders of a site with sufficient privileges to access objects
at higher levels in the site that they would not normally be able
to access.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2001/10/09 22:58:50 matt Exp $
d7 1
a7 1
PKGNAME=	zope-${VERSION}.2
a25 2
HOTFIX_DATE1=	2002-03-01
MASTER_SITES1=	http://www.zope.org/Products/Zope/Hotfix_${HOTFIX_DATE1}/
d27 1
a27 2
		Hotfix_${HOTFIX_DATE0}.tgz:0 \
		Hotfix_${HOTFIX_DATE1}.tgz:1
a78 4
	${INSTALL_DATA_DIR} ${PRODUCTSDIR}/Hotfix_${HOTFIX_DATE1}
	${INSTALL_DATA} \
		${WRKDIR}/lib/python/Products/Hotfix_${HOTFIX_DATE1}/* \
		${PRODUCTSDIR}/Hotfix_${HOTFIX_DATE1}
@


1.3.2.2
log
@SECURITY: add 2002-04-15 hotfix

This issue involves a vulnerability involving "through the web code"
inadvertently allowing an untrusted user to remotely shut down a
Zope server by allowing the user to inject special headers into the
response.  If you allow untrusted users to write "through the web"
code like Python Scripts, DTML Methods, or Page Templates, your
Zope server is vulnerable.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3.2.1 2002/03/05 00:39:53 matt Exp $
d7 1
a7 1
PKGNAME=	zope-${VERSION}.3
a27 2
HOTFIX_DATE2=	2002-04-15
MASTER_SITES2=	http://www.zope.org/Products/Zope/Hotfix_${HOTFIX_DATE2}/
d30 1
a30 2
		Hotfix_${HOTFIX_DATE1}.tgz:1 \
		Hotfix_${HOTFIX_DATE2}.tgz:2
d33 1
a33 1
		gtar::archivers/gtar
a85 4
	${INSTALL_DATA_DIR} ${PRODUCTSDIR}/Hotfix_${HOTFIX_DATE2}
	${INSTALL_DATA} \
		${WRKDIR}/lib/python/Products/Hotfix_${HOTFIX_DATE2}/* \
		${PRODUCTSDIR}/Hotfix_${HOTFIX_DATE2}
@


1.2
log
@- update to 2.4.1
- depend on gtar instead of crazy hackery
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2001/08/05 20:44:41 matt Exp $
d7 1
a7 1
PKGNAME=	zope-${VERSION}
d24 5
d36 1
a36 1
CONFIGURE_STYLE=autoconf
d38 2
a39 2
WRKBUILD=	${WRKSRC}/pcgi
AUTOCONF_DIR=	${WRKBUILD}
d75 4
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d5 1
a5 1
VERSION=	2.4.0
d7 1
a7 1
PKGNAME=	zope-${VERSION}.2
d22 1
d24 2
a25 9
HOTFIX_DATE0=	2001_07_25
MASTER_SITES0=	http://www.zope.org/Products/Zope/Hotfix_${HOTFIX_DATE0:S/_/-/g}/
HOTFIX_DATE1=	2001_08_04
MASTER_SITES1=	http://www.zope.org/Products/Zope/Hotfix_${HOTFIX_DATE1:S/_/-/g}/
DISTFILES=	${DISTNAME}${EXTRACT_SUFX} \
		Hotfix_${HOTFIX_DATE0:S/_/-/g}.tar.gz:0 \
		Hotfix_${HOTFIX_DATE1}.tgz:1

BUILD_DEPENDS=	python2.1:python-2.1*-threads:lang/python
d28 2
a29 3
# Note that the configure script is really just for pcgi, but as
# it's the only one in the package, I figured it was safe to call it
# "the" configure script.
a38 7
# Fix @@LongLinks so we don't have to depend on gtar

post-extract:
	cd ${WRKSRC}/lib/python/Products/PluginIndexes/TextIndex/Splitter/ISO_8859_1_Splitter && \
		mv Makefile.pr Makefile.pre.in && \
		mv src/Splitte src/Splitter.c

d46 2
a47 8
# installation, which is currently impossible via the tarball-included
# scriptage, and allow us to rely as much as possible on make plist
# to update to newer versions.

# Hopefully we can work towards something cleaner in the future when
# the developers release their binary-making scripts.  I am told that
# as part of the "fishbowl" process Zope Corp. is undertaking, their
# package build scripts will soon be available.
d58 1
a58 2
		-or -name sedscript \
		| xargs rm
d60 1
a60 2
		-or -name Makefile.pre -or -name Makefile.pre.in \
		| xargs rm
a69 8
	${INSTALL_DATA_DIR} ${PRODUCTSDIR}/Hotfix_${HOTFIX_DATE0}
	${INSTALL_DATA} \
		${WRKDIR}/lib/python/Products/Hotfix_${HOTFIX_DATE0}/* \
		${PRODUCTSDIR}/Hotfix_${HOTFIX_DATE0}
	${INSTALL_DATA_DIR} ${PRODUCTSDIR}/Hotfix_${HOTFIX_DATE1}
	${INSTALL_DATA} \
		${WRKDIR}/lib/python/Products/Hotfix_${HOTFIX_DATE1}/* \
		${PRODUCTSDIR}/Hotfix_${HOTFIX_DATE1}
@


1.1.1.1
log
@add zope-2.4.0.2
@
text
@@
