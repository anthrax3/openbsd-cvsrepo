head	1.4;
access;
symbols
	OPENBSD_3_5:1.3.0.10
	OPENBSD_3_5_BASE:1.3
	OPENBSD_3_4:1.3.0.8
	OPENBSD_3_4_BASE:1.3
	OPENBSD_3_3:1.3.0.6
	OPENBSD_3_3_BASE:1.3
	OPENBSD_3_2:1.3.0.4
	OPENBSD_3_2_BASE:1.3
	OPENBSD_3_1:1.3.0.2
	OPENBSD_3_1_BASE:1.3
	OPENBSD_3_0:1.2.0.2
	OPENBSD_3_0_BASE:1.2
	OPENBSD_2_9_TRACKING_SWITCH:1.1.1.1
	matt_2001-08-05:1.1.1.1
	matt:1.1.1;
locks; strict;
comment	@# @;


1.4
date	2004.08.03.10.16.36;	author xsa;	state dead;
branches;
next	1.3;

1.3
date	2001.11.02.03.35.11;	author matt;	state Exp;
branches;
next	1.2;

1.2
date	2001.10.17.03.10.35;	author matt;	state Exp;
branches;
next	1.1;

1.1
date	2001.08.05.20.44.41;	author matt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2001.08.05.20.44.41;	author matt;	state Exp;
branches;
next	;


desc
@@


1.4
log
@
update to zope-2.7.2!!!
new MAINTAINER timeout ...
some input from Aleksander Piotrowski;
@
text
@#!@@@@LOCALBASE@@@@/bin/python2.1
#
# $OpenBSD: zope-instance,v 1.3 2001/11/02 03:35:11 matt Exp $
#
# Build a Zope INSTANCE_HOME in the specified directory.
#
# Run this script as the user who will be owning this Zope installation.
# The instance directory must already exist, and be empty.
#
# Matt Behrens <matt@@openbsd.org>
#

zopehome="@@@@PREFIX@@@@/lib/zope"

import os, shutil, sys

if len(sys.argv) != 2:
	print "usage: %s instance-directory" % sys.argv[0]
	sys.exit(0)

instancehome=os.path.abspath(sys.argv[1])

for directory in ("import", "var", "Extensions", "Products"):
	os.mkdir(os.path.join(instancehome, directory))

# Copy the initial Data.fs
datafs = "%s/var/Data.fs" % instancehome
shutil.copyfile("%s/var/Data.fs.in" % zopehome, datafs)
os.chmod(datafs, 0600)

# Import installation modules
sys.path.insert(0, zopehome)
sys.path.insert(0, "%s/inst" % zopehome)
import make_start, zpasswd
python=sys.executable

# Create Zope.cgi
open("%s/Zope.cgi" % instancehome, "w").write(
"""#!%(zopehome)s/pcgi/pcgi-wrapper
PCGI_NAME=Zope
PCGI_MODULE_PATH=%(zopehome)s/lib/python/Zope
PCGI_PUBLISHER=%(zopehome)s/pcgi/pcgi_publisher.py
PCGI_EXE=%(python)s
PCGI_SOCKET_FILE=%(instancehome)s/var/pcgi.soc
PCGI_PID_FILE=%(instancehome)s/var/pcgi.pid
PCGI_ERROR_LOG=%(instancehome)s/var/pcgi.log
PCGI_DISPLAY_ERRORS=1
BOBO_REALM=%(instancehome)s/Zope.cgi
BOBO_DEBUG_MODE=1
INSTANCE_HOME=%(instancehome)s
""" % vars())
os.chmod("%s/Zope.cgi" % instancehome, 04750)

# Create start and stop scripts
make_start.sh(instancehome, '', '')
open("%s/start" % instancehome, "w").write(
"""#!/bin/sh
export INSTANCE_HOME=%(instancehome)s
export PYTHONHOME=%(zopehome)s
exec %(python)s -O $PYTHONHOME/z2.py -D "$@@" -p %(instancehome)s/Zope.cgi
""" % vars())

# Create the admin user
zpasswd.write_inituser(instancehome, '', '')

@


1.3
log
@- update to 2.4.2
- regress
- add zope-instance relative path support
- do optimizing compile on python files too, like lang/python, and use optimized in default zope-instance start script
@
text
@d3 1
a3 1
# $OpenBSD: zope-instance,v 1.2 2001/10/17 03:10:35 matt Exp $
@


1.2
log
@typo, imports -> import, ok naddy@@
@
text
@d3 1
a3 1
# $OpenBSD: zope-instance,v 1.1.1.1 2001/08/05 20:44:41 matt Exp $
d20 2
a21 1
instancehome=sys.argv[1]
d60 1
a60 1
exec %(python)s $PYTHONHOME/z2.py -D "$@@" -p %(instancehome)s/Zope.cgi
@


1.1
log
@Initial revision
@
text
@d3 1
a3 1
# $OpenBSD$
d22 1
a22 1
for directory in ("imports", "var", "Extensions", "Products"):
@


1.1.1.1
log
@add zope-2.4.0.2
@
text
@@
