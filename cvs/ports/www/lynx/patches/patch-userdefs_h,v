head	1.2;
access;
symbols
	OPENBSD_6_0:1.1.0.2
	OPENBSD_6_0_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2016.09.04.13.35.02;	author fcambus;	state Exp;
branches;
next	1.1;
commitid	6PUflaF4UlBNS5VW;

1.1
date	2016.04.15.03.21.52;	author tb;	state Exp;
branches;
next	;
commitid	b00Egp9kKFxMEkyS;


desc
@@


1.2
log
@Disable spawning an external viewer. On top of disabling the hardcoded
XLOADIMAGE_COMMAND value in userdefs.h, we also remove the possibility
of setting a custom value in lynx.cfg.

The ability to assign MIME types to external viewers via configuration
file (via the VIEWER variables) is also disabled.

OK tb@@
@
text
@$OpenBSD: patch-userdefs_h,v 1.1 2016/04/15 03:21:52 tb Exp $
--- userdefs.h.orig	Mon Apr 11 02:42:17 2016
+++ userdefs.h	Sun Jun  5 00:31:29 2016
@@@@ -129,8 +129,8 @@@@
  * Mappings in these global and personal files override any VIEWER
  * definitions in lynx.cfg and built-in defaults from src/HTInit.c.
  */
-#define GLOBAL_MAILCAP "Lynx_Dir:mailcap"
-#define PERSONAL_MAILCAP ".mailcap"
+#define GLOBAL_MAILCAP "/dev/null"
+#define PERSONAL_MAILCAP "/dev/null"
 
 /**************************
  * XLOADIMAGE_COMMAND will be used as a default in src/HTInit.c
@@@@ -327,8 +327,8 @@@@
  * Mappings in these global and personal files override any VIEWER
  * definitions in lynx.cfg and built-in defaults from src/HTInit.c.
  */
-#define GLOBAL_MAILCAP MIME_LIBDIR "mailcap"
-#define PERSONAL_MAILCAP "~/.mailcap"
+#define GLOBAL_MAILCAP "/dev/null"
+#define PERSONAL_MAILCAP "/dev/null"
 
 /**************************
  * XLOADIMAGE_COMMAND will be used as a default in src/HTInit.c for
@@@@ -345,7 +345,7 @@@@
  * use any default viewers for image types.  Note that open is used as
  * the default for NeXT, instead of the XLOADIMAGE_COMMAND definition.
  */
-#define XLOADIMAGE_COMMAND "xli %s &"
+#define XLOADIMAGE_COMMAND NULL
 
 /**************************
  * For UNIX systems, SYSTEM_MAIL and SYSTEM_MAIL_FLAGS are set by the
@


1.1
log
@Help lynx to live up to its no "proc" and no "exec" promises:

sthen@@ found that the mailcap mechanism can spawn a viewer. Rename
the hardcoded /etc/mailcap and ~/.mailcap files to /dev/null and
disable the ability to undo that via a config file. lynx copes by
offering to download files with MIME types it can't handle itself.

fcambus found that "lynx index.html" + typing e spawns an editor.
Hardcode "no_editor = TRUE" before pledge() and tweak manpage.

Most of this is by fcambus (MAINTAINER).
/dev/null bit from me, based on a hint from sthen@@.

ok sthen@@ on previous version
@
text
@d1 3
a3 3
$OpenBSD$
--- userdefs.h.orig	Tue Dec 22 02:45:35 2015
+++ userdefs.h	Thu Apr 14 00:11:57 2016
d26 9
@

