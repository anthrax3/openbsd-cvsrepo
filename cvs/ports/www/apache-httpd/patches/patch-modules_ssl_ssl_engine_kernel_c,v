head	1.1;
access;
symbols
	OPENBSD_6_1:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2017.07.14.17.04.12;	author sthen;	state Exp;
branches
	1.1.2.1;
next	;
commitid	wQJfYUy8pBAlIj4V;

1.1.2.1
date	2017.07.14.18.32.13;	author sthen;	state Exp;
branches;
next	;
commitid	MEbuZd9kS5MbNvBV;


desc
@@


1.1
log
@security update to apache-httpd-2.4.26, from David CARLIER with minor tweaks from me
(2.4.27 to follow)
@
text
@$OpenBSD$

Index: modules/ssl/ssl_engine_kernel.c
--- modules/ssl/ssl_engine_kernel.c.orig
+++ modules/ssl/ssl_engine_kernel.c
@@@@ -1733,7 +1733,7 @@@@ static void modssl_proxy_info_log(conn_rec *c,
  * so we need to increment here to prevent them from
  * being freed.
  */
-#if OPENSSL_VERSION_NUMBER < 0x10100000L
+#if OPENSSL_VERSION_NUMBER < 0x10100000L || defined(LIBRESSL_VERSION_NUMBER)
 #define modssl_set_cert_info(info, cert, pkey) \
     *cert = info->x509; \
     CRYPTO_add(&(*cert)->references, +1, CRYPTO_LOCK_X509); \
@@@@ -1923,7 +1923,7 @@@@ int ssl_callback_NewSessionCacheEntry(SSL *ssl, SSL_SE
  *  of our other Apache pre-forked server processes.
  */
 SSL_SESSION *ssl_callback_GetSessionCacheEntry(SSL *ssl,
-                                               IDCONST unsigned char *id,
+                                               unsigned char *id,
                                                int idlen, int *do_copy)
 {
     /* Get Apache context back through OpenSSL context */
@


1.1.2.1
log
@MFC security update to Apache httpd-2.4.27

fixed in 2.4.26:

ap_get_basic_auth_pw() Authentication Bypass CVE-2017-3167
mod_ssl Null Pointer Dereference CVE-2017-3169
mod_http2 Null Pointer Dereference CVE-2017-7659
ap_find_token() Buffer Overread CVE-2017-7668
mod_mime Buffer Overread CVE-2017-7679

fixed in 2.4.27:

Read after free in mod_http2 CVE-2017-9789
Uninitialized memory reflection in mod_auth_digest CVE-2017-9788
@
text
@d1 1
a1 1
$OpenBSD: patch-modules_ssl_ssl_engine_kernel_c,v 1.1 2017/07/14 17:04:12 sthen Exp $
@

