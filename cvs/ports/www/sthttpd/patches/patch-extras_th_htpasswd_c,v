head	1.1;
access;
symbols
	OPENBSD_6_1:1.1.0.12
	OPENBSD_6_1_BASE:1.1
	OPENBSD_6_0:1.1.0.10
	OPENBSD_6_0_BASE:1.1
	OPENBSD_5_9:1.1.0.6
	OPENBSD_5_9_BASE:1.1
	OPENBSD_5_8:1.1.0.8
	OPENBSD_5_8_BASE:1.1
	OPENBSD_5_7:1.1.0.4
	OPENBSD_5_7_BASE:1.1
	OPENBSD_5_6:1.1.0.2
	OPENBSD_5_6_BASE:1.1;
locks; strict;
comment	@# @;


1.1
date	2014.05.06.09.00.37;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.1
log
@update to sthttpd-2.26.4
* while this is the 'gentoo version' it does resolve htpasswd conflict
* drop a patch in favor of FAKE_FLAGS while here

discussed with/ok brad@@
@
text
@$OpenBSD$

A local attacker with the ability to alter .htpasswd files could
cause a Denial of Service in thttpd by specially-crafting them.
CVE-2012-5640

--- extras/th_htpasswd.c.orig	Thu May  1 10:49:44 2014
+++ extras/th_htpasswd.c	Thu May  1 10:50:16 2014
@@@@ -140,7 +140,10 @@@@ add_password( char* user, FILE* f )
     (void) srandom( (int) time( (time_t*) 0 ) );
     to64( &salt[0], random(), 2 );
     cpw = crypt( pw, salt );
-    (void) fprintf( f, "%s:%s\n", user, cpw );
+    if (cpw)
+       (void) fprintf( f, "%s:%s\n", user, cpw );
+     else
+       (void) fprintf( stderr, "crypt() returned NULL, sorry\n" );
     }
 
 static void usage(void) {
@
