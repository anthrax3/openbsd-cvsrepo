head	1.2;
access;
symbols
	OPENBSD_5_1_BASE:1.1
	OPENBSD_5_1:1.1.0.6
	OPENBSD_5_0:1.1.0.4
	OPENBSD_5_0_BASE:1.1
	OPENBSD_4_9:1.1.0.2;
locks; strict;
comment	@# @;


1.2
date	2012.05.25.14.32.15;	author fgsch;	state dead;
branches;
next	1.1;

1.1
date	2011.03.07.18.38.06;	author jasper;	state Exp;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2011.03.09.09.12.43;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Update to 1.9.4.
See http://hg.moinmo.in/moin/1.9/raw-file/1.9.4/docs/CHANGES for details
@
text
@$OpenBSD: patch-MoinMoin_parser_text_rst_py,v 1.1 2011/03/07 18:38:06 jasper Exp $

Security fix for CVE-2011-1058,
MoinMoin "refuri" Cross-Site Scripting Vulnerability

Patch from upstream Mercurial:
http://hg.moinmo.in/moin/1.9/rev/97208f67798f

--- MoinMoin/parser/text_rst.py.orig	Mon Mar  7 19:35:58 2011
+++ MoinMoin/parser/text_rst.py	Mon Mar  7 19:36:02 2011
@@@@ -391,6 +391,9 @@@@ class MoinTranslator(html4css1.HTMLTranslator):
                 # for images with targets).
                 if not [i for i in node.children if i.__class__ == docutils.nodes.image]:
                     node['classes'].append('interwiki')
+            elif prefix == 'javascript':
+                # is someone trying to do XSS with javascript?
+                node['refuri'] = 'javascript:alert("it does not work")'
             elif prefix != '':
                 # Some link scheme (http, file, https, mailto, etc.), add class
                 # information if the reference doesn't have a child image (don't
@


1.1
log
@Security fix for CVE-2011-1058,
MoinMoin "refuri" Cross-Site Scripting Vulnerability

Note that 'rst' is not the default parser, but available if docutils are installed. For more information see http://moinmo.in/SecurityFixes
@
text
@d1 1
a1 1
$OpenBSD$
@


1.1.2.1
log
@Security fix for CVE-2011-1058,
MoinMoin "refuri" Cross-Site Scripting Vulnerability

Note that 'rst' is not the default parser, but available if docutils are installed. For more information see http://moinmo.in/SecurityFixes
@
text
@d1 1
a1 1
$OpenBSD: patch-MoinMoin_parser_text_rst_py,v 1.1 2011/03/07 18:38:06 jasper Exp $
@

