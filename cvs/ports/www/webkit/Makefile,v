head	1.150;
access;
symbols
	OPENBSD_6_1:1.150.0.2
	OPENBSD_6_1_BASE:1.150
	OPENBSD_6_0:1.148.0.2
	OPENBSD_6_0_BASE:1.148
	OPENBSD_5_9:1.144.0.2
	OPENBSD_5_9_BASE:1.144
	OPENBSD_5_8:1.141.0.4
	OPENBSD_5_8_BASE:1.141
	OPENBSD_5_7:1.132.0.2
	OPENBSD_5_7_BASE:1.132
	OPENBSD_5_6:1.121.0.2
	OPENBSD_5_6_BASE:1.121
	OPENBSD_5_5:1.106.0.2
	OPENBSD_5_5_BASE:1.106
	OPENBSD_5_4:1.90.0.2
	OPENBSD_5_4_BASE:1.90
	OPENBSD_5_3:1.77.0.2
	OPENBSD_5_3_BASE:1.77
	OPENBSD_5_2:1.65.0.2
	OPENBSD_5_2_BASE:1.65
	OPENBSD_5_1_BASE:1.60
	OPENBSD_5_1:1.60.0.2
	OPENBSD_5_0:1.54.0.2
	OPENBSD_5_0_BASE:1.54
	OPENBSD_4_9:1.41.0.2
	OPENBSD_4_9_BASE:1.41
	OPENBSD_4_8:1.31.0.2
	OPENBSD_4_8_BASE:1.31
	OPENBSD_4_7:1.23.0.2
	OPENBSD_4_7_BASE:1.23
	OPENBSD_4_6:1.15.0.2
	OPENBSD_4_6_BASE:1.15
	OPENBSD_4_5:1.8.0.2
	OPENBSD_4_5_BASE:1.8
	OPENBSD_4_4:1.3.0.2
	OPENBSD_4_4_BASE:1.3
	landry_20080725:1.1.1.1
	landry:1.1.1;
locks; strict;
comment	@# @;


1.150
date	2017.01.31.08.57.14;	author ajacoutot;	state Exp;
branches;
next	1.149;
commitid	PY9revcgMF6TDqyW;

1.149
date	2016.09.01.15.50.30;	author ajacoutot;	state Exp;
branches;
next	1.148;
commitid	YulMFaGUxvJueXl7;

1.148
date	2016.04.22.12.02.08;	author naddy;	state Exp;
branches;
next	1.147;
commitid	sjvPI5gwyrHQAdAl;

1.147
date	2016.04.17.13.18.43;	author ajacoutot;	state Exp;
branches;
next	1.146;
commitid	Wu4MeEauf6XNV4ue;

1.146
date	2016.04.16.18.23.31;	author ajacoutot;	state Exp;
branches;
next	1.145;
commitid	PPpn0mIbSVOW1Nsy;

1.145
date	2016.03.16.07.10.57;	author ajacoutot;	state Exp;
branches;
next	1.144;
commitid	oPcf1vDRhq4iPuwA;

1.144
date	2016.02.04.13.34.20;	author ajacoutot;	state Exp;
branches
	1.144.2.1;
next	1.143;
commitid	CiRGqtEEZ34NvY7m;

1.143
date	2015.11.20.11.24.04;	author sthen;	state Exp;
branches;
next	1.142;
commitid	xESrXKEQBEZ66Kvo;

1.142
date	2015.11.15.12.45.48;	author ajacoutot;	state Exp;
branches;
next	1.141;
commitid	zTUzaL1ss9wCKbIL;

1.141
date	2015.07.16.17.27.09;	author jeremy;	state Exp;
branches
	1.141.4.1;
next	1.140;
commitid	wGOk1Dw0Jh0UvwX9;

1.140
date	2015.05.28.10.17.25;	author pascal;	state Exp;
branches;
next	1.139;
commitid	020U4lCPk8wUkCOz;

1.139
date	2015.05.26.06.30.45;	author ajacoutot;	state Exp;
branches;
next	1.138;
commitid	jPoZV6Nc2yqtWrGd;

1.138
date	2015.05.20.15.32.54;	author ajacoutot;	state Exp;
branches;
next	1.137;
commitid	xJOF76FfGW7vXv8h;

1.137
date	2015.04.15.09.40.52;	author ajacoutot;	state Exp;
branches;
next	1.136;
commitid	dfR1rb9OtImYnGFF;

1.136
date	2015.04.10.06.30.40;	author ajacoutot;	state Exp;
branches;
next	1.135;
commitid	7hVF29pMq796QzLZ;

1.135
date	2015.04.08.21.42.14;	author ajacoutot;	state Exp;
branches;
next	1.134;
commitid	JM3JS9ubTFeKwcG6;

1.134
date	2015.04.04.09.21.04;	author ajacoutot;	state Exp;
branches;
next	1.133;
commitid	kS3kwKZogsvzYmEY;

1.133
date	2015.03.27.16.02.49;	author ajacoutot;	state Exp;
branches;
next	1.132;
commitid	25g9j8MWMDzdqcV8;

1.132
date	2015.01.12.13.22.46;	author ajacoutot;	state Exp;
branches;
next	1.131;
commitid	ih9arJlQinoLlVkp;

1.131
date	2015.01.10.00.38.38;	author ajacoutot;	state Exp;
branches;
next	1.130;
commitid	6GNZjB621kuzFsEK;

1.130
date	2014.12.30.21.50.25;	author landry;	state Exp;
branches;
next	1.129;
commitid	S07Q8URJzYgrU6Yg;

1.129
date	2014.10.24.16.06.27;	author ajacoutot;	state Exp;
branches;
next	1.128;
commitid	KIAfhdNFSPqIV4yt;

1.128
date	2014.09.30.12.18.09;	author ajacoutot;	state Exp;
branches;
next	1.127;
commitid	K8DkGyEKePFKvQ1V;

1.127
date	2014.09.29.12.14.30;	author ajacoutot;	state Exp;
branches;
next	1.126;
commitid	KQGxpPDt9X6A3M0g;

1.126
date	2014.09.29.11.57.54;	author ajacoutot;	state Exp;
branches;
next	1.125;
commitid	XjOpmXfdRZViHVwQ;

1.125
date	2014.09.28.06.52.14;	author ajacoutot;	state Exp;
branches;
next	1.124;
commitid	WG3T5X7WYzJwFEVR;

1.124
date	2014.09.05.14.45.02;	author jasper;	state Exp;
branches;
next	1.123;
commitid	f4VbjcUvEOJXzzBc;

1.123
date	2014.09.02.14.28.20;	author jasper;	state Exp;
branches;
next	1.122;
commitid	WEwi6sK930zD4JU4;

1.122
date	2014.08.26.21.31.03;	author ajacoutot;	state Exp;
branches;
next	1.121;
commitid	AvZQls8sW8IRAp8T;

1.121
date	2014.07.14.21.13.31;	author ajacoutot;	state Exp;
branches
	1.121.2.1;
next	1.120;
commitid	Nz1KPcOJtAApHF1B;

1.120
date	2014.07.09.17.43.52;	author ajacoutot;	state Exp;
branches;
next	1.119;
commitid	Nm4l5yAcUVwu1rIN;

1.119
date	2014.05.26.16.52.35;	author ajacoutot;	state Exp;
branches;
next	1.118;

1.118
date	2014.05.12.13.19.33;	author ajacoutot;	state Exp;
branches;
next	1.117;

1.117
date	2014.04.20.16.40.55;	author ajacoutot;	state Exp;
branches;
next	1.116;

1.116
date	2014.04.11.18.27.45;	author ajacoutot;	state Exp;
branches;
next	1.115;

1.115
date	2014.04.07.12.53.32;	author sthen;	state Exp;
branches;
next	1.114;

1.114
date	2014.04.03.15.20.14;	author sthen;	state Exp;
branches;
next	1.113;

1.113
date	2014.04.03.12.37.41;	author jasper;	state Exp;
branches;
next	1.112;

1.112
date	2014.04.02.09.36.12;	author jasper;	state Exp;
branches;
next	1.111;

1.111
date	2014.04.01.15.31.46;	author jasper;	state Exp;
branches;
next	1.110;

1.110
date	2014.03.31.16.50.23;	author sthen;	state Exp;
branches;
next	1.109;

1.109
date	2014.03.25.06.26.21;	author landry;	state Exp;
branches;
next	1.108;

1.108
date	2014.03.25.06.25.45;	author landry;	state Exp;
branches;
next	1.107;

1.107
date	2014.03.11.21.00.38;	author landry;	state Exp;
branches;
next	1.106;

1.106
date	2014.01.29.17.28.05;	author ajacoutot;	state Exp;
branches
	1.106.2.1;
next	1.105;

1.105
date	2014.01.28.23.24.42;	author landry;	state Exp;
branches;
next	1.104;

1.104
date	2014.01.27.19.56.20;	author landry;	state Exp;
branches;
next	1.103;

1.103
date	2013.12.08.17.04.54;	author landry;	state Exp;
branches;
next	1.102;

1.102
date	2013.11.25.14.16.23;	author sthen;	state Exp;
branches;
next	1.101;

1.101
date	2013.11.14.16.47.00;	author ajacoutot;	state Exp;
branches;
next	1.100;

1.100
date	2013.10.26.08.02.57;	author ajacoutot;	state Exp;
branches;
next	1.99;

1.99
date	2013.10.20.13.24.29;	author landry;	state Exp;
branches;
next	1.98;

1.98
date	2013.10.07.18.47.55;	author landry;	state Exp;
branches;
next	1.97;

1.97
date	2013.10.06.19.56.42;	author landry;	state Exp;
branches;
next	1.96;

1.96
date	2013.10.06.16.27.26;	author ajacoutot;	state Exp;
branches;
next	1.95;

1.95
date	2013.10.06.14.18.22;	author landry;	state Exp;
branches;
next	1.94;

1.94
date	2013.10.06.14.03.42;	author landry;	state Exp;
branches;
next	1.93;

1.93
date	2013.10.06.09.08.52;	author ajacoutot;	state Exp;
branches;
next	1.92;

1.92
date	2013.09.24.18.53.29;	author ajacoutot;	state Exp;
branches;
next	1.91;

1.91
date	2013.08.06.19.11.30;	author ajacoutot;	state Exp;
branches;
next	1.90;

1.90
date	2013.06.19.13.24.17;	author ajacoutot;	state Exp;
branches;
next	1.89;

1.89
date	2013.06.08.12.07.38;	author landry;	state Exp;
branches;
next	1.88;

1.88
date	2013.06.08.11.59.46;	author landry;	state Exp;
branches;
next	1.87;

1.87
date	2013.06.04.18.41.57;	author naddy;	state Exp;
branches;
next	1.86;

1.86
date	2013.05.31.20.07.33;	author ajacoutot;	state Exp;
branches;
next	1.85;

1.85
date	2013.05.14.12.04.59;	author ajacoutot;	state Exp;
branches;
next	1.84;

1.84
date	2013.05.07.14.16.52;	author ajacoutot;	state Exp;
branches;
next	1.83;

1.83
date	2013.04.23.09.40.58;	author landry;	state Exp;
branches;
next	1.82;

1.82
date	2013.04.18.11.31.37;	author ajacoutot;	state Exp;
branches;
next	1.81;

1.81
date	2013.04.13.09.11.02;	author landry;	state Exp;
branches;
next	1.80;

1.80
date	2013.03.30.15.02.48;	author ajacoutot;	state Exp;
branches;
next	1.79;

1.79
date	2013.03.21.08.48.55;	author ajacoutot;	state Exp;
branches;
next	1.78;

1.78
date	2013.03.11.11.44.50;	author espie;	state Exp;
branches;
next	1.77;

1.77
date	2013.02.09.14.49.53;	author sthen;	state Exp;
branches;
next	1.76;

1.76
date	2012.12.21.13.22.26;	author sthen;	state Exp;
branches;
next	1.75;

1.75
date	2012.10.03.06.35.46;	author ajacoutot;	state Exp;
branches;
next	1.74;

1.74
date	2012.10.01.18.12.34;	author naddy;	state Exp;
branches;
next	1.73;

1.73
date	2012.10.01.17.49.26;	author naddy;	state Exp;
branches;
next	1.72;

1.72
date	2012.09.21.14.48.06;	author ajacoutot;	state Exp;
branches;
next	1.71;

1.71
date	2012.09.06.12.38.35;	author ajacoutot;	state Exp;
branches;
next	1.70;

1.70
date	2012.09.06.10.07.27;	author ajacoutot;	state Exp;
branches;
next	1.69;

1.69
date	2012.09.05.17.22.24;	author ajacoutot;	state Exp;
branches;
next	1.68;

1.68
date	2012.09.01.14.36.58;	author ajacoutot;	state Exp;
branches;
next	1.67;

1.67
date	2012.08.22.07.48.37;	author landry;	state Exp;
branches;
next	1.66;

1.66
date	2012.08.07.09.35.37;	author landry;	state Exp;
branches;
next	1.65;

1.65
date	2012.04.30.13.31.06;	author landry;	state Exp;
branches;
next	1.64;

1.64
date	2012.04.23.17.15.19;	author espie;	state Exp;
branches;
next	1.63;

1.63
date	2012.04.03.15.39.35;	author landry;	state Exp;
branches;
next	1.62;

1.62
date	2012.03.13.07.50.05;	author landry;	state Exp;
branches;
next	1.61;

1.61
date	2012.02.24.16.36.00;	author landry;	state Exp;
branches;
next	1.60;

1.60
date	2011.11.17.11.42.31;	author jasper;	state Exp;
branches;
next	1.59;

1.59
date	2011.11.02.20.00.58;	author jasper;	state Exp;
branches;
next	1.58;

1.58
date	2011.10.17.06.16.58;	author ajacoutot;	state Exp;
branches;
next	1.57;

1.57
date	2011.10.13.06.52.49;	author jasper;	state Exp;
branches;
next	1.56;

1.56
date	2011.09.26.20.15.29;	author landry;	state Exp;
branches;
next	1.55;

1.55
date	2011.09.16.12.00.09;	author espie;	state Exp;
branches;
next	1.54;

1.54
date	2011.07.30.08.09.30;	author landry;	state Exp;
branches;
next	1.53;

1.53
date	2011.07.11.12.08.24;	author jasper;	state Exp;
branches;
next	1.52;

1.52
date	2011.07.05.11.34.27;	author landry;	state Exp;
branches;
next	1.51;

1.51
date	2011.06.17.22.10.40;	author landry;	state Exp;
branches;
next	1.50;

1.50
date	2011.06.08.18.15.30;	author rpointel;	state Exp;
branches;
next	1.49;

1.49
date	2011.05.30.20.29.05;	author landry;	state Exp;
branches;
next	1.48;

1.48
date	2011.05.28.08.15.53;	author ajacoutot;	state Exp;
branches;
next	1.47;

1.47
date	2011.05.19.19.01.03;	author otto;	state Exp;
branches;
next	1.46;

1.46
date	2011.05.11.06.00.08;	author ajacoutot;	state Exp;
branches;
next	1.45;

1.45
date	2011.04.15.23.03.03;	author dhill;	state Exp;
branches;
next	1.44;

1.44
date	2011.04.07.19.40.10;	author jasper;	state Exp;
branches;
next	1.43;

1.43
date	2011.03.08.18.56.30;	author landry;	state Exp;
branches;
next	1.42;

1.42
date	2011.03.03.13.44.10;	author landry;	state Exp;
branches;
next	1.41;

1.41
date	2010.12.30.17.55.32;	author landry;	state Exp;
branches;
next	1.40;

1.40
date	2010.12.26.08.32.07;	author landry;	state Exp;
branches;
next	1.39;

1.39
date	2010.12.17.16.17.54;	author ajacoutot;	state Exp;
branches;
next	1.38;

1.38
date	2010.11.22.08.36.55;	author espie;	state Exp;
branches;
next	1.37;

1.37
date	2010.10.24.21.40.10;	author ajacoutot;	state Exp;
branches;
next	1.36;

1.36
date	2010.10.12.08.43.05;	author landry;	state Exp;
branches;
next	1.35;

1.35
date	2010.10.11.08.19.04;	author jasper;	state Exp;
branches;
next	1.34;

1.34
date	2010.09.28.21.20.56;	author jasper;	state Exp;
branches;
next	1.33;

1.33
date	2010.09.19.20.43.32;	author landry;	state Exp;
branches;
next	1.32;

1.32
date	2010.08.30.13.15.49;	author landry;	state Exp;
branches;
next	1.31;

1.31
date	2010.07.19.12.29.50;	author landry;	state Exp;
branches;
next	1.30;

1.30
date	2010.07.03.07.53.04;	author landry;	state Exp;
branches;
next	1.29;

1.29
date	2010.06.21.15.55.33;	author ajacoutot;	state Exp;
branches;
next	1.28;

1.28
date	2010.06.05.16.36.44;	author landry;	state Exp;
branches;
next	1.27;

1.27
date	2010.05.23.10.27.46;	author espie;	state Exp;
branches;
next	1.26;

1.26
date	2010.05.17.20.16.09;	author ajacoutot;	state Exp;
branches;
next	1.25;

1.25
date	2010.04.22.13.36.59;	author landry;	state Exp;
branches;
next	1.24;

1.24
date	2010.04.05.21.44.41;	author landry;	state Exp;
branches;
next	1.23;

1.23
date	2010.01.23.10.14.37;	author landry;	state Exp;
branches;
next	1.22;

1.22
date	2010.01.10.20.06.17;	author landry;	state Exp;
branches;
next	1.21;

1.21
date	2009.11.29.10.08.26;	author landry;	state Exp;
branches;
next	1.20;

1.20
date	2009.11.18.00.49.09;	author sthen;	state Exp;
branches;
next	1.19;

1.19
date	2009.11.08.16.19.34;	author ajacoutot;	state Exp;
branches;
next	1.18;

1.18
date	2009.10.29.16.46.09;	author sthen;	state Exp;
branches;
next	1.17;

1.17
date	2009.10.11.18.31.12;	author landry;	state Exp;
branches;
next	1.16;

1.16
date	2009.08.31.19.00.01;	author kili;	state Exp;
branches;
next	1.15;

1.15
date	2009.06.18.20.09.20;	author landry;	state Exp;
branches;
next	1.14;

1.14
date	2009.06.01.05.51.31;	author landry;	state Exp;
branches;
next	1.13;

1.13
date	2009.05.17.09.40.53;	author sthen;	state Exp;
branches;
next	1.12;

1.12
date	2009.04.27.19.25.08;	author landry;	state Exp;
branches;
next	1.11;

1.11
date	2009.04.06.07.40.30;	author landry;	state Exp;
branches;
next	1.10;

1.10
date	2009.04.04.10.35.26;	author landry;	state Exp;
branches;
next	1.9;

1.9
date	2009.03.08.20.00.41;	author landry;	state Exp;
branches;
next	1.8;

1.8
date	2009.02.18.22.09.47;	author landry;	state Exp;
branches;
next	1.7;

1.7
date	2009.01.25.22.16.40;	author landry;	state Exp;
branches;
next	1.6;

1.6
date	2008.12.19.11.52.55;	author sthen;	state Exp;
branches;
next	1.5;

1.5
date	2008.12.05.19.56.53;	author ajacoutot;	state Exp;
branches;
next	1.4;

1.4
date	2008.10.26.12.59.01;	author landry;	state Exp;
branches;
next	1.3;

1.3
date	2008.07.25.15.07.55;	author landry;	state Exp;
branches;
next	1.2;

1.2
date	2008.07.25.14.51.56;	author landry;	state Exp;
branches;
next	1.1;

1.1
date	2008.07.25.12.51.10;	author landry;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2008.07.25.12.51.10;	author landry;	state Exp;
branches;
next	;

1.106.2.1
date	2014.10.04.11.57.42;	author ajacoutot;	state Exp;
branches;
next	;
commitid	Ykf9vl5bT48qlglY;

1.121.2.1
date	2014.10.04.12.40.54;	author ajacoutot;	state Exp;
branches;
next	1.121.2.2;
commitid	VcWrK8MijDy234jv;

1.121.2.2
date	2015.01.12.13.21.59;	author ajacoutot;	state Exp;
branches;
next	;
commitid	XKidCOC6ZDYP6zNT;

1.141.4.1
date	2016.02.04.13.33.49;	author ajacoutot;	state Exp;
branches;
next	;
commitid	T2LHVJBaQUz4S7nB;

1.144.2.1
date	2016.03.19.10.33.08;	author ajacoutot;	state Exp;
branches;
next	;
commitid	CO9qkVWh5gncfaCV;


desc
@@


1.150
log
@Add MESSAGE:
!!! WARNING: WebKitGTK+ 2.4 is known to have many security vulnerabilities that
!!! will NOT be fixed. Avoid browsing with it.

We will hopefully be able to get rid of this port sooner than later...

from Davide Gerhard
no objection landry@@
@
text
@# $OpenBSD: Makefile,v 1.149 2016/09/01 15:50:30 ajacoutot Exp $

USE_WXNEEDED =	Yes

PORTROACH =	limit:^2\.4

COMMENT =	open source web browser engine for Gtk+
BROKEN-alpha =	error: Compiler GCC >= 4.7 or Clang >= 3.3 is required for C compilation
BROKEN-hppa =	error: Compiler GCC >= 4.7 or Clang >= 3.3 is required for C compilation

V =		2.4.11
DISTNAME =	webkitgtk-${V}
PKGNAME =	webkit-${V}
EPOCH =		1
CATEGORIES =	www
DPB_PROPERTIES =parallel
EXTRACT_SUFX =	.tar.xz
REVISION =	1

HOMEPAGE =	http://webkitgtk.org/
MASTER_SITES =	${HOMEPAGE}/releases/

MAINTAINER =	Landry Breuil <landry@@openbsd.org> \
		Antoine Jacoutot <ajacoutot@@openbsd.org>

SHARED_LIBS += javascriptcoregtk-${WEBKIT_API_VERSION}	5.0 # 16.19
SHARED_LIBS += webkitgtk-${WEBKIT_API_VERSION}		7.0 # 22.17

# LGPLv2 and BSD
PERMIT_PACKAGE_CDROM =	Yes

MODULES =	lang/python \
		lang/ruby \
		x11/gnome

MODULES +=		gcc4
MODGCC4_ARCHS =		*
MODGCC4_LANGS =		c++
# cant use clang = needs <chrono> header in StdLib ?
#MODULES +=		lang/clang
#MODCLANG_ARCHS =        amd64
#MODCLANG_LANGS =        c c++

MAKE_FILE =		GNUmakefile
PORTHOME =		${WRKDIST}
SUBST_VARS =		WEBKIT_API_VERSION GTK_API_VERSION

USE_GMAKE =		Yes
LIBTOOL_FLAGS =		--tag=disable-static

MODPY_RUNDEP =		No
MODRUBY_RUNDEP =	No
MODPY_ADJ_FILES =	Tools/gtk/generate-feature-defines-files \
			Tools/gtk/generate-inspector-gresource-manifest.py

MODGNOME_CPPFLAGS =	-I${X11BASE}/include -DLOG_DISABLED=0
MODGNOME_LDFLAGS =	-L${X11BASE}/lib -lX11
MODGNOME_TOOLS +=	gobject-introspection

CONFIGURE_STYLE =	gnu
# AR_FLAGS: cf http://trac.webkit.org/changeset/163954
CONFIGURE_ENV =	AR_FLAGS="cru" \
		ac_cv_path_RUBY=${RUBY}
CONFIGURE_ARGS= --disable-static \
		--disable-webkit2 \
		--enable-spellcheck \
		--with-gtk=${GTK_API_VERSION}

# XXX: uncomment if you want to debug the javascript engine
# this will only build the needed libs and the shell
# ALL_TARGET=jsc

.if ${MACHINE_ARCH} == "powerpc"
# Turns on -O0 globally, makes jsc work ?
CONFIGURE_ARGS +=	--enable-optimizations=no
# XXX huge hack LDFLAGS is already added a bit before
CONFIGURE_ENV +=	COVERAGE_LDFLAGS="-Wl,--relax"
.endif

WANTLIB += EGL GL ICE SM X11 X11-xcb Xcomposite Xcursor Xdamage
WANTLIB += Xext Xfixes Xi Xinerama Xrandr Xrender Xt Xxf86vm atk-1.0
WANTLIB += c cairo dbus-1 drm enchant expat ffi fontconfig freetype
WANTLIB += gbm gcrypt gdk_pixbuf-2.0 gio-2.0 glapi glib-2.0 gmodule-2.0
WANTLIB += gobject-2.0 gpg-error graphite2 gstapp-1.0 gstaudio-1.0
WANTLIB += gstbase-1.0 gstfft-1.0 gstpbutils-1.0 gstreamer-1.0
WANTLIB += gsttag-1.0 gstvideo-1.0 gthread-2.0 harfbuzz harfbuzz-icu
WANTLIB += iconv icudata icui18n icuuc intl jpeg lzma m orc-0.4
WANTLIB += pango-1.0 pangocairo-1.0 pangoft2-1.0 pcre pixman-1
WANTLIB += png pthread pthread-stubs secret-1 soup-2.4 sqlite3
WANTLIB += stdc++ webp xcb xcb-dri2 xcb-glx xcb-render xcb-shape
WANTLIB += xcb-shm xcb-xfixes xml2 xslt z

LIB_DEPENDS =	multimedia/gstreamer1/plugins-base \
		devel/harfbuzz,-icu \
		textproc/libxslt \
		textproc/enchant \
		graphics/libwebp \
		devel/glib2 \
		devel/libsoup \
		x11/gnome/libsecret

BUILD_DEPENDS =	devel/bison \
		devel/gettext-tools \
		devel/gperf \
		geo/geoclue2

RUN_DEPENDS =	geo/geoclue2

FLAVORS = gtk3
FLAVOR ?=

.if ${FLAVOR:Mgtk3}
#XXX gross, but needed to have __sync_add_and_fetch_8 on 32-bits
#what about ppc ? hppa ?
.if ${MACHINE_ARCH} == "i386"
CFLAGS +=	-march=i686
CXXFLAGS +=	-march=i686
.endif

FULLPKGNAME =	webkit-gtk3-${V}
LIB_DEPENDS +=	x11/gtk+3,-main
WANTLIB +=	cairo-gobject gdk-3 gtk-3 epoxy atk-bridge-2.0 atspi

WEBKIT_API_VERSION =	3.0
GTK_API_VERSION =	3.0
.else

WEBKIT_API_VERSION =	1.0
GTK_API_VERSION =	2.0
LIB_DEPENDS +=	x11/gtk+2,-main
WANTLIB +=	gdk-x11-2.0 gtk-x11-2.0
.endif

pre-configure:
	${SUBST_CMD} ${WRKSRC}/Source/WebCore/plugins/PluginDatabase.cpp ${WRKSRC}/configure
	# this ensures gtk-doc files are installed in a versionned directory so that we can
	# install both versions alongside, see DOC_MODULE_VERSION in GNUMakefile.in
	echo ${WEBKIT_API_VERSION} > ${WRKSRC}/Documentation/webkitdomgtk/version.xml
	echo ${WEBKIT_API_VERSION} > ${WRKSRC}/Documentation/webkitgtk/version.xml

post-install:
	${INSTALL_PROGRAM} ${WRKSRC}/Programs/.libs/GtkLauncher ${PREFIX}/bin/GtkLauncher
.if ${FLAVOR:Mgtk3}
	mv ${PREFIX}/bin/GtkLauncher ${PREFIX}/bin/GtkLauncher-3
.endif

.include <bsd.port.mk>
@


1.149
log
@Similar commit to what was done to webkitgtk4 regarding wxneeded:

"
USE_WXNEEDED, add "-Wl,-z,wxneeded" to pkg-config files
WebKit violates W^X, so binaries linked with it need to be "wxneeded".
Pkg-config files seem to be an appropriate mean of automating this task.
"
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.148 2016/04/22 12:02:08 naddy Exp $
d18 1
a18 1
REVISION =	0
@


1.148
log
@needs gettext-tools
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.147 2016/04/17 13:18:43 ajacoutot Exp $
d18 1
@


1.147
log
@Unbreak non FLAVORed build.

reported by nigel@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.146 2016/04/16 18:23:31 ajacoutot Exp $
d100 1
@


1.146
log
@Minor update to webkit-2.4.11.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.145 2016/03/16 07:10:57 ajacoutot Exp $
d23 2
a24 2
SHARED_LIBS +=  javascriptcoregtk-3.0 5.0      # 16.19
SHARED_LIBS +=  webkitgtk-3.0        7.0      # 22.17
@


1.145
log
@SECURITY update to webkit-2.4.10.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.144 2016/02/04 13:34:20 ajacoutot Exp $
d9 1
a9 1
V =		2.4.10
d23 2
a24 2
SHARED_LIBS += javascriptcoregtk-${WEBKIT_API_VERSION}	5.0 # 16.3
SHARED_LIBS += webkitgtk-${WEBKIT_API_VERSION}		7.0 # 22.11
d29 1
a29 2
MODULES =	devel/gettext \
		lang/python \
d77 12
a88 12
WANTLIB =	ICE SM X11 Xcomposite Xcursor Xdamage Xext \
		Xfixes Xi Xinerama Xrandr Xrender Xt atk-1.0 c xcb-render \
		EGL X11-xcb glapi xcb-dri2 xcb-glx xcb-shape xcb-xfixes \
		expat fontconfig freetype gio-2.0 glib-2.0 gmodule-2.0 \
		gobject-2.0 gthread-2.0 jpeg m harfbuzz-icu \
		Xxf86vm dbus-1 lzma drm gbm \
		gstaudio-1.0 gstfft-1.0 gdk_pixbuf-2.0 orc-0.4 \
		gstreamer-1.0 gstbase-1.0 gstvideo-1.0 gstapp-1.0 gstpbutils-1.0 \
		icudata icui18n icuuc sqlite3 xslt enchant soup-2.4 \
		pango-1.0 pangocairo-1.0 pangoft2-1.0 pcre pthread GL xcb-shm \
		z cairo pixman-1 png pthread-stubs xcb xml2 stdc++ ffi \
		harfbuzz graphite2 gcrypt gpg-error gsttag-1.0 secret-1 webp
@


1.144
log
@SECURITY fix for CVE-2014-1748.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.143 2015/11/20 11:24:04 sthen Exp $
d9 1
a9 1
V =		2.4.9
a15 1
REVISION =	4
d80 1
a80 1
		EGL X11-xcb Xau Xdmcp glapi xcb-dri2 xcb-glx xcb-shape xcb-xfixes \
@


1.144.2.1
log
@SECURITY update to WebKitGTK+ 2.4.10.

CVE-2015-1120, CVE-2015-1076, CVE-2015-1071, CVE-2015-1081, CVE-2015-1122,
CVE-2015-1155, CVE-2014-1748, CVE-2015-3752, CVE-2015-5809, CVE-2015-5928,
CVE-2015-3749, CVE-2015-3659, CVE-2015-3748, CVE-2015-3743, CVE-2015-3731,
CVE-2015-3745, CVE-2015-5822, CVE-2015-3658, CVE-2015-3741, CVE-2015-3727,
CVE-2015-5801, CVE-2015-5788, CVE-2015-3747, CVE-2015-5794, CVE-2015-1127,
CVE-2015-1153, CVE-2015-1083
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.144 2016/02/04 13:34:20 ajacoutot Exp $
d9 1
a9 1
V =		2.4.10
d16 1
d81 1
a81 1
		EGL X11-xcb glapi xcb-dri2 xcb-glx xcb-shape xcb-xfixes \
@


1.143
log
@remove devel/flex dep, these are ok with base flex
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.142 2015/11/15 12:45:48 ajacoutot Exp $
d16 1
a16 1
REVISION =	3
@


1.142
log
@Drop old-bison patch; not tested yes since it seems pledged binutils broke
stuffs.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.141 2015/07/16 17:27:09 jeremy Exp $
d61 1
a61 2
CONFIGURE_ENV =	ac_cv_path_FLEX=${LOCALBASE}/bin/gflex \
		AR_FLAGS="cru" \
a101 1
		devel/flex \
@


1.141
log
@Switch the default ruby version from ruby 2.1 to 2.2, and bump affected
ports.

OK jcs@@ ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.140 2015/05/28 10:17:25 pascal Exp $
d16 1
a16 1
REVISION =	2
@


1.141.4.1
log
@Fix for CVE-2014-1748.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.141 2015/07/16 17:27:09 jeremy Exp $
d16 1
a16 1
REVISION =	3
@


1.140
log
@gcc4 bumps, reminded by aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.139 2015/05/26 06:30:45 ajacoutot Exp $
d16 1
a16 1
REVISION =	1
@


1.139
log
@Apply the same fix as with webkitgtk4 from sthen's:
add CXXFLAGS as well as CFLAGS. yet more fallout from the *.mk change to
not include CFLAGS automatically.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.138 2015/05/20 15:32:54 ajacoutot Exp $
d16 1
a16 1
REVISION =	0
@


1.138
log
@Update to webkit-2.4.9.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.137 2015/04/15 09:40:52 ajacoutot Exp $
d16 1
d116 2
a117 1
CFLAGS+=-march=i686
@


1.137
log
@Bump after libepoxy moved from ports to xenocara.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.136 2015/04/10 06:30:40 ajacoutot Exp $
d9 1
a9 1
V =		2.4.8
a15 1
REVISION =	5
@


1.136
log
@typo: WANLIB -> WANTLIB
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.135 2015/04/08 21:42:14 ajacoutot Exp $
d16 1
a16 1
REVISION =	4
@


1.135
log
@--disable-webkit2 ; WebKit2 is now provided by www/webkitgtk4.

ok landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.134 2015/04/04 09:21:04 ajacoutot Exp $
d16 1
a16 1
REVISION =	3
d130 1
a130 1
WANLIB +=	gdk-x11-2.0 gtk-x11-2.0
@


1.134
log
@Bump after the recent changes in packaging dbus and dconf.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.133 2015/03/27 16:02:49 ajacoutot Exp $
d16 1
a16 1
REVISION =	2
d65 1
a108 4
# WebKitPluginProcess links against gtk2 for flash plugin, even with gtk3 ?
LIB_DEPENDS +=	x11/gtk+2,-main
WANTLIB +=	gdk-x11-2.0 gtk-x11-2.0

d121 1
a121 2
WANTLIB +=	cairo-gobject gdk-3 gtk-3
WANTLIB +=	atk-bridge-2.0 atspi
a124 1
SHARED_LIBS += webkit2gtk-${WEBKIT_API_VERSION}		1.0 # 35.8
d126 1
a126 2
# only works with gtk+3
CONFIGURE_ARGS+=	--disable-webkit2
d129 2
a143 1
	${INSTALL_PROGRAM} ${WRKSRC}/Programs/.libs/MiniBrowser ${PREFIX}/bin/MiniBrowser
@


1.133
log
@Fix Webkit build with new GLib.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.132 2015/01/12 13:22:46 ajacoutot Exp $
d16 1
a16 1
REVISION =	1
@


1.132
log
@Bump after update to 2.4.8 in 5.6-stable.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.131 2015/01/10 00:38:38 ajacoutot Exp $
d16 1
a16 1
REVISION =	0
@


1.131
log
@Update to webkit-2.4.8.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.130 2014/12/30 21:50:25 landry Exp $
d16 1
@


1.130
log
@Mark BROKEN-alpha a bunch of ports that reliably failed (!) to build in
the past 3 bulks, or forever.

Various reasons: no d^Hrecent compiler available, base gcc generating
nice internal compiler errors, no atomic ops, etc, etc.

While here, mark all webkits as BROKEN-hppa, since this also requires
clang or g++ 4.7. Our g++ 4.8 port only builds on
i386|amd64|powerpc|sparc64 anyway...

if you're interested^Wbored to death, full past logs at
http://build-failures.rhaalovely.net/alpha/...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.129 2014/10/24 16:06:27 ajacoutot Exp $
d9 1
a9 1
V =		2.4.7
@


1.129
log
@Update to webkit 2.4.7.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.128 2014/09/30 12:18:09 ajacoutot Exp $
d6 2
@


1.128
log
@Minor update to webkit-2.4.6.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.127 2014/09/29 12:14:30 ajacoutot Exp $
d7 1
a7 1
V =		2.4.6
d81 1
a81 1
		Xxf86vm dbus-1 dbus-glib-1 drm geoclue gbm \
a92 1
		geo/geoclue \
d100 4
a103 1
		devel/gperf
@


1.127
log
@Too much cleanup, not enough bump.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.126 2014/09/29 11:57:54 ajacoutot Exp $
d7 1
a7 1
V =		2.4.5
a13 1
REVISION =	0
@


1.126
log
@Add PORTROACH annotation to restrict to 2.4.X since a new webkit 2.6.X will
be imported in the future.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.125 2014/09/28 06:52:14 ajacoutot Exp $
d14 1
@


1.125
log
@Cleanup to help future update and split; no pkg change.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.124 2014/09/05 14:45:02 jasper Exp $
d3 1
a3 1
PORTROACH =	limitw:1,even
@


1.124
log
@PORTSCOUT -> PORTROACH
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.123 2014/09/02 14:28:20 jasper Exp $
d21 3
a39 1

d45 1
a55 1
# XXX TODO switch to cmake ?
d57 1
a57 4
# breaks because of missing webkit2/ headers dir ?
#SEPARATE_BUILD =	Yes
#AR_FLAGS,  cf http://trac.webkit.org/changeset/163954

a60 2

LIBTOOL_FLAGS =	--tag=disable-static
d89 1
a89 2
LIB_DEPENDS =	multimedia/gstreamer1/core \
		multimedia/gstreamer1/plugins-base \
d95 2
a96 2
		devel/glib2>=2.36.0 \
		devel/libsoup>=2.42.0 \
a130 3

SHARED_LIBS += javascriptcoregtk-${WEBKIT_API_VERSION}	5.0 # 16.3
SHARED_LIBS += webkitgtk-${WEBKIT_API_VERSION}		7.0 # 22.11
@


1.123
log
@use the new PORTSCOUT variable to instruct it to ignore odd versions (i.e.
unstable releases)

ok aja@@ espie@@ landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.122 2014/08/26 21:31:03 ajacoutot Exp $
d3 1
a3 1
PORTSCOUT =	limitw:1,even
@


1.122
log
@Update to webkit-2.4.5.

ok landry@@
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.121 2014/07/14 21:13:31 ajacoutot Exp $
@


1.121
log
@Update to webkit-2.4.4.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.120 2014/07/09 17:43:52 ajacoutot Exp $
d5 1
a5 1
V =		2.4.4
d82 1
a82 1
		Xxf86vm dbus-1 dbus-glib-1 drm geoclue \
d126 1
a126 1
SHARED_LIBS += webkit2gtk-${WEBKIT_API_VERSION}		1.0 # 34.0
d134 2
a135 2
SHARED_LIBS += javascriptcoregtk-${WEBKIT_API_VERSION}	5.0 # 16.4
SHARED_LIBS += webkitgtk-${WEBKIT_API_VERSION}		7.0 # 22.2
@


1.121.2.1
log
@Update distfile to one that does not contain non-free files.
For more info, see:
http://webkitgtk.org/2014/10/01/webkitgtk-contains-non-free-files.html
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.121 2014/07/14 21:13:31 ajacoutot Exp $
d6 1
a6 1
DISTNAME =	webkitgtk-${V}a
a11 2
REVISION =	0
WRKDIST =	${WRKDIR}/webkitgtk-${V}
@


1.121.2.2
log
@SECURITY update to webkit-2.4.8v1.
CVE-2014-1344, CVE-2014-1384, CVE-2014-1385, CVE-2014-1386, CVE-2014-1387,
CVE-2014-1388, CVE-2014-1389, CVE-2014-1390.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.121.2.1 2014/10/04 12:40:54 ajacoutot Exp $
d5 2
a6 2
V =		2.4.8
DISTNAME =	webkitgtk-${V}
d12 1
d84 1
a84 1
		Xxf86vm dbus-1 drm gbm \
d97 1
d105 1
a105 7
		devel/gperf \
		geo/geoclue2

RUN_DEPENDS=	geo/geoclue2

# only to satisfy dependant ports WANTLIB on 5.6-stable
RUN_DEPENDS=	geo/geoclue
@


1.120
log
@The x11/gnome MODULE will soon stop setting USE_GMAKE unconditionally, so
explicitely add it where needed.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.119 2014/05/26 16:52:35 ajacoutot Exp $
d5 1
a5 1
V =		2.4.3
@


1.119
log
@Minor update to WebKit 2.4.3.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.118 2014/05/12 13:19:33 ajacoutot Exp $
d39 2
@


1.118
log
@Update to webkit-2.4.2.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.117 2014/04/20 16:40:55 ajacoutot Exp $
d5 1
a5 1
V =		2.4.2
@


1.117
log
@Minor update to webkit-2.4.1.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.116 2014/04/11 18:27:45 ajacoutot Exp $
d5 1
a5 1
V =		2.4.1
@


1.116
log
@Remove fcntl call to set access mode flags on the duplicated files
descriptor. Those flags make fcntl to fail (upstream).

ok landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.115 2014/04/07 12:53:32 sthen Exp $
d5 1
a5 1
V =		2.4.0
a11 1
REVISION =	0
d142 2
a144 1
post-install:
d146 1
a146 1
	cp ${WRKSRC}/Programs/.libs/MiniBrowser ${PREFIX}/bin/MiniBrowser
@


1.115
log
@unbreak on i386; thanks Miod!
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.114 2014/04/03 15:20:14 sthen Exp $
d12 1
@


1.114
log
@update BROKEN-i386 line now we have a different error ("Error: suffix or
operands invalid for `fucomip'" from the assembler).
@
text
@d1 1
a1 3
# $OpenBSD: Makefile,v 1.113 2014/04/03 12:37:41 jasper Exp $

BROKEN-i386 =	Error: suffix or operands invalid for `fucomip'
@


1.113
log
@drop extra = from MODGNOME_TOOLS

no package change
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.112 2014/04/02 09:36:12 jasper Exp $
d3 1
a3 1
BROKEN-i386= Source/JavaScriptCore/dfg/DFGByteCodeParser.cpp:1738:90: error: call of overloaded 'OpInfo(size_t)' is ambiguous
@


1.112
log
@cleanup double spaces and sort MODGNOME_TOOLS
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.111 2014/04/01 15:31:46 jasper Exp $
d49 1
a49 1
MODGNOME_TOOLS += = gobject-introspection
@


1.111
log
@start to make MODGNOME_TOOLS resemble the name of the tools actually used.
rename 'gi' to 'gobject-introspection'.

discussed with aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.110 2014/03/31 16:50:23 sthen Exp $
d49 1
a49 1
MODGNOME_TOOLS =	gobject-introspection
@


1.110
log
@mark BROKEN-i386 to save time in bulk builds until this can be fixed
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.109 2014/03/25 06:26:21 landry Exp $
d49 1
a49 1
MODGNOME_TOOLS =	gi
@


1.109
log
@Whoops, remove REVISION that snuck in.
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.108 2014/03/25 06:25:45 landry Exp $
@


1.108
log
@Update to webkit 2.4.0.

See http://webkitgtk.org/2014/03/24/webkitgtk2.4.0-released.html. Note
that Webkit2 API is still broken, on OpenBSD(and FreeBSD) and this might
be the last release shipping the Webkit1 API.
Pass -DLOG_DISABLED=0 to CPPFLAGS to somewhat allow debugging.
Use the same ruby version on sparc64 as other archs now that they're
more reliable.

Remove some patches merged upstream, and add links to upstream bz for
most of the remaining patches.

Note: this needs gnu/usr.bin/binutils/include/opcode/i386.h r1.15 to
build. And gcc 4.8 (and python, ruby & perl :)
Built numerous times on amd64/ppc/sparc64 (broken at runtime on the last
two, but that's not a regression from 2.2..) and went in a bunch of
bulks.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.107 2014/03/11 21:00:38 landry Exp $
a11 1
REVISION =	0
@


1.107
log
@Bump REVISION after gcc4 MODULE change.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.106 2014/01/29 17:28:05 ajacoutot Exp $
d5 1
a5 1
V =		2.2.4
a27 1

d31 5
a35 1
#MODGCC4_VERSION =	4.8
d43 2
a44 1
MODPY_ADJ_FILES =	Tools/gtk/generate-feature-defines-files
d46 1
a46 1
MODGNOME_CPPFLAGS =	-I${X11BASE}/include
d54 1
d57 1
a59 3
#c++0x in 4.6, c++11 in 4.8 - removed in a patch but we need to readd it for wk2
CONFIGURE_ENV +=	CXXFLAGS="${CXXFLAGS} -std=c++0x -Wno-c++0x-compat"

a75 5
.if ${MACHINE_ARCH:Msparc64}
# until 1.9 is reliable on sparc64...
MODRUBY_REV =	1.8
.endif

d125 1
a125 1
SHARED_LIBS += webkit2gtk-${WEBKIT_API_VERSION}		0.0 # 29.2
d133 2
a134 2
SHARED_LIBS += javascriptcoregtk-${WEBKIT_API_VERSION}	4.0 # 15.5
SHARED_LIBS += webkitgtk-${WEBKIT_API_VERSION}		6.0 # 19.8
d138 4
@


1.106
log
@Re-update to webkit-2.2.4 with a fix for our pre-historical bison(1).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.105 2014/01/28 23:24:42 landry Exp $
d12 1
@


1.106.2.1
log
@Update distfile to one that does not contain non-free files.
For more info, see:
http://webkitgtk.org/2014/10/01/webkitgtk-contains-non-free-files.html
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.106 2014/01/29 17:28:05 ajacoutot Exp $
d6 1
a6 1
DISTNAME =	webkitgtk-${V}a
a11 2
REVISION =	0
WRKDIST =	${WRKDIR}/webkitgtk-${V}
@


1.105
log
@Revert previous and bump EPOCH, seems this now requires a newer bison,
which i didnt spot since i had an update on my box.
Noticed by nigel@@, thanks!
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.104 2014/01/27 19:56:20 landry Exp $
d5 1
a5 1
V =		2.2.3
@


1.104
log
@Bugfix update to webkit 2.2.4.

http://webkitgtk.org/2014/01/21/webkitgtk2.2.4-released.html
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.103 2013/12/08 17:04:54 landry Exp $
d5 1
a5 1
V =		2.2.4
d8 1
a8 1
EPOCH =		0
@


1.103
log
@Bugfix update to webkit 2.2.3.

See http://webkitgtk.org/2013/12/04/webkitgtk2.2.3-released.html for details
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.102 2013/11/25 14:16:23 sthen Exp $
d5 1
a5 1
V =		2.2.3
@


1.102
log
@kill VMEM_WARNING
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.101 2013/11/14 16:47:00 ajacoutot Exp $
d5 1
a5 1
V =		2.2.2
@


1.101
log
@Update to webkit-2.2.2.

ok landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.100 2013/10/26 08:02:57 ajacoutot Exp $
a35 1
VMEM_WARNING =		Yes
@


1.100
log
@Fix dependencies and bump after the recent libsoup -gnome => -main merge.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.99 2013/10/20 13:24:29 landry Exp $
d5 1
a5 1
V =		2.2.1
a11 1
REVISION=	0
@


1.99
log
@Bugfix update to webkit 2.2.1.

http://webkitgtk.org/2013/10/16/webkitgtk2.2.1-released.html
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.98 2013/10/07 18:47:55 landry Exp $
d12 1
@


1.98
log
@Add a whole bunch of WANTLIB from mesa update and bump.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.97 2013/10/06 19:56:42 landry Exp $
d5 1
a5 1
V =		2.2.0
a10 1
REVISION =	1
@


1.97
log
@Restore EXTRACT_SUFX, this doesnt use GNOME_PROJECT/GNOME_VERSION so it
doesnt default to .tar.xz.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.96 2013/10/06 16:27:26 ajacoutot Exp $
d11 1
a11 1
REVISION =	0
d81 1
@


1.96
log
@Some Makefile cleanup:
* use the x11/gnome MODULE
* group variables
* drop ONLY_FOR_ARCHS since we use the gcc4 MODULE

ok landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.95 2013/10/06 14:18:22 landry Exp $
d12 1
@


1.95
log
@Add ajacoutot@@ as co-maintainer, webkit is such a monster that you need
two crazy frogs to tackle the beast.
@
text
@d1 1
a1 3
# $OpenBSD: Makefile,v 1.94 2013/10/06 14:03:42 landry Exp $

ONLY_FOR_ARCHS=	${GCC4_ARCHS}
d11 1
a11 1
EXTRACT_SUFX=	.tar.xz
d22 4
a25 1
VMEM_WARNING =	Yes
a26 1
USE_GMAKE =	Yes
d28 9
a36 4
MODULES =	devel/gettext \
		textproc/intltool  \
		lang/python \
		lang/ruby
d38 1
a38 1
MODPY_RUNDEP =	No
d42 4
a49 1
PORTHOME =	${WRKDIST}
d51 1
a51 3
CONFIGURE_ENV =	CPPFLAGS="-I${LOCALBASE}/include -I${X11BASE}/include" \
		LDFLAGS="-L${X11BASE}/lib -L${LOCALBASE}/lib -lX11" \
		ac_cv_path_FLEX=${LOCALBASE}/bin/gflex \
d54 2
a55 5
# If one of these tools is found at configure stage, it might be used,
# no matter whether we use --disable-gtk-doc or not.
CONFIGURE_ENV +=ac_cv_path_GTKDOC_CHECK="" \
		ac_cv_path_GTKDOC_REBASE="" \
		ac_cv_path_GTKDOC_MKPDF=""
d58 3
a60 5
CONFIGURE_ARGS+=${CONFIGURE_SHARED} \
		--disable-static \
		--disable-gtk-doc \
		--enable-introspection \
		--enable-spellcheck
a72 2
MAKE_FILE =	GNUmakefile

d103 1
a103 2
		devel/gperf \
		devel/gobject-introspection
a110 10
# eases PLIST/PFRAGs
SUBST_VARS =	WEBKIT_API_VERSION GTK_API_VERSION

MODULES +=		gcc4
MODGCC4_ARCHS =		amd64 i386 powerpc hppa alpha mips64 sparc64 mips64el
MODGCC4_LANGS =		c c++
#MODGCC4_VERSION =	4.8

#c++0x in 4.6, c++11 in 4.8 - removed in a patch but we need to readd it for wk2
CONFIGURE_ENV +=	CXXFLAGS="${CXXFLAGS} -std=c++0x -Wno-c++0x-compat"
a133 1
CONFIGURE_ARGS += --with-gtk=${GTK_API_VERSION}
@


1.94
log
@Update to webkit 2.2.0.

- Now depends on newer gcc, use 4.6 by default.
- Enable webkit2 api in the gtk3 FLAVOR. Still broken/erratic behaviour at
  runtime, but at least this will allow people to debug it, and it's
  required by newer GNOMEs anyway. Provide MiniBrowser for debugging purposes.
- add hack from bug #118732 to workaround the fact that our binutils
  doesnt support 'ar T'
- update patches from #103128 to tentatively fix powerpc runtime
- force-disable YARR_JIT & ASSEMBLE on archs without JIT (ie anything
  besides i386/amd64) via Platform.h patch instead of JSC_CPPFLAGS (which
  doesnt work anymore anyway)
- add a bunch of patches to fix build (missing includes etc) in the WebKit2
  source tree

Tested in an amd64 bulk build, runtime-tested previous betas on
i386/amd64, test-built on powerpc and sparc64. Things might still be
broken at runtime on powerpc, but at least it allows more GNOME things
to be updated.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.93 2013/10/06 09:08:52 ajacoutot Exp $
d18 2
a19 1
MAINTAINER =	Landry Breuil <landry@@openbsd.org>
@


1.93
log
@Regen WANTLIB after orc got put back into gstreamer1.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.92 2013/09/24 18:53:29 ajacoutot Exp $
d7 1
a7 1
V =		2.0.4
a13 1
REVISION=	1
d36 1
d38 2
a70 5
# force-disable JIT/ASSEMBLER on non-jit archs otherwise build fails
.if ${MACHINE_ARCH} != "amd64" && ${MACHINE_ARCH} != "i386"
MAKE_FLAGS +=	JSC_CPPFLAGS="-DENABLE_YARR_JIT=0 -DENABLE_ASSEMBLER=0"
.endif

d106 4
d115 8
d124 5
a128 2
# needs shm_open()/shm_unlink()
CONFIGURE_ARGS+=	--disable-webkit2
d132 1
a132 1
WANTLIB +=	cairo-gobject gailutil-3 gdk-3 gtk-3
d134 1
d137 1
a140 2
WANTLIB +=	gailutil gdk-x11-2.0 gtk-x11-2.0
LIB_DEPENDS +=	x11/gtk+2,-main
d144 1
d146 2
a147 2
SHARED_LIBS += javascriptcoregtk-${WEBKIT_API_VERSION}	3.0 # 13.16
SHARED_LIBS += webkitgtk-${WEBKIT_API_VERSION}		5.0 # 18.9
d155 1
@


1.92
log
@Fix WANTLIB after recent gstreamer1 update.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.91 2013/08/06 19:11:30 ajacoutot Exp $
d14 1
a14 1
REVISION=	0
d86 1
a86 1
		gstaudio-1.0 gstfft-1.0 gdk_pixbuf-2.0 \
@


1.91
log
@Update to webkit 2.0.4.

OK landry@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.90 2013/06/19 13:24:17 ajacoutot Exp $
d14 1
d86 1
a86 1
		gstaudio-1.0 gstfft-1.0 gdk_pixbuf-2.0 orc-0.4 \
@


1.90
log
@Update to webkit-2.0.3.

ok landry@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.89 2013/06/08 12:07:38 landry Exp $
d7 1
a7 1
V =		2.0.3
d132 2
a133 2
SHARED_LIBS += javascriptcoregtk-${WEBKIT_API_VERSION}	3.0 #.13.9
SHARED_LIBS += webkitgtk-${WEBKIT_API_VERSION}		5.0 #.13.9
@


1.89
log
@Put PORTHOME = ${WRKDIST} directly in the port Makefile, apparently it's
how others ports do.
discussed with ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.88 2013/06/08 11:59:46 landry Exp $
d7 1
a7 1
V =		2.0.2
a13 1
REVISION =	1
@


1.88
log
@Add PORTHOME=${WRKDIST} to CONFIGURE_ENV to stop webkit build trying to
write to / like a pig when calling various g-i-r & icon-update-something
binaries during build & fake.
prodded by fgsch@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.87 2013/06/04 18:41:57 naddy Exp $
d38 1
a41 1
		PORTHOME=${WRKDIST} \
@


1.87
log
@the png headers are now directly under include/
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.86 2013/05/31 20:07:33 ajacoutot Exp $
d14 1
a14 1
REVISION =	0
d41 1
@


1.86
log
@Needs to depend on devel/harfbuzz,-icu now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.85 2013/05/14 12:04:59 ajacoutot Exp $
d39 1
a39 1
CONFIGURE_ENV =	CPPFLAGS="-I${LOCALBASE}/include/libpng -I${LOCALBASE}/include -I${X11BASE}/include" \
@


1.85
log
@Update to webkit-2.0.2.

ok landry@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.84 2013/05/07 14:16:52 ajacoutot Exp $
d14 1
d83 1
a83 1
		gobject-2.0 gthread-2.0 jpeg m \
d90 1
a90 1
		harfbuzz icule graphite2 gcrypt gpg-error gsttag-1.0 secret-1 webp
d94 1
a94 1
		textproc/icu4c>=4.4 \
@


1.84
log
@Initialize WebKitWebPlugin path to prevent double-free; from upstream

landry@@ (maintainer) is currently away, so ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.83 2013/04/23 09:40:58 landry Exp $
d7 1
a7 1
V =		2.0.1
a9 1
REVISION =	1
@


1.83
log
@Add a patch to fix stack bounds computation, from David Hill (also
pushed upstream as https://bugs.webkit.org/show_bug.cgi?id=114978)

Seems to fix xombrero/surf crashes on amd64, and seems to magically make
webkit sort-of usable (ie dead-slow, but js seems to work) on powerpc.
(symptom : ** Message: console message: undefined @@0: RangeError: Maximum
call stack size exceeded.)

Note : webkit still fails to build on mips64* and hppa. sigh.

ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.82 2013/04/18 11:31:37 ajacoutot Exp $
d10 1
a10 1
REVISION =	0
@


1.82
log
@Update to webkit-2.0.1.

ok landry@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.81 2013/04/13 09:11:02 landry Exp $
d10 1
@


1.81
log
@Major update to webkit 2.0.0.

- add ruby to BDEPS. Webkit build system now uses autohell, python, ruby and perl \o/
- set MODRUBY_REV = 1.8 on sparc64 since 1.9 is broken there
- disable WebKit2 support, it needs shm_open()/shm_unlink()
- switch from gstreamer-0.10 to gstreamer1
- force-disable JIT/ASSEMBLER on non-jit archs, builds fails otherwise (bug #113638)
- only build NumberPrototype.cpp with -O0 on sparc64, not the damn whole thing
- use -Wl,--relax on ppc otherwise linking fails
- move some patches around since JavaScriptCore/wtf moved to WTF/wtf
- dont uselessly rerun make within make during install, gmake blows
- blindly backport upstream r144077 to fix mips64 build
- backport bits of #103128 & r145551 to fix powerpc build
- backport r147967 & more to fix bashisms in configure
- bug #109932 forced the use of gcc >= 4.7 or clang >= 3.0, but this is
  only for WebKit2 so loosen the check atm

Tested working fine on amd64 & i386, went in bulk builds, known broken
at runtime on ppc (being worked on. or not.) should build on mips64el
(and maybe even run!) and sparc64 (wont run! ever! nothing new here..),
but 'someone' will care about the poor exotic archs and fix'em, right ?

After too much prodding from the gnome maintainers who desperately need it
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.80 2013/03/30 15:02:48 ajacoutot Exp $
d7 1
a7 1
V =		2.0.0
d30 1
a30 2
		lang/ruby \
		devel/dconf
d34 1
d99 2
a100 1
		devel/libsoup>=2.42.0
@


1.80
log
@Fix wantlib.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.79 2013/03/21 08:48:55 ajacoutot Exp $
d7 3
a9 2
V =		1.8.3
DISTNAME =	webkit-${V}
a13 1
REVISION=	5
d30 1
d34 1
d40 2
a41 1
		ac_cv_path_FLEX=${LOCALBASE}/bin/gflex
d56 16
a73 3
# Fix incorrect GCC output which was caused by over optimization
# when compiling Source/JavaScriptCore/runtime/NumberPrototype.cpp
# as it was emitting a fdtox %r8, %r7 call, whose second operand isn't even and thus invalid.
d75 2
a76 1
MAKE_FLAGS=	EXTRA_FLAGS="-O0"
d82 1
a82 1
		gobject-2.0 gthread-2.0 jpeg m gstinterfaces-0.10 \
d84 2
a85 2
		gstaudio-0.10 gstfft-0.10 gdk_pixbuf-2.0 orc-0.4 \
		gstreamer-0.10 gstbase-0.10 gstvideo-0.10 gstapp-0.10 gstpbutils-0.10 \
d89 1
a89 1
		harfbuzz icule graphite2
d91 2
a92 2
LIB_DEPENDS =	multimedia/gstreamer-0.10/core \
		multimedia/gstreamer-0.10/plugins-base \
d97 3
a99 2
		devel/glib2>=2.31.2 \
		devel/libsoup>=2.37.92
a104 2
# required for parallel building
BUILD_DEPENDS+=	gmake->=3.82p2:devel/gmake
d112 3
d118 1
a118 1
WANTLIB +=	atk-bridge-2.0 atspi harfbuzz icule
d122 2
d130 2
a131 2
SHARED_LIBS += javascriptcoregtk-${WEBKIT_API_VERSION}	2.0 #.13.2
SHARED_LIBS += webkitgtk-${WEBKIT_API_VERSION}		4.0 #.13.2
d134 1
a134 1
	${SUBST_CMD} ${WRKSRC}/Source/WebCore/plugins/PluginDatabase.cpp
@


1.79
log
@USE_LIBTOOL=Yes is the default now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.78 2013/03/11 11:44:50 espie Exp $
d13 1
a13 1
REVISION=	4
d66 1
a66 1
		Xau Xdmcp Xxf86vm dbus-1 dbus-glib-1 drm geoclue \
d72 1
a72 1
		harfbuzz icule
@


1.78
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.77 2013/02/09 14:49:53 sthen Exp $
a24 1
USE_LIBTOOL =	Yes
@


1.77
log
@Don't use ${FLAVOR:L}, we only support lower-case flavours now.
OK ajacoutot@@ espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.76 2012/12/21 13:22:26 sthen Exp $
a21 3
PERMIT_PACKAGE_FTP =	Yes
PERMIT_DISTFILES_CDROM =Yes
PERMIT_DISTFILES_FTP =	Yes
@


1.76
log
@sync WANTLIB
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.75 2012/10/03 06:35:46 ajacoutot Exp $
d99 1
a99 1
.if ${FLAVOR:L:Mgtk3}
d119 1
a119 1
.if ${FLAVOR:L:Mgtk3}
@


1.75
log
@Webkit is a rendering engine, so it makes no sense to force dependencies
on the whole gstreamer gang which are only uses by web browsers to
display audio/video.
So remove RUN_DEPENDS, it'll be explicitely added to webkit browsers
with a small comment so that maintainers of such browsers can decide
which gstreamer dependencies they need/want.

ok landry@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.74 2012/10/01 18:12:34 naddy Exp $
d13 1
a13 1
REVISION=	3
d75 2
a76 1
		z cairo pixman-1 png pthread-stubs xcb xml2 stdc++ ffi
d103 1
@


1.74
log
@depend on latest gmake for parallel building; requested by espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.73 2012/10/01 17:49:26 naddy Exp $
d13 1
a13 1
REVISION=	2
a64 3

RUN_DEPENDS =	multimedia/gstreamer-0.10/plugins-ffmpeg \
		multimedia/gstreamer-0.10/plugins-good
@


1.73
log
@mark for parallel building
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.72 2012/09/21 14:48:06 ajacoutot Exp $
d93 2
@


1.72
log
@Stupid autohell is stupid...
The situation is this: even when we --disable-gtk-doc, if gtk-doc is
actually installed at configure stage, tools like gtkdoc-rebase will be
picked up and run during the install target. That is bad because the
gtk-doc package may have been removed by then, especially during dpb(1)
bulks (we explicitely disable support for it so why should it stay...).

So for now, let's add the following env to configure whenever we use
--disable-gtk-doc, until a bettersolution is found...
CONFIGURE_ENV +=ac_cv_path_GTKDOC_CHECK="" \
		ac_cv_path_GTKDOC_REBASE="" \
		ac_cv_path_GTKDOC_MKPDF=""
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.71 2012/09/06 12:38:35 ajacoutot Exp $
d11 1
@


1.71
log
@Bump after gstreamer-plugins-base subpackaging change.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.70 2012/09/06 10:07:27 ajacoutot Exp $
d42 6
@


1.70
log
@Remove gstreamer-0.10/plugins-bad dependency; gstreamer-ffmpeg can take
care of vp8.
Really nothing should depend on gstreamer-0.10/plugins-bad...

ok landry@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.69 2012/09/05 17:22:24 ajacoutot Exp $
d12 1
a12 1
REVISION=	1
@


1.69
log
@Small comment about why we want gstreamer-plugins-bad (vp8).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.68 2012/09/01 14:36:58 ajacoutot Exp $
d12 1
a12 1
REVISION=	0
a58 1
# plugins-bad needed for vp8
a59 1
		multimedia/gstreamer-0.10/plugins-bad \
@


1.68
log
@register-plist did not catch the devel/glib2 -main -> empty change.
espie asked me in such a nice way to fix this that I'm bumping all ports
that have a direct dependency on glib2.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.67 2012/08/22 07:48:37 landry Exp $
d59 1
@


1.67
log
@Bugfix update to webkit 1.8.3.

Remove the pthread/lpthread chunks from patch-GNUmakefile_in while here.

Successfully tested with GtkLauncher on sparc64 after a whooping 21h-build..
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.66 2012/08/07 09:35:37 landry Exp $
d12 1
@


1.66
log
@Bugfix update to webkit 1.8.2.

See http://trac.webkit.org/wiki/WebKitGTK/1.8.x for list of fixes.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.65 2012/04/30 13:31:06 landry Exp $
d7 1
a7 1
V =		1.8.2
@


1.65
log
@Update to webkit 1.8.1.

ok ajacoutot@@, tested by a few on ports@@ (thanks!)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.64 2012/04/23 17:15:19 espie Exp $
d7 1
a7 1
V =		1.8.1
d67 1
a67 1
		gstaudio-0.10 gstfft-0.10 gdk_pixbuf-2.0 \
@


1.64
log
@first pass at handling sqlite3 move
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.63 2012/04/03 15:39:35 landry Exp $
d7 1
a7 1
V =		1.8.0
a9 1
REVISION =	0
d80 1
a80 1
		devel/libsoup>=2.37.2.1
d105 2
a106 2
SHARED_LIBS += javascriptcoregtk-${WEBKIT_API_VERSION}	2.0 #.13.1
SHARED_LIBS += webkitgtk-${WEBKIT_API_VERSION}		3.0 #.13.1
@


1.63
log
@Major update to webkit 1.8.0.

- disable static libs, shrinks package size by a factor 3
- now depends on geoclue for geolocation purposes (of course its up to
  the browsers to enable the feature or not..)
- simplify Makefile/FLAVORS/SHARED_LIBS
- fold most of the PFRAGs to PLIST by using variables
- remove patch-Source_JavaScriptCore_runtime_JSValue_h, seems it was
  added for sparc64 but now it breaks the build there, and noone has been
able to justify the addition of that patch. Without it, GtkLauncher
shows simple html websites on sparc64 and crashes as soon as some js is
involved, but thats not much different from before
- remove patch-Source_JavaScriptCore_wtf_text_StringHash_h &
  patch-Source_JavaScriptCore_wtf_text_StringImpl_cpp, replaced by
patch-Source_JavaScriptCore_runtime_UString_h for mips64/sparc64
- add patch-Source_JavaScriptCore_wtf_NumberOfCores_cpp for #82585

tested on i386/amd64 by several, amd64 bulk build, ppc & sparc64 testing
by myself. mips64el in the works..
ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62 2012/03/13 07:50:05 landry Exp $
d10 1
a76 1
		databases/sqlite3 \
@


1.62
log
@Build on loongson. From Brian Callahan, thanks!
While here, probably improve situation on alpha/sparc64.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.61 2012/02/24 16:36:00 landry Exp $
d7 1
a7 1
V =		1.6.3
a9 1
REVISION =	0
d14 1
a14 1
MASTER_SITES =	${HOMEPAGE}
d41 2
d44 1
d52 1
d66 2
a67 1
		gdk_pixbuf-2.0 \
d79 3
a81 1
		devel/libsoup>=2.34
d90 2
d97 2
a98 3
CONFIGURE_ARGS += --with-gtk=3.0
SHARED_LIBS +=  webkitgtk-3.0            2.0      # .11.0
SHARED_LIBS +=  javascriptcoregtk-3.0    1.0      # 0.0
d102 2
a103 3
CONFIGURE_ARGS += --with-gtk=2.0
SHARED_LIBS +=  javascriptcoregtk-1.0    1.0      # .0.0
SHARED_LIBS +=  webkitgtk-1.0            2.0      # .11.0
d105 3
@


1.61
log
@Update to webkit 1.6.3, based on a diff from marco.

- switch to .tar.xz distfile
- bump libjavascriptgtk major
- backport a commit from upstream bz #68314, fixes issues on twitter

tested by aja@@/pstumpf@@/kili@@ on amd64 & myself on i386/ppc.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.60 2011/11/17 11:42:31 jasper Exp $
d10 1
@


1.60
log
@- move away from gnu libtool now that gobject-introspection has been fixed.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59 2011/11/02 20:00:58 jasper Exp $
d7 1
a7 1
V =		1.6.1
d11 1
a11 2

REVISION =	0
d16 1
a16 1
MAINTAINER =	Landry Breuil <gaston@@gcu.info>
d90 1
a90 1
SHARED_LIBS +=  javascriptcoregtk-3.0    0.0      # 0.0
d95 1
a95 1
SHARED_LIBS +=  javascriptcoregtk-1.0    0.0      # .0.0
@


1.59
log
@fix tyop in comment
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2011/10/17 06:16:58 ajacoutot Exp $
d27 1
a28 3
# XXX: the libtool wrapper script is passed as argument to g-ir-scanner,
# instead of the actual library
USE_LIBTOOL =	gnu
@


1.58
log
@WANTLIB.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.57 2011/10/13 06:52:49 jasper Exp $
d52 1
a52 1
# as it was emitting a fdtox %r8, %r7 call, whose second operatand isn't even and thus invalid.
@


1.57
log
@- update to 1.6.1

tested in a bulk on amd64, as well as on sparc64 by myself
macppc testing by pea@@

ok aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2011/09/26 20:15:29 landry Exp $
d12 2
d90 1
a90 1
WANTLIB +=	cairo-gobject gailutil-3 gdk-3 gtk-3 kvm
@


1.56
log
@Update to webkit 1.4.3, no fallout in a bulk. Bump shlib majors as
apparently a bunch of funcs were removed/added/protos changed.. sigh.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55 2011/09/16 12:00:09 espie Exp $
d7 1
a7 1
V =		1.4.3
a16 4
# XXX should be handled in .if FLAVOR block
SHARED_LIBS +=  webkitgtk-1.0 1.0                # .7.3
SHARED_LIBS +=  webkitgtk-3.0 1.0                # .7.3

d49 6
d67 1
a67 1
		z cairo pixman-1 png pthread-stubs xcb xml2 stdc++
d88 1
a88 1
WANTLIB +=	cairo-gobject gailutil-3 gdk-3 gtk-3
d90 2
d96 2
@


1.55
log
@normalize pkgpath
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.54 2011/07/30 08:09:30 landry Exp $
d7 1
a7 1
V =		1.4.2
a8 1
REVISION =	2
d18 2
a19 2
SHARED_LIBS +=  webkitgtk-1.0 0.1                # .7.0
SHARED_LIBS +=  webkitgtk-3.0 0.1                # .7.0
d57 1
a57 1
WANTLIB =	ICE SM X11 Xau Xcomposite Xcursor Xdamage Xdmcp Xext \
d64 1
a64 1
		pango-1.0 pangocairo-1.0 pangoft2-1.0 pcre pthread GL Xxf86vm drm xcb-shm \
@


1.54
log
@Backport http://trac.webkit.org/changeset/91954.
Allow setting max-conns and max-conns-per-host without overwriting the
given values, which supposedly fixes the file descriptor starvation
issue people were experiencing..
See https://bugs.webkit.org/show_bug.cgi?id=64355 for details.
from and after constant prodding by marco@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2011/07/11 12:08:24 jasper Exp $
d9 1
a9 1
REVISION =	1
@


1.53
log
@- these ports were already ONLY_FOR_ARCHS=${GCC4_ARCHS} by using the gcc4
module on all arches. so remove the module usage and set ONLY_FOR_ARCHS instead

from brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.52 2011/07/05 11:34:27 landry Exp $
d9 1
a9 1
REVISION =	0
@


1.52
log
@Update to webkit 1.4.2, see http://trac.webkit.org/wiki/WebKitGTK/1.4.2
for a list of changes.
ok jasper@@, tested by a few on ports@@
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.51 2011/06/17 22:10:40 landry Exp $
d9 1
a41 10
.include <bsd.own.mk>
.if ${COMPILER_VERSION:L:Mgcc4*}
STDCPPLIB = stdc++
.else
MODULES += 	gcc4
MODGCC4_ARCHES =*
MODGCC4_LANGS =	c c++
STDCPPLIB = estdc++
.endif

a52 1
MAKE_FLAGS =	STDCPPLIB=${STDCPPLIB}
d66 1
a66 1
		z cairo pixman-1 png pthread-stubs xcb xml2 ${STDCPPLIB}
@


1.51
log
@Update to webkit 1.4.1, see https://trac.webkit.org/wiki/WebKitGTK/1.4.1
for a list of changes.
Tested by pea@@ on macppc, myself on sparc64, rpointel@@, marco@@ and myself
on amd64.
ok rpointel@@.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2011/06/08 18:15:30 rpointel Exp $
d5 1
a5 1
V =		1.4.1
@


1.50
log
@bump after default python version switch
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2011/05/30 20:29:05 landry Exp $
d5 1
a5 1
V =		1.4.0
a6 1
REVISION =	3
d15 3
a17 2
SHARED_LIBS +=  webkitgtk-1.0 0.0                # .7.0
SHARED_LIBS +=  webkitgtk-3.0 0.0                # .7.0
@


1.49
log
@Precise that this is the Gtk+ port of webkit, set better licence marker.
From brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2011/05/28 08:15:53 ajacoutot Exp $
d7 1
a7 1
REVISION =	2
@


1.48
log
@Redirect the glib-compile-schemas goo stdout to /dev/null, no need to
be chatty here.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2011/05/19 19:01:03 otto Exp $
d3 1
a3 1
COMMENT =	open source web browser engine
d7 1
a8 1
REVISION =	1
d19 1
a19 1
# LGPLv2 / BSD
@


1.47
log
@Do not initially allocate 1G of mem. It's above out default ulimit.
Only applies to amd64. ok sthen@@ robert@@ landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2011/05/11 06:00:08 ajacoutot Exp $
d8 1
a8 1
REVISION =	0
@


1.46
log
@Major update to webkit-1.4.0.
Now comes with a gtk3 FLAVOR that can be installed alongside the non
flavored package (webkit vs webkit-gtk3).

The library name changed from libwebkit to libwebkit-gtk{1,3}.

thanks to landry@@ and jasper@@ for the tests on powerpc, sparc64 and
amd64.
bulk testing from landry@@

ok jasper@@ landry@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2011/04/15 23:03:03 dhill Exp $
d8 1
@


1.45
log
@bring in two patches from upstream:
1. Fix crash with too big box shadow areas
2. Knob to toggle DNS prefetching

DNS prefetch code done by todd@@

much prodding marco@@
ok landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2011/04/07 19:40:10 jasper Exp $
d5 2
a6 1
DISTNAME =	webkit-1.2.7
a7 1
REVISION =	2	
d15 2
a16 1
SHARED_LIBS =	webkit-1.0	2.2 #.19.5
d32 5
a36 1
		textproc/intltool
d53 4
a56 1
CONFIGURE_ARGS+=--enable-introspection
d67 3
a69 3
		expat fontconfig freetype gcrypt gio-2.0 glib-2.0 gmodule-2.0 \
		gnutls gobject-2.0 gpg-error gthread-2.0 jpeg m \
		gtk-x11-2.0 gdk-x11-2.0 gdk_pixbuf-2.0 gailutil \
d73 1
a73 1
		tasn1 z cairo pixman-1 png pthread-stubs xcb xml2 ${STDCPPLIB}
d75 1
a75 2
LIB_DEPENDS =	x11/gtk+2,-main \
		multimedia/gstreamer-0.10/core \
d81 1
a81 1
		devel/libsoup>=2.28
d88 14
d103 6
a108 1
	${SUBST_CMD} ${WRKSRC}/WebCore/plugins/PluginDatabase.cpp
@


1.44
log
@Add introspection support (needed for on-going GNOME 3 work).

ok landry@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2011/03/08 18:56:30 landry Exp $
d7 1
a7 1
REVISION =	1
@


1.43
log
@Assorted fixes for webkit :
- fix for mips64el by Todd Carson (thanks!)
- fix https://bugs.webkit.org/show_bug.cgi?id=38263 (don't prefetch dns
 on an empty hostname) from sthen@@
- fix https://bugs.webkit.org/show_bug.cgi?id=55830 (Gif images
  flickering), tracked down by dhill@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2011/03/03 13:44:10 landry Exp $
d7 1
a7 1
REVISION =	0
d26 3
a28 1
USE_LIBTOOL =	Yes
d48 1
a48 1
CONFIGURE_ARGS+=--enable-introspection=no
d78 2
a79 1
		devel/gperf
@


1.42
log
@Update to webkit 1.2.7.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2010/12/30 17:55:32 landry Exp $
d7 1
@


1.41
log
@Update to webkit 1.2.6, bugfixes only. Tweak WANTLIB while here.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2010/12/26 08:32:07 landry Exp $
d5 1
a5 1
DISTNAME =	webkit-1.2.6
@


1.40
log
@Add gst-plugins-bad to RUN_DEPENDS, so that webkit-based browsers know
how to handle WebM/vp8 video out of the box. From brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2010/12/17 16:17:54 ajacoutot Exp $
d5 1
a5 1
DISTNAME =	webkit-1.2.5
a6 1
REVISION = 	1
d61 1
a61 1
		pango-1.0 pangocairo-1.0 pangoft2-1.0 pcre pthread xcb-render-util \
@


1.39
log
@Use the gettext module instead of the libiconv one and set WANTLIB
accordingly.

ok landry@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2010/11/22 08:36:55 espie Exp $
d7 1
a7 1
REVISION = 	0
d52 1
@


1.38
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2010/10/24 21:40:10 ajacoutot Exp $
d7 1
d28 1
a28 1
MODULES =	converters/libiconv \
d57 1
a57 1
		gnutls gobject-2.0 gpg-error gthread-2.0 intl jpeg m \
@


1.37
log
@Remove USE_X11.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2010/10/12 08:43:05 landry Exp $
d50 2
a51 2
RUN_DEPENDS =	::multimedia/gstreamer-0.10/plugins-ffmpeg \
		::multimedia/gstreamer-0.10/plugins-good
d63 12
a74 12
LIB_DEPENDS =	::x11/gtk+2,-main \
		::multimedia/gstreamer-0.10/core \
		::multimedia/gstreamer-0.10/plugins-base \
		:icu4c->=4.4:textproc/icu4c \
		::databases/sqlite3 \
		::textproc/libxslt \
		::textproc/enchant \
		:libsoup->=2.28:devel/libsoup

BUILD_DEPENDS =	::devel/bison \
		::devel/flex \
		::devel/gperf
@


1.36
log
@Update to webkit 1.2.5, prodded by a diff from brad
Fixes CVE-2010-3259 CVE-2010-3113 CVE-2010-1814 CVE-2010-1812 CVE-2010-1815
CVE-2010-3115 CVE-2010-1807 CVE-2010-3114 CVE-2010-3116 CVE-2010-3257
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2010/10/11 08:19:04 jasper Exp $
a23 1
USE_X11 =	Yes
@


1.35
log
@- fix WANTLIB after cairo update.

(please note chromium is still broken, but will be dealt with soon)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2010/09/28 21:20:56 jasper Exp $
d5 1
a5 1
DISTNAME =	webkit-1.2.4
a6 1
REVISION=	0
@


1.34
log
@sorry landry, hobbits ruin you day.
he mumbled something about going back to the introspection of life, which was
taken as OK.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2010/09/19 20:43:32 landry Exp $
d7 1
d57 1
a57 1
		expat fontconfig freetype gcrypt gio-2.0 glib-2.0 glitz gmodule-2.0 \
@


1.33
log
@Update to webkit 1.2.4.
Tested by pea@@, Dawe, Remi Pointel, jasper@@ and marco@@, thanks!
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2010/08/30 13:15:49 landry Exp $
d46 1
@


1.32
log
@Don't force the use of -O2, the ports infrastructure takes care of
adding it. Makes the port respect user-defined CFLAGS.
Pointed out by brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2010/07/19 12:29:50 landry Exp $
d5 1
a5 1
DISTNAME =	webkit-1.2.3
a6 1
REVISION =	0
@


1.31
log
@Update to webkit 1.2.3, switch to newer LIB_DEPENDS/WANTLIB/EPOCH.
Regen patches while here.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2010/07/03 07:53:04 landry Exp $
d7 1
@


1.30
log
@Update to webkit 1.2.1, fix WANTLIB, tighten lib_depends on icu4c-4.4
(from jcs@@). Tested by kili@@ on amd64 and myself on sparc64/macppc.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2010/06/21 15:55:33 ajacoutot Exp $
d5 2
a6 4
V = 1.2.1
DISTNAME =	webkit-${V}
# XXX do not remove v0. pX comes before vX.
PKGNAME =	webkit-${V}v0
d14 1
a14 1
SHARED_LIBS =	webkit-1.0	2.1 #.19.2
d57 3
d63 8
a70 8
LIB_DEPENDS =	gtk-x11-2.0,gdk-x11-2.0,gdk_pixbuf-2.0,gailutil::x11/gtk+2,-main \
		gstreamer-0.10,gstbase-0.10::multimedia/gstreamer-0.10/core \
		gstvideo-0.10,gstapp-0.10,gstpbutils-0.10::multimedia/gstreamer-0.10/plugins-base \
		icudata,icui18n,icuuc:icu4c->=4.4:textproc/icu4c \
		sqlite3::databases/sqlite3 \
		xslt::textproc/libxslt \
		enchant::textproc/enchant \
		soup-2.4:libsoup->=2.28:devel/libsoup
@


1.29
log
@Remove stdc++ from WANTLIB, it's handled within a gcc ifdef block.

ok landry@@ jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2010/06/05 16:36:44 landry Exp $
d5 1
a5 1
V = 1.2.0
d8 1
a8 1
PKGNAME =	webkit-${V}p2v0
d56 1
a56 1
		Xfixes Xi Xinerama Xrandr Xrender Xt atk-1.0 c \
d59 1
a59 1
		pango-1.0 pangocairo-1.0 pangoft2-1.0 pcre pthread \
d65 1
a65 1
		icudata,icui18n,icuuc::textproc/icu4c \
@


1.28
log
@Add STDCPPLIB to WANTLIB and bump. Fixes PLISTDB complains..
prompted/cluebat by espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2010/05/23 10:27:46 espie Exp $
d8 1
a8 1
PKGNAME =	webkit-${V}p1v0
d60 1
a60 1
		tasn1 z cairo pixman-1 png pthread-stubs stdc++ xcb xml2 ${STDCPPLIB}
@


1.27
log
@fix for gcc4
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2010/05/17 20:16:09 ajacoutot Exp $
d8 1
a8 1
PKGNAME =	webkit-${V}p0v0
d60 1
a60 1
		tasn1 z cairo pixman-1 png pthread-stubs stdc++ xcb xml2
@


1.26
log
@Fix the default error.html (used by at least epiphany), so that the
font-size is set to 120%, not 120px.

ok landry@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2010/04/22 13:36:59 landry Exp $
d31 1
a31 2
		textproc/intltool \
		gcc4
d33 5
d40 2
d50 1
@


1.25
log
@Update to webkit 1.2.0, with much prodding from the hobbits as it's
needed for more and more stuff in G-NOME. Still currently building on
sparc64/powerpc.
ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2010/04/05 21:44:41 landry Exp $
d8 1
a8 1
PKGNAME =	webkit-${V}v0
@


1.24
log
@Fix from gentoo bz #308699 to allow webkit to build with icu 4.4.
Upstream bz #36381.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2010/01/23 10:14:37 landry Exp $
d5 1
a5 1
V = 1.1.18
d8 1
a8 1
PKGNAME =	webkit-${V}p1v0
d16 1
a16 1
SHARED_LIBS =	webkit-1.0	2.0 #.16.0
d57 1
a57 1
		gstvideo-0.10,gstpbutils-0.10::multimedia/gstreamer-0.10/plugins-base \
@


1.23
log
@Add gstreamer plugins-ffmpeg & plugins-good to RUN_DEPENDS, somehow i
forgot it when updating to 1.1.18. This will be needed for the day HTML5
video actually works in webkit-based browsers..
ok espie@@ jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2010/01/10 20:06:17 landry Exp $
d8 1
a8 1
PKGNAME =	webkit-${V}p0v0
@


1.22
log
@Update to webkit 1.1.18:
- add a pair of patches to make it finally run without SIGBUS on sparc64
  (yay!), reported as https://bugs.webkit.org/show_bug.cgi?id=19775
- add a patch to disable some optimizations on ppc, so that it finally
  builds fine, reported as https://bugs.webkit.org/show_bug.cgi?id=33451
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2009/11/29 10:08:26 landry Exp $
d8 1
a8 1
PKGNAME =	webkit-${V}v0
d44 3
@


1.21
log
@Update to webkit 1.1.15.4, fix stupid mistake in build output that tried
to execute every target in Makefile, and enable Gstreamer support (which
is on by default upstream since months)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2009/11/18 00:49:09 sthen Exp $
d5 1
a5 1
V = 1.1.15.4
d16 1
a16 1
SHARED_LIBS =	webkit-1.0	1.0
@


1.20
log
@- fix dependencies following libstdc++ bump from 4.2.4p3 to 4.2.4v0
- bump relevant PKGNAMEs
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2009/11/08 16:19:34 ajacoutot Exp $
d5 1
a5 1
V = 1.1.15.2
d8 1
a8 1
PKGNAME =	webkit-${V}p2v0
a38 9
CONFIGURE_ARGS =	--disable-video

#LIB_DEPENDS+=	gstreamer-0.10,gstbase-0.10::multimedia/gstreamer-0.10/core \
#		gstvideo-0.10::multimedia/gstreamer-0.10/plugins-base \
#RUN_DEPENDS =	::multimedia/gstreamer-0.10/plugins-base,-ogg \
#		::multimedia/gstreamer-0.10/plugins-base,-vorbis \
#		::multimedia/gstreamer-0.10/plugins-base,-theora


d53 2
@


1.19
log
@Fix mozilla plugins directory, for some reason we don't use the default...

ok  landry@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2009/10/29 16:46:09 sthen Exp $
d8 1
a8 1
PKGNAME =	webkit-${V}p1v0
@


1.18
log
@switch to flex 2.5.35; ok landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2009/10/11 18:31:12 landry Exp $
d8 1
a8 1
PKGNAME =	webkit-${V}p0v0
d71 3
@


1.17
log
@Long overdue update to webkit 1.1.15.2 :
bump major to be on the safe side, add commented-out entries for
gstreamer LIB/RUN_DEPENDS for the day we enable HTML5 video support.
midori/devhelp are happy with it..
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2009/08/31 19:00:01 kili Exp $
d7 2
a8 2
# XXX do not remove v0
PKGNAME =	webkit-${V}v0
d49 2
a50 1
		LDFLAGS="-L${X11BASE}/lib -L${LOCALBASE}/lib -lX11"
d69 1
@


1.16
log
@WANTLIB += pthread-stubs xcb, and bump.

How could I miss this one?
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2009/06/18 20:09:20 landry Exp $
d5 1
a5 1
V = 1.1.10
d8 1
a8 1
PKGNAME =	webkit-${V}p0v0
d16 1
a16 1
SHARED_LIBS =	webkit-1.0	0.3
d41 7
d65 1
a65 2
		soup-2.4:libsoup->=2.26:devel/libsoup

@


1.15
log
@Update to webkit 1.1.10, fix WANTLIB, bump minor.
Tested by jasper@@ on ppc, sthen@@ on amd64 and myself on i386.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2009/06/01 05:51:31 landry Exp $
d8 1
a8 1
PKGNAME =	webkit-${V}v0
d51 1
a51 1
		tasn1 z cairo pixman-1 png stdc++ xml2
@


1.14
log
@Update to webkit-gtk 1.1.8, heavy consumers are happy with it, tested
@@ppc/amd64/i386. Add a temporary workaround for upstream bz #26099.
Bumps minor as some funcs were added.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2009/05/17 09:40:53 sthen Exp $
d5 1
a5 1
V = 1.1.8
d7 1
d16 1
a16 1
SHARED_LIBS =	webkit-1.0	0.2
d51 1
a51 1
		tasn1 z cairo pixman-1 png xml2
d53 1
a53 1
LIB_DEPENDS =	gtk-x11-2.0,gdk-x11-2.0,gdk_pixbuf-2.0::x11/gtk+2,-main \
@


1.13
log
@bump for gcc4.port.mk LIB_DEPENDS change
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2009/04/27 19:25:08 landry Exp $
d5 1
a5 1
V = 1.1.5
d7 1
a7 1
PKGNAME =	webkit-${V}p0v0
d15 1
a15 1
SHARED_LIBS =	webkit-1.0	0.1
d56 1
@


1.12
log
@Update to webkit 1.1.5v0, finally switch to plain releases instead of
tracking a random svn snapshot, as webkit-gtk has regular releases now.

ok ajacoutot@@ phessler@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2009/04/06 07:40:30 landry Exp $
d7 1
a7 1
PKGNAME =	webkit-${V}v0
@


1.11
log
@Explicitely depend on libsoup->=2.26, spotted by jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2009/04/04 10:35:26 landry Exp $
d5 3
a7 3
V = 41894
DISTNAME =	WebKit-r${V}
PKGNAME =	webkit-${V}p0
a8 1
EXTRACT_SUFX =	.tar.bz2
d10 2
a11 2
HOMEPAGE =	http://webkit.org/
MASTER_SITES =	http://builds.nightly.webkit.org/files/trunk/src/
d15 1
a15 2
SHARED_LIBS =	webkit-1.0	0.0 \
		testnetscapeplugin	0.0
a35 2
AUTOMAKE_VERSION =	1.9
AUTOCONF_VERSION =	2.59
d60 1
a60 7
		::devel/gperf \
		${MODGNU_AUTOCONF_DEPENDS} \
		${MODGNU_AUTOMAKE_DEPENDS}

pre-configure:
	cd ${WRKSRC} && AUTOCONF_VERSION=${AUTOCONF_VERSION} \
		AUTOMAKE_VERSION=${AUTOMAKE_VERSION} ./autogen.sh
@


1.10
log
@Update to webkit r41894, taking advantage of libsoup 2.26 update..
Regen patches while here.
Tested in a bulk build by and ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2009/03/08 20:00:41 landry Exp $
d7 1
a7 1
PKGNAME =	webkit-${V}
d60 1
a60 1
		soup-2.4::devel/libsoup
@


1.9
log
@Update to webkit-svn r41121. The http backend switched from curl to
libsoup, tweak WANTLIB accordingly. Patch autogen.sh and run it instead
of manually running automake and autoconf (which turned out to be hairy)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2009/01/25 22:16:40 landry Exp $
d5 1
a5 1
V = 41121
d41 2
@


1.8
log
@Add a patch to make webkit build on sparc64, which should hopefully let
the half of gnome compile again there. It still SIGBUS'es at runtime
though, but maybe someday i'll find the correct fix.
Ah, and did i mention it takes eleven hours to build on a dual-usIIIi
@@1Ghz, and that DEBUG=-g is impossible because it eats all memory ?
@
text
@d5 1
a5 1
V = 40000
d7 1
a7 1
PKGNAME =	webkit-${V}p0
d34 1
d42 2
a43 2
CONFIGURE_ENV =	CPPFLAGS="-I${LOCALBASE}/include/libpng -I${X11BASE}/include" \
		LDFLAGS="-L${X11BASE}/lib -lX11"
d48 5
a52 4
		Xfixes Xi Xinerama Xrandr Xrender Xt atk-1.0 c crypto \
		expat fontconfig freetype gio-2.0 glib-2.0 glitz gmodule-2.0 \
		gobject-2.0 gthread-2.0 idn intl jpeg m pango-1.0 pangocairo-1.0 \
		pangoft2-1.0 pcre pthread ssl z cairo pixman-1 png xml2
d58 1
a58 1
		curl::net/curl
d68 1
a68 3
		AUTOMAKE_VERSION=${AUTOMAKE_VERSION} autoreconf --install
	cd ${WRKSRC} && AUTOCONF_VERSION=${AUTOCONF_VERSION} \
		AUTOMAKE_VERSION=${AUTOMAKE_VERSION} automake --add-missing --copy
@


1.7
log
@Update Webkit to r40000 svn snapshot.
While here, link with -pthread instead of -lpthread, spotted by
ajacoutot@@.
Remove the BROKEN marker on sparc64 upon jasper@@'s request to let
gnome/devhelp build, although it still SIGBUS'es badly at runtime
(which is being worked on, and driving me nuts)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2008/12/19 11:52:55 sthen Exp $
d7 1
a7 1
PKGNAME =	webkit-${V}
@


1.6
log
@add comment re: www/kazehakase near to BROKEN line, reminding anyone
who fixes webkit to adjust the list of arch in kazehakase.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2008/12/05 19:56:53 ajacoutot Exp $
d5 1
a5 1
V = 37790
d16 2
a17 1
SHARED_LIBS =	webkit-1.0	0.0
a30 5
.if ${MACHINE_ARCH} == "sparc64"
BROKEN =	SIGBUS at runtime, being worked on
# please update list in www/kazehakase if fixed
.endif

d41 3
d48 1
a48 1
		expat fontconfig freetype glib-2.0 glitz gmodule-2.0 \
@


1.5
log
@- my machine got exhausted trying to build this... and failed.
add VMEM_WARNING
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2008/10/26 12:59:01 landry Exp $
d32 1
@


1.4
log
@Update webkit to a more recent svn snapshot.
ok phessler@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2008/07/25 15:07:55 landry Exp $
d23 2
@


1.3
log
@Really fix pre-configure target, no cookie for me.
CC=path/to/cc is not needed because ports infrastructure picks cc in
${WRKSRC}/bin when using gcc4 MODULE.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2008/07/25 14:51:56 landry Exp $
d5 1
a5 1
V = 35249
@


1.2
log
@s/PREFIX/LOCALBASE/g in pre-configure target, and remove unneeded
SETENV.
prodded by ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2008/07/25 12:51:10 landry Exp $
d63 4
a66 6
	cd ${WRKSRC} && CC=${LOCALBASE}/bin/egcc CXX=${LOCALBASE}/bin/eg++ \
		AUTOCONF_VERSION=${AUTOCONF_VERSION} AUTOMAKE_VERSION=${AUTOMAKE_VERSION} \
		autoreconf --install
	cd ${WRKSRC} && CC=${LOCALBASE}/bin/egcc CXX=${LOCALBASE}/bin/eg++ \
		AUTOCONF_VERSION=${AUTOCONF_VERSION} AUTOMAKE_VERSION=${AUTOMAKE_VERSION} \
		automake --add-missing --copy
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d63 1
a63 1
	cd ${WRKSRC} && ${SETENV} CC=${PREFIX}/bin/egcc CXX=${PREFIX}/bin/eg++ \
d66 1
a66 1
	cd ${WRKSRC} && ${SETENV} CC=${PREFIX}/bin/egcc CXX=${PREFIX}/bin/eg++ \
@


1.1.1.1
log
@Import webkit svn rev35249, based on an original work from James Turner
(james at bsdgroup dot org), thanks !
Webkit is an open source web rendering engine.

All our previous patches have been integrated upstream.
Mark it BROKEN on sparc64 until
https://bugs.webkit.org/show_bug.cgi?id=19775 is fixed.
Not linked to the build yet, a little bit of testing is still needed
with latest libc/libm change.
Thanks to all who already tested !

ok jdixon@@ laurent@@ 'import it' robert@@ espie@@
@
text
@@
