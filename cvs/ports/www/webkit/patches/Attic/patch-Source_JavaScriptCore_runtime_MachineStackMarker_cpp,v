head	1.2;
access;
symbols
	OPENBSD_5_0:1.1.0.2
	OPENBSD_5_0_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2011.10.13.06.52.49;	author jasper;	state dead;
branches;
next	1.1;

1.1
date	2011.05.11.06.00.08;	author ajacoutot;	state Exp;
branches;
next	;


desc
@@


1.2
log
@- update to 1.6.1

tested in a bulk on amd64, as well as on sparc64 by myself
macppc testing by pea@@

ok aja@@
@
text
@$OpenBSD: patch-Source_JavaScriptCore_runtime_MachineStackMarker_cpp,v 1.1 2011/05/11 06:00:08 ajacoutot Exp $
--- Source/JavaScriptCore/runtime/MachineStackMarker.cpp.orig	Fri May  6 09:40:06 2011
+++ Source/JavaScriptCore/runtime/MachineStackMarker.cpp	Fri May  6 10:29:29 2011
@@@@ -370,8 +370,10 @@@@ static size_t getPlatformThreadRegisters(const Platfor
 #elif USE(PTHREADS)
     pthread_attr_init(&regs);
 #if HAVE(PTHREAD_NP_H) || OS(NETBSD)
+#  ifndef __OpenBSD__
     // e.g. on FreeBSD 5.4, neundorf@@kde.org
     pthread_attr_get_np(platformThread, &regs);
+#  endif
 #else
     // FIXME: this function is non-portable; other POSIX systems may have different np alternatives
     pthread_getattr_np(platformThread, &regs);
@@@@ -420,7 +422,14 @@@@ static inline void* otherThreadStackPointer(const Plat
 #elif USE(PTHREADS)
     void* stackBase = 0;
     size_t stackSize = 0;
+# if defined(__OpenBSD__)
+    stack_t ss;
+    int rc = pthread_stackseg_np(pthread_self(), &ss);
+    stackBase = (void*)((size_t) ss.ss_sp - ss.ss_size);
+    stackSize = ss.ss_size;
+#else
     int rc = pthread_attr_getstack(&regs, &stackBase, &stackSize);
+#endif
     (void)rc; // FIXME: Deal with error code somehow? Seems fatal.
     ASSERT(stackBase);
     return static_cast<char*>(stackBase) + stackSize;
@


1.1
log
@Major update to webkit-1.4.0.
Now comes with a gtk3 FLAVOR that can be installed alongside the non
flavored package (webkit vs webkit-gtk3).

The library name changed from libwebkit to libwebkit-gtk{1,3}.

thanks to landry@@ and jasper@@ for the tests on powerpc, sparc64 and
amd64.
bulk testing from landry@@

ok jasper@@ landry@@ (maintainer)
@
text
@d1 1
a1 1
$OpenBSD$
@

