head	1.4;
access;
symbols
	OPENBSD_4_6:1.3.0.2
	OPENBSD_4_6_BASE:1.3
	OPENBSD_4_5:1.1.0.2
	OPENBSD_4_5_BASE:1.1;
locks; strict;
comment	@# @;


1.4
date	2009.10.11.18.31.12;	author landry;	state dead;
branches;
next	1.3;

1.3
date	2009.04.04.10.35.26;	author landry;	state Exp;
branches;
next	1.2;

1.2
date	2009.03.08.20.00.41;	author landry;	state Exp;
branches;
next	1.1;

1.1
date	2009.02.18.22.09.48;	author landry;	state Exp;
branches;
next	;


desc
@@


1.4
log
@Long overdue update to webkit 1.1.15.2 :
bump major to be on the safe side, add commented-out entries for
gstreamer LIB/RUN_DEPENDS for the day we enable HTML5 video support.
midori/devhelp are happy with it..
@
text
@$OpenBSD: patch-JavaScriptCore_wtf_Threading_h,v 1.3 2009/04/04 10:35:26 landry Exp $

Sparc64 definitely doesn't like __gnu_cxx::__atomic_add.
--- JavaScriptCore/wtf/Threading.h.orig	Sat Mar 14 11:04:35 2009
+++ JavaScriptCore/wtf/Threading.h	Mon Mar 23 23:08:39 2009
@@@@ -204,7 +204,7 @@@@ inline int atomicDecrement(int volatile* addend) { ret
 inline void atomicIncrement(int volatile* addend) { OSAtomicIncrement32Barrier(const_cast<int*>(addend)); }
 inline int atomicDecrement(int volatile* addend) { return OSAtomicDecrement32Barrier(const_cast<int*>(addend)); }
 
-#elif COMPILER(GCC)
+#elif COMPILER(GCC) && !PLATFORM(SPARC64)
 #define WTF_USE_LOCKFREE_THREADSAFESHARED 1
 
 inline void atomicIncrement(int volatile* addend) { __gnu_cxx::__atomic_add(addend, 1); }
@


1.3
log
@Update to webkit r41894, taking advantage of libsoup 2.26 update..
Regen patches while here.
Tested in a bulk build by and ok jasper@@
@
text
@d1 1
a1 1
$OpenBSD: patch-JavaScriptCore_wtf_Threading_h,v 1.2 2009/03/08 20:00:41 landry Exp $
@


1.2
log
@Update to webkit-svn r41121. The http backend switched from curl to
libsoup, tweak WANTLIB accordingly. Patch autogen.sh and run it instead
of manually running automake and autoconf (which turned out to be hairy)
@
text
@d1 1
a1 1
$OpenBSD: patch-JavaScriptCore_wtf_Threading_h,v 1.1 2009/02/18 22:09:48 landry Exp $
d4 3
a6 3
--- JavaScriptCore/wtf/Threading.h.orig	Sun Jan 25 03:24:37 2009
+++ JavaScriptCore/wtf/Threading.h	Sun Feb 22 22:38:46 2009
@@@@ -197,7 +197,7 @@@@ inline int atomicDecrement(int volatile* addend) { ret
@


1.1
log
@Add a patch to make webkit build on sparc64, which should hopefully let
the half of gnome compile again there. It still SIGBUS'es at runtime
though, but maybe someday i'll find the correct fix.
Ah, and did i mention it takes eleven hours to build on a dual-usIIIi
@@1Ghz, and that DEBUG=-g is impossible because it eats all memory ?
@
text
@d1 1
a1 1
$OpenBSD$
d4 3
a6 3
--- JavaScriptCore/wtf/Threading.h.orig	Thu Jan 22 10:13:09 2009
+++ JavaScriptCore/wtf/Threading.h	Thu Jan 22 10:16:37 2009
@@@@ -194,7 +194,7 @@@@ inline int atomicDecrement(int volatile* addend) { ret
@

