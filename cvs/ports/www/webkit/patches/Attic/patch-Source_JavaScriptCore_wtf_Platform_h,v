head	1.7;
access;
symbols
	OPENBSD_5_3:1.6.0.2
	OPENBSD_5_3_BASE:1.6
	OPENBSD_5_2:1.4.0.2
	OPENBSD_5_2_BASE:1.4
	OPENBSD_5_1_BASE:1.2
	OPENBSD_5_1:1.2.0.2
	OPENBSD_5_0:1.1.0.2
	OPENBSD_5_0_BASE:1.1;
locks; strict;
comment	@# @;


1.7
date	2013.04.13.09.11.02;	author landry;	state dead;
branches;
next	1.6;

1.6
date	2012.10.07.09.24.18;	author landry;	state Exp;
branches;
next	1.5;

1.5
date	2012.08.07.09.35.38;	author landry;	state Exp;
branches;
next	1.4;

1.4
date	2012.04.03.15.39.35;	author landry;	state Exp;
branches;
next	1.3;

1.3
date	2012.03.13.07.50.05;	author landry;	state Exp;
branches;
next	1.2;

1.2
date	2011.10.13.06.52.49;	author jasper;	state Exp;
branches;
next	1.1;

1.1
date	2011.05.11.06.00.08;	author ajacoutot;	state Exp;
branches;
next	;


desc
@@


1.7
log
@Major update to webkit 2.0.0.

- add ruby to BDEPS. Webkit build system now uses autohell, python, ruby and perl \o/
- set MODRUBY_REV = 1.8 on sparc64 since 1.9 is broken there
- disable WebKit2 support, it needs shm_open()/shm_unlink()
- switch from gstreamer-0.10 to gstreamer1
- force-disable JIT/ASSEMBLER on non-jit archs, builds fails otherwise (bug #113638)
- only build NumberPrototype.cpp with -O0 on sparc64, not the damn whole thing
- use -Wl,--relax on ppc otherwise linking fails
- move some patches around since JavaScriptCore/wtf moved to WTF/wtf
- dont uselessly rerun make within make during install, gmake blows
- blindly backport upstream r144077 to fix mips64 build
- backport bits of #103128 & r145551 to fix powerpc build
- backport r147967 & more to fix bashisms in configure
- bug #109932 forced the use of gcc >= 4.7 or clang >= 3.0, but this is
  only for WebKit2 so loosen the check atm

Tested working fine on amd64 & i386, went in bulk builds, known broken
at runtime on ppc (being worked on. or not.) should build on mips64el
(and maybe even run!) and sparc64 (wont run! ever! nothing new here..),
but 'someone' will care about the poor exotic archs and fix'em, right ?

After too much prodding from the gnome maintainers who desperately need it
@
text
@$OpenBSD: patch-Source_JavaScriptCore_wtf_Platform_h,v 1.6 2012/10/07 09:24:18 landry Exp $

Allow webkit to build and run on mips64
Recognize hppa

--- Source/JavaScriptCore/wtf/Platform.h.orig	Mon Aug 20 10:30:25 2012
+++ Source/JavaScriptCore/wtf/Platform.h	Sat Oct  6 02:51:40 2012
@@@@ -76,9 +76,14 @@@@
 
 /* CPU(MIPS) - MIPS 32-bit */
 /* Note: Only O32 ABI is tested, so we enable it for O32 ABI for now.  */
-#if (defined(mips) || defined(__mips__) || defined(MIPS) || defined(_MIPS_)) \
-    && defined(_ABIO32)
+#if (defined(mips) || defined(__mips__) || defined(MIPS) || defined(_MIPS_) || defined(__mips64__))
+#if defined(_ABIO32)
 #define WTF_CPU_MIPS 1
+#endif
+#if defined(__mips64__)
+#define	WTF_CPU_MIPS64	1
+#define	USE_SYSTEM_MALLOC 1
+#endif
 #if defined(__MIPSEB__)
 #define WTF_CPU_BIG_ENDIAN 1
 #endif
@@@@ -118,6 +123,11 @@@@
 #define WTF_CPU_SH4 1
 #endif
 
+/* CPU(HPPA) - HP-PA */
+#if defined(__hppa__)
+#define WTF_CPU_HPPA 1
+#endif
+
 /* CPU(SPARC32) - SPARC 32-bit */
 #if defined(__sparc) && !defined(__arch64__) || defined(__sparcv8)
 #define WTF_CPU_SPARC32 1
@@@@ -295,7 +305,7 @@@@
 
 #endif /* ARM */
 
-#if CPU(ARM) || CPU(MIPS) || CPU(SH4) || CPU(SPARC)
+#if CPU(ARM) || CPU(MIPS) || CPU(SH4) || CPU(SPARC) || CPU(MIPS64) || CPU(SPARC64)
 #define WTF_CPU_NEEDS_ALIGNED_ACCESS 1
 #endif
 
@@@@ -899,7 +909,8 @@@@
     || CPU(ALPHA) \
     || CPU(SPARC64) \
     || CPU(S390X) \
-    || CPU(PPC64)
+    || CPU(PPC64) \
+    || CPU(MIPS64)
 #define WTF_USE_JSVALUE64 1
 #else
 #define WTF_USE_JSVALUE32_64 1
@


1.6
log
@Add the missing goo to allow webkit to build on hppa, opening the can of
worms for a whole bunch of new ports there.
@
text
@d1 1
a1 1
$OpenBSD: patch-Source_JavaScriptCore_wtf_Platform_h,v 1.5 2012/08/07 09:35:38 landry Exp $
@


1.5
log
@Bugfix update to webkit 1.8.2.

See http://trac.webkit.org/wiki/WebKitGTK/1.8.x for list of fixes.
@
text
@d1 1
a1 1
$OpenBSD: patch-Source_JavaScriptCore_wtf_Platform_h,v 1.4 2012/04/03 15:39:35 landry Exp $
d4 1
d6 2
a7 2
--- Source/JavaScriptCore/wtf/Platform.h.orig	Wed Aug  1 09:55:05 2012
+++ Source/JavaScriptCore/wtf/Platform.h	Fri Aug  3 16:33:41 2012
d25 13
a37 1
@@@@ -295,7 +300,7 @@@@
d46 1
a46 1
@@@@ -899,7 +904,8 @@@@
@


1.4
log
@Major update to webkit 1.8.0.

- disable static libs, shrinks package size by a factor 3
- now depends on geoclue for geolocation purposes (of course its up to
  the browsers to enable the feature or not..)
- simplify Makefile/FLAVORS/SHARED_LIBS
- fold most of the PFRAGs to PLIST by using variables
- remove patch-Source_JavaScriptCore_runtime_JSValue_h, seems it was
  added for sparc64 but now it breaks the build there, and noone has been
able to justify the addition of that patch. Without it, GtkLauncher
shows simple html websites on sparc64 and crashes as soon as some js is
involved, but thats not much different from before
- remove patch-Source_JavaScriptCore_wtf_text_StringHash_h &
  patch-Source_JavaScriptCore_wtf_text_StringImpl_cpp, replaced by
patch-Source_JavaScriptCore_runtime_UString_h for mips64/sparc64
- add patch-Source_JavaScriptCore_wtf_NumberOfCores_cpp for #82585

tested on i386/amd64 by several, amd64 bulk build, ppc & sparc64 testing
by myself. mips64el in the works..
ok ajacoutot@@
@
text
@d1 1
a1 1
$OpenBSD: patch-Source_JavaScriptCore_wtf_Platform_h,v 1.3 2012/03/13 07:50:05 landry Exp $
d5 2
a6 2
--- Source/JavaScriptCore/wtf/Platform.h.orig	Tue Mar  6 16:44:16 2012
+++ Source/JavaScriptCore/wtf/Platform.h	Sat Mar 31 09:21:30 2012
d33 1
a33 1
@@@@ -898,7 +903,8 @@@@
@


1.3
log
@Build on loongson. From Brian Callahan, thanks!
While here, probably improve situation on alpha/sparc64.
@
text
@d1 1
a1 1
$OpenBSD: patch-Source_JavaScriptCore_wtf_Platform_h,v 1.2 2011/10/13 06:52:49 jasper Exp $
d5 2
a6 2
--- Source/JavaScriptCore/wtf/Platform.h.orig	Sat Oct 15 07:26:50 2011
+++ Source/JavaScriptCore/wtf/Platform.h	Tue Mar 13 08:47:48 2012
d28 2
a29 2
-#if CPU(ARM) || CPU(MIPS) || CPU(SH4)
+#if CPU(ARM) || CPU(MIPS) || CPU(SH4) || CPU(MIPS64) || CPU(SPARC64)
d33 1
a33 1
@@@@ -913,7 +918,8 @@@@
@


1.2
log
@- update to 1.6.1

tested in a bulk on amd64, as well as on sparc64 by myself
macppc testing by pea@@

ok aja@@
@
text
@d1 1
a1 1
$OpenBSD: patch-Source_JavaScriptCore_wtf_Platform_h,v 1.1 2011/05/11 06:00:08 ajacoutot Exp $
d5 2
a6 2
--- Source/JavaScriptCore/wtf/Platform.h.orig	Mon Sep 26 22:54:57 2011
+++ Source/JavaScriptCore/wtf/Platform.h	Fri Oct  7 10:03:03 2011
d24 9
@


1.1
log
@Major update to webkit-1.4.0.
Now comes with a gtk3 FLAVOR that can be installed alongside the non
flavored package (webkit vs webkit-gtk3).

The library name changed from libwebkit to libwebkit-gtk{1,3}.

thanks to landry@@ and jasper@@ for the tests on powerpc, sparc64 and
amd64.
bulk testing from landry@@

ok jasper@@ landry@@ (maintainer)
@
text
@d1 2
a2 1
$OpenBSD$
d4 4
a7 3
--- Source/JavaScriptCore/wtf/Platform.h.orig	Thu May  5 14:56:12 2011
+++ Source/JavaScriptCore/wtf/Platform.h	Thu May  5 14:57:47 2011
@@@@ -139,9 +139,14 @@@@
d24 1
a24 1
@@@@ -988,7 +993,8 @@@@
@

