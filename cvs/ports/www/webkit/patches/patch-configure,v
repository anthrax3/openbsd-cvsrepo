head	1.25;
access;
symbols
	OPENBSD_6_1:1.25.0.4
	OPENBSD_6_1_BASE:1.25
	OPENBSD_6_0:1.25.0.2
	OPENBSD_6_0_BASE:1.25
	OPENBSD_5_9:1.24.0.2
	OPENBSD_5_9_BASE:1.24
	OPENBSD_5_8:1.24.0.4
	OPENBSD_5_8_BASE:1.24
	OPENBSD_5_7:1.23.0.4
	OPENBSD_5_7_BASE:1.23
	OPENBSD_5_6:1.23.0.2
	OPENBSD_5_6_BASE:1.23
	OPENBSD_5_5:1.21.0.2
	OPENBSD_5_5_BASE:1.21
	OPENBSD_5_4:1.15.0.2
	OPENBSD_5_4_BASE:1.15
	OPENBSD_5_3:1.11.0.2
	OPENBSD_5_3_BASE:1.11
	OPENBSD_5_2:1.10.0.2
	OPENBSD_5_2_BASE:1.10
	OPENBSD_5_1_BASE:1.6
	OPENBSD_5_1:1.6.0.2
	OPENBSD_5_0:1.5.0.2
	OPENBSD_5_0_BASE:1.5
	OPENBSD_4_9:1.2.0.2
	OPENBSD_4_9_BASE:1.2;
locks; strict;
comment	@# @;


1.25
date	2016.03.16.07.10.57;	author ajacoutot;	state Exp;
branches;
next	1.24;
commitid	oPcf1vDRhq4iPuwA;

1.24
date	2015.05.20.15.32.54;	author ajacoutot;	state Exp;
branches
	1.24.2.1;
next	1.23;
commitid	xJOF76FfGW7vXv8h;

1.23
date	2014.07.15.19.58.52;	author espie;	state Exp;
branches;
next	1.22;
commitid	bnoXGhs81iPMuq6R;

1.22
date	2014.03.25.06.25.45;	author landry;	state Exp;
branches;
next	1.21;

1.21
date	2014.01.29.17.28.05;	author ajacoutot;	state Exp;
branches;
next	1.20;

1.20
date	2014.01.28.23.24.42;	author landry;	state Exp;
branches;
next	1.19;

1.19
date	2014.01.27.19.56.20;	author landry;	state Exp;
branches;
next	1.18;

1.18
date	2013.11.14.16.47.00;	author ajacoutot;	state Exp;
branches;
next	1.17;

1.17
date	2013.10.06.14.03.44;	author landry;	state Exp;
branches;
next	1.16;

1.16
date	2013.08.06.19.11.30;	author ajacoutot;	state Exp;
branches;
next	1.15;

1.15
date	2013.06.19.13.24.18;	author ajacoutot;	state Exp;
branches;
next	1.14;

1.14
date	2013.05.31.20.07.33;	author ajacoutot;	state Exp;
branches;
next	1.13;

1.13
date	2013.04.18.11.31.37;	author ajacoutot;	state Exp;
branches;
next	1.12;

1.12
date	2013.04.13.09.11.02;	author landry;	state Exp;
branches;
next	1.11;

1.11
date	2012.08.22.07.48.37;	author landry;	state Exp;
branches;
next	1.10;

1.10
date	2012.04.30.13.31.06;	author landry;	state Exp;
branches;
next	1.9;

1.9
date	2012.04.03.15.41.07;	author landry;	state Exp;
branches;
next	1.8;

1.8
date	2012.04.03.15.39.35;	author landry;	state Exp;
branches;
next	1.7;

1.7
date	2012.02.24.16.36.00;	author landry;	state Exp;
branches;
next	1.6;

1.6
date	2011.10.13.06.52.49;	author jasper;	state Exp;
branches;
next	1.5;

1.5
date	2011.07.05.11.34.27;	author landry;	state Exp;
branches;
next	1.4;

1.4
date	2011.06.17.22.10.40;	author landry;	state Exp;
branches;
next	1.3;

1.3
date	2011.05.11.06.00.08;	author ajacoutot;	state Exp;
branches;
next	1.2;

1.2
date	2010.09.19.20.43.32;	author landry;	state Exp;
branches;
next	1.1;

1.1
date	2010.08.30.13.15.49;	author landry;	state Exp;
branches;
next	;

1.24.2.1
date	2016.03.19.10.33.08;	author ajacoutot;	state Exp;
branches;
next	;
commitid	CO9qkVWh5gncfaCV;


desc
@@


1.25
log
@SECURITY update to webkit-2.4.10.
@
text
@$OpenBSD: patch-configure,v 1.24 2015/05/20 15:32:54 ajacoutot Exp $

- Chunk 1: GNOME Bug 627126 - gsettings schema files don't get installed on FreeBSD
glib commit 136e705e8383ff8848e425ac01278102d7badc52

- Chunk 2 : no librt on OpenBSD
https://bugs.webkit.org/show_bug.cgi?id=129973

- Chunk 3 : Don't force the use of -O2, the ports infrastructure
takes care of that

--- configure.orig	Mon Mar 14 08:37:02 2016
+++ configure	Tue Mar 15 08:11:20 2016
@@@@ -18338,26 +18338,14 @@@@ gsettings__enum_file = $(addsuffix .enums.xml,$(gsetti
 
 all-am: $(gsettings_SCHEMAS:.xml=.valid)
 uninstall-am: uninstall-gsettings-schemas
-install-data-am: install-gsettings-schemas
+install-data-am:
 
 .SECONDARY: $(gsettings_SCHEMAS)
 
-gsettings__base_list = \
-  sed "$$!N;$$!N;$$!N;$$!N;$$!N;$$!N;$$!N;s/\n/ /g" | \
-  sed "$$!N;$$!N;$$!N;$$!N;s/\n/ /g"
-
-install-gsettings-schemas: $(gsettings_SCHEMAS:.xml=.valid) $(gsettings__enum_file)
+install-gsettings-schemas: $(gsettings_SCHEMAS) $(gsettings__enum_file)
 	@@$(NORMAL_INSTALL)
 	test -z "$(gsettingsschemadir)" || $(MKDIR_P) "$(DESTDIR)$(gsettingsschemadir)"
-	@@list='\''$(gsettings__enum_file) $(gsettings_SCHEMAS)'\''; test -n "$(gsettingsschemadir)" || list=; \
-	for p in $$list; do \
-	  if test -f "$$p"; then d=; else d="$(srcdir)/"; fi; \
-	  echo "$$d$$p"; \
-	done | $(gsettings__base_list) | \
-	while read files; do \
-	  echo " $(INSTALL_DATA) $$files '\''$(DESTDIR)$(gsettingsschemadir)'\''"; \
-	  $(INSTALL_DATA) $$files "$(DESTDIR)$(gsettingsschemadir)" || exit $$?; \
-	done
+	$(INSTALL_DATA) $^ "$(DESTDIR)$(gsettingsschemadir)"
 	test -n "$(GSETTINGS_DISABLE_SCHEMAS_COMPILE)$(DESTDIR)" || $(GLIB_COMPILE_SCHEMAS) $(gsettingsschemadir)
 
 uninstall-gsettings-schemas:
@@@@ -21366,7 +21354,7 @@@@ if test "$found_opengl" = "yes"; then
     fi
     if test "$enable_egl" = "yes"; then
         acceleration_description="$acceleration_description, egl"
-        OPENGL_LIBS="$OPENGL_LIBS -lEGL"
+        OPENGL_LIBS="$OPENGL_LIBS -lEGL -lgbm"
     fi
     if test "$enable_glx" = "yes"; then
         acceleration_description="$acceleration_description, glx"
@@@@ -21944,7 +21932,7 @@@@ $as_echo "$ac_cv_search_shm_open" >&6; }
 ac_res=$ac_cv_search_shm_open
 if test "$ac_res" != no; then :
   test "$ac_res" = "none required" || LIBS="$ac_res $LIBS"
-  SHM_LIBS="-lrt"
+  SHM_LIBS=""
 fi
 
 
@@@@ -22640,8 +22628,8 @@@@ fi
 
 # Add the appropriate 'O' level for optimized builds.
 if test "$enable_optimizations" = "yes"; then
-    CXXFLAGS="$CXXFLAGS -O2"
-    CFLAGS="$CFLAGS -O2"
+    CXXFLAGS="$CXXFLAGS"
+    CFLAGS="$CFLAGS"
 
     if test "$c_compiler" = "gcc"; then
         CFLAGS="$CFLAGS -D_FORTIFY_SOURCE=2"
@


1.24
log
@Update to webkit-2.4.9.
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.23 2014/07/15 19:58:52 espie Exp $
d12 3
a14 3
--- configure.orig	Wed May 20 11:29:21 2015
+++ configure	Wed May 20 15:16:37 2015
@@@@ -17665,26 +17665,14 @@@@ gsettings__enum_file = $(addsuffix .enums.xml,$(gsetti
d44 1
a44 1
@@@@ -20693,7 +20681,7 @@@@ if test "$found_opengl" = "yes"; then
d53 1
a53 1
@@@@ -21271,7 +21259,7 @@@@ $as_echo "$ac_cv_search_shm_open" >&6; }
d62 1
a62 1
@@@@ -21967,8 +21955,8 @@@@ fi
@


1.24.2.1
log
@SECURITY update to WebKitGTK+ 2.4.10.

CVE-2015-1120, CVE-2015-1076, CVE-2015-1071, CVE-2015-1081, CVE-2015-1122,
CVE-2015-1155, CVE-2014-1748, CVE-2015-3752, CVE-2015-5809, CVE-2015-5928,
CVE-2015-3749, CVE-2015-3659, CVE-2015-3748, CVE-2015-3743, CVE-2015-3731,
CVE-2015-3745, CVE-2015-5822, CVE-2015-3658, CVE-2015-3741, CVE-2015-3727,
CVE-2015-5801, CVE-2015-5788, CVE-2015-3747, CVE-2015-5794, CVE-2015-1127,
CVE-2015-1153, CVE-2015-1083
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.24 2015/05/20 15:32:54 ajacoutot Exp $
d12 3
a14 3
--- configure.orig	Mon Mar 14 08:37:02 2016
+++ configure	Tue Mar 15 08:11:20 2016
@@@@ -18338,26 +18338,14 @@@@ gsettings__enum_file = $(addsuffix .enums.xml,$(gsetti
d44 1
a44 1
@@@@ -21366,7 +21354,7 @@@@ if test "$found_opengl" = "yes"; then
d53 1
a53 1
@@@@ -21944,7 +21932,7 @@@@ $as_echo "$ac_cv_search_shm_open" >&6; }
d62 1
a62 1
@@@@ -22640,8 +22628,8 @@@@ fi
@


1.23
log
@webkit doesn't use pkgconfig for EGL, so explicitly link the extra library
for now. This fixes the build and unlocks at least 100 other ports.
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.22 2014/03/25 06:25:45 landry Exp $
d12 3
a14 3
--- configure.orig	Mon May 26 09:48:45 2014
+++ configure	Tue Jul 15 16:11:41 2014
@@@@ -17659,26 +17659,14 @@@@ gsettings__enum_file = $(addsuffix .enums.xml,$(gsetti
d44 1
a44 1
@@@@ -20588,7 +20576,7 @@@@ if test "$found_opengl" = "yes"; then
d53 1
a53 1
@@@@ -21164,7 +21152,7 @@@@ $as_echo "$ac_cv_search_shm_open" >&6; }
d62 1
a62 1
@@@@ -21860,8 +21848,8 @@@@ fi
@


1.22
log
@Update to webkit 2.4.0.

See http://webkitgtk.org/2014/03/24/webkitgtk2.4.0-released.html. Note
that Webkit2 API is still broken, on OpenBSD(and FreeBSD) and this might
be the last release shipping the Webkit1 API.
Pass -DLOG_DISABLED=0 to CPPFLAGS to somewhat allow debugging.
Use the same ruby version on sparc64 as other archs now that they're
more reliable.

Remove some patches merged upstream, and add links to upstream bz for
most of the remaining patches.

Note: this needs gnu/usr.bin/binutils/include/opcode/i386.h r1.15 to
build. And gcc 4.8 (and python, ruby & perl :)
Built numerous times on amd64/ppc/sparc64 (broken at runtime on the last
two, but that's not a regression from 2.2..) and went in a bunch of
bulks.
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.21 2014/01/29 17:28:05 ajacoutot Exp $
d12 2
a13 2
--- configure.orig	Mon Mar 17 09:11:58 2014
+++ configure	Tue Mar 18 07:58:48 2014
d44 9
@


1.21
log
@Re-update to webkit-2.2.4 with a fix for our pre-historical bison(1).
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.20 2014/01/28 23:24:42 landry Exp $
d3 2
a4 6
https://bugs.webkit.org/show_bug.cgi?id=117796

- Chunk 1, 2 & 4 : https://bugs.webkit.org/show_bug.cgi?id=109932
Only webkit2 requires c++11 features atm, so let's relax the check until we have webkit2

- Chunk 5 : no librt on OpenBSD
d6 2
a7 2
- Chunk 3 : GNOME Bug 627126 - gsettings schema files don't get installed on FreeBSD
glib commit 136e705e8383ff8848e425ac01278102d7badc52
d9 1
a9 1
- Chunk 6 : Don't force the use of -O2, the ports infrastructure
d12 3
a14 21
--- configure.orig	Tue Jan 21 12:09:55 2014
+++ configure	Mon Jan 27 10:18:44 2014
@@@@ -4790,7 +4790,7 @@@@ ac_compiler_gnu=$ac_cv_c_compiler_gnu
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
-#if !(defined(__GNUC__) && !defined(__clang__) && !defined(__INTEL_COMPILER) && __GNUC__ >= 4 && __GNUC_MINOR__ >= 7)
+#if !(defined(__GNUC__) && !defined(__clang__) && !defined(__INTEL_COMPILER) && __GNUC__ >= 4 && __GNUC_MINOR__ >= 2)
 #error Not a supported GCC compiler
 #endif
 
@@@@ -4848,7 +4848,7 @@@@ ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
-#if !(defined(__GNUG__) && defined(__GNUC__) && !defined(__clang__) && !defined(__INTEL_COMPILER) && __GNUC__ >= 4 && __GNUC_MINOR__ >= 7)
+#if !(defined(__GNUG__) && defined(__GNUC__) && !defined(__clang__) && !defined(__INTEL_COMPILER) && __GNUC__ >= 4 && __GNUC_MINOR__ >= 2)
 #error Not a supported G++ compiler
 #endif
 
@@@@ -17606,26 +17606,14 @@@@ gsettings__enum_file = $(addsuffix .enums.xml,$(gsetti
d44 1
a44 1
@@@@ -20951,7 +20939,7 @@@@ $as_echo "$ac_cv_search_shm_open" >&6; }
d53 1
a53 10
@@@@ -21383,7 +21371,7 @@@@ fi
 # Use C99 as the language standard for C code.
 CFLAGS="$CFLAGS -pthread -std=c99"
 # Use the C++11 standard. Do not warn about C++11 incompatibilities.
-CXXFLAGS="$CXXFLAGS -pthread -std=c++11 -Wno-c++11-compat"
+#CXXFLAGS="$CXXFLAGS -pthread -std=c++11 -Wno-c++11-compat"
 
 # Clang requires suppression of unused arguments warnings.
 if test "$c_compiler" = "clang"; then
@@@@ -21420,8 +21408,8 @@@@ fi
d61 3
a63 3
 else
     CXXFLAGS="$CXXFLAGS -O0"
     CFLAGS="$CFLAGS -O0"
@


1.20
log
@Revert previous and bump EPOCH, seems this now requires a newer bison,
which i didnt spot since i had an update on my box.
Noticed by nigel@@, thanks!
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.19 2014/01/27 19:56:20 landry Exp $
d16 2
a17 2
--- configure.orig	Mon Nov 11 11:56:17 2013
+++ configure	Thu Nov 14 09:38:51 2013
d36 1
a36 1
@@@@ -17609,26 +17609,14 @@@@ gsettings__enum_file = $(addsuffix .enums.xml,$(gsetti
d66 1
a66 1
@@@@ -20954,7 +20942,7 @@@@ $as_echo "$ac_cv_search_shm_open" >&6; }
d75 1
a75 1
@@@@ -21386,7 +21374,7 @@@@ fi
d84 1
a84 1
@@@@ -21423,8 +21411,8 @@@@ fi
@


1.19
log
@Bugfix update to webkit 2.2.4.

http://webkitgtk.org/2014/01/21/webkitgtk2.2.4-released.html
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.18 2013/11/14 16:47:00 ajacoutot Exp $
d16 2
a17 2
--- configure.orig	Tue Jan 21 12:09:55 2014
+++ configure	Mon Jan 27 10:18:44 2014
d36 1
a36 1
@@@@ -17606,26 +17606,14 @@@@ gsettings__enum_file = $(addsuffix .enums.xml,$(gsetti
d66 1
a66 1
@@@@ -20951,7 +20939,7 @@@@ $as_echo "$ac_cv_search_shm_open" >&6; }
d75 1
a75 1
@@@@ -21383,7 +21371,7 @@@@ fi
d84 1
a84 1
@@@@ -21420,8 +21408,8 @@@@ fi
@


1.18
log
@Update to webkit-2.2.2.

ok landry@@
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.17 2013/10/06 14:03:44 landry Exp $
d16 2
a17 2
--- configure.orig	Mon Nov 11 11:56:17 2013
+++ configure	Thu Nov 14 09:38:51 2013
d36 1
a36 1
@@@@ -17609,26 +17609,14 @@@@ gsettings__enum_file = $(addsuffix .enums.xml,$(gsetti
d66 1
a66 1
@@@@ -20954,7 +20942,7 @@@@ $as_echo "$ac_cv_search_shm_open" >&6; }
d75 1
a75 1
@@@@ -21386,7 +21374,7 @@@@ fi
d84 1
a84 1
@@@@ -21423,8 +21411,8 @@@@ fi
@


1.17
log
@Update to webkit 2.2.0.

- Now depends on newer gcc, use 4.6 by default.
- Enable webkit2 api in the gtk3 FLAVOR. Still broken/erratic behaviour at
  runtime, but at least this will allow people to debug it, and it's
  required by newer GNOMEs anyway. Provide MiniBrowser for debugging purposes.
- add hack from bug #118732 to workaround the fact that our binutils
  doesnt support 'ar T'
- update patches from #103128 to tentatively fix powerpc runtime
- force-disable YARR_JIT & ASSEMBLE on archs without JIT (ie anything
  besides i386/amd64) via Platform.h patch instead of JSC_CPPFLAGS (which
  doesnt work anymore anyway)
- add a bunch of patches to fix build (missing includes etc) in the WebKit2
  source tree

Tested in an amd64 bulk build, runtime-tested previous betas on
i386/amd64, test-built on powerpc and sparc64. Things might still be
broken at runtime on powerpc, but at least it allows more GNOME things
to be updated.
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.16 2013/08/06 19:11:30 ajacoutot Exp $
d16 3
a18 3
--- configure.orig	Fri Sep 27 11:19:49 2013
+++ configure	Thu Oct  3 21:19:34 2013
@@@@ -4789,7 +4789,7 @@@@ ac_compiler_gnu=$ac_cv_c_compiler_gnu
d27 1
a27 1
@@@@ -4847,7 +4847,7 @@@@ ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
d36 1
a36 1
@@@@ -17608,26 +17608,14 @@@@ gsettings__enum_file = $(addsuffix .enums.xml,$(gsetti
d66 1
a66 1
@@@@ -20953,7 +20941,7 @@@@ $as_echo "$ac_cv_search_shm_open" >&6; }
d75 1
a75 1
@@@@ -21368,7 +21356,7 @@@@ fi
d84 1
a84 1
@@@@ -21405,8 +21393,8 @@@@ fi
@


1.16
log
@Update to webkit 2.0.4.

OK landry@@ (maintainer)
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.15 2013/06/19 13:24:18 ajacoutot Exp $
d5 1
a5 1
- Chunk 1, 2 & 6 : https://bugs.webkit.org/show_bug.cgi?id=109932
d8 2
d13 1
a13 1
- Chunk 7 : Don't force the use of -O2, the ports infrastructure
d16 3
a18 3
--- configure.orig	Fri Jul 19 14:11:39 2013
+++ configure	Sat Jul 20 18:29:22 2013
@@@@ -4729,7 +4729,7 @@@@ ac_compiler_gnu=$ac_cv_c_compiler_gnu
d22 3
a24 4
-#if !(defined(__GNUC__) && !defined(__clang__) && !defined(__INTEL_COMPILER) && __GNUC__ >= 4 && __GNUC_MINOR__ >= 7) \
+#if !(defined(__GNUC__) && !defined(__clang__) && !defined(__INTEL_COMPILER) && __GNUC__ >= 4 && __GNUC_MINOR__ >= 2) \
     && !(defined(__clang__) && __clang_major__ >= 3 && __clang_minor__ >= 0)
 #error Unsupported compiler
d26 2
a27 1
@@@@ -4766,7 +4766,7 @@@@ ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
d31 3
a33 4
-#if !(defined(__GNUG__) && defined(__GNUC__) && !defined(__clang__) && !defined(__INTEL_COMPILER) && __GNUC__ >= 4 && __GNUC_MINOR__ >= 7) \
+#if !(defined(__GNUG__) && defined(__GNUC__) && !defined(__clang__) && !defined(__INTEL_COMPILER) && __GNUC__ >= 4 && __GNUC_MINOR__ >= 2) \
     && !(defined(__clang__) && __clang_major__ >= 3 && __clang_minor__ >= 0)
 #error Unsupported compiler
d35 2
a36 1
@@@@ -17503,26 +17503,14 @@@@ gsettings__enum_file = $(addsuffix .enums.xml,$(gsetti
d66 6
a71 34
@@@@ -19456,12 +19444,12 @@@@ if test -n "$HARFBUZZ_ICU_CFLAGS"; then
     pkg_cv_HARFBUZZ_ICU_CFLAGS="$HARFBUZZ_ICU_CFLAGS"
  elif test -n "$PKG_CONFIG"; then
     if test -n "$PKG_CONFIG" && \
-    { { $as_echo "$as_me:${as_lineno-$LINENO}: \$PKG_CONFIG --exists --print-errors \"harfbuzz-icu >= \$0.9.7\""; } >&5
-  ($PKG_CONFIG --exists --print-errors "harfbuzz-icu >= $0.9.7") 2>&5
+    { { $as_echo "$as_me:${as_lineno-$LINENO}: \$PKG_CONFIG --exists --print-errors \"harfbuzz-icu >= \0.9.7\""; } >&5
+  ($PKG_CONFIG --exists --print-errors "harfbuzz-icu >= 0.9.7") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
-  pkg_cv_HARFBUZZ_ICU_CFLAGS=`$PKG_CONFIG --cflags "harfbuzz-icu >= $0.9.7" 2>/dev/null`
+  pkg_cv_HARFBUZZ_ICU_CFLAGS=`$PKG_CONFIG --cflags "harfbuzz-icu >= 0.9.7" 2>/dev/null`
 		      test "x$?" != "x0" && pkg_failed=yes
 else
   pkg_failed=yes
@@@@ -19473,12 +19461,12 @@@@ if test -n "$HARFBUZZ_ICU_LIBS"; then
     pkg_cv_HARFBUZZ_ICU_LIBS="$HARFBUZZ_ICU_LIBS"
  elif test -n "$PKG_CONFIG"; then
     if test -n "$PKG_CONFIG" && \
-    { { $as_echo "$as_me:${as_lineno-$LINENO}: \$PKG_CONFIG --exists --print-errors \"harfbuzz-icu >= \$0.9.7\""; } >&5
-  ($PKG_CONFIG --exists --print-errors "harfbuzz-icu >= $0.9.7") 2>&5
+    { { $as_echo "$as_me:${as_lineno-$LINENO}: \$PKG_CONFIG --exists --print-errors \"harfbuzz-icu >= \0.9.7\""; } >&5
+  ($PKG_CONFIG --exists --print-errors "harfbuzz-icu >= 0.9.7") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
-  pkg_cv_HARFBUZZ_ICU_LIBS=`$PKG_CONFIG --libs "harfbuzz-icu >= $0.9.7" 2>/dev/null`
+  pkg_cv_HARFBUZZ_ICU_LIBS=`$PKG_CONFIG --libs "harfbuzz-icu >= 0.9.7" 2>/dev/null`
 		      test "x$?" != "x0" && pkg_failed=yes
 else
   pkg_failed=yes
@@@@ -19499,14 +19487,14 @@@@ else
         _pkg_short_errors_supported=no
a72 12
         if test $_pkg_short_errors_supported = yes; then
-	        HARFBUZZ_ICU_PKG_ERRORS=`$PKG_CONFIG --short-errors --print-errors --cflags --libs "harfbuzz-icu >= $0.9.7" 2>&1`
+	        HARFBUZZ_ICU_PKG_ERRORS=`$PKG_CONFIG --short-errors --print-errors --cflags --libs "harfbuzz-icu >= 0.9.7" 2>&1`
         else
-	        HARFBUZZ_ICU_PKG_ERRORS=`$PKG_CONFIG --print-errors --cflags --libs "harfbuzz-icu >= $0.9.7" 2>&1`
+	        HARFBUZZ_ICU_PKG_ERRORS=`$PKG_CONFIG --print-errors --cflags --libs "harfbuzz-icu >= 0.9.7" 2>&1`
         fi
 	# Put the nasty error message in config.log where it belongs
 	echo "$HARFBUZZ_ICU_PKG_ERRORS" >&5
 
-	as_fn_error $? "Package requirements (harfbuzz-icu >= $0.9.7) were not met:
+	as_fn_error $? "Package requirements (harfbuzz-icu >= 0.9.7) were not met:
a73 1
 $HARFBUZZ_ICU_PKG_ERRORS
d75 1
a75 1
@@@@ -21160,7 +21148,7 @@@@ fi
d77 8
a84 8
 CFLAGS="$CFLAGS -std=c99"
 # Do not warn about C++11 incompatibilities.
-CXXFLAGS="$CXXFLAGS -Wno-c++11-compat"
+# CXXFLAGS="$CXXFLAGS -Wno-c++11-compat"
 
 # Clang requires suppression of unused arguments warning.
 if test "$CC" = "clang"; then
@@@@ -21188,8 +21176,8 @@@@ fi
@


1.15
log
@Update to webkit-2.0.3.

ok landry@@ (maintainer)
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.14 2013/05/31 20:07:33 ajacoutot Exp $
d14 2
a15 2
--- configure.orig	Tue Jun 11 12:47:07 2013
+++ configure	Tue Jun 18 15:42:59 2013
a112 46
 
@@@@ -19538,8 +19526,8 @@@@ else
 $as_echo "yes" >&6; }
 
 fi
-    FREETYPE_CFLAGS+=" $HARFBUZZ_ICU_CFLAGS"
-    FREETYPE_LIBS+=" $HARFBUZZ_ICU_LIBS"
+    FREETYPE_CFLAGS="$FREETYPE_CFLAGS $HARFBUZZ_ICU_CFLAGS"
+    FREETYPE_LIBS="$FREETYPE_LIBS $HARFBUZZ_ICU_LIBS"
 fi
 
 
@@@@ -20341,18 +20329,18 @@@@ fi
 
 if test "$with_acceleration_backend" = "opengl"; then
     if test "$enable_gles2" = "yes"; then
-        acceleration_backend_description+= "(gles2"
+        acceleration_backend_description= "(gles2"
         OPENGL_LIBS="-lGLESv2"
     else
-        acceleration_backend_description+="(gl"
+        acceleration_backend_description="(gl"
         OPENGL_LIBS="-lGL"
     fi
     if test "$enable_egl" = "yes"; then
-        acceleration_backend_description+=", egl"
-        OPENGL_LIBS+=" -lEGL"
+        acceleration_backend_description="$acceleration_backend_description, egl"
+        OPENGL_LIBS="$OPENGL_LIBS -lEGL"
     fi
     if test "$enable_glx" = "yes"; then
-        acceleration_backend_description+=", glx"
+        acceleration_backend_description="$acceleration_backend_description, glx"
     fi
 
     # Check whether dlopen() is in the core libc like on FreeBSD, or in a separate
@@@@ -20405,8 +20393,8 @@@@ fi
 
 
 
-    OPENGL_LIBS+=" $DLOPEN_LIBS"
-    acceleration_backend_description+=")"
+    OPENGL_LIBS="$OPENGL_LIBS $DLOPEN_LIBS"
+    acceleration_backend_description="$acceleration_backend_description)"
 fi
 
@


1.14
log
@Needs to depend on devel/harfbuzz,-icu now.
@
text
@d1 3
a3 1
$OpenBSD: patch-configure,v 1.13 2013/04/18 11:31:37 ajacoutot Exp $
d14 3
a16 5
http://trac.webkit.org/changeset/150963

--- configure.orig	Mon May 13 11:43:56 2013
+++ configure	Fri May 31 16:38:55 2013
@@@@ -4721,7 +4721,7 @@@@ ac_compiler_gnu=$ac_cv_c_compiler_gnu
d25 1
a25 1
@@@@ -4758,7 +4758,7 @@@@ ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
d34 1
a34 1
@@@@ -17495,26 +17495,14 @@@@ gsettings__enum_file = $(addsuffix .enums.xml,$(gsetti
d64 2
a65 2
@@@@ -19261,12 +19249,12 @@@@ if test -n "$FREETYPE_CFLAGS"; then
     pkg_cv_FREETYPE_CFLAGS="$FREETYPE_CFLAGS"
d68 4
a71 4
-    { { $as_echo "$as_me:${as_lineno-$LINENO}: \$PKG_CONFIG --exists --print-errors \"fontconfig >= 2.5 freetype2 >= 9.0 harfbuzz >= 0.9.7\""; } >&5
-  ($PKG_CONFIG --exists --print-errors "fontconfig >= 2.5 freetype2 >= 9.0 harfbuzz >= 0.9.7") 2>&5
+    { { $as_echo "$as_me:${as_lineno-$LINENO}: \$PKG_CONFIG --exists --print-errors \"fontconfig >= 2.5 freetype2 >= 9.0 harfbuzz >= 0.9.7 harfbuzz-icu >= 0.9.7\""; } >&5
+  ($PKG_CONFIG --exists --print-errors "fontconfig >= 2.5 freetype2 >= 9.0 harfbuzz >= 0.9.7 harfbuzz-icu >= 0.9.7") 2>&5
d75 2
a76 2
-  pkg_cv_FREETYPE_CFLAGS=`$PKG_CONFIG --cflags "fontconfig >= 2.5 freetype2 >= 9.0 harfbuzz >= 0.9.7" 2>/dev/null`
+  pkg_cv_FREETYPE_CFLAGS=`$PKG_CONFIG --cflags "fontconfig >= 2.5 freetype2 >= 9.0 harfbuzz >= 0.9.7 harfbuzz-icu >= 0.9.7" 2>/dev/null`
d80 2
a81 2
@@@@ -19278,12 +19266,12 @@@@ if test -n "$FREETYPE_LIBS"; then
     pkg_cv_FREETYPE_LIBS="$FREETYPE_LIBS"
d84 4
a87 4
-    { { $as_echo "$as_me:${as_lineno-$LINENO}: \$PKG_CONFIG --exists --print-errors \"fontconfig >= 2.5 freetype2 >= 9.0 harfbuzz >= 0.9.7\""; } >&5
-  ($PKG_CONFIG --exists --print-errors "fontconfig >= 2.5 freetype2 >= 9.0 harfbuzz >= 0.9.7") 2>&5
+    { { $as_echo "$as_me:${as_lineno-$LINENO}: \$PKG_CONFIG --exists --print-errors \"fontconfig >= 2.5 freetype2 >= 9.0 harfbuzz >= 0.9.7 harfbuzz-icu >= 0.9.7\""; } >&5
+  ($PKG_CONFIG --exists --print-errors "fontconfig >= 2.5 freetype2 >= 9.0 harfbuzz >= 0.9.7 harfbuzz-icu >= 0.9.7") 2>&5
d91 2
a92 2
-  pkg_cv_FREETYPE_LIBS=`$PKG_CONFIG --libs "fontconfig >= 2.5 freetype2 >= 9.0 harfbuzz >= 0.9.7" 2>/dev/null`
+  pkg_cv_FREETYPE_LIBS=`$PKG_CONFIG --libs "fontconfig >= 2.5 freetype2 >= 9.0 harfbuzz >= 0.9.7 harfbuzz-icu >= 0.9.7" 2>/dev/null`
d96 1
a96 1
@@@@ -19304,14 +19292,14 @@@@ else
d100 2
a101 2
-	        FREETYPE_PKG_ERRORS=`$PKG_CONFIG --short-errors --print-errors --cflags --libs "fontconfig >= 2.5 freetype2 >= 9.0 harfbuzz >= 0.9.7" 2>&1`
+	        FREETYPE_PKG_ERRORS=`$PKG_CONFIG --short-errors --print-errors --cflags --libs "fontconfig >= 2.5 freetype2 >= 9.0 harfbuzz >= 0.9.7 harfbuzz-icu >= 0.9.7" 2>&1`
d103 2
a104 2
-	        FREETYPE_PKG_ERRORS=`$PKG_CONFIG --print-errors --cflags --libs "fontconfig >= 2.5 freetype2 >= 9.0 harfbuzz >= 0.9.7" 2>&1`
+	        FREETYPE_PKG_ERRORS=`$PKG_CONFIG --print-errors --cflags --libs "fontconfig >= 2.5 freetype2 >= 9.0 harfbuzz >= 0.9.7 harfbuzz-icu >= 0.9.7" 2>&1`
d107 1
a107 1
 	echo "$FREETYPE_PKG_ERRORS" >&5
d109 2
a110 2
-	as_fn_error $? "Package requirements (fontconfig >= 2.5 freetype2 >= 9.0 harfbuzz >= 0.9.7) were not met:
+	as_fn_error $? "Package requirements (fontconfig >= 2.5 freetype2 >= 9.0 harfbuzz >= 0.9.7 harfbuzz-icu >= 0.9.7) were not met:
d112 1
a112 1
 $FREETYPE_PKG_ERRORS
d114 8
a121 34
@@@@ -19353,12 +19341,12 @@@@ if test -n "$FREETYPE_CFLAGS"; then
     pkg_cv_FREETYPE_CFLAGS="$FREETYPE_CFLAGS"
  elif test -n "$PKG_CONFIG"; then
     if test -n "$PKG_CONFIG" && \
-    { { $as_echo "$as_me:${as_lineno-$LINENO}: \$PKG_CONFIG --exists --print-errors \"cairo-ft fontconfig >= 2.5 freetype2 >= 9.0 harfbuzz >= 0.9.7\""; } >&5
-  ($PKG_CONFIG --exists --print-errors "cairo-ft fontconfig >= 2.5 freetype2 >= 9.0 harfbuzz >= 0.9.7") 2>&5
+    { { $as_echo "$as_me:${as_lineno-$LINENO}: \$PKG_CONFIG --exists --print-errors \"cairo-ft fontconfig >= 2.5 freetype2 >= 9.0 harfbuzz >= 0.9.7 harfbuzz-icu >= 0.9.7\""; } >&5
+  ($PKG_CONFIG --exists --print-errors "cairo-ft fontconfig >= 2.5 freetype2 >= 9.0 harfbuzz >= 0.9.7 harfbuzz-icu >= 0.9.7") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
-  pkg_cv_FREETYPE_CFLAGS=`$PKG_CONFIG --cflags "cairo-ft fontconfig >= 2.5 freetype2 >= 9.0 harfbuzz >= 0.9.7" 2>/dev/null`
+  pkg_cv_FREETYPE_CFLAGS=`$PKG_CONFIG --cflags "cairo-ft fontconfig >= 2.5 freetype2 >= 9.0 harfbuzz >= 0.9.7 harfbuzz-icu >= 0.9.7" 2>/dev/null`
 		      test "x$?" != "x0" && pkg_failed=yes
 else
   pkg_failed=yes
@@@@ -19370,12 +19358,12 @@@@ if test -n "$FREETYPE_LIBS"; then
     pkg_cv_FREETYPE_LIBS="$FREETYPE_LIBS"
  elif test -n "$PKG_CONFIG"; then
     if test -n "$PKG_CONFIG" && \
-    { { $as_echo "$as_me:${as_lineno-$LINENO}: \$PKG_CONFIG --exists --print-errors \"cairo-ft fontconfig >= 2.5 freetype2 >= 9.0 harfbuzz >= 0.9.7\""; } >&5
-  ($PKG_CONFIG --exists --print-errors "cairo-ft fontconfig >= 2.5 freetype2 >= 9.0 harfbuzz >= 0.9.7") 2>&5
+    { { $as_echo "$as_me:${as_lineno-$LINENO}: \$PKG_CONFIG --exists --print-errors \"cairo-ft fontconfig >= 2.5 freetype2 >= 9.0 harfbuzz >= 0.9.7 harfbuzz-icu >= 0.9.7\""; } >&5
+  ($PKG_CONFIG --exists --print-errors "cairo-ft fontconfig >= 2.5 freetype2 >= 9.0 harfbuzz >= 0.9.7 harfbuzz-icu >= 0.9.7") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
-  pkg_cv_FREETYPE_LIBS=`$PKG_CONFIG --libs "cairo-ft fontconfig >= 2.5 freetype2 >= 9.0 harfbuzz >= 0.9.7" 2>/dev/null`
+  pkg_cv_FREETYPE_LIBS=`$PKG_CONFIG --libs "cairo-ft fontconfig >= 2.5 freetype2 >= 9.0 harfbuzz >= 0.9.7 harfbuzz-icu >= 0.9.7" 2>/dev/null`
 		      test "x$?" != "x0" && pkg_failed=yes
 else
   pkg_failed=yes
@@@@ -19396,14 +19384,14 @@@@ else
         _pkg_short_errors_supported=no
a122 12
         if test $_pkg_short_errors_supported = yes; then
-	        FREETYPE_PKG_ERRORS=`$PKG_CONFIG --short-errors --print-errors --cflags --libs "cairo-ft fontconfig >= 2.5 freetype2 >= 9.0 harfbuzz >= 0.9.7" 2>&1`
+	        FREETYPE_PKG_ERRORS=`$PKG_CONFIG --short-errors --print-errors --cflags --libs "cairo-ft fontconfig >= 2.5 freetype2 >= 9.0 harfbuzz >= 0.9.7 harfbuzz-icu >= 0.9.7" 2>&1`
         else
-	        FREETYPE_PKG_ERRORS=`$PKG_CONFIG --print-errors --cflags --libs "cairo-ft fontconfig >= 2.5 freetype2 >= 9.0 harfbuzz >= 0.9.7" 2>&1`
+	        FREETYPE_PKG_ERRORS=`$PKG_CONFIG --print-errors --cflags --libs "cairo-ft fontconfig >= 2.5 freetype2 >= 9.0 harfbuzz >= 0.9.7 harfbuzz-icu >= 0.9.7" 2>&1`
         fi
 	# Put the nasty error message in config.log where it belongs
 	echo "$FREETYPE_PKG_ERRORS" >&5
 
-	as_fn_error $? "Package requirements (cairo-ft fontconfig >= 2.5 freetype2 >= 9.0 harfbuzz >= 0.9.7) were not met:
+	as_fn_error $? "Package requirements (cairo-ft fontconfig >= 2.5 freetype2 >= 9.0 harfbuzz >= 0.9.7 harfbuzz-icu >= 0.9.7) were not met:
a123 1
 $FREETYPE_PKG_ERRORS
d125 1
a125 1
@@@@ -20236,18 +20224,18 @@@@ fi
d149 1
a149 1
@@@@ -20300,8 +20288,8 @@@@ fi
d160 1
a160 1
@@@@ -21055,7 +21043,7 @@@@ fi
d169 1
a169 1
@@@@ -21083,8 +21071,8 @@@@ fi
@


1.13
log
@Update to webkit-2.0.1.

ok landry@@ (maintainer)
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.12 2013/04/13 09:11:02 landry Exp $
d12 4
a15 2
--- configure.orig	Tue Apr 16 09:13:13 2013
+++ configure	Thu Apr 18 08:10:25 2013
d64 100
@


1.12
log
@Major update to webkit 2.0.0.

- add ruby to BDEPS. Webkit build system now uses autohell, python, ruby and perl \o/
- set MODRUBY_REV = 1.8 on sparc64 since 1.9 is broken there
- disable WebKit2 support, it needs shm_open()/shm_unlink()
- switch from gstreamer-0.10 to gstreamer1
- force-disable JIT/ASSEMBLER on non-jit archs, builds fails otherwise (bug #113638)
- only build NumberPrototype.cpp with -O0 on sparc64, not the damn whole thing
- use -Wl,--relax on ppc otherwise linking fails
- move some patches around since JavaScriptCore/wtf moved to WTF/wtf
- dont uselessly rerun make within make during install, gmake blows
- blindly backport upstream r144077 to fix mips64 build
- backport bits of #103128 & r145551 to fix powerpc build
- backport r147967 & more to fix bashisms in configure
- bug #109932 forced the use of gcc >= 4.7 or clang >= 3.0, but this is
  only for WebKit2 so loosen the check atm

Tested working fine on amd64 & i386, went in bulk builds, known broken
at runtime on ppc (being worked on. or not.) should build on mips64el
(and maybe even run!) and sparc64 (wont run! ever! nothing new here..),
but 'someone' will care about the poor exotic archs and fix'em, right ?

After too much prodding from the gnome maintainers who desperately need it
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.11 2012/08/22 07:48:37 landry Exp $
a8 3
- Chunk 4 & 5 & 8 : fix bashisms
https://bugs.webkit.org/show_bug.cgi?id=113349

d12 3
a14 4
- Chunk 9 : use MODPY_BIN when calling the generator
--- configure.orig	Tue Mar 26 20:46:03 2013
+++ configure	Thu Apr 11 19:46:57 2013
@@@@ -4717,7 +4717,7 @@@@ ac_compiler_gnu=$ac_cv_c_compiler_gnu
d23 1
a23 1
@@@@ -4754,7 +4754,7 @@@@ ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
d32 1
a32 1
@@@@ -17479,26 +17479,14 @@@@ gsettings__enum_file = $(addsuffix .enums.xml,$(gsetti
d62 1
a62 1
@@@@ -20218,18 +20206,18 @@@@ fi
d86 1
a86 1
@@@@ -20282,8 +20270,8 @@@@ fi
d97 1
a97 1
@@@@ -21037,7 +21025,7 @@@@ fi
d106 1
a106 1
@@@@ -21065,8 +21053,8 @@@@ fi
a116 204
@@@@ -21336,100 +21324,100 @@@@ fi
 # This list of features represents those selected for release builds.
 # If you are adding a new or unstable feature, you should mark it
 # disabled here.
-read -d '' DEFAULT_FEATURE_DEFINES <<"EOF"
-	ENABLE_ACCELERATED_2D_CANVAS=0
-	ENABLE_BATTERY_STATUS=0
-	ENABLE_BLOB=1
-	ENABLE_CANVAS_PATH=0
-	ENABLE_CANVAS_PROXY=0
-	ENABLE_CHANNEL_MESSAGING=1
-	ENABLE_CSP_NEXT=0
-	ENABLE_CSS3_TEXT=0
-	ENABLE_CSS_BOX_DECORATION_BREAK=1
-	ENABLE_CSS_COMPOSITING=0
-	ENABLE_CSS_DEVICE_ADAPTATION=0
-	ENABLE_CSS_EXCLUSIONS=1
-	ENABLE_CSS_IMAGE_ORIENTATION=0
-	ENABLE_CSS_IMAGE_RESOLUTION=0
-	ENABLE_CSS_IMAGE_SET=0
-	ENABLE_CSS_REGIONS=0
-	ENABLE_CSS_STICKY_POSITION=0
-	ENABLE_CSS_TRANSFORMS_ANIMATIONS_UNPREFIXED=0
-	ENABLE_CSS_VARIABLES=0
-	ENABLE_CSS3_CONDITIONAL_RULES=0
-	ENABLE_CUSTOM_SCHEME_HANDLER=0
-	ENABLE_DASHBOARD_SUPPORT=0
-	ENABLE_DATALIST_ELEMENT=0
-	ENABLE_DATA_TRANSFER_ITEMS=0
-	ENABLE_DETAILS_ELEMENT=1
-	ENABLE_DEVICE_ORIENTATION=0
-	ENABLE_DIALOG_ELEMENT=0
-	ENABLE_DIRECTORY_UPLOAD=0
-	ENABLE_DOM4_EVENTS_CONSTRUCTOR=0
-	ENABLE_DOWNLOAD_ATTRIBUTE=0
-	ENABLE_FILE_SYSTEM=0
-	ENABLE_FILTERS=1
-	ENABLE_FTPDIR=0
-	ENABLE_FULLSCREEN_API=1
-	ENABLE_HIGH_DPI_CANVAS=0
-	ENABLE_ICONDATABASE=1
-	ENABLE_IFRAME_SEAMLESS=1
-	ENABLE_INDEXED_DATABASE=0
-	ENABLE_INPUT_SPEECH=0
-	ENABLE_INPUT_TYPE_COLOR=0
-	ENABLE_INPUT_TYPE_DATE=0
-	ENABLE_INPUT_TYPE_DATETIME=0
-	ENABLE_INPUT_TYPE_DATETIMELOCAL=0
-	ENABLE_INPUT_TYPE_MONTH=0
-	ENABLE_INPUT_TYPE_TIME=0
-	ENABLE_INPUT_TYPE_WEEK=0
-	ENABLE_INSPECTOR=1
-	ENABLE_JAVASCRIPT_DEBUGGER=1
-	ENABLE_LEGACY_CSS_VENDOR_PREFIXES=0
-	ENABLE_LEGACY_NOTIFICATIONS=0
-	ENABLE_LEGACY_VENDOR_PREFIXES=1
-	ENABLE_LEGACY_WEB_AUDIO=0
-	ENABLE_LINK_PREFETCH=0
-	ENABLE_LINK_PRERENDER=0
-	ENABLE_MATHML=0
-	ENABLE_MEDIA_CAPTURE=0
-	ENABLE_MEDIA_SOURCE=0
-	ENABLE_MEDIA_STATISTICS=0
-	ENABLE_MEDIA_STREAM=0
-	ENABLE_METER_ELEMENT=1
-	ENABLE_MHTML=1
-	ENABLE_MICRODATA=0
-	ENABLE_MOUSE_CURSOR_SCALE=0
-	ENABLE_NAVIGATOR_CONTENT_UTILS=0
-	ENABLE_NETSCAPE_PLUGIN_API=1
-	ENABLE_NETWORK_INFO=0
-	ENABLE_NOTIFICATIONS=0
-	ENABLE_ORIENTATION_EVENTS=0
-	ENABLE_PAGE_VISIBILITY_API=0
-	ENABLE_PERFORMANCE_TIMELINE=0
-	ENABLE_PROGRESS_ELEMENT=1
-	ENABLE_PROXIMITY_EVENTS=0
-	ENABLE_QUOTA=0
-	ENABLE_RESOURCE_TIMING=0
-	ENABLE_REQUEST_ANIMATION_FRAME=1
-	ENABLE_SCRIPTED_SPEECH=0
-	ENABLE_SHADOW_DOM=1
-	ENABLE_SHARED_WORKERS=1
-	ENABLE_SMOOTH_SCROLLING=1
-	ENABLE_SQL_DATABASE=1
-	ENABLE_STYLE_SCOPED=0
-	ENABLE_SVG_DOM_OBJC_BINDINGS=0
-	ENABLE_TEMPLATE_ELEMENT=0
-	ENABLE_TEXT_AUTOSIZING=0
-	ENABLE_TOUCH_EVENTS=0
-	ENABLE_TOUCH_ICON_LOADING=0
-	ENABLE_USER_TIMING=0
-	ENABLE_VIBRATION=0
-	ENABLE_VIDEO_TRACK=0
-	ENABLE_WEB_AUDIO=0
-	ENABLE_WEB_SOCKETS=1
-	ENABLE_WEB_TIMING=1
-	ENABLE_WORKERS=1
+read DEFAULT_FEATURE_DEFINES <<"EOF"
+	ENABLE_ACCELERATED_2D_CANVAS=0 \
+	ENABLE_BATTERY_STATUS=0 \
+	ENABLE_BLOB=1 \
+	ENABLE_CANVAS_PATH=0 \
+	ENABLE_CANVAS_PROXY=0 \
+	ENABLE_CHANNEL_MESSAGING=1 \
+	ENABLE_CSP_NEXT=0 \
+	ENABLE_CSS3_TEXT=0 \
+	ENABLE_CSS_BOX_DECORATION_BREAK=1 \
+	ENABLE_CSS_COMPOSITING=0 \
+	ENABLE_CSS_DEVICE_ADAPTATION=0 \
+	ENABLE_CSS_EXCLUSIONS=1 \
+	ENABLE_CSS_IMAGE_ORIENTATION=0 \
+	ENABLE_CSS_IMAGE_RESOLUTION=0 \
+	ENABLE_CSS_IMAGE_SET=0 \
+	ENABLE_CSS_REGIONS=0 \
+	ENABLE_CSS_STICKY_POSITION=0 \
+	ENABLE_CSS_TRANSFORMS_ANIMATIONS_UNPREFIXED=0 \
+	ENABLE_CSS_VARIABLES=0 \
+	ENABLE_CSS3_CONDITIONAL_RULES=0 \
+	ENABLE_CUSTOM_SCHEME_HANDLER=0 \
+	ENABLE_DASHBOARD_SUPPORT=0 \
+	ENABLE_DATALIST_ELEMENT=0 \
+	ENABLE_DATA_TRANSFER_ITEMS=0 \
+	ENABLE_DETAILS_ELEMENT=1 \
+	ENABLE_DEVICE_ORIENTATION=0 \
+	ENABLE_DIALOG_ELEMENT=0 \
+	ENABLE_DIRECTORY_UPLOAD=0 \
+	ENABLE_DOM4_EVENTS_CONSTRUCTOR=0 \
+	ENABLE_DOWNLOAD_ATTRIBUTE=0 \
+	ENABLE_FILE_SYSTEM=0 \
+	ENABLE_FILTERS=1 \
+	ENABLE_FTPDIR=0 \
+	ENABLE_FULLSCREEN_API=1 \
+	ENABLE_HIGH_DPI_CANVAS=0 \
+	ENABLE_ICONDATABASE=1 \
+	ENABLE_IFRAME_SEAMLESS=1 \
+	ENABLE_INDEXED_DATABASE=0 \
+	ENABLE_INPUT_SPEECH=0 \
+	ENABLE_INPUT_TYPE_COLOR=0 \
+	ENABLE_INPUT_TYPE_DATE=0 \
+	ENABLE_INPUT_TYPE_DATETIME=0 \
+	ENABLE_INPUT_TYPE_DATETIMELOCAL=0 \
+	ENABLE_INPUT_TYPE_MONTH=0 \
+	ENABLE_INPUT_TYPE_TIME=0 \
+	ENABLE_INPUT_TYPE_WEEK=0 \
+	ENABLE_INSPECTOR=1 \
+	ENABLE_JAVASCRIPT_DEBUGGER=1 \
+	ENABLE_LEGACY_CSS_VENDOR_PREFIXES=0 \
+	ENABLE_LEGACY_NOTIFICATIONS=0 \
+	ENABLE_LEGACY_VENDOR_PREFIXES=1 \
+	ENABLE_LEGACY_WEB_AUDIO=0 \
+	ENABLE_LINK_PREFETCH=0 \
+	ENABLE_LINK_PRERENDER=0 \
+	ENABLE_MATHML=0 \
+	ENABLE_MEDIA_CAPTURE=0 \
+	ENABLE_MEDIA_SOURCE=0 \
+	ENABLE_MEDIA_STATISTICS=0 \
+	ENABLE_MEDIA_STREAM=0 \
+	ENABLE_METER_ELEMENT=1 \
+	ENABLE_MHTML=1 \
+	ENABLE_MICRODATA=0 \
+	ENABLE_MOUSE_CURSOR_SCALE=0 \
+	ENABLE_NAVIGATOR_CONTENT_UTILS=0 \
+	ENABLE_NETSCAPE_PLUGIN_API=1 \
+	ENABLE_NETWORK_INFO=0 \
+	ENABLE_NOTIFICATIONS=0 \
+	ENABLE_ORIENTATION_EVENTS=0 \
+	ENABLE_PAGE_VISIBILITY_API=0 \
+	ENABLE_PERFORMANCE_TIMELINE=0 \
+	ENABLE_PROGRESS_ELEMENT=1 \
+	ENABLE_PROXIMITY_EVENTS=0 \
+	ENABLE_QUOTA=0 \
+	ENABLE_RESOURCE_TIMING=0 \
+	ENABLE_REQUEST_ANIMATION_FRAME=1 \
+	ENABLE_SCRIPTED_SPEECH=0 \
+	ENABLE_SHADOW_DOM=1 \
+	ENABLE_SHARED_WORKERS=1 \
+	ENABLE_SMOOTH_SCROLLING=1 \
+	ENABLE_SQL_DATABASE=1 \
+	ENABLE_STYLE_SCOPED=0 \
+	ENABLE_SVG_DOM_OBJC_BINDINGS=0 \
+	ENABLE_TEMPLATE_ELEMENT=0 \
+	ENABLE_TEXT_AUTOSIZING=0 \
+	ENABLE_TOUCH_EVENTS=0 \
+	ENABLE_TOUCH_ICON_LOADING=0 \
+	ENABLE_USER_TIMING=0 \
+	ENABLE_VIBRATION=0 \
+	ENABLE_VIDEO_TRACK=0 \
+	ENABLE_WEB_AUDIO=0 \
+	ENABLE_WEB_SOCKETS=1 \
+	ENABLE_WEB_TIMING=1 \
+	ENABLE_WORKERS=1 \
 	ENABLE_XHR_TIMEOUT=1
 EOF
 
@@@@ -21501,7 +21489,7 @@@@ fi
 
 # We need to run this command now rather than use AC_CONFIG_COMMANDS
 # because automake rules depend on the output file (WebKitFeatures.txt).
-$srcdir/Tools/gtk/generate-feature-defines-files $DEFAULT_FEATURE_DEFINES
+${MODPY_BIN} $srcdir/Tools/gtk/generate-feature-defines-files $DEFAULT_FEATURE_DEFINES
 
 
 
@


1.11
log
@Bugfix update to webkit 1.8.3.

Remove the pthread/lpthread chunks from patch-GNUmakefile_in while here.

Successfully tested with GtkLauncher on sparc64 after a whooping 21h-build..
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.10 2012/04/30 13:31:06 landry Exp $
d3 4
a6 1
GNOME Bug 627126 - gsettings schema files don't get installed on FreeBSD
d9 4
a12 1
Don't force the use of -O2, the ports infrastructure
d15 27
a41 17
OpenBSD doesnt have libdl

Fix gstreamer detection : https://bugs.webkit.org/show_bug.cgi?id=82580
--- configure.orig	Tue Aug 21 04:57:19 2012
+++ configure	Tue Aug 21 09:36:54 2012
@@@@ -18629,8 +18629,8 @@@@ GSTREAMER_0_11_REQUIRED_VERSION=0.11
 GSTREAMER_0_11_PLUGINS_BASE_REQUIRED_VERSION=0.11.0.2
 
 case "$with_gstreamer" in
-     0.10) GSTREAMER_REQUIRED_VERSION=GSTREAMER_0_10_REQUIRED_VERSION
-           GSTREAMER_PLUGINS_BASE_REQUIRED_VERSION=GSTREAMER_0_10_PLUGINS_BASE_REQUIRED_VERSION
+     0.10) GSTREAMER_REQUIRED_VERSION=$GSTREAMER_0_10_REQUIRED_VERSION
+           GSTREAMER_PLUGINS_BASE_REQUIRED_VERSION=$GSTREAMER_0_10_PLUGINS_BASE_REQUIRED_VERSION
            GST_API_VERSION=0.10
            ;;
      0.11) GSTREAMER_REQUIRED_VERSION=GSTREAMER_0_11_REQUIRED_VERSION
@@@@ -19227,22 +19227,10 @@@@ install-data-am: install-gsettings-schemas
d66 25
a90 1
@@@@ -20524,7 +20512,7 @@@@ fi
a91 1
 done
d93 5
a97 2
-    OPENGL_LIBS="-lGL -ldl"
+    OPENGL_LIBS="-lGL"
d101 10
a110 1
@@@@ -21660,8 +21648,8 @@@@ fi
d112 1
a112 1
 # Add the appropriate 'O' level for optimized builds
d114 4
a117 4
-   CXXFLAGS="$CXXFLAGS -O2"
-   CFLAGS="$CFLAGS -O2"
+   CXXFLAGS="$CXXFLAGS"
+   CFLAGS="$CFLAGS"
d119 206
a324 2
    CXXFLAGS="$CXXFLAGS -O0"
    CFLAGS="$CFLAGS -O0"
@


1.10
log
@Update to webkit 1.8.1.

ok ajacoutot@@, tested by a few on ports@@ (thanks!)
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.9 2012/04/03 15:41:07 landry Exp $
d12 3
a14 3
--- configure.orig	Tue Apr 24 07:17:08 2012
+++ configure	Tue Apr 24 09:56:57 2012
@@@@ -18545,8 +18545,8 @@@@ GSTREAMER_0_11_REQUIRED_VERSION=0.11
d25 1
a25 1
@@@@ -19143,22 +19143,10 @@@@ install-data-am: install-gsettings-schemas
d50 1
a50 1
@@@@ -20440,7 +20428,7 @@@@ fi
d59 1
a59 1
@@@@ -21576,8 +21564,8 @@@@ fi
@


1.9
log
@sync comment
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.8 2012/04/03 15:39:35 landry Exp $
d12 3
a14 3
--- configure.orig	Tue Mar 27 18:31:16 2012
+++ configure	Fri Mar 30 22:01:48 2012
@@@@ -18544,8 +18544,8 @@@@ GSTREAMER_0_11_REQUIRED_VERSION=0.11
d25 1
a25 1
@@@@ -19139,22 +19139,10 @@@@ install-data-am: install-gsettings-schemas
d50 1
a50 1
@@@@ -20436,7 +20424,7 @@@@ fi
d59 1
a59 1
@@@@ -21572,8 +21560,8 @@@@ fi
@


1.8
log
@Major update to webkit 1.8.0.

- disable static libs, shrinks package size by a factor 3
- now depends on geoclue for geolocation purposes (of course its up to
  the browsers to enable the feature or not..)
- simplify Makefile/FLAVORS/SHARED_LIBS
- fold most of the PFRAGs to PLIST by using variables
- remove patch-Source_JavaScriptCore_runtime_JSValue_h, seems it was
  added for sparc64 but now it breaks the build there, and noone has been
able to justify the addition of that patch. Without it, GtkLauncher
shows simple html websites on sparc64 and crashes as soon as some js is
involved, but thats not much different from before
- remove patch-Source_JavaScriptCore_wtf_text_StringHash_h &
  patch-Source_JavaScriptCore_wtf_text_StringImpl_cpp, replaced by
patch-Source_JavaScriptCore_runtime_UString_h for mips64/sparc64
- add patch-Source_JavaScriptCore_wtf_NumberOfCores_cpp for #82585

tested on i386/amd64 by several, amd64 bulk build, ppc & sparc64 testing
by myself. mips64el in the works..
ok ajacoutot@@
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.7 2012/02/24 16:36:00 landry Exp $
d9 3
@


1.7
log
@Update to webkit 1.6.3, based on a diff from marco.

- switch to .tar.xz distfile
- bump libjavascriptgtk major
- backport a commit from upstream bz #68314, fixes issues on twitter

tested by aja@@/pstumpf@@/kili@@ on amd64 & myself on i386/ppc.
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.6 2011/10/13 06:52:49 jasper Exp $
a5 2
Add amd64 to x86_64 host_cpu.

d9 14
a22 3
--- configure.orig	Wed Feb  1 14:49:20 2012
+++ configure	Fri Feb  3 14:25:45 2012
@@@@ -19142,22 +19142,10 @@@@ install-data-am: install-gsettings-schemas
d47 1
a47 8
@@@@ -21114,7 +21102,7 @@@@ $as_echo "#define ENABLE_YARR 1" >>confdefs.h
 $as_echo "#define ENABLE_YARR_JIT 1" >>confdefs.h
 
         ;;
-        i*86|x86_64)
+        i*86|x86_64|amd64)
 
 $as_echo "#define ENABLE_JIT 1" >>confdefs.h
d49 1
a49 2
@@@@ -21139,7 +21127,7 @@@@ $as_echo "#define ENABLE_JIT_OPTIMIZE_ARITHMETIC 1" >>
 $as_echo "#define WTF_USE_JIT_STUB_ARGUMENT_VA_LIST 1" >>confdefs.h
d51 3
a53 3
                 ;;
-                x86_64)
+                x86_64|amd64)
a54 1
 $as_echo "#define WTF_USE_JIT_STUB_ARGUMENT_REGISTER 1" >>confdefs.h
d56 1
a56 1
@@@@ -21431,8 +21419,8 @@@@ fi
@


1.6
log
@- update to 1.6.1

tested in a bulk on amd64, as well as on sparc64 by myself
macppc testing by pea@@

ok aja@@
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.5 2011/07/05 11:34:27 landry Exp $
d11 3
a13 3
--- configure.orig	Tue Sep 27 12:41:23 2011
+++ configure	Fri Oct  7 10:03:03 2011
@@@@ -19061,22 +19061,10 @@@@ install-data-am: install-gsettings-schemas
d38 1
a38 1
@@@@ -21029,7 +21017,7 @@@@ $as_echo "#define ENABLE_YARR 1" >>confdefs.h
d47 1
a47 1
@@@@ -21054,7 +21042,7 @@@@ $as_echo "#define ENABLE_JIT_OPTIMIZE_ARITHMETIC 1" >>
d56 1
a56 1
@@@@ -21346,8 +21334,8 @@@@ fi
@


1.5
log
@Update to webkit 1.4.2, see http://trac.webkit.org/wiki/WebKitGTK/1.4.2
for a list of changes.
ok jasper@@, tested by a few on ports@@
@
text
@d1 2
a2 1
$OpenBSD: patch-configure,v 1.4 2011/06/17 22:10:40 landry Exp $
d10 4
a13 3
--- configure.orig	Fri Jul  1 01:07:47 2011
+++ configure	Fri Jul  1 09:26:34 2011
@@@@ -18420,22 +18420,10 @@@@ install-data-am: install-gsettings-schemas
d38 1
a38 1
@@@@ -20221,7 +20209,7 @@@@ $as_echo "#define ENABLE_YARR 1" >>confdefs.h
d47 1
a47 1
@@@@ -20246,7 +20234,7 @@@@ $as_echo "#define ENABLE_JIT_OPTIMIZE_ARITHMETIC 1" >>
d56 1
a56 1
@@@@ -20463,8 +20451,8 @@@@ fi
@


1.4
log
@Update to webkit 1.4.1, see https://trac.webkit.org/wiki/WebKitGTK/1.4.1
for a list of changes.
Tested by pea@@ on macppc, myself on sparc64, rpointel@@, marco@@ and myself
on amd64.
ok rpointel@@.
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.3 2011/05/11 06:00:08 ajacoutot Exp $
d9 3
a11 3
--- configure.orig	Sun Jun  5 19:13:51 2011
+++ configure	Tue Jun  7 09:12:35 2011
@@@@ -18412,22 +18412,10 @@@@ install-data-am: install-gsettings-schemas
d36 1
a36 1
@@@@ -20213,7 +20201,7 @@@@ $as_echo "#define ENABLE_YARR 1" >>confdefs.h
d45 1
a45 1
@@@@ -20238,7 +20226,7 @@@@ $as_echo "#define ENABLE_JIT_OPTIMIZE_ARITHMETIC 1" >>
d54 1
a54 1
@@@@ -20455,8 +20443,8 @@@@ fi
@


1.3
log
@Major update to webkit-1.4.0.
Now comes with a gtk3 FLAVOR that can be installed alongside the non
flavored package (webkit vs webkit-gtk3).

The library name changed from libwebkit to libwebkit-gtk{1,3}.

thanks to landry@@ and jasper@@ for the tests on powerpc, sparc64 and
amd64.
bulk testing from landry@@

ok jasper@@ landry@@ (maintainer)
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.2 2010/09/19 20:43:32 landry Exp $
d9 3
a11 3
--- configure.orig	Tue Apr 26 03:30:21 2011
+++ configure	Mon May  9 07:28:58 2011
@@@@ -18310,22 +18310,10 @@@@ install-data-am: install-gsettings-schemas
d36 1
a36 1
@@@@ -20123,7 +20111,7 @@@@ $as_echo "#define ENABLE_YARR 1" >>confdefs.h
d45 1
a45 1
@@@@ -20148,7 +20136,7 @@@@ $as_echo "#define ENABLE_JIT_OPTIMIZE_ARITHMETIC 1" >>
d54 1
a54 1
@@@@ -20366,8 +20354,8 @@@@ fi
@


1.2
log
@Update to webkit 1.2.4.
Tested by pea@@, Dawe, Remi Pointel, jasper@@ and marco@@, thanks!
@
text
@d1 6
a6 1
$OpenBSD: patch-configure,v 1.1 2010/08/30 13:15:49 landry Exp $
d9 46
a54 3
--- configure.orig	Fri Sep  3 21:30:50 2010
+++ configure	Tue Sep 14 09:09:55 2010
@@@@ -19534,8 +19534,8 @@@@ fi
@


1.1
log
@Don't force the use of -O2, the ports infrastructure takes care of
adding it. Makes the port respect user-defined CFLAGS.
Pointed out by brad
@
text
@d1 1
a1 1
$OpenBSD$
d4 3
a6 3
--- configure.orig	Sun Aug 29 21:50:39 2010
+++ configure	Sun Aug 29 21:52:36 2010
@@@@ -19530,8 +19530,8 @@@@ fi
@

