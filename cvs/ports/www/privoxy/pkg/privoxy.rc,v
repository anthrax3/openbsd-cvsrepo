head	1.4;
access;
symbols
	OPENBSD_6_1:1.4.0.10
	OPENBSD_6_1_BASE:1.4
	OPENBSD_6_0:1.4.0.8
	OPENBSD_6_0_BASE:1.4
	OPENBSD_5_9:1.4.0.4
	OPENBSD_5_9_BASE:1.4
	OPENBSD_5_8:1.4.0.6
	OPENBSD_5_8_BASE:1.4
	OPENBSD_5_7:1.4.0.2
	OPENBSD_5_7_BASE:1.4
	OPENBSD_5_6:1.3.0.12
	OPENBSD_5_6_BASE:1.3
	OPENBSD_5_5:1.3.0.10
	OPENBSD_5_5_BASE:1.3
	OPENBSD_5_4:1.3.0.8
	OPENBSD_5_4_BASE:1.3
	OPENBSD_5_3:1.3.0.6
	OPENBSD_5_3_BASE:1.3
	OPENBSD_5_2:1.3.0.4
	OPENBSD_5_2_BASE:1.3
	OPENBSD_5_1_BASE:1.3
	OPENBSD_5_1:1.3.0.2
	OPENBSD_5_0:1.2.0.2
	OPENBSD_5_0_BASE:1.2;
locks; strict;
comment	@ * @;


1.4
date	2014.08.24.09.17.52;	author ajacoutot;	state Exp;
branches;
next	1.3;
commitid	KLjSYF8SXegVhowp;

1.3
date	2011.10.14.09.57.51;	author merdely;	state Exp;
branches;
next	1.2;

1.2
date	2011.03.25.07.01.14;	author ajacoutot;	state Exp;
branches;
next	1.1;

1.1
date	2011.03.25.02.57.10;	author merdely;	state Exp;
branches;
next	;


desc
@@


1.4
log
@Multiline flags are not supported by the new parser for now; so unbreak
default daemon_flags.

reported by Sebastien Marie
@
text
@#!/bin/sh
#
# $OpenBSD: privoxy.rc,v 1.3 2011/10/14 09:57:51 merdely Exp $

daemon="${TRUEPREFIX}/sbin/privoxy"
daemon_flags="--user _privoxy --chroot --pre-chroot-nslookup www.google.com ${SYSCONFDIR}/privoxy/config"

. /etc/rc.d/rc.subr

rc_reload=NO

rc_pre()
{
	case ${daemon_flags} in
	*--chroot*)	
		pax -rw -u -p e ${SYSCONFDIR}/privoxy /var/privoxy/
		pax -rw -u -p e ${SYSCONFDIR}/hosts /var/privoxy/
		pax -rw -u -p e ${SYSCONFDIR}/resolv.conf /var/privoxy/
		;;
	esac
}

rc_post()
{
	# preserve config changes made inside the chroot
	# (for instance via the web interface)
	case ${daemon_flags} in
	*--chroot*)
		cd /var/privoxy${SYSCONFDIR} && \
			pax -rw -u -p e ./privoxy ${SYSCONFDIR}
		;;
	esac
}

rc_cmd $1
@


1.3
log
@Fix "/etc/rc.d/privoxy stop".
Diff from Pascal Stumpf (thanks! sorry it took so long)

"looks ok to me" sthen@@
@
text
@d3 1
a3 1
# $OpenBSD: privoxy.rc,v 1.2 2011/03/25 07:01:14 ajacoutot Exp $
d6 1
a6 2
daemon_flags="--user _privoxy --chroot --pre-chroot-nslookup \
	www.google.com ${SYSCONFDIR}/privoxy/config"
@


1.2
log
@Clean-up indent.
@
text
@d3 1
a3 1
# $OpenBSD: privoxy.rc,v 1.1 2011/03/25 02:57:10 merdely Exp $
d6 1
a6 1
daemon_flags="--user _privoxy._privoxy --chroot --pre-chroot-nslookup \
@


1.1
log
@Forgot to `cvs add` the rc script
@
text
@d3 1
a3 1
# $OpenBSD$
d17 4
a20 4
			pax -rw -u -p e ${SYSCONFDIR}/privoxy /var/privoxy/
			pax -rw -u -p e ${SYSCONFDIR}/hosts /var/privoxy/
			pax -rw -u -p e ${SYSCONFDIR}/resolv.conf /var/privoxy/
			;;
d26 2
a27 2
	# preserve config changes made inside the chroot, for instance via the
	# web interface
d30 3
a32 3
			cd /var/privoxy${SYSCONFDIR} && pax -rw -u -p e \
				./privoxy ${SYSCONFDIR}
			;;
@

