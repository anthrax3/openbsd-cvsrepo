head	1.1;
access;
symbols
	OPENBSD_5_3:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2013.07.02.17.10.59;	author jasper;	state dead;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2013.07.02.17.10.59;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.1
log
@file patch-inc_toolbox_class_php was initially added on branch OPENBSD_5_3.
@
text
@@


1.1.2.1
log
@Security fixes from upstream svn for:
CVE-2012-2225, usage of unsafe unserialize() function
CVE-2013-2227, local file inclusion vulnerability
@
text
@a0 51
$OpenBSD$

Security fix for CVE-2012-2225, usage of unsafe unserialize() function.
https://forge.indepnet.net/projects/glpi/repository/revisions/21171

--- inc/toolbox.class.php.orig	Tue Dec  4 16:21:43 2012
+++ inc/toolbox.class.php	Tue Jul  2 19:01:16 2013
@@@@ -1771,11 +1771,41 @@@@ class Toolbox {
     * Clean integer value (strip all chars not - and spaces )
     *
     * @@param $integer string: integer string
-    * @@since versin 0.83.5
+    * @@since version 0.83.5
     * @@return clean integer
    **/
    static function cleanInteger($integer) {
       return preg_replace("/[^0-9-]/", "", $integer);
    }
+
+   /**
+    * Prepare array passed on an input form
+    *
+    * @@param $value array: passed array
+    * @@since version 0.83.91
+    * @@return string encoded array
+   **/
+   static function prepareArrayForInput($value) {
+      return base64_encode(json_encode($value));
+   }
+
+   /**
+    * Decode array passed on an input form
+    *
+    * @@param $value string: encoded value
+    * @@since version 0.83.91
+    * @@return string decoded array
+   **/
+   static function decodeArrayFromInput($value) {
+      if ($dec = base64_decode($value)) {
+         if ($ret = json_decode($dec,true)) {
+            return $ret;
+         }
+      }
+      return array();
+   }
+   
+
+   
 }
 ?>
\ No newline at end of file
@

