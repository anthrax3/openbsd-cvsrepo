head	1.1;
access;
symbols
	OPENBSD_5_3:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2013.07.02.17.10.59;	author jasper;	state dead;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2013.07.02.17.10.59;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.1
log
@file patch-inc_autoload_function_php was initially added on branch OPENBSD_5_3.
@
text
@@


1.1.2.1
log
@Security fixes from upstream svn for:
CVE-2012-2225, usage of unsafe unserialize() function
CVE-2013-2227, local file inclusion vulnerability
@
text
@a0 27
$OpenBSD$

Security fix for CVE-2013-2227, local file inclusion vulnerability
https://forge.indepnet.net/projects/glpi/repository/revisions/21172

--- inc/autoload.function.php.orig	Tue Jul  2 19:05:22 2013
+++ inc/autoload.function.php	Tue Jul  2 19:06:17 2013
@@@@ -84,9 +84,9 @@@@ function glpi_autoload($classname) {
    global $DEBUG_AUTOLOAD, $CFG_GLPI;
    static $notfound = array('xStates' => true);
 
-   // empty classname or non concerted plugin
-   if (empty($classname) || is_numeric($classname)) {
-      return false;
+   // empty classname or non concerted plugin or classname containing dot (leaving GLPI main treee)
+   if (empty($classname) || is_numeric($classname) || (strpos($classname, '.') !== false)) {
+     return false;
    }
    $dir = GLPI_ROOT . "/inc/";
    if ($plug=isPluginItemType($classname)) {
@@@@ -158,4 +158,4 @@@@ if (function_exists('spl_autoload_register')) {
    }
 }
 
-?>
\ No newline at end of file
+?>
@

