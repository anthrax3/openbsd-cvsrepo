head	1.30;
access;
symbols
	OPENBSD_5_8:1.26.0.4
	OPENBSD_5_8_BASE:1.26
	OPENBSD_5_7:1.22.0.2
	OPENBSD_5_7_BASE:1.22
	OPENBSD_5_6:1.15.0.2
	OPENBSD_5_6_BASE:1.15
	OPENBSD_5_5:1.2.0.2
	OPENBSD_5_5_BASE:1.2;
locks; strict;
comment	@# @;


1.30
date	2015.09.10.13.00.10;	author sthen;	state dead;
branches;
next	1.29;
commitid	vagA8GU9rOjsV69E;

1.29
date	2015.08.28.11.45.39;	author jca;	state Exp;
branches;
next	1.28;
commitid	tVwjncfyxivYt1qr;

1.28
date	2015.08.25.07.30.29;	author ajacoutot;	state Exp;
branches;
next	1.27;
commitid	x3rR2VHR7RvISfgT;

1.27
date	2015.08.11.20.47.47;	author sthen;	state Exp;
branches;
next	1.26;
commitid	n6tL70HXWUHBbRhX;

1.26
date	2015.06.11.14.57.30;	author sthen;	state Exp;
branches
	1.26.4.1;
next	1.25;
commitid	nX6rh9h06dwKgpcl;

1.25
date	2015.05.28.10.17.25;	author pascal;	state Exp;
branches;
next	1.24;
commitid	020U4lCPk8wUkCOz;

1.24
date	2015.05.04.11.04.08;	author sthen;	state Exp;
branches;
next	1.23;
commitid	6WZHDa4GG3bbImoJ;

1.23
date	2015.03.16.09.16.17;	author sthen;	state Exp;
branches;
next	1.22;
commitid	iBnbHpKQGISmWY6D;

1.22
date	2015.02.19.14.30.29;	author sthen;	state Exp;
branches
	1.22.2.1;
next	1.21;
commitid	kNznwHz1Ff8cRgML;

1.21
date	2015.01.19.08.35.43;	author sthen;	state Exp;
branches;
next	1.20;
commitid	gXHgwcHdzqXsdMwJ;

1.20
date	2014.12.12.22.17.33;	author sthen;	state Exp;
branches;
next	1.19;
commitid	OFYgUzabzvLBqgMN;

1.19
date	2014.11.17.14.02.19;	author ajacoutot;	state Exp;
branches;
next	1.18;
commitid	lrMc8yxomUudhiIj;

1.18
date	2014.11.07.01.00.01;	author sthen;	state Exp;
branches;
next	1.17;
commitid	g1uhkfDXDRORwgCu;

1.17
date	2014.09.16.15.29.30;	author sthen;	state Exp;
branches;
next	1.16;
commitid	nZrnayoIbspyemJS;

1.16
date	2014.09.10.09.59.55;	author sthen;	state Exp;
branches;
next	1.15;
commitid	sgxOvvxyslxzvH7K;

1.15
date	2014.07.19.22.36.13;	author ajacoutot;	state Exp;
branches
	1.15.2.1;
next	1.14;
commitid	MSFt4PoL3vJ8bL97;

1.14
date	2014.07.09.14.19.59;	author ajacoutot;	state Exp;
branches;
next	1.13;
commitid	bdiG2oZmTsT2fhbi;

1.13
date	2014.06.26.12.54.31;	author sthen;	state Exp;
branches;
next	1.12;
commitid	Bim1wgakpenAoOkI;

1.12
date	2014.05.19.11.29.01;	author sthen;	state Exp;
branches;
next	1.11;

1.11
date	2014.05.15.21.24.33;	author sthen;	state Exp;
branches;
next	1.10;

1.10
date	2014.05.07.20.52.06;	author sthen;	state Exp;
branches;
next	1.9;

1.9
date	2014.04.26.12.06.52;	author sthen;	state Exp;
branches;
next	1.8;

1.8
date	2014.04.26.10.34.04;	author sthen;	state Exp;
branches;
next	1.7;

1.7
date	2014.04.24.14.26.21;	author sthen;	state Exp;
branches;
next	1.6;

1.6
date	2014.04.21.20.29.50;	author sthen;	state Exp;
branches;
next	1.5;

1.5
date	2014.04.09.19.47.51;	author sthen;	state Exp;
branches;
next	1.4;

1.4
date	2014.04.08.12.22.48;	author sthen;	state Exp;
branches;
next	1.3;

1.3
date	2014.03.16.12.58.48;	author sthen;	state Exp;
branches;
next	1.2;

1.2
date	2013.12.07.10.47.20;	author sthen;	state Exp;
branches
	1.2.2.1;
next	1.1;

1.1
date	2013.11.15.19.09.17;	author sthen;	state Exp;
branches;
next	;

1.2.2.1
date	2014.09.10.10.11.08;	author sthen;	state Exp;
branches;
next	;
commitid	yUDArhYMopOagxMr;

1.15.2.1
date	2014.09.10.10.09.04;	author sthen;	state Exp;
branches;
next	1.15.2.2;
commitid	1FWdAezuUkTJ6wzD;

1.15.2.2
date	2014.12.12.22.33.56;	author sthen;	state Exp;
branches;
next	;
commitid	IARJqqWqcop0u0J0;

1.22.2.1
date	2015.08.24.09.43.52;	author sthen;	state Exp;
branches;
next	;
commitid	pLRtw8b09XSVmVMu;

1.26.4.1
date	2015.08.24.09.42.57;	author sthen;	state Exp;
branches;
next	;
commitid	R4ANmnEERdfuKdmQ;


desc
@@


1.30
log
@Currently Squid 3.5 is considered stable. Rather than moving snapshot/*
to stable/*, just drop back to a single version of squid in ports.
@
text
@# $OpenBSD: Makefile,v 1.29 2015/08/28 11:45:39 jca Exp $

PORTROACH=	limit:^3\.4\.*

V=		3.4.14
REVISION=	1

WANTLIB+=	stdc++

EXTERNAL_ACL=	LDAP_group SQL_session file_userip time_quota session \
		unix_group wbinfo_group

CONFIGURE_ARGS=	--disable-strict-error-checking \
		--disable-arch-native

.include <bsd.port.mk>
@


1.29
log
@Additional fixes for SSLv3 removal.  ok sthen@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2015/08/25 07:30:29 ajacoutot Exp $
@


1.28
log
@/var/run content is already removed by /etc/rc, so no need to handle that in
the package. If a /var/run/foo directory must exist for proper start of a
software, then the rc.d script should take care of it.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2015/08/11 20:47:47 sthen Exp $
d6 1
a6 1
REVISION=	0
@


1.27
log
@SECURITY update to squid-3.4.14
- Do not blindly forward cache peer CONNECT responses (CVE-2015-5400)
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.26 2015/06/11 14:57:30 sthen Exp $
d6 1
a6 1
PORTROACH=	limit:^3\.4\.*
@


1.26
log
@update to squid-3.5.5
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2015/05/28 10:17:25 pascal Exp $
d3 1
a3 2
V=		3.4.13
REVISION=	0
@


1.26.4.1
log
@MFC SECURITY update to squid-3.4.14
- Do not blindly forward cache peer CONNECT responses (CVE-2015-5400)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2015/08/11 20:47:47 sthen Exp $
d3 2
a4 1
V=		3.4.14
@


1.25
log
@gcc4 bumps, reminded by aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2015/05/04 11:04:08 sthen Exp $
d6 2
@


1.24
log
@update to squid-3.4.13, fixing a certificate validation bypass issue
in SSL-Bump configurations using "client-first" or "bump" modes.
This does not affect configurations that don't use SSL-Bump (this is
not something you are likely to have enabled by accident as it needs
fairly significant configuration).

http://www.squid-cache.org/Advisories/SQUID-2015_1.txt
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2015/03/16 09:16:17 sthen Exp $
d4 1
@


1.23
log
@add portroach limit
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2015/02/19 14:30:29 sthen Exp $
d3 1
a3 1
V=		3.4.12
@


1.22
log
@bugfix update to squid-3.4.12, including several crashes with debugging,
and fix silent SSL/TLS failure on "split-stack" OS (i.e. using different
sockets for v4/v6, like us)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2015/01/19 08:35:43 sthen Exp $
d4 1
@


1.22.2.1
log
@MFC SECURITY update to squid-3.4.14
- Do not blindly forward cache peer CONNECT responses (CVE-2015-5400)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2015/08/11 20:47:47 sthen Exp $
d3 1
a3 4
V=		3.4.14
PORTROACH=	limit:^3\.4\.*

WANTLIB+=	stdc++
@


1.21
log
@update to squid 3.4.11
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2014/12/12 22:17:33 sthen Exp $
d3 1
a3 1
V=		3.4.11
@


1.20
log
@update to squid 3.4.10 and enable ssl-crtd

Fixes a segmentation fault in ACLUrlPathStrategy::match which would
occur when urlpath_regex ACL was used in access controls to test
transactions where no URL path is available. eg CONNECT or OPTIONS
requests, some WebDAV requests, etc.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2014/11/17 14:02:19 ajacoutot Exp $
d3 1
a3 1
V=		3.4.10
@


1.19
log
@Bump daemon_timeout from 31 to 35. Default squid shutdown timeout is 30s,
but we may be a bit slow, so give us some room.

ok sthen@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2014/11/07 01:00:01 sthen Exp $
d3 1
a3 2
V=		3.4.9
REVISION-main=	0
@


1.18
log
@update to squid 3.4.9
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2014/09/16 15:29:30 sthen Exp $
d4 1
@


1.17
log
@update to squid-3.4.8, fix off by one in SNMP subsystem

3.4.8 also fixes an issue with the standalone pinger process as described
in http://www.openwall.com/lists/oss-security/2014/09/16/6, but we don't have
that enabled in the port at present.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2014/09/10 09:59:55 sthen Exp $
d3 1
a3 1
V=		3.4.8
@


1.16
log
@SECURITY update to squid 3.4.7 - clients can perform a DoS due to
incorrect input validation in range checking.

http://www.squid-cache.org/Advisories/SQUID-2014_2.txt
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2014/07/19 22:36:13 ajacoutot Exp $
d3 1
a3 1
V=		3.4.7
@


1.15
log
@/etc/rc.d -> ${RCDIR}
(as pedantic and useless as /usr/local vs LOCALBASE|PREFIX but well...)

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2014/07/09 14:19:59 ajacoutot Exp $
d3 1
a3 3
V=		3.4.6
REVISION=	0
REVISION-main=	1
@


1.15.2.1
log
@SECURITY update to squid 3.4.7 - clients can perform a DoS due to
incorrect input validation in range checking.

http://www.squid-cache.org/Advisories/SQUID-2014_2.txt
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2014/07/19 22:36:13 ajacoutot Exp $
d3 3
a5 1
V=		3.4.7
@


1.15.2.2
log
@MFC: update to squid 3.4.10 and enable ssl-crtd (also roll in an earlier
change to increase daemon_timeout for more reliable shutdowns).

Fixes a segmentation fault in ACLUrlPathStrategy::match which would
occur when urlpath_regex ACL was used in access controls to test
transactions where no URL path is available. eg CONNECT or OPTIONS
requests, some WebDAV requests, etc.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2014/11/17 14:02:19 ajacoutot Exp $
d3 1
a3 1
V=		3.4.10
@


1.14
log
@Drop local shutdown patch and set daemon_timeout="31".

prodded by sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2014/06/26 12:54:31 sthen Exp $
d5 1
@


1.13
log
@Update to squid-3.4.6, various fixes (especially for SSL-bump but some general
ones). Includes some memory leak and segv fixes.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2014/05/19 11:29:01 sthen Exp $
d4 1
@


1.12
log
@add patch (committed upstrem) to fix an uninitialised use when %tg is used in
a logformat config line.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2014/05/15 21:24:33 sthen Exp $
d3 1
a3 2
V=		3.4.5
REVISION=	1
@


1.11
log
@disable "rock" storeio backend, it doesn't currently work on OpenBSD (creates
initial db file ok, but EMSGSIZE when trying to open at normal startup)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2014/05/07 20:52:06 sthen Exp $
d4 1
a4 1
REVISION=	0
@


1.10
log
@update squid/stable to 3.4.5 and squid/snapshot to 20140506-r13398.
use ports/lang/gcc to build snapshot, squid will be moving to requiring
c++11 so let's build this with it already to get more experience.
squid/stable stays with base gcc for most arch for now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2014/04/26 12:06:52 sthen Exp $
d4 1
@


1.9
log
@un-revert previous revert, and add a patch from upstream to fix https tunnels
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2014/04/26 10:34:04 sthen Exp $
d3 1
a3 2
V=		3.4.4.2
REVISION=	1
@


1.8
log
@partially revert upstream commit to fix failures with https CONNECT
introduced in 3.4.4.2

http://bugs.squid-cache.org/show_bug.cgi?id=4051
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2014/04/24 14:26:21 sthen Exp $
d4 1
a4 1
REVISION=	0
@


1.7
log
@update squid/stable to 3.4.4.2, move some now-common pieces up into
squid/Makefile.inc, and regen PLISTs with @@commented pieces from PLIST-ntlm
to avoid problems with future regens if samba is installed.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2014/04/21 20:29:50 sthen Exp $
d4 1
@


1.6
log
@disable kerberos
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2014/04/09 19:47:51 sthen Exp $
d3 1
a3 2
V=		3.4.4
REVISION=	1
@


1.5
log
@missed a bump when I moved this from snapshots/ to stable/, thanks naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2014/04/08 12:22:48 sthen Exp $
d4 1
a4 1
REVISION=	0
d7 1
a7 1
		unix_group wbinfo_group # kerberos_ldap_group (sasl/gssapi)
@


1.4
log
@switch squid/stable to the 3.4 branch, and update squid/snapshot to a
recent snapshot from the 3.5 branch
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2014/03/16 13:15:12 sthen Exp $
d4 1
@


1.3
log
@update to squid-3.3.12, security fix for CVE-2014-0128 in HTTPS request
handling, only affects users who have enabled the "ssl-bump" MITM feature.

workarounds at
http://www.squid-cache.org/Advisories/SQUID-2014_1.txt
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2013/12/07 10:47:20 sthen Exp $
d3 1
a3 1
V=		3.3.12
d5 5
a9 2
EXTERNAL_ACL=	SQL_session file_userip time_quota session unix_group \
		wbinfo_group # kerberos_ldap_group (requires sasl)
@


1.2
log
@update to squid 3.3.11
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1 2013/11/15 19:09:17 sthen Exp $
d3 1
a3 1
V=		3.3.11
@


1.2.2.1
log
@SECURITY update to squid 3.3.13 - clients can perform a DoS due to
incorrect input validation in range checking.

http://www.squid-cache.org/Advisories/SQUID-2014_2.txt
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2013/12/07 10:47:20 sthen Exp $
d3 1
a3 1
V=		3.3.13
@


1.1
log
@Update to squid-3.3.10 and reorganise the squid ports; retire squid-2.7
(it was kept separately because 3.x didn't build on some arch due to an
incomplete atomic ops autoconf check which has since been repaired) and
replace with 3.4 (devel version). Enable additional helpers and turn on
support for rock cache dirs.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.164 2013/09/17 16:56:24 sthen Exp $
d3 1
a3 1
V=		3.3.10
@

