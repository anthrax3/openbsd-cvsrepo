head	1.2;
access;
symbols
	OPENBSD_4_7:1.1.0.4
	OPENBSD_4_7_BASE:1.1
	OPENBSD_4_6:1.1.0.2;
locks; strict;
comment	@# @;


1.2
date	2010.06.18.10.32.17;	author sthen;	state dead;
branches;
next	1.1;

1.1
date	2010.02.03.06.41.17;	author jasper;	state Exp;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2010.02.09.03.07.43;	author william;	state Exp;
branches;
next	;


desc
@@


1.2
log
@update to 2.7.STABLE9, from Brad (maintainer)
@
text
@$OpenBSD: patch-lib_rfc1035_c,v 1.1 2010/02/03 06:41:17 jasper Exp $

Security fix for CVE-2010-0308, "Squid DNS Packet Processing
Denial of Service Vulnerability"

Patch from upstream svn, changeset 12597.

--- lib/rfc1035.c.orig	Tue Feb  2 14:50:56 2010
+++ lib/rfc1035.c	Tue Feb  2 14:51:24 2010
@@@@ -286,7 +286,9 @@@@ rfc1035NameUnpack(const char *buf, size_t sz, int *off
     size_t len;
     assert(ns > 0);
     do {
-	assert((*off) < sz);
+	if ((*off) >= sz) {
+	    return 1;
+	}
 	c = *(buf + (*off));
 	if (c > 191) {
 	    /* blasted compression */
@


1.1
log
@SECURITY FIX for CVE-2010-0308, "Squid DNS Packet Processing
Denial of Service Vulnerability"

brad (MAINTAINER) came up with the same diff
ok ajacoutot@@ sthen@@
@
text
@d1 1
a1 1
$OpenBSD$
@


1.1.2.1
log
@MFC:

SECURITY FIX

Resolves:  CVE-2009-2855, CVE-2010-0308, and bugfixes

ok Brad jasper@@
@
text
@d1 1
a1 1
$OpenBSD: patch-lib_rfc1035_c,v 1.1 2010/02/03 06:41:17 jasper Exp $
@

