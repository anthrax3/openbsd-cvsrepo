head	1.33;
access;
symbols
	OPENBSD_5_2:1.31.0.8
	OPENBSD_5_2_BASE:1.31
	OPENBSD_5_1_BASE:1.31
	OPENBSD_5_1:1.31.0.6
	OPENBSD_5_0:1.31.0.4
	OPENBSD_5_0_BASE:1.31
	OPENBSD_4_9:1.31.0.2
	OPENBSD_4_9_BASE:1.31
	OPENBSD_4_8:1.29.0.2
	OPENBSD_4_8_BASE:1.29
	OPENBSD_4_7:1.28.0.6
	OPENBSD_4_7_BASE:1.28
	OPENBSD_4_6:1.28.0.4
	OPENBSD_4_6_BASE:1.28
	OPENBSD_4_5:1.28.0.2
	OPENBSD_4_5_BASE:1.28
	OPENBSD_4_4:1.27.0.2
	OPENBSD_4_4_BASE:1.27
	OPENBSD_4_3:1.25.0.2
	OPENBSD_4_3_BASE:1.25
	OPENBSD_4_2:1.24.0.2
	OPENBSD_4_2_BASE:1.24
	OPENBSD_4_1:1.23.0.2
	OPENBSD_4_1_BASE:1.23
	OPENBSD_4_0:1.20.0.2
	OPENBSD_4_0_BASE:1.20
	OPENBSD_3_9:1.18.0.2
	OPENBSD_3_9_BASE:1.18
	OPENBSD_3_8:1.16.0.2
	OPENBSD_3_8_BASE:1.16
	OPENBSD_3_7:1.15.0.2
	OPENBSD_3_7_BASE:1.15
	OPENBSD_3_6:1.14.0.2
	OPENBSD_3_6_BASE:1.14
	OPENBSD_3_5:1.8.0.4
	OPENBSD_3_5_BASE:1.8
	OPENBSD_3_4:1.8.0.2
	OPENBSD_3_4_BASE:1.8
	OPENBSD_3_3:1.6.0.4
	OPENBSD_3_3_BASE:1.6
	OPENBSD_3_2:1.6.0.2
	OPENBSD_3_2_BASE:1.6
	OPENBSD_3_1:1.2.0.2
	OPENBSD_3_1_BASE:1.2;
locks; strict;
comment	@# @;


1.33
date	2012.11.28.17.45.29;	author sthen;	state dead;
branches;
next	1.32;

1.32
date	2012.08.27.06.19.48;	author ajacoutot;	state Exp;
branches;
next	1.31;

1.31
date	2010.11.29.23.06.39;	author dcoppa;	state Exp;
branches;
next	1.30;

1.30
date	2010.11.26.13.45.04;	author dcoppa;	state Exp;
branches;
next	1.29;

1.29
date	2010.06.18.10.32.17;	author sthen;	state Exp;
branches;
next	1.28;

1.28
date	2008.08.20.16.35.15;	author brad;	state Exp;
branches;
next	1.27;

1.27
date	2008.07.16.21.18.27;	author brad;	state Exp;
branches;
next	1.26;

1.26
date	2008.05.31.10.07.45;	author jasper;	state Exp;
branches;
next	1.25;

1.25
date	2007.09.10.17.49.23;	author merdely;	state Exp;
branches;
next	1.24;

1.24
date	2007.05.20.00.52.32;	author todd;	state Exp;
branches;
next	1.23;

1.23
date	2007.02.01.07.46.24;	author todd;	state Exp;
branches;
next	1.22;

1.22
date	2006.11.13.02.11.39;	author brad;	state Exp;
branches;
next	1.21;

1.21
date	2006.10.03.05.00.49;	author brad;	state Exp;
branches;
next	1.20;

1.20
date	2006.06.19.11.49.26;	author bernd;	state Exp;
branches;
next	1.19;

1.19
date	2006.06.17.03.15.55;	author brad;	state Exp;
branches;
next	1.18;

1.18
date	2005.10.29.23.26.39;	author brad;	state Exp;
branches;
next	1.17;

1.17
date	2005.09.25.17.03.32;	author brad;	state Exp;
branches;
next	1.16;

1.16
date	2005.05.25.02.27.13;	author brad;	state Exp;
branches;
next	1.15;

1.15
date	2004.10.20.21.44.21;	author brad;	state Exp;
branches;
next	1.14;

1.14
date	2004.07.11.17.00.47;	author brad;	state Exp;
branches;
next	1.13;

1.13
date	2004.06.11.08.00.36;	author brad;	state Exp;
branches;
next	1.12;

1.12
date	2004.06.02.21.40.00;	author brad;	state Exp;
branches;
next	1.11;

1.11
date	2004.04.16.00.39.03;	author brad;	state Exp;
branches;
next	1.10;

1.10
date	2004.04.13.00.40.47;	author brad;	state Exp;
branches;
next	1.9;

1.9
date	2004.04.06.05.35.59;	author miod;	state Exp;
branches;
next	1.8;

1.8
date	2003.07.07.17.44.44;	author brad;	state Exp;
branches
	1.8.2.1
	1.8.4.1;
next	1.7;

1.7
date	2003.05.13.20.12.03;	author brad;	state Exp;
branches;
next	1.6;

1.6
date	2002.08.23.14.10.20;	author brad;	state Exp;
branches;
next	1.5;

1.5
date	2002.07.24.18.14.09;	author brad;	state Exp;
branches;
next	1.4;

1.4
date	2002.06.30.18.29.22;	author brad;	state Exp;
branches;
next	1.3;

1.3
date	2002.04.17.18.03.21;	author brad;	state Exp;
branches;
next	1.2;

1.2
date	2002.03.19.15.20.07;	author brad;	state Exp;
branches
	1.2.2.1;
next	1.1;

1.1
date	2002.02.20.01.17.03;	author brad;	state Exp;
branches;
next	;

1.2.2.1
date	2002.06.30.18.36.34;	author brad;	state Exp;
branches;
next	;

1.8.2.1
date	2004.04.16.01.03.59;	author brad;	state Exp;
branches;
next	;

1.8.4.1
date	2004.05.06.00.54.15;	author brad;	state Exp;
branches;
next	1.8.4.2;

1.8.4.2
date	2005.01.30.08.43.21;	author sturm;	state Exp;
branches;
next	;


desc
@@


1.33
log
@Update to Squid 3.2.3.

This is merged from work by myself and Matthias Pitzl @@ genua, thanks to
Rodolfo Gouveia for testing with NTLM.

Flavours have been removed:

- the external helper programs for NTLM/LDAP are now in subpackages:
squid-ldap and squid-ntlm.

- SNMP support is built by default in Squid 3.x so this has moved
to the main package (no external dependencies for this).
@
text
@$OpenBSD: patch-configure_in,v 1.32 2012/08/27 06:19:48 ajacoutot Exp $
--- configure.in.orig	Tue Mar 16 20:10:12 2010
+++ configure.in	Fri Aug 17 00:44:48 2012
@@@@ -17,11 +17,6 @@@@ AM_MAINTAINER_MODE
 PRESET_CFLAGS="$CFLAGS"
 PRESET_LDFLAGS="$LDFLAGS"
 
-dnl Set default LDFLAGS
-if test -z "$LDFLAGS"; then
-	LDFLAGS="-g"
-fi
-
 dnl Check for GNU cc
 AC_PROG_CC
 AM_PROG_CC_C_O
@@@@ -2350,18 +2345,6 @@@@ dnl during compile.
 		;;
 esac
 
-# Remove optimization for GCC 2.95.[123]
-# gcc -O[2] on *BSD and Linux (x86) causes pointers to magically become NULL
-if test "$GCC" = "yes"; then
-	GCCVER=`$CC -v 2>&1 | awk '$2 ==  "version" {print $3}'`
-	case "$GCCVER" in
-	[2.95.[123]])
-		echo "Removing -O for gcc on $host with GCC $GCCVER"
-		CFLAGS="`echo $CFLAGS | sed -e 's/-O[[0-9]]*//'`"
-		;;
-	esac
-fi
-
 # Recommended by Balint Nagy Endre <bne@@CareNet.hu>
 case "$host" in
 	*-univel-sysv4.2MP)
@@@@ -2906,12 +2889,14 @@@@ AC_ARG_WITH(maxfd,
     ;;
   esac
 ])
+
+TLDFLAGS="$LDFLAGS"
+
 if test -z "$SQUID_MAXFD"; then
 
 dnl Not cached since people are likely to tune this
 AC_MSG_CHECKING(Maximum number of filedescriptors we can open)
 dnl damn! FreeBSD's pthreads breaks dup2().
-TLDFLAGS="$LDFLAGS"
 case $host in
 i386-unknown-freebsd*)
     if echo "$LDFLAGS" | grep -q pthread; then
@


1.32
log
@Remove -pthread patching.

from Brad
@
text
@d1 1
a1 1
$OpenBSD: patch-configure_in,v 1.31 2010/11/29 23:06:39 dcoppa Exp $
@


1.31
log
@I accidentally broke the ldap flavor. Mea culpa.

Pointed out by espie@@
@
text
@d1 3
a3 3
$OpenBSD: patch-configure_in,v 1.30 2010/11/26 13:45:04 dcoppa Exp $
--- configure.in.orig	Wed Mar 17 01:10:12 2010
+++ configure.in	Mon Nov 29 21:43:13 2010
d16 1
a16 23
@@@@ -2216,11 +2211,9 @@@@ dnl We use pthreads when doing ASYNC I/O
 if test "$with_pthreads" = "yes"; then
     CFLAGS="$CFLAGS -D_REENTRANT"
     case "$host" in
-    i386-unknown-freebsd*)
+    i386-unknown-freebsd*|*-unknown-openbsd*)
 	if test "$GCC" = "yes" ; then
-	    if test -z "$PRESET_LDFLAGS"; then
-		LDFLAGS="$LDFLAGS -pthread"
-	    fi
+	    LDFLAGS="$LDFLAGS -pthread"
 	fi
     ;;
     *-solaris2.*)
@@@@ -2231,7 +2224,6 @@@@ if test "$with_pthreads" = "yes"; then
 	fi
     ;;
     esac
-    AC_CHECK_LIB(pthread, pthread_create)
 fi
 
 dnl Check for librt
@@@@ -2350,18 +2342,6 @@@@ dnl during compile.
d35 1
a35 1
@@@@ -2906,12 +2886,14 @@@@ AC_ARG_WITH(maxfd,
@


1.30
log
@Add ntlm flavor for NTLM authentication
Fix pthread linkage
Fix default path for errors directory
Switch to pkg-readmes
Add an rcscript

OK giovanni@@, Brad (MAINTAINER)
@
text
@d1 1
a1 1
$OpenBSD: patch-configure_in,v 1.29 2010/06/18 10:32:17 sthen Exp $
d3 14
a16 2
+++ configure.in	Tue Nov 23 10:08:37 2010
@@@@ -2216,7 +2216,7 @@@@ dnl We use pthreads when doing ASYNC I/O
d23 8
a30 3
 	    if test -z "$PRESET_LDFLAGS"; then
 		LDFLAGS="$LDFLAGS -pthread"
@@@@ -2231,7 +2231,6 @@@@ if test "$with_pthreads" = "yes"; then
d38 1
a38 1
@@@@ -2350,18 +2349,6 @@@@ dnl during compile.
d57 1
a57 1
@@@@ -2906,12 +2893,14 @@@@ AC_ARG_WITH(maxfd,
@


1.29
log
@update to 2.7.STABLE9, from Brad (maintainer)
@
text
@d1 21
a21 4
$OpenBSD: patch-configure_in,v 1.28 2008/08/20 16:35:15 brad Exp $
--- configure.in.orig	Tue Mar 16 20:10:12 2010
+++ configure.in	Thu Jun 17 22:13:14 2010
@@@@ -2350,18 +2350,6 @@@@ dnl during compile.
d40 1
a40 1
@@@@ -2906,12 +2894,14 @@@@ AC_ARG_WITH(maxfd,
@


1.28
log
@Upgrade Squid to 2.7-STABLE4

ok ajacoutot@@
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.27 2008/07/16 21:18:27 brad Exp $
--- configure.in.orig	Fri Aug  8 15:21:03 2008
+++ configure.in	Fri Aug  8 22:44:09 2008
@@@@ -2293,18 +2293,6 @@@@ dnl during compile.
d23 1
a23 1
@@@@ -2844,12 +2832,14 @@@@ AC_ARG_WITH(maxfd,
@


1.27
log
@Upgrade Squid to 2.7-STABLE3.

ok okan@@
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.26 2008/05/31 10:07:45 jasper Exp $
--- configure.in.orig	Wed Jun 25 18:18:55 2008
+++ configure.in	Sun Jun 29 03:10:24 2008
@@@@ -2286,18 +2286,6 @@@@ dnl during compile.
d23 1
a23 1
@@@@ -2836,12 +2824,14 @@@@ AC_ARG_WITH(maxfd,
@


1.26
log
@- update squid to 2.6STABLE20
- update license marker
- remove transparent flavor
- add ldap flavor

from brad@@ (MAINTAINER), testing by several users
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.25 2007/09/10 17:49:23 merdely Exp $
--- configure.in.orig	Thu Jan 10 07:34:23 2008
+++ configure.in	Wed Apr  9 17:00:51 2008
@@@@ -2248,18 +2248,6 @@@@ dnl during compile.
d23 1
a23 1
@@@@ -2790,12 +2778,14 @@@@ AC_ARG_WITH(maxfd,
@


1.25
log
@Update to Squid 2.6.STABLE16.

From brad (MAINTAINER)
ok sthen@@
@
text
@d1 3
a3 3
$OpenBSD: patch-configure_in,v 1.24 2007/05/20 00:52:32 todd Exp $
--- configure.in.orig	Wed Sep  5 18:25:42 2007
+++ configure.in	Wed Sep  5 21:01:07 2007
d23 16
@


1.24
log
@update to 2.6 stable13, from brad@@ (maint)
ok kili@@ tested by me
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.23 2007/02/01 07:46:24 todd Exp $
--- configure.in.orig	Thu May 10 19:59:36 2007
+++ configure.in	Sat May 12 23:44:43 2007
@@@@ -2231,18 +2231,6 @@@@ dnl during compile.
@


1.23
log
@bugfix maintenance release update for Squid.
from maint brad@@
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.22 2006/11/13 02:11:39 brad Exp $
--- configure.in.orig	Tue Jan 23 21:07:43 2007
+++ configure.in	Wed Jan 24 02:12:02 2007
@@@@ -2230,18 +2230,6 @@@@ dnl during compile.
@


1.22
log
@upgrade to 2.6.STABLE5
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.21 2006/10/03 05:00:49 brad Exp $
--- configure.in.orig	Fri Nov  3 08:20:14 2006
+++ configure.in	Sat Nov  4 15:50:31 2006
@@@@ -2228,18 +2228,6 @@@@ dnl during compile.
@


1.21
log
@upgrade to 2.6.STABLE4

Squid 2.6 supports kqueue and hw accelerated SSL via OpenSSL,
as well as many other improvements.
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.20 2006/06/19 11:49:26 bernd Exp $
--- configure.in.orig	Sat Sep 23 13:49:33 2006
+++ configure.in	Tue Sep 26 19:32:47 2006
@@@@ -2205,18 +2205,6 @@@@ dnl during compile.
@


1.20
log
@Back out change with no review.

ok espie@@, pvalchev@@
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.18 2005/10/29 23:26:39 brad Exp $
--- configure.in.orig	Sat Oct 22 05:56:01 2005
+++ configure.in	Tue Oct 25 21:27:31 2005
@@@@ -1735,18 +1735,6 @@@@ dnl during compile.
@


1.19
log
@upgrade to 2.5.STABLE14
@
text
@d2 3
a4 3
--- configure.in.orig	Sat May 20 09:43:18 2006
+++ configure.in	Fri Jun 16 22:21:26 2006
@@@@ -1736,18 +1736,6 @@@@ dnl during compile.
@


1.18
log
@upgrade to 2.5.STABLE12

- [Major] Error introduced in 2.5.STABLE11 causing truncated responses
  when using delay pools (Bug #1405)
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.17 2005/09/25 17:03:32 brad Exp $
--- configure.in.orig	Sat Oct 22 05:56:01 2005
+++ configure.in	Tue Oct 25 21:27:31 2005
@@@@ -1735,18 +1735,6 @@@@ dnl during compile.
@


1.17
log
@upgrade to 2.5.STABLE11

Alex Masterov has reported a vulnerability in Squid,
which potentially can be exploited by malicious people
to cause a DoS.

The vulnerability is caused due to an unspecified error
in the "sslConnectTimeout()" function after handling
malformed requests. This may be exploited to crash Squid.

CAN-2005-2796
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.16 2005/05/25 02:27:13 brad Exp $
--- configure.in.orig	Fri Sep 16 18:11:37 2005
+++ configure.in	Mon Sep 19 11:02:26 2005
@@@@ -1733,18 +1733,6 @@@@ dnl during compile.
@


1.16
log
@upgrade to 2.5.STABLE10

- Malicious users may spoof DNS lookups if the DNS client UDP port (random,
  assigned by OS at startup) is unfiltered and your network is not protected
  from IP spoofing.
- CVE-1999-0710, adds access controls to the cachemgr.cgi script, preventing
  it from being abused to reach other servers than allowed in a local
  configuration file.
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.15 2004/10/20 21:44:21 brad Exp $
--- configure.in.orig	Mon May 16 18:41:14 2005
+++ configure.in	Wed May 18 18:10:12 2005
@@@@ -1710,18 +1710,6 @@@@ dnl during compile.
@


1.15
log
@upgrade to Squid 2.5.STABLE7

A parsing error exists in the SNMP module of Squid where a
specially-crafted UDP packet can potentially cause the server to
restart, closing all current connections.
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.14 2004/07/11 17:00:47 brad Exp $
--- configure.in.orig	Mon Oct 11 16:27:03 2004
+++ configure.in	Wed Oct 20 16:43:07 2004
@@@@ -1633,18 +1633,6 @@@@ dnl during compile.
@


1.14
log
@upgrade to Squid 2.5.STABLE6
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.13 2004/06/11 08:00:36 brad Exp $
--- configure.in.orig	Thu Jul  8 19:44:39 2004
+++ configure.in	Sun Jul 11 12:23:13 2004
@@@@ -1631,18 +1631,6 @@@@ dnl during compile.
@


1.13
log
@- add 2 more distribution patches
- add snmp FLAVOR from Joel CARNAT <joel at carnat dot net>
- add some auth types and auth/acl helpers
- add NTLM auth SMB patch even though the default port does NOT compile this support in
@
text
@d1 4
a4 13
$OpenBSD: patch-configure_in,v 1.12 2004/06/02 21:40:00 brad Exp $
--- configure.in.orig	2004-06-11 02:24:20.000000000 -0400
+++ configure.in	2004-06-11 02:25:12.000000000 -0400
@@@@ -9,7 +9,7 @@@@ dnl
 dnl
 AC_INIT(src/main.c)
 AC_CONFIG_AUX_DIR(cfgaux)
-AM_INIT_AUTOMAKE(squid, 2.5.STABLE5-CVS)
+AM_INIT_AUTOMAKE(squid, 2.5.STABLE5)
 AM_CONFIG_HEADER(include/autoconf.h)
 AC_REVISION($Revision: 1.251.2.51 $)dnl
 AC_PREFIX_DEFAULT(/usr/local/squid)
@@@@ -1607,18 +1607,6 @@@@ dnl during compile.
@


1.12
log
@more distribution patches
@
text
@d1 3
a3 3
$OpenBSD: patch-configure_in,v 1.11 2004/04/16 00:39:03 brad Exp $
--- configure.in.orig	2004-06-02 16:44:09.000000000 -0400
+++ configure.in	2004-06-02 16:44:38.000000000 -0400
@


1.11
log
@sync
@
text
@d1 3
a3 3
$OpenBSD: patch-configure_in,v 1.10 2004/04/13 00:40:47 brad Exp $
--- configure.in.orig	2004-02-29 17:30:21.000000000 -0500
+++ configure.in	2004-04-15 20:37:51.000000000 -0400
d13 1
a13 19
@@@@ -85,6 +85,8 @@@@ if test -z "$PRESET_CFLAGS"; then
     	    # sunos has too many warnings for this to be useful
 	    # motorola too
     	    ;;
+	*m88k*-openbsd*)
+	    ;;
 	*m88k*)
 	    # Motorola cc/ld does not like -02 but is ok on -O
 	    CFLAGS=`echo $CFLAGS | sed -e 's/-O[0-9]/-O/'`
@@@@ -1591,6 +1593,8 @@@@ dnl during compile.
 			;;
 		esac
 		;;
+	*m88k*-openbsd*)
+		;;
 	*m88k*)
 		CFLAGS="$CFLAGS -D_SQUID_MOTOROLA_"
 		AC_DEFINE(GETTIMEOFDAY_NO_TZP)
@@@@ -1603,18 +1607,6 @@@@ dnl during compile.
@


1.10
log
@- add some distribution patches. From: Robert Nagy <thuglife at bsd dot hu>
- only apply optimization workaround for gcc if using 2.95
@
text
@d1 1
a1 1
$OpenBSD$
d3 1
a3 1
+++ configure.in	2004-04-12 19:23:44.000000000 -0400
@


1.9
log
@Tell squid that m88k does not imply SysV; maintainer ok
@
text
@d1 12
a12 3
$OpenBSD: patch-configure_in,v 1.8 2003/07/07 17:44:44 brad Exp $
--- configure.in.orig	2004-02-29 22:30:21.000000000 +0000
+++ configure.in	2004-04-05 19:34:26.000000000 +0000
@


1.8
log
@upgrade to Squid 2.5.STABLE3

throw in the SSL gatewaying support, this is not enabled by default.
@
text
@d1 22
a22 4
$OpenBSD: patch-configure_in,v 1.7 2003/05/13 20:12:03 brad Exp $
--- configure.in.orig	Sun May 25 09:04:25 2003
+++ configure.in	Fri May 30 10:17:30 2003
@@@@ -1603,18 +1603,6 @@@@ dnl during compile.
@


1.8.4.1
log
@MFC:
upgrade to Squid 2.5.STABLE5 + latest patches

A bug in Squid that allows users to bypass certain access controls.
Squid versions 2.5.STABLE4 and earlier contain a bug in the "%xx"
URL decoding function. It may insert a NULL character into decoded
URLs, which may allow users to bypass url_regex ACLs.

http://www.squid-cache.org/Advisories/SQUID-2004_1.txt

and

Add 2 more distribution patches. One of them fixes an issue if using
Digest authentication. Users can crash Squid with a segmentation fault
simply by entering a blank user name.
@
text
@d1 4
a4 31
$OpenBSD: patch-configure_in,v 1.11 2004/04/16 00:39:03 brad Exp $
--- configure.in.orig	2004-02-29 17:30:21.000000000 -0500
+++ configure.in	2004-04-15 20:37:51.000000000 -0400
@@@@ -9,7 +9,7 @@@@ dnl
 dnl
 AC_INIT(src/main.c)
 AC_CONFIG_AUX_DIR(cfgaux)
-AM_INIT_AUTOMAKE(squid, 2.5.STABLE5-CVS)
+AM_INIT_AUTOMAKE(squid, 2.5.STABLE5)
 AM_CONFIG_HEADER(include/autoconf.h)
 AC_REVISION($Revision: 1.11 $)dnl
 AC_PREFIX_DEFAULT(/usr/local/squid)
@@@@ -85,6 +85,8 @@@@ if test -z "$PRESET_CFLAGS"; then
     	    # sunos has too many warnings for this to be useful
 	    # motorola too
     	    ;;
+	*m88k*-openbsd*)
+	    ;;
 	*m88k*)
 	    # Motorola cc/ld does not like -02 but is ok on -O
 	    CFLAGS=`echo $CFLAGS | sed -e 's/-O[0-9]/-O/'`
@@@@ -1591,6 +1593,8 @@@@ dnl during compile.
 			;;
 		esac
 		;;
+	*m88k*-openbsd*)
+		;;
 	*m88k*)
 		CFLAGS="$CFLAGS -D_SQUID_MOTOROLA_"
 		AC_DEFINE(GETTIMEOFDAY_NO_TZP)
@@@@ -1603,18 +1607,6 @@@@ dnl during compile.
@


1.8.4.2
log
@MFC:

upgrade to Squid 2.5.STABLE7

A parsing error exists in the SNMP module of Squid where a
specially-crafted UDP packet can potentially cause the server to
restart, closing all current connections.

---
Fix 2 security issues...

A bug exists in the code that parses responses from Gopher servers.
The bug results in a buffer overflow if a Gopher server returns a
line longer than 4096 bytes.  The overflow results in memory
corruption and usually crashes Squid.

CAN-2005-0094

A bug exists in the code that parses WCCP messages.  An attacker
that sends a malformed WCCP messages, with a spoofed source address
matching Squid's "home router" can crash Squid.

CAN-2005-0095

ok brad@@
@
text
@d1 1
a1 1
$OpenBSD: patch-configure_in,v 1.8.4.1 2004/05/06 00:54:15 brad Exp $
d4 27
@


1.8.2.1
log
@MFC:
upgrade to Squid 2.5.STABLE5 + latest patches

A bug in Squid that allows users to bypass certain access controls.
Squid versions 2.5.STABLE4 and earlier contain a bug in the "%xx"
URL decoding function. It may insert a NULL character into decoded
URLs, which may allow users to bypass url_regex ACLs.

http://www.squid-cache.org/Advisories/SQUID-2004_1.txt
@
text
@d1 4
a4 31
$OpenBSD: patch-configure_in,v 1.10 2004/04/13 00:40:47 brad Exp $
--- configure.in.orig	2004-02-29 17:30:21.000000000 -0500
+++ configure.in	2004-04-15 20:35:02.000000000 -0400
@@@@ -9,7 +9,7 @@@@ dnl
 dnl
 AC_INIT(src/main.c)
 AC_CONFIG_AUX_DIR(cfgaux)
-AM_INIT_AUTOMAKE(squid, 2.5.STABLE5-CVS)
+AM_INIT_AUTOMAKE(squid, 2.5.STABLE5)
 AM_CONFIG_HEADER(include/autoconf.h)
 AC_REVISION($Revision: 1.251.2.51 $)dnl
 AC_PREFIX_DEFAULT(/usr/local/squid)
@@@@ -85,6 +85,8 @@@@ if test -z "$PRESET_CFLAGS"; then
     	    # sunos has too many warnings for this to be useful
 	    # motorola too
     	    ;;
+	*m88k*-openbsd*)
+	    ;;
 	*m88k*)
 	    # Motorola cc/ld does not like -02 but is ok on -O
 	    CFLAGS=`echo $CFLAGS | sed -e 's/-O[0-9]/-O/'`
@@@@ -1591,6 +1593,8 @@@@ dnl during compile.
 			;;
 		esac
 		;;
+	*m88k*-openbsd*)
+		;;
 	*m88k*)
 		CFLAGS="$CFLAGS -D_SQUID_MOTOROLA_"
 		AC_DEFINE(GETTIMEOFDAY_NO_TZP)
@@@@ -1603,18 +1607,6 @@@@ dnl during compile.
@


1.7
log
@upgrade to Squid 2.5.STABLE2
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.6 2002/08/23 14:10:20 brad Exp $
--- configure.in.orig	Mon Mar 17 12:00:14 2003
+++ configure.in	Mon May 12 07:03:16 2003
@@@@ -1593,18 +1593,6 @@@@ dnl during compile.
@


1.6
log
@upgrade to Squid 2.5.PRE11
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.5 2002/07/24 18:14:09 brad Exp $
--- configure.in.orig	Fri Aug 23 04:48:33 2002
+++ configure.in	Fri Aug 23 09:28:07 2002
@@@@ -1554,18 +1554,6 @@@@ dnl during compile.
@


1.5
log
@upgrade to Squid 2.5.PRE10
- The squid binary has been moved from bin/ to sbin/
- The cachemgr CGI is statically linked now
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.4 2002/06/30 18:29:22 brad Exp $
--- configure.in.orig	Sun Jul 21 20:27:03 2002
+++ configure.in	Tue Jul 23 18:04:18 2002
@@@@ -1522,18 +1522,6 @@@@ dnl during compile.
@


1.4
log
@upgrade to Squid 2.5.PRE8
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.3 2002/04/17 18:03:21 brad Exp $
--- configure.in.orig	Wed Jun 26 12:30:32 2002
+++ configure.in	Wed Jun 26 18:46:01 2002
@@@@ -1493,18 +1493,6 @@@@ dnl during compile.
@


1.3
log
@upgrade to Squid 2.5.PRE6
- PF patches integrated
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.2 2002/03/19 15:20:07 brad Exp $
--- configure.in.orig	Sun Apr 14 18:31:20 2002
+++ configure.in	Wed Apr 17 13:19:18 2002
@@@@ -1492,18 +1492,6 @@@@ dnl during compile.
@


1.2
log
@remove section which disables optimization, our compiler does not seem to have this bug. also fixes build on powerpc.
@
text
@d1 4
a4 31
$OpenBSD: patch-configure_in,v 1.1 2002/02/20 01:17:03 brad Exp $
--- configure.in.orig	Thu Feb 14 14:10:34 2002
+++ configure.in	Sat Mar 16 12:34:28 2002
@@@@ -704,6 +704,18 @@@@ AC_ARG_ENABLE(ipf-transparent,
   fi
 ])
 
+dnl Enable PF Transparent Proxy
+AC_ARG_ENABLE(pf-transparent,
+[  --enable-pf-transparent
+                          Enable Transparent Proxy support for systems
+                          using PF network address redirection.],
+[ if test "$enableval" = "yes" ; then
+	echo "PF Transparent Proxy enabled"
+	AC_DEFINE(PF_TRANSPARENT)
+	PF_TRANSPARENT="yes"
+  fi
+])
+
 dnl Enable Linux Netfilter (2.4) Transparent Proxy
 AC_ARG_ENABLE(linux-netfilter,
 [  --enable-linux-netfilter
@@@@ -1067,6 +1079,7 @@@@ AC_CHECK_HEADERS( \
 	memory.h \
 	mount.h \
 	net/if.h \
+	net/pfvar.h \
 	netdb.h \
 	netinet/if_ether.h \
 	netinet/in.h \
@@@@ -1454,18 +1467,6 @@@@ dnl during compile.
a22 26
@@@@ -1620,6 +1621,25 @@@@ if test "$IPF_TRANSPARENT" ; then
 fi 
 if test "$IPF_TRANSPARENT" = "no" ; then
     echo "WARNING: Cannot find necessary IP-Filter header files"
+    echo "         Transparent Proxy support WILL NOT be enabled"
+    sleep 10
+fi
+
+dnl PF support requires a header file.
+if test "$PF_TRANSPARENT" ; then
+    AC_MSG_CHECKING(if PF header file is installed)
+    # hold on to your hats...
+    if test "$ac_cv_header_net_pfvar_h" = "yes"; then
+        PF_TRANSPARENT="yes"
+        AC_DEFINE(PF_TRANSPARENT, 1)
+    else
+        PF_TRANSPARENT="no"
+        AC_DEFINE(PF_TRANSPARENT, 0)
+    fi
+    AC_MSG_RESULT($PF_TRANSPARENT)
+fi
+if test "$PF_TRANSPARENT" = "no" ; then
+    echo "WARNING: Cannot find necessary PF header file"
     echo "         Transparent Proxy support WILL NOT be enabled"
     sleep 10
 fi
@


1.2.2.1
log
@MFC: SECURITY FIXES.
upgrade to Squid 2.5.PRE8
@
text
@d1 31
a31 4
$OpenBSD: patch-configure_in,v 1.4 2002/06/30 18:29:22 brad Exp $
--- configure.in.orig	Wed Jun 26 12:30:32 2002
+++ configure.in	Wed Jun 26 18:46:01 2002
@@@@ -1493,18 +1493,6 @@@@ dnl during compile.
d50 26
@


1.1
log
@upgrade to Squid 2.5.PRE4
- The port now runs as uid/gid of nobody:nobody instead of www:www
- This needs some testing, especially the transparent proxy support for PF
@
text
@d1 3
a3 3
$OpenBSD$
--- configure.in.orig	Wed Feb  6 19:20:15 2002
+++ configure.in	Wed Feb  6 19:31:03 2002
d31 20
a50 1
@@@@ -1620,6 +1633,25 @@@@ if test "$IPF_TRANSPARENT" ; then
@

