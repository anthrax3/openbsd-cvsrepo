head	1.198;
access;
symbols
	OPENBSD_6_1:1.193.0.2
	OPENBSD_6_1_BASE:1.193
	OPENBSD_6_0:1.187.0.2
	OPENBSD_6_0_BASE:1.187
	OPENBSD_5_9:1.177.0.2
	OPENBSD_5_9_BASE:1.177
	OPENBSD_5_8:1.168.0.6
	OPENBSD_5_8_BASE:1.168
	OPENBSD_5_7:1.168.0.2
	OPENBSD_5_7_BASE:1.168
	OPENBSD_5_6:1.166.0.4
	OPENBSD_5_6_BASE:1.166
	OPENBSD_5_5:1.166.0.2
	OPENBSD_5_5_BASE:1.166
	OPENBSD_5_4:1.162.0.2
	OPENBSD_5_4_BASE:1.162
	OPENBSD_5_3:1.147.0.2
	OPENBSD_5_3_BASE:1.147
	OPENBSD_5_2:1.131.0.2
	OPENBSD_5_2_BASE:1.131
	OPENBSD_5_1_BASE:1.124
	OPENBSD_5_1:1.124.0.2
	OPENBSD_5_0:1.120.0.2
	OPENBSD_5_0_BASE:1.120
	OPENBSD_4_9:1.114.0.2
	OPENBSD_4_9_BASE:1.114
	OPENBSD_4_8:1.104.0.2
	OPENBSD_4_8_BASE:1.104
	OPENBSD_4_7:1.101.0.2
	OPENBSD_4_7_BASE:1.101
	OPENBSD_4_6:1.98.0.4
	OPENBSD_4_6_BASE:1.98
	OPENBSD_4_5:1.98.0.2
	OPENBSD_4_5_BASE:1.98
	OPENBSD_4_4:1.95.0.2
	OPENBSD_4_4_BASE:1.95
	OPENBSD_4_3:1.93.0.2
	OPENBSD_4_3_BASE:1.93
	OPENBSD_4_2:1.87.0.2
	OPENBSD_4_2_BASE:1.87
	OPENBSD_4_1:1.85.0.2
	OPENBSD_4_1_BASE:1.85
	OPENBSD_4_0:1.80.0.2
	OPENBSD_4_0_BASE:1.80
	OPENBSD_3_9:1.77.0.2
	OPENBSD_3_9_BASE:1.77
	OPENBSD_3_8:1.73.0.2
	OPENBSD_3_8_BASE:1.73
	OPENBSD_3_7:1.72.0.2
	OPENBSD_3_7_BASE:1.72
	OPENBSD_3_6:1.65.0.2
	OPENBSD_3_6_BASE:1.65
	OPENBSD_3_5:1.59.0.2
	OPENBSD_3_5_BASE:1.59
	OPENBSD_3_4:1.55.0.2
	OPENBSD_3_4_BASE:1.55
	OPENBSD_3_3:1.48.0.2
	OPENBSD_3_3_BASE:1.48
	OPENBSD_3_2:1.47.0.2
	OPENBSD_3_2_BASE:1.47
	OPENBSD_3_1:1.41.0.2
	OPENBSD_3_1_BASE:1.41
	OPENBSD_3_0:1.36.0.2
	OPENBSD_3_0_BASE:1.36
	OPENBSD_2_9_TRACKING_SWITCH:1.34
	OPENBSD_2_9:1.30.0.2
	OPENBSD_2_9_BASE:1.30
	OPENBSD_2_8:1.26.0.2
	OPENBSD_2_8_BASE:1.26
	OPENBSD_2_7:1.15.0.2
	OPENBSD_2_7_BASE:1.15
	OPENBSD_2_6:1.6.0.2
	OPENBSD_2_6_BASE:1.6
	OPENBSD_2_5:1.2.0.2
	OPENBSD_2_5_BASE:1.2
	OPENBSD_2_4:1.1.1.1.0.2
	OPENBSD_2_4_BASE:1.1.1.1
	marc_1998-Sep-13:1.1.1.1
	marc:1.1.1;
locks; strict;
comment	@# @;


1.198
date	2017.06.03.21.04.49;	author sthen;	state Exp;
branches;
next	1.197;
commitid	fRXWG4NclVWDfoRU;

1.197
date	2017.05.31.08.08.17;	author espie;	state Exp;
branches;
next	1.196;
commitid	ij92FtFXiSiT1ani;

1.196
date	2017.05.21.17.27.22;	author sthen;	state Exp;
branches;
next	1.195;
commitid	v807OQEi118rkymB;

1.195
date	2017.05.11.16.29.55;	author schwarze;	state Exp;
branches;
next	1.194;
commitid	5OTaKfIM9Ou9jVTO;

1.194
date	2017.04.04.21.09.30;	author sthen;	state Exp;
branches;
next	1.193;
commitid	vPpvyb7ILSW79ES0;

1.193
date	2017.02.18.17.33.51;	author ajacoutot;	state Exp;
branches;
next	1.192;
commitid	kjw4RQ4AAUYktD89;

1.192
date	2017.02.18.17.32.37;	author ajacoutot;	state Exp;
branches;
next	1.191;
commitid	bw6Y0vDo3oixdVWL;

1.191
date	2017.01.29.20.43.31;	author sthen;	state Exp;
branches;
next	1.190;
commitid	EuGWhnpdED3XpMUN;

1.190
date	2016.12.18.22.36.52;	author sthen;	state Exp;
branches;
next	1.189;
commitid	V8QmMbUuPgNIcWBI;

1.189
date	2016.10.11.13.47.44;	author sthen;	state Exp;
branches;
next	1.188;
commitid	lcCJojh1xVOCTGi8;

1.188
date	2016.09.13.19.27.11;	author sthen;	state Exp;
branches;
next	1.187;
commitid	qIPLG2RcHTYN4a1M;

1.187
date	2016.07.04.12.13.40;	author sthen;	state Exp;
branches;
next	1.186;
commitid	TtkwsTpmZY6sMHhs;

1.186
date	2016.06.11.18.10.00;	author sthen;	state Exp;
branches;
next	1.185;
commitid	Ayyd9vXiOv5RSP80;

1.185
date	2016.05.12.16.15.58;	author sthen;	state Exp;
branches;
next	1.184;
commitid	tv5Gr04by7HbfGsK;

1.184
date	2016.05.09.13.52.45;	author sthen;	state Exp;
branches;
next	1.183;
commitid	cfAon2o6L6JReZS7;

1.183
date	2016.05.07.14.06.41;	author sthen;	state Exp;
branches;
next	1.182;
commitid	nKXocldLQWG90Pu5;

1.182
date	2016.05.06.19.44.11;	author sthen;	state Exp;
branches;
next	1.181;
commitid	MwsVhrHmQL4uCXZf;

1.181
date	2016.04.20.16.36.50;	author sthen;	state Exp;
branches;
next	1.180;
commitid	hqcqnGCWjlivuEyE;

1.180
date	2016.04.02.10.44.18;	author sthen;	state Exp;
branches;
next	1.179;
commitid	d598XVKeTyBqKJIh;

1.179
date	2016.03.11.20.28.32;	author naddy;	state Exp;
branches;
next	1.178;
commitid	UYLP8TE6V7RS2GhJ;

1.178
date	2016.02.25.00.47.20;	author sthen;	state Exp;
branches;
next	1.177;
commitid	E5Vm6BHpwGs1XIYk;

1.177
date	2016.02.16.13.21.07;	author sthen;	state Exp;
branches
	1.177.2.1;
next	1.176;
commitid	PCDwyZdlmWCGxGPb;

1.176
date	2016.01.10.20.09.58;	author sthen;	state Exp;
branches;
next	1.175;
commitid	W5CLEady2tdulwVE;

1.175
date	2015.11.30.10.26.16;	author sthen;	state Exp;
branches;
next	1.174;
commitid	pxWZOh8nRyayut1w;

1.174
date	2015.11.04.15.39.55;	author sthen;	state Exp;
branches;
next	1.173;
commitid	voOXekJXqwC0zgC0;

1.173
date	2015.11.02.17.21.55;	author sthen;	state Exp;
branches;
next	1.172;
commitid	5RhKmWjnUvNSIa4L;

1.172
date	2015.10.09.00.28.56;	author sthen;	state Exp;
branches;
next	1.171;
commitid	6G9r49MksVnYH5wv;

1.171
date	2015.09.30.08.56.27;	author sthen;	state Exp;
branches;
next	1.170;
commitid	bzDcGYFhZZuhyVtp;

1.170
date	2015.09.18.11.17.04;	author sthen;	state Exp;
branches;
next	1.169;
commitid	VSVEsqoH4Bz1ZYz8;

1.169
date	2015.09.10.13.00.10;	author sthen;	state Exp;
branches;
next	1.168;
commitid	vagA8GU9rOjsV69E;

1.168
date	2015.02.06.16.30.17;	author sthen;	state Exp;
branches;
next	1.167;
commitid	FyfFFK75w7rNsk5i;

1.167
date	2015.01.06.22.50.35;	author sthen;	state Exp;
branches;
next	1.166;
commitid	xSRyY1rQKLAkMr4e;

1.166
date	2013.11.15.19.09.17;	author sthen;	state Exp;
branches;
next	1.165;

1.165
date	2013.10.31.21.12.13;	author sthen;	state Exp;
branches;
next	1.164;

1.164
date	2013.09.17.16.56.24;	author sthen;	state Exp;
branches;
next	1.163;

1.163
date	2013.08.15.11.10.16;	author sthen;	state Exp;
branches;
next	1.162;

1.162
date	2013.07.15.08.21.54;	author sthen;	state Exp;
branches;
next	1.161;

1.161
date	2013.07.11.14.28.01;	author sthen;	state Exp;
branches;
next	1.160;

1.160
date	2013.06.21.21.37.56;	author sthen;	state Exp;
branches;
next	1.159;

1.159
date	2013.06.21.01.54.55;	author lteo;	state Exp;
branches;
next	1.158;

1.158
date	2013.06.20.06.54.37;	author ajacoutot;	state Exp;
branches;
next	1.157;

1.157
date	2013.06.17.19.31.25;	author ajacoutot;	state Exp;
branches;
next	1.156;

1.156
date	2013.06.03.11.01.03;	author sthen;	state Exp;
branches;
next	1.155;

1.155
date	2013.05.25.12.33.05;	author sthen;	state Exp;
branches;
next	1.154;

1.154
date	2013.04.30.18.41.50;	author sthen;	state Exp;
branches;
next	1.153;

1.153
date	2013.04.30.14.05.51;	author sthen;	state Exp;
branches;
next	1.152;

1.152
date	2013.04.27.15.19.48;	author sthen;	state Exp;
branches;
next	1.151;

1.151
date	2013.04.25.21.29.52;	author sthen;	state Exp;
branches;
next	1.150;

1.150
date	2013.03.21.08.48.55;	author ajacoutot;	state Exp;
branches;
next	1.149;

1.149
date	2013.03.12.14.58.16;	author sthen;	state Exp;
branches;
next	1.148;

1.148
date	2013.03.11.11.44.49;	author espie;	state Exp;
branches;
next	1.147;

1.147
date	2013.02.24.11.18.38;	author espie;	state Exp;
branches
	1.147.2.1;
next	1.146;

1.146
date	2013.02.09.14.49.53;	author sthen;	state Exp;
branches;
next	1.145;

1.145
date	2013.02.07.19.13.49;	author ajacoutot;	state Exp;
branches;
next	1.144;

1.144
date	2013.02.01.17.34.33;	author sthen;	state Exp;
branches;
next	1.143;

1.143
date	2013.01.23.20.39.57;	author sthen;	state Exp;
branches;
next	1.142;

1.142
date	2013.01.22.14.30.46;	author sthen;	state Exp;
branches;
next	1.141;

1.141
date	2013.01.09.21.41.48;	author sthen;	state Exp;
branches;
next	1.140;

1.140
date	2013.01.02.12.26.58;	author sthen;	state Exp;
branches;
next	1.139;

1.139
date	2012.12.20.21.48.41;	author jasper;	state Exp;
branches;
next	1.138;

1.138
date	2012.12.17.18.56.56;	author sthen;	state Exp;
branches;
next	1.137;

1.137
date	2012.12.11.18.22.54;	author sthen;	state Exp;
branches;
next	1.136;

1.136
date	2012.12.10.21.19.41;	author sthen;	state Exp;
branches;
next	1.135;

1.135
date	2012.12.04.10.40.19;	author sthen;	state Exp;
branches;
next	1.134;

1.134
date	2012.12.03.23.10.37;	author sthen;	state Exp;
branches;
next	1.133;

1.133
date	2012.11.28.17.45.29;	author sthen;	state Exp;
branches;
next	1.132;

1.132
date	2012.08.27.06.19.48;	author ajacoutot;	state Exp;
branches;
next	1.131;

1.131
date	2012.06.30.09.32.28;	author sthen;	state Exp;
branches;
next	1.130;

1.130
date	2012.06.22.15.43.47;	author sthen;	state Exp;
branches;
next	1.129;

1.129
date	2012.06.20.08.48.27;	author sthen;	state Exp;
branches;
next	1.128;

1.128
date	2012.06.20.07.10.39;	author ajacoutot;	state Exp;
branches;
next	1.127;

1.127
date	2012.04.28.11.06.12;	author ajacoutot;	state Exp;
branches;
next	1.126;

1.126
date	2012.04.28.10.51.44;	author ajacoutot;	state Exp;
branches;
next	1.125;

1.125
date	2012.03.29.13.39.00;	author sthen;	state Exp;
branches;
next	1.124;

1.124
date	2011.09.20.19.34.59;	author sthen;	state Exp;
branches;
next	1.123;

1.123
date	2011.09.20.19.32.54;	author kili;	state Exp;
branches;
next	1.122;

1.122
date	2011.09.16.12.00.09;	author espie;	state Exp;
branches;
next	1.121;

1.121
date	2011.09.05.07.18.41;	author giovanni;	state Exp;
branches;
next	1.120;

1.120
date	2011.06.02.13.41.41;	author ajacoutot;	state Exp;
branches;
next	1.119;

1.119
date	2011.05.30.20.56.30;	author sthen;	state Exp;
branches;
next	1.118;

1.118
date	2011.05.18.14.47.55;	author sthen;	state Exp;
branches;
next	1.117;

1.117
date	2011.04.14.08.11.50;	author sthen;	state Exp;
branches;
next	1.116;

1.116
date	2011.03.27.19.38.32;	author sthen;	state Exp;
branches;
next	1.115;

1.115
date	2011.03.25.20.23.30;	author sthen;	state Exp;
branches;
next	1.114;

1.114
date	2010.12.27.14.50.24;	author ajacoutot;	state Exp;
branches;
next	1.113;

1.113
date	2010.12.24.10.40.06;	author ajacoutot;	state Exp;
branches;
next	1.112;

1.112
date	2010.12.12.18.58.32;	author jasper;	state Exp;
branches;
next	1.111;

1.111
date	2010.11.29.23.06.39;	author dcoppa;	state Exp;
branches;
next	1.110;

1.110
date	2010.11.27.11.12.12;	author dcoppa;	state Exp;
branches;
next	1.109;

1.109
date	2010.11.26.15.44.33;	author dcoppa;	state Exp;
branches;
next	1.108;

1.108
date	2010.11.26.13.45.04;	author dcoppa;	state Exp;
branches;
next	1.107;

1.107
date	2010.11.22.08.36.54;	author espie;	state Exp;
branches;
next	1.106;

1.106
date	2010.11.11.12.35.18;	author sthen;	state Exp;
branches;
next	1.105;

1.105
date	2010.10.19.08.02.57;	author espie;	state Exp;
branches;
next	1.104;

1.104
date	2010.06.18.10.32.17;	author sthen;	state Exp;
branches;
next	1.103;

1.103
date	2010.05.19.07.38.06;	author espie;	state Exp;
branches;
next	1.102;

1.102
date	2010.04.15.14.58.24;	author ajacoutot;	state Exp;
branches;
next	1.101;

1.101
date	2010.02.03.06.41.17;	author jasper;	state Exp;
branches;
next	1.100;

1.100
date	2009.10.30.00.56.57;	author sthen;	state Exp;
branches;
next	1.99;

1.99
date	2009.08.30.21.52.44;	author jasper;	state Exp;
branches;
next	1.98;

1.98
date	2009.02.08.15.04.33;	author sthen;	state Exp;
branches
	1.98.2.1
	1.98.4.1;
next	1.97;

1.97
date	2009.01.08.03.37.24;	author sthen;	state Exp;
branches;
next	1.96;

1.96
date	2008.08.20.16.35.15;	author brad;	state Exp;
branches;
next	1.95;

1.95
date	2008.07.16.21.18.27;	author brad;	state Exp;
branches;
next	1.94;

1.94
date	2008.05.31.10.07.45;	author jasper;	state Exp;
branches;
next	1.93;

1.93
date	2008.02.20.09.18.01;	author landry;	state Exp;
branches;
next	1.92;

1.92
date	2008.01.28.22.04.00;	author rui;	state Exp;
branches;
next	1.91;

1.91
date	2007.12.04.01.27.13;	author todd;	state Exp;
branches;
next	1.90;

1.90
date	2007.10.08.07.04.50;	author aanriot;	state Exp;
branches;
next	1.89;

1.89
date	2007.09.10.17.49.23;	author merdely;	state Exp;
branches;
next	1.88;

1.88
date	2007.09.01.20.11.21;	author kili;	state Exp;
branches;
next	1.87;

1.87
date	2007.05.20.00.52.32;	author todd;	state Exp;
branches;
next	1.86;

1.86
date	2007.04.12.15.10.02;	author robert;	state Exp;
branches;
next	1.85;

1.85
date	2007.02.01.07.46.24;	author todd;	state Exp;
branches;
next	1.84;

1.84
date	2007.01.13.16.13.28;	author todd;	state Exp;
branches;
next	1.83;

1.83
date	2006.11.13.02.11.39;	author brad;	state Exp;
branches;
next	1.82;

1.82
date	2006.10.03.18.32.44;	author brad;	state Exp;
branches;
next	1.81;

1.81
date	2006.10.03.05.00.49;	author brad;	state Exp;
branches;
next	1.80;

1.80
date	2006.06.19.11.49.26;	author bernd;	state Exp;
branches;
next	1.79;

1.79
date	2006.06.17.03.15.55;	author brad;	state Exp;
branches;
next	1.78;

1.78
date	2006.04.13.23.46.56;	author brad;	state Exp;
branches;
next	1.77;

1.77
date	2006.01.06.01.40.27;	author brad;	state Exp;
branches;
next	1.76;

1.76
date	2005.11.03.18.28.56;	author naddy;	state Exp;
branches;
next	1.75;

1.75
date	2005.10.29.23.26.38;	author brad;	state Exp;
branches;
next	1.74;

1.74
date	2005.09.25.17.03.32;	author brad;	state Exp;
branches;
next	1.73;

1.73
date	2005.05.25.02.27.13;	author brad;	state Exp;
branches
	1.73.2.1;
next	1.72;

1.72
date	2005.02.25.16.37.25;	author brad;	state Exp;
branches
	1.72.2.1;
next	1.71;

1.71
date	2005.02.17.03.32.24;	author brad;	state Exp;
branches;
next	1.70;

1.70
date	2005.02.11.02.47.55;	author brad;	state Exp;
branches;
next	1.69;

1.69
date	2005.02.04.04.27.38;	author brad;	state Exp;
branches;
next	1.68;

1.68
date	2005.01.26.05.08.11;	author brad;	state Exp;
branches;
next	1.67;

1.67
date	2004.12.07.19.33.33;	author alek;	state Exp;
branches;
next	1.66;

1.66
date	2004.10.20.21.44.20;	author brad;	state Exp;
branches;
next	1.65;

1.65
date	2004.08.04.16.12.14;	author naddy;	state Exp;
branches
	1.65.2.1;
next	1.64;

1.64
date	2004.07.11.17.00.47;	author brad;	state Exp;
branches;
next	1.63;

1.63
date	2004.06.11.08.00.35;	author brad;	state Exp;
branches;
next	1.62;

1.62
date	2004.06.02.21.39.59;	author brad;	state Exp;
branches;
next	1.61;

1.61
date	2004.04.21.11.11.19;	author brad;	state Exp;
branches;
next	1.60;

1.60
date	2004.04.13.00.40.47;	author brad;	state Exp;
branches;
next	1.59;

1.59
date	2004.03.03.01.20.42;	author brad;	state Exp;
branches
	1.59.2.1;
next	1.58;

1.58
date	2004.02.25.02.35.17;	author naddy;	state Exp;
branches;
next	1.57;

1.57
date	2004.02.16.10.21.20;	author brad;	state Exp;
branches;
next	1.56;

1.56
date	2003.10.17.18.03.54;	author brad;	state Exp;
branches;
next	1.55;

1.55
date	2003.08.22.21.12.18;	author brad;	state Exp;
branches
	1.55.2.1;
next	1.54;

1.54
date	2003.08.18.17.13.40;	author brad;	state Exp;
branches;
next	1.53;

1.53
date	2003.07.26.06.05.52;	author brad;	state Exp;
branches;
next	1.52;

1.52
date	2003.07.23.01.47.20;	author brad;	state Exp;
branches;
next	1.51;

1.51
date	2003.07.08.20.43.20;	author brad;	state Exp;
branches;
next	1.50;

1.50
date	2003.07.07.17.44.43;	author brad;	state Exp;
branches;
next	1.49;

1.49
date	2003.05.13.20.12.02;	author brad;	state Exp;
branches;
next	1.48;

1.48
date	2002.10.04.13.52.48;	author brad;	state Exp;
branches;
next	1.47;

1.47
date	2002.09.20.01.27.10;	author brad;	state Exp;
branches;
next	1.46;

1.46
date	2002.08.23.14.10.20;	author brad;	state Exp;
branches;
next	1.45;

1.45
date	2002.07.24.18.14.08;	author brad;	state Exp;
branches;
next	1.44;

1.44
date	2002.06.30.18.29.22;	author brad;	state Exp;
branches;
next	1.43;

1.43
date	2002.05.02.02.37.04;	author brad;	state Exp;
branches;
next	1.42;

1.42
date	2002.04.17.18.03.21;	author brad;	state Exp;
branches;
next	1.41;

1.41
date	2002.03.21.21.17.54;	author brad;	state Exp;
branches
	1.41.2.1;
next	1.40;

1.40
date	2002.03.16.19.05.26;	author brad;	state Exp;
branches;
next	1.39;

1.39
date	2002.03.16.18.18.30;	author brad;	state Exp;
branches;
next	1.38;

1.38
date	2002.03.01.04.36.29;	author brad;	state Exp;
branches;
next	1.37;

1.37
date	2002.02.20.01.17.03;	author brad;	state Exp;
branches;
next	1.36;

1.36
date	2001.09.28.06.02.15;	author pvalchev;	state Exp;
branches;
next	1.35;

1.35
date	2001.08.30.02.24.52;	author brad;	state Exp;
branches;
next	1.34;

1.34
date	2001.07.20.14.37.38;	author brad;	state Exp;
branches;
next	1.33;

1.33
date	2001.07.13.11.24.53;	author naddy;	state Exp;
branches;
next	1.32;

1.32
date	2001.06.08.19.03.35;	author brad;	state Exp;
branches;
next	1.31;

1.31
date	2001.05.06.04.22.57;	author lebel;	state Exp;
branches;
next	1.30;

1.30
date	2001.03.14.14.39.54;	author brad;	state Exp;
branches;
next	1.29;

1.29
date	2001.01.17.02.38.20;	author brad;	state Exp;
branches;
next	1.28;

1.28
date	2000.12.08.17.09.52;	author brad;	state Exp;
branches;
next	1.27;

1.27
date	2000.11.17.22.35.52;	author brad;	state Exp;
branches;
next	1.26;

1.26
date	2000.10.08.20.37.08;	author brad;	state Exp;
branches;
next	1.25;

1.25
date	2000.09.24.07.04.14;	author brad;	state Exp;
branches;
next	1.24;

1.24
date	2000.09.06.05.48.49;	author brad;	state Exp;
branches;
next	1.23;

1.23
date	2000.08.31.06.43.40;	author brad;	state Exp;
branches;
next	1.22;

1.22
date	2000.08.11.06.30.34;	author brad;	state Exp;
branches;
next	1.21;

1.21
date	2000.07.23.18.21.20;	author brad;	state Exp;
branches;
next	1.20;

1.20
date	2000.07.20.22.41.40;	author chris;	state Exp;
branches;
next	1.19;

1.19
date	2000.07.20.01.17.09;	author brad;	state Exp;
branches;
next	1.18;

1.18
date	2000.06.28.07.08.28;	author brad;	state Exp;
branches;
next	1.17;

1.17
date	2000.06.10.06.27.25;	author brad;	state Exp;
branches;
next	1.16;

1.16
date	2000.06.09.20.21.41;	author espie;	state Exp;
branches;
next	1.15;

1.15
date	2000.04.09.17.38.40;	author espie;	state Exp;
branches
	1.15.2.1;
next	1.14;

1.14
date	2000.03.30.21.59.26;	author brad;	state Exp;
branches;
next	1.13;

1.13
date	2000.03.24.22.12.03;	author espie;	state Exp;
branches;
next	1.12;

1.12
date	2000.02.22.17.08.48;	author espie;	state Exp;
branches;
next	1.11;

1.11
date	2000.02.15.05.05.25;	author turan;	state Exp;
branches;
next	1.10;

1.10
date	2000.02.12.08.02.33;	author turan;	state Exp;
branches;
next	1.9;

1.9
date	2000.02.02.17.02.38;	author espie;	state Exp;
branches;
next	1.8;

1.8
date	2000.01.17.15.38.38;	author brad;	state Exp;
branches;
next	1.7;

1.7
date	99.12.09.19.48.17;	author brad;	state Exp;
branches;
next	1.6;

1.6
date	99.10.01.00.01.54;	author brad;	state Exp;
branches;
next	1.5;

1.5
date	99.07.08.23.27.39;	author brad;	state Exp;
branches;
next	1.4;

1.4
date	99.05.22.18.23.46;	author brad;	state Exp;
branches;
next	1.3;

1.3
date	99.05.09.20.01.50;	author brad;	state Exp;
branches;
next	1.2;

1.2
date	99.03.17.03.59.28;	author brad;	state Exp;
branches;
next	1.1;

1.1
date	98.09.14.01.36.52;	author marc;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	98.09.14.01.36.52;	author marc;	state Exp;
branches;
next	;

1.15.2.1
date	2000.09.15.05.22.14;	author marc;	state Exp;
branches;
next	;

1.41.2.1
date	2002.06.30.18.36.34;	author brad;	state Exp;
branches;
next	;

1.55.2.1
date	2004.04.16.01.03.59;	author brad;	state Exp;
branches;
next	1.55.2.2;

1.55.2.2
date	2004.04.21.11.14.43;	author brad;	state Exp;
branches;
next	;

1.59.2.1
date	2004.05.06.00.54.15;	author brad;	state Exp;
branches;
next	1.59.2.2;

1.59.2.2
date	2005.01.30.08.43.20;	author sturm;	state Exp;
branches;
next	1.59.2.3;

1.59.2.3
date	2005.02.05.21.50.14;	author sturm;	state Exp;
branches;
next	1.59.2.4;

1.59.2.4
date	2005.02.12.09.16.42;	author sturm;	state Exp;
branches;
next	1.59.2.5;

1.59.2.5
date	2005.02.19.09.13.15;	author sturm;	state Exp;
branches;
next	1.59.2.6;

1.59.2.6
date	2005.03.11.17.39.30;	author sturm;	state Exp;
branches;
next	1.59.2.7;

1.59.2.7
date	2005.03.27.15.07.30;	author sturm;	state Exp;
branches;
next	;

1.65.2.1
date	2005.01.30.08.44.29;	author sturm;	state Exp;
branches;
next	1.65.2.2;

1.65.2.2
date	2005.02.05.21.49.26;	author sturm;	state Exp;
branches;
next	1.65.2.3;

1.65.2.3
date	2005.02.12.09.16.03;	author sturm;	state Exp;
branches;
next	1.65.2.4;

1.65.2.4
date	2005.02.19.09.12.40;	author sturm;	state Exp;
branches;
next	1.65.2.5;

1.65.2.5
date	2005.03.11.17.39.04;	author sturm;	state Exp;
branches;
next	1.65.2.6;

1.65.2.6
date	2005.03.27.15.08.02;	author sturm;	state Exp;
branches;
next	1.65.2.7;

1.65.2.7
date	2005.05.26.03.53.28;	author robert;	state Exp;
branches;
next	1.65.2.8;

1.65.2.8
date	2005.09.26.20.34.09;	author sturm;	state Exp;
branches;
next	;

1.72.2.1
date	2005.05.26.03.47.27;	author robert;	state Exp;
branches;
next	1.72.2.2;

1.72.2.2
date	2005.09.26.20.35.09;	author sturm;	state Exp;
branches;
next	1.72.2.3;

1.72.2.3
date	2005.11.02.09.40.35;	author sturm;	state Exp;
branches;
next	;

1.73.2.1
date	2005.11.01.11.23.09;	author sturm;	state Exp;
branches;
next	1.73.2.2;

1.73.2.2
date	2005.11.02.09.41.14;	author sturm;	state Exp;
branches;
next	;

1.98.2.1
date	2009.09.15.02.38.09;	author william;	state Exp;
branches;
next	;

1.98.4.1
date	2009.10.25.03.37.12;	author william;	state Exp;
branches;
next	1.98.4.2;

1.98.4.2
date	2010.02.09.03.07.43;	author william;	state Exp;
branches;
next	;

1.147.2.1
date	2013.05.01.08.53.27;	author sthen;	state Exp;
branches;
next	1.147.2.2;

1.147.2.2
date	2013.07.15.08.13.34;	author sthen;	state Exp;
branches;
next	;

1.177.2.1
date	2016.03.19.12.23.11;	author sthen;	state Exp;
branches;
next	1.177.2.2;
commitid	dZXFs6hBNDrBMu1w;

1.177.2.2
date	2016.04.02.10.45.21;	author sthen;	state Exp;
branches;
next	1.177.2.3;
commitid	b9FOl90OonzOn9tm;

1.177.2.3
date	2016.04.20.22.51.37;	author sthen;	state Exp;
branches;
next	1.177.2.4;
commitid	uIz0rwJ2NEoTr2aR;

1.177.2.4
date	2016.05.06.19.46.04;	author sthen;	state Exp;
branches;
next	;
commitid	E6NdwIS5mH7HDdGe;


desc
@@


1.198
log
@update to squid-3.5.26
@
text
@# $OpenBSD: Makefile,v 1.197 2017/05/31 08:08:17 espie Exp $

COMMENT-main=	WWW and FTP proxy cache and accelerator
COMMENT-ldap=	LDAP authentication/ACL support for Squid
COMMENT-ntlm=	NTLM authentication/ACL support for Squid

V=		3.5.26
DISTNAME=	squid-$V
EXTRACT_SUFX=	.tar.xz
PKGNAME-main=	squid-$V
PKGNAME-ldap=	squid-ldap-$V
PKGNAME-ntlm=	squid-ntlm-$V

CATEGORIES=	www

HOMEPAGE=	http://www.squid-cache.org/

MAINTAINER=	Stuart Henderson <sthen@@openbsd.org>

# GPLv2+
PERMIT_PACKAGE_CDROM=	Yes

WANTLIB += c m nettle pthread

cWANTLIB=	${WANTLIB} ${LIBECXX} ffi gmp gnutls hogweed iconv
cWANTLIB+=	idn2 intl p11-kit tasn1 unistring z

# bzr repository at https://code.launchpad.net/squid
MASTER_SITES=	${HOMEPAGE}Versions/v${V:C/^([0-9]).*/\1/}/${V:C/([0-9.]{3}).*/\1/}/ \
		http://ftp.mirrorservice.org/sites/ftp.squid-cache.org/pub/archive/${V:C/([0-9.]{3}).*/\1/}/

# C++11
COMPILER =	gcc

LIB_DEPENDS+=	security/gnutls
BUILD_DEPENDS+=	devel/cppunit

SEPARATE_BUILD=	Yes
CONFIGURE_STYLE= autoconf
AUTOCONF_VERSION= 2.69
MODGNU_CONFIG_GUESS_DIRS= ${WRKSRC}/cfgaux

CONFIGURE_ARGS=	--disable-strict-error-checking \
		--disable-arch-native \
		--enable-ssl-crtd

EXTERNAL_ACL=	SQL_session file_userip time_quota \
		unix_group wbinfo_group # kerberos_ldap_group (sasl/gssapi)

WANTLIB-main +=	${cWANTLIB} crypto db ssl

LIB_DEPENDS-main += ${LIB_DEPENDS} \
		databases/db/v4 \
		devel/gettext \
		security/libnettle

SYSCONFDIR=	${BASESYSCONFDIR}/squid
LOCALSTATEDIR=	${BASELOCALSTATEDIR}/squid

MULTI_PACKAGES=	-main -ldap -ntlm
PSEUDO_FLAVORS=	no_ldap no_ntlm
FLAVOR?=

.include <bsd.port.arch.mk>

CONFIGURE_ARGS+= --datadir="${PREFIX}/share/squid" \
		--libexecdir="${PREFIX}/libexec/squid" \
		--disable-loadable-modules \
		--enable-arp-acl \
		--enable-auth \
		--enable-delay-pools \
		--enable-follow-x-forwarded-for \
		--enable-forw-via-db \
		--enable-http-violations \
		--enable-icap-client \
		--enable-ipv6 \
		--enable-referer-log \
		--enable-removal-policies="lru heap" \
		--enable-ssl \
		--enable-ssl-crtd \
		--with-openssl \
		--enable-storeio="aufs ufs diskd" \
		--with-default-user="_squid" \
		--with-filedescriptors=8192 \
		--with-krb5-config=no \
		--with-pidfile="/var/run/squid.pid" \
		--with-pthreads \
		--with-swapdir="${LOCALSTATEDIR}/cache"

# "rock" not in --enable-storeio list due to an error at startup:
# FATAL: Rock cache_dir at /var/squid/rock/rock failed to open db file: (40) Message too long"

# PF transparent support requires access to /dev/pf to retrieve the original
# source address; ipfw-transparent (which requires divert-to) uses an
# unprivileged getsockname() call instead.
CONFIGURE_ARGS+= --disable-pf-transparent \
		--enable-ipfw-transparent
# not just defaulting to build all external-acl-helpers as
# kerberos_ldap_group fails
CONFIGURE_ARGS+= --enable-external-acl-helpers="${EXTERNAL_ACL}"

CONFIGURE_ENV+=	CPPFLAGS="-I${LOCALBASE}/include" \
		LDFLAGS="-L${LOCALBASE}/lib" \
		ac_cv_header_et_com_err_h=false \
		ac_cv_header_security_pam_appl_h=false \
		ac_cv_header_execinfo_h=false
E=		${TRUEPREFIX}/share/examples/squid
FAKE_FLAGS=	sysconfdir=$E \
		DEFAULT_CONFIG_FILE=$E/squid.conf \
		DEFAULT_MIME_TABLE=$E/mime.conf
TEST_DEPENDS=	devel/cppunit

.if ${BUILD_PACKAGES:M-ldap}
EXTERNAL_ACL+=	LDAP_group eDirectory_userip
.endif
RUN_DEPENDS-ldap=   ${BASE_PKGPATH}
LIB_DEPENDS-ldap+=  ${LIB_DEPENDS} databases/openldap
WANTLIB-ldap +=     ${cWANTLIB} crypto lber-2.4 ldap-2.4 sasl2 ssl

RUN_DEPENDS-ntlm=   net/samba ${BASE_PKGPATH}
LIB_DEPENDS-ntlm += security/libnettle

pre-build:
	@@cd ${WRKSRC}; \
	perl -pi -e 's,/usr/local,${LOCALBASE},g' \
	    helpers/external_acl/wbinfo_group/ext_wbinfo_group_acl.pl.in \
	    helpers/*/*/config.test \
	    src/squid.8.in

post-install:
	rm -rf ${WRKINST}/var/squid
	cd ${PREFIX}/share/examples/squid; \
	    rm -f mime.conf squid.conf cachemgr.conf errorpage.css msntauth.conf
	@@# remove unwanted auth helpers; msnt_multi_domain needs Authen::Smb
	@@# (not ported), others are risky (typically accessing master.passwd
	@@# which needs root).
.for i in basic_msnt_multi_domain_auth basic_getpwnam_auth basic_pam_auth basic_sasl_auth
	rm -f ${PREFIX}/libexec/squid/$i ${PREFIX}/man/man8/$i.8
.endfor
	${INSTALL_DATA_DIR} ${PREFIX}/share/snmp/mibs
	-cd ${PREFIX}/share; mv squid/mib.txt snmp/mibs/SQUID-MIB.txt

.include <bsd.port.mk>
@


1.197
log
@switch everything to new COMPILER idiom, even stuff that won't build with clang
yet, but at least that part is done.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.196 2017/05/21 17:27:22 sthen Exp $
d7 1
a7 1
V=		3.5.25
a8 1
REVISION=	0
d24 3
a26 1
cWANTLIB = ${WANTLIB} ${LIBECXX} ffi gmp gnutls hogweed iconv idn2 intl p11-kit tasn1 z
@


1.196
log
@use WANT_CXX
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.195 2017/05/11 16:29:55 schwarze Exp $
d32 1
a32 1
WANT_CXX=	base gcc
@


1.195
log
@Unimportant whitespace differences only, drop USE_GROFF.

While here, fix a number of quite serious escaping errors in
four manual pages that caused loss of important information.
I will also send those upstream.

OK sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.194 2017/04/04 21:09:30 sthen Exp $
d25 1
a25 1
cWANTLIB = ${WANTLIB} ffi gmp gnutls hogweed iconv idn2 intl p11-kit tasn1 z
d31 3
a33 1
MODULES+=	gcc4
a35 3

MODGCC4_ARCHS=	*
MODGCC4_LANGS=	c c++
@


1.194
log
@update to squid-3.5.25
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.193 2017/02/18 17:33:51 ajacoutot Exp $
d9 1
a33 1
USE_GROFF=	Yes
@


1.193
log
@Missed bump.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.192 2017/02/18 17:32:37 ajacoutot Exp $
d7 1
a7 1
V=		3.5.24
a12 3
REVISION-ldap=	0
REVISION-main=	0
REVISION-ntlm=	0
@


1.192
log
@idn -> idn2 after gnutls WANTLIB change.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.191 2017/01/29 20:43:31 sthen Exp $
d13 3
@


1.191
log
@update to squid-3.5.24
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.190 2016/12/18 22:36:52 sthen Exp $
d24 1
a24 1
cWANTLIB = ${WANTLIB} ffi gmp gnutls hogweed iconv idn intl p11-kit tasn1 z
@


1.190
log
@update to squid-3.5.23

<http://www.squid-cache.org/Advisories/SQUID-2016_10.txt>
Incorrect HTTP Request header comparison results in Collapsed
Forwarding feature mistakenly identifying some private responses as
being suitable for delivery to multiple clients.

<http://www.squid-cache.org/Advisories/SQUID-2016_11.txt>
Incorrect processing of responses to If-None-Modified HTTP conditional
requests leads to client-specific Cookie data being leaked to other
clients. Attack requests can easily be crafted by a client to probe a
cache for this information.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.189 2016/10/11 13:47:44 sthen Exp $
d7 1
a7 1
V=		3.5.23
@


1.189
log
@update to squid-3.5.22
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.188 2016/09/13 19:27:11 sthen Exp $
d7 1
a7 1
V=		3.5.22
@


1.188
log
@update to squid-3.5.21
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.187 2016/07/04 12:13:40 sthen Exp $
d7 1
a7 1
V=		3.5.21
@


1.187
log
@update to squid-3.5.20, various fixes including some asserts
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.186 2016/06/11 18:10:00 sthen Exp $
d7 1
a7 1
V=		3.5.20
d23 1
a23 1
WANTLIB += c m nettle pthread stdc++
@


1.186
log
@Switch squid to ports gcc, it's already used on powerpc, fixes some problems
on arm (found by Steven Chamberlain), so it seems like it may be a safer
approach (and the next major version requires newer c++ anyway).  Based on
a diff from Steven Chamberlain.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.185 2016/05/12 16:15:58 sthen Exp $
d7 1
a7 2
V=		3.5.19
REVISION=	0
@


1.185
log
@fix no_ldap builds
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.184 2016/05/09 13:52:45 sthen Exp $
d8 1
a30 3
#MASTER_SITES0=	http://www.squid-cache.org/Versions/v3/3.5/changesets/
#PATCHFILES=	...

d36 1
a36 1
MODGCC4_ARCHS=	powerpc
@


1.184
log
@update to squid-3.5.19 (compared to 3.5.18, fixes a problem with interception
proxies)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.183 2016/05/07 14:06:41 sthen Exp $
d50 1
a50 1
EXTERNAL_ACL=	LDAP_group SQL_session file_userip time_quota \
@


1.183
log
@update to squid-3.5.18
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.182 2016/05/06 19:44:11 sthen Exp $
d7 1
a7 1
V=		3.5.18
@


1.182
log
@add upstream patches to Squid (there should be an upstream release
soon, but the patches make sense for now) -

1) Cache Poisoning issue in HTTP Request handling
http://www.squid-cache.org/Advisories/SQUID-2016_7.txt

2) Header Smuggling issue in HTTP Request processing
http://www.squid-cache.org/Advisories/SQUID-2016_8.txt

3) Multiple Denial of Service issues in ESI Response processing.
http://www.squid-cache.org/Advisories/SQUID-2016_9.txt
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.181 2016/04/20 16:36:50 sthen Exp $
d7 1
a7 2
V=		3.5.17
REVISION-main=	0
d30 2
a31 4
MASTER_SITES0=	http://www.squid-cache.org/Versions/v3/3.5/changesets/
PATCHFILES=	squid-3.5-14039.patch:0 \
		squid-3.5-14038.patch:0 \
		SQUID-2016_9.patch:0
@


1.181
log
@update to squid-3.5.17, fixing some buffer overflows and possible
disclosure of stack contents. when available, reports will be at
http://www.squid-cache.org/Advisories/SQUID-2016_5.txt
http://www.squid-cache.org/Advisories/SQUID-2016_6.txt
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.180 2016/04/02 10:44:18 sthen Exp $
d8 1
d30 5
@


1.180
log
@update to squid-3.5.16, various fixes including a buffer overflow in pinger
with icmp6.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.179 2016/03/11 20:28:32 naddy Exp $
d7 1
a7 1
V=		3.5.16
@


1.179
log
@garbage collect CONFIGURE_SHARED
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.178 2016/02/25 00:47:20 sthen Exp $
d7 1
a7 1
V=		3.5.15
d24 1
a24 1
cWANTLIB = ${WANTLIB} ffi gmp gnutls hogweed p11-kit tasn1 z
d30 1
a30 1
MODULES+=	devel/gettext gcc4
d54 1
@


1.178
log
@update to squid 3.5.15, dos fix
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.177 2016/02/16 13:21:07 sthen Exp $
d65 1
a65 2
CONFIGURE_ARGS+= ${CONFIGURE_SHARED} \
		--datadir="${PREFIX}/share/squid" \
@


1.177
log
@Security update to squid-3.5.14, ok jasper@@ rpointel@@
http://www.squid-cache.org/Advisories/SQUID-2016_1.txt

"Due to incorrectly handling server errors Squid is vulnerable to a
denial of service attack when connecting to TLS or SSL servers."
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.176 2016/01/10 20:09:58 sthen Exp $
d7 1
a7 1
V=		3.5.14
@


1.177.2.1
log
@MFC security update to www/squid, easy to trigger DoS
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.179 2016/03/11 20:28:32 naddy Exp $
d7 1
a7 1
V=		3.5.15
d65 2
a66 1
CONFIGURE_ARGS+= --datadir="${PREFIX}/share/squid" \
@


1.177.2.2
log
@update -stable to squid-3.5.16, various fixes including a buffer
overflow in pinger with icmp6.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.177.2.1 2016/03/19 12:23:11 sthen Exp $
d7 1
a7 1
V=		3.5.16
@


1.177.2.3
log
@MFC squid update to 3.5.17, fixing buffer overflow in cachemgr.cgi
(http://www.squid-cache.org/Advisories/SQUID-2016_5.txt).

This update also fixes several security issues with ESI support,
however we don't build packages with this.
(http://www.squid-cache.org/Advisories/SQUID-2016_6.txt).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.177.2.2 2016/04/02 10:45:21 sthen Exp $
d7 1
a7 1
V=		3.5.17
d33 1
@


1.177.2.4
log
@MFC: add upstream patches to Squid (there should be an upstream release
soon, but the patches make sense for now) -

1) Cache Poisoning issue in HTTP Request handling
http://www.squid-cache.org/Advisories/SQUID-2016_7.txt

2) Header Smuggling issue in HTTP Request processing
http://www.squid-cache.org/Advisories/SQUID-2016_8.txt

3) Multiple Denial of Service issues in ESI Response processing.
http://www.squid-cache.org/Advisories/SQUID-2016_9.txt
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.177.2.3 2016/04/20 22:51:37 sthen Exp $
a7 1
REVISION-main=	0
a28 5

MASTER_SITES0=	http://www.squid-cache.org/Versions/v3/3.5/changesets/
PATCHFILES=	squid-3.5-14039.patch:0 \
		squid-3.5-14038.patch:0 \
		SQUID-2016_9.patch:0
@


1.176
log
@update to squid-3.5.13, a couple of fixes, mostly TLS-intercept-related
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.175 2015/11/30 10:26:16 sthen Exp $
d7 1
a7 1
V=		3.5.13
@


1.175
log
@update to squid-3.5.12
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.174 2015/11/04 15:39:55 sthen Exp $
d7 1
a7 1
V=		3.5.12
@


1.174
log
@fix autoconf check which used SSLv3_method; results in assert failure in
some ssl interception modes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.173 2015/11/02 17:21:55 sthen Exp $
d7 1
a7 2
V=		3.5.11
REVISION-main=	0
d23 1
a23 1
WANTLIB += c m nettle pthread
d35 1
a35 1
MODGCC4_ARCHS=	*
@


1.173
log
@update to squid-3.5.11
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.172 2015/10/09 00:28:56 sthen Exp $
d8 1
d40 2
a41 1
CONFIGURE_STYLE= gnu
@


1.172
log
@update to squid-3.5.10
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.171 2015/09/30 08:56:27 sthen Exp $
d7 1
a7 1
V=		3.5.10
@


1.171
log
@bump REVISION to ensure the pkg version number in -current is above
-stable, especially now that dirs have been reorganised.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.170 2015/09/18 11:17:04 sthen Exp $
d7 1
a7 2
V=		3.5.9
REVISION=	0
d23 2
a24 1
WANTLIB += c ffi gmp gnutls hogweed m p11-kit nettle tasn1 pthread z
d49 1
a49 1
WANTLIB-main +=	${WANTLIB} crypto db ssl
d117 1
a117 1
WANTLIB-ldap +=     ${WANTLIB} crypto lber-2.4 ldap-2.4 sasl2 ssl
a120 1
WANTLIB-ntlm +=	    ${WANTLIB}
@


1.170
log
@Update to squid-3.5.9, fixes problems with TLS/SSL parsing in configurations
using SSL-Bump.

- int overflow with extension parsing: char << 8 into a short
http://www.squid-cache.org/Versions/v3/3.5/changesets/squid-3.5-13915.patch

- {Client,Server}Hello parsing; when checking for TLS extensions, don't
check for bytes following compression_method in the _whole_ message, only
in the *Hello part ("does not account for the fact that the message may
contain more than just ServerHello").
http://www.squid-cache.org/Versions/v3/3.5/changesets/squid-3.5-13915.patch
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.169 2015/09/10 13:00:10 sthen Exp $
d8 1
@


1.169
log
@Currently Squid 3.5 is considered stable. Rather than moving snapshot/*
to stable/*, just drop back to a single version of squid in ports.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2015/09/04 21:38:46 sthen Exp $
d7 1
a7 2
V=		3.5.8
REVISION=	0
@


1.168
log
@update squid 3.5 branch to 3.5.1 and re-enable now that the horrible
*_cipher_by_char API has been added back to libssl.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.167 2015/01/06 22:50:35 sthen Exp $
d3 3
a5 3
SUBDIR =
SUBDIR += stable
SUBDIR += snapshot
d7 137
a143 1
.include <bsd.port.subdir.mk>
@


1.167
log
@disable squid/snapshot for now, the present version is stale, there are newer
versions but they require some libressl compat work first
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.166 2013/11/15 19:09:17 sthen Exp $
d5 1
a5 1
#SUBDIR += snapshot
@


1.166
log
@Update to squid-3.3.10 and reorganise the squid ports; retire squid-2.7
(it was kept separately because 3.x didn't build on some arch due to an
incomplete atomic ops autoconf check which has since been repaired) and
replace with 3.4 (devel version). Enable additional helpers and turn on
support for rock cache dirs.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.165 2013/10/31 21:12:13 sthen Exp $
d5 1
a5 1
SUBDIR += snapshot
@


1.165
log
@bump REVISION for any ports using route messages. regen some distinfos and
remove unnecessary USE_GROFFs while there.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.164 2013/09/17 16:56:24 sthen Exp $
d3 3
a5 1
MULTI_PACKAGES=	-main -ntlm
d7 1
a7 137
COMMENT-main=	WWW and FTP proxy cache and accelerator
COMMENT-ldap=	LDAP authentication/ACL support for Squid
COMMENT-ntlm=	NTLM authentication/ACL support for Squid

V=		3.3.9
REVISION-main=	0

DISTNAME=	squid-$V
EXTRACT_SUFX=	.tar.bz2
PKGNAME-main=	squid-$V
PKGNAME-ldap=	squid-ldap-$V
PKGNAME-ntlm=	squid-ntlm-$V
CATEGORIES=	www

# bzr repository at https://code.launchpad.net/squid
MASTER_SITES=	${HOMEPAGE}Versions/v${V:R:R}/${V:R}/

MAINTAINER=	Stuart Henderson <sthen@@openbsd.org>

HOMEPAGE=	http://www.squid-cache.org/

# GPLv2+
PERMIT_PACKAGE_CDROM=	Yes

WANTLIB += c m pthread stdc++

WANTLIB-main=	${WANTLIB} asn1 crypto db execinfo gssapi krb5 ssl \
		com_err heimbase roken wind

LIB_DEPENDS-main= ${LIB_DEPENDS} \
		databases/db/v4 \
		devel/libexecinfo

SYSCONFDIR=	${BASESYSCONFDIR}/squid
LOCALSTATEDIR=	${BASELOCALSTATEDIR}/squid
SUBST_VARS=	LOCALSTATEDIR

PSEUDO_FLAVORS=	no_ldap
FLAVOR?=

BASIC_AUTH=	DB NCSA POP3 SMB NIS RADIUS # SASL
DIGEST_AUTH=	file
EXTERNAL_ACL=	SQL_session file_userip time_quota session unix_group \
		wbinfo_group # kerberos_ldap_group (requires sasl)
STOREIO=	aufs ufs diskd # coss rock

SEPARATE_BUILD=	Yes
AUTOCONF_VERSION= 2.68
AUTOMAKE_VERSION= 1.11
BUILD_DEPENDS=	${MODGNU_AUTOCONF_DEPENDS} \
		${MODGNU_AUTOMAKE_DEPENDS} \
		devel/libtool
CONFIGURE_STYLE= gnu
MODGNU_CONFIG_GUESS_DIRS= ${WRKSRC}/cfgaux

USE_GROFF=	Yes

# gcc 4.2: src/ipc/StoreMap.cc fails with "unrecognizable insn" unless
# optimizer is disabled, see e.g.
# http://www.squid-cache.org/mail-archive/squid-users/201208/0060.html
MODULES+=	gcc4
MODGCC4_ARCHS=	powerpc
MODGCC4_LANGS=	c c++

CONFIGURE_ARGS+= ${CONFIGURE_SHARED} \
		--datadir="${PREFIX}/share/squid" \
		--libexecdir="${PREFIX}/libexec/squid" \
		--disable-loadable-modules \
		--enable-arp-acl \
		--enable-auth \
		--enable-auth-basic="${BASIC_AUTH}" \
		--enable-auth-digest="${DIGEST_AUTH}" \
		--enable-auth-negotiate="kerberos" \
		--enable-auth-ntlm="fake negotiate_wrapper smb_lm" \
		--enable-delay-pools \
		--enable-external-acl-helpers="${EXTERNAL_ACL}" \
		--enable-follow-x-forwarded-for \
		--enable-forw-via-db \
		--enable-http-violations \
		--enable-icap-client \
		--enable-ipv6 \
		--enable-referer-log \
		--enable-removal-policies="lru heap" \
		--enable-ssl \
		--enable-stacktraces \
		--enable-storeio="${STOREIO}" \
		--with-default-user="_squid" \
		--with-filedescriptors=8192 \
		--with-pidfile="/var/run/squid.pid" \
		--with-pthreads \
		--with-swapdir="${LOCALSTATEDIR}/cache"
# PF transparent support requires access to /dev/pf to retrieve the original
# source address; ipfw-transparent (which requires divert-to) uses an
# unprivileged getsockname() call instead.
CONFIGURE_ARGS+= --disable-pf-transparent \
		--enable-ipfw-transparent
CONFIGURE_ENV+=	CPPFLAGS="-I${LOCALBASE}/include" \
		LDFLAGS="-L${LOCALBASE}/lib" \
		ac_cv_header_et_com_err_h=false
E=		${TRUEPREFIX}/share/examples/squid
FAKE_FLAGS=	sysconfdir=$E \
		DEFAULT_CONFIG_FILE=$E/squid.conf \
		DEFAULT_MIME_TABLE=$E/mime.conf
TEST_DEPENDS= devel/cppunit

.if !${FLAVOR:Mno_ldap}
MULTI_PACKAGES+= -ldap
BASIC_AUTH+=	LDAP
DIGEST_AUTH+=	LDAP eDirectory
EXTERNAL_ACL+=	LDAP_group eDirectory_userip
RUN_DEPENDS-ldap= ${BASE_PKGPATH}
LIB_DEPENDS-ldap= ${LIB_DEPENDS} databases/openldap
WANTLIB-ldap +=	${WANTLIB} asn1 com_err crypto gssapi krb5
WANTLIB-ldap +=	lber-2.4 ldap-2.4 sasl2 ssl wind
WANTLIB-ldap +=	com_err heimbase roken
.endif

RUN_DEPENDS-ntlm= net/samba,ads ${BASE_PKGPATH}

post-patch:
	cd ${WRKSRC}; AUTOCONF_VERSION=${AUTOCONF_VERSION} AUTOMAKE_VERSION=${AUTOMAKE_VERSION} LOCALBASE=${LOCALBASE} ./bootstrap.sh

pre-build:
	@@cd ${WRKSRC}; \
	perl -pi -e 's,/usr/local,${LOCALBASE},g' \
	    helpers/external_acl/wbinfo_group/ext_wbinfo_group_acl.pl.in \
	    helpers/*/*/config.test \
	    src/squid.8.in

post-install:
	rm -rf ${WRKINST}/var/squid
	cd ${PREFIX}/share/examples/squid; \
	    rm -f mime.conf squid.conf cachemgr.conf errorpage.css
	${INSTALL_DATA_DIR} ${PREFIX}/share/snmp/mibs
	-cd ${PREFIX}/share; mv squid/mib.txt snmp/mibs/SQUID-MIB.txt

.include <bsd.port.mk>
@


1.164
log
@update to squid 3.3.9
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.163 2013/08/15 11:10:16 sthen Exp $
d10 1
@


1.163
log
@Fix autoconf check for atomic ops (it needs to attempt linking, not just
compiling); likely to fix arm. Remove BROKEN-* to give this another chance
on hppa/mips64 too.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.162 2013/07/15 08:21:54 sthen Exp $
d9 1
a9 1
V=		3.3.8
@


1.162
log
@SECURITY update to Squid 3.3.8, fixes CVE-2013-4115 CVE-2013-4123
"Due to incorrect data validation Squid is vulnerable to a buffer overflow
attack when processing specially crafted HTTP requests."
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.161 2013/07/11 14:28:01 sthen Exp $
a3 3

BROKEN-hppa=	broken autoconf test for atomic ops; test succeeds but actual code build fails
BROKEN-mips64=	broken autoconf test for atomic ops; test succeeds but actual code build fails
@


1.161
log
@update to squid-3.3.6
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.160 2013/06/21 21:37:56 sthen Exp $
d12 1
a12 1
V=		3.3.6
@


1.160
log
@squid documentation generally uses the nomenclature "interception proxy"
rather than "transparent proxy"; switch the readme to match. also tweak the
wording to make it clear which firewall reals need to be on which machine
when having a router pass off http traffic to squid on a different machine
configured as an interception proxy.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.159 2013/06/21 01:54:55 lteo Exp $
d12 1
a12 1
V=		3.3.5
a19 4

REVISION-main=	4
REVISION-ldap=	1
REVISION-ntlm=	1
@


1.159
log
@Fix incorrect path of squid.conf in pkg/README-main.

OK sthen@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.158 2013/06/20 06:54:37 ajacoutot Exp $
d21 1
a21 1
REVISION-main=	3
@


1.158
log
@Unbreak after hx509 and ntlm removal from Kerberos.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.157 2013/06/17 19:31:25 ajacoutot Exp $
d21 1
a21 1
REVISION-main=	2
@


1.157
log
@Unbreak with new Heimdal; get rid of self-cooked krb5-config since we
have it in base now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.156 2013/06/03 11:01:03 sthen Exp $
a12 1
REVISION-main=	0
d21 3
a23 2
REVISION-main=	1
REVISION-ldap=	0
d38 1
a38 1
		com_err heimbase heimntlm hx509 roken wind
d125 1
a125 1
WANTLIB-ldap +=	com_err heimbase heimntlm hx509 roken
@


1.156
log
@- add patch from upstream, fixing problem with kqueue and SSL MITM
- s/transparent/intercept/ in README, as I happened to notice in a misc@@
post from Rob Sheldon
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.155 2013/05/25 12:33:05 sthen Exp $
d22 3
d37 2
a38 1
WANTLIB-main=	${WANTLIB} asn1 crypto db execinfo gssapi krb5 ssl
d124 2
a125 1
WANTLIB-ldap +=	lber-2.4 ldap-2.4 sasl2 ssl
a128 4

post-extract:
	@@cp ${FILESDIR}/krb5-config ${WRKDIR}/bin
	@@chmod a+x ${WRKDIR}/bin/krb5-config
@


1.155
log
@update to squid 3.3.5
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.154 2013/04/30 18:41:50 sthen Exp $
d13 1
@


1.154
log
@Major update to Squid 3.3.4 (moving the port from the 3.2 branch to 3.3).
New features include:

- SQL Database logging helper
- Time-Quota session helper
- Custom HTTP request headers
- SSL-Bump Server First
- Server Certificate Mimic

While there, add notes to README-main about increasing the number of
file descriptors via login.conf.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.151 2013/04/25 21:29:52 sthen Exp $
d12 1
a12 1
V=		3.3.4
d33 1
a33 1
WANTLIB-main=	${WANTLIB} asn1 crypto execinfo gssapi krb5 ssl
d35 3
a37 1
LIB_DEPENDS-main= ${LIB_DEPENDS} devel/libexecinfo
@


1.153
log
@minor update to squid 3.2.11
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.152 2013/04/27 15:19:48 sthen Exp $
d12 1
a12 1
V=		3.2.11
d15 1
d44 1
a44 1
BASIC_AUTH=	NCSA SMB NIS radius
d46 3
a48 2
EXTERNAL_ACL=	file_userip session unix_group wbinfo_group
STOREIO=	aufs ufs diskd #coss rock
d77 1
a77 1
		--enable-auth-ntlm="fake smb_lm" \
d112 2
a113 2
DIGEST_AUTH+=	LDAP
EXTERNAL_ACL+=	LDAP_group
@


1.152
log
@update to squid-3.2.10: fixes & rolling in some patches committed upstream
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.151 2013/04/25 21:29:52 sthen Exp $
d12 1
a12 1
V=		3.2.10
@


1.151
log
@printf format string fix for long long time_t
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.150 2013/03/21 08:48:55 ajacoutot Exp $
d12 1
a12 2
V=		3.2.9
REVISION-main=	0
@


1.150
log
@USE_LIBTOOL=Yes is the default now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.149 2013/03/12 14:58:16 sthen Exp $
d13 1
@


1.149
log
@update to Squid 3.2.9, various fixes including DoS affecting 3.2.0.9 and up
(CVE-2013-1839).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.148 2013/03/11 11:44:49 espie Exp $
a57 1
USE_LIBTOOL=	Yes
@


1.148
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.147 2013/02/24 11:18:38 espie Exp $
d12 1
a12 1
V=		3.2.7
a18 2
REVISION-main = 0
REVISION-ldap = 0
@


1.147
log
@fix LIB_DEPENDS for arches that need the gcc4 modules (multi-packages are
fun that way). Bump affected pkgs just in case.

problem noticed by rpe@@

okay naddy@@, sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.146 2013/02/09 14:49:53 sthen Exp $
a30 3
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
d108 1
a108 1
REGRESS_DEPENDS= devel/cppunit
@


1.147.2.1
log
@MFC update to squid 3.2.11; includes fix for a denial-of-service affecting
3.2.0.9 and up (CVE-2013-1839).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.153 2013/04/30 14:05:51 sthen Exp $
d12 1
a12 1
V=		3.2.11
d19 2
@


1.147.2.2
log
@SECURITY update to Squid 3.2.13, fixes CVE-2013-4115 CVE-2013-4123
"Due to incorrect data validation Squid is vulnerable to a buffer overflow
attack when processing specially crafted HTTP requests."
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.147.2.1 2013/05/01 08:53:27 sthen Exp $
d12 1
a12 1
V=		3.2.13
@


1.146
log
@Don't use ${FLAVOR:L}, we only support lower-case flavours now.
OK ajacoutot@@ espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.145 2013/02/07 19:13:49 ajacoutot Exp $
d19 2
d39 1
a39 1
LIB_DEPENDS-main= devel/libexecinfo
d119 1
a119 1
LIB_DEPENDS-ldap= databases/openldap
@


1.145
log
@MODGCC4_VERSION default to 4.6 now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.144 2013/02/01 17:34:33 sthen Exp $
d111 1
a111 1
.if !${FLAVOR:L:Mno_ldap}
@


1.144
log
@bugfix update to Squid 3.2.7 including memory leak with malformed req's,
unhandled exception when using interception and peers, a division by zero
and others
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.143 2013/01/23 20:39:57 sthen Exp $
a66 1
MODGCC4_VERSION= 4.6
@


1.143
log
@build dep on libtool (for libtoolize)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.142 2013/01/22 14:30:46 sthen Exp $
d12 1
a12 2
V=		3.2.6
REVISION-main=	0
@


1.142
log
@landry@@ noticed that www/squid was picking up execinfo.h in bulk causing
#ifdef'd headers to be used and dpb was junking it thus breaking the build;
fix by improving detection for backtrace_symbol_fd / libexecinfo and
explicitly using it.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.141 2013/01/09 21:41:48 sthen Exp $
d55 3
a57 1
BUILD_DEPENDS=	${MODGNU_AUTOCONF_DEPENDS} ${MODGNU_AUTOMAKE_DEPENDS}
@


1.141
log
@bugfix update to squid-3.2.6
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.140 2013/01/02 12:26:58 sthen Exp $
d13 1
d36 3
a38 1
WANTLIB-main=	${WANTLIB} asn1 crypto gssapi krb5 ssl
d54 3
a56 1
CONFIGURE_STYLE= autoconf
d90 1
d127 3
@


1.140
log
@build with gcc 4.6 on ppc to avoid "unrecognizable insn" in src/ipc/StoreMap.cc
breakage reported by aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.139 2012/12/20 21:48:41 jasper Exp $
d12 1
a12 1
V=		3.2.5
@


1.139
log
@mark broken on mips64 for the same reason hppa fails.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.138 2012/12/17 18:56:56 sthen Exp $
d56 8
@


1.138
log
@squid 3.2.5; minor update, it just rolls in the compat/xstrerror.h diff.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.137 2012/12/11 18:22:54 sthen Exp $
d6 1
@


1.137
log
@mark BROKEN-hppa and remove my broken attempt at fixing the broken autoconf
test for atomic ops.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.136 2012/12/10 21:19:41 sthen Exp $
d11 1
a11 2
V=		3.2.4
REVISION-main=	0
@


1.136
log
@- move -ldap to a "MULTI_PACKAGES+= -ldap" within the 'if flavor !=
no_ldap' block

- squid optionally uses atomic ops if available, however in the code
it requires 4 byte operations, whereas configure only tests for int.
change configure test which may give hppa a chance to build; breakage
reported by landry
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.135 2012/12/04 10:40:19 sthen Exp $
d4 2
@


1.135
log
@update to Squid 3.2.4
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.134 2012/12/03 23:10:37 sthen Exp $
d3 1
a3 1
MULTI_PACKAGES=	-main -ldap -ntlm
d10 1
d96 1
@


1.134
log
@Don't allow autoconf to pick up et/com_err.h from e2fsprogs.
dpb build failure reported by naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.133 2012/11/28 17:45:29 sthen Exp $
d9 1
a9 1
V=		3.2.3
@


1.133
log
@Update to Squid 3.2.3.

This is merged from work by myself and Matthias Pitzl @@ genua, thanks to
Rodolfo Gouveia for testing with NTLM.

Flavours have been removed:

- the external helper programs for NTLM/LDAP are now in subpackages:
squid-ldap and squid-ntlm.

- SNMP support is built by default in Squid 3.x so this has moved
to the main package (no external dependencies for this).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.132 2012/08/27 06:19:48 ajacoutot Exp $
d86 2
a87 1
		LDFLAGS="-L${LOCALBASE}/lib"
@


1.132
log
@Remove -pthread patching.

from Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.131 2012/06/30 09:32:28 sthen Exp $
d3 1
a3 1
COMMENT=	WWW and FTP proxy cache and accelerator
d5 10
a14 2
DISTNAME=	squid-2.7.STABLE9
REVISION=	20
d16 3
a18 2
MASTER_SITES=	${HOMEPAGE}/Versions/v2/2.7/
DIST_SUBDIR=	squid
d30 3
a32 1
WANTLIB=	asn1 c com_err crypto krb5 gssapi m pthread ssl
d34 1
d38 1
a38 1
FLAVORS=	ldap ntlm snmp
d41 4
a44 12
.include <bsd.port.arch.mk>

# optimization workaround for gcc 2.95
.if ${PROPERTIES:Mgcc2}
PATCH_LIST=     patch-* gcc-*
.endif

AUTH=		basic digest negotiate
BASIC_AUTH=	NCSA YP
DIGEST_AUTH=	password
EXTERNAL_ACL=	ip_user unix_group
STOREIO=	aufs ufs diskd null
d47 1
a47 1
AUTOCONF_VERSION= 2.62
d49 1
a49 1
MODGNU_CONFIG_GUESS_DIRS=${WRKSRC}/cfgaux
d51 7
a57 2
CONFIGURE_ARGS+=--datadir="${PREFIX}/share/squid" \
		--enable-auth="${AUTH}" \
d59 5
a63 2
		--enable-basic-auth-helpers="${BASIC_AUTH}" \
		--enable-digest-auth-helpers="${DIGEST_AUTH}" \
d66 1
d68 4
a71 1
		--enable-negotiate-auth-helpers="squid_kerb_auth" \
d75 3
d79 13
a91 1
		--enable-follow-x-forwarded-for
d93 1
a93 1
.if ${FLAVOR:L:Mldap}
d95 6
a100 6
DIGEST_AUTH+=	ldap
EXTERNAL_ACL+=	ldap_group
WANTLIB+=	ldap lber
LIB_DEPENDS+=	databases/openldap
CONFIGURE_ENV+=	CPPFLAGS="-I${LOCALBASE}/include" \
		LDFLAGS="-L${LOCALBASE}/lib"
d103 1
a103 7
.if ${FLAVOR:L:Mntlm}
AUTH+=         ntlm
BASIC_AUTH+=   SMB
EXTERNAL_ACL+= wbinfo_group
RUN_DEPENDS+=  net/samba,ads
CONFIGURE_ARGS+=--enable-ntlm-auth-helpers="fakeauth SMB"
.endif
d105 3
a107 3
.if ${FLAVOR:L:Msnmp}
CONFIGURE_ARGS+=--enable-snmp
.endif
d110 5
a114 2
	@@${SUBST_CMD} ${WRKSRC}/src/defines.h \
		${WRKSRC}/helpers/external_acl/wbinfo_group/wbinfo_group.pl
d117 5
a121 3
	@@chown -R ${SHAREOWN}:${SHAREGRP} ${PREFIX}/share/examples/squid
	@@find ${PREFIX}/share/examples/squid/errors \
		-name '*.orig' -print0 | xargs -0 rm -f
@


1.131
log
@sync "SSLv2 disabled" messages with upstream's newer code, from Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.130 2012/06/22 15:43:47 sthen Exp $
d6 1
a6 1
REVISION=	19
@


1.130
log
@switch compiler check to bsd.port.arch.mk / PROPERTIES, req'd by naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.129 2012/06/20 08:48:27 sthen Exp $
d6 1
a6 1
REVISION=	18
@


1.129
log
@let squid handle things if SSLv2 is disabled, from Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.128 2012/06/20 07:10:39 ajacoutot Exp $
d29 1
a29 1
.include <bsd.own.mk>
d32 1
a32 1
.if ${COMPILER_VERSION:L:Mgcc2}
@


1.128
log
@Extend README:
If the proxy server is running on the same subnet as the clients, the
return traffic from the proxy will go directly back to them without
ever hitting the firewall, which means the states will never get updated
and may fill-up your pflog(4) with blocked attempts. To circumvent this
the "no state" option needs to be specified for the route-to rule.

ok Brad, intput/ok sthen@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.127 2012/04/28 11:06:12 ajacoutot Exp $
d6 1
a6 1
REVISION=	17
@


1.127
log
@Use LOCALSTATEDIR instead of local variables.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.126 2012/04/28 10:51:44 ajacoutot Exp $
d6 1
a6 1
REVISION=	16
@


1.126
log
@Use LOCALSTATEDIR.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.125 2012/03/29 13:39:00 sthen Exp $
d6 1
a6 1
REVISION=	15
d23 2
a24 2
SQUIDDIR?=	/var/squid
SUBST_VARS=	SQUIDDIR
a45 2

LOCALSTATEDIR=	${SQUIDDIR}
@


1.125
log
@Change SEPARATE_BUILD=(concurrent|simple) to Yes; bsd.port.mk doesn't
make a distinction between these.  ok aja@@ dcoppa@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.124 2011/09/20 19:34:59 sthen Exp $
d46 3
a61 1
		--localstatedir="${SQUIDDIR}" \
@


1.124
log
@take maintainer
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.123 2011/09/20 19:32:54 kili Exp $
d42 1
a42 1
SEPARATE_BUILD=	concurrent
@


1.123
log
@Remove brad as maintainer (per his request) and bump.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.122 2011/09/16 12:00:09 espie Exp $
d6 1
a6 1
REVISION=	14
d11 2
d20 1
@


1.122
log
@normalize pkgpath
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.121 2011/09/05 07:18:41 giovanni Exp $
d6 1
a6 1
REVISION=	13
a11 2

MAINTAINER=	Brad Smith <brad@@comstyle.com>
@


1.121
log
@
Fix kerberos helper, spotted and fixed by Andrea Parazzini
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.120 2011/06/02 13:41:41 ajacoutot Exp $
d6 1
a6 1
REVISION=	12
@


1.120
log
@Add a consistent header that substitutes FULLPKGNAME for the READMEs.

ok jasper@@ sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.119 2011/05/30 20:56:30 sthen Exp $
d6 1
a6 1
REVISION=	11
d35 1
a35 1
AUTH=		basic digest
@


1.119
log
@- reduce the default shutdown_lifetime to 20s; previously it was 30s which
is the maximum time rc.subr waits for a daemon, so usually it would end up
being forcefully killed (i.e. unclean shutdown -> cache must be rescanned
at next startup). suggested by aja@@, diff from Brad.

- adjust PLIST to prevent warnings with pkg_delete -c, from aja@@ ok Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.118 2011/05/18 14:47:55 sthen Exp $
d6 1
a6 1
REVISION=	10
@


1.118
log
@Add daemon_flags support to squid.rc. From Marcus MERIGHI.
ok Brad (maintainer), dcoppa@@, aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.117 2011/04/14 08:11:50 sthen Exp $
d6 1
a6 1
REVISION=	9
@


1.117
log
@Remove --enable-pf-transparent, it's no longer needed now that
PF supports divert-to. Pointed out by reyk on misc@@. Add documentation
to README showing how to configure a transparent proxy. ok Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.116 2011/03/27 19:38:32 sthen Exp $
d6 1
a6 1
REVISION=	8
@


1.116
log
@reset owner/group/mode before rc script; from Gleydson Soares via Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.115 2011/03/25 20:23:30 sthen Exp $
d6 1
a6 1
REVISION=	7
a53 1
		--enable-pf-transparent \
@


1.115
log
@a couple of obvious bumps for pfioc_natlook changes
(I'll fill in any others when my grep finishes running).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.114 2010/12/27 14:50:24 ajacoutot Exp $
d6 1
a6 1
REVISION=	6
@


1.114
log
@Simplify after recent rc.subr change.
The framework is now stable and we will start documenting it (at last).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.113 2010/12/24 10:40:06 ajacoutot Exp $
d6 1
a6 1
REVISION=	5
@


1.113
log
@Cope with recent rc.subr changes.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.112 2010/12/12 18:58:32 jasper Exp $
d6 1
a6 1
REVISION=	4
@


1.112
log
@style
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.111 2010/11/29 23:06:39 dcoppa Exp $
d6 1
a6 1
REVISION=	3
@


1.111
log
@I accidentally broke the ldap flavor. Mea culpa.

Pointed out by espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.110 2010/11/27 11:12:12 dcoppa Exp $
d6 1
a6 1
REVISION=	2
@


1.110
log
@Style fix (no bump needed).

Pointed out by Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.109 2010/11/26 15:44:33 dcoppa Exp $
d6 1
a6 1
REVISION=	1
@


1.109
log
@
"pexp is useless in the rc script, please remove it." ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.108 2010/11/26 13:45:04 dcoppa Exp $
d80 1
a80 1
.if${FLAVOR:L:Msnmp}
@


1.108
log
@Add ntlm flavor for NTLM authentication
Fix pthread linkage
Fix default path for errors directory
Switch to pkg-readmes
Add an rcscript

OK giovanni@@, Brad (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.107 2010/11/22 08:36:54 espie Exp $
d6 1
a6 1
REVISION=	0
@


1.107
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.106 2010/11/11 12:35:18 sthen Exp $
d6 1
d25 1
a25 1
FLAVORS=	ldap snmp
d35 1
d46 1
a46 1
		--enable-auth="basic digest" \
a60 1
USE_GROFF =	Yes
d72 8
d83 4
@


1.106
log
@new-style LIB_DEPENDS/REVISION/WANTLIB
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.105 2010/10/19 08:02:57 espie Exp $
d66 1
a66 1
LIB_DEPENDS+=	::databases/openldap
@


1.105
log
@USE_GROFF=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.104 2010/06/18 10:32:17 sthen Exp $
d65 2
a66 1
LIB_DEPENDS+=	ldap,lber::databases/openldap
@


1.104
log
@update to 2.7.STABLE9, from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.103 2010/05/19 07:38:06 espie Exp $
d59 1
@


1.103
log
@make sure patch does not get in for gcc2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.102 2010/04/15 14:58:24 ajacoutot Exp $
d5 1
a5 2
DISTNAME=	squid-2.7.STABLE7
PKGNAME=	${DISTNAME}p1
@


1.102
log
@Stupid poor blank lines, stupid poor blank lines...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.101 2010/02/03 06:41:17 jasper Exp $
a29 2
USE_GCC3?= No

d31 1
a31 1
.if ${USE_GCC3:L} == "no"
@


1.101
log
@SECURITY FIX for CVE-2010-0308, "Squid DNS Packet Processing
Denial of Service Vulnerability"

brad (MAINTAINER) came up with the same diff
ok ajacoutot@@ sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.100 2009/10/30 00:56:57 sthen Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p0
@


1.100
log
@update to the latest bug fix release in the 2.7 branch. From Brad (maintainer).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.99 2009/08/30 21:52:44 jasper Exp $
d6 1
@


1.99
log
@Security fix for CVE-2009-2855

ok brad (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.98 2009/02/08 15:04:33 sthen Exp $
d5 1
a5 2
DISTNAME=	squid-2.7.STABLE6
PKGNAME=	${DISTNAME}p0
@


1.98
log
@bug fix update to Squid 2.7-STABLE6, from Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.97 2009/01/08 03:37:24 sthen Exp $
d6 1
d8 1
a8 1
MASTER_SITES=	${HOMEPAGE}Versions/v2/2.7/
@


1.98.4.1
log
@MFC:

SECURITY FIX

Resolve CVE-2009-2855
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.99 2009/08/30 21:52:44 jasper Exp $
a5 1
PKGNAME=	${DISTNAME}p0
@


1.98.4.2
log
@MFC:

SECURITY FIX

Resolves:  CVE-2009-2855, CVE-2010-0308, and bugfixes

ok Brad jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.101 2010/02/03 06:41:17 jasper Exp $
d5 1
a5 1
DISTNAME=	squid-2.7.STABLE7
@


1.98.2.1
log
@MFC:

SECURITY FIX

Resolve CVE-2009-2855

ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.99 2009/08/30 21:52:44 jasper Exp $
a5 1
PKGNAME=	${DISTNAME}p0
@


1.97
log
@update to 2.7.STABLE5, various bugfixes. From Brad (and running here ~3wks).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.96 2008/08/20 16:35:15 brad Exp $
d5 1
a5 1
DISTNAME=	squid-2.7.STABLE5
d42 1
a42 1
AUTOCONF_VERSION= 2.61
@


1.96
log
@Upgrade Squid to 2.7-STABLE4

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.95 2008/07/16 21:18:27 brad Exp $
d5 1
a5 1
DISTNAME=	squid-2.7.STABLE4
@


1.95
log
@Upgrade Squid to 2.7-STABLE3.

ok okan@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.94 2008/05/31 10:07:45 jasper Exp $
d5 1
a5 1
DISTNAME=	squid-2.7.STABLE3
@


1.94
log
@- update squid to 2.6STABLE20
- update license marker
- remove transparent flavor
- add ldap flavor

from brad@@ (MAINTAINER), testing by several users
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.93 2008/02/20 09:18:01 landry Exp $
d5 1
a5 1
DISTNAME=	squid-2.6.STABLE20
d7 1
a7 1
MASTER_SITES=	${HOMEPAGE}Versions/v2/2.6/
@


1.93
log
@Add missing @@sample markers in PLIST, bump PKGNAME.

from brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.92 2008/01/28 22:04:00 rui Exp $
d5 1
a5 2
DISTNAME=	squid-2.6.STABLE18
PKGNAME=	${DISTNAME}p0
d14 1
a14 1
# GPL
d19 1
a19 1
WANTLIB=		c crypto m pthread ssl
d24 1
a24 1
FLAVORS=	transparent snmp
d36 5
d48 7
a54 3
		--enable-basic-auth-helpers="NCSA YP" \
		--enable-digest-auth-helpers="password" \
		--enable-external-acl-helpers="ip_user unix_group" \
d57 1
a57 1
		--enable-storeio="aufs ufs diskd null" \
d62 7
a68 2
.if ${FLAVOR:L:Mtransparent}
CONFIGURE_ARGS+=--enable-pf-transparent
@


1.92
log
@- update squid to 2.6.STABLE18

from brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.91 2007/12/04 01:27:13 todd Exp $
d6 1
@


1.91
log
@update to 2.6.STABLE17
from maint; works and builds ok for me
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.90 2007/10/08 07:04:50 aanriot Exp $
d5 1
a5 1
DISTNAME=	squid-2.6.STABLE17
@


1.90
log
@enable the "X-Forwarded-For" headers support which has been added in
Squid 2.6. It's not the default in squid.conf but can be enabled, and
it's useful e.g. when you are using squid through dansguardian, in order
to keep/show the source address of the client in the logs (otherwise,
squid thinks that everything comes from dansguardian).

ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.89 2007/09/10 17:49:23 merdely Exp $
d5 1
a5 2
DISTNAME=	squid-2.6.STABLE16
PKGNAME=	${DISTNAME}p0
d19 1
a19 1
WANTLIB=		c crypto m ssl
d48 2
a49 1
		--enable-storeio="ufs diskd null" \
@


1.89
log
@Update to Squid 2.6.STABLE16.

From brad (MAINTAINER)
ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.88 2007/09/01 20:11:21 kili Exp $
d6 1
d50 2
a51 1
		--localstatedir="${SQUIDDIR}"
@


1.88
log
@
Change Brads email address for now, so people can reach him instead of
getting bounces or 550s. Bump pkgnames. While here, remove quotes from
comments.

prompted by espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.87 2007/05/20 00:52:32 todd Exp $
d5 1
a5 2
DISTNAME=	squid-2.6.STABLE13
PKGNAME=	${DISTNAME}p0
d37 1
a37 1
AUTOCONF_VERSION= 2.59
@


1.87
log
@update to 2.6 stable13, from brad@@ (maint)
ok kili@@ tested by me
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.86 2007/04/12 15:10:02 robert Exp $
d3 1
a3 1
COMMENT=	"WWW and FTP proxy cache and accelerator"
d6 1
d13 1
a13 1
MAINTAINER=	Brad Smith <brad@@openbsd.org>
@


1.86
log
@update to version 2.6.STABLE12 (regen patches while here);

from MAINTAINER; Brad <brad@@comstyle.com>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.85 2007/02/01 07:46:24 todd Exp $
d5 1
a5 1
DISTNAME=	squid-2.6.STABLE12
@


1.85
log
@bugfix maintenance release update for Squid.
from maint brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.84 2007/01/13 16:13:28 todd Exp $
d5 1
a5 1
DISTNAME=	squid-2.6.STABLE9
@


1.84
log
@bugfix update; from maintainer (brad@@)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.83 2006/11/13 02:11:39 brad Exp $
d5 1
a5 1
DISTNAME=	squid-2.6.STABLE6
@


1.83
log
@upgrade to 2.6.STABLE5
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.82 2006/10/03 18:32:44 brad Exp $
d5 1
a5 1
DISTNAME=	squid-2.6.STABLE5
@


1.82
log
@fix the MESSAGE file, s/2.5/2.6/
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.81 2006/10/03 05:00:49 brad Exp $
d5 1
a5 2
DISTNAME=	squid-2.6.STABLE4
PKGNAME=	${DISTNAME}p1
@


1.81
log
@upgrade to 2.6.STABLE4

Squid 2.6 supports kqueue and hw accelerated SSL via OpenSSL,
as well as many other improvements.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.80 2006/06/19 11:49:26 bernd Exp $
d6 1
@


1.80
log
@Back out change with no review.

ok espie@@, pvalchev@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.78 2006/04/13 23:46:56 brad Exp $
d5 1
a5 1
DISTNAME=	squid-2.5.STABLE13
d7 1
a7 1
MASTER_SITES=	${HOMEPAGE}Versions/v2/2.5/
d37 1
a37 1
AUTOCONF_VERSION=2.13
d42 1
d48 1
a48 1
		--enable-storeio="ufs diskd" \
@


1.79
log
@upgrade to 2.5.STABLE14
@
text
@d5 1
a5 1
DISTNAME=	squid-2.5.STABLE14
a7 1
MASTER_SITES0=	${HOMEPAGE}Versions/v2/2.5/bugs/
a8 3

PATCH_DIST_STRIP= -p1
PATCHFILES=	${DISTNAME}-httpReplyDestroy.patch:0
@


1.78
log
@upgrade to 2.5.STABLE13
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.77 2006/01/06 01:40:27 brad Exp $
d5 1
a5 1
DISTNAME=	squid-2.5.STABLE13
d8 1
d10 3
@


1.77
log
@Have Squid open /dev/pf in read-only mode.

From: Andrey Matveev <evol at online dot ptt dot ru>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.76 2005/11/03 18:28:56 naddy Exp $
d5 1
a5 2
DISTNAME=	squid-2.5.STABLE12
PKGNAME=	${DISTNAME}p1
@


1.76
log
@Always explicitly set the AUTOCONF_VERSION to use.  In some cases
the default was not appropriate.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.75 2005/10/29 23:26:38 brad Exp $
d6 1
@


1.75
log
@upgrade to 2.5.STABLE12

- [Major] Error introduced in 2.5.STABLE11 causing truncated responses
  when using delay pools (Bug #1405)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.74 2005/09/25 17:03:32 brad Exp $
d37 1
@


1.74
log
@upgrade to 2.5.STABLE11

Alex Masterov has reported a vulnerability in Squid,
which potentially can be exploited by malicious people
to cause a DoS.

The vulnerability is caused due to an unspecified error
in the "sslConnectTimeout()" function after handling
malformed requests. This may be exploited to crash Squid.

CAN-2005-2796
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.73 2005/05/25 02:27:13 brad Exp $
d5 1
a5 1
DISTNAME=	squid-2.5.STABLE11
@


1.73
log
@upgrade to 2.5.STABLE10

- Malicious users may spoof DNS lookups if the DNS client UDP port (random,
  assigned by OS at startup) is unfiltered and your network is not protected
  from IP spoofing.
- CVE-1999-0710, adds access controls to the cachemgr.cgi script, preventing
  it from being abused to reach other servers than allowed in a local
  configuration file.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.72 2005/02/25 16:37:25 brad Exp $
d5 1
a5 1
DISTNAME=	squid-2.5.STABLE10
@


1.73.2.1
log
@MFC:
upgrade to 2.5.STABLE11

Alex Masterov has reported a vulnerability in Squid,
which potentially can be exploited by malicious people
to cause a DoS.

The vulnerability is caused due to an unspecified error
in the "sslConnectTimeout()" function after handling
malformed requests. This may be exploited to crash Squid.

CAN-2005-2796

ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.73 2005/05/25 02:27:13 brad Exp $
d5 1
a5 1
DISTNAME=	squid-2.5.STABLE11
@


1.73.2.2
log
@MFC:
upgrade to 2.5.STABLE12

- [Major] Error introduced in 2.5.STABLE11 causing truncated responses
when using delay pools (Bug #1405)

ok brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.73.2.1 2005/11/01 11:23:09 sturm Exp $
d5 1
a5 1
DISTNAME=	squid-2.5.STABLE12
@


1.72
log
@upgrade to Squid 2.5.STABLE9
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.71 2005/02/17 03:32:24 brad Exp $
d5 1
a5 1
DISTNAME=	squid-2.5.STABLE9
@


1.72.2.1
log
@SECURITY: update to 2.5.STABLE10
fix multiple vulnerabilities
http://www.vuxml.org/openbsd/cf9986f2-cd8d-11d9-a230-00065bd5b0b6.html

ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.72 2005/02/25 16:37:25 brad Exp $
d5 1
a5 1
DISTNAME=	squid-2.5.STABLE10
@


1.72.2.2
log
@MFC:
upgrade to 2.5.STABLE11

Alex Masterov has reported a vulnerability in Squid,
which potentially can be exploited by malicious people
to cause a DoS.

The vulnerability is caused due to an unspecified error
in the "sslConnectTimeout()" function after handling
malformed requests. This may be exploited to crash Squid.

CAN-2005-2796

ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.72.2.1 2005/05/26 03:47:27 robert Exp $
d5 1
a5 1
DISTNAME=	squid-2.5.STABLE11
@


1.72.2.3
log
@MFC:
upgrade to 2.5.STABLE12

- [Major] Error introduced in 2.5.STABLE11 causing truncated responses
when using delay pools (Bug #1405)

ok brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.72.2.2 2005/09/26 20:35:09 sturm Exp $
d5 1
a5 1
DISTNAME=	squid-2.5.STABLE12
@


1.71
log
@upgrade to Squid 2.5.STABLE8 + patches

Fixes 2 major issues over STABLE7 + the previous round of patches..

- Data corruption when HTTP reply headers is split in several packets
- Assertion failure on certain odd DNS responses
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.70 2005/02/11 02:47:55 brad Exp $
d5 1
a5 1
DISTNAME=	squid-2.5.STABLE8
a7 1
MASTER_SITES0=	${HOMEPAGE}Versions/v2/2.5/bugs/
a8 6

PATCH_DIST_STRIP= -p1
PATCHFILES=	${DISTNAME}-dns_assert.patch:0 \
		${DISTNAME}-format_fixes.patch:0 \
		${DISTNAME}-html_high_chars.patch:0 \
		${DISTNAME}-ftp_cleanup.patch:0
@


1.70
log
@add missing ERR_INVALID_RESP to PLIST
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.69 2005/02/04 04:27:38 brad Exp $
d5 1
a5 2
DISTNAME=	squid-2.5.STABLE7
PKGNAME=	${DISTNAME}p3
d12 4
a15 25
PATCHFILES=	${DISTNAME}-half_closed_POST.patch:0 \
		${DISTNAME}_req_resp_header.patch:0 \
		${DISTNAME}-helper_shutdown.patch:0 \
		${DISTNAME}-non_blocking_disk.patch:0 \
		${DISTNAME}-blank_response.patch:0 \
		${DISTNAME}-dothost.patch:0 \
		${DISTNAME}-PURGE_internal.patch:0 \
		${DISTNAME}-httpd_accel_vport.patch:0 \
		${DISTNAME}-cachemgr_vmobjects.patch:0 \
		${DISTNAME}-empty_acls.patch:0 \
		${DISTNAME}-close_other.patch:0 \
		${DISTNAME}-fakeauth_auth.patch:0 \
		${DISTNAME}-gopher_html_parsing.patch:0 \
		${DISTNAME}-wccp_denial_of_service.patch:0 \
		${DISTNAME}-dns_memleak.patch:0 \
		${DISTNAME}-fqdn_truncated.patch:0 \
		${DISTNAME}-ldap_spaces.patch:0 \
		${DISTNAME}-header_parsing.patch:0 \
		${DISTNAME}-httpd_accel_no_pmtu_disc.patch:0 \
		${DISTNAME}-ftp_datachannel.patch:0 \
		${DISTNAME}-short_icons_urls.patch:0 \
		${DISTNAME}-response_splitting.patch:0 \
		${DISTNAME}-wccp_buffer_overflow.patch:0 \
		${DISTNAME}-oversize_reply_headers.patch:0 \
		${DISTNAME}-ldap_search.patch:0
@


1.69
log
@SECURITY:
add most of the latest distribution patches which include 4 security
fixes.

-Correct handling of oversized reply headers
-Buffer overflow in WCCP recvfrom() call
-Strengthen Squid from HTTP response splitting cache pollution attack
-Reject malformed HTTP requests and responses that conflict with the HTTP specifications
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.68 2005/01/26 05:08:11 brad Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p2
@


1.68
log
@Fix 2 security issues...

A bug exists in the code that parses responses from Gopher servers.
The bug results in a buffer overflow if a Gopher server returns a
line longer than 4096 bytes.  The overflow results in memory
corruption and usually crashes Squid.

CAN-2005-0094

A bug exists in the code that parses WCCP messages.  An attacker
that sends a malformed WCCP messages, with a spoofed source address
matching Squid's "home router" can crash Squid.

CAN-2005-0095
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.67 2004/12/07 19:33:33 alek Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p1
d13 25
a37 2
PATCHFILES=	${DISTNAME}-gopher_html_parsing.patch:0 \
		${DISTNAME}-wccp_denial_of_service.patch:0
@


1.67
log
@- Kill DEINSTALL
- Replace INSTALL with @@samples, @@execs, etc.
- Add WANTLIB marker
- Bump PKGNAME
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.66 2004/10/20 21:44:20 brad Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p0
d9 1
d11 4
@


1.66
log
@upgrade to Squid 2.5.STABLE7

A parsing error exists in the SNMP module of Squid where a
specially-crafted UDP packet can potentially cause the server to
restart, closing all current connections.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.65 2004/08/04 16:12:14 naddy Exp $
d6 1
d20 1
@


1.65
log
@fix up MODGNU_CONFIG_GUESS_DIRS
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.64 2004/07/11 17:00:47 brad Exp $
d5 1
a5 1
DISTNAME=	squid-2.5.STABLE6
@


1.65.2.1
log
@MFC:

upgrade to Squid 2.5.STABLE7

A parsing error exists in the SNMP module of Squid where a
specially-crafted UDP packet can potentially cause the server to
restart, closing all current connections.

MFC:

upgrade to Squid 2.5.STABLE7

A parsing error exists in the SNMP module of Squid where a
specially-crafted UDP packet can potentially cause the server to
restart, closing all current connections.

---
Fix 2 security issues...

A bug exists in the code that parses responses from Gopher servers.
The bug results in a buffer overflow if a Gopher server returns a
line longer than 4096 bytes.  The overflow results in memory
corruption and usually crashes Squid.

CAN-2005-0094

A bug exists in the code that parses WCCP messages.  An attacker
that sends a malformed WCCP messages, with a spoofed source address
matching Squid's "home router" can crash Squid.

CAN-2005-0095

ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.65 2004/08/04 16:12:14 naddy Exp $
d5 1
a5 2
DISTNAME=	squid-2.5.STABLE7
PKGNAME=	${DISTNAME}p1
a7 1
MASTER_SITES0=	${HOMEPAGE}Versions/v2/2.5/bugs/
a8 4

PATCH_DIST_STRIP= -p1
PATCHFILES=	${DISTNAME}-gopher_html_parsing.patch:0 \
		${DISTNAME}-wccp_denial_of_service.patch:0
@


1.65.2.2
log
@MFC:

SECURITY:
add most of the latest distribution patches which include 4 security
fixes.

-Correct handling of oversized reply headers
-Buffer overflow in WCCP recvfrom() call
-Strengthen Squid from HTTP response splitting cache pollution attack
-Reject malformed HTTP requests and responses that conflict with the HTTP
 specifications

ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.65.2.1 2005/01/30 08:44:29 sturm Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p2
d13 2
a14 25
PATCHFILES=	${DISTNAME}-half_closed_POST.patch:0 \
		${DISTNAME}_req_resp_header.patch:0 \
		${DISTNAME}-helper_shutdown.patch:0 \
		${DISTNAME}-non_blocking_disk.patch:0 \
		${DISTNAME}-blank_response.patch:0 \
		${DISTNAME}-dothost.patch:0 \
		${DISTNAME}-PURGE_internal.patch:0 \
		${DISTNAME}-httpd_accel_vport.patch:0 \
		${DISTNAME}-cachemgr_vmobjects.patch:0 \
		${DISTNAME}-empty_acls.patch:0 \
		${DISTNAME}-close_other.patch:0 \
		${DISTNAME}-fakeauth_auth.patch:0 \
		${DISTNAME}-gopher_html_parsing.patch:0 \
		${DISTNAME}-wccp_denial_of_service.patch:0 \
		${DISTNAME}-dns_memleak.patch:0 \
		${DISTNAME}-fqdn_truncated.patch:0 \
		${DISTNAME}-ldap_spaces.patch:0 \
		${DISTNAME}-header_parsing.patch:0 \
		${DISTNAME}-httpd_accel_no_pmtu_disc.patch:0 \
		${DISTNAME}-ftp_datachannel.patch:0 \
		${DISTNAME}-short_icons_urls.patch:0 \
		${DISTNAME}-response_splitting.patch:0 \
		${DISTNAME}-wccp_buffer_overflow.patch:0 \
		${DISTNAME}-oversize_reply_headers.patch:0 \
		${DISTNAME}-ldap_search.patch:0
@


1.65.2.3
log
@MFC:

add missing ERR_INVALID_RESP to PLIST

ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.65.2.2 2005/02/05 21:49:26 sturm Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p3
@


1.65.2.4
log
@MFC:

upgrade to Squid 2.5.STABLE8 + patches

Fixes 2 major issues over STABLE7 + the previous round of patches..

- Data corruption when HTTP reply headers is split in several packets
- Assertion failure on certain odd DNS responses

ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.65.2.3 2005/02/12 09:16:03 sturm Exp $
d5 2
a6 1
DISTNAME=	squid-2.5.STABLE8
d13 25
a37 4
PATCHFILES=	${DISTNAME}-dns_assert.patch:0 \
		${DISTNAME}-format_fixes.patch:0 \
		${DISTNAME}-html_high_chars.patch:0 \
		${DISTNAME}-ftp_cleanup.patch:0
@


1.65.2.5
log
@update to squid 2.5.STABLE9

ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.65.2.4 2005/02/19 09:12:40 sturm Exp $
d5 1
a5 1
DISTNAME=	squid-2.5.STABLE9
d8 1
d10 6
@


1.65.2.6
log
@better check for missing error files

ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.65.2.5 2005/03/11 17:39:04 sturm Exp $
a5 1
PKGNAME=	${DISTNAME}p0
@


1.65.2.7
log
@SECURITY: update to 2.5.STABLE10
fix multiple vulnerabilities
http://www.vuxml.org/openbsd/cf9986f2-cd8d-11d9-a230-00065bd5b0b6.html

ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.65.2.6 2005/03/27 15:08:02 sturm Exp $
d5 2
a6 1
DISTNAME=	squid-2.5.STABLE10
@


1.65.2.8
log
@MFC:
upgrade to 2.5.STABLE11

Alex Masterov has reported a vulnerability in Squid,
which potentially can be exploited by malicious people
to cause a DoS.

The vulnerability is caused due to an unspecified error
in the "sslConnectTimeout()" function after handling
malformed requests. This may be exploited to crash Squid.

CAN-2005-2796

ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.65.2.7 2005/05/26 03:53:28 robert Exp $
d5 1
a5 1
DISTNAME=	squid-2.5.STABLE11
@


1.64
log
@upgrade to Squid 2.5.STABLE6
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.63 2004/06/11 08:00:35 brad Exp $
d37 1
a37 1
MODGNU_CONFIG_GUESS_DIRS= ${WRKSRC} ${WRKSRC}/cfgaux
@


1.63
log
@- add 2 more distribution patches
- add snmp FLAVOR from Joel CARNAT <joel at carnat dot net>
- add some auth types and auth/acl helpers
- add NTLM auth SMB patch even though the default port does NOT compile this support in
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62 2004/06/02 21:39:59 brad Exp $
d5 1
a5 2
DISTNAME=	squid-2.5.STABLE5
PKGNAME=	${DISTNAME}p4
a7 1
MASTER_SITES0=	${HOMEPAGE}Versions/v2/2.5/bugs/
a8 25

PATCH_DIST_STRIP= -p1
PATCHFILES=	${DISTNAME}-helper_warning.patch:0 \
		${DISTNAME}-vary.patch:0 \
		${DISTNAME}-deny_info.patch:0 \
		${DISTNAME}-CONNECT_timeout.patch:0 \
		${DISTNAME}-cache_swap_log.patch:0 \
		${DISTNAME}-rfc1035NameUnpack.patch:0 \
		${DISTNAME}-digest_blank.patch:0 \
		${DISTNAME}-post_assert.patch:0 \
		${DISTNAME}-spelling.patch:0 \
		${DISTNAME}-digest_ERR.patch:0 \
		${DISTNAME}-turkish_ERR_DNS_FAIL.patch:0 \
		${DISTNAME}-vary_negatively.patch:0 \
		${DISTNAME}-range_offset_limit.patch:0 \
		${DISTNAME}-large_cache_mem.patch:0 \
		${DISTNAME}-least-load.patch:0 \
		${DISTNAME}-cacheCurrentUnlinkRequests.patch:0 \
		${DISTNAME}-debug_client_ip.patch:0 \
		${DISTNAME}-openbsd_m88k.patch:0 \
		${DISTNAME}-ftp_html_doctype.patch:0 \
		${DISTNAME}-dns_localhost.patch:0 \
		${DISTNAME}-va_copy.patch:0 \
		${DISTNAME}-CONNECT_log_size.patch:0 \
		${DISTNAME}-proxy_abuse.patch:0
@


1.62
log
@more distribution patches
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.61 2004/04/21 11:11:19 brad Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p3
d33 3
a35 1
		${DISTNAME}-va_copy.patch:0
d50 1
a50 1
FLAVORS=	transparent
d65 7
a71 1
CONFIGURE_ARGS=	--enable-removal-policies="lru heap" \
a72 2
		--enable-ssl \
		--datadir="${PREFIX}/share/squid" \
d76 5
a80 1
CONFIGURE_ARGS+= --enable-pf-transparent
@


1.61
log
@Add 2 more distribution patches. One of them fixes an issue if using
Digest authentication. Users can crash Squid with a segmentation fault
simply by entering a blank user name.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.60 2004/04/13 00:40:47 brad Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p2
d20 14
a33 1
		${DISTNAME}-post_assert.patch:0
@


1.60
log
@- add some distribution patches. From: Robert Nagy <thuglife at bsd dot hu>
- only apply optimization workaround for gcc if using 2.95
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59 2004/03/03 01:20:42 brad Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p1
d18 3
a20 1
		${DISTNAME}-rfc1035NameUnpack.patch:0
@


1.59
log
@upgrade to Squid 2.5.STABLE5
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2004/02/25 02:35:17 naddy Exp $
d6 1
d8 2
a9 1
MASTER_SITES=	http://www.squid-cache.org/Versions/v2/2.5/
d12 8
d35 9
@


1.59.2.1
log
@MFC:
upgrade to Squid 2.5.STABLE5 + latest patches

A bug in Squid that allows users to bypass certain access controls.
Squid versions 2.5.STABLE4 and earlier contain a bug in the "%xx"
URL decoding function. It may insert a NULL character into decoded
URLs, which may allow users to bypass url_regex ACLs.

http://www.squid-cache.org/Advisories/SQUID-2004_1.txt

and

Add 2 more distribution patches. One of them fixes an issue if using
Digest authentication. Users can crash Squid with a segmentation fault
simply by entering a blank user name.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.61 2004/04/21 11:11:19 brad Exp $
a5 1
PKGNAME=	${DISTNAME}p2
d7 1
a7 2
MASTER_SITES=	${HOMEPAGE}Versions/v2/2.5/
MASTER_SITES0=	${HOMEPAGE}Versions/v2/2.5/bugs/
a9 10
PATCH_DIST_STRIP= -p1
PATCHFILES=	${DISTNAME}-helper_warning.patch:0 \
		${DISTNAME}-vary.patch:0 \
		${DISTNAME}-deny_info.patch:0 \
		${DISTNAME}-CONNECT_timeout.patch:0 \
		${DISTNAME}-cache_swap_log.patch:0 \
		${DISTNAME}-rfc1035NameUnpack.patch:0 \
		${DISTNAME}-digest_blank.patch:0 \
		${DISTNAME}-post_assert.patch:0

a24 9

.include <bsd.own.mk>

USE_GCC3?= No

# optimization workaround for gcc 2.95
.if ${USE_GCC3:L} == "no"
PATCH_LIST=     patch-* gcc-*
.endif
@


1.59.2.2
log
@MFC:

upgrade to Squid 2.5.STABLE7

A parsing error exists in the SNMP module of Squid where a
specially-crafted UDP packet can potentially cause the server to
restart, closing all current connections.

---
Fix 2 security issues...

A bug exists in the code that parses responses from Gopher servers.
The bug results in a buffer overflow if a Gopher server returns a
line longer than 4096 bytes.  The overflow results in memory
corruption and usually crashes Squid.

CAN-2005-0094

A bug exists in the code that parses WCCP messages.  An attacker
that sends a malformed WCCP messages, with a spoofed source address
matching Squid's "home router" can crash Squid.

CAN-2005-0095

ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59.2.1 2004/05/06 00:54:15 brad Exp $
d5 2
a6 2
DISTNAME=	squid-2.5.STABLE7
PKGNAME=	${DISTNAME}p1
d13 8
a20 2
PATCHFILES=	${DISTNAME}-gopher_html_parsing.patch:0 \
		${DISTNAME}-wccp_denial_of_service.patch:0
d49 3
a51 7
MODGNU_CONFIG_GUESS_DIRS=${WRKSRC}/cfgaux
CONFIGURE_ARGS+=--datadir="${PREFIX}/share/squid" \
		--enable-auth="basic digest" \
		--enable-basic-auth-helpers="NCSA YP" \
		--enable-digest-auth-helpers="password" \
		--enable-external-acl-helpers="ip_user unix_group" \
		--enable-removal-policies="lru heap" \
d53 1
a53 1
		--enable-storeio="ufs diskd" \
@


1.59.2.3
log
@MFC:

SECURITY:
add most of the latest distribution patches which include 4 security
fixes.

-Correct handling of oversized reply headers
-Buffer overflow in WCCP recvfrom() call
-Strengthen Squid from HTTP response splitting cache pollution attack
-Reject malformed HTTP requests and responses that conflict with the HTTP
specifications

ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59.2.2 2005/01/30 08:43:20 sturm Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p2
d13 2
a14 25
PATCHFILES=	${DISTNAME}-half_closed_POST.patch:0 \
		${DISTNAME}_req_resp_header.patch:0 \
		${DISTNAME}-helper_shutdown.patch:0 \
		${DISTNAME}-non_blocking_disk.patch:0 \
		${DISTNAME}-blank_response.patch:0 \
		${DISTNAME}-dothost.patch:0 \
		${DISTNAME}-PURGE_internal.patch:0 \
		${DISTNAME}-httpd_accel_vport.patch:0 \
		${DISTNAME}-cachemgr_vmobjects.patch:0 \
		${DISTNAME}-empty_acls.patch:0 \
		${DISTNAME}-close_other.patch:0 \
		${DISTNAME}-fakeauth_auth.patch:0 \
		${DISTNAME}-gopher_html_parsing.patch:0 \
		${DISTNAME}-wccp_denial_of_service.patch:0 \
		${DISTNAME}-dns_memleak.patch:0 \
		${DISTNAME}-fqdn_truncated.patch:0 \
		${DISTNAME}-ldap_spaces.patch:0 \
		${DISTNAME}-header_parsing.patch:0 \
		${DISTNAME}-httpd_accel_no_pmtu_disc.patch:0 \
		${DISTNAME}-ftp_datachannel.patch:0 \
		${DISTNAME}-short_icons_urls.patch:0 \
		${DISTNAME}-response_splitting.patch:0 \
		${DISTNAME}-wccp_buffer_overflow.patch:0 \
		${DISTNAME}-oversize_reply_headers.patch:0 \
		${DISTNAME}-ldap_search.patch:0
@


1.59.2.4
log
@MFC:

add missing ERR_INVALID_RESP to PLIST

ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59.2.3 2005/02/05 21:50:14 sturm Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p3
@


1.59.2.5
log
@MFC:

upgrade to Squid 2.5.STABLE8 + patches

Fixes 2 major issues over STABLE7 + the previous round of patches..

- Data corruption when HTTP reply headers is split in several packets
- Assertion failure on certain odd DNS responses

ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59.2.4 2005/02/12 09:16:42 sturm Exp $
d5 2
a6 1
DISTNAME=	squid-2.5.STABLE8
d13 25
a37 4
PATCHFILES=	${DISTNAME}-dns_assert.patch:0 \
		${DISTNAME}-format_fixes.patch:0 \
		${DISTNAME}-html_high_chars.patch:0 \
		${DISTNAME}-ftp_cleanup.patch:0
@


1.59.2.6
log
@update to squid 2.5.STABLE9

ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59.2.5 2005/02/19 09:13:15 sturm Exp $
d5 1
a5 1
DISTNAME=	squid-2.5.STABLE9
d8 1
d10 6
@


1.59.2.7
log
@better check for missing error files

ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59.2.6 2005/03/11 17:39:30 sturm Exp $
a5 1
PKGNAME=	${DISTNAME}p0
@


1.58
log
@The sparc64 compiler is gcc3 now; don't require the gcc3 module.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.57 2004/02/16 10:21:20 brad Exp $
d5 1
a5 2
DISTNAME=	squid-2.5.STABLE4
PKGNAME=	${DISTNAME}p1
a7 1
MASTER_SITES0=	http://www.squid-cache.org/Versions/v2/2.5/bugs/
a8 34

PATCH_DIST_STRIP= -p1
PATCHFILES=	squid-2.5.STABLE4-reconfigure_message.patch:0 \
		squid-2.5.STABLE4-digest_auth_pwchange.patch:0 \
		squid-2.5.STABLE4-redirect_login_space.patch:0 \
		squid-2.5.STABLE4-fqdnnegcache.patch:0 \
		squid-2.5.STABLE4_auth_param_doc.patch:0 \
		squid-2.5.STABLE4-errorpages.patch:0 \
		squid-2.5.STABLE4-error_load_text.patch:0 \
		squid-2.5.STABLE4-xpi_mime.patch:0 \
		squid-2.5.STABLE4-size_overflow.patch:0 \
		squid-2.5.STABLE4-extacl_auth_loop.patch:0 \
		squid-2.5.STABLE4-positive_dns_ttl.patch:0 \
		squid-2.5.STABLE4-gopherhtml.patch:0 \
		squid-2.5.STABLE4-synflood.patch:0 \
		squid-2.5.STABLE4-fqdn.patch:0 \
		squid-2.5.STABLE4-connect_cleanup.patch:0 \
		squid-2.5.STABLE4-pconn_post.patch:0 \
		squid-2.5.STABLE4-ftp_put.patch:0 \
		squid-2.5.STABLE4-pconn-load.patch:0 \
		squid-2.5.STABLE4-icon_urls.patch:0 \
		squid-2.5.STABLE4-redirector_access.patch:0 \
		squid-2.5.STABLE4-pconn-lifo.patch:0 \
		squid-2.5.STABLE4-cache_peer_maxconn.patch:0 \
		squid-2.5.STABLE4-pid_filename_none.patch:0 \
		squid-2.5.STABLE4-dns_namelength.patch:0 \
		squid-2.5.STABLE4-urllogin_acl.patch:0 \
		squid-2.5.STABLE4-russian.patch:0 \
		squid-2.5.STABLE4-redirlog.patch:0 \
		squid-2.5.STABLE4-partial_reload.patch:0 \
		squid-2.5.STABLE4-http_workarounds.patch:0 \
		squid-2.5.STABLE4-empty_proxy_auth.patch:0 \
		squid-2.5.STABLE4-ftp_telnet.patch:0 \
		squid-2.5.STABLE4-ipcache_purge.patch:0
@


1.57
log
@add 29 of the latest distribution patches.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2003/10/17 18:03:54 brad Exp $
a60 4

# Gcc 3
MODULES+=	gcc3
MODGCC3_ARCHES=	sparc64
@


1.56
log
@upgrade to Squid 2.5.STABLE4
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55 2003/08/22 21:12:18 brad Exp $
d6 1
d16 29
a44 1
		squid-2.5.STABLE4-fqdnnegcache.patch:0
d81 2
@


1.55
log
@apply another distribution patch, the squid-2.5.STABLE3-mem_cfd.patch patch
broke the forwarded_for directive.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.54 2003/08/18 17:13:40 brad Exp $
d5 1
a5 2
DISTNAME=	squid-2.5.STABLE3
PKGNAME=	${DISTNAME}p4
d12 4
a15 21
PATCHFILES=	squid-2.5.STABLE3-deny_info.patch:0 \
		squid-2.5.STABLE3-header_access_peer.patch:0 \
		squid-2.5.STABLE3-memwarnsbrk.patch:0 \
		squid-2.5.STABLE3-hostscomments.patch:0 \
		squid-2.5.STABLE3-tcp_reset_leak.patch:0 \
		squid-2.5.STABLE3-hostheader.patch:0 \
		squid-2.5.STABLE3-reply_body_max_size.patch:0 \
		squid-2.5.STABLE3-ie_refresh.patch:0 \
		squid-2.5.STABLE3-http_reply_access-denied.patch:0 \
		squid-2.5.STABLE3-SENT_PASV.patch:0 \
		squid-2.5.STABLE3-peer_digest_not_found_assertion.patch:0 \
		squid-2.5.STABLE3-round_robin_max_size.patch:0 \
		squid-2.5.STABLE3-syscalls.disk-counters.patch:0 \
		squid-2.5.STABLE3-blank-username-log.patch:0 \
		squid-2.5.STABLE3-mem_cfd.patch:0 \
		squid-2.5.STABLE3-aufs_open_fail.patch:0 \
		squid-2.5.STABLE3-aufs_threads.patch:0 \
		squid-2.5.STABLE3-digest_compile.patch:0 \
		squid-2.5.STABLE3-407_user_name.patch:0 \
		squid-2.5.STABLE3-multicast-ICP-timeout.patch:0 \
		squid-2.5.STABLE3-forwarded_for.patch:0
d34 1
a34 1
MODULES=	gcc3                                                                                                  
@


1.55.2.1
log
@MFC:
upgrade to Squid 2.5.STABLE5 + latest patches

A bug in Squid that allows users to bypass certain access controls.
Squid versions 2.5.STABLE4 and earlier contain a bug in the "%xx"
URL decoding function. It may insert a NULL character into decoded
URLs, which may allow users to bypass url_regex ACLs.

http://www.squid-cache.org/Advisories/SQUID-2004_1.txt
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.60 2004/04/13 00:40:47 brad Exp $
d5 2
a6 2
DISTNAME=	squid-2.5.STABLE5
PKGNAME=	${DISTNAME}p1
d8 2
a9 2
MASTER_SITES=	${HOMEPAGE}Versions/v2/2.5/
MASTER_SITES0=	${HOMEPAGE}Versions/v2/2.5/bugs/
d13 21
a33 6
PATCHFILES=	${DISTNAME}-helper_warning.patch:0 \
		${DISTNAME}-vary.patch:0 \
		${DISTNAME}-deny_info.patch:0 \
		${DISTNAME}-CONNECT_timeout.patch:0 \
		${DISTNAME}-cache_swap_log.patch:0 \
		${DISTNAME}-rfc1035NameUnpack.patch:0
d52 1
a52 1
MODULES=	gcc3
a69 2
	@@find ${PREFIX}/share/examples/squid/errors \
		-name '*.orig' -print0 | xargs -0 rm -f
@


1.55.2.2
log
@MFC:
Add 2 more distribution patches. One of them fixes an issue if using
Digest authentication. Users can crash Squid with a segmentation fault
simply by entering a blank user name.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55.2.1 2004/04/16 01:03:59 brad Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p2
d18 1
a18 3
		${DISTNAME}-rfc1035NameUnpack.patch:0 \
		${DISTNAME}-digest_blank.patch:0 \
		${DISTNAME}-post_assert.patch:0
@


1.54
log
@add some more distribution patches.
--
Thanks to mpech@@ for some testing
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2003/07/26 06:05:52 brad Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p3
d32 2
a33 1
		squid-2.5.STABLE3-multicast-ICP-timeout.patch:0
@


1.53
log
@optimization issues with gcc 2.95, use gcc 3 on sparc64.
--
From: Matthieu Herrb <matthieu dot herrb at laas dot fr>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.52 2003/07/23 01:47:20 brad Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p2
d23 10
a32 1
		squid-2.5.STABLE3-peer_digest_not_found_assertion.patch:0
@


1.52
log
@apply a number of distribution patches.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 2003/07/08 20:43:20 brad Exp $
d40 4
@


1.51
log
@switch to new schema for user/group.
--
From: sturm@@
Thanks to mpech@@ for testing and pointing out the user/group
I almost missed in MESSAGE.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2003/07/07 17:44:43 brad Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p1
d13 11
a23 1
PATCHFILES=	squid-2.5.STABLE3-deny_info.patch:0
@


1.50
log
@upgrade to Squid 2.5.STABLE3

throw in the SSL gatewaying support, this is not enabled by default.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2003/05/13 20:12:02 brad Exp $
d6 1
@


1.49
log
@upgrade to Squid 2.5.STABLE2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2002/10/04 13:52:48 brad Exp $
d5 1
a5 1
DISTNAME=	squid-2.5.STABLE2
d8 1
d11 3
d18 1
d35 1
@


1.48
log
@upgrade to Squid 2.5.STABLE1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2002/09/20 01:27:10 brad Exp $
d5 1
a5 1
DISTNAME=	squid-2.5.STABLE1
@


1.47
log
@upgrade to Squid 2.5.PRE13
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2002/08/23 14:10:20 brad Exp $
d5 1
a5 1
DISTNAME=	squid-2.5.PRE13
@


1.46
log
@upgrade to Squid 2.5.PRE11
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2002/07/24 18:14:08 brad Exp $
d5 1
a5 1
DISTNAME=	squid-2.5.PRE11
@


1.45
log
@upgrade to Squid 2.5.PRE10
- The squid binary has been moved from bin/ to sbin/
- The cachemgr CGI is statically linked now
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2002/06/30 18:29:22 brad Exp $
d5 1
a5 1
DISTNAME=	squid-2.5.PRE10
a18 1
SYSCONFDIR=	/etc/squid
a32 3
#		--enable-truncate \
#		--disable-unlinkd \

a35 4

# remove stale autoconf.h left in the distfile
post-extract:
	@@rm -f ${WRKSRC}/include/autoconf.h
@


1.44
log
@upgrade to Squid 2.5.PRE8
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2002/05/02 02:37:04 brad Exp $
d5 1
a5 1
DISTNAME=	squid-2.5.PRE8
a6 1
NEED_VERSION=	1.528
@


1.43
log
@upgrade to Squid 2.5.PRE7
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2002/04/17 18:03:21 brad Exp $
d5 1
a5 1
DISTNAME=	squid-2.5.PRE7
d7 1
a7 1
NEED_VERSION=	1.522
@


1.42
log
@upgrade to Squid 2.5.PRE6
- PF patches integrated
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2002/03/21 21:17:54 brad Exp $
d5 1
a5 1
DISTNAME=	squid-2.5.PRE6
@


1.41
log
@upgrade to Squid 2.5.PRE5
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2002/03/16 19:05:26 brad Exp $
d5 1
a5 1
DISTNAME=	squid-2.5.PRE5
d7 1
a7 1
NEED_VERSION=	1.500
d47 1
a47 1
	@@chown -R root:wheel ${PREFIX}/share/examples/squid
@


1.41.2.1
log
@MFC: SECURITY FIXES.
upgrade to Squid 2.5.PRE8
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2002/06/30 18:29:22 brad Exp $
d5 1
a5 1
DISTNAME=	squid-2.5.PRE8
d47 1
a47 1
	@@chown -R ${SHAREOWN}:${SHAREGRP} ${PREFIX}/share/examples/squid
@


1.40
log
@It's a bit unusual when I see in the Squid log that I'm supposedly running
i386-unknown-freebsd3.5 when I'm actually on a powerpc-unknown-openbsd3.0
system, turns out there is a stale auto-generated autoconf.h in the
distfile.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2002/03/16 18:18:30 brad Exp $
d5 1
a5 1
DISTNAME=	squid-2.5.PRE4
@


1.39
log
@enable SEPARATE_BUILD
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2002/03/01 04:36:29 brad Exp $
d41 4
@


1.38
log
@- fix CONFIGURE_ARGS option to enable removal policies (heap)
- enable diskd
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2002/02/20 01:17:03 brad Exp $
d27 1
d30 7
a36 4
CONFIGURE_ARGS= --datadir="${PREFIX}/share/squid" \
		--localstatedir="${SQUIDDIR}" \
		--enable-removal-policies="lru heap" \
		--enable-storeio="ufs diskd"
@


1.37
log
@upgrade to Squid 2.5.PRE4
- The port now runs as uid/gid of nobody:nobody instead of www:www
- This needs some testing, especially the transparent proxy support for PF
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2001/09/28 06:02:15 pvalchev Exp $
d31 2
a32 1
		--enable-removal-policies
@


1.36
log
@CONFIGURE_STYLE=gnu w/ proper MODGNU_CONFIG_GUESS_DIRS
needed for the powerpc -> macppc name change
@
text
@d1 1
a1 2
# $OpenBSD: Makefile,v 1.35 2001/08/30 02:24:52 brad Exp $
# Uses pthreads (can but does not at the moment)
d5 1
a5 2
DISTNAME=	squid-2.3.STABLE5
PKGNAME=	squid-2.3
d7 2
a8 4
NEED_VERSION=	1.413
MASTER_SITES=	http://www.squid-cache.org/Versions/v2/2.3/ \
   		ftp://ftp.funet.fi/pub/mirrors/squid.nlanr.net/pub/squid-2/STABLE/
EXTRACT_SUFX=	-src.tar.gz
d21 2
a22 2
STATEDIR?=	/var/squid
SUBST_VARS=	STATEDIR
d24 2
a25 4
CONFIGURE_STYLE= gnu
MODGNU_CONFIG_GUESS_DIRS=	${WRKSRC} ${WRKSRC}/cfgaux
CONFIGURE_ARGS=	--localstatedir="${STATEDIR}" \
		--enable-heap-replacement
d27 12
a38 1
MAKE_FILE=	makefile
@


1.35
log
@more ports which use or can use pthreads
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2001/07/20 14:37:38 brad Exp $
d29 1
@


1.34
log
@upgrade to Squid 2.3.STABLE5
@
text
@d1 2
a2 1
# $OpenBSD: Makefile,v 1.33 2001/07/13 11:24:53 naddy Exp $
@


1.33
log
@MASTER_SITES fix by Heikki Korpela <heko@@saitti.net>:
- Add ftp.funet.fi and ftp.sunet.se mirrors where available.
- Remove broken ftp.funet.fi references.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2001/06/08 19:03:35 brad Exp $
d5 1
a5 1
DISTNAME=	squid-2.3.STABLE4
a10 1
MASTER_SITES0=	http://www.squid-cache.org/Versions/v2/2.3/bugs/
a12 9

PATCHFILES=	squid-2.3.stable4-ftp_icon_not_found.patch:0 \
		squid-2.3.stable4-internal_dns_rcode_table_formatting.patch:0 \
		squid-2.3.stable4-ipfw_configure.patch:0 \
		squid-2.3.stable4-invalid_ip_acl_entry.patch:0 \
		squid-2.3.stable4-accel_only_access.patch:0 \
		squid-2.3.stable4-html_quoting.patch:0 \
		squid-2.3.stable4-carp-assertion.patch:0 \
		squid-2.3.stable4-snmp-community-null-pointer.patch:0
@


1.32
log
@remove the 2 FLAVORs currently available, enable the alternate heap
replacement algorithms by default.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2001/05/06 04:22:57 lebel Exp $
d9 2
a10 1
MASTER_SITES=	http://www.squid-cache.org/Versions/v2/2.3/
@


1.31
log
@www: integrate COMMENT, bump NEED_VERSION.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2001/03/14 14:39:54 brad Exp $
d8 1
a8 1
NEED_VERSION=	1.402
d37 2
a38 12
CONFIGURE_ARGS=	--localstatedir="${STATEDIR}"

FLAVORS=	transparent heap
FLAVOR?=

.if ${FLAVOR:L:Mtransparent}
CONFIGURE_ARGS+= --enable-ipf-transparent
.endif

.if ${FLAVOR:L:Mheap}
CONFIGURE_ARGS+= --enable-heap-replacement
.endif
@


1.30
log
@add a distribution patch:

squid-2.3.stable4-snmp-community-null-pointer.patch
Sending an unparsable SNMP query to Squid can cause a segment violation
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.29 2001/01/17 02:38:20 brad Exp $
d8 1
a8 1
NEED_VERSION=	1.336
@


1.29
log
@add heap FLAVOR, enables alternate cache object replacement algorithms.
--
Requested by: J Shoemaker <shoemaker@@softhome.net>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2000/12/08 17:09:52 brad Exp $
d18 2
a19 1
		squid-2.3.stable4-carp-assertion.patch:0
@


1.28
log
@add a distribution patch: (and update checksum for HTML quoting patch)

squid-2.3.stable4-carp-assertion.patch
Comparing floating point numbers for equality is tricky. The old way can cause an assertion even though two numbers actually do add up to 1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2000/11/17 22:35:52 brad Exp $
d36 1
a36 1
FLAVORS=	transparent
d41 4
@


1.27
log
@add 2 distribution patches: (and fix a mistake in the HTML quoting patch)

squid-2.3.stable4-accel_only_access.patch
clientAccessCheck incorrectly returns ACCESS_ALLOWED for proxy requests
when configured as an HTTP accelerator only

squid-2.3.stable4-html_quoting.patch
Everywhere where Squid inserts text received from the network into a HTML
page (error pages, FTP listings, Gopher listings, ...) care must be taken
to ensure that the text is properly encoded as HTML, or a malicious user
might be able to insert script code or other HTML tags, and exploit the
web browser of any user visiting their page or clicking on that funny link
received in a email..
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2000/10/08 20:37:08 brad Exp $
d17 2
a18 1
		squid-2.3.stable4-html_quoting.patch:0
@


1.26
log
@add a transparent FLAVOR, enables support for IPFilter so Squid can be
used in a transparent proxy setup. suggested by jakob@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2000/09/24 07:04:14 brad Exp $
d6 1
a6 1
NEED_VERSION=	1.330
d15 3
a17 1
		squid-2.3.stable4-invalid_ip_acl_entry.patch:0
@


1.25
log
@add name to MAINTAINER
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2000/09/06 05:48:49 brad Exp $
d32 7
@


1.24
log
@remove SYSCONFDIR from SUBST_VARS and SUBST_VARS too if no other variables
are listed
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2000/08/31 06:43:40 brad Exp $
d6 1
a6 1
NEED_VERSION=	1.324
d19 1
a19 1
MAINTAINER=	brad@@openbsd.org
@


1.23
log
@new make eliminates the need for FAKE_FLAGS
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2000/08/11 06:30:34 brad Exp $
d6 1
a6 1
NEED_VERSION=	1.322
d28 1
a28 1
SUBST_VARS=	SYSCONFDIR STATEDIR
@


1.22
log
@add 2 distribution patches:

squid-2.3.stable4-ipfw_configure.patch
The configure script uses "==" when it should use "=" for /bin/test

squid-2.3.stable4-invalid_ip_acl_entry.patch
The code that scans ACL tokens for IP addresses and hostnames couldn't
tell that "123.foo.com" is a hostname rather than an IP address
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2000/07/23 18:21:20 brad Exp $
d6 1
a6 1
NEED_VERSION=	1.310
a31 2

FAKE_FLAGS=	MFLAGS="DESTDIR=\"${WRKINST}\""
@


1.21
log
@add a distribution patch:

squid-2.3.stable4-internal_dns_rcode_table_formatting.patch
Missing a newline on cachemgr output
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2000/07/20 22:41:40 chris Exp $
d13 3
a15 1
		squid-2.3.stable4-internal_dns_rcode_table_formatting.patch:0
@


1.20
log
@Add a patch for Squid STABLE4 that fixes ftp icons
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2000/07/20 01:17:09 brad Exp $
d12 2
a13 1
PATCHFILES=	squid-2.3.stable4-ftp_icon_not_found.patch:0
d26 1
a26 1
SUBST_VARS=SYSCONFDIR STATEDIR
@


1.19
log
@upgrade to Squid 2.3.STABLE4
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2000/06/28 07:08:28 brad Exp $
d8 1
d11 2
@


1.18
log
@upgrade to Squid 2.3.STABLE3

- NOTE: you can now override the dir used for cache/logs by using the
variable STATEDIR. i.e., "make STATEDIR=/alternate/dir package", and it
will be substituted into the INSTALL/DEINSTALL scripts.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2000/06/10 06:27:25 brad Exp $
d3 1
a3 1
DISTNAME=	squid-2.3.STABLE3
d6 1
a6 1
NEED_VERSION=	1.301
a7 1
MASTER_SITES0=	http://www.squid-cache.org/Versions/v2/2.3/bugs/
a9 4

PATCHFILES=	squid-2.3.stable3-carp_compile.patch:0 \
		squid-2.3.stable3-storeExpiredReferenceAge.patch:0 \
		squid-2.3.stable3-zero-content-length.patch:0
@


1.17
log
@correct HOMEPAGE URL
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2000/06/09 20:21:41 espie Exp $
d3 2
a4 2
DISTNAME=	squid-2.2.STABLE5
PKGNAME=	squid-2.2
d6 3
a8 3
NEED_VERSION=	1.295
MASTER_SITES=	http://www.squid-cache.org/Versions/v2/2.2/
MASTER_SITES0=	http://www.squid-cache.org/Versions/v2/2.2/bugs/
d12 3
a14 9
PATCHFILES=	squid-2.2.stable5-no_cache.patch:0 \
		squid-2.2.stable5-ipcache_negative.patch:0 \
		squid-2.2.stable5-newlines_in_auth.patch:0 \
		squid-2.2.stable5-domain-match.patch:0
.if defined(PATCH_DEBUG) && ${PATCH_DEBUG:U} == YES
PATCH_DIST_ARGS=-d ${WRKSRC}/src -E ${PATCH_DIST_STRIP}
.else
PATCH_DIST_ARGS=-d ${WRKSRC}/src --forward --quiet -E ${PATCH_DIST_STRIP}
.endif
d26 1
a26 1
STATEDIR=	/var/squid
d29 4
a32 4
HAS_CONFIGURE=	Yes
CONFIGURE_ARGS=--prefix='$${DESTDIR}${PREFIX}'
CONFIGURE_ARGS+=--sysconfdir='$${DESTDIR}${SYSCONFDIR}'
CONFIGURE_ARGS+=	--localstatedir="${STATEDIR}"
@


1.16
log
@Fake
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2000/04/09 17:38:40 espie Exp $
a6 1
HOMEPAGE=	http://squid.nlanr.net/Squid/
d21 2
@


1.15
log
@explicit FAKE=No, so that we can turn FAKE on by default.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2000/03/30 21:59:26 brad Exp $
d6 2
a7 2
NEED_VERSION=	1.218
FAKE=No
d31 7
a37 2
GNU_CONFIGURE=	yes
CONFIGURE_ARGS=	--localstatedir="/var/squid"
a39 3

post-install:
	@@PKG_PREFIX="${PREFIX}" sh ${PKGDIR}/INSTALL ${DISTNAME} POST-INSTALL
@


1.15.2.1
log
@bring www as of cut-over date into 2.7 branch
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2000/08/11 06:30:34 brad Exp $
d3 2
a4 2
DISTNAME=	squid-2.3.STABLE4
PKGNAME=	squid-2.3
d6 4
a9 3
NEED_VERSION=	1.310
MASTER_SITES=	http://www.squid-cache.org/Versions/v2/2.3/
MASTER_SITES0=	http://www.squid-cache.org/Versions/v2/2.3/bugs/
d13 9
a21 6
PATCHFILES=	squid-2.3.stable4-ftp_icon_not_found.patch:0 \
		squid-2.3.stable4-internal_dns_rcode_table_formatting.patch:0 \
		squid-2.3.stable4-ipfw_configure.patch:0 \
		squid-2.3.stable4-invalid_ip_acl_entry.patch:0

HOMEPAGE=	http://www.squid-cache.org/
d31 2
a32 2
STATEDIR?=	/var/squid
SUBST_VARS=	SYSCONFDIR STATEDIR
d34 1
a34 2
CONFIGURE_STYLE= gnu
CONFIGURE_ARGS=	--localstatedir="${STATEDIR}"
d36 2
a37 3
FAKE_FLAGS=	MFLAGS="DESTDIR=\"${WRKINST}\""

MAKE_FILE=	makefile
@


1.14
log
@- bump NEED_VERSION
- fix MASTER_SITES URLs, squid.nlanr.net -> www.squid-cache.org
- use DIST_SUBDIR
- YES -> Yes
- remove unnecessary CONFIGURE_ARGS option
- remove STRIP variable since INSTALL_PROGRAM has used INSTALL_STRIP for
awhile now, better fix coming soon
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2000/03/24 22:12:03 espie Exp $
d7 1
@


1.13
log
@Move all NEED_VERSION right after CATEGORY
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2000/02/22 17:08:48 espie Exp $
d6 3
a8 3
NEED_VERSION=	1.210
MASTER_SITES=	http://squid.nlanr.net/Versions/v2/2.2/
MASTER_SITES0=	http://squid.nlanr.net/Versions/v2/2.2/bugs/
d10 1
a15 1

d24 4
a27 5
LICENSE_TYPE=		GPL
PERMIT_PACKAGE_CDROM=	YES
PERMIT_PACKAGE_FTP=	YES
PERMIT_DISTFILES_CDROM=	YES
PERMIT_DISTFILES_FTP=	YES
d31 1
a31 1
CONFIGURE_ARGS=	--sysconfdir=${SYSCONFDIR} --localstatedir="/var/squid"
a33 1
STRIP=		# won't install scripts correctly otherwise.
d36 1
a36 1
	@@PKG_PREFIX="${PREFIX}" ${SH} ${PKGDIR}/INSTALL ${DISTNAME} POST-INSTALL
@


1.12
log
@MAKEFILE-> MAKE_FILE
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2000/02/15 05:05:25 turan Exp $
d6 1
a10 1
NEED_VERSION=	1.210
@


1.11
log
@espie will not shut up about this, DISTF -> DISTFILES, PKG -> PACKAGE
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2000/02/12 08:02:33 turan Exp $
d10 1
a10 1
NEED_VERSION=	1.175
d34 1
a34 1
MAKEFILE=	makefile
@


1.10
log
@gpl licenses
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2000/02/02 17:02:38 espie Exp $
d25 4
a28 4
PERMIT_PKG_CDROM=	YES
PERMIT_PKG_FTP=		YES
PERMIT_DISTF_CDROM=	YES
PERMIT_DISTF_FTP=	YES
@


1.9
log
@Kill most instances of PATCH_SITES
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2000/01/17 15:38:38 brad Exp $
d23 6
@


1.8
log
@- check that PATCH_DEBUG is set to yes instead of just being defined
- change MAINTAINER, ports@@ -> brad@@
- add 2 distribution patches;

squid-2.2.stable5-domain-match.patch
Matching a hostname and a domain name doesn't always work, depending on
leading dots and other edge conditions. Plus, the code for matching in
ACL's worked one way, while the code for matching 'cache_peer_domain' list
worked slighly different.

The patch below makes all host/domain matching operate the same way. It
also changes the rules a bit, so your current configuration probably will
not work the way you want after applying this patch.

- patch was included in the patches dir because of the difference in
relative path in comparison to all the other distribution patches.

squid-2.2.stable5-mkhttpdlogtime-end-of-year.patch = patch-ai
mkhttpdlogtime() generates a date string of the form 31/Dec/1999:23:59:59 +0900.
But when the year changes, the timezone offset will be wrong, for example:
01/Jan/2000:00:00:00 -1500.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 1999/12/09 19:48:17 brad Exp $
d7 1
d10 6
a15 5
PATCH_SITES=	http://squid.nlanr.net/Versions/v2/2.2/bugs/
PATCHFILES=	squid-2.2.stable5-no_cache.patch \
		squid-2.2.stable5-ipcache_negative.patch \
		squid-2.2.stable5-newlines_in_auth.patch \
		squid-2.2.stable5-domain-match.patch
@


1.7
log
@add 3 distribution patches;

squid-2.2.stable5-newlines_in_auth.patch
After decoding the base64 encoded "user:password" pair given by the
client, squid doesn't strip out any '\n' found in the resulting
string. Given such a string, any external authenticator will receive two
lines instead of one, and most probably send two results. Now, any
subsequent authentification exchange will have its answer shifted by
one. Therefore, a malicious user can gain access to sites they should not
have access to.

squid-2.2.stable5-ipcache_negative.patch
The IP cache immediately removes entries that should be negatively
cached. This appears to be due to some changes made for retrying failed
connections.

squid-2.2.stable5-no_cache.patch
A missing no_cache list is treated the same as no_cache deny all.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 1999/10/01 00:01:54 brad Exp $
d12 3
a14 2
		squid-2.2.stable5-newlines_in_auth.patch
.if defined(PATCH_DEBUG)
d20 1
a20 1
MAINTAINER=	ports@@openbsd.org
@


1.6
log
@upgrade to Squid 2.2-STABLE5
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 1999/07/08 23:27:39 brad Exp $
d9 10
a20 2
STRIP=		# won't install scripts correctly otherwise.
MAKEFILE=	makefile
d23 4
a26 1
CONFIGURE_ARGS=	--sysconfdir=${SYSCONFDIR} --localstatedir=/var/squid
@


1.5
log
@upgrade to Squid 2.2-STABLE4
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 1999/05/22 18:23:46 brad Exp $
d3 1
a3 1
DISTNAME=	squid-2.2.STABLE4
d6 1
a6 1
MASTER_SITES=	http://squid.nlanr.net/Squid/v2/2.2/
@


1.4
log
@upgrade to Squid 2.2.STABLE3
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 1999/05/09 20:01:50 brad Exp $
d3 1
a3 1
DISTNAME=	squid-2.2.STABLE3
d6 1
a6 4
MASTER_SITES=	ftp://squid.nlanr.net/pub/squid-2/STABLE/ \
		ftp://www.unimelb.edu.au/pub/cwis/servers/unix/squid/squid-2/STABLE/ \
		ftp://sunsite.auc.dk/pub/infosystems/squid/squid-2/STABLE/ \
		ftp://ftp.net.lut.ac.uk/squid/squid-2/STABLE/
@


1.3
log
@upgrade to Squid 2.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 1999/03/17 03:59:28 brad Exp $
d3 1
a3 1
DISTNAME=	squid-2.2.STABLE2
a13 1
WRKSRC=		${WRKDIR}/${PKGNAME}.STABLE2
@


1.2
log
@add SYSCONFDIR var
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 1998/09/14 01:36:52 marc Exp $
d3 2
a4 2
DISTNAME=	squid-1.1.22-src
PKGNAME=	squid-1.1.22
d6 5
a10 2
MASTER_SITES=	ftp://mirror.aarnet.edu.au/pub/squid/squid-1.1/ \
		ftp://squid.nlanr.net/pub/squid-1.1/
d12 1
a12 1
MAINTAINER=	d@@openbsd.org
d14 3
a16 1
WRKSRC=		${WRKDIR}/${PKGNAME}
d20 3
a22 1
INSTALL_TARGET=	-f makefile install
@


1.1
log
@Initial revision
@
text
@d1 1
a1 2
# $OpenBSD$
#
d12 1
d14 1
a14 1
CONFIGURE_ARGS=	--sysconfdir=/etc --localstatedir=/var/squid
@


1.1.1.1
log
@squid port from d@@openbsd.org
@
text
@@
