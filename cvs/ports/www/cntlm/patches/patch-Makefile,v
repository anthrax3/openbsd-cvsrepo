head	1.7;
access;
symbols
	OPENBSD_6_0:1.6.0.14
	OPENBSD_6_0_BASE:1.6
	OPENBSD_5_9:1.6.0.10
	OPENBSD_5_9_BASE:1.6
	OPENBSD_5_8:1.6.0.12
	OPENBSD_5_8_BASE:1.6
	OPENBSD_5_7:1.6.0.8
	OPENBSD_5_7_BASE:1.6
	OPENBSD_5_6:1.6.0.6
	OPENBSD_5_6_BASE:1.6
	OPENBSD_5_5:1.6.0.4
	OPENBSD_5_5_BASE:1.6
	OPENBSD_5_4:1.6.0.2
	OPENBSD_5_4_BASE:1.6
	OPENBSD_5_3:1.5.0.4
	OPENBSD_5_3_BASE:1.5
	OPENBSD_5_2:1.5.0.2
	OPENBSD_5_2_BASE:1.5
	OPENBSD_5_1_BASE:1.3
	OPENBSD_5_1:1.3.0.2
	OPENBSD_5_0:1.1.1.1.0.8
	OPENBSD_5_0_BASE:1.1.1.1
	OPENBSD_4_9:1.1.1.1.0.6
	OPENBSD_4_9_BASE:1.1.1.1
	OPENBSD_4_8:1.1.1.1.0.4
	OPENBSD_4_8_BASE:1.1.1.1
	OPENBSD_4_7:1.1.1.1.0.2
	OPENBSD_4_7_BASE:1.1.1.1
	dcoppa_20091008:1.1.1.1
	sthen:1.1.1;
locks; strict;
comment	@# @;


1.7
date	2017.02.27.10.09.05;	author dcoppa;	state Exp;
branches;
next	1.6;
commitid	uyUmJAyqvjCvcAA1;

1.6
date	2013.06.05.09.29.56;	author dcoppa;	state Exp;
branches;
next	1.5;

1.5
date	2012.05.15.08.05.19;	author dcoppa;	state Exp;
branches;
next	1.4;

1.4
date	2012.03.11.17.42.05;	author dcoppa;	state Exp;
branches;
next	1.3;

1.3
date	2012.01.27.09.54.45;	author dcoppa;	state Exp;
branches;
next	1.2;

1.2
date	2012.01.25.22.00.15;	author dcoppa;	state Exp;
branches;
next	1.1;

1.1
date	2009.10.08.19.13.09;	author sthen;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2009.10.08.19.13.09;	author sthen;	state Exp;
branches;
next	;


desc
@@


1.7
log
@
Do not hardcode gcc
@
text
@$OpenBSD: patch-Makefile,v 1.6 2013/06/05 09:29:56 dcoppa Exp $
--- Makefile.orig	Fri Apr 20 02:28:07 2012
+++ Makefile	Mon Feb 27 11:03:47 2017
@@@@ -13,7 +13,7 @@@@ MANDIR     	:= $(DESTDIR)/usr/share/man
 # _ALL_SOURCE is for AIX 5.3 LOG_PERROR constant
 #
 NAME		:= cntlm
-CC		:= gcc
+CC		?= gcc
 VER		:= $(shell cat VERSION)
 OS		:= $(shell uname -s)
 OSLDFLAGS	:= $(shell [ $(OS) = "SunOS" ] && echo "-lrt -lsocket -lnsl")
@@@@ -23,7 +23,7 @@@@ CYGWIN_REQS	:= cygwin1.dll cyggcc_s-1.dll cygstdc++-6.
 ifeq ($(DEBUG),1)
 	CFLAGS	+= -g  -std=c99 -Wall -pedantic -D__BSD_VISIBLE -D_ALL_SOURCE -D_XOPEN_SOURCE=600 -D_POSIX_C_SOURCE=200112 -D_ISOC99_SOURCE -D_REENTRANT -D_BSD_SOURCE -DVERSION=\"'$(VER)'\"
 else
-	CFLAGS	+= -O3 -std=c99 -D__BSD_VISIBLE -D_ALL_SOURCE -D_XOPEN_SOURCE=600 -D_POSIX_C_SOURCE=200112 -D_ISOC99_SOURCE -D_REENTRANT -D_BSD_SOURCE -DVERSION=\"'$(VER)'\"
+	CFLAGS	+= -std=c99 -D__BSD_VISIBLE -D_ALL_SOURCE -D_XOPEN_SOURCE=600 -D_POSIX_C_SOURCE=200112 -D_ISOC99_SOURCE -D_REENTRANT -D_BSD_SOURCE -DVERSION=\"'$(VER)'\"
 endif
 
 ifneq ($(findstring CYGWIN,$(OS)),)
@@@@ -34,19 +34,20 @@@@ endif
 
 $(NAME): configure-stamp $(OBJS)
 	@@echo "Linking $@@"
-	@@$(CC) $(CFLAGS) -o $@@ $(OBJS) $(LDFLAGS)
+	$(CC) $(CFLAGS) -o $@@ $(OBJS) $(LDFLAGS)
 
 main.o: main.c
 	@@echo "Compiling $<"
 	@@if [ -z "$(SYSCONFDIR)" ]; then \
 		$(CC) $(CFLAGS) -c main.c -o $@@; \
 	else \
+		echo $(CC) $(CFLAGS) -DSYSCONFDIR=\"$(SYSCONFDIR)\" -c main.c -o $@@; \
 		$(CC) $(CFLAGS) -DSYSCONFDIR=\"$(SYSCONFDIR)\" -c main.c -o $@@; \
 	fi
 
 %.o: %.c
 	@@echo "Compiling $<"
-	@@$(CC) $(CFLAGS) -c -o $@@ $<
+	$(CC) $(CFLAGS) -c -o $@@ $<
 
 configure-stamp:
 	./configure
@


1.6
log
@Update to cntlm-0.93beta5.

Final 0.93 release continues to be an unfulfilled dream and this
seems to perform better than 0.92.3 in my tests.

Based on an old diff by sthen@@
@
text
@d1 1
a1 1
$OpenBSD: patch-Makefile,v 1.5 2012/05/15 08:05:19 dcoppa Exp $
d3 10
a12 1
+++ Makefile	Wed Jun  5 10:47:08 2013
@


1.5
log
@Simplify; no pkg changes.

Based on a diff by sthen@@
@
text
@d1 13
a13 13
$OpenBSD: patch-Makefile,v 1.4 2012/03/11 17:42:05 dcoppa Exp $
--- Makefile.orig	Fri Mar  2 14:18:35 2012
+++ Makefile	Tue May 15 09:59:18 2012
@@@@ -15,7 +15,7 @@@@ MANDIR=$(DESTDIR)/usr/share/man
 NAME=cntlm
 CC=gcc
 VER=`cat VERSION`
-CFLAGS+=$(FLAGS) -std=c99 -Wall -Wno-unused-but-set-variable -pedantic -O3 -D__BSD_VISIBLE -D_ALL_SOURCE -D_XOPEN_SOURCE=600 -D_POSIX_C_SOURCE=200112 -D_ISOC99_SOURCE -D_REENTRANT -D_BSD_SOURCE -DVERSION=\"`cat VERSION`\"
+CFLAGS+=-std=c99 -D__BSD_VISIBLE -D_ALL_SOURCE -D_XOPEN_SOURCE=600 -D_POSIX_C_SOURCE=200112 -D_ISOC99_SOURCE -D_REENTRANT -D_BSD_SOURCE -DVERSION=\"`cat VERSION`\"
 OS=$(shell uname -s)
 OSLDFLAGS=$(shell [ $(OS) = "SunOS" ] && echo "-lrt -lsocket -lnsl")
 LDFLAGS:=-lpthread $(OSLDFLAGS)
@@@@ -28,19 +28,20 @@@@ endif
d29 1
a29 1
 .c.o:
d34 2
a35 2
 install: $(NAME)
 	# Special handling for install(1)
@


1.4
log
@Bugfixing update to cntlm-0.92.3
@
text
@d1 1
a1 1
$OpenBSD: patch-Makefile,v 1.3 2012/01/27 09:54:45 dcoppa Exp $
d3 2
a4 19
+++ Makefile	Sun Mar 11 16:43:56 2012
@@@@ -2,10 +2,10 @@@@
 # You can tweak these three variables to make things install where you
 # like, but do not touch more unless you know what you are doing. ;)
 #
-DESTDIR=
-SYSCONFDIR=$(DESTDIR)/etc
-BINDIR=$(DESTDIR)/usr/sbin
-MANDIR=$(DESTDIR)/usr/share/man
+DESTDIR?=
+SYSCONFDIR=$(DESTDIR)/etc/${NAME}
+BINDIR=${PREFIX}/sbin
+MANDIR=${PREFIX}/man
 
 #
 # Careful now...
@@@@ -13,34 +13,26 @@@@ MANDIR=$(DESTDIR)/usr/share/man
 # _ALL_SOURCE is for AIX 5.3 LOG_PERROR constant
 #
d6 1
a6 2
-CC=gcc
+CC?=gcc
d9 1
a9 2
+OBJS=utils.o ntlm.o xcrypt.o config.o socket.o acl.o auth.o http.o forward.o direct.o scanner.o pages.o main.o
+CFLAGS+=$(FLAGS) -std=c99 -pedantic -D__BSD_VISIBLE -D_ALL_SOURCE -D_XOPEN_SOURCE=600 -D_POSIX_C_SOURCE=200112 -D_ISOC99_SOURCE -D_REENTRANT -D_BSD_SOURCE -DVERSION=\"`cat VERSION`\"
d12 2
a13 2
-LDFLAGS:=-lpthread $(OSLDFLAGS)
+LDFLAGS:=-pthread $(OSLDFLAGS)
a14 6
-ifeq ($(findstring CYGWIN,$(OS)),)
-	OBJS=utils.o ntlm.o xcrypt.o config.o socket.o acl.o auth.o http.o forward.o direct.o scanner.o pages.o main.o
-else
-	OBJS=utils.o ntlm.o xcrypt.o config.o socket.o acl.o auth.o http.o forward.o direct.o scanner.o pages.o main.o win/resources.o
-endif
-
d16 1
a16 1
-	@@echo "Linking $@@"
d21 2
a22 3
-	@@echo "Compiling $<"
-	@@if [ -z "$(SYSCONFDIR)" ]; then \
+	if [ -z "$(SYSCONFDIR)" ]; then \
d25 1
d30 1
a30 1
-	@@echo "Compiling $<"
a35 17
@@@@ -54,12 +46,11 @@@@ install: $(NAME)
 		[ -f $(SYSCONFDIR)/$(NAME).conf -o -z "$(SYSCONFDIR)" ] \
 			|| install -d -m 600 doc/$(NAME).conf $(SYSCONFDIR)/$(NAME).conf; \
 	else \
-		install -D -m 755 -s $(NAME) $(BINDIR)/$(NAME); \
-		install -D -m 644 doc/$(NAME).1 $(MANDIR)/man1/$(NAME).1; \
-		[ -f $(SYSCONFDIR)/$(NAME).conf -o -z "$(SYSCONFDIR)" ] \
-			|| install -D -m 600 doc/$(NAME).conf $(SYSCONFDIR)/$(NAME).conf; \
+		${INSTALL_PROGRAM} $(NAME) $(BINDIR)/$(NAME); \
+		${INSTALL_MAN} doc/$(NAME).1 $(MANDIR)/man1/$(NAME).1; \
+		${INSTALL_DATA_DIR} ${PREFIX}/share/examples/${NAME}; \
+		${INSTALL_DATA} doc/$(NAME).conf ${PREFIX}/share/examples/${NAME}/${NAME}.conf; \
 	fi
-	@@echo; echo "Cntlm will look for configuration in $(SYSCONFDIR)/$(NAME).conf"
 
 tgz:
 	mkdir -p tmp
@


1.3
log
@Honour CC and remove unneeded USE_GROFF.

ok sthen@@
@
text
@d1 3
a3 3
$OpenBSD: patch-Makefile,v 1.2 2012/01/25 22:00:15 dcoppa Exp $
--- Makefile.orig	Tue Nov 29 23:18:41 2011
+++ Makefile	Fri Jan 27 10:06:18 2012
d19 1
a19 1
@@@@ -13,29 +13,26 @@@@ MANDIR=$(DESTDIR)/usr/share/man
d26 3
a28 3
 OBJS=utils.o ntlm.o xcrypt.o config.o socket.o acl.o auth.o http.o forward.o direct.o scanner.o pages.o main.o
-CFLAGS+=$(FLAGS) -std=c99 -Wall -pedantic -O3 -D__BSD_VISIBLE -D_ALL_SOURCE -D_XOPEN_SOURCE=600 -D_POSIX_C_SOURCE=200112 -D_ISOC99_SOURCE -D_REENTRANT -D_BSD_SOURCE -DVERSION=\"`cat VERSION`\"
+CFLAGS+=$(FLAGS) -std=c99 -Wall -pedantic -D__BSD_VISIBLE -D_ALL_SOURCE -D_XOPEN_SOURCE=600 -D_POSIX_C_SOURCE=200112 -D_ISOC99_SOURCE -D_REENTRANT -D_BSD_SOURCE -DVERSION=\"`cat VERSION`\"
d34 6
d61 1
a61 1
@@@@ -49,12 +46,11 @@@@ install: $(NAME)
@


1.2
log
@Update to cntlm-0.92.1 and add a rc script.

ok ajacoutot@@
@
text
@d1 1
a1 1
$OpenBSD: patch-Makefile,v 1.1.1.1 2009/10/08 19:13:09 sthen Exp $
d3 1
a3 1
+++ Makefile	Wed Jan 25 15:59:32 2012
d19 6
a24 2
@@@@ -16,26 +16,23 @@@@ NAME=cntlm
 CC=gcc
@


1.1
log
@Initial revision
@
text
@d1 4
a4 4
$OpenBSD$
--- Makefile.orig	Tue Nov 20 17:18:24 2007
+++ Makefile	Thu Oct  8 05:03:34 2009
@@@@ -2,9 +2,9 @@@@
d8 7
a14 5
-SYSCONFDIR=/usr/local/etc
-BINDIR=/usr/local/bin
-MANDIR=/usr/local/man
+SYSCONFDIR=${DESTDIR}/etc/${NAME}
+BINDIR=${PREFIX}/bin
d19 1
a19 2
@@@@ -13,8 +13,8 @@@@ MANDIR=/usr/local/man
 #
a20 6
 OBJS=utils.o ntlm.o xcrypt.o config.o socket.o acl.o auth.o http.o proxy.o 
-CFLAGS=$(FLAGS) -std=c99 -Wall -pedantic -O3 -D__BSD_VISIBLE -D_ALL_SOURCE -D_XOPEN_SOURCE=600 -D_POSIX_C_SOURCE=200112 -D_ISOC99_SOURCE -D_REENTRANT -DVERSION=\"`cat VERSION`\"
-LDFLAGS=-lpthread
+CFLAGS=$(FLAGS) -std=c99 -Wall -pedantic -D__BSD_VISIBLE -D_ALL_SOURCE -D_XOPEN_SOURCE=600 -D_POSIX_C_SOURCE=200112 -D_ISOC99_SOURCE -D_REENTRANT -DVERSION=\"`cat VERSION`\"
+LDFLAGS=-pthread
 NAME=cntlm
d22 32
a53 4
 DIR=`pwd`
@@@@ -42,12 +42,13 @@@@ install: $(NAME)
 		install -O root -G system -M 644 -f $(MANDIR)/man1 doc/$(NAME).1; \
 		install -O root -G system -M 600 -c $(SYSCONFDIR) doc/$(NAME).conf; \
d55 2
a56 2
-		install -D -o root -g root -m 755 -s $(NAME) $(BINDIR)/$(NAME); \
-		install -D -o root -g root -m 644 doc/$(NAME).1 $(MANDIR)/man1/$(NAME).1; \
d58 5
a62 7
-			|| install -D -o root -g root -m 600 doc/$(NAME).conf $(SYSCONFDIR)/$(NAME).conf; \
+		install -d -m 0755 ${BINDIR}; \
+		install -o root -g bin -m 0555 -s ${NAME} ${BINDIR}/${NAME}; \
+		install -d -m 0755 ${MANDIR}/man1; \
+		install -o root -g bin -m 0444 doc/${NAME}.1 ${MANDIR}/man1/${NAME}.1; \
+		install -d -m 0755 ${PREFIX}/share/examples/${NAME}; \
+		install -o root -g bin -m 0444 doc/${NAME}.conf ${PREFIX}/share/examples/${NAME}/${NAME}.conf; \
d66 2
a67 2
 rpm:
 	if [ `id -u` = 0 ]; then \
@


1.1.1.1
log
@import www/cntlm, from maintainer David Coppa

Cntlm is an http proxy server, written in pure C, that allows you to 
authenticate via the proprietary NTLM protocol, so you can use web 
sites and web proxies that require NTLM/NTLMv2 authorization.
@
text
@@
