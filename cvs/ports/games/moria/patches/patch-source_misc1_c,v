head	1.2;
access;
symbols
	OPENBSD_6_0:1.2.0.14
	OPENBSD_6_0_BASE:1.2
	OPENBSD_5_9:1.2.0.10
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.2.0.12
	OPENBSD_5_8_BASE:1.2
	OPENBSD_5_7:1.2.0.8
	OPENBSD_5_7_BASE:1.2
	OPENBSD_5_6:1.2.0.6
	OPENBSD_5_6_BASE:1.2
	OPENBSD_5_5:1.2.0.4
	OPENBSD_5_5_BASE:1.2
	OPENBSD_5_4:1.2.0.2
	OPENBSD_5_4_BASE:1.2
	OPENBSD_5_3:1.1.1.1.0.48
	OPENBSD_5_3_BASE:1.1.1.1
	OPENBSD_5_2:1.1.1.1.0.46
	OPENBSD_5_2_BASE:1.1.1.1
	OPENBSD_5_1_BASE:1.1.1.1
	OPENBSD_5_1:1.1.1.1.0.44
	OPENBSD_5_0:1.1.1.1.0.42
	OPENBSD_5_0_BASE:1.1.1.1
	OPENBSD_4_9:1.1.1.1.0.40
	OPENBSD_4_9_BASE:1.1.1.1
	OPENBSD_4_8:1.1.1.1.0.38
	OPENBSD_4_8_BASE:1.1.1.1
	OPENBSD_4_7:1.1.1.1.0.36
	OPENBSD_4_7_BASE:1.1.1.1
	OPENBSD_4_6:1.1.1.1.0.34
	OPENBSD_4_6_BASE:1.1.1.1
	OPENBSD_4_5:1.1.1.1.0.32
	OPENBSD_4_5_BASE:1.1.1.1
	OPENBSD_4_4:1.1.1.1.0.30
	OPENBSD_4_4_BASE:1.1.1.1
	OPENBSD_4_3:1.1.1.1.0.28
	OPENBSD_4_3_BASE:1.1.1.1
	OPENBSD_4_2:1.1.1.1.0.26
	OPENBSD_4_2_BASE:1.1.1.1
	OPENBSD_4_1:1.1.1.1.0.24
	OPENBSD_4_1_BASE:1.1.1.1
	OPENBSD_4_0:1.1.1.1.0.22
	OPENBSD_4_0_BASE:1.1.1.1
	OPENBSD_3_9:1.1.1.1.0.20
	OPENBSD_3_9_BASE:1.1.1.1
	OPENBSD_3_8:1.1.1.1.0.18
	OPENBSD_3_8_BASE:1.1.1.1
	OPENBSD_3_7:1.1.1.1.0.16
	OPENBSD_3_7_BASE:1.1.1.1
	OPENBSD_3_6:1.1.1.1.0.14
	OPENBSD_3_6_BASE:1.1.1.1
	OPENBSD_3_5:1.1.1.1.0.12
	OPENBSD_3_5_BASE:1.1.1.1
	OPENBSD_3_4:1.1.1.1.0.10
	OPENBSD_3_4_BASE:1.1.1.1
	OPENBSD_3_3:1.1.1.1.0.8
	OPENBSD_3_3_BASE:1.1.1.1
	OPENBSD_3_2:1.1.1.1.0.6
	OPENBSD_3_2_BASE:1.1.1.1
	OPENBSD_3_1:1.1.1.1.0.4
	OPENBSD_3_1_BASE:1.1.1.1
	OPENBSD_3_0:1.1.1.1.0.2
	OPENBSD_3_0_BASE:1.1.1.1
	OPENBSD_2_9_TRACKING_SWITCH:1.1.1.1
	lebel_2001-Jul-04:1.1.1.1
	lebel:1.1.1;
locks; strict;
comment	@# @;


1.2
date	2013.04.05.20.36.27;	author naddy;	state Exp;
branches;
next	1.1;

1.1
date	2001.07.04.16.57.50;	author lebel;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2001.07.04.16.57.50;	author lebel;	state Exp;
branches;
next	;


desc
@@


1.2
log
@fix time_t abuses in twenty-year-old code
@
text
@$OpenBSD: patch-source_misc1_c,v 1.1.1.1 2001/07/04 16:57:50 lebel Exp $
--- source/misc1.c.orig	Fri Jul 22 03:47:28 1994
+++ source/misc1.c	Fri Apr  5 22:23:01 2013
@@@@ -28,11 +28,6 @@@@
 #endif
 #endif
 
-#if !defined(ATARIST_MWC) && !defined(MAC) && !defined(VMS) && !defined(AMIGA)
-long time();
-#endif
-struct tm *localtime();
-
 #if defined(LINT_ARGS)
 static void compact_objects(void);
 #endif
@@@@ -45,11 +40,7 @@@@ int32u seed;
   register int32u clock_var;
 
   if (seed == 0)
-#ifdef MAC
     clock_var = time((time_t *)0);
-#else
-    clock_var = time((long *)0);
-#endif
   else
     clock_var = seed;
   randes_seed = (int32) clock_var;
@@@@ -89,14 +80,10 @@@@ void reset_seed()
 int check_time()
 {
 #ifdef MORIA_HOU
-  long clock_var;
+  time_t clock_var;
   register struct tm *tp;
 
-#ifdef MAC
   clock_var = time((time_t *)0);
-#else
-  clock_var = time((long *)0);
-#endif
   tp = localtime(&clock_var);
   if (days[tp->tm_wday][tp->tm_hour+4] == 'X')
     return TRUE;
@


1.1
log
@Initial revision
@
text
@d1 5
a5 4
$OpenBSD$
--- source/misc1.c.orig	Wed Jul  4 11:39:07 2001
+++ source/misc1.c	Wed Jul  4 11:40:17 2001
@@@@ -29,7 +29,6 @@@@
d8 1
a8 1
 #if !defined(ATARIST_MWC) && !defined(MAC) && !defined(VMS) && !defined(AMIGA)
d10 5
d16 2
a17 1
 struct tm *localtime();
d19 2
a20 2
@@@@ -48,7 +47,7 @@@@ int32u seed;
 #ifdef MAC
d22 1
a22 1
 #else
d24 1
a24 2
+    clock_var = time((time_t *)0);
 #endif
d27 10
a36 2
@@@@ -95,9 +94,9 @@@@ int check_time()
 #ifdef MAC
d38 1
a38 1
 #else
d40 2
a41 4
+  clock_var = time((time_t *)0);
 #endif
-  tp = localtime(&clock_var);
+  tp = localtime((time_t *)&clock_var);
a43 1
   else
@


1.1.1.1
log
@initial import of moria-5.5.2:
--
The game is set in Moria and the goal is to kill off the balrog.
Apart from this, the game is almost completely based on Dungeons &
Dragons. The game is a true classic and every true gamer should
have played it.

It was originally written by Robert Alan Koeneke with some help
from Jimmy Wayne Todd. Further development of the game has almost
ceased, but The Pits of Angband, which is based on its code, is
still very much in development.

WWW: http://www-math.bgsu.edu/~grabine/moria.html

@
text
@@
