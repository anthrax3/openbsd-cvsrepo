head	1.19;
access;
symbols
	OPENBSD_6_1:1.18.0.6
	OPENBSD_6_1_BASE:1.18
	OPENBSD_6_0:1.18.0.4
	OPENBSD_6_0_BASE:1.18
	OPENBSD_5_9:1.18.0.2
	OPENBSD_5_9_BASE:1.18
	OPENBSD_5_8:1.17.0.10
	OPENBSD_5_8_BASE:1.17
	OPENBSD_5_7:1.17.0.6
	OPENBSD_5_7_BASE:1.17
	OPENBSD_5_6:1.17.0.4
	OPENBSD_5_6_BASE:1.17
	OPENBSD_5_5:1.17.0.2
	OPENBSD_5_5_BASE:1.17
	OPENBSD_5_4:1.16.0.2
	OPENBSD_5_4_BASE:1.16
	OPENBSD_5_3:1.14.0.4
	OPENBSD_5_3_BASE:1.14
	OPENBSD_5_2:1.14.0.2
	OPENBSD_5_2_BASE:1.14
	OPENBSD_5_1_BASE:1.13
	OPENBSD_5_1:1.13.0.6
	OPENBSD_5_0:1.13.0.4
	OPENBSD_5_0_BASE:1.13
	OPENBSD_4_9:1.13.0.2
	OPENBSD_4_9_BASE:1.13
	OPENBSD_4_8:1.12.0.12
	OPENBSD_4_8_BASE:1.12
	OPENBSD_4_7:1.12.0.10
	OPENBSD_4_7_BASE:1.12
	OPENBSD_4_6:1.12.0.8
	OPENBSD_4_6_BASE:1.12
	OPENBSD_4_5:1.12.0.6
	OPENBSD_4_5_BASE:1.12
	OPENBSD_4_4:1.12.0.4
	OPENBSD_4_4_BASE:1.12
	OPENBSD_4_3:1.12.0.2
	OPENBSD_4_3_BASE:1.12
	OPENBSD_4_2:1.10.0.8
	OPENBSD_4_2_BASE:1.10
	OPENBSD_4_1:1.10.0.6
	OPENBSD_4_1_BASE:1.10
	OPENBSD_4_0:1.10.0.4
	OPENBSD_4_0_BASE:1.10
	OPENBSD_3_9:1.10.0.2
	OPENBSD_3_9_BASE:1.10
	OPENBSD_3_8:1.8.0.4
	OPENBSD_3_8_BASE:1.8
	OPENBSD_3_7:1.8.0.2
	OPENBSD_3_7_BASE:1.8
	OPENBSD_3_6:1.5.0.8
	OPENBSD_3_6_BASE:1.5
	OPENBSD_3_5:1.5.0.6
	OPENBSD_3_5_BASE:1.5
	OPENBSD_3_4:1.5.0.4
	OPENBSD_3_4_BASE:1.5
	OPENBSD_3_3:1.5.0.2
	OPENBSD_3_3_BASE:1.5
	OPENBSD_3_2:1.4.0.4
	OPENBSD_3_2_BASE:1.4
	OPENBSD_3_1:1.4.0.2
	OPENBSD_3_1_BASE:1.4
	OPENBSD_3_0:1.2.0.2
	OPENBSD_3_0_BASE:1.2
	OPENBSD_2_9_TRACKING_SWITCH:1.2
	lebel_2001-Jul-04:1.1.1.1
	lebel:1.1.1;
locks; strict;
comment	@# @;


1.19
date	2017.04.25.15.47.41;	author espie;	state Exp;
branches;
next	1.18;
commitid	uObU41It3HeebJcJ;

1.18
date	2015.10.27.19.00.53;	author kirby;	state Exp;
branches;
next	1.17;
commitid	UldgIkTCB0PmBHOa;

1.17
date	2013.12.12.21.39.08;	author jca;	state Exp;
branches;
next	1.16;

1.16
date	2013.04.05.20.36.27;	author naddy;	state Exp;
branches;
next	1.15;

1.15
date	2013.03.11.11.07.40;	author espie;	state Exp;
branches;
next	1.14;

1.14
date	2012.03.29.13.38.30;	author sthen;	state Exp;
branches;
next	1.13;

1.13
date	2010.11.16.11.23.27;	author espie;	state Exp;
branches;
next	1.12;

1.12
date	2008.01.04.17.48.35;	author espie;	state Exp;
branches;
next	1.11;

1.11
date	2007.09.15.18.01.02;	author simon;	state Exp;
branches;
next	1.10;

1.10
date	2005.11.03.14.45.09;	author niallo;	state Exp;
branches;
next	1.9;

1.9
date	2005.11.01.13.53.25;	author niallo;	state Exp;
branches;
next	1.8;

1.8
date	2005.02.25.23.15.12;	author alek;	state Exp;
branches;
next	1.7;

1.7
date	2004.09.15.00.50.12;	author pvalchev;	state Exp;
branches;
next	1.6;

1.6
date	2004.09.15.00.06.59;	author pvalchev;	state Exp;
branches;
next	1.5;

1.5
date	2002.12.29.15.10.08;	author fgsch;	state Exp;
branches;
next	1.4;

1.4
date	2002.03.21.20.57.07;	author espie;	state Exp;
branches;
next	1.3;

1.3
date	2001.10.24.14.37.24;	author lebel;	state Exp;
branches;
next	1.2;

1.2
date	2001.07.18.15.06.33;	author lebel;	state Exp;
branches;
next	1.1;

1.1
date	2001.07.04.16.57.50;	author lebel;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2001.07.04.16.57.50;	author lebel;	state Exp;
branches;
next	;


desc
@@


1.19
log
@clang doesn't like int functions that don't return, but signal handlers
have returned void basically forever, so cut thru a bit of old-style cruft
so it compiles and runs more or less correctly (there's a shitload of stuff
happening in the handler... not my fight)

TODO: LINT_ARGS controls prototypes in externs.h... turning them on
triggers some issues with K&R vs ANSI in some functions.
@
text
@# $OpenBSD: Makefile,v 1.18 2015/10/27 19:00:53 kirby Exp $

COMMENT=	The Dungeons of Moria

V=		5.5.2
DISTNAME=	um$V
PKGNAME=	moria-$V
REVISION=	4

CATEGORIES=	games

HOMEPAGE=	http://www-math.bgsu.edu/~grabine/moria.html

PERMIT_PACKAGE_CDROM=	not-for-profit redistribution only
PERMIT_PACKAGE_FTP=	Yes

WANTLIB=	c curses termcap

MASTER_SITES=	http://www.nic.funet.fi/pub/unix/games/moria/source/

EXTRACT_SUFX=	.tar.Z

MAKE_FLAGS=	CC="${CC}" CFLAGS='-DPREFIX=\"${PREFIX}\" ${CFLAGS}'

SEPARATE_BUILD= Yes

NO_TEST=	Yes

WRKDIST=	${WRKDIR}/umoria

ALL_TARGET=	moria

libfiles=	hours news origcmds.hlp owizcmds.hlp roglcmds.hlp \
		rwizcmds.hlp version.hlp welcome.hlp

post-configure:
	cd ${WRKBUILD}; for i in ${WRKSRC}/source/*; do ln -sf $$i; done; \
	 for i in ${WRKSRC}/unix/*; do ln -sf $$i; done; \
	 ln -sf ${WRKSRC}/files

do-install:
	${INSTALL_PROGRAM} -g games -m 2711 ${WRKBUILD}/moria ${PREFIX}/bin
	${INSTALL_DATA_DIR} -m 711 ${PREFIX}/share/moria
	cd ${WRKBUILD}/files; ${INSTALL_DATA} ${libfiles} ${PREFIX}/share/moria
	${INSTALL_DATA} /dev/null ${PREFIX}/share/moria/scores

.include <bsd.port.mk>
@


1.18
log
@switch to http mirror and remove dead ftp mirror from list.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2013/12/12 21:39:08 jca Exp $
d8 1
a8 1
REVISION=	3
@


1.17
log
@Port cleanup:
- reorder Makefile
- regen distinfo
- setup WRKBUILD once in post-configure rather than do-build
- pass -DPREFIX=... via MAKE_FLAGS and use do-install instead of
  patching unix/Makefile (nicer to read)
- minor PLIST reordering to please ''make plist''
- bump REVISION (previous commit to patches/patch-source_io_c)
ok naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2013/04/05 20:36:27 naddy Exp $
d19 2
a20 2
MASTER_SITES=	ftp://ftp.funet.fi/pub/unix/games/moria/source/ \
		ftp://alge.anart.no/pub/games/RPG/moria/
@


1.16
log
@fix time_t abuses in twenty-year-old code
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2013/03/11 11:07:40 espie Exp $
d8 2
a9 1
REVISION=	2
d11 8
d23 1
a23 1
HOMEPAGE=	http://www-math.bgsu.edu/~grabine/moria.html
d25 1
a25 3
PERMIT_PACKAGE_CDROM=	not-for-profit redistribution only
PERMIT_PACKAGE_FTP=	Yes
WANTLIB=		c curses termcap
a29 1
WRKSRC=		${WRKDIST}
d31 4
a34 2
SEPARATE_BUILD= Yes
MAKE_ENV=	CC="${CC}" CFLAGS="${CFLAGS}"
d36 2
a37 2
do-build:
	@@cd ${WRKBUILD}; for i in ${WRKSRC}/source/*; do ln -sf $$i; done; \
d39 1
a39 2
	 ln -sf ${WRKSRC}/files; \
	 ${SETENV} ${MAKE_ENV} ${MAKE_PROGRAM} ${MAKE_FLAGS} PREFIX="${PREFIX}"
d42 4
a45 2
	${INSTALL_DATA_DIR} ${PREFIX}/share/moria
	@@cd ${WRKBUILD}; ${MAKE_PROGRAM} ${ALL_FAKE_FLAGS} install
@


1.15
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2012/03/29 13:38:30 sthen Exp $
d8 1
a8 1
REVISION =	1
@


1.14
log
@Change SEPARATE_BUILD=(concurrent|simple) to Yes; bsd.port.mk doesn't
make a distinction between these.  ok aja@@ dcoppa@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2010/11/16 11:23:27 espie Exp $
a17 2
PERMIT_DISTFILES_CDROM=	not-for-profit redistribution only
PERMIT_DISTFILES_FTP=	Yes
d20 1
a20 1
NO_REGRESS=	Yes
@


1.13
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2008/01/04 17:48:35 espie Exp $
d27 1
a27 1
SEPARATE_BUILD= concurrent
@


1.12
log
@tweak FAKE_FLAGS semantics to saner defaults.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2007/09/15 18:01:02 simon Exp $
d7 2
a8 1
PKGNAME=	moria-$Vp1
@


1.11
log
@remove surrounding quotes from COMMENT/BROKEN/PERMIT_*
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2005/11/03 14:45:09 niallo Exp $
d37 1
a37 1
	@@cd ${WRKBUILD}; ${MAKE_PROGRAM} ${FAKE_FLAGS} install
@


1.10
log
@- setgid fix (missed this the first time)
- bump PKGNAME
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2005/11/01 13:53:25 niallo Exp $
d3 1
a3 1
COMMENT=	"The Dungeons of Moria"
d15 1
a15 1
PERMIT_PACKAGE_CDROM=	"not-for-profit redistribution only"
d17 1
a17 1
PERMIT_DISTFILES_CDROM=	"not-for-profit redistribution only"
@


1.9
log
@- fix modes of some files in the package
- bump PKGNAME

ok bernd@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2005/02/25 23:15:12 alek Exp $
d7 1
a7 1
PKGNAME=	moria-$Vp0
@


1.8
log
@Add WANTLIB marker
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2004/09/15 00:50:12 pvalchev Exp $
d7 1
a7 1
PKGNAME=	moria-$V
@


1.7
log
@clarify this may not be redistributed due to license
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2004/09/15 00:06:59 pvalchev Exp $
d19 1
@


1.6
log
@remove David Lebel from maintainer position per his request.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2002/12/29 15:10:08 fgsch Exp $
d15 1
a15 1
PERMIT_PACKAGE_CDROM=	No
d17 1
a17 1
PERMIT_DISTFILES_CDROM=	No
@


1.5
log
@more NEED_VERSION removal.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2002/03/21 20:57:07 espie Exp $
a13 2

MAINTAINER=	David Lebel <lebel@@openbsd.org>
@


1.4
log
@Bump NEED_VERSION
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2001/10/24 14:37:24 lebel Exp $
a11 1
NEED_VERSION=	1.515
@


1.3
log
@NO_REGRESS=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2001/07/18 15:06:33 lebel Exp $
d12 1
a12 1
NEED_VERSION=	1.402
@


1.2
log
@change MASTER_SITES to something a little bit more reliable.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2001/07/04 16:57:50 lebel Exp $
d22 2
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d9 2
a10 1
MASTER_SITES=	ftp://ftp.greyhelm.com/pub/Games/Moria/source/
@


1.1.1.1
log
@initial import of moria-5.5.2:
--
The game is set in Moria and the goal is to kill off the balrog.
Apart from this, the game is almost completely based on Dungeons &
Dragons. The game is a true classic and every true gamer should
have played it.

It was originally written by Robert Alan Koeneke with some help
from Jimmy Wayne Todd. Further development of the game has almost
ceased, but The Pits of Angband, which is based on its code, is
still very much in development.

WWW: http://www-math.bgsu.edu/~grabine/moria.html

@
text
@@
