head	1.4;
access;
symbols
	OPENBSD_4_9:1.3.0.4
	OPENBSD_4_9_BASE:1.3
	OPENBSD_4_8:1.3.0.2
	OPENBSD_4_8_BASE:1.3
	OPENBSD_4_7:1.2.0.10
	OPENBSD_4_7_BASE:1.2
	OPENBSD_4_6:1.2.0.8
	OPENBSD_4_6_BASE:1.2
	OPENBSD_4_5:1.2.0.6
	OPENBSD_4_5_BASE:1.2
	OPENBSD_4_4:1.2.0.4
	OPENBSD_4_4_BASE:1.2
	OPENBSD_4_3:1.2.0.2
	OPENBSD_4_3_BASE:1.2
	OPENBSD_4_2:1.1.1.1.0.26
	OPENBSD_4_2_BASE:1.1.1.1
	OPENBSD_4_1:1.1.1.1.0.24
	OPENBSD_4_1_BASE:1.1.1.1
	OPENBSD_4_0:1.1.1.1.0.22
	OPENBSD_4_0_BASE:1.1.1.1
	OPENBSD_3_9:1.1.1.1.0.20
	OPENBSD_3_9_BASE:1.1.1.1
	OPENBSD_3_8:1.1.1.1.0.18
	OPENBSD_3_8_BASE:1.1.1.1
	OPENBSD_3_7:1.1.1.1.0.16
	OPENBSD_3_7_BASE:1.1.1.1
	OPENBSD_3_6:1.1.1.1.0.14
	OPENBSD_3_6_BASE:1.1.1.1
	OPENBSD_3_5:1.1.1.1.0.12
	OPENBSD_3_5_BASE:1.1.1.1
	OPENBSD_3_4:1.1.1.1.0.10
	OPENBSD_3_4_BASE:1.1.1.1
	OPENBSD_3_3:1.1.1.1.0.8
	OPENBSD_3_3_BASE:1.1.1.1
	OPENBSD_3_2:1.1.1.1.0.6
	OPENBSD_3_2_BASE:1.1.1.1
	OPENBSD_3_1:1.1.1.1.0.4
	OPENBSD_3_1_BASE:1.1.1.1
	OPENBSD_3_0:1.1.1.1.0.2
	OPENBSD_3_0_BASE:1.1.1.1
	OPENBSD_2_9_TRACKING_SWITCH:1.1.1.1
	Nonnekes:1.1.1.1
	quake:1.1.1;
locks; strict;
comment	@# @;


1.4
date	2011.07.11.16.33.06;	author jasper;	state dead;
branches;
next	1.3;

1.3
date	2010.05.02.13.35.48;	author ratchov;	state Exp;
branches;
next	1.2;

1.2
date	2008.01.11.16.48.44;	author ajacoutot;	state Exp;
branches;
next	1.1;

1.1
date	2001.08.03.13.02.16;	author espie;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2001.08.03.13.02.16;	author espie;	state Exp;
branches;
next	;


desc
@@


1.4
log
@- Update to 20110710
- Working sound via SDL
- Binaries renamed in upstream (see pkg_info -L)
- Data directory handled better (see DESCR)
- Common -libs package for -main and -server
- GGI renderer got removed, renderers now available:
 glx, sdl, sdl32 (32b bit depth) and sgl (SDL OpenGL) and x11
- All binaries can be compiled at once now
- All patches in upstream

from antti harri (MAINTAINER)
@
text
@$OpenBSD: patch-uquake_Makefile_in,v 1.3 2010/05/02 13:35:48 ratchov Exp $
--- uquake/Makefile.in.orig	Fri Apr 30 01:51:08 2010
+++ uquake/Makefile.in	Fri Apr 30 05:01:31 2010
@@@@ -16,9 +16,10 @@@@ mandir      = @@mandir@@
 COMMON_DIR=$(PROJECT_DIR)/common
 BUILD_DIR =../targets/uquake
 
-LDFLAGS = @@LDFLAGS@@ @@SND_LIBS@@ -lm -L/usr/local/v6/lib -linet6
+LDFLAGS = @@LDFLAGS@@ @@SND_LIBS@@ -lm
 LIBS = @@LIBS@@
 CC = @@CC@@
+CC_GL = @@CC@@ -pthread
 INTEL_ARCH = @@INTEL_ARCH@@
 
 ifneq ($(SRC_DIR),.)
@@@@ -76,7 +77,7 @@@@ RELEASE = @@RELEASE@@
 ifeq ($(RELEASE),yes)
 OPTFLAGS = @@RELEASE_CFLAGS@@
 else
-OPTFLAGS = -g
+OPTFLAGS =
 endif
 
 targets       = $(GGIQUAKE) $(SVGAQUAKE) $(GLQUAKE) $(TDFXQUAKE) $(X11QUAKE) $(SDLQUAKE)
@@@@ -124,6 +125,9 @@@@ endif
 ifeq ($(SND_STYLE),OSS)
 SND_SRC = snd_dma.c snd_oss.c
 endif
+ifeq ($(SND_STYLE),sndio)
+SND_SRC = snd_dma.c snd_sndio.c
+endif
 ifeq ($(SND_STYLE),Solaris)
 SND_SRC = snd_dma.c snd_sun.c
 endif
@@@@ -195,7 +199,7 @@@@ CL_COMMON_SRC = $(MISC_SRC) $(CL_GUI_SRC) $(CL_SRC) \
 # Directory specific stuff
 #
 DEFS         = @@DEFS@@
-CFLAGS       = @@CFLAGS@@ $(OPTFLAGS) $(DEFS) -I. $(SRC_DIR_INC) \
+CFLAGS       += @@CFLAGS@@ -g $(OPTFLAGS) $(DEFS) -I. $(SRC_DIR_INC) \
 -I$(COMMON_DIR) -I$(SRC_DIR)/include
 ALL_X11_SRC  = $(GENERAL_SRC) $(SW_REND_SRC) $(X11_VID_SRC) model.c
 ALL_GL_SRC   = $(GENERAL_SRC) $(GL_REND_SRC) $(GL_VID_SRC)
@@@@ -236,7 +240,7 @@@@ $(BUILD_DIR)/x11/%.o: $(SRC_DIR)/%.c
 
 $(BUILD_DIR)/x11/%.o: $(SRC_DIR)/%.s
 	$(MAKE_SURE_x11_DIR)
-	$(CC) $(CFLAGS) -DELF -x assembler-with-cpp -o $@@ -c $<
+	$(CC) $(CFLAGS) -x assembler-with-cpp -o $@@ -c $<
 
 $(BUILD_DIR)/x11/%.o: $(COMMON_DIR)/%.c
 	$(MAKE_SURE_x11_DIR)
@@@@ -244,7 +248,7 @@@@ $(BUILD_DIR)/x11/%.o: $(COMMON_DIR)/%.c
 
 $(BUILD_DIR)/x11/%.o: $(COMMON_DIR)/%.s
 	$(MAKE_SURE_x11_DIR)
-	$(CC) $(CFLAGS) -DELF -x assembler-with-cpp -o $@@ -c $<
+	$(CC) $(CFLAGS) -x assembler-with-cpp -o $@@ -c $<
 
 $(X11QUAKE): $(BUILD_DIR)/../$(X11QUAKE)
 
@@@@ -283,7 +287,7 @@@@ $(BUILD_DIR)/svga/%.o: $(SRC_DIR)/%.c
 
 $(BUILD_DIR)/svga/%.o: $(SRC_DIR)/%.s
 	$(MAKE_SURE_svga_DIR)
-	$(CC) $(CFLAGS) -DELF -x assembler-with-cpp -o $@@ -c $<
+	$(CC) $(CFLAGS) -x assembler-with-cpp -o $@@ -c $<
 
 $(BUILD_DIR)/svga/%.o: $(COMMON_DIR)/%.c
 	$(MAKE_SURE_svga_DIR)
@@@@ -291,7 +295,7 @@@@ $(BUILD_DIR)/svga/%.o: $(COMMON_DIR)/%.c
 
 $(BUILD_DIR)/svga/%.o: $(COMMON_DIR)/%.s
 	$(MAKE_SURE_svga_DIR)
-	$(CC) $(CFLAGS) -DELF -x assembler-with-cpp -o $@@ -c $<
+	$(CC) $(CFLAGS) -x assembler-with-cpp -o $@@ -c $<
 
 $(SVGAQUAKE): $(BUILD_DIR)/../$(SVGAQUAKE)
 
@@@@ -313,7 +317,7 @@@@ ALL_GGI_SRC = $(GENERAL_SRC) $(SW_REND_SRC) $(GGI_VID_
 OBJSquake-ggi = $(patsubst %,$(BUILD_DIR)/ggi/%,$(addsuffix .@@OBJEXT@@, $(basename $(ALL_GGI_SRC) .c .s)))
 
 GGI_CFLAGS  = -DGGI @@GGI_CFLAGS@@
-GGI_LDFLAGS = @@GGI_LIBS@@
+GGI_LDFLAGS = -pthread @@GGI_LIBS@@
 GGI_VID_SRC = vid_ggi.c
 
 # This can be thought of as a macro that makes sure that the ggi
@@@@ -327,7 +331,7 @@@@ $(BUILD_DIR)/ggi/%.o: $(SRC_DIR)/%.c
 
 $(BUILD_DIR)/ggi/%.o: $(SRC_DIR)/%.s
 	$(MAKE_SURE_ggi_DIR)
-	$(CC) $(CFLAGS) -DELF -x assembler-with-cpp -o $@@ -c $<
+	$(CC) $(CFLAGS) -x assembler-with-cpp -o $@@ -c $<
 
 $(BUILD_DIR)/ggi/%.o: $(COMMON_DIR)/%.c
 	$(MAKE_SURE_ggi_DIR)
@@@@ -335,7 +339,7 @@@@ $(BUILD_DIR)/ggi/%.o: $(COMMON_DIR)/%.c
 
 $(BUILD_DIR)/ggi/%.o: $(COMMON_DIR)/%.s
 	$(MAKE_SURE_ggi_DIR)
-	$(CC) $(CFLAGS) -DELF -x assembler-with-cpp -o $@@ -c $<
+	$(CC) $(CFLAGS) -x assembler-with-cpp -o $@@ -c $<
 
 $(GGIQUAKE): $(BUILD_DIR)/../$(GGIQUAKE)
 
@@@@ -365,24 +369,24 @@@@ MAKE_SURE_gl_DIR = @@DIR=gl; $(MAKE_SURE_DIR)
 
 $(BUILD_DIR)/gl/%.o: $(SRC_DIR)/%.c
 	$(MAKE_SURE_gl_DIR)
-	$(CC) $(CFLAGS) $(GL_CFLAGS) -o $@@ -c $<
+	$(CC_GL) $(CFLAGS) $(GL_CFLAGS) -o $@@ -c $<
 
 $(BUILD_DIR)/gl/%.o: $(SRC_DIR)/%.s
 	$(MAKE_SURE_gl_DIR)
-	$(CC) $(CFLAGS) -DELF -x assembler-with-cpp -o $@@ -c $<
+	$(CC_GL) $(CFLAGS) -x assembler-with-cpp -o $@@ -c $<
 
 $(BUILD_DIR)/gl/%.o: $(COMMON_DIR)/%.c
 	$(MAKE_SURE_gl_DIR)
-	$(CC) $(CFLAGS) $(GL_CFLAGS) -o $@@ -c $<
+	$(CC_GL) $(CFLAGS) $(GL_CFLAGS) -o $@@ -c $<
 
 $(BUILD_DIR)/gl/%.o: $(COMMON_DIR)/%.s
 	$(MAKE_SURE_gl_DIR)
-	$(CC) $(CFLAGS) -DELF -x assembler-with-cpp -o $@@ -c $<
+	$(CC_GL) $(CFLAGS) -x assembler-with-cpp -o $@@ -c $<
 
 $(GLQUAKE): $(BUILD_DIR)/../$(GLQUAKE)
 
 $(BUILD_DIR)/../$(GLQUAKE): $(OBJSquake-gl)
-	$(CC) $(CFLAGS) $(OBJSquake-gl) $(GL_LDFLAGS) $(LDFLAGS) -o $(BUILD_DIR)/../$(GLQUAKE)
+	$(CC_GL) $(CFLAGS) $(OBJSquake-gl) $(GL_LDFLAGS) $(LDFLAGS) -o $(BUILD_DIR)/../$(GLQUAKE)
 
 # XXX - Can this be automated?
 clean-$(GLQUAKE):
@@@@ -411,7 +415,7 @@@@ $(BUILD_DIR)/3dfx/%.o: $(SRC_DIR)/%.c
 
 $(BUILD_DIR)/3dfx/%.o: $(SRC_DIR)/%.s
 	$(MAKE_SURE_3dfx_DIR)
-	$(CC) $(CFLAGS) -DELF -x assembler-with-cpp -o $@@ -c $<
+	$(CC) $(CFLAGS) -x assembler-with-cpp -o $@@ -c $<
 
 $(BUILD_DIR)/3dfx/%.o: $(COMMON_DIR)/%.c
 	$(MAKE_SURE_3dfx_DIR)
@@@@ -419,7 +423,7 @@@@ $(BUILD_DIR)/3dfx/%.o: $(COMMON_DIR)/%.c
 
 $(BUILD_DIR)/3dfx/%.o: $(COMMON_DIR)/%.s
 	$(MAKE_SURE_gl_DIR)
-	$(CC) $(CFLAGS) -DELF -x assembler-with-cpp -o $@@ -c $<
+	$(CC) $(CFLAGS) -x assembler-with-cpp -o $@@ -c $<
 
 $(TDFXQUAKE): $(BUILD_DIR)/../$(TDFXQUAKE)
 
@@@@ -455,7 +459,7 @@@@ $(BUILD_DIR)/sdl/%.o: $(SRC_DIR)/%.c
 
 $(BUILD_DIR)/sdl/%.o: $(SRC_DIR)/%.s
 	$(MAKE_SURE_sdl_DIR)
-	$(CC) $(CFLAGS) -DELF -x assembler-with-cpp -o $@@ -c $<
+	$(CC) $(CFLAGS) -x assembler-with-cpp -o $@@ -c $<
 
 $(BUILD_DIR)/sdl/%.o: $(COMMON_DIR)/%.c
 	$(MAKE_SURE_sdl_DIR)
@@@@ -463,7 +467,7 @@@@ $(BUILD_DIR)/sdl/%.o: $(COMMON_DIR)/%.c
 
 $(BUILD_DIR)/sdl/%.o: $(COMMON_DIR)/%.s
 	$(MAKE_SURE_sdl_DIR)
-	$(CC) $(CFLAGS) -DELF -x assembler-with-cpp -o $@@ -c $<
+	$(CC) $(CFLAGS) -x assembler-with-cpp -o $@@ -c $<
 
 $(SDLQUAKE): $(BUILD_DIR)/../$(SDLQUAKE)
 
@@@@ -489,7 +493,7 @@@@ clean: $(CLEAN_TARGETS)
 install: $(targets)
 	$(PROJECT_DIR)/mkinstalldirs $(DESTDIR)$(prefix)$(bindir)
 	for i in $(targets); do \
-	   $(PROJECT_DIR)/install-sh -m 755 $(BUILD_DIR)/../$$i \
+	   $(PROJECT_DIR)/install-sh -s -m 755 $(BUILD_DIR)/../$$i \
 	     $(DESTDIR)$(prefix)$(bindir)/$$i; \
 	done
 
@


1.3
log
@replace sun audio backend by a sndio backend. Diff from jakemsr with
tweaks from me.

ok jakemsr
@
text
@d1 1
a1 1
$OpenBSD: patch-uquake_Makefile_in,v 1.2 2008/01/11 16:48:44 ajacoutot Exp $
@


1.2
log
@- remove broken MASTER_SITES
- make sure only one FLAVOR is selected to avoid packaging error
- fix WANTLIB
- regen patches while here
@
text
@d1 3
a3 3
$OpenBSD: patch-uquake_Makefile_in,v 1.1.1.1 2001/08/03 13:02:16 espie Exp $
--- uquake/Makefile.in.orig	Fri Jan 11 17:46:13 2008
+++ uquake/Makefile.in	Fri Jan 11 17:46:15 2008
d29 2
a30 2
+ifeq ($(SND_STYLE),OpenBSD)
+SND_SRC = snd_dma.c snd_openbsd.c
@


1.1
log
@Initial revision
@
text
@d1 3
a3 3
$OpenBSD$
--- uquake/Makefile.in.orig	Thu Aug  2 04:23:05 2001
+++ uquake/Makefile.in	Thu Aug  2 04:23:36 2001
d35 1
a35 1
@@@@ -195,7 +199,7 @@@@ CL_COMMON_SRC = $(MISC_SRC) $(CL_GUI_SRC
d80 1
a80 1
@@@@ -313,7 +317,7 @@@@ ALL_GGI_SRC = $(GENERAL_SRC) $(SW_REND_S
d107 1
a107 1
@@@@ -365,24 +369,24 @@@@ MAKE_SURE_gl_DIR = @@DIR=gl; $(MAKE_SURE_
@


1.1.1.1
log
@Quake. Needs you to have datafiles to be useful.

Original by Maurices Nonnekes, a few tweaks (sound, i386 optimizations,
longer save menus) by me.

The client/server part probably still needs some work... 
and it is definitely unaudited.

Packaging might be changed to account for docs...

In fact, I really need `common' package files and reference counting...
@
text
@@
