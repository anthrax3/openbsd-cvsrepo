head	1.1;
access;
symbols
	OPENBSD_5_7:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2015.06.29.13.51.05;	author jasper;	state dead;
branches
	1.1.2.1;
next	;
commitid	VJ96nzZl5LMUTSeL;

1.1.2.1
date	2015.06.29.13.51.05;	author jasper;	state Exp;
branches;
next	;
commitid	VJ96nzZl5LMUTSeL;


desc
@@


1.1
log
@file patch-src_filesystem_boost_cpp was initially added on branch OPENBSD_5_7.
@
text
@@


1.1.2.1
log
@Security fixes for CVE-2015-5096, CVE-2015-5070

ok kirby@@ (MAINTAINER)
@
text
@a0 20
$OpenBSD$

fix CVE-2015-5096, CVE-2015-5070
https://github.com/wesnoth/wesnoth/commit/f8914468182e8d0a1551b430c0879ba236fe4d6d
https://github.com/wesnoth/wesnoth/commit/b2738ffb2fdd2550ececb74f76f75583c43c8b59

--- src/filesystem_boost.cpp.orig	Mon Jun 29 14:45:23 2015
+++ src/filesystem_boost.cpp	Mon Jun 29 14:45:00 2015
@@@@ -976,6 +976,11 @@@@ static bool is_legal_file(const std::string &filename)
 		return false;
 	}
 
+	if (looks_like_pbl(filename)) {
+		ERR_FS << "Illegal path '" << filename << "' (.pbl files are not allowed)." << std::endl;
+		return false;
+	}
+
 	return true;
 }
 
@

