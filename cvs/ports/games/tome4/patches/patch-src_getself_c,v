head     1.1;
branch   1.1.1;
access   ;
symbols  awolk_20161228:1.1.1.1 awolk:1.1.1;
locks    ; strict;
comment  @# @;


1.1
date     2016.12.28.18.34.57;  author awolk;  state Exp;
branches 1.1.1.1;
next     ;
commitid        eqWJq46RbIxBPere;

1.1.1.1
date     2016.12.28.18.34.57;  author awolk;  state Exp;
branches ;
next     ;
commitid        eqWJq46RbIxBPere;


desc
@@



1.1
log
@Initial revision
@
text
@$OpenBSD$
--- src/getself.c.orig	Thu Jan  7 20:09:06 2016
+++ src/getself.c	Tue Nov 29 16:38:12 2016
@@@@ -47,7 +47,8 @@@@ const char *get_self_executable(int argc, char **argv)
 	static char res[PATH_MAX];
 	// Like linux, but /proc is not always mounted
 	//  return 0 if it's not
-	if (realpath("/proc/curproc/file", res)) return NULL;
+	//if (realpath("/proc/curproc/file", res)) return NULL;
+	realpath("${GAMEDIR}/", res);
 	return res;
 }
 
@@@@ -57,8 +58,14 @@@@ int get_number_cpus()
 {
 	int count;
 	size_t size=sizeof(count);
+	int name[2];
+	name[0] = CTL_HW;
+	name[1] = HW_NCPU;
 	
-	if (sysctlbyname("hw.ncpu",&count,&size,NULL,0)) return 1;
+	if (sysctl(name, 2, &count, &size, NULL, 0) < 0) {
+	  count = 1;
+	}
+
 	return count;
 }
 
@


1.1.1.1
log
@Import games/tome4

OK fcambus@@

note: upstream is known to re-roll tarballs silently see
        http://forums.te4.org/viewtopic.php?f=42&t=47073
      for details.

$ cat pkg/DESCR-main
Tales of Maj'Eyal (ToME) is a free, open source roguelike RPG,
featuring tactical turn-based combat and advanced character building.
Play as one of many unique races and classes in the lore-filled world
of Eyal, exploring random dungeons, facing challenging battles, and
developing characters with your own tailored mix of abilities and
powers.  With a modern graphical and customisable interface, intuitive
mouse control, streamlined mechanics and deep, challenging combat,
Tales of Maj'Eyal offers engaging roguelike gameplay for the 21st
century.

This package contains the engine of the game.

@
text
@@
