head	1.20;
access;
symbols
	OPENBSD_6_2:1.20.0.2
	OPENBSD_6_2_BASE:1.20
	OPENBSD_6_1:1.19.0.14
	OPENBSD_6_1_BASE:1.19
	OPENBSD_6_0:1.19.0.12
	OPENBSD_6_0_BASE:1.19
	OPENBSD_5_9:1.19.0.8
	OPENBSD_5_9_BASE:1.19
	OPENBSD_5_8:1.19.0.10
	OPENBSD_5_8_BASE:1.19
	OPENBSD_5_7:1.19.0.6
	OPENBSD_5_7_BASE:1.19
	OPENBSD_5_6:1.19.0.4
	OPENBSD_5_6_BASE:1.19
	OPENBSD_5_5:1.19.0.2
	OPENBSD_5_5_BASE:1.19
	OPENBSD_5_4:1.18.0.2
	OPENBSD_5_4_BASE:1.18
	OPENBSD_5_3:1.16.0.2
	OPENBSD_5_3_BASE:1.16
	OPENBSD_5_2:1.15.0.2
	OPENBSD_5_2_BASE:1.15
	OPENBSD_5_1_BASE:1.12
	OPENBSD_5_1:1.12.0.4
	OPENBSD_5_0:1.12.0.2
	OPENBSD_5_0_BASE:1.12
	OPENBSD_4_9:1.10.0.2
	OPENBSD_4_9_BASE:1.10
	OPENBSD_4_8:1.7.0.2
	OPENBSD_4_8_BASE:1.7
	OPENBSD_4_7:1.6.0.2
	OPENBSD_4_7_BASE:1.6
	OPENBSD_4_6:1.5.0.4
	OPENBSD_4_6_BASE:1.5
	OPENBSD_4_5:1.5.0.2
	OPENBSD_4_5_BASE:1.5
	weerd_20081027:1.1.1.1
	weerd:1.1.1;
locks; strict;
comment	@# @;


1.20
date	2017.08.23.14.15.55;	author sthen;	state Exp;
branches;
next	1.19;
commitid	9bWpPCiXEl6RoaVm;

1.19
date	2014.01.31.09.34.22;	author jca;	state Exp;
branches;
next	1.18;

1.18
date	2013.06.01.12.05.14;	author ajacoutot;	state Exp;
branches;
next	1.17;

1.17
date	2013.03.11.11.07.40;	author espie;	state Exp;
branches;
next	1.16;

1.16
date	2012.10.18.21.23.51;	author espie;	state Exp;
branches;
next	1.15;

1.15
date	2012.05.12.04.31.03;	author kirby;	state Exp;
branches;
next	1.14;

1.14
date	2012.03.18.15.47.28;	author kirby;	state Exp;
branches;
next	1.13;

1.13
date	2012.03.08.12.13.01;	author ajacoutot;	state Exp;
branches;
next	1.12;

1.12
date	2011.07.15.07.33.16;	author jasper;	state Exp;
branches;
next	1.11;

1.11
date	2011.05.03.06.48.21;	author jasper;	state Exp;
branches;
next	1.10;

1.10
date	2010.11.22.10.16.08;	author espie;	state Exp;
branches;
next	1.9;

1.9
date	2010.11.16.11.23.27;	author espie;	state Exp;
branches;
next	1.8;

1.8
date	2010.11.08.15.54.54;	author espie;	state Exp;
branches;
next	1.7;

1.7
date	2010.05.27.03.47.28;	author jakemsr;	state Exp;
branches;
next	1.6;

1.6
date	2009.08.03.16.57.44;	author sthen;	state Exp;
branches;
next	1.5;

1.5
date	2009.02.05.20.33.12;	author kili;	state Exp;
branches;
next	1.4;

1.4
date	2009.02.03.19.48.41;	author kili;	state Exp;
branches;
next	1.3;

1.3
date	2008.11.05.21.25.28;	author weerd;	state Exp;
branches;
next	1.2;

1.2
date	2008.10.28.14.27.53;	author weerd;	state Exp;
branches;
next	1.1;

1.1
date	2008.10.27.13.29.02;	author weerd;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2008.10.27.13.29.02;	author weerd;	state Exp;
branches;
next	;


desc
@@


1.20
log
@mark BROKEN-i386

code/qcommon/vm_x86.c:(.text+0x18): undefined reference to `callMask'
@
text
@# $OpenBSD: Makefile,v 1.19 2014/01/31 09:34:22 jca Exp $

ONLY_FOR_ARCHS =	amd64 i386 macppc

BROKEN-i386 =		code/qcommon/vm_x86.c:(.text+0x18): undefined reference to `callMask'

COMMENT-main =		OpenArena client
COMMENT-server =	OpenArena server
COMMENT-data =		OpenArena data for client/server

MULTI_PACKAGES =	-main -server -data

CATEGORIES =		games x11

V =			0.8.8
E_V =			${V}# 	engine version

PKGNAME =		openarena-${V}
PKGNAME-main =		openarena-${V}
PKGNAME-server =	openarena-server-${V}
PKGNAME-data =		openarena-data-${V}

REVISION-main =		1
REVISION-server =	0

PKG_ARCH-data = 	*

DISTNAME =		openarena-${V}
DISTFILES =		${DISTNAME}.zip openarena-engine-source-${E_V}.tar.bz2:0

HOMEPAGE =		http://www.openarena.ws/
MS_PREFIX =		http://download.tuxfamily.org/openarena/rel/
MASTER_SITES =		${MS_PREFIX}${V:S/.//g}/ \
			${MS_PREFIX}${E_V:S/.//g}/source/
MASTER_SITES0 =		http://files.poulsander.com/~poul19/public_files/oa/dev088/ \
			http://openbsd.fi/distfiles/

# GPLv2 but contains software with other (free) licenses as well
PERMIT_PACKAGE_CDROM =	Yes

WANTLIB-main =		GL c m pthread sndio ogg>=5 SDL>=7 vorbis>=7 \
			vorbisfile>=5 curl
WANTLIB-server =	c m

LIB_DEPENDS-main =	audio/libogg \
			audio/libvorbis \
			devel/sdl \
			net/curl
RUN_DEPENDS-main =	${BASE_PKGPATH},-data
RUN_DEPENDS-server =	${BASE_PKGPATH},-data

USE_GMAKE =		Yes
MAKE_FLAGS =		USE_OPENAL=0 \
			FULLBINEXT='' \
			V=1 \
			DEFAULT_BASEDIR=${LOCALBASE}/share/openarena

.if ${MACHINE_ARCH} == "powerpc"
MAKE_FLAGS += 		ARCH=ppc \
			COMPILE_ARCH=ppc
.endif

.if ${MACHINE_ARCH} == "i386"
MAKE_FLAGS +=		PIE_CFLAGS=-fno-pie PIE_LDFLAGS=-nopie
.endif

NO_TEST =		Yes
WRKDIST =		${WRKDIR}/openarena-engine-source-${E_V}
ALL_TARGET =		release

post-extract:
	find ${WRKDIR} -name '*.orig' -print0 | xargs -0r rm -f
	mkdir ${WRKSRC}/code/sndio
	cp ${FILESDIR}/snd_sndio.c ${WRKSRC}/code/sndio

do-install:
	${INSTALL_PROGRAM} \
		${WRKDIST}/build/release-openbsd/openarena-* \
		${PREFIX}/bin/
	${INSTALL_DATA_DIR} ${PREFIX}/share/openarena/baseoa
	${INSTALL_DATA_DIR} ${PREFIX}/share/openarena/missionpack
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/openarena
	${INSTALL_DATA} \
		${WRKDIR}/openarena-${E_V}/README \
		${WRKDIR}/openarena-${E_V}/COPYING \
		${WRKDIR}/openarena-${E_V}/CHANGES \
		${PREFIX}/share/doc/openarena/
	${INSTALL_DATA} ${WRKDIR}/openarena-${E_V}/baseoa/* \
		${PREFIX}/share/openarena/baseoa/
	${INSTALL_DATA} ${WRKDIR}/openarena-${E_V}/missionpack/* \
		${PREFIX}/share/openarena/missionpack/


.include <bsd.port.mk>
@


1.19
log
@Unbreak on i386 by disabling PIE.  ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2013/06/01 12:05:14 ajacoutot Exp $
d4 2
@


1.18
log
@Drop the shm_open(3) patch.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2013/03/11 11:07:40 espie Exp $
d21 2
a22 1
REVISION-main =		0
d59 4
@


1.17
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2012/10/18 21:23:51 espie Exp $
d20 2
@


1.16
log
@zap spaces at end of variables (posix make compliance minor issue)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2012/05/12 04:31:03 kirby Exp $
a34 3
PERMIT_PACKAGE_FTP =	Yes
PERMIT_DISTFILES_CDROM =Yes
PERMIT_DISTFILES_FTP =	Yes
d58 1
a58 1
NO_REGRESS =		Yes
@


1.15
log
@Fix build on macppc. Spotted by aja@@.
No build -> no bump.
OK aja@@, shten@@, phessler@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2012/03/18 15:47:28 kirby Exp $
d14 1
a14 1
E_V =			${V}	# engine version
@


1.14
log
@Update OpenArena to 0.8.8. Patch from Antti Harri, tested by me and Ryan Freeman.
Comments and OK from sthen@@.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2012/03/08 12:13:01 ajacoutot Exp $
d55 5
@


1.13
log
@Garbage collect the /dev/arandom patches.

from Brad
ok landry@@ sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2011/07/15 07:33:16 jasper Exp $
d13 2
a14 2
V =			0.8.5
E_V =			0.8.1	# engine version
a20 4
REVISION-main =		0
REVISION-server =	0
REVISION-data =		0

d23 2
a24 2
DISTNAME =		oa${V:S/.//g}
DISTFILES =		${DISTNAME}.zip openarena-engine-${E_V}-1.tar.bz2
d26 1
d28 3
a30 3
HOMEPAGE =		http://www.openarena.ws/
MASTER_SITES =		${MS_PREFIX}/${V:S/.//g}/ \
			${MS_PREFIX}/${E_V:S/.//g}/source/ \
d40 1
a40 1
			vorbisfile>=5
d44 1
d46 1
a46 1
			audio/libvorbis
a49 1
ALL_TARGET =		release
d52 2
a53 1
			BINEXT='' \
d56 3
a58 1
WRKDIST =		${WRKDIR}/openarena-engine-${E_V}
@


1.12
log
@- fix bogus pkg_arch
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2011/05/03 06:48:21 jasper Exp $
d21 4
a25 1
REVISION-data=		0
@


1.11
log
@- update to 0.8.5

tested by various
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2010/11/22 10:16:08 espie Exp $
d21 2
a22 1
PKG_ARCH-data =		amd64,i386,macppc
@


1.10
log
@remaining WANTLIB go .>=   to >=
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2010/11/16 11:23:27 espie Exp $
d13 2
a14 1
V =			0.8.1
d16 1
a17 1
REVISION-main =		1
a18 1
REVISION-server =	0
a19 1
REVISION-data =		1
d24 1
a24 1
DISTFILES =		${DISTNAME}.zip openarena-engine-${V}-1.tar.bz2
d29 1
a29 1
			${MS_PREFIX}/${V:S/.//g}/source/ \
d54 1
a54 1
WRKDIST =		${WRKDIR}/openarena-engine-${V}
d69 3
a71 3
		${WRKDIR}/openarena-$V/README \
		${WRKDIR}/openarena-$V/COPYING \
		${WRKDIR}/openarena-$V/CHANGES \
d73 4
a76 2
	${INSTALL_DATA} ${WRKDIR}/openarena-$V/baseoa/* ${PREFIX}/share/openarena/baseoa/
	${INSTALL_DATA} ${WRKDIR}/openarena-$V/missionpack/* ${PREFIX}/share/openarena/missionpack/
@


1.9
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2010/11/08 15:54:54 espie Exp $
d39 2
a40 2
WANTLIB-main =		GL c m pthread sndio ogg.>=5 SDL.>=7 vorbis.>=7 \
			vorbisfile.>=5
@


1.8
log
@a few more WANTLIB
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2010/05/27 03:47:28 jakemsr Exp $
d43 5
a47 5
LIB_DEPENDS-main =	::audio/libogg \
			::devel/sdl \
			::audio/libvorbis
RUN_DEPENDS-main =	:openarena-data-*:${BASE_PKGPATH},-data
RUN_DEPENDS-server =	:openarena-data-*:${BASE_PKGPATH},-data
@


1.7
log
@* use the sndio backend from games/quake, since ao uses (essentially)
  the same audio engine as quake
* use -pthread instead of -lpthread for pthreads linkage
* oa defines an ALIGN macro, rename it to QALIGN to avoid clashing
  with the ALIGN macro from machine/param.h
* use /dev/arandom instead of /dev/urandom
ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2009/08/03 16:57:44 sthen Exp $
d15 6
a20 3
PKGNAME-main =		openarena-${V}p1
PKGNAME-server =	openarena-server-${V}p0
PKGNAME-data =		openarena-data-${V}p1
d39 2
a40 1
WANTLIB-main =		GL c m pthread sndio
d43 5
a47 6
LIB_DEPENDS-main =	ogg.>=5::audio/libogg \
			SDL.>=7::devel/sdl \
			vorbis.>=6::audio/libvorbis \
			vorbisfile.>=5::audio/libvorbis
RUN_DEPENDS-main =	:openarena-data-*:${BUILD_PKGPATH},-data
RUN_DEPENDS-server =	:openarena-data-*:${BUILD_PKGPATH},-data
@


1.6
log
@At his request, remove Antti Harri as maintainer for these ports.
PKGNAMEs bumped.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2009/02/05 20:33:12 kili Exp $
d15 1
a15 1
PKGNAME-main =		openarena-${V}p0
d36 1
a36 1
WANTLIB-main =		GL c m pthread
d56 2
@


1.5
log
@
openarena-data needs a pkg bump after the arch addition.

noticed by naddy@@, no cookies for me
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2009/02/03 19:48:41 kili Exp $
d15 3
a17 3
PKGNAME-main =		openarena-${V}
PKGNAME-server =	openarena-server-${V}
PKGNAME-data =		openarena-data-${V}p0
a22 2

MAINTAINER =		Antti Harri <iku@@openbsd.fi>
@


1.4
log
@
Unbreak for amd64.  Initial fix (for amd64 only) from Jordi Beltran
Creix (jbcreix.mail at gmail.com). Generalized for all LP64
architectures by me. At least in theory. Some tests on sparc64
didn't go very well, and nobody tested on other archs, so just keep
ONLY_FOR_ARCHS (with amd64 added) for now.

Antti Harri (MAINTAINER) agrees.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2008/11/05 21:25:28 weerd Exp $
d17 1
a17 1
PKGNAME-data =		openarena-data-${V}
@


1.3
log
@Update to 0.8.1, which fixes the issues with the previous "unreleased"
version. Also enable on macppc (works for MAINTAINER and kili@@) and
clean up the Makefile a little bit.

With MAINTAINER.

ok jasper@@ robert@@ mbalmer@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2008/10/28 14:27:53 weerd Exp $
d3 1
a3 1
ONLY_FOR_ARCHS =	i386 macppc
d19 1
a19 1
PKG_ARCH-data =		i386,macppc
@


1.2
log
@- spacing cleanup
- set ONLY_FOR_ARCHS to i386 for now
- add a MESSAGE mentioning the mouse issues for the client

with help and suggestions from jasper@@ and robert@@, requested by robert@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2008/10/27 13:29:02 weerd Exp $
d3 1
a3 1
ONLY_FOR_ARCHS =	i386
d13 1
a13 1
V =			0.8.0
d15 5
a19 4
PKGNAME =		openarena-${V}p0
PKGNAME-main =		openarena-${V}p0
PKGNAME-server =	openarena-server-${V}p0
PKGNAME-data =		openarena-data-${V}p0
d22 1
a22 1
DISTFILES =		${DISTNAME}.zip ioquake3svn1438.tar.bz2
d26 1
d28 2
a29 1
MASTER_SITES =		http://download.tuxfamily.org/openarena/rel/080/ \
d45 2
a46 2
RUN_DEPENDS-main =	:openarena-data-$V:${BUILD_PKGPATH},-data
RUN_DEPENDS-server =	:openarena-data-$V:${BUILD_PKGPATH},-data
d54 1
a54 1
WRKDIST =		${WRKDIR}/ioquake3svn1438
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d3 1
a3 3
COMMENT-main=	OpenArena client
COMMENT-server=	OpenArena server
COMMENT-data=	OpenArena data for client/server
d5 3
a7 1
MULTI_PACKAGES=	-main -server -data
d9 1
a9 1
CATEGORIES=	games x11
d11 1
a11 1
V=		0.8.0
d13 1
a13 4
PKGNAME=	openarena-$V
PKGNAME-main=	openarena-$V
PKGNAME-server=	openarena-server-$V
PKGNAME-data=	openarena-data-$V
d15 4
a18 2
DISTNAME=	oa${V:S/.//g}
DISTFILES=	${DISTNAME}.zip ioquake3svn1438.tar.bz2
d20 2
a21 1
MAINTAINER=	Antti Harri <iku@@openbsd.fi>
d23 5
a27 3
HOMEPAGE=	http://www.openarena.ws/
MASTER_SITES=	http://download.tuxfamily.org/openarena/rel/080/ \
		http://openbsd.fi/distfiles/
d30 4
a33 4
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
d35 2
a36 2
WANTLIB-main=	GL c m pthread
WANTLIB-server=	c m
d38 1
a38 1
LIB_DEPENDS-main=	ogg.>=5::audio/libogg \
d42 2
a43 2
RUN_DEPENDS-main=	:openarena-data-$V:${BUILD_PKGPATH},-data
RUN_DEPENDS-server=	:openarena-data-$V:${BUILD_PKGPATH},-data
d45 5
a49 5
ALL_TARGET=	release
USE_GMAKE=	Yes
MAKE_FLAGS=	USE_OPENAL=0 \
		BINEXT='' \
		DEFAULT_BASEDIR=${LOCALBASE}/share/openarena
d51 1
a51 1
WRKDIST=	${WRKDIR}/ioquake3svn1438
@


1.1.1.1
log
@OpenArena is an open-source content package for Quake III Arena licensed
under the GPL, effectively creating a free stand-alone game. You do not
need Quake III Arena to play this game.

Not connected to builds yet. Discussed with jasper@@, robert@@ and
sthen@@.

@
text
@@
