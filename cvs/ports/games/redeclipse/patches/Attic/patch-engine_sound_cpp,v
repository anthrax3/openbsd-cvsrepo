head	1.2;
access;
symbols
	OPENBSD_5_7:1.1.1.1.0.8
	OPENBSD_5_7_BASE:1.1.1.1
	OPENBSD_5_6:1.1.1.1.0.6
	OPENBSD_5_6_BASE:1.1.1.1
	OPENBSD_5_5:1.1.1.1.0.4
	OPENBSD_5_5_BASE:1.1.1.1
	OPENBSD_5_4:1.1.1.1.0.2
	OPENBSD_5_4_BASE:1.1.1.1
	jsg_20130429:1.1.1.1
	jsg:1.1.1;
locks; strict;
comment	@# @;


1.2
date	2015.04.11.12.49.30;	author jsg;	state dead;
branches;
next	1.1;
commitid	ysDMANSKZS3MbvrE;

1.1
date	2013.04.29.01.50.57;	author jsg;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2013.04.29.01.50.57;	author jsg;	state Exp;
branches;
next	;


desc
@@


1.2
log
@update to Red Eclipse 1.5.1
@
text
@$OpenBSD: patch-engine_sound_cpp,v 1.1 2013/04/29 01:50:57 jsg Exp $
--- engine/sound.cpp.orig	Thu Feb 28 04:08:16 2013
+++ engine/sound.cpp	Sat Mar 23 21:01:49 2013
@@@@ -572,7 +572,7 @@@@ COMMAND(0, resetsound, "");
 
 #include <unistd.h>
 
-#ifdef _POSIX_SHARED_MEMORY_OBJECTS
+#if _POSIX_SHARED_MEMORY_OBJECTS > 0
 #include <sys/types.h>
 #include <sys/stat.h>
 #include <sys/mman.h>
@@@@ -582,7 +582,7 @@@@ COMMAND(0, resetsound, "");
 
 #endif
 
-#if defined(WIN32) || defined(_POSIX_SHARED_MEMORY_OBJECTS)
+#if defined(WIN32) || _POSIX_SHARED_MEMORY_OBJECTS > 0
 struct MumbleInfo
 {
     int version, timestamp;
@@@@ -595,7 +595,7 @@@@ struct MumbleInfo
 static HANDLE mumblelink = NULL;
 static MumbleInfo *mumbleinfo = NULL;
 #define VALID_MUMBLELINK (mumblelink && mumbleinfo)
-#elif defined(_POSIX_SHARED_MEMORY_OBJECTS)
+#elif _POSIX_SHARED_MEMORY_OBJECTS > 0
 static int mumblelink = -1;
 static MumbleInfo *mumbleinfo = (MumbleInfo *)-1;
 #define VALID_MUMBLELINK (mumblelink >= 0 && mumbleinfo != (MumbleInfo *)-1)
@@@@ -620,7 +620,7 @@@@ void initmumble()
             mumbleinfo = (MumbleInfo *)MapViewOfFile(mumblelink, FILE_MAP_ALL_ACCESS, 0, 0, sizeof(MumbleInfo));
             if(mumbleinfo) wcsncpy(mumbleinfo->name, (const wchar_t *)versionuname, 256);
         }
-    #elif defined(_POSIX_SHARED_MEMORY_OBJECTS)
+    #elif _POSIX_SHARED_MEMORY_OBJECTS > 0
         defformatstring(shmname)("/MumbleLink.%d", getuid());
         mumblelink = shm_open(shmname, O_RDWR, 0);
         if(mumblelink >= 0)
@@@@ -631,7 +631,7 @@@@ void initmumble()
     #endif
     if(!VALID_MUMBLELINK) closemumble();
 #else
-    conoutf(CON_ERROR, "Mumble positional audio is not available on this platform.");
+    conoutft(CON_MESG, "Mumble positional audio is not available on this platform.");
 #endif
 }
 
@@@@ -640,7 +640,7 @@@@ void closemumble()
 #ifdef WIN32
     if(mumbleinfo) { UnmapViewOfFile(mumbleinfo); mumbleinfo = NULL; }
     if(mumblelink) { CloseHandle(mumblelink); mumblelink = NULL; }
-#elif defined(_POSIX_SHARED_MEMORY_OBJECTS)
+#elif _POSIX_SHARED_MEMORY_OBJECTS > 0
     if(mumbleinfo != (MumbleInfo *)-1) { munmap(mumbleinfo, sizeof(MumbleInfo)); mumbleinfo = (MumbleInfo *)-1; }
     if(mumblelink >= 0) { close(mumblelink); mumblelink = -1; }
 #endif
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
$OpenBSD$
@


1.1.1.1
log
@import Red Eclipse 1.4

Red Eclipse is a single-player and multi-player first-person
ego-shooter, built as a total conversion of Cube Engine 2,
which lends itself toward a balanced gameplay, completely at
the control of map makers, while maintaining a general theme
of agility in a variety of environments.

help from and ok ajacoutot@@, ok rfreeman@@
@
text
@@
