head	1.12;
access;
symbols
	OPENBSD_6_0:1.8.0.2
	OPENBSD_6_0_BASE:1.8
	OPENBSD_5_9:1.3.0.2
	OPENBSD_5_9_BASE:1.3
	abieber_20160113:1.1.1.1
	abieber:1.1.1;
locks; strict;
comment	@# @;


1.12
date	2017.03.21.22.19.43;	author abieber;	state Exp;
branches;
next	1.11;
commitid	tRcDXdil31fWHTEN;

1.11
date	2017.03.03.22.52.26;	author abieber;	state Exp;
branches;
next	1.10;
commitid	3uXOTskiiE7cgKeg;

1.10
date	2016.12.27.01.55.33;	author jsg;	state Exp;
branches;
next	1.9;
commitid	iBeDjUazuHFo2BRX;

1.9
date	2016.12.06.15.54.42;	author abieber;	state Exp;
branches;
next	1.8;
commitid	yLEJY7qBVlQnugUi;

1.8
date	2016.06.28.14.22.51;	author abieber;	state Exp;
branches;
next	1.7;
commitid	oXijFT6TQQ4wqhM6;

1.7
date	2016.06.02.11.51.15;	author ajacoutot;	state Exp;
branches;
next	1.6;
commitid	owU8EGSEvZQOPspR;

1.6
date	2016.05.27.23.44.14;	author abieber;	state Exp;
branches;
next	1.5;
commitid	g6oHhlWLAhmjantp;

1.5
date	2016.03.16.16.46.32;	author naddy;	state Exp;
branches;
next	1.4;
commitid	4Ekn8nPgVVHWLTwe;

1.4
date	2016.02.28.20.07.35;	author abieber;	state Exp;
branches;
next	1.3;
commitid	KtZlyXQmbWLrj6HZ;

1.3
date	2016.01.21.09.42.36;	author sthen;	state Exp;
branches;
next	1.2;
commitid	3o613Qe4vAj4bihs;

1.2
date	2016.01.15.21.53.18;	author abieber;	state Exp;
branches;
next	1.1;
commitid	IvGo621MzTW6r2Mj;

1.1
date	2016.01.14.00.11.40;	author abieber;	state Exp;
branches
	1.1.1.1;
next	;
commitid	9lLYqFtrbHyrWMdu;

1.1.1.1
date	2016.01.14.00.11.40;	author abieber;	state Exp;
branches;
next	;
commitid	9lLYqFtrbHyrWMdu;


desc
@@


1.12
log
@Upstream fixed a pretty nasty client bug:
https://ioquake3.org/2017/03/13/important-security-update-please-update-ioquake3-immediately/

Reported by jsg@@, OK awolk@@
@
text
@# $OpenBSD: Makefile,v 1.11 2017/03/03 22:52:26 abieber Exp $

BROKEN-i386=	need to free up a register
ONLY_FOR_ARCHS= amd64 i386

COMMENT=	clone of the original Quake III Arena

DISTNAME=	ioquake3-2017.03.21

GH_ACCOUNT=	ioquake
GH_PROJECT=	ioq3
GH_COMMIT=	d4e1a01f33cde5566b636f461de06b1df9657e25

CATEGORIES=	games

HOMEPAGE=	http://ioquake3.org/

MAINTAINER=	Aaron Bieber <abieber@@openbsd.org>

# GPLv2+
PERMIT_PACKAGE_CDROM=	Yes

# openal is statically linked
WANTLIB += GL SDL2 c curl m ogg openal pthread

LIB_DEPENDS=	audio/libogg \
		audio/openal \
		devel/sdl2 \
		net/curl

MAKE_ENV=	V=1 USE_INTERNAL_OGG=0 CC="${CC}" TOOLS_CC="${CC}"
ALL_TARGET=	"release"
USE_GMAKE=	Yes
NO_TEST=	Yes

CFLAGS+=	-pthread -g

QUAKE_ARCH=	${ARCH:S/amd64/x86_64/:S/i386/x86/}
SUBST_VARS+=	QUAKE_ARCH

do-install:
	${INSTALL_DATA_DIR} ${PREFIX}/share/ioquake3/
	${INSTALL_DATA_DIR} ${PREFIX}/share/ioquake3/{baseq3,missionpack}/
	${INSTALL_PROGRAM} \
		${WRKSRC}/build/release-openbsd-${QUAKE_ARCH}/baseq3/{cgame,qagame,ui}${QUAKE_ARCH}.so \
		${PREFIX}/share/ioquake3/baseq3/
	${INSTALL_PROGRAM} \
		${WRKSRC}/build/release-openbsd-${QUAKE_ARCH}/missionpack/{cgame,qagame,ui}${QUAKE_ARCH}.so \
		${PREFIX}/share/ioquake3/missionpack/
	${INSTALL_PROGRAM} \
		${WRKSRC}/build/release-openbsd-${QUAKE_ARCH}/renderer_opengl{1,2}_${QUAKE_ARCH}.so \
		${PREFIX}/share/ioquake3/
	${INSTALL_PROGRAM} \
		${WRKSRC}/build/release-openbsd-${QUAKE_ARCH}/ioq3ded.${QUAKE_ARCH} \
		${PREFIX}/bin/ioq3ded
	${INSTALL_PROGRAM} \
		${WRKSRC}/build/release-openbsd-${QUAKE_ARCH}/ioquake3.${QUAKE_ARCH} \
		${PREFIX}/bin/ioquake3

.include <bsd.port.mk>
@


1.11
log
@Update ioquake3 to the latest.
Fix static calls to gcc.

OK awolk@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2016/12/27 01:55:33 jsg Exp $
d8 1
a8 1
DISTNAME=	ioquake3-2017.02.28
d12 1
a12 1
GH_COMMIT=	cd41690fc3a9e28b5d22be473cc8ba8270a570b2
@


1.10
log
@stop installing object files
ok awolk@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2016/12/06 15:54:42 abieber Exp $
d8 1
a8 2
DISTNAME=	ioquake3-2016.12.04
REVISION=	0
d12 1
a12 1
GH_COMMIT=	ab8bcf5c5b3c4105b051d95e440f9ed17736a99d
d31 1
a31 1
MAKE_ENV=	"V=1 USE_INTERNAL_OGG=0"
@


1.9
log
@Bring ioquake3 to the latest, this update includes the switch to the
opengl2 renderer!

Full change set:
https://github.com/ioquake/ioq3/compare/9d6a95d4ad141237e21e5c57281b099bbc27a072...ab8bcf5c5b3c4105b051d95e440f9ed17736a99d

OK awolk@@, bmercer@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2016/06/28 14:22:51 abieber Exp $
d9 1
d44 9
a52 1
	cp -rp ${WRKSRC}/build/release-openbsd-${QUAKE_ARCH}/* \
@


1.8
log
@Update ioquake3 to latest

- Set default map for proper startup (users can't connect without one
specified).
- Use libogg from ports (fixes bulk).
- Update readme to give more info on pk3 locations.

OK awolk@@, ajacoutot@@ and a "look good" from espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2016/06/02 11:51:15 ajacoutot Exp $
d8 1
a8 1
DISTNAME=	ioquake3-2016.06.25
d12 1
a12 1
GH_COMMIT=	9d6a95d4ad141237e21e5c57281b099bbc27a072
@


1.7
log
@Fix rc.d script:
- do not hardcode /usr/local
- drop default daemon_flags

Not sure why the pexp is needed but I don't have quake3 files to test.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2016/05/27 23:44:14 abieber Exp $
d8 1
a8 2
DISTNAME=	ioquake3-2016.05.23
REVISION=	0
d12 1
a12 1
GH_COMMIT=	7811b2acb2955132a68d1b869d4df98eb3ae194a
d24 1
a24 1
WANTLIB += GL SDL2 c curl m openal pthread
d26 2
a27 1
LIB_DEPENDS=	audio/openal \
d31 1
a31 1
MAKE_ENV=	"V=1"
@


1.6
log
@Update to latest release on github. Full changes here:
https://github.com/ioquake/ioq3/compare/a331637745fb82266f3627fb438f2d58d53e366c...ioquake:7811b2acb2955132a68d1b869d4df98eb3ae194a

Port changes:
- Add rc script for ioq3ded
- Add blurb in readme

OK awolk@@, "that diff looks reasonable" sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2016/03/16 16:46:32 naddy Exp $
d9 1
@


1.5
log
@remove SHARED_ONLY from ports that don't use any MODULES
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2016/02/28 20:07:35 abieber Exp $
d8 1
a8 1
DISTNAME=	ioquake3-2016.02.26
d12 1
a12 1
GH_COMMIT=	a331637745fb82266f3627fb438f2d58d53e366c
@


1.4
log
@Update to latest ioquake3, mostly GL fixes. I plan on doing monthly-ish
sync with upstream.

OK awolk@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2016/01/21 09:42:36 sthen Exp $
a4 2

SHARED_ONLY=	Yes
@


1.3
log
@Mark ioquake3 as BROKEN-i386, need to free up a register to get this to build.
Fill in the GPL version number in the license marker.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2016/01/15 21:53:18 abieber Exp $
d10 1
a10 1
DISTNAME=	ioquake3-2016.01.15
d14 1
a14 1
GH_COMMIT=	3089df0398b8d0be9d6234e1620468aa2b068897
@


1.2
log
@Update to the latest commit.
Add fix for building debug and release (spotted by mulander).
Fix ordering and add SHARED_ONLY.
Add dep for audio/openal.

OK bmercer@@, sthen@@, tests by mulander
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2016/01/14 00:11:40 abieber Exp $
d3 1
d22 1
a22 1
# GPL
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2013/03/21 08:45:17 ajacoutot Exp $
d3 1
a3 1
ONLY_FOR_ARCHS= 	amd64 i386
d5 1
a5 1
COMMENT=		clone of the original Quake III Arena
d7 1
a7 3
GH_ACCOUNT=		ioquake
GH_PROJECT=		ioq3
GH_COMMIT=		42dee17663cfc841fe6d0933f5c1dc10463e2dbd
d9 1
a9 2
DISTNAME=		ioquake3-2016.01.09
CATEGORIES=		games
d11 3
a13 2
HOMEPAGE=		http://ioquake3.org/
MAINTAINER=		Aaron Bieber <abieber@@openbsd.org>
d15 5
a19 1
QUAKE_ARCH=		${ARCH:S/amd64/x86_64/:S/i386/x86/}
d24 2
a25 7
LIB_DEPENDS=		devel/sdl2 \
			net/curl

USE_GMAKE=		Yes
NO_TEST=		Yes

MAKE_ENV=		"V=1"
d27 8
a34 1
CFLAGS+=                -pthread -g
d36 1
a36 1
WANTLIB += GL SDL2 c curl m pthread
d38 2
a39 1
SUBST_VARS+=		QUAKE_ARCH
@


1.1.1.1
log
@import of ioquake3, an actively developed Quake 3 Arena clone.

Tested by Adam Wolk aka mulander, aka awolk!

OK bmercer@@
@
text
@@
