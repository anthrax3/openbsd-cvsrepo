head	1.2;
access;
symbols
	OPENBSD_4_9:1.1.0.2
	OPENBSD_4_9_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2011.03.13.10.26.26;	author dcoppa;	state dead;
branches;
next	1.1;

1.1
date	2010.12.05.16.14.16;	author dcoppa;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Bugfix update to warzone2100-2.3.7.
From Brad. Tested by me.
@
text
@$OpenBSD: patch-lib_exceptionhandler_exceptionhandler_c,v 1.1 2010/12/05 16:14:16 dcoppa Exp $
--- lib/exceptionhandler/exceptionhandler.c.orig	Sun Nov 28 14:39:00 2010
+++ lib/exceptionhandler/exceptionhandler.c	Wed Dec  1 22:03:05 2010
@@@@ -122,10 +122,12 @@@@ static LONG WINAPI windowsExceptionHandler(PEXCEPTION_
 # include <sys/stat.h>
 # include <sys/wait.h>
 # include <sys/utsname.h>
+#ifdef WZ_OS_LINUX
 # include <sys/prctl.h>
 #ifndef PR_SET_PTRACER
 # define PR_SET_PTRACER 0x59616d61  // prctl will ignore unknown options
 #endif
+#endif
 
 // GNU extension for backtrace():
 # if defined(__GLIBC__)
@@@@ -492,8 +494,10 @@@@ static pid_t execGdb(int const dumpFile, int* gdbWrite
 	// Check to see if we're the parent
 	if (pid != 0)
 	{
+#ifdef WZ_OS_LINUX
 		// Allow tracing the process, some hardened kernel configurations disallow this.
 		prctl(PR_SET_PTRACER, pid, 0, 0, 0);
+#endif
 
 		// Return the write end of the pipe
 		*gdbWritePipe = gdbPipe[1];
@


1.1
log
@Update to warzone2100-2.3.6

From Brad, with tweaks by me.
@
text
@d1 1
a1 1
$OpenBSD$
@

