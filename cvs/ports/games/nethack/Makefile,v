head	1.64;
access;
symbols
	OPENBSD_6_1:1.60.0.6
	OPENBSD_6_1_BASE:1.60
	OPENBSD_6_0:1.60.0.4
	OPENBSD_6_0_BASE:1.60
	OPENBSD_5_9:1.60.0.2
	OPENBSD_5_9_BASE:1.60
	OPENBSD_5_8:1.59.0.4
	OPENBSD_5_8_BASE:1.59
	OPENBSD_5_7:1.56.0.2
	OPENBSD_5_7_BASE:1.56
	OPENBSD_5_6:1.55.0.6
	OPENBSD_5_6_BASE:1.55
	OPENBSD_5_5:1.55.0.4
	OPENBSD_5_5_BASE:1.55
	OPENBSD_5_4:1.55.0.2
	OPENBSD_5_4_BASE:1.55
	OPENBSD_5_3:1.54.0.2
	OPENBSD_5_3_BASE:1.54
	OPENBSD_5_2:1.53.0.4
	OPENBSD_5_2_BASE:1.53
	OPENBSD_5_1_BASE:1.53
	OPENBSD_5_1:1.53.0.2
	OPENBSD_5_0:1.50.0.2
	OPENBSD_5_0_BASE:1.50
	OPENBSD_4_9:1.49.0.2
	OPENBSD_4_9_BASE:1.49
	OPENBSD_4_8:1.46.0.2
	OPENBSD_4_8_BASE:1.46
	OPENBSD_4_7:1.45.0.2
	OPENBSD_4_7_BASE:1.45
	OPENBSD_4_6:1.44.0.8
	OPENBSD_4_6_BASE:1.44
	OPENBSD_4_5:1.44.0.6
	OPENBSD_4_5_BASE:1.44
	OPENBSD_4_4:1.44.0.4
	OPENBSD_4_4_BASE:1.44
	OPENBSD_4_3:1.44.0.2
	OPENBSD_4_3_BASE:1.44
	OPENBSD_4_2:1.41.0.4
	OPENBSD_4_2_BASE:1.41
	OPENBSD_4_1:1.41.0.2
	OPENBSD_4_1_BASE:1.41
	OPENBSD_4_0:1.40.0.4
	OPENBSD_4_0_BASE:1.40
	OPENBSD_3_9:1.40.0.2
	OPENBSD_3_9_BASE:1.40
	OPENBSD_3_8:1.38.0.4
	OPENBSD_3_8_BASE:1.38
	OPENBSD_3_7:1.38.0.2
	OPENBSD_3_7_BASE:1.38
	OPENBSD_3_6:1.36.0.2
	OPENBSD_3_6_BASE:1.36
	OPENBSD_3_5:1.31.0.6
	OPENBSD_3_5_BASE:1.31
	OPENBSD_3_4:1.31.0.4
	OPENBSD_3_4_BASE:1.31
	OPENBSD_3_3:1.31.0.2
	OPENBSD_3_3_BASE:1.31
	OPENBSD_3_2:1.28.0.2
	OPENBSD_3_2_BASE:1.28
	OPENBSD_3_1:1.26.0.2
	OPENBSD_3_1_BASE:1.26
	OPENBSD_3_0:1.23.0.2
	OPENBSD_3_0_BASE:1.23
	OPENBSD_2_9_TRACKING_SWITCH:1.20
	OPENBSD_2_9:1.20.0.2
	OPENBSD_2_9_BASE:1.20
	OPENBSD_2_8:1.13.0.2
	OPENBSD_2_8_BASE:1.13
	OPENBSD_2_7:1.11.0.2
	OPENBSD_2_7_BASE:1.11
	OPENBSD_2_6:1.3.0.2
	OPENBSD_2_6_BASE:1.3
	OPENBSD_2_5:1.2.0.2
	OPENBSD_2_5_BASE:1.2
	OPENBSD_2_4:1.1.0.2
	OPENBSD_2_4_BASE:1.1;
locks; strict;
comment	@# @;


1.64
date	2017.07.26.22.45.21;	author sthen;	state Exp;
branches;
next	1.63;
commitid	tD4MFrpYYDDL2UFT;

1.63
date	2017.07.16.19.18.54;	author espie;	state Exp;
branches;
next	1.62;
commitid	tt0GhWK5c4uf9ILG;

1.62
date	2017.05.08.12.53.28;	author schwarze;	state Exp;
branches;
next	1.61;
commitid	XIhGsX6akyCy9gAL;

1.61
date	2017.04.10.11.46.19;	author sthen;	state Exp;
branches;
next	1.60;
commitid	BLsh88fJB8thZTwY;

1.60
date	2016.01.07.23.00.10;	author sthen;	state Exp;
branches;
next	1.59;
commitid	XQFoBkGollX0ocAg;

1.59
date	2015.06.17.09.41.57;	author bentley;	state Exp;
branches;
next	1.58;
commitid	AIEs3Zfg2n8iwxBF;

1.58
date	2015.03.31.09.44.48;	author ajacoutot;	state Exp;
branches;
next	1.57;
commitid	Ea3rOcpyiLlaXbHa;

1.57
date	2015.03.27.10.59.00;	author tobiasu;	state Exp;
branches;
next	1.56;
commitid	bm4cszJUm6EWEIvs;

1.56
date	2014.11.30.05.41.35;	author brad;	state Exp;
branches;
next	1.55;
commitid	WiC4X2lTBuuiJrMc;

1.55
date	2013.03.11.11.07.40;	author espie;	state Exp;
branches;
next	1.54;

1.54
date	2012.08.18.12.41.38;	author ajacoutot;	state Exp;
branches;
next	1.53;

1.53
date	2011.12.02.14.36.14;	author espie;	state Exp;
branches;
next	1.52;

1.52
date	2011.10.21.17.43.30;	author espie;	state Exp;
branches;
next	1.51;

1.51
date	2011.09.16.09.48.10;	author espie;	state Exp;
branches;
next	1.50;

1.50
date	2011.05.11.06.56.42;	author ajacoutot;	state Exp;
branches;
next	1.49;

1.49
date	2010.11.16.11.23.27;	author espie;	state Exp;
branches;
next	1.48;

1.48
date	2010.10.24.21.19.02;	author ajacoutot;	state Exp;
branches;
next	1.47;

1.47
date	2010.10.18.18.00.18;	author espie;	state Exp;
branches;
next	1.46;

1.46
date	2010.07.06.22.25.53;	author espie;	state Exp;
branches;
next	1.45;

1.45
date	2009.08.10.06.31.42;	author kili;	state Exp;
branches;
next	1.44;

1.44
date	2008.01.26.19.07.40;	author espie;	state Exp;
branches;
next	1.43;

1.43
date	2008.01.04.17.48.35;	author espie;	state Exp;
branches;
next	1.42;

1.42
date	2007.09.15.18.01.02;	author simon;	state Exp;
branches;
next	1.41;

1.41
date	2006.10.14.10.01.09;	author espie;	state Exp;
branches;
next	1.40;

1.40
date	2006.02.11.16.15.46;	author otto;	state Exp;
branches;
next	1.39;

1.39
date	2006.02.10.04.37.48;	author sturm;	state Exp;
branches;
next	1.38;

1.38
date	2004.11.28.22.41.19;	author espie;	state Exp;
branches;
next	1.37;

1.37
date	2004.09.15.19.08.47;	author espie;	state Exp;
branches;
next	1.36;

1.36
date	2004.08.11.10.15.07;	author espie;	state Exp;
branches;
next	1.35;

1.35
date	2004.08.10.11.23.24;	author espie;	state Exp;
branches;
next	1.34;

1.34
date	2004.08.10.10.36.36;	author xsa;	state Exp;
branches;
next	1.33;

1.33
date	2004.08.10.09.43.40;	author espie;	state Exp;
branches;
next	1.32;

1.32
date	2004.08.10.09.33.59;	author espie;	state Exp;
branches;
next	1.31;

1.31
date	2003.02.25.00.15.02;	author espie;	state Exp;
branches;
next	1.30;

1.30
date	2003.02.25.00.05.07;	author espie;	state Exp;
branches;
next	1.29;

1.29
date	2002.10.26.20.44.39;	author naddy;	state Exp;
branches;
next	1.28;

1.28
date	2002.05.13.18.50.43;	author espie;	state Exp;
branches
	1.28.2.1;
next	1.27;

1.27
date	2002.05.08.15.38.06;	author espie;	state Exp;
branches;
next	1.26;

1.26
date	2002.03.23.14.51.46;	author espie;	state Exp;
branches;
next	1.25;

1.25
date	2002.03.21.20.57.07;	author espie;	state Exp;
branches;
next	1.24;

1.24
date	2001.10.28.12.30.13;	author espie;	state Exp;
branches;
next	1.23;

1.23
date	2001.09.19.16.03.10;	author espie;	state Exp;
branches;
next	1.22;

1.22
date	2001.08.27.09.54.48;	author espie;	state Exp;
branches;
next	1.21;

1.21
date	2001.08.27.09.46.31;	author espie;	state Exp;
branches;
next	1.20;

1.20
date	2001.04.09.10.59.40;	author espie;	state Exp;
branches;
next	1.19;

1.19
date	2001.03.30.14.28.38;	author espie;	state Exp;
branches;
next	1.18;

1.18
date	2001.03.23.16.11.10;	author espie;	state Exp;
branches;
next	1.17;

1.17
date	2001.03.22.22.06.37;	author brad;	state Exp;
branches;
next	1.16;

1.16
date	2001.02.08.11.55.08;	author espie;	state Exp;
branches;
next	1.15;

1.15
date	2001.01.31.22.43.44;	author espie;	state Exp;
branches;
next	1.14;

1.14
date	2000.12.26.23.29.26;	author espie;	state Exp;
branches;
next	1.13;

1.13
date	2000.10.10.00.40.32;	author espie;	state Exp;
branches;
next	1.12;

1.12
date	2000.06.23.15.05.34;	author espie;	state Exp;
branches;
next	1.11;

1.11
date	2000.04.16.21.09.55;	author espie;	state Exp;
branches
	1.11.2.1;
next	1.10;

1.10
date	2000.04.16.20.48.56;	author espie;	state Exp;
branches;
next	1.9;

1.9
date	2000.03.19.19.36.53;	author espie;	state Exp;
branches;
next	1.8;

1.8
date	2000.02.15.05.04.23;	author turan;	state Exp;
branches;
next	1.7;

1.7
date	2000.02.12.08.02.19;	author turan;	state Exp;
branches;
next	1.6;

1.6
date	2000.02.11.00.37.23;	author espie;	state Exp;
branches;
next	1.5;

1.5
date	2000.02.02.17.02.40;	author espie;	state Exp;
branches;
next	1.4;

1.4
date	99.12.20.00.37.57;	author espie;	state Exp;
branches;
next	1.3;

1.3
date	99.09.23.20.54.05;	author brad;	state Exp;
branches;
next	1.2;

1.2
date	98.11.09.01.49.55;	author marc;	state Exp;
branches;
next	1.1;

1.1
date	98.07.29.01.22.23;	author espie;	state Exp;
branches;
next	;

1.11.2.1
date	2000.09.15.05.38.14;	author marc;	state Exp;
branches;
next	;

1.28.2.1
date	2003.03.14.00.39.32;	author brad;	state Exp;
branches;
next	;


desc
@@


1.64
log
@bump LIBCXX/LIBECXX/COMPILER_LIBCXX ports.
@
text
@# $OpenBSD: Makefile,v 1.63 2017/07/16 19:18:54 espie Exp $

COMMENT =	dungeon explorin', hackin', game.  Piece of cake
V =		3.4.3
DISTNAME =	nethack-$V
PKGNAME =	${DISTNAME}
REVISION =	10
CATEGORIES =	games

MASTER_SITES =	${MASTER_SITE_SOURCEFORGE:=nethack/}
DISTFILES =	nethack-${V:S/.//g}-src.tgz

HOMEPAGE =	http://nethack.org/

MAINTAINER =	Marc Espie <espie@@openbsd.org>

# GPL
PERMIT_PACKAGE_CDROM =	Yes
WANTLIB =		c termlib

FAKE_FLAGS =	PREFIX=${PREFIX}

GAMEDIR =	lib/nethackdir-$V
NHDIR =		${TRUEPREFIX}/${GAMEDIR}
MAKE_ENV += 	NHDIR=${NHDIR} NETHACKCONFIG=${NETHACKCONFIG}

FLAVORS =	no_x11 qt
FLAVOR ?=

.if ${FLAVOR} == "no_x11"
NETHACKCONFIG =	${FILESDIR}/simple-config
.elif ${FLAVOR} == "qt"
NETHACKCONFIG =	${FILESDIR}/qt-config
MODULES =	x11/qt3
WANTLIB +=	SM m pthread ${COMPILER_LIBCXX}
.else
NETHACKCONFIG =	${FILESDIR}/x-config
WANTLIB +=	X11 Xaw Xext Xmu Xpm Xt pthread-stubs xcb
.endif

RUN_DEPENDS =	games/hackdata

NO_TEST =	Yes
SUBST_VARS =	GAMEDIR V

do-configure:
	@@cd ${WRKSRC}/sys/unix; /bin/sh setup.sh symlinks

post-build:
	@@cd ${WRKSRC}/util && ${MAKE_ENV} make recover

post-install:
	${INSTALL_PROGRAM} ${WRKBUILD}/util/recover ${PREFIX}/bin/recover-$V
	${INSTALL_MAN} ${WRKSRC}/doc/nethack.6 ${PREFIX}/man/man6/nethack-$V.6
	${INSTALL_MAN} ${WRKSRC}/doc/recover.6 ${PREFIX}/man/man6/recover-$V.6
	${INSTALL_PROGRAM} ${PREFIX}/bin/nethack ${PREFIX}/bin/nethack-$V
.if ${FLAVOR} == ""
	${INSTALL_DATA_DIR} ${PREFIX}/lib/X11/app-defaults
	@@cd ${WRKSRC}/win/X11 && cp NetHack.ad NetHack-$V && \
	    ${INSTALL_DATA} NetHack-$V ${PREFIX}/lib/X11/app-defaults
.endif

.include <bsd.port.mk>
@


1.63
log
@use COMPILER_LIBCXX where applicable
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62 2017/05/08 12:53:28 schwarze Exp $
d7 1
a7 1
REVISION =	9
@


1.62
log
@mandoc(1) now supports .ta, drop USE_GROFF and bump
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.61 2017/04/10 11:46:19 sthen Exp $
d35 1
a35 1
WANTLIB +=	SM m pthread ${LIBCXX}
@


1.61
log
@use LIBCXX
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.60 2016/01/07 23:00:10 sthen Exp $
d7 1
a7 1
REVISION =	8
a25 1
USE_GROFF =	Yes
@


1.60
log
@DNS for mirror in MASTER_SITES points to 127.0.0.1; remove
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59 2015/06/17 09:41:57 bentley Exp $
d36 1
a36 1
WANTLIB +=	SM m pthread stdc++
@


1.59
log
@Prune dead mirror.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2015/03/31 09:44:48 ajacoutot Exp $
d10 1
a10 2
MASTER_SITES =	${MASTER_SITE_SOURCEFORGE:=nethack/} \
		http://www.nethack.de/download/
@


1.58
log
@Move fontpath from /usr/local/lib/X11/fonts to /usr/local/share/fonts to match
XDG_DATA_DIR (where Desktop tools will look for by default).

discussed with sthen@@ and matthieu@@
ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.57 2015/03/27 10:59:00 tobiasu Exp $
a10 1
		ftp://ftp.planetmirror.com/pub/nethack/nh${V:S/.//g}/src/ \
@


1.57
log
@Fix crashing build on sparc

makedefs: the strict alignment gods demand time_t
ospeed: homegrown termcap.h, sync ospeed symbol size

Play-tested on sparc
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2014/11/30 05:41:35 brad Exp $
d7 1
a7 1
REVISION =	7
@


1.56
log
@Eliminate the use of the malloc.h header and/or replace
with stdlib.h.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55 2013/03/11 11:07:40 espie Exp $
d7 1
a7 1
REVISION =	6
@


1.55
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.54 2012/08/18 12:41:38 ajacoutot Exp $
d7 1
a7 1
REVISION =	5
@


1.54
log
@Remove irrelevant $FreeBSD RCS ids.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2011/12/02 14:36:14 espie Exp $
a20 3
PERMIT_PACKAGE_FTP =	Yes
PERMIT_DISTFILES_CDROM =Yes
PERMIT_DISTFILES_FTP =	Yes
d46 1
a46 1
NO_REGRESS =	Yes
@


1.53
log
@bye bye FLAVOR:L
@
text
@d1 1
a1 2
# $OpenBSD: Makefile,v 1.52 2011/10/21 17:43:30 espie Exp $
# $FreeBSD: Makefile,v 1.13 1997/12/25 22:29:17 asami Exp $
@


1.52
log
@SH -> /bin/sh, no need for a variable there either
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 2011/09/16 09:48:10 espie Exp $
d37 1
a37 1
.if ${FLAVOR:L} == "no_x11"
d39 1
a39 1
.elif ${FLAVOR:L} == "qt"
d64 1
a64 1
.if ${FLAVOR:L} == ""
@


1.51
log
@normalize pkgpath
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2011/05/11 06:56:42 ajacoutot Exp $
d54 1
a54 1
	@@cd ${WRKSRC}/sys/unix; ${SH} setup.sh symlinks
@


1.50
log
@Sanitize some @@unexec/@@extraunexec calls to rm: move them up in the
PLIST and delete everything under the @@sample'd directory instead of the
directory itself to prevent a warning from pkg_delete(1) trying to
remove a non existing directory and to help preventing left-over files
and directories.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2010/11/16 11:23:27 espie Exp $
d8 1
a8 1
REVISION =	4
@


1.49
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2010/10/24 21:19:02 ajacoutot Exp $
d8 1
a8 1
REVISION =	3
@


1.48
log
@Remove USE_X11.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2010/10/18 18:00:18 espie Exp $
d4 6
a9 5
COMMENT=	dungeon explorin', hackin', game.  Piece of cake
V=3.4.3
DISTNAME=	nethack-$V
PKGNAME=	${DISTNAME}p3
CATEGORIES=	games
d11 1
a11 1
MASTER_SITES=	${MASTER_SITE_SOURCEFORGE:=nethack/} \
d14 1
a14 1
DISTFILES=	nethack-${V:S/.//g}-src.tgz
d16 1
a16 1
HOMEPAGE=	http://nethack.org/
d18 1
a18 1
MAINTAINER=	Marc Espie <espie@@openbsd.org>
d21 11
a31 11
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
WANTLIB=		c termlib

FAKE_FLAGS=PREFIX=${PREFIX}

GAMEDIR=lib/nethackdir-$V
NHDIR=	${TRUEPREFIX}/${GAMEDIR}
MAKE_ENV+= NHDIR=${NHDIR} NETHACKCONFIG=${NETHACKCONFIG}
d34 2
a35 2
FLAVORS=no_x11 qt
FLAVOR?=
d38 1
a38 1
NETHACKCONFIG=${FILESDIR}/simple-config
d40 3
a42 3
NETHACKCONFIG=${FILESDIR}/qt-config
MODULES=	x11/qt3
WANTLIB+=	SM m pthread stdc++
d44 2
a45 2
NETHACKCONFIG=${FILESDIR}/x-config
WANTLIB+=	X11 Xaw Xext Xmu Xpm Xt pthread-stubs xcb
d48 1
a48 1
RUN_DEPENDS=:hackdata-*:games/hackdata
d50 2
a51 2
NO_REGRESS=	Yes
SUBST_VARS=GAMEDIR V
@


1.47
log
@USE_GROFF=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2010/07/06 22:25:53 espie Exp $
a43 1
USE_X11=	Yes
@


1.46
log
@zap reeeally old variable
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2009/08/10 06:31:42 kili Exp $
d31 1
@


1.45
log
@WANTLIB changes after xcb addition and bump.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2008/01/26 19:07:40 espie Exp $
a39 1
MODQT_MT=	Yes
@


1.44
log
@fix perms on nethack and clones.

As noticed by grunk@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2008/01/04 17:48:35 espie Exp $
d7 1
a7 1
PKGNAME=	${DISTNAME}p2
d45 1
a45 1
WANTLIB+=	X11 Xaw Xext Xmu Xpm Xt
@


1.43
log
@tweak FAKE_FLAGS semantics to saner defaults.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2007/09/15 18:01:02 simon Exp $
d7 1
a7 1
PKGNAME=	${DISTNAME}p1
@


1.42
log
@remove surrounding quotes from COMMENT/BROKEN/PERMIT_*
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2006/10/14 10:01:09 espie Exp $
d26 1
a26 1
FAKE_FLAGS=PREFIX=${PREFIX} DESTDIR=${WRKINST}
@


1.41
log
@zap duplicate symbol that impairs static linking.
This should fix build on vaxen (problem reported by Zachary Kline).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2006/02/11 16:15:46 otto Exp $
d4 1
a4 1
COMMENT=	"dungeon explorin', hackin', game.  Piece of cake"
@


1.40
log
@Make sure we clear the saved id, by calling sete{u,g}id() before
set{g,u}id(); this makes gzip able to open /dev/stdin again. Problem
seen by Joachim Schipper in PR 5015. ok espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2006/02/10 04:37:48 sturm Exp $
d7 1
a7 1
PKGNAME=	${DISTNAME}p0
@


1.39
log
@fix MASTER_SITES

pr 5016 from Joachim Schipper <j.schipper at math.uu.nl>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2004/11/28 22:41:19 espie Exp $
d7 1
@


1.38
log
@WANTLIB markers
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2004/09/15 19:08:47 espie Exp $
d10 2
a11 3
		ftp://ftp.nethack.org/pub/nethack/nh${V:S/.//g}/src/ \
		ftp://ftp.uu.net/pub/games/nethack/sources/ \
		${MASTER_SITE_GNU:=nethack/}
@


1.37
log
@new style fragment.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2004/08/11 10:15:07 espie Exp $
d24 1
d41 1
d45 1
@


1.36
log
@update to version 3.4.3.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2004/08/10 11:23:24 espie Exp $
a36 1
SED_PLIST=|sed -e '/^!%%no_x11%%/d'
@


1.35
log
@explicit version marker. Installing a new nethack won't mean you have to
remove the old one.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2004/08/10 10:36:36 xsa Exp $
d5 1
a5 1
V=3.4.1
d10 1
a10 1
		ftp://ftp.nethack.org/pub/nethack/nh341/src/ \
d13 1
a13 1
DISTFILES=	nethack-${V:S/.//g}.tgz
@


1.34
log
@
more new-style MODULES.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2004/08/10 09:43:40 espie Exp $
d5 2
a6 1
DISTNAME=	nethack-3.4.1
d13 1
a13 1
DISTFILES=	nethack-341.tgz
d27 2
a28 2
GAMEDIR=lib/nethackdir
NHDIR=	${PREFIX}/${GAMEDIR}
d49 1
a49 1
SUBST_VARS=GAMEDIR
d58 4
a61 3
	${INSTALL_PROGRAM} ${WRKBUILD}/util/recover ${PREFIX}/bin
	@@cd ${WRKSRC}/doc && \
	    ${INSTALL_MAN} nethack.6 recover.6 ${PREFIX}/man/man6
d64 2
a65 2
	@@cd ${WRKSRC}/win/X11 && cp NetHack.ad NetHack && \
	    ${INSTALL_DATA} NetHack ${PREFIX}/lib/X11/app-defaults
a66 3
#	@@install -g games -m 0664 /dev/null ${NHDIR}/logfile
#	@@install -g games -m 0664 /dev/null ${NHDIR}/perm
#	@@install -g games -m 0664 /dev/null ${NHDIR}/record
@


1.33
log
@unneeded, install program gets perm, record, logfile right.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2004/08/10 09:33:59 espie Exp $
d38 1
a38 1
MODULES=	qt3
@


1.32
log
@new-style plist, handcrafted with a few tweaks.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2003/02/25 00:15:02 espie Exp $
a63 3
	install -g games -m 0664 /dev/null ${NHDIR}/logfile
	install -g games -m 0664 /dev/null ${NHDIR}/perm
	install -g games -m 0664 /dev/null ${NHDIR}/record
d65 3
@


1.31
log
@switch qt flavor to mt.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2003/02/25 00:05:07 espie Exp $
d26 2
a27 1
NHDIR=	${PREFIX}/lib/nethackdir
d48 1
d64 3
@


1.30
log
@update to 3.4.1: security fixes, among other things.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2002/10/26 20:44:39 naddy Exp $
d38 1
@


1.29
log
@No regression tests available.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2002/05/13 18:50:43 espie Exp $
d5 1
a5 1
DISTNAME=	nethack-3.4.0
d8 2
a9 1
MASTER_SITES=	ftp://ftp.nethack.org/pub/nethack/nh340/src/ \
d12 1
a12 1
DISTFILES=	nethack-340.tgz
@


1.28
log
@Kill a few SUBDIR.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2002/05/08 15:38:06 espie Exp $
d7 1
a7 1
NEED_VERSION=	1.515
d43 2
@


1.28.2.1
log
@fix buffer overflow in nethack which may lead to privilege escalation
to gid games.

+

sync hackdata with nethack port.

http://marc.theaimsgroup.com/?l=bugtraq&m=104489201032144&w=2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2003/02/25 00:15:02 espie Exp $
d5 1
a5 1
DISTNAME=	nethack-3.4.1
d7 5
a11 3
MASTER_SITES=	${MASTER_SITE_SOURCEFORGE:=nethack/} \
		ftp://ftp.nethack.org/pub/nethack/nh341/src/
DISTFILES=	nethack-341.tgz
a42 2

NO_REGRESS=	Yes
@


1.27
log
@nethack is obviously perfectly happy with qt3.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2002/03/23 14:51:46 espie Exp $
d10 1
a10 1
		${MASTER_SITE_GNU}
a13 2

MASTER_SITE_SUBDIR= nethack
@


1.26
log
@Nethack 3.4.0, with a bit of help from lebel@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2002/03/21 20:57:07 espie Exp $
d38 1
a38 1
MODULES=	qt2
@


1.25
log
@Bump NEED_VERSION
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2001/10/28 12:30:13 espie Exp $
d5 1
a5 1
DISTNAME=	nethack-3.3.1
d8 1
a8 1
MASTER_SITES=	ftp://ftp.nethack.org/pub/nethack/nh331/src/ \
d11 1
a11 1
DISTFILES=	nethack-331.tgz
d19 1
a19 1
#		GPL
@


1.24
log
@Use full path for libqt and libqt2
Bump need version.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2001/09/19 16:03:10 espie Exp $
d7 1
a7 1
NEED_VERSION=	1.483
@


1.23
log
@Update dependencies (kill first part when needed).

Update japanese/README... 2.4 is looong past.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2001/08/27 09:54:48 espie Exp $
d7 1
a7 1
NEED_VERSION=	1.458
@


1.22
log
@let the qt fragment pass values through
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2001/08/27 09:46:31 espie Exp $
d7 1
a7 1
NEED_VERSION=	1.447
d44 1
a44 1
RUN_DEPENDS=${LOCALBASE}/share/doc/nethack/Guidebook.txt:hackdata-*:games/hackdata
@


1.21
log
@Use qt2 module
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2001/04/09 10:59:40 espie Exp $
a38 1
MAKE_ENV+=MODQT_INCDIR=${MODQT_INCDIR} MODQT_LIBDIR=${MODQT_LIBDIR}
@


1.20
log
@Fix fake problem. Don't know why it affects slash and not nethack
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2001/03/30 14:28:38 espie Exp $
d7 1
a7 1
NEED_VERSION=	1.363
d38 2
a39 2
PORTPATH=${LOCALBASE}/lib/qt2/bin:/usr/bin:/bin:/usr/sbin:/sbin:${LOCALBASE}/bin
LIB_DEPENDS=qt.2.::x11/qt2
@


1.19
log
@nethack-qt needs moc2.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2001/03/23 16:11:10 espie Exp $
d27 1
a27 1
NHDIR=	${DESTDIR}${PREFIX}/lib/nethackdir
d45 1
a45 1
RUN_DEPENDS=${LOCALBASE}/share/doc/nethack/Guidebook.txt::games/hackdata
@


1.18
log
@Update to nethack 3.3.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2001/03/22 22:06:37 brad Exp $
d36 1
a36 1
SED_PLIST=sed -e '/^!%%no_x11$$/d'
@


1.17
log
@- mkdir -> ${INSTALL_DATA_DIR}
- kill off FreeBSD-ism (NOPORTDOCS knob)
--
Patch from: Pete Fritchman <petef@@databits.net>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2001/02/08 11:55:08 espie Exp $
d4 2
a5 1
DISTNAME=	nethack-3.3.0
d7 2
a8 2
NEED_VERSION=	1.191
MASTER_SITES=	ftp://ftp.nethack.org/pub/nethack/src/ \
d11 3
@


1.16
log
@Fix qt flavor packaging (switching from x11 to no_x11 was icky)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2001/01/31 22:43:44 espie Exp $
d54 1
a54 1
	@@mkdir -p ${PREFIX}/lib/X11/app-defaults
@


1.15
log
@I was a bit trigger-happy with X11->no_x11.
Make this actually work...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2000/12/26 23:29:26 espie Exp $
d32 1
@


1.14
log
@x11 -> no_x11 (this predates PFRAG.no-*)
Add flavor description to DESCR
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2000/10/10 00:40:32 espie Exp $
a26 1
# Old text interface
d52 1
a52 1
.if ${FLAVOR:U} == "X11"
@


1.13
log
@Fix my address. Dust off details.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2000/06/23 15:05:34 espie Exp $
d26 1
a26 1
FLAVORS=X11 qt
d30 3
a32 4
.if ${FLAVOR:U} == "X11"
NETHACKCONFIG=${FILESDIR}/x-config
USE_X11=	Yes
.elif ${FLAVOR:U} == "QT"
d37 2
a38 1
NETHACKCONFIG=${FILESDIR}/simple-config
@


1.12
log
@qt flavor, based on qt2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2000/04/16 21:09:55 espie Exp $
d13 1
a13 1
MAINTAINER=	espie@@openbsd.org
d15 1
a15 1
LICENSE_TYPE=		GPL
a20 1
FAKE=		Yes
@


1.11
log
@Wrong filename
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2000/04/16 20:48:56 espie Exp $
d27 1
a27 1
FLAVORS=X11
d34 4
@


1.11.2.1
log
@games as of cut-off into 2.7 branch
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2000/06/23 15:05:34 espie Exp $
d27 1
a27 1
FLAVORS=X11 qt
a33 4
.elif ${FLAVOR:U} == "QT"
NETHACKCONFIG=${FILESDIR}/qt-config
PORTPATH=${LOCALBASE}/lib/qt2/bin:/usr/bin:/bin:/usr/sbin:/sbin:${LOCALBASE}/bin
LIB_DEPENDS=qt.2.::x11/qt2
@


1.10
log
@Revamped nethack port:

- 3.3.0.
- fixed packaging.
- moved common data to hackdata port, to avoid nasty collision with slash.
- compile and install recover.
- only install manpages that correspond to stuff we run.
- remove need for GMAKE.
- include configuration files, allow for X11/plain/qt flavor
(qt is not yet ready, it needs qt 2.0).

Colors work much better, even under console if TERM is set to pcvt25.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2000/03/19 19:36:53 espie Exp $
d38 1
a38 1
RUN_DEPENDS=${LOCALBASE}/share/doc/Guidebook.txt::games/hackdata
@


1.9
log
@Fake.

1/4 of the ports tree uses Fake !
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2000/02/15 05:04:23 turan Exp $
d4 1
a4 1
DISTNAME=	nethack-3.2.3
d7 1
a7 1
MASTER_SITES=	ftp://ftp.nethack.org/pub/nethack/oldver/3.2.2/src/ \
a10 7
DISTFILES=	nethack-3.2.2.tar.gz
WRKDIST=${WRKDIR}/nethack-3.2.2

MASTER_SITES0=	ftp://ftp.nethack.org/pub/nethack/oldver/3.2.3/src/
PATCHFILES=nh-3.2.2-3.2.3.diff:0


a20 2
USE_GMAKE=	Yes
USE_X11=	Yes
d25 17
a41 1
MAKE_ENV+= NHDIR=${NHDIR}
d43 2
a44 2
pre-configure:
	@@cd ${WRKSRC}/sys/unix; ${SH} setup.sh
d47 4
a50 5
	@@mkdir -p ${PREFIX}/lib/X11/fonts/hack
	@@mkdir -p ${PREFIX}/share/doc/nethack
	@@cd ${WRKSRC}/doc; chmod 644 *.6
	@@cd ${WRKSRC}/doc; PREFIX='${PREFIX}' INSTALL_MAN='${INSTALL_MAN}' make manpages
	${INSTALL_DATA} ${WRKSRC}/doc/Guidebook.txt ${PREFIX}/share/doc/nethack
d52 3
a54 8
	@@cd ${WRKSRC}/win/X11 && \
	cp NetHack.ad NetHack && \
	${INSTALL_DATA} NetHack ${PREFIX}/lib/X11/app-defaults && \
	/usr/X11R6/bin/bdftopcf ibm.bdf | /usr/bin/gzip > ibm.pcf.gz && \
	/usr/X11R6/bin/bdftopcf nh10.bdf | /usr/bin/gzip > nh10.pcf.gz && \
	${INSTALL_DATA} ibm.pcf.gz ${PREFIX}/lib/X11/fonts/hack && \
	${INSTALL_DATA} nh10.pcf.gz ${PREFIX}/lib/X11/fonts/hack
	/usr/X11R6/bin/mkfontdir ${PREFIX}/lib/X11/fonts/hack
@


1.8
log
@espie will not shut up about this, DISTF -> DISTFILES, PKG -> PACKAGE
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2000/02/12 08:02:19 turan Exp $
d6 1
a9 1
NEED_VERSION=	1.191
d23 4
a26 4
PERMIT_PACKAGE_CDROM=	YES
PERMIT_PACKAGE_FTP=	YES
PERMIT_DISTFILES_CDROM=	YES
PERMIT_DISTFILES_FTP=	YES
d30 2
d33 1
a33 1
NHDIR=	${PREFIX}/lib/nethackdir
d45 1
d49 2
a50 2
	${X11BASE}/bin/bdftopcf ibm.bdf | /usr/bin/gzip > ibm.pcf.gz && \
	${X11BASE}/bin/bdftopcf nh10.bdf | /usr/bin/gzip > nh10.pcf.gz && \
d53 1
a53 2
	${X11BASE}/bin/mkfontdir ${X11BASE}/lib/X11/fonts/hack
	@@cat ${PKGDIR}/DESCR
@


1.7
log
@gpl licenses
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2000/02/11 00:37:23 espie Exp $
d23 4
a26 4
PERMIT_PKG_CDROM=	YES
PERMIT_PKG_FTP=		YES
PERMIT_DISTF_CDROM=	YES
PERMIT_DISTF_FTP=	YES
@


1.6
log
@Use WRKDIST where appropriate.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2000/02/02 17:02:40 espie Exp $
d21 6
@


1.5
log
@Kill most instances of PATCH_SITES
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 1999/12/20 00:37:57 espie Exp $
d9 1
d12 1
a12 1
WRKSRC=${WRKDIR}/nethack-3.2.2
a18 2

NEED_VERSION=	1.175
@


1.4
log
@Update to 3.2.3.
3.2.3 is a bug-fix update, this can be safely used to replace an old
3.2.2 nethack without losing games in progress. In fact this is
recommended, as 3.2.2 score tables are not Y2K compliant.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 1999/09/23 20:54:05 brad Exp $
d13 2
a14 2
PATCH_SITES=	ftp://ftp.nethack.org/pub/nethack/oldver/3.2.3/src/
PATCHFILES=nh-3.2.2-3.2.3.diff
d19 1
a19 1
NEED_VERSION=	1.114
d23 2
a24 2
USE_GMAKE=	yes
USE_X11=	yes
@


1.3
log
@add missing MASTER_SITE_SUBDIR tag
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 1998/11/09 01:49:55 marc Exp $
d4 1
a4 1
DISTNAME=	nethack-3.2.2
d6 2
a7 1
MASTER_SITES=	ftp://ftp.uu.net/pub/games/nethack/sources/ \
d9 8
d33 4
a36 4
	@@${MKDIR} ${PREFIX}/lib/X11/fonts/hack
	@@${MKDIR} ${PREFIX}/share/doc/nethack
	@@cd ${WRKSRC}/doc; ${CHMOD} 644 *.6
	@@cd ${WRKSRC}/doc; PREFIX='${PREFIX}' INSTALL_MAN='${INSTALL_MAN}' ${MAKE} manpages
d39 1
a39 1
	${CP} NetHack.ad NetHack && \
d46 1
a46 1
	@@${CAT} ${PKGDIR}/DESCR
@


1.2
log
@update port makefiles; validate source code still exists;
comment where sources have changed/no longer exist
See port status web page (to be updated real-soon-now) for details
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1 1998/07/29 01:22:23 espie Exp $
a2 1
#
d6 3
d10 1
a10 1
MAINTAINER=    espie@@OpenBSD.ORG
d12 1
a12 2
MASTER_SITES=	ftp://ftp.uu.net/pub/games/nethack/sources/ \
		${MASTER_SITE_GNU}
d15 1
a15 1
USE_X11= yes
d17 1
a17 1
NHDIR=${PREFIX}/lib/nethackdir
d24 3
a26 1
	@@cd ${WRKSRC}/doc; chmod 644 *.6
a27 2
.if !defined(NOPORTDOCS)
	${MKDIR} ${PREFIX}/share/doc/nethack
d29 5
a33 7
.endif
	${MKDIR} ${PREFIX}/lib/X11/fonts/hack
	cd ${WRKSRC}/win/X11 && \
	cp NetHack.ad NetHack && \
   ${INSTALL_DATA} NetHack ${PREFIX}/lib/X11/app-defaults && \
	${X11BASE}/bin/bdftopcf ibm.bdf|gzip >ibm.pcf.gz && \
	${X11BASE}/bin/bdftopcf nh10.bdf|gzip >nh10.pcf.gz && \
@


1.1
log
@
Imported from FreeBSD with improvements
@
text
@d1 1
a1 6
# New ports collection makefile for:	nethack
# Version required:	3.2.2
# Date created:		27 March 1995
# Whom:			asami
#
# $OpenBSD$
a6 2
MASTER_SITES=	ftp://ftp.uu.net/pub/games/nethack/sources/ \
		${MASTER_SITE_GNU}
a7 1
#MAINTAINER=	ports@@FreeBSD.ORG
d10 2
a11 2
# part of openbsd
#LIB_DEPENDS=	Xpm\\.4\\.:${PORTSDIR}/graphics/xpm
a14 2

MAN6=		dgn_comp.6 dlb.6 lev_comp.6 nethack.6 recover.6
@

