head	1.2;
access;
symbols
	OPENBSD_6_1:1.2.0.10
	OPENBSD_6_1_BASE:1.2
	OPENBSD_6_0:1.2.0.8
	OPENBSD_6_0_BASE:1.2
	OPENBSD_5_9:1.2.0.4
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.2.0.6
	OPENBSD_5_8_BASE:1.2
	OPENBSD_5_7:1.2.0.2
	OPENBSD_5_7_BASE:1.2
	OPENBSD_5_6:1.1.0.6
	OPENBSD_5_6_BASE:1.1
	OPENBSD_5_5:1.1.0.4
	OPENBSD_5_5_BASE:1.1
	OPENBSD_5_4:1.1.0.2
	OPENBSD_5_4_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2014.09.29.18.23.15;	author kirby;	state Exp;
branches;
next	1.1;
commitid	XgzPY68RwZ98PQ3m;

1.1
date	2013.05.16.10.10.35;	author kirby;	state Exp;
branches;
next	;


desc
@@


1.2
log
@update to ufoai-2.5
@
text
@$OpenBSD: patch-src_ports_unix_unix_shared_c,v 1.1 2013/05/16 10:10:35 kirby Exp $

XXX: OpenBSD's locale support is very limited. This can probably
be removed when support for LC_MESSAGES is added.

--- src/ports/unix/unix_shared.cpp.orig	Thu Jun  5 08:18:39 2014
+++ src/ports/unix/unix_shared.cpp	Thu Jul  3 22:06:25 2014
@@@@ -106,9 +106,14 @@@@ const char *Sys_SetLocale (const char *localeID)
 	Sys_Setenv("LC_NUMERIC", "C");
 	setlocale(LC_NUMERIC, "C");
 
+# ifdef __OpenBSD__
+	if (Sys_Setenv("LC_ALL", localeID) != 0)
+		Com_Printf("...setenv for LC_ALL failed: %s\n", localeID);
+# endif /* __OpenBSD__ */
+
 	/* set to system default */
 	setlocale(LC_ALL, "C");
-	locale = setlocale(LC_MESSAGES, localeID);
+	locale = setlocale(LC_ALL, localeID);
 	if (!locale) {
 		if (Sys_Setenv("LANGUAGE", localeID) != 0) {
 			locale = localeID;
@@@@ -130,7 +135,7 @@@@ const char *Sys_SetLocale (const char *localeID)
 const char *Sys_GetLocale (void)
 {
 	/* Calling with nullptr param should return current system settings. */
-	const char *currentLocale = setlocale(LC_MESSAGES, nullptr);
+	const char *currentLocale = setlocale(LC_ALL, nullptr);
 	if (currentLocale != nullptr && currentLocale[0] != '\0')
 		return currentLocale;
 	else
@


1.1
log
@Update to ufoai 2.4
From now all textures have permissive licenses, so we can ship packages.

Here are just a few of the changes in 2.4:
 - A dozen new maps to battle aliens
 - Rescue soldiers in dropships shot down by aliens and retreat from battles
 - New particle and sound effects for weapons
 - Support for smoke and incendiary effects
 - New skirmish options to save squads and respawn aliens
 - Battlescape render speed dramatically improved

Full changelog: http://ufoai.org/wiki/Changelog/2.4

With input from sthen@@ and bentley@@. Thanks guys!
Tested by me and bentley@@
OK bentley@@
@
text
@d1 1
a1 1
$OpenBSD: patch-src_ports_unix_unix_main_c,v 1.1 2011/05/27 07:20:11 ajacoutot Exp $
d6 3
a8 3
--- src/ports/unix/unix_shared.c.orig	Tue Apr 24 09:04:43 2012
+++ src/ports/unix/unix_shared.c	Tue Feb  5 02:17:04 2013
@@@@ -101,9 +101,14 @@@@ const char *Sys_SetLocale (const char *localeID)
d24 1
a24 1
@@@@ -125,7 +130,7 @@@@ const char *Sys_SetLocale (const char *localeID)
d27 4
a30 4
 	/* Calling with NULL param should return current system settings. */
-	const char *currentLocale = setlocale(LC_MESSAGES, NULL);
+	const char *currentLocale = setlocale(LC_ALL, NULL);
 	if (currentLocale != NULL && currentLocale[0] != '\0')
@

