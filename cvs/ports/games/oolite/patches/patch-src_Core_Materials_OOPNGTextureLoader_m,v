head	1.3;
access;
symbols
	OPENBSD_6_0:1.3.0.14
	OPENBSD_6_0_BASE:1.3
	OPENBSD_5_9:1.3.0.10
	OPENBSD_5_9_BASE:1.3
	OPENBSD_5_8:1.3.0.12
	OPENBSD_5_8_BASE:1.3
	OPENBSD_5_7:1.3.0.8
	OPENBSD_5_7_BASE:1.3
	OPENBSD_5_6:1.3.0.6
	OPENBSD_5_6_BASE:1.3
	OPENBSD_5_5:1.3.0.4
	OPENBSD_5_5_BASE:1.3
	OPENBSD_5_4:1.3.0.2
	OPENBSD_5_4_BASE:1.3
	OPENBSD_5_3:1.2.0.8
	OPENBSD_5_3_BASE:1.2
	OPENBSD_5_2:1.2.0.6
	OPENBSD_5_2_BASE:1.2
	OPENBSD_5_1_BASE:1.2
	OPENBSD_5_1:1.2.0.4
	OPENBSD_5_0:1.2.0.2
	OPENBSD_5_0_BASE:1.2
	OPENBSD_4_9:1.1.0.2
	OPENBSD_4_9_BASE:1.1;
locks; strict;
comment	@# @;


1.3
date	2013.06.08.19.37.08;	author naddy;	state Exp;
branches;
next	1.2;

1.2
date	2011.07.08.20.38.01;	author naddy;	state Exp;
branches;
next	1.1;

1.1
date	2011.01.15.10.13.23;	author sebastia;	state Exp;
branches;
next	;


desc
@@


1.3
log
@Fix build with png-1.6.
@
text
@$OpenBSD: patch-src_Core_Materials_OOPNGTextureLoader_m,v 1.2 2011/07/08 20:38:01 naddy Exp $

* Missing header.
* Fix build with png-1.6; __attribute__((noreturn)) already set in <png.h>.

--- src/Core/Materials/OOPNGTextureLoader.m.orig	Mon Sep 21 20:53:30 2009
+++ src/Core/Materials/OOPNGTextureLoader.m	Fri Jun  7 22:33:31 2013
@@@@ -50,11 +50,11 @@@@ SOFTWARE.
 #import "OOFunctionAttributes.h"
 #import "OOLogging.h"
 #import "OOCPUInfo.h"
+
+#include <assert.h>
+
 
 
-void png_error(png_structp, png_const_charp) NO_RETURN_FUNC;
-
-
 static void PNGError(png_structp png, png_const_charp message);
 static void PNGWarning(png_structp png, png_const_charp message);
 static void PNGRead(png_structp png, png_bytep bytes, png_size_t size);
@@@@ -242,7 +242,7 @@@@ static void PNGError(png_structp png, png_const_charp 
 {
 	OOPNGTextureLoader		*loader = nil;
 	
-	loader = png->error_ptr;
+	loader = png_get_error_ptr(png);
 	OOLog(@@"texture.load.png.error", @@"***** A PNG loading error occurred for %@@: %s", [loader path], message);
 }
 
@@@@ -251,7 +251,7 @@@@ static void PNGWarning(png_structp png, png_const_char
 {
 	OOPNGTextureLoader		*loader = nil;
 	
-	loader = png->error_ptr;
+	loader = png_get_error_ptr(png);
 	OOLog(@@"texture.load.png.warning", @@"***** A PNG loading warning occurred for %@@: %s", [loader path], message);
 }
 
@


1.2
log
@Fix build with png-1.5.
All fixes by yours truly.
@
text
@d1 1
a1 1
$OpenBSD: patch-src_Core_Materials_OOPNGTextureLoader_m,v 1.1 2011/01/15 10:13:23 sebastia Exp $
d4 1
a4 1
* Fix build with png-1.5.
d6 3
a8 3
--- src/Core/Materials/OOPNGTextureLoader.m.orig	Mon Sep 21 12:53:30 2009
+++ src/Core/Materials/OOPNGTextureLoader.m	Tue Jul  5 17:06:57 2011
@@@@ -50,6 +50,9 @@@@ SOFTWARE.
d17 7
a23 2
 void png_error(png_structp, png_const_charp) NO_RETURN_FUNC;
@@@@ -242,7 +245,7 @@@@ static void PNGError(png_structp png, png_const_charp 
d32 1
a32 1
@@@@ -251,7 +254,7 @@@@ static void PNGWarning(png_structp png, png_const_char
@


1.1
log
@- fix build (include missing header files), after recent gnustep-base update
  pointed out by ajacoutot@@, naddy@@, landry@@
- while there, remove use of gcc4 module, and use x11/gnustep module
- fix compiler warning regarding 'struct in_addr' declared inside parameter list
- update MESSAGE file, to recommend using defaults tool, instead of handcrafting
  gnustep defaults file

OK nicm@@ (MAINTAINER), ajacoutot@@
@
text
@d1 1
a1 1
$OpenBSD$
d3 2
a4 1
missing header
d6 2
a7 2
--- src/Core/Materials/OOPNGTextureLoader.m.orig	Fri Jan 14 12:58:52 2011
+++ src/Core/Materials/OOPNGTextureLoader.m	Fri Jan 14 12:59:09 2011
d18 18
@

