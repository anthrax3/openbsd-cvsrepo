head	1.3;
access;
symbols
	OPENBSD_4_2:1.2.0.14
	OPENBSD_4_2_BASE:1.2
	OPENBSD_4_1:1.2.0.12
	OPENBSD_4_1_BASE:1.2
	OPENBSD_4_0:1.2.0.10
	OPENBSD_4_0_BASE:1.2
	OPENBSD_3_9:1.2.0.8
	OPENBSD_3_9_BASE:1.2
	OPENBSD_3_8:1.2.0.6
	OPENBSD_3_8_BASE:1.2
	OPENBSD_3_7:1.2.0.4
	OPENBSD_3_7_BASE:1.2
	OPENBSD_3_6:1.2.0.2
	OPENBSD_3_6_BASE:1.2
	OPENBSD_3_5:1.1.0.2
	OPENBSD_3_5_BASE:1.1;
locks; strict;
comment	@# @;


1.3
date	2007.12.06.17.03.56;	author ajacoutot;	state dead;
branches;
next	1.2;

1.2
date	2004.04.09.21.15.12;	author naddy;	state Exp;
branches;
next	1.1;

1.1
date	2004.03.10.17.32.46;	author naddy;	state Exp;
branches;
next	;


desc
@@


1.3
log
@- update to zoom-1.1.2
- remove NO_REGRESS
- fix HOMEPAGE
@
text
@$OpenBSD: patch-src_hash_c,v 1.2 2004/04/09 21:15:12 naddy Exp $
--- src/hash.c.orig	2002-07-25 20:10:02.000000000 +0200
+++ src/hash.c	2004-04-09 22:12:31.000000000 +0200
@@@@ -81,7 +81,7 @@@@ static void init_crc32()
         for (i = 0; i < 256; ++i) {
                 for (c = i << 24, j = 8; j > 0; --j)
                         c = c & 0x80000000 ? (c << 1) ^ CRC32_POLY : (c << 1);
-                crc32_table[i] = c;
+                crc32_table[i] = c & 0xffffffff;
         }
 }
 
@@@@ -95,8 +95,8 @@@@ unsigned long hash_hash(unsigned char *b
     init_crc32();   /* build table */
   crc = 0xffffffff;       /* preload shift register, per CRC-32 spec */
   for (p = buf; len > 0; ++p, --len)
-    crc = (crc << 8) ^ crc32_table[(crc >> 24) ^ *p];
-  return ~crc;            /* transmit complement, per CRC-32 spec */  
+    crc = ((crc << 8) ^ crc32_table[(crc >> 24) ^ *p]) & 0xffffffff;
+  return ~crc & 0xffffffff;     /* transmit complement, per CRC-32 spec */  
 }
 
 static struct bucket *hash_lookup(hash          hash,
@


1.2
log
@update to 1.0.1; from Jose Nazario <jose@@monkey.org>
@
text
@d1 1
a1 1
$OpenBSD: patch-src_hash_c,v 1.1 2004/03/10 17:32:46 naddy Exp $
@


1.1
log
@LP64 fix; ok jose@@, pvalchev@@
@
text
@d1 4
a4 12
$OpenBSD$
--- src/hash.c.orig	2000-11-01 00:01:57.000000000 +0100
+++ src/hash.c	2004-03-10 15:36:23.000000000 +0100
@@@@ -23,6 +23,7 @@@@
 
 #include <stdio.h>
 #include <stdlib.h>
+#include <string.h>
 
 #include "hash.h"
 
@@@@ -80,7 +81,7 @@@@ static void init_crc32()
d13 1
a13 1
@@@@ -94,8 +95,8 @@@@ unsigned long hash_hash(unsigned char *b
@

