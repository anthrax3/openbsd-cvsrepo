head	1.23;
access;
symbols
	OPENBSD_6_1:1.21.0.2
	OPENBSD_6_1_BASE:1.21
	OPENBSD_6_0:1.17.0.2
	OPENBSD_6_0_BASE:1.17
	OPENBSD_5_9:1.16.0.4
	OPENBSD_5_9_BASE:1.16
	OPENBSD_5_8:1.16.0.6
	OPENBSD_5_8_BASE:1.16
	OPENBSD_5_7:1.16.0.2
	OPENBSD_5_7_BASE:1.16
	OPENBSD_5_6:1.13.0.2
	OPENBSD_5_6_BASE:1.13
	OPENBSD_3_2:1.10.0.6
	OPENBSD_3_2_BASE:1.10
	OPENBSD_3_1:1.10.0.4
	OPENBSD_3_1_BASE:1.10
	OPENBSD_3_0:1.10.0.2
	OPENBSD_3_0_BASE:1.10
	OPENBSD_2_9_TRACKING_SWITCH:1.5
	OPENBSD_2_9:1.3.0.2
	OPENBSD_2_9_BASE:1.3
	jakob_20010217:1.1.1.1
	jakob:1.1.1;
locks; strict;
comment	@# @;


1.23
date	2017.04.14.08.05.00;	author ajacoutot;	state Exp;
branches;
next	1.22;
commitid	sPySYPL2IbJacBw0;

1.22
date	2017.04.12.09.50.00;	author ajacoutot;	state Exp;
branches;
next	1.21;
commitid	iTZmiNc9qphrDVR4;

1.21
date	2016.12.22.09.20.19;	author ajacoutot;	state Exp;
branches
	1.21.2.1;
next	1.20;
commitid	VfM4n9bkyPzcihbk;

1.20
date	2016.12.17.14.58.31;	author ajacoutot;	state Exp;
branches;
next	1.19;
commitid	MFuneOA792oMhnFq;

1.19
date	2016.11.10.08.54.43;	author ajacoutot;	state Exp;
branches;
next	1.18;
commitid	jmdAgfKWF3m32wbq;

1.18
date	2016.11.10.06.01.45;	author jca;	state Exp;
branches;
next	1.17;
commitid	ijROsPze4Svlcnwi;

1.17
date	2016.03.11.20.28.30;	author naddy;	state Exp;
branches;
next	1.16;
commitid	UYLP8TE6V7RS2GhJ;

1.16
date	2014.11.28.22.34.18;	author sthen;	state Exp;
branches;
next	1.15;
commitid	dDux7OhGlRl2K6KD;

1.15
date	2014.11.27.11.10.05;	author sthen;	state Exp;
branches;
next	1.14;
commitid	9ApLZQKWIq65zRFr;

1.14
date	2014.09.04.08.20.16;	author ajacoutot;	state Exp;
branches;
next	1.13;
commitid	drI9VslkdahtPwJZ;

1.13
date	2014.07.28.09.49.44;	author ajacoutot;	state Exp;
branches;
next	1.12;
commitid	itGLoGrNFFnZSaHo;

1.12
date	2014.07.13.14.10.13;	author ajacoutot;	state Exp;
branches;
next	1.11;
commitid	R7CQhUQNdJfZrGZj;

1.11
date	2002.11.24.01.26.33;	author brad;	state dead;
branches;
next	1.10;

1.10
date	2001.09.09.17.56.59;	author naddy;	state Exp;
branches;
next	1.9;

1.9
date	2001.09.08.10.06.41;	author jakob;	state Exp;
branches;
next	1.8;

1.8
date	2001.09.08.09.04.30;	author jakob;	state Exp;
branches;
next	1.7;

1.7
date	2001.08.17.21.05.22;	author pvalchev;	state Exp;
branches;
next	1.6;

1.6
date	2001.08.17.13.21.37;	author todd;	state Exp;
branches;
next	1.5;

1.5
date	2001.06.13.01.28.01;	author brad;	state Exp;
branches;
next	1.4;

1.4
date	2001.05.16.15.20.21;	author jakob;	state Exp;
branches;
next	1.3;

1.3
date	2001.03.24.19.55.29;	author jakob;	state Exp;
branches;
next	1.2;

1.2
date	2001.02.19.17.44.52;	author danh;	state Exp;
branches;
next	1.1;

1.1
date	2001.02.17.11.57.18;	author jakob;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2001.02.17.11.57.18;	author jakob;	state Exp;
branches;
next	;

1.21.2.1
date	2017.04.14.07.55.09;	author ajacoutot;	state Exp;
branches;
next	;
commitid	Mjwjo1BKfoGCCiq6;


desc
@@


1.23
log
@SECURITY update to heimdal-7.3.0 (CVE-2017-6594).
@
text
@# $OpenBSD: Makefile,v 1.22 2017/04/12 09:50:00 ajacoutot Exp $

COMMENT-main=		Kerberos 5 implementation
COMMENT-devel-docs=	Heimdal C functions documentation
COMMENT-libs=		Heimdal libraries and headers

V=			7.3.0
DISTNAME=		heimdal-${V}

PKGNAME-main=		${DISTNAME}
PKGNAME-devel-docs=	heimdal-devel-docs-${V}
PKGNAME-libs=		heimdal-libs-${V}

CATEGORIES=		security net

SHARED_LIBS +=  roken                3.0      # 19.0
SHARED_LIBS +=  heimbase             2.0      # 1.0
SHARED_LIBS +=  heimedit             1.0      # 0.36
SHARED_LIBS +=  sl                   1.0      # 2.1
SHARED_LIBS +=  wind                 3.0      # 0.0
SHARED_LIBS +=  asn1                 22.0     # 8.0
SHARED_LIBS +=  heimsqlite           1.0      # unknown
SHARED_LIBS +=  hcrypto              0.0      # 5.0
SHARED_LIBS +=  hx509                1.0      # 5.0
SHARED_LIBS +=  krb5                 22.0     # 26.0
SHARED_LIBS +=  heimntlm             1.0      # 1.0
SHARED_LIBS +=  gssapi               9.0      # 3.0
SHARED_LIBS +=  hdb                  3.0      # 11.0
SHARED_LIBS +=  kadm5srv             3.0      # 8.1
SHARED_LIBS +=  kadm5clnt            3.0      # 7.1
SHARED_LIBS +=  kdc                  3.0      # 2.0

HOMEPAGE=		http://www.h5l.org/

MAINTAINER=		Antoine Jacoutot <ajacoutot@@openbsd.org>

# BSD
PERMIT_PACKAGE_CDROM=	Yes

MULTI_PACKAGES=		-main -devel-docs -libs

MASTER_SITES=		https://github.com/heimdal/heimdal/releases/download/heimdal-${V}/

BUILD_DEPENDS=		devel/bison \
			converters/p5-JSON

SYSCONFDIR=		${BASESYSCONFDIR}/heimdal

WANTLIB += c crypto curses pthread termcap util

WANTLIB-main=		${WANTLIB} com_err util
WANTLIB-main +=		heimdal/lib/asn1
WANTLIB-main +=		heimdal/lib/gssapi
WANTLIB-main +=		heimdal/lib/hcrypto
WANTLIB-main +=		heimdal/lib/hdb
WANTLIB-main +=		heimdal/lib/heimbase
WANTLIB-main +=		heimdal/lib/heimedit
WANTLIB-main +=		heimdal/lib/heimntlm
WANTLIB-main +=		heimdal/lib/heimsqlite
WANTLIB-main +=		heimdal/lib/hx509
WANTLIB-main +=		heimdal/lib/kadm5clnt
WANTLIB-main +=		heimdal/lib/kadm5srv
WANTLIB-main +=		heimdal/lib/kdc
WANTLIB-main +=		heimdal/lib/krb5
WANTLIB-main +=		heimdal/lib/roken
WANTLIB-main +=		heimdal/lib/sl
WANTLIB-main +=		heimdal/lib/wind
LIB_DEPENDS-main=	${BASE_PKGPATH},-libs=${V}

PKG_ARCH-devel-docs=	*
WANTLIB-devel-docs=	# empty

WANTLIB-libs=		${WANTLIB} com_err
WANTLIB-libs +=		com_err
LIB_DEPENDS-libs=	sysutils/e2fsprogs

MODGNU_CONFIG_GUESS_DIRS= \
			${WRKSRC} \
			${WRKSRC}/lib/libedit

CONFIGURE_STYLE=	gnu
CONFIGURE_ENV=		LDFLAGS="-L${LOCALBASE}/lib" \
			CPPFLAGS="-I${LOCALBASE}/include"
CONFIGURE_ARGS=		--disable-afs-support \
			--disable-otp

# make sure we only pickup db from base
CONFIGURE_ENV +=	ac_cv_funclib_db_create=no \
			ac_cv_header_db3_db_h=no \
			ac_cv_header_db4_db_h=no \
			ac_cv_header_db5_db_h=no \
			ac_cv_header_db5_db_h=no

# symbol versioning suspected to trigger weird linking problems
# with our binutils
CONFIGURE_ENV +=	rk_cv_version_script=no

# do not pick-up libexecinfo if installed
CONFIGURE_ENV +=	ac_cv_header_execinfo_h=no

# install bins, libs and includes under a non-default PATH/PREFIX
CONFIGURE_ARGS +=	--bindir=${PREFIX}/heimdal/bin \
			--sbindir=${PREFIX}/heimdal/sbin \
			--libexecdir=${PREFIX}/heimdal/libexec \
			--libdir=${PREFIX}/heimdal/lib \
			--includedir=${PREFIX}/heimdal/include

MAKE_ENV=		INSTALL_CATPAGES=no

pre-configure:
	${SUBST_CMD} ${WRKSRC}/tools/krb5-config.in

post-install:
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/heimdal
	${INSTALL_DATA} ${FILESDIR}/krb5.conf \
		${PREFIX}/share/examples/heimdal/

.include <bsd.port.mk>
@


1.22
log
@Update to heimdal-7.2.0.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2016/12/22 09:20:19 ajacoutot Exp $
d7 1
a7 1
V=			7.2.0
@


1.21
log
@Update to heimdal-7.1.0.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2016/12/17 14:58:31 ajacoutot Exp $
d7 1
a7 1
V=			7.1.0
@


1.21.2.1
log
@Fix transit path validation CVE-2017-6594.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2016/12/22 09:20:19 ajacoutot Exp $
a12 2

REVISION-main=		0
@


1.20
log
@Update to heimdal-7.0.3.
This is still an RC but the final version is supposed to come out in a
couple of days. Committing early to catch regressions and all.
Not much depends on this in ports anyway...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2016/11/10 08:54:43 ajacoutot Exp $
d7 1
a7 1
V=			7.0.3
@


1.19
log
@Use SUBST_CMD at pre-configure time instead of a home made substitution.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2016/11/10 06:01:45 jca Exp $
d7 1
a7 1
V=			1.5.3
a13 3
REVISION-main=		1
REVISION-libs=		1

d16 16
a31 16
SHARED_LIBS +=  heimbase             1.1      # 1.0
SHARED_LIBS +=  roken                2.1      # 19.0
SHARED_LIBS +=  heimedit             0.0      # 0.36
SHARED_LIBS +=  sl                   0.1      # 2.1
SHARED_LIBS +=  wind                 2.1      # 0.0
SHARED_LIBS +=  asn1                 21.1     # 8.0
SHARED_LIBS +=  heimsqlite           0.1      # unknown
SHARED_LIBS +=  hx509                0.1      # 5.0
SHARED_LIBS +=  krb5                 21.1     # 26.0
SHARED_LIBS +=  heimntlm             0.0      # 1.0
SHARED_LIBS +=  kafs                 21.0     # 5.1
SHARED_LIBS +=  gssapi               8.1      # 3.0
SHARED_LIBS +=  hdb                  2.1      # 11.0
SHARED_LIBS +=  kadm5srv             2.1      # 8.1
SHARED_LIBS +=  kadm5clnt            2.0      # 7.1
SHARED_LIBS +=  kdc                  2.1      # 2.0
d42 1
a42 1
MASTER_SITES=		http://www.h5l.org/dist/src/
d44 2
a45 1
BUILD_DEPENDS=		devel/bison
d49 1
a49 1
WANTLIB += c crypto curses pthread termcap
d54 1
a62 1
WANTLIB-main +=		heimdal/lib/kafs
d85 1
a85 2
			--disable-otp \
			--without-x
d91 1
a109 24
RM_BIN=			bin/afslog \
			bin/ftp \
			bin/login \
			bin/pfrom \
			bin/su \
			libexec/ftpd \
			libexec/push

RM_MAN=			man1/afslog.1 \
			man1/ftp.1 \
			man1/kx.1 \
			man1/login.1 \
			man1/pfrom.1 \
			man1/rxterm.1 \
			man1/su.1 \
			man1/rxtelnet.1 \
			man1/tenletxr.1 \
			man1/xnlock.1 \
			man5/ftpusers.5 \
			man5/login.access.5 \
			man8/ftpd.8 \
			man8/kxd.8 \
			man8/push.8

a116 10
	# fix bogus symlink
	cd ${PREFIX}/man/man5/ && \
		ln -sf mech.5 qop.5
	# remove until proven useful
.for i in ${RM_BIN}
	rm ${PREFIX}/heimdal/$i
.endfor
.for i in ${RM_MAN}
	rm ${PREFIX}/man/$i
.endfor
@


1.18
log
@Tweak krb5-config to fix rpath and search /usr/local/lib for libcom_err

Problem reported by Jiri B.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2016/03/11 20:28:30 naddy Exp $
d136 2
a137 2
post-patch:
	sed -i 's,%%LOCALBASE%%,${LOCALBASE},g' ${WRKSRC}/tools/krb5-config.in
@


1.17
log
@garbage collect CONFIGURE_SHARED
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2014/11/28 22:34:18 sthen Exp $
d15 1
a15 1
REVISION-libs=		0
d135 3
@


1.16
log
@Oops, missed bumping -libs in previous, as spotted by naddy@@.
Bumping -main as well just in case it's needed.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2014/11/27 11:10:05 sthen Exp $
d86 1
a86 2
CONFIGURE_ARGS=		${CONFIGURE_SHARED} \
			--disable-afs-support \
@


1.15
log
@Disable linker script (and thus symbol versioning), strange linker errors have
been seen on i386 which appear to go away when this is done. Similar behaviour
was seen previously in graphics/jpeg resulting in the same change being made
there.  ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2014/09/04 08:20:16 ajacoutot Exp $
d14 2
a15 1
REVISION-main=		0
@


1.14
log
@Make sure not to pick-up libexecinfo if installed.

spotted by espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2014/07/28 09:49:44 ajacoutot Exp $
d18 2
a19 2
SHARED_LIBS +=  heimbase             1.0      # 1.0
SHARED_LIBS +=  roken                2.0      # 19.0
d21 6
a26 6
SHARED_LIBS +=  sl                   0.0      # 2.1
SHARED_LIBS +=  wind                 2.0      # 0.0
SHARED_LIBS +=  asn1                 21.0     # 8.0
SHARED_LIBS +=  heimsqlite           0.0      # unknown
SHARED_LIBS +=  hx509                0.0      # 5.0
SHARED_LIBS +=  krb5                 21.0     # 26.0
d29 3
a31 3
SHARED_LIBS +=  gssapi               8.0      # 3.0
SHARED_LIBS +=  hdb                  2.0      # 11.0
SHARED_LIBS +=  kadm5srv             2.0      # 8.1
d33 1
a33 1
SHARED_LIBS +=  kdc                  2.0      # 2.0
d95 4
@


1.13
log
@Unbreak build.

ok sthen@@ jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2014/07/13 14:10:13 ajacoutot Exp $
d14 2
d95 3
@


1.12
log
@Import heimdal-1.5.3; aka resurrect security/heimdal.

Heimdal is an implementation of Kerberos 5 (and some more stuff) largely
written in Sweden.

ok sthen@@

Note that it is not enabled yet because none of the requesters for this
port stood up to give me any feedback nor OK. Also this is still a WIP, it
may not even build with all the recent changes in base.
@
text
@d1 1
a1 1
# $OpenBSD$
a106 2
			bin/rcp \
			bin/rsh \
a107 1
			bin/telnet \
d109 17
a125 21
			libexec/popper \
			libexec/push \
			libexec/rshd \
			libexec/telnetd

RM_MAN=			man/man1/afslog.1 \
			man/man1/ftp.1 \
			man/man1/login.1 \
			man/man1/pfrom.1 \
			man/man1/rcp.1 \
			man/man1/rsh.1 \
			man/man1/su.1 \
			man/man1/rxtelnet.1 \
			man/man1/telnet.1 \
			man/man5/ftpusers.5 \
			man/man5/login.access.5 \
			man/man8/ftpd.8 \
			man/man8/popper.8 \
			man/man8/push.8 \
			man/man8/rshd.8 \
			man/man8/telnetd.8
d139 1
a139 1
	rm ${PREFIX}/$i
@


1.11
log
@has come with OpenBSD since 3.0.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2001/09/09 17:56:59 naddy Exp $
d3 29
a31 1
COMES_WITH=	3.0
d33 1
a33 1
COMMENT=	"Kerberos 5 implementation"
d35 1
a35 3
DISTNAME=	heimdal-0.4e
CATEGORIES=    	security
NEED_VERSION=	1.405
d37 4
a40 1
HOMEPAGE=	http://www.pdc.kth.se/heimdal/
d42 1
a42 1
MAINTAINER=	Jakob Schlyter <jakob@@openbsd.org>
d44 1
a44 4
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
d46 1
a46 1
MASTER_SITES=		ftp://ftp.pdc.kth.se/pub/heimdal/src/
d48 31
a78 1
PREFIX=			${LOCALBASE}/heimdal
a79 1
SEPARATE_BUILD=		concurrent
d81 67
a147 16
CONFIGURE_ARGS+=	--localstatedir=/var/heimdal \
		        --with-krb4-lib=/usr/lib \
			--with-krb4-include=/usr/include/kerberosIV \
			${CONFIGURE_SHARED}

FLAVORS=	no_x11
FLAVOR?=

.if ${FLAVOR:L:Mno_x11}
CONFIGURE_ARGS+=	--without-x
.else
USE_X11=		Yes
CONFIGURE_ARGS+=	--with-x \
			--x-includes=${X11BASE}/include \
			--x-libraries=${X11BASE}/lib
.endif
@


1.10
log
@remove leading "a" and "an" from COMMENT
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2001/09/08 10:06:41 jakob Exp $
@


1.9
log
@sync NEED_VERSION to OPENBSD_2_9_BASE
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2001/09/08 09:04:30 jakob Exp $
d5 1
a5 1
COMMENT=	a Kerberos 5 implementation
@


1.8
log
@update to v0.4e
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2001/08/17 21:05:22 pvalchev Exp $
d9 1
a9 1
NEED_VERSION=	1.363
@


1.7
log
@mark with COMES_WITH; ok jakob
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2001/08/17 13:21:37 todd Exp $
d7 1
a7 1
DISTNAME=	heimdal-0.3e
@


1.6
log
@/usr/X11R6 -> ${X11BASE}
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.5 2001/06/13 01:28:01 brad Exp $
@


1.5
log
@don't set USE_X11 period for the no_x11 FLAVOR
--
Problem reported by: Alexis Tremblay <apleks@@descension.org>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2001/05/16 15:20:21 jakob Exp $
d37 2
a38 2
			--x-includes=/usr/X11R6/include \
			--x-libraries=/usr/X11R6/lib
@


1.4
log
@add no_x11 flavour. requested and tested by <russ@@madhaus.cns.utoronto.ca>.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2001/03/24 19:55:29 jakob Exp $
a32 1
USE_X11=		No
@


1.3
log
@move COMMENT into Makefile & touch NEED_VERSION
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2001/02/19 17:44:52 danh Exp $
a22 1
USE_X11=		Yes
a24 2
		        --x-includes=/usr/X11R6/include \
			--x-libraries=/usr/X11R6/lib \
d28 13
@


1.2
log
@use included libtool; sync patches
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2001/02/17 11:57:18 jakob Exp $
d3 1
a3 3
DISTNAME=		heimdal-0.3e
CATEGORIES=     	security
NEED_VERSION=		1.352
d5 3
a7 1
HOMEPAGE=		http://www.pdc.kth.se/heimdal/
d9 3
a11 1
MAINTAINER=		Jakob Schlyter <jakob@@openbsd.org>
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
a21 1
USE_LIBTOOL=		Yes
@


1.1.1.1
log
@heimdal, a free kerberos 5 implementation
@
text
@@
