head	1.2;
access;
symbols
	OPENBSD_3_2:1.1.1.1.0.4
	OPENBSD_3_2_BASE:1.1.1.1
	OPENBSD_3_1:1.1.1.1.0.2
	OPENBSD_3_1_BASE:1.1.1.1
	lebel_2001-Oct-30:1.1.1.1
	lebel:1.1.1;
locks; strict;
comment	@# @;


1.2
date	2003.01.30.22.39.58;	author sturm;	state dead;
branches;
next	1.1;

1.1
date	2001.10.31.18.04.54;	author lebel;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2001.10.31.18.04.54;	author lebel;	state Exp;
branches;
next	;


desc
@@


1.2
log
@update to to 2.4.1

mainly bugfixes, see CHANGES.txt for details

from maintainer with some cosmetics from me
@
text
@$OpenBSD: patch-zebedee_c,v 1.1 2001/10/31 18:04:54 lebel Exp $
--- zebedee.c.orig	Fri Apr 13 16:42:24 2001
+++ zebedee.c	Wed Oct 31 10:44:58 2001
@@@@ -940,7 +940,7 @@@@ message(unsigned short level, int err, c
     ** error number!
     */
 
-    sprintf(msgBuf, "%s(%lu/%lu): %s%s%.*s%s",
+    sprintf(msgBuf, "%.64s(%lu/%lu): %s%s%.*s%s",
 	    Program, (threadPid() % 100000), (threadTid() % 100000),
 	    (timePtr ? timePtr : ""), (timePtr ? ": " : ""),
 	    level, "          ", (level ? "" : "ERROR: "));
@@@@ -2969,7 +2969,7 @@@@ spawnCommand(unsigned short port, char *
     char *shell = DFLT_SHELL;
     char cmdBuf[MAX_LINE_SIZE];
 
-    sprintf(cmdBuf, cmdFormat, (int)port);
+    snprintf(cmdBuf, sizeof(cmdBuf), cmdFormat, (int)port);
 
     if (((shell = getenv("SHELL")) == NULL) || *shell == '\0')
     {
@@@@ -3105,8 +3105,12 @@@@ filterLoop(int localFd, int remoteFd, Ms
 		}
 		else
 		{
-		    num = send(localFd, (char *)(msgBuf->data),
-			       msgBuf->size, 0);
+                    int i;
+                    num = 0;
+                    do
+                    {
+		        i = send(localFd, (char *)(msgBuf->data)+num, msgBuf->size-num, 0);
+                    } while ((i != -1) && ((num+=i) < msgBuf->size));
 		}
 		if (num != msgBuf->size)
 		{
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
$OpenBSD$
@


1.1.1.1
log
@initial import security/zebedee 2.2.2:
--
Zebedee is a simple program to establish an encrypted, compressed TCP or
UDP tunnel between two systems. This allows traffic such as telnet, ftp,
VNC, and X to be protected from snooping as well as potentially gaining
performance over low-bandwidth networks from compression.

WWW: http://www.winton.org.uk/zebedee/

Submitted by Jon Leonard <jleonard@@iss.net>
 
@
text
@@
