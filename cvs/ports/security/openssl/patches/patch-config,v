head	1.3;
access;
symbols
	OPENBSD_6_1:1.2.0.4
	OPENBSD_6_1_BASE:1.2
	OPENBSD_6_0:1.2.0.2
	OPENBSD_6_0_BASE:1.2;
locks; strict;
comment	@# @;


1.3
date	2017.05.25.14.39.24;	author sthen;	state Exp;
branches;
next	1.2;
commitid	WZlfx8OcU54OY0JQ;

1.2
date	2016.05.04.08.07.03;	author sthen;	state Exp;
branches;
next	1.1;
commitid	erNKesw4a5ziWW34;

1.1
date	2016.04.29.11.24.05;	author sthen;	state Exp;
branches;
next	;
commitid	kyJAghaz9JZwo4w2;


desc
@@


1.3
log
@update to OpenSSL-1.0.2l
@
text
@$OpenBSD: patch-config,v 1.2 2016/05/04 08:07:03 sthen Exp $

Don't misdetect OpenBSD/i386 as a.out when /usr/lib/libc.so.XX.Y.a
is present (for /etc/rc rebuildlibs).

Index: config
--- config.orig
+++ config
@@@@ -762,6 +762,7 @@@@ case "$GUESSOS" in
   sparc64-*-*bsd*)	OUT="BSD-sparc64" ;;
   ia64-*-*bsd*)		OUT="BSD-ia64" ;;
   amd64-*-*bsd*)	OUT="BSD-x86_64" ;;
+  *86*-*-openbsd)	OUT="BSD-x86-elf" ;;
   *86*-*-*bsd*)		# mimic ld behaviour when it's looking for libc...
 			if [ -L /usr/lib/libc.so ]; then	# [Free|Net]BSD
 			    libc=/usr/lib/libc.so
@


1.2
log
@update to OpenSSL-1.0.2h:

*) Prevent padding oracle in AES-NI CBC MAC check
*) Fix EVP_EncodeUpdate overflow
*) Fix EVP_EncryptUpdate overflow
*) Prevent ASN.1 BIO excessive memory allocation
*) EBCDIC overread
*) Modify behavior of ALPN to invoke callback after SNI/servername
callback, such that updates to the SSL_CTX affect ALPN.
*) Remove LOW from the DEFAULT cipher list, removing single DES
from the default.
*) Only remove the SSLv2 methods with the no-ssl2-method option.
When the methods are enabled and ssl2 is disabled the methods return
NULL.  (i.e. restore ABI compat with pre-1.0.2g cf. SSLv2_*_method)
@
text
@d1 1
a1 1
$OpenBSD: patch-config,v 1.1 2016/04/29 11:24:05 sthen Exp $
d6 4
a9 3
--- config.orig	Tue May  3 14:44:42 2016
+++ config	Wed May  4 08:55:11 2016
@@@@ -753,6 +753,7 @@@@ case "$GUESSOS" in
@


1.1
log
@Fix OpenSSL which uses file on /usr/lib/libc.so.* to figure out if we're ELF
or not, which gets confused with libc.so.*.a files present.
@
text
@d1 14
a14 4
$OpenBSD$
--- config.orig	Fri Apr 29 05:22:38 2016
+++ config	Fri Apr 29 05:22:46 2016
@@@@ -758,7 +758,7 @@@@ case "$GUESSOS" in
a15 7
 			else					# OpenBSD
 			    # ld searches for highest libc.so.* and so do we
-			    libc=`(ls /usr/lib/libc.so.* /lib/libc.so.* | tail -1) 2>/dev/null`
+			    libc=`(ls /usr/lib/libc.so.*[0-9] | tail -1) 2>/dev/null`
 			fi
 			case "`(file -L $libc) 2>/dev/null`" in
 			*ELF*)	OUT="BSD-x86-elf" ;;
@

