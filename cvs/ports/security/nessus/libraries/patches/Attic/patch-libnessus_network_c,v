head	1.2;
access;
symbols
	OPENBSD_5_6:1.1.0.10
	OPENBSD_5_6_BASE:1.1
	OPENBSD_5_5:1.1.0.8
	OPENBSD_5_5_BASE:1.1
	OPENBSD_5_4:1.1.0.6
	OPENBSD_5_4_BASE:1.1
	OPENBSD_5_3:1.1.0.4
	OPENBSD_5_3_BASE:1.1
	OPENBSD_5_2:1.1.0.2
	OPENBSD_5_2_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2014.09.30.16.14.57;	author sthen;	state dead;
branches;
next	1.1;
commitid	uNysh3xy3Jd4kbZZ;

1.1
date	2012.06.28.18.52.00;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Retire ports/security/nessus, it moved to being commercial software several
years ago. (If anyone needs something like this, there's a fork OpenVAS
which is seeing a bit of development, though it's patchy at times - start
with security/openvas in the openbsd-wip github repo).

OK dcoppa@@ aja@@
@
text
@$OpenBSD: patch-libnessus_network_c,v 1.1 2012/06/28 18:52:00 jasper Exp $

Allow building against OpenSSL without SSLv2 support.

--- libnessus/network.c.orig	Wed Jun 27 12:00:55 2012
+++ libnessus/network.c	Thu Jun 28 01:28:20 2012
@@@@ -532,9 +532,6 @@@@ open_SSL_connection(fp, timeout, cert, key, passwd, ce
 
   switch (fp->transport)
     {
-    case NESSUS_ENCAPS_SSLv2:
-      fp->ssl_mt = SSLv2_client_method();
-      break;
     case NESSUS_ENCAPS_SSLv3:
       fp->ssl_mt = SSLv3_client_method();
       break;
@@@@ -544,7 +541,11 @@@@ open_SSL_connection(fp, timeout, cert, key, passwd, ce
     case NESSUS_ENCAPS_SSLv23:	/* Compatibility mode */
       fp->ssl_mt = SSLv23_client_method();
       break;
-      
+    case NESSUS_ENCAPS_SSLv2:
+#ifndef OPENSSL_NO_SSL2
+      fp->ssl_mt = SSLv2_client_method();
+      break;
+#endif
     default:
 #if DEBUG_SSL > 0
       fprintf(stderr, "*Bug* at %s:%d. Unknown transport %d\n",
@


1.1
log
@Allow building against OpenSSL without SSLv2 support.

from brad
@
text
@d1 1
a1 1
$OpenBSD$
@

