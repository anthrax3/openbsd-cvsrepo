head	1.4;
access;
symbols
	OPENBSD_3_1:1.3.0.4
	OPENBSD_3_1_BASE:1.3
	OPENBSD_3_0:1.3.0.2
	OPENBSD_3_0_BASE:1.3
	OPENBSD_2_9_TRACKING_SWITCH:1.3
	OPENBSD_2_9:1.2.0.2
	OPENBSD_2_9_BASE:1.2;
locks; strict;
comment	@# @;


1.4
date	2002.05.25.10.38.58;	author reinhard;	state dead;
branches;
next	1.3;

1.3
date	2001.05.06.14.38.34;	author matt;	state Exp;
branches;
next	1.2;

1.2
date	2001.02.13.03.00.13;	author matt;	state Exp;
branches
	1.2.2.1;
next	1.1;

1.1
date	2001.01.13.03.32.07;	author matt;	state Exp;
branches;
next	;

1.2.2.1
date	2001.06.27.22.32.02;	author matt;	state Exp;
branches;
next	;


desc
@@


1.4
log
@update to nessus-1.2.0; thx John Benninghoff, Srebrenko Sehic
@
text
@$OpenBSD: patch-nessus-libraries_libpeks_configure_in,v 1.3 2001/05/06 14:38:34 matt Exp $
--- nessus-libraries/libpeks/configure.in.orig	Sat Dec 23 12:14:48 2000
+++ nessus-libraries/libpeks/configure.in	Mon Apr 23 18:18:45 2001
@@@@ -39,6 +39,7 @@@@ AC_LANG_C
 dnl Check for several programs
 AM_PROG_LIBTOOL
 AC_PROG_CC
+AC_PROG_CPP
 
 # general options
 # ---------------
@@@@ -88,7 +89,12 @@@@ AC_ARG_ENABLE(gmp,[  --enable-gmp[=/path
 
 # can we use gmp as provided by the os ?
 unset gmplink
-case $enable_gmp in ''|yes)
+case $enable_gmp in ''|yes|/*)
+  case $enable_gmp in /*)
+    save_CFLAGS="$CFLAGS"
+    CFLAGS="$CFLAGS -L$enable_gmp/lib"
+    ;;
+  esac 
   AC_CHECK_LIB(gmp,mp_set_memory_functions,gmplink=-lgmp,,$gmpldflags)
   AC_CHECK_LIB(gmp2,mp_set_memory_functions,gmplink=-lgmp2,,$gmpldflags)
   AC_CHECK_LIB(gmp3,mp_set_memory_functions,gmplink=-lgmp3,,$gmpldflags)
@@@@ -98,17 +104,31 @@@@ case $enable_gmp in ''|yes)
   AC_CHECK_LIB(gmp2,__gmp_set_memory_functions,gmplink=-lgmp2,,$gmpldflags)
   AC_CHECK_LIB(gmp3,__gmp_set_memory_functions,gmplink=-lgmp3,,$gmpldflags)
   }
+  test -z "$gmplink" && {
+    case $enable_gmp in /*)
+      CFLAGS="$save_CFLAGS"
+      gmplink="-L$enable_gmp/lib $gmplink"
+      ;;
+    esac
+  }
   if test -n "$gmplink" ; then
-    # do we use gmp as provided by the os ?
-    unset gmpinc
-    test -d /usr/include/gmp3 && gmpinc="$gmpinc -I/usr/include/gmp3"
-    test -d /usr/include/gmp2 && gmpinc="$gmpinc -I/usr/include/gmp2"
-    test -d /usr/include/gmp  && gmpinc="$gmpinc -I/usr/include/gmp"
+    case $enable_gmp in ''|yes)
+      # do we use gmp as provided by the os ?
+      unset gmpinc
+      test -d /usr/include/gmp3 && gmpinc="$gmpinc -I/usr/include/gmp3"
+      test -d /usr/include/gmp2 && gmpinc="$gmpinc -I/usr/include/gmp2"
+      test -d /usr/include/gmp  && gmpinc="$gmpinc -I/usr/include/gmp"
+      ;;
+    /*)
+      # try to make --enable-gmp work as documented...
+      test -d $enable_gmp/include && gmpinc="-I$enable_gmp/include"
+      ;;
+    esac 
   fi
-  save_CFLAGS="$CFLAGS"
-  CFLAGS="$CFLAGS $gmpinc"
+  ac_cpp_SAVE="$ac_cpp"
+  ac_cpp="$ac_cpp $gmpinc"
   AC_CHECK_HEADER(gmp.h,have_gmp_h=yes,unset have_gmp_h)
-  CFLAGS="$save_CFLAGS"
+  ac_cpp="$ac_cpp_SAVE"
 esac
 
 # config options consistency checks
@


1.3
log
@- ignore existing nessus,nasl-config scripts when building
- more --enable-gmp fixes to configure scripts
@
text
@d1 1
a1 1
$OpenBSD: patch-nessus-libraries_libpeks_configure_in,v 1.2 2001/02/13 03:00:13 matt Exp $
@


1.2
log
@update to 1.0.7a
@
text
@d1 1
a1 1
$OpenBSD: update-patches,v 1.3 2000/06/09 17:08:37 espie Exp $
d3 1
a3 1
+++ nessus-libraries/libpeks/configure.in	Mon Feb 12 20:06:13 2001
d12 1
a12 1
@@@@ -88,7 +89,7 @@@@ AC_ARG_ENABLE(gmp,[  --enable-gmp[=/path
d18 5
d26 2
a27 1
@@@@ -99,11 +100,18 @@@@ case $enable_gmp in ''|yes)
d30 7
d56 10
a65 2
   save_CFLAGS="$CFLAGS"
   CFLAGS="$CFLAGS $gmpinc"
@


1.2.2.1
log
@MFC:
- ignore existing nessus,nasl-config scripts when building
- more --enable-gmp fixes to configure scripts
----
not bumping package version, since this is a build fix only
ok MAINTAINER
@
text
@d1 1
a1 1
$OpenBSD: patch-nessus-libraries_libpeks_configure_in,v 1.3 2001/05/06 14:38:34 matt Exp $
d3 1
a3 1
+++ nessus-libraries/libpeks/configure.in	Mon Apr 23 18:18:45 2001
d12 1
a12 1
@@@@ -88,7 +89,12 @@@@ AC_ARG_ENABLE(gmp,[  --enable-gmp[=/path
a17 5
+  case $enable_gmp in /*)
+    save_CFLAGS="$CFLAGS"
+    CFLAGS="$CFLAGS -L$enable_gmp/lib"
+    ;;
+  esac 
d21 1
a21 2
@@@@ -98,17 +104,31 @@@@ case $enable_gmp in ''|yes)
   AC_CHECK_LIB(gmp2,__gmp_set_memory_functions,gmplink=-lgmp2,,$gmpldflags)
a23 7
+  test -z "$gmplink" && {
+    case $enable_gmp in /*)
+      CFLAGS="$save_CFLAGS"
+      gmplink="-L$enable_gmp/lib $gmplink"
+      ;;
+    esac
+  }
d43 2
a44 10
-  save_CFLAGS="$CFLAGS"
-  CFLAGS="$CFLAGS $gmpinc"
+  ac_cpp_SAVE="$ac_cpp"
+  ac_cpp="$ac_cpp $gmpinc"
   AC_CHECK_HEADER(gmp.h,have_gmp_h=yes,unset have_gmp_h)
-  CFLAGS="$save_CFLAGS"
+  ac_cpp="$ac_cpp_SAVE"
 esac
 
 # config options consistency checks
@


1.1
log
@fix gmp detection bug; 1.0.7 will have this fix included
@
text
@d2 12
a13 3
--- nessus-libraries/libpeks/configure.in.orig	Fri Oct  6 05:32:03 2000
+++ nessus-libraries/libpeks/configure.in	Fri Jan 12 21:09:28 2001
@@@@ -87,9 +87,9 @@@@ AC_ARG_ENABLE(gmp,[  --enable-gmp[=/path
d16 29
a44 23
 case $enable_gmp in ''|yes)
-  AC_CHECK_LIB(gmp,mp_set_memory_functions,gmplink=-lgmp,,$gmpldflags)
-  AC_CHECK_LIB(gmp2,mp_set_memory_functions,gmplink=-lgmp2,,$gmpldflags)
-  AC_CHECK_LIB(gmp3,mp_set_memory_functions,gmplink=-lgmp3,,$gmpldflags)
+  AC_CHECK_LIB(gmp,__gmp_set_memory_functions,gmplink=-lgmp,,$gmpldflags)
+  AC_CHECK_LIB(gmp2,__gmp_set_memory_functions,gmplink=-lgmp2,,$gmpldflags)
+  AC_CHECK_LIB(gmp3,__gmp_set_memory_functions,gmplink=-lgmp3,,$gmpldflags)
 esac
 
 # config options consistency checks
@@@@ -125,9 +125,9 @@@@ else
 	AC_MSG_RESULT([from $gmpsrc (configured)])
 
 	gmpldflags="-L$gmpsrc -L$gmpsrc/lib"
-        AC_CHECK_LIB(gmp,mp_set_memory_functions,gmplink=-lgmp,,$gmpldflags)
-        AC_CHECK_LIB(gmp2,mp_set_memory_functions,gmplink=-lgmp2,,$gmpldflags)
-        AC_CHECK_LIB(gmp3,mp_set_memory_functions,gmplink=-lgmp3,,$gmpldflags)
+        AC_CHECK_LIB(gmp,__gmp_set_memory_functions,gmplink=-lgmp,,$gmpldflags)
+        AC_CHECK_LIB(gmp2,__gmp_set_memory_functions,gmplink=-lgmp2,,$gmpldflags)
+        AC_CHECK_LIB(gmp3,__gmp_set_memory_functions,gmplink=-lgmp3,,$gmpldflags)
 	test -z "$gmplink" && AC_MSG_ERROR([
  *** You loose - the gmp lib was not found at $gmpsrc])
 
@

