head	1.6;
access;
symbols
	OPENBSD_6_0:1.6.0.12
	OPENBSD_6_0_BASE:1.6
	OPENBSD_5_9:1.6.0.8
	OPENBSD_5_9_BASE:1.6
	OPENBSD_5_8:1.6.0.10
	OPENBSD_5_8_BASE:1.6
	OPENBSD_5_7:1.6.0.6
	OPENBSD_5_7_BASE:1.6
	OPENBSD_5_6:1.6.0.4
	OPENBSD_5_6_BASE:1.6
	OPENBSD_5_5:1.6.0.2
	OPENBSD_5_5_BASE:1.6
	OPENBSD_5_4:1.5.0.4
	OPENBSD_5_4_BASE:1.5
	OPENBSD_5_3:1.5.0.2
	OPENBSD_5_3_BASE:1.5
	OPENBSD_5_2:1.4.0.2
	OPENBSD_5_2_BASE:1.4
	robert_20120511:1.1.1.1
	robert:1.1.1;
locks; strict;
comment	@# @;


1.6
date	2014.01.25.13.18.04;	author espie;	state Exp;
branches;
next	1.5;

1.5
date	2012.09.07.13.39.43;	author ajacoutot;	state Exp;
branches;
next	1.4;

1.4
date	2012.05.18.13.05.15;	author ajacoutot;	state Exp;
branches;
next	1.3;

1.3
date	2012.05.18.10.28.05;	author robert;	state Exp;
branches;
next	1.2;

1.2
date	2012.05.11.09.38.28;	author ajacoutot;	state Exp;
branches;
next	1.1;

1.1
date	2012.05.11.09.24.23;	author robert;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2012.05.11.09.24.23;	author robert;	state Exp;
branches;
next	;


desc
@@


1.6
log
@iick, passwd directly in binary file
@
text
@@@comment $OpenBSD: PLIST-client,v 1.5 2012/09/07 13:39:43 ajacoutot Exp $
@@extraunexec rm -rf %D/sbin/samhain.signed
@@extraunexec rm -rf /var/samhain/*
@@man man/man5/samhainrc.5
@@man man/man8/samhain.8
@@comment the binary contains the password!
@@mode 700
@@bin sbin/samhain
@@bin sbin/samhain_setpwd
@@mode
share/doc/pkg-readmes/${FULLPKGNAME}
share/examples/samhain/
share/examples/samhain/samhainrc
@@sample ${SYSCONFDIR}/samhainrc
@@sample /var/samhain/
@@rcscript ${RCDIR}/samhain
@@rcscript ${RCDIR}/samhain_signed
@


1.5
log
@Properly enable xml logs.
Use @@extraunexec instead of @@extra.
Always start the server in check mode.

from robert@@
@
text
@d1 1
a1 1
@@comment $OpenBSD: PLIST-client,v 1.4 2012/05/18 13:05:15 ajacoutot Exp $
d6 2
d10 1
@


1.4
log
@No need for @@extraunexec here, @@extra is enough.
@
text
@d1 2
a2 1
@@comment $OpenBSD: PLIST-client,v 1.3 2012/05/18 10:28:05 robert Exp $
a12 1
@@extra %D/sbin/samhain.signed
@


1.3
log
@Add support for te samhain in-binary password so that remote logging
works and add a readme on how to set this up properly.
@
text
@d1 1
a1 2
@@comment $OpenBSD: PLIST-client,v 1.2 2012/05/11 09:38:28 ajacoutot Exp $
@@extraunexec rm -rf %D/sbin/samhain.signed
d12 1
@


1.2
log
@No need to specify localstatedir, gnu CONFIGURE_STYLE takes care of it.
Remove content of /var/samhain/* with pkg_delete -c.

ok robert@@ (maintainer)
@
text
@d1 2
a2 1
@@comment $OpenBSD: PLIST-client,v 1.1.1.1 2012/05/11 09:24:23 robert Exp $
d7 2
d14 1
@


1.1
log
@Initial revision
@
text
@d1 2
a2 1
@@comment $OpenBSD$
@


1.1.1.1
log
@import of samhain:
Samhain is an open source file integrity and host-based intrusion
detection system for Linux and Unix. It can run as a daemon process,
and and thus can remember file changes - contrary to a tool that runs
from cron, if a file is modified you will get only one report, while
subsequent checks of that file will ignore the modification as it is
already reported (unless the file is modified again).

ok jasper@@
@
text
@@
