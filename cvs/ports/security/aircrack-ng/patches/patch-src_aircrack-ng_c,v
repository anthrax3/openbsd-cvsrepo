head	1.2;
access;
symbols
	OPENBSD_6_2:1.2.0.20
	OPENBSD_6_2_BASE:1.2
	OPENBSD_6_1:1.2.0.18
	OPENBSD_6_1_BASE:1.2
	OPENBSD_6_0:1.2.0.16
	OPENBSD_6_0_BASE:1.2
	OPENBSD_5_9:1.2.0.12
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.2.0.14
	OPENBSD_5_8_BASE:1.2
	OPENBSD_5_7:1.2.0.10
	OPENBSD_5_7_BASE:1.2
	OPENBSD_5_6:1.2.0.8
	OPENBSD_5_6_BASE:1.2
	OPENBSD_5_5:1.2.0.6
	OPENBSD_5_5_BASE:1.2
	OPENBSD_5_4:1.2.0.4
	OPENBSD_5_4_BASE:1.2
	OPENBSD_5_3:1.2.0.2
	OPENBSD_5_3_BASE:1.2;
locks; strict;
comment	@# @;


1.2
date	2012.08.20.11.50.59;	author pascal;	state Exp;
branches;
next	1.1;

1.1
date	2012.08.11.22.58.18;	author pascal;	state Exp;
branches;
next	;


desc
@@


1.2
log
@After feedback from kettenis@@, we won't be defining -DPIC on PIE archs per
default.  Garbage collect the patches that dealt with these issues, and use
the builtin define __PIC__ to detect if we're PIE/PIC.

ok naddy@@
@
text
@$OpenBSD: patch-src_aircrack-ng_c,v 1.1 2012/08/11 22:58:18 pascal Exp $
--- src/aircrack-ng.c.orig	Fri Apr  9 16:50:14 2010
+++ src/aircrack-ng.c	Mon Jul 23 18:31:48 2012
@@@@ -3852,7 +3852,7 @@@@ int crack_wpa_thread( void *arg )
 	int i, j, len, slen;
 	int nparallel = 1;
 
-#if defined(__i386__) || defined(__x86_64__)
+#if (defined(__i386__) || defined(__x86_64__)) && !defined(__PIC__)
 	// Check for SSE2, with SSE2 the algorithm works with 4 keys
 	if (shasse2_cpuid()>=2)
 		nparallel = 4;
@@@@ -4626,7 +4626,7 @@@@ int main( int argc, char *argv[] )
 
 			case 'u' :
 				printf("Nb CPU detected: %d ", cpu_count);
-#if defined(__i386__) || defined(__x86_64__)
+#if (defined(__i386__) || defined(__x86_64__)) && !defined(__PIC__)
 				unused = shasse2_cpuid();
 
 				if (unused == 1) {
@


1.1
log
@Further PIE preparations: aircrack-ng and avidemux both use non-PIC optimised
assembler.  Wrap an #ifndef PIC around it.

ok naddy@@
@
text
@d1 1
a1 1
$OpenBSD$
d9 1
a9 1
+#if (defined(__i386__) || defined(__x86_64__)) && !defined(PIC)
d18 1
a18 1
+#if (defined(__i386__) || defined(__x86_64__)) && !defined(PIC)
@

