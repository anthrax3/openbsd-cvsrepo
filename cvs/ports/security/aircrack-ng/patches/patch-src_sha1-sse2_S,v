head	1.3;
access;
symbols
	OPENBSD_6_0:1.3.0.16
	OPENBSD_6_0_BASE:1.3
	OPENBSD_5_9:1.3.0.12
	OPENBSD_5_9_BASE:1.3
	OPENBSD_5_8:1.3.0.14
	OPENBSD_5_8_BASE:1.3
	OPENBSD_5_7:1.3.0.10
	OPENBSD_5_7_BASE:1.3
	OPENBSD_5_6:1.3.0.8
	OPENBSD_5_6_BASE:1.3
	OPENBSD_5_5:1.3.0.6
	OPENBSD_5_5_BASE:1.3
	OPENBSD_5_4:1.3.0.4
	OPENBSD_5_4_BASE:1.3
	OPENBSD_5_3:1.3.0.2
	OPENBSD_5_3_BASE:1.3;
locks; strict;
comment	@# @;


1.3
date	2012.12.21.17.10.39;	author landry;	state Exp;
branches;
next	1.2;

1.2
date	2012.08.20.11.50.59;	author pascal;	state Exp;
branches;
next	1.1;

1.1
date	2012.08.11.22.58.18;	author pascal;	state Exp;
branches;
next	;


desc
@@


1.3
log
@Fix on hppa: add a gratuitous tab before .section in sha1-sse2.S. For some
reason the hppa asm doesnt like .section to start at column 0. No fallout on
amd64.
With hints from kettenis@@
@
text
@$OpenBSD: patch-src_sha1-sse2_S,v 1.2 2012/08/20 11:50:59 pascal Exp $
chunk 2 needed on hppa, otherwise fails with
sha1-sse2.S:469: Error: unknown pseudo-op: `.note.gnu'
--- src/sha1-sse2.S.orig	Thu Jan 21 18:01:28 2010
+++ src/sha1-sse2.S	Fri Dec 21 10:02:29 2012
@@@@ -13,7 +13,7 @@@@
 #define MANGLE(x) x
 #endif
 
-#if defined(__i386__) || defined(__x86_64__)
+#if (defined(__i386__) || defined(__x86_64__)) && !defined(__PIC__)
 
 .globl  shasse2_init;
 .globl  shasse2_ends;
@@@@ -466,5 +466,5 @@@@ cpuid_exit:
 
 
 #ifdef __ELF__
-.section .note.GNU-stack,"",%progbits
+	.section .note.GNU-stack,"",%progbits
 #endif
@


1.2
log
@After feedback from kettenis@@, we won't be defining -DPIC on PIE archs per
default.  Garbage collect the patches that dealt with these issues, and use
the builtin define __PIC__ to detect if we're PIE/PIC.

ok naddy@@
@
text
@d1 5
a5 3
$OpenBSD: patch-src_sha1-sse2_S,v 1.1 2012/08/11 22:58:18 pascal Exp $
--- src/sha1-sse2.S.orig	Mon Jul 23 18:26:22 2012
+++ src/sha1-sse2.S	Mon Jul 23 18:26:39 2012
d15 7
@


1.1
log
@Further PIE preparations: aircrack-ng and avidemux both use non-PIC optimised
assembler.  Wrap an #ifndef PIC around it.

ok naddy@@
@
text
@d1 1
a1 1
$OpenBSD$
d9 1
a9 1
+#if (defined(__i386__) || defined(__x86_64__)) && !defined(PIC)
@

