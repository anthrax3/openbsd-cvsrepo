head	1.1;
access;
symbols
	OPENBSD_6_0:1.1.0.22
	OPENBSD_6_0_BASE:1.1
	OPENBSD_5_9:1.1.0.18
	OPENBSD_5_9_BASE:1.1
	OPENBSD_5_8:1.1.0.20
	OPENBSD_5_8_BASE:1.1
	OPENBSD_5_7:1.1.0.16
	OPENBSD_5_7_BASE:1.1
	OPENBSD_5_6:1.1.0.14
	OPENBSD_5_6_BASE:1.1
	OPENBSD_5_5:1.1.0.12
	OPENBSD_5_5_BASE:1.1
	OPENBSD_5_4:1.1.0.10
	OPENBSD_5_4_BASE:1.1
	OPENBSD_5_3:1.1.0.8
	OPENBSD_5_3_BASE:1.1
	OPENBSD_5_2:1.1.0.6
	OPENBSD_5_2_BASE:1.1
	OPENBSD_5_1_BASE:1.1
	OPENBSD_5_1:1.1.0.4
	OPENBSD_5_0:1.1.0.2
	OPENBSD_5_0_BASE:1.1;
locks; strict;
comment	@# @;


1.1
date	2011.05.21.11.19.24;	author fgsch;	state Exp;
branches;
next	;


desc
@@


1.1
log
@Update to aircrack-ng 1.1.
input and ok sthen and benoit (maintainer)
@
text
@$OpenBSD$
--- src/common.c.orig	Mon May  9 09:14:48 2011
+++ src/common.c	Mon May  9 09:33:03 2011
@@@@ -31,6 +31,7 @@@@
 #define isHex(c) (hexToInt(c) != -1)
 #define HEX_BASE 16
 
+#if !defined(__OpenBSD__)
 int get_ram_size(void) {
 	FILE *fp;
 	char str[256];
@@@@ -52,6 +53,20 @@@@ int get_ram_size(void) {
 	fclose(fp);
 	return ret;
 }
+#else
+#include <sys/param.h>
+#include <sys/sysctl.h>
+
+int get_ram_size(void) {
+	int mib[2] = { CTL_HW, HW_PHYSMEM };
+	unsigned int physmem;
+	size_t len = sizeof(physmem);
+
+	if (sysctl(mib, 2, &physmem, &len, NULL, 0) < 0)
+		return -1;
+	return (physmem / 1024);
+}
+#endif
 
 /* Return the version number */
 char * getVersion(char * progname, int maj, int min, int submin, int svnrev, int beta, int rc)
@
