head	1.3;
access;
symbols
	OPENBSD_3_0:1.2.0.6
	OPENBSD_3_0_BASE:1.2
	OPENBSD_2_9_TRACKING_SWITCH:1.2
	OPENBSD_2_9:1.2.0.4
	OPENBSD_2_9_BASE:1.2
	OPENBSD_2_8:1.2.0.2
	OPENBSD_2_8_BASE:1.2
	OPENBSD_2_7:1.1.1.1.0.2
	OPENBSD_2_7_BASE:1.1.1.1
	dugsong_1999-Oct-27:1.1.1.1
	dugsong:1.1.1;
locks; strict;
comment	@# @;


1.3
date	2002.03.24.10.20.24;	author jsyn;	state dead;
branches;
next	1.2;

1.2
date	2000.09.13.04.49.03;	author kevlo;	state Exp;
branches;
next	1.1;

1.1
date	99.10.28.22.45.38;	author dugsong;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	99.10.28.22.45.38;	author dugsong;	state Exp;
branches;
next	;


desc
@@


1.3
log
@- all real distsites have long since gone away; use
   MASTER_SITE_BACKUP explicitly instead
- remove HOMEPAGE references
- handle configuration file the right way
- do installation a better way
- rename/mod patch; add $OpenBSD$
- NO_REGRESS
@
text
@--- cgichk3.c.orig	Tue Sep 12 21:12:21 2000
+++ cgichk3.c	Tue Sep 12 21:18:42 2000
@@@@ -119,20 +119,11 @@@@
 FILE *cgidata;
 FILE *fp_log;
 
-sserver = argv[1];  /* Server to scan */
-config = argv[2];   /* Cgicheker config file */
+config = CGICHK_CONF;   /* Cgicheker config file */ 
 
 if(argc==1) { usage(&argv[0]); }
 
-if(argc<3) 
- {
- if(strstr(argv[1],"-V")) { banner(); }
- else { usage(&argv[0]); }
- }
-
-if(argc>3) 
- {
-  while ((i = getopt(argc, argv, "p:l:o:c:g")) != -1)
+ while ((i = getopt(argc, argv, "p:l:o:c:gf:V")) != -1)
    {
     switch(i)
      {
@@@@ -146,11 +137,18 @@@@
        { gettxtmode = 1; break; }
       case 'c':
        { httpdport = atoi(optarg); break; }
+      case 'f':
+       { config = optarg; break; }
+      case 'V':
+       { banner(); } 
       default :
        { usage(&argv[0]); break; }
      }
    }
- }
+
+if (argc - optind != 1) usage(&argv[0]);
+
+sserver = argv[optind];  /* Server to scan */ 
 
 if(proxymode==1)
   {
@@@@ -420,14 +418,15 @@@@
 int usage(char *argv[])
 {
  printf("-= CGI Checker Version 3.5 =-");
- printf("\n\nusage : %s target config-file",argv[0]);
+ printf("\n\nusage : %s <options> target",argv[0]);
  printf("\n-p <proxy>   : for stealth scanning behind proxy");
  printf("\n-o <port>    : to change proxy port (default = 8080)");
  printf("\n-c <port>    : to change httpd port (default = 80)");
  printf("\n-l <logfile> : for logging mode");
  printf("\n-g           : to get info on found cgi's");
  printf("\n-V           : print version,info and etc");
- printf("\n\nEg : %s target config-file -p some.proxy.com -g -o 3124 -l logfile\n\n",argv[0]);
+ printf("\n-f <config>  : for alternate config file");
+ printf("\n\nEg : %s -p some.proxy.com -g -o 3124 -l logfile target\n\n",argv[0]);
  exit(0);
 }
 
@


1.2
log
@- Update to version 3.6
- Bump NEED_VERSION
- Add @@comment to package list

OK maintainer(dugsong@@).
@
text
@@


1.1
log
@Initial revision
@
text
@d1 3
a3 3
--- cgichk3.c.orig	Wed Sep 22 19:59:01 1999
+++ cgichk3.c	Thu Oct 28 18:35:37 1999
@@@@ -116,20 +116,11 @@@@
d9 1
a9 1
+config = CGICHK_CONF;   /* Cgicheker config file */
d26 1
a26 1
@@@@ -143,11 +134,18 @@@@
d30 1
a30 2
-      default :
+     case 'f':
d32 3
a34 3
+     case 'V':
+       { banner(); }
+     default :
d42 1
a42 1
+sserver = argv[optind];  /* Server to scan */
d46 1
a46 1
@@@@ -395,14 +393,15 @@@@
d49 1
a49 1
  printf("-= CGI Checker Version 3.0 =-");
@


1.1.1.1
log
@cgichk port
@
text
@@
