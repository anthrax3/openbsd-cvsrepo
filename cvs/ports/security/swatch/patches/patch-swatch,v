head	1.7;
access;
symbols
	OPENBSD_6_1:1.7.0.30
	OPENBSD_6_1_BASE:1.7
	OPENBSD_6_0:1.7.0.28
	OPENBSD_6_0_BASE:1.7
	OPENBSD_5_9:1.7.0.24
	OPENBSD_5_9_BASE:1.7
	OPENBSD_5_8:1.7.0.26
	OPENBSD_5_8_BASE:1.7
	OPENBSD_5_7:1.7.0.22
	OPENBSD_5_7_BASE:1.7
	OPENBSD_5_6:1.7.0.20
	OPENBSD_5_6_BASE:1.7
	OPENBSD_5_5:1.7.0.18
	OPENBSD_5_5_BASE:1.7
	OPENBSD_5_4:1.7.0.16
	OPENBSD_5_4_BASE:1.7
	OPENBSD_5_3:1.7.0.14
	OPENBSD_5_3_BASE:1.7
	OPENBSD_5_2:1.7.0.12
	OPENBSD_5_2_BASE:1.7
	OPENBSD_5_1_BASE:1.7
	OPENBSD_5_1:1.7.0.10
	OPENBSD_5_0:1.7.0.8
	OPENBSD_5_0_BASE:1.7
	OPENBSD_4_9:1.7.0.6
	OPENBSD_4_9_BASE:1.7
	OPENBSD_4_8:1.7.0.4
	OPENBSD_4_8_BASE:1.7
	OPENBSD_4_7:1.7.0.2
	OPENBSD_4_7_BASE:1.7
	OPENBSD_4_6:1.6.0.4
	OPENBSD_4_6_BASE:1.6
	OPENBSD_4_5:1.6.0.2
	OPENBSD_4_5_BASE:1.6
	OPENBSD_4_4:1.5.0.6
	OPENBSD_4_4_BASE:1.5
	OPENBSD_4_3:1.5.0.4
	OPENBSD_4_3_BASE:1.5
	OPENBSD_4_2:1.5.0.2
	OPENBSD_4_2_BASE:1.5
	OPENBSD_4_1:1.4.0.4
	OPENBSD_4_1_BASE:1.4
	OPENBSD_4_0:1.4.0.2
	OPENBSD_4_0_BASE:1.4
	OPENBSD_3_9:1.2.0.10
	OPENBSD_3_9_BASE:1.2
	OPENBSD_3_8:1.2.0.8
	OPENBSD_3_8_BASE:1.2
	OPENBSD_3_7:1.2.0.6
	OPENBSD_3_7_BASE:1.2
	OPENBSD_3_6:1.2.0.4
	OPENBSD_3_6_BASE:1.2
	OPENBSD_3_5:1.2.0.2
	OPENBSD_3_5_BASE:1.2
	OPENBSD_3_4:1.1.0.14
	OPENBSD_3_4_BASE:1.1
	OPENBSD_3_3:1.1.0.12
	OPENBSD_3_3_BASE:1.1
	OPENBSD_3_2:1.1.0.10
	OPENBSD_3_2_BASE:1.1
	OPENBSD_3_1:1.1.0.8
	OPENBSD_3_1_BASE:1.1
	OPENBSD_3_0:1.1.0.6
	OPENBSD_3_0_BASE:1.1
	OPENBSD_2_9_TRACKING_SWITCH:1.1
	OPENBSD_2_9:1.1.0.4
	OPENBSD_2_9_BASE:1.1
	OPENBSD_2_8:1.1.0.2
	OPENBSD_2_8_BASE:1.1;
locks; strict;
comment	@# @;


1.7
date	2010.01.08.13.59.17;	author landry;	state Exp;
branches;
next	1.6;

1.6
date	2009.01.10.21.47.38;	author rui;	state Exp;
branches;
next	1.5;

1.5
date	2007.03.25.13.01.35;	author steven;	state Exp;
branches;
next	1.4;

1.4
date	2006.05.05.11.30.46;	author aanriot;	state Exp;
branches;
next	1.3;

1.3
date	2006.05.02.21.28.26;	author aanriot;	state Exp;
branches;
next	1.2;

1.2
date	2003.12.08.04.05.28;	author margarida;	state Exp;
branches;
next	1.1;

1.1
date	2000.09.17.20.01.42;	author avsm;	state Exp;
branches;
next	;


desc
@@


1.7
log
@Fix tail arguments, -F is a gnu tail idiom.
patch from matteo filippetto@@gmail, thanks!
@
text
@$OpenBSD: patch-swatch,v 1.6 2009/01/10 21:47:38 rui Exp $
--- swatch.orig	Tue Jul  1 20:18:31 2008
+++ swatch	Fri Jan  8 14:58:01 2010
@@@@ -80,7 +80,7 @@@@ my $Config_File     = '';
 my $Now = 0;  # The current time in Unix seconds. Gets set when set_restart_time is called
 my $thCounter = 0;
 my $tail_cmd_name = ''; # We'll try to find it in the PATH later
-my $tail_cmd_args = '-n 0 -F'; 
+my $tail_cmd_args = '-n 0 -f'; 
 $awk_field_syntax = 0;
 
 my $AUTHOR = "E. Todd Atkins <Todd.Atkins\@@StanfordAlumni.ORG>";
@@@@ -151,7 +151,7 @@@@ sub parse_command_line {
 sub dprint {
     my $msg_lev = shift;
     my $msg = shift;
-    print STDERR "DEBUG($msg_lev): $msg\n" if ($msg_lev & $opt_debug_level);
+    print STDERR "DEBUG($msg_lev): $msg\n" if ($msg_lev && $opt_debug_level);
 }
 
  
@


1.6
log
@- update swatch to 3.2.3. Based on initial diff from Benoit Lecocq.
@
text
@d1 12
a12 3
$OpenBSD: patch-swatch,v 1.5 2007/03/25 13:01:35 steven Exp $
--- swatch.orig	Tue Jul  1 19:18:31 2008
+++ swatch	Wed Jan  7 20:00:12 2009
@


1.5
log
@update to swatch 3.2.1

from Rui Reis <rui at rui.cx>
@
text
@d1 4
a4 4
$OpenBSD: patch-swatch,v 1.4 2006/05/05 11:30:46 aanriot Exp $
--- swatch.orig	Fri Jul 21 22:55:00 2006
+++ swatch	Sun Mar 25 14:59:31 2007
@@@@ -148,7 +148,7 @@@@ sub parse_command_line {
@


1.4
log
@- update to 3.1.1 .
- DESCR tweak.
- COMMENT tweak by Michael Knudsen.
- add PKG_ARCH (spotted by alek).

ok alek@@
@
text
@d1 4
a4 4
$OpenBSD$
--- swatch.orig	Wed May  3 06:39:14 2006
+++ swatch	Wed May  3 06:39:22 2006
@@@@ -482,7 +482,7 @@@@ sub parse_command_line {
d11 2
@


1.3
log
@make swatch work with perl 5.8.8 and Getopt::Long rev 1.8 .

"looks ok" steven@@
@
text
@d1 4
a4 12
--- swatch.orig	Fri Apr  4 00:33:05 2003
+++ swatch	Tue May  2 23:00:12 2006
@@@@ -372,7 +372,7 @@@@ sub parse_command_line {
   die "$USAGE" if not GetOptions(
 				 "config-file|c=s" => \$opt_config_file,
 				 "daemon" => \$opt_daemon,
-				 "debug-level=i" => $opt_debug_level,
+				 "debug-level=i" => \$opt_debug_level,
 				 "dump-script:s" => \$opt_dump_script,
 				 "examine|f=s" => \$opt_examine,
 				 "help|h" => \$opt_help,
@@@@ -411,7 +411,7 @@@@ sub parse_command_line {
a10 17
 
 ####### dprint end #######
@@@@ -804,14 +804,11 @@@@ sub ring_bell {
 	      'RINGS' => 1,
 	      @@_
 	     );
-  my $sun_terminal = (`uname -s` eq 'SunOS\n');
-  
   return if exists($args{'WHEN'}) and not inside_time_window($args{'WHEN'});
   
   my $bells = $args{'RINGS'};
   for ( ; $bells > 0 ; $bells-- ) {
     print $BELL;
-    sleep 1 if $sun_terminal; # SunOS needed this. Not sure about Solaris though
   }
 }
 
@


1.2
log
@Update swatch to version 3.0.8
--
From Ferdinand Hoffmann <spNaNT@@web.de>, with mods from me.
MAINTAINER timeout.
@
text
@d1 11
a11 2
--- swatch.orig	2003-12-08 03:50:55.000000000 +0000
+++ swatch	2003-12-08 03:57:52.000000000 +0000
@


1.1
log
@Update from 2.2 -> 3.0.1
It now FAKEs, and installs in a nice clean CPAN way

- CONFIGURE_STYLE is perl now, remove a lot of old manual code
- remove all old patches, and add in a new one which cleans up
  the program a bit (remove small linux specific hacks)

thanks to brad@@ for the review
@
text
@d1 3
a3 28
--- swatch.orig	Tue Mar 28 16:37:35 2000
+++ swatch	Fri Sep 15 00:59:09 2000
@@@@ -1,7 +1,4 @@@@
-# #!/bin/sh -
-eval 'exec perl $0 ${1+"$@@"}'
-if 0;
-
+#!/usr/bin/perl -w
 #
 #    swatch: The Simple WATCHdog
 #    Copyright (C) 1993-2000 E. Todd Atkins
@@@@ -316,13 +313,9 @@@@ my $Me = $0; $Me =~ s%.*/%%;	      # Str
 $SIG{'CHLD'} = 'IGNORE';
 
 my $DEF_CONFIG_FILE = "$ENV{'HOME'}/.swatchrc";
-my $PERL            = 'perl';
-my @@uname           = split(/\s+/,`/bin/uname -a`);
-my $DEF_INPUT       = "/var/log/syslog";
+my $PERL            = '/usr/bin/perl';
+my $DEF_INPUT       = "/var/log/messages";
 my $Config_File     = '';
-if ($uname[0] eq 'Linux') {
-    $DEF_INPUT = "/var/log/messages";
-}
 my $Now = 0;  # The current time in Unix seconds. Gets set when set_restart_time is called
 
 my $USAGE = qq/
@@@@ -393,7 +386,7 @@@@ sub parse_command_line {
d11 2
a12 2
 #
@@@@ -718,14 +711,11 @@@@ sub ring_bell {
a26 9
@@@@ -1047,7 +1037,7 @@@@ LOOP: while (<SW_PIPE>) {
     $code = qq[
 use File::Tail;
 my \$Filename = '$filename';
-my \$File = File::Tail->new(name=>\$Filename);
+my \$File = File::Tail->new(name=>\$Filename,interval=>1,maxinterval=>5,adjustafter=>20);
 if (not defined \$File) {
     die "$0: cannot read input \\"\$Filename\\": \$!\\n";
 }
@

