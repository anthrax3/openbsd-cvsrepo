head	1.21;
access;
symbols
	OPENBSD_6_2:1.21.0.2
	OPENBSD_6_2_BASE:1.21
	OPENBSD_6_1:1.20.0.2
	OPENBSD_6_1_BASE:1.20
	OPENBSD_6_0:1.16.0.4
	OPENBSD_6_0_BASE:1.16
	OPENBSD_5_9:1.16.0.2
	OPENBSD_5_9_BASE:1.16
	OPENBSD_5_8:1.9.0.8
	OPENBSD_5_8_BASE:1.9
	OPENBSD_5_7:1.9.0.4
	OPENBSD_5_7_BASE:1.9
	OPENBSD_5_6:1.9.0.2
	OPENBSD_5_6_BASE:1.9
	OPENBSD_5_5:1.8.0.4
	OPENBSD_5_5_BASE:1.8
	OPENBSD_5_4:1.8.0.2
	OPENBSD_5_4_BASE:1.8
	OPENBSD_5_3:1.6.0.6
	OPENBSD_5_3_BASE:1.6
	OPENBSD_5_2:1.6.0.4
	OPENBSD_5_2_BASE:1.6
	OPENBSD_5_1_BASE:1.6
	OPENBSD_5_1:1.6.0.2
	OPENBSD_5_0:1.4.0.4
	OPENBSD_5_0_BASE:1.4
	OPENBSD_4_9:1.4.0.2
	OPENBSD_4_9_BASE:1.4
	OPENBSD_4_8:1.2.0.2
	OPENBSD_4_8_BASE:1.2
	pea_20100615:1.1.1.1
	pea:1.1.1;
locks; strict;
comment	@# @;


1.21
date	2017.07.28.09.20.19;	author ajacoutot;	state Exp;
branches;
next	1.20;
commitid	GCQvIfO6tquWC6B3;

1.20
date	2016.10.01.13.56.26;	author naddy;	state Exp;
branches;
next	1.19;
commitid	cUPMiTKZjgsMqHEJ;

1.19
date	2016.09.19.17.16.32;	author edd;	state Exp;
branches;
next	1.18;
commitid	Pt5JTZkGEdE5fkIR;

1.18
date	2016.08.27.14.23.35;	author jca;	state Exp;
branches;
next	1.17;
commitid	hTU88pDj7ZhQxvnj;

1.17
date	2016.08.27.14.23.11;	author jca;	state Exp;
branches;
next	1.16;
commitid	traf9fXBNebpiif0;

1.16
date	2015.10.31.16.20.11;	author ajacoutot;	state Exp;
branches;
next	1.15;
commitid	Vl0UUPfFRp7Zu9tW;

1.15
date	2015.10.30.06.35.16;	author ajacoutot;	state Exp;
branches;
next	1.14;
commitid	YZyOTsT9HQhER0nW;

1.14
date	2015.10.23.05.40.00;	author ajacoutot;	state Exp;
branches;
next	1.13;
commitid	fc6sLI8sCnWWxSGi;

1.13
date	2015.10.23.05.23.59;	author ajacoutot;	state Exp;
branches;
next	1.12;
commitid	9TKVdQ5KrW0fuQdW;

1.12
date	2015.10.15.05.35.49;	author ajacoutot;	state Exp;
branches;
next	1.11;
commitid	EorwNRAbDUVIwOp7;

1.11
date	2015.10.12.05.43.53;	author ajacoutot;	state Exp;
branches;
next	1.10;
commitid	KgFDDH92YqZ1nWtd;

1.10
date	2015.10.10.10.15.09;	author ajacoutot;	state Exp;
branches;
next	1.9;
commitid	Yi7snxBXigTiS4KZ;

1.9
date	2014.03.26.18.17.49;	author ajacoutot;	state Exp;
branches;
next	1.8;

1.8
date	2013.07.12.00.49.23;	author jca;	state Exp;
branches;
next	1.7;

1.7
date	2013.03.11.11.41.27;	author espie;	state Exp;
branches;
next	1.6;

1.6
date	2011.11.08.16.55.19;	author stsp;	state Exp;
branches;
next	1.5;

1.5
date	2011.11.04.12.12.53;	author stsp;	state Exp;
branches;
next	1.4;

1.4
date	2011.01.17.15.39.57;	author pea;	state Exp;
branches;
next	1.3;

1.3
date	2010.11.20.17.22.45;	author espie;	state Exp;
branches;
next	1.2;

1.2
date	2010.06.15.13.27.25;	author pea;	state Exp;
branches;
next	1.1;

1.1
date	2010.06.15.13.11.25;	author pea;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2010.06.15.13.11.25;	author pea;	state Exp;
branches;
next	;


desc
@@


1.21
log
@Update to pinentry-1.0.0.

ok pea@@ (maintainer)
@
text
@# $OpenBSD: Makefile,v 1.20 2016/10/01 13:56:26 naddy Exp $

COMMENT-main = 	PIN or passphrase entry dialog (ncurses interface)
COMMENT-gtk2 = 	PIN or passphrase entry dialog (gtk2 interface)
COMMENT-gnome3 =PIN or passphrase entry dialog (GNOME 3 interface)

VERSION = 	1.0.0
DISTNAME = 	pinentry-${VERSION}
CATEGORIES = 	security
EXTRACT_SUFX =	.tar.bz2

PKGNAME-main = 	${DISTNAME}
PKGNAME-gtk2 = 	pinentry-gtk2-${VERSION}
PKGNAME-gnome3 =pinentry-gnome3-${VERSION}

MASTER_SITES = 	${MASTER_SITE_GNUPG:=pinentry/}

HOMEPAGE = 	http://www.gnupg.org/related_software/pinentry/index.en.html

MAINTAINER = 	Pierre-Emmanuel Andre <pea@@openbsd.org>

# GPLv2
PERMIT_PACKAGE_CDROM = 	Yes

MULTI_PACKAGES = 	-main -gtk2 -gnome3

WANTLIB += c assuan gio-2.0 glib-2.0 gobject-2.0 gpg-error iconv intl
WANTLIB += ncursesw secret-1

LIB_DEPENDS =		security/libassuan \
			x11/gnome/libsecret

WANTLIB-gtk2 += ${WANTLIB}
WANTLIB-gtk2 += X11 Xcomposite Xcursor Xdamage Xext Xfixes Xi Xinerama
WANTLIB-gtk2 += Xrandr Xrender atk-1.0 cairo fontconfig freetype gdk-x11-2.0
WANTLIB-gtk2 += gdk_pixbuf-2.0 gtk-x11-2.0 pango-1.0 pangocairo-1.0
WANTLIB-gtk2 += pangoft2-1.0 z

LIB_DEPENDS-gtk2 = 	${LIB_DEPENDS} \
			x11/gtk+2

WANTLIB-gnome3 += ${WANTLIB}
WANTLIB-gnome3 += gck-1 gcr-base-3 p11-kit

LIB_DEPENDS-gnome3 =	${LIB_DEPENDS} \
			x11/gnome/gcr

CONFIGURE_STYLE = 	gnu
CONFIGURE_ENV = 	CPPFLAGS="-I${LOCALBASE}/include -D_XOPEN_SOURCE_EXTENDED" \
			LDFLAGS="-L${LOCALBASE}/lib"
CONFIGURE_ARGS = 	--enable-pinentry-curses \
			--disable-pinentry-qt

MULTI_PACKAGES =	-main -gtk2 -gnome3

PSEUDO_FLAVORS=		no_gtk2 no_gnome3 bootstrap
FLAVOR?=		no_gtk2 no_gnome3 bootstrap

.include <bsd.port.arch.mk>

.if !${BUILD_PACKAGES:M-gtk2}
CONFIGURE_ARGS +=	--disable-pinentry-gtk2
.endif

.if !${BUILD_PACKAGES:M-gnome3}
CONFIGURE_ARGS +=	--disable-pinentry-gnome3
.endif

# http://pkgs.fedoraproject.org/cgit/pinentry.git/tree/pinentry-wrapper
post-install:
	rm ${PREFIX}/bin/pinentry
	${SUBST_CMD} -c -o ${BINOWN} -g ${BINGRP} -m ${BINMODE} \
		${FILESDIR}/pinentry-wrapper.in ${PREFIX}/bin/pinentry

.include <bsd.port.mk>
@


1.20
log
@rename MASTER_SITES_GNUPG to MASTER_SITE_GNUPG, like all the others
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2016/09/19 17:16:32 edd Exp $
d7 1
a7 1
VERSION = 	0.9.7
d30 1
a30 2
LIB_DEPENDS =		devel/gettext \
			security/libassuan \
d43 1
a43 2
WANTLIB-gnome3 += atk-1.0 cairo cairo-gobject gck-1 gcr-base-3 gcr-ui-3
WANTLIB-gnome3 += gdk-3 gdk_pixbuf-2.0 gtk-3 p11-kit pango-1.0 pangocairo-1.0
@


1.19
log
@Update pinentry to 0.9.7.

OK jca@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2016/08/27 14:23:35 jca Exp $
d16 1
a16 1
MASTER_SITES = 	${MASTER_SITES_GNUPG:=pinentry/}
@


1.18
log
@Whitespace.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2016/08/27 14:23:11 jca Exp $
d7 1
a7 1
VERSION = 	0.9.6
a15 4
REVISION-main =	4
REVISION-gtk2 =	0
REVISION-gnome3= 0

d28 1
a28 1
WANTLIB += ncursesw pthread secret-1
@


1.17
log
@Drop the gettext module.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2015/10/31 16:20:11 ajacoutot Exp $
d56 1
a56 1
			LDFLAGS="-L${LOCALBASE}/lib"	
d80 1
a80 1
	
@


1.16
log
@Fix cpu loop.

issue reported by Raf Czlonka, thanks.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2015/10/30 06:35:16 ajacoutot Exp $
d16 3
a18 1
REVISION-main =	3
d31 2
a32 2
WANTLIB += c assuan gio-2.0 glib-2.0 gobject-2.0 gpg-error ncursesw
WANTLIB += pthread secret-1
d34 2
a35 1
LIB_DEPENDS =		security/libassuan \
a52 2

MODULES = 		devel/gettext
@


1.15
log
@Fix pinentry wrapper installation.

reported by Raf Czlonka
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2015/10/23 05:40:00 ajacoutot Exp $
d16 1
a16 1
REVISION-main =	2
d54 1
a54 1
CONFIGURE_ENV = 	CPPFLAGS="-I${LOCALBASE}/include" \
@


1.14
log
@Hmm the tree I committed from was not clean, to say the least...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2015/10/15 05:35:49 ajacoutot Exp $
d16 1
a16 1
REVISION-main =	1
d76 1
@


1.13
log
@Add a wrapper to start the proper pinentry-* according to our running
environment; having an ncurse prompt while running a Desktop isn't too
helpful.  From Fedora -- all Linux distros use this.

ok pea@@ (maintainer)
@
text
@d16 1
a16 1
REVISION-main =	0
a71 15
.endif

MULTI_PACKAGES =       -main -gtk2 -gnome3

PSEUDO_FLAVORS=                no_gtk2 no_gnome3 bootstrap
FLAVOR?=               no_gtk2 no_gnome3 bootstrap

.include <bsd.port.arch.mk>

.if !${BUILD_PACKAGES:M-gtk2}
CONFIGURE_ARGS +=      --disable-pinentry-gtk2
.endif

.if !${BUILD_PACKAGES:M-gnome3}
CONFIGURE_ARGS +=      --disable-pinentry-gnome3
@


1.12
log
@Add a bootstrap FLAVOR to prevent a loop:
pinentry,-gnome3 -> gcr -> gnupg2 -> pinentry
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2015/10/12 05:43:53 ajacoutot Exp $
d16 2
d74 16
a89 2
# Change default 'pinentry' to pinentry-curses in the -main package.
# The shipped Makefiles insist on setting it to the gtk2 variant.
d91 2
a92 1
	ln -sf pinentry-curses ${PREFIX}/bin/pinentry
@


1.11
log
@Update to pinentry-0.9.6.
Add a -gnome3 subpackage which will be needed by an upcoming gnome-keyring
update.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2015/10/10 10:15:09 ajacoutot Exp $
d55 16
a70 2
			--disable-pinentry-qt \
			--enable-pinentry-gtk2
@


1.10
log
@-main only needs iconv, not gettext.
@
text
@d1 1
a1 4
# $OpenBSD: Makefile,v 1.9 2014/03/26 18:17:49 ajacoutot Exp $

# pinentry builds against it's own stripped version of libassuan
# I will see with upstream how to change this behavior
d5 1
d7 1
a7 1
VERSION = 	0.8.1
d10 1
a11 2
REVISION-main = 2
REVISION-gtk2 = 1
d14 1
d25 20
a44 1
MULTI_PACKAGES = 	-main -gtk2
d46 2
a47 12
WANTLIB-main = 		c ncurses ${MODLIBICONV_WANTLIB}
LIB_DEPENDS-main =	${MODLIBICONV_LIB_DEPENDS}
RUN_DEPENDS-main =	${MODLIBICONV_RUN_DEPENDS}

WANTLIB-gtk2 = 		${WANTLIB} c X11 Xcomposite Xcursor Xdamage \
			Xext Xfixes Xi Xinerama Xrandr Xrender atk-1.0 \
			cairo fontconfig freetype gdk-x11-2.0 \
			gdk_pixbuf-2.0 gio-2.0 glib-2.0 \
			gobject-2.0 gtk-x11-2.0 m ncurses \
			pango-1.0 pangocairo-1.0 pangoft2-1.0 \
			pthread z
LIB_DEPENDS-gtk2 = 	x11/gtk+2
d49 1
a49 1
MODULES = 		devel/gettext converters/libiconv
a55 2
			--disable-pinentry-qt4 \
			--disable-pinentry-gtk \
@


1.9
log
@Sync WANTLIB.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2013/07/12 00:49:23 jca Exp $
d13 1
a13 1
REVISION-main = 1
d30 3
@


1.8
log
@Introduce MASTER_SITES_GNUPG and reuse it for various GnuPG
(sub)projects.  http:// urls first, then the primary ftp
site for ''make peek-ftp'', as suggested by sthen@@.
ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2013/03/11 11:41:27 espie Exp $
d13 2
a14 2
REVISION-main = 0
REVISION-gtk2 = 0
d29 2
a30 2
WANTLIB-main = 		${WANTLIB} c ncurses
WANTLIB-gtk2 = 		${WANTLIB} c GL X11 Xcomposite Xcursor Xdamage \
d32 5
a36 5
			cairo expat fontconfig freetype gdk-x11-2.0 \
			gdk_pixbuf-2.0 gio-2.0 glib-2.0 gmodule-2.0  \
			gobject-2.0 gthread-2.0 gtk-x11-2.0 intl m ncurses \
			pango-1.0 pangocairo-1.0 pangoft2-1.0 pixman-1 png \
			pthread pthread-stubs xcb xcb-render xcb-shm z
d39 1
a39 1
MODULES = 		converters/libiconv
@


1.7
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2011/11/08 16:55:19 stsp Exp $
d18 1
a18 1
MASTER_SITES = 	ftp://ftp.gnupg.org/gcrypt/pinentry/
@


1.6
log
@Fix '/usr/local/bin/pinentry' symlink in -main package.
It was pointing to the binary installed by the -gtk2 package.
Also, tweak package descriptions to make more sense.
found by, and ok, naddy
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2011/11/04 12:12:53 stsp Exp $
a25 3
PERMIT_PACKAGE_FTP = 	Yes
PERMIT_DISTFILES_CDROM =Yes
PERMIT_DISTFILES_FTP = 	Yes
@


1.5
log
@Add a subpackage for GTK2 frontend. ok pea@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2011/01/17 15:39:57 pea Exp $
d6 2
a7 2
COMMENT-main = 	collection of simple PIN or passphrase entry dialogs
COMMENT-gtk2 = 	gtk2 frontend for pinentry
d13 2
d53 5
@


1.4
log
@Update to 0.8.1
ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2010/11/20 17:22:45 espie Exp $
d6 2
a7 1
COMMENT = 	collection of simple PIN or passphrase entry dialogs
d9 2
a10 1
DISTNAME = 	pinentry-0.8.1
d13 3
d28 11
a38 1
WANTLIB = 		c ncurses
d49 1
a49 1
			--disable-pinentry-gtk2 
@


1.3
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2010/06/15 13:27:25 pea Exp $
d8 1
a8 2
DISTNAME = 	pinentry-0.8.0
REVISION =	0
@


1.2
log
@Remove the mentions to QT and GTK. They will come later.
Spotted by ajacoutot@@

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2010/06/15 13:11:25 pea Exp $
d9 1
a9 1
PKGNAME = 	${DISTNAME}p0
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d9 1
@


1.1.1.1
log
@Import of pinentry: a small collection of dialog programs that allow GnuPG to 
read passphrases and PIN numbers in a secure manner.

ok jasper@@
@
text
@@
