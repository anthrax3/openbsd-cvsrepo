head	1.1;
access;
symbols
	OPENBSD_4_6:1.1.0.4
	OPENBSD_4_5:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2009.08.14.03.20.35;	author william;	state dead;
branches
	1.1.2.1
	1.1.4.1;
next	;

1.1.2.1
date	2009.08.14.03.20.35;	author william;	state Exp;
branches;
next	;

1.1.4.1
date	2009.10.31.03.58.23;	author william;	state Exp;
branches;
next	;


desc
@@


1.1
log
@file patch-include_xmlsec_openssl_crypto_h was initially added on branch OPENBSD_4_5.
@
text
@@


1.1.4.1
log
@Security fix for CVE-2009-0217:

XML Signature HMAC Truncation Spoofing
@
text
@a0 19
Security fix for CVE-2009-0217:

XML Signature HMAC Truncation Spoofing


$OpenBSD$
--- include/xmlsec/openssl/crypto.h.orig	Wed Nov  7 01:44:01 2007
+++ include/xmlsec/openssl/crypto.h	Tue Aug 11 23:00:50 2009
@@@@ -200,6 +200,10 @@@@ XMLSEC_CRYPTO_EXPORT xmlSecTransformId xmlSecOpenSSLTr
  *
  *******************************************************************/
 #ifndef XMLSEC_NO_HMAC
+
+XMLSEC_CRYPTO_EXPORT int               xmlSecOpenSSLHmacGetMinOutputLength();
+XMLSEC_CRYPTO_EXPORT void              xmlSecOpenSSLHmacSetMinOutputLength(int min_length);
+
 /** 
  * xmlSecOpenSSLKeyDataHmacId:
  * 
@


1.1.2.1
log
@SECURITY FIX

Resolves CVE-2009-0217:

XML Signature HMAC Truncation Spoofing

ok robert@@
@
text
@a0 19
Security fix for CVE-2009-0217:

XML Signature HMAC Truncation Spoofing


$OpenBSD$
--- include/xmlsec/openssl/crypto.h.orig	Wed Nov  7 01:44:01 2007
+++ include/xmlsec/openssl/crypto.h	Tue Aug 11 23:00:50 2009
@@@@ -200,6 +200,10 @@@@ XMLSEC_CRYPTO_EXPORT xmlSecTransformId xmlSecOpenSSLTr
  *
  *******************************************************************/
 #ifndef XMLSEC_NO_HMAC
+
+XMLSEC_CRYPTO_EXPORT int               xmlSecOpenSSLHmacGetMinOutputLength();
+XMLSEC_CRYPTO_EXPORT void              xmlSecOpenSSLHmacSetMinOutputLength(int min_length);
+
 /** 
  * xmlSecOpenSSLKeyDataHmacId:
  * 
@

