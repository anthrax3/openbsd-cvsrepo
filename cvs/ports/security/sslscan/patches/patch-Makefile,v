head	1.6;
access;
symbols
	OPENBSD_6_2:1.6.0.4
	OPENBSD_6_2_BASE:1.6
	OPENBSD_6_1:1.6.0.2
	OPENBSD_6_1_BASE:1.6
	OPENBSD_6_0:1.5.0.2
	OPENBSD_6_0_BASE:1.5
	OPENBSD_5_9:1.4.0.2
	OPENBSD_5_9_BASE:1.4
	OPENBSD_5_8:1.1.1.1.0.20
	OPENBSD_5_8_BASE:1.1.1.1
	OPENBSD_5_7:1.1.1.1.0.16
	OPENBSD_5_7_BASE:1.1.1.1
	OPENBSD_5_6:1.1.1.1.0.14
	OPENBSD_5_6_BASE:1.1.1.1
	OPENBSD_5_5:1.1.1.1.0.12
	OPENBSD_5_5_BASE:1.1.1.1
	OPENBSD_5_4:1.1.1.1.0.10
	OPENBSD_5_4_BASE:1.1.1.1
	OPENBSD_5_3:1.1.1.1.0.8
	OPENBSD_5_3_BASE:1.1.1.1
	OPENBSD_5_2:1.1.1.1.0.6
	OPENBSD_5_2_BASE:1.1.1.1
	OPENBSD_5_1_BASE:1.1.1.1
	OPENBSD_5_1:1.1.1.1.0.4
	OPENBSD_5_0:1.1.1.1.0.2
	OPENBSD_5_0_BASE:1.1.1.1
	ajacoutot_20110621:1.1.1.1
	ajacoutot:1.1.1;
locks; strict;
comment	@# @;


1.6
date	2017.01.27.11.01.14;	author sthen;	state Exp;
branches;
next	1.5;
commitid	v9D7QBjbUNy1EVl0;

1.5
date	2016.03.03.14.41.46;	author sthen;	state Exp;
branches;
next	1.4;
commitid	t6IDAyXVTab614jJ;

1.4
date	2016.01.08.02.08.10;	author sthen;	state Exp;
branches;
next	1.3;
commitid	3zPlc7XgcK32wCWz;

1.3
date	2015.09.16.21.24.46;	author sthen;	state Exp;
branches;
next	1.2;
commitid	DB8SWRxnkmX9LW6s;

1.2
date	2015.09.10.13.55.51;	author sthen;	state Exp;
branches;
next	1.1;
commitid	eq9p9g9fwkk13uvK;

1.1
date	2011.06.21.21.05.48;	author ajacoutot;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2011.06.21.21.05.48;	author ajacoutot;	state Exp;
branches;
next	;


desc
@@


1.6
log
@update to sslscan-1.11.8, convert to GH_* variables, use the SSL_get_state()
accessor rather than digging in the struct directly which no longer works in
libressl (state was moved to internal).
@
text
@$OpenBSD: patch-Makefile,v 1.5 2016/03/03 14:41:46 sthen Exp $
--- Makefile.orig	Sun Nov  6 13:27:11 2016
+++ Makefile	Fri Jan 27 10:45:15 2017
@@@@ -24,9 +24,6 @@@@ DEFINES   = -DVERSION=\"$(GIT_VERSION)\"
 
 # for dynamic linking
 LIBS      = -lssl -lcrypto
-ifneq ($(OS), FreeBSD)
-	LIBS += -ldl
-endif
 
 # for static linking
 ifeq ($(STATIC_BUILD), TRUE)
@@@@ -34,9 +31,6 @@@@ PWD          = $(shell pwd)/openssl
 LDFLAGS      += -L${PWD}/
 CFLAGS       += -I${PWD}/include/ -I${PWD}/
 LIBS         = -lssl -lcrypto -lz
-ifneq ($(OS), FreeBSD)
-	LIBS += -ldl
-endif
 GIT_VERSION  := $(GIT_VERSION)-static
 else
 # for dynamic linking
@@@@ -82,16 +76,12 @@@@ uninstall:
 .openssl.is.fresh: opensslpull
 	true
 opensslpull:
-	if [ -d openssl -a -d openssl/.git ]; then \
-		cd ./openssl && git checkout OpenSSL_1_0_2-stable && git pull | grep -q "Already up-to-date." && [ -e ../.openssl.is.fresh ] || touch ../.openssl.is.fresh ; \
-	else \
-		git clone --depth 1 -b OpenSSL_1_0_2-stable https://github.com/openssl/openssl ./openssl && cd ./openssl && touch ../.openssl.is.fresh ; \
-	fi
+	touch .openssl.is.fresh
 	# Re-enable SSLv2 EXPORT ciphers
 	sed -i.bak 's/# if 0/# if 1/g' openssl/ssl/s2_lib.c
 	rm openssl/ssl/s2_lib.c.bak
 	# Re-enable weak (<1024 bit) DH keys
-	sed -i.bak 's/dh_size < [0-9]\+/dh_size < 512/g' openssl/ssl/s3_clnt.c
+	sed -i.bak -E 's/dh_size < [0-9]\+/dh_size < 512/g' openssl/ssl/s3_clnt.c
 	rm openssl/ssl/s3_clnt.c.bak
 	# Break the weak DH key test so OpenSSL compiles
 	sed -i.bak 's/dhe512/zzz/g' openssl/test/testssl
@


1.5
log
@update to sslscan-1.11.2, now built against static-linked openssl lib
with SSLv2 enabled to allow identification of misconfigured servers
again (as was the case before the last openssl update).
@
text
@d1 14
a14 5
$OpenBSD: patch-Makefile,v 1.4 2016/01/08 02:08:10 sthen Exp $
--- Makefile.orig	Wed Mar  2 17:21:44 2016
+++ Makefile	Thu Mar  3 14:21:14 2016
@@@@ -30,7 +30,7 @@@@ ifeq ($(STATIC_BUILD), TRUE)
 PWD          = $(shell pwd)/openssl
d17 4
a20 2
-LIBS         = -lssl -lcrypto -ldl
+LIBS         = -lssl -lcrypto
d24 19
a42 22
@@@@ -54,10 +54,8 @@@@ sslscan: $(SRCS)
 	$(CC) -o $@@ ${WARNINGS} ${LDFLAGS} ${CFLAGS} ${CPPFLAGS} ${DEFINES} ${SRCS} ${LIBS}
 
 install: sslscan
-	mkdir -p $(DESTDIR)$(BINDIR)
-	mkdir -p $(DESTDIR)$(MAN1DIR)
-	cp sslscan $(DESTDIR)$(BINDIR)
-	cp sslscan.1 $(DESTDIR)$(MAN1DIR)
+	$(BSD_INSTALL_PROGRAM) sslscan $(DESTDIR)$(BINDIR)/sslscan${SUFFIX}
+	$(BSD_INSTALL_MAN) sslscan.1 $(DESTDIR)$(MAN1DIR)/sslscan${SUFFIX}.1
 
 uninstall:
 	rm -f $(DESTDIR)$(BINDIR)/sslscan
@@@@ -78,7 +76,7 @@@@ openssl/Makefile: .openssl.is.fresh
 	cd ./openssl; ./Configure darwin64-x86_64-cc
 # Any other *NIX platform
 else
-openssl/Makefile: .openssl.is.fresh
+openssl/Makefile:
 	cd ./openssl; ./config no-shares enable-weak-ssl-ciphers enable-ssl2
 endif
 
@


1.4
log
@update to sslscan-1.11.1
@
text
@d1 22
a22 11
$OpenBSD: patch-Makefile,v 1.3 2015/09/16 21:24:46 sthen Exp $
--- Makefile.orig	Fri Dec 11 18:41:17 2015
+++ Makefile	Fri Dec 18 23:32:31 2015
@@@@ -54,8 +54,8 @@@@ sslscan: $(SRCS)
 install:
 	mkdir -p $(BINPATH)
 	mkdir -p $(MANPATH)man1/
-	cp sslscan $(BINPATH)
-	cp sslscan.1 $(MANPATH)man1/
+	$(BSD_INSTALL_PROGRAM) sslscan $(BINPATH)/sslscan${SUFFIX}
+	$(BSD_INSTALL_MAN) sslscan.1 $(MANPATH)man1/sslscan${SUFFIX}.1
d25 10
a34 1
 	rm -f $(BINPATH)sslscan
@


1.3
log
@allow libressl and openssl versions of sslscan to coexist in installation;
now you can use one to check for chacha20-poly1305 and the other to check
for SSLv2/v3 support without messing around with pkg_delete/pkg_add between
tests.
@
text
@d1 4
a4 4
$OpenBSD: patch-Makefile,v 1.2 2015/09/10 13:55:51 sthen Exp $
--- Makefile.orig	Thu Aug  6 10:23:13 2015
+++ Makefile	Wed Sep 16 22:16:11 2015
@@@@ -43,8 +43,8 @@@@ sslscan: $(SRCS)
@


1.2
log
@switch to rbsec's version of sslscan. adds TLSv1.1/1.2 support, displays
cert information (alg/strength/issuer/times), heartbleed/compression/secure
reneg checks, etc.
@
text
@d1 3
a3 3
$OpenBSD: patch-Makefile,v 1.1.1.1 2011/06/21 21:05:48 ajacoutot Exp $
--- Makefile.orig	Thu Aug  6 11:23:13 2015
+++ Makefile	Thu Sep 10 15:41:10 2015
d10 2
a11 2
+	$(BSD_INSTALL_PROGRAM) sslscan $(BINPATH)
+	$(BSD_INSTALL_MAN) sslscan.1 $(MANPATH)man1/
@


1.1
log
@Initial revision
@
text
@d1 4
a4 14
$OpenBSD$
--- Makefile.orig	Tue Sep  1 14:35:59 2009
+++ Makefile	Tue Jun 21 19:25:44 2011
@@@@ -1,13 +1,13 @@@@
 SRCS = sslscan.c
-BINPATH = /usr/bin/
-MANPATH = /usr/share/man/
+BINPATH = ${PREFIX}/bin/
+MANPATH = ${PREFIX}/man
 
 all:
-	gcc -g -Wall -lssl -o sslscan $(SRCS) $(LDFLAGS) $(CFLAGS)
+	${CC} -g -Wall -lssl -lcrypto -o sslscan $(SRCS) $(LDFLAGS) $(CFLAGS)
 
d6 2
d9 1
a9 1
-	cp sslscan.1 $(MANPATH)man1
d11 1
a11 1
+	$(BSD_INSTALL_MAN) sslscan.1 $(MANPATH)/man1
@


1.1.1.1
log
@Import sslscan-1.8.2.

SSLScan queries SSL services, such as HTTPS, in order to determine the
ciphers that are supported. SSLScan is designed to be easy, lean and
fast. The output includes prefered ciphers of the SSL service, the
certificate and is in Text and XML formats.

Heavily based on the FreeBSD port.

inputs from sthen@@
ok jasper@@
@
text
@@
