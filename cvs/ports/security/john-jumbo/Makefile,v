head	1.15;
access;
symbols
	OPENBSD_6_2:1.15.0.4
	OPENBSD_6_2_BASE:1.15
	OPENBSD_6_1:1.15.0.2
	OPENBSD_6_1_BASE:1.15
	OPENBSD_6_0:1.12.0.2
	OPENBSD_6_0_BASE:1.12
	OPENBSD_5_9:1.11.0.2
	OPENBSD_5_9_BASE:1.11
	OPENBSD_5_8:1.9.0.6
	OPENBSD_5_8_BASE:1.9
	OPENBSD_5_7:1.9.0.2
	OPENBSD_5_7_BASE:1.9
	OPENBSD_5_6:1.4.0.2
	OPENBSD_5_6_BASE:1.4
	sthen_20140603:1.1.1.1
	sthen:1.1.1;
locks; strict;
comment	@# @;


1.15
date	2016.12.31.18.24.08;	author jca;	state Exp;
branches;
next	1.14;
commitid	bTp2ge4r7RUr8AwE;

1.14
date	2016.09.23.09.16.57;	author sthen;	state Exp;
branches;
next	1.13;
commitid	XLnI6AbHAmyVU5mO;

1.13
date	2016.09.01.10.53.27;	author jasper;	state Exp;
branches;
next	1.12;
commitid	LdsIxWmxagN2Kq33;

1.12
date	2016.03.09.18.31.36;	author jasper;	state Exp;
branches;
next	1.11;
commitid	FOh2GJIkzOkUqaxn;

1.11
date	2015.09.16.12.10.34;	author sthen;	state Exp;
branches;
next	1.10;
commitid	A82Q3EsWqj5CYVZX;

1.10
date	2015.09.16.11.32.27;	author sthen;	state Exp;
branches;
next	1.9;
commitid	bj2wwdfk8DNbfgSE;

1.9
date	2015.01.16.15.40.01;	author sthen;	state Exp;
branches;
next	1.8;
commitid	yFYbyXzN76e4lBaf;

1.8
date	2015.01.16.15.02.23;	author sthen;	state Exp;
branches;
next	1.7;
commitid	Bus0N9wtepIBq5kh;

1.7
date	2014.12.30.21.50.25;	author landry;	state Exp;
branches;
next	1.6;
commitid	S07Q8URJzYgrU6Yg;

1.6
date	2014.10.03.19.59.46;	author naddy;	state Exp;
branches;
next	1.5;
commitid	PDK33Ae7xiNu8d6T;

1.5
date	2014.10.03.13.43.48;	author sthen;	state Exp;
branches;
next	1.4;
commitid	NEBJdXsY4hp7VFBI;

1.4
date	2014.07.10.11.06.37;	author rpe;	state Exp;
branches;
next	1.3;
commitid	UVCzewnjNLIrNVIt;

1.3
date	2014.06.26.22.10.33;	author sthen;	state Exp;
branches;
next	1.2;
commitid	ePRMo8fGnn9ACPeU;

1.2
date	2014.06.04.13.52.40;	author sthen;	state Exp;
branches;
next	1.1;
commitid	kogJJ4nFDE6CRWhE;

1.1
date	2014.06.03.14.27.54;	author sthen;	state Exp;
branches
	1.1.1.1;
next	;
commitid	vLwIvrWpHZmmAlK2;

1.1.1.1
date	2014.06.03.14.27.54;	author sthen;	state Exp;
branches;
next	;
commitid	vLwIvrWpHZmmAlK2;


desc
@@


1.15
log
@Mark as BROKEN on arm, stray '$' in program
@
text
@# $OpenBSD: Makefile,v 1.14 2016/09/23 09:16:57 sthen Exp $

COMMENT =	extremely fast password cracker, with community patches
BROKEN-alpha =	DES_bs.c:173: internal compiler error: in get_callee_fndecl, at tree.c:5940
BROKEN-arm =	uaf_encode_plug.c:61: error: stray '$' in program

V =		1.8.0
JV =		1
REVISION =	1
EXTRACT_SUFX =	.tar.xz

DISTNAME =	john-$V-jumbo-${JV}
PKGNAME =	john-jumbo-$V.${JV}
CATEGORIES =	security

HOMEPAGE =	http://www.openwall.com/john/

# files from various authors; see license review txt file
PERMIT_PACKAGE_CDROM =	see doc/john-1.7.9-jumbo-7-licensing.txt
PERMIT_PACKAGE_FTP =	Yes

WANTLIB += c crypto m nspr4 nss3 pcap plc4 plds4 pthread smime3
WANTLIB += softokn3 sqlite3 ssl ssl3 z

MASTER_SITES =		http://www.openwall.com/john/j/

LIB_DEPENDS =		databases/sqlite3 \
			security/nss

USE_GMAKE =		Yes
MAKE_FILE =		Makefile.legacy

MODULES +=		lang/python
MODPY_BUILDDEP =	No
MODPY_RUNDEP =		No
MODPY_ADJ_FILES =	../run/*.py
CONFIGURE_STYLE =	bleh # hack around python.port.mk default

WRKSRC =		${WRKDIST}/src

COPTFLAGS :=		${CFLAGS}
CFLAGS +=		-c -DHAVE_NSS `pkg-config --cflags nss` \
			-DJOHN_SYSTEMWIDE=1 \
			-DJOHN_SYSTEMWIDE_HOME='\"${SYSCONFDIR}/john\"'
LDFLAGS +=		-lssl -lcrypto -lm -lz `pkg-config --libs nss`

MAKE_FLAGS =		CC="${CC}" CFLAGS="${CFLAGS}" LDFLAGS="${LDFLAGS}" \
			COPTFLAGS="${COPTFLAGS}" HAVE_NSS="-DHAVE_NSS" \
			J=${MAKE_JOBS}

.if ${MACHINE_ARCH} == "i386"
# there is actually a fallback method to allow use of sse where available and
# fall back to mmx/non-cpu-specific code, but it requires building multiple
# times with various targets (openbsd-x86-sse2 openbsd-x86-mmx openbsd-x86-any);
# see -DCPU_FALLBACK=1.
ALL_TARGET=		openbsd-x86-any
.elif ${MACHINE_ARCH} == "amd64"
ALL_TARGET=		openbsd-x86-64
.elif ${MACHINE_ARCH} == "alpha"
ALL_TARGET=		openbsd-alpha
.elif ${MACHINE_ARCH} == "powerpc"
ALL_TARGET=		openbsd-ppc32
.elif ${MACHINE_ARCH} == "hppa"
ALL_TARGET=		openbsd-pa-risc
.elif ${MACHINE_ARCH} == "sparc64"
ALL_TARGET=		openbsd-sparc64
.else
ALL_TARGET=		generic
.endif

BINS += SIPdump calc_stat cprepair genmkvpwd luks2john makechr
BINS += mkvcalcproba raw2dyna tgtsnarf uaf2john vncpcap2john wpapcap2john

do-configure:
	perl -pi -e 's,\$$JOHN/john.conf,${SYSCONFDIR}/john.conf,' ${WRKSRC}/params.h
	rm ${WRKSRC}/KRB4_*_plug.c	# no old DES API support in LibreSSL
	rm ${WRKSRC}/rawSHA0_fmt_plug.c # no SHA-0 support in LibreSSL

do-install:
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/john
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/john
	${INSTALL_PROGRAM} ${WRKDIST}/run/john ${PREFIX}/bin
	cd ${WRKDIST}/run; ${INSTALL_PROGRAM} ${BINS} ${PREFIX}/bin
	${INSTALL_SCRIPT} ${WRKDIST}/run/mailer \
	    ${WRKDIST}/run/*.{pl,py,rb} ${PREFIX}/bin
	for i in `find ${WRKDIST}/run -type l`; do \
	    ln -sf john ${PREFIX}/bin/`basename $$i`; done
	${INSTALL_DATA} ${WRKDIST}/run/*.{chr,conf,lst} \
	    ${PREFIX}/share/examples/john
	${INSTALL_DATA} ${WRKDIST}/doc/* ${PREFIX}/share/doc/john

# not using TEST_TARGET as it gets confused by the quotes in CFLAGS
do-test:
	cd ${WRKSRC}; ${MAKE_PROGRAM} -f ${MAKE_FILE} check

.include <bsd.port.mk>
@


1.14
log
@Cope with moving sqlite3 back to ports.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2016/09/01 10:53:27 jasper Exp $
d5 1
@


1.13
log
@retire sparc
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2016/03/09 18:31:36 jasper Exp $
d8 1
a8 1
REVISION =	0
d26 2
a27 1
LIB_DEPENDS =		security/nss
@


1.12
log
@remove vax workarounds/tentacles, reword where applicable
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2015/09/16 12:10:34 sthen Exp $
a56 2
.elif ${MACHINE_ARCH} == "sparc"
ALL_TARGET=		openbsd-sparc
@


1.11
log
@better comment
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2015/09/16 11:32:27 sthen Exp $
a58 2
.elif ${MACHINE_ARCH} == "vax"
ALL_TARGET=		openbsd-vax
@


1.10
log
@don't build rawSHA0_fmt_plug.c, it relies on libcrypto code which has
been zapped.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2015/01/16 15:40:01 sthen Exp $
d78 1
a78 1
	rm ${WRKSRC}/KRB4_*_plug.c	# no DES support in LibreSSL
@


1.9
log
@update to john-jumbo 1.80-1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2015/01/16 15:02:23 sthen Exp $
d3 1
a3 1
COMMENT =		extremely fast password cracker, with community patches
d8 1
d78 2
a79 1
	rm ${WRKSRC}/KRB4_*_plug.c # undefined reference to `des_set_odd_parity'
@


1.8
log
@adjust security/john-jumbo patches to avoid relying on des.h
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2014/12/30 21:50:25 landry Exp $
d7 2
a8 7
JV =		20140604
REVISION =	0

# when jumbo1 is out, use JV=1 and change PKGNAME to use pl${JV} not pre${JV}
GH_ACCOUNT =	magnumripper
GH_PROJECT =	JohnTheRipper
GH_COMMIT =	3f5494dc78c2ee64fbbbd8c74d495d0bcc895dbc
d11 1
a11 1
PKGNAME =	john-jumbo-$Vpre${JV}
d23 1
a23 2
# Using a bleeding-jumbo snapshot for now.
# Releases: http://www.openwall.com/john/g/
d28 1
a28 2
MAKE_FILE =		Makefile.orig
PATCHORIG =		.orig.port
@


1.7
log
@Mark BROKEN-alpha a bunch of ports that reliably failed (!) to build in
the past 3 bulks, or forever.

Various reasons: no d^Hrecent compiler available, base gcc generating
nice internal compiler errors, no atomic ops, etc, etc.

While here, mark all webkits as BROKEN-hppa, since this also requires
clang or g++ 4.7. Our g++ 4.8 port only builds on
i386|amd64|powerpc|sparc64 anyway...

if you're interested^Wbored to death, full past logs at
http://build-failures.rhaalovely.net/alpha/...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2014/10/03 19:59:46 naddy Exp $
d8 1
@


1.6
log
@fix build on sparc64: do not uselessly evaluate CFLAGS again
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2014/10/03 13:43:48 sthen Exp $
d4 1
@


1.5
log
@mark as BROKEN-sparc64, weird "too few arguments to function 'strnzcpy'"
@
text
@d1 1
a1 3
# $OpenBSD: Makefile,v 1.4 2014/07/10 11:06:37 rpe Exp $

BROKEN-sparc64 = path.c:49: error: too few arguments to function 'strnzcpy'
@


1.4
log
@Move ports that used filename{url}sufx to fetch DISTFILES from
Github to GH_ACCOUNT, GH_PROJECT, GH_TAGNAME, GH_COMMIT.

OK sthen@@ jasper@@ aja@@
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.3 2014/06/26 22:10:33 sthen Exp $
@


1.3
log
@Set J in MAKE_FLAGS (to MAKE_JOBS). john-jumbo make infrastructure passes
this as -j$(J) to child processes, so if undefined this results in "gmake -j".
As gmake(1) says, "If the -j option is given without an argument, gmake
will not limit the number of jobs that can run simultaneously."

Hopefully this fixes a weird build failure that naddy saw and I was able
to replicate after a bunch of build attempts.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2014/06/04 13:52:40 sthen Exp $
d9 3
a11 2
T =		3f5494dc78c2ee64fbbbd8c74d495d0bcc895dbc
WRKDIST =	${WRKDIR}/JohnTheRipper-$T
a13 1
DISTFILES =	${DISTNAME}{$T}.tar.gz
a27 1
MASTER_SITES =		https://github.com/magnumripper/JohnTheRipper/archive/
@


1.2
log
@switch to a snapshot version
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2014/06/03 14:27:54 sthen Exp $
d51 2
a52 1
			COPTFLAGS="${COPTFLAGS}" HAVE_NSS="-DHAVE_NSS"
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2011/11/26 10:31:37 benoit Exp $
d5 2
a6 2
V =			1.7.9
JV =			7
d8 23
a30 18
DISTNAME =		john-$V-jumbo-${JV}
PKGNAME =		john-jumbo-$Vpl${JV}
CATEGORIES =		security

HOMEPAGE =		http://www.openwall.com/john/

# GPL & Public Domain
PERMIT_PACKAGE_CDROM =	Yes

WANTLIB += c crypto glib-2.0 gobject-2.0 gsf-1 m nspr4
WANTLIB += nss3 pcap plc4 plds4 pthread smime3 softokn3 ssl ssl3
WANTLIB += stdc++ xml2 z

MASTER_SITES =		http://www.openwall.com/john/g/
MODULES +=		devel/gettext
LIB_DEPENDS =		devel/libgsf \
			security/nss \
			textproc/libxml
d33 8
d44 1
d51 1
a51 1
			HAVE_NSS="-DHAVE_NSS"
d77 2
a78 2
BINS=			office2john vncpcap2john SIPdump
ALL_TARGET+=		${BINS}
d81 1
a81 1
	${SUBST_CMD} ${WRKSRC}/params.h
d88 1
a88 2
	cd ${WRKDIST}/run; ${INSTALL_PROGRAM} ${BINS} calc_stat genmkvpwd \
	     mkvcalcproba tgtsnarf unafs unique unshadow ${PREFIX}/bin
d91 2
a92 3
.for i in mozilla2john pdf2john racf2john rar2john ssh2john
	ln -sf john ${PREFIX}/bin/$i
.endfor
d99 1
a99 1
	cd ${WRKSRC}; ${MAKE_PROGRAM} check
@


1.1.1.1
log
@import ports/security/john-jumbo, a patched version of John the Ripper with
support for additional hashes etc. ok benoit@@, plus I made a minor fix after
OK to use the gettext module.
@
text
@@
