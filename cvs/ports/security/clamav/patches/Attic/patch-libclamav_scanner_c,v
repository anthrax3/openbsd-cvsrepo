head	1.10;
access;
symbols
	OPENBSD_4_3:1.8.0.2
	OPENBSD_4_3_BASE:1.8
	OPENBSD_4_2:1.6.0.2
	OPENBSD_4_2_BASE:1.6
	OPENBSD_4_1:1.5.0.2
	OPENBSD_4_1_BASE:1.5
	OPENBSD_4_0:1.4.0.2
	OPENBSD_4_0_BASE:1.4
	OPENBSD_3_9:1.3.0.4
	OPENBSD_3_9_BASE:1.3
	OPENBSD_3_8:1.3.0.2
	OPENBSD_3_8_BASE:1.3
	OPENBSD_3_7:1.1.1.1.0.2
	OPENBSD_3_7_BASE:1.1.1.1
	clamav_20050109:1.1.1.1
	mbalmer:1.1.1;
locks; strict;
comment	@# @;


1.10
date	2008.07.08.22.38.12;	author sthen;	state dead;
branches;
next	1.9;

1.9
date	2008.04.16.19.46.02;	author mbalmer;	state Exp;
branches;
next	1.8;

1.8
date	2007.12.30.22.42.39;	author bernd;	state Exp;
branches;
next	1.7;

1.7
date	2007.08.25.10.08.28;	author mbalmer;	state Exp;
branches;
next	1.6;

1.6
date	2007.03.25.11.24.02;	author mbalmer;	state Exp;
branches;
next	1.5;

1.5
date	2007.02.28.20.31.08;	author mbalmer;	state Exp;
branches
	1.5.2.1;
next	1.4;

1.4
date	2006.08.15.18.48.22;	author mbalmer;	state Exp;
branches
	1.4.2.1;
next	1.3;

1.3
date	2005.06.29.10.12.09;	author mbalmer;	state Exp;
branches
	1.3.2.1
	1.3.4.1;
next	1.2;

1.2
date	2005.05.12.14.55.21;	author mbalmer;	state Exp;
branches;
next	1.1;

1.1
date	2005.01.09.17.07.52;	author mbalmer;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2005.01.09.17.07.52;	author mbalmer;	state Exp;
branches;
next	;

1.3.2.1
date	2006.08.20.10.11.17;	author sturm;	state Exp;
branches;
next	;

1.3.4.1
date	2006.08.20.10.11.40;	author sturm;	state Exp;
branches;
next	1.3.4.2;

1.3.4.2
date	2007.03.16.21.31.20;	author sturm;	state Exp;
branches;
next	1.3.4.3;

1.3.4.3
date	2007.03.28.19.53.19;	author sturm;	state Exp;
branches;
next	;

1.4.2.1
date	2007.03.16.22.12.34;	author sturm;	state Exp;
branches;
next	1.4.2.2;

1.4.2.2
date	2007.04.02.14.02.01;	author sturm;	state Exp;
branches;
next	1.4.2.3;

1.4.2.3
date	2007.06.06.06.00.38;	author sturm;	state Exp;
branches;
next	;

1.5.2.1
date	2007.05.01.16.24.35;	author sturm;	state Exp;
branches;
next	1.5.2.2;

1.5.2.2
date	2007.06.06.06.00.05;	author sturm;	state Exp;
branches;
next	;


desc
@@


1.10
log
@update clamav to 0.93.3. possible SECURITY. since 0.93:

- fixes DoS with MailFollowURLs (CVE-2008-2713)
- improves handling of PDF, CAB, RTF, OLE2 and HTML files
and includes various bugfixes for 0.93 issues.

"if it works" mbalmer@@
@
text
@--- libclamav/scanners.c.orig	Wed Apr  2 22:53:44 2008
+++ libclamav/scanners.c	Mon Apr 14 18:41:12 2008
@@@@ -529,11 +529,6 @@@@ static int cli_scangzip(int desc, cli_ctx *ctx)
 
 #ifdef HAVE_BZLIB_H
 
-#ifdef NOBZ2PREFIX
-#define BZ2_bzReadOpen bzReadOpen
-#define BZ2_bzReadClose bzReadClose
-#define BZ2_bzRead bzRead
-#endif
 
 static int cli_scanbzip(int desc, cli_ctx *ctx)
 {
@@@@ -555,7 +550,7 @@@@ static int cli_scanbzip(int desc, cli_ctx *ctx)
 	if(ctx->limits->archivememlim)
 	    memlim = 1;
 
-    if((bfd = BZ2_bzReadOpen(&bzerror, fs, 0, memlim, NULL, 0)) == NULL) {
+    if((bfd = (BZFILE *)BZ2_bzReadOpen(&bzerror, fs, 0, memlim, NULL, 0)) == NULL) {
 	cli_dbgmsg("Bzip: Can't initialize bzip2 library (descriptor: %d).\n", desc);
 	fclose(fs);
 	return CL_EBZIP;
@


1.9
log
@Update ClamAV to version 0.93, which fixes mostly security problems, at
least one highly critical (remote). See http://secunia.com/advisories/29000
for details.

Thanks to kurt@@ for helping analyzing the threaded code issues.
@
text
@@


1.8
log
@Security update to clamav-0.92. (CVE-2007-6335)

"ClamAV libclamav MEW PE File Integer Overflow Vulnerability"

More info:
http://labs.idefense.com/intelligence/vulnerabilities/display.php?id=634

Similar diff submitted by grunk@@ on ports@@.

test & ok mbalmer@@ (MAINTAINER)
@
text
@d1 3
a3 3
--- libclamav/scanners.c.orig	Wed Dec 12 23:48:30 2007
+++ libclamav/scanners.c	Tue Dec 18 10:18:10 2007
@@@@ -809,11 +809,6 @@@@ static int cli_scangzip(int desc, cli_ctx *ctx)
d15 1
a15 1
@@@@ -835,7 +830,7 @@@@ static int cli_scanbzip(int desc, cli_ctx *ctx)
@


1.7
log
@Update ClamAV to version 0.91.2.

Note to -stable ports maintainers:  This should probably be put into -stable
since the ClamAV people do not provide virus data to outdated scan engines.

ok simon
@
text
@d1 3
a3 3
--- libclamav/scanners.c.orig	Mon Jul 16 22:04:52 2007
+++ libclamav/scanners.c	Sat Aug 25 09:35:06 2007
@@@@ -688,11 +688,6 @@@@ static int cli_scangzip(int desc, cli_ctx *ctx)
d15 1
a15 1
@@@@ -714,7 +709,7 @@@@ static int cli_scanbzip(int desc, cli_ctx *ctx)
@


1.6
log
@Update to ClamAV 0.90.1.  Work done mostly by Stuart Henderson, with some
tweaks by myself.
@
text
@d1 3
a3 3
--- libclamav/scanners.c.orig	Thu Mar  1 23:44:49 2007
+++ libclamav/scanners.c	Tue Mar 13 09:27:55 2007
@@@@ -686,11 +686,6 @@@@ static int cli_scangzip(int desc, cli_ct
d15 1
a15 1
@@@@ -712,7 +707,7 @@@@ static int cli_scanbzip(int desc, cli_ct
@


1.5
log
@Update to ClamAV 0.90.  A lot of improvments and bugfixes, see www.clamav.net
for all details.

ok nikolay
@
text
@d1 3
a3 3
--- libclamav/scanners.c.orig	Tue Feb 13 02:06:28 2007
+++ libclamav/scanners.c	Wed Feb 14 08:26:32 2007
@@@@ -699,11 +699,6 @@@@ static int cli_scangzip(int desc, cli_ct
d15 1
a15 1
@@@@ -725,7 +720,7 @@@@ static int cli_scanbzip(int desc, cli_ct
@


1.5.2.1
log
@MFC:
Update to ClamAV 0.90.1.  Work done mostly by Stuart Henderson, with some
tweaks by myself.
---
Security update to ClamAV 0.90.2.  This containe three import security
fixes:

- ClamAV CAB File Unstore Buffer Overflow Vulnerability
- File descriptor leak in CHM handler
- PDF fd leak

From the original annoucement:

**Important note**: on April 16th CHM, CAB and PDF handlers will be
disabled for 0.90 and 0.90.1 users through the dynamic engine
configuration module (DCONF). Please upgrade to 0.90.2 immediately.
@
text
@d1 3
a3 3
--- libclamav/scanners.c.orig	Fri Mar  2 00:44:49 2007
+++ libclamav/scanners.c	Fri Apr 13 17:39:49 2007
@@@@ -686,11 +686,6 @@@@ static int cli_scangzip(int desc, cli_ct
d15 1
a15 1
@@@@ -712,7 +707,7 @@@@ static int cli_scanbzip(int desc, cli_ct
@


1.5.2.2
log
@MFC:
Security Update to ClamAV 0.90.3.

This release contains various bugfixes, see ChangeLog for details.
@
text
@d1 3
a3 3
--- libclamav/scanners.c.orig	Wed May 30 15:21:33 2007
+++ libclamav/scanners.c	Wed Jun  6 07:54:29 2007
@@@@ -688,11 +688,6 @@@@ static int cli_scangzip(int desc, cli_ct
d15 1
a15 1
@@@@ -714,7 +709,7 @@@@ static int cli_scanbzip(int desc, cli_ct
@


1.4
log
@security update to 0.88.4
ok pvalchev
@
text
@d1 3
a3 3
--- libclamav/scanners.c.orig	Sat Jul  1 05:58:56 2006
+++ libclamav/scanners.c	Fri Jul 28 02:28:02 2006
@@@@ -643,11 +643,6 @@@@ static int cli_scangzip(int desc, const 
d13 1
a13 1
 static int cli_scanbzip(int desc, const char **virname, unsigned long int *scanned, const struct cl_node *root, const struct cl_limits *limits, unsigned int options, unsigned int arec, unsigned int mrec)
d15 2
a16 2
@@@@ -668,7 +663,7 @@@@ static int cli_scanbzip(int desc, const 
 	if(limits->archivememlim)
@


1.4.2.1
log
@MFC:
Update to ClamAV 0.90.  A lot of improvments and bugfixes, see www.clamav.net
for all details.
@
text
@d1 3
a3 3
--- libclamav/scanners.c.orig	Tue Feb 13 02:06:28 2007
+++ libclamav/scanners.c	Fri Mar 16 22:50:28 2007
@@@@ -699,11 +699,6 @@@@ static int cli_scangzip(int desc, cli_ct
d13 1
a13 1
 static int cli_scanbzip(int desc, cli_ctx *ctx)
d15 2
a16 2
@@@@ -725,7 +720,7 @@@@ static int cli_scanbzip(int desc, cli_ct
 	if(ctx->limits->archivememlim)
@


1.4.2.2
log
@MFC:
Update to ClamAV 0.90.1.  Work done mostly by Stuart Henderson, with some
tweaks by myself.
@
text
@d1 3
a3 3
--- libclamav/scanners.c.orig	Fri Mar  2 00:44:49 2007
+++ libclamav/scanners.c	Mon Apr  2 15:58:03 2007
@@@@ -686,11 +686,6 @@@@ static int cli_scangzip(int desc, cli_ct
d15 1
a15 1
@@@@ -712,7 +707,7 @@@@ static int cli_scanbzip(int desc, cli_ct
@


1.4.2.3
log
@MFC:
Security Update to ClamAV 0.90.3.

This release contains various bugfixes, see ChangeLog for details.
@
text
@d1 3
a3 3
--- libclamav/scanners.c.orig	Wed May 30 15:21:33 2007
+++ libclamav/scanners.c	Wed Jun  6 07:52:27 2007
@@@@ -688,11 +688,6 @@@@ static int cli_scangzip(int desc, cli_ct
d15 1
a15 1
@@@@ -714,7 +709,7 @@@@ static int cli_scanbzip(int desc, cli_ct
@


1.3
log
@Update to version 0.86.1 and add patches to fix problems on macppc (comparisons
that are always true due to char not being signed on this platform).

This update fixes a possible crash, see
http://sourceforge.net/project/shownotes.php?release_id=337279
for details.
@
text
@d1 3
a3 3
--- libclamav/scanners.c.orig	Thu Jun 23 22:03:12 2005
+++ libclamav/scanners.c	Wed Jun 29 11:00:23 2005
@@@@ -642,11 +642,6 @@@@ static int cli_scangzip(int desc, const 
d13 1
a13 1
 static int cli_scanbzip(int desc, const char **virname, long int *scanned, const struct cl_node *root, const struct cl_limits *limits, unsigned int options, unsigned int arec, unsigned int mrec)
d15 1
a15 1
@@@@ -667,7 +662,7 @@@@ static int cli_scanbzip(int desc, const 
@


1.3.4.1
log
@MFC:
security update to 0.88.4
@
text
@d1 3
a3 3
--- libclamav/scanners.c.orig	Sat Jul  1 05:58:56 2006
+++ libclamav/scanners.c	Fri Jul 28 02:28:02 2006
@@@@ -643,11 +643,6 @@@@ static int cli_scangzip(int desc, const 
d13 1
a13 1
 static int cli_scanbzip(int desc, const char **virname, unsigned long int *scanned, const struct cl_node *root, const struct cl_limits *limits, unsigned int options, unsigned int arec, unsigned int mrec)
d15 1
a15 1
@@@@ -668,7 +663,7 @@@@ static int cli_scanbzip(int desc, const 
@


1.3.4.2
log
@MFC:
Update to ClamAV 0.90.  A lot of improvments and bugfixes, see www.clamav.net
for all details.
@
text
@d1 3
a3 3
--- libclamav/scanners.c.orig	Tue Feb 13 02:06:28 2007
+++ libclamav/scanners.c	Fri Mar 16 19:08:38 2007
@@@@ -699,11 +699,6 @@@@ static int cli_scangzip(int desc, cli_ct
d13 1
a13 1
 static int cli_scanbzip(int desc, cli_ctx *ctx)
d15 2
a16 2
@@@@ -725,7 +720,7 @@@@ static int cli_scanbzip(int desc, cli_ct
 	if(ctx->limits->archivememlim)
@


1.3.4.3
log
@MFC:
Update to ClamAV 0.90.1.  Work done mostly by Stuart Henderson, with some
tweaks by myself.
@
text
@d1 3
a3 3
--- libclamav/scanners.c.orig	Fri Mar  2 00:44:49 2007
+++ libclamav/scanners.c	Wed Mar 28 21:45:24 2007
@@@@ -686,11 +686,6 @@@@ static int cli_scangzip(int desc, cli_ct
d15 1
a15 1
@@@@ -712,7 +707,7 @@@@ static int cli_scanbzip(int desc, cli_ct
@


1.3.2.1
log
@MFC:
security update to 0.88.4
@
text
@d1 3
a3 3
--- libclamav/scanners.c.orig	Sat Jul  1 05:58:56 2006
+++ libclamav/scanners.c	Fri Jul 28 02:28:02 2006
@@@@ -643,11 +643,6 @@@@ static int cli_scangzip(int desc, const 
d13 1
a13 1
 static int cli_scanbzip(int desc, const char **virname, unsigned long int *scanned, const struct cl_node *root, const struct cl_limits *limits, unsigned int options, unsigned int arec, unsigned int mrec)
d15 1
a15 1
@@@@ -668,7 +663,7 @@@@ static int cli_scanbzip(int desc, const 
@


1.2
log
@Update to ClamAV version 0.85
@
text
@d1 3
a3 3
--- libclamav/scanners.c.orig	Thu Apr  7 00:45:28 2005
+++ libclamav/scanners.c	Sun Apr 10 10:00:25 2005
@@@@ -632,11 +632,6 @@@@ static int cli_scangzip(int desc, const 
d15 1
a15 1
@@@@ -657,7 +652,7 @@@@ static int cli_scanbzip(int desc, const 
@


1.1
log
@Initial revision
@
text
@d1 3
a3 3
--- libclamav/scanners.c.orig	Sun Oct 17 01:24:48 2004
+++ libclamav/scanners.c	Tue Dec 21 16:37:12 2004
@@@@ -494,11 +494,6 @@@@ static int cli_scangzip(int desc, const 
d13 1
a13 1
 static int cli_scanbzip(int desc, const char **virname, long int *scanned, const struct cl_node *root, const struct cl_limits *limits, unsigned int options, int *arec, int *mrec)
d15 1
a15 1
@@@@ -519,7 +514,7 @@@@ static int cli_scanbzip(int desc, const 
@


1.1.1.1
log
@Clam Antivirus is a free virus scanner with a command line scanner, a
scanning daemon (clamd), signature update from the net (freshclam), and
a sendmail-milter (clamav-milter).

ok alek@@
@
text
@@
