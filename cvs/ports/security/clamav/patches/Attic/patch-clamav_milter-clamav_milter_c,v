head	1.12;
access;
symbols
	OPENBSD_4_5:1.11.0.2
	OPENBSD_4_5_BASE:1.11
	OPENBSD_4_4:1.9.0.2
	OPENBSD_4_4_BASE:1.9
	OPENBSD_4_3:1.7.0.2
	OPENBSD_4_3_BASE:1.7
	OPENBSD_4_2:1.5.0.2
	OPENBSD_4_2_BASE:1.5
	OPENBSD_4_1:1.4.0.2
	OPENBSD_4_1_BASE:1.4
	OPENBSD_4_0:1.3.0.6
	OPENBSD_4_0_BASE:1.3
	OPENBSD_3_9:1.3.0.4
	OPENBSD_3_9_BASE:1.3
	OPENBSD_3_8:1.3.0.2
	OPENBSD_3_8_BASE:1.3
	OPENBSD_3_7:1.1.1.1.0.2
	OPENBSD_3_7_BASE:1.1.1.1
	clamav_20050109:1.1.1.1
	mbalmer:1.1.1;
locks; strict;
comment	@# @;


1.12
date	2009.04.11.14.13.59;	author sthen;	state dead;
branches;
next	1.11;

1.11
date	2008.11.07.22.33.06;	author sthen;	state Exp;
branches;
next	1.10;

1.10
date	2008.09.14.15.00.43;	author sthen;	state Exp;
branches;
next	1.9;

1.9
date	2008.07.08.22.38.12;	author sthen;	state Exp;
branches;
next	1.8;

1.8
date	2008.04.16.19.46.01;	author mbalmer;	state Exp;
branches;
next	1.7;

1.7
date	2007.12.30.22.42.38;	author bernd;	state Exp;
branches;
next	1.6;

1.6
date	2007.08.25.10.08.28;	author mbalmer;	state Exp;
branches;
next	1.5;

1.5
date	2007.03.25.11.24.02;	author mbalmer;	state Exp;
branches;
next	1.4;

1.4
date	2007.02.28.20.31.08;	author mbalmer;	state Exp;
branches
	1.4.2.1;
next	1.3;

1.3
date	2005.06.29.10.12.09;	author mbalmer;	state Exp;
branches
	1.3.4.1
	1.3.6.1;
next	1.2;

1.2
date	2005.05.12.14.55.21;	author mbalmer;	state Exp;
branches;
next	1.1;

1.1
date	2005.01.09.17.07.52;	author mbalmer;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2005.01.09.17.07.52;	author mbalmer;	state Exp;
branches;
next	;

1.3.4.1
date	2007.03.16.21.31.20;	author sturm;	state Exp;
branches;
next	1.3.4.2;

1.3.4.2
date	2007.03.28.19.53.19;	author sturm;	state Exp;
branches;
next	;

1.3.6.1
date	2007.03.16.22.12.34;	author sturm;	state Exp;
branches;
next	1.3.6.2;

1.3.6.2
date	2007.04.02.14.02.01;	author sturm;	state Exp;
branches;
next	1.3.6.3;

1.3.6.3
date	2007.09.12.14.51.58;	author sturm;	state Exp;
branches;
next	;

1.4.2.1
date	2007.05.01.16.24.35;	author sturm;	state Exp;
branches;
next	1.4.2.2;

1.4.2.2
date	2007.09.12.14.48.06;	author sturm;	state Exp;
branches;
next	;


desc
@@


1.12
log
@security update to 0.95.1. it doesn't build with ports-tree libtool,
so use the bundled one and mark with XXX until it can be fixed better.
commit requested by mbalmer (maintainer).
@
text
@--- clamav-milter/clamav-milter.c.orig	Thu Oct 16 09:29:55 2008
+++ clamav-milter/clamav-milter.c	Fri Nov  7 02:29:18 2008
@@@@ -1204,7 +1204,7 @@@@ main(int argc, char **argv)
 		 * uid == 0 for that
 		 */
 		on = 1;
-		if(setsockopt(broadcastSock, SOL_SOCKET, SO_BROADCAST, (int *)&on, sizeof(on)) < 0) {
+		if(setsockopt(broadcastSock, SOL_SOCKET, 0, (int *)&on, sizeof(on)) < 0) {
 			perror("setsockopt");
 			return EX_UNAVAILABLE;
 		}
@@@@ -1227,7 +1227,7 @@@@ main(int argc, char **argv)
 			memset(&ifr, '\0', sizeof(struct ifreq));
 			strncpy(ifr.ifr_name, iface, sizeof(ifr.ifr_name) - 1);
 			ifr.ifr_name[sizeof(ifr.ifr_name)-1]='\0';
-			if(setsockopt(broadcastSock, SOL_SOCKET, SO_BINDTODEVICE, &ifr, sizeof(ifr)) < 0) {
+			if(setsockopt(broadcastSock, SOL_SOCKET, 0, &ifr, sizeof(ifr)) < 0) {
 				perror(iface);
 				return EX_CONFIG;
 			}
@


1.11
log
@update to 0.94.1; sundry fixes
ok mbalmer (maintainer)
@
text
@@


1.10
log
@SECURITY and other bug fixes.

- A vulnerability in ClamAV's chm-parser allowed remote attackers to
cause a denial of service (application crash) via a malformed CHM file
(CVE-2008-1389).

- A vulnerability in libclamav would allow attackers to cause a
denial of service via vectors related to an out-of-memory condition
(CVE-2008-3912).

- Multiple memory leaks were found in ClamAV that could possibly allow
attackers to cause a denial of service via excessive memory consumption
(CVE-2008-3913).

- A number of unspecified vulnerabilities in ClamAV were reported that
have an unknown impact and attack vectors related to file descriptor
leaks (CVE-2008-3914).

various OpenBSD patches rolled in upstream. thanks to sturm@@
for looking over systrace.filter (needed for the test of sendmsg()
in configure to enable FD passing).
@
text
@d1 3
a3 3
--- clamav-milter/clamav-milter.c.orig	Mon Sep  1 18:19:44 2008
+++ clamav-milter/clamav-milter.c	Fri Sep  5 02:32:34 2008
@@@@ -1201,7 +1201,7 @@@@ main(int argc, char **argv)
d12 1
a12 1
@@@@ -1224,7 +1224,7 @@@@ main(int argc, char **argv)
@


1.9
log
@update clamav to 0.93.3. possible SECURITY. since 0.93:

- fixes DoS with MailFollowURLs (CVE-2008-2713)
- improves handling of PDF, CAB, RTF, OLE2 and HTML files
and includes various bugfixes for 0.93 issues.

"if it works" mbalmer@@
@
text
@d1 3
a3 3
--- clamav-milter/clamav-milter.c.orig	Tue May 27 04:40:29 2008
+++ clamav-milter/clamav-milter.c	Thu Jun 12 17:31:16 2008
@@@@ -1134,7 +1134,7 @@@@ main(int argc, char **argv)
d12 1
a12 1
@@@@ -1157,7 +1157,7 @@@@ main(int argc, char **argv)
@


1.8
log
@Update ClamAV to version 0.93, which fixes mostly security problems, at
least one highly critical (remote). See http://secunia.com/advisories/29000
for details.

Thanks to kurt@@ for helping analyzing the threaded code issues.
@
text
@d1 2
a2 2
--- clamav-milter/clamav-milter.c.orig	Wed Apr  9 17:39:18 2008
+++ clamav-milter/clamav-milter.c	Mon Apr 14 18:41:12 2008
d12 1
a12 2
@@@@ -1156,7 +1156,7 @@@@ main(int argc, char **argv)
 
d15 1
@


1.7
log
@Security update to clamav-0.92. (CVE-2007-6335)

"ClamAV libclamav MEW PE File Integer Overflow Vulnerability"

More info:
http://labs.idefense.com/intelligence/vulnerabilities/display.php?id=634

Similar diff submitted by grunk@@ on ports@@.

test & ok mbalmer@@ (MAINTAINER)
@
text
@d1 3
a3 3
--- clamav-milter/clamav-milter.c.orig	Wed Dec 12 23:41:25 2007
+++ clamav-milter/clamav-milter.c	Tue Dec 18 10:18:09 2007
@@@@ -1126,7 +1126,7 @@@@ main(int argc, char **argv)
d12 1
a12 1
@@@@ -1148,7 +1148,7 @@@@ main(int argc, char **argv)
@


1.6
log
@Update ClamAV to version 0.91.2.

Note to -stable ports maintainers:  This should probably be put into -stable
since the ClamAV people do not provide virus data to outdated scan engines.

ok simon
@
text
@d1 3
a3 3
--- clamav-milter/clamav-milter.c.orig	Mon Aug 20 23:01:19 2007
+++ clamav-milter/clamav-milter.c	Sat Aug 25 09:35:06 2007
@@@@ -1116,7 +1116,7 @@@@ main(int argc, char **argv)
d12 1
a12 1
@@@@ -1138,7 +1138,7 @@@@ main(int argc, char **argv)
@


1.5
log
@Update to ClamAV 0.90.1.  Work done mostly by Stuart Henderson, with some
tweaks by myself.
@
text
@d1 3
a3 3
--- clamav-milter/clamav-milter.c.orig	Thu Mar  1 23:27:19 2007
+++ clamav-milter/clamav-milter.c	Tue Mar 13 09:27:54 2007
@@@@ -1078,7 +1078,7 @@@@ main(int argc, char **argv)
d12 1
a12 1
@@@@ -1100,7 +1100,7 @@@@ main(int argc, char **argv)
@


1.4
log
@Update to ClamAV 0.90.  A lot of improvments and bugfixes, see www.clamav.net
for all details.

ok nikolay
@
text
@d1 3
a3 3
--- clamav-milter/clamav-milter.c.orig	Mon Feb 12 23:36:49 2007
+++ clamav-milter/clamav-milter.c	Wed Feb 14 08:26:32 2007
@@@@ -1064,7 +1064,7 @@@@ main(int argc, char **argv)
d12 1
a12 1
@@@@ -1086,7 +1086,7 @@@@ main(int argc, char **argv)
@


1.4.2.1
log
@MFC:
Update to ClamAV 0.90.1.  Work done mostly by Stuart Henderson, with some
tweaks by myself.
---
Security update to ClamAV 0.90.2.  This containe three import security
fixes:

- ClamAV CAB File Unstore Buffer Overflow Vulnerability
- File descriptor leak in CHM handler
- PDF fd leak

From the original annoucement:

**Important note**: on April 16th CHM, CAB and PDF handlers will be
disabled for 0.90 and 0.90.1 users through the dynamic engine
configuration module (DCONF). Please upgrade to 0.90.2 immediately.
@
text
@d1 3
a3 3
--- clamav-milter/clamav-milter.c.orig	Thu Apr 12 18:35:17 2007
+++ clamav-milter/clamav-milter.c	Fri Apr 13 17:39:49 2007
@@@@ -1078,7 +1078,7 @@@@ main(int argc, char **argv)
d12 1
a12 1
@@@@ -1100,7 +1100,7 @@@@ main(int argc, char **argv)
@


1.4.2.2
log
@MFC:
Update ClamAV to version 0.91.2

work done by ajacoutot@@
@
text
@d1 3
a3 3
--- clamav-milter/clamav-milter.c.orig	Mon Aug 20 23:01:19 2007
+++ clamav-milter/clamav-milter.c	Thu Aug 30 10:52:35 2007
@@@@ -1116,7 +1116,7 @@@@ main(int argc, char **argv)
d12 1
a12 1
@@@@ -1138,7 +1138,7 @@@@ main(int argc, char **argv)
@


1.3
log
@Update to version 0.86.1 and add patches to fix problems on macppc (comparisons
that are always true due to char not being signed on this platform).

This update fixes a possible crash, see
http://sourceforge.net/project/shownotes.php?release_id=337279
for details.
@
text
@d1 3
a3 3
--- clamav-milter/clamav-milter.c.orig	Thu Jun 23 22:03:06 2005
+++ clamav-milter/clamav-milter.c	Wed Jun 29 11:00:23 2005
@@@@ -886,7 +886,7 @@@@ main(int argc, char **argv)
d12 1
a12 1
@@@@ -908,7 +908,7 @@@@ main(int argc, char **argv)
@


1.3.6.1
log
@MFC:
Update to ClamAV 0.90.  A lot of improvments and bugfixes, see www.clamav.net
for all details.
@
text
@d1 3
a3 3
--- clamav-milter/clamav-milter.c.orig	Mon Feb 12 23:36:49 2007
+++ clamav-milter/clamav-milter.c	Fri Mar 16 22:50:28 2007
@@@@ -1064,7 +1064,7 @@@@ main(int argc, char **argv)
d12 1
a12 1
@@@@ -1086,7 +1086,7 @@@@ main(int argc, char **argv)
@


1.3.6.2
log
@MFC:
Update to ClamAV 0.90.1.  Work done mostly by Stuart Henderson, with some
tweaks by myself.
@
text
@d1 3
a3 3
--- clamav-milter/clamav-milter.c.orig	Fri Mar  2 00:27:19 2007
+++ clamav-milter/clamav-milter.c	Mon Apr  2 15:58:03 2007
@@@@ -1078,7 +1078,7 @@@@ main(int argc, char **argv)
d12 1
a12 1
@@@@ -1100,7 +1100,7 @@@@ main(int argc, char **argv)
@


1.3.6.3
log
@MFC:
Update ClamAV to version 0.91.2

work done by ajacoutot@@
@
text
@d1 3
a3 3
--- clamav-milter/clamav-milter.c.orig	Mon Aug 20 23:01:19 2007
+++ clamav-milter/clamav-milter.c	Thu Aug 30 10:52:25 2007
@@@@ -1116,7 +1116,7 @@@@ main(int argc, char **argv)
d12 1
a12 1
@@@@ -1138,7 +1138,7 @@@@ main(int argc, char **argv)
@


1.3.4.1
log
@MFC:
Update to ClamAV 0.90.  A lot of improvments and bugfixes, see www.clamav.net
for all details.
@
text
@d1 3
a3 3
--- clamav-milter/clamav-milter.c.orig	Mon Feb 12 23:36:49 2007
+++ clamav-milter/clamav-milter.c	Fri Mar 16 19:08:37 2007
@@@@ -1064,7 +1064,7 @@@@ main(int argc, char **argv)
d12 1
a12 1
@@@@ -1086,7 +1086,7 @@@@ main(int argc, char **argv)
@


1.3.4.2
log
@MFC:
Update to ClamAV 0.90.1.  Work done mostly by Stuart Henderson, with some
tweaks by myself.
@
text
@d1 3
a3 3
--- clamav-milter/clamav-milter.c.orig	Fri Mar  2 00:27:19 2007
+++ clamav-milter/clamav-milter.c	Wed Mar 28 21:45:23 2007
@@@@ -1078,7 +1078,7 @@@@ main(int argc, char **argv)
d12 1
a12 1
@@@@ -1100,7 +1100,7 @@@@ main(int argc, char **argv)
@


1.2
log
@Update to ClamAV version 0.85
@
text
@d1 3
a3 3
--- clamav-milter/clamav-milter.c.orig	Thu Apr  7 19:50:14 2005
+++ clamav-milter/clamav-milter.c	Sun Apr 10 10:00:25 2005
@@@@ -875,7 +875,7 @@@@ main(int argc, char **argv)
d12 1
a12 1
@@@@ -892,7 +892,7 @@@@ main(int argc, char **argv)
@


1.1
log
@Initial revision
@
text
@d1 3
a3 3
--- clamav-milter/clamav-milter.c.orig	Mon Oct 11 02:59:12 2004
+++ clamav-milter/clamav-milter.c	Tue Dec 21 16:37:12 2004
@@@@ -1138,7 +1138,7 @@@@ main(int argc, char **argv)
d12 1
a12 1
@@@@ -1155,7 +1155,7 @@@@ main(int argc, char **argv)
@


1.1.1.1
log
@Clam Antivirus is a free virus scanner with a command line scanner, a
scanning daemon (clamd), signature update from the net (freshclam), and
a sendmail-milter (clamav-milter).

ok alek@@
@
text
@@
