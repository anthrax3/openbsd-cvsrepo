head	1.1;
access;
symbols
	OPENBSD_6_2:1.1.0.4
	OPENBSD_6_2_BASE:1.1
	OPENBSD_6_1:1.1.0.2
	OPENBSD_6_1_BASE:1.1;
locks; strict;
comment	@# @;


1.1
date	2016.11.29.13.23.18;	author sthen;	state Exp;
branches;
next	;
commitid	HH6oAljz9C2DqUON;


desc
@@


1.1
log
@update to libsrtp-1.5.4, switch to libressl crypto primitives, sprinkle
some arc4random
@
text
@$OpenBSD$
--- crypto/cipher/cipher.c.orig	Fri Jul 31 14:00:17 2015
+++ crypto/cipher/cipher.c	Fri Jul 31 14:00:30 2015
@@@@ -324,7 +324,7 @@@@ cipher_type_test(const cipher_type_t *ct, const cipher
     uint8_t  iv[MAX_KEY_LEN];
 
     /* choose a length at random (leaving room for IV and padding) */
-    length = rand() % (SELF_TEST_BUF_OCTETS - 64);
+    length = arc4random_uniform(SELF_TEST_BUF_OCTETS - 64);
     debug_print(mod_cipher, "random plaintext length %d\n", length);
     status = rand_source_get_octet_string(buffer, length);
     if (status) return status;
@
