head	1.2;
access;
symbols;
locks; strict;
comment	@# @;


1.2
date	2005.01.03.08.06.42;	author jakob;	state dead;
branches;
next	1.1;

1.1
date	2004.12.28.09.31.05;	author jakob;	state Exp;
branches;
next	;


desc
@@


1.2
log
@stunnel 4.07, misc minor fixes
@
text
@$OpenBSD: patch-src_network_c,v 1.1 2004/12/28 09:31:05 jakob Exp $
--- src/network.c.orig	Thu Oct 14 17:03:49 2004
+++ src/network.c	Tue Dec 28 10:29:54 2004
@@@@ -125,7 +125,7 @@@@ int s_poll_wait(s_poll_set *fds, int tim
     int retval;
 
     do { /* skip "Interrupted system call" errors */
-        retval=poll(fds->ufds, fds->nfds, 1000*timeout);
+        retval=poll(fds->ufds, fds->nfds, timeout<0 ? -1 : 1000*timeout);
             /* no timeout -> main loop */
         if(timeout<0 && retval>0 && s_poll_canread(fds, signal_pipe[0]))
             signal_pipe_empty();
@


1.1
log
@poll patch from author
@
text
@d1 1
a1 1
$OpenBSD$
@

