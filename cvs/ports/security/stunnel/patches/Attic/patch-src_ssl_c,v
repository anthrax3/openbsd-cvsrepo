head	1.3;
access;
symbols
	OPENBSD_5_8:1.2.0.4
	OPENBSD_5_8_BASE:1.2
	OPENBSD_5_7:1.1.0.4
	OPENBSD_5_7_BASE:1.1
	OPENBSD_5_6:1.1.0.2
	OPENBSD_5_6_BASE:1.1;
locks; strict;
comment	@# @;


1.3
date	2015.10.14.02.05.06;	author gsoares;	state dead;
branches;
next	1.2;
commitid	gPubP3Dxu5GSVcMn;

1.2
date	2015.06.25.14.44.30;	author gsoares;	state Exp;
branches;
next	1.1;
commitid	AXFYLLYdz3t8Z0uo;

1.1
date	2014.04.19.12.29.02;	author sthen;	state Exp;
branches;
next	;


desc
@@


1.3
log
@*** empty log message ***
@
text
@$OpenBSD: patch-src_ssl_c,v 1.2 2015/06/25 14:44:30 gsoares Exp $
--- src/ssl.c.orig	Tue Jun 16 10:16:35 2015
+++ src/ssl.c	Mon Jun 22 01:56:51 2015
@@@@ -201,18 +201,6 @@@@ NOEXPORT int prng_init(GLOBAL_OPTIONS *global) {
     }
     s_log(LOG_DEBUG, "RAND_screen failed to sufficiently seed PRNG");
 #else
-    if(global->egd_sock) {
-        if((bytes=RAND_egd(global->egd_sock))==-1) {
-            s_log(LOG_WARNING, "EGD Socket %s failed", global->egd_sock);
-            bytes=0;
-        } else {
-            totbytes+=bytes;
-            s_log(LOG_DEBUG, "Snagged %d random bytes from EGD Socket %s",
-                bytes, global->egd_sock);
-            return 0; /* OpenSSL always gets what it needs or fails,
-                         so no need to check if seeded sufficiently */
-        }
-    }
     /* try the good-old default /dev/urandom, if available  */
     totbytes+=add_rand_file(global, "/dev/urandom");
     if(RAND_status())
@


1.2
log
@- update to 3.19;
- switch threading model to pthread since that it is the default process model in stunnel;
- fix stunnel.pem path in pkg/MESSAGE;
- add patches to make it build with libressl;
- fix some hardcoding paths in tools/stunnel.conf-sample.in.

Tweaks and Feedback:
jca@@ yasuoka@@ jasper@@ brad@@ and Markus Lude, thanks !

tested by yasuoka@@ and Markus Lude on @@sparc64(markus's tests against 3.18 version, but no many changes to 3.19, assuming that should work too...)...

full changelog at:
https://www.stunnel.org/sdf_ChangeLog.html
@
text
@d1 1
a1 1
$OpenBSD: patch-src_ssl_c,v 1.1 2014/04/19 12:29:02 sthen Exp $
@


1.1
log
@we don't have RAND_egd
@
text
@d1 4
a4 4
$OpenBSD$
--- src/ssl.c.orig	Sat Apr 19 06:26:38 2014
+++ src/ssl.c	Sat Apr 19 06:28:18 2014
@@@@ -195,18 +195,6 @@@@ NOEXPORT int init_prng(GLOBAL_OPTIONS *global) {
@

