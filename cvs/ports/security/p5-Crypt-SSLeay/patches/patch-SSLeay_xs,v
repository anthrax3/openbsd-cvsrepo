head	1.1;
access;
symbols
	OPENBSD_6_1:1.1.0.6
	OPENBSD_6_1_BASE:1.1
	OPENBSD_6_0:1.1.0.4
	OPENBSD_6_0_BASE:1.1
	OPENBSD_5_9:1.1.0.2
	OPENBSD_5_9_BASE:1.1;
locks; strict;
comment	@# @;


1.1
date	2015.08.31.06.58.45;	author bluhm;	state Exp;
branches;
next	;
commitid	esdFsjBtQBP8U813;


desc
@@


1.1
log
@In p5-Crypt-SSLeay remove all calls to SSLv2 and SSLv3 and keep only SSLv23.
OK jca@@
@
text
@$OpenBSD$
--- SSLeay.xs.orig	Thu Apr 24 00:36:24 2014
+++ SSLeay.xs	Mon Aug 31 00:43:25 2015
@@@@ -45,13 +45,6 @@@@ extern "C" {
 }
 #endif
 
-
-#if SSLEAY_VERSION_NUMBER >= 0x0900
-#define CRYPT_SSL_CLIENT_METHOD SSLv3_client_method()
-#else
-#define CRYPT_SSL_CLIENT_METHOD SSLv2_client_method()
-#endif
-
 static void InfoCallback(const SSL *s,int where,int ret)
     {
     const char *str;
@@@@ -145,22 +138,7 @@@@ SSL_CTX_new(packname, ssl_version)
             RAND_seed(buf, CRYPT_SSLEAY_RAND_BUFSIZE);
         }
 
-        if(ssl_version == 23) {
-            ctx = SSL_CTX_new(SSLv23_client_method());
-        }
-        else if(ssl_version == 3) {
-            ctx = SSL_CTX_new(SSLv3_client_method());
-        }
-        else {
-#ifndef OPENSSL_NO_SSL2
-            /* v2 is the default */
-            ctx = SSL_CTX_new(SSLv2_client_method());
-#else
-            /* v3 is the default */
-            ctx = SSL_CTX_new(SSLv3_client_method());
-#endif
-        }
-
+        ctx = SSL_CTX_new(SSLv23_client_method());
         SSL_CTX_set_options(ctx,SSL_OP_ALL|0);
         SSL_CTX_set_default_verify_paths(ctx);
         SSL_CTX_set_verify(ctx, SSL_VERIFY_NONE, NULL);
@
