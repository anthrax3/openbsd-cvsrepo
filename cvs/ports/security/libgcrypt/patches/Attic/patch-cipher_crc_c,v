head	1.4;
access;
symbols;
locks; strict;
comment	@# @;


1.4
date	2016.06.15.21.21.21;	author ajacoutot;	state dead;
branches;
next	1.3;
commitid	VpQvKcD7kKH2TQTl;

1.3
date	2016.06.11.15.56.02;	author jca;	state Exp;
branches;
next	1.2;
commitid	S5qLYIfmwdVUZznA;

1.2
date	2016.05.08.23.21.29;	author jca;	state Exp;
branches;
next	1.1;
commitid	x5u6L7Mcx6joGMbW;

1.1
date	2016.05.08.23.13.20;	author jca;	state Exp;
branches;
next	;
commitid	6lHQXOtHZ4msPfvk;


desc
@@


1.4
log
@Update to libgcrypt-1.7.1.
@
text
@$OpenBSD: patch-cipher_crc_c,v 1.3 2016/06/11 15:56:02 jca Exp $

disable plcmul (actually SSE4.1) for CRC, asm instructions unknown to base gcc
  "crc-intel-pclmul.c:369: Error: no such instruction: `pextrd $1,%xmm0,(%rdi)'"
  Committed upstream:
  http://git.gnupg.org/cgi-bin/gitweb.cgi?p=libgcrypt.git;a=commitdiff;h=3e8074ecd3a534e8bd7f11cf17f0b22d252584c8

--- cipher/crc.c.orig	Sun May  8 18:58:27 2016
+++ cipher/crc.c	Sun May  8 18:58:46 2016
@@@@ -34,7 +34,7 @@@@
 /* USE_INTEL_PCLMUL indicates whether to compile CRC with Intel PCLMUL
  * code.  */
 #undef USE_INTEL_PCLMUL
-#ifdef ENABLE_PCLMUL_SUPPORT
+#if 0
 # if ((defined(__i386__) && SIZEOF_UNSIGNED_LONG == 4) || defined(__x86_64__))
 #  if __GNUC__ >= 4
 #   define USE_INTEL_PCLMUL 1
@


1.3
log
@Committed upstream.
@
text
@d1 1
a1 1
$OpenBSD: patch-cipher_crc_c,v 1.2 2016/05/08 23:21:29 jca Exp $
@


1.2
log
@Re-add the error message that motivated those patches

  crc-intel-pclmul.c:369: Error: no such instruction: `pextrd $1,%xmm0,(%rdi)'
@
text
@d1 1
a1 1
$OpenBSD: patch-cipher_crc_c,v 1.1 2016/05/08 23:13:20 jca Exp $
d5 2
@


1.1
log
@Drop use of pclmul/SSE4.1 for CRC, and the use of clang while here

While this bring a nice speed improvement over libgcrypt-1.6.5, it
requires newer gcc or clang.  Since libgcrypt is a requirement for
tons of ports, using clang here means that you end up building two huge
compilers before building anything useful.

pclmul alone is supported by base gcc and is still used for GCM.

ok ajacoutot@@ (maintainer)
@
text
@d1 1
a1 1
$OpenBSD$
d4 1
@

