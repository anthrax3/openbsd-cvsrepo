head	1.3;
access;
symbols
	OPENBSD_6_0:1.3.0.6
	OPENBSD_6_0_BASE:1.3
	OPENBSD_5_9:1.3.0.2
	OPENBSD_5_9_BASE:1.3
	OPENBSD_5_8:1.3.0.4
	OPENBSD_5_8_BASE:1.3
	OPENBSD_4_3:1.1.0.2
	OPENBSD_4_3_BASE:1.1;
locks; strict;
comment	@# @;


1.3
date	2015.04.04.15.08.39;	author stsp;	state Exp;
branches;
next	1.2;
commitid	RMokB0oJ4kiDymne;

1.2
date	2008.03.23.02.41.06;	author fgsch;	state dead;
branches;
next	1.1;

1.1
date	2007.12.05.21.43.54;	author fgsch;	state Exp;
branches;
next	;


desc
@@


1.3
log
@Update to pidgin-otr-4.0.1 and fix a use-after-free bug which
prevented the socialist millionaire dialog from opening.
ok landry
@
text
@$OpenBSD$
Don't use smp_data after free.
--- gtk-dialog.c.orig	Fri Apr  3 12:29:01 2015
+++ gtk-dialog.c	Fri Apr  3 12:28:13 2015
@@@@ -778,6 +778,7 @@@@ static GtkWidget *create_smp_dialog(const char *title,
     if (smp_data->their_instance != context->their_instance) {
 	otrg_gtk_dialog_free_smp_data(conv);
 	otrg_gtk_dialog_add_smp_data(conv);
+    	smp_data = purple_conversation_get_data(conv, "otr-smpdata");
     }
 
     if (!(smp_data->smp_secret_dialog)) {
@


1.2
log
@remove patch not needed anymore. ok okan@@ some time ago.
@
text
@d1 10
a10 6
$OpenBSD: patch-gtk-dialog_c,v 1.1 2007/12/05 21:43:54 fgsch Exp $
--- gtk-dialog.c.orig	Mon Dec  3 05:18:32 2007
+++ gtk-dialog.c	Mon Dec  3 05:19:11 2007
@@@@ -2016,6 +2016,9 @@@@ static void otrg_gtk_dialog_new_conv(PurpleConversatio
     GtkWidget *menusmp;
     GtkWidget *whatsthis;
d12 1
a12 6
+    if (!gtkconv)
+        return;
+
     /* Do nothing if this isn't an IM conversation */
     if (purple_conversation_get_type(conv) != PURPLE_CONV_TYPE_IM) return;
     bbox = gtkconv->lower_hbox;
@


1.1
log
@fix crash when the ui is hidden.  okan@@ ok
@
text
@d1 1
a1 1
$OpenBSD$
@

