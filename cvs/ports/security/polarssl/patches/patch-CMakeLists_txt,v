head	1.4;
access;
symbols
	OPENBSD_6_0:1.4.0.4
	OPENBSD_6_0_BASE:1.4
	OPENBSD_5_9:1.4.0.2
	OPENBSD_5_9_BASE:1.4
	OPENBSD_5_8:1.3.0.6
	OPENBSD_5_8_BASE:1.3
	OPENBSD_5_7:1.3.0.2
	OPENBSD_5_7_BASE:1.3;
locks; strict;
comment	@# @;


1.4
date	2015.09.12.20.30.00;	author sthen;	state Exp;
branches;
next	1.3;
commitid	XubPgH8RfbhKlZtD;

1.3
date	2015.02.10.12.21.55;	author sthen;	state Exp;
branches;
next	1.2;
commitid	ZURX9cXzWP59htLz;

1.2
date	2014.11.05.09.40.05;	author dcoppa;	state Exp;
branches;
next	1.1;
commitid	hPIQh5vWIbq3WeXJ;

1.1
date	2014.11.04.19.45.41;	author sthen;	state Exp;
branches;
next	;
commitid	IvPgSxLZQ8w7Q0av;


desc
@@


1.4
log
@update to polarssl/mbedtls-2.1.0
@
text
@$OpenBSD: patch-CMakeLists_txt,v 1.3 2015/02/10 12:21:55 sthen Exp $
--- CMakeLists.txt.orig	Fri Sep  4 13:38:26 2015
+++ CMakeLists.txt	Tue Sep  8 20:19:54 2015
@@@@ -32,7 +32,6 @@@@ if(CMAKE_COMPILER_IS_GNUCC)
     if (GCC_VERSION VERSION_GREATER 4.8 OR GCC_VERSION VERSION_EQUAL 4.8)
         set(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -Wshadow")
     endif()
-    set(CMAKE_C_FLAGS_RELEASE     "-O2")
     set(CMAKE_C_FLAGS_DEBUG       "-O0 -g3")
     set(CMAKE_C_FLAGS_COVERAGE    "-O0 -g3 --coverage")
     set(CMAKE_C_FLAGS_ASAN        "-Werror -fsanitize=address -fno-common -O3")
@@@@ -43,7 +42,6 @@@@ endif(CMAKE_COMPILER_IS_GNUCC)
 
 if(CMAKE_COMPILER_IS_CLANG)
     set(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -Wall -Wextra -W -Wdeclaration-after-statement -Wwrite-strings -Wpointer-arith -Wimplicit-fallthrough -Wshadow")
-    set(CMAKE_C_FLAGS_RELEASE     "-O2")
     set(CMAKE_C_FLAGS_DEBUG       "-O0 -g3")
     set(CMAKE_C_FLAGS_COVERAGE    "-O0 -g3 --coverage")
     set(CMAKE_C_FLAGS_ASAN        "-Werror -fsanitize=address -fno-common -fsanitize=undefined -fno-sanitize-recover -O3")
@


1.3
log
@Update to mbedtls 1.3.10 (the name changed). This version is still under GPL
but a forthcoming version moves to the Apache license.
@
text
@d1 12
a12 14
$OpenBSD$
--- CMakeLists.txt.orig	Mon Feb  9 10:21:24 2015
+++ CMakeLists.txt	Mon Feb  9 10:22:44 2015
@@@@ -4,8 +4,7 @@@@ project(MBEDTLS C)
 string(REGEX MATCH "Clang" CMAKE_COMPILER_IS_CLANG "${CMAKE_C_COMPILER_ID}")
 
 if(CMAKE_COMPILER_IS_GNUCC)
-  set(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -Wall -Wextra -W -Wdeclaration-after-statement -Wwrite-strings -Wlogical-op")
-  set(CMAKE_C_FLAGS_RELEASE     "-O2")
+  set(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -Wall -Wextra -W -Wdeclaration-after-statement -Wwrite-strings")
   set(CMAKE_C_FLAGS_DEBUG       "-O0 -g3")
   set(CMAKE_C_FLAGS_COVERAGE    "-O0 -g3 --coverage")
   set(CMAKE_C_FLAGS_ASAN        "-Werror -fsanitize=address -fno-common -O3")
@@@@ -16,7 +15,6 @@@@ endif(CMAKE_COMPILER_IS_GNUCC)
d15 5
a19 5
   set(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -Wall -Wextra -W -Wdeclaration-after-statement -Wwrite-strings -Wpointer-arith")
-  set(CMAKE_C_FLAGS_RELEASE     "-O2")
   set(CMAKE_C_FLAGS_DEBUG       "-O0 -g3")
   set(CMAKE_C_FLAGS_COVERAGE    "-O0 -g3 --coverage")
   set(CMAKE_C_FLAGS_ASAN        "-Werror -fsanitize=address -fno-common -fsanitize=undefined -fno-sanitize-recover -O3")
@


1.2
log
@
Respect our CFLAGS and remove default optimizations
@
text
@d1 4
a4 4
$OpenBSD: patch-CMakeLists_txt,v 1.1 2014/11/04 19:45:41 sthen Exp $
--- CMakeLists.txt.orig	Mon Oct 20 13:59:19 2014
+++ CMakeLists.txt	Wed Nov  5 10:34:29 2014
@@@@ -4,8 +4,7 @@@@ project(POLARSSL C)
d8 2
a9 2
-  set(CMAKE_C_FLAGS "-Wall -Wextra -W -Wdeclaration-after-statement -Wlogical-op -Wwrite-strings")
-  set(CMAKE_C_FLAGS_RELEASE "-O2")
d11 4
a14 4
   set(CMAKE_C_FLAGS_DEBUG "-g3 -O0")
   set(CMAKE_C_FLAGS_COVERAGE "-g3 -O0 --coverage")
   set(CMAKE_C_FLAGS_ASAN "-fsanitize=address -fno-omit-frame-pointer -g3 -O1 -Werror")
@@@@ -15,7 +14,6 @@@@ endif(CMAKE_COMPILER_IS_GNUCC)
d17 5
a21 5
   set(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -Wall -Wextra -W -Wdeclaration-after-statement -Wpointer-arith -Wwrite-strings -Wdocumentation -Wunreachable-code")
-  set(CMAKE_C_FLAGS_RELEASE "-O2")
   set(CMAKE_C_FLAGS_DEBUG "-g3 -O0")
   set(CMAKE_C_FLAGS_COVERAGE "-g3 -O0 --coverage")
   set(CMAKE_C_FLAGS_ASAN "-fsanitize=address -fno-omit-frame-pointer -g3 -O1 -Werror")
@


1.1
log
@update to polarssl 1.3.9, security fixes (but note that nothing in the ports
tree currently uses this library)

   * Lowest common hash was selected from signature_algorithms extension in
     TLS 1.2 (found by Darren Bane) (introduced in 1.3.8).
   * Remotely-triggerable memory leak when parsing some X.509 certificates
     (server is not affected if it doesn't ask for a client certificate)
     (found using Codenomicon Defensics).
   * Remotely-triggerable memory leak when parsing crafted ClientHello
     (not affected if ECC support was compiled out) (found using Codenomicon
     Defensics).
@
text
@d1 4
a4 4
$OpenBSD$
--- CMakeLists.txt.orig	Tue Nov  4 12:10:46 2014
+++ CMakeLists.txt	Tue Nov  4 12:11:05 2014
@@@@ -4,7 +4,7 @@@@ project(POLARSSL C)
d9 2
a10 2
+  set(CMAKE_C_FLAGS "-Wall -Wextra -W -Wdeclaration-after-statement -Wwrite-strings")
   set(CMAKE_C_FLAGS_RELEASE "-O2")
d13 9
@

