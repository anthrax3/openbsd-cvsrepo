head	1.45;
access;
symbols
	OPENBSD_6_2:1.45.0.6
	OPENBSD_6_2_BASE:1.45
	OPENBSD_6_1:1.45.0.4
	OPENBSD_6_1_BASE:1.45
	OPENBSD_6_0:1.45.0.2
	OPENBSD_6_0_BASE:1.45
	OPENBSD_5_9:1.41.0.2
	OPENBSD_5_9_BASE:1.41
	OPENBSD_5_8:1.41.0.4
	OPENBSD_5_8_BASE:1.41
	OPENBSD_5_7:1.39.0.2
	OPENBSD_5_7_BASE:1.39
	OPENBSD_5_6:1.29.0.2
	OPENBSD_5_6_BASE:1.29
	OPENBSD_5_5:1.28.0.2
	OPENBSD_5_5_BASE:1.28
	OPENBSD_5_4:1.24.0.2
	OPENBSD_5_4_BASE:1.24
	OPENBSD_5_3:1.14.0.2
	OPENBSD_5_3_BASE:1.14
	OPENBSD_5_2:1.11.0.2
	OPENBSD_5_2_BASE:1.11
	OPENBSD_5_1_BASE:1.9
	OPENBSD_5_1:1.9.0.2
	ajacoutot_20110822:1.1.1.1
	ajacoutot:1.1.1;
locks; strict;
comment	@# @;


1.45
date	2016.04.08.11.16.15;	author naddy;	state Exp;
branches;
next	1.44;
commitid	n544QackrPmkj7JP;

1.44
date	2016.03.18.21.38.25;	author naddy;	state Exp;
branches;
next	1.43;
commitid	BVkebQSTXSZokeRG;

1.43
date	2016.03.11.20.28.31;	author naddy;	state Exp;
branches;
next	1.42;
commitid	UYLP8TE6V7RS2GhJ;

1.42
date	2016.03.06.12.16.26;	author ajacoutot;	state Exp;
branches;
next	1.41;
commitid	y2Wsex20IkpSey1y;

1.41
date	2015.05.02.10.25.47;	author ajacoutot;	state Exp;
branches;
next	1.40;
commitid	oFMaAIAedvfce2AS;

1.40
date	2015.03.22.07.39.48;	author ajacoutot;	state Exp;
branches;
next	1.39;
commitid	sfdhJhG3kY1leYL3;

1.39
date	2014.10.12.06.16.19;	author ajacoutot;	state Exp;
branches;
next	1.38;
commitid	wvKgw28gBxY2eI4f;

1.38
date	2014.10.06.06.34.38;	author ajacoutot;	state Exp;
branches;
next	1.37;
commitid	Uve4kN4YdIii3jQP;

1.37
date	2014.10.04.16.46.10;	author ajacoutot;	state Exp;
branches;
next	1.36;
commitid	TuFek3yWuLOeKqVy;

1.36
date	2014.09.19.06.20.10;	author ajacoutot;	state Exp;
branches;
next	1.35;
commitid	KPDasPUe58tBl8aM;

1.35
date	2014.09.13.16.36.54;	author ajacoutot;	state Exp;
branches;
next	1.34;
commitid	N2TalFGi4jKRwS2u;

1.34
date	2014.09.10.06.10.31;	author ajacoutot;	state Exp;
branches;
next	1.33;
commitid	u2E25paorxDAI3dH;

1.33
date	2014.09.06.07.21.05;	author ajacoutot;	state Exp;
branches;
next	1.32;
commitid	CupBWEeJjDmTv0Bg;

1.32
date	2014.09.05.14.45.02;	author jasper;	state Exp;
branches;
next	1.31;
commitid	f4VbjcUvEOJXzzBc;

1.31
date	2014.09.03.09.55.19;	author ajacoutot;	state Exp;
branches;
next	1.30;
commitid	1sn9eK18AOFvIZI1;

1.30
date	2014.08.21.10.38.27;	author ajacoutot;	state Exp;
branches;
next	1.29;
commitid	Kd7kxEpMd88KLEh5;

1.29
date	2014.07.06.09.21.32;	author ajacoutot;	state Exp;
branches;
next	1.28;
commitid	WcxVxsUCglUJEVWR;

1.28
date	2014.01.27.17.57.32;	author ajacoutot;	state Exp;
branches;
next	1.27;

1.27
date	2013.09.24.08.06.56;	author ajacoutot;	state Exp;
branches;
next	1.26;

1.26
date	2013.09.06.16.27.21;	author ajacoutot;	state Exp;
branches;
next	1.25;

1.25
date	2013.08.06.19.07.00;	author ajacoutot;	state Exp;
branches;
next	1.24;

1.24
date	2013.06.28.12.36.31;	author espie;	state Exp;
branches;
next	1.23;

1.23
date	2013.06.09.14.30.11;	author ajacoutot;	state Exp;
branches;
next	1.22;

1.22
date	2013.05.21.16.29.30;	author ajacoutot;	state Exp;
branches;
next	1.21;

1.21
date	2013.05.07.06.38.59;	author ajacoutot;	state Exp;
branches;
next	1.20;

1.20
date	2013.03.21.08.48.53;	author ajacoutot;	state Exp;
branches;
next	1.19;

1.19
date	2013.03.19.16.07.49;	author ajacoutot;	state Exp;
branches;
next	1.18;

1.18
date	2013.03.14.20.08.14;	author ajacoutot;	state Exp;
branches;
next	1.17;

1.17
date	2013.03.11.11.41.26;	author espie;	state Exp;
branches;
next	1.16;

1.16
date	2013.03.05.09.53.20;	author ajacoutot;	state Exp;
branches;
next	1.15;

1.15
date	2013.03.02.13.55.56;	author ajacoutot;	state Exp;
branches;
next	1.14;

1.14
date	2012.09.27.09.30.06;	author ajacoutot;	state Exp;
branches;
next	1.13;

1.13
date	2012.09.21.14.48.06;	author ajacoutot;	state Exp;
branches;
next	1.12;

1.12
date	2012.08.19.11.10.43;	author ajacoutot;	state Exp;
branches;
next	1.11;

1.11
date	2012.03.23.13.22.38;	author ajacoutot;	state Exp;
branches;
next	1.10;

1.10
date	2012.02.19.19.08.37;	author ajacoutot;	state Exp;
branches;
next	1.9;

1.9
date	2012.01.24.09.46.04;	author ajacoutot;	state Exp;
branches;
next	1.8;

1.8
date	2011.11.24.15.01.26;	author ajacoutot;	state Exp;
branches;
next	1.7;

1.7
date	2011.10.22.22.48.33;	author ajacoutot;	state Exp;
branches;
next	1.6;

1.6
date	2011.09.18.21.38.42;	author ajacoutot;	state Exp;
branches;
next	1.5;

1.5
date	2011.09.18.15.45.18;	author ajacoutot;	state Exp;
branches;
next	1.4;

1.4
date	2011.09.18.12.13.41;	author ajacoutot;	state Exp;
branches;
next	1.3;

1.3
date	2011.09.18.12.02.33;	author ajacoutot;	state Exp;
branches;
next	1.2;

1.2
date	2011.08.28.13.46.51;	author naddy;	state Exp;
branches;
next	1.1;

1.1
date	2011.08.22.08.04.14;	author ajacoutot;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2011.08.22.08.04.14;	author ajacoutot;	state Exp;
branches;
next	;


desc
@@


1.45
log
@Replace gettext module with ordinary dependency.
Fix the gnutls tests without requiring gsed.
ok ajacoutot@@
@
text
@# $OpenBSD: Makefile,v 1.44 2016/03/18 21:38:25 naddy Exp $

PORTROACH=	limitw:1,even

COMMENT=	library for loading and enumurating of PKCS\#11 modules

DISTNAME=	p11-kit-0.23.2
REVISION=	0

CATEGORIES=	security

SHARED_LIBS +=  p11-kit              2.0      # 1.0

HOMEPAGE=	http://p11-glue.freedesktop.org/

MAINTAINER=	Antoine Jacoutot <ajacoutot@@openbsd.org>

# BSD-like
PERMIT_PACKAGE_CDROM=	Yes

WANTLIB += c ffi iconv intl pthread tasn1

MASTER_SITES=	${HOMEPAGE}releases/

LIB_DEPENDS=	devel/gettext \
		devel/libffi \
		security/libtasn1

CONFIGURE_STYLE=gnu
CONFIGURE_ENV=	CPPFLAGS="-I${LOCALBASE}/include" \
		LDFLAGS="-L${LOCALBASE}/lib"
CONFIGURE_ARGS=	--with-module-path=${PREFIX}/lib/pkcs11 \
		--with-trust-paths=/etc/ssl/cert.pem

# no translation yet
CONFIGURE_ARGS += --disable-nls

FAKE_FLAGS=	exampledir=${PREFIX}/share/examples/p11-kit/pkcs11

post-install:
# see the install-exec-hook target in p11-kit/Makefile.am
	ln -sf libp11-kit.so.${LIBp11-kit_VERSION} ${PREFIX}/lib/p11-kit-proxy.so
	rm ${PREFIX}/lib/pkcs11/*.{a,la}

.include <bsd.port.mk>
@


1.44
log
@remove SHARED_ONLY from simple ports that use the gettext or libiconv module
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2016/03/11 20:28:31 naddy Exp $
d8 1
d21 1
a21 1
WANTLIB += c ffi pthread tasn1
d25 2
a26 3
MODULES=	devel/gettext

LIB_DEPENDS=	devel/libffi \
@


1.43
log
@garbage collect CONFIGURE_SHARED
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2016/03/06 12:16:26 ajacoutot Exp $
a3 2

SHARED_ONLY=	Yes
@


1.42
log
@Update to p11-kit-0.23.2.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2015/05/02 10:25:47 ajacoutot Exp $
d34 1
a34 2
CONFIGURE_ARGS=	${CONFIGURE_SHARED} \
		--with-module-path=${PREFIX}/lib/pkcs11 \
@


1.41
log
@Fix a couple of implicit declarations.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2015/03/22 07:39:48 ajacoutot Exp $
d9 1
a9 2
DISTNAME=	p11-kit-0.22.1
REVISION=	1
d13 1
a13 1
SHARED_LIBS +=  p11-kit              1.2      # 0.0
@


1.40
log
@Add missing symlink to p11-kit-proxy.so.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2014/10/12 06:16:19 ajacoutot Exp $
d10 1
a10 1
REVISION=	0
@


1.39
log
@Update to p11-kit-0.22.1.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2014/10/06 06:34:38 ajacoutot Exp $
d10 1
d45 2
@


1.38
log
@Sync with what was committed upstream.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2014/10/04 16:46:10 ajacoutot Exp $
d9 1
a9 2
DISTNAME=	p11-kit-0.22.0
REVISION=	0
@


1.37
log
@Update to p11-kit-0.22.0.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2014/09/19 06:20:10 ajacoutot Exp $
d4 2
a5 1
SHARED_ONLY =	Yes
d10 1
@


1.36
log
@Update to p11-kit-0.20.7.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2014/09/13 16:36:54 ajacoutot Exp $
d8 1
a8 1
DISTNAME=	p11-kit-0.20.7
d12 1
a12 1
SHARED_LIBS +=  p11-kit              1.1      # 0.0
@


1.35
log
@--disable-gtk-doc is handled by the infrastructure now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2014/09/10 06:10:31 ajacoutot Exp $
d8 1
a8 1
DISTNAME=	p11-kit-0.20.6
d12 1
a12 1
SHARED_LIBS +=  p11-kit              1.0      # 0.0
@


1.34
log
@Update to p11-kit-0.20.6.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2014/09/06 07:21:05 ajacoutot Exp $
a33 1
		--disable-gtk-doc \
a38 6

# If one of these tools is found at configure stage, it might be used,
# no matter whether we use --disable-gtk-doc or not.
CONFIGURE_ENV +=ac_cv_path_GTKDOC_CHECK="" \
		ac_cv_path_GTKDOC_REBASE="" \
		ac_cv_path_GTKDOC_MKPDF=""
@


1.33
log
@Update to p11-kit-0.20.5.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2014/09/05 14:45:02 jasper Exp $
d8 1
a8 1
DISTNAME=	p11-kit-0.20.5
d34 1
d40 6
@


1.32
log
@PORTSCOUT -> PORTROACH
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2014/09/03 09:55:19 ajacoutot Exp $
d8 1
a8 1
DISTNAME=	p11-kit-0.20.4
@


1.31
log
@Add PORTSCOUT entries.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2014/08/21 10:38:27 ajacoutot Exp $
d3 1
a3 1
PORTSCOUT=	limitw:1,even
@


1.30
log
@Update to p11-kit-0.20.4.
@
text
@d1 4
a4 1
# $OpenBSD: Makefile,v 1.29 2014/07/06 09:21:32 ajacoutot Exp $
a6 1
SHARED_ONLY =	Yes
@


1.29
log
@Update to p11-kit-0.20.3.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2014/01/27 17:57:32 ajacoutot Exp $
d6 1
a6 1
DISTNAME=	p11-kit-0.20.3
@


1.28
log
@Update to p11-kit-0.20.2.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2013/09/24 08:06:56 ajacoutot Exp $
d6 1
a6 1
DISTNAME=	p11-kit-0.20.2
@


1.27
log
@Update to p11-kit-0.20.1.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2013/09/06 16:27:21 ajacoutot Exp $
d6 1
a6 1
DISTNAME=	p11-kit-0.20.1
@


1.26
log
@Update to p11-kit-0.20.0.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2013/08/06 19:07:00 ajacoutot Exp $
d6 1
a6 1
DISTNAME=	p11-kit-0.20.0
@


1.25
log
@Update to p11-kit 0.18.5.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2013/06/28 12:36:31 espie Exp $
d6 1
a6 1
DISTNAME=	p11-kit-0.18.5
d10 1
a10 1
SHARED_LIBS +=  p11-kit              0.1      # 0.0
d19 1
a19 1
WANTLIB += c pthread tasn1
d25 2
a26 1
LIB_DEPENDS=	security/libtasn1
@


1.24
log
@configure from the tool itself says:
configure: error: p11-kit cannot be used as a static library

so don't waste time
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2013/06/09 14:30:11 ajacoutot Exp $
d6 1
a6 2
DISTNAME=	p11-kit-0.18.3
REVISION =	0
@


1.23
log
@Update to p11-kit-0.18.3.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2013/05/21 16:29:30 ajacoutot Exp $
d4 1
d7 1
@


1.22
log
@Update to p11-kit-0.18.2.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2013/05/07 06:38:59 ajacoutot Exp $
d5 1
a5 1
DISTNAME=	p11-kit-0.18.2
@


1.21
log
@Update to p11-kit-0.18.1.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2013/03/21 08:48:53 ajacoutot Exp $
d5 1
a5 1
DISTNAME=	p11-kit-0.18.1
@


1.20
log
@USE_LIBTOOL=Yes is the default now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2013/03/19 16:07:49 ajacoutot Exp $
d5 1
a5 2
DISTNAME=	p11-kit-0.16.4
REVISION=	0
d9 1
a9 1
SHARED_LIBS +=  p11-kit              0.0      # 0.0
d22 2
a25 1

d27 2
d31 1
a31 1
		--with-system-anchors=/etc/ssl/cert.pem
@


1.19
log
@Fix a segfault when parsing certificates.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2013/03/14 20:08:14 ajacoutot Exp $
a24 1
USE_LIBTOOL=	Yes
@


1.18
log
@Update to p11-kit-0.16.4.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2013/03/11 11:41:26 espie Exp $
d6 1
a28 1
		--disable-gtk-doc \
a33 6

# If one of these tools is found at configure stage, it might be used,
# no matter whether we use --disable-gtk-doc or not.
CONFIGURE_ENV +=ac_cv_path_GTKDOC_CHECK="" \
		ac_cv_path_GTKDOC_REBASE="" \
		ac_cv_path_GTKDOC_MKPDF=""
@


1.17
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2013/03/05 09:53:20 ajacoutot Exp $
d5 1
a5 1
DISTNAME=	p11-kit-0.16.0
@


1.16
log
@Update to p11-kit-0.16.0.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2013/03/02 13:55:56 ajacoutot Exp $
a16 3
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM= Yes
PERMIT_DISTFILES_FTP=	Yes
@


1.15
log
@No need to @@sample pkcs11.conf.example.

spotted by sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2012/09/27 09:30:06 ajacoutot Exp $
d5 1
a5 2
DISTNAME=	p11-kit-0.14
REVISION=	0
d21 1
a21 1
WANTLIB += c pthread
d25 2
d32 2
a33 1
		--with-module-path=${PREFIX}/lib/pkcs11
d45 3
@


1.14
log
@Update to p11-kit-0.14.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2012/09/21 14:48:06 ajacoutot Exp $
d6 1
@


1.13
log
@Stupid autohell is stupid...
The situation is this: even when we --disable-gtk-doc, if gtk-doc is
actually installed at configure stage, tools like gtkdoc-rebase will be
picked up and run during the install target. That is bad because the
gtk-doc package may have been removed by then, especially during dpb(1)
bulks (we explicitely disable support for it so why should it stay...).

So for now, let's add the following env to configure whenever we use
--disable-gtk-doc, until a bettersolution is found...
CONFIGURE_ENV +=ac_cv_path_GTKDOC_CHECK="" \
		ac_cv_path_GTKDOC_REBASE="" \
		ac_cv_path_GTKDOC_MKPDF=""
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2012/08/19 11:10:43 ajacoutot Exp $
d5 1
a5 1
DISTNAME=	p11-kit-0.13
a41 14

### https://bugs.freedesktop.org/show_bug.cgi?id=53706 ###
AUTOCONF_VERSION=	2.68
AUTOMAKE_VERSION=	1.11
BUILD_DEPENDS +=	devel/autoconf/${AUTOCONF_VERSION} \
			devel/automake/${AUTOMAKE_VERSION} \
			devel/libtool

pre-configure:
	@@cd ${WRKSRC} && \
		AUTOCONF_VERSION=${AUTOCONF_VERSION} \
		AUTOMAKE_VERSION=${AUTOMAKE_VERSION} \
		autoreconf -i
######
@


1.12
log
@Bugfix update to p11-kit-0.13.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2012/03/23 13:22:38 ajacoutot Exp $
d34 6
@


1.11
log
@Update to p11-kit-0.12.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2012/02/19 19:08:37 ajacoutot Exp $
d5 1
a5 1
DISTNAME=	p11-kit-0.12
d35 1
a35 2
# some warning options not available with gcc < 4
CONFIGURE_ARGS += --disable-more-warnings
d37 6
a42 1
FAKE_FLAGS=	exampledir=${PREFIX}/share/examples/p11-kit/pkcs11
d45 5
a49 1
	perl -pi -e 's,-lpthread,-pthread,g' ${WRKSRC}/configure
@


1.10
log
@Update to p11-kit-0.11.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2012/01/24 09:46:04 ajacoutot Exp $
d5 1
a5 1
DISTNAME=	p11-kit-0.11
@


1.9
log
@Minor update to p11-kit-0.10.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2011/11/24 15:01:26 ajacoutot Exp $
d5 1
a5 1
DISTNAME=	p11-kit-0.10
@


1.8
log
@Minor update to p11-kit-0.9.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2011/10/22 22:48:33 ajacoutot Exp $
d5 1
a5 1
DISTNAME=	p11-kit-0.9
@


1.7
log
@Minor update to p11-kit-0.7.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2011/09/18 21:38:42 ajacoutot Exp $
d5 1
a5 1
DISTNAME=	p11-kit-0.7
@


1.6
log
@Explicitely set the module path.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2011/09/18 15:45:18 ajacoutot Exp $
d5 1
a5 2
DISTNAME=	p11-kit-0.6
REVISION=	2
@


1.5
log
@Install the config file as pkcs11.conf.example, as intended.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2011/09/18 12:13:41 ajacoutot Exp $
d6 1
a6 1
REVISION=	1
d30 2
a31 1
		--disable-gtk-doc
@


1.4
log
@Fix exampledir.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2011/09/18 12:02:33 ajacoutot Exp $
d6 1
a6 1
REVISION=	0
@


1.3
log
@Minor update to p11-kit-0.6.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2011/08/28 13:46:51 naddy Exp $
d6 1
d38 1
a38 1
FAKE_FLAGS=	exampledir=${PREFIX}/share/examples/p11-kit
@


1.2
log
@disable additional warning options, some of which are not available with
gcc < 4
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2011/08/22 08:04:14 ajacoutot Exp $
d5 1
a5 1
DISTNAME=	p11-kit-0.4
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d33 3
@


1.1.1.1
log
@Import p11-kit-0.4.

p11-kit provides a way to load and enumerate PKCS#11 modules. It
implements a standard discoverable configuration for installed PKCS#11
modules.

(this is needed for an upcoming gnutls update)

ok jasper@@
@
text
@@
