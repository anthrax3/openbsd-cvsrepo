head	1.3;
access;
symbols
	OPENBSD_6_0:1.3.0.2
	OPENBSD_6_0_BASE:1.3
	OPENBSD_3_2:1.1.0.2;
locks; strict;
comment	@# @;


1.3
date	2016.06.17.09.43.35;	author ajacoutot;	state Exp;
branches;
next	1.2;
commitid	QMluTM7VFmOZ7Js4;

1.2
date	2003.02.03.08.54.04;	author jakob;	state dead;
branches;
next	1.1;

1.1
date	2002.12.10.08.37.42;	author jakob;	state Exp;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2002.12.10.08.38.43;	author jakob;	state Exp;
branches;
next	;


desc
@@


1.3
log
@Unbreak getent LOGIN/PLAIN authentication: getpwnam -> getpwnam_shadow.
Fix a few time_t printf while here.
@
text
@$OpenBSD$

64-bit time_t

--- plugins/otp.c.orig	Fri Jun 17 11:35:41 2016
+++ plugins/otp.c	Fri Jun 17 11:36:05 2016
@@@@ -615,7 +615,7 @@@@ static int make_secret(const sasl_utils_t *utils,
     bin2hex(otp, OTP_HASH_SIZE, buf);
     buf[2*OTP_HASH_SIZE] = '\0';
     
-    sprintf(data, "%s\t%04d\t%s\t%s\t%020ld",
+    sprintf(data, "%s\t%04d\t%s\t%s\t%020lld",
 	    alg, seq, seed, buf, timeout);
     
     return SASL_OK;
@@@@ -676,7 +676,7 @@@@ static int parse_secret(const sasl_utils_t *utils,
 	    return SASL_FAIL;
 	}
 	
-	sscanf(secret, "%s\t%04d\t%s\t%s\t%020ld",
+	sscanf(secret, "%s\t%04d\t%s\t%s\t%020lld",
 	       alg, seq, seed, buf, timeout);
 	
 	hex2bin(buf, otp, OTP_HASH_SIZE);
@


1.2
log
@update to v2.1.11; from Hack Kampbjorn
@
text
@d1 24
a24 13
$OpenBSD: patch-plugins_otp_c,v 1.1 2002/12/10 08:37:42 jakob Exp $
--- plugins/otp.c.orig	Mon Oct 14 21:39:43 2002
+++ plugins/otp.c	Tue Dec 10 09:22:02 2002
@@@@ -56,7 +56,9 @@@@
 #include <openssl/evp.h>
 
 #include <sasl.h>
+#if OPENSSL_VERSION_NUMBER < 0x00907000L
 #define MD5_H  /* suppress internal MD5 */
+#endif
 #include <saslplug.h>
 
 #include "plugin_common.h"
@


1.1
log
@upgrade to v2.1.10, buffer overflow fixes. patch from Hack Kampbjorn.
@
text
@d1 1
a1 1
$OpenBSD$
@


1.1.2.1
log
@upgrade to v2.1.10, buffer overflow fixes. patch from Hack Kampbjorn.
@
text
@@

