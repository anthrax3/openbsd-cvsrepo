head	1.2;
access;
symbols;
locks; strict;
comment	@# @;


1.2
date	2013.10.24.15.42.08;	author jca;	state dead;
branches;
next	1.1;

1.1
date	2013.09.06.16.27.51;	author ajacoutot;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Security fix for GNUTLS-SA-2013-3,
GnuTLS Denial of Service vulnerability in DANE records processing.
(no CVE assigned yet)

ok aja@@ (MAINTAINER)
@
text
@$OpenBSD: patch-src_certtool-extras_c,v 1.1 2013/09/06 16:27:51 ajacoutot Exp $

From 1df1b0f7b28c733bf01e5d1faa2f8ccdb3db1665 Mon Sep 17 00:00:00 2001
From: Nikos Mavrogiannopoulos <nmav@@gnutls.org>
Date: Mon, 2 Sep 2013 13:47:18 +0300
Subject: [PATCH] Avoid using gnulib's error()

--- src/certtool-extras.c.orig	Wed Apr 24 10:34:02 2013
+++ src/certtool-extras.c	Fri Sep  6 17:25:49 2013
@@@@ -38,7 +38,6 @@@@
 #include <sys/types.h>
 #include <sys/stat.h>
 #include <fcntl.h>
-#include <error.h>
 #include "certtool-common.h"
 #include "certtool-cfg.h"
 
@@@@ -64,14 +63,20 @@@@ load_privkey_list (int mand, size_t * privkey_size, co
   if (info->privkey == NULL)
     {
       if (mand)
-        error (EXIT_FAILURE, 0, "missing --load-privkey");
+        {
+          fprintf( stderr, "missing --load-privkey");
+          exit(1);
+        }
       else
         return NULL;
     }
 
   ret = gnutls_load_file(info->privkey, &file_data);
   if (ret < 0)
-    error (EXIT_FAILURE, errno, "%s", info->privkey);
+    {
+      fprintf (stderr, "%s", info->privkey);
+      exit(1);
+    }
 
   ptr = (void*)file_data.data;
   ptr_size = file_data.size;
@@@@ -80,7 +85,10 @@@@ load_privkey_list (int mand, size_t * privkey_size, co
     {
       ret = gnutls_x509_privkey_init (&key[i]);
       if (ret < 0)
-        error (EXIT_FAILURE, 0, "privkey_init: %s", gnutls_strerror (ret));
+        {
+          fprintf( stderr, "privkey_init: %s", gnutls_strerror (ret));
+          exit(1);
+        }
 
       dat.data = (void*)ptr;
       dat.size = ptr_size;
@@@@ -95,7 +103,10 @@@@ load_privkey_list (int mand, size_t * privkey_size, co
       if (ret < 0 && *privkey_size > 0)
         break;
       if (ret < 0)
-        error (EXIT_FAILURE, 0, "privkey_import: %s", gnutls_strerror (ret));
+        {
+          fprintf( stderr, "privkey_import: %s", gnutls_strerror (ret));
+          exit(1);
+        }
 
       (*privkey_size)++;
 
@


1.1
log
@Update to gnutls-3.2.4.
@
text
@d1 1
a1 1
$OpenBSD$
@

