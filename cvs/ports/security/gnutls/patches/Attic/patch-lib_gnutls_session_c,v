head	1.1;
access;
symbols
	OPENBSD_5_0:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2011.11.21.15.15.32;	author jasper;	state dead;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2011.11.21.15.15.32;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.1
log
@file patch-lib_gnutls_session_c was initially added on branch OPENBSD_5_0.
@
text
@@


1.1.2.1
log
@Security fix for CVE-2011-4128,
gnutls: buffer overflow in gnutls_session_get_data()

ok aja@@
@
text
@a0 23
$OpenBSD$

Security fix for CVE-2011-4128,
gnutls: buffer overflow in gnutls_session_get_data()

Patch from upstream git:
http://git.savannah.gnu.org/gitweb/?p=gnutls.git;a=commitdiff;h=190cef6eed37d0e73a73c1e205eb31d45ab60a3c
http://git.savannah.gnu.org/gitweb/?p=gnutls.git;a=commitdiff;h=e82ef4545e9e98cbcb032f55d7c750b81e3a0450

--- lib/gnutls_session.c.orig	Mon Nov 21 16:01:18 2011
+++ lib/gnutls_session.c	Mon Nov 21 16:02:00 2011
@@@@ -65,10 +65,10 @@@@ gnutls_session_get_data (gnutls_session_t session,
       gnutls_assert ();
       return ret;
     }
-  *session_data_size = psession.size;
 
   if (psession.size > *session_data_size)
     {
+      *session_data_size = psession.size;
       ret = GNUTLS_E_SHORT_MEMORY_BUFFER;
       goto error;
     }
@

