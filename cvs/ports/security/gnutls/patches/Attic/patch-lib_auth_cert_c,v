head	1.1;
access;
symbols
	OPENBSD_5_7:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2015.05.04.09.32.04;	author ajacoutot;	state dead;
branches
	1.1.2.1;
next	;
commitid	OmWi153WU5hIhkHY;

1.1.2.1
date	2015.05.04.09.32.04;	author ajacoutot;	state Exp;
branches;
next	;
commitid	OmWi153WU5hIhkHY;


desc
@@


1.1
log
@file patch-lib_auth_cert_c was initially added on branch OPENBSD_5_7.
@
text
@@


1.1.2.1
log
@Fix for MD5 downgrade in TLS 1.2 signatures [GNUTLS-SA-2015-2].
@
text
@a0 30
$OpenBSD$

GNUTLS-SA-2015-2

--- lib/auth/cert.c.orig	Sun Aug 10 13:50:46 2014
+++ lib/auth/cert.c	Mon May  4 11:25:43 2015
@@@@ -1490,6 +1490,11 @@@@ _gnutls_proc_cert_cert_req(gnutls_session_t session, u
 
 	DECR_LEN(dsize, size);
 
+	/* We should reply with a certificate message, 
+	 * even if we have no certificate to send.
+	 */
+	session->key.crt_requested = 1;
+
 	/* now we ask the user to tell which one
 	 * he wants to use.
 	 */
@@@@ -1499,11 +1504,6 @@@@ _gnutls_proc_cert_cert_req(gnutls_session_t session, u
 		gnutls_assert();
 		return ret;
 	}
-
-	/* We should reply with a certificate message, 
-	 * even if we have no certificate to send.
-	 */
-	session->key.crt_requested = 1;
 
 	return 0;
 }
@

