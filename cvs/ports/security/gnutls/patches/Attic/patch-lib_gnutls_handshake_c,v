head	1.1;
access;
symbols
	OPENBSD_5_5:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2014.06.10.10.47.33;	author jasper;	state dead;
branches
	1.1.2.1;
next	;
commitid	gCRCHdRR9guAPF9f;

1.1.2.1
date	2014.06.10.10.47.33;	author jasper;	state Exp;
branches;
next	;
commitid	gCRCHdRR9guAPF9f;


desc
@@


1.1
log
@file patch-lib_gnutls_handshake_c was initially added on branch OPENBSD_5_5.
@
text
@@


1.1.2.1
log
@security fix for CVE-2014-3466

ok aja@@
@
text
@a0 16
$OpenBSD$

Security fix for CVE-2014-3466
gnutls: insufficient session id length check in _gnutls_read_server_hello (GNUTLS-SA-2014-3)

--- lib/gnutls_handshake.c.orig	Thu May 29 19:35:40 2014
+++ lib/gnutls_handshake.c	Thu May 29 19:36:05 2014
@@@@ -1744,7 +1744,7 @@@@ _gnutls_read_server_hello(gnutls_session_t session,
 	DECR_LEN(len, 1);
 	session_id_len = data[pos++];
 
-	if (len < session_id_len) {
+	if (len < session_id_len || session_id_len > TLS_MAX_SESSION_ID_SIZE) {
 		gnutls_assert();
 		return GNUTLS_E_UNSUPPORTED_VERSION_PACKET;
 	}
@

