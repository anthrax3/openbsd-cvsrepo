head	1.1;
access;
symbols
	OPENBSD_3_4:1.1.0.4
	OPENBSD_3_5:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2004.10.11.20.16.50;	author robert;	state dead;
branches
	1.1.2.1
	1.1.4.1;
next	;

1.1.2.1
date	2004.10.11.20.16.50;	author robert;	state Exp;
branches;
next	1.1.2.2;

1.1.2.2
date	2004.10.19.18.25.14;	author robert;	state Exp;
branches;
next	;

1.1.4.1
date	2004.10.12.17.14.37;	author robert;	state Exp;
branches;
next	1.1.4.2;

1.1.4.2
date	2004.10.19.18.31.12;	author robert;	state Exp;
branches;
next	;


desc
@@


1.1
log
@file patch-lib_common_c was initially added on branch OPENBSD_3_5.
@
text
@@


1.1.4.1
log
@SECURITY:
libsasl, contains functions which may load dynamic libraries.
These libraries may be loaded from the path specified by the
environmental variable SASL_PATH, which in some situations may be
fully controlled by a local attacker.
Thus, if a set-user-ID application utilizes libsasl, it may be possible
for a local attacker to gain superuser privileges.

ok brad@@
@
text
@a0 14
$OpenBSD$
--- lib/common.c.orig	Wed Nov 22 06:55:31 2000
+++ lib/common.c	Mon Oct 11 21:32:52 2004
@@@@ -642,7 +642,10 @@@@
 
   if (! path_dest)
     return SASL_BADPARAM;
+  /* Honor external variable only in a safe environment */
+  if (getuid() == getuid() && getgid() == getgid())
   path = getenv(SASL_PATH_ENV_VAR);
+  
   if (! path)
     path = PLUGINDIR;
   return _sasl_strdup(path, path_dest, NULL);
@


1.1.4.2
log
@fix my stupid typos: getuid -> geteuid, getgid -> getegid

reported by bluhm@@genua.de, markus@@; ok brad@@
@
text
@d1 1
a1 1
$OpenBSD: patch-lib_common_c,v 1.1.4.1 2004/10/12 17:14:37 robert Exp $
d9 1
a9 1
+  if (getuid() == geteuid() && getgid() == getegid())
@


1.1.2.1
log
@SECURITY:
libsasl, contains functions which may load dynamic libraries.
These libraries may be loaded from the path specified by the
environmental variable SASL_PATH, which in some situations may be
fully controlled by a local attacker.
Thus, if a set-user-ID application utilizes libsasl, it may be possible
for a local attacker to gain superuser privileges.

ok brad@@
@
text
@a0 14
$OpenBSD$
--- lib/common.c.orig	Wed Nov 22 06:55:31 2000
+++ lib/common.c	Mon Oct 11 21:32:52 2004
@@@@ -642,7 +642,10 @@@@
 
   if (! path_dest)
     return SASL_BADPARAM;
+  /* Honor external variable only in a safe environment */
+  if (getuid() == getuid() && getgid() == getgid())
   path = getenv(SASL_PATH_ENV_VAR);
+  
   if (! path)
     path = PLUGINDIR;
   return _sasl_strdup(path, path_dest, NULL);
@


1.1.2.2
log
@fix my stupid typos: getuid -> geteuid, getgid -> getegid

reported by bluhm@@genua.de, markus@@; ok brad@@
@
text
@d1 1
a1 1
$OpenBSD: patch-lib_common_c,v 1.1.2.1 2004/10/11 20:16:50 robert Exp $
d9 1
a9 1
+  if (getuid() == geteuid() && getgid() == getegid())
@


