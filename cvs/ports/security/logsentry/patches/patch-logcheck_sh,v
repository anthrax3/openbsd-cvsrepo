head	1.3;
access;
symbols
	OPENBSD_6_0:1.3.0.54
	OPENBSD_6_0_BASE:1.3
	OPENBSD_5_9:1.3.0.50
	OPENBSD_5_9_BASE:1.3
	OPENBSD_5_8:1.3.0.52
	OPENBSD_5_8_BASE:1.3
	OPENBSD_5_7:1.3.0.48
	OPENBSD_5_7_BASE:1.3
	OPENBSD_5_6:1.3.0.46
	OPENBSD_5_6_BASE:1.3
	OPENBSD_5_5:1.3.0.44
	OPENBSD_5_5_BASE:1.3
	OPENBSD_5_4:1.3.0.42
	OPENBSD_5_4_BASE:1.3
	OPENBSD_5_3:1.3.0.40
	OPENBSD_5_3_BASE:1.3
	OPENBSD_5_2:1.3.0.38
	OPENBSD_5_2_BASE:1.3
	OPENBSD_5_1_BASE:1.3
	OPENBSD_5_1:1.3.0.36
	OPENBSD_5_0:1.3.0.34
	OPENBSD_5_0_BASE:1.3
	OPENBSD_4_9:1.3.0.32
	OPENBSD_4_9_BASE:1.3
	OPENBSD_4_8:1.3.0.30
	OPENBSD_4_8_BASE:1.3
	OPENBSD_4_7:1.3.0.28
	OPENBSD_4_7_BASE:1.3
	OPENBSD_4_6:1.3.0.26
	OPENBSD_4_6_BASE:1.3
	OPENBSD_4_5:1.3.0.24
	OPENBSD_4_5_BASE:1.3
	OPENBSD_4_4:1.3.0.22
	OPENBSD_4_4_BASE:1.3
	OPENBSD_4_3:1.3.0.20
	OPENBSD_4_3_BASE:1.3
	OPENBSD_4_2:1.3.0.18
	OPENBSD_4_2_BASE:1.3
	OPENBSD_4_1:1.3.0.16
	OPENBSD_4_1_BASE:1.3
	OPENBSD_4_0:1.3.0.14
	OPENBSD_4_0_BASE:1.3
	OPENBSD_3_9:1.3.0.12
	OPENBSD_3_9_BASE:1.3
	OPENBSD_3_8:1.3.0.10
	OPENBSD_3_8_BASE:1.3
	OPENBSD_3_7:1.3.0.8
	OPENBSD_3_7_BASE:1.3
	OPENBSD_3_6:1.3.0.6
	OPENBSD_3_6_BASE:1.3
	OPENBSD_3_5:1.3.0.4
	OPENBSD_3_5_BASE:1.3
	OPENBSD_3_4:1.3.0.2
	OPENBSD_3_4_BASE:1.3
	OPENBSD_3_3:1.2.0.2
	OPENBSD_3_3_BASE:1.2
	sturm_2003-Jan-25:1.1.1.1
	sturm:1.1.1;
locks; strict;
comment	@# @;


1.3
date	2003.04.20.17.36.40;	author sturm;	state Exp;
branches;
next	1.2;

1.2
date	2003.02.02.08.20.46;	author sturm;	state Exp;
branches;
next	1.1;

1.1
date	2003.01.24.23.29.17;	author sturm;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2003.01.24.23.29.17;	author sturm;	state Exp;
branches;
next	;


desc
@@


1.3
log
@clean up from maintainer Srebrenko Sehic <haver@@insecure.dk> and me

- consistent file names, no more logcheck.*
- bump PKGNAME
- remove HOMEPAGE (company and site are no longer)
- change MASTER_SITES (dito)
@
text
@--- systems/generic/logcheck.sh.orig	Thu Jan 16 22:07:04 2003
+++ systems/generic/logcheck.sh	Thu Jan 16 22:09:12 2003
@@@@ -31,7 +31,7 @@@@
 
 # CONFIGURATION SECTION
 
-PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/ucb:/usr/local/bin
+PATH=/bin:/sbin:/usr/bin:/usr/sbin:%%LOCALBASE%%/bin
 
 # Logcheck is pre-configured to work on most BSD like systems, however it
 # is a rather dumb program and may need some help to work on other
@@@@ -44,7 +44,7 @@@@
 # Full path to logtail program.
 # This program is required to run this script and comes with the package.
 
-LOGTAIL=/usr/local/bin/logtail
+LOGTAIL=%%LOCALBASE%%/bin/logtail
 
 # Full path to SECURED (non public writable) /tmp directory.
 # Prevents Race condition and potential symlink problems. I highly
@@@@ -52,7 +52,7 @@@@
 # You would also be well advised to make sure all your system/cron scripts
 # use this directory for their "scratch" area. 
 
-TMPDIR=/usr/local/etc/tmp
+TMPDIR=%%LOGSENTRY_TMP%%
 
 # The 'grep' command. This command MUST support the
 # '-i' '-v' and '-f' flags!! The GNU grep does this by default (that's
@@@@ -89,7 +89,7 @@@@
 # look for generic ISS probes (who the hell else looks for 
 # "WIZ" besides ISS?), and obvious sendmail attacks/probes.
 
-HACKING_FILE=/usr/local/etc/logcheck.hacking
+HACKING_FILE=%%SYSCONFDIR%%/logsentry/logsentry.hacking
 
 # File of security violation patterns to specifically look for.
 # This file should contain keywords of information administrators should
@@@@ -98,7 +98,7 @@@@
 # some items, but these will be caught by the next check. Move suspicious
 # items into this file to have them reported regularly.
 
-VIOLATIONS_FILE=/usr/local/etc/logcheck.violations
+VIOLATIONS_FILE=%%SYSCONFDIR%%/logsentry/logsentry.violations
 
 # File that contains more complete sentences that have keywords from
 # the violations file. These keywords are normal and are not cause for 
@@@@ -115,14 +115,14 @@@@
 #
 # Again, be careful what you put in here and DO NOT LEAVE IT EMPTY!
 
-VIOLATIONS_IGNORE_FILE=/usr/local/etc/logcheck.violations.ignore
+VIOLATIONS_IGNORE_FILE=%%SYSCONFDIR%%/logsentry/logsentry.violations.ignore
 
 # This is the name of a file that contains patterns that we should
 # ignore if found in a log file. If you have repeated false alarms
 # or want specific errors ignored, you should put them in here.
 # Once again, be as specific as possible, and go easy on the wildcards
 
-IGNORE_FILE=/usr/local/etc/logcheck.ignore
+IGNORE_FILE=%%SYSCONFDIR%%/logsentry/logsentry.ignore
 
 # The files are reported in the order of hacking, security 
 # violations, and unusual system events. Notice that this
@@@@ -163,7 +163,15 @@@@
 # ALWAYS BE chmod 600 OWNER root!!
 
 # Generic and Linux Slackware 3.x
+#$LOGTAIL /var/log/messages > $TMPDIR/check.$$
+
+# OpenBSD 2.x, 3.x
 $LOGTAIL /var/log/messages > $TMPDIR/check.$$
+$LOGTAIL /var/log/maillog >> $TMPDIR/check.$$
+$LOGTAIL /var/log/authlog >> $TMPDIR/check.$$
+$LOGTAIL /var/log/secure >> $TMPDIR/check.$$
+$LOGTAIL /var/log/daemon >> $TMPDIR/check.$$
+$LOGTAIL /var/log/xferlog >> $TMPDIR/check.$$
 
 # Linux Red Hat Version 3.x, 4.x
 #$LOGTAIL /var/log/messages > $TMPDIR/check.$$
@


1.2
log
@- patch logcheck.sh to actually use SYSCONFDIR/logsentry instead of
the old SYSCONFDIR/logcheck from MAINTAINER
- spelling in DESCR
- bump package version
@
text
@d26 1
a26 1
+TMPDIR=%%LOGCHECK_TMP%%
d35 1
a35 1
+HACKING_FILE=%%SYSCONFDIR%%/logsentry/logcheck.hacking
d44 1
a44 1
+VIOLATIONS_FILE=%%SYSCONFDIR%%/logsentry/logcheck.violations
d53 1
a53 1
+VIOLATIONS_IGNORE_FILE=%%SYSCONFDIR%%/logsentry/logcheck.violations.ignore
d61 1
a61 1
+IGNORE_FILE=%%SYSCONFDIR%%/logsentry/logcheck.ignore
@


1.1
log
@Initial revision
@
text
@d35 1
a35 1
+HACKING_FILE=%%SYSCONFDIR%%/logcheck/logcheck.hacking
d44 1
a44 1
+VIOLATIONS_FILE=%%SYSCONFDIR%%/logcheck/logcheck.violations
d53 1
a53 1
+VIOLATIONS_IGNORE_FILE=%%SYSCONFDIR%%/logcheck/logcheck.violations.ignore
d61 1
a61 1
+IGNORE_FILE=%%SYSCONFDIR%%/logcheck/logcheck.ignore
@


1.1.1.1
log
@initial import of logsentry 1.1.1

this was once logcheck, which changed it's name to logsentry
no functional changes

from MAINTAINER
reimport OK'ed by naddy@@
@
text
@@
