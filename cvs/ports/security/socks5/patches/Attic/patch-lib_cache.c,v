head	1.2;
access;
symbols
	OPENBSD_2_7:1.1.0.2;
locks; strict;
comment	@ * @;


1.2
date	2000.11.02.17.39.47;	author espie;	state dead;
branches;
next	1.1;

1.1
date	2000.08.03.00.03.21;	author brad;	state Exp;
branches;
next	;


desc
@@


1.2
log
@r10 vanished.
r11 includes most patches.

+ gcc -shared to build object module.
@
text
@$OpenBSD: patch-lib_cache.c,v 1.1 2000/08/03 00:03:21 brad Exp $

This patch fixes a problem with the SOCKS client library for dup().
The ftp client uses dup().

--- lib/cache.c.orig	Wed Aug  2 19:06:02 2000
+++ lib/cache.c	Wed Aug  2 19:06:34 2000
@@@@ -26,8 +26,8 @@@@
     lsProxyInfo *n, *p = *pp;
     
     for (n = p?p->next:NULL; p ; p = n, n = n?n->next:NULL) {
-	if (--(p->refcount) > 0) continue;
 	if (p->cinfo.fd == rfd) p->cinfo.fd = S5InvalidIOHandle;
+	if (--(p->refcount) > 0) continue;
 	S5BufCleanContext(&p->cinfo);
 	free(p);
     }
@


1.1
log
@add socks5-v1.0r10.patch3.txt patch
--
This patch fixes a problem with the SOCKS client library for dup().
The ftp client uses dup().
@
text
@d1 1
a1 1
$OpenBSD$
@

