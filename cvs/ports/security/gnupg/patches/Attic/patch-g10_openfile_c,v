head	1.2;
access;
symbols
	OPENBSD_3_9:1.1.0.4
	OPENBSD_4_0:1.1.0.2;
locks; strict;
comment	@# @;


1.2
date	2007.01.16.09.50.36;	author bernd;	state dead;
branches;
next	1.1;

1.1
date	2006.11.28.10.18.49;	author bernd;	state Exp;
branches
	1.1.2.1
	1.1.4.1;
next	;

1.1.2.1
date	2006.11.30.20.49.29;	author sturm;	state Exp;
branches;
next	;

1.1.4.1
date	2006.11.30.21.59.12;	author sturm;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Update to gnupg-1.4.6.

ok steven@@
@
text
@$OpenBSD: patch-g10_openfile_c,v 1.1 2006/11/28 10:18:49 bernd Exp $

Fixes a buffer overflow when running gnupg in interactive mode.
Should be fixed in >1.4.5.

--- g10/openfile.c.orig	Tue Nov 28 11:05:05 2006
+++ g10/openfile.c	Tue Nov 28 11:06:01 2006
@@@@ -144,8 +144,8 @@@@ ask_outfile_name( const char *name, size
 
     s = _("Enter new filename");
 
-    n = strlen(s) + namelen + 10;
     defname = name && namelen? make_printable_string( name, namelen, 0): NULL;
+    n = strlen(s) + (defname?strlen (defname):0) + 10;
     prompt = xmalloc(n);
     if( defname )
 	sprintf(prompt, "%s [%s]: ", s, defname );
@


1.1
log
@Security fix for a buffer overflow when running gnupg in interactive mode.

More info:
http://lists.gnupg.org/pipermail/gnupg-announce/2006q4/000241.html
@
text
@d1 1
a1 1
$OpenBSD$
@


1.1.4.1
log
@MFC:
Security fix for a buffer overflow when running gnupg in interactive mode.

More info:
http://lists.gnupg.org/pipermail/gnupg-announce/2006q4/000241.html
@
text
@d1 1
a1 1
$OpenBSD: patch-g10_openfile_c,v 1.1 2006/11/28 10:18:49 bernd Exp $
d6 3
a8 3
--- g10/openfile.c.orig	Thu Nov 30 22:53:07 2006
+++ g10/openfile.c	Thu Nov 30 22:54:04 2006
@@@@ -142,8 +142,8 @@@@ ask_outfile_name( const char *name, size
d15 1
a15 1
     prompt = m_alloc(n);
@


1.1.2.1
log
@MFC:
Security fix for a buffer overflow when running gnupg in interactive mode.

More info:
http://lists.gnupg.org/pipermail/gnupg-announce/2006q4/000241.html
@
text
@d1 1
a1 1
$OpenBSD: patch-g10_openfile_c,v 1.1 2006/11/28 10:18:49 bernd Exp $
@

