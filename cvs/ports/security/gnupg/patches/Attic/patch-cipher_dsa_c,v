head	1.1;
access;
symbols
	OPENBSD_5_4:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2013.12.20.20.01.47;	author jasper;	state dead;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2013.12.20.20.01.47;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.1
log
@file patch-cipher_dsa_c was initially added on branch OPENBSD_5_4.
@
text
@@


1.1.2.1
log
@Security fix for CVE-2013-4576
@
text
@a0 34
$OpenBSD$

Security fix for CVE-2013-4576
http://git.gnupg.org/cgi-bin/gitweb.cgi?p=gnupg.git;a=commit;h=d0d72d98f34579213230b3febfebd2fd8dff272bOB

--- cipher/dsa.c.orig	Thu Dec 20 18:22:26 2012
+++ cipher/dsa.c	Sun Dec 15 18:12:56 2013
@@@@ -274,7 +274,7 @@@@ check_secret_key( DSA_secret_key *sk )
 /****************
  * Make a DSA signature from HASH and put it into r and s.
  *
- * Without generating the k this function runs in 
+ * Without generating the k this function runs in
  * about 26ms on a 300 Mhz Mobile Pentium
  */
 
@@@@ -285,6 +285,8 @@@@ sign(MPI r, MPI s, MPI hash, DSA_secret_key *skey )
     MPI kinv;
     MPI tmp;
 
+    mpi_normalize (hash);
+
     /* select a random k with 0 < k < q */
     k = gen_k( skey->q );
 
@@@@ -311,7 +313,7 @@@@ sign(MPI r, MPI s, MPI hash, DSA_secret_key *skey )
 /****************
  * Returns true if the signature composed from R and S is valid.
  *
- * Without the checks this function runs in 
+ * Without the checks this function runs in
  * about 31ms on a 300 Mhz Mobile Pentium
  */
 static int
@

