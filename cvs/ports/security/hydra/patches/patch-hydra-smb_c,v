head	1.2;
access;
symbols
	OPENBSD_6_0:1.2.0.4
	OPENBSD_6_0_BASE:1.2
	OPENBSD_5_9:1.2.0.2
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.1.0.8
	OPENBSD_5_8_BASE:1.1
	OPENBSD_5_7:1.1.0.4
	OPENBSD_5_7_BASE:1.1
	OPENBSD_5_6:1.1.0.2
	OPENBSD_5_6_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2015.11.21.14.16.33;	author rpointel;	state Exp;
branches;
next	1.1;
commitid	QSZcKjpCCivR5xgo;

1.1
date	2014.04.15.11.25.42;	author naddy;	state Exp;
branches;
next	;


desc
@@


1.2
log
@update hydra to 8.1.
From Sebastien Dellac (shaxo@@laposte.net), ok benoit@@.
@
text
@$OpenBSD: patch-hydra-smb_c,v 1.1 2014/04/15 11:25:42 naddy Exp $
--- hydra-smb.c.orig	Sun Dec  7 15:50:24 2014
+++ hydra-smb.c	Wed Nov 18 17:38:00 2015
@@@@ -176,17 +176,17 @@@@ static void MakeKey(unsigned char *key, unsigned char 
   des_key[6] = Get7Bits(key, 42);
   des_key[7] = Get7Bits(key, 49);
 
-  des_set_odd_parity((des_cblock *) des_key);
+  DES_set_odd_parity((DES_cblock *) des_key);
 }
 
 /* Do the DesEncryption */
 void DesEncrypt(unsigned char *clear, unsigned char *key, unsigned char *cipher) {
-  des_cblock des_key;
-  des_key_schedule key_schedule;
+  DES_cblock des_key;
+  DES_key_schedule key_schedule;
 
   MakeKey(key, des_key);
-  des_set_key(&des_key, key_schedule);
-  des_ecb_encrypt((des_cblock *) clear, (des_cblock *) cipher, key_schedule, 1);
+  DES_set_key(&des_key, &key_schedule);
+  DES_ecb_encrypt((DES_cblock *) clear, (DES_cblock *) cipher, &key_schedule, 1);
 }
 
 /*
@


1.1
log
@switch from the ancient des_ API to DES_; ok benoit@@
@
text
@d1 4
a4 4
$OpenBSD$
--- hydra-smb.c.orig	Sun Oct  2 10:06:15 2011
+++ hydra-smb.c	Mon Apr 14 22:35:34 2014
@@@@ -139,19 +139,19 @@@@ MakeKey(unsigned char *key, unsigned char *des_key)
d13 1
a13 3
 void
 DesEncrypt(unsigned char *clear, unsigned char *key, unsigned char *cipher)
 {
@

