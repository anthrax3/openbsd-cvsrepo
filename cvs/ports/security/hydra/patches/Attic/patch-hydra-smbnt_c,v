head	1.2;
access;
symbols
	OPENBSD_3_6:1.1.0.4
	OPENBSD_3_6_BASE:1.1
	OPENBSD_3_5:1.1.0.2
	OPENBSD_3_5_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2004.10.02.04.08.42;	author tedu;	state dead;
branches;
next	1.1;

1.1
date	2003.12.14.16.35.49;	author margarida;	state Exp;
branches;
next	;


desc
@@


1.2
log
@update to 4.1 from van helsing.
@
text
@$OpenBSD: patch-hydra-smbnt_c,v 1.1 2003/12/14 16:35:49 margarida Exp $
--- hydra-smbnt.c.orig	2003-12-13 19:47:49.000000000 -0800
+++ hydra-smbnt.c	2003-12-13 19:47:56.000000000 -0800
@@@@ -84,6 +84,8 @@@@ void HashNTLM(u_char **ntlmhash, u_char 
   int                 i=0,j=0;
   int                 mdlen = strlen(pass) * 2 * 8;
   u_char              *p;
+  char                HexChar;
+  int                 HexValue;
   
   /* Use NTLM Hash instead of password */
   if ((miscptr != NULL) && (strcmp(miscptr, "HASH") == 0)) { 
@@@@ -99,8 +101,6 @@@@ void HashNTLM(u_char **ntlmhash, u_char 
       exit(1);
     }
 
-    char HexChar;
-    int HexValue;
     for (i=0; i<16; i++) {
       HexValue = 0x0;
       for (j=0; j<2; j++) {
@@@@ -303,11 +303,12 @@@@ int SMBSessionSetup(int s, char *user, c
 int start_smbnt(int s, unsigned long int ip, int port, unsigned char options, char *miscptr, FILE *fp) {
   char *empty = "";
   char *login, *pass;
+  int SMBerr;
 
   if (strlen(login = hydra_get_next_login()) == 0) login = empty;
   if (strlen(pass = hydra_get_next_password()) == 0) pass = empty;
 
-  int SMBerr = SMBSessionSetup(s, login, pass, miscptr);
+  SMBerr = SMBSessionSetup(s, login, pass, miscptr);
 
   if ( 0x00 == SMBerr ) {                  // success
     hydra_report_found_host(port, ip, "smb", fp);
@


1.1
log
@Update hydra to version 2.5.
--
From Michael Coulter <mjc@@bitz.ca>
@
text
@d1 1
a1 1
$OpenBSD$
@

