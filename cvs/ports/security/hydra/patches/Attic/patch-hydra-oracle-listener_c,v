head	1.3;
access;
symbols
	OPENBSD_6_0:1.2.0.4
	OPENBSD_6_0_BASE:1.2
	OPENBSD_5_9:1.2.0.2
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.1.0.8
	OPENBSD_5_8_BASE:1.1
	OPENBSD_5_7:1.1.0.4
	OPENBSD_5_7_BASE:1.1
	OPENBSD_5_6:1.1.0.2
	OPENBSD_5_6_BASE:1.1;
locks; strict;
comment	@# @;


1.3
date	2017.02.28.12.47.56;	author benoit;	state dead;
branches;
next	1.2;
commitid	0toJsK6Lw8oKyljD;

1.2
date	2015.11.21.14.16.33;	author rpointel;	state Exp;
branches;
next	1.1;
commitid	QSZcKjpCCivR5xgo;

1.1
date	2014.04.15.11.25.42;	author naddy;	state Exp;
branches;
next	;


desc
@@


1.3
log
@Update to hydra-8.4.

from Rafael Sadowski, ok rpointel@@
@
text
@$OpenBSD: patch-hydra-oracle-listener_c,v 1.2 2015/11/21 14:16:33 rpointel Exp $
--- hydra-oracle-listener.c.orig	Sun Dec  7 15:50:20 2014
+++ hydra-oracle-listener.c	Thu Nov 19 14:50:52 2015
@@@@ -106,7 +106,7 @@@@ int convert_byteorder(unsigned char **result, int size
 int ora_descrypt(unsigned char **rs, unsigned char *result, int siz) {
   int i = 0;
   char lastkey[8];
-  des_key_schedule ks1;
+  DES_key_schedule ks1;
   unsigned char key1[8] = { 0x01, 0x23, 0x45, 0x67, 0x89, 0xAB, 0xCD, 0xEF };
   unsigned char ivec1[] = { 0, 0, 0, 0, 0, 0, 0, 0 };
   unsigned char *desresult;
@@@@ -116,17 +116,17 @@@@ int ora_descrypt(unsigned char **rs, unsigned char *re
     hydra_report(stderr, "[ERROR] Can't allocate memory\n");
     return 1;
   }
-  des_key_sched((C_Block *) key1, ks1);
-  des_ncbc_encrypt(result, desresult, siz, ks1, &ivec1, DES_ENCRYPT);
+  DES_key_sched((DES_cblock *) key1, &ks1);
+  DES_ncbc_encrypt(result, desresult, siz, &ks1, &ivec1, DES_ENCRYPT);
 
   for (i = 0; i < 8; i++) {
     lastkey[i] = desresult[siz - 8 + i];
   }
 
-  des_key_sched((C_Block *) lastkey, ks1);
+  DES_key_sched((DES_cblock *) lastkey, &ks1);
   memset(desresult, 0, siz);
   memset(ivec1, 0, sizeof(ivec1));
-  des_ncbc_encrypt(result, desresult, siz, ks1, &ivec1, DES_ENCRYPT);
+  DES_ncbc_encrypt(result, desresult, siz, &ks1, &ivec1, DES_ENCRYPT);
 
   if ((*rs = malloc(siz)) == NULL) {
     hydra_report(stderr, "[ERROR] Can't allocate memory\n");
@


1.2
log
@update hydra to 8.1.
From Sebastien Dellac (shaxo@@laposte.net), ok benoit@@.
@
text
@d1 1
a1 1
$OpenBSD: patch-hydra-oracle-listener_c,v 1.1 2014/04/15 11:25:42 naddy Exp $
@


1.1
log
@switch from the ancient des_ API to DES_; ok benoit@@
@
text
@d1 4
a4 4
$OpenBSD$
--- hydra-oracle-listener.c.orig	Sun Oct  2 10:06:15 2011
+++ hydra-oracle-listener.c	Mon Apr 14 22:49:36 2014
@@@@ -105,7 +105,7 @@@@ int convert_byteorder(unsigned char **result, int size
d13 1
a13 1
@@@@ -115,17 +115,17 @@@@ int ora_descrypt(unsigned char **rs, unsigned char *re
@

