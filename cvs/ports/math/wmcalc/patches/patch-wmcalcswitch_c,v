head	1.2;
access;
symbols
	OPENBSD_6_1:1.2.0.66
	OPENBSD_6_1_BASE:1.2
	OPENBSD_6_0:1.2.0.64
	OPENBSD_6_0_BASE:1.2
	OPENBSD_5_9:1.2.0.60
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.2.0.62
	OPENBSD_5_8_BASE:1.2
	OPENBSD_5_7:1.2.0.58
	OPENBSD_5_7_BASE:1.2
	OPENBSD_5_6:1.2.0.56
	OPENBSD_5_6_BASE:1.2
	OPENBSD_5_5:1.2.0.54
	OPENBSD_5_5_BASE:1.2
	OPENBSD_5_4:1.2.0.52
	OPENBSD_5_4_BASE:1.2
	OPENBSD_5_3:1.2.0.50
	OPENBSD_5_3_BASE:1.2
	OPENBSD_5_2:1.2.0.48
	OPENBSD_5_2_BASE:1.2
	OPENBSD_5_1_BASE:1.2
	OPENBSD_5_1:1.2.0.46
	OPENBSD_5_0:1.2.0.44
	OPENBSD_5_0_BASE:1.2
	OPENBSD_4_9:1.2.0.42
	OPENBSD_4_9_BASE:1.2
	OPENBSD_4_8:1.2.0.40
	OPENBSD_4_8_BASE:1.2
	OPENBSD_4_7:1.2.0.38
	OPENBSD_4_7_BASE:1.2
	OPENBSD_4_6:1.2.0.36
	OPENBSD_4_6_BASE:1.2
	OPENBSD_4_5:1.2.0.34
	OPENBSD_4_5_BASE:1.2
	OPENBSD_4_4:1.2.0.32
	OPENBSD_4_4_BASE:1.2
	OPENBSD_4_3:1.2.0.30
	OPENBSD_4_3_BASE:1.2
	OPENBSD_4_2:1.2.0.28
	OPENBSD_4_2_BASE:1.2
	OPENBSD_4_1:1.2.0.26
	OPENBSD_4_1_BASE:1.2
	OPENBSD_4_0:1.2.0.24
	OPENBSD_4_0_BASE:1.2
	OPENBSD_3_9:1.2.0.22
	OPENBSD_3_9_BASE:1.2
	OPENBSD_3_8:1.2.0.20
	OPENBSD_3_8_BASE:1.2
	OPENBSD_3_7:1.2.0.18
	OPENBSD_3_7_BASE:1.2
	OPENBSD_3_6:1.2.0.16
	OPENBSD_3_6_BASE:1.2
	OPENBSD_3_5:1.2.0.14
	OPENBSD_3_5_BASE:1.2
	OPENBSD_3_4:1.2.0.12
	OPENBSD_3_4_BASE:1.2
	OPENBSD_3_3:1.2.0.10
	OPENBSD_3_3_BASE:1.2
	OPENBSD_3_2:1.2.0.8
	OPENBSD_3_2_BASE:1.2
	OPENBSD_3_1:1.2.0.6
	OPENBSD_3_1_BASE:1.2
	OPENBSD_3_0:1.2.0.4
	OPENBSD_3_0_BASE:1.2
	OPENBSD_2_9_TRACKING_SWITCH:1.2
	OPENBSD_2_9:1.2.0.2
	OPENBSD_2_9_BASE:1.2
	naddy_20010116:1.1.1.1
	naddy:1.1.1;
locks; strict;
comment	@# @;


1.2
date	2001.01.19.18.50.14;	author naddy;	state Exp;
branches;
next	1.1;

1.1
date	2001.01.16.21.31.44;	author naddy;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2001.01.16.21.31.44;	author naddy;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Update to 0.3; submitted by maintainer.
- Added "Locked" memory capabilities via config file.
- General code clean-up.
- Keyboard support.
@
text
@$OpenBSD: patch-wmcalcswitch_c,v 1.1.1.1 2001/01/16 21:31:44 naddy Exp $
--- wmcalcswitch.c.orig	Fri Nov 10 02:05:00 2000
+++ wmcalcswitch.c	Fri Jan 19 18:33:44 2001
@@@@ -388,8 +388,8 @@@@ ButtonArea getboundaries(char ch) {
 int write_config(void) {
   extern int Verbose;
   extern double MemArray[];
-  extern char configfile[];
-  extern char tempfile[];
+  extern char configfile[]; 
+  extern char tempfile[CONFIGFILEMAX];
   extern char *CfgVarList[];
   FILE *fp, *fptmp;
   char *line = NULL;
@@@@ -406,8 +406,8 @@@@ int write_config(void) {
   /* Open Temporary File */
   if ((fptmp = fopen(tempfile, "w")) == NULL) {  // Can't open file in /tmp
     fprintf(stderr, "%s: Temporary File Open Failed\n", tempfile);
-    strcpy(tempfile, getenv("HOME"));
-    strcat(tempfile, "wmcalc.tmp");
+    strlcpy(tempfile, getenv("HOME"), sizeof(tempfile));
+    strlcat(tempfile, "wmcalc.tmp", sizeof(tempfile));
     if ((fptmp = fopen(tempfile, "w")) == NULL) {  // Can't open file in HOME
       fprintf(stderr, "%s: Temporary File Open Failed\n", tempfile);
       return(ERR_TMP_FILE_FAILED);
@@@@ -439,7 +439,7 @@@@ int write_config(void) {
 
   /* Copy temp file over original */
   /* Note:  If changing command, make sure to adjust size of string above!! */
-  sprintf(movefilecmd, "mv -f %s %s\n", tempfile, configfile); 
+  snprintf(movefilecmd, sizeof(movefilecmd), "mv -f %s %s\n", tempfile, configfile); 
   err_code = system(movefilecmd);
   
   if(Verbose) printf("New config file written.\n");
@@@@ -468,7 +468,7 @@@@ int read_config(void) {
   extern char *CfgVarList[];
   extern char ImagChar;
   extern char configfile[];
-  extern char SysCalcCmd[];
+  extern char SysCalcCmd[CALC_CMD_SIZE];
   FILE *fp;
   int i = 0;
   int err_code = OKAY;
@@@@ -561,7 +561,7 @@@@ int read_config(void) {
 
 	  case CALC_LABEL:
 	    /* Set external calculator start command */
-	    strcpy(SysCalcCmd, cfg_var_ptr);
+	    strlcpy(SysCalcCmd, cfg_var_ptr, sizeof(SysCalcCmd));
 	    if (Verbose)
 	      printf("Assign Calc Command: %s\n", cfg_var_ptr);
 	    break;
@


1.1
log
@Initial revision
@
text
@d1 5
a5 4
$OpenBSD: $
--- wmcalcswitch.c.orig	Tue Oct 31 03:15:36 2000
+++ wmcalcswitch.c	Fri Jan 12 11:58:31 2001
@@@@ -347,7 +347,7 @@@@ int write_config(void) {
d8 1
a8 1
   extern char configfile[];
d10 1
d15 1
a15 1
@@@@ -364,8 +364,8 @@@@ int write_config(void) {
d25 2
a26 2
       return(BAD_FILE);
@@@@ -397,7 +397,7 @@@@ int write_config(void) {
d31 1
a31 1
+  snprintf(movefilecmd, sizeof(movefilecmd), "mv -f %s %s", tempfile, configfile); 
d34 2
a35 2
   if (err_code) {
@@@@ -418,7 +418,7 @@@@ int read_config(void) {
d44 2
a45 1
@@@@ -507,7 +507,7 @@@@ int read_config(void) {
d47 1
a47 2
 	    if (Verbose)
 	      fprintf(stderr, "Assign Calc Command:\n%s", cfg_var_ptr);
d50 2
a52 2
 
 	  default:
@


1.1.1.1
log
@Import wmcalc-0.21.
Submitted by Peter Stromberg <home@@wilfried.net>.

wmcalc is a program designed to act as a simple four-function
calculator.  It is different from other calculator programs,
however in that it is designed to take up very little desktop
space.
@
text
@@
