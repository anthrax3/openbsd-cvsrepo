head	1.3;
access;
symbols
	OPENBSD_6_1:1.2.0.4
	OPENBSD_6_1_BASE:1.2
	OPENBSD_6_0:1.2.0.2
	OPENBSD_6_0_BASE:1.2
	OPENBSD_5_9:1.1.0.52
	OPENBSD_5_9_BASE:1.1
	OPENBSD_5_8:1.1.0.54
	OPENBSD_5_8_BASE:1.1
	OPENBSD_5_7:1.1.0.50
	OPENBSD_5_7_BASE:1.1
	OPENBSD_5_6:1.1.0.48
	OPENBSD_5_6_BASE:1.1
	OPENBSD_5_5:1.1.0.46
	OPENBSD_5_5_BASE:1.1
	OPENBSD_5_4:1.1.0.44
	OPENBSD_5_4_BASE:1.1
	OPENBSD_5_3:1.1.0.42
	OPENBSD_5_3_BASE:1.1
	OPENBSD_5_2:1.1.0.40
	OPENBSD_5_2_BASE:1.1
	OPENBSD_5_1_BASE:1.1
	OPENBSD_5_1:1.1.0.38
	OPENBSD_5_0:1.1.0.36
	OPENBSD_5_0_BASE:1.1
	OPENBSD_4_9:1.1.0.34
	OPENBSD_4_9_BASE:1.1
	OPENBSD_4_8:1.1.0.32
	OPENBSD_4_8_BASE:1.1
	OPENBSD_4_7:1.1.0.30
	OPENBSD_4_7_BASE:1.1
	OPENBSD_4_6:1.1.0.28
	OPENBSD_4_6_BASE:1.1
	OPENBSD_4_5:1.1.0.26
	OPENBSD_4_5_BASE:1.1
	OPENBSD_4_4:1.1.0.24
	OPENBSD_4_4_BASE:1.1
	OPENBSD_4_3:1.1.0.22
	OPENBSD_4_3_BASE:1.1
	OPENBSD_4_2:1.1.0.20
	OPENBSD_4_2_BASE:1.1
	OPENBSD_4_1:1.1.0.18
	OPENBSD_4_1_BASE:1.1
	OPENBSD_4_0:1.1.0.16
	OPENBSD_4_0_BASE:1.1
	OPENBSD_3_9:1.1.0.14
	OPENBSD_3_9_BASE:1.1
	OPENBSD_3_8:1.1.0.12
	OPENBSD_3_8_BASE:1.1
	OPENBSD_3_7:1.1.0.10
	OPENBSD_3_7_BASE:1.1
	OPENBSD_3_6:1.1.0.8
	OPENBSD_3_6_BASE:1.1
	OPENBSD_3_5:1.1.0.6
	OPENBSD_3_5_BASE:1.1
	OPENBSD_3_4:1.1.0.4
	OPENBSD_3_4_BASE:1.1
	OPENBSD_3_3:1.1.0.2
	OPENBSD_3_3_BASE:1.1;
locks; strict;
comment	@# @;


1.3
date	2017.05.06.11.53.31;	author fcambus;	state dead;
branches;
next	1.2;
commitid	xDr9itYYFZgv6uIX;

1.2
date	2016.03.16.22.22.34;	author naddy;	state Exp;
branches;
next	1.1;
commitid	XPRmNQxm7zUobUXP;

1.1
date	2002.11.23.07.25.59;	author pvalchev;	state Exp;
branches;
next	;


desc
@@


1.3
log
@Remove math/xspread.

Our xspread port is from 1995. This is a modifed version of sc 6.22
that runs under X, there is no upstream anymore.

We have sc 7.16 in the ports tree, so this should be used instead.

OK jca@@
@
text
@$OpenBSD: patch-interp_c,v 1.2 2016/03/16 22:22:34 naddy Exp $
--- interp.c.orig	Tue Nov  7 03:17:26 1995
+++ interp.c	Wed Mar 16 23:20:06 2016
@@@@ -32,9 +32,8 @@@@
 #include <signal.h>
 #include <setjmp.h>
 #include <ctype.h>
+#include <errno.h>
 
-extern int errno;		/* set by math functions */
-
 #include "sc.h"
 
 #ifdef HAVE_X11_X_H
@@@@ -103,7 +102,7 @@@@ static char *	docapital PROTO((char *));
 static char *	docase PROTO((int, char *));
 static char *	docat PROTO((char *, char *));
 static double	docount PROTO((int, int, int, int));
-static char *	dodate PROTO((long));
+static char *	dodate PROTO((time_t));
 static double	doeqs PROTO((char *, char *));
 static char *	doext PROTO((char *, double));
 static char *	dofmt PROTO((char *, double));
@@@@ -508,7 +507,7 @@@@ double
 dodts(mo, day, yr)
 int mo, day, yr;
 {
-    long trial;
+    time_t trial;
     register struct tm *tp; 
     register int i;
     register long jdate;
@@@@ -516,7 +515,7 @@@@ int mo, day, yr;
     mdays[1] = 28 + (yr%4 == 0);
 
     if (mo < 1 || mo > 12 || day < 1 || day > mdays[--mo] ||
-		yr > 1999 || yr < 1970) {
+		yr > 2099 || yr < 1970) {
 	scerror("@@dts: invalid argument");
 	cellerror = CELLERROR;
 	return(0.0);
@@@@ -577,11 +576,11 @@@@ double when;
 	static long t_cache;
 	static struct tm tm_cache;
 	struct tm *tp;
-	long tloc;
+	time_t tloc;
 
 	if (which == NOW) 
-	    return (double)time((long *)0);
-	tloc = (long)when;
+	    return (double)time(NULL);
+	tloc = (time_t)when;
 
 	if (tloc != t_cache) {
 	    tp = localtime(&tloc);
@@@@ -1002,7 +1001,7 @@@@ register char *s1, *s2;
 
 static char *
 dodate(tloc)
-long tloc;
+time_t tloc;
 {
     char *tp;
     char *p;
@@@@ -1274,7 +1273,7 @@@@ register struct enode *se;
 	case IF:
 	case '?':    return(eval(se->e.o.left) ? seval(se->e.o.right->e.o.left)
 					     : seval(se->e.o.right->e.o.right));
-	case DATE:   return(dodate((long)(eval(se->e.o.right))));
+	case DATE:   return(dodate((eval(se->e.o.right))));
 	case FMT:    return(dofmt(seval(se->e.o.left), eval(se->e.o.right)));
 	case UPPER:  return(docase(UPPER, seval(se->e.o.right)));
 	case LOWER:  return(docase(LOWER, seval(se->e.o.right)));
@


1.2
log
@fix errno declaration
also time_t and miscellaneous other fixes
@
text
@d1 1
a1 1
$OpenBSD: patch-interp_c,v 1.1 2002/11/23 07:25:59 pvalchev Exp $
@


1.1
log
@Some updates from Sebastian Stark <seb@@todesplanet.de>:
o put examples into ${PREFIX}/share/examples/xspread
o remove unnecessary build documentation from PLIST
o use ${MASTER_SITE_OPENBSD} since the original ftp server refuses
  anonymous connections
o add comment about license
o regen patches with update-patches
@
text
@d1 1
a1 1
$OpenBSD$
d3 31
a33 2
+++ interp.c	Fri Nov 22 15:31:18 2002
@@@@ -516,7 +516,7 @@@@ int mo, day, yr;
d42 33
@

