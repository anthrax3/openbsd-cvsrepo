head	1.7;
access;
symbols
	OPENBSD_5_7:1.5.0.2
	OPENBSD_5_7_BASE:1.5
	OPENBSD_5_6:1.3.0.2
	OPENBSD_5_6_BASE:1.3
	OPENBSD_5_5:1.2.0.14
	OPENBSD_5_5_BASE:1.2
	OPENBSD_5_4:1.2.0.12
	OPENBSD_5_4_BASE:1.2
	OPENBSD_5_3:1.2.0.10
	OPENBSD_5_3_BASE:1.2
	OPENBSD_5_2:1.2.0.8
	OPENBSD_5_2_BASE:1.2
	OPENBSD_5_1_BASE:1.2
	OPENBSD_5_1:1.2.0.6
	OPENBSD_5_0:1.2.0.4
	OPENBSD_5_0_BASE:1.2
	OPENBSD_4_9:1.2.0.2
	OPENBSD_4_9_BASE:1.2
	OPENBSD_4_8:1.1.0.6
	OPENBSD_4_8_BASE:1.1
	OPENBSD_4_7:1.1.0.4
	OPENBSD_4_7_BASE:1.1
	OPENBSD_4_6:1.1.0.2
	OPENBSD_4_6_BASE:1.1;
locks; strict;
comment	@# @;


1.7
date	2015.07.22.12.37.50;	author benoit;	state dead;
branches;
next	1.6;
commitid	fSKAHIEwsjO7c3bt;

1.6
date	2015.07.03.08.21.23;	author benoit;	state Exp;
branches;
next	1.5;
commitid	O3Xv6lRxTNknGTKQ;

1.5
date	2014.12.26.08.42.02;	author benoit;	state Exp;
branches;
next	1.4;
commitid	PwZdSzjqJnpE3xDY;

1.4
date	2014.09.03.09.46.46;	author benoit;	state Exp;
branches;
next	1.3;
commitid	oYcJyBPM0nQKwRRf;

1.3
date	2014.03.15.09.13.13;	author benoit;	state Exp;
branches;
next	1.2;

1.2
date	2010.10.24.09.38.10;	author landry;	state Exp;
branches;
next	1.1;

1.1
date	2009.05.22.09.03.26;	author benoit;	state Exp;
branches;
next	;


desc
@@


1.7
log
@Update to ntl-9.3.0.
@
text
@$OpenBSD: patch-src_tools_c,v 1.6 2015/07/03 08:21:23 benoit Exp $
--- src/tools.c.orig	Sat May 23 16:44:51 2015
+++ src/tools.c	Wed Jun 24 08:33:28 2015
@@@@ -6,6 +6,7 @@@@
 
 #include <NTL/new.h>
 
+#include <cstdio>
 
 void _ntl_abort_cxx_callback()
 {
@@@@ -17,9 +18,34 @@@@ NTL_START_IMPL
 
 NTL_THREAD_LOCAL void (*ErrorCallback)() = 0;
 
+/*
+  The following code differs from vanilla NTL 5.4.2.
 
+   We add a SetErrorCallbackFunction(). This sets a global callback function _function_,
+   which gets called with parameter _context_ and an error message string whenever Error()
+   gets called.
+
+   Note that if the custom error handler *returns*, then NTL will dump the error message
+   back to stderr and abort() as it habitually does.
+
+   -- David Harvey (2008-04-12)
+*/
+
+void (*ErrorCallbackFunction)(const char*, void*) = NULL;
+void *ErrorCallbackContext = NULL;
+
+
+void SetErrorCallbackFunction(void (*function)(const char*, void*), void *context)
+{
+   ErrorCallbackFunction = function;
+   ErrorCallbackContext = context;
+}
+ 
 void TerminalError(const char *s)
 {
+   if (ErrorCallbackFunction != NULL)
+       ErrorCallbackFunction(s, ErrorCallbackContext);
+
    cerr << s << "\n";
    _ntl_abort();
 }
@


1.6
log
@Update to ntl-9.2.0.
@
text
@d1 1
a1 1
$OpenBSD: patch-src_tools_c,v 1.5 2014/12/26 08:42:02 benoit Exp $
@


1.5
log
@Update to ntl-8.0.0.
@
text
@d1 3
a3 3
$OpenBSD$
--- src/tools.c.orig	Wed Dec 24 20:21:37 2014
+++ src/tools.c	Thu Dec 25 07:51:07 2014
d12 1
a12 1
@@@@ -17,9 +18,34 @@@@
@


1.4
log
@Update ntl to 6.2.1.
@
text
@d2 2
a3 2
--- src/tools.c.orig	Fri Aug 22 05:06:47 2014
+++ src/tools.c	Mon Aug 25 09:01:51 2014
d17 1
a17 1
+   The following code differs from vanilla NTL 5.4.2.
d38 2
a39 2
+
 void Error(const char *s)
d42 2
a43 2
+      ErrorCallbackFunction(s, ErrorCallbackContext);
+      
@


1.3
log
@Update to ntl 6.1.0.
@
text
@d2 3
a4 4
--- src/tools.c.orig	Fri Aug 14 14:53:11 2009
+++ src/tools.c	Sun Oct 24 10:56:43 2010
@@@@ -13,13 +13,42 @@@@ void _ntl_abort_cxx_callback(void)
 }
d6 1
a8 2
+
 NTL_START_IMPL
d10 3
a12 1
 void (*ErrorCallback)() = 0;
d14 1
d18 1
a18 1
+
a38 1
+
d43 1
a43 1
+
@


1.2
log
@Pass ${LIBTOOL} to src/DoConfig so that it correctly uses ports libtool.
Regen patches and switch to newer LIB_DEPENDS while here.
@
text
@d1 1
@


1.1
log
@- update to ntl 5.5.1
- add SHARED_LIBS
- change maintainer
- regen PLIST

ok ajacoutot@@
@
text
@d1 4
a4 3
--- src/tools.c.orig	Sat Mar 14 18:37:45 2009
+++ src/tools.c	Sat Mar 14 18:37:57 2009
@@@@ -5,6 +5,8 @@@@
a5 1
 #include <NTL/new.h>
d11 2
a13 4
@@@@ -8,8 +8,35 @@@@
 NTL_START_IMPL


d44 1
a44 1
    abort();
@

