head	1.3;
access;
symbols
	OPENBSD_6_2:1.3.0.2
	OPENBSD_6_2_BASE:1.3
	OPENBSD_6_1:1.2.0.16
	OPENBSD_6_1_BASE:1.2
	OPENBSD_6_0:1.2.0.14
	OPENBSD_6_0_BASE:1.2
	OPENBSD_5_9:1.2.0.10
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.2.0.12
	OPENBSD_5_8_BASE:1.2
	OPENBSD_5_7:1.2.0.8
	OPENBSD_5_7_BASE:1.2
	OPENBSD_5_6:1.2.0.6
	OPENBSD_5_6_BASE:1.2
	OPENBSD_5_5:1.2.0.4
	OPENBSD_5_5_BASE:1.2
	OPENBSD_5_4:1.2.0.2
	OPENBSD_5_4_BASE:1.2
	OPENBSD_5_3:1.1.1.1.0.2
	OPENBSD_5_3_BASE:1.1.1.1
	bentley_20121018:1.1.1.1
	bentley:1.1.1;
locks; strict;
comment	@# @;


1.3
date	2017.05.12.14.38.18;	author benoit;	state Exp;
branches;
next	1.2;
commitid	Fb9vaUNNukejPLIO;

1.2
date	2013.03.22.18.10.59;	author naddy;	state Exp;
branches;
next	1.1;

1.1
date	2012.10.20.04.34.32;	author bentley;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2012.10.20.04.34.32;	author bentley;	state Exp;
branches;
next	;


desc
@@


1.3
log
@Update to foma-0.9.17.
@
text
@$OpenBSD: patch-Makefile,v 1.2 2013/03/22 18:10:59 naddy Exp $

Generate shared libraries correctly.

Index: Makefile
--- Makefile.orig
+++ Makefile
@@@@ -18,6 +18,7 @@@@ FLOOKUPLDFLAGS = libfoma.a -lz
 CFLAGS = -O3 -Wall -D_GNU_SOURCE -std=c99 -fvisibility=hidden -fPIC
 FOMAOBJS = foma.o stack.o iface.o lex.interface.o
 LIBOBJS = int_stack.o define.o determinize.o apply.o rewrite.o lexcread.o topsort.o flags.o minimize.o reverse.o extract.o sigma.o io.o structures.o constructions.o coaccessible.o utf8.o spelling.o dynarray.o mem.o stringhash.o trie.o lex.lexc.o lex.yy.o lex.cmatrix.o regex.tab.o
+SHLIBOBJS = $(LIBOBJS:.o=.so)
 
 all: libfoma foma flookup cgflookup
 
@@@@ -64,10 +65,10 @@@@ LIBS = $(SHAREDLIBV) $(STATICLIB)
 
 libfoma: $(SHAREDLIBV)
 
-$(SHAREDLIBV): $(LIBOBJS)
+$(SHAREDLIBV): $(LIBOBJS) $(SHLIBOBJS)
 	$(AR) $(ARFLAGS) $(STATICLIB) $(LIBOBJS)
 	$(RANLIB) $(STATICLIB)
-	$(CC) $(CFLAGS) -shared -Wl,$(DFLAG),$(SHAREDLIBM) -o $(SHAREDLIBV) $(LIBOBJS) $(LDFLAGS)
+	$(CC) $(CFLAGS) -shared -o $(SHAREDLIBV) $(SHLIBOBJS) $(LDFLAGS)
 
 install: foma libfoma
 	-@@if [ ! -d $(exec_prefix) ]; then mkdir -p $(exec_prefix); fi
@@@@ -81,14 +82,15 @@@@ install: foma libfoma
 	cd $(libdir); chmod 755 $(LIBS); \
 	if test -f $(libdir)/$(SHAREDLIB); then rm  $(libdir)/$(SHAREDLIB); fi
 	if test -f $(libdir)/$(SHAREDLIBM); then rm  $(libdir)/$(SHAREDLIBM); fi
-	cd $(libdir); ln -s $(SHAREDLIBV) $(SHAREDLIB); cd $(libdir);	\
-	ln -s $(SHAREDLIBV) $(SHAREDLIBM); (ldconfig || true)		\
-	>/dev/null 2>&1; \
 
 $(OBJS): foma.h
 
 .c.o:
 	$(CC) $(CFLAGS) -c $< -o $@@
+
+.SUFFIXES: .so
+.c.so:
+	$(CC) $(CFLAGS) -fPIC -c $< -o $@@
 
 lex.yy.c: regex.l regex.tab.h
 	$(LEX) regex.l
@


1.2
log
@really generate the shared library correctly
@
text
@d1 1
a1 1
$OpenBSD: patch-Makefile,v 1.1.1.1 2012/10/20 04:34:32 bentley Exp $
d5 3
a7 2
--- Makefile.orig	Tue Dec 13 21:28:25 2011
+++ Makefile	Fri Mar 22 19:09:25 2013
d16 1
a16 1
@@@@ -54,10 +55,10 @@@@ LIBS = $(SHAREDLIBV) $(STATICLIB)
d29 1
a29 1
@@@@ -71,14 +72,15 @@@@ install: foma libfoma
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
$OpenBSD$
d5 16
a20 4
--- Makefile.orig	Wed Dec 14 00:28:25 2011
+++ Makefile	Fri Oct 12 23:56:56 2012
@@@@ -57,7 +57,7 @@@@ libfoma: $(SHAREDLIBV)
 $(SHAREDLIBV): $(LIBOBJS)
d24 1
a24 1
+	$(CC) $(CFLAGS) -shared -o $(SHAREDLIBV) $(LIBOBJS) $(LDFLAGS)
d28 1
a28 1
@@@@ -71,9 +71,6 @@@@ install: foma libfoma
d38 9
@


1.1.1.1
log
@Import foma-0.9.16.

Foma is a compiler, programming language, and C library for constructing
finite-state automata and transducers for various uses. It has specific
support for many natural language processing applications such as
producing morphological analyzers. Although NLP applications are
probably the main use of foma, it is sufficiently generic to use for a
large number of purposes.

ok jeremy@@ pirofti@@
@
text
@@
