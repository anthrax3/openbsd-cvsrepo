head	1.13;
access;
symbols
	OPENBSD_6_2:1.13.0.2
	OPENBSD_6_2_BASE:1.13
	OPENBSD_6_1:1.11.0.4
	OPENBSD_6_1_BASE:1.11
	OPENBSD_6_0:1.11.0.2
	OPENBSD_6_0_BASE:1.11
	OPENBSD_5_9:1.10.0.2
	OPENBSD_5_9_BASE:1.10
	OPENBSD_5_8:1.9.0.8
	OPENBSD_5_8_BASE:1.9
	OPENBSD_5_7:1.9.0.4
	OPENBSD_5_7_BASE:1.9
	OPENBSD_5_6:1.9.0.2
	OPENBSD_5_6_BASE:1.9
	OPENBSD_5_5:1.8.0.2
	OPENBSD_5_5_BASE:1.8
	OPENBSD_5_4:1.6.0.2
	OPENBSD_5_4_BASE:1.6
	OPENBSD_5_3:1.2.0.2
	OPENBSD_5_3_BASE:1.2;
locks; strict;
comment	@# @;


1.13
date	2017.05.12.14.19.50;	author sthen;	state Exp;
branches;
next	1.12;
commitid	AT7KOFnaeq5RZjXS;

1.12
date	2017.05.10.10.58.36;	author sthen;	state Exp;
branches;
next	1.11;
commitid	qKj5lYSkFXfI4xXq;

1.11
date	2016.03.16.15.54.25;	author naddy;	state Exp;
branches;
next	1.10;
commitid	mUlswZW6SrG0Uwdw;

1.10
date	2016.01.20.16.19.24;	author sthen;	state Exp;
branches;
next	1.9;
commitid	R8RGX3RiihLIaWfi;

1.9
date	2014.05.19.08.06.30;	author sthen;	state Exp;
branches;
next	1.8;

1.8
date	2013.11.05.15.49.59;	author sthen;	state Exp;
branches;
next	1.7;

1.7
date	2013.11.01.10.20.00;	author sthen;	state Exp;
branches;
next	1.6;

1.6
date	2013.05.16.21.53.31;	author sthen;	state Exp;
branches;
next	1.5;

1.5
date	2013.05.10.16.56.39;	author sthen;	state Exp;
branches;
next	1.4;

1.4
date	2013.05.09.07.33.17;	author sthen;	state Exp;
branches;
next	1.3;

1.3
date	2013.03.11.11.41.33;	author espie;	state Exp;
branches;
next	1.2;

1.2
date	2012.12.14.09.52.16;	author sthen;	state Exp;
branches;
next	1.1;

1.1
date	2012.09.25.21.58.46;	author sthen;	state Exp;
branches;
next	;


desc
@@


1.13
log
@Oops, remove BUILD_DEPENDS which causes a loop because asterisk RUN_DEPENDS
on some of the sound files. Reported by dhill.
@
text
@# $OpenBSD: asterisk-sounds.port.mk,v 1.12 2017/05/10 10:58:36 sthen Exp $

# sync with asterisk-sounds/Makefile and asterisk-sounds/*sounds/Makefile
MODAS_CODECS ?=	gsm alaw ulaw g722 g729 wav # sln16 siren7 siren14

CATEGORIES +=	telephony
DISTNAME =	${MODAS_NAME}-${MODAS_LANG:C/(.+)/\1-/}${MODAS_CODEC}-${MODAS_VER}
FULLPKGNAME ?=  ${DISTNAME}
MASTER_SITES ?= http://downloads.asterisk.org/pub/telephony/sounds/releases/
HOMEPAGE =	http://www.asterisk.org/
COMMENT =	${MODAS_DESC}

EXTRACT_ONLY =
NO_BUILD =	Yes
NO_TEST =	Yes
PKG_ARCH =	*

_LN-en_AU =	Australian English
_LN-en =	English
_LN-es =	Spanish
_LN-fr =	French
_LN-it =	Italian
_LN-ru =	Russian

MODAS_LANGNAME = ${_LN-${MODAS_LANG}}
MODAS_CODEC =	${FLAVOR}

FLAVORS ?=	${MODAS_CODECS}
FLAVOR ?=	gsm

.if defined(MODAS_LANG)
.  for c in ${MODAS_CODECS}
SUPDISTFILES += ${MODAS_NAME}-${MODAS_LANG}-$c-${MODAS_VER}${EXTRACT_SUFX}
.  endfor
.else
.  for c in ${MODAS_CODECS}
SUPDISTFILES += ${MODAS_NAME}-$c-${MODAS_VER}${EXTRACT_SUFX}
.  endfor
.endif

_T = ${MODAS_NAME:S/asterisk-//}

MODAS_INST ?=	share/asterisk/sounds/${MODAS_LANG}
SUBST_VARS +=	MODAS_INST L MODAS_LANGNAME MODAS_CODEC MODAS_VER

do-install:
	${INSTALL_DATA_DIR} ${PREFIX}/${MODAS_INST}
	${GZIP_CMD} -dc ${FULLDISTDIR}/${DISTNAME}${EXTRACT_SUFX} | \
	    ${TAR} xf - -C ${PREFIX}/${MODAS_INST}
@


1.12
log
@set BUILD_DEPENDS on telephony/asterisk, there's no point packaging these
(fairly large) sound files on arch where asterisk doesn't work.
@
text
@d1 1
a1 1
# $OpenBSD: asterisk-sounds.port.mk,v 1.11 2016/03/16 15:54:25 naddy Exp $
a15 1
BUILD_DEPENDS =	telephony/asterisk,-main
@


1.11
log
@the rationale for marking sound files SHARED_ONLY no longer applies
@
text
@d1 1
a1 1
# $OpenBSD: asterisk-sounds.port.mk,v 1.10 2016/01/20 16:19:24 sthen Exp $
d16 1
@


1.10
log
@Update to the 1.5 versions of asterisk-core-sounds and asterisk-extra-sounds
where available. core-sounds for a couple of languages aren't there yet so
distinfo files and infra have been rearranged to cope.
@
text
@d1 1
a1 1
# $OpenBSD: asterisk-sounds.port.mk,v 1.9 2014/05/19 08:06:30 sthen Exp $
a16 6

# strictly speaking not, as they are just sound files, but packaging
# these on !shared arch is just a total waste of cycles as asterisk itself
# is SHARED_ONLY. can't use a BDEP on telephony/asterisk for this as some
# sound files are RDEP of asterisk.
SHARED_ONLY =	Yes
@


1.9
log
@these ports just repackage audio files from an upstream tar, so won't ever
need to be patched - so just unpack them directly in WRKINST to save an extra
copy operation.
@
text
@d1 1
a1 1
# $OpenBSD: asterisk-sounds.port.mk,v 1.8 2013/11/05 15:49:59 sthen Exp $
d37 1
a37 1
.if defined(MODAS_LANGS)
d39 1
a39 3
.    for l in ${MODAS_LANGS}
SUPDISTFILES += ${MODAS_NAME}-$l-$c-${MODAS_VER}${EXTRACT_SUFX}
.    endfor
@


1.8
log
@revert to the previous SHARED_ONLY=Yes for this instead of build dep on
asterisk (which itself has a run dep on some files produced using this module)
@
text
@d1 1
a1 1
# $OpenBSD: asterisk-sounds.port.mk,v 1.6 2013/05/16 21:53:31 sthen Exp $
d13 1
a53 4
do-extract:
	mkdir ${WRKDIST} && cd ${WRKDIST} && \
	${GZIP_CMD} -dc ${FULLDISTDIR}/${DISTNAME}${EXTRACT_SUFX} | ${TAR} xf -

d56 2
a57 1
	cd ${WRKDIST}; pax -rw ./ ${PREFIX}/${MODAS_INST}
@


1.7
log
@Add a build dep on asterisk, not strictly necessary, but these are only
useful on arches which have it, so this saves cycles/mirror space.
This replaces a previous SHARED_ONLY since many classic machines do have
shared libraries.
@
text
@d18 4
a21 3
# these on arch which don't build asterisk is a waste of cycles on build
# machines and disk space on mirrors
BUILD_DEPENDS =	telephony/asterisk
@


1.6
log
@update to newer Asterisk sound files, adding:

(core)
- Italian language prompts for core sounds
- missing prompts for VoiceMailMain application in Russian

(extra)
- various fixed files in extra-sounds
- various new files in extra-sounds (some in French, many in English)
- many files duplicated from core-sounds have been removed
- note: "an-error-has-occured" has been renamed "an-error-has-occurred"

Additionally the packages now install the text files detailing changes
and a text description of the font files (renamed to avoid conflicts
between flavours).

sln16 versions have been dropped from packages for now to save a
few hundred MB per arch on the mirrors, g729 versions have been added
in their place.
@
text
@d1 1
a1 1
# $OpenBSD: asterisk-sounds.port.mk,v 1.5 2013/05/10 16:56:39 sthen Exp $
d13 3
a15 3
NO_BUILD=	Yes
NO_TEST=	Yes
PKG_ARCH=	*
d18 3
a20 3
# these on !shared arch is just a total waste of cycles as asterisk itself
# is SHARED_ONLY.
SHARED_ONLY =	Yes
@


1.5
log
@Adjust the (slightly awkward) construction of DISTNAME so that setting
REVISION doesn't change the stem of the package name. Came after some head
scratching after naddy@@ reported a PLIST_DB change to telephony/asterisk's
@@depend lines which happened after I bumped REVISION on the asterisk-sounds
ports when I tweaked CATEGORIES.
@
text
@d1 1
a1 1
# $OpenBSD: asterisk-sounds.port.mk,v 1.4 2013/05/09 07:33:17 sthen Exp $
d3 2
a4 6
# strictly speaking not, as they are just sound files, but packaging
# these on !shared arch is just a total waste of cycles as asterisk itself
# is SHARED_ONLY.
SHARED_ONLY =	Yes

MODAS_CODECS ?=	gsm alaw ulaw g722 sln16 wav # g729 siren7 siren14
d17 5
d26 1
@


1.4
log
@zap extra CATEGORIES entry for these ports, it's not really useful
@
text
@d1 1
a1 1
# $OpenBSD: asterisk-sounds.port.mk,v 1.3 2013/03/11 11:41:33 espie Exp $
d11 1
a11 2
_N =		${MODAS_NAME}-${MODAS_LANG}-${MODAS_CODEC}-${MODAS_VER}
DISTNAME =	${_N:S/--/-/g:S/-$//}
@


1.3
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: asterisk-sounds.port.mk,v 1.2 2012/12/14 09:52:16 sthen Exp $
d10 1
a10 1
CATEGORIES +=	telephony telephony/asterisk-sounds
@


1.2
log
@mark the Asterisk sound files as SHARED_ONLY; they are only useful with
Asterisk which is itself SHARED_ONLY.
@
text
@d1 1
a1 1
# $OpenBSD: asterisk-sounds.port.mk,v 1.1 2012/09/25 21:58:46 sthen Exp $
d19 1
a19 1
NO_REGRESS=	Yes
@


1.1
log
@revamp asterisk sound-file packaging.

- strip core-sounds and moh out of the main asterisk package,
they change comparatively rarely.

- provide all available languages.

- provide multiple codecs for all files, replacing the asterisk-native-sounds
package which only provided ulaw versions of the asterisk 1.4 files, ports
laid out to permit parallel building.

- the old asterisk-sounds package providing additional sound files beyond
the core ones is now "extra-sounds" modelled after the filename of the
distributed files.
@
text
@d1 6
a6 1
# $OpenBSD$
@

