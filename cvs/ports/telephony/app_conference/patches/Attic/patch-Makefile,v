head	1.4;
access;
symbols
	OPENBSD_4_6:1.3.0.8
	OPENBSD_4_6_BASE:1.3
	OPENBSD_4_5:1.3.0.6
	OPENBSD_4_5_BASE:1.3
	OPENBSD_4_4:1.3.0.4
	OPENBSD_4_4_BASE:1.3
	OPENBSD_4_3:1.3.0.2
	OPENBSD_4_3_BASE:1.3
	OPENBSD_4_2:1.2.0.8
	OPENBSD_4_2_BASE:1.2
	OPENBSD_4_1:1.2.0.6
	OPENBSD_4_1_BASE:1.2
	OPENBSD_4_0:1.2.0.4
	OPENBSD_4_0_BASE:1.2
	OPENBSD_3_9:1.2.0.2
	OPENBSD_3_9_BASE:1.2
	jolan_20051110:1.1.1.1
	jolan:1.1.1;
locks; strict;
comment	@# @;


1.4
date	2009.12.13.12.27.00;	author sthen;	state dead;
branches;
next	1.3;

1.3
date	2007.09.06.12.31.31;	author sthen;	state Exp;
branches;
next	1.2;

1.2
date	2005.11.29.03.40.38;	author jolan;	state Exp;
branches;
next	1.1;

1.1
date	2005.11.10.21.13.11;	author jolan;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2005.11.10.21.13.11;	author jolan;	state Exp;
branches;
next	;


desc
@@


1.4
log
@put chan_unistim and app_conference into the Attic
@
text
@$OpenBSD: patch-Makefile,v 1.3 2007/09/06 12:31:31 sthen Exp $
--- Makefile.orig	Tue Jul 10 00:58:58 2007
+++ Makefile	Tue Jul 10 01:09:01 2007
@@@@ -18,8 +18,8 @@@@
 #
 
 INSTALL_PREFIX :=
-INSTALL_MODULES_DIR := $(INSTALL_PREFIX)/usr/lib/asterisk/modules
-INSTALL_SOUNDS_DIR := $(INSTALL_PREFIX)/var/lib/asterisk/sounds
+INSTALL_MODULES_DIR := $(PREFIX)/lib/asterisk/modules
+INSTALL_SOUNDS_DIR := $(PREFIX)/share/asterisk/sounds
 
 ASTERISK_INCLUDE_DIR ?= ../asterisk/include
 
@@@@ -47,7 +47,7 @@@@ INSTALL = install
 INCLUDE = -I$(ASTERISK_INCLUDE_DIR)
 DEBUG := -g
 
-CFLAGS = -pipe -Wall -Wmissing-prototypes -Wmissing-declarations -MD -MP $(DEBUG)
+CFLAGS += -fPIC -pipe -Wall -Wmissing-prototypes -Wmissing-declarations -MD -MP
 CPPFLAGS = $(INCLUDE) -D_REENTRANT -D_GNU_SOURCE
 #CFLAGS += -O2
 #CFLAGS += -O3 -march=pentium3 -msse -mfpmath=sse,387 -ffast-math
@@@@ -59,8 +59,8 @@@@ CPPFLAGS = $(INCLUDE) -D_REENTRANT -D_GNU_SOURCE
 # adding -msse -mfpmath=sse has little effect.
 #CFLAGS += -O3 -msse -mfpmath=sse
 #CFLAGS += $(shell if $(CC) -march=$(PROC) -S -o /dev/null -xc /dev/null >/dev/null 2>&1; then echo "-march=$(PROC)"; fi)
-CFLAGS += $(shell if uname -m | grep -q ppc; then echo "-fsigned-char"; fi)
-CPPFLAGS += -DCRYPTO
+#CFLAGS += $(shell if uname -m | grep -q ppc; then echo "-fsigned-char"; fi)
+#CPPFLAGS += -DCRYPTO
 
 #
 # Uncomment this if you want G.729A support (need to have the actual codec installed
@@@@ -89,7 +89,7 @@@@ OSARCH=$(shell uname -s)
 ifeq (${OSARCH},Darwin)
 SOLINK=-dynamic -bundle -undefined suppress -force_flat_namespace
 else
-SOLINK=-shared -Xlinker -x
+SOLINK=-shared -fPIC -Xlinker -x
 endif
 
 DEPS += $(subst .o,.d,$(OBJS))
@@@@ -109,7 +109,7 @@@@ distclean: clean
 	$(RM) $(TARGET)
 
 $(TARGET): $(OBJS)
-	$(CC) -pg $(SOLINK) -o $@@ $(OBJS)
+	$(CC) $(SOLINK) -o $@@ $(OBJS)
 
 vad_test: vad_test.o libspeex/preprocess.o libspeex/misc.o libspeex/smallft.o
 	$(CC) $(PROFILE) -o $@@ $^ -lm
@


1.3
log
@the app_conference update I forgot to commit with asterisk 1.4,
ok jolan@@ ian@@
@
text
@d1 1
a1 1
$OpenBSD: patch-Makefile,v 1.2 2005/11/29 03:40:38 jolan Exp $
@


1.2
log
@sprinkle some much needed -fPIC, heads up from naddy@@
@
text
@d1 4
a4 5
$OpenBSD: patch-Makefile,v 1.1.1.1 2005/11/10 21:13:11 jolan Exp $
--- Makefile.orig	Thu Oct 27 12:53:35 2005
+++ Makefile	Mon Nov 28 21:38:08 2005
@@@@ -17,13 +17,13 @@@@
 # app_conference defines which can be passed on the command-line
d7 3
a9 3
-INSTALL_PREFIX := /opt/horizon
-INSTALL_MODULES_DIR := $(INSTALL_PREFIX)/lib/asterisk/modules
+#INSTALL_PREFIX := /opt/horizon
d11 1
d13 1
a13 2
-ASTERISK_INCLUDE_DIR := $(HOME)/local/asterisk/asterisk/include
+ASTERISK_INCLUDE_DIR := $(LOCALBASE)/include
d15 3
a17 16
 # turn app_conference debugging on or off ( 0 == OFF, 1 == ON )
-APP_CONFERENCE_DEBUG := 1
+APP_CONFERENCE_DEBUG := 0
 
 # 0 = OFF 1 = astdsp 2 = speex
 SILDET := 2
@@@@ -41,32 +41,32 @@@@ SHAREDOS = app_conference.so
 
 PROC = $(shell uname -m)
 INSTALL = install
-CC = gcc
+#CC = gcc
 
 INCLUDE = -I$(ASTERISK_INCLUDE_DIR) 
 LIBS = -ldl -lpthread -lm
 DEBUG := -g 
d19 3
a21 2
-CFLAGS = -pipe -Wall -Wmissing-prototypes -Wmissing-declarations $(DEBUG) $(INCLUDE) -D_REENTRANT -D_GNU_SOURCE
+CFLAGS += -fPIC -Wall -Wmissing-prototypes -Wmissing-declarations $(INCLUDE) -D_REENTRANT -D_GNU_SOURCE
d23 2
a24 15
 #CFLAGS += -O3 -march=pentium3 -msse -mfpmath=sse,387 -ffast-math 
 # PERF: below is 10% faster than -O2 or -O3 alone.
 #CFLAGS += -O3 -ffast-math -funroll-loops
 # below is another 5% faster or so.
-CFLAGS += -O3 -ffast-math -funroll-all-loops -fprefetch-loop-arrays -fsingle-precision-constant
+#CFLAGS += -O3 -ffast-math -funroll-all-loops -fprefetch-loop-arrays -fsingle-precision-constant
 
 # this is fun for PPC
 #CFLAGS += -mcpu=7450 -faltivec -mabi=altivec -mdynamic-no-pic
 
 # this is fun for x86
-CFLAGS += -march=pentium3 -msse -mfpmath=sse,387
+#CFLAGS += -march=pentium3 -msse -mfpmath=sse,387
 
 
d29 1
a29 1
-CFLAGS += -DCRYPTO
d31 1
a31 1
+#CFLAGS += -DCRYPTO
d33 2
a34 2
 ifeq ($(APP_CONFERENCE_DEBUG), 1)
 CFLAGS += -DAPP_CONFERENCE_DEBUG
d43 7
a49 7
 #
@@@@ -102,7 +102,7 @@@@ clean:
 	rm -f *.so *.o $(OBJS)
 
 app_conference.so : $(OBJS)
-	$(CC) -pg -shared -Xlinker -x -o $@@ $(OBJS)
+	$(CC) -shared -Xlinker -x -o $@@ $(OBJS)
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
$OpenBSD$
d3 1
a3 1
+++ Makefile	Thu Nov 10 14:03:54 2005
d34 1
a34 1
+CFLAGS += -Wall -Wmissing-prototypes -Wmissing-declarations $(INCLUDE) -D_REENTRANT -D_GNU_SOURCE
d61 9
@


1.1.1.1
log
@app_conference-20051110, conferencing application for asterisk
@
text
@@
