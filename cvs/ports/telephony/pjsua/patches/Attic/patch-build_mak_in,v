head	1.3;
access;
symbols
	OPENBSD_4_7:1.1.1.1.0.10
	OPENBSD_4_7_BASE:1.1.1.1
	OPENBSD_4_6:1.1.1.1.0.8
	OPENBSD_4_6_BASE:1.1.1.1
	OPENBSD_4_5:1.1.1.1.0.6
	OPENBSD_4_5_BASE:1.1.1.1
	OPENBSD_4_4:1.1.1.1.0.4
	OPENBSD_4_4_BASE:1.1.1.1
	OPENBSD_4_3:1.1.1.1.0.2
	OPENBSD_4_3_BASE:1.1.1.1
	deanna_20071028:1.1.1.1
	deanna:1.1.1;
locks; strict;
comment	@# @;


1.3
date	2010.05.03.14.30.19;	author dcoppa;	state dead;
branches;
next	1.2;

1.2
date	2010.04.02.11.48.24;	author dcoppa;	state Exp;
branches;
next	1.1;

1.1
date	2007.10.27.04.34.23;	author deanna;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2007.10.27.04.34.23;	author deanna;	state Exp;
branches;
next	;


desc
@@


1.3
log
@Update pjsua to 1.6

From MAINTAINER Christopher Zimmermann, with modifications by me
and sthen@@.

OK sthen@@
@
text
@$OpenBSD: patch-build_mak_in,v 1.2 2010/04/02 11:48:24 dcoppa Exp $

fix from upstream:
enable use of system libraries for gsm, speex and portaudio

--- build.mak.in.orig	Wed Apr 15 16:45:41 2009
+++ build.mak.in	Thu Apr  1 18:52:00 2010
@@@@ -7,21 +7,33 @@@@ export TARGET_NAME := @@target@@
 export CROSS_COMPILE := @@ac_cross_compile@@
 export LINUX_POLL := @@ac_linux_poll@@ 
 
+export ac_prefix := @@prefix@@
+
 LIB_SUFFIX = $(TARGET_NAME).a
 
 # Determine which party libraries to use
 export APP_THIRD_PARTY_LIBS := -lresample-$(TARGET_NAME) -lmilenage-$(TARGET_NAME) -lsrtp-$(TARGET_NAME)
+export APP_THIRD_PARTY_EXT :=
 export APP_THIRD_PARTY_LIB_FILES = $(PJ_DIR)/third_party/lib/libresample-$(LIB_SUFFIX) $(PJ_DIR)/third_party/lib/libmilenage-$(LIB_SUFFIX) $(PJ_DIR)/third_party/lib/libsrtp-$(LIB_SUFFIX)
 
 ifneq (@@ac_no_gsm_codec@@,1)
+ifeq (@@ac_external_gsm@@,1)
+# External GSM library
+APP_THIRD_PARTY_EXT += -lgsm
+else
 APP_THIRD_PARTY_LIBS += -lgsmcodec-$(TARGET_NAME)
 APP_THIRD_PARTY_LIB_FILES += $(PJ_DIR)/third_party/lib/libgsmcodec-$(LIB_SUFFIX)
 endif
+endif
 
 ifneq (@@ac_no_speex_codec@@,1)
+ifeq (@@ac_external_speex@@,1)
+APP_THIRD_PARTY_EXT += -lspeex -lspeexdsp
+else
 APP_THIRD_PARTY_LIBS += -lspeex-$(TARGET_NAME)
 APP_THIRD_PARTY_LIB_FILES += $(PJ_DIR)/third_party/lib/libspeex-$(LIB_SUFFIX)
 endif
+endif
 
 ifneq (@@ac_no_ilbc_codec@@,1)
 APP_THIRD_PARTY_LIBS += -lilbccodec-$(TARGET_NAME)
@@@@ -34,9 +46,14 @@@@ APP_THIRD_PARTY_LIB_FILES += $(PJ_DIR)/third_party/lib
 endif
 
 ifneq ($(findstring pa,@@ac_pjmedia_snd@@),)
+ifeq (@@ac_external_pa@@,1)
+# External PA
+APP_THIRD_PARTY_EXT += -lportaudio
+else
 APP_THIRD_PARTY_LIBS += -lportaudio-$(TARGET_NAME)
 APP_THIRD_PARTY_LIB_FILES += $(PJ_DIR)/third_party/lib/libportaudio-$(LIB_SUFFIX)
 endif
+endif
 
 # Additional flags
 @@ac_build_mak_vars@@
@@@@ -69,6 +86,7 @@@@ export APP_LDLIBS := -lpjsua-$(TARGET_NAME)\
 	-lpjnath-$(TARGET_NAME)\
 	-lpjlib-util-$(TARGET_NAME)\
 	$(APP_THIRD_PARTY_LIBS)\
+	$(APP_THIRD_PARTY_EXT)\
 	-lpj-$(TARGET_NAME)\
 	@@LIBS@@
 export APP_LIB_FILES = $(PJ_DIR)/pjsip/lib/libpjsua-$(LIB_SUFFIX) \
@@@@ -83,6 +101,8 @@@@ export APP_LIB_FILES = $(PJ_DIR)/pjsip/lib/libpjsua-$(
 	$(APP_THIRD_PARTY_LIB_FILES) \
 	$(PJ_DIR)/pjlib/lib/libpj-$(LIB_SUFFIX)
 
+# Here are the variabels to use if application is using the library
+# from within the source distribution
 export PJ_DIR := $(PJDIR)
 export PJ_CC := $(APP_CC)
 export PJ_CFLAGS := $(APP_CFLAGS)
@@@@ -91,3 +111,11 @@@@ export PJ_LDFLAGS := $(APP_LDFLAGS)
 export PJ_LDLIBS := $(APP_LDLIBS)
 export PJ_LIB_FILES := $(APP_LIB_FILES)
 
+# And here are the variables to use if application is using the
+# library from the install location (i.e. --prefix)
+export PJ_INSTALL_DIR := @@prefix@@
+export PJ_INSTALL_INC_DIR := $(PJ_INSTALL_DIR)/include
+export PJ_INSTALL_LIB_DIR := $(PJ_INSTALL_DIR)/lib
+export PJ_INSTALL_CFLAGS := -I$(PJ_INSTALL_INC_DIR) -DPJ_AUTOCONF=1	@@CFLAGS@@
+export PJ_INSTALL_CXXFLAGS := $(PJ_INSTALL_CFLAGS)
+export PJ_INSTALL_LDFLAGS := -L$(PJ_INSTALL_LIB_DIR) $(APP_LDLIBS)
@


1.2
log
@Update to pjsua-1.5.5

From (new) MAINTAINER Christopher Zimmermann with some modifications
by landry@@, ajacoutot@@, sthen@@ and myself.

Thanks!

OK landry@@, ajacoutot@@, sthen@@
@
text
@d1 1
a1 1
$OpenBSD$
@


1.1
log
@Initial revision
@
text
@d2 14
a15 11
--- build.mak.in.orig	Tue Apr 17 12:16:01 2007
+++ build.mak.in	Thu May 24 10:09:23 2007
@@@@ -1,6 +1,6 @@@@
 # @@configure_input@@
 export MACHINE_NAME := auto
-export OS_NAME := auto
+export OS_NAME = openbsd
 export HOST_NAME := unix
 export CC_NAME := gcc
 export TARGET_NAME := @@target@@
@@@@ -10,33 +10,22 @@@@ export LINUX_POLL := @@ac_linux_poll@@ 
d17 3
a19 1
 export APP_THIRD_PARTY_LIBS := -lresample-$(TARGET_NAME)
d21 5
a25 1
-ifneq (@@ac_no_gsm_codec@@,1)
d27 8
a34 3
-endif
-
-ifneq (@@ac_no_speex_codec@@,1)
d36 5
a40 3
-endif
-
-ifneq (@@ac_no_ilbc_codec@@,1)
d42 8
a49 3
-endif
-
-ifneq ($(findstring pa,@@ac_pjmedia_snd@@),)
d51 3
a53 1
-endif
d55 4
a58 19
-
 # CFLAGS, LDFLAGS, and LIBS to be used by applications
 export PJDIR := @@ac_pjdir@@
 export APP_CC := $(CROSS_COMPILE)$(CC_NAME)
-export APP_CFLAGS := -DPJ_AUTOCONF=1\
-	@@CFLAGS@@\
+export APP_CFLAGS := @@CFLAGS@@\
 	-I$(PJDIR)/pjlib/include\
 	-I$(PJDIR)/pjlib-util/include\
 	-I$(PJDIR)/pjnath/include\
 	-I$(PJDIR)/pjmedia/include\
-	-I$(PJDIR)/pjsip/include
+	-I$(PJDIR)/pjsip/include\
+	-I$(PJDIR)/thirdparty/speex/include\
+	-I$(PJDIR)/thirdparty/portaudio/include
 export APP_CXXFLAGS := $(APP_CFLAGS)
 export APP_LDFLAGS := -L$(PJDIR)/pjlib/lib\
 	-L$(PJDIR)/pjlib-util/lib\
@@@@ -55,7 +44,7 @@@@ export APP_LDLIBS := -lpjsua-$(TARGET_NAME)\
d61 1
d63 5
a67 2
-	@@LIBS@@
+	@@LIBS@@ -lossaudio
d69 2
d73 13
@


1.1.1.1
log
@import pjsua 0.7.0

pjsua is an open source command line SIP user agent that is used as
the reference implementation for PJSIP and PJMEDIA. It has many
features, such as:

    * Mutiple identities/account registrations
    * Concurrent calls and conference (unlimited number, but only up
      to 254 sources can be mixed to a single destination)
    * Call features: call hold, call transfer (attended or unattended,
      with or without refersub).
    * SIP Presence/SIMPLE with PIDF and XPIDF support. PUBLISH support.
    * Instant messaging and message composing indication
    * DTMF digits transmission/receipt (RFC 2833)
    * WAV file playing, streaming, and recording.
    * Accoustic echo cancellation (AEC).
    * Auto-answer, auto-play file, auto-loop RTP
    * Support SIP UDP, TCP, and TLS transports. Support for DNS SRV
      resolution.
    * NAT traversal with rport and STUN.
    * Tone generation.
    * Codecs: PCMA, PCMU, GSM, Speex (including wideband/16KHz and
      ultra-wideband/32KHz), L16 (8-48KHz, mono or stereo), and iLBC.
    * Adaptive jitter buffer, adaptive silence detection, and packet
      lost concealment audio features.

With lots of testing and help from todd@@, sthen@@, jakemsr@@, jolan@@ and
Benny Prijono.

ok todd@@ sthen@@

@
text
@@
