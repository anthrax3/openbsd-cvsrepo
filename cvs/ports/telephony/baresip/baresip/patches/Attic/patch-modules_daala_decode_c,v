head	1.3;
access;
symbols;
locks; strict;
comment	@# @;


1.3
date	2016.01.19.23.00.40;	author czarkoff;	state dead;
branches;
next	1.2;
commitid	XJxkvCkRT1BJPpF9;

1.2
date	2016.01.12.09.22.07;	author czarkoff;	state Exp;
branches;
next	1.1;
commitid	MRfsOYO2QD4nnfOW;

1.1
date	2015.10.02.19.01.24;	author czarkoff;	state Exp;
branches;
next	;
commitid	at9mDnJ7YoTqzuxJ;


desc
@@


1.3
log
@update to baresip-0.4.17

OK and fix from feinerer@@
@
text
@$OpenBSD: patch-modules_daala_decode_c,v 1.2 2016/01/12 09:22:07 czarkoff Exp $
--- modules/daala/decode.c.orig	Tue Dec  1 13:09:48 2015
+++ modules/daala/decode.c	Thu Jan  7 18:57:18 2016
@@@@ -150,9 +150,15 @@@@ int daala_decode(struct viddec_state *vds, struct vidf
 			return EPROTO;
 		}
 
-		r = daala_decode_packet_in(vds->dec, &img, &dp);
+		r = daala_decode_packet_in(vds->dec, &dp);
 		if (r < 0) {
 			warning("daala: decode: packet_in error (%d)\n", r);
+			return EPROTO;
+		}
+
+		r = daala_decode_img_out(vds->dec, &img);
+		if (r != 1) {
+			warning("daala: decode: img_out error (%d)\n", r);
 			return EPROTO;
 		}
 
@


1.2
log
@update to re-0.4.14 rem-0.4.7 baresip-0.4.16

OK feinerer@@, sthen@@
@
text
@d1 1
a1 1
$OpenBSD$
@


1.1
log
@update to baresip 0.4.15

 - GUI
 - bugfixes
 - experimental daala support
 - GTK-dependent modules isolated in -gtk2 subpackage
 - default config now only mentions modules that are packaged

OK feinerer@@, sthen@@
@
text
@d2 3
a4 34
--- modules/daala/decode.c.orig	Sat Sep 26 20:15:57 2015
+++ modules/daala/decode.c	Sun Sep 27 14:37:55 2015
@@@@ -93,7 +93,7 @@@@ int daala_decode_update(struct viddec_state **vdsp, co
 int daala_decode(struct viddec_state *vds, struct vidframe *frame,
 		 bool marker, uint16_t seq, struct mbuf *mb)
 {
-	ogg_packet op;
+	daala_packet dp;
 	bool ishdr;
 	int i, r, err = 0;
 	(void)seq;
@@@@ -117,16 +117,16 @@@@ int daala_decode(struct viddec_state *vds, struct vidf
 		  mbuf_get_left(mb));
 #endif
 
-	memset(&op, 0, sizeof(op));
+	memset(&dp, 0, sizeof(dp));
 
-	op.packet = mbuf_buf(mb);
-	op.bytes = mbuf_get_left(mb);
-	op.b_o_s = marker;
+	dp.packet = mbuf_buf(mb);
+	dp.bytes = mbuf_get_left(mb);
+	dp.b_o_s = marker;
 
 	if (daala_packet_isheader(mbuf_buf(mb), mbuf_get_left(mb))) {
 
 		r = daala_decode_header_in(&vds->di, &vds->dc, &vds->ds,
-					   &op);
+					   &dp);
 		if (r < 0) {
 			warning("daala: decoder: decode_header_in failed"
 				" (ret = %d)\n",
@@@@ -155,7 +155,7 @@@@ int daala_decode(struct viddec_state *vds, struct vidf
d8 2
a9 2
-		r = daala_decode_packet_in(vds->dec, &img, &op);
+		r = daala_decode_packet_in(vds->dec, &img, &dp);
d12 6
d19 2
@

