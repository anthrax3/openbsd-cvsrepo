head	1.39;
access;
symbols
	OPENBSD_6_0:1.35.0.2
	OPENBSD_6_0_BASE:1.35
	OPENBSD_5_9:1.33.0.2
	OPENBSD_5_9_BASE:1.33
	OPENBSD_5_8:1.31.0.4
	OPENBSD_5_8_BASE:1.31
	OPENBSD_5_7:1.30.0.2
	OPENBSD_5_7_BASE:1.30
	OPENBSD_5_6:1.29.0.2
	OPENBSD_5_6_BASE:1.29
	OPENBSD_5_5:1.27.0.4
	OPENBSD_5_5_BASE:1.27
	OPENBSD_5_4:1.27.0.2
	OPENBSD_5_4_BASE:1.27
	OPENBSD_5_3:1.23.0.2
	OPENBSD_5_3_BASE:1.23
	OPENBSD_5_2:1.19.0.2
	OPENBSD_5_2_BASE:1.19
	OPENBSD_5_1_BASE:1.16
	OPENBSD_5_1:1.16.0.2
	OPENBSD_5_0:1.12.0.4
	OPENBSD_5_0_BASE:1.12
	OPENBSD_4_9:1.12.0.2
	OPENBSD_4_9_BASE:1.12
	OPENBSD_4_8:1.6.0.2
	OPENBSD_4_8_BASE:1.6
	OPENBSD_4_7:1.3.0.2
	OPENBSD_4_7_BASE:1.3
	OPENBSD_4_6:1.1.1.1.0.2
	OPENBSD_4_6_BASE:1.1.1.1
	sthen_20090604:1.1.1.1
	sthen:1.1.1;
locks; strict;
comment	@# @;


1.39
date	2016.11.08.14.23.59;	author sthen;	state Exp;
branches;
next	1.38;
commitid	oUrtIMnoB4ZxTuF2;

1.38
date	2016.11.04.11.35.20;	author sthen;	state Exp;
branches;
next	1.37;
commitid	Gg5LRcnQlqj5M3F7;

1.37
date	2016.09.11.20.54.13;	author ajacoutot;	state Exp;
branches;
next	1.36;
commitid	9aCynzSLedE7m3mA;

1.36
date	2016.08.17.20.58.46;	author sthen;	state Exp;
branches;
next	1.35;
commitid	3CV1Jrhn4ZTjTK9B;

1.35
date	2016.03.18.21.38.25;	author naddy;	state Exp;
branches;
next	1.34;
commitid	BVkebQSTXSZokeRG;

1.34
date	2016.03.16.09.30.01;	author jasper;	state Exp;
branches;
next	1.33;
commitid	aJpvmFemv0Wvy2xa;

1.33
date	2015.11.20.10.09.52;	author sthen;	state Exp;
branches
	1.33.2.1;
next	1.32;
commitid	UZE2eJ0mBOI1OdIy;

1.32
date	2015.10.30.12.59.16;	author sthen;	state Exp;
branches;
next	1.31;
commitid	vVZOehVa6DiEPxJL;

1.31
date	2015.07.19.00.02.24;	author jasper;	state Exp;
branches;
next	1.30;
commitid	uyp8QSe16Pp50xjL;

1.30
date	2014.09.13.18.09.22;	author brad;	state Exp;
branches;
next	1.29;
commitid	PpbRjVZdAmlrmi8q;

1.29
date	2014.04.18.21.57.32;	author sthen;	state Exp;
branches;
next	1.28;

1.28
date	2014.04.13.01.01.39;	author naddy;	state Exp;
branches;
next	1.27;

1.27
date	2013.06.12.20.36.34;	author brad;	state Exp;
branches;
next	1.26;

1.26
date	2013.05.25.00.33.10;	author brad;	state Exp;
branches;
next	1.25;

1.25
date	2013.04.16.11.13.04;	author sthen;	state Exp;
branches;
next	1.24;

1.24
date	2013.03.11.11.41.33;	author espie;	state Exp;
branches;
next	1.23;

1.23
date	2013.02.09.14.49.53;	author sthen;	state Exp;
branches;
next	1.22;

1.22
date	2012.12.02.20.21.50;	author jasper;	state Exp;
branches;
next	1.21;

1.21
date	2012.09.15.12.16.18;	author sthen;	state Exp;
branches;
next	1.20;

1.20
date	2012.08.23.17.42.27;	author sthen;	state Exp;
branches;
next	1.19;

1.19
date	2012.06.12.23.39.09;	author sthen;	state Exp;
branches;
next	1.18;

1.18
date	2012.05.09.21.27.47;	author sthen;	state Exp;
branches;
next	1.17;

1.17
date	2012.04.22.21.44.24;	author sthen;	state Exp;
branches;
next	1.16;

1.16
date	2011.11.03.07.40.20;	author jasper;	state Exp;
branches;
next	1.15;

1.15
date	2011.11.02.08.32.17;	author jasper;	state Exp;
branches;
next	1.14;

1.14
date	2011.09.16.11.41.40;	author espie;	state Exp;
branches;
next	1.13;

1.13
date	2011.09.12.18.02.35;	author naddy;	state Exp;
branches;
next	1.12;

1.12
date	2010.11.26.14.44.27;	author espie;	state Exp;
branches;
next	1.11;

1.11
date	2010.11.22.09.38.08;	author espie;	state Exp;
branches;
next	1.10;

1.10
date	2010.11.20.19.56.47;	author espie;	state Exp;
branches;
next	1.9;

1.9
date	2010.11.06.16.07.00;	author espie;	state Exp;
branches;
next	1.8;

1.8
date	2010.10.19.07.43.05;	author espie;	state Exp;
branches;
next	1.7;

1.7
date	2010.08.30.21.48.38;	author sthen;	state Exp;
branches;
next	1.6;

1.6
date	2010.08.07.08.17.23;	author espie;	state Exp;
branches;
next	1.5;

1.5
date	2010.08.01.17.02.28;	author ajacoutot;	state Exp;
branches;
next	1.4;

1.4
date	2010.07.27.09.27.24;	author dcoppa;	state Exp;
branches;
next	1.3;

1.3
date	2009.09.12.09.42.04;	author sthen;	state Exp;
branches;
next	1.2;

1.2
date	2009.08.15.08.50.21;	author sthen;	state Exp;
branches;
next	1.1;

1.1
date	2009.06.04.13.44.09;	author sthen;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2009.06.04.13.44.09;	author sthen;	state Exp;
branches;
next	;

1.33.2.1
date	2016.03.16.09.32.19;	author jasper;	state Exp;
branches;
next	;
commitid	XUbLqQCCZfm6WMO0;


desc
@@


1.39
log
@WANTLIB += lzma and bump
@
text
@# $OpenBSD: Makefile,v 1.38 2016/11/04 11:35:20 sthen Exp $

COMMENT-main =		mature and flexible open source SIP server

VERSION =		4.3.3
REVISION =		4
DISTNAME =		kamailio-${VERSION}_src
PKGNAME-main =		kamailio-${VERSION}
PKGNAME-mysql =		kamailio-mysql-${VERSION}
PKGNAME-postgresql =	kamailio-postgresql-${VERSION}
PKGNAME-ldap =		kamailio-ldap-${VERSION}
PKGNAME-xmlrpc =	kamailio-xmlrpc-${VERSION}
PKGNAME-carrierroute =	kamailio-carrierroute-${VERSION}
PKGNAME-snmpstats =	kamailio-snmpstats-${VERSION}
PKGNAME-perl =		kamailio-perl-${VERSION}
#PKGNAME-radius =	kamailio-radius-${VERSION}	TODO

CATEGORIES =		telephony
MAINTAINER =		Roman Kravchuk <kravchuk.kp@@gmail.com>

HOMEPAGE =		http://www.kamailio.org/

# GPLv2+
PERMIT_PACKAGE_CDROM =	Yes

SHARED_LIBS =		kcore	3.0	# 1.0
SHARED_LIBS +=		kmi	3.0	# 1.0
SHARED_LIBS +=		srdb1	3.0	# 1.0
SHARED_LIBS +=		srdb2	3.0	# 1.0
SHARED_LIBS +=		trie	3.0	# 1.0
SHARED_LIBS +=		binrpc	2.0	# 0.1
SHARED_LIBS +=		srutils	2.0	# 1.0
SHARED_LIBS +=		print	1.0	# 1.2

MAKE_ENV =		CC="${CC}" \
			CC_EXTRA_OPTS="${CFLAGS} -DOPENSSL_NO_BUF_FREELISTS -DHAVE_ARC4RANDOM -I${LOCALBASE}/include" \
			LD_EXTRA_OPTS="${LDFLAGS} -pthread -L${LOCALBASE}/lib" \
			QUIET=verbose

MASTER_SITES =		http://www.kamailio.org/pub/kamailio/${VERSION}/src/
WRKDIST =		${WRKDIR}/kamailio-${VERSION}

MODULES =		devel/gettext
WANTLIB-main =		c crypto curl db expat m pcre pthread ssl lzma xml2 nghttp2 \
			ncurses readline unistring z ${MODGETTEXT_WANTLIB}
LIB_DEPENDS-main =	net/curl \
			databases/db/v4,-main,no_java \
			devel/pcre \
			textproc/libxml,-main,no_python \
			converters/libunistring \
			${MODGETTEXT_LIB_DEPENDS}

KAMAILIO_MODULES =	cpl-c db_berkeley dialplan dialog_ng jabber lcr \
			presence presence_dialoginfo presence_mwi presence_reginfo \
			presence_xml pua pua_bla pua_dialoginfo pua_mi pua_reginfo \
			pua_usrloc pua_xmpp regex rls seas utils xcap_client xmpp \
			tls xhttp_pi websocket

FLAVOR ?=
MULTI_PACKAGES =	-main

USE_GMAKE =		Yes
NO_TEST =		Yes

MAKE_FLAGS =	LIBDIR=lib \
		PREFIX=${TRUEPREFIX} \
		BASEDIR=${WRKINST} \
		cfg-prefix=${WRKINST} \
		SYSCONFDIR=${SYSCONFDIR} \
		VARBASE=${VARBASE} \
		SCTP=0 \
		include_modules="${KAMAILIO_MODULES}" \
		LIBkcore_VERSION=${LIBkcore_VERSION} \
		LIBkmi_VERSION=${LIBkmi_VERSION} \
		LIBsrdb1_VERSION=${LIBsrdb1_VERSION} \
		LIBsrdb2_VERSION=${LIBsrdb2_VERSION} \
		LIBtrie_VERSION=${LIBtrie_VERSION} \
		LIBbinrpc_VERSION=${LIBbinrpc_VERSION} \
		LIBsrutils_VERSION=${LIBsrutils_VERSION} \
		LIBprint_VERSION=${LIBprint_VERSION}

PSEUDO_FLAVORS +=	no_postgresql
.if !${FLAVOR:Mno_postgresql}
MULTI_PACKAGES +=	-postgresql
COMMENT-postgresql =	kamailio postgresql module
KAMAILIO_MODULES +=	db_postgres
WANTLIB-postgresql =	c pq pthread lib/kamailio/srdb1 lib/kamailio/srdb2
LIB_DEPENDS-postgresql =databases/postgresql,-main telephony/kamailio,-main
.endif

PSEUDO_FLAVORS +=	no_mysql
.if !${FLAVOR:Mno_mysql}
MULTI_PACKAGES +=	-mysql
COMMENT-mysql =		kamailio mysql module
KAMAILIO_MODULES +=	db_mysql
WANTLIB-mysql =		c crypto m pthread ssl z mysqlclient \
			lib/kamailio/srdb1 lib/kamailio/srdb2
LIB_DEPENDS-mysql =	databases/mariadb,-main telephony/kamailio,-main
.endif

PSEUDO_FLAVORS +=	no_ldap
.if !${FLAVOR:Mno_ldap}
MULTI_PACKAGES +=	-ldap
COMMENT-ldap =		kamailio LDAP modules
KAMAILIO_MODULES +=	ldap h350
WANTLIB-ldap =		c ldap pthread lib/kamailio/srdb2
LIB_DEPENDS-ldap =	databases/openldap,-main telephony/kamailio,-main
.endif

PSEUDO_FLAVORS +=	no_xmlrpc
.if !${FLAVOR:Mno_xmlrpc}
MULTI_PACKAGES +=	-xmlrpc
COMMENT-xmlrpc =	kamailio XML-RPC module
KAMAILIO_MODULES +=	mi_xmlrpc
WANTLIB-xmlrpc +=	c pthread xmlrpc xmlrpc_abyss xmlrpc_server
WANTLIB-xmlrpc +=	xmlrpc_server_abyss xmlrpc_util
WANTLIB-xmlrpc +=	xmlrpc_xmlparse xmlrpc_xmltok lib/kamailio/kmi
LIB_DEPENDS-xmlrpc =	net/xmlrpc-c telephony/kamailio,-main
.endif

PSEUDO_FLAVORS +=	no_snmpstats
.if !${FLAVOR:Mno_snmpstats}
MULTI_PACKAGES +=	-snmpstats
COMMENT-snmpstats =	kamailio snmpstats module
KAMAILIO_MODULES +=	snmpstats
WANTLIB-snmpstats =	c netsnmp netsnmpagent netsnmpmibs pthread lib/kamailio/kcore
LIB_DEPENDS-snmpstats =	net/net-snmp telephony/kamailio,-main
.endif

PSEUDO_FLAVORS +=	no_carrierroute
.if !${FLAVOR:Mno_carrierroute}
MULTI_PACKAGES +=	-carrierroute
COMMENT-carrierroute =	kamailio carrierroute module
KAMAILIO_MODULES +=	carrierroute
WANTLIB-carrierroute =	c confuse pthread ${MODGETTEXT_WANTLIB} \
			lib/kamailio/kcore lib/kamailio/kmi \
			lib/kamailio/srdb1 lib/kamailio/trie
LIB_DEPENDS-carrierroute = devel/libconfuse \
			${MODGETTEXT_LIB_DEPENDS} telephony/kamailio,-main
.endif

PSEUDO_FLAVORS +=	no_perl
.if !${FLAVOR:Mno_perl}
MULTI_PACKAGES +=	-perl
COMMENT-perl =		kamailio perl modules
KAMAILIO_MODULES +=	app_perl db_perlvdb
WANTLIB-perl =		c m perl pthread util lib/kamailio/kmi lib/kamailio/srdb1
LIB_DEPENDS-perl =	telephony/kamailio,-main
.endif

# TODO
#PSEUDO_FLAVORS +=	no_radius
#.if !${FLAVOR:Mno_radius}
#MULTI_PACKAGES +=	-radius
#COMMENT-radius =	kamailio RADIUS modules
#KAMAILIO_MODULES +=	auth_radius misc_radius peering
#WANTLIB-radius =	freeradius-client
#LIB_DEPENDS-radius =	net/freeradius-client
#.endif

.for i in ${MULTI_PACKAGES:S/-main//}
FULLPKGNAME$i ?=	kamailio$i-${VERSION}
RUN_DEPENDS$i +=	kamailio-${VERSION}:telephony/kamailio
.endfor

pre-configure:
	@@sed -i -e 's,#!/bin/bash,#!/bin/sh,;' \
	    -e 's,exit -1,exit 255,' ${WRKSRC}/utils/kamctl/kam*

.include <bsd.port.mk>
@


1.38
log
@sync WANTLIB (and in one case, add gettext to LIB_DEPENDS) in dependent ports
now that internationalised domain name support has been removed from net/curl
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2016/09/11 20:54:13 ajacoutot Exp $
d6 1
a6 1
REVISION =		3
d44 1
a44 1
WANTLIB-main =		c crypto curl db expat m pcre pthread ssl xml2 nghttp2 \
@


1.37
log
@Second and last pass at pre-entively fixing ports that would break once
guenther's header pollution cleanup diff is in.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2016/08/17 20:58:46 sthen Exp $
d6 1
a6 2
REVISION-main =		2
REVISION =		1
d45 1
a45 1
			idn ncurses readline unistring z ${MODGETTEXT_WANTLIB}
@


1.36
log
@bump ports that might pick up IP_SENDSRCADDR
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2016/03/18 21:38:25 naddy Exp $
d6 2
a7 2
REVISION-main =		1
REVISION =		0
@


1.35
log
@remove SHARED_ONLY from simple ports that use the gettext or libiconv module
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2016/03/16 09:30:01 jasper Exp $
d6 1
@


1.34
log
@Security fix for CVE-2016-2385

maintainer timed-out
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2015/11/20 10:09:52 sthen Exp $
a3 2

SHARED_ONLY =		Yes
@


1.33
log
@update to Kamailio 4.3.3, from maintainer Roman Kravchuk
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2015/10/30 12:59:16 sthen Exp $
d8 1
@


1.33.2.1
log
@Security fix for CVE-2016-2385
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2015/11/20 10:09:52 sthen Exp $
a7 1
REVISION =		0
@


1.32
log
@sync WANTLIB (curl+nghttp2)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2015/07/19 00:02:24 jasper Exp $
d7 1
a7 3
VERSION =		4.0.0
REVISION-main =		0
REVISION-mysql =	2
d27 8
a34 8
SHARED_LIBS =		kcore	2.0	# 1.0
SHARED_LIBS +=		kmi	2.0	# 1.0
SHARED_LIBS +=		srdb1	2.0	# 1.0
SHARED_LIBS +=		srdb2	2.0	# 1.0
SHARED_LIBS +=		trie	2.0	# 1.0
SHARED_LIBS +=		binrpc	1.0	# 0.1
SHARED_LIBS +=		srutils	1.0	# 1.0
SHARED_LIBS +=		print	0.0	# 1.2
d37 2
a38 2
			CC_EXTRA_OPTS="${CFLAGS} -DOPENSSL_NO_BUF_FREELISTS" \
			LD_EXTRA_OPTS="${LDFLAGS} -pthread" \
d71 2
a72 1
		C_INCLUDES="-I${LOCALBASE}/include" \
a149 1
RUN_DEPENDS-perl =	databases/p5-ldap
@


1.31
log
@use sed -i
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2014/09/13 18:09:22 brad Exp $
d8 2
a20 2
REVISION-mysql =	2

d47 1
a47 1
WANTLIB-main =		c crypto curl db expat m pcre pthread ssl xml2 \
@


1.30
log
@Switch from using MySQL to using MariaDB attempt #2. MariaDB is a drop-in replacement.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2014/04/18 21:57:32 sthen Exp $
d170 1
a170 1
	@@perl -pi -e 's,#!/bin/bash,#!/bin/sh,;' \
@


1.29
log
@define OPENSSL_NO_BUF_FREELISTS to avoid some horrors which no longer build
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2014/04/13 01:01:39 naddy Exp $
d19 1
a19 1
REVISION-mysql =	1
d100 1
a100 1
LIB_DEPENDS-mysql =	databases/mysql,-main telephony/kamailio,-main
@


1.28
log
@Drop USE_GROFF since groff and mandoc produce identical output.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2013/06/12 20:36:34 brad Exp $
d38 4
a41 1
MAKE_ENV =		CC="${CC}" CC_EXTRA_OPTS="${CFLAGS}" LD_EXTRA_OPTS="${LDFLAGS} -pthread" QUIET=verbose
@


1.27
log
@Revert back to using MySQL 5.1 for the time being. MariaDB 5.5 introduces
a new libmysqlclient non-blocking API which utilizes co-routines. The X86
specific GCC ASM co-routine support hid the fact that there was an issue.
The only fallback code so far is POSIX user contexts which OpenBSD does not
support.

Input from and Ok sthen@@ jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2013/05/25 00:33:10 brad Exp $
a62 1
USE_GROFF =		Yes
@


1.26
log
@Switch from using MySQL to using MariaDB. MariaDB is a drop-in replacement.


ok sthen aja
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2013/04/16 11:13:04 sthen Exp $
d19 1
a19 1
REVISION-mysql =	0
d98 1
a98 1
LIB_DEPENDS-mysql =	databases/mariadb,-main telephony/kamailio,-main
@


1.25
log
@update to Kamailio 4.0.0, from maintainer Roman Kravchuk
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2013/03/11 11:41:33 espie Exp $
d19 2
d98 1
a98 1
LIB_DEPENDS-mysql =	databases/mysql,-main telephony/kamailio,-main
@


1.24
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2013/02/09 14:49:53 sthen Exp $
d7 1
a7 1
VERSION =		3.3.1
d27 8
a34 8
SHARED_LIBS =		kcore	1.0	# 1.0
SHARED_LIBS +=		kmi	1.0	# 1.0
SHARED_LIBS +=		ser_cds	1.0	# 0.1
SHARED_LIBS +=		srdb1	1.0	# 1.0
SHARED_LIBS +=		srdb2	1.0	# 1.0
SHARED_LIBS +=		trie	1.0	# 1.0
SHARED_LIBS +=		binrpc	0.0	# 0.1
SHARED_LIBS +=		srutils	0.0	# 1.0
d36 1
a36 1
MAKE_ENV =		CC="${CC}" LDFLAGS="${LDFLAGS} -pthread" QUIET=verbose
d42 2
a43 2
WANTLIB-main =		c crypto curl db expat pcre pthread ssl xml2 \
			idn ncurses readline z m ${MODGETTEXT_WANTLIB}
d48 1
d51 5
a55 4
KAMAILIO_MODULES =	cpl-c db_berkeley dialplan jabber lcr \
			presence presence_dialoginfo presence_mwi presence_xml \
			pua pua_bla pua_dialoginfo pua_mi pua_usrloc pua_xmpp \
			regex rls seas utils xcap_client xmpp tls
d64 1
a64 2
MAKE_FLAGS =	FLAVOUR=kamailio \
		LIBDIR=lib \
a72 1
		LIBser_cds_VERSION=${LIBser_cds_VERSION} \
d77 2
a78 1
		LIBsrutils_VERSION=${LIBsrutils_VERSION}
d85 1
a85 1
WANTLIB-postgresql =	c pq lib/kamailio/srdb1 lib/kamailio/srdb2
d94 1
a94 1
WANTLIB-mysql =		c crypto m ssl z mysqlclient \
d104 1
a104 1
WANTLIB-ldap =		c ldap lib/kamailio/srdb2
d124 1
a124 1
WANTLIB-snmpstats =	c netsnmp netsnmpagent netsnmpmibs lib/kamailio/kcore
d133 1
a133 1
WANTLIB-carrierroute =	c confuse ${MODGETTEXT_WANTLIB} \
d144 2
a145 2
KAMAILIO_MODULES +=	perl perlvdb
WANTLIB-perl =		c m perl util lib/kamailio/kmi lib/kamailio/srdb1
@


1.23
log
@Don't use ${FLAVOR:L}, we only support lower-case flavours now.
OK ajacoutot@@ espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2012/12/02 20:21:50 jasper Exp $
a25 3
PERMIT_PACKAGE_FTP =	Yes
PERMIT_DISTFILES_CDROM =Yes
PERMIT_DISTFILES_FTP =	Yes
d60 1
a60 1
NO_REGRESS =		Yes
@


1.22
log
@unfuck RCS ID
@
text
@d1 1
a1 1
# $OpenBSD$
d83 1
a83 1
.if !${FLAVOR:L:Mno_postgresql}
d92 1
a92 1
.if !${FLAVOR:L:Mno_mysql}
d102 1
a102 1
.if !${FLAVOR:L:Mno_ldap}
d111 1
a111 1
.if !${FLAVOR:L:Mno_xmlrpc}
d122 1
a122 1
.if !${FLAVOR:L:Mno_snmpstats}
d131 1
a131 1
.if !${FLAVOR:L:Mno_carrierroute}
d143 1
a143 1
.if !${FLAVOR:L:Mno_perl}
d154 1
a154 1
#.if !${FLAVOR:L:Mno_radius}
@


1.21
log
@update to Kamailio 3.3.1, from maintainer Roman Kravchuk
* see http://www.kamailio.org/wiki/install/upgrade/3.2.x-to-3.3.0 for upgrade notes
@
text
@d1 1
a1 1
# $OpenBSD:
@


1.20
log
@sync wantlib
@
text
@d7 1
a7 2
VERSION =		3.2.3
REVISION =		2
d30 8
a37 6
SHARED_LIBS =		kcore	0.0	# 1.0
SHARED_LIBS +=		kmi	0.0	# 1.0
SHARED_LIBS +=		ser_cds	0.0	# 0.1
SHARED_LIBS +=		srdb1	0.0	# 1.0
SHARED_LIBS +=		srdb2	0.0	# 1.0
SHARED_LIBS +=		trie	0.0	# 1.0
d46 1
a46 1
			idn ncurses readline z ${MODGETTEXT_WANTLIB}
d48 1
a48 1
			databases/db/v4 \
d78 3
a80 1
		LIBtrie_VERSION=${LIBtrie_VERSION}
@


1.19
log
@Kamailio fix from Brad, ok Roman Kravchuk (maintainer).

HAVE_SCHED_YIELD should be set since we have sched_yield(). The
sched_yield.h compatibility wrapper then does not try to create a
fallback macro which conflicts with the prototype of the syscall
wrapper.
@
text
@d8 1
a8 1
REVISION =		1
d84 1
a84 1
WANTLIB-postgresql =	pq lib/kamailio/srdb1 lib/kamailio/srdb2
d93 1
a93 1
WANTLIB-mysql =		crypto m ssl z mysqlclient \
d103 1
a103 1
WANTLIB-ldap =		ldap lib/kamailio/srdb2
d112 1
a112 1
WANTLIB-xmlrpc +=	pthread xmlrpc xmlrpc_abyss xmlrpc_server
d123 1
a123 1
WANTLIB-snmpstats =	netsnmp netsnmpagent netsnmpmibs lib/kamailio/kcore
d132 1
a132 1
WANTLIB-carrierroute =	confuse ${MODGETTEXT_WANTLIB} \
@


1.18
log
@Fixes to telephony/kamailio:

- avoid compiler warnings due to missing headers, duplicate #defines etc.,
from maintainer Roman Kravchuk, slight tweak by me (ifndef rather than
delete the lines).

- fix WANTLIB/LIB_DEPENDS in the subpackages, from me.
@
text
@d8 1
a8 1
REVISION =		0
@


1.17
log
@update to kamailio 3.2.3, mostly from Roman Kravchuk (taking maintainer,
previous maintainer ok).
@
text
@d8 1
d84 2
a85 2
WANTLIB-postgresql =	pq
LIB_DEPENDS-postgresql =databases/postgresql,-main
d93 3
a95 2
WANTLIB-mysql =		crypto m ssl z mysqlclient
LIB_DEPENDS-mysql =	databases/mysql,-main
d103 2
a104 2
WANTLIB-ldap =		ldap
LIB_DEPENDS-ldap =	databases/openldap,-main
d114 2
a115 2
WANTLIB-xmlrpc +=	xmlrpc_xmlparse xmlrpc_xmltok
LIB_DEPENDS-xmlrpc =	net/xmlrpc-c
d123 2
a124 2
WANTLIB-snmpstats =	netsnmp netsnmpagent netsnmpmibs
LIB_DEPENDS-snmpstats =	net/net-snmp
d132 3
a134 1
WANTLIB-carrierroute =	confuse ${MODGETTEXT_WANTLIB}
d136 1
a136 1
			${MODGETTEXT_LIB_DEPENDS}
d144 2
a145 2
WANTLIB-perl =		c m perl util
LIB_DEPENDS-perl =
@


1.16
log
@sigh.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2011/11/02 08:32:17 jasper Exp $
d7 2
a8 2
VERSION =		1.5.4
DISTNAME =		kamailio-${VERSION}-tls_src
a9 1
REVISION-main =		2
a10 1
REVISION-mysql =	0
a11 2
REVISION-postgresql =	0
#PKGNAME-radius =	kamailio-radius-${VERSION}		TODO
a12 1
REVISION-ldap =		0
a13 1
REVISION-xmlrpc =	0
a14 1
REVISION-carrierroute =	1
a15 1
REVISION-snmpstats =	1
d17 1
a17 1
REVISION-perl =		1
d20 1
a20 1
MAINTAINER =		Don Jackson <port-pkg-maint@@clark-communications.com>
d30 8
a37 1
MAKE_ENV =		CC=${CC} FREERADIUS=1 LDFLAGS="${LDFLAGS} -pthread"
d40 1
a40 1
WRKDIST =		${WRKDIR}/kamailio-${VERSION}-tls
d43 2
a44 1
WANTLIB-main =		c crypto curl db expat pcre pthread ssl xml2
d48 2
a49 1
			textproc/libxml,-main,no_python
d54 1
a54 1
			regex rls seas utils xcap_client xmpp
d63 1
a63 1
MAKE_FLAGS =	TLS=1 \
d68 9
a76 3
		cfg-target=${SYSCONFDIR}/kamailio/ \
		cfg-dir=${TRUEPREFIX}/share/examples/kamailio/ \
		include_modules="${KAMAILIO_MODULES}"
d92 1
a92 1
WANTLIB-mysql =		crypto m mysqlclient ssl z
a95 10
# TODO
#PSEUDO_FLAVORS +=	no_radius
#.if !${FLAVOR:L:Mno_radius}
#MULTI_PACKAGES +=	-radius
#COMMENT-radius =	kamailio RADIUS modules
#KAMAILIO_MODULES +=	auth_radius misc_radius peering
#WANTLIB-radius =	freeradius-client
#LIB_DEPENDS-radius =	net/freeradius-client
#.endif

d130 3
a132 3
WANTLIB-carrierroute =	confuse
LIB_DEPENDS-carrierroute = devel/libconfuse
RUN_DEPENDS-carrierroute = ${MODGETTEXT_RUN_DEPENDS}
d145 10
d161 2
a162 2
	@@perl -pi -e '$$. == 1 && s,#!/bin/bash,#!/bin/sh,;' \
	    -e 's,exit -1,exit 255,' ${WRKSRC}/scripts/kam*
@


1.15
log
@- regen WANTLIB
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2011/09/16 11:41:40 espie Exp $
d21 1
a21 1
REVISION-carrierroute =	0
d25 1
a25 1
REVISION-perl =		0
@


1.14
log
@normalize pkgpath
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2011/09/12 18:02:35 naddy Exp $
d23 1
a23 1
REVISION-snmpstats =	0
d124 1
a124 1
WANTLIB-snmpstats =	netsnmp netsnmpagent netsnmphelpers netsnmpmibs
d133 2
a134 3
WANTLIB-carrierroute =	${MODGETTEXT_WANTLIB} confuse
LIB_DEPENDS-carrierroute = devel/libconfuse \
			   ${MODGETTEXT_LIB_DEPENDS}
@


1.13
log
@bump all (sub)packages that depend on db/v4; requested by and help from espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2010/11/26 14:44:27 espie Exp $
d10 1
a10 1
REVISION-main =		1
d12 1
d14 1
d17 1
d19 1
d21 1
d23 1
d25 1
@


1.12
log
@default db-* for db/v4 is incorrect, set PKGSPEC=db->=4,<5, bump packages
with erroneous depends.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2010/11/22 09:38:08 espie Exp $
d10 1
a10 1
REVISION-main =		0
@


1.11
log
@missed a few depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2010/11/20 19:56:47 espie Exp $
d10 1
d39 1
a39 1
			databases/db/v4,-main \
@


1.10
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2010/11/06 16:07:00 espie Exp $
d69 1
a69 1
LIB_DEPENDS-postgresql =:postgresql-client-*:databases/postgresql,-main
@


1.9
log
@move gettext to new WANTLIB
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2010/10/19 07:43:05 espie Exp $
d37 4
a40 4
LIB_DEPENDS-main =	::net/curl \
			::databases/db/v4,-main \
			::devel/pcre \
			::textproc/libxml,-main,no_python
d51 1
a51 1
USE_GROFF =	Yes
d78 1
a78 1
LIB_DEPENDS-mysql =	:mysql-client-*:databases/mysql,-main
d88 1
a88 1
#LIB_DEPENDS-radius =	::net/freeradius-client
d97 1
a97 1
LIB_DEPENDS-ldap =	:openldap-client-*:databases/openldap,-main
d108 1
a108 1
LIB_DEPENDS-xmlrpc =	::net/xmlrpc-c
d117 1
a117 1
LIB_DEPENDS-snmpstats =	::net/net-snmp
d126 1
a126 1
LIB_DEPENDS-carrierroute = ::devel/libconfuse \
d138 1
a138 1
RUN_DEPENDS-perl =	::databases/p5-ldap
d143 1
a143 1
RUN_DEPENDS$i +=	:kamailio-${VERSION}:telephony/kamailio
@


1.8
log
@USE_GROFF=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2010/08/30 21:48:38 sthen Exp $
d125 1
a125 1
WANTLIB-carrierroute =	confuse
@


1.7
log
@update to 1.5.4, also taking care of bumping for new python
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2010/08/07 08:17:23 espie Exp $
d51 1
@


1.6
log
@revert dependencies for the perl subpackage to what they were before.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2010/08/01 17:02:28 ajacoutot Exp $
d7 1
a7 1
VERSION =		1.5.2
a17 9

REVISION-main =		1
REVISION-mysql =	0
REVISION-postgresql =	0
REVISION-ldap =		0
REVISION-xmlrpc =	0
REVISION-carrierroute =	0
REVISION-snmpstats =	0
REVISION-perl =	1
@


1.5
log
@Missed bumps.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2010/07/27 09:27:24 dcoppa Exp $
d26 1
a26 1
REVISION-perl =	0
d145 1
@


1.4
log
@Switch to new-style REVISION/LIB_DEPENDS/WANTLIB

OK sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2009/09/12 09:42:04 sthen Exp $
d18 9
a26 1
REVISION-main =		0
@


1.3
log
@- fix unportable code in scripts;

"echo -e" -> "printf"
"exit -1" -> "exit 255"

- some of the patches had hand-rolled chunks to replace /bin/bash
with /bin/sh near a CVS keyword; remove these and replace with a
pre-configure target making it easier to update-patches

- change sample config to disable hardcoded escape sequences for
colours by default

- bump PKGNAME-main
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2009/08/15 08:50:21 sthen Exp $
d9 1
a9 1
PKGNAME-main =		kamailio-${VERSION}p0
d18 1
d37 5
a41 5
WANTLIB-main =		c expat crypto pthread ssl
LIB_DEPENDS-main =	curl::net/curl \
			db::databases/db/v4,-main \
			pcre::devel/pcre \
			xml2::textproc/libxml,-main,no_python
d68 2
a69 1
LIB_DEPENDS-postgresql =pq:postgresql-client-*:databases/postgresql,-main
d77 2
a78 2
WANTLIB-mysql =		crypto m ssl z
LIB_DEPENDS-mysql =	mysqlclient:mysql-client-*:databases/mysql,-main
d87 2
a88 1
#LIB_DEPENDS-radius =	freeradius-client::net/freeradius-client
d96 2
a97 1
LIB_DEPENDS-ldap =	ldap:openldap-client-*:databases/openldap,-main
d105 4
a108 2
LIB_DEPENDS-xmlrpc =	xmlrpc,xmlrpc_abyss,xmlrpc_server,xmlrpc_server_abyss,xmlrpc_util,xmlrpc_xmlparse,xmlrpc_xmltok::net/xmlrpc-c
WANTLIB-xmlrpc =	pthread
d116 2
a117 1
LIB_DEPENDS-snmpstats =	netsnmp,netsnmpagent,netsnmphelpers,netsnmpmibs::net/net-snmp
d125 2
a126 1
LIB_DEPENDS-carrierroute = confuse::devel/libconfuse \
d136 1
a136 1
LIB_DEPENDS-perl =
a137 1
WANTLIB-perl =		c m perl util
@


1.2
log
@update to 1.5.2, Don Jackson (maintainer) can't test now but basically
ok with the update.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2009/06/04 13:44:09 sthen Exp $
d9 1
a9 1
PKGNAME-main =		kamailio-${VERSION}
d137 4
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d7 1
a7 1
VERSION =		1.5.1
@


1.1.1.1
log
@import telephony/kamailio, reworked from a port submission by Don Jackson.
some more work still to do but most things should run ok, and it's easier
to handle that in-tree.

KAMAILIO (OpenSER) is a mature and flexible open source SIP server (RFC3261).
It can be used on systems with limitted resources as well as on carrier grade
servers, scaling to up to thousands call setups per second. It is written in
pure C for Unix/Linux-like systems with architecture specific optimizations to
offer high performances. It is customizable, being able to feature as fast load
balancer; SIP server flavours: registrar, location server, proxy server,
redirect server; gateway to SMS/XMPP; or advanced VoIP application server.
@
text
@@
