head	1.3;
access;
symbols
	OPENBSD_2_3:1.2.0.2
	OPENBSD_2_3_BASE:1.2;
locks; strict;
comment	@# @;


1.3
date	98.06.22.10.18.13;	author form;	state dead;
branches;
next	1.2;

1.2
date	97.11.25.22.22.43;	author angelos;	state Exp;
branches;
next	1.1;

1.1
date	97.11.25.21.33.34;	author angelos;	state Exp;
branches;
next	;


desc
@@


1.3
log
@fix...
@
text
@*** zipcloak.c.orig	Mon Apr  1 12:10:50 1996
--- zipcloak.c	Tue Nov 25 17:20:11 1997
***************
*** 342,350 ****
      attr = getfileattr(zipfile);
  
      /* Open output zip file for writing */
!     if ((tempzf = outzip = fopen(tempzip = tempname(zipfile), FOPW)) == NULL) {
          ziperr(ZE_TEMP, tempzip);
-     }
  
      /* Get password */
      if (getp("Enter password: ", passwd, PWLEN+1) == NULL)
--- 342,352 ----
      attr = getfileattr(zipfile);
  
      /* Open output zip file for writing */
!     tempzip = tempname(zipfile, &outzip);
!     tempzf = outzip;
! 
!     if ((tempzip == NULL) || (outzip == NULL))
          ziperr(ZE_TEMP, tempzip);
  
      /* Get password */
      if (getp("Enter password: ", passwd, PWLEN+1) == NULL)
@


1.2
log
@Fix for my fix :-)
@
text
@@


1.1
log
@Fix mktemp() race conditions.
@
text
@d1 2
a2 2
*** zipcloak.c.orig	Tue Nov 25 16:22:20 1997
--- zipcloak.c	Tue Nov 25 16:24:56 1997
d18 1
a18 1
!     tempzip = tempname(zipfile, outzip);
@
