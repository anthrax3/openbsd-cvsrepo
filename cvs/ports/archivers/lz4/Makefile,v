head	1.14;
access;
symbols
	OPENBSD_6_1:1.13.0.2
	OPENBSD_6_1_BASE:1.13
	OPENBSD_6_0:1.12.0.2
	OPENBSD_6_0_BASE:1.12
	OPENBSD_5_9:1.11.0.2
	OPENBSD_5_9_BASE:1.11
	OPENBSD_5_8:1.8.0.4
	OPENBSD_5_8_BASE:1.8
	OPENBSD_5_7:1.5.0.2
	OPENBSD_5_7_BASE:1.5
	OPENBSD_5_6:1.1.1.1.0.4
	OPENBSD_5_6_BASE:1.1.1.1
	OPENBSD_5_5:1.1.1.1.0.2
	OPENBSD_5_5_BASE:1.1.1.1
	sthen_20131112:1.1.1.1
	sthen:1.1.1;
locks; strict;
comment	@# @;


1.14
date	2017.06.27.01.35.20;	author sthen;	state Exp;
branches;
next	1.13;
commitid	9GbF4ACeofL09JTj;

1.13
date	2017.01.05.22.04.37;	author sthen;	state Exp;
branches;
next	1.12;
commitid	7FBqvH5sSBnMehNf;

1.12
date	2016.05.05.02.32.55;	author bentley;	state Exp;
branches;
next	1.11;
commitid	2F1UntGFtkAh9a0h;

1.11
date	2015.12.29.19.49.39;	author jasper;	state Exp;
branches;
next	1.10;
commitid	qnWWfNxRwuFA0B7n;

1.10
date	2015.12.29.12.54.10;	author jasper;	state Exp;
branches;
next	1.9;
commitid	Z7BAKWlffCf6cwcy;

1.9
date	2015.08.30.13.17.31;	author sthen;	state Exp;
branches;
next	1.8;
commitid	mgsp0NRhjxko5X3B;

1.8
date	2015.07.18.21.25.12;	author sthen;	state Exp;
branches
	1.8.4.1;
next	1.7;
commitid	9D7LyIH9FumHzO8L;

1.7
date	2015.06.22.20.46.24;	author sthen;	state Exp;
branches;
next	1.6;
commitid	haxl7vy1CNXllXAr;

1.6
date	2015.05.15.15.32.00;	author sthen;	state Exp;
branches;
next	1.5;
commitid	cqJZoFHsPJqITy0B;

1.5
date	2015.01.12.15.23.09;	author sthen;	state Exp;
branches
	1.5.2.1;
next	1.4;
commitid	jGGjrfFmu2QaQmon;

1.4
date	2014.11.08.14.39.21;	author sthen;	state Exp;
branches;
next	1.3;
commitid	EecpgaeJLdcHSF8F;

1.3
date	2014.10.27.13.42.39;	author sthen;	state Exp;
branches;
next	1.2;
commitid	htIpIySuoTEFQYbU;

1.2
date	2014.10.26.14.15.07;	author sthen;	state Exp;
branches;
next	1.1;
commitid	6hQD8L68ModEBlp5;

1.1
date	2013.11.12.20.00.50;	author sthen;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2013.11.12.20.00.50;	author sthen;	state Exp;
branches;
next	;

1.5.2.1
date	2015.09.02.06.47.49;	author jasper;	state Exp;
branches;
next	;
commitid	fVTAAfG1WnEzoRzP;

1.8.4.1
date	2015.09.02.06.47.44;	author jasper;	state Exp;
branches;
next	;
commitid	eHevNz0O8bAf46Xp;


desc
@@


1.14
log
@update to lz4-1.7.5 + upstream patch for https://github.com/lz4/lz4/issues/369
which reads a byte from invalid memory, crashing tests on OpenBSD. Info at
https://github.com/lz4/lz4/commit/6ad3a983dbf3a25273e04051d29022c72c469cd5
@
text
@# $OpenBSD: Makefile,v 1.13 2017/01/05 22:04:37 sthen Exp $

SHARED_LIBS +=	lz4                       1.1 # 0.0

COMMENT=	fast BSD-licensed data compression

GH_ACCOUNT=	lz4
GH_PROJECT=	lz4
GH_TAGNAME=	v1.7.5

CATEGORIES=	archivers

HOMEPAGE=	https://fastcompression.blogspot.com/p/lz4.html

MAINTAINER=	Stuart Henderson <sthen@@openbsd.org>

# library: BSD, tools: GPLv2
PERMIT_PACKAGE_CDROM=	Yes

WANTLIB += c

USE_GMAKE=	Yes
MAKE_FLAGS=	CC="${CC}" \
		CFLAGS="${CFLAGS}" \
		MANDIR="${PREFIX}/man/man1" \
		SONAME_FLAGS= \
		SHARED_EXT_VER="so.${LIBlz4_VERSION}"
FAKE_FLAGS=	PREFIX=${PREFIX}

post-install:
	mv ${PREFIX}/libdata/pkgconfig/* ${PREFIX}/lib/pkgconfig/
	rmdir ${PREFIX}/libdata/pkgconfig
	rm ${PREFIX}/lib/liblz4.so{.1,}

.include <bsd.port.mk>
@


1.13
log
@update to lz4-1.7.4.2 (not 1.7.5 yet as it segfaults during tests)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2016/05/05 02:32:55 bentley Exp $
d3 1
a3 1
SHARED_LIBS +=	lz4                       1.0 # 0.0
d9 1
a9 1
GH_TAGNAME=	v1.7.4.2
d30 4
a33 4
# XXX upstream are shipping a "test" directory, breaking the "make test"
# target in their Makefile.
pre-test:
	rm -rf ${WRKSRC}/test
@


1.12
log
@Use https for Blogspot URLs.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2015/12/29 19:49:39 jasper Exp $
d3 1
a3 1
SHARED_LIBS +=	lz4                       0.2 # 0.0
d7 1
a7 1
GH_ACCOUNT=	Cyan4973
d9 1
a9 4
GH_TAGNAME=	r131
PKGNAME=	lz4-0.${GH_TAGNAME:S/r//}
REVISION=	1
WRKDIST=	${WRKDIR}/lz4-${GH_TAGNAME}
@


1.11
log
@DISTNAME is set by bsd.port.mk for these ports now
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2015/12/29 12:54:10 jasper Exp $
d11 1
a11 1
REVISION=	0
d16 1
a16 1
HOMEPAGE=	http://fastcompression.blogspot.com/p/lz4.html
@


1.10
log
@use GH_PROJECT to construct DISTNAME
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2015/08/30 13:17:31 sthen Exp $
a9 1
DISTNAME=	${GH_PROJECT}-${GH_TAGNAME}
@


1.9
log
@Fix lz4's installed .pc file to avoid using the fake prefix. From Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2015/07/18 21:25:12 sthen Exp $
d10 1
a10 1
DISTNAME=	lz4-${GH_TAGNAME}
@


1.8
log
@update to LZ4 r131
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2015/06/22 20:46:24 sthen Exp $
d12 1
d29 1
a29 1
		MANDIR="${WRKINST}/${PREFIX}/man/man1" \
d32 1
a32 1
FAKE_FLAGS=	DESTDIR=
@


1.8.4.1
log
@Fix lz4's installed .pc file to avoid using the fake prefix. From Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2015/07/18 21:25:12 sthen Exp $
a11 1
REVISION=	0
d28 1
a28 1
		MANDIR="${PREFIX}/man/man1" \
d31 1
a31 1
FAKE_FLAGS=	PREFIX=${PREFIX}
@


1.7
log
@update to lz4 r130
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2015/05/15 15:32:00 sthen Exp $
d9 1
a9 1
GH_TAGNAME=	r130
@


1.6
log
@update to lz4-r129
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2015/01/12 15:23:09 sthen Exp $
d9 1
a9 1
GH_TAGNAME=	r129
d32 5
@


1.5
log
@update to lz4 r127
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2014/11/08 14:39:21 sthen Exp $
d3 1
a3 1
SHARED_LIBS +=	lz4                       0.1 # 0.0
d9 1
a9 1
GH_TAGNAME=	r127
@


1.5.2.1
log
@Fix lz4's installed .pc file to avoid using the fake prefix. From Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2015/01/12 15:23:09 sthen Exp $
a11 1
REVISION=	0
d28 1
a28 1
		MANDIR="${PREFIX}/man/man1" \
d31 1
a31 1
FAKE_FLAGS=	PREFIX=${PREFIX}
@


1.4
log
@update to lz4 r124
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2014/10/27 13:42:39 sthen Exp $
d9 1
a9 1
GH_TAGNAME=	r124
a24 1
#MODULES=	devel/cmake
d30 1
a30 1
		SHARED_EXT_VER="so.${LIBlz4_VERSION:R}.${LIBlz4_VERSION:E}"
a31 7
#WRKSRC=		${WRKDIST}/cmake
#CONFIGURE_ARGS=	-DBUILD_SHARED_LIBS=true


xxpost-install:
	mv ${PREFIX}/bin/lz4c* ${PREFIX}/bin/lz4c
	${INSTALL_MAN} ${WRKDIST}/lz4.1 ${PREFIX}/man/man1/lz4c.1
@


1.3
log
@use a portroach-compatible distname
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2014/10/26 14:15:07 sthen Exp $
d3 1
a3 1
SHARED_LIBS +=	lz4                       0.0 # 0.0
d9 1
a9 1
GH_TAGNAME=	r123
@


1.2
log
@update to lz4 r123
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2013/11/12 20:00:50 sthen Exp $
d10 2
a11 1
DISTNAME=	lz4-0.${GH_TAGNAME:S/r//}
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d7 5
a11 1
DISTNAME=	lz4-0.0.20131102
d24 10
a33 1
MASTER_SITES=	http://spacehopper.org/mirrors/
a34 3
MODULES=	devel/cmake
WRKSRC=		${WRKDIST}/cmake
CONFIGURE_ARGS=	-DBUILD_SHARED_LIBS=true
d36 1
a36 9
NO_TEST=	Yes

# the build is a little messy; there's also a GNU Makefile, which builds
# an additional version of the tool (just with a macro defined to disable some
# old options), and some additional test tools (benchmark and fuzzer), but only
# the CMake build includes the library.

# cmakefiles install as lz4c64/lz4c32 for 64/32-bit; rename for sane packaging
post-install:
@


1.1.1.1
log
@import ports/archivers/lz4, ok jca@@

LZ4 is a very fast lossless compression algorithm, providing compression
speed at 400 MB/s per core, scalable with multi-cores CPU. It also features
an extremely fast decoder, with speed in multiple GB/s per core, typically
reaching RAM speed limits on multi-core systems. The library is BSD-licensed.
@
text
@@
