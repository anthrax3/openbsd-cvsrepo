head	1.1;
access;
symbols
	OPENBSD_6_2:1.1.0.6
	OPENBSD_6_2_BASE:1.1
	OPENBSD_6_1:1.1.0.4
	OPENBSD_6_1_BASE:1.1
	OPENBSD_6_0:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2017.03.23.17.26.17;	author bluhm;	state Exp;
branches
	1.1.2.1;
next	;
commitid	AKvOWgM1JlPfL9UC;

1.1.2.1
date	2017.03.27.12.25.15;	author pirofti;	state Exp;
branches;
next	;
commitid	dwmOwe5VLIc9aQKL;


desc
@@


1.1
log
@Apply a bunch of CVE and other fixes for unzip from debian and
redhat bug tracker.  Add the links to the patch files.  The fix for
CVE-2014-9636 was improved.
OK jca@@
@
text
@$OpenBSD$

Fix CVE-2015-7696: upstream fix for heap overflow
    https://bugs.debian.org/802162
    https://bugzilla.redhat.com/show_bug.cgi?id=1260944
    https://bugzilla.redhat.com/attachment.cgi?id=1073002

--- crypt.c.orig	Fri Jan  5 16:47:36 2007
+++ crypt.c	Tue Mar 21 16:10:27 2017
@@@@ -465,7 +465,17 @@@@ int decrypt(__G__ passwrd)
     GLOBAL(pInfo->encrypted) = FALSE;
     defer_leftover_input(__G);
     for (n = 0; n < RAND_HEAD_LEN; n++) {
-        b = NEXTBYTE;
+        /* 2012-11-23 SMS.  (OUSPG report.)
+         * Quit early if compressed size < HEAD_LEN.  The resulting
+         * error message ("unable to get password") could be improved,
+         * but it's better than trying to read nonexistent data, and
+         * then continuing with a negative G.csize.  (See
+         * fileio.c:readbyte()).
+         */
+        if ((b = NEXTBYTE) == (ush)EOF)
+        {
+            return PK_ERR;
+        }
         h[n] = (uch)b;
         Trace((stdout, " (%02x)", h[n]));
     }
@


1.1.2.1
log
@Backport the unzip CVE fixes committed by bluhm@@.

%-------------------------------------------------------------------
 Apply a bunch of CVE and other fixes for unzip from debian and
 redhat bug tracker.  Add the links to the patch files.  The fix for
 CVE-2014-9636 was improved.
 OK jca@@
%-------------------------------------------------------------------

OK robert@@.
@
text
@@

