head	1.3;
access;
symbols
	OPENBSD_6_0:1.2.0.4
	OPENBSD_6_0_BASE:1.2
	OPENBSD_5_9:1.2.0.2
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.1.0.22
	OPENBSD_5_8_BASE:1.1
	OPENBSD_5_7:1.1.0.18
	OPENBSD_5_7_BASE:1.1
	OPENBSD_5_6:1.1.0.16
	OPENBSD_5_6_BASE:1.1
	OPENBSD_5_5:1.1.0.14
	OPENBSD_5_5_BASE:1.1
	OPENBSD_5_4:1.1.0.12
	OPENBSD_5_4_BASE:1.1
	OPENBSD_5_3:1.1.0.10
	OPENBSD_5_3_BASE:1.1
	OPENBSD_5_2:1.1.0.8
	OPENBSD_5_2_BASE:1.1
	OPENBSD_5_1_BASE:1.1
	OPENBSD_5_1:1.1.0.6
	OPENBSD_5_0:1.1.0.4
	OPENBSD_5_0_BASE:1.1
	OPENBSD_4_9:1.1.0.2
	OPENBSD_4_9_BASE:1.1;
locks; strict;
comment	@# @;


1.3
date	2016.11.02.22.28.52;	author jasper;	state Exp;
branches;
next	1.2;
commitid	dAqURehEtrAtIU8t;

1.2
date	2015.11.20.15.15.21;	author ajacoutot;	state Exp;
branches;
next	1.1;
commitid	BNKyxx2cyu0IYFaM;

1.1
date	2010.10.15.18.50.23;	author sthen;	state Exp;
branches;
next	;


desc
@@


1.3
log
@update to p5-Archive-Zip-1.59
@
text
@$OpenBSD: patch-lib_Archive_Zip_Member_pm,v 1.2 2015/11/20 15:15:21 ajacoutot Exp $

http://rt.cpan.org/Public/Bug/Display.html?id=61930

--- lib/Archive/Zip/Member.pm.orig	Thu Aug 11 22:06:33 2016
+++ lib/Archive/Zip/Member.pm	Wed Nov  2 20:27:03 2016
@@@@ -304,7 +304,7 @@@@ sub _mapPermissionsToUnix {
     if ($format == FA_AMIGA) {
         $attribs = $attribs >> 17 & 7;                         # Amiga RWE bits
         $mode    = $attribs << 6 | $attribs << 3 | $attribs;
-        return $mode;
+        return sprintf("%d", $mode);
     }
 
     if ($format == FA_THEOS) {
@@@@ -324,7 +324,10 @@@@ sub _mapPermissionsToUnix {
         || $format == FA_QDOS
         || $format == FA_TANDEM) {
         $mode = $attribs >> 16;
-        return $mode if $mode != 0 or not $self->localExtraField;
+        if( $mode != 0 or not $self->localExtraField) {
+           $mode = sprintf("%d", $mode);
+            return sprintf("%d", $mode);
+        }
 
         # warn("local extra field is: ", $self->localExtraField, "\n");
 
@@@@ -360,9 +363,13 @@@@ sub _mapPermissionsToUnix {
 
     # keep previous $mode setting when its "owner"
     # part appears to be consistent with DOS attribute flags!
-    return $mode if ($mode & 0700) == (0400 | $attribs << 6);
+    if( ( $mode & 0700 ) == ( 0400 | $attribs << 6 )) {
+       $mode = sprintf("%d", $mode);
+       return sprintf("%d", $mode);
+    }
     $mode = 0444 | $attribs << 6 | $attribs << 3 | $attribs;
-    return $mode;
+    $mode = sprintf("%d", $mode);
+    return sprintf("%d", $mode);
 }
 
 sub unixFileAttributes {
@


1.2
log
@Update to p5-Archive-Zip-1.53.
@
text
@d1 1
a1 1
$OpenBSD: patch-lib_Archive_Zip_Member_pm,v 1.1 2010/10/15 18:50:23 sthen Exp $
d5 3
a7 3
--- lib/Archive/Zip/Member.pm.orig	Wed Sep 23 19:41:14 2015
+++ lib/Archive/Zip/Member.pm	Fri Nov 20 16:13:00 2015
@@@@ -295,7 +295,7 @@@@ sub _mapPermissionsToUnix {
d16 1
a16 1
@@@@ -315,7 +315,10 @@@@ sub _mapPermissionsToUnix {
d28 1
a28 1
@@@@ -351,9 +354,13 @@@@ sub _mapPermissionsToUnix {
@


1.1
log
@Add a taint mode fix for newer Perl, from CPAN RT. Fixes a problem with
MailScanner noted by Brad, tested by Brad and myself.
@
text
@d1 1
a1 1
$OpenBSD$
d5 4
a8 4
--- lib/Archive/Zip/Member.pm.orig	Tue Jun 30 12:51:10 2009
+++ lib/Archive/Zip/Member.pm	Fri Oct 15 19:04:27 2010
@@@@ -282,7 +282,7 @@@@ sub _mapPermissionsToUnix {
     if ( $format == FA_AMIGA ) {
d15 4
a18 4
     if ( $format == FA_THEOS ) {
@@@@ -304,7 +304,10 @@@@ sub _mapPermissionsToUnix {
         || $format == FA_TANDEM )
     {
d28 1
a28 1
@@@@ -340,9 +343,13 @@@@ sub _mapPermissionsToUnix {
d32 1
a32 1
-    return $mode if ( $mode & 0700 ) == ( 0400 | $attribs << 6 );
d35 1
a35 1
+        return sprintf("%d", $mode);
@

