head	1.1;
access;
symbols
	OPENBSD_6_1:1.1.0.6
	OPENBSD_6_1_BASE:1.1
	OPENBSD_6_0:1.1.0.4
	OPENBSD_6_0_BASE:1.1
	OPENBSD_5_9:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2016.06.28.09.56.23;	author jasper;	state Exp;
branches
	1.1.2.1;
next	;
commitid	9eVBomDy0HiVd2I3;

1.1.2.1
date	2016.06.28.09.57.30;	author jasper;	state Exp;
branches;
next	;
commitid	snLyeGLrMd9lIy2l;


desc
@@


1.1
log
@Fix for CVE-2016-3189; proposed patch from RH
@
text
@$OpenBSD$

CVE-2016-3189 bzip2: heap use after free in bzip2recover
Patch from: https://bugzilla.redhat.com/show_bug.cgi?id=1319648

--- bzip2recover.c.orig	Tue Jun 28 11:54:25 2016
+++ bzip2recover.c	Tue Jun 28 11:54:43 2016
@@@@ -457,6 +457,7 @@@@ Int32 main ( Int32 argc, Char** argv )
             bsPutUChar ( bsWr, 0x50 ); bsPutUChar ( bsWr, 0x90 );
             bsPutUInt32 ( bsWr, blockCRC );
             bsClose ( bsWr );
+	    outFile = NULL;
          }
          if (wrBlock >= rbCtr) break;
          wrBlock++;
@


1.1.2.1
log
@missed in previous
@
text
@d1 1
a1 1
$OpenBSD: patch-bzip2recover_c,v 1.1 2016/06/28 09:56:23 jasper Exp $
@

