head	1.73;
access;
symbols
	OPENBSD_6_0:1.73.0.2
	OPENBSD_6_0_BASE:1.73
	OPENBSD_5_9:1.71.0.2
	OPENBSD_5_9_BASE:1.71
	OPENBSD_5_8:1.64.0.8
	OPENBSD_5_8_BASE:1.64
	OPENBSD_5_7:1.64.0.4
	OPENBSD_5_7_BASE:1.64
	OPENBSD_5_6:1.64.0.2
	OPENBSD_5_6_BASE:1.64
	OPENBSD_5_5:1.62.0.4
	OPENBSD_5_5_BASE:1.62
	OPENBSD_5_4:1.62.0.2
	OPENBSD_5_4_BASE:1.62
	OPENBSD_5_3:1.60.0.6
	OPENBSD_5_3_BASE:1.60
	OPENBSD_5_2:1.60.0.4
	OPENBSD_5_2_BASE:1.60
	OPENBSD_5_1_BASE:1.60
	OPENBSD_5_1:1.60.0.2
	OPENBSD_5_0:1.59.0.4
	OPENBSD_5_0_BASE:1.59
	OPENBSD_4_9:1.59.0.2
	OPENBSD_4_9_BASE:1.59
	OPENBSD_4_8:1.57.0.10
	OPENBSD_4_8_BASE:1.57
	OPENBSD_4_7:1.57.0.8
	OPENBSD_4_7_BASE:1.57
	OPENBSD_4_6:1.57.0.6
	OPENBSD_4_6_BASE:1.57
	OPENBSD_4_5:1.57.0.4
	OPENBSD_4_5_BASE:1.57
	OPENBSD_4_4:1.57.0.2
	OPENBSD_4_4_BASE:1.57
	OPENBSD_4_3:1.56.0.2
	OPENBSD_4_3_BASE:1.56
	OPENBSD_4_2:1.54.0.4
	OPENBSD_4_2_BASE:1.54
	OPENBSD_4_1:1.54.0.2
	OPENBSD_4_1_BASE:1.54
	OPENBSD_4_0:1.53.0.4
	OPENBSD_4_0_BASE:1.53
	OPENBSD_3_9:1.53.0.2
	OPENBSD_3_9_BASE:1.53
	OPENBSD_3_8:1.50.0.2
	OPENBSD_3_8_BASE:1.50
	OPENBSD_3_7:1.48.0.2
	OPENBSD_3_7_BASE:1.48
	OPENBSD_3_6:1.47.0.2
	OPENBSD_3_6_BASE:1.47
	OPENBSD_3_5:1.46.0.4
	OPENBSD_3_5_BASE:1.46
	OPENBSD_3_4:1.46.0.2
	OPENBSD_3_4_BASE:1.46
	OPENBSD_3_3:1.44.0.2
	OPENBSD_3_3_BASE:1.44
	OPENBSD_3_2:1.43.0.2
	OPENBSD_3_2_BASE:1.43
	OPENBSD_3_1:1.42.0.2
	OPENBSD_3_1_BASE:1.42
	OPENBSD_3_0:1.39.0.2
	OPENBSD_3_0_BASE:1.39
	OPENBSD_2_9_TRACKING_SWITCH:1.34
	OPENBSD_2_9:1.33.0.2
	OPENBSD_2_9_BASE:1.33
	OPENBSD_2_8:1.29.0.2
	OPENBSD_2_8_BASE:1.29
	OPENBSD_2_7:1.22.0.2
	OPENBSD_2_7_BASE:1.22
	OPENBSD_2_6:1.13.0.2
	OPENBSD_2_6_BASE:1.13
	OPENBSD_2_5:1.8.0.2
	OPENBSD_2_5_BASE:1.8
	OPENBSD_2_4:1.5.0.2
	OPENBSD_2_4_BASE:1.5
	OPENBSD_2_3:1.3.0.2
	OPENBSD_2_3_BASE:1.3;
locks; strict;
comment	@# @;


1.73
date	2016.06.28.09.56.23;	author jasper;	state Exp;
branches;
next	1.72;
commitid	9eVBomDy0HiVd2I3;

1.72
date	2016.03.10.21.58.51;	author naddy;	state Exp;
branches;
next	1.71;
commitid	g78OHI8ulpVtt3HS;

1.71
date	2016.01.15.19.57.23;	author sthen;	state Exp;
branches
	1.71.2.1;
next	1.70;
commitid	E468onXLCPTmHVpN;

1.70
date	2015.10.15.20.14.36;	author sthen;	state Exp;
branches;
next	1.69;
commitid	tQ0qKnMlBgGwmRFJ;

1.69
date	2015.10.15.00.17.48;	author sthen;	state Exp;
branches;
next	1.68;
commitid	8kamreRkC8LmJHzu;

1.68
date	2015.10.15.00.08.58;	author sthen;	state Exp;
branches;
next	1.67;
commitid	Vi21nns8PTgO8Z2J;

1.67
date	2015.10.11.21.07.32;	author sthen;	state Exp;
branches;
next	1.66;
commitid	kd2Bxk2j7k7s5Xrh;

1.66
date	2015.10.09.06.50.19;	author jasper;	state Exp;
branches;
next	1.65;
commitid	qsf20buHm8cnJHOr;

1.65
date	2015.10.07.11.06.49;	author sthen;	state Exp;
branches;
next	1.64;
commitid	jPENlfiMNsIiS7wK;

1.64
date	2014.05.24.20.51.54;	author naddy;	state Exp;
branches;
next	1.63;

1.63
date	2014.03.19.13.40.59;	author jasper;	state Exp;
branches;
next	1.62;

1.62
date	2013.04.04.16.03.55;	author brad;	state Exp;
branches;
next	1.61;

1.61
date	2013.03.10.22.28.04;	author espie;	state Exp;
branches;
next	1.60;

1.60
date	2011.12.18.09.01.19;	author ajacoutot;	state Exp;
branches;
next	1.59;

1.59
date	2010.10.18.16.47.00;	author espie;	state Exp;
branches;
next	1.58;

1.58
date	2010.09.20.18.21.10;	author naddy;	state Exp;
branches;
next	1.57;

1.57
date	2008.03.18.18.44.31;	author naddy;	state Exp;
branches
	1.57.8.1
	1.57.10.1;
next	1.56;

1.56
date	2008.01.04.17.48.33;	author espie;	state Exp;
branches
	1.56.2.1;
next	1.55;

1.55
date	2007.09.15.10.14.32;	author espie;	state Exp;
branches;
next	1.54;

1.54
date	2007.01.25.21.08.22;	author naddy;	state Exp;
branches;
next	1.53;

1.53
date	2006.02.03.20.00.33;	author steven;	state Exp;
branches
	1.53.2.1
	1.53.4.1;
next	1.52;

1.52
date	2005.12.23.13.57.21;	author espie;	state Exp;
branches;
next	1.51;

1.51
date	2005.10.30.00.10.39;	author fgsch;	state Exp;
branches;
next	1.50;

1.50
date	2005.05.16.23.00.59;	author naddy;	state Exp;
branches;
next	1.49;

1.49
date	2005.04.17.19.42.38;	author espie;	state Exp;
branches;
next	1.48;

1.48
date	2004.11.21.12.50.32;	author espie;	state Exp;
branches;
next	1.47;

1.47
date	2004.04.06.06.33.29;	author brad;	state Exp;
branches;
next	1.46;

1.46
date	2003.06.23.03.30.24;	author jolan;	state Exp;
branches;
next	1.45;

1.45
date	2003.05.24.01.01.24;	author jolan;	state Exp;
branches;
next	1.44;

1.44
date	2002.12.29.15.15.18;	author fgsch;	state Exp;
branches;
next	1.43;

1.43
date	2002.05.12.21.37.03;	author brad;	state Exp;
branches;
next	1.42;

1.42
date	2002.02.03.06.16.09;	author brad;	state Exp;
branches;
next	1.41;

1.41
date	2002.01.27.20.00.16;	author pvalchev;	state Exp;
branches;
next	1.40;

1.40
date	2001.10.31.16.49.46;	author brad;	state Exp;
branches;
next	1.39;

1.39
date	2001.10.15.14.16.34;	author pvalchev;	state Exp;
branches;
next	1.38;

1.38
date	2001.10.09.02.05.29;	author brad;	state Exp;
branches;
next	1.37;

1.37
date	2001.10.04.22.26.48;	author espie;	state Exp;
branches;
next	1.36;

1.36
date	2001.09.26.18.38.43;	author heko;	state Exp;
branches;
next	1.35;

1.35
date	2001.08.26.21.23.42;	author heko;	state Exp;
branches;
next	1.34;

1.34
date	2001.07.13.11.23.37;	author naddy;	state Exp;
branches;
next	1.33;

1.33
date	2001.04.20.17.35.32;	author brad;	state Exp;
branches;
next	1.32;

1.32
date	2001.04.20.15.09.11;	author espie;	state Exp;
branches;
next	1.31;

1.31
date	2001.03.29.15.01.53;	author brad;	state Exp;
branches;
next	1.30;

1.30
date	2001.03.24.22.37.58;	author brad;	state Exp;
branches;
next	1.29;

1.29
date	2000.09.24.01.23.42;	author brad;	state Exp;
branches;
next	1.28;

1.28
date	2000.09.16.11.44.22;	author brad;	state Exp;
branches;
next	1.27;

1.27
date	2000.07.01.02.00.52;	author brad;	state Exp;
branches;
next	1.26;

1.26
date	2000.06.25.03.56.58;	author brad;	state Exp;
branches;
next	1.25;

1.25
date	2000.06.10.18.51.44;	author brad;	state Exp;
branches;
next	1.24;

1.24
date	2000.06.02.13.44.53;	author brad;	state Exp;
branches;
next	1.23;

1.23
date	2000.05.26.01.56.09;	author kevlo;	state Exp;
branches;
next	1.22;

1.22
date	2000.03.30.23.10.55;	author brad;	state Exp;
branches
	1.22.2.1;
next	1.21;

1.21
date	2000.03.24.22.11.33;	author espie;	state Exp;
branches;
next	1.20;

1.20
date	2000.03.06.22.05.13;	author brad;	state Exp;
branches;
next	1.19;

1.19
date	2000.03.05.08.28.32;	author brad;	state Exp;
branches;
next	1.18;

1.18
date	2000.02.15.05.03.51;	author turan;	state Exp;
branches;
next	1.17;

1.17
date	2000.02.12.06.29.49;	author turan;	state Exp;
branches;
next	1.16;

1.16
date	2000.01.19.14.57.07;	author kevlo;	state Exp;
branches;
next	1.15;

1.15
date	99.12.28.23.37.32;	author brad;	state Exp;
branches;
next	1.14;

1.14
date	99.12.28.06.13.05;	author brad;	state Exp;
branches;
next	1.13;

1.13
date	99.09.25.13.01.12;	author turan;	state Exp;
branches;
next	1.12;

1.12
date	99.09.24.13.29.46;	author brad;	state Exp;
branches;
next	1.11;

1.11
date	99.08.11.03.28.11;	author brad;	state Exp;
branches;
next	1.10;

1.10
date	99.05.09.01.40.06;	author brad;	state Exp;
branches;
next	1.9;

1.9
date	99.04.20.00.13.48;	author brad;	state Exp;
branches;
next	1.8;

1.8
date	99.04.01.02.16.36;	author brad;	state Exp;
branches;
next	1.7;

1.7
date	99.02.21.09.13.01;	author fgsch;	state Exp;
branches;
next	1.6;

1.6
date	99.02.11.05.51.07;	author fgsch;	state Exp;
branches;
next	1.5;

1.5
date	98.09.14.05.41.17;	author marc;	state Exp;
branches;
next	1.4;

1.4
date	98.09.11.05.22.54;	author mickey;	state Exp;
branches;
next	1.3;

1.3
date	98.02.21.02.58.53;	author marc;	state Exp;
branches;
next	1.2;

1.2
date	97.11.25.21.36.28;	author angelos;	state Exp;
branches;
next	1.1;

1.1
date	97.11.24.19.26.36;	author angelos;	state Exp;
branches;
next	;

1.22.2.1
date	2000.09.15.04.40.29;	author marc;	state Exp;
branches;
next	;

1.53.2.1
date	2007.01.31.14.32.11;	author sturm;	state Exp;
branches;
next	;

1.53.4.1
date	2007.02.03.16.30.25;	author sturm;	state Exp;
branches;
next	;

1.56.2.1
date	2008.06.09.16.44.09;	author robert;	state Exp;
branches;
next	;

1.57.8.1
date	2010.10.04.02.48.55;	author william;	state Exp;
branches;
next	;

1.57.10.1
date	2010.10.04.02.52.52;	author william;	state Exp;
branches;
next	;

1.71.2.1
date	2016.06.28.09.57.13;	author jasper;	state Exp;
branches;
next	;
commitid	ta3pBpmsAunvmRcw;


desc
@@


1.73
log
@Fix for CVE-2016-3189; proposed patch from RH
@
text
@# $OpenBSD: Makefile,v 1.72 2016/03/10 21:58:51 naddy Exp $

COMMENT=	block-sorting file compressor, unencumbered

VERSION=	1.0.6
DISTNAME=	bzip2-${VERSION}
REVISION=	8
CATEGORIES=	archivers
MASTER_SITES=	${HOMEPAGE}${VERSION}/
SHARED_LIBS=	bz2	10.4

HOMEPAGE=	http://www.bzip.org/

# BSD
PERMIT_PACKAGE_CDROM=	Yes

# uses pledge()
WANTLIB += c

BZ2_CFLAGS=	-Wall -Winline -fomit-frame-pointer -fno-strength-reduce

MAKE_FLAGS=	CC="${CC}" CFLAGS="${CFLAGS} ${BZ2_CFLAGS}" \
		LIBbz2_VERSION=${LIBbz2_VERSION} PREFIX=${TRUEPREFIX}
TEST_FLAGS=	LD_LIBRARY_PATH="${WRKBUILD}" LIBbz2_VERSION=${LIBbz2_VERSION}

TEST_TARGET=	test

post-install:
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/bzip2
	${INSTALL_DATA} ${WRKBUILD}/manual.html ${PREFIX}/share/doc/bzip2

.include <bsd.port.mk>
@


1.72
log
@remove various instances of NO_SHARED_LIBS and PROPERTIES:Mno_shared,
fold PFRAG.shared into PLIST
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.71 2016/01/15 19:57:23 sthen Exp $
d7 1
a7 1
REVISION=	7
@


1.71
log
@add an easily-greppable marker for ports known to use pledge().
it's not so important while they're only in patches in the ports tree,
but for any which get upstreamed it saves a ~100GB grep to find them.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.70 2015/10/15 20:14:36 sthen Exp $
a32 4

.if defined(NO_SHARED_LIBS) && ${NO_SHARED_LIBS:L} == "yes"
MAKE_ENV+=	NO_SHARED_LIBS=Yes
.endif
@


1.71.2.1
log
@Fix for CVE-2016-3189; proposed patch from RH
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.71 2016/01/15 19:57:23 sthen Exp $
d7 1
a7 1
REVISION=	8
@


1.70
log
@If bzip2 is used to compress or decompress a single file to stdout,
or if it's used in a pipeline, then it can further pledge to only use
stdio-related system calls while doing the actual de/compression.
Since ports uses 'bzip2 -dc [file] | tar xf -', it can benefit from
this added protection during file extraction.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.69 2015/10/15 00:17:48 sthen Exp $
d17 1
@


1.69
log
@use standard "local" error handling (sprintf+exit/message_fatal) rather than
err() to avoid the need to pull in err.h, idea from deraadt
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.68 2015/10/15 00:08:58 sthen Exp $
d7 1
a7 1
REVISION=	6
@


1.68
log
@err.h for bzip2 as well, pointed out by jca@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.67 2015/10/11 21:07:32 sthen Exp $
d7 1
a7 1
REVISION=	5
@


1.67
log
@bzip2 now also needs rpath
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.66 2015/10/09 06:50:19 jasper Exp $
d7 1
a7 1
REVISION=	4
d17 1
a17 1
WANTLIB=	c
@


1.66
log
@tame -> pledge
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.65 2015/10/07 11:06:49 sthen Exp $
d7 1
a7 1
REVISION=	3
@


1.65
log
@bzip2 only needs stdio and some file operations, so it can be tame()'d early
in main().
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.64 2014/05/24 20:51:54 naddy Exp $
d7 1
a7 1
REVISION=	2
@


1.64
log
@landry@@ ran into a bashism; lift portable replacement code from GNU gzip 1.6
ok landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.63 2014/03/19 13:40:59 jasper Exp $
d7 1
a7 1
REVISION=	1
d16 1
@


1.63
log
@remove m68k-related workarounds
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62 2013/04/04 16:03:55 brad Exp $
d7 1
a7 1
REVISION=	0
@


1.62
log
@sync distinfo and merge in PFRAG.shared.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.61 2013/03/10 22:28:04 espie Exp $
d18 1
a18 4
BZ2_CFLAGS=	-Wall -Winline
.if ${MACHINE_ARCH} != "m68k"
BZ2_CFLAGS+=	-fomit-frame-pointer -fno-strength-reduce
.endif
@


1.61
log
@regress -> test
PERMIT_* cleanup
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.60 2011/12/18 09:01:19 ajacoutot Exp $
d7 1
@


1.60
log
@Remove USE_GROFF from ports where mandoc doesn't have any ERRORs and
formatting looks Ok.

from Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59 2010/10/18 16:47:00 espie Exp $
a14 3
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
d24 1
a24 1
REGRESS_FLAGS=	LD_LIBRARY_PATH="${WRKBUILD}" LIBbz2_VERSION=${LIBbz2_VERSION}
d26 1
a26 1
REGRESS_TARGET=	test
@


1.59
log
@USE_GROFF=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2010/09/20 18:21:10 naddy Exp $
a29 1
USE_GROFF =	Yes
@


1.58
log
@SECURITY update to 1.0.6, which fixes an integer overflow, CVE-2010-0405.
ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.57 2008/03/18 18:44:31 naddy Exp $
d30 1
@


1.57
log
@SECURITY:
Update to 1.0.5, which includes integer overflow checks.
Fixes CERT-FI 20469.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2008/01/04 17:48:33 espie Exp $
d5 1
a5 1
VERSION=	1.0.5
@


1.57.10.1
log
@MFC:

- - -
date: 2010/09/20 18:21:10;  author: naddy;  state: Exp;  lines: +2 -2
SECURITY update to 1.0.6, which fixes an integer overflow, CVE-2010-0405.
ok jasper@@
- - -
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.57 2008/03/18 18:44:31 naddy Exp $
d5 1
a5 1
VERSION=	1.0.6
@


1.57.8.1
log
@MFC:

- - -
date: 2010/09/20 18:21:10;  author: naddy;  state: Exp;  lines: +2 -2
SECURITY update to 1.0.6, which fixes an integer overflow, CVE-2010-0405.
ok jasper@@
- - -
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.57 2008/03/18 18:44:31 naddy Exp $
d5 1
a5 1
VERSION=	1.0.6
@


1.56
log
@tweak FAKE_FLAGS semantics to saner defaults.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55 2007/09/15 10:14:32 espie Exp $
d5 1
a5 1
VERSION=	1.0.4
@


1.56.2.1
log
@SECURITY:
Update to 1.0.5, which includes integer overflow checks.
Fixes CERT-FI 20469.

from William Yodlowsky
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2008/01/04 17:48:33 espie Exp $
d5 1
a5 1
VERSION=	1.0.5
@


1.55
log
@zap all quotes in COMMENT/PERMIT_*
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.54 2007/01/25 21:08:22 naddy Exp $
a26 1
FAKE_FLAGS=	${MAKE_FLAGS} DESTDIR=${WRKINST}
@


1.54
log
@SECURITY update to 1.0.4:
* Fix file permissions race problem (CVE-2005-0953).
* Avoid possible segfault in BZ2_bzclose.
* Sanitise file names more carefully in bzgrep.  Fixes CVE-2005-0758
  to the extent that applies to bzgrep.
* Use 'mktemp' rather than 'tempfile' in bzdiff.
* Tighten up a couple of assertions in blocksort.c following automated
  analysis.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2006/02/03 20:00:33 steven Exp $
d3 1
a3 1
COMMENT=	"block-sorting file compressor, unencumbered"
@


1.53
log
@pass shared library version in REGRESS_FLAGS, otherwise regress target
rebuilds it without version number.

ok sturm@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.52 2005/12/23 13:57:21 espie Exp $
d5 1
a5 1
VERSION=	1.0.3
d9 1
a9 1
SHARED_LIBS=	bz2	10.3
@


1.53.4.1
log
@MFC:
SECURITY update to 1.0.4:
* Fix file permissions race problem (CVE-2005-0953).
* Avoid possible segfault in BZ2_bzclose.
* Sanitise file names more carefully in bzgrep.  Fixes CVE-2005-0758
to the extent that applies to bzgrep.
* Use 'mktemp' rather than 'tempfile' in bzdiff.
* Tighten up a couple of assertions in blocksort.c following automated
analysis.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2006/02/03 20:00:33 steven Exp $
d5 1
a5 1
VERSION=	1.0.4
d9 1
a9 1
SHARED_LIBS=	bz2	10.4
@


1.53.2.1
log
@MFC:
SECURITY update to 1.0.4:
* Fix file permissions race problem (CVE-2005-0953).
* Avoid possible segfault in BZ2_bzclose.
* Sanitise file names more carefully in bzgrep.  Fixes CVE-2005-0758
to the extent that applies to bzgrep.
* Use 'mktemp' rather than 'tempfile' in bzdiff.
* Tighten up a couple of assertions in blocksort.c following automated
analysis.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2006/02/03 20:00:33 steven Exp $
d5 1
a5 1
VERSION=	1.0.4
d9 1
a9 1
SHARED_LIBS=	bz2	10.4
@


1.52
log
@use SHARED_LIBS
USE_LIBTOOL where appropriate (and bump PKGNAME)
tweak a few FAKE_FLAGS to be more uniform.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 2005/10/30 00:10:39 fgsch Exp $
d25 4
a28 3
MAKE_FLAGS=	CC="${CC}" CFLAGS="${CFLAGS} ${BZ2_CFLAGS}" LIBbz2_VERSION=${LIBbz2_VERSION} PREFIX=${TRUEPREFIX}
FAKE_FLAGS=${MAKE_FLAGS} DESTDIR=${WRKINST}
REGRESS_FLAGS=	LD_LIBRARY_PATH="${WRKBUILD}"
@


1.51
log
@after querying brad@@ he decided to drop maintainership for these.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2005/05/16 23:00:59 naddy Exp $
d9 1
d25 2
a26 2
MAKE_FLAGS=	CC="${CC}" CFLAGS="${CFLAGS} ${BZ2_CFLAGS}"
FAKE_FLAGS=	${MAKE_FLAGS} PREFIX="${PREFIX}" DESTDIR="${WRKINST}"
@


1.50
log
@Maintenance update to 1.0.3.
- minor bug fixes only
- no more .info manual

ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2005/04/17 19:42:38 espie Exp $
a10 2

MAINTAINER=	Brad Smith <brad@@openbsd.org>
@


1.49
log
@@@endfake marker
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2004/11/21 12:50:32 espie Exp $
d5 2
a6 2
DISTNAME=	bzip2-1.0.2
PKGNAME=	${DISTNAME}p0
d8 1
a8 1
MASTER_SITES=	${MASTER_SITE_SOURCEWARE:=bzip2/v102/}
d10 1
a10 1
HOMEPAGE=	http://sources.redhat.com/bzip2/
a32 1
	@@cd ${WRKBUILD} && makeinfo --no-split manual.texi
d34 1
a34 2
	${INSTALL_DATA} ${WRKBUILD}/*.html ${PREFIX}/share/doc/bzip2
	${INSTALL_DATA} ${WRKBUILD}/bzip2.info ${PREFIX}/info
@


1.48
log
@Mark all system libs in WANTLIB, result of running newlib-depends-check
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2004/04/06 06:33:29 brad Exp $
d6 1
@


1.47
log
@remove another sparc64/2.95 workaround.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2003/06/23 03:30:24 jolan Exp $
d18 1
@


1.46
log
@allow optimization on sparc64 again.  tested by naddy, sturm, & myself.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2003/05/24 01:01:24 jolan Exp $
d20 1
a20 1
.if ${MACHINE_ARCH} != "sparc64" && ${MACHINE_ARCH} != "m68k"
@


1.45
log
@# BSD
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2002/12/29 15:15:18 fgsch Exp $
a21 5
.endif

# XXX GCC optimization bug temporary workaround
.if ${MACHINE_ARCH:Msparc64}
BZ2_CFLAGS+=	-O0
@


1.44
log
@sayonara NEED_VERSION.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2002/05/12 21:37:03 brad Exp $
d13 1
@


1.43
log
@bye MASTER_SITE_SUBDIR
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2002/02/03 06:16:09 brad Exp $
a6 1
NEED_VERSION=	1.525
@


1.42
log
@upgrade to bzip2 1.0.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2002/01/27 20:00:16 pvalchev Exp $
d7 2
a8 3
NEED_VERSION=	1.500
MASTER_SITES=	${MASTER_SITE_SOURCEWARE}
MASTER_SITE_SUBDIR= bzip2/v102
@


1.41
log
@sparc64 gcc optimization bug temporary workaround with -O0; ok brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2001/10/31 16:49:46 brad Exp $
d5 1
a5 1
DISTNAME=	bzip2-1.0.1
d7 1
a7 1
NEED_VERSION=	1.475
d9 1
a9 1
MASTER_SITE_SUBDIR= bzip2/v100
d11 1
a11 1
HOMEPAGE=	http://sourceware.cygnus.com/bzip2/
d25 1
a25 1
# XXX gcc optimization bug temporary workaround
@


1.40
log
@simplify regression test support.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2001/10/15 14:16:34 pvalchev Exp $
d23 5
@


1.39
log
@workaround a bug that prevented bzip2 from working on m68k; ok brad, naddy, espie
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2001/10/09 02:05:29 brad Exp $
d7 1
a7 1
NEED_VERSION=	1.460
d27 1
d29 1
a29 4
test:   build
	@@cd ${WRKBUILD} && ${SETENV} ${MAKE_ENV} \
		LD_LIBRARY_PATH="${WRKBUILD}" ${MAKE} ${MAKE_FLAGS} -f \
			${MAKE_FILE} test
a35 2

REGRESS_TARGET=test
@


1.38
log
@workaround for sparc64 with regard to the CFLAGS passed on.
--
Based on patch from: wilfried@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2001/10/04 22:26:48 espie Exp $
d21 1
a21 1
.if ${MACHINE_ARCH} != "sparc64"
@


1.37
log
@Note existing regression tests for archivers. No need to update
NEED_VERSION, this won't break anything otherwise.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2001/09/26 18:38:43 heko Exp $
d7 1
a7 1
NEED_VERSION=	1.444
d9 2
a10 1
MASTER_SITE_SUBDIR=bzip2/v100
d20 6
a25 2
MAKE_FLAGS=	CC="${CC}" CFLAGS="${CFLAGS} -Wall -Winline \
		-fomit-frame-pointer -fno-strength-reduce"
@


1.36
log
@o Fix a few oddities in the bzip2 texinfo source
o Install texinfo and HTML manuals (which include programmer
  resources) for bzip2
ok maintainer: brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2001/04/20 17:35:32 brad Exp $
d33 2
@


1.35
log
@ o Add MASTER_SITE_SOURCEWARE to network.conf.template (mirrors
   of sourceware.cygnus.com (also known as sources.redhat.com))
 o Modify bzip2 and gsl ports to use this new master_site (gnats
   remains to be fixed: no reply from maintainer)
 o Bump NEED_VERSION on those ports
maintainers of the ports ok: brad@@, rohee@@
@
text
@d28 6
@


1.34
log
@MASTER_SITES fix by Heikki Korpela <heko@@saitti.net>:
- Add ftp.funet.fi and ftp.sunet.se mirrors where available.
- Remove broken ftp.funet.fi references.
@
text
@d7 3
a9 5
NEED_VERSION=	1.384
MASTER_SITES=	ftp://sourceware.cygnus.com/pub/bzip2/v100/ \
		ftp://ftp.yggdrasil.com/mirrors/site/sourceware.cygnus.com/pub/bzip2/v100/ \
      		ftp://ftp.funet.fi/pub/mirrors/sourceware.cygnus.com/pub/bzip2/v100/

@


1.33
log
@bump NEED_VERSION
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2001/04/20 15:09:11 espie Exp $
d9 2
a10 1
		ftp://ftp.yggdrasil.com/mirrors/site/sourceware.cygnus.com/pub/bzip2/v100/
@


1.32
log
@Fix bzip2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2001/03/29 15:01:53 brad Exp $
d7 1
a7 1
NEED_VERSION=	1.364
d22 1
a22 1
FAKE_FLAGS+=	${MAKE_FLAGS} PREFIX="${PREFIX}" DESTDIR="${WRKINST}"
@


1.31
log
@- integrate COMMENT
- bump NEED_VERSION
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2001/03/24 22:37:58 brad Exp $
d32 1
a32 1
MAKE_ENV=	NO_SHARED_LIBS=Yes
@


1.30
log
@- integrate COMMENT
- bump NEED_VERSION
- WRKSRC -> WRKBUILD
- ${MAKE} -> ${MAKE_PROGRAM}
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2000/09/24 01:23:42 brad Exp $
d7 1
a7 1
NEED_VERSION=	1.363
@


1.29
log
@some ports which I've been maintaining
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.28 2000/09/16 11:44:22 brad Exp $
d7 1
a7 1
NEED_VERSION=	1.310
d25 3
a27 2
	@@cd ${WRKSRC} && ${SETENV} ${MAKE_ENV} LD_LIBRARY_PATH="${WRKSRC}" \
		${MAKE} ${MAKE_FLAGS} -f ${MAKE_FILE} test
@


1.28
log
@revert switch to libtool, use "cc -shared" to create shared libraries
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2000/07/01 02:00:52 brad Exp $
d11 1
a11 1
MAINTAINER=	angelos@@openbsd.org
@


1.27
log
@@@exec /sbin/ldconfig -> DYNLIBDIR
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2000/06/25 03:56:58 brad Exp $
d18 3
a20 5
USE_LIBTOOL=	Yes
MAKE_FLAGS=	PREFIX="${PREFIX}" CC="${CC}" \
		CFLAGS="${CFLAGS} -Wall -Winline -fomit-frame-pointer \
		-fno-strength-reduce"
FAKE_FLAGS=	PREFIX="${PREFIX}" DESTDIR="${WRKINST}"
d23 2
a24 1
	@@cd ${WRKSRC} && ${SETENV} ${MAKE_ENV} ${MAKE} ${MAKE_FLAGS} -f ${MAKE_FILE} test
d27 4
@


1.26
log
@upgrade to bzip2 1.0.1
- add HOMEPAGE
- switch to libtool for shared library creation
- use better filename for patch
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2000/06/10 18:51:44 brad Exp $
d5 1
a5 1
NEED_VERSION=	1.301
@


1.25
log
@- remove FAKE=Yes
- use new framework for PLISTs
- add @@comment with RCS id
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2000/06/02 13:44:53 brad Exp $
d3 1
a3 1
DISTNAME=	bzip2-1.0.0
d9 2
d18 2
a19 1
MAKE_FLAGS=	CC="${CC}" \
d22 1
a22 2

FAKE_FLAGS=	PREFIX="${WRKINST}${PREFIX}"
d25 1
a25 1
	@@cd ${WRKSRC} && env LD_LIBRARY_PATH="${WRKSRC}" make test
a27 4

.if defined(NO_SHARED_LIBS) && ${NO_SHARED_LIBS:U} == YES
MAKE_ENV=	NO_SHARED_LIBS=	Yes
.endif
@


1.24
log
@bump NEED_VERSION
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2000/05/26 01:56:09 kevlo Exp $
d5 1
a5 1
NEED_VERSION=	1.234
d7 1
a7 1
                ftp://ftp.yggdrasil.com/mirrors/site/sourceware.cygnus.com/pub/bzip2/v100/      
a14 2

FAKE=	Yes
@


1.23
log
@- Upgrade to version 1.0.0
- Several minor bugfixes and enhancements:

  o Large file support.
  o Decompression robustness.
  o Avoid library namespace pollution.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2000/03/30 23:10:55 brad Exp $
d5 1
a5 1
NEED_VERSION=	1.218
@


1.22
log
@remove blank line
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2000/03/24 22:11:33 espie Exp $
d3 1
a3 1
DISTNAME=	bzip2-0.9.5d
d6 2
a7 2
MASTER_SITES=	ftp://sourceware.cygnus.com/pub/bzip2/v095/ \
                ftp://ftp.yggdrasil.com/mirrors/site/sourceware.cygnus.com/pub/bzip2/v095/      
@


1.22.2.1
log
@bring cut-off archivers into 2.7 branch
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2000/07/01 02:00:52 brad Exp $
d3 1
a3 1
DISTNAME=	bzip2-1.0.1
d5 3
a7 5
NEED_VERSION=	1.310
MASTER_SITES=	ftp://sourceware.cygnus.com/pub/bzip2/v100/ \
		ftp://ftp.yggdrasil.com/mirrors/site/sourceware.cygnus.com/pub/bzip2/v100/

HOMEPAGE=	http://sourceware.cygnus.com/bzip2/
d16 3
a18 2
USE_LIBTOOL=	Yes
MAKE_FLAGS=	PREFIX="${PREFIX}" CC="${CC}" \
d21 2
a22 1
FAKE_FLAGS=	PREFIX="${PREFIX}" DESTDIR="${WRKINST}"
d25 1
a25 1
	@@cd ${WRKSRC} && ${SETENV} ${MAKE_ENV} ${MAKE} ${MAKE_FLAGS} -f ${MAKE_FILE} test
d28 4
@


1.21
log
@Move all NEED_VERSION right after CATEGORY
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2000/03/06 22:05:13 brad Exp $
a7 1

@


1.20
log
@style
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2000/03/05 08:28:32 brad Exp $
d5 1
a8 1
NEED_VERSION=	1.218
@


1.19
log
@- make use of MAKE_FLAGS
- Fake
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2000/02/15 05:03:51 turan Exp $
d26 1
a26 1
	@@cd ${WRKSRC} && env LD_LIBRARY_PATH=${WRKSRC} make test
@


1.18
log
@espie will not shut up about this, DISTF -> DISTFILES, PKG -> PACKAGE
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2000/02/12 06:29:49 turan Exp $
d8 2
d12 10
a21 5
LICENSE_TYPE=		BSD
PERMIT_PACKAGE_CDROM=	YES
PERMIT_PACKAGE_FTP=	YES
PERMIT_DISTFILES_CDROM=	YES
PERMIT_DISTFILES_FTP=	YES
d23 1
a23 2
post-install:
	@@${LDCONFIG} -m ${PREFIX}/lib
d31 1
a31 1
MAKE_ENV=	NO_SHARED_LIBS=Yes
@


1.17
log
@bsd licenses
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2000/01/19 14:57:07 kevlo Exp $
d11 4
a14 4
PERMIT_PKG_CDROM=	YES
PERMIT_PKG_FTP=		YES
PERMIT_DISTF_CDROM=	YES
PERMIT_DISTF_FTP=	YES
@


1.16
log
@Change the MASTER_SITES. http://www.bzip2.org doesn't exist.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 1999/12/28 23:37:32 brad Exp $
d9 6
@


1.15
log
@- cleanup creation of shared libs
- fixup bzip2's own install target and use BSD_INSTALL macros
- cleanup PLIST
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 1999/12/28 06:13:05 brad Exp $
d6 1
a6 1
		http://www.bzip2.org/bzip2/v095/
@


1.14
log
@remove deprecated variables
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 1999/09/25 13:01:12 turan Exp $
d10 2
a11 3
VER=		9.5

MAKE_ENV=	VER=${VER}
d13 2
a14 21
# post-patch must be defined before bsd.port.mk is included so it will
# be called.  However, we need to have the body of the target after
# bsd.port.mk is included so NO_SHARED_LIBS is defined.
# Define the target twice, using :
post-patch:

do-install:
	${INSTALL_PROGRAM} ${WRKSRC}/bzip2 ${PREFIX}/bin
	@@ln -sf ${PREFIX}/bin/bzip2 ${PREFIX}/bin/bunzip2
	@@ln -sf ${PREFIX}/bin/bzip2 ${PREFIX}/bin/bzcat
	${INSTALL_PROGRAM} ${WRKSRC}/bzip2recover ${PREFIX}/bin
	${INSTALL_DATA} ${WRKSRC}/bzlib.h ${PREFIX}/include
	${INSTALL_DATA} ${WRKSRC}/libbz2.a ${PREFIX}/lib
	@@if [ -f ${WRKSRC}/libbz2.so.${VER} ]; then \
	 ${INSTALL_DATA} ${WRKSRC}/libbz2.so.${VER} ${PREFIX}/lib; \
	fi
	${INSTALL_MAN} ${WRKSRC}/bzip2.1 ${PREFIX}/man/man1
	@@ln -f ${PREFIX}/man/man1/bzip2.1 ${PREFIX}/man/man1/bunzip2.1
	@@ln -f ${PREFIX}/man/man1/bzip2.1 ${PREFIX}/man/man1/bzcat.1
	@@ln -f ${PREFIX}/man/man1/bzip2.1 ${PREFIX}/man/man1/bzip2recover.1
	@@${LDCONFIG} -m ${PREFIX}/lib
d18 2
a19 6
# The patches assumed shared libs would be build.  If building
# on a host that does not support shared libs, e.g. the alpha,
# apply one more patch.
post-patch:
.if defined(NO_SHARED_LIBS)
	@@(cd ${DISTDIR}; ${PATCH} ${PATCH_DIST_ARGS} < ${FILESDIR}/patch)
@


1.13
log
@bad MASTER_SITES
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 1999/09/24 13:29:46 brad Exp $
d22 2
a23 2
	@@${LN} -sf ${PREFIX}/bin/bzip2 ${PREFIX}/bin/bunzip2
	@@${LN} -sf ${PREFIX}/bin/bzip2 ${PREFIX}/bin/bzcat
d28 1
a28 1
	  ${INSTALL_DATA} ${WRKSRC}/libbz2.so.${VER} ${PREFIX}/lib; \
d31 4
a34 4
	@@${LN} -f ${PREFIX}/man/man1/bzip2.1 ${PREFIX}/man/man1/bunzip2.1
	@@${LN} -f ${PREFIX}/man/man1/bzip2.1 ${PREFIX}/man/man1/bzcat.1
	@@${LN} -f ${PREFIX}/man/man1/bzip2.1 ${PREFIX}/man/man1/bzip2recover.1
	${LDCONFIG} -m ${PREFIX}/lib
@


1.12
log
@upgrade to bzip2 0.9.5d
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 1999/08/11 03:28:11 brad Exp $
d5 1
a5 1
MASTER_SITES=	ftp://sourceware.cygnus.com/pub/bzip2/ \
@


1.11
log
@upgrade to bzip2 0.9.5c
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 1999/05/09 01:40:06 brad Exp $
d3 1
a3 1
DISTNAME=	bzip2-0.9.5c
d5 2
a6 3
MASTER_SITES=	http://www.bzip2.org/bzip2/v095/ \
		http://www.muraroa.demon.co.uk/ \
		http://www.digistar.com/bzip2/
@


1.10
log
@- make a libbz2 shared lib
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 1999/04/20 00:13:48 brad Exp $
d3 1
a3 2
DISTNAME=	bzip2-0.9.0c
PKGNAME=	bzip2-0.9.0c
d5 3
d11 1
a11 4
MASTER_SITES=	http://www.digistar.com/bzip2/ \
		http://www.muraroa.demon.co.uk/

VER=0.9
d23 2
a24 2
	ln -sf ${PREFIX}/bin/bzip2 ${PREFIX}/bin/bunzip2
	ln -sf ${PREFIX}/bin/bzip2 ${PREFIX}/bin/bzcat
d29 1
a29 1
	${INSTALL_DATA} ${WRKSRC}/libbz2.so.${VER} ${PREFIX}/lib; \
d32 3
a34 3
	ln -f ${PREFIX}/man/man1/bzip2.1 ${PREFIX}/man/man1/bunzip2.1
	ln -f ${PREFIX}/man/man1/bzip2.1 ${PREFIX}/man/man1/bzcat.1
	ln -f ${PREFIX}/man/man1/bzip2.1 ${PREFIX}/man/man1/bzip2recover.1
@


1.9
log
@- install bzlib.h and libbz2.a
- patch to allow `bzip -dc' to work on a symlink
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 1999/04/01 02:16:36 brad Exp $
d12 9
a20 1
USE_GMAKE=	yes
d29 3
d36 1
d39 8
@


1.8
log
@remove unnecessary comments and fix email address's
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 1999/02/21 09:13:01 fgsch Exp $
d19 2
@


1.7
log
@Install bzcat, bzcat.1 and bzip2recover.1.
@
text
@d1 1
a1 2
# $OpenBSD: Makefile,v 1.6 1999/02/11 05:51:07 fgsch Exp $
#
@


1.6
log
@Update to 0.9.0c
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 1998/09/14 05:41:17 marc Exp $
d18 1
d22 2
@


1.5
log
@update to 0.9.0b; add mirror site
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 1998/09/11 05:22:54 mickey Exp $
d4 2
a5 2
DISTNAME=	bzip2-0.9.0b
PKGNAME=	bzip2-0.9.0b
@


1.4
log
@update to 0.9.0
@
text
@d1 1
a1 6
# OpenBSD makefile for:    bzip2
# Version required:     0.1pl2
# Date created:         24 Nov 1997
# Whom:                 angelos@@openbsd.org
#
# $OpenBSD: Makefile,v 1.3 1998/02/21 02:58:53 marc Exp $
d4 2
a5 2
DISTNAME=	bzip2-0.9.0
PKGNAME=	bzip2-0.9.0
a6 1
MASTER_SITES=	http://www.muraroa.demon.co.uk/
d10 4
a13 1
MAN1=		bzip2.1 bunzip2.1
@


1.3
log
@fix typo in package name
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.2 1997/11/25 21:36:28 angelos Exp $
d9 2
a10 2
DISTNAME=	bzip2-0.1pl2
PKGNAME=	bzip2-0.1p12
@


1.2
log
@Fix installation error.
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.1 1997/11/24 19:26:36 angelos Exp $
d10 1
a10 1
PKGNAME=	bzip2-0.1p2
@


1.1
log
@Added bzip2 port.
@
text
@d6 1
a6 1
# $OpenBSD$
d23 1
a23 1
	ln ${PREFIX}/man/man1/bzip2.1 ${PREFIX}/man/man1/bunzip2.1
@
