head	1.1;
access;
symbols
	OPENBSD_6_0:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2016.11.21.21.49.25;	author juanfra;	state Exp;
branches
	1.1.2.1;
next	;
commitid	jLlzBeM1jpMFXJYA;

1.1.2.1
date	2016.11.21.21.54.38;	author juanfra;	state Exp;
branches;
next	;
commitid	dfZxwNdpsBrSsTJy;


desc
@@


1.1
log
@CVE-2016-9296: Null pointer dereference

https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9296

From Josh Grosse (MAINTAINER)
@
text
@$OpenBSD$

For CVE-2016-9296, from 7zip's developer Igor Pavlov  

--- CPP/7zip/Archive/7z/7zIn.cpp.orig	Sun Nov 20 09:29:41 2016
+++ CPP/7zip/Archive/7z/7zIn.cpp	Sun Nov 20 09:31:22 2016
@@@@ -1097,7 +1097,8 @@@@ HRESULT CInArchive::ReadAndDecodePackedStreams(
       if (CrcCalc(data, unpackSize) != folders.FolderCRCs.Vals[i])
         ThrowIncorrect();
   }
-  HeadersSize += folders.PackPositions[folders.NumPackStreams];
+  if (folders.PackPositions)
+      HeadersSize += folders.PackPositions[folders.NumPackStreams];
   return S_OK;
 }
 
@


1.1.2.1
log
@CVE-2016-9296: Null pointer dereference

https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9296

From Josh Grosse (MAINTAINER)
@
text
@@

