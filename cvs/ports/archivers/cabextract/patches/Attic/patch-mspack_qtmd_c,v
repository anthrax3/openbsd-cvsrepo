head	1.2;
access;
symbols
	OPENBSD_5_7:1.1.0.4
	OPENBSD_5_7_BASE:1.1
	OPENBSD_5_6:1.1.0.2;
locks; strict;
comment	@# @;


1.2
date	2015.06.13.20.31.32;	author naddy;	state dead;
branches;
next	1.1;
commitid	N2VsbiKXx0P70Kbj;

1.1
date	2015.01.30.13.34.40;	author jasper;	state Exp;
branches
	1.1.2.1;
next	;
commitid	vJFaXVAuzgK3QdqO;

1.1.2.1
date	2015.01.30.13.37.14;	author jasper;	state Exp;
branches;
next	1.1.2.2;
commitid	gdfPI7GGJXQ3HnYR;

1.1.2.2
date	2015.02.18.13.43.51;	author sthen;	state Exp;
branches;
next	;
commitid	PGmGSP5qwBbG0uiW;


desc
@@


1.2
log
@Update to 1.6.

This release fixes the extraction to absolute file names with invalid
UTF-8 characters (CVE-2015-2060), which had already been fixed in
the port.

The security patch in the port for CVE-2014-9556 was already obsoleted
by extended input validation in 1.5.

ok jca@@
@
text
@$OpenBSD: patch-mspack_qtmd_c,v 1.1 2015/01/30 13:34:40 jasper Exp $

Security fix for CVE-2014-9556
http://anonscm.debian.org/cgit/collab-maint/libmspack.git/tree/debian/patches/qtmd-fix-frame_end-overflow.patch

--- mspack/qtmd.c.orig	Fri Jan 30 15:18:30 2015
+++ mspack/qtmd.c	Fri Jan 30 15:19:11 2015
@@@@ -296,9 +296,10 @@@@ int qtmd_decompress(struct qtmd_stream *qtm, off_t out
 
     /* decode more, up to the number of bytes needed, the frame boundary,
      * or the window boundary, whichever comes first */
-    frame_end = window_posn + (out_bytes - (qtm->o_end - qtm->o_ptr));
-    if ((window_posn + frame_todo) < frame_end) {
+    if (frame_todo < (out_bytes - (qtm->o_end - qtm->o_ptr))) {
       frame_end = window_posn + frame_todo;
+    } else {
+      frame_end = window_posn + (out_bytes - (qtm->o_end - qtm->o_ptr));
     }
     if (frame_end > qtm->window_size) {
       frame_end = qtm->window_size;
@


1.1
log
@Security fix for CVE-2014-9556
@
text
@d1 1
a1 1
$OpenBSD$
@


1.1.2.1
log
@Security fix for CVE-2014-9556
@
text
@d1 1
a1 1
$OpenBSD: patch-mspack_qtmd_c,v 1.1 2015/01/30 13:34:40 jasper Exp $
@


1.1.2.2
log
@MFC: Fix directory-traversal vulnerability involving long UTF-8 encodings.
Nice write-up at http://www.openwall.com/lists/oss-security/2015/02/18/3
@
text
@@


