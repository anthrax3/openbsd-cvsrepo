head	1.5;
access;
symbols
	OPENBSD_6_2:1.5.0.2
	OPENBSD_6_2_BASE:1.5
	OPENBSD_6_1:1.4.0.8
	OPENBSD_6_1_BASE:1.4
	OPENBSD_6_0:1.4.0.6
	OPENBSD_6_0_BASE:1.4
	OPENBSD_5_9:1.4.0.2
	OPENBSD_5_9_BASE:1.4
	OPENBSD_5_8:1.4.0.4
	OPENBSD_5_8_BASE:1.4
	OPENBSD_5_7:1.3.0.2
	OPENBSD_5_7_BASE:1.3
	OPENBSD_5_6:1.2.0.4
	OPENBSD_5_6_BASE:1.2
	OPENBSD_5_5:1.2.0.2
	OPENBSD_5_5_BASE:1.2
	juanfra_2013-10-14:1.1.1.1
	juanfra:1.1.1;
locks; strict;
comment	@# @;


1.5
date	2017.04.28.20.40.04;	author juanfra;	state Exp;
branches;
next	1.4;
commitid	eEvp2cuPmjomPcB0;

1.4
date	2015.07.21.00.41.08;	author juanfra;	state Exp;
branches;
next	1.3;
commitid	kTa8YgyXBTcYElA0;

1.3
date	2014.09.13.22.12.40;	author juanfra;	state Exp;
branches;
next	1.2;
commitid	gPBsP5pUShX2cuNY;

1.2
date	2013.11.08.20.34.32;	author juanfra;	state Exp;
branches;
next	1.1;

1.1
date	2013.10.14.21.23.34;	author juanfra;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2013.10.14.21.23.34;	author juanfra;	state Exp;
branches;
next	;


desc
@@


1.5
log
@Update to lzlib 1.9.
@
text
@$OpenBSD: patch-Makefile_in,v 1.4 2015/07/21 00:41:08 juanfra Exp $
--- Makefile.in.orig	Tue Feb  7 16:16:59 2017
+++ Makefile.in	Fri Apr 28 22:23:00 2017
@@@@ -24,14 +24,14 @@@@ all : $(progname_static) $(progname_shared)
 lib$(libname).a : lzlib.o
 	$(AR) -rcs $@@ $<
 
-lib$(libname).so.$(pkgversion) : lzlib_sh.o
-	$(CC) $(LDFLAGS) $(CFLAGS) -fpic -fPIC -shared -Wl,--soname=lib$(libname).so.$(soversion) -o $@@ $<
+lib$(libname).so.$(LIBlz_VERSION) : lzlib_sh.o
+	$(CC) $(LDFLAGS) $(CFLAGS) -fPIC -shared -o $@@ $<
 
 $(progname) : $(objs) lib$(libname).a
 	$(CC) $(LDFLAGS) $(CFLAGS) -o $@@ $(objs) lib$(libname).a
 
-$(progname)_shared : $(objs) lib$(libname).so.$(pkgversion)
-	$(CC) $(LDFLAGS) $(CFLAGS) -o $@@ $(objs) lib$(libname).so.$(pkgversion)
+$(progname)_shared : $(objs) lib$(libname).so.$(LIBlz_VERSION)
+	$(CC) $(LDFLAGS) $(CFLAGS) -o $@@ $(objs) lib$(libname).so.$(LIBlz_VERSION)
 
 bbexample : bbexample.o lib$(libname).a
 	$(CC) $(LDFLAGS) $(CFLAGS) -o $@@ bbexample.o lib$(libname).a
@@@@ -43,7 +43,7 @@@@ main.o : main.c
 	$(CC) $(CPPFLAGS) $(CFLAGS) -DPROGVERSION=\"$(pkgversion)\" -c -o $@@ $<
 
 lzlib_sh.o : lzlib.c
-	$(CC) $(CPPFLAGS) $(CFLAGS) -fpic -fPIC -c -o $@@ $<
+	$(CC) $(CPPFLAGS) $(CFLAGS) -fPIC -c -o $@@ $<
 
 %.o : %.c
 	$(CC) $(CPPFLAGS) $(CFLAGS) -c -o $@@ $<
@@@@ -91,15 +91,13 @@@@ install-bin : all
 	  $(INSTALL_DATA) ./lib$(libname).a "$(DESTDIR)$(libdir)/lib$(libname).a" ; \
 	fi
 	if [ -n "$(progname_shared)" ] ; then \
-	  $(INSTALL_PROGRAM) ./lib$(libname).so.$(pkgversion) "$(DESTDIR)$(libdir)/lib$(libname).so.$(pkgversion)" ; \
+	  $(INSTALL_PROGRAM) ./lib$(libname).so.$(LIBlz_VERSION) "$(DESTDIR)$(libdir)/lib$(libname).so.$(LIBlz_VERSION)" ; \
 	  if [ -e "$(DESTDIR)$(libdir)/lib$(libname).so.$(soversion)" ] ; then \
 	    run_ldconfig=no ; \
 	  else run_ldconfig=yes ; \
 	  fi ; \
 	  rm -f "$(DESTDIR)$(libdir)/lib$(libname).so" ; \
 	  rm -f "$(DESTDIR)$(libdir)/lib$(libname).so.$(soversion)" ; \
-	  cd "$(DESTDIR)$(libdir)" && ln -s lib$(libname).so.$(pkgversion) lib$(libname).so ; \
-	  cd "$(DESTDIR)$(libdir)" && ln -s lib$(libname).so.$(pkgversion) lib$(libname).so.$(soversion) ; \
 	  if [ "${disable_ldconfig}" != yes ] && [ $${run_ldconfig} = yes ] && \
 	     [ -x "$(LDCONFIG)" ] ; then "$(LDCONFIG)" -n "$(DESTDIR)$(libdir)" || true ; fi ; \
 	fi
@@@@ -140,7 +138,7 @@@@ uninstall-bin :
 	-rm -f "$(DESTDIR)$(libdir)/lib$(libname).a"
 	-rm -f "$(DESTDIR)$(libdir)/lib$(libname).so"
 	-rm -f "$(DESTDIR)$(libdir)/lib$(libname).so.$(soversion)"
-	-rm -f "$(DESTDIR)$(libdir)/lib$(libname).so.$(pkgversion)"
+	-rm -f "$(DESTDIR)$(libdir)/lib$(libname).so.$(LIBlz_VERSION)"
 
 uninstall-info :
 	-if $(CAN_RUN_INSTALLINFO) ; then \
@


1.4
log
@Update to lzlib 1.7.
@
text
@d1 4
a4 4
$OpenBSD: patch-Makefile_in,v 1.3 2014/09/13 22:12:40 juanfra Exp $
--- Makefile.in.orig	Tue Apr 21 22:43:12 2015
+++ Makefile.in	Tue Jul 21 02:19:29 2015
@@@@ -22,14 +22,14 @@@@ all : $(progname_static) $(progname_shared)
d23 1
a23 1
@@@@ -41,7 +41,7 @@@@ main.o : main.c
d32 1
a32 1
@@@@ -89,15 +89,13 @@@@ install-bin : all
d49 1
a49 1
@@@@ -136,7 +134,7 @@@@ uninstall-bin :
d57 1
a57 1
 	-install-info --info-dir="$(DESTDIR)$(infodir)" --remove "$(DESTDIR)$(infodir)/$(pkgname).info"
@


1.3
log
@Update to lzlib-1.6
@
text
@d1 4
a4 4
$OpenBSD: patch-Makefile_in,v 1.2 2013/11/08 20:34:32 juanfra Exp $
--- Makefile.in.orig	Fri Apr 25 20:50:01 2014
+++ Makefile.in	Sun Jun 22 15:18:13 2014
@@@@ -20,14 +21,14 @@@@ all : $(progname_static) $(progname_shared)
d9 1
a9 1
-	$(CC) $(CFLAGS) $(LDFLAGS) -fpic -fPIC -shared -Wl,--soname=lib$(libname).so.$(soversion) -o $@@ $<
d11 1
a11 1
+	$(CC) $(CFLAGS) $(LDFLAGS) -fPIC -shared -o $@@ $<
d14 1
a14 1
 	$(CC) $(CFLAGS) $(LDFLAGS) -o $@@ $(objs) lib$(libname).a
d17 1
a17 1
-	$(CC) $(CFLAGS) $(LDFLAGS) -o $@@ $(objs) lib$(libname).so.$(pkgversion)
d19 1
a19 1
+	$(CC) $(CFLAGS) $(LDFLAGS) -o $@@ $(objs) lib$(libname).so.$(LIBlz_VERSION)
d21 4
a24 4
 $(progname)_profiled : $(objs) lib$(libname).a
 	$(CC) $(CFLAGS) $(LDFLAGS) -pg -o $@@ $(objs) lib$(libname).a
@@@@ -42,7 +43,7 @@@@ main.o : main.c
 	$(CC) $(CFLAGS) $(CPPFLAGS) -DPROGVERSION=\"$(pkgversion)\" -c -o $@@ $<
d27 2
a28 2
-	$(CC) $(CFLAGS) $(CPPFLAGS) -fpic -fPIC -c -o $@@ $<
+	$(CC) $(CFLAGS) $(CPPFLAGS) -fPIC -c -o $@@ $<
d31 2
a32 2
 	$(CC) $(CFLAGS) $(CPPFLAGS) -c -o $@@ $<
@@@@ -86,15 +87,13 @@@@ install-bin : all
d49 1
a49 1
@@@@ -125,7 +124,7 @@@@ uninstall-bin :
@


1.2
log
@Only use gmake for lzlib. Change the tarballs from .gz to .lz.

Changes to lzlib from brad@@. I and upstream were wrong with the patching.

ok brad@@ sthen@@
@
text
@d1 4
a4 15
$OpenBSD: patch-Makefile_in,v 1.1.1.1 2013/10/14 21:23:34 juanfra Exp $

ldconfig changes backported from lzlib-1.6-pre1.

--- Makefile.in.orig	Sat Sep 14 19:22:37 2013
+++ Makefile.in	Thu Nov  7 00:38:42 2013
@@@@ -7,6 +7,7 @@@@ INSTALL_DATA = $(INSTALL) -p -m 644
 INSTALL_DIR = $(INSTALL) -d -m 755
 LDCONFIG = /sbin/ldconfig
 SHELL = /bin/sh
+disable_ldconfig = yes
 
 objs = carg_parser.o main.o
 
@@@@ -20,14 +21,14 @@@@ all : $(progname) $(progname_shared)
d9 1
a9 1
-	$(CC) -shared -Wl,--soname=lib$(libname).so.$(soversion) -o $@@ $<
d11 1
a11 1
+	$(CC) -shared -fPIC -o $@@ $<
d14 1
a14 1
 	$(CC) $(LDFLAGS) -o $@@ $(objs) lib$(libname).a
d17 1
a17 1
-	$(CC) $(LDFLAGS) -o $@@ $(objs) lib$(libname).so.$(pkgversion)
d19 1
a19 1
+	$(CC) $(LDFLAGS) -o $@@ $(objs) lib$(libname).so.$(LIBlz_VERSION)
d22 3
a24 3
 	$(CC) $(LDFLAGS) -pg -o $@@ $(objs) lib$(libname).a
@@@@ -45,7 +46,7 @@@@ main.o : main.c
 	$(CC) $(CPPFLAGS) $(CFLAGS) -c -o $@@ $<
d27 2
a28 2
-	$(CC) -fpic -fPIC $(CPPFLAGS) $(CFLAGS) -c -o $@@ $<
+	$(CC) -fPIC $(CPPFLAGS) $(CFLAGS) -c -o $@@ $<
d30 5
a34 5
 lzdeps = lzlib.h lzip.h cbuffer.c decoder.h decoder.c encoder.h encoder.c
 
@@@@ -84,7 +85,7 @@@@ install-bin : all
 	$(INSTALL_DATA) $(VPATH)/$(libname)lib.h "$(DESTDIR)$(includedir)/$(libname)lib.h"
 	$(INSTALL_DATA) ./lib$(libname).a "$(DESTDIR)$(libdir)/lib$(libname).a"
a38 1
 	    rm -f "$(DESTDIR)$(libdir)/lib$(libname).so.$(soversion)" ; \
d40 1
a40 3
@@@@ -93,9 +94,8 @@@@ install-bin : all
 	  if [ -e "$(DESTDIR)$(libdir)/lib$(libname).so" ] ; then \
 	    rm -f "$(DESTDIR)$(libdir)/lib$(libname).so" ; \
d42 2
d46 2
a47 3
-	  if [ $${run_ldconfig} = yes ] && [ -x "$(LDCONFIG)" ] ; then "$(LDCONFIG)" -n "$(DESTDIR)$(libdir)" ; fi ; \
+	  if [ "${disable_ldconfig}" != yes ] && [ $${run_ldconfig} = yes ] && \
+	     [ -x "$(LDCONFIG)" ] ; then "$(LDCONFIG)" -n "$(DESTDIR)$(libdir)" || true ; fi ; \
d49 1
a49 3
 
 install-info :
@@@@ -124,7 +124,7 @@@@ uninstall-bin :
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
$OpenBSD$
d3 1
a3 1
Backport from lzlib-1.6-pre1.
d5 48
a52 3
--- Makefile.in.orig	Sun Sep 15 01:22:37 2013
+++ Makefile.in	Tue Oct  8 18:04:59 2013
@@@@ -93,9 +93,8 @@@@ install-bin : all
d64 9
@


1.1.1.1
log
@Lzip is a lossless data compressor with a user interface similar to the
one of gzip or bzip2. Lzip decompresses almost as fast as gzip and
compresses more than bzip2, which makes it well suited for software
distribution and data archiving.

Lzip is a clean implementation of the LZMA algorithm. The lzip file
format is designed for long-term data archiving. It is clean, provides
very safe 4 factor integrity checking. Lzip uses the same well-defined
exit status values used by bzip2, which makes it safer when used in
pipes or scripts than compressors returning ambiguous warning values,
like gzip.

ok sthen@@

@
text
@@
