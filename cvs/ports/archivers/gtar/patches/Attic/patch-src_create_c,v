head	1.2;
access;
symbols
	OPENBSD_4_9:1.1.0.2
	OPENBSD_4_9_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2011.03.15.21.10.13;	author naddy;	state dead;
branches;
next	1.1;

1.1
date	2010.11.27.21.02.54;	author naddy;	state Exp;
branches;
next	;


desc
@@


1.2
log
@update to bugfix release 1.26
@
text
@$OpenBSD: patch-src_create_c,v 1.1 2010/11/27 21:02:54 naddy Exp $

Fix bug with --one-file-system and --listed-incremental.

--- src/create.c.orig	Mon Nov  1 21:34:59 2010
+++ src/create.c	Sat Nov 27 21:34:19 2010
@@@@ -1680,7 +1680,7 @@@@ dump_file0 (struct tar_stat_info *st, char const *name
      This check is omitted if incremental_option is set *and* the
      requested file is not explicitely listed in the command line. */
 
-  if (!(incremental_option && !is_individual_file (p))
+  if (! (incremental_option && ! top_level)
       && !S_ISDIR (st->stat.st_mode)
       && OLDER_TAR_STAT_TIME (*st, m)
       && (!after_date_option || OLDER_TAR_STAT_TIME (*st, c)))
@


1.1
log
@Fix bug with --one-file-system and --listed-incremental.  This is
important for at least misc/amanda-client.  From upstream.
@
text
@d1 1
a1 1
$OpenBSD$
@

