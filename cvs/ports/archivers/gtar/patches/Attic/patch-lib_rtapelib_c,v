head	1.2;
access;
symbols
	OPENBSD_4_7:1.2.0.4
	OPENBSD_4_6:1.2.0.2;
locks; strict;
comment	@# @;


1.2
date	2010.03.28.18.35.01;	author naddy;	state dead;
branches
	1.2.2.1
	1.2.4.1;
next	1.1;

1.1
date	2010.03.24.18.02.00;	author naddy;	state Exp;
branches;
next	;

1.2.2.1
date	2010.04.22.02.56.47;	author william;	state Exp;
branches;
next	;

1.2.4.1
date	2010.06.04.02.14.10;	author william;	state Exp;
branches;
next	;


desc
@@


1.2
log
@update to 1.23
@
text
@$OpenBSD: patch-lib_rtapelib_c,v 1.1 2010/03/24 18:02:00 naddy Exp $
--- lib/rtapelib.c.orig	Sun Aug 12 09:57:15 2007
+++ lib/rtapelib.c	Wed Mar 24 18:42:13 2010
@@@@ -570,7 +570,8 @@@@ rmt_read__ (int handle, char *buffer, size_t length)
 
   sprintf (command_buffer, "R%lu\n", (unsigned long) length);
   if (do_command (handle, command_buffer) == -1
-      || (status = get_status (handle)) == SAFE_READ_ERROR)
+      || (status = get_status (handle)) == SAFE_READ_ERROR
+      || status > length)
     return SAFE_READ_ERROR;
 
   for (counter = 0; counter < status; counter += rlen, buffer += rlen)
@@@@ -706,6 +707,12 @@@@ rmt_ioctl__ (int handle, int operation, char *argument
 	    || (status = get_status (handle), status == -1))
 	  return -1;
 
+	if (status > sizeof (struct mtop))
+	  {
+	    errno = EOVERFLOW;
+	    return -1;
+	  }
+	
 	for (; status > 0; status -= counter, argument += counter)
 	  {
 	    counter = safe_read (READ_SIDE (handle), argument, status);
@


1.2.4.1
log
@MFC:

SECURITY FIX

Resolves CVE-2010-0624

ok naddy@@
@
text
@d1 1
a1 6
$OpenBSD$

SECURITY FIX
Resolves CVE-2010-0624


@


1.2.2.1
log
@SECURITY FIX

Resolves CVE-2010-0624

ok naddy@@ jasper@@
@
text
@d1 1
a1 7
$OpenBSD$

SECURITY FIX

Resolves CVE-2010-0624


@


1.1
log
@SECURITY fix for CVE-2010-0624:
Heap-based buffer overflow allows remote rmt servers to cause a
denial of service (memory corruption) or possibly execute arbitrary
code by sending more data than was requested.

prodded by jasper@@
@
text
@d1 1
a1 1
$OpenBSD$
@

