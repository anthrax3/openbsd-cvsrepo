head	1.2;
access;
symbols
	OPENBSD_5_6:1.1.0.2;
locks; strict;
comment	@# @;


1.2
date	2015.02.04.09.46.37;	author sthen;	state dead;
branches;
next	1.1;
commitid	VxAowccCAWO3zSXg;

1.1
date	2015.01.30.13.34.40;	author jasper;	state Exp;
branches
	1.1.2.1;
next	;
commitid	vJFaXVAuzgK3QdqO;

1.1.2.1
date	2015.01.30.13.37.26;	author jasper;	state Exp;
branches;
next	1.1.2.2;
commitid	7ZtiWLChjvhmTUBE;

1.1.2.2
date	2015.02.09.17.30.46;	author jasper;	state dead;
branches;
next	;
commitid	52ffxSeJFmTRqYbg;


desc
@@


1.2
log
@update to libmspack 0.5alpha  (part 2: cvs didn't see the patches/ dir)

null pointer dereference on a crafted CAB:
- https://bugs.debian.org/774665

CHM decompression: division by zero
- https://bugs.debian.org/774725

CHM decompression: pointer arithmetic overflow
- https://bugs.debian.org/774726

off-by-one buffer over-read in mspack/mszipd.c
- https://bugs.debian.org/775498

off-by-one buffer under-read in mspack/lzxd.c
- https://bugs.debian.org/775499

CHM decompression: another pointer arithmetic overflow
- https://bugs.debian.org/775687
@
text
@$OpenBSD: patch-mspack_qtmd_c,v 1.1 2015/01/30 13:34:40 jasper Exp $

Security fix for CVE-2014-9556
http://anonscm.debian.org/cgit/collab-maint/libmspack.git/tree/debian/patches/qtmd-fix-frame_end-overflow.patch

--- mspack/qtmd.c.orig	Fri Jan 30 15:18:30 2015
+++ mspack/qtmd.c	Fri Jan 30 15:19:11 2015
@@@@ -296,9 +296,10 @@@@ int qtmd_decompress(struct qtmd_stream *qtm, off_t out
 
     /* decode more, up to the number of bytes needed, the frame boundary,
      * or the window boundary, whichever comes first */
-    frame_end = window_posn + (out_bytes - (qtm->o_end - qtm->o_ptr));
-    if ((window_posn + frame_todo) < frame_end) {
+    if (frame_todo < (out_bytes - (qtm->o_end - qtm->o_ptr))) {
       frame_end = window_posn + frame_todo;
+    } else {
+      frame_end = window_posn + (out_bytes - (qtm->o_end - qtm->o_ptr));
     }
     if (frame_end > qtm->window_size) {
       frame_end = qtm->window_size;
@


1.1
log
@Security fix for CVE-2014-9556
@
text
@d1 1
a1 1
$OpenBSD$
@


1.1.2.1
log
@Security fix for CVE-2014-9556
@
text
@d1 1
a1 1
$OpenBSD: patch-mspack_qtmd_c,v 1.1 2015/01/30 13:34:40 jasper Exp $
@


1.1.2.2
log
@update to libmspack 0.5alpha

null pointer dereference on a crafted CAB:
- https://bugs.debian.org/774665

CHM decompression: division by zero
- https://bugs.debian.org/774725

CHM decompression: pointer arithmetic overflow
- https://bugs.debian.org/774726

off-by-one buffer over-read in mspack/mszipd.c
- https://bugs.debian.org/775498

off-by-one buffer under-read in mspack/lzxd.c
- https://bugs.debian.org/775499

CHM decompression: another pointer arithmetic overflow
- https://bugs.debian.org/775687
@
text
@d1 1
a1 1
$OpenBSD: patch-mspack_qtmd_c,v 1.1.2.1 2015/01/30 13:37:26 jasper Exp $
@


