head	1.3;
access;
symbols
	OPENBSD_5_6:1.1.0.4
	OPENBSD_5_6_BASE:1.1
	OPENBSD_5_5:1.1.0.2;
locks; strict;
comment	@# @;


1.3
date	2014.12.28.12.33.57;	author jasper;	state dead;
branches;
next	1.2;
commitid	pV9N6piOW2FJTa7k;

1.2
date	2014.09.24.09.30.48;	author jasper;	state Exp;
branches;
next	1.1;
commitid	GrZV6C96CoOfQHKq;

1.1
date	2014.05.07.08.11.57;	author jasper;	state Exp;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2014.05.07.08.14.50;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.3
log
@- update to monit-5.11
* http://mmonit.com/monit/changes/
* includes new 'network' monitoring: http://mmonit.com/monit/reveal.js/#/25
@
text
@$OpenBSD: patch-src_sendmail_c,v 1.2 2014/09/24 09:30:48 jasper Exp $

Fix for 64bit time_t.

--- src/sendmail.c.orig	Wed Sep 24 09:08:55 2014
+++ src/sendmail.c	Wed Sep 24 09:09:18 2014
@@@@ -287,7 +287,7 @@@@ int sendmail(Mail_T mail) {
                         do_send(&S, "MIME-Version: 1.0\r\n");
                         do_send(&S, "Content-Type: text/plain; charset=\"iso-8859-1\"\r\n");
                         do_send(&S, "Content-Transfer-Encoding: 8bit\r\n");
-                        do_send(&S, "Message-Id: <%ld.%lu@@%s>\r\n", (long)time(NULL), random(), S.localhost);
+                        do_send(&S, "Message-Id: <%lld.%lu@@%s>\r\n", time(NULL), random(), S.localhost);
                         do_send(&S, "\r\n");
                         do_send(&S, "%s\r\n", m->message);
                         do_send(&S, ".\r\n");
@


1.2
log
@- update to monit-5.9
- remove unneeded daemon_flags from rc-script (from aja@@)
- undo upstream's time_t "fixes" after rejecting our fixes

tested on i386 by aja@@
@
text
@d1 1
a1 1
$OpenBSD: patch-src_sendmail_c,v 1.1 2014/05/07 08:11:57 jasper Exp $
@


1.1
log
@fix another crasher due tue 64-bit time-t; found and fixed by Brian Landy
@
text
@d1 1
a1 1
$OpenBSD$
d5 2
a6 2
--- src/sendmail.c.orig	Wed May  7 09:59:58 2014
+++ src/sendmail.c	Wed May  7 10:00:26 2014
d11 1
a11 1
-                        do_send(&S, "Message-Id: <%ld.%lu@@%s>\r\n", time(NULL), random(), S.localhost);
@


1.1.2.1
log
@Unbreak sending alert mails due to 64-bit time_t mishandling.
@
text
@d1 1
a1 1
$OpenBSD: patch-src_sendmail_c,v 1.1 2014/05/07 08:11:57 jasper Exp $
@

