head	1.3;
access;
symbols
	OPENBSD_3_3:1.2.0.2
	OPENBSD_3_3_BASE:1.2
	margarida_2002_11_29:1.1.1.1
	margarida:1.1.1;
locks; strict;
comment	@# @;


1.3
date	2003.06.01.23.14.16;	author margarida;	state dead;
branches;
next	1.2;

1.2
date	2002.12.26.00.45.55;	author margarida;	state Exp;
branches;
next	1.1;

1.1
date	2002.11.29.23.22.21;	author margarida;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2002.11.29.23.22.21;	author margarida;	state Exp;
branches;
next	;


desc
@@


1.3
log
@Update monit to version 3.2
--
Main changes:
*  Monit now reloads configuration ONLY after it receives SIGHUP.
   Automatic reload based on monit's control file timestamp is now
   defunct.
*  New monit command 'reload' is added. If used, it will reinitialize
   a running monit daemon (send it the SIGHUP signal).
*  A new monit option '-t' is added. If used, monit will run a syntax
   check for the control file and exit with the status.
*  The ssl version for TCPSSL tests can now explicitly be set if auto-
   detection should fail. (Thanks to Mark Foster  for
   the bugreport)
*  Added support for LDAPv2 and LDAPv3, and DWP.
*  Restart method added to monit httpd cervlet
*  Alert messages in passive mode fixed
*  Console command "monit restart [service]" in daemon mode fixed
*  Start/stop/restart race condition fixed.
Changelog: http://www.tildeslash.com/monit/changes.html

Patches OpenBSD specific submitted to authors.
@
text
@$OpenBSD: patch-process_sysdep_c,v 1.2 2002/12/26 00:45:55 margarida Exp $
--- process/sysdep.c.orig	Sun Dec 22 11:54:51 2002
+++ process/sysdep.c	Tue Dec 24 01:52:23 2002
@@@@ -59,7 +59,7 @@@@
 #include <procfs.h>
 #endif
 
-#ifdef FREEBSD
+#ifdef OPENBSD
 #include <kvm.h>
 #include <sys/param.h>
 #include <sys/proc.h>
@@@@ -67,14 +67,15 @@@@
 #include <sys/resourcevar.h>
 #include <sys/lock.h>
 #include <sys/user.h>
-#include <vm/vm.h>
-#include <vm/vm_object.h>
-#include <vm/pmap.h>
+#include <uvm/uvm.h>
+#include <uvm/uvm_object.h>
+#include <uvm/uvm_pmap.h>
 #include <machine/pmap.h>
 #include <machine/vmparam.h>
-#include <vm/vm_map.h>
+#include <uvm/uvm_map.h>
 #include <sys/vmmeter.h>
 #include <sys/sysctl.h>
+ssize_t              kvm_uread(kvm_t *, const struct proc *, u_long, char *, size_t);
 #endif
 
 #ifdef DARWIN
@@@@ -300,7 +301,7 @@@@ int get_process_info_sysdep(ProcInfo_T p
 
 #endif
 
-#ifdef FREEBSD
+#ifdef OPENBSD
 
 #define pagetok(size) ((size) << pageshift)
 #define tv2sec(tv) (((u_int64_t) tv.tv_sec * 1000000) + (u_int64_t) tv.tv_usec)
@@@@ -369,7 +370,7 @@@@ static void calcru(struct proc *p, struc
 int init_process_info_sysdep(void) {
 
   register int pagesize;
-  struct vmmeter vmm;
+  struct uvmexp vmm;
   int mib[2];
   size_t len;
   
@@@@ -429,9 +430,9 @@@@ int init_process_info_sysdep(void) {
 
   }
 
-  mem_kbyte_max= vmm.v_pageout_free_min +
-    vmm.v_free_count + vmm.v_wire_count +
-    vmm.v_active_count + vmm.v_inactive_count;
+  mem_kbyte_max= vmm.freemin +
+    vmm.free + vmm.wired +
+    vmm.active + vmm.inactive;
 
   return TRUE;
 
@@@@ -621,8 +622,8 @@@@ static void calcru(struct proc *p, struc
 int init_process_info_sysdep(void) {
 
   register int pagesize;
-  struct vmmeter vmm;
-  
+  struct uvmexp vmm;
+
   struct nlist nlst [] = {
       { "_bufspace"},
       { "_cnt" },
@


1.2
log
@Update to version 3.1
--
This release optionally makes use of OpenSSL, it is now
possible to monitor processes forged with SSL. It is also
possible to run monit's HTTP server with SSL.
Also added:
Timestamp monitoring for files and directories and an SSH
protocol test.

brad@@ ok
@
text
@d1 1
a1 1
$OpenBSD: patch-process_sysdep_c,v 1.1.1.1 2002/11/29 23:22:21 margarida Exp $
@


1.1
log
@Initial revision
@
text
@d1 4
a4 4
$OpenBSD$
--- process/sysdep.c.orig	Fri Sep 13 02:32:26 2002
+++ process/sysdep.c	Sun Sep 22 16:07:30 2002
@@@@ -57,7 +57,7 @@@@
d13 1
a13 1
@@@@ -65,14 +65,15 @@@@
d32 2
a33 2
 #ifdef LINUX
@@@@ -279,7 +280,7 @@@@ int get_process_info_sysdep(ProcInfo_T p
d42 1
a42 1
@@@@ -348,8 +349,8 @@@@ static void calcru(struct proc *p, struc
a46 1
-  
d48 4
a51 5
+
   struct nlist nlst [] = {
       { "_bufspace"},
       { "_cnt" },
@@@@ -401,9 +402,9 @@@@ int init_process_info_sysdep(void) {
d64 11
@


1.1.1.1
log
@Add monit
--
monit is an utility for monitoring and managing daemons
or similar programs running on a Unix system.
It will start specified programs if they are not running 
and restart programs not responding.
It supports MD5 checksums, alert notifications, an http
interface among other useful features.

brad@@ ok
@
text
@@
