head	1.5;
access;
symbols
	OPENBSD_6_0:1.4.0.2
	OPENBSD_6_0_BASE:1.4
	jasper_20162604:1.1.1.1
	jasper:1.1.1;
locks; strict;
comment	@# @;


1.5
date	2016.08.13.08.42.22;	author jasper;	state Exp;
branches;
next	1.4;
commitid	ldNy3YzScLye91Ba;

1.4
date	2016.05.09.08.55.45;	author czarkoff;	state Exp;
branches;
next	1.3;
commitid	S3O66DgwOeLeKqAi;

1.3
date	2016.05.08.12.29.17;	author czarkoff;	state Exp;
branches;
next	1.2;
commitid	5QGPAs6R52UCMrT1;

1.2
date	2016.04.26.21.29.43;	author jasper;	state Exp;
branches;
next	1.1;
commitid	nUIwNgxjbwZm8yJ6;

1.1
date	2016.04.26.13.08.02;	author jasper;	state Exp;
branches
	1.1.1.1;
next	;
commitid	cFRQI9YZRa6Mnv4a;

1.1.1.1
date	2016.04.26.13.08.02;	author jasper;	state Exp;
branches;
next	;
commitid	cFRQI9YZRa6Mnv4a;


desc
@@


1.5
log
@it's no longer needed to set GO15VENDOREXPERIMENT since we have go 1.6
@
text
@# $OpenBSD: Makefile.inc,v 1.4 2016/05/09 08:55:45 czarkoff Exp $

PKGNAME ?=		${BEAT}-${VERSION}

CATEGORIES +=		sysutils

MAINTAINER ?=		Jasper Lievisse Adriaanse <jasper@@openbsd.org>

# Apachev2
PERMIT_PACKAGE_CDROM ?=	Yes

MODULES +=	     	lang/go

ELASTIC_BEAT ?=	     	Yes

MODGO_ENV =		PATH="${PORTPATH}" CFLAGS="${CFLAGS}"

.if ${ELASTIC_BEAT:L} == "yes"
HOMEPAGE ?=		https://www.elastic.co/products/beats/${BEAT}

ALL_TARGET =		github.com/elastic/beats/${BEAT}

WRKDIST =		${WRKDIR}/${GH_PROJECT}-${VERSION}
MODGO_SUBDIR =		${WRKDIST}/${BEAT}

pre-build:
	cp -r ${WRKDIST}/{libbeat,vendor} ${WRKSRC}/../
.else
ALL_TARGET ?=		github.com/${GH_ACCOUNT}/${BEAT}
.endif

post-install:
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/${BEAT}/
.for c in ${CONFIGS}
	cp ${WRKSRC}/etc/$c ${PREFIX}/share/examples/${BEAT}/
.endfor
@


1.4
log
@add PATH and CFLAGS to Go environment

Needed for cgo

OK jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.inc,v 1.3 2016/05/08 12:29:17 czarkoff Exp $
d16 1
a16 2
MODGO_ENV =		GO15VENDOREXPERIMENT=1 PATH="${PORTPATH}" \
			CFLAGS="${CFLAGS}"
@


1.3
log
@simplify MODGO_CMD environment customization

Clear user's environment with SETENV and provide MODGO_ENV for adding variables
to environment and MODGO_GOPATH for altering GOPATH.

OK ajacoutot@@, jasper@@, kspillner@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.inc,v 1.2 2016/04/26 21:29:43 jasper Exp $
d16 2
a17 1
MODGO_ENV =		GO15VENDOREXPERIMENT=1
@


1.2
log
@prepare for non-Elastic beats with a slightly different layout
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.inc,v 1.1.1.1 2016/04/26 13:08:02 jasper Exp $
d16 1
a16 5
# Redefine ${MODGO_CMD} to include GO15VENDOREXPERIMENT
MODGO_CMD =		unset GOPATH; \
	  		export GO15VENDOREXPERIMENT=1 \
			GOPATH="${MODGO_WORKSPACE}:${MODGO_PACKAGE_PATH}"; \
			go
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d16 6
d27 2
a28 8
WRKDIST =		 ${WRKDIR}/${GH_PROJECT}-${VERSION}
MODGO_SUBDIR =		 ${WRKDIST}/${BEAT}

# Redefine ${MODGO_CMD} to include GO15VENDOREXPERIMENT
MODGO_CMD =		unset GOPATH; \
	  		export GO15VENDOREXPERIMENT=1 \
			GOPATH="${MODGO_WORKSPACE}:${MODGO_PACKAGE_PATH}"; \
			go
d32 2
@


1.1.1.1
log
@import filebeat 1.2.1 (and basic scaffolding for future beats)

Filebeat is an open source file harvester, mostly used to fetch logs
files and feed them into logstash.

testing/feedback from Pavel Korovin
feedback/ok sthen@@
@
text
@@
