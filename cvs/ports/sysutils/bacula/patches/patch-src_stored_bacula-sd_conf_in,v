head	1.9;
access;
symbols
	OPENBSD_6_1:1.9.0.6
	OPENBSD_6_1_BASE:1.9
	OPENBSD_6_0:1.9.0.4
	OPENBSD_6_0_BASE:1.9
	OPENBSD_5_9:1.9.0.2
	OPENBSD_5_9_BASE:1.9
	OPENBSD_5_8:1.8.0.6
	OPENBSD_5_8_BASE:1.8
	OPENBSD_5_7:1.8.0.2
	OPENBSD_5_7_BASE:1.8
	OPENBSD_5_6:1.7.0.2
	OPENBSD_5_6_BASE:1.7
	OPENBSD_5_5:1.5.0.6
	OPENBSD_5_5_BASE:1.5
	OPENBSD_5_4:1.5.0.4
	OPENBSD_5_4_BASE:1.5
	OPENBSD_5_3:1.5.0.2
	OPENBSD_5_3_BASE:1.5
	OPENBSD_5_2:1.4.0.2
	OPENBSD_5_2_BASE:1.4
	OPENBSD_5_1_BASE:1.3
	OPENBSD_5_1:1.3.0.10
	OPENBSD_5_0:1.3.0.8
	OPENBSD_5_0_BASE:1.3
	OPENBSD_4_9:1.3.0.6
	OPENBSD_4_9_BASE:1.3
	OPENBSD_4_8:1.3.0.4
	OPENBSD_4_8_BASE:1.3
	OPENBSD_4_7:1.3.0.2
	OPENBSD_4_7_BASE:1.3
	OPENBSD_4_6:1.2.0.8
	OPENBSD_4_6_BASE:1.2
	OPENBSD_4_5:1.2.0.6
	OPENBSD_4_5_BASE:1.2
	OPENBSD_4_4:1.2.0.4
	OPENBSD_4_4_BASE:1.2
	OPENBSD_4_3:1.2.0.2
	OPENBSD_4_3_BASE:1.2
	OPENBSD_4_2:1.1.1.1.0.2
	OPENBSD_4_2_BASE:1.1.1.1
	robert20070720:1.1.1.1
	robert:1.1.1;
locks; strict;
comment	@# @;


1.9
date	2015.08.15.07.50.02;	author ajacoutot;	state Exp;
branches;
next	1.8;
commitid	DcwQCoBvkpVxpEev;

1.8
date	2014.08.14.06.52.59;	author ajacoutot;	state Exp;
branches;
next	1.7;
commitid	SWEgo0VEo1kHfm7f;

1.7
date	2014.04.19.10.26.55;	author sthen;	state Exp;
branches;
next	1.6;

1.6
date	2014.04.19.09.44.11;	author ajacoutot;	state Exp;
branches;
next	1.5;

1.5
date	2012.09.14.08.14.31;	author ajacoutot;	state Exp;
branches;
next	1.4;

1.4
date	2012.06.28.19.24.56;	author ajacoutot;	state Exp;
branches
	1.4.2.1;
next	1.3;

1.3
date	2009.10.02.02.34.05;	author merdely;	state Exp;
branches;
next	1.2;

1.2
date	2008.02.07.02.53.35;	author merdely;	state Exp;
branches;
next	1.1;

1.1
date	2007.07.20.11.02.14;	author robert;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2007.07.20.11.02.14;	author robert;	state Exp;
branches;
next	;

1.4.2.1
date	2012.09.15.10.42.30;	author sthen;	state Exp;
branches;
next	;


desc
@@


1.9
log
@Update to bacula-client-7.2.0.
README parts from sthen@@

ok sthen@@
@
text
@$OpenBSD: patch-src_stored_bacula-sd_conf_in,v 1.8 2014/08/14 06:52:59 ajacoutot Exp $
--- src/stored/bacula-sd.conf.in.orig	Thu Aug 13 15:52:24 2015
+++ src/stored/bacula-sd.conf.in	Fri Aug 14 10:16:42 2015
@@@@ -130,15 +130,15 @@@@ Device {
 #  Name = Autochanger
 #  Device = Drive-1
 #  Device = Drive-2
-#  Changer Command = "@@scriptdir@@/mtx-changer %c %o %S %a %d"
-#  Changer Device = /dev/sg0
+#  Changer Command = "@@scriptdir@@/chio-changer-openbsd %c %o %S %a %d"
+#  Changer Device = /dev/ch0
 #}
 
 #Device {
 #  Name = Drive-1                      #
 #  Drive Index = 0
 #  Media Type = DLT-8000
-#  Archive Device = /dev/nst0
+#  Archive Device = @@TAPEDRIVE@@
 #  AutomaticMount = yes;               # when device opened, read it
 #  AlwaysOpen = yes;
 #  RemovableMedia = yes;
@@@@ -160,7 +160,7 @@@@ Device {
 #  Name = Drive-2                      #
 #  Drive Index = 1
 #  Media Type = DLT-8000
-#  Archive Device = /dev/nst1
+#  Archive Device = @@TAPEDRIVE@@
 #  AutomaticMount = yes;               # when device opened, read it
 #  AlwaysOpen = yes;
 #  RemovableMedia = yes;
@@@@ -184,8 +184,8 @@@@ Device {
 #  RemovableMedia = yes;
 #  RandomAccess = no;
 #  Maximum File Size = 3GB
-## Changer Command = "@@scriptdir@@/mtx-changer %c %o %S %a %d"
-## Changer Device = /dev/sg0
+## Changer Command = "@@scriptdir@@/chio-changer-openbsd %c %o %S %a %d"
+## Changer Device = /dev/ch0
 ## AutoChanger = yes
 #  # Enable the Alert command only if you have the mtx package loaded
 ## Alert Command = "sh -c 'tapeinfo -f %c |grep TapeAlert|cat'"
@@@@ -205,8 +205,8 @@@@ Device {
 #  RemovableMedia = yes;
 #  RandomAccess = no;
 #  Maximum File Size = 4GB
-## Changer Command = "@@scriptdir@@/mtx-changer %c %o %S %a %d"
-## Changer Device = /dev/sg0
+## Changer Command = "@@scriptdir@@/chio-changer-openbsd %c %o %S %a %d"
+## Changer Device = /dev/ch0
 ## AutoChanger = yes
 #  # Enable the Alert command only if you have the mtx package loaded
 ## Alert Command = "sh -c 'tapeinfo -f %c |grep TapeAlert|cat'"
@@@@ -226,8 +226,8 @@@@ Device {
 #  RemovableMedia = yes;
 #  RandomAccess = no;
 #  Maximum File Size = 5GB
-## Changer Command = "@@scriptdir@@/mtx-changer %c %o %S %a %d"
-## Changer Device = /dev/sg0
+## Changer Command = "@@scriptdir@@/chio-changer-openbsd %c %o %S %a %d"
+## Changer Device = /dev/ch0
 ## AutoChanger = yes
 #  # Enable the Alert command only if you have the mtx package loaded
 ## Alert Command = "sh -c 'tapeinfo -f %c |grep TapeAlert|cat'"
@@@@ -265,7 +265,7 @@@@ Device {
 #  Name = DDS-4
 #  Description = "DDS-4 for FreeBSD"
 #  Media Type = DDS-4
-#  Archive Device = /dev/nsa1
+#  Archive Device = @@TAPEDRIVE@@
 #  AutomaticMount = yes;               # when device opened, read it
 #  AlwaysOpen = yes
 #  Offline On Unmount = no
@


1.8
log
@Update to bacula-client-7.0.5.
@
text
@d1 4
a4 4
$OpenBSD: patch-src_stored_bacula-sd_conf_in,v 1.7 2014/04/19 10:26:55 sthen Exp $
--- src/stored/bacula-sd.conf.in.orig	Tue Jul 29 18:31:22 2014
+++ src/stored/bacula-sd.conf.in	Thu Jul 31 16:12:28 2014
@@@@ -124,15 +124,15 @@@@ Device {
d23 1
a23 1
@@@@ -154,7 +154,7 @@@@ Device {
d32 1
a32 1
@@@@ -178,8 +178,8 @@@@ Device {
d43 1
a43 1
@@@@ -199,8 +199,8 @@@@ Device {
d54 1
a54 1
@@@@ -220,8 +220,8 @@@@ Device {
d65 1
a65 1
@@@@ -259,7 +259,7 @@@@ Device {
@


1.7
log
@tweak sample bacula-sd.conf; fix a couple of changer device names
@
text
@d1 4
a4 4
$OpenBSD: patch-src_stored_bacula-sd_conf_in,v 1.6 2014/04/19 09:44:11 ajacoutot Exp $
--- src/stored/bacula-sd.conf.in.orig	Wed Apr  2 18:32:30 2014
+++ src/stored/bacula-sd.conf.in	Sat Apr 19 11:19:48 2014
@@@@ -126,15 +126,15 @@@@ Device {
d23 1
a23 1
@@@@ -156,7 +156,7 @@@@ Device {
d32 1
a32 1
@@@@ -180,8 +180,8 @@@@ Device {
d43 1
a43 1
@@@@ -201,8 +201,8 @@@@ Device {
d54 1
a54 1
@@@@ -222,8 +222,8 @@@@ Device {
d65 1
a65 1
@@@@ -261,7 +261,7 @@@@ Device {
@


1.6
log
@Major update to Bacula 7.0.2.
Some info at:
http://blog.bacula.org/p710/
http://blog.bacula.org/release-7-0-2/

Now builds with our libtool(1).

While there's a huge amount of changes, existing setups "should" just
work without any modification.

tested by sthen@@ and myself
ok sthen@@, my new co-maintainer :-)
@
text
@d1 3
a3 3
$OpenBSD: patch-src_stored_bacula-sd_conf_in,v 1.5 2012/09/14 08:14:31 ajacoutot Exp $
--- src/stored/bacula-sd.conf.in.orig	Sat Mar 29 09:00:03 2014
+++ src/stored/bacula-sd.conf.in	Fri Apr  4 22:03:00 2014
d43 1
a43 1
@@@@ -201,7 +201,7 @@@@ Device {
d48 1
d50 1
a50 1
 ## Changer Device = /dev/sg0
d53 2
a54 1
@@@@ -222,7 +222,7 @@@@ Device {
d59 1
d61 1
a61 1
 ## Changer Device = /dev/sg0
d64 1
@


1.5
log
@Update to bacula-5.2.11.

ok sthen@@
@
text
@d1 4
a4 4
$OpenBSD: patch-src_stored_bacula-sd_conf_in,v 1.4 2012/06/28 19:24:56 ajacoutot Exp $
--- src/stored/bacula-sd.conf.in.orig	Tue Feb 21 16:59:33 2012
+++ src/stored/bacula-sd.conf.in	Thu Jun 28 19:53:06 2012
@@@@ -67,15 +67,15 @@@@ Device {
d23 1
a23 1
@@@@ -97,7 +97,7 @@@@ Device {
d32 1
a32 1
@@@@ -121,8 +121,8 @@@@ Device {
d43 1
a43 1
@@@@ -142,7 +142,7 @@@@ Device {
d52 1
a52 1
@@@@ -163,7 +163,7 @@@@ Device {
d61 2
a62 2
@@@@ -182,7 +182,7 @@@@ Device {
 #  Name = DDS-4 
@


1.4
log
@Add a chio-changer script in replacement for the mtx-changer script.
Adapted from NetBSD pkgsrc and FreeBSD ports.
@@sample the script so that people can apply local modifications if
needed.

Tested on an LTO-4, 8 slots.

Why do all chio(1) behave differently!!!???

ok sthen@@ merdely@@ (maintainer)
@
text
@d1 1
a1 1
$OpenBSD: patch-src_stored_bacula-sd_conf_in,v 1.3 2009/10/02 02:34:05 merdely Exp $
d10 1
a10 1
+#  Changer Command = "@@scriptdir@@/chio-changer %c %o %S %a %d"
d38 1
a38 1
+## Changer Command = "@@scriptdir@@/chio-changer %c %o %S %a %d"
d48 1
a48 1
+## Changer Command = "@@scriptdir@@/chio-changer %c %o %S %a %d"
d57 1
a57 1
+## Changer Command = "@@scriptdir@@/chio-changer %c %o %S %a %d"
@


1.4.2.1
log
@MFC bacula update (security fix CVE-2012-4430); ok ajacoutot@@

This is a problem with console ACLs which was allowing access to certain
functionality and e.g. dump resources which should have been restricted.
Problem only affects people who have configured console ACLs.
@
text
@d1 1
a1 1
$OpenBSD: patch-src_stored_bacula-sd_conf_in,v 1.5 2012/09/14 08:14:31 ajacoutot Exp $
d10 1
a10 1
+#  Changer Command = "@@scriptdir@@/chio-changer-openbsd %c %o %S %a %d"
d38 1
a38 1
+## Changer Command = "@@scriptdir@@/chio-changer-openbsd %c %o %S %a %d"
d48 1
a48 1
+## Changer Command = "@@scriptdir@@/chio-changer-openbsd %c %o %S %a %d"
d57 1
a57 1
+## Changer Command = "@@scriptdir@@/chio-changer-openbsd %c %o %S %a %d"
@


1.3
log
@Update bacula to 3.0.2:
	* Shared objects
	* Virtual backups
	* Duplicate Job Control
	* TLS Authentication
	* Exclude Dir Containing = <filename-string>
	* Plugins including Exchange 2003/2007 Plugin
	* libdbi backend abstraction
	* Bat enhancements

Upgrading from 2.4.4 to 3.0.2 requires updating the database using
/usr/local/libexec/bacula/update_bacula_database.  Database upgrades
from older databases can be done with other scripts in
/usr/local/libexec/bacula/updatedb.  You can determine your database
version in mysql and postgresql with 'select * from version'.

As sthen@@ reminded me and the documentation points out, when upgrading
between major versions (2.x.x -> 3.x.x), you should upgrade all of your
components at the same time due to protocol changes.

a *lot* of help from and ok sthen@@
@
text
@d1 5
a5 4
$OpenBSD: patch-src_stored_bacula-sd_conf_in,v 1.2 2008/02/07 02:53:35 merdely Exp $
--- src/stored/bacula-sd.conf.in.orig	Wed Jul 15 09:59:59 2009
+++ src/stored/bacula-sd.conf.in	Tue Sep  1 22:34:25 2009
@@@@ -68,14 +68,14 @@@@ Device {
d8 1
a8 1
 #  Changer Command = "@@scriptdir@@/mtx-changer %c %o %S %a %d"
d10 1
d32 2
a33 1
@@@@ -122,7 +122,7 @@@@ Device {
d36 1
a36 1
 ## Changer Command = "@@scriptdir@@/mtx-changer %c %o %S %a %d"
d38 1
d43 18
@


1.2
log
@Update bacula to 2.2.8.

Bacula changelog:
http://bacula.svn.sourceforge.net/viewvc/bacula/branches/Branch-2.2/bacula/ChangeLog?revision=6309&view=markup

Major port change in this version:
-main subpackage is now bacula-client
-server subpackage remains bacula-server
-bat subpackage is new bacula admin tool
-client subpackage goes away.

If the old -main subpackage was installed, the upgrade path is to
install both bacula-client and bacula-server.

Lots of input and assistance from sthen and okan.
ok okan;  "if it works for you, go for it" sthen
@
text
@d1 4
a4 32
$OpenBSD: patch-src_stored_bacula-sd_conf_in,v 1.1.1.1 2007/07/20 11:02:14 robert Exp $
--- src/stored/bacula-sd.conf.in.orig	Mon Apr 23 12:31:14 2007
+++ src/stored/bacula-sd.conf.in	Sat Aug 11 12:06:26 2007
@@@@ -11,7 +11,7 @@@@
 #
 
 Storage {                             # definition of myself
-  Name = @@hostname@@-sd
+  Name = bacula-sd
   SDPort = @@sd_port@@                  # Director's port      
   WorkingDirectory = "@@working_dir@@"
   Pid Directory = "@@piddir@@"
@@@@ -22,7 +22,7 @@@@ Storage {                             # definition of 
 # List Directors who are permitted to contact Storage daemon
 #
 Director {
-  Name = @@hostname@@-dir
+  Name = bacula-dir
   Password = "@@sd_password@@"
 }
 
@@@@ -31,7 +31,7 @@@@ Director {
 #   status of the storage daemon
 #
 Director {
-  Name = @@hostname@@-mon
+  Name = bacula-mon
   Password = "@@mon_sd_password@@"
   Monitor = yes
 }
@@@@ -60,15 +60,15 @@@@ Device {
 #  Name = Autochanger
d7 1
a7 1
-#  Changer Command = "/home/kern/bacula/bin/mtx-changer %c %o %S %a %d"
a8 1
+#  Changer Command = "@@scriptdir@@/mtx-changer %c %o %S %a %d"
d21 1
a21 1
@@@@ -90,7 +90,7 @@@@ Device {
d30 1
a30 2
@@@@ -114,7 +114,7 @@@@ Device {
 #  RemovableMedia = yes;
d32 1
d39 1
a39 1
@@@@ -129,7 +129,7 @@@@ Device {
a47 36
@@@@ -169,7 +169,7 @@@@ Device {
 #  Name = "DVD Writer"
 #  Media Type = DVD
 #  Device Type = DVD
-#  Archive Device = /dev/hdc
+#  Archive Device = /dev/cd0
 #  LabelMedia = yes;                   # lets Bacula label unlabeled media
 #  Random Access = Yes;
 #  AutomaticMount = yes;               # when device opened, read it
@@@@ -177,8 +177,8 @@@@ Device {
 #  AlwaysOpen = no;
 #  MaximumPartSize = 800M;
 #  RequiresMount = yes;
-#  MountPoint = /mnt/cdrom;
-#  MountCommand = "/bin/mount -t iso9660 -o ro %a %m";
+#  MountPoint = /mnt;
+#  MountCommand = "/bin/mount -t cd9660 -o ro %a %m";
 #  UnmountCommand = "/bin/umount %m";
 #  SpoolDirectory = /tmp/backup;
 #  WritePartCommand = "/etc/bacula/dvd-handler %a write %e %v"
@@@@ -191,7 +191,7 @@@@ Device {
 #Device {
 #  Name = DDS-3
 #  Media Type = DDS-3
-#  Archive Device = /dev/nrst0
+#  Archive Device = @@TAPEDRIVE@@
 #  Use MTIOCGET= no
 #  BSF at EOM = yes
 #  TWO EOF = no
@@@@ -225,5 +225,5 @@@@ Device {
 #
 Messages {
   Name = Standard
-  director = @@hostname@@-dir = all
+  director = bacula-dir = all
 }
@


1.1
log
@Initial revision
@
text
@d1 3
a3 3
$OpenBSD$
--- src/stored/bacula-sd.conf.in.orig	Mon Mar  5 07:33:59 2007
+++ src/stored/bacula-sd.conf.in	Thu Jul 12 11:26:01 2007
d50 1
a50 1
@@@@ -84,7 +84,7 @@@@ Device {
d59 1
a59 1
@@@@ -108,7 +108,7 @@@@ Device {
d68 1
a68 1
@@@@ -123,7 +123,7 @@@@ Device {
d77 2
a78 3
@@@@ -162,7 +162,7 @@@@ Device {
 #Device {
 #  Name = "DVD-Writer"
d80 1
d86 12
a97 1
@@@@ -184,7 +184,7 @@@@ Device {
d106 1
a106 1
@@@@ -218,5 +218,5 @@@@ Device {
@


1.1.1.1
log
@import of bacula 2.0.3;

Bacula is a set of computer programs that permit you (or the system
administrator) to manage backup, recovery, and verification of
computer data across a network of computers of different kinds.
In technical terms, it is a network Client/Server based backup program.
Bacula is relatively easy to use and efficient, while offering many
advanced storage management features that make it easy to find and
recover lost or damaged files. Due to its modular design, Bacula is
scalable from small single computer systems to systems consisting of
hundreds of computers located over a large network.

from Mike Erdely <mike@@erdelynet.com>
@
text
@@
