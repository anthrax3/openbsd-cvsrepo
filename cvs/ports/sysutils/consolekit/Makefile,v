head	1.62;
access;
symbols
	OPENBSD_6_1:1.60.0.2
	OPENBSD_6_1_BASE:1.60
	OPENBSD_6_0:1.58.0.2
	OPENBSD_6_0_BASE:1.58
	OPENBSD_5_9:1.56.0.2
	OPENBSD_5_9_BASE:1.56
	OPENBSD_5_8:1.48.0.4
	OPENBSD_5_8_BASE:1.48
	OPENBSD_5_7:1.46.0.2
	OPENBSD_5_7_BASE:1.46
	OPENBSD_5_6:1.43.0.4
	OPENBSD_5_6_BASE:1.43
	OPENBSD_5_5:1.43.0.2
	OPENBSD_5_5_BASE:1.43
	OPENBSD_5_4:1.31.0.2
	OPENBSD_5_4_BASE:1.31
	OPENBSD_5_3:1.28.0.2
	OPENBSD_5_3_BASE:1.28
	OPENBSD_5_2:1.24.0.2
	OPENBSD_5_2_BASE:1.24
	OPENBSD_5_1_BASE:1.23
	OPENBSD_5_1:1.23.0.2
	OPENBSD_5_0:1.21.0.2
	OPENBSD_5_0_BASE:1.21
	OPENBSD_4_9:1.14.0.2
	OPENBSD_4_9_BASE:1.14
	OPENBSD_4_8:1.11.0.2
	OPENBSD_4_8_BASE:1.11
	OPENBSD_4_7:1.5.0.2
	OPENBSD_4_7_BASE:1.5
	OPENBSD_4_6:1.2.0.2
	OPENBSD_4_6_BASE:1.2
	robert_20090606:1.1.1.1
	robert:1.1.1;
locks; strict;
comment	@# @;


1.62
date	2017.07.23.21.12.27;	author ajacoutot;	state Exp;
branches;
next	1.61;
commitid	FnauLNN5j4yhit9A;

1.61
date	2017.07.21.08.55.05;	author ajacoutot;	state Exp;
branches;
next	1.60;
commitid	IC3pcQjW8kXLlC9d;

1.60
date	2017.01.25.03.19.26;	author ajacoutot;	state Exp;
branches;
next	1.59;
commitid	kxOv9VWoA1y0TX7G;

1.59
date	2016.09.28.19.26.12;	author ajacoutot;	state Exp;
branches;
next	1.58;
commitid	hR2YE9A0KpuNI4pb;

1.58
date	2016.03.19.17.51.34;	author ajacoutot;	state Exp;
branches;
next	1.57;
commitid	YLaTybgOKFQv2GEb;

1.57
date	2016.03.11.20.28.31;	author naddy;	state Exp;
branches;
next	1.56;
commitid	UYLP8TE6V7RS2GhJ;

1.56
date	2016.01.21.06.43.37;	author ajacoutot;	state Exp;
branches;
next	1.55;
commitid	bMWC9d6SAIeHxNWO;

1.55
date	2016.01.15.14.20.02;	author ajacoutot;	state Exp;
branches;
next	1.54;
commitid	HxIN7n2ZVebDy3XQ;

1.54
date	2015.12.29.19.49.41;	author jasper;	state Exp;
branches;
next	1.53;
commitid	qnWWfNxRwuFA0B7n;

1.53
date	2015.12.29.12.54.11;	author jasper;	state Exp;
branches;
next	1.52;
commitid	Z7BAKWlffCf6cwcy;

1.52
date	2015.08.27.06.48.30;	author ajacoutot;	state Exp;
branches;
next	1.51;
commitid	fg1RtdQjUrtjJJWq;

1.51
date	2015.08.17.08.40.13;	author ajacoutot;	state Exp;
branches;
next	1.50;
commitid	2GWZcReDlSQ0b7ZQ;

1.50
date	2015.08.17.07.10.34;	author ajacoutot;	state Exp;
branches;
next	1.49;
commitid	G1gPvOfiOgxx76fX;

1.49
date	2015.08.15.11.12.54;	author ajacoutot;	state Exp;
branches;
next	1.48;
commitid	RKWZWmWhKNwhuQQN;

1.48
date	2015.04.04.09.30.30;	author ajacoutot;	state Exp;
branches;
next	1.47;
commitid	QSLndtZiU46ysFLn;

1.47
date	2015.04.04.09.21.04;	author ajacoutot;	state Exp;
branches;
next	1.46;
commitid	kS3kwKZogsvzYmEY;

1.46
date	2015.02.25.10.35.06;	author ajacoutot;	state Exp;
branches;
next	1.45;
commitid	XZ9AaQFF6qTlVTj4;

1.45
date	2014.11.27.09.38.22;	author ajacoutot;	state Exp;
branches;
next	1.44;
commitid	oD5B2Fc2vHIt4ytZ;

1.44
date	2014.10.10.12.46.23;	author ajacoutot;	state Exp;
branches;
next	1.43;
commitid	Pz94FzKWMxh5zHa9;

1.43
date	2013.12.31.16.14.53;	author ajacoutot;	state Exp;
branches;
next	1.42;

1.42
date	2013.12.30.08.52.08;	author ajacoutot;	state Exp;
branches;
next	1.41;

1.41
date	2013.12.29.18.47.37;	author ajacoutot;	state Exp;
branches;
next	1.40;

1.40
date	2013.12.27.10.12.58;	author ajacoutot;	state Exp;
branches;
next	1.39;

1.39
date	2013.11.30.08.21.41;	author ajacoutot;	state Exp;
branches;
next	1.38;

1.38
date	2013.10.31.08.29.36;	author ajacoutot;	state Exp;
branches;
next	1.37;

1.37
date	2013.10.31.06.38.44;	author ajacoutot;	state Exp;
branches;
next	1.36;

1.36
date	2013.10.15.13.31.14;	author ajacoutot;	state Exp;
branches;
next	1.35;

1.35
date	2013.10.14.13.56.10;	author ajacoutot;	state Exp;
branches;
next	1.34;

1.34
date	2013.10.09.16.43.13;	author ajacoutot;	state Exp;
branches;
next	1.33;

1.33
date	2013.09.24.08.52.43;	author jca;	state Exp;
branches;
next	1.32;

1.32
date	2013.09.24.08.39.04;	author ajacoutot;	state Exp;
branches;
next	1.31;

1.31
date	2013.04.05.06.59.11;	author ajacoutot;	state Exp;
branches;
next	1.30;

1.30
date	2013.03.21.08.48.53;	author ajacoutot;	state Exp;
branches;
next	1.29;

1.29
date	2013.03.11.11.41.29;	author espie;	state Exp;
branches;
next	1.28;

1.28
date	2012.10.12.15.04.14;	author ajacoutot;	state Exp;
branches;
next	1.27;

1.27
date	2012.10.12.14.55.42;	author ajacoutot;	state Exp;
branches;
next	1.26;

1.26
date	2012.09.15.15.36.00;	author ajacoutot;	state Exp;
branches;
next	1.25;

1.25
date	2012.08.17.14.08.25;	author ajacoutot;	state Exp;
branches;
next	1.24;

1.24
date	2012.04.28.10.52.08;	author ajacoutot;	state Exp;
branches;
next	1.23;

1.23
date	2012.01.08.19.42.02;	author naddy;	state Exp;
branches;
next	1.22;

1.22
date	2011.12.20.19.24.38;	author ajacoutot;	state Exp;
branches;
next	1.21;

1.21
date	2011.06.02.17.09.32;	author kili;	state Exp;
branches;
next	1.20;

1.20
date	2011.06.02.13.41.40;	author ajacoutot;	state Exp;
branches;
next	1.19;

1.19
date	2011.06.01.11.29.53;	author ajacoutot;	state Exp;
branches;
next	1.18;

1.18
date	2011.05.18.11.18.31;	author jasper;	state Exp;
branches;
next	1.17;

1.17
date	2011.05.14.12.13.13;	author ajacoutot;	state Exp;
branches;
next	1.16;

1.16
date	2011.04.28.13.08.33;	author ajacoutot;	state Exp;
branches;
next	1.15;

1.15
date	2011.03.02.06.50.23;	author ajacoutot;	state Exp;
branches;
next	1.14;

1.14
date	2010.11.20.17.22.40;	author espie;	state Exp;
branches;
next	1.13;

1.13
date	2010.10.26.21.36.33;	author ajacoutot;	state Exp;
branches;
next	1.12;

1.12
date	2010.09.17.13.37.57;	author ajacoutot;	state Exp;
branches;
next	1.11;

1.11
date	2010.08.01.15.31.57;	author ajacoutot;	state Exp;
branches;
next	1.10;

1.10
date	2010.07.05.06.51.40;	author ajacoutot;	state Exp;
branches;
next	1.9;

1.9
date	2010.07.01.07.50.59;	author ajacoutot;	state Exp;
branches;
next	1.8;

1.8
date	2010.06.30.22.51.33;	author ajacoutot;	state Exp;
branches;
next	1.7;

1.7
date	2010.06.28.15.55.21;	author ajacoutot;	state Exp;
branches;
next	1.6;

1.6
date	2010.06.27.22.15.38;	author ajacoutot;	state Exp;
branches;
next	1.5;

1.5
date	2009.11.13.14.52.33;	author ajacoutot;	state Exp;
branches;
next	1.4;

1.4
date	2009.10.27.12.00.22;	author jasper;	state Exp;
branches;
next	1.3;

1.3
date	2009.10.16.09.36.56;	author ajacoutot;	state Exp;
branches;
next	1.2;

1.2
date	2009.06.07.07.49.44;	author ajacoutot;	state Exp;
branches;
next	1.1;

1.1
date	2009.06.07.02.55.19;	author robert;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2009.06.07.02.55.19;	author robert;	state Exp;
branches;
next	;


desc
@@


1.62
log
@Needs devel/gettext-tools for autopoint.
@
text
@# $OpenBSD: Makefile,v 1.61 2017/07/21 08:55:05 ajacoutot Exp $

COMMENT=		framework for defining and tracking users, sessions & seats

PKGNAME=		${DISTNAME:L}

GH_TAGNAME=		1.2.0
GH_ACCOUNT=		ConsoleKit2
GH_PROJECT=		ConsoleKit2

CATEGORIES=		sysutils	

SHARED_LIBS +=  consolekit           0.0      # 1.0
SHARED_LIBS +=  ck-connector         1.2      # 0.0

MAINTAINER=		Antoine Jacoutot <ajacoutot@@openbsd.org>

# GPLv2+
PERMIT_PACKAGE_CDROM=	Yes

WANTLIB += ICE SM X11 c dbus-1 drm ffi gio-2.0 glib-2.0 gmodule-2.0
WANTLIB += gobject-2.0 iconv intl kvm m pcre polkit-gobject-1
WANTLIB += pthread xcb z

USE_GMAKE=		Yes

BUILD_DEPENDS=		devel/gobject-introspection \
			textproc/xmlto

LIB_DEPENDS=		sysutils/polkit

# /usr/local/share/dbus-1/system-services/
RUN_DEPENDS +=		x11/dbus,-suid

CONFIGURE_STYLE=	gnu
CONFIGURE_ARGS=		--disable-pam-module \
			--with-pam-module-dir=${LOCALBASE}/lib/security

FAKE_FLAGS=		DBUS_SYS_DIR=${TRUEPREFIX}/share/examples/consolekit/dbus-1 \
			sysconfdir=${TRUEPREFIX}/share/examples/consolekit

AUTOCONF_VERSION=	2.69
AUTOMAKE_VERSION=	1.15
BUILD_DEPENDS +=	${MODGNU_AUTOCONF_DEPENDS} \
			${MODGNU_AUTOMAKE_DEPENDS} \
			devel/gettext-tools \
			devel/libtool

pre-configure:
	cd ${WRKSRC} && \
		AUTOCONF_VERSION=${AUTOCONF_VERSION} \
		AUTOMAKE_VERSION=${AUTOMAKE_VERSION} \
		NOCONFIGURE=1 \
		/bin/sh ./autogen.sh ${CONFIGURE_ARGS}

post-install:
	rmdir ${WRKINST}/var/run/ConsoleKit
	rm -r ${WRKINST}/${SYSCONFDIR}/X11/xinit/xinitrc.d \
		${PREFIX}/share/examples/consolekit/logrotate.d

.include <bsd.port.mk>
@


1.61
log
@Update to consolekit2-1.2.0.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.60 2017/01/25 03:19:26 ajacoutot Exp $
d46 1
@


1.60
log
@Fix for OpenBSD VT device naming scheme.
Tweak the display manager users list.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59 2016/09/28 19:26:12 ajacoutot Exp $
d7 1
a7 1
GH_TAGNAME=		1.0.2
a10 2
REVISION=		1

d13 2
a14 1
SHARED_LIBS +=  ck-connector         1.1      # 0.0
d21 3
a23 2
WANTLIB += X11 c dbus-1 ffi gio-2.0 glib-2.0 gmodule-2.0 gobject-2.0
WANTLIB += gthread-2.0 kvm pcre polkit-gobject-1 pthread xcb z
d25 1
a25 1
MODULES=		devel/gettext
d27 2
a28 1
USE_GMAKE=		Yes
a40 1

@


1.59
log
@Unbreak ck_unix_pid_get_env_hash after recent kvm /dev/mem access restrictions.

from semarie
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2016/03/19 17:51:34 ajacoutot Exp $
d11 1
a11 1
REVISION=		0
@


1.58
log
@Update to consolekit2-1.0.2.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.57 2016/03/11 20:28:31 naddy Exp $
d10 2
@


1.57
log
@garbage collect CONFIGURE_SHARED
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2016/01/21 06:43:37 ajacoutot Exp $
d7 1
a7 1
GH_TAGNAME=		1.0.1
a9 1
REVISION=		0
@


1.56
log
@When assigning session to active VT prefer graphical sessions (upstream).
Fix undefined behavior (upstream).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55 2016/01/15 14:20:02 ajacoutot Exp $
d34 1
a34 2
CONFIGURE_ARGS=		${CONFIGURE_SHARED} \
			--disable-pam-module \
@


1.55
log
@Update to consolekit2-1.0.1.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.54 2015/12/29 19:49:41 jasper Exp $
d10 1
d53 1
a53 1
		/bin/sh ./autogen.sh
@


1.54
log
@DISTNAME is set by bsd.port.mk for these ports now
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2015/12/29 12:54:11 jasper Exp $
a5 1
REVISION=		1
d7 1
a7 1
GH_TAGNAME=		1.0.0
@


1.53
log
@use GH_PROJECT to construct DISTNAME
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.52 2015/08/27 06:48:30 ajacoutot Exp $
a4 1
DISTNAME=		${GH_PROJECT}-${GH_TAGNAME}
@


1.52
log
@Fix DBus @@sample files after recent dbus port update.
The dbus package does not install /etc/dbus-1/system.d/ anymore, so it
needs to be properly @@sample'd.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 2015/08/17 08:40:13 ajacoutot Exp $
d5 1
a5 1
DISTNAME=		ConsoleKit2-${GH_TAGNAME}
@


1.51
log
@Missing @@conflict marker.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2015/08/17 07:10:34 ajacoutot Exp $
d7 1
a7 1
REVISION=		0
@


1.50
log
@Missing build dependency on devel/libtool.

breakage reported by Pavel Korovin
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2015/08/15 11:12:54 ajacoutot Exp $
d7 1
@


1.49
log
@Move to the ConsoleKit2 project and update to the newly released stable version:
consolekit2-1.0.0.
Committing early in the cycle to have time to catch any regression.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2015/04/04 09:30:30 ajacoutot Exp $
d45 2
a46 1
			${MODGNU_AUTOMAKE_DEPENDS}
@


1.48
log
@These need to RUN_DEPENDS on x11/dbus,-suid now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2015/04/04 09:21:04 ajacoutot Exp $
d3 1
a3 4
# NOTE: spam in /var/log/authlog is "expected"
# http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=678506
# https://bugzilla.redhat.com/show_bug.cgi?id=810052#c8
# https://bugzilla.redhat.com/show_bug.cgi?id=809213
d5 2
a6 1
COMMENT=	framework for defining and tracking users
d8 3
a10 4
DISTNAME=	ConsoleKit-0.4.6
EXTRACT_SUFX=	.tar.xz
PKGNAME=	${DISTNAME:L}
REVISION=	14
d12 1
a12 1
CATEGORIES=	sysutils	
d14 1
a14 1
SHARED_LIBS +=  ck-connector         1.0      # 0.0
d16 1
a16 3
HOMEPAGE=	http://www.freedesktop.org/wiki/Software/ConsoleKit

MAINTAINER=	Antoine Jacoutot <ajacoutot@@openbsd.org>
d21 2
a22 3
WANTLIB += X11 c dbus-1 dbus-glib-1 ffi gio-2.0 glib-2.0 gmodule-2.0
WANTLIB += gobject-2.0 gthread-2.0 kvm pcre polkit-gobject-1 pthread
WANTLIB += xcb z
d24 1
a24 1
MASTER_SITES=	http://www.freedesktop.org/software/ConsoleKit/dist/
d26 1
a26 1
MODULES=	devel/gettext
d28 1
a28 2
LIB_DEPENDS=	sysutils/polkit \
		x11/dbus-glib
d31 1
a31 1
RUN_DEPENDS +=	x11/dbus,-suid
d33 25
a57 17
AUTOCONF_VERSION= 2.69
CONFIGURE_STYLE= autoconf
CONFIGURE_ENV=	CPPFLAGS="-I${LOCALBASE}/include -I${X11BASE}/include" \
		LDFLAGS="-L${LOCALBASE}/lib"
CONFIGURE_ARGS=	${CONFIGURE_SHARED} \
		--with-pid-file=/var/run/ConsoleKit/pid \
		--disable-pam-module

USE_GMAKE=	Yes

FAKE_FLAGS=	DBUS_SYS_DIR=${TRUEPREFIX}/share/examples/consolekit/dbus-1 \
		sysconfdir=${TRUEPREFIX}/share/examples/consolekit

pre-patch:
	@@cd ${WRKSRC}/tools && \
		cp -R freebsd openbsd && \
		perl -pi -e "s,freebsd,openbsd,g" openbsd/Makefile.in
@


1.47
log
@Bump after the recent changes in packaging dbus and dconf.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2015/02/25 10:35:06 ajacoutot Exp $
d13 1
a13 1
REVISION=	13
d36 3
@


1.46
log
@Unbreak ck-launch-session by properly initializing len in get_kinfo_proc().
from jmatthew@@

No need to call sysctl(3) twice since we know exactly how many
structures it wants back: just one.
from guenther@@

While here, drop a bogus chunk.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2014/11/27 09:38:22 ajacoutot Exp $
d13 1
a13 1
REVISION=	12
@


1.45
log
@Sync a few cleanups from the ConsoleKit2 project.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2014/10/10 12:46:23 ajacoutot Exp $
d13 1
a13 1
REVISION=	11
@


1.44
log
@Need to see a shrink...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2013/12/31 16:14:53 ajacoutot Exp $
d13 1
a13 1
REVISION=	10
@


1.43
log
@NOTE: spam in /var/log/authlog is "expected".
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2013/12/30 08:52:08 ajacoutot Exp $
d13 1
a13 1
REVISION=	9
d21 1
a21 1
MANTAINER=	Antoine Jacoutot <ajacoutot@@openbsd.org>
@


1.42
log
@Drop /var/run/console management patches, calls to session.d's
session_active_changed are not supported since a while.
That fixes a race condition where connecting to ConsoleKit could fail
which would lead to several issues (unable to unlock screen, reboot...).
@
text
@d1 6
a6 1
# $OpenBSD: Makefile,v 1.41 2013/12/29 18:47:37 ajacoutot Exp $
@


1.41
log
@Tweaks.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2013/12/27 10:12:58 ajacoutot Exp $
d8 1
a8 1
REVISION=	8
a48 5

# from Slackware Linux
post-install:
	${INSTALL_SCRIPT} ${FILESDIR}/pam-foreground-compat.ck \
		${PREFIX}/lib/ConsoleKit/run-session.d/pam-foreground-compat.ck
@


1.40
log
@Add the @@extra marker for /var/log/ConsoleKit/history
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2013/11/30 08:21:41 ajacoutot Exp $
d8 1
a8 1
REVISION=	7
@


1.39
log
@Add missing function to match other OSes -- in case something else out
there uses it.
Re-add the sanity check -- it seems it did not help occasional ckit failures.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2013/10/31 08:29:36 ajacoutot Exp $
d8 1
a8 1
REVISION=	6
@


1.38
log
@Fix uninitialised variable.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2013/10/31 06:38:44 ajacoutot Exp $
d8 1
a8 1
REVISION=	5
@


1.37
log
@Fix a bogus check that may prevent getting the XDG_SESSION_COOKIE
value which in turn prevents session managers from accessing ConsoleKit
since the process could not be looked up.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2013/10/15 13:31:14 ajacoutot Exp $
d8 1
a8 1
REVISION=	4
@


1.36
log
@Use setttyent() for get max VT.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2013/10/14 13:56:10 ajacoutot Exp $
d8 1
a8 1
REVISION=	3
@


1.35
log
@Properly detect the active VT on macppc now that we have support for it.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2013/10/09 16:43:13 ajacoutot Exp $
d8 1
a8 1
REVISION=	2
@


1.34
log
@Fix deprecated use of polkit_authority_get().
time_t fixe: GLib has a 'struct GTimeVal' with a long tv_sec...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2013/09/24 08:52:43 jca Exp $
d8 1
a8 1
REVISION=	1
d38 1
a38 1
		--disable-pam-module \
@


1.33
log
@Fix after the kinfo_proc structure change.
ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2013/09/24 08:39:04 ajacoutot Exp $
d8 1
a8 1
REVISION=	0
@


1.32
log
@Update to consolekit-0.4.6.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2013/04/05 06:59:11 ajacoutot Exp $
d8 1
@


1.31
log
@Fix sed(1) usage in pam-foreground-compat.ck.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2013/03/21 08:48:53 ajacoutot Exp $
d5 2
a6 1
DISTNAME=	ConsoleKit-0.4.5
a7 1
REVISION=	9
d11 1
a11 3
EXTRACT_SUFX=	.tar.bz2

SHARED_LIBS+=	ck-connector	1.0
d28 1
a28 1
LIB_DEPENDS=	sysutils/polkit>=0.101 \
d31 1
a31 1
AUTOCONF_VERSION= 2.68
@


1.30
log
@USE_LIBTOOL=Yes is the default now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2013/03/11 11:41:29 espie Exp $
d7 1
a7 1
REVISION=	8
@


1.29
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2012/10/12 15:04:14 ajacoutot Exp $
a40 1
USE_LIBTOOL=	Yes
@


1.28
log
@VT monitoring is only available on i386 and amd64.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2012/10/12 14:55:42 ajacoutot Exp $
a19 2
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
a20 1
PERMIT_PACKAGE_FTP=	Yes
@


1.27
log
@Bring some checks and enhancements from Debian and FreeBSD.
Enable console monitoring using VT_WAITACTIVE now that we have rthreads \o/
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2012/09/15 15:36:00 ajacoutot Exp $
d7 1
a7 1
REVISION=	7
@


1.26
log
@ck-history: don't truncate --frequent output to 8 chars.
(from upstream)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2012/08/17 14:08:25 ajacoutot Exp $
d7 1
a7 1
REVISION=	6
d42 1
a42 1
		--enable-pam-module=no
@


1.25
log
@Fix WANTLIB.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2012/04/28 10:52:08 ajacoutot Exp $
d7 1
a7 1
REVISION=	5
@


1.24
log
@--localstatedir=/var is the default now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2012/01/08 19:42:02 naddy Exp $
d7 1
a7 1
REVISION=	4
d25 3
a27 3
WANTLIB += X11 Xau Xdmcp c dbus-1 dbus-glib-1 gio-2.0
WANTLIB += glib-2.0 gmodule-2.0 gobject-2.0 gthread-2.0 kvm pcre
WANTLIB += pthread pthread-stubs xcb z polkit-gobject-1
@


1.23
log
@catch up with KERN_PROC2 -> KERN_PROC change
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2011/12/20 19:24:38 ajacoutot Exp $
a40 1
		--localstatedir=/var \
@


1.22
log
@Sanitize get_kinfo_proc().
Fix a warning while here.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2011/06/02 17:09:32 kili Exp $
d7 1
a7 1
REVISION=	3
@


1.21
log
@--disable-silent-rules is now added to CONFIGURE_ARGS per default,
if CONFIGURE_STYLE = gnu.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2011/06/02 13:41:40 ajacoutot Exp $
d7 1
a7 1
REVISION=	2
@


1.20
log
@Add a consistent header that substitutes FULLPKGNAME for the READMEs.

ok jasper@@ sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2011/06/01 11:29:53 ajacoutot Exp $
a41 1
		--disable-silent-rules \
@


1.19
log
@MESSAGE -> README.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2011/05/18 11:18:31 jasper Exp $
d7 1
a7 1
REVISION=	1
@


1.18
log
@- fix path in MESSAGE

"sure" aja@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2011/05/14 12:13:13 ajacoutot Exp $
d7 1
a7 1
REVISION=	0
@


1.17
log
@Maintenance update to consolekit-0.4.5.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2011/04/28 13:08:33 ajacoutot Exp $
d7 1
@


1.16
log
@Update to consolekit-0.4.4.
Make sure we don't try and use /proc.
s/KERN_PROC2/KERN_PROC

ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2011/03/02 06:50:23 ajacoutot Exp $
d5 1
a5 1
DISTNAME=	ConsoleKit-0.4.4
d35 1
a35 1
AUTOCONF_VERSION= 2.64
@


1.15
log
@Tweak example.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2010/11/20 17:22:40 espie Exp $
d5 1
a5 1
DISTNAME=	ConsoleKit-0.4.1
a7 2
REVISION=	3

d12 1
a12 1
SHARED_LIBS+=	ck-connector	0.0
d24 1
a24 1
WANTLIB += X11 Xau Xdmcp c dbus-1 dbus-glib-1 eggdbus-1 gio-2.0
d32 2
a33 1
LIB_DEPENDS=	sysutils/polkit
d35 1
a35 1
AUTOCONF_VERSION= 2.63
d37 2
a38 1
CONFIGURE_ENV=	CFLAGS="-I${LOCALBASE}/include -I${X11BASE}/include"
d41 1
d56 1
a56 1
# from FreeBSD ports and Slackware Linux
a57 4
	${INSTALL_SCRIPT} ${FILESDIR}/ck-get-x11-display-device \
		${PREFIX}/libexec/ck-get-x11-display-device
	${INSTALL_SCRIPT} ${FILESDIR}/ck-get-x11-server-pid \
		${PREFIX}/libexec/ck-get-x11-server-pid
@


1.14
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2010/10/26 21:36:33 ajacoutot Exp $
d8 1
a8 1
REVISION=	2
@


1.13
log
@Document the fact that a system-wide D-BUS daemon needs to be running.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2010/09/17 13:37:57 ajacoutot Exp $
d34 1
a34 1
LIB_DEPENDS=	::sysutils/polkit
@


1.12
log
@Make this work on non-human arches too.

ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2010/08/01 15:31:57 ajacoutot Exp $
d8 1
a8 1
REVISION=	1
@


1.11
log
@Add example on how to enable this if wanted.
Move to new DEPENDS.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2010/07/05 06:51:40 ajacoutot Exp $
d8 1
a8 1
REVISION=	0
@


1.10
log
@Extend some comments.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2010/07/01 07:50:59 ajacoutot Exp $
d8 2
d28 1
a28 1
WANTLIB += pthread pthread-stubs xcb z
d34 1
a34 1
LIB_DEPENDS=	polkit-gobject-1::sysutils/polkit
@


1.9
log
@Some tweaks and remove BROKEN.

*** While basic functionnality works, this is NOT hooked up yet as more
things are coming and there is still a glib2/pthread bug preventing a
console to be detected as active.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2010/06/30 22:51:33 ajacoutot Exp $
d53 1
a53 1
# from FreeBSD ports
@


1.8
log
@Bring in more tweaks and fixes.
@
text
@d1 1
a1 5
# $OpenBSD: Makefile,v 1.7 2010/06/28 15:55:21 ajacoutot Exp $

# XXX rotate /var/log/ConsoleKit/history

BROKEN=		WIP does not work yet
@


1.7
log
@Fix socket credential support.
Tweak COMMENT while here.
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.6 2010/06/27 22:15:38 ajacoutot Exp $
@


1.6
log
@Update to consolekit-0.4.1.
WIP, need uncommited stuffs and does wrong things for now, so it is still
marked as BROKEN.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2009/11/13 14:52:33 ajacoutot Exp $
d5 1
a5 1
COMMENT=	Framework for defining and tracking users
@


1.5
log
@Bring in several fixes from FreeBSD and fd.o bugzilla.
Fix tty names, cmd arguments... Install the stop/restart scripts.
Remove policykit support for now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2009/10/27 12:00:22 jasper Exp $
d7 2
a8 2
DISTNAME=	ConsoleKit-0.3.0
PKGNAME=	${DISTNAME:L}p3
d16 1
a16 1
HOMEPAGE=	http://freedesktop.org/wiki/Software/ConsoleKit
d26 3
a28 2
WANTLIB += X11 Xau Xdmcp c dbus-1 glib-2.0 gobject-2.0 gthread-2.0
WANTLIB += kvm pcre pthread pthread-stubs xcb z
d30 1
a30 1
MASTER_SITES=	ftp://ftp.fr.freebsd.org/pub/FreeBSD/distfiles/
d34 1
a34 1
LIB_DEPENDS=	dbus-glib-1.>=4::x11/dbus-glib
d36 1
a36 1
AUTOCONF_VERSION= 2.61
d38 1
d41 2
a42 2
		--with-pid-file=/var/run/consolekit.pid
CONFIGURE_ENV=	CFLAGS="-I${LOCALBASE}/include -I${X11BASE}/include"
d61 2
@


1.4
log
@- remove patch as we have ENOTSUP now
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2009/10/16 09:36:56 ajacoutot Exp $
d8 1
a8 1
PKGNAME=	${DISTNAME:L}p2
d26 2
a27 2
WANTLIB += X11 Xau Xdmcp c dbus-1 dbus-glib-1 expat glib-2.0 gobject-2.0
WANTLIB += gthread-2.0 kvm pcre pthread pthread-stubs xcb z
d31 1
a31 1
LIB_DEPENDS=	polkit::sysutils/policykit
d33 1
a33 1
MODULES=	devel/gettext
d39 1
a39 3
		--with-pid-file=/var/run/consolekit.pid \
		--with-authfw=bsdauth \
		--with-os-type=openbsd
d52 7
@


1.3
log
@Some cleanups:
* mark as broken for now
* fix copyright
* add a few comments to the patches
* fix dependencies
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2009/06/07 07:49:44 ajacoutot Exp $
d8 1
a8 1
PKGNAME=	${DISTNAME:L}p1
@


1.2
log
@Merge some small changes from my old ConsoleKit port:
- better HOMEPAGE
- add gettext MODULES
- tweak some CONFIGURE_ARGS and put pid file under /var/run so we don't
need to create a special directory for it
- don't create PREFIX/var/...
- add a /var/log/ConsoleKit/ @@sample directory
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.1.1.1 2009/06/07 02:55:19 robert Exp $
d8 2
a9 1
PKGNAME=	${DISTNAME:L}p0
d11 1
d18 2
d26 4
a29 1
WANTLIB=	c
d31 1
a31 1
MASTER_SITES=	http://people.freedesktop.org/~mccann/dist/
d35 8
a42 8
AUTOCONF_VERSION=	2.61
CONFIGURE_STYLE=	autoconf
CONFIGURE_ARGS=		${CONFIGURE_SHARED} \
			--localstatedir=/var \
			--with-pid-file=/var/run/consolekit.pid \
			--with-authfw=bsdauth \
			--with-os-type=openbsd
CONFIGURE_ENV=		CFLAGS="-I${LOCALBASE}/include -I${X11BASE}/include"
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d6 1
a6 1
PKGNAME=	${DISTNAME:L}
d12 1
a12 1
HOMEPAGE=	http://cgit.freedesktop.org/ConsoleKit/
d24 2
d28 4
a31 1
CONFIGURE_ARGS=		--with-authfw=bsdauth \
d38 2
a39 2
FAKE_FLAGS=		DBUS_SYS_DIR=${TRUEPREFIX}/share/examples/consolekit/dbus-1 \
			sysconfdir=${TRUEPREFIX}/share/examples/consolekit
d43 2
a44 2
                cp -R freebsd openbsd && \
                perl -pi -e "s,freebsd,openbsd,g" openbsd/Makefile.in
@


1.1.1.1
log
@import ConsoleKit-0.3.0:
ConsoleKit is a framework for defining and tracking users, login
sessions, and seats.  The primary motivations for this framework are to
facilitate fast-user-switching and multi-seat capabilities, and to
enable more sophisticated policy decisions for desktop sessions.

this is not hooked up to the build just yet, just like policykit
@
text
@@
