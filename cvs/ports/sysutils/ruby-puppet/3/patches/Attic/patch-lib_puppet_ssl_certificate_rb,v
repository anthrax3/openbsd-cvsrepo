head	1.2;
access;
symbols;
locks; strict;
comment	@# @;


1.2
date	2016.06.16.10.17.44;	author sebastia;	state dead;
branches;
next	1.1;
commitid	O2oQ9fdwWelguzEc;

1.1
date	2016.05.27.19.10.39;	author sebastia;	state Exp;
branches;
next	;
commitid	w87pkIk6EvQZMnU7;


desc
@@


1.2
log
@Remove unneeded patch, maybe the ruby update fixed it

OK jasper@@ (MAINTAINER)
@
text
@$OpenBSD: patch-lib_puppet_ssl_certificate_rb,v 1.1 2016/05/27 19:10:39 sebastia Exp $

Make certificate extension available in puppet manifests
See https://tickets.puppetlabs.com/browse/PUP-6365

--- lib/puppet/ssl/certificate.rb.orig	Wed May 25 08:13:50 2016
+++ lib/puppet/ssl/certificate.rb	Wed May 25 08:14:35 2016
@@@@ -60,6 +60,8 @@@@ DOC
         Puppet::SSL::Oids.subtree_of?('ppPrivCertExt', ext.oid)
     end
 
-    custom_exts.map { |ext| {'oid' => ext.oid, 'value' => ext.value} }
+    extensions = []
+    custom_exts.map { |ext| extensions << {'oid' => ext.oid, 'value' => ext.value} }
+    return extensions
   end
 end
@


1.1
log
@Make trusted facts work with the webrick server as well as make them
available when using ruby unicorn behind apache or nginx.

Using unicorn behind apache you need to add header:

RequestHeader set X-SSL-Client-Cert %{SSL_CLIENT_CERT}e

Using unicorn behind nginx, you need to run nginx-lua flavor, then
you need:

   location / {

     set_by_lua $client_cert "return ngx.var.ssl_client_raw_cert:gsub('\\n',' ')";

     proxy_set_header      X-SSL-Client-Cert $client_cert;

   }

OK jasper@@ (MAINTAINER)
@
text
@d1 1
a1 1
$OpenBSD$
@

