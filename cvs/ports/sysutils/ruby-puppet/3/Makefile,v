head	1.137;
access;
symbols
	OPENBSD_6_2:1.137.0.6
	OPENBSD_6_2_BASE:1.137
	OPENBSD_6_1:1.137.0.4
	OPENBSD_6_1_BASE:1.137
	OPENBSD_6_0:1.137.0.2
	OPENBSD_6_0_BASE:1.137
	OPENBSD_5_9:1.123.0.2
	OPENBSD_5_9_BASE:1.123
	OPENBSD_5_8:1.116.0.4
	OPENBSD_5_8_BASE:1.116
	OPENBSD_5_7:1.105.0.2
	OPENBSD_5_7_BASE:1.105
	OPENBSD_5_6:1.77.0.2
	OPENBSD_5_6_BASE:1.77
	OPENBSD_5_5:1.50.0.2
	OPENBSD_5_5_BASE:1.50
	OPENBSD_5_4:1.17.0.2
	OPENBSD_5_4_BASE:1.17;
locks; strict;
comment	@# @;


1.137
date	2016.06.29.16.14.44;	author espie;	state Exp;
branches;
next	1.136;
commitid	c1yQMbJbfo0CFBcL;

1.136
date	2016.06.16.10.17.44;	author sebastia;	state Exp;
branches;
next	1.135;
commitid	O2oQ9fdwWelguzEc;

1.135
date	2016.06.01.12.02.44;	author jasper;	state Exp;
branches;
next	1.134;
commitid	yJWvIJ0K8agbIySX;

1.134
date	2016.06.01.09.10.23;	author jasper;	state Exp;
branches;
next	1.133;
commitid	ulC1Fr9aUQfBlzXf;

1.133
date	2016.05.27.19.10.39;	author sebastia;	state Exp;
branches;
next	1.132;
commitid	w87pkIk6EvQZMnU7;

1.132
date	2016.04.29.07.59.53;	author jasper;	state Exp;
branches;
next	1.131;
commitid	OCq3tUQaOfpy4YXB;

1.131
date	2016.04.28.16.02.33;	author jasper;	state Exp;
branches;
next	1.130;
commitid	I3KF7xVAiq8Q4K3k;

1.130
date	2016.04.28.10.36.17;	author jasper;	state Exp;
branches;
next	1.129;
commitid	sbyYfCtGzIQjNU46;

1.129
date	2016.04.28.09.38.56;	author jasper;	state Exp;
branches;
next	1.128;
commitid	61zJFyPF8xmWHKCM;

1.128
date	2016.04.28.09.27.11;	author jasper;	state Exp;
branches;
next	1.127;
commitid	yZ2IareRDB20V4fq;

1.127
date	2016.04.28.08.58.29;	author jasper;	state Exp;
branches;
next	1.126;
commitid	8aLm7GE9kBffB1Cd;

1.126
date	2016.04.28.08.54.37;	author jasper;	state Exp;
branches;
next	1.125;
commitid	oFqzVKtWscoECE6b;

1.125
date	2016.04.27.09.19.38;	author jasper;	state Exp;
branches;
next	1.124;
commitid	8cE0HOO56qRluGF0;

1.124
date	2016.02.25.07.34.29;	author jasper;	state Exp;
branches;
next	1.123;
commitid	NFNgP8JsJXi9bDEL;

1.123
date	2016.01.22.13.56.27;	author jasper;	state Exp;
branches;
next	1.122;
commitid	rdAcmzCQNeJNL5TM;

1.122
date	2016.01.07.10.39.06;	author sebastia;	state Exp;
branches;
next	1.121;
commitid	X0PuR8YxfC771wU7;

1.121
date	2015.11.06.13.28.10;	author jasper;	state Exp;
branches;
next	1.120;
commitid	sThb6OrOEWAIL91j;

1.120
date	2015.09.29.08.03.07;	author jasper;	state Exp;
branches;
next	1.119;
commitid	I9jg5EekIrzwdj1I;

1.119
date	2015.08.24.11.24.26;	author jasper;	state Exp;
branches;
next	1.118;
commitid	hElSF294s8pOIWcp;

1.118
date	2015.08.13.10.46.31;	author jasper;	state Exp;
branches;
next	1.117;
commitid	5QmLLGVdUgOqyzG5;

1.117
date	2015.08.11.20.19.45;	author jasper;	state Exp;
branches;
next	1.116;
commitid	MUfdKKznAbC3jjju;

1.116
date	2015.07.24.18.19.36;	author jasper;	state Exp;
branches;
next	1.115;
commitid	Kva1TuA91v3hdY1O;

1.115
date	2015.07.18.15.46.11;	author jeremy;	state Exp;
branches;
next	1.114;
commitid	dT77vUpdkg5VEaUi;

1.114
date	2015.07.17.18.09.55;	author jasper;	state Exp;
branches;
next	1.113;
commitid	y2QJj0oFjc5TtJQT;

1.113
date	2015.07.17.17.53.21;	author jasper;	state Exp;
branches;
next	1.112;
commitid	VGAjWk1PrS0n9ksB;

1.112
date	2015.07.17.05.54.45;	author ajacoutot;	state Exp;
branches;
next	1.111;
commitid	e1zum91fL9vRqmOO;

1.111
date	2015.07.15.14.49.02;	author ajacoutot;	state Exp;
branches;
next	1.110;
commitid	AwE9NSoZ9xferhQw;

1.110
date	2015.06.01.06.41.00;	author jasper;	state Exp;
branches;
next	1.109;
commitid	rtEXe3OTGxDEeZr3;

1.109
date	2015.04.16.07.19.12;	author jasper;	state Exp;
branches;
next	1.108;
commitid	kOt7MP6yi9uXryHW;

1.108
date	2015.04.07.17.05.57;	author sebastia;	state Exp;
branches;
next	1.107;
commitid	yjZTE26CgYYekgxk;

1.107
date	2015.04.04.09.28.45;	author jasper;	state Exp;
branches;
next	1.106;
commitid	BK4zluMF2cw4Epmm;

1.106
date	2015.03.15.10.12.47;	author jasper;	state Exp;
branches;
next	1.105;
commitid	bspmHTmcG1RkA2K7;

1.105
date	2015.01.30.10.19.27;	author jasper;	state Exp;
branches;
next	1.104;
commitid	mELHgidabIdUnJsZ;

1.104
date	2015.01.28.08.43.50;	author jasper;	state Exp;
branches;
next	1.103;
commitid	cRhH1SmY4lJYcCmR;

1.103
date	2015.01.18.10.28.12;	author ajacoutot;	state Exp;
branches;
next	1.102;
commitid	VH6IpZ6eLKwhFsgQ;

1.102
date	2014.12.29.18.56.55;	author jasper;	state Exp;
branches;
next	1.101;
commitid	AJbvWYJDXnlZ1FLH;

1.101
date	2014.12.12.07.52.54;	author jasper;	state Exp;
branches;
next	1.100;
commitid	ZcfX3NlTXc9r32kw;

1.100
date	2014.12.04.14.17.39;	author jasper;	state Exp;
branches;
next	1.99;
commitid	Dl9718k99F3b9Sfm;

1.99
date	2014.12.02.19.26.17;	author jasper;	state Exp;
branches;
next	1.98;
commitid	G4mY30IwA30O1ZNe;

1.98
date	2014.11.25.13.19.28;	author jasper;	state Exp;
branches;
next	1.97;
commitid	59DYQqsU2KSRz4GF;

1.97
date	2014.11.17.12.44.20;	author jasper;	state Exp;
branches;
next	1.96;
commitid	VUJKK3kUlmnZolv1;

1.96
date	2014.11.12.07.42.47;	author jasper;	state Exp;
branches;
next	1.95;
commitid	xy6BdfhiV2hBlhui;

1.95
date	2014.11.06.20.28.16;	author jasper;	state Exp;
branches;
next	1.94;
commitid	pVIHLxmGAPbPk88F;

1.94
date	2014.11.05.08.46.40;	author jasper;	state Exp;
branches;
next	1.93;
commitid	Ij3YILbWRo2EGomK;

1.93
date	2014.11.04.19.49.12;	author jasper;	state Exp;
branches;
next	1.92;
commitid	ikoL8419Z8mZ3xjP;

1.92
date	2014.11.04.09.03.58;	author jasper;	state Exp;
branches;
next	1.91;
commitid	Q2mYWmNfGCWHn8ft;

1.91
date	2014.10.30.12.21.37;	author jasper;	state Exp;
branches;
next	1.90;
commitid	5Xe1xvbFEvCxULkn;

1.90
date	2014.10.29.19.35.31;	author jasper;	state Exp;
branches;
next	1.89;
commitid	fgL558T1Y1YT2XqD;

1.89
date	2014.10.23.08.15.27;	author jasper;	state Exp;
branches;
next	1.88;
commitid	uARSNFVFHcRLw4D4;

1.88
date	2014.10.15.10.37.24;	author sebastia;	state Exp;
branches;
next	1.87;
commitid	cVNSEacO67R3mwVs;

1.87
date	2014.09.27.17.08.47;	author jeremy;	state Exp;
branches;
next	1.86;
commitid	VuChuI65GQ9mvmEc;

1.86
date	2014.09.24.10.07.02;	author espie;	state Exp;
branches;
next	1.85;
commitid	Ylz9gUgNQ0iq2Oul;

1.85
date	2014.09.23.09.21.52;	author sthen;	state Exp;
branches;
next	1.84;
commitid	dTSiuGAkIBOlAwBE;

1.84
date	2014.09.16.09.07.03;	author espie;	state Exp;
branches;
next	1.83;
commitid	RMOje3pTBXZOKU4I;

1.83
date	2014.09.16.06.46.37;	author jasper;	state Exp;
branches;
next	1.82;
commitid	sKZuw2UTGVXJIikg;

1.82
date	2014.09.07.18.16.42;	author jasper;	state Exp;
branches;
next	1.81;
commitid	STfu20c85fpA9ykS;

1.81
date	2014.08.26.09.29.51;	author jasper;	state Exp;
branches;
next	1.80;
commitid	SOIbXPlnpEUkf5cU;

1.80
date	2014.08.25.08.09.57;	author jasper;	state Exp;
branches;
next	1.79;
commitid	urg1DfBKVxTx8oJl;

1.79
date	2014.08.25.08.00.37;	author jasper;	state Exp;
branches;
next	1.78;
commitid	O7rrDc6vTFpea7XF;

1.78
date	2014.08.15.13.29.10;	author jasper;	state Exp;
branches;
next	1.77;
commitid	bU7WSP5nRRzoDX8P;

1.77
date	2014.07.17.07.03.51;	author jasper;	state Exp;
branches;
next	1.76;
commitid	LOvLcphCFDkQmvJ3;

1.76
date	2014.07.10.22.13.09;	author jasper;	state Exp;
branches;
next	1.75;
commitid	vveesAFuQbdTwxDe;

1.75
date	2014.07.10.14.22.49;	author jasper;	state Exp;
branches;
next	1.74;
commitid	xW1he1p9wbBOvvc2;

1.74
date	2014.06.19.12.28.34;	author jasper;	state Exp;
branches;
next	1.73;
commitid	gMfKT5l6Cp7brR2E;

1.73
date	2014.06.10.19.51.42;	author jasper;	state Exp;
branches;
next	1.72;
commitid	WcIKn36yclSXHZrl;

1.72
date	2014.06.04.07.53.09;	author jasper;	state Exp;
branches;
next	1.71;
commitid	dPROzX6U1FZduIZs;

1.71
date	2014.06.04.07.48.23;	author jasper;	state Exp;
branches;
next	1.70;
commitid	Mt30wzwBda1Vw9nY;

1.70
date	2014.05.23.06.24.46;	author jasper;	state Exp;
branches;
next	1.69;

1.69
date	2014.05.20.20.00.55;	author jasper;	state Exp;
branches;
next	1.68;

1.68
date	2014.05.20.19.57.04;	author jasper;	state Exp;
branches;
next	1.67;

1.67
date	2014.05.15.20.17.16;	author jasper;	state Exp;
branches;
next	1.66;

1.66
date	2014.05.05.12.17.17;	author jasper;	state Exp;
branches;
next	1.65;

1.65
date	2014.05.04.12.32.26;	author jasper;	state Exp;
branches;
next	1.64;

1.64
date	2014.04.21.22.39.26;	author jasper;	state Exp;
branches;
next	1.63;

1.63
date	2014.04.21.19.12.13;	author jasper;	state Exp;
branches;
next	1.62;

1.62
date	2014.04.21.17.23.19;	author jasper;	state Exp;
branches;
next	1.61;

1.61
date	2014.04.19.12.13.34;	author jasper;	state Exp;
branches;
next	1.60;

1.60
date	2014.04.19.11.07.35;	author jasper;	state Exp;
branches;
next	1.59;

1.59
date	2014.04.19.10.40.56;	author jasper;	state Exp;
branches;
next	1.58;

1.58
date	2014.04.18.22.07.36;	author jasper;	state Exp;
branches;
next	1.57;

1.57
date	2014.04.17.18.10.28;	author jasper;	state Exp;
branches;
next	1.56;

1.56
date	2014.04.17.14.15.53;	author jasper;	state Exp;
branches;
next	1.55;

1.55
date	2014.04.17.14.04.58;	author jasper;	state Exp;
branches;
next	1.54;

1.54
date	2014.04.17.14.01.16;	author jasper;	state Exp;
branches;
next	1.53;

1.53
date	2014.04.17.13.54.59;	author jasper;	state Exp;
branches;
next	1.52;

1.52
date	2014.04.04.14.31.26;	author jasper;	state Exp;
branches;
next	1.51;

1.51
date	2014.03.09.19.44.33;	author jasper;	state Exp;
branches;
next	1.50;

1.50
date	2014.01.12.09.53.37;	author jasper;	state Exp;
branches;
next	1.49;

1.49
date	2013.12.31.12.31.39;	author jasper;	state Exp;
branches;
next	1.48;

1.48
date	2013.12.28.19.08.06;	author jasper;	state Exp;
branches;
next	1.47;

1.47
date	2013.12.21.21.34.33;	author jasper;	state Exp;
branches;
next	1.46;

1.46
date	2013.12.21.15.06.02;	author jasper;	state Exp;
branches;
next	1.45;

1.45
date	2013.12.20.14.10.41;	author jasper;	state Exp;
branches;
next	1.44;

1.44
date	2013.12.13.07.52.55;	author jasper;	state Exp;
branches;
next	1.43;

1.43
date	2013.12.12.21.12.38;	author jasper;	state Exp;
branches;
next	1.42;

1.42
date	2013.12.11.20.41.13;	author jasper;	state Exp;
branches;
next	1.41;

1.41
date	2013.12.06.21.07.03;	author jasper;	state Exp;
branches;
next	1.40;

1.40
date	2013.12.04.09.23.39;	author jasper;	state Exp;
branches;
next	1.39;

1.39
date	2013.12.04.09.20.56;	author jasper;	state Exp;
branches;
next	1.38;

1.38
date	2013.12.02.16.04.26;	author jasper;	state Exp;
branches;
next	1.37;

1.37
date	2013.11.26.14.57.05;	author jasper;	state Exp;
branches;
next	1.36;

1.36
date	2013.11.26.09.59.02;	author jasper;	state Exp;
branches;
next	1.35;

1.35
date	2013.11.25.20.59.06;	author jasper;	state Exp;
branches;
next	1.34;

1.34
date	2013.11.25.15.56.23;	author ajacoutot;	state Exp;
branches;
next	1.33;

1.33
date	2013.11.13.14.32.18;	author jasper;	state Exp;
branches;
next	1.32;

1.32
date	2013.11.12.08.28.29;	author robert;	state Exp;
branches;
next	1.31;

1.31
date	2013.11.09.20.24.12;	author jasper;	state Exp;
branches;
next	1.30;

1.30
date	2013.10.12.09.06.17;	author jasper;	state Exp;
branches;
next	1.29;

1.29
date	2013.10.12.08.55.14;	author jasper;	state Exp;
branches;
next	1.28;

1.28
date	2013.10.04.09.13.29;	author jasper;	state Exp;
branches;
next	1.27;

1.27
date	2013.09.17.18.45.30;	author jasper;	state Exp;
branches;
next	1.26;

1.26
date	2013.09.17.09.00.57;	author jasper;	state Exp;
branches;
next	1.25;

1.25
date	2013.09.15.19.32.47;	author jasper;	state Exp;
branches;
next	1.24;

1.24
date	2013.09.13.07.20.29;	author jasper;	state Exp;
branches;
next	1.23;

1.23
date	2013.08.15.21.31.07;	author jasper;	state Exp;
branches;
next	1.22;

1.22
date	2013.08.14.07.48.05;	author jasper;	state Exp;
branches;
next	1.21;

1.21
date	2013.08.07.08.20.08;	author jasper;	state Exp;
branches;
next	1.20;

1.20
date	2013.08.07.07.19.30;	author jasper;	state Exp;
branches;
next	1.19;

1.19
date	2013.08.06.18.21.27;	author jasper;	state Exp;
branches;
next	1.18;

1.18
date	2013.08.06.18.17.36;	author jasper;	state Exp;
branches;
next	1.17;

1.17
date	2013.07.17.14.18.37;	author jasper;	state Exp;
branches
	1.17.2.1;
next	1.16;

1.16
date	2013.07.09.07.03.29;	author jasper;	state Exp;
branches;
next	1.15;

1.15
date	2013.06.19.07.36.03;	author jasper;	state Exp;
branches;
next	1.14;

1.14
date	2013.06.12.14.02.53;	author jasper;	state Exp;
branches;
next	1.13;

1.13
date	2013.06.11.14.56.14;	author jasper;	state Exp;
branches;
next	1.12;

1.12
date	2013.06.11.13.37.14;	author jasper;	state Exp;
branches;
next	1.11;

1.11
date	2013.06.10.14.46.34;	author jasper;	state Exp;
branches;
next	1.10;

1.10
date	2013.04.16.13.25.52;	author jasper;	state Exp;
branches;
next	1.9;

1.9
date	2013.03.20.06.55.20;	author ajacoutot;	state Exp;
branches;
next	1.8;

1.8
date	2013.03.18.15.07.56;	author ajacoutot;	state Exp;
branches;
next	1.7;

1.7
date	2013.03.15.14.57.25;	author ajacoutot;	state Exp;
branches;
next	1.6;

1.6
date	2013.03.13.14.35.39;	author ajacoutot;	state Exp;
branches;
next	1.5;

1.5
date	2013.03.13.09.56.19;	author ajacoutot;	state Exp;
branches;
next	1.4;

1.4
date	2013.03.12.18.53.49;	author robert;	state Exp;
branches;
next	1.3;

1.3
date	2013.03.08.16.19.15;	author ajacoutot;	state Exp;
branches;
next	1.2;

1.2
date	2013.03.08.16.15.33;	author ajacoutot;	state Exp;
branches;
next	1.1;

1.1
date	2013.03.08.16.12.47;	author ajacoutot;	state Exp;
branches;
next	;

1.17.2.1
date	2013.12.15.19.44.32;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.137
log
@add is-branch to all trivial ports that exist as multiple branches.
@
text
@# $OpenBSD: Makefile,v 1.136 2016/06/16 10:17:44 sebastia Exp $

PORTROACH=		limit:^3

VERSION=		3.8.7
REVISION=		6

RUN_DEPENDS+=		databases/ruby-hiera,${MODRUBY_FLAVOR} \
			sysutils/ruby-facter>=2.0.1p0

SUBST_VARS +=		MODRUBY_BINREV

pre-install:
	mkdir -p ${WRKDIR}/home
	${SUBST_CMD} ${WRKDIST}/lib/puppet/provider/package/gem.rb \
		${WRKDIST}/lib/puppet/provider/package/pip.rb \
		${WRKSRC}/lib/puppet/defaults.rb \
		${WRKSRC}/ext/rack/config.ru

do-install:
	@@cd ${WRKSRC} && ${ALL_FAKE_FLAGS} ${RUBY} install.rb
	mv ${WRKINST}${SYSCONFDIR}/puppet ${PREFIX}/${MODRUBY_RELEXAMPLEDIR}-puppet
	${INSTALL_DATA} ${WRKSRC}/conf/*.conf ${PREFIX}/${MODRUBY_RELEXAMPLEDIR}-puppet
	${INSTALL_DATA} ${FILESDIR}/puppet.conf ${PREFIX}/${MODRUBY_RELEXAMPLEDIR}-puppet
	${INSTALL_DATA} ${WRKSRC}/ext/rack/config.ru ${PREFIX}/${MODRUBY_RELEXAMPLEDIR}-puppet

.include <bsd.port.mk>
@


1.136
log
@Remove unneeded patch, maybe the ruby update fixed it

OK jasper@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.135 2016/06/01 12:02:44 jasper Exp $
d6 1
a6 1
REVISION=		5
@


1.135
log
@rgen is not required by puppet 3 unless the future parser is used
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.134 2016/06/01 09:10:23 jasper Exp $
d6 1
a6 1
REVISION=		4
@


1.134
log
@group SUBST_CMD invocations; spotted by aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.133 2016/05/27 19:10:39 sebastia Exp $
d6 1
a6 1
REVISION=		3
@


1.133
log
@Make trusted facts work with the webrick server as well as make them
available when using ruby unicorn behind apache or nginx.

Using unicorn behind apache you need to add header:

RequestHeader set X-SSL-Client-Cert %{SSL_CLIENT_CERT}e

Using unicorn behind nginx, you need to run nginx-lua flavor, then
you need:

   location / {

     set_by_lua $client_cert "return ngx.var.ssl_client_raw_cert:gsub('\\n',' ')";

     proxy_set_header      X-SSL-Client-Cert $client_cert;

   }

OK jasper@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.132 2016/04/29 07:59:53 jasper Exp $
d15 4
a18 2
	${SUBST_CMD} ${WRKDIST}/lib/puppet/provider/package/gem.rb
	${SUBST_CMD} ${WRKDIST}/lib/puppet/provider/package/pip.rb
a20 1
	${SUBST_CMD} ${WRKSRC}/lib/puppet/defaults.rb ${WRKSRC}/ext/rack/config.ru
@


1.132
log
@put back the FAKE_FLAGS
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.131 2016/04/28 16:02:33 jasper Exp $
d6 1
a6 1
REVISION=		2
@


1.131
log
@- move common bits back to Makefile.inc in post-install
- gunzip puppet 4 manpages
- install emacs files for puppet 4
- move files.conf to puppet 3
- install some extra config files for puppet 4
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.130 2016/04/28 10:36:17 jasper Exp $
a10 1
PORTHOME=		${WRKDIR}
d14 1
@


1.130
log
@move some bits that are common to 3 and 4 into Makefile.inc
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.129 2016/04/28 09:38:56 jasper Exp $
a23 2
	${INSTALL_DATA_DIR} ${PREFIX}/share/emacs/site-lisp/
	${INSTALL_DATA} ${WRKSRC}/ext/emacs/* ${PREFIX}/share/emacs/site-lisp/
a24 1
	gunzip ${PREFIX}/man/*/*.gz
@


1.129
log
@spacing
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.128 2016/04/28 09:27:11 jasper Exp $
d8 2
a9 6
MODULES +=		lang/python
MODPY_BUILDDEP = 	No
MODPY_RUNDEP =		No

RUN_DEPENDS+=		archivers/gtar \
			devel/ruby-rgen,${MODRUBY_FLAVOR}
@


1.128
log
@- move do-install to 3/Makefile as most of it cannot be shared with puppet for now
- add conflict marker with puppet4
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.127 2016/04/28 08:58:29 jasper Exp $
d6 1
a6 1
REVISION=		1
@


1.127
log
@use PORTHOME and tidy Makefile
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.125 2016/04/27 09:19:38 jasper Exp $
d6 1
a6 1
REVISION=		0
d21 11
@


1.126
log
@update HOMEPAGE
@
text
@d3 1
a3 1
PORTROACH=	limit:^3
d5 2
a6 2
VERSION=	3.8.7
REVISION=	0
a10 2
RUN_DEPENDS+=	archivers/gtar \
		devel/ruby-rgen,${MODRUBY_FLAVOR}
d12 5
a16 2
FAKE_FLAGS +=	HOME=${WKRDIR}/home
SUBST_VARS +=	MODRUBY_BINREV
a18 1
	mkdir -p ${WRKDIR}/home
@


1.125
log
@update to puppet-3.8.7
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.124 2016/02/25 07:34:29 jasper Exp $
d6 1
@


1.124
log
@update to puppet-3.8.6
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.123 2016/01/22 13:56:27 jasper Exp $
d5 1
a5 1
VERSION=	3.8.6
@


1.123
log
@update to puppet-3.8.5
* http://docs.puppetlabs.com/puppet/3.8/reference/release_notes.html#puppet-385

ok sebastia@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.122 2016/01/07 10:39:06 sebastia Exp $
d5 1
a5 1
VERSION=	3.8.5
@


1.122
log
@Allow the pip package provider to work, at least for the
default python version.

OK jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.121 2015/11/06 13:28:10 jasper Exp $
d5 1
a5 2
VERSION=	3.8.4
REVISION =	0
@


1.121
log
@update to puppet-3.8.4
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.120 2015/09/29 08:03:07 jasper Exp $
d6 1
d8 3
d20 1
@


1.120
log
@update to puppet-3.8.3
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.119 2015/08/24 11:24:26 jasper Exp $
d5 1
a5 1
VERSION=	3.8.3
@


1.119
log
@pkg_add doesn't set a non-zero return value upon failure, so check it's output
to determine if a package cannot be installed and fail hard if that's the case
instead of stating the package was succesfully installed.

ok sebastia@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.118 2015/08/13 10:46:31 jasper Exp $
d5 1
a5 2
VERSION=	3.8.2
REVISION=	1
d10 2
a11 2
FAKE_FLAGS += HOME=${WKRDIR}/home
SUBST_VARS += MODRUBY_BINREV
@


1.118
log
@in the service provider, stop using 'rcctl getall' in favor of 'ls all' in
combination with 'get $svc flags'. this shaves several seconds off a regular
puppet run, and over 50% on 'puppet resource service'.

as discussed with aja@@
also tested by sebastia@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.117 2015/08/11 20:19:45 jasper Exp $
d6 1
a6 1
REVISION=	0
@


1.117
log
@- update to puppet-3.8.2

also tested by sebastia@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.116 2015/07/24 18:19:36 jasper Exp $
d6 1
@


1.116
log
@fix ruby 2.2 warning; spotted by sebastia@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.115 2015/07/18 15:46:11 jeremy Exp $
d5 1
a5 2
VERSION=	3.8.1
REVISION=	5
@


1.115
log
@Remove unnecessary dependency on ruby-json.

The json library is shipped with ruby 1.9+, and these ports support the
json library that comes with ruby.  While here, remove some
MODRUBY_ICONV_DEPENDS as those only are necessary on ruby 1.8.

OK jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.114 2015/07/17 18:09:55 jasper Exp $
d6 1
a6 1
REVISION=	4
@


1.114
log
@print a warning when rcctl failed; instead of having the user guess at ruby
error messages
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.113 2015/07/17 17:53:21 jasper Exp $
d6 1
a6 1
REVISION=	3
@


1.113
log
@unbreak runtime with ruby 2.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.112 2015/07/17 05:54:45 ajacoutot Exp $
d6 1
a6 1
REVISION=	2
@


1.112
log
@Missed bump after the ruby default version update.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.111 2015/07/15 14:49:02 ajacoutot Exp $
d6 1
a6 1
REVISION=	1
@


1.111
log
@No need for a trailing '$' after the recent rc.subr change.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.110 2015/06/01 06:41:00 jasper Exp $
d6 1
a6 1
REVISION=	0
@


1.110
log
@- update to puppet 3.8.1
* https://docs.puppetlabs.com/puppet/3.8/reference/release_notes.html#puppet-381

tested by/ok sebastia@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.109 2015/04/16 07:19:12 jasper Exp $
d6 1
@


1.109
log
@add PORTROACH to limit this to puppet 3
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.108 2015/04/07 17:05:57 sebastia Exp $
d5 1
a5 2
VERSION=	3.7.4
REVISION=	2
@


1.108
log
@Better handling of package flavors, treat flavors as properties instead
of a parameter to the resources. Fixes detection of installed package flavors,
and adds the flavor of a package to "puppet resource package" output.

Better handling of service_flags on service configuration, now allow to configure/set
flags before starting a service the first time. That makes services work that require
parameters to start up, and prevents services from running with wrong parameters.

OK jasper@@
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.107 2015/04/04 09:28:45 jasper Exp $
@


1.107
log
@rename rc scripts to drop the trailing 'd', so puppetd becomes just puppet.

this matches the upstream service names, as discussed with aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.106 2015/03/15 10:12:47 jasper Exp $
d4 1
a4 1
REVISION=	1
@


1.106
log
@sync rcctl patch with what's been committed upstream
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.105 2015/01/30 10:19:27 jasper Exp $
d4 1
a4 1
REVISION=	0
@


1.105
log
@update to puppet-3.7.4
https://docs.puppetlabs.com/puppet/3.7/reference/release_notes.html#puppet-374
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.104 2015/01/28 08:43:50 jasper Exp $
d4 1
@


1.104
log
@use the more standard way to execute something that may fail with execute()
and :failonfail => false

confirmed by sebastia@@ not to cause any regressions
this doesn't fix "puppet resource service" however
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.103 2015/01/18 10:28:12 ajacoutot Exp $
d3 1
a3 2
VERSION=	3.7.3
REVISION=	9
@


1.103
log
@Adapt to new rcctl(8) syntax. The provider still has a few bugs but
Jasper knows about it.

tested by sebastia@@
ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.102 2014/12/29 18:56:55 jasper Exp $
d4 1
a4 1
REVISION=	8
@


1.102
log
@sync with what's been merged upstream
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.101 2014/12/12 07:52:54 jasper Exp $
d4 1
a4 1
REVISION=	7
@


1.101
log
@sync with what's been merged upstream
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.100 2014/12/04 14:17:39 jasper Exp $
d4 1
a4 1
REVISION=	6
@


1.100
log
@use @@extraunexec instead of just removing /etc/puppet on removal

discussed with aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.99 2014/12/02 19:26:17 jasper Exp $
d4 1
a4 1
REVISION=	5
@


1.99
log
@turn :manages_loginclass into a proper feature
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.98 2014/11/25 13:19:28 jasper Exp $
d4 1
a4 1
REVISION=	4
@


1.98
log
@install config.ru, as needed for a rack webserver

prompted by sebastia@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.97 2014/11/17 12:44:20 jasper Exp $
d4 1
a4 1
REVISION=	3
@


1.97
log
@ensure we restart a service after the flags have been changed
NB: this does not yet fix the situation where a service is started before
it's flags have been written out to rc.conf.local

tested by sebastia@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.96 2014/11/12 07:42:47 jasper Exp $
d4 1
a4 1
REVISION=	2
@


1.96
log
@- add a new provider for user/group management on openbsd, so we don't have
  to add exceptions for openbsd all over the generic provider.
- unbreak account expiration while here

additional testing by sebastia@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.95 2014/11/06 20:28:16 jasper Exp $
d4 1
a4 1
REVISION=	1
@


1.95
log
@sync with what's been merged upstream
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.94 2014/11/05 08:46:40 jasper Exp $
d4 1
a4 1
REVISION=	0
@


1.94
log
@update to puppet-3.7.3
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.93 2014/11/04 19:49:12 jasper Exp $
d4 1
@


1.93
log
@refactor the code that builds up a package name to install into it's
own method
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.92 2014/11/04 09:03:58 jasper Exp $
d3 1
a3 2
VERSION=	3.7.2
REVISION=	3
@


1.92
log
@- usermod -G doesn't mean what puppet thinks it means, so use -S so actually
  set groups. this allows puppet to revoke group membership for a user.
- make 'chage' and 'password' optional commands

reminded and tested by sebastia@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.91 2014/10/30 12:21:37 jasper Exp $
d4 1
a4 1
REVISION=	2
@


1.91
log
@- add 'loginclass' property to the 'user' type to get and set the login class for a user
- bump ruby-shadow dependency

requested, tested and ok sebastia@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.90 2014/10/29 19:35:31 jasper Exp $
d4 1
a4 1
REVISION=	1
@


1.90
log
@Allow for installing a specific version if multiple are found.
This Unbreaks installing specific versions of openldap-server, php, python, etc.

initial report and patch by sebastia@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.89 2014/10/23 08:15:27 jasper Exp $
d4 1
a4 1
REVISION=	0
@


1.89
log
@- update to puppet-3.7.2
* includes fixes to disable SSLv3 and plug a memory leak in the master

https://docs.puppetlabs.com/puppet/latest/reference/release_notes.html#puppet-372
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.88 2014/10/15 10:37:24 sebastia Exp $
d4 1
@


1.88
log
@make the gem package provider default to the same version puppet is based on.
This makes the gem provider usable to install gems used by puppet modules.

OK jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.87 2014/09/27 17:08:47 jeremy Exp $
d3 1
a3 2
VERSION=	3.7.1
REVISION=	1
@


1.87
log
@Use default version of ruby instead of ruby 2.0.

OK jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.86 2014/09/24 10:07:02 espie Exp $
d4 1
a4 1
REVISION=	0
d10 1
d14 1
@


1.86
log
@same issue as ruby-facter, looks into $HOME
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.85 2014/09/23 09:21:52 sthen Exp $
d4 1
@


1.85
log
@Remove FAKE_AS_ROOT from these two ports, the failures seem to have vanished.

These are the last ports which needed to run the fake-install stage as root,
so now with the exception of pkg_add'ing dependencies (i.e. pkg_add code plus
a few programs run from @@exec hooks in PLISTs) all packages can be built as
non-root.

ok espie@@ jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.84 2014/09/16 09:07:03 espie Exp $
d7 5
@


1.84
log
@explicitly mark the few ports that don't build with FAKE_AS_ROOT=No
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.83 2014/09/16 06:46:37 jasper Exp $
a6 1
FAKE_AS_ROOT = Yes
@


1.83
log
@- update to puppet-3.7.1
* https://docs.puppetlabs.com/puppet/3.7/reference/release_notes.html#puppet-371
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.82 2014/09/07 18:16:42 jasper Exp $
d7 1
@


1.82
log
@- update to puppet-3.7.0
* https://docs.puppetlabs.com/puppet/3.7/reference/release_notes.html

testing/ok sebastia@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.81 2014/08/26 09:29:51 jasper Exp $
d3 1
a3 1
VERSION=	3.7.0
@


1.81
log
@only do a restart if the service supports it; resort to stop/start otherwise
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.80 2014/08/25 08:09:57 jasper Exp $
d3 1
a3 2
VERSION=	3.6.2
REVISION=	7
@


1.80
log
@tyop
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.79 2014/08/25 08:00:37 jasper Exp $
d4 1
a4 1
REVISION=	6
@


1.79
log
@rewrite the service provider to use rcctl, shrinking the code by about 75% percent..
..while retaining some of the puppet-intrinsic quirks where a service won't
be restarted if the flags change. that's still under investigation.

this does however now allow for valid resources that would previously fail:
service { 'multicast_host': enable => true}
or
service { 'ipsec': enable => true}
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.78 2014/08/15 13:29:10 jasper Exp $
d4 1
a4 1
REVISION=	5
@


1.78
log
@Ensure flags are written out before starting the service as it may
need to read it's flags from the filesystem.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.77 2014/07/17 07:03:51 jasper Exp $
d4 1
a4 1
REVISION=	4
@


1.77
log
@sync with rc.conf.local format changes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.76 2014/07/10 22:13:09 jasper Exp $
d4 1
a4 1
REVISION=	3
@


1.76
log
@Teach 'ensure => latest' how to deal with flavored packages. It would install
them fine, but fail on updating them.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.75 2014/07/10 14:22:49 jasper Exp $
d4 1
a4 1
REVISION=	2
@


1.75
log
@Fix an overaggresive check which is supposed to remove fuzzy matches, but
instead lost the version information and therefore puppet wouldn't realize a
package was already the latest available.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.74 2014/06/19 12:28:34 jasper Exp $
d4 1
a4 1
REVISION=	1
@


1.74
log
@sync with upstream pull request
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.73 2014/06/10 19:51:42 jasper Exp $
d4 1
a4 1
REVISION=	0
@


1.73
log
@update to puppet-3.6.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.72 2014/06/04 07:53:09 jasper Exp $
d4 1
@


1.72
log
@unbreak setups using webrick; from upstream
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.71 2014/06/04 07:48:23 jasper Exp $
d3 1
a3 2
VERSION=	3.6.1
REVISION=	1
@


1.71
log
@sync patch with what has been committed upstream
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.70 2014/05/23 06:24:46 jasper Exp $
d4 1
a4 1
REVISION=	0
@


1.70
log
@update to puppet-3.6.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.69 2014/05/20 20:00:55 jasper Exp $
d4 1
@


1.69
log
@use @@unexec-delete instead of @@extraunexec when instructing users to remove /{etc,var}/puppet/
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.68 2014/05/20 19:57:04 jasper Exp $
d3 1
a3 2
VERSION=	3.6.0
REVISION=	1
@


1.68
log
@stop mucking around with setting ownership on @@sample'd dirs in /var/puppet/;
they were wrong and puppet was correcting it, so just drop it alltogether.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.67 2014/05/15 20:17:16 jasper Exp $
d4 1
a4 1
REVISION=	0
@


1.67
log
@* update to puppet 3.6.0
- release notes at http://docs.puppetlabs.com/puppet/3.6/reference/release_notes.html
- please note that this release deprecates the use of "config file
  environments". if you haven't already done so, please switch to "directory
  environments" as explained here: http://docs.puppetlabs.com/puppet/latest/reference/environments.html
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.66 2014/05/05 12:17:17 jasper Exp $
d4 1
@


1.66
log
@Better detection of new packages
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.65 2014/05/04 12:32:26 jasper Exp $
d3 1
a3 2
VERSION=	3.5.1
REVISION=	12
@


1.65
log
@Fix typo in #get_version to unbreak matching versions
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.64 2014/04/21 22:39:26 jasper Exp $
d4 1
a4 1
REVISION=	11
@


1.64
log
@unbreak removing a package when multiple uninstall_options are passed
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.63 2014/04/21 19:12:13 jasper Exp $
d4 1
a4 1
REVISION=	10
@


1.63
log
@don't throw exceptions when a package cannot be queried for
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62 2014/04/21 17:23:19 jasper Exp $
d4 1
a4 1
REVISION=	9
@


1.62
log
@improve ensure=>latest a great deal by avoiding fuzzy matches, but do use
fuzzy matching for updating. also avoid calling #get_version and just let
pkg_add -rz do the right thing.

also unbreak flavored package installation.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.61 2014/04/19 12:13:34 jasper Exp $
d4 1
a4 1
REVISION=	8
@


1.61
log
@Use a faster way of determining if something is in base, depending on /etc/rc.conf

as discussed with aja@@ and rpe@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.60 2014/04/19 11:07:35 jasper Exp $
d4 1
a4 1
REVISION=	7
@


1.60
log
@Do not add _flags="" for pkg_scripts if no :flags were set, as it
may override the default flags from inside the script.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59 2014/04/19 10:40:56 jasper Exp $
d4 1
a4 1
REVISION=	6
@


1.59
log
@Do not unconditoinally alphabetically sort the list of pkg_scripts
as order matters. Explicit ordering will need to be forced through
resources dependencies.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2014/04/18 22:07:36 jasper Exp $
d4 1
a4 1
REVISION=	5
@


1.58
log
@merge a patch from upstream which overhauls the service provider for openbsd

this allows for proper :ensure (enable/disable) and setting flags for services.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.57 2014/04/17 18:10:28 jasper Exp $
d4 1
a4 1
REVISION=	4
@


1.57
log
@switch puppet to using ruby 2.0, it's about time..
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2014/04/17 14:15:53 jasper Exp $
d4 1
a4 1
REVISION=	3
@


1.56
log
@- remove rc_stop() hack from puppetd, the issue has long since been resolved
- fixup license tag
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55 2014/04/17 14:04:58 jasper Exp $
d4 1
a4 1
REVISION=	2
@


1.55
log
@@@sample tagmail.conf like we do with the other configuration files
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.54 2014/04/17 14:01:16 jasper Exp $
d4 1
a4 1
REVISION=	1
@


1.54
log
@remove patches that just duplicate the content...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2014/04/17 13:54:59 jasper Exp $
d4 1
a4 1
REVISION=	0
@


1.53
log
@update to puppet 3.5.1, unbreaking dynamic environments and the yumrepo type.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.52 2014/04/04 14:31:26 jasper Exp $
d4 1
@


1.52
log
@update to puppet-3.5.0, please refer to the release notes for detailed
information about the changes:
http://docs.puppetlabs.com/puppet/latest/reference/release_notes.html#puppet-350
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 2014/03/09 19:44:33 jasper Exp $
d3 1
a3 1
VERSION=	3.5.0
@


1.51
log
@update to puppet-3.4.3
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2014/01/12 09:53:37 jasper Exp $
d3 1
a3 1
VERSION=	3.4.3
@


1.50
log
@update to puppet-3.4.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2013/12/31 12:31:39 jasper Exp $
d3 1
a3 1
VERSION=	3.4.2
@


1.49
log
@Apply two patches from upstream to fix the assumed default file mode to 0644.

This got broken in 3.4.1 when it was incorrectly defaulting to 0600.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2013/12/28 19:08:06 jasper Exp $
d3 1
a3 2
VERSION=	3.4.1
REVISION=	0
@


1.48
log
@Security update of puppet to 3.4.1 which addresses CVE-2013-4969
http://puppetlabs.com/security/cve/cve-2013-4969
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2013/12/21 21:34:33 jasper Exp $
d4 1
@


1.47
log
@sprinkle some more ed25519 love
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2013/12/21 15:06:02 jasper Exp $
d3 1
a3 2
VERSION=	3.4.0
REVISION=	1
@


1.46
log
@improve error handling for :upgradeable:
- if pkg_add reports one PKG_PATH is empty, don't cry wolf but just log it.
- if a locally installed package is newer than what is available on a mirror
  log it at debug level and don't try to pkg_add the locally installed version
  (only to have it fail).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2013/12/20 14:10:41 jasper Exp $
d4 1
a4 1
REVISION=	0
@


1.45
log
@- update to puppet-3.4.0
* full changelog http://docs.puppetlabs.com/puppet/3/reference/release_notes.html#puppet-340
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2013/12/13 07:52:55 jasper Exp $
d4 1
@


1.44
log
@add ruby-shadow as a dependency; this enables support for managing user{} passwords
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2013/12/12 21:12:38 jasper Exp $
d3 1
a3 2
VERSION=	3.3.2
REVISION=	8
@


1.43
log
@committed upstream + merge in a tweak that went in along with it.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2013/12/11 20:41:13 jasper Exp $
d4 1
a4 1
REVISION=	7
@


1.42
log
@fix warning on startup of new agents about permissions on /var/puppet/lib/
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2013/12/06 21:07:03 jasper Exp $
d4 1
a4 1
REVISION=	6
@


1.41
log
@let the ssh_authorized_key type recognize the new ssh-ed25519 key type.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2013/12/04 09:23:39 jasper Exp $
d4 1
a4 1
REVISION=	5
@


1.40
log
@- fix a small buglet when handling non-flavored packages; it didn't cause
any fallout (afaics), but it did break some spec tests.
- add link to upstream pr
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2013/12/04 09:20:56 jasper Exp $
d4 1
a4 1
REVISION=	4
@


1.39
log
@sync with upstream pr; use -o update on openbsd for remounts.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2013/12/02 16:04:26 jasper Exp $
d4 1
a4 1
REVISION=	3
@


1.38
log
@let puppet run_depend on augeas; suggested by aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2013/11/26 14:57:05 jasper Exp $
d4 1
a4 1
REVISION=	2
@


1.37
log
@create /var/puppet/facts/ upon installation
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2013/11/26 09:59:02 jasper Exp $
d4 1
a4 1
REVISION=	1
@


1.36
log
@implement :upgradeable feature (ensure => latest) along with some fixes for flavor handling.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2013/11/25 15:56:23 ajacoutot Exp $
d4 1
a4 1
REVISION=	0
@


1.35
log
@- update to puppet-3.3.2
@
text
@d4 1
@


1.34
log
@(#22129) force explicit file content to be treated as a bytestring.

ok jasper@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2013/11/13 14:32:18 jasper Exp $
d3 1
a3 2
VERSION=	3.3.1
REVISION=	4
@


1.33
log
@Our mount doesn't support '-o remount', so don't set the 'remounts' parameter
to true by default for us.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2013/11/12 08:28:29 robert Exp $
d4 1
a4 1
REVISION=	3
@


1.32
log
@use a better regexp for the puppetd process to avoid killing every puppetd process; ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2013/11/09 20:24:12 jasper Exp $
d4 1
a4 1
REVISION=	2
@


1.31
log
@sync gtar patch with what's been pushed upstream
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2013/10/12 09:06:17 jasper Exp $
d4 1
a4 1
REVISION=	1
@


1.30
log
@Tag along with Solaris on using gtar, instead of modifying the gnu tar code.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2013/10/12 08:55:14 jasper Exp $
d4 1
a4 1
REVISION=	0
@


1.29
log
@update to puppet-3.3.1
* note that it will complain if you're running against an older master
  (see http://links.puppetlabs.com/deprecate_yaml_on_network), but it will
  continue it's run.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2013/10/04 09:13:29 jasper Exp $
d4 1
d6 2
a7 1
RUN_DEPENDS+=	devel/ruby-rgen,${MODRUBY_FLAVOR}
@


1.28
log
@remove two options our tar(1) doesn't understand; unbreaks 'puppet module install'
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2013/09/17 18:45:30 jasper Exp $
d3 1
a3 2
VERSION=	3.3.0
REVISION=	3
@


1.27
log
@sync with upstream/master now that it's been merged
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2013/09/17 09:00:57 jasper Exp $
d4 1
a4 1
REVISION=	2
@


1.26
log
@add missing spec tests for the openbsd service provider
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2013/09/15 19:32:47 jasper Exp $
d4 1
a4 1
REVISION=	1
@


1.25
log
@backport a patch from git master which fixes an issue with agents < 3.3.0
that used a 3.3.0 master and couldn't submit their reports.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2013/09/13 07:20:29 jasper Exp $
d4 1
a4 1
REVISION=	0
@


1.24
log
@- update to puppet-3.3.0
* all openbsd package provider features were merged upstream
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2013/08/15 21:31:07 jasper Exp $
d4 1
@


1.23
log
@update to puppet-3.2.4
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2013/08/14 07:48:05 jasper Exp $
d3 1
a3 1
VERSION=	3.2.4
@


1.22
log
@implement (un)install_options for the openbsd package provider.

this allows to pass options directly to pkg_add/pkg_delete when needed.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2013/08/07 08:20:08 jasper Exp $
d3 1
a3 2
VERSION=	3.2.3
REVISION=	4
@


1.21
log
@take maintainership

ok robert@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2013/08/07 07:19:30 jasper Exp $
d4 1
a4 1
REVISION=	3
@


1.20
log
@fix retrieving the flavor for packages in #instances

ok robert@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2013/08/06 18:21:27 jasper Exp $
d4 1
a4 1
REVISION=	2
@


1.19
log
@implement 'purgeable' feature for the OpenBSD package provider

ok robert@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2013/08/06 18:17:36 jasper Exp $
d4 1
a4 1
REVISION=	1
@


1.18
log
@add a patch to improve pkg.conf handling in puppet; it can now deal with
appending to installpath with '+='.

ok robert@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2013/07/17 14:18:37 jasper Exp $
d4 1
a4 1
REVISION=	0
@


1.17
log
@update to puppet-3.2.3

ok robert@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2013/07/09 07:03:29 jasper Exp $
d4 1
@


1.17.2.1
log
@update puppet to 3.3.2

this allows OpenBSD 5.4 agents to work correctly again with a puppet master
unning -current. puppet 3.3 has a new reporting format as well as support
for ensure => latest for packages. now one can use the same manifest for
5.4 and -current again.

note: libshadow was not imported into 5.4 so managing user passwords won't
work on 5.4 still.

discussed with sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2013/12/13 07:52:55 jasper Exp $
d3 1
a3 1
VERSION=	3.3.2
d5 1
a5 2
RUN_DEPENDS+=	archivers/gtar \
		devel/ruby-rgen,${MODRUBY_FLAVOR}
@


1.16
log
@drop the ruby- prefix from these package names since they mainly provide an
application, not a library.

discussed with jeremy@@ aja@@ robert@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2013/06/19 07:36:03 jasper Exp $
d3 1
a3 2
VERSION=	3.2.2
REVISION=	0
@


1.15
log
@Security update of puppet to 3.2.2, which addresses CVE-2013-3567
(Unauthenticated Remote Code Execution Vulnerability).

http://puppetlabs.com/security/cve/cve-2013-3567/

ok robert@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2013/06/12 14:02:53 jasper Exp $
d4 1
@


1.14
log
@create hieradata dir now that puppet depends hiera. req'd by aja@@

ok robert@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2013/06/11 14:56:14 jasper Exp $
d3 1
a3 2
VERSION=	3.2.1
REVISION=	2
@


1.13
log
@switch to ruby 1.9 which brings significant speed ups over 1.8.
there is one thing to be aware of, which is that ruby 1.9 uses a stricter
yaml parser, so be sure your hier yaml files are OK before attempting to
update or your agents will fail.

ok robert@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2013/06/11 13:37:14 jasper Exp $
d4 1
a4 1
REVISION=	1
@


1.12
log
@hiera is required by puppet3

ok robert@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2013/06/10 14:46:34 jasper Exp $
d4 1
a4 1
REVISION=	0
@


1.11
log
@update to ruby-puppet-3.2.1

Please refer to http://docs.puppetlabs.com/puppet/3/reference/release_notes.html#puppet-321
for the release notes.

ok robert@@ (MAINTAINER) ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2013/04/16 13:25:52 jasper Exp $
d4 1
@


1.10
log
@adjust the uid puppet looks at to determine if a user is a "system user" to 1000.
this then gets used to purge all non-system users, whether this is a good idea is
left as an exercise to the user.

ok aja@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2013/03/20 06:55:20 ajacoutot Exp $
d3 3
a5 2
VERSION=	3.1.1
REVISION=	5
@


1.9
log
@PKG_ARCH=*
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2013/03/18 15:07:56 ajacoutot Exp $
d4 1
a4 1
REVISION=	4
@


1.8
log
@Add a README to introduce integration with MCollective and ActiveMQ.

ok robert@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2013/03/15 14:57:25 ajacoutot Exp $
d4 1
a4 1
REVISION=	3
@


1.7
log
@Tweak on comment.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2013/03/13 14:35:39 ajacoutot Exp $
d4 1
a4 1
REVISION=	2
@


1.6
log
@Factorize a bit more since both ports version share a lot.
While here, fix the rc script to start the master instead of the client
and vice-versa.

ok robert@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2013/03/13 09:56:19 ajacoutot Exp $
d4 1
a4 1
REVISION=	1
@


1.5
log
@Do not hardcode paths in the rc scripts.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2013/03/12 18:53:49 robert Exp $
d4 1
a4 1
REVISION=	0
@


1.4
log
@security update to 3.1.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2013/03/08 16:19:15 ajacoutot Exp $
d4 1
@


1.3
log
@Start services with '-f' since they may not be enabled in rc.conf.local(5).
Implement a restart command for the service provider and use '-f' as well.
No need to specify a 'stop' common, our rc.d(8) is generic enough.

ok robert@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2013/03/08 16:15:33 ajacoutot Exp $
d3 1
a3 2
VERSION=	3.1.0
REVISION=	3
@


1.2
log
@Remove the ldap patches which aren't needed anymore.

ok robert@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1 2013/03/08 16:12:47 ajacoutot Exp $
d4 1
a4 1
REVISION=	2
@


1.1
log
@Split ruby-puppet:
* move the current port to ruby-puppet/3
* add a new puppet-2.7.X port under ruby-puppet/2

This allows us to ship with 2 different versions of Puppet. Since the
Enterprise version is still running 2.7, we want to have a matching
client because running puppet3 against a puppet2 server is highly
discouraged and will mostly no work correctly.

ok jasper@@, robert@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2013/03/08 10:45:45 ajacoutot Exp $
d4 1
a4 1
REVISION=	1
@

