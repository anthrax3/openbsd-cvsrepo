head	1.6;
access;
symbols
	OPENBSD_5_5:1.4.0.4
	OPENBSD_5_5_BASE:1.4
	OPENBSD_5_4:1.4.0.2
	OPENBSD_5_4_BASE:1.4
	OPENBSD_5_3:1.2.0.6
	OPENBSD_5_3_BASE:1.2
	OPENBSD_5_2:1.2.0.4
	OPENBSD_5_2_BASE:1.2
	OPENBSD_5_1_BASE:1.2
	OPENBSD_5_1:1.2.0.2;
locks; strict;
comment	@# @;


1.6
date	2014.05.21.11.22.22;	author jasper;	state dead;
branches;
next	1.5;

1.5
date	2014.05.19.10.22.30;	author jasper;	state Exp;
branches;
next	1.4;

1.4
date	2013.03.13.22.54.26;	author ajacoutot;	state Exp;
branches;
next	1.3;

1.3
date	2013.03.13.13.33.51;	author jasper;	state Exp;
branches;
next	1.2;

1.2
date	2011.12.21.19.34.28;	author jasper;	state Exp;
branches;
next	1.1;

1.1
date	2011.09.20.14.03.20;	author uwe;	state Exp;
branches;
next	;


desc
@@


1.6
log
@stop patching the deprecated Makefile and just use install.rb
@
text
@$OpenBSD: patch-ext_Makefile,v 1.5 2014/05/19 10:22:30 jasper Exp $
--- ext/Makefile.orig	Wed May 14 17:16:33 2014
+++ ext/Makefile	Mon May 19 23:20:41 2014
@@@@ -1,7 +1,5 @@@@
 #!/usr/bin/make -f
 
-DESTDIR=
-
 build:
 
 clean:
@@@@ -9,31 +7,29 @@@@ clean:
 install: install-bin install-lib install-conf install-plugins install-doc
 
 install-bin:
-	install -d $(DESTDIR)/usr/sbin
-	install -d $(DESTDIR)/usr/bin
-	cp bin/mc-* $(DESTDIR)/usr/sbin
-	cp bin/mco $(DESTDIR)/usr/bin
-	cp bin/mcollectived $(DESTDIR)/usr/sbin/mcollectived
+	${BSD_INSTALL_SCRIPT} bin/mco $(PREFIX)/bin
+	${BSD_INSTALL_SCRIPT} bin/mcollectived $(PREFIX)/sbin/mcollectived
 
 install-lib:
-	install -d $(DESTDIR)/usr/lib/ruby/1.8/
-	cp -a lib/* $(DESTDIR)/usr/lib/ruby/1.8/
+	${BSD_INSTALL_DATA_DIR} $(PREFIX)/${MODRUBY_SITEDIR}/
+	cp -Rp lib/* $(PREFIX)/${MODRUBY_SITEDIR}/
 
 install-conf:
-	install -d $(DESTDIR)/etc/mcollective/
-	install -d $(DESTDIR)/etc/init.d
-	cp -r etc/* $(DESTDIR)/etc/mcollective/
-	cp mcollective.init $(DESTDIR)/etc/init.d/mcollective
-	rm $(DESTDIR)/etc/mcollective/ssl/PLACEHOLDER
-	rm $(DESTDIR)/etc/mcollective/ssl/clients/PLACEHOLDER
+	${BSD_INSTALL_DATA_DIR} $(PREFIX)/share/examples/mcollective/
+	${BSD_INSTALL_DATA_DIR} $(PREFIX)/share/examples/mcollective/plugin.d
+	${BSD_INSTALL_DATA_DIR} $(PREFIX)/share/examples/mcollective/ssl/clients
+	${BSD_INSTALL_DATA} etc/client.cfg.dist $(PREFIX)/share/examples/mcollective/client.cfg
+	${BSD_INSTALL_DATA} etc/server.cfg.dist $(PREFIX)/share/examples/mcollective/server.cfg
+	${BSD_INSTALL_DATA} etc/facts.yaml.dist $(PREFIX)/share/examples/mcollective/facts.yaml
+	${BSD_INSTALL_DATA} etc/rpc-help.erb $(PREFIX)/share/examples/mcollective
 
 install-plugins:
-	install -d $(DESTDIR)/usr/share/mcollective/
-	cp -a plugins $(DESTDIR)/usr/share/mcollective/
+	${BSD_INSTALL_DATA_DIR} $(PREFIX)/libexec/mcollective/
+	cp -Rp plugins/* $(PREFIX)/libexec/mcollective/
 
 install-doc:
-	install -d $(DESTDIR)/usr/share/doc/
-	cp -a doc  $(DESTDIR)/usr/share/doc/mcollective
+	${BSD_INSTALL_DATA_DIR} $(PREFIX)/share/doc/
+	cp -Rp doc $(PREFIX)/share/doc/mcollective
 
 uninstall:
 	rm -f $(DESTDIR)/usr/sbin/mcollectived
@


1.5
log
@update to mcollective-2.5.1
@
text
@d1 1
a1 1
$OpenBSD: patch-ext_Makefile,v 1.4 2013/03/13 22:54:26 ajacoutot Exp $
@


1.4
log
@Use bundled modules since they are certified to work with that particular
version of mcollective.
Force ruby 1.8; version 1.9 is not functionnal yet.
Simplify patching the config files by using a regex.
Use BSD_INSTALL_*
Use $RUBY in the rc script.
Take maintainer.

More work to come, so still not hooked to the build.
@
text
@d1 3
a3 3
$OpenBSD: patch-ext_Makefile,v 1.3 2013/03/13 13:33:51 jasper Exp $
--- ext/Makefile.orig	Thu Jan 10 18:43:11 2013
+++ ext/Makefile	Wed Mar 13 14:46:36 2013
d12 1
a12 1
@@@@ -9,31 +7,30 @@@@ clean:
a20 1
+	${BSD_INSTALL_SCRIPT} bin/mc-* $(PREFIX)/sbin
@


1.3
log
@- update to mcollective-2.3.0
@
text
@d1 1
a1 1
$OpenBSD: patch-ext_Makefile,v 1.2 2011/12/21 19:34:28 jasper Exp $
d3 1
a3 1
+++ ext/Makefile	Wed Feb  6 20:21:20 2013
d12 1
a12 1
@@@@ -9,36 +7,35 @@@@ clean:
d21 3
a23 3
+	cp bin/mc-* $(PREFIX)/sbin
+	cp bin/mco $(PREFIX)/bin
+	cp bin/mcollectived $(PREFIX)/sbin/mcollectived
d28 2
a29 2
+	install -d $(PREFIX)/lib/ruby/1.8/
+	cp -R lib/* $(PREFIX)/lib/ruby/1.8/
d38 7
a44 7
+	install -d $(PREFIX)/share/examples/mcollective/
+	install -d $(PREFIX)/share/examples/mcollective/plugin.d
+	install -d $(PREFIX)/share/examples/mcollective/ssl/clients
+	cp etc/client.cfg.dist $(PREFIX)/share/examples/mcollective/client.cfg
+	cp etc/server.cfg.dist $(PREFIX)/share/examples/mcollective/server.cfg
+	cp etc/facts.yaml.dist $(PREFIX)/share/examples/mcollective/facts.yaml
+	cp etc/rpc-help.erb $(PREFIX)/share/examples/mcollective
d49 2
a50 2
+	install -d $(PREFIX)/share/mcollective/
+	cp -R plugins $(PREFIX)/share/mcollective/
d55 2
a56 2
+	install -d $(PREFIX)/share/doc/
+	cp -R doc  $(PREFIX)/share/doc/mcollective
d59 1
a59 10
-	rm -f $(DESTDIR)/usr/sbin/mcollectived
-	rm -rf $(DESTDIR)/usr/lib/ruby/1.8/mcollective*
-	rm -rf $(DESTDIR)/usr/share/mcollective
-	rm -rf $(DESTDIR)/etc/mcollective
+	rm -f $(PREFIX)/usr/sbin/mcollectived
+	rm -rf $(PREFIX)/usr/lib/ruby/1.8/mcollective*
+	rm -rf $(PREFIX)/usr/share/mcollective
+	rm -rf $(PREFIX)/etc/mcollective
 
 .PHONY: build clean install uninstall
@


1.2
log
@* Add dependencies on the ruby-json and new ruby-systemu ports
* Remove the bundled json and systemu gems
* Also patch the client.cfg.dist file in the same way as server.cfg.dist
* Remove the cleanup of the subst_cmd bits due to...
* Altering the example files to be installed sans .dist suffix
* Adjust the PLIST to not include the now-removed gems, install the
  renamed example files with @@sample amd also install the rc.d script

merged by Matt Dainty from his mcollective port
@
text
@d1 3
a3 3
$OpenBSD: patch-ext_Makefile,v 1.1 2011/09/20 14:03:20 uwe Exp $
--- ext/Makefile.orig	Wed Jun  8 19:57:44 2011
+++ ext/Makefile	Fri Dec 16 09:32:27 2011
d12 1
a12 1
@@@@ -9,36 +7,37 @@@@ clean:
d18 6
a23 8
-	cp mc-* $(DESTDIR)/usr/sbin
-	cp mco $(DESTDIR)/usr/bin
-	cp mcollectived.rb $(DESTDIR)/usr/sbin/mcollectived
+	install -d $(PREFIX)/sbin
+	install -d $(PREFIX)/bin
+	cp mc-* $(PREFIX)/sbin
+	cp mco $(PREFIX)/bin
+	cp mcollectived.rb $(PREFIX)/sbin/mcollectived
d63 3
a65 3
+	rm -f $(PREFIX)/sbin/mcollectived
+	rm -rf $(PREFIX)/lib/ruby/1.8/mcollective*
+	rm -rf $(PREFIX)/share/mcollective
@


1.1
log
@Import ruby-mcollective-1.3.0

This port is based on the port source that is currently bundled with
MCollective but which has not been updated for ages.

Homepage: http://puppetlabs.com/mcollective/
Source: https://github.com/puppetlabs/marionette-collective
@
text
@d1 3
a3 3
$OpenBSD$
--- ext/Makefile.orig	Wed Jun  8 20:57:44 2011
+++ ext/Makefile	Mon Sep 12 01:24:45 2011
d12 1
a12 1
@@@@ -9,36 +7,34 @@@@ clean:
d41 6
a46 3
+	cp -R etc/* $(PREFIX)/share/examples/mcollective/
+	rm $(PREFIX)/share/examples/mcollective/ssl/PLACEHOLDER
+	rm $(PREFIX)/share/examples/mcollective/ssl/clients/PLACEHOLDER
@

