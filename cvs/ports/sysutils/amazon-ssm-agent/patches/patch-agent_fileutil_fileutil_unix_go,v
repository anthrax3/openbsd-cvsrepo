head	1.2;
access;
symbols
	OPENBSD_6_2:1.2.0.2
	OPENBSD_6_2_BASE:1.2
	OPENBSD_6_1:1.1.1.1.0.2
	OPENBSD_6_1_BASE:1.1.1.1
	ajacoutot_20170401:1.1.1.1
	ajacoutot:1.1.1;
locks; strict;
comment	@# @;


1.2
date	2017.05.28.09.25.31;	author ajacoutot;	state Exp;
branches;
next	1.1;
commitid	NdFDEvrbVnfF5wxN;

1.1
date	2017.01.04.09.05.40;	author ajacoutot;	state Exp;
branches
	1.1.1.1;
next	;
commitid	QlwnakFWKe9FcBri;

1.1.1.1
date	2017.01.04.09.05.40;	author ajacoutot;	state Exp;
branches;
next	;
commitid	QlwnakFWKe9FcBri;


desc
@@


1.2
log
@Update to amazon-ssm-agent-2.0.790.0.
@
text
@$OpenBSD: patch-agent_fileutil_fileutil_unix_go,v 1.1.1.1 2017/01/04 09:05:40 ajacoutot Exp $
--- agent/fileutil/fileutil_unix.go.orig	Mon Feb 13 21:42:41 2017
+++ agent/fileutil/fileutil_unix.go	Fri Feb 24 09:49:58 2017
@@@@ -86,14 +86,14 @@@@ func GetDiskSpaceInfo() (diskSpaceInfo DiskSpaceInfo, 
 	syscall.Statfs(wd, &stat)
 
 	// get block size
-	bSize := uint64(stat.Bsize)
+	bSize := uint64(stat.F_bsize)
 
 	// return DiskSpaceInfo with calculated bytes
 	return DiskSpaceInfo{
 		// On Linux the struct statfs.f_bavail field is unsigned, but on FreeBSD the field is an int64
-		AvailBytes: (int64)((uint64)(stat.Bavail) * bSize), // available space = # of available blocks * block size
-		FreeBytes:  (int64)(stat.Bfree * bSize),            // free space = # of free blocks * block size
-		TotalBytes: (int64)(stat.Blocks * bSize),           // total space = # of total blocks * block size
+		AvailBytes: (int64)((uint64)(stat.F_bavail) * bSize), // available space = # of available blocks * block size
+		FreeBytes:  (int64)(stat.F_bfree * bSize),            // free space = # of free blocks * block size
+		TotalBytes: (int64)(stat.F_blocks * bSize),           // total space = # of total blocks * block size
 	}, nil
 }
 
@


1.1
log
@Initial revision
@
text
@d1 4
a4 4
$OpenBSD$
--- agent/fileutil/fileutil_unix.go.orig	Tue Jan  3 10:22:57 2017
+++ agent/fileutil/fileutil_unix.go	Tue Jan  3 10:23:50 2017
@@@@ -81,13 +81,13 @@@@ func GetDiskSpaceInfo() (diskSpaceInfo DiskSpaceInfo, 
d13 4
a16 3
-		AvailBytes: (int64)(stat.Bavail * bSize), // available space = # of available blocks * block size
-		FreeBytes:  (int64)(stat.Bfree * bSize),  // free space = # of free blocks * block size
-		TotalBytes: (int64)(stat.Blocks * bSize), // total space = # of total blocks * block size
d18 2
a19 2
+		FreeBytes:  (int64)(stat.F_bfree * bSize),  // free space = # of free blocks * block size
+		TotalBytes: (int64)(stat.F_blocks * bSize), // total space = # of total blocks * block size
@


1.1.1.1
log
@Import amazon-ssm-agent-1.2.290.0.

The Amazon EC2 Simple Systems Manager (SSM) Agent is software developed for the
Simple Systems Manager Service. The SSM Agent is the primary component of a
feature called Run Command.
<...>

ok robert@@
@
text
@@
