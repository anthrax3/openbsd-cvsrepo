head	1.8;
access;
symbols
	OPENBSD_3_6:1.6.0.4
	OPENBSD_3_6_BASE:1.6
	OPENBSD_3_5:1.6.0.2
	OPENBSD_3_5_BASE:1.6
	OPENBSD_3_4:1.5.0.2
	OPENBSD_3_4_BASE:1.5
	OPENBSD_3_3:1.4.0.2
	OPENBSD_3_3_BASE:1.4
	OPENBSD_3_2:1.2.0.2
	OPENBSD_3_2_BASE:1.2
	OPENBSD_3_1:1.1.1.1.0.6
	OPENBSD_3_1_BASE:1.1.1.1
	OPENBSD_3_0:1.1.1.1.0.4
	OPENBSD_3_0_BASE:1.1.1.1
	OPENBSD_2_9_TRACKING_SWITCH:1.1.1.1
	OPENBSD_2_9:1.1.1.1.0.2
	OPENBSD_2_9_BASE:1.1.1.1
	nate_2001-Feb-06:1.1.1.1
	nate:1.1.1;
locks; strict;
comment	@# @;


1.8
date	2004.10.03.03.13.10;	author marcm;	state dead;
branches;
next	1.7;

1.7
date	2004.09.27.03.10.24;	author marcm;	state Exp;
branches;
next	1.6;

1.6
date	2004.02.09.06.48.48;	author marcm;	state Exp;
branches;
next	1.5;

1.5
date	2003.03.30.16.19.25;	author marcm;	state Exp;
branches;
next	1.4;

1.4
date	2003.02.26.15.13.04;	author david;	state Exp;
branches;
next	1.3;

1.3
date	2002.10.14.16.14.33;	author marcm;	state Exp;
branches;
next	1.2;

1.2
date	2002.04.26.03.35.34;	author pvalchev;	state Exp;
branches;
next	1.1;

1.1
date	2001.02.06.22.24.03;	author nate;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2001.02.06.22.24.03;	author nate;	state Exp;
branches;
next	;


desc
@@


1.8
log
@More PLIST updates... clean up the Makefile a bit and add an optional
-snmp SUBPACKAGE.

Also, remove myself as MAINTAINER.  Not that I won't continue to support
it, just that my shinny new(?) SNMP card for my UPS makes this port
not one I'll use everyday anymore.

See what happens when people give me free stuff :).
@
text
@#!/bin/sh
#
# $OpenBSD: INSTALL,v 1.7 2004/09/27 03:10:24 marcm Exp $

set -e
PREFIX=${PKG_PREFIX:-/usr/local}
PATH=/bin:/usr/bin:/sbin:/usr/sbin

do_create_user() {
	if id -u ${NUT_USER} >/dev/null 2>/dev/null
	then
		echo "===>  Using existing account '${NUT_USER}'"
	else
		echo "===>  Creating user '${NUT_USER}'"
		useradd -g dialer \
			-c "UPS User" \
			-d /var/empty \
			-s /sbin/nologin \
			-u ${NUT_ID} ${NUT_USER}
	fi
}


# verify proper execution
#
if [ $# -ne 2 ]; then
	echo "usage: $0 distname { PRE-INSTALL | POST-INSTALL }" >&2
	exit 1
fi

# Verify/process the command
#
case $2 in
	PRE-INSTALL)
		do_create_user
		;;
	POST-INSTALL)
		;;
	*)
		echo "usage: $0 distname { PRE-INSTALL | POST-INSTALL }" >&2
		exit 1
		;;
esac

exit 0
@


1.7
log
@Update to the 2.0 tree of Nut.

This is a feature release so if you're upgrading, take a look at the
release notes here:

http://random.networkupstools.org/source/2.0/new-2.0.0.txt
@
text
@d3 1
a3 1
# $OpenBSD: INSTALL,v 1.6 2004/02/09 06:48:48 marcm Exp $
@


1.6
log
@Update to 1.4.1.

In addition to the standard bugfixes, this is a major port rewrite.
The port now uses a '_ups' user and the CGIs created can now run under
either chrooted Apache or non-chrooted Apache.
@
text
@d3 1
a3 18
# $OpenBSD: INSTALL,v 1.5 2003/03/30 16:19:25 marcm Exp $

P_NAME=nut

DIRS='
.
'

FILES='
ups.conf
upssched.conf
'

PRIVATE_FILES='
upsmon.conf
upsd.conf
upsd.users
'
a22 74
do_post() {
	DEST_PFX=${CONFDIR}
	SOURCE_PFX=${PREFIX}/share/examples/${P_NAME}

	echo 
	echo "+--------------- ${P_NAME}"

	# install dirs if necessary
	for d in ${DIRS}; do
		if [ ! -d "${DEST_PFX}/$d" ]; then
			install -d ${DEST_PFX}/$d
		fi
	done
	if [ ! -d "${NUT_STATEDIR}" ]; then
		install -d -m 0700 -o ${NUT_USER} ${NUT_STATEDIR}
	fi


	# install or take note of existing config files
	for f in ${FILES}; do
		if [ -f "${DEST_PFX}/$f" ]; then
			OLD_CONFS="${OLD_CONFS} $f"
		else
			if ! install -m 644 ${SOURCE_PFX}/$f.sample ${DEST_PFX}/$f; then
				echo "| ERROR: The following file could not be installed, exiting: ${DEST_PFX}/$f"
				exit 1
			fi
			NEW_CONFS="${NEW_CONFS} $f"
		fi
	done

	# install or take note of existing config files (yes again)
	for f in ${PRIVATE_FILES}; do
		if [ -f "${DEST_PFX}/$f" ]; then
			OLD_CONFS="${OLD_CONFS} $f"
		else
			if ! install -m 600 ${SOURCE_PFX}/$f.sample ${DEST_PFX}/$f; then
				echo "| ERROR: The following file could not be installed, exiting: ${DEST_PFX}/$f"
				exit 1
			fi
			NEW_CONFS="${NEW_CONFS} $f"
		fi
	done

	# print status report
	if [ -n "${NEW_CONFS}" ]; then
		echo "| The following NEW configuration files have been installed:"
		echo "|"
		for f in ${NEW_CONFS}; do
			echo "| ${DEST_PFX}/$f"
		done 
	fi
	
	if [ -n "${OLD_CONFS}" ]; then
		if [ -n "${NEW_CONFS}" ]; then
			echo "|"
		fi
		echo "| The following OLD configuration files were found and have NOT been"
		echo "| overwritten:"
		echo "|"
		for f in ${OLD_CONFS}; do
			echo "| ${DEST_PFX}/$f"
		done
		echo "|"
		echo "| You should however manually compare them to their equivalents in"
		echo "|"
		echo "| ${SOURCE_PFX}"
		echo "|"
		echo "| and update your configuration as needed." 
	fi
	echo "+--------------- ${P_NAME}"
	echo 
}

a37 1
		do_post
@


1.5
log
@Handle SYSCONFDIR properly and make this compile on vax (and probably the
other NO_SHARED_ARCHS as well).
@
text
@d3 1
a3 1
# $OpenBSD: INSTALL,v 1.4 2003/02/26 15:13:04 david Exp $
d8 1
a8 1
nut
d12 2
a13 2
nut/ups.conf
nut/upssched.conf
d17 3
a19 3
nut/upsmon.conf
nut/upsd.conf
nut/upsd.users
d26 14
d41 2
a42 3

	DEST_PFX=${SYSCONFDIR}
	SOURCE_PFX=${PREFIX}/share/examples
d53 4
d126 1
@


1.4
log
@necessary is spelled necessary.
similar is spelled similar.
functionality is spelled functionality.
ok brad@@ jmc@@
@
text
@d3 1
a3 1
# $OpenBSD: INSTALL,v 1.3 2002/10/14 16:14:33 marcm Exp $
d8 1
a8 1
.
d12 2
a13 2
ups.conf
upssched.conf
d17 3
a19 3
upsmon.conf
upsd.conf
upsd.users
d29 1
a29 1
	SOURCE_PFX=${PREFIX}/share/examples/${P_NAME}
@


1.3
log
@* Update to 1.0.0

* CGIs are now a SUBPACKAGE and work with chrooted Apache

* Make myself MAINTAINER

* Mark conflict with upad-2.0

ok naddy@@ and nate@@
@
text
@d3 1
a3 1
# $OpenBSD$
d34 1
a34 1
	# install dirs if neccessary
@


1.2
log
@End sentence with a period.  (some people copied/pasted too much)
@
text
@a1 1
# $OpenBSD: INSTALL,v 1.1.1.1 2001/02/06 22:24:03 nate Exp $
d3 18
a20 1
# Pre/post-installation setup of nut
a21 2
# exit on errors, use a sane path and install prefix
#
d23 1
a24 5
PREFIX=${PKG_PREFIX:-/usr/local}
CONFIG_DIR=${SYSCONFDIR}/nut
CONFIG_FILES="hosts.conf multimon.conf"
PRIVATE_FILES="upsd.conf upsmon.conf upsset.passwd"
SAMPLE_DIR=$PREFIX/share/examples/nut
d26 4
a29 19
# Function: tell the user what s/he needs to do to use the port just installed
#
do_notice()
{
    echo
    echo "+---------------"
    echo "| The existing $1 configuration files in ${CONFIG_DIR},"
    echo "| have NOT been changed.  You may want to compare them to the"
    echo "| current sample files in ${SAMPLE_DIR}"
    echo "| and update your configuration as needed."
    echo "|"
    echo "| Also see $PREFIX/share/doc/nut/README.OpenBSD"
    echo "| for startup configuration."
    echo "|"
    echo "| If you have built nut with CGIs, they can be found in:"
    echo "| $PREFIX/libexec/nut"
    echo "+---------------"
    echo
}
d31 2
a32 24
# Function: install the nut configuration files from the samples
#
do_install()
{
    install -d -o root -g wheel -m 755 ${CONFIG_DIR}
    for each in ${CONFIG_FILES}; do
	install -o root -g wheel -m 644 ${SAMPLE_DIR}/$each.sample ${CONFIG_DIR}/$each
    done
    for each in ${PRIVATE_FILES}; do
	install -o root -g wheel -m 600 ${SAMPLE_DIR}/$each.sample ${CONFIG_DIR}/$each
    done
    echo
    echo "+---------------"
    echo "| The $1 configuration files in ${CONFIG_DIR},"
    echo "| have been installed.  Please view these files and change"
    echo "|"
    echo "| Also see $PREFIX/share/doc/nut/README.OpenBSD"
    echo "| for startup configuration."
    echo "| the configuration to meet your needs before running the daemons."
    echo "|"
    echo "| If you have built nut with CGIs, they can be found in:"
    echo "| $PREFIX/libexec/nut"
    echo "+---------------"
    echo
d34 61
d97 1
d101 2
a102 2
    echo "usage: $0 distname { PRE-INSTALL | POST-INSTALL }" >&2
    exit 1
d108 9
a116 14
    PRE-INSTALL)
	: nothing to pre-install for this port
	;;
    POST-INSTALL)
	if [ -d $CONFIG_DIR ]; then
	    do_notice $1
	else
	    do_install $1
	fi
	;;
    *)
	echo "usage: $0 distname { PRE-INSTALL | POST-INSTALL }" >&2
	exit 1
	;;
@


1.1
log
@Initial revision
@
text
@d2 1
a2 1
# $OpenBSD$
d54 1
a54 1
    echo "| the configuration to meet your needs before running the daemons"
@


1.1.1.1
log
@Network UPS Tools.  http://www.exploits.org/nut/
@
text
@@
