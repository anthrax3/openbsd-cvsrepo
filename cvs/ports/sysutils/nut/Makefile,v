head	1.94;
access;
symbols
	OPENBSD_6_1:1.91.0.2
	OPENBSD_6_1_BASE:1.91
	OPENBSD_6_0:1.90.0.2
	OPENBSD_6_0_BASE:1.90
	OPENBSD_5_9:1.89.0.2
	OPENBSD_5_9_BASE:1.89
	OPENBSD_5_8:1.88.0.4
	OPENBSD_5_8_BASE:1.88
	OPENBSD_5_7:1.83.0.2
	OPENBSD_5_7_BASE:1.83
	OPENBSD_5_6:1.81.0.2
	OPENBSD_5_6_BASE:1.81
	OPENBSD_5_5:1.74.0.2
	OPENBSD_5_5_BASE:1.74
	OPENBSD_5_4:1.73.0.2
	OPENBSD_5_4_BASE:1.73
	OPENBSD_5_3:1.68.0.2
	OPENBSD_5_3_BASE:1.68
	OPENBSD_5_2:1.62.0.2
	OPENBSD_5_2_BASE:1.62
	OPENBSD_5_1_BASE:1.59
	OPENBSD_5_1:1.59.0.2
	OPENBSD_5_0:1.47.0.2
	OPENBSD_5_0_BASE:1.47
	OPENBSD_4_9:1.42.0.2
	OPENBSD_4_9_BASE:1.42
	OPENBSD_4_8:1.38.0.2
	OPENBSD_4_8_BASE:1.38
	OPENBSD_4_7:1.34.0.2
	OPENBSD_4_7_BASE:1.34
	OPENBSD_4_6:1.31.0.2
	OPENBSD_4_6_BASE:1.31
	OPENBSD_4_5:1.30.0.2
	OPENBSD_4_5_BASE:1.30
	OPENBSD_4_4:1.26.0.4
	OPENBSD_4_4_BASE:1.26
	OPENBSD_4_3:1.26.0.2
	OPENBSD_4_3_BASE:1.26
	OPENBSD_4_2:1.22.0.2
	OPENBSD_4_2_BASE:1.22
	OPENBSD_4_1:1.21.0.2
	OPENBSD_4_1_BASE:1.21
	OPENBSD_4_0:1.20.0.2
	OPENBSD_4_0_BASE:1.20
	OPENBSD_3_9:1.18.0.2
	OPENBSD_3_9_BASE:1.18
	OPENBSD_3_8:1.16.0.2
	OPENBSD_3_8_BASE:1.16
	OPENBSD_3_7:1.15.0.2
	OPENBSD_3_7_BASE:1.15
	OPENBSD_3_6:1.12.0.4
	OPENBSD_3_6_BASE:1.12
	OPENBSD_3_5:1.12.0.2
	OPENBSD_3_5_BASE:1.12
	OPENBSD_3_4:1.10.0.2
	OPENBSD_3_4_BASE:1.10
	OPENBSD_3_3:1.9.0.2
	OPENBSD_3_3_BASE:1.9
	OPENBSD_3_2:1.6.0.4
	OPENBSD_3_2_BASE:1.6
	OPENBSD_3_1:1.6.0.2
	OPENBSD_3_1_BASE:1.6
	OPENBSD_3_0:1.3.0.2
	OPENBSD_3_0_BASE:1.3
	OPENBSD_2_9_TRACKING_SWITCH:1.2
	OPENBSD_2_9:1.1.1.1.0.2
	OPENBSD_2_9_BASE:1.1.1.1
	nate_2001-Feb-06:1.1.1.1
	nate:1.1.1;
locks; strict;
comment	@# @;


1.94
date	2017.07.16.19.19.02;	author espie;	state Exp;
branches;
next	1.93;
commitid	tt0GhWK5c4uf9ILG;

1.93
date	2017.06.17.00.16.20;	author schwarze;	state Exp;
branches;
next	1.92;
commitid	YxOR06ZKDNWwstHt;

1.92
date	2017.04.10.11.46.33;	author sthen;	state Exp;
branches;
next	1.91;
commitid	HY6VNZxjJWzKQFDV;

1.91
date	2017.01.17.06.58.10;	author jca;	state Exp;
branches;
next	1.90;
commitid	Qm9AjCBNPzS8UHlk;

1.90
date	2016.03.11.20.07.55;	author sthen;	state Exp;
branches;
next	1.89;
commitid	lzegX5axGHTKC7bp;

1.89
date	2015.11.29.15.50.20;	author ajacoutot;	state Exp;
branches;
next	1.88;
commitid	R4zDyQEPMusoKaj3;

1.88
date	2015.07.30.23.08.10;	author sthen;	state Exp;
branches;
next	1.87;
commitid	X16ZihQs4ndMrE1s;

1.87
date	2015.06.18.21.18.04;	author kirby;	state Exp;
branches;
next	1.86;
commitid	tFmXDPCX7JUcwD1U;

1.86
date	2015.05.02.21.52.19;	author sthen;	state Exp;
branches;
next	1.85;
commitid	830u3zozHoNUIv3a;

1.85
date	2015.04.23.22.38.55;	author sthen;	state Exp;
branches;
next	1.84;
commitid	94kzhbdZHtrNGmOO;

1.84
date	2015.03.26.01.07.32;	author sthen;	state Exp;
branches;
next	1.83;
commitid	SzPdwWvVHoi3yvaQ;

1.83
date	2015.01.22.16.42.09;	author sthen;	state Exp;
branches;
next	1.82;
commitid	8kubQlnh8Gi1cPTn;

1.82
date	2014.08.14.06.54.24;	author ajacoutot;	state Exp;
branches;
next	1.81;
commitid	4WqjyVF6zYI56CYM;

1.81
date	2014.07.19.22.36.13;	author ajacoutot;	state Exp;
branches;
next	1.80;
commitid	MSFt4PoL3vJ8bL97;

1.80
date	2014.07.12.14.55.40;	author ajacoutot;	state Exp;
branches;
next	1.79;
commitid	e5XWMyIdQTiAJLnw;

1.79
date	2014.04.21.11.41.11;	author sthen;	state Exp;
branches;
next	1.78;

1.78
date	2014.04.21.11.27.02;	author sthen;	state Exp;
branches;
next	1.77;

1.77
date	2014.04.21.11.26.16;	author sthen;	state Exp;
branches;
next	1.76;

1.76
date	2014.03.29.15.39.13;	author ajacoutot;	state Exp;
branches;
next	1.75;

1.75
date	2014.03.23.21.23.51;	author sthen;	state Exp;
branches;
next	1.74;

1.74
date	2014.01.07.21.55.54;	author sthen;	state Exp;
branches;
next	1.73;

1.73
date	2013.07.18.07.58.12;	author sthen;	state Exp;
branches;
next	1.72;

1.72
date	2013.06.20.06.54.37;	author ajacoutot;	state Exp;
branches;
next	1.71;

1.71
date	2013.06.17.19.28.37;	author ajacoutot;	state Exp;
branches;
next	1.70;

1.70
date	2013.03.11.11.41.31;	author espie;	state Exp;
branches;
next	1.69;

1.69
date	2013.03.04.11.34.51;	author jasper;	state Exp;
branches;
next	1.68;

1.68
date	2013.02.09.14.49.53;	author sthen;	state Exp;
branches;
next	1.67;

1.67
date	2013.02.05.14.49.29;	author sthen;	state Exp;
branches;
next	1.66;

1.66
date	2012.11.09.20.50.17;	author sthen;	state Exp;
branches;
next	1.65;

1.65
date	2012.11.08.21.59.01;	author sthen;	state Exp;
branches;
next	1.64;

1.64
date	2012.09.27.17.26.05;	author ajacoutot;	state Exp;
branches;
next	1.63;

1.63
date	2012.08.09.12.05.16;	author sthen;	state Exp;
branches;
next	1.62;

1.62
date	2012.06.08.21.07.02;	author sthen;	state Exp;
branches;
next	1.61;

1.61
date	2012.06.01.07.12.41;	author jasper;	state Exp;
branches;
next	1.60;

1.60
date	2012.05.14.06.26.52;	author ajacoutot;	state Exp;
branches;
next	1.59;

1.59
date	2012.01.31.14.20.18;	author sthen;	state Exp;
branches
	1.59.2.1;
next	1.58;

1.58
date	2012.01.26.08.03.57;	author ajacoutot;	state Exp;
branches;
next	1.57;

1.57
date	2012.01.24.12.38.44;	author sthen;	state Exp;
branches;
next	1.56;

1.56
date	2012.01.12.11.39.36;	author sthen;	state Exp;
branches;
next	1.55;

1.55
date	2012.01.11.16.01.33;	author sthen;	state Exp;
branches;
next	1.54;

1.54
date	2011.12.12.22.16.39;	author sthen;	state Exp;
branches;
next	1.53;

1.53
date	2011.11.28.10.56.13;	author sthen;	state Exp;
branches;
next	1.52;

1.52
date	2011.11.14.15.57.21;	author sthen;	state Exp;
branches;
next	1.51;

1.51
date	2011.11.14.14.21.18;	author sthen;	state Exp;
branches;
next	1.50;

1.50
date	2011.11.14.08.58.07;	author sthen;	state Exp;
branches;
next	1.49;

1.49
date	2011.09.19.15.59.57;	author sthen;	state Exp;
branches;
next	1.48;

1.48
date	2011.09.16.11.41.40;	author espie;	state Exp;
branches;
next	1.47;

1.47
date	2011.07.19.21.06.08;	author sthen;	state Exp;
branches;
next	1.46;

1.46
date	2011.06.02.10.37.08;	author sthen;	state Exp;
branches;
next	1.45;

1.45
date	2011.03.09.23.32.20;	author sthen;	state Exp;
branches;
next	1.44;

1.44
date	2011.03.09.12.55.04;	author sthen;	state Exp;
branches;
next	1.43;

1.43
date	2011.03.09.11.00.55;	author sthen;	state Exp;
branches;
next	1.42;

1.42
date	2010.11.20.17.22.41;	author espie;	state Exp;
branches;
next	1.41;

1.41
date	2010.11.06.16.07.00;	author espie;	state Exp;
branches;
next	1.40;

1.40
date	2010.10.19.07.43.01;	author espie;	state Exp;
branches;
next	1.39;

1.39
date	2010.10.03.22.21.49;	author sthen;	state Exp;
branches;
next	1.38;

1.38
date	2010.06.26.11.11.12;	author sthen;	state Exp;
branches;
next	1.37;

1.37
date	2010.04.15.14.29.16;	author ajacoutot;	state Exp;
branches;
next	1.36;

1.36
date	2010.03.31.22.11.11;	author sthen;	state Exp;
branches;
next	1.35;

1.35
date	2010.03.20.17.11.40;	author ajacoutot;	state Exp;
branches;
next	1.34;

1.34
date	2010.03.03.20.39.15;	author sthen;	state Exp;
branches;
next	1.33;

1.33
date	2010.01.15.11.25.15;	author sthen;	state Exp;
branches;
next	1.32;

1.32
date	2009.09.15.17.37.22;	author jasper;	state Exp;
branches;
next	1.31;

1.31
date	2009.04.03.15.40.12;	author sthen;	state Exp;
branches;
next	1.30;

1.30
date	2008.11.13.13.15.06;	author ajacoutot;	state Exp;
branches;
next	1.29;

1.29
date	2008.09.27.17.30.08;	author martynas;	state Exp;
branches;
next	1.28;

1.28
date	2008.09.26.19.00.58;	author martynas;	state Exp;
branches;
next	1.27;

1.27
date	2008.09.08.19.38.30;	author martynas;	state Exp;
branches;
next	1.26;

1.26
date	2008.02.03.18.06.41;	author kili;	state Exp;
branches;
next	1.25;

1.25
date	2008.01.30.20.55.59;	author mbalmer;	state Exp;
branches;
next	1.24;

1.24
date	2007.10.02.09.21.50;	author sthen;	state Exp;
branches;
next	1.23;

1.23
date	2007.09.15.21.14.02;	author merdely;	state Exp;
branches;
next	1.22;

1.22
date	2007.05.18.12.22.45;	author henning;	state Exp;
branches;
next	1.21;

1.21
date	2006.11.25.19.36.43;	author espie;	state Exp;
branches;
next	1.20;

1.20
date	2006.05.03.17.32.09;	author henning;	state Exp;
branches;
next	1.19;

1.19
date	2006.04.27.19.46.24;	author mbalmer;	state Exp;
branches;
next	1.18;

1.18
date	2005.10.24.05.14.13;	author fgsch;	state Exp;
branches;
next	1.17;

1.17
date	2005.09.16.09.51.28;	author espie;	state Exp;
branches;
next	1.16;

1.16
date	2005.06.03.19.46.43;	author mbalmer;	state Exp;
branches;
next	1.15;

1.15
date	2004.12.20.10.35.35;	author alek;	state Exp;
branches;
next	1.14;

1.14
date	2004.10.03.03.13.10;	author marcm;	state Exp;
branches;
next	1.13;

1.13
date	2004.09.27.03.10.24;	author marcm;	state Exp;
branches;
next	1.12;

1.12
date	2004.02.21.06.16.58;	author marcm;	state Exp;
branches;
next	1.11;

1.11
date	2004.02.09.06.48.48;	author marcm;	state Exp;
branches;
next	1.10;

1.10
date	2003.03.30.16.19.25;	author marcm;	state Exp;
branches;
next	1.9;

1.9
date	2003.01.16.23.42.18;	author marcm;	state Exp;
branches;
next	1.8;

1.8
date	2002.10.28.19.53.44;	author naddy;	state Exp;
branches;
next	1.7;

1.7
date	2002.10.14.16.14.33;	author marcm;	state Exp;
branches;
next	1.6;

1.6
date	2002.04.09.16.20.12;	author naddy;	state Exp;
branches;
next	1.5;

1.5
date	2002.03.29.04.28.34;	author pvalchev;	state Exp;
branches;
next	1.4;

1.4
date	2002.03.29.03.03.24;	author pvalchev;	state Exp;
branches;
next	1.3;

1.3
date	2001.10.15.22.54.50;	author espie;	state Exp;
branches;
next	1.2;

1.2
date	2001.05.06.03.59.05;	author lebel;	state Exp;
branches;
next	1.1;

1.1
date	2001.02.06.22.24.03;	author nate;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2001.02.06.22.24.03;	author nate;	state Exp;
branches;
next	;

1.59.2.1
date	2012.06.01.07.16.57;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.94
log
@use COMPILER_LIBCXX where applicable
@
text
@# $OpenBSD: Makefile,v 1.93 2017/06/17 00:16:20 schwarze Exp $

COMMENT-main=		UPS monitoring program supporting many brands
COMMENT-cgi=		CGIs for monitoring Nut-based UPSs
COMMENT-snmp=		driver for monitoring UPS via SNMP
COMMENT-xml=		driver for monitoring UPS via XML/HTTP

DISTNAME=		nut-2.7.4

PKGNAME-main=		${DISTNAME}
PKGNAME-cgi=		${DISTNAME:S/-/-cgi-/}
PKGNAME-snmp=		${DISTNAME:S/-/-snmp-/}
PKGNAME-xml=		${DISTNAME:S/-/-xml-/}

REVISION-main=		1
REVISION-snmp=		0
REVISION-xml=		0

SHARED_LIBS +=	upsclient            4.0      # .4.0
SHARED_LIBS +=	nutclient            0.0      # .0.0
SHARED_LIBS +=	nutscan              2.0      # .1.0

CATEGORIES=		sysutils
HOMEPAGE=		http://www.networkupstools.org/

MAINTAINER=		Stuart Henderson <sthen@@openbsd.org>

# GPLv2+, some scripts (not packaged) are GPLv3+
PERMIT_PACKAGE_CDROM=	Yes

COMMON +=	c crypto pthread
WANTLIB-main +=	${COMMON} ltdl m ssl ${COMPILER_LIBCXX} usb usb-1.0
WANTLIB-xml +=	${COMMON} ${MODGETTEXT_WANTLIB} expat neon proxy ssl z
WANTLIB-cgi +=	${COMMON} ${MODGETTEXT_WANTLIB} X11 expat fontconfig
WANTLIB-cgi +=	freetype gd jpeg m png ssl upsclient xcb z
WANTLIB-snmp +=	${COMMON} m netsnmp

MASTER_SITES=		${HOMEPAGE}source/2.7/

MODULES=		devel/gettext \
			lang/python
MODPY_RUNDEP=		No
# if avahi is present at build time, avahi support is built in nut-scanner,
# but it's dlopen()'d at runtime, so support is optional, so we don't list a
# hard run dependency for this (to reduce deps in the common case).
BUILD_DEPENDS+=		net/avahi
BUILD_DEPENDS+=		textproc/asciidoc>=8.6.8 \
			textproc/docbook-xsl

WEB_ROOT=		/var/www
SUBST_VARS=		BASESYSCONFDIR WEB_ROOT

CONFIGURE_STYLE=	gnu
SYSCONFDIR=		${BASESYSCONFDIR}/nut
LDFLAGS+=		-L${LOCALBASE}/lib -pthread
CONFIGURE_ARGS+=	--datadir=${PREFIX}/share/nut \
			--htmldir=${PREFIX}/share/doc/nut \
			--includedir=${PREFIX}/include/nut \
			--with-dev \
			--with-doc=html-single \
			--with-hal-libs="" \
			--with-ssl \
			--with-statepath=/var/db/nut \
			--with-user=_ups \
			--with-group=_ups \
			--without-ipmi \
			CPPFLAGS="-I${LOCALBASE}/include" \
			LDFLAGS="${LDFLAGS}"

PSEUDO_FLAVORS=		no_snmp no_xml
FLAVOR?=
MULTI_PACKAGES=		-main -cgi

.if ${FLAVOR:Mno_snmp}
CONFIGURE_ARGS+=	--without-snmp
.else
MULTI_PACKAGES+=	-snmp
.endif

.if ${FLAVOR:Mno_xml}
CONFIGURE_ARGS+=	--without-neon
.else
MULTI_PACKAGES+=	-xml
.endif

LIB_DEPENDS-main=	devel/libtool,-ltdl \
			devel/libusb-compat
RUN_DEPENDS-main=	# empty

PREFIX-cgi=		${WEB_ROOT}

LIB_DEPENDS-xml=	net/neon
RUN_DEPENDS-xml=	${RUN_DEPENDS} \
			sysutils/nut

LIB_DEPENDS-snmp=	net/net-snmp
RUN_DEPENDS-snmp=	sysutils/nut

LIB_DEPENDS-cgi=	${LIB_DEPENDS} \
			graphics/jpeg \
			graphics/gd \
			sysutils/nut

.if ${MULTI_PACKAGES:M-cgi}
BUILD_DEPENDS+=		graphics/gd>=1.8.3

CONFIGURE_ARGS+=	--with-cgi \
			--with-cgipath="${WEB_ROOT}/cgi-bin/nut" \
			--with-gd-libs="-L${X11BASE}/lib -L${PREFIX}/lib \
			    -lgd -lpng -lz -ljpeg -lm -lfreetype -lX11" \
			--with-gd-includes="-I${PREFIX}/include"
.endif

USE_GMAKE=		Yes
USE_LIBTOOL=		gnu# -all-static
FAKE_FLAGS=		sysconfdir=${PREFIX}/share/examples/nut

NO_TEST=		Yes

pre-configure:
	${SUBST_CMD} ${WRKSRC}/conf/upssched.conf.sample.in
	-ln -s ${MODPY_BIN} ${WRKDIR}/bin/python

post-install:
	${INSTALL_DATA_DIR} ${WRKINST}${WEB_ROOT}/conf/nut/
.for file in hosts.conf upsset.conf upsstats.html upsstats-single.html
	${INSTALL_DATA} ${WRKBUILD}/conf/${file}.sample \
	    ${WRKINST}${WEB_ROOT}/conf/nut/
.endfor
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/nut/
	cd ${WRKSRC}/docs; cp -R ../[A-LN-Z]* ../MAINTAINERS \
	    *html cables images ${PREFIX}/share/doc/nut/
	${INSTALL_SCRIPT} ${WRKSRC}/scripts/avahi/nut.service \
	    ${PREFIX}/share/examples/nut

.include <bsd.port.mk>
@


1.93
log
@Output of mandoc looks better than output of groff not only in spite
of the large number of UNSUPP messages, but precisely because of them:
all those .sp requests inside tables are completely pointless and
only spew gratuitious blank lines with groff.  Besides, mandoc is
more reliable than groff with respect to the special characters
used when it comes to -Tascii output.

The about 25 broken .so files are already commented out in the
PLIST, and none of them are needed on OpenBSD, all the names are
in the NAME sections anyway.

So drop USE_GROFF and bump those three of the four subpackages
that contain manual pages.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.92 2017/04/10 11:46:33 sthen Exp $
d32 1
a32 1
WANTLIB-main +=	${COMMON} ltdl m ssl ${LIBCXX} usb usb-1.0
@


1.92
log
@use LIBCXX
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.91 2017/01/17 06:58:10 jca Exp $
d15 3
a17 1
REVISION-main=		0
a51 1
USE_GROFF=		Yes
@


1.91
log
@Unbreak nut-scanner+usb, dlopen libusb.so instead of a distro-specific name

ok sthen@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.90 2016/03/11 20:07:55 sthen Exp $
d30 1
a30 1
WANTLIB-main +=	${COMMON} ltdl m ssl stdc++ usb usb-1.0
@


1.90
log
@update to NUT 2.7.4
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.89 2015/11/29 15:50:20 ajacoutot Exp $
d14 2
@


1.89
log
@daemon_timeout is not passed to the child scripts either.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.88 2015/07/30 23:08:10 sthen Exp $
d8 1
a8 2
DISTNAME=		nut-2.7.3
REVISION-main=		2
d15 1
a15 1
SHARED_LIBS +=	upsclient            3.0      # .4.0
d17 1
a17 1
SHARED_LIBS +=	nutscan              1.0      # .1.0
@


1.88
log
@add a defensive --without-ipmi to CONFIGURE_ARGS. currently a noop (-> no
package change), but a pending (post-5.8) update to freeipmi will cause it
to be picked up.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.87 2015/06/18 21:18:04 kirby Exp $
d9 1
a9 1
REVISION-main=		1
@


1.87
log
@tell people to disable uhidev not uhid.
input and ok from sthen@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.86 2015/05/02 21:52:19 sthen Exp $
d64 1
@


1.86
log
@Tweaks to sysutils/nut:

- Install libupsclient headers/pkgconfig files. landry@@ asked about
these; they needed a --with-dev configure flag to get them installed...

- Get rid of the useless ${NUT_USER} and ${NUT_ID} SUBST_VARS which are
now getting in the way of new files in the PLIST.

- Move some files from /usr/local/share/ups to a more easily recognisable
/usr/local/share/nut.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.85 2015/04/23 22:38:55 sthen Exp $
d9 1
a9 1
REVISION-main=		0
@


1.85
log
@update to NUT 2.7.3
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.84 2015/03/26 01:07:32 sthen Exp $
d9 1
d48 1
a48 3
NUT_USER=		_ups
NUT_ID=			529
SUBST_VARS=		BASESYSCONFDIR NUT_USER NUT_ID WEB_ROOT
d54 1
a54 1
CONFIGURE_ARGS+=	--datadir=${PREFIX}/share/ups \
d56 2
d62 2
a63 2
			--with-user=${NUT_USER} \
			--with-group=${NUT_USER} \
@


1.84
log
@Add an snmp-ups subdriver to NUT for Huawei, tested with UPS5000-E
Add a meta rc script that starts/stops upsd and upsmon in the right order
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.83 2015/01/22 16:42:09 sthen Exp $
d8 1
a8 3
DISTNAME=		nut-2.7.2
REVISION-main=		4
REVISION-snmp=		0
@


1.83
log
@Add a note that some APC devices need ugen to work with NUT.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.82 2014/08/14 06:54:24 ajacoutot Exp $
d9 2
a15 2

REVISION-main=		3
@


1.82
log
@Drop configuration files only used by System V init scripts and add a
mention in the README.

input/ok sthen@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.81 2014/07/19 22:36:13 ajacoutot Exp $
d15 1
a15 1
REVISION-main=		2
@


1.81
log
@/etc/rc.d -> ${RCDIR}
(as pedantic and useless as /usr/local vs LOCALBASE|PREFIX but well...)

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.80 2014/07/12 14:55:40 ajacoutot Exp $
d15 1
a15 1
REVISION-main=		1
@


1.80
log
@pkg_scripts is not a variable anymore.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.79 2014/04/21 11:41:11 sthen Exp $
d15 1
a15 1
REVISION-main=		0
@


1.79
log
@update to NUT 2.7.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.78 2014/04/21 11:27:02 sthen Exp $
d14 2
@


1.78
log
@..plus 1 more line
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.77 2014/04/21 11:26:16 sthen Exp $
d8 1
a8 3
DISTNAME=		nut-2.7.1
REVISION-main=		1
REVISION-xml=		0
d15 1
a15 1
SHARED_LIBS +=	upsclient            2.0      # .3.1
d56 1
@


1.77
log
@sync WANTLIB; no more gssapi in neon
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.76 2014/03/29 15:39:13 ajacoutot Exp $
a31 1
WANTLIB-xml +=	com_err heimbase roken wind
@


1.76
log
@Also @@comment html/nut-banner.png like other html/ stuffs that currently
install directly under PREFIX.

ok sthen@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.75 2014/03/23 21:23:51 sthen Exp $
d10 1
d31 1
a31 1
WANTLIB-xml +=	${COMMON} ${MODGETTEXT_WANTLIB} asn1 expat gssapi krb5 neon ssl z proxy
@


1.75
log
@byebye tcp wrappers
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.74 2014/01/07 21:55:54 sthen Exp $
d9 1
a9 1
REVISION-main=		0
@


1.74
log
@update to nut-2.7.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.73 2013/07/18 07:58:12 sthen Exp $
d9 1
d29 1
a29 1
WANTLIB-main +=	${COMMON} ltdl m ssl stdc++ usb usb-1.0 wrap
@


1.73
log
@missing avahi dep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.72 2013/06/20 06:54:37 ajacoutot Exp $
d8 1
a8 4
DISTNAME=		nut-2.6.5
REVISION-main=		3
REVISION-cgi=		1
REVISION-xml=		1
d15 3
a17 2
SHARED_LIBS +=  upsclient            2.0      # 2.0
SHARED_LIBS +=  nutscan              1.0      # 1.0
d28 1
a28 1
WANTLIB-main +=	${COMMON} ltdl m ssl usb usb-1.0 wrap
d35 1
a35 1
MASTER_SITES=		${HOMEPAGE}source/2.6/
d82 1
a82 2
LIB_DEPENDS-main=	${MODGETTEXT_LIB_DEPENDS} \
			devel/libtool,-ltdl \
@


1.72
log
@Unbreak after hx509 and ntlm removal from Kerberos.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.71 2013/06/17 19:28:37 ajacoutot Exp $
d9 1
a9 1
REVISION-main=		2
d42 4
@


1.71
log
@Some trivial WANTLIB and tweaks to unbreak after the Heimdal update.
Stop hardcoding the Kerberos libs and use krb5-config(1).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.70 2013/03/11 11:41:31 espie Exp $
d9 3
a11 3
REVISION-main=		1
REVISION-cgi=		0
REVISION-xml=		0
d32 1
a32 1
WANTLIB-xml +=	com_err heimbase heimntlm hx509 roken wind
@


1.70
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.69 2013/03/04 11:34:51 jasper Exp $
d11 1
d32 1
@


1.69
log
@no need for any quirkyness for a2x.py since the recent asciidoc update

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.68 2013/02/09 14:49:53 sthen Exp $
a26 3
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
d111 1
a111 1
NO_REGRESS=		Yes
@


1.68
log
@Don't use ${FLAVOR:L}, we only support lower-case flavours now.
OK ajacoutot@@ espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.67 2013/02/05 14:49:29 sthen Exp $
d43 1
a43 1
BUILD_DEPENDS+=		textproc/asciidoc \
a61 1
			A2X=${LOCALBASE}/bin/a2x.py \
@


1.67
log
@bump; make sure static binaries get updated
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.66 2012/11/09 20:50:17 sthen Exp $
d70 1
a70 1
.if ${FLAVOR:L:Mno_snmp}
d76 1
a76 1
.if ${FLAVOR:L:Mno_xml}
@


1.66
log
@"USE_LIBTOOL= gnu # comment" -> "USE_LIBTOOL= gnu# comment"
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.65 2012/11/08 21:59:01 sthen Exp $
d10 1
@


1.65
log
@README tweak: show people how to start the daemons without rebooting.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.64 2012/09/27 17:26:05 ajacoutot Exp $
d9 1
a9 1
REVISION-main=		0
d111 1
a111 1
USE_LIBTOOL=		gnu # -all-static
@


1.64
log
@docbook-xsl already comes with libxslt.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.63 2012/08/09 12:05:16 sthen Exp $
d9 1
@


1.63
log
@update to NUT 2.6.5; bugfixes, cleanup, new device support, etc.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62 2012/06/08 21:07:02 sthen Exp $
a41 1
			textproc/docbook \
@


1.62
log
@update to NUT 2.6.4 rolling in the patch for CVE 2012-2944 which we had locally,
adding new device support, better snmp support for various devices, and many
other fixes and improvements.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.61 2012/06/01 07:12:41 jasper Exp $
d8 1
a8 1
DISTNAME=		nut-2.6.4
@


1.61
log
@Security fix for CVE-2012-2944: upsd can be remotely crashed

ok sthen@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.60 2012/05/14 06:26:52 ajacoutot Exp $
d8 1
a8 5
DISTNAME=		nut-2.6.3
REVISION-main=		5
REVISION-cgi=		4
REVISION-snmp=		4
REVISION-xml=		4
d15 2
a16 2
SHARED_LIBS +=  upsclient            1.0      # 1.0
SHARED_LIBS +=  nutscan              0.0      # 1.0
@


1.60
log
@Fix nut-xml after recent neon update.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59 2012/01/31 14:20:18 sthen Exp $
d9 4
a12 1
REVISION=		4
@


1.59
log
@Use GNU libtool, ports libtool doesn't build cgi's statically like it should.
Noted while following up on misc@@ post from Pavel Pocheptsov. Bump all the
subpackages for safety though in theory only -cgi should be affected.
While there tweak pre-configure to allow 'make configure' to be re-run
after interruption.

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2012/01/26 08:03:57 ajacoutot Exp $
d9 1
a9 2
REVISION-main=		3
REVISION=		0
d32 1
a32 1
WANTLIB-xml +=	${COMMON} ${MODGETTEXT_WANTLIB} asn1 expat gssapi krb5 neon ssl z
d54 1
a54 1
LDFLAGS+=		-L${LOCALBASE}/lib
@


1.59.2.1
log
@Security fix for CVE-2012-2944: upsd can be remotely crashed

ok sthen@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59 2012/01/31 14:20:18 sthen Exp $
d9 1
a9 1
REVISION-main=		4
@


1.58
log
@Put these users in the daemon class to be consistent with all the other
ones in ports.

discussed with and ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.57 2012/01/24 12:38:44 sthen Exp $
d9 2
a10 1
REVISION-main=		2
d113 1
a113 1
USE_LIBTOOL=		Yes
d120 1
a120 1
	ln -s ${MODPY_BIN} ${WRKDIR}/bin/python
@


1.57
log
@tweak README
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2012/01/12 11:39:36 sthen Exp $
d9 1
a9 1
REVISION-main=		1
@


1.56
log
@bit of a tidy-up for NUT.

- move MESSAGE to README and flesh it out a bit

- fix libwrap detection in autoconf

- install the avahi service definition to the right place again; this got
broken when moving to using SYSCONFDIR overrides / BASESYSCONFDIR
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55 2012/01/11 16:01:33 sthen Exp $
d9 1
a9 1
REVISION-main=		0
@


1.55
log
@update to NUT 2.6.3.

- nut-scanner has been changed to dlopen()ing modules, so roll it into the
main package now this can be done without bringing in excess dependencies.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.54 2011/12/12 22:16:39 sthen Exp $
d9 1
d49 1
a49 1
SUBST_VARS=		WEB_ROOT NUT_USER NUT_ID
@


1.54
log
@"bump everything" was supposed to include the -snmp subpackage, fix it now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2011/11/28 10:56:13 sthen Exp $
a6 1
COMMENT-scanner=	UPS scanning tool for nut
d8 1
a8 6
DISTNAME=		nut-2.6.2
REVISION-main=		2
REVISION-cgi=		2
REVISION-scanner=	1
REVISION-snmp=		0
REVISION-xml=		2
a13 1
PKGNAME-scanner=	${DISTNAME:S/-/-scanner-/}
d30 1
a30 1
WANTLIB-main +=	${COMMON} m ssl usb usb-1.0
a34 2
WANTLIB-scanner += ${WANTLIB-main} ${WANTLIB-snmp} ${WANTLIB-xml} upsclient
WANTLIB-scanner += avahi-client avahi-common avahi-core dbus-1
d53 2
a54 2
CONFIGURE_ARGS+=	A2X=${LOCALBASE}/bin/a2x.py \
			--datadir=${PREFIX}/share/ups \
d56 1
d60 4
a63 1
			--with-group=${NUT_USER}
a80 4
.if ! ${FLAVOR:L:Mno_xml} && ! ${FLAVOR:L:Mno_snmp}
MULTI_PACKAGES+=	-scanner
.endif

d82 1
a93 6

LIB_DEPENDS-scanner=	${LIB_DEPENDS-main} \
			${LIB_DEPENDS-snmp} \
			${LIB_DEPENDS-xml} \
			net/avahi \
			sysutils/nut
@


1.53
log
@better SYSCONFDIR handling, get rid of CONFIGURE_STYLE=...old hack
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.52 2011/11/14 15:57:21 sthen Exp $
a10 1
REVISION-xml=		2
d13 2
@


1.52
log
@fix wantlib and bump everything, nut-xml missing bump noticed by naddy
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 2011/11/14 14:21:18 sthen Exp $
d10 4
a13 4
REVISION-main=		1
REVISION-xml=		1
REVISION-cgi=		1
REVISION-scanner=	0
d59 2
a60 1
CONFIGURE_STYLE=	gnu old
a61 1
			--sysconfdir=${SYSCONFDIR}/nut \
a62 1
			--mandir=${PREFIX}/man \
@


1.51
log
@missing bump, thanks naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2011/11/14 08:58:07 sthen Exp $
d10 4
a13 2
REVISION-main=		0
REVISION-cgi=		0
d36 3
a38 3
WANTLIB-main +=	${COMMON} ${WANTLIB} m ssl usb usb-1.0
WANTLIB-xml +=	${COMMON} ${WANTLIB} asn1 expat gssapi krb5 neon ssl z
WANTLIB-cgi +=	${COMMON} ${MODLIBICONV_WANTLIB} X11 expat fontconfig
d46 1
a46 2
MODULES=		converters/libiconv \
			devel/gettext \
@


1.50
log
@- Handle the libusb-compat changeover, from aja@@

- Move nut-scanner to a separate package, not everybody wants to
 scan their nuts and it pulls in various deps not wanted for the
 main package.

- Add missing dep on avahi (for the scanner only) and install
 static service configuration files.

ok ajacoutot
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2011/09/19 15:59:57 sthen Exp $
d11 1
@


1.49
log
@update to NUT 2.6.2 and add rc.d scripts

- thanks ajacoutot@@ for looking over the scripts

- note that there has been some major work on apcsmart; in the event
of problems the old driver is still available as apcsmart-old
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2011/09/16 11:41:40 espie Exp $
d7 1
d10 1
d16 1
d33 1
a33 1
WANTLIB-main +=	${COMMON} ${WANTLIB} asn1 expat gssapi krb5 m ssl usb z
d35 1
a35 1
WANTLIB-cgi +=	${COMMON} ${WANTLIB} X11 expat fontconfig
d38 2
d43 3
a45 1
MODULES=		devel/gettext lang/python
d84 4
d89 1
a89 1
			devel/libusb
d101 6
d141 2
@


1.48
log
@normalize pkgpath
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2011/07/19 21:06:08 sthen Exp $
d8 1
a8 5
DISTNAME=		nut-2.6.1
REVISION-main=		0
REVISION-cgi =		0
REVISION-snmp =		0
REVISION-xml =		0
d15 3
a22 2
SHARED_LIBS+=		upsclient 1.0

d29 2
a30 2
COMMON =	c crypto
WANTLIB-main +=	${COMMON} m ssl usb
d32 3
a34 3
WANTLIB-cgi +=	${COMMON} ${WANTLIB} X11 Xau Xdmcp expat fontconfig
WANTLIB-cgi +=	freetype gd jpeg m png pthread-stubs ssl upsclient xcb z
WANTLIB-snmp +=	${COMMON} netsnmp
d38 2
a39 1
MODULES=		devel/gettext
d113 1
@


1.47
log
@Patch the error message when a USB device isn't found, pointing people
in the direction of permissions on the device nodes, this is a fairly
common problem when configuring NUT with a USB UPS.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2011/06/02 10:37:08 sthen Exp $
d10 3
@


1.46
log
@update NUT to 2.6.1; bugfixes, cleanup, improvements and new device support.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2011/03/09 23:32:20 sthen Exp $
d9 1
@


1.45
log
@- split the netxml-ups driver into a separate package (nut-xml),
as was already done with the snmp-ups driver, to reduce dependencies
for the common case

- rewrite the various DESCR files
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2011/03/09 12:55:04 sthen Exp $
d8 1
a8 4
DISTNAME=		nut-2.6.0
REVISION-main=		1
REVISION-snmp=		0
REVISION-cgi=		0
@


1.44
log
@adjust MESSAGE to show people how to identify device nodes for USB UPS,
so they don't need to whack permissions on usb* ugen*. with aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2011/03/09 11:00:55 sthen Exp $
d5 2
a6 1
COMMENT-snmp=		driver for monitoring UPSs via SNMP
d9 3
a11 1
REVISION-main=		0
d16 1
d31 4
a34 2
WANTLIB-main += ${WANTLIB} c crypto expat m ssl z asn1 gssapi krb5 neon usb
WANTLIB-cgi +=	${WANTLIB} c crypto X11 Xau Xdmcp c crypto expat fontconfig
d36 1
a36 1
WANTLIB-snmp +=	c crypto netsnmp
d49 1
a49 1
USE_GROFF =		Yes
d62 1
a62 1
PSEUDO_FLAVORS=		no_snmp
d65 1
d72 6
d79 2
a80 2
			devel/libusb \
			net/neon
d84 4
d89 1
a89 1
RUN_DEPENDS-snmp=	sysutils/nut,-main
d94 1
a94 2
			sysutils/nut,-main
RUN_DEPENDS-cgi=	# empty
d101 1
a101 1
			--with-gd-libs="-L/usr/X11R6/lib -L${PREFIX}/lib \
d119 2
a120 1
	    ${WRKINST}${WEB_ROOT}/conf/nut/${file}.sample
a123 1
.endfor
@


1.43
log
@- update nut to 2.6.0 (major documentation revamp and support for new
devices, including APC 5G, various Eaton, HP, and Tripp Lite models,
and a number of USB HID devices)

- build the snmp package by default

- use correct user/group names in MESSAGE
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2010/11/20 17:22:41 espie Exp $
d8 1
@


1.42
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2010/11/06 16:07:00 espie Exp $
d7 1
a7 4
DISTNAME=		nut-2.4.3
REVISION-main=		1
REVISION-cgi=		1
REVISION-snmp=		1
d26 4
a29 3
WANTLIB += c crypto
WANTLIB-main += ${WANTLIB}
WANTLIB-main += expat m ssl z asn1 gssapi krb5 neon usb
d31 1
a31 1
MASTER_SITES=		${HOMEPAGE}source/2.4/
d34 3
d45 2
a46 1
CONFIGURE_ARGS+=	--sysconfdir=${SYSCONFDIR}/nut \
d49 2
d53 1
a53 3
			--with-group=${NUT_USER} \
			--with-ssl \
			--enable-strip
d55 1
a55 1
PSEUDO_FLAVORS=		snmp
d58 3
a60 1
.if ${FLAVOR:L:Msnmp}
a68 3
WANTLIB-cgi=		${MODGETTEXT_WANTLIB} \
			X11 Xau Xdmcp c crypto expat fontconfig freetype gd
WANTLIB-cgi+=		jpeg m png pthread-stubs ssl upsclient xcb z
a69 1
WANTLIB-snmp=		${WANTLIB} netsnmp
d71 1
a71 1
RUN_DEPENDS-snmp=	# empty
d91 1
a98 9
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/nut/
	cp -R ${WRKSRC}/docs/* ${PREFIX}/share/doc/nut/
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/nut/
.for file in upsmon.conf upsd.conf upsd.users upssched.conf ups.conf
	${INSTALL_DATA} ${WRKBUILD}/conf/${file}.sample \
	    ${PREFIX}/share/examples/nut/${file}
.endfor
# Yes, we install the CGI config files even if we're not building CGI support,
# it will get properly handled by packaging.
d103 3
@


1.41
log
@move gettext to new WANTLIB
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2010/10/19 07:43:01 espie Exp $
d41 1
a41 1
USE_GROFF =	Yes
d61 2
a62 2
			::devel/libusb \
			::net/neon
d70 1
a70 1
LIB_DEPENDS-snmp=	::net/net-snmp
d74 3
a76 3
			::graphics/jpeg \
			::graphics/gd \
			::sysutils/nut,-main
d80 1
a80 1
BUILD_DEPENDS+=		:gd->=1.8.3:graphics/gd
@


1.40
log
@USE_GROFF=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2010/10/03 22:21:49 sthen Exp $
d65 2
a66 1
WANTLIB-cgi=		X11 Xau Xdmcp c crypto expat fontconfig freetype gd
@


1.39
log
@- new-style WANTLIB/LIB_DEPENDS/REVISION
- sync WANTLIB
- suggest suitable group for serial ports in MESSAGE
- take MAINTAINER
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2010/06/26 11:11:12 sthen Exp $
d41 1
@


1.38
log
@Note in MESSAGE that the _nut user must have permission to access the
relevant device nodes if using a USB UPS. Suggested by Alexey Suslikov.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2010/04/15 14:29:16 ajacoutot Exp $
d8 5
a12 1
PKGNAME-main=		${DISTNAME}p0
d14 2
a15 1
PKGNAME-snmp=		${DISTNAME:S/-/-snmp-/}p0
d19 2
a22 2
MASTER_SITES=		${HOMEPAGE}source/2.4/

d31 3
a33 1
WANTLIB-main += expat m ssl z asn1 gssapi krb5
d60 2
a61 2
			usb::devel/libusb \
			neon::net/neon
d64 2
a65 1
WANTLIB-cgi=
d67 2
a68 1
LIB_DEPENDS-snmp=	netsnmp::net/net-snmp
d71 4
a74 1
LIB_DEPENDS-cgi=	# empty
@


1.37
log
@Consistency: remove the 1, 2 or even 3 empty blank lines.

sthen@@ agrees
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2010/03/31 22:11:11 sthen Exp $
d8 1
a8 1
PKGNAME-main=		${DISTNAME}
@


1.36
log
@update to 2.4.3, tested by Denny White and Aaron Stellman

note that with USB UPS, you may have to allow permissions on
further ugen subdevices (e.g. ugen0.01 as well as ugen0.00).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2010/03/20 17:11:40 ajacoutot Exp $
d10 1
a10 1
PKGNAME-snmp=		${DISTNAME:S/-/-snmp-/}
@


1.35
log
@Use gettext module.
Correctly install _ups user and group.
Add better defaults config.

looks ok to sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2010/03/03 20:39:15 sthen Exp $
d7 4
a10 4
DISTNAME=		nut-2.4.1
PKGNAME-main=		${DISTNAME}p3
PKGNAME-cgi=		${DISTNAME:S/-/-cgi-/}p0
PKGNAME-snmp=		${DISTNAME:S/-/-snmp-/}p0
@


1.34
log
@fix the path in a sample config file.
ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2010/01/15 11:25:15 sthen Exp $
d8 1
a8 1
PKGNAME-main=		${DISTNAME}p2
d23 6
a28 3
WANTLIB-main=		c crypto expat iconv intl m ssl z \
			asn1 gssapi krb5
WANTLIB-snmp=		c crypto
d52 2
a53 1
LIB_DEPENDS-main=	usb::devel/libusb \
d60 4
@


1.33
log
@from upstream repository;

* base the default maxconn on available filehandles.
* change the error message to better indicate that it's an error
not a warning.

ok jasper@@

while there, remove an out-of-date comment in MESSAGE-main.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2009/09/15 17:37:22 jasper Exp $
d8 1
a8 1
PKGNAME-main=		${DISTNAME}p1
d71 3
@


1.32
log
@remove marc balmer as maintainer of all of his ports, to take away the
illusion marc still maintains them. as requested by himself.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2009/04/03 15:40:12 sthen Exp $
d8 1
a8 1
PKGNAME-main=		${DISTNAME}p0
@


1.31
log
@update to 2.4.1, code cleanup and adds support for a bunch of new
UPS and also now preliminary support for PDUs.

ok mbalmer (maintainer),
"commit and we fix in-tree if i run into issues" henning
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2008/11/13 13:15:06 ajacoutot Exp $
d8 3
a10 3
PKGNAME-main=		${DISTNAME}
PKGNAME-cgi=		${DISTNAME:S/-/-cgi-/}
PKGNAME-snmp=		${DISTNAME:S/-/-snmp-/}
a14 2

MAINTAINER=		Marc Balmer <mbalmer@@openbsd.org>
@


1.30
log
@- fix WANTLIB after neon update
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2008/09/27 17:30:08 martynas Exp $
d7 4
a10 4
DISTNAME=		nut-2.2.2
PKGNAME-main=		${DISTNAME}p1
PKGNAME-cgi=		${DISTNAME:S/-/-cgi-/}p1
PKGNAME-snmp=		${DISTNAME:S/-/-snmp-/}p0
d14 1
a14 1
SHARED_LIBS+=		upsclient 0.0
d18 1
a18 1
MASTER_SITES=		${HOMEPAGE}source/2.2/
d20 1
a20 1
# GPL
@


1.29
log
@- add neon to LIB_DEPENDS, so that netxml driver always builds
- upsimage.cgi used upsimage_cgi_LDFLAGS to tweak for -all-static,
and not *_LDADD as upsstats.cgi and upsset.cgi did.  as a result
upsimage.cgi was linked dynamically, therefore broken inside chroot
- add USE_GMAKE, so that it builds on landisk
- make lib-depends-check happy
- add @@bin marker for bin/snmp-ups
- bump all PKGNAMEs
ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2008/09/26 19:00:58 martynas Exp $
d8 1
a8 1
PKGNAME-main=		${DISTNAME}p0
d25 2
a26 1
WANTLIB-main=		c crypto expat iconv intl m ssl z
@


1.28
log
@Apapche -> Apache.  ok wcmaier@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2008/09/08 19:38:30 martynas Exp $
d8 3
a10 3
PKGNAME-main=		${DISTNAME}
PKGNAME-cgi=		${DISTNAME:S/-/-cgi-/}p0
PKGNAME-snmp=		${DISTNAME:S/-/-snmp-/}
d25 2
a26 1
WANTLIB=		c crypto m ssl 
d50 2
a51 1
LIB_DEPENDS-main=	usb::devel/libusb
d68 1
@


1.27
log
@update to nut-2.2.2, which contains the old agiler driver from 2.2.0
(now called agiler-old)
upses such as the below can now work again:
{0x0665, 0x5161, &agiler_old_subdriver},        /* Belkin F6C1200-UNV */
{0x06da, 0x0003, &agiler_old_subdriver},        /* Mustek Powermust */
{0x0f03, 0x0001, &agiler_old_subdriver},        /* Unitek Alpha 1200Sx *
ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2008/02/03 18:06:41 kili Exp $
d9 1
a9 1
PKGNAME-cgi=		${DISTNAME:S/-/-cgi-/}
@


1.26
log
@
Bring back static CGIs.
Load config files from /etc/nut.

ok mbalmer@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2008/01/30 20:55:59 mbalmer Exp $
d7 4
a10 4
DISTNAME=		nut-2.2.1
PKGNAME-main=		${DISTNAME}p0
PKGNAME-cgi=		${DISTNAME:S/-/-cgi-/}p0
PKGNAME-snmp=		${DISTNAME:S/-/-snmp-/}p0
d14 2
d65 2
@


1.25
log
@Update to nut ver. 2.2.1.

requested by and ok henning
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2007/10/02 09:21:50 sthen Exp $
d8 3
a10 2
PKGNAME-cgi=		${DISTNAME:S/-/-cgi-/}
PKGNAME-snmp=		${DISTNAME:S/-/-snmp-/}
d30 1
a30 1
CONFIGURE_STYLE=	gnu
a38 2
ALL_TARGET=		all
INSTALL_TARGET=		install
d50 1
a50 6
LIB_DEPENDS-cgi=	gd::graphics/gd \
			iconv::converters/libiconv \
			jpeg::graphics/jpeg

WANTLIB-cgi=		X11 Xau Xdmcp c crypto expat fontconfig freetype m
WANTLIB-cgi+=		ssl z png
@


1.24
log
@add missing /, fixing -snmp

ok mbalmer@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2007/09/15 21:14:02 merdely Exp $
d7 1
a7 1
DISTNAME=		nut-2.0.5
d15 1
a15 1
MASTER_SITES=		http://random.networkupstools.org/source/2.0/
d29 1
a29 1
CONFIGURE_STYLE=	gnu old
d35 1
a37 1

d41 1
a41 1
PSEUDO_FLAVORS=		no_cgi snmp
d43 1
a43 4
MULTI_PACKAGES=		-main
.if !${FLAVOR:L:Mno_cgi}
MULTI_PACKAGES+=	-cgi
.endif
d48 2
d51 6
a56 1
WANTLIB-cgi=
d65 2
a66 1
			--with-gd-libs="-L${PREFIX}/lib -lgd -lpng -lz -ljpeg -lm" \
a67 8

ALL_TARGET+=		cgi
INSTALL_TARGET+=	install-cgi
.endif

.if ${MULTI_PACKAGES:M-snmp}
ALL_TARGET+=		snmp
INSTALL_TARGET+=	install-snmp
d77 2
a78 1
	${INSTALL_DATA} ${WRKBUILD}/conf/${file} ${PREFIX}/share/examples/nut/
d84 2
a85 1
	${INSTALL_DATA} ${WRKBUILD}/conf/${file} ${WRKINST}${WEB_ROOT}/conf/nut/${file}.sample
@


1.23
log
@Remove surrounding quotes in COMMENT-*/PERMIT_*/IGNORE
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2007/05/18 12:22:45 henning Exp $
d9 1
a9 1
PKGNAME-snmp=		${DISTNAME:S/-/-snmp-}
@


1.22
log
@update to 2.0.5 + a fix to make bcmxcp work correctly again
partially from and ok mbalmer
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2006/11/25 19:36:43 espie Exp $
d3 3
a5 3
COMMENT-main=		"UPS monitoring program supporting many brands"
COMMENT-cgi=		"CGIs for monitoring Nut-based UPSs"
COMMENT-snmp=		"driver for monitoring UPSs via SNMP"
@


1.21
log
@new MULTI_PACKAGES
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2006/05/03 17:32:09 henning Exp $
d7 3
a9 5
VERSION=		2.0.3
DISTNAME=		nut-${VERSION}
PKGNAME-main=		${DISTNAME}p0
PKGNAME-cgi=		nut-cgi-${VERSION}
PKGNAME-snmp=		nut-snmp-${VERSION}
d12 1
d30 7
a36 6
CONFIGURE_ARGS+=	--sysconfdir=${SYSCONFDIR}/nut
CONFIGURE_ARGS+=	--datadir=${LOCALBASE}/share/ups
CONFIGURE_ARGS+=	--with-statepath=/var/db/nut
CONFIGURE_ARGS+=	--with-user=${NUT_USER}
CONFIGURE_ARGS+=	--with-ssl
CONFIGURE_ARGS+=	--enable-strip
d51 1
a51 1
PREFIX-cgi=			${WEB_ROOT}
d59 4
a62 4
CONFIGURE_ARGS+=	--with-cgi
CONFIGURE_ARGS+=	--with-cgipath="${WEB_ROOT}/cgi-bin/nut"
CONFIGURE_ARGS+=	--with-gd-libs="-L${LOCALBASE}/lib -lgd -lpng -lz -ljpeg -lm"
CONFIGURE_ARGS+=	--with-gd-includes="-I${LOCALBASE}/include"
@


1.20
log
@update to nut-2.0.3, last not leas bringing many format string fixes
preserve my changes to the fentonups driver, allowing the detection logic
to be bypassed and a model to be forced - for UPSes that do implement the
protocol except the identification command, which seems to be somewhat common
the Xanto S3000R thing here behaves like that, and support for it is added
ok mbalmer
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2006/04/27 19:46:24 mbalmer Exp $
d3 1
a3 1
COMMENT=		"UPS monitoring program supporting many brands"
d9 1
a9 1
PKGNAME=		${DISTNAME}
d43 1
a43 1
MULTI_PACKAGES=
a49 1
SUBPACKAGE?=
d51 6
a56 9
.if defined(PACKAGING)
. if ${SUBPACKAGE} == "-cgi"
PREFIX=			${WEB_ROOT}
WANTLIB=
. elif ${SUBPACKAGE} == "-snmp"
LIB_DEPENDS+=		netsnmp::net/net-snmp
. endif
.else
. if ${MULTI_PACKAGES:M-cgi}
d66 1
a66 3
. endif
. if ${MULTI_PACKAGES:M-snmp}
LIB_DEPENDS+=		netsnmp::net/net-snmp
d68 1
a70 1
. endif
@


1.19
log
@Suport an additional device.

from henning
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2005/10/24 05:14:13 fgsch Exp $
d7 1
a7 1
VERSION=		2.0.0
d9 3
a11 3
PKGNAME=		${DISTNAME}p2
PKGNAME-cgi=		nut-cgi-${VERSION}p0
PKGNAME-snmp=		nut-snmp-${VERSION}p0
@


1.18
log
@fix more breakage and regen plist. sturm@@ ok.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2005/09/16 09:51:28 espie Exp $
d9 1
a9 1
PKGNAME=		${DISTNAME}p1
@


1.17
log
@Fix a buglet in bsd.port.mk where the PSEUDO_FLAVORS get encoded into
the FULLPKGPATH, thus providing changes to packing-lists which shouldn't
happen, and making update more difficult.

Accordingly, bump all pkgnames with PSEUDO_FLAVORS, and provide an
update @@pkgpath for the bug for most of them (left out the ones with 3
or 4 pseudo flavors for space constraints...)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2005/06/03 19:46:43 mbalmer Exp $
d9 3
a11 3
PKGNAME=		${DISTNAME}p0
PKGNAME-cgi=		nut-cgi-${VERSION}
PKGNAME-snmp=		nut-snmp-${VERSION}
d65 1
a65 1
CONFIGURE_ARGS+=	--with-gd-libs="-L${LOCALBASE}/lib -lgd -lpng -lz -ljpeg -lttf -lm"
@


1.16
log
@Take maintainership.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2004/12/20 10:35:35 alek Exp $
d9 1
@


1.15
log
@Add WANTLIB markers
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2004/10/03 03:13:10 marcm Exp $
d13 1
@


1.14
log
@More PLIST updates... clean up the Makefile a bit and add an optional
-snmp SUBPACKAGE.

Also, remove myself as MAINTAINER.  Not that I won't continue to support
it, just that my shinny new(?) SNMP card for my UPS makes this port
not one I'll use everyday anymore.

See what happens when people give me free stuff :).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2004/09/27 03:10:24 marcm Exp $
d21 1
d53 1
@


1.13
log
@Update to the 2.0 tree of Nut.

This is a feature release so if you're upgrading, take a look at the
release notes here:

http://random.networkupstools.org/source/2.0/new-2.0.0.txt
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2004/02/21 06:16:58 marcm Exp $
d5 1
d10 1
a13 2
MAINTAINER=		Marc Matteo <marcm@@openbsd.org>

d25 1
a25 3
NUT_STATEDIR=		/var/db/nut
CONFDIR=		${SYSCONFDIR}/nut
SUBST_VARS=		WEB_ROOT NUT_USER NUT_ID NUT_STATEDIR CONFDIR
d28 1
a28 1
CONFIGURE_ARGS+=	--sysconfdir=${CONFDIR}
d30 1
a30 1
CONFIGURE_ARGS+=	--with-statepath=${NUT_STATEDIR}
d33 4
d38 1
a38 1
PSEUDO_FLAVORS=		no_cgi
d44 3
d52 2
d57 1
a57 1
BUILD_DEPENDS=		:gd->=1.8.3:graphics/gd
d64 8
a71 2
ALL_TARGET=		all cgi
INSTALL_TARGET=		install install-cgi
@


1.12
log
@Ok, actually commit the changes to user.list this time.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2004/02/09 06:48:48 marcm Exp $
d6 1
a6 1
VERSION=		1.4.1
d14 1
a14 1
MASTER_SITES=		http://random.networkupstools.org/source/1.4/
d27 1
a27 1
SUBST_VARS=		NUT_USER NUT_ID NUT_STATEDIR CONFDIR
d31 1
d65 1
a65 1
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/nut
d67 4
d73 1
a73 1
	${INSTALL_DATA_DIR} ${WRKINST}${WEB_ROOT}/conf/nut
d75 1
a75 1
	mv ${WRKINST}/${CONFDIR}/${file}.sample ${WRKINST}${WEB_ROOT}/conf/nut/
a76 2
	@@${INSTALL_DATA_DIR} ${PREFIX}/share/examples/nut; \
	${INSTALL_DATA} ${WRKINST}/${CONFDIR}/* ${PREFIX}/share/examples/nut/
@


1.11
log
@Update to 1.4.1.

In addition to the standard bugfixes, this is a major port rewrite.
The port now uses a '_ups' user and the CGIs created can now run under
either chrooted Apache or non-chrooted Apache.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2003/03/30 16:19:25 marcm Exp $
d24 1
a24 1
NUT_ID=			528
@


1.10
log
@Handle SYSCONFDIR properly and make this compile on vax (and probably the
other NO_SHARED_ARCHS as well).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2003/01/16 23:42:18 marcm Exp $
d6 1
a6 1
VERSION=		1.2.1
d10 1
d12 1
a12 1
HOMEPAGE=		http://www.exploits.org/nut/
d14 1
a14 1
MAINTAINER=		Marc Matteo <marcm@@openbsd.org>
a21 6
MASTER_SITES=		http://penguin.harrison.k12.co.us/mirrors/nut/release/1.2/ \
			${HOMEPAGE}release/1.2/

FAKE_FLAGS=		INSTALLROOT="${WRKINST}"

CGI_CFG=		hosts.conf upsset.conf upsstats.html upsstats-single.html
d23 10
a32 4
CONFIGURE_STYLE=	gnu
CONFIGURE_ARGS+=	--with-statepath="/var/db/nut"
CONFIGURE_ARGS+=	--with-user=uucp
CONFIGURE_ARGS+=	--with-group=dialer
d53 2
a54 3
CONFIGURE_ENV=		CPPFLAGS="-I${LOCALBASE}/include" \
			LDFLAGS="-L${LOCALBASE}/lib" \
			CFLAGS="${CFLAGS} -I${LOCALBASE}/include -L${LOCALBASE}/lib"
d67 1
a67 1
# it will get properly handled by the packaging.
d69 2
a70 2
.for file in ${CGI_CFG}
	mv ${WRKINST}/${SYSCONFDIR}/nut/${file}.sample ${WRKINST}${WEB_ROOT}/conf/nut/
d73 1
a73 1
	cp -Rp ${WRKINST}/${SYSCONFDIR}/nut/* ${PREFIX}/share/examples/nut/
@


1.9
log
@Update to 1.2.1, a substantial update from 1.0.0.

Changes are listed here:
http://www.exploits.org/nut/release/1.2/new-1.2.1.txt

ok sturm@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2002/10/28 19:53:44 naddy Exp $
a27 1
SYSCONFDIR=		/etc/nut
d70 1
a70 1
	mv ${WRKINST}/${SYSCONFDIR}/${file}.sample ${WRKINST}${WEB_ROOT}/conf/nut/
d73 1
a73 1
	cp -Rp ${WRKINST}/${SYSCONFDIR}/* ${PREFIX}/share/examples/nut/
@


1.8
log
@No regression tests available.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2002/10/14 16:14:33 marcm Exp $
d6 1
a6 1
VERSION=		1.0.0
d21 2
a22 1
MASTER_SITES=		${HOMEPAGE}release/
d26 1
a26 1
CGI_CFG=		hosts.conf multimon.conf upsset.conf
d29 1
a29 1
CONFIGURE_STYLE=	autoconf
d33 1
@


1.7
log
@* Update to 1.0.0

* CGIs are now a SUBPACKAGE and work with chrooted Apache

* Make myself MAINTAINER

* Mark conflict with upad-2.0

ok naddy@@ and nate@@
@
text
@d1 1
a1 1
# $OpenBSD$
d59 2
@


1.6
log
@Fix cgi flavor by compensating for broken autoconf setup.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2002/03/29 04:28:34 pvalchev Exp $
d3 2
a4 1
COMMENT=	"UPS monitoring program supporting many brands"
d6 4
a9 5
DISTNAME=	nut-0.44.2
CATEGORIES=	sysutils
NEED_VERSION=	1.402
HOMEPAGE=	http://www.exploits.org/nut/
MASTER_SITES=	${HOMEPAGE}release/
d11 1
a11 1
MAINTAINER=	Nathan Binkert <nate@@openbsd.org>
d13 3
d21 3
a23 2
FLAVORS=	cgi
FLAVOR?=
d25 7
a31 6
.if ${FLAVOR:L} == "cgi"
LIB_DEPENDS=	gd.18::graphics/gd
CONFIGURE_ENV=	CPPFLAGS="-I${LOCALBASE}/include" \
		LDFLAGS="-L${LOCALBASE}/lib" \
		CFLAGS="${CFLAGS} -I${LOCALBASE}/include -L${LOCALBASE}/lib"
.endif
d33 5
a37 7
CONFIGURE_STYLE= gnu old
CONFIGURE_ARGS= --sysconfdir="${SYSCONFDIR}/nut" \
		--mandir="${PREFIX}/man" \
		--with-modelpath="${PREFIX}/sbin" \
		--with-statepath="/var/db"
.if ${FLAVOR:L} == "cgi"
CONFIGURE_ARGS+= --with-cgipath="${PREFIX}/libexec/nut"
d39 1
d41 17
a57 5
FAKE_FLAGS=	INSTALLROOT="${WRKINST}"

.if ${FLAVOR:L} == "cgi"
ALL_TARGET=	all cgi
INSTALL_TARGET=	install install-cgi
d62 9
a70 10
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/nut/cables
	${INSTALL_DATA} ${FILESDIR}/README.OpenBSD ${PREFIX}/share/doc/nut
	@@for i in ${WRKSRC}/docs/* ; do \
		if [ -f "$$i" ]; then \
			${INSTALL_DATA} $$i ${PREFIX}/share/doc/nut ; \
		fi \
	done
	@@for i in ${WRKSRC}/docs/cables/* ; do \
		${INSTALL_DATA} $$i ${PREFIX}/share/doc/nut/cables ; \
	done
@


1.5
log
@simplify fix
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2002/03/29 03:03:24 pvalchev Exp $
d23 3
a25 1
CONFIGURE_ENV=	CFLAGS="-I${LOCALBASE}/include -L${LOCALBASE}/lib"
@


1.4
log
@ugly hacks in the cgi flavor to make this link with new binutils
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2001/10/15 22:54:50 espie Exp $
d23 1
a23 1
CONFIGURE_ENV=	LDFLAGS="-L${LOCALBASE}/lib -lttf" CFLAGS="-I${LOCALBASE}/include -L${LOCALBASE}/lib"
@


1.3
log
@Bad depend.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2001/05/06 03:59:05 lebel Exp $
d23 1
@


1.2
log
@sysutils: integrate COMMENT, bump NEED_VERSION.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2001/02/06 22:24:03 nate Exp $
d22 1
a22 1
LIB_DEPENDS=	gd.1::graphics/gd
@


1.1
log
@Initial revision
@
text
@d1 3
a3 1
# $OpenBSD$
d7 1
a7 1
NEED_VERSION=	1.346
@


1.1.1.1
log
@Network UPS Tools.  http://www.exploits.org/nut/
@
text
@@
