head	1.38;
access;
symbols
	OPENBSD_6_0:1.37.0.4
	OPENBSD_6_0_BASE:1.37
	OPENBSD_5_9:1.37.0.2
	OPENBSD_5_9_BASE:1.37
	OPENBSD_5_8:1.36.0.4
	OPENBSD_5_8_BASE:1.36
	OPENBSD_5_7:1.35.0.8
	OPENBSD_5_7_BASE:1.35
	OPENBSD_5_6:1.35.0.6
	OPENBSD_5_6_BASE:1.35
	OPENBSD_5_5:1.35.0.4
	OPENBSD_5_5_BASE:1.35
	OPENBSD_5_4:1.35.0.2
	OPENBSD_5_4_BASE:1.35
	OPENBSD_5_3:1.34.0.4
	OPENBSD_5_3_BASE:1.34
	OPENBSD_5_2:1.34.0.2
	OPENBSD_5_2_BASE:1.34
	OPENBSD_5_1_BASE:1.32
	OPENBSD_5_1:1.32.0.4
	OPENBSD_5_0:1.32.0.2
	OPENBSD_5_0_BASE:1.32
	OPENBSD_4_9:1.30.0.2
	OPENBSD_4_9_BASE:1.30
	OPENBSD_4_8:1.28.0.2
	OPENBSD_4_8_BASE:1.28
	OPENBSD_4_7:1.27.0.2
	OPENBSD_4_7_BASE:1.27
	OPENBSD_4_6:1.26.0.2
	OPENBSD_4_6_BASE:1.26
	OPENBSD_4_5:1.25.0.2
	OPENBSD_4_5_BASE:1.25
	OPENBSD_4_4:1.24.0.2
	OPENBSD_4_4_BASE:1.24
	OPENBSD_4_3:1.23.0.2
	OPENBSD_4_3_BASE:1.23
	OPENBSD_4_2:1.22.0.2
	OPENBSD_4_2_BASE:1.22
	OPENBSD_4_1:1.21.0.2
	OPENBSD_4_1_BASE:1.21
	OPENBSD_3_9:1.19.0.2
	OPENBSD_3_9_BASE:1.19
	OPENBSD_3_7:1.17.0.2
	OPENBSD_3_7_BASE:1.17
	OPENBSD_3_6:1.16.0.2
	OPENBSD_3_6_BASE:1.16
	OPENBSD_3_5:1.15.0.2
	OPENBSD_3_5_BASE:1.15
	OPENBSD_3_4:1.14.0.2
	OPENBSD_3_4_BASE:1.14
	OPENBSD_3_2:1.9.0.2
	OPENBSD_3_2_BASE:1.9
	OPENBSD_3_1:1.7.0.2
	OPENBSD_3_1_BASE:1.7;
locks; strict;
comment	@# @;


1.38
date	2016.12.02.13.32.14;	author jca;	state dead;
branches;
next	1.37;
commitid	jZHeB3Bzcbr3qYVc;

1.37
date	2016.01.06.10.15.12;	author sthen;	state Exp;
branches;
next	1.36;
commitid	nDYWxbBNW8LmWcSJ;

1.36
date	2015.03.24.21.26.09;	author sthen;	state Exp;
branches;
next	1.35;
commitid	HPiTA8ti7VSdGKhD;

1.35
date	2013.05.23.15.08.36;	author dcoppa;	state Exp;
branches;
next	1.34;

1.34
date	2012.03.15.21.36.44;	author sthen;	state Exp;
branches;
next	1.33;

1.33
date	2012.03.15.21.34.52;	author sthen;	state Exp;
branches;
next	1.32;

1.32
date	2011.07.20.13.50.08;	author sthen;	state Exp;
branches;
next	1.31;

1.31
date	2011.05.18.16.25.14;	author ajacoutot;	state Exp;
branches;
next	1.30;

1.30
date	2011.01.15.01.19.35;	author naddy;	state Exp;
branches;
next	1.29;

1.29
date	2010.10.26.09.44.32;	author sthen;	state Exp;
branches;
next	1.28;

1.28
date	2010.07.24.23.01.56;	author naddy;	state Exp;
branches;
next	1.27;

1.27
date	2010.01.28.11.30.39;	author okan;	state Exp;
branches;
next	1.26;

1.26
date	2009.06.21.13.24.02;	author sthen;	state Exp;
branches;
next	1.25;

1.25
date	2009.02.15.23.46.08;	author sthen;	state Exp;
branches;
next	1.24;

1.24
date	2008.07.02.19.02.20;	author brad;	state Exp;
branches;
next	1.23;

1.23
date	2008.02.22.20.56.05;	author naddy;	state Exp;
branches;
next	1.22;

1.22
date	2007.08.04.22.44.43;	author pvalchev;	state Exp;
branches;
next	1.21;

1.21
date	2007.02.14.01.54.42;	author pvalchev;	state Exp;
branches;
next	1.20;

1.20
date	2006.05.09.19.13.32;	author pedro;	state dead;
branches;
next	1.19;

1.19
date	2005.12.20.08.13.46;	author pvalchev;	state Exp;
branches;
next	1.18;

1.18
date	2005.06.05.19.40.54;	author pvalchev;	state dead;
branches;
next	1.17;

1.17
date	2005.03.13.05.02.01;	author pvalchev;	state Exp;
branches;
next	1.16;

1.16
date	2004.08.11.08.14.40;	author pvalchev;	state Exp;
branches;
next	1.15;

1.15
date	2004.01.11.00.14.31;	author pvalchev;	state Exp;
branches;
next	1.14;

1.14
date	2003.08.18.06.32.09;	author pvalchev;	state Exp;
branches;
next	1.13;

1.13
date	2003.06.19.06.30.42;	author pvalchev;	state dead;
branches;
next	1.12;

1.12
date	2003.04.01.22.58.38;	author pvalchev;	state Exp;
branches;
next	1.11;

1.11
date	2002.12.23.01.42.35;	author pvalchev;	state dead;
branches;
next	1.10;

1.10
date	2002.12.12.08.14.24;	author pvalchev;	state Exp;
branches;
next	1.9;

1.9
date	2002.09.15.19.17.16;	author pvalchev;	state Exp;
branches;
next	1.8;

1.8
date	2002.04.23.21.36.54;	author pvalchev;	state dead;
branches;
next	1.7;

1.7
date	2002.03.24.20.26.36;	author pvalchev;	state Exp;
branches;
next	1.6;

1.6
date	2002.01.29.19.40.51;	author pvalchev;	state Exp;
branches;
next	1.5;

1.5
date	2001.12.23.21.17.50;	author pvalchev;	state dead;
branches;
next	1.4;

1.4
date	2001.12.18.03.46.33;	author pvalchev;	state Exp;
branches;
next	1.3;

1.3
date	2001.12.16.18.40.11;	author pvalchev;	state Exp;
branches;
next	1.2;

1.2
date	2000.09.02.20.30.54;	author brad;	state dead;
branches;
next	1.1;

1.1
date	2000.09.02.03.26.57;	author brad;	state Exp;
branches;
next	;


desc
@@


1.38
log
@Move lsof to the Attic.

Requires kmem access, is so coupled to the system internals that it
needs a /usr/src/sys checkout, and breaks regularly due to changes in
base.  People used to it should be told to use fstat(1) & friends
instead.

ok landry@@ sthen@@ dcoppa@@
@
text
@$OpenBSD: patch-Configure,v 1.37 2016/01/06 10:15:12 sthen Exp $
--- Configure.orig	Tue Jul  7 21:17:04 2015
+++ Configure	Wed Jan  6 10:12:38 2016
@@@@ -3970,9 +3970,10 @@@@ return(0); }
 	echo "!!!WARNING!!!  Configuring for OpenBSD 3.9"
 	;;
       *)
+	LSOF_TSTBIGF=" "
 	echo "Unknown OpenBSD release: $LSOF_VSTR"
-	echo Assuming OpenBSD 3.9
-	LSOF_VERS=3090
+	echo Assuming OpenBSD 5.0
+	LSOF_VERS=5000
 	;;
       esac	# }
     fi	# }
@@@@ -3980,7 +3981,7 @@@@ return(0); }
     # Test for legal OpenBSD version.
 
     case $LSOF_VERS in	# {
-    1020|2050|2060|2070|2080|2090|3000|3010|3020|3030|3040|3050|3060|3070|3080|3090)
+    1020|2050|2060|2070|2080|2090|3000|3010|3020|3030|3040|3050|3060|3070|3080|3090|5000)
       ;;
     *)
       echo "Unknown OpenBSD version: $LSOF_VERS"
@@@@ -4042,11 +4043,6 @@@@ return(0); }
 	LSOF_TMP1=1
       fi	# }
     fi	# }
-    if test -d ${OPENBSD_SYS}/miscfs/procfs	# {
-    then
-      LSOF_CFGF="$LSOF_CFGF -DHASPROCFS"
-      LSOF_TMP1=1
-    fi	# }
     if test -d ${OPENBSD_SYS}/isofs/cd9660	# {
     then
       LSOF_CFGF="$LSOF_CFGF -DHAS9660FS=1"
@@@@ -4220,6 +4216,18 @@@@ return(0); }
     if test -r ${LSOF_INCLUDE}/sys/pipe.h	# {
     then
       LSOF_CFGF="$LSOF_CFGF -DHAS_SYS_PIPEH"
+    fi	# }
+    if test -r ${LSOF_INCLUDE}/kvm.h	# {
+    then
+      grep -q kvm_getproc2 ${LSOF_INCLUDE}/kvm.h
+      if test $? -eq 0	# {
+      then
+	  LSOF_CFGF="$LSOF_CFGF -DHASKVMGETPROC2"
+      fi	# }
+    fi	# }
+    if test -r ${LSOF_INCLUDE}/kvm.h -a $LSOF_VERS -ge 5000	# {
+    then
+      LSOF_CFGF="$LSOF_CFGF -DHASKVMGETPROC2 -DHASKVMGETPROCS"
     fi	# }
     LSOF_CFGL="$LSOF_CFGL -lkvm"
     LSOF_DIALECT_DIR=n+obsd
@


1.37
log
@update to lsof-4.89
@
text
@d1 1
a1 1
$OpenBSD: patch-Configure,v 1.36 2015/03/24 21:26:09 sthen Exp $
@


1.36
log
@update to lsof-4.88 and simplify patches
@
text
@d1 4
a4 4
$OpenBSD: patch-Configure,v 1.35 2013/05/23 15:08:36 dcoppa Exp $
--- Configure.orig	Mon Oct 13 23:31:13 2014
+++ Configure	Tue Mar 24 21:23:04 2015
@@@@ -3923,9 +3923,10 @@@@ return(0); }
d17 1
a17 1
@@@@ -3933,7 +3934,7 @@@@ return(0); }
d26 1
a26 1
@@@@ -3995,11 +3996,6 @@@@ return(0); }
d38 1
a38 1
@@@@ -4173,6 +4169,18 @@@@ return(0); }
@


1.35
log
@Update to lsof-4.87.

Fix dead MASTER_SITES.

Regen distinfo.

Simplify post-extract.

Remove setgid kmem, since lsof as a regular user does not work
anymore.

Minor cleanups.

With the help, and ok sthen@@ ajacoutot@@
@
text
@d1 5
a5 11
$OpenBSD: patch-Configure,v 1.34 2012/03/15 21:36:44 sthen Exp $
--- Configure.orig	Wed Jan  2 18:13:54 2013
+++ Configure	Tue May 21 18:26:15 2013
@@@@ -3865,13 +3865,30 @@@@ return(0); }
       3*)
 	LSOF_TSTBIGF=" "
 	LSOF_VERS=3090
-	echo "!!!WARNING!!!  Unsupported OpenBSD 3.x version: $LSOF_VSTR"
-	echo "!!!WARNING!!!  Configuring for OpenBSD 3.9"
+	echo "Unknown OpenBSD 3.x version: $LSOF_VSTR"
+	echo "Configuring for OpenBSD 3.9"
a6 16
+      4.0|4.1|4.2|4.3|4.4|4.5|4.6)
+	LSOF_TSTBIGF=" "
+	LSOF_VERS=3090
+	;;
+      4*)
+	LSOF_TSTBIGF=" "
+	LSOF_VERS=4070
+	echo "Unknown OpenBSD 4.x version: $LSOF_VSTR"
+	echo "Configuring for OpenBSD 4.7"
+	;;
+      5*)
+	LSOF_TSTBIGF=" "
+	LSOF_VERS=5000
+	echo "Unknown OpenBSD 5.x version: $LSOF_VSTR"
+	echo "Configuring for OpenBSD 5.0"
+	;;
d17 1
a17 1
@@@@ -3879,7 +3896,7 @@@@ return(0); }
d22 1
a22 1
+    1020|2050|2060|2070|2080|2090|3000|3010|3020|3030|3040|3050|3060|3070|3080|3090|4070|5000)
d26 1
a26 1
@@@@ -3941,11 +3958,6 @@@@ return(0); }
d38 1
a38 1
@@@@ -4119,6 +4131,18 @@@@ return(0); }
@


1.34
log
@oops committed from wrong tree - revert, will recommit the right one shortly
@
text
@d1 4
a4 4
$OpenBSD: patch-Configure,v 1.32 2011/07/20 13:50:08 sthen Exp $
--- Configure.orig	Mon Jan 18 19:01:14 2010
+++ Configure	Tue Jul 19 09:19:48 2011
@@@@ -3787,13 +3787,30 @@@@ return(0); }
d39 1
a39 1
@@@@ -3801,7 +3818,7 @@@@ return(0); }
d48 1
a48 1
@@@@ -3863,11 +3880,6 @@@@ return(0); }
d60 1
a60 1
@@@@ -4041,6 +4053,18 @@@@ return(0); }
@


1.33
log
@fix with vmmap, originally from ariane@@
@
text
@d2 3
a4 3
--- Configure.orig	Tue Sep 27 18:27:40 2011
+++ Configure	Sun Oct  9 16:02:29 2011
@@@@ -3834,13 +3834,30 @@@@ return(0); }
d39 1
a39 1
@@@@ -3848,7 +3865,7 @@@@ return(0); }
d48 1
a48 1
@@@@ -3910,11 +3927,6 @@@@ return(0); }
d60 1
a60 1
@@@@ -4088,6 +4100,18 @@@@ return(0); }
@


1.32
log
@- remove a bunch of unnecessary version checks
- allow lsof to build when kvm_getproc2 is removed
ok naddy@@
@
text
@d1 4
a4 4
$OpenBSD: patch-Configure,v 1.31 2011/05/18 16:25:14 ajacoutot Exp $
--- Configure.orig	Mon Jan 18 19:01:14 2010
+++ Configure	Tue Jul 19 09:19:48 2011
@@@@ -3787,13 +3787,30 @@@@ return(0); }
d39 1
a39 1
@@@@ -3801,7 +3818,7 @@@@ return(0); }
d48 1
a48 1
@@@@ -3863,11 +3880,6 @@@@ return(0); }
d60 1
a60 1
@@@@ -4041,6 +4053,18 @@@@ return(0); }
@


1.31
log
@No need to support procfs since we use kvm_getproc2(3).

"axe it" pval@@ (maintainer)
@
text
@d1 5
a5 17
$OpenBSD: patch-Configure,v 1.30 2011/01/15 01:19:35 naddy Exp $
--- Configure.orig	Mon Jan 18 20:01:14 2010
+++ Configure	Tue May 17 19:42:36 2011
@@@@ -3738,12 +3738,6 @@@@ return(0); }
 	LSOF_TSTBIGF=" "
 	LSOF_VERS=2090
 	;;
-      2*)
-	LSOF_TSTBIGF=" "
-	LSOF_VERS=2090
-	echo "!!!WARNING!!!  Unsupported OpenBSD 2.x version: $LSOF_VSTR"
-	echo "!!!WARNING!!!  Configuring for OpenBSD 2.9"
-	;;
       3.0*)
 	LSOF_TSTBIGF=" "
 	LSOF_VERS=3000
@@@@ -3784,16 +3778,56 @@@@ return(0); }
a7 5
 	;;
-      3*)
+      4.0*)
 	LSOF_TSTBIGF=" "
-	LSOF_VERS=3090
d10 2
a11 1
+	LSOF_VERS=4000
d13 1
a13 1
+      4.1*)
d15 1
a15 1
+	LSOF_VERS=4010
d17 1
a17 21
+      4.2*)
+	LSOF_TSTBIGF=" "
+	LSOF_VERS=4020
+	;;
+      4.3*)
+	LSOF_TSTBIGF=" "
+	LSOF_VERS=4030
+	;;
+      4.4*)
+	LSOF_TSTBIGF=" "
+	LSOF_VERS=4040
+	;;
+      4.5*)
+	LSOF_TSTBIGF=" "
+	LSOF_VERS=4050
+	;;
+      4.6*)
+	LSOF_TSTBIGF=" "
+	LSOF_VERS=4060
+	;;
+      4.7*)
d20 2
d23 1
a23 1
+      4.8*)
d25 3
a27 1
+	LSOF_VERS=4070
d29 1
a29 5
+      4.9*)
+	LSOF_TSTBIGF=" "
+	LSOF_VERS=4070
+	;;
+      4*)
a30 5
+	LSOF_VERS=4070
+	echo "!!!WARNING!!!  Unsupported OpenBSD 4.x version: $LSOF_VSTR"
+	echo "!!!WARNING!!!  Configuring for OpenBSD 4.7"
+	;;
       *)
d34 2
a35 2
+	echo Assuming OpenBSD 4.7
+	LSOF_VERS=4070
d39 1
a39 1
@@@@ -3801,7 +3835,7 @@@@ return(0); }
d44 1
a44 1
+    1020|2050|2060|2070|2080|2090|3000|3010|3020|3030|3040|3050|3060|3070|3080|3090|4000|4010|4020|4030|4040|4050|4060|4070)
d48 1
a48 1
@@@@ -3863,11 +3897,6 @@@@ return(0); }
d60 1
a60 1
@@@@ -4041,6 +4070,14 @@@@ return(0); }
d72 4
@


1.30
log
@recognize OpenBSD 4.9
@
text
@d1 3
a3 3
$OpenBSD: patch-Configure,v 1.29 2010/10/26 09:44:32 sthen Exp $
--- Configure.orig	Mon Jan 18 12:01:14 2010
+++ Configure	Fri Jan 14 18:17:37 2011
d89 13
a101 1
@@@@ -4041,6 +4075,14 @@@@ return(0); }
@


1.29
log
@use kvm_getproc2; ok ajacoutot@@
@
text
@d1 3
a3 3
$OpenBSD: patch-Configure,v 1.28 2010/07/24 23:01:56 naddy Exp $
--- Configure.orig	Mon Jan 18 20:01:14 2010
+++ Configure	Mon Oct 25 19:47:58 2010
d17 1
a17 1
@@@@ -3784,16 +3778,52 @@@@ return(0); }
d61 4
d80 1
a80 1
@@@@ -3801,7 +3831,7 @@@@ return(0); }
d89 1
a89 1
@@@@ -4041,6 +4071,14 @@@@ return(0); }
@


1.28
log
@recognize OpenBSD 4.8
@
text
@d1 4
a4 4
$OpenBSD: patch-Configure,v 1.27 2010/01/28 11:30:39 okan Exp $
--- Configure.orig	Wed Mar 25 13:24:01 2009
+++ Configure	Sat Jul 24 16:50:36 2010
@@@@ -3694,12 +3694,6 @@@@ return(0); }
d17 1
a17 1
@@@@ -3740,16 +3734,52 @@@@ return(0); }
d76 1
a76 1
@@@@ -3757,7 +3787,7 @@@@ return(0); }
d85 15
@


1.27
log
@recognize 4.7; ok jasper@@
@
text
@d1 3
a3 3
$OpenBSD: patch-Configure,v 1.26 2009/06/21 13:24:02 sthen Exp $
--- Configure.orig	Wed Mar 25 15:24:01 2009
+++ Configure	Wed Jan 27 17:52:50 2010
d17 1
a17 1
@@@@ -3740,16 +3734,48 @@@@ return(0); }
d57 4
d76 1
a76 1
@@@@ -3757,7 +3783,7 @@@@ return(0); }
@


1.26
log
@update to 4.82, and recognise OpenBSD 4.6. from Brad.
@
text
@d1 1
a1 1
$OpenBSD: patch-Configure,v 1.25 2009/02/15 23:46:08 sthen Exp $
d3 1
a3 1
+++ Configure	Sat Jun 20 20:39:42 2009
d17 1
a17 1
@@@@ -3740,16 +3734,44 @@@@ return(0); }
d53 4
d59 1
a59 1
+	LSOF_VERS=4060
d61 1
a61 1
+	echo "!!!WARNING!!!  Configuring for OpenBSD 4.6"
d67 2
a68 2
+	echo Assuming OpenBSD 4.6
+	LSOF_VERS=4060
d72 1
a72 1
@@@@ -3757,7 +3779,7 @@@@ return(0); }
d77 1
a77 1
+    1020|2050|2060|2070|2080|2090|3000|3010|3020|3030|3040|3050|3060|3070|3080|3090|4000|4010|4020|4030|4040|4050|4060)
@


1.25
log
@recognize 4.5, from Brad
@
text
@d1 6
a6 6
$OpenBSD: patch-Configure,v 1.24 2008/07/02 19:02:20 brad Exp $
--- Configure.orig	Tue Oct 21 12:21:45 2008
+++ Configure	Sun Feb 15 18:34:42 2009
@@@@ -3687,6 +3687,36 @@@@ return(0); }
 	echo "!!!WARNING!!!  Unsupported OpenBSD 3.x version: $LSOF_VSTR"
 	echo "!!!WARNING!!!  Configuring for OpenBSD 3.9"
d8 14
d23 4
a26 1
+	LSOF_TSTBIGF=" "
d28 1
a28 1
+	;;
d49 4
d55 1
a55 1
+	LSOF_VERS=4050
d57 1
a57 1
+	echo "!!!WARNING!!!  Configuring for OpenBSD 4.5"
d61 8
a68 2
 	echo Assuming OpenBSD 3.9
@@@@ -3698,7 +3728,7 @@@@ return(0); }
d73 1
a73 1
+    1020|2050|2060|2070|2080|2090|3000|3010|3020|3030|3040|3050|3060|3070|3080|3090|4000|4010|4020|4030|4040|4050)
@


1.24
log
@Allow lsof to recognize 4.4.

ok naddy@@
@
text
@d1 4
a4 4
$OpenBSD: patch-Configure,v 1.23 2008/02/22 20:56:05 naddy Exp $
--- Configure.orig	Mon Apr 10 08:44:22 2006
+++ Configure	Wed Jul  2 14:27:55 2008
@@@@ -3381,6 +3381,32 @@@@ return(0); }
d28 4
d34 1
a34 1
+	LSOF_VERS=4040
d36 1
a36 1
+	echo "!!!WARNING!!!  Configuring for OpenBSD 4.4"
d41 1
a41 1
@@@@ -3392,7 +3418,7 @@@@ return(0); }
d46 1
a46 1
+    1020|2050|2060|2070|2080|2090|3000|3010|3020|3030|3040|3050|3060|3070|3080|3090|4000|4010|4020|4030|4040)
@


1.23
log
@recognize 4.3
@
text
@d1 4
a4 4
$OpenBSD: patch-Configure,v 1.22 2007/08/04 22:44:43 pvalchev Exp $
--- Configure.orig	Mon Apr 10 06:44:22 2006
+++ Configure	Fri Feb 22 13:32:07 2008
@@@@ -3381,6 +3381,28 @@@@ return(0); }
d24 4
d30 1
a30 1
+	LSOF_VERS=4010
d32 1
a32 1
+	echo "!!!WARNING!!!  Configuring for OpenBSD 4.1"
d37 1
a37 1
@@@@ -3392,7 +3414,7 @@@@ return(0); }
d42 1
a42 1
+    1020|2050|2060|2070|2080|2090|3000|3010|3020|3030|3040|3050|3060|3070|3080|3090|4000|4010|4020|4030)
@


1.22
log
@poke configure to recognise 4.2; reminded by brad
@
text
@d1 1
a1 1
$OpenBSD: patch-Configure,v 1.21 2007/02/14 01:54:42 pvalchev Exp $
d3 2
a4 2
+++ Configure	Sat Aug  4 16:44:09 2007
@@@@ -3381,6 +3381,24 @@@@ return(0); }
d20 4
d33 1
a33 1
@@@@ -3392,7 +3410,7 @@@@ return(0); }
d38 1
a38 1
+    1020|2050|2060|2070|2080|2090|3000|3010|3020|3030|3040|3050|3060|3070|3080|3090|4000|4010|4020)
@


1.21
log
@recognise 4.1; brad
@
text
@d1 4
a4 4
$OpenBSD$
--- Configure.orig	Mon Apr 10 08:44:22 2006
+++ Configure	Tue Feb 13 19:07:08 2007
@@@@ -3381,6 +3381,20 @@@@ return(0); }
d16 4
d29 1
a29 1
@@@@ -3392,7 +3406,7 @@@@ return(0); }
d34 1
a34 1
+    1020|2050|2060|2070|2080|2090|3000|3010|3020|3030|3040|3050|3060|3070|3080|3090|4000|4010)
@


1.20
log
@Pace with inode/dinode changes by updating to version 4.77, fixes crash
reported by some people, okay jolan@@ and pval@@
@
text
@d1 6
a6 6
$OpenBSD: patch-Configure,v 1.19 2005/12/20 08:13:46 pvalchev Exp $
--- Configure.orig	Mon May 16 19:06:05 2005
+++ Configure	Mon Dec 19 23:57:01 2005
@@@@ -3357,16 +3357,20 @@@@ return(0); }
 	LSOF_TSTBIGF=" "
 	LSOF_VERS=3070
d8 9
a16 1
+      3.8*)
d18 3
a20 1
+	LSOF_VERS=3080
a21 8
       3*)
 	LSOF_TSTBIGF=" "
-	LSOF_VERS=3070
+	LSOF_VERS=3080
 	echo "!!!WARNING!!!  Unsupported OpenBSD 3.x version: $LSOF_VSTR"
-	echo "!!!WARNING!!!  Configuring for OpenBSD 3.7"
+	echo "!!!WARNING!!!  Configuring for OpenBSD 3.8"
 	;;
d24 2
a25 8
-	echo Assuming OpenBSD 3.7
-	LSOF_VERS=3070
+	echo Assuming OpenBSD 3.8
+	LSOF_VERS=3080
 	;;
       esac	# }
     fi	# }
@@@@ -3374,7 +3378,7 @@@@ return(0); }
d29 2
a30 2
-    1020|2050|2060|2070|2080|2090|3000|3010|3020|3030|3040|3050|3060|3070)
+    1020|2050|2060|2070|2080|2090|3000|3010|3020|3030|3040|3050|3060|3070|3080)
@


1.19
log
@- sync with ext2fs dinode changes in -current so this builds/functions
- do not complain about unknown openbsd version..
@
text
@d1 1
a1 1
$OpenBSD$
@


1.18
log
@update to lsof-4.75
@
text
@d1 4
a4 4
$OpenBSD: patch-Configure,v 1.17 2005/03/13 05:02:01 pvalchev Exp $
--- Configure.orig	Wed Oct 15 14:30:40 2003
+++ Configure	Sat Mar 12 22:01:04 2005
@@@@ -2619,6 +2619,22 @@@@ kernel generation process.
d6 1
a6 1
 	LSOF_VERS=3030
d8 1
a8 1
+      3.4*)
d10 1
a10 13
+	LSOF_VERS=3040
+	;;
+      3.5*)
+	LSOF_TSTBIGF=" "
+	LSOF_VERS=3050
+	;;
+      3.6*)
+	LSOF_TSTBIGF=" "
+	LSOF_VERS=3060
+	;;
+      3.7*)
+	LSOF_TSTBIGF=" "
+	LSOF_VERS=3070
d14 16
a29 2
 	LSOF_VERS=3020
@@@@ -2636,7 +2652,7 @@@@ kernel generation process.
d33 2
a34 2
-    1020|2050|2060|2070|2080|2090|3000|3010|3020|3030)
+    1020|2050|2060|2070|2080|2090|3000|3010|3020|3030|3040|3050|3060|3070)
@


1.17
log
@recognise 3.7
@
text
@d1 1
a1 1
$OpenBSD: patch-Configure,v 1.16 2004/08/11 08:14:40 pvalchev Exp $
@


1.16
log
@3.6
@
text
@d1 1
a1 1
$OpenBSD: patch-Configure,v 1.15 2004/01/11 00:14:31 pvalchev Exp $
d3 2
a4 2
+++ Configure	Wed Aug 11 02:10:39 2004
@@@@ -2619,6 +2619,18 @@@@ kernel generation process.
d20 4
d27 1
a27 1
@@@@ -2636,7 +2648,7 @@@@ kernel generation process.
d32 1
a32 1
+    1020|2050|2060|2070|2080|2090|3000|3010|3020|3030|3040|3050|3060)
@


1.15
log
@update to lsof-4.69
@
text
@d1 4
a4 4
$OpenBSD: patch-Configure,v 1.14 2003/08/18 06:32:09 pvalchev Exp $
--- Configure.orig	2003-10-15 14:30:40.000000000 -0600
+++ Configure	2004-01-10 17:00:34.000000000 -0700
@@@@ -2619,6 +2619,10 @@@@ kernel generation process.
d12 8
d23 1
a23 1
@@@@ -2636,7 +2640,7 @@@@ kernel generation process.
d28 1
a28 1
+    1020|2050|2060|2070|2080|2090|3000|3010|3020|3030|3040)
@


1.14
log
@acknowledge 3.4
@
text
@d1 4
a4 4
$OpenBSD$
--- Configure.orig	2003-08-18 00:25:07.000000000 -0600
+++ Configure	2003-08-18 00:25:45.000000000 -0600
@@@@ -2536,6 +2536,10 @@@@ kernel generation process.
d15 1
a15 1
@@@@ -2553,7 +2557,7 @@@@ kernel generation process.
@


1.13
log
@update to lsof-4.68
@
text
@d1 6
a6 6
$OpenBSD: patch-Configure,v 1.12 2003/04/01 22:58:38 pvalchev Exp $
--- Configure.orig	Tue Apr  1 15:39:21 2003
+++ Configure	Tue Apr  1 15:40:23 2003
@@@@ -2495,6 +2495,10 @@@@ kernel generation process.
         LSOF_TSTBIGF=" "
 	LSOF_VERS=3020
d8 3
a10 3
+      3.3*)
+        LSOF_TSTBIGF=" "
+	LSOF_VERS=3030
d13 3
a15 3
 	LSOF_VERS=3010
 	echo "!!!WARNING!!!  Unsupported OpenBSD version: $LSOF_VSTR"
@@@@ -2511,7 +2515,7 @@@@ kernel generation process.
d19 2
a20 2
-    1020|2000|2010|2020|2030|2040|2050|2060|2070|2080|2090|3000|3010|3020)
+    1020|2000|2010|2020|2030|2040|2050|2060|2070|2080|2090|3000|3010|3020|3030)
@


1.12
log
@recognise 3.3
@
text
@d1 1
a1 1
$OpenBSD$
@


1.11
log
@Update to lsof-4.66.
Thanks to the author Vic Abell for integrating patches and cooperating
all the way!
@
text
@d1 4
a4 4
$OpenBSD: patch-Configure,v 1.10 2002/12/12 08:14:24 pvalchev Exp $
--- Configure.orig	Thu Oct 10 05:21:03 2002
+++ Configure	Thu Dec 12 00:28:08 2002
@@@@ -2439,6 +2439,10 @@@@ kernel generation process.
d6 1
a6 1
 	LSOF_VERS=3010
d8 3
a10 3
+      3.2*)
+	LSOF_TSTBIGF=" "
+	LSOF_VERS=3020
d15 1
a15 1
@@@@ -2455,7 +2459,7 @@@@ kernel generation process.
d19 2
a20 2
-    1020|2000|2010|2020|2030|2040|2050|2060|2070|2080|2090|3000|3010)
+    1020|2000|2010|2020|2030|2040|2050|2060|2070|2080|2090|3000|3010|3020)
@


1.10
log
@lsof-4.65
@
text
@d1 1
a1 1
$OpenBSD: patch-Configure,v 1.9 2002/09/15 19:17:16 pvalchev Exp $
@


1.9
log
@Recognise OpenBSD 3.2
@
text
@d1 4
a4 4
$OpenBSD$
--- Configure.orig	Fri Apr 19 14:52:40 2002
+++ Configure	Sun Sep 15 21:08:01 2002
@@@@ -2382,6 +2382,10 @@@@ kernel generation process.
d13 1
a13 1
 	LSOF_VERS=3000
d15 1
a15 1
@@@@ -2398,7 +2402,7 @@@@ kernel generation process.
@


1.8
log
@update to lsof-4.63
@
text
@d1 6
a6 6
$OpenBSD: patch-Configure,v 1.7 2002/03/24 20:26:36 pvalchev Exp $
--- Configure.orig	Tue Jan 22 05:41:44 2002
+++ Configure	Sun Mar 24 13:09:27 2002
@@@@ -2277,10 +2277,13 @@@@ kernel generation process.
       3.0*)
 	LSOF_VERS=3000
d8 3
a10 2
+      3.1*)
+        LSOF_VERS=3010
d13 1
a13 2
-	LSOF_VERS=3000
+	LSOF_VERS=3010
d15 1
a15 6
-	echo "!!!WARNING!!!  Configuring for OpenBSD 3.0"
+	echo "!!!WARNING!!!  Configuring for OpenBSD 3.1"
 	;;
       *)
 	echo "Unknown OpenBSD release: $LSOF_VSTR"
@@@@ -2293,7 +2296,7 @@@@ kernel generation process.
d19 2
a20 2
-    1020|2000|2010|2020|2030|2040|2050|2060|2070|2080|2090|3000)
+    1020|2000|2010|2020|2030|2040|2050|2060|2070|2080|2090|3000|3010)
a23 9
@@@@ -2301,7 +2304,7 @@@@ kernel generation process.
       exit 1
       ;;
     esac	# }
-    LSOF_CFGF="-DOPENBSDV=$LSOF_VERS -DN_UNIXV=/bsd"
+    LSOF_CFGF="-DOPENBSDV=$LSOF_VERS"
     if test -r ${LSOF_INCLUDE}/nfs/nfsproto.h	# {
     then
       LSOF_CFGF="$LSOF_CFGF -DHASNFSPROTO"
@


1.7
log
@recognize 3.1; reminded by brad
@
text
@d1 1
a1 1
$OpenBSD: patch-Configure,v 1.6 2002/01/29 19:40:51 pvalchev Exp $
@


1.6
log
@Read kernel symbols from /dev/ksyms; this way lsof works with kernels with
any names, compressed or not.  Closes PR 2361
@
text
@d1 29
a29 4
$OpenBSD$
--- Configure.orig	Tue Jan 29 12:14:08 2002
+++ Configure	Tue Jan 29 12:14:59 2002
@@@@ -2301,7 +2301,7 @@@@ kernel generation process.
@


1.5
log
@Update to lsof-4.61B.n+obsd
Take maintainership, ok angelos
- Fix uvm kernel detection on ELF archs, enable lsof on them.  Replaced
check with a better one.  Understand how nlist() works.
@
text
@d1 5
a5 19
$OpenBSD: patch-Configure,v 1.4 2001/12/18 03:46:33 pvalchev Exp $
--- Configure.orig	Wed Jun  6 17:28:15 2001
+++ Configure	Sun Dec 16 23:52:01 2001
@@@@ -2068,6 +2068,9 @@@@ kernel generation process.
       2.9*)
 	LSOF_VERS=2090
 	;;
+      3.0*)
+	LSOF_VERS=3000
+	;;
       2*)
 	LSOF_VERS=2080
 	echo "!!!WARNING!!!  Unsupported OpenBSD version: $LSOF_VSTR"
@@@@ -2084,7 +2087,7 @@@@ kernel generation process.
     # Test for legal OpenBSD version.
 
     case $LSOF_VERS in	# {
-    1020|2000|2010|2020|2030|2040|2050|2060|2070|2080|2090)
+    1020|2000|2010|2020|2030|2040|2050|2060|2070|2080|2090|3000)
d7 4
a10 5
     *)
       echo "Unknown OpenBSD version: $LSOF_VERS"
@@@@ -2157,7 +2160,7 @@@@ kernel generation process.
     fi	# }
     if test "X$OPENBSD_UVM" = "X"	# {
d12 1
a12 5
-      nm /bsd | grep -q 'B _uvm$'
+      nm /bsd | egrep -q 'B _uvm$|B uvm$'
       if test $? -eq 0	# {
       then
 	OPENBSD_UVM="Y"
@


1.4
log
@grep for proper kernel symbols for uvm detection, fix ELF-based arches.  ok angelos
@
text
@d1 1
a1 1
$OpenBSD: patch-Configure,v 1.3 2001/12/16 18:40:11 pvalchev Exp $
@


1.3
log
@recognize 3.0, ok naddy
@
text
@d1 3
a3 3
$OpenBSD$
--- Configure.orig	Sun Dec 16 00:11:25 2001
+++ Configure	Sun Dec 16 00:10:44 2001
d23 9
@


1.2
log
@upgrade to lsof 4.52A.n+obsd
@
text
@d1 6
a6 5
--- Configure.orig	Fri Sep  1 21:20:16 2000
+++ Configure	Fri Sep  1 21:21:22 2000
@@@@ -2082,10 +2082,13 @@@@
       2.7*)
 	LSOF_VERS=2070
d8 2
a9 2
+      2.8*)
+	LSOF_VERS=2080
d12 1
a12 2
-	LSOF_VERS=2070
+	LSOF_VERS=2080
d14 1
a14 6
-	echo "!!!WARNING!!!  Configuring for OpenBSD 2.7"
+	echo "!!!WARNING!!!  Configuring for OpenBSD 2.8"
 	;;
       *)
 	echo "Unknown OpenBSD release: $LSOF_VSTR"
@@@@ -2098,7 +2101,7 @@@@
d18 2
a19 2
-    1020|2000|2010|2020|2030|2040|2050|2060|2070)
+    1020|2000|2010|2020|2030|2040|2050|2060|2070|2080)
@


1.1
log
@upgrade to lsof 4.51
@
text
@@

