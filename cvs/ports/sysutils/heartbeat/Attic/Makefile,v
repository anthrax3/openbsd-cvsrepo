head	1.26;
access;
symbols
	OPENBSD_5_1_BASE:1.24
	OPENBSD_5_1:1.24.0.2
	OPENBSD_5_0:1.23.0.2
	OPENBSD_5_0_BASE:1.23
	OPENBSD_4_9:1.21.0.2
	OPENBSD_4_9_BASE:1.21
	OPENBSD_4_8:1.12.0.2
	OPENBSD_4_8_BASE:1.12
	OPENBSD_4_7:1.8.0.2
	OPENBSD_4_7_BASE:1.8
	OPENBSD_4_6:1.7.0.2
	OPENBSD_4_6_BASE:1.7
	OPENBSD_4_5:1.4.0.2
	OPENBSD_4_5_BASE:1.4
	OPENBSD_4_4:1.3.0.2
	OPENBSD_4_4_BASE:1.3
	OPENBSD_4_3:1.2.0.2
	OPENBSD_4_3_BASE:1.2
	ajacoutot_20071121:1.1.1.1
	ajacoutot:1.1.1;
locks; strict;
comment	@# @;


1.26
date	2012.07.11.09.48.07;	author sebastia;	state dead;
branches;
next	1.25;

1.25
date	2012.04.28.10.52.08;	author ajacoutot;	state Exp;
branches;
next	1.24;

1.24
date	2011.09.16.11.41.39;	author espie;	state Exp;
branches;
next	1.23;

1.23
date	2011.05.11.07.45.52;	author ajacoutot;	state Exp;
branches;
next	1.22;

1.22
date	2011.04.15.16.10.38;	author ajacoutot;	state Exp;
branches;
next	1.21;

1.21
date	2010.12.28.15.08.31;	author jasper;	state Exp;
branches;
next	1.20;

1.20
date	2010.11.26.14.56.15;	author espie;	state Exp;
branches;
next	1.19;

1.19
date	2010.11.20.17.22.41;	author espie;	state Exp;
branches;
next	1.18;

1.18
date	2010.11.11.19.00.48;	author espie;	state Exp;
branches;
next	1.17;

1.17
date	2010.11.06.16.07.00;	author espie;	state Exp;
branches;
next	1.16;

1.16
date	2010.10.19.07.43.01;	author espie;	state Exp;
branches;
next	1.15;

1.15
date	2010.09.25.20.45.24;	author steven;	state Exp;
branches;
next	1.14;

1.14
date	2010.09.07.18.26.29;	author kili;	state Exp;
branches;
next	1.13;

1.13
date	2010.08.30.21.52.53;	author fgsch;	state Exp;
branches;
next	1.12;

1.12
date	2010.07.07.13.58.11;	author sebastia;	state Exp;
branches;
next	1.11;

1.11
date	2010.06.18.22.20.03;	author sebastia;	state Exp;
branches;
next	1.10;

1.10
date	2010.04.26.20.09.18;	author steven;	state Exp;
branches;
next	1.9;

1.9
date	2010.04.03.11.54.56;	author kili;	state Exp;
branches;
next	1.8;

1.8
date	2009.10.31.20.27.51;	author naddy;	state Exp;
branches;
next	1.7;

1.7
date	2009.04.26.11.01.05;	author ajacoutot;	state Exp;
branches;
next	1.6;

1.6
date	2009.03.13.11.37.07;	author sthen;	state Exp;
branches;
next	1.5;

1.5
date	2009.03.09.22.42.08;	author sthen;	state Exp;
branches;
next	1.4;

1.4
date	2008.09.18.13.37.41;	author ajacoutot;	state Exp;
branches;
next	1.3;

1.3
date	2008.05.18.15.53.54;	author kili;	state Exp;
branches;
next	1.2;

1.2
date	2007.11.21.23.36.41;	author ajacoutot;	state Exp;
branches;
next	1.1;

1.1
date	2007.11.21.18.48.39;	author ajacoutot;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2007.11.21.18.48.39;	author ajacoutot;	state Exp;
branches;
next	;


desc
@@


1.26
log
@Bye bye heartbeat.
this version in the tree here was old, and got broken due to the
gnutls update. instead of fixing it, get rid of it.

OK aja@@
@
text
@# $OpenBSD: Makefile,v 1.25 2012/04/28 10:52:08 ajacoutot Exp $

SHARED_ONLY=	Yes

COMMENT-main=	Linux HA cluster suite
COMMENT-gui=	GUI management tool for heartbeat
COMMENT-snmp=	snmp agent for heartbeat

DISTNAME=	obs-2.1.2-15
VERSION=	2.1.2.15
PKGNAME=	heartbeat-${VERSION}
PKGNAME-main=	heartbeat-${VERSION}
REVISION-main =	8
PKGNAME-gui=	heartbeat-gui-${VERSION}
REVISION-gui =	6
PKGNAME-snmp=	heartbeat-snmp-${VERSION}
REVISION-snmp =	6

EXTRACT_SUFX=   .tar.bz2
CATEGORIES=     sysutils

SO_VERSION=	0.0
.for _lib in apphb ccmclient cib clm crmcommon hbclient hbmgmtclient \
        hbmgmtcommon hbmgmt hbmgmttls lrm pe_rules pe_status pengine \
	pils plumb plumbgpl recoverymgr stonith stonithd transitioner
SHARED_LIBS+=	${_lib} ${SO_VERSION}
.endfor

HOMEPAGE=	http://www.linux-ha.org
MASTER_SITES=	http://openbsd.dead-parrot.de/distfiles/
MAINTAINER=     Sebastian Reitenbach <sebastia@@openbsd.org>

# GPL/LGPL
PERMIT_PACKAGE_CDROM=   Yes
PERMIT_PACKAGE_FTP=     Yes
PERMIT_DISTFILES_CDROM= Yes
PERMIT_DISTFILES_FTP=   Yes

WANTLIB=	c m pcre pthread util xml2 z

MULTI_PACKAGES=	-main -gui -snmp

MODULES=	devel/gettext lang/python
MODPY_RUNDEP=	No
USE_GROFF =	Yes

BUILD_DEPENDS=	${MODGNU_AUTOCONF_DEPENDS} \
		${MODGNU_AUTOMAKE_DEPENDS} \
		devel/swig

LIB_DEPENDS+=	textproc/libxml

WANTLIB-main=	${WANTLIB} crypto idn ncurses ssl tasn1 \
		e2fs-uuid gnutls>=12 lib/libnet-1.0/net=0 bz2>=10 \
		xml2>=9 ltdl>=4 glib-2.0>=1400 curl>=7 \
		gmp hogweed nettle
LIB_DEPENDS-main=${LIB_DEPENDS} \
		sysutils/e2fsprogs \
		security/gnutls \
		net/libnet/1.0 \
		archivers/bzip2 \
		devel/libtool,-ltdl \
		devel/glib2 \
		net/curl
RUN_DEPENDS-main=${MODPY_RUN_DEPENDS} \
		devel/p5-Time-TimeDate

WANTLIB-gui=	${MODGETTEXT_WANTLIB} m tasn1 util xml2 z \
		bz2>=10 gnutls>=12 ltdl>=4 e2fs-uuid \
		gmp hogweed nettle
LIB_DEPENDS-gui=${LIB_DEPENDS} \
		archivers/bzip2 \
		security/gnutls \
		devel/libtool,-ltdl \
		sysutils/e2fsprogs
RUN_DEPENDS-gui=${MODPY_RUN_DEPENDS} \
		x11/py-gtk2

WANTLIB-snmp=	${WANTLIB} bz2 crypto e2fs-uuid glib-2.0 \
		kvm ltdl perl wrap xml2 ccmclient \
		clm hbclient pils plumb netsnmp>=7 netsnmpagent \
		netsnmpmibs
LIB_DEPENDS-snmp=${LIB_DEPENDS} \
		${BASE_PKGPATH} \
		net/net-snmp

USE_GMAKE=	Yes
# depends on libltdl
USE_LIBTOOL=	gnu
LIBTOOL_FLAGS=	--tag=disable-static

AUTOCONF_VERSION=2.61
AUTOMAKE_VERSION=1.9

WRKDIST=	${WRKDIR}/Heartbeat-Dev-c492f19cb583

HBUSER=		_heartbeat
HBUID=		596
HBGROUP=	_heartbeat
HBGID=		596
SUBST_VARS=	HBUSER HBGROUP HBUID HBGID

CONFIGURE_SCRIPT=ConfigureMe
CONFIGURE_STYLE=gnu
CONFIGURE_ENV=	LIBNETCONFIG=${LOCALBASE}/bin/libnet-config-1.0 \
		LDFLAGS="-liconv -L${LOCALBASE}/lib/libnet-1.0" \
		docdir=${PREFIX}/share/doc/heartbeat \
		AUTOMAKE_VERSION=${AUTOMAKE_VERSION} \
		AUTOCONF_VERSION=${AUTOCONF_VERSION}
CONFIGURE_ARGS=	configure --prefix=${PREFIX} \
		--sysconfdir=${SYSCONFDIR} \
		--with-initdir=${SYSCONFDIR}/ha.d/init.d \
		--with-group-id=${HBGID} \
                --with-ccmuser-id=${HBUID} \
		--with-group-name=${HBGROUP} \
                --with-ccmuser-name=${HBUSER} \
		--with-ocf-root=${PREFIX}/lib/ocf/ \
		--disable-rpath \
		--enable-quorumd \
		--enable-mgmt \
		--enable-snmp \
		--enable-snmp-subagent \
		--enable-fatal-warnings=no \
		--enable-static=no

FAKE_FLAGS=	sysconfdir=${PREFIX}/share/examples/heartbeat \
		initddir=${PREFIX}/share/examples/heartbeat/ha.d/init.d

pre-configure:
	@@perl -pi -e 's,!!LOCALBASE!!,${LOCALBASE},g;' \
		-e 's,!!SYSCONFDIR!!,${SYSCONFDIR},g' \
		${WRKSRC}/configure.in \
		${WRKSRC}/resources/OCF/pgsql \
		${WRKSRC}/resources/OCF/mysql
	@@find ${WRKSRC} -name *.py* -exec \
		perl -pi -e 's,/bin/env python,${MODPY_BIN},g' {} \;

post-install:
	${INSTALL_SCRIPT} ${FILESDIR}/{Telephony,apache13,openvpn} \
		${PREFIX}/lib/ocf/resource.d/heartbeat
	${INSTALL_DATA} ${WRKSRC}/crm/cib-example-1.xml \
		${PREFIX}/share/examples/heartbeat/cib.xml
	@@perl -pi -e 's,!!LOCALBASE!!,${LOCALBASE},g;' \
		-e 's,!!SYSCONFDIR!!,${SYSCONFDIR},g' \
		${PREFIX}/lib/ocf/resource.d/heartbeat/openvpn \
		${PREFIX}/lib/ocf/resource.d/heartbeat/Telephony

.include <bsd.port.mk>
@


1.25
log
@--localstatedir=/var is the default now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2011/09/16 11:41:39 espie Exp $
@


1.24
log
@normalize pkgpath
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2011/05/11 07:45:52 ajacoutot Exp $
a111 1
		--localstatedir=/var \
@


1.23
log
@Sanitize some @@unexec/@@extraunexec calls to rm: move them up in the
PLIST and delete everything under the @@sample'd directory instead of the
directory itself to prevent a warning from pkg_delete(1) trying to
remove a non existing directory and to help preventing left-over files
and directories.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2011/04/15 16:10:38 ajacoutot Exp $
d13 1
a13 1
REVISION-main =	7
d15 1
a15 1
REVISION-gui =	5
d17 1
a17 1
REVISION-snmp =	5
@


1.22
log
@Fix DEPENDS after gnutls update.

ok landry@@ jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2010/12/28 15:08:31 jasper Exp $
d13 1
a13 1
REVISION-main =	6
@


1.21
log
@- make xml2 reachable again
- remove redundant library from WANTLIB-snmp (from sebastia@@)

ok sebastia@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2010/11/26 14:56:15 espie Exp $
d13 1
a13 1
REVISION-main =	5
d15 1
a15 1
REVISION-gui =	4
d17 1
a17 1
REVISION-snmp =	4
d53 1
a53 1
WANTLIB-main=	${WANTLIB} crypto gcrypt gpg-error idn ncurses ssl tasn1 \
d55 2
a56 1
		xml2>=9 ltdl>=4 glib-2.0>=1400 curl>=7
d68 3
a70 2
WANTLIB-gui=	${MODGETTEXT_WANTLIB} gcrypt gpg-error m tasn1 util xml2 z \
		bz2>=10 gnutls>=12 ltdl>=4 e2fs-uuid
d79 2
a80 2
WANTLIB-snmp=	${WANTLIB} bz2 crypto e2fs-uuid gcrypt glib-2.0 gnutls \
		gpg-error kvm ltdl perl tasn1 wrap xml2 ccmclient \
@


1.20
log
@libnet PGKSPEC
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2010/11/20 17:22:41 espie Exp $
d13 1
a13 1
REVISION-main =	4
d15 1
a15 1
REVISION-gui =	2
d17 1
a17 1
REVISION-snmp =	3
d39 1
a39 1
WANTLIB=	c m pcre pthread util z
d51 2
a60 1
		textproc/libxml \
d80 1
a80 1
		netsnmphelpers netsnmpmibs
@


1.19
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2010/11/11 19:00:48 espie Exp $
d57 1
a57 1
		libnet->=1.0,<1.1:net/libnet/1.0 \
@


1.18
log
@last WANTLIB conversion, hopefully
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2010/11/06 16:07:00 espie Exp $
d49 1
a49 1
		::devel/swig
d52 2
a53 2
		e2fs-uuid gnutls.>=12 lib/libnet-1.0/net.=0 bz2.>=10 \
		xml2.>=9 ltdl.>=4 glib-2.0.>=1400 curl.>=7
d55 8
a62 8
		::sysutils/e2fsprogs \
		::security/gnutls \
		:libnet->=1.0,<1.1:net/libnet/1.0 \
		::archivers/bzip2 \
		::textproc/libxml \
		::devel/libtool,-ltdl \
		::devel/glib2 \
		::net/curl
d64 1
a64 1
		::devel/p5-Time-TimeDate
d67 1
a67 1
		bz2.>=10 gnutls.>=12 ltdl.>=4 e2fs-uuid
d69 4
a72 4
		::archivers/bzip2 \
		::security/gnutls \
		::devel/libtool,-ltdl \
		::sysutils/e2fsprogs
d74 1
a74 1
		::x11/py-gtk2
d78 1
a78 1
		clm hbclient pils plumb netsnmp.>=7 netsnmpagent \
d81 2
a82 2
		::${BASE_PKGPATH} \
		::net/net-snmp
@


1.17
log
@move gettext to new WANTLIB
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2010/10/19 07:43:01 espie Exp $
d51 3
a53 1
WANTLIB-main=	${WANTLIB} crypto gcrypt gpg-error idn ncurses ssl tasn1
d55 8
a62 8
		e2fs-uuid::sysutils/e2fsprogs \
		gnutls.>=12::security/gnutls \
		lib/libnet-1.0/net.=0:libnet->=1.0,<1.1:net/libnet/1.0 \
		bz2.>=10::archivers/bzip2 \
		xml2.>=9::textproc/libxml \
		ltdl.>=4::devel/libtool,-ltdl \
		glib-2.0.>=1400::devel/glib2 \
		curl.>=7::net/curl
d66 2
a67 1
WANTLIB-gui=	${MODGETTEXT_WANTLIB} gcrypt gpg-error m tasn1 util xml2 z
d69 4
a72 4
		bz2.>=10::archivers/bzip2 \
		gnutls.>=12::security/gnutls \
		ltdl.>=4::devel/libtool,-ltdl \
		e2fs-uuid::sysutils/e2fsprogs
d77 3
a79 1
		gpg-error kvm ltdl perl tasn1 wrap xml2
d81 2
a82 2
		ccmclient,clm,hbclient,pils,plumb::${BASE_PKGPATH} \
		netsnmp.>=7,netsnmpagent,netsnmphelpers,netsnmpmibs::net/net-snmp
@


1.16
log
@USE_GROFF=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2010/09/25 20:45:24 steven Exp $
d64 1
a64 1
WANTLIB-gui=	gcrypt gpg-error m tasn1 util xml2 z
@


1.15
log
@indicate reason for gnu libtool
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2010/08/30 21:52:53 fgsch Exp $
d45 1
@


1.14
log
@Bring back PKGNAME-main. While here, add pthread to WANTLIB and bump
-main and -snmp.
@
text
@d79 1
@


1.13
log
@More bumps for python.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2010/07/07 13:58:11 sebastia Exp $
d12 2
a13 1
REVISION-main =	3
d17 1
a17 1
REVISION-snmp =	2
d39 1
a39 1
WANTLIB=	c m pcre util z
@


1.12
log
@adapt to the new SO_PEERCRED.
OK sthen@@, landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2010/06/18 22:20:03 sebastia Exp $
d12 5
a16 3
PKGNAME-main=	heartbeat-${VERSION}p2
PKGNAME-gui=	heartbeat-gui-${VERSION}p1
PKGNAME-snmp=	heartbeat-snmp-${VERSION}p1
@


1.11
log
@update my e-mail address, and bump those packages
OK, landry@@, sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2010/04/26 20:09:18 steven Exp $
d12 1
a12 1
PKGNAME-main=	heartbeat-${VERSION}p1
@


1.10
log
@use gnu libtool here for now
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2009/10/31 20:27:51 naddy Exp $
d12 3
a14 3
PKGNAME-main=	heartbeat-${VERSION}p0
PKGNAME-gui=	heartbeat-gui-${VERSION}p0
PKGNAME-snmp=	heartbeat-snmp-${VERSION}p0
d28 1
a28 1
MAINTAINER=     Sebastian Reitenbach <sebastia@@l00-bugdead-prods.de>
@


1.9
log
@Follow e2fsprogs changes, regen PLIST and adjust WANTLIB.

ok and prodded by ajacoutot@@
@
text
@d76 1
a76 1
USE_LIBTOOL=	Yes
@


1.8
log
@* Don't reference yyrcsid[], which yacc doesn't include any longer.
* A hyphen in a package version is illegal.

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2009/04/26 11:01:05 ajacoutot Exp $
d12 3
a14 3
PKGNAME-main=	heartbeat-${VERSION}
PKGNAME-gui=	heartbeat-gui-${VERSION}
PKGNAME-snmp=	heartbeat-snmp-${VERSION}
d49 1
a49 1
		uuid.>=1:e2fs-uuid-*:sysutils/e2fsprogs,-uuid \
d65 1
a65 1
		uuid.>=1:e2fs-uuid-*:sysutils/e2fsprogs,-uuid
d69 2
a70 1
WANTLIB-snmp=	${WANTLIB} bz2 crypto glib-2.0 kvm ltdl perl uuid wrap xml2
@


1.7
log
@CONFIGURE_ENV += PYTHON="${MODPY_BIN}" is inherited from the python module
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2009/03/13 11:37:07 sthen Exp $
d9 2
a10 2
VERSION=	2.1.2-15
DISTNAME=	obs-${VERSION}
d12 2
a13 2
PKGNAME-main=	heartbeat-${VERSION}p1
PKGNAME-gui=	heartbeat-gui-${VERSION}p0
@


1.6
log
@fix libnet LIB_DEPENDS (new pkgspec)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2009/03/09 22:42:08 sthen Exp $
d95 1
a95 2
		AUTOCONF_VERSION=${AUTOCONF_VERSION} \
		PYTHON=${MODPY_BIN}
@


1.5
log
@fix WANTLIB/LIB_DEPENDS, bump packages
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2008/09/18 13:37:41 ajacoutot Exp $
d12 1
a12 1
PKGNAME-main=	heartbeat-${VERSION}p0
d51 1
a51 1
		lib/libnet-1.0/net:libnet-1.0.*:net/libnet/1.0 \
@


1.4
log
@- SYSCONFDIR and LOCALBASE are already part of the generic SUBST_VARS

looks good to landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2008/05/18 15:53:54 kili Exp $
d12 2
a13 2
PKGNAME-main=	heartbeat-${VERSION}
PKGNAME-gui=	heartbeat-gui-${VERSION}
d47 1
a47 1
WANTLIB-main=	${WANTLIB} crypto gcrypt gpg-error idn ncurses ssl
d60 1
a60 1
WANTLIB-gui=	gcrypt gpg-error m util xml2 z
@


1.3
log
@
Upstream changed the distfile, so host the previous on my machine.
asked bt ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2007/11/21 23:36:41 ajacoutot Exp $
d87 1
a87 1
SUBST_VARS=	HBUSER HBGROUP HBUID HBGID SYSCONFDIR
@


1.2
log
@- find install target (no we don't want to install the CVS directory)

spotted by STeve Andre' <andres at msu dot edu>, thanks!
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2007/11/21 18:48:39 ajacoutot Exp $
d27 1
a27 1
MASTER_SITES=	http://hg.linux-ha.org/dev/archive/
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d127 2
a128 1
	${INSTALL_SCRIPT} ${FILESDIR}/* ${PREFIX}/lib/ocf/resource.d/heartbeat
@


1.1.1.1
log
@Import heartbeat-2.1.2-15

The basic goal of the High Availability Linux project is to provide a
high availability (clustering) solution for Linux (and Unix-like) which
promotes reliability, availability, and serviceability (RAS) through a
community development effort.

Inspired from an original submission by Sebastian Reitenbach
(maintainer) whom I want to thank for his work and patience.
@
text
@@
