head	1.2;
access;
symbols
	OPENBSD_6_2:1.2.0.24
	OPENBSD_6_2_BASE:1.2
	OPENBSD_6_1:1.2.0.22
	OPENBSD_6_1_BASE:1.2
	OPENBSD_6_0:1.2.0.20
	OPENBSD_6_0_BASE:1.2
	OPENBSD_5_9:1.2.0.16
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.2.0.18
	OPENBSD_5_8_BASE:1.2
	OPENBSD_5_7:1.2.0.14
	OPENBSD_5_7_BASE:1.2
	OPENBSD_5_6:1.2.0.12
	OPENBSD_5_6_BASE:1.2
	OPENBSD_5_5:1.2.0.10
	OPENBSD_5_5_BASE:1.2
	OPENBSD_5_4:1.2.0.8
	OPENBSD_5_4_BASE:1.2
	OPENBSD_5_3:1.2.0.6
	OPENBSD_5_3_BASE:1.2
	OPENBSD_5_2:1.2.0.4
	OPENBSD_5_2_BASE:1.2
	OPENBSD_5_1_BASE:1.2
	OPENBSD_5_1:1.2.0.2
	OPENBSD_5_0:1.1.0.14
	OPENBSD_5_0_BASE:1.1
	OPENBSD_4_9:1.1.0.12
	OPENBSD_4_9_BASE:1.1
	OPENBSD_4_8:1.1.0.10
	OPENBSD_4_8_BASE:1.1
	OPENBSD_4_7:1.1.0.8
	OPENBSD_4_7_BASE:1.1
	OPENBSD_4_6:1.1.0.6
	OPENBSD_4_6_BASE:1.1
	OPENBSD_4_5:1.1.0.4
	OPENBSD_4_5_BASE:1.1
	OPENBSD_4_4:1.1.0.2
	OPENBSD_4_4_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2011.12.08.13.04.38;	author sthen;	state Exp;
branches;
next	1.1;

1.1
date	2008.06.13.00.38.12;	author canacar;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Fix pftop following pfsync_state changes, reported by jasper@@
@
text
@$OpenBSD: patch-cache_h,v 1.1 2008/06/13 00:38:12 canacar Exp $
--- cache.h.orig	Wed Nov  7 06:34:18 2007
+++ cache.h	Thu Dec  8 13:03:20 2011
@@@@ -31,14 +31,21 @@@@
 struct sc_ent {
         RB_ENTRY(sc_ent)    tlink;
 	TAILQ_ENTRY(sc_ent) qlink;
+#ifdef HAVE_PFSYNC_STATE
+	u_int64_t	    id;
+	u_int32_t	    creatorid;
+#else
 	struct pf_addr      addr[2];
+#endif
 	double		    peak;
 	double		    rate;
 	time_t		    t;
 	u_int32_t	    bytes;
+#ifndef HAVE_PFSYNC_STATE
         u_int16_t           port[2];
         u_int8_t            af;
         u_int8_t            proto;
+#endif
 };
 
 int cache_init(int);
@


1.1
log
@Make pftop build again after the lates pf changes. Filtering against
'gateway' addres/ports does not work (yet) due to the address handling
changes in pf. Other functionality should work. Also fixes two minor
bugs reported by many.  Suggestions and ok naddy@@
@
text
@d1 4
a4 4
$OpenBSD$
--- cache.h.orig	Tue Nov  6 23:34:18 2007
+++ cache.h	Wed Jun 11 19:50:07 2008
@@@@ -31,14 +31,20 @@@@
d9 2
a10 1
+	u_int32_t	    id[2];
@

