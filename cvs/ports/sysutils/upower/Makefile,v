head	1.53;
access;
symbols
	OPENBSD_6_0:1.52.0.2
	OPENBSD_6_0_BASE:1.52
	OPENBSD_5_9:1.49.0.2
	OPENBSD_5_9_BASE:1.49
	OPENBSD_5_8:1.48.0.4
	OPENBSD_5_8_BASE:1.48
	OPENBSD_5_7:1.40.0.2
	OPENBSD_5_7_BASE:1.40
	OPENBSD_5_6:1.37.0.2
	OPENBSD_5_6_BASE:1.37
	OPENBSD_5_5:1.34.0.2
	OPENBSD_5_5_BASE:1.34
	OPENBSD_5_4:1.29.0.2
	OPENBSD_5_4_BASE:1.29
	OPENBSD_5_3:1.22.0.2
	OPENBSD_5_3_BASE:1.22
	OPENBSD_5_2:1.18.0.2
	OPENBSD_5_2_BASE:1.18
	OPENBSD_5_1_BASE:1.15
	OPENBSD_5_1:1.15.0.2
	OPENBSD_5_0:1.10.0.2
	OPENBSD_5_0_BASE:1.10
	landry_20110523:1.1.1.1
	landry:1.1.1;
locks; strict;
comment	@# @;


1.53
date	2016.09.01.10.11.47;	author landry;	state Exp;
branches;
next	1.52;
commitid	aJ9y1R2kzjWxOeEZ;

1.52
date	2016.05.04.11.11.55;	author jasper;	state Exp;
branches;
next	1.51;
commitid	6KDLgBsTKC9qCLQ6;

1.51
date	2016.04.26.12.37.43;	author landry;	state Exp;
branches;
next	1.50;
commitid	YfPO2FYz7DGW0Izs;

1.50
date	2016.03.11.20.28.32;	author naddy;	state Exp;
branches;
next	1.49;
commitid	UYLP8TE6V7RS2GhJ;

1.49
date	2015.10.24.09.18.13;	author ajacoutot;	state Exp;
branches;
next	1.48;
commitid	bVbBbScpUnHNNm9z;

1.48
date	2015.05.30.07.26.09;	author ajacoutot;	state Exp;
branches;
next	1.47;
commitid	RDA2U7EG5hjdpeB5;

1.47
date	2015.04.04.09.36.37;	author ajacoutot;	state Exp;
branches;
next	1.46;
commitid	Dga8Cwfbantp8VkD;

1.46
date	2015.04.04.09.30.30;	author ajacoutot;	state Exp;
branches;
next	1.45;
commitid	QSLndtZiU46ysFLn;

1.45
date	2015.04.04.09.21.04;	author ajacoutot;	state Exp;
branches;
next	1.44;
commitid	kS3kwKZogsvzYmEY;

1.44
date	2015.04.03.12.08.10;	author landry;	state Exp;
branches;
next	1.43;
commitid	H8kXBXcxsmzBYfB9;

1.43
date	2015.04.02.19.21.24;	author ajacoutot;	state Exp;
branches;
next	1.42;
commitid	IzOYoGfSkzfoNImk;

1.42
date	2015.04.02.19.18.30;	author landry;	state Exp;
branches;
next	1.41;
commitid	SDUqGl07blU8MvyJ;

1.41
date	2015.03.27.16.03.33;	author ajacoutot;	state Exp;
branches;
next	1.40;
commitid	nMHFNncq8zyoaSAu;

1.40
date	2014.12.19.23.50.27;	author landry;	state Exp;
branches;
next	1.39;
commitid	gvd2NhLZyM3smtpH;

1.39
date	2014.09.13.16.36.54;	author ajacoutot;	state Exp;
branches;
next	1.38;
commitid	N2TalFGi4jKRwS2u;

1.38
date	2014.09.02.19.23.33;	author landry;	state Exp;
branches;
next	1.37;
commitid	eWxywLRr5QiCKfmS;

1.37
date	2014.05.23.19.21.06;	author landry;	state Exp;
branches;
next	1.36;

1.36
date	2014.04.20.18.03.23;	author jasper;	state Exp;
branches;
next	1.35;

1.35
date	2014.03.27.07.59.35;	author jasper;	state Exp;
branches;
next	1.34;

1.34
date	2013.10.18.16.43.50;	author landry;	state Exp;
branches;
next	1.33;

1.33
date	2013.10.12.08.10.13;	author ajacoutot;	state Exp;
branches;
next	1.32;

1.32
date	2013.10.03.13.42.16;	author landry;	state Exp;
branches;
next	1.31;

1.31
date	2013.10.03.10.52.59;	author jasper;	state Exp;
branches;
next	1.30;

1.30
date	2013.08.11.14.11.38;	author ajacoutot;	state Exp;
branches;
next	1.29;

1.29
date	2013.04.29.13.34.51;	author giovanni;	state Exp;
branches;
next	1.28;

1.28
date	2013.04.06.08.48.50;	author ajacoutot;	state Exp;
branches;
next	1.27;

1.27
date	2013.03.30.14.53.53;	author ajacoutot;	state Exp;
branches;
next	1.26;

1.26
date	2013.03.29.12.41.26;	author ajacoutot;	state Exp;
branches;
next	1.25;

1.25
date	2013.03.27.07.23.45;	author ajacoutot;	state Exp;
branches;
next	1.24;

1.24
date	2013.03.21.08.48.54;	author ajacoutot;	state Exp;
branches;
next	1.23;

1.23
date	2013.03.11.11.41.33;	author espie;	state Exp;
branches;
next	1.22;

1.22
date	2012.09.27.17.26.05;	author ajacoutot;	state Exp;
branches;
next	1.21;

1.21
date	2012.09.21.14.48.06;	author ajacoutot;	state Exp;
branches;
next	1.20;

1.20
date	2012.09.04.09.06.12;	author ajacoutot;	state Exp;
branches;
next	1.19;

1.19
date	2012.08.21.17.27.13;	author ajacoutot;	state Exp;
branches;
next	1.18;

1.18
date	2012.06.27.06.39.50;	author landry;	state Exp;
branches;
next	1.17;

1.17
date	2012.03.03.17.30.17;	author ajacoutot;	state Exp;
branches;
next	1.16;

1.16
date	2012.03.03.17.09.14;	author espie;	state Exp;
branches;
next	1.15;

1.15
date	2012.01.03.21.50.06;	author landry;	state Exp;
branches;
next	1.14;

1.14
date	2012.01.02.15.13.19;	author ajacoutot;	state Exp;
branches;
next	1.13;

1.13
date	2011.10.16.06.29.30;	author ajacoutot;	state Exp;
branches;
next	1.12;

1.12
date	2011.10.03.06.42.46;	author ajacoutot;	state Exp;
branches;
next	1.11;

1.11
date	2011.09.08.17.57.40;	author ajacoutot;	state Exp;
branches;
next	1.10;

1.10
date	2011.07.08.08.16.09;	author dcoppa;	state Exp;
branches;
next	1.9;

1.9
date	2011.07.07.19.02.43;	author dcoppa;	state Exp;
branches;
next	1.8;

1.8
date	2011.07.04.17.44.27;	author dcoppa;	state Exp;
branches;
next	1.7;

1.7
date	2011.06.17.15.08.36;	author landry;	state Exp;
branches;
next	1.6;

1.6
date	2011.06.02.17.09.32;	author kili;	state Exp;
branches;
next	1.5;

1.5
date	2011.06.02.13.41.41;	author ajacoutot;	state Exp;
branches;
next	1.4;

1.4
date	2011.05.30.07.48.53;	author landry;	state Exp;
branches;
next	1.3;

1.3
date	2011.05.24.16.02.39;	author ajacoutot;	state Exp;
branches;
next	1.2;

1.2
date	2011.05.24.07.47.52;	author jasper;	state Exp;
branches;
next	1.1;

1.1
date	2011.05.23.19.04.57;	author landry;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2011.05.23.19.04.57;	author landry;	state Exp;
branches;
next	;


desc
@@


1.53
log
@Add proper error and cancellable handling to UpClient constructor

Backport https://cgit.freedesktop.org/upower/patch/?id=932a6a39e35754be571e1274aec4730fd42dba13
from https://bugs.freedesktop.org/show_bug.cgi?id=95350

First part of a larger fix for xfsettingsd crashes when systemwide dbus
isn't running.

ok/testing edd@@
@
text
@# $OpenBSD: Makefile,v 1.52 2016/05/04 11:11:55 jasper Exp $

ONLY_FOR_ARCHS =${APM_ARCHS}

COMMENT =	userland power management interface

DISTNAME =	upower-0.99.4
REVISION =	1
EXTRACT_SUFX =	.tar.xz
CATEGORIES =	sysutils
SHARED_LIBS +=  upower-glib          2.1      # 3.1

HOMEPAGE =	http://upower.freedesktop.org/
MASTER_SITES =	${HOMEPAGE}/releases/

MAINTAINER =	Landry Breuil <landry@@openbsd.org>

# GPLv2+
PERMIT_PACKAGE_CDROM=	Yes

WANTLIB += c gio-2.0 glib-2.0 gobject-2.0 m pthread

CONFIGURE_STYLE =	gnu
CONFIGURE_ARGS +=	--enable-introspection \
			--enable-man-pages \
			--with-historydir=/var/db/upower \
			--with-backend=openbsd \
			--without-idevice

CONFIGURE_ENV+=	CPPFLAGS="-I${LOCALBASE}/include" \
		LDFLAGS="-L${LOCALBASE}/lib"

FAKE_FLAGS =	sysconfdir=${PREFIX}/share/examples/upower

USE_GMAKE =	Yes

MODULES =	textproc/intltool

LIB_DEPENDS =	devel/glib2
BUILD_DEPENDS =	devel/gobject-introspection \
		textproc/docbook-xsl

# /usr/local/share/dbus-1/system-services/
RUN_DEPENDS +=	x11/dbus,-suid

.include <bsd.port.mk>
@


1.52
log
@Remove pointless upperbound, SENSOR_MAX_TYPES has no meaning here and we
break from the loop anyway when needed (when ENOENT is returned). This makes
it in line with other sensor walkers.

ok landry@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 2016/04/26 12:37:43 landry Exp $
d8 1
a8 1
REVISION =	0
d11 1
a11 1
SHARED_LIBS +=  upower-glib          2.0      # 3.1
@


1.51
log
@Updqte to upower 0.99.4

https://lists.freedesktop.org/archives/devkit-devel/2016-February/001751.html

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2016/03/11 20:28:32 naddy Exp $
d8 1
@


1.50
log
@garbage collect CONFIGURE_SHARED
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2015/10/24 09:18:13 ajacoutot Exp $
d7 1
a7 1
DISTNAME =	upower-0.99.3
d10 1
a10 2
SHARED_LIBS +=  upower-glib          1.0      # 3.1
REVISION =	0
d20 1
a20 2
WANTLIB += c dbus-1 dbus-glib-1 gio-2.0 glib-2.0 gobject-2.0 m
WANTLIB += pthread
d38 1
a38 1
LIB_DEPENDS =	x11/dbus-glib
@


1.49
log
@Consistency: rcctl enable is the most used idiom within the ports tree.
Also since we can pass it several daemons now, simplify enabling:
- before
rcctl enable foo
rcctl enable bar
rcctl enable bla
- after
rcctl enable foo bar bla
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2015/05/30 07:26:09 ajacoutot Exp $
d25 1
a25 2
CONFIGURE_ARGS +=	${CONFIGURE_SHARED} \
			--enable-introspection \
@


1.48
log
@Update to upower-0.99.3.

ok landry@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2015/04/04 09:36:37 ajacoutot Exp $
d11 1
@


1.47
log
@dbus_daemon -> messagebus
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2015/04/04 09:30:30 ajacoutot Exp $
d7 1
a7 1
DISTNAME =	upower-0.99.2
d10 1
a10 2
SHARED_LIBS +=  upower-glib               1.0 # 2.0
REVISION =	6
@


1.46
log
@These need to RUN_DEPENDS on x11/dbus,-suid now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2015/04/04 09:21:04 ajacoutot Exp $
d11 1
a11 1
REVISION =	5
@


1.45
log
@Bump after the recent changes in packaging dbus and dconf.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2015/04/03 12:08:10 landry Exp $
d11 1
a11 1
REVISION =	4
d44 3
@


1.44
log
@Add a patch to improve error handling when the systemwide dbus is not
running. Applications using libupower-glib should "gracefully" handle that
situation now...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2015/04/02 19:21:24 ajacoutot Exp $
d11 1
a11 1
REVISION =	3
@


1.43
log
@space
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2015/04/02 19:18:30 landry Exp $
d11 1
a11 1
REVISION =	2
@


1.42
log
@Mention that systemwide dbus daemon needs to be running for proper
upower behaviour. Use rcctl commands while here...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2015/03/27 16:03:33 ajacoutot Exp $
d11 1
a11 1
REVISION =	1
@


1.41
log
@Fix crash on uninitialized variant with new GLib.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2014/12/19 23:50:27 landry Exp $
d11 1
a11 1
REVISION =	0
@


1.40
log
@Bugfix update to upower 0.99.2.

See http://lists.freedesktop.org/archives/devkit-devel/2014-December/001653.html
for the list of changes (lots of memleaks fixed, update display device
when battery is removed, etc..)
xfce4-power-manager seems happy with it, upower -d reports correct
values, and gnome-power-statistics still display a nice graph.

Reminded by ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2014/09/13 16:36:54 ajacoutot Exp $
d11 1
@


1.39
log
@--disable-gtk-doc is handled by the infrastructure now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2014/09/02 19:23:33 landry Exp $
d7 1
a7 1
DISTNAME =	upower-0.99.1
@


1.38
log
@Update to upower 0.99.1.

Remove patch merged upstream, and now useless dep on polkit.
ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2014/05/23 19:21:06 landry Exp $
a24 1
			--disable-gtk-doc \
a32 6

# If one of these tools is found at configure stage, it might be used,
# no matter whether we use --disable-gtk-doc or not.
CONFIGURE_ENV +=ac_cv_path_GTKDOC_CHECK="" \
		ac_cv_path_GTKDOC_REBASE="" \
		ac_cv_path_GTKDOC_MKPDF=""
@


1.37
log
@Add EnergyFullDesign and Capacity properties, getting them via the new
acpibat sensor reporting the 'design capacity' of the battery. Fixes a
wrong notification about having a broken battery in KDE4.

From Fabian Raetz, thanks!
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2014/04/20 18:03:23 jasper Exp $
d7 1
a7 2
DISTNAME =	upower-0.99.0
REVISION =	1
d20 1
a20 1
WANTLIB += c dbus-1 dbus-glib-1 gio-2.0 glib-2.0 gobject-2.0 m polkit-gobject-1
a31 5
# XXX enable deprecated features such as hibernate/suspend trigger
# see http://lists.freedesktop.org/archives/devkit-devel/2013-January/001339.html
# unrelated to G*DEPRECATED macros
CONFIGURE_ARGS +=	--enable-deprecated

d47 1
a47 2
LIB_DEPENDS =	sysutils/polkit>=0.101 \
		x11/dbus-glib
a49 3

# polkit(8) almost always needs to know the "active" session
RUN_DEPENDS +=	sysutils/consolekit
@


1.36
log
@add a way to recognize the lid (wether it's present, open/closed). thanks to
landry for finding the "right" spot to hook it up.

ok landry@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2014/03/27 07:59:35 jasper Exp $
d8 1
a8 1
REVISION =	0
@


1.35
log
@- update to upower-0.99.0

there will be some fallout due to major API changes, but they will be dealt with
today as the offenders (gnome-related) will be updated.

ok landry@@ (MAINTAINER), aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2013/10/18 16:43:50 landry Exp $
d8 1
@


1.34
log
@Straightforward update to upower 0.9.23, mostly integrating our patches
before giving us the middle finger with the next release relying on
logind for hibernate/suspend code, thus deliberately breaking perfectly
working portable code, see
http://lists.freedesktop.org/archives/devkit-devel/2013-October/001519.html
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2013/10/12 08:10:13 ajacoutot Exp $
d7 1
a7 1
DISTNAME =	upower-0.9.23
d10 1
a10 1
SHARED_LIBS +=  upower-glib               0.0 # 1.2
d20 1
a20 1
WANTLIB += c dbus-1 dbus-glib-1 glib-2.0 gobject-2.0 m polkit-gobject-1
@


1.33
log
@Update to upower-0.9.22.

ok landry@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2013/10/03 13:42:16 landry Exp $
d7 1
a7 1
DISTNAME =	upower-0.9.22
@


1.32
log
@Assorted fixes on top of jasper's:

- use --enable-deprecated instead of passing -DENABLE_DEPRECATED via the
  configure env, and add a comment explaining that it is about
deprecated featureset (the linux implem now uses logind APIs for
suspend/hibernate calls), nothing related to the G*DEPRECATED macros.
From ajacoutot@@, also prodded by giovanni@@ a while ago.
- backport upstream 7933b0e55234fca86809dad1dee53f0d8e2b96ec,
  g_type_init() is deprecated with glib 2.36.
- use g_thread_try_new instead of deprecated g_thread_create (prodded by
  ajacoutot@@ too)
- include config.h in up-backend.h to reach ENABLE_DEPRECATED #define
The two last patches reported upstream in bug #70071
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2013/10/03 10:52:59 jasper Exp $
d7 1
a7 2
DISTNAME =	upower-0.9.21
REVISION =	1
@


1.31
log
@Two fixes for the OpenBSD-backend:
- Recognize a battery not being present (and reset various metrics accordingly)
- Recognize a fully charged battery

as discussed with and OK landry@@ (MAINTAINER), aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2013/08/11 14:11:38 ajacoutot Exp $
d8 1
a8 1
REVISION =	0
d33 6
a38 1
CONFIGURE_ENV+=	CPPFLAGS="-I${LOCALBASE}/include -DENABLE_DEPRECATED" \
@


1.30
log
@Update to upower-0.9.21.

ok landry@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2013/04/29 13:34:51 giovanni Exp $
d8 1
@


1.29
log
@
Enable deprecated code, newer upower relies on newer interfaces
(logind, systemd or something else), will be discussed upstream later.
This lets suspend from xfce menu work again.
ok landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2013/04/06 08:48:50 ajacoutot Exp $
d7 1
a7 1
DISTNAME =	upower-0.9.20
a10 1
REVISION =	2
a25 1
			--disable-systemd \
@


1.28
log
@Remove /var/db/upower/history-* at @@extraunexec time.

ok landry@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2013/03/30 14:53:53 ajacoutot Exp $
d11 1
a11 1
REVISION =	1
d34 1
a34 1
CONFIGURE_ENV+=	CPPFLAGS="-I${LOCALBASE}/include" \
@


1.27
log
@polkit(8) mostly always requires consolekit; unfortunately the dependency
cannot be added to polkit itself since it would create a cyclic dep; so we
add it to ports depending on polkit.

ok landry@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2013/03/29 12:41:26 ajacoutot Exp $
d11 1
a11 1
REVISION =	0
@


1.26
log
@Update to upower-0.9.20.

ok landry@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2013/03/27 07:23:45 ajacoutot Exp $
d11 1
d53 3
@


1.25
log
@g_thread_init is deprecated and will be removed in the next glib2 version
which I am currently working on.
While here, regen WANTLIB and merge PLISTs.

ok landry@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2013/03/21 08:48:54 ajacoutot Exp $
d7 1
a7 1
DISTNAME =	upower-0.9.18
d10 1
a10 2
SHARED_LIBS +=  upower-glib               0.0 # 1.1
REVISION =	1
@


1.24
log
@USE_LIBTOOL=Yes is the default now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2013/03/11 11:41:33 espie Exp $
d11 1
a11 1
REVISION =	0
d18 1
a18 1
#GPLv2+
d21 3
a52 3

WANTLIB += c dbus-1 dbus-glib-1 glib-2.0 gobject-2.0 gthread-2.0
WANTLIB += m polkit-gobject-1 pthread
@


1.23
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2012/09/27 17:26:05 ajacoutot Exp $
a42 1
USE_LIBTOOL =	Yes
@


1.22
log
@docbook-xsl already comes with libxslt.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2012/09/21 14:48:06 ajacoutot Exp $
a19 3
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
@


1.21
log
@Stupid autohell is stupid...
The situation is this: even when we --disable-gtk-doc, if gtk-doc is
actually installed at configure stage, tools like gtkdoc-rebase will be
picked up and run during the install target. That is bad because the
gtk-doc package may have been removed by then, especially during dpb(1)
bulks (we explicitely disable support for it so why should it stay...).

So for now, let's add the following env to configure whenever we use
--disable-gtk-doc, until a bettersolution is found...
CONFIGURE_ENV +=ac_cv_path_GTKDOC_CHECK="" \
		ac_cv_path_GTKDOC_REBASE="" \
		ac_cv_path_GTKDOC_MKPDF=""
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2012/09/04 09:06:12 ajacoutot Exp $
a52 1
		textproc/libxslt,-main \
@


1.20
log
@Remove --as-needed and -pthread patches.

ok landry@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2012/08/21 17:27:13 ajacoutot Exp $
d36 7
@


1.19
log
@Update to upower-0.9.18.

ok landry@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2012/06/27 06:39:50 landry Exp $
d11 1
d41 1
a41 2
MODULES =	devel/gettext \
		textproc/intltool
d50 1
a50 1
WANTLIB += m polkit-gobject-1 pthread ffi gio-2.0 gmodule-2.0 pcre z
@


1.18
log
@Update to upower 0.9.17

Note that now by default, upowerd will run apm -C when running
on battery and apm -A when on AC, this can be disabled by setting
RunPowersaveCommand to false in etc/UPower/UPower.conf.

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2012/03/03 17:30:17 ajacoutot Exp $
d7 1
a7 1
DISTNAME =	upower-0.9.17
d26 1
@


1.17
log
@Revert previous and add textproc/intltool MODULE.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2012/03/03 17:09:14 espie Exp $
d7 1
a7 1
DISTNAME =	upower-0.9.15
@


1.16
log
@fix build
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2012/01/03 21:50:06 landry Exp $
d39 2
a40 1
MODULES =	devel/gettext
d46 1
a46 2
		textproc/docbook-xsl \
		textproc/intltool
@


1.15
log
@Update to upower 0.9.15 :
- remove history dir patches merged upstream
- fix deps wrt gettext module, update plist accordingly
- fix rate value, was wrong since last commit to acpibat.c
ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2012/01/02 15:13:19 ajacoutot Exp $
d45 2
a46 1
		textproc/docbook-xsl
@


1.14
log
@Don't pass --as-needed to unbreak upower(1).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2011/10/16 06:29:30 ajacoutot Exp $
d7 1
a7 1
DISTNAME =	upower-0.9.14
a11 2
REVISION =	0

d28 1
d39 1
a39 1
MODULES =	textproc/intltool
d45 1
a45 2
		textproc/docbook-xsl \
		devel/gettext
d48 1
a48 1
WANTLIB += m polkit-gobject-1 pthread
@


1.13
log
@Minor update to upower-0.9.14.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2011/10/03 06:42:46 ajacoutot Exp $
d11 2
@


1.12
log
@Set DATADIRNAME in a consistent way now that glib-gettext.m4 has been
fixed.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2011/09/08 17:57:40 ajacoutot Exp $
d7 1
a7 1
DISTNAME =	upower-0.9.13
a10 1
REVISION =	0
@


1.11
log
@Bugfix update to upower-0.9.13.

ok landry@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2011/07/08 08:16:09 dcoppa Exp $
d11 1
d34 1
a34 2
FAKE_FLAGS =	sysconfdir=${PREFIX}/share/examples/upower \
		itlocaledir="${PREFIX}/share/locale/"
@


1.10
log
@Make upower behave like apmd (check for minutes_left to be > 0, not >= 0)
While here, reword comment a little bit.

OK ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2011/07/07 19:02:43 dcoppa Exp $
d7 1
a7 2
DISTNAME =	upower-0.9.12
REVISION =	0
d33 2
a34 1
FAKE_FLAGS =	sysconfdir=${PREFIX}/share/examples/upower
d39 1
a39 2
MODULES =	devel/gettext \
		textproc/intltool
d45 2
a46 1
		textproc/docbook-xsl
d48 2
a49 3
WANTLIB =	c dbus-1 dbus-glib-1 glib-2.0 gobject-2.0 m \
		polkit-gobject-1 pthread gthread-2.0 gio-2.0 \
		gmodule-2.0 pcre z
@


1.9
log
@Update to upower-0.9.12 plus fixes.

Discussed with and OK landry@@, ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2011/07/04 17:44:27 dcoppa Exp $
d8 1
@


1.8
log
@Add missed build dependency on gobject-introspection

OK ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2011/06/17 15:08:36 landry Exp $
d7 2
a8 1
DISTNAME =	upower-0.9.11
a10 2

REVISION =		1
@


1.7
log
@Fix history in upower :
- don't try to fetch from dev/apm if the fd isn't available yet (to be
  discussed with upstream)
- use var/db/upower to store history files

Fixes graphs in gnome-power-statistics...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2011/06/02 17:09:32 kili Exp $
d44 2
a45 1
BUILD_DEPENDS =	textproc/libxslt,-main \
@


1.6
log
@--disable-silent-rules is now added to CONFIGURE_ARGS per default,
if CONFIGURE_STYLE = gnu.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2011/06/02 13:41:41 ajacoutot Exp $
d11 1
a11 1
REVISION =		0
@


1.5
log
@Add a consistent header that substitutes FULLPKGNAME for the READMEs.

ok jasper@@ sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2011/05/30 07:48:53 landry Exp $
a25 1
			--disable-silent-rules \
@


1.4
log
@Update to upower 0.9.11, remove patches merged upstream, add a patch
from jasper@@ to fix an implicit declaration warning (pushed upstream)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2011/05/24 16:02:39 ajacoutot Exp $
d10 2
@


1.3
log
@Add obvious as it may seem, do notify that apmd(8) needs to be running
to access the full set of uPower functionnalities.

ok landry@@ (maintainer) jasper@@ (on a former diff)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2011/05/24 07:47:52 jasper Exp $
d7 1
a7 1
DISTNAME =	upower-0.9.10
a10 2
REVISION =	0

a48 3

post-extract:
	cp ${FILESDIR}/up-apm-native.h ${WRKSRC}/src/openbsd
@


1.2
log
@Add missing ONLY_FOR_ARCHS =${APM_ARCHS} to upower (and gnome-session
as upower is integrated into it).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2011/05/23 19:04:57 landry Exp $
d10 2
@


1.1
log
@Initial revision
@
text
@d1 3
a3 1
# $OpenBSD$
@


1.1.1.1
log
@Import upower 0.9.10:

UPower is an abstraction for enumerating power devices, listening to
device events and querying history and statistics. Any application or
service on the system can access the org.freedesktop.UPower service
via the DBUS system message bus.

OpenBSD specific backend written by yours truly with help from upstream
developer. So far, battery levels and ac status works, using either apm
or acpibat/acpiac if available.

As a sidenote, if udev, udisks and friends were designed with the same
clear separation between os-specific and generic parts, porting to
'alternative OSes' would be much simpler. UPower is a nice example of
'how to design a portable service'.

with a patch for glib version check, tweaks and ok ajacoutot@@
@
text
@@
