head	1.25;
access;
symbols
	OPENBSD_5_9:1.20.0.2
	OPENBSD_5_9_BASE:1.20
	OPENBSD_5_8:1.15.0.4
	OPENBSD_5_8_BASE:1.15
	OPENBSD_5_7:1.3.0.2
	OPENBSD_5_7_BASE:1.3
	jasper_20141612:1.1.1.1
	jasper:1.1.1;
locks; strict;
comment	@# @;


1.25
date	2016.04.26.13.31.25;	author jasper;	state dead;
branches;
next	1.24;
commitid	fgwEtuNzADtyo5m5;

1.24
date	2016.04.26.11.13.40;	author jasper;	state Exp;
branches;
next	1.23;
commitid	Idse0rE3qZpbyAKr;

1.23
date	2016.04.11.13.17.11;	author jasper;	state Exp;
branches;
next	1.22;
commitid	Y0i0XBSrd7kAPtdY;

1.22
date	2016.04.01.11.05.45;	author jasper;	state Exp;
branches;
next	1.21;
commitid	XZpg1UDnUVybbAV9;

1.21
date	2016.03.16.13.02.33;	author jasper;	state Exp;
branches;
next	1.20;
commitid	ZwTmVYzHgJ4r24Dh;

1.20
date	2015.12.09.11.39.14;	author jasper;	state Exp;
branches;
next	1.19;
commitid	3MGv9zOirGpOD0r0;

1.19
date	2015.12.08.09.20.24;	author jasper;	state Exp;
branches;
next	1.18;
commitid	5k7GcdaSQeNOCFFt;

1.18
date	2015.11.26.10.59.59;	author jasper;	state Exp;
branches;
next	1.17;
commitid	8t9DHawSouR38jrc;

1.17
date	2015.11.16.19.02.25;	author jasper;	state Exp;
branches;
next	1.16;
commitid	N5oE19yyO5Pg57tR;

1.16
date	2015.09.06.08.29.39;	author jasper;	state Exp;
branches;
next	1.15;
commitid	kxgcKpyabW1BgDJi;

1.15
date	2015.07.30.07.53.26;	author jasper;	state Exp;
branches;
next	1.14;
commitid	k4oUrnCu3KigMgNP;

1.14
date	2015.07.18.05.49.27;	author ajacoutot;	state Exp;
branches;
next	1.13;
commitid	G9ZrykCvdlMIZOeF;

1.13
date	2015.07.16.17.24.39;	author jeremy;	state Exp;
branches;
next	1.12;
commitid	iDLjyGIt3molZTfH;

1.12
date	2015.07.16.01.07.06;	author jeremy;	state Exp;
branches;
next	1.11;
commitid	G7boL4TeTiNH6L5u;

1.11
date	2015.07.02.18.06.02;	author jasper;	state Exp;
branches;
next	1.10;
commitid	H3YG1x6x6pfvhHHU;

1.10
date	2015.06.10.13.25.32;	author jasper;	state Exp;
branches;
next	1.9;
commitid	hPMEZJyGBtlwpKgL;

1.9
date	2015.05.17.10.30.59;	author jasper;	state Exp;
branches;
next	1.8;
commitid	yy1sp1Vmipk3cu4L;

1.8
date	2015.05.17.10.28.35;	author jasper;	state Exp;
branches;
next	1.7;
commitid	fhLDeMHfWj6G05AL;

1.7
date	2015.05.15.07.34.10;	author jasper;	state Exp;
branches;
next	1.6;
commitid	bPioJ0kvYhgQz2L9;

1.6
date	2015.05.14.12.17.58;	author jasper;	state Exp;
branches;
next	1.5;
commitid	g6xIxkh2C7gLyKYc;

1.5
date	2015.05.08.09.08.44;	author espie;	state Exp;
branches;
next	1.4;
commitid	8WaxsMNN6opOzn9t;

1.4
date	2015.04.26.19.02.57;	author jasper;	state Exp;
branches;
next	1.3;
commitid	Cp83CPsFNJPN6K2y;

1.3
date	2014.12.20.12.28.04;	author jasper;	state Exp;
branches;
next	1.2;
commitid	aWN1xaxcwEtyu59X;

1.2
date	2014.12.19.14.06.32;	author jasper;	state Exp;
branches;
next	1.1;
commitid	O68WyzdioFimDsWh;

1.1
date	2014.12.16.18.10.58;	author jasper;	state Exp;
branches
	1.1.1.1;
next	;
commitid	PwD4RWeX2cvjAwU5;

1.1.1.1
date	2014.12.16.18.10.58;	author jasper;	state Exp;
branches;
next	;
commitid	PwD4RWeX2cvjAwU5;


desc
@@


1.25
log
@- no need to keep logstash in a subdir anymore
- update HOMEPAGE while here
@
text
@# $OpenBSD: Makefile,v 1.24 2016/04/26 11:13:40 jasper Exp $

COMMENT=		tool for managing events and logs

V=			2.3.2
DISTNAME=		logstash-$V
PKGNAME=		logstash-${V:S/-/./}
EPOCH=			0

MASTER_SITES=		https://download.elastic.co/logstash/logstash/

MODULES=		java
MODJAVA_VER=		1.8+
MODJAVA_JRERUN=		Yes

RUN_DEPENDS=		java/javaPathHelper \
			lang/jruby \
			shells/bash

NO_TEST=		Yes

LS_BASE=		${PREFIX}/logstash/

JFFI_ARCH=		${MACHINE_ARCH:S/amd64/x86_64/}-OpenBSD
SUBST_VARS=		JFFI_ARCH

# with NO_BUILD defined JAVA_HOME won't get set, so this is as close as we'll
# get to "building". Wipe the jruby vendor directory as we'll later link to
# the system jruby.
do-build:
	-rm -rf ${WRKSRC}/vendor/bundle/jruby/1.9/gems/childprocess-0.5.9/lib/childprocess/unix/platform
	-rm -r ${WRKSRC}/vendor/jruby/lib/jni
	-rm -rf ${WRKSRC}/vendor/jruby/lib/ruby/shared/ffi/platform/i386-{darwin,freebsd,linux,solaris,windows}
	-rm -rf ${WRKSRC}/vendor/jruby/lib/ruby/shared/ffi/platform/{i486-gnu,mips*}
	-rm -rf ${WRKSRC}/vendor/jruby/lib/ruby/shared/ffi/platform/powerpc-{aix,darwin,linux}
	-rm -rf ${WRKSRC}/vendor/jruby/lib/ruby/shared/ffi/platform/{ppc*,s390*,sparc*}
	-rm -rf ${WRKSRC}/vendor/jruby/lib/ruby/shared/ffi/platform/x86_64-{darwin,freebsd,linux,solaris,windows}
	${SUBST_CMD} ${WRKSRC}/bin/logstash.lib.sh
	@@# apply hammer to fixup weird modes
	find ${WRKSRC}/vendor/ -type f -exec chmod 0644 {} \;
	find ${WRKSRC} -name '*.orig' -print0 | xargs -0r rm
	chmod 755 ${WRKSRC}/vendor/jruby/bin/*

do-install:
	${INSTALL_DATA_DIR} ${LS_BASE}/{bin,lib,vendor}/
	${INSTALL_DATA} ${WRKSRC}/Gemfile* ${LS_BASE}
.for b in logstash logstash.lib.sh plugin
	${INSTALL_SCRIPT} ${WRKSRC}/bin/$b ${LS_BASE}/bin/
.endfor
	cd ${WRKSRC} && cp -R lib vendor ${LS_BASE}
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/logstash/
	${SUBST_CMD} -m 0644 -c ${FILESDIR}/logstash.conf \
		${PREFIX}/share/examples/logstash/logstash.conf

.include <bsd.port.mk>
@


1.24
log
@update to logstash-2.3.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2016/04/11 13:17:11 jasper Exp $
@


1.23
log
@update to logstash-2.3.1

from pavel korovin
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2016/04/01 11:05:45 jasper Exp $
d5 1
a5 1
V=			2.3.1
@


1.22
log
@update to logstash-2.3.0

from Pavel Korovin
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2016/03/16 13:02:33 jasper Exp $
d5 1
a5 1
V=			2.3.0
@


1.21
log
@update to logstash-2.2.2

from pawe korovin
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2015/12/09 11:39:14 jasper Exp $
d5 1
a5 1
V=			2.2.2
@


1.20
log
@remove rc_pre() for it's no longer needed
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2015/12/08 09:20:24 jasper Exp $
d5 1
a5 1
V=			2.1.1
a7 1
REVISION=		0
d31 1
d33 5
@


1.19
log
@- update to logstash-2.1.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2015/11/26 10:59:59 jasper Exp $
d8 1
@


1.18
log
@- update to logstash-2.1.0

tested by/ok sebastia@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2015/11/16 19:02:25 jasper Exp $
d5 1
a5 1
V=			2.1.0
@


1.17
log
@- update logstash to 2.0.0

please refer to https://www.elastic.co/guide/en/logstash/2.0/upgrading-logstash.html
for upgrading your setup
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2015/09/06 08:29:39 jasper Exp $
d5 1
a5 1
V=			2.0.0
@


1.16
log
@- update to logstash-1.5.4

from Pavel Korovin
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2015/07/30 07:53:26 jasper Exp $
d5 1
a5 1
V=			1.5.4
@


1.15
log
@- update to logstash-1.5.3
- switch to jdk 1.8

with Pavel Korovin
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2015/07/18 05:49:27 ajacoutot Exp $
d5 1
a5 1
V=			1.5.3
@


1.14
log
@Missed bump (thanks jca@@)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2015/07/16 17:24:39 jeremy Exp $
d5 1
a5 1
V=			1.5.2
a8 1
REVISION=		1
d13 1
a13 1
MODJAVA_VER=		1.7+
d17 2
a18 1
			lang/jruby
d31 1
a31 1
	-rm -r ${WRKSRC}/vendor/jruby
d35 2
a44 1
	cd ${LS_BASE}/vendor/ && ln -sf ${LOCALBASE}/jruby
@


1.13
log
@Remove use of lang/ruby module and fix PLIST to not depend on ruby 2.1.

OK jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2015/07/16 01:07:06 jeremy Exp $
d9 1
a9 1
REVISION=		0
@


1.12
log
@Don't have an RDEP on lang/ruby/*, only lang/jruby

OK jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2015/07/02 18:06:02 jasper Exp $
d13 1
a13 2
MODULES=		java \
			lang/ruby
a15 2
MODRUBY_BUILDDEP=	No
MODRUBY_RUNDEP=		No
@


1.11
log
@- update to logstash-1.5.2
- fixup rc script for new installations where the logfiles may not exist yet

from Pavel Korovin
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2015/06/10 13:25:32 jasper Exp $
d9 1
d18 1
@


1.10
log
@run logstash as an unprivileged user, and add a note about plugins

from Pavel Korovin
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2015/05/17 10:30:59 jasper Exp $
d5 1
a5 2
V=			1.5.0
REVISION=		2
d10 1
a10 2
# tarball is a result of 'rake artifact:tar'
MASTER_SITES=		http://distfiles.nl/
@


1.9
log
@use JFFI_ARCH instead of hardcoding the path for amd64
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2015/05/17 10:28:35 jasper Exp $
d6 1
a6 1
REVISION=		1
@


1.8
log
@- use a dedicated _logstash user
- drop filewatch hacks by setting the right java.library.path

based on a diff from p@@tristero.se
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2015/05/15 07:34:10 jasper Exp $
d6 1
a6 1
REVISION=		0
@


1.7
log
@- update to logstash-1.5.0
* release notes at: https://www.elastic.co/blog/logstash-1-5-0-ga-released
- sync default config with logstash-forwarder
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2015/05/14 12:17:58 jasper Exp $
d6 1
a6 1
EPOCH=			0
d9 1
d27 3
a44 1
	-rm ${WRKSRC}/vendor/bundle/jruby/1.9/gems/filewatch-0.6.1/lib/filewatch/*.orig
@


1.6
log
@comment out the lumberjack input block so the configuration works out of the box

setting up the lumberjack input requires generating an ssl certificate/key
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2015/05/08 09:08:44 espie Exp $
d5 2
a6 1
V=			1.5.0-rc3
a8 1
REVISION=		0
d36 1
a36 1
	${INSTALL_DATA_DIR} ${LS_BASE}/{bin,lib,locales,vendor}/
d41 2
a42 2
	rm ${WRKSRC}/vendor/bundle/jruby/1.9/gems/filewatch-0.6.1/lib/filewatch/*.orig
	cd ${WRKSRC} && cp -R lib locales vendor ${LS_BASE}
@


1.5
log
@don't depend on modes in the ports tree being what we want installed
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2015/04/26 19:02:57 jasper Exp $
d8 1
@


1.4
log
@- update to logstash-1.5.0-rc3 (from beta1)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2014/12/20 12:28:04 jasper Exp $
d44 1
a44 1
	${SUBST_CMD} -c ${FILESDIR}/logstash.conf \
@


1.3
log
@- add example for use with syslog.

from freebsd
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2014/12/19 14:06:32 jasper Exp $
d5 3
a7 3
# built with https://github.com/elasticsearch/logstash/pull/2236
DISTNAME=		logstash-1.5.0.beta1
REVISION=		1
d9 2
a10 2
MASTER_SITES=		http://distfiles.nl/ \
			https://download.elasticsearch.org/logstash/logstash/
d35 3
a37 2
	${INSTALL_DATA_DIR} ${LS_BASE}/{bin,lib,locales,patterns,vendor}/
.for b in logstash logstash-web logstash.lib.sh plugin
d40 2
a41 2
	rm ${WRKSRC}/vendor/bundle/jruby/1.9/gems/filewatch-0.5.1/lib/filewatch/*.orig
	cd ${WRKSRC} && cp -R lib locales patterns vendor ${LS_BASE}
@


1.2
log
@adjust configuration dir and logpath to match recommended upstream locations
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2014/12/16 18:10:58 jasper Exp $
d7 1
a7 1
REVISION=		0
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d7 1
@


1.1.1.1
log
@import logstash 1.5.0beta1

logstash is a tool for managing events and logs. You can use it to
collect logs, parse them, and store them for later use (like, for
searching). Speaking of searching, logstash comes with a web interface
for searching and drilling into all of your logs.

ok aja@@
@
text
@@
