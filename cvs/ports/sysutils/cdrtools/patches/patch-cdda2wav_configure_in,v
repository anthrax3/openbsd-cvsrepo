head	1.1;
access;
symbols
	OPENBSD_6_2:1.1.0.12
	OPENBSD_6_2_BASE:1.1
	OPENBSD_6_1:1.1.0.10
	OPENBSD_6_1_BASE:1.1
	OPENBSD_6_0:1.1.0.8
	OPENBSD_6_0_BASE:1.1
	OPENBSD_5_9:1.1.0.4
	OPENBSD_5_9_BASE:1.1
	OPENBSD_5_8:1.1.0.6
	OPENBSD_5_8_BASE:1.1
	OPENBSD_5_7:1.1.0.2
	OPENBSD_5_7_BASE:1.1;
locks; strict;
comment	@# @;


1.1
date	2014.11.03.09.12.41;	author ratchov;	state Exp;
branches;
next	;
commitid	yFqAb7yPLu4BWe1S;


desc
@@


1.1
log
@Use sndio to play sound.

help from and ok jca, ok armani
@
text
@$OpenBSD$
--- cdda2wav/configure.in.orig	Sat Aug  8 21:40:53 2009
+++ cdda2wav/configure.in	Thu Oct 30 19:15:57 2014
@@@@ -19,15 +19,32 @@@@ case "$host_os" in
 AC_CHECK_LIB(posix4, sched_get_priority_max)
 ;;
 esac
+case "$host_os" in
+   *openbsd*)
+dnl skip obsolete libossaudio on OpenBSD
+;;
+   *)
 AC_CHECK_LIB(ossaudio, _oss_ioctl)
+;;
+esac
+AC_CHECK_LIB(sndio, sio_open)
 
 EXTRALIBS="$LIBS"
 
 AC_SUBST(EXTRALIBS)
 
 dnl check header files
-AC_CHECK_HEADERS(sys/cdio.h sys/cdrio.h sundev/srreg.h sys/audioio.h sun/audioio.h)
+AC_CHECK_HEADERS(sndio.h)
+AC_CHECK_HEADERS(sys/cdio.h sys/cdrio.h sundev/srreg.h)
+case "$host_os" in
+   *openbsd*)
+dnl skip obsolete soundcard.h and non-SunOS-compatible audioio.h on OpenBSD
+;;
+   *)
+AC_CHECK_HEADERS(sys/audioio.h sun/audioio.h)
 AC_CHECK_HEADERS(soundcard.h sys/soundcard.h linux/soundcard.h machine/soundcard.h)
+;;
+esac
 dnl We no longer include HAVE_WINDOWS_H in lconfig.h but we need the test
 dnl result together with the test for mmsystem.h
 AC_CHECK_HEADERS(sys/asoundlib.h windows.h mmsystem.h)
@@@@ -61,6 +78,17 @@@@ HAVE_OSS=
 ;;
 esac
 AC_SUBST(HAVE_OSS)
+
+case "${ac_cv_header_sndio_h}" in
+   *yes*)
+HAVE_SNDIO=1
+;;
+   *)
+HAVE_SNDIO=
+;;
+esac
+AC_SUBST(HAVE_SNDIO)
+
 
 AC_SUBST(HAVE_SYS_ASOUNDLIB_H)
 
@
