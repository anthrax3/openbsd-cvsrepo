head	1.6;
access;
symbols
	OPENBSD_6_1:1.6.0.12
	OPENBSD_6_1_BASE:1.6
	OPENBSD_6_0:1.6.0.10
	OPENBSD_6_0_BASE:1.6
	OPENBSD_5_9:1.6.0.6
	OPENBSD_5_9_BASE:1.6
	OPENBSD_5_8:1.6.0.8
	OPENBSD_5_8_BASE:1.6
	OPENBSD_5_7:1.6.0.4
	OPENBSD_5_7_BASE:1.6
	OPENBSD_5_6:1.6.0.2
	OPENBSD_5_6_BASE:1.6
	OPENBSD_5_3:1.4.0.16
	OPENBSD_5_3_BASE:1.4
	OPENBSD_5_2:1.4.0.14
	OPENBSD_5_2_BASE:1.4
	OPENBSD_5_1_BASE:1.4
	OPENBSD_5_1:1.4.0.12
	OPENBSD_5_0:1.4.0.10
	OPENBSD_5_0_BASE:1.4
	OPENBSD_4_9:1.4.0.8
	OPENBSD_4_9_BASE:1.4
	OPENBSD_4_8:1.4.0.6
	OPENBSD_4_8_BASE:1.4
	OPENBSD_4_7:1.4.0.4
	OPENBSD_4_7_BASE:1.4
	OPENBSD_4_6:1.4.0.2
	OPENBSD_4_6_BASE:1.4
	OPENBSD_4_5:1.3.0.2
	OPENBSD_4_5_BASE:1.3
	OPENBSD_4_4:1.2.0.12
	OPENBSD_4_4_BASE:1.2
	OPENBSD_4_3:1.2.0.10
	OPENBSD_4_3_BASE:1.2
	OPENBSD_4_2:1.2.0.8
	OPENBSD_4_2_BASE:1.2
	OPENBSD_4_1:1.2.0.6
	OPENBSD_4_1_BASE:1.2
	OPENBSD_4_0:1.2.0.4
	OPENBSD_4_0_BASE:1.2
	OPENBSD_3_9:1.2.0.2
	OPENBSD_3_9_BASE:1.2
	OPENBSD_3_8:1.1.1.1.0.8
	OPENBSD_3_8_BASE:1.1.1.1
	OPENBSD_3_7:1.1.1.1.0.6
	OPENBSD_3_7_BASE:1.1.1.1
	OPENBSD_3_6:1.1.1.1.0.4
	OPENBSD_3_6_BASE:1.1.1.1
	OPENBSD_3_5:1.1.1.1.0.2
	OPENBSD_3_5_BASE:1.1.1.1
	laurent-sebastien:1.1.1.1
	GNU:1.1.1;
locks; strict;
comment	@# @;


1.6
date	2014.04.22.10.21.13;	author ajacoutot;	state Exp;
branches;
next	1.5;

1.5
date	2013.06.21.22.35.51;	author sthen;	state dead;
branches;
next	1.4;

1.4
date	2009.03.15.19.59.31;	author landry;	state Exp;
branches;
next	1.3;

1.3
date	2008.11.22.11.06.15;	author ajacoutot;	state Exp;
branches;
next	1.2;

1.2
date	2006.02.04.18.37.36;	author bernd;	state Exp;
branches;
next	1.1;

1.1
date	2004.02.20.19.54.58;	author espie;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2004.02.20.19.54.58;	author espie;	state Exp;
branches;
next	;


desc
@@


1.6
log
@Kerberos is going away. No need to statically link to our own libcom_err
which made this package way bigger than it should.

ok sthen@@
@
text
@$OpenBSD$
--- lib/et/Makefile.in.orig	Tue Apr 22 10:36:27 2014
+++ lib/et/Makefile.in	Tue Apr 22 10:36:58 2014
@@@@ -25,8 +25,8 @@@@ SHARE_FILES= et_c.awk et_h.awk
 LIBRARY= libcom_err
 LIBDIR= et
 
-ELF_VERSION = 2.1
-ELF_SO_VERSION = 2
+ELF_VERSION = $(LIBcom_err_VERSION)
+ELF_SO_VERSION = $(LIBcom_err_VERSION)
 ELF_IMAGE = libcom_err
 ELF_MYDIR = et
 ELF_INSTALL_DIR = $(root_libdir)
@


1.5
log
@Update e2fsprogs to 1.42.7, and rename the library back to libuuid now
that ossp-uuid (devel/uuid) has been changed to use the alternative name
libossp-uuid as used on various other OS. When third party software
wants a uuid library, is is nearly always the one from e2fsprogs,
so let's avoid patching for the common case.

e2fsprogs has its own libcom_err (slightly different API to heimdal);
previously we installed this under an alternative name; in this update
I have changed to statically linking this instead as it is not used
externally. The et/com_err.h header is no longer installed to avoid
ports picking it up in preference to the proper heimdal header for
this library in kerberosV/com_err.h.

Fallout will be handled in the next couple of commits.

ok ajacoutot@@
@
text
@d1 5
a5 9
$OpenBSD: patch-lib_et_Makefile_in,v 1.4 2009/03/15 19:59:31 landry Exp $
--- lib/et/Makefile.in.orig	Tue Oct  7 16:22:39 2008
+++ lib/et/Makefile.in	Sun Feb 22 11:41:29 2009
@@@@ -22,18 +22,18 @@@@ SRCS = $(srcdir)/error_message.c $(srcdir)/et_name.c $
 HFILES= com_err.h
 SHARE_FILES= et_c.awk et_h.awk
 
-LIBRARY= libcom_err
+LIBRARY= libext2fs_com_err
d10 3
a12 4
-ELF_IMAGE = libcom_err
+ELF_VERSION = $(LIBext2fs_com_err_VERSION)
+ELF_SO_VERSION = $(LIBext2fs_com_err_VERSION)
+ELF_IMAGE = libext2fs_com_err
a14 101
 ELF_OTHER_LIBS = @@SEM_INIT_LIB@@
 
 BSDLIB_VERSION = 1.1
-BSDLIB_IMAGE = libcom_err
+BSDLIB_IMAGE = libext2fs_com_err
 BSDLIB_MYDIR = et
 BSDLIB_INSTALL_DIR = $(root_libdir)
 
@@@@ -41,8 +41,7 @@@@ BSDLIB_INSTALL_DIR = $(root_libdir)
 # what to build...
 #
 .c.o:
-	@@echo "	CC $<"
-	@@$(CC) $(ALL_CFLAGS) -c $< -o $@@
+	$(CC) $(ALL_CFLAGS) -c $< -o $@@
 @@PROFILE_CMT@@	@@$(CC) $(ALL_CFLAGS) -g -pg -o profiled/$*.o -c $<
 @@CHECKER_CMT@@	@@$(CC) $(ALL_CFLAGS) -checker -g -o checker/$*.o -c $<
 @@ELF_CMT@@	@@$(CC) $(ALL_CFLAGS) -fPIC -o elfshared/$*.o -c $<
@@@@ -55,16 +54,14 @@@@ BSDLIB_INSTALL_DIR = $(root_libdir)
 @@MAKEFILE_CHECKER@@
 
 compile_et: $(DEP_SUBSTITUTE) $(srcdir)/compile_et.sh.in
-	@@echo "	SUBST $@@"
-	@@$(SUBSTITUTE) $(srcdir)/compile_et.sh.in compile_et
-	@@$(CHMOD) +x compile_et
+	$(SUBSTITUTE) $(srcdir)/compile_et.sh.in compile_et
+	$(CHMOD) +x compile_et
 
 com_err.ps : com_err.dvi
 com_err.dvi: com_err.texinfo
 
 com_err.pc: $(srcdir)/com_err.pc.in $(top_builddir)/config.status
-	@@echo "	CONFIG.STATUS $@@"
-	@@cd $(top_builddir); CONFIG_FILES=lib/et/com_err.pc ./config.status
+	cd $(top_builddir); CONFIG_FILES=lib/et/com_err.pc ./config.status
 
 #libcom_err.o:	$(LIBOBJS)
 #	$(LD) -r -s -o libcom_err.o $(LIBOBJS)
@@@@ -74,37 +71,29 @@@@ TAGS:	$(SRCS)
 	$(TAGS) $(SRCS)
 
 installdirs::
-	@@echo "	MKINSTALLDIRS $(libdir) $(includedir)/et $(datadir)/et $(bindir) $(man1dir) $(man3dir)"
-	@@$(MKINSTALLDIRS) $(DESTDIR)$(libdir) \
+	$(MKINSTALLDIRS) $(DESTDIR)$(libdir) \
 		$(DESTDIR)$(includedir)/et $(DESTDIR)$(datadir)/et \
 		$(DESTDIR)$(bindir) $(DESTDIR)$(man1dir) \
 		$(DESTDIR)$(man3dir) $(DESTDIR)$(libdir)/pkgconfig
 
-install:: compile_et libcom_err.a $(HFILES) installdirs com_err.pc
-	@@echo "	INSTALL_DATA $(libdir)/libcom_err.a"
-	@@$(INSTALL_DATA) libcom_err.a $(DESTDIR)$(libdir)/libcom_err.a
-	@@-$(RANLIB) $(DESTDIR)$(libdir)/libcom_err.a
-	@@$(CHMOD) $(LIBMODE) $(DESTDIR)$(libdir)/libcom_err.a
-	@@for i in $(HFILES); do \
-		echo "	INSTALL_DATA $(includedir)/et/$$i"; \
+install:: compile_et $(LIBRARY).a $(HFILES) installdirs com_err.pc
+	$(INSTALL_DATA) $(LIBRARY).a $(DESTDIR)$(libdir)/$(LIBRARY).a
+	$(RANLIB) $(DESTDIR)$(libdir)/$(LIBRARY).a
+	$(CHMOD) $(LIBMODE) $(DESTDIR)$(libdir)/$(LIBRARY).a
+	for i in $(HFILES); do \
 		$(INSTALL_DATA) $(srcdir)/$$i $(DESTDIR)$(includedir)/et/$$i; \
 	done
-	@@for i in $(SHARE_FILES); do \
-		echo "	INSTALL_DATA $(datadir)/et/$$i"; \
+	for i in $(SHARE_FILES); do \
 		$(INSTALL_DATA) $(srcdir)/$$i $(DESTDIR)$(datadir)/et/$$i; \
 	done
-	@@echo "	INSTALL_SCRIPT $(bindir)/compile_et"
-	@@$(INSTALL_SCRIPT) compile_et $(DESTDIR)$(bindir)/compile_et
-	@@echo "	INSTALL_DATA $(man3dir)/com_err.3"
-	@@$(INSTALL_DATA) $(srcdir)/com_err.3 $(DESTDIR)$(man3dir)/com_err.3
-	@@echo "	INSTALL_DATA $(man1dir)/compile_et.1"
-	@@$(INSTALL_DATA) $(srcdir)/compile_et.1 \
+	$(INSTALL_SCRIPT) compile_et $(DESTDIR)$(bindir)/compile_et
+	$(INSTALL_DATA) $(srcdir)/com_err.3 $(DESTDIR)$(man3dir)/com_err.3
+	$(INSTALL_DATA) $(srcdir)/compile_et.1 \
 			$(DESTDIR)$(man1dir)/compile_et.1
-	@@echo "	INSTALL_DATA $(libdir)/pkgconfig/com_err.pc"
-	@@$(INSTALL_DATA) com_err.pc $(DESTDIR)$(libdir)/pkgconfig/com_err.pc
+	$(INSTALL_DATA) com_err.pc $(DESTDIR)$(libdir)/pkgconfig/com_err.pc
 
 uninstall::
-	$(RM) -f $(DESTDIR)$(libdir)/libcom_err.a \
+	$(RM) -f $(DESTDIR)$(libdir)/$(LIBRARY).a \
 		$(DESTDIR)$(bindir)/compile_et \
 		$(DESTDIR)$(libdir)/pkgconfig/com_err.pc
 	$(RM) -rf $(DESTDIR)$(includedir)/et $(DESTDIR)$(datadir)/et
@@@@ -122,10 +111,10 @@@@ check:: compile_et
 	done
 
 clean::
-	$(RM) -f compile_et libcom_err.a libcom_err_p.a com_err.info
+	$(RM) -f compile_et $(LIBRARY).a $(LIBRARY)_p.a com_err.info
 	$(RM) -f $(OBJS) profiled/*
 	$(RM) -f *~ \#* *.bak *.otl *.aux *.toc *.PS *.dvi *.ps TAGS *.ln
-	$(RM) -f ../libcom_err.a ../libcom_err_p.a
+	$(RM) -f ../$(LIBRARY).a ../$(LIBRARY)_p.a
 
 mostlyclean:: clean
 distclean:: clean
@


1.4
log
@Update to e2fsprogs-1.41.4 (supporting ext2/ext3/ext4 fs) :
- Remove MAINTAINERS as they agree not having time nor interest for it.
- Use install-libs target instead of manually installing some cherrypicked
headers - now all needed headers are installed in the right place.
- Install fsck and its manpage as fsck_ext2fs instead of the confusing pfsck.
- Install uuid.pc as e2fs-uuid.pc to avoid conflicts with devel/uuid.
- Patch most Makefiles to print full build commands instead of the
non-informative linux-kernel-like output.
- Patch some regress tests, more and more works fine now.

With feedback and tweaks from naddy@@ and pea@@
@
text
@d1 1
a1 1
$OpenBSD: patch-lib_et_Makefile_in,v 1.3 2008/11/22 11:06:15 ajacoutot Exp $
@


1.3
log
@- regen patches and PLIST
- bump
@
text
@d1 4
a4 4
$OpenBSD: patch-lib_et_Makefile_in,v 1.2 2006/02/04 18:37:36 bernd Exp $
--- lib/et/Makefile.in.orig	Sun Feb 24 22:03:59 2002
+++ lib/et/Makefile.in	Sat Nov 22 11:56:10 2008
@@@@ -22,7 +22,7 @@@@ SRCS = $(srcdir)/error_message.c $(srcdir)/et_name.c $
d12 3
a14 11
 DLL_ADDRESS = 0x66800000
@@@@ -30,19 +30,19 @@@@ DLL_JUMPSIZE = 0x1000
 DLL_GOTSIZE  = 0x1000
 DLL_VERSION = 1.0
 DLL_IMAGE = libet
-DLL_STUB = libcom_err
+DLL_STUB = libext2fs_com_err
 DLL_MYDIR = et
 DLL_INSTALL_DIR = $(root_libdir)
 
-ELF_VERSION = 2.0
d16 1
a16 2
 ELF_SO_VERSION = 2
-ELF_IMAGE = libcom_err
d20 1
a20 1
 ELF_OTHER_LIBS = 
d22 1
a22 1
 BSDLIB_VERSION = 1.0
d28 38
a65 1
@@@@ -85,11 +85,11 @@@@ installdirs::
d67 1
a67 1
 		$(DESTDIR)$(man3dir)
d69 8
a76 6
-install:: compile_et libcom_err.a $(HFILES) installdirs
-	$(INSTALL_DATA) libcom_err.a $(DESTDIR)$(libdir)/libcom_err.a
-	$(CHMOD) 644 $(DESTDIR)$(libdir)/libcom_err.a
-	-$(RANLIB) $(DESTDIR)$(libdir)/libcom_err.a
-	$(CHMOD) $(LIBMODE) $(DESTDIR)$(libdir)/libcom_err.a
+install:: compile_et $(LIBRARY).a $(HFILES) installdirs
d78 1
a78 2
+	$(CHMOD) 644 $(DESTDIR)$(libdir)/$(LIBRARY).a
+	-$(RANLIB) $(DESTDIR)$(libdir)/$(LIBRARY).a
d80 1
a80 1
 	for i in $(HFILES); do \
d83 14
a96 1
@@@@ -102,15 +102,15 @@@@ install:: compile_et libcom_err.a $(HFILES) installdir
d98 3
d105 2
a106 1
 			$(DESTDIR)$(bindir)/compile_et
d108 2
d112 2
a113 2
-	$(RM) -f compile_et libcom_err.a libcom_err_p.a
+	$(RM) -f compile_et $(LIBRARY).a $(LIBRARY)_p.a
d118 1
a120 1
 	$(RM) -f .depend Makefile $(srcdir)/TAGS $(srcdir)/Makefile.in.old
@


1.2
log
@Fix busted SHARED_LIBS stuff.
@
text
@d1 4
a4 4
$OpenBSD: patch-lib_et_Makefile_in,v 1.1.1.1 2004/02/20 19:54:58 espie Exp $
--- lib/et/Makefile.in.orig	Sun Feb 24 21:03:59 2002
+++ lib/et/Makefile.in	Sat Feb  4 19:05:39 2006
@@@@ -22,7 +22,7 @@@@ SRCS = $(srcdir)/error_message.c $(srcdi
d54 1
a54 1
@@@@ -102,15 +102,15 @@@@ install:: compile_et libcom_err.a $(HFIL
@


1.1
log
@Initial revision
@
text
@d1 3
a3 3
$OpenBSD$
--- lib/et/Makefile.in.orig	2003-11-17 00:50:20.000000000 +0100
+++ lib/et/Makefile.in	2003-11-17 00:53:01.000000000 +0100
d22 2
a23 1
 ELF_VERSION = 2.0
@


1.1.1.1
log
@e2fsprogs, to handle mkfs, fsck, for linux ext2/ext3 fs.
@
text
@@
