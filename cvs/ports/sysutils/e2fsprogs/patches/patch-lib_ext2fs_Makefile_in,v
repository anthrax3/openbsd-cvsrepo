head	1.6;
access;
symbols
	OPENBSD_6_2:1.6.0.12
	OPENBSD_6_2_BASE:1.6
	OPENBSD_6_1:1.6.0.10
	OPENBSD_6_1_BASE:1.6
	OPENBSD_6_0:1.6.0.8
	OPENBSD_6_0_BASE:1.6
	OPENBSD_5_9:1.6.0.4
	OPENBSD_5_9_BASE:1.6
	OPENBSD_5_8:1.6.0.6
	OPENBSD_5_8_BASE:1.6
	OPENBSD_5_7:1.6.0.2
	OPENBSD_5_7_BASE:1.6
	OPENBSD_5_6:1.5.0.2
	OPENBSD_5_6_BASE:1.5
	OPENBSD_5_5:1.4.0.4
	OPENBSD_5_5_BASE:1.4
	OPENBSD_5_4:1.4.0.2
	OPENBSD_5_4_BASE:1.4
	OPENBSD_5_3:1.3.0.16
	OPENBSD_5_3_BASE:1.3
	OPENBSD_5_2:1.3.0.14
	OPENBSD_5_2_BASE:1.3
	OPENBSD_5_1_BASE:1.3
	OPENBSD_5_1:1.3.0.12
	OPENBSD_5_0:1.3.0.10
	OPENBSD_5_0_BASE:1.3
	OPENBSD_4_9:1.3.0.8
	OPENBSD_4_9_BASE:1.3
	OPENBSD_4_8:1.3.0.6
	OPENBSD_4_8_BASE:1.3
	OPENBSD_4_7:1.3.0.4
	OPENBSD_4_7_BASE:1.3
	OPENBSD_4_6:1.3.0.2
	OPENBSD_4_6_BASE:1.3
	OPENBSD_4_5:1.2.0.14
	OPENBSD_4_5_BASE:1.2
	OPENBSD_4_4:1.2.0.12
	OPENBSD_4_4_BASE:1.2
	OPENBSD_4_3:1.2.0.10
	OPENBSD_4_3_BASE:1.2
	OPENBSD_4_2:1.2.0.8
	OPENBSD_4_2_BASE:1.2
	OPENBSD_4_1:1.2.0.6
	OPENBSD_4_1_BASE:1.2
	OPENBSD_4_0:1.2.0.4
	OPENBSD_4_0_BASE:1.2
	OPENBSD_3_9:1.2.0.2
	OPENBSD_3_9_BASE:1.2
	OPENBSD_3_8:1.1.1.1.0.8
	OPENBSD_3_8_BASE:1.1.1.1
	OPENBSD_3_7:1.1.1.1.0.6
	OPENBSD_3_7_BASE:1.1.1.1
	OPENBSD_3_6:1.1.1.1.0.4
	OPENBSD_3_6_BASE:1.1.1.1
	OPENBSD_3_5:1.1.1.1.0.2
	OPENBSD_3_5_BASE:1.1.1.1
	laurent-sebastien:1.1.1.1
	GNU:1.1.1;
locks; strict;
comment	@# @;


1.6
date	2014.11.08.11.28.04;	author sthen;	state Exp;
branches;
next	1.5;
commitid	OqEufjKDhN6lMXmH;

1.5
date	2014.04.22.10.21.13;	author ajacoutot;	state Exp;
branches;
next	1.4;

1.4
date	2013.06.21.22.35.51;	author sthen;	state Exp;
branches;
next	1.3;

1.3
date	2009.03.15.19.59.31;	author landry;	state Exp;
branches;
next	1.2;

1.2
date	2006.02.04.18.37.36;	author bernd;	state Exp;
branches;
next	1.1;

1.1
date	2004.02.20.19.54.58;	author espie;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2004.02.20.19.54.58;	author espie;	state Exp;
branches;
next	;


desc
@@


1.6
log
@update to e2fsprogs 1.42.12
@
text
@$OpenBSD$
--- lib/ext2fs/Makefile.in.orig	Sat Aug  2 21:26:22 2014
+++ lib/ext2fs/Makefile.in	Sat Nov  8 10:41:17 2014
@@@@ -203,8 +203,8 @@@@ HFILES_IN=  ext2_err.h ext2_types.h
 LIBRARY= libext2fs
 LIBDIR= ext2fs
 
-ELF_VERSION = 2.4
-ELF_SO_VERSION = 2
+ELF_VERSION = $(LIBext2fs_VERSION)
+ELF_SO_VERSION = $(LIBext2fs_VERSION)
 ELF_IMAGE = libext2fs
 ELF_MYDIR = ext2fs
 ELF_INSTALL_DIR = $(root_libdir)
@


1.5
log
@Kerberos is going away. No need to statically link to our own libcom_err
which made this package way bigger than it should.

ok sthen@@
@
text
@d1 4
a4 4
$OpenBSD: patch-lib_ext2fs_Makefile_in,v 1.4 2013/06/21 22:35:51 sthen Exp $
--- lib/ext2fs/Makefile.in.orig	Tue Jan 22 04:33:35 2013
+++ lib/ext2fs/Makefile.in	Tue Apr 22 10:29:47 2014
@@@@ -177,8 +177,8 @@@@ HFILES_IN=  ext2_err.h ext2_types.h
@


1.4
log
@Update e2fsprogs to 1.42.7, and rename the library back to libuuid now
that ossp-uuid (devel/uuid) has been changed to use the alternative name
libossp-uuid as used on various other OS. When third party software
wants a uuid library, is is nearly always the one from e2fsprogs,
so let's avoid patching for the common case.

e2fsprogs has its own libcom_err (slightly different API to heimdal);
previously we installed this under an alternative name; in this update
I have changed to statically linking this instead as it is not used
externally. The et/com_err.h header is no longer installed to avoid
ports picking it up in preference to the proper heimdal header for
this library in kerberosV/com_err.h.

Fallout will be handled in the next couple of commits.

ok ajacoutot@@
@
text
@d1 4
a4 7
$OpenBSD$

Statically link libcom_err to avoid conflict with kerberosV.

--- lib/ext2fs/Makefile.in.orig	Tue Jan 22 03:33:35 2013
+++ lib/ext2fs/Makefile.in	Wed Jun 19 14:50:57 2013
@@@@ -177,12 +177,12 @@@@ HFILES_IN=  ext2_err.h ext2_types.h
a14 5
-ELF_OTHER_LIBS = -lcom_err
+ELF_OTHER_LIBS = ../../libcom_err.a
 
 BSDLIB_VERSION = 2.1
 BSDLIB_IMAGE = libext2fs
@


1.3
log
@Update to e2fsprogs-1.41.4 (supporting ext2/ext3/ext4 fs) :
- Remove MAINTAINERS as they agree not having time nor interest for it.
- Use install-libs target instead of manually installing some cherrypicked
headers - now all needed headers are installed in the right place.
- Install fsck and its manpage as fsck_ext2fs instead of the confusing pfsck.
- Install uuid.pc as e2fs-uuid.pc to avoid conflicts with devel/uuid.
- Patch most Makefiles to print full build commands instead of the
non-informative linux-kernel-like output.
- Patch some regress tests, more and more works fine now.

With feedback and tweaks from naddy@@ and pea@@
@
text
@d1 7
a7 4
$OpenBSD: patch-lib_ext2fs_Makefile_in,v 1.2 2006/02/04 18:37:36 bernd Exp $
--- lib/ext2fs/Makefile.in.orig	Tue Oct  7 16:22:39 2008
+++ lib/ext2fs/Makefile.in	Sun Feb 22 10:54:40 2009
@@@@ -155,12 +155,12 @@@@ HFILES_IN=  ext2_err.h ext2_types.h
d18 2
a19 2
-ELF_OTHER_LIBS = -L../.. -lcom_err
+ELF_OTHER_LIBS = -L../.. -lext2fs_com_err
a22 211
@@@@ -176,8 +176,7 @@@@ BSDLIB_INSTALL_DIR = $(root_libdir)
 all:: ext2fs.pc
 
 .c.o:
-	@@echo "	CC $<"
-	@@$(CC) $(ALL_CFLAGS) -c $< -o $@@
+	$(CC) $(ALL_CFLAGS) -c $< -o $@@
 @@PROFILE_CMT@@	@@$(CC) $(ALL_CFLAGS) -g -pg -o profiled/$*.o -c $<
 @@CHECKER_CMT@@	@@$(CC) $(ALL_CFLAGS) -checker -g -o checker/$*.o -c $<
 @@ELF_CMT@@	@@$(CC) $(ALL_CFLAGS) -fPIC -o elfshared/$*.o -c $<
@@@@ -188,137 +187,107 @@@@ COMPILE_ET=../et/compile_et --build-tree
 DISTFILES= Makefile *.c *.h image
 
 ext2_err.et: $(DEP_SUBSTITUTE) $(srcdir)/ext2_err.et.in
-	@@echo "	SUBST $@@"
-	@@$(SUBSTITUTE) $(srcdir)/ext2_err.et.in ext2_err.et
+	$(SUBSTITUTE) $(srcdir)/ext2_err.et.in ext2_err.et
 
 ext2_err.c ext2_err.h: ext2_err.et
-	@@echo "	COMPILE_ET ext2_err.et"
-	@@$(COMPILE_ET) ext2_err.et
+	$(COMPILE_ET) ext2_err.et
 
 ext2fs.pc: $(srcdir)/ext2fs.pc.in $(top_builddir)/config.status
-	@@echo "	CONFIG.STATUS $@@"
-	@@cd $(top_builddir); CONFIG_FILES=lib/ext2fs/ext2fs.pc ./config.status
+	cd $(top_builddir); CONFIG_FILES=lib/ext2fs/ext2fs.pc ./config.status
 
 tst_badblocks: tst_badblocks.o $(STATIC_LIBEXT2FS)
-	@@echo "	LD $@@"
-	@@$(CC) -o tst_badblocks tst_badblocks.o $(STATIC_LIBEXT2FS) \
+	$(CC) -o tst_badblocks tst_badblocks.o $(STATIC_LIBEXT2FS) \
 		$(LIBCOM_ERR)
 
 tst_icount: $(srcdir)/icount.c $(STATIC_LIBEXT2FS)
-	@@echo "	LD $@@"
-	@@$(CC) -o tst_icount $(srcdir)/icount.c -DDEBUG $(ALL_CFLAGS) \
+	$(CC) -o tst_icount $(srcdir)/icount.c -DDEBUG $(ALL_CFLAGS) \
 		$(STATIC_LIBEXT2FS) $(LIBCOM_ERR)
 
 tst_iscan: tst_iscan.o $(STATIC_LIBEXT2FS)
-	@@echo "	LD $@@"
-	@@$(CC) -o tst_iscan tst_iscan.o $(STATIC_LIBEXT2FS) $(LIBCOM_ERR)
+	$(CC) -o tst_iscan tst_iscan.o $(STATIC_LIBEXT2FS) $(LIBCOM_ERR)
 
 tst_getsize: tst_getsize.o $(STATIC_LIBEXT2FS)
-	@@echo "	LD $@@"
-	@@$(CC) -o tst_getsize tst_getsize.o $(STATIC_LIBEXT2FS) \
+	$(CC) -o tst_getsize tst_getsize.o $(STATIC_LIBEXT2FS) \
 		$(LIBCOM_ERR)
 
 tst_ismounted: $(srcdir)/ismounted.c $(STATIC_LIBEXT2FS)
-	@@echo "	LD $@@"
-	@@$(CC) -o tst_ismounted $(srcdir)/ismounted.c -DDEBUG $(ALL_CFLAGS) $(LIBCOM_ERR) 
+	(CC) -o tst_ismounted $(srcdir)/ismounted.c -DDEBUG $(ALL_CFLAGS) $(LIBCOM_ERR) 
 
 tst_byteswap: tst_byteswap.o $(STATIC_LIBEXT2FS)
-	@@echo "	LD $@@"
-	@@$(CC) -o tst_byteswap tst_byteswap.o $(STATIC_LIBEXT2FS) \
+	$(CC) -o tst_byteswap tst_byteswap.o $(STATIC_LIBEXT2FS) \
 		$(LIBCOM_ERR)
 
 tst_bitops: tst_bitops.o $(STATIC_LIBEXT2FS)
-	@@echo "	LD $@@"
-	@@$(CC) -o tst_bitops tst_bitops.o $(ALL_CFLAGS) \
+	$(CC) -o tst_bitops tst_bitops.o $(ALL_CFLAGS) \
 		$(STATIC_LIBEXT2FS) $(LIBCOM_ERR)
 
 tst_getsectsize: tst_getsectsize.o $(STATIC_LIBEXT2FS)
-	@@echo "	LD $@@"
-	@@$(CC) -o tst_sectgetsize tst_getsectsize.o \
+	$(CC) -o tst_sectgetsize tst_getsectsize.o \
 		$(STATIC_LIBEXT2FS) $(LIBCOM_ERR)
 
 tst_types: tst_types.o ext2_types.h 
-	@@echo "	LD $@@"
-	@@$(CC) -o tst_types tst_types.o 
+	$(CC) -o tst_types tst_types.o 
 
 tst_super_size: tst_super_size.o ext2_fs.h
-	@@echo "	LD $@@"
-	@@$(CC) -o tst_super_size tst_super_size.o 
+	$(CC) -o tst_super_size tst_super_size.o 
 
 ext2_tdbtool: tdbtool.o
-	@@echo "	LD $@@"
-	@@$(CC) -o ext2_tdbtool tdbtool.o tdb.o
+	$(CC) -o ext2_tdbtool tdbtool.o tdb.o
 
 extent_dbg.c: $(srcdir)/extent_dbg.ct
-	@@echo "	MK_CMDS $<"
-	@@$(MK_CMDS) $(srcdir)/extent_dbg.ct
+	$(MK_CMDS) $(srcdir)/extent_dbg.ct
 
 debug_cmds.c debug_cmds.h: $(top_srcdir)/debugfs/debug_cmds.ct
-	@@echo "	MK_CMDS $<@@"
-	@@$(MK_CMDS) $(top_srcdir)/debugfs/debug_cmds.ct
+	$(MK_CMDS) $(top_srcdir)/debugfs/debug_cmds.ct
 
 DEBUG_OBJS= debug_cmds.o debugfs.o util.o ncheck.o icheck.o ls.o \
 	lsdel.o dump.o set_fields.o logdump.o htree.o unused.o
 
 debugfs.o: $(top_srcdir)/debugfs/debugfs.c
-	@@echo "	CC $<"
-	@@$(CC) $(ALL_CFLAGS) -c $< -o $@@
+	$(CC) $(ALL_CFLAGS) -c $< -o $@@
 
 util.o: $(top_srcdir)/debugfs/util.c
-	@@echo "	CC $<"
-	@@$(CC) $(ALL_CFLAGS) -c $< -o $@@
+	$(CC) $(ALL_CFLAGS) -c $< -o $@@
 
 ncheck.o: $(top_srcdir)/debugfs/ncheck.c
-	@@echo "	CC $<"
-	@@$(CC) $(ALL_CFLAGS) -c $< -o $@@
+	$(CC) $(ALL_CFLAGS) -c $< -o $@@
 
 icheck.o: $(top_srcdir)/debugfs/icheck.c
-	@@echo "	CC $<"
-	@@$(CC) $(ALL_CFLAGS) -c $< -o $@@
+	$(CC) $(ALL_CFLAGS) -c $< -o $@@
 
 ls.o: $(top_srcdir)/debugfs/ls.c
-	@@echo "	CC $<"
-	@@$(CC) $(ALL_CFLAGS) -c $< -o $@@
+	$(CC) $(ALL_CFLAGS) -c $< -o $@@
 
 lsdel.o: $(top_srcdir)/debugfs/lsdel.c
-	@@echo "	CC $<"
-	@@$(CC) $(ALL_CFLAGS) -c $< -o $@@
+	$(CC) $(ALL_CFLAGS) -c $< -o $@@
 
 dump.o: $(top_srcdir)/debugfs/dump.c
-	@@echo "	CC $<"
-	@@$(CC) $(ALL_CFLAGS) -c $< -o $@@
+	$(CC) $(ALL_CFLAGS) -c $< -o $@@
 
 set_fields.o: $(top_srcdir)/debugfs/set_fields.c
-	@@echo "	CC $<"
-	@@$(CC) $(ALL_CFLAGS) -c $< -o $@@
+	$(CC) $(ALL_CFLAGS) -c $< -o $@@
 
 logdump.o: $(top_srcdir)/debugfs/logdump.c
-	@@echo "	CC $<"
-	@@$(CC) $(ALL_CFLAGS) -c $< -o $@@
+	$(CC) $(ALL_CFLAGS) -c $< -o $@@
 
 htree.o: $(top_srcdir)/debugfs/htree.c
-	@@echo "	CC $<"
-	@@$(CC) $(ALL_CFLAGS) -c $< -o $@@
+	$(CC) $(ALL_CFLAGS) -c $< -o $@@
 
 unused.o: $(top_srcdir)/debugfs/unused.c
-	@@echo "	CC $<"
-	@@$(CC) $(ALL_CFLAGS) -c $< -o $@@
+	$(CC) $(ALL_CFLAGS) -c $< -o $@@
 
 tst_extents: $(srcdir)/extent.c extent_dbg.c $(DEBUG_OBJS) $(DEPLIBSS) $(LIBE2P) $(DEPLIBUUID) $(DEPLIBBLKID)
-	@@echo "	LD $@@"
-	@@$(CC) -o tst_extents $(srcdir)/extent.c extent_dbg.c \
+	$(CC) -o tst_extents $(srcdir)/extent.c extent_dbg.c \
 		$(ALL_CFLAGS) -DDEBUG $(DEBUG_OBJS) $(LIBSS) $(LIBE2P) \
 		$(STATIC_LIBEXT2FS) $(LIBBLKID) $(LIBUUID) $(LIBCOM_ERR) \
 		-I $(top_srcdir)/debugfs
 
 tst_csum: tst_csum.c csum.c $(STATIC_LIBEXT2FS)
-	@@echo "	LD $@@"
-	@@$(CC) -o tst_csum $(srcdir)/csum.c $(srcdir)/tst_csum.c -DDEBUG \
+	$(CC) -o tst_csum $(srcdir)/csum.c $(srcdir)/tst_csum.c -DDEBUG \
 		$(ALL_CFLAGS) $(STATIC_LIBEXT2FS) $(LIBCOM_ERR)
 
 mkjournal: mkjournal.c $(STATIC_LIBEXT2FS)
-	@@echo "	LD $@@"
-	@@$(CC) -o mkjournal $(srcdir)/mkjournal.c -DDEBUG $(STATIC_LIBEXT2FS) $(LIBCOM_ERR) $(ALL_CFLAGS)
+	$(CC) -o mkjournal $(srcdir)/mkjournal.c -DDEBUG $(STATIC_LIBEXT2FS) $(LIBCOM_ERR) $(ALL_CFLAGS)
 
 check:: tst_bitops tst_badblocks tst_iscan tst_types tst_icount tst_super_size tst_types tst_csum
 	LD_LIBRARY_PATH=$(LIB) DYLD_LIBRARY_PATH=$(LIB) ./tst_bitops
@@@@ -330,25 +299,20 @@@@ check:: tst_bitops tst_badblocks tst_iscan tst_types t
 	LD_LIBRARY_PATH=$(LIB) DYLD_LIBRARY_PATH=$(LIB) ./tst_csum
 
 installdirs::
-	@@echo "	MKINSTALLDIRS $(libdir) $(includedir)/ext2fs"
-	@@$(MKINSTALLDIRS) $(DESTDIR)$(libdir) \
+	$(MKINSTALLDIRS) $(DESTDIR)$(libdir) \
 		$(DESTDIR)$(includedir)/ext2fs $(DESTDIR)$(libdir)/pkgconfig
 
 install:: all $(HFILES) $(HFILES_IN) installdirs ext2fs.pc
-	@@echo "	INSTALL_DATA $(libdir)/libext2fs.a"
-	@@$(INSTALL_DATA) libext2fs.a $(DESTDIR)$(libdir)/libext2fs.a
-	@@-$(RANLIB) $(DESTDIR)$(libdir)/libext2fs.a
-	@@$(CHMOD) $(LIBMODE) $(DESTDIR)$(libdir)/libext2fs.a
-	@@for i in $(HFILES); do \
-		echo "	INSTALL_DATA $(includedir)/ext2fs/$$i"; \
+	$(INSTALL_DATA) libext2fs.a $(DESTDIR)$(libdir)/libext2fs.a
+	$(RANLIB) $(DESTDIR)$(libdir)/libext2fs.a
+	$(CHMOD) $(LIBMODE) $(DESTDIR)$(libdir)/libext2fs.a
+	for i in $(HFILES); do \
 		$(INSTALL_DATA) $(srcdir)/$$i $(DESTDIR)$(includedir)/ext2fs/$$i; \
 	done
-	@@for i in $(HFILES_IN); do \
-		echo "	INSTALL_DATA $(includedir)/ext2fs/$$i"; \
+	for i in $(HFILES_IN); do \
 		$(INSTALL_DATA) $$i $(DESTDIR)$(includedir)/ext2fs/$$i; \
 	done
-	@@echo "	INSTALL_DATA $(libdir)/pkgconfig/ext2fs.pc"
-	@@$(INSTALL_DATA) ext2fs.pc $(DESTDIR)$(libdir)/pkgconfig/ext2fs.pc
+	$(INSTALL_DATA) ext2fs.pc $(DESTDIR)$(libdir)/pkgconfig/ext2fs.pc
 
 uninstall::
 	$(RM) -f $(DESTDIR)$(libdir)/libext2fs.a \
@


1.2
log
@Fix busted SHARED_LIBS stuff.
@
text
@d1 6
a6 6
$OpenBSD: patch-lib_ext2fs_Makefile_in,v 1.1.1.1 2004/02/20 19:54:58 espie Exp $
--- lib/ext2fs/Makefile.in.orig	Fri Mar  8 06:05:02 2002
+++ lib/ext2fs/Makefile.in	Sat Feb  4 19:04:53 2006
@@@@ -139,12 +139,12 @@@@ DLL_LIBS = -L../.. -lcom_err
 DLL_MYDIR = ext2fs
 DLL_INSTALL_DIR = $(root_libdir)
d9 1
d11 1
a11 1
 ELF_SO_VERSION = 2
d20 211
@


1.1
log
@Initial revision
@
text
@d1 10
a10 4
$OpenBSD$
--- lib/ext2fs/Makefile.in.orig	2003-11-17 01:02:03.000000000 +0100
+++ lib/ext2fs/Makefile.in	2003-11-17 01:02:13.000000000 +0100
@@@@ -144,7 +144,7 @@@@ ELF_SO_VERSION = 2
@


1.1.1.1
log
@e2fsprogs, to handle mkfs, fsck, for linux ext2/ext3 fs.
@
text
@@
