head	1.34;
access;
symbols
	OPENBSD_6_2:1.34.0.6
	OPENBSD_6_2_BASE:1.34
	OPENBSD_6_1:1.34.0.4
	OPENBSD_6_1_BASE:1.34
	OPENBSD_6_0:1.34.0.2
	OPENBSD_6_0_BASE:1.34
	OPENBSD_5_9:1.31.0.2
	OPENBSD_5_9_BASE:1.31
	OPENBSD_5_8:1.30.0.6
	OPENBSD_5_8_BASE:1.30
	OPENBSD_5_7:1.30.0.2
	OPENBSD_5_7_BASE:1.30
	OPENBSD_5_6:1.26.0.6
	OPENBSD_5_6_BASE:1.26
	OPENBSD_5_5:1.26.0.4
	OPENBSD_5_5_BASE:1.26
	OPENBSD_5_4:1.26.0.2
	OPENBSD_5_4_BASE:1.26
	OPENBSD_5_3:1.25.0.2
	OPENBSD_5_3_BASE:1.25
	OPENBSD_5_2:1.22.0.2
	OPENBSD_5_2_BASE:1.22
	OPENBSD_5_1_BASE:1.20
	OPENBSD_5_1:1.20.0.2
	OPENBSD_5_0:1.19.0.4
	OPENBSD_5_0_BASE:1.19
	OPENBSD_4_9:1.19.0.2
	OPENBSD_4_9_BASE:1.19
	OPENBSD_4_8:1.15.0.4
	OPENBSD_4_8_BASE:1.15
	OPENBSD_4_7:1.15.0.2
	OPENBSD_4_7_BASE:1.15
	OPENBSD_4_6:1.14.0.2
	OPENBSD_4_6_BASE:1.14
	OPENBSD_4_5:1.11.0.6
	OPENBSD_4_5_BASE:1.11
	OPENBSD_4_4:1.11.0.4
	OPENBSD_4_4_BASE:1.11
	OPENBSD_4_3:1.11.0.2
	OPENBSD_4_3_BASE:1.11
	OPENBSD_4_2:1.10.0.4
	OPENBSD_4_2_BASE:1.10
	OPENBSD_4_1:1.10.0.2
	OPENBSD_4_1_BASE:1.10
	OPENBSD_4_0:1.7.0.2
	OPENBSD_4_0_BASE:1.7
	OPENBSD_3_9:1.5.0.6
	OPENBSD_3_9_BASE:1.5
	OPENBSD_3_8:1.5.0.4
	OPENBSD_3_8_BASE:1.5
	OPENBSD_3_7:1.5.0.2
	OPENBSD_3_7_BASE:1.5
	OPENBSD_3_6:1.3.0.2
	OPENBSD_3_6_BASE:1.3
	avsm_2004-Jun-12:1.1.1.1
	avsm:1.1.1;
locks; strict;
comment	@# @;


1.34
date	2016.07.06.17.49.32;	author krw;	state Exp;
branches;
next	1.33;
commitid	Pi1xhANGHJBbI5H8;

1.33
date	2016.07.04.19.01.55;	author krw;	state Exp;
branches;
next	1.32;
commitid	p5gqSlDMSmOjT0xh;

1.32
date	2016.06.23.19.23.54;	author krw;	state Exp;
branches;
next	1.31;
commitid	vwUgBiCmN1lWQqPh;

1.31
date	2015.08.30.15.43.47;	author avsm;	state Exp;
branches;
next	1.30;
commitid	ibeX3QBDU59UI1Pc;

1.30
date	2014.10.21.19.12.28;	author chrisz;	state Exp;
branches;
next	1.29;
commitid	XCc0rPBbzeRUhx6m;

1.29
date	2014.09.02.09.24.44;	author chrisz;	state Exp;
branches;
next	1.28;
commitid	KxJKmDEHHsyD4e4B;

1.28
date	2014.08.25.15.20.19;	author chrisz;	state Exp;
branches;
next	1.27;
commitid	6BvEz6ub6gqZgyTj;

1.27
date	2014.08.21.20.54.04;	author chrisz;	state Exp;
branches;
next	1.26;
commitid	awCwxDnH1Bd4hpii;

1.26
date	2013.03.11.11.41.30;	author espie;	state Exp;
branches;
next	1.25;

1.25
date	2013.01.03.14.30.57;	author chrisz;	state Exp;
branches;
next	1.24;

1.24
date	2012.11.30.19.38.09;	author chrisz;	state Exp;
branches;
next	1.23;

1.23
date	2012.08.18.22.24.50;	author avsm;	state Exp;
branches;
next	1.22;

1.22
date	2012.07.12.10.11.38;	author edd;	state Exp;
branches;
next	1.21;

1.21
date	2012.07.09.20.36.18;	author edd;	state Exp;
branches;
next	1.20;

1.20
date	2011.12.21.21.32.37;	author avsm;	state Exp;
branches;
next	1.19;

1.19
date	2010.11.20.17.22.41;	author espie;	state Exp;
branches;
next	1.18;

1.18
date	2010.11.06.22.06.59;	author espie;	state Exp;
branches;
next	1.17;

1.17
date	2010.10.24.21.36.04;	author ajacoutot;	state Exp;
branches;
next	1.16;

1.16
date	2010.10.19.07.43.01;	author espie;	state Exp;
branches;
next	1.15;

1.15
date	2009.08.10.06.34.29;	author kili;	state Exp;
branches;
next	1.14;

1.14
date	2009.06.20.22.05.11;	author avsm;	state Exp;
branches;
next	1.13;

1.13
date	2009.04.03.21.30.50;	author sturm;	state Exp;
branches;
next	1.12;

1.12
date	2009.03.11.21.31.39;	author avsm;	state Exp;
branches;
next	1.11;

1.11
date	2007.09.15.21.14.01;	author merdely;	state Exp;
branches;
next	1.10;

1.10
date	2006.12.26.23.09.32;	author avsm;	state Exp;
branches;
next	1.9;

1.9
date	2006.12.26.22.39.31;	author avsm;	state Exp;
branches;
next	1.8;

1.8
date	2006.11.13.12.51.15;	author steven;	state Exp;
branches;
next	1.7;

1.7
date	2006.08.03.23.55.11;	author espie;	state Exp;
branches;
next	1.6;

1.6
date	2006.05.29.03.46.29;	author avsm;	state Exp;
branches;
next	1.5;

1.5
date	2004.12.30.12.06.22;	author espie;	state Exp;
branches;
next	1.4;

1.4
date	2004.12.20.10.35.35;	author alek;	state Exp;
branches;
next	1.3;

1.3
date	2004.08.16.21.12.37;	author naddy;	state Exp;
branches;
next	1.2;

1.2
date	2004.08.10.20.41.47;	author xsa;	state Exp;
branches;
next	1.1;

1.1
date	2004.06.12.21.45.34;	author avsm;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2004.06.12.21.45.34;	author avsm;	state Exp;
branches;
next	;


desc
@@


1.34
log
@Tweak PLIST/PFRAG so build/package works on non-dynlink-native archs again.

Remember to crank REVISION this time.
@
text
@# $OpenBSD: Makefile,v 1.33 2016/07/04 19:01:55 krw Exp $

COMMENT=	OCaml package manager
CATEGORIES=	sysutils
DISTNAME=	findlib-1.6.2
REVISION=	2

MASTER_SITES=	http://download.camlcity.org/download/

MAINTAINER=	Anil Madhavapeddy <avsm@@openbsd.org>
HOMEPAGE=	http://projects.camlcity.org/projects/findlib.html

# MIT/X11
PERMIT_PACKAGE_CDROM=	Yes

MODULES+=		x11/tk

WANTLIB +=		c m
RUN_DEPENDS +=		lang/ocaml lang/ocaml-camlp4
BUILD_DEPENDS +=	lang/ocaml lang/ocaml-camlp4

CONFIGURE_STYLE=simple
CONFIGURE_ARGS= -no-custom \
		-sitelib "${PREFIX}/lib/ocaml" \
		-config ${SYSCONFDIR}/findlib.conf

USE_GMAKE=	Yes
FAKE_FLAGS=	prefix=${DESTDIR}
NO_TEST=	Yes

.include <bsd.port.arch.mk>
.if ${PROPERTIES:Mocaml_native}
PKG_ARGS+=-Dnative=1
ALL_TARGET +=	all opt
.else
PKG_ARGS+=-Dnative=0
ALL_TARGET =	all
.endif

.if ${PROPERTIES:Mocaml_native_dynlink}
PKG_ARGS+=-Ddynlink=1
.else
PKG_ARGS+=-Ddynlink=0
.endif


post-install:
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/findlib
	mv \
	  ${WRKINST}${SYSCONFDIR}/findlib.conf \
	  ${PREFIX}/share/examples/findlib/

.include <bsd.port.mk>
@


1.33
log
@Update to latest (1.6.2).

Don't try to create the man3 directory or remove the .3 man pages that
are not generated because (according to the Makefile comment) ocamldoc is
hopeless at at generating them.

Placate portcheck by using ${PREFIX} instead of a hardcoded directory.

Maintainer timeout.

PLIST tweaks and ok chrisz@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2016/06/23 19:23:54 krw Exp $
d6 1
a6 1
REVISION=	1
@


1.32
log
@Stop building Ocaml's internal ocamlbuild and use the ocaml-ocamlbuild port
where needed.

The next step towards Ocaml 4.3.0.

Bulk build by sthen@@ identified several laggards which are included here.

ok anil@@ sthen@@ so final 4.3.0 polishing can be done in-tree.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2015/08/30 15:43:47 avsm Exp $
d5 1
a5 1
DISTNAME=	findlib-1.5.5
d24 1
a24 1
		-sitelib "/usr/local/lib/ocaml" \
@


1.31
log
@update to findlib-1.5.5

This introduces a strong dependency on ocaml-camlp4 in order to get the
safe_camlp4 script. This could be split into a subpackage in the future,
to get a base findlib package that does not depend on camlp4

ok jca@@, tested by krw@@ daniel@@ jsg@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2014/10/21 19:12:28 chrisz Exp $
d6 1
@


1.30
log
@Update to 1.5.4

ok avsm@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2014/09/02 09:24:44 chrisz Exp $
d5 1
a5 1
DISTNAME=	findlib-1.5.4
d18 2
a19 2
RUN_DEPENDS +=		lang/ocaml
BUILD_DEPENDS +=	lang/ocaml
@


1.29
log
@Upgrade OCaml to 4.02. Since camlp4 is now a seperate port,
add / change BUILD_DEPENDS for all ports using camlp4.
Findlib is changed because it won't use camlp4 and doesn't install
the Bytes module anymore, which is now included in OCaml 4.02.

ok avsm@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2014/08/25 15:20:19 chrisz Exp $
d5 1
a5 2
DISTNAME=	findlib-1.5.2
REVISION=	0
@


1.28
log
@Upgrade findlib to 1.5.2.
 * Don't use MODULES = lang/ocaml, because with 4.02 we will
   need to build findlib without camlp4, which will depend
   on findlib.
 * Remove patches accepted upstream.
 * Add one patch from upstream to fix building without
   ocamlfind in path yet and respecting PREFIX.

OK avsm@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2013/03/11 11:41:30 espie Exp $
d6 2
d20 1
a20 1
BUILD_DEPENDS +=	lang/ocaml lang/ocaml,-labltk lang/ocaml,-camlp4
d23 1
a23 2
CONFIGURE_ARGS=	-with-toolbox \
		-no-custom \
@


1.27
log
@Split off camlp4, labltk and graphics from our current OCaml 4.01.
This will help when upgrading to upcoming OCaml 4.02, which will miss camlp4
and labltk.
For a smooth transision, make all OCaml ports BUILD_DEPEND on camlp4 via
MODULES=ocaml.

sysutils/findlib is the only port using -labltk.
graphics/ocaml-camlimage is the only port using -graphics.


ok avsm@@
@
text
@d5 1
a5 2
DISTNAME=	findlib-1.3.3
REVISION=	2
d14 5
a18 4
WANTLIB =	c m
MODULES+=	lang/ocaml x11/tk
BUILD_DEPENDS +=lang/ocaml,-labltk
NO_TEST=	Yes
d28 1
a29 1
ALL_TARGET=	all
d32 5
a36 1
ALL_TARGET +=	opt
d38 7
@


1.26
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2013/01/03 14:30:57 chrisz Exp $
d6 1
a6 1
REVISION=	1
d17 1
@


1.25
log
@- on bytecode-archs build executable without custom runtime
- use /etc/findlib.conf instead of /usr/local/share/examples/findlib.conf.
- add commented out option to enable ocamldoc.opt by default to findlib.conf

OK jasper@@, anil@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2012/11/30 19:38:09 chrisz Exp $
a12 1
PERMIT_PACKAGE_FTP=	Yes
a13 2
PERMIT_DISTFILES_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
d17 1
a17 1
NO_REGRESS=	Yes
@


1.24
log
@update lang/ocaml to 4.00.1.
Let all ocaml ports RUN_DEPEND on the version of ocaml they were built with.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2012/08/18 22:24:50 avsm Exp $
d6 1
a6 1
REVISION=	0
d18 1
a18 1
WANTLIB =	c curses m pthread
d24 1
d26 1
a26 1
		-config ${PREFIX}/share/examples/findlib/findlib.conf
d36 6
@


1.23
log
@update to findlib-1.3.3
* support for ocaml 4.00.0
* change sitelib to /usr/local/lib/ocaml
* new MASTER_SITES and HOMEPAGE
* remove dependency on groff
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2012/07/12 10:11:38 edd Exp $
d6 1
@


1.22
log
@Unbreak findlib and dynlink:
http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=630490

Also fix dependencies and WANTLIB.

OK dcoppa@@, looks good aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2012/07/09 20:36:18 edd Exp $
d3 1
a3 1
COMMENT=	Objective Caml package manager
d5 2
a6 4
DISTNAME=	findlib-1.2.7
REVISION =	1

MASTER_SITES=	http://www.ocaml-programming.de/packages/
d9 1
a9 1
HOMEPAGE=	http://www.ocaml-programming.de/packages/
a17 1

a18 3
BUILD_DEPENDS =	${MODTK_BUILD_DEPENDS}
RUN_DEPENDS =	${MODTK_RUN_DEPENDS}

d22 3
a24 1
CONFIGURE_ARGS=	-with-toolbox -config ${PREFIX}/share/examples/findlib/findlib.conf
d26 1
a26 1
ALL_TARGET=	all ${MODOCAML_NATIVE:S,Yes,all opt,:S,No,,}
d29 5
a33 2
USE_GMAKE=	Yes
USE_GROFF =	Yes
@


1.21
log
@Fix native compilation for ocaml findlib.
OK giovanni@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2011/12/21 21:32:37 avsm Exp $
d6 2
a7 1
REVISION=	0
d18 2
a19 1
WANTLIB=		X11 c curses m pthread pthread-stubs tcl85 xcb
d22 3
a24 2
LIB_DEPENDS =	${MODTK_LIB_DEPENDS}
WANTLIB +=	${MODTK_WANTLIB}
@


1.20
log
@update to findlib-1.2.7
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2010/11/20 17:22:41 espie Exp $
d6 1
@


1.19
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2010/11/06 22:06:59 espie Exp $
d5 1
a5 2
DISTNAME=	findlib-1.2.4
REVISION =	2
@


1.18
log
@tk/tcl wantlib conversion
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2010/10/24 21:36:04 ajacoutot Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p2
@


1.17
log
@Remove USE_X11.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2010/10/19 07:43:01 espie Exp $
d20 2
a21 1
LIB_DEPENDS=	${MODTK_LIB_DEPENDS}
@


1.16
log
@USE_GROFF=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2009/08/10 06:34:29 kili Exp $
a29 1
USE_X11=	Yes
@


1.15
log
@WANTLIB changes after xcb addition and bump.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2009/06/20 22:05:11 avsm Exp $
d31 1
@


1.14
log
@update to ocaml-3.11.1 and bump dependent package PKGNAMEs
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2009/04/03 21:30:50 sturm Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p1
d17 1
a17 1
WANTLIB=		X11 c curses m pthread tcl85
@


1.13
log
@bump after ocaml update
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2009/03/11 21:31:39 avsm Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p0
@


1.12
log
@update to findlib-1.2.4
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2007/09/15 21:14:01 merdely Exp $
d6 1
@


1.11
log
@Remove surrounding quotes in COMMENT-*/PERMIT_*/IGNORE
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2006/12/26 23:09:32 avsm Exp $
d5 1
a5 2
DISTNAME=	findlib-1.1.2pl1
PKGNAME=	${DISTNAME}p1
d16 1
a16 1
WANTLIB=		X11 c curses m pthread tcl84
d18 2
a19 2
MODULES=	lang/ocaml
LIB_DEPENDS=	tk84.>=1:tk-8.4.*:x11/tk/8.4
d26 2
@


1.10
log
@Fix findlib to correctly detect posix threading instead of vm threads for
ocaml apps compiled using it.

Issue was that the configure script which tried threads gets confused by
the spurious OpenBSD linker warnings about sprintf and falls back to VM
threads.

Bump PKGNAME, and trim an unneeded line from PLIST while here.

Reported by Adam Montague <amontague@@siriushosting.com> and
Ivan M Makarenko <I.Makarenko@@zsttk.ru>.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2006/12/26 22:39:31 avsm Exp $
d3 1
a3 1
COMMENT=	"Objective Caml package manager"
@


1.9
log
@bump PKGNAME on ocaml ports for recent ocaml-3.09.3 dependency change
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2006/11/13 12:51:15 steven Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p0
@


1.8
log
@USE_X11
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2006/08/03 23:55:11 espie Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}
@


1.7
log
@new lib specs
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2006/05/29 03:46:29 avsm Exp $
d28 1
@


1.6
log
@update to findlib-1.1.2pl1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2004/12/30 12:06:22 espie Exp $
d20 1
a20 1
LIB_DEPENDS=	tk84.1:tk-8.4.*:x11/tk/8.4
@


1.5
log
@repair some dependency paths.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2004/12/20 10:35:35 alek Exp $
d5 2
a6 2
DISTNAME=	findlib-1.0.4
PKGNAME=	${DISTNAME}p0
d23 2
a24 4
SAMPLE_LOC=	${PREFIX}/share/examples/findlib
SAMPLE_FILE=	${SAMPLE_LOC}/ocamlfind.conf
MAKE_FLAGS=	PREFIX=${PREFIX} SYSCONFDIR=${SYSCONFDIR}
FAKE_FLAGS=	PREFIX=${PREFIX} SYSCONFDIR=${DESTDIR}${SAMPLE_LOC}
a27 4
SUBST_VARS=	SAMPLE_FILE

do-configure:
	cp ${WRKSRC}/Makefile.config.pattern ${WRKBUILD}/Makefile.config
@


1.4
log
@Add WANTLIB markers
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2004/08/16 21:12:37 naddy Exp $
d6 1
d20 1
a20 1
LIB_DEPENDS=	tk84.1::x11/tk/8.4
@


1.3
log
@add missing Tcl/Tk dependency; ok sturm@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2004/08/10 20:41:47 xsa Exp $
d16 1
@


1.2
log
@
more new-style MODULES.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2004/06/12 21:45:34 avsm Exp $
d18 2
a19 1
NO_REGRESS=Yes
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d17 1
a17 1
MODULES=	ocaml
@


1.1.1.1
log
@initial import of findlib-1.0.4
--
findlib provides a scheme to manage reusable Objective Caml software
components in the form of libraries, and includes tools that support
this scheme.

@
text
@@
