head	1.4;
access;
symbols
	OPENBSD_6_0:1.4.0.6
	OPENBSD_6_0_BASE:1.4
	OPENBSD_5_9:1.4.0.2
	OPENBSD_5_9_BASE:1.4
	OPENBSD_5_8:1.4.0.4
	OPENBSD_5_8_BASE:1.4;
locks; strict;
comment	@# @;


1.4
date	2015.04.03.09.04.00;	author jasper;	state Exp;
branches;
next	1.3;
commitid	T548BkWZKtXRGRGe;

1.3
date	2014.10.31.07.36.22;	author jasper;	state dead;
branches;
next	1.2;
commitid	X5SFtHm6VoEIGON9;

1.2
date	2014.08.26.19.58.25;	author jasper;	state Exp;
branches;
next	1.1;
commitid	QV3xI4oMWGaPtBTD;

1.1
date	2014.08.26.07.38.36;	author jasper;	state Exp;
branches;
next	;
commitid	IIq4sF57QibaEv1u;


desc
@@


1.4
log
@simplify processorspeed calculation

not much point in pushing it upstream since the new facter will be c++11 based
and needs newer boost..
@
text
@$OpenBSD$

Simplify processorspeed calculation.

--- lib/facter/processors/os.rb.orig	Fri Apr  3 10:57:00 2015
+++ lib/facter/processors/os.rb	Fri Apr  3 10:57:07 2015
@@@@ -183,8 +183,7 @@@@ module Facter
         if speed < 1000
           "#{speed} MHz"
         else
-          speed = speed.to_f / 1000
-          "#{(speed * 100).round.to_f / 100.0} GHz"
+          "#{(speed / 10).round.to_f / 100.0} GHz"
         end
       end
     end
@


1.3
log
@update to facter-2.3.0
@
text
@d1 1
a1 1
$OpenBSD: patch-lib_facter_processors_os_rb,v 1.2 2014/08/26 19:58:25 jasper Exp $
d3 1
a3 1
https://github.com/puppetlabs/facter/pull/771
d5 10
a14 5
--- lib/facter/processors/os.rb.orig	Mon Aug 25 22:04:40 2014
+++ lib/facter/processors/os.rb	Tue Aug 26 21:57:15 2014
@@@@ -177,6 +177,16 @@@@ module Facter
       def get_physical_processor_count
         Facter::Util::POSIX.sysctl("hw.ncpufound").to_i
a15 10
+
+      def get_processor_speed
+        speed = Facter::Util::POSIX.sysctl("hw.cpuspeed").to_i
+        if speed < 1000
+          "#{speed} MHz"
+        else
+          speed = speed.to_f / 1000
+          "#{(speed * 100).round.to_f / 100.0} GHz"
+        end
+      end
a16 2
 
     class SunOS < Base
@


1.2
log
@report a unit (MHz or GHz) for the processor speed
@
text
@d1 1
a1 1
$OpenBSD: patch-lib_facter_processors_os_rb,v 1.1 2014/08/26 07:38:36 jasper Exp $
@


1.1
log
@implement processors['speed']
@
text
@d1 1
a1 1
$OpenBSD$
d5 3
a7 3
--- lib/facter/processors/os.rb.orig	Tue Aug 26 09:37:21 2014
+++ lib/facter/processors/os.rb	Tue Aug 26 09:37:36 2014
@@@@ -177,6 +177,10 @@@@ module Facter
d13 7
a19 1
+        Facter::Util::POSIX.sysctl("hw.cpuspeed").to_i
@

