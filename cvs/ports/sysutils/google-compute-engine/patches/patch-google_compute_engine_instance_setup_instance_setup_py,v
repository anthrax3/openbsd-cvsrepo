head	1.1;
branch	1.1.1;
access;
symbols
	OPENBSD_6_2:1.1.1.1.0.2
	OPENBSD_6_2_BASE:1.1.1.1
	ajacoutot_20170629:1.1.1.1
	ajacoutot:1.1.1;
locks; strict;
comment	@# @;


1.1
date	2017.06.29.14.35.10;	author ajacoutot;	state Exp;
branches
	1.1.1.1;
next	;
commitid	FQ3NnBpJ9w1JuoMM;

1.1.1.1
date	2017.06.29.14.35.10;	author ajacoutot;	state Exp;
branches;
next	;
commitid	FQ3NnBpJ9w1JuoMM;


desc
@@



1.1
log
@Initial revision
@
text
@$OpenBSD$

Index: google_compute_engine/instance_setup/instance_setup.py
--- google_compute_engine/instance_setup/instance_setup.py.orig
+++ google_compute_engine/instance_setup/instance_setup.py
@@@@ -142,17 +142,9 @@@@ class InstanceSetup(object):
   def _StartSshd(self):
     """Initialize the SSH daemon."""
     # Exit as early as possible.
-    # Instance setup systemd scripts block sshd from starting.
-    if os.path.exists('/bin/systemctl'):
-      return
-    elif (os.path.exists('/etc/init.d/ssh') or
-          os.path.exists('/etc/init/ssh.conf')):
-      subprocess.call(['service', 'ssh', 'start'])
-      subprocess.call(['service', 'ssh', 'reload'])
-    elif (os.path.exists('/etc/init.d/sshd') or
-          os.path.exists('/etc/init/sshd.conf')):
-      subprocess.call(['service', 'sshd', 'start'])
-      subprocess.call(['service', 'sshd', 'reload'])
+    if (os.path.exists('/etc/rc.d/sshd')):
+      subprocess.call(['/etc/rc.d/sshd', 'start'])
+      subprocess.call(['/etc/rc.d/sshd', 'reload'])
 
   def _SetSshHostKeys(self):
     """Regenerates SSH host keys when the VM is restarted with a new IP address.
@


1.1.1.1
log
@Import google-compute-engine-2.4.0.

Google Compute Engine offers scripts and daemons which runs in the
background and provides the following services:
<...>

from MAINTAINER Helen Koike  helen dot koike at collabora dot com with a few tweaks
ok sthen@@
@
text
@@
