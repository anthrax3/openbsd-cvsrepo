head	1.6;
access;
symbols
	OPENBSD_4_2:1.5.0.8
	OPENBSD_4_2_BASE:1.5
	OPENBSD_4_1:1.5.0.6
	OPENBSD_4_1_BASE:1.5
	OPENBSD_4_0:1.5.0.4
	OPENBSD_4_0_BASE:1.5
	OPENBSD_3_9:1.5.0.2
	OPENBSD_3_9_BASE:1.5
	OPENBSD_3_8:1.4.0.2
	OPENBSD_3_8_BASE:1.4
	OPENBSD_3_7:1.3.0.2
	OPENBSD_3_7_BASE:1.3
	OPENBSD_3_6:1.2.0.2
	OPENBSD_3_6_BASE:1.2;
locks; strict;
comment	@# @;


1.6
date	2007.10.12.20.12.19;	author sturm;	state dead;
branches;
next	1.5;

1.5
date	2005.10.27.21.47.28;	author sturm;	state Exp;
branches;
next	1.4;

1.4
date	2005.07.21.15.16.47;	author aanriot;	state Exp;
branches;
next	1.3;

1.3
date	2004.10.01.21.22.15;	author sturm;	state Exp;
branches;
next	1.2;

1.2
date	2004.08.08.14.02.11;	author sturm;	state Exp;
branches;
next	1.1;

1.1
date	2004.06.17.11.21.43;	author sturm;	state Exp;
branches;
next	;


desc
@@


1.6
log
@update to cfengine 2.2.1
simplify port drastically by removing str* patches, these might be
revived one day as an external patch

no objections from maintainer
@
text
@$OpenBSD: patch-src_methods_c,v 1.5 2005/10/27 21:47:28 sturm Exp $
--- src/methods.c.orig	Fri Sep  9 01:56:25 2005
+++ src/methods.c	Fri Oct 21 16:35:56 2005
@@@@ -351,29 +351,29 @@@@ options[0] = '\0';
 
 if (INFORM)
    {
-   strcat(options,"-I ");
+   (void)strlcat(options,"-I ",sizeof(options));
    }
 
 if (IGNORELOCK)
    {
-   strcat(options,"-K ");
+   (void)strlcat(options,"-K ",sizeof(options));
    }
 
 if (VERBOSE)
    {
-   strcat(options,"-v ");
+   (void)strlcat(options,"-v ",sizeof(options));
    }
 
 if (DEBUG || D2)
    {
-   strcat(options,"-d2 ");
+   (void)strlcat(options,"-d2 ",sizeof(options));
    }
 
 ptr = IsDefinedMethod(name,digeststring);
 
-strcat(options,"-Z ");
-strcat(options,digeststring);
-strcat(options," ");
+(void)strlcat(options,"-Z ",sizeof(options));
+(void)strlcat(options,digeststring,sizeof(options));
+(void)strlcat(options," ",sizeof(options));
 
 snprintf(execstr,CF_BUFSIZE-1,"%s/bin/cfagent -f %s %s",CFWORKDIR,GetMethodFilename(ptr),options);
 
@@@@ -1145,10 +1145,10 @@@@ for (dirp = readdir(dirh); dirp != NULL;
    SplitMethodName(dirp->d_name,client,server,name,digeststring,extra);
 
    Debug("This request came from %s - our reply should be sent there!\n",client);
-   strcpy(METHODREPLYTO,client);
+   (void)strlcpy(METHODREPLYTO,client,sizeof(METHODREPLYTO));
 
    Debug("This request referred to us as %s - a plausible identity\n",client);
-   strcpy(METHODFOR,server);
+   (void)strlcpy(METHODFOR,server,sizeof(METHODFOR));
 
    if (strcmp(methodname,name) == 0)
       {
@


1.5
log
@update to 2.1.16, removing sbin/vicf which seems to have a security
problem but is not used anywhere and will probably be removed from
cfengine

from maintainer William Yodlowsky <bsd at openbsd.rutgers.edu>
@
text
@d1 1
a1 1
$OpenBSD: patch-src_methods_c,v 1.4 2005/07/21 15:16:47 aanriot Exp $
@


1.4
log
@update to 2.1.15, from William Yodlowsky (maintainer).

inputs and ok naddy@@
@
text
@d1 4
a4 4
$OpenBSD: patch-src_methods_c,v 1.3 2004/10/01 21:22:15 sturm Exp $
--- src/methods.c.orig	Wed Mar 23 14:00:54 2005
+++ src/methods.c	Fri Jul 15 12:24:01 2005
@@@@ -271,29 +271,29 @@@@ options[0] = '\0';
d41 1
a41 1
@@@@ -1066,10 +1066,10 @@@@ for (dirp = readdir(dirh); dirp != NULL;
@


1.3
log
@unbreak and update to 2.1.10

from maintainer William Yodlowsky <bsd at openbsd.rutgers.edu>
@
text
@d1 4
a4 4
$OpenBSD$
--- src/methods.c.orig	Tue Aug 17 20:11:28 2004
+++ src/methods.c	Fri Oct  1 23:14:49 2004
@@@@ -272,24 +272,24 @@@@ options[0] = '\0';
d12 6
d39 1
a39 1
 snprintf(execstr,CF_BUFSIZE-1,"%s/bin/cfagent -f %s %s",WORKDIR,GetMethodFilename(ptr),options);
d41 1
a41 1
@@@@ -1062,10 +1062,10 @@@@ for (dirp = readdir(dirh); dirp != NULL;
@


1.2
log
@update to cfengine 2.1.7p1

from maintainer William Yodlowsky <bsd at openbsd.rutgers.edu>
@
text
@d1 4
a4 4
$OpenBSD: patch-src_methods_c,v 1.1 2004/06/17 11:21:43 sturm Exp $
--- src/methods.c.orig	Sat Jun 19 05:25:32 2004
+++ src/methods.c	Mon Aug  2 15:45:48 2004
@@@@ -238,24 +238,24 @@@@ options[0] = '\0';
d32 1
a32 1
  
d35 1
a35 10
@@@@ -706,7 +706,7 @@@@ while (!feof(fp))
           
       case cfmeth_sendclass:
           Debug("Defining class: %s\n",arg);
-          strncpy(METHODRETURNCLASSES,arg,CF_BUFSIZE-1);
+          strlcpy(METHODRETURNCLASSES,arg,sizeof(METHODRETURNCLASSES));
           break;
           
       case cfmeth_attacharg:
@@@@ -1012,10 +1012,10 @@@@ for (dirp = readdir(dirh); dirp != NULL;
@


1.1
log
@revive cfengine port

this is version 2.1.6, from and maintained by
William Yodlowsky <bsd at openbsd.rutgers.edu>
@
text
@d1 3
a3 3
$OpenBSD$
--- src/methods.c.orig	2004-05-04 07:22:50.000000000 -0400
+++ src/methods.c	2004-06-10 16:11:06.000000000 -0400
d35 1
a35 1
@@@@ -693,7 +693,7 @@@@ while (!feof(fp))
d44 1
a44 1
@@@@ -998,7 +998,7 @@@@ for (dirp = readdir(dirh); dirp != NULL;
d47 1
a47 1
    Verbose("This request came from %s - our reply should be sent there!\n",client);
d50 5
a54 1
    
@

