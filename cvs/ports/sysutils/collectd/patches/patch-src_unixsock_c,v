head	1.2;
access;
symbols
	OPENBSD_6_2:1.2.0.2
	OPENBSD_6_2_BASE:1.2;
locks; strict;
comment	@# @;


1.2
date	2017.07.01.13.35.30;	author danj;	state Exp;
branches;
next	1.1;
commitid	9pSqV002Na5Q6LMi;

1.1
date	2017.06.29.00.33.59;	author danj;	state Exp;
branches;
next	;
commitid	FylFwm7cb8GbPoDx;


desc
@@


1.2
log
@Patches were committed upstream
@
text
@$OpenBSD: patch-src_unixsock_c,v 1.1 2017/06/29 00:33:59 danj Exp $

2048 is not enough to get getgrnam_r result

Committed upstream:
https://github.com/collectd/collectd/commit/24bdf52decaf93359aab0364fb11420af5cd4a21

Index: src/unixsock.c
--- src/unixsock.c.orig
+++ src/unixsock.c
@@@@ -134,7 +134,7 @@@@ static int us_open_socket(void) {
     const char *grpname;
     struct group *g;
     struct group sg;
-    char grbuf[2048];
+    char grbuf[4096];
 
     grpname = (sock_group != NULL) ? sock_group : COLLECTD_GRP_NAME;
     g = NULL;
@


1.1
log
@Enlarge some buffers because 2048 is not enough to get getgrnam_r result.
Also fix errno handling in exec.c. Many thanks to jca@@ for the help.

"if it builds, ship it" jca@@
@
text
@d1 1
a1 1
$OpenBSD$
d4 3
@

