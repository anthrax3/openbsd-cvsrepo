head	1.10;
access;
symbols
	OPENBSD_6_0:1.10.0.2
	OPENBSD_6_0_BASE:1.10
	OPENBSD_5_9:1.8.0.2
	OPENBSD_5_9_BASE:1.8
	OPENBSD_5_8:1.8.0.4
	OPENBSD_5_8_BASE:1.8
	OPENBSD_5_7:1.6.0.2
	OPENBSD_5_7_BASE:1.6
	OPENBSD_5_6:1.3.0.16
	OPENBSD_5_6_BASE:1.3
	OPENBSD_5_5:1.3.0.14
	OPENBSD_5_5_BASE:1.3
	OPENBSD_5_4:1.3.0.12
	OPENBSD_5_4_BASE:1.3
	OPENBSD_5_3:1.3.0.10
	OPENBSD_5_3_BASE:1.3
	OPENBSD_5_2:1.3.0.8
	OPENBSD_5_2_BASE:1.3
	OPENBSD_5_1_BASE:1.3
	OPENBSD_5_1:1.3.0.6
	OPENBSD_5_0:1.3.0.4
	OPENBSD_5_0_BASE:1.3
	OPENBSD_4_9:1.3.0.2
	OPENBSD_4_9_BASE:1.3
	OPENBSD_4_8:1.1.1.1.0.2
	OPENBSD_4_8_BASE:1.1.1.1
	landry_20100623:1.1.1.1
	landry:1.1.1;
locks; strict;
comment	@# @;


1.10
date	2016.06.13.09.12.40;	author landry;	state Exp;
branches;
next	1.9;
commitid	i1EY2nNVfBI2xXZF;

1.9
date	2016.04.22.15.27.45;	author sthen;	state Exp;
branches;
next	1.8;
commitid	p44DJZdGI7w9b4g1;

1.8
date	2015.07.23.07.33.17;	author landry;	state Exp;
branches;
next	1.7;
commitid	mFWJoll0XLJ4Rcdj;

1.7
date	2015.05.03.10.41.35;	author landry;	state Exp;
branches;
next	1.6;
commitid	BzZlj0UFCQtjwhCF;

1.6
date	2014.10.27.09.07.07;	author landry;	state Exp;
branches;
next	1.5;
commitid	6bTjJDhGm100kcqv;

1.5
date	2014.10.26.20.43.56;	author landry;	state Exp;
branches;
next	1.4;
commitid	Pqs7fyn0icDUbscJ;

1.4
date	2014.09.25.20.10.13;	author landry;	state Exp;
branches;
next	1.3;
commitid	ZsuZqR6aoW7tRgVV;

1.3
date	2010.11.29.20.20.41;	author jasper;	state Exp;
branches;
next	1.2;

1.2
date	2010.09.07.11.12.05;	author landry;	state Exp;
branches;
next	1.1;

1.1
date	2010.06.23.18.04.26;	author landry;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2010.06.23.18.04.26;	author landry;	state Exp;
branches;
next	;


desc
@@


1.10
log
@Update to collectd 5.5.1.

Remove patches merged upstream, add patch to fix the build from
https://github.com/collectd/collectd/issues/1674
@
text
@$OpenBSD: patch-configure,v 1.9 2016/04/22 15:27:45 sthen Exp $

- no Werror, breaks with gcrypt deprecation warnings
- dont check for pcap-bpf.h, not installed on openbsd
- in rrdtool the main librrd.so is now threadsafe, there is no more librrd_th.so

--- configure.orig	Fri Jan 22 10:55:47 2016
+++ configure	Mon Jun  6 09:18:40 2016
@@@@ -17470,7 +17470,7 @@@@ SAVE_CFLAGS="$CFLAGS"
 # Emulate behavior of src/Makefile.am
 if test "x$GCC" = "xyes"
 then
-	CFLAGS="$CFLAGS -Wall -Werror"
+	CFLAGS="$CFLAGS -Wall"
 fi
 
 { $as_echo "$as_me:${as_lineno-$LINENO}: checking for strtok_r" >&5
@@@@ -25194,7 +25194,7 @@@@ then
 
 
 fi
-if test "x$librrd_threadsafe" = "xyes"
+if 1
 then
 
 $as_echo "#define HAVE_THREADSAFE_LIBRRD 1" >>confdefs.h
@


1.9
log
@handle rrdtool lib change that I missed in collectd when I looked at
sqlports results (thanks nigel for pointing out), sync other wantlib
while there.
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.8 2015/07/23 07:33:17 landry Exp $
d7 3
a9 3
--- configure.orig	Wed May 27 08:51:50 2015
+++ configure	Fri Apr 22 16:21:02 2016
@@@@ -17312,7 +17312,7 @@@@ SAVE_CFLAGS="$CFLAGS"
d18 1
a18 25
@@@@ -23486,23 +23486,7 @@@@ fi
 done
 
 fi
-if test "x$with_libpcap" = "xyes"
-then
-	for ac_header in pcap-bpf.h
-do :
-  ac_fn_c_check_header_mongrel "$LINENO" "pcap-bpf.h" "ac_cv_header_pcap_bpf_h" "$ac_includes_default"
-if test "x$ac_cv_header_pcap_bpf_h" = xyes; then :
-  cat >>confdefs.h <<_ACEOF
-#define HAVE_PCAP_BPF_H 1
-_ACEOF
 
-else
-  with_libpcap="no (pcap-bpf.h not found)"
-fi
-
-done
-
-fi
 if test "x$with_libpcap" = "xyes"
 then
 	{ $as_echo "$as_me:${as_lineno-$LINENO}: checking whether libpcap has PCAP_ERROR_IFACE_NOT_UP" >&5
@@@@ -25067,7 +25051,7 @@@@ then
@


1.8
log
@Update to collectd 5.5.0.

Enable aggregation, curl_json, fhcount, log_logstash, memcached,
threshold, write_log & write_riemann plugins.
Add dependencies on devel/libyajl for curl_json & log_logstash and
devel/protobuf-c for write_riemann.
Add a README explaining how to run the daemon as _collectd user in case
you dont need the dns and ping plugins (the only ones requiring root).
Lots of patches merged upstream.

From Pavel Korovin with small tweaks by me, tested here on ppc.
@
text
@d1 8
a8 5
$OpenBSD: patch-configure,v 1.7 2015/05/03 10:41:35 landry Exp $
no Werror, breaks with gcrypt deprecation warnings
dont check for pcap-bpf.h, not installed on openbsd
--- configure.orig	Wed May 27 10:51:50 2015
+++ configure	Wed Jun  3 15:45:37 2015
d42 9
@


1.7
log
@Update to collectd 5.4.2.

See https://github.com/collectd/collectd/releases/tag/collectd-5.4.2 for details.

Enable memcachec, libvirt, python and nut plugins, each in its subpackage.

ok ajacoutot@@
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.6 2014/10/27 09:07:07 landry Exp $
d4 3
a6 14
need to include sys/param.h and unistd.h to properly reach swapctl() prototype
https://github.com/collectd/collectd/pull/779
--- configure.orig	Thu Feb 26 15:07:49 2015
+++ configure	Sat May  2 20:22:14 2015
@@@@ -12873,7 +12873,7 @@@@ eval "LTDLOPEN=\"$libname_spec\""
 
 
 
-$as_echo "#define LIBTOOL_VERSION 2" >>confdefs.h
+$as_echo "#define LIBTOOL_VERSION 1" >>confdefs.h
 
 
 
@@@@ -16954,7 +16954,7 @@@@ SAVE_CFLAGS="$CFLAGS"
d15 1
a15 63
@@@@ -17666,8 +17666,11 @@@@ else
 #  undef _LARGEFILE64_SOURCE
 #endif
 #include <sys/stat.h>
+#include <sys/param.h>
 #include <sys/swap.h>
+#include <unistd.h>
 
+
 int
 main ()
 {
@@@@ -17703,7 +17706,9 @@@@ else
 #  undef _LARGEFILE64_SOURCE
 #endif
 #include <sys/stat.h>
+#include <sys/param.h>
 #include <sys/swap.h>
+#include <unistd.h>
 
 int
 main ()
@@@@ -18740,16 +18745,16 @@@@ else
 fi
 
 
-ac_fn_c_check_member "$LINENO" "struct kinfo_proc" "kp_proc" "ac_cv_member_struct_kinfo_proc_kp_proc" "
+ac_fn_c_check_member "$LINENO" "struct kinfo_proc" "p_pid" "ac_cv_member_struct_kinfo_proc_p_pid" "
 #include <sys/param.h>
 #include <sys/sysctl.h>
 #include <kvm.h>
 
 "
-if test "x$ac_cv_member_struct_kinfo_proc_kp_proc" = xyes; then :
+if test "x$ac_cv_member_struct_kinfo_proc_p_pid" = xyes; then :
 
 cat >>confdefs.h <<_ACEOF
-#define HAVE_STRUCT_KINFO_PROC_KP_PROC 1
+#define HAVE_STRUCT_KINFO_PROC_P_PID 1
 _ACEOF
 
 
@@@@ -18763,16 +18768,16 @@@@ else
 		have_struct_kinfo_proc_openbsd="no"
 
 fi
-ac_fn_c_check_member "$LINENO" "struct kinfo_proc" "kp_eproc" "ac_cv_member_struct_kinfo_proc_kp_eproc" "
+ac_fn_c_check_member "$LINENO" "struct kinfo_proc" "p_ppid" "ac_cv_member_struct_kinfo_proc_p_ppid" "
 #include <sys/param.h>
 #include <sys/sysctl.h>
 #include <kvm.h>
 
 "
-if test "x$ac_cv_member_struct_kinfo_proc_kp_eproc" = xyes; then :
+if test "x$ac_cv_member_struct_kinfo_proc_p_ppid" = xyes; then :
 
 cat >>confdefs.h <<_ACEOF
-#define HAVE_STRUCT_KINFO_PROC_KP_EPROC 1
+#define HAVE_STRUCT_KINFO_PROC_P_PPID 1
 _ACEOF
 
 
@@@@ -22990,23 +22995,7 @@@@ fi
a38 18
@@@@ -23235,7 +23224,7 @@@@ then
 	SAVE_LIBS="$LIBS"
 	# trigger an error if Perl_load_module*() uses __attribute__nonnull__(3)
 	# (see issues #41 and #42)
-	CFLAGS="$CFLAGS $PERL_CFLAGS -Wall -Werror"
+	CFLAGS="$CFLAGS $PERL_CFLAGS -Wall"
 	LIBS="$LIBS $PERL_LIBS"
 
 	{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for broken Perl_load_module()" >&5
@@@@ -26803,7 +26792,7 @@@@ then
 	plugin_processes="yes"
 fi
 
-if test "x$with_kvm_getprocs" = "xyes" && test "x$have_struct_kinfo_proc_freebsd" = "xyes"
+if test "x$with_kvm_getprocs" = "xyes" && test "x$have_struct_kinfo_proc_openbsd" = "xyes"
 then
 	plugin_processes="yes"
 fi
@


1.6
log
@add links to upstream github PR
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.5 2014/10/26 20:43:56 landry Exp $
d6 3
a8 3
--- configure.orig	Sun Jan 26 09:10:00 2014
+++ configure	Fri Oct 24 10:41:43 2014
@@@@ -12793,7 +12793,7 @@@@ eval "LTDLOPEN=\"$libname_spec\""
d17 1
a17 1
@@@@ -16812,7 +16812,7 @@@@ SAVE_CFLAGS="$CFLAGS"
d26 1
a26 1
@@@@ -17524,8 +17524,11 @@@@ else
d38 1
a38 1
@@@@ -17561,7 +17564,9 @@@@ else
d48 1
a48 1
@@@@ -18562,16 +18567,16 @@@@ else
d68 1
a68 1
@@@@ -18585,16 +18590,16 @@@@ else
d88 1
a88 1
@@@@ -22812,23 +22817,7 @@@@ fi
d112 2
a113 2
@@@@ -23057,7 +23046,7 @@@@ then
 	SAVE_LDFLAGS="$LDFLAGS"
d118 1
a118 1
 	LDFLAGS="$LDFLAGS $PERL_LDFLAGS"
d121 1
a121 1
@@@@ -26629,7 +26618,7 @@@@ then
@


1.5
log
@Enable the processes & rrdcached plugins.

whack processes.c to use the same codepaths as freebsd's, taking into
account kinfo_proc differences.. to be properly pushed upstream.
Tested on ppc & amd64.
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.4 2014/09/25 20:10:13 landry Exp $
d5 1
@


1.4
log
@Long awaited update to collectd 5.4.1.

- remove useless MESSAGE, provide an rc script instead
- enable pf, target_v5upgrade, tail_csv and write_graphite plugins
- backport fixes from FreeBSD and NetBSD to build with newer libstatgrab
  (upstream collectd github ticket #445)
- remove the check and inclusion of pcap-bpf.h, we dont have/need it
- users of the previous 4.x version should refer to
  https://collectd.org/wiki/index.php/V4_to_v5_migration_guide for the
upgrade path.

tested on ppc & amd64.
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.3 2010/11/29 20:20:41 jasper Exp $
d6 1
a6 1
+++ configure	Mon Sep 22 17:32:52 2014
d47 40
d120 9
@


1.3
log
@SECURITY UPDATE of collectd to 4.10.2, among the regular bugfixes is a fix
for SA42393, collectd "cu_rrd_create_file()" Denial of Service Vulnerability.

ok landry@@
@
text
@d1 7
a7 4
$OpenBSD: patch-configure,v 1.2 2010/09/07 11:12:05 landry Exp $
--- configure.orig	Sat Nov 27 11:10:52 2010
+++ configure	Mon Nov 29 20:20:38 2010
@@@@ -11718,7 +11718,7 @@@@ LTDLOPEN=`eval "\\$ECHO \"$libname_spec\""`
d16 1
a16 1
@@@@ -15457,7 +15457,7 @@@@ SAVE_CFLAGS="$CFLAGS"
d25 47
a71 1
@@@@ -20752,7 +20752,7 @@@@ then
@


1.2
log
@Update to collectd 4.10.1, from Simon Kuhnle, thanks!
@
text
@d1 4
a4 4
$OpenBSD: patch-configure,v 1.1.1.1 2010/06/23 18:04:26 landry Exp $
--- configure.orig	Fri Jul  9 12:02:17 2010
+++ configure	Thu Aug  5 13:07:16 2010
@@@@ -11709,7 +11709,7 @@@@ LTDLOPEN=`eval "\\$ECHO \"$libname_spec\""`
d13 1
a13 1
@@@@ -15451,7 +15451,7 @@@@ SAVE_CFLAGS="$CFLAGS"
d22 1
a22 1
@@@@ -20750,7 +20750,7 @@@@ then
@


1.1
log
@Initial revision
@
text
@d1 4
a4 4
$OpenBSD$
--- configure.orig	Sat May  1 11:16:01 2010
+++ configure	Sat Jun 19 11:22:07 2010
@@@@ -11701,7 +11701,7 @@@@ LTDLOPEN=`eval "\\$ECHO \"$libname_spec\""`
d13 1
a13 1
@@@@ -15440,7 +15440,7 @@@@ SAVE_CFLAGS="$CFLAGS"
d22 1
a22 1
@@@@ -20747,7 +20747,7 @@@@ then
@


1.1.1.1
log
@Import of collectd 4.10, yet another monitoring daemon :

collectd gathers statistics about the system it is running on and stores
this information. Those statistics can then be used to find current
performance bottlenecks (i.e. performance analysis) and predict future
system load (i.e. capacity planning). Or if you just want pretty graphs
of your private server and are fed up with some homegrown solution
you're at the right place, too ;).

Reworked by bernd@@ to use MULTI_PACKAGES instead of FLAVORS, thanks!
With feedback from Nico Szalay.

ok bernd@@
@
text
@@
