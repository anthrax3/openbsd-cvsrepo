head	1.4;
access;
symbols
	OPENBSD_6_1:1.4.0.18
	OPENBSD_6_1_BASE:1.4
	OPENBSD_6_0:1.4.0.16
	OPENBSD_6_0_BASE:1.4
	OPENBSD_5_9:1.4.0.12
	OPENBSD_5_9_BASE:1.4
	OPENBSD_5_8:1.4.0.14
	OPENBSD_5_8_BASE:1.4
	OPENBSD_5_7:1.4.0.10
	OPENBSD_5_7_BASE:1.4
	OPENBSD_5_6:1.4.0.8
	OPENBSD_5_6_BASE:1.4
	OPENBSD_5_5:1.4.0.6
	OPENBSD_5_5_BASE:1.4
	OPENBSD_5_4:1.4.0.4
	OPENBSD_5_4_BASE:1.4
	OPENBSD_5_3:1.4.0.2
	OPENBSD_5_3_BASE:1.4
	OPENBSD_5_2:1.3.0.2
	OPENBSD_5_2_BASE:1.3
	OPENBSD_5_1_BASE:1.2
	OPENBSD_5_1:1.2.0.2
	OPENBSD_5_0:1.1.0.2
	OPENBSD_5_0_BASE:1.1;
locks; strict;
comment	@# @;


1.4
date	2012.12.31.09.36.38;	author chrisz;	state Exp;
branches;
next	1.3;

1.3
date	2012.04.13.21.21.10;	author pascal;	state Exp;
branches;
next	1.2;

1.2
date	2011.09.11.18.53.28;	author dcoppa;	state Exp;
branches;
next	1.1;

1.1
date	2011.04.27.12.55.10;	author dcoppa;	state Exp;
branches;
next	;


desc
@@


1.4
log
@update to conky-1.9.0

OK jasper@@, benoit@@ (maintainer)
@
text
@$OpenBSD: patch-src_core_c,v 1.3 2012/04/13 21:21:10 pascal Exp $
--- src/core.c.orig	Thu May  3 23:08:27 2012
+++ src/core.c	Tue Jul 24 18:10:39 2012
@@@@ -170,9 +170,9 @@@@ struct text_object *construct_text_object(const char *
 #else
 			NORM_ERR("acpiacadapter: arg is only used on linux");
 #endif
-		}
+		} END
 #endif /* !__OpenBSD__ */
-	END OBJ(freq, 0)
+	OBJ(freq, 0)
 		get_cpu_count();
 		if (!arg || !isdigit(arg[0]) || strlen(arg) >= 2 || atoi(&arg[0]) == 0
 				|| atoi(&arg[0]) > info.cpu_count) {
@@@@ -326,7 +326,7 @@@@ struct text_object *construct_text_object(const char *
 			obj->data.i = PB_BATT_STATUS;
 		}
 #endif /* __linux__ */
-#if (defined(__FreeBSD__) || defined(__linux__))
+#if (defined(__FreeBSD__) || defined (__OpenBSD__) || defined(__linux__))
 	END OBJ_IF_ARG(if_up, 0, "if_up needs an argument")
 		parse_if_up_arg(obj, arg);
 #endif
@@@@ -860,7 +860,7 @@@@ struct text_object *construct_text_object(const char *
 	END OBJ(gw_ip, &update_gateway_info)
 #endif /* !__linux__ */
 #if (defined(__FreeBSD__) || defined(__FreeBSD_kernel__) \
-		|| defined(__OpenBSD__)) && (defined(i386) || defined(__i386__))
+		|| defined(__OpenBSD__))
 	END OBJ(apm_adapter, 0)
 	END OBJ(apm_battery_life, 0)
 	END OBJ(apm_battery_time, 0)
@@@@ -1523,7 +1523,7 @@@@ void free_text_objects(struct text_object *root, int i
 					free(data.s);
 				break;
 #endif
-#if (defined(__FreeBSD__) || defined(__linux__))
+#if (defined(__FreeBSD__) || defined(__OpenBSD__) || defined(__linux__))
 			case OBJ_if_up:
 				free_if_up(obj);
 				break;
@


1.3
log
@Fix conky with rthreads.  Joint work with kurt@@, with input from guenther@@.

ok benoit@@ (maintainer)
@
text
@d1 3
a3 3
$OpenBSD: patch-src_core_c,v 1.2 2011/09/11 18:53:28 dcoppa Exp $
--- src/core.c.orig	Tue Oct  5 17:29:36 2010
+++ src/core.c	Wed Apr  4 17:48:06 2012
d25 1
a25 12
@@@@ -541,8 +541,10 @@@@ struct text_object *construct_text_object(const char *
 		parse_platform_sensor(obj, arg);
 	END OBJ_ARG(hwmon, 0, "hwmon needs argumanets")
 		parse_hwmon_sensor(obj, arg);
+#endif
 	END OBJ(addr, &update_net_stats)
 		parse_net_stat_arg(obj, arg, free_at_crash);
+#ifdef __linux__
 	END OBJ(addrs, &update_net_stats)
 		parse_net_stat_arg(obj, arg, free_at_crash);
 #endif /* __linux__ */
@@@@ -860,7 +862,7 @@@@ struct text_object *construct_text_object(const char *
d34 1
a34 1
@@@@ -1516,7 +1518,7 @@@@ void free_text_objects(struct text_object *root, int i
@


1.2
log
@- Reenable $addr and $if_up
- Enable the new SMP code (allowing the user to actually see multiple
  cores)
- Enable RES and VSIZE display in $top

From Pascal Stumpf: thanks!

ok benoit@@, jasper@@
@
text
@d1 4
a4 12
$OpenBSD: patch-src_core_c,v 1.1 2011/04/27 12:55:10 dcoppa Exp $
--- src/core.c.orig	Tue Oct  5 23:29:36 2010
+++ src/core.c	Mon Jul 18 14:02:29 2011
@@@@ -75,6 +75,7 @@@@
 #include "freebsd.h"
 #elif defined(__OpenBSD__)
 #include "openbsd.h"
+int64_t *fresh;
 #endif
 
 #include <string.h>
@@@@ -170,10 +171,14 @@@@ struct text_object *construct_text_object(const char *
a13 4
+#ifdef __OpenBSD__
+		free(fresh);
+		fresh = NULL;
+#endif
d16 1
a16 2
 			obj->data.i = 1;
@@@@ -326,7 +331,7 @@@@ struct text_object *construct_text_object(const char *
d25 1
a25 1
@@@@ -541,8 +546,10 @@@@ struct text_object *construct_text_object(const char *
d36 1
a36 1
@@@@ -860,7 +867,7 @@@@ struct text_object *construct_text_object(const char *
d45 1
a45 1
@@@@ -1516,7 +1523,7 @@@@ void free_text_objects(struct text_object *root, int i
@


1.1
log
@Update to conky-1.8.1.

Added audacious, imlib2 and xmms2 flavors.

USE_GROFF and manpage patching during post-install are no more
needed.

Joint work with Pascal Stumpf (thanks!)
OK jasper@@, benoit@@ (maintainer)
@
text
@d1 1
a1 1
$OpenBSD$
d3 10
a12 2
+++ src/core.c	Tue Apr 19 19:43:51 2011
@@@@ -170,9 +170,9 @@@@ struct text_object *construct_text_object(const char *
d22 4
d28 22
a49 1
@@@@ -860,7 +860,7 @@@@ struct text_object *construct_text_object(const char *
d58 9
@

