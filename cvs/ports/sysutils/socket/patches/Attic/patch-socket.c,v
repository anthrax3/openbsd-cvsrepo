head	1.3;
access;
symbols
	OPENBSD_4_9:1.2.0.36
	OPENBSD_4_9_BASE:1.2
	OPENBSD_4_8:1.2.0.34
	OPENBSD_4_8_BASE:1.2
	OPENBSD_4_7:1.2.0.32
	OPENBSD_4_7_BASE:1.2
	OPENBSD_4_6:1.2.0.30
	OPENBSD_4_6_BASE:1.2
	OPENBSD_4_5:1.2.0.28
	OPENBSD_4_5_BASE:1.2
	OPENBSD_4_4:1.2.0.26
	OPENBSD_4_4_BASE:1.2
	OPENBSD_4_3:1.2.0.24
	OPENBSD_4_3_BASE:1.2
	OPENBSD_4_2:1.2.0.22
	OPENBSD_4_2_BASE:1.2
	OPENBSD_4_1:1.2.0.20
	OPENBSD_4_1_BASE:1.2
	OPENBSD_4_0:1.2.0.18
	OPENBSD_4_0_BASE:1.2
	OPENBSD_3_9:1.2.0.16
	OPENBSD_3_9_BASE:1.2
	OPENBSD_3_8:1.2.0.14
	OPENBSD_3_8_BASE:1.2
	OPENBSD_3_7:1.2.0.12
	OPENBSD_3_7_BASE:1.2
	OPENBSD_3_6:1.2.0.10
	OPENBSD_3_6_BASE:1.2
	OPENBSD_3_5:1.2.0.8
	OPENBSD_3_5_BASE:1.2
	OPENBSD_3_4:1.2.0.6
	OPENBSD_3_4_BASE:1.2
	OPENBSD_3_3:1.2.0.4
	OPENBSD_3_3_BASE:1.2
	OPENBSD_3_2:1.2.0.2
	OPENBSD_3_2_BASE:1.2
	OPENBSD_3_1:1.1.0.10
	OPENBSD_3_1_BASE:1.1
	OPENBSD_3_0:1.1.0.8
	OPENBSD_3_0_BASE:1.1
	OPENBSD_2_9_TRACKING_SWITCH:1.1
	OPENBSD_2_9:1.1.0.6
	OPENBSD_2_9_BASE:1.1
	OPENBSD_2_8:1.1.0.4
	OPENBSD_2_8_BASE:1.1
	OPENBSD_2_7:1.1.0.2
	OPENBSD_2_7_BASE:1.1;
locks; strict;
comment	@ * @;


1.3
date	2011.07.08.11.19.35;	author jasper;	state dead;
branches;
next	1.2;

1.2
date	2002.04.17.21.38.11;	author naddy;	state Exp;
branches;
next	1.1;

1.1
date	2000.04.01.04.34.29;	author brad;	state Exp;
branches;
next	;


desc
@@


1.3
log
@- fix patch names
@
text
@$OpenBSD: patch-socket.c,v 1.2 2002/04/17 21:38:11 naddy Exp $
--- socket.c.orig	Wed Sep  9 16:14:34 1992
+++ socket.c	Wed Apr 17 23:20:31 2002
@@@@ -18,6 +18,8 @@@@ Please read the file COPYRIGHT for furth
 #else
 #include <string.h>
 #endif
+#include <stdlib.h>
+#include <unistd.h>
 #include "globals.h"
 
 /* global variables */
@@@@ -37,6 +39,8 @@@@ char *pipe_program = NULL ;	/* program t
 void server A((int port, char *service_name)) ;
 void handle_server_connection A((void)) ;
 void client A((char *host, int port, char *service_name)) ;
+extern void init_signals A((void)) ;
+extern void do_io A((void)) ;
 
 int main(argc, argv)
 int argc ;
@@@@ -46,7 +50,7 @@@@ char **argv ;
     int opt ;			/* option character */
     int error = 0 ;		/* usage error occurred */
     extern int optind ;		/* from getopt() */
-    char *host ;		/* name of remote host */
+    /* char *host ; */		/* name of remote host */
     int port ;			/* port number for socket */
     char *service_name ;	/* name of service for port */
 
@@@@ -58,7 +62,7 @@@@ char **argv ;
 
     /* set up progname for later use */
     progname = argv[0] ;
-    if (cp = strrchr(progname, '/')) progname = cp + 1 ;
+    if ((cp = strrchr(progname, '/'))) progname = cp + 1 ;
 
     /* parse options */
     while ((opt = getopt(argc, argv, "bcflp:qrsvw?")) != -1) {
@@@@ -185,15 +189,15 @@@@ char *service_name ;
 		long norder ;
 		char dotted[20] ;
 
-		he = gethostbyaddr(&sa.sin_addr.s_addr,
+		he = gethostbyaddr((char *)&sa.sin_addr.s_addr,
 				   sizeof(sa.sin_addr.s_addr), AF_INET) ;
 		if (!he) {
 		    norder = htonl(sa.sin_addr.s_addr) ;
 		    sprintf(dotted, "%d.%d.%d.%d",
-			    (norder >> 24) & 0xff,
-			    (norder >> 16) & 0xff,
-			    (norder >>  8) & 0xff,
-			    norder & 0xff) ;
+			    (int)((norder >> 24) & 0xff),
+			    (int)((norder >> 16) & 0xff),
+			    (int)((norder >>  8) & 0xff),
+			    (int)(norder & 0xff)) ;
 		}
 		fprintf(stderr, "connection from %s\n",
 			(he ? he->h_name : dotted)) ;
@


1.2
log
@- cut down DESCR to a reasonable size; from Sebastian Stark <seb@@todesplanet.de>
- include prototype for malloc()
- regen patches with update-patches and add RCS IDs
- cleanup
@
text
@d1 1
a1 1
$OpenBSD$
@


1.1
log
@*** empty log message ***
@
text
@d1 4
a4 3
--- socket.c.orig	Wed Sep  9 10:14:34 1992
+++ socket.c	Fri Mar 31 17:08:21 2000
@@@@ -18,6 +18,8 @@@@
d13 1
a13 1
@@@@ -37,6 +39,8 @@@@
d22 1
a22 1
@@@@ -46,7 +50,7 @@@@
d31 1
a31 1
@@@@ -58,7 +62,7 @@@@
d40 1
a40 1
@@@@ -185,15 +189,15 @@@@
@

