head	1.4;
access;
symbols
	OPENBSD_4_9:1.3.0.12
	OPENBSD_4_9_BASE:1.3
	OPENBSD_4_8:1.3.0.10
	OPENBSD_4_8_BASE:1.3
	OPENBSD_4_7:1.3.0.8
	OPENBSD_4_7_BASE:1.3
	OPENBSD_4_6:1.3.0.6
	OPENBSD_4_6_BASE:1.3
	OPENBSD_4_5:1.3.0.4
	OPENBSD_4_5_BASE:1.3
	OPENBSD_4_4:1.3.0.2
	OPENBSD_4_4_BASE:1.3
	jasper_20080414:1.1.1.1
	jasper:1.1.1;
locks; strict;
comment	@# @;


1.4
date	2011.06.02.10.01.22;	author ajacoutot;	state dead;
branches;
next	1.3;

1.3
date	2008.07.07.16.24.16;	author jasper;	state Exp;
branches;
next	1.2;

1.2
date	2008.06.26.10.21.03;	author ajacoutot;	state Exp;
branches;
next	1.1;

1.1
date	2008.04.14.13.39.51;	author jasper;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2008.04.14.13.39.51;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.4
log
@Remove, superseded by backintime{-gnome}. Newer versions are too Linux
centric anyway (hal, devices...).
@
text
@$OpenBSD: patch-flyback_py,v 1.3 2008/07/07 16:24:16 jasper Exp $
--- flyback.py.orig	Thu Nov 15 07:22:16 2007
+++ flyback.py	Mon Jul  7 18:23:12 2008
@@@@ -21,7 +21,7 @@@@ import os, sys, traceback, math
 
 RUN_FROM_DIR = os.path.abspath(os.path.dirname(sys.argv[0])) + '/'
 VERSION = 'v0.4.0'
-GPL = open( RUN_FROM_DIR + 'GPL.txt', 'r' ).read()
+GPL = open( '!!PREFIX!!/share/flyback/' + 'GPL.txt', 'r' ).read()
 
 DEFAULT_EXCLUDES = [
     '/**/.thumbnails/',
@@@@ -243,7 +243,10 @@@@ class main_gui:
                 files.extend(not_dirs)
             for file in files:
                 full_file_name = os.path.join( focus_dir, file )
-                file_stats = os.stat(full_file_name)
+                try:
+                   file_stats = os.stat(full_file_name)
+                except os.error:
+                   pass
                 color = False
 #                print 'full_file_name', full_file_name
 #                print 'file_stats', file_stats
@@@@ -327,7 +330,7 @@@@ class main_gui:
     def __init__(self):
         
         gnome.init("programname", "version")
-        self.xml = gtk.glade.XML(RUN_FROM_DIR + 'viewer.glade')
+        self.xml = gtk.glade.XML('!!PREFIX!!' + '/share/flyback/' + 'viewer.glade')
         o = self
         self.backup = backup(o)
         
@@@@ -589,13 +592,13 @@@@ class prefs_gui:
     def install_crontab(self, c):
         existing_crons = []
         
-        stdin, stdout = os.popen4('crontab -l')
+        stdin, stdout = os.popen4('crontab -l | grep -v "DO NOT EDIT THIS FILE" | grep -v "/tmp/.* installed on" | grep -v "Cron version .* crontab.c"')
         for line in stdout:
             if line.startswith('no crontab for'): continue
             if line.endswith('#flyback\n'): continue
             existing_crons.append(line)
         if c:
-            existing_crons.append(c + ' python '+ os.getcwd() +'/flyback.py --backup #flyback\n')
+            existing_crons.append(c + ' !!MODPY_BIN!! '+ RUN_FROM_DIR +'/flyback.py --backup #flyback\n')
         stdin.close()
         stdout.close()
 
@@@@ -631,7 +634,7 @@@@ class prefs_gui:
         # init external_storage_location
         external_storage_location = client.get_string("/apps/flyback/external_storage_location")
         if not external_storage_location:
-            external_storage_location = '/external_storage_location'
+            external_storage_location = '/var/tmp'
         self.xml.get_widget('external_storage_location').set_current_folder( external_storage_location )
 
         self.xml.get_widget('prefs_dialog').show()
@


1.3
log
@- make the crontabs work
@
text
@d1 1
a1 1
$OpenBSD: patch-flyback_py,v 1.2 2008/06/26 10:21:03 ajacoutot Exp $
@


1.2
log
@- add .desktop file ; from jasper@@
- ignore broken symlink errors so we don't crash at startup

ok jasper@@
@
text
@d1 1
a1 1
$OpenBSD: patch-flyback_py,v 1.1.1.1 2008/04/14 13:39:51 jasper Exp $
d3 1
a3 1
+++ flyback.py	Thu Jun 26 11:26:38 2008
d46 1
a46 1
+            existing_crons.append(c + ' !!MODPY_BIN!! '+ os.getcwd() +'/flyback.py --backup #flyback\n')
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
$OpenBSD$
d3 1
a3 1
+++ flyback.py	Mon Apr 14 14:09:38 2008
d13 13
a25 1
@@@@ -327,7 +327,7 @@@@ class main_gui:
d34 1
a34 1
@@@@ -589,13 +589,13 @@@@ class prefs_gui:
d50 1
a50 1
@@@@ -631,7 +631,7 @@@@ class prefs_gui:
@


1.1.1.1
log
@import flyback 0.4.0

Apple's Time Machine is a great feature in their OS, and UNIX has
almost all of the required technology already built in to recreate it.
This is a simple GUI to make it easy to use.

help and ok ajacoutot@@
@
text
@@
