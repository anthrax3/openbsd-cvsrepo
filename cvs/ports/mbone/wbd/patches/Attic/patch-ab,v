head	1.3;
access;
symbols
	OPENBSD_4_0:1.2.0.28
	OPENBSD_4_0_BASE:1.2
	OPENBSD_3_9:1.2.0.26
	OPENBSD_3_9_BASE:1.2
	OPENBSD_3_8:1.2.0.24
	OPENBSD_3_8_BASE:1.2
	OPENBSD_3_7:1.2.0.22
	OPENBSD_3_7_BASE:1.2
	OPENBSD_3_6:1.2.0.20
	OPENBSD_3_6_BASE:1.2
	OPENBSD_3_5:1.2.0.18
	OPENBSD_3_5_BASE:1.2
	OPENBSD_3_4:1.2.0.16
	OPENBSD_3_4_BASE:1.2
	OPENBSD_3_3:1.2.0.14
	OPENBSD_3_3_BASE:1.2
	OPENBSD_3_2:1.2.0.12
	OPENBSD_3_2_BASE:1.2
	OPENBSD_3_1:1.2.0.10
	OPENBSD_3_1_BASE:1.2
	OPENBSD_3_0:1.2.0.8
	OPENBSD_3_0_BASE:1.2
	OPENBSD_2_9_TRACKING_SWITCH:1.2
	OPENBSD_2_9:1.2.0.6
	OPENBSD_2_9_BASE:1.2
	OPENBSD_2_8:1.2.0.4
	OPENBSD_2_8_BASE:1.2
	OPENBSD_2_7:1.2.0.2
	OPENBSD_2_7_BASE:1.2
	OPENBSD_2_6:1.1.0.2
	OPENBSD_2_6_BASE:1.1;
locks; strict;
comment	@# @;


1.3
date	2006.10.18.13.52.34;	author sturm;	state dead;
branches;
next	1.2;

1.2
date	99.10.30.22.14.50;	author brad;	state Exp;
branches;
next	1.1;

1.1
date	99.09.03.16.40.31;	author angelos;	state Exp;
branches;
next	;


desc
@@


1.3
log
@as discussed on icb, remove too old to be of much use and unmaintained
mbone category
@
text
@--- comms.c.orig	Tue Feb 16 10:24:20 1999
+++ comms.c	Sat Oct 30 17:24:59 1999
@@@@ -1260,7 +1260,7 @@@@
     struct action      *action  = NULL;
     struct pk_draw_msg *message = NULL;
     char arg[LEN];
-    char filename[L_tmpnam] = "";
+    char filename[L_tmpnam] = "wbd.XXXXXXXX";
     FILE *tmpfile;
     int i, result;
 
@@@@ -1287,13 +1287,7 @@@@
     }
 
     /* Dump the PostScript to a temp file. */
-	if (tmpnam (filename) == NULL)
-    {
-        printf ("Failed to create temp file.\n");
-        return -1;
-    }
-    tmpfile = fopen (filename, "wb");
-    if (tmpfile == NULL)
+    if ((tmpfile = fdopen(mkstemp(filename), "wb")) == NULL)
     {
         printf ("Failed to create temp file.\n");
         return -1;
@


1.2
log
@convert patch to unified diff
@
text
@@


1.1
log
@Make this compile, remove an tmpname/fopen race.
@
text
@d1 26
a26 42
*** comms.c.orig	Fri Sep  3 12:27:47 1999
--- comms.c	Fri Sep  3 12:35:34 1999
***************
*** 1260,1266 ****
      struct action      *action  = NULL;
      struct pk_draw_msg *message = NULL;
      char arg[LEN];
!     char filename[L_tmpnam] = "";
      FILE *tmpfile;
      int i, result;
  
--- 1260,1266 ----
      struct action      *action  = NULL;
      struct pk_draw_msg *message = NULL;
      char arg[LEN];
!     char filename[L_tmpnam] = "wbd.XXXXXXXX";
      FILE *tmpfile;
      int i, result;
  
***************
*** 1287,1299 ****
      }
  
      /* Dump the PostScript to a temp file. */
! 	if (tmpnam (filename) == NULL)
!     {
!         printf ("Failed to create temp file.\n");
!         return -1;
!     }
!     tmpfile = fopen (filename, "wb");
!     if (tmpfile == NULL)
      {
          printf ("Failed to create temp file.\n");
          return -1;
--- 1287,1293 ----
      }
  
      /* Dump the PostScript to a temp file. */
!     if ((tmpfile = fdopen(mkstemp(filename), "wb")) == NULL)
      {
          printf ("Failed to create temp file.\n");
          return -1;
@

