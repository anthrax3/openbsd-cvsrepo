head	1.3;
access;
symbols
	OPENBSD_5_7:1.2.0.12
	OPENBSD_5_7_BASE:1.2
	OPENBSD_5_6:1.2.0.10
	OPENBSD_5_6_BASE:1.2
	OPENBSD_5_5:1.2.0.8
	OPENBSD_5_5_BASE:1.2
	OPENBSD_5_4:1.2.0.6
	OPENBSD_5_4_BASE:1.2
	OPENBSD_5_3:1.2.0.4
	OPENBSD_5_3_BASE:1.2
	OPENBSD_5_2:1.2.0.2
	OPENBSD_5_2_BASE:1.2
	OPENBSD_5_1_BASE:1.1
	OPENBSD_5_1:1.1.0.14
	OPENBSD_5_0:1.1.0.12
	OPENBSD_5_0_BASE:1.1
	OPENBSD_4_9:1.1.0.10
	OPENBSD_4_9_BASE:1.1
	OPENBSD_4_8:1.1.0.8
	OPENBSD_4_8_BASE:1.1
	OPENBSD_4_7:1.1.0.6
	OPENBSD_4_7_BASE:1.1
	OPENBSD_4_6:1.1.0.4
	OPENBSD_4_6_BASE:1.1
	OPENBSD_4_5:1.1.0.2
	OPENBSD_4_5_BASE:1.1;
locks; strict;
comment	@# @;


1.3
date	2015.06.18.06.59.48;	author jasper;	state dead;
branches;
next	1.2;
commitid	2fnsdLaChIKjWzLr;

1.2
date	2012.05.08.12.48.14;	author landry;	state Exp;
branches;
next	1.1;

1.1
date	2008.09.15.21.49.10;	author jakemsr;	state Exp;
branches;
next	;


desc
@@


1.3
log
@remove daapd; it's dead upstream and doesn't work with newer protocol versions

ok aja@@
@
text
@$OpenBSD: patch-db_cc,v 1.2 2012/05/08 12:48:14 landry Exp $
--- db.cc.orig	Sun Mar  5 14:39:37 2006
+++ db.cc	Wed May  2 16:25:48 2012
@@@@ -42,7 +42,7 @@@@
 #include <id3tag.h>
 
 #ifdef MPEG4_ENABLE
-	#include <mp4.h>
+	#include <mp4v2/mp4v2.h>
 #endif
 
 
@@@@ -325,7 +325,7 @@@@ void Database::addM4a( std::string& path, struct stat 
 			MP4TrackId trackId = MP4FindTrackId(mp4file, 0);
 			u32 timeScale = MP4GetTrackTimeScale(mp4file, trackId);
 			MP4Duration trackDuration = MP4GetTrackDuration(mp4file, trackId);
-			double msDuration = UINT64_TO_DOUBLE(MP4ConvertFromTrackDuration(mp4file, trackId, trackDuration, MP4_MSECS_TIME_SCALE));
+			double msDuration = (double)(MP4ConvertFromTrackDuration(mp4file, trackId, trackDuration, MP4_MSECS_TIME_SCALE));
 			u32 avgBitRate = MP4GetTrackBitRate(mp4file, trackId);
 			song->time = (u32) (msDuration);
 			song->bitrate = (u16) ((avgBitRate + 500) / 1000);
@


1.2
log
@Adapt after libmp4v2 update.
@
text
@d1 1
a1 1
$OpenBSD: patch-db_cc,v 1.1 2008/09/15 21:49:10 jakemsr Exp $
@


1.1
log
@
- get libmp4v2 from multimedia/libmp4v2 instead of audio/faad
- @@bin marker

ok brad@@
@
text
@d1 12
a12 3
$OpenBSD$
--- db.cc.orig	Tue Jul 22 02:40:07 2008
+++ db.cc	Tue Jul 22 02:40:07 2008
@

