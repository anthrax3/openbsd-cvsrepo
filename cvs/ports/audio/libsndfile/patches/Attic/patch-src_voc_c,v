head	1.1;
access;
symbols
	OPENBSD_4_5:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2009.06.30.02.28.49;	author william;	state dead;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2009.06.30.02.28.49;	author william;	state Exp;
branches;
next	;


desc
@@


1.1
log
@file patch-src_voc_c was initially added on branch OPENBSD_4_5.
@
text
@@


1.1.2.1
log
@SECURITY FIX

CVE-2007-4974
CVE-2009-0186
CVE-2009-1788
CVE-2009-1791

from debian

ok robert@@
@
text
@a0 20
$OpenBSD$

CVE-2009-1788

--- src/voc.c.orig	Thu Aug 31 05:22:07 2006
+++ src/voc.c	Sun Jun 28 17:42:35 2009
@@@@ -209,6 +209,13 @@@@ voc_read_header	(SF_PRIVATE *psf)
 
 						psf_log_printf (psf, " ASCII : %d\n", size) ;
 
+						if (size < sizeof (psf->header) - 1)
+						{	offset += psf_binheader_readf (psf, "b", psf->header, size) ;
+							psf->header [size] = 0 ;
+							psf_log_printf (psf, "  text : %s\n", psf->header) ;
+							continue ;
+							}
+
 						offset += psf_binheader_readf (psf, "b", psf->header, size) ;
 						psf->header [size] = 0 ;
 						psf_log_printf (psf, "  text : %s\n", psf->header) ;
@

