head	1.6;
access;
symbols
	OPENBSD_5_0:1.3.0.2
	OPENBSD_5_0_BASE:1.3;
locks; strict;
comment	@# @;


1.6
date	2012.01.20.13.04.16;	author dcoppa;	state dead;
branches;
next	1.5;

1.5
date	2012.01.16.13.27.09;	author dcoppa;	state Exp;
branches;
next	1.4;

1.4
date	2011.09.22.14.28.13;	author dcoppa;	state dead;
branches;
next	1.3;

1.3
date	2011.07.18.15.04.08;	author dcoppa;	state Exp;
branches;
next	1.2;

1.2
date	2011.07.10.11.01.05;	author dcoppa;	state dead;
branches;
next	1.1;

1.1
date	2011.05.13.09.52.51;	author dcoppa;	state Exp;
branches;
next	;


desc
@@


1.6
log
@Update to the latest snapshot from upstream git to unbreak pianobar
after pandora.com's API changes.
@
text
@$OpenBSD: patch-src_libpiano_xml_c,v 1.5 2012/01/16 13:27:09 dcoppa Exp $
--- src/libpiano/xml.c.orig	Mon Jan 16 14:03:29 2012
+++ src/libpiano/xml.c	Mon Jan 16 14:04:33 2012
@@@@ -94,6 +94,8 @@@@ static void PianoXmlIsFaultCb (const char *key, const 
 						*ret = PIANO_RET_QUICKMIX_NOT_PLAYABLE;
 					} else if (strcmp ("REMOVING_TOO_MANY_SEEDS", matchStart) == 0) {
 						*ret = PIANO_RET_REMOVING_TOO_MANY_SEEDS;
+					} else if (strcmp ("EXCESSIVE_ACTIVITY", matchStart) == 0) {
+						*ret = PIANO_RET_EXCESSIVE_ACTIVITY;
 					} else {
 						*ret = PIANO_RET_ERR;
 						printf (PACKAGE ": Unknown error %s in %s\n",
@


1.5
log
@Update to pianobar-2012.01.10
@
text
@d1 1
a1 1
$OpenBSD$
@


1.4
log
@Update to pianobar-2011.09.22
@
text
@d1 12
a12 37
$OpenBSD: patch-src_libpiano_xml_c,v 1.3 2011/07/18 15:04:08 dcoppa Exp $

Fix false bookmarking error message
(upstream commit c5a89908b05126fd59ea7d4fd42d9570a2ca6228)

--- src/libpiano/xml.c.orig	Sat Jul  9 10:40:54 2011
+++ src/libpiano/xml.c	Mon Jul 18 17:00:10 2011
@@@@ -560,26 +560,16 @@@@ PianoReturn_t PianoXmlParsePlaylist (PianoHandle_t *ph
 	return ret;
 }
 
-/*	parse simple answers like this: <?xml version="1.0" encoding="UTF-8"?>
- *	<methodResponse><params><param><value>1</value></param></params>
- *	</methodResponse>
+/*	check for exception only
  *	@@param xml string
- *	@@return
+ *	@@return _OK or error
  */
 PianoReturn_t PianoXmlParseSimple (char *xml) {
-	ezxml_t xmlDoc, dataNode;
+	ezxml_t xmlDoc;
 	PianoReturn_t ret;
 
 	if ((ret = PianoXmlInitDoc (xml, &xmlDoc)) != PIANO_RET_OK) {
 		return ret;
-	}
-
-	dataNode = ezxml_get (xmlDoc, "params", 0, "param", 0, "value", -1);
-
-	if (strcmp (ezxml_txt (dataNode), "1") == 0) {
-		ret = PIANO_RET_OK;
-	} else {
-		ret = PIANO_RET_ERR;
 	}
 
 	ezxml_free (xmlDoc);
@


1.3
log
@Fix false bookmarking error message
(upstream commit c5a89908b05126fd59ea7d4fd42d9570a2ca6228)
@
text
@d1 1
a1 1
$OpenBSD$
@


1.2
log
@Update to pianobar-2011.07.09.
Actually unbreak it, after pandora.com's api change.
@
text
@d1 1
a1 1
$OpenBSD: patch-src_libpiano_xml_c,v 1.1 2011/05/13 09:52:51 dcoppa Exp $
d3 2
a4 2
Fix useQuickMix attribute
(Commit 49f64fd33c202831407ba6b02fa74c2037052f1c)
d6 29
a34 8
--- src/libpiano/xml.c.orig	Fri May 13 11:44:10 2011
+++ src/libpiano/xml.c	Fri May 13 11:45:07 2011
@@@@ -373,8 +373,9 @@@@ static void PianoXmlParseQuickMixStationsCb (const cha
 			}
 		}
 		ids[idsN-1] = NULL;
+
+		*retIds = ids;
a35 2
-	*retIds = ids;
 }
d37 1
a37 1
 /*	parse stations returned by pandora
@


1.1
log
@Fix a bug: QuickMix stations losing state.
(upstream commit 49f64fd33c202831407ba6b02fa74c2037052f1c)
@
text
@d1 1
a1 1
$OpenBSD$
@

