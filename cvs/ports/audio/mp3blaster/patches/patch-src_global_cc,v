head	1.3;
access;
symbols;
locks; strict;
comment	@# @;


1.3
date	2017.08.15.18.39.48;	author jca;	state Exp;
branches;
next	1.2;
commitid	2vgbbXsgX9vtwXS0;

1.2
date	2017.06.18.14.56.03;	author bcallah;	state dead;
branches;
next	1.1;
commitid	MqTuFKVONdHI2XnM;

1.1
date	2017.04.26.14.58.38;	author naddy;	state Exp;
branches;
next	;
commitid	LXjj8kcmpHJktLmg;


desc
@@


1.3
log
@Fix (some?) runtime crashes.

Mainly problems due to a constructor not properly initialized.
Reported by Solenne Rapenne, input & ok tb@@, ok bcallah@@ (maintainer)
@
text
@$OpenBSD$

Index: src/global.cc
--- src/global.cc.orig
+++ src/global.cc
@@@@ -396,6 +396,9 @@@@ is_httpstream(const char *filename)
 int
 is_audiofile(const char *filename)
 {
+	if (filename == NULL)
+		return 0;
+
 	if (globalopts.extensions)
 	{
 		int i = 0;
@


1.2
log
@Update to 3.2.6 -- bug fixes collected over the last 8 years.
ok rsadowski@@
@
text
@d1 8
a8 5
$OpenBSD: patch-src_global_cc,v 1.1 2017/04/26 14:58:38 naddy Exp $
--- src/global.cc.orig	Sat Jan 24 16:25:10 2009
+++ src/global.cc	Wed Apr 26 16:50:52 2017
@@@@ -371,7 +371,7 @@@@ int
 is_sid(const char *filename)
d10 6
a15 6
 #ifdef HAVE_SIDPLAYER
-	char *ext = strrchr(filename, '.');
+	const char *ext = strrchr(filename, '.');
 	if (ext) {
 		if (!strcasecmp(ext, ".psid")) return 1;
 		if (!strcasecmp(ext, ".sid")) return 1;
@


1.1
log
@don't mix char* and const char*; fixes build with clang
@
text
@d1 1
a1 1
$OpenBSD$
@

