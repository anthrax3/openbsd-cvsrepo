head	1.2;
access;
symbols
	OPENBSD_6_2:1.2.0.2
	OPENBSD_6_2_BASE:1.2
	OPENBSD_6_1:1.1.0.30
	OPENBSD_6_1_BASE:1.1
	OPENBSD_6_0:1.1.0.28
	OPENBSD_6_0_BASE:1.1
	OPENBSD_5_9:1.1.0.24
	OPENBSD_5_9_BASE:1.1
	OPENBSD_5_8:1.1.0.26
	OPENBSD_5_8_BASE:1.1
	OPENBSD_5_7:1.1.0.22
	OPENBSD_5_7_BASE:1.1
	OPENBSD_5_6:1.1.0.20
	OPENBSD_5_6_BASE:1.1
	OPENBSD_5_5:1.1.0.18
	OPENBSD_5_5_BASE:1.1
	OPENBSD_5_4:1.1.0.16
	OPENBSD_5_4_BASE:1.1
	OPENBSD_5_3:1.1.0.14
	OPENBSD_5_3_BASE:1.1
	OPENBSD_5_2:1.1.0.12
	OPENBSD_5_2_BASE:1.1
	OPENBSD_5_1_BASE:1.1
	OPENBSD_5_1:1.1.0.10
	OPENBSD_5_0:1.1.0.8
	OPENBSD_5_0_BASE:1.1
	OPENBSD_4_9:1.1.0.6
	OPENBSD_4_9_BASE:1.1
	OPENBSD_4_8:1.1.0.4
	OPENBSD_4_8_BASE:1.1
	OPENBSD_4_7:1.1.0.2
	OPENBSD_4_7_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2017.08.15.18.39.48;	author jca;	state Exp;
branches;
next	1.1;
commitid	2vgbbXsgX9vtwXS0;

1.1
date	2010.01.11.07.51.26;	author jakemsr;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Fix (some?) runtime crashes.

Mainly problems due to a constructor not properly initialized.
Reported by Solenne Rapenne, input & ok tb@@, ok bcallah@@ (maintainer)
@
text
@$OpenBSD: patch-nmixer_nmixer_h,v 1.1 2010/01/11 07:51:26 jakemsr Exp $
Index: nmixer/nmixer.h
--- nmixer/nmixer.h.orig
+++ nmixer/nmixer.h
@@@@ -24,7 +24,15 @@@@
 #include <audio/audiolib.h>
 #endif
 
+#ifdef WANT_SNDIO
+#include <pthread.h>
+#endif
+
+#ifdef WANT_SNDIO
+#define MIXER_DEVICE "aucat:0"
+#else
 #define MIXER_DEVICE "/dev/mixer"
+#endif
 #define MYMIN(x, y) ((x) < (y) ? (x) : (y))
 #define MYVERSION "<<NMixer "VERSION">>"
 
@@@@ -119,6 +127,34 @@@@ class NASMixer : public baseMixer (private)
 	AuDeviceAttributes *ada;
 	int num_ada;
 };
+#endif
+
+#ifdef WANT_SNDIO
+
+struct sdata {
+	struct mio_hdl *hdl;
+	char dev[128];
+	int run_rt;
+	int cvol[16];
+};
+
+class SndioMixer : public baseMixer
+{
+public:
+	SndioMixer(const char *mixerDevice = NULL, baseMixer *next = 0);
+	~SndioMixer();
+	bool CanRecord(int device) { (void)device; return false; }
+	bool GetRecord(int device) { (void)device; return false; }
+	bool SetRecord(int device, bool set) { (void)device; (void)set; return false; }
+protected:
+	bool Set(int device, struct volume *vol);
+	bool Get(int device, struct volume *vol);
+	const char *Label(int device);
+private:
+	struct sdata s;
+	pthread_t rt;
+};
+
 #endif
 
 class NMixer
@


1.1
log
@- update to mp3blaster-3.2.5
- add sndio audio to mp3blaster and splay programs
- implement nmixer as a generic midi volume controller, that defaults to
using the aucat:0 midi device
- stop using multiple threads for mpeg decoding.  they are poorly
implmented, just spinning and using all available cpu cycles

with feedback from naddy@@ and ratchov@@
@
text
@d1 4
a4 3
$OpenBSD$
--- nmixer/nmixer.h.orig	Sat Jan 24 07:25:12 2009
+++ nmixer/nmixer.h	Tue Dec 29 03:32:48 2009
d31 1
a31 1
+	char *dev;
@

