head	1.2;
access;
symbols
	OPENBSD_6_0:1.2.0.28
	OPENBSD_6_0_BASE:1.2
	OPENBSD_5_9:1.2.0.24
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.2.0.26
	OPENBSD_5_8_BASE:1.2
	OPENBSD_5_7:1.2.0.22
	OPENBSD_5_7_BASE:1.2
	OPENBSD_5_6:1.2.0.20
	OPENBSD_5_6_BASE:1.2
	OPENBSD_5_5:1.2.0.18
	OPENBSD_5_5_BASE:1.2
	OPENBSD_5_4:1.2.0.16
	OPENBSD_5_4_BASE:1.2
	OPENBSD_5_3:1.2.0.14
	OPENBSD_5_3_BASE:1.2
	OPENBSD_5_2:1.2.0.12
	OPENBSD_5_2_BASE:1.2
	OPENBSD_5_1_BASE:1.2
	OPENBSD_5_1:1.2.0.10
	OPENBSD_5_0:1.2.0.8
	OPENBSD_5_0_BASE:1.2
	OPENBSD_4_9:1.2.0.6
	OPENBSD_4_9_BASE:1.2
	OPENBSD_4_8:1.2.0.4
	OPENBSD_4_8_BASE:1.2
	OPENBSD_4_7:1.2.0.2
	OPENBSD_4_7_BASE:1.2
	OPENBSD_4_6:1.1.0.20
	OPENBSD_4_6_BASE:1.1
	OPENBSD_4_5:1.1.0.18
	OPENBSD_4_5_BASE:1.1
	OPENBSD_4_4:1.1.0.16
	OPENBSD_4_4_BASE:1.1
	OPENBSD_4_3:1.1.0.14
	OPENBSD_4_3_BASE:1.1
	OPENBSD_4_2:1.1.0.12
	OPENBSD_4_2_BASE:1.1
	OPENBSD_4_1:1.1.0.10
	OPENBSD_4_1_BASE:1.1
	OPENBSD_4_0:1.1.0.8
	OPENBSD_4_0_BASE:1.1
	OPENBSD_3_9:1.1.0.6
	OPENBSD_3_9_BASE:1.1
	OPENBSD_3_8:1.1.0.4
	OPENBSD_3_8_BASE:1.1
	OPENBSD_3_7:1.1.0.2
	OPENBSD_3_7_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2009.12.14.00.33.08;	author jakemsr;	state Exp;
branches;
next	1.1;

1.1
date	2004.12.13.11.59.48;	author espie;	state Exp;
branches;
next	;


desc
@@


1.2
log
@- sndio instead of audio(4)
- cleanup & modernize:
remove bouncing maintainer contact, remove nop patch, regen patches,
@@bin markers
@
text
@$OpenBSD: patch-tools_find_sts_main_c,v 1.1 2004/12/13 11:59:48 espie Exp $
--- tools/find_sts_main.c.orig	Thu Dec 26 09:18:30 2002
+++ tools/find_sts_main.c	Wed Dec  9 19:23:23 2009
@@@@ -75,6 +75,11 @@@@ cst_sts *find_sts(cst_wave *sig, cst_track *lpc)
     double *resd;
     int size,start,end;
     short *sigplus;
+    struct dummy {
+    	unsigned short *frame;
+	int size;
+	unsigned char *residual;
+    } *stsw;
 
     sts = cst_alloc(cst_sts,lpc->num_frames);
     start = 0;
@@@@ -93,14 +98,16 @@@@ cst_sts *find_sts(cst_wave *sig, cst_track *lpc)
 			lpc->frames[i],lpc->num_channels,
 			resd,
 			size);
-	sts[i].size = size;
-	sts[i].frame = cst_alloc(unsigned short,lpc->num_channels-1);
+
+	stsw = (struct dummy *)(sts+i);
+	stsw->size = size;
+	stsw->frame = cst_alloc(unsigned short,lpc->num_channels-1);
 	for (j=1; j < lpc->num_channels; j++)
-	    sts[i].frame[j-1] = (unsigned short)
+	    stsw->frame[j-1] = (unsigned short)
 		(((lpc->frames[i][j]-lpc_min)/lpc_range)*65535);
-	sts[i].residual = cst_alloc(unsigned char,size);
+	stsw->residual = cst_alloc(unsigned char,size);
 	for (j=0; j < size; j++)
-	    sts[i].residual[j] = cst_short_to_ulaw((short)resd[j]);
+	    stsw->residual[j] = cst_short_to_ulaw((short)resd[j]);
 	start = end;
     }
 
@


1.1
log
@code there is badly broken, it tries to modify const fields, and gcc < 3.3.5
didn't enforce that correctly.
@
text
@d1 4
a4 4
$OpenBSD$
--- tools/find_sts_main.c.orig	Mon Dec 13 12:55:55 2004
+++ tools/find_sts_main.c	Mon Dec 13 12:58:01 2004
@@@@ -75,6 +75,11 @@@@ cst_sts *find_sts(cst_wave *sig, cst_tra
d16 1
a16 1
@@@@ -93,14 +98,16 @@@@ cst_sts *find_sts(cst_wave *sig, cst_tra
@

