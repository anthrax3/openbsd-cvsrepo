head	1.1;
access;
symbols
	OPENBSD_6_0:1.1.0.14
	OPENBSD_6_0_BASE:1.1
	OPENBSD_5_9:1.1.0.10
	OPENBSD_5_9_BASE:1.1
	OPENBSD_5_8:1.1.0.12
	OPENBSD_5_8_BASE:1.1
	OPENBSD_5_7:1.1.0.8
	OPENBSD_5_7_BASE:1.1
	OPENBSD_5_6:1.1.0.6
	OPENBSD_5_6_BASE:1.1
	OPENBSD_5_5:1.1.0.4
	OPENBSD_5_5_BASE:1.1
	OPENBSD_5_4:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2014.01.30.13.21.43;	author jasper;	state Exp;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2014.01.30.13.23.42;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.1
log
@Security fix for CVE-2014-0027
@
text
@$OpenBSD$

Security fix for CVE-2014-0027,
https://bugzilla.redhat.com/show_bug.cgi?id=1048678

--- src/audio/auserver.c.orig	Tue Dec  4 19:14:14 2001
+++ src/audio/auserver.c	Thu Jan 30 14:18:33 2014
@@@@ -59,9 +59,11 @@@@ static int play_wave_from_socket(snd_header *header,in
     int q,i,n,r;
     unsigned char bytes[CST_AUDIOBUFFSIZE];
     short shorts[CST_AUDIOBUFFSIZE];
+#ifdef DEBUG
     cst_file fff;
 
     fff = cst_fopen("/tmp/awb.wav",CST_OPEN_WRITE|CST_OPEN_BINARY);
+#endif
 
     if ((audio_device = audio_open(header->sample_rate,1,
 				   (header->encoding == CST_SND_SHORT) ?
@@@@ -108,7 +110,9 @@@@ static int play_wave_from_socket(snd_header *header,in
 	for (q=r; q > 0; q-=n)
 	{
 	    n = audio_write(audio_device,shorts,q);
+#ifdef DEBUG
 	    cst_fwrite(fff,shorts,2,q);
+#endif
 	    if (n <= 0)
 	    {
 		audio_close(audio_device);
@@@@ -117,7 +121,9 @@@@ static int play_wave_from_socket(snd_header *header,in
 	}
     }
     audio_close(audio_device);
+#ifdef DEBUG
     cst_fclose(fff);
+#endif
 
     return CST_OK_FORMAT;
 
@


1.1.2.1
log
@Security fix for CVE-2014-0027
@
text
@d1 1
a1 1
$OpenBSD: patch-src_audio_auserver_c,v 1.1 2014/01/30 13:21:43 jasper Exp $
@

