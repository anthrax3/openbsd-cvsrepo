head	1.19;
access;
symbols
	OPENBSD_6_1:1.19.0.4
	OPENBSD_6_1_BASE:1.19
	OPENBSD_6_0:1.19.0.2
	OPENBSD_6_0_BASE:1.19
	OPENBSD_5_9:1.18.0.2
	OPENBSD_5_9_BASE:1.18
	OPENBSD_5_8:1.18.0.4
	OPENBSD_5_8_BASE:1.18
	OPENBSD_5_7:1.16.0.2
	OPENBSD_5_7_BASE:1.16
	OPENBSD_5_6:1.15.0.6
	OPENBSD_5_6_BASE:1.15
	OPENBSD_5_5:1.15.0.4
	OPENBSD_5_5_BASE:1.15
	OPENBSD_5_4:1.15.0.2
	OPENBSD_5_4_BASE:1.15
	OPENBSD_5_3:1.12.0.6
	OPENBSD_5_3_BASE:1.12
	OPENBSD_5_2:1.12.0.4
	OPENBSD_5_2_BASE:1.12
	OPENBSD_5_1_BASE:1.12
	OPENBSD_5_1:1.12.0.2
	OPENBSD_5_0:1.11.0.2
	OPENBSD_5_0_BASE:1.11
	OPENBSD_4_9:1.9.0.2
	OPENBSD_4_9_BASE:1.9
	OPENBSD_4_8:1.5.0.4
	OPENBSD_4_8_BASE:1.5
	OPENBSD_4_7:1.5.0.2
	OPENBSD_4_7_BASE:1.5
	OPENBSD_4_6:1.4.0.4
	OPENBSD_4_6_BASE:1.4
	OPENBSD_4_5:1.4.0.2
	OPENBSD_4_5_BASE:1.4
	sthen_20081017:1.1.1.1
	sthen:1.1.1;
locks; strict;
comment	@# @;


1.19
date	2016.04.05.12.21.40;	author sthen;	state Exp;
branches;
next	1.18;
commitid	aRJxV2bHdrUEKr07;

1.18
date	2015.05.25.07.54.28;	author jasper;	state Exp;
branches;
next	1.17;
commitid	jsaRAQWqOGFN8HTC;

1.17
date	2015.05.08.09.08.44;	author espie;	state Exp;
branches;
next	1.16;
commitid	8WaxsMNN6opOzn9t;

1.16
date	2014.09.13.18.09.20;	author brad;	state Exp;
branches;
next	1.15;
commitid	PpbRjVZdAmlrmi8q;

1.15
date	2013.06.12.20.36.33;	author brad;	state Exp;
branches;
next	1.14;

1.14
date	2013.05.25.00.33.09;	author brad;	state Exp;
branches;
next	1.13;

1.13
date	2013.03.10.22.55.05;	author espie;	state Exp;
branches;
next	1.12;

1.12
date	2011.11.08.23.14.49;	author sthen;	state Exp;
branches;
next	1.11;

1.11
date	2011.05.11.06.22.16;	author ajacoutot;	state Exp;
branches;
next	1.10;

1.10
date	2011.03.02.08.35.14;	author sthen;	state Exp;
branches;
next	1.9;

1.9
date	2010.11.26.07.07.56;	author espie;	state Exp;
branches;
next	1.8;

1.8
date	2010.11.15.00.22.48;	author espie;	state Exp;
branches;
next	1.7;

1.7
date	2010.09.21.10.28.11;	author sthen;	state Exp;
branches;
next	1.6;

1.6
date	2010.09.21.10.12.07;	author sthen;	state Exp;
branches;
next	1.5;

1.5
date	2009.07.12.19.58.28;	author sthen;	state Exp;
branches;
next	1.4;

1.4
date	2009.01.28.01.36.00;	author sthen;	state Exp;
branches;
next	1.3;

1.3
date	2008.12.13.10.37.28;	author sthen;	state Exp;
branches;
next	1.2;

1.2
date	2008.11.17.12.31.27;	author sthen;	state Exp;
branches;
next	1.1;

1.1
date	2008.10.17.09.59.26;	author sthen;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2008.10.17.09.59.26;	author sthen;	state Exp;
branches;
next	;


desc
@@


1.19
log
@sprinkle some deps on www/p5-CGI
@
text
@# $OpenBSD: Makefile,v 1.18 2015/05/25 07:54:28 jasper Exp $

COMMENT =	streaming audio server for Squeezebox network music players

V =		7.3.3
PKGNAME =	squeezecenter-${V}
DISTNAME =	squeezecenter-${V}-noCPAN
REVISION =	7
CATEGORIES =	audio net

HOMEPAGE =	http://wiki.slimdevices.com/index.php/SqueezeCenter

# Main software is GPLv2, supplied with some CPAN modules packaged,
# but unfortunately also with proprietary (required) firmware, also
# image files/fonts etc which may not be redistributed without an
# explicit permission being granted.
PERMIT_PACKAGE_CDROM =	No
PERMIT_PACKAGE_FTP =	No
PERMIT_DISTFILES_FTP =	No

EXTRACT_SUFX =	.tgz

MASTER_SITES =	http://downloads.slimdevices.com/SqueezeCenter_v${V}/

WRKDIST =	${WRKDIR}/${DISTNAME:S/.no-cpan-arch//}

# take care, squeezecenter often depends on internals of perl
# modules rather than documented APIs; as a result things often
# break if dependencies get updated.
#
RUN_DEPENDS =	audio/flac \
		audio/lame \
		audio/wavpack \
		databases/mariadb,-server \
		devel/p5-Cache-Cache>=1.04 \
		devel/p5-Carp-Clan>=5.3 \
		devel/p5-Class-Accessor>=0.31 \
		devel/p5-Class-C3>=0.11 \
		devel/p5-Class-Data-Accessor>=0.03 \
		devel/p5-Class-Data-Inheritable>=0.04 \
		devel/p5-Class-Inspector>=1.16 \
		www/p5-CGI \
		databases/p5-DBD-mysql>=3.0002 \
		databases/p5-DBI>=1.604 \
		databases/p5-DBIx-Class>=0.07001 \
		databases/p5-DBIx-Migration>=0.05 \
		devel/p5-Data-Dump>=1.06 \
		www/p5-Data-URIEncode>=0.11 \
		security/p5-Digest-SHA1>=2.11 \
		textproc/p5-Encode-Detect>=1.01 \
		devel/p5-Exporter-Lite>=0.02 \
		devel/p5-File-BOM>=0.13 \
		devel/p5-File-Next>=1.02 \
		devel/p5-File-ReadBackwards>=1.04 \
		devel/p5-File-Slurp>=9999.12 \
		sysutils/p5-File-Which>=0.05 \
		graphics/p5-GD>=2.35 \
		www/p5-HTML-Parser>=3.48 \
		devel/p5-I18N-LangTags>=0.35 \
		devel/p5-IO-String>=1.07 \
		converters/p5-JSON-XS>=1.5 \
		converters/p5-JSON-XS-VersionOneAndTwo>=0.31 \
		www/p5-libwww>=5.805 \
		devel/p5-Log-Log4perl>=1.07 \
		math/p5-Math-VecStat>=0.08 \
		net/p5-Net-DNS>=0.58 \
		net/p5-Net-IP>=1.24 \
		net/p5-Net-UPnP>=1.2.1 \
		devel/p5-PAR>=0.970 \
		devel/p5-Path-Class>=0.13 \
		devel/p5-POE>=0.9989 \
		devel/p5-POE-XS-Queue-Array>=0.002 \
		devel/p5-Proc-Background>=1.08 \
		databases/p5-SQL-Abstract>=1.20 \
		textproc/p5-Template>=2.15 \
		textproc/p5-Text-Unidecode>=0.04 \
		devel/p5-Tie-Cache-LRU>=0.21 \
		devel/p5-Tie-Cache-LRU-Expires>=0.54 \
		devel/p5-Tie-IxHash>=1.21 \
		devel/p5-Tie-LLHash>=1.003 \
		devel/p5-Tie-RegexpHash>=0.13 \
		devel/p5-Time-TimeDate>=1.16 \
		www/p5-URI>=1.35 \
		www/p5-URI-Find>=0.16 \
		textproc/p5-XML-Parser>=2.34 \
		textproc/p5-XML-Simple>=2.15 \
		devel/p5-YAML-Syck>=0.64 \
		textproc/p5-XML-XSPF
 
# remove squeezecenter's redistributed CPAN modules, we use our own.
# remove MySQL error message file, it's for a specific version.
pre-configure:
	rm ${WRKSRC}/MySQL/errmsg.sys
	@@ln -s ${TRUEPREFIX}/share/mysql/english/errmsg.sys \
	    ${WRKSRC}/MySQL/errmsg.sys  
	rm -r ${WRKSRC}/CPAN
	@@${SUBST_CMD} -m 0644 -c ${FILESDIR}/Custom.pm \
	    ${WRKSRC}/Slim/Utils/OS/Custom.pm

NO_BUILD =	yes
NO_TEST =	yes
PMDIR =		libdata/perl5/site_perl/Slim
SSLIBDIR =	libdata/squeezecenter
SSSHAREDIR =	share/squeezecenter

do-install:
	${INSTALL_PROGRAM} ${WRKSRC}/slimserver.pl ${PREFIX}/bin/slimserver.pl
	${INSTALL_PROGRAM} ${WRKSRC}/scanner.pl ${PREFIX}/bin/scanner.pl
	${INSTALL_DATA_DIR} ${PREFIX}/{${PMDIR},${SSLIBDIR},${SSSHAREDIR}}
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/squeezecenter
.for i in types convert modules
	${INSTALL_DATA} ${WRKSRC}/$i.conf ${PREFIX}/share/examples/squeezecenter
.endfor
	cd ${WRKSRC}/Slim/; tar cf - * | tar xf - -C ${PREFIX}/${PMDIR}/
	cd ${WRKSRC}/lib/; tar cf - * | tar xf - -C ${PREFIX}/${SSLIBDIR}/
	cd ${WRKSRC}/; tar cf - Firmware Graphics HTML IR MySQL Plugins \
	    SQL strings.txt | tar xf - -C ${PREFIX}/${SSSHAREDIR}/
	touch ${PREFIX}/share/examples/squeezecenter/empty
	find ${PREFIX} -name '*.orig' -print0 | xargs -0 rm

.include <bsd.port.mk>
@


1.18
log
@remove a whole bunch more @@rm -f cases
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2015/05/08 09:08:44 espie Exp $
a4 3
# note, newer versions want p5-EV which in turn wants threaded perl
# or running with LD_PRELOAD=/usr/lib/libpthread.so to avoid problems
# with the userland thread library.
d8 1
a8 1
REVISION =	6
d42 1
@


1.17
log
@don't depend on modes in the ports tree being what we want installed
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2014/09/13 18:09:20 brad Exp $
d95 1
a95 1
	@@rm ${WRKSRC}/MySQL/errmsg.sys
d98 1
a98 1
	@@rm -rf ${WRKSRC}/CPAN
@


1.16
log
@Switch from using MySQL to using MariaDB attempt #2. MariaDB is a drop-in replacement.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2013/06/12 20:36:33 brad Exp $
d99 1
a99 1
	@@${SUBST_CMD} -c ${FILESDIR}/Custom.pm \
@


1.15
log
@Revert back to using MySQL 5.1 for the time being. MariaDB 5.5 introduces
a new libmysqlclient non-blocking API which utilizes co-routines. The X86
specific GCC ASM co-routine support hid the fact that there was an issue.
The only fallback code so far is POSIX user contexts which OpenBSD does not
support.

Input from and Ok sthen@@ jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2013/05/25 00:33:09 brad Exp $
d11 1
a11 1
REVISION =	5
d37 1
a37 1
		databases/mysql,-server \
@


1.14
log
@Switch from using MySQL to using MariaDB. MariaDB is a drop-in replacement.


ok sthen aja
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2013/03/10 22:55:05 espie Exp $
d11 1
a11 1
REVISION =	4
d37 1
a37 1
		databases/mariadb,-server \
@


1.13
log
@PERMIT/REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2011/11/08 23:14:49 sthen Exp $
d11 1
a11 1
REVISION =	3
d37 1
a37 1
		databases/mysql,-server \
@


1.12
log
@drop myself as maintainer
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2011/05/11 06:22:16 ajacoutot Exp $
a21 1
PERMIT_DISTFILES_CDROM =No
d103 1
a103 1
NO_REGRESS =	yes
@


1.11
log
@Sanitize some @@unexec/@@extraunexec calls to rm: move them up in the
PLIST and remove remove everything under the @@sample'd directory instead
of the directory itself to prevent a warning from pkg_delete(1) trying
to remove a non existing directory and to help preventing left-over
files and directories.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2011/03/02 08:35:14 sthen Exp $
d6 2
d11 1
a11 1
REVISION =	2
a13 2
MAINTAINER =	Stuart Henderson <sthen@@openbsd.org>

d31 4
@


1.10
log
@Avoid using use Class::XSAccessor::Array private API to unbreak this port,
taken from newer version. jim@@ ok
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2010/11/26 07:07:56 espie Exp $
d9 1
a9 1
REVISION =	1
@


1.9
log
@redo depends with >=
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2010/11/15 00:22:48 espie Exp $
d9 1
a9 1
REVISION =	0
@


1.8
log
@convert to new style depends
zap default spec that are not needed
convert libspecs as well
convert p* to REVISION.

No package changes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2010/09/21 10:28:11 sthen Exp $
d35 52
a86 52
		STEM->=1.04:devel/p5-Cache-Cache \
		STEM->=5.3:devel/p5-Carp-Clan \
		STEM->=0.31:devel/p5-Class-Accessor \
		STEM->=0.11:devel/p5-Class-C3 \
		STEM->=0.03:devel/p5-Class-Data-Accessor \
		STEM->=0.04:devel/p5-Class-Data-Inheritable \
		STEM->=1.16:devel/p5-Class-Inspector \
		STEM->=3.0002:databases/p5-DBD-mysql \
		STEM->=1.604:databases/p5-DBI \
		STEM->=0.07001:databases/p5-DBIx-Class \
		STEM->=0.05:databases/p5-DBIx-Migration \
		STEM->=1.06:devel/p5-Data-Dump \
		STEM->=0.11:www/p5-Data-URIEncode \
		STEM->=2.11:security/p5-Digest-SHA1 \
		STEM->=1.01:textproc/p5-Encode-Detect \
		STEM->=0.02:devel/p5-Exporter-Lite \
		STEM->=0.13:devel/p5-File-BOM \
		STEM->=1.02:devel/p5-File-Next \
		STEM->=1.04:devel/p5-File-ReadBackwards \
		STEM->=9999.12:devel/p5-File-Slurp \
		STEM->=0.05:sysutils/p5-File-Which \
		STEM->=2.35:graphics/p5-GD \
		STEM->=3.48:www/p5-HTML-Parser \
		STEM->=0.35:devel/p5-I18N-LangTags \
		STEM->=1.07:devel/p5-IO-String \
		STEM->=1.5:converters/p5-JSON-XS \
		STEM->=0.31:converters/p5-JSON-XS-VersionOneAndTwo \
		STEM->=5.805:www/p5-libwww \
		STEM->=1.07:devel/p5-Log-Log4perl \
		STEM->=0.08:math/p5-Math-VecStat \
		STEM->=0.58:net/p5-Net-DNS \
		STEM->=1.24:net/p5-Net-IP \
		STEM->=1.2.1:net/p5-Net-UPnP \
		STEM->=0.970:devel/p5-PAR \
		STEM->=0.13:devel/p5-Path-Class \
		STEM->=0.9989:devel/p5-POE \
		STEM->=0.002:devel/p5-POE-XS-Queue-Array \
		STEM->=1.08:devel/p5-Proc-Background \
		STEM->=1.20:databases/p5-SQL-Abstract \
		STEM->=2.15:textproc/p5-Template \
		STEM->=0.04:textproc/p5-Text-Unidecode \
		STEM->=0.21:devel/p5-Tie-Cache-LRU \
		STEM->=0.54:devel/p5-Tie-Cache-LRU-Expires \
		STEM->=1.21:devel/p5-Tie-IxHash \
		STEM->=1.003:devel/p5-Tie-LLHash \
		STEM->=0.13:devel/p5-Tie-RegexpHash \
		STEM->=1.16:devel/p5-Time-TimeDate \
		STEM->=1.35:www/p5-URI \
		STEM->=0.16:www/p5-URI-Find \
		STEM->=2.34:textproc/p5-XML-Parser \
		STEM->=2.15:textproc/p5-XML-Simple \
		STEM->=0.64:devel/p5-YAML-Syck \
@


1.7
log
@change homepage, pointed out aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2010/09/21 10:12:07 sthen Exp $
d31 57
a87 57
RUN_DEPENDS =	::audio/flac \
		::audio/lame \
		::audio/wavpack \
		:mysql-server-*:databases/mysql,-server \
		:p5-Cache-Cache->=1.04:devel/p5-Cache-Cache \
		:p5-Carp-Clan->=5.3:devel/p5-Carp-Clan \
		:p5-Class-Accessor->=0.31:devel/p5-Class-Accessor \
		:p5-Class-C3->=0.11:devel/p5-Class-C3 \
		:p5-Class-Data-Accessor->=0.03:devel/p5-Class-Data-Accessor \
		:p5-Class-Data-Inheritable->=0.04:devel/p5-Class-Data-Inheritable \
		:p5-Class-Inspector->=1.16:devel/p5-Class-Inspector \
		:p5-DBD-mysql->=3.0002:databases/p5-DBD-mysql \
		:p5-DBI->=1.604:databases/p5-DBI \
		:p5-DBIx-Class->=0.07001:databases/p5-DBIx-Class \
		:p5-DBIx-Migration->=0.05:databases/p5-DBIx-Migration \
		:p5-Data-Dump->=1.06:devel/p5-Data-Dump \
		:p5-Data-URIEncode->=0.11:www/p5-Data-URIEncode \
		:p5-Digest-SHA1->=2.11:security/p5-Digest-SHA1 \
		:p5-Encode-Detect->=1.01:textproc/p5-Encode-Detect \
		:p5-Exporter-Lite->=0.02:devel/p5-Exporter-Lite \
		:p5-File-BOM->=0.13:devel/p5-File-BOM \
		:p5-File-Next->=1.02:devel/p5-File-Next \
		:p5-File-ReadBackwards->=1.04:devel/p5-File-ReadBackwards \
		:p5-File-Slurp->=9999.12:devel/p5-File-Slurp \
		:p5-File-Which->=0.05:sysutils/p5-File-Which \
		:p5-GD->=2.35:graphics/p5-GD \
		:p5-HTML-Parser->=3.48:www/p5-HTML-Parser \
		:p5-I18N-LangTags->=0.35:devel/p5-I18N-LangTags \
		:p5-IO-String->=1.07:devel/p5-IO-String \
		:p5-JSON-XS->=1.5:converters/p5-JSON-XS \
		:p5-JSON-XS-VersionOneAndTwo->=0.31:converters/p5-JSON-XS-VersionOneAndTwo \
		:p5-libwww->=5.805:www/p5-libwww \
		:p5-Log-Log4perl->=1.07:devel/p5-Log-Log4perl \
		:p5-Math-VecStat->=0.08:math/p5-Math-VecStat \
		:p5-Net-DNS->=0.58:net/p5-Net-DNS \
		:p5-Net-IP->=1.24:net/p5-Net-IP \
		:p5-Net-UPnP->=1.2.1:net/p5-Net-UPnP \
		:p5-PAR->=0.970:devel/p5-PAR \
		:p5-Path-Class->=0.13:devel/p5-Path-Class \
		:p5-POE->=0.9989:devel/p5-POE \
		:p5-POE-XS-Queue-Array->=0.002:devel/p5-POE-XS-Queue-Array \
		:p5-Proc-Background->=1.08:devel/p5-Proc-Background \
		:p5-SQL-Abstract->=1.20:databases/p5-SQL-Abstract \
		:p5-Template->=2.15:textproc/p5-Template \
		:p5-Text-Unidecode->=0.04:textproc/p5-Text-Unidecode \
		:p5-Tie-Cache-LRU->=0.21:devel/p5-Tie-Cache-LRU \
		:p5-Tie-Cache-LRU-Expires->=0.54:devel/p5-Tie-Cache-LRU-Expires \
		:p5-Tie-IxHash->=1.21:devel/p5-Tie-IxHash \
		:p5-Tie-LLHash->=1.003:devel/p5-Tie-LLHash \
		:p5-Tie-RegexpHash->=0.13:devel/p5-Tie-RegexpHash \
		:p5-Time-TimeDate->=1.16:devel/p5-Time-TimeDate \
		:p5-URI->=1.35:www/p5-URI \
		:p5-URI-Find->=0.16:www/p5-URI-Find \
		:p5-XML-Parser->=2.34:textproc/p5-XML-Parser \
		:p5-XML-Simple->=2.15:textproc/p5-XML-Simple \
		:p5-YAML-Syck->=0.64:devel/p5-YAML-Syck \
		:p5-XML-XSPF-*:textproc/p5-XML-XSPF
@


1.6
log
@add a note about why this isn't updated, people keep asking
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2009/07/12 19:58:28 sthen Exp $
d9 1
d14 1
a14 1
HOMEPAGE =	http://www.slimdevices.com/pi_features.html
@


1.5
log
@maintenance update to 7.3.3
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2009/01/28 01:36:00 sthen Exp $
d5 1
@


1.4
log
@update to 7.3.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2008/12/13 10:37:28 sthen Exp $
d5 1
a5 1
V =		7.3.2
d116 1
@


1.3
log
@add NO_REGRESS=Yes, no package bump needed.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2008/11/17 12:31:27 sthen Exp $
d5 1
a5 1
V =		7.2.1
d12 1
a12 1
HOMEPAGE =	http://www.slimdevices.com/
d31 1
d94 2
a95 1
	@@${SUBST_CMD} ${WRKSRC}/Slim/Utils/OSDetect.pm
@


1.2
log
@- update to 7.2.1
- fix userid conflict with heartbeat (sorry)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2008/10/17 09:59:26 sthen Exp $
d96 1
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d5 1
a5 1
V =		7.2.0
d7 1
a7 1
DISTNAME =	squeezecenter-7.2-noCPAN
@


1.1.1.1
log
@import squeezecenter:

Formerly known as SlimServer, this is a streaming audio server
for use with the SlimDevices/Logitech network music players -
Squeezebox, Transporter and SLiMP3.

* Web browser UI to control the player and manage playlists
* MP3 & WMA Internet radio
* Alarm clock
* Automatically imports metadata tags
* Browse and search by title, artist, album or genre
* Shuffle and repeat albums or songs
* Create, save, and import .pls, .cue and .m3u playlist files
* Displays current date and time when not playing
* Open protocol and command line API
* Expandable through 3rd party plug-ins and skins
* Supports multiple synchronized players
* Listen from any computer using an MP3 software player
@
text
@@
