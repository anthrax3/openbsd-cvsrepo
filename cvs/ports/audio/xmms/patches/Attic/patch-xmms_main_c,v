head	1.11;
access;
symbols
	OPENBSD_6_0:1.10.0.28
	OPENBSD_6_0_BASE:1.10
	OPENBSD_5_9:1.10.0.24
	OPENBSD_5_9_BASE:1.10
	OPENBSD_5_8:1.10.0.26
	OPENBSD_5_8_BASE:1.10
	OPENBSD_5_7:1.10.0.22
	OPENBSD_5_7_BASE:1.10
	OPENBSD_5_6:1.10.0.20
	OPENBSD_5_6_BASE:1.10
	OPENBSD_5_5:1.10.0.18
	OPENBSD_5_5_BASE:1.10
	OPENBSD_5_4:1.10.0.16
	OPENBSD_5_4_BASE:1.10
	OPENBSD_5_3:1.10.0.14
	OPENBSD_5_3_BASE:1.10
	OPENBSD_5_2:1.10.0.12
	OPENBSD_5_2_BASE:1.10
	OPENBSD_5_1_BASE:1.10
	OPENBSD_5_1:1.10.0.10
	OPENBSD_5_0:1.10.0.8
	OPENBSD_5_0_BASE:1.10
	OPENBSD_4_9:1.10.0.6
	OPENBSD_4_9_BASE:1.10
	OPENBSD_4_8:1.10.0.4
	OPENBSD_4_8_BASE:1.10
	OPENBSD_4_7:1.10.0.2
	OPENBSD_4_7_BASE:1.10
	OPENBSD_4_6:1.9.0.4
	OPENBSD_4_6_BASE:1.9
	OPENBSD_4_5:1.9.0.2
	OPENBSD_4_5_BASE:1.9
	OPENBSD_4_4:1.8.0.4
	OPENBSD_4_4_BASE:1.8
	OPENBSD_4_3:1.8.0.2
	OPENBSD_4_3_BASE:1.8
	OPENBSD_4_2:1.6.0.14
	OPENBSD_4_2_BASE:1.6
	OPENBSD_4_1:1.6.0.12
	OPENBSD_4_1_BASE:1.6
	OPENBSD_4_0:1.6.0.10
	OPENBSD_4_0_BASE:1.6
	OPENBSD_3_9:1.6.0.8
	OPENBSD_3_9_BASE:1.6
	OPENBSD_3_8:1.6.0.6
	OPENBSD_3_8_BASE:1.6
	OPENBSD_3_7:1.6.0.4
	OPENBSD_3_7_BASE:1.6
	OPENBSD_3_6:1.6.0.2
	OPENBSD_3_6_BASE:1.6
	OPENBSD_3_5:1.5.0.2
	OPENBSD_3_5_BASE:1.5
	OPENBSD_3_4:1.4.0.8
	OPENBSD_3_4_BASE:1.4
	OPENBSD_3_3:1.4.0.6
	OPENBSD_3_3_BASE:1.4
	OPENBSD_3_2:1.4.0.4
	OPENBSD_3_2_BASE:1.4
	OPENBSD_3_1:1.4.0.2
	OPENBSD_3_1_BASE:1.4
	OPENBSD_3_0:1.2.0.2
	OPENBSD_3_0_BASE:1.2
	OPENBSD_2_9_TRACKING_SWITCH:1.2
	vedge:1.1.1.1
	xmms:1.1.1;
locks; strict;
comment	@# @;


1.11
date	2016.08.30.10.36.56;	author jasper;	state dead;
branches;
next	1.10;
commitid	D07bT1mi91GB9K8U;

1.10
date	2009.12.27.00.32.56;	author phessler;	state Exp;
branches;
next	1.9;

1.9
date	2008.12.26.06.34.45;	author jakemsr;	state Exp;
branches;
next	1.8;

1.8
date	2007.12.08.21.54.57;	author ajacoutot;	state Exp;
branches;
next	1.7;

1.7
date	2007.12.04.09.39.16;	author robert;	state Exp;
branches;
next	1.6;

1.6
date	2004.04.15.19.23.46;	author naddy;	state Exp;
branches;
next	1.5;

1.5
date	2004.01.22.20.15.22;	author naddy;	state Exp;
branches;
next	1.4;

1.4
date	2002.03.11.17.38.05;	author naddy;	state Exp;
branches;
next	1.3;

1.3
date	2002.02.05.04.07.57;	author pvalchev;	state Exp;
branches;
next	1.2;

1.2
date	2001.07.25.15.48.26;	author naddy;	state Exp;
branches;
next	1.1;

1.1
date	2001.07.20.14.26.16;	author espie;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2001.07.20.14.26.16;	author espie;	state Exp;
branches;
next	;


desc
@@


1.11
log
@remove xmms, it's been unmaintained for years and it's in the way of
the removal of gtk+1, the toolkit from eons ago.

discussed with many for years, no objections from naddy@@
ok aja@@ dcoppa@@
@
text
@$OpenBSD: patch-xmms_main_c,v 1.10 2009/12/27 00:32:56 phessler Exp $
--- xmms/main.c.orig	Sun Jul 16 07:40:04 2006
+++ xmms/main.c	Sat Dec 26 17:30:28 2009
@@@@ -501,7 +501,9 @@@@ static void read_config(void)
 		cfg.gentitle_format = g_strdup("%p - %t");
 	if (cfg.outputplugin == NULL)
 	{
-#ifdef HAVE_OSS
+#if defined(HAVE_SNDIO)
+		cfg.outputplugin = g_strdup_printf("%s/%s/libsndioout.so", PLUGIN_DIR, plugin_dir_list[0]);
+#elif defined(HAVE_OSS)
 		cfg.outputplugin = g_strdup_printf("%s/%s/libOSS.so", PLUGIN_DIR, plugin_dir_list[0]);
 #elif defined(sun)
 		cfg.outputplugin = g_strdup_printf("%s/%s/libSolaris.so", PLUGIN_DIR, plugin_dir_list[0]);
@@@@ -1652,16 +1654,25 @@@@ static void mainwin_jump_to_file_edit_real(GtkWidget *
 	char *words[20];
 	int nw = 0, i;
 	char* ptr;
-	
+
+	gint row_to_select;
+	gint prev_focus;
+	gint *tmp;
+	char song[256];
+	int match;
+	char *title, *filename;
+	int row, queue_pos, *data_buf;
+	char *tmp_buf;
+
 	PL_LOCK();
 	playlist = get_playlist();
 	key = g_strdup(gtk_entry_get_text(GTK_ENTRY(widget)));
 	clist = GTK_CLIST(userdata);
 
 	/* Figure out what is currently selected */
-	gint row_to_select = -1;
-	gint prev_focus = -1;
-	gint *tmp = gtk_clist_get_row_data(clist, clist->focus_row);
+	row_to_select = -1;
+	prev_focus = -1;
+	tmp = gtk_clist_get_row_data(clist, clist->focus_row);
 	if (tmp != NULL)
 		prev_focus = *tmp;
 
@@@@ -1690,10 +1701,10 @@@@ static void mainwin_jump_to_file_edit_real(GtkWidget *
 	
 	gtk_clist_clear(clist);
 
+
 	while (playlist)
 	{
-		int match = 0;
-		char *title, *filename;
+		match = 0;
 
 		title = ((PlaylistEntry *) playlist->data)->title;
 		filename = ((PlaylistEntry *) playlist->data)->filename;
@@@@ -1733,7 +1744,6 @@@@ static void mainwin_jump_to_file_edit_real(GtkWidget *
 			match = 0;
 		else
 		{
-			char song[256];
 
 			/* Cook up a lowercased string that contains
 			 * the filename and the (possible) title
@@@@ -1752,8 +1762,6 @@@@ static void mainwin_jump_to_file_edit_real(GtkWidget *
 
 		if (match)
 		{
-			int row, queue_pos, *data_buf;
-			char *tmp_buf;
 			queue_pos = playlist_get_queue_position((PlaylistEntry *) playlist->data);
 			if (queue_pos != -1) {
 				tmp_buf = g_strdup_printf("%i", queue_pos+1);
@@@@ -4192,11 +4200,12 @@@@ int main(int argc, char **argv)
 
 	signal(SIGPIPE, SIG_IGN); /* for controlsocket.c */
 	signal(SIGSEGV, segfault_handler);
+#if !defined(OpenBSD)
 	g_thread_init(NULL);
 	gtk_set_locale();
 	if (!g_thread_supported())
 		g_error(_("GLib does not support threads."));
-
+#endif
 	parse_cmd_line(argc, argv, &options);
 
 #ifdef HAVE_SRANDOMDEV
@


1.10
log
@some more gcc 2.95 fixes
@
text
@d1 1
a1 1
$OpenBSD: patch-xmms_main_c,v 1.9 2008/12/26 06:34:45 jakemsr Exp $
@


1.9
log
@- add sndio backend, courtesy of Thomas Pfaff, thanks!
- get rid of PSEUDO_FLAVORS
- gain a bit of contrl over auto*

ok naddy@@
@
text
@d1 3
a3 3
$OpenBSD: patch-xmms_main_c,v 1.8 2007/12/08 21:54:57 ajacoutot Exp $
--- xmms/main.c.orig	Sun Jul 16 06:40:04 2006
+++ xmms/main.c	Tue Dec 23 23:47:01 2008
d15 61
a75 1
@@@@ -4192,11 +4194,12 @@@@ int main(int argc, char **argv)
@


1.8
log
@- update to xmms-1.2.11

input from naddy@@, help and ok jakemsr@@
@
text
@d1 1
a1 1
$OpenBSD: patch-xmms_main_c,v 1.7 2007/12/04 09:39:16 robert Exp $
d3 13
a15 2
+++ xmms/main.c	Sat Dec  8 12:42:03 2007
@@@@ -4192,11 +4192,12 @@@@ int main(int argc, char **argv)
@


1.7
log
@do not try to quit the main window twice after recieving a SIGTERM or
SIGINT, because that's going to cause a double free resulting in a
segmentation fault
@
text
@d1 4
a4 4
$OpenBSD: patch-xmms_main_c,v 1.6 2004/04/15 19:23:46 naddy Exp $
--- xmms/main.c.orig	Mon Feb 23 21:31:43 2004
+++ xmms/main.c	Tue Dec  4 10:16:45 2007
@@@@ -3522,11 +3522,12 @@@@ int main(int argc, char **argv)
d17 1
a17 1
 #if defined(HAVE_SRANDOMDEV)
@


1.6
log
@Update to 1.2.10; from new maintainer Robert Nagy <thuglife@@bsd.hu>.
@
text
@d1 4
a4 24
$OpenBSD$
--- xmms/main.c.orig	2004-02-23 21:31:43.000000000 +0100
+++ xmms/main.c	2004-04-14 23:33:55.000000000 +0200
@@@@ -3390,6 +3390,18 @@@@ void segfault_handler(int sig)
 	exit(1);
 }
 
+void sigterm_handler(int sig)
+{
+	/* Original author of patch said that you should not use mainwin_quit_cb(),
+	 * but his way deadlock xmms, and it anyhow just calls ctrlsocket stuff with
+	 * with CMD_QUIT, which anyhow calls mainwin_quit_cb() in turn.  This is not
+	 * entirely clean, but works.
+	 * <azarah@@gentoo.org> (19 Jan 2003)
+	 */
+	xmms_remote_quit(ctrlsocket_get_session_id());
+	mainwin_quit_cb();
+}
+	
 static gboolean pposition_configure(GtkWidget *w, GdkEventConfigure *event, gpointer data)
 {
 	gint x,y;
@@@@ -3521,12 +3533,15 @@@@ int main(int argc, char **argv)
 #endif
a6 2
+	signal(SIGTERM, sigterm_handler);
+	signal(SIGINT, sigterm_handler);
@


1.5
log
@sync patches
@
text
@d1 23
a23 4
$OpenBSD: patch-xmms_main_c,v 1.4 2002/03/11 17:38:05 naddy Exp $
--- xmms/main.c.orig	2002-02-27 15:30:28.000000000 +0100
+++ xmms/main.c	2004-01-22 20:41:37.000000000 +0100
@@@@ -3387,7 +3387,8 @@@@ int main(int argc, char **argv)
d27 3
a29 2
-	signal(SIGSEGV, segfault_handler);
+
d32 1
d34 2
a35 5
 	{
@@@@ -3396,6 +3397,7 @@@@ int main(int argc, char **argv)
 			 "installed LinuxThreads you need to recompile GLIB & GTK+\n"));
 		exit(1);
 	}
@


1.4
log
@Update to 1.2.7; submitted by maintainer Wilbern Cobb <vedge@@csoft.org>.

* Use the system libtool.
* Remove the disk writer flavor, include it by default.
* Add a gnome subpackage.

Notable changes in this release:

General:
* Replaced folder icons.
* Don't display playlist numbers elsewhere when turned off.
* Support 32-bit and 16-bit "bitfield" bmps in skins.
CD Audio:
* Supply a dummy user and hostname to the cddb server.
MPG123:
* Handle UTF-16 encoded tags.
* Major stability fixes.
@
text
@d1 4
a4 4
$OpenBSD: patch-xmms_main_c,v 1.3 2002/02/05 04:07:57 pvalchev Exp $
--- xmms/main.c.orig	Fri Dec 28 08:32:28 2001
+++ xmms/main.c	Fri Jan 18 07:39:27 2002
@@@@ -3379,7 +3373,8 @@@@
d14 1
a14 1
@@@@ -3388,6 +3383,7 @@@@
@


1.3
log
@Update to xmms-1.2.6.  From maintainer vedge@@csoft.org

Added mikmod & diskwriter subpackages.
@
text
@d1 1
a1 1
$OpenBSD$
a3 23
@@@@ -3235,20 +3235,14 @@@@
 		xmms_remote_stop(opt->session);
 	if (opt->fwd)
 		xmms_remote_playlist_next(opt->session);
+#if 0
 	if (opt->play_pause)
 		xmms_remote_play_pause(opt->session);
+#endif
 	if (opt->mainwin)
 		xmms_remote_main_win_toggle(opt->session, TRUE);
 }
 
-void segfault_handler(int sig)
-{
-	printf(_("\nSegmentation fault\n\n"
-		 "You've probably found a bug in XMMS, please visit\n"
-		 "http://bugs.xmms.org and fill out a bug report.\n\n"));
-	exit(1);
-}
-
 static gboolean pposition_configure(GtkWidget *w, GdkEventConfigure *event, gpointer data)
 {
 	gint x,y;
@


1.2
log
@Cleanups:
- regen patches, add RCS keywords
- remove redundant dependencies
- remove unused libtool dependency
- add major version number to library dependencies
- don't build included gettext
- miscellaneous
@
text
@d2 12
a13 4
--- xmms/main.c.orig	Sun Jun 17 01:05:47 2001
+++ xmms/main.c	Wed Jul 25 16:47:43 2001
@@@@ -3204,14 +3204,6 @@@@ gboolean handle_cmd_line_options(struct 
 	return FALSE;
d19 2
a20 2
-	       "You've probably found a bug in XMMS, please visit\n"
-	       "http://www.xmms.org/bugs and fill out a bug report.\n\n"));
d27 1
a27 2
@@@@ -3340,15 +3332,6 @@@@ int main(int argc, char **argv)
 	textdomain(PACKAGE);
d30 1
d32 10
a41 8
-	g_thread_init(NULL);
-	if (!g_thread_supported())
-	{
-		printf(_("Sorry, threads isn't supported on your platform.\n\n"
-			 "If you're on a libc5 based linux system and installed GLIB & GTK+ before you\n"
-			 "installed LinuxThreads you need to recompile GLIB & GTK+\n"));
-		exit(1);
-	}
@


1.1
log
@Initial revision
@
text
@d1 4
a4 3
--- xmms/main.c.orig	Thu Jul  5 21:58:03 2001
+++ xmms/main.c	Thu Jul  5 21:58:31 2001
@@@@ -3204,14 +3204,6 @@@@
d19 1
a19 1
@@@@ -3340,15 +3332,6 @@@@
@


1.1.1.1
log
@Initial import of xmms, based on vedge port plus a few changes.
- deactivate tests.
- no maintainer listed for now until I find out who Mr. `Vedge' actually
is...
@
text
@@
