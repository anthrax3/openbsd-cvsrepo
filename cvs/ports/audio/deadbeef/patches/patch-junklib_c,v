head	1.5;
access;
symbols
	OPENBSD_6_1:1.4.0.2
	OPENBSD_6_1_BASE:1.4
	OPENBSD_6_0:1.3.0.8
	OPENBSD_6_0_BASE:1.3
	OPENBSD_5_9:1.3.0.4
	OPENBSD_5_9_BASE:1.3
	OPENBSD_5_8:1.3.0.6
	OPENBSD_5_8_BASE:1.3
	OPENBSD_5_7:1.3.0.2
	OPENBSD_5_7_BASE:1.3
	OPENBSD_5_6:1.2.0.8
	OPENBSD_5_6_BASE:1.2
	OPENBSD_5_5:1.2.0.6
	OPENBSD_5_5_BASE:1.2
	OPENBSD_5_4:1.2.0.4
	OPENBSD_5_4_BASE:1.2
	OPENBSD_5_3:1.2.0.2
	OPENBSD_5_3_BASE:1.2
	shadchin_20120908:1.1.1.1
	shadchin:1.1.1;
locks; strict;
comment	@# @;


1.5
date	2017.09.08.10.44.20;	author dcoppa;	state Exp;
branches;
next	1.4;
commitid	qvI402vcHHAGhkSO;

1.4
date	2016.09.13.08.48.11;	author dcoppa;	state Exp;
branches;
next	1.3;
commitid	BT8XpOWAlRecYDdn;

1.3
date	2014.09.23.13.44.03;	author dcoppa;	state Exp;
branches;
next	1.2;
commitid	zFndqvTxqvS2gudg;

1.2
date	2013.01.03.11.54.49;	author shadchin;	state Exp;
branches;
next	1.1;

1.1
date	2012.08.08.18.06.48;	author shadchin;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2012.08.08.18.06.48;	author shadchin;	state Exp;
branches;
next	;


desc
@@


1.5
log
@
Merge fixes from the '0.7' stable branch:

junklib: fix pointer going out of scope bug
(upstream git commit d97d5490e45462b8b4135a3745e56b003ef494cf)

ffmpeg: increase the supported file extension limit to 1024
(upstream git commit 67f6568151248965dd89ef3304464a50e9982a20)

ffmpeg: buffer overflow fix when there are >= 256 extensions supported
by ffmpeg
(upstream git commit f6646210f643e4fb75f352cfb021dcfc0ed0b628)
@
text
@$OpenBSD: patch-junklib_c,v 1.4 2016/09/13 08:48:11 dcoppa Exp $

commit d97d5490e45462b8b4135a3745e56b003ef494cf
Author: Alexey Yakovenko <wakeroid@@gmail.com>
Date:   Mon Jul 17 19:24:31 2017

junklib: fix pointer going out of scope bug

Index: junklib.c
--- junklib.c.orig
+++ junklib.c
@@@@ -33,7 +33,6 @@@@
 #include <string.h>
 #undef HAVE_ICI
 #if HAVE_ICONV
-  #define LIBICONV_PLUG
   #include <iconv.h>
 #elif HAVE_ICU
   #warning icu
@@@@ -586,7 +585,7 @@@@ junk_iconv (const char *in, int inlen, char *out, int 
     if (cd == (iconv_t)-1) {
         return -1;
     }
-#ifdef __linux__
+#if defined(__linux__) || defined (__OpenBSD__)
     char *pin = (char*)in;
 #else
     const char *pin = in;
@@@@ -1025,11 +1024,12 @@@@ junk_id3v1_read_int (playItem_t *it, char *buffer, con
         return -1;
     }
 
+    const char *cs = NULL;
+
     if (it) {
         if (memcmp (buffer, "TAG", 3)) {
             return -1; // no tag
         }
-        const char *cs = NULL;
         charset = &cs;
         int res = junk_id3v1_read_int (NULL, buffer, charset);
         if (res) {
@


1.4
log
@
Update to deadbeef-0.7.2

Most of the work done by Timo Myyra, thanks!
Some tweaks by me.
@
text
@d1 11
a11 3
$OpenBSD: patch-junklib_c,v 1.3 2014/09/23 13:44:03 dcoppa Exp $
--- junklib.c.orig	Sun Sep  4 08:55:24 2016
+++ junklib.c	Sun Sep  4 08:56:11 2016
d29 14
@


1.3
log
@
Update to deadbeef-0.6.2
@
text
@d1 4
a4 5
$OpenBSD: patch-junklib_c,v 1.2 2013/01/03 11:54:49 shadchin Exp $
--- junklib.c.orig	Thu Jul 31 21:03:51 2014
+++ junklib.c	Tue Sep 23 14:54:07 2014
@@@@ -32,7 +32,6 @@@@
 #include <stdlib.h>
d6 1
d12 1
a12 1
@@@@ -475,7 +474,7 @@@@ junk_iconv (const char *in, int inlen, char *out, int 
d17 1
a17 1
+#if defined (__linux__) || defined (__OpenBSD__)
@


1.2
log
@Update to 0.5.6.

tested mikeb@@, tweaks and ok brad@@, ok dcoppa@@
@
text
@d1 3
a3 3
$OpenBSD: patch-junklib_c,v 1.1.1.1 2012/08/08 18:06:48 shadchin Exp $
--- junklib.c.orig	Fri Oct 19 21:58:50 2012
+++ junklib.c	Tue Oct 23 22:32:14 2012
d12 9
@


1.1
log
@Initial revision
@
text
@d1 4
a4 4
$OpenBSD$
--- junklib.c.orig	Sat May 14 16:45:26 2011
+++ junklib.c	Mon May 16 19:22:06 2011
@@@@ -23,7 +23,6 @@@@
@


1.1.1.1
log
@Import deadbeef 0.5.5.

DeaDBeeF (as in 0xDEADBEEF) is an audio player for GNU/Linux, BSD,
OpenSolaris and probably other UNIX-like systems.

ok dcoppa@@
@
text
@@
