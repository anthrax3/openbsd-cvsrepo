head	1.3;
access;
symbols
	OPENBSD_5_9:1.2.0.22
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.2.0.24
	OPENBSD_5_8_BASE:1.2
	OPENBSD_5_7:1.2.0.20
	OPENBSD_5_7_BASE:1.2
	OPENBSD_5_6:1.2.0.18
	OPENBSD_5_6_BASE:1.2
	OPENBSD_5_5:1.2.0.16
	OPENBSD_5_5_BASE:1.2
	OPENBSD_5_4:1.2.0.14
	OPENBSD_5_4_BASE:1.2
	OPENBSD_5_3:1.2.0.12
	OPENBSD_5_3_BASE:1.2
	OPENBSD_5_2:1.2.0.10
	OPENBSD_5_2_BASE:1.2
	OPENBSD_5_1_BASE:1.2
	OPENBSD_5_1:1.2.0.8
	OPENBSD_5_0:1.2.0.6
	OPENBSD_5_0_BASE:1.2
	OPENBSD_4_9:1.2.0.4
	OPENBSD_4_9_BASE:1.2
	OPENBSD_4_8:1.2.0.2
	OPENBSD_4_8_BASE:1.2
	OPENBSD_4_7:1.1.0.28
	OPENBSD_4_7_BASE:1.1
	OPENBSD_4_6:1.1.0.26
	OPENBSD_4_6_BASE:1.1
	OPENBSD_4_5:1.1.0.24
	OPENBSD_4_5_BASE:1.1
	OPENBSD_4_4:1.1.0.22
	OPENBSD_4_4_BASE:1.1
	OPENBSD_4_3:1.1.0.20
	OPENBSD_4_3_BASE:1.1
	OPENBSD_4_2:1.1.0.18
	OPENBSD_4_2_BASE:1.1
	OPENBSD_4_1:1.1.0.16
	OPENBSD_4_1_BASE:1.1
	OPENBSD_4_0:1.1.0.14
	OPENBSD_4_0_BASE:1.1
	OPENBSD_3_9:1.1.0.12
	OPENBSD_3_9_BASE:1.1
	OPENBSD_3_8:1.1.0.10
	OPENBSD_3_8_BASE:1.1
	OPENBSD_3_7:1.1.0.8
	OPENBSD_3_7_BASE:1.1
	OPENBSD_3_6:1.1.0.6
	OPENBSD_3_6_BASE:1.1
	OPENBSD_3_5:1.1.0.4
	OPENBSD_3_5_BASE:1.1
	OPENBSD_3_4:1.1.0.2
	OPENBSD_3_4_BASE:1.1;
locks; strict;
comment	@# @;


1.3
date	2016.03.20.18.27.59;	author mmcc;	state dead;
branches;
next	1.2;
commitid	2GriRubp1bFkG71k;

1.2
date	2010.05.19.16.18.28;	author espie;	state Exp;
branches;
next	1.1;

1.1
date	2003.04.14.09.46.06;	author avsm;	state Exp;
branches;
next	;


desc
@@


1.3
log
@Remove audio/mpegaudio. The code is untouched since 1994, it barely
works, and the code is apparently of very low quality.

ok jacoutot@@, sthen@@, jca@@, testing from jca@@
@
text
@$OpenBSD: patch-musicin_c,v 1.2 2010/05/19 16:18:28 espie Exp $
--- musicin.c.orig	Wed Jan  5 02:13:44 1994
+++ musicin.c	Wed May 19 18:16:41 2010
@@@@ -101,12 +101,15 @@@@ musicin.c
 #include "common.h"
 #include "encoder.h"
 
+#include <stdlib.h>
+
 /* Global variable definitions for "musicin.c" */
 
 FILE               *musicin;
 Bit_stream_struc   bs;
 char               *programName;
 
+static void usage();
 /* Implementations */
 
 /************************************************************************
@@@@ -144,7 +147,7 @@@@ char            encoded_file_name[MAX_NAME_SIZE];
  
     do  {
        printf("Enter PCM input file name <required>: ");
-       gets(original_file_name);
+       fgets(original_file_name, MAX_NAME_SIZE-1, stdin);
        if (original_file_name[0] == NULL_CHAR)
        printf("PCM input file name is required.\n");
     } while (original_file_name[0] == NULL_CHAR);
@@@@ -163,7 +166,7 @@@@ char            encoded_file_name[MAX_NAME_SIZE];
            original_file_name, DFLT_EXT);
 #endif
  
-    gets(encoded_file_name);
+    fgets(encoded_file_name, MAX_NAME_SIZE-1, stdin);
     if (encoded_file_name[0] == NULL_CHAR) {
 #ifdef  MS_DOS
         /* replace old extension with new one, 92-08-19 shn */
@@@@ -207,7 +210,7 @@@@ char            encoded_file_name[MAX_NAME_SIZE];
     else {    /* Not using Audio IFF sound file headers. */
 
        printf("What is the sampling frequency? <44100>[Hz]: ");
-       gets(t);
+       fgets(t, 49, stdin);
        freq = atol(t);
        switch (freq) {
           case 48000 : info->sampling_frequency = 1;
@@@@ -236,7 +239,7 @@@@ char            encoded_file_name[MAX_NAME_SIZE];
 
     printf("Which layer do you want to use?\n");
     printf("Available: Layer (1), Layer (<2>): ");
-    gets(t);
+    fgets(t, 49, stdin);
     switch(*t){
        case '1': info->lay = 1; printf(">>> Using Layer %s\n",t); break;
        case '2': info->lay = 2; printf(">>> Using Layer %s\n",t); break;
@@@@ -246,7 +249,7 @@@@ char            encoded_file_name[MAX_NAME_SIZE];
     printf("Which mode do you want?\n");
     printf("Available: (<s>)tereo, (j)oint stereo, ");
     printf("(d)ual channel, s(i)ngle Channel: ");
-    gets(t);
+    fgets(t, 49, stdin);
     switch(*t){
        case 's':
        case 'S':
@@@@ -275,7 +278,7 @@@@ char            encoded_file_name[MAX_NAME_SIZE];
     }
 
     printf("Which psychoacoustic model do you want to use? <2>: ");
-    gets(t);
+    fgets(t, 49, stdin);
     model = atoi(t);
     if (model > 2 || model < 1) {
        printf(">>> Default model 2 selected\n");
@@@@ -287,7 +290,7 @@@@ char            encoded_file_name[MAX_NAME_SIZE];
     }
  
     printf("What is the total bitrate? <%u>[kbps]: ", DFLT_BRT);
-    gets(t);
+    fgets(t, 49, stdin);
     brt = atoi(t);
     if (brt == 0) brt = -10;
     j=0;
@@@@ -310,7 +313,7 @@@@ char            encoded_file_name[MAX_NAME_SIZE];
  
     printf("What type of de-emphasis should the decoder use?\n");
     printf("Available: (<n>)one, (5)0/15 microseconds, (c)citt j.17: ");
-    gets(t);
+    fgets(t, 49, stdin);
     if (*t != 'n' && *t != '5' && *t != 'c') {
        printf(">>> Using default no de-emphasis\n");
        info->emphasis = 0;
@@@@ -325,7 +328,7 @@@@ char            encoded_file_name[MAX_NAME_SIZE];
 /*  Start 2. Part changes for CD Ver 3.2; jsp; 22-Aug-1991 */
  
     printf("Do you want to set the private bit? (y/<n>): ");
-    gets(t);
+    fgets(t, 49, stdin);
     if (*t == 'y' || *t == 'Y') info->extension = 1;
     else                        info->extension = 0;
     if(info->extension) printf(">>> Private bit set\n");
@@@@ -334,28 +337,28 @@@@ char            encoded_file_name[MAX_NAME_SIZE];
 /*  End changes for CD Ver 3.2; jsp; 22-Aug-1991 */
  
     printf("Do you want error protection? (y/<n>): ");
-    gets(t);
+    fgets(t, 49, stdin);
     if (*t == 'y' || *t == 'Y') info->error_protection = TRUE;
     else                        info->error_protection = FALSE;
     if(info->error_protection) printf(">>> Error protection used\n");
     else printf(">>> Error protection not used\n");
  
     printf("Is the material copyrighted? (y/<n>): ");
-    gets(t);
+    fgets(t, 49, stdin);
     if (*t == 'y' || *t == 'Y') info->copyright = 1;
     else                        info->copyright = 0;
     if(info->copyright) printf(">>> Copyrighted material\n");
     else                printf(">>> Material not copyrighted\n");
  
     printf("Is this the original? (y/<n>): ");
-    gets(t);
+    fgets(t, 49, stdin);
     if (*t == 'y' || *t == 'Y') info->original = 1;
     else                        info->original = 0;
     if(info->original) printf(">>> Original material\n");
     else               printf(">>> Material not original\n");
  
     printf("Do you wish to exit (last chance before encoding)? (y/<n>): ");
-    gets(t);
+    fgets(t, 49, stdin);
     if (*t == 'y' || *t == 'Y') exit(0);
 }
 
@


1.2
log
@gcc4 fixes
@
text
@d1 1
a1 1
$OpenBSD: patch-musicin_c,v 1.1 2003/04/14 09:46:06 avsm Exp $
@


1.1
log
@- fix another static buffer overflow in fgets
- use update-patches
@
text
@d1 4
a4 4
$OpenBSD$
--- musicin.c.orig	Wed Jan  5 01:13:44 1994
+++ musicin.c	Mon Apr 14 10:41:07 2003
@@@@ -101,6 +101,8 @@@@ musicin.c
d13 8
a20 1
@@@@ -144,7 +146,7 @@@@ char            encoded_file_name[MAX_NA
d29 1
a29 1
@@@@ -163,7 +165,7 @@@@ char            encoded_file_name[MAX_NA
d38 1
a38 1
@@@@ -207,7 +209,7 @@@@ char            encoded_file_name[MAX_NA
d47 1
a47 1
@@@@ -236,7 +238,7 @@@@ char            encoded_file_name[MAX_NA
d56 1
a56 1
@@@@ -246,7 +248,7 @@@@ char            encoded_file_name[MAX_NA
d65 1
a65 1
@@@@ -275,7 +277,7 @@@@ char            encoded_file_name[MAX_NA
d74 1
a74 1
@@@@ -287,7 +289,7 @@@@ char            encoded_file_name[MAX_NA
d83 1
a83 1
@@@@ -310,7 +312,7 @@@@ char            encoded_file_name[MAX_NA
d92 1
a92 1
@@@@ -325,7 +327,7 @@@@ char            encoded_file_name[MAX_NA
d101 1
a101 1
@@@@ -334,28 +336,28 @@@@ char            encoded_file_name[MAX_NA
@

