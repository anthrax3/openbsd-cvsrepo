head	1.2;
access;
symbols
	OPENBSD_5_6:1.1.0.6
	OPENBSD_5_6_BASE:1.1
	OPENBSD_5_5:1.1.0.4
	OPENBSD_5_5_BASE:1.1
	OPENBSD_5_4:1.1.0.2
	OPENBSD_5_4_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2015.01.10.15.50.58;	author naddy;	state dead;
branches;
next	1.1;
commitid	fcbq5beq7jpL0DD1;

1.1
date	2013.07.18.15.10.55;	author naddy;	state Exp;
branches;
next	;


desc
@@


1.2
log
@maintenance update to flac 1.3.1, no significant user-visible changes
@
text
@$OpenBSD: patch-src_libFLAC_stream_encoder_c,v 1.1 2013/07/18 15:10:55 naddy Exp $

Fix an arithmetic overflow in the RICE2 partitioner.
https://git.xiph.org/?p=flac.git;a=commit;h=6f7ec60c7e7f05f5ab0b1cf6b7b0945e44afcd4b

--- src/libFLAC/stream_encoder.c.orig	Sun May 26 11:30:33 2013
+++ src/libFLAC/stream_encoder.c	Thu Jul 18 16:39:48 2013
@@@@ -3784,7 +3784,7 @@@@ void precompute_partition_info_sums_(
 		/* slightly pessimistic but still catches all common cases */
 		/* WATCHOUT: "+ bps" is an assumption that the average residual magnitude will not be more than "bps" bits */
 		if(FLAC__bitmath_ilog2(default_partition_samples) + bps < 32) {
-			FLAC__uint32 abs_residual_partition_sum;
+			FLAC__uint64 abs_residual_partition_sum;
 
 			for(partition = residual_sample = 0; partition < partitions; partition++) {
 				end += default_partition_samples;
@


1.1
log
@Fix an arithmetic overflow in the RICE2 partitioner; from upstream git.
@
text
@d1 1
a1 1
$OpenBSD$
@

