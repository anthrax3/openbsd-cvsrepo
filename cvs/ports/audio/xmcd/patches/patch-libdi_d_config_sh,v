head	1.3;
access;
symbols
	OPENBSD_6_0:1.3.0.32
	OPENBSD_6_0_BASE:1.3
	OPENBSD_5_9:1.3.0.28
	OPENBSD_5_9_BASE:1.3
	OPENBSD_5_8:1.3.0.30
	OPENBSD_5_8_BASE:1.3
	OPENBSD_5_7:1.3.0.26
	OPENBSD_5_7_BASE:1.3
	OPENBSD_5_6:1.3.0.24
	OPENBSD_5_6_BASE:1.3
	OPENBSD_5_5:1.3.0.22
	OPENBSD_5_5_BASE:1.3
	OPENBSD_5_4:1.3.0.20
	OPENBSD_5_4_BASE:1.3
	OPENBSD_5_3:1.3.0.18
	OPENBSD_5_3_BASE:1.3
	OPENBSD_5_2:1.3.0.16
	OPENBSD_5_2_BASE:1.3
	OPENBSD_5_1_BASE:1.3
	OPENBSD_5_1:1.3.0.14
	OPENBSD_5_0:1.3.0.12
	OPENBSD_5_0_BASE:1.3
	OPENBSD_4_9:1.3.0.10
	OPENBSD_4_9_BASE:1.3
	OPENBSD_4_8:1.3.0.8
	OPENBSD_4_8_BASE:1.3
	OPENBSD_4_7:1.3.0.6
	OPENBSD_4_7_BASE:1.3
	OPENBSD_4_6:1.3.0.4
	OPENBSD_4_6_BASE:1.3
	OPENBSD_4_5:1.3.0.2
	OPENBSD_4_5_BASE:1.3
	OPENBSD_4_4:1.2.0.32
	OPENBSD_4_4_BASE:1.2
	OPENBSD_4_3:1.2.0.30
	OPENBSD_4_3_BASE:1.2
	OPENBSD_4_2:1.2.0.28
	OPENBSD_4_2_BASE:1.2
	OPENBSD_4_1:1.2.0.26
	OPENBSD_4_1_BASE:1.2
	OPENBSD_4_0:1.2.0.24
	OPENBSD_4_0_BASE:1.2
	OPENBSD_3_9:1.2.0.22
	OPENBSD_3_9_BASE:1.2
	OPENBSD_3_8:1.2.0.20
	OPENBSD_3_8_BASE:1.2
	OPENBSD_3_7:1.2.0.18
	OPENBSD_3_7_BASE:1.2
	OPENBSD_3_6:1.2.0.16
	OPENBSD_3_6_BASE:1.2
	OPENBSD_3_5:1.2.0.14
	OPENBSD_3_5_BASE:1.2
	OPENBSD_3_4:1.2.0.12
	OPENBSD_3_4_BASE:1.2
	OPENBSD_3_3:1.2.0.10
	OPENBSD_3_3_BASE:1.2
	OPENBSD_3_2:1.2.0.8
	OPENBSD_3_2_BASE:1.2
	OPENBSD_3_1:1.2.0.6
	OPENBSD_3_1_BASE:1.2
	OPENBSD_3_0:1.2.0.4
	OPENBSD_3_0_BASE:1.2
	OPENBSD_2_9_TRACKING_SWITCH:1.2
	OPENBSD_2_9:1.2.0.2
	OPENBSD_2_9_BASE:1.2;
locks; strict;
comment	@# @;


1.3
date	2008.10.28.12.09.05;	author jasper;	state Exp;
branches;
next	1.2;

1.2
date	2001.01.18.16.41.27;	author naddy;	state Exp;
branches;
next	1.1;

1.1
date	2000.12.03.20.50.50;	author espie;	state Exp;
branches;
next	;


desc
@@


1.3
log
@- homepage moved
- provide a working master site
- tweak DESCR and MESSAGE
- regen patches and plist while here
@
text
@$OpenBSD: patch-libdi_d_config_sh,v 1.2 2001/01/18 16:41:27 naddy Exp $
--- libdi_d/config.sh.orig	Sat Feb  5 08:26:23 2000
+++ libdi_d/config.sh	Tue Oct 28 13:06:18 2008
@@@@ -37,13 +37,14 @@@@ XMCDLIB=/usr/lib/X11/xmcd
 CDDBDIR=/usr/lib/X11/xmcd/cddb
 DISCOGDIR=/usr/lib/X11/xmcd/discog
 
-ERRFILE=/tmp/xmcd.err
-TMPFILE=/tmp/.xmcdcfg.$$
-TMPSITES=/tmp/.sites.$$
+ERRFILE=`mktemp /tmp/xmcd.XXXXXXXXXX`
+TMPFILE=`mktemp /tmp/xmcd.XXXXXXXXXX`
+TMPSITES=`mktemp /tmp/xmcd.XXXXXXXXXX`
 
-CFGDIR=$XMCDLIB/config
+CFGDIR=@@SYSCONFDIR@@/xmcd
 SCRDIR=$XMCDLIB/scripts
 SITES=$CFGDIR/sites
+TBLDIR=$XMCDLIB/tbl
 OWNER=bin
 GROUP=bin
 CDIRPERM=777
@@@@ -491,41 +492,9 @@@@ ask_nonscsi_config()
 		return 1
 	fi
 
-	#
-	# Select the ioctl method
-	#
-	$ECHO "\n  Please select a Device Interface Method:\n"
-	$ECHO "  1.\tSunOS/Solaris/Linux/QNX ioctl method"
-	$ECHO "  2.\tFreeBSD/NetBSD/OpenBSD ioctl method"
-	$ECHO "  3.\tIBM AIX IDE ioctl method"
-	$ECHO "  4.\tBSDI BSD/OS ATAPI"
-	$ECHO "  5.\tSCO Open Server ATAPI BTLD"
-	$ECHO "  6.\tCompaq Tru64 UNIX / Digital UNIX ATAPI"
-	$ECHO "  7.\tHP-UX ATAPI"
-	$ECHO "  q.\tquit (abort configuration)"
+	# *BSD
+	IOCMETHOD=2
 
-	while :
-	do
-		if get_str "\n  Enter choice:"
-		then
-			case "$ANS" in
-			[1-7])
-				break
-				;;
-			q)
-				return 1
-				;;
-			*)
-				$ECHO "  Please answer 1 to 7."
-				;;
-			esac
-		else
-			$ECHO "  Please answer 1 to 7."
-		fi
-	done
-
-	IOCMETHOD="$ANS"
-
 	if [ -z "$NUMDISCS" ]
 	then
 		YNDEF=n
@@@@ -765,18 +734,18 @@@@ config_drive()
 	eval `\
 	(
 		$ECHO "ENTRIES=\""
-		cd $CFGDIR/.tbl
+		cd $TBLDIR
 		for i in *
 		do
 			if [ -f $i ]
 			then
-				if fgrep tblver=4 $CFGDIR/.tbl/$i \
+				if fgrep tblver=4 $TBLDIR/$i \
 			   		>/dev/null 2>&1
 				then
 					$ECHO "$i \c"
 				else
 					log_err -p \
-					"$CFGDIR/.tbl/$i version mismatch"
+					"$TBLDIR/$i version mismatch"
 				fi
 			fi
 		done
@@@@ -789,7 +758,7 @@@@ config_drive()
 	then
 		for i in $ENTRIES
 		do
-			brand=`fgrep tblalias= $CFGDIR/.tbl/$i 2>/dev/null | \
+			brand=`fgrep tblalias= $TBLDIR/$i 2>/dev/null | \
 				sed 's/^.*tblalias=//'`
 			if [ -z "$brand" ]
 			then
@@@@ -842,7 +811,7 @@@@ config_drive()
 				do
 					if [ $k = $ANS ]
 					then
-						model_sel $i $CFGDIR/.tbl/$i
+						model_sel $i $TBLDIR/$i
 						return $?
 					fi
 					k=`expr $k + 1`
@@@@ -1542,16 +1511,10 @@@@ browser_config()
 	WORD=A
 	for j in $BROWSERS
 	do
-		for i in	/usr/bin/X11 \
-				/usr/X/bin \
-				/usr/X11/bin \
+		for i in	$BINDIR \
 				/usr/X11R6/bin \
-				/usr/X11R5/bin \
-				/usr/X386/bin \
-				/usr/openwin/bin \
-				/usr/local/bin/X11 \
 				/usr/local/bin \
-				/usr/lbin
+				/usr/bin
 		do
 		    if [ -x $i/$j ]
 		    then
@@@@ -1840,9 +1803,9 @@@@ then
 	do_exit 2
 fi
 
-if [ ! -d $CFGDIR/.tbl ]
+if [ ! -d $TBLDIR ]
 then
-	log_err -p "The directory $CFGDIR/.tbl is missing"
+	log_err -p "The directory $TBLDIR is missing"
 	do_exit 2
 fi
 
@@@@ -1953,14 +1916,7 @@@@ elif [ "$OS_SYS" = OpenBSD ]
 then
 	# OpenBSD
 	DEVPREF=/dev/rcd
-	case "$OS_MACH" in
-	*86)
-		DEVSUFF=d
-		;;
-	*)
-		DEVSUFF=c
-		;;
-	esac
+	DEVSUFF=c
 	FIRST=0
 	MAILCMD="Mail -s '%S' %A <%F >/dev/null 2>&1"
 elif [ "$OS_SYS" = OSF1 ]
@@@@ -2207,33 +2163,6 @@@@ do
 	if [ $DRVNO -eq 0 ]
 	then
 		#
-		# Configure app-defaults/XMcd file
-		#
-		chmod 644 $XMCDLIB/app-defaults/XMcd 2>/dev/null
-		if [ -w $XMCDLIB/app-defaults/XMcd ]
-		then
-			$AWK '
-			/^XMcd\.libdir:/ {
-				printf("XMcd.libdir:\t\t\t%s\n", xmcdlib)
-				next
-			}
-			/^XMcd\.cddbMailCmd:/ {
-				printf("XMcd.cddbMailCmd:\t\t%s\n", mailcmd)
-				next
-			}
-			{
-				print $0
-			}' xmcdlib="$XMCDLIB" mailcmd="$MAILCMD" \
-				$XMCDLIB/app-defaults/XMcd > /tmp/xmcd.$$
-
-			cp /tmp/xmcd.$$ $XMCDLIB/app-defaults/XMcd
-			rm -f /tmp/xmcd.$$
-		else
-			log_err -p "Cannot configure $XMCDLIB/app-defaults/XMcd"
-			EXITSTAT=1
-		fi
-
-		#
 		# Configure common.cfg file
 		#
 		chmod 644 $CFGDIR/common.cfg 2>/dev/null
@@@@ -2278,10 +2207,9 @@@@ do
 				proxyserver="$PROXYSERVER" \
 				browserrmt="$BROWSER_RMT" \
 				browserdir="$BROWSER_DIR" \
-				$CFGDIR/common.cfg > /tmp/xmcd.$$
+				$CFGDIR/common.cfg > $TMPFILE
 
-			cp /tmp/xmcd.$$ $CFGDIR/common.cfg
-			rm -f /tmp/xmcd.$$
+			cp $TMPFILE $CFGDIR/common.cfg
 			(cd $CFGDIR ;\
 			 rm -f common.cfg-${OS_NODE} ;\
 			 do_link common.cfg common.cfg-${OS_NODE})
@


1.2
log
@Entirely new port for xmcd 2.6, largely derived from FreeBSD and Debian.
Once upon a time reviewed by espie@@.
Reported to be unstable with LessTif, fine with OpenMotif.
@
text
@d1 1
a1 1
$OpenBSD$
d3 1
a3 1
+++ libdi_d/config.sh	Wed Nov  8 02:35:46 2000
d23 1
a23 1
@@@@ -491,40 +492,8 @@@@ ask_nonscsi_config()
d39 3
a41 1
-
d63 1
a63 3
+	# *BSD
+	IOCMETHOD=2
 
d66 1
@


1.1
log
@Half-fix xmcd.
Now, it configures AFTER the package installation.
All it needs is someone to look at the ioctl and find out what OpenBSD
is supposed to do.
@
text
@d1 6
a6 22
$OpenBSD: update-patches,v 1.3 2000/06/09 17:08:37 espie Exp $
--- libdi_d/config.sh.orig	Sun Dec  3 20:58:50 2000
+++ libdi_d/config.sh	Sun Dec  3 21:32:17 2000
@@@@ -25,20 +25,23 @@@@
 #    Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
 #
 
-PATH=/bin:/usr/bin:/sbin:/usr/sbin:/etc:/usr/local/bin:/usr/ucb
+PATH=/bin:/usr/bin:/sbin:/usr/sbin:/etc:/usr/local/bin
 export PATH
 
 VER=2.3
 
 # Change the following directory to fit your local configuration
-BINDIR=/usr/bin/X11
-LIBDIR=/usr/lib/X11
-XMCDLIB=/usr/lib/X11/xmcd
-APPDEFAULTSDIR=/usr/lib/X11/app-defaults
+BINDIR=/usr/local/bin
+LIBDIR=/usr/local/lib/X11
+XMCDLIB=/usr/local/lib/X11/xmcd
+APPDEFAULTSDIR=/usr/local/lib/X11/app-defaults
d8 1
a8 1
 ERRFILE=/tmp/xmcd.err
d11 3
a13 5
+# Catch some signals
+trap "rm -f $TMPFILE $TMPSITES; exit 1" 1 2 3 5 15
+
+TMPFILE=`mktemp /tmp/.xmcdcfg.XXXXXXXXXX`
+TMPSITES=`mktemp /tmp/.sites.XXXXXXXXXX`
d15 2
a16 1
 CFGDIR=$XMCDLIB/config
d18 118
a135 3
@@@@ -1642,9 +1645,6 @@@@ browser_config()
 # Main starts here
 #
d137 1
a137 7
-# Catch some signals
-trap "rm -f $TMPFILE $TMPSITES; exit 1" 1 2 3 5 15
-
 # Get platform information
 OS_SYS=`(uname -s) 2>/dev/null`
 OS_VER=`(uname -r) 2>/dev/null`
@@@@ -1811,14 +1811,7 @@@@ elif [ "$OS_SYS" = OpenBSD ]
d141 1
a141 1
-	case "`uname -m`" in
d153 1
a153 2
@@@@ -2057,49 +2050,9 @@@@ do
 
d156 1
a156 1
-		#
d159 2
a160 2
-		chmod 644 $APPDEFAULTSDIR/XMcd 2>/dev/null
-		if [ -w $APPDEFAULTSDIR/XMcd ]
d174 1
a174 1
-				$APPDEFAULTSDIR/XMcd > /tmp/xmcd.$$
d176 1
a176 1
-			cp /tmp/xmcd.$$ $APPDEFAULTSDIR/XMcd
a177 16
-
-			if [ $LIBDIR != "/usr/lib/X11" -a \
-			     -d /usr/lib/X11/app-defaults ]
-			then
-				rm -f /usr/lib/X11/app-defaults/._trash_
-				>$APPDEFAULTSDIR/._trash_
-
-				if [ ! -f /usr/lib/X11/app-defaults/._trash_ ]
-				then
-					rm -f /usr/lib/X11/app-defaults/XMcd
-					dolink $APPDEFAULTSDIR/XMcd \
-						/usr/lib/X11/app-defaults/XMcd
-				fi
-
-				rm -f $APPDEFAULTSDIR/._trash_
-			fi
d179 1
a179 1
-			logerr -p "Cannot configure $APPDEFAULTSDIR/XMcd"
d182 2
a183 4
 
+		test -f $CFGDIR/common.cfg || \
+			cp $CFGDIR/common.cfg.base $CFGDIR/common.cfg
 		#
d186 14
@

