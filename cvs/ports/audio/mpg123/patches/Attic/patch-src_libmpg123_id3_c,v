head	1.1;
access;
symbols
	OPENBSD_5_9:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2016.11.04.15.48.13;	author naddy;	state dead;
branches
	1.1.2.1;
next	;
commitid	EJqdBBfHScpPp8ri;

1.1.2.1
date	2016.11.04.15.48.13;	author naddy;	state Exp;
branches;
next	;
commitid	EJqdBBfHScpPp8ri;


desc
@@


1.1
log
@file patch-src_libmpg123_id3_c was initially added on branch OPENBSD_5_9.
@
text
@@


1.1.2.1
log
@Fix an out-of-bounds memory read in the ID3v2 parser for tags that claim an
unrealistically small length.
@
text
@a0 12
$OpenBSD$
--- src/libmpg123/id3.c.orig	Wed Aug 12 07:33:47 2015
+++ src/libmpg123/id3.c	Fri Nov  4 16:42:28 2016
@@@@ -752,7 +752,7 @@@@ int parse_new_id3(mpg123_handle *fr, unsigned long fir
 					unsigned long fflags; /* need 16 bits, actually */
 					id[4] = 0;
 					/* pos now advanced after ext head, now a frame has to follow */
-					while(tagpos < length-10) /* I want to read at least a full header */
+					while(length >= 10 && tagpos < length-10) /* I want to read at least a full header */
 					{
 						int i = 0;
 						unsigned long pos = tagpos;
@

