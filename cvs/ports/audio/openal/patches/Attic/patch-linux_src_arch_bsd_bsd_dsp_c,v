head	1.2;
access;
symbols
	OPENBSD_4_0:1.1.1.1.0.8
	OPENBSD_4_0_BASE:1.1.1.1
	OPENBSD_3_9:1.1.1.1.0.6
	OPENBSD_3_9_BASE:1.1.1.1
	OPENBSD_3_8:1.1.1.1.0.4
	OPENBSD_3_8_BASE:1.1.1.1
	OPENBSD_3_7:1.1.1.1.0.2
	OPENBSD_3_7_BASE:1.1.1.1
	jolan_2004-10-21:1.1.1.1
	jolan:1.1.1;
locks; strict;
comment	@# @;


1.2
date	2006.10.30.23.31.37;	author steven;	state dead;
branches;
next	1.1;

1.1
date	2004.10.21.05.04.16;	author jolan;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2004.10.21.05.04.16;	author jolan;	state Exp;
branches;
next	;


desc
@@


1.2
log
@update to OpenAL 0.0.8

ok jolan@@
@
text
@$OpenBSD: patch-linux_src_arch_bsd_bsd_dsp_c,v 1.1 2004/10/21 05:04:16 jolan Exp $
--- linux/src/arch/bsd/bsd_dsp.c.orig	2003-06-20 11:18:33.000000000 -0700
+++ linux/src/arch/bsd/bsd_dsp.c	2004-01-10 08:23:30.000000000 -0800
@@@@ -15,7 +15,7 @@@@
 
 #include <assert.h>
 #include <fcntl.h>
-#include <sys/soundcard.h>
+#include <soundcard.h>
 #include <stdio.h>
 #include <stdlib.h>
 #include <string.h>
@@@@ -112,7 +112,7 @@@@ static int AL2BSDFMT(int fmt)
  *
  */
 void *grab_write_native(void) {
-	const char *dsppath = "/dev/dsp";
+	const char *dsppath = "/dev/audio";
 	int divisor = _alSpot(_AL_DEF_BUFSIZ) | (2<<16);
 
 	dsp_fd = open(dsppath, O_WRONLY | O_NONBLOCK);
@@@@ -148,9 +148,11 @@@@ int grab_mixerfd(void) {
 	mixer_fd = open("/dev/mixer", O_WRONLY | O_NONBLOCK);
 
 	if(mixer_fd > 0) {
+#if 0
 		if(fcntl(mixer_fd, F_SETFL, ~O_NONBLOCK) == -1) {
 			perror("fcntl");
 		}
+#endif
 
 		return mixer_fd;
 	} else {
@@@@ -212,7 +214,7 @@@@ void release_native(void *handle) {
 
 	handle_fd = *(int *) handle;
 
-	if(ioctl(handle_fd, SNDCTL_DSP_RESET) < 0) {
+	if(ioctl(handle_fd, SNDCTL_DSP_RESET, NULL) < 0) {
 #ifdef DEBUG_MAXIMUS
 		fprintf(stderr, "Couldn't reset dsp\n");
 #endif
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
$OpenBSD$
@


1.1.1.1
log
@openal-20040816, cross-platform 3D audio API
@
text
@@
