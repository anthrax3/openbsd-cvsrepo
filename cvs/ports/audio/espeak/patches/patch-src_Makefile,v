head	1.10;
access;
symbols
	OPENBSD_6_1:1.10.0.16
	OPENBSD_6_1_BASE:1.10
	OPENBSD_6_0:1.10.0.14
	OPENBSD_6_0_BASE:1.10
	OPENBSD_5_9:1.10.0.10
	OPENBSD_5_9_BASE:1.10
	OPENBSD_5_8:1.10.0.12
	OPENBSD_5_8_BASE:1.10
	OPENBSD_5_7:1.10.0.8
	OPENBSD_5_7_BASE:1.10
	OPENBSD_5_6:1.10.0.6
	OPENBSD_5_6_BASE:1.10
	OPENBSD_5_5:1.10.0.4
	OPENBSD_5_5_BASE:1.10
	OPENBSD_5_4:1.10.0.2
	OPENBSD_5_4_BASE:1.10
	OPENBSD_5_3:1.9.0.2
	OPENBSD_5_3_BASE:1.9
	OPENBSD_5_2:1.7.0.2
	OPENBSD_5_2_BASE:1.7
	OPENBSD_5_1_BASE:1.6
	OPENBSD_5_1:1.6.0.12
	OPENBSD_5_0:1.6.0.10
	OPENBSD_5_0_BASE:1.6
	OPENBSD_4_9:1.6.0.8
	OPENBSD_4_9_BASE:1.6
	OPENBSD_4_8:1.6.0.6
	OPENBSD_4_8_BASE:1.6
	OPENBSD_4_7:1.6.0.4
	OPENBSD_4_7_BASE:1.6
	OPENBSD_4_6:1.6.0.2
	OPENBSD_4_6_BASE:1.6
	OPENBSD_4_5:1.3.0.2
	OPENBSD_4_5_BASE:1.3
	jasper_20081026:1.1.1.1
	jasper:1.1.1;
locks; strict;
comment	@# @;


1.10
date	2013.03.27.15.33.32;	author ajacoutot;	state Exp;
branches;
next	1.9;

1.9
date	2012.09.26.19.20.59;	author brad;	state Exp;
branches;
next	1.8;

1.8
date	2012.08.22.20.14.06;	author naddy;	state Exp;
branches;
next	1.7;

1.7
date	2012.06.23.12.23.31;	author ajacoutot;	state Exp;
branches;
next	1.6;

1.6
date	2009.05.14.19.24.06;	author sturm;	state Exp;
branches;
next	1.5;

1.5
date	2009.04.16.16.39.17;	author ajacoutot;	state Exp;
branches;
next	1.4;

1.4
date	2009.03.23.12.02.28;	author ajacoutot;	state Exp;
branches;
next	1.3;

1.3
date	2008.11.04.06.40.26;	author sturm;	state Exp;
branches;
next	1.2;

1.2
date	2008.11.03.20.23.18;	author jasper;	state Exp;
branches;
next	1.1;

1.1
date	2008.10.26.19.42.11;	author jasper;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2008.10.26.19.42.11;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.10
log
@Update to espeak-1.47.03.
@
text
@$OpenBSD: patch-src_Makefile,v 1.9 2012/09/26 19:20:59 brad Exp $
--- src/Makefile.orig	Mon Mar 18 01:51:31 2013
+++ src/Makefile	Wed Mar 27 16:10:39 2013
@@@@ -1,8 +1,8 @@@@
 # remove -fno-exceptions  if it causes problems with stdio library on some platforms (ARM)
 
-DATADIR=/usr/share/espeak-data
+DATADIR=$(PREFIX)/share/espeak-data
 
-PREFIX=/usr
+PREFIX ?=/usr
 BINDIR=$(PREFIX)/bin
 INCDIR=$(PREFIX)/include/espeak
 LIBDIR=$(PREFIX)/lib
@@@@ -12,9 +12,11 @@@@ BIN_NAME = speak
 BIN2_NAME = espeak
 LIB_NAME = libespeak.so
 STATIC_LIB_NAME = libespeak.a
-LIB_VERSION = 1
-LIBTAG = $(LIB_VERSION).$(RELEASE)
+LIB_VERSION = ${LIBespeak_VERSION}
+LIBTAG = $(LIB_VERSION)
 
+LPATH= -L${LOCALBASE}/lib -Wl,-R${LOCALBASE}/lib
+
 # Use SONAME_OPT=-Wl,h, on Solaris
 SONAME_OPT=-Wl,-soname,
 
@@@@ -45,7 +47,7 @@@@ USE_AUDIO=-DUSE_PULSEAUDIO
 else
 ifeq ($(AUDIO),portaudio)
 WAVE=wave.cpp
-LIB_AUDIO=-lportaudio
+LIB_AUDIO=-L$(LOCALBASE)/lib -lportaudio
 USE_AUDIO=-DUSE_PORTAUDIO
 else
 ifeq ($(AUDIO),portaudio0)
@@@@ -91,9 +93,8 @@@@ LIBS2=-lstdc++ $(LIB_AUDIO) -lpthread
 
 SRCS3 = espeak.cpp
 OBJS3=$(patsubst %.cpp,%.o,$(SRCS3))
-LIBS3=-lstdc++ -L . -lespeak
+LIBS3=-lstdc++ -L . -lespeak -L${LOCALBASE}/lib
 
-CXXFLAGS=-O2
 
 
 all: $(BIN_NAME) $(LIB_NAME) $(STATIC_LIB_NAME) $(BIN2_NAME)
@@@@ -102,7 +103,7 @@@@ all: $(BIN_NAME) $(LIB_NAME) $(STATIC_LIB_NAME) $(BIN2
 	$(CXX) $(CXXFLAGS) $(USE_AUDIO) -D PATH_ESPEAK_DATA=\"$(DATADIR)\" -Wall -pedantic -I. -c -fno-exceptions  $<
 
 $(BIN_NAME): $(OBJS1)
-	$(CXX) $(LDFLAGS) -o $@@ $(OBJS1) $(LIBS1)
+	$(CXX) $(LDFLAGS) -o $@@ $(EXTRA_FLAGS) $(OBJS1) $(LIBS1)
 
 $(BIN2_NAME): $(OBJS3) $(LIB_NAME)
 	$(CXX) $(LDFLAGS) -o $@@ $(OBJS3) $(LIBS3)
@@@@ -110,15 +111,13 @@@@ $(BIN2_NAME): $(OBJS3) $(LIB_NAME)
 
 
 x_%.o: %.cpp
-	$(CXX) $(CXXFLAGS) $(USE_AUDIO) -D PATH_ESPEAK_DATA=\"$(DATADIR)\" -Wall -fpic -fvisibility=hidden -pedantic \
+	$(CXX) $(CXXFLAGS) $(USE_AUDIO) -D PATH_ESPEAK_DATA=\"$(DATADIR)\" -Wall -fPIC -DPIC -pedantic \
 	-I. -D LIBRARY -c -fno-exceptions  $<  -o x_$*.o
 
 $(LIB_NAME): $(OBJS2)
-	$(CXX) $(LDFLAGS) -shared $(SONAME_OPT)$(LIB_NAME).$(LIB_VERSION) -o $@@ \
-	$(OBJS2) $(LIBS2)
+	$(CXX) $(LDFLAGS) -shared -fPIC -o $@@ \
+	$(OBJS2) $(LIBS2) $(EXTRA_FLAGS)
 	mv $(LIB_NAME) $(LIB_NAME).$(LIBTAG)
-	$(LN_SF) $(LIB_NAME).$(LIBTAG) $(LIB_NAME).$(LIB_VERSION)
-	$(LN_SF) $(LIB_NAME).$(LIB_VERSION) $(LIB_NAME)
 
 $(STATIC_LIB_NAME): $(OBJS2)
 	$(AR) cqs $(STATIC_LIB_NAME) $(OBJS2)
@@@@ -144,10 +143,8 @@@@ install: all
 	$(INSTALL) -m 755 $(LIB_NAME).$(LIBTAG) $(DESTDIR)$(LIBDIR)
 	# Install static library
 	$(INSTALL) -m 755 $(STATIC_LIB_NAME) $(DESTDIR)$(LIBDIR)
-	$(LN_SF) $(LIB_NAME).$(LIBTAG) $(DESTDIR)$(LIBDIR)/$(LIB_NAME).$(LIB_VERSION)
-	$(LN_SF) $(LIB_NAME).$(LIB_VERSION) $(DESTDIR)$(LIBDIR)/$(LIB_NAME)
 	# Install development headers
 	$(INSTALL) -pm 644 speak_lib.h $(DESTDIR)$(INCDIR)
 	# Install data files
-	cp -prf ../espeak-data/* $(DESTDIR)$(DATADIR)
+	cp -pRf ../espeak-data/* $(DESTDIR)$(DATADIR)
 
@


1.9
log
@Don't create the shared lib using soname.

ok sthen@@
@
text
@d1 4
a4 4
$OpenBSD: patch-src_Makefile,v 1.8 2012/08/22 20:14:06 naddy Exp $
--- src/Makefile.orig	Tue Nov 22 16:46:08 2011
+++ src/Makefile	Wed Aug 22 17:43:42 2012
@@@@ -1,20 +1,20 @@@@
d8 2
a9 1
-
d11 1
d15 1
a15 4
+DATADIR=$(PREFIX)/share/espeak-data
 
 RELEASE = 1.46
 BIN_NAME = speak
d29 1
a29 1
@@@@ -45,7 +45,7 @@@@ USE_AUDIO=-DUSE_PULSEAUDIO
d38 1
a38 1
@@@@ -91,9 +91,8 @@@@ LIBS2=-lstdc++ $(LIB_AUDIO) -lpthread
d43 1
a43 1
+LIBS3=-lstdc++ -L . -lespeak -lpthread -L${LOCALBASE}/lib
d49 1
a49 1
@@@@ -102,7 +101,7 @@@@ all: $(BIN_NAME) $(LIB_NAME) $(STATIC_LIB_NAME) $(BIN2
d58 1
a58 1
@@@@ -110,15 +109,13 @@@@ $(BIN2_NAME): $(OBJS3) $(LIB_NAME)
d77 1
a77 1
@@@@ -144,10 +141,8 @@@@ install: all
@


1.8
log
@remove unneeded -pthread patches
@
text
@d1 3
a3 3
$OpenBSD: patch-src_Makefile,v 1.7 2012/06/23 12:23:31 ajacoutot Exp $
--- src/Makefile.orig	Tue Nov 22 22:46:08 2011
+++ src/Makefile	Mon Aug 20 17:46:20 2012
d70 1
a70 1
+	$(CXX) $(LDFLAGS) -shared -fPIC $(SONAME_OPT)$(LIB_NAME).$(LIB_VERSION) -o $@@ \
@


1.7
log
@Update to espeak-1.46.02.
@
text
@d1 1
a1 1
$OpenBSD: patch-src_Makefile,v 1.6 2009/05/14 19:24:06 sturm Exp $
d3 1
a3 1
+++ src/Makefile	Sat Jun 23 14:13:00 2012
d39 1
a39 11
@@@@ -83,26 +83,25 @@@@ libespeak_SOURCES = speak_lib.cpp compiledict.cpp dict
 
 SRCS1=$(speak_SOURCES)
 OBJS1=$(patsubst %.cpp,%.o,$(SRCS1))
-LIBS1=-lstdc++ $(LIB_AUDIO) -lpthread $(EXTRA_LIBS)
+LIBS1=-lstdc++ $(LIB_AUDIO) -pthread $(EXTRA_LIBS)
 
 SRCS2=$(libespeak_SOURCES)
 OBJS2=$(patsubst %.cpp,x_%.o,$(SRCS2))
-LIBS2=-lstdc++ $(LIB_AUDIO) -lpthread
+LIBS2=-lstdc++ $(LIB_AUDIO) -pthread
d44 1
a44 1
+LIBS3=-lstdc++ -L . -lespeak -pthread -L${LOCALBASE}/lib
d50 2
a51 4
 
 .cpp.o:
-	$(CXX) $(CXXFLAGS) $(USE_AUDIO) -D PATH_ESPEAK_DATA=\"$(DATADIR)\" -Wall -pedantic -I. -c -fno-exceptions  $<
+	$(CXX) $(CXXFLAGS) -pthread $(USE_AUDIO) -D PATH_ESPEAK_DATA=\"$(DATADIR)\" -Wall -pedantic -I. -c -fno-exceptions  $<
d64 1
a64 1
+	$(CXX) $(CXXFLAGS) -pthread $(USE_AUDIO) -D PATH_ESPEAK_DATA=\"$(DATADIR)\" -Wall -fPIC -DPIC -pedantic \
@


1.6
log
@unbreak build on sparc64...again
@
text
@d1 4
a4 4
$OpenBSD: patch-src_Makefile,v 1.5 2009/04/16 16:39:17 ajacoutot Exp $
--- src/Makefile.orig	Mon Dec 22 23:37:41 2008
+++ src/Makefile	Thu Apr 16 18:33:32 2009
@@@@ -1,6 +1,5 @@@@
d7 2
d13 4
a16 1
@@@@ -11,9 +10,11 @@@@ BIN_NAME = speak
d30 1
a30 1
@@@@ -35,7 +36,7 @@@@ USE_AUDIO=-DUSE_PULSEAUDIO
d38 2
a39 2
 ifeq ($(AUDIO),sada)
@@@@ -60,27 +61,25 @@@@ libespeak_SOURCES = speak_lib.cpp compiledict.cpp dict
d49 1
a49 1
+LIBS2=-lstdc++ $(LPATH) $(LIB_AUDIO) -pthread
d54 1
a54 1
+LIBS3=-lstdc++ -L . -lespeak $(LPATH) -pthread
d58 1
a58 1
-
a59 1
 	mv $(LIB_NAME) $(LIB_NAME).$(LIBTAG)
d66 2
a67 2
-	$(CXX) -o $@@ $(OBJS1) $(LIBS1)
+	$(CXX) -o $@@ $(EXTRA_FLAGS) $(OBJS1) $(LIBS1)
d70 2
a71 2
 	$(CXX) -o $@@ $(OBJS3) $(LIBS3)
@@@@ -88,11 +87,11 @@@@ $(BIN2_NAME): $(OBJS3) $(LIB_NAME)
d75 3
a77 4
-	$(CXX) $(CXXFLAGS) $(USE_AUDIO) -Wall -fpic -fvisibility=hidden -pedantic \
-	-I. -D LIBRARY -c -fno-exceptions  $<  -o x_$*.o
+	$(CXX) $(CXXFLAGS) -pthread $(USE_AUDIO) -Wall -fPIC -DPIC -pedantic \
+	-I. -DLIBRARY -DPATH_ESPEAK_DATA=\"$(DATADIR)\" -c -fno-exceptions $<  -o x_$*.o
d80 7
a86 2
-	$(CXX) -shared $(SONAME_OPT)$(LIB_NAME).$(LIB_VERSION) -o $@@ $(OBJS2) $(LIBS2)
+	$(CXX) -shared -fPIC $(SONAME_OPT)$(LIB_NAME).$(LIB_VERSION) -o $@@ $(OBJS2) $(LIBS2) $(EXTRA_FLAGS)
d90 6
a95 1
@@@@ -123,5 +122,5 @@@@ install: all
@


1.5
log
@- bring in 2 patches from pkgsrc to actually make espeak work live (and
not only be able to save text to speech in wav file)
- rework the src Makefile
- use system portaudio.h instead of the bundled one
@
text
@d1 1
a1 1
$OpenBSD: patch-src_Makefile,v 1.4 2009/03/23 12:02:28 ajacoutot Exp $
d73 1
a73 1
+	$(CXX) $(CXXFLAGS) -pthread $(USE_AUDIO) -Wall -fpic -pedantic \
@


1.4
log
@- update espeak to latest stable version: 1.40.02
@
text
@d1 3
a3 3
$OpenBSD: patch-src_Makefile,v 1.3 2008/11/04 06:40:26 sturm Exp $
--- src/Makefile.orig	Mon Mar 23 12:36:15 2009
+++ src/Makefile	Mon Mar 23 12:39:29 2009
d25 9
d39 1
a39 1
+LIBS1=-lstdc++ $(LPATH) -lportaudio -pthread
d44 1
a44 1
+LIBS2=-lstdc++ $(LPATH) -lportaudio -pthread
d49 1
a49 1
+LIBS3=-lstdc++ -L . -lespeak $(LPATH) -lportaudio -pthread
d59 1
a59 1
+	$(CXX) $(CXXFLAGS) $(EXTRA_FLAGS) $(USE_AUDIO) -D PATH_ESPEAK_DATA=\"$(DATADIR)\" -Wall -pedantic -I. -c -fno-exceptions  $<
d73 1
a73 1
+	$(CXX) $(CXXFLAGS) $(USE_AUDIO) -Wall -fPIC -DPIC -pedantic \
d82 7
@


1.3
log
@use -fPIC -DPIC instead of just -fpic to unbreak build on sparc64
@
text
@d1 4
a4 4
$OpenBSD: patch-src_Makefile,v 1.2 2008/11/03 20:23:18 jasper Exp $
--- src/Makefile.orig	Wed Apr 16 06:06:34 2008
+++ src/Makefile	Mon Nov  3 22:30:44 2008
@@@@ -1,19 +1,20 @@@@
d11 1
a11 5
-DATADIR=$(PREFIX)/share/espeak-data
+DATADIR=${PREFIX}/share/espeak-data
 
 RELEASE = 1.37
 BIN_NAME = speak
d17 1
a17 1
+LIB_VERSION = 0.0
d25 1
a25 1
@@@@ -60,39 +61,37 @@@@ libespeak_SOURCES = speak_lib.cpp compiledict.cpp dict
d57 2
a58 3
-	$(CXX) -o $@@ $(OBJS3) $(LIBS3)
+	$(CXX) -o $@@ $(EXTRA_FLAGS) $(OBJS3) $(LIBS3)
 
d62 1
a62 1
-	$(CXX) $(CXXFLAGS) $(USE_AUDIO) -Wall -fpic -pedantic \
@


1.2
log
@- fix build on amd64
- honor CXX and CXXFLAGS
@
text
@d1 3
a3 3
$OpenBSD: patch-src_Makefile,v 1.1.1.1 2008/10/26 19:42:11 jasper Exp $
--- src/Makefile.orig	Wed Apr 16 14:06:34 2008
+++ src/Makefile	Mon Nov  3 21:19:49 2008
d67 1
a67 1
 	$(CXX) $(CXXFLAGS) $(USE_AUDIO) -Wall -fpic -pedantic \
d69 1
d74 1
a74 1
+	$(CXX) -shared $(SONAME_OPT)$(LIB_NAME).$(LIB_VERSION) -o $@@ $(OBJS2) $(LIBS2) $(EXTRA_FLAGS)
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
$OpenBSD$
d3 1
a3 1
+++ src/Makefile	Tue Aug 12 16:14:52 2008
d21 1
a21 1
+LIB_VERSION = ${LIBespeak_VERSION}
d29 1
a29 1
@@@@ -60,15 +61,15 @@@@ libespeak_SOURCES = speak_lib.cpp compiledict.cpp dict
d46 18
a63 1
 CXXFLAGS=-O2
a64 1
@@@@ -89,7 +90,7 @@@@ $(BIN2_NAME): $(OBJS3) $(LIB_NAME)
d72 5
a76 1
 	$(CXX) -shared $(SONAME_OPT)$(LIB_NAME).$(LIB_VERSION) -o $@@ $(OBJS2) $(LIBS2)
@


1.1.1.1
log
@import espeak 1.37

eSpeak produces good quality English speech. It uses a different
synthesis method from other open source TTS engines, and sounds
quite different. It's perhaps not as natural or "smooth", but
the articulation is much clearer and easier to listen to for long
periods.
@
text
@@
