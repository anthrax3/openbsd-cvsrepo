head	1.6;
access;
symbols
	OPENBSD_5_6:1.5.0.2
	OPENBSD_5_6_BASE:1.5
	OPENBSD_5_1_BASE:1.1.1.1
	OPENBSD_5_1:1.1.1.1.0.4
	OPENBSD_5_0:1.1.1.1.0.2
	OPENBSD_5_0_BASE:1.1.1.1
	dcoppa_20110403:1.1.1.1
	dcoppa:1.1.1;
locks; strict;
comment	@# @;


1.6
date	2014.09.04.12.33.27;	author dcoppa;	state dead;
branches;
next	1.5;
commitid	X21woT3ICTss46TU;

1.5
date	2014.07.25.22.03.30;	author naddy;	state Exp;
branches;
next	1.4;
commitid	NNEUH7nTWCEijgVR;

1.4
date	2014.06.06.09.08.37;	author dcoppa;	state Exp;
branches;
next	1.3;
commitid	iE9wHXaoCVyX5WZg;

1.3
date	2012.06.26.13.00.14;	author jasper;	state dead;
branches;
next	1.2;

1.2
date	2012.04.12.10.03.19;	author dcoppa;	state Exp;
branches;
next	1.1;

1.1
date	2011.04.03.12.04.47;	author dcoppa;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2011.04.03.12.04.47;	author dcoppa;	state Exp;
branches;
next	;


desc
@@


1.6
log
@
Update to umurmur-0.2.15
@
text
@$OpenBSD: patch-src_crypt_c,v 1.5 2014/07/25 22:03:30 naddy Exp $

Fix an issue with byte switching. The preprocessor directive used to
determine the endianess of the system only worked on Linux resulting in
voice running over TCP only when umurmur runs on other platforms.

Adapted from upstream git commit 27da14ea2abe5680ddfcffbf2a59be5f5a67cecd

--- src/crypt.c.orig	Wed Jan  1 22:40:30 2014
+++ src/crypt.c	Fri Jul 25 23:01:45 2014
@@@@ -220,16 +220,16 @@@@ bool_t CryptState_decrypt(cryptState_t *cs, const unsi
 #define SHIFTBITS 63
 typedef uint64_t subblock;
 
-#if __BYTE_ORDER == __BIG_ENDIAN
+#if defined(BYTE_ORDER_BIG_ENDIAN)
 #define SWAPPED(x) (x)
-#else
-#ifdef __x86_64__
+#elif defined( __x86_64__)
 #define SWAPPED(x) ({register uint64_t __out, __in = (x); __asm__("bswap %q0" : "=r"(__out) : "0"(__in)); __out;})
-#else
+#elif defined(LINUX)
 #include <byteswap.h>
 #define SWAPPED(x) bswap_64(x)
-#endif
-#endif
+#else
+#define SWAPPED(x) htobe64(x)
+#endif // defined(BYTE_ORDER_BIG_ENDIAN)
 
 #else
 
@


1.5
log
@Skip linuxism to fix build on LP64 archs that aren't amd64.
While here, remove the mistaken NO_TEST.

ok sthen@@
@
text
@d1 1
a1 1
$OpenBSD: patch-src_crypt_c,v 1.4 2014/06/06 09:08:37 dcoppa Exp $
@


1.4
log
@
Use c99 standard bool when available
(upstream git commit 7470834ac6613c2e22626f9511384f025f16768e)

Fix an issue with byte switching. The preprocessor directive used to
determine the endianess of the system only worked on Linux resulting in
voice running over TCP only when umurmur runs on other platforms.
(adapted from upstream git commit 27da14ea2abe5680ddfcffbf2a59be5f5a67cecd)
@
text
@d1 1
a1 1
$OpenBSD$
d10 2
a11 2
+++ src/crypt.c	Fri Jun  6 10:39:52 2014
@@@@ -220,16 +220,14 @@@@ bool_t CryptState_decrypt(cryptState_t *cs, const unsi
d22 2
a23 1
 #else
d28 2
@


1.3
log
@- these patches (or chunks) are not needed anymore since arpa/inet.h -r1.12
@
text
@d1 29
a29 5
$OpenBSD: patch-src_crypt_c,v 1.2 2012/04/12 10:03:19 dcoppa Exp $
--- src/crypt.c.orig	Sun Mar 18 20:26:26 2012
+++ src/crypt.c	Thu Apr 12 11:36:49 2012
@@@@ -39,6 +39,8 @@@@
  */
a30 6
 #include <string.h>
+#include <sys/types.h>
+#include <netinet/in.h>
 #include <arpa/inet.h>
 #include "crypt.h"
 #include "ssl.h"
@


1.2
log
@Update to umurmur-0.2.10.
From maintainer Jonathon Sisson, tweaked by me
@
text
@d1 1
a1 1
$OpenBSD: patch-src_crypt_c,v 1.1.1.1 2011/04/03 12:04:47 dcoppa Exp $
@


1.1
log
@Initial revision
@
text
@d1 3
a3 3
$OpenBSD$
--- src/crypt.c.orig	Sat Feb 13 16:36:54 2010
+++ src/crypt.c	Wed Dec 22 16:34:59 2010
d12 1
a12 1
 
@


1.1.1.1
log
@Import audio/umurmur, a minimalistic Mumble server implementation.

Initial port and manual pages by J Sisson.
Tweaked by myself and ajacoutot@@.

OK ajacoutot@@
@
text
@@
