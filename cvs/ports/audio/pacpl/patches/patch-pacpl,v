head	1.6;
access;
symbols
	OPENBSD_6_0:1.6.0.14
	OPENBSD_6_0_BASE:1.6
	OPENBSD_5_9:1.6.0.10
	OPENBSD_5_9_BASE:1.6
	OPENBSD_5_8:1.6.0.12
	OPENBSD_5_8_BASE:1.6
	OPENBSD_5_7:1.6.0.8
	OPENBSD_5_7_BASE:1.6
	OPENBSD_5_6:1.6.0.6
	OPENBSD_5_6_BASE:1.6
	OPENBSD_5_5:1.6.0.4
	OPENBSD_5_5_BASE:1.6
	OPENBSD_5_4:1.6.0.2
	OPENBSD_5_4_BASE:1.6
	OPENBSD_5_3:1.5.0.4
	OPENBSD_5_3_BASE:1.5
	OPENBSD_5_2:1.5.0.2
	OPENBSD_5_2_BASE:1.5
	OPENBSD_5_1_BASE:1.2
	OPENBSD_5_1:1.2.0.14
	OPENBSD_5_0:1.2.0.12
	OPENBSD_5_0_BASE:1.2
	OPENBSD_4_9:1.2.0.10
	OPENBSD_4_9_BASE:1.2
	OPENBSD_4_8:1.2.0.8
	OPENBSD_4_8_BASE:1.2
	OPENBSD_4_7:1.2.0.6
	OPENBSD_4_7_BASE:1.2
	OPENBSD_4_6:1.2.0.4
	OPENBSD_4_6_BASE:1.2
	OPENBSD_4_5:1.2.0.2
	OPENBSD_4_5_BASE:1.2
	OPENBSD_4_4:1.1.1.1.0.8
	OPENBSD_4_4_BASE:1.1.1.1
	OPENBSD_4_3:1.1.1.1.0.6
	OPENBSD_4_3_BASE:1.1.1.1
	OPENBSD_4_2:1.1.1.1.0.4
	OPENBSD_4_2_BASE:1.1.1.1
	OPENBSD_4_1:1.1.1.1.0.2
	OPENBSD_4_1_BASE:1.1.1.1
	steven-20061212:1.1.1.1
	steven:1.1.1;
locks; strict;
comment	@# @;


1.6
date	2013.04.27.11.39.47;	author sthen;	state Exp;
branches;
next	1.5;

1.5
date	2012.06.13.11.43.12;	author jasper;	state Exp;
branches;
next	1.4;

1.4
date	2012.05.25.13.46.08;	author shadchin;	state Exp;
branches;
next	1.3;

1.3
date	2012.04.28.09.02.36;	author sthen;	state Exp;
branches;
next	1.2;

1.2
date	2008.12.23.15.52.42;	author ajacoutot;	state Exp;
branches;
next	1.1;

1.1
date	2006.12.12.06.21.34;	author steven;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2006.12.12.06.21.34;	author steven;	state Exp;
branches;
next	;


desc
@@


1.6
log
@update pacpl to 4.0.5, also:

- patch to fix the annoying warnings on systems without LANG or
PWD set in the environment

- roll subpackages into the main package; no point having an entire
package that just installs some scripts/data files (which are harmless
if the corresponding package is not installed) and adds run deps.
@
text
@$OpenBSD: patch-pacpl,v 1.5 2012/06/13 11:43:12 jasper Exp $
--- pacpl.orig	Fri Mar 20 02:19:03 2009
+++ pacpl	Sat Apr 27 12:34:15 2013
@@@@ -130,8 +130,8 @@@@ my %config = (
              );
 
 # location of configuration file
-my $conf_path = "/etc/pacpl";
-my $po_dir    = "/usr/share/pacpl/locale";
+my $conf_path = "${SYSCONFDIR}/pacpl";
+my $po_dir    = "${PREFIX}/share/pacpl/locale";
 my $mod_dir   = "$conf_path/modules";
 
 my $conf_file;
@@@@ -143,7 +143,6 @@@@ load_lang();
 my @@conf_locations = ( 
                        "$ENV{HOME}/.pacplrc",   # Local
                        "$conf_path/pacpl.conf", # Global
-                       "$ENV{PWD}/pacpl.conf",  # Current Directory
                      );
 
 # try to load conf file from one of the above locations
@@@@ -203,7 +202,8 @@@@ sub load_codecs {
 # load po file and store in %lang hash
 sub load_lang {
 
-    my $po = "$po_dir/$ENV{LANG}.po";
+    my $po = "";
+       $po = "$po_dir/$ENV{LANG}.po" if ($ENV{'LANG'});
        $po =~ s/\.UTF-8//i      if $po =~ /UTF-8/i; 
        $po =~ s/\.utf8//i       if $po =~ /utf8/i;  
        $po =~ s/_\w+//          if not -e $po;      
@@@@ -708,8 +708,8 @@@@ my $opts;
 
        flac => {
 
-                DEFAULT_ENCODER => "flac",
-                DEFAULT_DECODER => "flac",
+                DEFAULT_ENCODER => "ffmpeg",
+                DEFAULT_DECODER => "ffmpeg",
                 
                 ENCODER => {
                               flac => {
@@@@ -908,8 +908,8 @@@@ my $opts;
 
        aac  => {
 
-                DEFAULT_ENCODER => "faac",
-                DEFAULT_DECODER => "faad",
+                DEFAULT_ENCODER => "ffmpeg",
+                DEFAULT_DECODER => "ffmpeg",
                 
                 ENCODER => {
                               faac => {
@@@@ -927,7 +927,7 @@@@ my $opts;
                                         ESTR => sub { 
                                                       $opts = "-ab $bitrate.k -ar $freq -ac $channels" if $defopts == 1;
                                                       $opts = '' if $defopts == 0;
-                                                      "$eopts -y -i %i $opts %o" 
+                                                      "$eopts -y -i %i $opts -strict experimental %o" 
                                                     },
                                         
                                         PROMPT => {
@@@@ -941,7 +941,7 @@@@ my $opts;
                 DECODER => {
                               faad => {
                                         NAME => "faad",
-                                        DSTR => sub { "$dopts -o %i %o" },
+                                        DSTR => sub { "$dopts -o %o %i" },
                                       },
                               
                             ffmpeg => {
@@@@ -964,8 +964,8 @@@@ my $opts;
 
        mp4  => {
 
-                DEFAULT_ENCODER => "faac",
-                DEFAULT_DECODER => "faad",
+                DEFAULT_ENCODER => "ffmpeg",
+                DEFAULT_DECODER => "ffmpeg",
                 
                 ENCODER => {
                 
@@@@ -984,7 +984,7 @@@@ my $opts;
                                       ESTR => sub { 
                                                     $opts = "-ab $bitrate.k -ar $freq -ac $channels" if $defopts == 1;
                                                     $opts = '' if $defopts == 0;
-                                                    "$eopts -y -i %i $opts %o" 
+                                                    "$eopts -y -i %i $opts -strict experimental %o" 
                                                   },
                                       
                                       PROMPT => {
@@@@ -1022,8 +1022,8 @@@@ my $opts;
 
        m4a  => {
 
-                DEFAULT_ENCODER => "faac",
-                DEFAULT_DECODER => "faad",
+                DEFAULT_ENCODER => "ffmpeg",
+                DEFAULT_DECODER => "ffmpeg",
                 
                 ENCODER => {
                   
@@@@ -1042,7 +1042,7 @@@@ my $opts;
                                       ESTR => sub { 
                                                     $opts = "-ab $bitrate.k -ar $freq -ac $channels" if $defopts == 1;
                                                     $opts = '' if $defopts == 0;
-                                                    "$eopts -y -i %i $opts %o" 
+                                                    "$eopts -y -i %i $opts -strict experimental %o" 
                                                   },
                                       
                                       PROMPT => {
@@@@ -1084,7 +1084,7 @@@@ my $opts;
        m4b  => {
        
                 DEFAULT_ENCODER => "faac",
-                DEFAULT_DECODER => "faad",
+                DEFAULT_DECODER => "mplayer",
                 
                 ENCODER => {
                            
@@@@ -1124,13 +1124,13 @@@@ my $opts;
                              
        mpc  => {
 
-                DEFAULT_ENCODER => "mppenc",
-                DEFAULT_DECODER => "mppdec",
+                DEFAULT_ENCODER => "mpcenc",
+                DEFAULT_DECODER => "mpcdec",
                 
                 ENCODER => {
 
-                            mppenc => {
-                                        NAME => "mppenc",
+                            mpcenc => {
+                                        NAME => "mpcenc",
                                         ESTR => sub { 
                                                       $opts = "--$mpcqual" if $defopts == 1;
                                                       $opts = '' if $defopts == 0;
@@@@ -1142,8 +1142,8 @@@@ my $opts;
                 
                 DECODER => {
 
-                            mppdec => {
-                                        NAME => "mppdec",
+                            mpcdec => {
+                                        NAME => "mpcdec",
                                         DSTR => sub { "$dopts %i %o" },
                                       },
 
@@@@ -1166,13 +1166,13 @@@@ my $opts;
 
        mpp  => {
 
-                DEFAULT_ENCODER => "mppenc",
-                DEFAULT_DECODER => "mppdec",
+                DEFAULT_ENCODER => "mpcenc",
+                DEFAULT_DECODER => "mpcdec",
                 
                 ENCODER => {
 
-                            mppenc => {
-                                        NAME => "mppenc",
+                            mpcenc => {
+                                        NAME => "mpcenc",
                                         ESTR => sub { 
                                                       $opts = "--$mpcqual" if $defopts == 1;
                                                       $opts = '' if $defopts == 0;
@@@@ -1184,8 +1184,8 @@@@ my $opts;
                 
                 DECODER => {
 
-                            mppdec => {
-                                        NAME => "mppdec",
+                            mpcdec => {
+                                        NAME => "mpcdec",
                                         DSTR => sub { "$dopts %i %o" },
                                       },
 
@@@@ -1401,7 +1401,7 @@@@ my $opts;
        wv   => {
 
                 DEFAULT_ENCODER => "wavpack",
-                DEFAULT_DECODER => "wvunpack",
+                DEFAULT_DECODER => "ffmpeg",
                 
                 ENCODER => {
                               wavpack => {
@@@@ -2050,7 +2050,7 @@@@ sub format_tags {
      
                 $tag_name{track} = 0 if not $tag_name{track};
                 $tag_name{year}  = 0 if not $tag_name{year};
-                return "-title \"$tag_name{title}\" -track \"$tag_name{track}\" -author \"$tag_name{artist}\" -album \"$tag_name{album}\" -comment \"$tag_name{comment}\" -year \"$tag_name{year}\" -genre \"$tag_name{genre}\"";
+                return "-metadata title=\"$tag_name{title}\" -metadata track=\"$tag_name{track}\" -metadata author=\"$tag_name{artist}\" -metadata album=\"$tag_name{album}\" -metadata comment=\"$tag_name{comment}\" -metadata year=\"$tag_name{year}\" -metadata genre=\"$tag_name{genre}\"";
 
             } else {
                 
@@@@ -2878,7 +2878,7 @@@@ to turn off default encoder options use --defopts 0. t
 more control when using the --eopts command.
 
 defopts is set to 1 by default.  you can also toggle this option in
-/etc/pacpl/pacpl.conf.
+${SYSCONFDIR}/pacpl/pacpl.conf.
 
 B<--eopts> I<options>
 
@@@@ -3217,9 +3217,9 @@@@ show cddb information for current disc.
 
 =item B<sox>(1) B<ffmpeg>(1) B<lame>(1) B<oggenc>(1) B<oggdec>(1)
 
-=item B<flac>(1) B<shorten>(1) B<faac>(1) B<faad>(1) B<mppenc>(1)
+=item B<flac>(1) B<shorten>(1) B<faac>(1) B<faad>(1) B<mpcenc>(1)
 
-=item B<mppdec>(1) B<mplayer>(1) B<speexenc>(1) B<speexdec>(1)
+=item B<mpcdec>(1) B<mplayer>(1) B<speexenc>(1) B<speexdec>(1)
 
 =item B<sndfile-convert>(1) B<normalize>(1) B<cdparanoia>(1)
 
@


1.5
log
@- Remove the dependency on mpg321. pacpl does not even have
  support to use mpg321 in any way.
  - Switch AAC/FLAC decoding and FLAC encoding to using FFmpeg
    and eliminates the run-time dependencies on the faad/flac ports.
    - Switch WavPack decoding to FFmpeg.

    reset maintainer per andreas' request
    from brad
@
text
@d1 3
a3 3
$OpenBSD: patch-pacpl,v 1.4 2012/05/25 13:46:08 shadchin Exp $
--- pacpl.orig	Sat Feb 14 12:04:50 2009
+++ pacpl	Fri May 25 05:43:14 2012
d15 18
d189 1
a189 1
@@@@ -2050,11 +2050,11 @@@@ sub format_tags {
d198 8
a205 2
-              return "--title \"$tag_name{title}\" --track \"$tag_name{track}\" --artist \"$tag_name{artist}\" --ablum \"$tag_name{album}\" --comment \"$tag_name{comment}\" --year \"$tag_name{year}\" --genre \"$tag_name{genre}\"";
+              return "--title \"$tag_name{title}\" --track \"$tag_name{track}\" --artist \"$tag_name{artist}\" --album \"$tag_name{album}\" --comment \"$tag_name{comment}\" --year \"$tag_name{year}\" --genre \"$tag_name{genre}\"";
a206 2
               }
         } 
@


1.4
log
@Switch pacpl on musepack, pointed out by naddy@@
@
text
@d1 3
a3 3
$OpenBSD: patch-pacpl,v 1.3 2012/04/28 09:02:36 sthen Exp $
--- pacpl.orig	Sat Feb 14 22:04:50 2009
+++ pacpl	Fri May 25 09:46:10 2012
d15 12
a26 1
@@@@ -908,7 +908,7 @@@@ my $opts;
d31 1
d33 1
a33 1
                 DEFAULT_DECODER => "faad",
d36 1
d55 1
a55 1
@@@@ -964,7 +964,7 @@@@ my $opts;
d60 1
d62 1
a62 1
                 DEFAULT_DECODER => "faad",
d65 1
d75 1
a75 1
@@@@ -1022,7 +1022,7 @@@@ my $opts;
d80 1
d82 1
a82 1
                 DEFAULT_DECODER => "faad",
d85 1
d95 9
d162 9
d185 12
@


1.3
log
@Update pacpl to 4.0.4 and switch to FFmpeg for AC3 encoding. From Brad,
ok with maintainer "if it works for you".

- also fix AC3 decoding, which was broken in the old version too (and found
while testing the above changes), from me.
@
text
@d1 3
a3 3
$OpenBSD: patch-pacpl,v 1.2 2008/12/23 15:52:42 ajacoutot Exp $
--- pacpl.orig	Sat Feb 14 17:04:50 2009
+++ pacpl	Sat Apr 28 09:59:59 2012
d78 58
@


1.2
log
@- update pacpl to version 4.0.3

from Andreas Bihlmaier (maintainer) with some tweaks.
@
text
@d1 5
a5 4
$OpenBSD$
--- pacpl.orig	Sun Aug 17 05:31:57 2008
+++ pacpl	Fri Nov 14 09:25:49 2008
@@@@ -131,8 +131,12 @@@@ my %config = (
d8 1
a8 1
 my $conf_path = "/etc/pacpl";
d10 1
a12 4
+my $language  = "en";
+if ($ENV{LANG}) {
+	$language = "$ENV{LANG}";
+}
d15 1
d17 75
a91 9
@@@@ -203,7 +207,7 @@@@ sub load_codecs {
 # load po file and store in %lang hash
 sub load_lang {
 
-    my $po = "$po_dir/$ENV{LANG}.po";
+    my $po = "$po_dir/$language.po";
        $po =~ s/\.UTF-8//i      if $po =~ /UTF-8/i; 
        $po =~ s/\.utf8//i       if $po =~ /utf8/i;  
        $po =~ s/_\w+//          if not -e $po;      
@


1.1
log
@Initial revision
@
text
@d2 25
a26 51
--- pacpl.orig	Sun Oct 29 17:04:27 2006
+++ pacpl	Sun Dec 10 22:13:32 2006
@@@@ -29,7 +29,7 @@@@ use File::Copy;
 use File::Basename;
 use Ogg::Vorbis::Header; 
 
-use Cwd 'abs_path';
+use Cwd qw(abs_path getcwd);
 
 # Current Name & Version
 my $name     = "Perl Audio Converter";
@@@@ -224,7 +224,7 @@@@ my @@conf_opts;
 # Location of configuration file (Check Global, and then Current Directory)
 my $conf_path     = "/etc/pacpl";
 my $conf_global   = "$conf_path/pacpl.conf";
-my $conf_pwd      = "$ENV{'PWD'}/pacpl.conf";
+my $conf_pwd      = getcwd()."/pacpl.conf";
 
 my $conf_file = $conf_global;
    $conf_file = $conf_pwd if not -e $conf_global;
@@@@ -2147,8 +2147,9 @@@@ if (@@file) {
          }
                 
        if ($koutdir eq '1' and $gui and not $get_out_directory and not $out_dir) { 
- 
-           $out_dir = `$kdialog --title \"$name - $version - $lang{$mylang}{file_destination}\" --getexistingdirectory $ENV{'PWD'}`; 
+
+           my $cmd = "$kdialog --title \"$name - $version - $lang{$mylang}{file_destination}\" --getexistingdirectory ".getcwd(); 
+           $out_dir = `$cmd`;
            chomp($out_dir); 
     
            $get_out_directory = 1;   
@@@@ -2241,7 +2242,7 @@@@ if ($recursive and not $conv_to and not 
          
   } else {
                                       
-    my $pwd = $ENV{PWD};
+    my $pwd = getcwd();
 
        foreach my $audio_dir (@@dir) {
 
@@@@ -2273,7 +2274,8 @@@@ if ($recursive and not $conv_to and not 
      
      if ($gui and not $get_out_directory and $koutdir eq 1 and not $out_dir) {
 
-         $out_dir = `$kdialog --title \"PAC $version - $lang{$mylang}{file_destination}\" --getexistingdirectory $ENV{'PWD'}`;
+         my $cmd = "$kdialog --title \"PAC $version - $lang{$mylang}{file_destination}\" --getexistingdirectory ".getcwd();
+         $out_dir = `$cmd`;
          chomp($out_dir);
 
          $get_out_directory = 1;
@


1.1.1.1
log
@import pacpl 3.2.5

Perl Audio Converter is a tool for converting multiple audio types
from one format to another. See DESCR for supported formats.
It also has konqueror and amarok plugins.

based on submission by Andreas Bihlmaier <andreas.bihlmaier at gmx.de>
also tested by dassow@@
@
text
@@
