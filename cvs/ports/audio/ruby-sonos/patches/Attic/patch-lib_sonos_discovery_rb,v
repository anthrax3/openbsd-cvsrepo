head	1.3;
access;
symbols
	jasper_20141801:1.1.1.1 jasper:1.1.1;
locks; strict;
comment	@# @;


1.3
date	2014.02.04.16.23.47;	author jasper;	state dead;
branches;
next	1.2;

1.2
date	2014.01.22.20.39.04;	author jeremy;	state Exp;
branches;
next	1.1;

1.1
date	2014.01.18.09.32.32;	author jasper;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2014.01.18.09.32.32;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.3
log
@- update to sonos-0.3.5
* includes various new features (such as adding spotify tracks by yours truly)
@
text
@$OpenBSD: patch-lib_sonos_discovery_rb,v 1.2 2014/01/22 20:39:04 jeremy Exp $

IP_MULTICAST_TTL socket option on OpenBSD currently doesn't accept
int, only unsigned char.

--- lib/sonos/discovery.rb.orig	Wed Dec 31 16:00:00 1969
+++ lib/sonos/discovery.rb	Wed Jan 22 10:20:28 2014
@@@@ -75,7 +75,7 @@@@ module Sonos
       @@socket = UDPSocket.open
 
       # We're going to use IP with the multicast TTL. Mystery third parameter is a mystery.
-      @@socket.setsockopt(Socket::IPPROTO_IP, Socket::IP_MULTICAST_TTL, 2)
+      @@socket.setsockopt(Socket::Option.new(:INET, :IPPROTO_IP, :IP_MULTICAST_TTL, 2.chr))
     end
 
     def search_message
@


1.2
log
@Fix patch to set IP_MULTICAST_TTL socket option correctly.

OK jasper@@
@
text
@d1 1
a1 1
$OpenBSD: patch-lib_sonos_discovery_rb,v 1.1.1.1 2014/01/18 09:32:32 jasper Exp $
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
$OpenBSD$
d3 2
a4 2
XXX: emulate Linux' multicast TTL until either ruby or the kernel are
fixed to deal with unsigned char options, or to accept int options.
d6 2
a7 2
--- lib/sonos/discovery.rb.orig	Fri Jan 17 15:09:37 2014
+++ lib/sonos/discovery.rb	Fri Jan 17 15:09:45 2014
d13 1
a13 1
+      @@socket.setsockopt(Socket::IPPROTO_IP, 33, 2)
@


1.1.1.1
log
@import ruby-sonos

ruby-sonos allows controlling Sonos speakers with Ruby.

ok aja@@
@
text
@@
