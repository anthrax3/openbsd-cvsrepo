head	1.2;
access;
symbols
	OPENBSD_4_7:1.1.0.4
	OPENBSD_4_7_BASE:1.1
	OPENBSD_4_6:1.1.0.2;
locks; strict;
comment	@# @;


1.2
date	2010.06.03.15.48.36;	author naddy;	state dead;
branches;
next	1.1;

1.1
date	2009.11.24.21.43.14;	author naddy;	state Exp;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2010.01.02.23.12.35;	author william;	state Exp;
branches;
next	;


desc
@@


1.2
log
@update to 1.3.1; with and ok pea@@
@
text
@$OpenBSD: patch-lib_backends_h,v 1.1 2009/11/24 21:43:14 naddy Exp $
--- lib/backends.h.orig	Tue Nov 24 22:00:01 2009
+++ lib/backends.h	Tue Nov 24 22:00:01 2009
@@@@ -109,6 +109,7 @@@@ typedef struct vorbis_info_residue0{
   /* first stage (lossless partitioning) */
   int    grouping;         /* group n vectors per partition */
   int    partitions;       /* possible codebooks for a partition */
+  int    partvals;         /* partitions ^ groupbook dim */
   int    groupbook;        /* huffbook for partitioning */
   int    secondstages[64]; /* expanded out to pointers in lookup */
   int    booklist[512];    /* list of second stage books */
@


1.1
log
@SECURITY:
Fix handling of malformed Vorbis streams that would crash libvorbis.
CVE-2008-1420 (improved), CVE-2009-3379.  From xiph.org SVN.
@
text
@d1 1
a1 1
$OpenBSD$
@


1.1.2.1
log
@SECURITY FIX

Resolves:

CVE-2008-1419
CVE-2008-1420
CVE-2008-1423
CVE-2009-2663
CVE-2009-3379
and adds upstream-r14811_huffman_sanity_checks

from ubuntu via naddy@@, thanks

help and ok jasper@@
@
text
@d2 5
a6 7

Eliminate possibility of booklist overflow in res0/1/2 unpacking.


--- lib/backends.h.orig	Mon Jul 23 20:09:47 2007
+++ lib/backends.h	Thu Dec 17 21:52:31 2009
@@@@ -111,7 +111,7 @@@@ typedef struct vorbis_info_residue0{
d8 1
d11 1
a11 5
-  int    booklist[256];    /* list of second stage books */
+  int    booklist[512];    /* list of second stage books */
 
   float  classmetric1[64];  
   float  classmetric2[64];  
@

