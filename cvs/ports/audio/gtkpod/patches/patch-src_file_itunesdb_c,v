head	1.7;
access;
symbols
	OPENBSD_6_1:1.7.0.12
	OPENBSD_6_1_BASE:1.7
	OPENBSD_6_0:1.7.0.10
	OPENBSD_6_0_BASE:1.7
	OPENBSD_5_9:1.7.0.6
	OPENBSD_5_9_BASE:1.7
	OPENBSD_5_8:1.7.0.8
	OPENBSD_5_8_BASE:1.7
	OPENBSD_5_7:1.7.0.4
	OPENBSD_5_7_BASE:1.7
	OPENBSD_5_6:1.7.0.2
	OPENBSD_5_6_BASE:1.7
	OPENBSD_5_5:1.6.0.10
	OPENBSD_5_5_BASE:1.6
	OPENBSD_5_4:1.6.0.8
	OPENBSD_5_4_BASE:1.6
	OPENBSD_5_3:1.6.0.6
	OPENBSD_5_3_BASE:1.6
	OPENBSD_5_2:1.6.0.4
	OPENBSD_5_2_BASE:1.6
	OPENBSD_5_1_BASE:1.6
	OPENBSD_5_1:1.6.0.2
	OPENBSD_5_0:1.5.0.10
	OPENBSD_5_0_BASE:1.5
	OPENBSD_4_9:1.5.0.8
	OPENBSD_4_9_BASE:1.5
	OPENBSD_4_8:1.5.0.6
	OPENBSD_4_8_BASE:1.5
	OPENBSD_4_7:1.5.0.4
	OPENBSD_4_7_BASE:1.5
	OPENBSD_4_6:1.5.0.2
	OPENBSD_4_6_BASE:1.5
	OPENBSD_4_5:1.4.0.6
	OPENBSD_4_5_BASE:1.4
	OPENBSD_4_4:1.4.0.4
	OPENBSD_4_4_BASE:1.4
	OPENBSD_4_3:1.4.0.2
	OPENBSD_4_3_BASE:1.4
	OPENBSD_4_2:1.2.0.2
	OPENBSD_4_2_BASE:1.2
	OPENBSD_4_1:1.1.0.2
	OPENBSD_4_1_BASE:1.1;
locks; strict;
comment	@# @;


1.7
date	2014.07.14.07.49.54;	author espie;	state Exp;
branches;
next	1.6;
commitid	3hHhjYZkbfB6MNXv;

1.6
date	2011.10.18.18.57.15;	author sthen;	state Exp;
branches;
next	1.5;

1.5
date	2009.03.06.20.44.24;	author ckuethe;	state Exp;
branches;
next	1.4;

1.4
date	2007.12.31.18.35.42;	author ckuethe;	state Exp;
branches;
next	1.3;

1.3
date	2007.11.22.22.46.42;	author ckuethe;	state Exp;
branches;
next	1.2;

1.2
date	2007.03.17.21.55.40;	author ckuethe;	state Exp;
branches;
next	1.1;

1.1
date	2006.10.15.22.44.35;	author ckuethe;	state Exp;
branches;
next	;


desc
@@


1.7
log
@one case where endian.h helps! reroll patch, remove #ifdef OpenBSD
@
text
@$OpenBSD: patch-src_file_itunesdb_c,v 1.6 2011/10/18 18:57:15 sthen Exp $
--- src/file_itunesdb.c.orig	Mon Jul  5 23:18:23 2010
+++ src/file_itunesdb.c	Mon Jul 14 09:48:32 2014
@@@@ -909,8 +909,11 @@@@ iTunesDB *gp_load_ipod (iTunesDB *itdb)
 			ok_to_load = FALSE;
 		}
     }
-    g_free (itunesdb);
-    g_free (mountpoint);
+    else
+    {
+      g_free (itunesdb);
+      g_free (mountpoint);
+    }
 
     if (ok_to_load)
     {
@


1.6
log
@remove casts no longer needed now that system headers define NULL as a pointer.
reads ok to ckuethe@@ (maintainer)
@
text
@d1 4
a4 4
$OpenBSD: patch-src_file_itunesdb_c,v 1.5 2009/03/06 20:44:24 ckuethe Exp $
--- src/file_itunesdb.c.orig	Sat Jan 17 22:52:32 2009
+++ src/file_itunesdb.c	Thu Feb 26 23:12:27 2009
@@@@ -905,8 +905,11 @@@@ iTunesDB *gp_load_ipod (iTunesDB *itdb)
@


1.5
log
@update to gtkpod. now support fun things like lyrics and video thumbnails
@
text
@d1 1
a1 1
$OpenBSD$
a3 89
@@@@ -585,7 +585,7 @@@@ iTunesDB *gp_import_itdb (iTunesDB *old_itdb, const gi
     gp_itdb_add_extra_full (itdb);
 
     eitdb = itdb->userdata;
-    g_return_val_if_fail (eitdb, (release_widgets(), NULL));
+    g_return_val_if_fail (eitdb, (release_widgets(), (iTunesDB *)NULL));
 
     eitdb->offline = offline;
 
@@@@ -610,9 +610,9 @@@@ iTunesDB *gp_import_itdb (iTunesDB *old_itdb, const gi
 	Track *track = gl->data;
    
 	ExtraTrackData *etr;
-	g_return_val_if_fail (track, (release_widgets(), NULL));
+	g_return_val_if_fail (track, (release_widgets(), (iTunesDB *)NULL));
 	etr = track->userdata;
-	g_return_val_if_fail (etr, (release_widgets(), NULL));
+	g_return_val_if_fail (etr, (release_widgets(), (iTunesDB *)NULL));
 	fill_in_extended_info (track, total, num);
 	gp_track_validate_entries (track);
 	/* properly set value for has_artwork */
@@@@ -652,7 +652,7 @@@@ iTunesDB *gp_import_itdb (iTunesDB *old_itdb, const gi
     while (extendeddeletion)
     {
 	Track *track = extendeddeletion->data;
-	g_return_val_if_fail (track, (release_widgets(), NULL));
+	g_return_val_if_fail (track, (release_widgets(), (iTunesDB *)NULL));
 	mark_track_for_deletion (itdb, track);
 	extendeddeletion = g_list_delete_link (extendeddeletion,
 					       extendeddeletion);
@@@@ -676,15 +676,15 @@@@ iTunesDB *gp_import_itdb (iTunesDB *old_itdb, const gi
 	GHashTable *track_hash = g_hash_table_new (g_direct_hash,
 						   g_direct_equal);
 	Playlist *mpl = itdb_playlist_mpl (itdb);
-	g_return_val_if_fail (mpl, (release_widgets(), NULL));
-	g_return_val_if_fail (old_eitdb, (release_widgets(), NULL));
+	g_return_val_if_fail (mpl, (release_widgets(), (iTunesDB *)NULL));
+	g_return_val_if_fail (old_eitdb, (release_widgets(), (iTunesDB *)NULL));
 
 	/* add tracks from @@old_itdb to new itdb */
 	for (gl=old_itdb->tracks; gl; gl=gl->next)
 	{
 	    Track *duptr, *addtr;
 	    Track *track = gl->data;
-	    g_return_val_if_fail (track, (release_widgets(), NULL));
+	    g_return_val_if_fail (track, (release_widgets(), (iTunesDB *)NULL));
 	    duptr = itdb_track_duplicate (track);
 	    /* add to database -- if duplicate detection is on and the
 	       same track already exists in the database, the already
@@@@ -703,15 +703,15 @@@@ iTunesDB *gp_import_itdb (iTunesDB *old_itdb, const gi
 	    GList *glm;
 	    Playlist *duppl;
 	    Playlist *pl = gl->next->data; /* skip MPL */
-	    g_return_val_if_fail (pl, (release_widgets(), NULL));
+	    g_return_val_if_fail (pl, (release_widgets(), (iTunesDB *)NULL));
 	    duppl = itdb_playlist_duplicate (pl);
 	    /* switch members */
 	    for (glm=duppl->members; glm; glm=glm->next)
 	    {
 		Track *newtr;
-		g_return_val_if_fail (glm->data, (release_widgets(), NULL));
+		g_return_val_if_fail (glm->data, (release_widgets(), (iTunesDB *)NULL));
 		newtr = g_hash_table_lookup (track_hash, glm->data);
-		g_return_val_if_fail (newtr, (release_widgets(), NULL));
+		g_return_val_if_fail (newtr, (release_widgets(), (iTunesDB *)NULL));
 		glm->data = newtr;
 	    }
 	    /* if it's the podcasts list, don't add the list again if
@@@@ -722,7 +722,7 @@@@ iTunesDB *gp_import_itdb (iTunesDB *old_itdb, const gi
 		Playlist *podcasts = itdb_playlist_podcasts (itdb);
 		for (glm=duppl->members; glm; glm=glm->next)
 		{
-		    g_return_val_if_fail (glm->data, (release_widgets(), NULL));
+		    g_return_val_if_fail (glm->data, (release_widgets(), (iTunesDB *)NULL));
 		    itdb_playlist_add_track (podcasts, glm->data, -1);
 		}
 		itdb_playlist_free (duppl);
@@@@ -801,9 +801,9 @@@@ static iTunesDB *gp_merge_itdb (iTunesDB *old_itdb)
     ExtraiTunesDBData *old_eitdb;
     iTunesDB *new_itdb;
 
-    g_return_val_if_fail (old_itdb, NULL);
+    g_return_val_if_fail (old_itdb, (iTunesDB *)NULL);
     old_eitdb = old_itdb->userdata;
-    g_return_val_if_fail (old_eitdb, NULL);
+    g_return_val_if_fail (old_eitdb, (iTunesDB *)NULL);
 
     if (old_itdb->usertype & GP_ITDB_TYPE_LOCAL)
     {
@


1.4
log
@Update to the latest gtkpod. Crash fix from Ian Darwin.
Suggestions and oks from okan and bernd.
@
text
@d1 4
a4 4
$OpenBSD: patch-src_file_itunesdb_c,v 1.3 2007/11/22 22:46:42 ckuethe Exp $
--- src/file_itunesdb.c.orig	Wed Jun 27 13:29:33 2007
+++ src/file_itunesdb.c	Sun Nov 18 11:19:49 2007
@@@@ -563,7 +563,7 @@@@ iTunesDB *gp_import_itdb (iTunesDB *old_itdb, const gi
d13 1
a13 1
@@@@ -588,9 +588,9 @@@@ iTunesDB *gp_import_itdb (iTunesDB *old_itdb, const gi
d25 1
a25 1
@@@@ -630,7 +630,7 @@@@ iTunesDB *gp_import_itdb (iTunesDB *old_itdb, const gi
d34 1
a34 1
@@@@ -654,15 +654,15 @@@@ iTunesDB *gp_import_itdb (iTunesDB *old_itdb, const gi
d53 1
a53 1
@@@@ -681,15 +681,15 @@@@ iTunesDB *gp_import_itdb (iTunesDB *old_itdb, const gi
d72 1
a72 1
@@@@ -700,7 +700,7 @@@@ iTunesDB *gp_import_itdb (iTunesDB *old_itdb, const gi
d81 1
a81 1
@@@@ -779,9 +779,9 @@@@ iTunesDB *gp_merge_itdb (iTunesDB *old_itdb)
d93 3
a95 3
@@@@ -880,8 +880,11 @@@@ iTunesDB *gp_load_ipod (iTunesDB *itdb)
           ok_to_load = FALSE;
       }
d104 1
a104 1

@


1.3
log
@Update to gtkpod 0.99.10. New eyecandy, but the key feature is that it
works with apple's serial number silliness.
"it pulls up my shuffle just fine" okan@@
@
text
@d1 1
a1 1
$OpenBSD: patch-src_file_itunesdb_c,v 1.2 2007/03/17 21:55:40 ckuethe Exp $
d92 14
@


1.2
log
@Cope with libgpod update, and update my email address
ok sturm
@
text
@d1 4
a4 4
$OpenBSD: patch-src_file_itunesdb_c,v 1.1 2006/10/15 22:44:35 ckuethe Exp $
--- src/file_itunesdb.c.orig	Sun Jun 25 10:08:22 2006
+++ src/file_itunesdb.c	Thu Mar 15 08:49:17 2007
@@@@ -547,7 +547,7 @@@@ iTunesDB *gp_import_itdb (iTunesDB *old_
d13 1
a13 2
@@@@ -571,9 +571,9 @@@@ iTunesDB *gp_import_itdb (iTunesDB *old_
     {
d15 1
d25 1
a25 14
@@@@ -589,9 +589,9 @@@@ iTunesDB *gp_import_itdb (iTunesDB *old_
 		track->has_artwork = 0x02;
 	}
 
-	/* set unk208 to audio if unset (important only for iPod Video) */
-	if (track->unk208 == 0)
-	    track->unk208 = 0x00000001;
+	/* set mediatype to audio if unset (important only for iPod Video) */
+	if (track->mediatype == 0)
+	    track->mediatype = 0x00000001;
 	/* restore deleted thumbnails */
 	if ((track->artwork->thumbnails == NULL) &&
 	    (strlen (etr->thumb_path_locale) != 0))
@@@@ -609,7 +609,7 @@@@ iTunesDB *gp_import_itdb (iTunesDB *old_
d34 1
a34 1
@@@@ -632,15 +632,15 @@@@ iTunesDB *gp_import_itdb (iTunesDB *old_
d53 1
a53 1
@@@@ -659,15 +659,15 @@@@ iTunesDB *gp_import_itdb (iTunesDB *old_
d72 1
a72 1
@@@@ -678,7 +678,7 @@@@ iTunesDB *gp_import_itdb (iTunesDB *old_
d81 1
a81 1
@@@@ -740,9 +740,9 @@@@ iTunesDB *gp_merge_itdb (iTunesDB *old_i
@


1.1
log
@update to gtkpod 0.99.8. Prompted by fgsch, suggestions from Deanna Phillips.
ok mbalmer
@
text
@d1 3
a3 3
$OpenBSD$
--- src/file_itunesdb.c.orig	Tue Oct  3 11:45:05 2006
+++ src/file_itunesdb.c	Tue Oct  3 11:48:46 2006
d25 13
@

