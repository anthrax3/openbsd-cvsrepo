head	1.1;
access;
symbols
	OPENBSD_6_2:1.1.0.2
	OPENBSD_6_2_BASE:1.1;
locks; strict;
comment	@# @;


1.1
date	2017.06.09.15.09.51;	author dcoppa;	state Exp;
branches;
next	;
commitid	DKD7n5H8P40ztgwn;


desc
@@


1.1
log
@
Update to ncmpcpp-0.8
@
text
@$OpenBSD$

Older versions of boost::apply_visitor require a result_type member
for the visitor

Index: src/curses/strbuffer.h
--- src/curses/strbuffer.h.orig
+++ src/curses/strbuffer.h
@@@@ -29,6 +29,17 @@@@
 
 namespace NC {
 
+template <typename ResultType, typename Visitor>
+struct boost_visitor_adapter : Visitor {
+	using result_type = ResultType;
+	boost_visitor_adapter(Visitor &&v) : Visitor(std::move(v)) {}
+};
+
+template <typename ResultType = void, typename Visitor>
+auto to_boost_visitor(Visitor &&v) {
+	return boost_visitor_adapter<ResultType, Visitor>(std::move(v));
+}
+
 /// Buffer template class that stores text
 /// along with its properties (colors/formatting).
 template <typename CharT> class BasicBuffer
@@@@ -49,7 +60,7 @@@@ template <typename CharT> class BasicBuffer
 		template <typename OutputStreamT>
 		friend OutputStreamT &operator<<(OutputStreamT &os, const Property &p)
 		{
-			boost::apply_visitor([&os](const auto &v) { os << v; }, p.m_impl);
+			boost::apply_visitor(to_boost_visitor([&os](const auto &v) { os << v; }), p.m_impl);
 			return os;
 		}
 		
@
