head	1.2;
access;
symbols
	OPENBSD_6_2:1.2.0.2
	OPENBSD_6_2_BASE:1.2
	OPENBSD_6_1:1.1.0.20
	OPENBSD_6_1_BASE:1.1
	OPENBSD_6_0:1.1.0.18
	OPENBSD_6_0_BASE:1.1
	OPENBSD_5_9:1.1.0.14
	OPENBSD_5_9_BASE:1.1
	OPENBSD_5_8:1.1.0.16
	OPENBSD_5_8_BASE:1.1
	OPENBSD_5_7:1.1.0.12
	OPENBSD_5_7_BASE:1.1
	OPENBSD_5_6:1.1.0.10
	OPENBSD_5_6_BASE:1.1
	OPENBSD_5_5:1.1.0.8
	OPENBSD_5_5_BASE:1.1
	OPENBSD_5_4:1.1.0.6
	OPENBSD_5_4_BASE:1.1
	OPENBSD_5_3:1.1.0.4
	OPENBSD_5_3_BASE:1.1
	OPENBSD_5_2:1.1.0.2
	OPENBSD_5_2_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2017.04.14.08.24.03;	author ajacoutot;	state Exp;
branches;
next	1.1;
commitid	G9J8BNHacd8dGL0O;

1.1
date	2012.03.02.08.01.07;	author sthen;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Unbreak build with clang.
Drop the gettext MODULE and regen WANTLIB while here...
@
text
@$OpenBSD: patch-ldapvi_c,v 1.1 2012/03/02 08:01:07 sthen Exp $

rename getline to avoid future namespace collision, upstream git 256ced029c
remove pointless header which vim whines about
fix build with clang: 'copy_sasl_output' should return a value [-Wreturn-type]

--- ldapvi.c.orig	Sat May  5 12:17:26 2007
+++ ldapvi.c	Fri Apr 14 10:20:13 2017
@@@@ -470,7 +470,7 @@@@ change_mechanism(bind_options *bo)
 		bo->authmethod = LDAP_AUTH_SASL;
 		puts("Switching to SASL authentication.");
 	}
-	bo->sasl_mech = getline("SASL mechanism", bo->sasl_mech);
+	bo->sasl_mech = ldapvi_getline("SASL mechanism", bo->sasl_mech);
 }
 
 static int
@@@@ -1414,7 +1414,7 @@@@ write_file_header(FILE *s, cmdline *cmdline)
 	int nlines = 0;
 
 	if (print_binary_mode == PRINT_UTF8 && !cmdline->ldif) {
-		fputs("# -*- coding: utf-8 -*- vim:encoding=utf-8:\n", s);
+		fputs("# -*- coding: utf-8 -*-\n", s);
 		nlines++;
 	}
 	if (cmdline->ldif) {
@@@@ -1465,7 +1465,7 @@@@ copy_sasl_output(FILE *out, char *sasl)
 	int line = 0;
 	int c;
 
-	if (lstat(sasl, &st) == -1) return;
+	if (lstat(sasl, &st) == -1) return 0;
 	if ( !(in = fopen(sasl, "r"))) syserr();
 
 	if (st.st_size > 0) {
@


1.1
log
@Add various patches to ldapvi from upstream git/mailing list submissions:

- add -y support to read password from a file
- remove useless header that vim whines about
- preserve order of attribute values
- fix possible LP64 issue (improper sentinel)
- allow editors/pagers with arguments
- getline namespace collision, upstream git 256ced029c
- fix hash generation

OK ajacoutot@@
@
text
@d1 1
a1 1
$OpenBSD$
d5 1
d7 2
a8 2
--- ldapvi.c.orig	Sat May  5 11:17:26 2007
+++ ldapvi.c	Thu Mar  1 22:04:17 2012
d27 9
@

