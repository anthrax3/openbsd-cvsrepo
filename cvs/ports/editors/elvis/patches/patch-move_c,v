head	1.1;
access;
symbols
	OPENBSD_6_1:1.1.0.20
	OPENBSD_6_1_BASE:1.1
	OPENBSD_6_0:1.1.0.18
	OPENBSD_6_0_BASE:1.1
	OPENBSD_5_9:1.1.0.14
	OPENBSD_5_9_BASE:1.1
	OPENBSD_5_8:1.1.0.16
	OPENBSD_5_8_BASE:1.1
	OPENBSD_5_7:1.1.0.12
	OPENBSD_5_7_BASE:1.1
	OPENBSD_5_6:1.1.0.10
	OPENBSD_5_6_BASE:1.1
	OPENBSD_5_5:1.1.0.8
	OPENBSD_5_5_BASE:1.1
	OPENBSD_5_4:1.1.0.6
	OPENBSD_5_4_BASE:1.1
	OPENBSD_5_3:1.1.0.4
	OPENBSD_5_3_BASE:1.1
	OPENBSD_5_2:1.1.0.2
	OPENBSD_5_2_BASE:1.1;
locks; strict;
comment	@# @;


1.1
date	2012.05.05.14.03.15;	author sthen;	state Exp;
branches;
next	;


desc
@@


1.1
log
@Various patches to editors/elvis, mostly from Debian, via Donovan Watteau:

- add --docdir so that :help works
- add --verbose
- fix a bug in the ")" command that could cause a segfault
- fix a bug when lauching elvis in a directory containing a "tags" dir
- make file/syntax detection work for scripts using "env"
- add "return" to the list of shell script keywords
- fix a few things in the man pages (\-, typo, whitespace) since
we were already patching them.
@
text
@$OpenBSD$

From Debian:
  "Fix a bug in the ) vi command that could cause a segmentation
  fault (patch from elvis-almost-2.2.1)"

--- move.c.orig	Tue Oct 21 04:32:25 2003
+++ move.c	Sat May  5 13:53:51 2012
@@@@ -1620,6 +1620,7 @@@@ RESULT m_fsentence(win, vinf)
 	long	para;
 	long	offset;
 	long	count;
+	MARKBUF	tmp;
 
 	DEFAULT(1);
 
@@@@ -1651,6 +1652,7 @@@@ RESULT m_fsentence(win, vinf)
 	else
 	{
 		para = 0;
+		scanseek(&cp, marktmp(tmp, markbuffer(win->state->cursor), 0L));
 	}
 	marksetoffset(win->state->cursor, offset);
 	if (para == offset)
@
