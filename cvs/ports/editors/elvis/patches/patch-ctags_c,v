head	1.3;
access;
symbols
	OPENBSD_6_2:1.3.0.2
	OPENBSD_6_2_BASE:1.3
	OPENBSD_6_1:1.2.0.34
	OPENBSD_6_1_BASE:1.2
	OPENBSD_6_0:1.2.0.32
	OPENBSD_6_0_BASE:1.2
	OPENBSD_5_9:1.2.0.28
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.2.0.30
	OPENBSD_5_8_BASE:1.2
	OPENBSD_5_7:1.2.0.26
	OPENBSD_5_7_BASE:1.2
	OPENBSD_5_6:1.2.0.24
	OPENBSD_5_6_BASE:1.2
	OPENBSD_5_5:1.2.0.22
	OPENBSD_5_5_BASE:1.2
	OPENBSD_5_4:1.2.0.20
	OPENBSD_5_4_BASE:1.2
	OPENBSD_5_3:1.2.0.18
	OPENBSD_5_3_BASE:1.2
	OPENBSD_5_2:1.2.0.16
	OPENBSD_5_2_BASE:1.2
	OPENBSD_5_1_BASE:1.2
	OPENBSD_5_1:1.2.0.14
	OPENBSD_5_0:1.2.0.12
	OPENBSD_5_0_BASE:1.2
	OPENBSD_4_9:1.2.0.10
	OPENBSD_4_9_BASE:1.2
	OPENBSD_4_8:1.2.0.8
	OPENBSD_4_8_BASE:1.2
	OPENBSD_4_7:1.2.0.6
	OPENBSD_4_7_BASE:1.2
	OPENBSD_4_6:1.2.0.4
	OPENBSD_4_6_BASE:1.2
	OPENBSD_4_5:1.2.0.2
	OPENBSD_4_5_BASE:1.2
	OPENBSD_4_4:1.1.0.28
	OPENBSD_4_4_BASE:1.1
	OPENBSD_4_3:1.1.0.26
	OPENBSD_4_3_BASE:1.1
	OPENBSD_4_2:1.1.0.24
	OPENBSD_4_2_BASE:1.1
	OPENBSD_4_1:1.1.0.22
	OPENBSD_4_1_BASE:1.1
	OPENBSD_4_0:1.1.0.20
	OPENBSD_4_0_BASE:1.1
	OPENBSD_3_9:1.1.0.18
	OPENBSD_3_9_BASE:1.1
	OPENBSD_3_8:1.1.0.16
	OPENBSD_3_8_BASE:1.1
	OPENBSD_3_7:1.1.0.14
	OPENBSD_3_7_BASE:1.1
	OPENBSD_3_6:1.1.0.12
	OPENBSD_3_6_BASE:1.1
	OPENBSD_3_5:1.1.0.10
	OPENBSD_3_5_BASE:1.1
	OPENBSD_3_4:1.1.0.8
	OPENBSD_3_4_BASE:1.1
	OPENBSD_3_3:1.1.0.6
	OPENBSD_3_3_BASE:1.1
	OPENBSD_3_2:1.1.0.4
	OPENBSD_3_2_BASE:1.1
	OPENBSD_3_1:1.1.0.2
	OPENBSD_3_1_BASE:1.1;
locks; strict;
comment	@# @;


1.3
date	2017.04.17.21.43.15;	author sthen;	state Exp;
branches;
next	1.2;
commitid	vWuXWlzdHDDY4nRX;

1.2
date	2008.12.11.13.58.14;	author jasper;	state Exp;
branches;
next	1.1;

1.1
date	2002.02.20.19.31.43;	author naddy;	state Exp;
branches;
next	;


desc
@@


1.3
log
@Updates from Donovan Watteau, who takes maintainer. From Donovan's mail:

* Fix a startup crash that's extremely easy to trigger on OpenBSD
  (patch-draw_c).

* Various fixes from a forked Github version (there was no official
  elvis release since 2004), clang warns about most of them.

* Remove some questionable/broken/dangerous features: backtick
  support in filenames, WYSIWYG for nroff/tex files, and
  HTTP/FTP support.  Looking at the code, I'd feel better having
  less features, here.  Please complain if you really want them.

* Remove dead FTP mirrors from MASTER_SITES, and use an HTTP server
  instead.

* Remove some previous patches of mine which only dealt with
  whitespace in man pages: fixing that was just useless noise.
@
text
@$OpenBSD: patch-ctags_c,v 1.2 2008/12/11 13:58:14 jasper Exp $

getc() returns an int.

Prevent an endless loop:
https://github.com/mbert/elvis/commit/f0ca07a429d1

Fix a segmentation fault:
https://github.com/mbert/elvis/commit/8a42aebd91bd

--- ctags.c.orig	Tue Oct 21 04:32:25 2003
+++ ctags.c	Mon Apr 17 12:58:42 2017
@@@@ -241,7 +241,7 @@@@ int file_copyline(seek, fp, buf)
 {
 	long	oldseek;/* where the file's pointer was before we messed it up */
 	int	ch;	/* a single character from the file */
-	char	next;	/* the next character from this file */
+	int	next;	/* the next character from this file */
 	char	*build;	/* where to store the next character */
 
 	/* go to the start of the line */
@@@@ -640,9 +640,10 @@@@ int lex_gettoken()
 					 */
 					if (ch == '/')
 					{
-						while ((ch = cpp_getc()) != '\n')
+						do
 						{
-						}
+							ch = cpp_getc();
+						} while (ch != '\n' && ch != EOF);
 					}
 
 					/* the last name before a comma, '=', or
@@@@ -969,7 +970,7 @@@@ void maketag(scope, name, lnum, seek, number, kind, in
 				for (; scan && !strcmp(scan->TAGNAME,name); scan = next)
 				{
 					if (warn_duplicate)
-						printf("duplicate tag \"%s\" is typedef: keeping one from %s, not %ss\n", name, file_name, scan->TAGFILE);
+						printf("duplicate tag \"%s\" is typedef: keeping one from %s, not %s\n", name, file_name, scan->TAGFILE);
 
 					/* make any references to it point to
 					 * the next tag instead.
@@@@ -984,7 +985,10 @@@@ void maketag(scope, name, lnum, seek, number, kind, in
 							ref->bighop = scan->next;
 					}
 					if (taglist == scan)
+					{
 						taglist = scan->next;
+						next = taglist;
+					}
 
 					/* delete this one */
 					(void)tagfree(scan);
@


1.2
log
@- update elvis to 2.2.0
- be more specific about the license
- tweak DESCR

with a hint from matthieu@@
ok ajacoutot@@
@
text
@d1 12
a12 3
$OpenBSD: patch-ctags_c,v 1.1 2002/02/20 19:31:43 naddy Exp $
--- ctags.c.orig	Tue Dec  9 12:02:33 2008
+++ ctags.c	Tue Dec  9 12:04:16 2008
d22 33
@


1.1
log
@* getc() returns int
* md5 -> distinfo while we're here
@
text
@d1 4
a4 5
$OpenBSD$
--- ctags.c.orig	Wed Feb 20 20:20:35 2002
+++ ctags.c	Wed Feb 20 20:20:58 2002
@@@@ -220,8 +220,8 @@@@ int file_copyline(seek, fp, buf)
 	char	*buf;	/* line buffer, or NULL to write to fp */
d7 1
a7 1
-	char	ch;	/* a single character from the file */
a8 1
+	int	ch;	/* a single character from the file */
@

