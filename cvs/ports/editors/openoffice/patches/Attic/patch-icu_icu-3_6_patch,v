head	1.5;
access;
symbols
	OPENBSD_4_3:1.3.0.2
	OPENBSD_4_3_BASE:1.3
	OPENBSD_4_2:1.1.0.2
	OPENBSD_4_2_BASE:1.1;
locks; strict;
comment	@# @;


1.5
date	2008.05.05.15.18.29;	author robert;	state dead;
branches;
next	1.4;

1.4
date	2008.04.28.11.18.46;	author robert;	state Exp;
branches;
next	1.3;

1.3
date	2007.12.07.11.30.55;	author robert;	state Exp;
branches;
next	1.2;

1.2
date	2007.11.13.09.46.28;	author robert;	state Exp;
branches;
next	1.1;

1.1
date	2007.03.17.15.27.45;	author robert;	state Exp;
branches;
next	;


desc
@@


1.5
log
@use textproc/icu4c instead of the bundled one; bump PKGNAMEs
@
text
@$OpenBSD: patch-icu_icu-3_6_patch,v 1.4 2008/04/28 11:18:46 robert Exp $
--- icu/icu-3.6.patch.orig.port	Wed Apr 23 16:44:04 2008
+++ icu/icu-3.6.patch	Wed Apr 23 16:51:35 2008
@@@@ -1,5 +1,5 @@@@
 *** misc/icu/source/common/putil.c	Mon Jul 31 20:14:28 2006
---- misc/build/icu/source/common/putil.c	Mon Jan 28 21:31:50 2008
+--- misc/build/icu/source/common/putil.c	Wed Apr 23 16:40:00 2008
 ***************
 *** 48,54 ****
   #endif
@@@@ -19,7 +19,7 @@@@
   #endif
   
 *** misc/icu/source/common/unicode/pwin32.h	Tue Aug 29 23:34:38 2006
---- misc/build/icu/source/common/unicode/pwin32.h	Mon Jan 28 21:31:50 2008
+--- misc/build/icu/source/common/unicode/pwin32.h	Wed Apr 23 16:40:00 2008
 ***************
 *** 266,273 ****
 --- 266,278 ----
@@@@ -37,7 +37,7 @@@@
   /*===========================================================================*/
   /* Code alignment and C function inlining                                    */
 *** misc/icu/source/common/unicode/rbbi.h	Fri Aug 11 07:46:40 2006
---- misc/build/icu/source/common/unicode/rbbi.h	Mon Jan 28 21:31:50 2008
+--- misc/build/icu/source/common/unicode/rbbi.h	Wed Apr 23 16:40:00 2008
 ***************
 *** 611,622 ****
 --- 611,624 ----
@@@@ -56,7 +56,7 @@@@
         * Common initialization function, used by constructors and bufferClone.
         *   (Also used by DictionaryBasedBreakIterator::createBufferClone().)
 *** misc/icu/source/common/unicode/umachine.h	Tue Feb  7 02:54:16 2006
---- misc/build/icu/source/common/unicode/umachine.h	Mon Jan 28 21:31:50 2008
+--- misc/build/icu/source/common/unicode/umachine.h	Wed Apr 23 16:40:00 2008
 ***************
 *** 322,328 ****
    */
@@@@ -75,7 +75,7 @@@@
   #else
       typedef uint16_t UChar;
 *** misc/icu/source/common/unicode/unistr.h	Tue Aug 29 23:52:50 2006
---- misc/build/icu/source/common/unicode/unistr.h	Mon Jan 28 21:31:50 2008
+--- misc/build/icu/source/common/unicode/unistr.h	Wed Apr 23 16:40:00 2008
 ***************
 *** 3280,3286 ****
   //========================================
@@@@ -179,7 +179,7 @@@@
   }
   
 *** misc/icu/source/common/unicode/ustring.h	Tue Aug 29 23:52:50 2006
---- misc/build/icu/source/common/unicode/ustring.h	Mon Jan 28 21:31:50 2008
+--- misc/build/icu/source/common/unicode/ustring.h	Wed Apr 23 16:40:00 2008
 ***************
 *** 918,924 ****
    * </pre>
@@@@ -198,7 +198,7 @@@@
       /**@@stable ICU 2.0 */
   #   define U_STRING_INIT(var, cs, length)
 *** misc/icu/source/common/uvectr32.cpp	Wed Aug 27 03:01:30 2003
---- misc/build/icu/source/common/uvectr32.cpp	Mon Jan 28 21:31:51 2008
+--- misc/build/icu/source/common/uvectr32.cpp	Wed Apr 23 16:40:00 2008
 ***************
 *** 1,6 ****
   /*
@@@@ -306,7 +306,7 @@@@
   }
   
 *** misc/icu/source/common/uvectr32.h	Wed Jan 18 04:52:04 2006
---- misc/build/icu/source/common/uvectr32.h	Mon Jan 28 21:31:51 2008
+--- misc/build/icu/source/common/uvectr32.h	Wed Apr 23 16:40:00 2008
 ***************
 *** 1,6 ****
   /*
@@@@ -370,7 +370,7 @@@@
       count += size;
       return rp;
 *** misc/icu/source/config/mh-darwin	Wed Feb  1 08:52:42 2006
---- misc/build/icu/source/config/mh-darwin	Mon Jan 28 21:31:51 2008
+--- misc/build/icu/source/config/mh-darwin	Wed Apr 23 16:40:00 2008
 ***************
 *** 25,31 ****
   SHLIB.cc=	$(CXX) -dynamiclib -dynamic $(CXXFLAGS) $(LDFLAGS)
@@@@ -389,7 +389,7 @@@@
   ## Compiler switch to embed a runtime search path
   LD_RPATH=
 *** misc/icu/source/config/mh-irix	Thu Mar 23 19:51:52 2006
---- misc/build/icu/source/config/mh-irix	Mon Jan 28 21:31:51 2008
+--- misc/build/icu/source/config/mh-irix	Wed Apr 23 16:40:00 2008
 ***************
 *** 23,28 ****
 --- 23,31 ----
@@@@ -403,7 +403,7 @@@@
   THREADSCPPFLAGS = -D_REENTRANT -D_PTHREADS
   LIBCPPFLAGS =
 *** misc/icu/source/config/mh-linux	Thu Mar 23 19:51:52 2006
---- misc/build/icu/source/config/mh-linux	Mon Jan 28 21:31:51 2008
+--- misc/build/icu/source/config/mh-linux	Wed Apr 23 16:40:00 2008
 ***************
 *** 20,25 ****
 --- 20,33 ----
@@@@ -422,7 +422,7 @@@@
   LDFLAGSICUDT=-nodefaultlibs -nostdlib
   
 *** misc/icu/source/config/mh-mingw	Tue Aug 15 10:24:14 2006
---- misc/build/icu/source/config/mh-mingw	Mon Jan 28 21:31:51 2008
+--- misc/build/icu/source/config/mh-mingw	Wed Apr 23 16:40:00 2008
 ***************
 *** 54,59 ****
 --- 54,62 ----
@@@@ -453,9 +453,9 @@@@
   CURR_SRCCODE_FULL_DIR=$(subst /,\\\\,$(shell pwd -W))#M#
   
 *** misc/icu/source/config/mh-solaris	Fri Feb 24 20:31:14 2006
---- misc/build/icu/source/config/mh-solaris	Mon Jan 28 21:31:51 2008
+--- misc/build/icu/source/config/mh-solaris	Wed Apr 23 16:40:00 2008
 ***************
-*** 18,34 ****
+*** 18,33 ****
   
   ## Commands to link
   ## For Sun Workshop, use CC to link to bring in C++ runtime
@@@@ -472,8 +472,7 @@@@
   
   #LIBRARY_PATH_PREFIX=/usr/lib/lwp:
   
-  ## Compiler switch to embed a library name
---- 18,42 ----
+--- 18,41 ----
   
   ## Commands to link
   ## For Sun Workshop, use CC to link to bring in C++ runtime
@@@@ -488,19 +487,37 @@@@
   ## Compiler switch to embed a runtime search path
   LD_RPATH=	-R
   LD_RPATH_PRE=	
-  
++ 
 + ## Force RPATH=$ORIGIN to locate own dependencies w/o need for LD_LIBRARY_PATH
 + ENABLE_RPATH=YES
 + RPATHLDFLAGS=${LD_RPATH}'$$ORIGIN'
 + 
 + #SH#  ENABLE_RPATH=YES
 + #SH#  RPATHLDFLAGS="${LD_RPATH}'$$ORIGIN'"
-+ 
+  
   #LIBRARY_PATH_PREFIX=/usr/lib/lwp:
   
-  ## Compiler switch to embed a library name
+*** misc/icu/source/configure	Tue Aug 15 10:24:14 2006
+--- misc/build/icu/source/configure	Wed Apr 23 16:41:26 2008
+***************
+*** 4400,4406 ****
+  
+  GENCCODE_ASSEMBLY=
+  case "${host}" in
+! i*86-*-linux*|x86_64-*-linux*|powerpc*-*-linux*|i*86-*-*bsd*|i*86-*-solaris*)
+      if test "$GCC" = yes; then
+                  GENCCODE_ASSEMBLY="-a gcc"
+      fi ;;
+--- 4400,4406 ----
+  
+  GENCCODE_ASSEMBLY=
+  case "${host}" in
+! i*86-*-linux*|x86_64-*-linux*|powerpc*-*-linux*|i*86-*-solaris*)
+      if test "$GCC" = yes; then
+                  GENCCODE_ASSEMBLY="-a gcc"
+      fi ;;
 *** misc/icu/source/data/Makefile.in	Sat Aug 12 00:22:24 2006
---- misc/build/icu/source/data/Makefile.in	Mon Jan 28 21:31:51 2008
+--- misc/build/icu/source/data/Makefile.in	Wed Apr 23 16:40:00 2008
 ***************
 *** 344,350 ****
   ifneq ($(ICUDATA_SOURCE_IS_NATIVE_TARGET),YES)
@@@@ -519,7 +536,7 @@@@
   	@@echo "$@@" > $@@
   endif
 *** misc/icu/source/i18n/regexcmp.cpp	Thu Feb  2 05:37:14 2006
---- misc/build/icu/source/i18n/regexcmp.cpp	Mon Jan 28 21:31:51 2008
+--- misc/build/icu/source/i18n/regexcmp.cpp	Wed Apr 23 16:40:00 2008
 ***************
 *** 2,8 ****
   //
@@@@ -572,7 +589,7 @@@@
           break;
   
 *** misc/icu/source/i18n/rematch.cpp	Thu Aug 25 20:02:20 2005
---- misc/build/icu/source/i18n/rematch.cpp	Mon Jan 28 21:31:51 2008
+--- misc/build/icu/source/i18n/rematch.cpp	Wed Apr 23 16:40:00 2008
 ***************
 *** 6,12 ****
   //
@@@@ -697,7 +714,7 @@@@
           }
       }
 *** misc/icu/source/i18n/windtfmt.cpp	Tue Aug 15 08:48:02 2006
---- misc/build/icu/source/i18n/windtfmt.cpp	Mon Jan 28 21:31:51 2008
+--- misc/build/icu/source/i18n/windtfmt.cpp	Wed Apr 23 16:40:00 2008
 ***************
 *** 232,249 ****
       UChar stackBuffer[STACK_BUFFER_SIZE];
@@@@ -777,7 +794,7 @@@@
       if (buffer != stackBuffer) {
           DELETE_ARRAY(buffer);
 *** misc/icu/source/i18n/winnmfmt.cpp	Thu Aug 17 07:21:06 2006
---- misc/build/icu/source/i18n/winnmfmt.cpp	Mon Jan 28 21:31:51 2008
+--- misc/build/icu/source/i18n/winnmfmt.cpp	Wed Apr 23 16:40:00 2008
 ***************
 *** 86,95 ****
       GetLocaleInfoA(lcid, LOCALE_SGROUPING, buf, 10);
@@@@ -915,7 +932,7 @@@@
       if (buffer != stackBuffer) {
           DELETE_ARRAY(buffer);
 *** misc/icu/source/layout/CoverageTables.cpp	Sat May  8 01:28:42 2004
---- misc/build/icu/source/layout/CoverageTables.cpp	Mon Jan 28 21:31:51 2008
+--- misc/build/icu/source/layout/CoverageTables.cpp	Wed Apr 23 16:40:00 2008
 ***************
 *** 44,49 ****
 --- 44,53 ----
@@@@ -930,7 +947,7 @@@@
       le_uint16 probe = power;
       le_uint16 index = 0;
 *** misc/icu/source/layout/DeviceTables.cpp	Fri Jan 14 18:25:12 2005
---- misc/build/icu/source/layout/DeviceTables.cpp	Mon Jan 28 21:31:51 2008
+--- misc/build/icu/source/layout/DeviceTables.cpp	Wed Apr 23 16:40:00 2008
 ***************
 *** 22,28 ****
       le_uint16 format = SWAPW(deltaFormat) - 1;
@@@@ -950,7 +967,7 @@@@
           le_uint16 bits = fieldBits[format];
           le_uint16 count = 16 / bits;
 *** misc/icu/source/layout/GXLayoutEngine.cpp	Fri Sep  2 20:22:10 2005
---- misc/build/icu/source/layout/GXLayoutEngine.cpp	Mon Jan 28 21:31:51 2008
+--- misc/build/icu/source/layout/GXLayoutEngine.cpp	Wed Apr 23 16:40:00 2008
 ***************
 *** 39,45 ****
           return 0;
@@@@ -969,7 +986,7 @@@@
       if (LE_FAILURE(success)) {
           return 0;
 *** misc/icu/source/layout/IndicClassTables.cpp	Wed Aug 23 02:12:40 2006
---- misc/build/icu/source/layout/IndicClassTables.cpp	Mon Jan 28 21:31:51 2008
+--- misc/build/icu/source/layout/IndicClassTables.cpp	Wed Apr 23 16:40:00 2008
 ***************
 *** 94,100 ****
       _dr, _db, _db, _db, _db, _xx, _xx, _l1, _dl, _xx, _xx, _s1, _s2, _vr, _xx, _xx, // 09C0 - 09CF
@@@@ -988,14 +1005,14 @@@@
   
   static const IndicClassTable::CharClass punjCharClasses[] =
 ***************
-*** 120,125 ****
---- 120,138 ----
+*** 120,127 ****
+--- 120,140 ----
       _iv, _xx, _xx, _xx, _xx, _xx, _xx, _xx, _xx, _xx, _xx, _xx, _xx, _xx, _xx, _xx  // 0AE0 - 0AEF
   };
   
 + #if 1
-+ static const IndicClassTable::CharClass oryaCharClasses[] =
-+ {
+  static const IndicClassTable::CharClass oryaCharClasses[] =
+  {
 +     _xx, _ma, _mp, _mp, _xx, _iv, _iv, _iv, _iv, _iv, _iv, _iv, _iv, _xx, _xx, _iv, /* 0B00 - 0B0F */
 +     _iv, _xx, _xx, _iv, _iv, _bb, _bb, _bb, _bb, _bb, _bb, _bb, _bb, _bb, _ct, _bb, /* 0B10 - 0B1F */
 +     _bb, _bb, _bb, _bb, _bb, _bb, _bb, _bb, _bb, _xx, _bb, _bb, _bb, _bb, _bb, _pb, /* 0B20 - 0B2F */
@@@@ -1006,9 +1023,11 @@@@
 +     _xx, _bb                                                                        /* 0B70 - 0B71 */
 + };
 + #else
-  static const IndicClassTable::CharClass oryaCharClasses[] =
-  {
++ static const IndicClassTable::CharClass oryaCharClasses[] =
++ {
       _xx, _ma, _mp, _mp, _xx, _iv, _iv, _iv, _iv, _iv, _iv, _iv, _iv, _xx, _xx, _iv, // 0B00 - 0B0F
+      _iv, _xx, _xx, _iv, _iv, _ct, _ct, _ct, _ct, _ct, _ct, _ct, _ct, _ct, _ct, _ct, // 0B10 - 0B1F
+      _ct, _ct, _ct, _ct, _bb, _ct, _ct, _ct, _bb, _xx, _ct, _ct, _bb, _bb, _bb, _pb, // 0B20 - 0B2F
 ***************
 *** 131,136 ****
 --- 144,150 ----
@@@@ -1103,7 +1122,7 @@@@
   //
   // IndicClassTable addresses
 *** misc/icu/source/layout/IndicReordering.cpp	Tue Apr 25 21:08:12 2006
---- misc/build/icu/source/layout/IndicReordering.cpp	Mon Jan 28 21:31:51 2008
+--- misc/build/icu/source/layout/IndicReordering.cpp	Wed Apr 23 16:40:00 2008
 ***************
 *** 50,55 ****
 --- 50,63 ----
@@@@ -1185,11 +1204,13 @@@@
       {-1, -1, -1, -1, -1, -1,  3,  2, -1, -1, -1, -1, -1, -1, -1}, //  7 - consonant virama ZWJ, consonant ZWJ virama
       {-1,  6,  1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  4, -1}, //  8 - independent vowels that can take a virama
 ***************
-*** 629,634 ****
---- 651,670 ----
+*** 627,632 ****
+--- 649,668 ----
+              // write base consonant
+              for (i = baseConsonant; i < bcSpan; i += 1) {
                   output.writeChar(chars[i], i, tagArray4);
-              }
-  
++             }
++ 
 +             /* for the special conjuction of Cons+0x0d4d+0x0d31 or Cons+0x0d4d+0x0d30 of Malayalam */
 +             if ((baseConsonant - 2 >= 0) &&
 +                 (chars[baseConsonant - 1] == 0x0d4d) &&
@@@@ -1202,13 +1223,11 @@@@
 + 
 + 		if (mpreFixups)
 + 			mpreFixups->reduce();
-+             }
-+ 
+              }
+  
               if ((classTable->scriptFlags & SF_MATRAS_AFTER_BASE) != 0) {
-                  output.writeMbelow();
-                  output.writeSMbelow(); // FIXME: there are no SMs in these scripts...
 *** misc/icu/source/layout/LESwaps.h	Thu Jun 23 00:39:36 2005
---- misc/build/icu/source/layout/LESwaps.h	Mon Jan 28 21:31:51 2008
+--- misc/build/icu/source/layout/LESwaps.h	Wed Apr 23 16:40:00 2008
 ***************
 *** 2,7 ****
 --- 2,8 ----
@@@@ -1256,11 +1275,12 @@@@
       #if U_IS_BIG_ENDIAN
           #define SWAPW(value) (value)
 ***************
-*** 49,54 ****
---- 59,83 ----
+*** 48,53 ****
+--- 58,82 ----
+  #else
       #define SWAPL(value) (LESwaps::isBigEndian() ? (value) : LESwaps::swapLong(value))
   #endif
-  
++ 
 + #else // ALLOW_UNALIGNED_HACK
 + 
 + #define SWAPW(rValue) loadBigEndianWord(reinterpret_cast<const le_uint16&>(rValue))
@@@@ -1279,12 +1299,11 @@@@
 + }
 + 
 + #endif // ALLOW_UNALIGNED_HACK
-+ 
+  
   /**
    * This class is used to access data which stored in big endian order
-   * regardless of the conventions of the platform. It has been designed
 *** misc/icu/source/layout/MPreFixups.cpp	Sat May  8 01:28:44 2004
---- misc/build/icu/source/layout/MPreFixups.cpp	Mon Jan 28 21:31:51 2008
+--- misc/build/icu/source/layout/MPreFixups.cpp	Wed Apr 23 16:40:00 2008
 ***************
 *** 40,45 ****
 --- 40,51 ----
@@@@ -1301,7 +1320,7 @@@@
   {
       for (le_int32 fixup = 0; fixup < fFixupCount; fixup += 1) {
 *** misc/icu/source/layout/MPreFixups.h	Mon Apr 12 20:51:32 2004
---- misc/build/icu/source/layout/MPreFixups.h	Mon Jan 28 21:31:51 2008
+--- misc/build/icu/source/layout/MPreFixups.h	Wed Apr 23 16:40:00 2008
 ***************
 *** 31,36 ****
 --- 31,38 ----
@@@@ -1314,7 +1333,7 @@@@
       FixupData *fFixupData;
       le_int32   fFixupCount;
 *** misc/icu/source/stubdata/Makefile.in	Fri Dec  2 11:21:34 2005
---- misc/build/icu/source/stubdata/Makefile.in	Mon Jan 28 21:31:51 2008
+--- misc/build/icu/source/stubdata/Makefile.in	Wed Apr 23 16:40:00 2008
 ***************
 *** 25,30 ****
 --- 25,36 ----
@@@@ -1330,8 +1349,60 @@@@
   
   ifneq ($(ENABLE_STATIC),)
   TARGET = $(STUBDATA_LIBDIR)$(LIBSICU)$(TARGET_STUBNAME)$(ICULIBSUFFIX).$(A)
+*** misc/icu/source/stubdata/stubdata.c	Wed Nov 21 03:28:14 2001
+--- misc/build/icu/source/stubdata/stubdata.c	Wed Apr 23 16:43:50 2008
+***************
+*** 28,41 ****
+      UDataInfo info;
+      char padding[8];
+      uint32_t count, reserved;
+-     /*
+      const struct {
+      const char *const name; 
+      const void *const data;
+!     } toc[1];
+!     */
+!    int   fakeNameAndData[4];       /* TODO:  Change this header type from */
+!                                    /*        pointerTOC to OffsetTOC.     */
+  } ICU_Data_Header;
+  
+  U_EXPORT const ICU_Data_Header U_ICUDATA_ENTRY_POINT = {
+--- 28,37 ----
+      UDataInfo info;
+      char padding[8];
+      uint32_t count, reserved;
+      const struct {
+      const char *const name; 
+      const void *const data;
+!     } toc[537];		/* set to real toc size to avoid symbol size mismatch runtime link errors */
+  } ICU_Data_Header;
+  
+  U_EXPORT const ICU_Data_Header U_ICUDATA_ENTRY_POINT = {
+***************
+*** 64,73 ****
+      0,                  /* count        */
+      0,                  /* Reserved     */
+      {                   /*  TOC structure */
+! /*        {    */
+!           0 , 0 , 0, 0  /* name and data entries.  Count says there are none,  */
+                          /*  but put one in just in case.                       */
+! /*        }  */
+      }
+  };
+  
+--- 60,69 ----
+      0,                  /* count        */
+      0,                  /* Reserved     */
+      {                   /*  TOC structure */
+!         {
+! 	  { 0 , 0 }	/* name and data entries.  Count says there are none,  */
+                          /*  but put one in just in case.                       */
+!         }
+      }
+  };
+  
 *** misc/icu/source/test/intltest/loctest.cpp	Thu Jul  6 03:50:04 2006
---- misc/build/icu/source/test/intltest/loctest.cpp	Mon Jan 28 21:31:51 2008
+--- misc/build/icu/source/test/intltest/loctest.cpp	Wed Apr 23 16:40:00 2008
 ***************
 *** 4,9 ****
 --- 4,10 ----
@@@@ -1343,7 +1414,7 @@@@
   #include "unicode/decimfmt.h"
   #include "unicode/ucurr.h"
 *** misc/icu/source/test/intltest/regextst.cpp	Tue Jul  5 20:39:00 2005
---- misc/build/icu/source/test/intltest/regextst.cpp	Mon Jan 28 23:18:47 2008
+--- misc/build/icu/source/test/intltest/regextst.cpp	Wed Apr 23 16:40:00 2008
 ***************
 *** 1,6 ****
   /********************************************************************
@@@@ -1424,7 +1495,7 @@@@
   #endif  /* !UCONFIG_NO_REGULAR_EXPRESSIONS  */
   
 *** misc/icu/source/test/intltest/regextst.h	Wed Dec  3 07:58:28 2003
---- misc/build/icu/source/test/intltest/regextst.h	Mon Jan 28 21:31:51 2008
+--- misc/build/icu/source/test/intltest/regextst.h	Wed Apr 23 16:40:00 2008
 ***************
 *** 1,6 ****
   /********************************************************************
@@@@ -1451,7 +1522,7 @@@@
       // The following functions are internal to the regexp tests.
       virtual UBool doRegexLMTest(const char *pat, const char *text, UBool looking, UBool match, int line);
 *** misc/icu/source/test/intltest/tsputil.cpp	Wed Jul 19 00:18:10 2006
---- misc/build/icu/source/test/intltest/tsputil.cpp	Mon Jan 28 21:31:51 2008
+--- misc/build/icu/source/test/intltest/tsputil.cpp	Wed Apr 23 16:40:00 2008
 ***************
 *** 4,9 ****
 --- 4,10 ----
@@@@ -1463,7 +1534,7 @@@@
   
   #include <float.h> // DBL_MAX, DBL_MIN
 *** misc/icu/source/test/intltest/uobjtest.cpp	Thu Mar 23 01:54:12 2006
---- misc/build/icu/source/test/intltest/uobjtest.cpp	Mon Jan 28 21:31:51 2008
+--- misc/build/icu/source/test/intltest/uobjtest.cpp	Wed Apr 23 16:40:00 2008
 ***************
 *** 4,9 ****
 --- 4,10 ----
@@@@ -1475,7 +1546,7 @@@@
   #include "cmemory.h" // UAlignedMemory
   #include <string.h>
 *** misc/icu/source/test/intltest/ustrtest.cpp	Tue Dec 28 22:13:54 2004
---- misc/build/icu/source/test/intltest/ustrtest.cpp	Mon Jan 28 21:31:51 2008
+--- misc/build/icu/source/test/intltest/ustrtest.cpp	Wed Apr 23 16:40:00 2008
 ***************
 *** 4,9 ****
 --- 4,10 ----
@@@@ -1487,7 +1558,7 @@@@
   #include "unicode/unistr.h"
   #include "unicode/uchar.h"
 *** misc/icu/source/tools/icupkg/icupkg.cpp	Fri Jul 21 23:17:52 2006
---- misc/build/icu/source/tools/icupkg/icupkg.cpp	Mon Jan 28 21:31:51 2008
+--- misc/build/icu/source/tools/icupkg/icupkg.cpp	Wed Apr 23 16:40:00 2008
 ***************
 *** 332,337 ****
 --- 332,341 ----
@


1.4
log
@update to OpenOffice.org 2.4.0;
 - rename the br-pt subpackage to pt-br because of an i18n change
   in openoffice
 - regen some patches
 - fix WANTLIB and LIB_DEPENDS
@
text
@d1 1
a1 1
$OpenBSD$
@


1.3
log
@update to version 2.3.1;

This is a minor bug fix release with no new features for users.
However, as this release also fixes a security vulnerability with
database files.
@
text
@d2 2
a3 2
--- icu/icu-3.6.patch.orig.port	Thu Dec  6 16:18:35 2007
+++ icu/icu-3.6.patch	Thu Dec  6 16:20:25 2007
d6 2
a7 2
---- misc/build/icu/source/common/putil.c	Tue Sep 18 19:30:30 2007
+--- misc/build/icu/source/common/putil.c	Thu Dec  6 16:19:01 2007
d15 2
a16 2
---- misc/build/icu/source/common/unicode/pwin32.h	Tue Sep 18 19:30:30 2007
+--- misc/build/icu/source/common/unicode/pwin32.h	Thu Dec  6 16:19:01 2007
d20 1
a20 1
@@@@ -37,10 +37,10 @@@@
d24 2
a25 2
---- misc/build/icu/source/common/unicode/rbbi.h	Tue Sep 18 19:35:01 2007
+--- misc/build/icu/source/common/unicode/rbbi.h	Thu Dec  6 16:19:01 2007
d27 3
a29 18
-*** 611,616 ****
---- 611,617 ----
+*** 611,622 ****
+--- 611,624 ----
       virtual int32_t getBreakType() const;
   #endif
   
@@@@ -48,9 +48,6 @@@@
       /**
         * Set the type of the break iterator.
         * @@internal
-***************
-*** 617,622 ****
---- 618,624 ----
         */
       virtual void setBreakType(int32_t type);
   
@@@@ -59,7 +56,7 @@@@
d33 2
a34 2
---- misc/build/icu/source/common/unicode/umachine.h	Tue Sep 18 19:30:30 2007
+--- misc/build/icu/source/common/unicode/umachine.h	Thu Dec  6 16:19:01 2007
d38 1
a38 1
@@@@ -78,7 +75,7 @@@@
d42 2
a43 2
---- misc/build/icu/source/common/unicode/unistr.h	Tue Sep 18 19:30:31 2007
+--- misc/build/icu/source/common/unicode/unistr.h	Thu Dec  6 16:19:01 2007
d47 1
a47 1
@@@@ -182,7 +179,7 @@@@
d51 2
a52 2
---- misc/build/icu/source/common/unicode/ustring.h	Tue Sep 18 19:30:30 2007
+--- misc/build/icu/source/common/unicode/ustring.h	Thu Dec  6 16:19:01 2007
d56 1
a56 1
@@@@ -201,7 +198,7 @@@@
d59 18
d78 2
a79 2
---- misc/build/icu/source/config/mh-darwin	Tue Sep 18 19:30:30 2007
+--- misc/build/icu/source/config/mh-darwin	Thu Dec  6 16:19:01 2007
d83 1
a83 1
@@@@ -220,7 +217,7 @@@@
d87 2
a88 2
---- misc/build/icu/source/config/mh-irix	Tue Sep 18 19:30:31 2007
+--- misc/build/icu/source/config/mh-irix	Thu Dec  6 16:19:01 2007
d92 1
a92 1
@@@@ -234,7 +231,7 @@@@
d96 2
a97 2
---- misc/build/icu/source/config/mh-linux	Tue Sep 18 19:30:31 2007
+--- misc/build/icu/source/config/mh-linux	Thu Dec  6 16:19:01 2007
d100 2
a101 2
 --- 20,32 ----
@@@@ -252,7 +249,7 @@@@
d105 2
a106 2
---- misc/build/icu/source/config/mh-mingw	Tue Sep 18 19:30:31 2007
+--- misc/build/icu/source/config/mh-mingw	Thu Dec  6 16:19:01 2007
d110 1
a110 1
@@@@ -283,9 +280,9 @@@@
d114 2
a115 2
---- misc/build/icu/source/config/mh-solaris	Tue Sep 18 19:30:31 2007
+--- misc/build/icu/source/config/mh-solaris	Thu Dec  6 16:19:01 2007
d122 1
a122 1
@@@@ -302,8 +299,7 @@@@
d132 1
a132 1
@@@@ -318,19 +314,37 @@@@
d150 1
a150 1
+--- misc/build/icu/source/configure	Thu Dec  6 16:20:07 2007
d169 2
a170 2
---- misc/build/icu/source/data/Makefile.in	Tue Sep 18 19:30:31 2007
+--- misc/build/icu/source/data/Makefile.in	Thu Dec  6 16:19:01 2007
d174 1
a174 1
@@@@ -349,9 +363,9 @@@@
d177 3
a179 3
 *** misc/icu/source/i18n/windtfmt.cpp	Tue Aug 15 08:48:02 2006
---- misc/build/icu/source/i18n/windtfmt.cpp	Tue Sep 18 19:30:31 2007
+--- misc/build/icu/source/i18n/windtfmt.cpp	Thu Dec  6 16:19:01 2007
d181 4
a184 4
-*** 232,238 ****
+*** 232,249 ****
       UChar stackBuffer[STACK_BUFFER_SIZE];
       UChar *buffer = stackBuffer;
d186 12
a197 36
@@@@ -359,16 +373,6 @@@@
   
       if (result == 0) {
           if (GetLastError() == ERROR_INSUFFICIENT_BUFFER) {
---- 232,238 ----
-      UChar stackBuffer[STACK_BUFFER_SIZE];
-      UChar *buffer = stackBuffer;
-  
-!     result = GetDateFormatW(fLCID, dfFlags[fDateStyle - kDateOffset], st, NULL, reinterpret_cast<LPWSTR>(buffer), STACK_BUFFER_SIZE);
-  
-      if (result == 0) {
-          if (GetLastError() == ERROR_INSUFFICIENT_BUFFER) {
-***************
-*** 239,249 ****
               int newLength = GetDateFormatW(fLCID, dfFlags[fDateStyle - kDateOffset], st, NULL, NULL, 0);
   
               buffer = NEW_ARRAY(UChar, newLength);
@@@@ -380,7 +384,14 @@@@
   
       if (buffer != stackBuffer) {
           DELETE_ARRAY(buffer);
---- 239,249 ----
+--- 232,249 ----
+      UChar stackBuffer[STACK_BUFFER_SIZE];
+      UChar *buffer = stackBuffer;
+  
+!     result = GetDateFormatW(fLCID, dfFlags[fDateStyle - kDateOffset], st, NULL, reinterpret_cast<LPWSTR>(buffer), STACK_BUFFER_SIZE);
+  
+      if (result == 0) {
+          if (GetLastError() == ERROR_INSUFFICIENT_BUFFER) {
               int newLength = GetDateFormatW(fLCID, dfFlags[fDateStyle - kDateOffset], st, NULL, NULL, 0);
   
               buffer = NEW_ARRAY(UChar, newLength);
@@@@ -393,7 +404,7 @@@@
       if (buffer != stackBuffer) {
           DELETE_ARRAY(buffer);
d199 1
a199 2
-*** 258,264 ****
+*** 258,275 ****
d201 1
a201 36
       UChar *buffer = stackBuffer;
   
@@@@ -401,16 +412,6 @@@@
   
       if (result == 0) {
           if (GetLastError() == ERROR_INSUFFICIENT_BUFFER) {
---- 258,264 ----
-      UChar stackBuffer[STACK_BUFFER_SIZE];
-      UChar *buffer = stackBuffer;
-  
-!     result = GetTimeFormatW(fLCID, tfFlags[fTimeStyle], st, NULL, reinterpret_cast<LPWSTR>(buffer), STACK_BUFFER_SIZE);
-  
-      if (result == 0) {
-          if (GetLastError() == ERROR_INSUFFICIENT_BUFFER) {
-***************
-*** 265,275 ****
               int newLength = GetTimeFormatW(fLCID, tfFlags[fTimeStyle], st, NULL, NULL, 0);
   
               buffer = NEW_ARRAY(UChar, newLength);
@@@@ -422,7 +423,14 @@@@
   
       if (buffer != stackBuffer) {
           DELETE_ARRAY(buffer);
---- 265,275 ----
+--- 258,275 ----
+      UChar stackBuffer[STACK_BUFFER_SIZE];
+      UChar *buffer = stackBuffer;
+  
+!     result = GetTimeFormatW(fLCID, tfFlags[fTimeStyle], st, NULL, reinterpret_cast<LPWSTR>(buffer), STACK_BUFFER_SIZE);
+  
+      if (result == 0) {
+          if (GetLastError() == ERROR_INSUFFICIENT_BUFFER) {
               int newLength = GetTimeFormatW(fLCID, tfFlags[fTimeStyle], st, NULL, NULL, 0);
   
               buffer = NEW_ARRAY(UChar, newLength);
@@@@ -435,7 +443,7 @@@@
d205 2
a206 2
---- misc/build/icu/source/i18n/winnmfmt.cpp	Tue Sep 18 19:30:31 2007
+--- misc/build/icu/source/i18n/winnmfmt.cpp	Thu Dec  6 16:19:01 2007
d210 1
a210 1
@@@@ -573,7 +581,7 @@@@
d214 2
a215 2
---- misc/build/icu/source/layout/CoverageTables.cpp	Tue Sep 18 19:30:31 2007
+--- misc/build/icu/source/layout/CoverageTables.cpp	Thu Dec  6 16:19:01 2007
d219 1
a219 1
@@@@ -588,7 +596,7 @@@@
d223 2
a224 2
---- misc/build/icu/source/layout/DeviceTables.cpp	Tue Sep 18 19:30:31 2007
+--- misc/build/icu/source/layout/DeviceTables.cpp	Thu Dec  6 16:19:01 2007
d228 1
a228 1
@@@@ -608,7 +616,7 @@@@
d232 2
a233 2
---- misc/build/icu/source/layout/GXLayoutEngine.cpp	Tue Sep 18 19:30:31 2007
+--- misc/build/icu/source/layout/GXLayoutEngine.cpp	Thu Dec  6 16:19:01 2007
d237 1
a237 1
@@@@ -627,7 +635,7 @@@@
d241 2
a242 2
---- misc/build/icu/source/layout/IndicClassTables.cpp	Tue Sep 18 19:30:31 2007
+--- misc/build/icu/source/layout/IndicClassTables.cpp	Thu Dec  6 16:19:01 2007
d246 34
a279 1
@@@@ -763,7 +771,7 @@@@
d283 2
a284 2
---- misc/build/icu/source/layout/IndicReordering.cpp	Tue Sep 18 19:30:31 2007
+--- misc/build/icu/source/layout/IndicReordering.cpp	Thu Dec  6 16:19:01 2007
d288 1
a288 1
@@@@ -845,11 +853,13 @@@@
d306 1
a306 1
@@@@ -862,13 +872,11 @@@@
d318 2
a319 2
---- misc/build/icu/source/layout/LESwaps.h	Tue Sep 18 19:30:31 2007
+--- misc/build/icu/source/layout/LESwaps.h	Thu Dec  6 16:19:01 2007
d323 1
a323 1
@@@@ -916,11 +924,12 @@@@
d339 1
a339 1
@@@@ -939,12 +948,11 @@@@
d349 2
a350 2
---- misc/build/icu/source/layout/MPreFixups.cpp	Tue Sep 18 19:30:31 2007
+--- misc/build/icu/source/layout/MPreFixups.cpp	Thu Dec  6 16:19:01 2007
d354 1
a354 1
@@@@ -961,7 +969,7 @@@@
d358 2
a359 2
---- misc/build/icu/source/layout/MPreFixups.h	Tue Sep 18 19:30:31 2007
+--- misc/build/icu/source/layout/MPreFixups.h	Thu Dec  6 16:19:01 2007
d363 1
a363 1
@@@@ -974,10 +982,10 @@@@
d367 2
a368 2
---- misc/build/icu/source/stubdata/Makefile.in	Tue Sep 18 19:30:31 2007
+--- misc/build/icu/source/stubdata/Makefile.in	Thu Dec  6 16:19:01 2007
d370 4
a373 16
-*** 25,31 ****
---- 25,37 ----
+*** 25,30 ****
+--- 25,36 ----
   ## Target information
   
   TARGET_STUBNAME=$(DATA_STUBNAME)
@@@@ -985,14 +993,65 @@@@
 + FINAL_SO_TARGET=$(STUBDATA_LIBDIR)$(LIBICU)$(TARGET_STUBNAME)$(ICULIBSUFFIX)$(SO_TARGET_VERSION_MAJOR)$(STUB_SUFFIX).$(SO)
 + %$(STUB_SUFFIX).$(SO): %$(SO_TARGET_VERSION_MAJOR)$(STUB_SUFFIX).$(SO)
 + 	$(RM) $@@ && ln $< $@@
-  
-+ endif
 + 
++ endif
+  
a375 1
-  endif
d377 1
a377 1
+--- misc/build/icu/source/stubdata/stubdata.c	Thu Dec  6 16:19:01 2007
d401 1
a401 1
+!     } toc[537];			/* set to real toc size to avoid symbol size mismatch runtime link errors */
d421 2
a422 2
+!           {
+!           { 0 , 0 }  /* name and data entries.  Count says there are none,  */
d424 1
a424 1
+!           }
d429 2
a430 2
---- misc/build/icu/source/test/intltest/loctest.cpp	Tue Sep 18 19:30:31 2007
+--- misc/build/icu/source/test/intltest/loctest.cpp	Thu Dec  6 16:19:01 2007
d434 1
a434 1
@@@@ -1004,7 +1063,7 @@@@
d437 18
d456 2
a457 2
---- misc/build/icu/source/test/intltest/tsputil.cpp	Tue Sep 18 19:30:31 2007
+--- misc/build/icu/source/test/intltest/tsputil.cpp	Thu Dec  6 16:19:01 2007
d461 1
a461 1
@@@@ -1016,7 +1075,7 @@@@
d465 2
a466 2
---- misc/build/icu/source/test/intltest/uobjtest.cpp	Tue Sep 18 19:30:31 2007
+--- misc/build/icu/source/test/intltest/uobjtest.cpp	Thu Dec  6 16:19:01 2007
d470 1
a470 1
@@@@ -1028,7 +1087,7 @@@@
d474 2
a475 2
---- misc/build/icu/source/test/intltest/ustrtest.cpp	Tue Sep 18 19:30:31 2007
+--- misc/build/icu/source/test/intltest/ustrtest.cpp	Thu Dec  6 16:19:01 2007
d479 1
a479 1
@@@@ -1040,7 +1099,7 @@@@
d483 2
a484 2
---- misc/build/icu/source/tools/icupkg/icupkg.cpp	Tue Sep 18 19:30:31 2007
+--- misc/build/icu/source/tools/icupkg/icupkg.cpp	Thu Dec  6 16:19:01 2007
@


1.2
log
@- update to openoffice 2.3 that has many new features
  and a lot of speedup.
- fix the debug flavor
- rearrange the PLISTs so the no_lang flavor won't try to
  include some language files
@
text
@d2 2
a3 2
--- icu/icu-3.6.patch.orig.port	Tue Jun  5 12:28:49 2007
+++ icu/icu-3.6.patch	Mon Nov  5 16:59:57 2007
d6 2
a7 2
---- misc/build/icu/source/common/putil.c	Mon Apr 30 17:32:58 2007
+--- misc/build/icu/source/common/putil.c	Mon Nov  5 16:58:53 2007
d15 2
a16 2
---- misc/build/icu/source/common/unicode/pwin32.h	Mon Apr 30 17:32:58 2007
+--- misc/build/icu/source/common/unicode/pwin32.h	Mon Nov  5 16:58:53 2007
d20 1
a20 1
@@@@ -37,7 +37,7 @@@@
d23 24
d48 2
a49 2
---- misc/build/icu/source/common/unicode/umachine.h	Mon Apr 30 17:32:58 2007
+--- misc/build/icu/source/common/unicode/umachine.h	Mon Nov  5 16:58:53 2007
d53 1
a53 2
@@@@ -55,8 +55,112 @@@@
       typedef wchar_t UChar;
d56 9
a64 104
+*** misc/icu/source/common/unicode/unistr.h	Tue Aug 29 23:52:50 2006
+--- misc/build/icu/source/common/unicode/unistr.h	Mon Nov  5 16:58:53 2007
+***************
+*** 3280,3286 ****
+  //========================================
+  inline int8_t
+  UnicodeString::doCompare(int32_t start,
+!               int32_t length,
+                const UnicodeString& srcText,
+                int32_t srcStart,
+                int32_t srcLength) const
+--- 3280,3286 ----
+  //========================================
+  inline int8_t
+  UnicodeString::doCompare(int32_t start,
+!               int32_t _length,
+                const UnicodeString& srcText,
+                int32_t srcStart,
+                int32_t srcLength) const
+***************
+*** 3289,3295 ****
+      return (int8_t)!isBogus(); // 0 if both are bogus, 1 otherwise
+    } else {
+      srcText.pinIndices(srcStart, srcLength);
+!     return doCompare(start, length, srcText.fArray, srcStart, srcLength);
+    }
+  }
+  
+--- 3289,3295 ----
+      return (int8_t)!isBogus(); // 0 if both are bogus, 1 otherwise
+    } else {
+      srcText.pinIndices(srcStart, srcLength);
+!     return doCompare(start, _length, srcText.fArray, srcStart, srcLength);
+    }
+  }
+  
+***************
+*** 3374,3380 ****
+  
+  inline int8_t
+  UnicodeString::doCompareCodePointOrder(int32_t start,
+!                                        int32_t length,
+                                         const UnicodeString& srcText,
+                                         int32_t srcStart,
+                                         int32_t srcLength) const
+--- 3374,3380 ----
+  
+  inline int8_t
+  UnicodeString::doCompareCodePointOrder(int32_t start,
+!                                        int32_t _length,
+                                         const UnicodeString& srcText,
+                                         int32_t srcStart,
+                                         int32_t srcLength) const
+***************
+*** 3383,3389 ****
+      return (int8_t)!isBogus(); // 0 if both are bogus, 1 otherwise
+    } else {
+      srcText.pinIndices(srcStart, srcLength);
+!     return doCompareCodePointOrder(start, length, srcText.fArray, srcStart, srcLength);
+    }
+  }
+  
+--- 3383,3389 ----
+      return (int8_t)!isBogus(); // 0 if both are bogus, 1 otherwise
+    } else {
+      srcText.pinIndices(srcStart, srcLength);
+!     return doCompareCodePointOrder(start, _length, srcText.fArray, srcStart, srcLength);
+    }
+  }
+  
+***************
+*** 3435,3441 ****
+  
+  inline int8_t
+  UnicodeString::doCaseCompare(int32_t start,
+!                              int32_t length,
+                               const UnicodeString &srcText,
+                               int32_t srcStart,
+                               int32_t srcLength,
+--- 3435,3441 ----
+  
+  inline int8_t
+  UnicodeString::doCaseCompare(int32_t start,
+!                              int32_t _length,
+                               const UnicodeString &srcText,
+                               int32_t srcStart,
+                               int32_t srcLength,
+***************
+*** 3445,3451 ****
+      return (int8_t)!isBogus(); // 0 if both are bogus, 1 otherwise
+    } else {
+      srcText.pinIndices(srcStart, srcLength);
+!     return doCaseCompare(start, length, srcText.fArray, srcStart, srcLength, options);
+    }
+  }
+  
+--- 3445,3451 ----
+      return (int8_t)!isBogus(); // 0 if both are bogus, 1 otherwise
+    } else {
+      srcText.pinIndices(srcStart, srcLength);
+!     return doCaseCompare(start, _length, srcText.fArray, srcStart, srcLength, options);
+    }
+  }
+  
d66 2
a67 2
---- misc/build/icu/source/common/unicode/ustring.h	Mon Apr 30 17:32:58 2007
+--- misc/build/icu/source/common/unicode/ustring.h	Mon Nov  5 16:58:53 2007
d71 1
a71 1
@@@@ -75,7 +179,7 @@@@
d75 2
a76 2
---- misc/build/icu/source/config/mh-darwin	Mon Apr 30 17:32:58 2007
+--- misc/build/icu/source/config/mh-darwin	Mon Nov  5 16:58:53 2007
d80 1
a80 1
@@@@ -94,7 +198,7 @@@@
d84 2
a85 2
---- misc/build/icu/source/config/mh-irix	Mon Apr 30 17:32:58 2007
+--- misc/build/icu/source/config/mh-irix	Mon Nov  5 16:58:53 2007
d89 1
a89 1
@@@@ -108,7 +212,7 @@@@
d93 2
a94 2
---- misc/build/icu/source/config/mh-linux	Mon Apr 30 17:32:58 2007
+--- misc/build/icu/source/config/mh-linux	Mon Nov  5 16:58:53 2007
d98 1
a98 1
@@@@ -126,7 +230,7 @@@@
d102 2
a103 2
---- misc/build/icu/source/config/mh-mingw	Mon Apr 30 17:32:58 2007
+--- misc/build/icu/source/config/mh-mingw	Mon Nov  5 16:58:53 2007
d107 1
a107 1
@@@@ -157,7 +261,7 @@@@
d111 2
a112 2
---- misc/build/icu/source/config/mh-solaris	Mon Apr 30 17:32:58 2007
+--- misc/build/icu/source/config/mh-solaris	Mon Nov  5 16:58:53 2007
d114 6
a119 1
 *** 18,33 ****
d121 1
a121 1
@@@@ -201,8 +305,27 @@@@
d123 20
d145 1
d147 1
a147 1
+--- misc/build/icu/source/configure	Mon Nov  5 16:58:53 2007
d166 2
a167 2
---- misc/build/icu/source/data/Makefile.in	Mon Apr 30 17:32:58 2007
+--- misc/build/icu/source/data/Makefile.in	Mon Nov  5 16:58:53 2007
d171 1
a171 1
@@@@ -221,7 +344,7 @@@@
d175 2
a176 2
---- misc/build/icu/source/i18n/windtfmt.cpp	Mon Apr 30 17:32:58 2007
+--- misc/build/icu/source/i18n/windtfmt.cpp	Mon Nov  5 16:58:53 2007
d178 2
a179 1
 *** 232,249 ****
d181 78
a258 1
@@@@ -301,7 +424,7 @@@@
d262 2
a263 2
---- misc/build/icu/source/i18n/winnmfmt.cpp	Mon Apr 30 17:32:58 2007
+--- misc/build/icu/source/i18n/winnmfmt.cpp	Mon Nov  5 16:58:53 2007
d267 1
a267 1
@@@@ -439,7 +562,7 @@@@
d271 2
a272 2
---- misc/build/icu/source/layout/CoverageTables.cpp	Mon Apr 30 17:32:58 2007
+--- misc/build/icu/source/layout/CoverageTables.cpp	Mon Nov  5 16:58:53 2007
d276 1
a276 1
@@@@ -454,7 +577,7 @@@@
d280 2
a281 2
---- misc/build/icu/source/layout/DeviceTables.cpp	Mon Apr 30 17:32:58 2007
+--- misc/build/icu/source/layout/DeviceTables.cpp	Mon Nov  5 16:58:53 2007
d285 1
a285 1
@@@@ -474,7 +597,7 @@@@
d289 2
a290 2
---- misc/build/icu/source/layout/GXLayoutEngine.cpp	Mon Apr 30 17:32:58 2007
+--- misc/build/icu/source/layout/GXLayoutEngine.cpp	Mon Nov  5 16:58:53 2007
d294 1
a294 1
@@@@ -493,7 +616,7 @@@@
d298 2
a299 2
---- misc/build/icu/source/layout/IndicClassTables.cpp	Mon Apr 30 17:32:58 2007
+--- misc/build/icu/source/layout/IndicClassTables.cpp	Mon Nov  5 16:58:53 2007
d303 1
a303 34
@@@@ -512,14 +635,14 @@@@
   
   static const IndicClassTable::CharClass punjCharClasses[] =
 ***************
-*** 120,125 ****
---- 120,138 ----
+*** 120,127 ****
+--- 120,140 ----
       _iv, _xx, _xx, _xx, _xx, _xx, _xx, _xx, _xx, _xx, _xx, _xx, _xx, _xx, _xx, _xx  // 0AE0 - 0AEF
   };
   
 + #if 1
-+ static const IndicClassTable::CharClass oryaCharClasses[] =
-+ {
+  static const IndicClassTable::CharClass oryaCharClasses[] =
+  {
 +     _xx, _ma, _mp, _mp, _xx, _iv, _iv, _iv, _iv, _iv, _iv, _iv, _iv, _xx, _xx, _iv, /* 0B00 - 0B0F */
 +     _iv, _xx, _xx, _iv, _iv, _bb, _bb, _bb, _bb, _bb, _bb, _bb, _bb, _bb, _ct, _bb, /* 0B10 - 0B1F */
 +     _bb, _bb, _bb, _bb, _bb, _bb, _bb, _bb, _bb, _xx, _bb, _bb, _bb, _bb, _bb, _pb, /* 0B20 - 0B2F */
@@@@ -530,9 +653,11 @@@@
 +     _xx, _bb                                                                        /* 0B70 - 0B71 */
 + };
 + #else
-  static const IndicClassTable::CharClass oryaCharClasses[] =
-  {
++ static const IndicClassTable::CharClass oryaCharClasses[] =
++ {
       _xx, _ma, _mp, _mp, _xx, _iv, _iv, _iv, _iv, _iv, _iv, _iv, _iv, _xx, _xx, _iv, // 0B00 - 0B0F
+      _iv, _xx, _xx, _iv, _iv, _ct, _ct, _ct, _ct, _ct, _ct, _ct, _ct, _ct, _ct, _ct, // 0B10 - 0B1F
+      _ct, _ct, _ct, _ct, _bb, _ct, _ct, _ct, _bb, _xx, _ct, _ct, _bb, _bb, _bb, _pb, // 0B20 - 0B2F
 ***************
 *** 131,136 ****
 --- 144,150 ----
@@@@ -627,7 +752,7 @@@@
d307 2
a308 2
---- misc/build/icu/source/layout/IndicReordering.cpp	Mon Apr 30 17:32:58 2007
+--- misc/build/icu/source/layout/IndicReordering.cpp	Mon Nov  5 16:58:53 2007
d312 26
a337 2
@@@@ -732,7 +857,7 @@@@
   
d339 2
d342 2
a343 2
---- misc/build/icu/source/layout/LESwaps.h	Mon Apr 30 17:32:58 2007
+--- misc/build/icu/source/layout/LESwaps.h	Mon Nov  5 16:58:53 2007
d347 22
a368 1
@@@@ -808,7 +933,7 @@@@
d371 1
d373 2
a374 2
---- misc/build/icu/source/layout/MPreFixups.cpp	Mon Apr 30 17:32:58 2007
+--- misc/build/icu/source/layout/MPreFixups.cpp	Mon Nov  5 16:58:53 2007
d378 1
a378 1
@@@@ -825,7 +950,7 @@@@
d382 2
a383 2
---- misc/build/icu/source/layout/MPreFixups.h	Mon Apr 30 17:32:58 2007
+--- misc/build/icu/source/layout/MPreFixups.h	Mon Nov  5 16:58:53 2007
d387 1
a387 1
@@@@ -838,7 +963,7 @@@@
d391 2
a392 2
---- misc/build/icu/source/stubdata/Makefile.in	Mon Apr 30 17:32:58 2007
+--- misc/build/icu/source/stubdata/Makefile.in	Mon Nov  5 16:58:53 2007
d394 16
a409 4
 *** 25,30 ****
 --- 25,36 ----
@@@@ -854,8 +979,60 @@@@
   
d412 1
d414 1
a414 1
+--- misc/build/icu/source/stubdata/stubdata.c	Mon Nov  5 16:59:05 2007
d438 1
a438 1
+!     } toc[537];                    /* set to real toc size to avoid symbol size mismatch runtime link errors */
d458 2
a459 2
+!         {    
+!           {0, 0} /* name and data entries.  Count says there are none,  */
d461 1
a461 1
+!         }  
d466 2
a467 2
---- misc/build/icu/source/test/intltest/loctest.cpp	Mon Apr 30 17:32:58 2007
+--- misc/build/icu/source/test/intltest/loctest.cpp	Mon Nov  5 16:58:53 2007
d471 1
a471 1
@@@@ -867,7 +1044,7 @@@@
d475 2
a476 2
---- misc/build/icu/source/test/intltest/tsputil.cpp	Mon Apr 30 17:32:58 2007
+--- misc/build/icu/source/test/intltest/tsputil.cpp	Mon Nov  5 16:58:53 2007
d480 1
a480 1
@@@@ -879,7 +1056,7 @@@@
d484 2
a485 2
---- misc/build/icu/source/test/intltest/uobjtest.cpp	Mon Apr 30 17:32:58 2007
+--- misc/build/icu/source/test/intltest/uobjtest.cpp	Mon Nov  5 16:58:53 2007
d489 1
a489 1
@@@@ -891,7 +1068,7 @@@@
d493 2
a494 2
---- misc/build/icu/source/test/intltest/ustrtest.cpp	Mon Apr 30 17:32:58 2007
+--- misc/build/icu/source/test/intltest/ustrtest.cpp	Mon Nov  5 16:58:53 2007
d498 1
a498 1
@@@@ -903,7 +1080,7 @@@@
d502 2
a503 2
---- misc/build/icu/source/tools/icupkg/icupkg.cpp	Mon Apr 30 17:32:58 2007
+--- misc/build/icu/source/tools/icupkg/icupkg.cpp	Mon Nov  5 16:58:53 2007
a506 108
@@@@ -917,107 +1094,3 @@@@
   extern int
   main(int argc, char *argv[]) {
       const char *pname, *sourcePath, *destPath, *inFilename, *outFilename, *outComment;
-*** misc/icu/source/common/unicode/unistr.h	2007-05-20 08:40:31.000000000 -0400
---- misc/build/icu/source/common/unicode/unistr.h	2007-05-20 08:42:01.000000000 -0400
-***************
-*** 3280,3286 ****
-  //========================================
-  inline int8_t
-  UnicodeString::doCompare(int32_t start,
-!               int32_t length,
-                const UnicodeString& srcText,
-                int32_t srcStart,
-                int32_t srcLength) const
---- 3280,3286 ----
-  //========================================
-  inline int8_t
-  UnicodeString::doCompare(int32_t start,
-!               int32_t _length,
-                const UnicodeString& srcText,
-                int32_t srcStart,
-                int32_t srcLength) const
-***************
-*** 3289,3295 ****
-      return (int8_t)!isBogus(); // 0 if both are bogus, 1 otherwise
-    } else {
-      srcText.pinIndices(srcStart, srcLength);
-!     return doCompare(start, length, srcText.fArray, srcStart, srcLength);
-    }
-  }
-  
---- 3289,3295 ----
-      return (int8_t)!isBogus(); // 0 if both are bogus, 1 otherwise
-    } else {
-      srcText.pinIndices(srcStart, srcLength);
-!     return doCompare(start, _length, srcText.fArray, srcStart, srcLength);
-    }
-  }
-  
-***************
-*** 3374,3380 ****
-  
-  inline int8_t
-  UnicodeString::doCompareCodePointOrder(int32_t start,
-!                                        int32_t length,
-                                         const UnicodeString& srcText,
-                                         int32_t srcStart,
-                                         int32_t srcLength) const
---- 3374,3380 ----
-  
-  inline int8_t
-  UnicodeString::doCompareCodePointOrder(int32_t start,
-!                                        int32_t _length,
-                                         const UnicodeString& srcText,
-                                         int32_t srcStart,
-                                         int32_t srcLength) const
-***************
-*** 3383,3389 ****
-      return (int8_t)!isBogus(); // 0 if both are bogus, 1 otherwise
-    } else {
-      srcText.pinIndices(srcStart, srcLength);
-!     return doCompareCodePointOrder(start, length, srcText.fArray, srcStart, srcLength);
-    }
-  }
-  
---- 3383,3389 ----
-      return (int8_t)!isBogus(); // 0 if both are bogus, 1 otherwise
-    } else {
-      srcText.pinIndices(srcStart, srcLength);
-!     return doCompareCodePointOrder(start, _length, srcText.fArray, srcStart, srcLength);
-    }
-  }
-  
-***************
-*** 3435,3441 ****
-  
-  inline int8_t
-  UnicodeString::doCaseCompare(int32_t start,
-!                              int32_t length,
-                               const UnicodeString &srcText,
-                               int32_t srcStart,
-                               int32_t srcLength,
---- 3435,3441 ----
-  
-  inline int8_t
-  UnicodeString::doCaseCompare(int32_t start,
-!                              int32_t _length,
-                               const UnicodeString &srcText,
-                               int32_t srcStart,
-                               int32_t srcLength,
-***************
-*** 3445,3451 ****
-      return (int8_t)!isBogus(); // 0 if both are bogus, 1 otherwise
-    } else {
-      srcText.pinIndices(srcStart, srcLength);
-!     return doCaseCompare(start, length, srcText.fArray, srcStart, srcLength, options);
-    }
-  }
-  
---- 3445,3451 ----
-      return (int8_t)!isBogus(); // 0 if both are bogus, 1 otherwise
-    } else {
-      srcText.pinIndices(srcStart, srcLength);
-!     return doCaseCompare(start, _length, srcText.fArray, srcStart, srcLength, options);
-    }
-  }
-  
@


1.1
log
@update to version 2.2.0m18;

- fix the PLIST of the bg, de and es and language so they
can be used again: from Daniel Gruber <daniel@@tydirium.org>

this has been tested by many people.
@
text
@d2 2
a3 2
--- icu/icu-3.6.patch.orig.port	Tue Jan 30 09:37:09 2007
+++ icu/icu-3.6.patch	Tue Feb 20 09:51:58 2007
d6 2
a7 2
---- misc/build/icu/source/common/putil.c	Wed Jan  3 09:40:21 2007
+--- misc/build/icu/source/common/putil.c	Tue Feb 20 09:50:08 2007
d14 132
d147 2
a148 2
---- misc/build/icu/source/config/mh-darwin	Wed Jan  3 09:41:43 2007
+--- misc/build/icu/source/config/mh-darwin	Tue Feb 20 09:50:08 2007
d152 1
a152 1
@@@@ -38,7 +38,7 @@@@
d156 2
a157 2
---- misc/build/icu/source/config/mh-irix	Wed Jan  3 09:40:21 2007
+--- misc/build/icu/source/config/mh-irix	Tue Feb 20 09:50:08 2007
d161 1
a161 1
@@@@ -52,7 +52,7 @@@@
d165 2
a166 2
---- misc/build/icu/source/config/mh-linux	Wed Jan  3 09:40:21 2007
+--- misc/build/icu/source/config/mh-linux	Tue Feb 20 09:50:08 2007
d170 1
a170 1
@@@@ -70,9 +70,9 @@@@
d173 9
d183 2
a184 2
---- misc/build/icu/source/config/mh-solaris	Wed Jan  3 09:40:21 2007
+--- misc/build/icu/source/config/mh-solaris	Tue Feb 20 09:50:08 2007
d186 1
a186 2
-*** 18,34 ****
+*** 18,33 ****
d188 1
a188 3
   ## Commands to link
   ## For Sun Workshop, use CC to link to bring in C++ runtime
@@@@ -89,8 +89,7 @@@@
a191 23
-  ## Compiler switch to embed a library name
---- 18,42 ----
+--- 18,41 ----
   
   ## Commands to link
   ## For Sun Workshop, use CC to link to bring in C++ runtime
@@@@ -105,19 +104,37 @@@@
   ## Compiler switch to embed a runtime search path
   LD_RPATH=	-R
   LD_RPATH_PRE=	
-  
++ 
 + ## Force RPATH=$ORIGIN to locate own dependencies w/o need for LD_LIBRARY_PATH
 + ENABLE_RPATH=YES
 + RPATHLDFLAGS=${LD_RPATH}'$$ORIGIN'
 + 
 + #SH#  ENABLE_RPATH=YES
 + #SH#  RPATHLDFLAGS="${LD_RPATH}'$$ORIGIN'"
-+ 
+  
   #LIBRARY_PATH_PREFIX=/usr/lib/lwp:
   
-  ## Compiler switch to embed a library name
d193 1
a193 1
+--- misc/build/icu/source/configure	Tue Feb 20 09:51:08 2007
d212 2
a213 2
---- misc/build/icu/source/data/Makefile.in	Wed Jan  3 09:40:21 2007
+--- misc/build/icu/source/data/Makefile.in	Tue Feb 20 09:50:08 2007
d217 1
a217 1
@@@@ -136,7 +153,7 @@@@
d220 18
d239 2
a240 2
---- misc/build/icu/source/layout/CoverageTables.cpp	Fri Jan 19 16:03:21 2007
+--- misc/build/icu/source/layout/CoverageTables.cpp	Tue Feb 20 09:50:08 2007
d244 1
a244 1
@@@@ -151,7 +168,7 @@@@
d248 2
a249 2
---- misc/build/icu/source/layout/DeviceTables.cpp	Fri Jan 19 16:03:20 2007
+--- misc/build/icu/source/layout/DeviceTables.cpp	Tue Feb 20 09:50:08 2007
d253 1
a253 1
@@@@ -171,7 +188,7 @@@@
d257 2
a258 2
---- misc/build/icu/source/layout/GXLayoutEngine.cpp	Wed Jan  3 09:40:21 2007
+--- misc/build/icu/source/layout/GXLayoutEngine.cpp	Tue Feb 20 09:50:08 2007
d262 1
a262 1
@@@@ -190,7 +207,7 @@@@
d266 2
a267 2
---- misc/build/icu/source/layout/IndicClassTables.cpp	Fri Jan 19 16:03:21 2007
+--- misc/build/icu/source/layout/IndicClassTables.cpp	Tue Feb 20 09:50:08 2007
d271 1
a271 1
@@@@ -209,14 +226,14 @@@@
d290 1
a290 1
@@@@ -227,9 +244,11 @@@@
d304 1
a304 1
@@@@ -324,7 +343,7 @@@@
d308 2
a309 2
---- misc/build/icu/source/layout/IndicReordering.cpp	Fri Jan 19 16:03:20 2007
+--- misc/build/icu/source/layout/IndicReordering.cpp	Tue Feb 20 09:50:08 2007
d313 2
a314 26
@@@@ -406,11 +425,13 @@@@
       {-1, -1, -1, -1, -1, -1,  3,  2, -1, -1, -1, -1, -1, -1, -1}, //  7 - consonant virama ZWJ, consonant ZWJ virama
       {-1,  6,  1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  4, -1}, //  8 - independent vowels that can take a virama
 ***************
-*** 629,634 ****
---- 651,670 ----
+*** 627,632 ****
+--- 649,668 ----
+              // write base consonant
+              for (i = baseConsonant; i < bcSpan; i += 1) {
                   output.writeChar(chars[i], i, tagArray4);
-              }
-  
++             }
++ 
 +             /* for the special conjuction of Cons+0x0d4d+0x0d31 or Cons+0x0d4d+0x0d30 of Malayalam */
 +             if ((baseConsonant - 2 >= 0) &&
 +                 (chars[baseConsonant - 1] == 0x0d4d) &&
@@@@ -423,13 +444,11 @@@@
 + 
 + 		if (mpreFixups)
 + 			mpreFixups->reduce();
-+             }
-+ 
+              }
+  
a315 2
-                  output.writeMbelow();
-                  output.writeSMbelow(); // FIXME: there are no SMs in these scripts...
d317 2
a318 2
---- misc/build/icu/source/layout/LESwaps.h	Wed Jan  3 09:40:21 2007
+--- misc/build/icu/source/layout/LESwaps.h	Tue Feb 20 09:50:08 2007
d322 1
a322 22
@@@@ -477,11 +496,12 @@@@
       #if U_IS_BIG_ENDIAN
           #define SWAPW(value) (value)
 ***************
-*** 49,54 ****
---- 59,83 ----
+*** 48,53 ****
+--- 58,82 ----
+  #else
       #define SWAPL(value) (LESwaps::isBigEndian() ? (value) : LESwaps::swapLong(value))
   #endif
-  
++ 
 + #else // ALLOW_UNALIGNED_HACK
 + 
 + #define SWAPW(rValue) loadBigEndianWord(reinterpret_cast<const le_uint16&>(rValue))
@@@@ -500,12 +520,11 @@@@
 + }
 + 
 + #endif // ALLOW_UNALIGNED_HACK
-+ 
+  
a324 1
-   * regardless of the conventions of the platform. It has been designed
d326 2
a327 2
---- misc/build/icu/source/layout/MPreFixups.cpp	Fri Jan 19 16:03:20 2007
+--- misc/build/icu/source/layout/MPreFixups.cpp	Tue Feb 20 09:50:08 2007
d331 1
a331 1
@@@@ -522,7 +541,7 @@@@
d335 2
a336 2
---- misc/build/icu/source/layout/MPreFixups.h	Fri Jan 19 16:03:20 2007
+--- misc/build/icu/source/layout/MPreFixups.h	Tue Feb 20 09:50:08 2007
d340 1
a340 2
@@@@ -534,8 +553,60 @@@@
   private:
d343 10
d354 1
a354 1
+--- misc/build/icu/source/stubdata/stubdata.c	Tue Feb 20 09:50:08 2007
d378 1
a378 1
+!     } toc[537]; /* set to real toc size to avoid symbol size mismatch runtime link errors */
d398 2
a399 2
+!           {
+!                {0 , 0}  /* name and data entries.  Count says there are none,  */
d401 1
a401 1
+!           }
d406 2
a407 2
---- misc/build/icu/source/test/intltest/loctest.cpp	Wed Jan  3 09:40:21 2007
+--- misc/build/icu/source/test/intltest/loctest.cpp	Tue Feb 20 09:50:08 2007
d411 1
a411 1
@@@@ -547,7 +618,7 @@@@
d415 2
a416 2
---- misc/build/icu/source/test/intltest/tsputil.cpp	Wed Jan  3 09:40:21 2007
+--- misc/build/icu/source/test/intltest/tsputil.cpp	Tue Feb 20 09:50:08 2007
d420 1
a420 1
@@@@ -559,7 +630,7 @@@@
d424 2
a425 2
---- misc/build/icu/source/test/intltest/uobjtest.cpp	Wed Jan  3 09:40:21 2007
+--- misc/build/icu/source/test/intltest/uobjtest.cpp	Tue Feb 20 09:50:08 2007
d429 1
a429 1
@@@@ -571,7 +642,7 @@@@
d433 2
a434 2
---- misc/build/icu/source/test/intltest/ustrtest.cpp	Wed Jan  3 09:40:21 2007
+--- misc/build/icu/source/test/intltest/ustrtest.cpp	Tue Feb 20 09:50:08 2007
d438 117
@

