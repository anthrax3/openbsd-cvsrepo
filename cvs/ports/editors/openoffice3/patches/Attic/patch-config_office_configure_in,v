head	1.3;
access;
symbols
	OPENBSD_4_5:1.2.0.2
	OPENBSD_4_5_BASE:1.2
	robert_20081030:1.1.1.1
	robert:1.1.1;
locks; strict;
comment	@# @;


1.3
date	2009.05.08.15.43.50;	author robert;	state dead;
branches;
next	1.2;

1.2
date	2009.01.22.17.44.38;	author robert;	state Exp;
branches;
next	1.1;

1.1
date	2008.10.30.18.51.05;	author robert;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2008.10.30.18.51.05;	author robert;	state Exp;
branches;
next	;


desc
@@


1.3
log
@update to openoffice-3.1.0

- introduce a no_java flavor because now we can build OOo w/o having jdk and
  other java dependencies installed
- introduce a parallel flavor that allows people to build OOo with parallel
  processes. to achieve this we use a so called "non-blocking" cat, so
  another distfile has been added in order two provide to pre-built static
  binaries with the needed modifications (for amd64 and i386)
  By default we run a parallel build with NCPU+1 processes.
- remove unneccessary patch files
- fix some dependencies
@
text
@--- config_office/configure.in.orig.port	Fri Sep  5 15:54:41 2008
+++ config_office/configure.in	Mon Jan 19 14:46:19 2009
@@@@ -986,6 +986,18 @@@@ case "$build_os" in
 		echo "AIX is an alpha port --- Use at own risk" >> warn
 		_os=AIX
 		;;
+        openbsd*)
+                test_x=yes
+                test_gtk=yes
+                build_cairo=yes
+                test_kde=yes
+                test_cups=yes
+		test_freetype=yes
+		test_randr=yes
+                PTHREAD_CFLAGS="-pthread -D_THREAD_SAFE"
+                PTHREAD_LIBS="-pthread"
+                _os=OpenBSD
+                ;;
    *)
    AC_MSG_ERROR([$_os operating system is not suitable to build OpenOffice.org!])
    ;;
@@@@ -2301,6 +2313,8 @@@@ dnl ==================================================
      esac
    elif test "$_os" = "Darwin"; then
       DEFAULT_TO_STLPORT="no"
+   elif test "$_os" = "OpenBSD"; then
+      DEFAULT_TO_STLPORT="no"
    fi
    if test "$DEFAULT_TO_STLPORT" = "yes"; then
       AC_MSG_RESULT([stlport])
@@@@ -3115,6 +3129,9 @@@@ if test "$_os" != "WINNT" -a \( "z$enable_epm" = "z" -
 	AIX)
 		PKGFORMAT=aix
 		;;
+        OpenBSD)
+                PKGFORMAT=portable
+                ;;
 	*BSD)
 		PKGFORMAT=bsd
 		;;
@@@@ -3441,7 +3458,7 @@@@ if test -n "$with_system_libwpd" -o -n "$with_system_l
         test "$with_system_libwpd" != "no"; then
     AC_MSG_RESULT([external])
     SYSTEM_LIBWPD=YES
-    PKG_CHECK_MODULES( LIBWPD, libwpd-0.8 )
+    PKG_CHECK_MODULES( LIBWPD, libwpd )
 else
     AC_MSG_RESULT([internal])
     SYSTEM_LIBWPD=NO
@@@@ -3561,12 +3578,13 @@@@ if test -n "$with_system_python" -o -n "$with_system_l
 
    python_include=`$PYTHON -c "import distutils.sysconfig; print distutils.sysconfig.get_config_var('INCLUDEPY');"`
    python_version=`$PYTHON -c "import distutils.sysconfig; print distutils.sysconfig.get_config_var('VERSION');"`
+   python_libs=`$PYTHON -c "import distutils.sysconfig; print distutils.sysconfig.get_config_var('LIBS');"`
    PYTHON_CFLAGS="-I$python_include"
 
    if test "$_os" = "Darwin"; then
       PYTHON_LIBS="-framework Python"
    else
-      PYTHON_LIBS="-lpython$python_version"
+      PYTHON_LIBS="-lpython$python_version $python_libs"
    fi
    
    dnl check if the headers really work:
@@@@ -3605,15 +3623,12 @@@@ if test -n "$with_system_db" -o -n "$with_system_libs"
 	test "$with_system_db" != "no"; then
     SYSTEM_DB=YES
     AC_MSG_RESULT([external])
-    AC_CHECK_HEADER(db.h, [ DB_INCLUDES=/usr/include ],
-        [
-             CFLAGS=-I/usr/include/db4
-             AC_CHECK_HEADER(db4/db.h,
-             [ DB_INCLUDES=/usr/include/db4 ],
-             [ AC_MSG_ERROR(no. install the db4 libraries) ], []+             )
-        ], []
+    AC_CHECK_HEADER(db4/db.h, [ DB_INCLUDES=${prefix}/include/db4 ],
+            [ AC_MSG_ERROR(no. install the db4 libraries) ], []
     )
     AC_MSG_CHECKING([whether db is at least 4.1])
+    save_CXXFLAGS=$CXXFLAGS
+    CXXFLAGS=-I$DB_INCLUDES
     for v in 1 2 3 4 5 6; do
        AC_TRY_RUN([
 #include <db.h>
@@@@ -3624,6 +3639,7 @@@@ int main(int argc, char **argv) {
 }
        ], [DB_VERSION_MINOR=$v], [])
     done
+    CXXFLAGS=$save_CXXFLAGS
     if test "$DB_VERSION_MINOR" -gt "1"; then
        AC_MSG_RESULT([OK])
        DB_VERSION=4.$DB_VERSION_MINOR
@@@@ -4199,11 +4215,11 @@@@ if test -n "$with_system_icu" -o -n "$with_system_libs
    if test -z "$SYSTEM_GENBRK"; then
       AC_MSG_ERROR([\"genbrk\" not found in \$PATH, install the icu development tool \"genbrk"\])
    fi
-   AC_PATH_PROG(SYSTEM_GENCCODE, genccode, [], [$PATH:/usr/sbin:/sbin])
+   AC_PATH_PROG(SYSTEM_GENCCODE, genccode, [], [$PATH:/usr/sbin:/sbin:/usr/local/sbin])
    if test -z "$SYSTEM_GENCCODE"; then
       AC_MSG_ERROR([\"genccode\" not found in \$PATH, install the icu development tool \"genccode"\])
    fi
-   AC_PATH_PROG(SYSTEM_GENCMN, gencmn, [], [$PATH:/usr/sbin:/sbin])
+   AC_PATH_PROG(SYSTEM_GENCMN, gencmn, [], [$PATH:/usr/sbin:/sbin:/usr/local/sbin])
    if test -z "$SYSTEM_GENCMN"; then
       AC_MSG_ERROR([\"gencmn\" not found in \$PATH, install the icu development tool \"gencmn"\])
    fi
@@@@ -4299,7 +4315,7 @@@@ elif test "$_os" != "WINNT" ; then
       AC_MSG_ERROR([No X includes found]) # Exit
    fi
    CFLAGS=$X_CFLAGS
-   LDFLAGS="$X_LDFLAGS $X_LIBS"
+   LDFLAGS="$LDFLAGS $X_LDFLAGS $X_LIBS"
    AC_CHECK_LIB(X11, XOpenDisplay, x_libs="-lX11 $X_EXTRA_LIBS", [AC_MSG_ERROR([X Development libraries not found])])
    dnl Check if the XauDisposeAuth symbol is provided by libXau.
    AC_CHECK_LIB(Xau, XauDisposeAuth, XAU_LIBS="-lXau", [])
@@@@ -4447,7 +4463,7 @@@@ if test -n "$with_system_openssl" -o -n "$with_system_
     AC_MSG_RESULT([external])
     # Mac OS builds should get out without extra stuff is the Mac porters'
     # wish. And pkg-config is although Xcode ships a .pc for openssl
-    if test "$_os" = "Darwin"; then
+    if test "$_os" = "Darwin" || test "$_os" = "OpenBSD"; then
         OPENSSL_CFLAGS=
         OPENSSL_LIBS="-lssl -lcrypto"
     else
@@@@ -5591,42 +5607,24 @@@@ KDE_LIBS=""
 MOC="moc"
 if test "$test_kde" = "yes" -a "$ENABLE_KDE" = "TRUE" ; then
     dnl Search paths for Qt and KDE
-    if test "$build_cpu" != "x86_64" ; then
-        qt_incdirs="$QTINC /usr/local/qt/include /usr/include/qt /usr/include /usr/X11R6/include/X11/qt /usr/X11R6/include/qt /usr/lib/qt3/include /usr/lib/qt/include /usr/share/qt3/include $x_includes"
-        qt_libdirs="$QTLIB /usr/local/qt/lib /usr/lib/qt /usr/lib /usr/X11R6/lib/X11/qt /usr/X11R6/lib/qt /usr/lib/qt3/lib /usr/lib/qt/lib /usr/share/qt3/lib $x_libraries"
-    else
-        qt_incdirs="$QTINC /usr/local/qt/include /usr/include/qt /usr/include /usr/X11R6/include/X11/qt /usr/X11R6/include/qt /usr/lib64/qt3/include /usr/lib64/qt/include /usr/share/qt3/include /usr/lib/qt3/include /usr/lib/qt/include $x_includes"
-        qt_libdirs="$QTLIB /usr/local/qt/lib64 /usr/lib64/qt /usr/lib64 /usr/X11R6/lib64/X11/qt /usr/X11R6/lib64/qt /usr/lib64/qt3/lib64 /usr/lib64/qt/lib64 /usr/share/qt3/lib64 /usr/local/qt/lib /usr/lib/qt /usr/lib /usr/X11R6/lib/X11/qt /usr/X11R6/lib/qt /usr/lib/qt3/lib /usr/lib/qt/lib /usr/share/qt3/lib $x_libraries"
-    fi
+    qt_incdirs="$QTINC /usr/local/qt/include /usr/include/qt /usr/include /usr/X11R6/include/X11/qt /usr/X11R6/include/qt /usr/lib/qt3/include /usr/lib/qt/include /usr/share/qt3/include /usr/lib/qt3/include /usr/lib/qt/include $x_includes"
+    qt_libdirs="$QTLIB /usr/local/qt/lib /usr/lib/qt /usr/lib /usr/X11R6/lib/X11/qt /usr/X11R6/lib/qt /usr/lib/qt3/lib /usr/lib/qt/lib /usr/share/qt3/lib /usr/local/qt/lib /usr/lib/qt /usr/lib /usr/X11R6/lib/X11/qt /usr/X11R6/lib/qt /usr/lib/qt3/lib /usr/lib/qt/lib /usr/share/qt3/lib $x_libraries"
     if test -n "$QTDIR" ; then
         qt_incdirs="$QTDIR/include $qt_incdirs"
-        if test "$build_cpu" != "x86_64" ; then
-            qt_libdirs="$QTDIR/lib $qt_libdirs"
-        else
-            qt_libdirs="$QTDIR/lib64 $QTDIR/lib $qt_libdirs"
-        fi
+	qt_libdirs="$QTDIR/lib $qt_libdirs"
     fi
-    if test "$build_cpu" != "x86_64" ; then
-        kde_incdirs="/usr/lib/kde/include /usr/local/kde/include /usr/local/include /usr/kde/include /usr/include/kde /usr/include /opt/kde3/include /opt/kde/include $x_includes"
-        kde_libdirs="/usr/lib/kde/lib /usr/local/kde/lib /usr/kde/lib /usr/lib/kde /usr/lib/kde3 /usr/lib /usr/X11R6/lib /usr/local/lib /opt/kde3/lib /opt/kde/lib /usr/X11R6/kde/lib $x_libraries"
-    else
-        kde_incdirs="/usr/lib64/kde/include /usr/lib/kde/include /usr/local/kde/include /usr/local/include /usr/kde/include /usr/include/kde /usr/include /opt/kde3/include /opt/kde/include $x_includes"
-        kde_libdirs="/usr/lib64/kde/lib64 /usr/local/kde/lib64 /usr/kde/lib64 /usr/lib64/kde /usr/lib64/kde3 /usr/lib64 /usr/X11R6/lib64 /usr/local/lib64 /opt/kde3/lib64 /opt/kde/lib64 /usr/X11R6/kde/lib64 /usr/lib/kde/lib /usr/local/kde/lib /usr/kde/lib /usr/lib/kde /usr/lib/kde3 /usr/lib /usr/X11R6/lib /usr/local/lib /opt/kde3/lib /opt/kde/lib /usr/X11R6/kde/lib $x_libraries"
+    kde_incdirs="/usr/lib/kde/include /usr/local/kde/include /usr/local/include /usr/kde/include /usr/include/kde /usr/include /opt/kde3/include /opt/kde/include $x_includes"
+    kde_libdirs="/usr/local/lib /usr/lib/kde/lib /usr/local/kde/lib /usr/kde/lib /usr/lib/kde /usr/lib/kde3 /usr/lib /usr/X11R6/lib /opt/kde3/lib /opt/kde/lib /usr/X11R6/kde/lib $x_libraries"
     fi
     if test -n "$KDEDIR" ; then
-        kde_incdirs="$KDEDIR/include $kde_incdirs"
-        if test "$build_cpu" != "x86_64" ; then
-            kde_libdirs="$KDEDIR/lib $kde_libdirs"
-        else
-            kde_libdirs="$KDEDIR/lib64 $KDEDIR/lib $kde_libdirs"
-        fi
+        kde_libdirs="$KDEDIR/lib $kde_libdirs"
     fi
 
     dnl What to test
     qt_test_include="qstyle.h"
-    qt_test_library="libqt-mt.so"
+    qt_test_library="libqt-mt.so*"
     kde_test_include="ksharedptr.h"
-    kde_test_library="libkdeui.so"
+    kde_test_library="libkdeui.so*"
 
     dnl Check for Qt headers
     AC_MSG_CHECKING([for Qt headers])
@@@@ -5647,7 +5645,7 @@@@ your Qt installation by exporting QTDIR before running
     AC_MSG_CHECKING([for Qt libraries])
     qt_libdir="no"
     for qt_check in $qt_libdirs ; do
-        if test -r "$qt_check/$qt_test_library" ; then
+	if test -r "`ls $qt_check/$qt_test_library | head -1`" ; then
             qt_libdir="$qt_check"
             break
         fi
@@@@ -5683,7 +5681,7 @@@@ your KDE installation by exporting KDEDIR before runni
     AC_MSG_CHECKING([for KDE libraries])
     kde_libdir="no"
     for kde_check in $kde_libdirs ; do
-        if test -r "$kde_check/$kde_test_library" ; then
+	if test -r "`ls $kde_check/$kde_test_library | head -1`" ; then
             kde_libdir="$kde_check"
             break
         fi
@@@@ -5697,7 +5695,7 @@@@ your KDE installation by exporting KDEDIR before runni
     dnl Set the variables
     KDE_CFLAGS="-I$qt_incdir -I$kde_incdir -DQT_CLEAN_NAMESPACE -DQT_THREAD_SUPPORT"
     KDE_LIBS="-L$kde_libdir -L$qt_libdir -lkdeui -lkdecore -lqt-mt"
-fi
+
 AC_SUBST(KDE_CFLAGS)
 AC_SUBST(KDE_LIBS)
 AC_SUBST(MOC)
@@@@ -5874,7 +5872,7 @@@@ AC_SUBST(WITH_WRITER2LATEX)
 AC_SUBST(SCPDEFS)
 
 AC_MSG_CHECKING([whether and how to use Xinerama])
-if test "$_os" = "Darwin"; then
+if test "$_os" = "Darwin" -o "$_os" = "OpenBSD"; then
    USE_XINERAMA=YES
    XINERAMA_LINK=dynamic
    AC_MSG_RESULT([yes])
@


1.2
log
@update to openoffice 3.0.1rc1;

this now builds with gcc4
@
text
@@


1.1
log
@Initial revision
@
text
@d1 3
a3 3
--- config_office/configure.in.orig.port	Mon Sep  1 13:47:37 2008
+++ config_office/configure.in	Sat Oct 25 19:44:32 2008
@@@@ -986,6 +986,18 @@@@
d22 10
a31 1
@@@@ -3115,6 +3127,9 @@@@
d41 1
a41 1
@@@@ -3441,7 +3456,7 @@@@
d50 1
a50 1
@@@@ -3561,12 +3576,13 @@@@
d65 1
a65 1
@@@@ -3605,15 +3621,12 @@@@
d85 1
a85 1
@@@@ -3624,6 +3637,7 @@@@
d93 1
a93 1
@@@@ -4199,11 +4213,11 @@@@
d107 1
a107 1
@@@@ -4299,7 +4313,7 @@@@
d116 1
a116 1
@@@@ -4447,7 +4461,7 @@@@
d125 1
a125 1
@@@@ -5591,42 +5605,24 @@@@
d176 1
a176 1
@@@@ -5647,7 +5643,7 @@@@
d185 1
a185 1
@@@@ -5683,7 +5679,7 @@@@
d194 1
a194 1
@@@@ -5697,7 +5693,7 @@@@
d203 1
a203 1
@@@@ -5874,7 +5870,7 @@@@
@


1.1.1.1
log
@Import of OpenOffice 3.0;

Currently it is a different port because it still needs a lot of work
and there are a lot of differences from openoffice2. It is not connected
to the build, and it's going to be merged with the openoffice2 port whenever
it's ready for use.
@
text
@@
