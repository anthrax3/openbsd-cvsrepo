head	1.5;
access;
symbols
	OPENBSD_6_0:1.5.0.6
	OPENBSD_6_0_BASE:1.5
	OPENBSD_5_9:1.5.0.2
	OPENBSD_5_9_BASE:1.5
	OPENBSD_5_8:1.5.0.4
	OPENBSD_5_8_BASE:1.5
	OPENBSD_5_7:1.4.0.2
	OPENBSD_5_7_BASE:1.4
	OPENBSD_5_6:1.3.0.4
	OPENBSD_5_6_BASE:1.3
	OPENBSD_5_5:1.3.0.2
	OPENBSD_5_5_BASE:1.3
	OPENBSD_5_4:1.2.0.4
	OPENBSD_5_4_BASE:1.2
	OPENBSD_5_3:1.2.0.2
	OPENBSD_5_3_BASE:1.2
	OPENBSD_5_2:1.1.1.1.0.2
	OPENBSD_5_2_BASE:1.1.1.1
	naddy_20120714:1.1.1.1
	naddy:1.1.1;
locks; strict;
comment	@# @;


1.5
date	2015.05.15.08.23.20;	author bentley;	state Exp;
branches;
next	1.4;
commitid	VtT085Zq0E6j8OEi;

1.4
date	2014.12.25.19.41.07;	author dcoppa;	state Exp;
branches;
next	1.3;
commitid	zJQvCiXYkA9dM00M;

1.3
date	2013.11.20.03.43.05;	author bentley;	state Exp;
branches;
next	1.2;

1.2
date	2012.10.13.08.13.51;	author dcoppa;	state Exp;
branches;
next	1.1;

1.1
date	2012.07.14.09.59.30;	author naddy;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2012.07.14.09.59.30;	author naddy;	state Exp;
branches;
next	;


desc
@@


1.5
log
@Update to nvi-2.1.3.

Release notes:
https://github.com/lichray/nvi2/releases/tag/v2.1.3
@
text
@$OpenBSD$
--- build/CMakeLists.txt.orig	Wed Apr  8 15:20:21 2015
+++ build/CMakeLists.txt	Fri May 15 02:21:10 2015
@@@@ -33,48 +33,48 @@@@ if(DEBUG)
 			"-Wno-unused-const-variable")
 	endif()
 	join("${_arg_str}" CMAKE_C_FLAGS)
-else(DEBUG)
-	set(_arg_str "${CMAKE_C_FLAGS} -ansi -O2"
-		"-Wuninitialized"
-		"-Wstack-protector -fstack-protector")
-	if("${CMAKE_C_COMPILER_ID}" STREQUAL "Clang")
-		set(_arg_str "${_arg_str}"
-			"-Wno-dangling-else"
-			# avoid the "argument unused" error in clang
-			"-Qunused-arguments")
-	endif()
-	join("${_arg_str}" CMAKE_C_FLAGS)
+#else(DEBUG)
+#	set(_arg_str "${CMAKE_C_FLAGS} -ansi -O2"
+#		"-Wuninitialized"
+#		"-Wstack-protector -fstack-protector")
+#	if("${CMAKE_C_COMPILER_ID}" STREQUAL "Clang")
+#		set(_arg_str "${_arg_str}"
+#			"-Wno-dangling-else"
+#			# avoid the "argument unused" error in clang
+#			"-Qunused-arguments")
+#	endif()
+#	join("${_arg_str}" CMAKE_C_FLAGS)
 endif(DEBUG)
 
 # commands to generate the public headers
 set(extract_protos sed -n 's/^ \\* PUBLIC: \\\(.*\\\)/\\1/p')
 set(extract_version sed -n
 	's/^.*version \\\([^\)]*\)\\\).*/\#define VI_VERSION \\\"\\1\\\"/p')
-add_custom_command(OUTPUT ../cl/extern.h
-	COMMAND ${extract_protos} ../cl/*.c > $@@
-	DEPENDS ../cl/*.c)
-add_custom_command(OUTPUT ../common/extern.h
-	COMMAND ${extract_protos} ../common/*.c > $@@
-	DEPENDS ../common/*.c)
-add_custom_command(OUTPUT ../ex/extern.h
-	COMMAND ${extract_protos} ../ex/*.c > $@@
-	DEPENDS ../ex/*.c)
-add_custom_command(OUTPUT ../vi/extern.h
-	COMMAND ${extract_protos} ../vi/*.c > $@@
-	DEPENDS ../vi/*.c)
-add_custom_command(OUTPUT ../common/options_def.h
-	COMMAND awk -f ../common/options.awk ../common/options.c > $@@
-	DEPENDS ../common/options.c)
-add_custom_command(OUTPUT ../ex/ex_def.h
-	COMMAND awk -f ../ex/ex.awk ../ex/ex_cmd.c > $@@
-	DEPENDS ../ex/ex_cmd.c)
-add_custom_command(OUTPUT ../ex/version.h
-	COMMAND ${extract_version} ../README > $@@
-	DEPENDS ../README)
+add_custom_command(OUTPUT cl_extern.h
+	COMMAND ${extract_protos} *.c > cl_extern.h
+	WORKING_DIRECTORY ../cl/)
+add_custom_command(OUTPUT common_extern.h
+	COMMAND ${extract_protos} *.c > common_extern.h
+	WORKING_DIRECTORY ../common/)
+add_custom_command(OUTPUT ex_extern.h
+	COMMAND ${extract_protos} *.c > ex_extern.h
+	WORKING_DIRECTORY ../ex/)
+add_custom_command(OUTPUT vi_extern.h
+	COMMAND ${extract_protos} *.c > vi_extern.h
+	WORKING_DIRECTORY ../vi/)
+add_custom_command(OUTPUT options_def.h
+	COMMAND awk -f options.awk options.c > options_def.h
+	WORKING_DIRECTORY ../common/)
+add_custom_command(OUTPUT ex_def.h
+	COMMAND awk -f ex.awk ex_cmd.c > ex_def.h
+	WORKING_DIRECTORY ../ex/)
+add_custom_command(OUTPUT version.h
+	COMMAND ${extract_version} ../README > version.h
+	WORKING_DIRECTORY ../ex/)
 
 set(MAIN_PROTOS
-	../cl/extern.h ../common/extern.h ../ex/extern.h ../vi/extern.h
-	../common/options_def.h ../ex/ex_def.h ../ex/version.h)
+	cl_extern.h common_extern.h ex_extern.h vi_extern.h
+	options_def.h ex_def.h version.h)
 FILE(GLOB MAIN_SRCS ../cl/*.c ../common/*.c ../ex/*.c ../vi/*.c)
 FILE(GLOB REGEX_SRCS ../regex/reg*.c)
 
@@@@ -157,6 +157,7 @@@@ configure_file(${CMAKE_SOURCE_DIR}/recover.in
 	${CMAKE_SOURCE_DIR}/recover @@ONLY)
 
 add_executable(nvi ${MAIN_SRCS} ${MAIN_PROTOS})
+add_dependencies(nvi headers)
 target_link_libraries(nvi ${CURSES_LIBRARY} ${UTIL_LIBRARY} ${RESOLV_LIBRARY})
 if(USE_WIDECHAR)
 	target_link_libraries(nvi regex)
@


1.4
log
@
Unbreak building nvi with CMake-3.1 (still works with 3.0.2)
Switch to ninja and remove "USE_NINJA=No"
@
text
@d1 6
a6 6
$OpenBSD: patch-build_CMakeLists_txt,v 1.3 2013/11/20 03:43:05 bentley Exp $
--- build/CMakeLists.txt.orig	Sat Nov  2 11:22:55 2013
+++ build/CMakeLists.txt	Wed Dec 24 15:38:18 2014
@@@@ -29,48 +29,48 @@@@ if(DEBUG)
 		"-Wstack-protector -fstack-protector"
 		"-Wstrict-aliasing -fstrict-aliasing")
d32 1
a32 7
 # generate the public headers
 add_custom_target(headers ALL DEPENDS
-	../cl/extern.h ../common/extern.h ../ex/extern.h ../vi/extern.h
-	../common/options_def.h ../ex/ex_def.h ../ex/version.h)
+	cl_extern.h common_extern.h ex_extern.h vi_extern.h
+	options_def.h ex_def.h version.h)
 
d79 5
d86 2
a87 1
@@@@ -154,6 +154,7 @@@@ configure_file(${CMAKE_SOURCE_DIR}/recover.in
d90 1
a90 1
 add_executable(nvi ${MAIN_SRCS})
@


1.3
log
@Update to nvi-2.1.2.
@
text
@d1 4
a4 4
$OpenBSD$
--- build/CMakeLists.txt.orig	Sat Nov 16 23:27:11 2013
+++ build/CMakeLists.txt	Sat Nov 16 23:27:18 2013
@@@@ -29,17 +29,17 @@@@ if(DEBUG)
d33 62
@


1.2
log
@Update to nvi-2.1.1

ok naddy@@ (maintainer)
@
text
@d1 6
a6 6
$OpenBSD: patch-build_CMakeLists_txt,v 1.1.1.1 2012/07/14 09:59:30 naddy Exp $
--- build/CMakeLists.txt.orig	Mon Oct  8 12:43:04 2012
+++ build/CMakeLists.txt	Mon Oct  8 12:45:53 2012
@@@@ -28,10 +28,10 @@@@ if(DEBUG)
 		"-fstack-protector -Wstack-protector"
 		"-fstrict-aliasing -Wstrict-aliasing")
d10 8
a17 1
-		"-Wuninitialized")
d21 8
a28 1
+#		"-Wuninitialized")
@


1.1
log
@Initial revision
@
text
@d1 5
a5 5
$OpenBSD$
--- build/CMakeLists.txt.orig	Fri Jul 13 23:11:17 2012
+++ build/CMakeLists.txt	Sat Jul 14 10:53:59 2012
@@@@ -26,10 +26,10 @@@@ if(DEBUG)
 		"-Wmissing-prototypes"
@


1.1.1.1
log
@Import nvi 2.1.0, a version of the base system vi/ex editor with wide
character (UTF-8) support.

Requested by yasuoka@@ and pirofti@@
@
text
@@
