head	1.3;
access;
symbols
	OPENBSD_2_8:1.2.0.6
	OPENBSD_2_8_BASE:1.2
	OPENBSD_2_7:1.2.0.4
	OPENBSD_2_7_BASE:1.2
	OPENBSD_2_6:1.2.0.2
	OPENBSD_2_6_BASE:1.2
	OPENBSD_2_5:1.1.0.6
	OPENBSD_2_5_BASE:1.1
	OPENBSD_2_4:1.1.0.4
	OPENBSD_2_4_BASE:1.1
	OPENBSD_2_3:1.1.0.2
	OPENBSD_2_3_BASE:1.1;
locks; strict;
comment	@# @;


1.3
date	2001.01.17.16.38.59;	author brad;	state dead;
branches;
next	1.2;

1.2
date	99.08.30.15.07.32;	author brad;	state Exp;
branches
	1.2.6.1;
next	1.1;

1.1
date	98.04.17.00.24.24;	author marc;	state Exp;
branches;
next	;

1.2.6.1
date	2001.01.17.16.42.12;	author brad;	state dead;
branches;
next	;


desc
@@


1.3
log
@fix symlink issues with joe. From: FreeBSD ports tree
@
text
@--- b.c.orig	Fri Jan 20 01:38:25 1995
+++ b.c	Mon Aug 30 09:04:50 1999
@@@@ -21,6 +21,7 @@@@
 #include <pwd.h>
 #endif
 #include <errno.h>
+#include <sys/types.h>
 
 #include "config.h"
 #include "blocks.h"
@@@@ -1630,7 +1631,7 @@@@
    if(x==1)
     {
     char *z;
-    s=getenv("HOME");
+    s=(char *)getenv("HOME");
     z=vsncpy(NULL,0,sz(s));
     z=vsncpy(z,sLEN(z),sz(n+x));
     vsrm(n);
@@@@ -1990,6 +1991,7 @@@@
  {
  long tim=time(0);
  B *b;
+ mode_t mask=umask(077); /* no access to DEADJOE for others */
  FILE *f=fopen("DEADJOE","a");
  fprintf(f,"\n*** Modified files in JOE when it aborted on %s",ctime(&tim));
  if(sig) fprintf(f,"*** JOE was aborted by signal %d\n",sig);
@


1.2
log
@close a security hole relating to a world-readable DEADJOE file; from FreeBSD
@
text
@@


1.2.6.1
log
@MFC:
fix symlink issues with joe. From: FreeBSD ports tree
@
text
@@


1.1
log
@patches and updated packing list close PR 435.
thangs to Oleg Form <form@@vs.itam.nsc.ru> for the patches.
@
text
@d1 27
a27 19
*** b.c.orig	Thu Apr 16 17:59:05 1998
--- b.c	Thu Apr 16 17:59:39 1998
***************
*** 1630,1636 ****
     if(x==1)
      {
      char *z;
!     s=getenv("HOME");
      z=vsncpy(NULL,0,sz(s));
      z=vsncpy(z,sLEN(z),sz(n+x));
      vsrm(n);
--- 1630,1636 ----
     if(x==1)
      {
      char *z;
!     s=(char *)getenv("HOME");
      z=vsncpy(NULL,0,sz(s));
      z=vsncpy(z,sLEN(z),sz(n+x));
      vsrm(n);
@

