head	1.10;
access;
symbols
	OPENBSD_6_0:1.7.0.2
	OPENBSD_6_0_BASE:1.7
	OPENBSD_5_9:1.6.0.2
	OPENBSD_5_9_BASE:1.6
	OPENBSD_3_4:1.2.0.8
	OPENBSD_3_4_BASE:1.2
	OPENBSD_3_3:1.2.0.6
	OPENBSD_3_3_BASE:1.2
	OPENBSD_3_2:1.2.0.4
	OPENBSD_3_2_BASE:1.2
	OPENBSD_3_1:1.2.0.2
	OPENBSD_3_1_BASE:1.2
	OPENBSD_3_0:1.1.0.6
	OPENBSD_3_0_BASE:1.1
	OPENBSD_2_9_TRACKING_SWITCH:1.1
	OPENBSD_2_9:1.1.0.4
	OPENBSD_2_9_BASE:1.1
	OPENBSD_2_8:1.1.0.2
	OPENBSD_2_8_BASE:1.1;
locks; strict;
comment	@# @;


1.10
date	2017.02.10.02.24.07;	author jca;	state Exp;
branches;
next	1.9;
commitid	trrcS8NOQ3Awa9XM;

1.9
date	2016.10.13.15.39.32;	author jca;	state Exp;
branches;
next	1.8;
commitid	68L59ECdgcBl8hgz;

1.8
date	2016.08.10.19.21.37;	author jca;	state Exp;
branches;
next	1.7;
commitid	dzKnNhDpaeFJ3aQn;

1.7
date	2016.06.02.16.32.47;	author jca;	state Exp;
branches;
next	1.6;
commitid	C5pyMkH3NhXaiAfM;

1.6
date	2015.11.13.20.33.31;	author jca;	state Exp;
branches;
next	1.5;
commitid	ptb41UXOMWY6x5O4;

1.5
date	2015.08.03.22.22.38;	author jca;	state dead;
branches;
next	1.4;
commitid	w9MmIWVed7EzgEcF;

1.4
date	2015.08.03.09.46.51;	author jca;	state Exp;
branches;
next	1.3;
commitid	y2h9ADEn6mfD3yc0;

1.3
date	2003.12.03.17.28.02;	author sturm;	state dead;
branches;
next	1.2;

1.2
date	2002.03.23.18.40.02;	author pvalchev;	state Exp;
branches;
next	1.1;

1.1
date	2000.10.21.17.29.54;	author brad;	state Exp;
branches;
next	;


desc
@@


1.10
log
@Don't use ld -Z on arm.
@
text
@$OpenBSD: patch-configure,v 1.9 2016/10/13 15:39:32 jca Exp $
--- configure.orig	Fri Sep 16 11:20:23 2016
+++ configure	Fri Feb 10 02:56:08 2017
@@@@ -9531,7 +9531,14 @@@@ case "$opsys" in
   openbsd)
    ## Han Boetes <han@@boetes.org> says this is necessary,
    ## otherwise Emacs dumps core on elf systems.
-   LD_SWITCH_SYSTEM="-Z"
+   ## Enable only where necessary.
+   case $host_cpu in
+     x86_64|sparc64|arm)
+      ;;
+     powerpc|mips64el|*)
+      LD_SWITCH_SYSTEM="-Z"
+      ;;
+   esac
    ;;
 esac
 
@


1.9
log
@Update to emacs-25.1

Announce: http://lists.gnu.org/archive/html/emacs-devel/2016-09/msg00451.html
NEWS file: https://www.gnu.org/software/emacs/news/NEWS.25.1

Fixes the focus problem seen with the gtk3 flavor.  The alignement fix
for sparc64 wasn't needed in 25.0.

Tested by Manuel Giraud, Ralf Horstmann (alpha), abieber@@ (macppc),
danj@@ (i386).  ok danj@@ abieber@@
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.8 2016/08/10 19:21:37 jca Exp $
d3 1
a3 1
+++ configure	Tue Sep 27 15:22:19 2016
d11 1
a11 1
+     x86_64|sparc64)
@


1.8
log
@Looks like powerpc doesn't need bss-plt layout anymore.

Thanks guenther@@ for the tests & report.
@
text
@d1 4
a4 4
$OpenBSD: patch-configure,v 1.7 2016/06/02 16:32:47 jca Exp $
--- configure.orig	Wed Apr  8 19:11:56 2015
+++ configure	Wed Aug 10 21:17:19 2016
@@@@ -9101,7 +9101,14 @@@@ case "$opsys" in
@


1.7
log
@Stop using ld -Z where it is not necessary.

amd64 and sparc64 are ok, powerpc and loongson are not.  Requested by
kettenis.
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.6 2015/11/13 20:33:31 jca Exp $
d3 2
a4 2
+++ configure	Thu Jun  2 18:31:04 2016
@@@@ -9101,7 +9101,17 @@@@ case "$opsys" in
a16 3
+
+   case $host_cpu in powerpc) LD_SWITCH_SYSTEM="-Wl,--bss-plt $LD_SWITCH_SYSTEM";; esac
+
@


1.6
log
@Disable the use of Secure PLT on powerpc, hinted by kettenis@@
@
text
@d1 5
a5 4
$OpenBSD$
--- configure.orig	Fri Nov 13 20:53:33 2015
+++ configure	Fri Nov 13 20:53:57 2015
@@@@ -9102,6 +9102,7 @@@@ case "$opsys" in
d8 10
a17 1
    LD_SWITCH_SYSTEM="-Z"
d19 1
@


1.5
log
@Remove patch; ld -Z is broken on powerpc
@
text
@d1 10
a10 15
$OpenBSD: patch-configure,v 1.4 2015/08/03 09:46:51 jca Exp $

- Don't try to run the tputs conftest, it segfaults for unknown reasons
  on at least hppa and powerpc.

--- configure.orig	Wed Apr  8 19:11:56 2015
+++ configure	Sun Aug  2 19:26:24 2015
@@@@ -15466,7 +15466,7 @@@@ else
       msg=$LIBS_TERMCAP
       LIBS="$LIBS_TERMCAP $LIBS"
     fi
-    if test "$cross_compiling" = yes; then :
+    if true; then :
   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@


1.4
log
@Don't try to run the tputs conftest; segfaults* on powerpc/hppa

* the actual reason is not known yet
@
text
@d1 1
a1 1
$OpenBSD$
@


1.3
log
@remove emacs 20 port as 21 is in-tree and works on all platforms that have
a working emacs 20, besides that emacs 20 was broken on sparc64, vax, hppa

emacs21 tested on most archs by pval (thanks!), rest by me
@
text
@d1 16
a16 13
$OpenBSD: patch-configure,v 1.2 2002/03/23 18:40:02 pvalchev Exp $
--- configure.orig	Mon Jun 12 14:05:56 2000
+++ configure	Sun Mar 17 20:33:50 2002
@@@@ -733,7 +733,8 @@@@ case "${canonical}" in
       m68k-*-openbsd*)  machine=hp9000s300 ;;
       mipsel-*-openbsd*) machine=pmax ;;
       ns32k-*-openbsd*)	machine=ns32000 ;;
-      sparc-*-openbsd*)	machine=sparc ;;
+      powerpc-*-openbsd*) machine=macppc ;;
+      sparc*-*-openbsd*) machine=sparc ;;
       vax-*-openbsd*)	machine=vax ;;
     esac
   ;;
@


1.2
log
@pieces for sparc64 (now it builds, but doesn't work yet), some taken from netbsd
@
text
@d1 1
a1 1
$OpenBSD$
@


1.1
log
@add support for the PowerPC port
@
text
@d1 4
a4 3
--- configure.orig	Fri Oct 20 16:00:28 2000
+++ configure	Fri Oct 20 16:01:43 2000
@@@@ -733,6 +733,7 @@@@
d8 1
d10 1
a10 1
       sparc-*-openbsd*)	machine=sparc ;;
d13 1
@

