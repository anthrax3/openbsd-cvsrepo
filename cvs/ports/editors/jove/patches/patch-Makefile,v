head	1.3;
access;
symbols
	OPENBSD_6_1:1.3.0.22
	OPENBSD_6_1_BASE:1.3
	OPENBSD_6_0:1.3.0.20
	OPENBSD_6_0_BASE:1.3
	OPENBSD_5_9:1.3.0.16
	OPENBSD_5_9_BASE:1.3
	OPENBSD_5_8:1.3.0.18
	OPENBSD_5_8_BASE:1.3
	OPENBSD_5_7:1.3.0.14
	OPENBSD_5_7_BASE:1.3
	OPENBSD_5_6:1.3.0.12
	OPENBSD_5_6_BASE:1.3
	OPENBSD_5_5:1.3.0.10
	OPENBSD_5_5_BASE:1.3
	OPENBSD_5_4:1.3.0.8
	OPENBSD_5_4_BASE:1.3
	OPENBSD_5_3:1.3.0.6
	OPENBSD_5_3_BASE:1.3
	OPENBSD_5_2:1.3.0.4
	OPENBSD_5_2_BASE:1.3
	OPENBSD_5_1_BASE:1.3
	OPENBSD_5_1:1.3.0.2
	OPENBSD_5_0:1.2.0.22
	OPENBSD_5_0_BASE:1.2
	OPENBSD_4_9:1.2.0.20
	OPENBSD_4_9_BASE:1.2
	OPENBSD_4_8:1.2.0.18
	OPENBSD_4_8_BASE:1.2
	OPENBSD_4_7:1.2.0.16
	OPENBSD_4_7_BASE:1.2
	OPENBSD_4_6:1.2.0.14
	OPENBSD_4_6_BASE:1.2
	OPENBSD_4_5:1.2.0.12
	OPENBSD_4_5_BASE:1.2
	OPENBSD_4_4:1.2.0.10
	OPENBSD_4_4_BASE:1.2
	OPENBSD_4_3:1.2.0.8
	OPENBSD_4_3_BASE:1.2
	OPENBSD_4_2:1.2.0.6
	OPENBSD_4_2_BASE:1.2
	OPENBSD_4_1:1.2.0.4
	OPENBSD_4_1_BASE:1.2
	OPENBSD_4_0:1.2.0.2
	OPENBSD_4_0_BASE:1.2;
locks; strict;
comment	@# @;


1.3
date	2011.11.11.20.08.40;	author jasper;	state Exp;
branches;
next	1.2;

1.2
date	2006.04.09.11.10.09;	author alek;	state Exp;
branches;
next	1.1;

1.1
date	2006.04.09.10.10.25;	author alek;	state Exp;
branches;
next	;


desc
@@


1.3
log
@- update to 4.16.0.73
- adjust license marker
@
text
@$OpenBSD: patch-Makefile,v 1.2 2006/04/09 11:10:09 alek Exp $
--- Makefile.orig	Wed May 26 06:46:38 2010
+++ Makefile	Fri Nov 11 20:59:04 2011
@@@@ -21,9 +21,9 @@@@ SHELL = /bin/sh
 # If they don't exist, this makefile will try to create the directories
 # LIBDIR and SHAREDIR.  All others must already exist.
 
-JOVEHOME = /usr/local
-SHAREDIR = $(JOVEHOME)/lib/jove
-LIBDIR = $(JOVEHOME)/lib/jove
+JOVEHOME = ${PREFIX}
+SHAREDIR = $(JOVEHOME)/share/jove
+LIBDIR = $(JOVEHOME)/libexec/jove
 BINDIR = $(JOVEHOME)/bin
 XEXT=
 MANDIR = $(JOVEHOME)/man/man$(MANEXT)
@@@@ -56,14 +56,16 @@@@ DFLTSHELL = /bin/csh
 INSTALLFLAGS = # -g bin -o root
 
 # to install executable files
-XINSTALL=cp
+#XINSTALL=cp
 #XINSTALL=/usr/ucb/install $(INSTALLFLAGS) -c -m 755 # -s
 #CYGWIN32: XINSTALL=install $(INSTALLFLAGS) -c -m 755
+XINSTALL=${BSD_INSTALL_PROGRAM}
 
 # to install text files
-TINSTALL=cp
+#TINSTALL=cp
 #TINSTALL=/usr/ucb/install $(INSTALLFLAGS) -c -m 644
 #CYGWIN32: TINSTALL=install $(INSTALLFLAGS) -c -m 644
+TINSTALL=${BSD_INSTALL_DATA}
 
 # These should all just be right if the above ones are.
 # You will confuse JOVE if you move anything from LIBDIR or SHAREDIR.
@@@@ -138,6 +140,7 @@@@ JOVETOOLM = $(MANDIR)/jovetool.$(MANEXT)
 # to exit using exit(), instead of _exit()).
 
 SYSDEFS = -DBSDPOSIX_STDC
+#SYSDEFS = -DBSDPOSIX
 
 # Select optimization level (flags passed to compiling and linking steps).
 # On most systems: -g for debugging, -O for optimization.
@@@@ -146,7 +149,7 @@@@ SYSDEFS = -DBSDPOSIX_STDC
 # On DEC OSF/1 and Digital UNIX VV4.0, add -std1 to enable ANSI C features
 # and perhaps -g3 for more debugging info with optimization.
 
-OPTFLAGS = -O
+#OPTFLAGS = -O
 
 # For making dependencies under BSD systems
 DEPENDFLAG = -M
@@@@ -181,13 +184,13 @@@@ EXTRALIBS =
 #	PDP-11 with separate I&D: -i
 #	PDP-11 without separate I&D: -n
 
-LDFLAGS =
+#LDFLAGS =
 
 # for SCO Xenix, set
 #	MEMFLAGS = -Mle
 #	CFLAGS = -LARGE -O -F 3000 -K -Mle  (say -Mle2 for an 80286)
 
-CFLAGS = $(OPTFLAGS) $(SYSDEFS)
+CFLAGS += $(SYSDEFS)
 
 # For SYSVR4 (/usr/ucb/cc will NOT work because of setjmp.h):
 #	CC = /usr/bin/cc
@@@@ -236,7 +239,7 @@@@ NROFF = nroff
 TROFF = troff -Tpost
 TROFFPOST = | /usr/lib/lp/postscript/dpost -
 
-MANUALS = $(JOVEM) $(TEACHJOVEM) $(XJOVEM) $(JOVETOOLM)
+MANUALS = $(JOVEM) $(TEACHJOVEM) # $(XJOVEM) $(JOVETOOLM)
 
 C_SRC = commands.c commands.tab abbrev.c argcount.c ask.c buf.c c.c case.c jctype.c \
 	delete.c disp.c extend.c fp.c fmt.c insert.c io.c iproc.c \
@@@@ -362,8 +365,12 @@@@ install: $(LIBDIR) $(SHAREDIR) \
 	 $(TEACH-JOVE) $(CMDS.DOC) $(TERMSDIR)docs \
 	 $(PORTSRVINST) $(RECOVER) $(JOVE) $(TEACHJOVE) $(MANUALS)
 	$(TINSTALL) doc/jove.rc $(JOVERC)
-	@@echo See the README about changes to /etc/rc or /etc/rc.local
-	@@echo so that the system recovers jove files on reboot after a crash
+	$(TINSTALL) README $(SHAREDIR)
+	@@echo ""
+	@@echo "*** See $(SHAREDIR)/README about changes to /etc/rc or"
+	@@echo "*** /etc/rc.local so that the system recovers jove files"
+	@@echo "*** on reboot after a system crash"
+	@@echo ""
 
 $(LIBDIR)::
 	test -d $(LIBDIR) || mkdir -p $(LIBDIR)
@


1.2
log
@- Fix manpages; from Antti Nykänen <aon@@iki.fi>
- Fix potential out-of-bounds memory access
- Bump PKGNAME
@
text
@d1 5
a5 4
$OpenBSD: patch-Makefile,v 1.1 2006/04/09 10:10:25 alek Exp $
--- Makefile.orig	Tue Mar 19 06:44:33 1996
+++ Makefile	Mon Mar 13 08:51:30 2006
@@@@ -27,16 +27,16 @@@@
a7 5
 SHELL = /bin/sh
-TMPDIR = /usr/tmp
+TMPDIR = /var/tmp
 RECDIR = /usr/preserve
 
d15 1
d17 1
a17 7
 MANEXT = 1
-DFLTSHELL = /bin/csh
+DFLTSHELL = /bin/sh
 
 # The install commands of BSD and System V differ in unpleasant ways:
 # -c: copy (BSD); -c dir: destination directory (SysV)
@@@@ -50,12 +50,12 @@@@ DFLTSHELL = /bin/csh
a21 1
-#XINSTALL=/usr/ucb/install $(INSTALLFLAGS) -c -m 755 # -s
d23 2
a28 1
-#TINSTALL=/usr/ucb/install $(INSTALLFLAGS) -c -m 644
d30 2
d36 11
a46 3
@@@@ -79,7 +79,7 @@@@ JOVETOOLM = $(MANDIR)/jovetool.$(MANEXT)
 # compiler, adding -Xa -v will increase compiler checking.
 # On DEC OSF/1, -std1 -O
d53 2
a54 1
@@@@ -115,7 +115,7 @@@@ LIBS = -ltermcap
a56 1
 
a59 9
 # define a symbol for your OS if it hasn't got one.  See sysdep.h.
 # Jove has very few defaults, you will almost certainly need to define
@@@@ -163,13 +163,13 @@@@ LDFLAGS =
 #
 # You can just say 'make SYSDEFS=-Dwhatever' on these systems.
 
-SYSDEFS =
+SYSDEFS = -DBSDPOSIX
 
d68 2
a69 2
 # CC = /usr/bin/cc
@@@@ -213,7 +213,7 @@@@ NROFF = nroff
d71 1
a71 1
 TROFFPOST = | /usr/lib/lp/postscript/dpost - >troff.out.ps
d78 1
a78 1
@@@@ -329,8 +329,12 @@@@ install: $(LIBDIR) $(SHAREDIR) \
d92 1
a92 52
 	test -d $(LIBDIR) || mkdir $(LIBDIR)
@@@@ -373,11 +377,10 @@@@ $(TEACHJOVE): teachjove
 
 $(JOVEM): doc/jove.nr
 	@@sed -e 's;<TMPDIR>;$(TMPDIR);' \
-	     -e 's;<LIBDIR>;$(LIBDIR);' \
-	     -e 's;<SHAREDIR>;$(SHAREDIR);' \
-	     -e 's;<SHELL>;$(DFLTSHELL);' doc/jove.nr > /tmp/jove.nr
-	$(TINSTALL) /tmp/jove.nr $(JOVEM)
-	rm /tmp/jove.nr
+	     -e 's;<LIBDIR>;${LOCALBASE}/libexec/jove;' \
+	     -e 's;<SHAREDIR>;${LOCALBASE}/share/jove;' \
+	     -e 's;<SHELL>;$(DFLTSHELL);' doc/jove.nr > jove.$(MANEXT)
+	$(TINSTALL) jove.$(MANEXT) $(JOVEM)
 
 # doc/jove.doc is the formatted manpage (only needed by DOS)
 # Building it should be like building $(JOVEM) except that we
@@@@ -389,20 +392,18 @@@@ doc/jove.doc: doc/jove.nr
 
 $(TEACHJOVEM): doc/teachjove.nr
 	@@sed -e 's;<TMPDIR>;$(TMPDIR);' \
-	     -e 's;<LIBDIR>;$(LIBDIR);' \
-	     -e 's;<SHAREDIR>;$(SHAREDIR);' \
-	     -e 's;<SHELL>;$(DFLTSHELL);' doc/teachjove.nr > /tmp/teachjove.nr
-	$(TINSTALL) /tmp/teachjove.nr $(TEACHJOVEM)
-	rm /tmp/teachjove.nr
+	     -e 's;<LIBDIR>;${LOCALBASE}/libexec/jove;' \
+	     -e 's;<SHAREDIR>;${LOCALBASE}/share/jove;' \
+	     -e 's;<SHELL>;$(DFLTSHELL);' doc/teachjove.nr > teachjove.$(MANEXT)
+	$(TINSTALL) teachjove.$(MANEXT) $(TEACHJOVEM)
 
 $(XJOVEM): doc/xjove.nr
 	$(TINSTALL) doc/xjove.nr $(XJOVEM)
 
 $(JOVETOOLM): doc/jovetool.nr
 	@@sed -e 's;<MANDIR>;$(MANDIR);' \
-	     -e 's;<MANEXT>;$(MANEXT);' doc/jovetool.nr > /tmp/jovetool.nr
-	$(TINSTALL) /tmp/jovetool.nr $(JOVETOOLM)
-	rm /tmp/jovetool.nr
+	     -e 's;<MANEXT>;$(MANEXT);' doc/jovetool.nr > jovetool.$(MANEXT)
+	$(TINSTALL) jovetool.$(MANEXT) $(JOVETOOLM)
 
 echo:
 	@@echo $(C-FILES) $(HEADERS)
@@@@ -500,6 +501,7 @@@@ clean:
 	rm -f a.out core *.o keys.c jjove portsrv recover setmaps \
 		teachjove paths.h \#* *~ make.log *.map jjove.ico \
 		doc/cmds.doc doc/jove.man doc/jove.doc doc/troff.out.ps \
+		jove.$(MANEXT) teachjove.$(MANEXT) jovetool.$(MANEXT) \
 		jjove.pure_* tags ID .filelist
 
 cleanall: clean
@


1.1
log
@Regen patches
@
text
@d1 3
a3 3
$OpenBSD$
--- Makefile.orig	Tue Mar 19 05:44:33 1996
+++ Makefile	Sun Apr  9 12:05:56 2006
d101 3
a103 1
@@@@ -375,9 +379,8 @@@@ $(JOVEM): doc/jove.nr
d105 2
a106 2
 	     -e 's;<LIBDIR>;$(LIBDIR);' \
 	     -e 's;<SHAREDIR>;$(SHAREDIR);' \
d110 2
d117 3
a119 1
@@@@ -391,18 +394,16 @@@@ $(TEACHJOVEM): doc/teachjove.nr
d121 2
a122 2
 	     -e 's;<LIBDIR>;$(LIBDIR);' \
 	     -e 's;<SHAREDIR>;$(SHAREDIR);' \
d126 2
@

