head	1.2;
access;
symbols;
locks; strict;
comment	@# @;


1.2
date	2005.07.27.18.37.27;	author naddy;	state dead;
branches;
next	1.1;

1.1
date	2005.07.24.11.28.58;	author espie;	state Exp;
branches;
next	;


desc
@@


1.2
log
@SECURITY:
Update to 6.3.85, which fixes a vulnerability to modelines that execute
arbitrary shell commands.
http://www.guninski.com/where_do_you_want_billg_to_go_today_5.html

From: maintainer Chris Kuethe <chris.kuethe@@gmail.com>
@
text
@$OpenBSD: patch-src_syntax_c,v 1.1 2005/07/24 11:28:58 espie Exp $
--- src/syntax.c.orig	Sun Jul 24 13:07:37 2005
+++ src/syntax.c	Sun Jul 24 13:22:49 2005
@@@@ -2347,8 +2347,8 @@@@ check_state_ends()
 		 * "skipempty" */
 		current_next_list = cur_si->si_next_list;
 		current_next_flags = cur_si->si_flags;
-		if (!(current_next_flags & (HL_SKIPNL | HL_SKIPEMPTY))
-			&& syn_getcurline()[current_col] == NUL)
+		if (!(current_next_flags & (HL_SKIPNL | HL_SKIPEMPTY)) 
+			&& STRLEN(syn_getcurline()) <= current_col)
 		    current_next_list = NULL;
 
 		/* When the ended item has "extend", another item with
@


1.1
log
@fix a segfault.
Properly reported to vim's author.
@
text
@d1 1
a1 1
$OpenBSD$
@

