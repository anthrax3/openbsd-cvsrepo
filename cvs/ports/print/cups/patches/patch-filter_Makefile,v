head	1.14;
access;
symbols
	OPENBSD_6_1:1.14.0.2
	OPENBSD_6_1_BASE:1.14
	OPENBSD_6_0:1.13.0.8
	OPENBSD_6_0_BASE:1.13
	OPENBSD_5_9:1.13.0.4
	OPENBSD_5_9_BASE:1.13
	OPENBSD_5_8:1.13.0.6
	OPENBSD_5_8_BASE:1.13
	OPENBSD_5_7:1.13.0.2
	OPENBSD_5_7_BASE:1.13
	OPENBSD_5_6:1.12.0.4
	OPENBSD_5_6_BASE:1.12
	OPENBSD_5_5:1.12.0.2
	OPENBSD_5_5_BASE:1.12
	OPENBSD_5_4:1.11.0.4
	OPENBSD_5_4_BASE:1.11
	OPENBSD_5_3:1.11.0.2
	OPENBSD_5_3_BASE:1.11
	OPENBSD_5_2:1.10.0.2
	OPENBSD_5_2_BASE:1.10
	OPENBSD_5_1_BASE:1.9
	OPENBSD_5_1:1.9.0.2
	OPENBSD_5_0:1.8.0.6
	OPENBSD_5_0_BASE:1.8
	OPENBSD_4_9:1.8.0.4
	OPENBSD_4_9_BASE:1.8
	OPENBSD_4_8:1.8.0.2
	OPENBSD_4_8_BASE:1.8
	OPENBSD_4_7:1.6.0.4
	OPENBSD_4_7_BASE:1.6
	OPENBSD_4_6:1.6.0.2
	OPENBSD_4_6_BASE:1.6
	OPENBSD_4_5:1.4.0.8
	OPENBSD_4_5_BASE:1.4
	OPENBSD_4_4:1.4.0.6
	OPENBSD_4_4_BASE:1.4
	OPENBSD_4_3:1.4.0.4
	OPENBSD_4_3_BASE:1.4
	OPENBSD_4_2:1.4.0.2
	OPENBSD_4_2_BASE:1.4
	OPENBSD_4_1:1.3.0.2
	OPENBSD_4_1_BASE:1.3
	OPENBSD_4_0:1.2.0.4
	OPENBSD_4_0_BASE:1.2
	OPENBSD_3_9:1.2.0.2
	OPENBSD_3_9_BASE:1.2
	OPENBSD_3_8:1.1.1.1.0.4
	OPENBSD_3_8_BASE:1.1.1.1
	OPENBSD_3_7:1.1.1.1.0.2
	OPENBSD_3_7_BASE:1.1.1.1
	cups_20050116:1.1.1.1
	mbalmer:1.1.1;
locks; strict;
comment	@# @;


1.14
date	2016.09.19.09.16.51;	author ajacoutot;	state Exp;
branches;
next	1.13;
commitid	5ZKBoypll2THXP84;

1.13
date	2014.11.15.10.22.23;	author ajacoutot;	state Exp;
branches;
next	1.12;
commitid	20oo4Dj2S2v31rH3;

1.12
date	2013.10.27.08.50.17;	author ajacoutot;	state Exp;
branches;
next	1.11;

1.11
date	2012.08.04.14.37.04;	author ajacoutot;	state Exp;
branches;
next	1.10;

1.10
date	2012.02.16.22.12.08;	author ajacoutot;	state Exp;
branches;
next	1.9;

1.9
date	2011.09.08.10.33.12;	author ajacoutot;	state Exp;
branches;
next	1.8;

1.8
date	2010.06.27.04.18.50;	author ajacoutot;	state Exp;
branches;
next	1.7;

1.7
date	2010.03.31.16.20.02;	author ajacoutot;	state Exp;
branches;
next	1.6;

1.6
date	2009.05.19.11.15.28;	author ajacoutot;	state Exp;
branches;
next	1.5;

1.5
date	2009.04.27.08.25.39;	author bernd;	state Exp;
branches;
next	1.4;

1.4
date	2007.05.07.13.58.07;	author ajacoutot;	state Exp;
branches;
next	1.3;

1.3
date	2006.10.01.10.43.38;	author mbalmer;	state Exp;
branches;
next	1.2;

1.2
date	2006.02.05.10.20.57;	author mbalmer;	state Exp;
branches;
next	1.1;

1.1
date	2005.01.16.12.36.50;	author mbalmer;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2005.01.16.12.36.50;	author mbalmer;	state Exp;
branches;
next	;


desc
@@


1.14
log
@Update to cups-2.2.0.
@
text
@$OpenBSD: patch-filter_Makefile,v 1.13 2014/11/15 10:22:23 ajacoutot Exp $
--- filter/Makefile.orig	Wed Sep 14 01:39:47 2016
+++ filter/Makefile	Sat Sep 17 15:26:03 2016
@@@@ -232,12 +232,10 @@@@ gziptoany:	gziptoany.o ../Makedefs ../cups/$(LIBCUPS)
 # libcupsimage.so.2, libcupsimage.sl.2
 #
 
-libcupsimage.so.2 libcupsimage.sl.2:	$(IMAGEOBJS)
+libcupsimage.so.${LIBcupsimage_VERSION} libcupsimage.sl.2:	$(IMAGEOBJS)
 	echo Linking $@@...
 	$(DSO) $(ARCHFLAGS) $(DSOFLAGS) -o $@@ $(IMAGEOBJS) $(DSOLIBS) \
 		-L../cups $(LINKCUPS)
-	$(RM) `basename $@@ .2`
-	$(LN) $@@ `basename $@@ .2`
 
 
 #
@


1.13
log
@Major update to cups-2.0.1.
@
text
@d1 4
a4 4
$OpenBSD: patch-filter_Makefile,v 1.12 2013/10/27 08:50:17 ajacoutot Exp $
--- filter/Makefile.orig	Wed May 29 13:51:34 2013
+++ filter/Makefile	Fri Oct  3 16:01:21 2014
@@@@ -266,12 +266,10 @@@@ gziptoany:	gziptoany.o ../Makedefs ../cups/$(LIBCUPS)
@


1.12
log
@Update to cups-1.7.0.
Please report any regression directly to me, thanks.
@
text
@d1 1
a1 1
$OpenBSD: patch-filter_Makefile,v 1.11 2012/08/04 14:37:04 ajacoutot Exp $
d3 3
a5 18
+++ filter/Makefile	Sun Oct 27 09:01:11 2013
@@@@ -129,10 +129,6 @@@@ install-headers:
 install-libs: $(INSTALLSTATIC)
 	$(INSTALL_DIR) -m 755 $(LIBDIR)
 	$(INSTALL_LIB) $(LIBCUPSIMAGE) $(LIBDIR)
-	-if test $(LIBCUPSIMAGE) = "libcupsimage.so.2" -o $(LIBCUPSIMAGE) = "libcupsimage.sl.2"; then \
-		$(RM) $(LIBDIR)/`basename $(LIBCUPSIMAGE) .2`; \
-		$(LN) $(LIBCUPSIMAGE) $(LIBDIR)/`basename $(LIBCUPSIMAGE) .2`; \
-	fi
 	-if test $(LIBCUPSIMAGE) = "libcupsimage.2.dylib"; then \
 		$(RM) $(LIBDIR)/libcupsimage.dylib; \
 		$(LN) $(LIBCUPSIMAGE) $(LIBDIR)/libcupsimage.dylib; \
@@@@ -263,15 +259,13 @@@@ gziptoany:	gziptoany.o ../Makedefs ../cups/$(LIBCUPS)
 
 
 #
-# libcupsimage.so.2, libcupsimage.sl.2
+# libcupsimage.so.${LIBcupsimage_VERSION}, libcupsimage.sl.2
@


1.11
log
@Major update to CUPS 1.6.1.
This package is now split between -main (the bloat) and -libs (i.e.
cups-libs; which only contains the base libraries which have no
external deps).
Most filters have moved to cups-filters, the split was needed because
cups depends on cups-filters which depends on cups

The nice side-effect is that this will simplify lots of things in tree.
@
text
@d1 4
a4 4
$OpenBSD: patch-filter_Makefile,v 1.9 2011/09/08 10:33:12 ajacoutot Exp $
--- filter/Makefile.orig	Fri Jan 20 20:00:32 2012
+++ filter/Makefile	Sat Feb  4 11:17:08 2012
@@@@ -128,10 +128,6 @@@@ install-headers:
d15 1
a15 1
@@@@ -261,15 +257,13 @@@@ gziptoany:	gziptoany.o ../Makedefs ../cups/$(LIBCUPS)
@


1.10
log
@Update to cups-1.5.2.
While here, create cups's printcap under /etc/cups/ because we are
running unpriviledged so we cannot touch /etc/printcap.
Tweak rc script accordingly.
@
text
@d2 4
a5 4
--- filter/Makefile.orig	Fri Sep  9 18:34:29 2011
+++ filter/Makefile	Mon Feb  6 11:18:46 2012
@@@@ -150,10 +150,6 @@@@ install-headers:
 install-libs: $(INSTALLSTATIC) $(INSTALL32) $(INSTALL64)
d15 1
a15 42
@@@@ -171,13 +167,13 @@@@ installstatic:
 
 install32bit:
 	$(INSTALL_DIR) -m 755 $(LIB32DIR)
-	$(INSTALL_LIB) 32bit/libcupsimage.so.2 $(LIB32DIR)/libcupsimage.so.2
-	$(LN) libcupsimage.so.2 $(LIB32DIR)/libcupsimage.so
+	$(INSTALL_LIB) 32bit/libcupsimage.so.${LIBcupsimage_VERSION} $(LIB32DIR)/libcupsimage.so.${LIBcupsimage_VERSION}
+	$(LN) libcupsimage.so.${LIBcupsimage_VERSION} $(LIB32DIR)/libcupsimage.so
 
 install64bit:
 	$(INSTALL_DIR) -m 755 $(LIB64DIR)
-	$(INSTALL_LIB) 64bit/libcupsimage.so.2 $(LIB64DIR)/libcupsimage.so.2
-	$(LN) libcupsimage.so.2 $(LIB64DIR)/libcupsimage.so
+	$(INSTALL_LIB) 64bit/libcupsimage.so.${LIBcupsimage_VERSION} $(LIB64DIR)/libcupsimage.so.${LIBcupsimage_VERSION}
+	$(LN) libcupsimage.so.${LIBcupsimage_VERSION} $(LIB64DIR)/libcupsimage.so
 
 
 #
@@@@ -198,19 +194,19 @@@@ uninstall: $(UNINSTALL32) $(UNINSTALL64)
 	$(RM) $(LIBDIR)/libcupsimage.sl
 	$(RM) $(LIBDIR)/libcupsimage.sl.2
 	$(RM) $(LIBDIR)/libcupsimage.so
-	$(RM) $(LIBDIR)/libcupsimage.so.2
+	$(RM) $(LIBDIR)/libcupsimage.so.${LIBcupsimage_VERSION}
 	-$(RMDIR) $(LIBDIR)
 	$(RM) $(INCLUDEDIR)/cups/image.h
 	-$(RMDIR) $(INCLUDEDIR)/cups
 
 uninstall32bit:
 	$(RM) $(LIB32DIR)/libcupsimage.so
-	$(RM) $(LIB32DIR)/libcupsimage.so.2
+	$(RM) $(LIB32DIR)/libcupsimage.so.${LIBcupsimage_VERSION}
 	-$(RMDIR) $(LIB32DIR)
 
 uninstall64bit:
 	$(RM) $(LIB64DIR)/libcupsimage.so
-	$(RM) $(LIB64DIR)/libcupsimage.so.2
+	$(RM) $(LIB64DIR)/libcupsimage.so.${LIBcupsimage_VERSION}
 	-$(RMDIR) $(LIB64DIR)
 
 
@@@@ -315,22 +311,20 @@@@ gziptoany:	gziptoany.o ../Makedefs ../cups/$(LIBCUPS)
a32 22
-# 32bit/libcupsimage.so.2
+# 32bit/libcupsimage.so.${LIBcupsimage_VERSION}
 #
 
-32bit/libcupsimage.so.2:	$(IMAGE32OBJS)
+32bit/libcupsimage.so.${LIBcupsimage_VERSION}:	$(IMAGE32OBJS)
 	echo Linking 32-bit $@@...
 	-mkdir 32bit
 	$(DSO) $(ARCH32FLAGS) $(DSO32FLAGS) -o $@@ $(IMAGE32OBJS) $(DSOLIBS) \
@@@@ -338,10 +332,10 @@@@ libcupsimage.so.2 libcupsimage.sl.2:	$(IMAGEOBJS)
 
 
 #
-# 64bit/libcupsimage.so.2
+# 64bit/libcupsimage.so.${LIBcupsimage_VERSION}
 #
 
-64bit/libcupsimage.so.2:	$(IMAGE64OBJS)
+64bit/libcupsimage.so.${LIBcupsimage_VERSION}:	$(IMAGE64OBJS)
 	echo Linking 64-bit $@@...
 	-mkdir 64bit
 	$(DSO) $(ARCH64FLAGS) $(DSO64FLAGS) -o $@@ $(IMAGE64OBJS) $(DSOLIBS) \
@


1.9
log
@Major update to cups-1.5.0.

Thanks to landry@@ for the bulk testing.
@
text
@d1 3
a3 3
$OpenBSD: patch-filter_Makefile,v 1.8 2010/06/27 04:18:50 ajacoutot Exp $
--- filter/Makefile.orig	Fri Apr  1 07:55:27 2011
+++ filter/Makefile	Fri Sep  2 09:33:11 2011
d68 1
a68 1
 		-L../cups $(LINKCUPS) -lm
@


1.8
log
@Update to cups-1.4.4.
Fixes several security, scheduler, printing, and conformance issues.
@
text
@d1 4
a4 4
$OpenBSD: patch-filter_Makefile,v 1.7 2010/03/31 16:20:02 ajacoutot Exp $
--- filter/Makefile.orig	Fri Apr 23 20:56:34 2010
+++ filter/Makefile	Sun Jun 27 06:09:50 2010
@@@@ -153,10 +153,6 @@@@ install-headers:
d15 1
a15 1
@@@@ -174,13 +170,13 @@@@ installstatic:
d33 1
a33 1
@@@@ -201,19 +197,19 @@@@ uninstall: $(UNINSTALL32) $(UNINSTALL64)
d56 1
a56 1
@@@@ -324,22 +320,20 @@@@ hpgltops:	$(HPGLOBJS) common.o ../cups/$(LIBCUPS)
d83 1
a83 1
@@@@ -347,10 +341,10 @@@@ libcupsimage.so.2 libcupsimage.sl.2:	$(IMAGEOBJS)
@


1.7
log
@Major update to cups-1.4.3.
Changelog is to big to detail here, refer to HOMEPAGE for details.

I have been using 1.4.X for several months.
Versions 1.4.0 and 1.4.2 have been tested in bulks by jasper@@, thanks!

Please contact me directly if you see regressions.
@
text
@d1 3
a3 3
$OpenBSD$
--- filter/Makefile.orig	Wed May 27 01:27:06 2009
+++ filter/Makefile	Sun Aug 30 16:46:22 2009
d15 1
a15 1
@@@@ -170,13 +166,13 @@@@ installstatic:
d33 1
a33 1
@@@@ -197,19 +193,19 @@@@ uninstall: $(UNINSTALL32) $(UNINSTALL64)
d56 1
a56 1
@@@@ -320,22 +316,20 @@@@ hpgltops:	$(HPGLOBJS) common.o ../cups/$(LIBCUPS)
d83 1
a83 1
@@@@ -343,10 +337,10 @@@@ libcupsimage.so.2 libcupsimage.sl.2:	$(IMAGEOBJS)
@


1.6
log
@- don't link .so to .so.X.Y
- merge PFRAG.shared into PLIST
- bump
@
text
@d1 5
a5 14
$OpenBSD: patch-filter_Makefile,v 1.5 2009/04/27 08:25:39 bernd Exp $
--- filter/Makefile.orig	Thu Mar 12 22:34:21 2009
+++ filter/Makefile	Tue May 19 12:49:32 2009
@@@@ -57,7 +57,7 @@@@ all:	$(TARGETS)
 
 clean:
 	$(RM) $(OBJS) $(TARGETS)
-	$(RM) libcupsimage.so libcupsimage.sl libcupsimage.dylib
+	$(RM) libcupsimage.so libcupsimage.${LIBcupsimage_VERSION} libcupsimage.sl libcupsimage.dylib
 	$(RM) -r 32bit 64bit
 
 
@@@@ -88,9 +88,8 @@@@ install:	all installhdrs $(INSTALLSTATIC) $(INSTALL32)
 	$(LN) rastertolabel $(SERVERBIN)/filter/rastertodymo
d11 1
a11 3
+	-if test $(LIBCUPSIMAGE) = "libcupsimage.so.${LIBcupsimage_VERSION}" -o $(LIBCUPSIMAGE) = "libcupsimage.sl.2"; then \
+		$(RM) $(LIBDIR)/`basename $(LIBCUPSIMAGE) .${LIBcupsimage_VERSION}`; \
 	fi
d13 3
a15 2
 		$(STRIP) -x $(LIBDIR)/$(LIBCUPSIMAGE); \
@@@@ -116,13 +115,13 @@@@ installhdrs:
d33 1
a33 1
@@@@ -143,7 +142,7 @@@@ uninstall: $(UNINSTALL32) $(UNINSTALL64)
d41 1
a41 2
 	$(RM) $(INCLUDEDIR)/cups/raster.h
@@@@ -151,12 +150,12 @@@@ uninstall: $(UNINSTALL32) $(UNINSTALL64)
d56 1
a56 1
@@@@ -199,22 +198,22 @@@@ hpgltops:	$(HPGLOBJS) common.o ../cups/$(LIBCUPS)
a70 2
+	$(RM) `basename $@@ .${LIBcupsimage_VERSION}`
+	$(LN) $@@ `basename $@@ .${LIBcupsimage_VERSION}`
d83 1
a83 1
@@@@ -222,10 +221,10 @@@@ libcupsimage.so.2 libcupsimage.sl.2:	$(IMAGEOBJS)
@


1.5
log
@Update to cups-1.3.10. With lots of help from ajacoutot@@.

There's an issue with the admin.cgi which will be fixed
in-tree.

ok ajacoutot@@, jasper@@
@
text
@d1 3
a3 3
$OpenBSD: patch-filter_Makefile,v 1.4 2007/05/07 13:58:07 ajacoutot Exp $
--- filter/Makefile.orig	Sat Sep  6 02:30:39 2008
+++ filter/Makefile	Tue Mar 17 16:21:50 2009
d13 1
a13 1
@@@@ -88,9 +88,9 @@@@ install:	all installhdrs $(INSTALLSTATIC) $(INSTALL32)
a21 1
+		$(LN) $(LIBCUPSIMAGE) $(LIBDIR)/`basename $(LIBCUPSIMAGE) .${LIBcupsimage_VERSION}`; \
d25 1
a25 1
@@@@ -116,13 +116,13 @@@@ installhdrs:
d43 1
a43 1
@@@@ -143,7 +143,7 @@@@ uninstall: $(UNINSTALL32) $(UNINSTALL64)
d52 1
a52 1
@@@@ -151,12 +151,12 @@@@ uninstall: $(UNINSTALL32) $(UNINSTALL64)
d67 1
a67 1
@@@@ -199,22 +199,22 @@@@ hpgltops:	$(HPGLOBJS) common.o ../cups/$(LIBCUPS)
d96 1
a96 1
@@@@ -222,10 +222,10 @@@@ libcupsimage.so.2 libcupsimage.sl.2:	$(IMAGEOBJS)
@


1.4
log
@- don't force optimisation nor debug
- regen patches while here
@
text
@d1 4
a4 4
$OpenBSD: patch-filter_Makefile,v 1.3 2006/10/01 10:43:38 mbalmer Exp $
--- filter/Makefile.orig	Wed Jun 14 23:03:17 2006
+++ filter/Makefile	Mon May  7 15:47:41 2007
@@@@ -65,7 +65,7 @@@@ all:	$(TARGETS)
d13 1
a13 1
@@@@ -96,9 +96,9 @@@@ install:	all installhdrs $(INSTALLSTATIC) $(INSTALL32)
d26 1
a26 1
@@@@ -118,13 +118,13 @@@@ installhdrs:
d44 1
a44 1
@@@@ -145,7 +145,7 @@@@ uninstall: $(UNINSTALL32) $(UNINSTALL64)
d53 1
a53 1
@@@@ -153,12 +153,12 @@@@ uninstall: $(UNINSTALL32) $(UNINSTALL64)
d68 1
a68 1
@@@@ -201,22 +201,22 @@@@ hpgltops:	$(HPGLOBJS) common.o ../cups/$(LIBCUPS)
d97 1
a97 1
@@@@ -224,10 +224,10 @@@@ libcupsimage.so.2 libcupsimage.sl.2:	$(IMAGEOBJS)
@


1.3
log
@Update to CUPS 1.2.4, which has lots of improvements over the old version
we had, like better support for foreign languages and the usual plethora
of bugfixes.

tested on various architectures and with various applications that use CUPS
as their printing system.  I verified that all ports that are depending on
CUPS still build.
@
text
@d1 3
a3 3
$OpenBSD$
--- filter/Makefile.orig	Wed Sep 20 11:13:54 2006
+++ filter/Makefile	Wed Sep 20 11:16:33 2006
d13 1
a13 1
@@@@ -96,9 +96,9 @@@@ install:	all installhdrs $(INSTALLSTATIC
d68 1
a68 1
@@@@ -201,22 +201,22 @@@@ hpgltops:	$(HPGLOBJS) common.o ../cups/$
d97 1
a97 1
@@@@ -224,10 +224,10 @@@@ libcupsimage.so.2 libcupsimage.sl.2:	$(I
@


1.2
log
@Make SHARED_LIBS actually work, this was lying around for quite some time,
no idea why I did not get committed...

prodded by bernd.
@
text
@d1 4
a4 3
--- filter/Makefile.orig	Tue Jun 29 05:44:52 2004
+++ filter/Makefile	Sun Nov  7 15:19:29 2004
@@@@ -55,7 +55,7 @@@@ all:	$(TARGETS) $(LIBCUPSIMAGE) libcupsi
d7 4
a10 3
 	$(RM) $(OBJS) $(TARGETS) $(LIBCUPSIMAGE) libcupsimage.a
-	$(RM) `basename $(LIBCUPSIMAGE) .2` libcupsimage.dylib
+	$(RM) `basename $(LIBCUPSIMAGE) .${LIBcupsimage_VERSION}` libcupsimage.dylib
d13 3
a15 4
 #
@@@@ -77,9 +77,9 @@@@ install:	all installhdrs
 	done
 	$(INSTALL_DIR) $(LIBDIR)
d26 17
a42 2
@@@@ -128,11 +128,11 @@@@ hpgltops:	$(HPGLOBJS) common.o ../Makede
 # libcupsimage.so.2, libcupsimage.sl.2
d44 23
d68 10
a77 2
-libcupsimage.so.2 libcupsimage.sl.2:	$(IMAGEOBJS) ../Makedefs
+libcupsimage.so.${LIBcupsimage_VERSION} libcupsimage.sl.2:	$(IMAGEOBJS) ../Makedefs
d79 2
a80 1
 	$(DSO) $(DSOFLAGS) -o $@@ $(IMAGEOBJS) $(DSOLIBS) -lm
d88 22
@


1.1
log
@Initial revision
@
text
@d8 1
a8 1
+	$(RM) `basename $(LIBCUPSIMAGE) .2.2` libcupsimage.dylib
d19 3
a21 3
+	-if test $(LIBCUPSIMAGE) = "libcupsimage.so.2.2" -o $(LIBCUPSIMAGE) = "libcupsimage.sl.2"; then \
+		$(RM) $(LIBDIR)/`basename $(LIBCUPSIMAGE) .2.2`; \
+		$(LN) $(LIBCUPSIMAGE) $(LIBDIR)/`basename $(LIBCUPSIMAGE) .2.2`; \
d30 1
a30 1
+libcupsimage.so.2.2 libcupsimage.sl.2:	$(IMAGEOBJS) ../Makedefs
d35 2
a36 2
+	$(RM) `basename $@@ .2.2`
+	$(LN) $@@ `basename $@@ .2.2`
@


1.1.1.1
log
@CUPS, the Common Unix Printing System.

A cross-platform printing solution for Unix environments,
based on the "Internet Printing Protocol, IPP".

ok alek@@
@
text
@@
