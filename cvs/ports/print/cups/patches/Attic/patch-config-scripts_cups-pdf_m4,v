head	1.5;
access;
symbols
	OPENBSD_5_2:1.4.0.2
	OPENBSD_5_2_BASE:1.4
	OPENBSD_5_1_BASE:1.3
	OPENBSD_5_1:1.3.0.2
	OPENBSD_5_0:1.2.0.6
	OPENBSD_5_0_BASE:1.2
	OPENBSD_4_9:1.2.0.4
	OPENBSD_4_9_BASE:1.2
	OPENBSD_4_8:1.2.0.2
	OPENBSD_4_8_BASE:1.2
	OPENBSD_4_7:1.1.0.2
	OPENBSD_4_7_BASE:1.1;
locks; strict;
comment	@# @;


1.5
date	2012.08.04.14.37.04;	author ajacoutot;	state dead;
branches;
next	1.4;

1.4
date	2012.02.17.07.45.10;	author ajacoutot;	state Exp;
branches;
next	1.3;

1.3
date	2011.09.08.10.33.12;	author ajacoutot;	state Exp;
branches;
next	1.2;

1.2
date	2010.03.31.16.20.02;	author ajacoutot;	state Exp;
branches;
next	1.1;

1.1
date	2009.10.25.16.04.34;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.5
log
@Major update to CUPS 1.6.1.
This package is now split between -main (the bloat) and -libs (i.e.
cups-libs; which only contains the base libraries which have no
external deps).
Most filters have moved to cups-filters, the split was needed because
cups depends on cups-filters which depends on cups

The nice side-effect is that this will simplify lots of things in tree.
@
text
@$OpenBSD: patch-config-scripts_cups-pdf_m4,v 1.4 2012/02/17 07:45:10 ajacoutot Exp $

CUPS check for the ghostscript binary; we cannot depend on
print/ghostscript/gnu because of a cyclic dependency but we know our
gs supports the ps2write device.

--- config-scripts/cups-pdf.m4.orig	Fri Feb 17 08:35:39 2012
+++ config-scripts/cups-pdf.m4	Fri Feb 17 08:35:59 2012
@@@@ -91,12 +91,8 @@@@ if test "x$CUPS_PDFTOPS" != x; then
 	DEFAULT_PDFTOPS=""
 elif test "x$CUPS_GHOSTSCRIPT" != x; then
 	AC_MSG_CHECKING(whether gs supports the ps2write device)
-	if ($CUPS_GHOSTSCRIPT -h 2>&1 | grep -q ps2write); then
-		AC_MSG_RESULT(yes)
-		AC_DEFINE(HAVE_GHOSTSCRIPT_PS2WRITE)
-	else
-		AC_MSG_RESULT(no)
-	fi
+	AC_MSG_RESULT(yes)
+	AC_DEFINE(HAVE_GHOSTSCRIPT_PS2WRITE)
 
 	DEFAULT_PDFTOPS=""
 else
@


1.4
log
@Make sure we use ghostscript as pdftops interpreter but do _not_ depend
on it being installed at build time (cyclic dependency).

breakage reported by nigel@@
@
text
@d1 1
a1 1
$OpenBSD$
@


1.3
log
@Major update to cups-1.5.0.

Thanks to landry@@ for the bulk testing.
@
text
@d1 1
a1 1
$OpenBSD: patch-config-scripts_cups-pdf_m4,v 1.2 2010/03/31 16:20:02 ajacoutot Exp $
d3 3
a5 2
Security fix for CVE-2009-3608, CVE-2009-3609.
CUPS "pdftops" Filter Data Handling Integer Overflow Vulnerabilities
d7 14
a20 7
Patch from Ubuntu: poppler-based-pdftops-fixes.dpatch

--- config-scripts/cups-pdf.m4.orig	Sat May  7 00:53:53 2011
+++ config-scripts/cups-pdf.m4	Fri Sep  2 09:33:11 2011
@@@@ -103,6 +103,12 @@@@ else
 	DEFAULT_PDFTOPS="#"
 fi
d22 2
a23 9
+if test "x$CUPS_PDFTOPS" != x; then
+	if `$CUPS_PDFTOPS -h 2>&1 | grep -q -- -origpagesizes 2>/dev/null`; then
+		AC_DEFINE(HAVE_PDFTOPS_WITH_ORIGPAGESIZES)
+	fi
+fi
+
 AC_DEFINE_UNQUOTED(CUPS_PDFTOPS, "$CUPS_PDFTOPS")
 AC_DEFINE_UNQUOTED(CUPS_GHOSTSCRIPT, "$CUPS_GHOSTSCRIPT")
 AC_SUBST(DEFAULT_PDFTOPS)
@


1.2
log
@Major update to cups-1.4.3.
Changelog is to big to detail here, refer to HOMEPAGE for details.

I have been using 1.4.X for several months.
Versions 1.4.0 and 1.4.2 have been tested in bulks by jasper@@, thanks!

Please contact me directly if you see regressions.
@
text
@d1 1
a1 1
$OpenBSD: patch-config-scripts_cups-pdf_m4,v 1.1 2009/10/25 16:04:34 jasper Exp $
d8 5
a12 5
--- config-scripts/cups-pdf.m4.orig	Sat Aug  8 00:30:30 2009
+++ config-scripts/cups-pdf.m4	Thu Dec 10 15:28:50 2009
@@@@ -79,6 +79,12 @@@@ case "x$with_pdftops" in
 	;;
 esac
d22 1
a22 1
 AC_SUBST(PDFTOPS)
@


1.1
log
@SECURITY FIX for CVE-2009-3608, CVE-2009-3609.
CUPS "pdftops" Filter Data Handling Integer Overflow Vulnerabilities
Patch from Ubuntu.

ok ajacoutot@@ (MAINTAINER)
@
text
@d1 1
a1 1
$OpenBSD$
d8 3
a10 3
--- config-scripts/cups-pdf.m4.orig	Fri Oct 23 13:00:39 2009
+++ config-scripts/cups-pdf.m4	Fri Oct 23 13:01:00 2009
@@@@ -64,6 +64,12 @@@@ case "x$with_pdftops" in
@

