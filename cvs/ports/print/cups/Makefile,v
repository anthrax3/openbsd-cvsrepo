head	1.224;
access;
symbols
	OPENBSD_6_1:1.218.0.2
	OPENBSD_6_1_BASE:1.218
	OPENBSD_6_0:1.211.0.2
	OPENBSD_6_0_BASE:1.211
	OPENBSD_5_9:1.207.0.2
	OPENBSD_5_9_BASE:1.207
	OPENBSD_5_8:1.201.0.4
	OPENBSD_5_8_BASE:1.201
	OPENBSD_5_7:1.192.0.2
	OPENBSD_5_7_BASE:1.192
	OPENBSD_5_6:1.182.0.2
	OPENBSD_5_6_BASE:1.182
	OPENBSD_5_5:1.172.0.2
	OPENBSD_5_5_BASE:1.172
	OPENBSD_5_4:1.161.0.2
	OPENBSD_5_4_BASE:1.161
	OPENBSD_5_3:1.150.0.2
	OPENBSD_5_3_BASE:1.150
	OPENBSD_5_2:1.133.0.2
	OPENBSD_5_2_BASE:1.133
	OPENBSD_5_1_BASE:1.122
	OPENBSD_5_1:1.122.0.2
	OPENBSD_5_0:1.110.0.2
	OPENBSD_5_0_BASE:1.110
	OPENBSD_4_9:1.96.0.2
	OPENBSD_4_9_BASE:1.96
	OPENBSD_4_8:1.77.0.2
	OPENBSD_4_8_BASE:1.77
	OPENBSD_4_7:1.66.0.2
	OPENBSD_4_7_BASE:1.66
	OPENBSD_4_6:1.53.0.2
	OPENBSD_4_6_BASE:1.53
	OPENBSD_4_5:1.37.0.2
	OPENBSD_4_5_BASE:1.37
	OPENBSD_4_4:1.31.0.4
	OPENBSD_4_4_BASE:1.31
	OPENBSD_4_3:1.31.0.2
	OPENBSD_4_3_BASE:1.31
	OPENBSD_4_2:1.26.0.2
	OPENBSD_4_2_BASE:1.26
	OPENBSD_4_1:1.21.0.2
	OPENBSD_4_1_BASE:1.21
	OPENBSD_4_0:1.12.0.2
	OPENBSD_4_0_BASE:1.12
	OPENBSD_3_9:1.11.0.2
	OPENBSD_3_9_BASE:1.11
	OPENBSD_3_8:1.4.0.4
	OPENBSD_3_8_BASE:1.4
	OPENBSD_3_7:1.4.0.2
	OPENBSD_3_7_BASE:1.4
	cups_20050116:1.1.1.1
	mbalmer:1.1.1;
locks; strict;
comment	@# @;


1.224
date	2017.08.01.12.18.35;	author ajacoutot;	state Exp;
branches;
next	1.223;
commitid	4uWkjhMU81azlf58;

1.223
date	2017.07.26.22.45.28;	author sthen;	state Exp;
branches;
next	1.222;
commitid	tD4MFrpYYDDL2UFT;

1.222
date	2017.07.16.19.19.01;	author espie;	state Exp;
branches;
next	1.221;
commitid	tt0GhWK5c4uf9ILG;

1.221
date	2017.07.01.11.05.41;	author ajacoutot;	state Exp;
branches;
next	1.220;
commitid	dWJW5y9BPTDC7yoi;

1.220
date	2017.06.27.08.13.05;	author ajacoutot;	state Exp;
branches;
next	1.219;
commitid	kv32wE1WVGZhpnue;

1.219
date	2017.04.10.11.46.32;	author sthen;	state Exp;
branches;
next	1.218;
commitid	HY6VNZxjJWzKQFDV;

1.218
date	2017.03.29.20.50.51;	author ajacoutot;	state Exp;
branches;
next	1.217;
commitid	Zoc6pYQKhG1puEdk;

1.217
date	2017.03.10.03.23.29;	author ajacoutot;	state Exp;
branches;
next	1.216;
commitid	xG6HT7Bs15k2womR;

1.216
date	2017.01.26.00.56.55;	author ajacoutot;	state Exp;
branches;
next	1.215;
commitid	idkvogMsbMzjRp2N;

1.215
date	2017.01.19.03.08.52;	author ajacoutot;	state Exp;
branches;
next	1.214;
commitid	4akQgZhUZSnpzbrW;

1.214
date	2016.11.11.11.52.35;	author ajacoutot;	state Exp;
branches;
next	1.213;
commitid	eSlL8wKmMaWbwHOv;

1.213
date	2016.10.05.18.28.17;	author ajacoutot;	state Exp;
branches;
next	1.212;
commitid	yttQPt1Ny7PV8vcR;

1.212
date	2016.09.19.09.16.51;	author ajacoutot;	state Exp;
branches;
next	1.211;
commitid	5ZKBoypll2THXP84;

1.211
date	2016.06.15.06.42.51;	author ajacoutot;	state Exp;
branches;
next	1.210;
commitid	TESQ4joNVwjvR6Gr;

1.210
date	2016.05.22.15.44.23;	author ajacoutot;	state Exp;
branches;
next	1.209;
commitid	vH3eMUKprVwpH5el;

1.209
date	2016.04.12.06.45.36;	author ajacoutot;	state Exp;
branches;
next	1.208;
commitid	rsJ3lGlheJVrgqFt;

1.208
date	2016.03.11.20.28.30;	author naddy;	state Exp;
branches;
next	1.207;
commitid	UYLP8TE6V7RS2GhJ;

1.207
date	2016.02.07.15.54.25;	author ajacoutot;	state Exp;
branches;
next	1.206;
commitid	6FSle6t5I5vZ01d4;

1.206
date	2015.12.05.07.36.19;	author ajacoutot;	state Exp;
branches;
next	1.205;
commitid	76T6L25JNSDkPbJ5;

1.205
date	2015.12.02.12.37.37;	author ajacoutot;	state Exp;
branches;
next	1.204;
commitid	H80T77MfTi7pF4uJ;

1.204
date	2015.09.01.16.23.50;	author ajacoutot;	state Exp;
branches;
next	1.203;
commitid	fJT2d2idEfqHZo4P;

1.203
date	2015.08.27.06.48.30;	author ajacoutot;	state Exp;
branches;
next	1.202;
commitid	fg1RtdQjUrtjJJWq;

1.202
date	2015.08.21.14.50.24;	author jasper;	state Exp;
branches;
next	1.201;
commitid	WQOQHKnr0MzR3JoY;

1.201
date	2015.08.01.07.18.12;	author ajacoutot;	state Exp;
branches;
next	1.200;
commitid	wgCBh0QZo3huPBFr;

1.200
date	2015.07.12.08.56.50;	author ajacoutot;	state Exp;
branches;
next	1.199;
commitid	qxvkxNyGaLgUJxXM;

1.199
date	2015.07.12.08.42.25;	author ajacoutot;	state Exp;
branches;
next	1.198;
commitid	xpTbY3dnAjolU9i1;

1.198
date	2015.07.07.14.33.34;	author ajacoutot;	state Exp;
branches;
next	1.197;
commitid	ICGMqQ1oNDB5Gm5S;

1.197
date	2015.06.09.08.01.13;	author ajacoutot;	state Exp;
branches;
next	1.196;
commitid	LH7mxS1qoQSsgx81;

1.196
date	2015.06.09.07.39.14;	author ajacoutot;	state Exp;
branches;
next	1.195;
commitid	WcXFDQI1LYGUoqum;

1.195
date	2015.04.04.09.21.03;	author ajacoutot;	state Exp;
branches;
next	1.194;
commitid	kS3kwKZogsvzYmEY;

1.194
date	2015.04.04.08.24.37;	author ajacoutot;	state Exp;
branches;
next	1.193;
commitid	xFShkAEyyIylrSWC;

1.193
date	2015.03.27.08.14.14;	author ajacoutot;	state Exp;
branches;
next	1.192;
commitid	ERm8DOTUF1j7394B;

1.192
date	2015.02.10.08.29.33;	author ajacoutot;	state Exp;
branches
	1.192.2.1;
next	1.191;
commitid	9fRjFjnMfPJHQiVu;

1.191
date	2014.12.15.12.55.18;	author ajacoutot;	state Exp;
branches;
next	1.190;
commitid	RmjeWwvahvGdNhNq;

1.190
date	2014.12.10.10.22.13;	author ajacoutot;	state Exp;
branches;
next	1.189;
commitid	0t36aEyJ6IJCm2lz;

1.189
date	2014.12.06.11.12.43;	author ajacoutot;	state Exp;
branches;
next	1.188;
commitid	fsYqBLpENdvpsHVE;

1.188
date	2014.11.15.10.22.23;	author ajacoutot;	state Exp;
branches;
next	1.187;
commitid	20oo4Dj2S2v31rH3;

1.187
date	2014.10.08.12.06.21;	author ajacoutot;	state Exp;
branches;
next	1.186;
commitid	JvoLhtQaWm2FieXg;

1.186
date	2014.09.21.12.14.45;	author ajacoutot;	state Exp;
branches;
next	1.185;
commitid	mrlGx3M2dgmY7aYj;

1.185
date	2014.08.28.17.51.43;	author ajacoutot;	state Exp;
branches;
next	1.184;
commitid	IHyZ8Sftv3MI7UMb;

1.184
date	2014.08.15.14.51.03;	author ajacoutot;	state Exp;
branches;
next	1.183;
commitid	9sqsQL16YDo7qAom;

1.183
date	2014.08.10.07.49.27;	author ajacoutot;	state Exp;
branches;
next	1.182;
commitid	Z3eTpBrHSuurwnEk;

1.182
date	2014.07.19.17.07.02;	author ajacoutot;	state Exp;
branches
	1.182.2.1;
next	1.181;
commitid	NlkJVs1hEvN3DYpa;

1.181
date	2014.07.15.09.42.31;	author ajacoutot;	state Exp;
branches;
next	1.180;
commitid	0Z55uaVyqWTIlQc8;

1.180
date	2014.07.12.13.41.47;	author ajacoutot;	state Exp;
branches;
next	1.179;
commitid	CC2Szyf2ZEuFbbEs;

1.179
date	2014.07.10.13.09.06;	author ajacoutot;	state Exp;
branches;
next	1.178;
commitid	Xpirey71VpT09196;

1.178
date	2014.05.28.08.04.47;	author ajacoutot;	state Exp;
branches;
next	1.177;

1.177
date	2014.04.28.13.37.32;	author ajacoutot;	state Exp;
branches;
next	1.176;

1.176
date	2014.04.21.11.26.01;	author ajacoutot;	state Exp;
branches;
next	1.175;

1.175
date	2014.04.10.17.15.34;	author ajacoutot;	state Exp;
branches;
next	1.174;

1.174
date	2014.04.03.12.50.20;	author ajacoutot;	state Exp;
branches;
next	1.173;

1.173
date	2014.03.09.21.46.34;	author ajacoutot;	state Exp;
branches;
next	1.172;

1.172
date	2014.01.19.09.09.45;	author ajacoutot;	state Exp;
branches
	1.172.2.1;
next	1.171;

1.171
date	2014.01.08.18.13.56;	author ajacoutot;	state Exp;
branches;
next	1.170;

1.170
date	2013.12.12.15.22.17;	author ajacoutot;	state Exp;
branches;
next	1.169;

1.169
date	2013.12.12.14.48.31;	author ajacoutot;	state Exp;
branches;
next	1.168;

1.168
date	2013.11.02.01.17.47;	author ajacoutot;	state Exp;
branches;
next	1.167;

1.167
date	2013.10.30.08.35.55;	author ajacoutot;	state Exp;
branches;
next	1.166;

1.166
date	2013.10.27.08.50.17;	author ajacoutot;	state Exp;
branches;
next	1.165;

1.165
date	2013.10.22.19.59.18;	author jca;	state Exp;
branches;
next	1.164;

1.164
date	2013.09.25.08.39.25;	author ajacoutot;	state Exp;
branches;
next	1.163;

1.163
date	2013.08.21.13.36.09;	author ajacoutot;	state Exp;
branches;
next	1.162;

1.162
date	2013.08.15.14.54.27;	author ajacoutot;	state Exp;
branches;
next	1.161;

1.161
date	2013.07.13.11.55.12;	author sthen;	state Exp;
branches
	1.161.2.1;
next	1.160;

1.160
date	2013.07.12.07.19.38;	author ajacoutot;	state Exp;
branches;
next	1.159;

1.159
date	2013.06.20.06.54.37;	author ajacoutot;	state Exp;
branches;
next	1.158;

1.158
date	2013.06.17.19.31.01;	author ajacoutot;	state Exp;
branches;
next	1.157;

1.157
date	2013.06.04.18.41.55;	author naddy;	state Exp;
branches;
next	1.156;

1.156
date	2013.05.17.13.47.44;	author ajacoutot;	state Exp;
branches;
next	1.155;

1.155
date	2013.04.03.15.19.01;	author ajacoutot;	state Exp;
branches;
next	1.154;

1.154
date	2013.03.21.08.33.51;	author landry;	state Exp;
branches;
next	1.153;

1.153
date	2013.03.19.08.49.14;	author ajacoutot;	state Exp;
branches;
next	1.152;

1.152
date	2013.03.14.07.22.33;	author brad;	state Exp;
branches;
next	1.151;

1.151
date	2013.03.11.11.37.53;	author espie;	state Exp;
branches;
next	1.150;

1.150
date	2013.02.04.14.46.24;	author ajacoutot;	state Exp;
branches;
next	1.149;

1.149
date	2013.01.06.08.58.24;	author ajacoutot;	state Exp;
branches;
next	1.148;

1.148
date	2013.01.06.08.42.08;	author ajacoutot;	state Exp;
branches;
next	1.147;

1.147
date	2013.01.05.16.36.08;	author ajacoutot;	state Exp;
branches;
next	1.146;

1.146
date	2013.01.05.12.47.45;	author ajacoutot;	state Exp;
branches;
next	1.145;

1.145
date	2012.10.19.07.18.28;	author ajacoutot;	state Exp;
branches;
next	1.144;

1.144
date	2012.10.01.12.47.55;	author ajacoutot;	state Exp;
branches;
next	1.143;

1.143
date	2012.09.28.13.04.20;	author dcoppa;	state Exp;
branches;
next	1.142;

1.142
date	2012.09.28.10.19.28;	author ajacoutot;	state Exp;
branches;
next	1.141;

1.141
date	2012.09.27.10.07.55;	author giovanni;	state Exp;
branches;
next	1.140;

1.140
date	2012.09.08.07.54.03;	author ajacoutot;	state Exp;
branches;
next	1.139;

1.139
date	2012.08.23.16.25.48;	author ajacoutot;	state Exp;
branches;
next	1.138;

1.138
date	2012.08.05.13.47.04;	author naddy;	state Exp;
branches;
next	1.137;

1.137
date	2012.08.05.06.19.40;	author ajacoutot;	state Exp;
branches;
next	1.136;

1.136
date	2012.08.04.18.01.28;	author ajacoutot;	state Exp;
branches;
next	1.135;

1.135
date	2012.08.04.17.53.06;	author ajacoutot;	state Exp;
branches;
next	1.134;

1.134
date	2012.08.04.14.37.04;	author ajacoutot;	state Exp;
branches;
next	1.133;

1.133
date	2012.06.20.14.54.40;	author ajacoutot;	state Exp;
branches;
next	1.132;

1.132
date	2012.06.01.07.55.12;	author ajacoutot;	state Exp;
branches;
next	1.131;

1.131
date	2012.05.28.15.18.18;	author ajacoutot;	state Exp;
branches;
next	1.130;

1.130
date	2012.05.26.06.43.38;	author ajacoutot;	state Exp;
branches;
next	1.129;

1.129
date	2012.05.26.06.26.04;	author ajacoutot;	state Exp;
branches;
next	1.128;

1.128
date	2012.05.18.16.31.22;	author ajacoutot;	state Exp;
branches;
next	1.127;

1.127
date	2012.05.17.10.11.23;	author ajacoutot;	state Exp;
branches;
next	1.126;

1.126
date	2012.04.28.10.52.08;	author ajacoutot;	state Exp;
branches;
next	1.125;

1.125
date	2012.04.22.11.41.55;	author ajacoutot;	state Exp;
branches;
next	1.124;

1.124
date	2012.02.17.07.45.10;	author ajacoutot;	state Exp;
branches;
next	1.123;

1.123
date	2012.02.16.22.12.08;	author ajacoutot;	state Exp;
branches;
next	1.122;

1.122
date	2012.02.02.07.11.19;	author ajacoutot;	state Exp;
branches;
next	1.121;

1.121
date	2011.12.04.15.40.57;	author ajacoutot;	state Exp;
branches;
next	1.120;

1.120
date	2011.12.04.14.21.11;	author ajacoutot;	state Exp;
branches;
next	1.119;

1.119
date	2011.12.03.23.04.37;	author ajacoutot;	state Exp;
branches;
next	1.118;

1.118
date	2011.11.13.13.54.04;	author ajacoutot;	state Exp;
branches;
next	1.117;

1.117
date	2011.10.19.12.59.55;	author ajacoutot;	state Exp;
branches;
next	1.116;

1.116
date	2011.10.15.07.20.43;	author ajacoutot;	state Exp;
branches;
next	1.115;

1.115
date	2011.10.02.14.41.48;	author ajacoutot;	state Exp;
branches;
next	1.114;

1.114
date	2011.09.30.07.33.59;	author ajacoutot;	state Exp;
branches;
next	1.113;

1.113
date	2011.09.08.10.33.12;	author ajacoutot;	state Exp;
branches;
next	1.112;

1.112
date	2011.08.31.12.43.08;	author ajacoutot;	state Exp;
branches;
next	1.111;

1.111
date	2011.08.25.09.50.20;	author ajacoutot;	state Exp;
branches;
next	1.110;

1.110
date	2011.07.06.16.03.08;	author ajacoutot;	state Exp;
branches;
next	1.109;

1.109
date	2011.07.06.14.49.02;	author ajacoutot;	state Exp;
branches;
next	1.108;

1.108
date	2011.07.06.01.01.27;	author ajacoutot;	state Exp;
branches;
next	1.107;

1.107
date	2011.06.28.11.52.38;	author ajacoutot;	state Exp;
branches;
next	1.106;

1.106
date	2011.06.02.13.41.40;	author ajacoutot;	state Exp;
branches;
next	1.105;

1.105
date	2011.05.26.12.52.48;	author ajacoutot;	state Exp;
branches;
next	1.104;

1.104
date	2011.05.11.07.45.53;	author ajacoutot;	state Exp;
branches;
next	1.103;

1.103
date	2011.04.28.17.21.17;	author ajacoutot;	state Exp;
branches;
next	1.102;

1.102
date	2011.04.28.05.47.49;	author ajacoutot;	state Exp;
branches;
next	1.101;

1.101
date	2011.04.16.14.59.54;	author ajacoutot;	state Exp;
branches;
next	1.100;

1.100
date	2011.04.06.16.50.26;	author ajacoutot;	state Exp;
branches;
next	1.99;

1.99
date	2011.03.24.15.17.28;	author ajacoutot;	state Exp;
branches;
next	1.98;

1.98
date	2011.03.09.13.05.20;	author ajacoutot;	state Exp;
branches;
next	1.97;

1.97
date	2011.03.02.06.49.38;	author ajacoutot;	state Exp;
branches;
next	1.96;

1.96
date	2011.01.17.23.24.40;	author ajacoutot;	state Exp;
branches;
next	1.95;

1.95
date	2011.01.16.23.03.10;	author ajacoutot;	state Exp;
branches;
next	1.94;

1.94
date	2011.01.11.12.13.59;	author ajacoutot;	state Exp;
branches;
next	1.93;

1.93
date	2010.12.30.12.55.02;	author ajacoutot;	state Exp;
branches;
next	1.92;

1.92
date	2010.12.27.14.50.23;	author ajacoutot;	state Exp;
branches;
next	1.91;

1.91
date	2010.12.24.10.40.06;	author ajacoutot;	state Exp;
branches;
next	1.90;

1.90
date	2010.12.20.14.43.42;	author ajacoutot;	state Exp;
branches;
next	1.89;

1.89
date	2010.12.20.11.39.48;	author ajacoutot;	state Exp;
branches;
next	1.88;

1.88
date	2010.11.30.08.09.09;	author ajacoutot;	state Exp;
branches;
next	1.87;

1.87
date	2010.11.20.09.48.39;	author espie;	state Exp;
branches;
next	1.86;

1.86
date	2010.11.12.07.09.00;	author ajacoutot;	state Exp;
branches;
next	1.85;

1.85
date	2010.11.10.12.53.09;	author kili;	state Exp;
branches;
next	1.84;

1.84
date	2010.11.05.07.51.57;	author landry;	state Exp;
branches;
next	1.83;

1.83
date	2010.10.29.12.54.44;	author ajacoutot;	state Exp;
branches;
next	1.82;

1.82
date	2010.10.28.15.12.49;	author ajacoutot;	state Exp;
branches;
next	1.81;

1.81
date	2010.10.27.15.42.06;	author ajacoutot;	state Exp;
branches;
next	1.80;

1.80
date	2010.10.18.21.25.08;	author espie;	state Exp;
branches;
next	1.79;

1.79
date	2010.10.12.12.53.15;	author ajacoutot;	state Exp;
branches;
next	1.78;

1.78
date	2010.08.22.10.48.41;	author ajacoutot;	state Exp;
branches;
next	1.77;

1.77
date	2010.07.26.20.07.31;	author edd;	state Exp;
branches;
next	1.76;

1.76
date	2010.07.13.12.50.44;	author sebastia;	state Exp;
branches;
next	1.75;

1.75
date	2010.07.02.07.52.08;	author ajacoutot;	state Exp;
branches;
next	1.74;

1.74
date	2010.06.27.04.18.50;	author ajacoutot;	state Exp;
branches;
next	1.73;

1.73
date	2010.05.22.09.57.42;	author jasper;	state Exp;
branches;
next	1.72;

1.72
date	2010.05.16.14.16.36;	author ajacoutot;	state Exp;
branches;
next	1.71;

1.71
date	2010.04.07.13.55.30;	author ajacoutot;	state Exp;
branches;
next	1.70;

1.70
date	2010.04.01.07.14.43;	author ajacoutot;	state Exp;
branches;
next	1.69;

1.69
date	2010.03.31.16.20.02;	author ajacoutot;	state Exp;
branches;
next	1.68;

1.68
date	2010.03.29.13.11.42;	author sthen;	state Exp;
branches;
next	1.67;

1.67
date	2010.03.29.07.53.51;	author ajacoutot;	state Exp;
branches;
next	1.66;

1.66
date	2010.02.09.12.23.59;	author jasper;	state Exp;
branches;
next	1.65;

1.65
date	2009.12.22.15.54.32;	author ajacoutot;	state Exp;
branches;
next	1.64;

1.64
date	2009.12.10.10.57.06;	author ajacoutot;	state Exp;
branches;
next	1.63;

1.63
date	2009.11.22.18.10.12;	author jasper;	state Exp;
branches;
next	1.62;

1.62
date	2009.11.22.16.47.35;	author jasper;	state Exp;
branches;
next	1.61;

1.61
date	2009.11.22.16.38.55;	author ajacoutot;	state Exp;
branches;
next	1.60;

1.60
date	2009.11.11.11.00.32;	author ajacoutot;	state Exp;
branches;
next	1.59;

1.59
date	2009.10.25.16.04.34;	author jasper;	state Exp;
branches;
next	1.58;

1.58
date	2009.10.12.11.17.17;	author ajacoutot;	state Exp;
branches;
next	1.57;

1.57
date	2009.10.10.12.39.29;	author ajacoutot;	state Exp;
branches;
next	1.56;

1.56
date	2009.10.10.09.28.32;	author ajacoutot;	state Exp;
branches;
next	1.55;

1.55
date	2009.09.06.12.01.07;	author jolan;	state Exp;
branches;
next	1.54;

1.54
date	2009.07.12.19.58.19;	author ajacoutot;	state Exp;
branches;
next	1.53;

1.53
date	2009.06.04.21.46.49;	author ajacoutot;	state Exp;
branches;
next	1.52;

1.52
date	2009.06.03.16.31.57;	author ajacoutot;	state Exp;
branches;
next	1.51;

1.51
date	2009.05.19.11.15.28;	author ajacoutot;	state Exp;
branches;
next	1.50;

1.50
date	2009.05.18.17.09.54;	author ajacoutot;	state Exp;
branches;
next	1.49;

1.49
date	2009.05.16.17.34.52;	author ajacoutot;	state Exp;
branches;
next	1.48;

1.48
date	2009.05.14.12.38.52;	author kurt;	state Exp;
branches;
next	1.47;

1.47
date	2009.05.09.11.05.44;	author ajacoutot;	state Exp;
branches;
next	1.46;

1.46
date	2009.05.08.20.00.57;	author ajacoutot;	state Exp;
branches;
next	1.45;

1.45
date	2009.04.27.08.25.39;	author bernd;	state Exp;
branches;
next	1.44;

1.44
date	2009.04.21.13.03.12;	author ajacoutot;	state Exp;
branches;
next	1.43;

1.43
date	2009.04.10.15.35.01;	author ajacoutot;	state Exp;
branches;
next	1.42;

1.42
date	2009.04.09.08.47.24;	author ajacoutot;	state Exp;
branches;
next	1.41;

1.41
date	2009.03.23.15.04.41;	author ajacoutot;	state Exp;
branches;
next	1.40;

1.40
date	2009.03.15.18.31.29;	author ajacoutot;	state Exp;
branches;
next	1.39;

1.39
date	2009.03.05.17.17.28;	author ajacoutot;	state Exp;
branches;
next	1.38;

1.38
date	2009.03.04.19.50.00;	author jasper;	state Exp;
branches;
next	1.37;

1.37
date	2008.11.19.05.28.30;	author ajacoutot;	state Exp;
branches
	1.37.2.1;
next	1.36;

1.36
date	2008.10.30.15.07.05;	author ajacoutot;	state Exp;
branches;
next	1.35;

1.35
date	2008.10.30.13.26.41;	author ajacoutot;	state Exp;
branches;
next	1.34;

1.34
date	2008.10.28.15.21.49;	author naddy;	state Exp;
branches;
next	1.33;

1.33
date	2008.10.28.12.33.32;	author ajacoutot;	state Exp;
branches;
next	1.32;

1.32
date	2008.09.18.13.37.41;	author ajacoutot;	state Exp;
branches;
next	1.31;

1.31
date	2007.12.11.08.00.06;	author jakemsr;	state Exp;
branches;
next	1.30;

1.30
date	2007.09.30.14.39.23;	author steven;	state Exp;
branches;
next	1.29;

1.29
date	2007.09.20.09.34.07;	author ajacoutot;	state Exp;
branches;
next	1.28;

1.28
date	2007.09.19.20.58.07;	author jasper;	state Exp;
branches;
next	1.27;

1.27
date	2007.09.09.14.53.05;	author ajacoutot;	state Exp;
branches;
next	1.26;

1.26
date	2007.08.03.20.51.42;	author kili;	state Exp;
branches;
next	1.25;

1.25
date	2007.05.07.13.58.07;	author ajacoutot;	state Exp;
branches;
next	1.24;

1.24
date	2007.03.26.22.10.29;	author mbalmer;	state Exp;
branches;
next	1.23;

1.23
date	2007.03.26.16.33.05;	author deanna;	state Exp;
branches;
next	1.22;

1.22
date	2007.03.17.18.28.02;	author deanna;	state Exp;
branches;
next	1.21;

1.21
date	2006.11.17.19.15.36;	author mbalmer;	state Exp;
branches
	1.21.2.1;
next	1.20;

1.20
date	2006.11.07.11.20.49;	author mbalmer;	state Exp;
branches;
next	1.19;

1.19
date	2006.10.21.10.58.24;	author mbalmer;	state Exp;
branches;
next	1.18;

1.18
date	2006.10.07.14.03.09;	author mbalmer;	state Exp;
branches;
next	1.17;

1.17
date	2006.10.02.11.48.06;	author mbalmer;	state Exp;
branches;
next	1.16;

1.16
date	2006.10.02.10.06.03;	author mbalmer;	state Exp;
branches;
next	1.15;

1.15
date	2006.10.02.09.59.05;	author mbalmer;	state Exp;
branches;
next	1.14;

1.14
date	2006.10.01.16.02.24;	author mbalmer;	state Exp;
branches;
next	1.13;

1.13
date	2006.10.01.10.43.38;	author mbalmer;	state Exp;
branches;
next	1.12;

1.12
date	2006.08.03.23.28.11;	author espie;	state Exp;
branches
	1.12.2.1;
next	1.11;

1.11
date	2006.02.05.10.31.13;	author mbalmer;	state Exp;
branches;
next	1.10;

1.10
date	2006.02.05.10.20.57;	author mbalmer;	state Exp;
branches;
next	1.9;

1.9
date	2005.12.23.20.17.41;	author mbalmer;	state Exp;
branches;
next	1.8;

1.8
date	2005.12.06.23.23.44;	author mbalmer;	state Exp;
branches;
next	1.7;

1.7
date	2005.10.14.18.10.15;	author fgsch;	state Exp;
branches;
next	1.6;

1.6
date	2005.10.09.10.29.46;	author mbalmer;	state Exp;
branches;
next	1.5;

1.5
date	2005.09.30.06.56.33;	author fgsch;	state Exp;
branches;
next	1.4;

1.4
date	2005.03.16.15.34.49;	author naddy;	state Exp;
branches
	1.4.2.1
	1.4.4.1;
next	1.3;

1.3
date	2005.01.24.14.34.26;	author mbalmer;	state Exp;
branches;
next	1.2;

1.2
date	2005.01.22.17.12.43;	author mbalmer;	state Exp;
branches;
next	1.1;

1.1
date	2005.01.16.12.36.42;	author mbalmer;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2005.01.16.12.36.42;	author mbalmer;	state Exp;
branches;
next	;

1.4.2.1
date	2005.12.07.21.23.22;	author sturm;	state Exp;
branches;
next	;

1.4.4.1
date	2005.12.07.21.22.45;	author sturm;	state Exp;
branches;
next	;

1.12.2.1
date	2007.08.15.08.04.05;	author sturm;	state Exp;
branches;
next	;

1.21.2.1
date	2007.08.07.06.05.21;	author ajacoutot;	state Exp;
branches;
next	;

1.37.2.1
date	2009.06.28.03.53.16;	author william;	state Exp;
branches;
next	;

1.161.2.1
date	2014.04.11.07.00.27;	author ajacoutot;	state Exp;
branches;
next	;

1.172.2.1
date	2014.04.11.07.01.22;	author ajacoutot;	state Exp;
branches;
next	1.172.2.2;

1.172.2.2
date	2014.07.15.09.50.01;	author ajacoutot;	state Exp;
branches;
next	1.172.2.3;
commitid	wPpmLNEnLNijlxET;

1.172.2.3
date	2014.07.31.13.40.26;	author ajacoutot;	state Exp;
branches;
next	;
commitid	8U1l2BC3YLd2hMg7;

1.182.2.1
date	2014.09.11.09.55.33;	author ajacoutot;	state Exp;
branches;
next	1.182.2.2;
commitid	GrXOdgtrBhiRZFkx;

1.182.2.2
date	2014.11.27.13.10.25;	author ajacoutot;	state Exp;
branches;
next	1.182.2.3;
commitid	h629amzspbxgJSzh;

1.182.2.3
date	2015.02.10.08.55.09;	author ajacoutot;	state Exp;
branches;
next	;
commitid	1mZyL2Uhf5eHBT7x;

1.192.2.1
date	2015.06.09.08.00.19;	author ajacoutot;	state Exp;
branches;
next	;
commitid	AnzZR3vd7gdKbZJT;


desc
@@


1.224
log
@Stop playing games moving around base lp commands and man pages. Things
*should* be able to just work without that dance. If you want to use cups
lp commands just give the full path (/usr/local/{bin,sbin}/lpfoo).

This unbreaks displaying lp man pages that were still in the mandoc db but
not in the fs anymore as reported by espie@@
@
text
@# $OpenBSD: Makefile,v 1.223 2017/07/26 22:45:28 sthen Exp $

COMMENT-main=		Common Unix Printing System
COMMENT-libs=		CUPS libraries and headers

VERSION=		2.2.4
GH_ACCOUNT=		apple
GH_PROJECT=		cups
GH_TAGNAME=		v${VERSION}

PKGNAME-main=		cups-${VERSION}
PKGNAME-libs=		cups-libs-${VERSION}
REVISION-libs=		0
REVISION-main=		1

CATEGORIES=		print sysutils

# config-scripts/cups-sharedlibs.m4
SHARED_LIBS+=  cupsimage       5.1 # so.2
SHARED_LIBS+=  cups            6.4 # so.2
SHARED_LIBS+=  cupscgi         1.1 # so.1
SHARED_LIBS+=  cupsmime        1.2 # so.1
SHARED_LIBS+=  cupsppdc        1.2 # so.1

HOMEPAGE=		http://www.cups.org/

MAINTAINER=		Antoine Jacoutot <ajacoutot@@openbsd.org>

# GPLv2 - LGPLv2
PERMIT_PACKAGE_CDROM=	Yes

WANTLIB += avahi-client avahi-common gnutls iconv m pthread ${COMPILER_LIBCXX} z

WANTLIB-main += ${WANTLIB}
WANTLIB-main += c cups cupscgi cupsimage cupsmime cupsppdc dbus-1 usb-1.0

MULTI_PACKAGES=		-main -libs

BUILD_DEPENDS=		${MODGNU_AUTOMAKE_DEPENDS} \
			${MODGNU_AUTOCONF_DEPENDS}

# bootstrap prevents a cyclic dep: gtk+{2,3}->cups->avahi->gtk+{2,3}
LIB_DEPENDS-libs=	net/avahi,no_gui,no_mono,bootstrap \
			security/gnutls

LIB_DEPENDS-main=	${BASE_PKGPATH},-libs=${VERSION} \
			devel/libusb1

RUN_DEPENDS-main=	print/cups-filters

# optional for now
#RUN_DEPENDS-main +=	graphics/colord

# we don't install the desktop file
#BUILD_DEPENDS +=	devel/xdg-utils
#RUN_DEPENDS-main +=	devel/xdg-utils

LIBS_ENV=		LIBcups_VERSION=${LIBcups_VERSION} \
			LIBcupscgi_VERSION=${LIBcupscgi_VERSION} \
			LIBcupsimage_VERSION=${LIBcupsimage_VERSION} \
			LIBcupsmime_VERSION=${LIBcupsmime_VERSION} \
			LIBcupsppdc_VERSION=${LIBcupsppdc_VERSION} \

FAKE_FLAGS=		BUILDROOT=${WRKINST} \
			DBUSDIR=${PREFIX}/share/examples/cups/dbus-1 \
			ICONDIR=${PREFIX}/share/icons \
			MENUDIR=${PREFIX}/share/applications \
			SERVERROOT=${WRKINST}${PREFIX}/share/examples/cups

AUTOCONF_VERSION= 	2.69
AUTOMAKE_VERSION= 	1.15

USE_GMAKE=		Yes

MAKE_ENV=		${LIBS_ENV}

CONFIGURE_ENV=		CPPFLAGS="-I${LOCALBASE}/include" \
			LDFLAGS="-L${LOCALBASE}/lib" \
			${LIBS_ENV}

CONFIGURE_STYLE=	gnu
CONFIGURE_ARGS=		--enable-static \
			--disable-libtool_unsupported \
			--with-cups-group=_cups \
			--with-cups-user=_cups \
			--with-system-groups=wheel \
			--with-dbusdir=${SYSCONFDIR}/dbus-1 \
			--with-printcap=${SYSCONFDIR}/cups/printcap \
			--with-smbconfigfile="samba://${SYSCONFDIR}/samba/smb.conf" \
			--disable-cdsassl \
			--disable-pam \
			--disable-systemd \
			--without-java \
			--without-php \
			--without-python

pre-configure:
	cd ${WRKSRC} && \
		AUTOMAKE_VERSION=${AUTOMAKE_VERSION} AUTOCONF_VERSION=${AUTOCONF_VERSION} aclocal -I config-scripts
	cd ${WRKSRC} && \
		AUTOMAKE_VERSION=${AUTOMAKE_VERSION} AUTOCONF_VERSION=${AUTOCONF_VERSION} autoconf -I config-scripts
	${SUBST_CMD} ${WRKSRC}/{Makedefs.in,cups/Makefile}

post-configure:
	cd ${WRKBUILD} && sed -i 's|\$${DESTDIR}||g' \
		config.h cups-config man/*.man

post-install:
	ln -sf ${LOCALBASE}/bin/smbspool \
		${PREFIX}/libexec/cups/backend/smb
# used to register as @@sample: classes.conf, client.conf, lpoptions,
# printers.conf and subscriptions.conf in the PLIST
	touch ${PREFIX}/share/examples/cups/empty.conf
# Remove files now part of cups-filters
	rm -f ${PREFIX}/share/cups/banners/*
	rm -f ${PREFIX}/share/cups/data/testprint

# Remove desktop file and icons; we don't really need them (it's just a
# launcher for http://localhost:631 and we may actually want to
# configure a remote server); this is needed to prevent a dependency
# loop: cups->gtk+3,-guic->cups
	rm -rf ${PREFIX}/share/icons
	rm -rf ${PREFIX}/share/applications

# Remove systemV files
	rm -rf ${WRKINST}/etc/rc.d/{init,rc*}.d

.include <bsd.port.mk>
@


1.223
log
@bump LIBCXX/LIBECXX/COMPILER_LIBCXX ports.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.222 2017/07/16 19:19:01 espie Exp $
d14 1
a14 1
REVISION-main=		0
@


1.222
log
@use COMPILER_LIBCXX where applicable
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.221 2017/07/01 11:05:41 ajacoutot Exp $
d13 2
@


1.221
log
@Update to cups-2.2.4.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.220 2017/06/27 08:13:05 ajacoutot Exp $
d30 1
a30 1
WANTLIB += avahi-client avahi-common gnutls iconv m pthread ${LIBCXX} z
@


1.220
log
@Drop /etc/rc.d/init.d from WRKINST. It was never packaged but espie wanted
it gone.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.219 2017/04/10 11:46:32 sthen Exp $
d6 1
a6 1
VERSION=		2.2.3
@


1.219
log
@use LIBCXX
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.218 2017/03/29 20:50:51 ajacoutot Exp $
d124 1
a124 1
	rm -rf ${WRKINST}/etc/rc.d/rc*.d
@


1.218
log
@Update to cups-2.2.3.
naddy agrees about the commit; it'll hopefully lower the amount of emails
I get about "my printer does not work" during a release cycle.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.217 2017/03/10 03:23:29 ajacoutot Exp $
d30 1
a30 1
WANTLIB += avahi-client avahi-common gnutls iconv m pthread stdc++ z
@


1.217
log
@Allow "Negotiate" as an AuthType/DefaultAuthType instead of locally
patching cupsd.conf (from upstream).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.216 2017/01/26 00:56:55 ajacoutot Exp $
d6 1
a6 1
VERSION=		2.2.2
a12 2

REVISION-main=		1
@


1.216
log
@Remove kerberos policy from the default configuration file to prevent cups
from failing to start. Initial breakage reported by Anthony Campbell.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.215 2017/01/19 03:08:52 ajacoutot Exp $
d14 1
a14 1
REVISION-main=		0
@


1.215
log
@Update to cups-2.2.2.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.214 2016/11/11 11:52:35 ajacoutot Exp $
d13 2
@


1.214
log
@net/avahi,no_qt3,no_qt4 does not exist anymore.

spotted by nigel@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.213 2016/10/05 18:28:17 ajacoutot Exp $
d6 1
a6 1
VERSION=		2.2.1
a12 2

REVISION-libs=		0
@


1.213
log
@Update to cups-2.2.1.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.212 2016/09/19 09:16:51 ajacoutot Exp $
d14 2
d43 1
a43 1
LIB_DEPENDS-libs=	net/avahi,no_gui,no_mono,no_qt3,no_qt4,bootstrap \
@


1.212
log
@Update to cups-2.2.0.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.211 2016/06/15 06:42:51 ajacoutot Exp $
d6 1
a6 1
VERSION=		2.2.0
@


1.211
log
@Maintenance update to cups-2.1.4.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.210 2016/05/22 15:44:23 ajacoutot Exp $
d6 4
a9 2
VERSION=		2.1.4
DISTNAME=		cups-${VERSION}-source
d18 1
a18 1
SHARED_LIBS+=  cups            6.3 # so.2
d20 2
a21 2
SHARED_LIBS+=  cupsmime        1.1 # so.1
SHARED_LIBS+=  cupsppdc        1.1 # so.1
a34 4
MASTER_SITES=		https://github.com/apple/cups/releases/download/release-${VERSION}/

WRKDIST=		${WRKDIR}/${DISTNAME:S/-source//}

a36 4
# XXX $(LIBTOOL) is hardcoded in some Makefiles even when *not* using
# --enable-libtool-unsupported
USE_LIBTOOL=		No

d81 1
@


1.210
log
@Fix authentication, needs getpwnam_shadow(3).

breakage reported by Anthony Campbell
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.209 2016/04/12 06:45:36 ajacoutot Exp $
d6 1
a6 1
VERSION=		2.1.3
a7 1
EXTRACT_SUFX=		.tar.bz2
a11 3
REVISION-main=		1
REVISION-libs=		1

d33 1
a33 1
MASTER_SITES=		${HOMEPAGE}software/${VERSION}/
@


1.209
log
@chmod -h 0644 /etc/printcap to please security(8).
prodded by schwarze@@

While here, drop the converters/libiconv MODULE.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.208 2016/03/11 20:28:30 naddy Exp $
d13 2
a14 2
REVISION-main=		0
REVISION-libs=		0
@


1.208
log
@garbage collect CONFIGURE_SHARED
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.207 2016/02/07 15:54:25 ajacoutot Exp $
d13 3
d32 1
a32 3
MODULES=		converters/libiconv

WANTLIB += avahi-client avahi-common gnutls m pthread stdc++ z
@


1.207
log
@Maintenance update to cups-2.1.3.

*yes* this is a maintenance update during soft-lock but considering half of
the help request emails I get during a release cycle are about printing, I
prefer having the most recent code around; it seems UNIX printing is still
somewhat a Black Art for people.

ok sthen@@ jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.206 2015/12/05 07:36:19 ajacoutot Exp $
d89 1
a89 2
CONFIGURE_ARGS=		${CONFIGURE_SHARED} \
			--enable-static \
@


1.206
log
@Update to cups-2.1.2.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.205 2015/12/02 12:37:37 ajacoutot Exp $
d6 1
a6 1
VERSION=		2.1.2
@


1.205
log
@Update to cups-2.1.1.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.204 2015/09/01 16:23:50 ajacoutot Exp $
d6 1
a6 1
VERSION=		2.1.1
@


1.204
log
@Update to cups-2.1.0.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.203 2015/08/27 06:48:30 ajacoutot Exp $
d6 1
a6 1
VERSION=		2.1.0
d78 1
a78 1
AUTOMAKE_VERSION= 	1.14
@


1.203
log
@Fix DBus @@sample files after recent dbus port update.
The dbus package does not install /etc/dbus-1/system.d/ anymore, so it
needs to be properly @@sample'd.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.202 2015/08/21 14:50:24 jasper Exp $
d6 1
a6 1
VERSION=		2.0.4
a12 2
REVISION-main=		0

d17 1
a17 1
SHARED_LIBS+=  cups            6.2 # so.2
@


1.202
log
@sed -i
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.201 2015/08/01 07:18:12 ajacoutot Exp $
d12 2
@


1.201
log
@Maintenance update to cups-2.0.4.
Fixes several bugs in the scheduler, web interface ...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.200 2015/07/12 08:56:50 ajacoutot Exp $
d112 1
a112 1
	cd ${WRKBUILD} && perl -pi -e 's|\$${DESTDIR}||g' \
@


1.200
log
@Put a space after ${daemon} since cupsd always appends some stuffs in the
process list.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.199 2015/07/12 08:42:25 ajacoutot Exp $
d6 1
a6 1
VERSION=		2.0.3
a11 3

REVISION-main=		3
REVISION-libs=		0
@


1.199
log
@Relax pexp to cope with upcoming rc.subr(8) change.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.198 2015/07/07 14:33:34 ajacoutot Exp $
d13 1
a13 1
REVISION-main=		2
@


1.198
log
@Change some obvious sudo usage to '#' in READMEs.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.197 2015/06/09 08:01:13 ajacoutot Exp $
d13 1
a13 1
REVISION-main=		1
@


1.197
log
@Bump to be ahead of -stable.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.196 2015/06/09 07:39:14 ajacoutot Exp $
d13 1
a13 1
REVISION-main=		0
@


1.196
log
@SECURITY update to cups-2.0.3 (CERT VU #810572).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.195 2015/04/04 09:21:03 ajacoutot Exp $
d12 3
@


1.195
log
@Bump after the recent changes in packaging dbus and dconf.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.194 2015/04/04 08:24:37 ajacoutot Exp $
d6 1
a6 1
VERSION=		2.0.2
a11 3
REVISION-libs=		0

REVISION-main=		1
@


1.194
log
@gtk+2-cups is coming back.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.193 2015/03/27 08:14:14 ajacoutot Exp $
d12 1
d14 1
a14 1
REVISION-main=		0
@


1.193
log
@x11/gtk+2,-guic -> x11/gtk+3,-guic && bump
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.192 2015/02/10 08:29:33 ajacoutot Exp $
d12 2
@


1.192
log
@Update to cups-2.0.2.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.191 2014/12/15 12:55:18 ajacoutot Exp $
d128 1
a128 1
# loop: cups->gtk+2,-guic->cups
@


1.192.2.1
log
@SECURITY update to cups-2.0.3.
- fixed CERT VU #810572 exploiting the dynamic linker (STR #4609)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.192 2015/02/10 08:29:33 ajacoutot Exp $
d6 1
a6 1
VERSION=		2.0.3
@


1.191
log
@No need to @@sample /var/log/cups/, it's created automatically.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.190 2014/12/10 10:22:13 ajacoutot Exp $
d6 1
a6 1
VERSION=		2.0.1
a12 2
REVISION-main=		2

d28 2
@


1.190
log
@Fix a libusb issue on OpenBSD (upstream).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.189 2014/12/06 11:12:43 ajacoutot Exp $
d13 1
a13 1
REVISION-main=		1
@


1.189
log
@This hack is unfortunately still needed.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.188 2014/11/15 10:22:23 ajacoutot Exp $
d13 1
a13 1
REVISION-main=		0
@


1.188
log
@Major update to cups-2.0.1.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.187 2014/10/08 12:06:21 ajacoutot Exp $
d12 2
@


1.187
log
@Trailing whitespace.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.186 2014/09/21 12:14:45 ajacoutot Exp $
d6 1
a6 1
VERSION=		1.7.5
a12 2
REVISION-main=		2

d16 5
a20 5
SHARED_LIBS+=	cupsimage	5.0 # so.2
SHARED_LIBS+=	cups		6.1 # so.2
SHARED_LIBS+=	cupscgi		1.0 # so.1
SHARED_LIBS+=	cupsmime	1.0 # so.1
SHARED_LIBS+=	cupsppdc	1.0 # so.1
d29 1
a29 2
WANTLIB += avahi-client avahi-common crypto m pthread ssl stdc++
WANTLIB += z
d48 2
a49 1
LIB_DEPENDS-libs=	net/avahi,no_gui,no_mono,no_qt3,no_qt4,bootstrap
d75 2
a76 2
AUTOCONF_VERSION= 	2.68
AUTOMAKE_VERSION= 	1.9
d83 1
a83 1
			LDFLAGS="-L${LOCALBASE}/lib -pthread" \
a91 1
			--with-optim="${CFLAGS}" \
d94 1
a94 2
			--with-smbconfigfile="samba:///${SYSCONFDIR}/samba/smb.conf" \
			--enable-openssl \
a95 1
			--disable-gnutls \
d97 1
d120 2
a121 2
	rm ${PREFIX}/share/cups/banners/*
	rm ${PREFIX}/share/cups/data/testprint
d129 3
@


1.186
log
@Drop unneeded CONFIGURE_ARGS.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.185 2014/08/28 17:51:43 ajacoutot Exp $
d13 1
a13 1
REVISION-main=		1
@


1.185
log
@README tweaks.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.184 2014/08/15 14:51:03 ajacoutot Exp $
a101 1
			--disable-gssapi \
@


1.184
log
@This patch is still needed for proper USB support.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.183 2014/08/10 07:49:27 ajacoutot Exp $
d13 1
a13 1
REVISION-main=		0
@


1.183
log
@SECURITY update to cups-1.7.5.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.182 2014/07/19 17:07:02 ajacoutot Exp $
d12 2
@


1.182
log
@Do not assume /etc/printcap is always present.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.181 2014/07/15 09:42:31 ajacoutot Exp $
d6 1
a6 1
VERSION=		1.7.4
a11 2

REVISION-main=		0
@


1.182.2.1
log
@Fix USB printing.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.182 2014/07/19 17:07:02 ajacoutot Exp $
d13 1
a13 1
REVISION-main=		1
@


1.182.2.2
log
@Prevent cupsctl from terminating the cupsd process if DBus is not running.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.182.2.1 2014/09/11 09:55:33 ajacoutot Exp $
d13 1
a13 1
REVISION-main=		2
@


1.182.2.3
log
@Validate cupsBitsPerColor, cupsBitsPerPixel, and cupsBytesPerLine to avoid
potential buffer overflow with compressed raster data (STR #4551).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.182.2.2 2014/11/27 13:10:25 ajacoutot Exp $
d13 1
a13 1
REVISION-main=		3
@


1.181
log
@SECURITY update to cups-1.7.4.
The web interface incorrectly served symlinked files and files
that were not world-readable, potentially leading to a disclosure of
information (STR #4450)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.180 2014/07/12 13:41:47 ajacoutot Exp $
d12 2
@


1.180
log
@pkg_scripts is not a variable anymore.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.179 2014/07/10 13:09:06 ajacoutot Exp $
d6 1
a6 1
VERSION=		1.7.3
a11 2

REVISION-main=		1
@


1.179
log
@rc.conf.local is in man(1) section 8, at least for now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.178 2014/05/28 08:04:47 ajacoutot Exp $
d13 1
a13 1
REVISION-main=		0
@


1.178
log
@Update to cups-1.7.3.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.177 2014/04/28 13:37:32 ajacoutot Exp $
d12 2
@


1.177
log
@Fix a nasty bug in rc_pre() that would start 2 intances of the cupsd daemon.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.176 2014/04/21 11:26:01 ajacoutot Exp $
d6 1
a6 1
VERSION=		1.7.2
a11 3

REVISION-main=		1
REVISION-libs=		0
@


1.176
log
@--disable-gssapi
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.175 2014/04/10 17:15:34 ajacoutot Exp $
d13 1
a13 1
REVISION-main=		0
@


1.175
log
@SECURITY update to cups-1.7.2.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.174 2014/04/03 12:50:20 ajacoutot Exp $
d13 3
d32 2
a33 2
WANTLIB += asn1 avahi-client avahi-common crypto gssapi krb5 m pthread
WANTLIB += com_err heimbase roken wind ssl stdc++ z
d103 1
@


1.174
log
@This should not be needed anymore.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.173 2014/03/09 21:46:34 ajacoutot Exp $
d6 1
a6 1
VERSION=		1.7.1
a12 3
REVISION-main=		2
REVISION-libs=		0

d76 1
a76 1
AUTOMAKE_VERSION= 	1.10
@


1.173
log
@rcexec is needed in rc_pre().
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.172 2014/01/19 09:09:45 ajacoutot Exp $
d13 2
a14 1
REVISION-main=		1
@


1.172
log
@Properly set the @@mode markers because espie's paranoid mode checker for
pkg_create(1) is committed.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.171 2014/01/08 18:13:56 ajacoutot Exp $
d13 1
a13 1
REVISION-main=		0
@


1.172.2.1
log
@SECURITY: The scheduler now blocks URLs containing embedded HTML
http://www.cups.org/str.php?L4356
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.172 2014/01/19 09:09:45 ajacoutot Exp $
d13 1
a13 1
REVISION-main=		1
@


1.172.2.2
log
@Security: The web interface incorrectly served symlinked files and files
that were not world-readable, potentially leading to a disclosure of
information (STR #4450)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.172.2.1 2014/04/11 07:01:22 ajacoutot Exp $
d13 1
a13 1
REVISION-main=		2
@


1.172.2.3
log
@Security: Addressed some more situations where symlinked files would be
served by the web interface (STR #4455).
(Incomplete fix for CVE-2014-3537 (CVE-2014-5029/5030/5031))
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.172.2.2 2014/07/15 09:50:01 ajacoutot Exp $
d13 1
a13 1
REVISION-main=		3
@


1.171
log
@Update to cups-1.7.1.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.170 2013/12/12 15:22:17 ajacoutot Exp $
d12 2
@


1.170
log
@Clarify a bit.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.169 2013/12/12 14:48:31 ajacoutot Exp $
d6 1
a6 1
VERSION=		1.7.0
a11 2

REVISION-main=		3
@


1.169
log
@Drop @@exec-update and instead remove the cache from the rc.d script.
No need to change ulpt(4) ownership, CUPS only supports libusb.
Small README tweak while here.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.168 2013/11/02 01:17:47 ajacoutot Exp $
d13 1
a13 1
REVISION-main=		2
@


1.168
log
@Remove uneeded CONFIGURE_ARGS.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.167 2013/10/30 08:35:55 ajacoutot Exp $
d13 1
a13 1
REVISION-main=		1
@


1.167
log
@Fix job history, from upstream via Fedora.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.166 2013/10/27 08:50:17 ajacoutot Exp $
d13 1
a13 1
REVISION-main=		0
a100 1
			--disable-libpaper \
@


1.166
log
@Update to cups-1.7.0.
Please report any regression directly to me, thanks.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.165 2013/10/22 19:59:18 jca Exp $
d12 2
@


1.165
log
@Fixup after arc4random_addrandom/arc4random_stir removal.
If we can detect arc4random but not mentioned functions, then we don't
need to use them.  ok naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.164 2013/09/25 08:39:25 ajacoutot Exp $
d6 1
a6 2
VERSION=		1.6.4
REVISION=		0
d15 6
a20 5
SHARED_LIBS+=	cupsimage	5.0
SHARED_LIBS+=	cups		6.1
SHARED_LIBS+=	cupscgi		1.0
SHARED_LIBS+=	cupsmime	1.0
SHARED_LIBS+=	cupsppdc	1.0
@


1.164
log
@Update to cups-1.6.4.
Move some common directories from -main -libs so that they get stripped
from the PLIST of dependant ports.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.163 2013/08/21 13:36:09 ajacoutot Exp $
d7 1
@


1.163
log
@Point users to the pkg-readmes directory.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.162 2013/08/15 14:54:27 ajacoutot Exp $
d6 1
a6 2
VERSION=		1.6.3
REVISION=		0
a11 3

REVISION-main=		1
REVISION-libs=		0
@


1.162
log
@Remove, we have 64-bit time_t.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.161 2013/07/13 11:55:12 sthen Exp $
d14 1
a14 1
REVISION-main=		0
@


1.161
log
@bump REVISION to make sure people don't accidentally have a copy of
this which is linked to libbind.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.160 2013/07/12 07:19:38 ajacoutot Exp $
d13 3
@


1.161.2.1
log
@SECURITY: The scheduler now blocks URLs containing embedded HTML
http://www.cups.org/str.php?L4356
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.161 2013/07/13 11:55:12 sthen Exp $
d7 1
a9 3

REVISION-main=		1
REVISION-libs=		0
@


1.160
log
@Update to cups-1.6.3.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.159 2013/06/20 06:54:37 ajacoutot Exp $
d7 1
@


1.159
log
@Unbreak after hx509 and ntlm removal from Kerberos.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.158 2013/06/17 19:31:01 ajacoutot Exp $
d6 1
a6 1
VERSION=		1.6.2
a11 3

REVISION-main=		3
REVISION-libs=		1
@


1.158
log
@Unbreak with new Heimdal; get rid of self-cooked krb5-config since we
have it in base now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.157 2013/06/04 18:41:55 naddy Exp $
d13 2
a14 2
REVISION-main=		2
REVISION-libs=		0
d32 1
a32 1
WANTLIB += com_err heimbase heimntlm hx509 roken wind ssl stdc++ z
@


1.157
log
@the png headers are now directly under include/
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.156 2013/05/17 13:47:44 ajacoutot Exp $
d13 2
a14 1
REVISION-main=		1
d32 1
a32 1
WANTLIB += ssl stdc++ z
a105 3

post-extract:
	${INSTALL} -m 555 ${FILESDIR}/krb5-config ${WRKDIR}/bin
@


1.156
log
@Add documentation about DNS-SD print sharing.
Fix a typo in README.
Better MASTER_SITES.

all this excellent work done by Martin Crossley
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.155 2013/04/03 15:19:01 ajacoutot Exp $
d83 1
a83 2
CONFIGURE_ENV=		CPPFLAGS="-I${LOCALBASE}/include \
				-I${LOCALBASE}/include/libpng" \
@


1.155
log
@Unbreak the USB backend.

spotted by Martin Crossley
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.154 2013/03/21 08:33:51 landry Exp $
d13 1
a13 1
REVISION-main=		0
d36 1
a36 6
MASTER_SITES=		http://ftp.easysw.com/pub/cups/${VERSION}/ \
			http://ftp.funet.fi/pub/mirrors/ftp.easysw.com/pub/cups/${VERSION}/ \
			ftp://ftp.funet.fi/pub/mirrors/ftp.easysw.com/pub/cups/${VERSION}/ \
			ftp://ftp.easysw.com/pub/cups/${VERSION}/ \
			ftp://ftp2.easysw.com/pub/cups/${VERSION}/ \
			ftp://ftp3.easysw.com/pub/cups/${VERSION}/
@


1.154
log
@Explicitely set USE_LIBTOOL=No for ports we know don't work with our
libtool.
Joint work with ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.153 2013/03/19 08:49:14 ajacoutot Exp $
d12 2
@


1.153
log
@Update to cups-1.6.2.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.152 2013/03/14 07:22:33 brad Exp $
d44 4
@


1.152
log
@Fix cups-config to not cause overlinking when using shared libs.

Run through a bulk build.

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.151 2013/03/11 11:37:53 espie Exp $
d6 1
a6 1
VERSION=		1.6.1
a9 3
REVISION-main=		14
REVISION-libs=		6

d70 1
a70 1
			DBUSDIR=${PREFIX}/share/examples/cups/dbus-1/system.d \
@


1.151
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.150 2013/02/04 14:46:24 ajacoutot Exp $
d10 2
a11 2
REVISION-main=		13
REVISION-libs=		5
@


1.150
log
@Fix man pages renaming.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.149 2013/01/06 08:58:24 ajacoutot Exp $
a29 3
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
@


1.149
log
@Remove now useless LIB_DEPENDS.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.148 2013/01/06 08:42:08 ajacoutot Exp $
d10 1
a10 1
REVISION-main=		12
@


1.148
log
@tyop
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.147 2013/01/05 16:36:08 ajacoutot Exp $
d10 1
a10 1
REVISION-main=		11
d58 1
a58 2
			devel/libusb1 \
			x11/dbus
@


1.147
log
@Document printer sharing.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.146 2013/01/05 12:47:45 ajacoutot Exp $
d10 1
a10 1
REVISION-main=		10
@


1.146
log
@Add avahi support. Apple removed the CUPS polling daemon so this is the
only way we can browse for shared printers.

discussed with and agreed by several
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.145 2012/10/19 07:18:28 ajacoutot Exp $
d10 1
a10 1
REVISION-main=		9
@


1.145
log
@@@exec-update takes care of the cache.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.144 2012/10/01 12:47:55 ajacoutot Exp $
d10 2
a11 2
REVISION-main=		8
REVISION-libs=		4
d34 1
a34 1
WANTLIB += asn1 crypto gssapi krb5 m pthread
d54 7
a69 4
LIB_DEPENDS-main=	${BASE_PKGPATH},-libs \
			devel/libusb1 \
			x11/dbus

a101 1
			--with-perl="/usr/bin/perl" \
a103 2
			--enable-libusb \
			--enable-dbus \
a108 1
			--disable-default-shared \
a111 4

# XXX FLAVOR?; adds to many dependencies to cups,-libs
CONFIGURE_ARGS +=	--disable-avahi \
			--disable-dnssd
@


1.144
log
@Better patch from upstream.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.143 2012/09/28 13:04:20 dcoppa Exp $
d10 1
a10 1
REVISION-main=		7
@


1.143
log
@Don't create the shared libs using soname.

No objections from ajacoutot@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.142 2012/09/28 10:19:28 ajacoutot Exp $
d10 1
a10 1
REVISION-main=		6
@


1.142
log
@Fix the @@exec-update call.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.141 2012/09/27 10:07:55 giovanni Exp $
d10 2
a11 2
REVISION-main=		5
REVISION-libs=		3
@


1.141
log
@
Add a workaround to prevent cups-driverd(8) from crashing on every update
help and ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.140 2012/09/08 07:54:03 ajacoutot Exp $
d10 1
a10 1
REVISION-main=		4
@


1.140
log
@Create both the _cups user and group in -libs instead of splitting them.
Regen WANTLIB while here.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.139 2012/08/23 16:25:48 ajacoutot Exp $
d10 1
a10 1
REVISION-main=		3
@


1.139
log
@Don't use CONFIGURE_STYLE=dest, it fucks things up.
Bring a couple of patches from CUPS str.
Remove the lpthread patch.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.138 2012/08/05 13:47:04 naddy Exp $
d10 2
a11 2
REVISION-main=		2
REVISION-libs=		2
d34 1
a34 1
WANTLIB += asn1 c crypto gssapi krb5 m pthread
d38 1
a38 1
WANTLIB-main += cups cupscgi cupsimage cupsmime cupsppdc dbus-1 usb-1.0
@


1.138
log
@no need for groff
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.137 2012/08/05 06:19:40 ajacoutot Exp $
d10 2
a11 2
REVISION-main=		1
REVISION-libs=		1
d34 1
a34 1
WANTLIB += asn1 crypto gssapi krb5 m
d38 1
a38 2
WANTLIB-main += c cups cupscgi cupsimage cupsmime cupsppdc dbus-1 pthread
WANTLIB-main += usb-1.0
d73 5
a77 6
FAKE_FLAGS=		BINMODE=${BINMODE} \
			SHAREMODE=${SHAREMODE} \
			DBUSDIR=${DESTDIR}${PREFIX}/share/examples/cups/dbus-1/system.d \
			ICONDIR=${DESTDIR}${PREFIX}/share/icons \
			MENUDIR=${DESTDIR}${PREFIX}/share/applications \
			SERVERROOT=${DESTDIR}${PREFIX}/share/examples/cups
d91 1
a91 1
CONFIGURE_STYLE=	 gnu dest
@


1.137
log
@Add missing marker for print/cups.
Remove ldap FLAVOR description from DESCR.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.136 2012/08/04 18:01:28 ajacoutot Exp $
a84 1
USE_GROFF=		Yes
@


1.136
log
@Split REVISION between subpackages; no pkg change.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.135 2012/08/04 17:53:06 ajacoutot Exp $
d10 2
a11 2
REVISION-main=		0
REVISION-libs=		0
@


1.135
log
@Remove XXX.
Bump minor which I forgot in previous.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.134 2012/08/04 14:37:04 ajacoutot Exp $
d9 3
a11 1
REVISION=		0
@


1.134
log
@Major update to CUPS 1.6.1.
This package is now split between -main (the bloat) and -libs (i.e.
cups-libs; which only contains the base libraries which have no
external deps).
Most filters have moved to cups-filters, the split was needed because
cups depends on cups-filters which depends on cups

The nice side-effect is that this will simplify lots of things in tree.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.133 2012/06/20 14:54:40 ajacoutot Exp $
d9 1
a15 1
# XXX ghostscript needs to dlopen() libcupsimage.so.5 for the cups device.
d17 1
a17 1
SHARED_LIBS+=	cups		6.0
@


1.133
log
@Tweak README.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.132 2012/06/01 07:55:12 ajacoutot Exp $
d3 2
a4 1
COMMENT=	Common Unix Printing System
d6 3
a8 4
VERSION=	1.5.3
DISTNAME=	cups-${VERSION}-source
PKGNAME=	cups-${VERSION}
REVISION=	5
d10 4
a13 1
CATEGORIES=	print sysutils
a18 1
SHARED_LIBS+=	cupsdriver	1.0
d22 1
a22 1
HOMEPAGE=	http://www.cups.org/
d24 1
a24 1
MAINTAINER=	Antoine Jacoutot <ajacoutot@@openbsd.org>
d32 2
a33 2
WANTLIB += asn1 c crypto dbus-1 gssapi jpeg krb5 m png pthread
WANTLIB += ssl stdc++ tiff usb-1.0 z
d35 83
a117 82
MASTER_SITES=	http://ftp.easysw.com/pub/cups/${VERSION}/ \
		http://ftp.funet.fi/pub/mirrors/ftp.easysw.com/pub/cups/${VERSION}/ \
		ftp://ftp.funet.fi/pub/mirrors/ftp.easysw.com/pub/cups/${VERSION}/ \
		ftp://ftp.easysw.com/pub/cups/${VERSION}/ \
		ftp://ftp2.easysw.com/pub/cups/${VERSION}/ \
		ftp://ftp3.easysw.com/pub/cups/${VERSION}/

EXTRACT_SUFX=	.tar.bz2

WRKDIST=	${WRKDIR}/${DISTNAME:S/-source//}

BUILD_DEPENDS=	devel/xdg-utils \
		${MODGNU_AUTOMAKE_DEPENDS} \
		${MODGNU_AUTOCONF_DEPENDS}

LIB_DEPENDS=	graphics/png \
		graphics/tiff \
		devel/libusb1 \
		x11/dbus

LIBS_ENV=	LIBcups_VERSION=${LIBcups_VERSION} \
		LIBcupscgi_VERSION=${LIBcupscgi_VERSION} \
		LIBcupsdriver_VERSION=${LIBcupsdriver_VERSION} \
		LIBcupsimage_VERSION=${LIBcupsimage_VERSION} \
		LIBcupsmime_VERSION=${LIBcupsmime_VERSION} \
		LIBcupsppdc_VERSION=${LIBcupsppdc_VERSION} \

FAKE_FLAGS=	BINMODE=${BINMODE} \
		SHAREMODE=${SHAREMODE} \
		DBUSDIR=${DESTDIR}${PREFIX}/share/examples/cups/dbus-1/system.d \
		ICONDIR=${DESTDIR}${PREFIX}/share/icons \
		MENUDIR=${DESTDIR}${PREFIX}/share/applications \
		SERVERROOT=${DESTDIR}${PREFIX}/share/examples/cups

AUTOCONF_VERSION= 2.68
AUTOMAKE_VERSION= 1.10

USE_GMAKE=	Yes
USE_GROFF=	Yes

MAKE_ENV=	${LIBS_ENV}

CONFIGURE_ENV=	CPPFLAGS="-I${LOCALBASE}/include \
			-I${LOCALBASE}/include/libpng" \
		LDFLAGS="-L${LOCALBASE}/lib -pthread" \
		${LIBS_ENV}

CONFIGURE_STYLE= gnu dest
CONFIGURE_ARGS=	${CONFIGURE_SHARED} \
		--enable-static \
		--with-cups-group=_cups \
		--with-cups-user=_cups \
		--with-system-groups=wheel \
		--with-optim="${CFLAGS}" \
		--with-dbusdir=${SYSCONFDIR}/dbus-1 \
		--with-pdftops=${LOCALBASE}/bin/gs \
		--with-perl="/usr/bin/perl" \
		--with-printcap=${SYSCONFDIR}/cups/printcap \
		--with-smbconfigfile="samba:///${SYSCONFDIR}/samba/smb.conf" \
		--enable-dbus \
		--enable-raw-printing \
		--enable-libusb \
		--disable-cdsassl \
		--disable-default-shared \
		--disable-dnssd \
		--disable-gnutls \
		--disable-launchd \
		--disable-pam \
		--disable-pap \
		--disable-slp \
		--disable-tcp-wrappers

FLAVORS=	ldap
FLAVOR?=

.if ${FLAVOR:L:Mldap}
CONFIGURE_ARGS+= --enable-ldap
WANTLIB +=	ldap
LIB_DEPENDS+=	databases/openldap
.else
CONFIGURE_ARGS+=--disable-ldap
.endif
d123 5
a127 3
	cd ${WRKSRC} && AUTOMAKE_VERSION=${AUTOMAKE_VERSION} AUTOCONF_VERSION=${AUTOCONF_VERSION} aclocal -I config-scripts
	cd ${WRKSRC} && AUTOMAKE_VERSION=${AUTOMAKE_VERSION} AUTOCONF_VERSION=${AUTOCONF_VERSION} autoconf -I config-scripts
	${SUBST_CMD} ${WRKSRC}/Makedefs.in
d131 1
a131 2
		config.h cups-config man/*.man conf/cupsd.conf \
		doc/help/*.html
d136 6
@


1.132
log
@Remove '${DESTDIR}' from the html pages.

from gjones
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.131 2012/05/28 15:18:18 ajacoutot Exp $
d8 1
a8 1
REVISION=	4
@


1.131
log
@/etc/cups -> SYSCONFDIR/cups

spotted by Mikolaj Kucharski
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.130 2012/05/26 06:43:38 ajacoutot Exp $
d8 1
a8 1
REVISION=	3
d126 2
a127 1
		config.h cups-config man/*.man
@


1.130
log
@Err stupid me. Revert previous otherwise we won't get printer updates in
the printcap. I'll have to think about something else...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.129 2012/05/26 06:26:04 ajacoutot Exp $
d8 1
a8 1
REVISION=	2
@


1.129
log
@Please security(8): cat the content of the CUPS printcap file into
/etc/printcap(5) instead of creating a link.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.128 2012/05/18 16:31:22 ajacoutot Exp $
d8 1
a8 1
REVISION=	1
@


1.128
log
@Slightly different patch from upstream.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.127 2012/05/17 10:11:23 ajacoutot Exp $
d8 1
a8 1
REVISION=	0
@


1.127
log
@Update to cups-1.5.3.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.126 2012/04/28 10:52:08 ajacoutot Exp $
d8 1
@


1.126
log
@--localstatedir=/var is the default now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.125 2012/04/22 11:41:55 ajacoutot Exp $
d5 1
a5 1
VERSION=	1.5.2
a7 1
REVISION=	1
d30 1
a30 1
WANTLIB += ssl stdc++ tiff usb z
d49 1
a49 1
		devel/libusb-compat \
d66 2
a67 2
AUTOCONF_VERSION= 2.61
AUTOMAKE_VERSION= 1.9
@


1.125
log
@Use RCDIR instead of /etc/rc.d when refering to packages rc scripts.

discussed with espie and sthen
ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.124 2012/02/17 07:45:10 ajacoutot Exp $
a82 1
		--localstatedir=/var \
@


1.124
log
@Make sure we use ghostscript as pdftops interpreter but do _not_ depend
on it being installed at build time (cyclic dependency).

breakage reported by nigel@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.123 2012/02/16 22:12:08 ajacoutot Exp $
d8 1
a8 1
REVISION=	0
@


1.123
log
@Update to cups-1.5.2.
While here, create cups's printcap under /etc/cups/ because we are
running unpriviledged so we cannot touch /etc/printcap.
Tweak rc script accordingly.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.122 2012/02/02 07:11:19 ajacoutot Exp $
d8 1
d89 1
@


1.122
log
@Remove bogus symlink which can make cups-driverd go into a loop.
Add a note about updating to a new major version (may require to revove
the cache).
Check the configuration file sanity in rc_pre().

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.121 2011/12/04 15:40:57 ajacoutot Exp $
d5 1
a5 1
VERSION=	1.5.0
a8 2
REVISION=	8

d11 1
a11 1
# XXX ghostscript needs to dlopen() libcupsimage.so.5
d82 2
a84 1
		--with-cups-group=_cups \
d86 2
a87 2
		--localstatedir=/var \
		--without-java \
d89 1
a89 1
		--with-optim="${CFLAGS}" \
a90 4
		--with-pdftops="${LOCALBASE}/bin/gs" \
		--without-php \
		--without-python \
		--enable-image \
a91 1
		--enable-texttops \
a92 2
		--enable-gssapi \
		--enable-openssl \
d94 3
d98 1
a99 1
		--disable-launchd \
d102 1
a102 2
		--disable-tcp-wrappers \
		--disable-default-shared
a112 5
.endif

# needed otherwise cups will strip binaries even with INSTALL_STRIP=
.if defined(DEBUG)
CONFIGURE_ARGS += --enable-debug
@


1.121
log
@Remove desktop file and icons; we don't really need them (it's just a
launcher for http://localhost:631 and we may actually want to
configure a remote server); this is needed to prevent a dependency
loop: cups->gtk+2,-guic->cups.

This also allows us to drop 3 dependencies...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.120 2011/12/04 14:21:11 ajacoutot Exp $
d9 1
a9 1
REVISION=	7
a147 7

# Create a link to foomatic drivers database; we do it here instead of
# using --enable-ppds-to-cups in the foomatic-db port so that we don't
# need to depend on it (other printer driver packages install PPDs under
# ${PREFIX}/share/foomatic/db/source/PPD too, e.g. foo2zjs, hpijs...).
	ln -sf ${LOCALBASE}/share/foomatic/db/source/PPD \
		${PREFIX}/share/cups/model/foomatic-db-ppds
@


1.120
log
@Temporarily remove dependency on x11/gtk+2,-guic until I figure out a way
to fix the dependency loop.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.119 2011/12/03 23:04:37 ajacoutot Exp $
d9 1
a9 1
REVISION=	6
d31 2
a32 2
WANTLIB += 	asn1 c crypto dbus-1>=7 gssapi jpeg krb5 m png>=3 pthread
WANTLIB +=	ssl stdc++ tiff>=35 z usb
a48 4
RUN_DEPENDS=	devel/desktop-file-utils \
		devel/xdg-utils
#		x11/gtk+2,-guic

d142 8
a149 1
# Create a link to foomatic drivers database ; we do it here instead of
@


1.119
log
@Add a dependency on x11/gtk+2,-guic.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.118 2011/11/13 13:54:04 ajacoutot Exp $
d9 1
a9 1
REVISION=	5
d50 2
a51 2
		devel/xdg-utils \
		x11/gtk+2,-guic
@


1.118
log
@Sync dependencies after move from libusb to libusb-compat and fix a
couple of fallouts. Note that these ports are only the ones that used to
have a direct dependency on devel/libusb so there may be some other
hidden ports that may break because of the switch. If that's the case,
no need to start ranting all over but instead tell me which one(s)
break. Thanks.

Note: sysutils/nut hasn't been fixed yet but will be today.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.117 2011/10/19 12:59:55 ajacoutot Exp $
d9 1
a9 1
REVISION=	4
d50 2
a51 1
		devel/xdg-utils
@


1.117
log
@Only remove the cache dir on extraunexec.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.116 2011/10/15 07:20:43 ajacoutot Exp $
d9 1
a9 1
REVISION=	3
d54 1
a54 1
		devel/libusb \
d81 1
a81 1
		LDFLAGS="-L${LOCALBASE}/lib" \
@


1.116
log
@Increase timeout for driverd to give it enough time to copy a ppd file when
using the web interface.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.115 2011/10/02 14:41:48 ajacoutot Exp $
d9 1
a9 1
REVISION=	2
@


1.115
log
@Adapt documentation after the update to 1.5.0.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.114 2011/09/30 07:33:59 ajacoutot Exp $
d9 1
a9 1
REVISION=	1
@


1.114
log
@Merge a patch from upstream svn to fix a segfault with cups-driverd.

crash reported by and ok giovanni@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.113 2011/09/08 10:33:12 ajacoutot Exp $
d9 1
a9 1
REVISION=	0
@


1.113
log
@Major update to cups-1.5.0.

Thanks to landry@@ for the bulk testing.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.112 2011/08/31 12:43:08 ajacoutot Exp $
d9 2
d122 5
@


1.112
log
@SECURITY: CVE-2011-2896 GIF decoder LZW decoder buffer overflow
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.111 2011/08/25 09:50:20 ajacoutot Exp $
d5 1
a5 1
VERSION=	1.4.8
a8 8
REVISION=	0

# Allow both ulpt(4) and libusb based backends to work together.
# See http://www.cups.org/str.php?L3357
PATCHFILES=	usb-backend-both-usblp-and-libusb.dpatch:0
MASTER_SITES0=	http://www.cups.org/strfiles/3357/
PATCH_DIST_STRIP= -p1

d11 7
a17 7
# XXX ghostscript needs to dlopen() libcupsimage.so.4
SHARED_LIBS+=	cupsimage	4.0
SHARED_LIBS+=	cups		5.0
SHARED_LIBS+=	cupscgi		0.0
SHARED_LIBS+=	cupsdriver	0.0
SHARED_LIBS+=	cupsmime	0.0
SHARED_LIBS+=	cupsppdc	0.0
a61 2
MAKE_ENV=	${LIBS_ENV}

d75 7
a96 1
		--enable-tcp-wrappers \
d108 1
a109 5

CONFIGURE_ENV=	CPPFLAGS="-I${LOCALBASE}/include \
			-I${LOCALBASE}/include/libpng" \
		LDFLAGS="-L${LOCALBASE}/lib" \
		${LIBS_ENV}
@


1.111
log
@Small bugfix update to cups-1.4.8.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.110 2011/07/06 16:03:08 ajacoutot Exp $
d8 2
@


1.110
log
@Advise users to install gstoraster. We cannot make it a RUN_DEPENDS because
of a cyclic dependency:
cups -> gstoraster -> ghostscript -> cups
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.109 2011/07/06 14:49:02 ajacoutot Exp $
d5 1
a5 1
VERSION=	1.4.7
a7 2

REVISION=	0
@


1.109
log
@Put comment back, it was a misunderstanding from my side, prompted by kili@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.108 2011/07/06 01:01:27 ajacoutot Exp $
d8 2
@


1.108
log
@Remove outdated comment.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.107 2011/06/28 11:52:38 ajacoutot Exp $
d17 1
@


1.107
log
@Update to cups-1.4.7.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.106 2011/06/02 13:41:40 ajacoutot Exp $
a16 1
# XXX ghostscript needs to dlopen() libcupsimage.so.4
@


1.106
log
@Add a consistent header that substitutes FULLPKGNAME for the READMEs.

ok jasper@@ sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.105 2011/05/26 12:52:48 ajacoutot Exp $
d5 1
a5 1
VERSION=	1.4.6
a7 2

REVISION=	10
@


1.105
log
@Adjust README for gtk+3.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.104 2011/05/11 07:45:53 ajacoutot Exp $
d9 1
a9 1
REVISION=	9
@


1.104
log
@Sanitize some @@unexec/@@extraunexec calls to rm: move them up in the
PLIST and delete everything under the @@sample'd directory instead of the
directory itself to prevent a warning from pkg_delete(1) trying to
remove a non existing directory and to help preventing left-over files
and directories.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.103 2011/04/28 17:21:17 ajacoutot Exp $
d9 1
a9 1
REVISION=	8
@


1.103
log
@Use the gtk-print stock icon instead of the ugly cups one.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.102 2011/04/28 05:47:49 ajacoutot Exp $
d9 1
a9 1
REVISION=	7
@


1.102
log
@Use proper AUTOCONF_VERSION, from Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.101 2011/04/16 14:59:54 ajacoutot Exp $
d9 1
a9 1
REVISION=	6
@


1.101
log
@Extend README, after a discussion with oga@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.100 2011/04/06 16:50:26 ajacoutot Exp $
d79 1
a79 1
AUTOCONF_VERSION= 2.62
@


1.100
log
@cupsd rewrites its arguments, so add a pexp to the rc script.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.99 2011/03/24 15:17:28 ajacoutot Exp $
d9 1
a9 1
REVISION=	5
@


1.99
log
@Make sure we don't enter interactive mode in rc_post by using 'mv -f'.
Fix shutdown/reboot issues reported by Tomas Bodzar.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.98 2011/03/09 13:05:20 ajacoutot Exp $
d9 1
a9 1
REVISION=	4
@


1.98
log
@Use the same trick as in nut to identify the /dev/{ugen,usb}* we want.

discussed with and ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.97 2011/03/02 06:49:38 ajacoutot Exp $
d9 1
a9 1
REVISION=	3
@


1.97
log
@Add ${SYSCONFDIR}/cups/ppd/ as a @@sample.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.96 2011/01/17 23:24:40 ajacoutot Exp $
d9 1
a9 1
REVISION=	2
@


1.96
log
@Tweaks, from discussion with jakemsr@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.95 2011/01/16 23:03:10 ajacoutot Exp $
d9 1
a9 1
REVISION=	1
@


1.95
log
@Fix README after recent ugen(4) changes from jakemsr@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.94 2011/01/11 12:13:59 ajacoutot Exp $
d9 1
a9 1
REVISION=	0
@


1.94
log
@Update to cups-1.4.6, this version fixes landscape printing, sharing,
and fax issues.

Also merge a patch from upstream to disable multi-part support as
several browsers (notably webkit based ones) do not support it
correctly, this should fix the web interface with these browsers. See
http://www.cups.org/str.php?L3455 for details.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.93 2010/12/30 12:55:02 ajacoutot Exp $
d8 2
@


1.93
log
@Mention gtk+2-cups.

prodded by Jiri B.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.92 2010/12/27 14:50:23 ajacoutot Exp $
d5 1
a5 1
VERSION=	1.4.5
a7 2

REVISION=	5
@


1.92
log
@Simplify after recent rc.subr change.
The framework is now stable and we will start documenting it (at last).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.91 2010/12/24 10:40:06 ajacoutot Exp $
d9 1
a9 1
REVISION=	4
@


1.91
log
@Cope with recent rc.subr changes.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.90 2010/12/20 14:43:42 ajacoutot Exp $
d9 1
a9 1
REVISION=	3
@


1.90
log
@Some rewording a tweaks.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.89 2010/12/20 11:39:48 ajacoutot Exp $
d9 1
a9 1
REVISION=	2
@


1.89
log
@Unbreak ulpt(4) printing.

Add libusb support. Bring a patch from upstream bug DB that allows for
both ulpt(4) and libusb based devices to work without the need for
separate packages.

Remove the useless rc patch (we provide our own).

Move MESSAGE to README and extend it.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.88 2010/11/30 08:09:09 ajacoutot Exp $
d9 1
a9 1
REVISION=	1
@


1.88
log
@Don't try and change ownership on files that don't exist.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.87 2010/11/20 09:48:39 espie Exp $
d9 7
a15 1
REVISION=	0
d38 1
a38 1
WANTLIB +=	ssl stdc++ tiff>=35 z
d60 1
d83 1
a83 1
USE_GROFF =	Yes
d106 1
a107 1
		--disable-libusb \
d116 1
a116 1
		LDFLAGS="-L${LOCALBASE}/lib -pthread" \
@


1.87
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.86 2010/11/12 07:09:00 ajacoutot Exp $
d8 2
@


1.86
log
@This release fixes several scheduler and printing bugs as well as a reported
security bug (which kili@@ already patched for in previous commmit).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.85 2010/11/10 12:53:09 kili Exp $
d29 2
a30 2
WANTLIB += 	asn1 c crypto dbus-1.>=7 gssapi jpeg krb5 m png.>=3 pthread
WANTLIB +=	ssl stdc++ tiff.>=35 z
d43 1
a43 1
BUILD_DEPENDS=	::devel/xdg-utils \
d47 2
a48 2
RUN_DEPENDS=	:desktop-file-utils-*:devel/desktop-file-utils \
		::devel/xdg-utils
d50 3
a52 3
LIB_DEPENDS=	::graphics/png \
		::graphics/tiff \
		::x11/dbus
d115 2
a116 1
LIB_DEPENDS+=	ldap::databases/openldap
@


1.85
log
@Security patch: CVE-2010-2941 (from redhat).

ok ajacoutot@@ (maintainer)

For increased fun, read the ticket at redhat:
https://bugzilla.redhat.com/show_bug.cgi?id=624438
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.84 2010/11/05 07:51:57 landry Exp $
d5 1
a5 1
VERSION=	1.4.4
a7 1
REVISION=	7
@


1.84
log
@Propagate AUTO{MAKE,CONF}_VERSION to aclocal/autoconf calls. Fixes build
with upcoming metaauto change.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.83 2010/10/29 12:54:44 ajacoutot Exp $
d8 1
a8 1
REVISION=	6
@


1.83
log
@Add RCS IDs to rc scripts.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.82 2010/10/28 15:12:49 ajacoutot Exp $
d125 2
a126 2
	cd ${WRKSRC} && AUTOMAKE_VERSION=${AUTOMAKE_VERSION} aclocal -I config-scripts
	cd ${WRKSRC} && AUTOCONF_VERSION=${AUTOCONF_VERSION} autoconf -I config-scripts
@


1.82
log
@Merge the cups-enable and cups-disable scripts into the rc script.
idea from and ok robert@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.81 2010/10/27 15:42:06 ajacoutot Exp $
d8 1
a8 1
REVISION=	5
@


1.81
log
@As agreed with espie@@, install a first rc script to serve as a test
example. A couple of things are still missing from the infrastructure
but the basics work. When everything has been taken care of, we'll start
mocing all ports to using the new rc system.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.80 2010/10/18 21:25:08 espie Exp $
d8 1
a8 1
REVISION=	4
a135 5
.for file in cups-enable cups-disable
	cp ${FILESDIR}/${file} ${WRKBUILD}
	${SUBST_CMD} ${WRKBUILD}/${file}
	${INSTALL_SCRIPT} ${WRKBUILD}/${file} ${PREFIX}/sbin
.endfor
@


1.80
log
@USE_GROFF=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.79 2010/10/12 12:53:15 ajacoutot Exp $
d8 1
a8 1
REVISION=	3
@


1.79
log
@Clean up the cups-*able scripts.
Do not move out lptest as CUPS has no counterpart as spotted by armani@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.78 2010/08/22 10:48:41 ajacoutot Exp $
d75 1
@


1.78
log
@Remove some left over text in lp.man.

spotted by tedu@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.77 2010/07/26 20:07:31 edd Exp $
d8 1
a8 1
REVISION=	2
@


1.77
log
@Convert a whole bunch of ports/print to use new WANTLIB/LIB_DEPENDS/REVISION.
OK aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.76 2010/07/13 12:50:44 sebastia Exp $
d8 1
a8 1
REVISION=	1
@


1.76
log
@fix build on gcc-2.95 archs
OK ajacoutot@@, landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.75 2010/07/02 07:52:08 ajacoutot Exp $
d30 2
a31 2
WANTLIB += asn1 c crypto gssapi jpeg krb5 m pthread ssl stdc++
WANTLIB += z
d51 3
a53 3
LIB_DEPENDS=	png.>=3::graphics/png \
		tiff.>=35::graphics/tiff \
		dbus-1.>=7::x11/dbus
@


1.75
log
@Fix SO_PEERCRED fallout.

from Moritz Grimm.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.74 2010/06/27 04:18:50 ajacoutot Exp $
d7 2
a8 1
PKGNAME=	cups-${VERSION}p0
@


1.74
log
@Update to cups-1.4.4.
Fixes several security, scheduler, printing, and conformance issues.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.73 2010/05/22 09:57:42 jasper Exp $
d7 1
a7 1
PKGNAME=	cups-${VERSION}
@


1.73
log
@- remove mips64 gcc workaround, though this still won't build because of ld
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.72 2010/05/16 14:16:36 ajacoutot Exp $
d5 1
a5 1
VERSION=	1.4.3
d7 1
a7 1
PKGNAME=	cups-${VERSION}p3
@


1.72
log
@Create a link from ${LOCALBASE}/bin/smbspool to
${PREFIX}/libexec/cups/backend/smb so that is we have samba installed it
is possible to print to Windows printers out of the box (if samba is not
installed, the smb backend will not appear so there's no harm in doing
this).
Use FAKE_FLAGS instead ov post-install mv danse.
Fix group of cups.conf for dbus.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.71 2010/04/07 13:55:30 ajacoutot Exp $
d7 1
a7 1
PKGNAME=	cups-${VERSION}p2
a107 5

# gcc 3.3.5 internal compiler error
.if ${MACHINE_ARCH:Mmips64*}
CFLAGS+=	-O0
.endif
@


1.71
log
@Disable dnssd support for now as it is not yet stable.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.70 2010/04/01 07:14:43 ajacoutot Exp $
d7 1
a7 1
PKGNAME=	cups-${VERSION}p1
d67 2
a68 1
		MENUDIR=${DESTDIR}${PREFIX}/share/applications
d137 2
a138 4
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/cups/
	cd ${WRKINST}${SYSCONFDIR}/cups/ && mv * \
		${PREFIX}/share/examples/cups
	@@rmdir ${WRKINST}${SYSCONFDIR}/cups/
@


1.70
log
@Fix WANTLIB of the ldap FLAVOR.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.69 2010/03/31 16:20:02 ajacoutot Exp $
d7 1
a7 1
PKGNAME=	cups-${VERSION}p0
d29 2
a30 2
WANTLIB += asn1 c crypto dbus-1 gssapi jpeg krb5 m pthread ssl
WANTLIB += stdc++ z
d52 1
a52 1
		avahi-client,avahi-common::net/avahi
a87 1
		--enable-avahi \
d129 1
@


1.69
log
@Major update to cups-1.4.3.
Changelog is to big to detail here, refer to HOMEPAGE for details.

I have been using 1.4.X for several months.
Versions 1.4.0 and 1.4.2 have been tested in bulks by jasper@@, thanks!

Please contact me directly if you see regressions.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.68 2010/03/29 13:11:42 sthen Exp $
d7 1
a7 1
PKGNAME=	cups-${VERSION}
d119 1
a119 1
LIB_DEPENDS+=	ldap,lber::databases/openldap
@


1.68
log
@fix trailing backslash; pointed out by Andreas Kahari, thanks!
ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.67 2010/03/29 07:53:51 ajacoutot Exp $
d3 1
a3 1
COMMENT=		Common Unix Printing System
d5 3
a7 3
VERSION=		1.3.11
DISTNAME=		cups-${VERSION}-source
PKGNAME=		cups-${VERSION}p7
d9 1
a9 1
CATEGORIES=		print sysutils
d11 7
a17 3
SHARED_LIBS+=		cups		4.0
# XXX ghostscript needs to dlopen() libcupsimage.so.3
SHARED_LIBS+=		cupsimage	3.0
d19 1
a19 1
HOMEPAGE=		http://www.cups.org/
d21 1
a21 1
MAINTAINER=		Antoine Jacoutot <ajacoutot@@openbsd.org>
d29 2
a30 1
WANTLIB += asn1 c crypto gssapi jpeg krb5 m pthread ssl z
d32 76
a107 71
MASTER_SITES=		http://ftp.easysw.com/pub/cups/${VERSION}/ \
			http://ftp.funet.fi/pub/mirrors/ftp.easysw.com/pub/cups/${VERSION}/ \
			ftp://ftp.funet.fi/pub/mirrors/ftp.easysw.com/pub/cups/${VERSION}/ \
			ftp://ftp.easysw.com/pub/cups/${VERSION}/ \
			ftp://ftp2.easysw.com/pub/cups/${VERSION}/ \
			ftp://ftp3.easysw.com/pub/cups/${VERSION}/

EXTRACT_SUFX=		.tar.bz2

RUN_DEPENDS=		:desktop-file-utils-*:devel/desktop-file-utils \
			::devel/xdg-utils
LIB_DEPENDS=		png.>=3::graphics/png \
			tiff.>=35::graphics/tiff \
			dbus-1.>=7::x11/dbus \
			dns_sd::net/avahi

FAKE_FLAGS=		BINMODE=${BINMODE} \
			SHAREMODE=${SHAREMODE} \
			ICONDIR=${DESTDIR}${PREFIX}/share/icons \
			MENUDIR=${DESTDIR}${PREFIX}/share/applications \
			DBUSDIR=${WRKINST}/${TRUEPREFIX}/share/examples/cups/dbus-1/system.d \
			PDFTOPS="pdftops"

MAKE_ENV+=		LIBcups_VERSION=${LIBcups_VERSION} \
			LIBcupsimage_VERSION=${LIBcupsimage_VERSION}

# UTF8 desktop file patch
DIFF_ARGS=		-a

CONFIGURE_STYLE=	gnu dest
AUTOCONF_VERSION=	2.59
CONFIGURE_ARGS=		${CONFIGURE_SHARED} \
			--with-cups-user=_cups \
			--with-cups-group=_cups \
			--with-system-groups=wheel \
			--localstatedir=/var \
			--without-java \
			--with-perl="/usr/bin/perl" \
			--with-optim="${CFLAGS}" \
			--without-php \
			--without-python \
			--enable-image \
			--enable-dbus \
			--enable-raw-printing \
			--enable-gssapi \
			--enable-dnssd \
			--disable-pap \
			--disable-ldap \
			--disable-slp \
			--disable-default-shared \
			--disable-pdftops \
			--disable-gnutls

CONFIGURE_ENV=		CPPFLAGS="-I${LOCALBASE}/include \
				-I${LOCALBASE}/include/libpng \
				-I${LOCALBASE}/include/avahi-compat-libdns_sd" \
			DSOFLAGS="-L${LOCALBASE}/lib" \
			LDFLAGS="-L${LOCALBASE}/lib -pthread" \
			LIBcups_VERSION=${LIBcups_VERSION} \
			LIBcupsimage_VERSION=${LIBcupsimage_VERSION} \
			ac_cv_path_CUPS_GHOSTSCRIPT="${LOCALBASE}/bin/gs"

CFLAGS+=		-I${LOCALBASE}/include -I${LOCALBASE}/include/libpng

WRKDIST=		${WRKDIR}/${DISTNAME:S/-source//}
USE_GMAKE=		Yes

REGRESS_FLAGS=		LOCALBASE=${LOCALBASE}

REGRESS_DEPENDS=	::print/htmldoc
REGRESS_IS_INTERACTIVE=	Yes
d118 2
a119 2
CONFIGURE_ARGS+=	--enable-ldap
LIB_DEPENDS+=		ldap,lber::databases/openldap
d121 1
a121 1
CONFIGURE_ARGS+=	--disable-ldap
d127 4
d132 2
a133 3
	cd ${WRKBUILD} && perl -pi -e 's|\$${DESTDIR}||g' init/cups.sh \
	    config.h cups-config conf/cupsd.conf man/*.man
	${SUBST_CMD} ${WRKSRC}/Makefile
d136 2
a137 2
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/cups/init
	cd ${WRKINST}${SYSCONFDIR}/cups && cp -R * \
d139 1
a139 3
	rm -r ${WRKINST}${SYSCONFDIR}/cups ${WRKINST}/var/run \
	    ${WRKINST}/var/cache
	${INSTALL_DATA} ${WRKBUILD}/init/cups.sh ${PREFIX}/share/cups/init
@


1.67
log
@No need to specify the no_* FLAVOR for avahi, this is the default now.
naddy thinks there may be some gratuitous bumps but let's be safe.

reads good to sthen@@, ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.66 2010/02/09 12:23:59 jasper Exp $
d41 1
a41 1
LIB_DEPENDS+=		dns_sd::net/avahi
@


1.66
log
@- extend archtecture tests for mips64el

ok naddy@@ phessler@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.65 2009/12/22 15:54:32 ajacoutot Exp $
d7 1
a7 1
PKGNAME=		cups-${VERSION}p6
d41 1
a41 2
# only build the -main subpackage to prevent cyclic dependency
LIB_DEPENDS+=		dns_sd::net/avahi,no_gtk,no_mono,no_qt3,no_qt4
@


1.65
log
@Use @@unexec-delete instead of @@unexec for the *-update-* goos.

prodded by espie@@
discussed with espie@@ sthen@@ landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.64 2009/12/10 10:57:06 ajacoutot Exp $
d101 1
a101 1
.if ${MACHINE_ARCH} == "mips64"
@


1.64
log
@Create a symlink to the foomatic drivers database so that they are
available without doing anything if some are installed.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.63 2009/11/22 18:10:12 jasper Exp $
d7 1
a7 1
PKGNAME=		cups-${VERSION}p5
@


1.63
log
@ECURITY FIX for CVE-2009-3553.
CUPS "cupsdDoSelect()" Denial of Service Vulnerability.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62 2009/11/22 16:47:35 jasper Exp $
d7 1
a7 1
PKGNAME=		cups-${VERSION}p4
d135 7
@


1.62
log
@give cups a better chance to build on mips64, this exposes a bug in
ld(1), but the build is able to progress a lot further though.

ok ajacoutot@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.61 2009/11/22 16:38:55 ajacoutot Exp $
d7 1
a7 1
PKGNAME=		cups-${VERSION}p3
@


1.61
log
@Now that SHA1_Update symbol conflict has been solved in security/nss3,
remove the need for gnutls and use openssl instead.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.60 2009/11/11 11:00:32 ajacoutot Exp $
d99 5
@


1.60
log
@Extend comment with deeper explanation.
No pkg change.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59 2009/10/25 16:04:34 jasper Exp $
d7 1
a7 1
PKGNAME=		cups-${VERSION}p2
d25 1
a25 1
WANTLIB += asn1 c crypto gssapi jpeg krb5 m pthread z
a40 1
			gnutls.>=14::security/gnutls
d78 2
a79 8
			--disable-pdftops

# XXX we need to use GnuTLS instead of OpenSSL because of a conflicting
# symbol (both OpenSSL and NSS share a SHA1_Update() symbol). This can
# lead applications to crash.
# e.g. evolution is linked with nss and cups, if cups was linked with
# ssl, then we'll get a segfault when SHA1_Final is called by OpenSSL
CONFIGURE_ARGS+=	--enable-gnutls=yes
a87 1
			LIBGNUTLSCONFIG="pkg-config gnutls" \
a111 2
	# XXX check on update whether this is still necessary
	${INSTALL} -m 555 ${FILESDIR}/libgnutls-config ${WRKDIR}/bin
@


1.59
log
@SECURITY FIX for CVE-2009-3608, CVE-2009-3609.
CUPS "pdftops" Filter Data Handling Integer Overflow Vulnerabilities
Patch from Ubuntu.

ok ajacoutot@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2009/10/12 11:17:17 ajacoutot Exp $
d81 5
a85 2
# XXX we need to use GnuTLS instead of OpenSSL because of conflicting
# symbols with Mozilla NSS which can lead to crashes
@


1.58
log
@Add gnutl support back after recent gnutls upgrade.
Regen wantlib & bump.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.57 2009/10/10 12:39:29 ajacoutot Exp $
d7 1
a7 1
PKGNAME=		cups-${VERSION}p1
@


1.57
log
@Missed bump...

pointed out by jasper@@
cvs: ----------------------------------------------------------------------
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2009/10/10 09:28:32 ajacoutot Exp $
d7 1
a7 1
PKGNAME=		cups-${VERSION}p0
d25 1
a25 2
WANTLIB += asn1 c crypto gcrypt gpg-error gssapi jpeg krb5 m
WANTLIB += pthread z
a35 2
MODULES=		devel/gettext

d117 2
@


1.56
log
@Add no_mono PSEUDO_FLAVOR on the avahi dependency.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55 2009/09/06 12:01:07 jolan Exp $
d7 2
a8 1
PKGNAME=		cups-${VERSION}
@


1.55
log
@remove some quoting which was causing sqlports to error out with my
mk.conf, ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.54 2009/07/12 19:58:19 ajacoutot Exp $
d45 1
a45 1
LIB_DEPENDS+=		dns_sd::net/avahi,no_gtk,no_qt3,no_qt4
@


1.54
log
@- update to cups-1.3.11
kurt@@'s patches are now upstream
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2009/06/04 21:46:49 ajacoutot Exp $
d97 1
a97 2
CFLAGS+=		"-I${LOCALBASE}/include" \
			"-I${LOCALBASE}/include/libpng"
@


1.53
log
@- fix cyclic dependency by using the "no_gtk no_qt3 no_qt4" FLAVOR of
avahi so that only the -main subpackage is built
(i.e. cups needs avahi, avahi needs qt3, qt3 needs cups... *bang*)

issue reported by sthen@@, then naddy@@, then sturm@@...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.52 2009/06/03 16:31:57 ajacoutot Exp $
d5 1
a5 1
VERSION=		1.3.10
d7 1
a7 1
PKGNAME=		cups-${VERSION}p7
@


1.52
log
@- add avahi support
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 2009/05/19 11:15:28 ajacoutot Exp $
d7 1
a7 1
PKGNAME=		cups-${VERSION}p6
d43 3
a45 2
			gnutls.>=14::security/gnutls \
			dns_sd::net/avahi
@


1.51
log
@- don't link .so to .so.X.Y
- merge PFRAG.shared into PLIST
- bump
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2009/05/18 17:09:54 ajacoutot Exp $
d7 1
a7 1
PKGNAME=		cups-${VERSION}p5
d43 2
a44 1
			gnutls.>=14::security/gnutls
d75 1
a75 1
			--disable-dnssd \
d87 2
a88 1
				-I${LOCALBASE}/include/libpng" \
@


1.50
log
@- upstream integrated kurt@@'s patches with some small changes ; bring
them in as it will ease update to a new release
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2009/05/16 17:34:52 ajacoutot Exp $
d7 1
a7 1
PKGNAME=		cups-${VERSION}p4
@


1.49
log
@- tweak MESSAGE & bump
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2009/05/14 12:38:52 kurt Exp $
d7 1
a7 1
PKGNAME=		cups-${VERSION}p3
@


1.48
log
@Fix daemon mode by correcting non-portable code:
- close(0); open(...); is no guaranteed to open on file descriptor 0.
  Change to using dup2()
- Threaded applications that fork() may only call async-signal-safe
  functions in the child process until such time as one of the exec
  functions are called. Enable the APPLE code path that uses execlp()
  in child. Also close child fd's in such a way as to not trip on
  non-blocking fd design issues of libpthread.

okay ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2009/05/09 11:05:44 ajacoutot Exp $
d7 1
a7 1
PKGNAME=		cups-${VERSION}p2
@


1.47
log
@Revert part of previous, it does not seem to help after all; for now
it is advised to start cups in foreground mode (i.e. 'cupsd -f &').
Issue is still under investigation.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2009/05/08 20:00:57 ajacoutot Exp $
d7 1
a7 1
PKGNAME=		cups-${VERSION}p1
@


1.46
log
@- disable threading; it causes several issues which will need more
investigation
- explicitely set some configure switches
- use wheel as "system-groups" instead of non-existent "sys"
- enable raw printing
- respect CFLAGS
- add GSSAPI support
- tweak gecos
- add missing @@sample
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2009/04/27 08:25:39 bernd Exp $
d7 1
a7 1
PKGNAME=		cups-${VERSION}p0
a83 4

# XXX there is an issue with threading with CUPS under OpenBSD
# the lpd backend and admin.cgi hang at cpu 100%
CONFIGURE_ARGS+=	--disable-threads
@


1.45
log
@Update to cups-1.3.10. With lots of help from ajacoutot@@.

There's an issue with the admin.cgi which will be fixed
in-tree.

ok ajacoutot@@, jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2009/03/15 18:31:29 ajacoutot Exp $
d7 1
a7 1
PKGNAME=		cups-${VERSION}
d24 2
a25 1
WANTLIB += c gcrypt gpg-error jpeg m pthread tasn1 z
d60 2
a61 1
CONFIGURE_ARGS+=	--with-cups-user=_cups \
d63 1
a63 1
			${CONFIGURE_SHARED} \
d66 2
a67 1
			--without-perl \
d70 1
d72 7
d85 4
d90 1
a90 1
			  -I${LOCALBASE}/include/libpng" \
d118 3
@


1.44
log
@- remove workaround now that our default thread stack size has been
increased
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2009/04/10 15:35:01 ajacoutot Exp $
d5 1
a5 1
VERSION=		1.2.7
d7 1
a7 1
PKGNAME=		cups-${VERSION}p21
d10 3
a12 3
SHARED_LIBS+=		cups		3.0
# XXX ghostscript needs to dlopen() libcupsimage.so.2
SHARED_LIBS+=		cupsimage	2.3
d24 1
a24 1
WANTLIB += c gcrypt gpg-error jpeg m pthread stdc++ tasn1 z
d46 4
a49 1
			DBUSDIR=${WRKINST}/${TRUEPREFIX}/share/examples/cups/dbus-1/system.d
d67 2
a68 1
			--enable-dbus
d80 2
a81 1
			LIBGNUTLSCONFIG="pkg-config gnutls"
d110 2
a111 2
	@@${INSTALL_DATA_DIR} ${PREFIX}/share/examples/cups/init
	@@cd ${WRKINST}${SYSCONFDIR}/cups && cp -R * \
d113 1
a113 1
	@@rm -r ${WRKINST}${SYSCONFDIR}/cups ${WRKINST}/var/run \
d115 1
a115 1
	@@${INSTALL_DATA} ${WRKBUILD}/init/cups.sh ${PREFIX}/share/cups/init
d117 3
a119 2
	@@sed s,y0y0y0,${LOCALBASE}, < ${FILESDIR}/${file} > \
		${PREFIX}/sbin/${file}
@


1.43
log
@- lower some buffer size to prevent crash with default limit settings
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2009/04/09 08:47:24 ajacoutot Exp $
d7 1
a7 1
PKGNAME=		cups-${VERSION}p20
@


1.42
log
@- fix a crash with NSS based applications when printing using gtk+2-cups
There are some conflicting symbols between nss and openssl (hint from
martynas@@ some time ago about another issue).
- fix tyop while here (MAITAINER -> MAINTAINER)

"looks good" landry@@ ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2009/03/23 15:04:41 ajacoutot Exp $
d7 1
a7 1
PKGNAME=		cups-${VERSION}p19
@


1.41
log
@- enable dbus support
this adds some nice desktop functionnality when dealing with print
queues, printer notifications...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2009/03/15 18:31:29 ajacoutot Exp $
d7 1
a7 1
PKGNAME=		cups-${VERSION}p18
d16 1
a16 1
MAITAINER=		Antoine Jacoutot <ajacoutot@@openbsd.org>
d24 1
a24 1
WANTLIB=		c m z stdc++ pthread crypto ssl
d35 2
a39 1
			jpeg.>=62::graphics/jpeg \
d41 2
a42 1
			dbus-1.>=7::x11/dbus
a59 1
			--enable-ssl \
d64 5
a68 2
			--enable-dbus \
			--disable-gnutls
d75 2
a76 1
			LIBcupsimage_VERSION=${LIBcupsimage_VERSION}
@


1.40
log
@- tweak
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2009/03/05 17:17:28 ajacoutot Exp $
d7 1
a7 1
PKGNAME=		cups-${VERSION}p17
d39 2
a40 1
			tiff.>=35::graphics/tiff
d43 2
a44 1
			SHAREMODE=${SHAREMODE}
d49 3
d63 1
a63 1
			--disable-dbus \
d69 1
a69 1
			LDFLAGS="-L${LOCALBASE}/lib" \
@


1.39
log
@- tweak rc.local bits in MESSAGE
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2009/03/04 19:50:00 jasper Exp $
d7 1
a7 1
PKGNAME=		cups-${VERSION}p16
@


1.38
log
@Security fix for CVE-2008-5183.
Patch adapted from Red Hat's solution.

ok ajacoutot@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2008/11/19 05:28:30 ajacoutot Exp $
d7 1
a7 1
PKGNAME=		cups-${VERSION}p15
@


1.37
log
@- remove foomatic-rip link (the foomatic-filters package now handles it)
- tweak MESSAGE
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2008/10/30 15:07:05 ajacoutot Exp $
d7 1
a7 1
PKGNAME=		cups-${VERSION}p14
@


1.37.2.1
log
@SECURITY FIX

Resolve these, from debian:

CVE-2007-4351
CVE-2007-5849
CVE-2007-6358
CVE-2008-0047
CVE-2008-0053
CVE-2008-0882
CVE-2008-1373
CVE-2008-1722, plus integer overflow patch from L2974: _cupsImageReadPNG()
CVE-2008-3639
CVE-2008-3640
CVE-2008-3641, without SP_select_pen() in STR #2911, and fix an
additional off-by-one (STR #2966)
CVE-2009-0163
CVE-2009-0949

ok robert@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2008/11/19 05:28:30 ajacoutot Exp $
d7 1
a7 1
PKGNAME=		cups-${VERSION}p15
@


1.36
log
@- use xdg-open in the desktop file command
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2008/10/30 13:26:41 ajacoutot Exp $
d7 1
a7 1
PKGNAME=		cups-${VERSION}p13
d9 4
a12 2
SHARED_LIBS=		cups		3.0 \
			cupsimage	2.3
a104 1
	@@ln -s ${TRUEPREFIX}/bin/foomatic-rip ${PREFIX}/libexec/cups/filter/
@


1.35
log
@- make sure we don't try to install stuff outside of WRKINST if the
/usr/share/applications directory exists
spotted by todd@@
- while here, do install the .desktop files and icons and add the
corresponding goos
- regen PLIST
- bump
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2008/10/28 15:21:49 naddy Exp $
d7 1
a7 1
PKGNAME=		cups-${VERSION}p12
d33 2
a34 1
RUN_DEPENDS=		:desktop-file-utils-*:devel/desktop-file-utils
@


1.34
log
@Change "${SYSCONFDIR}" to "/etc" for files that are *always* in the
latter location.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2008/10/28 12:33:32 ajacoutot Exp $
d7 1
a7 1
PKGNAME=		cups-${VERSION}p11
d33 1
d55 1
d89 1
@


1.33
log
@- remove foomatic-filters from RUN_DEPENDS (for now) as it creates a
circular dependency with ghostscript-*-cups
- precise license marker
- take over maintainership
- bump

ok kili@@ mbalmer@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2008/09/18 13:37:41 ajacoutot Exp $
d7 1
a7 1
PKGNAME=		cups-${VERSION}p10
@


1.32
log
@- SYSCONFDIR and LOCALBASE are already part of the generic SUBST_VARS

looks good to landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2007/12/11 08:00:06 jakemsr Exp $
d7 1
a7 1
PKGNAME=		cups-${VERSION}p9
d14 3
a16 1
# GPL
a35 1
RUN_DEPENDS=		::print/foomatic-filters
@


1.31
log
@
use -pthread instead of -lpthread for pthreads linkage in CUPS

bulk build tested by steven@@ (a while ago) "sure" mbalmer@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2007/09/30 14:39:23 steven Exp $
a63 2

SUBST_VARS=		LOCALBASE
@


1.30
log
@register symlink in plist instead of using @@exec/@@unexec

discussed with mbalmer
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2007/09/20 09:34:07 ajacoutot Exp $
d7 1
a7 1
PKGNAME=		cups-${VERSION}p8
@


1.29
log
@- MESSAGE is already long enough without the need to add several useless
blank lines
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2007/09/19 20:58:07 jasper Exp $
d7 1
a7 1
PKGNAME=		${DISTNAME:S/-source//}p7
d100 1
@


1.28
log
@make it more clear on how to start cups.

prompted by and ok marco@@
ok mbalmer@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2007/09/09 14:53:05 ajacoutot Exp $
d7 1
a7 1
PKGNAME=		${DISTNAME:S/-source//}p6
@


1.27
log
@- use foomatic-rip from the foomatic-filter package and remove the
script from FILES
- remove quotes from COMMENTS

no objection from former maintainer Benjamin Lerman, ok jakemsr@@ kili@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2007/08/03 20:51:42 kili Exp $
d7 1
a7 1
PKGNAME=		${DISTNAME:S/-source//}p5
@


1.26
log
@
SECURITY: CVE-2007-3387.

ok naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2007/05/07 13:58:07 ajacoutot Exp $
d3 1
a3 1
COMMENT=		"Common Unix Printing System"
d7 1
a7 1
PKGNAME=		${DISTNAME:S/-source//}p4
d34 1
d65 2
a99 2
	@@${INSTALL_DATA} ${FILESDIR}/foomatic-rip \
		${PREFIX}/libexec/cups/filter/
@


1.25
log
@- don't force optimisation nor debug
- regen patches while here
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2007/03/26 22:10:29 mbalmer Exp $
d7 1
a7 1
PKGNAME=		${DISTNAME:S/-source//}p3
@


1.24
log
@Drop maintainership, since we no longer use this software.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2007/03/26 16:33:05 deanna Exp $
d7 1
a7 1
PKGNAME=		${DISTNAME:S/-source//}p2
@


1.23
log
@Disable gnutls, remove no_gnutls FLAVOR, and use our ssl instead.

ok mbalmer
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2007/03/17 18:28:02 deanna Exp $
d7 1
a7 1
PKGNAME=		${DISTNAME:S/-source//}p1
a12 2

MAINTAINER=		Marc Balmer <mbalmer@@openbsd.org>
@


1.22
log
@Fix regress by letting the test know the correct shared lib versions.

ok mbalmer
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2006/11/17 19:15:36 mbalmer Exp $
d7 1
a7 1
PKGNAME=		${DISTNAME:S/-source//}p0
d22 1
a22 1
WANTLIB=		c m z stdc++ pthread
d53 2
a54 1
			--without-python
d74 1
a74 1
FLAVORS=	no_gnutls ldap
a75 10

.if ${FLAVOR:L:Mno_gnutls}
WANTLIB+=	crypto ssl
.else
MODULES=	devel/gettext

CONFIGURE_ARGS+= --disable-openssl --enable-gnutls
LIB_DEPENDS+=	gnutls.>=12::security/gnutls
WANTLIB+=	gpg-error.>=1 gcrypt.>=12
.endif
@


1.21
log
@Update to CUP 1.2.7.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2006/11/07 11:20:49 mbalmer Exp $
d7 1
a7 1
PKGNAME=		${DISTNAME:S/-source//}
@


1.21.2.1
log
@MFC (original commit kili@@):
- fixes CVE-2007-3387

ok sturm@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2006/11/17 19:15:36 mbalmer Exp $
d7 1
a7 1
PKGNAME=		${DISTNAME:S/-source//}p4
@


1.20
log
@Don't install files with weird ownership, don't install lppasswd setuid root.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2006/10/21 10:58:24 mbalmer Exp $
d5 1
a5 1
VERSION=		1.2.5
d7 1
a7 1
PKGNAME=		${DISTNAME:S/-source//}p0
d9 1
a9 1
SHARED_LIBS=		cups		2.3 \
@


1.19
log
@Update to CUPS 1.2.5, this fixes a handful of bugs.  Remove one patch that
was applied upstream.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2006/10/07 14:03:09 mbalmer Exp $
d7 1
a7 1
PKGNAME=		${DISTNAME:S/-source//}
d99 1
a99 1
	@@cd ${WRKINST}${SYSCONFDIR}/cups && cp -Rp * \
@


1.18
log
@They don't know C, they don't know german, as well.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2006/10/02 11:48:06 mbalmer Exp $
d5 1
a5 1
VERSION=		1.2.4
d7 1
a7 1
PKGNAME=		${DISTNAME:S/-source//}p3
@


1.17
log
@Add an ldap FLAVOR to allow printer sharing via LDAP and mention the
available FLAVORs in pkg/DESCR.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2006/10/02 10:06:03 mbalmer Exp $
d7 1
a7 1
PKGNAME=		${DISTNAME:S/-source//}p2
@


1.16
log
@Remove unused left-overs.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2006/10/02 09:59:05 mbalmer Exp $
d7 1
a7 1
PKGNAME=		${DISTNAME:S/-source//}p1
a49 1
			--disable-ldap \
d73 1
a73 1
FLAVORS=	no_gnutls
d84 7
@


1.15
log
@Add a missing directory.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2006/10/01 16:02:24 mbalmer Exp $
a85 3

a:
	echo $(DESTDIR)
@


1.14
log
@Make this port build with USE_SYSTRACE=Yes.  I forgot parts of a patch
to scheduler/Makefile, sorry, guys!
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2006/10/01 10:43:38 mbalmer Exp $
d7 1
a7 1
PKGNAME=		${DISTNAME:S/-source//}p0
@


1.13
log
@Update to CUPS 1.2.4, which has lots of improvements over the old version
we had, like better support for foreign languages and the usual plethora
of bugfixes.

tested on various architectures and with various applications that use CUPS
as their printing system.  I verified that all ports that are depending on
CUPS still build.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2006/08/03 23:28:11 espie Exp $
d7 1
a7 1
PKGNAME=		${DISTNAME:S/-source//}
d87 3
d98 2
a99 1
	@@rm -r ${WRKINST}${SYSCONFDIR}/cups
@


1.12
log
@new lib specs
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2006/02/05 10:31:13 mbalmer Exp $
d5 1
a5 1
VERSION=		1.1.23
d7 1
a7 1
PKGNAME=		${DISTNAME:S/-source//}p8
d9 2
a10 2
SHARED_LIBS=		cups		2.2 \
			cupsimage	2.2
d22 1
a22 1
WANTLIB=		c m z
d50 1
d54 1
a54 1
			--without-python 
d67 1
d88 2
a89 4
.for i in cups.sh config.h cups-config conf/cupsd.conf
	@@mv ${WRKBUILD}/${i} ${WRKBUILD}/${i}.bak
	@@sed -e s#\$${DESTDIR}##g ${WRKBUILD}/${i}.bak > ${WRKBUILD}/${i}
.endfor
d92 1
a92 1
	@@${INSTALL_DATA_DIR} ${PREFIX}/share/examples/cups
d95 2
a96 1
	@@${INSTALL_DATA} ${WRKBUILD}/cups.sh ${PREFIX}/share/cups
@


1.12.2.1
log
@MFC (original commit kili@@):
- fixes CVE-2007-3387
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2006/08/03 23:28:11 espie Exp $
d7 1
a7 1
PKGNAME=		${DISTNAME:S/-source//}p9
@


1.11
log
@Bump the package to be one the safe side...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2006/02/05 10:20:57 mbalmer Exp $
d33 3
a35 3
LIB_DEPENDS=		png.3::graphics/png \
			jpeg.62::graphics/jpeg \
			tiff.35::graphics/tiff
d81 2
a82 2
LIB_DEPENDS+=	gnutls.12::security/gnutls
WANTLIB+=	gpg-error.1 gcrypt.12
@


1.10
log
@Make SHARED_LIBS actually work, this was lying around for quite some time,
no idea why I did not get committed...

prodded by bernd.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2005/12/23 20:17:41 mbalmer Exp $
d7 1
a7 1
PKGNAME=		${DISTNAME:S/-source//}p7
@


1.9
log
@SHARED_LIBS
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2005/12/06 23:23:44 mbalmer Exp $
d7 1
a7 1
PKGNAME=		${DISTNAME:S/-source//}p6
d40 3
d58 3
a60 1
			LDFLAGS="-L${LOCALBASE}/lib"
@


1.8
log
@Security:  Fix vulnerabilities in the PDF to PS rendering code
(iDefense advisories from 2005-12-05)
- DCTStream Baseline Heap Overflow Vulnerability
- DCTStream Progressive Heap Overflow
- StreamPredictor Heap Overflow Vulnerability
Patch provided by the Xpdf folks.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2005/10/14 18:10:15 fgsch Exp $
d9 2
@


1.7
log
@change default to use gnutls and add a no_gnutls flavor to use openssl
instead. this solves the crashes seen when trying to print under firefox
and other mozilla software.  print works now folks!
discussed with and ok by kurt@@ and mbalmer@@.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2005/10/09 10:29:46 mbalmer Exp $
d7 1
a7 1
PKGNAME=		${DISTNAME:S/-source//}p5
@


1.6
log
@Add a patch from Antti Harri (iku at openbsd dot fi) to prevent cups
from inadvertently shut down OpenBSD and bump the package name.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2005/09/30 06:56:33 fgsch Exp $
d7 1
a7 1
PKGNAME=		${DISTNAME:S/-source//}p4
d20 1
a20 1
WANTLIB=		c crypto m ssl z
d64 13
@


1.5
log
@fix 'server-error-internal-error' when configuring the printer via the
web interface, talk where to find ppd drivers and bump package.
maintainer ok.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2005/03/16 15:34:49 naddy Exp $
d7 1
a7 1
PKGNAME=		${DISTNAME:S/-source//}p3
@


1.4
log
@mark conflicting packages
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2005/01/24 14:34:26 mbalmer Exp $
d7 1
a7 1
PKGNAME=		${DISTNAME:S/-source//}p2
@


1.4.2.1
log
@MFC:
Security:  Fix vulnerabilities in the PDF to PS rendering code
(iDefense advisories from 2005-12-05)
- DCTStream Baseline Heap Overflow Vulnerability
- DCTStream Progressive Heap Overflow
- StreamPredictor Heap Overflow Vulnerability
Patch provided by the Xpdf folks.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2005/03/16 15:34:49 naddy Exp $
d7 1
a7 1
PKGNAME=		${DISTNAME:S/-source//}p6
@


1.4.4.1
log
@MFC:
Security:  Fix vulnerabilities in the PDF to PS rendering code
(iDefense advisories from 2005-12-05)
- DCTStream Baseline Heap Overflow Vulnerability
- DCTStream Progressive Heap Overflow
- StreamPredictor Heap Overflow Vulnerability
Patch provided by the Xpdf folks.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2005/03/16 15:34:49 naddy Exp $
d7 1
a7 1
PKGNAME=		${DISTNAME:S/-source//}p6
@


1.3
log
@Bump package name after changing the PLIST.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2005/01/22 17:12:43 mbalmer Exp $
d7 1
a7 1
PKGNAME=		${DISTNAME:S/-source//}p1
@


1.2
log
@SECURITY:

Apply a security fix from xpdf, which is the base for pdftops and
bump the package name.

spotted by alek@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2005/01/16 12:36:42 mbalmer Exp $
d7 1
a7 1
PKGNAME=		${DISTNAME:S/-source//}p0
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d7 1
a7 1
PKGNAME=		${DISTNAME:S/-source//}
@


1.1.1.1
log
@CUPS, the Common Unix Printing System.

A cross-platform printing solution for Unix environments,
based on the "Internet Printing Protocol, IPP".

ok alek@@
@
text
@@
