head	1.5;
access;
symbols
	OPENBSD_4_8:1.3.0.2
	OPENBSD_4_8_BASE:1.3
	OPENBSD_4_7:1.2.0.4
	OPENBSD_4_7_BASE:1.2
	OPENBSD_4_6:1.2.0.2
	OPENBSD_4_6_BASE:1.2
	OPENBSD_4_5:1.1.1.1.0.18
	OPENBSD_4_5_BASE:1.1.1.1
	OPENBSD_4_4:1.1.1.1.0.16
	OPENBSD_4_4_BASE:1.1.1.1
	OPENBSD_4_3:1.1.1.1.0.14
	OPENBSD_4_3_BASE:1.1.1.1
	OPENBSD_4_2:1.1.1.1.0.12
	OPENBSD_4_2_BASE:1.1.1.1
	OPENBSD_4_1:1.1.1.1.0.10
	OPENBSD_4_1_BASE:1.1.1.1
	OPENBSD_4_0:1.1.1.1.0.8
	OPENBSD_4_0_BASE:1.1.1.1
	OPENBSD_3_9:1.1.1.1.0.6
	OPENBSD_3_9_BASE:1.1.1.1
	OPENBSD_3_8:1.1.1.1.0.4
	OPENBSD_3_8_BASE:1.1.1.1
	OPENBSD_3_7:1.1.1.1.0.2
	OPENBSD_3_7_BASE:1.1.1.1
	cups_20050116:1.1.1.1
	mbalmer:1.1.1;
locks; strict;
comment	@# @;


1.5
date	2010.10.28.15.12.50;	author ajacoutot;	state dead;
branches;
next	1.4;

1.4
date	2010.10.12.12.53.15;	author ajacoutot;	state Exp;
branches;
next	1.3;

1.3
date	2010.03.31.16.20.02;	author ajacoutot;	state Exp;
branches;
next	1.2;

1.2
date	2009.04.27.08.25.39;	author bernd;	state Exp;
branches;
next	1.1;

1.1
date	2005.01.16.12.36.42;	author mbalmer;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2005.01.16.12.36.42;	author mbalmer;	state Exp;
branches;
next	;


desc
@@


1.5
log
@Merge the cups-enable and cups-disable scripts into the rc script.
idea from and ok robert@@
@
text
@#!/bin/sh
#
# $OpenBSD: cups-disable,v 1.4 2010/10/12 12:53:15 ajacoutot Exp $
#
# This script disables CUPS by removing links created by cups-enable.

_PREFIX=${TRUEPREFIX}
_BINDIR=/usr/bin
_SBINDIR=/usr/sbin

if [ "`id -u`" -ne 0 ]; then
	echo "You must be root to run this script."
	exit 1
fi

echo "This script will remove CUPS links from ${_BINDIR} and ${_SBINDIR}"
echo ""
echo -n "Are you sure you want to do this (y/[n])? "

read answer
echo ""

case "${answer}" in
	y|Y)
		;;
	*)
		echo "Exiting..."
		exit 1
		;;
esac

if [ ! -L /usr/sbin/lpc ]; then
	echo "CUPS not enabled, exiting..."
	exit 0
fi

echo "Removing CUPS links:"

for link in lpq lpr lprm; do
	if [ -L ${_BINDIR}/${link} ]; then
		echo " ${link}"
	fi
	rm -f ${_BINDIR}/${link}
done

for link in lpc; do
	if [ -L ${_SBINDIR}/${link} ]; then
		echo " ${link}"
	fi
	rm -f ${_SBINDIR}/${link}
done

echo done.

if [ ! -e /usr/sbin/lpd.pre-cups ]; then
	echo "Couldn't find saved lpd files, saved files not restored."
else
	echo "Trying to restore lpd files:"

	for file in \
		/usr/bin/lpq \
		/usr/bin/lpr \
		/usr/bin/lprm \
		/usr/sbin/lpc \
		/usr/sbin/lpd \
		/usr/share/man/cat1/lpq.0 \
		/usr/share/man/cat1/lpr.0 \
		/usr/share/man/cat1/lprm.0 \
		/usr/share/man/cat8/lpc.0 \
		/usr/share/man/cat8/lpd.0 \
		/etc/printcap
	do
	if [ -e ${file}.pre-cups ]; then
		echo " ${file}"
		mv ${file}.pre-cups ${file}
	fi
	done

	echo done.
	echo ""
fi
@


1.4
log
@Clean up the cups-*able scripts.
Do not move out lptest as CUPS has no counterpart as spotted by armani@@
@
text
@d3 1
a3 1
# $OpenBSD: cups-disable,v 1.3 2010/03/31 16:20:02 ajacoutot Exp $
@


1.3
log
@Major update to cups-1.4.3.
Changelog is to big to detail here, refer to HOMEPAGE for details.

I have been using 1.4.X for several months.
Versions 1.4.0 and 1.4.2 have been tested in bulks by jasper@@, thanks!

Please contact me directly if you see regressions.
@
text
@d3 1
a3 1
#	$OpenBSD: cups-disable,v 1.2 2009/04/27 08:25:39 bernd Exp $
d5 1
a5 2
#	this script disables CUPS by removing links created by
#	cups-enable.
d7 24
a30 29
PREFIX=${TRUEPREFIX}
BINDIR=/usr/bin
SBINDIR=/usr/sbin
QUIET=No

if [ "$1x" == "-qx" ]; then
    QUIET=Yes
fi

if [ `id -u` -ne 0 ]; then
    if [ "$QUIET" == "No" ]; then
        echo "You must be root to run this script."
    fi
    exit 0
fi

if [ "$QUIET" == "No" ]; then
    echo "This script will remove CUPS links from $BINDIR and $SBINDIR"
    echo ""
    echo -n "Are you sure you want to do this (y/[n])? "

    read answer
    echo ""

    if [ X$answer != Xy ]; then
        echo "exit"
        exit
    fi
fi
d33 2
a34 4
    if [ "$QUIET" == "No" ]; then
        echo "CUPS not enabled, script terminated."
    fi
    exit 0
d37 1
a37 4
######################################################################
if [ "$QUIET" == "No" ]; then
    echo "Removing CUPS links:"
fi
d39 5
a43 9
for link in \
    lpq lpr lprm
do
    if [ -L $BINDIR/$link ]; then
        if [ "$QUIET" == "No" ]; then
            echo " $link"
        fi
        rm -f $BINDIR/$link
    fi
d46 5
a50 9
for link in \
    lpc
do
    if [ -L $SBINDIR/$link ]; then
        if [ "$QUIET" == "No" ]; then
            echo " $link"
        fi
        rm -f $SBINDIR/$link
    fi
d53 1
a53 4
if [ "$QUIET" == "No" ]; then
    echo done.
    echo ""
fi
a54 1
######################################################################
d56 1
a56 4
    if [ "$QUIET" == "No" ]; then
        echo "Couldn't find saved lpd files, saved files not restored."
    fi
    exit 0
d58 18
a75 24
    if [ "$QUIET" == "No" ]; then
        echo "Trying to restore lpd files:"
    fi

    for file in \
	/usr/bin/lpq \
	/usr/bin/lpr \
	/usr/bin/lprm \
	/usr/sbin/lpc \
	/usr/sbin/lpd \
	/usr/sbin/lptest \
	/usr/share/man/cat1/lpq.0 \
	/usr/share/man/cat1/lpr.0 \
	/usr/share/man/cat1/lprm.0 \
	/usr/share/man/cat1/lptest.0 \
	/usr/share/man/cat8/lpc.0 \
	/usr/share/man/cat8/lpd.0 \
	/etc/printcap
    do
	if [ -e $file.pre-cups ]; then
            if [ "$QUIET" == "No" ]; then
	        echo " $file"
            fi
	    mv $file.pre-cups $file
d77 1
a77 1
    done
d79 2
a80 4
    if [ "$QUIET" == "No" ]; then
        echo done.
        echo ""
    fi
@


1.2
log
@Update to cups-1.3.10. With lots of help from ajacoutot@@.

There's an issue with the admin.cgi which will be fixed
in-tree.

ok ajacoutot@@, jasper@@
@
text
@d3 1
a3 1
#	$OpenBSD: cups-disable,v 1.1.1.1 2005/01/16 12:36:42 mbalmer Exp $
d94 1
d98 1
@


1.1
log
@Initial revision
@
text
@d3 1
a3 1
#	$OpenBSD$
d8 1
a8 1
PREFIX=y0y0y0
@


1.1.1.1
log
@CUPS, the Common Unix Printing System.

A cross-platform printing solution for Unix environments,
based on the "Internet Printing Protocol, IPP".

ok alek@@
@
text
@@
