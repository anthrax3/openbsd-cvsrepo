head	1.29;
access;
symbols
	OPENBSD_6_0:1.29.0.10
	OPENBSD_6_0_BASE:1.29
	OPENBSD_5_9:1.29.0.6
	OPENBSD_5_9_BASE:1.29
	OPENBSD_5_8:1.29.0.8
	OPENBSD_5_8_BASE:1.29
	OPENBSD_5_7:1.29.0.4
	OPENBSD_5_7_BASE:1.29
	OPENBSD_5_6:1.29.0.2
	OPENBSD_5_6_BASE:1.29
	OPENBSD_5_5:1.27.0.2
	OPENBSD_5_5_BASE:1.27
	OPENBSD_5_4:1.22.0.2
	OPENBSD_5_4_BASE:1.22
	OPENBSD_5_3:1.18.0.2
	OPENBSD_5_3_BASE:1.18
	OPENBSD_5_2:1.16.0.2
	OPENBSD_5_2_BASE:1.16
	OPENBSD_5_1_BASE:1.15
	OPENBSD_5_1:1.15.0.2
	OPENBSD_5_0:1.13.0.2
	OPENBSD_5_0_BASE:1.13
	OPENBSD_4_9:1.12.0.2
	OPENBSD_4_9_BASE:1.12
	OPENBSD_4_8:1.8.0.2
	OPENBSD_4_8_BASE:1.8
	OPENBSD_4_7:1.4.0.2
	OPENBSD_4_7_BASE:1.4
	OPENBSD_4_6:1.2.0.8
	OPENBSD_4_6_BASE:1.2
	OPENBSD_4_5:1.2.0.6
	OPENBSD_4_5_BASE:1.2
	OPENBSD_4_4:1.2.0.4
	OPENBSD_4_4_BASE:1.2
	OPENBSD_4_3:1.2.0.2
	OPENBSD_4_3_BASE:1.2
	ajacoutot_20070926:1.1.1.1
	ajacoutot:1.1.1;
locks; strict;
comment	@# @;


1.29
date	2014.07.10.09.47.21;	author ajacoutot;	state Exp;
branches;
next	1.28;
commitid	27BKR4vdf449aalf;

1.28
date	2014.03.09.21.53.29;	author ajacoutot;	state Exp;
branches;
next	1.27;

1.27
date	2014.01.30.11.37.35;	author ajacoutot;	state Exp;
branches;
next	1.26;

1.26
date	2014.01.23.16.46.59;	author ajacoutot;	state Exp;
branches;
next	1.25;

1.25
date	2013.12.27.09.59.48;	author ajacoutot;	state Exp;
branches;
next	1.24;

1.24
date	2013.11.22.08.01.48;	author ajacoutot;	state Exp;
branches;
next	1.23;

1.23
date	2013.08.10.18.20.09;	author ajacoutot;	state Exp;
branches;
next	1.22;

1.22
date	2013.07.12.07.34.45;	author ajacoutot;	state Exp;
branches;
next	1.21;

1.21
date	2013.05.13.08.39.05;	author ajacoutot;	state Exp;
branches;
next	1.20;

1.20
date	2013.03.10.08.11.05;	author ajacoutot;	state Exp;
branches;
next	1.19;

1.19
date	2013.03.02.13.51.30;	author ajacoutot;	state Exp;
branches;
next	1.18;

1.18
date	2012.10.12.20.00.38;	author ajacoutot;	state Exp;
branches;
next	1.17;

1.17
date	2012.08.17.13.54.26;	author ajacoutot;	state Exp;
branches;
next	1.16;

1.16
date	2012.04.11.15.54.35;	author ajacoutot;	state Exp;
branches;
next	1.15;

1.15
date	2011.12.04.17.43.54;	author ajacoutot;	state Exp;
branches;
next	1.14;

1.14
date	2011.10.22.23.00.31;	author ajacoutot;	state Exp;
branches;
next	1.13;

1.13
date	2011.07.09.00.36.11;	author ajacoutot;	state Exp;
branches;
next	1.12;

1.12
date	2011.01.02.07.38.52;	author ajacoutot;	state Exp;
branches;
next	1.11;

1.11
date	2010.12.09.07.04.48;	author ajacoutot;	state Exp;
branches;
next	1.10;

1.10
date	2010.11.12.16.06.33;	author ajacoutot;	state Exp;
branches;
next	1.9;

1.9
date	2010.08.22.06.58.14;	author ajacoutot;	state Exp;
branches;
next	1.8;

1.8
date	2010.07.31.10.31.58;	author ajacoutot;	state Exp;
branches;
next	1.7;

1.7
date	2010.07.31.08.18.56;	author ajacoutot;	state Exp;
branches;
next	1.6;

1.6
date	2010.05.08.09.59.23;	author ajacoutot;	state Exp;
branches;
next	1.5;

1.5
date	2010.03.31.16.01.45;	author ajacoutot;	state Exp;
branches;
next	1.4;

1.4
date	2009.12.10.10.59.00;	author ajacoutot;	state Exp;
branches;
next	1.3;

1.3
date	2009.08.03.13.10.09;	author giovanni;	state Exp;
branches;
next	1.2;

1.2
date	2007.11.04.15.47.45;	author merdely;	state Exp;
branches;
next	1.1;

1.1
date	2007.09.26.06.26.19;	author ajacoutot;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2007.09.26.06.26.19;	author ajacoutot;	state Exp;
branches;
next	;


desc
@@


1.29
log
@Update to foo2zjs-20140627.
@
text
@$OpenBSD: patch-Makefile,v 1.28 2014/03/09 21:53:29 ajacoutot Exp $
--- Makefile.orig	Sun Jun  1 13:07:42 2014
+++ Makefile	Thu Jul 10 11:41:50 2014
@@@@ -16,11 +16,6 @@@@ SYSNAME := $(shell uname -n)
 # No version number yet...
 VERSION=0.0
 
-# Installation prefix...
-PREFIX=/usr/local
-PREFIX=/usr
-PREFIX=$(DESTDIR)/usr
-
 # Pathnames for this package...
 BIN=$(PREFIX)/bin
 SHAREZJS=$(PREFIX)/share/foo2zjs
@@@@ -32,13 +27,13 @@@@ SHAREQPDL=$(PREFIX)/share/foo2qpdl
 SHARESLX=$(PREFIX)/share/foo2slx
 SHAREHC=$(PREFIX)/share/foo2hiperc
 SHAREHBPL=$(PREFIX)/share/foo2hbpl
-MANDIR=$(PREFIX)/share/man
+MANDIR=$(PREFIX)/man
 DOCDIR=$(PREFIX)/share/doc/foo2zjs/
 INSTALL=install
 ROOT=root
 
 # Pathnames for referenced packages...
-FOODB=$(DESTDIR)/usr/share/foomatic/db/source
+FOODB=${PREFIX}/share/foomatic/db/source
 
 # User ID's
 LPuid=-oroot
@@@@ -242,9 +237,9 @@@@ FILES	=	\
 		$(NULL)
 
 # CUPS vars
-CUPS_SERVERBIN := $(DESTDIR)$(shell cups-config --serverbin 2>/dev/null)
-CUPS_DEVEL := $(shell grep cupsSideChannelDoRequest /usr/include/cups/sidechannel.h 2>/dev/null)
-CUPS_GOODAPI := $(shell cups-config --api-version 2>/dev/null | sed "s/1\.[0123].*//")
+CUPS_SERVERBIN := 1
+CUPS_DEVEL := 1
+CUPS_GOODAPI := 1
 
 # hpclj2600n-0.icm km2430_0.icm km2430_1.icm km2430_2.icm samclp300-0.icm
 # sihp1000.img sihp1005.img sihp1020.img sihp1018.img
@@@@ -291,7 +286,7 @@@@ endif
 
 # Compiler flags
 #CFLAGS +=	-O2 -Wall -Wno-unused-but-set-variable
-CFLAGS +=	-O2 -Wall 
+#CFLAGS +=	-O2 -Wall 
 #CFLAGS +=	-g
 
 #
@@@@ -418,12 +413,6 @@@@ all-test:
 	    echo "      ***"; \
 	    exit 1; \
 	fi
-	@@if ! dc -V >/dev/null 2>&1; then \
-	    echo "      ***"; \
-	    echo "      *** Error: must install GNU dc with the -e option!"; \
-	    echo "      ***"; \
-	    exit 1; \
-	fi
 ifeq ($(UNAME),Darwin)
 	@@if ! type gsed >/dev/null 2>&1; then \
 	    echo "      ***"; \
@@@@ -591,7 +580,7 @@@@ zjsdecode: zjsdecode.o $(LIBJBG)
 	$(CC) $(CFLAGS) zjsdecode.o $(LIBJBG) -o $@@
 
 command2foo2lava-pjl: command2foo2lava-pjl.o
-	$(CC) $(CFLAGS) -L/usr/local/lib command2foo2lava-pjl.o -lcups -o $@@
+	$(CC) $(CFLAGS) -L/usr/local/lib command2foo2lava-pjl.o -pthread -lcups -o $@@
 
 command2foo2lava-pjl.o: command2foo2lava-pjl.c
 	$(CC) $(CFLAGS) -I/usr/local/include -c command2foo2lava-pjl.c
@@@@ -599,9 +588,8 @@@@ command2foo2lava-pjl.o: command2foo2lava-pjl.c
 #
 # Installation rules
 #
-install: all install-test install-prog install-icc2ps install-osx-hotplug \
+install: all install-prog install-icc2ps install-osx-hotplug \
 	    install-extra install-crd install-foo install-ppd \
-	    install-gui install-desktop install-filter \
 	    install-man install-doc
 	#
 	# If you use CUPS, then restart the spooler:
@@@@ -660,11 +648,6 @@@@ install-prog:
 	$(INSTALL) -d $(SHAREZJS)/
 	$(INSTALL) -c -m 644 gamma.ps $(SHAREZJS)/
 	$(INSTALL) -c -m 644 gamma-lookup.ps $(SHAREZJS)/
-	$(INSTALL) -d $(SHAREOAK)/
-	$(INSTALL) -d $(SHAREHP)/
-	$(INSTALL) -d $(SHAREXQX)/
-	$(INSTALL) -d $(SHARELAVA)/
-	$(INSTALL) -d $(SHAREHC)/
 
 install-foo:
 	#
@@@@ -683,24 +666,14 @@@@ install-foo:
 	#
 	# Install current database files
 	#
-	@@if [ -d $(FOODB) ]; then \
+	echo install -d $(FOODB)
+	$(INSTALL) -d $(FOODB)
 	    for dir in driver printer opt; do \
 		echo install -d $(FOODB)/$$dir/; \
 		$(INSTALL) -d $(FOODB)/$$dir/; \
 		echo install -m 644 foomatic-db/$$dir/*.xml $(FOODB)/$$dir/; \
 		$(INSTALL) -c -m 644 foomatic-db/$$dir/*.xml $(FOODB)/$$dir/; \
 	    done \
-	else \
-	    echo "***"; \
-	    echo "*** WARNING! You don't have directory $(FOODB)/"; \
-	    echo "*** If you want support for foomatic printer configuration,";\
-	    echo "*** then you will have to manually install these files..."; \
-	    echo "***"; \
-	    ls foomatic-db/*/*.xml | sed 's/^/	/'; \
-	    echo "***"; \
-	    echo "*** ... wherever foomatic is stashed on your machine."; \
-	    echo "***"; \
-	fi
 	#
 	# Clear foomatic cache and rebuild database if needed
 	#
@@@@ -836,8 +809,8 @@@@ install-extra:
 	    fi; \
 	done
 
-MODEL=$(DESTDIR)/usr/share/cups/model
-LOCALMODEL=$(DESTDIR)/usr/local/share/cups/model
+MODEL=${PREFIX}/share/cups/model
+LOCALMODEL=${PREFIX}/share/foomatic/db/source/PPD/foo2zjs
 MACMODEL=/Library/Printers/PPDs/Contents/Resources
 PPD=$(DESTDIR)/usr/share/ppd
 VARPPD=/var/lp/ppd
@@@@ -845,43 +818,8 @@@@ install-ppd:
 	#
 	# Install PPD files for CUPS
 	#
-	export PATH=$$PATH:`pwd`:; \
-	if [ -x /usr/sbin/ppdmgr -a -s $(VARPPD)/ppdcache ]; then \
-	    $(INSTALL) $(LPgid) -d $(VARPPD)/user; \
-	    cd PPD; \
-	    for ppd in *.ppd; do \
-		manuf=`echo "$$ppd" | sed 's/-.*//'`; \
-		$(INSTALL) $(LPgid) -d $(VARPPD)/user/$$manuf; \
-		modify-ppd <$$ppd | gzip > $(VARPPD)/user/$$manuf/$$ppd.gz; \
-		chmod 664 $(VARPPD)/user/$$manuf/$$ppd.gz; \
-	    done; \
-	    ppdmgr -u; \
-	elif [ -d $(PPD) ]; then \
-	    find $(PPD) -name '*foo2zjs*' | xargs rm -rf; \
-	    find $(PPD) -name '*foo2hp*' | xargs rm -rf; \
-	    find $(PPD) -name '*foo2xqx*' | xargs rm -rf; \
-	    find $(PPD) -name '*foo2lava*' | xargs rm -rf; \
-	    find $(PPD) -name '*foo2qpdl*' | xargs rm -rf; \
-	    find $(PPD) -name '*foo2slx*' | xargs rm -rf; \
-	    find $(PPD) -name '*foo2hiperc*' | xargs rm -rf; \
-	    find $(PPD) -name '*foo2hbpl*' | xargs rm -rf; \
-	    [ -d $(PPD)/foo2zjs ] || mkdir $(PPD)/foo2zjs; \
-	    cd PPD; \
-	    for ppd in *.ppd; do \
-		modify-ppd <$$ppd | gzip > $(PPD)/foo2zjs/$$ppd.gz; \
-		chmod 664 $(PPD)/foo2zjs/$$ppd.gz; \
-	    done; \
-	fi
-	#
-	export PATH=$$PATH:`pwd`:; \
-	if [ -d $(MODEL) ]; then \
-	    rm -f $(MODEL)/KonicaMinolta*; \
-	    cd PPD; \
-	    for ppd in *.ppd; do \
-		modify-ppd <$$ppd | gzip > $(MODEL)/$$ppd.gz; \
-		chmod 664 $(MODEL)/$$ppd.gz; \
-	    done; \
-	elif [ -d $(LOCALMODEL) ]; then \
+	mkdir -p $(LOCALMODEL)
+	if [ -d $(LOCALMODEL) ]; then \
 	    rm -f $(LOCALMODEL)/KonicaMinolta*; \
 	    cd PPD; \
 	    for ppd in *.ppd; do \
@@@@ -1513,11 +1451,8 @@@@ install-doc: doc
 	#
 	$(INSTALL) -d -m 755 $(DOCDIR)
 	$(INSTALL) -c -m 644 manual.pdf $(DOCDIR)
-	$(INSTALL) -c -m 644 COPYING $(DOCDIR)
 	$(INSTALL) -c -m 644 INSTALL $(DOCDIR)
-	$(INSTALL) -c -m 644 INSTALL.osx $(DOCDIR)
 	$(INSTALL) -c -m 644 README $(DOCDIR)
-	$(INSTALL) -c -m 644 ChangeLog $(DOCDIR)
 
 GROFF=/usr/local/test/bin/groff
 GROFF=groff
@


1.28
log
@Update to foo2zjs-20140302.
@
text
@d1 3
a3 3
$OpenBSD: patch-Makefile,v 1.27 2014/01/30 11:37:35 ajacoutot Exp $
--- Makefile.orig	Sat Mar  1 21:51:27 2014
+++ Makefile	Sat Mar  8 13:20:23 2014
d87 1
a87 1
@@@@ -658,11 +646,6 @@@@ install-prog:
d99 1
a99 1
@@@@ -681,24 +664,14 @@@@ install-foo:
d126 1
a126 1
@@@@ -834,8 +807,8 @@@@ install-extra:
d137 1
a137 1
@@@@ -843,43 +816,8 @@@@ install-ppd:
d183 1
a183 1
@@@@ -1511,11 +1449,8 @@@@ install-doc: doc
@


1.27
log
@Update to foo2zjs-20140126.
@
text
@d1 3
a3 3
$OpenBSD: patch-Makefile,v 1.26 2014/01/23 16:46:59 ajacoutot Exp $
--- Makefile.orig	Mon Jan 27 02:46:43 2014
+++ Makefile	Thu Jan 30 12:32:44 2014
d183 1
a183 1
@@@@ -1508,11 +1446,8 @@@@ install-doc: doc
@


1.26
log
@Update to foo2zjs-20140108.
@
text
@d1 3
a3 3
$OpenBSD: patch-Makefile,v 1.25 2013/12/27 09:59:48 ajacoutot Exp $
--- Makefile.orig	Wed Jan  8 13:33:03 2014
+++ Makefile	Thu Jan 23 17:44:04 2014
d99 1
a99 1
@@@@ -680,24 +663,14 @@@@ install-foo:
d126 1
a126 1
@@@@ -833,8 +806,8 @@@@ install-extra:
d137 1
a137 1
@@@@ -842,43 +815,8 @@@@ install-ppd:
d183 1
a183 1
@@@@ -1506,11 +1444,8 @@@@ install-doc: doc
@


1.25
log
@Update to foo2zjs-20131225.
@
text
@d1 3
a3 3
$OpenBSD: patch-Makefile,v 1.24 2013/11/22 08:01:48 ajacoutot Exp $
--- Makefile.orig	Wed Dec 25 21:47:07 2013
+++ Makefile	Fri Dec 27 10:45:39 2013
d183 1
a183 1
@@@@ -1505,11 +1443,8 @@@@ install-doc: doc
@


1.24
log
@Update to foo2zjs-20131118.
@
text
@d1 3
a3 3
$OpenBSD: patch-Makefile,v 1.23 2013/08/10 18:20:09 ajacoutot Exp $
--- Makefile.orig	Mon Nov 18 17:57:48 2013
+++ Makefile	Fri Nov 22 08:58:14 2013
d183 1
a183 1
@@@@ -1504,11 +1442,8 @@@@ install-doc: doc
@


1.23
log
@Update to foo2zjs-20130806.
@
text
@d1 3
a3 3
$OpenBSD: patch-Makefile,v 1.22 2013/07/12 07:34:45 ajacoutot Exp $
--- Makefile.orig	Wed Aug  7 00:50:39 2013
+++ Makefile	Sat Aug 10 20:10:19 2013
d183 1
a183 1
@@@@ -1503,11 +1441,8 @@@@ install-doc: doc
@


1.22
log
@Update to foo2zjs-20130618.
@
text
@d1 3
a3 3
$OpenBSD: patch-Makefile,v 1.21 2013/05/13 08:39:05 ajacoutot Exp $
--- Makefile.orig	Tue Jun 18 11:55:33 2013
+++ Makefile	Fri Jul 12 09:32:35 2013
d183 1
a183 1
@@@@ -1502,11 +1440,8 @@@@ install-doc: doc
@


1.21
log
@Update to foo2zjs-20130321.
@
text
@d1 3
a3 3
$OpenBSD: patch-Makefile,v 1.20 2013/03/10 08:11:05 ajacoutot Exp $
--- Makefile.orig	Sat Mar 23 21:00:35 2013
+++ Makefile	Mon May 13 10:36:36 2013
d183 1
a183 1
@@@@ -1501,11 +1439,8 @@@@ install-doc: doc
@


1.20
log
@Update to foo2zjs-20130306.
@
text
@d1 3
a3 3
$OpenBSD: patch-Makefile,v 1.19 2013/03/02 13:51:30 ajacoutot Exp $
--- Makefile.orig	Sun Mar  3 18:14:01 2013
+++ Makefile	Sun Mar 10 08:53:41 2013
d183 1
a183 1
@@@@ -1486,11 +1424,8 @@@@ install-doc: doc
@


1.19
log
@Update to foo2zjs-20130220.
@
text
@d1 3
a3 3
$OpenBSD: patch-Makefile,v 1.18 2012/10/12 20:00:38 ajacoutot Exp $
--- Makefile.orig	Thu Feb 21 01:05:38 2013
+++ Makefile	Fri Mar  1 10:27:02 2013
d16 1
a16 2
@@@@ -31,13 +26,13 @@@@ SHARELAVA=$(PREFIX)/share/foo2lava
 SHAREQPDL=$(PREFIX)/share/foo2qpdl
d19 1
d32 1
a32 1
@@@@ -236,9 +231,9 @@@@ FILES	=	\
d45 1
a45 1
@@@@ -285,7 +280,7 @@@@ endif
d54 1
a54 1
@@@@ -409,12 +404,6 @@@@ all-test:
d67 1
a67 1
@@@@ -573,7 +562,7 @@@@ zjsdecode: zjsdecode.o $(LIBJBG)
d76 1
a76 1
@@@@ -581,9 +570,8 @@@@ command2foo2lava-pjl.o: command2foo2lava-pjl.c
d87 1
a87 1
@@@@ -640,11 +628,6 @@@@ install-prog:
d99 1
a99 1
@@@@ -662,24 +645,14 @@@@ install-foo:
d126 1
a126 1
@@@@ -808,8 +781,8 @@@@ install-extra:
d137 1
a137 1
@@@@ -817,42 +790,8 @@@@ install-ppd:
d160 1
d178 2
a179 2
+	  mkdir -p $(LOCALMODEL)
+	  if [ -d $(LOCALMODEL) ]; then \
d183 1
a183 1
@@@@ -1452,11 +1391,8 @@@@ install-doc: doc
@


1.18
log
@Minor update to foo2zjs-20120909.
@
text
@d1 3
a3 3
$OpenBSD: patch-Makefile,v 1.17 2012/08/17 13:54:26 ajacoutot Exp $
--- Makefile.orig	Sun Sep  9 07:07:40 2012
+++ Makefile	Fri Oct 12 21:19:33 2012
d182 1
a182 1
@@@@ -1450,11 +1389,8 @@@@ install-doc: doc
@


1.17
log
@Update to foo2zjs-20120601.
@
text
@d1 3
a3 3
$OpenBSD: patch-Makefile,v 1.16 2012/04/11 15:54:35 ajacoutot Exp $
--- Makefile.orig	Sat Jun  2 01:10:31 2012
+++ Makefile	Fri Aug 17 15:49:21 2012
d36 1
a36 1
-CUPS_SERVERBIN := $(shell cups-config --serverbin 2>/dev/null)
@


1.16
log
@Update to foo2zjs-20120223.
@
text
@d1 3
a3 3
$OpenBSD: patch-Makefile,v 1.15 2011/12/04 17:43:54 ajacoutot Exp $
--- Makefile.orig	Sat Mar 17 21:19:59 2012
+++ Makefile	Wed Apr 11 17:51:48 2012
d182 1
a182 1
@@@@ -1443,11 +1382,8 @@@@ install-doc: doc
@


1.15
log
@Update to foo2zjs-20111202.
@
text
@d1 3
a3 3
$OpenBSD: patch-Makefile,v 1.14 2011/10/22 23:00:31 ajacoutot Exp $
--- Makefile.orig	Sat Dec  3 04:43:14 2011
+++ Makefile	Sun Dec  4 18:36:16 2011
d126 1
a126 1
@@@@ -808,50 +781,16 @@@@ install-extra:
d134 1
d137 1
a137 1
 install-ppd:
d160 1
a160 1
-            [ -d $(PPD)/foo2zjs ] || mkdir $(PPD)/foo2zjs; \
d177 2
a178 2
+	    mkdir -p $(LOCALMODEL)
+	    if [ -d $(LOCALMODEL) ]; then \
d182 1
a182 1
@@@@ -1428,11 +1367,8 @@@@ install-doc: doc
@


1.14
log
@Maintenance update to foo2zjs-20111020.
@
text
@d1 3
a3 3
$OpenBSD: patch-Makefile,v 1.13 2011/07/09 00:36:11 ajacoutot Exp $
--- Makefile.orig	Sun Jul 31 15:28:43 2011
+++ Makefile	Sun Oct 23 00:55:25 2011
d32 2
a33 3
@@@@ -241,7 +236,7 @@@@ FILES	=	\
 # sihp1000.img sihp1005.img sihp1020.img sihp1018.img
 # sihpP1005.img sihpP1006.img sihpP1505.img
d35 5
a39 1
-CUPS_DEVEL := $(shell ls /usr/include/cups/sidechannel.h 2>/dev/null)
d41 1
d43 3
a45 3
 # Programs and libraries
 PROGS=		foo2zjs zjsdecode arm2hpdl foo2hp foo2xqx xqxdecode
@@@@ -282,7 +277,7 @@@@ endif
d54 1
a54 1
@@@@ -406,12 +401,6 @@@@ all-test:
d67 1
a67 1
@@@@ -564,7 +553,7 @@@@ zjsdecode: zjsdecode.o $(LIBJBG)
d76 1
a76 1
@@@@ -572,9 +561,8 @@@@ command2foo2lava-pjl.o: command2foo2lava-pjl.c
d87 1
a87 1
@@@@ -631,11 +619,6 @@@@ install-prog:
d99 1
a99 1
@@@@ -653,24 +636,14 @@@@ install-foo:
d126 1
a126 1
@@@@ -799,50 +772,16 @@@@ install-extra:
d181 1
a181 1
@@@@ -1405,11 +1344,8 @@@@ install-doc: doc
@


1.13
log
@Update to foo2zjs-20110609.
@
text
@d1 3
a3 3
$OpenBSD: patch-Makefile,v 1.12 2011/01/02 07:38:52 ajacoutot Exp $
--- Makefile.orig	Thu Jun  9 16:07:08 2011
+++ Makefile	Sat Jul  9 02:27:50 2011
d50 14
a63 1
@@@@ -548,7 +543,7 @@@@ zjsdecode: zjsdecode.o $(LIBJBG)
d72 1
a72 1
@@@@ -556,9 +551,8 @@@@ command2foo2lava-pjl.o: command2foo2lava-pjl.c
d83 1
a83 1
@@@@ -615,11 +609,6 @@@@ install-prog:
d95 1
a95 1
@@@@ -637,24 +626,14 @@@@ install-foo:
d122 1
a122 1
@@@@ -783,50 +762,16 @@@@ install-extra:
d177 1
a177 1
@@@@ -1389,11 +1334,8 @@@@ install-doc: doc
@


1.12
log
@Maintenance update to foo2zjs-20101222.
Add support for HP LaserJet 1022n and HP LaserJet 1022nw.
@
text
@d1 3
a3 3
$OpenBSD: patch-Makefile,v 1.11 2010/12/09 07:04:48 ajacoutot Exp $
--- Makefile.orig	Tue Dec 14 01:55:09 2010
+++ Makefile	Sun Jan  2 08:34:43 2011
d32 1
a32 1
@@@@ -236,7 +231,7 @@@@ FILES	=	\
d41 1
a41 2
@@@@ -274,7 +269,6 @@@@ ifeq ($(UNAME),Linux)
 endif
d44 3
a46 1
-CFLAGS +=	-O2 -Wall
d50 2
a51 2
@@@@ -531,7 +525,7 @@@@ gipddecode: gipddecode.o $(LIBJBG)
 	$(CC) $(CFLAGS) gipddecode.o $(LIBJBG) -o $@@
d59 1
a59 1
@@@@ -539,9 +533,8 @@@@ command2foo2lava-pjl.o: command2foo2lava-pjl.c
d63 3
a65 3
-install: all install-test install-prog install-icc2ps install-extra \
+install: all install-prog install-icc2ps install-extra \
 	    install-crd install-foo install-ppd \
d70 1
a70 1
@@@@ -598,11 +591,6 @@@@ install-prog:
d82 1
a82 1
@@@@ -620,24 +608,14 @@@@ install-foo:
d109 1
a109 1
@@@@ -758,47 +736,16 @@@@ install-extra:
d131 1
d146 1
d156 1
d159 2
a160 2
+	mkdir -p $(LOCALMODEL)
+	if [ -d $(LOCALMODEL) ]; then \
d164 1
a164 1
@@@@ -1337,11 +1284,8 @@@@ install-doc: doc
@


1.11
log
@Update to foo2zjs-20101208.
* new printer: HP LaserJet Pro CP1025nw (alpha quality)
@
text
@d1 3
a3 3
$OpenBSD: patch-Makefile,v 1.10 2010/11/12 16:06:33 ajacoutot Exp $
--- Makefile.orig	Wed Dec  8 21:42:15 2010
+++ Makefile	Thu Dec  9 07:59:45 2010
d160 1
a160 1
@@@@ -1324,11 +1271,8 @@@@ install-doc: doc
@


1.10
log
@Update to foo2zjs-20101112.
@
text
@d1 3
a3 3
$OpenBSD: patch-Makefile,v 1.9 2010/08/22 06:58:14 ajacoutot Exp $
--- Makefile.orig	Fri Nov 12 13:05:04 2010
+++ Makefile	Fri Nov 12 17:01:51 2010
d49 1
a49 1
@@@@ -522,7 +516,7 @@@@ gipddecode: gipddecode.o $(LIBJBG)
d58 1
a58 1
@@@@ -530,9 +524,8 @@@@ command2foo2lava-pjl.o: command2foo2lava-pjl.c
d69 1
a69 1
@@@@ -589,11 +582,6 @@@@ install-prog:
d81 1
a81 1
@@@@ -611,24 +599,14 @@@@ install-foo:
d108 1
a108 1
@@@@ -749,47 +727,16 @@@@ install-extra:
d160 1
a160 1
@@@@ -1314,11 +1261,8 @@@@ install-doc: doc
@


1.9
log
@Update foo2zjs to the 20100817 rev.
@
text
@d1 3
a3 3
$OpenBSD: patch-Makefile,v 1.8 2010/07/31 10:31:58 ajacoutot Exp $
--- Makefile.orig	Tue Aug 17 17:14:59 2010
+++ Makefile	Sun Aug 22 08:41:51 2010
d160 1
a160 1
@@@@ -1313,11 +1260,8 @@@@ install-doc: doc
@


1.8
log
@Update to foo2zjs-20100728.
Add a -cups subpackage that contains the command2foo2lava-pjl that
brings support for more features.
Unconditionally enable CUPS commands in the PPD files. Foomatic will
ignore them and CUPS will use them if there.
@
text
@d1 3
a3 3
$OpenBSD: patch-Makefile,v 1.7 2010/07/31 08:18:56 ajacoutot Exp $
--- Makefile.orig	Wed Jul 28 15:22:04 2010
+++ Makefile	Sat Jul 31 12:02:46 2010
d32 10
a41 1
@@@@ -270,7 +265,6 @@@@ ifeq ($(UNAME),Linux)
d49 1
a49 1
@@@@ -518,7 +512,7 @@@@ gipddecode: gipddecode.o $(LIBJBG)
d58 1
a58 1
@@@@ -526,9 +520,8 @@@@ command2foo2lava-pjl.o: command2foo2lava-pjl.c
d69 1
a69 1
@@@@ -585,11 +578,6 @@@@ install-prog:
d81 1
a81 1
@@@@ -607,24 +595,14 @@@@ install-foo:
d108 2
a109 1
@@@@ -746,46 +724,15 @@@@ install-extra:
d112 1
a112 1
 MODEL=$(DESTDIR)/usr/share/cups/model
d114 1
d160 1
a160 1
@@@@ -1308,11 +1255,8 @@@@ install-doc: doc
@


1.7
log
@Install xml driver files.
@
text
@d1 3
a3 3
$OpenBSD: patch-Makefile,v 1.6 2010/05/08 09:59:23 ajacoutot Exp $
--- Makefile.orig	Wed Apr 21 18:14:18 2010
+++ Makefile	Sat Jul 31 09:01:57 2010
d16 1
a16 1
@@@@ -31,12 +26,12 @@@@ SHARELAVA=$(PREFIX)/share/foo2lava
d24 1
d32 1
a32 1
@@@@ -258,7 +253,6 @@@@ ifeq ($(UNAME),Linux)
d40 10
a49 1
@@@@ -508,9 +502,8 @@@@ gipddecode: gipddecode.o $(LIBJBG)
d56 1
a56 1
-	    install-gui install-desktop \
d60 1
a60 1
@@@@ -567,11 +560,6 @@@@ install-prog:
d72 1
a72 1
@@@@ -589,24 +577,14 @@@@ install-foo:
d99 1
a99 1
@@@@ -728,49 +706,21 @@@@ install-extra:
d111 1
d118 1
a118 1
-		gzip < $$ppd > $(VARPPD)/user/$$manuf/$$ppd.gz; \
d132 1
a132 1
-		gzip < $$ppd > $(PPD)/foo2zjs/$$ppd.gz; \
d135 2
d141 1
a141 1
-		gzip < $$ppd > $(MODEL)/$$ppd.gz; \
d149 1
a149 10
-		gzip < $$ppd > $(LOCALMODEL)/$$ppd.gz; \
-	    done; \
-	fi
+ 		gzip < $$ppd > $(LOCALMODEL)/$$ppd.gz; \
+ 	    done; \
+ 	fi
 
 APPL=$(DESTDIR)/usr/share/applications
 OLDAPPL=$(DESTDIR)/usr/share/gnome/apps/System
@@@@ -1264,11 +1214,8 @@@@ install-doc: doc
@


1.6
log
@Update to foo2zjs-20100507.
* added support for the HP LaserJet Pro P1102 and P1102w, HP LaserJet
Pro P1566, and HP LaserJet Pro P1606dn.
@
text
@d1 1
a1 1
$OpenBSD: patch-Makefile,v 1.5 2010/03/31 16:01:45 ajacoutot Exp $
d3 1
a3 1
+++ Makefile	Sat May  8 11:51:58 2010
d62 28
a89 1
@@@@ -728,49 +716,21 @@@@ install-extra:
d145 1
a145 1
@@@@ -1264,11 +1224,8 @@@@ install-doc: doc
@


1.5
log
@Update to foo2zjs-20100329, needed for upcoming CUPS update.

Install icm and firmware directories.
Add a MESSAGE about getting ICM profiles from the net using 'getweb'.
@
text
@d1 3
a3 3
$OpenBSD: patch-Makefile,v 1.4 2009/12/10 10:59:00 ajacoutot Exp $
--- Makefile.orig	Fri Mar 26 17:17:27 2010
+++ Makefile	Wed Mar 31 16:51:15 2010
d118 1
a118 1
@@@@ -1253,11 +1213,8 @@@@ install-doc: doc
@


1.4
log
@Move PPD files under foo2zjs own directory.
Remove MESSAGE, it is not relevant anymore as the CUPS creates the
symlink automatically for us now.
@
text
@d1 4
a4 4
$OpenBSD: patch-Makefile,v 1.3 2009/08/03 13:10:09 giovanni Exp $
--- Makefile.orig	Sun Jun 14 13:52:03 2009
+++ Makefile	Sun Jul 19 13:16:11 2009
@@@@ -15,11 +15,6 @@@@ SYSNAME := $(shell uname -n)
d16 1
a16 1
@@@@ -30,12 +25,12 @@@@ SHARELAVA=$(PREFIX)/share/foo2lava
d31 1
a31 1
@@@@ -255,7 +250,6 @@@@ ifeq ($(UNAME),Linux)
d39 1
a39 1
@@@@ -505,9 +499,8 @@@@ gipddecode: gipddecode.o $(LIBJBG)
d50 1
a50 1
@@@@ -564,11 +557,6 @@@@ install-prog:
d62 1
a62 1
@@@@ -723,49 +711,21 @@@@ install-extra:
d118 1
a118 1
@@@@ -1225,11 +1185,8 @@@@ install-doc: doc
@


1.3
log
@
Update to 20090623 version.
ok and help ajacoutot@@
@
text
@d1 1
a1 1
$OpenBSD: patch-Makefile,v 1.2 2007/11/04 15:47:45 merdely Exp $
d67 1
a67 1
+LOCALMODEL=${PREFIX}/share/foomatic/db/source/PPD
@


1.2
log
@Foo2zjs updated to latest version, some printers added,
some fixes to make it work with Ghostscript 8.60.

From Giovanni Bechis (MAINTAINER)
ok ajacoutot@@
@
text
@d1 4
a4 4
$OpenBSD: patch-Makefile,v 1.1.1.1 2007/09/26 06:26:19 ajacoutot Exp $
--- Makefile.orig	Sat Nov  3 05:22:39 2007
+++ Makefile	Sat Nov  3 17:19:32 2007
@@@@ -6,10 +6,6 @@@@ SYSNAME := $(shell uname -n)
d11 1
d16 1
a16 2
@@@@ -19,11 +15,11 @@@@ SHAREXQX=$(PREFIX)/share/foo2xqx
 SHARELAVA=$(PREFIX)/share/foo2lava
d19 1
d23 1
d26 2
a27 2
-FOODB=/usr/share/foomatic/db/source
+FOODB=${PREFIX}/share/foo2zjs/db/source
d30 2
a31 23
 LPuid=-olp
@@@@ -40,6 +36,10 @@@@ ifeq ($(UNAME),OpenBSD)
     LPuid=-oroot
     LPgid=-gwheel
 endif
+ifeq ($(UNAME),OpenBSD)
+    LPuid=-oroot
+    LPgid=-gwheel
+endif
 # If we aren't root, don't try to set ownership
 ifneq ($(EUID),0)
     LPuid=
@@@@ -54,6 +54,9 @@@@ endif
 ifeq ($(UNAME),OpenBSD)
     MODTIME= stat -f "%Sm" -t "%a %b %d %T %Y" $$1
 endif
+ifeq ($(UNAME),OpenBSD)
+    MODTIME= stat -f "%Sm" -t "%a %b %d %T %Y" $$1
+endif
 ifeq ($(UNAME),Darwin)
     MODTIME= stat -f "%Sm" -t "%a %b %d %T %Y" $$1
 endif
@@@@ -210,7 +213,6 @@@@ ifeq ($(UNAME),Linux)
d39 1
a39 1
@@@@ -444,7 +446,7 @@@@ slxdecode: slxdecode.o $(LIBJBG)
d44 4
a47 2
+install: all install-prog install-icc2ps \
 	    install-crd install-foo install-ppd install-man install-doc
d50 9
a58 8
@@@@ -493,10 +495,6 @@@@ install-prog:
 	install -d $(SHAREZJS)/
 	install -c -m 644 gamma.ps $(SHAREZJS)/
 	install -c -m 644 gamma-lookup.ps $(SHAREZJS)/
-	install -d $(SHAREOAK)/
-	install -d $(SHAREHP)/
-	install -d $(SHAREXQX)/
-	install -d $(SHARELAVA)/
d62 1
a62 51
@@@@ -509,6 +507,7 @@@@ install-foo:
 	#
 	# Install current database files
 	#
+	mkdir -p $(FOODB)/{driver,printer,opt}
 	@@if [ -d $(FOODB) ]; then \
 	    for dir in driver printer opt; do \
 		echo install -m 644 foomatic-db/$$dir/*.xml $(FOODB)/$$dir/; \
@@@@ -535,40 +534,6 @@@@ install-foo:
 	    foomatic-combo-xml -O >overview.xml; \
 	fi
 
-install-icc2ps:
-	#
-	# Install ICM to Postscript file conversion utility
-	#
-	cd icc2ps; $(MAKE) PREFIX=$(PREFIX) install
-
-install-crd:
-	#
-	# Install prebuilt CRD files (from m2300w project)
-	#
-	install -d $(SHAREZJS)/
-	install $(LPuid) $(LPgid) -m 775 -d $(SHAREZJS)/crd/
-	for i in crd/zjs/*.*; do \
-	    install -c -m 644 $$i $(SHAREZJS)/crd/; \
-	done
-	#
-	# Install prebuilt CRD files for CLP-300/CLP-600
-	#
-	install -d $(SHAREQPDL)/
-	install $(LPuid) $(LPgid) -m 775 -d $(SHAREQPDL)/crd/
-	for i in crd/qpdl/*cms* crd/qpdl/*.ps; do \
-	    install -c -m 644 $$i $(SHAREQPDL)/crd/; \
-	done
-
-install-psfiles:
-	#
-	# Install prebuilt psfiles files (from m2300w project)
-	#
-	install -d $(SHAREHP)/
-	install $(LPuid) $(LPgid) -m 775 -d $(SHAREHP)/psfiles/
-	for i in psfiles/*.*; do \
-	    install -c -m 644 $$i $(SHAREHP)/psfiles/; \
-	done
-
 install-extra:
 	#
 	# Install extra files (ICM and firmware), if any exist here.
@@@@ -629,34 +594,33 @@@@ install-extra:
 	    fi; \
d65 5
a69 20
+install-icc2ps:
+       #
+       # Install ICM to Postscript file conversion utility
+       #
+       cd icc2ps; $(MAKE) PREFIX=$(PREFIX) install
+
+install-crd:
+       #
+       # Install prebuilt CRD files (from m2300w project)
+       #
+	install -d $(SHAREZJS)/
+	install $(LPuid) $(LPgid) -m 775 -d $(SHAREZJS)/crd/
+	for i in crd/zjs/*.*; do \
+      	  install -c -m 644 $$i $(SHAREZJS)/crd/; \
+	done
+
 MODEL=/usr/share/cups/model
-LOCALMODEL=/usr/local/share/cups/model
+LOCALMODEL=${PREFIX}/share/foo2zjs/db/source/PPD
 PPD=/usr/share/ppd
d74 17
a90 7
-	if [ -d $(PPD) ]; then \
-	    find $(PPD) -name '*foo2zjs*' | xargs rm -f; \
-	    find $(PPD) -name '*foo2hp*' | xargs rm -f; \
-	    find $(PPD) -name '*foo2xqx*' | xargs rm -f; \
-	    find $(PPD) -name '*foo2lava*' | xargs rm -f; \
-	    find $(PPD) -name '*foo2qpdl*' | xargs rm -f; \
-	    find $(PPD) -name '*foo2slx*' | xargs rm -f; \
d92 2
a93 4
+	mkdir -p $(LOCALMODEL)
+	if [ -d $(LOCALMODEL) ]; then \
 	    cd PPD; \
 	    for ppd in *.ppd; do \
d98 1
d104 23
a126 14
-	    cd PPD; \
-	    for ppd in *.ppd; do \
 		gzip < $$ppd > $(LOCALMODEL)/$$ppd.gz; \
 	    done; \
 	fi
@@@@ -1027,11 +991,8 @@@@ install-doc: doc
 	#
 	install -d -m 755 $(DOCDIR)
 	install -c -m 644 manual.pdf $(DOCDIR)
-	install -c -m 644 COPYING $(DOCDIR)
 	install -c -m 644 INSTALL $(DOCDIR)
-	install -c -m 644 INSTALL.osx $(DOCDIR)
 	install -c -m 644 README $(DOCDIR)
-	install -c -m 644 ChangeLog $(DOCDIR)
@


1.1
log
@Initial revision
@
text
@d1 3
a3 3
$OpenBSD$
--- Makefile.orig	Wed Jul 18 20:34:22 2007
+++ Makefile	Tue Sep 25 17:10:02 2007
d15 1
a15 2
@@@@ -18,11 +14,11 @@@@ SHAREHP=$(PREFIX)/share/foo2hp
 SHAREXQX=$(PREFIX)/share/foo2xqx
d18 1
d29 1
a29 1
@@@@ -35,6 +31,10 @@@@ ifeq ($(UNAME),FreeBSD)
d40 2
a41 2
@@@@ -46,6 +46,9 @@@@ MODTIME= date -d "1/1/1970 utc + `stat -t $$1 | cut -f
 ifeq ($(UNAME),FreeBSD)
d50 1
a50 1
@@@@ -196,7 +199,6 @@@@ ifeq ($(UNAME),Linux)
d58 1
a58 1
@@@@ -388,7 +390,7 @@@@ opldecode: opldecode.o $(LIBJBG)
d67 1
a67 1
@@@@ -434,10 +436,6 @@@@ install-prog:
d78 1
a78 1
@@@@ -450,6 +448,7 @@@@ install-foo:
d86 1
a86 1
@@@@ -476,40 +475,6 @@@@ install-foo:
d127 1
a127 1
@@@@ -558,33 +523,33 @@@@ install-extra:
d132 4
a135 4
+	#
+	# Install ICM to Postscript file conversion utility
+	#
+	cd icc2ps; $(MAKE) PREFIX=$(PREFIX) install
d138 3
a140 3
+	#
+	# Install prebuilt CRD files (from m2300w project)
+	#
d144 1
a144 1
+	    install -c -m 644 $$i $(SHAREZJS)/crd/; \
d161 1
d181 1
a181 1
@@@@ -944,11 +909,8 @@@@ install-doc: doc
@


1.1.1.1
log
@Import foo2zjs-20070901

foo2zjs is an open source printer driver for printers that use the
Zenographics ZjStream wire protocol for their print data, such as the
Minolta/QMS magicolor 2300 DL or Konica Minolta magicolor 2430 DL.
These printers are often erroneously referred to as winprinters or GDI
printers.
However, Microsoft GDI only mandates the API between an application and
the printer driver, not the protocol on the wire between the printer
driver and the printer.
In fact, ZjStream printers are raster printers which happen to use a
very efficient wire protocol which was developed by Zenographics and
licensed by most major printer manufacturers for at least some of their
product lines.


from Giovanni Bechis <g.bechis at snb dot it> (MAINTAINER) with some
tweaks by me
testing and ok merdely@@
@
text
@@
