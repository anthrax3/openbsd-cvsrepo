head	1.15;
access;
symbols
	OPENBSD_5_3:1.14.0.2
	OPENBSD_5_3_BASE:1.14
	OPENBSD_5_2:1.12.0.2
	OPENBSD_5_2_BASE:1.12
	OPENBSD_4_9:1.10.0.6
	OPENBSD_4_9_BASE:1.10
	OPENBSD_4_8:1.10.0.4
	OPENBSD_4_8_BASE:1.10
	OPENBSD_4_7:1.10.0.2
	OPENBSD_4_7_BASE:1.10
	OPENBSD_4_6:1.9.0.2
	OPENBSD_4_6_BASE:1.9
	OPENBSD_4_5:1.8.0.2
	OPENBSD_4_5_BASE:1.8
	OPENBSD_4_4:1.3.0.2
	OPENBSD_4_4_BASE:1.3
	jasper_20080410:1.1.1.1
	jasper:1.1.1;
locks; strict;
comment	@# @;


1.15
date	2013.05.21.17.19.25;	author ajacoutot;	state dead;
branches;
next	1.14;

1.14
date	2012.10.13.08.57.38;	author ajacoutot;	state Exp;
branches;
next	1.13;

1.13
date	2012.08.28.19.16.20;	author ajacoutot;	state Exp;
branches;
next	1.12;

1.12
date	2012.05.09.15.24.17;	author ajacoutot;	state Exp;
branches;
next	1.11;

1.11
date	2011.05.04.09.10.52;	author ajacoutot;	state dead;
branches;
next	1.10;

1.10
date	2009.09.01.08.13.32;	author ajacoutot;	state Exp;
branches;
next	1.9;

1.9
date	2009.06.08.19.24.43;	author ajacoutot;	state Exp;
branches;
next	1.8;

1.8
date	2009.02.10.17.19.42;	author ajacoutot;	state Exp;
branches;
next	1.7;

1.7
date	2009.01.31.12.37.30;	author ajacoutot;	state Exp;
branches;
next	1.6;

1.6
date	2008.12.21.11.40.40;	author ajacoutot;	state Exp;
branches;
next	1.5;

1.5
date	2008.10.27.13.29.13;	author ajacoutot;	state Exp;
branches;
next	1.4;

1.4
date	2008.09.17.12.00.56;	author ajacoutot;	state Exp;
branches;
next	1.3;

1.3
date	2008.07.08.09.33.21;	author ajacoutot;	state Exp;
branches;
next	1.2;

1.2
date	2008.06.12.21.51.43;	author ajacoutot;	state Exp;
branches;
next	1.1;

1.1
date	2008.04.10.10.23.04;	author jasper;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2008.04.10.10.23.04;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.15
log
@Remove system-config-printer; newer versions are just too-linux generic
to be worth the maintenance nightmare and there are alternatives in-tree
(the cups web interface being one).

ok jasper@@
@
text
@$OpenBSD: patch-system-config-printer_py,v 1.14 2012/10/13 08:57:38 ajacoutot Exp $

https://fedorahosted.org/system-config-printer/ticket/222

--- system-config-printer.py.orig	Tue Sep 18 18:00:14 2012
+++ system-config-printer.py	Sat Oct 13 10:48:34 2012
@@@@ -1984,7 +1984,9 @@@@ def main(show_jobs):
         mainwindow = GUI()
 
     if gtk.__dict__.has_key("main"):
+        gtk.gdk.threads_enter()
         gtk.main()
+        gtk.gdk.threads_leave()
     else:
         gtk.mainloop()
 
@


1.14
log
@Update to system-config-printer-1.3.12.
@
text
@d1 1
a1 1
$OpenBSD: patch-system-config-printer_py,v 1.13 2012/08/28 19:16:20 ajacoutot Exp $
@


1.13
log
@Update to system-config-printer-1.3.11.
@
text
@d1 1
a1 1
$OpenBSD: patch-system-config-printer_py,v 1.12 2012/05/09 15:24:17 ajacoutot Exp $
d5 3
a7 3
--- system-config-printer.py.orig	Wed Aug  1 17:48:26 2012
+++ system-config-printer.py	Tue Aug 28 21:12:50 2012
@@@@ -1985,7 +1985,9 @@@@ def main(show_jobs):
@


1.12
log
@Add missing calls to gtk.gdk.threads_{enter,leave} to fix the abort on
startup.

looks good to kurt@@
@
text
@d1 1
a1 1
$OpenBSD$
d5 4
a8 4
--- system-config-printer.py.orig	Wed May  9 17:10:37 2012
+++ system-config-printer.py	Wed May  9 17:11:21 2012
@@@@ -1974,7 +1974,9 @@@@ def main():
     mainwindow = GUI()
@


1.11
log
@Long overdue major update to system-config-printer-1.3.2.
@
text
@d1 8
a8 6
$OpenBSD: patch-system-config-printer_py,v 1.10 2009/09/01 08:13:32 ajacoutot Exp $
--- system-config-printer.py.orig	Fri Mar 13 18:08:53 2009
+++ system-config-printer.py	Tue Sep  1 10:09:24 2009
@@@@ -101,10 +101,6 @@@@ busy_cursor = gtk.gdk.Cursor(gtk.gdk.WATCH)
 ready_cursor = gtk.gdk.Cursor(gtk.gdk.LEFT_PTR)
 ellipsis = unichr(0x2026)
d10 6
a15 10
-TEXT_start_firewall_tool = _("To do this, select "
-                             "System->Administration->Firewall "
-                             "from the main menu.")
-
 try:
     try_CUPS_SERVER_REMOTE_ANY = cups.CUPS_SERVER_REMOTE_ANY
 except AttributeError:
@@@@ -2518,25 +2514,6 @@@@ class GUI(GtkGUI, monitor.Watcher):
         self.changed = set()
         self.setDataButtonState()
a16 40
-        old_setting = self.server_settings.get (cups.CUPS_SERVER_SHARE_PRINTERS,
-                                                '0')
-        new_setting = setting_dict.get (cups.CUPS_SERVER_SHARE_PRINTERS, '0')
-        if (old_setting == '0' and new_setting != '0'):
-            # We have just enabled print queue sharing.
-            # Ideally, this is the time we would check the firewall
-            # settings on this machine and request that the IPP TCP port
-            # be unblocked.  Unfortunately, this is not yet possible
-            # (bug #440469).  However, we can display a dialog to suggest
-            # that now might be a good time to review the firewall settings.
-            show_info_dialog (_("Review Firewall"),
-                              _("You may need to adjust the firewall "
-                                "to allow network printing to this "
-                                "computer.") + '\n\n' +
-                              TEXT_start_firewall_tool,
-                              parent=self.ServerSettingsDialog)
-
-        time.sleep(1) # give the server a chance to process our request
-
         # Now reconnect, in case the server needed to reload.
         self.reconnect ()
 
@@@@ -3705,7 +3682,7 @@@@ class NewPrinterGUI(GtkGUI):
         # Try to get make and model via SNMP
         if host:
             os.environ["HOST"] = host
-            cmd = '/usr/lib/cups/backend/snmp "${HOST}"'
+            cmd = '${LOCALBASE}/libexec/cups/backend/snmp "${HOST}"'
             debugprint (host + ": " + cmd)
             stdout = None
             try:
@@@@ -5208,7 +5185,7 @@@@ class NewPrinterGUI(GtkGUI):
                 try:
                     # We want this to be in the current natural language,
                     # so we intentionally don't set LC_ALL=C here.
-                    p = subprocess.Popen (['/usr/bin/cupstestppd',
+                    p = subprocess.Popen (['${LOCALBASE}/bin/cupstestppd',
                                            '-rvv', filename],
                                           stdin=file("/dev/null"),
                                           stdout=subprocess.PIPE,
@


1.10
log
@Update to system-config-printer-1.0.16
@
text
@d1 1
a1 1
$OpenBSD: patch-system-config-printer_py,v 1.9 2009/06/08 19:24:43 ajacoutot Exp $
@


1.9
log
@Update to system-config-printer 1.0.15. Tested at c2k9.
@
text
@d1 3
a3 3
$OpenBSD: patch-system-config-printer_py,v 1.8 2009/02/10 17:19:42 ajacoutot Exp $
--- system-config-printer.py.orig	Wed Feb 18 16:46:03 2009
+++ system-config-printer.py	Thu Jun  4 03:19:02 2009
d41 1
a41 1
@@@@ -3704,7 +3681,7 @@@@ class NewPrinterGUI(GtkGUI):
d50 1
a50 1
@@@@ -5199,7 +5176,7 @@@@ class NewPrinterGUI(GtkGUI):
@


1.8
log
@- make the job viewer work
- remove some unused patched
- remove more redhat branding
@
text
@d1 3
a3 3
$OpenBSD: patch-system-config-printer_py,v 1.7 2009/01/31 12:37:30 ajacoutot Exp $
--- system-config-printer.py.orig	Fri Jan 16 11:35:26 2009
+++ system-config-printer.py	Tue Feb 10 17:20:21 2009
d15 1
a15 1
@@@@ -2511,25 +2507,6 @@@@ class GUI(GtkGUI, monitor.Watcher):
d41 1
a41 1
@@@@ -3696,7 +3673,7 @@@@ class NewPrinterGUI(GtkGUI):
d50 1
a50 1
@@@@ -5194,7 +5171,7 @@@@ class NewPrinterGUI(GtkGUI):
@


1.7
log
@- update to system-config-printer-1.0.13

ok jasper@@
@
text
@d1 1
a1 4
set_program_name(domain) requires newer py-gtk2, but is kept back
due to implied py-Nummeric update.

$OpenBSD: patch-system-config-printer_py,v 1.6 2008/12/21 11:40:40 ajacoutot Exp $
d3 1
a3 1
+++ system-config-printer.py	Sat Jan 31 12:11:42 2009
a14 18
@@@@ -336,7 +332,7 @@@@ class GUI(GtkGUI, monitor.Watcher):
         np.NewPrinterWindow.set_transient_for(self.MainWindow)
 
         # Set up "About" dialog
-        self.AboutDialog.set_program_name(domain)
+        #self.AboutDialog.set_program_name(domain)
         self.AboutDialog.set_version(config.VERSION)
         self.AboutDialog.set_icon_name('printer')
 
@@@@ -381,7 +377,7 @@@@ class GUI(GtkGUI, monitor.Watcher):
         self.dests_iconview.set_row_spacing (20)
         self.dests_iconview.set_pixbuf_column (1)
         self.dests_iconview.set_text_column (2)
-        self.dests_iconview.set_tooltip_column (3)
+        #self.dests_iconview.set_tooltip_column (3)
         self.dests_iconview.connect ('item-activated',
                                      self.dests_iconview_item_activated)
         self.dests_iconview.connect ('selection-changed',
@


1.6
log
@- remove some Fedora specifics
from opensolaris
- while here, regen PLIST
- bump
@
text
@d4 4
a7 4
$OpenBSD: patch-system-config-printer_py,v 1.5 2008/10/27 13:29:13 ajacoutot Exp $
--- system-config-printer.py.orig	Tue Oct 21 11:02:45 2008
+++ system-config-printer.py	Sun Dec 21 12:29:27 2008
@@@@ -98,10 +98,6 @@@@ busy_cursor = gtk.gdk.Cursor(gtk.gdk.WATCH)
d18 1
a18 1
@@@@ -333,7 +329,7 @@@@ class GUI(GtkGUI, monitor.Watcher):
d27 2
a28 2
@@@@ -377,7 +373,7 @@@@ class GUI(GtkGUI, monitor.Watcher):
         self.dests_iconview.set_item_width (145)
d36 1
a36 1
@@@@ -2479,25 +2475,6 @@@@ class GUI(GtkGUI, monitor.Watcher):
d62 1
a62 1
@@@@ -3707,7 +3684,7 @@@@ class NewPrinterGUI(GtkGUI):
d71 1
a71 1
@@@@ -5098,7 +5075,7 @@@@ class NewPrinterGUI(GtkGUI):
@


1.5
log
@- update to system-config-printer-1.0.9
@
text
@d4 1
a4 1
$OpenBSD: patch-system-config-printer_py,v 1.4 2008/09/17 12:00:56 ajacoutot Exp $
d6 13
a18 2
+++ system-config-printer.py	Mon Oct 27 14:30:20 2008
@@@@ -333,7 +333,7 @@@@ class GUI(GtkGUI, monitor.Watcher):
d27 1
a27 1
@@@@ -377,7 +377,7 @@@@ class GUI(GtkGUI, monitor.Watcher):
d36 27
a62 1
@@@@ -3707,7 +3707,7 @@@@ class NewPrinterGUI(GtkGUI):
d71 1
a71 1
@@@@ -5098,7 +5098,7 @@@@ class NewPrinterGUI(GtkGUI):
@


1.4
log
@- update to system-config-printer-1.0.7
@
text
@d4 4
a7 4
$OpenBSD: patch-system-config-printer_py,v 1.3 2008/07/08 09:33:21 ajacoutot Exp $
--- system-config-printer.py.orig	Fri Aug 29 12:32:49 2008
+++ system-config-printer.py	Wed Sep 17 13:46:48 2008
@@@@ -330,7 +330,7 @@@@ class GUI(GtkGUI, monitor.Watcher):
d16 2
a17 2
@@@@ -362,7 +362,7 @@@@ class GUI(GtkGUI, monitor.Watcher):
         self.dests_iconview.set_model(self.mainlist)
d25 1
a25 1
@@@@ -3522,7 +3522,7 @@@@ class NewPrinterGUI(GtkGUI):
d34 1
a34 1
@@@@ -4906,7 +4906,7 @@@@ class NewPrinterGUI(GtkGUI):
@


1.3
log
@- update to system-config-printer-1.0.3

looks fine to jasper@@
@
text
@d4 4
a7 4
$OpenBSD: patch-system-config-printer_py,v 1.2 2008/06/12 21:51:43 ajacoutot Exp $
--- system-config-printer.py.orig	Wed Jul  2 16:21:38 2008
+++ system-config-printer.py	Wed Jul  2 16:23:41 2008
@@@@ -309,7 +309,7 @@@@ class GUI(GtkGUI, monitor.Watcher):
d16 1
a16 1
@@@@ -341,7 +341,7 @@@@ class GUI(GtkGUI, monitor.Watcher):
d25 1
a25 1
@@@@ -3325,7 +3325,7 @@@@ class NewPrinterGUI(GtkGUI):
d34 1
a34 1
@@@@ -4627,7 +4627,7 @@@@ class NewPrinterGUI(GtkGUI):
@


1.2
log
@- remove X-Red-Hat category for .desktop files (from jasper@@)
- make the manage printer job entry appear (from jasper@@)
- fix path to system-config-printer in applet.py
- use SUBST_FILES

ok jasper@@
@
text
@d4 4
a7 13
$OpenBSD: patch-system-config-printer_py,v 1.1.1.1 2008/04/10 10:23:04 jasper Exp $
--- system-config-printer.py.orig	Thu Apr  3 17:54:02 2008
+++ system-config-printer.py	Tue Apr  8 15:36:56 2008
@@@@ -77,7 +77,7 @@@@ from gettext import gettext as _
 import gettext
 gettext.textdomain (domain)
 gtk.glade.bindtextdomain (domain)
-pkgdata = '/usr/share/' + domain
+pkgdata = '${PREFIX}/share/' + domain
 iconpath = pkgdata + '/icons/'
 glade_file = pkgdata + '/' + domain + '.glade'
 sys.path.append (pkgdata)
@@@@ -243,7 +243,7 @@@@ class GUI(GtkGUI, monitor.Watcher):
d15 2
a16 2
         self.AboutDialog.set_logo_icon_name('printer')
@@@@ -270,7 +270,7 @@@@ class GUI(GtkGUI, monitor.Watcher):
d25 1
a25 1
@@@@ -2855,7 +2855,7 @@@@ class NewPrinterGUI(GtkGUI):
d29 2
a30 2
-            cmd = '/usr/lib/cups/backend/snmp "${HOST}" 2>/dev/null'
+            cmd = '${LOCALBASE}/libexec/cups/backend/snmp "${HOST}" 2>/dev/null'
d32 11
a42 20
             p = os.popen(cmd, 'r')
             output = p.read ().strip ()
@@@@ -3931,7 +3931,7 @@@@ class NewPrinterGUI(GtkGUI):
                 os.environ["PPD"] = filename
                 # We want this to be in the current natural language,
                 # so we intentionally don't set LC_ALL=C here.
-                p = os.popen ('/usr/bin/cupstestppd -rvv "$PPD"', 'r')
+                p = os.popen ('${LOCALBASE}/bin/cupstestppd -rvv "$PPD"', 'r')
                 output = p.readlines ()
                 p.close ()
                 err += reduce (lambda x, y: x + y, output)
@@@@ -4212,7 +4212,7 @@@@ class NewPrinterGUI(GtkGUI):
         (pkgs, exes) = cupshelpers.missingPackagesAndExecutables (ppd)
         if len (pkgs) > 0 or len (exes) > 0:
             # We didn't find a necessary executable.  Complain.
-            install = "/usr/bin/system-install-packages"
+            install = "/usr/bin/true"
             if len (pkgs) > 0 and os.access (install, os.X_OK):
                 pkg = pkgs[0]
                 install_text = ('<span weight="bold" size="larger">' +
@


1.1
log
@Initial revision
@
text
@d4 1
a4 1
$OpenBSD$
d12 1
a12 1
+pkgdata = '!!PREFIX!!/share/' + domain
d39 1
a39 1
+            cmd = '!!LOCALBASE!!/libexec/cups/backend/snmp "${HOST}" 2>/dev/null'
d48 1
a48 1
+                p = os.popen ('!!LOCALBASE!!/bin/cupstestppd -rvv "$PPD"', 'r')
@


1.1.1.1
log
@import system-config-printer 0.9.90

CUPS configuration GUI.  Configures a CUPS server. It uses the CUPS API
to do this. The communication with the server is performed using IPP. As
a result, it is equally able to configure a remote CUPS server as a
local one.

help and ok ajacoutot@@
@
text
@@
