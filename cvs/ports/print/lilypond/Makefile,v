head	1.44;
access;
symbols
	OPENBSD_6_0:1.44.0.2
	OPENBSD_6_0_BASE:1.44
	OPENBSD_5_9:1.43.0.2
	OPENBSD_5_9_BASE:1.43
	OPENBSD_5_8:1.43.0.4
	OPENBSD_5_8_BASE:1.43
	OPENBSD_5_7:1.42.0.2
	OPENBSD_5_7_BASE:1.42
	OPENBSD_5_6:1.41.0.2
	OPENBSD_5_6_BASE:1.41
	OPENBSD_5_5:1.40.0.2
	OPENBSD_5_5_BASE:1.40
	OPENBSD_5_4:1.39.0.2
	OPENBSD_5_4_BASE:1.39
	OPENBSD_5_3:1.38.0.2
	OPENBSD_5_3_BASE:1.38
	OPENBSD_5_2:1.37.0.4
	OPENBSD_5_2_BASE:1.37
	OPENBSD_5_1_BASE:1.37
	OPENBSD_5_1:1.37.0.2
	OPENBSD_5_0:1.35.0.2
	OPENBSD_5_0_BASE:1.35
	OPENBSD_4_9:1.30.0.2
	OPENBSD_4_9_BASE:1.30
	OPENBSD_4_8:1.23.0.2
	OPENBSD_4_8_BASE:1.23
	OPENBSD_4_7:1.21.0.2
	OPENBSD_4_7_BASE:1.21
	OPENBSD_4_6:1.17.0.2
	OPENBSD_4_6_BASE:1.17
	OPENBSD_4_5:1.14.0.2
	OPENBSD_4_5_BASE:1.14
	OPENBSD_4_4:1.13.0.4
	OPENBSD_4_4_BASE:1.13
	OPENBSD_4_3:1.13.0.2
	OPENBSD_4_3_BASE:1.13
	OPENBSD_4_2:1.9.0.2
	OPENBSD_4_2_BASE:1.9
	OPENBSD_4_1:1.4.0.2
	OPENBSD_4_1_BASE:1.4
	kili_20061029:1.1.1.1
	kili:1.1.1;
locks; strict;
comment	@# @;


1.44
date	2016.03.20.16.12.26;	author naddy;	state Exp;
branches;
next	1.43;
commitid	guiZq8cnNbVyyHzx;

1.43
date	2015.04.06.21.05.07;	author ajacoutot;	state Exp;
branches;
next	1.42;
commitid	UHU0EaklEoJbSKjp;

1.42
date	2015.01.18.21.27.21;	author kili;	state Exp;
branches;
next	1.41;
commitid	BffsChrxTr04MQbw;

1.41
date	2014.05.27.20.43.50;	author kili;	state Exp;
branches;
next	1.40;

1.40
date	2013.10.11.23.50.40;	author naddy;	state Exp;
branches;
next	1.39;

1.39
date	2013.03.11.11.37.54;	author espie;	state Exp;
branches;
next	1.38;

1.38
date	2012.09.01.14.36.58;	author ajacoutot;	state Exp;
branches;
next	1.37;

1.37
date	2011.09.16.11.13.41;	author espie;	state Exp;
branches;
next	1.36;

1.36
date	2011.08.19.20.26.46;	author kili;	state Exp;
branches;
next	1.35;

1.35
date	2011.07.19.09.20.47;	author jasper;	state Exp;
branches;
next	1.34;

1.34
date	2011.07.18.20.20.14;	author landry;	state Exp;
branches;
next	1.33;

1.33
date	2011.07.08.18.00.58;	author kili;	state Exp;
branches;
next	1.32;

1.32
date	2011.07.06.14.14.06;	author kili;	state Exp;
branches;
next	1.31;

1.31
date	2011.06.08.17.37.36;	author jasper;	state Exp;
branches;
next	1.30;

1.30
date	2010.11.26.14.17.17;	author espie;	state Exp;
branches;
next	1.29;

1.29
date	2010.11.20.09.48.39;	author espie;	state Exp;
branches;
next	1.28;

1.28
date	2010.11.11.18.34.59;	author espie;	state Exp;
branches;
next	1.27;

1.27
date	2010.11.06.16.07.00;	author espie;	state Exp;
branches;
next	1.26;

1.26
date	2010.10.24.21.32.39;	author ajacoutot;	state Exp;
branches;
next	1.25;

1.25
date	2010.10.18.21.25.09;	author espie;	state Exp;
branches;
next	1.24;

1.24
date	2010.08.30.18.29.28;	author fgsch;	state Exp;
branches;
next	1.23;

1.23
date	2010.06.24.19.53.12;	author kili;	state Exp;
branches;
next	1.22;

1.22
date	2010.05.22.10.37.35;	author landry;	state Exp;
branches;
next	1.21;

1.21
date	2010.01.01.11.00.49;	author kili;	state Exp;
branches;
next	1.20;

1.20
date	2009.10.26.19.15.15;	author kili;	state Exp;
branches;
next	1.19;

1.19
date	2009.10.11.18.56.21;	author kili;	state Exp;
branches;
next	1.18;

1.18
date	2009.08.10.06.34.09;	author kili;	state Exp;
branches;
next	1.17;

1.17
date	2009.04.26.11.01.05;	author ajacoutot;	state Exp;
branches;
next	1.16;

1.16
date	2009.03.14.11.36.25;	author ajacoutot;	state Exp;
branches;
next	1.15;

1.15
date	2009.03.14.10.40.51;	author ajacoutot;	state Exp;
branches;
next	1.14;

1.14
date	2008.12.17.18.43.13;	author jasper;	state Exp;
branches;
next	1.13;

1.13
date	2007.12.18.16.05.48;	author ajacoutot;	state Exp;
branches;
next	1.12;

1.12
date	2007.10.08.08.22.42;	author steven;	state Exp;
branches;
next	1.11;

1.11
date	2007.09.23.19.28.15;	author kili;	state Exp;
branches;
next	1.10;

1.10
date	2007.09.15.21.36.44;	author merdely;	state Exp;
branches;
next	1.9;

1.9
date	2007.06.06.20.36.23;	author kili;	state Exp;
branches;
next	1.8;

1.8
date	2007.05.20.14.14.37;	author kili;	state Exp;
branches;
next	1.7;

1.7
date	2007.04.01.22.07.44;	author kili;	state Exp;
branches;
next	1.6;

1.6
date	2007.04.01.16.44.19;	author sturm;	state Exp;
branches;
next	1.5;

1.5
date	2007.03.22.22.08.54;	author kili;	state Exp;
branches;
next	1.4;

1.4
date	2006.12.28.23.26.23;	author kili;	state Exp;
branches;
next	1.3;

1.3
date	2006.11.26.11.24.29;	author steven;	state Exp;
branches;
next	1.2;

1.2
date	2006.11.13.12.51.15;	author steven;	state Exp;
branches;
next	1.1;

1.1
date	2006.10.29.19.27.12;	author kili;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2006.10.29.19.27.12;	author kili;	state Exp;
branches;
next	;


desc
@@


1.44
log
@drop SHARED_ONLY from python and ruby ports
@
text
@# $OpenBSD: Makefile,v 1.43 2015/04/06 21:05:07 ajacoutot Exp $

COMMENT-main=		text based music notation system
COMMENT-docs=		lilypond documentation

VERSION=		2.18.2
DISTNAME=		lilypond-${VERSION}
DISTNAME-docs=		${DISTNAME}-1.documentation
PKGNAME-main=		lilypond-${VERSION}
PKGNAME-docs=		lilypond-docs-${VERSION}
CATEGORIES=		print
REVISION-main=		0

DISTFILES=		${DISTNAME}.tar.gz ${DISTNAME-docs}.tar.bz2:0
EXTRACT_ONLY=		${DISTNAME}.tar.gz

MULTI_PACKAGES=		-main -docs

HOMEPAGE=		http://lilypond.org/web/

MAINTAINER=		Matthias Kilian <kili@@openbsd.org>

# GPLv3+
PERMIT_PACKAGE_CDROM=	Yes

MASTER_BASE=		http://download.linuxaudio.org/lilypond/
MASTER_SITES=		${MASTER_BASE}sources/v${VERSION:C,\.[0-9]*$,,}/
MASTER_SITES0=		${MASTER_BASE}binaries/documentation/

# We don't use the standard autoconf mechanisms from the ports
# system, because it doesn't work for lilypond. Instead, we use
# autogen.sh and add AUTOCONV_VERSION to the environment.
AUTOCONF_VERSION=	2.63
CONFIGURE_STYLE=	gnu
CONFIGURE_SCRIPT=	autogen.sh
CONFIGURE_ENV=		AUTOCONF_VERSION=${AUTOCONF_VERSION} \
			BASH=/bin/sh \
			GREP=/usr/bin/grep \
			LDFLAGS=-L${LOCALBASE}/lib
CONFIGURE_ARGS+=	--disable-debugging \
			--disable-documentation \
			--disable-optimising \
			--disable-pipe \
			--with-ncsb-dir=${LOCALBASE}/share/fonts/ghostscript \
			--with-python-include=${MODPY_INCDIR}
USE_GMAKE=		Yes
MAKE_FILE=		GNUmakefile

# Stupid fontforge writes autosave data to ~/.PfaEdit, even in
# scripting mode, so give it a HOME to stop systrace warnings.
PORTHOME=		${WRKDIR}

PKG_ARCH-docs=		*
WANTLIB-docs =
LIB_DEPENDS-docs=
RUN_DEPENDS-docs=

WANTLIB-main=		c fontconfig freetype gmp gthread-2.0 ltdl m \
			pthread stdc++ z guile>=20 glib-2.0>=1000 \
			gmodule-2.0>=1000 gobject-2.0>=1000 \
			pango-1.0>=1200 pangoft2-1.0>=1200 ${WANTLIB}
MODULES=		devel/gettext lang/python
LIB_DEPENDS-main=	${LIB_DEPENDS} \
			lang/guile \
			devel/glib2 \
			devel/pango
RUN_DEPENDS=		print/ghostscript/gnu
BUILD_DEPENDS= 		fonts/mftrace \
			devel/bison \
			archivers/bzip2 \
			devel/autoconf/${AUTOCONF_VERSION} \
			${RUN_DEPENDS}

SUBST_VARS+=		VERSION

# Extract the documentation distfiles.
# Remove files generated by bison to avoid some recompilations
# during fake stage.
post-extract:
	@@bzip2 -cd ${FULLDISTDIR}/${DISTNAME-docs}.tar.bz2 | \
		pax -rs '!^\.!${WRKDIR}/docs!'
	@@rm -rf ${WRKSRC}/lily/out

post-install:
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/lilypond/${VERSION}
	umask 022 && cp -R ${WRKDIR}/docs/share/doc/lilypond/html/* \
		${PREFIX}/share/doc/lilypond/${VERSION}
	for f in ${WRKDIR}/docs/share/man/man1/*; do \
		${INSTALL_MAN} $$f ${PREFIX}/man/man1; \
	done


# Regression tests disabled, because we don't build the documentation.
NO_TEST=		Yes

.include <bsd.port.mk>
@


1.43
log
@Cope with recent fonts directory change in ghostscript.

ok kili@@
@
text
@d1 1
a1 3
# $OpenBSD: Makefile,v 1.42 2015/01/18 21:27:21 kili Exp $

SHARED_ONLY=		Yes
@


1.42
log
@Tests had been "temporarily" disabled for more than three years
now, so just drop all the test-goo.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2014/05/27 20:43:50 kili Exp $
d14 1
d46 1
a46 1
			--with-ncsb-dir=${LOCALBASE}/share/ghostscript/fonts \
@


1.41
log
@Update to lilypond-2.18.2.

Initial diff and testing of the final diff on i386 and amd64 by
Graeme Lee (thanks!).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2013/10/11 23:50:40 naddy Exp $
d94 1
a94 2
# Regression tests temporarily disabled, because we don't
# build the documentation for now.
a95 20

TEST_DEPENDS=	graphics/ImageMagick \
			print/lilypond-test-baseline:patch

pre-test:
.for d in input/regression input/regression/musicxml
	-@@mv ${WRKDIR}/print/lilypond-test-baseline/${DISTNAME}/$d/out-test-baseline ${WRKBUILD}/$d
.endfor

post-test:
	@@echo Please check ${WRKBUILD}/out/test-results/index.html for \
		any graphical anomalities.

# Build a new lilypond-test-baseline-*.tar.bz2
test-baseline:	build
	@@cd ${WRKBUILD} && exec ${_SYSTRACE_CMD} ${SETENV} ${MAKE_ENV} \
		${MAKE_PROGRAM} ${MAKE_FLAGS} -f ${MAKE_FILE} test-baseline
	cd ${WRKDIR} && pax -wjf ${DISTNAME:C/-.*//}-test-baseline-${VERSION}.tar.bz2 \
		${DISTNAME}/input/regression/out-test-baseline \
		${DISTNAME}/input/regression/musicxml/out-test-baseline
@


1.40
log
@Drop USE_GROFF since groff and mandoc produce identical output.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2013/03/11 11:37:54 espie Exp $
d8 1
a8 1
VERSION=		2.14.2
a12 1
REVISION-main =		1
d45 2
a46 1
			--with-ncsb-dir=${LOCALBASE}/share/ghostscript/fonts
d59 1
a59 1
WANTLIB-main=		X11 c expat fontconfig freetype gmp gthread-2.0 ltdl m \
d87 1
a87 1
	umask 022 && cp -R ${WRKDIR}/docs/share/doc/lilypond/html/offline-root/* \
@


1.39
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2012/09/01 14:36:58 ajacoutot Exp $
a47 1
USE_GROFF =		Yes
@


1.38
log
@register-plist did not catch the devel/glib2 -main -> empty change.
espie asked me in such a nice way to fix this that I'm bumping all ports
that have a direct dependency on glib2.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2011/09/16 11:13:41 espie Exp $
a25 1
PERMIT_PACKAGE_FTP=	Yes
a26 2
PERMIT_DISTFILES_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
d97 1
a97 1
NO_REGRESS=		Yes
d99 1
a99 1
REGRESS_DEPENDS=	graphics/ImageMagick \
d102 1
a102 1
pre-regress:
d107 1
a107 1
post-regress:
@


1.37
log
@normalize pkgpath
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2011/08/19 20:26:46 kili Exp $
d13 1
a13 1
REVISION-main =		0
@


1.36
log
@Update to lilypond-2.14.2.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2011/07/19 09:20:47 jasper Exp $
d13 1
@


1.35
log
@adjust dependencies after moving fonts to fonts/

pointed out by sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2011/07/18 20:20:14 landry Exp $
d8 1
a8 1
VERSION=		2.14.1
@


1.34
log
@Remove BROKEN-hppa, the last version builds fine there.
Tested by myself, committing on behalf of kili@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2011/07/08 18:00:58 kili Exp $
d72 1
a72 1
BUILD_DEPENDS= 		print/mftrace \
@


1.33
log
@Matt doesn't want credits any longer.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2011/07/06 14:14:06 kili Exp $
a3 2

BROKEN-hppa=		SIGILL during build
@


1.32
log
@Update to lilypond-2.14.1.

This still uses the downloaded documentation instead of building
it, because it's no fun do build the documentation on low-memory
and/or slow systems like arm (it ran for a couple of days on my
armish, and then it failed with a segfault, which i then couldn't
reproduce for the specific file the segfaults happend on).

It also doesn't depend on the texinfo-4.13 port I sent to ports@@
(but not yet committed) recently.

Running it on some of my (rather oldish, i.e. written for lilypond-2.10
and older) files produces mixed results -- simple stuff still works,
some stuff reports failure (yet creates correct output, which is
strange).  Complicated music like my (never finished) work on the
Busoni transcription of BWV-1004/Partita II doesn't work at all
(but iirc, it didn't with lilypond-2.12, either).

make regress currently fails with this version, because it would
need the texinfo port and a new test-baseline, which I didn't yet
create.

Some work to build the documentation for real (possibly shielded by a
pseudo flavor) will follow.
@
text
@d1 1
a1 4
# $OpenBSD: Makefile,v 1.31 2011/06/08 17:37:36 jasper Exp $
#
# Credits to Matt Jibson. He did the initial work on this port and many
# tools it depends on.
@


1.31
log
@bump after default python version switch
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2010/11/26 14:17:17 espie Exp $
d13 1
a13 1
VERSION=		2.12.3
a16 1
REVISION-main=		2
a17 1
REVISION-docs=		0
d29 1
a29 1
# GPLv2
d42 1
a42 1
AUTOCONF_VERSION=	2.61
d49 4
a52 1
CONFIGURE_ARGS+=	--disable-{debugging,optimising,pipe} \
a80 1
			textproc/texi2html \
d95 1
a95 1
	umask 022 && cp -R ${WRKDIR}/docs/share/doc/lilypond/html/* \
d97 3
d101 7
a107 1
REGRESS_DEPENDS=	print/lilypond-test-baseline:patch
@


1.30
log
@zap autoconf-N: part, since it's now default
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2010/11/20 09:48:39 espie Exp $
d17 1
a17 1
REVISION-main =		1
d19 1
@


1.29
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2010/11/11 18:34:59 espie Exp $
d53 1
a53 1
USE_GROFF =	Yes
d78 1
a78 1
			autoconf-${AUTOCONF_VERSION}:devel/autoconf/${AUTOCONF_VERSION} \
@


1.28
log
@more WANTLIB
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2010/11/06 16:07:00 espie Exp $
d66 3
a68 3
			pthread stdc++ z guile.>=20 glib-2.0.>=1000 \
			gmodule-2.0.>=1000 gobject-2.0.>=1000 \
			pango-1.0.>=1200 pangoft2-1.0.>=1200 ${WANTLIB}
d71 9
a79 9
			::lang/guile \
			::devel/glib2 \
			::devel/pango
RUN_DEPENDS=		::print/ghostscript/gnu
BUILD_DEPENDS= 		::print/mftrace \
			::devel/bison \
			::archivers/bzip2 \
			:autoconf-${AUTOCONF_VERSION}:devel/autoconf/${AUTOCONF_VERSION} \
			::textproc/texi2html \
d97 1
a97 1
REGRESS_DEPENDS=	::print/lilypond-test-baseline:patch
@


1.27
log
@move gettext to new WANTLIB
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2010/10/24 21:32:39 ajacoutot Exp $
d66 3
a68 1
			pthread stdc++ z ${WANTLIB}
d71 3
a73 3
			guile.>=20::lang/guile \
			glib-2.0.>=1000,gmodule-2.0.>=1000,gobject-2.0.>=1000::devel/glib2 \
			pango-1.0.>=1200,pangoft2-1.0.>=1200::devel/pango
@


1.26
log
@Remove USE_X11.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2010/10/18 21:25:09 espie Exp $
d61 1
d66 1
a66 1
			pthread stdc++ z
@


1.25
log
@USE_GROFF=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2010/08/30 18:29:28 fgsch Exp $
a52 1
USE_X11=		Yes
@


1.24
log
@Bump revision after python's default change.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2010/06/24 19:53:12 kili Exp $
d54 1
@


1.23
log
@Adjust WANTLIB and bump.

Silence post-extract a little bit.

Enable regression tests.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2010/05/22 10:37:35 landry Exp $
d16 2
a17 1
PKGNAME-main=		lilypond-${VERSION}p0
@


1.22
log
@Mark as BROKEN on hppa, SIGILL during build.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2010/01/01 11:00:49 kili Exp $
d16 1
a16 1
PKGNAME-main=		lilypond-${VERSION}
d63 1
a63 1
WANTLIB-main=		X11 c expat fontconfig freetype gmp ltdl m \
a79 2
NO_REGRESS=		Yes

d84 1
a84 1
	bzip2 -cd ${FULLDISTDIR}/${DISTNAME-docs}.tar.bz2 | \
d86 1
a86 1
	rm -rf ${WRKSRC}/lily/out
d92 19
@


1.21
log
@Update to 2.12.3.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2009/10/26 19:15:15 kili Exp $
d7 2
@


1.20
log
@Unbreak the build after the removal of ${LOCALBASE}/lib/X11/fonts/ghostscript.
No pkg bump necessary, since the ghostscript fonts are used during build time
only.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2009/10/11 18:56:21 kili Exp $
d11 1
a11 1
VERSION=		2.12.2
a43 1
			FLEXLEXER_PATH=/usr/include/g++ \
d45 2
a46 1
			GREP=/usr/bin/grep
d90 1
a90 1
	umask 022 && cp -R ${WRKDIR}/docs/* \
@


1.19
log
@Update to 2.12.2, following the guile update.

May still be broken a little bit; I'll fix any possible bugs
soon.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2009/08/10 06:34:09 kili Exp $
d48 1
a48 1
			--with-ncsb-dir=${LOCALBASE}/lib/X11/fonts/ghostscript
@


1.18
log
@WANTLIB changes after xcb addition and bump.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2009/04/26 11:01:05 ajacoutot Exp $
d11 1
a11 1
VERSION=		2.10.33
d14 1
a14 1
PKGNAME-main=		lilypond-${VERSION}p5
d27 1
a27 1
# GPL
d44 3
a46 1
			FLEXLEXER_PATH=/usr/include/g++
d61 2
a62 2
WANTLIB-main=		X11 c expat fontconfig freetype m pthread-stubs \
			stdc++ xcb z
d65 1
a65 1
			guile.>=15,guile-ltdl.>=1::lang/guile \
d73 1
@


1.17
log
@CONFIGURE_ENV += PYTHON="${MODPY_BIN}" is inherited from the python module
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2009/03/14 11:36:25 ajacoutot Exp $
d14 1
a14 1
PKGNAME-main=		lilypond-${VERSION}p4
d59 2
a60 1
WANTLIB-main=		c expat fontconfig freetype m stdc++ z X11
@


1.16
log
@- nothing should have to run_depends on rarian anymore
- explicitely add build_depends on rarian where gnome-doc-utils is also a
build dependency as it does not itself run_depends on rarian anymore

This was the 2nd and hopefully last pass of rarian/scrollkeeper cleaning.

discussed with jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2009/03/14 10:40:51 ajacoutot Exp $
a43 1
			PYTHON=${MODPY_BIN} \
@


1.15
log
@- first pass at cleaning rarian/scrollkeeper handling
remove rarian-sk-update from PLIST ; it is only a wrapper that does
noting: librarian takes care of everything now.

discussed with jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2008/12/17 18:43:13 jasper Exp $
d14 1
a14 1
PKGNAME-main=		lilypond-${VERSION}p3
a71 2
RUN_DEPENDS-main=	${RUN_DEPENDS} \
			::textproc/rarian
@


1.14
log
@- switch to rarian instead of scrollkeeper
- regen PLIST

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2007/12/18 16:05:48 ajacoutot Exp $
d14 1
a14 1
PKGNAME-main=		lilypond-${VERSION}p2
@


1.13
log
@- add missing scrollkeeper-update goo
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2007/10/08 08:22:42 steven Exp $
d14 1
a14 1
PKGNAME-main=		lilypond-${VERSION}p1
d73 1
a73 1
			:scrollkeeper-*:textproc/scrollkeeper
@


1.12
log
@bump PKGNAME after python version switch
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2007/09/23 19:28:15 kili Exp $
d14 1
a14 1
PKGNAME-main=		lilypond-${VERSION}p0
d72 2
@


1.11
log
@
Update to 2.10.33.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2007/09/15 21:36:44 merdely Exp $
d14 1
a14 1
PKGNAME-main=		lilypond-${VERSION}
@


1.10
log
@Remove surrounding quotes in COMMENT/PERMIT_*/ERRORS
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2007/06/06 20:36:23 kili Exp $
d11 1
a11 1
VERSION=		2.10.25
@


1.9
log
@
Update to 2.10.25.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2007/05/20 14:14:37 kili Exp $
d8 2
a9 2
COMMENT-main=		"text based music notation system"
COMMENT-docs=		"lilypond documentation"
@


1.8
log
@
Better COMMENTs. Noticed after a general mail from espie@@.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2007/04/01 22:07:44 kili Exp $
d6 1
a6 1
SHARED_ONLY=	Yes
d8 2
a9 2
COMMENT-main=	"text based music notation system"
COMMENT-docs=	"lilypond documentation"
d11 6
a16 6
VERSION=	2.8.8
DISTNAME=	lilypond-${VERSION}
DISTNAME-docs=	${DISTNAME}-1.documentation
PKGNAME-main=	${DISTNAME}p1
PKGNAME-docs=	${DISTNAME:S,-,-docs-,}p0
CATEGORIES=	print
d18 2
a19 2
DISTFILES=	${DISTNAME}.tar.gz ${DISTNAME-docs}.tar.bz2:0
EXTRACT_ONLY=	${DISTNAME}.tar.gz
d21 1
a21 1
MULTI_PACKAGES=	-main -docs
d23 1
a23 1
HOMEPAGE=	http://lilypond.org/web/
d25 1
a25 1
MAINTAINER=	Matthias Kilian <kili@@openbsd.org>
d28 4
a31 4
PERMIT_PACKAGE_FTP=Yes
PERMIT_PACKAGE_CDROM=Yes
PERMIT_DISTFILES_FTP=Yes
PERMIT_DISTFILES_CDROM=Yes
d40 1
a40 1
AUTOCONF_VERSION=	2.59
d46 2
a47 1
CONFIGURE_ARGS+=	--with-ncsb-dir=${LOCALBASE}/lib/X11/fonts/ghostscript
d52 4
d60 20
a79 20
WANTLIB-main=	c expat fontconfig freetype m stdc++ z X11
MODULES=	devel/gettext lang/python
LIB_DEPENDS=	guile.>=15,guile-ltdl.>=1::lang/guile \
		glib-2.0.>=1000,gmodule-2.0.>=1000,gobject-2.0.>=1000::devel/glib2 \
		pango-1.0.>=1200,pangoft2-1.0.>=1200::devel/pango
RUN_DEPENDS=	::print/ghostscript/gnu

BUILD_DEPENDS= 	::print/mftrace \
		::devel/bison \
		:autoconf-${AUTOCONF_VERSION}*:devel/autoconf/${AUTOCONF_VERSION} \
		${RUN_DEPENDS}

SUBST_VARS+=	VERSION

NO_REGRESS=	Yes

# Fails for yet unknown reason on mf when mftracing feta26 with EINVAL
# in intercept_get_string.
NO_SYSTRACE=	Yes

d81 3
a83 3
	mkdir -p ${WRKDIR}/docs
	cd ${WRKDIR}/docs && \
		bzip2 -cd ${FULLDISTDIR}/${DISTNAME-docs}.tar.bz2 | tar xf -
@


1.7
log
@
Unbreak for xenocara: don't even run fc-cache, fix WANTLIB (+ expat z).
While here, remove a bogus patch also related to fc-cache that is
never invoked (target install-fc-cache).

ok, martynas@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2007/04/01 16:44:19 sturm Exp $
d8 2
a9 2
COMMENT-main=	"LilyPond - music notation for everyone"
COMMENT-docs=	"LilyPond documentation"
d14 2
a15 2
PKGNAME-main=	${DISTNAME}p0
PKGNAME-docs=	${DISTNAME:S,-,-docs-,}
@


1.6
log
@really depend on specified autoconf/automake version
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2007/03/22 22:08:54 kili Exp $
d14 1
a14 1
PKGNAME-main=	${DISTNAME}
d55 1
a55 1
WANTLIB-main=	c fontconfig freetype m stdc++ X11
@


1.5
log
@
Fix MASTER_SITES. Found by and from Charles Longeau, thanks!
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2006/12/28 23:26:23 kili Exp $
d64 1
a64 1
		::devel/autoconf/${AUTOCONF_VERSION} \
@


1.4
log
@
Remove an unused variable.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2006/11/26 11:24:29 steven Exp $
d34 1
a34 1
MASTER_SITES=		${MASTER_BASE}v${VERSION:C,\.[0-9]*$,,}/
@


1.3
log
@update to 2.8.8
new MULTI_PACKAGES

from kili@@ with some corrections by me.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2006/11/13 12:51:15 steven Exp $
a21 2

DOCDIR=		${PREFIX}/share/doc/lilypond/${VERSION}
@


1.2
log
@USE_X11
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2006/10/29 19:27:12 kili Exp $
d8 1
a8 1
COMMENT=	"LilyPond - music notation for everyone"
d11 5
a15 4
DISTNAME=	lilypond-2.8.7
DISTNAME-docs=	lilypond-2.8.7-1.documentation
VERSION=	${DISTNAME:S,lilypond-,,}
PKGNAME-docs=	lilypond-docs-${VERSION}
d21 1
a21 2
MULTI_PACKAGES=	-docs
SUBPACKAGE?=
d53 6
a58 5
.if defined(PACKAGING) && ${SUBPACKAGE} == "-docs"
PKG_ARCH=	*
.else
WANTLIB=	c fontconfig freetype m stdc++ X11
MODULES=        devel/gettext lang/python
a62 1
.endif
d72 4
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d6 2
d50 1
a51 2

SHARED_ONLY=		Yes
@


1.1.1.1
log
@
LilyPond -- music notation and typesetting software.

ok, mbalmer@@
@
text
@@
