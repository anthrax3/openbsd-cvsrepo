head	1.6;
access;
symbols
	OPENBSD_5_5:1.5.0.2
	OPENBSD_5_5_BASE:1.5
	OPENBSD_4_9:1.3.0.6
	OPENBSD_4_9_BASE:1.3
	OPENBSD_4_8:1.3.0.4
	OPENBSD_4_8_BASE:1.3
	OPENBSD_4_7:1.3.0.2
	OPENBSD_4_7_BASE:1.3
	OPENBSD_4_6:1.2.0.10
	OPENBSD_4_6_BASE:1.2
	OPENBSD_4_5:1.2.0.8
	OPENBSD_4_5_BASE:1.2
	OPENBSD_4_4:1.2.0.6
	OPENBSD_4_4_BASE:1.2
	OPENBSD_4_3:1.2.0.4
	OPENBSD_4_3_BASE:1.2
	OPENBSD_4_2:1.2.0.2
	OPENBSD_4_2_BASE:1.2
	OPENBSD_4_1:1.1.1.1.0.2
	OPENBSD_4_1_BASE:1.1.1.1
	kili_20061029:1.1.1.1
	kili:1.1.1;
locks; strict;
comment	@# @;


1.6
date	2014.05.27.20.43.50;	author kili;	state dead;
branches;
next	1.5;

1.5
date	2014.01.17.21.01.39;	author kili;	state Exp;
branches;
next	1.4;

1.4
date	2011.07.06.14.14.06;	author kili;	state dead;
branches;
next	1.3;

1.3
date	2010.01.01.11.00.49;	author kili;	state Exp;
branches;
next	1.2;

1.2
date	2007.06.06.20.36.23;	author kili;	state Exp;
branches;
next	1.1;

1.1
date	2006.10.29.19.27.12;	author kili;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2006.10.29.19.27.12;	author kili;	state Exp;
branches;
next	;


desc
@@


1.6
log
@Update to lilypond-2.18.2.

Initial diff and testing of the final diff on i386 and amd64 by
Graeme Lee (thanks!).
@
text
@$OpenBSD: patch-stepmake_aclocal_m4,v 1.5 2014/01/17 21:01:39 kili Exp $
--- stepmake/aclocal.m4.orig	Tue Jul 26 00:42:15 2011
+++ stepmake/aclocal.m4	Fri Jan 17 19:54:08 2014
@@@@ -116,7 +116,7 @@@@ AC_DEFUN(STEPMAKE_CHECK_VERSION, [
     num=`STEPMAKE_NUMERIC_VERSION($ver)`
     req=`STEPMAKE_NUMERIC_VERSION($3)`
     AC_MSG_RESULT([$ver])
-    if test "$num" -lt "$req"; then
+    if test $(dc -e "[[1]] sa 0 $num $req <a p") = 0; then
 	STEPMAKE_ADD_ENTRY($2, ["$r >= $3 (installed: $ver)"])
     fi
     vervar="`echo $1 | tr '[a-z]' '[A-Z]'`_VERSION"
@


1.5
log
@Unbreak on 32 bit archs after the fontforge update.

I should my incomplete work on ksh back from 2008 instead, but I'm
just a poor slacker.

(Hint: configure tries something like
        test 20120731000000 -lt 20110222000000
)
@
text
@d1 1
a1 1
$OpenBSD$
@


1.4
log
@Update to lilypond-2.14.1.

This still uses the downloaded documentation instead of building
it, because it's no fun do build the documentation on low-memory
and/or slow systems like arm (it ran for a couple of days on my
armish, and then it failed with a segfault, which i then couldn't
reproduce for the specific file the segfaults happend on).

It also doesn't depend on the texinfo-4.13 port I sent to ports@@
(but not yet committed) recently.

Running it on some of my (rather oldish, i.e. written for lilypond-2.10
and older) files produces mixed results -- simple stuff still works,
some stuff reports failure (yet creates correct output, which is
strange).  Complicated music like my (never finished) work on the
Busoni transcription of BWV-1004/Partita II doesn't work at all
(but iirc, it didn't with lilypond-2.12, either).

make regress currently fails with this version, because it would
need the texinfo port and a new test-baseline, which I didn't yet
create.

Some work to build the documentation for real (possibly shielded by a
pseudo flavor) will follow.
@
text
@d1 12
a12 41
$OpenBSD: patch-stepmake_aclocal_m4,v 1.3 2010/01/01 11:00:49 kili Exp $

# Fix a GNUism (\| in BREs) in the version check.
# Don't overflow our ksh with too large version numbers (like in
# fontforge).

--- stepmake/aclocal.m4.orig	Tue Dec 15 19:58:57 2009
+++ stepmake/aclocal.m4	Thu Dec 31 09:02:24 2009
@@@@ -32,9 +32,13 @@@@ AC_DEFUN(STEPMAKE_GET_VERSION, [
     ## for compatibility reasons.
     
     ## grab the first version number in  --version output.
-    eval _ver=\"\`("$1" --version || "$1" -V) 2>&1 | grep '\(^\| \)[0-9][0-9]*\.[0-9]' \
-        | head -n 1 \
-	| tr ' ' '\n' | sed 's/\([0-9][0-9]*\.[0-9][0-9.]*\).*/\1/g' | grep '\(^\| \)[0-9][0-9]*\.[0-9]' | head -n 1\`\"
+    eval _ver=\"\`("$1" --version || "$1" -V) 2>&1 |
+		grep -E '(^| )[0-9][0-9]*\.[0-9]' |
+		head -n 1 |
+		tr ' ' '\n' |
+		sed 's/\([0-9][0-9]*\.[0-9][0-9.]*\).*/\1/g' |
+		grep -E '(^| )[0-9][0-9]*\.[0-9]' |
+		head -n 1\`\"
 
     if test -z "$_ver"; then
         ## If empty, try date [fontforge]
@@@@ -49,12 +53,9 @@@@ AC_DEFUN(STEPMAKE_GET_VERSION, [
 # Calculate simplistic numeric version from version string ($1)
 # As yet, we have no need for something more elaborate.
 AC_DEFUN(STEPMAKE_NUMERIC_VERSION, [
-    echo "$1" | awk -F. '
-    {
-      if ([$]3) {three = [$]3}
-      else {three = 0}
-    }
-    {printf "%.0f\n", [$]1*1000000 + [$]2*1000 + three}'
+	echo "$1" | awk -F. '
+	  NF==1 {print; next}
+	  {printf "%.0f\n", [$]1*1000000 + [$]2*1000 + [$]3}'
 ])
 
 
@


1.3
log
@Update to 2.12.3.
@
text
@d1 1
a1 1
$OpenBSD: patch-stepmake_aclocal_m4,v 1.2 2007/06/06 20:36:23 kili Exp $
@


1.2
log
@
Update to 2.10.25.
@
text
@d1 1
a1 1
$OpenBSD: patch-stepmake_aclocal_m4,v 1.1.1.1 2006/10/29 19:27:12 kili Exp $
d3 3
a5 4
# Make the version check more robust against multiple line output
# for $whatever --version, and use awk(1) instead of sh(1) for
# comparing version numbers (it fails for fontforge, since our sh(1)
# doesn't yet have 64-bit arithmetic).
d7 3
a9 3
--- stepmake/aclocal.m4.orig	Tue May  1 17:28:45 2007
+++ stepmake/aclocal.m4	Sun May  6 17:57:23 2007
@@@@ -32,9 +32,14 @@@@ AC_DEFUN(STEPMAKE_GET_VERSION, [
d16 2
a17 6
+    eval '_ver=\`'"$1"' --version 2>&1\` || _ver=\`'"$1"' -V 2>&1\` &&
+	 _ver=\`echo $_ver |
+	 	grep '\''[0-9]\.[0-9]'\'' |
+        	head -n 1 |
+		tr '\'' '\'' '\''\n'\'' |
+		grep '\''[0-9]\.[0-9]'\'' |
d19 4
a22 1
+		sed '\''s/\([0-9.]*\).*/\1/g'\''\`'
d26 1
a26 1
@@@@ -49,12 +54,9 @@@@ AC_DEFUN(STEPMAKE_GET_VERSION, [
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
$OpenBSD$
d8 3
a10 3
--- stepmake/aclocal.m4.orig	Tue Sep 19 15:13:52 2006
+++ stepmake/aclocal.m4	Sat Oct  7 22:05:56 2006
@@@@ -31,9 +31,14 @@@@ AC_DEFUN(STEPMAKE_GET_VERSION, [
d12 1
a12 1
 
d16 1
a16 1
-	| tr ' ' '\n' | grep '[0-9]\.[0-9]' | head -n 1 | sed 's/\([0-9.]*\).*/\1/g'\`\"
d28 1
a28 1
@@@@ -48,12 +53,9 @@@@ AC_DEFUN(STEPMAKE_GET_VERSION, [
@


1.1.1.1
log
@
LilyPond -- music notation and typesetting software.

ok, mbalmer@@
@
text
@@
