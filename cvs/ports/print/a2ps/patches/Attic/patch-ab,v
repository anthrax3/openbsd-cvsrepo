head	1.6;
access;
symbols
	OPENBSD_2_6:1.5.0.6
	OPENBSD_2_6_BASE:1.5
	OPENBSD_2_5:1.5.0.4
	OPENBSD_2_5_BASE:1.5
	OPENBSD_2_4:1.5.0.2
	OPENBSD_2_4_BASE:1.5;
locks; strict;
comment	@# @;


1.6
date	99.11.27.13.30.53;	author kevlo;	state dead;
branches;
next	1.5;

1.5
date	98.09.30.03.27.08;	author angelos;	state Exp;
branches;
next	1.4;

1.4
date	98.08.10.22.02.01;	author marc;	state dead;
branches;
next	1.3;

1.3
date	98.06.10.20.17.11;	author weingart;	state Exp;
branches;
next	1.2;

1.2
date	98.06.06.21.36.02;	author angelos;	state Exp;
branches;
next	1.1;

1.1
date	98.04.28.02.17.13;	author angelos;	state Exp;
branches;
next	;


desc
@@


1.6
log
@Update to version 4.12g, we don't need those patches.
@
text
@*** src/generate.c.orig	Thu Jun 18 19:21:32 1998
--- src/generate.c	Thu Jun 18 19:26:31 1998
***************
*** 83,89 ****
    struct file_job * file_job;
    struct stat statbuf;		/* to get file modification time */
    struct tm *tm;
!   char * sample_file = NULL;	/* the name of the file on which run file(1) */
  
    a2ps_open_input_session (job, name);
    file_job = CURRENT_FILE (job);
--- 83,89 ----
    struct file_job * file_job;
    struct stat statbuf;		/* to get file modification time */
    struct tm *tm;
!   char sample_file[40];	/* the name of the file on which run file(1) */
  
    a2ps_open_input_session (job, name);
    file_job = CURRENT_FILE (job);
***************
*** 96,102 ****
        /* Create the buffer in charge of stdin */
        buffer_stream_set (res, stdin, end_of_line);
        /* Ask it to make a sample of the file */
!       sample_file = tmpnam (NULL);
        buffer_sample_get (res, sample_file);
      }
    else
--- 96,103 ----
        /* Create the buffer in charge of stdin */
        buffer_stream_set (res, stdin, end_of_line);
        /* Ask it to make a sample of the file */
!       snprintf(sample_file, 40, "%s/a2ps.XXXXXXXX", P_tmpdir);
!       close(mkstemp(sample_file));
        buffer_sample_get (res, sample_file);
      }
    else
@


1.5
log
@Update to version 4.10.4
@
text
@@


1.4
log
@to version 4.10.3; install config in /etc; update packing list
@
text
@d1 37
a37 11
--- contrib/Makefile.in.orig	Wed Jun 10 14:53:31 1998
+++ contrib/Makefile.in	Wed Jun 10 14:53:44 1998
@@@@ -158,7 +158,7 @@@@
 l = @@l@@
 lispdir = @@lispdir@@
 
-SUBDIRS = sample emacs
+SUBDIRS = sample
 
 bin_SCRIPTS = texi2dvi4a2ps card psmandup fixps pdiff
 
@


1.3
log
@Update for a2ps-4.10.2 (plus a couple fixes)
@
text
@@


1.2
log
@Fix patch.
@
text
@d1 11
a11 42
*** src/delegate.c.orig	Mon Apr 27 21:58:51 1998
--- src/delegate.c	Mon Apr 27 22:07:41 1998
***************
*** 204,210 ****
  subcontract (struct file_job * file, 
  	     struct delegation * contractor)
  {
!   char * command, * stdin_content_filename = NULL;
    FILE * in_stream, * out_stream;
    int lines_read = 0;
    char buf[512];
--- 204,210 ----
  subcontract (struct file_job * file, 
  	     struct delegation * contractor)
  {
!   char * command, stdin_content_filename[40];
    FILE * in_stream, * out_stream;
    int lines_read = 0;
    char buf[512];
***************
*** 219,227 ****
    if (file->name == job->stdin_filename) /* not strcmp */
      {
        FILE * stdin_content;
  
!       stdin_content_filename = tmpnam (NULL);
!       stdin_content = xwfopen (stdin_content_filename);
        streams_copy (stdin, stdin_content);
        fclose (stdin_content);
  
--- 219,229 ----
    if (file->name == job->stdin_filename) /* not strcmp */
      {
        FILE * stdin_content;
+       int stdfd;
  
!       sprintf(stdin_content_filename, "%s/a2p.XXXXXXXXXX", P_tmpdir);
!       stdfd = mkstemp(stdin_content_filename);
!       stdin_content = (FILE *) xwfdopen (stdfd);
        streams_copy (stdin, stdin_content);
        fclose (stdin_content);
  
@


1.1
log
@tempnam/tmpnam->mkstemp, and make default PAPERSIZE = Letter in
Makefile.

There's still a tempnam() in lib/jobs.c, but it's not clear how to
remove that.
@
text
@d8 1
a8 1
!   char * command, stdin_content_filename = NULL;
d16 1
a16 1
!   char * command, * stdin_content_filename[40];
@

