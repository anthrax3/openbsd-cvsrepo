head	1.4;
access;
symbols
	OPENBSD_2_6:1.3.0.6
	OPENBSD_2_6_BASE:1.3
	OPENBSD_2_5:1.3.0.4
	OPENBSD_2_5_BASE:1.3
	OPENBSD_2_4:1.3.0.2
	OPENBSD_2_4_BASE:1.3;
locks; strict;
comment	@# @;


1.4
date	99.11.27.13.30.53;	author kevlo;	state dead;
branches;
next	1.3;

1.3
date	98.06.19.17.34.55;	author angelos;	state Exp;
branches;
next	1.2;

1.2
date	98.06.10.20.17.12;	author weingart;	state dead;
branches;
next	1.1;

1.1
date	98.04.28.02.17.13;	author angelos;	state Exp;
branches;
next	;


desc
@@


1.4
log
@Update to version 4.12g, we don't need those patches.
@
text
@*** src/delegate.c.orig	Thu Jun 18 17:47:28 1998
--- src/delegate.c	Thu Jun 18 17:54:08 1998
***************
*** 205,211 ****
  subcontract (struct file_job * fjob, buffer_t * buffer,
  	     struct delegation * contractor)
  {
!   char * command, * stdin_content_filename = NULL;
    FILE * in_stream, * out_stream;
    int lines_read = 0;
    char buf[512];
--- 205,211 ----
  subcontract (struct file_job * fjob, buffer_t * buffer,
  	     struct delegation * contractor)
  {
!   char * command, stdin_content_filename[40];
    FILE * in_stream, * out_stream;
    int lines_read = 0;
    char buf[512];
***************
*** 220,226 ****
    if (fjob->name == job->stdin_filename) /* not strcmp */
      {
        /* Dump the content of the buffer */
!       stdin_content_filename = tmpnam (NULL);
        buffer_save (buffer, stdin_content_filename);
  
        /* We change the name of the file so that the correct
--- 220,227 ----
    if (fjob->name == job->stdin_filename) /* not strcmp */
      {
        /* Dump the content of the buffer */
!       snprintf(stdin_content_filename, 40, "%s/a2p.XXXXXXXX", P_tmpdir);
!       close(mkstemp(stdin_content_filename));
        buffer_save (buffer, stdin_content_filename);
  
        /* We change the name of the file so that the correct
@


1.3
log
@Fix some tempnam/tmpnam usages
@
text
@@


1.2
log
@Update for a2ps-4.10.2 (plus a couple fixes)
@
text
@d1 2
a2 2
*** src/main.c.orig	Mon Apr 27 22:08:06 1998
--- src/main.c	Mon Apr 27 22:09:09 1998
d4 3
a6 1
*** 426,436 ****
d8 7
a14 11
  #define PREFIX "% "
    FILE * tmp_file;
!   char * tmp_filename;
    char buf [BUFSIZ];
  
!   tmp_filename = tmpnam (NULL);
!   tmp_file = fopen (tmp_filename, "w");
    if (!tmp_file)
      error (1, errno, _("cannot open file `%s'"), tmp_filename);
  
--- 426,436 ----
d16 11
a26 4
  #define PREFIX "% "
    FILE * tmp_file;
!   char tmp_filename[40];
    char buf [BUFSIZ];
d28 8
a35 4
!   sprintf(tmp_filename, "%s/ap2.XXXXXXXXXX", P_tmpdir);
!   tmp_file = fdopen (mkstemp(tmp_filename), "w");
    if (!tmp_file)
      error (1, errno, _("cannot open file `%s'"), tmp_filename);
d37 1
@


1.1
log
@tempnam/tmpnam->mkstemp, and make default PAPERSIZE = Letter in
Makefile.

There's still a tempnam() in lib/jobs.c, but it's not clear how to
remove that.
@
text
@@

