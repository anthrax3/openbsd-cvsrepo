head	1.1;
access;
symbols
	OPENBSD_5_5:1.1.0.4
	OPENBSD_5_4:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2014.03.17.08.39.13;	author ajacoutot;	state dead;
branches
	1.1.2.1
	1.1.4.1;
next	;

1.1.2.1
date	2014.03.17.08.39.13;	author ajacoutot;	state Exp;
branches;
next	;

1.1.4.1
date	2014.03.17.08.52.47;	author ajacoutot;	state Exp;
branches;
next	;


desc
@@


1.1
log
@file patch-filter_pdftoopvp_oprs_OPVPWrapper_cxx was initially added on branch OPENBSD_5_4.
@
text
@@


1.1.4.1
log
@SECURITY FIX for CVE-2013-6474, CVE-2013-6475, and CVE-2013-6476.
@
text
@a0 19
$OpenBSD$

SECURITY FIX for CVE-2013-6474, CVE-2013-6475, and CVE-2013-6476.

--- filter/pdftoopvp/oprs/OPVPWrapper.cxx.orig	Tue Dec 10 22:20:15 2013
+++ filter/pdftoopvp/oprs/OPVPWrapper.cxx	Mon Mar 17 09:49:22 2014
@@@@ -822,6 +822,12 @@@@ OPVPWrapper *OPVPWrapper::loadDriver(const char *drive
     void *handle = 0;
     OPVPWrapper *opvp = 0;
 
+    // remove directory part
+    const char *s = strrchr(driverName,'/');
+    if (s != NULL) {
+        driverName = s+1;
+    }
+
     list = genDynamicLibName(driverName);
 
     if (list) {
@


1.1.2.1
log
@SECURITY FIX for CVE-2013-6474, CVE-2013-6475, and CVE-2013-6476.
@
text
@a0 19
$OpenBSD$

SECURITY FIX for CVE-2013-6474, CVE-2013-6475, and CVE-2013-6476.

--- filter/pdftoopvp/oprs/OPVPWrapper.cxx.orig	Fri Jun 22 18:10:47 2012
+++ filter/pdftoopvp/oprs/OPVPWrapper.cxx	Mon Mar 17 09:25:44 2014
@@@@ -822,6 +822,12 @@@@ OPVPWrapper *OPVPWrapper::loadDriver(const char *drive
     void *handle = 0;
     OPVPWrapper *opvp = 0;
 
+    // remove directory part
+    const char *s = strrchr(driverName,'/');
+    if (s != NULL) {
+        driverName = s+1;
+    }
+
     list = genDynamicLibName(driverName);
 
     if (list) {
@

