head	1.2;
access;
symbols
	OPENBSD_3_1:1.1.0.10
	OPENBSD_3_1_BASE:1.1
	OPENBSD_3_0:1.1.0.8
	OPENBSD_3_0_BASE:1.1
	OPENBSD_2_9_TRACKING_SWITCH:1.1
	OPENBSD_2_9:1.1.0.6
	OPENBSD_2_9_BASE:1.1
	OPENBSD_2_8:1.1.0.4
	OPENBSD_2_8_BASE:1.1
	OPENBSD_2_7:1.1.0.2
	OPENBSD_2_7_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2002.07.07.17.03.37;	author naddy;	state dead;
branches;
next	1.1;

1.1
date	99.12.14.06.42.22;	author kevlo;	state Exp;
branches;
next	;


desc
@@


1.2
log
@* Update to 2.5.2.
* All-around clean-up.
* Fix licensing information.

Once upon a time okayed by maintainer.
@
text
@--- args.c.orig	Wed Nov 26 10:14:22 1997
+++ args.c	Mon Dec 13 19:32:26 1999
@@@@ -45,6 +45,7 @@@@
     int consumed;
     int currarg;
     int opterrors;
+    size_t	len;
 
 #define OPTARG()  \
     { consumed = 1; if(*++optstr == '\0') optstr = argv[++currarg]; }
@@@@ -146,18 +147,17 @@@@
                         break;
                 case 'C':    /* select character definitions */
                         consumed = 1;
+			len = (strlen(libdir) + strlen(optstr) + 2);
                         if (*++optstr) { /* did we get a encoding name ? */
-                            if ((charvec_file = (char *) malloc(strlen(libdir) +
-                                                                strlen(optstr) +
-                                                                2)) == NULL) {
+                            if ((charvec_file = (char *) malloc(len)) == NULL) {
                                 perror(optstr);
                                 fprintf(stderr,
                                     "ignoring character encoding definition\n");
                             }
                             else {
-                                (void) strcpy(charvec_file, libdir);
-                                (void) strcat(charvec_file, "/");
-                                (void) strcat(charvec_file, optstr);
+                                (void) strlcpy(charvec_file, libdir, len);
+                                (void) strlcat(charvec_file, "/", len);
+                                (void) strlcat(charvec_file, optstr, len);
                                 opt_encoding = 1;
                             }
                         }
@@@@ -341,10 +341,10 @@@@
                 case 'P':    /* Printer */
                         consumed = 1;
                         doprint = 1;
-                        if (*++optstr)
+                        if (*++optstr) {
                             if (!strcmp(optstr, "-"))
                                 doprint = 0; /* kill MPAGE envvar que setting*/
-                            else {
+                           } else {
                                 printque = optstr;
                             }
                         break;
@@@@ -429,7 +429,7 @@@@
         libdir = env;
 
     if ((env = getenv("MPAGE")) != NULL) {
-        strcpy(copy, env);
+        (void)strlcpy(copy, env, sizeof(copy));
         argv = slice(copy, &argc);
         if (do_args(argc, argv, 1) < 0) {
             fprintf(stderr, "%s: error in environment \"%s\"\n", MPAGE, env);
@


1.1
log
@Remove all warnings. Change all strcpy -> strlcpy, strcat-> strlcat,
and  sprintf -> snprintf.
@
text
@@

