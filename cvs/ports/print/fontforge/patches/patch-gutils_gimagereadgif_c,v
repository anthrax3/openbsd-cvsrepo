head	1.2;
access;
symbols
	OPENBSD_6_2:1.2.0.10
	OPENBSD_6_2_BASE:1.2
	OPENBSD_6_1:1.2.0.8
	OPENBSD_6_1_BASE:1.2
	OPENBSD_6_0:1.2.0.6
	OPENBSD_6_0_BASE:1.2
	OPENBSD_5_9:1.2.0.2
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.2.0.4
	OPENBSD_5_8_BASE:1.2
	OPENBSD_5_7:1.1.0.6
	OPENBSD_5_7_BASE:1.1
	OPENBSD_5_6:1.1.0.4
	OPENBSD_5_6_BASE:1.1
	OPENBSD_5_5:1.1.0.2
	OPENBSD_5_5_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2015.03.28.17.59.17;	author sthen;	state Exp;
branches;
next	1.1;
commitid	Xm4OXwpeb6E6High;

1.1
date	2013.09.25.07.58.46;	author sthen;	state Exp;
branches;
next	;


desc
@@


1.2
log
@handle giflib api change
@
text
@$OpenBSD: patch-gutils_gimagereadgif_c,v 1.1 2013/09/25 07:58:46 sthen Exp $

giflib 5.0+

--- gutils/gimagereadgif.c.orig	Thu Aug  2 16:09:09 2012
+++ gutils/gimagereadgif.c	Sat Mar 28 17:55:56 2015
@@@@ -132,13 +132,13 @@@@ GImage *GImageReadGif(char *filename) {
 	if ( !loadgif())
 return( NULL );
 
-    if ((gif = _DGifOpenFileName(filename)) == NULL) {
+    if ((gif = _DGifOpenFileName(filename, NULL)) == NULL) {
 	fprintf( stderr, "can't open %s\n", filename);
 return( NULL );
     }
 
     if ( _DGifSlurp(gif)==GIF_ERROR ) {
-	_DGifCloseFile(gif);
+	_DGifCloseFile(gif, NULL);
 	fprintf( stderr, "Bad gif file %s\n", filename );
 return( NULL );
     }
@@@@ -150,7 +150,7 @@@@ return( NULL );
 	ret = images[0];
     else
 	ret = GImageCreateAnimation(images,gif->ImageCount);
-    _DGifCloseFile(gif);
+    _DGifCloseFile(gif, NULL);
     free(images);
 return( ret );
 }
@@@@ -220,13 +220,13 @@@@ GImage *GImageReadGif(char *filename) {
     GifFileType *gif;
     int i;
 
-    if ((gif = DGifOpenFileName(filename)) == NULL) {
+    if ((gif = DGifOpenFileName(filename, NULL)) == NULL) {
 	fprintf( stderr, "can't open %s\n", filename);
 return( NULL );
     }
 
     if ( DGifSlurp(gif)==GIF_ERROR ) {
-	DGifCloseFile(gif);
+	DGifCloseFile(gif, NULL);
 	fprintf(stderr,"Bad gif file %s\n", filename );
 return( NULL );
     }
@@@@ -238,7 +238,7 @@@@ return( NULL );
 	ret = images[0];
     else
 	ret = GImageCreateAnimation(images,gif->ImageCount);
-    DGifCloseFile(gif);
+    DGifCloseFile(gif, NULL);
     free(images);
 return( ret );
 }
@


1.1
log
@libungif->giflib and patch where necessary, ok jasper@@ aja@@
@
text
@d1 1
a1 1
$OpenBSD$
d5 28
a32 3
--- gutils/gimagereadgif.c.orig	Thu Sep 19 06:41:58 2013
+++ gutils/gimagereadgif.c	Thu Sep 19 06:44:24 2013
@@@@ -220,7 +220,7 @@@@ GImage *GImageReadGif(char *filename) {
d41 16
@

