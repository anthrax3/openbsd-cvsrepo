head	1.3;
access;
symbols
	OPENBSD_6_1:1.3.0.46
	OPENBSD_6_1_BASE:1.3
	OPENBSD_6_0:1.3.0.44
	OPENBSD_6_0_BASE:1.3
	OPENBSD_5_9:1.3.0.40
	OPENBSD_5_9_BASE:1.3
	OPENBSD_5_8:1.3.0.42
	OPENBSD_5_8_BASE:1.3
	OPENBSD_5_7:1.3.0.38
	OPENBSD_5_7_BASE:1.3
	OPENBSD_5_6:1.3.0.36
	OPENBSD_5_6_BASE:1.3
	OPENBSD_5_5:1.3.0.34
	OPENBSD_5_5_BASE:1.3
	OPENBSD_5_4:1.3.0.32
	OPENBSD_5_4_BASE:1.3
	OPENBSD_5_3:1.3.0.30
	OPENBSD_5_3_BASE:1.3
	OPENBSD_5_2:1.3.0.28
	OPENBSD_5_2_BASE:1.3
	OPENBSD_5_1_BASE:1.3
	OPENBSD_5_1:1.3.0.26
	OPENBSD_5_0:1.3.0.24
	OPENBSD_5_0_BASE:1.3
	OPENBSD_4_9:1.3.0.22
	OPENBSD_4_9_BASE:1.3
	OPENBSD_4_8:1.3.0.20
	OPENBSD_4_8_BASE:1.3
	OPENBSD_4_7:1.3.0.18
	OPENBSD_4_7_BASE:1.3
	OPENBSD_4_6:1.3.0.16
	OPENBSD_4_6_BASE:1.3
	OPENBSD_4_5:1.3.0.14
	OPENBSD_4_5_BASE:1.3
	OPENBSD_4_4:1.3.0.12
	OPENBSD_4_4_BASE:1.3
	OPENBSD_4_3:1.3.0.10
	OPENBSD_4_3_BASE:1.3
	OPENBSD_4_2:1.3.0.8
	OPENBSD_4_2_BASE:1.3
	OPENBSD_4_1:1.3.0.6
	OPENBSD_4_1_BASE:1.3
	OPENBSD_4_0:1.3.0.4
	OPENBSD_4_0_BASE:1.3
	OPENBSD_3_9:1.3.0.2
	OPENBSD_3_9_BASE:1.3
	OPENBSD_3_8:1.2.0.8
	OPENBSD_3_8_BASE:1.2
	OPENBSD_3_7:1.2.0.6
	OPENBSD_3_7_BASE:1.2
	OPENBSD_3_6:1.2.0.4
	OPENBSD_3_6_BASE:1.2
	OPENBSD_3_5:1.2.0.2
	OPENBSD_3_5_BASE:1.2;
locks; strict;
comment	@# @;


1.3
date	2006.01.02.20.05.09;	author sturm;	state Exp;
branches;
next	1.2;

1.2
date	2003.12.26.17.07.56;	author naddy;	state Exp;
branches;
next	1.1;

1.1
date	2003.12.18.03.32.20;	author naddy;	state Exp;
branches;
next	;


desc
@@


1.3
log
@SHARED_LIBS, USE_LIBTOOL
@
text
@$OpenBSD: patch-configure_in,v 1.2 2003/12/26 17:07:56 naddy Exp $
--- configure.in.orig	Sat Jun 15 22:41:53 2002
+++ configure.in	Mon Jan  2 20:59:02 2006
@@@@ -601,42 +601,6 @@@@ AC_SUBST(TCLINCLUDE)
 AC_SUBST(TCLPACKAGEDIR)
 AC_SUBST(TCLBIN)
 
-# ----------------------------------------------------------------
-#  PDFlib auxiliary library: TIFFlib
-#  We bring our own copy of tifflib but the client may choose to
-#  use an installed one instead. This is only support for C/C++ clients.
-# ----------------------------------------------------------------
-
-# The list of Makefile targets for our internal libraries
-LIBTARGETS=""
-INTERNALLIBS=""
-
-WITH_INTERNALTIFFLIB="yes"
-TIFFLIBINC=""
-EXTERNALLIBS="$MATHLIB"
-
-AC_ARG_WITH(tifflib,
-[  --with-tifflib          use installed tifflib instead of internal (not rec.)],
-[
-    AC_CHECK_LIB(tiff, TIFFOpen, [EXTERNALLIBS="$EXTERNALLIBS -ltiff"],
-	AC_MSG_ERROR([No usable tifflib library found.]))
-
-    AC_CHECK_HEADER(tiff.h, , 
-	AC_MSG_ERROR([No usable tifflib include file found.]))
-
-    AC_MSG_RESULT([         Note: user-supplied tifflib - language bindings disabled])
-    WITH_INTERNALTIFFLIB="no"
-],[
-    AC_C_BIGENDIAN()
-
-    TIFFLIBINC="-I../tiff"
-    INTERNALLIBS="$INTERNALLIBS \$(top_builddir)/tiff/libtiff.la"
-    LIBTARGETS="$LIBTARGETS libtiff"
-    GENERATED_FILES="$GENERATED_FILES tiff/Makefile"
-])
-
-AC_SUBST(TIFFLIBINC)
-
 # ----------------------------------------------------------------------
 #  PDFlib auxiliary library: Zlib
 #  We bring our own copy of zlib but the client may choose to
@@@@ -685,7 +649,8 @@@@ AC_ARG_WITH(pnglib,
     dnl Make sure libpng sits in front of libz
     AC_CHECK_LIB(png, png_create_read_struct,
 	[EXTERNALLIBS="-lpng $EXTERNALLIBS"],
-	AC_MSG_ERROR([No usable pnglib library found.]))
+	AC_MSG_ERROR([No usable pnglib library found.]),
+	$EXTERNALLIBS)
 
     AC_CHECK_HEADER(png.h, , 
 	AC_MSG_ERROR([No usable pnglib include file found.]))
@@@@ -707,6 +672,56 @@@@ AC_ARG_WITH(pnglib,
 AC_SUBST(PNGLIBINC)
 
 # ----------------------------------------------------------------
+#  PDFlib auxiliary library: TIFFlib
+#  We bring our own copy of tifflib but the client may choose to
+#  use an installed one instead. This is only support for C/C++ clients.
+# ----------------------------------------------------------------
+
+# The list of Makefile targets for our internal libraries
+LIBTARGETS=""
+INTERNALLIBS=""
+
+WITH_INTERNALTIFFLIB="yes"
+TIFFLIBINC=""
+EXTERNALLIBS="$EXTERNALLIBS $MATHLIB"
+
+AC_ARG_WITH(tifflib,
+[  --with-tifflib          use installed tifflib instead of internal (not rec.)],
+[
+    if test "$WITH_INTERNALZLIB" = "yes"; then
+	AC_MSG_ERROR([--with-tifflib requires --with-zlib])
+    fi
+
+    AC_CHECK_LIB(jpeg, jpeg_read_header,
+	[EXTERNALLIBS="-ljpeg $EXTERNALLIBS"])
+
+    dnl Make sure libtiff sits in front of libz
+    AC_CHECK_LIB(tiff, TIFFOpen,
+	[EXTERNALLIBS="-ltiff $EXTERNALLIBS"],
+	AC_MSG_ERROR([No usable tifflib library found.]),
+	$EXTERNALLIBS)
+
+    AC_CHECK_HEADER(tiff.h, , 
+	AC_MSG_ERROR([No usable tifflib include file found.]))
+
+    AC_MSG_RESULT([         Note: user-supplied tifflib - language bindings disabled])
+    WITH_INTERNALTIFFLIB="no"
+],[
+    if test "$WITH_INTERNALZLIB" = "no"; then
+	AC_MSG_ERROR([--with-zlib requires --with-tifflib])
+    fi
+
+    AC_C_BIGENDIAN()
+
+    TIFFLIBINC="-I../tiff"
+    INTERNALLIBS="$INTERNALLIBS \$(top_builddir)/tiff/libtiff.la"
+    LIBTARGETS="$LIBTARGETS libtiff"
+    GENERATED_FILES="$GENERATED_FILES tiff/Makefile"
+])
+
+AC_SUBST(TIFFLIBINC)
+
+# ----------------------------------------------------------------
 #  PDFlib auxiliary library: PDI (PDF import library)
 # ----------------------------------------------------------------
 
@@@@ -934,7 +949,7 @@@@ if test "$WITH_SHARED" = "no"; then
     RPATH=""
 else
     dnl we generate both static and shared libs
-    RPATH="-rpath \$(libdir) -version-info $LTVERSIONINFO"
+    RPATH="-rpath \$(libdir) \$(LIBpdf_LTVERSION)"
 
 fi
 
@


1.2
log
@libtiff requires explicit linking with -ljpeg -lz.

- Use autoconf.
- Move the libtiff check after the libz one.
- Bring libtiff check in line with libpng one (which also needs -lz),
  and insert an inconspicuous check for libjpeg.

ok jakob@@
@
text
@d1 3
a3 3
$OpenBSD: patch-configure_in,v 1.1 2003/12/18 03:32:20 naddy Exp $
--- configure.in.orig	2002-06-15 22:41:53.000000000 +0200
+++ configure.in	2003-12-26 17:32:02.000000000 +0100
d113 9
@


1.1
log
@actually add libz when linking with libpng
@
text
@d1 47
a47 4
$OpenBSD$
--- configure.in.orig	2003-12-17 19:48:14.000000000 -0700
+++ configure.in	2003-12-17 19:48:55.000000000 -0700
@@@@ -685,7 +685,8 @@@@ AC_ARG_WITH(pnglib,
d57 57
@

