head	1.1;
access;
symbols
	OPENBSD_6_1:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2017.05.04.06.51.09;	author bluhm;	state Exp;
branches
	1.1.2.1;
next	;
commitid	J2uISA2TQztN2hJS;

1.1.2.1
date	2017.05.16.16.09.49;	author pirofti;	state Exp;
branches;
next	;
commitid	2XN6ux2VTT4k8LTO;


desc
@@


1.1
log
@Fix CVE-2017-8291 shell injection in ghostscript.
Apply patches from upstream git.
OK kili@@ (maintainer)
@
text
@$OpenBSD$

https://git.ghostscript.com/?p=ghostpdl.git;a=commitdiff;h=4f83478c88

Index: psi/zmisc3.c
--- psi/zmisc3.c.orig
+++ psi/zmisc3.c
@@@@ -56,6 +56,12 @@@@ zeqproc(i_ctx_t *i_ctx_p)
     ref2_t stack[MAX_DEPTH + 1];
     ref2_t *top = stack;
 
+    if (ref_stack_count(&o_stack) < 2)
+        return_error(e_stackunderflow);
+    if (!r_is_array(op - 1) || !r_is_array(op)) {
+        return_error(e_typecheck);
+    }
+
     make_array(&stack[0].proc1, 0, 1, op - 1);
     make_array(&stack[0].proc2, 0, 1, op);
     for (;;) {
@


1.1.2.1
log
@Backport CVE-2017-8291 fix from blumh@@.

OK ajacoutot@@
@
text
@d1 1
a1 1
$OpenBSD: patch-psi_zmisc3_c,v 1.1 2017/05/04 06:51:09 bluhm Exp $
@

