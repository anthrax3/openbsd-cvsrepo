head	1.4;
access;
symbols
	OPENBSD_6_0:1.4.0.2
	OPENBSD_6_0_BASE:1.4
	OPENBSD_5_9:1.3.0.2
	OPENBSD_5_9_BASE:1.3
	OPENBSD_5_8:1.3.0.4
	OPENBSD_5_8_BASE:1.3
	OPENBSD_5_7:1.2.0.6
	OPENBSD_5_7_BASE:1.2
	OPENBSD_5_6:1.2.0.4
	OPENBSD_5_6_BASE:1.2
	OPENBSD_5_5:1.2.0.2
	OPENBSD_5_5_BASE:1.2;
locks; strict;
comment	@# @;


1.4
date	2016.06.01.12.47.33;	author edd;	state Exp;
branches;
next	1.3;
commitid	UV6MIj5ViZWo7hqx;

1.3
date	2015.05.18.21.38.04;	author edd;	state Exp;
branches;
next	1.2;
commitid	lX1CFagn8LDeCaRV;

1.2
date	2014.01.20.21.34.44;	author edd;	state Exp;
branches;
next	1.1;

1.1
date	2014.01.11.18.46.52;	author edd;	state Exp;
branches;
next	;


desc
@@


1.4
log
@print/texlive: Update to 2015.

OK abieber@@, schwarze@@.

Additional testing by Caspar Schutijser.

Thanks
@
text
@$OpenBSD: patch-texmf-dist_web2c_texmfcnf_lua,v 1.3 2015/05/18 21:38:04 edd Exp $
--- texmf-dist/web2c/texmfcnf.lua.origy	Sun Apr 12 16:20:30 2015
+++ texmf-dist/web2c/texmfcnf.lua	Sun Apr 17 21:52:47 2016
@@@@ -3,9 +3,6 @@@@
 -- ConTeXt needs a properly expanded TEXMFLOCAL, so here is a
 -- bit of lua code to make that happen
 
-local texmflocal = resolvers.prefixes.selfautoparent();
-texmflocal = string.gsub(texmflocal, "20%d%d$", "texmf-local");
-
 return {
 
     type    = "configuration",
@@@@ -26,6 +23,10 @@@@ return {
 
         variables = {
 
+            -- Note that in OpenBSD, where we use the old teTeX path convention
+            -- selfautodir does not work.
+            TEXMFROOT       = "${TRUEPREFIX}/share",
+
             -- The following variable is predefined (but can be overloaded) and in
             -- most cases you can leve this one untouched. The built-in definition
             -- permits relocation of the tree.
@@@@ -44,7 +45,7 @@@@ return {
 
             -- only used for FONTCONFIG_PATH & TEXMFCACHE in TeX Live
 
-            TEXMFSYSVAR     = "selfautoparent:texmf-var",
+            TEXMFSYSVAR     = "$TEXMFROOT/texmf-var",
             TEXMFVAR        = "home:.texlive2015/texmf-var",
 
             -- We have only one cache path but there can be more. The first writable one
@@@@ -62,12 +63,12 @@@@ return {
             -- entry. This makes the tex root relocatable.
 
             TEXMFOS         = "selfautodir:",
-            TEXMFDIST       = "selfautoparent:texmf-dist",
+            TEXMFDIST       = "$TEXMFROOT/texmf-dist",
 
             TEXMFLOCAL      = texmflocal,
-            TEXMFSYSCONFIG  = "selfautoparent:texmf-config",
-            TEXMFFONTS      = "selfautoparent:texmf-fonts",
-            TEXMFPROJECT    = "selfautoparent:texmf-project",
+            TEXMFSYSCONFIG  = "$TEXMFROOT/texmf-config",
+            TEXMFFONTS      = "$TEXMFROOT/texmf-fonts",
+            TEXMFPROJECT    = "$TEXMFROOT/texmf-project",
 
             TEXMFHOME       = "home:texmf",
          -- TEXMFHOME       = os.name == "macosx" and "home:Library/texmf" or "home:texmf",
@


1.3
log
@Update to TeX Live 2014.

OK sthen@@, dcoppa@@, giovanni@@, thanks!
@
text
@d1 3
a3 3
$OpenBSD$
--- texmf-dist/web2c/texmfcnf.lua.origy	Thu Apr 17 18:13:20 2014
+++ texmf-dist/web2c/texmfcnf.lua	Fri Oct 17 23:40:31 2014
d14 1
a14 3
@@@@ -42,9 +39,13 @@@@ return {
             --     "selfautoparent:",
             -- }
d16 4
a19 2
+            -- Note that in OpenBSD, where we use the old teTeX path convention 
+            -- selfautodir does not work.                                       
d22 5
d31 1
a31 1
             TEXMFVAR        = "home:.texlive2014/texmf-var",
@


1.2
log
@Remove TEXMFMAIN from our TeX configuration.

Now that the last of the ports which was installing in the deprecated
TEXMFMAIN have been fixed, the TEXMFMAIN texmf tree can dissappear. We do
this by falling in line with the upstream configurations.

OK naddy@@
@
text
@d1 3
a3 6
$OpenBSD: patch-texmf-dist_web2c_texmfcnf_lua,v 1.1 2014/01/11 18:46:52 edd Exp $

Patch in OpenBSD paths.

--- texmf-dist/web2c/texmfcnf.lua.origy	Tue Apr  9 15:15:26 2013
+++ texmf-dist/web2c/texmfcnf.lua	Mon Jan 20 17:33:53 2014
d14 1
a14 2
@@@@ -41,10 +38,14 @@@@ return {
             --     "selfautoparent:/texmf/web2c",
a16 4
+	    
+	    -- Note that in OpenBSD, where we use the old teTeX path convention 
+	    -- selfautodir does not work.                                       
+	    TEXMFROOT       = "${TRUEPREFIX}/share",
d18 4
d26 1
a26 1
             TEXMFVAR        = "home:.texlive2013/texmf-var",
@


1.1
log
@Update to TeX Live 2013.

This incudes the new buildset texmf -- a smaller texmf tree used for
BUILD_DEPENDS. See the package README for more info on this.

OK espie@@
@
text
@d1 1
a1 1
$OpenBSD$
d6 1
a6 1
+++ texmf-dist/web2c/texmfcnf.lua	Mon Dec  2 16:37:46 2013
d33 1
a33 1
@@@@ -62,12 +63,14 @@@@ return {
a38 2
+	    -- OpenBSD: TEXMFMAIN is deprecated, but some ports use it
+	    TEXMFMAIN       = "$TEXMFROOT/texmf",
a49 9
@@@@ -75,7 +78,7 @@@@ return {
             -- We need texmfos for a few rare files but as I have a few more bin trees
             -- a hack is needed. Maybe other users also have texmf-platform-new trees.
 
-            TEXMF           = "{$TEXMFCONFIG,$TEXMFHOME,!!$TEXMFSYSCONFIG,!!$TEXMFSYSVAR,!!$TEXMFPROJECT,!!$TEXMFFONTS,!!$TEXMFLOCAL,!!$TEXMFDIST}",
+            TEXMF           = "{$TEXMFCONFIG,$TEXMFHOME,!!$TEXMFSYSCONFIG,!!$TEXMFSYSVAR,!!$TEXMFPROJECT,!!$TEXMFFONTS,!!$TEXMFLOCAL,!!$TEXMFDIST,!!$TEXMFMAIN"},
 
             TEXFONTMAPS     = ".;$TEXMF/fonts/data//;$TEXMF/fonts/map/{pdftex,dvips}//",
             ENCFONTS        = ".;$TEXMF/fonts/data//;$TEXMF/fonts/enc/{dvips,pdftex}//",
@

