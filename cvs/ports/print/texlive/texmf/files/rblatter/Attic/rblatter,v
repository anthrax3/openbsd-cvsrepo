head	1.3;
access;
symbols
	OPENBSD_5_4:1.2.0.10
	OPENBSD_5_4_BASE:1.2
	OPENBSD_5_3:1.2.0.8
	OPENBSD_5_3_BASE:1.2
	OPENBSD_5_2:1.2.0.6
	OPENBSD_5_2_BASE:1.2
	OPENBSD_5_1_BASE:1.2
	OPENBSD_5_1:1.2.0.4
	OPENBSD_5_0:1.2.0.2
	OPENBSD_5_0_BASE:1.2
	OPENBSD_4_9:1.1.1.1.0.2
	OPENBSD_4_9_BASE:1.1.1.1
	edd_20100820:1.1.1.1
	edd:1.1.1;
locks; strict;
comment	@# @;


1.3
date	2014.01.11.18.46.52;	author edd;	state dead;
branches;
next	1.2;

1.2
date	2011.03.08.00.09.42;	author edd;	state Exp;
branches;
next	1.1;

1.1
date	2010.08.20.12.04.30;	author edd;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2010.08.20.12.04.30;	author edd;	state Exp;
branches;
next	;


desc
@@


1.3
log
@Update to TeX Live 2013.

This incudes the new buildset texmf -- a smaller texmf tree used for
BUILD_DEPENDS. See the package README for more info on this.

OK espie@@
@
text
@#!/usr/bin/env ruby18
# Copyright (c) 2008-2010, Edd Barrett <vext01@@gmail.com>
# 
# Permission to use, copy, modify, and/or distribute this software for any
# purpose with or without fee is hereby granted, provided that the above
# copyright notice and this permission notice appear in all copies.
# 
# THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
# WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
# MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
# ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
# WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
# ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
# OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
# 
# RBlatter
# $Id: rblatter,v 1.2 2011/03/08 00:09:42 edd Exp $
#
# == Synopsis
# RBlatter is a ruby script which allows you to add and subtract TeXmf
# subsets using the TeX Live TLPDB information. 
#
# == Usage
# rblatter [-h] [-v] -o dir -s svnroot eqn
#
# -a, --arch:
# 	specify the architecture to use for platform
# 	specific files. Should specify always.
# 	defaults to i386-openbsd
#
# -d, --dirs:
# 	add directories to conatin files to packing list.
# 	used for openbsd packing lists
#
# -h, --help:
#	show this message
#
# -n --no-missing-files:
# 	do not put missing files in PLIST
# 	(requires full texmf)
#
# -o --outdir:
# 	output directory
#
# -t, --svnroot SVNROOT:
#	root of texlive svn checkout (trunk/Master).
#
# -q, --quiet:
# 	do not show progress information.
#
# EQN: subset equation
# 	eg. +scheme-full,doc,run,src:+scheme-medium,run:-scheme-tetex,bin
#   	Means:
# 		take scheme-full's docfiles, runfiles and srcfiles.
#		add to this scheme-medium's runfiles.
#		subtract from these scheme-tetex's binfiles
#
#	Available file types are 'run', 'src', 'bin' and 'doc'.

$RBLATTER_V = "$OpenBSD: rblatter,v 1.2 2011/03/08 00:09:42 edd Exp $"
$QUIET = true;
$FILEPREFIX = ""
$ARCH = "i386-openbsd"
$MISSING_FILES = true
$ADD_DIRS = false

path = File.dirname $0
$: << path + "/lib"

require "getoptlong"
require "rdoc/usage"
require "subsetshaper"
require "eqnparser"

# Parse args
opts = GetoptLong.new(
	["--arch", "-a", GetoptLong::REQUIRED_ARGUMENT],
	["--dirs", "-d", GetoptLong::NO_ARGUMENT],
	["--help", "-h", GetoptLong::NO_ARGUMENT],
	["--no-missing-files", "-n", GetoptLong::NO_ARGUMENT],
	["--outdir", "-o", GetoptLong::REQUIRED_ARGUMENT],
	["--prefix", "-p", GetoptLong::REQUIRED_ARGUMENT],
	["--tlmaster", "-t", GetoptLong::REQUIRED_ARGUMENT],
	["--verbose", "-v", GetoptLong::NO_ARGUMENT]
)

opts.each do | opt, arg |
	case opt
	when '--arch'
		$ARCH = arg
	when '--dirs'
		$ADD_DIRS = true
	when '--help'
		RDoc::usage
		exit 1
	when '--no-missing-files'
		$MISSING_FILES = false
	when '--outdir'
		$OUTDIR = arg
	when '--prefix'
		$FILEPREFIX = arg
	when '--tlmaster'
		$TLMASTER = arg
	when '--verbose'
		$QUIET = false
	end
end

# Checks
if !defined? $TLMASTER then
	puts "*error: no --tlmaster | -t defined";
	exit 1
end

if !defined? $OUTDIR then
	puts "*error: no --outdir | -o  defined";
	exit 1
end

if ARGV.length != 1
	puts "*error: no subset equation specified."
	exit 0
end

# Yoink equation as whats left of command line
$EQN = ARGV.shift

# Go!
shaper = SubsetShaper.new

if !$QUIET then
	puts "Job done!"
end
@


1.2
log
@Update to TeX Live 2010.

This year we pre-generate format and maps as requested by kili.

Started adding test cases in the tests/ dir.

Upgrades from 2009 will cause a harmless warning regarding texlinks. Espie is
aware of this, it was not easily fixable.

Uninstalls of texlive 2010 which were previously upgraded from 2009 will make
lots of noise regarding non-empty directories which can not be deleted. This
is due to unregistered package directories in the old texlive 2009 pacakage and
has been fixed in the 2010 package (rblatter script was modified to register
*all* parent dirs in PLISTs).

Installs/uninstalls of texlive 2010 on a fresh system (which has never
seen texlive 2009) are squeaky clean.

This has been in use for a number of months on my work machine, so should be
pretty stable, but I am sure someone will find some obscure bugs. These can be
fixed in tree.

OK espie@@
@
text
@d17 1
a17 1
# $Id: rblatter,v 1.2 2010/10/20 13:15:55 edd Exp $
d60 1
a60 1
$RBLATTER_V = "$OpenBSD: rblatter,v 1.2 2010/10/20 13:15:55 edd Exp $"
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
#!/usr/bin/env ruby
d17 1
a17 1
# $Id: rblatter 18 2010-08-20 11:38:48Z eb771 $
d31 4
d60 1
a60 1
$RBLATTER_V = "$Id: rblatter 18 2010-08-20 11:38:48Z eb771 $"
d65 1
d78 1
d91 2
d96 1
a96 1
	when '--no-missing-files':
@


1.1.1.1
log
@import rblatter - script used to generate packing lists for the texmfs based
upon TeX Live's tlpdb.

Imported at espie's request.

Note: This will need alterations for tl2010.

OK espie@@
@
text
@@
