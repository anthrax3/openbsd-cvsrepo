head	1.3;
access;
symbols
	OPENBSD_4_4:1.2.0.16
	OPENBSD_4_4_BASE:1.2
	OPENBSD_4_3:1.2.0.14
	OPENBSD_4_3_BASE:1.2
	OPENBSD_4_2:1.2.0.12
	OPENBSD_4_2_BASE:1.2
	OPENBSD_4_1:1.2.0.10
	OPENBSD_4_1_BASE:1.2
	OPENBSD_4_0:1.2.0.8
	OPENBSD_4_0_BASE:1.2
	OPENBSD_3_9:1.2.0.6
	OPENBSD_3_9_BASE:1.2
	OPENBSD_3_8:1.2.0.4
	OPENBSD_3_8_BASE:1.2
	OPENBSD_3_7:1.2.0.2
	OPENBSD_3_7_BASE:1.2
	OPENBSD_3_6:1.1.0.4
	OPENBSD_3_5:1.1.0.2;
locks; strict;
comment	@# @;


1.3
date	2008.12.22.15.54.38;	author sturm;	state dead;
branches;
next	1.2;

1.2
date	2005.02.21.21.36.07;	author sturm;	state Exp;
branches;
next	1.1;

1.1
date	2004.11.27.14.15.04;	author sturm;	state Exp;
branches
	1.1.2.1
	1.1.4.1;
next	;

1.1.2.1
date	2004.12.25.23.22.45;	author sturm;	state Exp;
branches;
next	;

1.1.4.1
date	2004.12.25.23.25.39;	author sturm;	state Exp;
branches;
next	;


desc
@@


1.3
log
@unlinked from builds more than 14 month ago, time to say goodbye
@
text
@$OpenBSD: patch-libs_xpdf_xpdf_Catalog_cc,v 1.2 2005/02/21 21:36:07 sturm Exp $
--- libs/xpdf/xpdf/Catalog.cc.orig	Thu Jan 22 02:26:45 2004
+++ libs/xpdf/xpdf/Catalog.cc	Thu Feb 10 22:18:02 2005
@@@@ -22,6 +22,7 @@@@
 #include "Error.h"
 #include "Link.h"
 #include "Catalog.h"
+#include <limits.h>
 
 //------------------------------------------------------------------------
 // Catalog
@@@@ -64,6 +65,12 @@@@ Catalog::Catalog(XRef *xrefA) {
   }
   pagesSize = numPages0 = (int)obj.getNum();
   obj.free();
+  if ((pagesSize >= INT_MAX / sizeof(Page *)) ||
+      (pagesSize >= INT_MAX / sizeof(Ref))) {
+    error(-1, "Invalid 'pagesSize'");
+    ok = gFalse;
+    return;
+  }
   pages = (Page **)gmalloc(pagesSize * sizeof(Page *));
   pageRefs = (Ref *)gmalloc(pagesSize * sizeof(Ref));
   for (i = 0; i < pagesSize; ++i) {
@@@@ -191,6 +198,11 @@@@ int Catalog::readPageTree(Dict *pagesDic
       }
       if (start >= pagesSize) {
 	pagesSize += 32;
+	if ((pagesSize >= INT_MAX/sizeof(Page *)) ||
+	    (pagesSize >= INT_MAX/sizeof(Ref))) {
+	  error(-1, "Invalid 'pagesSize' parameter.");
+	  goto err3;
+	}
 	pages = (Page **)grealloc(pages, pagesSize * sizeof(Page *));
 	pageRefs = (Ref *)grealloc(pageRefs, pagesSize * sizeof(Ref));
 	for (j = pagesSize - 32; j < pagesSize; ++j) {
@


1.2
log
@update to tetex-3.0, see included ChangeLog for details
the texmf-doc SUBPACKAGE is not distributed via ftp due to size constraints
@
text
@d1 1
a1 1
$OpenBSD: patch-libs_xpdf_xpdf_Catalog_cc,v 1.1 2004/11/27 14:15:04 sturm Exp $
@


1.1
log
@SECURITY FIX for CAN-2004-0888 (integer overflows in included xpdf)
bump PKGNAME

from freebsd
@
text
@d1 3
a3 3
$OpenBSD$
--- libs/xpdf/xpdf/Catalog.cc.orig	Sun Nov  3 23:15:36 2002
+++ libs/xpdf/xpdf/Catalog.cc	Sat Nov 27 14:51:17 2004
d12 1
a12 1
@@@@ -63,6 +64,12 @@@@ Catalog::Catalog(XRef *xrefA) {
d14 1
a14 1
   pagesSize = numPages0 = obj.getInt();
d25 1
a25 1
@@@@ -190,6 +197,11 @@@@ int Catalog::readPageTree(Dict *pagesDic
@


1.1.4.1
log
@pull in security fixes for included xpdf from -current
fixes CAN-2004-0888 and CAN-2004-1125
@
text
@d1 1
a1 1
$OpenBSD: patch-libs_xpdf_xpdf_Catalog_cc,v 1.1 2004/11/27 14:15:04 sturm Exp $
@


1.1.2.1
log
@pull in security fixes for included xpdf from -current
fixes CAN-2004-0888 and CAN-2004-1125
@
text
@d1 1
a1 1
$OpenBSD: patch-libs_xpdf_xpdf_Catalog_cc,v 1.1 2004/11/27 14:15:04 sturm Exp $
@

