head	1.1;
access;
symbols
	OPENBSD_6_1:1.1.0.60
	OPENBSD_6_1_BASE:1.1
	OPENBSD_6_0:1.1.0.58
	OPENBSD_6_0_BASE:1.1
	OPENBSD_5_9:1.1.0.54
	OPENBSD_5_9_BASE:1.1
	OPENBSD_5_8:1.1.0.56
	OPENBSD_5_8_BASE:1.1
	OPENBSD_5_7:1.1.0.52
	OPENBSD_5_7_BASE:1.1
	OPENBSD_5_6:1.1.0.50
	OPENBSD_5_6_BASE:1.1
	OPENBSD_5_5:1.1.0.48
	OPENBSD_5_5_BASE:1.1
	OPENBSD_5_4:1.1.0.46
	OPENBSD_5_4_BASE:1.1
	OPENBSD_5_3:1.1.0.44
	OPENBSD_5_3_BASE:1.1
	OPENBSD_5_2:1.1.0.42
	OPENBSD_5_2_BASE:1.1
	OPENBSD_5_1_BASE:1.1
	OPENBSD_5_1:1.1.0.40
	OPENBSD_5_0:1.1.0.38
	OPENBSD_5_0_BASE:1.1
	OPENBSD_4_9:1.1.0.36
	OPENBSD_4_9_BASE:1.1
	OPENBSD_4_8:1.1.0.34
	OPENBSD_4_8_BASE:1.1
	OPENBSD_4_7:1.1.0.32
	OPENBSD_4_7_BASE:1.1
	OPENBSD_4_6:1.1.0.30
	OPENBSD_4_6_BASE:1.1
	OPENBSD_4_5:1.1.0.28
	OPENBSD_4_5_BASE:1.1
	OPENBSD_4_4:1.1.0.26
	OPENBSD_4_4_BASE:1.1
	OPENBSD_4_3:1.1.0.24
	OPENBSD_4_3_BASE:1.1
	OPENBSD_4_2:1.1.0.22
	OPENBSD_4_2_BASE:1.1
	OPENBSD_4_1:1.1.0.20
	OPENBSD_4_1_BASE:1.1
	OPENBSD_4_0:1.1.0.18
	OPENBSD_4_0_BASE:1.1
	OPENBSD_3_9:1.1.0.16
	OPENBSD_3_9_BASE:1.1
	OPENBSD_3_8:1.1.0.14
	OPENBSD_3_8_BASE:1.1
	OPENBSD_3_7:1.1.0.12
	OPENBSD_3_7_BASE:1.1
	OPENBSD_3_6:1.1.0.10
	OPENBSD_3_6_BASE:1.1
	OPENBSD_3_5:1.1.0.8
	OPENBSD_3_5_BASE:1.1
	OPENBSD_3_4:1.1.0.6
	OPENBSD_3_4_BASE:1.1
	OPENBSD_3_3:1.1.0.4
	OPENBSD_3_3_BASE:1.1
	OPENBSD_3_2:1.1.0.2
	OPENBSD_3_2_BASE:1.1;
locks; strict;
comment	@# @;


1.1
date	2002.04.26.01.44.08;	author espie;	state Exp;
branches;
next	;


desc
@@


1.1
log
@brute-force fixing of ghostview for sparc64: add prototypes everywhere,
and don't pass abuse-cast int to XtPointer.

pval@@ says it works.
@
text
@$OpenBSD$
--- Ghostview.c.orig	Sat Jul 24 04:29:12 1993
+++ Ghostview.c	Fri Apr 26 02:49:35 2002
@@@@ -30,6 +30,9 @@@@
 #include <X11/Xos.h>
 #include "GhostviewP.h"
 #include <ctype.h>
+#include <stdlib.h>
+#include <sys/types.h>
+#include <sys/wait.h>
 
 #ifndef XlibSpecificationRelease
 typedef char *XPointer;
@@@@ -74,8 +77,8 @@@@ extern int errno;
 #define GV_BUFSIZ 1024
 #endif /* VMS */
 
-static void ComputeXdpi();
-static void ComputeYdpi();
+static void ComputeXdpi(Widget, int, XrmValue *);
+static void ComputeYdpi(Widget, int, XrmValue *);
 
 static XtResource resources[] = {
 #define offset(field) XtOffsetOf(GhostviewRec, ghostview.field)
@@@@ -131,27 +134,32 @@@@ static XtResource resources[] = {
 #undef offset
 };
 
-static void Message();
-static void Notify();
-static void Input();
-static void Output();
-
-static void ClassInitialize();
-static void ClassPartInitialize();
-static void Initialize();
-static void Realize();
-static void Destroy();
-static void Resize();
-static Boolean SetValues();
-static XtGeometryResult QueryGeometry();
-
-static void Layout();
-static Boolean ComputeSize();
-static void ChangeSize();
-static Boolean Setup();
-static void StartInterpreter();
-static void StopInterpreter();
-static void InterpreterFailed();
+static void Message(Widget, XEvent *, String *, Cardinal *);
+static void Notify(Widget, XEvent *, String *, Cardinal *);
+static void Input(XtPointer, int *, XtInputId *);
+static void Output(XtPointer, int *, XtInputId *);
+
+static void ClassInitialize(void);
+static void ClassPartInitialize(WidgetClass);
+static void Initialize(Widget, Widget, ArgList, Cardinal *);
+static void Realize(Widget, Mask *, XSetWindowAttributes *);
+static void Destroy(Widget);
+static void Resize(Widget);
+static Boolean SetValues(Widget, Widget, Widget);
+static XtGeometryResult QueryGeometry(Widget, XtWidgetGeometry *, XtWidgetGeometry *);
+
+static void Layout(Widget, Boolean, Boolean);
+static Boolean ComputeSize(Widget, Boolean, Boolean, Dimension *, Dimension *);
+static void ChangeSize(Widget, Dimension, Dimension);
+static Boolean Setup(Widget);
+static void StartInterpreter(Widget);
+static void StopInterpreter(Widget);
+static void InterpreterFailed(Widget);
+
+Boolean XmuCvtStringToPageOrientation(Display *, XrmValue *, Cardinal *,
+    XrmValue *, XrmValue *, XtPointer *);
+Boolean XmuCvtStringToPalette(Display *, XrmValue *, Cardinal *, 
+    XrmValue *, XrmValue *, XtPointer *);
 
 static XtActionsRec actions[] =
 {
@@@@ -1043,8 +1051,8 @@@@ Setup(w)
     gvw->ghostview.gs_width = gvw->core.width;
     gvw->ghostview.gs_height = gvw->core.height;
 
-    sprintf(buf, "%d %d %d %d %d %d %g %g %d %d %d %d",
-	    bpixmap, gvw->ghostview.orientation,
+    sprintf(buf, "%ld %d %d %d %d %d %g %g %d %d %d %d",
+	    (long)bpixmap, gvw->ghostview.orientation,
 	    gvw->ghostview.llx, gvw->ghostview.lly,
 	    gvw->ghostview.urx, gvw->ghostview.ury,
 	    gvw->ghostview.xdpi, gvw->ghostview.ydpi,
@@@@ -1055,11 +1063,11 @@@@ Setup(w)
 		   XA_STRING, 8, PropModeReplace,
 		   (unsigned char *)buf, strlen(buf));
 
-    sprintf(buf, "%s %d %d",
+    sprintf(buf, "%s %ld %ld",
 	    gvw->ghostview.palette == XtPaletteMonochrome ? "Monochrome" :
 	    gvw->ghostview.palette == XtPaletteGrayscale  ? "Grayscale" :
 	    gvw->ghostview.palette == XtPaletteColor      ? "Color" : "?",
-	    gvw->ghostview.foreground, gvw->core.background_pixel);
+	    (long)gvw->ghostview.foreground, (long)gvw->core.background_pixel);
     XChangeProperty(XtDisplay(w), XtWindow(w),
 		   XmuInternAtom(XtDisplay(w), gvc->ghostview_class.gv_colors),
 		   XA_STRING, 8, PropModeReplace,
@@@@ -1168,7 +1176,7 @@@@ StartInterpreter(w)
 	close(std_out[1]);
 	dup2(std_err[1], 2);
 	close(std_err[1]);
-	sprintf(buf, "%d", XtWindow(w));
+	sprintf(buf, "%ld", (long int)(XtWindow(w)));
 	setenv("GHOSTVIEW", buf, True);
 	setenv("DISPLAY", XDisplayString(XtDisplay(w)), True);
 	if (gvw->ghostview.filename == NULL) {
@
