head	1.53;
access;
symbols
	OPENBSD_6_2:1.53.0.2
	OPENBSD_6_2_BASE:1.53
	OPENBSD_6_1:1.47.0.2
	OPENBSD_6_1_BASE:1.47
	OPENBSD_6_0:1.46.0.4
	OPENBSD_6_0_BASE:1.46
	OPENBSD_5_9:1.46.0.2
	OPENBSD_5_9_BASE:1.46
	OPENBSD_5_8:1.45.0.4
	OPENBSD_5_8_BASE:1.45
	OPENBSD_5_7:1.41.0.2
	OPENBSD_5_7_BASE:1.41
	OPENBSD_5_6:1.39.0.2
	OPENBSD_5_6_BASE:1.39
	OPENBSD_5_5:1.38.0.2
	OPENBSD_5_5_BASE:1.38
	OPENBSD_5_4:1.34.0.2
	OPENBSD_5_4_BASE:1.34
	OPENBSD_5_3:1.24.0.2
	OPENBSD_5_3_BASE:1.24
	OPENBSD_5_2:1.21.0.2
	OPENBSD_5_2_BASE:1.21
	OPENBSD_5_1_BASE:1.19
	OPENBSD_5_1:1.19.0.2
	OPENBSD_5_0:1.14.0.2
	OPENBSD_5_0_BASE:1.14
	OPENBSD_4_9:1.13.0.2
	OPENBSD_4_9_BASE:1.13
	OPENBSD_4_8:1.9.0.2
	OPENBSD_4_8_BASE:1.9
	OPENBSD_4_7:1.6.0.2
	OPENBSD_4_7_BASE:1.6
	OPENBSD_4_6:1.4.0.2
	OPENBSD_4_6_BASE:1.4
	landry_20090317:1.1.1.1
	priteau:1.1.1;
locks; strict;
comment	@# @;


1.53
date	2017.07.26.22.45.20;	author sthen;	state Exp;
branches;
next	1.52;
commitid	tD4MFrpYYDDL2UFT;

1.52
date	2017.07.16.19.18.53;	author espie;	state Exp;
branches;
next	1.51;
commitid	tt0GhWK5c4uf9ILG;

1.51
date	2017.06.07.23.21.33;	author mlarkin;	state Exp;
branches;
next	1.50;
commitid	Ncz6MPSjOGbZ0IXB;

1.50
date	2017.04.24.07.52.21;	author jca;	state Exp;
branches;
next	1.49;
commitid	19Gu0CxhgBVBmJAF;

1.49
date	2017.04.20.09.29.49;	author fcambus;	state Exp;
branches;
next	1.48;
commitid	djQK9yV7MHJYbQNY;

1.48
date	2017.04.10.11.45.28;	author sthen;	state Exp;
branches;
next	1.47;
commitid	XDh1zlSBq0boKsHk;

1.47
date	2017.02.27.21.54.20;	author naddy;	state Exp;
branches;
next	1.46;
commitid	DRbLV9OSM4rIRby7;

1.46
date	2015.08.11.21.43.02;	author jasper;	state Exp;
branches;
next	1.45;
commitid	jJigjrb16bGNPG9W;

1.45
date	2015.05.02.18.22.23;	author bcallah;	state Exp;
branches;
next	1.44;
commitid	KPwO9PQpga9hS0Lu;

1.44
date	2015.04.20.15.38.25;	author sthen;	state Exp;
branches;
next	1.43;
commitid	klNaLwq6ltLFs3IY;

1.43
date	2015.04.19.16.22.20;	author bcallah;	state Exp;
branches;
next	1.42;
commitid	04zDQ1rmXWrqYogl;

1.42
date	2015.04.18.15.13.35;	author bcallah;	state Exp;
branches;
next	1.41;
commitid	IVgHV3Jyn4mkXHiG;

1.41
date	2014.12.01.15.13.52;	author naddy;	state Exp;
branches;
next	1.40;
commitid	NqwOhZjHdEm45gDR;

1.40
date	2014.08.10.09.58.05;	author espie;	state Exp;
branches;
next	1.39;
commitid	jyyOLTDxRdjpw44n;

1.39
date	2014.05.14.23.32.50;	author bcallah;	state Exp;
branches;
next	1.38;

1.38
date	2013.11.25.14.16.22;	author sthen;	state Exp;
branches;
next	1.37;

1.37
date	2013.09.29.19.36.09;	author bcallah;	state Exp;
branches;
next	1.36;

1.36
date	2013.09.27.17.49.03;	author ajacoutot;	state Exp;
branches;
next	1.35;

1.35
date	2013.08.07.03.40.24;	author bcallah;	state Exp;
branches;
next	1.34;

1.34
date	2013.06.15.23.52.05;	author bcallah;	state Exp;
branches;
next	1.33;

1.33
date	2013.06.15.00.00.24;	author bcallah;	state Exp;
branches;
next	1.32;

1.32
date	2013.05.27.10.47.20;	author bcallah;	state Exp;
branches;
next	1.31;

1.31
date	2013.05.08.14.46.10;	author sthen;	state Exp;
branches;
next	1.30;

1.30
date	2013.05.02.21.04.01;	author bcallah;	state Exp;
branches;
next	1.29;

1.29
date	2013.04.14.17.30.56;	author fgsch;	state Exp;
branches;
next	1.28;

1.28
date	2013.04.06.02.19.13;	author bcallah;	state Exp;
branches;
next	1.27;

1.27
date	2013.04.05.09.10.25;	author fgsch;	state Exp;
branches;
next	1.26;

1.26
date	2013.03.11.11.06.04;	author espie;	state Exp;
branches;
next	1.25;

1.25
date	2013.03.10.10.56.50;	author fgsch;	state Exp;
branches;
next	1.24;

1.24
date	2013.02.06.10.19.52;	author sthen;	state Exp;
branches;
next	1.23;

1.23
date	2013.02.06.09.08.29;	author sthen;	state Exp;
branches;
next	1.22;

1.22
date	2013.01.31.22.27.36;	author fgsch;	state Exp;
branches;
next	1.21;

1.21
date	2012.06.02.16.09.40;	author fgsch;	state Exp;
branches;
next	1.20;

1.20
date	2012.03.04.01.46.41;	author jsg;	state Exp;
branches;
next	1.19;

1.19
date	2011.12.20.06.56.12;	author fgsch;	state Exp;
branches;
next	1.18;

1.18
date	2011.11.27.12.42.28;	author fgsch;	state Exp;
branches;
next	1.17;

1.17
date	2011.11.16.17.42.26;	author naddy;	state Exp;
branches;
next	1.16;

1.16
date	2011.10.29.08.12.31;	author ajacoutot;	state Exp;
branches;
next	1.15;

1.15
date	2011.09.16.09.48.09;	author espie;	state Exp;
branches;
next	1.14;

1.14
date	2011.05.14.21.29.03;	author ajacoutot;	state Exp;
branches;
next	1.13;

1.13
date	2010.11.15.23.22.08;	author espie;	state Exp;
branches;
next	1.12;

1.12
date	2010.10.24.21.17.48;	author ajacoutot;	state Exp;
branches;
next	1.11;

1.11
date	2010.10.11.08.13.01;	author jasper;	state Exp;
branches;
next	1.10;

1.10
date	2010.09.05.15.18.49;	author landry;	state Exp;
branches;
next	1.9;

1.9
date	2010.05.09.17.45.12;	author jakemsr;	state Exp;
branches;
next	1.8;

1.8
date	2010.04.27.13.00.25;	author jasper;	state Exp;
branches;
next	1.7;

1.7
date	2010.04.24.13.54.32;	author jasper;	state Exp;
branches;
next	1.6;

1.6
date	2009.08.10.06.31.09;	author kili;	state Exp;
branches;
next	1.5;

1.5
date	2009.07.19.11.28.17;	author landry;	state Exp;
branches;
next	1.4;

1.4
date	2009.04.24.14.47.16;	author kurt;	state Exp;
branches;
next	1.3;

1.3
date	2009.04.09.22.44.41;	author ajacoutot;	state Exp;
branches;
next	1.2;

1.2
date	2009.03.18.20.23.11;	author landry;	state Exp;
branches;
next	1.1;

1.1
date	2009.03.17.19.55.09;	author landry;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2009.03.17.19.55.09;	author landry;	state Exp;
branches;
next	;


desc
@@


1.53
log
@bump LIBCXX/LIBECXX/COMPILER_LIBCXX ports.
@
text
@# $OpenBSD: Makefile,v 1.52 2017/07/16 19:18:53 espie Exp $

# Other archs have not been tested
ONLY_FOR_ARCHS =	amd64

USE_WXNEEDED=		Yes

# i386: src/emu/cpu/i386/pentops.inc: error: integer constant is too large for 'long' type

MULTI_PACKAGES =	-main -tools

COMMENT-main =		emulates a massive variety of arcades machines
COMMENT-tools =		tools to manipulate MAME/MESS roms and disk images

V =			160
DISTNAME =		mame0${V}s
PKGNAME-main =		sdlmame-0.${V}
PKGNAME-tools =		sdlmame-tools-0.${V}
REVISION =		4

CATEGORIES =		emulators games

HOMEPAGE =		http://mamedev.org/

# MAME Distribution License, see http://mamedev.org/legal.html
# history.dat : Creative Commons Attribution 3.0
PERMIT_PACKAGE_CDROM =	unclear license
PERMIT_PACKAGE_FTP =	unclear license
PERMIT_DISTFILES_FTP =	unclear license

WANTLIB += SDL SDL_ttf X11 Xinerama c expat fontconfig freetype
WANTLIB += m pthread ${COMPILER_LIBCXX} util z

MASTER_SITES =		https://github.com/mamedev/mame/releases/download/mame0${V}/
MASTER_SITES1 =		https://spacehopper.org/mirrors/

EXTRACT_SUFX =		.zip
DIST_SUBDIR =		mame

DISTFILES =		${DISTNAME}${EXTRACT_SUFX} \
			history${V}.zip:1

MODULES =		devel/gettext \
			lang/python

RUN_DEPENDS-main =	fonts/liberation-fonts
LIB_DEPENDS =		devel/sdl-ttf

MAKE_FLAGS =		OPT_FLAGS='-DINI_PATH="\"${SYSCONFDIR}/mame;\""'
MAKE_ENV =		ARCH=$(ARCH) CC=$(CC) CFLAGS="$(CFLAGS)" LD="${CXX}" \
			TARGETOS=openbsd \
			NO_USE_QTDEBUG=1 \
			NOWERROR=1 \
			SDL_LIBVER=sdl
.if ${MACHINE_ARCH} == "amd64"
MAKE_ENV +=		PTR64=1
.endif
USE_GMAKE =		Yes

CONFIGURE_STYLE =	none

MAKE_FILE =		makefile

NO_TEST =		Yes

post-extract:
	@@${UNZIP} -oq ${WRKDIR}/mame.zip -d ${WRKSRC}

pre-patch:
	@@sed -i 's|\r\n|\n|g' ${WRKDIST}/makefile \
	    ${WRKDIST}/src/emu/fileio.h \
	    ${WRKDIST}/src/emu/cpu/m68000/m68kmake.c \
	    ${WRKDIST}/src/emu/machine/netlist.h \
	    ${WRKDIST}/src/osd/sdl/sdl.mak
	@@ln -s ${MODPY_BIN} ${WRKDIR}/bin/python

pre-build:
	${SUBST_CMD} ${WRKDIST}/src/osd/sdl/sdl.mak

do-install:
	${INSTALL_PROGRAM} ${WRKSRC}/mame ${PREFIX}/bin/sdlmame
.for f in chdman jedutil ldresample ldverify romcmp unidasm
	${INSTALL_PROGRAM} ${WRKSRC}/${f} ${PREFIX}/bin
.endfor
	${INSTALL_DATA_DIR} ${PREFIX}/share/sdlmame/keymaps
	${INSTALL_DATA} ${WRKSRC}/src/osd/sdl/keymaps/km[-_]??.txt \
	    ${PREFIX}/share/sdlmame/keymaps/
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/sdlmame
.for f in config.txt hlsl.txt license.txt mame.txt newvideo.txt
	${INSTALL_DATA} ${WRKSRC}/docs/${f} ${PREFIX}/share/doc/sdlmame
.endfor
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/sdlmame
	${SUBST_DATA} ${FILESDIR}/mame.ini \
	    ${PREFIX}/share/examples/sdlmame/mame.ini
	${INSTALL_DATA} ${WRKDIR}/history.dat ${PREFIX}/share/sdlmame

.include <bsd.port.mk>
@


1.52
log
@use COMPILER_LIBCXX where applicable
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 2017/06/07 23:21:33 mlarkin Exp $
d19 1
a19 1
REVISION =		3
@


1.51
log
@sdlmame: this requires USE_WXNEEDED for various games

ok sthen
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2017/04/24 07:52:21 jca Exp $
d32 1
a32 1
WANTLIB += m pthread ${LIBCXX} util z
@


1.50
log
@Fix error checks (and clang builds while here)

ok fcambus@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2017/04/20 09:29:49 fcambus Exp $
d6 2
d19 1
a19 1
REVISION =		2
@


1.49
log
@Fix broken MASTER_SITES for emulators/sdlmame and emulators/sdlmess.

OK sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2017/04/10 11:45:28 sthen Exp $
d17 1
a17 1
REVISION =		1
@


1.48
log
@use LIBCXX
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2017/02/27 21:54:20 naddy Exp $
d32 2
a33 4
MASTER_SITES =		http://mamedev.org/downloader.php?file=releases/ \
			http://whiper.com/mame/${V}/
MASTER_SITES0 =		http://mamedev.org/updates/
MASTER_SITES1 = 	http://www.arcade-history.com/dats/
a37 1
# PATCHFILES doesn't work for .zip
@


1.47
log
@honor CXX for linking
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2015/08/11 21:43:02 jasper Exp $
d30 1
a30 1
WANTLIB += m pthread stdc++ util z
@


1.46
log
@use sed -i
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2015/05/02 18:22:23 bcallah Exp $
d51 1
a51 1
MAKE_ENV =		ARCH=$(ARCH) CC=$(CC) CFLAGS="$(CFLAGS)" \
@


1.45
log
@Drop maintainer of MAME and MESS and bump.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2015/04/20 15:38:25 sthen Exp $
d71 1
a71 1
	@@perl -pi -e 's|\r\n|\n|g' ${WRKDIST}/makefile \
@


1.44
log
@sdlmame fails on i386, lots of "integer constant is too large for 'long' type"
in src/emu/cpu/i386/pentops.inc
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2015/04/19 16:22:20 bcallah Exp $
d17 1
a17 1
REVISION =		0
a21 2

MAINTAINER =		Brian Callahan <bcallah@@openbsd.org>
@


1.43
log
@MAME in fact does need sdl-ttf. Caught when doing MESS update.
Sync WANTLIB after that change and bump.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2015/04/18 15:13:35 bcallah Exp $
d4 3
a6 1
ONLY_FOR_ARCHS =	amd64 i386
@


1.42
log
@Update MAME to 0.160.
License location change noticed by benoit@@
MAME is no longer offered as a package. There has been a bit of a license
mess and it's no longer clear if we can distribute anything. Sorry, if you
want MAME you'll have to build the port. Originally brought up by bentley@@
ok benoit@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2014/12/01 15:13:52 naddy Exp $
d15 1
d29 2
a30 1
WANTLIB += SDL X11 c m pthread stdc++ util z
d48 1
a48 1
LIB_DEPENDS =		devel/sdl
@


1.41
log
@fix overlapping memcpy; ok bcallah@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2014/08/10 09:58:05 espie Exp $
d11 1
a11 1
V =			153
d22 1
a22 1
# MAME Distribution License, see http://mamedev.org/license.html
d24 3
a26 2
PERMIT_PACKAGE_CDROM =		may not sell
PERMIT_PACKAGE_FTP =		Yes
d28 1
a28 2
WANTLIB += SDL SDL_ttf X11 Xinerama c expat fontconfig m pthread
WANTLIB += stdc++ util z
d46 1
a46 1
LIB_DEPENDS =		devel/sdl-ttf
d52 2
a53 1
			NOWERROR=1
a68 3
#.for v in 1
#	${PATCH} ${PATCH_DIST_ARGS} < ${WRKDIR}/0${V}u${v}.diff
#.endfor
@


1.40
log
@use more specific version of SUBST_* where appropriate
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2014/05/14 23:32:50 bcallah Exp $
d73 1
@


1.39
log
@Update MAME to 0.153
"move along" landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2013/11/25 14:16:22 sthen Exp $
d93 1
a93 1
	${SUBST_CMD} -o ${SHAREOWN} -g ${SHAREGRP} -c ${FILESDIR}/mame.ini \
@


1.38
log
@kill VMEM_WARNING
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2013/09/29 19:36:09 bcallah Exp $
d11 1
a11 1
V =			150
d27 2
a28 5
WANTLIB =	SDL SDL_ttf X11 Xcomposite Xcursor Xdamage Xext Xfixes \
		Xi Xinerama Xrandr Xrender atk-1.0 c cairo expat fontconfig \
		freetype gconf-2 gdk-x11-2.0 gdk_pixbuf-2.0 gio-2.0 \
		glib-2.0 gobject-2.0 gtk-x11-2.0 m pango-1.0 pangocairo-1.0 \
		pangoft2-1.0 pthread stdc++ util z
d46 1
a46 3
LIB_DEPENDS =		devel/gconf2 \
			devel/sdl-ttf \
			x11/gtk+2
@


1.37
log
@Update to MAME 0.150.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2013/09/27 17:49:03 ajacoutot Exp $
a67 1
VMEM_WARNING =		Yes
@


1.36
log
@Bump after devel/gconf2,-main is gone.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2013/08/07 03:40:24 bcallah Exp $
d11 1
a11 1
V =			149
d13 2
a14 5
PKGNAME-main =		sdlmame-0.${V}pl1
PKGNAME-tools =		sdlmame-tools-0.${V}pl1

REVISION-main=	0
REVISION-tools=	0
d43 1
a43 2
			0${V}u1_diff.zip:0 \
			history${V}a.zip:1
d74 3
a76 3
.for v in 1
	${PATCH} ${PATCH_DIST_ARGS} < ${WRKDIR}/0${V}u${v}.diff
.endfor
@


1.35
log
@Update MAME to 0.149u1.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2013/06/15 23:52:05 bcallah Exp $
d15 3
@


1.34
log
@Something changed in the mame .zip between when I updated and when I
committed. regen distinfo. Bump REVISIONs.
noted by naddy@@ and rfreeman@@
ok rfreeman@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2013/06/15 00:00:24 bcallah Exp $
d13 2
a14 4
PKGNAME-main =		sdlmame-0.${V}
PKGNAME-tools =		sdlmame-tools-0.${V}
REVISION-main =		0
REVISION-tools =	0
d43 2
a44 1
			history${V}.zip:1
d75 3
a77 3
#.for v in 1
#	${PATCH} ${PATCH_DIST_ARGS} < ${WRKDIR}/0${V}u${v}.diff
#.endfor
@


1.33
log
@Update emulators/sdlmame to 0149
Like sdlmess, landry@@ read ok'd a diff, and then I remembered to regen
patches (eliminate fuzz)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2013/05/27 10:47:20 bcallah Exp $
d15 2
@


1.32
log
@Update emulators/sdlmame to 0.148u5
Tested by rfreeman@@
ok sthen@@ rfreeman@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2013/05/08 14:46:10 sthen Exp $
d11 1
a11 1
V =			148
d13 2
a14 2
PKGNAME-main =		sdlmame-0.${V}pl5
PKGNAME-tools =		sdlmame-tools-0.${V}pl5
d43 1
a43 6
			0${V}u1_diff.zip:0 \
			0${V}u2_diff.zip:0 \
			0${V}u3_diff.zip:0 \
			0${V}u4_diff.zip:0 \
			0${V}u5_diff.zip:0 \
			history${V}i.zip:1
d74 3
a76 3
.for v in 1 2 3 4 5
	${PATCH} ${PATCH_DIST_ARGS} < ${WRKDIR}/0${V}u${v}.diff
.endfor
@


1.31
log
@use ${SUBST_CMD} -c -o ${SHAREOWN} -g ${SHAREGRP} instead of two-step
process with SUBST_CMD / chown.  ok bcallah@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2013/05/02 21:04:01 bcallah Exp $
d13 2
a14 2
PKGNAME-main =		sdlmame-0.${V}pl4
PKGNAME-tools =		sdlmame-tools-0.${V}pl4
d47 1
d79 1
a79 1
.for v in 1 2 3 4
@


1.30
log
@Update emulators/sdlmame to 0.148u4
Makefile tweaks courtesy of sthen@@
ok fgsch@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2013/04/14 17:30:56 fgsch Exp $
d103 1
a103 3
	${SUBST_CMD} -c ${FILESDIR}/mame.ini \
	    ${PREFIX}/share/examples/sdlmame/mame.ini
	chown ${SHAREOWN}:${SHAREGRP} \
@


1.29
log
@Update to sdlmame 0.148u3.
ok bcallah who takes over maintainership ;-)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2013/04/06 02:19:13 bcallah Exp $
d11 4
a14 4
V =			0148
DISTNAME =		mame${V}s
PKGNAME-main =		sdlmame-${V:S/0/0./}pl3
PKGNAME-tools =		sdlmame-tools-${V:S/0/0./}pl3
d34 1
a34 1
			http://whiper.com/mame/${V:S/0//}/
d43 5
a47 4
			${V}u1_diff.zip:0 \
			${V}u2_diff.zip:0 \
			${V}u3_diff.zip:0 \
			history${V:S/0//}h.zip:1
d78 2
a79 2
.for v in 1 2 3
	${PATCH} ${PATCH_DIST_ARGS} < ${WRKDIR}/${V}u${v}.diff
@


1.28
log
@Make sure to apply the u2 patch from the recent update.
Explicitly disable the new Qt-based debugger.
Bump REVISION.
Discussed with and ok fgsch@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2013/04/05 09:10:25 fgsch Exp $
d13 2
a14 3
PKGNAME-main =		sdlmame-${V:S/0/0./}pl2
PKGNAME-tools =		sdlmame-tools-${V:S/0/0./}pl2
REVISION =		0
d20 1
a20 1
MAINTAINER =		Federico G. Schwindt <fgsch@@openbsd.org>
d45 2
a46 1
			history${V:S/0//}g.zip:1
d77 1
a77 1
.for v in 1 2
@


1.27
log
@Update to sdlmame 0.148u2.
bcallah@@ ok.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2013/03/11 11:06:04 espie Exp $
d15 1
d58 3
a60 1
			TARGETOS=openbsd
d77 1
a77 1
.for v in 1
@


1.26
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2013/03/10 10:56:50 fgsch Exp $
d13 2
a14 2
PKGNAME-main =		sdlmame-${V:S/0/0./}pl1
PKGNAME-tools =		sdlmame-tools-${V:S/0/0./}pl1
d27 5
a31 6
WANTLIB =	SDL SDL_ttf X11 Xcomposite Xcursor Xdamage Xext \
		Xfixes Xi Xinerama Xrandr Xrender atk-1.0 c cairo expat \
		fontconfig freetype gconf-2 gdk-x11-2.0 gdk_pixbuf-2.0 \
		gio-2.0 glib-2.0 gobject-2.0 gtk-x11-2.0 m pango-1.0 \
		pangocairo-1.0 pangoft2-1.0 pixman-1 png pthread \
		pthread-stubs stdc++ util xcb xcb-render xcb-shm z
d44 2
a45 1
			history${V:S/0//}e.zip:1
@


1.25
log
@update to sdlmame 0.148u1.
bcallah@@ ok.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2013/02/06 10:19:52 sthen Exp $
a25 1
PERMIT_DISTFILES_FTP =		Yes
d67 1
a67 1
NO_REGRESS =		Yes
@


1.24
log
@do the python symlink in pre-patch rather than pre-build; this way the build
still stops if it fails, but doesn't cause a problem with restarting builds.
suggested by/ok fgsch"
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2013/02/06 09:08:29 sthen Exp $
d13 2
a14 2
PKGNAME-main =		sdlmame-${V:S/0/0./}
PKGNAME-tools =		sdlmame-tools-${V:S/0/0./}
a25 1
PERMIT_DISTFILES_CDROM =	may not sell
d45 1
d75 3
a77 3
#.for v in 1 2 3
#	${PATCH} ${PATCH_DIST_ARGS} < ${WRKDIR}/${V}u${v}.diff
#.endfor
@


1.23
log
@allow ln -s in pre-build to fail; lets interrupted builds be resumed.
ok fgsch@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2013/01/31 22:27:36 fgsch Exp $
d82 1
a84 1
	-@@ln -s ${MODPY_BIN} ${WRKDIR}/bin/python
@


1.22
log
@Update to sdlmame 0.148.
With help and comments from dcoppa@@ and benoit@@.
Please note this requires a kernel with the MAXTSIZ bump committed earlier.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2012/06/02 16:09:40 fgsch Exp $
d84 1
a84 1
	@@ln -s ${MODPY_BIN} ${WRKDIR}/bin/python
@


1.21
log
@Update to sdlmame 0.146.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2012/03/04 01:46:41 jsg Exp $
d11 1
a11 1
V =			0146
d20 2
d29 1
a29 1
WANTLIB =	GL SDL SDL_ttf X11 Xcomposite Xcursor Xdamage Xext \
d36 2
a37 1
MASTER_SITES =		http://mamedev.org/downloader.php?file=releases/
d46 1
a46 1
			mamehistory${V:S/0//}.zip:1
d48 2
a49 1
MODULES =		devel/gettext
d64 2
d79 7
a85 1
	    ${WRKDIST}/src/emu/fileio.h
@


1.20
log
@update to 0.145u3
ok fgsch@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2011/12/20 06:56:12 fgsch Exp $
d11 1
a11 1
V =			0145
d13 2
a14 2
PKGNAME-main =		sdlmame-${V:S/0/0./}pl3
PKGNAME-tools =		sdlmame-tools-${V:S/0/0./}pl3
d30 3
a32 4
		gio-2.0 glib-2.0 gmodule-2.0 gobject-2.0 gthread-2.0 \
		gtk-x11-2.0 m pango-1.0 pangocairo-1.0 pangoft2-1.0 \
		pixman-1 png pthread pthread-stubs stdc++ util xcb \
		xcb-render xcb-shm z
a42 3
			${V}u1_diff.zip:0 \
			${V}u2_diff.zip:0 \
			${V}u3_diff.zip:0 \
d69 3
a71 3
.for v in 1 2 3
	${PATCH} ${PATCH_DIST_ARGS} < ${WRKDIR}/${V}u${v}.diff
.endfor
@


1.19
log
@Update to sdlmame 0.144u3.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2011/11/27 12:42:28 fgsch Exp $
d11 1
a11 1
V =			0144
d77 1
a77 2
	    ${WRKDIST}/src/emu/fileio.h \
	    ${WRKDIST}/src/mame/video/mcd212.c
@


1.18
log
@Update to sdlmame 0.144.
with input from sthen@@. previous updates tested by edd@@.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2011/11/16 17:42:26 naddy Exp $
d13 2
a14 2
PKGNAME-main =		sdlmame-${V:S/0/0./}
PKGNAME-tools =		sdlmame-tools-${V:S/0/0./}
a26 2
MODULES =	devel/gettext

d42 1
d44 3
d49 3
a51 1
BUILD_DEPENDS = 	archivers/unzip
a54 1
RUN_DEPENDS-main =	fonts/liberation-fonts
d73 3
a77 1
	    ${WRKDIST}/src/osd/sdl/sdlos_unix.c \
d82 1
a82 1
.for f in chdman jedutil ldresample ldverify romcmp
@


1.17
log
@it's MODULES, not MODULE
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2011/10/29 08:12:31 ajacoutot Exp $
d11 4
a14 6
V =			0.132
DISTNAME =		sdlmame${V:S/.//}
PKGNAME-main =		sdlmame-${V}
REVISION-main =		9
PKGNAME-tools =		sdlmame-tools-${V}
REVISION-tools =	7
d18 1
a18 3
HOMEPAGE =		http://rbelmont.mameworld.info/?page_id=163

MAINTAINER =		Pierre Riteau <pierre.riteau@@gmail.com>
d29 11
a39 7
WANTLIB +=	X11 Xau Xcomposite Xcursor Xdamage Xdmcp Xext
WANTLIB +=	Xfixes Xi Xinerama Xrandr Xrender xcb-render xcb-shm
WANTLIB +=	GL atk-1.0 c cairo dbus-1
WANTLIB +=	expat fontconfig freetype gio-2.0 glib-2.0 gmodule-2.0
WANTLIB +=	gobject-2.0 gthread-2.0 m pango-1.0 pangocairo-1.0
WANTLIB +=	pangoft2-1.0 pixman-1 png pthread pthread-stubs xcb z
WANTLIB +=	SDL gconf-2 gdk-x11-2.0 gdk_pixbuf-2.0 gtk-x11-2.0
a40 1
MASTER_SITES =		http://rbelmont.mameworld.info/
d42 1
d44 2
a45 3
MASTER_SITES0 = 	http://www.arcade-history.com/dats/
DISTFILES+=		${DISTNAME}${EXTRACT_SUFX} \
			mamehistory137.zip:0
d48 2
a49 2
LIB_DEPENDS =		devel/sdl \
			devel/gconf2 \
d51 1
a51 1
RUN_DEPENDS-main =	${PKGNAME-tools}:emulators/sdlmame,-tools
d53 6
d61 2
d66 2
a67 10
MAKE_FLAGS =		OPT_FLAGS='-DINI_PATH="\"${SYSCONFDIR}/mame;\""'
MAKE_ENV =		ARCH=$(ARCH) CC=$(CC) CFLAGS="$(CFLAGS)" LD=$(CC) \
			TARGETOS=openbsd
.if ${MACHINE_ARCH} == "amd64"
MAKE_ENV+=		PTR64=1
# XXX -Wno-system-headers is needed because of inclusion of *mmintrin.h from gcc
# those headers don't compile with -Wsystem-headers -Werror on amd64
MAKE_FLAGS =		OPT_FLAGS='-DINI_PATH="\"${SYSCONFDIR}/mame;\"" -Wno-system-headers'
.endif
MAKE_FILE =		makefile
d69 5
a73 3
MAME_EXTBIN =		chdman jedutil ldresample ldverify romcmp
MAME_DOC =		config.txt license.txt mame.txt newvideo.txt
MAME_DATA_DIR =		roms samples artwork ctrlr cheat keymaps
d77 2
a78 5
.for i in ${MAME_EXTBIN}
	${INSTALL_PROGRAM} ${WRKSRC}/${i} ${PREFIX}/bin/${i}
.endfor
.for i in ${MAME_DATA_DIR}
	${INSTALL_DATA_DIR} ${PREFIX}/share/sdlmame/${i}
d80 3
a82 3
	${INSTALL_DATA} ${WRKSRC}/keymaps/km[-_]??.txt \
		${PREFIX}/share/sdlmame/keymaps/
	${INSTALL_DATA} ${WRKSRC}/ui.bdf ${PREFIX}/share/sdlmame
d84 2
a85 2
.for i in ${MAME_DOC}
	${INSTALL_DATA} ${WRKSRC}/docs/${i} ${PREFIX}/share/doc/sdlmame/
a86 1
	${INSTALL_DATA} $(WRKSRC)/SDLMAME.txt ${PREFIX}/share/doc/sdlmame/
d89 1
a89 1
		${PREFIX}/share/examples/sdlmame/mame.ini
d91 1
a91 1
		${PREFIX}/share/examples/sdlmame/mame.ini
@


1.16
log
@Sync dependencies after gconf2 lost its dependency to ORBit.
This should cover all fallout but there may be some dark corners which I
missed...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2011/09/16 09:48:09 espie Exp $
d14 1
a14 1
REVISION-main =		8
d16 1
a16 1
REVISION-tools =	6
d31 1
a31 1
MODULE =	devel/gettext
d34 2
a35 1
WANTLIB +=	Xfixes Xi Xinerama Xrandr Xrender atk-1.0 c cairo dbus-1
@


1.15
log
@normalize pkgpath
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2011/05/14 21:29:03 ajacoutot Exp $
d14 1
a14 1
REVISION-main =		7
d16 1
a16 1
REVISION-tools =	5
d33 1
a33 1
WANTLIB +=	ORBit-2 X11 Xau Xcomposite Xcursor Xdamage Xdmcp Xext
@


1.14
log
@deve/gconf2 is about to loose its dependency on x11/gtk+2 so explicitely
register x11/gtk+2 for ports depending on gconf2 that don't have another
dependency that would bring it.

discussed with jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2010/11/15 23:22:08 espie Exp $
d14 1
a14 1
REVISION-main =		6
d16 1
a16 1
REVISION-tools =	4
@


1.13
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2010/10/24 21:17:48 ajacoutot Exp $
d14 1
a14 1
REVISION-main =		5
d16 1
a16 1
REVISION-tools =	3
d31 2
d36 1
a36 1
WANTLIB +=	gobject-2.0 gthread-2.0 iconv intl m pango-1.0 pangocairo-1.0
d49 2
a50 1
			devel/gconf2
@


1.12
log
@Remove USE_X11.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2010/10/11 08:13:01 jasper Exp $
d45 4
a48 4
BUILD_DEPENDS = 	::archivers/unzip
LIB_DEPENDS =		::devel/sdl \
			::devel/gconf2
RUN_DEPENDS-main =	:${PKGNAME-tools}:emulators/sdlmame,-tools
@


1.11
log
@- fix WANTLIB after cairo update.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2010/09/05 15:18:49 landry Exp $
a50 1
USE_X11 =		Yes
@


1.10
log
@Unbreak on amd64 by adding -Wno-system-headers to OPT_FLAGS.
sdlmame includes *mmintrin.h headers from gcc which can't be compiled
with -Wsystem-headers (now system default) -Werror (set by the port).

While here remove useless gcc4 MODULES stanzas (port is only for
i386/amd64), switch to newer WANTLIB/LIB_DEPENDS/REVISION idioms.

with tweaks from ajacoutot@@, ok ajacoutot@@ & MAINTAINER.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2010/05/09 17:45:12 jakemsr Exp $
d14 1
a14 1
REVISION-main =		4
d16 1
a16 1
REVISION-tools =	2
d33 1
a33 1
WANTLIB +=	expat fontconfig freetype gio-2.0 glib-2.0 glitz gmodule-2.0
@


1.9
log
@sdl{mame,mess} supercede x{mame,mess}
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2010/04/27 13:00:25 jasper Exp $
d13 4
a16 2
PKGNAME-main =		sdlmame-${V}p3
PKGNAME-tools =		sdlmame-tools-${V}p1
d36 1
a44 4
MODULES =		gcc4
MODGCC4_ARCHES =	*
MODGCC4_LANGS =		c

d46 2
a47 2
LIB_DEPENDS =		SDL::devel/sdl gconf-2.>=5::devel/gconf2 \
			gdk-x11-2.0.>=0.11,gdk_pixbuf-2.0.>=0.11,gtk-x11-2.0.>=0.11::x11/gtk+2
d61 3
@


1.8
log
@- install a history.dat file

ok MAINTAINER
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2010/04/24 13:54:32 jasper Exp $
d13 1
a13 1
PKGNAME-main =		sdlmame-${V}p2
@


1.7
log
@- unbreak with recent gtk+2 update
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2009/08/10 06:31:09 kili Exp $
d13 1
a13 1
PKGNAME-main =		sdlmame-${V}p1
d23 1
d38 4
d46 1
d90 1
@


1.6
log
@WANTLIB changes after xcb addition and bump.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2009/07/19 11:28:17 landry Exp $
d13 2
a14 2
PKGNAME-main =		sdlmame-${V}p0
PKGNAME-tools =		sdlmame-tools-${V}p0
@


1.5
log
@Update to sdlmame 0.132, from MAINTAINER Pierre Riteau. Patches merged
upstream.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2009/04/24 14:47:16 kurt Exp $
d13 2
a14 2
PKGNAME-main =		sdlmame-${V}
PKGNAME-tools =		sdlmame-tools-${V}
d32 1
a32 1
WANTLIB +=	pangoft2-1.0 pixman-1 png pthread z
@


1.4
log
@Fix typo in MODGCC4_LANGS. No change in packages so no bumps.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2009/04/09 22:44:41 ajacoutot Exp $
d11 1
a11 1
V =			0.130
d13 2
a14 2
PKGNAME-main =		sdlmame-${V}p1
PKGNAME-tools =		sdlmame-tools-${V}p0
@


1.3
log
@- install a default mame.ini configuration file under SYSCONFDIR/mame/
- install ui.bdf to get better fonts

original diff from me, heavily modified and enhanced by Pierre Riteau
(maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2009/03/18 20:23:11 landry Exp $
d39 1
a39 1
MODGCC4_LANG =		c
@


1.2
log
@Add appropriate conflict markers between sdlmame, sdlmess, and the
various flavours of the xmame/xmess/xmame+xmess multipackages.
Tweak ${V} handling and sdlmame RUN_DEPENDS.
Diff from Pierre Riteau, thx!
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2009/03/17 19:55:09 landry Exp $
d13 1
a13 1
PKGNAME-main =		sdlmame-${V}p0
d51 1
d61 1
d68 3
a70 1
	${INSTALL_DATA_DIR} ${PREFIX}/share/sdlmame/keymaps
d73 1
d79 5
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d11 4
a14 4
V =			130
DISTNAME =		sdlmame0${V}
PKGNAME-main =		sdlmame-0.${V}
PKGNAME-tools =		sdlmame-tools-0.${V}
d43 1
a43 1
RUN_DEPENDS-main =	:sdlmame-tools-0.${V}:emulators/sdlmame,-tools
@


1.1.1.1
log
@Import sdlmame 0.130 :
MAME stands for Multi Arcade Machine Emulator. As the name suggests, it
is a program that emulates the hardware (and low-level firmware) of a
massive variety of arcade machines.
SDLMAME is a port of MAME using the SDL library.

After many submissions and updates by Pierre Riteau (at gmail), thanks!
@
text
@@
