head	1.2;
access;
symbols
	OPENBSD_5_9:1.1.0.6
	OPENBSD_5_9_BASE:1.1
	OPENBSD_5_7:1.1.0.4
	OPENBSD_5_8:1.1.0.2;
locks; strict;
comment	@# @;


1.2
date	2016.03.14.19.46.12;	author ajacoutot;	state dead;
branches;
next	1.1;
commitid	ZypCecrzOxeE8g1E;

1.1
date	2015.09.16.07.08.41;	author ajacoutot;	state Exp;
branches
	1.1.2.1
	1.1.4.1;
next	;
commitid	HnAiLDQKaBryPwya;

1.1.2.1
date	2015.09.16.07.28.43;	author jasper;	state Exp;
branches;
next	;
commitid	YFDteHqI7C3ii7OT;

1.1.4.1
date	2015.09.16.07.29.24;	author jasper;	state Exp;
branches;
next	;
commitid	ReftfG7QJl8FYlWa;


desc
@@


1.2
log
@Major update to qemu-2.5.0.
Please direct any runtime fallout to Brad.

from Brad (maintainer)
@
text
@$OpenBSD: patch-hw_char_virtio-serial-bus_c,v 1.1 2015/09/16 07:08:41 ajacoutot Exp $

virtio-serial: fix ANY_LAYOUT

Don't assume a specific layout for control messages.
Required by virtio 1.

--- hw/char/virtio-serial-bus.c.orig	Tue Sep 15 01:03:13 2015
+++ hw/char/virtio-serial-bus.c	Tue Sep 15 01:04:01 2015
@@@@ -194,7 +194,8 @@@@ static size_t send_control_msg(VirtIOSerial *vser, voi
         return 0;
     }
 
-    memcpy(elem.in_sg[0].iov_base, buf, len);
+    /* TODO: detect a buffer that's too short, set NEEDS_RESET */
+    iov_from_buf(elem.in_sg, elem.in_num, 0, buf, len);
 
     virtqueue_push(vq, &elem, len);
     virtio_notify(VIRTIO_DEVICE(vser), vq);
@


1.1
log
@SECURITY: CVE-2015-5745
virtio-serial: fix ANY_LAYOUT
Don't assume a specific layout for control messages.
Required by virtio 1.

from Brad (maintainer)
@
text
@d1 1
a1 1
$OpenBSD$
@


1.1.4.1
log
@Security fix for CVE-2015-5745, qemu buffer overflow in virtio-serial
@
text
@d1 1
a1 1
$OpenBSD: patch-hw_char_virtio-serial-bus_c,v 1.1 2015/09/16 07:08:41 ajacoutot Exp $
@


1.1.2.1
log
@Security fix for CVE-2015-5745, qemu buffer overflow in virtio-serial
@
text
@d1 1
a1 1
$OpenBSD: patch-hw_char_virtio-serial-bus_c,v 1.1 2015/09/16 07:08:41 ajacoutot Exp $
@

