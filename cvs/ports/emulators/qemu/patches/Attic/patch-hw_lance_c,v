head	1.2;
access;
symbols
	OPENBSD_3_9:1.1.0.2
	OPENBSD_3_9_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2006.06.08.14.33.38;	author todd;	state dead;
branches;
next	1.1;

1.1
date	2006.02.08.13.44.17;	author todd;	state Exp;
branches;
next	;


desc
@@


1.2
log
@update to 0.8.1, see http://qemu.org/changelog.html for details
@
text
@$OpenBSD: patch-hw_lance_c,v 1.1 2006/02/08 13:44:17 todd Exp $
--- hw/lance.c.orig	Mon Dec 19 17:51:53 2005
+++ hw/lance.c	Sat Jan 28 22:10:33 2006
@@@@ -283,6 +283,11 @@@@ static CPUWriteMemoryFunc *lance_mem_wri
 
 #define MIN_BUF_SIZE 60
 
+static void lance_can_receive(void *opaque)
+{
+    return 1;
+}
+
 static void lance_receive(void *opaque, const uint8_t *buf, int size)
 {
     LANCEState *s = opaque;
@@@@ -440,7 +445,7 @@@@ void lance_init(NICInfo *nd, int irq, ui
 
     lance_reset(s);
 
-    s->vc = qemu_new_vlan_client(nd->vlan, lance_receive, s);
+    s->vc = qemu_new_vlan_client(nd->vlan, lance_receive, lance_can_receive, s);
 
     snprintf(s->vc->info_str, sizeof(s->vc->info_str),
              "lance macaddr=%02x:%02x:%02x:%02x:%02x:%02x",
@


1.1
log
@o from the qemu mailing list, prompted by brad@@, improve userland
  networking througput since otherwise the emulated NICs didn't
  have a way of indicating the receive queue is full and would
  drop packets.
o bump PKGNAME
o inttypes.h made irrelevent a few chunks of patches, so use it instead
@
text
@d1 1
a1 1
$OpenBSD$
@

