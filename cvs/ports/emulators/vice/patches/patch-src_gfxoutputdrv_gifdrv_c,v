head	1.1;
branch	1.1.1;
access;
symbols
	OPENBSD_6_0:1.1.1.1.0.4
	OPENBSD_6_0_BASE:1.1.1.1
	OPENBSD_5_9:1.1.1.1.0.2
	OPENBSD_5_9_BASE:1.1.1.1
	bentley_20150820:1.1.1.1
	bentley:1.1.1;
locks; strict;
comment	@# @;


1.1
date	2015.08.20.07.50.30;	author bentley;	state Exp;
branches
	1.1.1.1;
next	;
commitid	nEQD8y9a3XINtXav;

1.1.1.1
date	2015.08.20.07.50.30;	author bentley;	state Exp;
branches;
next	;
commitid	nEQD8y9a3XINtXav;


desc
@@



1.1
log
@Initial revision
@
text
@$OpenBSD$
Account for changed API in giflib 5.x.
--- src/gfxoutputdrv/gifdrv.c.orig	Thu Jul 30 01:16:31 2015
+++ src/gfxoutputdrv/gifdrv.c	Thu Jul 30 01:16:55 2015
@@@@ -114,7 +114,7 @@@@ static int gifdrv_open(screenshot_t *screenshot, const
   if (EGifPutScreenDesc(sdata->fd, screenshot->width, screenshot->height, 8, 0, gif_colors) == GIF_ERROR ||
       EGifPutImageDesc(sdata->fd, 0, 0, screenshot->width, screenshot->height, 0, NULL) == GIF_ERROR)
   {
-    EGifCloseFile(sdata->fd);
+    EGifCloseFile(sdata->fd, NULL);
     VICE_FreeMapObject(gif_colors);
     lib_free(sdata->data);
     lib_free(sdata->ext_filename);
@@@@ -145,7 +145,7 @@@@ static int gifdrv_close(screenshot_t *screenshot)
 
     sdata = screenshot->gfxoutputdrv_data;
 
-    EGifCloseFile(sdata->fd);
+    EGifCloseFile(sdata->fd, NULL);
     VICE_FreeMapObject(gif_colors);
 
     /* for some reason giflib will create a file with unexpected
@@@@ -184,7 +184,7 @@@@ static char *gifdrv_memmap_ext_filename;
 
 static int gifdrv_close_memmap(void)
 {
-  EGifCloseFile(gifdrv_memmap_fd);
+  EGifCloseFile(gifdrv_memmap_fd, NULL);
   VICE_FreeMapObject(gif_colors);
   lib_free(gifdrv_memmap_ext_filename);
 
@@@@ -231,7 +231,7 @@@@ static int gifdrv_open_memmap(const char *filename, in
   if (EGifPutScreenDesc(gifdrv_memmap_fd, x_size, y_size, 8, 0, gif_colors) == GIF_ERROR ||
       EGifPutImageDesc(gifdrv_memmap_fd, 0, 0, x_size, y_size, 0, NULL) == GIF_ERROR)
   {
-    EGifCloseFile(gifdrv_memmap_fd);
+    EGifCloseFile(gifdrv_memmap_fd, NULL);
     VICE_FreeMapObject(gif_colors);
     lib_free(gifdrv_memmap_ext_filename);
     return -1;
@


1.1.1.1
log
@Import vice-2.4.

VICE is a multi-platform C64, C128, VIC20, PET, PLUS4 and CBM-II
emulator.

ok jasper@@
@
text
@@
