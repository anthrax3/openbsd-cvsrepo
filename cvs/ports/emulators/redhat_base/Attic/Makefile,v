head	1.13;
access;
symbols
	OPENBSD_2_9_TRACKING_SWITCH:1.12
	OPENBSD_2_9:1.6.0.2
	OPENBSD_2_9_BASE:1.6
	jasoni_2001-02-13:1.1.1.1
	jasoni:1.1.1;
locks; strict;
comment	@# @;


1.13
date	2001.09.16.17.14.10;	author naddy;	state dead;
branches;
next	1.12;

1.12
date	2001.07.13.11.24.09;	author naddy;	state Exp;
branches;
next	1.11;

1.11
date	2001.07.11.00.34.02;	author brad;	state Exp;
branches;
next	1.10;

1.10
date	2001.06.05.21.31.20;	author jasoni;	state Exp;
branches;
next	1.9;

1.9
date	2001.06.05.20.51.30;	author jasoni;	state Exp;
branches;
next	1.8;

1.8
date	2001.05.15.20.18.31;	author naddy;	state Exp;
branches;
next	1.7;

1.7
date	2001.05.08.21.32.48;	author jasoni;	state Exp;
branches;
next	1.6;

1.6
date	2001.04.09.03.53.44;	author jasoni;	state Exp;
branches;
next	1.5;

1.5
date	2001.04.05.06.05.35;	author jasoni;	state Exp;
branches;
next	1.4;

1.4
date	2001.04.01.04.17.13;	author brad;	state Exp;
branches;
next	1.3;

1.3
date	2001.03.26.03.55.40;	author jasoni;	state Exp;
branches;
next	1.2;

1.2
date	2001.02.17.00.00.38;	author jasoni;	state Exp;
branches;
next	1.1;

1.1
date	2001.02.13.06.06.22;	author jasoni;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2001.02.13.06.06.22;	author jasoni;	state Exp;
branches;
next	;


desc
@@


1.13
log
@Moved to emulators/redhat/base.
@
text
@# $OpenBSD: Makefile,v 1.12 2001/07/13 11:24:09 naddy Exp $

ONLY_FOR_ARCHS=	i386

COMMENT=	"Linux compatibility package based on RedHat 6.2"

PKGNAME=	redhat_base-6.2p2
CATEGORIES=	emulators
NEED_VERSION=	1.413
MASTER_SITES=	ftp://ftp.redhat.com/pub/redhat/linux/%SUBDIR%/ \
		ftp://sunsite.ualberta.ca/pub/unix/Linux/redhat/%SUBDIR%/ \
		ftp://ftp.sourceforge.net/pub/mirrors/redhat/redhat/linux/%SUBDIR%/ \
      		ftp://ftp.funet.fi/pub/mirrors/ftp.redhat.com/pub/redhat/linux/%SUBDIR%/
MASTER_SITE_SUBDIR= 6.2/en/os/i386/RedHat/RPMS
MASTER_SITES0=	ftp://updates.redhat.com/6.2/en/os/i386/ \
		ftp://sunsite.ualberta.ca/pub/unix/Linux/redhat/updates/6.2/en/os/i386/ \
		ftp://ftp.sourceforge.net/pub/mirrors/redhat/redhat/linux/updates/6.2/en/os/i386/ \
      		ftp://ftp.funet.fi/pub/mirrors/ftp.redhat.com/pub/redhat/linux/updates/6.2/en/os/i386/
DISTFILES=	${RPM_SET1} ${RPM_SET2}
DIST_SUBDIR=	rpm
EXTRACT_ONLY=	

BUILD_DEPENDS=	rpm::misc/rpm

MAINTAINER=	Jason Ish <jasoni@@openbsd.org>

PERMIT_PACKAGE_CDROM=   Yes
PERMIT_PACKAGE_FTP=     Yes
PERMIT_DISTFILES_CDROM= Yes
PERMIT_DISTFILES_FTP=   Yes

NO_BUILD=	Yes

PREFIX=		${LOCALBASE}/emul/redhat

RPM=		${LOCALBASE}/bin/rpm
RPMFLAGS=	--ignoreos --ignorearch --root ${PREFIX} --nodeps --noscripts \
		--excludedocs --replacepkgs --dbpath /var/lib/rpm
RPMDIR=		${FULLDISTDIR}

RPM_SET1=	setup-2.1.8-1.noarch.rpm \
		filesystem-1.3.5-1.noarch.rpm \
		basesystem-6.0-4.noarch.rpm

RPM_SET2=	ldconfig-1.9.5-16.i386.rpm \
		glibc-2.1.3-22.i386.rpm:0 \
		termcap-10.2.7-9.noarch.rpm \
		libtermcap-2.0.8-20.i386.rpm \
		bash-1.14.7-23.6x.i386.rpm:0 \
		ncurses-5.0-12.i386.rpm:0 \
		zlib-1.1.3-6.i386.rpm \
		fileutils-4.0-21.i386.rpm \
		binutils-2.9.5.0.22-6.i386.rpm \
		libstdc++-2.9.0-30.i386.rpm \
		sh-utils-2.0-5.i386.rpm \
		readline-2.2.1-6.i386.rpm \
		redhat-release-6.2-1.noarch.rpm \
		rpm-4.0.2-6x.i386.rpm:0 \
		XFree86-libs-3.3.6-20.i386.rpm \
		xpm-3.4k-2.i386.rpm \
		glib-1.2.6-3.i386.rpm \
		gtk+-1.2.6-7.i386.rpm \
		ld.so-1.9.5-13.i386.rpm \
		libc-5.3.12-31.i386.rpm \
		libjpeg-6b-10.i386.rpm \
		libpng-1.0.5-3.i386.rpm

REMOVE_DIRS=	/tmp /var/tmp /usr/tmp /home /root /proc /dev /mnt /boot /opt
REMOVE_FILES=	/bin/df /bin/su /etc/exports /etc/group /etc/passwd \
		/etc/localtime /etc/motd /etc/printcap /etc/services \
		/etc/protocols /etc/securetty

pre-install:
	${INSTALL_DATA_DIR} ${PREFIX}
	${INSTALL_DATA_DIR} ${PREFIX}/var/lib/rpm

do-install:
# Initialize the RPM database.
	@@${RPM} --initdb --root ${PREFIX} --dbpath /var/lib/rpm

# Install RPM's.  
# Redirect stderr for now because rpm tries to open /etc/mnttab which 
# is not pretty.

.for rpm in ${RPM_SET1}
	@@${RPM} -Uvh ${RPMFLAGS} ${RPMDIR}/${rpm} 2> /dev/null
.endfor

.for rpm in ${RPM_SET2:S/:0//}
	@@${RPM} -Uvh ${RPMFLAGS} ${RPMDIR}/${rpm} 2> /dev/null
.endfor

# Get rid of some unnecessary files and directories.
.for D in ${REMOVE_DIRS}
	@@rm -rf ${PREFIX}/${D}
.endfor
.for F in ${REMOVE_FILES}
	@@rm ${PREFIX}/${F}
.endfor

# copy in ld.so.conf
	${INSTALL_DATA} ${FILESDIR}/ld.so.conf ${PREFIX}/etc

# run elf2olf on a few binaries known not to run as elf
	@@elf2olf -o linux ${PREFIX}/sbin/ldconfig
	@@elf2olf -o linux ${PREFIX}/bin/rpm

# run ldconfig
	-chroot ${PREFIX} /sbin/ldconfig

post-install:
# remove setuid root bits
	@@find ${PREFIX} -perm -4000 -exec chmod u-s {} \;

.include <bsd.port.mk>
@


1.12
log
@MASTER_SITES fix by Heikki Korpela <heko@@saitti.net>:
- Add ftp.funet.fi and ftp.sunet.se mirrors where available.
- Remove broken ftp.funet.fi references.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2001/07/11 00:34:02 brad Exp $
@


1.11
log
@correcting the capitalization of the names
--
Ok'd by: maintainer
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2001/06/05 21:31:20 jasoni Exp $
d12 2
a13 1
		ftp://ftp.sourceforge.net/pub/mirrors/redhat/redhat/linux/%SUBDIR%/
d17 2
a18 1
		ftp://ftp.sourceforge.net/pub/mirrors/redhat/redhat/linux/updates/6.2/en/os/i386/
@


1.10
log
@typo; thanks brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2001/06/05 20:51:30 jasoni Exp $
d5 1
a5 1
COMMENT=	"linux compatibility package based on Redhat 6.2"
d9 1
a9 1
NEED_VERSION=	1.364
@


1.9
log
@- used rpms from updates if available
- remove subshells in Makefile
- add an extra tty
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2001/05/15 20:18:31 naddy Exp $
d110 1
a110 1
# remote setuid root bits
@


1.8
log
@bump package version to account for lib{jpeg,png} addition
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2001/05/08 21:32:48 jasoni Exp $
d7 1
a7 1
PKGNAME=	redhat_base-6.2p1
d14 3
d44 1
a44 1
		glibc-2.1.3-15.i386.rpm \
d47 2
a48 2
		bash-1.14.7-22.i386.rpm \
		ncurses-5.0-11.i386.rpm \
d56 1
a56 1
		rpm-3.0.4-0.48.i386.rpm \
d80 10
a89 8
# Redirect stderr for now b/c rpm tries to open /etc/mnttab which is not pretty.
	@@for rpm in ${RPM_SET1}; do \
		${RPM} -Uvh ${RPMFLAGS} ${RPMDIR}/$$rpm 2> /dev/null; \
	done

	@@for rpm in ${RPM_SET2}; do \
		${RPM} -Uvh ${RPMFLAGS} ${RPMDIR}/$$rpm 2> /dev/null; \
	done
d92 6
a97 6
	@@for D in ${REMOVE_DIRS}; do \
		rm -rf ${PREFIX}/$$D; \
	done
	@@for F in ${REMOVE_FILES}; do \
		rm ${PREFIX}/$$F; \
	done
d110 1
@


1.7
log
@- fix master sites (there's been some directory reorganization)
- add libpng and libjpeg
- add an extra tty
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2001/04/09 03:53:44 jasoni Exp $
d7 1
a7 1
PKGNAME=	redhat_base-6.2
@


1.6
log
@specify full path to rpm
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2001/04/05 06:05:35 jasoni Exp $
d5 1
a5 1
COMMENT=	"linux compatibility package based on Redhat"
d10 4
a13 4
MASTER_SITES=	ftp://ftp.redhat.com/pub/redhat/%SUBDIR%/ \
		ftp://sunsite.ualberta.ca/pub/Mirror/Linux/redhat/linux/6.2/i386/ \
		ftp://ftp.freesoftware.com/pub/linux/redhat/%SUBDIR%/
MASTER_SITE_SUBDIR= redhat-6.2-en/os/i386/RedHat/RPMS
d59 3
a61 1
		libc-5.3.12-31.i386.rpm
@


1.5
log
@- add another master site
- update master site directories (structure has changed)
- make chroot'd ldconfig work again
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2001/04/01 04:17:13 brad Exp $
d31 1
d72 1
a72 1
	@@rpm --initdb --root ${PREFIX} --dbpath /var/lib/rpm
d77 1
a77 1
		rpm -Uvh ${RPMFLAGS} ${RPMDIR}/$$rpm 2> /dev/null; \
d81 1
a81 1
		rpm -Uvh ${RPMFLAGS} ${RPMDIR}/$$rpm 2> /dev/null; \
@


1.4
log
@- integrate COMMENT
- bump NEED_VERSION
- hardcoded /usr/local -> ${LOCALBASE}
- mkdir -> ${INSTALL_DATA_DIR}
- make use of chroot consistent with freebsd_lib/linux_lib
--
Ok'd by: maintainer
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2001/02/13 06:06:22 jasoni Exp $
d11 1
d13 1
a13 1
MASTER_SITE_SUBDIR= redhat-6.2/i386/RedHat/RPMS
d99 1
a99 1
	-chroot ${WRKINST} ${TRUEPREFIX}/sbin/ldconfig
@


1.3
log
@- add another master site (pvalchev@@toxiclinux.org)
@
text
@d1 5
a5 1
# $OpenBSD: Makefile,v 1.2 2001/02/17 00:00:38 jasoni Exp $
d9 1
a9 1
NEED_VERSION=	1.301
d17 1
a17 1
ONLY_FOR_ARCHS=	i386
a25 2
BUILD_DEPENDS=	rpm::misc/rpm

d28 1
a28 1
PREFIX=		/usr/local/emul/redhat
d65 2
a66 2
	@@mkdir -p ${PREFIX}
	@@mkdir -p ${PREFIX}/var/lib/rpm
d91 1
a91 1
	@@${INSTALL_DATA} ${FILESDIR}/ld.so.conf ${PREFIX}/etc/ld.so.conf
d98 1
a98 1
	@@chroot ${PREFIX} sbin/ldconfig
@


1.2
log
@update master site
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2001/02/13 06:06:22 jasoni Exp $
d6 3
a8 1
MASTER_SITES=	ftp://ftp.freesoftware.com/pub/linux/redhat/redhat-6.2/i386/RedHat/RPMS/
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d6 1
a6 2
MASTER_SITES=	${MASTER_SITE_SUNSITE}
MASTER_SITE_SUBDIR= distributions/redhat/redhat-6.2/i386/RedHat/RPMS/
@


1.1.1.1
log
@- RPM based replacement for linux_lib
- based off Redhat 6.2
@
text
@@
