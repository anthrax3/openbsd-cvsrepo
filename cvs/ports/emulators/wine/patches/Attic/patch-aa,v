head	1.5;
access;
symbols
	OPENBSD_4_2:1.4.0.16
	OPENBSD_4_2_BASE:1.4
	OPENBSD_4_1:1.4.0.14
	OPENBSD_4_1_BASE:1.4
	OPENBSD_4_0:1.4.0.12
	OPENBSD_4_0_BASE:1.4
	OPENBSD_3_9:1.4.0.10
	OPENBSD_3_9_BASE:1.4
	OPENBSD_3_8:1.4.0.8
	OPENBSD_3_8_BASE:1.4
	OPENBSD_3_7:1.4.0.6
	OPENBSD_3_7_BASE:1.4
	OPENBSD_3_6:1.4.0.4
	OPENBSD_3_6_BASE:1.4
	OPENBSD_3_5:1.4.0.2
	OPENBSD_3_5_BASE:1.4
	OPENBSD_3_4:1.3.0.16
	OPENBSD_3_4_BASE:1.3
	OPENBSD_3_3:1.3.0.14
	OPENBSD_3_3_BASE:1.3
	OPENBSD_3_2:1.3.0.12
	OPENBSD_3_2_BASE:1.3
	OPENBSD_3_1:1.3.0.10
	OPENBSD_3_1_BASE:1.3
	OPENBSD_3_0:1.3.0.8
	OPENBSD_3_0_BASE:1.3
	OPENBSD_2_9_TRACKING_SWITCH:1.3
	OPENBSD_2_9:1.3.0.6
	OPENBSD_2_9_BASE:1.3
	OPENBSD_2_8:1.3.0.4
	OPENBSD_2_8_BASE:1.3
	OPENBSD_2_7:1.3.0.2
	OPENBSD_2_7_BASE:1.3
	OPENBSD_2_6:1.2.0.4
	OPENBSD_2_6_BASE:1.2
	OPENBSD_2_5:1.2.0.2
	OPENBSD_2_5_BASE:1.2;
locks; strict;
comment	@# @;


1.5
date	2007.10.26.21.04.25;	author ajacoutot;	state dead;
branches;
next	1.4;

1.4
date	2003.12.31.04.21.45;	author espie;	state Exp;
branches;
next	1.3;

1.3
date	99.11.11.20.32.05;	author fgsch;	state Exp;
branches;
next	1.2;

1.2
date	99.02.27.15.28.35;	author rohee;	state Exp;
branches;
next	1.1;

1.1
date	99.02.12.18.48.07;	author rohee;	state Exp;
branches;
next	;


desc
@@


1.5
log
@ - use our naming scheme for patches
@
text
@--- msdos/dpmi.c.orig	1999-02-25 18:32:56.000000000 +0100
+++ msdos/dpmi.c	2003-12-31 04:57:46.000000000 +0100
@@@@ -20,6 +20,7 @@@@
 #include "process.h"
 #include "callback.h"
 #include "debug.h"
+#include "stackframe.h"
 
 #define DOS_GET_DRIVE(reg) ((reg) ? (reg) - 1 : DRIVE_GetCurrentDrive())
 
@@@@ -211,22 +212,24 @@@@ static void DPMI_CallRMCBProc( CONTEXT *
          * real-mode call structure. */
         if (flag & 1) {
             /* 32-bit DPMI client */
-            __asm__ __volatile__("
-                 pushl %%es
-                 pushl %%ds
-                 pushfl
-                 movl %4,%%es
-                 movl %3,%%ds
-                 lcall %2
-                 popl %%ds
-                 movl %%es,%0
-                 popl %%es
-             "
+            __asm__ __volatile__("\n"
+"                 pushl %%si\n"
+"                 pushl %%es\n"
+"                 pushl %%ds\n"
+"                 pushfl\n"
+"                 movl %4,%%es\n"
+"                 movl %3,%%ds\n"
+"                 lcall %2\n"
+"                 popl %%ds\n"
+"                 movl %%es,%0\n"
+"                 popl %%es\n"
+"                 popl %%si\n"
+"             "
              : "=g" (es), "=D" (edi)
              : "m" (rmcb->proc_ofs),
                "g" (ss), "g" (rmcb->regs_sel),
                "S" (ESP_reg(context)), "D" (rmcb->regs_ofs)
-             : "eax", "ecx", "edx", "esi", "ebp" );
+             : "eax", "ecx", "edx", "ebp" );
         } else {
             /* 16-bit DPMI client */
             CONTEXT ctx = *context;
@


1.4
log
@make it compile with gcc 3.3
@
text
@@


1.3
log
@Fix compilation problem; broken till someone checks it.
@
text
@d1 2
a2 2
--- msdos/dpmi.c.orig	Thu Feb 25 14:32:56 1999
+++ msdos/dpmi.c	Tue Nov  9 02:42:00 1999
d11 2
a12 1
@@@@ -212,6 +213,7 @@@@
d15 24
a38 11
             __asm__ __volatile__("
+                 pushl %%si
                  pushl %%es
                  pushl %%ds
                  pushfl
@@@@ -221,12 +223,13 @@@@
                  popl %%ds
                  movl %%es,%0
                  popl %%es
+                 popl %%si
              "
@


1.2
log
@Update to Wine-990225
@
text
@d1 2
a2 2
--- msdos/dpmi.c.orig	Fri Feb 26 23:03:40 1999
+++ msdos/dpmi.c	Fri Feb 26 23:04:10 1999
d11 23
@


1.1
log
@And adding new patches
@
text
@d1 10
a10 23
Do *NOT* submit this patch to Wine developers <rohee@@OpenBSD.ORG>
NetBSD did it the wrong way, don't make the same mistakes :-)

--- multimedia/init.c.orig	Thu Feb 11 20:22:06 1999
+++ multimedia/init.c	Thu Feb 11 20:27:27 1999
@@@@ -36,7 +36,7 @@@@
 #ifdef HAVE_OSS
 int unixToWindowsDeviceType(int type)
 {
-#ifndef __NetBSD__
+#if !defined(__NetBSD__) && !defined(__OpenBSD__)
     /* MOD_MIDIPORT     output port 
      * MOD_SYNTH        generic internal synth 
      * MOD_SQSYNTH      square wave internal synth 
@@@@ -70,7 +70,7 @@@@
  */
 BOOL32 MULTIMEDIA_MidiInit(void)
 {
-#if defined(HAVE_OSS) && !defined(__NetBSD__)
+#if defined(HAVE_OSS) && !defined(__NetBSD__) && !defined(__OpenBSD__)
     int 		i, status, numsynthdevs = 255, nummididevs = 255;
     struct synth_info 	sinfo;
     struct midi_info 	minfo;
@

