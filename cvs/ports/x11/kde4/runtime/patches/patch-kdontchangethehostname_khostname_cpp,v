head	1.1;
access;
symbols
	OPENBSD_6_1:1.1.0.14
	OPENBSD_6_1_BASE:1.1
	OPENBSD_6_0:1.1.0.12
	OPENBSD_6_0_BASE:1.1
	OPENBSD_5_9:1.1.0.8
	OPENBSD_5_9_BASE:1.1
	OPENBSD_5_8:1.1.0.10
	OPENBSD_5_8_BASE:1.1
	OPENBSD_5_7:1.1.0.6
	OPENBSD_5_7_BASE:1.1
	OPENBSD_5_6:1.1.0.4
	OPENBSD_5_6_BASE:1.1
	OPENBSD_5_5:1.1.0.2
	OPENBSD_5_5_BASE:1.1;
locks; strict;
comment	@# @;


1.1
date	2014.02.04.15.25.44;	author zhuk;	state Exp;
branches;
next	;


desc
@@


1.1
log
@Rename KDE4 symlinks it creates in KDEHOME that point out to different
temporary areas. Now KDE3 and KDE4 use totally different "temp" areas and
programs from both worlds could work more or less fine together, even when
sharing KDEHOME (this is NOT a recommended way to do things, but sometimes
you have to, like me). The only two minor problems there I'm aware now are:

1. Konqueror (KDE3) can't open web sites (some KHTML or kio_http issue?).

2. kded (KDE3) hangs when run automatically through kdeinit; killing it and
   starting manually fixes the situation. May be kbuildsycoca-related, will
   investigate more.

If you see any other problems, like hardcoded paths to those symlinks,
don't stay silent.

Oh, and it's really NOT recommended to install this update while having
KDE4 apps running.
@
text
@$OpenBSD$
Distinguish KDE4 temporary directories.
--- kdontchangethehostname/khostname.cpp.orig	Tue Feb  4 14:49:11 2014
+++ kdontchangethehostname/khostname.cpp	Tue Feb  4 14:56:15 2014
@@@@ -160,8 +160,10 @@@@ void KHostName::changeX()
 void KHostName::changeStdDirs(const QByteArray &type)
 {
    // We make links to the old dirs cause we can't delete the old dirs.
-   QByteArray oldDir = QFile::encodeName(QString("%1%2-%3").arg(KGlobal::dirs()->localkdedir()).arg(QString( type )).arg(QString( oldName )));
-   QByteArray newDir = QFile::encodeName(QString("%1%2-%3").arg(KGlobal::dirs()->localkdedir()).arg(QString( type )).arg(QString( newName )));
+   QByteArray oldDir = QFile::encodeName(KGlobal::dirs()->localkdedir()
+      + QString(type) + QString::fromLatin1("4-") + QString( oldName ));
+   QByteArray newDir = QFile::encodeName(KGlobal::dirs()->localkdedir()
+      + QString(type) + QString::fromLatin1("4-") + QString( newName ));
 
    KDE_struct_stat st_buf;
 
@
