head	1.1;
access;
symbols
	OPENBSD_6_1:1.1.0.16
	OPENBSD_6_1_BASE:1.1
	OPENBSD_6_0:1.1.0.14
	OPENBSD_6_0_BASE:1.1
	OPENBSD_5_9:1.1.0.10
	OPENBSD_5_9_BASE:1.1
	OPENBSD_5_8:1.1.0.12
	OPENBSD_5_8_BASE:1.1
	OPENBSD_5_7:1.1.0.8
	OPENBSD_5_7_BASE:1.1
	OPENBSD_5_6:1.1.0.6
	OPENBSD_5_6_BASE:1.1
	OPENBSD_5_5:1.1.0.4
	OPENBSD_5_5_BASE:1.1
	OPENBSD_5_4:1.1.0.2
	OPENBSD_5_4_BASE:1.1;
locks; strict;
comment	@# @;


1.1
date	2013.05.19.11.21.54;	author zhuk;	state Exp;
branches;
next	;


desc
@@


1.1
log
@Fix compilation of krossqtsplugin after recent changes in CMake. This is
actually a plugin (see kdepim-runtime), so it should be created with
KDE4_ADD_PLUGIN instead of KDE4_ADD_LIBRARY. Looks like it was done other
way to help linking problems for tests. I'll look there more later, now
it's time to at least unbreak kdelibs.

Initially notfied by Scott McEachern on ports@@, prodded by espie@@ too.
@
text
@$OpenBSD$
This is actually a plugin, do not make it a versioned library.
FWIW, the only user is kdepim-runtime.
--- kross/qts/CMakeLists.txt.orig	Sun May 19 13:10:50 2013
+++ kross/qts/CMakeLists.txt	Sun May 19 15:03:15 2013
@@@@ -2,11 +2,8 @@@@ include_directories(${CMAKE_SOURCE_DIR} ${KDE4_KDECORE
 
 ########### next target ###############
 set(krossqtsplugin_LIB_SRCS plugin.cpp)
-kde4_add_library(krossqtsplugin ${LIBRARY_TYPE} ${krossqtsplugin_LIB_SRCS})
+kde4_add_plugin(krossqtsplugin ${LIBRARY_TYPE} ${krossqtsplugin_LIB_SRCS})
 target_link_libraries(krossqtsplugin ${QT_QTUITOOLS_LIBRARY} ${KDE4_KDECORE_LIBS} ${KDE4_KDEUI_LIBS} krosscore ${QT_QTSCRIPT_LIBRARY})
-if (NOT CYGWIN)
-    set_target_properties(krossqtsplugin PROPERTIES VERSION ${GENERIC_LIB_VERSION} SOVERSION ${GENERIC_LIB_SOVERSION})
-endif (NOT CYGWIN)
 
 install(TARGETS krossqtsplugin DESTINATION ${PLUGIN_INSTALL_DIR}/plugins/script)
 
@@@@ -15,8 +12,8 @@@@ install(TARGETS krossqtsplugin DESTINATION ${PLUGIN_IN
 set(EXECUTABLE_OUTPUT_PATH ${CMAKE_CURRENT_BINARY_DIR})
 include_directories(${CMAKE_SOURCE_DIR}/kross ${KDE4_KDECORE_INCLUDES} ${KDE4_KDEUI_INCLUDES} ${KDE4_KIO_INCLUDES})
 set(krossqtstest_SRCS main.cpp)
-kde4_add_executable(krossqtstest TEST ${krossqtstest_SRCS})
-target_link_libraries(krossqtstest ${KDE4_KDEUI_LIBS} krossqtsplugin ${QT_QTSCRIPT_LIBRARY})
+kde4_add_executable(krossqtstest TEST ${krossqtstest_SRCS} ${krossqtsplugin_LIB_SRCS})
+target_link_libraries(krossqtstest ${QT_QTUITOOLS_LIBRARY} ${KDE4_KDEUI_LIBS} krosscore ${QT_QTSCRIPT_LIBRARY})
 # set(krossqtsplugintest_SRCS main.cpp)
 # target_link_libraries(krossqtsplugintest ${KDE4_KDECORE_LIBS} )
 # kde4_add_executable(krossqtsplugintest ${krossqtsplugintest_SRCS})
@
