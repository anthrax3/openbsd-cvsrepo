head	1.3;
access;
symbols
	OPENBSD_6_2:1.3.0.10
	OPENBSD_6_2_BASE:1.3
	OPENBSD_6_1:1.3.0.8
	OPENBSD_6_1_BASE:1.3
	OPENBSD_6_0:1.3.0.6
	OPENBSD_6_0_BASE:1.3
	OPENBSD_5_9:1.3.0.2
	OPENBSD_5_9_BASE:1.3
	OPENBSD_5_8:1.3.0.4
	OPENBSD_5_8_BASE:1.3
	OPENBSD_5_7:1.2.0.4
	OPENBSD_5_7_BASE:1.2
	OPENBSD_5_6:1.2.0.2
	OPENBSD_5_6_BASE:1.2;
locks; strict;
comment	@# @;


1.3
date	2015.03.30.17.11.45;	author zhuk;	state Exp;
branches;
next	1.2;
commitid	DrvRaWp4iDzpwlSe;

1.2
date	2014.07.08.10.01.04;	author sthen;	state Exp;
branches;
next	1.1;
commitid	FtpedfugVPRVa8Ie;

1.1
date	2014.04.30.09.31.20;	author zhuk;	state Exp;
branches;
next	;


desc
@@


1.3
log
@Partial stability update for a few KDE4 components brought by KDE PIM people.

Includes some local fixes for ksysguard (no longer crashes, more love needed).
@
text
@$OpenBSD: patch-powerdevil_daemon_backends_upower_powerdevilupowerbackend_cpp,v 1.2 2014/07/08 10:01:04 sthen Exp $
--- powerdevil/daemon/backends/upower/powerdevilupowerbackend.cpp.orig	Thu Jan 29 21:49:17 2015
+++ powerdevil/daemon/backends/upower/powerdevilupowerbackend.cpp	Wed Feb  4 23:29:18 2015
@@@@ -162,7 +162,14 @@@@ void PowerDevilUPowerBackend::init()
     bool screenBrightnessAvailable = false;
     m_upowerInterface = new OrgFreedesktopUPowerInterface(UPOWER_SERVICE, "/org/freedesktop/UPower", QDBusConnection::systemBus(), this);
     m_brightnessControl = new XRandrBrightness();
-    if (!m_brightnessControl->isSupported()) {
+    if (m_brightnessControl->isSupported()) {
+        kDebug() << "Using XRandR";
+        m_randrHelper = new XRandRX11Helper();
+        connect(m_randrHelper, SIGNAL(brightnessChanged()), this, SLOT(slotScreenBrightnessChanged()));
+        screenBrightnessAvailable = true;
+    }
+#ifdef HAVE_UDEV
+    else {
         kDebug() << "Using helper";
         KAuth::Action action("org.kde.powerdevil.backlighthelper.syspath");
         action.setHelperID(HELPER_ID);
@@@@ -175,12 +182,8 @@@@ void PowerDevilUPowerBackend::init()
             connect(client, SIGNAL(deviceChanged(UdevQt::Device)), SLOT(onDeviceChanged(UdevQt::Device)));
             screenBrightnessAvailable = true;
         }
-    } else {
-        kDebug() << "Using XRandR";
-        m_randrHelper = new XRandRX11Helper();
-        connect(m_randrHelper, SIGNAL(brightnessChanged()), this, SLOT(slotScreenBrightnessChanged()));
-        screenBrightnessAvailable = true;
     }
+#endif
 
     // Capabilities
     setCapabilities(SignalResumeFromSuspend);
@


1.2
log
@regen patches, whitespace change only
@
text
@d1 4
a4 4
$OpenBSD: patch-powerdevil_daemon_backends_upower_powerdevilupowerbackend_cpp,v 1.1 2014/04/30 09:31:20 zhuk Exp $
--- powerdevil/daemon/backends/upower/powerdevilupowerbackend.cpp.orig	Mon Apr 28 05:38:04 2014
+++ powerdevil/daemon/backends/upower/powerdevilupowerbackend.cpp	Tue Jul  8 10:58:17 2014
@@@@ -160,7 +160,14 @@@@ void PowerDevilUPowerBackend::init()
d20 1
a20 1
@@@@ -173,12 +180,8 @@@@ void PowerDevilUPowerBackend::init()
@


1.1
log
@Add (or, more correctly, enable) support for UPower backend in Solid.

Known problems, being investigated:
  * false "battery is dead" message;
  * no suspend action.

Actual patch from Fabian Raetz, thanks!
@
text
@d1 4
a4 4
$OpenBSD$
--- powerdevil/daemon/backends/upower/powerdevilupowerbackend.cpp.orig Thu Jan 30 20:25:09 2014
+++ powerdevil/daemon/backends/upower/powerdevilupowerbackend.cpp Mon Mar 31 23:32:07 2014
@@@@ -156,7 +156,14 @@@@ void PowerDevilUPowerBackend::init()
d20 1
a20 1
@@@@ -169,12 +176,8 @@@@ void PowerDevilUPowerBackend::init()
d31 1
a31 1

@

