head	1.1;
access;
symbols
	OPENBSD_6_1:1.1.0.4
	OPENBSD_6_1_BASE:1.1
	OPENBSD_6_0:1.1.0.2
	OPENBSD_6_0_BASE:1.1;
locks; strict;
comment	@# @;


1.1
date	2016.07.16.10.38.50;	author zhuk;	state Exp;
branches;
next	;
commitid	xscLvzvQPEvCiClI;


desc
@@


1.1
log
@Finish & actually enable BSD authentication support in KDE4.
This overcomes tweaking getpw* calls: KDM and kcheckpass code did it wrong
on OpenBSD anyway (for example, compared the whole pw_passwd with "*",
instead of checking first character only). And we support other types
of password-based authentication as a bonus now (hello, login_-ldap!).

Also, we now create directory for persistent data of KDM by default,
and it's /var/kdm (previously KDM tried to access /var/lib/kdm).
The persistent data means "the name of the previous user" etc.
Previously features like "remember last user logged in" didn't work.

KDE3 bits to follow a bit later.

generic approvement from sthen@@
@
text
@$OpenBSD$
Add BSD auth support.
--- kcheckpass/kcheckpass.h.orig	Tue Jul 12 18:06:50 2016
+++ kcheckpass/kcheckpass.h	Tue Jul 12 18:05:14 2016
@@@@ -72,6 +72,7 @@@@
 #if defined(HAVE_PAM)
 # undef HAVE_OSF_C2_PASSWD
 #elif defined(HAVE_OSF_C2_PASSWD)
+#elif defined(HAVE_BSDAUTH)
 #elif defined(_AIX)
 # define HAVE_AIX_AUTH
 #elif defined(HAVE_GETSPNAM)
@
