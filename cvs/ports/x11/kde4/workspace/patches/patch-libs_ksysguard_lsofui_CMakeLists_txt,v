head	1.1;
access;
symbols
	OPENBSD_6_1:1.1.0.4
	OPENBSD_6_1_BASE:1.1
	OPENBSD_6_0:1.1.0.2
	OPENBSD_6_0_BASE:1.1;
locks; strict;
comment	@# @;


1.1
date	2016.04.30.00.37.36;	author zhuk;	state Exp;
branches;
next	;
commitid	ZAR1Whj4WqPGyQje;


desc
@@


1.1
log
@Remove dependency on lsof. Much prodded by deraadt@@. :)

Switch out from devel/gettext in MODULES while there.
@
text
@$OpenBSD$
Use kvm_getfiles() instead of starting lsof(1).
--- libs/ksysguard/lsofui/CMakeLists.txt.orig	Sat Apr 30 02:55:52 2016
+++ libs/ksysguard/lsofui/CMakeLists.txt	Sat Apr 30 02:55:33 2016
@@@@ -12,6 +12,11 @@@@ kde4_add_ui_files( lsofui_LIB_SRCS
 kde4_add_library(lsofui SHARED ${lsofui_LIB_SRCS})
 
 target_link_libraries(lsofui ${KDE4_KIO_LIBS} )
+if( ${CMAKE_SYSTEM_NAME} MATCHES "NetBSD" OR ${CMAKE_SYSTEM_NAME} MATCHES "OpenBSD" )
+  message(STATUS "Adding kvm library on NetBSD/OpenBSD")
+  target_link_libraries(lsofui kvm)
+  add_definitions(-DHAVE_KVM_H=1)
+endif()
 set_target_properties(lsofui PROPERTIES VERSION ${GENERIC_LIB_VERSION} SOVERSION ${GENERIC_LIB_SOVERSION} )
 install(TARGETS lsofui EXPORT kdeworkspaceLibraryTargets ${INSTALL_TARGETS_DEFAULT_ARGS} )
 
@
