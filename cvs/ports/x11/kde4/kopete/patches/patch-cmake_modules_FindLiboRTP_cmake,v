head	1.1;
branch	1.1.1;
access;
symbols
	OPENBSD_6_0:1.1.1.1.0.12
	OPENBSD_6_0_BASE:1.1.1.1
	OPENBSD_5_9:1.1.1.1.0.8
	OPENBSD_5_9_BASE:1.1.1.1
	OPENBSD_5_8:1.1.1.1.0.10
	OPENBSD_5_8_BASE:1.1.1.1
	OPENBSD_5_7:1.1.1.1.0.6
	OPENBSD_5_7_BASE:1.1.1.1
	OPENBSD_5_6:1.1.1.1.0.4
	OPENBSD_5_6_BASE:1.1.1.1
	OPENBSD_5_5:1.1.1.1.0.2
	OPENBSD_5_5_BASE:1.1.1.1
	zhuk_20131208:1.1.1.1
	zhuk:1.1.1;
locks; strict;
comment	@# @;


1.1
date	2013.12.08.18.39.44;	author zhuk;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2013.12.08.18.39.44;	author zhuk;	state Exp;
branches;
next	;


desc
@@



1.1
log
@Initial revision
@
text
@$OpenBSD$
Rework oRTP library detection.
--- cmake/modules/FindLiboRTP.cmake.orig	Fri Jun 28 22:08:21 2013
+++ cmake/modules/FindLiboRTP.cmake	Mon Dec  2 17:34:54 2013
@@@@ -8,6 +8,8 @@@@
 
 INCLUDE( FindPackageHandleStandardArgs )
 include( FindPkgConfig )
+include( CMakePushCheckState )
+include( CheckCSourceRuns )
 
 SET( LIBORTP_FOUND FALSE )
 
@@@@ -23,30 +25,27 @@@@ FIND_LIBRARY( LIBORTP_LIBRARY
               PATHS ${ortp_LIBDIR}
 )
 
-IF( LIBORTP_INCLUDE_DIR AND LIBORTP_LIBRARY )
-  # we need to save and disable the C flags currently set, as they can conflict
-  # with ortp's requirements (c99)
-  set(save_cmake_c_flags ${CMAKE_C_FLAGS})
-  set(CMAKE_C_FLAGS)
-  try_run( run_result compile_result
-           ${CMAKE_CURRENT_BINARY_DIR} ${CMAKE_CURRENT_SOURCE_DIR}/cmake/modules/ortpversion.c
-           CMAKE_FLAGS -DINCLUDE_DIRECTORIES:STRING=${LIBORTP_INCLUDE_DIR} -DLINK_LIBRARIES=${LIBORTP_LIBRARY}
-           COMPILE_DEFINITIONS "${ortp_CFLAGS}"
-           ARGS "0 13"
-  )
-  set(CMAKE_C_FLAGS ${save_cmake_c_flags})
+set(LIBORTP_LIBRARIES)
+set(LIBORTP_INCLUDE_DIRS)
+if(LIBORTP_INCLUDE_DIR AND LIBORTP_LIBRARY)
+  set(_LIBORTP_TEST_CODE "
+#include <ortp/ortp.h>
+int main() { return ortp_min_version_required(0, 13, 0) ? 0 : 1; }
+")
+  cmake_push_check_state(RESET)
+  set(CMAKE_REQUIRED_INCLUDES ${LIBORTP_INCLUDE_DIR} ${ortp_INCLUDE_DIRS})
+  set(CMAKE_REQUIRED_LIBRARIES ${LIBORTP_LIBRARY} ${ortp_LDFLAGS})
+  set(CMAKE_REQUIRED_FLAGS -std=gnu99)
+#  set(CMAKE_REQUIRED_FLAGS ${CMAKE_REQUIRED_FLAGS} ${ortp_CFLAGS})
+  check_c_source_runs("${_LIBORTP_TEST_CODE}" LiboRTP_VERSION_CHECK)
+  if(LiboRTP_VERSION_CHECK)
+    set(LIBORTP_LIBRARIES ${LIBORTP_LIBRARY})
+    set(LIBORTP_INCLUDE_DIRS ${LIBORTP_INCLUDE_DIR})
+  endif()
+  cmake_pop_check_state()
+endif()
 
-  if ( compile_result )
-    if ( run_result EQUAL 0 )
-#     Version OK
-      SET( LIBORTP_FOUND TRUE )
-      MESSAGE( STATUS "Found libortp: ${LIBORTP_LIBRARY}" )
-    endif ( run_result EQUAL 0 )
-  endif( compile_result )
-ENDIF( LIBORTP_INCLUDE_DIR AND LIBORTP_LIBRARY )
-
-if( NOT LIBORTP_FOUND )
-  if( LiboRTP_FIND_REQUIRED )
-    message( FATAL_ERROR "You need ortp, minimum version 0.13." )
-  endif ( LiboRTP_FIND_REQUIRED )
-endif( NOT LIBORTP_FOUND )
+find_package_handle_standard_args(LiboRTP
+                                  FOUND_VAR LIBORTP_FOUND
+                                  REQUIRED_VARS LIBORTP_LIBRARIES LIBORTP_INCLUDE_DIRS
+                                 )
@


1.1.1.1
log
@Kopete is an instant messenger supporting AIM, Bonjour, Gadu-Gadu,
GroupWise, ICQ, Jabber (XMPP, Google Talk, Facebook, ...), Meanwhile,
QQ, Skype, Windows Live Messenger, WinPopup, Yahoo and more. It is
designed to be a flexible and extensible multi-protocol system
suitable for personal and enterprise use.

The goal of Kopete is to provide users with a single easy-to-use
way to access all of their instant messaging systems. The interface
puts people first, and is integrated with the system address book
to let you access your contacts from other KDE applications. Instant
messaging can be intrusive, but Kopete's notification system can
be tuned so that only important contacts interrupt you.

Kopete also features tools to enhance your instant messaging
experience, such as message encryption, archiving, and many other
fun and useful effects.

This is ex-kdenetwork member. Importing as a part of KDE 4.11.4 update.
This port won't work until update is finished, thus not hooking it up.
@
text
@@
