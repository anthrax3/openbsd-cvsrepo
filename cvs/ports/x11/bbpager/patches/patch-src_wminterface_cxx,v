head	1.1;
access;
symbols
	OPENBSD_6_0:1.1.0.4
	OPENBSD_6_0_BASE:1.1
	OPENBSD_5_9:1.1.0.2
	OPENBSD_5_9_BASE:1.1;
locks; strict;
comment	@# @;


1.1
date	2016.02.22.18.41.19;	author jca;	state Exp;
branches;
next	;
commitid	OHjEtG9bs80Eynnh;


desc
@@


1.1
log
@Fix a crash when a window is closed.

bbpager would dereference an std::list iterator after it was invalidated
by erase().  Crash reported by Alessandro DE LAURENZIS, fix also tested
by Ryan Freeman.  ok naddy@@
@
text
@$OpenBSD$
--- src/wminterface.cxx.orig	Fri Feb 19 19:14:47 2016
+++ src/wminterface.cxx	Fri Feb 19 19:15:04 2016
@@@@ -84,8 +84,7 @@@@ void WMInterface::updateWindowList(void)
         for (; pit != pit_end; pit++) {
             if (!(*pit)->isMarked()) {
                 delete (*pit);
-                bbtool->pagerWindowList().erase(pit);
-                pit--;
+                bbtool->pagerWindowList().erase(pit--);
             } else {
             }
         }
@
