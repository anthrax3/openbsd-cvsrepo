head	1.4;
access;
symbols
	OPENBSD_5_3:1.3.0.4
	OPENBSD_5_3_BASE:1.3
	OPENBSD_5_2:1.3.0.2
	OPENBSD_5_2_BASE:1.3
	OPENBSD_5_1_BASE:1.2
	OPENBSD_5_1:1.2.0.4
	OPENBSD_5_0:1.2.0.2
	OPENBSD_5_0_BASE:1.2
	OPENBSD_4_9:1.1.0.2
	OPENBSD_4_9_BASE:1.1;
locks; strict;
comment	@# @;


1.4
date	2013.04.25.16.14.27;	author sebastia;	state dead;
branches;
next	1.3;

1.3
date	2012.07.08.13.22.54;	author sebastia;	state Exp;
branches;
next	1.2;

1.2
date	2011.04.18.11.54.49;	author sebastia;	state Exp;
branches;
next	1.1;

1.1
date	2010.10.15.10.37.51;	author sebastia;	state Exp;
branches;
next	;


desc
@@


1.4
log
@update to gnustep-base 1.24.1
Getting rid of patch to make SYSTRACE happy, switch to use a GNUstep.conf
file in the x11/gnustep directory instead, more closely following what
the framework provides
API changes required a major library bump

OK landry@@
@
text
@$OpenBSD: patch-Source_NSUserDefaults_m,v 1.3 2012/07/08 13:22:54 sebastia Exp $

Introduce the GS_DEFAULTS_LOCKDIR to allow the gnustep ports to
build with systrace. Otherwise plmerge would try to create a lock
file in the users home directory.

Fix for 64Bit comparison of NSNotFound

--- Source/NSUserDefaults.m.orig	Sun Jan 29 12:10:05 2012
+++ Source/NSUserDefaults.m	Mon Apr  9 14:35:54 2012
@@@@ -1178,9 +1178,14 @@@@ newLanguages(NSArray *oldNames)
 - (id) initWithUser: (NSString*)userName
 {
   NSString	*path;
-
-  path = [GSDefaultsRootForUser(userName)
-    stringByAppendingPathComponent: defaultsFile];
+  if ([[[NSProcessInfo processInfo] environment] objectForKey:@@"GS_DEFAULTS_LOCKDIR"])
+  {
+    path = [[[[NSProcessInfo processInfo] environment] objectForKey:@@"GS_DEFAULTS_LOCKDIR"] stringByAppendingPathComponent: defaultsFile];
+  } else 
+  {
+    path = [GSDefaultsRootForUser(userName)
+      stringByAppendingPathComponent: defaultsFile];
+  }
   return [self initWithContentsOfFile: path];
 }
 
@@@@ -1222,7 +1227,7 @@@@ newLanguages(NSArray *oldNames)
 
 - (void) addSuiteNamed: (NSString*)aName
 {
-  unsigned	index;
+  NSUInteger	index;
 
   if (aName == nil)
     {
@


1.3
log
@Update gnustep-base to 1.24.0
cleaning up the Makefile
Major SHLIB bump
get rid of a bunch of patches

aja needs that to go ahead with gnutls update
@
text
@d1 1
a1 1
$OpenBSD: patch-Source_NSUserDefaults_m,v 1.2 2011/04/18 11:54:49 sebastia Exp $
@


1.2
log
@update gnustep-base to 1.22.0, major bump needed

OK landry@@, ajacoutot@@
@
text
@d1 1
a1 1
$OpenBSD: patch-Source_NSUserDefaults_m,v 1.1 2010/10/15 10:37:51 sebastia Exp $
d7 5
a11 3
--- Source/NSUserDefaults.m.orig	Sun Apr  3 10:53:10 2011
+++ Source/NSUserDefaults.m	Mon Apr  4 13:03:46 2011
@@@@ -828,9 +828,14 @@@@ newLanguages(NSArray *oldNames)
d29 9
@


1.1
log
@Bye Bye NO_SYSTRACE for the x11/gnustep MODULE based ports.
patching gnustep-base to add usage of an environment variable
to allow set a pointer where the lockfiles of plmerge should go while building the port.

OK, ajacoutot@@, jasper@@, landry@@
@
text
@d1 1
a1 1
$OpenBSD$
d7 3
a9 3
--- Source/NSUserDefaults.m.orig	Sat Oct  9 10:04:53 2010
+++ Source/NSUserDefaults.m	Sat Oct  9 10:09:24 2010
@@@@ -843,9 +843,14 @@@@ static BOOL setSharedDefaults = NO;     /* Flag to pre
@

