head	1.3;
access;
symbols
	OPENBSD_4_1:1.2.0.6
	OPENBSD_4_1_BASE:1.2
	OPENBSD_4_0:1.2.0.4
	OPENBSD_4_0_BASE:1.2
	OPENBSD_3_9:1.2.0.2
	OPENBSD_3_9_BASE:1.2
	OPENBSD_3_8:1.1.0.2
	OPENBSD_3_8_BASE:1.1;
locks; strict;
comment	@# @;


1.3
date	2007.05.25.09.49.54;	author espie;	state dead;
branches;
next	1.2;

1.2
date	2005.11.30.11.22.09;	author espie;	state Exp;
branches;
next	1.1;

1.1
date	2005.08.11.14.21.46;	author naddy;	state Exp;
branches;
next	;


desc
@@


1.3
log
@update a large subset of kde 3 to 3.5.7.
Simplify the infrastructure a bit, and let it compile with libfam, now...
@
text
@$OpenBSD: patch-kpdf_xpdf_xpdf_SplashOutputDev_cc,v 1.2 2005/11/30 11:22:09 espie Exp $
--- kpdf/xpdf/xpdf/SplashOutputDev.cc.orig	Sat Sep 10 10:18:43 2005
+++ kpdf/xpdf/xpdf/SplashOutputDev.cc	Mon Nov 21 21:41:36 2005
@@@@ -1105,11 +1105,15 @@@@ void SplashOutputDev::updateFont(GfxStat
 	ff = FoFiTrueType::load(fileName->getCString());
       else
 	ff = new FoFiTrueType(tmpBuf, tmpBufLen, gFalse);
-      if (! ff)
-	goto err2;
-      codeToGID = ((Gfx8BitFont *)gfxFont)->getCodeToGIDMap(ff);
-      delete ff;
-      fontFile = fontEngine->loadTrueTypeFont(id, fontsrc, codeToGID, 256);
+      if (ff) {
+	codeToGID = ((Gfx8BitFont *)gfxFont)->getCodeToGIDMap(ff);
+	n = 256;
+	delete ff;
+      } else {
+	codeToGID = NULL;
+	n = 0;
+      }
+      fontFile = fontEngine->loadTrueTypeFont(id, fontsrc, codeToGID, n);
       if (! fontFile) {
 	error(-1, "Couldn't create a font for '%s'",
 	      gfxFont->getName() ? gfxFont->getName()->getCString()
@


1.2
log
@kde 3.5, split off scanner handling, and fix library dependencies.
@
text
@d1 1
a1 1
$OpenBSD: patch-kpdf_xpdf_xpdf_SplashOutputDev_cc,v 1.1 2005/08/11 14:21:46 naddy Exp $
@


1.1
log
@Fix denial of service vulnerability.
Check sanity of the TrueType "loca" table.  Specially crafted broken
tables caused disk space exhaustion due to very large generated glyph
descriptions when attempting to fix the table.  CAN-2005-2097.

http://www.kde.org/info/security/advisory-20050809-1.txt
@
text
@d1 4
a4 4
$OpenBSD$
--- kpdf/xpdf/xpdf/SplashOutputDev.cc.orig	Wed Jul 20 12:00:36 2005
+++ kpdf/xpdf/xpdf/SplashOutputDev.cc	Wed Aug 10 23:13:31 2005
@@@@ -622,11 +622,15 @@@@ void SplashOutputDev::updateFont(GfxStat
@

