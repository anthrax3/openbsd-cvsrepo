head	1.2;
access;
symbols
	OPENBSD_3_2:1.1.0.2
	OPENBSD_3_2_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2002.10.28.21.44.32;	author espie;	state dead;
branches;
next	1.1;

1.1
date	2002.09.28.22.50.30;	author brad;	state Exp;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2002.12.26.22.28.18;	author pvalchev;	state dead;
branches;
next	;


desc
@@


1.2
log
@3.0.4 update, most of it.
i18n packlists to check yet...
@
text
@$OpenBSD: patch-kghostview_ps_c,v 1.1 2002/09/28 22:50:30 brad Exp $
--- kghostview/ps.c.orig	Mon Jan 28 16:05:43 2002
+++ kghostview/ps.c	Sat Sep 28 18:12:33 2002
@@@@ -71,9 +71,11 @@@@ pscopy(from, to, begin, end)
 	if (!(DSCcomment(line) && iscomment(line+2, "Begin"))) {
 	    /* Do nothing */
 	} else if (iscomment(line+7, "Data:")) {
+            int rc = 0;
 	    text[0] = '\0';
-	    if (sscanf(line+length("%%BeginData:"),
-		       "%d %*s %s", &num, text) >= 1) {
+	    rc = sscanf(line+length("%%BeginData:"), "%d %*s %256s", &num,text);
+            text[256] = '\0';
+            if (rc >= 1) {
 		if (strcmp(text, "Lines") == 0) {
 		    for (i=0; i < num; i++) {
 			fgets(line, sizeof line, from);
@@@@ -148,9 +150,11 @@@@ pscopyuntil(from, to, begin, end, commen
 	if (!(DSCcomment(line) && iscomment(line+2, "Begin"))) {
 	    /* Do nothing */
 	} else if (iscomment(line+7, "Data:")) {
+            int rc = 0;
 	    text[0] = '\0';
-	    if (sscanf(line+length("%%BeginData:"),
-		       "%d %*s %s", &num, text) >= 1) {
+	    rc = sscanf(line+length("%%BeginData:"), "%d %*s %256s", &num,text);
+            text[256] = '\0';
+            if (rc >= 1) {
 		if (strcmp(text, "Lines") == 0) {
 		    for (i=0; i < num; i++) {
 			fgets(line, sizeof line, from);
@


1.1
log
@fix buffer overflow issue with kghostview.
--
Patch from: Dirk Mueller <mueller@@kde.org> via espie@@
@
text
@d1 1
a1 1
$OpenBSD$
@


1.1.2.1
log
@MFC:
Security update: 3.0.5a. Fixes numerous vulnerabilities.
@
text
@d1 1
a1 1
$OpenBSD: patch-kghostview_ps_c,v 1.1 2002/09/28 22:50:30 brad Exp $
@


