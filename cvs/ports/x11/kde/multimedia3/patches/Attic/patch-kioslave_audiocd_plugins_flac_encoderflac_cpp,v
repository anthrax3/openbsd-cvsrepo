head	1.2;
access;
symbols
	OPENBSD_5_9:1.1.0.32
	OPENBSD_5_9_BASE:1.1
	OPENBSD_5_8:1.1.0.34
	OPENBSD_5_8_BASE:1.1
	OPENBSD_5_7:1.1.0.30
	OPENBSD_5_7_BASE:1.1
	OPENBSD_5_6:1.1.0.28
	OPENBSD_5_6_BASE:1.1
	OPENBSD_5_5:1.1.0.26
	OPENBSD_5_5_BASE:1.1
	OPENBSD_5_4:1.1.0.24
	OPENBSD_5_4_BASE:1.1
	OPENBSD_5_3:1.1.0.22
	OPENBSD_5_3_BASE:1.1
	OPENBSD_5_2:1.1.0.20
	OPENBSD_5_2_BASE:1.1
	OPENBSD_5_1_BASE:1.1
	OPENBSD_5_1:1.1.0.18
	OPENBSD_5_0:1.1.0.16
	OPENBSD_5_0_BASE:1.1
	OPENBSD_4_9:1.1.0.14
	OPENBSD_4_9_BASE:1.1
	OPENBSD_4_8:1.1.0.12
	OPENBSD_4_8_BASE:1.1
	OPENBSD_4_7:1.1.0.10
	OPENBSD_4_7_BASE:1.1
	OPENBSD_4_6:1.1.0.8
	OPENBSD_4_6_BASE:1.1
	OPENBSD_4_5:1.1.0.6
	OPENBSD_4_5_BASE:1.1
	OPENBSD_4_4:1.1.0.4
	OPENBSD_4_4_BASE:1.1
	OPENBSD_4_3:1.1.0.2
	OPENBSD_4_3_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2016.04.29.21.10.23;	author zhuk;	state dead;
branches;
next	1.1;
commitid	u9TvebbKy1wgQMr9;

1.1
date	2007.09.18.18.36.53;	author mgrimm;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Remove KDE3 applications that have well-working KDE4+ counterparts.
@
text
@$OpenBSD: patch-kioslave_audiocd_plugins_flac_encoderflac_cpp,v 1.1 2007/09/18 18:36:53 mgrimm Exp $
--- kioslave/audiocd/plugins/flac/encoderflac.cpp.orig	Sun Sep 16 21:51:43 2007
+++ kioslave/audiocd/plugins/flac/encoderflac.cpp	Sun Sep 16 22:00:43 2007
@@@@ -47,7 +47,7 @@@@ class EncoderFLAC::Private { (public)
     unsigned long data;
 };
 
-static FLAC__StreamEncoderWriteStatus WriteCallback(const FLAC__StreamEncoder *encoder, const FLAC__byte buffer[], unsigned bytes, unsigned samples, unsigned current_frame, void *client_data)
+static FLAC__StreamEncoderWriteStatus WriteCallback(const FLAC__StreamEncoder *encoder, const FLAC__byte buffer[], size_t bytes, unsigned samples, unsigned current_frame, void *client_data)
 {
     EncoderFLAC::Private *d = (EncoderFLAC::Private*)client_data;
 
@@@@ -109,9 +109,6 @@@@ unsigned long EncoderFLAC::size(long time_secs) const 
 long EncoderFLAC::readInit(long size) {
     kdDebug(7117) << "EncoderFLAC::readInit() called"<< endl;
     d->data = 0;
-    FLAC__stream_encoder_set_write_callback(d->encoder, WriteCallback);
-    FLAC__stream_encoder_set_metadata_callback(d->encoder, MetadataCallback);
-    FLAC__stream_encoder_set_client_data(d->encoder, d);
 
     // The options match approximely those of flac compression-level-3
     FLAC__stream_encoder_set_do_mid_side_stereo(d->encoder, true);
@@@@ -124,7 +121,7 @@@@ long EncoderFLAC::readInit(long size) {
     if (size > 0)
         FLAC__stream_encoder_set_total_samples_estimate(d->encoder, size/4);
 
-    FLAC__stream_encoder_init(d->encoder);
+    FLAC__stream_encoder_init_stream(d->encoder, WriteCallback, NULL, NULL, MetadataCallback, d);
     return d->data;
 }
 
@


1.1
log
@Allow kdemultimedia to build with the audio/flac update, and also fix some
unrelated LIB_DEPENDS and WANTLIB issues while here, to make
port-lib-depends-check happy (more dependencies on x11/kde/arts3 contents,
libvorbisfile, libexpat and libfontconfig):
 - Require FLAC.>=8,
 - use a sledgehammer to make configure work with the new FLAC,
 - make it work with the new API.

ok naddy@@
@
text
@d1 1
a1 1
$OpenBSD$
@

