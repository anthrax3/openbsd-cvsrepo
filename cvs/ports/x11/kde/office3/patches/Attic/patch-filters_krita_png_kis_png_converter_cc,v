head	1.2;
access;
symbols
	OPENBSD_5_5:1.1.0.12
	OPENBSD_5_5_BASE:1.1
	OPENBSD_5_4:1.1.0.10
	OPENBSD_5_4_BASE:1.1
	OPENBSD_5_3:1.1.0.8
	OPENBSD_5_3_BASE:1.1
	OPENBSD_5_2:1.1.0.6
	OPENBSD_5_2_BASE:1.1
	OPENBSD_5_1_BASE:1.1
	OPENBSD_5_1:1.1.0.4
	OPENBSD_5_0:1.1.0.2
	OPENBSD_5_0_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2014.07.11.13.50.21;	author zhuk;	state dead;
branches;
next	1.1;
commitid	7STAl57prz3S8TiW;

1.1
date	2011.07.08.20.38.00;	author naddy;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Remove KOffice. Unlike KDE3 itself, this one has no use; at least,
there is no support for modern document formats while using own one.

Also, Calligra should hit CVS soon. And this one stands before it
and updating libpqxx.

no objections from espie@@
@
text
@$OpenBSD: patch-filters_krita_png_kis_png_converter_cc,v 1.1 2011/07/08 20:38:00 naddy Exp $

Fix build with png-1.5.

--- filters/krita/png/kis_png_converter.cc.orig	Wed Jul  6 18:26:22 2011
+++ filters/krita/png/kis_png_converter.cc	Wed Jul  6 18:36:12 2011
@@@@ -221,7 +221,8 @@@@ KisImageBuilder_Result KisPNGConverter::decode(const K
     bool hasalpha = (color_type == PNG_COLOR_TYPE_RGB_ALPHA || color_type == PNG_COLOR_TYPE_GRAY_ALPHA);
     
     // Read image profile
-    png_charp profile_name, profile_data;
+    png_charp profile_name;
+    png_bytep profile_data;
     int compression_type;
     png_uint_32 proflen;
     int number_of_passes = 1;
@@@@ -627,7 +628,7 @@@@ KisImageBuilder_Result KisPNGConverter::buildFile(cons
         } else { // Profile
             char* name = new char[(*it)->type().length()+1];
             strcpy(name, (*it)->type().ascii());
-            png_set_iCCP(png_ptr, info_ptr, name, PNG_COMPRESSION_TYPE_BASE, (char*)(*it)->annotation().data(), (*it) -> annotation() . size());
+            png_set_iCCP(png_ptr, info_ptr, name, PNG_COMPRESSION_TYPE_BASE, (png_byte*)(*it)->annotation().data(), (*it) -> annotation() . size());
         }
         ++it;
     }
@@@@ -785,7 +786,7 @@@@ void KisPNGConverter::cancel()
 
 void KisPNGConverter::progress(png_structp png_ptr, png_uint_32 row_number, int pass)
 {
-    if(png_ptr == NULL || row_number > PNG_MAX_UINT || pass > 7) return;
+    if(png_ptr == NULL || row_number > PNG_UINT_31_MAX || pass > 7) return;
 //     setProgress(row_number);
 }
 
@


1.1
log
@Fix build with png-1.5.
All fixes by yours truly.
@
text
@d1 1
a1 1
$OpenBSD$
@

