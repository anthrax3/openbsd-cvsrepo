head	1.1;
access;
symbols
	OPENBSD_3_1:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2003.01.07.00.12.41;	author brad;	state dead;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2003.01.07.00.12.41;	author brad;	state Exp;
branches;
next	;


desc
@@


1.1
log
@file patch-lanbrowsing_kio_lan_kio_lan_cpp was initially added on branch OPENBSD_3_1.
@
text
@@


1.1.2.1
log
@- add patches from auditing effort for KDE 2.2
- bump PKGNAME's

http://www.kde.org/info/security/advisory-20021220-1.txt
@
text
@a0 23
$OpenBSD$
--- lanbrowsing/kio_lan/kio_lan.cpp.orig	Mon Nov  5 21:42:02 2001
+++ lanbrowsing/kio_lan/kio_lan.cpp	Sun Jan  5 21:33:22 2003
@@@@ -259,7 +259,8 @@@@ int LANProtocol::rlanReadDataFromServer(
       //should never happen
       socketname+="???";
 
-   strcpy(addr.sun_path,socketname);
+   strncpy(addr.sun_path,socketname,sizeof(addr.sun_path));
+   addr.sun_path[sizeof(addr.sun_path)-1] = '\0';
    int result=::connect(sockFD,(sockaddr*)&addr, sizeof(addr));
 
    kdDebug(7101)<<"readDataFromServer(): result: "<<result<<" name: "<<addr.sun_path<<" socket: "<<sockFD<<endl;
@@@@ -289,7 +290,8 @@@@ int LANProtocol::rlanReadDataFromServer(
 
       memset((char*)&addr,0,sizeof(addr));
       addr.sun_family=AF_LOCAL;
-      strcpy(addr.sun_path,socketname);
+      strncpy(addr.sun_path,socketname,sizeof(addr.sun_path));
+      addr.sun_path[sizeof(addr.sun_path)-1] = '\0';
 
       kdDebug(7101)<<"connecting..."<<endl;
       result=::connect(sockFD,(sockaddr*)&addr, sizeof(addr));
@

