head	1.1;
access;
symbols
	OPENBSD_3_1:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2003.01.07.00.12.40;	author brad;	state dead;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2003.01.07.00.12.40;	author brad;	state Exp;
branches;
next	;


desc
@@


1.1
log
@file patch-libkmid_fmout_cc was initially added on branch OPENBSD_3_1.
@
text
@@


1.1.2.1
log
@- add patches from auditing effort for KDE 2.2
- bump PKGNAME's

http://www.kde.org/info/security/advisory-20021220-1.txt
@
text
@a0 51
$OpenBSD$
--- libkmid/fmout.cc.orig	Mon Oct  9 18:09:23 2000
+++ libkmid/fmout.cc	Sun Jan  5 16:07:25 2003
@@@@ -34,6 +34,7 @@@@
 #include <string.h>
 #include <sys/param.h>
 #include <stdlib.h>
+#include <limits.h>
 #include "midispec.h"
 #ifdef HAVE_CONFIG_H
 #include <config.h>
@@@@ -126,8 +127,8 @@@@ void FMOut::initDev (void)
 void FMOut::loadFMPatches(void)
 {
 #ifdef HAVE_OSS_SUPPORT
-  char patchesfile[120];
-  char drumsfile[120];
+  char patchesfile[PATH_MAX];
+  char drumsfile[PATH_MAX];
   int size;
   struct sbi_instrument instr;
   char tmp[60];
@@@@ -140,12 +141,12 @@@@ void FMOut::loadFMPatches(void)
 
   if (opl==3)
   {
-    sprintf(patchesfile,"%s/std.o3",FMPatchesDirectory);
+    snprintf(patchesfile, PATH_MAX, "%s/std.o3",FMPatchesDirectory);
     size=60;
   }
   else
   {
-    sprintf(patchesfile,"%s/std.sb",FMPatchesDirectory);
+    snprintf(patchesfile, PATH_MAX, "%s/std.sb",FMPatchesDirectory);
     size=52;
   }
   fh=fopen(patchesfile,"rb");
@@@@ -170,11 +171,11 @@@@ void FMOut::loadFMPatches(void)
 
   if (opl==3)
   {
-    sprintf(drumsfile,"%s/drums.o3",FMPatchesDirectory);
+    snprintf(drumsfile, PATH_MAX, "%s/drums.o3",FMPatchesDirectory);
   }
   else
   {
-    sprintf(drumsfile,"%s/drums.sb",FMPatchesDirectory);
+    snprintf(drumsfile, PATH_MAX, "%s/drums.sb",FMPatchesDirectory);
   }
 
   fh=fopen(drumsfile,"rb");
@

