head	1.1;
access;
symbols
	OPENBSD_3_1:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2003.01.07.00.12.40;	author brad;	state dead;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2003.01.07.00.12.40;	author brad;	state Exp;
branches;
next	;


desc
@@


1.1
log
@file patch-kio_ftp_ftp_cc was initially added on branch OPENBSD_3_1.
@
text
@@


1.1.2.1
log
@- add patches from auditing effort for KDE 2.2
- bump PKGNAME's

http://www.kde.org/info/security/advisory-20021220-1.txt
@
text
@a0 15
$OpenBSD$
--- kio/ftp/ftp.cc.orig	Mon Nov  5 21:37:42 2001
+++ kio/ftp/ftp.cc	Sun Jan  5 16:07:24 2003
@@@@ -1677,7 +1677,10 @@@@ FtpEntry* Ftp::ftpParseDir( char* buffer
                     }
                     else
                       de.link = QString::null;
-
+                      
+                    if (strchr(p_name, '/'))
+                       return 0L; // Don't trick us!
+                    
                     de.access = 0;
                     de.type = S_IFREG;
                     switch ( p_access[0] ) {
@

