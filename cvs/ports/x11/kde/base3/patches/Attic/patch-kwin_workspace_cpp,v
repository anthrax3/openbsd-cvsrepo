head	1.1;
access;
symbols
	OPENBSD_3_2:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2003.04.10.18.59.40;	author brad;	state dead;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2003.04.10.18.59.40;	author brad;	state Exp;
branches;
next	;


desc
@@


1.1
log
@file patch-kwin_workspace_cpp was initially added on branch OPENBSD_3_2.
@
text
@@


1.1.2.1
log
@Fix security issue mentioned in this advisory

http://www.kde.org/info/security/advisory-20030409-1.txt

as well as applying the other security related fixes from KDE 3.0.5b.
@
text
@a0 15
$OpenBSD$
--- kwin/workspace.cpp.orig	Sun Dec 15 21:45:06 2002
+++ kwin/workspace.cpp	Wed Apr  9 23:27:35 2003
@@@@ -1389,8 +1389,9 @@@@ void Workspace::setActiveClient( Client*
     if ( menubar ) {
         menubar->show();
 	// do not cover a client that wants to stay on top with the desktop menu
-	if ( menubar->mainClient() == active_client->mainClient()
-	     || !active_client->staysOnTop())
+	if ( active_client != NULL
+            && ( menubar->mainClient() == active_client->mainClient()
+	         || !active_client->staysOnTop()))
 	    menubar->raise(); // better for FocusFollowsMouse than raiseClient(menubar)
 
         raiseElectricBorders();
@

