head	1.2;
access;
symbols
	OPENBSD_3_8:1.1.0.2
	OPENBSD_3_8_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2005.11.30.11.25.17;	author espie;	state dead;
branches;
next	1.1;

1.1
date	2005.04.04.16.08.16;	author espie;	state Exp;
branches;
next	;


desc
@@


1.2
log
@update to kde 3.5.0
@
text
@$OpenBSD: patch-kttsd_plugins_festivalint_festivalintproc_cpp,v 1.1 2005/04/04 16:08:16 espie Exp $
--- kttsd/plugins/festivalint/festivalintproc.cpp.orig	Mon Apr  4 17:46:47 2005
+++ kttsd/plugins/festivalint/festivalintproc.cpp	Mon Apr  4 18:00:53 2005
@@@@ -479,19 +479,24 @@@@ void FestivalIntProc::slotReceivedStdout
     {
         // Look for opening ( and closing ).
         buf.simplifyWhiteSpace();
-        if (buf.left(1) == "(")
-        {
-            int rightParen = buf.find(')');
-            if (rightParen > 0)
-            {
-                m_waitingQueryVoices = false;
-                // Extract contents between parens.
-                buf = buf.mid(1, rightParen - 1);
-                // Space separated list.
-                voiceCodesList = QStringList::split(" ", buf, false);
-                emitQueryVoicesFinished = true;
-            }
-        }
+		if (buf.left(3) == "nil") {
+			emitQueryVoicesFinished = true;
+			m_waitingQueryVoices = false;
+		} else {
+			if (buf.left(1) == "(")
+			{
+				int rightParen = buf.find(')');
+				if (rightParen > 0)
+				{
+					m_waitingQueryVoices = false;
+					// Extract contents between parens.
+					buf = buf.mid(1, rightParen - 1);
+					// Space separated list.
+					voiceCodesList = QStringList::split(" ", buf, false);
+					emitQueryVoicesFinished = true;
+				}
+			}
+		}
     }
     if (promptSeen)
     {
@


1.1
log
@make sure festival voice detection does not hang if there is no voice
installed yet.
@
text
@d1 1
a1 1
$OpenBSD$
@

