head	1.2;
access;
symbols
	OPENBSD_4_4:1.1.0.2
	OPENBSD_4_4_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2008.08.27.12.25.14;	author espie;	state dead;
branches;
next	1.1;

1.1
date	2008.05.29.11.58.52;	author ajacoutot;	state Exp;
branches;
next	;


desc
@@


1.2
log
@updat to 3.5.10
@
text
@$OpenBSD: patch-kmail_newfolderdialog_cpp,v 1.1 2008/05/29 11:58:52 ajacoutot Exp $
--- kmail/newfolderdialog.cpp.orig	Fri Apr 18 17:51:33 2008
+++ kmail/newfolderdialog.cpp	Fri Apr 18 17:53:44 2008
@@@@ -148,7 +148,7 @@@@ NewFolderDialog::NewFolderDialog( QWidget* parent, KMF
     }
     if ( mFolder->folderType() == KMFolderTypeCachedImap ) {
       ImapAccountBase* ai = static_cast<KMFolderCachedImap*>(mFolder->storage())->account();
-      if ( mFolder->storage() == ai->rootFolder() ) {
+      if ( ai && mFolder->storage() == ai->rootFolder() ) {
         rootFolder = true;
         namespaces = ai->namespaces()[ImapAccountBase::PersonalNS];
       }
@@@@ -212,10 +212,12 @@@@ void NewFolderDialog::slotOk()
     QString delimiter;
     if ( mFolder->folderType() == KMFolderTypeImap ) {
       KMAcctImap* ai = static_cast<KMFolderImap*>( mFolder->storage() )->account();
-      delimiter = ai->delimiterForFolder( mFolder->storage() );
+      if ( ai )
+        delimiter = ai->delimiterForFolder( mFolder->storage() );
     } else {
       KMAcctCachedImap* ai = static_cast<KMFolderCachedImap*>( mFolder->storage() )->account();
-      delimiter = ai->delimiterForFolder( mFolder->storage() );
+      if ( ai )
+        delimiter = ai->delimiterForFolder( mFolder->storage() );
     }
     if ( !delimiter.isEmpty() && fldName.find( delimiter ) != -1 ) {
       KMessageBox::error( this, i18n( "Your IMAP server does not allow the character '%1'; please choose another folder name." ).arg( delimiter ) );
@


1.1
log
@- integrate several patches:
* from openSUSE RPM: kmail-avoid-crash-on-startup.diff
* from KDE src repo:
  don't crash after changing the layout and replying;
  more guards against not yet set accounts;
  don't crash when trying to create a subfolder of a calendar folder in
    a new account

from brad@@
@
text
@d1 1
a1 1
$OpenBSD$
@

