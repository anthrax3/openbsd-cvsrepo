head	1.6;
access;
symbols
	OPENBSD_4_3:1.4.0.4
	OPENBSD_4_3_BASE:1.4
	OPENBSD_4_2:1.4.0.2
	OPENBSD_4_2_BASE:1.4
	OPENBSD_4_1:1.3.0.2
	OPENBSD_4_1_BASE:1.3
	OPENBSD_4_0:1.2.0.6
	OPENBSD_4_0_BASE:1.2
	OPENBSD_3_9:1.2.0.4
	OPENBSD_3_9_BASE:1.2
	OPENBSD_3_8:1.2.0.2
	OPENBSD_3_8_BASE:1.2
	OPENBSD_3_7:1.1.0.2
	OPENBSD_3_7_BASE:1.1;
locks; strict;
comment	@# @;


1.6
date	2008.06.09.22.55.43;	author sthen;	state dead;
branches;
next	1.5;

1.5
date	2008.04.04.00.53.01;	author jakemsr;	state Exp;
branches;
next	1.4;

1.4
date	2007.04.08.17.34.20;	author ajacoutot;	state Exp;
branches;
next	1.3;

1.3
date	2006.11.03.15.15.07;	author jolan;	state Exp;
branches;
next	1.2;

1.2
date	2005.07.31.19.07.11;	author jolan;	state Exp;
branches
	1.2.6.1;
next	1.1;

1.1
date	2005.02.20.03.28.27;	author naddy;	state Exp;
branches;
next	;

1.2.6.1
date	2007.06.26.19.26.04;	author sturm;	state Exp;
branches;
next	;


desc
@@


1.6
log
@SECURITY update vlc to 0.8.6h

- fixes *many* null pointer deref, error handling failures, leaks,
use-after-free and double-free found by Coverity

- fixes some MPEG2 TS audio packet loss

- numerous security fixes in 0.8.6g

- fixes some memory leaks

Also: mark altivec FLAVOR as broken; ajacoutot reports that the
altivec-enabled binary fails to start.

ok ajacoutot
@
text
@$OpenBSD: patch-include_vlc_threads_funcs_h,v 1.5 2008/04/04 00:53:01 jakemsr Exp $
--- include/vlc_threads_funcs.h.orig	Mon Mar 31 15:07:51 2008
+++ include/vlc_threads_funcs.h	Thu Apr  3 03:51:08 2008
@@@@ -486,8 +486,8 @@@@ static inline int __vlc_cond_wait( const char * psz_fi
     {
         /* People keep pissing me off with this. --Meuuh */
         msg_Dbg( p_condvar->p_this,
-                  "thread %u: secret message triggered "
-                  "at %s:%d (%s)", (int)pthread_self(),
+                  "thread %lu: secret message triggered "
+                  "at %s:%d (%s)", (long)pthread_self(),
                   psz_file, i_line, strerror(i_result) );
 
         i_result = pthread_cond_wait( &p_condvar->cond, &p_mutex->mutex );
@


1.5
log
@security/bugfix update

from the release notes:

VLC media player 0.8.6e and earlier versions suffer from security
vulnerabilities in the Subtitle demuxer, Real RTSP demuxer, MP4
demuxer and Cinepak codec.

from brad@@
@
text
@d1 1
a1 1
$OpenBSD: patch-include_vlc_threads_funcs_h,v 1.4 2007/04/08 17:34:20 ajacoutot Exp $
@


1.4
log
@- enable x264 support
- add missing xenocara LIBS
- regen patches while here

"go for it" naddy@@
@
text
@d1 12
a12 110
$OpenBSD: patch-include_vlc_threads_funcs_h,v 1.3 2006/11/03 15:15:07 jolan Exp $
--- include/vlc_threads_funcs.h.orig	Sat Dec  9 02:12:27 2006
+++ include/vlc_threads_funcs.h	Sun Apr  8 10:45:29 2007
@@@@ -69,7 +69,7 @@@@ static inline int __vlc_mutex_lock( const char * psz_f
 {
     int i_result;
     /* In case of error : */
-    int i_thread = -1;
+    long i_thread = -1;
     const char * psz_error = "";
 
 #if defined( PTH_INIT_IN_PTH_H )
@@@@ -111,7 +111,7 @@@@ static inline int __vlc_mutex_lock( const char * psz_f
     i_result = pthread_mutex_lock( &p_mutex->mutex );
     if ( i_result )
     {
-        i_thread = (int)pthread_self();
+        i_thread = (long)pthread_self();
         psz_error = strerror(i_result);
     }
 
@@@@ -124,7 +124,7 @@@@ static inline int __vlc_mutex_lock( const char * psz_f
     if( i_result )
     {
         msg_Err( p_mutex->p_this,
-                 "thread %u: mutex_lock failed at %s:%d (%d:%s)",
+                 "thread %lu: mutex_lock failed at %s:%d (%d:%s)",
                  i_thread, psz_file, i_line, i_result, psz_error );
     }
     return i_result;
@@@@ -141,7 +141,7 @@@@ static inline int __vlc_mutex_unlock( const char * psz
 {
     int i_result;
     /* In case of error : */
-    int i_thread = -1;
+    long i_thread = -1;
     const char * psz_error = "";
 
 #if defined( PTH_INIT_IN_PTH_H )
@@@@ -184,7 +184,7 @@@@ static inline int __vlc_mutex_unlock( const char * psz
     i_result = pthread_mutex_unlock( &p_mutex->mutex );
     if ( i_result )
     {
-        i_thread = (int)pthread_self();
+        i_thread = (long)pthread_self();
         psz_error = strerror(i_result);
     }
 
@@@@ -197,7 +197,7 @@@@ static inline int __vlc_mutex_unlock( const char * psz
     if( i_result )
     {
         msg_Err( p_mutex->p_this,
-                 "thread %u: mutex_unlock failed at %s:%d (%d:%s)",
+                 "thread %lu: mutex_unlock failed at %s:%d (%d:%s)",
                  i_thread, psz_file, i_line, i_result, psz_error );
     }
 
@@@@ -227,7 +227,7 @@@@ static inline int __vlc_cond_signal( const char * psz_
 {
     int i_result;
     /* In case of error : */
-    int i_thread = -1;
+    long i_thread = -1;
     const char * psz_error = "";
 
 #if defined( PTH_INIT_IN_PTH_H )
@@@@ -322,7 +322,7 @@@@ static inline int __vlc_cond_signal( const char * psz_
     i_result = pthread_cond_signal( &p_condvar->cond );
     if ( i_result )
     {
-        i_thread = (int)pthread_self();
+        i_thread = (long)pthread_self();
         psz_error = strerror(i_result);
     }
 
@@@@ -339,7 +339,7 @@@@ static inline int __vlc_cond_signal( const char * psz_
     if( i_result )
     {
         msg_Err( p_condvar->p_this,
-                 "thread %u: cond_signal failed at %s:%d (%d:%s)",
+                 "thread %lu: cond_signal failed at %s:%d (%d:%s)",
                  i_thread, psz_file, i_line, i_result, psz_error );
     }
 
@@@@ -357,7 +357,7 @@@@ static inline int __vlc_cond_wait( const char * psz_fi
 {
     int i_result;
     /* In case of error : */
-    int i_thread = -1;
+    long i_thread = -1;
     const char * psz_error = "";
 
 #if defined( PTH_INIT_IN_PTH_H )
@@@@ -512,7 +512,7 @@@@ static inline int __vlc_cond_wait( const char * psz_fi
 
     if ( i_result )
     {
-        i_thread = (int)pthread_self();
+        i_thread = (long)pthread_self();
         psz_error = strerror(i_result);
     }
 
@@@@ -525,7 +525,7 @@@@ static inline int __vlc_cond_wait( const char * psz_fi
     if( i_result )
     {
         msg_Err( p_condvar->p_this,
-                 "thread %u: cond_wait failed at %s:%d (%d:%s)",
+                 "thread %lu: cond_wait failed at %s:%d (%d:%s)",
                  i_thread, psz_file, i_line, i_result, psz_error );
     }
d14 1
@


1.3
log
@update to 0.8.5
@
text
@d1 4
a4 4
$OpenBSD: patch-include_vlc_threads_funcs_h,v 1.2 2005/07/31 19:07:11 jolan Exp $
--- include/vlc_threads_funcs.h.orig	Sat May  6 10:52:25 2006
+++ include/vlc_threads_funcs.h	Fri Oct 20 14:32:38 2006
@@@@ -69,7 +69,7 @@@@ static inline int __vlc_mutex_lock( cons
d13 1
a13 1
@@@@ -111,7 +111,7 @@@@ static inline int __vlc_mutex_lock( cons
d22 1
a22 1
@@@@ -124,7 +124,7 @@@@ static inline int __vlc_mutex_lock( cons
d31 1
a31 1
@@@@ -141,7 +141,7 @@@@ static inline int __vlc_mutex_unlock( co
d40 1
a40 1
@@@@ -184,7 +184,7 @@@@ static inline int __vlc_mutex_unlock( co
d49 1
a49 1
@@@@ -197,7 +197,7 @@@@ static inline int __vlc_mutex_unlock( co
d58 1
a58 1
@@@@ -227,7 +227,7 @@@@ static inline int __vlc_cond_signal( con
d67 1
a67 1
@@@@ -322,7 +322,7 @@@@ static inline int __vlc_cond_signal( con
d76 1
a76 1
@@@@ -339,7 +339,7 @@@@ static inline int __vlc_cond_signal( con
d85 1
a85 1
@@@@ -357,7 +357,7 @@@@ static inline int __vlc_cond_wait( const
d94 1
a94 1
@@@@ -512,7 +512,7 @@@@ static inline int __vlc_cond_wait( const
d103 1
a103 1
@@@@ -525,7 +525,7 @@@@ static inline int __vlc_cond_wait( const
@


1.2
log
@update to 0.8.2

main diff from jsg@@ with some tweaks from me
@
text
@d1 4
a4 4
$OpenBSD: patch-include_vlc_threads_funcs_h,v 1.1 2005/02/20 03:28:27 naddy Exp $
--- include/vlc_threads_funcs.h.orig	Sat Jun 25 23:43:15 2005
+++ include/vlc_threads_funcs.h	Sun Jul 10 11:33:17 2005
@@@@ -69,7 +69,7 @@@@ static inline int __vlc_mutex_lock( char
d13 1
a13 1
@@@@ -111,7 +111,7 @@@@ static inline int __vlc_mutex_lock( char
d22 1
a22 1
@@@@ -124,7 +124,7 @@@@ static inline int __vlc_mutex_lock( char
d31 1
a31 1
@@@@ -141,7 +141,7 @@@@ static inline int __vlc_mutex_unlock( ch
d40 1
a40 1
@@@@ -184,7 +184,7 @@@@ static inline int __vlc_mutex_unlock( ch
d49 1
a49 1
@@@@ -197,7 +197,7 @@@@ static inline int __vlc_mutex_unlock( ch
d58 1
a58 1
@@@@ -227,7 +227,7 @@@@ static inline int __vlc_cond_signal( cha
d67 1
a67 1
@@@@ -322,7 +322,7 @@@@ static inline int __vlc_cond_signal( cha
d76 1
a76 1
@@@@ -339,7 +339,7 @@@@ static inline int __vlc_cond_signal( cha
d85 1
a85 1
@@@@ -357,7 +357,7 @@@@ static inline int __vlc_cond_wait( char 
d94 1
a94 1
@@@@ -512,7 +512,7 @@@@ static inline int __vlc_cond_wait( char 
d103 1
a103 1
@@@@ -525,7 +525,7 @@@@ static inline int __vlc_cond_wait( char 
@


1.2.6.1
log
@MFC:
- SECURITY update to 0.8.6c (and various bugfixes, memory leaks)
VideoLAN-SA-0702: format string injection in Vorbis, Theora, SAP and CDDA
plugins
@
text
@d1 4
a4 4
$OpenBSD: patch-include_vlc_threads_funcs_h,v 1.2 2005/07/31 19:07:11 jolan Exp $
--- include/vlc_threads_funcs.h.orig	Sat Jun 16 16:25:18 2007
+++ include/vlc_threads_funcs.h	Tue Jun 26 20:54:43 2007
@@@@ -69,7 +69,7 @@@@ static inline int __vlc_mutex_lock( cons
d13 1
a13 1
@@@@ -111,7 +111,7 @@@@ static inline int __vlc_mutex_lock( cons
d22 1
a22 1
@@@@ -124,7 +124,7 @@@@ static inline int __vlc_mutex_lock( cons
d31 1
a31 1
@@@@ -141,7 +141,7 @@@@ static inline int __vlc_mutex_unlock( co
d40 1
a40 1
@@@@ -184,7 +184,7 @@@@ static inline int __vlc_mutex_unlock( co
d49 1
a49 1
@@@@ -197,7 +197,7 @@@@ static inline int __vlc_mutex_unlock( co
d58 1
a58 1
@@@@ -227,7 +227,7 @@@@ static inline int __vlc_cond_signal( con
d67 1
a67 1
@@@@ -322,7 +322,7 @@@@ static inline int __vlc_cond_signal( con
d76 1
a76 1
@@@@ -339,7 +339,7 @@@@ static inline int __vlc_cond_signal( con
d85 1
a85 1
@@@@ -357,7 +357,7 @@@@ static inline int __vlc_cond_wait( const
d94 1
a94 1
@@@@ -512,7 +512,7 @@@@ static inline int __vlc_cond_wait( const
d103 1
a103 1
@@@@ -525,7 +525,7 @@@@ static inline int __vlc_cond_wait( const
@


1.1
log
@* Fix build after removal of inter-library dependencies from ffmpeg.
* Use -pthread instead of -lpthread in configure.
* Fix a few pointer to int casts.

From: Jacob Meuser <jakemsr@@jakemsr.com>
@
text
@d1 3
a3 3
$OpenBSD$
--- include/vlc_threads_funcs.h.orig	Sat Nov  6 08:36:33 2004
+++ include/vlc_threads_funcs.h	Mon Feb 14 20:32:03 2005
d26 2
a27 2
-                 "thread %d: mutex_lock failed at %s:%d (%d:%s)",
+                 "thread %ld: mutex_lock failed at %s:%d (%d:%s)",
d53 2
a54 2
-                 "thread %d: mutex_unlock failed at %s:%d (%d:%s)",
+                 "thread %ld: mutex_unlock failed at %s:%d (%d:%s)",
d80 2
a81 2
-                 "thread %d: cond_signal failed at %s:%d (%d:%s)",
+                 "thread %ld: cond_signal failed at %s:%d (%d:%s)",
d107 2
a108 2
-                 "thread %d: cond_wait failed at %s:%d (%d:%s)",
+                 "thread %ld: cond_wait failed at %s:%d (%d:%s)",
@

