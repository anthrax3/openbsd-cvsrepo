head	1.8;
access;
symbols
	OPENBSD_4_7:1.7.0.8
	OPENBSD_4_7_BASE:1.7
	OPENBSD_4_6:1.7.0.6
	OPENBSD_4_6_BASE:1.7
	OPENBSD_4_5:1.7.0.4
	OPENBSD_4_5_BASE:1.7
	OPENBSD_4_4:1.7.0.2
	OPENBSD_4_4_BASE:1.7
	OPENBSD_4_3:1.6.0.4
	OPENBSD_4_3_BASE:1.6
	OPENBSD_4_2:1.6.0.2
	OPENBSD_4_2_BASE:1.6
	OPENBSD_4_1:1.5.0.2
	OPENBSD_4_1_BASE:1.5
	OPENBSD_4_0:1.3.0.4
	OPENBSD_4_0_BASE:1.3
	OPENBSD_3_9:1.3.0.2
	OPENBSD_3_9_BASE:1.3;
locks; strict;
comment	@# @;


1.8
date	2010.05.05.08.43.35;	author edd;	state dead;
branches;
next	1.7;

1.7
date	2008.06.09.22.55.43;	author sthen;	state Exp;
branches;
next	1.6;

1.6
date	2007.04.08.17.34.20;	author ajacoutot;	state Exp;
branches;
next	1.5;

1.5
date	2006.12.23.13.31.31;	author jolan;	state Exp;
branches;
next	1.4;

1.4
date	2006.11.03.15.15.07;	author jolan;	state Exp;
branches;
next	1.3;

1.3
date	2005.12.22.03.45.36;	author jolan;	state Exp;
branches
	1.3.4.1;
next	1.2;

1.2
date	2005.11.07.13.41.27;	author kurt;	state Exp;
branches;
next	1.1;

1.1
date	2005.11.06.00.33.44;	author jolan;	state Exp;
branches;
next	;

1.3.4.1
date	2007.06.26.19.26.04;	author sturm;	state Exp;
branches;
next	;


desc
@@


1.8
log
@Update to vlc-1.0.6 from maintainer Brad Smith.
OK dcoppa@@, sthen@@.
@
text
@$OpenBSD: patch-src_misc_modules_c,v 1.7 2008/06/09 22:55:43 sthen Exp $
--- src/misc/modules.c.orig	Sat May 10 12:26:00 2008
+++ src/misc/modules.c	Wed Jun  4 10:14:32 2008
@@@@ -1591,6 +1591,7 @@@@ static char * GetWindowsError( void )
  *****************************************************************************/
 static void CacheLoad( vlc_object_t *p_this )
 {
+#if 0
     char *psz_filename, *psz_homedir;
     FILE *file;
     int i, j, i_size, i_read;
@@@@ -1709,6 +1710,7 @@@@ static void CacheLoad( vlc_object_t *p_this )
     if( i_cache )
         pp_cache = p_this->p_libvlc->p_module_bank->pp_loaded_cache =
                    malloc( i_cache * sizeof(void *) );
+#endif /* 0 */
 
 #define LOAD_IMMEDIATE(a) \
     if( fread( &a, sizeof(char), sizeof(a), file ) != sizeof(a) ) goto error
@@@@ -1725,7 +1727,7 @@@@ static void CacheLoad( vlc_object_t *p_this )
       } else a = 0; \
     } while(0)
 
-
+#if 0
     for( i = 0; i < i_cache; i++ )
     {
         uint16_t i_size;
@@@@ -1801,6 +1803,7 @@@@ static void CacheLoad( vlc_object_t *p_this )
     p_this->p_libvlc->p_module_bank->i_loaded_cache = 0;
 
     fclose( file );
+#endif /* 0 */
     return;
 }
 
@


1.7
log
@SECURITY update vlc to 0.8.6h

- fixes *many* null pointer deref, error handling failures, leaks,
use-after-free and double-free found by Coverity

- fixes some MPEG2 TS audio packet loss

- numerous security fixes in 0.8.6g

- fixes some memory leaks

Also: mark altivec FLAVOR as broken; ajacoutot reports that the
altivec-enabled binary fails to start.

ok ajacoutot
@
text
@d1 1
a1 1
$OpenBSD: patch-src_misc_modules_c,v 1.6 2007/04/08 17:34:20 ajacoutot Exp $
@


1.6
log
@- enable x264 support
- add missing xenocara LIBS
- regen patches while here

"go for it" naddy@@
@
text
@d1 4
a4 4
$OpenBSD: patch-src_misc_modules_c,v 1.5 2006/12/23 13:31:31 jolan Exp $
--- src/misc/modules.c.orig	Sat Dec  9 02:12:08 2006
+++ src/misc/modules.c	Sun Apr  8 10:45:30 2007
@@@@ -1589,6 +1589,7 @@@@ static char * GetWindowsError( void )
d12 1
a12 1
@@@@ -1707,6 +1708,7 @@@@ static void CacheLoad( vlc_object_t *p_this )
d20 1
a20 1
@@@@ -1723,7 +1725,7 @@@@ static void CacheLoad( vlc_object_t *p_this )
d29 1
a29 1
@@@@ -1799,6 +1801,7 @@@@ static void CacheLoad( vlc_object_t *p_this )
@


1.5
log
@update to 0.8.6
@
text
@d1 3
a3 3
$OpenBSD: patch-src_misc_modules_c,v 1.4 2006/11/03 15:15:07 jolan Exp $
--- src/misc/modules.c.orig	Fri Dec  8 19:12:08 2006
+++ src/misc/modules.c	Sat Dec 23 03:45:09 2006
d12 1
a12 1
@@@@ -1707,6 +1708,7 @@@@ static void CacheLoad( vlc_object_t *p_t
d20 1
a20 1
@@@@ -1723,7 +1725,7 @@@@ static void CacheLoad( vlc_object_t *p_t
d29 1
a29 1
@@@@ -1799,6 +1801,7 @@@@ static void CacheLoad( vlc_object_t *p_t
@


1.4
log
@update to 0.8.5
@
text
@d1 3
a3 3
$OpenBSD: patch-src_misc_modules_c,v 1.3 2005/12/22 03:45:36 jolan Exp $
--- src/misc/modules.c.orig	Sat May  6 10:52:13 2006
+++ src/misc/modules.c	Fri Oct 20 14:32:39 2006
d28 1
a28 1
         int16_t i_size;
@


1.3
log
@update to 0.8.4a
@
text
@d1 4
a4 4
$OpenBSD$
--- src/misc/modules.c.orig	Sun Dec 11 15:36:13 2005
+++ src/misc/modules.c	Tue Dec 20 22:58:01 2005
@@@@ -1582,6 +1582,7 @@@@ static char * GetWindowsError( void )
d12 1
a12 1
@@@@ -1700,6 +1701,7 @@@@ static void CacheLoad( vlc_object_t *p_t
d20 1
a20 1
@@@@ -1716,7 +1718,7 @@@@ static void CacheLoad( vlc_object_t *p_t
d29 1
a29 1
@@@@ -1792,6 +1794,7 @@@@ static void CacheLoad( vlc_object_t *p_t
@


1.3.4.1
log
@MFC:
- SECURITY update to 0.8.6c (and various bugfixes, memory leaks)
VideoLAN-SA-0702: format string injection in Vorbis, Theora, SAP and CDDA
plugins
@
text
@d1 4
a4 4
$OpenBSD: patch-src_misc_modules_c,v 1.3 2005/12/22 03:45:36 jolan Exp $
--- src/misc/modules.c.orig	Sat Jun 16 16:25:04 2007
+++ src/misc/modules.c	Tue Jun 26 20:54:43 2007
@@@@ -1589,6 +1589,7 @@@@ static char * GetWindowsError( void )
d12 1
a12 1
@@@@ -1707,6 +1708,7 @@@@ static void CacheLoad( vlc_object_t *p_t
d20 1
a20 1
@@@@ -1723,7 +1725,7 @@@@ static void CacheLoad( vlc_object_t *p_t
d28 2
a29 2
         uint16_t i_size;
@@@@ -1799,6 +1801,7 @@@@ static void CacheLoad( vlc_object_t *p_t
@


1.2
log
@dlopen libstdc++ with lazy|global so other objects can see it and
to hide some missing _Unwind_* syms that appear to be unneeded for
this hack.
@
text
@d1 26
a26 6
$OpenBSD: patch-src_misc_modules_c,v 1.1 2005/11/06 00:33:44 jolan Exp $
--- src/misc/modules.c.orig	Sat Jun 25 09:43:02 2005
+++ src/misc/modules.c	Sun Nov  6 18:19:59 2005
@@@@ -1399,10 +1399,8 @@@@ static int LoadModule( vlc_object_t *p_t
     /* Update: FYI, this is Debian bug #180505, and seems to be fixed. */
     if( !b_kde && !strstr( psz_file, "kde" ) )
d28 8
a35 8
-        dlopen( "libstdc++.so.6", RTLD_NOW )
-         || dlopen( "libstdc++.so.5", RTLD_NOW )
-         || dlopen( "libstdc++.so.4", RTLD_NOW )
-         || dlopen( "libstdc++.so.3", RTLD_NOW );
+	/* lazy because libstdc++ expects exe to declare _Unwind_* syms */
+        dlopen( "libstdc++.so", RTLD_LAZY | RTLD_GLOBAL );
         b_kde = VLC_TRUE;
     }
@


1.1
log
@remove silly debian-specific dlopen'ing of libstdc++ workaround which
tries various major versions which we don't have, help from kurt@@
@
text
@d1 4
a4 4
$OpenBSD$
--- src/misc/modules.c.orig	Sat Jun 25 08:43:02 2005
+++ src/misc/modules.c	Sat Nov  5 17:51:12 2005
@@@@ -1399,10 +1399,7 @@@@ static int LoadModule( vlc_object_t *p_t
d12 2
a13 1
+        dlopen( "libstdc++.so", RTLD_NOW );
@

