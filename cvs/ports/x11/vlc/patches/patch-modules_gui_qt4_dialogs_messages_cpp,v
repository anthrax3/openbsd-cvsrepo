head	1.2;
access;
symbols;
locks; strict;
comment	@# @;


1.2
date	2017.05.27.08.40.14;	author ajacoutot;	state Exp;
branches;
next	1.1;
commitid	mLnSwmmPhe9po981;

1.1
date	2017.05.22.10.22.25;	author espie;	state Exp;
branches;
next	;
commitid	vsammZPigjjbsBDR;


desc
@@


1.2
log
@SECURITY update to vlc-2.2.6.

from Brad (maintainer) and a few tweaks by myself
@
text
@$OpenBSD: patch-modules_gui_qt4_dialogs_messages_cpp,v 1.1 2017/05/22 10:22:25 espie Exp $
Use qt4 atomics there, they're portable (taken from FreeBSD)

Index: modules/gui/qt4/dialogs/messages.cpp
--- modules/gui/qt4/dialogs/messages.cpp.orig
+++ modules/gui/qt4/dialogs/messages.cpp
@@@@ -145,7 +145,7 @@@@ MessagesDialog::~MessagesDialog()
 
 void MessagesDialog::changeVerbosity( int i_verbosity )
 {
-    atomic_store( &this->verbosity, i_verbosity );
+    verbosity = i_verbosity;
 }
 
 void MessagesDialog::updateConfig()
@@@@ -339,7 +339,7 @@@@ void MessagesDialog::MsgCallback( void *self, int type
 {
     MessagesDialog *dialog = (MessagesDialog *)self;
     char *str;
-    int verbosity = atomic_load( &dialog->verbosity );
+    int verbosity = dialog->verbosity;
 
     if( verbosity < 0 || verbosity < (type - VLC_MSG_ERR)
      || unlikely(vasprintf( &str, format, ap ) == -1) )
@


1.1
log
@let it build with base clang.
there's an horrible work-around because we have use_locale stubs only
in C++ mode...
@
text
@d1 1
a1 1
$OpenBSD$
d7 1
a7 1
@@@@ -143,7 +143,7 @@@@ MessagesDialog::~MessagesDialog()
d16 1
a16 1
@@@@ -337,7 +337,7 @@@@ void MessagesDialog::MsgCallback( void *self, int type
@

