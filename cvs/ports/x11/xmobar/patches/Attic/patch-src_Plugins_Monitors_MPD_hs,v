head	1.6;
access;
symbols
	OPENBSD_5_0:1.1.0.2
	OPENBSD_5_0_BASE:1.1;
locks; strict;
comment	@# @;


1.6
date	2014.10.28.17.27.15;	author dcoppa;	state dead;
branches;
next	1.5;
commitid	K6RXcG3Dd5HQLRKH;

1.5
date	2014.09.29.10.10.45;	author dcoppa;	state Exp;
branches;
next	1.4;
commitid	KnultyQpC5mcw9jY;

1.4
date	2012.09.26.07.09.20;	author dcoppa;	state dead;
branches;
next	1.3;

1.3
date	2012.09.02.22.01.26;	author kili;	state Exp;
branches;
next	1.2;

1.2
date	2012.01.12.21.42.07;	author dcoppa;	state dead;
branches;
next	1.1;

1.1
date	2011.06.13.21.23.04;	author kili;	state Exp;
branches;
next	;


desc
@@


1.6
log
@
Update to xmobar-0.22.1
@
text
@$OpenBSD: patch-src_Plugins_Monitors_MPD_hs,v 1.5 2014/09/29 10:10:45 dcoppa Exp $

commit 6b9dfabf23b7c48a86c3553a63ebb3924bea8d46
Author: jao <jao@@gnu.org>
Date:   Sun Sep 28 00:24:15 2014 +0200

Upgrade to libmpd 0.9

--- src/Plugins/Monitors/MPD.hs.orig	Mon Sep 29 11:59:33 2014
+++ src/Plugins/Monitors/MPD.hs	Mon Sep 29 12:02:26 2014
@@@@ -15,6 +15,7 @@@@
 module Plugins.Monitors.MPD ( mpdConfig, runMPD, mpdWait, mpdReady ) where
 
 import Data.List
+import Data.Maybe (fromMaybe)
 import Plugins.Monitors.Common
 import System.Console.GetOpt
 import qualified Network.MPD as M
@@@@ -71,7 +72,7 @@@@ mpdReady _ = do
     -- Only cases where MPD isn't responding is an issue; bogus information at
     -- least won't hold xmobar up.
     Left M.NoMPD    -> return False
-    Left M.TimedOut -> return False
+    Left (M.ConnectionError _) -> return False
     Left _          -> return True
 
 mopts :: [String] -> IO MOpts
@@@@ -91,8 +92,8 @@@@ parseMPD (Right st) song opts = do
   where s = M.stState st
         ss = show s
         si = stateGlyph s opts
-        vol = int2str $ M.stVolume st
-        (p, t) = M.stTime st
+        vol = int2str $ fromMaybe 0 (M.stVolume st)
+        (p, t) = fromMaybe (0, 0) (M.stTime st)
         [lap, len, remain] = map showTime [floor p, t, max 0 (t - floor p)]
         b = if t > 0 then realToFrac $ p / fromIntegral t else 0
         plen = int2str $ M.stPlaylistLength st
@


1.5
log
@
Unbreak after update to hs-libmpd-0.9.0.1
@
text
@d1 1
a1 1
$OpenBSD$
@


1.4
log
@Update to xmobar-0.15

OK kili@@
OK Jona Joachim (maintainer)
@
text
@d1 12
a12 6
$OpenBSD: patch-src_Plugins_Monitors_MPD_hs,v 1.3 2012/09/02 22:01:26 kili Exp $
--- src/Plugins/Monitors/MPD.hs.orig	Sat Dec 10 18:41:54 2011
+++ src/Plugins/Monitors/MPD.hs	Fri Jul 13 19:00:52 2012
@@@@ -102,5 +102,5 @@@@ showTime t = int2str minutes ++ ":" ++ int2str seconds
   where minutes = t `div` 60
         seconds = t `mod` 60
d14 25
a38 3
-int2str :: (Num a, Ord a) => a -> String
+int2str :: (Show a, Num a, Ord a) => a -> String
 int2str x = if x < 10 then '0':sx else sx where sx = show x
@


1.3
log
@Add fixes for ghc-7.4.
@
text
@d1 1
a1 1
$OpenBSD$
@


1.2
log
@
Update to xmobar-0.14.
Fix comment into files/Batt.hs.
Adjust WANTLIB.
Use lynx from base instead of curl for the weather plugin.

OK kili@@
@
text
@d1 10
a10 12
$OpenBSD: patch-src_Plugins_Monitors_MPD_hs,v 1.1 2011/06/13 21:23:04 kili Exp $
--- src/Plugins/Monitors/MPD.hs.orig	Mon May  2 20:48:52 2011
+++ src/Plugins/Monitors/MPD.hs	Mon May  2 20:49:06 2011
@@@@ -91,7 +91,7 @@@@ parseSong (Right Nothing) = return $ repeat ""
 parseSong (Right (Just s)) =
   let join [] = ""
       join (x:xs) = foldl (\a o -> a ++ ", " ++ o) x xs
-      str sel = maybe "" join (M.sgGet sel s)
+      str sel = maybe "" join (M.sgGetTag sel s)
       sels = [ M.Name, M.Artist, M.Composer, M.Performer
              , M.Album, M.Title, M.Track, M.Genre ]
       fields = M.sgFilePath s : map str sels
@


1.1
log
@Update to xmobar-0.13.

From maintainer Jona Joachim, based on a diff by Ido Admon.
@
text
@d1 1
a1 1
$OpenBSD$
@

