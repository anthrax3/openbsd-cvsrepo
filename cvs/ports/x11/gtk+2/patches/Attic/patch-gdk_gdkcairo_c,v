head	1.1;
access;
symbols
	OPENBSD_6_0:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2016.09.12.14.48.19;	author ajacoutot;	state dead;
branches
	1.1.2.1;
next	;
commitid	VkeKxH4Wr9KhIcGv;

1.1.2.1
date	2016.09.12.14.48.19;	author ajacoutot;	state Exp;
branches;
next	;
commitid	VkeKxH4Wr9KhIcGv;


desc
@@


1.1
log
@file patch-gdk_gdkcairo_c was initially added on branch OPENBSD_6_0.
@
text
@@


1.1.2.1
log
@SECURITY fix for CVE-2013-7447: Memory allocation integer overflow in gdk_cairo_set_source_pixbuf on large pixbufs.
@
text
@a0 18
$OpenBSD$

From 407c89863d08780861d120f8ccfc8e13582a2fda Mon Sep 17 00:00:00 2001
From: Matthias Clasen <mclasen@@redhat.com>
Date: Sat, 29 Jun 2013 22:06:54 -0400
Subject: Avoid integer overflow

--- gdk/gdkcairo.c.orig	Tue Jan 19 20:03:55 2016
+++ gdk/gdkcairo.c	Mon Sep 12 16:33:20 2016
@@@@ -211,7 +211,7 @@@@ gdk_cairo_set_source_pixbuf (cairo_t         *cr,
     format = CAIRO_FORMAT_ARGB32;
 
   cairo_stride = cairo_format_stride_for_width (format, width);
-  cairo_pixels = g_malloc (height * cairo_stride);
+  cairo_pixels = g_malloc_n (height, cairo_stride);
   surface = cairo_image_surface_create_for_data ((unsigned char *)cairo_pixels,
                                                  format,
                                                  width, height, cairo_stride);
@

