head	1.3;
access;
symbols
	OPENBSD_5_2:1.2.0.4
	OPENBSD_5_2_BASE:1.2
	OPENBSD_5_1_BASE:1.2
	OPENBSD_5_1:1.2.0.2;
locks; strict;
comment	@# @;


1.3
date	2013.01.11.08.11.26;	author dcoppa;	state dead;
branches;
next	1.2;

1.2
date	2011.12.29.16.15.53;	author dcoppa;	state Exp;
branches;
next	1.1;

1.1
date	2011.11.07.09.49.45;	author dcoppa;	state Exp;
branches;
next	;


desc
@@


1.3
log
@Update to fluxbox-1.3.3.

Tested on sparc64.
Tested by bcallah@@ on amd64 and loongson.

OK bcallah@@
@
text
@$OpenBSD: patch-src_FbTk_StringUtil_cc,v 1.2 2011/12/29 16:15:53 dcoppa Exp $

Fix out-of-range memory access
(upstream git commit 757f78035da77fb84ad4ab479506f494353029d1)

Don't return mid-routine
(upstream git commit 65cb53b68551fde7dafe97f08c90b69f972f93ef)

--- src/FbTk/StringUtil.cc.orig	Sat Oct 29 15:46:15 2011
+++ src/FbTk/StringUtil.cc	Thu Dec 29 16:39:07 2011
@@@@ -176,12 +176,13 @@@@ string expandFilename(const string &filename) {
     size_t pos = filename.find_first_not_of(" \t");
     if (pos != string::npos && filename[pos] == '~') {
         retval = getenv("HOME");
-        if (pos != filename.size()) {
+        if (pos + 1 < filename.size()) {
             // copy from the character after '~'
             retval += static_cast<const char *>(filename.c_str() + pos + 1);
         }
-    } else
-        return filename; //return unmodified value
+    } else {
+        retval = filename; //return unmodified value
+    }
 
     return retval;
 }
@


1.2
log
@Some fixes here and there, from upstream git.
@
text
@d1 1
a1 1
$OpenBSD: patch-src_FbTk_StringUtil_cc,v 1.1 2011/11/07 09:49:45 dcoppa Exp $
@


1.1
log
@Fix out-of-range memory access
(upstream git commit 757f78035da77fb84ad4ab479506f494353029d1)
@
text
@d1 1
a1 1
$OpenBSD$
d6 6
a11 3
--- src/FbTk/StringUtil.cc.orig	Mon Nov  7 10:42:16 2011
+++ src/FbTk/StringUtil.cc	Mon Nov  7 10:43:15 2011
@@@@ -176,7 +176,7 @@@@ string expandFilename(const string &filename) {
d20 8
@

