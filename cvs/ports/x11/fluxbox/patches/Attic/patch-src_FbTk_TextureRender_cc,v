head	1.5;
access;
symbols
	OPENBSD_5_3:1.4.0.2
	OPENBSD_5_3_BASE:1.4
	OPENBSD_5_2:1.1.0.2
	OPENBSD_5_2_BASE:1.1;
locks; strict;
comment	@# @;


1.5
date	2013.04.16.15.27.03;	author bcallah;	state dead;
branches;
next	1.4;

1.4
date	2013.01.21.09.49.20;	author dcoppa;	state Exp;
branches;
next	1.3;

1.3
date	2013.01.14.15.57.56;	author dcoppa;	state Exp;
branches;
next	1.2;

1.2
date	2013.01.11.08.11.26;	author dcoppa;	state dead;
branches;
next	1.1;

1.1
date	2012.04.22.15.52.35;	author dcoppa;	state Exp;
branches;
next	;


desc
@@


1.5
log
@Update x11/fluxbox to 1.3.5
ok gonzalo@@
@
text
@$OpenBSD: patch-src_FbTk_TextureRender_cc,v 1.4 2013/01/21 09:49:20 dcoppa Exp $

Fix bug: actually invert a given Texture (stupid typo)
(upstream git commit bf5da7f1b6e87f574774558700d066d9cff1f436)

Bugfix: ensure textures have the correct size before applying 'bevel'
(upstream git commit 239e895826b2f843bc50cc6fef8108db174c33e8)

--- src/FbTk/TextureRender.cc.orig	Mon Dec 10 18:26:54 2012
+++ src/FbTk/TextureRender.cc	Mon Jan 21 10:21:35 2013
@@@@ -264,7 +264,7 @@@@ void invertRGB(unsigned int w, unsigned int h, FbTk::R
     FbTk::RGBA* r = rgba + (w * h);
 
     for (--r; l < r; ++l, --r) { // swapping 32bits (RGBA) at ones.
-        std::swap(*((unsigned int*)r), *(unsigned int*)r);
+        std::swap(*((unsigned int*)l), *(unsigned int*)r);
     }
 }
 
@@@@ -916,25 +916,25 @@@@ Pixmap TextureRender::renderSolid(const FbTk::Texture 
 
     if (texture.type() & Texture::INTERLACED) {
         lgc.setForeground(texture.colorTo());
-        register unsigned int i = 0;
-        for (; i < height; i += 2)
+        unsigned int i;
+        for (i = 0; i < height; i += 2)
             pixmap.drawLine(lgc.gc(), 0, i, width - 1, i);
 
     }
 
     lgc.setForeground(texture.loColor());
 
-    if (texture.type() & Texture::BEVEL1) {
+    if (height > 1 && width > 1 && texture.type() & Texture::BEVEL1) {
         if (texture.type() & Texture::RAISED) {
             drawBevelRectangle(pixmap, lgc.gc(), hgc.gc(), 0, height - 1, width -1 , 0);
         } else if (texture.type() & Texture::SUNKEN) {
             drawBevelRectangle(pixmap, hgc.gc(), lgc.gc(), 0, height - 1, width - 1, 0);
         }
-    } else if (texture.type() & Texture::BEVEL2) {
+    } else if (width > 2 && height > 2 && texture.type() & Texture::BEVEL2) {
         if (texture.type() & Texture::RAISED) {
-            drawBevelRectangle(pixmap, lgc.gc(), hgc.gc(), 1, height - 3, width - 3, 1);
+            drawBevelRectangle(pixmap, lgc.gc(), hgc.gc(), 1, height - 2, width - 2, 1);
         } else if (texture.type() & Texture::SUNKEN) {
-            drawBevelRectangle(pixmap, hgc.gc(), lgc.gc(), 1, height - 3, width - 3, 1);
+            drawBevelRectangle(pixmap, hgc.gc(), lgc.gc(), 1, height - 2, width - 2, 1);
         }
     }
 
@


1.4
log
@Another round of bug fixes:

Simplifies and fix bugs in FbTk::Timer
(upstream git commit 33161595f482d0dad950ce127b6016eefe8ea691)

Fix bug: actually invert a given Texture (stupid typo)
(upstream git commit bf5da7f1b6e87f574774558700d066d9cff1f436)
@
text
@d1 1
a1 1
$OpenBSD: patch-src_FbTk_TextureRender_cc,v 1.3 2013/01/14 15:57:56 dcoppa Exp $
@


1.3
log
@Bugfix: ensure textures have the correct size before applying 'bevel'
(upstream git commit 239e895826b2f843bc50cc6fef8108db174c33e8)
@
text
@d1 4
a4 1
$OpenBSD$
d10 10
a19 1
+++ src/FbTk/TextureRender.cc	Mon Jan 14 16:14:03 2013
@


1.2
log
@Update to fluxbox-1.3.3.

Tested on sparc64.
Tested by bcallah@@ on amd64 and loongson.

OK bcallah@@
@
text
@d1 1
a1 1
$OpenBSD: patch-src_FbTk_TextureRender_cc,v 1.1 2012/04/22 15:52:35 dcoppa Exp $
d3 2
a4 2
Bugfix: don't draw the interlace lines 1px too far
(upstream git commit 56af5a163513abf0c379c164e6d6c4960957a065)
d6 5
a10 3
--- src/FbTk/TextureRender.cc.orig	Sun Apr 22 17:39:27 2012
+++ src/FbTk/TextureRender.cc	Sun Apr 22 17:40:06 2012
@@@@ -1427,7 +1427,7 @@@@ Pixmap TextureRender::renderSolid(const FbTk::Texture 
d12 9
a20 4
         register unsigned int i = 0;
         for (; i < height; i += 2)
-            pixmap.drawLine(lgc.gc(), 0, i, width, i);
+            pixmap.drawLine(lgc.gc(), 0, i, width - 1, i);
d22 16
@


1.1
log
@Bugfix: don't draw the interlace lines 1px too far
(upstream git commit 56af5a163513abf0c379c164e6d6c4960957a065)
@
text
@d1 1
a1 1
$OpenBSD$
@

