head	1.6;
access;
symbols
	OPENBSD_6_0:1.5.0.6
	OPENBSD_6_0_BASE:1.5
	OPENBSD_5_9:1.5.0.2
	OPENBSD_5_9_BASE:1.5
	OPENBSD_5_8:1.5.0.4
	OPENBSD_5_8_BASE:1.5
	OPENBSD_5_7:1.4.0.4
	OPENBSD_5_7_BASE:1.4
	OPENBSD_5_6:1.4.0.2
	OPENBSD_5_6_BASE:1.4
	OPENBSD_5_5:1.3.0.2
	OPENBSD_5_5_BASE:1.3
	OPENBSD_5_4:1.2.0.2
	OPENBSD_5_4_BASE:1.2
	OPENBSD_5_3:1.1.0.2
	OPENBSD_5_3_BASE:1.1;
locks; strict;
comment	@# @;


1.6
date	2016.11.13.20.46.23;	author dcoppa;	state Exp;
branches;
next	1.5;
commitid	YWcsP0rJp2QqdVhK;

1.5
date	2015.03.17.15.39.47;	author dcoppa;	state Exp;
branches;
next	1.4;
commitid	WQl7M1uD6B2NjHh4;

1.4
date	2014.07.11.15.49.58;	author dcoppa;	state Exp;
branches;
next	1.3;
commitid	dpkYaZL7eWFGPiTd;

1.3
date	2013.08.13.10.01.54;	author dcoppa;	state Exp;
branches;
next	1.2;

1.2
date	2013.05.16.18.42.30;	author dcoppa;	state Exp;
branches;
next	1.1;

1.1
date	2012.12.13.12.10.13;	author dcoppa;	state Exp;
branches;
next	;


desc
@@


1.6
log
@
Update to i3-4.13

OK tb@@, jasper@@
@
text
@$OpenBSD: patch-i3-dmenu-desktop,v 1.5 2015/03/17 15:39:47 dcoppa Exp $
--- i3-dmenu-desktop.orig	Tue Nov  8 19:54:01 2016
+++ i3-dmenu-desktop	Thu Nov 10 18:04:35 2016
@@@@ -111,7 +111,7 @@@@ $xdg_data_home = $ENV{HOME} . '/.local/share' if
     ! -d $xdg_data_home;
 
 my $xdg_data_dirs = $ENV{XDG_DATA_DIRS};
-$xdg_data_dirs = '/usr/local/share/:/usr/share/' if
+$xdg_data_dirs = '${LOCALBASE}/share/' if
     !defined($xdg_data_dirs) ||
     $xdg_data_dirs eq '';
 
@@@@ -213,12 +213,12 @@@@ for my $file (values %desktops) {
 #     'evince.desktop' => {
 #         'Exec' => 'evince %U',
 #         'Name' => 'Dokumentenbetrachter',
-#         '_Location' => '/usr/share/applications/evince.desktop'
+#         '_Location' => '${LOCALBASE}/share/applications/evince.desktop'
 #       },
 #     'gedit.desktop' => {
 #         'Exec' => 'gedit %U',
 #         'Name' => 'gedit',
-#         '_Location' => '/usr/share/applications/gedit.desktop'
+#         '_Location' => '${LOCALBASE}/share/applications/gedit.desktop'
 #       }
 #   };
 
@@@@ -424,7 +424,7 @@@@ if (exists($app->{Terminal}) && $app->{Terminal}) {
     # we need to create a temporary script that contains the full command line
     # as the syntax for starting commands with arguments varies from terminal
     # emulator to terminal emulator.
-    # Then, we launch that script with i3-sensible-terminal.
+    # Then, we launch that script with xterm.
     my ($fh, $filename) = tempfile();
     binmode($fh, ':utf8');
     say $fh <<EOT;
@@@@ -435,7 +435,7 @@@@ EOT
     close($fh);
     chmod 0755, $filename;
 
-    $cmd = qq|exec i3-sensible-terminal -e "$filename"|;
+    $cmd = qq|exec ${X11BASE}/bin/xterm -e "$filename"|;
 } else {
     # i3 executes applications by passing the argument to i3’s “exec” command
     # as-is to $SHELL -c. The i3 parser supports quoted strings: When a string
@@@@ -476,7 +476,7 @@@@ notifications.
 
 The .desktop files are searched in $XDG_DATA_HOME/applications (by default
 $HOME/.local/share/applications) and in the "applications" subdirectory of each
-entry of $XDG_DATA_DIRS (by default /usr/local/share/:/usr/share/).
+entry of $XDG_DATA_DIRS (by default ${LOCALBASE}/share/).
 
 Files with the same name in $XDG_DATA_HOME/applications take precedence over
 files in $XDG_DATA_DIRS, so that you can overwrite parts of the system-wide
@@@@ -490,7 +490,7 @@@@ file respectively) by appending it to the name of the 
 want to launch "GNU Emacs 24" with the patch /tmp/foobar.txt, you would type
 "emacs", press TAB, type " /tmp/foobar.txt" and press ENTER.
 
-.desktop files with Terminal=true are started using i3-sensible-terminal(1).
+.desktop files with Terminal=true are started using xterm(1).
 
 .desktop files with NoDisplay=true or Hidden=true are skipped.
 
@


1.5
log
@
Update to i3-4.9.1

new dependency on x11/xkbcommon
@
text
@d1 4
a4 4
$OpenBSD: patch-i3-dmenu-desktop,v 1.4 2014/07/11 15:49:58 dcoppa Exp $
--- i3-dmenu-desktop.orig	Sun Jun 15 19:12:43 2014
+++ i3-dmenu-desktop	Fri Jul 11 16:49:32 2014
@@@@ -107,7 +107,7 @@@@ $xdg_data_home = $ENV{HOME} . '/.local/share' if
d13 1
a13 1
@@@@ -209,12 +209,12 @@@@ for my $file (values %desktops) {
d28 1
a28 1
@@@@ -420,7 +420,7 @@@@ if (exists($app->{Terminal}) && $app->{Terminal}) {
d37 1
a37 1
@@@@ -431,7 +431,7 @@@@ EOT
d46 1
a46 1
@@@@ -472,7 +472,7 @@@@ notifications.
d55 1
a55 1
@@@@ -486,7 +486,7 @@@@ file respectively) by appending it to the name of the 
@


1.4
log
@
Update to i3-4.8 plus fixes.

Initial diff by Theo Buehler <theo AT math DOT ethz DOT ch>
@
text
@d1 1
a1 8
$OpenBSD: patch-i3-dmenu-desktop,v 1.3 2013/08/13 10:01:54 dcoppa Exp $

commit 9b0ec8b2ae56e3a66487ac420eca236f64aa4c4c
Author: Michael Stapelberg <michael@@stapelberg.de>
Date:   Fri Jul 11 09:51:05 2014 +0200

Bugfix: i3-dmenu-desktop: quote path

a27 9
@@@@ -410,7 +410,7 @@@@ $exec =~ s/%k/$location/g;
 $exec =~ s/%%/%/g;
 
 if (exists($app->{Path}) && $app->{Path} ne '') {
-    $exec = 'cd ' . $app->{Path} . ' && ' . $exec;
+    $exec = 'cd ' . quote($app->{Path}) . ' && ' . $exec;
 }
 
 my $nosn = '';
@


1.3
log
@Update to i3-4.6

ok tobiasu@@, abieber@@
@
text
@d1 11
a11 4
$OpenBSD: patch-i3-dmenu-desktop,v 1.2 2013/05/16 18:42:30 dcoppa Exp $
--- i3-dmenu-desktop.orig	Wed Aug  7 20:50:24 2013
+++ i3-dmenu-desktop	Mon Aug 12 15:19:02 2013
@@@@ -103,7 +103,7 @@@@ $xdg_data_home = $ENV{HOME} . '/.local/share' if
d20 1
a20 1
@@@@ -205,12 +205,12 @@@@ for my $file (values %desktops) {
d35 10
a44 1
@@@@ -415,7 +415,7 @@@@ if (exists($app->{Terminal}) && $app->{Terminal}) {
d53 1
a53 1
@@@@ -426,7 +426,7 @@@@ EOT
d62 1
a62 1
@@@@ -467,7 +467,7 @@@@ notifications.
d71 1
a71 1
@@@@ -481,7 +481,7 @@@@ file respectively) by appending it to the name of the 
@


1.2
log
@Update to i3-4.5.1

ok jasper@@, abieber@@
@
text
@d1 3
a3 3
$OpenBSD: patch-i3-dmenu-desktop,v 1.1 2012/12/13 12:10:13 dcoppa Exp $
--- i3-dmenu-desktop.orig	Mon Mar 18 22:43:36 2013
+++ i3-dmenu-desktop	Mon May 13 08:27:23 2013
d13 1
a13 1
@@@@ -204,12 +204,12 @@@@ for my $file (values %desktops) {
d28 1
a28 1
@@@@ -404,7 +404,7 @@@@ if (exists($app->{Terminal}) && $app->{Terminal}) {
d37 1
a37 1
@@@@ -415,7 +415,7 @@@@ EOT
d46 1
a46 1
@@@@ -456,7 +456,7 @@@@ notifications.
d55 1
a55 1
@@@@ -470,7 +470,7 @@@@ file respectively) by appending it to the name of the 
@


1.1
log
@Update to i3-4.4
@
text
@d1 4
a4 4
$OpenBSD$
--- i3-dmenu-desktop.orig	Thu Dec 13 09:55:16 2012
+++ i3-dmenu-desktop	Thu Dec 13 10:00:16 2012
@@@@ -88,7 +88,7 @@@@ $xdg_data_home = $ENV{HOME} . '/.local/share' if
d13 1
a13 1
@@@@ -187,12 +187,12 @@@@ for my $file (values %desktops) {
d28 1
a28 1
@@@@ -355,7 +355,7 @@@@ if (exists($app->{Terminal}) && $app->{Terminal}) {
d37 1
a37 1
@@@@ -366,7 +366,7 @@@@ EOT
d46 1
a46 1
@@@@ -407,7 +407,7 @@@@ notifications.
d55 1
a55 1
@@@@ -421,7 +421,7 @@@@ file respectively) by appending it to the name of the 
@

