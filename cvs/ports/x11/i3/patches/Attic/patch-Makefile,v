head	1.8;
access;
symbols
	OPENBSD_5_3:1.7.0.2
	OPENBSD_5_3_BASE:1.7
	OPENBSD_5_2:1.6.0.2
	OPENBSD_5_2_BASE:1.6
	OPENBSD_5_1_BASE:1.5
	OPENBSD_5_1:1.5.0.2
	OPENBSD_5_0:1.3.0.4
	OPENBSD_5_0_BASE:1.3
	OPENBSD_4_9:1.3.0.2
	OPENBSD_4_9_BASE:1.3
	OPENBSD_4_8:1.2.0.4
	OPENBSD_4_8_BASE:1.2
	OPENBSD_4_7:1.2.0.2
	OPENBSD_4_7_BASE:1.2
	landry_20090902:1.1.1.1
	bapt:1.1.1;
locks; strict;
comment	@# @;


1.8
date	2013.06.02.11.24.06;	author dcoppa;	state dead;
branches;
next	1.7;

1.7
date	2012.09.21.17.16.14;	author dcoppa;	state Exp;
branches;
next	1.6;

1.6
date	2012.05.09.11.56.49;	author dcoppa;	state Exp;
branches;
next	1.5;

1.5
date	2011.12.01.16.00.01;	author dcoppa;	state Exp;
branches;
next	1.4;

1.4
date	2011.11.06.20.23.25;	author dcoppa;	state Exp;
branches;
next	1.3;

1.3
date	2010.09.14.08.54.18;	author dcoppa;	state Exp;
branches;
next	1.2;

1.2
date	2009.09.02.20.05.34;	author bernd;	state Exp;
branches;
next	1.1;

1.1
date	2009.09.02.19.26.17;	author landry;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2009.09.02.19.26.17;	author landry;	state Exp;
branches;
next	;


desc
@@


1.8
log
@Enable SHM logging, now that we have shm_open() and friends.

ok jasper@@
@
text
@$OpenBSD: patch-Makefile,v 1.7 2012/09/21 17:16:14 dcoppa Exp $
--- Makefile.orig	Thu Sep 20 10:37:01 2012
+++ Makefile	Thu Sep 20 10:40:12 2012
@@@@ -18,7 +18,10 @@@@ include i3-msg/i3-msg.mk
 include i3-input/i3-input.mk
 include i3-nagbar/i3-nagbar.mk
 include i3bar/i3bar.mk
+# XXX OpenBSD lacks POSIX shared memory support, so no i3-dump-log
+ifneq ($(UNAME),OpenBSD)
 include i3-dump-log/i3-dump-log.mk
+endif
 include docs/docs.mk
 include man/man.mk
 
@


1.7
log
@Update to i3-4.3

OK jasper@@
@
text
@d1 1
a1 1
$OpenBSD: patch-Makefile,v 1.6 2012/05/09 11:56:49 dcoppa Exp $
@


1.6
log
@Update to i3-4.2

OK jasper@@
@
text
@d1 7
a7 7
$OpenBSD: patch-Makefile,v 1.5 2011/12/01 16:00:01 dcoppa Exp $
--- Makefile.orig	Wed Apr 25 23:21:25 2012
+++ Makefile	Wed May  9 12:40:11 2012
@@@@ -19,7 +19,12 @@@@ else
 UNUSED:=$(shell $(MAKE) loglevels.h)
 endif
 
d9 2
a10 4
+ifeq ($(UNAME),OpenBSD)
+SUBDIRS:=i3-msg i3-input i3-nagbar i3-config-wizard i3bar
+else
 SUBDIRS:=i3-msg i3-input i3-nagbar i3-config-wizard i3bar i3-dump-log
d12 2
a14 45
 # Depend on the specific file (.c for each .o) and on all headers
 src/%.o: src/%.c ${HEADERS}
@@@@ -44,7 +49,7 @@@@ subdirs:
 
 loglevels.h:
 	echo "[i3] LOGLEVELS"
-	for file in $$(ls src/*.c src/*.y src/*.l | grep -v 'cfgparse.\(tab\|yy\).c'); \
+	for file in $$(ls src/*.c src/*.y src/*.l | grep -v cfgparse.tab.c | grep -v cfgparse.yy.c); \
 	do \
 		echo $$(basename $$file .c); \
 	done > loglevels.tmp
@@@@ -67,7 +72,7 @@@@ include/GENERATED_tokens.h: include/GENERATED_call.h
 # and once as an object file for i3.
 src/commands_parser.o: src/commands_parser.c ${HEADERS} ${CMDPARSE_HEADERS}
 	echo "[i3] CC $<"
-	$(CC) $(CPPFLAGS) $(CFLAGS) -DTEST_PARSER -DLOGLEVEL="((uint64_t)1 << $(shell awk '/$(shell basename $< .c)/ { print NR; exit 0; }' loglevels.tmp))" -o test.commands_parser $< $(LIBS)
+	$(CC) $(CPPFLAGS) $(CFLAGS) $(LDFLAGS) -DTEST_PARSER -DLOGLEVEL="((uint64_t)1 << $(shell awk '/$(shell basename $< .c)/ { print NR; exit 0; }' loglevels.tmp))" -o test.commands_parser $< $(LIBS)
 	$(CC) $(CPPFLAGS) $(CFLAGS) -DLOGLEVEL="((uint64_t)1 << $(shell awk '/$(shell basename $< .c)/ { print NR; exit 0; }' loglevels.tmp))" -c -o $@@ $<
 
 src/cfgparse.yy.o: src/cfgparse.l src/cfgparse.y.o ${HEADERS}
@@@@ -89,17 +94,13 @@@@ install: all
 	$(INSTALL) -d -m 0755 $(DESTDIR)$(PREFIX)/include/i3
 	$(INSTALL) -d -m 0755 $(DESTDIR)$(PREFIX)/share/xsessions
 	$(INSTALL) -d -m 0755 $(DESTDIR)$(PREFIX)/share/applications
-	$(INSTALL) -m 0755 i3 $(DESTDIR)$(PREFIX)/bin/
-	$(INSTALL) -m 0755 i3-migrate-config-to-v4 $(DESTDIR)$(PREFIX)/bin/
-	$(INSTALL) -m 0755 i3-sensible-editor $(DESTDIR)$(PREFIX)/bin/
-	$(INSTALL) -m 0755 i3-sensible-pager $(DESTDIR)$(PREFIX)/bin/
-	$(INSTALL) -m 0755 i3-sensible-terminal $(DESTDIR)$(PREFIX)/bin/
-	test -e $(DESTDIR)$(SYSCONFDIR)/i3/config || $(INSTALL) -m 0644 i3.config $(DESTDIR)$(SYSCONFDIR)/i3/config
-	test -e $(DESTDIR)$(SYSCONFDIR)/i3/config.keycodes || $(INSTALL) -m 0644 i3.config.keycodes $(DESTDIR)$(SYSCONFDIR)/i3/config.keycodes
-	$(INSTALL) -m 0644 i3.welcome $(DESTDIR)$(SYSCONFDIR)/i3/welcome
-	$(INSTALL) -m 0644 i3.xsession.desktop $(DESTDIR)$(PREFIX)/share/xsessions/i3.desktop
-	$(INSTALL) -m 0644 i3.applications.desktop $(DESTDIR)$(PREFIX)/share/applications/i3.desktop
-	$(INSTALL) -m 0644 include/i3/ipc.h $(DESTDIR)$(PREFIX)/include/i3/
+	${INSTALL_PROGRAM} i3 $(DESTDIR)$(PREFIX)/bin/
+	${INSTALL_SCRIPT} i3-migrate-config-to-v4 $(DESTDIR)$(PREFIX)/bin/
+	${INSTALL_DATA} i3.config $(DESTDIR)$(SYSCONFDIR)/i3/config
+	${INSTALL_DATA} i3.config.keycodes $(DESTDIR)$(SYSCONFDIR)/i3/config.keycodes
+	${INSTALL_DATA} i3.xsession.desktop $(DESTDIR)$(PREFIX)/share/xsessions/i3.desktop
+	${INSTALL_DATA} i3.applications.desktop $(DESTDIR)$(PREFIX)/share/applications/i3.desktop
+	${INSTALL_DATA} include/i3/ipc.h $(DESTDIR)$(PREFIX)/include/i3/
 	for dir in $(SUBDIRS); do \
 		$(MAKE) -C $$dir install; \
 	done
@


1.5
log
@Major update to i3-4.1
@
text
@d1 13
a13 4
$OpenBSD: patch-Makefile,v 1.4 2011/11/06 20:23:25 dcoppa Exp $
--- Makefile.orig	Fri Nov 11 23:41:20 2011
+++ Makefile	Thu Dec  1 14:48:23 2011
@@@@ -22,13 +22,11 @@@@ SUBDIRS:=i3-msg i3-input i3-nagbar i3-config-wizard i3
d17 1
a17 18
-	echo "[i3] CC $<"
 	$(CC) $(CPPFLAGS) $(CFLAGS) -DLOGLEVEL="((uint64_t)1 << $(shell awk '/$(shell basename $< .c)/ { print NR; exit 0; }' loglevels.tmp))" -c -o $@@ $<
 
 all: i3 subdirs
 
 i3: libi3/libi3.a src/cfgparse.y.o src/cfgparse.yy.o src/cmdparse.y.o src/cmdparse.yy.o ${FILES}
-	echo "[i3] LINK i3"
 	$(CC) $(LDFLAGS) -o $@@ $(filter-out libi3/libi3.a,$^) $(LIBS)
 
 libi3/%.a: libi3/*.c
@@@@ -36,13 +34,10 @@@@ libi3/%.a: libi3/*.c
 
 subdirs:
 	for dir in $(SUBDIRS); do \
-		echo ""; \
-		echo "MAKE $$dir"; \
 		$(MAKE) -C $$dir; \
 	done
d20 3
a22 2
-	echo "[i3] LOGLEVELS"
 	for file in $$(ls src/*.c src/*.y src/*.l | grep -v 'cfgparse.\(tab\|yy\).c'); \
d25 8
a32 2
@@@@ -54,43 +49,34 @@@@ loglevels.h:
 	echo "};") > include/loglevels.h;
d35 1
a35 27
-	echo "[i3] LEX $<"
-	flex -i -o$(@@:.o=.c) $<
+	gflex -i -o$(@@:.o=.c) $<
 	$(CC) $(CPPFLAGS) $(CFLAGS) -DLOGLEVEL="(1 << $(shell awk '/cfgparse.l/ { print NR }' loglevels.tmp))" -c -o $@@ $(@@:.o=.c)
 
 src/cmdparse.yy.o: src/cmdparse.l src/cmdparse.y.o ${HEADERS}
-	echo "[i3] LEX $<"
-	flex -Pcmdyy -i -o$(@@:.o=.c) $<
+	gflex -Pcmdyy -i -o$(@@:.o=.c) $<
 	$(CC) $(CPPFLAGS) $(CFLAGS) -DLOGLEVEL="(1 << $(shell awk '/cmdparse.l/ { print NR }' loglevels.tmp))" -c -o $@@ $(@@:.o=.c)
 
 
 src/cfgparse.y.o: src/cfgparse.y ${HEADERS}
-	echo "[i3] YACC $<"
 	bison --debug --verbose -b $(basename $< .y) -d $<
 	$(CC) $(CPPFLAGS) $(CFLAGS) -DLOGLEVEL="(1 << $(shell awk '/cfgparse.y/ { print NR }' loglevels.tmp))" -c -o $@@ $(<:.y=.tab.c)
 
 src/cmdparse.y.o: src/cmdparse.y ${HEADERS}
-	echo "[i3] YACC $<"
 	bison -p cmdyy --debug --verbose -b $(basename $< .y) -d $<
 	$(CC) $(CPPFLAGS) $(CFLAGS) -DLOGLEVEL="(1 << $(shell awk '/cmdparse.y/ { print NR }' loglevels.tmp))" -c -o $@@ $(<:.y=.tab.c)
 
 
 install: all
-	echo "[i3] INSTALL"
 	$(INSTALL) -d -m 0755 $(DESTDIR)$(PREFIX)/bin
 	$(INSTALL) -d -m 0755 $(DESTDIR)$(SYSCONFDIR)/i3
d38 1
d47 2
a48 1
-	$(INSTALL) -m 0644 i3.desktop $(DESTDIR)$(PREFIX)/share/xsessions/
d52 4
a55 3
+	test -e $(DESTDIR)$(SYSCONFDIR)/i3/config || ${INSTALL_DATA} i3.config $(DESTDIR)$(SYSCONFDIR)/i3/config
+	test -e $(DESTDIR)$(SYSCONFDIR)/i3/config.keycodes || ${INSTALL_DATA} i3.config.keycodes $(DESTDIR)$(SYSCONFDIR)/i3/config.keycodes
+	${INSTALL_DATA} i3.desktop $(DESTDIR)$(PREFIX)/share/xsessions/
a59 17
@@@@ -127,16 +113,12 @@@@ clean:
 	$(MAKE) -C docs clean
 	$(MAKE) -C man clean
 	for dir in $(SUBDIRS); do \
-		echo ""; \
-		echo "CLEAN $$dir"; \
 		$(MAKE) TOPDIR=$(TOPDIR) -C $$dir distclean; \
 	done
 
 distclean: clean
 	rm -f i3
 	for dir in $(SUBDIRS); do \
-		echo ""; \
-		echo "DISTCLEAN $$dir"; \
 		$(MAKE) TOPDIR=$(TOPDIR) -C $$dir distclean; \
 	done
 
@


1.4
log
@Update to i3-4.0.2 (plus patches from upstream git).
i3bar is now part of i3 itself and i3-wsbar is gone.
@
text
@d1 4
a4 4
$OpenBSD: patch-Makefile,v 1.3 2010/09/14 08:54:18 dcoppa Exp $
--- Makefile.orig	Wed Sep 14 11:28:41 2011
+++ Makefile	Wed Sep 14 11:34:03 2011
@@@@ -22,24 +22,19 @@@@ SUBDIRS=i3-msg i3-input i3-nagbar i3-config-wizard i3b
d8 1
a8 1
-	echo "CC $<"
d13 6
a18 3
 i3: src/cfgparse.y.o src/cfgparse.yy.o src/cmdparse.y.o src/cmdparse.yy.o ${FILES}
-	echo "LINK i3"
 	$(CC) $(LDFLAGS) -o $@@ $^ $(LIBS)
d28 1
a28 1
-	echo "LOGLEVELS"
d32 1
a32 1
@@@@ -51,40 +46,35 @@@@ loglevels.h:
d36 1
a36 1
-	echo "LEX $<"
d42 1
a42 1
-	echo "LEX $<"
d49 1
a49 1
-	echo "YACC $<"
d54 1
a54 1
-	echo "YACC $<"
d60 1
a60 1
-	echo "INSTALL"
d67 3
a78 1
+	${INSTALL_DATA} i3.welcome $(DESTDIR)$(SYSCONFDIR)/i3/welcome
d84 1
a84 1
@@@@ -120,16 +110,12 @@@@ clean:
@


1.3
log
@Update to i3-3.5.1

resolve_tilde() function by Christopher Zimmermann
(madroach AT zakweb DOT de): thanks!

OK landry@@
@
text
@d1 4
a4 4
$OpenBSD$
--- Makefile.orig	Wed Jun  9 09:58:15 2010
+++ Makefile	Mon Jul 19 17:07:45 2010
@@@@ -20,20 +20,14 @@@@ endif
d9 1
a9 1
 	$(CC) $(CFLAGS) -DLOGLEVEL="(1 << $(shell awk '/$(shell basename $< .c)/ { print NR }' loglevels.tmp))" -c -o $@@ $<
d11 3
a13 1
 all: src/cfgparse.y.o src/cfgparse.yy.o ${FILES}
d15 8
a22 6
 	$(CC) -o i3 ${FILES} src/cfgparse.y.o src/cfgparse.yy.o $(LDFLAGS)
-	echo ""
-	echo "SUBDIR i3-msg"
 	$(MAKE) TOPDIR=$(TOPDIR) -C i3-msg
-	echo "SUBDIR i3-input"
 	$(MAKE) TOPDIR=$(TOPDIR) -C i3-input
d29 1
a29 1
@@@@ -45,27 +39,24 @@@@ loglevels.h:
d34 10
a43 2
 	flex -i -o$(@@:.o=.c) $<
 	$(CC) $(CFLAGS) -DLOGLEVEL="(1 << $(shell awk '/cfgparse.l/ { print NR }' loglevels.tmp))" -c -o $@@ $(@@:.o=.c)
d48 7
a54 1
 	$(CC) $(CFLAGS) -DLOGLEVEL="(1 << $(shell awk '/cfgparse.y/ { print NR }' loglevels.tmp))" -c -o $@@ $(<:.y=.tab.c)
d63 1
a63 1
-	$(INSTALL) -m 0755 i3-wsbar $(DESTDIR)$(PREFIX)/bin/
d65 1
d70 1
a70 1
+	${INSTALL_SCRIPT} i3-wsbar $(DESTDIR)$(PREFIX)/bin/
d72 1
d76 19
a94 2
 	$(MAKE) TOPDIR=$(TOPDIR) -C i3-msg install
 	$(MAKE) TOPDIR=$(TOPDIR) -C i3-input install
@


1.2
log
@Fix manpage install mode. No bump, didn't build for me.

Error: weird mode for /usr/local/man/man1/i3.1: 4444
@
text
@d1 4
a4 4
$OpenBSD: patch-Makefile,v 1.1.1.1 2009/09/02 19:26:17 landry Exp $
--- Makefile.orig	Wed Aug 19 14:39:09 2009
+++ Makefile	Wed Sep  2 21:23:16 2009
@@@@ -8,24 +8,20 @@@@ HEADERS=$(wildcard include/*.h)
d9 1
a9 1
 	$(CC) $(CFLAGS) -c -o $@@ $<
d11 1
a11 1
 all: ${FILES}
d13 1
a13 1
 	$(CC) -o i3 ${FILES} $(LDFLAGS)
d17 20
d40 16
a55 13
-	$(INSTALL) -d -m 0755 $(DESTDIR)/usr/bin
-	$(INSTALL) -d -m 0755 $(DESTDIR)/etc/i3
-	$(INSTALL) -d -m 0755 $(DESTDIR)/usr/share/xsessions
-	$(INSTALL) -m 0755 i3 $(DESTDIR)/usr/bin/
-	test -e $(DESTDIR)/etc/i3/config || $(INSTALL) -m 0644 i3.config $(DESTDIR)/etc/i3/config
-	$(INSTALL) -m 0644 i3.desktop $(DESTDIR)/usr/share/xsessions/
+	$(INSTALL) -d -m 0755 $(PREFIX)/bin
+	$(INSTALL) -d -m 0755 $(PREFIX)/share/examples/i3
+	$(INSTALL) -d -m 0755 $(PREFIX)/share/xsessions
+	$(INSTALL) -m 0755 i3 $(PREFIX)/bin/
+	$(INSTALL) -m 0444 man/i3.1 $(PREFIX)/man/man1/
+	test -e $(PREFIX)/etc/i3/config || $(INSTALL) -m 0644 i3.config $(PREFIX)/share/examples/i3/config
+	$(INSTALL) -m 0644 i3.desktop $(PREFIX)/share/xsessions/
d57 1
a58 1
 dist: distclean
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
$OpenBSD$
d30 1
a30 1
+	$(INSTALL) -m 4444 man/i3.1 $(PREFIX)/man/man1/
@


1.1.1.1
log
@Import (really, this time) i3 3.c, from MAINTAINER Baptiste Daroussin,
with tweaks by me.

i3 is an improved dynamic, tiling window manager.

note: It is still young, so some debug options are still enable by
default, and it's a bit verbose.

ok ajacoutot@@
@
text
@@
