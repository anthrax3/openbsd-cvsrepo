head	1.25;
access;
symbols
	OPENBSD_6_0:1.24.0.2
	OPENBSD_6_0_BASE:1.24
	OPENBSD_5_9:1.23.0.2
	OPENBSD_5_9_BASE:1.23
	OPENBSD_5_8:1.22.0.4
	OPENBSD_5_8_BASE:1.22
	OPENBSD_5_7:1.21.0.4
	OPENBSD_5_7_BASE:1.21
	OPENBSD_5_6:1.21.0.2
	OPENBSD_5_6_BASE:1.21
	OPENBSD_5_5:1.15.0.2
	OPENBSD_5_5_BASE:1.15
	OPENBSD_5_4:1.13.0.4
	OPENBSD_5_4_BASE:1.13
	OPENBSD_5_3:1.13.0.2
	OPENBSD_5_3_BASE:1.13
	OPENBSD_5_2:1.10.0.2
	OPENBSD_5_2_BASE:1.10
	OPENBSD_5_1_BASE:1.7
	OPENBSD_5_1:1.7.0.2
	OPENBSD_5_0:1.4.0.2
	OPENBSD_5_0_BASE:1.4
	OPENBSD_4_9:1.2.0.2
	OPENBSD_4_9_BASE:1.2
	OPENBSD_4_8:1.1.1.1.0.4
	OPENBSD_4_8_BASE:1.1.1.1
	OPENBSD_4_7:1.1.1.1.0.2
	OPENBSD_4_7_BASE:1.1.1.1
	landry_20090902:1.1.1.1
	bapt:1.1.1;
locks; strict;
comment	@# @;


1.25
date	2016.11.13.20.46.23;	author dcoppa;	state dead;
branches;
next	1.24;
commitid	YWcsP0rJp2QqdVhK;

1.24
date	2016.03.09.09.25.51;	author dcoppa;	state Exp;
branches;
next	1.23;
commitid	5e0lb25PYzcoURwg;

1.23
date	2015.10.04.08.48.12;	author dcoppa;	state Exp;
branches;
next	1.22;
commitid	VRvZAaOZt8xtMVjt;

1.22
date	2015.03.17.15.39.47;	author dcoppa;	state Exp;
branches;
next	1.21;
commitid	WQl7M1uD6B2NjHh4;

1.21
date	2014.07.11.15.49.58;	author dcoppa;	state Exp;
branches;
next	1.20;
commitid	dpkYaZL7eWFGPiTd;

1.20
date	2014.04.16.14.12.04;	author dcoppa;	state Exp;
branches;
next	1.19;

1.19
date	2014.04.15.10.31.30;	author dcoppa;	state Exp;
branches;
next	1.18;

1.18
date	2014.03.26.07.02.34;	author ajacoutot;	state Exp;
branches;
next	1.17;

1.17
date	2014.03.23.18.17.35;	author kili;	state Exp;
branches;
next	1.16;

1.16
date	2014.03.19.07.31.53;	author ajacoutot;	state Exp;
branches;
next	1.15;

1.15
date	2014.01.22.13.48.38;	author dcoppa;	state Exp;
branches;
next	1.14;

1.14
date	2014.01.11.16.04.43;	author dcoppa;	state Exp;
branches;
next	1.13;

1.13
date	2012.09.21.17.16.14;	author dcoppa;	state Exp;
branches;
next	1.12;

1.12
date	2012.09.16.22.05.46;	author ajacoutot;	state Exp;
branches;
next	1.11;

1.11
date	2012.09.16.06.24.32;	author ajacoutot;	state Exp;
branches;
next	1.10;

1.10
date	2012.05.09.11.56.49;	author dcoppa;	state Exp;
branches;
next	1.9;

1.9
date	2012.04.26.10.55.10;	author dcoppa;	state Exp;
branches;
next	1.8;

1.8
date	2012.02.21.14.05.39;	author dcoppa;	state Exp;
branches;
next	1.7;

1.7
date	2011.12.27.09.05.17;	author dcoppa;	state Exp;
branches;
next	1.6;

1.6
date	2011.12.01.16.00.01;	author dcoppa;	state Exp;
branches;
next	1.5;

1.5
date	2011.11.06.20.23.25;	author dcoppa;	state Exp;
branches;
next	1.4;

1.4
date	2011.05.09.11.03.40;	author dcoppa;	state Exp;
branches;
next	1.3;

1.3
date	2011.03.14.12.55.18;	author dcoppa;	state Exp;
branches;
next	1.2;

1.2
date	2010.09.14.08.54.18;	author dcoppa;	state Exp;
branches;
next	1.1;

1.1
date	2009.09.02.19.26.17;	author landry;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2009.09.02.19.26.17;	author landry;	state Exp;
branches;
next	;


desc
@@


1.25
log
@
Update to i3-4.13

OK tb@@, jasper@@
@
text
@$OpenBSD: patch-common_mk,v 1.24 2016/03/09 09:25:51 dcoppa Exp $
--- common.mk.orig	Sun Mar  6 16:17:18 2016
+++ common.mk	Mon Mar  7 15:15:37 2016
@@@@ -171,9 +171,9 @@@@ I3_LDFLAGS += -Wl,-rpath,/usr/local/lib -Wl,-rpath,/us
 endif
 
 ifeq ($(UNAME),OpenBSD)
-I3_CFLAGS += -I${X11BASE}/include
+I3_CFLAGS += -I${X11BASE}/include -I${LOCALBASE}/include
 LIBS += -liconv
-I3_LDFLAGS += -L${X11BASE}/lib
+I3_LDFLAGS += -L${X11BASE}/lib -L${LOCALBASE}/lib
 endif
 
 ifeq ($(UNAME),FreeBSD)
@


1.24
log
@
Update to i3-4.12
Added halex@@'s window hints fix
Fixed trailing whitespace in pkg/DESCR (spotted by Josh Grosse)

Tested by tb@@ and Josh Grosse
OK tb@@
@
text
@d1 1
a1 1
$OpenBSD: patch-common_mk,v 1.23 2015/10/04 08:48:12 dcoppa Exp $
@


1.23
log
@
Update to i3-4.11
@
text
@d1 4
a4 4
$OpenBSD: patch-common_mk,v 1.22 2015/03/17 15:39:47 dcoppa Exp $
--- common.mk.orig	Wed Sep 30 08:55:10 2015
+++ common.mk	Fri Oct  2 16:58:54 2015
@@@@ -162,9 +162,9 @@@@ I3_LDFLAGS += -Wl,-rpath,/usr/local/lib -Wl,-rpath,/us
@


1.22
log
@
Update to i3-4.9.1

new dependency on x11/xkbcommon
@
text
@d1 4
a4 11
$OpenBSD: patch-common_mk,v 1.21 2014/07/11 15:49:58 dcoppa Exp $
--- common.mk.orig	Wed Feb 25 01:50:09 2015
+++ common.mk	Wed Feb 25 02:26:18 2015
@@@@ -1,5 +1,5 @@@@
 UNAME=$(shell uname)
-DEBUG=1
+DEBUG=0
 COVERAGE=0
 INSTALL=install
 LN=ln
@@@@ -159,9 +159,9 @@@@ I3_LDFLAGS += -Wl,-rpath,/usr/local/lib -Wl,-rpath,/us
@


1.21
log
@
Update to i3-4.8 plus fixes.

Initial diff by Theo Buehler <theo AT math DOT ethz DOT ch>
@
text
@d1 3
a3 3
$OpenBSD: patch-common_mk,v 1.20 2014/04/16 14:12:04 dcoppa Exp $
--- common.mk.orig	Sun Jun 15 19:12:43 2014 
+++ common.mk		Wed Jul  2 20:14:26 2014 
d11 1
a11 1
@@@@ -157,9 +157,9 @@@@ I3_LDFLAGS += -Wl,-rpath,/usr/local/lib -Wl,-rpath,/us
@


1.20
log
@
Pushed upstream.
@
text
@d1 3
a3 10
$OpenBSD: patch-common_mk,v 1.19 2014/04/15 10:31:30 dcoppa Exp $

commit 2ba0d1ea49886db949c95e84cc8bfdea319b4c9a
Author: David Coppa <dcoppa@@gmail.com>
Date:   Wed Mar 26 10:01:50 2014 +0100

OpenBSD does not have librt

--- common.mk.orig	Thu Jan 23 22:52:24 2014
+++ common.mk	Tue Apr 15 07:55:02 2014
d11 1
a11 1
@@@@ -160,9 +160,9 @@@@ I3_LDFLAGS += -Wl,-rpath,/usr/local/lib -Wl,-rpath,/us
a22 11
@@@@ -171,8 +171,8 @@@@ endif
 
 ifeq ($(UNAME),Darwin)
 LIBS += -liconv
-else
-# Darwin (Mac OS X) doesn’t have librt
+else ifneq ($(UNAME),OpenBSD)
+# Darwin (Mac OS X) and OpenBSD do not have librt
 LIBS += -lrt
 endif
 
@


1.19
log
@
Cleanup following libxcb/xcb-util updates
@
text
@d1 8
a8 1
$OpenBSD: patch-common_mk,v 1.18 2014/03/26 07:02:34 ajacoutot Exp $
@


1.18
log
@Make the librt conditional match on OpenBSD only; will be easier to send
upstream.

ok dcoppa@@ (maintainer)
@
text
@d1 1
a1 1
$OpenBSD: patch-common_mk,v 1.17 2014/03/23 18:17:35 kili Exp $
d3 1
a3 1
+++ common.mk	Mon Mar 24 08:15:17 2014
a10 11
@@@@ -110,8 +110,8 @@@@ X11_CFLAGS := $(call cflags_for_lib, x11)
 X11_LIBS   := $(call ldflags_for_lib, x11,X11)
 
 # Xcursor
-XCURSOR_CFLAGS := $(call cflags_for_lib, xcb-cursor)
-XCURSOR_LIBS   := $(call ldflags_for_lib, xcb-cursor,xcb-cursor)
+XCURSOR_CFLAGS := $(call cflags_for_lib, xcursor)
+XCURSOR_LIBS   := $(call ldflags_for_lib, xcursor,Xcursor)
 
 # yajl
 YAJL_CFLAGS := $(call cflags_for_lib, yajl)
@


1.17
log
@Revert librt changes.

Prodded by espie@@.
@
text
@d1 1
a1 1
$OpenBSD: patch-common_mk,v 1.16 2014/03/19 07:31:53 ajacoutot Exp $
d3 1
a3 1
+++ common.mk	Tue Mar 18 12:45:57 2014
d22 1
a22 1
@@@@ -160,20 +160,13 @@@@ I3_LDFLAGS += -Wl,-rpath,/usr/local/lib -Wl,-rpath,/us
d34 3
a37 4
-endif
-
-ifeq ($(UNAME),Darwin)
-LIBS += -liconv
d40 3
a42 1
-LIBS += -lrt
a44 1
 ifneq (,$(filter Linux GNU GNU/%, $(UNAME)))
@


1.16
log
@Remove the librt chunk.

ok dcoppa@@ (maintainer)
@
text
@d1 1
a1 1
$OpenBSD: patch-common_mk,v 1.15 2014/01/22 13:48:38 dcoppa Exp $
d22 1
a22 1
@@@@ -160,9 +160,9 @@@@ I3_LDFLAGS += -Wl,-rpath,/usr/local/lib -Wl,-rpath,/us
d34 11
@


1.15
log
@Bugfix update to i3-4.7.1
@
text
@d1 3
a3 3
$OpenBSD: patch-common_mk,v 1.14 2014/01/11 16:04:43 dcoppa Exp $
--- common.mk.orig	Tue Jan 21 19:21:08 2014
+++ common.mk	Wed Jan 22 13:19:44 2014
d22 1
a22 1
@@@@ -160,20 +160,13 @@@@ I3_LDFLAGS += -Wl,-rpath,/usr/local/lib -Wl,-rpath,/us
a33 11
 LIBS += -liconv
-endif
-
-ifeq ($(UNAME),Darwin)
-LIBS += -liconv
-else
-# Darwin (Mac OS X) doesn’t have librt
-LIBS += -lrt
 endif
 
 ifneq (,$(filter Linux GNU GNU/%, $(UNAME)))
@


1.14
log
@Update to i3-4.7
@
text
@d1 3
a3 3
$OpenBSD: patch-common_mk,v 1.13 2012/09/21 17:16:14 dcoppa Exp $
--- common.mk.orig	Sun Dec 22 21:12:41 2013
+++ common.mk	Fri Jan 10 16:40:03 2014
d10 2
a11 2
 ifndef PREFIX
@@@@ -109,8 +109,8 @@@@ X11_CFLAGS := $(call cflags_for_lib, x11)
d22 1
a22 1
@@@@ -159,20 +159,13 @@@@ I3_LDFLAGS += -Wl,-rpath,/usr/local/lib -Wl,-rpath,/us
@


1.13
log
@Update to i3-4.3

OK jasper@@
@
text
@d1 3
a3 3
$OpenBSD: patch-common_mk,v 1.12 2012/09/16 22:05:46 ajacoutot Exp $
--- common.mk.orig	Wed Sep 19 18:08:09 2012
+++ common.mk	Fri Sep 21 15:20:57 2012
d10 13
a22 2
 FLEX=flex
@@@@ -161,20 +161,13 @@@@ I3_LDFLAGS += -Wl,-rpath,/usr/local/lib -Wl,-rpath,/us
@


1.12
log
@Prevent variable referencing itself; spotted by nigel@@
@
text
@d1 3
a3 3
$OpenBSD: patch-common_mk,v 1.11 2012/09/16 06:24:32 ajacoutot Exp $
--- common.mk.orig	Wed Apr 25 23:21:32 2012
+++ common.mk	Mon Sep 17 00:03:25 2012
d11 1
a11 80
@@@@ -18,76 +18,17 @@@@ endif
 GIT_VERSION:="4.2 (2012-04-25, branch \\\"release-4.2\\\")"
 VERSION:=4.2
 
-ifeq ($(shell which pkg-config 2>/dev/null 1>/dev/null || echo 1),1)
-$(error "pkg-config was not found")
-endif
-
-# An easier way to get CFLAGS and LDFLAGS falling back in case there's
-# no pkg-config support for certain libraries.
-#
-# NOTE that you must not use a blank after comma when calling this:
-#     $(call ldflags_for_lib name, fallback) # bad
-#     $(call ldflags_for_lib name,fallback) # good
-# Otherwise, the compiler will get -l foo instead of -lfoo
-#
-# We redirect stderr to /dev/null because pkg-config prints an error if support
-# for gnome-config was enabled but gnome-config is not actually installed.
-cflags_for_lib = $(shell pkg-config --silence-errors --cflags $(1) 2>/dev/null)
-ldflags_for_lib = $(shell pkg-config --exists 2>/dev/null $(1) && pkg-config --libs $(1) 2>/dev/null || echo -l$(2))
-
 CFLAGS += -std=c99
-CFLAGS += -pipe
-CFLAGS += -Wall
 # unused-function, unused-label, unused-variable are turned on by -Wall
 # We don’t want unused-parameter because of the use of many callbacks
 CFLAGS += -Wunused-value
-CFLAGS += -Iinclude
-CFLAGS += $(call cflags_for_lib, xcb-keysyms)
-ifeq ($(shell pkg-config --exists xcb-util 2>/dev/null || echo 1),1)
+CFLAGS += -I$(TOPDIR)/include
 CPPFLAGS += -DXCB_COMPAT
-CFLAGS += $(call cflags_for_lib, xcb-atom)
-CFLAGS += $(call cflags_for_lib, xcb-aux)
-else
-CFLAGS += $(call cflags_for_lib, xcb-util)
-endif
-CFLAGS += $(call cflags_for_lib, xcb-icccm)
-CFLAGS += $(call cflags_for_lib, xcb-xinerama)
-CFLAGS += $(call cflags_for_lib, xcb-randr)
-CFLAGS += $(call cflags_for_lib, xcb)
-CFLAGS += $(call cflags_for_lib, xcursor)
-CFLAGS += $(call cflags_for_lib, x11)
-CFLAGS += $(call cflags_for_lib, yajl)
-CFLAGS += $(call cflags_for_lib, libev)
-CFLAGS += $(call cflags_for_lib, libpcre)
-CFLAGS += $(call cflags_for_lib, libstartup-notification-1.0)
 CPPFLAGS += -DI3_VERSION=\"${GIT_VERSION}\"
 CPPFLAGS += -DSYSCONFDIR=\"${SYSCONFDIR}\"
-
-ifeq ($(shell pkg-config --atleast-version=8.10 libpcre 2>/dev/null && echo 1),1)
 CPPFLAGS += -DPCRE_HAS_UCP=1
-endif
 
-LIBS += -lm
-LIBS += -lrt
-LIBS += -L $(TOPDIR)/libi3 -li3
-LIBS += $(call ldflags_for_lib, xcb-event,xcb-event)
-LIBS += $(call ldflags_for_lib, xcb-keysyms,xcb-keysyms)
-ifeq ($(shell pkg-config --exists xcb-util 2>/dev/null || echo 1),1)
-LIBS += $(call ldflags_for_lib, xcb-atom,xcb-atom)
-LIBS += $(call ldflags_for_lib, xcb-aux,xcb-aux)
-else
-LIBS += $(call ldflags_for_lib, xcb-util)
-endif
-LIBS += $(call ldflags_for_lib, xcb-icccm,xcb-icccm)
-LIBS += $(call ldflags_for_lib, xcb-xinerama,xcb-xinerama)
-LIBS += $(call ldflags_for_lib, xcb-randr,xcb-randr)
-LIBS += $(call ldflags_for_lib, xcb,xcb)
-LIBS += $(call ldflags_for_lib, xcursor,Xcursor)
-LIBS += $(call ldflags_for_lib, x11,X11)
-LIBS += $(call ldflags_for_lib, yajl,yajl)
-LIBS += $(call ldflags_for_lib, libev,ev)
-LIBS += $(call ldflags_for_lib, libpcre,pcre)
-LIBS += $(call ldflags_for_lib, libstartup-notification-1.0,startup-notification-1)
+LIBS += -L$(TOPDIR)/libi3 -lX11 -lX11-xcb -lXau -lXcursor -lXdmcp -lXfixes -lXrender -lev -li3 -lm -lpcre -lpthread-stubs -lstartup-notification-1 -lxcb -lxcb-atom -lxcb-aux -lxcb-event -lxcb-icccm -lxcb-keysyms -lxcb-property -lxcb-randr -lxcb-xinerama -lyajl
 
 # Please test if -Wl,--as-needed works on your platform and send me a patch.
 # it is known not to work on Darwin (Mac OS X)
@@@@ -102,9 +43,9 @@@@ LDFLAGS += -Wl,-rpath,/usr/local/lib -Wl,-rpath,/usr/p
d15 2
a16 2
-CFLAGS += -I${X11BASE}/include
+CFLAGS += -I${X11BASE}/include -I${LOCALBASE}/include -I${LOCALBASE}/include/startup-notification-1.0
d18 2
a19 2
-LDFLAGS += -L${X11BASE}/lib
+LDFLAGS += -L${X11BASE}/lib -L${LOCALBASE}/lib
d23 5
a27 4
@@@@ -127,18 +68,12 @@@@ ifeq ($(DEBUG),1)
 # Extended debugging flags, macros shall be available in gcc
 CFLAGS += -gdwarf-2
 CFLAGS += -g3
d29 2
a30 2
-CFLAGS += -O2
-CFLAGS += -freorder-blocks-and-partition
d33 1
a33 10
 ifeq ($(COVERAGE),1)
 CFLAGS += -fprofile-arcs -ftest-coverage
 LIBS += -lgcov
 endif
-
-# Don’t print command lines which are run
-.SILENT:
 
 # Always remake the following targets
 .PHONY: install clean dist distclean
@


1.11
log
@/etc -> SYSCONFDIR

ok dcoppa@@ (maintainer)
@
text
@d1 3
a3 3
$OpenBSD: patch-common_mk,v 1.10 2012/05/09 11:56:49 dcoppa Exp $
--- common.mk.orig	Mon May  7 16:43:19 2012
+++ common.mk	Mon May  7 16:47:01 2012
d11 1
a11 12
@@@@ -8,86 +8,23 @@@@ ifndef PREFIX
   PREFIX=/usr
 endif
 ifndef SYSCONFDIR
-  ifeq ($(PREFIX),/usr)
-    SYSCONFDIR=/etc
-  else
-    SYSCONFDIR=$(PREFIX)/etc
-  endif
+  SYSCONFDIR=${SYSCONFDIR}
 endif
 # The escaping is absurd, but we need to escape for shell, sed, make, define
d90 1
a90 1
@@@@ -102,9 +39,9 @@@@ LDFLAGS += -Wl,-rpath,/usr/local/lib -Wl,-rpath,/usr/p
d102 1
a102 1
@@@@ -127,18 +64,12 @@@@ ifeq ($(DEBUG),1)
@


1.10
log
@Update to i3-4.2

OK jasper@@
@
text
@d1 1
a1 1
$OpenBSD: patch-common_mk,v 1.9 2012/04/26 10:55:10 dcoppa Exp $
d20 1
a20 1
+  SYSCONFDIR=/etc
@


1.9
log
@Fix config file; fix WANTLIB
@
text
@d1 4
a4 4
$OpenBSD: patch-common_mk,v 1.8 2012/02/21 14:05:39 dcoppa Exp $
--- common.mk.orig	Fri Jan 27 20:24:15 2012
+++ common.mk	Thu Apr 26 12:28:18 2012
@@@@ -1,90 +1,28 @@@@
d10 2
a11 1
 ifndef PREFIX
d23 2
a24 2
 GIT_VERSION:="4.1.2 (2012-01-27, branch \\\"release-4.1.2\\\")"
 VERSION:=4.1.2
d77 1
d101 1
a101 1
@@@@ -99,9 +37,9 @@@@ LDFLAGS += -Wl,-rpath,/usr/local/lib -Wl,-rpath,/usr/p
d113 1
a113 1
@@@@ -124,18 +62,12 @@@@ ifeq ($(DEBUG),1)
@


1.8
log
@Update to i3-4.1.2
@
text
@d1 3
a3 3
$OpenBSD: patch-common_mk,v 1.7 2011/12/27 09:05:17 dcoppa Exp $
--- common.mk.orig	Sat Dec 24 16:25:15 2011
+++ common.mk	Tue Dec 27 09:50:07 2011
d95 1
a95 1
+LIBS += -L$(TOPDIR)/libi3 -li3 -lX11 -lXcursor -lev -lm -lxcb -lxcb-atom -lxcb-aux -lxcb-event -lxcb-icccm -lxcb-keysyms -lxcb-property -lxcb-randr -lxcb-xinerama -lyajl -lpcre -lstartup-notification-1
@


1.7
log
@Bugfixing update to i3-4.1.1
@
text
@d1 1
a1 1
$OpenBSD: patch-common_mk,v 1.6 2011/12/01 16:00:01 dcoppa Exp $
d22 2
a23 2
 GIT_VERSION:="4.1.1 (2011-12-24, branch \\\"master\\\")"
 VERSION:=4.1.1
@


1.6
log
@Major update to i3-4.1
@
text
@d1 4
a4 4
$OpenBSD: patch-common_mk,v 1.5 2011/11/06 20:23:25 dcoppa Exp $
--- common.mk.orig	Fri Nov 11 23:41:26 2011
+++ common.mk	Wed Nov 30 16:51:08 2011
@@@@ -1,90 +1,30 @@@@
d22 2
a23 2
 GIT_VERSION:="4.1 (2011-11-11, branch \\\"release-4.1\\\")"
 VERSION:=4.1
d43 2
a44 2
 CFLAGS += -pipe
 CFLAGS += -Wall
d99 1
a99 1
@@@@ -99,9 +39,9 @@@@ LDFLAGS += -Wl,-rpath,/usr/local/lib -Wl,-rpath,/usr/p
d111 10
a120 1
@@@@ -133,9 +73,6 @@@@ ifeq ($(COVERAGE),1)
@


1.5
log
@Update to i3-4.0.2 (plus patches from upstream git).
i3bar is now part of i3 itself and i3-wsbar is gone.
@
text
@d1 4
a4 4
$OpenBSD: patch-common_mk,v 1.4 2011/05/09 11:03:40 dcoppa Exp $
--- common.mk.orig	Sun Aug 28 19:48:21 2011
+++ common.mk	Mon Oct 31 16:23:50 2011
@@@@ -1,75 +1,31 @@@@
a20 2
-TERM_EMU=xterm
+TERM_EMU=${X11BASE}/bin/xterm
d22 2
a23 2
 GIT_VERSION:="4.0.2 (2011-08-28, branch \\\"release-4.0.2\\\")"
 VERSION:=4.0.2
d30 11
a40 3
-# no pkg-config support for certain libraries
-cflags_for_lib = $(shell pkg-config --silence-errors --cflags $(1))
-ldflags_for_lib = $(shell pkg-config --exists $(1) && pkg-config --libs $(1) || echo -l$(2))
d50 1
a50 1
-ifeq ($(shell pkg-config --exists xcb-util || echo 1),1)
d66 2
d70 4
a73 1
 CPPFLAGS += -DTERM_EMU=\"$(TERM_EMU)\"
d76 6
a81 5
-LIBS += $(call ldflags_for_lib, xcb-event, xcb-event)
-LIBS += $(call ldflags_for_lib, xcb-keysyms, xcb-keysyms)
-ifeq ($(shell pkg-config --exists xcb-util || echo 1),1)
-LIBS += $(call ldflags_for_lib, xcb-atom, xcb-atom)
-LIBS += $(call ldflags_for_lib, xcb-aux, xcb-aux)
d85 11
a95 9
-LIBS += $(call ldflags_for_lib, xcb-icccm, xcb-icccm)
-LIBS += $(call ldflags_for_lib, xcb-xinerama, xcb-xinerama)
-LIBS += $(call ldflags_for_lib, xcb-randr, xcb-randr)
-LIBS += $(call ldflags_for_lib, xcb, xcb)
-LIBS += $(call ldflags_for_lib, xcursor, Xcursor)
-LIBS += $(call ldflags_for_lib, x11, X11)
-LIBS += $(call ldflags_for_lib, yajl, yajl)
-LIBS += $(call ldflags_for_lib, libev, ev)
+LIBS += -lX11 -lXcursor -lev -lm -lxcb -lxcb-atom -lxcb-aux -lxcb-event -lxcb-icccm -lxcb-keysyms -lxcb-property -lxcb-randr -lxcb-xinerama -lyajl
d99 1
a99 1
@@@@ -84,9 +40,9 @@@@ LDFLAGS += -Wl,-rpath,/usr/local/lib -Wl,-rpath,/usr/p
d104 1
a104 1
+CFLAGS += -I${X11BASE}/include -I${LOCALBASE}/include
d111 1
a111 1
@@@@ -118,9 +74,6 @@@@ ifeq ($(COVERAGE),1)
@


1.4
log
@Update to i3-3.e-bf3 (i3-3.5.3)
@
text
@d1 4
a4 4
$OpenBSD: patch-common_mk,v 1.3 2011/03/14 12:55:18 dcoppa Exp $
--- common.mk.orig	Sun May  8 14:20:48 2011
+++ common.mk	Mon May  9 12:01:55 2011
@@@@ -1,12 +1,12 @@@@
d8 1
d10 2
a11 7
-PREFIX=/usr
-ifeq ($(PREFIX),/usr)
-SYSCONFDIR=/etc
-else
-SYSCONFDIR=$(PREFIX)/etc
+ifndef PREFIX
+  PREFIX=/usr
d13 6
a18 1
+ifndef SYSCONFDIR
d20 6
a25 3
+endif
 GIT_VERSION="3.e-bf3 (2011-05-08)"
 VERSION=3.e-bf3
d27 13
a39 1
@@@@ -17,7 +17,7 @@@@ CFLAGS += -Wall
d42 45
a86 4
 CFLAGS += -Iinclude
-CFLAGS += -I/usr/local/include
+CFLAGS += -I${LOCALBASE}/include
 CFLAGS += -DI3_VERSION=\"${GIT_VERSION}\"
d88 7
a94 7
 # Check if pkg-config is installed, because without pkg-config, the following
@@@@ -53,7 +53,7 @@@@ LDFLAGS += -lxcb
 LDFLAGS += -lyajl
 LDFLAGS += -lX11
 LDFLAGS += -lev
-LDFLAGS += -L/usr/local/lib -L/usr/pkg/lib
+LDFLAGS += -L${LOCALBASE}/lib -L/usr/pkg/lib
d96 4
a99 5
 ifeq ($(UNAME),NetBSD)
 # We need -idirafter instead of -I to prefer the system’s iconv over GNU libiconv
@@@@ -86,9 +86,6 @@@@ CFLAGS += -g3
 else
 CFLAGS += -O2
@


1.3
log
@Update to i3-3.e-bf2 (aka i3-3.5.2)
@
text
@d1 3
a3 3
$OpenBSD: patch-common_mk,v 1.2 2010/09/14 08:54:18 dcoppa Exp $
--- common.mk.orig	Wed Jan 19 21:26:43 2011
+++ common.mk	Mon Mar 14 13:39:50 2011
d6 2
a7 1
 DEBUG=1
d20 2
a21 2
 GIT_VERSION="3.e-bf2 (2011-01-19)"
 VERSION=3.e-bf2
d32 1
a32 1
@@@@ -49,7 +49,7 @@@@ LDFLAGS += -lxcb
d41 1
a41 1
@@@@ -78,9 +78,6 @@@@ CFLAGS += -g3
@


1.2
log
@Update to i3-3.5.1

resolve_tilde() function by Christopher Zimmermann
(madroach AT zakweb DOT de): thanks!

OK landry@@
@
text
@d1 3
a3 3
$OpenBSD$
--- common.mk.orig	Mon Sep 13 10:28:54 2010
+++ common.mk	Mon Sep 13 10:44:44 2010
d19 2
a20 2
 GIT_VERSION="3.e-bf1 (2010-06-09)"
 VERSION=3.e-bf1
@


1.1
log
@Initial revision
@
text
@d2 23
a24 5
--- common.mk.orig	Wed Aug 19 14:39:09 2009
+++ common.mk	Wed Sep  2 21:23:04 2009
@@@@ -9,7 +9,7 @@@@ CFLAGS += -pipe
 CFLAGS += -Wall
 CFLAGS += -Wunused
d31 2
a32 2
@@@@ -38,7 +38,7 @@@@ LDFLAGS += -lxcb-icccm
 LDFLAGS += -lxcb-xinerama
d40 1
a40 15
@@@@ -50,6 +50,13 @@@@ ifeq ($(UNAME),FreeBSD)
 LDFLAGS += -liconv
 endif
 
+ifeq ($(UNAME),OpenBSD)
+CFLAGS += -ftrampolines
+CFLAGS += -I${X11BASE}/include
+LDFLAGS += -liconv
+LDFLAGS += -L${X11BASE}/lib
+endif
+
 ifeq ($(UNAME),Linux)
 CFLAGS += -D_GNU_SOURCE
 endif
@@@@ -61,9 +68,6 @@@@ CFLAGS += -g3
@


1.1.1.1
log
@Import (really, this time) i3 3.c, from MAINTAINER Baptiste Daroussin,
with tweaks by me.

i3 is an improved dynamic, tiling window manager.

note: It is still young, so some debug options are still enable by
default, and it's a bit verbose.

ok ajacoutot@@
@
text
@@
