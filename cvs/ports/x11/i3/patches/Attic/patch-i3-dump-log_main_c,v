head	1.5;
access;
symbols
	OPENBSD_6_0:1.4.0.2
	OPENBSD_6_0_BASE:1.4
	OPENBSD_5_9:1.3.0.2
	OPENBSD_5_9_BASE:1.3
	OPENBSD_5_8:1.3.0.4
	OPENBSD_5_8_BASE:1.3
	OPENBSD_5_7:1.2.0.4
	OPENBSD_5_7_BASE:1.2
	OPENBSD_5_6:1.2.0.2
	OPENBSD_5_6_BASE:1.2
	OPENBSD_5_5:1.1.0.4
	OPENBSD_5_5_BASE:1.1
	OPENBSD_5_4:1.1.0.2
	OPENBSD_5_4_BASE:1.1;
locks; strict;
comment	@# @;


1.5
date	2016.11.13.20.46.23;	author dcoppa;	state dead;
branches;
next	1.4;
commitid	YWcsP0rJp2QqdVhK;

1.4
date	2016.03.09.09.25.51;	author dcoppa;	state Exp;
branches;
next	1.3;
commitid	5e0lb25PYzcoURwg;

1.3
date	2015.03.30.12.33.46;	author dcoppa;	state Exp;
branches;
next	1.2;
commitid	iVyfQtDXLWKbSbnJ;

1.2
date	2014.07.11.15.49.58;	author dcoppa;	state Exp;
branches;
next	1.1;
commitid	dpkYaZL7eWFGPiTd;

1.1
date	2013.06.02.11.24.06;	author dcoppa;	state Exp;
branches;
next	;


desc
@@


1.5
log
@
Update to i3-4.13

OK tb@@, jasper@@
@
text
@$OpenBSD: patch-i3-dump-log_main_c,v 1.4 2016/03/09 09:25:51 dcoppa Exp $

OpenBSD lacks pthread_condattr_setpshared()

--- i3-dump-log/main.c.orig	Sun Mar  6 16:17:18 2016
+++ i3-dump-log/main.c	Mon Mar  7 15:15:37 2016
@@@@ -28,8 +28,12 @@@@
 #include "shmlog.h"
 #include <i3/ipc.h>
 
+#if !defined(__OpenBSD__)
 static uint32_t offset_next_write,
     wrap_count;
+#else
+static uint32_t wrap_count;
+#endif
 
 static i3_shmlog_header *header;
 static char *logbuffer,
@@@@ -57,17 +61,27 @@@@ static void print_till_end(void) {
 
 int main(int argc, char *argv[]) {
     int o, option_index = 0;
+#if !defined(__OpenBSD__)
     bool verbose = false,
          follow = false;
+#else
+    bool verbose = false;
+#endif
 
     static struct option long_options[] = {
         {"version", no_argument, 0, 'v'},
         {"verbose", no_argument, 0, 'V'},
+#if !defined(__OpenBSD__)
         {"follow", no_argument, 0, 'f'},
+#endif
         {"help", no_argument, 0, 'h'},
         {0, 0, 0, 0}};
 
+#if !defined(__OpenBSD__)
     char *options_string = "s:vfVh";
+#else
+    char *options_string = "vVh";
+#endif
 
     while ((o = getopt_long(argc, argv, options_string, long_options, &option_index)) != -1) {
         if (o == 'v') {
@@@@ -75,11 +89,17 @@@@ int main(int argc, char *argv[]) {
             return 0;
         } else if (o == 'V') {
             verbose = true;
+#if !defined(__OpenBSD__)
         } else if (o == 'f') {
             follow = true;
+#endif
         } else if (o == 'h') {
             printf("i3-dump-log " I3_VERSION "\n");
-            printf("i3-dump-log [-f] [-s <socket>]\n");
+#if !defined(__OpenBSD__)
+            printf("i3-dump-log [-fhVv]\n");
+#else
+            printf("i3-dump-log [-hVv]\n");
+#endif
             return 0;
         }
     }
@@@@ -162,6 +182,7 @@@@ int main(int argc, char *argv[]) {
     walk = logbuffer + sizeof(i3_shmlog_header);
     print_till_end();
 
+#if !defined(__OpenBSD__)
     if (follow) {
         /* Since pthread_cond_wait() expects a mutex, we need to provide one.
          * To not lock i3 (thatâ€™s bad, mhkay?) we just define one outside of
@@@@ -177,6 +198,7 @@@@ int main(int argc, char *argv[]) {
             }
         }
     }
+#endif
 
     return 0;
 }
@


1.4
log
@
Update to i3-4.12
Added halex@@'s window hints fix
Fixed trailing whitespace in pkg/DESCR (spotted by Josh Grosse)

Tested by tb@@ and Josh Grosse
OK tb@@
@
text
@d1 1
a1 1
$OpenBSD: patch-i3-dump-log_main_c,v 1.3 2015/03/30 12:33:46 dcoppa Exp $
@


1.3
log
@
Update to i3-4.10.1
@
text
@d1 1
a1 1
$OpenBSD: patch-i3-dump-log_main_c,v 1.2 2014/07/11 15:49:58 dcoppa Exp $
d5 2
a6 2
--- i3-dump-log/main.c.orig	Sun Mar 29 19:07:08 2015
+++ i3-dump-log/main.c	Mon Mar 30 14:21:46 2015
d67 1
a67 1
@@@@ -161,6 +181,7 @@@@ int main(int argc, char *argv[]) {
d75 1
a75 1
@@@@ -176,6 +197,7 @@@@ int main(int argc, char *argv[]) {
@


1.2
log
@
Update to i3-4.8 plus fixes.

Initial diff by Theo Buehler <theo AT math DOT ethz DOT ch>
@
text
@d1 1
a1 1
$OpenBSD: patch-i3-dump-log_main_c,v 1.1 2013/06/02 11:24:06 dcoppa Exp $
d5 2
a6 2
--- i3-dump-log/main.c.orig	Sun Jun 15 19:12:43 2014
+++ i3-dump-log/main.c	Thu Jul  3 21:06:31 2014
d20 1
a20 1
@@@@ -62,17 +66,28 @@@@ static void print_till_end(void) {
d38 1
a38 3
-        {0, 0, 0, 0}};
+        {0, 0, 0, 0}
+    };
d48 1
a48 1
@@@@ -80,11 +95,17 @@@@ int main(int argc, char *argv[]) {
d67 1
a67 1
@@@@ -166,6 +187,7 @@@@ int main(int argc, char *argv[]) {
d75 1
a75 1
@@@@ -181,6 +203,7 @@@@ int main(int argc, char *argv[]) {
@


1.1
log
@Enable SHM logging, now that we have shm_open() and friends.

ok jasper@@
@
text
@d1 1
a1 1
$OpenBSD$
d5 2
a6 2
--- i3-dump-log/main.c.orig	Mon Mar 18 22:43:36 2013
+++ i3-dump-log/main.c	Sun Jun  2 12:28:54 2013
d13 1
a13 1
                 wrap_count;
d20 1
a20 1
@@@@ -62,18 +66,28 @@@@ static void print_till_end(void) {
d38 3
a40 2
         {0, 0, 0, 0}
     };
a41 1
-    char *options_string = "s:vfVh";
d43 1
a43 1
+    char *options_string = "vfVh";
d50 1
a50 1
@@@@ -81,11 +95,17 @@@@ int main(int argc, char *argv[]) {
d69 1
a69 1
@@@@ -167,6 +187,7 @@@@ int main(int argc, char *argv[]) {
d77 1
a77 1
@@@@ -182,6 +203,7 @@@@ int main(int argc, char *argv[]) {
@

