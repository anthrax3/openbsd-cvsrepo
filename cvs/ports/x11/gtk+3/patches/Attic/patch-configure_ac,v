head	1.3;
access;
symbols;
locks; strict;
comment	@# @;


1.3
date	2015.04.07.15.36.54;	author ajacoutot;	state dead;
branches;
next	1.2;
commitid	5mDKRycQzUP5936q;

1.2
date	2015.03.29.07.28.06;	author ajacoutot;	state Exp;
branches;
next	1.1;
commitid	WNAEPNA8MuEkahL8;

1.1
date	2015.03.27.18.14.28;	author ajacoutot;	state Exp;
branches;
next	;
commitid	hf63rp8nF5zQEEJw;


desc
@@


1.3
log
@Update to gtk+3-3.16.1.
@
text
@$OpenBSD: patch-configure_ac,v 1.2 2015/03/29 07:28:06 ajacoutot Exp $

From ae430b1b808c0b930021c843b26faa259c11f3e8 Mon Sep 17 00:00:00 2001
From: Antoine Jacoutot <ajacoutot@@gnome.org>
Date: Fri, 27 Mar 2015 19:04:20 +0100
Subject: make libcanberra support optional

--- configure.ac.orig	Mon Mar 23 02:50:55 2015
+++ configure.ac	Fri Mar 27 18:57:17 2015
@@@@ -1660,11 +1660,34 @@@@ AM_CONDITIONAL(HAVE_COLORD, test "x$have_colord" = "xy
 # Check for libcanberra (only used in examples)
 ##################################################
 
-PKG_CHECK_MODULES(LIBCANBERRA, libcanberra-gtk3,
-                  have_libcanberra=yes, have_libcanberra=no)
+AC_ARG_ENABLE(libcanberra,
+              [AS_HELP_STRING([--enable-libcanberra],
+                              [enable libcanberra support in examples [default=auto]])],
+              [enable_libcanberra="$enableval"],
+              [enable_libcanberra=auto])
+
+AC_MSG_CHECKING([whether to use libcanberra])
+if test "$enable_libcanberra" != "no"; then
+  AC_MSG_RESULT([yes])
+else
+  AC_MSG_RESULT([no])
+fi
+
+have_libcanberra=no
+if test "$enable_libcanberra" != "no"; then
+    PKG_CHECK_MODULES(LIBCANBERRA, libcanberra-gtk3,
+                      have_libcanberra=yes, have_libcanberra=no)
+    if test "$enable_libcanberra" = "yes"; then
+        if test "$have_libcanberra" = "no"; then
+            AC_MSG_ERROR([--enable-libcanberra specified, but not available])
+        fi
+    fi
+fi
+
 if test "$have_libcanberra" = "yes"; then
-        AC_DEFINE(HAVE_LIBCANBERRA, 1, [define if we have libcanberra])
+    AC_DEFINE(HAVE_LIBCANBERRA, 1, [define if we have libcanberra])
 fi
+AM_CONDITIONAL(HAVE_LIBCANBERRA, test "x$have_libcanberra" = "xyes")
 
 ##################################################
 # Checks for gtk-doc and docbook-tools
@@@@ -1938,6 +1961,7 @@@@ echo "        Print backends:       $PRINT_BACKENDS"
 echo "        Dynamic modules:      $build_dynamic_modules"
 echo "        Included immodules:   $included_immodules"
 echo "        colord support:       $have_colord"
+echo "        libcanberra support:  $have_libcanberra"
 echo "        Introspection:        $found_introspection"
 echo "        Debugging:            $enable_debug"
 echo "        Documentation:        $enable_gtk_doc"
@


1.2
log
@Pushed upstream.
@
text
@d1 1
a1 1
$OpenBSD: patch-configure_ac,v 1.1 2015/03/27 18:14:28 ajacoutot Exp $
@


1.1
log
@Do not pick up libcanberra-gtk3 if it's around at build time or this will
create a cyclic dependency.
@
text
@d1 1
a1 1
$OpenBSD$
d3 4
a6 1
https://bugzilla.gnome.org/show_bug.cgi?id=746904
@

