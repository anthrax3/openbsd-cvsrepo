head	1.7;
access;
symbols
	OPENBSD_6_1:1.7.0.6
	OPENBSD_6_1_BASE:1.7
	OPENBSD_6_0:1.7.0.4
	OPENBSD_6_0_BASE:1.7
	OPENBSD_5_9:1.7.0.2
	OPENBSD_5_9_BASE:1.7
	OPENBSD_5_8:1.6.0.14
	OPENBSD_5_8_BASE:1.6
	OPENBSD_5_7:1.6.0.10
	OPENBSD_5_7_BASE:1.6
	OPENBSD_5_6:1.6.0.8
	OPENBSD_5_6_BASE:1.6
	OPENBSD_5_5:1.6.0.6
	OPENBSD_5_5_BASE:1.6
	OPENBSD_5_4:1.6.0.4
	OPENBSD_5_4_BASE:1.6
	OPENBSD_5_3:1.6.0.2
	OPENBSD_5_3_BASE:1.6
	OPENBSD_5_2:1.5.0.10
	OPENBSD_5_2_BASE:1.5
	OPENBSD_5_1_BASE:1.5
	OPENBSD_5_1:1.5.0.8
	OPENBSD_5_0:1.5.0.6
	OPENBSD_5_0_BASE:1.5
	OPENBSD_4_9:1.5.0.4
	OPENBSD_4_9_BASE:1.5
	OPENBSD_4_8:1.5.0.2
	OPENBSD_4_8_BASE:1.5
	OPENBSD_4_7:1.4.0.2
	OPENBSD_4_7_BASE:1.4
	OPENBSD_4_6:1.3.0.2
	OPENBSD_4_6_BASE:1.3
	OPENBSD_4_5:1.1.1.1.0.2
	OPENBSD_4_5_BASE:1.1.1.1
	giovanni_20081030:1.1.1.1
	landry:1.1.1;
locks; strict;
comment	@# @;


1.7
date	2015.09.20.08.39.35;	author landry;	state Exp;
branches;
next	1.6;
commitid	s8lQ8Oh7z9ASYDOv;

1.6
date	2012.09.03.09.34.59;	author ajacoutot;	state Exp;
branches;
next	1.5;

1.5
date	2010.05.04.07.25.54;	author giovanni;	state Exp;
branches;
next	1.4;

1.4
date	2009.08.17.12.14.52;	author giovanni;	state Exp;
branches;
next	1.3;

1.3
date	2009.05.06.16.20.01;	author giovanni;	state Exp;
branches;
next	1.2;

1.2
date	2009.04.06.17.19.02;	author giovanni;	state Exp;
branches;
next	1.1;

1.1
date	2008.10.30.19.32.32;	author landry;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2008.10.30.19.32.32;	author landry;	state Exp;
branches;
next	;


desc
@@


1.7
log
@Update to emelfm2 0.9.1, switches to gtk+3.
@
text
@$OpenBSD: patch-src_filesystem_e2_fs_c,v 1.6 2012/09/03 09:34:59 ajacoutot Exp $
--- src/filesystem/e2_fs.c.orig	Sat Feb 15 01:47:18 2014
+++ src/filesystem/e2_fs.c	Sun Sep 20 09:24:15 2015
@@@@ -57,7 +57,7 @@@@ Not implemented yet.
 #ifdef E2_VFS
 #include "e2_plugins.h"
 #endif
-#if defined(__linux__) || defined(__FreeBSD__)
+#if defined(__linux__) || defined(__FreeBSD__) || defined(__OpenBSD__)
 #include "e2_complete.h"
 #endif
 
@@@@ -2917,7 +2917,7 @@@@ gboolean e2_fs_copy_file (VPATH *src, const struct sta
 	//		blksize_t buf_size = 1048576;
 		//find a buffer up to 16 times dest block
 		//(compromise between accesses and multi-tasking latency)
-		blksize_t buf_size = dest_sb.st_blksize * 16;
+		size_t buf_size = dest_sb.st_blksize * 16;
 		size_t src_size = src_sb->st_size * 2;
 		while (buf_size > src_size && buf_size > dest_sb.st_blksize)
 			buf_size /= 2;
@


1.6
log
@--as-needed works fine here.
Regen patches while here.
@
text
@d1 3
a3 3
$OpenBSD: patch-src_filesystem_e2_fs_c,v 1.5 2010/05/04 07:25:54 giovanni Exp $
--- src/filesystem/e2_fs.c.orig	Sun May 30 02:52:20 2010
+++ src/filesystem/e2_fs.c	Mon Sep  3 11:03:01 2012
d13 1
a13 1
@@@@ -2668,7 +2668,7 @@@@ gboolean e2_fs_copy_file (VPATH *src, const struct sta
@


1.5
log
@
Update to 0.7.2
@
text
@d1 4
a4 4
$OpenBSD: patch-src_filesystem_e2_fs_c,v 1.4 2009/08/17 12:14:52 giovanni Exp $
--- src/filesystem/e2_fs.c.orig	Sun Dec 20 00:52:08 2009
+++ src/filesystem/e2_fs.c	Mon Apr 12 19:47:33 2010
@@@@ -58,7 +58,7 @@@@ Not implemented yet.
d13 1
a13 1
@@@@ -2676,7 +2676,7 @@@@ gboolean e2_fs_copy_file (VPATH *src, const struct sta
@


1.4
log
@
Update to 0.6.2 and fixes wantlib.
ok ajacoutot@@
@
text
@d1 3
a3 3
$OpenBSD: patch-src_filesystem_e2_fs_c,v 1.3 2009/05/06 16:20:01 giovanni Exp $
--- src/filesystem/e2_fs.c.orig	Sat Jun 13 00:50:49 2009
+++ src/filesystem/e2_fs.c	Fri Aug 14 10:52:08 2009
d13 1
a13 10
@@@@ -2570,7 +2570,7 @@@@ is needed
 gint e2_fs_writeflush (gint file_desc)
 {
 	gint res;
-	res = fdatasync (file_desc);
+	res = fsync (file_desc);
 	if (res == -1 && errno == EINVAL)
 		res = 0;
 	return res;
@@@@ -2645,7 +2645,7 @@@@ gboolean e2_fs_copy_file (VPATH *src, const struct sta
@


1.3
log
@
Update to 0.6.0
Regen patches
@
text
@d1 4
a4 4
$OpenBSD: patch-src_filesystem_e2_fs_c,v 1.2 2009/04/06 17:19:02 giovanni Exp $
--- src/filesystem/e2_fs.c.orig	Thu Apr 30 09:56:47 2009
+++ src/filesystem/e2_fs.c	Wed May  6 17:25:13 2009
@@@@ -54,7 +54,7 @@@@ Not implemented yet.
d13 10
a22 1
@@@@ -2606,7 +2606,7 @@@@ gboolean e2_fs_copy_file (VPATH *src, const struct sta
@


1.2
log
@
Update to 0.5.1.
Add some translations
Honour CC
Regen patches
@
text
@d1 3
a3 3
$OpenBSD: patch-src_filesystem_e2_fs_c,v 1.1.1.1 2008/10/30 19:32:32 landry Exp $
--- src/filesystem/e2_fs.c.orig	Tue Feb 10 23:11:01 2009
+++ src/filesystem/e2_fs.c	Thu Mar 19 19:40:14 2009
d13 1
a13 12
@@@@ -1044,8 +1044,8 @@@@ retry:
 	}
 	if (!(fstatus.f_flags & MNT_LOCAL))
 	{
-//		if (errno == EINTR)
-//			goto retry;
+		if (errno == EINTR)
+			goto retry;
 		else if (errno == ENOENT && descend && e2_utils_get_parent_path (localpath, TRUE))
 			goto retry;
 		g_free (localpath);
@@@@ -2538,7 +2538,7 @@@@ gboolean e2_fs_copy_file (VPATH *src, const struct sta
@


1.1
log
@Initial revision
@
text
@d1 3
a3 3
$OpenBSD$
--- src/filesystem/e2_fs.c.orig	Mon Oct 13 11:17:38 2008
+++ src/filesystem/e2_fs.c	Thu Oct 30 18:26:38 2008
d13 12
a24 1
@@@@ -2493,7 +2493,7 @@@@ gboolean e2_fs_copy_file (VPATH *src, const struct sta
@


1.1.1.1
log
@Import of emelfm2 0.5, a Gtk2-based two-pane file manager.
Submitted by Giovanni Bechis (MAINTAINER), with some tweaks by me.

ok ajacoutot@@
@
text
@@
