head	1.4;
access;
symbols
	OPENBSD_6_2:1.4.0.14
	OPENBSD_6_2_BASE:1.4
	OPENBSD_6_1:1.4.0.12
	OPENBSD_6_1_BASE:1.4
	OPENBSD_6_0:1.4.0.10
	OPENBSD_6_0_BASE:1.4
	OPENBSD_5_9:1.4.0.6
	OPENBSD_5_9_BASE:1.4
	OPENBSD_5_8:1.4.0.8
	OPENBSD_5_8_BASE:1.4
	OPENBSD_5_7:1.4.0.4
	OPENBSD_5_7_BASE:1.4
	OPENBSD_5_6:1.4.0.2
	OPENBSD_5_6_BASE:1.4
	OPENBSD_5_5:1.3.0.2
	OPENBSD_5_5_BASE:1.3
	OPENBSD_5_4:1.2.0.2
	OPENBSD_5_4_BASE:1.2
	OPENBSD_5_3:1.1.0.2
	OPENBSD_5_3_BASE:1.1;
locks; strict;
comment	@# @;


1.4
date	2014.03.26.06.50.58;	author dcoppa;	state Exp;
branches;
next	1.3;

1.3
date	2013.10.31.09.03.33;	author dcoppa;	state Exp;
branches;
next	1.2;

1.2
date	2013.04.18.12.00.45;	author gonzalo;	state Exp;
branches;
next	1.1;

1.1
date	2012.09.02.09.22.59;	author landry;	state Exp;
branches;
next	;


desc
@@


1.4
log
@
Some CMake-related fixes:

Honour cflags
Drop unnecessary ZLIB dep
Fix libslim linkage

From gentoo/archlinux/fedora/etc...

ok landry@@ (maintainer)
@
text
@$OpenBSD: patch-CMakeLists_txt,v 1.3 2013/10/31 09:03:33 dcoppa Exp $
--- CMakeLists.txt.orig	Wed Oct  2 00:38:05 2013
+++ CMakeLists.txt	Wed Mar 26 07:50:25 2014
@@@@ -25,7 +25,7 @@@@ set(CMAKE_INSTALL_PREFIX "/usr/local" CACHE PATH "Inst
 set(PKGDATADIR "${CMAKE_INSTALL_PREFIX}/share/slim")
 set(SYSCONFDIR "/etc")
 set(LIBDIR "/lib")
-set(MANDIR "${CMAKE_INSTALL_PREFIX}/share/man")
+set(MANDIR "${CMAKE_INSTALL_PREFIX}/man")
 
 set(SLIM_DEFINITIONS)
 if(${CMAKE_SYSTEM_NAME} MATCHES "FreeBSD" OR
@@@@ -42,11 +42,6 @@@@ set(SLIM_DEFINITIONS ${SLIM_DEFINITIONS} "-DVERSION=\"
 set(SLIM_DEFINITIONS ${SLIM_DEFINITIONS} "-DPKGDATADIR=\"${PKGDATADIR}\"")
 set(SLIM_DEFINITIONS ${SLIM_DEFINITIONS} "-DSYSCONFDIR=\"${SYSCONFDIR}\"")
 
-# Flags
-set(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -Wall -g -O2")
-set(CMAKE_CPP_FLAGS "${CMAKE_CPP_FLAGS} -Wall -g -O2")
-set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -Wall -g -O2")
-
 # source 
 set(slim_srcs
 	main.cpp
@@@@ -101,7 +96,6 @@@@ find_package(X11 REQUIRED)
 find_package(Freetype REQUIRED)
 find_package(JPEG REQUIRED)
 find_package(PNG REQUIRED)
-find_package(ZLIB REQUIRED)
 
 # Fontconfig
 set(FONTCONFIG_DIR ${CMAKE_MODULE_PATH})
@@@@ -158,8 +152,6 @@@@ endif(USE_CONSOLEKIT)
 
 # system librarys
 find_library(M_LIB m)
-find_library(RT_LIB rt)
-find_library(CRYPTO_LIB crypt)
 find_package(Threads)
 
 add_definitions(${SLIM_DEFINITIONS})
@@@@ -172,21 +164,20 @@@@ include_directories(
 	${X11_Xrandr_INCLUDE_PATH}
 	${FREETYPE_INCLUDE_DIR_freetype2}
 	${X11_Xmu_INCLUDE_PATH}
-	${ZLIB_INCLUDE_DIR}
 	${JPEG_INCLUDE_DIR}
 	${PNG_INCLUDE_DIR}
 )
 
 target_link_libraries(libslim
-    ${JPEG_LIBRARIES}
+	${X11_Xft_LIB}
+	${X11_Xrandr_LIB}
+	${JPEG_LIBRARIES}
 	${PNG_LIBRARIES}
 )
 
 #Set up library with all found packages for slim
 target_link_libraries(${PROJECT_NAME}
 	${M_LIB}
-	${RT_LIB}
-	${CRYPTO_LIB}
 	${X11_X11_LIB}
 	${X11_Xft_LIB}
 	${X11_Xrender_LIB}
@@@@ -202,8 +193,6 @@@@ if(BUILD_SLIMLOCK)
     #Set up library with all found packages for slimlock
     target_link_libraries(slimlock
         ${M_LIB}
-        ${RT_LIB}
-        ${CRYPTO_LIB}
         ${X11_X11_LIB}
         ${X11_Xft_LIB}
         ${X11_Xrender_LIB}
@@@@ -221,7 +210,9 @@@@ endif(BUILD_SLIMLOCK)
 ####### install
 # slim
 install(TARGETS slim RUNTIME DESTINATION bin)
+if(BUILD_SLIMLOCK)
 install(TARGETS slimlock RUNTIME DESTINATION bin)
+endif(BUILD_SLIMLOCK)
 
 if (BUILD_SHARED_LIBS)
 	set_target_properties(libslim PROPERTIES
@@@@ -236,9 +227,11 @@@@ endif (BUILD_SHARED_LIBS)
 
 # man file
 install(FILES slim.1 DESTINATION ${MANDIR}/man1/)
+if(BUILD_SLIMLOCK)
 install(FILES slimlock.1 DESTINATION ${MANDIR}/man1/)
+endif(BUILD_SLIMLOCK)
 # configure
-install(FILES slim.conf DESTINATION ${SYSCONFDIR})
+install(FILES slim.conf DESTINATION ${CMAKE_INSTALL_PREFIX}/share/examples/slim/)
 # systemd service file
 if (${CMAKE_SYSTEM_NAME} MATCHES "Linux")
 	install(FILES slim.service DESTINATION ${LIBDIR}/systemd/system)
@


1.3
log
@Update to slim-1.3.6

ok rpe@@, jung@@, landry@@ (maintainer)
@
text
@d1 1
a1 1
$OpenBSD: patch-CMakeLists_txt,v 1.2 2013/04/18 12:00:45 gonzalo Exp $
d3 1
a3 1
+++ CMakeLists.txt	Wed Oct 30 09:16:53 2013
d13 21
a33 1
@@@@ -158,8 +158,6 @@@@ endif(USE_CONSOLEKIT)
d42 17
a58 1
@@@@ -185,8 +183,6 @@@@ target_link_libraries(libslim
d67 1
a67 1
@@@@ -202,8 +198,6 @@@@ if(BUILD_SLIMLOCK)
d76 1
a76 1
@@@@ -221,7 +215,9 @@@@ endif(BUILD_SLIMLOCK)
d86 1
a86 1
@@@@ -236,9 +232,11 @@@@ endif (BUILD_SHARED_LIBS)
@


1.2
log
@Update for Slim to 1.3.5:

 * Support UTF8 string.
 * And fix some bugs.

Ok landry@@ (maintainer)
@
text
@d1 4
a4 5
$OpenBSD: patch-CMakeLists_txt,v 1.1 2012/09/02 09:22:59 landry Exp $
--- CMakeLists.txt.orig	Mon Dec 31 10:03:42 2012
+++ CMakeLists.txt	Wed Apr 17 11:38:56 2013
@@@@ -24,7 +24,7 @@@@ set(SLIM_VERSION "${SLIM_VERSION_MAJOR}.${SLIM_VERSION
 set(CMAKE_INSTALL_PREFIX "/usr/local" CACHE PATH "Installation Directory")
d7 1
d13 1
a13 1
@@@@ -132,8 +132,6 @@@@ endif(USE_CONSOLEKIT)
d19 1
d22 2
a23 3
 
@@@@ -152,8 +150,6 @@@@ include_directories(
 #Set up library with all found packages
d31 21
a51 1
@@@@ -169,8 +165,8 @@@@ install(TARGETS ${PROJECT_NAME} RUNTIME DESTINATION bi
d54 3
d61 2
a62 4
-install(FILES slim.service DESTINATION usr/lib/systemd/system)
+#install(FILES slim.service DESTINATION usr/lib/systemd/system)
 # themes directory
 subdirs(themes)
@


1.1
log
@Update to slim 1.3.4.

- switch to cmake.
- add missing setusercontext() call in switchuser.cpp, now the ulimits
  are properly applied when logging in.
- add support for bsd_auth(3) through auth_userokay(3). Now allows to
  login via login_ldap/login_yubikey/etc...
- add support for consolekit, no need to do ck-launch-session in
  .xinitrc anymore.
- make consolekit support at runtime optional, ie don't badly bail out
  if systemwide dbus daemon is not running. Being discussed with
upstream.
parts based on a diff from 'johnw', ok ajacoutot@@
@
text
@d1 3
a3 3
$OpenBSD$
--- CMakeLists.txt.orig	Tue Jun 26 10:20:14 2012
+++ CMakeLists.txt	Sat Sep  1 20:39:34 2012
d31 1
a31 1
@@@@ -169,6 +165,6 @@@@ install(TARGETS ${PROJECT_NAME} RUNTIME DESTINATION bi
d37 3
@

