head	1.2;
access;
symbols
	OPENBSD_5_2:1.1.0.8
	OPENBSD_5_2_BASE:1.1
	OPENBSD_5_1_BASE:1.1
	OPENBSD_5_1:1.1.0.6
	OPENBSD_5_0:1.1.0.4
	OPENBSD_5_0_BASE:1.1
	OPENBSD_4_9:1.1.0.2
	OPENBSD_4_9_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2012.11.10.15.01.15;	author stsp;	state dead;
branches;
next	1.1;

1.1
date	2011.01.16.00.48.45;	author laurent;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Update e17 EFL components to 1.7.1. ok landry armani
@
text
@$OpenBSD: patch-src_lib_edje_main_c,v 1.1 2011/01/16 00:48:45 laurent Exp $
--- src/lib/edje_main.c.orig	Sun Dec  5 19:34:35 2010
+++ src/lib/edje_main.c	Sun Dec  5 19:37:05 2010
@@@@ -44,6 +44,7 @@@@ Eina_Mempool *_edje_real_part_state_mp = NULL;
 EAPI int
 edje_init(void)
 {
+   char *choice, *tmp;
    if (++_edje_init_count != 1)
      return _edje_init_count;
 
@@@@ -90,7 +91,16 @@@@ edje_init(void)
    _edje_module_init();
    _edje_message_init();
 
-   _edje_real_part_mp = eina_mempool_add("chained_mempool",
+#ifdef EINA_DEFAULT_MEMPOOL
+   choice = "pass_through";
+#else
+   choice = "chained_mempool";
+#endif
+   tmp = getenv("EINA_MEMPOOL");
+   if (tmp && tmp[0])
+      choice = tmp;
+
+   _edje_real_part_mp = eina_mempool_add(choice,
 					 "Edje_Real_Part", NULL,
 					 sizeof (Edje_Real_Part), 128);
    if (!_edje_real_part_mp)
@@@@ -99,7 +109,7 @@@@ edje_init(void)
 	goto shutdown_eet;
      }
 
-   _edje_real_part_state_mp = eina_mempool_add("chained_mempool",
+   _edje_real_part_state_mp = eina_mempool_add(choice,
 					       "Edje_Real_Part_State", NULL,
 					       sizeof (Edje_Real_Part_State), 256);
    if (!_edje_real_part_state_mp)
@


1.1
log
@Update. Fixes by fabien@@, armani@@, Azwaw OUSADOU and jasper@@ .
@
text
@d1 1
a1 1
$OpenBSD$
@

