head	1.121;
access;
symbols
	OPENBSD_6_2:1.121.0.2
	OPENBSD_6_2_BASE:1.121
	OPENBSD_6_1:1.118.0.2
	OPENBSD_6_1_BASE:1.118
	OPENBSD_6_0:1.116.0.2
	OPENBSD_6_0_BASE:1.116
	OPENBSD_5_9:1.115.0.2
	OPENBSD_5_9_BASE:1.115
	OPENBSD_5_8:1.114.0.4
	OPENBSD_5_8_BASE:1.114
	OPENBSD_5_7:1.113.0.2
	OPENBSD_5_7_BASE:1.113
	OPENBSD_5_6:1.111.0.2
	OPENBSD_5_6_BASE:1.111
	OPENBSD_5_5:1.110.0.2
	OPENBSD_5_5_BASE:1.110
	OPENBSD_5_4:1.109.0.2
	OPENBSD_5_4_BASE:1.109
	OPENBSD_5_3:1.104.0.2
	OPENBSD_5_3_BASE:1.104
	OPENBSD_5_2:1.101.0.4
	OPENBSD_5_2_BASE:1.101
	OPENBSD_5_1_BASE:1.101
	OPENBSD_5_1:1.101.0.2
	OPENBSD_5_0:1.97.0.4
	OPENBSD_5_0_BASE:1.97
	OPENBSD_4_9:1.97.0.2
	OPENBSD_4_9_BASE:1.97
	OPENBSD_4_8:1.92.0.2
	OPENBSD_4_8_BASE:1.92
	OPENBSD_4_7:1.89.0.2
	OPENBSD_4_7_BASE:1.89
	OPENBSD_4_6:1.88.0.6
	OPENBSD_4_6_BASE:1.88
	OPENBSD_4_5:1.88.0.4
	OPENBSD_4_5_BASE:1.88
	OPENBSD_4_4:1.88.0.2
	OPENBSD_4_4_BASE:1.88
	OPENBSD_4_3:1.84.0.2
	OPENBSD_4_3_BASE:1.84
	OPENBSD_4_2:1.79.0.2
	OPENBSD_4_2_BASE:1.79
	OPENBSD_4_1:1.73.0.2
	OPENBSD_4_1_BASE:1.73
	OPENBSD_4_0:1.62.0.2
	OPENBSD_4_0_BASE:1.62
	OPENBSD_3_9:1.60.0.2
	OPENBSD_3_9_BASE:1.60
	OPENBSD_3_8:1.50.0.2
	OPENBSD_3_8_BASE:1.50
	OPENBSD_3_7:1.47.0.2
	OPENBSD_3_7_BASE:1.47
	OPENBSD_3_6:1.36.0.2
	OPENBSD_3_6_BASE:1.36
	OPENBSD_3_5:1.34.0.2
	OPENBSD_3_5_BASE:1.34
	OPENBSD_3_4:1.29.0.2
	OPENBSD_3_4_BASE:1.29
	OPENBSD_3_3:1.26.0.2
	OPENBSD_3_3_BASE:1.26
	OPENBSD_3_2:1.13.0.2
	OPENBSD_3_2_BASE:1.13
	OPENBSD_3_1:1.9.0.2
	OPENBSD_3_1_BASE:1.9
	espie:1.1.1.1
	qt3:1.1.1;
locks; strict;
comment	@# @;


1.121
date	2017.07.26.22.45.33;	author sthen;	state Exp;
branches;
next	1.120;
commitid	tD4MFrpYYDDL2UFT;

1.120
date	2017.07.16.19.19.06;	author espie;	state Exp;
branches;
next	1.119;
commitid	tt0GhWK5c4uf9ILG;

1.119
date	2017.04.10.11.46.36;	author sthen;	state Exp;
branches;
next	1.118;
commitid	HY6VNZxjJWzKQFDV;

1.118
date	2017.03.03.12.43.10;	author espie;	state Exp;
branches;
next	1.117;
commitid	FvbxazJuq8u70aXi;

1.117
date	2016.12.26.08.55.05;	author zhuk;	state Exp;
branches;
next	1.116;
commitid	lCp310GgnWuKTJxI;

1.116
date	2016.03.23.21.58.11;	author naddy;	state Exp;
branches;
next	1.115;
commitid	MWaMMZrgHxuKpBbb;

1.115
date	2015.08.24.10.01.10;	author sthen;	state Exp;
branches;
next	1.114;
commitid	2huNwQ3eew4irBXJ;

1.114
date	2015.05.22.11.31.20;	author ajacoutot;	state Exp;
branches;
next	1.113;
commitid	2khjHXfpTaOuNVcx;

1.113
date	2014.09.16.19.56.10;	author miod;	state Exp;
branches;
next	1.112;
commitid	qDBOPrPo8GxXpZDD;

1.112
date	2014.09.13.18.09.22;	author brad;	state Exp;
branches;
next	1.111;
commitid	PpbRjVZdAmlrmi8q;

1.111
date	2014.07.13.09.03.15;	author armani;	state Exp;
branches;
next	1.110;
commitid	T3d2C041Mo2U7oSb;

1.110
date	2013.11.25.14.16.24;	author sthen;	state Exp;
branches;
next	1.109;

1.109
date	2013.06.12.20.36.34;	author brad;	state Exp;
branches;
next	1.108;

1.108
date	2013.06.04.18.42.00;	author naddy;	state Exp;
branches;
next	1.107;

1.107
date	2013.05.25.00.33.11;	author brad;	state Exp;
branches;
next	1.106;

1.106
date	2013.04.29.10.44.43;	author espie;	state Exp;
branches;
next	1.105;

1.105
date	2013.03.11.11.46.15;	author espie;	state Exp;
branches;
next	1.104;

1.104
date	2013.02.09.14.49.54;	author sthen;	state Exp;
branches;
next	1.103;

1.103
date	2012.08.18.12.41.39;	author ajacoutot;	state Exp;
branches;
next	1.102;

1.102
date	2012.08.04.15.06.55;	author ajacoutot;	state Exp;
branches;
next	1.101;

1.101
date	2011.10.02.07.03.11;	author espie;	state Exp;
branches;
next	1.100;

1.100
date	2011.09.16.12.29.17;	author espie;	state Exp;
branches;
next	1.99;

1.99
date	2011.09.03.08.21.14;	author landry;	state Exp;
branches;
next	1.98;

1.98
date	2011.08.28.07.57.40;	author espie;	state Exp;
branches;
next	1.97;

1.97
date	2010.11.27.11.54.53;	author espie;	state Exp;
branches;
next	1.96;

1.96
date	2010.11.22.09.40.48;	author espie;	state Exp;
branches;
next	1.95;

1.95
date	2010.11.22.08.37.04;	author espie;	state Exp;
branches;
next	1.94;

1.94
date	2010.10.24.21.15.34;	author ajacoutot;	state Exp;
branches;
next	1.93;

1.93
date	2010.10.19.08.13.59;	author espie;	state Exp;
branches;
next	1.92;

1.92
date	2010.07.30.12.03.09;	author ajacoutot;	state Exp;
branches;
next	1.91;

1.91
date	2010.07.30.06.59.00;	author ajacoutot;	state Exp;
branches;
next	1.90;

1.90
date	2010.05.09.16.19.22;	author robert;	state Exp;
branches;
next	1.89;

1.89
date	2010.02.26.18.04.07;	author espie;	state Exp;
branches;
next	1.88;

1.88
date	2008.07.27.21.44.59;	author sthen;	state Exp;
branches;
next	1.87;

1.87
date	2008.07.25.20.25.59;	author sthen;	state Exp;
branches;
next	1.86;

1.86
date	2008.05.31.15.54.38;	author naddy;	state Exp;
branches;
next	1.85;

1.85
date	2008.05.31.09.50.34;	author espie;	state Exp;
branches;
next	1.84;

1.84
date	2008.01.04.17.48.38;	author espie;	state Exp;
branches;
next	1.83;

1.83
date	2007.12.28.18.53.20;	author espie;	state Exp;
branches;
next	1.82;

1.82
date	2007.12.28.17.45.04;	author espie;	state Exp;
branches;
next	1.81;

1.81
date	2007.10.25.09.29.38;	author wilfried;	state Exp;
branches;
next	1.80;

1.80
date	2007.09.15.20.04.23;	author merdely;	state Exp;
branches;
next	1.79;

1.79
date	2007.08.05.12.31.20;	author ajacoutot;	state Exp;
branches;
next	1.78;

1.78
date	2007.05.14.08.22.00;	author espie;	state Exp;
branches;
next	1.77;

1.77
date	2007.05.09.11.48.17;	author bernd;	state Exp;
branches;
next	1.76;

1.76
date	2007.03.31.22.49.46;	author espie;	state Exp;
branches;
next	1.75;

1.75
date	2007.03.28.23.18.09;	author espie;	state Exp;
branches;
next	1.74;

1.74
date	2007.03.26.21.22.13;	author espie;	state Exp;
branches;
next	1.73;

1.73
date	2007.02.17.18.59.04;	author espie;	state Exp;
branches
	1.73.2.1;
next	1.72;

1.72
date	2007.01.29.09.24.13;	author espie;	state Exp;
branches;
next	1.71;

1.71
date	2007.01.22.18.18.28;	author espie;	state Exp;
branches;
next	1.70;

1.70
date	2007.01.04.18.34.46;	author espie;	state Exp;
branches;
next	1.69;

1.69
date	2006.11.28.19.15.47;	author espie;	state Exp;
branches;
next	1.68;

1.68
date	2006.11.26.09.10.43;	author sturm;	state Exp;
branches;
next	1.67;

1.67
date	2006.11.25.18.35.45;	author espie;	state Exp;
branches;
next	1.66;

1.66
date	2006.11.20.20.41.00;	author espie;	state Exp;
branches;
next	1.65;

1.65
date	2006.10.24.22.39.36;	author espie;	state Exp;
branches;
next	1.64;

1.64
date	2006.10.18.18.05.31;	author espie;	state Exp;
branches;
next	1.63;

1.63
date	2006.09.18.10.21.49;	author espie;	state Exp;
branches;
next	1.62;

1.62
date	2006.03.07.19.29.19;	author espie;	state Exp;
branches
	1.62.2.1;
next	1.61;

1.61
date	2006.03.04.10.07.10;	author espie;	state Exp;
branches;
next	1.60;

1.60
date	2006.02.27.16.40.25;	author espie;	state Exp;
branches
	1.60.2.1;
next	1.59;

1.59
date	2006.01.13.19.18.50;	author espie;	state Exp;
branches;
next	1.58;

1.58
date	2006.01.02.16.59.37;	author espie;	state Exp;
branches;
next	1.57;

1.57
date	2005.12.28.16.50.58;	author espie;	state Exp;
branches;
next	1.56;

1.56
date	2005.12.27.18.04.32;	author espie;	state Exp;
branches;
next	1.55;

1.55
date	2005.11.10.11.15.13;	author espie;	state Exp;
branches;
next	1.54;

1.54
date	2005.09.19.10.24.56;	author espie;	state Exp;
branches;
next	1.53;

1.53
date	2005.09.18.09.08.42;	author espie;	state Exp;
branches;
next	1.52;

1.52
date	2005.09.18.00.52.40;	author espie;	state Exp;
branches;
next	1.51;

1.51
date	2005.09.16.09.51.28;	author espie;	state Exp;
branches;
next	1.50;

1.50
date	2005.08.31.22.01.09;	author espie;	state Exp;
branches
	1.50.2.1;
next	1.49;

1.49
date	2005.05.18.14.24.32;	author espie;	state Exp;
branches;
next	1.48;

1.48
date	2005.04.09.21.24.12;	author espie;	state Exp;
branches;
next	1.47;

1.47
date	2005.02.27.16.03.14;	author espie;	state Exp;
branches;
next	1.46;

1.46
date	2005.02.03.20.05.56;	author espie;	state Exp;
branches;
next	1.45;

1.45
date	2004.12.19.13.09.45;	author alek;	state Exp;
branches;
next	1.44;

1.44
date	2004.11.09.21.59.42;	author espie;	state Exp;
branches;
next	1.43;

1.43
date	2004.10.31.08.49.40;	author espie;	state Exp;
branches;
next	1.42;

1.42
date	2004.10.30.09.12.35;	author espie;	state Exp;
branches;
next	1.41;

1.41
date	2004.10.27.19.57.16;	author espie;	state Exp;
branches;
next	1.40;

1.40
date	2004.10.26.23.04.12;	author espie;	state Exp;
branches;
next	1.39;

1.39
date	2004.10.26.22.59.24;	author espie;	state Exp;
branches;
next	1.38;

1.38
date	2004.09.20.20.05.51;	author brad;	state Exp;
branches;
next	1.37;

1.37
date	2004.09.15.19.25.12;	author espie;	state Exp;
branches;
next	1.36;

1.36
date	2004.07.28.03.15.37;	author brad;	state Exp;
branches;
next	1.35;

1.35
date	2004.07.22.23.03.08;	author brad;	state Exp;
branches;
next	1.34;

1.34
date	2004.02.25.02.35.18;	author naddy;	state Exp;
branches
	1.34.2.1;
next	1.33;

1.33
date	2004.02.04.07.39.19;	author sturm;	state Exp;
branches;
next	1.32;

1.32
date	2004.01.22.21.03.59;	author espie;	state Exp;
branches;
next	1.31;

1.31
date	2004.01.08.01.12.59;	author brad;	state Exp;
branches;
next	1.30;

1.30
date	2003.10.08.17.13.17;	author sturm;	state Exp;
branches;
next	1.29;

1.29
date	2003.05.13.00.26.32;	author naddy;	state Exp;
branches
	1.29.2.1;
next	1.28;

1.28
date	2003.04.10.18.08.57;	author jsyn;	state Exp;
branches;
next	1.27;

1.27
date	2003.04.05.14.45.19;	author espie;	state Exp;
branches;
next	1.26;

1.26
date	2003.02.09.19.17.32;	author espie;	state Exp;
branches;
next	1.25;

1.25
date	2003.01.09.23.06.30;	author espie;	state Exp;
branches;
next	1.24;

1.24
date	2003.01.07.01.23.20;	author espie;	state Exp;
branches;
next	1.23;

1.23
date	2003.01.06.06.22.52;	author espie;	state Exp;
branches;
next	1.22;

1.22
date	2002.12.31.02.09.51;	author espie;	state Exp;
branches;
next	1.21;

1.21
date	2002.12.29.16.13.28;	author espie;	state Exp;
branches;
next	1.20;

1.20
date	2002.12.18.05.19.45;	author brad;	state Exp;
branches;
next	1.19;

1.19
date	2002.11.23.22.00.20;	author espie;	state Exp;
branches;
next	1.18;

1.18
date	2002.11.23.18.52.22;	author espie;	state Exp;
branches;
next	1.17;

1.17
date	2002.11.18.02.03.12;	author brad;	state Exp;
branches;
next	1.16;

1.16
date	2002.11.13.22.55.54;	author naddy;	state Exp;
branches;
next	1.15;

1.15
date	2002.10.29.19.48.58;	author naddy;	state Exp;
branches;
next	1.14;

1.14
date	2002.10.26.11.45.52;	author espie;	state Exp;
branches;
next	1.13;

1.13
date	2002.08.21.13.52.39;	author espie;	state Exp;
branches;
next	1.12;

1.12
date	2002.08.02.22.13.19;	author naddy;	state Exp;
branches;
next	1.11;

1.11
date	2002.07.17.21.43.36;	author espie;	state Exp;
branches;
next	1.10;

1.10
date	2002.05.27.14.49.30;	author brad;	state Exp;
branches;
next	1.9;

1.9
date	2002.03.30.18.13.31;	author brad;	state Exp;
branches;
next	1.8;

1.8
date	2002.03.30.01.02.49;	author espie;	state Exp;
branches;
next	1.7;

1.7
date	2002.03.27.12.36.35;	author espie;	state Exp;
branches;
next	1.6;

1.6
date	2002.03.23.23.35.46;	author lebel;	state Exp;
branches;
next	1.5;

1.5
date	2002.03.23.17.35.12;	author lebel;	state Exp;
branches;
next	1.4;

1.4
date	2002.03.12.00.16.12;	author espie;	state Exp;
branches;
next	1.3;

1.3
date	2002.03.05.14.46.32;	author espie;	state Exp;
branches;
next	1.2;

1.2
date	2002.03.05.12.40.52;	author espie;	state Exp;
branches;
next	1.1;

1.1
date	2002.03.04.16.13.04;	author espie;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2002.03.04.16.13.04;	author espie;	state Exp;
branches;
next	;

1.29.2.1
date	2004.10.01.01.51.41;	author brad;	state Exp;
branches;
next	;

1.34.2.1
date	2004.10.01.17.50.07;	author brad;	state Exp;
branches;
next	;

1.50.2.1
date	2006.10.30.20.59.12;	author sturm;	state Exp;
branches;
next	;

1.60.2.1
date	2006.10.29.17.48.54;	author sturm;	state Exp;
branches;
next	1.60.2.2;

1.60.2.2
date	2006.10.29.17.50.15;	author sturm;	state Exp;
branches;
next	1.60.2.3;

1.60.2.3
date	2007.04.06.11.37.17;	author sturm;	state Exp;
branches;
next	;

1.62.2.1
date	2006.11.01.08.59.09;	author sturm;	state Exp;
branches;
next	1.62.2.2;

1.62.2.2
date	2006.11.01.12.25.47;	author sturm;	state Exp;
branches;
next	1.62.2.3;

1.62.2.3
date	2007.04.06.10.28.07;	author sturm;	state Exp;
branches;
next	;

1.73.2.1
date	2007.05.01.16.27.22;	author sturm;	state Exp;
branches;
next	;


desc
@@


1.121
log
@bump LIBCXX/LIBECXX/COMPILER_LIBCXX ports.
@
text
@# $OpenBSD: Makefile,v 1.120 2017/07/16 19:19:06 espie Exp $

# no libGL (toolchain issue)
NOT_FOR_ARCHS= m88k

COMMENT-main=		C++ X11 GUI toolkit
COMMENT-examples=	examples and tutorial for qt3
COMMENT-html=		off-line html documentation for qt3
COMMENT-postgresql=	PostgresSQL plugin for qt3
COMMENT-mysql=		MySQL plugin for qt3
COMMENT-sqlite2=	sqlite2 plugin for qt3

PKGNAME=		qt3-${VERSION}
PKGNAME-mysql=		qt3-mysql-${VERSION}
PKGNAME-postgresql=	qt3-postgresql-${VERSION}
PKGNAME-examples=	qt3-examples-${VERSION}
PKGNAME-main=		qt3-mt-${VERSION}
FULLPKGNAME-html=	qt3-html-${VERSION}
FULLPKGPATH-html=	x11/qt3,-html
PKGNAME-sqlite2=	qt3-sqlite2-${VERSION}

REVISION-mysql= 	11
REVISION-postgresql= 	8
REVISION-main= 		13
REVISION-html= 		3
REVISION-examples=	4
REVISION-sqlite2= 	8

# the qt-mt library version number is used in a directory name.
# when bumping, be sure to also bump MODQT3_PLUGINS in qt3.port.mk
# and PKGNAME of any affected packages (qt3-mysql, qt3-postgresql,
# qt3-sqlite2, and others with MODQT_PLUGINS in their PLIST).
SHARED_LIBS=		qt-mt	33.0 \
			qui	2.0 \
			qui-mt	2.0

# note that qui-mt is a `false' library, just a link to qui.

# XXX be sure to update the qt3.port.mk version after a qt bump.
QT_PLUGINS=		plugins-${LIBqt-mt_VERSION:R}


VERSION=	3.8
DISTNAME=	qt-x11-free-3.${VERSION}
CATEGORIES=	x11
MASTER_SITES=	http://download.qt-project.org/archive/qt/3/

# Old official site
#MASTER_SITES0=	http://freedesktop.org/~daisuke/
MASTER_SITES0=	ftp://gd.tuwien.ac.at/opsys/linux/gentoo/distfiles/


PATCHFILES=	qt-x11-immodule-unified-qt3.3.8-20070321-gentoo.diff.bz2:0
PATCH_DIST_STRIP=	-p1

pre-configure:
	cd ${WRKDIST} && /bin/sh ./make-symlinks.sh

HOMEPAGE=	http://www.trolltech.com/qt/

MAINTAINER=	Marc Espie <espie@@openbsd.org>

FLAVORS=debug

PSEUDO_FLAVORS=	no_mysql no_postgresql no_sqlite2 no_examples
FLAVOR?=

# GPL/QPL
PERMIT_PACKAGE_CDROM=	Yes

USE_GROFF =	Yes
MAKE_ENV=	QTDIR="${WRKDIST}" EXTRA_SAMPLES="${EXTRA_SAMPLES}" \
		SYS_CXX="${CXX}" SYS_CXXFLAGS="${CXXFLAGS}" \
		LD_LIBRARY_PATH="${WRKDIST}/lib"

# For qsettings to write its setup
PORTHOME=	${WRKDIST}

MAKE_FLAGS=	DESIGNER_SUBDIR=dummy \
		LIBqt-mt_VERSION=$(LIBqt-mt_VERSION) \
		LIBqui_VERSION=$(LIBqui_VERSION)

CONFIGURE_STYLE= simple
CONFIGURE_ARGS=	-qt-gif -system-libmng -system-libpng -system-libjpeg -system-zlib \
		-qt-imgfmt-mng -qt-imgfmt-png -qt-imgfmt-jpeg -sm -no-g++-exceptions \
		-v -stl -xrender -xft -fast \
		-no-sql-odbc \
		-tablet \
		-xinerama \
		-cups \
		-inputmethod \
		-I${X11BASE}/include/freetype2 \
		-I${LOCALBASE}/include \
		-L${WRKSRC}/lib \
		-L${LOCALBASE}/lib

MULTI_PACKAGES+=-main -html -examples -mysql -postgresql -sqlite2

.if ${FLAVOR:Mdebug}
CONFIGURE_ARGS+=-debug
PKGDEBUG=-debug
FLAVOR += no_examples
.else
PKGDEBUG=
.endif

CONFIGURE_ARGS+=-thread

.include <bsd.port.arch.mk>

.if !${BUILD_PACKAGES:M-examples}
ALL_TARGET=sub-src sub-tools
.endif

# This is needed to find plugins
CONFIGURE_ARGS+=	-prefix ${QT_LIBDIR}
CONFIGURE_ARGS+=	-plugindir ${QT_PLUGINSDIR}

CONFIGURE_ENV=	QTDIR="${WRKSRC}" 

LIB_DEPENDS=
BUILD_DEPENDS=print/cups,-libs

.if ${BUILD_PACKAGES:M-mysql}
CONFIGURE_ARGS+= -I${LOCALBASE}/include/mysql -L${LOCALBASE}/lib/mysql \
	-plugin-sql-mysql
.else
CONFIGURE_ARGS+=-no-sql-mysql
.endif


.if ${BUILD_PACKAGES:M-postgresql}
BUILD_DEPENDS+=databases/postgresql,-server
CONFIGURE_ARGS+= -I${LOCALBASE}/include/postgresql \
	    -I${LOCALBASE}/include/postgresql/server \
	    -L${LOCALBASE}/lib \
	    -I${LOCALBASE}/include -plugin-sql-psql
.else
CONFIGURE_ARGS+=-no-sql-psql
.endif

.if ${BUILD_PACKAGES:M-sqlite2}
CONFIGURE_ARGS+= -plugin-sql-sqlite
.else
CONFIGURE_ARGS+=-no-sql-sqlite
.endif


LIB_DEPENDS=		graphics/png \
			graphics/libmng
WANTLIB=		GL GLU ICE SM X11>=10 Xcursor Xext Xft Xi Xinerama \
			Xmu png mng \
			Xrandr Xrender fontconfig freetype jpeg lcms m \
			${COMPILER_LIBCXX} z pthread


WANTLIB-main=		${WANTLIB} pthread c


LIB_DEPENDS-mysql=	${LIB_DEPENDS} \
			${BUILD_PKGPATH} \
			databases/mariadb
WANTLIB-mysql=		${WANTLIB} qt-mt mysqlclient

LIB_DEPENDS-postgresql=	${LIB_DEPENDS} \
			${BUILD_PKGPATH} \
			databases/postgresql
WANTLIB-postgresql=	${WANTLIB} pq qt-mt

LIB_DEPENDS-sqlite2=	${LIB_DEPENDS} \
			${BUILD_PKGPATH} \
			databases/sqlite
WANTLIB-sqlite2=	${WANTLIB} qt-mt sqlite

LIB_DEPENDS-examples=	${LIB_DEPENDS} \
			${BUILD_PKGPATH}
WANTLIB-examples=	${WANTLIB} ${COMPILER_LIBCXX} c qt-mt


LIB_DEPENDS-html=
WANTLIB-html=
PKG_ARCH-html=		*


QT_INCDIR=	${PREFIX}/include/X11/qt3
TRUEDIR=	${TRUEPREFIX}/lib/qt3
QT_LIBDIR=	${PREFIX}/lib/qt3
QT_MANDIR=	${QT_LIBDIR}/man
QT_EXAMPLES=	${QT_LIBDIR}/examples
QT_TUTORIAL=	${QT_LIBDIR}/tutorial
QT_DOC=		${PREFIX}/share/doc/qt3
QT_PLUGINSDIR=	${QT_LIBDIR}/${QT_PLUGINS}
QT_BINDIR=	${QT_LIBDIR}/bin

# for manpages in MESSAGE
SUBST_VARS=	QT_LIBDIR QT_DOC QT_PLUGINS

DOCS=	FAQ LICENSE.GPL README README-QT.TXT \
	changes-3* \
	README.immodule changes.immodule

NO_TEST=	Yes

PROGRAMS3=designer findtr moc qt20fix qtrename140 uic
PROGRAMS=assistant linguist lrelease lupdate qm2ts qmake qtconfig 

post-configure:
	perl -pi.bak -e 's,-L(\Q${WRKDIST}\E|\Q$$(LOCALBASE)\E)/lib,,' ${WRKDIST}/lib/qt-mt.pc
.if !${FLAVOR:Mdebug}
	@@cd ${WRKSRC} && cp -R examples examples-src
	@@find ${WRKSRC}/examples-src -name '*.orig' |xargs rm -f
	@@find ${WRKSRC}/examples-src -name '.moc' |xargs rm -rf
	@@find ${WRKSRC}/examples-src -name '.obj' |xargs rm -rf
	@@cd ${WRKSRC} && cp -R tutorial tutorial-src
	@@find ${WRKSRC}/tutorial-src -name '*.orig' |xargs rm -f
	@@find ${WRKSRC}/tutorial-src -name '.moc' |xargs rm -rf
	@@find ${WRKSRC}/tutorial-src -name '.obj' |xargs rm -rf

pre-install:
	${INSTALL_DATA_DIR} ${QT_EXAMPLES}
	${INSTALL_DATA_DIR} ${QT_TUTORIAL}
	# examples
	cp -R ${WRKSRC}/examples-src/* ${QT_EXAMPLES}
	@@cd ${WRKSRC}/examples; for i in *; do \
	if [ -x $$i/$$i ]; then \
	    ${INSTALL_PROGRAM} $$i/$$i ${QT_EXAMPLES}/$$i; \
	fi; done
	@@if [ -x ${WRKSRC}/examples/overlay_x11/overlayrubber ]; then \
	    ${INSTALL_PROGRAM} ${WRKSRC}/examples/overlay_x11/overlayrubber \
	    	${QT_EXAMPLES}/overlay_x11/overlayrubber; \
	fi
	cp -R ${WRKSRC}/tutorial-src/* ${QT_TUTORIAL}
	@@cd ${WRKSRC}/tutorial; for i in *; do \
	if [ -x $$i/$$i ]; then \
	    ${INSTALL_PROGRAM} $$i/$$i ${QT_TUTORIAL}/$$i; \
	fi; done
.else

post-patch:
	@@rm -rf ${WRKSRC}/examples
	@@rm -rf ${WRKSRC}/tutorial

.endif

do-install:
	${INSTALL_DATA_DIR} ${PREFIX}/lib/pkgconfig
	${INSTALL_DATA} ${WRKDIST}/lib/qt-mt.pc ${PREFIX}/lib/pkgconfig
	${INSTALL_DATA_DIR} ${QT_INCDIR}
	${INSTALL_MAN_DIR} ${QT_MANDIR}/man1
	${INSTALL_MAN_DIR} ${QT_MANDIR}/man3
	${INSTALL_DATA_DIR} ${QT_DOC}/html
	# includes
	${INSTALL_DATA_DIR} ${QT_INCDIR}/private
	${INSTALL_DATA} ${WRKSRC}/include/*.h ${QT_INCDIR}
	${INSTALL_DATA} ${WRKSRC}/include/private/*.h ${QT_INCDIR}/private
	${INSTALL_DATA_DIR} ${QT_BINDIR} ${QT_PLUGINSDIR}
	# documentation
	${INSTALL_MAN} ${WRKSRC}/doc/man/man1/lrelease.1 ${QT_MANDIR}/man1
	${INSTALL_MAN} ${WRKSRC}/doc/man/man1/lupdate.1 ${QT_MANDIR}/man1
	${INSTALL_MAN} ${WRKSRC}/doc/man/man1/moc.1 ${QT_MANDIR}/man1/moc3.1
	${INSTALL_MAN} ${WRKSRC}/doc/man/man1/uic.1 ${QT_MANDIR}/man1/uic3.1
	${INSTALL_MAN} ${WRKSRC}/tools/linguist/qm2ts/qm2ts.1 ${QT_MANDIR}/man1
	@@for i in ${WRKSRC}/doc/man/man3/*; do \
	  j=$${i%qt}; \
	  sed -e 's,\.3qt,\.3,g' <$$i >$$j && \
	  	${INSTALL_MAN} $$j ${QT_MANDIR}/man3; \
	done
	cd ${WRKSRC}; ${INSTALL_DATA} ${DOCS} ${QT_DOC}
	cp -R ${WRKSRC}/doc/html/* ${QT_DOC}/html
	cp -R ${WRKSRC}/mkspecs ${QT_LIBDIR}/mkspecs
	# libraries
	@@if [ -f ${WRKBUILD}/lib/libqt-mt.a ]; then \
	 ${INSTALL_DATA} ${WRKBUILD}/lib/libqt-mt.a ${PREFIX}/lib/qt3; \
	fi
	@@if [ -f  ${WRKBUILD}/lib/libqt-mt.so.$(LIBqt-mt_VERSION) ]; then \
	 ${INSTALL_DATA} ${WRKBUILD}/lib/libqt-mt.so.$(LIBqt-mt_VERSION) ${PREFIX}/lib/qt3; \
	 ln -sf qt3/libqt-mt.so.$(LIBqt-mt_VERSION) ${PREFIX}/lib; \
	fi
	@@if [ -f ${WRKBUILD}/lib/libqui.a ]; then \
	 ${INSTALL_DATA} ${WRKBUILD}/lib/libqui.a ${PREFIX}/lib/qt3; \
	fi
	@@if [ -f  ${WRKBUILD}/lib/libqui.so.$(LIBqui_VERSION) ]; then \
	 ${INSTALL_DATA} ${WRKBUILD}/lib/libqui.so.$(LIBqui_VERSION) ${PREFIX}/lib/qt3; \
	 ln -sf qt3/libqui.so.$(LIBqui_VERSION) ${PREFIX}/lib; \
	fi
	@@${INSTALL_DATA} ${WRKBUILD}/lib/libeditor.a ${PREFIX}/lib/qt3
	@@${INSTALL_DATA} ${WRKBUILD}/lib/libdesignercore.a ${PREFIX}/lib/qt3
	@@${INSTALL_DATA} ${WRKBUILD}/lib/libqassistantclient.a ${PREFIX}/lib/qt3
.for p in ${PROGRAMS3}
	${INSTALL_PROGRAM} ${WRKBUILD}/bin/$p ${QT_BINDIR}/$p
	@@ln -sf ${TRUEPREFIX}/lib/qt3/bin/$p ${PREFIX}/bin/$p3
.endfor
.for p in ${PROGRAMS}
	${INSTALL_PROGRAM} ${WRKBUILD}/bin/$p ${QT_BINDIR}/$p
	@@ln -sf ${TRUEPREFIX}/lib/qt3/bin/$p ${PREFIX}/bin/$p
.endfor
	# plugins
	${INSTALL_DATA_DIR} ${QT_PLUGINSDIR}/designer \
		${QT_PLUGINSDIR}/sqldrivers ${QT_PLUGINSDIR}/styles \
		${QT_PLUGINSDIR}/inputmethods

.if ${BUILD_PACKAGES:M-postgresql}
	${INSTALL_DATA} ${WRKBUILD}/plugins/sqldrivers/libqsqlpsql.so \
	    ${QT_PLUGINSDIR}/sqldrivers
.endif
.if ${BUILD_PACKAGES:M-mysql}
	${INSTALL_DATA} ${WRKBUILD}/plugins/sqldrivers/libqsqlmysql.so \
	    ${QT_PLUGINSDIR}/sqldrivers
.endif
.if ${BUILD_PACKAGES:M-sqlite2}
	${INSTALL_DATA} ${WRKBUILD}/plugins/sqldrivers/libqsqlite.so \
	    ${QT_PLUGINSDIR}/sqldrivers
.endif
	${INSTALL_DATA} ${WRKBUILD}/plugins/designer/libwizards.so \
	    ${QT_PLUGINSDIR}/designer
	${INSTALL_DATA} ${WRKBUILD}/plugins/designer/libcppeditor.so \
	    ${QT_PLUGINSDIR}/designer
	${INSTALL_DATA} ${WRKBUILD}/plugins/designer/libdlgplugin.so \
	    ${QT_PLUGINSDIR}/designer
	${INSTALL_DATA} ${WRKBUILD}/plugins/designer/librcplugin.so \
	    ${QT_PLUGINSDIR}/designer
	${INSTALL_DATA} ${WRKBUILD}/plugins/inputmethods/libqimsw-multi.so \
	    ${QT_PLUGINSDIR}/inputmethods
	${INSTALL_DATA} ${WRKBUILD}/plugins/inputmethods/libqimsw-none.so \
	    ${QT_PLUGINSDIR}/inputmethods
	${INSTALL_DATA} ${WRKBUILD}/plugins/inputmethods/libqsimple.so \
	    ${QT_PLUGINSDIR}/inputmethods
	${INSTALL_DATA} ${WRKBUILD}/plugins/inputmethods/libqxim.so \
	    ${QT_PLUGINSDIR}/inputmethods
# compatibility transition
.for p in ${PROGRAMS}
	cd ${PREFIX}/bin && ln -sf $p $p-mt
.  endfor
.for p in ${PROGRAMS3}
	cd ${PREFIX}/bin && ln -sf $p3 $p3-mt
.endfor
	cd ${PREFIX}/lib && ln -sf libqui.so.$(LIBqui_VERSION) libqui-mt.so.$(LIBqui_VERSION)
	cd ${PREFIX}/lib/qt3 && ln -sf libqui.so.$(LIBqui_VERSION) libqui-mt.so.$(LIBqui_VERSION)
# links for qtdir
	cd ${PREFIX}/lib/qt3 && ln -sf . lib
	cd ${PREFIX}/lib/qt3 && ln -sf ../../include/X11/qt3 include
# fix for qmake
	sed -e  s,${WRKDIST},${PREFIX}/lib/qt3, <${WRKBUILD}/.qmake.cache >${WRKBUILD}/mogrified.cache
	${INSTALL_DATA} ${WRKBUILD}/mogrified.cache ${PREFIX}/lib/qt3/.qmake.cache
	cd ${PREFIX}/lib/qt3 && ln -sf ../../share/doc/qt3 doc

.include <bsd.port.mk>
@


1.120
log
@use COMPILER_LIBCXX where applicable
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.119 2017/04/10 11:46:36 sthen Exp $
d22 6
a27 6
REVISION-mysql= 	10
REVISION-postgresql= 	7
REVISION-main= 		12
REVISION-html= 		2
REVISION-examples=	3
REVISION-sqlite2= 	7
@


1.119
log
@use LIBCXX
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.118 2017/03/03 12:43:10 espie Exp $
d154 1
a154 1
			${LIBCXX} z pthread
d177 1
a177 1
WANTLIB-examples=	${WANTLIB} ${LIBCXX} c qt-mt
@


1.118
log
@remove hardcoded gcc, bump
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.117 2016/12/26 08:55:05 zhuk Exp $
d154 1
a154 1
			stdc++ z pthread
d177 1
a177 1
WANTLIB-examples=	${WANTLIB} stdc++ c qt-mt
@


1.117
log
@Don't create shlib symlinks on OpenBSD.

Allows to switch security/qca to devel/qmake.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.116 2016/03/23 21:58:11 naddy Exp $
d22 3
a24 3
REVISION-mysql= 	9
REVISION-postgresql= 	6
REVISION-main= 		11
d26 2
a27 2
REVISION-examples=	2
REVISION-sqlite2= 	6
@


1.116
log
@g/c PFRAG.shared
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.115 2015/08/24 10:01:10 sthen Exp $
d24 1
a24 1
REVISION-main= 		10
@


1.115
log
@sync WANTLIB
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.114 2015/05/22 11:31:20 ajacoutot Exp $
d24 1
a24 1
REVISION-main= 		9
@


1.114
log
@"/usr/local/lib/pkgconfig/" is part of mtree(8).
Packages should not own this dir to prevent its deletion or a warning that it
cannot be removed because it's not empty at pkg_delete(1) time.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.113 2014/09/16 19:56:10 miod Exp $
d22 3
a24 3
REVISION-mysql= 	8
REVISION-postgresql= 	5
REVISION-main= 		8
d27 1
a27 1
REVISION-sqlite2= 	5
d153 2
a154 1
			Xrandr Xrender fontconfig freetype jpeg lcms m stdc++ z
d177 1
a177 1
WANTLIB-examples=	${WANTLIB} pthread stdc++ c qt-mt
@


1.113
log
@Add a bunch of NOT_FOR_ARCHS and BROKEN- annotations, either for all gcc3
platforms (due to compiler deficiencies) or m88k only (due to toolchain
issues leading to libGL not being available).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.112 2014/09/13 18:09:22 brad Exp $
d22 6
a27 6
REVISION-mysql= 	7
REVISION-postgresql= 	4
REVISION-main= 		7
REVISION-html= 		1
REVISION-examples=	1
REVISION-sqlite2= 	4
@


1.112
log
@Switch from using MySQL to using MariaDB attempt #2. MariaDB is a drop-in replacement.

ok sthen@@
@
text
@d1 4
a4 1
# $OpenBSD: Makefile,v 1.111 2014/07/13 09:03:15 armani Exp $
@


1.111
log
@Update master site

ok espie@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.110 2013/11/25 14:16:24 sthen Exp $
d19 1
a19 1
REVISION-mysql= 	6
d158 1
a158 1
			databases/mysql
@


1.110
log
@kill VMEM_WARNING
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.109 2013/06/12 20:36:34 brad Exp $
d43 1
a43 1
MASTER_SITES=	ftp://ftp.troll.no/qt/source/
@


1.109
log
@Revert back to using MySQL 5.1 for the time being. MariaDB 5.5 introduces
a new libmysqlclient non-blocking API which utilizes co-routines. The X86
specific GCC ASM co-routine support hid the fact that there was an issue.
The only fallback code so far is POSIX user contexts which OpenBSD does not
support.

Input from and Ok sthen@@ jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.108 2013/06/04 18:42:00 naddy Exp $
a197 1
VMEM_WARNING=	Yes
@


1.108
log
@the png headers are now directly under include/
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.107 2013/05/25 00:33:11 brad Exp $
d19 1
a19 1
REVISION-mysql= 	5
d158 1
a158 1
			databases/mariadb
@


1.107
log
@Switch from using MySQL to using MariaDB. MariaDB is a drop-in replacement.


ok sthen aja
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.106 2013/04/29 10:44:43 espie Exp $
a88 1
		-I${LOCALBASE}/include/libpng \
@


1.106
log
@allow qtextstream to serialize long long integers out.

For completion, qt3 should also serialize long long in, but that's
a more intrusive change, and it's not really needed to keep existing
things compiling.

Obviously, this code is totally different and 64 bits capable in qt4.

this fixes the build of kdepim3 post 64 bits time_t.

problem noticed by sthen@@.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.105 2013/03/11 11:46:15 espie Exp $
d19 1
a19 1
REVISION-mysql= 	4
d159 1
a159 1
			databases/mysql
@


1.105
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.104 2013/02/09 14:49:54 sthen Exp $
d21 1
a21 1
REVISION-main= 		6
@


1.104
log
@Don't use ${FLAVOR:L}, we only support lower-case flavours now.
OK ajacoutot@@ espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.103 2012/08/18 12:41:39 ajacoutot Exp $
a66 3
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
d200 1
a200 1
NO_REGRESS=	Yes
@


1.103
log
@Remove irrelevant $FreeBSD RCS ids.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.102 2012/08/04 15:06:55 ajacoutot Exp $
d100 1
a100 1
.if ${FLAVOR:L:Mdebug}
d210 1
a210 1
.if !${FLAVOR:L:Mdebug}
@


1.102
log
@cups -> cups,-libs
@
text
@d1 1
a1 2
# $OpenBSD: Makefile,v 1.101 2011/10/02 07:03:11 espie Exp $
# $FreeBSD: Makefile,v 1.33 1999/02/27 03:09:57 andreas Exp $
@


1.101
log
@convert to bsd.port.arch.mk
use BUILD_PKGPATH now that it's usable for that.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.100 2011/09/16 12:29:17 espie Exp $
d124 1
a124 1
BUILD_DEPENDS=print/cups
@


1.100
log
@normalize pkgpath
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.99 2011/09/03 08:21:14 landry Exp $
d99 1
a99 1
MULTI_PACKAGES+=-main -html
d104 1
d111 1
d113 1
a113 3
.if !${FLAVOR:L:Mdebug} && !${FLAVOR:L:Mno_examples}
MULTI_PACKAGES+=	-examples
.else
d126 1
a126 4
.if !empty(FLAVOR:L:Mno_mysql)
CONFIGURE_ARGS+=-no-sql-mysql
.else
MULTI_PACKAGES+=	-mysql
d129 2
d134 1
a134 4
.if !empty(FLAVOR:L:Mno_postgresql)
CONFIGURE_ARGS+=-no-sql-psql
.else
MULTI_PACKAGES+=	-postgresql
d140 2
d143 4
a146 1
.if !empty(FLAVOR:L:Mno_sqlite2)
a147 3
.else
MULTI_PACKAGES+=	-sqlite2
CONFIGURE_ARGS+= -plugin-sql-sqlite
d304 1
a304 1
.if empty(FLAVOR:L:Mno_postgresql)
d308 1
a308 1
.if empty(FLAVOR:L:Mno_mysql)
d312 1
a312 1
.if empty(FLAVOR:L:Mno_sqlite2)
@


1.99
log
@Missed bump to REVISION-examples in previous commit.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.98 2011/08/28 07:57:40 espie Exp $
d20 2
a21 2
REVISION-mysql= 	3
REVISION-postgresql= 	3
d24 2
a25 2
REVISION-examples=	0
REVISION-sqlite2= 	3
@


1.98
log
@fix WANTLIB, bump revs.
from Amit Kulkarni <amitkulz@@gmail.com>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.97 2010/11/27 11:54:53 espie Exp $
d24 1
@


1.97
log
@minor bumps after pkg_create fix: generate catN entry when needed.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.96 2010/11/22 09:40:48 espie Exp $
d20 3
a22 3
REVISION-mysql= 	2
REVISION-postgresql= 	2
REVISION-main= 		5
d24 1
a24 1
REVISION-sqlite2= 	2
d156 1
a156 1
			Xrandr Xrender fontconfig freetype jpeg lcms m z
d159 1
a159 1
WANTLIB-main=		${WANTLIB} pthread stdc++ c
d165 1
a165 1
WABTLIB-mysql=		${WANTLIB} qt-mt mysqlclient
d175 1
a175 1
WABTLIB-sqlite2=	${WANTLIB} qt-mt sqlite
@


1.96
log
@missed a few depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.95 2010/11/22 08:37:04 espie Exp $
d22 1
a22 1
REVISION-main= 		4
@


1.95
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.94 2010/10/24 21:15:34 ajacoutot Exp $
d123 1
a123 1
BUILD_DEPENDS=::print/cups
d138 1
a138 1
BUILD_DEPENDS+=::databases/postgresql,-server
@


1.94
log
@Remove USE_X11.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.93 2010/10/19 08:13:59 espie Exp $
d152 3
a154 3
LIB_DEPENDS=		::graphics/png \
			::graphics/libmng
WANTLIB=		GL GLU ICE SM X11.>=10 Xcursor Xext Xft Xi Xinerama \
d163 2
a164 2
			::${BUILD_PKGPATH} \
			::databases/mysql
d168 2
a169 2
			::${BUILD_PKGPATH} \
			:postgresql-client-*:databases/postgresql
d173 2
a174 2
			::${BUILD_PKGPATH} \
			::databases/sqlite
d178 1
a178 1
			::${BUILD_PKGPATH}
@


1.93
log
@USE_GROFF=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.92 2010/07/30 12:03:09 ajacoutot Exp $
a70 1
USE_X11=	Yes
@


1.92
log
@Move to new DEPENDS.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.91 2010/07/30 06:59:00 ajacoutot Exp $
d72 1
@


1.91
log
@First pass at new REVISION/DEPENDS... not finished yet.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.90 2010/05/09 16:19:22 robert Exp $
d20 5
a24 5
REVISION-mysql= 	1
REVISION-postgresql= 	1
REVISION-main= 		3
REVISION-html= 		0
REVISION-sqlite2= 	1
d152 2
a153 2
LIB_DEPENDS=		png.>=2::graphics/png \
			mng.>=1::graphics/libmng
d155 1
a155 1
			Xmu \
d163 3
a165 3
			qt-mt.>=3::${BUILD_PKGPATH} \
			mysqlclient::databases/mysql

d168 3
a170 2
			qt-mt.>=3::${BUILD_PKGPATH} \
			pq.>=2:postgresql-client-*:databases/postgresql
d173 3
a175 2
			qt-mt.>=3::${BUILD_PKGPATH} \
			sqlite::databases/sqlite
d178 2
a179 2
			qt-mt.>=3::${BUILD_PKGPATH}
WANTLIB-examples=	${WANTLIB} pthread stdc++ c
@


1.90
log
@Cast pthread_self() to uintptr_t to make gcc4 happy here.
ok espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.89 2010/02/26 18:04:07 espie Exp $
d12 2
a13 2
PKGNAME-mysql=		qt3-mysql-${VERSION}p1
PKGNAME-postgresql=	qt3-postgresql-${VERSION}p1
d15 2
a16 2
PKGNAME-main=		qt3-mt-${VERSION}p3
FULLPKGNAME-html=	qt3-html-${VERSION}p0
d18 7
a24 1
PKGNAME-sqlite2=	qt3-sqlite2-${VERSION}p1
@


1.89
log
@setting FULLPKGPAME without FULLPKGPATH usually is an error
(port is locked ! don't commit)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.88 2008/07/27 21:44:59 sthen Exp $
d15 1
a15 1
PKGNAME-main=		qt3-mt-${VERSION}p2
@


1.88
log
@- fix missed adjustment in qt3.port.mk to handle shared_lib bump;
this change requires bumping other ports which use it. pointed
out by naddy, thanks!

- add a comment in Makefile to warn others not to do the same.

ok naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.87 2008/07/25 20:25:59 sthen Exp $
d16 2
a17 1
FULLPKGNAME-html=	qt3-html-${VERSION}
@


1.87
log
@shared library and PKGNAME bumps due to use of isinf/isnan/nan
following libc/libm changes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.86 2008/05/31 15:54:38 naddy Exp $
d12 2
a13 2
PKGNAME-mysql=		qt3-mysql-${VERSION}p0
PKGNAME-postgresql=	qt3-postgresql-${VERSION}p0
d17 6
a22 1
PKGNAME-sqlite2=	qt3-sqlite2-${VERSION}p0
@


1.86
log
@when you bump the library version, the plugin path changes too
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.85 2008/05/31 09:50:34 espie Exp $
d15 1
a15 1
PKGNAME-main=		qt3-mt-${VERSION}p1
d18 1
a18 1
SHARED_LIBS=		qt-mt	32.0 \
@


1.85
log
@fix build issue with latest x11 muck-up.
since we remove part of the exposed interface, bump library, to
be sure.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.84 2008/01/04 17:48:38 espie Exp $
d12 2
a13 2
PKGNAME-mysql=		qt3-mysql-${VERSION}
PKGNAME-postgresql=	qt3-postgresql-${VERSION}
d17 1
a17 1
PKGNAME-sqlite2=	qt3-sqlite2-${VERSION}
@


1.84
log
@tweak FAKE_FLAGS semantics to saner defaults.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.83 2007/12/28 18:53:20 espie Exp $
d15 1
a15 1
PKGNAME-main=		qt3-mt-${VERSION}p0
d18 1
a18 1
SHARED_LIBS=		qt-mt	31.1 \
@


1.83
log
@qmake should emit one more dependency so that uic is run before compiling
anything else.

(fixes parallel build of sqlitebrowser, among others)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.82 2007/12/28 17:45:04 espie Exp $
a69 1
FAKE_FLAGS=	$(MAKE_FLAGS) DESTDIR=${WRKINST}
@


1.82
log
@look delayed update to qt 3.3.8, made possible by a gentoo i18n patch.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.81 2007/10/25 09:29:38 wilfried Exp $
d15 1
a15 1
PKGNAME-main=		qt3-mt-${VERSION}
@


1.81
log
@plist fix, ok espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.80 2007/09/15 20:04:23 merdely Exp $
d12 7
a18 7
PKGNAME-mysql=		qt3-mysql-${VERSION}p1
PKGNAME-postgresql=	qt3-postgresql-${VERSION}p1
PKGNAME-examples=	qt3-examples-${VERSION}p1
PKGNAME-main=		qt3-mt-${VERSION}p6
FULLPKGNAME-html=	qt3-html-${VERSION}p0
PKGNAME-sqlite2=	qt3-sqlite2-${VERSION}p1
SHARED_LIBS=		qt-mt	31.0 \
d28 1
a28 1
VERSION=	3.7
d33 3
a35 1
MASTER_SITES0=	http://freedesktop.org/~daisuke/
d37 2
a38 1
PATCHFILES=	qt-x11-immodule-unified-qt3.3.7-20061229.diff.bz2:0
@


1.80
log
@Remove surrounding quotes in COMMENT/PERMIT_*/BROKEN
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.79 2007/08/05 12:31:20 ajacoutot Exp $
d15 2
a16 2
PKGNAME-main=		qt3-mt-${VERSION}p5
FULLPKGNAME-html=	qt3-html-${VERSION}
@


1.79
log
@- remove BUILD_DEPENDS=::graphics/jpeg
it has been useless for a long time and only confuses people (as we have
another BUILD_DEPENDS line right after this one)
no binary change of course

noticed by Markus Lude <markus.lude at gmx dot de>
"go ahead" espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.78 2007/05/14 08:22:00 espie Exp $
d4 6
a9 6
COMMENT-main=		"C++ X11 GUI toolkit"
COMMENT-examples=	"examples and tutorial for qt3"
COMMENT-html=		"off-line html documentation for qt3"
COMMENT-postgresql=	"PostgresSQL plugin for qt3"
COMMENT-mysql=		"MySQL plugin for qt3"
COMMENT-sqlite2=	"sqlite2 plugin for qt3"
@


1.78
log
@tweak DESCR slightly so that the HOMEPAGE shows up at the usual place.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.77 2007/05/09 11:48:17 bernd Exp $
a108 1
BUILD_DEPENDS=::graphics/jpeg
@


1.77
log
@Remove 'mt' FLAVOR which doesn't to anything besides creating PLIST issues
with BUILD_PKGPATH.

Discussed with and ok espie@@.
Bulk build testing and help by steven@@, thanks!
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.76 2007/03/31 22:49:46 espie Exp $
d15 1
a15 1
PKGNAME-main=		qt3-mt-${VERSION}p4
@


1.76
log
@regen patches.
handle utf8 encoding better.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.75 2007/03/28 23:18:09 espie Exp $
d12 3
a14 3
PKGNAME-mysql=		qt3-mysql-${VERSION}p0
PKGNAME-postgresql=	qt3-postgresql-${VERSION}p0
PKGNAME-examples=	qt3-examples-${VERSION}p0
d17 1
a17 1
PKGNAME-sqlite2=	qt3-sqlite2-${VERSION}p0
d47 1
a47 1
PSEUDO_FLAVORS=	no_mysql no_postgresql no_sqlite2 no_examples mt
@


1.75
log
@fuck, forgot that one. noticed by naddy.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.74 2007/03/26 21:22:13 espie Exp $
d11 1
a11 1
PKGNAME=		qt3-${VERSION}p0
d15 1
a15 1
PKGNAME-main=	qt3-mt-${VERSION}p3
@


1.74
log
@help people not mix up X11 with xenocara, by making sure they link against
X11 >= 10, and bump those major numbers accordingly, so that bug-reports
will get easier to process.

(artificial `flag day' as discussed with deraadt@@)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.73 2007/02/17 18:59:04 espie Exp $
d11 5
a15 5
PKGNAME=		qt3-${VERSION}
PKGNAME-mysql=		qt3-mysql-${VERSION}
PKGNAME-postgresql=	qt3-postgresql-${VERSION}
PKGNAME-examples=	qt3-examples-${VERSION}
PKGNAME-main=	qt3-mt-${VERSION}p2
d17 1
a17 1
PKGNAME-sqlite2=	qt3-sqlite2-${VERSION}
@


1.73
log
@fix pkgnames, bump stuff.
add a qt-mt.pc that looks like something.
fix a buglet in qmake.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.72 2007/01/29 09:24:13 espie Exp $
d15 1
a15 1
PKGNAME-main=	qt3-mt-${VERSION}p1
d18 1
a18 1
SHARED_LIBS=		qt-mt	30.3 \
d141 2
a142 1
WANTLIB=		GL GLU ICE SM X11 Xcursor Xext Xft Xi Xinerama Xmu \
@


1.73.2.1
log
@security fix for CVE-2007-0242

MFC:
handle utf8 encoding better.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.73 2007/02/17 18:59:04 espie Exp $
d15 1
a15 1
PKGNAME-main=	qt3-mt-${VERSION}p4
@


1.72
log
@also install manpage for qm2ts
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.71 2007/01/22 18:18:28 espie Exp $
d15 1
a15 1
FULLPKGNAME-main=	qt3-mt-${VERSION}${PKGDEBUG}p0
d17 1
a17 1
FULLPKGNAME-sqlite2=	qt3-sqlite2-${VERSION}
d194 2
a196 1
post-configure:
d233 2
@


1.71
log
@build the sqlite2 plugin
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.70 2007/01/04 18:34:46 espie Exp $
d15 1
a15 1
FULLPKGNAME-main=	qt3-mt-${VERSION}${PKGDEBUG}
d246 1
@


1.70
log
@update to qt 3.3.7 now that we have a qt immodule patch finally.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.69 2006/11/28 19:15:47 espie Exp $
d9 1
d17 1
d47 1
a47 1
PSEUDO_FLAVORS=	no_mysql no_postgresql no_examples mt
d131 6
d157 3
d291 4
@


1.69
log
@bump pkgnames, noticed by naddy
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.68 2006/11/26 09:10:43 sturm Exp $
d11 4
a14 4
PKGNAME-mysql=		qt3-mysql-${VERSION}p2
PKGNAME-postgresql=	qt3-postgresql-${VERSION}p2
PKGNAME-examples=	qt3-examples-${VERSION}p0
FULLPKGNAME-main=	qt3-mt-${VERSION}p9${PKGDEBUG}
d16 1
a16 1
SHARED_LIBS=		qt-mt	30.2 \
d26 1
a26 1
VERSION=	3.5
d33 1
a33 1
PATCHFILES=	qt-x11-immodule-unified-qt3.3.5-20051018.diff.bz2:0
@


1.68
log
@unbreak
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.67 2006/11/25 18:35:45 espie Exp $
d11 3
a13 3
PKGNAME-mysql=		qt3-mysql-${VERSION}p1
PKGNAME-postgresql=	qt3-postgresql-${VERSION}p1
PKGNAME-examples=	qt3-examples-${VERSION}
@


1.67
log
@use BUILD_PKGPATH
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.66 2006/11/20 20:41:00 espie Exp $
d151 1
a151 1
			qt-mt.>=3::${BUILD_PKGPATH} \
@


1.66
log
@switch to new MULTI_PACKAGES
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.65 2006/10/24 22:39:36 espie Exp $
a109 8
e=
.if ${FLAVOR:L:Mno_mysql}
e:=$e,no_mysql
.endif
.if ${FLAVOR:L:Mno_postgresql}
e:=$e,no_postgresql
.endif

d141 1
a141 1
			qt-mt.>=3::x11/qt3$e \
d146 1
a146 1
			qt-mt.>=3::x11/qt3$e \
d151 1
a151 1
			qt-mt.>=3::x11/qt3$e
@


1.65
log
@Add the security patches from qt 3.3.7

we'll update to qt 3.3.7 after the immodule patch has been merged, which
should hopefully happen in the middle of november....
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.64 2006/10/18 18:05:31 espie Exp $
d4 1
a4 1
COMMENT=		"C++ X11 GUI toolkit"
d14 1
a14 1
FULLPKGNAME=		qt3-mt-${VERSION}p8${PKGDEBUG}
a52 2
myWANTLIB=		GL GLU ICE SM X11 Xcursor Xext Xft Xi Xinerama Xmu \
			Xrandr Xrender fontconfig freetype jpeg lcms m z
d82 1
a82 1
MULTI_PACKAGES+=-html
d93 1
a105 2
SUBPACKAGE?=

a121 3
.  if !defined(PACKAGING) || ${SUBPACKAGE} == "-mysql"
LIB_DEPENDS+=mysqlclient::databases/mysql
.  endif
d126 1
a130 2
.  if !defined(PACKAGING) || ${SUBPACKAGE} == "-postgresql"
LIB_DEPENDS+=pq.>=2:postgresql-client-*:databases/postgresql
a131 1
.  endif
a137 3
.if ${SUBPACKAGE} == "-examples" || ${SUBPACKAGE} == ""
myWANTLIB+=	pthread stdc++ c
.endif
d139 23
a161 5
.if !defined(PACKAGING) || ${SUBPACKAGE} != "-html"
LIB_DEPENDS+=	png.>=2::graphics/png \
		mng.>=1::graphics/libmng
WANTLIB=	${myWANTLIB}
.endif
d163 3
a165 3
.if defined(PACKAGING) && ${SUBPACKAGE} != "-html" && ${SUBPACKAGE} != ""
LIB_DEPENDS+=	qt-mt.>=3::x11/qt3$e
.endif
a166 3
.if defined(PACKAGING) && ${SUBPACKAGE} == "-html"
PKG_ARCH=	*
.endif
@


1.64
log
@Let qfile synch IO between read and write by using fflush, a bit like qt4
does.

This is hidden behind a pimpl, so there's no ABI change.

This should allow people to use QDataStream for input AND output with
impunity.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.63 2006/09/18 10:21:49 espie Exp $
d14 1
a14 1
FULLPKGNAME=		qt3-mt-${VERSION}p7${PKGDEBUG}
d16 1
a16 1
SHARED_LIBS=		qt-mt	30.1 \
@


1.63
log
@more new lib specs
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62 2006/03/07 19:29:19 espie Exp $
d14 1
a14 1
FULLPKGNAME=		qt3-mt-${VERSION}p6${PKGDEBUG}
d16 1
a16 1
SHARED_LIBS=		qt-mt	30.0 \
@


1.62
log
@fix a few minor nits:
- let qmake output LOCALBASE if it find it useful
- the OpenBSD default config uses threads anyways, for ports.
- make a link to help designer and friends to find their documentation
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.61 2006/03/04 10:07:10 espie Exp $
d137 1
a137 1
LIB_DEPENDS+=pq.2:postgresql-client-*:databases/postgresql
d151 2
a152 2
LIB_DEPENDS+=	png.2::graphics/png \
		mng.1::graphics/libmng
d157 1
a157 1
LIB_DEPENDS+=	qt-mt.3::x11/qt3$e
@


1.62.2.1
log
@MFC:
Let qfile synch IO between read and write by using fflush, a bit like qt4
does.

This is hidden behind a pimpl, so there's no ABI change.

This should allow people to use QDataStream for input AND output with
impunity.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62 2006/03/07 19:29:19 espie Exp $
d14 1
a14 1
FULLPKGNAME=		qt3-mt-${VERSION}p7${PKGDEBUG}
d16 1
a16 1
SHARED_LIBS=		qt-mt	30.1 \
@


1.62.2.2
log
@MFC:
Add the security patches from qt 3.3.7
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62.2.1 2006/11/01 08:59:09 sturm Exp $
d14 1
a14 1
FULLPKGNAME=		qt3-mt-${VERSION}p8${PKGDEBUG}
d16 1
a16 1
SHARED_LIBS=		qt-mt	30.2 \
@


1.62.2.3
log
@security fix for CVE-2007-0242

MFC:
handle utf8 encoding better.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62.2.2 2006/11/01 12:25:47 sturm Exp $
d14 1
a14 1
FULLPKGNAME=		qt3-mt-${VERSION}p9${PKGDEBUG}
@


1.61
log
@patches that didn't make 3.9
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.60 2006/02/27 16:40:25 espie Exp $
d14 1
a14 1
FULLPKGNAME=		qt3-mt-${VERSION}p5${PKGDEBUG}
d317 1
@


1.60
log
@fix two crashes in qt3, from the kde project.

okay pvalchev@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59 2006/01/13 19:18:50 espie Exp $
d14 1
a14 1
FULLPKGNAME=		qt3-mt-${VERSION}p4${PKGDEBUG}
@


1.60.2.1
log
@MFC:
Let qfile synch IO between read and write by using fflush, a bit like qt4
does.

This is hidden behind a pimpl, so there's no ABI change.

This should allow people to use QDataStream for input AND output with
impunity.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.60 2006/02/27 16:40:25 espie Exp $
d14 1
a14 1
FULLPKGNAME=		qt3-mt-${VERSION}p7${PKGDEBUG}
d16 1
a16 1
SHARED_LIBS=		qt-mt	30.1 \
@


1.60.2.2
log
@MFC:
Add the security patches from qt 3.3.7
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.60.2.1 2006/10/29 17:48:54 sturm Exp $
d14 1
a14 1
FULLPKGNAME=		qt3-mt-${VERSION}p8${PKGDEBUG}
d16 1
a16 1
SHARED_LIBS=		qt-mt	30.2 \
@


1.60.2.3
log
@security fix for CVE-2007-0242

MFC:
handle utf8 encoding better.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.60.2.2 2006/10/29 17:50:15 sturm Exp $
d14 1
a14 1
FULLPKGNAME=		qt3-mt-${VERSION}p9${PKGDEBUG}
@


1.59
log
@bunp all qt shared libs at the same time.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2006/01/02 16:59:37 espie Exp $
d14 1
a14 1
FULLPKGNAME=		qt3-mt-${VERSION}p3${PKGDEBUG}
@


1.58
log
@versioned pluginsdir in qt3.port.mk
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.57 2005/12/28 16:50:58 espie Exp $
d11 2
a12 2
PKGNAME-mysql=		qt3-mysql-${VERSION}p0
PKGNAME-postgresql=	qt3-postgresql-${VERSION}p0
d14 1
a14 1
FULLPKGNAME=		qt3-mt-${VERSION}p2${PKGDEBUG}
d16 3
a18 3
SHARED_LIBS=		qt-mt	3.35 \
			qui	1.0 \
			qui-mt	1.0
@


1.57
log
@SHARED_LIBS:
- qmake changes to emit LIBxxx_VERSION annotations in generated Makefiles.
- qt changes to use plugins-<major> libraries. Note that uic always look in
the configured directory, and one cannot link against two qt libraries,
otherwise stuff will be destroyed twice... (ick).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2005/12/27 18:04:32 espie Exp $
d22 1
@


1.56
log
@Add inputmodules patch. Fixed package name for debug flavor.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55 2005/11/10 11:15:13 espie Exp $
d11 2
a12 2
PKGNAME-mysql=		qt3-mysql-${VERSION}
PKGNAME-postgresql=	qt3-postgresql-${VERSION}
d14 1
a14 1
FULLPKGNAME=		qt3-mt-${VERSION}p1${PKGDEBUG}
d16 8
d63 5
a67 1
MAKE_FLAGS=	DESIGNER_SUBDIR=dummy
d170 1
a170 1
QT_PLUGINSDIR=	${QT_LIBDIR}/plugins
d174 1
a174 1
SUBST_VARS=	QT_LIBDIR QT_DOC
a185 3
LIBRARIES=qt-mt.so.3.35 qui.so.1.0 \
	editor.a designercore.a qassistantclient.a

d247 6
a252 3
.for l in ${LIBRARIES}
	@@if [ -f ${WRKBUILD}/lib/lib${l:C/\.so\..*/.a/} ]; then \
	 ${INSTALL_DATA} ${WRKBUILD}/lib/lib${l:C/\.so\..*/.a/} ${PREFIX}/lib/qt3; \
d254 2
a255 3
	@@if [ -f ${WRKBUILD}/lib/lib$l ]; then \
	 ${INSTALL_DATA} ${WRKBUILD}/lib/lib$l ${PREFIX}/lib/qt3; \
	 ln -sf qt3/lib$l ${PREFIX}/lib; \
d257 7
a263 1
.endfor
d308 2
a309 2
	cd ${PREFIX}/lib && ln -sf libqui.so.1.0 libqui-mt.so.1.0
	cd ${PREFIX}/lib/qt3 && ln -sf libqui.so.1.0 libqui-mt.so.1.0
@


1.55
log
@add a pkgpath to x11/qt3,mt to help people updating over a long period...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.54 2005/09/19 10:24:56 espie Exp $
d14 1
a14 1
FULLPKGNAME=		qt3-mt-${VERSION}${PKGDEBUG}p0
d22 8
d64 1
d165 2
a166 1
	changes-3*
d257 3
a259 1
		${QT_PLUGINSDIR}/sqldrivers ${QT_PLUGINSDIR}/styles
d276 8
@


1.54
log
@update to qt 3.3.5
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2005/09/18 09:08:42 espie Exp $
d14 1
a14 1
FULLPKGNAME=		qt3-mt-${VERSION}${PKGDEBUG}
@


1.53
log
@all multi-packages are affected
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.52 2005/09/18 00:52:40 espie Exp $
d11 5
a15 5
PKGNAME-mysql=		qt3-mysql-${VERSION}p0
PKGNAME-postgresql=	qt3-postgresql-${VERSION}p0
PKGNAME-examples=	qt3-examples-${VERSION}p0
FULLPKGNAME=		qt3-mt-${VERSION}${PKGDEBUG}p4
FULLPKGNAME-html=	qt3-html-${VERSION}p0
d17 1
a17 1
VERSION=	3.4
d164 1
a164 1
LIBRARIES=qt-mt.so.3.34 qui.so.1.0 \
@


1.52
log
@Fix stuff that otto broke.
Also noticed by Matthias  Kilian.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 2005/09/16 09:51:28 espie Exp $
d11 3
a13 3
PKGNAME-mysql=		qt3-mysql-${VERSION}
PKGNAME-postgresql=	qt3-postgresql-${VERSION}
PKGNAME-examples=	qt3-examples-${VERSION}
d15 1
a15 1
FULLPKGNAME-html=	qt3-html-${VERSION}
@


1.51
log
@Fix a buglet in bsd.port.mk where the PSEUDO_FLAVORS get encoded into
the FULLPKGPATH, thus providing changes to packing-lists which shouldn't
happen, and making update more difficult.

Accordingly, bump all pkgnames with PSEUDO_FLAVORS, and provide an
update @@pkgpath for the bug for most of them (left out the ones with 3
or 4 pseudo flavors for space constraints...)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2005/08/31 22:01:09 espie Exp $
d170 3
a172 3
	@@find ${WRKSRC}/examples-src -name '*.orig' |xargs rm
	@@find ${WRKSRC}/examples-src -name '.moc' |xargs rm -r
	@@find ${WRKSRC}/examples-src -name '.obj' |xargs rm -r
d174 3
a176 3
	@@find ${WRKSRC}/tutorial-src -name '*.orig' |xargs rm
	@@find ${WRKSRC}/tutorial-src -name '.moc' |xargs rm -r
	@@find ${WRKSRC}/tutorial-src -name '.obj' |xargs rm -r
@


1.50
log
@fix qdns, from Greg Estabrooks

okay pvalchev@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2005/05/18 14:24:32 espie Exp $
d14 1
a14 1
FULLPKGNAME=		qt3-mt-${VERSION}${PKGDEBUG}p3
@


1.50.2.1
log
@MFC:
Add the security patches from qt 3.3.7
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2005/08/31 22:01:09 espie Exp $
d14 1
a14 1
FULLPKGNAME=		qt3-mt-${VERSION}${PKGDEBUG}p4
@


1.49
log
@do not create symlinks for libraries.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2005/04/09 21:24:12 espie Exp $
d14 1
a14 1
FULLPKGNAME=		qt3-mt-${VERSION}${PKGDEBUG}p2
@


1.48
log
@TrollTech missed an occasion to use snprintf, and I fucked up in
the PKGNAME bumping.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2005/02/27 16:03:14 espie Exp $
d14 1
a14 1
FULLPKGNAME=		qt3-mt-${VERSION}${PKGDEBUG}p1
@


1.47
log
@add missing common dir
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2005/02/03 20:05:56 espie Exp $
d10 1
a10 1
PKGNAME=		qt3-${VERSION}p0
d14 1
a70 1
FULLPKGNAME=		qt3-mt-${VERSION}${PKGDEBUG}
@


1.46
log
@update to 3.3.4, lots of sec patches included.
activate qt support. build dependency only, qt is smart enough
to autoload that stuff...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2004/12/19 13:09:45 alek Exp $
d10 1
a10 1
PKGNAME=		qt3-${VERSION}
@


1.45
log
@Add WANTLIB markers
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2004/11/09 21:59:42 espie Exp $
d10 1
a10 1
PKGNAME=		qt3-${VERSION}p3
d16 1
a16 1
VERSION=	3.3
d54 1
d70 1
a70 1
FULLPKGNAME=		qt3-mt-${VERSION}p4${PKGDEBUG}
d89 1
d164 1
a164 1
LIBRARIES=qt-mt.so.3.33 qui.so.1.0 \
@


1.44
log
@bump pkgname, to help pkg_add -r.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2004/10/31 08:49:40 espie Exp $
d35 2
d122 4
d129 1
@


1.43
log
@adapt .qmake.cache for installation path.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2004/10/30 09:12:35 espie Exp $
d67 1
a67 1
FULLPKGNAME=		qt3-mt-${VERSION}p3${PKGDEBUG}
@


1.42
log
@Reorganize stuff.
- stop supporting !mt, since it has worked for a long time.
- mt becomes a pseudo_flavor for compat purposes.
- merge base back into the main module.
- link mt names to not mt names.
- finish recreating a full QTDIR structure for compatibility as well.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2004/10/27 19:57:16 espie Exp $
d268 2
a269 1
	${INSTALL_DATA} ${WRKBUILD}/.qmake.cache ${PREFIX}/lib/qt3
@


1.41
log
@get lib/qt3/bin to show up correctly, finishes fixing up qmake...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2004/10/26 23:04:12 espie Exp $
a8 1
COMMENT-base=		"include and docs for qt3"
d10 1
a10 1
PKGNAME=		qt3-${VERSION}p2
a13 1
FULLPKGNAME-base=	qt3-base-${VERSION}
d25 1
a25 1
FLAVORS=mt debug
d27 2
a28 3
PSEUDO_FLAVORS=	no_mysql no_postgresql no_examples
FLAVOR?=mt
COMPAT=Yes
a35 2
PKG_ARGS=-Dcompat=1

d58 1
a58 1
MULTI_PACKAGES+=-base -html
d67 1
a67 2
.if ${FLAVOR:L:Mmt}
FULLPKGNAME=		qt3-mt-${VERSION}p2${PKGDEBUG}
a68 3
.else
CONFIGURE_ARGS+=-no-thread
.endif
d70 1
a70 1
.if ${FLAVOR:L:Mmt} && !${FLAVOR:L:Mdebug} && !${FLAVOR:L:Mno_examples}
a93 3
.if ${FLAVOR:L:Mmt}
e:=$e,mt
.endif
d120 1
a120 5
.if defined(PACKAGING) && ${SUBPACKAGE} != "-html" && ${SUBPACKAGE} != "-base"
RUN_DEPENDS+=::x11/qt3,-base
.endif

.if !defined(PACKAGING) || ${SUBPACKAGE} != "-html" && ${SUBPACKAGE} != "-base"
d125 2
a126 2
.if defined(PACKAGING) && ${SUBPACKAGE} != "-html" && ${SUBPACKAGE} != "" && ${SUBPACKAGE} != "-base"
LIB_DEPENDS+=	qt${MT_SUFX}.3::x11/qt3$e
d140 2
a141 2
QT_PLUGINSDIR=	${QT_LIBDIR}/plugins${MT_SUFX}
QT_BINDIR=	${QT_LIBDIR}/bin${MT_SUFX}
d144 1
a144 1
SUBST_VARS=	VERSION QT_LIBDIR QT_DOC MT_SUFX
d155 1
a155 1
LIBRARIES=qt${MT_SUFX}.so.3.33 qui${MT_SUFX}.so.1.0 \
d158 1
a158 7
.if ${FLAVOR:L:Mmt}
MT_SUFX=-mt
.else
MT_SUFX=
.endif

.if ${FLAVOR:L:Mmt} && !${FLAVOR:L:Mdebug}
d230 1
a230 1
	@@ln -sf ${TRUEPREFIX}/lib/qt3/bin${MT_SUFX}/$p ${PREFIX}/bin/$p3${MT_SUFX}
d234 1
a234 1
	@@ln -sf ${TRUEPREFIX}/lib/qt3/bin${MT_SUFX}/$p ${PREFIX}/bin/$p${MT_SUFX}
d255 3
a257 3
.if ${COMPAT:L} == "yes" && ${FLAVOR:L:Mmt}
.  for p in ${PROGRAMS}
	cd ${PREFIX}/bin && ln -sf $p${MT_SUFX} $p
d259 10
a268 7
.  for p in ${PROGRAMS3}
	cd ${PREFIX}/bin && ln -sf $p3${MT_SUFX} $p3
.  endfor
	cd ${PREFIX}/lib && ln -sf libqui${MT_SUFX}.so.1.0 libqui.so.1.0
	cd ${PREFIX}/lib/qt3 && ln -sf libqui${MT_SUFX}.so.1.0 libqui.so.1.0
.endif
	cd ${PREFIX}/lib/qt3 && ln -sf bin${MT_SUFX} bin
@


1.40
log
@typo
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2004/10/26 22:59:24 espie Exp $
d287 1
@


1.39
log
@a few tweaks:
- since we no longer compile qt3 without mt, link the files with the
`usual' names (compat settings and fragment).
- install supplementary development libraries, this will help for other
ports (asked by Steve Shockley).
- help qmake work off-the-shelf.
- provide a no_examples pseudo-flavor.

bump pkgname.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2004/09/20 20:05:51 brad Exp $
d279 1
a279 1
	cd ${PREFIX}/bin && ln -sf $p${MT_SUFFX} $p
d282 1
a282 1
	cd ${PREFIX}/bin && ln -sf $p3${MT_SUFFX} $p3
d284 2
a285 2
	cd ${PREFIX}/lib && ln -sf libqui${MT_SUFFX}.so.1.0 libqui.so.1.0
	cd ${PREFIX}/lib/qt3 && ln -sf libqui${MT_SUFFX}.so.1.0 libqui.so.1.0
@


1.38
log
@fix issues with the GIF and XPM parsers that could allow a remote attacker to cause a
DoS via a malformed image file that triggers a null dereference.

CAN-2004-0692, CAN-2004-0693
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2004/09/15 19:25:12 espie Exp $
d11 1
a11 1
PKGNAME=		qt3-${VERSION}p1
d29 1
a29 1
PSEUDO_FLAVORS=	no_mysql no_postgresql
d31 1
d39 2
d73 1
a73 1
FULLPKGNAME=		qt3-mt-${VERSION}p1${PKGDEBUG}
d79 1
a79 1
.if ${FLAVOR:L:Mmt} && !${FLAVOR:L:Mdebug}
d171 2
a172 1
LIBRARIES=qt${MT_SUFX}.so.3.33 qui${MT_SUFX}.so.1.0
a177 1
LIBRARIES+=editor.so.1.0
d277 10
@


1.37
log
@qt 3.3.3 + new plist
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2004/07/28 03:15:37 brad Exp $
d11 1
a11 1
PKGNAME=		qt3-${VERSION}
d70 1
a70 1
FULLPKGNAME=		qt3-mt-${VERSION}${PKGDEBUG}
@


1.36
log
@Qt3 does evil things with PostgreSQL server headers so add
a build-time dependency on the -server sub-package.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2004/07/22 23:03:08 brad Exp $
d18 1
a18 1
VERSION=	3.2
d30 1
a30 1
FLAVOR?=
d168 1
a168 1
LIBRARIES=qt${MT_SUFX}.so.3.32 qui${MT_SUFX}.so.1.0
@


1.35
log
@upgrade to Qt 3.3.2

ok MAINTAINER
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2004/02/25 02:35:18 naddy Exp $
d120 2
a121 1
LIB_DEPENDS+=pq::databases/postgresql
@


1.34
log
@The sparc64 compiler is gcc3 now; don't require the gcc3 module.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2004/02/04 07:39:19 sturm Exp $
d18 1
a18 1
VERSION=	2.3
d167 1
a167 1
LIBRARIES=qt${MT_SUFX}.so.3.23 qui${MT_SUFX}.so.1.0
d208 2
a209 2
	-rm -rf ${WRKSRC}/examples
	-rm -rf ${WRKSRC}/tutorial
a218 3
	@@rm -f ${WRKSRC}/include/qt_{mac,windows}.h
	@@rm -f ${WRKSRC}/include/qmotif{,dialog,widget}.h
	@@rm -f ${WRKSRC}/include/qxtwidget.h
@


1.34.2.1
log
@Chris Evans found a heap overflow vulnerability in the QT
library when handling 8-bit RLE encoded BMP files. An attacker could
use this to compromise the account used to view the specially crafted
image. Further investigations found similar vulnerabilities in
XPM, GIF and JPEG image handlers.

CAN-2004-0691, CAN-2004-0692, CAN-2004-0693
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2004/02/25 02:35:18 naddy Exp $
d11 1
a11 1
PKGNAME=		qt3-${VERSION}p1
d70 1
a70 1
FULLPKGNAME=		qt3-mt-${VERSION}p1${PKGDEBUG}
@


1.33
log
@mark some subpackages arch independent

ok naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2004/01/22 21:03:59 espie Exp $
a36 4

MODULES=	gcc3
MODGCC3_ARCHES=	sparc64
MODGCC3_LANGS=	C++
@


1.32
log
@redesign subpackages to allow for a debug flavor.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2004/01/08 01:12:59 brad Exp $
d143 4
@


1.31
log
@upgrade to Qt 3.2.3

ok espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2003/10/08 17:13:17 sturm Exp $
d27 1
a27 1
FLAVORS=mt
d66 7
d74 1
a74 1
FULLPKGNAME=		qt3-mt-${VERSION}
d76 5
a82 1
CONFIGURE_ARGS+=-no-thread
d156 1
a156 1
SUBST_VARS=	VERSION QT_LIBDIR QT_DOC
d167 2
d171 4
a174 1
LIBRARIES=qt${MT_SUFX}.so.3.23 qui${MT_SUFX}.so.1.0
d176 1
a205 2
MT_SUFX=
LIBRARIES=qt.so.3.23 editor.so.1.0 qui.so.1.0
@


1.30
log
@first bunch of license cleanup, some discussions about interpretation
during the release with pval@@

other categories will follow once they are finished
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2003/05/13 00:26:32 naddy Exp $
d11 8
a18 1
VERSION=	1.2
a37 2
#CXXFLAGS+=	-g

a42 1
#USE_GMAKE=	Yes
d48 1
a48 1
PORTHOME="${WRKDIST}"
d52 3
a54 3
CONFIGURE_ARGS=	-qt-gif -system-libmng -system-libpng -system-libjpeg \
		-system-zlib -sm -no-g++-exceptions \
		-v -stl -xrender \
a77 3
#CONFIGURE_ARGS+=-static -debug
#CONFIGURE_ARGS+=-debug
#CONFIGURE_ARGS+=-static
a78 2
# For XFree 4
#CONFIGURE_ARGS+=-xft
a107 3
# This one doesn't work
#LIB_DEPENDS+=iodbc::databases/iodbc

d147 1
a147 1
DOCS=	FAQ LICENSE.GPL README README.QT \
d158 1
a158 1
LIBRARIES=qt${MT_SUFX}.so.3.12 qui${MT_SUFX}.so.1.0
d190 1
a190 1
LIBRARIES=qt.so.3.12 editor.so.1.0 qui.so.1.0
d243 2
a244 7
	${INSTALL_DATA_DIR} ${QT_PLUGINSDIR}/imageformats \
		${QT_PLUGINSDIR}/sqldrivers ${QT_PLUGINSDIR}/styles \
		${QT_PLUGINSDIR}/designer
	${INSTALL_DATA} ${WRKBUILD}/plugins/imageformats/libqjpeg.so \
	    ${QT_PLUGINSDIR}/imageformats
	${INSTALL_DATA} ${WRKBUILD}/plugins/imageformats/libqmng.so \
	    ${QT_PLUGINSDIR}/imageformats
a260 8


PKGNAME=		qt3-${VERSION}
PKGNAME-mysql=		qt3-mysql-${VERSION}
PKGNAME-postgresql=	qt3-postgresql-${VERSION}
PKGNAME-examples=	qt3-examples-${VERSION}
FULLPKGNAME-base=	qt3-base-${VERSION}
FULLPKGNAME-html=	qt3-html-${VERSION}
@


1.29
log
@typo, fix build
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2003/04/10 18:08:57 jsyn Exp $
d25 1
@


1.29.2.1
log
@Chris Evans found a heap overflow vulnerability in the QT
library when handling 8-bit RLE encoded BMP files. An attacker could
use this to compromise the account used to view the specially crafted
image. Further investigations found similar vulnerabilities in
XPM, GIF and JPEG image handlers.

CAN-2004-0691, CAN-2004-0692, CAN-2004-0693
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2003/05/13 00:26:32 naddy Exp $
d62 1
a62 1
FULLPKGNAME=		qt3-mt-${VERSION}p1
d271 1
a271 1
PKGNAME=		qt3-${VERSION}p1
@


1.28
log
@quote COMMENTs; ok naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2003/04/05 14:45:19 espie Exp $
d193 1
a193 1
LIBRARIES=qt.so.3.11 editor.so.1.0 qui.so.1.0
@


1.27
log
@Update to qt-3.1.2, move samples from qt to qt-mt, enable tablet support.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2003/02/09 19:17:32 espie Exp $
d4 6
a9 6
COMMENT=		C++ X11 GUI toolkit
COMMENT-examples=	examples and tutorial for qt3
COMMENT-html=		off-line html documentation for qt3
COMMENT-postgresql=	PostgresSQL plugin for qt3
COMMENT-mysql=		MySQL plugin for qt3
COMMENT-base=		include and docs for qt3
@


1.26
log
@In mt mode, rename libqui -> libqui-mt
qt-mt is now tested, one could say...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2003/01/09 23:06:30 espie Exp $
d11 1
a11 1
VERSION=	1.1
d51 2
d62 1
a62 1
FULLPKGNAME=		qt3-mt-${VERSION}p0
d64 1
a64 1
ALL_TARGET=sub-src sub-tools
d67 1
a67 1
MULTI_PACKAGES+=	-examples
d161 1
a161 9
LIBRARIES=qt${MT_SUFX}.so.3.11 qui${MT_SUFX}.so.1.0

post-patch:
	-rm -rf ${WRKSRC}/examples
	-rm -rf ${WRKSRC}/tutorial

.else
MT_SUFX=
LIBRARIES=qt.so.3.11 editor.so.1.0 qui.so.1.0
d191 8
d208 2
d271 1
a271 1
PKGNAME=		qt3-${VERSION}p0
d275 1
a275 1
FULLPKGNAME-base=	qt3-base-${VERSION}p0
@


1.25
log
@Oops, qt3-base ought to conflict with all qt3 single-threaded packages,
since those included the include files.
This means we need to bump the packagename to p0... joy.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2003/01/07 01:23:20 espie Exp $
d60 1
a60 1
FULLPKGNAME=		qt3-mt-${VERSION}
d159 1
a159 1
LIBRARIES=qt${MT_SUFX}.so.3.11
@


1.24
log
@oops, pass plugins dir correctly.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2003/01/06 06:22:52 espie Exp $
d267 1
a267 1
PKGNAME=		qt3-${VERSION}
d271 1
a271 1
FULLPKGNAME-base=	qt3-base-${VERSION}
@


1.23
log
@Repackage qt3 to separate mt better (common -base package for include/docs,
specific plugins for mt)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2002/12/31 02:09:51 espie Exp $
d70 1
d77 1
a77 1
CONFIGURE_ENV=	QTDIR="${WRKSRC}" QT_INSTALL_PLUGINS="${QT_PLUGINSDIR}"
@


1.22
log
@Bring mt support to MODULE.
Fix tricky issue: basic tools must be compiled with -mt as well,
otherwise they won't be able to use plugins (and for instance, kde needs
uic plugins for its widgets)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2002/12/29 16:13:28 espie Exp $
d9 1
d57 2
a61 1
FLAVOR+=no_mysql no_postgresql
d65 1
a65 1
MULTI_PACKAGES=	-examples -html
d76 1
a76 1
CONFIGURE_ENV=	QTDIR="${WRKSRC}" KDEDIR="${LOCALBASE}"
a79 5
QTMODULES=	styles tools kernel widgets dialogs \
		iconview workspace network canvas table xml opengl sql

#EXTRA_SAMPLES+=box gear glpixmap overlay overlay_x11 sharedbox

d90 3
d121 5
a125 1
.if !defined(PACKAGING) || ${SUBPACKAGE} != "-html"
d129 3
a131 2
.if defined(PACKAGING) && ${SUBPACKAGE} != "-html" && ${SUBPACKAGE} != ""
LIB_DEPENDS+=	qt.3::x11/qt3$e
a136 1
QT_PLUGINSDIR=	${QT_LIBDIR}/plugins
d141 2
d157 3
d164 3
a166 13
do-install:
	${INSTALL_DATA_DIR} ${PREFIX}/lib/qt3
	${INSTALL_DATA} ${WRKBUILD}/lib/libqt-mt.so.3.11 ${PREFIX}/lib/qt3
	ln -sf qt3/libqt-mt.so.3.11 ${PREFIX}/lib
	${INSTALL_DATA_DIR} ${QT_LIBDIR}/bin-mt
.  for p in ${PROGRAMS3}
	${INSTALL_PROGRAM} ${WRKBUILD}/bin/$p ${QT_LIBDIR}/bin-mt/$p
	@@ln -sf ${TRUEPREFIX}/lib/qt3/bin-mt/$p ${PREFIX}/bin/$p3-mt
.  endfor
.  for p in ${PROGRAMS}
	${INSTALL_PROGRAM} ${WRKBUILD}/bin/$p ${QT_LIBDIR}/bin-mt/$p
	@@ln -sf ${TRUEPREFIX}/lib/qt3/bin-mt/$p ${PREFIX}/bin/$p-mt
.  endfor
a167 1
.else
d178 1
a178 7
LIBRARIES=qt.so.3.11 editor.so.1.0 qui.so.1.0

do-install:
	${INSTALL_DATA_DIR} ${QT_INCDIR}
	${INSTALL_MAN_DIR} ${QT_MANDIR}/man1
	${INSTALL_MAN_DIR} ${QT_MANDIR}/man3
	${INSTALL_DATA_DIR} ${QT_LIBDIR}/bin ${QT_PLUGINSDIR}
a180 24
	${INSTALL_DATA_DIR} ${QT_DOC}/html
	# libraries
.  for l in ${LIBRARIES}
	@@if [ -f ${WRKBUILD}/lib/lib${l:C/\.so\..*/.a/} ]; then \
	 ${INSTALL_DATA} ${WRKBUILD}/lib/lib${l:C/\.so\..*/.a/} ${PREFIX}/lib/qt3; \
	fi
	@@if [ -f ${WRKBUILD}/lib/lib$l ]; then \
	 ${INSTALL_DATA} ${WRKBUILD}/lib/lib$l ${PREFIX}/lib/qt3; \
	 ln -sf qt3/lib$l ${PREFIX}/lib; \
	fi
.  endfor
	# programs
.  for p in ${PROGRAMS3}
	${INSTALL_PROGRAM} ${WRKBUILD}/bin/$p ${QT_LIBDIR}/bin
	@@ln -sf ${TRUEPREFIX}/lib/qt3/bin/$p ${PREFIX}/bin/$p3
.  endfor
.  for p in ${PROGRAMS}
	${INSTALL_PROGRAM} ${WRKBUILD}/bin/$p ${PREFIX}/bin
.  endfor
	# includes
	@@rm -f ${WRKSRC}/include/qt_{mac,windows}.h
	${INSTALL_DATA_DIR} ${QT_INCDIR}/private
	${INSTALL_DATA} ${WRKSRC}/include/*.h ${QT_INCDIR}
	${INSTALL_DATA} ${WRKSRC}/include/private/*.h ${QT_INCDIR}/private
d196 13
d221 19
d248 1
a248 1
.  if empty(FLAVOR:L:Mno_postgresql)
d251 2
a252 2
.  endif
.  if empty(FLAVOR:L:Mno_mysql)
d255 1
a255 1
.  endif
d264 1
a264 2
	cp -R ${WRKSRC}/mkspecs ${QT_LIBDIR}/mkspecs
.endif
d267 2
d270 2
a271 3
PKGNAME-html=	qt3-html-${VERSION}
PKGNAME-mysql=	qt3-mysql-${VERSION}
PKGNAME-postgresql=	qt3-postgresql-${VERSION}
@


1.21
log
@update to qt 3.1.1
uic.1 -> uic3.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2002/12/18 05:19:45 brad Exp $
d60 1
a60 1
ALL_TARGET=sub-src
d147 2
d159 10
a180 2
PROGRAMS3=designer findtr moc qt20fix qtrename140 uic
PROGRAMS=assistant linguist lrelease lupdate qm2ts qmake qtconfig 
@


1.20
log
@one more header path is necessary to fix the PostgreSQL support for 7.3.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2002/11/23 22:00:20 espie Exp $
d10 1
a10 1
VERSION=	1.0
d155 2
a156 2
	${INSTALL_DATA} ${WRKBUILD}/lib/libqt-mt.so.3.10 ${PREFIX}/lib/qt3
	ln -sf qt3/libqt-mt.so.3.10 ${PREFIX}/lib
d168 1
a168 1
LIBRARIES=qt.so.3.10 editor.so.1.0 qui.so.1.0
d222 1
a222 1
	${INSTALL_MAN} ${WRKSRC}/doc/man/man1/uic.1 ${QT_MANDIR}/man1
@


1.19
log
@Install the specs files, makes it possible to use qmake from another project.
Credits should go to whomever mentioned this to me, but I deleted his email,
oops.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2002/11/23 18:52:22 espie Exp $
d116 1
@


1.18
log
@Update to qt 3.1.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2002/11/18 02:03:12 brad Exp $
d253 1
@


1.17
log
@remove cruft for MySQL
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2002/11/13 22:55:54 naddy Exp $
d10 1
a10 1
VERSION=	0.6
d154 2
a155 2
	${INSTALL_DATA} ${WRKBUILD}/lib/libqt-mt.so.3.6 ${PREFIX}/lib/qt3
	ln -sf qt3/libqt-mt.so.3.6 ${PREFIX}/lib
d167 1
a167 1
LIBRARIES=qt.so.3.6 editor.so.1.0 qui.so.1.0
@


1.16
log
@Require gcc3 on sparc64.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2002/10/29 19:48:58 naddy Exp $
a21 5
# Adjust for arches where MySQL/PostgreSQL don't work.
.if !${MACHINE_ARCH:Mi386} && !${MACHINE_ARCH:Msparc} && \
!${MACHINE_ARCH:Mpowerpc}
FLAVOR+=	no_mysql
.else
a22 1
.endif
@


1.15
log
@No regression tests available.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2002/10/26 11:45:52 espie Exp $
d36 4
@


1.14
log
@Update to 3.0.6 (maintenance release).
Add basic framework for qt-mt flavor (untested for real yet).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2002/08/21 13:52:39 espie Exp $
d146 1
@


1.13
log
@Use PSEUDO_FLAVORS for no_mysql/no_pgsql
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2002/08/02 22:13:19 naddy Exp $
d10 1
a10 1
VERSION=	0.5
d19 2
d49 1
a49 1
		-system-zlib -no-thread -sm -no-g++-exceptions \
d58 10
a77 1
MULTI_PACKAGES=	-examples -html
d145 13
d168 1
a168 3
VMEM_WARNING=	Yes

LIBRARIES=qt.so.3.5 editor.so.1.0 qui.so.1.0
d181 1
a181 1
.for l in ${LIBRARIES}
d189 1
a189 1
.endfor
d191 1
a191 1
.for p in ${PROGRAMS3}
d194 2
a195 2
.endfor
.for p in ${PROGRAMS}
d197 1
a197 1
.endfor
d238 1
a238 1
.if empty(FLAVOR:L:Mno_postgresql)
d241 2
a242 2
.endif
.if empty(FLAVOR:L:Mno_mysql)
d245 1
a245 1
.endif
d254 1
@


1.12
log
@Use VMEM_WARNING rather than rolling our own.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2002/07/17 21:43:36 espie Exp $
a12 1
NEED_VERSION=	1.508
d19 1
a19 1
FLAVORS=	no_mysql no_postgresql
d233 5
a237 5
FULLPKGNAME=		qt3-${VERSION}
FULLPKGNAME-examples=	qt3-examples-${VERSION}
FULLPKGNAME-html=	qt3-html-${VERSION}
FULLPKGNAME-mysql=	qt3-mysql-${VERSION}
FULLPKGNAME-postgresql=	qt3-postgresql-${VERSION}
@


1.11
log
@Update qt to 3.0.5.
Remove kde patches that have been integrated.
Independent rediscovery of a qt-copy patch (bogus lockfiles in RO directories)
and OpenBSD a.out fix.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2002/05/27 14:49:30 brad Exp $
d145 1
a145 8
pre-build:
	@@echo ""
	@@echo "*** WARNING: you may see an error such as"
	@@echo "***       virtual memory exhausted"
	@@echo "*** when building this package.  If you do you must increase"
	@@echo "*** your limits.  See the man page for your shell and look"
	@@echo "*** for the 'limit' or 'ulimit' command."
	@@echo ""
@


1.10
log
@- powerpc can build MySQL
- new png header path
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2002/03/30 18:13:31 brad Exp $
d10 1
a10 1
VERSION=	0.3
d37 1
a37 1
USE_GMAKE=	Yes
d61 1
d132 1
a132 1
DOCS=	ANNOUNCE FAQ LICENSE.GPL README README.QT \
d154 3
a156 4
LIBRARIES=qt.so.3.3 editor.so.1.0 qui.so.1.0
PROGRAMS3=moc findtr qt20fix qtrename140 uic designer
PROGRAMS=assistant linguist lrelease lupdate qm2ts \
	qtconfig qmake
@


1.9
log
@- fix COMMENTs for database plugins
- remove bogus CONFIGURE_ARGS option, this is handled farther down the Makefile
- remove unnecessary BUILD_DEPENDS on PostgreSQL
--
Ok'd by: maintainer
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2002/03/30 01:02:49 espie Exp $
d19 1
a20 1

d22 2
a23 1
.if !${MACHINE_ARCH:Mi386} && !${MACHINE_ARCH:Msparc}
d51 1
@


1.8
log
@propagate pseudo-flavor to subpackages
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2002/03/27 12:36:35 espie Exp $
d3 1
d7 2
a8 2
COMMENT-postgresql=	PostGresql plugin for qt3
COMMENT-mysql=		MySql plugin for qt3
d21 1
a21 1
# Adjust for arches where mysql/pgsql don't work.
d49 1
a49 1
		-plugin-sql-psql -no-sql-odbc \
a54 1

a71 1

a103 1
BUILD_DEPENDS+=::databases/postgresql
a108 1

d241 1
a241 1
FULLPKGNAME-html=		qt3-html-${VERSION}
@


1.7
log
@maintenance release, lots of useful small fixes.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2002/03/23 23:35:46 lebel Exp $
d76 9
a84 1
.if !empty(FLAVOR:Mno_mysql)
d98 1
a98 1
.if !empty(FLAVOR:Mno_postgresql)
d117 1
a117 1
LIB_DEPENDS+=	qt.3::x11/qt3
d225 1
a225 1
.if empty(FLAVOR:Mno_postgresql)
d229 1
a229 1
.if empty(FLAVOR:Mno_mysql)
@


1.6
log
@is wrong here, it should be empty(). espie@@ OK.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2002/03/23 17:35:12 lebel Exp $
d9 1
a9 1
VERSION=	0.2
d97 1
a97 1
BUILD_DEPENDS+=::databases/postgresql:patch
d99 1
a99 1
	-I`cd ${PORTSDIR}/databases/postgresql && make show=WRKSRC`/src/include -L${LOCALBASE}/lib \
d146 1
a146 1
LIBRARIES=qt.so.3.2 editor.so.1.0 qui.so.1.0
@


1.5
log
@mysql is marked BROKEN on anything else than i386 and sparc,
so, the default FLAVOR should be no_mysql for arch other those two.
espie@@ thinks so too.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2002/03/12 00:16:12 espie Exp $
d217 1
a217 1
.if !empty(FLAVOR:Mno_postgresql)
d221 1
a221 1
.if !empty(FLAVOR:Mno_mysql)
@


1.4
log
@Forgot synching with recent bsd.port.mk change.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2002/03/05 14:46:32 espie Exp $
d21 3
d25 1
@


1.3
log
@More tweaks, I forgot about designer, so some binaries must be renamed
to avoid conflicts. This also means more stuff in qt3 module.
Plus, create missing pluging directory in PLIST.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2002/03/05 12:40:52 espie Exp $
d12 1
a12 1
NEED_VERSION=	1.402
d37 1
a37 1
MAKE_ENV+=	HOME="${WRKDIST}"
@


1.2
log
@Give pseudo-flavors a fighting chance. Reported by Peter Stromberg.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2002/03/04 16:13:04 espie Exp $
d143 3
a145 3
PROGRAMS3=moc findtr qt20fix qtrename140
PROGRAMS=assistant designer linguist lrelease lupdate qm2ts \
	qtconfig uic qmake
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2001/05/06 04:41:22 lebel Exp $
d18 1
a18 1
FLAVORS=	no_mysql no_pgsql
d46 1
d48 1
d213 1
d216 2
d220 1
@


1.1.1.1
log
@Initial port of qt3.

Most notable improvement seems to be font-handling, especially unicode stuff.

Configured to relocate plugins at a reasonable place. Includes *sql
plugins, though they are thoroughly untested at the moment.

Works good enough to recompile xglobe for instance. Still work to do
though, some paths are probably incorrect yet.
@
text
@@
