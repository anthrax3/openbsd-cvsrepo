head	1.2;
access;
symbols
	OPENBSD_5_8:1.1.0.6
	OPENBSD_5_8_BASE:1.1
	OPENBSD_5_7:1.1.0.2
	OPENBSD_5_7_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2015.11.07.05.55.08;	author ajacoutot;	state dead;
branches;
next	1.1;
commitid	7UbzdDlpoUEfr2c7;

1.1
date	2015.02.08.04.55.00;	author jsing;	state Exp;
branches;
next	;
commitid	5LlNeYhyRigbgt8B;


desc
@@


1.2
log
@Major update to freerdp-1.2.0beta1.
Needed for an upcoming x11/gnome/vinagre update.

ok sthen@@
@
text
@$OpenBSD: patch-libfreerdp-core_tls_c,v 1.1 2015/02/08 04:55:00 jsing Exp $
--- libfreerdp-core/tls.c.orig	Sun Feb  8 04:08:05 2015
+++ libfreerdp-core/tls.c	Sun Feb  8 04:12:11 2015
@@@@ -44,6 +44,13 @@@@ boolean tls_connect(rdpTls* tls)
 	 */
 	SSL_CTX_set_options(tls->ctx, SSL_OP_ALL);
 
+	/*
+	 * Disable the SSL 3.0/TLS 1.0 CBC vulnerability workaround since this
+	 * breaks NLA - the remote host will return a TLS alert 50, terminating
+	 * the session.
+	 */
+	SSL_CTX_set_options(tls->ctx, SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS);
+
 	tls->ssl = SSL_new(tls->ctx);
 
 	if (tls->ssl == NULL)
@


1.1
log
@Switch freerdp back to libressl.

Disable the SSL 3.0/TLS 1.0 CBC vulnerability workaround since this breaks
NLA - the remote host will return a TLS alert 50, terminating the session.
This flag used to be part of SSL_OP_ALL, however was removed in r1.36 of
lib/libssl/src/ssl/ssl.h.

Issue reported by and fix tested by sthen@@

ok sthen@@
@
text
@d1 1
a1 1
$OpenBSD$
@

