head	1.4;
access;
symbols
	OPENBSD_6_0:1.4.0.2
	OPENBSD_6_0_BASE:1.4
	OPENBSD_5_9:1.2.0.4
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.2.0.6
	OPENBSD_5_8_BASE:1.2
	OPENBSD_5_7:1.2.0.2
	OPENBSD_5_7_BASE:1.2;
locks; strict;
comment	@# @;


1.4
date	2016.06.13.09.05.55;	author ajacoutot;	state Exp;
branches;
next	1.3;
commitid	WCp6tGKNaUWHBvnd;

1.3
date	2016.03.22.12.29.19;	author ajacoutot;	state dead;
branches;
next	1.2;
commitid	G6iTIdXlucht5LPm;

1.2
date	2014.09.23.08.39.52;	author ajacoutot;	state Exp;
branches;
next	1.1;
commitid	op9m2fXWQEdK9Eaj;

1.1
date	2014.09.23.05.47.46;	author ajacoutot;	state Exp;
branches;
next	;
commitid	04xUCSyaaaEo013I;


desc
@@


1.4
log
@Update to nautilus-sendto-3.8.4.
@
text
@$OpenBSD$

nautilus-sendto.c:383: error: #pragma GCC diagnostic not allowed inside functions
nautilus-sendto.c:384: error: #pragma GCC diagnostic not allowed inside functions
nautilus-sendto.c:387: error: #pragma GCC diagnostic not allowed inside functions

--- src/nautilus-sendto.c.orig	Mon Jun 13 11:04:02 2016
+++ src/nautilus-sendto.c	Mon Jun 13 11:04:15 2016
@@@@ -380,11 +380,8 @@@@ send_files (NautilusSendto *nst)
 		get_evo_mailto (mailto, nst->file_list);
 	}
 
-#pragma GCC diagnostic push
-#pragma GCC diagnostic ignored "-Wformat-nonliteral"
 	cmd = g_strdup_printf (nst->mail_cmd, mailto->str);
 	g_string_free (mailto, TRUE);
-#pragma GCC diagnostic pop
 
 	g_debug ("Mailer type: %d", nst->type);
 	g_debug ("Command: %s", cmd);
@


1.3
log
@Update to nautilus-sendto-3.8.3.
@
text
@d1 1
a1 1
$OpenBSD: patch-src_nautilus-sendto_c,v 1.2 2014/09/23 08:39:52 ajacoutot Exp $
d3 3
a5 4
From b8ee7f4055d9f9eb0cae227d20e7b02d2dd40587 Mon Sep 17 00:00:00 2001
From: Bastien Nocera <hadess@@hadess.net>
Date: Tue, 23 Sep 2014 10:29:10 +0200
Subject: main: Use g_mkdir_with_parents()
d7 5
a11 31
From ed05b67f9e2c050906032b5bcc3cb376d5bb1028 Mon Sep 17 00:00:00 2001
From: Bastien Nocera <hadess@@hadess.net>
Date: Tue, 23 Sep 2014 10:33:18 +0200
Subject: main: Create temp directories using g_mkdtemp()

--- src/nautilus-sendto.c.orig	Mon May 12 13:55:07 2014
+++ src/nautilus-sendto.c	Tue Sep 23 10:37:48 2014
@@@@ -254,21 +254,17 @@@@ pack_files (GList *file_list)
 	const char *filename;
 	GList *l;
 	GString *cmd, *tmp;
-	char *pack_type, *tmp_dir, *tmp_work_dir, *packed_file;
+	char *pack_type, *tmp_work_dir, *packed_file;
 
 	file_roller_cmd = g_find_program_in_path ("file-roller");
 	filename = pack_filename_from_names (file_list);
 
 	g_assert (filename != NULL && *filename != '\0');
 
-	tmp_dir = g_strdup_printf ("%s/nautilus-sendto-%s",
-				   g_get_tmp_dir (), g_get_user_name ());
-	g_mkdir (tmp_dir, 0700);
-	tmp_work_dir = g_strdup_printf ("%s/nautilus-sendto-%s/%li",
-					g_get_tmp_dir (), g_get_user_name (),
-					time (NULL));
-	g_mkdir (tmp_work_dir, 0700);
-	g_free (tmp_dir);
+	tmp_work_dir = g_build_filename (g_get_tmp_dir (),
+					 "nautilus-sendto-XXXXXX",
+					 NULL);
+	tmp_work_dir = g_mkdtemp (tmp_work_dir);
d13 5
a17 1
 	pack_type = g_strdup (".zip");
d19 2
@


1.2
log
@Merge patch from upstream.
@
text
@d1 1
a1 1
$OpenBSD$
@


1.1
log
@Update to nautilus-sendto-3.8.2.
@
text
@d3 4
a6 1
https://bugzilla.gnome.org/show_bug.cgi?id=737151
d8 22
a29 6
--- src/nautilus-sendto.c.orig	Tue Sep 23 07:37:21 2014
+++ src/nautilus-sendto.c	Tue Sep 23 07:37:37 2014
@@@@ -264,7 +264,7 @@@@ pack_files (GList *file_list)
 	tmp_dir = g_strdup_printf ("%s/nautilus-sendto-%s",
 				   g_get_tmp_dir (), g_get_user_name ());
 	g_mkdir (tmp_dir, 0700);
d31 11
a41 4
+	tmp_work_dir = g_strdup_printf ("%s/nautilus-sendto-%s/%lld",
 					g_get_tmp_dir (), g_get_user_name (),
 					time (NULL));
 	g_mkdir (tmp_work_dir, 0700);
@

