head	1.7;
access;
symbols
	OPENBSD_6_2:1.7.0.2
	OPENBSD_6_2_BASE:1.7;
locks; strict;
comment	@# @;


1.7
date	2017.09.28.23.39.53;	author naddy;	state Exp;
branches;
next	1.6;
commitid	NLHVXiOyd2fLsPAj;

1.6
date	2014.10.06.08.28.26;	author ajacoutot;	state dead;
branches;
next	1.5;
commitid	znFnQQb4hZ5sOmTB;

1.5
date	2014.08.22.12.39.41;	author ajacoutot;	state Exp;
branches;
next	1.4;
commitid	i7ec28802dTMGUec;

1.4
date	2014.08.20.07.39.32;	author ajacoutot;	state Exp;
branches;
next	1.3;
commitid	rmMzGpiDjKr6OyR8;

1.3
date	2013.05.01.12.40.18;	author ajacoutot;	state dead;
branches;
next	1.2;

1.2
date	2013.04.24.07.07.58;	author ajacoutot;	state Exp;
branches;
next	1.1;

1.1
date	2013.04.10.14.13.53;	author ajacoutot;	state Exp;
branches;
next	;


desc
@@


1.7
log
@Unbreak autoconf checks with clang by not using nested functions
@
text
@$OpenBSD$

Index: configure.ac
--- configure.ac.orig
+++ configure.ac
@@@@ -173,8 +173,9 @@@@ if test "x$have_statvfs" = "xyes" ; then
 fi
 
 # Check for defines we expect
-AC_COMPILE_IFELSE([AC_LANG_PROGRAM([[]], [[
+AC_COMPILE_IFELSE([AC_LANG_PROGRAM([[
 #include "stdio.h"
+]], [[
 printf ("%s", __FUNCTION__);
    ]])],
    [have_function=yes],
@@@@ -2104,7 +2105,6 @@@@ OLD_CFLAGS="$CFLAGS"
 OLD_LDFLAGS="$LDFLAGS"
 OLD_LIBS="$LIBS"
 CFLAGS=""
-LDFLAGS=""
 LIBS=""
 
 AC_ARG_ENABLE(libgif,
@@@@ -2155,7 +2155,6 @@@@ OLD_CFLAGS="$CFLAGS"
 OLD_LDFLAGS="$LDFLAGS"
 OLD_LIBS="$LIBS"
 CFLAGS=""
-LDFLAGS=""
 LIBS=""
 
 AC_ARG_ENABLE(libjpeg,
@@@@ -2206,7 +2205,6 @@@@ OLD_CFLAGS="$CFLAGS"
 OLD_LDFLAGS="$LDFLAGS"
 OLD_LIBS="$LIBS"
 CFLAGS=""
-LDFLAGS=""
 LIBS=""
 
 AC_ARG_ENABLE(libtiff,
@@@@ -2257,7 +2255,6 @@@@ OLD_CFLAGS="$CFLAGS"
 OLD_LDFLAGS="$LDFLAGS"
 OLD_LIBS="$LIBS"
 CFLAGS=""
-LDFLAGS=""
 LIBS=""
 
 AC_ARG_ENABLE(libpng,
@


1.6
log
@Update to (meta-)tracker-1.2.2.
@
text
@d1 1
a1 1
$OpenBSD: patch-configure_ac,v 1.5 2014/08/22 12:39:41 ajacoutot Exp $
d3 20
a22 13
From a41cef78eb6d5c0a4728f08b4d4bd8f0a8f6ddfb Mon Sep 17 00:00:00 2001
From: Martyn Russell <martyn@@lanedo.com>
Date: Mon, 28 Jul 2014 18:23:57 +0200
Subject: tracker-extract: Depend on libmediaart 0.5.0 when enabled

--- configure.ac.orig	Fri Aug 22 13:25:23 2014
+++ configure.ac	Fri Aug 22 14:04:18 2014
@@@@ -231,7 +231,7 @@@@ NETWORK_MANAGER_REQUIRED=0.8
 GSTREAMER_REQUIRED=0.10.31
 GUPNP_DLNA_REQUIRED=0.9.4
 LIBPNG_REQUIRED=0.89
-LIBMEDIAART_REQUIRED=0.1.0
+LIBMEDIAART_REQUIRED=0.5.0
d24 7
a30 5
 # 3.6.11 for sqlite_backup API
 # 3.6.16 to fix test failures
@@@@ -1073,9 +1073,15 @@@@ if test "x$enable_libmediaart" != "xno" ; then
    LIBTRACKER_MINER_CFLAGS="$LIBTRACKER_MINER_CFLAGS $LIBMEDIAART_CFLAGS"
    LIBTRACKER_MINER_LIBS="$LIBTRACKER_MINER_LIBS $LIBMEDIAART_LIBS"
d32 7
a38 5
+   LIBTRACKER_EXTRACT_CFLAGS="$LIBTRACKER_EXTRACT_CFLAGS $LIBMEDIAART_CFLAGS"
+   LIBTRACKER_EXTRACT_LIBS="$LIBTRACKER_EXTRACT_LIBS $LIBMEDIAART_LIBS"
+
    TRACKER_EXTRACT_CFLAGS="$TRACKER_EXTRACT_CFLAGS $LIBMEDIAART_CFLAGS"
    TRACKER_EXTRACT_LIBS="$TRACKER_EXTRACT_LIBS $LIBMEDIAART_LIBS"
d40 7
a46 9
+   TRACKER_MINER_FS_CFLAGS="$TRACKER_MINER_FS_CFLAGS $LIBMEDIAART_CFLAGS"
+   TRACKER_MINER_FS_LIBS="$TRACKER_MINER_FS_LIBS $LIBMEDIAART_LIBS"
+
    # Used for .pc file...
    LIBTRACKER_MINER_PC_REQUIRES="libmediaart-1.0"
    AC_SUBST(LIBTRACKER_MINER_PC_REQUIRES)
@@@@ -1762,7 +1768,7 @@@@ PKG_CHECK_MODULES(AVCODEC,
 AC_SUBST(AVCODEC_CFLAGS)
 AC_SUBST(AVCODEC_LIBS)
d48 1
a48 5
-PKG_CHECK_MODULES(AVCODEC,
+PKG_CHECK_MODULES(AVUTIL,
                   [libavutil >= 0.8.4],
                   [have_libavutil=yes],
                   [have_libavutil=no])
@


1.5
log
@Update to meta-tracker-1.0.3.
@
text
@d1 1
a1 1
$OpenBSD: patch-configure_ac,v 1.4 2014/08/20 07:39:32 ajacoutot Exp $
@


1.4
log
@Merge code from upstream to support new libmediaart.
@
text
@d1 1
a1 1
$OpenBSD$
d8 3
a10 3
--- configure.ac.orig	Thu Jul 10 15:20:49 2014
+++ configure.ac	Wed Aug 20 08:49:29 2014
@@@@ -197,7 +197,7 @@@@ NETWORK_MANAGER_REQUIRED=0.8
d19 1
a19 1
@@@@ -997,9 +997,15 @@@@ if test "x$enable_libmediaart" != "xno" ; then
d35 1
a35 1
@@@@ -1583,7 +1589,7 @@@@ PKG_CHECK_MODULES(AVCODEC,
@


1.3
log
@Update to (meta-)tracker-0.16.1.
@
text
@d1 1
a1 1
$OpenBSD: patch-configure_ac,v 1.2 2013/04/24 07:07:58 ajacoutot Exp $
d3 4
a6 4
From 67ccf1dbda724991d1bf1e30be38b388798f3e6a Mon Sep 17 00:00:00 2001
From: Antoine Jacoutot <ajacoutot@@gnome.org>
Date: Thu, 18 Apr 2013 12:21:49 +0000
Subject: tracker-dbus: add support for OpenBSD
d8 8
a15 3
--- configure.ac.orig	Wed Apr 10 14:51:37 2013
+++ configure.ac	Wed Apr 10 14:51:18 2013
@@@@ -231,6 +231,12 @@@@ LIBTRACKER_COMMON_REQUIRED="glib-2.0     >= $GLIB_REQU
d17 5
a21 1
 PKG_CHECK_MODULES(LIBTRACKER_COMMON, [$LIBTRACKER_COMMON_REQUIRED])
d23 2
a24 5
+case $host in
+  *-*-openbsd*)
+    LIBTRACKER_COMMON_LIBS="$LIBTRACKER_COMMON_LIBS -lkvm"
+    ;;
+esac
d26 18
a43 3
 # Check requirements for libtracker-data
 LIBTRACKER_DATA_REQUIRED="glib-2.0     >= $GLIB_REQUIRED
                           gio-unix-2.0 >= $GLIB_REQUIRED
@


1.2
log
@Committed upstream.
@
text
@d1 1
a1 1
$OpenBSD: patch-configure_ac,v 1.1 2013/04/10 14:13:53 ajacoutot Exp $
@


1.1
log
@Rework all kvm(3) patches to a state closer to being commitable upstream.
Fix a few implicit declarations.
Remove patch-src_libtracker-miner_tracker-password-provider_c which is not
needed anymore.
@
text
@d1 1
a1 1
$OpenBSD$
d3 4
a6 1
https://bugzilla.gnome.org/show_bug.cgi?id=697719
@

