head	1.7;
access;
symbols
	OPENBSD_6_0:1.7.0.6
	OPENBSD_6_0_BASE:1.7
	OPENBSD_5_9:1.7.0.2
	OPENBSD_5_9_BASE:1.7
	OPENBSD_5_8:1.7.0.4
	OPENBSD_5_8_BASE:1.7
	OPENBSD_5_7:1.6.0.4
	OPENBSD_5_7_BASE:1.6
	OPENBSD_5_6:1.6.0.2
	OPENBSD_5_6_BASE:1.6
	OPENBSD_5_5:1.3.0.2
	OPENBSD_5_5_BASE:1.3
	OPENBSD_5_3:1.1.0.6
	OPENBSD_5_3_BASE:1.1
	OPENBSD_5_2:1.1.0.4
	OPENBSD_5_2_BASE:1.1
	OPENBSD_5_1_BASE:1.1
	OPENBSD_5_1:1.1.0.2;
locks; strict;
comment	@# @;


1.7
date	2015.04.15.14.47.00;	author ajacoutot;	state Exp;
branches;
next	1.6;
commitid	uB9GbJGvyj7ylinZ;

1.6
date	2014.04.25.14.37.19;	author ajacoutot;	state Exp;
branches;
next	1.5;

1.5
date	2014.04.07.16.05.52;	author ajacoutot;	state Exp;
branches;
next	1.4;

1.4
date	2014.04.06.10.51.23;	author ajacoutot;	state Exp;
branches;
next	1.3;

1.3
date	2013.12.26.15.38.29;	author ajacoutot;	state Exp;
branches;
next	1.2;

1.2
date	2013.05.18.17.28.55;	author ajacoutot;	state dead;
branches;
next	1.1;

1.1
date	2011.09.12.07.39.21;	author ajacoutot;	state Exp;
branches;
next	;


desc
@@


1.7
log
@Enhance fade in look.
req. by stsp@@ during p2k15
@
text
@$OpenBSD: patch-data_Init_in,v 1.6 2014/04/25 14:37:19 ajacoutot Exp $
--- data/Init.in.orig	Thu Apr  2 15:52:42 2015
+++ data/Init.in	Wed Apr 15 16:43:30 2015
@@@@ -6,6 +6,9 @@@@
 PATH="@@X_PATH@@:$PATH"
 OLD_IFS=$IFS
 
+# enhance fade in look
+xsetroot -solid black
+
 gdmwhich () {
   COMMAND="$1"
   OUTPUT=
@@@@ -85,5 +88,12 @@@@ if [ "x$SETXKBMAP" != "x" ] ; then
     fi
   fi
 fi
+
+# /etc/X11/xdm/GiveConsole, fbtab(5)
+if [ -c /dev/drm0 ]; then
+    /sbin/chown _gdm /dev/drm0
+fi
+# XXX OpenBSD needs an implementation of XDG_RUNTIME_DIR
+rm -rf /var/db/gdm/.cache/gnome-shell/runtime-state-*
 
 exit 0
@


1.6
log
@Since we are missing an XDG_RUNTIME_DIR implementation, make sure we clean
the locked files in the .cache/gnome-shell/ directory so that we are not
left in 'locked' mode (i.e. black screen).
@
text
@d1 15
a15 4
$OpenBSD: patch-data_Init_in,v 1.5 2014/04/07 16:05:52 ajacoutot Exp $
--- data/Init.in.orig	Fri Feb  7 16:02:08 2014
+++ data/Init.in	Fri Apr 25 16:34:01 2014
@@@@ -86,4 +86,11 @@@@ if [ "x$SETXKBMAP" != "x" ] ; then
d18 1
a18 1
 
d25 1
a25 1
+
@


1.5
log
@Revert previous and merge patch from upstream now that it's been fixed.
@
text
@d1 4
a4 4
$OpenBSD: ports/x11/gnome/gdm/patches/patch-data_Init_in,v 1.3 2013/12/26 15:38:29 ajacoutot Exp $
--- data/Init.in.orig	Thu Dec 26 16:07:13 2013
+++ data/Init.in	Thu Dec 26 16:09:40 2013
@@@@ -86,4 +86,9 @@@@ if [ "x$SETXKBMAP" != "x" ] ; then
d12 2
@


1.4
log
@Finally unbreak GDM runtime -- it is fully working now.
@
text
@d1 3
a3 3
$OpenBSD: patch-data_Init_in,v 1.3 2013/12/26 15:38:29 ajacoutot Exp $
--- data/Init.in.orig	Tue Mar 18 05:23:44 2014
+++ data/Init.in	Sun Apr  6 12:37:25 2014
d10 1
a10 1
+  /sbin/chown _gdm /dev/drm0
@


1.3
log
@Do the proper chown(1) $USER, root or _gdm dance according to the situation.

prodded by kettenis@@
@
text
@d1 3
a3 3
$OpenBSD$
--- data/Init.in.orig	Thu Dec 26 16:07:13 2013
+++ data/Init.in	Thu Dec 26 16:09:40 2013
d10 1
a10 1
+    /sbin/chown _gdm /dev/drm0
@


1.2
log
@Add devel/check to BUILD_DEPENDS since it gets picked up for tests.
Remove uneeded patches and chunks.
@
text
@d1 6
a6 6
$OpenBSD: patch-data_Init_in,v 1.1 2011/09/12 07:39:21 ajacoutot Exp $
--- data/Init.in.orig	Sun Jul  4 17:44:10 2010
+++ data/Init.in	Sun Jul  4 17:44:32 2010
@@@@ -3,7 +3,7 @@@@
 # Plus a lot of fun stuff added
 #  -George
d8 6
a13 5
-PATH="@@X_PATH@@:$PATH"
+PATH="@@X_PATH@@:$PATH:${LOCALBASE}/bin"
 OLD_IFS=$IFS
 
 gdmwhich () {
@


1.1
log
@Update to gdm-3.0.4 but mark BROKEN for now.
@
text
@d1 1
a1 1
$OpenBSD$
@

