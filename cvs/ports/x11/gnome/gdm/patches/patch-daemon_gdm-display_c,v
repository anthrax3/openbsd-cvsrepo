head	1.2;
access;
symbols
	OPENBSD_6_1:1.2.0.2
	OPENBSD_6_1_BASE:1.2
	OPENBSD_6_0:1.1.0.6
	OPENBSD_6_0_BASE:1.1
	OPENBSD_5_9:1.1.0.2
	OPENBSD_5_9_BASE:1.1
	OPENBSD_5_8:1.1.0.4
	OPENBSD_5_8_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2017.03.03.13.01.26;	author ajacoutot;	state Exp;
branches;
next	1.1;
commitid	yUSOqvnIs3zvjqyw;

1.1
date	2015.04.03.18.39.06;	author ajacoutot;	state Exp;
branches;
next	;
commitid	yAn0NWAFkDqbBMqK;


desc
@@


1.2
log
@Update to gdm-3.22.2.
@
text
@$OpenBSD: patch-daemon_gdm-display_c,v 1.1 2015/04/03 18:39:06 ajacoutot Exp $

XXX fix+push upstream

--- daemon/gdm-display.c.orig	Wed Mar  1 21:58:01 2017
+++ daemon/gdm-display.c	Fri Mar  3 11:52:19 2017
@@@@ -49,7 +49,7 @@@@
 #include "gdm-dbus-util.h"
 #include "gdm-xerrors.h"
 
-#define INITIAL_SETUP_USERNAME "gnome-initial-setup"
+#define INITIAL_SETUP_USERNAME "_gnome-initial-setup"
 #define GNOME_SESSION_SESSIONS_PATH DATADIR "/gnome-session/sessions"
 
 #define GDM_DISPLAY_GET_PRIVATE(o) (G_TYPE_INSTANCE_GET_PRIVATE ((o), GDM_TYPE_DISPLAY, GdmDisplayPrivate))
@@@@ -301,8 +301,8 @@@@ setup_xhost_auth (XHostAddress              *host_entr
         host_entries[1].address   = "localuser\0" GDM_USERNAME;
         host_entries[1].length    = sizeof ("localuser\0" GDM_USERNAME);
         host_entries[2].family    = FamilyServerInterpreted;
-        host_entries[2].address   = "localuser\0gnome-initial-setup";
-        host_entries[2].length    = sizeof ("localuser\0gnome-initial-setup");
+        host_entries[2].address   = "localuser\0_gnome-initial-setup";
+        host_entries[2].length    = sizeof ("localuser\0_gnome-initial-setup");
 }
 
 gboolean
@


1.1
log
@Update to gdm-3.16.0.1.
@
text
@d1 1
a1 1
$OpenBSD$
d5 3
a7 3
--- daemon/gdm-display.c.orig	Fri Apr  3 20:26:42 2015
+++ daemon/gdm-display.c	Fri Apr  3 20:27:20 2015
@@@@ -50,7 +50,7 @@@@
d16 9
a24 6
@@@@ -307,7 +307,7 @@@@ setup_xhost_auth (XHostAddress              *host_entr
         si_entries[1].value       = GDM_USERNAME;
         si_entries[1].valuelength = strlen (GDM_USERNAME);
         si_entries[2].value       = "gnome-initial-setup";
-        si_entries[2].valuelength = strlen ("gnome-initial-setup");
+        si_entries[2].valuelength = strlen ("_gnome-initial-setup");
d26 1
a26 2
         host_entries[0].family    = FamilyServerInterpreted;
         host_entries[0].address   = (char *) &si_entries[0];
@

