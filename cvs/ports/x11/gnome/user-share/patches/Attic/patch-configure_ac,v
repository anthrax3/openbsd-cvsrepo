head	1.5;
access;
symbols
	OPENBSD_5_4:1.4.0.2
	OPENBSD_5_4_BASE:1.4;
locks; strict;
comment	@# @;


1.5
date	2013.09.26.15.11.22;	author ajacoutot;	state dead;
branches;
next	1.4;

1.4
date	2013.05.07.10.48.24;	author ajacoutot;	state Exp;
branches;
next	1.3;

1.3
date	2013.04.28.07.07.56;	author ajacoutot;	state Exp;
branches;
next	1.2;

1.2
date	2013.04.10.09.40.02;	author ajacoutot;	state Exp;
branches;
next	1.1;

1.1
date	2013.04.08.09.05.42;	author ajacoutot;	state Exp;
branches;
next	;


desc
@@


1.5
log
@Update to gnome-user-share-3.10.0.
@
text
@$OpenBSD: patch-configure_ac,v 1.4 2013/05/07 10:48:24 ajacoutot Exp $

https://bugzilla.gnome.org/show_bug.cgi?id=601890

--- configure.ac.orig	Mon Mar 25 12:33:35 2013
+++ configure.ac	Tue May  7 12:34:38 2013
@@@@ -54,10 +54,19 @@@@ fi
 
 AC_SUBST(HTTPD)
 
-PKG_CHECK_MODULES(USER_SHARE, glib-2.0 >= 2.28 gio-2.0 >= 2.26 gtk+-3.0 dbus-1 >= 1.1.1 dbus-glib-1 libnotify libcanberra-gtk3 gnome-bluetooth-1.0 >= 2.91.5)
+PKG_CHECK_MODULES(USER_SHARE, glib-2.0 >= 2.28 gio-2.0 >= 2.26 gtk+-3.0 dbus-1 >= 1.1.1 dbus-glib-1 libnotify libcanberra-gtk3)
 AC_SUBST(USER_SHARE_CFLAGS)
 AC_SUBST(USER_SHARE_LIBS)
 
+AC_ARG_ENABLE(bluetooth, AS_HELP_STRING([--disable-bluetooth],[compile without bluetooth support]),,enable_bluetooth=yes)
+if test "x$enable_bluetooth" = "xyes"; then
+  PKG_CHECK_MODULES(BLUETOOTH, gnome-bluetooth-1.0 >= 2.91.5)
+  AC_DEFINE(HAVE_BLUETOOTH, 1, [Set to true if gnome-bluetooth support is available])
+else
+  AC_MSG_WARN([Bluetooth support is disabled.])
+fi
+AM_CONDITIONAL(USE_BLUETOOTH, [test "$enable_bluetooth" = "yes"])
+
 AC_CHECK_LIB(socket, socket)
 
 have_socket=no
@@@@ -124,7 +133,7 @@@@ AC_ARG_WITH(nautilusdir,
 	    [ac_with_nautilusdir=""])
 
 PKG_CHECK_MODULES(EXTENSION,
-		   libnautilus-extension >= 2.91.7 gnome-bluetooth-1.0)
+		   libnautilus-extension >= 2.91.7)
 if test "${ac_with_nautilusdir}" = ""; then
 	ac_with_nautilusdir=`pkg-config --variable=extensiondir libnautilus-extension`
 fi
@


1.4
log
@Update bluetooth patches with their latest revision from the BZ ticket.
@
text
@d1 1
a1 1
$OpenBSD$
@


1.3
log
@Simplify patching.
@
text
@d1 1
a1 1
$OpenBSD: patch-configure_ac,v 1.2 2013/04/10 09:40:02 ajacoutot Exp $
d3 1
a3 1
https://bugzilla.gnome.org/show_bug.cgi?id=697537
d6 2
a7 2
+++ configure.ac	Wed Apr 10 10:20:02 2013
@@@@ -54,7 +54,7 @@@@ fi
d16 6
a21 18
@@@@ -116,6 +116,24 @@@@ MODULES_PATH=$with_modules_path
 AC_SUBST(MODULES_PATH)
 
 dnl===========================================================================
+dnl disable bluetooth on non Linux platforms (needs bluez and udev)
+
+case $host_os in
+  linux*)
+    PKG_CHECK_MODULES(BLUETOOTH, gnome-bluetooth-1.0 >= 2.91.5)
+    have_bluetooth=yes
+    ;;
+  *)
+    have_bluetooth=no
+    ;;
+esac
+
+if test "x$have_bluetooth" = xyes ; then
+        AC_DEFINE(HAVE_BLUETOOTH, 1, [Define to 1 if bluetooth support is available])
d23 1
a23 1
+AM_CONDITIONAL(HAVE_BLUETOOTH, [test x"$have_bluetooth" = x"yes"])
d25 1
a25 2
+dnl===========================================================================
 dnl Check for nautilus for the share bar
d27 2
a28 2
 AC_ARG_WITH(nautilusdir,
@@@@ -124,7 +142,7 @@@@ AC_ARG_WITH(nautilusdir,
@


1.2
log
@Split the sharing schema so that we don't install the bluetooth keys
which we don't support.
@
text
@d1 1
a1 1
$OpenBSD: patch-configure_ac,v 1.1 2013/04/08 09:05:42 ajacoutot Exp $
a49 8
@@@@ -186,6 +204,7 @@@@ data/icons/32x32/Makefile
 data/icons/48x48/Makefile
 data/gnome-user-share.desktop.in
 data/org.gnome.desktop.file-sharing.gschema.xml.in
+data/org.gnome.desktop.file-sharing-bluetooth.gschema.xml.in
 po/Makefile.in
 src/Makefile
 help/Makefile
@


1.1
log
@Proper conditionnals for bluetooth support.
@
text
@d1 1
a1 1
$OpenBSD$
d6 1
a6 1
+++ configure.ac	Mon Apr  8 10:45:42 2013
d16 1
a16 1
@@@@ -116,6 +116,25 @@@@ MODULES_PATH=$with_modules_path
d35 1
a35 2
+
+dnl ==========================================================================
d41 1
a41 1
@@@@ -124,7 +143,7 @@@@ AC_ARG_WITH(nautilusdir,
d50 8
@

