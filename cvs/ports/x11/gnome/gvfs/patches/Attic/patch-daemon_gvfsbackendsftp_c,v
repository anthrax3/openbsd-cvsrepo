head	1.6;
access;
symbols
	OPENBSD_5_5:1.5.0.2
	OPENBSD_5_5_BASE:1.5
	OPENBSD_5_2:1.3.0.2
	OPENBSD_5_2_BASE:1.3;
locks; strict;
comment	@# @;


1.6
date	2014.03.27.08.55.09;	author ajacoutot;	state dead;
branches;
next	1.5;

1.5
date	2013.12.21.13.21.49;	author ajacoutot;	state Exp;
branches;
next	1.4;

1.4
date	2012.09.27.13.03.01;	author ajacoutot;	state dead;
branches;
next	1.3;

1.3
date	2012.07.13.15.23.59;	author ajacoutot;	state Exp;
branches;
next	1.2;

1.2
date	2012.07.12.11.35.36;	author ajacoutot;	state Exp;
branches;
next	1.1;

1.1
date	2012.07.10.10.15.19;	author mpi;	state Exp;
branches;
next	;


desc
@@


1.6
log
@Update to gvfs-1.20.0.
@
text
@$OpenBSD: patch-daemon_gvfsbackendsftp_c,v 1.5 2013/12/21 13:21:49 ajacoutot Exp $

From 15601b4f10f30eaeab2a33006ef00e9f0888da7c Mon Sep 17 00:00:00 2001
From: Ross Lagerwall <rosslagerwall@@gmail.com>
Date: Thu, 07 Nov 2013 10:11:40 +0000
Subject: sftp: Fix handling of multiple reads of the packet length

--- daemon/gvfsbackendsftp.c.orig	Fri Nov  8 14:23:39 2013
+++ daemon/gvfsbackendsftp.c	Sat Dec 21 14:12:18 2013
@@@@ -1242,7 +1242,7 @@@@ read_reply_async_got_len  (GObject *source_object,
   if (backend->reply_size_read < 4)
     {
       g_input_stream_read_async (backend->reply_stream,
-				 &backend->reply_size + backend->reply_size_read, 4 - backend->reply_size_read,
+				 (char *)&backend->reply_size + backend->reply_size_read, 4 - backend->reply_size_read,
 				 0, backend->reply_stream_cancellable, read_reply_async_got_len,
 				 backend);
       return;
@


1.5
log
@Bring some sftp, http and ftp fixes from upstream.
@
text
@d1 1
a1 1
$OpenBSD$
@


1.4
log
@Update to gvfs-1.14.0.
@
text
@d1 1
a1 1
$OpenBSD: patch-daemon_gvfsbackendsftp_c,v 1.3 2012/07/13 15:23:59 ajacoutot Exp $
d3 4
a6 4
From 2fec402d6523e4cf416d754f69d012dc67a58a2e Mon Sep 17 00:00:00 2001
From: Martin Pieuchot <mpi@@openbsd.org>
Date: Fri, 13 Jul 2012 14:51:39 +0000
Subject: daemon: Support allocating PTYs through openpty on BSD
d8 11
a18 13
--- daemon/gvfsbackendsftp.c.orig	Tue May 15 20:01:50 2012
+++ daemon/gvfsbackendsftp.c	Mon Jul  9 12:24:52 2012
@@@@ -71,8 +71,8 @@@@
  * fstat
  */
 
-#ifdef HAVE_GRANTPT
-/* We only use this on systems with unix98 ptys */
+#if defined(HAVE_GRANTPT) || defined(HAVE_OPENPTY)
+/* We only use this on systems with unix98 or BSD ptys */
 #define USE_PTY 1
 #endif
 
@


1.3
log
@Committed upstream.
@
text
@d1 1
a1 1
$OpenBSD: patch-daemon_gvfsbackendsftp_c,v 1.2 2012/07/12 11:35:36 ajacoutot Exp $
@


1.2
log
@Link to BZ.
@
text
@d1 1
a1 1
$OpenBSD: patch-daemon_gvfsbackendsftp_c,v 1.1 2012/07/10 10:15:19 mpi Exp $
d3 4
a6 1
https://bugzilla.gnome.org/show_bug.cgi?id=679790
@


1.1
log
@Make use of openpty(3) to allocate a pseudo-tty required for the ssh
authentication. This allow to mount sftp shares using passwords with
any application relying on gvfs. With a lot of help from nicm@@.

Packages already bumped but I failed again with cvs add.

Ok ajacoutot@@, jasper@@
@
text
@d1 4
a4 1
$OpenBSD$
@

