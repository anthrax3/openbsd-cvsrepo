head	1.4;
access;
symbols
	OPENBSD_5_5:1.3.0.2
	OPENBSD_5_5_BASE:1.3;
locks; strict;
comment	@# @;


1.4
date	2014.03.27.08.55.09;	author ajacoutot;	state dead;
branches;
next	1.3;

1.3
date	2014.01.23.08.36.02;	author ajacoutot;	state Exp;
branches;
next	1.2;

1.2
date	2012.05.15.18.29.31;	author ajacoutot;	state dead;
branches;
next	1.1;

1.1
date	2012.05.01.15.01.03;	author ajacoutot;	state Exp;
branches;
next	;


desc
@@


1.4
log
@Update to gvfs-1.20.0.
@
text
@$OpenBSD: patch-daemon_gvfsafpvolume_c,v 1.3 2014/01/23 08:36:02 ajacoutot Exp $

From 20bb9205b25ab07864f3733205e420508b2102a6 Mon Sep 17 00:00:00 2001
From: Ross Lagerwall <rosslagerwall@@gmail.com>
Date: Thu, 19 Dec 2013 13:53:24 +0000
Subject: afp: Don't crash when opening the root directory

--- daemon/gvfsafpvolume.c.orig	Thu Nov  7 16:12:17 2013
+++ daemon/gvfsafpvolume.c	Thu Jan 23 09:30:41 2014
@@@@ -460,14 +460,6 @@@@ g_vfs_afp_volume_open_fork (GVfsAfpVolume      *volume
   g_return_if_fail (G_VFS_IS_AFP_VOLUME (volume));
 
   priv = volume->priv;
-  
-  if (is_root (filename))
-  {
-    g_simple_async_report_error_in_idle (G_OBJECT (volume), callback,
-                                         user_data, G_IO_ERROR, G_IO_ERROR_IS_DIRECTORY,
-                                         _("File is directory"));
-    return;
-  }
 
   comm = g_vfs_afp_command_new (AFP_COMMAND_OPEN_FORK);
   /* data fork */
@


1.3
log
@Bring some fixes from upstream (crash, timeout, ...).
@
text
@d1 1
a1 1
$OpenBSD$
@


1.2
log
@Bugfix update to gvfs-1.12.3.
@
text
@d1 1
a1 1
$OpenBSD: patch-daemon_gvfsafpvolume_c,v 1.1 2012/05/01 15:01:03 ajacoutot Exp $
d3 4
a6 4
From 7fe5deeae25f2396027f667d8960d2ec84c64716 Mon Sep 17 00:00:00 2001
From: Matthias Clasen <mclasen@@redhat.com>
Date: Mon, 30 Apr 2012 10:09:30 +0000
Subject: afp: Use g_clear_object properly
d8 4
a11 4
--- daemon/gvfsafpvolume.c.orig	Fri Apr 27 09:57:36 2012
+++ daemon/gvfsafpvolume.c	Tue May  1 16:56:51 2012
@@@@ -1082,7 +1082,7 @@@@ create_directory_get_filedir_parms_cb (GObject *source
   return;
d13 12
a24 6
 error:
-  g_clear_object (info);
+  g_clear_object (&info);
   g_simple_async_result_take_error (simple, err);
   g_simple_async_result_complete (simple);
   g_object_unref (simple);
@


1.1
log
@Unbreak after recent glib2 update (from upstream).
Breakage reported by fgsch@@, thanks.
@
text
@d1 1
a1 1
$OpenBSD$
@

