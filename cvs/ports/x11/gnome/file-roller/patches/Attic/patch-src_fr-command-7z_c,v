head	1.4;
access;
symbols
	OPENBSD_5_2:1.3.0.4
	OPENBSD_5_2_BASE:1.3
	OPENBSD_5_1_BASE:1.3
	OPENBSD_5_1:1.3.0.2
	OPENBSD_5_0:1.2.0.8
	OPENBSD_5_0_BASE:1.2
	OPENBSD_4_9:1.2.0.6
	OPENBSD_4_9_BASE:1.2
	OPENBSD_4_8:1.2.0.4
	OPENBSD_4_8_BASE:1.2
	OPENBSD_4_7:1.2.0.2
	OPENBSD_4_7_BASE:1.2
	OPENBSD_4_6:1.1.0.4
	OPENBSD_4_6_BASE:1.1
	OPENBSD_4_5:1.1.0.2
	OPENBSD_4_5_BASE:1.1;
locks; strict;
comment	@# @;


1.4
date	2012.09.28.09.10.40;	author jasper;	state dead;
branches;
next	1.3;

1.3
date	2011.09.12.07.26.20;	author ajacoutot;	state Exp;
branches;
next	1.2;

1.2
date	2009.10.12.19.01.08;	author jasper;	state Exp;
branches;
next	1.1;

1.1
date	2008.11.23.00.11.18;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.4
log
@- update to file-roller-3.6.0
@
text
@$OpenBSD: patch-src_fr-command-7z_c,v 1.3 2011/09/12 07:26:20 ajacoutot Exp $

Fix a crasher possible with 7z files.

--- src/fr-command-7z.c.orig	Tue Mar  1 19:51:35 2011
+++ src/fr-command-7z.c	Mon May 23 10:20:44 2011
@@@@ -129,6 +129,7 @@@@ list__process_line (char     *line,
 			}
 			else {
 				fdata = p7z_comm->fdata;
+			if (fdata->full_path) {
 				if (fdata->dir)
 					fdata->name = dir_name_from_path (fdata->full_path);
 				else
@@@@ -136,6 +137,7 @@@@ list__process_line (char     *line,
 				fdata->path = remove_level_from_path (fdata->full_path);
 				fr_command_add_file (comm, fdata);
 				p7z_comm->fdata = NULL;
+			}
 			}
 		}
 		return;
@


1.3
log
@Start the GNOME3 merge armageddon... breakage expected.
@
text
@d1 1
a1 1
$OpenBSD: patch-src_fr-command-7z_c,v 1.1.1.1 2011/06/21 17:05:24 jasper Exp $
@


1.2
log
@- update file-roller to 2.28.0
@
text
@d1 1
a1 1
$OpenBSD: patch-src_fr-command-7z_c,v 1.1 2008/11/23 00:11:18 jasper Exp $
d5 3
a7 3
--- src/fr-command-7z.c.orig	Mon Oct 12 20:49:39 2009
+++ src/fr-command-7z.c	Mon Oct 12 20:50:18 2009
@@@@ -130,6 +130,7 @@@@ list__process_line (char     *line,
d15 1
a15 1
@@@@ -137,6 +138,7 @@@@ list__process_line (char     *line,
@


1.1
log
@- fix potential crasher with 7zip files
* diff from opensolaris
@
text
@d1 1
a1 1
$OpenBSD$
d5 6
a10 13
--- src/fr-command-7z.c.orig	Sun Nov 23 01:01:39 2008
+++ src/fr-command-7z.c	Sun Nov 23 01:05:32 2008
@@@@ -125,13 +125,15 @@@@ list__process_line (char     *line,
 	if (strcmp (line, "") == 0) {
 		if (p7z_comm->fdata != NULL) {
 			fdata = p7z_comm->fdata;
-			if (fdata->dir)
-				fdata->name = dir_name_from_path (fdata->full_path);
-			else
-				fdata->name = g_strdup (file_name_from_path (fdata->full_path));
-			fdata->path = remove_level_from_path (fdata->full_path);
-			fr_command_add_file (comm, fdata);
-			p7z_comm->fdata = NULL;
d12 7
a18 7
+				if (fdata->dir)
+					fdata->name = dir_name_from_path (fdata->full_path);
+				else
+					fdata->name = g_strdup (file_name_from_path (fdata->full_path));
+				fdata->path = remove_level_from_path (fdata->full_path);
+				fr_command_add_file (comm, fdata);
+				p7z_comm->fdata = NULL;
d20 1
a22 1
 	}
@

