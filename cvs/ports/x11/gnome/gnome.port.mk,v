head	1.100;
access;
symbols
	OPENBSD_6_0:1.100.0.2
	OPENBSD_6_0_BASE:1.100
	OPENBSD_5_9:1.99.0.2
	OPENBSD_5_9_BASE:1.99
	OPENBSD_5_8:1.99.0.4
	OPENBSD_5_8_BASE:1.99
	OPENBSD_5_7:1.97.0.2
	OPENBSD_5_7_BASE:1.97
	OPENBSD_5_6:1.88.0.2
	OPENBSD_5_6_BASE:1.88
	OPENBSD_5_5:1.75.0.2
	OPENBSD_5_5_BASE:1.75
	OPENBSD_5_4:1.67.0.2
	OPENBSD_5_4_BASE:1.67
	OPENBSD_5_3:1.63.0.2
	OPENBSD_5_3_BASE:1.63
	OPENBSD_5_2:1.60.0.2
	OPENBSD_5_2_BASE:1.60
	OPENBSD_5_1_BASE:1.53
	OPENBSD_5_1:1.53.0.2
	OPENBSD_5_0:1.40.0.2
	OPENBSD_5_0_BASE:1.40
	OPENBSD_4_9:1.34.0.2
	OPENBSD_4_9_BASE:1.34
	OPENBSD_4_8:1.26.0.2
	OPENBSD_4_8_BASE:1.26
	OPENBSD_4_7:1.25.0.2
	OPENBSD_4_7_BASE:1.25
	OPENBSD_4_6:1.21.0.2
	OPENBSD_4_6_BASE:1.21
	OPENBSD_4_5:1.20.0.2
	OPENBSD_4_5_BASE:1.20
	OPENBSD_4_4:1.18.0.2
	OPENBSD_4_4_BASE:1.18
	OPENBSD_4_3:1.15.0.2
	OPENBSD_4_3_BASE:1.15
	OPENBSD_4_2:1.14.0.2
	OPENBSD_4_2_BASE:1.14;
locks; strict;
comment	@# @;


1.100
date	2016.03.11.20.07.49;	author naddy;	state Exp;
branches;
next	1.99;
commitid	2plBeQwqdkxJp7aF;

1.99
date	2015.04.03.22.32.27;	author ajacoutot;	state Exp;
branches;
next	1.98;
commitid	LYFob74St1ddT7jN;

1.98
date	2015.03.27.08.16.16;	author ajacoutot;	state Exp;
branches;
next	1.97;
commitid	BUhOiEl2FUSRKwq7;

1.97
date	2014.12.21.11.49.48;	author ajacoutot;	state Exp;
branches;
next	1.96;
commitid	bVVgjwASK1wPAKP2;

1.96
date	2014.10.08.12.17.06;	author ajacoutot;	state Exp;
branches;
next	1.95;
commitid	BYFf20TCOBqZdgy1;

1.95
date	2014.10.04.08.52.47;	author ajacoutot;	state Exp;
branches;
next	1.94;
commitid	9wVdLMEBt9nsGyxy;

1.94
date	2014.09.13.16.29.39;	author ajacoutot;	state Exp;
branches;
next	1.93;
commitid	Oe6hGz6WPkH4vba4;

1.93
date	2014.09.05.14.45.02;	author jasper;	state Exp;
branches;
next	1.92;
commitid	f4VbjcUvEOJXzzBc;

1.92
date	2014.09.03.19.42.16;	author jasper;	state Exp;
branches;
next	1.91;
commitid	IhQujaXTpiL0zI7M;

1.91
date	2014.09.03.09.53.55;	author ajacoutot;	state Exp;
branches;
next	1.90;
commitid	mFm2wqV2TUYlOjdD;

1.90
date	2014.09.02.15.16.26;	author ajacoutot;	state Exp;
branches;
next	1.89;
commitid	A69KYio3vUHpthhT;

1.89
date	2014.09.02.14.39.37;	author jasper;	state Exp;
branches;
next	1.88;
commitid	cgBaOZSYRaGFAhqh;

1.88
date	2014.07.09.17.45.51;	author ajacoutot;	state Exp;
branches;
next	1.87;
commitid	R0UGwFsGFqSKFDSp;

1.87
date	2014.07.09.17.05.34;	author ajacoutot;	state Exp;
branches;
next	1.86;
commitid	fWB73Un4f8x4fXji;

1.86
date	2014.07.09.13.55.19;	author ajacoutot;	state Exp;
branches;
next	1.85;
commitid	62Z5wrBNolAhn1VM;

1.85
date	2014.04.08.17.25.35;	author ajacoutot;	state Exp;
branches;
next	1.84;

1.84
date	2014.04.03.12.18.19;	author jasper;	state Exp;
branches;
next	1.83;

1.83
date	2014.04.01.17.03.14;	author jasper;	state Exp;
branches;
next	1.82;

1.82
date	2014.04.01.15.31.46;	author jasper;	state Exp;
branches;
next	1.81;

1.81
date	2014.03.30.14.43.24;	author ajacoutot;	state Exp;
branches;
next	1.80;

1.80
date	2014.03.28.08.48.14;	author ajacoutot;	state Exp;
branches;
next	1.79;

1.79
date	2014.03.26.16.09.06;	author ajacoutot;	state Exp;
branches;
next	1.78;

1.78
date	2014.03.25.11.37.47;	author ajacoutot;	state Exp;
branches;
next	1.77;

1.77
date	2014.03.25.09.39.17;	author ajacoutot;	state Exp;
branches;
next	1.76;

1.76
date	2014.03.16.09.11.23;	author ajacoutot;	state Exp;
branches;
next	1.75;

1.75
date	2013.11.17.09.41.00;	author ajacoutot;	state Exp;
branches;
next	1.74;

1.74
date	2013.10.16.10.28.25;	author ajacoutot;	state Exp;
branches;
next	1.73;

1.73
date	2013.10.16.10.11.25;	author sthen;	state Exp;
branches;
next	1.72;

1.72
date	2013.10.15.09.55.30;	author ajacoutot;	state Exp;
branches;
next	1.71;

1.71
date	2013.10.15.09.43.08;	author ajacoutot;	state Exp;
branches;
next	1.70;

1.70
date	2013.10.15.09.20.49;	author ajacoutot;	state Exp;
branches;
next	1.69;

1.69
date	2013.09.28.08.47.58;	author ajacoutot;	state Exp;
branches;
next	1.68;

1.68
date	2013.09.26.07.50.43;	author ajacoutot;	state Exp;
branches;
next	1.67;

1.67
date	2013.04.16.13.16.30;	author ajacoutot;	state Exp;
branches;
next	1.66;

1.66
date	2013.03.29.16.35.44;	author ajacoutot;	state Exp;
branches;
next	1.65;

1.65
date	2013.03.26.16.28.22;	author ajacoutot;	state Exp;
branches;
next	1.64;

1.64
date	2013.03.21.08.48.56;	author ajacoutot;	state Exp;
branches;
next	1.63;

1.63
date	2012.09.27.14.14.31;	author ajacoutot;	state Exp;
branches;
next	1.62;

1.62
date	2012.09.11.09.28.56;	author ajacoutot;	state Exp;
branches;
next	1.61;

1.61
date	2012.09.01.16.16.33;	author ajacoutot;	state Exp;
branches;
next	1.60;

1.60
date	2012.03.29.16.34.43;	author ajacoutot;	state Exp;
branches;
next	1.59;

1.59
date	2012.03.29.07.45.55;	author ajacoutot;	state Exp;
branches;
next	1.58;

1.58
date	2012.03.29.07.23.46;	author ajacoutot;	state Exp;
branches;
next	1.57;

1.57
date	2012.03.06.12.45.13;	author ajacoutot;	state Exp;
branches;
next	1.56;

1.56
date	2012.02.26.15.09.43;	author ajacoutot;	state Exp;
branches;
next	1.55;

1.55
date	2012.02.18.18.19.14;	author ajacoutot;	state Exp;
branches;
next	1.54;

1.54
date	2012.02.16.22.21.54;	author ajacoutot;	state Exp;
branches;
next	1.53;

1.53
date	2011.12.12.15.39.57;	author jasper;	state Exp;
branches;
next	1.52;

1.52
date	2011.12.03.18.32.06;	author ajacoutot;	state Exp;
branches;
next	1.51;

1.51
date	2011.10.03.06.41.43;	author ajacoutot;	state Exp;
branches;
next	1.50;

1.50
date	2011.09.28.15.07.57;	author jasper;	state Exp;
branches;
next	1.49;

1.49
date	2011.09.28.09.46.57;	author jasper;	state Exp;
branches;
next	1.48;

1.48
date	2011.09.27.11.37.52;	author ajacoutot;	state Exp;
branches;
next	1.47;

1.47
date	2011.09.20.20.59.25;	author ajacoutot;	state Exp;
branches;
next	1.46;

1.46
date	2011.09.20.20.50.33;	author jasper;	state Exp;
branches;
next	1.45;

1.45
date	2011.09.19.09.07.24;	author jasper;	state Exp;
branches;
next	1.44;

1.44
date	2011.09.19.08.47.20;	author jasper;	state Exp;
branches;
next	1.43;

1.43
date	2011.09.19.07.55.43;	author jasper;	state Exp;
branches;
next	1.42;

1.42
date	2011.09.19.07.44.58;	author ajacoutot;	state Exp;
branches;
next	1.41;

1.41
date	2011.09.12.12.02.39;	author jasper;	state Exp;
branches;
next	1.40;

1.40
date	2011.06.02.17.20.33;	author ajacoutot;	state Exp;
branches;
next	1.39;

1.39
date	2011.05.17.13.48.18;	author ajacoutot;	state Exp;
branches;
next	1.38;

1.38
date	2011.05.13.21.10.49;	author ajacoutot;	state Exp;
branches;
next	1.37;

1.37
date	2011.05.11.14.56.42;	author ajacoutot;	state Exp;
branches;
next	1.36;

1.36
date	2011.05.11.12.50.20;	author ajacoutot;	state Exp;
branches;
next	1.35;

1.35
date	2011.04.26.12.50.54;	author ajacoutot;	state Exp;
branches;
next	1.34;

1.34
date	2010.11.22.08.36.56;	author espie;	state Exp;
branches;
next	1.33;

1.33
date	2010.10.24.21.12.47;	author ajacoutot;	state Exp;
branches;
next	1.32;

1.32
date	2010.10.23.16.31.29;	author ajacoutot;	state Exp;
branches;
next	1.31;

1.31
date	2010.10.23.15.26.27;	author ajacoutot;	state Exp;
branches;
next	1.30;

1.30
date	2010.10.23.14.37.17;	author ajacoutot;	state Exp;
branches;
next	1.29;

1.29
date	2010.10.19.22.49.35;	author espie;	state Exp;
branches;
next	1.28;

1.28
date	2010.10.19.15.20.36;	author ajacoutot;	state Exp;
branches;
next	1.27;

1.27
date	2010.10.18.13.17.24;	author jasper;	state Exp;
branches;
next	1.26;

1.26
date	2010.04.22.23.19.13;	author ajacoutot;	state Exp;
branches;
next	1.25;

1.25
date	2009.11.16.08.39.28;	author ajacoutot;	state Exp;
branches;
next	1.24;

1.24
date	2009.10.21.16.08.31;	author ajacoutot;	state Exp;
branches;
next	1.23;

1.23
date	2009.10.10.12.38.33;	author jasper;	state Exp;
branches;
next	1.22;

1.22
date	2009.10.09.16.05.51;	author steven;	state Exp;
branches;
next	1.21;

1.21
date	2009.04.06.10.05.20;	author ajacoutot;	state Exp;
branches;
next	1.20;

1.20
date	2008.11.23.22.56.37;	author jasper;	state Exp;
branches;
next	1.19;

1.19
date	2008.11.23.12.16.03;	author jasper;	state Exp;
branches;
next	1.18;

1.18
date	2008.06.02.14.10.07;	author ajacoutot;	state Exp;
branches;
next	1.17;

1.17
date	2008.05.26.13.23.34;	author ajacoutot;	state Exp;
branches;
next	1.16;

1.16
date	2008.04.15.11.51.23;	author jasper;	state Exp;
branches;
next	1.15;

1.15
date	2007.12.27.20.45.54;	author jasper;	state Exp;
branches;
next	1.14;

1.14
date	2007.07.03.08.50.36;	author jasper;	state Exp;
branches;
next	1.13;

1.13
date	2007.06.30.12.14.14;	author jasper;	state Exp;
branches;
next	1.12;

1.12
date	2007.06.30.11.39.46;	author jasper;	state Exp;
branches;
next	1.11;

1.11
date	2007.06.29.21.49.04;	author jasper;	state Exp;
branches;
next	1.10;

1.10
date	2007.06.29.19.36.43;	author jasper;	state Exp;
branches;
next	1.9;

1.9
date	2007.06.29.19.35.00;	author jasper;	state Exp;
branches;
next	1.8;

1.8
date	2007.06.29.19.28.06;	author jasper;	state Exp;
branches;
next	1.7;

1.7
date	2007.06.29.19.23.34;	author jasper;	state Exp;
branches;
next	1.6;

1.6
date	2007.06.01.17.29.09;	author jasper;	state Exp;
branches;
next	1.5;

1.5
date	2007.05.31.12.49.08;	author jasper;	state Exp;
branches;
next	1.4;

1.4
date	2007.05.31.12.18.47;	author jasper;	state Exp;
branches;
next	1.3;

1.3
date	2007.05.31.12.07.22;	author jasper;	state Exp;
branches;
next	1.2;

1.2
date	2007.05.31.11.30.35;	author jasper;	state Exp;
branches;
next	1.1;

1.1
date	2007.05.30.09.19.02;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.100
log
@garbage collect CONFIGURE_SHARED
@
text
@# $OpenBSD: gnome.port.mk,v 1.99 2015/04/03 22:32:27 ajacoutot Exp $
#
# Module for GNOME related ports

.if (defined(GNOME_PROJECT) && defined(GNOME_VERSION))
PORTROACH+=		limitw:1,even
DISTNAME=		${GNOME_PROJECT}-${GNOME_VERSION}
VERSION=		${GNOME_VERSION}
HOMEPAGE?=		https://wiki.gnome.org/
MASTER_SITES?=		${MASTER_SITE_GNOME:=sources/${GNOME_PROJECT}/${GNOME_VERSION:C/^([0-9]+\.[0-9]+).*/\1/}/}
EXTRACT_SUFX?=		.tar.xz
CATEGORIES+=		x11/gnome
.    if ${NO_BUILD:L} == "no"
MODULES+=		textproc/intltool
USE_GMAKE?=		Yes
.    endif
.endif

.if ${CONFIGURE_STYLE:Mgnu} || ${CONFIGURE_STYLE:Msimple}
     # https://mail.gnome.org/archives/desktop-devel-list/2011-September/msg00064.html
.    if !defined(AUTOCONF_VERSION) && !defined(AUTOMAKE_VERSION)
         CONFIGURE_ARGS += --disable-maintainer-mode
.    endif
     # If a port needs extra CPPFLAGS, they can just set MODGNOME_CPPFLAGS
     # to the desired value, like -I${X11BASE}/include
     _MODGNOME_cppflags ?= CPPFLAGS="${MODGNOME_CPPFLAGS} -I${LOCALBASE}/include"
     _MODGNOME_ldflags ?= LDFLAGS="${MODGNOME_LDFLAGS} -L${LOCALBASE}/lib"
     CONFIGURE_ENV += ${_MODGNOME_cppflags} \
                      ${_MODGNOME_ldflags}
.endif

# Use MODGNOME_TOOLS to indicate certain tools are needed for building bindings
# or for ensuring documentation is available. If an option is not set, it's
# explicitly disabled.
# Currently supported tools are:
# * desktop-file-utils: Use this if there are .desktop files under
#                       share/applications/. This also requires the following
#                       go in PLIST:
#                       @@exec %D/bin/update-desktop-database
#                       @@unexec-delete %D/bin/update-desktop-database
# * docbook: Build man pages with docbook.
# * gobject-introspection: Build and enable GObject Introspection data.
# * gtk-update-icon-cache: Enable if there are icon files under share/icons/.
#                          Requires the following goo in PLIST (adapt
#                          $icon-theme accordingly):
#                          @@exec %D/bin/gtk-update-icon-cache -q -t %D/share/icons/$icon-theme
#                          @@unexec-delete %D/bin/gtk-update-icon-cache -q -t %D/share/icons/$icon-theme
# * shared-mime-info: Enable if there are .xml files under share/mime/.
#                     Requires the following goo in PLIST:
#                     @@exec %D/bin/update-mime-database %D/share/mime
#                     @@unexec-delete %D/bin/update-mime-database %D/share/mime
# * vala: Enable vala bindings and/or building from vala source files.
# * yelp: Use this if there are any files under share/gnome/help/
#         or "page" files under share/help/ in the PLIST that are opened
#         with yelp -- gnome-doc-utils is here to make sure we have a
#         dependency on rarian (and legacy scrollkeeper-*) and have
#         access to the gnome-doc-* tools (legacy);
#         same goes with yelp-tools which gives us itstool.

MODGNOME_CONFIGURE_ARGS_gi=--disable-introspection
MODGNOME_CONFIGURE_ARGS_vala=--disable-vala --disable-vala-bindings

.if defined(MODGNOME_TOOLS)
_VALID_TOOLS=desktop-file-utils docbook gobject-introspection \
    gtk-update-icon-cache shared-mime-info vala yelp
.   for _t in ${MODGNOME_TOOLS}
.       if !${_VALID_TOOLS:M${_t}}
ERRORS += "Fatal: unknown MODGNOME_TOOLS option: ${_t}\n(not in ${_VALID_TOOLS})"
.       endif
.   endfor

.   if ${MODGNOME_TOOLS:Mdesktop-file-utils}
        MODGNOME_RUN_DEPENDS+=	devel/desktop-file-utils
        MODGNOME_pre-configure += ln -sf /usr/bin/true ${WRKDIR}/bin/appstream-util;
        MODGNOME_pre-configure += ln -sf /usr/bin/true ${WRKDIR}/bin/desktop-file-validate;
.   endif

.   if ${MODGNOME_TOOLS:Mdocbook}
        MODGNOME_BUILD_DEPENDS+=textproc/docbook-xsl
.   endif

.   if ${MODGNOME_TOOLS:Mgobject-introspection}
        MODGNOME_CONFIGURE_ARGS_gi=--enable-introspection
        MODGNOME_BUILD_DEPENDS+=devel/gobject-introspection
.   endif

.   if ${MODGNOME_TOOLS:Mgtk-update-icon-cache}
        MODGNOME_RUN_DEPENDS+=	x11/gtk+3,-guic
.   endif

.   if ${MODGNOME_TOOLS:Mshared-mime-info}
        MODGNOME_RUN_DEPENDS+=	misc/shared-mime-info
        MODGNOME_pre-configure += ln -sf /usr/bin/true ${WRKDIR}/bin/update-mime-database;
.   endif

.   if ${MODGNOME_TOOLS:Mvala}
        MODGNOME_CONFIGURE_ARGS_vala=--enable-vala --enable-vala-bindings
        MODGNOME_BUILD_DEPENDS+=lang/vala
.   endif

.   if ${MODGNOME_TOOLS:Myelp}
        MODGNOME_BUILD_DEPENDS+=x11/gnome/yelp-tools
        MODGNOME_BUILD_DEPENDS+=x11/gnome/doc-utils
        # automatically try to detect GUI applications
.       if ${MODGNOME_TOOLS:Mdesktop-file-utils}
            MODGNOME_RUN_DEPENDS+=x11/gnome/yelp
.       endif
.   endif
.endif

.if ${CONFIGURE_STYLE:Mgnu} || ${CONFIGURE_STYLE:Msimple}
CONFIGURE_ARGS+=${MODGNOME_CONFIGURE_ARGS_gi} \
		${MODGNOME_CONFIGURE_ARGS_vala}
.endif

.if defined(MODGNOME_BUILD_DEPENDS)
BUILD_DEPENDS+=		${MODGNOME_BUILD_DEPENDS}
.endif

.if defined(MODGNOME_RUN_DEPENDS)
RUN_DEPENDS+=		${MODGNOME_RUN_DEPENDS}
.endif
@


1.99
log
@Create a dummy link to appstream-util; it's only really needed during
development, not during regular builds.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.98 2015/03/27 08:16:16 ajacoutot Exp $
a19 1
     CONFIGURE_ARGS += ${CONFIGURE_SHARED}
@


1.98
log
@x11/gtk+2,-guic -> x11/gtk+3,-guic && bump
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.97 2014/12/21 11:49:48 ajacoutot Exp $
d75 1
@


1.97
log
@Append (instead of prepending) MODGNOME_CPPFLAGS and MODGNOME_LDFLAGS so
we can override /usr/local/{include,lib}
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.96 2014/10/08 12:17:06 ajacoutot Exp $
d88 1
a88 1
        MODGNOME_RUN_DEPENDS+=	x11/gtk+2,-guic
@


1.96
log
@Trailing whitespace.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.95 2014/10/04 08:52:47 ajacoutot Exp $
d27 2
a28 2
     _MODGNOME_cppflags ?= CPPFLAGS="-I${LOCALBASE}/include ${MODGNOME_CPPFLAGS}"
     _MODGNOME_ldflags ?= LDFLAGS="-L${LOCALBASE}/lib ${MODGNOME_LDFLAGS}"
@


1.95
log
@No need for specific versions for now.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.94 2014/09/13 16:29:39 ajacoutot Exp $
d69 1
a69 1
ERRORS += "Fatal: unknown MODGNOME_TOOLS option: ${_t}\n(not in ${_VALID_TOOLS})"        
@


1.94
log
@MODGNOME_TOOLS=gtk-doc is gone now
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.93 2014/09/05 14:45:02 jasper Exp $
d79 1
a79 1
        MODGNOME_BUILD_DEPENDS+=textproc/docbook-xsl>=1.68.1p5
d84 1
a84 1
        MODGNOME_BUILD_DEPENDS+=devel/gobject-introspection>=1.40.0p0
d98 1
a98 1
        MODGNOME_BUILD_DEPENDS+=lang/vala>=0.24.0p0
d102 2
a103 2
        MODGNOME_BUILD_DEPENDS+=x11/gnome/yelp-tools>=3.12.0
        MODGNOME_BUILD_DEPENDS+=x11/gnome/doc-utils>=0.20.10p2
@


1.93
log
@PORTSCOUT -> PORTROACH
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.92 2014/09/03 19:42:16 jasper Exp $
a30 7
     # If one of these tools is found at configure stage, it might be used, no
     # matter whether we use --disable-gtk-doc or not.
.    if !defined(MODGNOME_TOOLS) || defined(MODGNOME_TOOLS) && ! ${MODGNOME_TOOLS:Mgtk-doc}
         CONFIGURE_ENV += ac_cv_path_GTKDOC_CHECK="" \
                          ac_cv_path_GTKDOC_REBASE="" \
                          ac_cv_path_GTKDOC_MKPDF=""
.    endif
a43 1
# * gtk-doc: Enable to build the included docs.
a60 1
MODGNOME_CONFIGURE_ARGS_gtkdoc=--disable-gtk-doc
d65 1
a65 1
_VALID_TOOLS=desktop-file-utils docbook gobject-introspection gtk-doc \
a86 5
.   if ${MODGNOME_TOOLS:Mgtk-doc}
        MODGNOME_CONFIGURE_ARGS_gtkdoc=--enable-gtk-doc
        MODGNOME_BUILD_DEPENDS+=textproc/gtk-doc>=1.20p0
.   endif

a112 1
		${MODGNOME_CONFIGURE_ARGS_gtkdoc} \
@


1.92
log
@use += to set PORTSCOUT so consumers of this module can append their own
stuffs to it

as discussed with aja@@
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.91 2014/09/03 09:53:55 ajacoutot Exp $
d6 1
a6 1
PORTSCOUT+=		limitw:1,even
@


1.91
log
@Consistency.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.90 2014/09/02 15:16:26 ajacoutot Exp $
d6 1
a6 1
PORTSCOUT=		limitw:1,even
@


1.90
log
@Move PORTSCOUT at the top.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.89 2014/09/02 14:39:37 jasper Exp $
d6 1
a6 1
PORTSCOUT =		limitw:1,even
@


1.89
log
@move PORTSCOUT to gnome.port.mk so all gnome ports can use it
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.88 2014/07/09 17:45:51 ajacoutot Exp $
d6 1
a11 1
PORTSCOUT =		limitw:1,even
@


1.88
log
@Only set USE_GMAKE for GNOME_PROJECT ports.
This makes the gnome MODULE generic enough for other ports to use it for
fd.o stuffs (desktop-file-utils, gtk-update-icon-cache, ...).
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.87 2014/07/09 17:05:34 ajacoutot Exp $
d11 1
@


1.87
log
@Move USE_GMAKE to !NO_BUILD.
Only add CONFIGURE_ARGS when CONFIGURE_STYLE is gnu or simple.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.86 2014/07/09 13:55:19 ajacoutot Exp $
d14 1
a15 4
.endif

.if ${NO_BUILD:L} == "no"
USE_GMAKE?=		Yes
@


1.86
log
@Only add the textproc/intltool to MODULES for GNOME_PROJECT ports.

discussed with jasper@@ and landry@@
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.85 2014/04/08 17:25:35 ajacoutot Exp $
d18 1
a18 20
.   if defined(CONFIGURE_STYLE) && ${CONFIGURE_STYLE:Mgnu}
        CONFIGURE_ARGS += ${CONFIGURE_SHARED}
      # https://mail.gnome.org/archives/desktop-devel-list/2011-September/msg00064.html
.     if !defined(AUTOCONF_VERSION) && !defined(AUTOMAKE_VERSION)
          CONFIGURE_ARGS += --disable-maintainer-mode
.     endif
        # If a port needs extra CPPFLAGS, they can just set MODGNOME_CPPFLAGS
        # to the desired value, like -I${X11BASE}/include
        _MODGNOME_cppflags ?= CPPFLAGS="-I${LOCALBASE}/include ${MODGNOME_CPPFLAGS}"
        _MODGNOME_ldflags ?= LDFLAGS="-L${LOCALBASE}/lib ${MODGNOME_LDFLAGS}"
        CONFIGURE_ENV += ${_MODGNOME_cppflags} \
                         ${_MODGNOME_ldflags}
        # If one of these tools is found at configure stage, it might be used, no
        # matter whether we use --disable-gtk-doc or not.
.       if !defined(MODGNOME_TOOLS) || defined(MODGNOME_TOOLS) && ! ${MODGNOME_TOOLS:Mgtk-doc}
            CONFIGURE_ENV += ac_cv_path_GTKDOC_CHECK="" \
                             ac_cv_path_GTKDOC_REBASE="" \
                             ac_cv_path_GTKDOC_MKPDF=""
.       endif
.   endif
d21 20
a40 1
USE_GMAKE?=		Yes
d127 1
d131 1
@


1.85
log
@Bump go-i.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.84 2014/04/03 12:18:19 jasper Exp $
d12 3
a17 1
MODULES+=		textproc/intltool
@


1.84
log
@since MODGNOME_TOOLS takes more (and longer) arguments now, validate the input
adapted from bsd.port.mk's handling for 'clean='

ok aja@@
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.83 2014/04/01 17:03:14 jasper Exp $
d93 1
a93 1
        MODGNOME_BUILD_DEPENDS+=devel/gobject-introspection>=1.40.0
@


1.83
log
@move more bits and bobs into MODGNOME_TOOLS to make it more clear which
tools are actually used.

This commit replaces
MODGNOME_DESKTOP_FILE with MODGNOME_TOOLS += desktop-file-utils
MODGNOME_MIME_FILE with MODGNOME_TOOLS += shared-mime-info
MODGNOME_ICON_CACHE with MODGNOME_TOOLS += gtk-update-icon-cache

(some prettyfication will follow shortly)
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.81 2014/03/30 14:43:24 ajacoutot Exp $
d74 8
@


1.82
log
@start to make MODGNOME_TOOLS resemble the name of the tools actually used.
rename 'gi' to 'gobject-introspection'.

discussed with aja@@
@
text
@a37 26
# Set to 'yes' if there are .desktop files under share/applications/.
# Requires the following goo in PLIST:
# @@exec %D/bin/update-desktop-database
# @@unexec-delete %D/bin/update-desktop-database
.if defined(MODGNOME_DESKTOP_FILE) && ${MODGNOME_DESKTOP_FILE:L} == "yes"
MODGNOME_RUN_DEPENDS+=	devel/desktop-file-utils
MODGNOME_pre-configure += ln -sf /usr/bin/true ${WRKDIR}/bin/desktop-file-validate;
.endif

# Set to 'yes' if there are icon files under share/icons/.
# Requires the following goo in PLIST (adapt $icon-theme accordingly):
# @@exec %D/bin/gtk-update-icon-cache -q -t %D/share/icons/$icon-theme
# @@unexec-delete %D/bin/gtk-update-icon-cache -q -t %D/share/icons/$icon-theme
.if defined(MODGNOME_ICON_CACHE) && ${MODGNOME_ICON_CACHE:L} == "yes"
MODGNOME_RUN_DEPENDS+=	x11/gtk+2,-guic
.endif

# Set to 'yes' if there are .xml files under share/mime/.
# Requires the following goo in PLIST:
# @@exec %D/bin/update-mime-database %D/share/mime
# @@unexec-delete %D/bin/update-mime-database %D/share/mime
.if defined(MODGNOME_MIME_FILE) && ${MODGNOME_MIME_FILE:L} == "yes"
MODGNOME_RUN_DEPENDS+=	misc/shared-mime-info
MODGNOME_pre-configure += ln -sf /usr/bin/true ${WRKDIR}/bin/update-mime-database;
.endif

d44 5
d52 9
d74 5
d90 10
a99 1
[A        MODGNOME_BUILD_DEPENDS+=textproc/gtk-doc>=1.20p0
d111 1
a111 1
.       if defined(MODGNOME_DESKTOP_FILE) && ${MODGNOME_DESKTOP_FILE:L} == "yes"
@


1.81
log
@Bump vala requirements.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.80 2014/03/28 08:48:14 ajacoutot Exp $
d71 1
a71 1
# * gi: Build and enable GObject Introspection data.
d90 1
a90 1
.   if ${MODGNOME_TOOLS:Mgi}
d97 1
a97 1
        MODGNOME_BUILD_DEPENDS+=textproc/gtk-doc>=1.20p0
@


1.80
log
@Add a new option to MODGNOME_TOOLS: docbook.
This is used when man pages require textproc/docbook-xsl.

ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.79 2014/03/26 16:09:06 ajacoutot Exp $
d102 1
a102 1
        MODGNOME_BUILD_DEPENDS+=lang/vala>=0.24.0
@


1.79
log
@Bump requirements.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.78 2014/03/25 11:37:47 ajacoutot Exp $
d70 1
a79 2
# Please note that if you're using multi-packages, you have to use the
# MODGNOME_RUN_DEPENDS_${tool} in your multi package RUN_DEPENDS.
d86 4
@


1.78
log
@Tweak comment; no functionality change.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.77 2014/03/25 09:39:17 ajacoutot Exp $
d89 1
a89 1
        MODGNOME_BUILD_DEPENDS+=devel/gobject-introspection>=1.38.0
d94 1
a94 1
        MODGNOME_BUILD_DEPENDS+=textproc/gtk-doc
d103 1
a103 1
        MODGNOME_BUILD_DEPENDS+=x11/gnome/yelp-tools
@


1.77
log
@Bump requirements.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.76 2014/03/16 09:11:23 ajacoutot Exp $
d72 1
a72 1
# * vala: Enable vala bindings.
@


1.76
log
@Do not blindly add a RUN_DEPENDS on yelp whenever we install help files
but instead, check wether MODGNOME_DESKTOP_FILE is also defined; if so
we can assume a GUI application and keep the RUN_DEPENDS.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.75 2013/11/17 09:41:00 ajacoutot Exp $
d99 1
a99 1
        MODGNOME_BUILD_DEPENDS+=lang/vala>=0.22.1
d104 1
a104 1
        MODGNOME_BUILD_DEPENDS+=x11/gnome/doc-utils>=0.20.10p1
@


1.75
log
@Bump vala requirements.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.74 2013/10/16 10:28:25 ajacoutot Exp $
d105 4
a108 1
        MODGNOME_RUN_DEPENDS+=x11/gnome/yelp
@


1.74
log
@No need for MODGNOME_RUN_DEPENDS_yelp anymore.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.73 2013/10/16 10:11:25 sthen Exp $
d99 1
a99 1
        MODGNOME_BUILD_DEPENDS+=lang/vala>=0.22.0
@


1.73
log
@unbreak ports using both of MODGNOME_MIME_FILE and MODGNOME_DESKTOP_FILE,
ok aja@@
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.72 2013/10/15 09:55:30 ajacoutot Exp $
d105 1
a105 3
        _yelp_depend=x11/gnome/yelp
        MODGNOME_RUN_DEPENDS+=${_yelp_depend}
        MODGNOME_RUN_DEPENDS_yelp=${_yelp_depend}
@


1.72
log
@Add sample goos.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.71 2013/10/15 09:43:08 ajacoutot Exp $
d44 1
a44 1
MODGNOME_pre-configure += ln -sf /usr/bin/true ${WRKDIR}/bin/desktop-file-validate
d61 1
a61 1
MODGNOME_pre-configure += ln -sf /usr/bin/true ${WRKDIR}/bin/update-mime-database
@


1.71
log
@Add a new var: MODGNOME_MIME_FILE -- used to declare a dependency on
shared-mime-info.
Add a small hack so that we do not need to BDEP on shared-mime-info and
that we do not need to pass --disable-update-mimedb and alikes.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.70 2013/10/15 09:20:49 ajacoutot Exp $
d39 3
d48 3
d56 3
@


1.70
log
@Add a small hack so that ports that need desktop-file-validate at build
time don't need to BDEP on desktop-file-utils.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.69 2013/09/28 08:47:58 ajacoutot Exp $
d47 6
@


1.69
log
@Set HOMEPAGE within the x11/gnome MODULE for GNOME_PROJECT ports
instead of Makefile.inc.
discussed with jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.68 2013/09/26 07:50:43 ajacoutot Exp $
d41 1
@


1.68
log
@Bump MODGNOME_BUILD_DEPENDS requirements.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.67 2013/04/16 13:16:30 ajacoutot Exp $
d8 1
@


1.67
log
@goi -> gi as this is the generic name gobject-introspection is usually
refered to.

ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.66 2013/03/29 16:35:44 ajacoutot Exp $
d72 1
a72 1
        MODGNOME_BUILD_DEPENDS+=devel/gobject-introspection>=1.36.0
d82 1
a82 1
        MODGNOME_BUILD_DEPENDS+=lang/vala>=0.20.0
d87 1
a87 1
        MODGNOME_BUILD_DEPENDS+=x11/gnome/doc-utils>=0.20.10p0
@


1.66
log
@Bump BUILD_DEPENDS versions.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.65 2013/03/26 16:28:22 ajacoutot Exp $
d53 1
a53 1
# * goi:  Build and enable GObject Introspection data.
d66 1
a66 1
MODGNOME_CONFIGURE_ARGS_goi=--disable-introspection
d70 2
a71 2
.   if ${MODGNOME_TOOLS:Mgoi}
        MODGNOME_CONFIGURE_ARGS_goi=--enable-introspection
d94 1
a94 1
CONFIGURE_ARGS+=${MODGNOME_CONFIGURE_ARGS_goi} \
@


1.65
log
@If none of AUTOCONF_VERSION or AUTOMAKE_VERSION is defined, then pass
--disable-maintainer-mode
to the configure args.

ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.64 2013/03/21 08:48:56 ajacoutot Exp $
d72 1
a72 1
        MODGNOME_BUILD_DEPENDS+=devel/gobject-introspection>=1.34.0
d82 1
a82 1
        MODGNOME_BUILD_DEPENDS+=lang/vala>=0.18.0
d87 1
a87 1
        MODGNOME_BUILD_DEPENDS+=x11/gnome/doc-utils
@


1.64
log
@USE_LIBTOOL=Yes is the default now.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.63 2012/09/27 14:14:31 ajacoutot Exp $
d17 4
@


1.63
log
@Bump g-o-i and vala versions.
Add a dependency on yelp-tools instead of itstool (itstool is a dependency
of yelp-tools); this is a convient dependency so that we can build
the GNOME documentation for the new and legacy infrastructure whatever
configure style we set.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.62 2012/09/11 09:28:56 ajacoutot Exp $
a13 1
USE_LIBTOOL?=		Yes
@


1.62
log
@Remove the DATADIRNAME hack now that we know exactly which ports need
patching and upstream notice.

tested in a bulk by and ok jasper@@ (thanks!)
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.61 2012/09/01 16:16:33 ajacoutot Exp $
d57 2
a58 2
#         access to the gnome-doc-* tools (not always needed but easier);
#         same goes with itstool.
d69 1
a69 1
        MODGNOME_BUILD_DEPENDS+=devel/gobject-introspection>=1.32.0
d79 1
a79 1
        MODGNOME_BUILD_DEPENDS+=lang/vala>=0.17.5
d83 2
a84 2
        MODGNOME_BUILD_DEPENDS+=textproc/itstool
        MODGNOME_BUILD_DEPENDS+=x11/gnome/doc-utils>=0.20.10
@


1.61
log
@Bump vala version.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.60 2012/03/29 16:34:43 ajacoutot Exp $
a23 4
        # Older versions of glib-gettext.m4 used to set DATADIRNAME to
        # "lib" which resulted in locale files being installed under the
        # wrong directory.
        CONFIGURE_ENV += DATADIRNAME=share
@


1.60
log
@If gtk-doc is installed at configure stage but get removed after, the
build will fail because gtkdoc-rebase will fail to run.
--disable-gtk-doc has no effect on this behaviour so force setting
ac_cv_path_* in CONFIGURE_ENV.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.59 2012/03/29 07:45:55 ajacoutot Exp $
d83 1
a83 1
        MODGNOME_BUILD_DEPENDS+=lang/vala>=0.16.0
@


1.59
log
@Bump gobject-introspection requirements.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.58 2012/03/29 07:23:46 ajacoutot Exp $
a3 1
#
d28 7
@


1.58
log
@Bump doc-utils and vala versions.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.57 2012/03/06 12:45:13 ajacoutot Exp $
d67 1
a67 1
        MODGNOME_BUILD_DEPENDS+=devel/gobject-introspection
@


1.57
log
@Bump doc-utils version.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.56 2012/02/26 15:09:43 ajacoutot Exp $
d77 1
a77 1
        MODGNOME_BUILD_DEPENDS+=lang/vala>=0.15.2
d82 1
a82 1
        MODGNOME_BUILD_DEPENDS+=x11/gnome/doc-utils>=0.20.7
@


1.56
log
@Bump vala requirements to vala>=0.15.2.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.55 2012/02/18 18:19:14 ajacoutot Exp $
d82 1
a82 1
        MODGNOME_BUILD_DEPENDS+=x11/gnome/doc-utils
@


1.55
log
@Add "--disable-vala-bindings" to the default MODGNOME_CONFIGURE_ARGS_vala.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.54 2012/02/16 22:21:54 ajacoutot Exp $
d77 1
a77 1
        MODGNOME_BUILD_DEPENDS+=lang/vala
@


1.54
log
@Extend comment about yelp.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.53 2011/12/12 15:39:57 jasper Exp $
d62 1
a62 1
MODGNOME_CONFIGURE_ARGS_vala=--disable-vala
@


1.53
log
@spacing
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.52 2011/12/03 18:32:06 ajacoutot Exp $
d52 5
a56 5
#         in the pkg list and it calls gnome_help_display() -- gnome-doc-utils
#         is here to make sure we have a dependency on rarian (scrollkeeper-*)
#         and have access to the gnome-doc-* tools (not always needed but
#         easier); same goes with itstool.
#
@


1.52
log
@Add MODGNOME_ICON_CACHE for gtk+2,-guic.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.51 2011/10/03 06:41:43 ajacoutot Exp $
d48 1
a48 1
# * goi: Build and enable GObject Introspection data.
d52 4
a55 4
#   in the pkg list and it calls gnome_help_display() -- gnome-doc-utils is
#   here to make sure we have a dependency on rarian (scrollkeeper-*) and
#   have access to the gnome-doc-* tools (not always needed but easier);
#   same goes with itstool.
@


1.51
log
@Set DATADIRNAME in CONFIGURE_ENV instead of using FAKE_FLAGS to install
gettext mo files in the proper location.

ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.50 2011/09/28 15:07:57 jasper Exp $
d32 1
a32 1
# Set to 'yes' if there are .desktop files in the package list.
d35 5
@


1.50
log
@when using MODGNOME_TOOLS=vala, also set --enable-vala-bindings.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.49 2011/09/28 09:46:57 jasper Exp $
d25 4
a37 2

FAKE_FLAGS +=	itlocaledir="${PREFIX}/share/locale/"
@


1.49
log
@since most ports using gnome.port.mk append to CONFIGURE_ENV to search in
${LOCALBASE}/{include,lib}, move that into the module itself so it has sane
defaults. if a port needs to change CPPFLAGS/LDFLAGS, one can set
MODGNOME_{CPP,LD}FLAGS.

discussed with and ok aja@@, probably over some Lasko (or was it Union?)
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.48 2011/09/27 11:37:52 ajacoutot Exp $
d69 1
a69 1
        MODGNOME_CONFIGURE_ARGS_vala=--enable-vala
@


1.48
log
@Add a BUILD_DEPENDS on textproc/itstool in the MODGNOME_TOOLS "yelp"
case. This is likely to become needed more and more (itstool is the
successor to xml2po).

ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.47 2011/09/20 20:59:25 ajacoutot Exp $
d18 7
a24 1
        CONFIGURE_ARGS+=${CONFIGURE_SHARED}
@


1.47
log
@Typo in comment.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.46 2011/09/20 20:50:33 jasper Exp $
d41 2
a42 1
#   have access to the gnome-doc-* tools (not always needed but easier).
d68 1
@


1.46
log
@overhaul the way gnome ports pull in gobject-introspection, gtk-doc, vala and
yelp. they can be used by setting MODGNOME_TOOLS to pull in the dependencies
and setting the configure arguments.

discussed with an ok aja@@

oh, and *cheeese*
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.45 2011/09/19 09:07:24 jasper Exp $
d39 1
a39 1
#   in the pkg list and it calls gnome_help_display() -- gnome-doc-utils [Ais
@


1.45
log
@revert previous for now
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.44 2011/09/19 08:47:20 jasper Exp $
d17 3
a26 6
# XXX: Move to MODGNOME_TOOLS=yelp Only here for 5-day plan backward compat.
.if defined(MODGNOME_HELP_FILES) && ${MODGNOME_HELP_FILES:L} == "yes"
MODGNOME_BUILD_DEPENDS+=x11/gnome/doc-utils
MODGNOME_RUN_DEPENDS+= x11/gnome/yelp
.endif

d52 1
a52 1
        MODGOME_CONFIGURE_ARGS_goi+=--enable-introspection
d57 1
a57 1
        MODGNOME_CONFIGURE_ARGS_gtkdoc+=--enable-gtk-doc
d62 1
a62 1
        MODGNOME_CONFIGURE_ARGS_vala+=--enable-vala
d74 3
a76 3
#CONFIGURE_ARGS+=${MODGNOME_CONFIGURE_ARGS_goi} \
#		${MODGNOME_CONFIGURE_ARGS_gtkdoc} \
#		${MODGNOME_CONFIGURE_ARGS_vala}
@


1.44
log
@if MODGNOME_TOOLS isn't set, we still need a way to disable stuff, so build
CONFIGURE_ARGS out of MODGNOME_CONFIGURE_ARGS* later.

discussed with aja@@
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.43 2011/09/19 07:55:43 jasper Exp $
d77 3
a79 3
CONFIGURE_ARGS+=${MODGNOME_CONFIGURE_ARGS_goi} \
		${MODGNOME_CONFIGURE_ARGS_gtkdoc} \
		${MODGNOME_CONFIGURE_ARGS_vala}
@


1.43
log
@- add MODGNOME_TOOLS to indicate certain tools are needed for building bindings
or for ensuring the docs are available. currently supported are
gobject-introspection, gtk-doc, vala and yelp.

untill ports are moved to MODGNOME_TOOLS this won't interfere with
MODGNOME_HELP_FILES.

discussed with and ok aja@@
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.42 2011/09/19 07:44:58 ajacoutot Exp $
d38 1
a38 1
# * gobject-introspection: Build and enable GObject Introspection data.
d49 4
d54 2
a55 2
.   if ${MODGNOME_TOOLS:Mgobject-introspection}
        CONFIGURE_ARGS+=--enable-introspection
a56 2
.   else
        CONFIGURE_ARGS+=--disable-introspection
d60 1
a60 1
        CONFIGURE_ARGS+=--enable-gtk-doc
a61 2
.   else
        CONFIGURE_ARGS+=--disable-gtk-doc
d65 1
a65 1
        CONFIGURE_ARGS+=--enable-vala
a66 2
.   else
        CONFIGURE_ARGS+=--disable-vala
d71 1
a71 1
	_yelp_depend=x11/gnome/yelp
d76 4
@


1.42
log
@DESKTOP_FILES => MODGNOME_DESKTOP_FILE, like it should always have been.

discussed with and ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.41 2011/09/12 12:02:39 jasper Exp $
d24 1
a24 4
# Set to 'yes' if there are .xml GNOME help files under share/gnome/help/
# in the pkg list and it calls gnome_help_display() -- gnome-doc-utils is
# here to make sure we have a dependency on rarian (scrollkeeper-*) and
# have access to the gnome-doc-* tools (not always needed but easier).
d27 50
a76 1
MODGNOME_RUN_DEPENDS+=	x11/gnome/yelp
a85 4

USE_GMAKE?=		Yes

FAKE_FLAGS +=	itlocaledir="${PREFIX}/share/locale/"
@


1.41
log
@- switch to .tar.xz as the default EXTRACT_SUFX.

most new distfiles on gnome master sites have been using this for a while now, and
soon no new .tar.bz2/tar.gz distfiles are allowed anymore upstream

as discussed with aja@@
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.40 2011/06/02 17:20:33 ajacoutot Exp $
d20 1
a20 1
.if defined(DESKTOP_FILES) && ${DESKTOP_FILES:L} == "yes"
@


1.40
log
@--disable-silent-rules is now added to CONFIGURE_ARGS per default,
if CONFIGURE_STYLE = gnu
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.39 2011/05/17 13:48:18 ajacoutot Exp $
d10 1
a10 1
EXTRACT_SUFX?=		.tar.bz2
@


1.39
log
@Remove gnome3 hack, this won't be needed anymore.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.38 2011/05/13 21:10:49 ajacoutot Exp $
a43 7

# Disable "silent rules" aka clean build output (CC $FILE)
.if defined(CONFIGURE_STYLE)
. if ${CONFIGURE_STYLE:L:Mgnu} || ${CONFIGURE_STYLE:L:Mautoconf}
  CONFIGURE_ARGS+=	--disable-silent-rules
. endif
.endif
@


1.38
log
@Add a hack for x11/gnome3 ports.

idea from and ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.37 2011/05/11 14:56:42 ajacoutot Exp $
d29 1
a29 4
MODGNOME_BUILD_DEPENDS+= x11/gnome/doc-utils
.  if ${PKGPATH:Mx11/gnome3/*}
MODGNOME_RUN_DEPENDS+=	x11/gnome3/yelp
.  else
a30 1
.  endif
@


1.37
log
@Explain the dependencies in MODGNOME_HELP_FILES a bit more.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.36 2011/05/11 12:50:20 ajacoutot Exp $
d30 3
d34 1
@


1.36
log
@Extend comment.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.35 2011/04/26 12:50:54 ajacoutot Exp $
d24 4
a27 3
# Set to 'yes' if there are .xml GNOME help files under
# share/gnome/help/ in the package list.
# gnome-doc-utils is needed for rarian/scrollkeeper and gnome-doc-*.
@


1.35
log
@Set itlocaledir in FAKE_FLAGS.

ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.34 2010/11/22 08:36:56 espie Exp $
d26 1
@


1.34
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.33 2010/10/24 21:12:47 ajacoutot Exp $
d40 2
@


1.33
log
@No need for this USE_X11 hack anymore.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.32 2010/10/23 16:31:29 ajacoutot Exp $
d21 1
a21 1
MODGNOME_RUN_DEPENDS+=	:desktop-file-utils-*:devel/desktop-file-utils
d27 2
a28 2
MODGNOME_BUILD_DEPENDS+= ::x11/gnome/doc-utils
MODGNOME_RUN_DEPENDS+=	:yelp-*:x11/gnome/yelp
@


1.32
log
@Don't enforce MASTER_SITES either.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.31 2010/10/23 15:26:27 ajacoutot Exp $
a45 5
.endif

# XXX not 100% reliable
.if defined(WANTLIB) && ${WANTLIB:MX11}
USE_X11=	Yes
@


1.31
log
@Don't force EXTRACT_SUFX.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.30 2010/10/23 14:37:17 ajacoutot Exp $
d9 1
a9 1
MASTER_SITES=		${MASTER_SITE_GNOME:=sources/${GNOME_PROJECT}/${GNOME_VERSION:C/^([0-9]+\.[0-9]+).*/\1/}/}
@


1.30
log
@Do not enforce the need to set GNOME_PROJECT and GNOME_VERSION so that
we can use the x11/gnome MODULE with ports that are not directly part
of GNOME per se. This made landry's kitty sad...

ok landry@@ jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.29 2010/10/19 22:49:35 espie Exp $
d10 1
a10 1
EXTRACT_SUFX=		.tar.bz2
@


1.29
log
@unbreak the tree
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.28 2010/10/19 15:20:36 ajacoutot Exp $
d6 6
a11 2
.if !defined(GNOME_PROJECT) || !defined(GNOME_VERSION)
ERRORS+=	"Fatal: using GNOME module, but missing GNOME_PROJECT and/or GNOME_VERSION"
a13 4
CATEGORIES+=		x11/gnome
DISTNAME=		${GNOME_PROJECT}-${GNOME_VERSION}
VERSION?=		${GNOME_VERSION}

a37 3

MASTER_SITES?=		${MASTER_SITE_GNOME:=sources/${GNOME_PROJECT}/${GNOME_VERSION:C/^([0-9]+\.[0-9]+).*/\1/}/}
EXTRACT_SUFX?=		.tar.bz2
@


1.28
log
@Use a different construct for USE_X11 so that it actually does what it
was meant for.

ok landry@@ jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.27 2010/10/18 13:17:24 jasper Exp $
d52 1
a52 1
.if ${WANTLIB:MX11}
@


1.27
log
@- set USE_X11 to Yes by default

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.26 2010/04/22 23:19:13 ajacoutot Exp $
d51 4
a54 1
USE_X11?=		Yes
@


1.26
log
@Remove --disable-shave from CONFIGURE_ARGS, only a handful applications use
it.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.25 2009/11/16 08:39:28 ajacoutot Exp $
d50 2
@


1.25
log
@Fix CONFIGURE_STYLE conditionnal.

thanks to bernd@@ for refreshing my goldfish memory on pattern matching.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.24 2009/10/21 16:08:31 ajacoutot Exp $
d44 1
a44 1
# Disable "silent rules" and "shave" aka clean build output (CC $FILE)
a47 1
  CONFIGURE_ARGS+=	--disable-shave
@


1.24
log
@--disable-silent-rules is not enough, we also want --disable-shave

ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.23 2009/10/10 12:38:33 jasper Exp $
d46 1
a46 1
. if ${CONFIGURE_STYLE:L} == "gnu" || ${CONFIGURE_STYLE:L} == "autoconf"
@


1.23
log
@add --disable-silent-rules to CONFIGURE_ARGS so we can see what
is actually being done, instead of CC $FILE and LD $FILE

"p-p-p-perfect" aja@@
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.22 2009/10/09 16:05:51 steven Exp $
d44 1
a44 1
# Disable "silent rules" aka clean build output (CC $FILE)
d48 1
@


1.22
log
@error out when using gnome module, but GNOME_PROJECT/GNOME_VERSION
variables are not set

ok jasper
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.20 2008/11/23 22:56:37 jasper Exp $
d43 7
@


1.21
log
@Rework the way we handle build_depends with the gnome MODULE when
MODGNOME_HELP_FILES is set to yes.

* add a build_depends on gnome-doc-utils if MODGNOME_HELP_FILES is set
to yes
* add rarian as a run_depends for gnome-doc-utils (will help with older
ports that will never be updated from using deprecated scrollkeeper)
* remove build+run_depends on gnome-doc-utils and rarian for ports that
have MODGNOME_HELP_FILES as they are now implied.
* bump where needed

This should help in having all required build dependencies for
gnome-related ports and it greatly simplifies things.

"thanks for cleaning this mess" and ok jasper@@
@
text
@d6 4
a10 1

d12 1
a12 1
VERSION=		${GNOME_VERSION}
@


1.20
log
@- use a better way to figure out the MASTER_SITES, so no overridings should
be needed anymore if a file is on ftp.gnome.org

no chickens were injured or eaten whilst working on this, although "someone"
is begging to differ
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.19 2008/11/23 12:16:03 jasper Exp $
d24 1
d26 4
@


1.19
log
@- remove a part that's never going to be used in this form,
if we're going to set the schema's file path via a module, it'll be done
via a gconf2 module

discussed with ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.18 2008/06/02 14:10:07 ajacoutot Exp $
d31 1
a31 1
MASTER_SITES?=		${MASTER_SITE_GNOME:=sources/${GNOME_PROJECT}/${GNOME_VERSION:R}/}
@


1.18
log
@- remove support for MODGNOME_DEVHELP_FILES from the gnome MODULE ;
it makes more sense to add devhelp as run_depends for gnome-session and
leave it to the user to install it manually for other packages

"if you're as happy as a pig in poop, commit it" jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.17 2008/05/26 13:23:34 ajacoutot Exp $
a34 6

#ifdef notyet
#CONFIGURE_ARGS+=	--with-gconf-schema-file-dir=${LOCALBASE}/share/schemas/${PROJECT}/
#			--disable-schemas-install \
#			--disable-scrollkeeper
#endif
@


1.17
log
@- clarify comment concerning GNOME help files
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.16 2008/04/15 11:51:23 jasper Exp $
a18 5
.endif

# Set to 'yes' if there are .devhelp files in the package list.
.if defined(MODGNOME_DEVHELP_FILES) && ${MODGNOME_DEVHELP_FILES:L} == "yes"
MODGNOME_RUN_DEPENDS+=	:devhelp-*:x11/gnome/devhelp
@


1.16
log
@- add MODGNOME_HELP_FILES for run-time dependency on x11/gnome/yelp
- add MODGNOME_DEVHELP_FILES for run-time dependency on x11/gnome/devhelp

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.15 2007/12/27 20:45:54 jasper Exp $
d26 2
a27 1
# Set to 'yes' if there are GNOME help files in the package list.
@


1.15
log
@- switch to use the intltool module

prodded by ajacoutot@@ some time ago after an extreme late breakfast...
tested by steven@@ in a bulk build
@
text
@d1 2
a2 1
# $OpenBSD: gnome.port.mk,v 1.14 2007/07/03 08:50:36 jasper Exp $
d4 1
d16 14
a29 2
.if defined(DESKTOP_FILES)
MODGNOME_RUN_DEPENDS=	:desktop-file-utils-*:devel/desktop-file-utils
d31 1
@


1.14
log
@only use desktop-file-utils if DESKTOP_FILES is set.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.13 2007/06/30 12:14:14 jasper Exp $
d11 1
a11 2
BUILD_DEPENDS+=	 	:intltool-*:textproc/intltool \
			:p5-XML-Parser-*:textproc/p5-XML-Parser
@


1.13
log
@fix test condition, thanks to martynas@@
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.12 2007/06/30 11:39:46 jasper Exp $
d15 1
d19 1
@


1.12
log
@when NO_BUILD is defined, don't set BUILD_DEPENDS or bother pulling in libtool.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.11 2007/06/29 21:49:04 jasper Exp $
d9 1
a9 1
.if !defined(NO_BUILD)
@


1.11
log
@sigh...really remove use_x11
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.10 2007/06/29 19:36:43 jasper Exp $
d9 1
d11 3
a16 2
BUILD_DEPENDS+=	 	:intltool-*:textproc/intltool \
			:p5-XML-Parser-*:textproc/p5-XML-Parser	
@


1.10
log
@oops, this is better.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.9 2007/06/29 19:35:00 jasper Exp $
a9 1
USE_X11?=		Yes
@


1.9
log
@only set MASTER_SITES, if it's not already defined.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.8 2007/06/29 19:28:06 jasper Exp $
d10 1
a10 1
USE_X11=		Yes
d25 1
a25 1
#			--disable-schemas-install \ 
a26 1
# schema-install en scrollkeeper eerst "invoeren", later gconf-schema gebruiken
@


1.8
log
@remove USE_X11 from here, stuff like gnome-backgrounds doesn't use X11, but it does use this module..
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.7 2007/06/29 19:23:34 jasper Exp $
d10 1
d18 1
a18 1
MASTER_SITES=		${MASTER_SITE_GNOME:=sources/${GNOME_PROJECT}/${GNOME_VERSION:R}/}
d25 1
a25 1
#			--disable-schemas-install \
d27 1
@


1.7
log
@add a plain ${VERSION} variable, aids the conversion
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.6 2007/06/01 17:29:09 jasper Exp $
a9 1
USE_X11=		Yes
@


1.6
log
@cleaner way to create MASTER_SITES
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.5 2007/05/31 12:49:08 jasper Exp $
d7 1
@


1.5
log
@trying to set CONFIGURE_ENV in these files is not a good idea..
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.4 2007/05/31 12:18:47 jasper Exp $
a6 1
V=			${GNOME_VERSION:C/:*.[0-9]*$//}
d17 1
a17 1
MASTER_SITES=		${MASTER_SITE_GNOME:=sources/${GNOME_PROJECT}/${V}/}
@


1.4
log
@if the last segment of GNOME_VERSION has two digits, also strip the
"remaining" dot.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.3 2007/05/31 12:07:22 jasper Exp $
a19 3

MODGNOME_CONFIGURE_ENV=	CPPFLAGS="-I${LOCALBASE}/include -I${X11BASE}/include" \
			LDFLAGS="-L${LOCALBASE}/lib"
@


1.3
log
@add USE_GMAKE
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.2 2007/05/31 11:30:35 jasper Exp $
d7 1
a7 1
V=			${GNOME_VERSION:C/:*.[0-9]$//}
@


1.2
log
@construct MASTER_SITES based on GNOME_PROJECT and GNOME_VERSION
Both should be set in a port's Makefile.
@
text
@d1 1
a1 1
# $OpenBSD: gnome.port.mk,v 1.1 2007/05/30 09:19:02 jasper Exp $
d23 2
@


1.1
log
@add an x11/gnome module and Makefile.inc

please don't use gnome.port.mk yet, it's bound to change heavily

feedback and ok espie@@
@
text
@d1 1
a1 1
# $OpenBSD$
d6 3
d18 1
@

