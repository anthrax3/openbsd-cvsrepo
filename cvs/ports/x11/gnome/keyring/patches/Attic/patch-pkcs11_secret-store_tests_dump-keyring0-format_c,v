head	1.8;
access;
symbols
	OPENBSD_5_4:1.3.0.2
	OPENBSD_5_4_BASE:1.3
	OPENBSD_5_3:1.2.0.2
	OPENBSD_5_3_BASE:1.2
	OPENBSD_5_2:1.1.0.2
	OPENBSD_5_2_BASE:1.1;
locks; strict;
comment	@# @;


1.8
date	2013.10.17.07.37.45;	author ajacoutot;	state dead;
branches;
next	1.7;

1.7
date	2013.10.10.15.21.32;	author ajacoutot;	state Exp;
branches;
next	1.6;

1.6
date	2013.08.20.14.55.41;	author ajacoutot;	state Exp;
branches;
next	1.5;

1.5
date	2013.08.15.16.07.27;	author ajacoutot;	state Exp;
branches;
next	1.4;

1.4
date	2013.08.15.14.52.22;	author ajacoutot;	state dead;
branches;
next	1.3;

1.3
date	2013.03.29.09.48.08;	author ajacoutot;	state Exp;
branches;
next	1.2;

1.2
date	2012.10.18.12.55.05;	author ajacoutot;	state Exp;
branches;
next	1.1;

1.1
date	2012.03.29.06.51.38;	author ajacoutot;	state Exp;
branches;
next	;


desc
@@


1.8
log
@Update to gnome-keyring-3.10.1.
@
text
@$OpenBSD: patch-pkcs11_secret-store_tests_dump-keyring0-format_c,v 1.7 2013/10/10 15:21:32 ajacoutot Exp $

From 0a82e3357c9fd17479d2a614dc64594b3349d138 Mon Sep 17 00:00:00 2001
From: Antoine Jacoutot <ajacoutot@@gnome.org>
Date: Tue, 20 Aug 2013 14:50:03 +0000
Subject: buffer_get_time: use time_t as last argument

--- pkcs11/secret-store/tests/dump-keyring0-format.c.orig	Tue Aug 20 15:24:26 2013
+++ pkcs11/secret-store/tests/dump-keyring0-format.c	Tue Aug 20 15:26:27 2013
@@@@ -181,7 +181,7 @@@@ static gboolean
 buffer_get_time (Buffer *buffer,
                  gsize offset,
                  gsize *next_offset,
-                 glong *time)
+                 time_t *time)
 {
 	guint32 a, b;
 	guint64 val;
@


1.7
log
@Committed upstream.
@
text
@d1 1
a1 1
$OpenBSD: patch-pkcs11_secret-store_tests_dump-keyring0-format_c,v 1.6 2013/08/20 14:55:41 ajacoutot Exp $
@


1.6
log
@Fix for 64-bit time_t.

with kettenis@@
@
text
@d1 1
a1 1
$OpenBSD: patch-pkcs11_secret-store_tests_dump-keyring0-format_c,v 1.5 2013/08/15 16:07:27 ajacoutot Exp $
d3 4
a6 1
https://bugzilla.gnome.org/show_bug.cgi?id=706405
@


1.5
log
@Revert previous on these 3 ports.
kettenis@@ says there is more work involved since we are different from the
others... I have no time to take care of it properly so put back whatever
was there before which seemed to work fine.
@
text
@d1 1
a1 1
$OpenBSD: patch-pkcs11_secret-store_tests_dump-keyring0-format_c,v 1.3 2013/03/29 09:48:08 ajacoutot Exp $
d3 1
a3 1
XXX remove when we have a 64-bit time_t
d5 11
a15 20
--- pkcs11/secret-store/tests/dump-keyring0-format.c.orig	Mon Mar 25 11:34:56 2013
+++ pkcs11/secret-store/tests/dump-keyring0-format.c	Fri Mar 29 09:46:46 2013
@@@@ -685,7 +685,7 @@@@ read_full_item_info (Buffer *buffer,
 	gsize n_secret;
 	gchar *value;
 	guint32 tmp;
-	time_t ctime, mtime;
+	long ctime, mtime;
 	gint i, j;
 
 	g_assert (buffer);
@@@@ -762,7 +762,7 @@@@ transform_keyring_binary_to_text (gconstpointer data,
 	guchar major, minor, crypto, hash;
 	guint32 flags;
 	guint32 lock_timeout;
-	time_t mtime, ctime;
+	long mtime, ctime;
 	guint32 tmp;
 	guint32 num_items;
 	guint32 crypto_size;
@


1.4
log
@Remove, we have 64-bit time_t.
@
text
@@


1.3
log
@Update to gnome-keyring-3.8.0.
@
text
@d1 1
a1 1
$OpenBSD: patch-pkcs11_secret-store_tests_dump-keyring0-format_c,v 1.2 2012/10/18 12:55:05 ajacoutot Exp $
@


1.2
log
@Change some variables from time_t to long to prevent crashes all over...
@
text
@d1 1
a1 1
$OpenBSD: patch-pkcs11_secret-store_tests_dump-keyring0-format_c,v 1.1 2012/03/29 06:51:38 ajacoutot Exp $
d5 4
a8 4
--- pkcs11/secret-store/tests/dump-keyring0-format.c.orig	Wed Mar 28 08:33:01 2012
+++ pkcs11/secret-store/tests/dump-keyring0-format.c	Wed Mar 28 08:34:01 2012
@@@@ -385,7 +385,7 @@@@ read_full_item_info (EggBuffer *buffer,
 	size_t n_secret;
d16 1
a16 1
@@@@ -462,7 +462,7 @@@@ transform_keyring_binary_to_text (gconstpointer data,
@


1.1
log
@Update to gnome-keyring-3.4.0.
@
text
@d1 1
a1 1
$OpenBSD$
d3 1
a3 2
On OpenBSD, time_t is an int.
https://bugzilla.gnome.org/show_bug.cgi?id=652565
d12 1
a12 1
+	long int ctime, mtime;
d21 1
a21 1
+	long int mtime, ctime;
@

