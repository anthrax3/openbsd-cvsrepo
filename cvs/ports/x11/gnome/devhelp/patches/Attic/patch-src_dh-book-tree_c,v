head	1.2;
access;
symbols
	OPENBSD_4_6:1.1.0.2
	OPENBSD_4_6_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2009.10.14.12.24.06;	author ajacoutot;	state dead;
branches;
next	1.1;

1.1
date	2009.03.19.14.36.53;	author ajacoutot;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Major update to devhelp-2.28.0.
@
text
@$OpenBSD: patch-src_dh-book-tree_c,v 1.1 2009/03/19 14:36:53 ajacoutot Exp $

From upstream SVN rev 1265:
Use file: URIs instead of local paths, fixes use with more recent webkit
versions.

--- src/dh-book-tree.c.orig	Sat Oct  4 19:17:19 2008
+++ src/dh-book-tree.c	Thu Mar 19 15:28:28 2009
@@@@ -245,22 +245,14 @@@@ book_tree_find_uri_foreach (GtkTreeModel *model,
 			    FindURIData  *data)
 {
 	DhLink      *link;
-	const gchar *uri;
         gchar       *link_uri;
 
 	gtk_tree_model_get (model, iter,
 			    COL_LINK, &link,
 			    -1);
 
-	/* A bit hackish, could be made more generic. */
-	if (g_str_has_prefix (data->uri, "file://")) {
-		uri = data->uri + 7;
-	} else {
-		uri = data->uri;
-	}
-
         link_uri = dh_link_get_uri (link);
-	if (g_str_has_prefix (uri, link_uri)) {
+	if (g_str_has_prefix (data->uri, link_uri)) {
 		data->found = TRUE;
 		data->iter = *iter;
 		data->path = gtk_tree_path_copy (path);
@


1.1
log
@- bring in some patches from SVN to fix use with our recent webkit
@
text
@d1 1
a1 1
$OpenBSD$
@

