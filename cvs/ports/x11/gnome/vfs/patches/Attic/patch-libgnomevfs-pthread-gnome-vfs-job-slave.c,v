head	1.3;
access;
symbols
	OPENBSD_3_0:1.2.0.2
	OPENBSD_3_0_BASE:1.2
	gnome-vfs-1_0_1:1.1.1.1
	todd:1.1.1;
locks; strict;
comment	@ * @;


1.3
date	2002.02.15.19.11.16;	author nino;	state dead;
branches;
next	1.2;

1.2
date	2001.09.18.15.18.52;	author naddy;	state Exp;
branches;
next	1.1;

1.1
date	2001.09.13.21.25.11;	author todd;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2001.09.13.21.25.11;	author todd;	state Exp;
branches;
next	;


desc
@@


1.3
log
@Update to gnome-vfs 1.0.4

* portability fixes, fixes for FTP directory loading, detect Koffice
MIME-types, random crash and leak fixes, SSL and https support, fix NFS
method, fix buffer overflow, nntp module.

Ok naddy@@, with additional testing by fries@@.
@
text
@$OpenBSD: patch-libgnomevfs-pthread-gnome-vfs-job-slave.c,v 1.2 2001/09/18 15:18:52 naddy Exp $
--- libgnomevfs-pthread/gnome-vfs-job-slave.c.orig	Sun Feb  4 04:54:14 2001
+++ libgnomevfs-pthread/gnome-vfs-job-slave.c	Thu Aug 30 16:05:18 2001
@@@@ -60,14 +60,22 @@@@ thread_routine (void *data)
 	}
 	
 	JOB_DEBUG (("locking access_lock %u", GPOINTER_TO_UINT (job->job_handle)));
+#ifdef HAVE_SEMAPHORE_H
 	sem_wait (&job->access_lock);
+#else
+	pthread_mutex_lock (&job->access_lock);
+#endif
 	gnome_vfs_async_job_map_unlock ();
 
 	gnome_vfs_job_execute (job);
 	complete = gnome_vfs_job_complete (job);
 	
 	JOB_DEBUG (("Unlocking access lock %u", GPOINTER_TO_UINT (job->job_handle)));
+#ifdef HAVE_SEMAPHORE_H
 	sem_post (&job->access_lock);
+#else
+	pthread_mutex_unlock (&job->access_lock);
+#endif
 
 	if (complete) {
 		JOB_DEBUG (("job %u done, removing from map and destroying",
@


1.2
log
@install message catalogs at proper location, cleanup
@
text
@d1 1
a1 1
$OpenBSD: patch-libgnomevfs-pthread-gnome-vfs-job-slave.c,v 1.1.1.1 2001/09/13 21:25:11 todd Exp $
@


1.1
log
@Initial revision
@
text
@d1 1
a1 3
# $OpenBSD$
#$NetBSD: patch-af,v 1.1 2001/04/06 22:03:09 rh Exp $#

@


1.1.1.1
log
@the GNOME Virtual File System
@
text
@@
