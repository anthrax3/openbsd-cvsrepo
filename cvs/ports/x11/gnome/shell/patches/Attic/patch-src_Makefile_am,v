head	1.11;
access;
symbols
	OPENBSD_5_5:1.8.0.2
	OPENBSD_5_5_BASE:1.8
	OPENBSD_5_4:1.4.0.2
	OPENBSD_5_4_BASE:1.4
	OPENBSD_5_3:1.3.0.2
	OPENBSD_5_3_BASE:1.3;
locks; strict;
comment	@# @;


1.11
date	2014.03.27.19.05.31;	author jasper;	state dead;
branches;
next	1.10;

1.10
date	2014.03.26.11.05.20;	author jasper;	state Exp;
branches;
next	1.9;

1.9
date	2014.03.15.07.17.55;	author ajacoutot;	state Exp;
branches;
next	1.8;

1.8
date	2013.10.12.14.39.38;	author ajacoutot;	state Exp;
branches;
next	1.7;

1.7
date	2013.10.12.09.26.46;	author jasper;	state Exp;
branches;
next	1.6;

1.6
date	2013.10.11.12.24.37;	author ajacoutot;	state Exp;
branches;
next	1.5;

1.5
date	2013.09.27.14.04.47;	author jasper;	state Exp;
branches;
next	1.4;

1.4
date	2013.03.30.08.04.19;	author jasper;	state Exp;
branches;
next	1.3;

1.3
date	2012.09.30.20.56.42;	author jasper;	state Exp;
branches;
next	1.2;

1.2
date	2012.09.30.14.45.23;	author jasper;	state Exp;
branches;
next	1.1;

1.1
date	2012.08.29.11.56.27;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.11
log
@update to gnome-shell-3.12.0
@
text
@$OpenBSD: patch-src_Makefile_am,v 1.10 2014/03/26 11:05:20 jasper Exp $

From 9f3499a7c33e33f9da204f752e5021afee9c68b2 Mon Sep 17 00:00:00 2001
From: Michael Biebl <biebl@@debian.org>
Date: Tue, 11 Feb 2014 22:20:15 +0000
Subject: make NetworkManager optional

From 225d31720f4bba7e31bbe91e6cacb1f89abbf4eb Mon Sep 17 00:00:00 2001
From: Tim Lunn <tim@@feathertop.org>
Date: Sun, 6 Oct 2013 19:21:50 +1100
Subject: [PATCH] port shell-js to c++

--- src/Makefile.am.orig	Wed Feb 19 19:19:33 2014
+++ src/Makefile.am	Wed Mar 26 11:57:39 2014
@@@@ -103,7 +103,6 @@@@ shell_public_headers_h =		\
 	shell-invert-lightness-effect.h	\
 	shell-keybinding-modes.h	\
 	shell-mount-operation.h		\
-	shell-network-agent.h		\
 	shell-perf-log.h		\
 	shell-screenshot.h		\
 	shell-slicer.h			\
@@@@ -115,6 +114,10 @@@@ shell_public_headers_h =		\
 	shell-window-tracker.h		\
 	shell-wm.h
 
+if HAVE_NETWORKMANAGER
+shell_public_headers_h +=  shell-network-agent.h
+endif
+
 libgnome_shell_menu_la_SOURCES = 	\
 	gtkactionmuxer.h		\
 	gtkactionmuxer.c		\
@@@@ -140,7 +143,6 @@@@ libgnome_shell_base_la_SOURCES = 	\
 	shell-menu-tracker.c		\
 	shell-menu-tracker.h		\
 	shell-mount-operation.c		\
-	shell-network-agent.c		\
 	shell-perf-log.c		\
 	shell-polkit-authentication-agent.h	\
 	shell-polkit-authentication-agent.c	\
@@@@ -151,6 +153,10 @@@@ libgnome_shell_base_la_SOURCES = 	\
 	shell-tp-client.c		\
 	$(NULL)
 
+if HAVE_NETWORKMANAGER
+libgnome_shell_base_la_SOURCES +=  shell-network-agent.c
+endif
+
 libgnome_shell_sources =		\
 	$(shell_built_sources)		\
 	$(shell_public_headers_h)	\
@@@@ -207,7 +213,7 @@@@ endif HAVE_MUTTER_WAYLAND
 
 libgnome_shell_js_la_SOURCES =		\
 	shell-js.h			\
-	shell-js.c			\
+	shell-js.cpp			\
 	$(NULL)
 
 libgnome_shell_js_la_LIBADD =		\
@@@@ -331,7 +337,10 @@@@ INTROSPECTION_GIRS += ShellMenu-0.1.gir
 CLEANFILES += ShellMenu-0.1.gir
 
 Shell-0.1.gir: gnome-shell St-1.0.gir ShellMenu-0.1.gir
-Shell_0_1_gir_INCLUDES = Clutter-1.0 ClutterX11-1.0 Meta-3.0 TelepathyGLib-0.12 Soup-2.4 GMenu-3.0 NetworkManager-1.0 NMClient-1.0
+Shell_0_1_gir_INCLUDES = Clutter-1.0 ClutterX11-1.0 Meta-3.0 TelepathyGLib-0.12 Soup-2.4 GMenu-3.0
+if HAVE_NETWORKMANAGER
+Shell_0_1_gir_INCLUDES += NetworkManager-1.0 NMClient-1.0
+endif
 Shell_0_1_gir_CFLAGS = $(libgnome_shell_la_CPPFLAGS) -I $(srcdir)
 # Hack! we use PROGRAM instead of LIBS so that the soname is not included
 # in the typelib. This way the symbols will be resolved with the libgnome-shell
@


1.10
log
@add varous patches from upstream to unbreak with new spidermonkey/gjs.

they'll be removed once gnome-shell is updated to 3.12.0
@
text
@d1 1
a1 1
$OpenBSD: patch-src_Makefile_am,v 1.9 2014/03/15 07:17:55 ajacoutot Exp $
@


1.9
log
@Fixed upstream.
@
text
@d1 1
a1 1
$OpenBSD: patch-src_Makefile_am,v 1.8 2013/10/12 14:39:38 ajacoutot Exp $
d8 7
a14 2
--- src/Makefile.am.orig	Thu Sep 12 20:09:56 2013
+++ src/Makefile.am	Fri Oct 11 14:05:14 2013
d53 9
@


1.8
log
@Fix previous and give the correct BZ URL.
@
text
@d1 1
a1 1
$OpenBSD: patch-src_Makefile_am,v 1.7 2013/10/12 09:26:46 jasper Exp $
d3 4
a6 3
https://bugzilla.gnome.org/show_bug.cgi?id=669495
http://sources.debian.net/src/gnome-shell/3.8.4-3/debian/patches/10-make-NetworkManager-optional.patch
http://sources.gentoo.org/cgi-bin/viewvc.cgi/gentoo-x86/gnome-base/gnome-shell/files/gnome-shell-3.8.3-networkmanager-flag.patch
@


1.7
log
@update bz url; no pkg change
@
text
@d1 1
a1 1
$OpenBSD: patch-src_Makefile_am,v 1.6 2013/10/11 12:24:37 ajacoutot Exp $
d3 1
a3 1
https://bugzilla.gnome.org/show_bug.cgi?id=709571
@


1.6
log
@Sync NM patch with Gentoo/Debian.
@
text
@d1 1
a1 1
$OpenBSD$
d3 1
a3 1
https://bugzilla.gnome.org/show_bug.cgi?id=679871
@


1.5
log
@update to gnome-shell-3.10.0.1
@
text
@d1 1
a1 1
$OpenBSD: patch-src_Makefile_am,v 1.4 2013/03/30 08:04:19 jasper Exp $
a2 1
Make Network Manager support optional.
d4 2
d8 1
a8 1
+++ src/Makefile.am	Fri Sep 27 15:19:30 2013
d17 12
a28 1
@@@@ -140,7 +139,6 @@@@ libgnome_shell_base_la_SOURCES = 	\
d36 3
a38 1
@@@@ -242,6 +240,16 @@@@ endif BUILD_RECORDER
d40 3
a42 5
 ########################################
 
+if NETWORK_MANAGER
+
+shell_public_headers_h += shell-network-agent.h
d44 4
a47 10
+libgnome_shell_la_SOURCES += shell-network-agent.c
+
+endif NETWORK_MANAGER
+
+########################################
+
 libexec_PROGRAMS += gnome-shell-perf-helper
 
 gnome_shell_perf_helper_SOURCES = shell-perf-helper.c
@@@@ -331,7 +339,10 @@@@ INTROSPECTION_GIRS += ShellMenu-0.1.gir
d53 1
a53 1
+if NETWORK_MANAGER
@


1.4
log
@- update to gnome-shell-3.8.0.1
@
text
@d1 1
a1 1
$OpenBSD: patch-src_Makefile_am,v 1.3 2012/09/30 20:56:42 jasper Exp $
d6 3
a8 3
--- src/Makefile.am.orig	Fri Mar 22 20:06:31 2013
+++ src/Makefile.am	Fri Mar 29 21:57:26 2013
@@@@ -116,7 +116,6 @@@@ shell_public_headers_h =		\
d16 3
a18 3
@@@@ -159,7 +158,6 @@@@ libgnome_shell_la_SOURCES =		\
 	shell-keyring-prompt.h		\
 	shell-keyring-prompt.c		\
d24 1
a24 1
@@@@ -233,6 +231,16 @@@@ endif BUILD_RECORDER
d41 2
a42 2
@@@@ -287,7 +295,10 @@@@ libgnome_shell_la_LIBADD =		\
 libgnome_shell_la_CPPFLAGS = $(gnome_shell_cflags)
d44 1
a44 1
 Shell-0.1.gir: libgnome-shell.la St-1.0.gir
d51 2
a52 2
 Shell_0_1_gir_LIBS = libgnome-shell.la
 Shell_0_1_gir_FILES = $(libgnome_shell_la_gir_sources)
@


1.3
log
@sync with patch as submitted upstream, no pkg change
@
text
@d1 1
a1 1
$OpenBSD: patch-src_Makefile_am,v 1.2 2012/09/30 14:45:23 jasper Exp $
d6 3
a8 11
--- src/Makefile.am.orig	Tue Sep 18 16:44:03 2012
+++ src/Makefile.am	Sun Sep 30 22:46:10 2012
@@@@ -86,6 +86,7 @@@@ include Makefile-hotplug-sniffer.am
 gnome_shell_cflags =				\
 	$(GNOME_SHELL_CFLAGS)			\
 	$(SYSTEMD_CFLAGS)                       \
+	$(NM_CFLAGS)				\
 	-I$(srcdir)/tray			\
 	-DVERSION=\"$(VERSION)\"		\
 	-DLOCALEDIR=\"$(datadir)/locale\" 	\
@@@@ -117,7 +118,6 @@@@ shell_public_headers_h =		\
d10 1
a10 1
 	shell-mobile-providers.h	\
d15 3
a17 2
 	shell-screen-grabber.h		\
@@@@ -164,7 +164,6 @@@@ libgnome_shell_la_SOURCES =		\
a18 1
 	shell-mobile-providers.c	\
d24 1
a24 1
@@@@ -241,6 +240,16 @@@@ endif BUILD_RECORDER
d41 1
a41 9
@@@@ -287,6 +296,7 @@@@ libgnome_shell_la_LIBADD =		\
 	-lm			\
 	$(GNOME_SHELL_LIBS)	\
 	$(SYSTEMD_LIBS)         \
+	$(NM_LIBS)		\
 	$(BLUETOOTH_LIBS)	\
 	libst-1.0.la       	\
 	libtray.la		\
@@@@ -296,7 +306,10 @@@@ libgnome_shell_la_LIBADD =		\
d45 2
a46 2
-Shell_0_1_gir_INCLUDES = Clutter-1.0 ClutterX11-1.0 Meta-3.0 TelepathyGLib-0.12 TelepathyLogger-0.2 Soup-2.4 GMenu-3.0 NetworkManager-1.0 NMClient-1.0
+Shell_0_1_gir_INCLUDES = Clutter-1.0 ClutterX11-1.0 Meta-3.0 TelepathyGLib-0.12 TelepathyLogger-0.2 Soup-2.4 GMenu-3.0
@


1.2
log
@- update to gnome-shell-3.6.0
@
text
@d1 1
a1 1
$OpenBSD: patch-src_Makefile_am,v 1.1 2012/08/29 11:56:27 jasper Exp $
d6 11
a16 3
--- src/Makefile.am.orig	Sun Sep 30 13:38:04 2012
+++ src/Makefile.am	Sun Sep 30 13:39:13 2012
@@@@ -117,7 +117,6 @@@@ shell_public_headers_h =		\
d24 1
a24 1
@@@@ -164,7 +163,6 @@@@ libgnome_shell_la_SOURCES =		\
d32 1
a32 1
@@@@ -241,6 +239,16 @@@@ endif BUILD_RECORDER
d49 9
a57 1
@@@@ -296,7 +304,10 @@@@ libgnome_shell_la_LIBADD =		\
@


1.1
log
@Make NetworkManager support optional; this is a cleaner approach than
what we previously had in tree.

ok aja@@
@
text
@d1 1
a1 1
$OpenBSD$
d6 4
a9 4
--- src/Makefile.am.orig	Mon Apr 16 19:47:21 2012
+++ src/Makefile.am	Sat Jul 14 11:27:35 2012
@@@@ -112,7 +112,6 @@@@ shell_public_headers_h =		\
 	shell-idle-monitor.h		\
d16 1
a16 1
@@@@ -161,7 +160,6 @@@@ libgnome_shell_la_SOURCES =		\
d45 2
a46 2
-Shell_0_1_gir_INCLUDES = Clutter-1.0 ClutterX11-1.0 Meta-3.0 TelepathyGLib-0.12 TelepathyLogger-0.2 Soup-2.4 GMenu-3.0 NetworkManager-1.0 NMClient-1.0 Folks-0.6
+Shell_0_1_gir_INCLUDES = Clutter-1.0 ClutterX11-1.0 Meta-3.0 TelepathyGLib-0.12 TelepathyLogger-0.2 Soup-2.4 GMenu-3.0 Folks-0.6
@

