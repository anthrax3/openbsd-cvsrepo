head	1.4;
access;
symbols
	OPENBSD_5_1_BASE:1.3
	OPENBSD_5_1:1.3.0.2;
locks; strict;
comment	@# @;


1.4
date	2012.03.29.06.47.51;	author ajacoutot;	state dead;
branches;
next	1.3;

1.3
date	2011.12.16.11.26.34;	author ajacoutot;	state Exp;
branches;
next	1.2;

1.2
date	2011.11.16.19.25.51;	author ajacoutot;	state dead;
branches;
next	1.1;

1.1
date	2011.11.11.09.32.07;	author ajacoutot;	state Exp;
branches;
next	;


desc
@@


1.4
log
@Update to gnome-settings-daemon-3.4.0.
@
text
@$OpenBSD: patch-plugins_color_gcm-dmi_c,v 1.3 2011/12/16 11:26:34 ajacoutot Exp $

From 52b9ea0cf11aa72b8251fa11e99cc58054b9c81c Mon Sep 17 00:00:00 2001
From: Antoine Jacoutot <ajacoutot@@openbsd.org>
Date: Fri, 16 Dec 2011 09:27:47 +0000
Subject: color plugin: prevent sysfs warning on !linux

--- plugins/color/gcm-dmi.c.orig	Fri Dec 16 09:45:32 2011
+++ plugins/color/gcm-dmi.c	Fri Dec 16 10:01:37 2011
@@@@ -122,6 +122,7 @@@@ gcm_dmi_class_init (GcmDmiClass *klass)
 static void
 gcm_dmi_init (GcmDmi *dmi)
 {
+#if defined(__linux__)
         const gchar *sysfs_name[] = {
                 "/sys/class/dmi/id/product_name",
                 "/sys/class/dmi/id/board_name",
@@@@ -136,6 +137,12 @@@@ gcm_dmi_init (GcmDmi *dmi)
                 "/sys/class/dmi/id/chassis_vendor",
                 "/sys/class/dmi/id/board_vendor",
                 NULL};
+#else
+#warning Please add dmi support for your OS
+        const gchar *sysfs_name[] = { NULL };
+        const gchar *sysfs_version[] = { NULL };
+        const gchar *sysfs_vendor[] = { NULL };
+#endif
 
         dmi->priv = GCM_DMI_GET_PRIVATE (dmi);
 
@


1.3
log
@Sync patch.
@
text
@d1 1
a1 1
$OpenBSD$
@


1.2
log
@Remove this patch; it's wrong and introduced a segfault at logout.
@
text
@d1 1
a1 1
$OpenBSD: patch-plugins_color_gcm-dmi_c,v 1.1 2011/11/11 09:32:07 ajacoutot Exp $
d3 4
a6 1
No sysfs on OpenBSD.
d8 2
a9 2
--- plugins/color/gcm-dmi.c.orig	Fri Nov 11 10:25:42 2011
+++ plugins/color/gcm-dmi.c	Fri Nov 11 10:26:24 2011
d14 1
a14 1
+#ifdef __linux__
d18 9
a26 4
@@@@ -143,6 +144,7 @@@@ gcm_dmi_init (GcmDmi *dmi)
         dmi->priv->name = gcm_dmi_get_from_filenames (sysfs_name);
         dmi->priv->version = gcm_dmi_get_from_filenames (sysfs_version);
         dmi->priv->vendor = gcm_dmi_get_from_filenames (sysfs_vendor);
a27 1
 }
d29 2
a30 1
 static void
@


1.1
log
@Don't try to get values from sysfs, that's linux-only.
@
text
@d1 1
a1 1
$OpenBSD$
@

