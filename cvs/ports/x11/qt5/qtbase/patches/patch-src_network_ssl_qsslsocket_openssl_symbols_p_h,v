head	1.1;
access;
symbols;
locks; strict;
comment	@# @;


1.1
date	2017.01.27.16.13.08;	author zhuk;	state Exp;
branches;
next	;
commitid	QZuellQgImf7lyCn;


desc
@@


1.1
log
@Fix after recent LibreSSL changes.

Nowadays we have fake SSL_CTRL_SET_CURVES macro, and SSL_CTX_set1_curves
defined as synonym to SSL_CTX_set1_groups. So use the latter instead
of the former.

The patch should be tweaked furthermore before proposing it upstream,
but for now we can at least build things again.
@
text
@$OpenBSD$
Unbreak build with LibreSSL.
See also https://github.com/libressl-portable/openbsd/issues/33
--- src/network/ssl/qsslsocket_openssl_symbols_p.h.orig	Fri Jan 27 18:33:13 2017
+++ src/network/ssl/qsslsocket_openssl_symbols_p.h	Fri Jan 27 18:59:44 2017
@@@@ -551,6 +551,9 @@@@ void q_SSL_get0_next_proto_negotiated(const SSL *s, co
                                       unsigned *len);
 #endif // OPENSSL_VERSION_NUMBER >= 0x1000100fL ...
 
+int q_SSL_CTX_set1_groups(SSL_CTX *ctx, const int *groups, size_t ngroups);
+#define q_SSL_CTX_set1_curves(ctx,curves,ncurves) q_SSL_CTX_set1_groups((ctx),(curves),(ncurves))
+
 // Helper function
 class QDateTime;
 QDateTime q_getTimeFromASN1(const ASN1_TIME *aTime);
@
