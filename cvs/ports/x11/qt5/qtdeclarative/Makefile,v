head	1.4;
access;
symbols
	OPENBSD_6_1:1.2.0.2
	OPENBSD_6_1_BASE:1.2
	zhuk_20161225:1.1.1.1
	zhuk:1.1.1;
locks; strict;
comment	@# @;


1.4
date	2017.07.26.22.45.34;	author sthen;	state Exp;
branches;
next	1.3;
commitid	tD4MFrpYYDDL2UFT;

1.3
date	2017.07.17.08.34.38;	author zhuk;	state Exp;
branches;
next	1.2;
commitid	3tUsNizeEEvC87c0;

1.2
date	2016.12.28.01.41.23;	author zhuk;	state Exp;
branches;
next	1.1;
commitid	zznJcJZGYlX0U9PC;

1.1
date	2016.12.25.14.13.14;	author zhuk;	state Exp;
branches
	1.1.1.1;
next	;
commitid	QPfzuwiSTmth4MkN;

1.1.1.1
date	2016.12.25.14.13.14;	author zhuk;	state Exp;
branches;
next	;
commitid	QPfzuwiSTmth4MkN;


desc
@@


1.4
log
@bump LIBCXX/LIBECXX/COMPILER_LIBCXX ports.
@
text
@# $OpenBSD: Makefile,v 1.3 2017/07/17 08:34:38 zhuk Exp $

QT5NAME =		QtDeclarative
REVISION =		0
COMMENT-main =		Qt5 Quick and QML components
COMMENT-xmllistmodel =	plugin for creating QML models from XML
PKGNAME-xmllistmodel =	qt5-declarative-xmllistmodel-${VERSION}

MULTI_PACKAGES =	-main -examples -qch -html -docindex -xmllistmodel
DPB_PROPERTIES =	parallel

SHARED_LIBS =		Qt5Qml			2.1
SHARED_LIBS +=		Qt5Quick		2.1
SHARED_LIBS +=		Qt5QuickParticles	2.1
SHARED_LIBS +=		Qt5QuickTest		2.1
SHARED_LIBS +=		Qt5QuickWidgets		2.1

WANTLIB-main =  	${WANTLIB} ${COMPILER_LIBCXX}
WANTLIB-main +=		GL Qt5Core Qt5Gui Qt5Network Qt5Sql Qt5Test Qt5Widgets
WANTLIB-main +=		c m pthread

WANTLIB-xmllistmodel =	${WANTLIB} ${COMPILER_LIBCXX} pthread
WANTLIB-xmllistmodel +=	Qt5Core Qt5Network Qt5Qml Qt5XmlPatterns m

MODULES =		lang/python
MODPY_RUNDEP =		No

LIB_DEPENDS-examples =	${LIB_DEPENDS} \
			x11/qt5/qtxmlpatterns>=${QT5_VERSION},<${QT5_NEXT_VERSION}

LIB_DEPENDS-xmllistmodel = \
			${LIB_DEPENDS} \
			${BUILD_PKGPATH},-main>=${VERSION:R},<${QT5_NEXT_VERSION} \
			x11/qt5/qtxmlpatterns>=${QT5_VERSION},<${QT5_NEXT_VERSION}

RUN_DEPENDS-examples =	x11/qt5/qtmultimedia>=${QT5_VERSION:R},<${QT5_NEXT_VERSION}

TEST_DEPENDS =		x11/qt5/qtxmlpatterns>=${QT5_VERSION},<${QT5_NEXT_VERSION}

# bootstrap model is used due to:
#  1) circular dependency with qtmultimedia (used by qtdeclarative-examples);
#  2) circular dependency with qttools-examples;
#  3) circular dependency with qtxmlpatterns (used by xmllistmodel plugin,
#     examples and tests).

FLAVORS =		debug
PSEUDO_FLAVORS =	bootstrap no_examples no_qch no_html no_xmllistmodel no_tests
FLAVOR ?=		bootstrap no_examples no_qch no_html no_xmllistmodel no_tests

# Do not use bsd.port.arch.mk here: it's already used by Makefile.inc,
# and the latter does some magic with BUILD_PACKAGES as well.

# avoid circular dependency with qttools
.if ${FLAVOR:Mno_examples} && ${FLAVOR:Mno_qch} && ${FLAVOR:Mno_html}
MODQT5_DEPS =		No
LIB_DEPENDS =		x11/qt5/qtbase>=${QT5_VERSION},<${QT5_NEXT_VERSION}
.endif

MODQMAKE_RECURSIVE =	No

pre-configure:
# Python is used for building, this path does not get into final packages.
	ln -sf ${MODPY_BIN} ${WRKDIR}/bin/python
.if ${FLAVOR:Mno_xmllistmodel}
	perl -pi -e 's/.*SUBDIRS \+= xmllistmodel/\# $$&/' \
	    ${WRKSRC}/src/imports/imports.pro
.endif

.include <bsd.port.mk>
@


1.3
log
@Update from Qt 5.6.2 (LTS) to Qt 5.9.1 (LTS).

Tested with both GCC and CLang (less through).

This forces updating x11/py-qt5, which forces update of devel/py-sip,
which forces update of x11/py-qt4, but, thankfully, no breakage detected.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2016/12/28 01:41:23 zhuk Exp $
d4 1
@


1.2
log
@Rework Qt5 documentation handling:

  * Move share/qt5/doc/* in qtbase from -main to a separate subpackage,
    -global, which (as a bonus) "owns" share/doc/qt5/ directory;

  * Move FOO.index files from -html to a separate subpackage, -docindex,
    and make 'em depend on qtbase,-global;

  * Make DEP,-docindex automatically added as BDEP for each DEP in
    LDEP and BDEP mentioned for -main;

  * Make it clear that building -qch without -html is impossible;

While there, fixed a few minor issues.

This make at least qtenginio,-html build correctly, which failed before
due to missing .index files during qdoc run. Initial report from kili@@.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2016/12/25 14:13:14 zhuk Exp $
d5 2
a6 2
REVISION-qch =		0
REVISION-html =		0
d8 1
a8 1
MULTI_PACKAGES =	-main -examples -qch -html -docindex
d11 5
a15 5
SHARED_LIBS =		Qt5Qml			2.0
SHARED_LIBS +=		Qt5Quick		2.0
SHARED_LIBS +=		Qt5QuickParticles	2.0
SHARED_LIBS +=		Qt5QuickTest		2.0
SHARED_LIBS +=		Qt5QuickWidgets		2.0
d17 1
a17 1
WANTLIB-main =  	${WANTLIB}
d21 3
d27 8
d37 2
d41 3
a43 1
#  2) circular dependency with qttools-examples.
d46 5
a50 2
PSEUDO_FLAVORS =	bootstrap no_examples no_qch no_html
FLAVOR ?=		bootstrap no_examples no_qch no_html
d58 3
a61 1
pre-configure:
d63 4
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d5 2
d8 1
a8 1
MULTI_PACKAGES =	-main -examples -qch -html
@


1.1.1.1
log
@Import Qt 5.6.2.

The port is now being split into pieces. Cleanup and conflict resolving
to follow.
@
text
@@
