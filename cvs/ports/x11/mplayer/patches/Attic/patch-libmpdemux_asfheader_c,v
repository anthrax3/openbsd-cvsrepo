head	1.2;
access;
symbols
	OPENBSD_3_9:1.1.0.6
	OPENBSD_3_8:1.1.0.4
	OPENBSD_3_7:1.1.0.2;
locks; strict;
comment	@# @;


1.2
date	2006.07.19.21.40.47;	author robert;	state dead;
branches;
next	1.1;

1.1
date	2006.04.06.21.47.43;	author biorn;	state Exp;
branches
	1.1.2.1
	1.1.4.1
	1.1.6.1;
next	;

1.1.2.1
date	2006.04.08.14.33.43;	author sturm;	state Exp;
branches;
next	;

1.1.4.1
date	2006.04.08.14.34.26;	author sturm;	state Exp;
branches;
next	;

1.1.6.1
date	2006.05.01.17.53.42;	author sturm;	state Exp;
branches;
next	;


desc
@@


1.2
log
@update to versio 1.0pre8; include the speex and mpcdec codecs by default;
this version of mplayer now uses gtk2;

ok biorn@@ and tested by many
@
text
@$OpenBSD: patch-libmpdemux_asfheader_c,v 1.1 2006/04/06 21:47:43 biorn Exp $
--- libmpdemux/asfheader.c.orig	Sat Dec 25 12:31:32 2004
+++ libmpdemux/asfheader.c	Thu Apr  6 20:30:42 2006
@@@@ -189,7 +189,7 @@@@ int read_asf_header(demuxer_t *demuxer){
   while ((pos = find_asf_guid(hdr, asf_stream_header_guid, pos, hdr_len)) >= 0)
   {
     ASF_stream_header_t *streamh = (ASF_stream_header_t *)&hdr[pos];
-    char *buffer;
+    uint8_t *buffer;
     pos += sizeof(ASF_stream_header_t);
     if (pos > hdr_len) goto len_err_out;
     le2me_ASF_stream_header_t(streamh);
@@@@ -222,7 +222,9 @@@@ int read_asf_header(demuxer_t *demuxer){
           asf_scrambling_h=buffer[0];
           asf_scrambling_w=(buffer[2]<<8)|buffer[1];
           asf_scrambling_b=(buffer[4]<<8)|buffer[3];
-  	  asf_scrambling_w/=asf_scrambling_b;
+	  if(asf_scrambling_b>0){
+	    asf_scrambling_w/=asf_scrambling_b;
+	  }
 	} else {
 	  asf_scrambling_b=asf_scrambling_h=asf_scrambling_w=1;
 	}
@


1.1
log
@Protect from integer overflows. See CVE-2006-1502
@
text
@d1 1
a1 1
$OpenBSD$
@


1.1.6.1
log
@MFC:
Protect from integer overflows. See CVE-2006-1502
@
text
@d1 1
a1 1
$OpenBSD: patch-libmpdemux_asfheader_c,v 1.1.6.1 2006/05/01 17:48:17 sturm Exp $
@


1.1.4.1
log
@MFC:
Protect from integer overflows. See CVE-2006-1502
@
text
@d1 1
a1 1
$OpenBSD: patch-libmpdemux_asfheader_c,v 1.1 2006/04/06 21:47:43 biorn Exp $
@


1.1.2.1
log
@MFC:
Protect from integer overflows. See CVE-2006-1502
@
text
@d1 13
a13 4
$OpenBSD: patch-libmpdemux_asfheader_c,v 1.1 2006/04/06 21:47:43 biorn Exp $
--- libmpdemux/asfheader.c.orig	Sat Apr 17 12:31:38 2004
+++ libmpdemux/asfheader.c	Fri Apr  7 21:41:38 2006
@@@@ -181,7 +181,9 @@@@ while(!stream_eof(demuxer->stream)){
d18 3
a20 3
+  	  if(asf_scrambling_b>0){
+            asf_scrambling_w/=asf_scrambling_b;
+          }
@

