head	1.4;
access;
symbols
	OPENBSD_4_6:1.3.0.20
	OPENBSD_4_6_BASE:1.3
	OPENBSD_4_5:1.3.0.18
	OPENBSD_4_5_BASE:1.3
	OPENBSD_4_4:1.3.0.16
	OPENBSD_4_4_BASE:1.3
	OPENBSD_4_3:1.3.0.14
	OPENBSD_4_3_BASE:1.3
	OPENBSD_4_2:1.3.0.12
	OPENBSD_4_2_BASE:1.3
	OPENBSD_4_1:1.3.0.10
	OPENBSD_4_1_BASE:1.3
	OPENBSD_4_0:1.3.0.8
	OPENBSD_4_0_BASE:1.3
	OPENBSD_3_9:1.3.0.6
	OPENBSD_3_9_BASE:1.3
	OPENBSD_3_8:1.3.0.4
	OPENBSD_3_8_BASE:1.3
	OPENBSD_3_7:1.3.0.2
	OPENBSD_3_7_BASE:1.3
	OPENBSD_3_6:1.2.0.8
	OPENBSD_3_6_BASE:1.2
	OPENBSD_3_5:1.2.0.6
	OPENBSD_3_5_BASE:1.2
	OPENBSD_3_4:1.2.0.4
	OPENBSD_3_4_BASE:1.2
	OPENBSD_3_3:1.2.0.2
	OPENBSD_3_3_BASE:1.2;
locks; strict;
comment	@# @;


1.4
date	2009.10.11.13.36.23;	author edd;	state dead;
branches;
next	1.3;

1.3
date	2004.10.18.06.48.20;	author biorn;	state Exp;
branches;
next	1.2;

1.2
date	2003.02.16.07.25.18;	author brad;	state Exp;
branches;
next	1.1;

1.1
date	2002.12.22.14.19.47;	author espie;	state Exp;
branches;
next	;


desc
@@


1.4
log
@New version of mplayer based upon a snapshot (20090708).
  * fixes some flv playback
  * removed ggi output - broken i386/sparc64.
  * removed gui (deprecated) - use gnome-mplayer instead.
  * removed win32 codecs - opensource codecs are good quality.

OK, naddy@@, sthen@@
@
text
@$OpenBSD: patch-loader_wrapper_S,v 1.3 2004/10/18 06:48:20 biorn Exp $
--- loader/wrapper.S.orig	Mon Nov 25 21:37:12 2002
+++ loader/wrapper.S	Thu Jul 15 09:29:23 2004
@@@@ -1,27 +1,36 @@@@
+#include "../mangle.h"
+#if defined(__OpenBSD__) && !defined(__ELF__)
+.data
+#else
 .section .data
-.globl caller_return
-caller_return:
+#endif
+.globl MANGLEA(caller_return)
+MANGLEA(caller_return):
 	.long 0
-.globl report_entry
-report_entry:
-	.long null_call
-.globl report_ret
-report_ret:	
-	.long null_call
-.global wrapper_target
-wrapper_target:	
-	.long null_call
+.globl MANGLEA(report_entry)
+MANGLEA(report_entry):
+	.long MANGLEA(null_call)
+.globl MANGLEA(report_ret)
+MANGLEA(report_ret):	
+	.long MANGLEA(null_call)
+.global MANGLEA(wrapper_target)
+MANGLEA(wrapper_target):	
+	.long MANGLEA(null_call)
 
+#if defined(__OpenBSD__) && !defined(__ELF__)
+.text
+#else
 .section .text
-.globl null_call
-	.type null_call, @@function
+#endif
+.globl MANGLEA(null_call)
+	.type MANGLEA(null_call), @@function
 	.balign 16,0x90
-null_call:
+MANGLEA(null_call):
 	ret
-.globl wrapper
-	.type wrapper, @@function
+.globl MANGLEA(wrapper)
+	.type MANGLEA(wrapper), @@function
 	.balign 16,0x90
-wrapper:
+MANGLEA(wrapper):
 	pusha			# store registers (EAX, ECX, EDX, EBX, ESP, EBP, ESI, EDI) 
 	pushf			# store flags
 	
@@@@ -39,7 +48,7 @@@@ wrapper:
 	push %eax
 	push %edx
 	
-	call *report_entry	# report entry
+	call *MANGLEA(report_entry)	# report entry
 	
 	test %eax, %eax
 	jnz .Ldone
@@@@ -48,14 +57,14 @@@@ wrapper:
 	popf			# restore flags
 	popa			# restore registers
 	
-	popl caller_return	# switch return addresses
+	popl MANGLEA(caller_return)	# switch return addresses
 	pushl $.Lwrapper_return 
 	
-	jmp *wrapper_target	# wrapper_target should return at .Lwrapper_return
+	jmp *MANGLEA(wrapper_target)	# wrapper_target should return at .Lwrapper_return
 
 	.balign 16, 0x90
 .Lwrapper_return:	
-	pushl caller_return	# restore the original return address
+	pushl MANGLEA(caller_return)	# restore the original return address
 	pusha			# more for reference sake here
 	pushf
 	
@@@@ -73,7 +82,7 @@@@ wrapper:
 	push %eax
 	push %edx
 
-	call *report_ret	# report the return information (same args)
+	call *MANGLEA(report_ret)	# report the return information (same args)
 .Ldone:	
 
 	leave
@


1.3
log
@update to 1.0pre5
ok pvalchev@@
@
text
@d1 1
a1 1
$OpenBSD: patch-loader_wrapper_S,v 1.2 2003/02/16 07:25:18 brad Exp $
@


1.2
log
@upgrade to mplayer 0.90rc4

based on diff from MAINTAINER for 0.90rc3
@
text
@d1 1
a1 1
$OpenBSD: patch-loader_wrapper_S,v 1.1 2002/12/22 14:19:47 espie Exp $
d3 1
a3 1
+++ loader/wrapper.S	Tue Jan 21 23:02:18 2003
a24 1
-
d34 1
a34 1
+
@


1.1
log
@Update to 0.90rc1.
From maintainer, Bjorn.

PP fix from niklas@@
@
text
@d1 4
a4 4
$OpenBSD$
--- loader/wrapper.S.orig	Sun Dec  8 21:11:05 2002
+++ loader/wrapper.S	Sun Dec  8 21:11:19 2002
@@@@ -1,27 +1,32 @@@@
d6 3
a8 1
+#if !defined(__OpenBSD__) && !defined(__ELF__)
d25 1
d35 4
a38 2
 
+#if !defined(__OpenBSD__) && !defined(__ELF__)
d59 1
a59 1
@@@@ -39,7 +44,7 @@@@ wrapper:
d68 1
a68 1
@@@@ -48,14 +53,14 @@@@ wrapper:
d86 1
a86 1
@@@@ -73,7 +78,7 @@@@ wrapper:
@

