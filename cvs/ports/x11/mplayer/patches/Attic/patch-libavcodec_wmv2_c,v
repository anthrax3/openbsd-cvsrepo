head	1.2;
access;
symbols
	OPENBSD_3_9:1.1.0.2
	OPENBSD_3_9_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2006.07.19.21.40.47;	author robert;	state dead;
branches;
next	1.1;

1.1
date	2005.09.08.16.35.01;	author fgsch;	state Exp;
branches;
next	;


desc
@@


1.2
log
@update to versio 1.0pre8; include the speex and mpcdec codecs by default;
this version of mplayer now uses gtk2;

ok biorn@@ and tested by many
@
text
@$OpenBSD: patch-libavcodec_wmv2_c,v 1.1 2005/09/08 16:35:01 fgsch Exp $
--- libavcodec/wmv2.c.orig	Sat Apr 16 17:41:13 2005
+++ libavcodec/wmv2.c	Wed Sep  7 17:00:16 2005
@@@@ -513,9 +513,12 @@@@ static int16_t *wmv2_pred_motion(Wmv2Con
     B = s->current_picture.motion_val[0][xy - wrap];
     C = s->current_picture.motion_val[0][xy + 2 - wrap];
     
-    diff= FFMAX(ABS(A[0] - B[0]), ABS(A[1] - B[1]));
+    if(s->mb_x && !s->first_slice_line && !s->mspel && w->top_left_mv_flag)
+        diff= FFMAX(ABS(A[0] - B[0]), ABS(A[1] - B[1]));
+    else
+        diff=0;
     
-    if(s->mb_x && !s->first_slice_line && !s->mspel && w->top_left_mv_flag && diff >= 8)
+    if(diff >= 8)
         type= get_bits1(&s->gb);
     else
         type= 2;
@


1.1
log
@fix a crash when playing some wmv files; maintainer ok.
@
text
@d1 1
a1 1
$OpenBSD$
@

