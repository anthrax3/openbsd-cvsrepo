head	1.2;
access;
symbols
	OPENBSD_5_5:1.1.0.2
	OPENBSD_5_5_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2014.05.16.01.34.50;	author brad;	state dead;
branches;
next	1.1;

1.1
date	2014.02.16.19.50.52;	author pascal;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Update to FFmpeg 20140412 snapshot. From 2.2 branch.

Update to MPlayer 20140412 snapshot.

Take MAINTAINER for MPlayer. ok edd@@

ok ajacoutot@@
@
text
@$OpenBSD: patch-libmpdemux_demux_mpg_c,v 1.1 2014/02/16 19:50:52 pascal Exp $

Upstream r36845:
Fix probe bug losing video packets.

ds_fill_buffer will actually lose any data from previous
ds_fill_buffer calls.
Use demux_fill_buffer instead to get the intended behaviour.

--- libmpdemux/demux_mpg.c.orig	Mon Jan  6 23:03:23 2014
+++ libmpdemux/demux_mpg.c	Sun Feb 16 14:35:43 2014
@@@@ -192,7 +192,7 @@@@ static demuxer_t* demux_mpg_open(demuxer_t* demuxer) {
   mpg_demuxer_t* mpg_d;
 
   while (demuxer->video->packs + demuxer->audio->packs < 2)
-    if (!ds_fill_buffer(demuxer->video)) return 0;
+    if (!demux_fill_buffer(demuxer, demuxer->video)) return 0;
   mpg_d = calloc(1,sizeof(mpg_demuxer_t));
   if(mpg_d)
   {
@


1.1
log
@Merge upstream commit r36845:
Fix probe bug losing video packets.

ds_fill_buffer will actually lose any data from previous
ds_fill_buffer calls.
Use demux_fill_buffer instead to get the intended behaviour.

This fixes mplayer -nosound with DVDs, as used by multimedia/ogmrip.

ok sthen@@ aja@@ espie@@, no objection jasper@@
@
text
@d1 1
a1 1
$OpenBSD$
@

