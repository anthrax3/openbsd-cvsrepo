head	1.4;
access;
symbols
	OPENBSD_5_4:1.3.0.2
	OPENBSD_5_4_BASE:1.3
	OPENBSD_5_3:1.2.0.2
	OPENBSD_5_3_BASE:1.2
	OPENBSD_5_2:1.1.0.2
	OPENBSD_5_2_BASE:1.1;
locks; strict;
comment	@# @;


1.4
date	2013.09.06.23.14.40;	author brad;	state dead;
branches;
next	1.3;

1.3
date	2013.03.13.02.28.11;	author brad;	state Exp;
branches;
next	1.2;

1.2
date	2013.01.21.16.23.05;	author brad;	state Exp;
branches;
next	1.1;

1.1
date	2012.03.30.13.23.03;	author phessler;	state Exp;
branches;
next	;


desc
@@


1.4
log
@Update to MPlayer 20130819 snapshot.

ok gonzalo@@ sthen@@ edd@@
@
text
@$OpenBSD: patch-stream_stream_bluray_c,v 1.3 2013/03/13 02:28:11 brad Exp $
--- stream/stream_bluray.c.orig	Sun Jan 13 23:53:53 2013
+++ stream/stream_bluray.c	Mon Jan 21 11:45:15 2013
@@@@ -257,6 +257,8 @@@@ static int bluray_stream_open(stream_t *s, int mode,
         device = p->device;
     else if (bluray_device)
         device = bluray_device;
+    else
+      device = DEFAULT_BLURAY_DEVICE;
 
     if (!device) {
         mp_msg(MSGT_OPEN, MSGL_ERR, MSGTR_BlurayNoDevice);
@


1.3
log
@Update to MPlayer 20130214 snapshot.

ok sthen@@
@
text
@d1 1
a1 1
$OpenBSD: patch-stream_stream_bluray_c,v 1.2 2013/01/21 16:23:05 brad Exp $
@


1.2
log
@Update to MPlayer 20120725 snapshot.

Testing by naddy@@ sthen@@ landry@@ dcoppa@@
OK naddy@@ dcoppa@@
@
text
@d1 4
a4 4
$OpenBSD: patch-stream_stream_bluray_c,v 1.1 2012/03/30 13:23:03 phessler Exp $
--- stream/stream_bluray.c.orig	Sat May  5 01:09:57 2012
+++ stream/stream_bluray.c	Sat May  5 01:30:00 2012
@@@@ -252,6 +252,8 @@@@ static int bluray_stream_open(stream_t *s, int mode,
@


1.1
log
@allow mplayer to play (non-encrypted) bluray discs.

reviewed by Brad, edd@@ and sthen@@
@
text
@d1 4
a4 43
$OpenBSD$

Update to new libbluray API

--- stream/stream_bluray.c.orig	Wed Mar  9 01:32:47 2011
+++ stream/stream_bluray.c	Sun Nov 13 23:59:03 2011
@@@@ -116,7 +116,7 @@@@ static int bluray_stream_control(stream_t *s, int cmd,
     case STREAM_CTRL_GET_NUM_CHAPTERS: {
         BLURAY_TITLE_INFO *ti;
 
-        ti = bd_get_title_info(b->bd, b->current_title);
+        ti = bd_get_title_info(b->bd, b->current_title, 0);
         if (!ti)
             return STREAM_UNSUPPORTED;
 
@@@@ -137,7 +137,7 @@@@ static int bluray_stream_control(stream_t *s, int cmd,
         int64_t pos;
         int r;
 
-        ti = bd_get_title_info(b->bd, b->current_title);
+        ti = bd_get_title_info(b->bd, b->current_title, 0);
         if (!ti)
             return STREAM_UNSUPPORTED;
 
@@@@ -156,7 +156,7 @@@@ static int bluray_stream_control(stream_t *s, int cmd,
     case STREAM_CTRL_GET_NUM_ANGLES: {
         BLURAY_TITLE_INFO *ti;
 
-        ti = bd_get_title_info(b->bd, b->current_title);
+        ti = bd_get_title_info(b->bd, b->current_title, 0);
         if (!ti)
             return STREAM_UNSUPPORTED;
 
@@@@ -175,7 +175,7 @@@@ static int bluray_stream_control(stream_t *s, int cmd,
         BLURAY_TITLE_INFO *ti;
         int angle = *((int *) arg);
 
-        ti = bd_get_title_info(b->bd, b->current_title);
+        ti = bd_get_title_info(b->bd, b->current_title, 0);
         if (!ti)
             return STREAM_UNSUPPORTED;
 
@@@@ -222,6 +222,8 @@@@ static int bluray_stream_open(stream_t *s, int mode,
a12 27
@@@@ -236,7 +238,7 @@@@ static int bluray_stream_open(stream_t *s, int mode,
     }
 
     /* check for available titles on disc */
-    title_count = bd_get_titles(bd, TITLES_RELEVANT);
+    title_count = bd_get_titles(bd, TITLES_RELEVANT, 0);
     mp_msg(MSGT_IDENTIFY, MSGL_INFO, "ID_BLURAY_TITLES=%d\n", title_count);
     if (!title_count) {
         mp_msg(MSGT_OPEN, MSGL_ERR, MSGTR_BlurayNoTitles);
@@@@ -250,7 +252,7 @@@@ static int bluray_stream_open(stream_t *s, int mode,
         BLURAY_TITLE_INFO *ti;
         int sec, msec;
 
-        ti = bd_get_title_info(bd, i);
+        ti = bd_get_title_info(bd, i, 0);
         if (!ti)
             continue;
 
@@@@ -284,7 +286,7 @@@@ static int bluray_stream_open(stream_t *s, int mode,
            "ID_BLURAY_CURRENT_TITLE=%d\n", title + 1);
 
     /* Get current title information */
-    info = bd_get_title_info(bd, title);
+    info = bd_get_title_info(bd, title, 0);
     if (!info)
         goto err_no_info;
 
@

