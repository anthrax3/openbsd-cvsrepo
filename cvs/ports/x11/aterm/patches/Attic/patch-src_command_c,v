head	1.4;
access;
symbols
	OPENBSD_5_1_BASE:1.3
	OPENBSD_5_1:1.3.0.24
	OPENBSD_5_0:1.3.0.22
	OPENBSD_5_0_BASE:1.3
	OPENBSD_4_9:1.3.0.20
	OPENBSD_4_9_BASE:1.3
	OPENBSD_4_8:1.3.0.18
	OPENBSD_4_8_BASE:1.3
	OPENBSD_4_7:1.3.0.16
	OPENBSD_4_7_BASE:1.3
	OPENBSD_4_6:1.3.0.14
	OPENBSD_4_6_BASE:1.3
	OPENBSD_4_5:1.3.0.12
	OPENBSD_4_5_BASE:1.3
	OPENBSD_4_4:1.3.0.10
	OPENBSD_4_4_BASE:1.3
	OPENBSD_4_3:1.3.0.8
	OPENBSD_4_3_BASE:1.3
	OPENBSD_4_2:1.3.0.6
	OPENBSD_4_2_BASE:1.3
	OPENBSD_4_1:1.3.0.4
	OPENBSD_4_1_BASE:1.3
	OPENBSD_4_0:1.3.0.2
	OPENBSD_4_0_BASE:1.3
	OPENBSD_3_9:1.2.0.6
	OPENBSD_3_9_BASE:1.2
	OPENBSD_3_8:1.2.0.4
	OPENBSD_3_8_BASE:1.2
	OPENBSD_3_7:1.2.0.2
	OPENBSD_3_7_BASE:1.2
	OPENBSD_3_6:1.1.0.16
	OPENBSD_3_6_BASE:1.1
	OPENBSD_3_5:1.1.0.14
	OPENBSD_3_5_BASE:1.1
	OPENBSD_3_4:1.1.0.12
	OPENBSD_3_4_BASE:1.1
	OPENBSD_3_3:1.1.0.10
	OPENBSD_3_3_BASE:1.1
	OPENBSD_3_2:1.1.0.8
	OPENBSD_3_2_BASE:1.1
	OPENBSD_3_1:1.1.0.6
	OPENBSD_3_1_BASE:1.1
	OPENBSD_3_0:1.1.0.4
	OPENBSD_3_0_BASE:1.1
	OPENBSD_2_9_TRACKING_SWITCH:1.1
	OPENBSD_2_9:1.1.0.2
	OPENBSD_2_9_BASE:1.1;
locks; strict;
comment	@# @;


1.4
date	2012.04.26.19.18.08;	author jasper;	state dead;
branches;
next	1.3;

1.3
date	2006.03.22.20.17.40;	author uwe;	state Exp;
branches;
next	1.2;

1.2
date	2004.09.16.17.07.11;	author millert;	state Exp;
branches;
next	1.1;

1.1
date	2001.04.17.03.41.08;	author kevlo;	state Exp;
branches;
next	;


desc
@@


1.4
log
@Remove aterm, it's been unmaintained upstream since they've started working
on rxvt-unicode instead....about four years ago.

ok aja@@ dcoppa@@
@
text
@--- src/command.c.orig	Thu Sep  6 18:38:07 2001
+++ src/command.c	Wed Mar 22 21:09:34 2006
@@@@ -477,6 +477,16 @@@@ get_pty(void)
     ptydev = ttydev = _getpty(&fd, O_RDWR | O_NDELAY, 0622, 0);
     if (ptydev == NULL)
 	goto Failed;
+#elif defined (__OpenBSD__)
+    int sfd;
+    static char     tty_name[16];
+
+    ptydev = ttydev = tty_name;
+
+    if (openpty(&fd, &sfd, tty_name, NULL, NULL) < 0)
+	goto Failed;
+    close(sfd);
+
 #elif defined (__svr4__) || defined(__CYGWIN32__) || defined(__lnx21__)
     {
 	extern char    *ptsname();
@@@@ -759,6 +769,9 @@@@ debug_ttymode(ttymode_t * ttymode)
 #  ifdef VLNEXT
     FOO(VLNEXT, "VLNEXT");
 #  endif
+#  ifdef VSTATUS
+    FOO(VSTATUS, "VSTATUS");
+#  endif
     fprintf(stderr, "\n\n");
 #  undef FOO
 # endif				/* HAVE_TERMIOS_H */
@@@@ -799,6 +812,9 @@@@ get_ttymode(ttymode_t * tio)
 # ifdef VLNEXT
 	tio->c_cc[VLNEXT] = CLNEXT;
 # endif
+# ifdef VSTATUS
+	tio->c_cc[VSTATUS] = CSTATUS;
+# endif
     }
     tio->c_cc[VEOF] = CEOF;
     tio->c_cc[VEOL] = VDISABLE;
@@@@ -2148,11 +2164,23 @@@@ process_x_event(XEvent * ev)
     static int      bypass_keystate = 0;
     int             reportmode;
     static int      csrO = 0;	/* Hops - csr offset in thumb/slider      */
+#ifdef ZH
+    int             k_status;
+    char            kbuf[256];
+#endif
 
 /*        to give proper Scroll behaviour */
     switch (ev->type) {
     case KeyPress:
-	lookup_key(ev);
+#ifdef ZH
+	k_status = send_key(Xdisplay, TermWin.parent, &ev->xkey, kbuf);
+	if (!k_status)
+	     lookup_key(ev);
+        else if (kbuf[0])
+	    tt_write(kbuf, strlen(kbuf));
+#else
+	 lookup_key(ev);
+#endif
 	break;
 
     case ClientMessage:
@@@@ -2217,6 +2245,9 @@@@ process_x_event(XEvent * ev)
 
     case FocusIn:
 	if (!TermWin.focus) {
+#ifdef ZH
+	    send_FocusIn(Xdisplay, TermWin.parent);
+#endif
 	    TermWin.focus = 1;
 #ifdef OFF_FOCUS_FADING
 	    if( rs_fade != NULL )
@


1.3
log
@Don't forget to initialize the VSTATUS control character for the new pty
when stdin is not a terminal; Ok sturm@@ for a similar diff
@
text
@@


1.2
log
@Patch to use openpty().  OK pval@@, mcbride@@.
@
text
@d1 2
a2 2
--- src/command.c.orig	Thu Sep  6 10:38:07 2001
+++ src/command.c	Wed Sep 15 20:38:55 2004
d20 21
a40 1
@@@@ -2148,11 +2158,23 @@@@ process_x_event(XEvent * ev)
d65 1
a65 1
@@@@ -2217,6 +2239,9 @@@@ process_x_event(XEvent * ev)
@


1.1
log
@- support Big5 encoding with chinese/xcin
- integrate COMMENT
- bump NEED_VERSION
--
ok'd by maintainer
@
text
@d1 20
a20 3
--- src/command.c.orig	Tue Apr 17 10:27:59 2001
+++ src/command.c	Tue Apr 17 10:31:19 2001
@@@@ -2128,11 +2128,17 @@@@
d24 1
d27 1
d33 1
d39 3
d45 1
a45 1
@@@@ -2197,6 +2203,7 @@@@
d49 1
d51 1
@

