head	1.1;
access;
symbols
	OPENBSD_5_5:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2014.07.08.16.23.18;	author ajacoutot;	state dead;
branches
	1.1.2.1;
next	;
commitid	hxOtApKz6smzmg99;

1.1.2.1
date	2014.07.08.16.23.18;	author ajacoutot;	state Exp;
branches;
next	;
commitid	hxOtApKz6smzmg99;


desc
@@


1.1
log
@file patch-dbus_dbus-sysdeps_c was initially added on branch OPENBSD_5_5.
@
text
@@


1.1.2.1
log
@Merge security fixes for:
CVE-2014-3532
CVE-2014-3533
@
text
@a0 30
$OpenBSD$

From 9ca90648fc870c24d852ce6d7ce9387a9fc9a94a Mon Sep 17 00:00:00 2001
From: Alban Crequy <alban.crequy@@collabora.co.uk>
Date: Tue, 24 Jun 2014 16:57:14 +0000
Subject: Handle ETOOMANYREFS when sending recursive fds (SCM_RIGHTS)

--- dbus/dbus-sysdeps.c.orig	Tue Oct  8 19:40:40 2013
+++ dbus/dbus-sysdeps.c	Tue Jul  8 18:18:05 2014
@@@@ -762,6 +762,20 @@@@ _dbus_get_is_errno_epipe (void)
 }
 
 /**
+ * See if errno is ETOOMANYREFS
+ * @@returns #TRUE if errno == ETOOMANYREFS
+ */
+dbus_bool_t
+_dbus_get_is_errno_etoomanyrefs (void)
+{
+#ifdef ETOOMANYREFS
+  return errno == ETOOMANYREFS;
+#else
+  return FALSE;
+#endif
+}
+
+/**
  * Get error message from errno
  * @@returns _dbus_strerror(errno)
  */
@

