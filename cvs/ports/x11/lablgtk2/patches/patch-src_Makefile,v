head	1.6;
access;
symbols
	OPENBSD_6_2:1.6.0.12
	OPENBSD_6_2_BASE:1.6
	OPENBSD_6_1:1.6.0.10
	OPENBSD_6_1_BASE:1.6
	OPENBSD_6_0:1.6.0.8
	OPENBSD_6_0_BASE:1.6
	OPENBSD_5_9:1.6.0.4
	OPENBSD_5_9_BASE:1.6
	OPENBSD_5_8:1.6.0.6
	OPENBSD_5_8_BASE:1.6
	OPENBSD_5_7:1.6.0.2
	OPENBSD_5_7_BASE:1.6
	OPENBSD_5_6:1.5.0.4
	OPENBSD_5_6_BASE:1.5
	OPENBSD_5_5:1.5.0.2
	OPENBSD_5_5_BASE:1.5
	OPENBSD_5_4:1.3.0.4
	OPENBSD_5_4_BASE:1.3
	OPENBSD_5_3:1.3.0.2
	OPENBSD_5_3_BASE:1.3
	OPENBSD_5_2:1.1.1.1.0.14
	OPENBSD_5_2_BASE:1.1.1.1
	OPENBSD_5_1_BASE:1.1.1.1
	OPENBSD_5_1:1.1.1.1.0.12
	OPENBSD_5_0:1.1.1.1.0.10
	OPENBSD_5_0_BASE:1.1.1.1
	OPENBSD_4_9:1.1.1.1.0.8
	OPENBSD_4_9_BASE:1.1.1.1
	OPENBSD_4_8:1.1.1.1.0.6
	OPENBSD_4_8_BASE:1.1.1.1
	OPENBSD_4_7:1.1.1.1.0.4
	OPENBSD_4_7_BASE:1.1.1.1
	OPENBSD_4_6:1.1.1.1.0.2
	OPENBSD_4_6_BASE:1.1.1.1
	giovanni-20090528:1.1.1.1
	giovanni:1.1.1;
locks; strict;
comment	@# @;


1.6
date	2014.10.29.14.02.10;	author dcoppa;	state Exp;
branches;
next	1.5;
commitid	JO5E2OnVyvXLWpBj;

1.5
date	2013.12.03.07.15.45;	author dcoppa;	state Exp;
branches;
next	1.4;

1.4
date	2013.11.15.11.00.37;	author dcoppa;	state dead;
branches;
next	1.3;

1.3
date	2013.01.31.21.20.32;	author dcoppa;	state Exp;
branches;
next	1.2;

1.2
date	2012.10.09.09.22.24;	author dcoppa;	state Exp;
branches;
next	1.1;

1.1
date	2009.05.28.09.18.24;	author giovanni;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2009.05.28.09.18.24;	author giovanni;	state Exp;
branches;
next	;


desc
@@


1.6
log
@
Update to lablgtk2-2.18.3.

Patches by chrisz@@ have been merged upstream.
@
text
@$OpenBSD: patch-src_Makefile,v 1.5 2013/12/03 07:15:45 dcoppa Exp $
--- src/Makefile.orig	Wed Oct 29 08:51:06 2014
+++ src/Makefile	Wed Oct 29 14:54:08 2014
@@@@ -49,7 +49,7 @@@@ CUSTOM = -custom
 #MLLINK += -cclib -lcamlrund
 MLBYTEFLAGS = -g -dtypes
 else
-CFLAGS = -DG_DISABLE_ASSERT -DG_DISABLE_CAST_CHECKS $(GTKCFLAGS)
+CFLAGS += -DG_DISABLE_ASSERT -DG_DISABLE_CAST_CHECKS $(GTKCFLAGS)
 ifneq ($(TOOLCHAIN),msvc)
 CFLAGS += -O
 endif
@@@@ -64,7 +64,7 @@@@ endif
 THLINK = unix.cma threads.cma
 
 ifdef USE_CC
-CCOMPILER = $(CC) -c -I"$(LIBDIR)" $(CFLAGS)
+CCOMPILER = $(CC) -c -I"$(LIBDIR)" $(CFLAGS) -fPIC
 else
 CCOMPILER = $(CAMLC) -c -ccopt '$(CFLAGS)' -verbose
 endif
@


1.5
log
@Unbreak lablgtk2 on ppc.

A required patch hunk got removed by accident during the update to
2.18.0.

From Daniel Dickman, thanks!
@
text
@d1 4
a4 4
$OpenBSD: patch-src_Makefile,v 1.2 2012/10/09 09:22:24 dcoppa Exp $
--- src/Makefile.orig	Thu Aug 23 12:37:48 2012
+++ src/Makefile	Fri Aug 24 12:06:15 2012
@@@@ -48,7 +48,7 @@@@ CUSTOM = -custom
d13 1
a13 1
@@@@ -63,7 +63,7 @@@@ endif
@


1.4
log
@Update to lablgtk2-2.18.0.

Suggestion about @@comment'ing a bogus ld.conf file by giovanni@@
OK giovanni@@
@
text
@d1 1
a1 5
$OpenBSD: patch-src_Makefile,v 1.3 2013/01/31 21:20:32 dcoppa Exp $

Support DESTDIR with findlib-install; unbreak systraced builds
(adapted from upstream git 58e15c3a33ee747e3e58a2c9687f22234f0055b6)

d3 1
a3 1
+++ src/Makefile	Thu Jan 31 12:00:38 2013
a21 45
@@@@ -274,7 +274,7 @@@@ lablgtktop$(XE): $(MLLIBS) $(THOBJS) $(CONFIG)
 endif
 
 lablgtk2: Makefile $(CONFIG) lablgtk2.in
-	sed -e "s|@@INSTALLDIR@@|$(INSTALLDIR)|g" \
+	sed -e "s|@@INSTALLDIR@@|$(LABLGTKDIR)|g" \
 	    -e "s|@@LABLGLDIR@@|$(LABLGLDIR)|g" \
 	    -e "s|@@MLLIBS@@|$(MLLINK) $(MLLIBS)|g" \
 	    -e "s|@@INITOBJS@@|$(INITOBJS)|g" \
@@@@ -391,7 +391,9 @@@@ old-uninstall:
 # Install using ocamlfind
 findlib-install:
 	mkdir -p "$(BINDIR)"
-	ocamlfind install lablgtk2 ../META \
+	mkdir -p "$(DESTDIR)$(FINDLIBDIR)"
+	ocamlfind install -destdir "$(DESTDIR)$(FINDLIBDIR)" \
+    lablgtk2 ../META \
     build.ml \
     $(CLIBS) \
     $(ALLOBJS:.cmo=.cmi) $(EXTRA_OBJS:.cmo=.cmi) \
@@@@ -427,16 +429,19 @@@@ findlib-install:
       then \
         echo $(CLIBS:lib%$(XA)=dll%$(XA)) ; \
     fi`
-	$(RANLIB) $(CLIBS:%="`ocamlfind query lablgtk2 | tr -d '\r'`"/%)
-	@@if test -f lablgtk.cmxa; \
-	  then ($(RANLIB) $(MLLIBS:%.cma="`ocamlfind query lablgtk2 | tr -d '\r'`"/%$(XA)) $(EXTRA_MLLIBS:%.cma="`ocamlfind query lablgtk2 | tr -d '\r'`"/%$(XA)) ); fi
-	rm lablgtk2$(XB)
-	$(MAKE) INSTALLDIR=`ocamlfind query lablgtk2 | tr -d '\r'` lablgtk2$(XB)
+	rm -f lablgtk2
+	$(MAKE) lablgtk2 LABLGTKDIR="$(FINDLIBDIR)/lablgtk2"
 	cp lablgtk2$(XB) "$(BINDIR)"
 	if test -f lablgladecc$(XE); then \
 	  cp lablgladecc$(XE) "$(BINDIR)/lablgladecc2$(XE)"; \
 	fi
 	cp gdk_pixbuf_mlsource$(XE) "$(BINDIR)"
+	$(RANLIB) $(CLIBS:%=$(FLINSTALLDIR)/%)
+	@@if test -f lablgtk.cmxa; then \
+	  echo "Execute $(RANLIB) in $(FLINSTALLDIR)"; \
+	  $(RANLIB) $(MLLIBS:%.cma=$(FLINSTALLDIR)/%$(XA)) \
+		    $(EXTRA_MLLIBS:%.cma=$(FLINSTALLDIR)/%$(XA)) ; \
+	 fi
 
 findlib-uninstall:
 	ocamlfind remove lablgtk2
@


1.3
log
@Support DESTDIR with findlib-install (this unbreaks systraced builds)

adapted from upstream git 58e15c3a33ee747e3e58a2c9687f22234f0055b6

OK sthen@@, chrisz@@
@
text
@d1 1
a1 1
$OpenBSD: patch-src_Makefile,v 1.2 2012/10/09 09:22:24 dcoppa Exp $
@


1.2
log
@Update to lablgtk2-2.16.0

OK avsm@@
@
text
@d1 5
a5 1
$OpenBSD: patch-src_Makefile,v 1.1.1.1 2009/05/28 09:18:24 giovanni Exp $
d7 1
a7 1
+++ src/Makefile	Fri Aug 24 12:06:15 2012
d26 45
@


1.1
log
@Initial revision
@
text
@d1 4
a4 4
$OpenBSD: patch-src_Makefile,v 1.2 2007/02/18 07:15:06 pvalchev Exp $
--- src/Makefile.orig	Fri Dec 26 05:28:27 2008
+++ src/Makefile	Tue May 19 18:38:19 2009
@@@@ -46,7 +46,7 @@@@ CUSTOM = -custom
d13 1
a13 1
@@@@ -61,7 +61,7 @@@@ endif
@


1.1.1.1
log
@
Import lablgtk2, an Objective Caml interface to gtk+2
ok on previous diff avsm@@

LablGTK2 is an Objective Caml interface to gtk+2.

It uses the rich type system of Objective Caml 3 to provide a strongly
typed, yet very comfortable, object-oriented interface to gtk+2. This
is not that easy if you know the dynamic typing approach taken by
gtk+2.
@
text
@@
