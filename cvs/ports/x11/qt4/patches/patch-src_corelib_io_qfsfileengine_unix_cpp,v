head	1.16;
access;
symbols
	OPENBSD_6_0:1.16.0.18
	OPENBSD_6_0_BASE:1.16
	OPENBSD_5_9:1.16.0.14
	OPENBSD_5_9_BASE:1.16
	OPENBSD_5_8:1.16.0.16
	OPENBSD_5_8_BASE:1.16
	OPENBSD_5_7:1.16.0.12
	OPENBSD_5_7_BASE:1.16
	OPENBSD_5_6:1.16.0.10
	OPENBSD_5_6_BASE:1.16
	OPENBSD_5_5:1.16.0.8
	OPENBSD_5_5_BASE:1.16
	OPENBSD_5_4:1.16.0.6
	OPENBSD_5_4_BASE:1.16
	OPENBSD_5_3:1.16.0.4
	OPENBSD_5_3_BASE:1.16
	OPENBSD_5_2:1.16.0.2
	OPENBSD_5_2_BASE:1.16
	OPENBSD_5_1_BASE:1.15
	OPENBSD_5_1:1.15.0.8
	OPENBSD_5_0:1.15.0.6
	OPENBSD_5_0_BASE:1.15
	OPENBSD_4_9:1.15.0.4
	OPENBSD_4_9_BASE:1.15
	OPENBSD_4_8:1.15.0.2
	OPENBSD_4_8_BASE:1.15
	OPENBSD_4_7:1.13.0.2
	OPENBSD_4_7_BASE:1.13
	OPENBSD_4_6:1.12.0.2
	OPENBSD_4_6_BASE:1.12
	OPENBSD_4_5:1.10.0.2
	OPENBSD_4_5_BASE:1.10
	OPENBSD_4_4:1.9.0.2
	OPENBSD_4_4_BASE:1.9
	OPENBSD_4_3:1.8.0.2
	OPENBSD_4_3_BASE:1.8
	OPENBSD_4_2:1.6.0.2
	OPENBSD_4_2_BASE:1.6
	OPENBSD_4_1:1.3.0.2
	OPENBSD_4_1_BASE:1.3
	OPENBSD_4_0:1.1.0.2
	OPENBSD_4_0_BASE:1.1;
locks; strict;
comment	@# @;


1.16
date	2012.06.14.09.38.35;	author espie;	state Exp;
branches;
next	1.15;

1.15
date	2010.06.21.16.40.52;	author espie;	state Exp;
branches;
next	1.14;

1.14
date	2010.04.19.09.36.30;	author espie;	state Exp;
branches;
next	1.13;

1.13
date	2009.09.01.18.24.28;	author espie;	state Exp;
branches;
next	1.12;

1.12
date	2009.06.08.13.55.28;	author espie;	state Exp;
branches;
next	1.11;

1.11
date	2009.04.18.17.25.43;	author espie;	state Exp;
branches;
next	1.10;

1.10
date	2008.10.21.22.20.00;	author espie;	state Exp;
branches;
next	1.9;

1.9
date	2008.03.15.09.44.12;	author espie;	state Exp;
branches;
next	1.8;

1.8
date	2008.01.06.13.48.12;	author espie;	state Exp;
branches;
next	1.7;

1.7
date	2007.08.29.12.30.58;	author espie;	state Exp;
branches;
next	1.6;

1.6
date	2007.06.10.21.23.10;	author espie;	state Exp;
branches;
next	1.5;

1.5
date	2007.05.22.09.09.32;	author espie;	state dead;
branches;
next	1.4;

1.4
date	2007.03.17.17.58.17;	author espie;	state Exp;
branches;
next	1.3;

1.3
date	2006.12.06.08.32.44;	author espie;	state Exp;
branches;
next	1.2;

1.2
date	2006.10.08.21.43.50;	author espie;	state Exp;
branches;
next	1.1;

1.1
date	2006.06.04.09.37.43;	author espie;	state Exp;
branches;
next	;


desc
@@


1.16
log
@update to 4.8.2
- since we no longer have GCC3_ARCHES, simplify, no way it's gonna compile
on a GCC2_ARCH anyways (size matters)
- so, we have only SHARED_ONLY arches, remove those frags as well.
- fold back qt4-sqlite since sqlite is part of core now.
@
text
@$OpenBSD: patch-src_corelib_io_qfsfileengine_unix_cpp,v 1.15 2010/06/21 16:40:52 espie Exp $
--- src/corelib/io/qfsfileengine_unix.cpp.orig	Thu Apr 26 21:46:08 2012
+++ src/corelib/io/qfsfileengine_unix.cpp	Sun Jun 10 13:25:08 2012
@@@@ -489,7 +489,7 @@@@ qint64 QFSFileEnginePrivate::nativeRead(char *data, qi
                     int readByte = 0;
                     do {
                         readByte = fgetc(fh);
-                    } while (readByte == -1 && errno == EINTR);
+                    } while (readByte == EOF && !feof(fh) && errno == EINTR);
                     if (readByte != -1) {
                         *data = uchar(readByte);
                         readBytes += 1;
@


1.15
log
@minor update to 4.6.3
while there, clean up wantlibs.
- fix bug with new phonon (pick up ours and not it)
- fix a bug in qdbuscpp2xml (timeout)
- more patches for gcc3: sse code ICES, new demo doesn't compile.

spectrum not installed, seems to be macosX or something ? I can't get
a thing out of it.

Tested on gcc4 and gcc3...
@
text
@d1 4
a4 4
$OpenBSD: patch-src_corelib_io_qfsfileengine_unix_cpp,v 1.14 2010/04/19 09:36:30 espie Exp $
--- src/corelib/io/qfsfileengine_unix.cpp.orig	Wed Jun  2 04:03:17 2010
+++ src/corelib/io/qfsfileengine_unix.cpp	Mon Jun 21 11:32:32 2010
@@@@ -357,7 +357,7 @@@@ qint64 QFSFileEnginePrivate::nativeRead(char *data, qi
@


1.14
log
@update to 4.6.2. things work apart from eventsview...
@
text
@d1 4
a4 4
$OpenBSD: patch-src_corelib_io_qfsfileengine_unix_cpp,v 1.13 2009/09/01 18:24:28 espie Exp $
--- src/corelib/io/qfsfileengine_unix.cpp.orig	Thu Feb 11 16:55:23 2010
+++ src/corelib/io/qfsfileengine_unix.cpp	Mon Mar  8 13:27:03 2010
@@@@ -323,7 +323,7 @@@@ qint64 QFSFileEnginePrivate::nativeRead(char *data, qi
@


1.13
log
@4.5.2
@
text
@d1 4
a4 4
$OpenBSD: patch-src_corelib_io_qfsfileengine_unix_cpp,v 1.12 2009/06/08 13:55:28 espie Exp $
--- src/corelib/io/qfsfileengine_unix.cpp.orig	Sat Jun 20 06:57:57 2009
+++ src/corelib/io/qfsfileengine_unix.cpp	Sun Aug 30 15:55:35 2009
@@@@ -297,7 +297,7 @@@@ qint64 QFSFileEnginePrivate::nativeRead(char *data, qi
@


1.12
log
@update to 4.5.1, including gcc4 build.
fix packaging in that case, since I botched the "extended" WANTLIB
(if stuff comes from the main package, it *has* to be in LIB_DEPENDS,
because WANTLIB are checked at build time).
@
text
@d1 4
a4 4
$OpenBSD: patch-src_corelib_io_qfsfileengine_unix_cpp,v 1.11 2009/04/18 17:25:43 espie Exp $
--- src/corelib/io/qfsfileengine_unix.cpp.orig	Wed Apr 22 01:57:41 2009
+++ src/corelib/io/qfsfileengine_unix.cpp	Sun Jun  7 12:40:52 2009
@@@@ -299,7 +299,7 @@@@ qint64 QFSFileEnginePrivate::nativeRead(char *data, qi
@


1.11
log
@update to 4.5.0
(ready for a gcc4 switch to enable webkit)

notice -phonon got scraped, because it becomes too hard to keep phonon out
of main qt tools way (like assistant on top of qtconfig)
@
text
@d1 4
a4 4
$OpenBSD: patch-src_corelib_io_qfsfileengine_unix_cpp,v 1.10 2008/10/21 22:20:00 espie Exp $
--- src/corelib/io/qfsfileengine_unix.cpp.orig	Wed Feb 25 22:09:22 2009
+++ src/corelib/io/qfsfileengine_unix.cpp	Tue Mar  3 19:37:56 2009
@@@@ -281,7 +281,7 @@@@ qint64 QFSFileEnginePrivate::nativeRead(char *data, qi
@


1.10
log
@qt 4.4.3
@
text
@d1 4
a4 4
$OpenBSD: patch-src_corelib_io_qfsfileengine_unix_cpp,v 1.9 2008/03/15 09:44:12 espie Exp $
--- src/corelib/io/qfsfileengine_unix.cpp.orig	Sat Sep 27 10:58:47 2008
+++ src/corelib/io/qfsfileengine_unix.cpp	Mon Oct 20 14:57:36 2008
@@@@ -275,7 +275,7 @@@@ qint64 QFSFileEnginePrivate::nativeRead(char *data, qi
@


1.9
log
@minor update to 4.3.4
@
text
@d1 4
a4 4
$OpenBSD: patch-src_corelib_io_qfsfileengine_unix_cpp,v 1.8 2008/01/06 13:48:12 espie Exp $
--- src/corelib/io/qfsfileengine_unix.cpp.orig	Tue Feb 19 18:47:14 2008
+++ src/corelib/io/qfsfileengine_unix.cpp	Mon Mar  3 10:10:16 2008
@@@@ -253,7 +253,7 @@@@ qint64 QFSFileEnginePrivate::nativeRead(char *data, qi
@


1.8
log
@`minor' update, qt 4.3.3, everything depending on it still builds and works.
@
text
@d1 4
a4 4
$OpenBSD: patch-src_corelib_io_qfsfileengine_unix_cpp,v 1.7 2007/08/29 12:30:58 espie Exp $
--- src/corelib/io/qfsfileengine_unix.cpp.orig	Tue Dec  4 17:42:56 2007
+++ src/corelib/io/qfsfileengine_unix.cpp	Mon Dec 24 12:17:31 2007
@@@@ -246,7 +246,7 @@@@ qint64 QFSFileEnginePrivate::nativeRead(char *data, qi
@


1.7
log
@minor update to 4.3.1. Had this in my tree for a while, totally forgot about
it...
@
text
@d1 4
a4 4
$OpenBSD: patch-src_corelib_io_qfsfileengine_unix_cpp,v 1.6 2007/06/10 21:23:10 espie Exp $
--- src/corelib/io/qfsfileengine_unix.cpp.orig	Tue Aug  7 15:08:39 2007
+++ src/corelib/io/qfsfileengine_unix.cpp	Tue Aug 14 20:45:05 2007
@@@@ -248,7 +248,7 @@@@ qint64 QFSFileEnginePrivate::nativeRead(char *data, qi
@


1.6
log
@same bug as in 4.2.0.
@
text
@d1 4
a4 4
$OpenBSD$
--- src/corelib/io/qfsfileengine_unix.cpp.orig	Sun Jun 10 21:00:38 2007
+++ src/corelib/io/qfsfileengine_unix.cpp	Sun Jun 10 21:01:14 2007
@@@@ -233,7 +233,7 @@@@ qint64 QFSFileEnginePrivate::nativeRead(char *data, qi
@


1.5
log
@update to 4.3.0rc1.
@
text
@d1 12
a12 28
$OpenBSD: patch-src_corelib_io_qfsfileengine_unix_cpp,v 1.4 2007/03/17 17:58:17 espie Exp $
--- src/corelib/io/qfsfileengine_unix.cpp.orig	Wed Feb 21 10:58:42 2007
+++ src/corelib/io/qfsfileengine_unix.cpp	Sat Mar 17 10:47:27 2007
@@@@ -580,13 +580,13 @@@@ uint QFSFileEngine::ownerId(FileOwner own) const
 
 QString QFSFileEngine::owner(FileOwner own) const
 {
-#if !defined(QT_NO_THREAD) && defined(_POSIX_THREAD_SAFE_FUNCTIONS)
+#if !defined(QT_NO_THREAD) && defined(_POSIX_THREAD_SAFE_FUNCTIONS) && !defined(Q_OS_OPENBSD)
     QVarLengthArray<char, 1024> buf(sysconf(_SC_GETPW_R_SIZE_MAX));
 #endif
 
     if(own == OwnerUser) {
         struct passwd *pw = 0;
-#if !defined(QT_NO_THREAD) && defined(_POSIX_THREAD_SAFE_FUNCTIONS)
+#if !defined(QT_NO_THREAD) && defined(_POSIX_THREAD_SAFE_FUNCTIONS) && !defined(Q_OS_OPENBSD)
         struct passwd entry;
         getpwuid_r(ownerId(own), &entry, buf.data(), buf.size(), &pw);
 #else
@@@@ -596,7 +596,7 @@@@ QString QFSFileEngine::owner(FileOwner own) const
             return QFile::decodeName(QByteArray(pw->pw_name));
     } else if(own == OwnerGroup) {
         struct group *gr = 0;
-#if !defined(QT_NO_THREAD) && defined(_POSIX_THREAD_SAFE_FUNCTIONS)
+#if !defined(QT_NO_THREAD) && defined(_POSIX_THREAD_SAFE_FUNCTIONS) && !defined(Q_OS_OPENBSD)
         buf.resize(sysconf(_SC_GETGR_R_SIZE_MAX));
         struct group entry;
         getgrgid_r(ownerId(own), &entry, buf.data(), buf.size(), &gr);
@


1.4
log
@update to 4.2.3
@
text
@d1 1
a1 1
$OpenBSD: patch-src_corelib_io_qfsfileengine_unix_cpp,v 1.3 2006/12/06 08:32:44 espie Exp $
@


1.3
log
@maintainance update to 4.2.2, no binary interface change, improvements in
about all libraries -> minor bumps.
@
text
@d1 4
a4 4
$OpenBSD: patch-src_corelib_io_qfsfileengine_unix_cpp,v 1.2 2006/10/08 21:43:50 espie Exp $
--- src/corelib/io/qfsfileengine_unix.cpp.orig	Mon Nov 27 18:26:06 2006
+++ src/corelib/io/qfsfileengine_unix.cpp	Wed Dec  6 01:16:13 2006
@@@@ -580,13 +580,13 @@@@ uint QFSFileEngine::ownerId(FileOwner ow
d20 1
a20 1
@@@@ -596,7 +596,7 @@@@ QString QFSFileEngine::owner(FileOwner o
@


1.2
log
@qt 4.2.0, lots of improvements.
@
text
@d1 4
a4 4
$OpenBSD: patch-src_corelib_io_qfsfileengine_unix_cpp,v 1.1 2006/06/04 09:37:43 espie Exp $
--- src/corelib/io/qfsfileengine_unix.cpp.orig	Fri Sep 29 16:44:58 2006
+++ src/corelib/io/qfsfileengine_unix.cpp	Sat Oct  7 13:10:23 2006
@@@@ -575,13 +575,13 @@@@ uint QFSFileEngine::ownerId(FileOwner ow
d20 1
a20 1
@@@@ -591,7 +591,7 @@@@ QString QFSFileEngine::owner(FileOwner o
@


1.1
log
@qt 4.1.3
@
text
@d1 4
a4 4
$OpenBSD$
--- src/corelib/io/qfsfileengine_unix.cpp.orig	Mon May 22 12:22:02 2006
+++ src/corelib/io/qfsfileengine_unix.cpp	Mon May 22 12:25:43 2006
@@@@ -539,13 +539,13 @@@@ uint QFSFileEngine::ownerId(FileOwner ow
d20 1
a20 1
@@@@ -555,7 +555,7 @@@@ QString QFSFileEngine::owner(FileOwner o
@

