head	1.148;
access;
symbols
	OPENBSD_6_1:1.143.0.2
	OPENBSD_6_1_BASE:1.143
	OPENBSD_6_0:1.135.0.2
	OPENBSD_6_0_BASE:1.135
	OPENBSD_5_9:1.133.0.2
	OPENBSD_5_9_BASE:1.133
	OPENBSD_5_8:1.127.0.4
	OPENBSD_5_8_BASE:1.127
	OPENBSD_5_7:1.125.0.2
	OPENBSD_5_7_BASE:1.125
	OPENBSD_5_6:1.122.0.2
	OPENBSD_5_6_BASE:1.122
	OPENBSD_5_5:1.118.0.2
	OPENBSD_5_5_BASE:1.118
	OPENBSD_5_4:1.114.0.2
	OPENBSD_5_4_BASE:1.114
	OPENBSD_5_3:1.107.0.2
	OPENBSD_5_3_BASE:1.107
	OPENBSD_5_2:1.99.0.2
	OPENBSD_5_2_BASE:1.99
	OPENBSD_5_1_BASE:1.95
	OPENBSD_5_1:1.95.0.2
	OPENBSD_5_0:1.88.0.2
	OPENBSD_5_0_BASE:1.88
	OPENBSD_4_9:1.82.0.2
	OPENBSD_4_9_BASE:1.82
	OPENBSD_4_8:1.78.0.2
	OPENBSD_4_8_BASE:1.78
	OPENBSD_4_7:1.63.0.2
	OPENBSD_4_7_BASE:1.63
	OPENBSD_4_6:1.58.0.2
	OPENBSD_4_6_BASE:1.58
	OPENBSD_4_5:1.56.0.2
	OPENBSD_4_5_BASE:1.56
	OPENBSD_4_4:1.54.0.2
	OPENBSD_4_4_BASE:1.54
	OPENBSD_4_3:1.51.0.2
	OPENBSD_4_3_BASE:1.51
	OPENBSD_4_2:1.41.0.2
	OPENBSD_4_2_BASE:1.41
	OPENBSD_4_1:1.31.0.2
	OPENBSD_4_1_BASE:1.31
	OPENBSD_4_0:1.19.0.2
	OPENBSD_4_0_BASE:1.19
	OPENBSD_3_9:1.12.0.2
	OPENBSD_3_9_BASE:1.12
	OPENBSD_3_8:1.7.0.2
	OPENBSD_3_8_BASE:1.7
	espie:1.1.1.1
	trolltech:1.1.1;
locks; strict;
comment	@# @;


1.148
date	2017.08.25.12.30.17;	author naddy;	state Exp;
branches;
next	1.147;
commitid	C6AWGfM2N6OYiSEI;

1.147
date	2017.07.26.22.45.33;	author sthen;	state Exp;
branches;
next	1.146;
commitid	tD4MFrpYYDDL2UFT;

1.146
date	2017.07.16.19.19.06;	author espie;	state Exp;
branches;
next	1.145;
commitid	tt0GhWK5c4uf9ILG;

1.145
date	2017.04.19.11.16.03;	author sthen;	state Exp;
branches;
next	1.144;
commitid	RQY4uecaoLumt4eI;

1.144
date	2017.04.10.11.46.36;	author sthen;	state Exp;
branches;
next	1.143;
commitid	HY6VNZxjJWzKQFDV;

1.143
date	2017.03.03.14.02.15;	author espie;	state Exp;
branches;
next	1.142;
commitid	lXJHI3L9Ww4Vh1x0;

1.142
date	2017.02.01.13.56.12;	author sthen;	state Exp;
branches;
next	1.141;
commitid	cmmqGYJqKAlUgqe9;

1.141
date	2017.01.30.20.36.54;	author jca;	state Exp;
branches;
next	1.140;
commitid	NZts9OT18xB8ROoi;

1.140
date	2017.01.01.09.44.30;	author jca;	state Exp;
branches;
next	1.139;
commitid	bAqIwyLPvCJb6pCH;

1.139
date	2016.12.22.08.10.21;	author phessler;	state Exp;
branches;
next	1.138;
commitid	DEuLRkoZQUhHQKYs;

1.138
date	2016.11.07.09.46.29;	author dcoppa;	state Exp;
branches;
next	1.137;
commitid	pHjpN5TuAqTsRGS9;

1.137
date	2016.09.23.09.16.58;	author sthen;	state Exp;
branches;
next	1.136;
commitid	XLnI6AbHAmyVU5mO;

1.136
date	2016.09.06.09.00.19;	author dcoppa;	state Exp;
branches;
next	1.135;
commitid	SCXEv0HIjbx7iuA8;

1.135
date	2016.03.18.21.38.26;	author naddy;	state Exp;
branches;
next	1.134;
commitid	BVkebQSTXSZokeRG;

1.134
date	2016.03.08.13.32.24;	author zhuk;	state Exp;
branches;
next	1.133;
commitid	leVcRZjKxhZDeI3d;

1.133
date	2016.02.10.13.26.46;	author zhuk;	state Exp;
branches;
next	1.132;
commitid	xXj7De6JnZxlGcpY;

1.132
date	2016.02.10.13.12.23;	author zhuk;	state Exp;
branches;
next	1.131;
commitid	jcMsqr9vmJnYhFbU;

1.131
date	2016.01.06.17.17.32;	author zhuk;	state Exp;
branches;
next	1.130;
commitid	cNSdU4RpwcgaSAZD;

1.130
date	2015.10.05.16.29.02;	author sthen;	state Exp;
branches;
next	1.129;
commitid	AqjFzXOPaoxpieFE;

1.129
date	2015.09.17.12.24.41;	author dcoppa;	state Exp;
branches;
next	1.128;
commitid	Ow5BMo0nT8Lu9TE0;

1.128
date	2015.09.16.07.13.02;	author dcoppa;	state Exp;
branches;
next	1.127;
commitid	V2FDQcS06A2ugiP6;

1.127
date	2015.06.03.07.28.01;	author dcoppa;	state Exp;
branches;
next	1.126;
commitid	oaVrPQqHD3DHzE8M;

1.126
date	2015.05.13.14.03.07;	author kettenis;	state Exp;
branches;
next	1.125;
commitid	59ZxaOuEtI4xccDu;

1.125
date	2014.11.13.18.33.24;	author zhuk;	state Exp;
branches;
next	1.124;
commitid	qfUxrlKESVxj2zw2;

1.124
date	2014.09.13.18.09.22;	author brad;	state Exp;
branches;
next	1.123;
commitid	PpbRjVZdAmlrmi8q;

1.123
date	2014.08.18.18.29.08;	author landry;	state Exp;
branches;
next	1.122;
commitid	HHkseDb60LK2pSUM;

1.122
date	2014.07.12.11.10.14;	author dcoppa;	state Exp;
branches;
next	1.121;
commitid	u1HNNgYLVo9RYshW;

1.121
date	2014.05.26.19.24.28;	author naddy;	state Exp;
branches;
next	1.120;

1.120
date	2014.04.09.12.30.41;	author ajacoutot;	state Exp;
branches;
next	1.119;

1.119
date	2014.03.12.13.18.37;	author dcoppa;	state Exp;
branches;
next	1.118;

1.118
date	2013.11.25.14.16.24;	author sthen;	state Exp;
branches
	1.118.2.1;
next	1.117;

1.117
date	2013.11.15.10.52.24;	author dcoppa;	state Exp;
branches;
next	1.116;

1.116
date	2013.10.24.08.39.14;	author sthen;	state Exp;
branches;
next	1.115;

1.115
date	2013.10.04.13.15.39;	author dcoppa;	state Exp;
branches;
next	1.114;

1.114
date	2013.06.12.20.36.34;	author brad;	state Exp;
branches
	1.114.2.1;
next	1.113;

1.113
date	2013.06.04.18.42.00;	author naddy;	state Exp;
branches;
next	1.112;

1.112
date	2013.05.25.00.33.11;	author brad;	state Exp;
branches;
next	1.111;

1.111
date	2013.04.27.15.42.15;	author sthen;	state Exp;
branches;
next	1.110;

1.110
date	2013.03.15.17.01.31;	author landry;	state Exp;
branches;
next	1.109;

1.109
date	2013.03.11.11.46.15;	author espie;	state Exp;
branches;
next	1.108;

1.108
date	2013.03.08.18.12.38;	author zhuk;	state Exp;
branches;
next	1.107;

1.107
date	2013.01.19.11.08.09;	author espie;	state Exp;
branches;
next	1.106;

1.106
date	2013.01.03.15.48.42;	author espie;	state Exp;
branches;
next	1.105;

1.105
date	2012.11.05.16.29.50;	author landry;	state Exp;
branches;
next	1.104;

1.104
date	2012.10.11.01.18.09;	author sthen;	state Exp;
branches;
next	1.103;

1.103
date	2012.09.30.20.27.50;	author naddy;	state Exp;
branches;
next	1.102;

1.102
date	2012.09.06.12.38.35;	author ajacoutot;	state Exp;
branches;
next	1.101;

1.101
date	2012.09.01.14.37.00;	author ajacoutot;	state Exp;
branches;
next	1.100;

1.100
date	2012.08.04.15.07.24;	author ajacoutot;	state Exp;
branches;
next	1.99;

1.99
date	2012.06.14.09.38.35;	author espie;	state Exp;
branches;
next	1.98;

1.98
date	2012.05.20.10.39.00;	author ajacoutot;	state Exp;
branches;
next	1.97;

1.97
date	2012.04.23.17.15.19;	author espie;	state Exp;
branches;
next	1.96;

1.96
date	2012.03.29.13.39.01;	author sthen;	state Exp;
branches;
next	1.95;

1.95
date	2011.12.26.15.51.55;	author kili;	state Exp;
branches;
next	1.94;

1.94
date	2011.11.07.08.23.39;	author espie;	state Exp;
branches;
next	1.93;

1.93
date	2011.11.06.12.44.04;	author espie;	state Exp;
branches;
next	1.92;

1.92
date	2011.10.02.07.03.11;	author espie;	state Exp;
branches;
next	1.91;

1.91
date	2011.09.19.22.27.35;	author espie;	state Exp;
branches;
next	1.90;

1.90
date	2011.09.16.12.29.17;	author espie;	state Exp;
branches;
next	1.89;

1.89
date	2011.09.07.09.54.07;	author espie;	state Exp;
branches;
next	1.88;

1.88
date	2011.07.09.10.59.35;	author espie;	state Exp;
branches;
next	1.87;

1.87
date	2011.07.08.05.04.21;	author ajacoutot;	state Exp;
branches;
next	1.86;

1.86
date	2011.07.07.00.22.37;	author ajacoutot;	state Exp;
branches;
next	1.85;

1.85
date	2011.05.17.08.26.53;	author dcoppa;	state Exp;
branches;
next	1.84;

1.84
date	2011.04.15.16.13.23;	author ajacoutot;	state Exp;
branches;
next	1.83;

1.83
date	2011.04.03.13.35.30;	author dcoppa;	state Exp;
branches;
next	1.82;

1.82
date	2010.11.22.08.37.04;	author espie;	state Exp;
branches;
next	1.81;

1.81
date	2010.10.28.14.55.47;	author espie;	state Exp;
branches;
next	1.80;

1.80
date	2010.10.24.21.15.34;	author ajacoutot;	state Exp;
branches;
next	1.79;

1.79
date	2010.09.28.09.09.15;	author jasper;	state Exp;
branches;
next	1.78;

1.78
date	2010.07.30.12.57.18;	author landry;	state Exp;
branches;
next	1.77;

1.77
date	2010.07.30.12.03.09;	author ajacoutot;	state Exp;
branches;
next	1.76;

1.76
date	2010.07.30.06.59.00;	author ajacoutot;	state Exp;
branches;
next	1.75;

1.75
date	2010.07.09.18.48.22;	author naddy;	state Exp;
branches;
next	1.74;

1.74
date	2010.06.21.16.40.52;	author espie;	state Exp;
branches;
next	1.73;

1.73
date	2010.06.15.21.27.57;	author landry;	state Exp;
branches;
next	1.72;

1.72
date	2010.05.26.11.34.13;	author dcoppa;	state Exp;
branches;
next	1.71;

1.71
date	2010.05.25.11.00.56;	author espie;	state Exp;
branches;
next	1.70;

1.70
date	2010.05.23.10.36.49;	author espie;	state Exp;
branches;
next	1.69;

1.69
date	2010.05.13.12.05.35;	author landry;	state Exp;
branches;
next	1.68;

1.68
date	2010.05.09.18.38.08;	author espie;	state Exp;
branches;
next	1.67;

1.67
date	2010.04.25.19.03.30;	author espie;	state Exp;
branches;
next	1.66;

1.66
date	2010.04.24.22.36.49;	author espie;	state Exp;
branches;
next	1.65;

1.65
date	2010.04.19.09.36.30;	author espie;	state Exp;
branches;
next	1.64;

1.64
date	2010.04.05.09.54.35;	author landry;	state Exp;
branches;
next	1.63;

1.63
date	2009.10.15.14.30.07;	author espie;	state Exp;
branches;
next	1.62;

1.62
date	2009.10.13.10.39.41;	author espie;	state Exp;
branches;
next	1.61;

1.61
date	2009.10.12.22.11.48;	author espie;	state Exp;
branches;
next	1.60;

1.60
date	2009.10.11.09.43.08;	author espie;	state Exp;
branches;
next	1.59;

1.59
date	2009.09.01.18.24.28;	author espie;	state Exp;
branches;
next	1.58;

1.58
date	2009.06.08.13.55.28;	author espie;	state Exp;
branches;
next	1.57;

1.57
date	2009.04.18.17.25.43;	author espie;	state Exp;
branches;
next	1.56;

1.56
date	2008.11.17.15.05.24;	author espie;	state Exp;
branches;
next	1.55;

1.55
date	2008.10.21.22.19.59;	author espie;	state Exp;
branches;
next	1.54;

1.54
date	2008.06.26.00.42.15;	author merdely;	state Exp;
branches;
next	1.53;

1.53
date	2008.06.02.10.33.33;	author espie;	state Exp;
branches;
next	1.52;

1.52
date	2008.03.15.09.44.12;	author espie;	state Exp;
branches;
next	1.51;

1.51
date	2008.01.28.19.09.04;	author espie;	state Exp;
branches;
next	1.50;

1.50
date	2008.01.27.05.01.37;	author espie;	state Exp;
branches;
next	1.49;

1.49
date	2008.01.26.20.01.22;	author espie;	state Exp;
branches;
next	1.48;

1.48
date	2008.01.26.18.46.36;	author espie;	state Exp;
branches;
next	1.47;

1.47
date	2008.01.06.13.48.12;	author espie;	state Exp;
branches;
next	1.46;

1.46
date	2008.01.04.17.48.38;	author espie;	state Exp;
branches;
next	1.45;

1.45
date	2007.12.11.08.00.06;	author jakemsr;	state Exp;
branches;
next	1.44;

1.44
date	2007.10.25.09.30.22;	author wilfried;	state Exp;
branches;
next	1.43;

1.43
date	2007.10.22.15.36.59;	author espie;	state Exp;
branches;
next	1.42;

1.42
date	2007.08.29.12.30.58;	author espie;	state Exp;
branches;
next	1.41;

1.41
date	2007.06.10.21.23.10;	author espie;	state Exp;
branches;
next	1.40;

1.40
date	2007.06.09.23.13.09;	author espie;	state Exp;
branches;
next	1.39;

1.39
date	2007.06.02.08.27.36;	author espie;	state Exp;
branches;
next	1.38;

1.38
date	2007.05.22.09.09.32;	author espie;	state Exp;
branches;
next	1.37;

1.37
date	2007.05.17.23.54.24;	author espie;	state Exp;
branches;
next	1.36;

1.36
date	2007.04.03.21.05.51;	author espie;	state Exp;
branches;
next	1.35;

1.35
date	2007.03.31.23.10.18;	author espie;	state Exp;
branches;
next	1.34;

1.34
date	2007.03.26.21.22.13;	author espie;	state Exp;
branches;
next	1.33;

1.33
date	2007.03.17.17.58.16;	author espie;	state Exp;
branches;
next	1.32;

1.32
date	2007.03.17.11.51.58;	author steven;	state Exp;
branches;
next	1.31;

1.31
date	2007.02.25.17.31.04;	author espie;	state Exp;
branches
	1.31.2.1;
next	1.30;

1.30
date	2007.02.24.11.23.49;	author espie;	state Exp;
branches;
next	1.29;

1.29
date	2007.01.29.09.51.28;	author espie;	state Exp;
branches;
next	1.28;

1.28
date	2006.12.29.23.22.51;	author espie;	state Exp;
branches;
next	1.27;

1.27
date	2006.12.06.08.32.44;	author espie;	state Exp;
branches;
next	1.26;

1.26
date	2006.11.25.18.35.45;	author espie;	state Exp;
branches;
next	1.25;

1.25
date	2006.11.21.22.40.31;	author espie;	state Exp;
branches;
next	1.24;

1.24
date	2006.11.21.19.25.47;	author espie;	state Exp;
branches;
next	1.23;

1.23
date	2006.11.07.09.27.37;	author alek;	state Exp;
branches;
next	1.22;

1.22
date	2006.10.30.18.17.32;	author espie;	state Exp;
branches;
next	1.21;

1.21
date	2006.10.08.21.43.50;	author espie;	state Exp;
branches;
next	1.20;

1.20
date	2006.09.18.10.21.48;	author espie;	state Exp;
branches;
next	1.19;

1.19
date	2006.08.08.16.17.54;	author steven;	state Exp;
branches
	1.19.2.1;
next	1.18;

1.18
date	2006.06.04.09.37.43;	author espie;	state Exp;
branches;
next	1.17;

1.17
date	2006.05.15.21.09.39;	author espie;	state Exp;
branches;
next	1.16;

1.16
date	2006.05.14.08.57.48;	author bernd;	state Exp;
branches;
next	1.15;

1.15
date	2006.04.06.09.35.46;	author steven;	state Exp;
branches;
next	1.14;

1.14
date	2006.04.01.12.32.56;	author espie;	state Exp;
branches;
next	1.13;

1.13
date	2006.03.05.21.58.07;	author espie;	state Exp;
branches;
next	1.12;

1.12
date	2006.01.13.19.18.50;	author espie;	state Exp;
branches
	1.12.2.1;
next	1.11;

1.11
date	2006.01.07.11.22.53;	author espie;	state Exp;
branches;
next	1.10;

1.10
date	2005.12.31.15.59.50;	author espie;	state Exp;
branches;
next	1.9;

1.9
date	2005.09.19.20.40.16;	author espie;	state Exp;
branches;
next	1.8;

1.8
date	2005.09.05.14.57.06;	author espie;	state Exp;
branches;
next	1.7;

1.7
date	2005.08.17.21.06.48;	author sturm;	state Exp;
branches;
next	1.6;

1.6
date	2005.07.05.17.44.46;	author espie;	state Exp;
branches;
next	1.5;

1.5
date	2005.07.04.21.44.04;	author espie;	state Exp;
branches;
next	1.4;

1.4
date	2005.07.04.21.23.06;	author espie;	state Exp;
branches;
next	1.3;

1.3
date	2005.07.04.21.16.18;	author espie;	state Exp;
branches;
next	1.2;

1.2
date	2005.07.04.11.32.50;	author espie;	state Exp;
branches;
next	1.1;

1.1
date	2005.07.04.11.10.13;	author espie;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2005.07.04.11.10.13;	author espie;	state Exp;
branches;
next	;

1.12.2.1
date	2007.04.06.11.35.29;	author sturm;	state Exp;
branches;
next	;

1.19.2.1
date	2007.04.06.11.15.29;	author sturm;	state Exp;
branches;
next	;

1.31.2.1
date	2007.05.01.16.27.48;	author sturm;	state Exp;
branches;
next	;

1.114.2.1
date	2014.03.14.07.53.21;	author jasper;	state Exp;
branches;
next	;

1.118.2.1
date	2014.03.14.07.56.59;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.148
log
@bump; textproc/icu4c now uses multi-packages for -wwwdata
@
text
@# $OpenBSD: Makefile,v 1.147 2017/07/26 22:45:33 sthen Exp $

USE_WXNEEDED =		Yes # QtWebKit

ONLY_FOR_ARCHS =	${GCC4_ARCHS} ${CLANG_ARCHS}
BROKEN-hppa =	libQtWebKit.so.3.0: undefined reference to __sync_sub_and_fetch_4

USE_GMAKE =		Yes
COMMENT-debug =		C++ GUI toolkit, debug
COMMENT-main =		C++ X11 GUI toolkit
COMMENT-examples =	examples for qt4
COMMENT-html =		off-line html documentation for qt4
COMMENT-postgresql =	PostgresSQL plugin for qt4
COMMENT-mysql =		MySQL plugin for qt4
COMMENT-sqlite2 =	sqlite2 plugin for qt4
COMMENT-tds =		tds plugin for qt4

PKGNAME =		qt4-${PKGVERSION}
PKGNAME-mysql =		qt4-mysql-${PKGVERSION}
PKGNAME-postgresql =	qt4-postgresql-${PKGVERSION}
PKGNAME-examples =	qt4-examples-${PKGVERSION}
PKGNAME-sqlite2 =	qt4-sqlite2-${PKGVERSION}
PKGNAME-tds =		qt4-tds-${PKGVERSION}
PKGNAME-main =		qt4-${PKGVERSION}
PKGNAME-debug =		qt4-debug-${PKGVERSION}
FULLPKGNAME-html =	qt4-html-${PKGVERSION}
FULLPKGPATH-html =	${BASE_PKGPATH},-html
REVISION-main =		13
REVISION-mysql =	1
REVISION-postgresql =	1
REVISION-sqlite2 =	1
REVISION-tds =		1
REVISION-debug =	0
REVISION-examples =	2
REVISION-html =		0

# XXX qmake include parser is bogus
DPB_PROPERTIES =	parallel	nojunk

SHARED_LIBS =	Qt3Support 8.0 \
		QtCore 9.0 \
		QtDesigner 7.0 \
		QtDesignerComponents 7.0 \
		QtGui 10.1 \
		QtNetwork 10.0 \
		QtOpenGL 7.0 \
		QtSql 8.0 \
		QtXml 8.0 \
		QtSvg 7.0 \
		QtTest 7.0 \
		QtDBus 2.0 \
		QtMultimedia 0.0 \
		QtScript 2.0 \
		QtCLucene 0.0 \
		QtHelp 1.0 \
		QtXmlPatterns 0.0 \
		QtScriptTools 0.0 \
		QtWebKit 4.0 \
		phonon 4.1 \
		QtDeclarative 0.0


VERSION =	4.8.7
PKGVERSION =	4.8.7
DISTNAME =	qt-everywhere-opensource-src-${VERSION}

CATEGORIES =	x11
MASTER_SITES =  http://download.qt.io/official_releases/qt/4.8/${VERSION}/

HOMEPAGE =	http://www.qt.io/

MAINTAINER =	Marc Espie <espie@@openbsd.org>

FLAVORS =	debug
FLAVOR ?=

# GPLv3, or LGPL.
# (GPLv2 not needed, since LGPL is more free)
PERMIT_PACKAGE_CDROM =	Yes

MAKE_ENV =	QTDIR="${WRKDIST}" EXTRA_SAMPLES="${EXTRA_SAMPLES}" \
		SYS_CXX="${CXX}" SYS_CXXFLAGS="${CXXFLAGS}" \
		LD_LIBRARY_PATH="${WRKDIST}/lib"

# For qsettings to write its setup
PORTHOME =	${WRKDIST}

CONFIGURE_STYLE =	simple
SEPARATE_BUILD =	Yes
CONFIGURE_ARGS =	-system-libpng -system-libjpeg -system-zlib \
			-sm -system-sqlite \
			-v -stl -xrender -fast \
			-no-sql-odbc \
			-xinput \
			-xinerama \
			-iconv \
			-cups \
			-confirm-license \
			-opensource \
			-I${X11BASE}/include/freetype2 \
			-I${X11BASE}/include \
			-L${WRKBUILD}/lib \
			-L${X11BASE}/lib

CONFIGURE_ARGS +=	-prefix ${QT_BASEDIR}
CONFIGURE_ARGS +=	-libdir ${QT_BASEDIR}
CONFIGURE_ARGS +=	-bindir ${QT_BINDIR}
CONFIGURE_ARGS +=	-headerdir ${QT_INCDIR}
CONFIGURE_ARGS +=	-docdir ${QT_DOC}
CONFIGURE_ARGS +=	-plugindir ${QT_PLUGINSDIR}
CONFIGURE_ARGS +=	-datadir ${QT_BASEDIR}
CONFIGURE_ARGS +=	-sysconfdir ${SYSCONFDIR}
CONFIGURE_ARGS +=	-examplesdir ${QT_BASEDIR}/examples
CONFIGURE_ARGS +=	-demosdir ${QT_BASEDIR}/demos
CONFIGURE_ARGS +=	-no-separate-debug-info

CONFIGURE_ARGS +=	-I${LOCALBASE}/include/mysql -L${LOCALBASE}/lib/mysql \
			-plugin-sql-mysql
CONFIGURE_ARGS +=	-I${LOCALBASE}/include/postgresql \
			-I${LOCALBASE}/include/postgresql/server \
			-plugin-sql-psql
CONFIGURE_ARGS +=	-platform openbsd-g++4

# XXX make sure those libraries gets written to libQtGui.la
QMAKE_LIBS_GUI =	freetype SM ICE Xi Xrender Xinerama fontconfig Xext X11

CONFIGURE_ENV =		LOCALBASE=${LOCALBASE} QTDIR="${WRKSRC}" \
			X11BASE=${X11BASE} QMAKE_LIBS_GUI="${QMAKE_LIBS_GUI:C/^/-l/}"
.if defined(MAKE_JOBS)
CONFIGURE_ENV +=	BOOTSTRAP_MAKE_FLAGS='-j${MAKE_JOBS}'
.endif

BUILD_DEPENDS +=	x11/dbus
BUILD_DEPENDS +=	x11/gtk+2
BUILD_DEPENDS +=	databases/postgresql,-server

# configure checks for cups support; no LIB/RUN_DEPENDS because libcups
# is only dlopen()ed if found
BUILD_DEPENDS +=	print/cups,-libs

MULTI_PACKAGES =	-main -examples \
			-html -mysql -postgresql -sqlite2 -tds

.if ${FLAVOR:Mdebug}
CONFIGURE_ARGS +=	-debug
MULTI_PACKAGES +=	-debug
.else
CONFIGURE_ARGS +=-release
.endif

.include <bsd.port.arch.mk>

MODULES =		devel/gettext gcc4

# for __sync_add_and_fetch_4, __sync_sub_and_fetch_4
MODGCC4_ARCHS =		arm
MODGCC4_LANGS =		c++

LIB_DEPENDS =
WANTLIB =
RUN_DEPENDS =

commonWANTLIB =		c pthread GL m ${COMPILER_LIBCXX}
commonWANTLIB+=		${WANTLIB}

sqlWANTLIB =		m lib/qt4/QtCore>=4 QtSql ${COMPILER_LIBCXX} pthread

RUN_DEPENDS-main=	${MODGETTEXT_RUN_DEPENDS}
LIB_DEPENDS-main =	${LIB_DEPENDS} \
			databases/sqlite3 \
			devel/glib2 \
			graphics/jpeg \
			graphics/libmng \
			multimedia/gstreamer-0.10/plugins-base \
			graphics/png
WANTLIB-main =		${commonWANTLIB} jpeg mng \
			lcms tiff gobject-2.0 gstvideo-0.10 \
			gstbase-0.10 gstreamer-0.10 xml2 \
			gobject-2.0 gmodule-2.0 gstinterfaces-0.10 \
			${MODGETTEXT_WANTLIB} glib-2.0 gthread-2.0 \
			gstaudio-0.10 ICE SM X11>=10 Xext Xi Xinerama \
			Xrender fontconfig freetype png>=2 z \
			sqlite3
# QtNetwork dlopen()s ssl libs.
WANTLIB-main +=		ssl crypto

# dlopen'd icui18n in src/corelib/tools/qlocale_icu.cpp
RUN_DEPENDS-main +=	textproc/icu4c

LIB_DEPENDS-mysql =	${BUILD_PKGPATH} \
			databases/mariadb
WANTLIB-mysql =		${sqlWANTLIB} \
			crypto ssl z mysqlclient_r


LIB_DEPENDS-postgresql =${BUILD_PKGPATH} \
			databases/postgresql
WANTLIB-postgresql =	${sqlWANTLIB}  pq


LIB_DEPENDS-sqlite2 =	${BUILD_PKGPATH} \
			databases/sqlite
WANTLIB-sqlite2 =	${sqlWANTLIB} sqlite


LIB_DEPENDS-tds =	${BUILD_PKGPATH} \
			databases/freetds
WANTLIB-tds =		${sqlWANTLIB} sybdb

LIB_DEPENDS-examples =	${BUILD_PKGPATH}
WANTLIB-examples =	${commonWANTLIB} lib/qt4/QtDesigner \
			lib/qt4/QtCore lib/qt4/QtGui lib/qt4/QtNetwork \
			lib/qt4/QtOpenGL lib/qt4/QtSql lib/qt4/QtXml \
			lib/qt4/QtSvg lib/qt4/QtTest \
			lib/qt4/QtDBus \
			lib/qt4/QtScript lib/qt4/QtScriptTools \
			lib/qt4/QtHelp lib/qt4/phonon \
			lib/qt4/QtMultimedia lib/qt4/QtDeclarative \
			lib/qt4/QtWebKit lib/qt4/QtXmlPatterns \
			ICE SM X11 Xext  Xi Xinerama Xrender fontconfig \
			freetype

LIB_DEPENDS-html =
WANTLIB-html =
RUN_DEPENDS-html =
PKG_ARCH-html =	*

QT_BASEDIR =	${PREFIX}/lib/qt4
QT_INCDIR =	${PREFIX}/include/X11/qt4
QT_EXAMPLES =	${QT_BASEDIR}/examples
QT_DOC =	${PREFIX}/share/doc/qt4
QT_PLUGINSDIR =	${QT_BASEDIR}/plugins
QT_BINDIR =	${QT_BASEDIR}/bin
QT_PKGCFGDIR =	${QT_BASEDIR}/pkgconfig

DOCS =	README

NO_TEST =	Yes

PROGRAMS4 =	assistant designer findtr lconvert linguist \
		lrelease lupdate moc qmake qtconfig uic uic3
PROGRAMS +=	pixeltool qdbus qt3to4 qtdemo rcc syncqt


QMAKE =		${WRKBUILD}/bin/qmake

MAKE_FLAGS +=	INSTALL_PROGRAM='${INSTALL_PROGRAM}' \
		INSTALL_FILE='${INSTALL_DATA}'
.for l v in $(SHARED_LIBS)
MAKE_FLAGS +=	LIB$l_VERSION=$v
.endfor

DESTDIRNAME =	INSTALL_ROOT

pre-patch:
	cd ${WRKDIST} && cp -R mkspecs/openbsd-g++ mkspecs/openbsd-g++4

post-build:
.for l v in ${SHARED_LIBS}
	-${SUBST_CMD} ${WRKBUILD}/lib/lib$l.la
.endfor

post-install:
	# extra doc
	cd ${WRKSRC}; ${INSTALL_DATA} ${DOCS} ${QT_DOC}
	# programs
	${INSTALL_PROGRAM_DIR} ${QT_BINDIR}
	${INSTALL_SCRIPT} ${WRKSRC}/bin/{findtr,syncqt} ${QT_BINDIR}
	${INSTALL_PROGRAM} ${WRKBUILD}/bin/qdoc3 ${QT_BINDIR}
.for p in ${PROGRAMS4}
	@@ln -sf ${TRUEPREFIX}/lib/qt4/bin/$p ${PREFIX}/bin/$p4
.endfor
	@@ln -sf assistant ${PREFIX}/lib/qt4/bin/assistant4
.for p in ${PROGRAMS}
	@@ln -sf ${TRUEPREFIX}/lib/qt4/bin/$p ${PREFIX}/bin/$p
.endfor
	# fix pkgconfig stuff
	@@for i in ${QT_PKGCFGDIR}/*.pc; do \
	    perl -pi.bak -e 's,-L${WRKBUILD}/lib,,g;' $$i; \
	    rm $$i.bak; \
	done
	@@sed -i -e s/"-lQtWebKit"/"-lQtWebKit -Wl,-z,wxneeded"/ \
		${QT_PKGCFGDIR}/QtWebKit.pc
	# this helps qdbuscpp2xml
	cd ${QT_BINDIR} && ln -sf moc moc4
.for l v in ${SHARED_LIBS}
	-test -f ${PREFIX}/lib/qt4/lib$l.so.$v && \
	    ln -sf qt4/lib$l.so.$v ${PREFIX}/lib
.endfor
# cleanup
	cd ${PREFIX}/lib/qt4 && ln -sf ../../include/X11/qt4 include

.include <bsd.port.mk>
@


1.147
log
@bump LIBCXX/LIBECXX/COMPILER_LIBCXX ports.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.146 2017/07/16 19:19:06 espie Exp $
d28 1
a28 1
REVISION-main =		12
@


1.146
log
@use COMPILER_LIBCXX where applicable
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.145 2017/04/19 11:16:03 sthen Exp $
d28 5
a32 5
REVISION-main =		11
REVISION-mysql =	0
REVISION-postgresql =	0
REVISION-sqlite2 =	0
REVISION-tds =		0
d34 2
a35 1
REVISION-examples =	1
@


1.145
log
@Add ${CLANG_ARCHS} to "ONLY_FOR_ARCHS = ${GCC4_ARCHS}" lines to give them
a chance on aarch64.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.144 2017/04/10 11:46:36 sthen Exp $
d162 1
a162 1
commonWANTLIB =		c pthread GL m ${LIBCXX}
d165 1
a165 1
sqlWANTLIB =		m lib/qt4/QtCore>=4 QtSql ${LIBCXX} pthread
@


1.144
log
@use LIBCXX
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.143 2017/03/03 14:02:15 espie Exp $
d5 1
a5 1
ONLY_FOR_ARCHS =	${GCC4_ARCHS}
@


1.143
log
@unhardcode gcc/g++
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.142 2017/02/01 13:56:12 sthen Exp $
d162 1
a162 1
commonWANTLIB =		c pthread GL m stdc++
d165 1
a165 1
sqlWANTLIB =		m lib/qt4/QtCore>=4 QtSql stdc++ pthread
@


1.142
log
@Record the dependency on libssl/libcrypto in WANTLIB-main. This would
have been missed previously listed because Qt likes to dlopen() things
so check-lib-depends can't find it, which would stop qt4 getting updated
when ssl/crypto libs are updated.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.141 2017/01/30 20:36:54 jca Exp $
d28 7
a34 2
REVISION-main =		10
REVISION-examples =	0
@


1.141
log
@Fix previous, correctly register estdc++ in per-subpackage WANTLIB
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.140 2017/01/01 09:44:30 jca Exp $
d28 1
a28 1
REVISION-main =		9
d178 2
@


1.140
log
@Unbreak on arm, use lang/gcc for atomic builtins.

May have drawbacks (stdc++/estdc++ mixed up).  ok espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.139 2016/12/22 08:10:21 phessler Exp $
d28 2
a29 1
REVISION-main =		8
d158 1
@


1.139
log
@these use atomics not currently available on arm
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.138 2016/11/07 09:46:29 dcoppa Exp $
a6 1
BROKEN-arm =	libQtWebKit.so.4.0: undefined reference to __sync_add_and_fetch_4
d146 5
a150 1
MODULES =		devel/gettext
@


1.138
log
@
$ file /usr/local/lib/qt4/bin/{findtr,syncqt}
/usr/local/lib/qt4/bin/findtr: a /usr/bin/perl -w script text executable
/usr/local/lib/qt4/bin/syncqt: a /usr/bin/perl -w script text executable

These are both perl scripts, so use INSTALL_SCRIPT instead of
INSTALL_PROGRAM.

While here: qt-project.org -> qt.io in some comments.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.137 2016/09/23 09:16:58 sthen Exp $
d7 1
@


1.137
log
@Cope with moving sqlite3 back to ports.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.136 2016/09/06 09:00:19 dcoppa Exp $
d254 1
a254 1
	${INSTALL_PROGRAM} ${WRKSRC}/bin/{findtr,syncqt} ${QT_BINDIR}
@


1.136
log
@
USE_WXNEEDED, add "-Wl,-z,wxneeded" to Qt5WebKit and QtWebKit
pkg-config files.

Similar commit to what was done to www/webkit, and www/webkitgtk4.

OK ajacoutot@@, landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.135 2016/03/18 21:38:26 naddy Exp $
d28 1
a28 1
REVISION-main =		7
d158 1
@


1.135
log
@remove SHARED_ONLY from simple ports that use the gettext or libiconv module
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.134 2016/03/08 13:32:24 zhuk Exp $
d28 1
a28 1
REVISION-main =		6
d267 2
@


1.134
log
@Don't write GNU make-style lines in makefiles, for variables not used
in OpenBSD at all. Unbreaks some not-yet-ported software.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.133 2016/02/10 13:26:46 zhuk Exp $
a3 1
SHARED_ONLY =		Yes
@


1.133
log
@It's always better to commit from the right tree. POLLOUT, not POLLHUP.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.132 2016/02/10 13:12:23 zhuk Exp $
d27 1
a27 1
REVISION-main =		5
@


1.132
log
@Fix stack smashing happening when Qt4-based program opens more than
FD_SETSIZE (1024 by default) file descriptors. This is often the case
for KDE4 apps when using libinotify as directory monitoring backend.

Positive feedback from deraadt@@, final okay sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.131 2016/01/06 17:17:32 zhuk Exp $
d27 1
a27 1
REVISION-main =		4
@


1.131
log
@Fix wrong fix (made by yours truly as well) for TLS protocol choosing.
It was the same story again: TLSv1_*_method() are TLSv1.0, not TLSv1.x.

Should fix problems landry@@ and sthen@@ (and likely others) were seeing.

Joint work with and final okay sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.130 2015/10/05 16:29:02 sthen Exp $
d27 1
a27 1
REVISION-main =		3
@


1.130
log
@REVISION bumps following the additional member in struct if_data,
to make sure packages get updated
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.129 2015/09/17 12:24:41 dcoppa Exp $
d27 1
a27 1
REVISION-main =		2
@


1.129
log
@
Fix libQtNetwork warnings following SSLv3 removal

OK sthen@@, zhuk@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.128 2015/09/16 07:13:02 dcoppa Exp $
d5 1
a5 1
BROKEN-hppa =	libQtWebKit.so.3.0: undefined reference to `__sync_sub_and_fetch_4'	
d27 1
a27 1
REVISION-main =		1
@


1.128
log
@
Add lconvert to ${PROGRAMS4}, so that a symlink:

/usr/local/bin/lconvert4 -> /usr/local/lib/qt4/bin/lconvert

is created.

Fixes a mail/trojita build failure spotted by ajacoutot.

lconvert was introduced with Qt-4.5, so we probably forgot to add
it to ${PROGRAMS4} at the time...

Tested in a bulk. OK ajacoutot@@, zhuk@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.127 2015/06/03 07:28:01 dcoppa Exp $
d27 1
a27 1
REVISION-main =		0
@


1.127
log
@
Bugfixing update to qt-4.8.7.
And use the new "qt.io" for HOMEPAGE / MASTER_SITES.

No fallout in a bulk build (ajacoutot@@)

OK espie@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.126 2015/05/13 14:03:07 kettenis Exp $
d27 1
d224 2
a225 2
PROGRAMS4 =	assistant designer findtr linguist lrelease lupdate moc qmake \
		qtconfig uic uic3
@


1.126
log
@On amd64 we need to make sure function calls in inline assembly code go
through the PLT, so do on OpenBSD what Linux and FreeBSD are already doing.

Fixes build with binutils 2.17 and fixes a potential runtime issue with
binutils 2.15.

ok espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.125 2014/11/13 18:33:24 zhuk Exp $
a26 3
REVISION-main =		1

REVISION-mysql =	0
d54 2
a55 2
VERSION =	4.8.6
PKGVERSION =	4.8.6
d59 1
a59 1
MASTER_SITES =  http://download.qt-project.org/official_releases/qt/4.8/${VERSION}/
d61 1
a61 1
HOMEPAGE =	http://qt-project.org/
a116 1
#QMAKE_LIBS_GUI =
@


1.125
log
@Disable SSLv3 by default in Qt4.

okay espie@@ (MAINTAINER), went through a couple of KDE4 builds.

This should been committed a while ago. Even more, I was thinking that this
patch *was* committed at Oct 22... It's probably better late than never.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.124 2014/09/13 18:09:22 brad Exp $
d27 1
a27 1
REVISION-main =		0
@


1.124
log
@Switch from using MySQL to using MariaDB attempt #2. MariaDB is a drop-in replacement.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.123 2014/08/18 18:29:08 landry Exp $
d27 1
d39 1
a39 1
		QtNetwork 9.1 \
d52 1
a52 1
		QtWebKit 3.0 \
@


1.123
log
@BROKEN-hppa =   libQtWebKit.so.3.0: undefined reference to `__sync_sub_and_fetch_4'

No point in trying to build it for days before seeing it failing horribly
because hppa/atomic ops/webkit... there might be an easy fix/workaround;
but right now hope is lost.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.122 2014/07/12 11:10:14 dcoppa Exp $
d28 2
d177 1
a177 1
			databases/mysql
@


1.122
log
@
Update qt4 to version 4.8.6.

OK espie@@, jasper@@, bcallah@@ some time ago
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.121 2014/05/26 19:24:28 naddy Exp $
d5 1
@


1.121
log
@Fix a GNU-ism in a sed expression that gets copied into generated Makefiles.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.120 2014/04/09 12:30:41 ajacoutot Exp $
a26 2
REVISION-main =		4

d53 2
a54 2
VERSION =	4.8.5
PKGVERSION =	4.8.5
a64 1
PSEUDO_FLAVORS =no_examples
a143 38
.if !${BUILD_PACKAGES:M-examples}
SUBTARGETS =		sub-tools-bootstrap \
			sub-moc \
			sub-rcc \
			sub-uic \
			sub-corelib \
			sub-xml \
			sub-network \
			sub-sql \
			sub-testlib \
			sub-dbus \
			sub-gui \
			sub-qt3support \
			sub-uic3 \
			sub-opengl \
			sub-xmlpatterns \
			sub-phonon \
			sub-multimedia \
			sub-svg \
			sub-script \
			sub-declarative \
			sub-javascriptcore \
			sub-webkit \
			sub-scripttools \
			sub-plugins \
			sub-imports \
			sub-webkitdeclarative \
			sub-tools \
			sub-translations

ALL_TARGET =		${SUBTARGETS}
INSTALL_TARGET =	${SUBTARGETS:S/$/-install_subtargets/} \
			install_htmldocs install_qchdocs install_docimages \
			install_qmake install_mkspecs
.else
PROGRAMS +=		qtdemo pixeltool
.endif

d225 1
a225 1
PROGRAMS +=	rcc qt3to4 syncqt qdbus
@


1.120
log
@Add textproc/icu4c to run_depends since it gets dlopen'd.

ok espie@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.119 2014/03/12 13:18:37 dcoppa Exp $
d27 1
a27 1
REVISION-main =		3
@


1.119
log
@
Fix for CVE-2013-4549: QXmlSimpleReader in Qt before 5.2 allows
context-dependent attackers to cause a denial of service (memory
consumption) via an XML Entity Expansion (XEE) attack

From upstream via Arch Linux

OK espie@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.118 2013/11/25 14:16:24 sthen Exp $
d27 1
a27 1
REVISION-main =		2
d211 2
@


1.118
log
@kill VMEM_WARNING
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.117 2013/11/15 10:52:24 dcoppa Exp $
d27 1
a27 1
REVISION-main =		1
@


1.118.2.1
log
@Fix for CVE-2013-4549: QXmlSimpleReader in Qt before 5.2 allows
context-dependent attackers to cause a denial of service (memory
consumption) via an XML Entity Expansion (XEE) attack.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.118 2013/11/25 14:16:24 sthen Exp $
d27 1
a27 1
REVISION-main =		2
@


1.117
log
@Revert "QTBUG-15319: fix shortcuts with secondary Xkb layout."

The change which attempted to fix QTBUG-15319 broke keyboard shortcuts
for non latin keyboard layouts.

This patch reverts QTBUG-15319 (f45cdeda8) since it caused a
regression.

From upstream via Arch Linux.

OK espie@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.116 2013/10/24 08:39:14 sthen Exp $
a259 1
VMEM_WARNING =	Yes
@


1.116
log
@Partially revert fix for CVE-2013-0254 which does not work with our
privilege-separated X and caused broken displays for applications using
qt frames, diff from dcoppa, okay espie.

(An alternative fix would be to disable shm support, i.e.
"CONFIGURE_ARGS += -no-mitshm", I'd prefer this but it would need further
testing).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.115 2013/10/04 13:15:39 dcoppa Exp $
d27 1
a27 1
REVISION-main =		0
@


1.115
log
@Maintenance update to qt-4.8.5 (plus three bugfixes from upstream
via Arch Linux).
Feedback from zhuk@@, espie@@, and Amit Kulkarni.
ABI/API compatibility analysis done with abi-compliance-checker.

ok espie@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.114 2013/06/12 20:36:34 brad Exp $
d26 2
@


1.114
log
@Revert back to using MySQL 5.1 for the time being. MariaDB 5.5 introduces
a new libmysqlclient non-blocking API which utilizes co-routines. The X86
specific GCC ASM co-routine support hid the fact that there was an issue.
The only fallback code so far is POSIX user contexts which OpenBSD does not
support.

Input from and Ok sthen@@ jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.113 2013/06/04 18:42:00 naddy Exp $
a26 8
REVISION-main=		7
REVISION-mysql=		3
REVISION-postgresql=	1
REVISION-examples=	0
REVISION-sqlite2=	1
REVISION-tds=		1
REVISION-debug=		0

d34 1
a34 1
		QtGui 10.0 \
d48 1
a48 1
		QtWebKit 2.0 \
d53 2
a54 2
VERSION =	4.8.2
PKGVERSION =	4.8.2
d58 1
a58 1
MASTER_SITES =  http://releases.qt-project.org/qt4/source/
d60 1
a60 1
HOMEPAGE =	http://qt.nokia.com/
@


1.114.2.1
log
@Fix for CVE-2013-4549: QXmlSimpleReader in Qt before 5.2 allows
context-dependent attackers to cause a denial of service (memory
consumption) via an XML Entity Expansion (XEE) attack.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.114 2013/06/12 20:36:34 brad Exp $
d27 1
a27 1
REVISION-main=		8
@


1.113
log
@the png headers are now directly under include/
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.112 2013/05/25 00:33:11 brad Exp $
d28 1
a28 1
REVISION-mysql=		2
d219 1
a219 1
			databases/mariadb
@


1.112
log
@Switch from using MySQL to using MariaDB. MariaDB is a drop-in replacement.


ok sthen aja
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.111 2013/04/27 15:42:15 sthen Exp $
a98 1
			-I${LOCALBASE}/include/libpng \
@


1.111
log
@As worked out by naddy, qt4 only builds gtk theme support if gtk+2
was present at configure time, so the build is non-deterministic.
(notably audio/musique build fails unless qt4 was built with gtk
theme support). Add gtk+2 as a build dep to avoid this. Sync WANTLIB
while there.  ok espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.110 2013/03/15 17:01:31 landry Exp $
d28 1
a28 1
REVISION-mysql=		1
d220 1
a220 1
			databases/mysql
@


1.110
log
@Fix moc/BOOST_JOIN breakage after boost 1.53 update, from Amit Kulkarni.

https://bugreports.qt-project.org/browse/QTBUG-22829
Unbreaks games/pokerth and cad/openscad.

ok espie@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.109 2013/03/11 11:46:15 espie Exp $
d27 3
a29 3
REVISION-main=		6
REVISION-mysql=		0
REVISION-postgresql=	0
d31 2
a32 2
REVISION-sqlite2=	0
REVISION-tds=		0
d58 1
a58 1
		QtDeclarative 0.0 
d71 1
a71 1
 
d88 1
a88 1
SEPARATE_BUILD = 	simple
d117 1
a117 1
CONFIGURE_ARGS += 	-I${LOCALBASE}/include/mysql -L${LOCALBASE}/lib/mysql \
d119 2
a120 2
CONFIGURE_ARGS += 	-I${LOCALBASE}/include/postgresql \
	    		-I${LOCALBASE}/include/postgresql/server \
d126 1
a126 1
#QMAKE_LIBS_GUI =	
d135 1
d155 1
a155 1
SUBTARGETS = 		sub-tools-bootstrap \
d200 1
a200 1
sqlWANTLIB =		m lib/qt4/QtCore>=4 QtSql stdc++
d215 1
a215 1
			Xrender expat fontconfig freetype png>=2 z \
d222 1
a222 1
			crypto ssl pthread z mysqlclient_r
d228 1
a228 1
			
d272 1
a272 1
PROGRAMS += 	rcc qt3to4 syncqt qdbus
d297 1
a297 1
	${INSTALL_PROGRAM_DIR} ${QT_BINDIR} 
d300 1
a300 1
.for p in ${PROGRAMS4} 
@


1.109
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.108 2013/03/08 18:12:38 zhuk Exp $
d27 1
a27 1
REVISION-main=		5
@


1.108
log
@Add /etc/ssl to the list of directories containing "system" CA certs,
allowing Qt4 (and thus KDE4) programs to use /etc/ssl/cert.pem.

okay @@espie
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.107 2013/01/19 11:08:09 espie Exp $
a78 3
PERMIT_PACKAGE_FTP =	Yes
PERMIT_DISTFILES_CDROM =Yes
PERMIT_DISTFILES_FTP =	Yes
d267 1
a267 1
NO_REGRESS =	Yes
@


1.107
log
@grr double define does nothing
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.106 2013/01/03 15:48:42 espie Exp $
d27 1
a27 1
REVISION-main=		4
@


1.106
log
@use new dpb annotation to work around bug in dependency scanners.
as discussed with dcoppa@@, sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.105 2012/11/05 16:29:50 landry Exp $
a65 1
DPB_PROPERTIES =parallel
@


1.105
log
@Fix QtWebkit on amd64. With the default 512Mb datasize ulimit, any app
using it crashes right away at startup, since it tries to preallocate
1Gb of memory.

From webkit's patch-Source_JavaScriptCore_jit_ExecutableAllocatorFixedVMPool_cpp
tested with mnemosyne & arora.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.104 2012/10/11 01:18:09 sthen Exp $
d34 3
@


1.104
log
@When dlopen()ing shared libraries for optional dependencies, Qt4 wants to
load a specific version of the library to avoid ABI breakages, however it uses
upstream shared lib versions which don't match those in our ports. This has
already been patched where it tries to open gtk+2/cups by removing the version
check. See ports@@ thread "UPDATE: kdiff3-0.9.97" where this was discussed with
fgsch, dcoppa, espie and myself, upshot is this isn't totally clean but isn't
really worse than what we had before and it fixes use of icu4c from Qt4.
This diff from fgsch, testing/ok by me, ok espie.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.103 2012/09/30 20:27:50 naddy Exp $
d27 1
a27 1
REVISION-main=		3
@


1.103
log
@mark for parallel building
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.102 2012/09/06 12:38:35 ajacoutot Exp $
d27 1
a27 1
REVISION-main=		2
@


1.102
log
@Bump after gstreamer-plugins-base subpackaging change.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.101 2012/09/01 14:37:00 ajacoutot Exp $
d63 1
@


1.101
log
@register-plist did not catch the devel/glib2 -main -> empty change.
espie asked me in such a nice way to fix this that I'm bumping all ports
that have a direct dependency on glib2.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.100 2012/08/04 15:07:24 ajacoutot Exp $
d27 1
a27 1
REVISION-main=		1
@


1.100
log
@Handle cups >= 1.6
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.99 2012/06/14 09:38:35 espie Exp $
d27 7
a33 1
REVISION-main=		0
@


1.99
log
@update to 4.8.2
- since we no longer have GCC3_ARCHES, simplify, no way it's gonna compile
on a GCC2_ARCH anyways (size matters)
- so, we have only SHARED_ONLY arches, remove those frags as well.
- fold back qt4-sqlite since sqlite is part of core now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.95 2011/12/26 15:51:55 kili Exp $
d27 1
a127 1
BUILD_DEPENDS +=	print/cups
d130 4
@


1.98
log
@Add missing _POSIX_THREAD_PRIORITY_SCHEDULING check.

from Brad
ok espie@@
@
text
@d1 4
a4 1
# $OpenBSD: Makefile,v 1.97 2012/04/23 17:15:19 espie Exp $
a13 1
COMMENT-sqlite =	sqlite plugin for qt4
d16 1
a16 1
PKGNAME =		qt4-${VERSION}
a20 1
PKGNAME-sqlite =	qt4-sqlite-${PKGVERSION}
d22 1
a22 1
PKGNAME-main =		qt4-${VERSION}
a26 10
REVISION-mysql =	0
REVISION-postgresql =	0
REVISION-examples =	0
REVISION-sqlite2 =	0
REVISION-sqlite =	1
REVISION-tds =		0
REVISION-main =		5
REVISION-debug =	0
REVISION-html =		0

d51 2
a52 2
VERSION =	4.7.4
PKGVERSION =	4.7.4
d56 1
a56 8
MASTER_SITES =	http://get.qt.nokia.com/qt/source/ \
		ftp://ftp.qt.nokia.com/qt/source/ \
		ftp://ftp.troll.no/qt/source/ \
		ftp://ftp.iasi.roedu.net/mirrors/ftp.trolltech.com/qt/source/ \
		ftp://ftp.ntua.gr/pub/X11/Qt/qt/source/ \
		ftp://ftp.tu-chemnitz.de/pub/Qt/qt/source/ \
		http://ftp.silug.org/pub/qt/source/

d81 2
a82 2
SEPARATE_BUILD = 	Yes
CONFIGURE_ARGS =	-qt-gif -system-libpng -system-libjpeg -system-zlib \
d88 1
d115 1
d132 1
a132 1
			-html -mysql -postgresql -sqlite2 -sqlite -tds
d134 1
a134 1
.if ${FLAVOR:L:Mdebug}
d187 1
a187 1
commonWANTLIB =		c GLU pthread GL m
d189 1
a189 1
sqlWANTLIB =		m lib/qt4/QtCore>=4 QtSql
d204 2
a205 1
			Xrender expat fontconfig freetype png>=2 z
a223 4
LIB_DEPENDS-sqlite =	${BUILD_PKGPATH}
WANTLIB-sqlite =	${sqlWANTLIB} sqlite3


d232 1
a232 1
			lib/qt4/QtSvg lib/qt4/QtTest lib/qt4/Qt3Support \
d236 4
a239 1
			lib/qt4/QtMultimedia lib/qt4/QtDeclarative
a244 13

.if ${COMPILER_VERSION:L:Mgcc4*}
CONFIGURE_ARGS +=	-platform openbsd-g++4
PKG_ARGS += 		-DGCC4=1
commonWANTLIB += 	stdc++
sqlWANTLIB += 		stdc++
WANTLIB-examples +=	lib/qt4/QtWebKit lib/qt4/QtXmlPatterns
WANTLIB-main += 	sqlite3
.else
PKG_ARGS += 		-DGCC4=0
.endif

commonWANTLIB += 	stdc++
@


1.97
log
@first pass at handling sqlite3 move
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.96 2012/03/29 13:39:01 sthen Exp $
d32 1
a32 1
REVISION-main =		4
@


1.96
log
@Change SEPARATE_BUILD=(concurrent|simple) to Yes; bsd.port.mk doesn't
make a distinction between these.  ok aja@@ dcoppa@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.95 2011/12/26 15:51:55 kili Exp $
d30 1
a30 1
REVISION-sqlite =	0
d32 1
a32 1
REVISION-main =		3
d237 1
a237 2
LIB_DEPENDS-sqlite =	${BUILD_PKGPATH} \
			databases/sqlite3
a265 1
LIB_DEPENDS-main += 	databases/sqlite3
@


1.95
log
@Don't silently pull in a dependency on pulseaudio.

I had a diff adding proper LIB_DEPENDS-* and WANTLIB- entries,
but espie@@ prefers to just disable pulseaudio support for now,
because he's working on a qt4 update.

ok espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.94 2011/11/07 08:23:39 espie Exp $
d97 1
a97 1
SEPARATE_BUILD = 	simple
@


1.94
log
@grr... forgot to add that one and cvs diff doesn't say a thing, of course.
as noticed by nigel and vadim...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.93 2011/11/06 12:44:04 espie Exp $
d32 1
a32 1
REVISION-main =		2
@


1.93
log
@tweak to create correct .la files for the qt libraries, and install them.
after a few iterations to fix various builds such as bacula.
work from Vadim Zhukov
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.92 2011/10/02 07:03:11 espie Exp $
d32 1
a32 1
REVISION-main =		1
@


1.92
log
@convert to bsd.port.arch.mk
use BUILD_PKGPATH now that it's usable for that.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.91 2011/09/19 22:27:35 espie Exp $
d32 1
a32 1
REVISION-main =		0
d131 4
d136 1
a136 1
			X11BASE=${X11BASE}
d305 5
@


1.91
log
@tarball rerolled, minor tweaks to documentation
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.90 2011/09/16 12:29:17 espie Exp $
d141 2
a142 1
MULTI_PACKAGES =	-main -html -mysql -postgresql -sqlite2 -sqlite -tds
d151 1
d153 1
a153 1
.if ${FLAVOR:L:Mno_examples}
a187 1
MULTI_PACKAGES +=	-examples
d217 1
a217 1
LIB_DEPENDS-mysql =	${BASE_PKGPATH} \
d223 1
a223 1
LIB_DEPENDS-postgresql =${BASE_PKGPATH} \
d228 1
a228 1
LIB_DEPENDS-sqlite2 =	${BASE_PKGPATH} \
d233 1
a233 1
LIB_DEPENDS-sqlite =	${BASE_PKGPATH} \
d238 1
a238 1
LIB_DEPENDS-tds =	${BASE_PKGPATH} \
d242 1
a242 1
LIB_DEPENDS-examples =	${BASE_PKGPATH}
a256 2
.include <bsd.own.mk>

d259 3
a261 4
PKG_ARGS += -DGCC4=1
commonWANTLIB += stdc++
sqlWANTLIB += stdc++
LIB_DEPENDS-examples +=	${BASE_PKGPATH}
d263 2
a264 2
LIB_DEPENDS-main += databases/sqlite3
WANTLIB-main += sqlite3
d266 1
a266 1
PKG_ARGS += -DGCC4=0
@


1.90
log
@normalize pkgpath
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.89 2011/09/07 09:54:07 espie Exp $
d34 1
@


1.89
log
@minor update to 4.7.4 (mostly bugfixes)
while there, clean up WANTLIBs
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.88 2011/07/09 10:59:35 espie Exp $
d26 8
a33 8
#REVISION-mysql =	0
#REVISION-postgresql =	0
#REVISION-examples =	0
#REVISION-sqlite2 =	0
#REVISION-sqlite =	0
#REVISION-tds =		0
#REVISION-main =	0
#REVISION-debug =	0
@


1.88
log
@fix it for real. Antoine, use PLIST_DB !
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.87 2011/07/08 05:04:21 ajacoutot Exp $
d26 8
a33 8
REVISION-mysql =	0
REVISION-postgresql =	0
REVISION-examples =	0
REVISION-sqlite2 =	0
REVISION-sqlite =	0
REVISION-tds =		1
REVISION-main =		0
REVISION-debug =	0
d59 2
a60 2
VERSION =	4.7.3
PKGVERSION =	4.7.3
d195 1
a195 4
commonWANTLIB =		ICE Xrender c GLU SM freetype pthread Xinerama \
			Xext GL Xi m X11>=10 z fontconfig \
			expat png>=2
commonLIB_DEPENDS =	graphics/png
a197 1
sqlLIB_DEPENDS = 	${BASE_PKGPATH}
d200 1
a200 1
LIB_DEPENDS-main =	${LIB_DEPENDS} ${commonLIB_DEPENDS} \
d204 3
a206 2
			multimedia/gstreamer-0.10/plugins-base
WANTLIB-main =		${WANTLIB} ${commonWANTLIB} jpeg mng \
d210 3
a212 1
			${MODGETTEXT_WANTLIB} glib-2.0 gthread-2.0 gstaudio-0.10
d215 1
a215 1
LIB_DEPENDS-mysql =	${sqlLIB_DEPENDS} \
d217 1
a217 1
WANTLIB-mysql =		${WANTLIB} ${sqlWANTLIB} \
d221 1
a221 1
LIB_DEPENDS-postgresql =${sqlLIB_DEPENDS} \
d223 1
a223 1
WANTLIB-postgresql =	${WANTLIB} ${sqlWANTLIB}  pq
d226 1
a226 1
LIB_DEPENDS-sqlite2 =	${sqlLIB_DEPENDS} \
d228 1
a228 1
WANTLIB-sqlite2 =	${WANTLIB} ${sqlWANTLIB} sqlite
d231 1
a231 1
LIB_DEPENDS-sqlite =	${sqlLIB_DEPENDS} \
d233 1
a233 1
WANTLIB-sqlite =	${WANTLIB} ${sqlWANTLIB} sqlite3
d236 1
a236 1
LIB_DEPENDS-tds =	${sqlLIB_DEPENDS} \
d238 1
a238 1
WANTLIB-tds =		${WANTLIB} ${sqlWANTLIB} sybdb
d240 2
a241 3
LIB_DEPENDS-examples =	${commonLIB_DEPENDS} \
			${BASE_PKGPATH}
WANTLIB-examples =	${WANTLIB} ${commonWANTLIB} lib/qt4/QtDesigner \
d247 1
a247 1
			lib/qt4/QtHelp lib/qt4/QtCLucene lib/qt4/phonon \
d260 2
a261 1
WANTLIB += stdc++
d263 1
a263 1
WANTLIB-examples +=	sqlite3 lib/qt4/QtWebKit lib/qt4/QtXmlPatterns
@


1.87
log
@Unbreak, spotted by Nigel Taylor.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.86 2011/07/07 00:22:37 ajacoutot Exp $
d254 1
@


1.86
log
@Use the gettext MODULE
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.85 2011/05/17 08:26:53 dcoppa Exp $
d31 1
a31 1
PKGNAME-tds =		1
@


1.85
log
@Bugfixing update to qt4-4.7.3.

Unbreak the no_examples PSEUDO_FLAVOR.

Use the recommended dist site to provide for faster and more localized
downloads (from Brad).

Tested in a bulk build by landry@@
OK landry@@, sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.84 2011/04/15 16:13:23 ajacoutot Exp $
d26 9
a34 1
REVISION-tds =		0
d189 1
d193 1
d203 1
a203 1

d213 1
a213 1
			iconv intl glib-2.0 gthread-2.0 gstaudio-0.10
d216 1
a216 1
LIB_DEPENDS-mysql =	${LIB_DEPENDS} ${sqlLIB_DEPENDS} \
d222 1
a222 1
LIB_DEPENDS-postgresql =${LIB_DEPENDS} ${sqlLIB_DEPENDS} \
d227 1
a227 1
LIB_DEPENDS-sqlite2 =	${LIB_DEPENDS} ${sqlLIB_DEPENDS} \
d232 1
a232 1
LIB_DEPENDS-sqlite =	${LIB_DEPENDS} ${sqlLIB_DEPENDS} \
d237 1
a237 1
LIB_DEPENDS-tds =	${LIB_DEPENDS} ${sqlLIB_DEPENDS} \
d241 1
a241 1
LIB_DEPENDS-examples =	${LIB_DEPENDS} ${commonLIB_DEPENDS} \
@


1.84
log
@Fix build after gnutls update.

ok jasper@@ landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.83 2011/04/03 13:35:30 dcoppa Exp $
d33 1
a33 1
		QtNetwork 9.0 \
d51 2
a52 2
VERSION =	4.7.2
PKGVERSION =	4.7.2
d56 2
a57 1
MASTER_SITES =	ftp://ftp.qt.nokia.com/qt/source/ \
a149 1
			sub-gui \
a150 1
			sub-script \
d152 2
a154 1
			sub-dbus \
d159 1
d161 4
d167 2
d170 1
a170 1
			sub-tools-qdoc3
@


1.83
log
@Bug-fix update to qt-4.7.2.

Tested in a bulk build by landry@@
OK espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.82 2010/11/22 08:37:04 espie Exp $
d25 2
@


1.82
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.81 2010/10/28 14:55:47 espie Exp $
d44 1
a44 1
		QtWebKit 1.0 \
d49 2
a50 2
VERSION =	4.7.0
PKGVERSION =	4.7.0
@


1.81
log
@qt 4.7.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.80 2010/10/24 21:15:34 ajacoutot Exp $
d125 3
a127 3
BUILD_DEPENDS +=	::print/cups
BUILD_DEPENDS +=	::x11/dbus
BUILD_DEPENDS +=	::databases/postgresql,-server
d177 3
a179 3
			Xext GL Xi m X11.>=10 z fontconfig \
			expat png.>=2
commonLIB_DEPENDS =	::graphics/png
d181 2
a182 2
sqlWANTLIB =		m lib/qt4/QtCore.>=4 QtSql
sqlLIB_DEPENDS = 	::${BASE_PKGPATH}
d186 4
a189 4
			::devel/glib2 \
			::graphics/jpeg \
			::graphics/libmng \
			::multimedia/gstreamer-0.10/plugins-base
d198 1
a198 1
			::databases/mysql
d204 1
a204 1
			::databases/postgresql
d209 1
a209 1
			::databases/sqlite
d214 1
a214 1
			::databases/sqlite3
d219 1
a219 1
			::databases/freetds
d223 1
a223 1
			::${BASE_PKGPATH}
d243 1
a243 1
LIB_DEPENDS-examples +=	::${BASE_PKGPATH}
d245 1
a245 1
LIB_DEPENDS-main += ::databases/sqlite3
@


1.80
log
@Remove USE_X11.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.79 2010/09/28 09:09:15 jasper Exp $
a25 8
REVISION-mysql =	3
REVISION-postgresql =	3
REVISION-examples =	3
REVISION-sqlite2 =	3
REVISION-sqlite =	3	
REVISION-tds =		3
REVISION-main = 	3

d27 1
a27 1
		QtCore 8.0 \
d30 2
a31 2
		QtGui 9.0 \
		QtNetwork 8.0 \
a36 1
		QtAssistantClient 3.0 \
d39 1
a39 1
		QtScript 1.0 \
d45 2
a46 1
		phonon 4.1
d49 2
a50 2
VERSION =	4.6.3
PKGVERSION =	4.6.3
d178 2
a179 2
			expat
commonLIB_DEPENDS =	png.>=2::graphics/png
d181 2
a182 2
sqlWANTLIB =		m
sqlLIB_DEPENDS = 	QtCore.>=4,QtSql::${BASE_PKGPATH}
d228 1
a228 1
			lib/qt4/QtAssistantClient lib/qt4/QtDBus \
d231 1
a231 1
			lib/qt4/QtMultimedia
d244 1
a244 1
WANTLIB-examples +=	sqlite3 QtWebKit QtXmlPatterns
@


1.79
log
@- bump after gcc4 switch of mips64
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.78 2010/07/30 12:57:18 landry Exp $
a84 1
USE_X11 =	Yes
@


1.78
log
@qt4 now builds fine on hppa with gcc4, remove CXXFLAGS+=-finline-limit=60
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.77 2010/07/30 12:03:09 ajacoutot Exp $
d26 7
a32 7
REVISION-mysql =	2
REVISION-postgresql =	2
REVISION-examples =	2
REVISION-sqlite2 =	2
REVISION-sqlite =	2	
REVISION-tds =		2
REVISION-main = 	2
@


1.77
log
@Move to new DEPENDS.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.76 2010/07/30 06:59:00 ajacoutot Exp $
d26 7
a32 7
REVISION-mysql =	1
REVISION-postgresql =	1
REVISION-examples =	1
REVISION-sqlite2 =	1
REVISION-sqlite =	1
REVISION-tds =		1
REVISION-main = 	1
a131 6
.endif

# fix to avoid gcc generating a huge uncompilable intermediate assembly
.if ${MACHINE_ARCH} == "hppa"
CXXFLAGS +=		-finline-limit=60
CONFIGURE_ENV +=	OPENSOURCE_CXXFLAGS="${CXXFLAGS}"
@


1.76
log
@First pass at new REVISION/DEPENDS... not finished yet.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.75 2010/07/09 18:48:22 naddy Exp $
d26 7
a32 7
REVISION-mysql =	0
REVISION-postgresql =	0
REVISION-examples =	0
REVISION-sqlite2 =	0
REVISION-sqlite =	0
REVISION-tds =		0
REVISION-main = 	0
d201 6
a206 6
			glib-2.0,gthread-2.0::devel/glib2 \
			jpeg::graphics/jpeg \
			mng::graphics/libmng \
			gstaudio-0.10,gstinterfaces-0.10,gstvideo-0.10::multimedia/gstreamer-0.10/plugins-base
WANTLIB-main =		${WANTLIB} ${commonWANTLIB} \
			lcms tiff gobject-2.0 \
d208 2
a209 2
			gobject-2.0 gmodule-2.0 \
			iconv intl
d213 1
a213 1
			mysqlclient_r::databases/mysql
d215 1
a215 1
			crypto ssl pthread z
d219 2
a220 2
			pq.>=2:postgresql-client-*:databases/postgresql
WANTLIB-postgresql =	${WANTLIB} ${sqlWANTLIB} 
d224 2
a225 2
			sqlite::databases/sqlite
WANTLIB-sqlite2 =	${WANTLIB} ${sqlWANTLIB}
d229 2
a230 2
			sqlite3::databases/sqlite3
WANTLIB-sqlite =	${WANTLIB} ${sqlWANTLIB}
d234 2
a235 2
			sybdb::databases/freetds
WANTLIB-tds =		${WANTLIB} ${sqlWANTLIB}
d238 9
a246 3
			lib/qt4/QtDesigner,lib/qt4/QtCore.>=4,lib/qt4/QtGui,lib/qt4/QtNetwork,lib/qt4/QtOpenGL,lib/qt4/QtSql,lib/qt4/QtXml,lib/qt4/QtSvg,lib/qt4/QtTest,lib/qt4/Qt3Support,lib/qt4/QtAssistantClient,lib/qt4/QtDBus,lib/qt4/QtScript,lib/qt4/QtScriptTools,lib/qt4/QtHelp,lib/qt4/QtCLucene,lib/qt4/phonon,lib/qt4/QtMultimedia::${BASE_PKGPATH}
WANTLIB-examples =	${WANTLIB} ${commonWANTLIB}

d258 4
a261 3
LIB_DEPENDS-examples +=	QtWebKit,QtXmlPatterns::${BASE_PKGPATH}
WANTLIB-examples +=	sqlite3
LIB_DEPENDS-main += sqlite3::databases/sqlite3
@


1.75
log
@bump for plist changes due to gcc3->gcc4 transition
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.74 2010/06/21 16:40:52 espie Exp $
d15 7
a21 7
PKGNAME-mysql =		qt4-mysql-${PKGVERSION}p0
PKGNAME-postgresql =	qt4-postgresql-${PKGVERSION}p0
PKGNAME-examples =	qt4-examples-${PKGVERSION}p0
PKGNAME-sqlite2 =	qt4-sqlite2-${PKGVERSION}p0
PKGNAME-sqlite =	qt4-sqlite-${PKGVERSION}p0
PKGNAME-tds =		qt4-tds-${PKGVERSION}p0
PKGNAME-main =		qt4-${VERSION}p0
d25 8
@


1.74
log
@minor update to 4.6.3
while there, clean up wantlibs.
- fix bug with new phonon (pick up ours and not it)
- fix a bug in qdbuscpp2xml (timeout)
- more patches for gcc3: sse code ICES, new demo doesn't compile.

spectrum not installed, seems to be macosX or something ? I can't get
a thing out of it.

Tested on gcc4 and gcc3...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.73 2010/06/15 21:27:57 landry Exp $
d15 7
a21 7
PKGNAME-mysql =		qt4-mysql-${PKGVERSION}
PKGNAME-postgresql =	qt4-postgresql-${PKGVERSION}
PKGNAME-examples =	qt4-examples-${PKGVERSION}
PKGNAME-sqlite2 =	qt4-sqlite2-${PKGVERSION}
PKGNAME-sqlite =	qt4-sqlite-${PKGVERSION}
PKGNAME-tds =		qt4-tds-${PKGVERSION}
PKGNAME-main =		qt4-${VERSION}
@


1.73
log
@Fix Qt4 build on sparc64 with two patches from pkgsrc in qtwebkit part.
ok espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.72 2010/05/26 11:34:13 dcoppa Exp $
d21 2
a22 2
PKGNAME-main =		qt4-${VERSION}p3
PKGNAME-debug =		qt4-debug-${PKGVERSION}p0
d49 2
a50 2
VERSION =	4.6.2
PKGVERSION =	4.6.2
a52 1

d61 1
d180 2
a181 2
LIB_DEPENDS =		glib-2.0,gthread-2.0::devel/glib2
WANTLIB =		iconv intl
d188 1
a188 1
sqlWANTLIB =		m z
d193 1
d198 1
a198 1
			lcms tiff gobject-2.0 Xrandr \
d200 2
a201 1
			gobject-2.0 gmodule-2.0 
d207 1
a207 1
			crypto ssl pthread
d230 2
a231 2
			QtDesigner,QtCore.>=4,QtGui,QtNetwork,QtOpenGL,QtSql,QtXml,QtSvg,QtTest,Qt3Support,QtAssistantClient,QtDBus,QtScript,QtScriptTools,QtHelp,QtCLucene,phonon,QtMultimedia::${BASE_PKGPATH}
WANTLIB-examples =	${WANTLIB} ${commonWANTLIB} gobject-2.0 Xrandr
d243 1
@


1.72
log
@Unbreak QGtkStyle

OK espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.71 2010/05/25 11:00:56 espie Exp $
d21 1
a21 1
PKGNAME-main =		qt4-${VERSION}p2
@


1.71
log
@don't deref "not found" result. (bump main pkgname)
this fixes qdoc3 segfaulting at end of qtcreator build
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.70 2010/05/23 10:36:49 espie Exp $
d21 1
a21 1
PKGNAME-main =		qt4-${VERSION}p1
@


1.70
log
@misc fixes
- for gcc4, insist on -fno-wrapv, since it breaks things.
- use atomic builtins as they are available (on i386 at least)
- remove a few reasons why gmake is required (but not all)
- pass MAKE_JOBS to configure step.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.69 2010/05/13 12:05:35 landry Exp $
d21 1
a21 1
PKGNAME-main =		qt4-${VERSION}p0
@


1.69
log
@When setting -finline-limit=60 on hppa, don't override CXXFLAGS but
append to it instead. Noticed by sthen@@ ages ago, ok espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.68 2010/05/09 18:38:08 espie Exp $
d3 1
d21 2
a22 2
PKGNAME-main =		qt4-${VERSION}
PKGNAME-debug =		qt4-debug-${PKGVERSION}
d122 3
a235 5
MODULES =
#MODULES += gcc4
#MODGCC4_ARCHES = *
#MODGCC4_LANGS =	c++

d238 2
a239 3
COMPILER_VERSION ?= gcc3

.if ${MODULES:Mgcc4} || ${COMPILER_VERSION:L:Mgcc4*}
d246 2
a248 1
.endif
d278 3
a307 2

USE_GMAKE =	Yes
@


1.68
log
@make it auto-switch to the GCC4 fragment
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.67 2010/04/25 19:03:30 espie Exp $
d124 2
a125 2
CXXFLAGS =		-finline-limit=60
CONFIGURE_ENV +=	OPENSOURCE_CXXFLAGS=${CXXFLAGS}
@


1.67
log
@oops, if QtWebKit is not around, we don't want to create the link.
but we also don't want to error out (noticed by kili@@).

zap dup QtMultimedia (brad)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.66 2010/04/24 22:36:49 espie Exp $
d237 5
a241 1
.if ${MODULES:Mgcc4}
@


1.66
log
@unfuck fuck-up so that it packages with fucking g++4
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.65 2010/04/19 09:36:30 espie Exp $
a41 1
		QtMultimedia 0.0 \
d297 1
a297 1
	test -f ${PREFIX}/lib/qt4/lib$l.so.$v && \
@


1.65
log
@update to 4.6.2. things work apart from eventsview...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.64 2010/04/05 09:54:35 landry Exp $
d242 1
a242 1
WANTLIB-main += sqlite3
d298 2
a299 1
	ln -sf qt4/lib$l.so.$v ${PREFIX}/lib
@


1.64
log
@Add -finline-limit=60 to CXXFLAGS to allow this beast to build on hppa.
ok espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.63 2009/10/15 14:30:07 espie Exp $
d20 1
a20 1
PKGNAME-main =		qt4-${VERSION}p0
d26 1
a26 1
		QtCore 7.0 \
d29 2
a30 2
		QtGui 8.0 \
		QtNetwork 7.0 \
d32 2
a33 2
		QtSql 7.0 \
		QtXml 7.0 \
d37 3
a39 2
		QtDBus 1.0 \
		QtScript 0.0 \
d41 2
a42 1
		QtHelp 0.0 \
d45 1
a45 1
		QtWebKit 0.0 \
d49 3
a51 3
VERSION =	4.5.3
PKGVERSION =	4.5.3
DISTNAME =	qt-x11-opensource-src-${VERSION}
d55 1
a55 1
MASTER_SITES =	ftp://ftp.qtsoftware.com/qt/source/ \
d62 1
a62 1
HOMEPAGE =	http://www.qtsoftware.com/
d225 1
a225 1
			QtDesigner,QtCore.>=4,QtGui,QtNetwork,QtOpenGL,QtSql,QtXml,QtSvg,QtTest,Qt3Support,QtAssistantClient,QtDBus,QtScript,QtScriptTools,QtHelp,QtCLucene,phonon::${BASE_PKGPATH}
d282 1
a282 1
	${INSTALL_PROGRAM} ${WRKBUILD}/tools/qdoc3/qdoc3 ${QT_BINDIR}
@


1.63
log
@install qdoc3, qt-creator uses it, but leave it deep inside the qt4
dir, so it's not used by mistake.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62 2009/10/13 10:39:41 espie Exp $
d120 6
@


1.62
log
@more small changes, no_examples should jizz okay now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.61 2009/10/12 22:11:48 espie Exp $
d20 1
a20 1
PKGNAME-main =		qt4-${PKGVERSION}
d274 1
@


1.61
log
@the tralala needs to touch the bootstrap too.
noticed by Antoine "Gunther" Jacoutot.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.60 2009/10/11 09:43:08 espie Exp $
d154 1
d161 2
a162 2
			install_htmldocs install_translations install_qmake \
			install_mkspecs
@


1.60
log
@minor update to 4.5.3, some patches folded upstring.
Diff was painful to look at, mainly because nokia added their (c) notice
all over the place...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59 2009/09/01 18:24:28 espie Exp $
d136 2
a137 1
SUBTARGETS = 		sub-moc \
@


1.59
log
@4.5.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2009/06/08 13:55:28 espie Exp $
d47 2
a48 2
VERSION =	4.5.2
PKGVERSION =	4.5.2
d171 1
a171 1
			stdc++ Xext GL Xi m X11.>=10 z fontconfig \
d235 1
@


1.58
log
@update to 4.5.1, including gcc4 build.
fix packaging in that case, since I botched the "extended" WANTLIB
(if stuff comes from the main package, it *has* to be in LIB_DEPENDS,
because WANTLIB are checked at build time).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.57 2009/04/18 17:25:43 espie Exp $
d47 2
a48 2
VERSION =	4.5.1
PKGVERSION =	4.5.1
@


1.57
log
@update to 4.5.0
(ready for a gcc4 switch to enable webkit)

notice -phonon got scraped, because it becomes too hard to keep phonon out
of main qt tools way (like assistant on top of qtconfig)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2008/11/17 15:05:24 espie Exp $
d47 2
a48 2
VERSION =	4.5.0
PKGVERSION =	4.5.0
d53 2
a54 1
MASTER_SITES =	ftp://ftp.troll.no/qt/source/ \
d60 1
a60 1
HOMEPAGE =	http://www.trolltech.com/qt/
d93 1
d225 1
a225 1
#MODGCC4_ARCHES =*
d230 3
a232 2
WANTLIB-examples +=	QtWebKit sqlite3 QtXmlPatterns
WANTLIB-main =+ sqlite3
@


1.56
log
@fix build issue when lucene is installed, by relying on "system dir"
LOCALBASE being included after the build stuff.

I would like to do the same with X11BASE, but this does not work yet:
problem has been reported to the trolls.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55 2008/10/21 22:19:59 espie Exp $
d11 1
a11 1
COMMENT-phonon =	qt4 multimedia
d19 2
a20 1
PKGNAME-main =		qt4-${PKGVERSION}p0
a21 1
PKGNAME-phonon =	qt4-phonon-${PKGVERSION}
d42 2
d47 2
a48 2
VERSION =	4.4.3
PKGVERSION =	4.4.3
d67 2
a68 2
# GPL, plus more exceptions to link with other free licences.
# or QPL
d88 1
a88 1
			-tablet \
d120 1
d123 1
a123 1
MULTI_PACKAGES =	-main -html -mysql -postgresql -sqlite2 -sqlite -phonon
d139 1
a141 2
			sub-network \
			sub-svg \
d143 1
a143 1
			sub-opengl \
d145 1
d147 4
d152 3
a154 1
			sub-tools
d168 3
a170 3
commonWANTLIB =		ICE Xrender c GLU SM freetype pthread Xrandr Xinerama \
			stdc++ Xcursor Xext GL Xi m X11.>=10 z fontconfig \
			Xfixes ssl crypto
a177 1
			dbus-1::x11/dbus \
d179 2
a180 1
			mng::graphics/libmng
d182 3
a184 1
			lcms tiff 
d195 1
a195 2
WANTLIB-postgresql =	${WANTLIB} ${sqlWANTLIB} xml2 ssl termcap readline \
			com_err crypto
d205 2
a206 1
WANTLIB-sqlite =		${WANTLIB} ${sqlWANTLIB}
d208 3
d213 2
a214 3
			QtDesigner,QtCore.>=4,QtGui,QtNetwork,QtOpenGL,QtSql,QtXml,QtSvg,QtTest,Qt3Support,QtAssistantClient,QtDBus,QtScript,QtHelp,QtCLucene,QtXmlPatterns::${BASE_PKGPATH} \
			phonon::${BASE_PKGPATH},-phonon
WANTLIB-examples =	${WANTLIB} ${commonWANTLIB}
a215 6
LIB_DEPENDS-phonon =	${LIB_DEPENDS} ${commonLIB_DEPENDS} \
			QtCore.>=7,Qt3Support,QtDBus,QtGui,QtNetwork,QtOpenGL,QtSql,QtXml::${BASE_PKGPATH} \
			gstaudio-0.10,gstinterfaces-0.10,gstvideo-0.10::multimedia/gstreamer-0.10/plugins-base
WANTLIB-phonon = 	${WANTLIB} ${commonWANTLIB} \
			gstbase-0.10 gstreamer-0.10 xml2 \
			gobject-2.0 gmodule-2.0
d221 12
d242 1
a242 1
DOCS =	OPENSOURCE-NOTICE.TXT README
d249 1
a249 1
PROGRAMS += 	rcc qt3to4 syncqt qdbus qtconfig-lite
a260 3

post-extract:
	cp -R ${WRKSRC}/tools/qtconfig ${WRKSRC}/tools/qtconfig-lite
@


1.55
log
@qt 4.4.3
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.52 2008/03/15 09:44:12 espie Exp $
d19 1
a19 1
PKGNAME-main =		qt4-${PKGVERSION}
a91 1
			-I${LOCALBASE}/include \
a93 1
			-L${LOCALBASE}/lib \
d112 1
a112 2
			-L${LOCALBASE}/lib \
			-I${LOCALBASE}/include -plugin-sql-psql
d114 2
a115 1
CONFIGURE_ENV =		LOCALBASE=${LOCALBASE} QTDIR="${WRKSRC}" 
@


1.54
log
@Fix type for FULLPKGPATH-html

ok espie
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2008/06/02 10:33:33 espie Exp $
d3 21
a23 17
COMMENT-main=		C++ X11 GUI toolkit
COMMENT-examples=	examples for qt4
COMMENT-html=		off-line html documentation for qt4
COMMENT-postgresql=	PostgresSQL plugin for qt4
COMMENT-mysql=		MySQL plugin for qt4
COMMENT-sqlite2=	sqlite2 plugin for qt4
COMMENT-sqlite=		sqlite plugin for qt4

PKGNAME=		qt4-${VERSION}
PKGNAME-mysql=		qt4-mysql-${VERSION}
PKGNAME-postgresql=	qt4-postgresql-${VERSION}
PKGNAME-examples=	qt4-examples-${VERSION}
PKGNAME-sqlite2=	qt4-sqlite2-${VERSION}
PKGNAME-sqlite=		qt4-sqlite-${VERSION}
PKGNAME-main=		qt4-${VERSION}
FULLPKGNAME-html=	qt4-html-${VERSION}p0
FULLPKGPATH-html=	${BASE_PKGPATH},-html
d25 1
a25 1
SHARED_LIBS=	Qt3Support 8.0 \
d38 5
a42 1
		QtScript 0.0
d45 3
a47 2
VERSION=	4.3.5
DISTNAME=	qt-x11-opensource-src-${VERSION}
d50 3
a52 2
CATEGORIES=	x11
MASTER_SITES=	ftp://ftp.iasi.roedu.net/mirrors/ftp.trolltech.com/qt/source/ \
d55 1
a55 2
		http://ftp.silug.org/pub/qt/source/ \
		ftp://ftp.troll.no/qt/source/
d57 1
a57 1
HOMEPAGE=	http://www.trolltech.com/qt/
d59 1
a59 1
MAINTAINER=	Marc Espie <espie@@openbsd.org>
d61 3
a63 3
FLAVORS=	debug
PSEUDO_FLAVORS=	no_examples
FLAVOR?=
d67 4
a70 4
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
d72 2
a73 2
USE_X11=	Yes
MAKE_ENV=	QTDIR="${WRKDIST}" EXTRA_SAMPLES="${EXTRA_SAMPLES}" \
d78 1
a78 1
PORTHOME=	${WRKDIST}
d80 43
a122 15
CONFIGURE_STYLE= simple
SEPARATE_BUILD=	simple
CONFIGURE_ARGS=	-qt-gif -system-libpng -system-libjpeg -system-zlib \
		-sm -no-g++-exceptions -system-sqlite \
		-v -stl -xrender -fast \
		-no-sql-odbc \
		-tablet \
		-xinerama \
		-cups \
		-confirm-license \
		-I${LOCALBASE}/include/libpng \
		-I${X11BASE}/include/freetype2 \
		-I${LOCALBASE}/include \
		-L${WRKBUILD}/lib \
		-L${LOCALBASE}/lib
d125 2
a126 1
CONFIGURE_ARGS+=-debug
d128 1
a128 1
CONFIGURE_ARGS+=-release
a130 24
CONFIGURE_ARGS+=	-prefix ${QT_BASEDIR}
CONFIGURE_ARGS+=	-libdir ${QT_BASEDIR}
CONFIGURE_ARGS+=	-bindir ${QT_BINDIR}
CONFIGURE_ARGS+=	-headerdir ${QT_INCDIR}
CONFIGURE_ARGS+=	-docdir ${QT_DOC}
CONFIGURE_ARGS+=	-plugindir ${QT_PLUGINSDIR}
CONFIGURE_ARGS+=	-datadir ${QT_BASEDIR}
CONFIGURE_ARGS+=	-sysconfdir ${SYSCONFDIR}
CONFIGURE_ARGS+=	-examplesdir ${QT_BASEDIR}/examples
CONFIGURE_ARGS+=	-demosdir ${QT_BASEDIR}/demos
CONFIGURE_ARGS+= -I${LOCALBASE}/include/mysql -L${LOCALBASE}/lib/mysql \
	-plugin-sql-mysql
CONFIGURE_ARGS+= -I${LOCALBASE}/include/postgresql \
	    -I${LOCALBASE}/include/postgresql/server \
	    -L${LOCALBASE}/lib \
	    -I${LOCALBASE}/include -plugin-sql-psql

CONFIGURE_ENV=	LOCALBASE=${LOCALBASE} QTDIR="${WRKSRC}" 

BUILD_DEPENDS+=::print/cups
BUILD_DEPENDS+=::databases/postgresql,-server

MULTI_PACKAGES=-main -html -mysql -postgresql -sqlite2 -sqlite

d133 19
a151 18
SUBTARGETS= sub-moc \
		sub-rcc \
		sub-uic \
		sub-corelib \
		sub-xml \
		sub-gui \
		sub-sql \
		sub-network \
		sub-svg \
		sub-script \
		sub-opengl \
		sub-qt3support \
		sub-uic3 \
		sub-plugins \
		sub-tools
ALL_TARGET=${SUBTARGETS}
INSTALL_TARGET=${SUBTARGETS:S/$/-install_subtargets/} \
	install_htmldocs install_translations install_qmake install_mkspecs
d153 2
a154 2
MULTI_PACKAGES+=-examples
PROGRAMS+=	qtdemo pixeltool
d158 2
a159 2
LIB_DEPENDS=		glib-2.0,gthread-2.0::devel/glib2
WANTLIB=		iconv intl
d161 1
a161 1
commonWANTLIB=		ICE Xrender c GLU SM freetype pthread Xrandr Xinerama \
d164 1
a164 2
commonLIB_DEPENDS=	png.>=2::graphics/png \
			dbus-1::x11/dbus
d166 2
a167 2
sqlWANTLIB=		m z
sqlLIB_DEPENDS= 	QtCore.>=4,QtSql::${BASE_PKGPATH}
d170 2
a171 1
LIB_DEPENDS-main=	${LIB_DEPENDS} ${commonLIB_DEPENDS} \
d174 2
a175 2
WANTLIB-main=		${WANTLIB} ${commonWANTLIB} \
			lcms tiff
d178 1
a178 1
LIB_DEPENDS-mysql=	${LIB_DEPENDS} ${sqlLIB_DEPENDS} \
d180 1
a180 1
WANTLIB-mysql=		${WANTLIB} ${sqlWANTLIB} \
d184 1
a184 1
LIB_DEPENDS-postgresql=	${LIB_DEPENDS} ${sqlLIB_DEPENDS} \
d186 2
a187 1
WANTLIB-postgresql=	${WANTLIB} ${sqlWANTLIB}
d190 1
a190 1
LIB_DEPENDS-sqlite2=	${LIB_DEPENDS} ${sqlLIB_DEPENDS} \
d192 1
a192 1
WANTLIB-sqlite2=	${WANTLIB} ${sqlWANTLIB}
d195 1
a195 1
LIB_DEPENDS-sqlite=	${LIB_DEPENDS} ${sqlLIB_DEPENDS} \
d197 1
a197 1
WANTLIB-sqlite=		${WANTLIB} ${sqlWANTLIB}
d200 4
a203 3
LIB_DEPENDS-examples=	${LIB_DEPENDS} ${commonLIB_DEPENDS} \
			QtDesigner,QtCore.>=4,QtGui,QtNetwork,QtOpenGL,QtSql,QtXml,QtSvg,QtTest,Qt3Support,QtAssistantClient,QtDBus,QtScript::${BASE_PKGPATH}
WANTLIB-examples=	${WANTLIB} ${commonWANTLIB}
d205 6
d212 3
a214 3
LIB_DEPENDS-html=
WANTLIB-html=
PKG_ARCH-html=	*
d217 7
a223 7
QT_BASEDIR=	${PREFIX}/lib/qt4
QT_INCDIR=	${PREFIX}/include/X11/qt4
QT_EXAMPLES=	${QT_BASEDIR}/examples
QT_DOC=		${PREFIX}/share/doc/qt4
QT_PLUGINSDIR=	${QT_BASEDIR}/plugins
QT_BINDIR=	${QT_BASEDIR}/bin
QT_PKGCFGDIR=	${QT_BASEDIR}/pkgconfig
d225 1
a225 1
DOCS=	OPENSOURCE-NOTICE.TXT README
d227 2
a228 2
VMEM_WARNING=	Yes
NO_REGRESS=	Yes
d230 3
a232 3
PROGRAMS4=assistant designer findtr linguist lrelease lupdate moc qmake \
	qtconfig uic uic3
PROGRAMS+= rcc qt3to4 syncqt qdbus
d235 1
a235 1
QMAKE=${WRKBUILD}/bin/qmake
d237 1
a237 1
MAKE_FLAGS+=	INSTALL_PROGRAM='${INSTALL_PROGRAM}' \
d240 1
a240 1
MAKE_FLAGS+=LIB$l_VERSION=$v
d243 4
a246 1
DESTDIRNAME=	INSTALL_ROOT
d274 1
a274 1
USE_GMAKE=Yes
@


1.53
log
@minor update to qt 4.3.5
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.52 2008/03/15 09:44:12 espie Exp $
d18 2
a19 2
FULLPKGNAME-html=	qt4-html-${VERSION}
FULLPKGPATH-hml=	${BASE_PKGPATH},-html
@


1.52
log
@minor update to 4.3.4
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 2008/01/28 19:09:04 espie Exp $
d37 1
a37 1
VERSION=	4.3.4
a220 4

post-patch:
	perl -pi -e "s#!!CUPS_LIBS!!#`cups-config --libs`#" \
		${WRKSRC}/config.tests/unix/cups/cups.pro
@


1.51
log
@remove work-around that's no longer necessary.
You *must* use a current libpthread though...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2008/01/27 05:01:37 espie Exp $
d17 1
a17 1
PKGNAME-main=		qt4-${VERSION}p1
d37 1
a37 1
VERSION=	4.3.3
@


1.50
log
@disable sse2 for now, as it breaks stuff.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2008/01/26 20:01:22 espie Exp $
d17 1
a17 1
PKGNAME-main=		qt4-${VERSION}p0
@


1.49
log
@fix PKGPATH for -html in debug flavor case.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2008/01/26 18:46:36 espie Exp $
d17 1
a17 1
PKGNAME-main=		qt4-${VERSION}
@


1.48
log
@Repair no_examples pseudo-flavor
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2008/01/06 13:48:12 espie Exp $
d19 2
@


1.47
log
@`minor' update, qt 4.3.3, everything depending on it still builds and works.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2008/01/04 17:48:38 espie Exp $
d117 18
a134 4
ALL_TARGET=sub-src-all-ordered sub-tools-all-ordered
INSTALL_TARGET=sub-src-install_subtargets-ordered \
	sub-tools-install_subtargets-ordered install_htmldocs \
	install_translations install_qmake install_mkspecs
d151 1
a151 1
sqlLIB_DEPENDS= 	QtCore.>=4,QtSql::${BUILD_PKGPATH}
d183 1
a183 1
			QtDesigner,QtCore.>=4,QtGui,QtNetwork,QtOpenGL,QtSql,QtXml,QtSvg,QtTest,Qt3Support,QtAssistantClient,QtDBus,QtScript::${BUILD_PKGPATH}
@


1.46
log
@tweak FAKE_FLAGS semantics to saner defaults.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2007/12/11 08:00:06 jakemsr Exp $
d14 1
a14 1
PKGNAME-examples=	qt4-examples-${VERSION}p0
d17 2
a18 2
PKGNAME-main=		qt4-${VERSION}p1
FULLPKGNAME-html=	qt4-html-${VERSION}p0
d35 1
a35 1
VERSION=	4.3.2
@


1.45
log
@
use -pthread instead of -lpthread for pthreads linkage in CUPS

bulk build tested by steven@@ (a while ago) "sure" mbalmer@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2007/10/25 09:30:22 wilfried Exp $
d204 1
a204 1
FAKE_FLAGS=$(MAKE_FLAGS) INSTALL_ROOT=${WRKINST}
@


1.44
log
@plist fixes, ok espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2007/10/22 15:36:59 espie Exp $
d17 1
a17 1
PKGNAME-main=		qt4-${VERSION}p0
d205 4
@


1.43
log
@minor update to 4.3.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2007/08/29 12:30:58 espie Exp $
d14 1
a14 1
PKGNAME-examples=	qt4-examples-${VERSION}
d17 2
a18 2
PKGNAME-main=		qt4-${VERSION}
FULLPKGNAME-html=	qt4-html-${VERSION}
@


1.42
log
@minor update to 4.3.1. Had this in my tree for a while, totally forgot about
it...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2007/06/10 21:23:10 espie Exp $
d35 1
a35 1
VERSION=	4.3.1
@


1.41
log
@same bug as in 4.2.0.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2007/06/09 23:13:09 espie Exp $
d3 7
a9 7
COMMENT-main=		"C++ X11 GUI toolkit"
COMMENT-examples=	"examples for qt4"
COMMENT-html=		"off-line html documentation for qt4"
COMMENT-postgresql=	"PostgresSQL plugin for qt4"
COMMENT-mysql=		"MySQL plugin for qt4"
COMMENT-sqlite2=	"sqlite2 plugin for qt4"
COMMENT-sqlite=		"sqlite plugin for qt4"
d14 1
a14 1
PKGNAME-examples=	qt4-examples-${VERSION}p0
d17 1
a17 1
PKGNAME-main=		qt4-${VERSION}p1
d35 1
a35 1
VERSION=	4.3.0
d54 2
a55 1
# GPL/QPL
@


1.40
log
@regen plists. Add extra moc link to help qdbus.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2007/06/02 08:27:36 espie Exp $
d17 1
a17 1
PKGNAME-main=		qt4-${VERSION}p0
d224 1
a224 1
	cd ${QT_BINDIR} && ln -s moc moc4
@


1.39
log
@4.3.0 replaces rc1. A few minor changes, quite a few patches integrated.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2007/05/22 09:09:32 espie Exp $
d14 1
a14 1
PKGNAME-examples=	qt4-examples-${VERSION}
d17 1
a17 1
PKGNAME-main=		qt4-${VERSION}
d223 2
@


1.38
log
@update to 4.3.0rc1.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2007/04/03 21:05:51 espie Exp $
d35 1
a35 1
VERSION=	4.3.0rc1
@


1.37
log
@remove HOMEPAGE from DESCR
@
text
@d17 1
a17 1
PKGNAME-main=		qt4-${VERSION}p2
d19 14
a32 13
SHARED_LIBS=	Qt3Support 7.0 \
		QtCore 6.2 \
		QtDesigner 6.1 \
		QtDesignerComponents 6.1 \
		QtGui 7.0 \
		QtNetwork 6.2 \
		QtOpenGL 6.2 \
		QtSql 6.2 \
		QtXml 6.1 \
		QtSvg 6.2 \
		QtTest 6.1 \
		QtAssistantClient 2.1 \
		QtDBus 0.1 
d35 1
a35 1
VERSION=	4.2.3
d40 1
a40 2
MASTER_SITES=	ftp://ftp.rediris.es/mirror/Qt/source/ \
		ftp://ftp.iasi.roedu.net/mirrors/ftp.trolltech.com/qt/source/ \
d69 1
d81 1
a81 1
		-L${WRKSRC}/lib \
a105 1
CONFIGURE_ARGS+= -plugin-sql-sqlite
d131 1
a131 1
			Xfixes
d143 1
a143 1
			lcms
d168 1
a168 1
			QtDesigner,QtCore.>=4,QtGui,QtNetwork,QtOpenGL,QtSql,QtXml,QtSvg,QtTest,Qt3Support,QtAssistantClient,QtDBus::${BUILD_PKGPATH}
d183 1
a183 1
QT_PKGCFGDIR=	${QT_BASEDIR}
d210 1
a210 1
	${INSTALL_PROGRAM} ${WRKBUILD}/bin/{findtr,syncqt} ${QT_BINDIR}
@


1.36
log
@disable optimization which breaks with gcc 3.3.6
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2007/03/31 23:10:18 espie Exp $
d17 1
a17 1
PKGNAME-main=		qt4-${VERSION}p1
@


1.35
log
@fix utf8 codec
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2007/03/26 21:22:13 espie Exp $
d17 1
a17 1
PKGNAME-main=		qt4-${VERSION}p0
@


1.34
log
@help people not mix up X11 with xenocara, by making sure they link against
X11 >= 10, and bump those major numbers accordingly, so that bug-reports
will get easier to process.

(artificial `flag day' as discussed with deraadt@@)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2007/03/17 17:58:16 espie Exp $
d11 1
a11 1
PKGNAME=		qt4-${VERSION}p0
d17 1
a17 1
PKGNAME-main=		qt4-${VERSION}
@


1.33
log
@update to 4.2.3
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2007/03/17 11:51:58 steven Exp $
d11 1
a11 1
PKGNAME=		qt4-${VERSION}
d19 1
a19 1
SHARED_LIBS=	Qt3Support 6.2 \
d23 1
a23 1
		QtGui 6.3 \
d130 2
a131 1
			stdc++ Xcursor Xext GL Xi m X11 z fontconfig Xfixes
@


1.32
log
@move pixeltool to -examples package; unbreaks no_examples flavor.

ok espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2007/02/25 17:31:04 espie Exp $
d14 1
a14 1
PKGNAME-examples=	qt4-examples-${VERSION}p0
d17 1
a17 1
PKGNAME-main=		qt4-${VERSION}p4
d19 2
a20 2
SHARED_LIBS=	Qt3Support 6.1 \
		QtCore 6.1 \
d23 4
a26 4
		QtGui 6.2 \
		QtNetwork 6.1 \
		QtOpenGL 6.1 \
		QtSql 6.1 \
d28 1
a28 1
		QtSvg 6.1 \
d34 1
a34 1
VERSION=	4.2.2
d126 1
a126 1
LIB_DEPENDS=		glib-2.0::devel/glib2
@


1.31
log
@prevent QTextStreams from hanging on pipes EOF, as noticed in kdelibs4.

reintroduce a debug flavor, now that qt is `sane'. Fix main pkgname,
and add sha256 checksum.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2007/02/24 11:23:49 espie Exp $
d14 1
a14 1
PKGNAME-examples=	qt4-examples-${VERSION}
d17 1
a17 1
PKGNAME-main=		qt4-${VERSION}p3
@


1.31.2.1
log
@security fix for CVE-2007-0242

MFC:
handle utf8 encoding better.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2007/02/25 17:31:04 espie Exp $
d17 1
a17 1
PKGNAME-main=		qt4-${VERSION}p5
@


1.30
log
@fix qdbuscpp2xml, make sure we run moc4.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2007/01/29 09:51:28 espie Exp $
d17 1
a17 1
FULLPKGNAME-main=	qt4-${VERSION}p2
d50 1
a76 1
		-release \
d83 5
a87 1

@


1.29
log
@fix symlink issue noticed by steven@@ by actually installing two scripts
that do not get installed by qt automatically.
Plus, install pixeltool under /usr/local/bin  as well.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2006/12/29 23:22:51 espie Exp $
d17 1
a17 1
FULLPKGNAME-main=	qt4-${VERSION}p1
@


1.28
log
@we want qdbus to be visible...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2006/12/06 08:32:44 espie Exp $
d17 1
a17 1
FULLPKGNAME-main=	qt4-${VERSION}p0
d118 1
a118 1
PROGRAMS+=	qtdemo
d185 1
a185 1
PROGRAMS4=assistant designer findtr linguist lrelease lupdate moc qm2ts qmake \
d205 1
@


1.27
log
@maintainance update to 4.2.2, no binary interface change, improvements in
about all libraries -> minor bumps.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2006/11/25 18:35:45 espie Exp $
d17 1
a17 1
FULLPKGNAME-main=	qt4-${VERSION}
d187 1
a187 1
PROGRAMS+= rcc qt3to4 syncqt
@


1.26
log
@use BUILD_PKGPATH
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2006/11/21 22:40:31 espie Exp $
d14 1
a14 1
PKGNAME-examples=	qt4-examples-${VERSION}p1
d17 1
a17 1
FULLPKGNAME-main=	qt4-${VERSION}p1
d19 13
a31 13
SHARED_LIBS=	Qt3Support 6.0 \
		QtCore 6.0 \
		QtDesigner 6.0 \
		QtDesignerComponents 6.0 \
		QtGui 6.1 \
		QtNetwork 6.0 \
		QtOpenGL 6.0 \
		QtSql 6.0 \
		QtXml 6.0 \
		QtSvg 6.0 \
		QtTest 6.0 \
		QtAssistantClient 2.0 \
		QtDBus 0.0 
d34 2
a35 2
VERSION=	4.2.1
DISTNAME=	qt-x11-opensource-src-4.2.1
@


1.25
log
@forgotten pkgpath, reminded by kurt
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2006/11/21 19:25:47 espie Exp $
d131 1
a131 1
sqlLIB_DEPENDS= 	QtCore.>=4,QtSql::x11/qt4
d163 1
a163 1
			QtDesigner,QtCore.>=4,QtGui,QtNetwork,QtOpenGL,QtSql,QtXml,QtSvg,QtTest,Qt3Support,QtAssistantClient,QtDBus::x11/qt4
@


1.24
log
@switch to new MULTI_PACKAGES
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2006/11/07 09:27:37 alek Exp $
d17 1
a17 1
FULLPKGNAME-main=	qt4-${VERSION}p0
@


1.23
log
@-examples subpackage needs QtDesigner as a LIB_DEPENDS
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2006/10/30 18:17:32 espie Exp $
d3 1
a3 1
COMMENT=		"C++ X11 GUI toolkit"
d14 1
a14 1
PKGNAME-examples=	qt4-examples-${VERSION}p0
d17 1
a17 1
FULLPKGNAME=		qt4-${VERSION}
d95 7
a104 4
SUBPACKAGE?=

LIB_DEPENDS=
WANTLIB=
d106 1
d108 1
a108 1
MULTI_PACKAGES+=-html 
a120 4
.if !defined(PACKAGING) || ${SUBPACKAGE} == ""
LIB_DEPENDS+=	jpeg::graphics/jpeg \
		mng::graphics/libmng \
		dbus-1::x11/dbus
d122 23
a144 2
WANTLIB+=	lcms
.endif
a145 10
MULTI_PACKAGES+=	-mysql
CONFIGURE_ARGS+= -I${LOCALBASE}/include/mysql -L${LOCALBASE}/lib/mysql \
	-plugin-sql-mysql
.if !defined(PACKAGING) || ${SUBPACKAGE} == "-mysql"
LIB_DEPENDS+=mysqlclient_r::databases/mysql
.  if defined(PACKAGING)
LIB_DEPENDS+=	QtCore.>=4,QtSql::x11/qt4
.  endif
WANTLIB+=	m z crypto ssl pthread
.endif
d147 4
a150 13
MULTI_PACKAGES+=	-postgresql
BUILD_DEPENDS+=::databases/postgresql,-server
CONFIGURE_ARGS+= -I${LOCALBASE}/include/postgresql \
	    -I${LOCALBASE}/include/postgresql/server \
	    -L${LOCALBASE}/lib \
	    -I${LOCALBASE}/include -plugin-sql-psql
.if !defined(PACKAGING) || ${SUBPACKAGE} == "-postgresql" 
LIB_DEPENDS+=pq.>=2:postgresql-client-*:databases/postgresql
.  if defined(PACKAGING)
LIB_DEPENDS+=	QtCore.>=4,QtSql::x11/qt4
.  endif
WANTLIB+=	m z
.endif
d152 3
a155 9
CONFIGURE_ARGS+= -plugin-sql-sqlite
MULTI_PACKAGES+=	-sqlite2
.if !defined(PACKAGING) || ${SUBPACKAGE} == "-sqlite2"
LIB_DEPENDS+=	sqlite::databases/sqlite
.  if defined(PACKAGING)
LIB_DEPENDS+=	QtCore.>=4,QtSql::x11/qt4
.  endif
WANTLIB+=	m z
.endif
d157 3
a159 8
MULTI_PACKAGES+=	-sqlite
.if !defined(PACKAGING) || ${SUBPACKAGE} == "-sqlite"
LIB_DEPENDS+=	sqlite3::databases/sqlite3
.  if defined(PACKAGING)
LIB_DEPENDS+=	QtCore.>=4,QtSql::x11/qt4
.  endif
WANTLIB+=	m z
.endif
a160 4
.if defined(PACKAGING) && ${SUBPACKAGE} == "-examples"
LIB_DEPENDS+=	QtDesigner,QtCore.>=4,QtGui,QtNetwork,QtOpenGL,QtSql,QtXml,QtSvg,QtTest,Qt3Support,QtAssistantClient,QtDBus::x11/qt4
WANTLIB+=	dbus-1
.endif
d162 3
a164 5
.if !defined(PACKAGING) || ${SUBPACKAGE} == "" || ${SUBPACKAGE} == "-examples"
WANTLIB+=	ICE Xrender c GLU SM freetype pthread Xrandr Xinerama \
		stdc++ Xcursor Xext GL Xi m X11 z fontconfig Xfixes
LIB_DEPENDS+=	png.>=2::graphics/png
.endif
a165 3
.if !defined(PACKAGING) || ${SUBPACKAGE} != "-html"
LIB_DEPENDS+=	glib-2.0::devel/glib2
WANTLIB+=	iconv intl
d167 3
a169 1
.endif
a170 3
.if defined(PACKAGING) && ${SUBPACKAGE} == "-html"
PKG_ARCH=	*
.endif
d224 1
@


1.22
log
@update to 4.2.1. Add a no_examples pseudo-flavor, by popular demand.
Move some stuff that is built only in examples in the proper package.
And mark it as conflicting with old qt4.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2006/10/08 21:43:50 espie Exp $
d14 1
a14 1
PKGNAME-examples=	qt4-examples-${VERSION}
d171 1
a171 1
LIB_DEPENDS+=	QtCore.>=4,QtGui,QtNetwork,QtOpenGL,QtSql,QtXml,QtSvg,QtTest,Qt3Support,QtAssistantClient,QtDBus::x11/qt4
@


1.21
log
@qt 4.2.0, lots of improvements.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2006/08/08 16:17:54 steven Exp $
d23 1
a23 1
		QtGui 6.0 \
d34 2
a35 2
VERSION=	4.2.0
DISTNAME=	qt-x11-opensource-src-4.2.0
d49 2
a50 1

d104 12
a115 1
MULTI_PACKAGES+=-html -examples
d206 1
a206 1
PROGRAMS= rcc qtdemo qt3to4 syncqt
a217 14

DIRECTORIES= src/corelib src/gui src/network src/opengl src/qt3support src/sql src/xml \
	src/plugins/accessible/compat \
	src/plugins/accessible/widgets \
	src/plugins/codecs/cn \
	src/plugins/codecs/jp \
	src/plugins/codecs/kr \
	src/plugins/codecs/tw \
	src/plugins/imageformats/jpeg \
	src/plugins/sqldrivers/mysql \
	src/plugins/sqldrivers/psql \
	tools/designer/src/components/lib \
	tools/designer/src/lib \
	tools/designer/src/plugins/widgets
@


1.20
log
@more new lib specs
@
text
@d14 1
a14 1
PKGNAME-examples=	qt4-examples-${VERSION}p0
d17 1
a17 1
FULLPKGNAME=		qt4-${VERSION}p0
d19 18
a36 11
SHARED_LIBS=	Qt3Support 5.0 \
		QtCore 5.0 \
		QtDesigner 5.0 \
		QtDesignerComponents 5.0 \
		QtGui 5.0 \
		QtNetwork 5.0 \
		QtOpenGL 5.0 \
		QtSql 5.0 \
		QtXml 5.0 \
		QtSvg 5.0 \
		QtTest 5.0
a37 2
VERSION=	4.1.3
DISTNAME=	qt-x11-opensource-src-4.1.3
d68 1
a68 1
		-sm -no-g++-exceptions \
d107 2
a108 1
		mng::graphics/libmng 
d121 1
a121 1
WANTLIB+=	m z
d159 2
a160 1
LIB_DEPENDS+=	QtCore.>=4,QtGui,QtNetwork,QtOpenGL,QtSql,QtXml,QtSvg,QtTest::x11/qt4
d165 1
a165 1
		stdc++ Xcursor Xext GL Xi m X11 z fontconfig
d169 6
d187 1
a187 1
DOCS=	LICENSE.GPL README OPENSOURCE-NOTICE.TXT
d199 2
a221 4
	# extra debugging stuff
.for i in ${DIRECTORIES}
#	cd ${WRKBUILD}/$i && ${MAKE_PROGRAM} LOCALBASE=${LOCALBASE} ${FAKE_FLAGS} debug-install
.endfor
a226 1
	strip ${PREFIX}/lib/qt4/bin/$p
a230 1
	strip ${QT_BASEDIR}/bin/$p
@


1.19
log
@move two files into -examples subpackage. pointed out by Moritz Grimm.

go ahead espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2006/06/04 09:37:43 espie Exp $
d113 1
a113 1
LIB_DEPENDS+=	QtCore.4,QtSql::x11/qt4
d125 1
a125 1
LIB_DEPENDS+=pq.2:postgresql-client-*:databases/postgresql
d127 1
a127 1
LIB_DEPENDS+=	QtCore.4,QtSql::x11/qt4
d138 1
a138 1
LIB_DEPENDS+=	QtCore.4,QtSql::x11/qt4
d147 1
a147 1
LIB_DEPENDS+=	QtCore.4,QtSql::x11/qt4
d153 1
a153 1
LIB_DEPENDS+=	QtCore.4,QtGui,QtNetwork,QtOpenGL,QtSql,QtXml,QtSvg,QtTest::x11/qt4
d159 1
a159 1
LIB_DEPENDS+=	png.2::graphics/png
@


1.19.2.1
log
@security fix for CVE-2007-0242

MFC:
handle utf8 encoding better.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2006/08/08 16:17:54 steven Exp $
d17 1
a17 1
FULLPKGNAME=		qt4-${VERSION}p1
@


1.18
log
@qt 4.1.3
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2006/05/15 21:09:39 espie Exp $
d14 1
a14 1
PKGNAME-examples=	qt4-examples-${VERSION}
d17 1
a17 1
FULLPKGNAME=		qt4-${VERSION}
@


1.17
log
@make sure the sqlite* plugins are built, depending on external source,
instead of outdated internal sqlite code.

Put them into separate packages accordingly, since there are dependencies
now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2006/05/14 08:57:48 bernd Exp $
d12 3
a14 3
PKGNAME-mysql=		qt4-mysql-${VERSION}p0
PKGNAME-postgresql=	qt4-postgresql-${VERSION}p0
PKGNAME-examples=	qt4-examples-${VERSION}p0
d17 1
a17 1
FULLPKGNAME=		qt4-${VERSION}p0
d31 2
a32 2
VERSION=	4.1.2
DISTNAME=	qt-x11-opensource-src-4.1.2
@


1.16
log
@s/qt3/qt4/, bump PKGNAMES accordingly.

"go ahead" espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2006/04/06 09:35:46 steven Exp $
d8 2
d15 3
a17 1
FULLPKGNAME=		qt4-${VERSION}
d90 1
a90 1
CONFIGURE_ENV=	QTDIR="${WRKSRC}" 
d126 20
@


1.15
log
@fix a few MASTER_SITES mirror paths
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2006/04/01 12:32:56 espie Exp $
d10 3
a12 3
PKGNAME-mysql=		qt4-mysql-${VERSION}
PKGNAME-postgresql=	qt4-postgresql-${VERSION}
PKGNAME-examples=	qt4-examples-${VERSION}
@


1.14
log
@update to 4.1.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2006/03/05 21:58:07 espie Exp $
d31 1
a31 1
		ftp://ftp.iasi.roedu.net/mirrors/ftp.trolltech.com/qt/sources/ \
d33 2
a34 2
		ftp://ftp.tu-chemnitz.de/pub/Qt/source/ \
		ftp://ftp.silug.org/mirrors/ftp.trolltech.com/qt/source/ \
@


1.13
log
@update to qt 4.1.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2006/01/13 19:18:50 espie Exp $
d27 2
a28 2
VERSION=	4.1.1
DISTNAME=	qt-x11-opensource-src-4.1.1
@


1.12
log
@bunp all qt shared libs at the same time.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2006/01/07 11:22:53 espie Exp $
d10 2
a11 2
PKGNAME-mysql=		qt4-mysql-${VERSION}p0
PKGNAME-postgresql=	qt4-postgresql-${VERSION}p0
d13 1
a13 1
FULLPKGNAME=		qt4-${VERSION}p0
d27 2
a28 2
VERSION=	4.1.0
DISTNAME=	qt-x11-opensource-src-4.1.0
d100 1
@


1.12.2.1
log
@security fix for CVE-2007-0242

MFC:
handle utf8 encoding better.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2006/01/13 19:18:50 espie Exp $
d13 1
a13 1
FULLPKGNAME=		qt4-${VERSION}p1
@


1.11
log
@fix dependency error, noticed by naddy.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2005/12/31 15:59:50 espie Exp $
d10 2
a11 2
PKGNAME-mysql=		qt4-mysql-${VERSION}
PKGNAME-postgresql=	qt4-postgresql-${VERSION}
d13 1
a13 1
FULLPKGNAME=		qt4-${VERSION}
d15 11
a25 11
SHARED_LIBS=	Qt3Support 4.2 \
		QtCore 4.2 \
		QtDesigner 4.2 \
		QtDesignerComponents 4.2 \
		QtGui 4.2 \
		QtNetwork 4.2 \
		QtOpenGL 4.2 \
		QtSql 4.2 \
		QtXml 4.2 \
		QtSvg 4.1 \
		QtTest 4.1
@


1.10
log
@update to qt 4.1.0, heavily patch qmake to handle SHARED_LIBS.
patch a lot of Makefiles to avoid debug stuff entirely.
fix a few tests so that libmng gets picked up, and some various NIS
and IPv6 stuff.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2005/09/19 20:40:16 espie Exp $
d107 1
d109 1
d121 1
d123 1
@


1.9
log
@Update to 4.0.1
@
text
@d1 1
a1 2
#/ $OpenBSD: Makefile,v 1.8 2005/09/05 14:57:06 espie Exp $
# $FreeBSD: Makefile,v 1.33 1999/02/27 03:09:57 andreas Exp $
a7 1
COMMENT-debug=		"debug libraries for qt4"
a12 1
PKGNAME-debug=		qt4-debug-${VERSION}
d15 11
d27 2
a28 2
VERSION=	4.0.1
DISTNAME=	qt-x11-opensource-src-4.0.1
a47 2
myWANTLIB=		GL GLU ICE SM X11 Xcursor Xext Xi Xinerama \
			Xrandr Xrender fontconfig freetype m z
a56 1
MAKE_FLAGS=	DESIGNER_SUBDIR=dummy
d91 2
a92 2
BUILD_DEPENDS=::graphics/jpeg
BUILD_DEPENDS=::print/cups
d94 7
a100 1
MULTI_PACKAGES+=-html -debug -examples
a102 3
.if !defined(PACKAGING) || ${SUBPACKAGE} == "-mysql" || ${SUBPACKAGE} == "-debug"
LIB_DEPENDS+=mysqlclient::databases/mysql
.endif
d105 5
a111 2
.if !defined(PACKAGING) || ${SUBPACKAGE} == "-postgresql" || ${SUBPACKAGE} == "-debug"
LIB_DEPENDS+=pq.2:postgresql-client-*:databases/postgresql
a112 1
.endif
d117 2
a118 2

.if defined(PACKAGING) && (${SUBPACKAGE} == "-mysql" || ${SUBPACKAGE} =="-postgresql")
d120 1
d124 1
a124 5
LIB_DEPENDS+=	QtCore.4,QtGui,QtDesigner,QtNetwork,QtOpenGL,QtSql,QtXml::x11/qt4
.endif

.if ${SUBPACKAGE} == "-examples" || ${SUBPACKAGE} == ""
myWANTLIB+=	pthread stdc++ c
d127 4
a130 4
.if !defined(PACKAGING) || ${SUBPACKAGE} != "-html"
LIB_DEPENDS+=	png.2::graphics/png \
		jpeg::graphics/jpeg
WANTLIB=	${myWANTLIB}
a136 4
.if defined(PACKAGING) && ${SUBPACKAGE} == "-debug"
PERMIT_PACKAGE_FTP=	"Removed for space constraints"
.endif

a153 11
LIBRARIES=	Qt3Support 4.0.1 4.1 QtCore 4.0.1 4.1 QtDesigner 4.0.1 4.1 \
		QtDesignerComponents 4.0.1 4.1 QtGui 4.0.1 4.1 \
		QtNetwork 4.0.1 4.1 \
		QtOpenGL 4.0.1 4.1 QtSql 4.0.1 4.1 QtXml 4.0.1 4.1

LIBRARIES+=	Qt3Support_debug 4.0.1 4.1 QtCore_debug 4.0.1 4.1 \
		QtDesigner_debug 4.0.1 4.1 \
		QtDesignerComponents_debug 4.0.1 4.1 \
		QtGui_debug 4.0.1 4.1 QtNetwork_debug 4.0.1 4.1 \
		QtOpenGL_debug 4.0.1 4.1 QtSql_debug 4.0.1 4.1 \
		QtXml_debug 4.0.1 4.1
d157 3
d161 1
a161 1
FAKE_FLAGS=INSTALL_ROOT=${WRKINST}
d180 1
a180 1
	cd ${WRKBUILD}/$i && ${MAKE_PROGRAM} LOCALBASE=${LOCALBASE} ${FAKE_FLAGS} debug-install
d190 1
d200 2
a201 3
.for l v w in ${LIBRARIES}
	mv -f ${QT_BASEDIR}/lib$l.so.$v ${QT_BASEDIR}/lib$l.so.$w
	ln -sf qt4/lib$l.so.$w ${PREFIX}/lib
@


1.8
log
@missing common directory.
@
text
@d1 1
a1 1
#/ $OpenBSD: Makefile,v 1.7 2005/08/17 21:06:48 sturm Exp $
d11 7
a17 7
PKGNAME=		qt4-${VERSION}p3
PKGNAME-mysql=		qt4-mysql-${VERSION}p3
PKGNAME-postgresql=	qt4-postgresql-${VERSION}p3
PKGNAME-examples=	qt4-examples-${VERSION}p3
PKGNAME-debug=		qt4-debug-${VERSION}p4
FULLPKGNAME=		qt4-${VERSION}p4
FULLPKGNAME-html=	qt4-html-${VERSION}p3
d19 2
a20 2
VERSION=	4.0.0
DISTNAME=	qt-x11-opensource-desktop-4.0.0
d140 1
a140 1
QT_PKGCFGDIR=	${QT_BASEDIR}/pkgconfig
d151 11
a161 9
LIBRARIES=	Qt3Support 4.0 QtCore 4.0 QtDesigner 4.0 \
		QtDesignerComponents 4.0 QtGui 4.0 QtNetwork 4.0 \
		QtOpenGL 4.0 QtSql 4.0 QtXml 4.0

LIBRARIES+=	Qt3Support_debug 4.0 QtCore_debug 4.0 \
		QtDesigner_debug 4.0 QtDesignerComponents_debug 4.0 \
		QtGui_debug 4.0 QtNetwork_debug 4.0 \
		QtOpenGL_debug 4.0 QtSql_debug 4.0 \
		QtXml_debug 4.0
d204 3
a206 3
.for l v in ${LIBRARIES}
	mv -f ${QT_BASEDIR}/lib$l.so.$v.0 ${QT_BASEDIR}/lib$l.so.$v
	ln -sf qt4/lib$l.so.$v ${PREFIX}/lib
@


1.7
log
@qt4-debug is too big for ftp

ok pval@@
@
text
@d1 1
a1 1
#/ $OpenBSD: Makefile,v 1.6 2005/07/05 17:44:46 espie Exp $
d16 1
a16 1
FULLPKGNAME=		qt4-${VERSION}p3
@


1.6
log
@fix a few building nits
@
text
@d1 1
a1 1
#/ $OpenBSD: Makefile,v 1.5 2005/07/04 21:44:04 espie Exp $
d15 1
a15 1
PKGNAME-debug=		qt4-debug-${VERSION}p3
d128 4
@


1.5
log
@a few tweaks yet
@
text
@d1 1
a1 1
#/ $OpenBSD: Makefile,v 1.4 2005/07/04 21:23:06 espie Exp $
d11 7
a17 7
PKGNAME=		qt4-${VERSION}
PKGNAME-mysql=		qt4-mysql-${VERSION}
PKGNAME-postgresql=	qt4-postgresql-${VERSION}
PKGNAME-examples=	qt4-examples-${VERSION}
PKGNAME-debug=		qt4-debug-${VERSION}p2
FULLPKGNAME=		qt4-${VERSION}p2
FULLPKGNAME-html=	qt4-html-${VERSION}p2
d70 3
a72 2
CONFIGURE_ARGS+=	-prefix ${QT_LIBDIR}
#CONFIGURE_ARGS+=	-bindir ${QT_BINDIR}
d75 2
a76 1
#CONFIGURE_ARGS+=	-plugindir ${QT_PLUGINSDIR}
d78 2
d130 1
a130 1
QT_LIBDIR=	${PREFIX}/lib/qt4
d132 1
a132 1
QT_EXAMPLES=	${QT_LIBDIR}/examples
d134 3
a136 6
QT_PLUGINSDIR=	${QT_LIBDIR}/plugins
QT_BINDIR=	${QT_LIBDIR}/bin
QT_PKGCFGDIR=	${QT_LIBDIR}/pkgconfig

# for manpages in MESSAGE
SUBST_VARS=	QT_LIBDIR QT_DOC
d190 1
a190 1
	strip ${PREFIX}/lib/qt4/bin/$p
d199 1
a199 1
	mv -f ${QT_LIBDIR}/lib$l.so.$v.0 ${QT_LIBDIR}/lib$l.so.$v
a202 1
	cd ${PREFIX}/lib/qt4 && ln -sf . lib
@


1.4
log
@oops
@
text
@d1 1
a1 1
#/ $OpenBSD: Makefile,v 1.3 2005/07/04 21:16:18 espie Exp $
d15 3
a17 3
PKGNAME-debug=		qt4-debug-${VERSION}
FULLPKGNAME=		qt4-${VERSION}p1
FULLPKGNAME-html=	qt4-html-${VERSION}p1
d198 2
a199 3
	if test -f ${QT_LIBDIR}/lib$l.so.$v; then \
		ln -sf qt4/lib$l.so.$v ${PREFIX}/lib; \
	fi
@


1.3
log
@okay, let's tweak the install procedure to use what the trolltech
people want...
@
text
@d1 1
a1 1
#/ $OpenBSD: Makefile,v 1.2 2005/07/04 11:32:50 espie Exp $
a201 2

do-install:
@


1.2
log
@forgot to install default file for qt3to4.
Also fix a few typos in trolltech's sources...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2005/07/04 11:10:13 espie Exp $
d16 2
a17 2
FULLPKGNAME=		qt4-${VERSION}p0
FULLPKGNAME-html=	qt4-html-${VERSION}p0
d71 2
a72 1
CONFIGURE_ARGS+=	-plugindir ${QT_PLUGINSDIR}
d74 1
d126 1
a127 2
TRUEDIR=	${TRUEPREFIX}/lib/qt4
QT_LIBDIR=	${PREFIX}/lib/qt4
a155 3
INCDIRS=	Qt Qt/arch QtCore QtCore/arch QtXml QtGui QtSql \
		QtNetwork QtOpenGL Qt3Support QtDesigner

d161 18
a178 19
do-install:
	# libraries
	${INSTALL_DATA_DIR} ${QT_LIBDIR} ${QT_PKGCFGDIR}
.for l v in ${LIBRARIES}
	@@echo -n "Install lib $l $v"
	@@if test -f ${WRKBUILD}/lib/lib$l.a; then \
	 ${INSTALL_DATA} ${WRKBUILD}/lib/lib$l.a ${QT_LIBDIR}; \
	 echo -n " unshared"; \
	fi
	@@if test -f ${WRKBUILD}/lib/lib$l.so.$v; then \
	 ${INSTALL_DATA} ${WRKBUILD}/lib/lib$l.so.$v ${QT_LIBDIR}; \
	 ln -sf qt4/lib$l.so.$v ${PREFIX}/lib; \
	 echo -n " shared"; \
	fi
	@@if test -f ${WRKBUILD}/lib/$l.pc; then \
	    sed -e 's,-L${WRKBUILD}/lib,,g' <${WRKBUILD}/lib/$l.pc >${QT_PKGCFGDIR}/$l.pc; \
	    echo -n " cfg"; \
	fi
	@@echo
d180 2
a181 8
	# includes
	${INSTALL_DATA_DIR} ${QT_INCDIR}
.for i in ${INCDIRS}
	${INSTALL_DATA_DIR} ${QT_INCDIR}/$i
.endfor
	cd ${WRKSRC}/include; find .  -type f|while read i; do \
		${INSTALL_DATA} $$i ${QT_INCDIR}/`dirname $$i`; \
	done
d185 1
a185 1
	${INSTALL_PROGRAM} ${WRKBUILD}/bin/$p ${QT_BINDIR}/$p
d189 1
a189 1
	${INSTALL_PROGRAM} ${WRKBUILD}/bin/$p ${QT_BINDIR}/$p
d192 4
a195 15
	# data
	${INSTALL_DATA} ${WRKBUILD}/tools/porting/src/q3porting.xml ${QT_LIBDIR}
	# documentation
	${INSTALL_DATA_DIR} ${QT_DOC}/html
	${INSTALL_DATA_DIR} ${QT_DOC}/html/images
	${INSTALL_DATA} ${WRKSRC}/doc/html/*.{html,dcf} ${QT_DOC}/html
	${INSTALL_DATA} ${WRKSRC}/doc/html/images/* ${QT_DOC}/html/images
	cd ${WRKSRC}; ${INSTALL_DATA} ${DOCS} ${QT_DOC}
	# qmake stuff
	cp -R ${WRKSRC}/mkspecs ${QT_LIBDIR}/mkspecs
	# plugins
	cd ${WRKBUILD}/plugins; find .  -type f|while read i; do \
		j=`dirname $$i`; \
		${INSTALL_DATA_DIR} ${QT_PLUGINSDIR}/$$j; \
		${INSTALL_DATA} $$i ${QT_PLUGINSDIR}/$$j; \
d197 5
a201 3
	# examples and demos
	cd ${WRKBUILD}/examples && ${MAKE_PROGRAM}  install INSTALL_ROOT=${WRKINST}
	cd ${WRKBUILD}/demos && ${MAKE_PROGRAM}  install INSTALL_ROOT=${WRKINST}
d203 1
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2005/05/18 14:24:32 espie Exp $
d16 2
a17 2
FULLPKGNAME=		qt4-${VERSION}
FULLPKGNAME-html=	qt4-html-${VERSION}
d201 2
@


1.1.1.1
log
@new version of qt. nothing much uses it yet, but it looks nicer
than the old ones.
@
text
@@
