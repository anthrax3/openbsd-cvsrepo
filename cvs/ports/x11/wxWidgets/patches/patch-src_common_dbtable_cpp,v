head	1.3;
access;
symbols
	OPENBSD_6_0:1.3.0.36
	OPENBSD_6_0_BASE:1.3
	OPENBSD_5_9:1.3.0.32
	OPENBSD_5_9_BASE:1.3
	OPENBSD_5_8:1.3.0.34
	OPENBSD_5_8_BASE:1.3
	OPENBSD_5_7:1.3.0.30
	OPENBSD_5_7_BASE:1.3
	OPENBSD_5_6:1.3.0.28
	OPENBSD_5_6_BASE:1.3
	OPENBSD_5_5:1.3.0.26
	OPENBSD_5_5_BASE:1.3
	OPENBSD_5_4:1.3.0.24
	OPENBSD_5_4_BASE:1.3
	OPENBSD_5_3:1.3.0.22
	OPENBSD_5_3_BASE:1.3
	OPENBSD_5_2:1.3.0.20
	OPENBSD_5_2_BASE:1.3
	OPENBSD_5_1_BASE:1.3
	OPENBSD_5_1:1.3.0.18
	OPENBSD_5_0:1.3.0.16
	OPENBSD_5_0_BASE:1.3
	OPENBSD_4_9:1.3.0.14
	OPENBSD_4_9_BASE:1.3
	OPENBSD_4_8:1.3.0.12
	OPENBSD_4_8_BASE:1.3
	OPENBSD_4_7:1.3.0.10
	OPENBSD_4_7_BASE:1.3
	OPENBSD_4_6:1.3.0.8
	OPENBSD_4_6_BASE:1.3
	OPENBSD_4_5:1.3.0.6
	OPENBSD_4_5_BASE:1.3
	OPENBSD_4_4:1.3.0.4
	OPENBSD_4_4_BASE:1.3
	OPENBSD_4_3:1.3.0.2
	OPENBSD_4_3_BASE:1.3
	OPENBSD_4_2:1.2.0.4
	OPENBSD_4_2_BASE:1.2
	OPENBSD_4_1:1.2.0.2
	OPENBSD_4_1_BASE:1.2
	OPENBSD_4_0:1.1.1.1.0.10
	OPENBSD_4_0_BASE:1.1.1.1
	OPENBSD_3_9:1.1.1.1.0.8
	OPENBSD_3_9_BASE:1.1.1.1
	OPENBSD_3_8:1.1.1.1.0.6
	OPENBSD_3_8_BASE:1.1.1.1
	OPENBSD_3_7:1.1.1.1.0.4
	OPENBSD_3_7_BASE:1.1.1.1
	OPENBSD_3_6:1.1.1.1.0.2
	OPENBSD_3_6_BASE:1.1.1.1
	todd-Jul-16:1.1.1.1
	todd:1.1.1;
locks; strict;
comment	@# @;


1.3
date	2007.10.23.11.28.10;	author steven;	state Exp;
branches;
next	1.2;

1.2
date	2006.10.12.14.09.33;	author alek;	state Exp;
branches;
next	1.1;

1.1
date	2004.07.16.21.01.35;	author todd;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2004.07.16.21.01.35;	author todd;	state Exp;
branches;
next	;


desc
@@


1.3
log
@update to 2.8.6

tested by various people
@
text
@$OpenBSD: patch-src_common_dbtable_cpp,v 1.2 2006/10/12 14:09:33 alek Exp $
--- src/common/dbtable.cpp.orig	Tue Sep 25 10:51:21 2007
+++ src/common/dbtable.cpp	Tue Oct  2 11:53:18 2007
@@@@ -55,6 +55,10 @@@@
 #  endif
 #endif
 
+#ifndef __SQLTCHAR
+#define __SQLTCHAR SQLCHAR
+#endif
+
 ULONG lastTableID = 0;
 
 
@


1.2
log
@Update to 2.6.3; now there is only one version -- gtk2
@
text
@d1 4
a4 4
$OpenBSD$
--- src/common/dbtable.cpp.orig	Fri Sep 16 06:03:53 2005
+++ src/common/dbtable.cpp	Thu Jun  1 02:33:07 2006
@@@@ -63,6 +63,10 @@@@
@


1.1
log
@Initial revision
@
text
@d2 5
a6 5
--- src/common/dbtable.cpp.orig	Mon Dec 16 23:56:26 2002
+++ src/common/dbtable.cpp	Tue Apr 29 22:22:20 2003
@@@@ -2148,11 +2148,8 @@@@ void wxDbTable::SetColDefs(UWORD index, 
     if (!colDefs)  // May happen if the database connection fails
         return;
d8 5
a12 15
-    if (fieldName.Length() > (unsigned int) DB_MAX_COLUMN_NAME_LEN)
+    if (strlcpy(colDefs[index].ColName, fieldName, DB_MAX_COLUMN_NAME_LEN) >= DB_MAX_COLUMN_NAME_LEN)
     {
-        wxStrncpy(colDefs[index].ColName, fieldName, DB_MAX_COLUMN_NAME_LEN);
-        colDefs[index].ColName[DB_MAX_COLUMN_NAME_LEN] = 0;
-
 #ifdef __WXDEBUG__
         wxString tmpMsg;
         tmpMsg.Printf(_T("Column name '%s' is too long. Truncated to '%s'."),
@@@@ -2160,8 +2157,6 @@@@ void wxDbTable::SetColDefs(UWORD index, 
         wxFAIL_MSG(tmpMsg);
 #endif // __WXDEBUG__
     }
-    else
-        wxStrcpy(colDefs[index].ColName, fieldName);
a13 4
     colDefs[index].DbDataType       = dataType;
     colDefs[index].PtrDataObj       = pData;
@@@@ -2604,14 +2599,6 @@@@ wxVariant wxDbTable::GetCol(const int co
 }  // wxDbTable::GetCol()
a14 24
 
-void csstrncpyt(char *s, const char *t, int n)
-{
-    while ( (*s++ = *t++) != '\0' && --n )
-        ;
-
-    *s = '\0';
-}
-
 void wxDbTable::SetCol(const int colNo, const wxVariant val)
 {
     //FIXME: Add proper wxDateTime support to wxVariant..
@@@@ -2634,9 +2621,9 @@@@ void wxDbTable::SetCol(const int colNo, 
         {
             case SQL_CHAR:
             case SQL_VARCHAR:
-                csstrncpyt((char *)(colDefs[colNo].PtrDataObj),
+                strlcpy((char *)(colDefs[colNo].PtrDataObj),
                            val.GetString().c_str(),
-                           colDefs[colNo].SzDataObj-1);
+                           colDefs[colNo].SzDataObj);
                 break;
             case SQL_C_LONG:
             case SQL_C_SLONG:
@


1.1.1.1
log
@wxWidgets 2.4.2, C++ cross-platform GUI toolkit

www: http://www.wxwidgets.org/

from Andrew Dalgleish   < openbsd at ajd dot net dot au >
many thanks for much persistence!
@
text
@@
