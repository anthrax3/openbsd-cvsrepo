head	1.5;
access;
symbols
	OPENBSD_4_2:1.4.0.4
	OPENBSD_4_2_BASE:1.4
	OPENBSD_4_1:1.4.0.2
	OPENBSD_4_1_BASE:1.4
	OPENBSD_4_0:1.3.0.8
	OPENBSD_4_0_BASE:1.3
	OPENBSD_3_9:1.3.0.6
	OPENBSD_3_9_BASE:1.3
	OPENBSD_3_8:1.3.0.4
	OPENBSD_3_8_BASE:1.3
	OPENBSD_3_7:1.3.0.2
	OPENBSD_3_7_BASE:1.3
	OPENBSD_3_6:1.2.0.8
	OPENBSD_3_6_BASE:1.2
	OPENBSD_3_5:1.2.0.6
	OPENBSD_3_5_BASE:1.2
	OPENBSD_3_4:1.2.0.4
	OPENBSD_3_4_BASE:1.2
	OPENBSD_3_3:1.2.0.2
	OPENBSD_3_3_BASE:1.2;
locks; strict;
comment	@# @;


1.5
date	2007.10.24.15.40.18;	author steven;	state dead;
branches;
next	1.4;

1.4
date	2006.10.18.14.27.43;	author naddy;	state Exp;
branches;
next	1.3;

1.3
date	2004.12.05.11.39.06;	author sturm;	state Exp;
branches;
next	1.2;

1.2
date	2002.12.02.08.01.17;	author kevlo;	state Exp;
branches;
next	1.1;

1.1
date	2002.11.29.09.48.55;	author kevlo;	state Exp;
branches;
next	;


desc
@@


1.5
log
@remove old tcl/tk 8.3

ok naddy
@
text
@$OpenBSD: patch-Makefile_in,v 1.4 2006/10/18 14:27:43 naddy Exp $
--- Makefile.in.orig	Wed Oct 23 19:45:50 2002
+++ Makefile.in	Wed Oct 18 15:33:39 2006
@@@@ -356,7 +356,7 @@@@ DEMOPROGS = browse hello ixset rmt rolod
 
 all: binaries libraries doc
 
-binaries: ${TK_LIB_FILE} ${STUB_LIB_FILE} wish
+binaries: ${TK_LIB_FILE} ${STUB_LIB_FILE} libtk83.a wish
 
 libraries:
 
@@@@ -371,13 +371,16 @@@@ doc: $(SRC_DIR)/doc/man.macros
 ${TK_LIB_FILE}: ${OBJS}
 	rm -f ${TK_LIB_FILE}
 	@@MAKE_LIB@@
-	$(RANLIB) ${TK_LIB_FILE}
 
 ${STUB_LIB_FILE}: ${STUB_LIB_OBJS}
 	rm -f ${STUB_LIB_FILE}
 	@@MAKE_STUB_LIB@@
-	$(RANLIB) ${STUB_LIB_FILE}
 
+libtk83.a: ${OBJS}
+	rm -f libtk83.a
+	ar cr libtk83.a ${OBJS}
+	$(RANLIB) libtk83.a
+
 # Make target which outputs the list of the .o contained in the Tk lib
 # usefull to build a single big shared library containing Tcl/Tk and other
 # extensions.  used for the Tcl Plugin.  -- dl
@@@@ -478,12 +481,15 @@@@ install-binaries: $(TK_LIB_FILE) $(TK_ST
 	    fi
 	@@echo "Installing $(TK_LIB_FILE) to $(LIB_INSTALL_DIR)/"
 	@@$(INSTALL_DATA) $(TK_LIB_FILE) $(LIB_INSTALL_DIR)/$(TK_LIB_FILE)
-	@@(cd $(LIB_INSTALL_DIR); $(RANLIB) $(TK_LIB_FILE))
 	@@chmod 555 $(LIB_INSTALL_DIR)/$(TK_LIB_FILE)
+	@@echo "Installing libtk83.a"
+	@@$(INSTALL_DATA) libtk83.a $(LIB_INSTALL_DIR)/libtk83.a
+	@@chmod 555 $(LIB_INSTALL_DIR)/libtk83.a
 	@@echo "Installing wish as $(BIN_INSTALL_DIR)/wish$(VERSION)"
 	@@$(INSTALL_PROGRAM) wish $(BIN_INSTALL_DIR)/wish$(VERSION)
 	@@echo "Installing tkConfig.sh to $(LIB_INSTALL_DIR)/"
-	@@$(INSTALL_DATA) tkConfig.sh $(LIB_INSTALL_DIR)/tkConfig.sh
+	@@mkdir -p $(LIB_INSTALL_DIR)/tk$(VERSION)
+	@@$(INSTALL_DATA) tkConfig.sh $(LIB_INSTALL_DIR)/tk$(VERSION)/tkConfig.sh
 	@@if test "$(TK_BUILD_EXP_FILE)" != ""; then \
 	    echo "Installing $(TK_EXP_FILE) to $(LIB_INSTALL_DIR)/"; \
 	    $(INSTALL_DATA) $(TK_BUILD_EXP_FILE) \
@@@@ -497,6 +503,7 @@@@ install-binaries: $(TK_LIB_FILE) $(TK_ST
 
 install-libraries:
 	@@for i in $(INCLUDE_INSTALL_DIR) \
+		$(INSTALL_ROOT)$(GENERIC_INCLUDE_INSTALL_DIR) $(INSTALL_ROOT)$(UNIX_INCLUDE_INSTALL_DIR) \
 		$(SCRIPT_INSTALL_DIR) $(SCRIPT_INSTALL_DIR)/images; \
 	    do \
 	    if [ ! -d $$i ] ; then \
@@@@ -510,11 +517,19 @@@@ install-libraries:
 	    chmod +x $(UNIX_DIR)/install-sh; \
 	    fi
 	@@echo "Installing header files";
-	@@for i in $(GENERIC_DIR)/tk.h $(GENERIC_DIR)/tkPlatDecls.h \
-		$(GENERIC_DIR)/tkDecls.h ; \
+	@@for i in $(GENERIC_DIR)/*.h ; \
 	    do \
-	    $(INSTALL_DATA) $$i $(INCLUDE_INSTALL_DIR); \
+	    echo "Installing $$i"; \
+	    $(INSTALL_DATA) $$i $(INSTALL_ROOT)$(GENERIC_INCLUDE_INSTALL_DIR); \
+	    done
+	@@for i in $(UNIX_DIR)/*.h ; \
+	    do \
+	    $(INSTALL_DATA) $$i $(INSTALL_ROOT)$(UNIX_INCLUDE_INSTALL_DIR); \
 	    done;
+	@@ln -sf $(GENERIC_INCLUDE_INSTALL_DIR)/tk.h $(INCLUDE_INSTALL_DIR)/tk.h
+	@@ln -sf $(GENERIC_INCLUDE_INSTALL_DIR)/tkDecls.h $(INCLUDE_INSTALL_DIR)/tkDecls.h
+	@@ln -sf $(GENERIC_INCLUDE_INSTALL_DIR)/tkPlatDecls.h $(INCLUDE_INSTALL_DIR)/tkPlatDecls.h
+	@@ln -sf $(GENERIC_INCLUDE_INSTALL_DIR)/tkIntXlibDecls.h $(INCLUDE_INSTALL_DIR)/tkIntXlibDecls.h
 	@@echo "Installing library files to $(SCRIPT_INSTALL_DIR)";
 	@@for i in $(SRC_DIR)/library/*.tcl $(GENERIC_DIR)/prolog.ps \
 	        $(SRC_DIR)/library/tclIndex $(UNIX_DIR)/tkAppInit.c; \
@


1.4
log
@unconditionally use -fPIC; sync patches
@
text
@d1 1
a1 1
$OpenBSD: patch-Makefile_in,v 1.3 2004/12/05 11:39:06 sturm Exp $
@


1.3
log
@Under unclear circumstances parts of tk are recompiled in fake stage.
In this case using PREFIX in a Makefile to find installed files is
obviously wrong. In 8.3 and 8.4 this part of the patch is not necessary
at all, so just remove it. In 8.0 use TCL_LIB_SPEC, as is used in 8.3
and 8.4.

problem noted by Rod.. Whitworth <listen at witworx.com>
@
text
@d1 4
a4 4
$OpenBSD: patch-Makefile_in,v 1.2 2002/12/02 08:01:17 kevlo Exp $
--- Makefile.in.orig	Wed Oct 23 17:45:50 2002
+++ Makefile.in	Mon Dec  2 15:41:08 2002
@@@@ -356,7 +356,7 @@@@
d13 1
a13 1
@@@@ -371,12 +371,15 @@@@
d23 1
a23 1
+
d28 1
a28 1
 
d31 2
a32 1
@@@@ -478,12 +481,15 @@@@
d50 1
a50 1
@@@@ -497,6 +503,7 @@@@
d58 1
a58 1
@@@@ -510,11 +517,19 @@@@
d65 2
a66 1
+	    do \
d71 1
a71 2
 	    do \
-	    $(INSTALL_DATA) $$i $(INCLUDE_INSTALL_DIR); \
@


1.2
log
@fix to build broken with XF4; pointed out by naddy@@ and wilfried@@
@
text
@d1 1
a1 1
$OpenBSD: patch-Makefile_in,v 1.1 2002/11/29 09:48:55 kevlo Exp $
a3 9
@@@@ -203,7 +203,7 @@@@
 # Libraries to use when linking.  This definition is determined by the
 # configure script.
 LIBS = @@LIBS@@ $(X11_LIB_SWITCHES) @@DL_LIBS@@ @@MATH_LIBS@@
-WISH_LIBS = $(TCL_LIB_SPEC) @@LIBS@@ $(X11_LIB_SWITCHES) @@DL_LIBS@@ @@MATH_LIBS@@
+WISH_LIBS = -L${PREFIX}/lib -ltcl83 @@LIBS@@ $(X11_LIB_SWITCHES) @@DL_LIBS@@ @@MATH_LIBS@@
 
 # The symbol below provides support for dynamic loading and shared
 # libraries.  See configure.in for a description of what it means.
@


1.1
log
@upgrade to 8.3.5
@
text
@d1 1
a1 1
$OpenBSD$
d3 11
a13 2
+++ Makefile.in	Fri Nov 29 17:38:11 2002
@@@@ -356,7 +356,7 @@@@ DEMOPROGS = browse hello ixset rmt rolod
d22 1
a22 1
@@@@ -371,12 +371,15 @@@@ doc: $(SRC_DIR)/doc/man.macros
d40 1
a40 1
@@@@ -478,12 +481,15 @@@@ install-binaries: $(TK_LIB_FILE) $(TK_ST
d58 1
a58 1
@@@@ -497,6 +503,7 @@@@ install-binaries: $(TK_LIB_FILE) $(TK_ST
d66 1
a66 1
@@@@ -510,11 +517,19 @@@@ install-libraries:
@

