head	1.7;
access;
symbols
	OPENBSD_6_2:1.7.0.12
	OPENBSD_6_2_BASE:1.7
	OPENBSD_6_1:1.7.0.10
	OPENBSD_6_1_BASE:1.7
	OPENBSD_6_0:1.7.0.8
	OPENBSD_6_0_BASE:1.7
	OPENBSD_5_9:1.7.0.4
	OPENBSD_5_9_BASE:1.7
	OPENBSD_5_8:1.7.0.6
	OPENBSD_5_8_BASE:1.7
	OPENBSD_5_7:1.7.0.2
	OPENBSD_5_7_BASE:1.7
	OPENBSD_5_6:1.6.0.4
	OPENBSD_5_6_BASE:1.6
	OPENBSD_5_5:1.6.0.2
	OPENBSD_5_5_BASE:1.6
	OPENBSD_5_4:1.5.0.4
	OPENBSD_5_4_BASE:1.5
	OPENBSD_5_3:1.5.0.2
	OPENBSD_5_3_BASE:1.5
	OPENBSD_5_2:1.4.0.2
	OPENBSD_5_2_BASE:1.4
	OPENBSD_5_1_BASE:1.3
	OPENBSD_5_1:1.3.0.2
	OPENBSD_5_0:1.2.0.2
	OPENBSD_5_0_BASE:1.2;
locks; strict;
comment	@# @;


1.7
date	2014.09.11.21.57.00;	author jasper;	state Exp;
branches;
next	1.6;
commitid	o3Io7eAWzqaijgju;

1.6
date	2013.08.22.17.27.51;	author naddy;	state Exp;
branches;
next	1.5;

1.5
date	2012.11.15.10.12.54;	author jasper;	state Exp;
branches;
next	1.4;

1.4
date	2012.05.30.20.38.32;	author jasper;	state Exp;
branches;
next	1.3;

1.3
date	2012.01.03.16.46.36;	author sebastia;	state Exp;
branches;
next	1.2;

1.2
date	2011.03.02.13.57.06;	author jasper;	state Exp;
branches;
next	1.1;

1.1
date	2011.03.02.10.23.36;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.7
log
@update to opennx-0.16.0.729
@
text
@$OpenBSD: patch-opennxApp_cpp,v 1.6 2013/08/22 17:27:51 naddy Exp $

wxConfigBase does not support long long.

--- opennxApp.cpp.orig	Mon Nov 25 17:08:17 2013
+++ opennxApp.cpp	Thu Sep 11 23:43:08 2014
@@@@ -580,7 +580,7 @@@@ opennxApp::preInit()
         tmp = findExecutable(wxT("cupsd"));
         if (tmp.IsEmpty()) {
             const wxChar* candidates[] = {
-                wxT("/sbin/cupsd"), wxT("/usr/sbin/cupsd"), wxT("/usr/local/sbin/cupsd"),
+                wxT("/sbin/cupsd"), wxT("/usr/sbin/cupsd"), wxT("${LOCALBASE}/sbin/cupsd"),
                 NULL
             };
             int i;
@@@@ -759,9 +759,9 @@@@ void opennxApp::checkNxSmartCardSupport()
 #endif
     if (!fn.FileExists())
         return;
-    time_t last_mtime;
+    long last_mtime;
     long last_size;
-    time_t mtime = fn.GetModificationTime().GetTicks();
+    long mtime = (long)fn.GetModificationTime().GetTicks();
     long size = fn.GetSize().ToULong();
     wxConfigBase::Get()->Read(wxT("Config/NxSshStamp"), &last_mtime, 0);
     wxConfigBase::Get()->Read(wxT("Config/NxSshSize"), &last_size, 0);
@


1.6
log
@wxConfigBase does not support long long.  ok dcoppa@@
@
text
@d1 1
a1 1
$OpenBSD: patch-opennxApp_cpp,v 1.5 2012/11/15 10:12:54 jasper Exp $
d5 3
a7 3
--- opennxApp.cpp.orig	Mon Jul 30 20:04:59 2012
+++ opennxApp.cpp	Sat Aug 17 00:44:22 2013
@@@@ -575,7 +575,7 @@@@ opennxApp::preInit()
d16 1
a16 1
@@@@ -754,9 +754,9 @@@@ void opennxApp::checkNxSmartCardSupport()
@


1.5
log
@- update to opennx-0.16.0.724
@
text
@d1 3
a3 1
$OpenBSD: patch-opennxApp_cpp,v 1.4 2012/05/30 20:38:32 jasper Exp $
d6 1
a6 1
+++ opennxApp.cpp	Thu Nov 15 10:37:38 2012
d16 12
@


1.4
log
@- update to 0.16.0.709

ok aja@@ sebastia@@
@
text
@d1 1
a1 1
$OpenBSD: patch-opennxApp_cpp,v 1.3 2012/01/03 16:46:36 sebastia Exp $
d3 3
a5 3
--- opennxApp.cpp.orig	Tue May 29 16:07:01 2012
+++ opennxApp.cpp	Tue May 29 16:07:18 2012
@@@@ -572,7 +572,7 @@@@ opennxApp::preInit()
@


1.3
log
@update opennx to 0.16.0.658

getting rid of a couple of patches.

feedback and OK aja@@
@
text
@d1 1
a1 1
$OpenBSD: patch-opennxApp_cpp,v 1.2 2011/03/02 13:57:06 jasper Exp $
d3 3
a5 3
--- opennxApp.cpp.orig	Tue Dec  6 16:01:27 2011
+++ opennxApp.cpp	Fri Dec 30 10:31:38 2011
@@@@ -573,7 +573,7 @@@@ opennxApp::preInit()
d9 1
a9 1
-                wxT("/sbin/cupsd"), wxT("/usr/sbin/cupsd"), wxT("usr/local/sbin/cupsd"),
@


1.2
log
@- dont hardcode the path to cupsd.

ok aja@@
@
text
@d1 1
a1 1
$OpenBSD: patch-opennxApp_cpp,v 1.1 2011/03/02 10:23:36 jasper Exp $
d3 11
a13 44
- Added --autoresume switch.
  From upstream svn -r609.

--- opennxApp.cpp.orig	Wed Jul  8 13:50:50 2009
+++ opennxApp.cpp	Fri Feb 25 14:04:44 2011
@@@@ -96,7 +96,8 @@@@ IMPLEMENT_APP(opennxApp);
     ,m_bRunproc(false)
     ,m_bLibUSBAvailable(false)
     ,m_bRequireWatchReader(false)
-      ,m_bRequireStartUsbIp(false)
+    ,m_bRequireStartUsbIp(false)
+    ,m_bAutoResume(false)
 {
     SetAppName(wxT("OpenNX"));
 #ifdef __WXMSW__
@@@@ -531,8 +532,8 @@@@ opennxApp::preInit()
             tmp = wxT("/sbin/cupsd");
         if ((tmp.IsEmpty()) && wxFileName::IsFileExecutable(wxT("/usr/sbin/cupsd")))
             tmp = wxT("/usr/sbin/cupsd");
-        if ((tmp.IsEmpty()) && wxFileName::IsFileExecutable(wxT("usr/local/sbin/cupsd")))
-            tmp = wxT("/usr/local/sbin/cupsd");
+        if ((tmp.IsEmpty()) && wxFileName::IsFileExecutable(wxT("${LOCALBASE}/sbin/cupsd")))
+            tmp = wxT("${LOCALBASE}/sbin/cupsd");
 #endif
         wxConfigBase::Get()->Write(wxT("Config/CupsPath"), tmp);
         wxConfigBase::Get()->Flush();
@@@@ -707,6 +708,8 @@@@ void opennxApp::OnInitCmdLine(wxCmdLineParser& parser)
     }
     tags.Prepend(_("\n\nSupported trace tags: "));
 
+    parser.AddSwitch(wxEmptyString, wxT("autoresume"),
+            _("Automatically resume/takeover a session with the same name."));
     parser.AddSwitch(wxEmptyString, wxT("admin"),
             _("Start the session administration tool."));
     parser.AddOption(wxEmptyString, wxT("caption"),
@@@@ -844,6 +847,8 @@@@ bool opennxApp::OnCmdLineParsed(wxCmdLineParser& parse
         m_eMode = MODE_ADMIN;
     if (parser.Found(wxT("wizard")))
         m_eMode = MODE_WIZARD;
+    if (parser.Found(wxT("autoresume")))
+        m_bAutoResume = true;
     (void)parser.Found(wxT("session"), &m_sSessionName);
     wxString traceTags;
     if (parser.Found(wxT("trace"), &traceTags)) {
@


1.1
log
@- apply two patches from upstream svn:
* added --autoresume switch
* fix resuming a suspended session

ok ajacoutot@@
@
text
@d1 1
a1 1
$OpenBSD$
d18 11
@

