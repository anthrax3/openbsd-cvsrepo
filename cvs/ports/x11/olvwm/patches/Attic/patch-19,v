head	1.3;
access;
symbols
	OPENBSD_3_4:1.2.0.18
	OPENBSD_3_4_BASE:1.2
	OPENBSD_3_3:1.2.0.16
	OPENBSD_3_3_BASE:1.2
	OPENBSD_3_2:1.2.0.14
	OPENBSD_3_2_BASE:1.2
	OPENBSD_3_1:1.2.0.12
	OPENBSD_3_1_BASE:1.2
	OPENBSD_3_0:1.2.0.10
	OPENBSD_3_0_BASE:1.2
	OPENBSD_2_9_TRACKING_SWITCH:1.2
	OPENBSD_2_9:1.2.0.8
	OPENBSD_2_9_BASE:1.2
	OPENBSD_2_8:1.2.0.6
	OPENBSD_2_8_BASE:1.2
	OPENBSD_2_7:1.2.0.4
	OPENBSD_2_7_BASE:1.2
	OPENBSD_2_6:1.2.0.2
	OPENBSD_2_6_BASE:1.2
	OPENBSD_2_5:1.1.1.1.0.4
	OPENBSD_2_5_BASE:1.1.1.1
	OPENBSD_2_4:1.1.1.1.0.2
	OPENBSD_2_4_BASE:1.1.1.1
	ian_1998-Sep-29:1.1.1.1
	ian:1.1.1;
locks; strict;
comment	@# @;


1.3
date	2004.01.28.20.58.53;	author naddy;	state dead;
branches;
next	1.2;

1.2
date	99.07.17.10.53.22;	author matthieu;	state Exp;
branches;
next	1.1;

1.1
date	98.09.30.02.31.44;	author ian;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	98.09.30.02.31.44;	author ian;	state Exp;
branches;
next	;


desc
@@


1.3
log
@regen patches
@
text
@--- olvwmrc.y.orig	Thu Jan 13 22:46:53 1994
+++ ./olvwmrc.y	Sat Jul 17 10:04:15 1999
@@@@ -5,7 +5,7 @@@@
 
 %{
 #ifdef IDENT
-#ident  "@@(#)olvwmrc.y	1.6 olvwm version 07 Jan 1994"
+#ident  "@@(#)olvwmrc.y	1.7 olvwm version 01/13/98"
 #endif
 
 #include <sys/types.h>
@@@@ -81,6 +81,7 @@@@
 List	*WinMenuActionsList = NULL;
 
 static Display	*dpy;
+static unsigned int NumLockMask;
 %}
 
 
@@@@ -526,7 +527,9 @@@@
 	    }
 %%
 /* Programs */
+#ifndef YYDEBUG
 #define YYDEBUG 1
+#endif
 #include "parse.c"
 
 extern List	*ActiveClientList;
@@@@ -577,7 +580,7 @@@@
    return(True);
 }
 
-static char *
+extern char *
 strexpand(s)
 char *s;
 {
@@@@ -712,7 +715,8 @@@@
 
 {
     if (p->keycode == ev->xkey.keycode &&
-	(p->modmask == AnyModifier || p->modmask == ev->xkey.state))
+	(p->modmask == AnyModifier ||
+	(p->modmask == (~(NumLockMask|LockMask) & ev->xkey.state))))
 	return p;
     return NULL;
 }
@@@@ -799,14 +803,26 @@@@
 		    extern List *ScreenInfoList;
 		    List *l = ScreenInfoList;
 		    ScreenInfo *scr;
+		    Client *saveClient = NULL;
+		    Window root, child;
+		    int rx, ry, wx, wy;
+		    unsigned int keys;
 
 		    /* allow one warp per screen */
 		    for (scr = ListEnum(&l); scr != NULL; scr = ListEnum(&l)) {
 			findClient_rootid = scr->rootid;
 			c = (Client *) ListApply(ActiveClientList, findClient, t);
-			if (c)
-			    clientWarp(c);
+			if (c) {
+			    if (XQueryPointer(dpy, c->groupid, &root, &child,
+					&rx, &ry, &wx, &wy, &keys)) {
+			        clientWarp(c);
+				break;
+			    }
+			    else saveClient = c;
+			}
 		    }
+		    if (saveClient)
+			clientWarp(c);
 		    findClient_rootid = 0;
 		}
 	    free(s);
@@@@ -1249,6 +1265,7 @@@@
 	return;
     olvwmOldBuf = olvwmBuf;
     dpy = ldpy;
+    NumLockMask = FindModifierMask(XKeysymToKeycode(dpy, XK_Num_Lock));
     yyparse();
 #ifdef DEBUG
     DumpProgKeyList();
@


1.2
log
@Integrate patchlevel 2 by Scott Oaks (scott.oaks@@sun.com)

Version 4.2 fixes:
    1)  Fixed problems with windows that have a compound text title

    2)  Fixed problems with the cursor font name

    3)  error.c will now compile under Solaris 2.6

    4)  Fixed misc. compilation warnings.  Some survive in error.c and states.c

    5)  Fixed warp function when two screens have the same program:  warp will
        now look first on the screen containing the mouse pointer

    6)  Fixed hot key functions when num lock/shift lock might be pressed

    7)  Fixed problem with AutoRootMenu startup

    8)  Fixed problem with VirtualIconic resource
@
text
@@


1.1
log
@Initial revision
@
text
@d1 2
a2 2
--- resources.c.orig	Thu Jan 13 16:36:14 1994
+++ resources.c	Tue Sep 29 22:08:31 1998
a3 1
  */
d5 1
d7 2
a8 2
-#ident "@@(#)resources.c	1.6 olvwm version 07 Jan 1994"
+#ident "@@(#)resources.c	1.7 olvwm version 09 Feb 1994"
d11 15
a25 6
 /*
@@@@ -1577,7 +1577,7 @@@@
 	    GRV.lc_ilang.locale ? GRV.lc_ilang.locale : "(null)",
 	    GRV.lc_numeric.locale ? GRV.lc_numeric.locale : "(null)",
 	    GRV.lc_datefmt.locale ? GRV.lc_datefmt.locale : "(null)");
-										#endif
d27 13
d41 16
d58 28
a85 1
 /* ===== Updaters ========================================================= */
@


1.1.1.1
log
@olvwm port
@
text
@@
