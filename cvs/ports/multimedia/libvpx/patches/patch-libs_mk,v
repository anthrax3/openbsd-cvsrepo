head	1.13;
access;
symbols
	OPENBSD_6_1:1.13.0.2
	OPENBSD_6_1_BASE:1.13
	OPENBSD_6_0:1.10.0.4
	OPENBSD_6_0_BASE:1.10
	OPENBSD_5_9:1.10.0.2
	OPENBSD_5_9_BASE:1.10
	OPENBSD_5_8:1.9.0.4
	OPENBSD_5_8_BASE:1.9
	OPENBSD_5_7:1.8.0.4
	OPENBSD_5_7_BASE:1.8
	OPENBSD_5_6:1.8.0.2
	OPENBSD_5_6_BASE:1.8
	OPENBSD_5_5:1.6.0.6
	OPENBSD_5_5_BASE:1.6
	OPENBSD_5_4:1.6.0.4
	OPENBSD_5_4_BASE:1.6
	OPENBSD_5_3:1.6.0.2
	OPENBSD_5_3_BASE:1.6
	OPENBSD_5_2:1.5.0.2
	OPENBSD_5_2_BASE:1.5
	OPENBSD_5_1_BASE:1.3
	OPENBSD_5_1:1.3.0.4
	OPENBSD_5_0:1.3.0.2
	OPENBSD_5_0_BASE:1.3
	OPENBSD_4_9:1.2.0.2
	OPENBSD_4_9_BASE:1.2
	ckuethe_20101004:1.1.1.1
	ckuethe:1.1.1;
locks; strict;
comment	@# @;


1.13
date	2017.02.18.14.06.20;	author landry;	state Exp;
branches;
next	1.12;
commitid	JJizXGstcxCrGng3;

1.12
date	2017.01.15.09.59.11;	author ajacoutot;	state Exp;
branches;
next	1.11;
commitid	GKi2f0UlSuvApYRZ;

1.11
date	2016.08.07.01.33.52;	author ajacoutot;	state Exp;
branches;
next	1.10;
commitid	Ff3yLMKH563GGm0b;

1.10
date	2015.11.13.07.14.26;	author ajacoutot;	state Exp;
branches;
next	1.9;
commitid	v8oVJJILth66Yude;

1.9
date	2015.04.26.07.58.22;	author ajacoutot;	state Exp;
branches;
next	1.8;
commitid	5ZWrxJX3TDw6pU0R;

1.8
date	2014.04.29.23.58.06;	author brad;	state Exp;
branches;
next	1.7;

1.7
date	2014.03.17.14.01.09;	author brad;	state Exp;
branches;
next	1.6;

1.6
date	2012.08.27.20.42.25;	author jasper;	state Exp;
branches;
next	1.5;

1.5
date	2012.05.22.18.22.50;	author ajacoutot;	state Exp;
branches;
next	1.4;

1.4
date	2012.02.28.12.28.29;	author dcoppa;	state Exp;
branches;
next	1.3;

1.3
date	2011.03.17.16.54.16;	author edd;	state Exp;
branches;
next	1.2;

1.2
date	2010.10.31.21.05.38;	author ckuethe;	state Exp;
branches;
next	1.1;

1.1
date	2010.10.04.23.56.16;	author ckuethe;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2010.10.04.23.56.16;	author ckuethe;	state Exp;
branches;
next	;


desc
@@


1.13
log
@Remove -Wno-unknown-warning-option -Wno-clobbered when building
vp8/encoder/onyx_if.c and vp8/decoder/onyxd_if.c, those options only
exist in clang or recent gccs (?) - unbreaks the build on at least
macppc and loongson, maybe sparc64.

From Donovan Watteau, who tested this on loongson. Tested by myself on
macppc.
@
text
@$OpenBSD: patch-libs_mk,v 1.12 2017/01/15 09:59:11 ajacoutot Exp $
--- libs.mk.orig	Thu Jan 12 21:27:27 2017
+++ libs.mk	Fri Feb 17 20:11:49 2017
@@@@ -115,10 +115,6 @@@@ endif
 
 # Suppress -Wextra warnings in third party code.
 $(BUILD_PFX)third_party/googletest/%.cc.o: CXXFLAGS += -Wno-missing-field-initializers
-# Suppress -Wextra warnings in first party code pending investigation.
-# https://bugs.chromium.org/p/webm/issues/detail?id=1069
-$(BUILD_PFX)vp8/encoder/onyx_if.c.o: CFLAGS += -Wno-unknown-warning-option -Wno-clobbered
-$(BUILD_PFX)vp8/decoder/onyxd_if.c.o: CFLAGS += -Wno-unknown-warning-option -Wno-clobbered
 
 ifeq ($(CONFIG_MSVS),yes)
 CODEC_LIB=$(if $(CONFIG_STATIC_MSVCRT),vpxmt,vpxmd)
@@@@ -255,22 +251,17 @@@@ EXPORT_FILE             := libvpx.def
 LIBVPX_SO_SYMLINKS      :=
 LIBVPX_SO_IMPLIB        := libvpx_dll.a
 else
-LIBVPX_SO               := libvpx.so.$(SO_VERSION_MAJOR).$(SO_VERSION_MINOR).$(SO_VERSION_PATCH)
+LIBVPX_SO               := libvpx.so.$(LIBVPX_VERSION)
 SHARED_LIB_SUF          := .so
 EXPORT_FILE             := libvpx.ver
-LIBVPX_SO_SYMLINKS      := $(addprefix $(LIBSUBDIR)/, \
-                             libvpx.so libvpx.so.$(SO_VERSION_MAJOR) \
-                             libvpx.so.$(SO_VERSION_MAJOR).$(SO_VERSION_MINOR))
 endif
 endif
 endif
 
 LIBS-$(CONFIG_SHARED) += $(BUILD_PFX)$(LIBVPX_SO)\
-                           $(notdir $(LIBVPX_SO_SYMLINKS)) \
                            $(if $(LIBVPX_SO_IMPLIB), $(BUILD_PFX)$(LIBVPX_SO_IMPLIB))
 $(BUILD_PFX)$(LIBVPX_SO): $(LIBVPX_OBJS) $(EXPORT_FILE)
 $(BUILD_PFX)$(LIBVPX_SO): extralibs += -lm
-$(BUILD_PFX)$(LIBVPX_SO): SONAME = libvpx.so.$(SO_VERSION_MAJOR)
 $(BUILD_PFX)$(LIBVPX_SO): EXPORTS_FILE = $(EXPORT_FILE)
 
 libvpx.ver: $(call enabled,CODEC_EXPORTS)
@@@@ -305,15 +296,7 @@@@ $(1): $(2)
 	$(qexec)ln -sf $(2) $$@@
 endef
 
-$(eval $(call libvpx_symlink_template,\
-    $(addprefix $(BUILD_PFX),$(notdir $(LIBVPX_SO_SYMLINKS))),\
-    $(BUILD_PFX)$(LIBVPX_SO)))
-$(eval $(call libvpx_symlink_template,\
-    $(addprefix $(DIST_DIR)/,$(LIBVPX_SO_SYMLINKS)),\
-    $(LIBVPX_SO)))
 
-
-INSTALL-LIBS-$(CONFIG_SHARED) += $(LIBVPX_SO_SYMLINKS)
 INSTALL-LIBS-$(CONFIG_SHARED) += $(LIBSUBDIR)/$(LIBVPX_SO)
 INSTALL-LIBS-$(CONFIG_SHARED) += $(if $(LIBVPX_SO_IMPLIB),$(LIBSUBDIR)/$(LIBVPX_SO_IMPLIB))
 
@


1.12
log
@Update to libvpx-1.6.1.

from Brad (maintainer)
@
text
@d1 15
a15 4
$OpenBSD: patch-libs_mk,v 1.11 2016/08/07 01:33:52 ajacoutot Exp $
--- libs.mk.orig	Thu Jan 12 15:27:27 2017
+++ libs.mk	Sat Jan 14 18:47:23 2017
@@@@ -255,22 +255,17 @@@@ EXPORT_FILE             := libvpx.def
d39 1
a39 1
@@@@ -305,15 +300,7 @@@@ $(1): $(2)
@


1.11
log
@Update to libvpx-1.6.0.

from Brad (maintainer)
@
text
@d1 4
a4 4
$OpenBSD: patch-libs_mk,v 1.10 2015/11/13 07:14:26 ajacoutot Exp $
--- libs.mk.orig	Wed Jul 20 21:15:41 2016
+++ libs.mk	Fri Aug  5 19:19:11 2016
@@@@ -252,22 +252,17 @@@@ EXPORT_FILE             := libvpx.def
d28 1
a28 1
@@@@ -302,15 +297,7 @@@@ $(1): $(2)
@


1.10
log
@Update to libvpx-1.5.0.

from Brad (maintainer)
@
text
@d1 4
a4 4
$OpenBSD: patch-libs_mk,v 1.9 2015/04/26 07:58:22 ajacoutot Exp $
--- libs.mk.orig	Mon Nov  9 17:12:38 2015
+++ libs.mk	Thu Nov 12 01:31:23 2015
@@@@ -277,21 +277,16 @@@@ EXPORT_FILE             := libvpx.def
d17 1
d28 1
a28 1
@@@@ -326,15 +321,7 @@@@ $(1): $(2)
@


1.9
log
@Update to libvpx-1.4.0.
Run-time tested on amd64, i386 and sparc64. Build tested on hppa.

from brad (maintainer)
@
text
@d1 6
a6 6
$OpenBSD: patch-libs_mk,v 1.8 2014/04/29 23:58:06 brad Exp $
--- libs.mk.orig	Tue Mar 31 11:01:15 2015
+++ libs.mk	Tue Mar 31 11:15:46 2015
@@@@ -239,18 +239,14 @@@@ EXPORT_FILE             := libvpx.syms
 LIBVPX_SO_SYMLINKS      := $(addprefix $(LIBSUBDIR)/, \
                              libvpx.dylib  )
a8 1
+
d10 1
d16 1
d18 3
a20 3
-LIBS-$(BUILD_LIBVPX_SO) += $(BUILD_PFX)$(LIBVPX_SO)\
-                           $(notdir $(LIBVPX_SO_SYMLINKS))
+LIBS-$(BUILD_LIBVPX_SO) += $(BUILD_PFX)$(LIBVPX_SO)
d27 1
a27 1
@@@@ -272,15 +268,7 @@@@ $(1): $(2)
d39 3
a41 3
-INSTALL-LIBS-$(BUILD_LIBVPX_SO) += $(LIBVPX_SO_SYMLINKS)
 INSTALL-LIBS-$(BUILD_LIBVPX_SO) += $(LIBSUBDIR)/$(LIBVPX_SO)
 
@


1.8
log
@Update to libvpx 1.3.0.

ok ajacoutot@@
@
text
@d1 4
a4 4
$OpenBSD: patch-libs_mk,v 1.6 2012/08/27 20:42:25 jasper Exp $
--- libs.mk.orig	Fri Jan 10 15:12:42 2014
+++ libs.mk	Mon Feb 17 15:19:19 2014
@@@@ -271,19 +271,14 @@@@ EXPORT_FILE             := libvpx.syms
d8 2
a9 1
-LIBVPX_SO               := libvpx.so.$(VERSION_MAJOR).$(VERSION_MINOR).$(VERSION_PATCH)
a11 1
 SYM_LINK                := libvpx.so
d13 2
a14 2
-                             libvpx.so libvpx.so.$(VERSION_MAJOR) \
-                             libvpx.so.$(VERSION_MAJOR).$(VERSION_MINOR))
d22 1
a22 1
-$(BUILD_PFX)$(LIBVPX_SO): SONAME = libvpx.so.$(VERSION_MAJOR)
d26 1
a26 1
@@@@ -305,15 +300,7 @@@@ $(1): $(2)
@


1.7
log
@Update to libvpx 1.2.0.

ok sthen@@
@
text
@d2 14
a15 4
--- libs.mk.orig	Mon Oct 14 14:16:36 2013
+++ libs.mk	Thu Dec  5 21:38:34 2013
@@@@ -181,16 +181,11 @@@@ LIBS-$(if $(BUILD_LIBVPX),$(CONFIG_STATIC)) += $(BUILD
 $(BUILD_PFX)libvpx_g.a: $(LIBVPX_OBJS)
a16 2
 BUILD_LIBVPX_SO         := $(if $(BUILD_LIBVPX),$(CONFIG_SHARED))
-LIBVPX_SO               := libvpx.so.$(VERSION_MAJOR).$(VERSION_MINOR).$(VERSION_PATCH)
a18 1
+LIBVPX_SO               := libvpx.so.$(LIBVPX_VERSION)
d20 1
a20 1
 $(BUILD_PFX)$(LIBVPX_SO): $(LIBVPX_OBJS) libvpx.ver
d23 1
a23 4
 $(BUILD_PFX)$(LIBVPX_SO): SO_VERSION_SCRIPT = libvpx.ver
-LIBVPX_SO_SYMLINKS      := $(addprefix $(LIBSUBDIR)/, \
-                             libvpx.so libvpx.so.$(VERSION_MAJOR) \
-                             libvpx.so.$(VERSION_MAJOR).$(VERSION_MINOR))
d26 2
a27 3
 	@@echo "    [CREATE] $@@"
@@@@ -205,14 +200,6 @@@@ $(1): $(2)
 	$(qexec)ln -sf $(LIBVPX_SO) $$@@
d35 2
a36 1
-    $(DIST_DIR)/$(LIBSUBDIR)/$(LIBVPX_SO)))
d38 3
a40 2
-INSTALL-LIBS-$(CONFIG_SHARED) += $(LIBVPX_SO_SYMLINKS)
 INSTALL-LIBS-$(CONFIG_SHARED) += $(LIBSUBDIR)/$(LIBVPX_SO)
a41 1
 LIBS-$(BUILD_LIBVPX) += vpx.pc
@


1.6
log
@- remove -pthread patching and pass --no-undefined now that that's accepted

from brad
@
text
@d1 4
a4 4
$OpenBSD: patch-libs_mk,v 1.5 2012/05/22 18:22:50 ajacoutot Exp $
--- libs.mk.orig	Tue May  8 19:14:00 2012
+++ libs.mk	Thu Aug 16 18:54:05 2012
@@@@ -193,16 +193,11 @@@@ LIBS-$(if $(BUILD_LIBVPX),$(CONFIG_STATIC)) += $(BUILD
d23 1
a23 1
@@@@ -217,14 +212,6 @@@@ $(1): $(2)
a37 8
@@@@ -242,6 +229,7 @@@@ vpx.pc: config.mk libs.mk
 	$(qexec)echo 'Requires:' >> $@@
 	$(qexec)echo 'Conflicts:' >> $@@
 	$(qexec)echo 'Libs: -L$${libdir} -lvpx' >> $@@
+	$(qexec)echo 'Libs.private: -lm -lpthread' >> $@@
 	$(qexec)echo 'Cflags: -I$${includedir}' >> $@@
 INSTALL-LIBS-yes += $(LIBSUBDIR)/pkgconfig/vpx.pc
 INSTALL_MAPS += $(LIBSUBDIR)/pkgconfig/%.pc %.pc
@


1.5
log
@Update to libvpx 1.1.0.
Also patched to fix operation on strict alignment archs: this fixes
libvpx on alpha/arm/hppa/mips64/sparc/sparc64.

from Brad (maintainer)
@
text
@d1 1
a1 1
$OpenBSD: patch-libs_mk,v 1.4 2012/02/28 12:28:29 dcoppa Exp $
d3 1
a3 1
+++ libs.mk	Wed May 16 17:07:35 2012
d38 1
a38 2
@@@@ -241,7 +228,7 @@@@ vpx.pc: config.mk libs.mk
 	$(qexec)echo 'Version: $(VERSION_MAJOR).$(VERSION_MINOR).$(VERSION_PATCH)' >> $@@
d41 2
a42 2
-	$(qexec)echo 'Libs: -L$${libdir} -lvpx' >> $@@
+	$(qexec)echo 'Libs: -L$${libdir} -lvpx -pthread' >> $@@
@


1.4
log
@Update to libvpx 1.0.0.

From brad, with tweaks by me.
@
text
@d1 4
a4 4
$OpenBSD: patch-libs_mk,v 1.3 2011/03/17 16:54:16 edd Exp $
--- libs.mk.orig	Fri Jan 27 13:36:39 2012
+++ libs.mk	Thu Feb 23 15:00:49 2012
@@@@ -192,16 +192,11 @@@@ LIBS-$(if $(BUILD_LIBVPX),$(CONFIG_STATIC)) += $(BUILD
d23 1
a23 1
@@@@ -216,14 +211,6 @@@@ $(1): $(2)
d38 1
a38 1
@@@@ -240,7 +227,7 @@@@ vpx.pc: config.mk libs.mk
@


1.3
log
@update to libvpx 0.9.6 from brad.

OK by MAINTAINER (brad)
@
text
@d1 4
a4 4
$OpenBSD: patch-libs_mk,v 1.2 2010/10/31 21:05:38 ckuethe Exp $
--- libs.mk.orig	Fri Mar  4 15:40:39 2011
+++ libs.mk	Tue Mar  8 21:12:29 2011
@@@@ -157,15 +157,11 @@@@ LIBS-$(BUILD_LIBVPX) += $(BUILD_PFX)libvpx.a $(BUILD_P
d9 2
d12 1
a12 1
 LIBS-$(BUILD_LIBVPX_SO) += $(BUILD_PFX)$(LIBVPX_SO)
d14 1
a14 1
 $(BUILD_PFX)$(LIBVPX_SO): extralibs += -lm -pthread
d23 3
a25 3
@@@@ -178,7 +174,6 @@@@ $(addprefix $(DIST_DIR)/,$(LIBVPX_SO_SYMLINKS)):
 	@@echo "    [LN]      $@@"
 	$(qexec)ln -sf $(LIBVPX_SO) $@@
d27 7
a35 1
 endif
d37 10
@


1.2
log
@update to libvpx 0.9.5, from brad. tested with an upcoming update of mplayer
ok edd@@
@
text
@d1 4
a4 4
$OpenBSD: patch-libs_mk,v 1.1.1.1 2010/10/04 23:56:16 ckuethe Exp $
--- libs.mk.orig	Thu Oct 28 09:14:14 2010
+++ libs.mk	Thu Oct 28 21:59:19 2010
@@@@ -180,15 +180,11 @@@@ LIBS-$(BUILD_LIBVPX) += $(BUILD_PFX)libvpx.a $(BUILD_P
d21 1
a21 1
@@@@ -201,7 +197,6 @@@@ $(addprefix $(DIST_DIR)/,$(LIBVPX_SO_SYMLINKS)):
@


1.1
log
@Initial revision
@
text
@d1 4
a4 4
$OpenBSD$
--- libs.mk.orig	Thu Sep  2 14:56:47 2010
+++ libs.mk	Sat Sep 25 16:40:26 2010
@@@@ -178,15 +178,11 @@@@ LIBS-$(BUILD_LIBVPX) += $(BUILD_PFX)libvpx.a $(BUILD_P
d21 1
a21 1
@@@@ -199,7 +195,6 @@@@ $(addprefix $(DIST_DIR)/,$(LIBVPX_SO_SYMLINKS)):
@


1.1.1.1
log
@import of the Google/ON2 VP8 codec, from brad
@
text
@@
