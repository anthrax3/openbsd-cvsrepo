head	1.6;
access;
symbols;
locks; strict;
comment	@# @;


1.6
date	2016.02.04.09.23.20;	author czarkoff;	state dead;
branches;
next	1.5;
commitid	vfT0rceP7gCZbEdj;

1.5
date	2016.01.12.09.09.57;	author czarkoff;	state Exp;
branches;
next	1.4;
commitid	nR2EQZKQYa7AEoKU;

1.4
date	2016.01.08.18.47.01;	author feinerer;	state Exp;
branches;
next	1.3;
commitid	D19nSrJQpGyb56NV;

1.3
date	2015.11.22.18.33.04;	author czarkoff;	state Exp;
branches;
next	1.2;
commitid	w5Jn0A1mkJ140Agn;

1.2
date	2015.09.26.04.02.31;	author czarkoff;	state Exp;
branches;
next	1.1;
commitid	271C5piWylstfuPU;

1.1
date	2015.09.10.10.43.06;	author bentley;	state Exp;
branches;
next	;
commitid	JbRoyRoDlKKC24Lj;


desc
@@


1.6
log
@update to mpv-0.15.0

changes:

 - old-configure is gone, so use waf
 - instead of patching cd/dvd device names, use sed
 - explicitly disable dependencies we don't have but may get in future

ok, tweaks and testing bentley@@, jasper@@ and sthen@@
@
text
@$OpenBSD: patch-TOOLS_old-configure,v 1.5 2016/01/12 09:09:57 czarkoff Exp $

- Adjust for BSD fstatfs
- Disable the use of SSE4 intrinsics
- Disable the use of C11
- Disable extra compiler flags

--- TOOLS/old-configure.orig	Fri Dec 11 19:20:29 2015
+++ TOOLS/old-configure	Sat Jan  9 20:35:38 2016
@@@@ -379,16 +379,8 @@@@ cflag_check -pipe -I. && _pipe="-pipe" && echores "yes
 
 addcflags() { cflag_check "$@@" && OURCFLAGS="$OURCFLAGS $@@" ; }
 
-OURCFLAGS="-std=c99 -Wall $_opt"
+OURCFLAGS="-std=c99 $_opt"
 
-addcflags -g -g3 -ggdb
-addcflags -Wundef -Wmissing-prototypes -Wshadow -Wno-switch -Wparentheses -Wpointer-arith -Wno-redundant-decls -Wno-pointer-sign -Werror=implicit-function-declaration -Wno-error=deprecated-declarations -Wno-error=unused-function
-# clang
-addcflags -Wno-logical-op-parentheses -fcolor-diagnostics -Wno-tautological-compare -Wno-tautological-constant-out-of-range-compare
-# extra
-addcflags -Wno-format-zero-length -Wempty-body -Wdisabled-optimization -Wstrict-prototypes
-
-cflag_check -MD -MP && DEPFLAGS="-MD -MP"
 cflag_check -lm && _ld_lm="-lm"
 
 extra_ldflags="$extra_ldflags $LDFLAGS"
@@@@ -827,8 +819,12 @@@@ check_pkg_config "libavdevice" $_libavdevice LIBAVDEVI
 
 check_trivial "TV interface" $_tv TV
 
+_v4l2_header=linux/videodev2.h
+if test $(uname -s) = OpenBSD ; then
+    _v4l2_header=sys/videoio.h
+fi
 check_statement_libs "Video 4 Linux 2 TV interface" $_tv_v4l2 TV_V4L2 \
-    "sys/time.h linux/videodev2.h"
+    "sys/time.h ${_v4l2_header}"
 _tv_v4l2=$(defretval)
 check_trivial "TV audio input" $_tv_v4l2 AUDIO_INPUT
 
@@@@ -938,8 +934,8 @@@@ cat > $TMPC << EOF
 
 /* we didn't bother to add actual config checks for this, or they are
    for platforms not supported by this configure script */
-#define HAVE_BSD_FSTATFS 0
-#define HAVE_LINUX_FSTATFS 1
+#define HAVE_BSD_FSTATFS 1
+#define HAVE_LINUX_FSTATFS 0
 #define HAVE_GL_COCOA 0
 #define HAVE_COCOA 0
 #define HAVE_COCOA_APPLICATION 0
@@@@ -969,10 +965,10 @@@@ cat > $TMPC << EOF
 #define HAVE_EGL_DRM 0
 #define HAVE_VIDEOTOOLBOX_HWACCEL 0
 #define HAVE_VIDEOTOOLBOX_GL 0
-#define HAVE_SSE4_INTRINSICS 1
-#define HAVE_C11_TLS 1
+#define HAVE_SSE4_INTRINSICS 0
+#define HAVE_C11_TLS 0
 #define HAVE_EGL_ANGLE 0
-#define HAVE_GPL3 1
+#define HAVE_GPL3 0
 #define HAVE_WIN32 0
 
 #ifdef __OpenBSD__
@


1.5
log
@update to mpv 0.14.0

Original patch from brad@@

OK feinerer@@, sthen@@
@
text
@d1 1
a1 1
$OpenBSD: patch-TOOLS_old-configure,v 1.4 2016/01/08 18:47:01 feinerer Exp $
@


1.4
log
@Use libv4l

OK ajacoutot@@
@
text
@d1 1
a1 1
$OpenBSD: patch-TOOLS_old-configure,v 1.3 2015/11/22 18:33:04 czarkoff Exp $
d6 1
d8 22
a29 3
--- TOOLS/old-configure.orig	Tue Nov 10 19:14:14 2015
+++ TOOLS/old-configure	Mon Nov 23 17:41:01 2015
@@@@ -829,7 +829,7 @@@@ check_pkg_config "libavdevice" $_libavdevice LIBAVDEVI
d32 4
d38 1
a38 1
+    "sys/time.h sys/videoio.h"
d42 1
a42 1
@@@@ -942,8 +942,8 @@@@ cat > $TMPC << EOF
d53 1
a53 1
@@@@ -973,8 +973,8 @@@@ cat > $TMPC << EOF
d61 4
a66 1
 #define DEFAULT_CDROM_DEVICE "/dev/rcd0c"
@


1.3
log
@update mpv to 0.13.0

Patch from brad@@
@
text
@d1 1
a1 1
$OpenBSD: patch-TOOLS_old-configure,v 1.2 2015/09/26 04:02:31 czarkoff Exp $
d7 11
a17 2
--- TOOLS/old-configure.orig	Tue Nov 10 13:14:14 2015
+++ TOOLS/old-configure	Sun Nov 15 17:43:54 2015
@


1.2
log
@Update to mpv 0.11.0

From brad@@, ok ajacoutot@@
@
text
@d1 9
a9 4
$OpenBSD: patch-TOOLS_old-configure,v 1.1 2015/09/10 10:43:06 bentley Exp $
--- TOOLS/old-configure.orig	Tue Sep 22 19:13:22 2015
+++ TOOLS/old-configure	Wed Sep 23 03:20:42 2015
@@@@ -924,8 +924,8 @@@@ cat > $TMPC << EOF
d17 14
a30 3
 #define HAVE_VDA_AV_VDA_ALLOC_CONTEXT 0
 #define HAVE_VDA_HWACCEL 0
 #define HAVE_VDA_LIBAVCODEC_REFCOUNTING 0
@


1.1
log
@Update to mpv-0.10.0.

from brad. ok ajacoutot@@
@
text
@d1 4
a4 4
$OpenBSD$
--- TOOLS/old-configure.orig	Fri Sep  4 00:01:29 2015
+++ TOOLS/old-configure	Fri Sep  4 00:01:39 2015
@@@@ -925,8 +925,8 @@@@ cat > $TMPC << EOF
@

