head	1.20;
access;
symbols
	OPENBSD_6_2:1.20.0.2
	OPENBSD_6_2_BASE:1.20
	OPENBSD_6_1:1.18.0.2
	OPENBSD_6_1_BASE:1.18
	OPENBSD_6_0:1.16.0.4
	OPENBSD_6_0_BASE:1.16
	OPENBSD_5_9:1.16.0.2
	OPENBSD_5_9_BASE:1.16
	OPENBSD_5_8:1.12.0.4
	OPENBSD_5_8_BASE:1.12
	OPENBSD_5_7:1.11.0.2
	OPENBSD_5_7_BASE:1.11
	OPENBSD_5_6:1.9.0.2
	OPENBSD_5_6_BASE:1.9
	OPENBSD_5_5:1.6.0.4
	OPENBSD_5_5_BASE:1.6
	OPENBSD_5_4:1.6.0.2
	OPENBSD_5_4_BASE:1.6
	OPENBSD_5_3:1.2.0.2
	OPENBSD_5_3_BASE:1.2
	sthen_20121010:1.1.1.1
	sthen:1.1.1;
locks; strict;
comment	@# @;


1.20
date	2017.08.29.11.42.22;	author sthen;	state Exp;
branches;
next	1.19;
commitid	j1lHrqoCPJbtQdYN;

1.19
date	2017.05.21.14.52.54;	author sthen;	state Exp;
branches;
next	1.18;
commitid	7OQkXiVfJShBLqcA;

1.18
date	2016.09.23.09.16.56;	author sthen;	state Exp;
branches;
next	1.17;
commitid	XLnI6AbHAmyVU5mO;

1.17
date	2016.08.26.10.19.08;	author jca;	state Exp;
branches;
next	1.16;
commitid	DXdOJ2zGsFppA1oF;

1.16
date	2015.12.16.23.26.14;	author sthen;	state Exp;
branches;
next	1.15;
commitid	hgGxgoGz8gQFE5xA;

1.15
date	2015.10.13.10.34.00;	author sthen;	state Exp;
branches;
next	1.14;
commitid	YT5n6YS8po9Up6v3;

1.14
date	2015.09.11.09.51.12;	author sthen;	state Exp;
branches;
next	1.13;
commitid	VsU8l8YUUQw8T9Fs;

1.13
date	2015.09.11.09.16.23;	author sthen;	state Exp;
branches;
next	1.12;
commitid	QQm7O2NbCQpzYgSl;

1.12
date	2015.07.16.21.46.54;	author sthen;	state Exp;
branches;
next	1.11;
commitid	UNnXiAL9mQfArHJf;

1.11
date	2015.01.25.14.07.26;	author sthen;	state Exp;
branches;
next	1.10;
commitid	azsvruB6hJOTgDlW;

1.10
date	2014.09.03.21.15.43;	author sthen;	state Exp;
branches;
next	1.9;
commitid	rmInN5G2W3MyWofZ;

1.9
date	2014.06.11.01.07.44;	author sthen;	state Exp;
branches;
next	1.8;
commitid	Ot9Uwa13LWvqrheu;

1.8
date	2014.06.11.00.26.59;	author sthen;	state Exp;
branches;
next	1.7;
commitid	PrXBEjCHbpnebbI2;

1.7
date	2014.03.09.21.04.05;	author sthen;	state Exp;
branches;
next	1.6;

1.6
date	2013.05.07.20.37.23;	author sthen;	state Exp;
branches
	1.6.4.1;
next	1.5;

1.5
date	2013.03.15.17.15.24;	author sthen;	state Exp;
branches;
next	1.4;

1.4
date	2013.03.11.11.35.44;	author espie;	state Exp;
branches;
next	1.3;

1.3
date	2013.03.03.22.37.07;	author sthen;	state Exp;
branches;
next	1.2;

1.2
date	2012.10.11.17.59.05;	author sthen;	state Exp;
branches;
next	1.1;

1.1
date	2012.10.10.10.45.05;	author sthen;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2012.10.10.10.45.05;	author sthen;	state Exp;
branches;
next	;

1.6.4.1
date	2014.06.11.01.10.41;	author sthen;	state Exp;
branches;
next	;
commitid	TKEE00LsGgWSX1Qf;


desc
@@


1.20
log
@update to minidlna-1.2.1
@
text
@# $OpenBSD: Makefile,v 1.19 2017/05/21 14:52:54 sthen Exp $

COMMENT=	lightweight DLNA/UPnP-AV media server (aka ReadyMedia)

V=		1.2.1
DISTNAME=	minidlna-$V
PKGNAME=	minidlna-$V

CATEGORIES=	multimedia

MAINTAINER=	Stuart Henderson <sthen@@openbsd.org>

HOMEPAGE=	http://sourceforge.net/projects/minidlna/

# GPLv2 only
PERMIT_PACKAGE_CDROM=	Yes

WANTLIB += FLAC avformat avutil c exif id3tag jpeg ogg
WANTLIB += pthread sqlite3 vorbis

MASTER_SITES=	${MASTER_SITE_SOURCEFORGE:=minidlna/}

CONFIGURE_STYLE= gnu
CONFIGURE_ARGS= --with-log-path=/var/log/minidlna \
		--with-db-path=/var/db/minidlna \
		--with-os-url=http://www.openbsd.org/
CONFIGURE_ENV=	CPPFLAGS="-I${LOCALBASE}/include" \
		LDFLAGS="-L${LOCALBASE}/lib"

MODULES=	devel/gettext
LIB_DEPENDS=	audio/flac \
		audio/libid3tag \
		databases/sqlite3 \
		graphics/ffmpeg \
		graphics/jpeg \
		graphics/libexif

NO_TEST=	Yes
E=		${PREFIX}/share/examples/minidlna

post-install:
	${INSTALL_DATA_DIR} $E
	${INSTALL_DATA} ${WRKSRC}/minidlna.conf $E
	${INSTALL_MAN} ${WRKSRC}/minidlnad.8 ${PREFIX}/man/man8
	${INSTALL_MAN} ${WRKSRC}/minidlna.conf.5 ${PREFIX}/man/man5

.include <bsd.port.mk>
@


1.19
log
@udpate to MiniDLNA-1.2.0, rescan patch is now committed upstream
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2016/09/23 09:16:56 sthen Exp $
d5 1
a5 1
V=		1.2.0
@


1.18
log
@Cope with moving sqlite3 back to ports.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2016/08/26 10:19:08 jca Exp $
d5 1
a5 2
V=		1.1.5
REVISION=	4
@


1.17
log
@Ship manpages.

ok sthen@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2015/12/16 23:26:14 sthen Exp $
d6 1
a6 1
REVISION=	3
d34 1
@


1.16
log
@bump REVISION of minidlna to force updates; no idea what abi changed
but the old binary on my system wasn't answering UPNP multicast and
rebuilding fixed it for me.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2015/10/13 10:34:00 sthen Exp $
d6 1
a6 1
REVISION=	2
d44 2
@


1.15
log
@update the minidlna port to use a newer version of the 'rescan' patch
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2015/09/11 09:51:12 sthen Exp $
d6 1
a6 1
REVISION=	1
@


1.14
log
@Add the patchset from https://sourceforge.net/p/minidlna/patches/145/ to
support incremental rescans with the -r flag.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2015/09/11 09:16:23 sthen Exp $
d6 1
a6 1
REVISION=	0
@


1.13
log
@update to minidlna-1.1.5
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2015/07/16 21:46:54 sthen Exp $
d6 1
@


1.12
log
@fix address sent to ssdp; reported by Daniel LEVAI, patch from
http://miniupnp.tuxfamily.org/forum/viewtopic.php?p=4413
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2015/01/25 14:07:26 sthen Exp $
d5 1
a5 2
V=		1.1.4
REVISION=	1
@


1.11
log
@Add comment to minidlna config file suggesting use of uuid, based on part of
a diff from LEVAI Daniel.

Mention the name ReadyMedia in COMMENT/DESCR (the project name has changed
upstream; possibly this was done to avoid using the letters d l n and a in
the name; I have not changed PKGNAME at this time).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2014/09/03 21:15:43 sthen Exp $
d6 1
a6 1
REVISION=	0
@


1.10
log
@update to minidlna 1.1.4, from Mark Patruck
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2014/06/11 01:07:44 sthen Exp $
d3 1
a3 1
COMMENT=	lightweight DLNA/UPnP-AV media server
d6 1
@


1.9
log
@fix scanner crash on 32-bit systems with long long time_t
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2014/06/11 00:26:59 sthen Exp $
d5 1
a5 2
V=		1.1.3
REVISION=	0
@


1.8
log
@update to minidlna 1.1.3
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2014/03/09 21:04:05 sthen Exp $
d6 1
@


1.7
log
@update to minidlna 1.1.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2013/05/07 20:37:23 sthen Exp $
d5 1
a5 1
V=		1.1.2
@


1.6
log
@update to MiniDLNA 1.1.0, rolling in a bunch of patches which have been committed upstream
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2013/03/11 11:35:44 espie Exp $
d5 1
a5 1
V=		1.1.0
@


1.6.4.1
log
@backport fix for scanner crash on 32-bit systems (time_t)
initial bug was reported by Peter Ljung
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2013/05/07 20:37:23 sthen Exp $
a5 1
REVISION=	0
@


1.5
log
@sync with minidlna stable; fixes a few bugs and adds compat with ffmpeg 1.0
@
text
@d5 2
a6 4
V=		1.0.25
REVISION=	2
DISTNAME=	minidlna_$V_src
WRKDIST=	${WRKDIR}/minidlna-$V
d18 1
a18 1
WANTLIB += FLAC avcodec avformat avutil c exif id3tag jpeg ogg
d23 7
a36 6
MAKE_FLAGS=	CC="${CC}" CFLAGS="${CFLAGS}" LDFLAGS="${LDFLAGS}" \
		INSTALLPREFIX="${WRKINST}${TRUEPREFIX}"
CFLAGS+=	-Wall -D_GNU_SOURCE -D_FILE_OFFSET_BITS=64 \
		-I${LOCALBASE}/include
LDFLAGS=	-L${LOCALBASE}/lib

a38 3

do-configure:
	@@cd ${WRKSRC} && perl -pi -e 's,/usr/local,${LOCALBASE},g' genconfig.sh
@


1.4
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2013/03/03 22:37:07 sthen Exp $
d6 1
a6 1
REVISION=	1
d35 1
a35 4
		-I${LOCALBASE}/include \
		-I${LOCALBASE}/include/libavcodec \
		-I${LOCALBASE}/include/libavformat \
		-I${LOCALBASE}/include/libavutil
@


1.3
log
@Use a picture of Puffy in the icons for MiniDLNA. (note that the artwork
is copyright, permission for use in this port granted by deraadt@@).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2012/10/11 17:59:05 sthen Exp $
a18 3
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
d41 1
a41 1
NO_REGRESS=	Yes
@


1.2
log
@tweak config; use a more BSD-ish network interface name, and add a comment
about firewall ports.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2012/10/10 10:45:05 sthen Exp $
d6 1
a6 1
REVISION=	0
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.template,v 1.54 2008/01/13 16:43:57 espie Exp $
d6 1
@


1.1.1.1
log
@import ports/multimedia/minidlna, ok/testing landry@@

MiniDLNA is lightweight server software written in C, capable of
serving media files to DLNA/UPnP-AV clients (televisions, tablets,
etc).
@
text
@@
