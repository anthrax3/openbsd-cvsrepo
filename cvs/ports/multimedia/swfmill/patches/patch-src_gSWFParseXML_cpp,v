head	1.1;
access;
symbols;
locks; strict;
comment	@# @;


1.1
date	2017.05.25.19.33.20;	author espie;	state Exp;
branches;
next	;
commitid	RwiJzHelVlWQua0n;


desc
@@


1.1
log
@fixes for clang
@
text
@$OpenBSD$

Index: src/gSWFParseXML.cpp
--- src/gSWFParseXML.cpp.orig
+++ src/gSWFParseXML.cpp
@@@@ -16,7 +16,7 @@@@ char *fromXmlChar(const Context *ctx, const xmlChar *f
 	if (ctx->convertEncoding) {
 		size_t len = strlen((const char *)from_str);
 		iconv_t cd = iconv_open(ctx->swf_encoding, "UTF-8");
-		if (cd < 0) {
+		if (cd == iconv_t(-1)) {
 			fprintf(stderr, "iconv_open failed.\n");
 			char *buf = new char[1];
 			buf[0] = '\0';
@@@@ -4383,7 +4383,7 @@@@ void UnknownFilter::parseXML( xmlNodePtr node, Context
 				data = new unsigned char[ lout ];
 				memcpy( data, dst, lout );
 			}
-			delete dst;
+			delete [] dst;
 			xmlFree( xmld );
 		}
 	}
@@@@ -5655,7 +5655,7 @@@@ void UnknownTag::parseXML( xmlNodePtr node, Context *c
 				data = new unsigned char[ lout ];
 				memcpy( data, dst, lout );
 			}
-			delete dst;
+			delete [] dst;
 			xmlFree( xmld );
 		}
 	}
@@@@ -9015,7 +9015,7 @@@@ void SoundStreamBlock::parseXML( xmlNodePtr node, Cont
 				data = new unsigned char[ lout ];
 				memcpy( data, dst, lout );
 			}
-			delete dst;
+			delete [] dst;
 			xmlFree( xmld );
 		}
 	}
@@@@ -10307,7 +10307,7 @@@@ void UnknownAction::parseXML( xmlNodePtr node, Context
 				data = new unsigned char[ lout ];
 				memcpy( data, dst, lout );
 			}
-			delete dst;
+			delete [] dst;
 			xmlFree( xmld );
 		}
 	}
@@@@ -12260,7 +12260,7 @@@@ void UnknownOpCode::parseXML( xmlNodePtr node, Context
 				data = new unsigned char[ lout ];
 				memcpy( data, dst, lout );
 			}
-			delete dst;
+			delete [] dst;
 			xmlFree( xmld );
 		}
 	}
@
