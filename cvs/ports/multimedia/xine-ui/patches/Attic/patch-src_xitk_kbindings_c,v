head	1.2;
access;
symbols
	OPENBSD_5_5:1.1.0.6
	OPENBSD_5_5_BASE:1.1
	OPENBSD_5_4:1.1.0.4
	OPENBSD_5_4_BASE:1.1
	OPENBSD_5_3:1.1.0.2
	OPENBSD_5_3_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2014.03.30.18.38.31;	author brad;	state dead;
branches;
next	1.1;

1.1
date	2012.11.01.23.20.26;	author brad;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Update to Xine-ui 0.99.8.

ok sthen@@
@
text
@$OpenBSD: patch-src_xitk_kbindings_c,v 1.1 2012/11/01 23:20:26 brad Exp $

Fix keymap editor deadlock.

--- src/xitk/kbindings.c.orig	Thu Nov  1 18:36:58 2012
+++ src/xitk/kbindings.c	Thu Nov  1 18:37:51 2012
@@@@ -973,7 +973,9 @@@@ static void kbedit_grab(xitk_widget_t *w, void *data) 
   do {
     /* Although only release events are evaluated, we must also grab the corresponding press */
     /* events to hide them from the other GUI windows and prevent unexpected side effects.   */
+    XLockDisplay(gGui->display);
     XMaskEvent(gGui->display, ButtonPressMask | ButtonReleaseMask | KeyPressMask | KeyReleaseMask, &xev);
+    XUnlockDisplay(gGui->display);
   } while ((xev.type != KeyRelease && xev.type != ButtonRelease) ||
 	   xev.xany.window != xitk_window_get_window(xwin));
   
@


1.1
log
@Two fixes from upstream..

- Fix keymap editor deadlock.
- Fix out of array access.

ok sthen@@
@
text
@d1 1
a1 1
$OpenBSD$
@

