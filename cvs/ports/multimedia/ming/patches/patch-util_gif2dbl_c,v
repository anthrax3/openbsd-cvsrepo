head	1.2;
access;
symbols
	OPENBSD_6_0:1.2.0.6
	OPENBSD_6_0_BASE:1.2
	OPENBSD_5_9:1.2.0.2
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.2.0.4
	OPENBSD_5_8_BASE:1.2
	OPENBSD_5_7:1.1.0.6
	OPENBSD_5_7_BASE:1.1
	OPENBSD_5_6:1.1.0.4
	OPENBSD_5_6_BASE:1.1
	OPENBSD_5_5:1.1.0.2
	OPENBSD_5_5_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2015.03.29.10.50.24;	author sthen;	state Exp;
branches;
next	1.1;
commitid	Acz0lK9eNzGTQFpu;

1.1
date	2013.09.25.07.58.44;	author sthen;	state Exp;
branches;
next	;


desc
@@


1.2
log
@handle giflib api change
@
text
@$OpenBSD: patch-util_gif2dbl_c,v 1.1 2013/09/25 07:58:44 sthen Exp $

support giflib 5.0+, from http://cvsweb.netbsd.org/bsdweb.cgi/pkgsrc/multimedia/ming/patches/

--- util/gif2dbl.c.orig	Sat Jun  8 15:08:51 2013
+++ util/gif2dbl.c	Sun Mar 29 11:49:57 2015
@@@@ -19,10 +19,12 @@@@
 
 #include "libming.h"
 
+int ErrorCode;
+
 void error(char *msg)
 {
   printf("%s:\n\n", msg);
-  PrintGifError();
+  PrintGifError(ErrorCode);
   exit(-1);
 }
 
@@@@ -59,7 +61,7 @@@@ unsigned char *readGif(char *fileName, int *length, in
   unsigned char *p;
   int i, nColors, size, alpha, bgColor, alignedWidth;
 
-  if((file = DGifOpenFileName(fileName)) == NULL)
+  if((file = DGifOpenFileName(fileName, &ErrorCode)) == NULL)
     error("Error opening file");
 
   if(DGifSlurp(file) != GIF_OK)
@@@@ -190,7 +192,7 @@@@ unsigned char *readGif(char *fileName, int *length, in
   }
 
 	/* Done! */
-  DGifCloseFile(file);
+  DGifCloseFile(file, NULL);
 
   *length = size;
   return data;
@


1.1
log
@libungif->giflib and patch where necessary, ok jasper@@ aja@@
@
text
@d1 1
a1 1
$OpenBSD$
d5 2
a6 2
--- util/gif2dbl.c.orig	Sat Jun  8 08:08:51 2013
+++ util/gif2dbl.c	Fri Sep 20 02:52:09 2013
d30 9
@

