head	1.2;
access;
symbols
	OPENBSD_6_1:1.2.0.6
	OPENBSD_6_1_BASE:1.2
	OPENBSD_6_0:1.2.0.4
	OPENBSD_6_0_BASE:1.2
	OPENBSD_5_9:1.2.0.2
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.1.0.4
	OPENBSD_5_8_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2015.11.09.06.44.09;	author ajacoutot;	state Exp;
branches;
next	1.1;
commitid	wizMmVYftri7cVV0;

1.1
date	2015.05.12.20.56.49;	author kettenis;	state Exp;
branches;
next	;
commitid	Hb848iJMlMXxVWr4;


desc
@@


1.2
log
@Update to x265-1.8.93.

from Brad (maintainer)
@
text
@$OpenBSD: patch-source_test_checkasm-a_asm,v 1.1 2015/05/12 20:56:49 kettenis Exp $
--- source/test/checkasm-a.asm.orig	Fri Oct 16 02:10:22 2015
+++ source/test/checkasm-a.asm	Fri Oct 16 02:22:07 2015
@@@@ -156,7 +156,11 @@@@ cglobal checkasm_call, 2,15,16,max_args*8+8
     mov  r9, rax
     mov r10, rdx
     lea  r0, [error_message]
+%ifdef PIC
+    call puts wrt ..plt
+%else
     call puts
+%endif
     mov  r1, [rsp+max_args*8]
     mov  dword [r1], 0
     mov  rdx, r10
@@@@ -198,7 +202,11 @@@@ cglobal checkasm_call, 1,7
     mov  r4, edx
     lea  r1, [error_message]
     push r1
+%ifdef PIC
+    call puts wrt ..plt
+%else
     call puts
+%endif
     add  esp, 4
     mov  r1, r1m
     mov  dword [r1], 0
@


1.1
log
@Make sure the amd64 assembly code calls libc functions through the PLT such
that it can be used to bake PIE.  The binutils 2.15 linker (incorrectly)
allows direct calls, but binutils 2.17 flags this as an error.

ok Brad (maintainer)
@
text
@d1 4
a4 5
$OpenBSD$
--- source/test/checkasm-a.asm.orig	Thu Apr  2 18:46:36 2015
+++ source/test/checkasm-a.asm	Sat May  9 22:25:58 2015
@@@@ -153,7 +153,11 @@@@ cglobal checkasm_call, 2,15,16,max_args*8+8
     jz .ok
d6 1
d15 3
a17 3
     mov  rax, r9
@@@@ -193,7 +197,11 @@@@ cglobal checkasm_call, 1,7
     mov  r3, eax
@

