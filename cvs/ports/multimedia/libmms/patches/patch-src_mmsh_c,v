head	1.1;
access;
symbols
	OPENBSD_6_2:1.1.0.16
	OPENBSD_6_2_BASE:1.1
	OPENBSD_6_1:1.1.0.14
	OPENBSD_6_1_BASE:1.1
	OPENBSD_6_0:1.1.0.12
	OPENBSD_6_0_BASE:1.1
	OPENBSD_5_9:1.1.0.8
	OPENBSD_5_9_BASE:1.1
	OPENBSD_5_8:1.1.0.10
	OPENBSD_5_8_BASE:1.1
	OPENBSD_5_7:1.1.0.6
	OPENBSD_5_7_BASE:1.1
	OPENBSD_5_6:1.1.0.4
	OPENBSD_5_6_BASE:1.1
	OPENBSD_5_5:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2014.05.22.11.53.36;	author jasper;	state Exp;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2014.05.22.11.54.08;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.1
log
@Security fix for CVE-2014-2892, heap-based buffer overflow
@
text
@$OpenBSD$

Security fix for CVE-2014-2892, heap-based buffer overflow
http://sourceforge.net/p/libmms/code/ci/03bcfccc22919c72742b7338d02859962861e0e8

--- src/mmsh.c.orig	Thu May 22 13:47:18 2014
+++ src/mmsh.c	Thu May 22 13:48:30 2014
@@@@ -307,7 +307,10 @@@@ static int get_answer (mms_io_t *io, mmsh_t *this) {
         len = 0;
       }
     } else {
-      len ++;
+      if (++len >= sizeof(this->buf)) {
+        lprintf("answer too large\n");
+        return 0;
+      }
     }
   }
   if (this->stream_type == MMSH_UNKNOWN) {
@


1.1.2.1
log
@Security fix for CVE-2014-2892, heap-based buffer overflow
@
text
@@

