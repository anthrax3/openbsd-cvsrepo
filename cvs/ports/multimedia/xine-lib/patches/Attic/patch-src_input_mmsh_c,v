head	1.3;
access;
symbols
	OPENBSD_4_1:1.1.0.4
	OPENBSD_4_1_BASE:1.1
	OPENBSD_4_0:1.1.0.2;
locks; strict;
comment	@# @;


1.3
date	2007.06.13.10.58.29;	author jakemsr;	state dead;
branches;
next	1.2;

1.2
date	2007.05.01.20.05.10;	author naddy;	state Exp;
branches;
next	1.1;

1.1
date	2006.12.07.09.21.01;	author steven;	state Exp;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2006.12.07.21.46.58;	author sturm;	state Exp;
branches;
next	;


desc
@@


1.3
log
@update to xine-lib-1.1.7

- use some CONFIGURE_ENV instead of patching
- rearrange/update CONFIGURE_ARGS
- many patches no longer relevant
- add CD audio support

input, tetsing and prodding from brad@@
@
text
@$OpenBSD: patch-src_input_mmsh_c,v 1.2 2007/05/01 20:05:10 naddy Exp $
--- src/input/mmsh.c.orig	Sun Jul  9 16:37:35 2006
+++ src/input/mmsh.c	Tue May  1 22:03:06 2007
@@@@ -182,7 +182,7 @@@@ struct mmsh_s {
   int           num_stream_ids;
   int           stream_ids[ASF_MAX_NUM_STREAMS];
   int           stream_types[ASF_MAX_NUM_STREAMS];
-  int           packet_length;
+  uint32_t      packet_length;
   int64_t       file_length;
   char          guid[37];
   uint32_t      bitrates[ASF_MAX_NUM_STREAMS];
@@@@ -491,6 +491,10 @@@@ static void interp_header (mmsh_t *this) {
       case GUID_ASF_FILE_PROPERTIES:
 
         this->packet_length = LE_32(this->asf_header + i + 92 - 24);
+        if (this->packet_length > CHUNK_SIZE) {
+          this->packet_length = 0;
+          break;
+        }
         this->file_length   = LE_64(this->asf_header + i + 40 - 24);
         /*lprintf ("file object, file_length = %lld, packet length = %d",
 		 this->file_length, this->packet_count);*/
@


1.2
log
@regen patches
@
text
@d1 1
a1 1
$OpenBSD: patch-src_input_mmsh_c,v 1.1 2006/12/07 09:21:01 steven Exp $
@


1.1
log
@Security fixes:
- Heap overflow in libmms (related to CVE-2006-2200)
- Buffer overrun in Real Media input plugin. [bug #1603458]
  Thanks to Roland Kay for reporting and JW for the patch.

from brad@@, tested by bernd@@ and me
@
text
@d1 3
a3 3
$OpenBSD$
--- src/input/mmsh.c.orig	Mon Dec  4 14:44:07 2006
+++ src/input/mmsh.c	Mon Dec  4 14:45:35 2006
d13 1
a13 1
@@@@ -491,6 +491,10 @@@@ static void interp_header (mmsh_t *this)
@


1.1.2.1
log
@MFC:
Security fixes:
- Heap overflow in libmms (related to CVE-2006-2200)
- Buffer overrun in Real Media input plugin. [bug #1603458]
Thanks to Roland Kay for reporting and JW for the patch.
@
text
@d1 1
a1 1
$OpenBSD: patch-src_input_mmsh_c,v 1.1 2006/12/07 09:21:01 steven Exp $
@

