head	1.6;
access;
symbols
	OPENBSD_5_7:1.5.0.14
	OPENBSD_5_7_BASE:1.5
	OPENBSD_5_6:1.5.0.12
	OPENBSD_5_6_BASE:1.5
	OPENBSD_5_5:1.5.0.10
	OPENBSD_5_5_BASE:1.5
	OPENBSD_5_4:1.5.0.8
	OPENBSD_5_4_BASE:1.5
	OPENBSD_5_3:1.5.0.6
	OPENBSD_5_3_BASE:1.5
	OPENBSD_5_2:1.5.0.4
	OPENBSD_5_2_BASE:1.5
	OPENBSD_5_1_BASE:1.5
	OPENBSD_5_1:1.5.0.2
	OPENBSD_5_0:1.4.0.2
	OPENBSD_5_0_BASE:1.4
	OPENBSD_4_9:1.3.0.4
	OPENBSD_4_9_BASE:1.3
	OPENBSD_4_8:1.3.0.2
	OPENBSD_4_8_BASE:1.3
	OPENBSD_4_7:1.2.0.12
	OPENBSD_4_7_BASE:1.2
	OPENBSD_4_6:1.2.0.10
	OPENBSD_4_6_BASE:1.2
	OPENBSD_4_5:1.2.0.8
	OPENBSD_4_5_BASE:1.2
	OPENBSD_4_4:1.2.0.6
	OPENBSD_4_4_BASE:1.2
	OPENBSD_4_3:1.2.0.4
	OPENBSD_4_3_BASE:1.2
	OPENBSD_4_2:1.2.0.2
	OPENBSD_4_2_BASE:1.2
	OPENBSD_4_1:1.1.1.1.0.4
	OPENBSD_4_1_BASE:1.1.1.1
	OPENBSD_4_0:1.1.1.1.0.2
	OPENBSD_4_0_BASE:1.1.1.1
	jolan_20050321:1.1.1.1
	jolan:1.1.1;
locks; strict;
comment	@# @;


1.6
date	2015.05.27.21.17.51;	author ajacoutot;	state dead;
branches;
next	1.5;
commitid	Wmz27ownXTB11bCt;

1.5
date	2011.10.04.08.59.41;	author giovanni;	state Exp;
branches;
next	1.4;

1.4
date	2011.03.12.21.17.50;	author jakemsr;	state Exp;
branches;
next	1.3;

1.3
date	2010.06.18.21.35.18;	author sthen;	state Exp;
branches;
next	1.2;

1.2
date	2007.03.21.12.00.29;	author ajacoutot;	state Exp;
branches;
next	1.1;

1.1
date	2006.03.22.01.30.20;	author jolan;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2006.03.22.01.30.20;	author jolan;	state Exp;
branches;
next	;


desc
@@


1.6
log
@Update to libmatroska-1.4.2.

from brad (maintainer)
@
text
@$OpenBSD: patch-make_linux_Makefile,v 1.5 2011/10/04 08:59:41 giovanni Exp $
--- make/linux/Makefile.orig	Sun Oct  2 16:04:20 2011
+++ make/linux/Makefile	Sun Oct  2 16:05:23 2011
@@@@ -33,8 +33,8 @@@@ INSTALL_DIR_OPTS = -m 755
 CWD=$(shell pwd)
 
 # Options
-LIBEBML_INCLUDE_DIR=$(CWD)/../../../libebml
-LIBEBML_LIB_DIR=$(CWD)/../../../libebml/make/linux
+LIBEBML_INCLUDE_DIR=$(LOCALBASE)/include
+LIBEBML_LIB_DIR=$(LOCALBASE)/lib
 EXTENSION=.cpp
 
 ifeq (yes,$(DEBUG))
@@@@ -53,8 +53,7 @@@@ MUX_LIBS=-lmatroska -lebml $(LIBICONV)
 
 # Names
 LIBRARY=libmatroska.a
-LIBRARY_SO=libmatroska.so
-LIBRARY_SO_VER=libmatroska.so.5
+LIBRARY_SO_VER=libmatroska.so.${LIBmatroska_VERSION}
 
 # source-files
 sources:=$(wildcard ${SRC_DIR}*$(EXTENSION))
@@@@ -81,7 +80,7 @@@@ endif
 
 staticlib: $(LIBRARY)
 
-sharedlib: $(LIBRARY_SO)
+sharedlib: $(LIBRARY_SO_VER)
 
 lib:
 	@@echo "Use the 'staticlib', 'sharedlib' or 'all' targets."
@@@@ -98,15 +97,12 @@@@ $(LIBRARY): $(objects)
 	$(AR) rcvu $@@ $(objects)
 	$(RANLIB) $@@
 
-$(LIBRARY_SO): $(objects_so)
-	$(CXX) -shared -Wl,-soname,$(LIBRARY_SO_VER) -o $(LIBRARY_SO_VER) $(objects_so) -lebml
-	rm -f $(LIBRARY_SO)
-	ln -s $(LIBRARY_SO_VER) $(LIBRARY_SO)
+$(LIBRARY_SO_VER): $(objects_so)
+	$(CXX) -shared -fPIC -o $(LIBRARY_SO_VER) $(objects_so) $(LINKFLAGS) -lebml
 
 clean:	cleantest
 	rm -f $(objects) $(objects_so)
 	rm -f $(LIBRARY)
-	rm -f $(LIBRARY_SO)
 	rm -f $(LIBRARY_SO_VER)
 	rm -f CORE
 
@@@@ -128,19 +124,19 @@@@ depend:
 
 test: test6 test9
 
-test6:	test6.o $(LIBRARY) $(LIBRARY_SO)
+test6:	test6.o $(LIBRARY) $(LIBRARY_SO_VER)
 	$(LD) -o $@@ $(LINKFLAGS) $< $(MUX_LIBS)
 
 test6.o: $(MUX_SRC_DIR)test6.cpp
 	$(CXX) -c $(COMPILEFLAGS) -o $@@ $<
 
-test8:	test8.o $(LIBRARY) $(LIBRARY_SO)
+test8:	test8.o $(LIBRARY) $(LIBRARY_SO_VER)
 	$(LD) -o $@@ $(LINKFLAGS) $< $(MUX_LIBS)
 
 test8.o: $(MUX_SRC_DIR)test8.cpp
 	$(CXX) -c $(COMPILEFLAGS) -o $@@ $<
 
-test9:	test9.o $(LIBRARY) $(LIBRARY_SO)
+test9:	test9.o $(LIBRARY) $(LIBRARY_SO_VER)
 	$(LD) -o $@@ $(LINKFLAGS) $< $(MUX_LIBS)
 
 test9.o: $(TAG_SRC_DIR)test9.cpp
@@@@ -166,10 +162,9 @@@@ install_staticlib: $(LIBRARY)
 	$(INSTALL) $(INSTALL_DIR_OPTS) -d $(libdir)
 	$(INSTALL) $(INSTALL_OPTS_LIB) $(LIBRARY) $(libdir)
 
-install_sharedlib: $(LIBRARY_SO)
+install_sharedlib: $(LIBRARY_SO_VER)
 	$(INSTALL) $(INSTALL_DIR_OPTS) -d $(libdir)
 	$(INSTALL) $(INSTALL_OPTS_LIB) $(LIBRARY_SO_VER) $(libdir)
-	ln -fs $(LIBRARY_SO_VER) $(libdir)/$(LIBRARY_SO)
 
 ifneq ($(wildcard .depend),)
 include .depend
@


1.5
log
@
Update to 1.3.0 and enable regression tests
From Brad with tweaks by me
@
text
@d1 1
a1 1
$OpenBSD: patch-make_linux_Makefile,v 1.4 2011/03/12 21:17:50 jakemsr Exp $
@


1.4
log
@update to libmatroska-1.1.0

from Brad (MAINTAINER)
@
text
@d1 3
a3 3
$OpenBSD: patch-make_linux_Makefile,v 1.3 2010/06/18 21:35:18 sthen Exp $
--- make/linux/Makefile.orig	Sun Feb 27 00:50:05 2011
+++ make/linux/Makefile	Sun Feb 27 00:53:28 2011
d20 1
a20 1
-LIBRARY_SO_VER=libmatroska.so.3
@


1.3
log
@update to 1.0.0, from Brad (taking maintainer)
@
text
@d1 3
a3 3
$OpenBSD: patch-make_linux_Makefile,v 1.2 2007/03/21 12:00:29 ajacoutot Exp $
--- make/linux/Makefile.orig	Thu Jun 17 21:05:53 2010
+++ make/linux/Makefile	Thu Jun 17 21:06:58 2010
d20 2
a21 2
-LIBRARY_SO_VER=libmatroska.so.2
+LIBRARY_SO_VER=libmatroska.so.$(LIBmatroska_VERSION)
@


1.2
log
@- update to libmatroska-0.8.1

ok jolan@@
@
text
@d1 4
a4 19
$OpenBSD: patch-make_linux_Makefile,v 1.1.1.1 2006/03/22 01:30:20 jolan Exp $
--- make/linux/Makefile.orig	Mon Mar 19 13:40:09 2007
+++ make/linux/Makefile	Mon Mar 19 13:42:43 2007
@@@@ -16,11 +16,11 @@@@ prefix=/boot/home/config
 else
 prefix=/usr/local
 endif
-libdir=$(prefix)/lib
-includedir=$(prefix)/include/matroska
+libdir=$(PREFIX)/lib
+includedir=$(PREFIX)/include/matroska
 
 # Programs
-CXX=g++
+#CXX=g++
 LD=$(CXX)
 AR = ar rcvu
 RANLIB = ranlib
@@@@ -36,8 +36,8 @@@@ endif
d15 2
a16 1
@@@@ -57,7 +57,7 @@@@ MUX_LIBS=-lmatroska -lebml $(LIBICONV)
d19 2
a20 2
 LIBRARY_SO=libmatroska.so
-LIBRARY_SO_VER=libmatroska.so.0
d25 11
a35 1
@@@@ -102,9 +102,7 @@@@ $(LIBRARY): $(objects)
d38 1
a38 1
 $(LIBRARY_SO): $(objects_so)
d42 2
a43 1
+	$(CXX) -shared -Wl,-soname,$(LIBRARY_SO_VER) -o $(LIBRARY_SO_VER) $(objects_so) $(LINKFLAGS) -lebml
d47 34
a80 2
@@@@ -172,7 +170,6 @@@@ install_staticlib: $(LIBRARY)
 install_sharedlib: $(LIBRARY_SO)
@


1.1
log
@Initial revision
@
text
@d1 3
a3 3
$OpenBSD$
--- make/linux/Makefile.orig	Tue Apr 19 02:00:00 2005
+++ make/linux/Makefile	Tue Mar 21 18:57:59 2006
d39 1
a39 1
@@@@ -102,8 +102,7 @@@@ $(LIBRARY): $(objects)
d44 1
d50 1
a50 1
@@@@ -171,7 +170,6 @@@@ install_staticlib: $(LIBRARY)
d54 1
a54 1
-	ln -s $(LIBRARY_SO_VER) $(libdir)/$(LIBRARY_SO)
@


1.1.1.1
log
@libmatroska-0.8.0, extensible open standard audio/video container library
@
text
@@
