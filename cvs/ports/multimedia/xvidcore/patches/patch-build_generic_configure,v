head	1.9;
access;
symbols
	OPENBSD_6_2:1.9.0.12
	OPENBSD_6_2_BASE:1.9
	OPENBSD_6_1:1.9.0.10
	OPENBSD_6_1_BASE:1.9
	OPENBSD_6_0:1.9.0.8
	OPENBSD_6_0_BASE:1.9
	OPENBSD_5_9:1.9.0.4
	OPENBSD_5_9_BASE:1.9
	OPENBSD_5_8:1.9.0.6
	OPENBSD_5_8_BASE:1.9
	OPENBSD_5_7:1.9.0.2
	OPENBSD_5_7_BASE:1.9
	OPENBSD_5_6:1.8.0.8
	OPENBSD_5_6_BASE:1.8
	OPENBSD_5_5:1.8.0.6
	OPENBSD_5_5_BASE:1.8
	OPENBSD_5_4:1.8.0.4
	OPENBSD_5_4_BASE:1.8
	OPENBSD_5_3:1.8.0.2
	OPENBSD_5_3_BASE:1.8
	OPENBSD_5_2:1.7.0.4
	OPENBSD_5_2_BASE:1.7
	OPENBSD_5_1_BASE:1.7
	OPENBSD_5_1:1.7.0.2
	OPENBSD_5_0:1.5.0.2
	OPENBSD_5_0_BASE:1.5
	OPENBSD_4_9:1.4.0.8
	OPENBSD_4_9_BASE:1.4
	OPENBSD_4_8:1.4.0.6
	OPENBSD_4_8_BASE:1.4
	OPENBSD_4_7:1.4.0.4
	OPENBSD_4_7_BASE:1.4
	OPENBSD_4_6:1.4.0.2
	OPENBSD_4_6_BASE:1.4
	OPENBSD_4_5:1.2.0.4
	OPENBSD_4_5_BASE:1.2
	OPENBSD_4_4:1.2.0.2
	OPENBSD_4_4_BASE:1.2
	OPENBSD_4_3:1.1.0.10
	OPENBSD_4_3_BASE:1.1
	OPENBSD_4_2:1.1.0.8
	OPENBSD_4_2_BASE:1.1
	OPENBSD_4_1:1.1.0.6
	OPENBSD_4_1_BASE:1.1
	OPENBSD_4_0:1.1.0.4
	OPENBSD_4_0_BASE:1.1
	OPENBSD_3_9:1.1.0.2
	OPENBSD_3_9_BASE:1.1;
locks; strict;
comment	@# @;


1.9
date	2014.09.19.01.44.46;	author brad;	state Exp;
branches;
next	1.8;
commitid	WtFhCjHGqbpzGjbi;

1.8
date	2012.08.27.09.34.43;	author jasper;	state Exp;
branches;
next	1.7;

1.7
date	2012.01.25.15.34.02;	author ajacoutot;	state Exp;
branches;
next	1.6;

1.6
date	2011.08.30.18.53.24;	author jasper;	state Exp;
branches;
next	1.5;

1.5
date	2011.03.20.23.49.33;	author edd;	state Exp;
branches;
next	1.4;

1.4
date	2009.06.16.20.38.50;	author naddy;	state Exp;
branches;
next	1.3;

1.3
date	2009.05.10.20.16.10;	author sthen;	state Exp;
branches;
next	1.2;

1.2
date	2008.07.14.06.02.31;	author brad;	state Exp;
branches;
next	1.1;

1.1
date	2006.01.08.22.12.38;	author jakemsr;	state Exp;
branches;
next	;


desc
@@


1.9
log
@Update to xvidcore 1.3.3.

ok zhuk@@
@
text
@$OpenBSD: patch-build_generic_configure,v 1.8 2012/08/27 09:34:43 jasper Exp $
--- build/generic/configure.orig	Tue Apr  8 16:41:05 2014
+++ build/generic/configure	Tue Sep  2 16:41:41 2014
@@@@ -2269,8 +2269,6 @@@@ ac_compiler_gnu=$ac_cv_c_compiler_gnu
 
 
 
-API_MAJOR="4"
-API_MINOR="3"
 
 minimum_yasm_major_version=1
 minimum_nasm_minor_version=0
@@@@ -4379,7 +4377,7 @@@@ $as_echo "ok" >&6; }
 	SHARED_LIB="libxvidcore.\$(SHARED_EXTENSION).\$(API_MAJOR).\$(API_MINOR)"
 	SO_API_MAJOR_LINK="libxvidcore.\$(SHARED_EXTENSION).\$(API_MAJOR)"
 	SO_LINK="libxvidcore.\$(SHARED_EXTENSION)"
-	SPECIFIC_LDFLAGS="-Wl,-soname,libxvidcore.\$(SHARED_EXTENSION).\$(API_MAJOR) -shared -lc -lm"
+	SPECIFIC_LDFLAGS="-shared -fPIC -lm"
 	SPECIFIC_CFLAGS="-fPIC"
 	;;
      [cC][yY][gG][wW][iI][nN]*|mingw32*|mks*)
@@@@ -4651,7 +4649,7 @@@@ $as_echo "macho32" >&6; }
 
        AS="$chosen_asm_prog"
        ASSEMBLY_EXTENSION="asm"
-       AFLAGS="-I\$(<D)/ -I../../src/ -f $NASM_FORMAT $PREFIX $MARK_FUNCS"
+       AFLAGS="-I\$(<D)/ -I../../src/ -I../../src/image/x86_asm/ -f $NASM_FORMAT $PREFIX $MARK_FUNCS"
        ASSEMBLY_SOURCES="SRC_${ARCHITECTURE}"
        if test "$ARCHITECTURE" = "X86_64" ; then
                AFLAGS=${AFLAGS}" -DARCH_IS_X86_64"
@


1.8
log
@Remove -pthread patching.

from brad
@
text
@d1 4
a4 4
$OpenBSD: patch-build_generic_configure,v 1.7 2012/01/25 15:34:02 ajacoutot Exp $
--- build/generic/configure.orig	Mon May 23 06:22:01 2011
+++ build/generic/configure	Thu Aug 16 20:29:44 2012
@@@@ -2243,8 +2243,6 @@@@ ac_compiler_gnu=$ac_cv_c_compiler_gnu
d13 1
a13 3
@@@@ -4333,7 +4331,7 @@@@ $as_echo "ok" >&6; }
 $as_echo "ok" >&6; }
 	STATIC_LIB="libxvidcore.\$(STATIC_EXTENSION)"
d15 2
d22 1
a22 1
@@@@ -4597,7 +4595,7 @@@@ $as_echo "macho32" >&6; }
@


1.7
log
@Re-enable MMX/SSE2 support on amd64/i386 now that we have gcc4.

from Brad (maintainer)
@
text
@d1 1
a1 1
$OpenBSD: patch-build_generic_configure,v 1.6 2011/08/30 18:53:24 jasper Exp $
d3 1
a3 1
+++ build/generic/configure	Sat Dec 24 11:52:46 2011
a30 26
@@@@ -4733,13 +4731,13 @@@@ done
 if test x"$pthread" = x"yes" ; then
    ac_fn_c_check_header_mongrel "$LINENO" "pthread.h" "ac_cv_header_pthread_h" "$ac_includes_default"
 if test "x$ac_cv_header_pthread_h" = xyes; then :
-  { $as_echo "$as_me:${as_lineno-$LINENO}: checking for pthread_create in -lpthread" >&5
-$as_echo_n "checking for pthread_create in -lpthread... " >&6; }
+  { $as_echo "$as_me:${as_lineno-$LINENO}: checking for pthread_create in -pthread" >&5
+$as_echo_n "checking for pthread_create in -pthread... " >&6; }
 if ${ac_cv_lib_pthread_pthread_create+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   ac_check_lib_save_LIBS=$LIBS
-LIBS="-lpthread  $LIBS"
+LIBS="-pthread  $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
@@@@ -4771,7 +4769,7 @@@@ fi
 $as_echo "$ac_cv_lib_pthread_pthread_create" >&6; }
 if test "x$ac_cv_lib_pthread_pthread_create" = xyes; then :
   SPECIFIC_CFLAGS="$SPECIFIC_CFLAGS -DHAVE_PTHREAD"
-		 SPECIFIC_LDFLAGS="$SPECIFIC_LDFLAGS -lpthread"
+		 SPECIFIC_LDFLAGS="$SPECIFIC_LDFLAGS -pthread"
 else
   { $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: Pthread not supported. No SMP support" >&5
 $as_echo "$as_me: WARNING: Pthread not supported. No SMP support" >&2;}
@


1.6
log
@- bugfix update to 1.3.2
* mostly bugfixes for windows or things that don't affect openbsd

from brad (MAINTAINER)
@
text
@d1 1
a1 1
$OpenBSD: patch-build_generic_configure,v 1.5 2011/03/20 23:49:33 edd Exp $
d3 1
a3 1
+++ build/generic/configure	Wed Jun 15 14:46:41 2011
d18 1
a18 1
+	SPECIFIC_LDFLAGS="-shared -lm"
@


1.5
log
@update to 1.3.0. From brad and OK jakemsr@@
@
text
@d1 4
a4 4
$OpenBSD: patch-build_generic_configure,v 1.4 2009/06/16 20:38:50 naddy Exp $
--- build/generic/configure.orig	Mon Feb 14 12:29:29 2011
+++ build/generic/configure	Sat Mar  5 16:55:23 2011
@@@@ -1316,8 +1316,6 @@@@ ac_compiler_gnu=$ac_cv_c_compiler_gnu
d13 2
a14 2
@@@@ -3939,7 +3937,7 @@@@ echo "${ECHO_T}ok" >&6
 echo "${ECHO_T}ok" >&6
d22 1
a22 1
@@@@ -4199,7 +4197,7 @@@@ echo "${ECHO_T}macho32" >&6
d31 10
a40 10
@@@@ -4614,13 +4612,13 @@@@ echo "${ECHO_T}$ac_cv_header_pthread_h" >&6
 
 fi
 if test $ac_cv_header_pthread_h = yes; then
-  echo "$as_me:$LINENO: checking for pthread_create in -lpthread" >&5
-echo $ECHO_N "checking for pthread_create in -lpthread... $ECHO_C" >&6
+  echo "$as_me:$LINENO: checking for pthread_create in -pthread" >&5
+echo $ECHO_N "checking for pthread_create in -pthread... $ECHO_C" >&6
 if test "${ac_cv_lib_pthread_pthread_create+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
d45 6
a50 6
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@@@ -4680,7 +4678,7 @@@@ echo "$as_me:$LINENO: result: $ac_cv_lib_pthread_pthre
 echo "${ECHO_T}$ac_cv_lib_pthread_pthread_create" >&6
 if test $ac_cv_lib_pthread_pthread_create = yes; then
d52 2
a53 2
-		SPECIFIC_LDFLAGS="$SPECIFIC_LDFLAGS -lpthread"
+		SPECIFIC_LDFLAGS="$SPECIFIC_LDFLAGS -pthread"
d55 2
a56 2
   { echo "$as_me:$LINENO: WARNING: Pthread not supported. No SMP support" >&5
 echo "$as_me: WARNING: Pthread not supported. No SMP support" >&2;}
@


1.4
log
@SECURITY update to 1.2.2.
Fix heap-based buffer overflows.  CVE-2009-0893, -0894.
ok sthen@@, Brad (maintainer)
@
text
@d1 4
a4 4
$OpenBSD: patch-build_generic_configure,v 1.3 2009/05/10 20:16:10 sthen Exp $
--- build/generic/configure.orig	Thu May 28 19:13:31 2009
+++ build/generic/configure	Tue Jun 16 17:43:38 2009
@@@@ -1316,8 +1316,8 @@@@ ac_compiler_gnu=$ac_cv_c_compiler_gnu
d9 1
a9 3
-API_MINOR="2"
+API_MAJOR="$API_MAJOR"
+API_MINOR="$API_MINOR"
d11 1
a11 1
 minimum_yasm_minor_version=8
d13 1
a13 1
@@@@ -3858,7 +3858,7 @@@@ echo "${ECHO_T}ok" >&6
d22 1
a22 1
@@@@ -4112,7 +4112,7 @@@@ echo "${ECHO_T}macho" >&6
d31 1
a31 1
@@@@ -4526,13 +4526,13 @@@@ echo "${ECHO_T}$ac_cv_header_pthread_h" >&6
d48 1
a48 2
@@@@ -4591,13 +4591,13 @@@@ fi
 echo "$as_me:$LINENO: result: $ac_cv_lib_pthread_pthread_create" >&5
a50 16
-  echo "$as_me:$LINENO: checking for pthread_join in -lpthread" >&5
-echo $ECHO_N "checking for pthread_join in -lpthread... $ECHO_C" >&6
+  echo "$as_me:$LINENO: checking for pthread_join in -pthread" >&5
+echo $ECHO_N "checking for pthread_join in -pthread... $ECHO_C" >&6
 if test "${ac_cv_lib_pthread_pthread_join+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   ac_check_lib_save_LIBS=$LIBS
-LIBS="-lpthread  $LIBS"
+LIBS="-pthread  $LIBS"
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@@@ -4657,7 +4657,7 @@@@ echo "$as_me:$LINENO: result: $ac_cv_lib_pthread_pthre
 echo "${ECHO_T}$ac_cv_lib_pthread_pthread_join" >&6
 if test $ac_cv_lib_pthread_pthread_join = yes; then
d52 2
a53 2
-			SPECIFIC_LDFLAGS="$SPECIFIC_LDFLAGS -lpthread"
+			SPECIFIC_LDFLAGS="$SPECIFIC_LDFLAGS -pthread"
@


1.3
log
@update to 1.2.1, from Brad (taking maintainer).
@
text
@d1 3
a3 3
$OpenBSD: patch-build_generic_configure,v 1.2 2008/07/14 06:02:31 brad Exp $
--- build/generic/configure.orig	Wed Dec  3 06:01:54 2008
+++ build/generic/configure	Fri Apr 10 20:10:23 2009
d13 1
d15 1
a15 2
 minimum_nasm_major_version=2
@@@@ -3856,7 +3856,7 @@@@ echo "${ECHO_T}ok" >&6
d24 1
a24 1
@@@@ -4038,7 +4038,7 @@@@ echo "${ECHO_T}macho" >&6
d33 1
a33 1
@@@@ -4452,13 +4452,13 @@@@ echo "${ECHO_T}$ac_cv_header_pthread_h" >&6
d50 1
a50 1
@@@@ -4517,13 +4517,13 @@@@ fi
d67 1
a67 1
@@@@ -4583,7 +4583,7 @@@@ echo "$as_me:$LINENO: result: $ac_cv_lib_pthread_pthre
@


1.2
log
@- Update to XVidcore 1.1.3.
- Enable MMX/SSE2 support on amd64/i386.
- Remove the previous MAINTAINER.

ok jakemsr@@
@
text
@d1 3
a3 3
$OpenBSD: patch-build_generic_configure,v 1.1 2006/01/08 22:12:38 jakemsr Exp $
--- build/generic/configure.orig	Thu Jun 28 11:27:27 2007
+++ build/generic/configure	Mon Jul  7 23:31:24 2008
d9 1
a9 1
-API_MINOR="1"
d13 3
a15 12
 minimum_nasm_patch_version=34
 nasm_prog="nasm"
@@@@ -2613,7 +2613,7 @@@@ echo $ECHO_N "checking for architecture type... $ECHO_
 echo "${ECHO_T}ia32" >&6
 	  	ARCHITECTURE="IA32"
                 ;;
-          x86_64)
+          x86_64 | amd64)
                 echo "$as_me:$LINENO: result: x86_64" >&5
 echo "${ECHO_T}x86_64" >&6
                 ARCHITECTURE="X86_64"
@@@@ -3838,7 +3838,7 @@@@ echo "${ECHO_T}ok" >&6
d24 52
@


1.1
log
@SHARED_LIBS
drop SONAME encoding
don't link the library against libc, adjust WANTLIB accordingly
bump PKGNAME

tested with multimedia/transcode, which is the only port using xvidcore

OK alek@@
@
text
@d1 3
a3 3
$OpenBSD$
--- build/generic/configure.orig	Sun Dec 19 03:38:55 2004
+++ build/generic/configure	Sat Dec 24 03:48:11 2005
d9 1
a9 1
-API_MINOR="0"
d15 10
a24 1
@@@@ -3824,7 +3824,7 @@@@ case "$target_os" in
@

