head	1.7;
access;
symbols
	OPENBSD_6_1:1.7.0.2
	OPENBSD_6_1_BASE:1.7
	OPENBSD_6_0:1.5.0.2
	OPENBSD_6_0_BASE:1.5
	OPENBSD_5_9:1.3.0.2
	OPENBSD_5_9_BASE:1.3
	landry_20153010:1.1.1.1
	pkeshishian:1.1.1;
locks; strict;
comment	@# @;


1.7
date	2017.02.09.07.51.55;	author landry;	state Exp;
branches;
next	1.6;
commitid	MlKXZXtApVKUh3X4;

1.6
date	2016.08.30.15.22.06;	author danj;	state Exp;
branches;
next	1.5;
commitid	7RXcurRRa3zVaPjz;

1.5
date	2016.05.01.20.23.54;	author danj;	state Exp;
branches;
next	1.4;
commitid	0DkrwmomgTVH5A5h;

1.4
date	2016.04.27.17.02.34;	author danj;	state Exp;
branches;
next	1.3;
commitid	nifdTv0HcLEPVWGC;

1.3
date	2015.12.29.19.49.40;	author jasper;	state Exp;
branches;
next	1.2;
commitid	qnWWfNxRwuFA0B7n;

1.2
date	2015.12.29.12.54.10;	author jasper;	state Exp;
branches;
next	1.1;
commitid	Z7BAKWlffCf6cwcy;

1.1
date	2015.10.30.17.18.53;	author landry;	state Exp;
branches
	1.1.1.1;
next	;
commitid	y9V5N1cjeUSQa130;

1.1.1.1
date	2015.10.30.17.18.53;	author landry;	state Exp;
branches;
next	;
commitid	y9V5N1cjeUSQa130;


desc
@@


1.7
log
@Mark BROKEN, fails to build with geos 3.6.

Reported by naddy@@ & sthen@@, also see
https://github.com/openstreetmap/osm2pgsql/issues/634,
https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=214819 and
https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=216338
@
text
@# $OpenBSD: Makefile,v 1.6 2016/08/30 15:22:06 danj Exp $

COMMENT =		OSM data to PostgreSQL converter
#https://github.com/openstreetmap/osm2pgsql/issues/634
BROKEN =		doesnt build with geos 3.6 API

GH_TAGNAME =		0.90.1
GH_PROJECT =		osm2pgsql
GH_ACCOUNT =		openstreetmap

CATEGORIES =		geo databases

HOMEPAGE =		http://wiki.openstreetmap.org/wiki/Osm2pgsql

# GPLv2
PERMIT_PACKAGE_CDROM =	Yes

USE_GMAKE =		Yes

WANTLIB += boost_system-mt boost_filesystem-mt bz2 c expat
WANTLIB += geos m pthread pq proj z ${MODLUA_WANTLIB}

# postgresql needs to be first otherwise tests are done by cmake module
MODULES =		databases/postgresql    \
			devel/cmake		\
			gcc4			\
			lang/python		\
			lang/lua

LIB_DEPENDS =		databases/postgresql	\
			devel/proj		\
			geo/geos		\
			devel/boost		\

BUILD_DEPENDS =		devel/libtool

# postgresql,-contrib is needed for hstore extension
TEST_DEPENDS =		databases/py-psycopg2	\
			geo/postgis		\
			databases/postgresql,-contrib

MODGCC4_ARCHS =		*
MODGCC4_LANGS +=	c++

MODPY_ADJ_FILES =	tests/regression-test.py

MODLUA_VERSION =	5.2
MODLUA_SA =		Yes

CONFIGURE_ARGS =	-DBUILD_TESTS=ON

# bump postgresql,-server limits according to its README otherwise some
# tests fail
MODPOSTGRESQL_TEST_DBNAME =	osm2pgsql-test
MODPOSTGRESQL_TEST_CMD =	cd ${WRKSRC} && ${MODPY_BIN} tests/regression-test.py \
				-x ${WRKBUILD}/osm2pgsql

pre-configure:
	${SUBST_CMD} ${WRKSRC}/CMakeLists.txt
	rm -f ${WRKSRC}/cmake/FindLua.cmake

post-patch:
	@@${SUBST_CMD} ${WRKSRC}/docs/osm2pgsql.1

.include <bsd.port.mk>
@


1.6
log
@Update to osm2pgsql-0.90.1

tested by landry@@ and Sol√®ne Rapenne, thanks!
ok landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2016/05/01 20:23:54 danj Exp $
d4 2
@


1.5
log
@fix the test

now out of 40 tests, only 1 fails

ok landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2016/04/27 17:02:34 danj Exp $
d5 1
a5 1
GH_TAGNAME =		0.90.0
@


1.4
log
@update to osm2pgsql-0.90.0

enable tests but for now most of them fail because they can't connect to a DB

with/ok landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2015/12/29 19:49:40 jasper Exp $
d21 3
a23 3

MODULES =		devel/cmake		\
			databases/postgresql	\
d35 4
a38 2
TEST_DEPENDS =		databases/py-psycopg2 \
			geo/postgis
d49 6
@


1.3
log
@DISTNAME is set by bsd.port.mk for these ports now
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2015/12/29 12:54:10 jasper Exp $
d5 1
a5 1
GH_TAGNAME =		0.88.1
d16 1
a16 3
CONFIGURE_STYLE =	autoconf
AUTOMAKE_VERSION =	1.14
AUTOCONF_VERSION =	2.69
d18 2
a19 1
USE_GMAKE =		Yes
a20 3
WANTLIB +=		boost_filesystem boost_system boost_system-mt
WANTLIB +=		boost_thread-mt bz2 c crypto geos lzma
WANTLIB +=		m pq proj protobuf-c pthread ssl stdc++ xml2 z ${MODLUA_WANTLIB}
d22 1
a22 1
MODULES =		converters/libiconv	\
a29 1
			devel/protobuf-c	\
a30 1
			textproc/libxml		\
d33 1
a33 3
BUILD_DEPENDS =		${MODGNU_AUTOCONF_DEPENDS}	\
			${MODGNU_AUTOMAKE_DEPENDS}	\
			devel/libtool			\
d43 1
a43 1
MODLUA_VERSION =	5.1
d46 5
a50 7
CONFIGURE_ENV +=	CXXFLAGS="${CXXFLAGS} -D_GLIBCXX_USE_DEPRECATED"
CONFIGURE_ENV +=	LUA=${MODLUA_BIN}
CONFIGURE_ENV +=	LUA_INCLUDE=-I${MODLUA_INCL_DIR}
CONFIGURE_ENV +=	LUA_LIB=${MODLUA_LIB}
CONFIGURE_ENV +=	LDFLAGS=-L${LOCALBASE}/lib
CONFIGURE_ENV +=	AUTOCONF_VERSION=${AUTOCONF_VERSION}
CONFIGURE_ENV +=	AUTOMAKE_VERSION=${AUTOMAKE_VERSION}
a52 2
	cd ${WRKSRC} && ${SETENV} ${CONFIGURE_ENV} \
		autoreconf -vfi
@


1.2
log
@use GH_PROJECT to construct DISTNAME
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2015/10/30 17:18:53 landry Exp $
a8 1
DISTNAME =		${GH_PROJECT}-${GH_TAGNAME}
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d9 1
a9 1
DISTNAME =		osm2pgsql-${GH_TAGNAME}
@


1.1.1.1
log
@Import osm2pgsql 0.88.1.

osm2pgsql is a tool for loading OpenStreetMap data into a PostgreSQL/PostGIS
database suitable for applications like rendering into a map, geocoding with
Nominatim, or general analysis.

From Patrick Keshishian with tweaks by sthen@@ & myself
ok sthen@@
@
text
@@
