head	1.34;
access;
symbols
	OPENBSD_6_2:1.34.0.2
	OPENBSD_6_2_BASE:1.34
	OPENBSD_6_1:1.33.0.2
	OPENBSD_6_1_BASE:1.33
	OPENBSD_6_0:1.28.0.2
	OPENBSD_6_0_BASE:1.28
	OPENBSD_5_9:1.25.0.2
	OPENBSD_5_9_BASE:1.25
	OPENBSD_5_8:1.19.0.4
	OPENBSD_5_8_BASE:1.19
	OPENBSD_5_7:1.16.0.2
	OPENBSD_5_7_BASE:1.16
	OPENBSD_5_6:1.13.0.2
	OPENBSD_5_6_BASE:1.13
	OPENBSD_5_5:1.2.0.2
	OPENBSD_5_5_BASE:1.2
	jasper_20132609:1.1.1.1
	jasper:1.1.1;
locks; strict;
comment	@# @;


1.34
date	2017.05.29.14.43.53;	author jasper;	state Exp;
branches;
next	1.33;
commitid	SOuFJai4IAESZLl5;

1.33
date	2017.03.29.19.08.32;	author jasper;	state Exp;
branches;
next	1.32;
commitid	9CN2x7R59VMbuVbG;

1.32
date	2017.01.29.11.02.05;	author jasper;	state Exp;
branches;
next	1.31;
commitid	eA9b0ZTeDbAuIuBE;

1.31
date	2016.09.07.06.40.02;	author jasper;	state Exp;
branches;
next	1.30;
commitid	I502Pls6sxViksA4;

1.30
date	2016.08.31.15.00.03;	author sthen;	state Exp;
branches;
next	1.29;
commitid	3qdUKMnZPXHQCiFA;

1.29
date	2016.08.31.08.47.12;	author jasper;	state Exp;
branches;
next	1.28;
commitid	quHvrj9Zt0zgc3Cu;

1.28
date	2016.04.29.18.54.49;	author ajacoutot;	state Exp;
branches;
next	1.27;
commitid	BC5ByBZGANE6IUbx;

1.27
date	2016.03.03.09.22.46;	author jasper;	state Exp;
branches;
next	1.26;
commitid	JdNu7E5IOx1ZRZHg;

1.26
date	2016.02.29.13.30.40;	author jasper;	state Exp;
branches;
next	1.25;
commitid	gtQkixMlinJkCltY;

1.25
date	2015.12.10.07.58.03;	author jasper;	state Exp;
branches;
next	1.24;
commitid	zUgMKQcSwMZxvVcs;

1.24
date	2015.11.20.17.57.22;	author ajacoutot;	state Exp;
branches;
next	1.23;
commitid	fBO4jgDxK3wZeqFU;

1.23
date	2015.11.20.15.44.03;	author ajacoutot;	state Exp;
branches;
next	1.22;
commitid	pMPFXHYi8eowqKIE;

1.22
date	2015.10.29.08.58.20;	author jasper;	state Exp;
branches;
next	1.21;
commitid	xm4Jn18idcCD9KLp;

1.21
date	2015.09.28.11.00.35;	author jasper;	state Exp;
branches;
next	1.20;
commitid	hCYOr8lPteykrcRl;

1.20
date	2015.08.27.06.48.30;	author ajacoutot;	state Exp;
branches;
next	1.19;
commitid	fg1RtdQjUrtjJJWq;

1.19
date	2015.07.07.12.54.38;	author ajacoutot;	state Exp;
branches;
next	1.18;
commitid	tcKi2GMBYhfsTJgA;

1.18
date	2015.04.13.07.49.34;	author jasper;	state Exp;
branches;
next	1.17;
commitid	OPEU48P9ruAiliov;

1.17
date	2015.04.04.09.30.30;	author ajacoutot;	state Exp;
branches;
next	1.16;
commitid	QSLndtZiU46ysFLn;

1.16
date	2015.01.24.17.53.05;	author ajacoutot;	state Exp;
branches;
next	1.15;
commitid	JNkSS3vy1axiI2Es;

1.15
date	2014.10.10.12.55.31;	author ajacoutot;	state Exp;
branches;
next	1.14;
commitid	ygQoGh6hoGeeqFWJ;

1.14
date	2014.10.04.08.41.56;	author jasper;	state Exp;
branches;
next	1.13;
commitid	uWSwaRWFnc2dlQoE;

1.13
date	2014.07.09.17.43.52;	author ajacoutot;	state Exp;
branches;
next	1.12;
commitid	Nm4l5yAcUVwu1rIN;

1.12
date	2014.07.09.13.55.59;	author ajacoutot;	state Exp;
branches;
next	1.11;
commitid	c4pRJ4t1whiJdImt;

1.11
date	2014.06.19.11.20.29;	author ajacoutot;	state Exp;
branches;
next	1.10;
commitid	v8vqwukkV8U0nEWV;

1.10
date	2014.06.19.08.48.59;	author jasper;	state Exp;
branches;
next	1.9;
commitid	FLKGPAoOGebeJo1A;

1.9
date	2014.04.02.09.36.11;	author jasper;	state Exp;
branches;
next	1.8;

1.8
date	2014.04.01.18.38.53;	author jasper;	state Exp;
branches;
next	1.7;

1.7
date	2014.03.29.00.27.00;	author ajacoutot;	state Exp;
branches;
next	1.6;

1.6
date	2014.03.29.00.19.45;	author ajacoutot;	state Exp;
branches;
next	1.5;

1.5
date	2014.03.27.17.51.07;	author ajacoutot;	state Exp;
branches;
next	1.4;

1.4
date	2014.03.27.11.30.16;	author ajacoutot;	state Exp;
branches;
next	1.3;

1.3
date	2014.03.27.10.58.21;	author jasper;	state Exp;
branches;
next	1.2;

1.2
date	2013.10.26.08.02.57;	author ajacoutot;	state Exp;
branches;
next	1.1;

1.1
date	2013.09.26.08.41.46;	author jasper;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2013.09.26.08.41.46;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.34
log
@update to geoclue-2.4.7
@
text
@# $OpenBSD: Makefile,v 1.33 2017/03/29 19:08:32 jasper Exp $

COMMENT=		modular geoinformation service on top of D-Bus

VERSION=		2.4.7
DISTNAME=		geoclue-${VERSION}
PKGNAME=		geoclue2-${VERSION}
CATEGORIES=		geo devel

SHARED_LIBS +=  geoclue-2                 0.1 # 0.0

HOMEPAGE=		http://geoclue.freedesktop.org/

MAINTAINER=		Jasper Lievisse Adriaanse <jasper@@openbsd.org>, \
			Antoine Jacoutot <ajacoutot@@openbsd.org>

# LGPLv2
PERMIT_PACKAGE_CDROM=	Yes

MASTER_SITES=		http://freedesktop.org/software/geoclue/releases/${VERSION:R}/
EXTRACT_SUFX=		.tar.xz

WANTLIB += c ffi gio-2.0 glib-2.0 gmodule-2.0 gobject-2.0 json-glib-1.0
WANTLIB += lzma m pcre pthread soup-2.4 sqlite3 xml2 z iconv intl
WANTLIB += avahi-client avahi-common avahi-glib dbus-1

MODULES=		textproc/intltool \
			x11/gnome

LIB_DEPENDS=		devel/libsoup \
			devel/json-glib \
			net/avahi

# XXX requires DBus support in wpa_supplicant
# (wpa_supplicant in OpenBSD is also crippled in other ways)
#RUN_DEPENDS=		security/wpa_supplicant

# /usr/local/share/dbus-1/system-services/
RUN_DEPENDS +=		x11/dbus,-suid

MODGNOME_TOOLS=		desktop-file-utils gobject-introspection

USE_GMAKE=		Yes

CONFIGURE_STYLE=	gnu
CONFIGURE_ARGS=		--with-dbus-service-user=_geoclue

# disable all components requiring ModemManager
CONFIGURE_ARGS +=	--disable-3g-source \
			--disable-modem-gps-source \
			--disable-cdma-source

FAKE_FLAGS=		DBUS_SYS_DIR=${PREFIX}/share/examples/geoclue/dbus-1/system.d \
			sysconfdir=${PREFIX}/share/examples/geoclue/

# don't install the demo agent .desktop file (agent requires MM)
FAKE_FLAGS +=		apps_DATA=geoclue-where-am-i.desktop

.include <bsd.port.mk>
@


1.33
log
@update to geoclue2-2.4.6, extends application whitelist and other bugfixes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2017/01/29 11:02:05 jasper Exp $
d5 1
a5 1
VERSION=		2.4.6
@


1.32
log
@update to geoclue2-2.4.5
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2016/09/07 06:40:02 jasper Exp $
d5 1
a5 1
VERSION=		2.4.5
@


1.31
log
@- update to geoclue-2.4.4
- drop gettext module
- remove our local patch yet again, this time because upstream applied it too.
  neither antoine nor myself could remember why it was added, but it seems
  upstream did figure it out in the end..
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2016/08/31 15:00:03 sthen Exp $
d5 1
a5 1
VERSION=		2.4.4
@


1.30
log
@readd patch, it didn't autofix on i386*.p. ok aja
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2016/08/31 08:47:12 jasper Exp $
d5 1
a5 1
VERSION=		2.4.3
a8 1
REVISION=		2
d10 1
a10 1
SHARED_LIBS +=  geoclue-2                 0.0 # 0.0
d24 1
a24 1
WANTLIB += lzma m pcre pthread soup-2.4 sqlite3 xml2 z
d27 1
a27 2
MODULES=		devel/gettext \
			textproc/intltool \
@


1.29
log
@remove now-unneeded patch, it appears the underlying issue has been auto-fixed.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2016/04/29 18:54:49 ajacoutot Exp $
d9 1
a9 1
REVISION=		1
@


1.28
log
@Fix introspection build, otherwise most GNOME ports using geoclue2 won't
work.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2016/03/03 09:22:46 jasper Exp $
d9 1
a9 1
REVISION=		0
@


1.27
log
@update to geoclue2-2.4.3
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2016/02/29 13:30:40 jasper Exp $
d9 1
d43 1
a43 5
MODGNOME_TOOLS +=	desktop-file-utils

# XXX
# ERROR: can't resolve libraries to shared libraries: geoclue-2
#MODGNOME_TOOLS +=	gobject-introspection
@


1.26
log
@update to geoclue-2.4.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2015/12/10 07:58:03 jasper Exp $
d5 1
a5 1
VERSION=		2.4.2
@


1.25
log
@update to geoclue-2.4.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2015/11/20 17:57:22 ajacoutot Exp $
d5 1
a5 1
VERSION=		2.4.1
@


1.24
log
@Revert gtail dependency; our tail(1) had a temporary bug that got fixed since.

cluestick from sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2015/11/20 15:44:03 ajacoutot Exp $
d5 1
a5 1
VERSION=		2.4.0
a8 1
REVISION=		0
@


1.23
log
@This suddently needs gtail (from coreutils) to build now... I don't have the
time to look at why right now, so just depend on coreutils for the time being.
While here, merge a patch from upstream to prevent spamming logs and add a
comment about gobject-introspection.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2015/10/29 08:58:20 jasper Exp $
a30 3

# XXX NEEDS FIXING see patches/patch-src_Makefile_in
BUILD_DEPENDS +=	sysutils/coreutils
@


1.22
log
@update to geoclue-2.4.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2015/09/28 11:00:35 jasper Exp $
d9 1
d32 3
d47 4
@


1.21
log
@update to geoclue-2.3.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2015/08/27 06:48:30 ajacoutot Exp $
d5 1
a5 1
VERSION=		2.3.0
d9 2
@


1.20
log
@Fix DBus @@sample files after recent dbus port update.
The dbus package does not install /etc/dbus-1/system.d/ anymore, so it
needs to be properly @@sample'd.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2015/07/07 12:54:38 ajacoutot Exp $
d5 1
a5 1
VERSION=		2.2.0
a8 1
REVISION=		1
d23 1
d30 2
a31 1
			devel/json-glib
@


1.19
log
@Do not whitelist redshift; that's a user decision and there's a better
way to do it:
https://github.com/bigon/redshift/commit/3bb7a9857dd84204ef337c7624e91a3dbbdda34b
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2015/04/13 07:49:34 jasper Exp $
d9 1
a9 1
REVISION=		0
@


1.18
log
@update to geoclue2-2.2.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2015/04/04 09:30:30 ajacoutot Exp $
d9 1
@


1.17
log
@These need to RUN_DEPENDS on x11/dbus,-suid now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2015/01/24 17:53:05 ajacoutot Exp $
d5 1
a5 1
VERSION=		2.1.10
a8 1
REVISION=		2
d22 1
a22 1
WANTLIB += m pcre pthread soup-2.4 sqlite3 xml2 z
@


1.16
log
@Allow redshit to access the location services by default so that it works
out of the box.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2014/10/10 12:55:31 ajacoutot Exp $
d9 1
a9 1
REVISION=		1
d35 3
@


1.15
log
@Hobbits take maintainer.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2014/10/04 08:41:56 jasper Exp $
d9 1
a9 1
REVISION=		0
@


1.14
log
@update to geoclue-2.1.10
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2014/07/09 17:43:52 ajacoutot Exp $
d9 1
d12 3
@


1.13
log
@The x11/gnome MODULE will soon stop setting USE_GMAKE unconditionally, so
explicitely add it where needed.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2014/07/09 13:55:59 ajacoutot Exp $
d5 1
a5 1
VERSION=		2.1.9
a8 1
REVISION=		1
d41 2
a42 1
			--disable-modem-gps-source
@


1.12
log
@These need textproc/intltool in MODULES since they are not GNOME_PROJECT
ports.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2014/06/19 11:20:29 ajacoutot Exp $
d34 2
@


1.11
log
@Drop dependency on wpa_supplicant. It requires DBus support in wpa_supplicant
and according to sthen@@ ours is crippled in other ways anyway... so not worth
the pain.

ok jasper@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2014/06/19 08:48:59 jasper Exp $
d9 1
a9 1
REVISION=		0
d23 1
@


1.10
log
@update to geoclue2-2.1.9
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2014/04/02 09:36:11 jasper Exp $
d9 1
d27 4
a30 1
RUN_DEPENDS=		security/wpa_supplicant
@


1.9
log
@cleanup double spaces and sort MODGNOME_TOOLS
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2014/04/01 18:38:53 jasper Exp $
d5 1
a5 1
VERSION=		2.1.7
a8 1
REVISION=		3
d26 1
a34 1
			--disable-wifi-source \
@


1.8
log
@switch over port to MODGNOME_TOOLS that didnt have it yet
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2014/03/29 00:27:00 ajacoutot Exp $
d28 1
a28 1
MODGNOME_TOOLS=		desktop-file-utils
@


1.7
log
@Duh, actually fix running as unpriv user -- was due to an evil typo...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2014/03/29 00:19:45 ajacoutot Exp $
d28 1
a28 1
MODGNOME_DESKTOP_FILE=	Yes
@


1.6
log
@Run as root for now; for some require it cannot acquire the bus.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2014/03/27 17:51:07 ajacoutot Exp $
d9 1
a9 1
REVISION=		2
d31 1
a31 2
# XXX Failed to acquire name 'org.freedesktop.GeoClue2' on system bus or lost it.
#CONFIGURE_ARGS=		--with-dbus-service-user==_geoclue
@


1.5
log
@It makes no sense to explicitely depend on x11/dbus; nowadays dbus will
almost end up in any dependency chain and if we start adding run_depends on
it, we'll beed to do it for a hundre ports or so.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2014/03/27 11:30:16 ajacoutot Exp $
d9 1
a9 1
REVISION=		1
d31 2
a32 1
CONFIGURE_ARGS=		--with-dbus-service-user==_geoclue
@


1.4
log
@Properly install configuration files.
Run the DBus service as an unprivilege user.
Add a RUN_DEPENDS on DBus.
Use the x11/gnome MODULE so that we don't need to BUILD_DEPENDS on
devel/desktop-file-utils.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2014/03/27 10:58:21 jasper Exp $
d9 1
a9 1
REVISION=		0
a26 2

RUN_DEPENDS=		x11/dbus
@


1.3
log
@update to geoclue-2.1.7
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2013/10/26 08:02:57 ajacoutot Exp $
d9 1
d23 1
a23 1
			textproc/intltool
d25 1
a25 1
LIB_DEPENDS =		devel/libsoup \
a26 1
RUN_DEPENDS =		devel/desktop-file-utils
d28 3
a30 1
USE_GMAKE=		Yes
d33 1
a33 2
CONFIGURE_ARGS=		${CONFIGURE_SHARED} \
			--disable-gtk-doc
a38 2
CONFIGURE_ENV=          CPPFLAGS="-I${LOCALBASE}/include" \
                        LDFLAGS="-L${LOCALBASE}/lib"
d40 2
a41 1
FAKE_FLAGS+=		DBUS_SYS_DIR=${PREFIX}/share/examples/geoclue/
a44 6

# If one of these tools is found at configure stage, it might be used,
# no matter whether we use --disable-gtk-doc or not.
CONFIGURE_ENV +=ac_cv_path_GTKDOC_CHECK="" \
		ac_cv_path_GTKDOC_REBASE="" \
		ac_cv_path_GTKDOC_MKPDF=""
@


1.2
log
@Fix dependencies and bump after the recent libsoup -gnome => -main merge.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2013/09/26 08:41:46 jasper Exp $
d5 1
a5 1
VERSION=		2.0.0
a8 1
REVISION=		0
d26 1
d33 5
d42 3
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2013/03/30 09:40:57 ajacoutot Exp $
d9 1
@


1.1.1.1
log
@import geoclue-2.0.0 which is a rewrite of the current geo/geoclue       
and dependant ports (most notably webkit) cannot handle this newness yet

ok aja@@

@
text
@@
