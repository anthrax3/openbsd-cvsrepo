head	1.2;
access;
symbols;
locks; strict;
comment	@# @;


1.2
date	2017.02.07.08.17.57;	author landry;	state dead;
branches;
next	1.1;
commitid	2P3sIQzwZA0p2UsJ;

1.1
date	2016.09.02.15.28.24;	author landry;	state Exp;
branches;
next	;
commitid	EMmBaLk8yrjYS1uu;


desc
@@


1.2
log
@Update to mapservr 7.0.4.

See http://mapserver.org/development/changelog/changelog-7-0.html#changelog-7-0-4
Backport an upstream patch to fix php bindings build, remove a patch
merged upstream.
@
text
@$OpenBSD: patch-mapscript_php_error_c,v 1.1 2016/09/02 15:28:24 landry Exp $

Fix build with php 5.6.25

https://github.com/mapserver/mapserver/issues/5318

--- mapscript/php/error.c.orig	Fri Sep  2 17:23:55 2016
+++ mapscript/php/error.c	Fri Sep  2 17:24:26 2016
@@@@ -31,6 +31,15 @@@@
 
 #include "php_mapscript.h"
 
+#undef ZVAL_STRING
+#define ZVAL_STRING(z, s, duplicate) do {       \
+                const char *__s=(s);                            \
+                zval *__z = (z);                                        \
+                Z_STRLEN_P(__z) = strlen(__s);          \
+                Z_STRVAL_P(__z) = (duplicate?estrndup(__s, Z_STRLEN_P(__z)):(char*)__s);\
+                Z_TYPE_P(__z) = IS_STRING;                      \
+        } while (0)
+
 zend_class_entry *mapscript_ce_error;
 
 ZEND_BEGIN_ARG_INFO_EX(error___get_args, 0, 0, 1)
@


1.1
log
@Fix build with php 5.6.25, from robert@@.

Filed https://github.com/mapserver/mapserver/pull/5318 upstream.
@
text
@d1 1
a1 1
$OpenBSD$
@

