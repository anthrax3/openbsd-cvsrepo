head	1.48;
access;
symbols
	OPENBSD_6_1:1.44.0.2
	OPENBSD_6_1_BASE:1.44
	OPENBSD_6_0:1.40.0.2
	OPENBSD_6_0_BASE:1.40
	OPENBSD_5_9:1.38.0.2
	OPENBSD_5_9_BASE:1.38
	OPENBSD_5_8:1.37.0.4
	OPENBSD_5_8_BASE:1.37
	OPENBSD_5_7:1.34.0.2
	OPENBSD_5_7_BASE:1.34
	OPENBSD_5_6:1.33.0.2
	OPENBSD_5_6_BASE:1.33
	OPENBSD_5_5:1.32.0.2
	OPENBSD_5_5_BASE:1.32
	OPENBSD_5_4:1.26.0.2
	OPENBSD_5_4_BASE:1.26
	OPENBSD_5_3:1.24.0.2
	OPENBSD_5_3_BASE:1.24
	OPENBSD_5_2:1.22.0.2
	OPENBSD_5_2_BASE:1.22
	OPENBSD_5_1_BASE:1.21
	OPENBSD_5_1:1.21.0.2
	OPENBSD_5_0:1.13.0.2
	OPENBSD_5_0_BASE:1.13
	OPENBSD_4_9:1.9.0.2
	OPENBSD_4_9_BASE:1.9
	OPENBSD_4_8:1.6.0.2
	OPENBSD_4_8_BASE:1.6
	OPENBSD_4_7:1.3.0.2
	OPENBSD_4_7_BASE:1.3
	OPENBSD_4_6:1.1.1.1.0.2
	OPENBSD_4_6_BASE:1.1.1.1
	landry_20090604:1.1.1.1
	landry:1.1.1;
locks; strict;
comment	@# @;


1.48
date	2017.07.16.19.18.50;	author espie;	state Exp;
branches;
next	1.47;
commitid	tt0GhWK5c4uf9ILG;

1.47
date	2017.06.25.08.50.41;	author landry;	state Exp;
branches;
next	1.46;
commitid	WkAgQTmKDgLRzSXC;

1.46
date	2017.05.15.10.02.01;	author landry;	state Exp;
branches;
next	1.45;
commitid	KWa36tkF6WF1Ld4R;

1.45
date	2017.04.10.11.46.20;	author sthen;	state Exp;
branches;
next	1.44;
commitid	BLsh88fJB8thZTwY;

1.44
date	2017.02.14.09.46.56;	author landry;	state Exp;
branches;
next	1.43;
commitid	gkogMJOKPriUZWuR;

1.43
date	2017.02.07.08.17.57;	author landry;	state Exp;
branches;
next	1.42;
commitid	2P3sIQzwZA0p2UsJ;

1.42
date	2016.10.31.15.47.58;	author landry;	state Exp;
branches;
next	1.41;
commitid	GLGa9w02k11Bkurh;

1.41
date	2016.09.12.17.50.40;	author naddy;	state Exp;
branches;
next	1.40;
commitid	jAOH5wZFjoiwJM6G;

1.40
date	2016.03.19.23.59.15;	author naddy;	state Exp;
branches;
next	1.39;
commitid	f78UdaLw3Lb0ClLt;

1.39
date	2016.03.08.20.44.39;	author landry;	state Exp;
branches;
next	1.38;
commitid	YvbIzqqztz4ib9BG;

1.38
date	2015.09.07.19.05.30;	author landry;	state Exp;
branches;
next	1.37;
commitid	VKxudt2cQq5x10d5;

1.37
date	2015.07.15.23.56.36;	author ajacoutot;	state Exp;
branches;
next	1.36;
commitid	7OcA7Rb7FQtD8Tzh;

1.36
date	2015.06.06.09.03.16;	author kili;	state Exp;
branches;
next	1.35;
commitid	LioLhpCDIFfzzpQk;

1.35
date	2015.06.05.05.58.34;	author robert;	state Exp;
branches;
next	1.34;
commitid	6RD9HZ4qhgsD5sV8;

1.34
date	2014.11.06.17.13.39;	author sthen;	state Exp;
branches;
next	1.33;
commitid	ig1O4RkSPXzTZYwZ;

1.33
date	2014.05.18.09.29.50;	author landry;	state Exp;
branches;
next	1.32;

1.32
date	2014.01.10.14.47.09;	author dcoppa;	state Exp;
branches;
next	1.31;

1.31
date	2013.12.30.18.06.43;	author landry;	state Exp;
branches;
next	1.30;

1.30
date	2013.12.25.21.55.57;	author landry;	state Exp;
branches;
next	1.29;

1.29
date	2013.09.25.07.56.58;	author sthen;	state Exp;
branches;
next	1.28;

1.28
date	2013.08.12.04.11.20;	author robert;	state Exp;
branches;
next	1.27;

1.27
date	2013.08.06.19.47.17;	author landry;	state Exp;
branches;
next	1.26;

1.26
date	2013.07.05.07.23.33;	author jasper;	state Exp;
branches;
next	1.25;

1.25
date	2013.03.11.11.07.42;	author espie;	state Exp;
branches;
next	1.24;

1.24
date	2012.08.24.08.29.27;	author ajacoutot;	state Exp;
branches;
next	1.23;

1.23
date	2012.08.23.15.50.05;	author sthen;	state Exp;
branches;
next	1.22;

1.22
date	2012.02.16.21.21.58;	author sthen;	state Exp;
branches;
next	1.21;

1.21
date	2012.01.24.12.03.19;	author sthen;	state Exp;
branches;
next	1.20;

1.20
date	2012.01.24.09.21.30;	author sthen;	state Exp;
branches;
next	1.19;

1.19
date	2011.12.08.23.42.44;	author sthen;	state Exp;
branches;
next	1.18;

1.18
date	2011.12.08.22.40.15;	author sthen;	state Exp;
branches;
next	1.17;

1.17
date	2011.11.16.15.56.37;	author robert;	state Exp;
branches;
next	1.16;

1.16
date	2011.11.03.17.35.12;	author jasper;	state Exp;
branches;
next	1.15;

1.15
date	2011.10.16.16.03.26;	author ajacoutot;	state Exp;
branches;
next	1.14;

1.14
date	2011.09.16.09.48.10;	author espie;	state Exp;
branches;
next	1.13;

1.13
date	2011.07.28.08.35.34;	author jasper;	state Exp;
branches;
next	1.12;

1.12
date	2011.07.09.01.14.47;	author robert;	state Exp;
branches;
next	1.11;

1.11
date	2011.07.06.23.56.08;	author ajacoutot;	state Exp;
branches;
next	1.10;

1.10
date	2011.06.22.20.16.43;	author landry;	state Exp;
branches;
next	1.9;

1.9
date	2011.01.11.09.47.55;	author landry;	state Exp;
branches;
next	1.8;

1.8
date	2010.11.21.09.32.57;	author landry;	state Exp;
branches;
next	1.7;

1.7
date	2010.11.17.08.05.12;	author espie;	state Exp;
branches;
next	1.6;

1.6
date	2010.07.27.08.57.38;	author landry;	state Exp;
branches;
next	1.5;

1.5
date	2010.04.02.09.45.04;	author landry;	state Exp;
branches;
next	1.4;

1.4
date	2010.03.22.20.28.37;	author landry;	state Exp;
branches;
next	1.3;

1.3
date	2009.12.24.21.59.19;	author landry;	state Exp;
branches;
next	1.2;

1.2
date	2009.10.29.19.34.12;	author landry;	state Exp;
branches;
next	1.1;

1.1
date	2009.06.04.17.55.39;	author landry;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2009.06.04.17.55.39;	author landry;	state Exp;
branches;
next	;


desc
@@


1.48
log
@use COMPILER_LIBCXX where applicable
@
text
@# $OpenBSD: Makefile,v 1.47 2017/06/25 08:50:41 landry Exp $

MULTI_PACKAGES=	-utils -main -php -perl

COMMENT-main=	GIS CGI server
COMMENT-utils=	mapserver utilities
COMMENT-php=	PHP Mapscript extension
COMMENT-perl=	Perl Mapscript binding

V =		7.0.6
DISTNAME=	mapserver-${V}
PKGNAME-main=	${DISTNAME}
PKGNAME-utils=	mapserver-utils-${V}
PKGNAME-php=	php-mapscript-${V}
PKGNAME-perl=	p5-mapscript-${V}
SHARED_LIBS +=	mapserver 2.0

CATEGORIES=	geo www

HOMEPAGE=	http://www.mapserver.org/
# MIT
PERMIT_PACKAGE_CDROM=	Yes

MAINTAINER=	Landry Breuil <landry@@openbsd.org>

MASTER_SITES=	http://download.osgeo.org/mapserver/

MODULES=	lang/php devel/cmake
MODPHP_RUNDEP=	No
NO_TEST =	Yes
RUN_DEPENDS-php =	${MODPHP_RUN_DEPENDS}
RUN_DEPENDS-main =	www/spawn-fcgi
BUILD_DEPENDS +=	devel/swig databases/postgresql,-server

LIB_DEPENDS=	devel/proj \
		devel/fribidi \
		devel/harfbuzz \
		graphics/cairo \
		geo/gdal \
		geo/geos \
		graphics/giflib \
		www/fcgi

WANTLIB += curl freetype jpeg m png pq xml2 z proj
WANTLIB += gdal geos_c cairo fribidi gif harfbuzz

LIB_DEPENDS-utils =	STEM->=${V}:${BUILD_PKGPATH},-main
LIB_DEPENDS-php =	STEM->=${V}:${BUILD_PKGPATH},-main
LIB_DEPENDS-perl =	STEM->=${V}:${BUILD_PKGPATH},-main
WANTLIB-main =	${WANTLIB} c fcgi pthread ${COMPILER_LIBCXX}
WANTLIB-utils =	${WANTLIB} c mapserver pthread
WANTLIB-php =	${WANTLIB} mapserver
WANTLIB-perl =	${WANTLIB} mapserver perl

CONFIGURE_ARGS +=	-DPHP5_CONFIG_EXECUTABLE=${LOCALBASE}/bin/php-config-${MODPHP_VERSION} \
			-DWITH_CLIENT_WFS=1 \
			-DWITH_CLIENT_WMS=1 \
			-DWITH_CURL=1 \
			-DWITH_KML=1 \
			-DWITH_PHP=1 \
			-DWITH_PERL=1

PREFIX-main=	${VARBASE}/www

SUBST_VARS+=	PREFIX-main VARBASE

post-extract:
	rm -f ${WRKSRC}/cmake/Find{Freetype,PostgreSQL,ICONV}.cmake

post-install:
	${INSTALL_DATA_DIR} ${WRKINST}/${PREFIX-main}/cgi-bin
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/php-${MODPHP_VERSION}
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/mapserver/perl

	${INSTALL_PROGRAM} ${PREFIX}/bin/mapserv ${WRKINST}/${PREFIX-main}/cgi-bin

	echo "; Enable Mapscript extension module\nextension=php_mapscript.so" \
		> ${PREFIX}/share/examples/php-${MODPHP_VERSION}/mapscript.ini

	${INSTALL_DATA}	${WRKSRC}/mapscript/perl/examples/* \
		${PREFIX}/share/examples/mapserver/perl

.include <bsd.port.mk>
@


1.47
log
@Bugfix update to mapserver 7.0.6.

See http://mapserver.org/development/changelog/changelog-7-0.html#changelog-7-0-6
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2017/05/15 10:02:01 landry Exp $
d50 1
a50 1
WANTLIB-main =	${WANTLIB} c fcgi pthread ${LIBCXX}
@


1.46
log
@Bugfix update to mapserver 7.0.5.

See
http://mapserver.org/development/changelog/changelog-7-0.html#changelog-7-0-5
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2017/04/10 11:46:20 sthen Exp $
d10 1
a10 1
V =		7.0.5
@


1.45
log
@use LIBCXX
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2017/02/14 09:46:56 landry Exp $
d10 1
a10 1
V =		7.0.4
a16 1
REVISION-main =	0
@


1.44
log
@Fix #5387 (potential remote DOS when using fastcgi)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2017/02/07 08:17:57 landry Exp $
d51 1
a51 1
WANTLIB-main =	${WANTLIB} c fcgi pthread stdc++
@


1.43
log
@Update to mapservr 7.0.4.

See http://mapserver.org/development/changelog/changelog-7-0.html#changelog-7-0-4
Backport an upstream patch to fix php bindings build, remove a patch
merged upstream.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2016/10/31 15:47:58 landry Exp $
d17 1
@


1.42
log
@Update to mapserver 7.0.2.

See for details:
http://mapserver.org/development/changelog/changelog-7-0.html#changelog-7-0-2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2016/09/12 17:50:40 naddy Exp $
d10 1
a10 1
V =		7.0.2
@


1.41
log
@remove unused libiconv module
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2016/03/19 23:59:15 naddy Exp $
d10 1
a10 1
V =		7.0.1
a15 1
REVISION=	0
d30 1
@


1.40
log
@remove SHARED_ONLY from PHP ports, unused
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2016/03/08 20:44:39 landry Exp $
d16 1
d29 1
a29 1
MODULES=	converters/libiconv lang/php devel/cmake
@


1.39
log
@Bugfix update to mapserver 7.0.1.

See http://www.mapserver.org/development/changelog/changelog-7-0.html#changelog-7-0-1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2015/09/07 19:05:30 landry Exp $
a3 1
SHARED_ONLY=	Yes
@


1.38
log
@Update to mapserver 7.0.0.

See http://mapserver.org/development/announce/7-0.html
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2015/07/15 23:56:36 ajacoutot Exp $
d11 1
a11 1
V =		7.0.0
@


1.37
log
@Fix pexp.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2015/06/06 09:03:16 kili Exp $
d11 1
a11 1
V =		6.4.1
d17 1
a17 3
SHARED_LIBS +=	mapserver 1.0
REVISION-main =	1
REVISION-php=	1
d37 1
d45 1
a45 1
WANTLIB += gdal geos_c cairo fribidi gif
@


1.36
log
@Bump REVISION-php for real, and replace REVISION by REVISION-main.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2015/06/05 05:58:34 robert Exp $
d18 1
a18 1
REVISION-main =	0
@


1.35
log
@unbreak build with php-5.6
ok aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2014/11/06 17:13:39 sthen Exp $
a11 1
REVISION =	0
d18 2
a19 1
REVISION-php=	0
@


1.34
log
@bump REVISION for php version switch
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2014/05/18 09:29:50 landry Exp $
d19 1
@


1.33
log
@Bugfix update to mapserver 6.4.1.

Adapt README's for nginx, and provide an rc script using spawn-fcgi.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2014/01/10 14:47:09 dcoppa Exp $
d12 1
@


1.32
log
@Fix build with newer FreeType for cmake-based ports
OK naddy@@, landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2013/12/30 18:06:43 landry Exp $
d11 1
a11 1
V =		6.4.0
d32 1
d64 1
a64 1
SUBST_VARS+=	PREFIX-main
@


1.31
log
@Add postgresql,-server to BDEP, CMake's FindPostgreSQL.cmake looks for
catalog/pg_type.h which isn't in the main subpackage. Breakage reported
by naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2013/12/25 21:55:57 landry Exp $
d66 1
a66 1
	rm -f ${WRKSRC}/cmake/Find{PostgreSQL,ICONV}.cmake
@


1.30
log
@Update to mapserver 6.4.0.

Upstream switched to cmake, but apparently things still magically work.
Slightly tested the cgi & perl examples.
http://mapserver.org/development/announce/6-4.html#announce-6-4
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2013/09/25 07:56:58 sthen Exp $
d32 1
a32 1
BUILD_DEPENDS +=	devel/swig
@


1.29
log
@libungif->giflib and patch where necessary, ok jasper@@ aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2013/08/12 04:11:20 robert Exp $
d11 1
a11 1
V =		6.2.1
d17 1
a17 3
SHARED_LIBS +=	mapserver 0.0# 0.0
REVISION-php =	0
REVISION-main =	0
d29 1
a29 1
MODULES=	devel/gettext lang/php
d31 2
d35 1
a38 1
		graphics/gd \
d42 2
a43 1
RUN_DEPENDS-php=	${MODPHP_RUN_DEPENDS}
d45 15
a59 45
WANTLIB += crypto curl expat freetype idn jpeg m png pq ssl xml2 z proj
WANTLIB += gdal geos_c stdc++ cairo fontconfig gd tiff spatialite
WANTLIB += pixman-1 pthread-stubs xcb xcb-render xcb-shm sqlite3
WANTLIB += X11 Xext Xrender freexl geos geotiff gif jasper pcre

LIB_DEPENDS-utils = STEM->=${V}:${BUILD_PKGPATH},-main
LIB_DEPENDS-php = STEM->=${V}:${BUILD_PKGPATH},-main
LIB_DEPENDS-perl = STEM->=${V}:${BUILD_PKGPATH},-main
WANTLIB-main=	${WANTLIB} fcgi pthread c gif
WANTLIB-main += asn1 com_err heimbase krb5 roken wind
WANTLIB-utils=	${WANTLIB} mapserver pthread c gif
WANTLIB-php=	${WANTLIB} mapserver pthread
WANTLIB-perl=	mapserver

USE_GMAKE=	yes
USE_LIBTOOL =	yes
LIBTOOL_FLAGS =	--tag=disable-static
CONFIGURE_STYLE=gnu
CONFIGURE_ARGS=	--with-proj=${LOCALBASE} \
		--with-png=${LOCALBASE} \
		--with-fastcgi=${LOCALBASE} \
		--with-freetype=${X11BASE}/bin \
		--with-gdal=${LOCALBASE}/bin/gdal-config \
		--with-gd=${LOCALBASE}/bin/gdlib-config \
		--with-php=${LOCALBASE}/bin/php-config-${MODPHP_VERSION} \
		--with-postgis=${LOCALBASE}/bin/pg_config \
		--with-geos=${LOCALBASE}/bin/geos-config \
		--with-ogr=${LOCALBASE}/bin/gdal-config \
		--with-xml2-config=${LOCALBASE}/bin/xml2-config \
		--with-curl-config=${LOCALBASE}/bin/curl-config \
		--with-cairo \
		--with-kml \
		--with-wmsclient \
		--with-wfsclient \
		--with-wcs \
		--with-wfs \
		--with-sos

CONFIGURE_ENV=	CPPFLAGS="-I${LOCALBASE}/include" \
		LDFLAGS="-L${LOCALBASE}/lib -pthread"

MAKE_ENV=	CFLAGS+=-fPIC

UTILS=	shp2img legend shptree shptreevis shptreetst scalebar \
	sortshp tile4ms msencrypt
d65 2
a66 2
post-build:
	cd ${WRKSRC}/mapscript/perl && perl Makefile.PL && ${MAKE}
a79 2

	cd ${WRKSRC}/mapscript/perl && ${MAKE} install
@


1.28
log
@bump REVISION due to the php update
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2013/08/06 19:47:17 landry Exp $
d19 1
d39 1
@


1.27
log
@Update to mapserver 6.2.1.

See http://mapserver.org/development/announce/6-2.html for a list of new
features in the 6.2 branch.

- Uses its own local copy of agg (as mapnik..)
- now uses libtool and installs a library. Adapt chroot setups as needed.
- provides an install target, so install perl examples and mapscript.ini
  in post-install.
- dont install php examples, they're badly outdated
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2013/07/05 07:23:33 jasper Exp $
d18 1
@


1.26
log
@use ${VARBASE} instead of hardcoding /var
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2013/03/11 11:07:42 espie Exp $
d11 1
a11 3
V =		6.0.2
REVISION-perl=	0
REVISION-php=	1
d17 1
a31 2
BUILD_DEPENDS=	graphics/agg

d42 12
a53 9
WANTLIB += gdal geos_c gd stdc++ fcgi
WANTLIB += GL X11
WANTLIB += cairo Xrender fontconfig glib-2.0 gobject-2.0 gthread-2.0
WANTLIB += pixman-1 pthread-stubs xcb xcb-render xcb-shm

WANTLIB-main=	${WANTLIB} pthread c gif
WANTLIB-utils=	${WANTLIB} pthread c gif
WANTLIB-php=	${WANTLIB} c pthread
WANTLIB-perl=	${WANTLIB} c gif
d56 2
a60 1
		--with-agg=${LOCALBASE} \
a61 1
		--without-pdf \
d64 2
a65 1
		--with-php=${LOCALBASE}/share/php-${MODPHP_VERSION}/include \
d94 1
a94 1
do-install:
a95 1
	${INSTALL_DATA_DIR} ${PREFIX}/lib/php-${MODPHP_VERSION}/modules
a96 1
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/mapserver/php
d99 3
a101 4
	${INSTALL_PROGRAM} ${WRKSRC}/mapserv ${WRKINST}/${PREFIX-main}/cgi-bin
	${INSTALL_DATA} ${WRKSRC}/mapscript/php/php_mapscript.so \
		${PREFIX}/lib/php-${MODPHP_VERSION}/modules/mapscript.so
	echo "; Enable Mapscript extension module\nextension=mapscript.so" \
d103 1
a103 6
.for i in ${UTILS}
	${INSTALL_PROGRAM} ${WRKSRC}/${i} ${PREFIX}/bin/
.endfor
	${INSTALL_SCRIPT} ${WRKSRC}/mapserver-config ${PREFIX}/bin/
	${INSTALL_DATA}	${WRKSRC}/mapscript/php/examples/* \
		${PREFIX}/share/examples/mapserver/php
d106 1
@


1.25
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2012/08/24 08:29:27 ajacoutot Exp $
d86 1
a86 1
PREFIX-main=	/var/www
@


1.24
log
@No need to LD_PRELOAD libpthread anymore now that Apache is linked with
pthreads(3).

discussed with sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2012/08/23 15:50:05 sthen Exp $
a24 3
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
@


1.23
log
@sync wantlib
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2012/02/16 21:21:58 sthen Exp $
d13 1
a13 1
REVISION-php=	0
@


1.22
log
@update to mapserver 6.0.2, SECURITY and other fixes, ok landry@@
http://lists.osgeo.org/pipermail/mapserver-users/2012-February/071476.html
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2012/01/24 12:03:19 sthen Exp $
d12 2
d55 2
a56 2
WANTLIB-php=	${WANTLIB}
WANTLIB-perl=	${WANTLIB} gif
@


1.21
log
@move MESSAGE-* to README-*, suggested by / ok landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2012/01/24 09:21:30 sthen Exp $
d11 1
a11 1
V =		6.0.1
a13 1
REVISION-main = 3
a14 1
REVISION-utils = 2
a15 1
REVISION-php =	7
a16 1
REVISION-perl = 2
@


1.20
log
@enable fastcgi support for mapserv, ok landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2011/11/16 15:56:37 robert Exp $
d14 1
a14 1
REVISION-main = 2
d18 1
a18 1
REVISION-php =	6
@


1.19
log
@php-mapscript requires libpthread to be preloaded otherwise httpd silently
exits at startup; show some sample login.conf lines in MESSAGE.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2011/12/08 22:40:15 sthen Exp $
d14 1
a14 1
REVISION-main = 1
d16 1
a16 1
REVISION-utils = 1
d18 1
a18 1
REVISION-php =	5
d20 1
a20 1
REVISION-perl = 1
d44 2
a45 1
		graphics/gd
d50 1
a50 1
WANTLIB += gdal geos_c gd stdc++
d65 1
@


1.18
log
@fix example symlink command-line.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2011/11/16 15:56:37 robert Exp $
d18 1
a18 1
REVISION-php =	4
@


1.17
log
@switch php to version 5.3 by default
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2011/11/03 17:35:12 jasper Exp $
d18 1
a18 1
REVISION-php =	3
@


1.16
log
@- regen WANTLIB
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2011/10/16 16:03:26 ajacoutot Exp $
d18 1
a18 1
REVISION-php =	2
@


1.15
log
@php5->php.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2011/09/16 09:48:10 espie Exp $
d14 1
a14 1
REVISION-main = 0
d16 1
a16 1
REVISION-utils = 0
d18 1
a18 1
REVISION-php =	1
d20 1
a20 1
REVISION-perl = 0
d50 2
a51 2
WANTLIB += GL X11 Xau Xdamage Xdmcp Xext Xfixes Xrender Xxf86vm
WANTLIB += cairo drm fontconfig glib-2.0 gobject-2.0 gthread-2.0
@


1.14
log
@normalize pkgpath
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2011/07/28 08:35:34 jasper Exp $
d17 2
a18 2
PKGNAME-php=	php5-mapscript-${V}
REVISION-php =	0
d91 1
a91 1
SUBST_VARS+=	PREFIX-php PREFIX-main
@


1.13
log
@- Security update to 6.0.1, fixes CVE-2011-2703, MapServer SQL Injection Vulnerabilities

ok landry@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2011/07/09 01:14:47 robert Exp $
d14 1
d16 1
d18 1
d20 1
@


1.12
log
@switch to lang/php
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2011/07/06 23:56:08 ajacoutot Exp $
d11 1
a11 1
V =		6.0.0
a16 5

REVISION-main=	1
REVISION-utils=	1
REVISION-php=	1
REVISION-perl=	1
@


1.11
log
@Use the libiconv|gettext MODULE.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2011/06/22 20:16:43 landry Exp $
d18 4
a21 4
REVISION-main=	0
REVISION-utils=	0
REVISION-php=	0
REVISION-perl=	0
d36 2
a37 1
MODULES=	devel/gettext
d39 1
a39 2
BUILD_DEPENDS=	www/php5/core \
		graphics/agg
d47 1
a47 2
RUN_DEPENDS-php=	www/php5/core

d68 1
a68 1
		--with-php=${LOCALBASE}/share/php5/include \
a90 1
PREFIX-php=	/var/www
d99 2
a100 2
	${INSTALL_DATA_DIR} ${WRKINST}/${PREFIX-php}/lib/php/modules
	${INSTALL_DATA_DIR} ${DESTDIR}/${PREFIX-php}/conf/php5.sample
d106 1
a106 1
		${WRKINST}/${PREFIX-php}/lib/php/modules/mapscript.so
d108 1
a108 1
		> ${WRKINST}/${PREFIX-php}/conf/php5.sample/mapscript.ini
@


1.10
log
@Update to mapserver 6.0.0, loosely based on a diff from wen heping.

- enable cairo & kml output backend, don't enable OpenGL yet.
- remove native tiff support now provided by gdal
- shuffle deps, fix WANTLIB
See http://mapserver.org/development/announce/6-0.html for a list of
goodies.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2011/01/11 09:47:55 landry Exp $
d18 5
d36 2
d50 2
a51 3
WANTLIB=	crypto curl expat freetype iconv idn jpeg \
		m png pq ssl xml2 z proj gdal geos_c gd stdc++

d54 1
a54 1
WANTLIB += intl pixman-1 pthread-stubs xcb xcb-render xcb-shm
@


1.9
log
@Add fix for http://trac.osgeo.org/mapserver/ticket/3525.
Don't return invalid when EXCEPTION param is not passed in WMS 1.3.0.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2010/11/21 09:32:57 landry Exp $
d11 1
a11 1
V =		5.6.5
a16 2
REVISION-main=	1
REVISION-utils=	0
d35 1
a37 1
		devel/geotiff \
d42 12
a53 8
WANTLIB=	crypto curl expat freetype gif iconv idn jasper jpeg \
		com_err readline termcap m png pq ssl tiff xml2 z \
		proj gdal geos_c geotiff gd

WANTLIB-main=	${WANTLIB} pthread c stdc++
WANTLIB-utils=	${WANTLIB} pthread c stdc++
WANTLIB-php=	${WANTLIB} stdc++
WANTLIB-perl=	${WANTLIB} stdc++
a60 1
		--with-tiff=${LOCALBASE} \
d69 2
d82 1
a82 1
UTILS=	shp2img shp2pdf legend shptree shptreevis shptreetst scalebar \
d101 1
a101 1
	${INSTALL_DATA} ${WRKSRC}/mapscript/php3/php_mapscript.so \
d109 1
a109 1
	${INSTALL_DATA}	${WRKSRC}/mapscript/php3/examples/* \
@


1.8
log
@Fix after proj update: add -pthread to LDFLAGS and WANTLIB-{main,utils}.
Bump corresponding REVISIONs.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2010/11/17 08:05:12 espie Exp $
d17 1
a17 1
REVISION-main=	0
@


1.7
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2010/07/27 08:57:38 landry Exp $
d17 2
d48 2
a49 2
WANTLIB-main=	${WANTLIB} c stdc++
WANTLIB-utils=	${WANTLIB} c stdc++
d75 1
a75 1
		LDFLAGS="-L${LOCALBASE}/lib"
@


1.6
log
@Bugfix update to mapserver 5.6.5, see for changes:
http://lists.osgeo.org/pipermail/mapserver-users/2010-July/066134.html

- enable agg support (because it's _really_ nicer than gd output)
- switch to newer lib_depends
- tweak do-install to use ${INSTALL_SCRIPT} for mapserver-config
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2010/04/02 09:45:04 landry Exp $
d31 2
a32 2
BUILD_DEPENDS=	:php5-core-*:www/php5/core \
		::graphics/agg
d34 5
a38 5
LIB_DEPENDS=	::devel/proj \
		::geo/gdal \
		::geo/geos \
		::devel/geotiff \
		::graphics/gd
d40 1
a40 1
RUN_DEPENDS-php=	:php5-core-*:www/php5/core
@


1.5
log
@Update to mapserver 5.6.3, fixes regressions introduced in 5.6.2, see
http://lists.osgeo.org/pipermail/mapserver-users/2010-March/064997.html
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2010/03/22 20:28:37 landry Exp $
d11 1
a11 1
V =		5.6.3
d27 1
a27 1
MAINTAINER=	Landry Breuil <gaston@@gcu.info>
d31 2
a32 1
BUILD_DEPENDS=	:php5-core-*:www/php5/core
d34 5
a38 5
LIB_DEPENDS=	proj::devel/proj \
		gdal::geo/gdal \
		geos_c::geo/geos \
		geotiff::devel/geotiff \
		gd::graphics/gd
d43 2
a44 1
		com_err readline termcap m png pq ssl tiff xml2 z
d48 2
d55 1
d78 1
a78 1
	sortshp tile4ms msencrypt mapserver-config
d103 1
@


1.4
log
@Update to mapserver 5.6.2, bugfix release. See here for details :
http://trac.osgeo.org/mapserver/browser/tags/rel-5-6-2/mapserver/HISTORY.TXT
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2009/12/24 21:59:19 landry Exp $
d11 1
a11 1
V =		5.6.2
@


1.3
log
@Update to mapserver 5.6.0, see http://www.osgeo.org/node/984 for
details.
Looks good to & 'go ahead' jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2009/10/29 19:34:12 landry Exp $
d11 1
a11 1
V =		5.6.0
@


1.2
log
@Update to mapserver 5.4.2, backport a patch to fix
http://trac.osgeo.org/mapserver/ticket/2578, sanitize PREFIX & MESSAGE
wrt / maze.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2009/06/04 17:55:39 landry Exp $
d11 1
a11 1
V =		5.4.2
a33 1
		agg,aggfontfreetype::graphics/agg \
d42 1
a42 1
		m png pq ssl tiff xml2 z
d50 1
a50 1
		--with-agg=${LOCALBASE} \
d69 2
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d11 2
a12 1
DISTNAME=	mapserver-5.4.0
d14 3
a16 3
PKGNAME-utils=	mapserver-utils-5.4.0
PKGNAME-php=	php5-mapscript-5.4.0
PKGNAME-perl=	p5-mapscript-5.4.0
d74 2
a75 2
PREFIX-main=	/var/www/
PREFIX-php=	/var/www/
@


1.1.1.1
log
@Import mapserver 5.4.0:
MapServer is a system for developing web-based GIS applications.
The basic system consists of a CGI program that can be configured to
respond to a variety of spatial requests like making maps, scalebars,
and point, area and feature queries.
This port is splitted in 4 packages: -main contains the mapserv CGI,
-php contains the PHP Mapscript extension, -perl contains Mapscript perl
bindings and -utils contains various utilities and examples of use.
ok ajacoutot@@
@
text
@@
