head	1.3;
access;
symbols
	OPENBSD_6_1:1.3.0.14
	OPENBSD_6_1_BASE:1.3
	OPENBSD_6_0:1.3.0.12
	OPENBSD_6_0_BASE:1.3
	OPENBSD_5_9:1.3.0.8
	OPENBSD_5_9_BASE:1.3
	OPENBSD_5_8:1.3.0.10
	OPENBSD_5_8_BASE:1.3
	OPENBSD_5_7:1.3.0.6
	OPENBSD_5_7_BASE:1.3
	OPENBSD_5_6:1.3.0.4
	OPENBSD_5_6_BASE:1.3
	OPENBSD_5_5:1.3.0.2
	OPENBSD_5_5_BASE:1.3;
locks; strict;
comment	@# @;


1.3
date	2013.12.06.11.28.16;	author jca;	state Exp;
branches;
next	1.2;

1.2
date	2001.09.30.19.08.58;	author naddy;	state dead;
branches;
next	1.1;

1.1
date	2001.09.11.00.18.45;	author brad;	state Exp;
branches;
next	;


desc
@@


1.3
log
@Don't include <sys/timeb.H>
@
text
@$OpenBSD$
--- ckufio.c.orig	Thu Dec  5 23:31:16 2013
+++ ckufio.c	Thu Dec  5 23:33:03 2013
@@@@ -206,7 +206,6 @@@@ extern int eofmethod;
 #define TIMESTAMP                       /* Can do file dates */
 #endif /* TIMESTAMP */
 #include <sys/time.h>
-#include <sys/timeb.h>
 
 #else  /* Not BSD44 */
 
@


1.2
log
@update to 7.0.197; install fragment from FreeBSD
@
text
@d1 11
a11 24
$OpenBSD: patch-ckufio_c,v 1.1 2001/09/11 00:18:45 brad Exp $
--- ckufio.c.orig	Sun Nov 24 19:20:49 1996
+++ ckufio.c	Mon Sep 10 19:30:54 2001
@@@@ -2959,11 +2959,15 @@@@ struct utimbuf tp;
 	    }
 	    tmx += n;
 	}
-	time_stamp = localtime(&tmx);
-	if (!time_stamp)
-	  return(-1);
-	if (localtime(&tmx)->tm_isdst)
-	  tmx -= 60L * 60L;		/* Adjust for daylight savings time */
+	{
+	    time_t t = tmx;
+
+	    time_stamp = localtime(&t);
+	    if (!time_stamp)
+	      return(-1);
+	    if (localtime(&t)->tm_isdst)
+	      tmx -= 60L * 60L;		/* Adjust for daylight savings time */
+	}
     }
     return(tmx);
 }
@


1.1
log
@rename patches and use unified diffs
@
text
@d1 1
a1 1
$OpenBSD$
@

