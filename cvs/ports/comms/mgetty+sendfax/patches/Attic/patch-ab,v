head	1.5;
access;
symbols
	OPENBSD_3_8:1.4.0.26
	OPENBSD_3_8_BASE:1.4
	OPENBSD_3_7:1.4.0.24
	OPENBSD_3_7_BASE:1.4
	OPENBSD_3_6:1.4.0.22
	OPENBSD_3_6_BASE:1.4
	OPENBSD_3_5:1.4.0.20
	OPENBSD_3_5_BASE:1.4
	OPENBSD_3_4:1.4.0.18
	OPENBSD_3_4_BASE:1.4
	OPENBSD_3_3:1.4.0.16
	OPENBSD_3_3_BASE:1.4
	OPENBSD_3_2:1.4.0.14
	OPENBSD_3_2_BASE:1.4
	OPENBSD_3_1:1.4.0.12
	OPENBSD_3_1_BASE:1.4
	OPENBSD_3_0:1.4.0.10
	OPENBSD_3_0_BASE:1.4
	OPENBSD_2_9_TRACKING_SWITCH:1.4
	OPENBSD_2_9:1.4.0.8
	OPENBSD_2_9_BASE:1.4
	OPENBSD_2_8:1.4.0.6
	OPENBSD_2_8_BASE:1.4
	OPENBSD_2_7:1.4.0.4
	OPENBSD_2_7_BASE:1.4
	OPENBSD_2_6:1.4.0.2
	OPENBSD_2_6_BASE:1.4
	OPENBSD_2_5:1.3.0.2
	OPENBSD_2_5_BASE:1.3
	OPENBSD_2_4:1.2.0.2
	OPENBSD_2_4_BASE:1.2
	form_980504:1.1.1.1
	form:1.1.1;
locks; strict;
comment	@# @;


1.5
date	2005.09.25.18.18.23;	author aanriot;	state dead;
branches;
next	1.4;

1.4
date	99.08.28.18.13.37;	author brad;	state Exp;
branches;
next	1.3;

1.3
date	98.12.18.02.55.46;	author form;	state Exp;
branches;
next	1.2;

1.2
date	98.08.28.06.11.54;	author marc;	state Exp;
branches;
next	1.1;

1.1
date	98.05.04.05.22.02;	author form;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	98.05.04.05.22.02;	author form;	state Exp;
branches;
next	;


desc
@@


1.5
log
@update to 1.1.33. It's no longer broken, as the temporary files issue
has gone away.

from Antoine Jacoutot <ajacoutot@@lphp.org>;
ok alek@@ brad@@
@
text
@--- Makefile.orig	Sat Jul 24 17:28:18 1999
+++ Makefile	Sat Aug 28 13:30:15 1999
@@@@ -4,8 +4,8 @@@@
 #
 # this is the C compiler to use (on SunOS, the standard "cc" does not
 # grok my code, so please use gcc there. On ISC 4.0, use "icc".).
-CC=gcc
-#CC=cc
+#CC=gcc
+CC=cc
 #
 #### C Compiler Flags ####
 #
@@@@ -107,7 +107,7 @@@@
 # prompt first. Don't forget to activate the /AutoPPP/ line in login.config!
 #
 #CFLAGS=-Wall -O2 -pipe -DSECUREWARE -DUSE_POLL
-CFLAGS=-O2 -Wall -pipe
+CFLAGS+=-DAUTO_PPP
 #CFLAGS=-O -DSVR4
 #CFLAGS=-O -DSVR4 -DSVR42
 #CFLAGS=-O -DUSE_POLL
@@@@ -144,12 +144,12 @@@@
 #
 # On SCO Xenix, add -ldir -lx
 #
-# For FreeBSD, add "-lutil" if the linker complains about
+# For FreeBSD and OpenBSD, add "-lutil" if the linker complains about
 # 	"utmp.o: unresolved symbod _login"
 # For Linux, add "-lutil" if the linker complains about "updwtmp".
 #
 LDFLAGS=
-LIBS=
+LIBS=-lutil
 #LIBS=-lprot -lsocket				# SCO Unix
 #LIBS=-lsocket
 #LIBS=-lbsd					# OSF/1
@@@@ -169,7 +169,8 @@@@
 #
 # if your systems doesn't have one, use the shell script that I provide
 # in "inst.sh" (taken from X11R5). Needed on IRIX5.2
-INSTALL=install -c -o bin -g bin
+INSTALL=install -c -o root -g wheel
+INSTALL_PROGRAM=install -s -c -o root -g wheel
 #INSTALL=install -c -o root -g wheel		# NeXT/BSD
 #INSTALL=/usr/ucb/install -c -o bin -g bin	# AIX, Solaris 2.x
 #INSTALL=installbsd -c -o bin -g bin		# OSF/1, AIX 4.1, 4.2
@@@@ -177,11 +178,11 @@@@
 #
 # prefix, where most (all?) of the stuff lives, usually /usr/local or /usr
 #
-prefix=/usr/local
+prefix?=/usr/local
 #
 # prefix for all the spool directories (usually /usr/spool or /var/spool)
 #
-spool=/var/spool
+spool?=/var/spool
 #
 # where the mgetty + sendfax binaries live (used for "make install")
 #
@@@@ -197,7 +198,7 @@@@
 #
 # where the configuration files (*.config, aliases, fax.allow/deny) go to
 #
-CONFDIR=$(prefix)/etc/mgetty+sendfax
+CONFDIR?=$(prefix)/etc/mgetty+sendfax
 #CONFDIR=/etc/default/
 #
 #
@@@@ -247,7 +248,7 @@@@
 # If you have Perl with TK extentions, define it here. This may be the
 # same as PERL=... above, or different, if you have TkPerl statically
 # linked.
-TKPERL=/usr/bin/tkperl
+#TKPERL=/usr/bin/tkperl
 #
 #
 # An echo program that understands escapes like "\n" for newline or
@@@@ -259,9 +260,9 @@@@
 # please use the "mg.echo" program provided in the compat/ subdirectory.
 # Set ECHO="mg.echo" and INSTALL_MECHO to mg.echo
 #
-ECHO="echo"
+ECHO="mg.echo"
 #
-# INSTALL_MECHO=mg.echo
+INSTALL_MECHO=mg.echo
 
 #
 # for mgetty, that's it. If you want to use the voice
@@@@ -269,8 +270,8 @@@@
 
 # To maintain security, I recommend creating a new group for
 # users who are allowed to manipulate the recorded voice messages.
-PHONE_GROUP=phone
-PHONE_PERMS=770
+PHONE_GROUP?=wheel
+PHONE_PERMS?=700
 
 # Add -DNO_STRSTR to CFLAGS if you don't have strstr().
 
@@@@ -301,7 +302,7 @@@@
 
 all:	bin-all doc-all
 
-bin-all: mgetty sendfax newslock subdirs call-back 
+bin-all: mgetty sendfax newslock subdirs call-back vgetty
 
 # a few C files need extra compiler arguments
 
@@@@ -563,21 +564,21 @@@@
 	cd bindist; gtar cvvfz mgetty$(MR).$(SR)-bin.tgz *
 
 
-install: install.bin install.doc
+install: install.bin install.doc install-vgetty
 
 install.bin: mgetty sendfax newslock \
-		login.config mgetty.config sendfax.config 
+		login.config #mgetty.config sendfax.config 
 #
 # binaries
 #
 	-test -d $(BINDIR)  || ( ./mkidirs $(BINDIR)  ; chmod 755 $(BINDIR)  )
-	$(INSTALL) -m 755 newslock $(BINDIR)
+	$(INSTALL_PROGRAM) -m 755 newslock $(BINDIR)
 
 	-test -d $(SBINDIR) || ( ./mkidirs $(SBINDIR) ; chmod 755 $(SBINDIR) )
 	-mv -f $(SBINDIR)/mgetty $(SBINDIR)/mgetty.old
 	-mv -f $(SBINDIR)/sendfax $(SBINDIR)/sendfax.old
-	$(INSTALL) -s -m 700 mgetty $(SBINDIR)
-	$(INSTALL) -s -m 700 sendfax $(SBINDIR)
+	$(INSTALL_PROGRAM) -m 700 mgetty $(SBINDIR)
+	$(INSTALL_PROGRAM) -m 700 sendfax $(SBINDIR)
 #
 # data files + directories
 #
@@@@ -587,10 +588,10 @@@@
 		( ./mkidirs $(CONFDIR); chmod 755 $(CONFDIR))
 	test -f $(CONFDIR)/login.config || \
 		$(INSTALL) -o root -m 600 login.config $(CONFDIR)/
-	test -f $(CONFDIR)/mgetty.config || \
-		$(INSTALL) -o root -m 600 mgetty.config $(CONFDIR)/
-	test -f $(CONFDIR)/sendfax.config || \
-		$(INSTALL) -o root -m 644 sendfax.config $(CONFDIR)/
+#	test -f $(CONFDIR)/mgetty.config || \
+#		$(INSTALL) -o root -m 600 mgetty.config $(CONFDIR)/
+#	test -f $(CONFDIR)/sendfax.config || \
+#		$(INSTALL) -o root -m 644 sendfax.config $(CONFDIR)/
 	test -f $(CONFDIR)/dialin.config || \
 		$(INSTALL) -o root -m 600 dialin.config $(CONFDIR)/
 	test -f $(CONFDIR)/faxrunq.config || \
@@@@ -621,7 +622,7 @@@@
 #
 # g3 tool programs
 #
-	cd g3 ; $(MAKE) install INSTALL="$(INSTALL)" \
+	cd g3 ; $(MAKE) install INSTALL="$(INSTALL_PROGRAM)" \
 				BINDIR=$(BINDIR) \
 				LIBDIR=$(LIBDIR) CONFDIR=$(CONFDIR)
 #
@@@@ -636,7 +637,7 @@@@
 	if [ ! -z "$(INSTALL_MECHO)" ] ; then \
 	    cd compat ; \
 	    $(CC) $(CFLAGS) -o mg.echo mg.echo.c && \
-	    $(INSTALL) -s -m 755 mg.echo $(BINDIR) ; \
+	    $(INSTALL_PROGRAM) -m 755 mg.echo $(BINDIR) ; \
 	fi
 
 #
@


1.4
log
@upgrade to mgetty+sendfax 1.1.21
@
text
@@


1.3
log
@update to 1.1.9, make port non-interactive.
@
text
@d1 171
a171 301
*** Makefile.orig	Sun Nov 22 05:19:06 1998
--- Makefile	Thu Dec 17 06:29:46 1998
***************
*** 4,11 ****
  #
  # this is the C compiler to use (on SunOS, the standard "cc" does not
  # grok my code, so please use gcc there. On ISC 4.0, use "icc".).
! CC=gcc
! #CC=cc
  #
  #### C Compiler Flags ####
  #
--- 4,11 ----
  #
  # this is the C compiler to use (on SunOS, the standard "cc" does not
  # grok my code, so please use gcc there. On ISC 4.0, use "icc".).
! #CC=gcc
! CC=cc
  #
  #### C Compiler Flags ####
  #
***************
*** 107,113 ****
  # prompt first. Don't forget to activate the /AutoPPP/ line in login.config!
  #
  #CFLAGS=-Wall -O2 -pipe -DSECUREWARE -DUSE_POLL
! CFLAGS=-O2 -Wall -pipe
  #CFLAGS=-O -DSVR4
  #CFLAGS=-O -DSVR4 -DSVR42
  #CFLAGS=-O -DUSE_POLL
--- 107,113 ----
  # prompt first. Don't forget to activate the /AutoPPP/ line in login.config!
  #
  #CFLAGS=-Wall -O2 -pipe -DSECUREWARE -DUSE_POLL
! CFLAGS+=-DAUTO_PPP
  #CFLAGS=-O -DSVR4
  #CFLAGS=-O -DSVR4 -DSVR42
  #CFLAGS=-O -DUSE_POLL
***************
*** 144,155 ****
  #
  # On SCO Xenix, add -ldir -lx
  #
! # For FreeBSD, add "-lutil" if the linker complains about
  # 	"utmp.o: unresolved symbod _login"
  # For Linux, add "-lutil" if the linker complains about "updwtmp".
  #
  LDFLAGS=
! LIBS=
  #LIBS=-lprot -lsocket				# SCO Unix
  #LIBS=-lsocket
  #LIBS=-lbsd					# OSF/1
--- 144,155 ----
  #
  # On SCO Xenix, add -ldir -lx
  #
! # For FreeBSD and OpenBSD, add "-lutil" if the linker complains about
  # 	"utmp.o: unresolved symbod _login"
  # For Linux, add "-lutil" if the linker complains about "updwtmp".
  #
  LDFLAGS=
! LIBS=-lutil
  #LIBS=-lprot -lsocket				# SCO Unix
  #LIBS=-lsocket
  #LIBS=-lbsd					# OSF/1
***************
*** 169,175 ****
  #
  # if your systems doesn't have one, use the shell script that I provide
  # in "inst.sh" (taken from X11R5). Needed on IRIX5.2
! INSTALL=install -c -o bin -g bin
  #INSTALL=install -c -o root -g wheel		# NeXT/BSD
  #INSTALL=/usr/ucb/install -c -o bin -g bin	# AIX, Solaris 2.x
  #INSTALL=installbsd -c -o bin -g bin		# OSF/1, AIX 4.1, 4.2
--- 169,176 ----
  #
  # if your systems doesn't have one, use the shell script that I provide
  # in "inst.sh" (taken from X11R5). Needed on IRIX5.2
! INSTALL=install -c -o root -g wheel
! INSTALL_PROGRAM=install -s -c -o root -g wheel
  #INSTALL=install -c -o root -g wheel		# NeXT/BSD
  #INSTALL=/usr/ucb/install -c -o bin -g bin	# AIX, Solaris 2.x
  #INSTALL=installbsd -c -o bin -g bin		# OSF/1, AIX 4.1, 4.2
***************
*** 177,187 ****
  #
  # prefix, where most (all?) of the stuff lives, usually /usr/local or /usr
  #
! prefix=/usr/local
  #
  # prefix for all the spool directories (usually /usr/spool or /var/spool)
  #
! spool=/var/spool
  #
  # where the mgetty + sendfax binaries live (used for "make install")
  #
--- 178,188 ----
  #
  # prefix, where most (all?) of the stuff lives, usually /usr/local or /usr
  #
! prefix?=/usr/local
  #
  # prefix for all the spool directories (usually /usr/spool or /var/spool)
  #
! spool?=/var/spool
  #
  # where the mgetty + sendfax binaries live (used for "make install")
  #
***************
*** 197,203 ****
  #
  # where the configuration files (*.config, aliases, fax.allow/deny) go to
  #
! CONFDIR=$(prefix)/etc/mgetty+sendfax
  #CONFDIR=/etc/default/
  #
  #
--- 198,204 ----
  #
  # where the configuration files (*.config, aliases, fax.allow/deny) go to
  #
! CONFDIR?=$(prefix)/etc/mgetty+sendfax
  #CONFDIR=/etc/default/
  #
  #
***************
*** 247,253 ****
  # If you have Perl with TK extentions, define it here. This may be the
  # same as PERL=... above, or different, if you have TkPerl statically
  # linked.
! TKPERL=/usr/bin/tkperl
  #
  #
  # An echo program that understands escapes like "\n" for newline or
--- 248,254 ----
  # If you have Perl with TK extentions, define it here. This may be the
  # same as PERL=... above, or different, if you have TkPerl statically
  # linked.
! #TKPERL=/usr/bin/tkperl
  #
  #
  # An echo program that understands escapes like "\n" for newline or
***************
*** 259,267 ****
  # please use the "mg.echo" program provided in the compat/ subdirectory.
  # Set ECHO="mg.echo" and INSTALL_MECHO to mg.echo
  #
! ECHO="echo"
  #
! # INSTALL_MECHO=mg.echo
  
  #
  # for mgetty, that's it. If you want to use the voice
--- 260,268 ----
  # please use the "mg.echo" program provided in the compat/ subdirectory.
  # Set ECHO="mg.echo" and INSTALL_MECHO to mg.echo
  #
! ECHO="mg.echo"
  #
! INSTALL_MECHO=mg.echo
  
  #
  # for mgetty, that's it. If you want to use the voice
***************
*** 269,276 ****
  
  # To maintain security, I recommend creating a new group for
  # users who are allowed to manipulate the recorded voice messages.
! PHONE_GROUP=phone
! PHONE_PERMS=770
  
  # Add -DNO_STRSTR to CFLAGS if you don't have strstr().
  
--- 270,277 ----
  
  # To maintain security, I recommend creating a new group for
  # users who are allowed to manipulate the recorded voice messages.
! PHONE_GROUP?=wheel
! PHONE_PERMS?=700
  
  # Add -DNO_STRSTR to CFLAGS if you don't have strstr().
  
***************
*** 301,307 ****
  
  all:	bin-all doc-all
  
! bin-all: mgetty sendfax newslock subdirs call-back 
  
  # a few C files need extra compiler arguments
  
--- 302,308 ----
  
  all:	bin-all doc-all
  
! bin-all: mgetty sendfax newslock subdirs call-back vgetty
  
  # a few C files need extra compiler arguments
  
***************
*** 560,580 ****
  	cd bindist; gtar cvvfz mgetty$(MR).$(SR)-bin.tgz *
  
  
! install: install.bin install.doc
  
  install.bin: mgetty sendfax newslock \
! 		login.config mgetty.config sendfax.config 
  #
  # binaries
  #
  	-test -d $(BINDIR)  || ( ./mkidirs $(BINDIR)  ; chmod 755 $(BINDIR)  )
! 	$(INSTALL) -m 755 newslock $(BINDIR)
  
  	-test -d $(SBINDIR) || ( ./mkidirs $(SBINDIR) ; chmod 755 $(SBINDIR) )
  	-mv -f $(SBINDIR)/mgetty $(SBINDIR)/mgetty.old
  	-mv -f $(SBINDIR)/sendfax $(SBINDIR)/sendfax.old
! 	$(INSTALL) -s -m 700 mgetty $(SBINDIR)
! 	$(INSTALL) -s -m 700 sendfax $(SBINDIR)
  #
  # data files + directories
  #
--- 561,581 ----
  	cd bindist; gtar cvvfz mgetty$(MR).$(SR)-bin.tgz *
  
  
! install: install.bin install.doc install-vgetty
  
  install.bin: mgetty sendfax newslock \
! 		login.config #mgetty.config sendfax.config 
  #
  # binaries
  #
  	-test -d $(BINDIR)  || ( ./mkidirs $(BINDIR)  ; chmod 755 $(BINDIR)  )
! 	$(INSTALL_PROGRAM) -m 755 newslock $(BINDIR)
  
  	-test -d $(SBINDIR) || ( ./mkidirs $(SBINDIR) ; chmod 755 $(SBINDIR) )
  	-mv -f $(SBINDIR)/mgetty $(SBINDIR)/mgetty.old
  	-mv -f $(SBINDIR)/sendfax $(SBINDIR)/sendfax.old
! 	$(INSTALL_PROGRAM) -m 700 mgetty $(SBINDIR)
! 	$(INSTALL_PROGRAM) -m 700 sendfax $(SBINDIR)
  #
  # data files + directories
  #
***************
*** 584,593 ****
  		( ./mkidirs $(CONFDIR); chmod 755 $(CONFDIR))
  	test -f $(CONFDIR)/login.config || \
  		$(INSTALL) -o root -m 600 login.config $(CONFDIR)/
! 	test -f $(CONFDIR)/mgetty.config || \
! 		$(INSTALL) -o root -m 600 mgetty.config $(CONFDIR)/
! 	test -f $(CONFDIR)/sendfax.config || \
! 		$(INSTALL) -o root -m 644 sendfax.config $(CONFDIR)/
  	test -f $(CONFDIR)/dialin.config || \
  		$(INSTALL) -o root -m 600 dialin.config $(CONFDIR)/
  	test -f $(CONFDIR)/faxrunq.config || \
--- 585,594 ----
  		( ./mkidirs $(CONFDIR); chmod 755 $(CONFDIR))
  	test -f $(CONFDIR)/login.config || \
  		$(INSTALL) -o root -m 600 login.config $(CONFDIR)/
! #	test -f $(CONFDIR)/mgetty.config || \
! #		$(INSTALL) -o root -m 600 mgetty.config $(CONFDIR)/
! #	test -f $(CONFDIR)/sendfax.config || \
! #		$(INSTALL) -o root -m 644 sendfax.config $(CONFDIR)/
  	test -f $(CONFDIR)/dialin.config || \
  		$(INSTALL) -o root -m 600 dialin.config $(CONFDIR)/
  	test -f $(CONFDIR)/faxrunq.config || \
***************
*** 618,624 ****
  #
  # g3 tool programs
  #
! 	cd g3 ; $(MAKE) install INSTALL="$(INSTALL)" \
  				BINDIR=$(BINDIR) \
  				LIBDIR=$(LIBDIR) CONFDIR=$(CONFDIR)
  #
--- 619,625 ----
  #
  # g3 tool programs
  #
! 	cd g3 ; $(MAKE) install INSTALL="$(INSTALL_PROGRAM)" \
  				BINDIR=$(BINDIR) \
  				LIBDIR=$(LIBDIR) CONFDIR=$(CONFDIR)
  #
***************
*** 633,639 ****
  	if [ ! -z "$(INSTALL_MECHO)" ] ; then \
  	    cd compat ; \
  	    $(CC) $(CFLAGS) -o mg.echo mg.echo.c && \
! 	    $(INSTALL) -s -m 755 mg.echo $(BINDIR) ; \
  	fi
  
  #
--- 634,640 ----
  	if [ ! -z "$(INSTALL_MECHO)" ] ; then \
  	    cd compat ; \
  	    $(CC) $(CFLAGS) -o mg.echo mg.echo.c && \
! 	    $(INSTALL_PROGRAM) -m 755 mg.echo $(BINDIR) ; \
  	fi
  
  #
@


1.2
log
@update to 1.1.17
@
text
@d1 301
a301 104
--- Makefile.orig	Fri Aug  7 10:42:08 1998
+++ Makefile	Thu Aug 27 21:06:00 1998
@@@@ -4,8 +4,8 @@@@
 #
 # this is the C compiler to use (on SunOS, the standard "cc" does not
 # grok my code, so please use gcc there. On ISC 4.0, use "icc".).
-CC=gcc
-#CC=cc
+#CC=gcc
+CC=cc
 #
 #### C Compiler Flags ####
 #
@@@@ -107,7 +107,7 @@@@
 # prompt first. Don't forget to activate the /AutoPPP/ line in login.config!
 #
 #CFLAGS=-Wall -O2 -pipe -DSECUREWARE -DUSE_POLL
-CFLAGS=-O2 -Wall -pipe
+#CFLAGS=-O2 -Wall -pipe
 #CFLAGS=-O -DSVR4
 #CFLAGS=-O -DSVR4 -DSVR42
 #CFLAGS=-O -DUSE_POLL
@@@@ -149,7 +149,7 @@@@
 # For Linux, add "-lutil" if the linker complains about "updwtmp".
 #
 LDFLAGS=
-LIBS=
+LIBS=-lutil
 #LIBS=-lprot -lsocket				# SCO Unix
 #LIBS=-lsocket
 #LIBS=-lbsd					# OSF/1
@@@@ -197,7 +197,7 @@@@
 #
 # where the configuration files (*.config, aliases, fax.allow/deny) go to
 #
-CONFDIR=$(prefix)/etc/mgetty+sendfax
+CONFDIR=/etc/mgetty+sendfax
 #CONFDIR=/etc/default/
 #
 #
@@@@ -259,9 +259,9 @@@@
 # please use the "mg.echo" program provided in the compat/ subdirectory.
 # Set ECHO="mg.echo" and INSTALL_MECHO to mg.echo
 #
-ECHO="echo"
+ECHO="mg.echo"
 #
-# INSTALL_MECHO=mg.echo
+INSTALL_MECHO=mg.echo
 
 #
 # for mgetty, that's it. If you want to use the voice
@@@@ -269,7 +269,7 @@@@
 
 # To maintain security, I recommend creating a new group for
 # users who are allowed to manipulate the recorded voice messages.
-PHONE_GROUP=phone
+PHONE_GROUP=dialer
 PHONE_PERMS=770
 
 # Add -DNO_STRSTR to CFLAGS if you don't have strstr().
@@@@ -301,7 +301,7 @@@@
 
 all:	bin-all doc-all
 
-bin-all: mgetty sendfax newslock subdirs call-back 
+bin-all: mgetty sendfax newslock subdirs call-back vgetty
 
 # a few C files need extra compiler arguments
 
@@@@ -560,15 +560,15 @@@@
 	cd bindist; gtar cvvfz mgetty$(MR).$(SR)-bin.tgz *
 
 
-install: install.bin install.doc
+install: install.bin install.doc install-vgetty
 
 install.bin: mgetty sendfax newslock \
-		login.config mgetty.config sendfax.config 
+		login.config #mgetty.config sendfax.config 
 #
 # binaries
 #
 	-test -d $(BINDIR)  || ( ./mkidirs $(BINDIR)  ; chmod 755 $(BINDIR)  )
-	$(INSTALL) -m 755 newslock $(BINDIR)
+	$(INSTALL) -s -m 755 newslock $(BINDIR)
 
 	-test -d $(SBINDIR) || ( ./mkidirs $(SBINDIR) ; chmod 755 $(SBINDIR) )
 	-mv -f $(SBINDIR)/mgetty $(SBINDIR)/mgetty.old
@@@@ -584,10 +584,10 @@@@
 		( ./mkidirs $(CONFDIR); chmod 755 $(CONFDIR))
 	test -f $(CONFDIR)/login.config || \
 		$(INSTALL) -o root -m 600 login.config $(CONFDIR)/
-	test -f $(CONFDIR)/mgetty.config || \
-		$(INSTALL) -o root -m 600 mgetty.config $(CONFDIR)/
-	test -f $(CONFDIR)/sendfax.config || \
-		$(INSTALL) -o root -m 644 sendfax.config $(CONFDIR)/
+#	test -f $(CONFDIR)/mgetty.config || \
+#		$(INSTALL) -o root -m 600 mgetty.config $(CONFDIR)/
+#	test -f $(CONFDIR)/sendfax.config || \
+#		$(INSTALL) -o root -m 644 sendfax.config $(CONFDIR)/
 	test -f $(CONFDIR)/dialin.config || \
 		$(INSTALL) -o root -m 600 dialin.config $(CONFDIR)/
 	test -f $(CONFDIR)/faxrunq.config || \
@


1.1
log
@Initial revision
@
text
@d1 104
a104 183
*** Makefile.orig	Fri Apr  3 04:07:51 1998
--- Makefile	Mon Apr 27 18:16:49 1998
***************
*** 4,11 ****
  #
  # this is the C compiler to use (on SunOS, the standard "cc" does not
  # grok my code, so please use gcc there. On ISC 4.0, use "icc".).
! CC=gcc
! #CC=cc
  #
  #### C Compiler Flags ####
  #
--- 4,11 ----
  #
  # this is the C compiler to use (on SunOS, the standard "cc" does not
  # grok my code, so please use gcc there. On ISC 4.0, use "icc".).
! #CC=gcc
! CC=cc
  #
  #### C Compiler Flags ####
  #
***************
*** 108,114 ****
  # prompt first. Don't forget to activate the /AutoPPP/ line in login.config!
  #
  #CFLAGS=-Wall -O2 -pipe -DSECUREWARE -DUSE_POLL
! CFLAGS=-O2 -Wall -pipe
  #CFLAGS=-O -DSVR4
  #CFLAGS=-O -DSVR4 -DSVR42
  #CFLAGS=-O -DUSE_POLL
--- 108,114 ----
  # prompt first. Don't forget to activate the /AutoPPP/ line in login.config!
  #
  #CFLAGS=-Wall -O2 -pipe -DSECUREWARE -DUSE_POLL
! #CFLAGS=-O2 -Wall -pipe
  #CFLAGS=-O -DSVR4
  #CFLAGS=-O -DSVR4 -DSVR42
  #CFLAGS=-O -DUSE_POLL
***************
*** 151,157 ****
  # For Linux, add "-lutil" if the linker complains about "updwtmp".
  #
  LDFLAGS=
! LIBS=
  #LIBS=-lprot -lsocket				# SCO Unix
  #LIBS=-lsocket
  #LIBS=-lbsd					# OSF/1
--- 151,157 ----
  # For Linux, add "-lutil" if the linker complains about "updwtmp".
  #
  LDFLAGS=
! LIBS=-lutil
  #LIBS=-lprot -lsocket				# SCO Unix
  #LIBS=-lsocket
  #LIBS=-lbsd					# OSF/1
***************
*** 199,205 ****
  #
  # where the configuration files (*.config, aliases, fax.allow/deny) go to
  #
! CONFDIR=$(prefix)/etc/mgetty+sendfax
  #CONFDIR=/etc/default/
  #
  #
--- 199,205 ----
  #
  # where the configuration files (*.config, aliases, fax.allow/deny) go to
  #
! CONFDIR=/etc/mgetty+sendfax
  #CONFDIR=/etc/default/
  #
  #
***************
*** 261,269 ****
  # please use the "mg.echo" program provided in the compat/ subdirectory.
  # Set ECHO="mg.echo" and INSTALL_MECHO to mg.echo
  #
! ECHO="echo"
  #
! # INSTALL_MECHO=mg.echo
  
  #
  # for mgetty, that's it. If you want to use the voice
--- 261,269 ----
  # please use the "mg.echo" program provided in the compat/ subdirectory.
  # Set ECHO="mg.echo" and INSTALL_MECHO to mg.echo
  #
! ECHO="mg.echo"
  #
! INSTALL_MECHO=mg.echo
  
  #
  # for mgetty, that's it. If you want to use the voice
***************
*** 271,277 ****
  
  # To maintain security, I recommend creating a new group for
  # users who are allowed to manipulate the recorded voice messages.
! PHONE_GROUP=phone
  PHONE_PERMS=770
  
  # Add -DNO_STRSTR to CFLAGS if you don't have strstr().
--- 271,277 ----
  
  # To maintain security, I recommend creating a new group for
  # users who are allowed to manipulate the recorded voice messages.
! PHONE_GROUP=dialer
  PHONE_PERMS=770
  
  # Add -DNO_STRSTR to CFLAGS if you don't have strstr().
***************
*** 303,309 ****
  
  all:	bin-all doc-all
  
! bin-all: mgetty sendfax newslock subdirs call-back 
  
  # a few C files need extra compiler arguments
  
--- 303,309 ----
  
  all:	bin-all doc-all
  
! bin-all: mgetty sendfax newslock subdirs call-back vgetty
  
  # a few C files need extra compiler arguments
  
***************
*** 563,577 ****
  	cd bindist; gtar cvvfz mgetty$(MR).$(SR)-bin.tgz *
  
  
! install: install.bin install.doc
  
  install.bin: mgetty sendfax newslock \
! 		login.config mgetty.config sendfax.config 
  #
  # binaries
  #
  	-test -d $(BINDIR)  || ( ./mkidirs $(BINDIR)  ; chmod 755 $(BINDIR)  )
! 	$(INSTALL) -m 755 newslock $(BINDIR)
  
  	-test -d $(SBINDIR) || ( ./mkidirs $(SBINDIR) ; chmod 755 $(SBINDIR) )
  	-mv -f $(SBINDIR)/mgetty $(SBINDIR)/mgetty.old
--- 563,577 ----
  	cd bindist; gtar cvvfz mgetty$(MR).$(SR)-bin.tgz *
  
  
! install: install.bin install.doc install-vgetty
  
  install.bin: mgetty sendfax newslock \
! 		login.config #mgetty.config sendfax.config 
  #
  # binaries
  #
  	-test -d $(BINDIR)  || ( ./mkidirs $(BINDIR)  ; chmod 755 $(BINDIR)  )
! 	$(INSTALL) -s -m 755 newslock $(BINDIR)
  
  	-test -d $(SBINDIR) || ( ./mkidirs $(SBINDIR) ; chmod 755 $(SBINDIR) )
  	-mv -f $(SBINDIR)/mgetty $(SBINDIR)/mgetty.old
***************
*** 587,596 ****
  		( ./mkidirs $(CONFDIR); chmod 755 $(CONFDIR))
  	test -f $(CONFDIR)/login.config || \
  		$(INSTALL) -o root -m 600 login.config $(CONFDIR)/
! 	test -f $(CONFDIR)/mgetty.config || \
! 		$(INSTALL) -o root -m 600 mgetty.config $(CONFDIR)/
! 	test -f $(CONFDIR)/sendfax.config || \
! 		$(INSTALL) -o root -m 644 sendfax.config $(CONFDIR)/
  	test -f $(CONFDIR)/dialin.config || \
  		$(INSTALL) -o root -m 600 dialin.config $(CONFDIR)/
  	test -f $(CONFDIR)/faxrunq.config || \
--- 587,596 ----
  		( ./mkidirs $(CONFDIR); chmod 755 $(CONFDIR))
  	test -f $(CONFDIR)/login.config || \
  		$(INSTALL) -o root -m 600 login.config $(CONFDIR)/
! #	test -f $(CONFDIR)/mgetty.config || \
! #		$(INSTALL) -o root -m 600 mgetty.config $(CONFDIR)/
! #	test -f $(CONFDIR)/sendfax.config || \
! #		$(INSTALL) -o root -m 644 sendfax.config $(CONFDIR)/
  	test -f $(CONFDIR)/dialin.config || \
  		$(INSTALL) -o root -m 600 dialin.config $(CONFDIR)/
  	test -f $(CONFDIR)/faxrunq.config || \
@


1.1.1.1
log
@
mgetty+sendfax port, nice getty replacement with fax/ppp recognition support
@
text
@@
