head	1.5;
access;
symbols
	OPENBSD_4_0:1.3.0.8
	OPENBSD_4_0_BASE:1.3
	OPENBSD_3_9:1.3.0.6
	OPENBSD_3_9_BASE:1.3
	OPENBSD_3_8:1.3.0.4
	OPENBSD_3_8_BASE:1.3
	OPENBSD_3_7:1.3.0.2
	OPENBSD_3_7_BASE:1.3
	OPENBSD_2_9_TRACKING_SWITCH:1.1;
locks; strict;
comment	@# @;


1.5
date	2006.12.15.13.33.33;	author ajacoutot;	state dead;
branches;
next	1.4;

1.4
date	2006.10.20.11.51.58;	author ajacoutot;	state Exp;
branches;
next	1.3;

1.3
date	2004.12.29.04.57.15;	author pvalchev;	state Exp;
branches;
next	1.2;

1.2
date	2001.10.16.12.34.23;	author naddy;	state dead;
branches;
next	1.1;

1.1
date	2001.05.23.20.45.02;	author jakob;	state Exp;
branches;
next	;


desc
@@


1.5
log
@- remove malsync: superseded by comms/libmal

ok pvalchev@@ sturm@@
@
text
@$OpenBSD: patch-Makefile,v 1.4 2006/10/20 11:51:58 ajacoutot Exp $
--- Makefile.orig	Tue Sep 19 16:46:31 2006
+++ Makefile	Tue Sep 19 16:48:06 2006
@@@@ -1,5 +1,7 @@@@
 TARGET = malsync
 
+all: ${TARGET}
+
 PLAT := $(shell uname)
 	
 ifeq ($(PLAT),SunOS)
@@@@ -15,9 +17,9 @@@@ LINKLIBS = -lm
 endif
 
 TREETOP = .
-PILOT_LINK_DIR = $(TREETOP)/pilot-link-0.11.7
+PILOT_LINK_DIR = $(PREFIX)
 
-CFLAGS = -Wall -g -DMALSYNC -I$(TREETOP)/mal/common \
+CFLAGS += -DMALSYNC -I$(TREETOP)/mal/common \
   -I$(TREETOP)/mal/client/common -I$(PILOT_LINK_DIR)/include \
   -I$(TREETOP)/mal/client/unix
 
@@@@ -72,8 +74,8 @@@@ DYNLINK = -rdynamic
 endif
 
 $(TARGET): $(OBJS)
-	$(CC) $(DYNLINK) $(CFLAGS) -o $@@ $(OBJS) \
-          ${PILOT_LINK_DIR}/libpisock/.libs/libpisock.a $(LINKLIBS)
+	$(CC) $(DYNLINK) $(CFLAGS) $(LDFLAGS) -o $@@ $(OBJS) \
+          -L${PILOT_LINK_DIR}/lib -lpisock $(LINKLIBS)
 clean:
 	rm -f $(OBJS) $(TARGET)
 
@


1.4
log
@Update to malsync-2.2.0.
Big big thank to pilot-link developper
Florent Pillet <pilot-link at florentpillet dot com> for resolving a
tricky bad pointer issue.

ok steven@@
@
text
@d1 1
a1 1
$OpenBSD$
@


1.3
log
@Update to malsync-2.1.1 which works w/ new pilot-link
From Antoine Jacoutot, maintainer timeout
(commit partly botched by cvs stupidity)
@
text
@d2 2
a3 2
--- Makefile.orig	Sun Nov 17 11:52:53 2002
+++ Makefile	Tue Dec 28 21:48:50 2004
d16 1
a16 1
-PILOT_LINK_DIR = $(TREETOP)/pilot-link-0.11.5
d29 1
a29 1
-          -L${PILOT_LINK_DIR}/libpisock/.libs -lpisock $(LINKLIBS)
@


1.2
log
@- distfile has changed
- respect CC and CFLAGS
- clean-up
ok pvalchev@@
@
text
@d1 5
a5 6
$OpenBSD: patch-Makefile,v 1.1 2001/05/23 20:45:02 jakob Exp $

--- Makefile	Sun May 14 21:17:35 2000
+++ Makefile	Sat May 19 22:08:16 2001
@@@@ -12,7 +12,16 @@@@ LINKLIBS = -ldl -lm
 endif
d7 1
a7 8
 TREETOP = ../../..
+ifeq ($(PLAT),OpenBSD)
+PILOT_LINK_DIR = ${PREFIX}
+PILOT_LINK_LIB = ${PILOT_LINK_DIR}/lib
+else
 PILOT_LINK_DIR = $(TREETOP)/vendor/pilot/pilot-link.0.9.3
+PILOT_LINK_LIB = ${PILOT_LINK_DIR}/libsock
+endif
d9 5
a13 2
+BINDIR=${PREFIX}/bin
+DOCDIR=${PREFIX}/share/doc/malsync
d15 8
a22 3
 CFLAGS = -Wall -g -DMALSYNC -I$(TREETOP)/mal/common \
   -I$(TREETOP)/mal/client/common -I$(PILOT_LINK_DIR)/include -I.
@@@@ -55,17 +64,23 @@@@ endif
d24 2
a25 3
 OBJS = $(SRC:.c=.o)
 
+all:${TARGET}
d28 4
a31 3
 	$(CC) -rdynamic  $(CFLAGS) -o $@@ $(OBJS) \
-          -L${PILOT_LINK_DIR}/libsock -lpisock $(LINKLIBS)
+          -L${PILOT_LINK_LIB} -lpisock $(LINKLIBS)
a33 13
 
 .c.o:
 	gcc $(CFLAGS) -c -o $@@ $<
 
-
+install: ${TARGET}
+	install -c ${TARGET} ${BINDIR}
+	@@if [ -d ${DOCDIR} ]; then set +x; \
+	else (set -x; mkdir -p ${DOCDIR}); fi
+	install -c -m 0644 ${TREETOP}/Doc/README* ${DOCDIR}
+	install -c -m 0644 ${TREETOP}/mal/MPL-* ${DOCDIR}
 
 
@


1.1
log
@update to malsync v2.0.6; from Xiao Hui LOO <71@@becile.com>
@
text
@d1 1
a1 1
$OpenBSD$
@

