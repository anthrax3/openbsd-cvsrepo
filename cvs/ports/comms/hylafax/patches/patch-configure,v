head	1.12;
access;
symbols
	OPENBSD_6_1:1.12.0.20
	OPENBSD_6_1_BASE:1.12
	OPENBSD_6_0:1.12.0.18
	OPENBSD_6_0_BASE:1.12
	OPENBSD_5_9:1.12.0.14
	OPENBSD_5_9_BASE:1.12
	OPENBSD_5_8:1.12.0.16
	OPENBSD_5_8_BASE:1.12
	OPENBSD_5_7:1.12.0.12
	OPENBSD_5_7_BASE:1.12
	OPENBSD_5_6:1.12.0.10
	OPENBSD_5_6_BASE:1.12
	OPENBSD_5_5:1.12.0.8
	OPENBSD_5_5_BASE:1.12
	OPENBSD_5_4:1.12.0.6
	OPENBSD_5_4_BASE:1.12
	OPENBSD_5_3:1.12.0.4
	OPENBSD_5_3_BASE:1.12
	OPENBSD_5_2:1.12.0.2
	OPENBSD_5_2_BASE:1.12
	OPENBSD_5_1_BASE:1.10
	OPENBSD_5_1:1.10.0.4
	OPENBSD_5_0:1.10.0.2
	OPENBSD_5_0_BASE:1.10
	OPENBSD_4_9:1.9.0.4
	OPENBSD_4_9_BASE:1.9
	OPENBSD_4_8:1.9.0.2
	OPENBSD_4_8_BASE:1.9
	OPENBSD_4_7:1.8.0.10
	OPENBSD_4_7_BASE:1.8
	OPENBSD_4_6:1.8.0.8
	OPENBSD_4_6_BASE:1.8
	OPENBSD_4_5:1.8.0.6
	OPENBSD_4_5_BASE:1.8
	OPENBSD_4_4:1.8.0.4
	OPENBSD_4_4_BASE:1.8
	OPENBSD_4_3:1.8.0.2
	OPENBSD_4_3_BASE:1.8
	OPENBSD_4_2:1.6.0.4
	OPENBSD_4_2_BASE:1.6
	OPENBSD_4_1:1.6.0.2
	OPENBSD_4_1_BASE:1.6
	OPENBSD_4_0:1.5.0.2
	OPENBSD_4_0_BASE:1.5
	OPENBSD_3_9:1.4.0.4
	OPENBSD_3_9_BASE:1.4
	OPENBSD_3_8:1.4.0.2
	OPENBSD_3_8_BASE:1.4
	OPENBSD_3_7:1.3.0.6
	OPENBSD_3_7_BASE:1.3
	OPENBSD_3_6:1.3.0.4
	OPENBSD_3_6_BASE:1.3
	OPENBSD_3_5:1.3.0.2
	OPENBSD_3_5_BASE:1.3
	OPENBSD_3_4:1.2.0.4
	OPENBSD_3_4_BASE:1.2
	OPENBSD_3_3:1.2.0.2
	OPENBSD_3_3_BASE:1.2;
locks; strict;
comment	@# @;


1.12
date	2012.07.19.15.05.30;	author giovanni;	state Exp;
branches;
next	1.11;

1.11
date	2012.04.14.15.13.30;	author naddy;	state Exp;
branches;
next	1.10;

1.10
date	2011.05.24.16.24.35;	author giovanni;	state Exp;
branches;
next	1.9;

1.9
date	2010.07.08.16.21.17;	author giovanni;	state Exp;
branches;
next	1.8;

1.8
date	2008.02.26.18.37.38;	author merdely;	state Exp;
branches;
next	1.7;

1.7
date	2008.02.08.23.10.45;	author okan;	state Exp;
branches;
next	1.6;

1.6
date	2006.10.18.08.09.43;	author ajacoutot;	state Exp;
branches;
next	1.5;

1.5
date	2006.03.18.17.19.21;	author naddy;	state Exp;
branches;
next	1.4;

1.4
date	2005.06.18.18.48.12;	author naddy;	state Exp;
branches;
next	1.3;

1.3
date	2003.12.23.23.43.22;	author brad;	state Exp;
branches;
next	1.2;

1.2
date	2003.01.31.15.53.50;	author brad;	state Exp;
branches;
next	1.1;

1.1
date	2003.01.27.13.42.48;	author todd;	state Exp;
branches;
next	;


desc
@@


1.12
log
@
Update to 6.0.6
hfaxd.conf has moved from lib/fax to libdata/hylafax/etc
@
text
@$OpenBSD: patch-configure,v 1.11 2012/04/14 15:13:30 naddy Exp $
--- configure.orig	Wed Jun  6 02:58:38 2012
+++ configure	Mon Jul  9 15:38:11 2012
@@@@ -39,7 +39,6 @@@@
 #
 DIR_BIN=/usr/local/bin
 DIR_SBIN=/usr/local/sbin
-DIR_LIBDATA=/usr/local/lib/fax
 DIR_LIB=/usr/local/lib
 DIR_LIBEXEC=$DIR_SBIN
 DIR_SPOOL=/var/spool/hylafax
@@@@ -73,13 +72,13 @@@@ NLS=auto
 OPTIMIZER="-O"
 LIBCRYPT=
 LIBPAM=
-LIBTIFF="-ltiff"
-TIFFINC=
+LIBTIFF="-L${LOCALBASE}/lib -ltiff"
+TIFFINC="-I${LOCALBASE}/include"
 TIFFBIN=
 LIBUTIL=
 LIBZ=-lz
 ZLIBINC=
-LIBINTL=
+LIBINTL="-L${LOCALBASE}/lib -I${LOCALBASE}/include -lintl -liconv"
 INTLINC=
 REGEX=yes
 LIBREGEX='-L${DEPTH}/regex -lregex'
@@@@ -1559,7 +1558,7 @@@@ int t() { $f(); return 0; }
 int main(){ t(); return 0; }
 EOF
     capture cat t.c
-    runMake t "t:; \${CCF} t.c $libs"
+    runMake t "t:; \${CCF} t.c -I${LOCALBASE}/include -L${LOCALBASE}/lib $libs"
 }
 
 #
@@@@ -1587,7 +1586,7 @@@@ CheckForIncludeFile()
 	echo "#include \"$i\""
      done)>t.c++
     capture cat t.c++
-    runMake t "t:; \${C++F} \${C++FILE} -E t.c++${MAKECXXOVERRIDE}"
+    runMake t "t:; \${C++F} \${C++FILE} -E t.c++${MAKECXXOVERRIDE} -I${LOCALBASE}/include"
 }
 
 if [ "$SGI2FAX" = auto ]; then
@@@@ -2568,7 +2567,6 @@@@ EOF
 				tiff_bytecount_t="uint64"
 				echo '#define TIFFHeader	TIFFHeaderClassic'
 				echo '#define TIFF_VERSION	TIFF_VERSION_CLASSIC'
-				echo '#define NEED_TIFFDIRENTRY'
 				;;
 	    esac
 	fi
@@@@ -3405,19 +3403,8 @@@@ fi
 HAVE_JBIGTIFF="/*#define HAVE_JBIGTIFF 1*/"
 if [ "$DISABLE_JBIG" != "yes" ]; then
     Note "Checking JBIG-in-TIFF conversion support."
-    $TIFFBIN/tiffcp -c g4 misc/jbig.tif misc/foo.tif > /dev/null 2>&1
-    if [ $? = 0 ]; then
-	$TIFFBIN/tiffcp misc/jbig.tif misc/foo.tif > /dev/null
-	if [ -n "`$TIFFBIN/tiffinfo misc/foo.tif | grep 'Fax DCS'`" ]; then
-	    HAVE_JBIGTIFF="#define HAVE_JBIGTIFF 1"
-	    Note "JBIG-in-TIFF conversion support found."
-	else
-	    Note "JBIG-in-TIFF fax support not found."
-	fi
-    else
-	Note "JBIG-in-TIFF conversion support not found."
-    fi
-    rm -f misc/foo.tif
+    # OpenBSD does not have JBIG-in-TIFF support
+    Note "JBIG-in-TIFF conversion support not found."
 fi
 
 Note "Done checking TIFF support."
@@@@ -4681,10 +4668,10 @@@@ case $MANSCHEME in
 *-0|*-0.gz|*-0.Z|*-gz|*-Z|*-z)
     suf=`echo $MANSCHEME | $SED 's/.*-/./'`
     A='`echo $$i | sed' B='`'		# workaround shell bugs
-    MANCAPPNAME="$A s/\\\\.1\$\$/$suf/$B"
-    MANCFILENAME="$A s/\\\\.4f\$\$/$suf/$B"
-    MANSAPPNAME="$A s/\\\\.1m\$\$/$suf/$B"
-    MANSFILENAME="$A s/\\\\.4f\$\$/$suf/$B"
+    MANCAPPNAME="$A s/\\\\.1\$$/$suf/$B"
+    MANCFILENAME="$A s/\\\\.4f\$$/$suf/$B"
+    MANSAPPNAME="$A s/\\\\.1m\$$/$suf/$B"
+    MANSFILENAME="$A s/\\\\.4f\$$/$suf/$B"
     ;;
 bsd-*-strip)
     MANCAPPNAME='$$i'
@


1.11
log
@fixes for tiff 4.0 API changes; from FreeBSD
@
text
@d1 12
a12 4
$OpenBSD: patch-configure,v 1.10 2011/05/24 16:24:35 giovanni Exp $
--- configure.orig	Wed Sep 15 16:42:36 2010
+++ configure	Fri Apr 13 16:05:41 2012
@@@@ -73,13 +73,13 @@@@ NLS=auto
d29 1
a29 1
@@@@ -1559,7 +1559,7 @@@@ int t() { $f(); return 0; }
d38 1
a38 1
@@@@ -1587,7 +1587,7 @@@@ CheckForIncludeFile()
d47 6
a52 5
@@@@ -2552,6 +2552,7 @@@@ EOF
 	    case ${lib_ver} in
 		3.4)		tiff_runlen_t="uint16" ;;
 		3.[56789])	tiff_runlen_t="uint32" ;;
+		4.[0-9])	tiff_runlen_t="uint32" ;;
d55 1
a55 2
     else
@@@@ -3383,19 +3384,8 @@@@ fi
d77 1
a77 1
@@@@ -4659,10 +4649,10 @@@@ case $MANSCHEME in
@


1.10
log
@
Major update to 6.0.5
lot of bug fixes and improvements
old protocol has been removed
Full changelog available at
http://git.hylafax.org/HylaFAX?a=blob;f=doc/RELEASENOTES-6.0.txt;hb=6.0
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.9 2010/07/08 16:21:17 giovanni Exp $
d3 1
a3 1
+++ configure	Fri Apr 22 10:34:34 2011
d39 9
a47 1
@@@@ -3383,19 +3383,8 @@@@ fi
d69 1
a69 1
@@@@ -4659,10 +4648,10 @@@@ case $MANSCHEME in
@


1.9
log
@
Update to 4.4.6
Full changelog available at
http://www.hylafax.org/content/HylaFAX_6.0.4/4.4.6/4.3.9_releases
@
text
@d1 11
a11 11
$OpenBSD: patch-configure,v 1.8 2008/02/26 18:37:38 merdely Exp $
--- configure.orig	Fri Jul  3 21:36:32 2009
+++ configure	Tue Sep 22 19:57:45 2009
@@@@ -69,7 +69,7 @@@@ DPS=no
 GS=no
 IMP=no
 UTMP=auto
-OPTIMIZER="-O"
+#OPTIMIZER="-O"
 LIBTIFF="-L/usr/local/lib -ltiff"
 TIFFINC=/usr/local/include
d13 9
a21 1
@@@@ -1533,7 +1533,7 @@@@ int t() { $f(); return 0; }
d26 1
a26 1
+    runMake t "t:; \${CCF} t.c -L%%LOCALBASE%%/lib $libs"
d30 46
@


1.8
log
@Fix build on alpha (don't hardcode -O).

ok MAINTAINER (Giovanni Bechis)
ok naddy@@, okan@@
@
text
@d1 3
a3 3
$OpenBSD: patch-configure,v 1.7 2008/02/08 23:10:45 okan Exp $
--- configure.orig	Wed Nov 21 07:45:23 2007
+++ configure	Tue Feb 26 09:46:17 2008
d13 1
a13 1
@@@@ -1521,7 +1521,7 @@@@ int t() { $f(); return 0; }
@


1.7
log
@- update to 4.4.4 from Giovanni Bechis, new MAINTAINER

ok merdely@@
@
text
@d1 12
a12 3
$OpenBSD$
--- configure.orig	Thu Aug 23 15:02:32 2007
+++ configure	Wed Nov  7 17:29:51 2007
@


1.6
log
@Set vgetty path to ${LOCALBASE}/libexec/vgetty instead of hardcoded
/sbin/vgetty.
Disable sysvinit support unconditionally since we don't need it and it
causes the "make fake" stage to fail if a sysvinit startup directory exists
(ie. /etc/init.d/)

ok sturm@@
@
text
@d1 5
a5 76
$OpenBSD: patch-configure,v 1.5 2006/03/18 17:19:21 naddy Exp $
--- configure.orig	Tue Oct  1 16:05:55 2002
+++ configure	Tue Oct 17 15:39:54 2006
@@@@ -37,10 +37,10 @@@@
 #
 # Setup general configuration parameters.
 #
-DIR_BIN=/usr/local/bin
-DIR_SBIN=/usr/local/sbin
-DIR_LIBDATA=/usr/local/lib/fax
-DIR_LIB=/usr/local/lib
+DIR_BIN=${PREFIX}/bin
+DIR_SBIN=${PREFIX}/sbin
+DIR_LIBDATA=${PREFIX}/lib/fax
+DIR_LIB=${PREFIX}/lib
 DIR_LIBEXEC=$DIR_SBIN
 DIR_SPOOL=/var/spool/hylafax
 DIR_HTML=/var/httpd/htdocs/hylafax
@@@@ -59,7 +59,7 @@@@ DSO=auto
 GETTY=auto
 HTML=no
 PS=auto
-SYSVINIT=auto
+SYSVINIT=no
 FAXQ_SERVER=yes			# init script starts faxq
 HFAXD_SERVER=yes		# init script starts hfaxd
 HFAXD_OLD_PROTOCOL=no		# don't start old protocol
@@@@ -72,8 +72,8 @@@@ DPS=no
 GS=no
 IMP=no
 UTMP=auto
-LIBTIFF="-L/usr/local/lib -ltiff"
-TIFFINC=/usr/local/include
+LIBTIFF="-L${LOCALBASE}/lib -ltiff -ljpeg -lz"
+TIFFINC=${LOCALBASE}/include
 TIFFBIN=
 LIBZ=
 ZLIBINC=
@@@@ -81,8 +81,8 @@@@ REGEX=yes
 LIBREGEX='-L${DEPTH}/regex -lregex'
 REGEXINC='${DEPTH}/${TOPSRCDIR}/regex'
 DBLIB=no
-LIBDB="-L/usr/local/lib -ldb"
-DBLIBINC=/usr/local/include
+LIBDB="-L${LOCALBASE}/lib -ldb"
+DBLIBINC=${LOCALBASE}/include
 FAXD=
 LIBFAXSERVER='libfaxserver.${DSO}'
 LIBUTIL='${UTIL}/libfaxutil.${DSO}'
@@@@ -2312,11 +2312,10 @@@@ EOF
 	Note "  Found tiffio.h version ${header_ver}"
 	Note "  Found libtiff version ${lib_ver}"
 	if [ ${header_ver} -ge 19960307 ]; then
-	    if [ "${lib_ver}" = "3.4" ]; then
-		tiff_runlen_t="uint16"
-	    elif [ "${lib_ver}" = "3.5" ]; then
-		tiff_runlen_t="uint32"
-	    fi
+	    case ${lib_ver} in
+	    3.4)	tiff_runlen_t="uint16" ;;
+	    3.[5-8])	tiff_runlen_t="uint32" ;;
+	    esac
 	fi
     else
 	cat 1>&2 <<EOF
@@@@ -2351,9 +2350,10 @@@@ EOF
 
 Incompatible TIFF Library.
 
-HylaFAX ${VERSION} requires TIFF software distribution ver 3.4 or 3.5.
-If you do not have up to date TIFF software on your system then you can
-retrieve it from the location where you obtained this software.
+HylaFAX ${VERSION} requires TIFF software distribution ver 3.4, 3.5, or
+3.6.  If you do not have up to date TIFF software on your system then
+you can retrieve it from the location where you obtained this software.
+The Home Page for version 3.5 and later is http://www.libtiff.org
d7 4
a10 4
 	boom
 	return 1
@@@@ -3669,17 +3669,8 @@@@ else
 fi
d12 1
a12 16
 # vgetty support
-if [ -z "$PATH_VGETTY" ]; then
-    PATH_VGETTY=`findApp vgetty /usr/libexec:/sbin:$PATH` 
-    if [ -z "$PATH_VGETTY" ]; then
-	PATH_VGETTY=/bin/vgetty
-	Note "WARNING, no vgetty program found to handle a voice call, using $PATH_VGETTY."
-    else
-	Note "Looks like $PATH_VGETTY is the program to exec for a voice call."
-    fi
-else
+	PATH_VGETTY=${LOCALBASE}/libexec/vgetty
     Note "Using $PATH_VGETTY as the program to exec for a voice call."
-fi
 
 # egetty support
 if [ -z "$PATH_EGETTY" ]; then
@


1.5
log
@allow building with tiff 3.8.x
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.4 2005/06/18 18:48:12 naddy Exp $
d3 1
a3 1
+++ configure	Sat Mar 18 18:13:47 2006
d19 9
d80 19
@


1.4
log
@- allow building with tiff 3.7
- no regression tests available
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.3 2003/12/23 23:43:22 brad Exp $
d3 1
a3 1
+++ configure	Sat Jun 18 19:23:37 2005
d52 1
a52 1
+	    3.[567])	tiff_runlen_t="uint32" ;;
@


1.3
log
@- make sure to include libjpeg and libz when linking libtiff
- allow the configure script to accept a 3.6 version of libtiff
@
text
@d1 3
a3 3
$OpenBSD: patch-configure,v 1.2 2003/01/31 15:53:50 brad Exp $
--- configure.orig	2002-10-01 10:05:55.000000000 -0400
+++ configure	2003-12-23 18:40:24.000000000 -0500
d41 3
a43 1
@@@@ -2314,7 +2314,7 @@@@ EOF
d45 2
a46 2
 	    if [ "${lib_ver}" = "3.4" ]; then
 		tiff_runlen_t="uint16"
d48 6
a53 3
+	    elif [ "${lib_ver}" = "3.5" -o "${lib_ver}" = "3.6" ]; then
 		tiff_runlen_t="uint32"
 	    fi
d55 3
a57 1
@@@@ -2351,9 +2351,10 @@@@ EOF
@


1.2
log
@- repsect CC/CXX/CFLAGS/CXXFLAGS
- PREFIX -> LOCALBASE for db/tiff lib/header paths
@
text
@d1 3
a3 3
$OpenBSD: patch-configure,v 1.1 2003/01/27 13:42:48 todd Exp $
--- configure.orig	Tue Oct  1 10:05:55 2002
+++ configure	Fri Jan 31 10:32:21 2003
d25 1
a25 1
+LIBTIFF="-L${LOCALBASE}/lib -ltiff"
d41 23
@


1.1
log
@update HylaFAX to 4.1.5, remove BROKEN=

based on 4.1.3 update from Steve Shockley <steve.shockley@@shockley.net>
prompted by Bert Koelewijn <bert@@schmidt-koelewijn.nl>

ok espie@@ "no actual risk you'll break it more"
@
text
@d1 3
a3 3
$OpenBSD$
--- configure.orig	Thu Jun 27 10:46:08 2002
+++ configure	Wed Jul 31 12:37:28 2002
d25 2
a26 2
+LIBTIFF="-L${PREFIX}/lib -ltiff"
+TIFFINC=${PREFIX}/include
d36 2
a37 2
+LIBDB="-L${PREFIX}/lib -ldb"
+DBLIBINC=${PREFIX}/include
@

