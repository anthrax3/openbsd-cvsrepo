head	1.3;
access;
symbols
	OPENBSD_3_0:1.2.0.2
	OPENBSD_3_0_BASE:1.2
	OPENBSD_2_9_TRACKING_SWITCH:1.2
	pvalchev_2001-May-28:1.1.1.1
	pvalchev:1.1.1
	OPENBSD_2_9:1.1.0.2
	OPENBSD_2_9_BASE:1.1;
locks; strict;
comment	@ * @;


1.3
date	2002.02.18.23.47.23;	author pvalchev;	state dead;
branches;
next	1.2;

1.2
date	2001.05.29.01.00.47;	author pvalchev;	state Exp;
branches;
next	1.1;

1.1
date	2001.02.23.16.17.15;	author ho;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2001.05.29.00.54.43;	author pvalchev;	state Exp;
branches;
next	;


desc
@@


1.3
log
@Update to jpilot-0.99.2
Thanks to the author who accepted most patches in this release.
@
text
@--- plugins.c.orig	Mon Feb  5 14:31:57 2001
+++ plugins.c	Sun May 27 17:50:15 2001
@@@@ -231,7 +231,7 @@@@ static int get_plugin_info(struct plugin
    p->plugin_post_sync = NULL;
    p->plugin_exit_cleanup = NULL;
    
-   h = dlopen(path, RTLD_NOW);
+   h = dlopen(path, DL_LAZY);
    if (!h) {
       jpilot_logf(LOG_WARN, "open failed on plugin [%s]\n error [%s]\n", path,
 		  dlerror());
@@@@ -243,6 +243,9 @@@@ static int get_plugin_info(struct plugin
    p->full_path = strdup(path);
 
    /* plugin_versionM */
+#if defined __OpenBSD__ && !defined __ELF__
+#define dlsym(x,y) dlsym(x, "_" y)
+#endif
    plugin_versionM = dlsym(h, "plugin_version");
    if (plugin_versionM==NULL)  {
       err = dlerror();
@


1.2
log
@Take over port maintainership, ho@@ agreed.

o Fix dynamic loading - prefix an underscore in symbol names for our a.out
platforms in order for dlsym() to work, hence plugins can be loaded.
o Build Expense plugin.
o Build synctime plugin.
o Install more documentation, rearrage Makefile, bump package name.
@
text
@@


1.1
log
@Update to v0.99
@
text
@d1 3
a3 3
--- plugins.c.orig	Mon Feb  5 22:31:57 2001
+++ plugins.c	Fri Feb 23 17:04:14 2001
@@@@ -231,7 +231,7 @@@@
d12 10
@


1.1.1.1
log
@o Fix dynamic loading - prefix an underscore in symbol names for our a.out
platforms in order for dlsym() to work, hence plugins can be loaded.
o Build Expense plugin.
o Build synctime plugin.
o Put in libtool patches.
@
text
@d1 3
a3 3
--- plugins.c.orig	Mon Feb  5 14:31:57 2001
+++ plugins.c	Sun May 27 17:50:15 2001
@@@@ -231,7 +231,7 @@@@ static int get_plugin_info(struct plugin
a11 10
@@@@ -243,6 +243,9 @@@@ static int get_plugin_info(struct plugin
    p->full_path = strdup(path);
 
    /* plugin_versionM */
+#if defined __OpenBSD__ && !defined __ELF__
+#define dlsym(x,y) dlsym(x, "_" y)
+#endif
    plugin_versionM = dlsym(h, "plugin_version");
    if (plugin_versionM==NULL)  {
       err = dlerror();
@

