head	1.3;
access;
symbols
	OPENBSD_6_0:1.3.0.34
	OPENBSD_6_0_BASE:1.3
	OPENBSD_5_9:1.3.0.30
	OPENBSD_5_9_BASE:1.3
	OPENBSD_5_8:1.3.0.32
	OPENBSD_5_8_BASE:1.3
	OPENBSD_5_7:1.3.0.28
	OPENBSD_5_7_BASE:1.3
	OPENBSD_5_6:1.3.0.26
	OPENBSD_5_6_BASE:1.3
	OPENBSD_5_5:1.3.0.24
	OPENBSD_5_5_BASE:1.3
	OPENBSD_5_4:1.3.0.22
	OPENBSD_5_4_BASE:1.3
	OPENBSD_5_3:1.3.0.20
	OPENBSD_5_3_BASE:1.3
	OPENBSD_5_2:1.3.0.18
	OPENBSD_5_2_BASE:1.3
	OPENBSD_5_1_BASE:1.3
	OPENBSD_5_1:1.3.0.16
	OPENBSD_5_0:1.3.0.14
	OPENBSD_5_0_BASE:1.3
	OPENBSD_4_9:1.3.0.12
	OPENBSD_4_9_BASE:1.3
	OPENBSD_4_8:1.3.0.10
	OPENBSD_4_8_BASE:1.3
	OPENBSD_4_7:1.3.0.8
	OPENBSD_4_7_BASE:1.3
	OPENBSD_4_6:1.3.0.6
	OPENBSD_4_6_BASE:1.3
	OPENBSD_4_5:1.3.0.4
	OPENBSD_4_5_BASE:1.3
	OPENBSD_4_4:1.3.0.2
	OPENBSD_4_4_BASE:1.3
	OPENBSD_4_3:1.2.0.2
	OPENBSD_4_3_BASE:1.2
	OPENBSD_4_2:1.1.1.1.0.28
	OPENBSD_4_2_BASE:1.1.1.1
	OPENBSD_4_1:1.1.1.1.0.26
	OPENBSD_4_1_BASE:1.1.1.1
	OPENBSD_4_0:1.1.1.1.0.24
	OPENBSD_4_0_BASE:1.1.1.1
	OPENBSD_3_9:1.1.1.1.0.22
	OPENBSD_3_9_BASE:1.1.1.1
	OPENBSD_3_8:1.1.1.1.0.20
	OPENBSD_3_8_BASE:1.1.1.1
	OPENBSD_3_7:1.1.1.1.0.18
	OPENBSD_3_7_BASE:1.1.1.1
	OPENBSD_3_6:1.1.1.1.0.16
	OPENBSD_3_6_BASE:1.1.1.1
	OPENBSD_3_5:1.1.1.1.0.14
	OPENBSD_3_5_BASE:1.1.1.1
	OPENBSD_3_4:1.1.1.1.0.12
	OPENBSD_3_4_BASE:1.1.1.1
	OPENBSD_3_3:1.1.1.1.0.10
	OPENBSD_3_3_BASE:1.1.1.1
	OPENBSD_3_2:1.1.1.1.0.8
	OPENBSD_3_2_BASE:1.1.1.1
	OPENBSD_3_1:1.1.1.1.0.6
	OPENBSD_3_1_BASE:1.1.1.1
	OPENBSD_3_0:1.1.1.1.0.4
	OPENBSD_3_0_BASE:1.1.1.1
	OPENBSD_2_9_TRACKING_SWITCH:1.1.1.1
	OPENBSD_2_9:1.1.1.1.0.2
	OPENBSD_2_9_BASE:1.1.1.1
	naddy_20010110:1.1.1.1
	naddy:1.1.1;
locks; strict;
comment	@# @;


1.3
date	2008.06.20.10.49.42;	author martynas;	state Exp;
branches;
next	1.2;

1.2
date	2007.12.18.10.39.47;	author ajacoutot;	state Exp;
branches;
next	1.1;

1.1
date	2001.01.10.16.54.49;	author naddy;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2001.01.10.16.54.49;	author naddy;	state Exp;
branches;
next	;


desc
@@


1.3
log
@There's a fine utility in base, called ftp.  There's no reason at
all that some of the ports RUN_DEPEND on wget.
"Nice!" naddy@@, who also went even further and made libxml not
BUILD_DEPEND on wget.
@
text
@$OpenBSD: patch-GetKp,v 1.2 2007/12/18 10:39:47 ajacoutot Exp $
--- wmSpaceWeather/GetKp.orig	Fri Feb 12 06:42:01 1999
+++ wmSpaceWeather/GetKp	Thu Jun 19 20:41:26 2008
@@@@ -7,19 +7,31 @@@@
 
     require "ctime.pl";
 
+    #
+    #  Change to users home directory. We used to dump into /tmp
+    #  but using home dir instead avoids multiple users interfering
+    #  with one another. (Yeah, we could "unique-ize" the filenames, but
+    #  this is easier for now...)
+    #
+    $home = (getpwuid($<))[7];
+    $ok = chdir() || chdir($home);
 
-    ($Year, $Month, $Day) = &year_month_day();
-    
-    if (-e "/tmp/DGD.txt"){
-	unlink("/tmp/DGD.txt");
+    #
+    #  Check to see if .wmSpaceWeatherReports exists.
+    #  If not, make it and move to it.
+    #
+    if ( !(-e ".wmSpaceWeatherReports") ){
+        mkdir(".wmSpaceWeatherReports", 0775);
     }
+    chdir(".wmSpaceWeatherReports");
+    unlink("DGD.txt");
+    unlink("curind.txt");
 
-    if (-e "/tmp/curind.txt"){
-	unlink("/tmp/curind.txt");
-    }
 
+    ($Year, $Month, $Day) = &year_month_day();
 
-    $grabcmd = "cd /tmp; wget --passive-ftp --tries 2 -q ftp://www.sec.noaa.gov/pub/indices/DGD.txt";
+
+    $grabcmd = "ftp -V ftp://www.sec.noaa.gov/pub/indices/DGD.txt";
     system "$grabcmd";
 
 
@@@@ -37,7 +49,7 @@@@
     $Kp{190001018} = 999;
 
 
-    open(TmpFile, "/tmp/DGD.txt");
+    open(TmpFile, "DGD.txt");
     while (<TmpFile>){
         chop;
 	if ($_ =~ /^\d{4} \d{2} \d{2}\s*\d*/ ){
@@@@ -68,12 +80,12 @@@@
     #
     # Add in very latest stuff
     #
-    $grabcmd = "cd /tmp; wget --passive-ftp --tries 2 -q ftp://www.sec.noaa.gov/pub/latest/curind.txt";
+    $grabcmd = "ftp -V ftp://www.sec.noaa.gov/pub/latest/curind.txt";
     system "$grabcmd";
     %lmonstr = ( "Jan", 1, "Feb", 2, "Mar", 3, "Apr", 4, "May", 5, "Jun", 6, "Jul", 7, "Aug", 8, "Sep", 9, "Oct", 10, "Nov", 11, "Dec", 12);
 
 @@lval = ($lyear, $lmonstr{$lmon}, $ldom);
-    open(TmpFile, "/tmp/curind.txt");
+    open(TmpFile, "curind.txt");
     while (<TmpFile>){
         chop;
 	if ($_ =~ /^:Geomagnetic_Values: (\d{4}) (.*) (\d{1,2})/){
@@@@ -133,7 +145,7 @@@@
 	}
     }
 
-    open(TmpFile, ">/tmp/LatestKp.txt");
+    open(TmpFile, ">LatestKp.txt");
     foreach $key  (sort keys %Result ) {
 	if ($Result{$key} > 10) { $Result{$key} = -1; }
 	printf TmpFile "$key $Result{$key}\n";
@


1.2
log
@- remove dead HOMEPAGE
- regen patches while here

ok wilfried@@
@
text
@d1 1
a1 1
$OpenBSD: patch-GetKp,v 1.1.1.1 2001/01/10 16:54:49 naddy Exp $
d3 1
a3 1
+++ wmSpaceWeather/GetKp	Tue Dec 18 10:22:00 2007
d40 1
a40 1
+    $grabcmd = "wget --passive-ftp --tries 2 -q ftp://www.sec.noaa.gov/pub/indices/DGD.txt";
d58 1
a58 1
+    $grabcmd = "wget --passive-ftp --tries 2 -q ftp://www.sec.noaa.gov/pub/latest/curind.txt";
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
$OpenBSD: update-patches,v 1.3 2000/06/09 17:08:37 espie Exp $
d3 1
a3 1
+++ wmSpaceWeather/GetKp	Wed Jan 10 14:37:37 2001
d35 1
a35 1
+
a37 1
 
d39 1
@


1.1.1.1
log
@Import wmSpaceWeather 1.04.
Submitted by Peter Stromberg <home@@wilfried.net>.

wmSpaceWeather is a space weather monitor.  The monitor shows two
relativistic electron and three  relativistic proton flux levels
at geosyncronous orbit (currently from the NOAA GOES spacecraft),
current Solar Flare X-ray flux, and the last eight three-hour Kp
index values.
@
text
@@
