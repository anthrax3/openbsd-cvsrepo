head	1.3;
access;
symbols
	OPENBSD_4_6:1.2.0.2
	OPENBSD_4_6_BASE:1.2
	OPENBSD_4_5:1.1.0.4
	OPENBSD_4_5_BASE:1.1
	OPENBSD_4_4:1.1.0.2
	OPENBSD_4_4_BASE:1.1;
locks; strict;
comment	@# @;


1.3
date	2009.07.20.10.35.20;	author ajacoutot;	state dead;
branches;
next	1.2;

1.2
date	2009.05.06.08.36.41;	author ajacoutot;	state Exp;
branches;
next	1.1;

1.1
date	2008.05.10.17.25.52;	author ajacoutot;	state Exp;
branches;
next	;


desc
@@


1.3
log
@Major update to celestia-1.6.0.
Complete changelog can be found here:
    http://sourceforge.net/project/shownotes.php?group_id=21302&release_id=695491
@
text
@$OpenBSD: patch-src_celengine_render_cpp,v 1.2 2009/05/06 08:36:41 ajacoutot Exp $

Prevent stack overflow.

--- src/celengine/render.cpp.orig	Wed Apr 23 23:17:16 2008
+++ src/celengine/render.cpp	Wed May  6 10:09:12 2009
@@@@ -7647,7 +7647,9 @@@@ void StarRenderer::process(const Star& star, float dis
     nProcessed++;
 
     Point3f starPos = star.getPosition();
-    Vec3f   relPos = starPos - obsPos;
+    Vec3f   relPos((float) ((double) starPos.x - obsPos.x),
+                   (float) ((double) starPos.y - obsPos.y),
+                   (float) ((double) starPos.z - obsPos.z));
     float   orbitalRadius = star.getOrbitalRadius();
     bool    hasOrbit = orbitalRadius > 0.0f;
 
@@@@ -7861,7 +7863,9 @@@@ void PointStarRenderer::process(const Star& star, floa
     nProcessed++;
 
     Point3f starPos = star.getPosition();
-    Vec3f   relPos = starPos - obsPos;
+    Vec3f   relPos((float) ((double) starPos.x - obsPos.x),
+                   (float) ((double) starPos.y - obsPos.y),
+                   (float) ((double) starPos.z - obsPos.z));
     float   orbitalRadius = star.getOrbitalRadius();
     bool    hasOrbit = orbitalRadius > 0.0f;
 
@


1.2
log
@- fix stack overflow; from Olivier Crouzet
issue was also reported by Josh Grosse
@
text
@d1 1
a1 1
$OpenBSD: patch-src_celengine_render_cpp,v 1.1 2008/05/10 17:25:52 ajacoutot Exp $
@


1.1
log
@- update to 1.5.1
- fix a stack corruption on startup (bits taken from celestia SVN)
- use SUBST_CMD (gotta love that stuff!)
@
text
@d1 18
a18 4
$OpenBSD$
--- src/celengine/render.cpp.orig	Sat May 10 19:19:49 2008
+++ src/celengine/render.cpp	Sat May 10 19:19:55 2008
@@@@ -7861,7 +7861,9 @@@@ void PointStarRenderer::process(const Star& star, floa
@

