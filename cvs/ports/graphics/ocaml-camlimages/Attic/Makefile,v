head	1.11;
access;
symbols
	OPENBSD_6_0:1.10.0.2
	OPENBSD_6_0_BASE:1.10
	OPENBSD_5_9:1.9.0.2
	OPENBSD_5_9_BASE:1.9
	OPENBSD_5_8:1.8.0.6
	OPENBSD_5_8_BASE:1.8
	OPENBSD_5_7:1.8.0.2
	OPENBSD_5_7_BASE:1.8
	OPENBSD_5_6:1.6.0.4
	OPENBSD_5_6_BASE:1.6
	OPENBSD_5_5:1.6.0.2
	OPENBSD_5_5_BASE:1.6
	OPENBSD_5_4:1.4.0.2
	OPENBSD_5_4_BASE:1.4
	OPENBSD_5_3:1.2.0.2
	OPENBSD_5_3_BASE:1.2;
locks; strict;
comment	@# @;


1.11
date	2017.03.04.16.32.26;	author krw;	state dead;
branches;
next	1.10;
commitid	OYlB5zuJlIsQtriG;

1.10
date	2016.03.29.11.27.01;	author naddy;	state Exp;
branches;
next	1.9;
commitid	YG8j0S3Qu1QSiwCV;

1.9
date	2015.08.30.16.06.34;	author avsm;	state Exp;
branches;
next	1.8;
commitid	IFFgnDYFn7rZn9i1;

1.8
date	2014.08.22.22.21.53;	author kili;	state Exp;
branches;
next	1.7;
commitid	V82zoWOaRELJa7mF;

1.7
date	2014.08.21.20.54.04;	author chrisz;	state Exp;
branches;
next	1.6;
commitid	awCwxDnH1Bd4hpii;

1.6
date	2014.01.10.18.43.38;	author landry;	state Exp;
branches;
next	1.5;

1.5
date	2013.09.25.07.58.41;	author sthen;	state Exp;
branches;
next	1.4;

1.4
date	2013.06.04.18.41.50;	author naddy;	state Exp;
branches;
next	1.3;

1.3
date	2013.03.11.11.10.54;	author espie;	state Exp;
branches;
next	1.2;

1.2
date	2012.11.30.19.38.09;	author chrisz;	state Exp;
branches;
next	1.1;

1.1
date	2012.08.18.23.35.30;	author avsm;	state Exp;
branches;
next	;


desc
@@


1.11
log
@Remove unused, older library versions. Current ones
available via normal Ocaml ecosystem (a.k.a. opam).

ok chrisz@@ avsm@@ (maintainers)
@
text
@# $OpenBSD: Makefile,v 1.10 2016/03/29 11:27:01 naddy Exp $

COMMENT=	image manipulation functions for Objective Caml
CATEGORIES=	graphics

V=		4.2.1
DISTNAME=	camlimages-$V
PKGNAME=	ocaml-${DISTNAME}
REVISION=	0
DISTFILES=	$V.tar.gz
# XXX bogus filename; fix at next update, see new DISTFILES syntax with {}
MASTER_SITES=	https://bitbucket.org/camlspotter/camlimages/get/
WRKDIST=	${WRKDIR}/camlspotter-camlimages-447c5c72b044

MAINTAINER=	Anil Madhavapeddy <avsm@@openbsd.org>
HOMEPAGE=	http://cristal.inria.fr/camlimages/

PERMIT_PACKAGE_CDROM=	Yes

MODULES=	lang/ocaml

LIB_DEPENDS=	graphics/jpeg \
		graphics/giflib \
		graphics/png \
		graphics/tiff \
		graphics/libexif \
		x11/gtk+2

BUILD_DEPENDS=	devel/omake \
		sysutils/findlib \
		lang/ocaml,-graphics \
		print/ghostscript/gnu \
		x11/lablgtk2

WANTLIB = 	X11 Xcomposite Xcursor Xdamage Xext Xfixes Xi Xinerama
WANTLIB +=	Xpm Xrandr Xrender atk-1.0 c cairo exif fontconfig
WANTLIB +=	freetype gdk-x11-2.0 gdk_pixbuf-2.0 gif gio-2.0 glib-2.0
WANTLIB +=	gobject-2.0 gtk-x11-2.0 intl jpeg m pango-1.0 pangocairo-1.0
WANTLIB +=	pangoft2-1.0 png pthread tiff z

.include <bsd.port.arch.mk>
.if ${PROPERTIES:Mocaml_native}
MAKE_ENV +=	OCAML_NATIVE=1
.else
MAKE_ENV +=	OCAML_NATIVE=0
.endif

MAKE_FLAGS+=	CFLAGS="${CFLAGS} \
			-I${X11BASE}/include \
			-I${X11BASE}/include/X11 \
			-I${LOCALBASE}/include" \
		LDFLAGS=" \
			-L${X11BASE}/lib \
			-L${LOCALBASE}/lib"

TEST_IS_INTERACTIVE = X11

OMAKE=		omake --force-dotomake --dotomake ${WRKSRC}/omake_cache

pre-build:
	${SUBST_CMD} ${WRKSRC}/OMakefile

do-build:
	cd ${WRKSRC} && env -i ${MAKE_ENV} ${OMAKE} ${MAKE_FLAGS}

do-install:
	cd ${WRKSRC} && env -i ${MAKE_ENV} \
	${OMAKE} ${ALL_FAKE_FLAGS} ${FAKE_TARGET}

post-install:
	@@cp -R ${WRKSRC}/examples/ ${PREFIX}/share/examples/ocaml-camlimages

do-test:
	cd ${WRKSRC}/test && ./test

.include <bsd.port.mk>
@


1.10
log
@g/c PFRAG.shared from OCaml ports; ok chrisz@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2015/08/30 16:06:34 avsm Exp $
@


1.9
log
@update to ocaml-camlimages-4.2.1

ok jca@@, tested by krw@@ daniel@@ jsg@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2014/08/22 22:21:53 kili Exp $
d9 1
@


1.8
log
@Bump after lang/ocaml pkgname change (first round, more bumps will follow).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2014/08/21 20:54:04 chrisz Exp $
d6 1
a6 2
V=		4.0.1
REVISION=	2
d9 1
a9 1
DISTFILES=	v$V.tar.gz
d12 1
a12 1
WRKDIST=	${WRKDIR}/camlspotter-camlimages-c803efa9d5d3
a20 2
WANTLIB+=	c X11 Xpm freetype gif jpeg m png tiff z

d24 4
a27 1
		graphics/tiff
d31 8
a38 1
		print/ghostscript/gnu
@


1.7
log
@Split off camlp4, labltk and graphics from our current OCaml 4.01.
This will help when upgrading to upcoming OCaml 4.02, which will miss camlp4
and labltk.
For a smooth transision, make all OCaml ports BUILD_DEPEND on camlp4 via
MODULES=ocaml.

sysutils/findlib is the only port using -labltk.
graphics/ocaml-camlimage is the only port using -graphics.


ok avsm@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2014/01/10 18:43:38 landry Exp $
d7 1
a7 1
REVISION=	1
@


1.6
log
@pass ${X11BASE}/include directly within OMakefile, and while here remove
an hardcoded /usr/X11R6. Note: this horror doesnt seem to respect CFLAGS.
Fixes build with newer freetype.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2013/09/25 07:58:41 sthen Exp $
d30 1
@


1.5
log
@libungif->giflib and patch where necessary, ok jasper@@ aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2013/06/04 18:41:50 naddy Exp $
d50 3
@


1.4
log
@the png headers are now directly under include/
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2013/03/11 11:10:54 espie Exp $
d7 1
a7 1
REVISION=	0
d11 1
d25 1
a25 1
		graphics/libungif \
d47 1
a47 2
# test exists, but needs manual run and then user interaction
TEST_IS_INTERACTIVE = Yes
d60 3
@


1.3
log
@PERMIT_* / REGRESS -> TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2012/11/30 19:38:09 chrisz Exp $
a30 3
# The camlimages build system seems to need some include paths in CPATH and
# others in CFLAGS. I don't know why, but this way at least it works.
MAKE_ENV+=	CPATH="${LOCALBASE}/include/libpng"
@


1.2
log
@update lang/ocaml to 4.00.1.
Let all ocaml ports RUN_DEPEND on the version of ocaml they were built with.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1 2012/08/18 23:35:30 avsm Exp $
a16 2
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
a17 1
PERMIT_PACKAGE_FTP=	Yes
d49 2
a50 2
# regress exists, but needs manual run and then user interaction
NO_REGRESS=	Yes
@


1.1
log
@update to ocaml-camlimages-4.0.1
* rename to ocaml-camlimages from camlimages for consistency
* new MASTER_SITES and DISTFILES naming scheme
* switch to omake
* remove gettext dependency
* remove lablgtk dependency - only needed for examples
* remove ghostscript runtime dependency - only needed for postscript.

From: Christopher Zimmermann <madroach@@gmerlin.de>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2011/11/01 20:30:49 jasper Exp $
d7 1
@

