head	1.4;
access;
symbols
	OPENBSD_3_8:1.1.0.14
	OPENBSD_3_8_BASE:1.1
	OPENBSD_3_7:1.1.0.12
	OPENBSD_3_7_BASE:1.1
	OPENBSD_3_6:1.1.0.10
	OPENBSD_3_6_BASE:1.1
	OPENBSD_3_5:1.1.0.8
	OPENBSD_3_5_BASE:1.1
	OPENBSD_3_4:1.1.0.6
	OPENBSD_3_4_BASE:1.1
	OPENBSD_3_3:1.1.0.4
	OPENBSD_3_3_BASE:1.1
	OPENBSD_3_2:1.1.0.2;
locks; strict;
comment	@# @;


1.4
date	2005.12.22.23.21.50;	author steven;	state dead;
branches;
next	1.3;

1.3
date	2005.10.24.05.03.48;	author fgsch;	state Exp;
branches;
next	1.2;

1.2
date	2005.10.21.10.29.17;	author fgsch;	state Exp;
branches;
next	1.1;

1.1
date	2002.11.30.05.31.47;	author brad;	state Exp;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2002.12.01.20.55.47;	author brad;	state Exp;
branches;
next	;


desc
@@


1.4
log
@update to 2.30

ok sturm@@
@
text
@$OpenBSD: patch-GD_xs,v 1.3 2005/10/24 05:03:48 fgsch Exp $
--- GD.xs.orig	Sat Jul 20 12:43:49 2002
+++ GD.xs	Fri Oct 21 07:40:55 2005
@@@@ -17,6 +17,7 @@@@
 #endif
 /* Copyright 1995 - 1998, Lincoln D. Stein.  See accompanying README file for
 	usage restrictions */
+#define gdFree free
 
 static int
 not_here(char *s)
@@@@ -339,7 +340,7 @@@@ static gdIOCtx* newDynamicCtx (char* dat
   ctx->ctx.getBuf = bufGetBuf;
   ctx->ctx.seek   = bufSeek;
   ctx->ctx.tell   = bufTell;
-  ctx->ctx.free   = bufFree;
+  ctx->ctx.gd_free   = bufFree;
   ctx->ctx.putC   = NULL;
   ctx->ctx.putBuf = NULL;
   return (gdIOCtx*)ctx;
@@@@ -392,7 +393,7 @@@@ gdnewFromPngData(packname="GD::Image", i
 	data = SvPV(imageData,len);
         ctx = newDynamicCtx(data,len);
 	RETVAL = (GD__Image) gdImageCreateFromPngCtx(ctx);
-        (ctx->free)(ctx);
+        (ctx->gd_free)(ctx);
 	OUTPUT:
 	RETVAL
 
@@@@ -409,7 +410,7 @@@@ gdnewFromGdData(packname="GD::Image", im
 	data = SvPV(imageData,len);
         ctx = newDynamicCtx(data,len);
 	RETVAL = (GD__Image) gdImageCreateFromGdCtx(ctx);
-        (ctx->free)(ctx);
+        (ctx->gd_free)(ctx);
 	OUTPUT:
 	RETVAL
 
@@@@ -426,7 +427,7 @@@@ gdnewFromGd2Data(packname="GD::Image", i
 	data = SvPV(imageData,len);
         ctx = newDynamicCtx(data,len);
 	RETVAL = (GD__Image) gdImageCreateFromGd2Ctx(ctx);
-        (ctx->free)(ctx);
+        (ctx->gd_free)(ctx);
 	OUTPUT:
 	RETVAL
 
@@@@ -445,7 +446,7 @@@@ gdnewFromGifData(packname="GD::Image", i
 	data = SvPV(imageData,len);
         ctx = newDynamicCtx(data,len);
 	RETVAL = (GD__Image) gdImageCreateFromGifCtx(ctx);
-        ctx->free(ctx);
+        ctx->gd_free(ctx);
 #else
     errormsg = perl_get_sv("@@",0);
     sv_setpv(errormsg,"libgd was not built with gif support\n");
@@@@ -469,7 +470,7 @@@@ gdnewFromJpegData(packname="GD::Image", 
 	data = SvPV(imageData,len);
         ctx = newDynamicCtx(data,len);
 	RETVAL = (GD__Image) gdImageCreateFromJpegCtx(ctx);
-        (ctx->free)(ctx);
+        (ctx->gd_free)(ctx);
 #else
         errormsg = perl_get_sv("@@",0);
         sv_setpv(errormsg,"libgd was not built with jpeg support\n");
@@@@ -491,7 +492,7 @@@@ gdnewFromWBMPData(packname="GD::Image", 
 	data = SvPV(imageData,len);
         ctx = newDynamicCtx(data,len);
 	RETVAL = (GD__Image) gdImageCreateFromWBMPCtx(ctx);
-        (ctx->free)(ctx);
+        (ctx->gd_free)(ctx);
 	OUTPUT:
 	RETVAL
 
@


1.3
log
@cope with gd changes and avoid hardcoding paths.
sturm@@ ok.
@
text
@d1 1
a1 1
$OpenBSD$
@


1.2
log
@fix compilation after gd update; pointed out and ok espie@@.
sorry again folks.
@
text
@d1 1
a1 1
$OpenBSD: patch-GD_xs,v 1.1 2002/11/30 05:31:47 brad Exp $
d3 1
a3 1
+++ GD.xs	Thu Oct 20 20:41:29 2005
a74 18
@@@@ -1351,7 +1352,7 @@@@ gdstringUp(image,font,x,y,s,color)
 	}
 
 void
-gdstringFT(image,fgcolor,fontname,ptsize,angle,x,y,string)
+gdstringTTF(image,fgcolor,fontname,ptsize,angle,x,y,string)
         SV *	        image
         int             fgcolor
 	char *          fontname
@@@@ -1376,7 +1377,7 @@@@ gdstringFT(image,fgcolor,fontname,ptsize
 	    img = NULL;
 	  }
 
-	  err = gdImageStringFT(img,brect,fgcolor,fontname,ptsize,angle,x,y,string);
+	  err = gdImageStringTTF(img,brect,fgcolor,fontname,ptsize,angle,x,y,string);
 	  if (err) {
 	    errormsg = perl_get_sv("@@",0);
 	    if (errormsg != NULL)
@


1.1
log
@Fix p5-GD 1.41 so it will work with gd 1.8.3

This actually works when I include the patches.
--
From: MAINTAINER
@
text
@d1 3
a3 3
$OpenBSD$
--- GD.xs.orig	Sun Nov 24 03:38:02 2002
+++ GD.xs	Sun Nov 24 03:38:39 2002
d12 63
@


1.1.2.1
log
@MFC:
- Fix p5-GD 1.41 so it will work with gd 1.8.3
- remove no_x11 FLAVOR
@
text
@d1 1
a1 1
$OpenBSD: patch-GD_xs,v 1.1 2002/11/30 05:31:47 brad Exp $
@

