head	1.10;
access;
symbols
	OPENBSD_6_2:1.10.0.4
	OPENBSD_6_2_BASE:1.10
	OPENBSD_6_1:1.10.0.2
	OPENBSD_6_1_BASE:1.10
	OPENBSD_6_0:1.9.0.2
	OPENBSD_6_0_BASE:1.9
	OPENBSD_5_9:1.8.0.2
	OPENBSD_5_9_BASE:1.8
	OPENBSD_5_8:1.8.0.4
	OPENBSD_5_8_BASE:1.8
	OPENBSD_5_7:1.7.0.4
	OPENBSD_5_7_BASE:1.7
	OPENBSD_5_6:1.7.0.2
	OPENBSD_5_6_BASE:1.7
	OPENBSD_5_5:1.6.0.2
	OPENBSD_5_5_BASE:1.6
	OPENBSD_5_4:1.4.0.4
	OPENBSD_5_4_BASE:1.4
	OPENBSD_5_3:1.4.0.2
	OPENBSD_5_3_BASE:1.4
	OPENBSD_5_2:1.3.0.4
	OPENBSD_5_2_BASE:1.3
	OPENBSD_5_1_BASE:1.3
	OPENBSD_5_1:1.3.0.2;
locks; strict;
comment	@# @;


1.10
date	2016.08.30.14.44.37;	author dcoppa;	state Exp;
branches;
next	1.9;
commitid	rAtiy7SSzxCCg4FI;

1.9
date	2016.04.13.12.54.55;	author dcoppa;	state Exp;
branches;
next	1.8;
commitid	U0jC192ndmympogd;

1.8
date	2015.04.23.05.54.04;	author dcoppa;	state Exp;
branches;
next	1.7;
commitid	TrtZ44ILkUGusEIW;

1.7
date	2014.03.12.11.41.43;	author dcoppa;	state Exp;
branches;
next	1.6;

1.6
date	2013.12.03.07.37.44;	author dcoppa;	state Exp;
branches;
next	1.5;

1.5
date	2013.11.22.10.42.12;	author dcoppa;	state Exp;
branches;
next	1.4;

1.4
date	2012.12.31.12.03.09;	author dcoppa;	state Exp;
branches;
next	1.3;

1.3
date	2011.10.11.07.49.07;	author dcoppa;	state Exp;
branches;
next	1.2;

1.2
date	2011.09.15.13.27.09;	author dcoppa;	state dead;
branches;
next	1.1;

1.1
date	2011.09.09.09.51.43;	author dcoppa;	state Exp;
branches;
next	;


desc
@@


1.10
log
@
Update to feh-2.17
@
text
@$OpenBSD: patch-src_events_c,v 1.9 2016/04/13 12:54:55 dcoppa Exp $
--- src/events.c.orig	Sun Aug 28 22:25:42 2016
+++ src/events.c	Tue Aug 30 16:28:12 2016
@@@@ -123,7 +123,7 @@@@ void init_buttonbindings(void)
 
 	free(confpath);
 
-	if (!conf && ((conf = fopen("/etc/feh/buttons", "r")) == NULL))
+	if (!conf && ((conf = fopen("${SYSCONFDIR}/feh/buttons", "r")) == NULL))
 		return;
 
 	while (fgets(line, sizeof(line), conf)) {
@


1.9
log
@
Update to feh-2.15
@
text
@d1 4
a4 4
$OpenBSD: patch-src_events_c,v 1.8 2015/04/23 05:54:04 dcoppa Exp $
--- src/events.c.orig	Sat Apr  9 20:43:53 2016
+++ src/events.c	Wed Apr 13 14:44:36 2016
@@@@ -122,7 +122,7 @@@@ void init_buttonbindings(void)
@


1.8
log
@
Update to feh-2.12.1
@
text
@d1 4
a4 4
$OpenBSD: patch-src_events_c,v 1.7 2014/03/12 11:41:43 dcoppa Exp $
--- src/events.c.orig	Wed Apr  8 11:21:11 2015
+++ src/events.c	Thu Apr 23 07:46:02 2015
@@@@ -123,7 +123,7 @@@@ void init_buttonbindings(void)
@


1.7
log
@Update to feh-2.10
@
text
@d1 4
a4 4
$OpenBSD: patch-src_events_c,v 1.6 2013/12/03 07:37:44 dcoppa Exp $
--- src/events.c.orig	Wed Mar 12 12:32:52 2014
+++ src/events.c	Wed Mar 12 12:33:41 2014
@@@@ -124,7 +124,7 @@@@ void init_buttonbindings(void)
@


1.6
log
@
thumbnail mode: if --action is set, run it instead of opening images
(upstream git commit c0649c4b2a7c824abc743fa59457221e2bc3ab21)
@
text
@d1 3
a3 17
$OpenBSD: patch-src_events_c,v 1.5 2013/11/22 10:42:12 dcoppa Exp $

commit c0649c4b2a7c824abc743fa59457221e2bc3ab21
Author: Daniel Friesel <derf@@finalrewind.org>
Date:   Sun Nov 24 23:29:15 2013 +0100

thumbnail mode: if --action is set, run it instead of opening images

commit 2f09bf037a9e02de6a0df68625f139173495699a
Author: Daniel Friesel <derf@@finalrewind.org>
Date:   Wed Nov 20 20:53:18 2013 +0100

events.c: fix off-by-one pixel error when warping the pointer in
the bottom/right window border

--- src/events.c.orig	Tue Jun 11 08:28:26 2013
+++ src/events.c	Tue Dec  3 08:38:16 2013
a12 61
@@@@ -378,8 +378,12 @@@@ static void feh_event_handle_ButtonRelease(XEvent * ev
 				x /= winwid->zoom;
 				y /= winwid->zoom;
 				thumbfile = feh_thumbnail_get_file_from_coords(x, y);
-				if (thumbfile)
-					feh_thumbnail_show_fullsize(thumbfile);
+				if (thumbfile) {
+					if (opt.actions[0])
+						feh_action_run(thumbfile, opt.actions[0]);
+					else
+						feh_thumbnail_show_fullsize(thumbfile);
+				}
 			}
 		} else {
 			opt.mode = MODE_NORMAL;
@@@@ -578,36 +582,36 @@@@ static void feh_event_handle_MotionNotify(XEvent * ev)
 
 			winwidget_sanitise_offsets(winwid);
 
-			D(("im_x %d, im_w %d, off %d, mx %d\n", winwid->im_x,
-				winwid->im_w, winwid->click_offset_x, ev->xmotion.x));
+			D(("im_x %d, im_w %d, off %d, mx %d, my %d\n", winwid->im_x,
+				winwid->im_w, winwid->click_offset_x, ev->xmotion.x,
+				ev->xmotion.y));
 
 			/* XWarpPointer generates a MotionNotify event which we will
 			 * parse. Since that event would undo the effect of the pointer
 			 * warp, we need to change the click_offset to compensate this.
 			 */
-			if ((winwid->w - ev->xmotion.x <= 1)
-					&& (winwid->click_offset_x >= winwid->w - 4))
+			if ((winwid->w - ev->xmotion.x <= 1) && (winwid->im_x < 0))
 			{
 				XWarpPointer(disp, None, winwid->win, 0, 0, 0, 0, 3,
 					ev->xmotion.y);
 				winwid->click_offset_x -= winwid->w - 4;
 			}
-			else if ((ev->xmotion.x <= 1) && (winwid->click_offset_x
-					<= (winwid->im_w * winwid->zoom) - winwid->w - 3))
+			else if ((ev->xmotion.x <= 1) && (winwid->w <
+					(winwid->im_x + winwid->im_w * winwid->zoom)))
 			{
 				XWarpPointer(disp, None, winwid->win, 0, 0, 0, 0,
 					winwid->w - 4, ev->xmotion.y);
 				winwid->click_offset_x += winwid->w - 4;
 			}
 			else if ((winwid->h - ev->xmotion.y <= 1)
-					&& (winwid->click_offset_y >= winwid->h - 4))
+					&& (winwid->im_y < 0))
 			{
 				XWarpPointer(disp, None, winwid->win, 0, 0, 0, 0,
 					ev->xmotion.x, 3);
 				winwid->click_offset_y -= winwid->h - 4;
 			}
-			else if ((ev->xmotion.y <= 1) && (winwid->click_offset_y
-					<= (winwid->im_h * winwid->zoom) - winwid->h - 3))
+			else if ((ev->xmotion.y <= 1) && (winwid->h <
+					(winwid->im_y + winwid->im_h * winwid->zoom)))
 			{
 				XWarpPointer(disp, None, winwid->win, 0, 0, 0, 0,
 					ev->xmotion.x, winwid->h - 4);
@


1.5
log
@Fix off-by-one pixel error when warping the pointer in the bottom/right
window border (git commit 2f09bf037a9e02de6a0df68625f139173495699a)
@
text
@d1 7
a7 1
$OpenBSD: patch-src_events_c,v 1.4 2012/12/31 12:03:09 dcoppa Exp $
d17 1
a17 1
+++ src/events.c	Fri Nov 22 11:32:19 2013
d27 16
a42 1
@@@@ -578,36 +578,36 @@@@ static void feh_event_handle_MotionNotify(XEvent * ev)
@


1.4
log
@Update to feh-2.8
@
text
@d1 11
a11 3
$OpenBSD: patch-src_events_c,v 1.3 2011/10/11 07:49:07 dcoppa Exp $
--- src/events.c.orig	Mon Dec 24 15:47:25 2012
+++ src/events.c	Mon Dec 31 12:57:08 2012
d21 46
@


1.3
log
@Update to feh-2.0
@
text
@d1 4
a4 4
$OpenBSD$
--- src/events.c.orig	Tue Oct 11 09:21:18 2011
+++ src/events.c	Tue Oct 11 09:23:17 2011
@@@@ -121,7 +121,7 @@@@ void init_buttonbindings(void)
@


1.2
log
@feh-1.16.1
@
text
@d1 12
a12 16
$OpenBSD: patch-src_events_c,v 1.1 2011/09/09 09:51:43 dcoppa Exp $

feh_reload_image: fix regression of old caching issue
(upstream git commit 04690171c47c99e584fe1ae9d5ebed913ac5ba99)

--- src/events.c.orig	Mon Sep  5 11:00:25 2011
+++ src/events.c	Fri Sep  9 11:30:03 2011
@@@@ -114,7 +114,7 @@@@ static void feh_event_handle_ButtonPress(XEvent * ev)
 				- winwid->im_y) / winwid->old_zoom;
 	} else if (ev->xbutton.button == opt.reload_button) {
 		D(("Reload Button Press event\n"));
-			feh_reload_image(winwid, 0, 0);
+			feh_reload_image(winwid, 0, 1);
 	} else if (ev->xbutton.button == opt.prev_button) {
 		D(("Prev Button Press event\n"));
 		if (winwid->type == WIN_TYPE_SLIDESHOW)
@


1.1
log
@Update to feh-1.16 (plus a bugfix from upstream git).
@
text
@d1 1
a1 1
$OpenBSD$
@

