head	1.14;
access;
symbols
	OPENBSD_6_1:1.12.0.2
	OPENBSD_6_1_BASE:1.12
	OPENBSD_6_0:1.10.0.2
	OPENBSD_6_0_BASE:1.10
	OPENBSD_5_9:1.9.0.2
	OPENBSD_5_9_BASE:1.9
	OPENBSD_5_8:1.9.0.4
	OPENBSD_5_8_BASE:1.9
	OPENBSD_5_7:1.8.0.8
	OPENBSD_5_7_BASE:1.8
	OPENBSD_5_6:1.8.0.6
	OPENBSD_5_6_BASE:1.8
	OPENBSD_5_5:1.8.0.4
	OPENBSD_5_5_BASE:1.8
	OPENBSD_5_4:1.8.0.2
	OPENBSD_5_4_BASE:1.8
	OPENBSD_5_3:1.7.0.4
	OPENBSD_5_3_BASE:1.7
	OPENBSD_5_2:1.7.0.2
	OPENBSD_5_2_BASE:1.7
	OPENBSD_5_1_BASE:1.6
	OPENBSD_5_1:1.6.0.2
	OPENBSD_5_0:1.5.0.2
	OPENBSD_5_0_BASE:1.5
	OPENBSD_4_9:1.3.0.2
	OPENBSD_4_9_BASE:1.3
	OPENBSD_4_8:1.1.0.2
	OPENBSD_4_8_BASE:1.1;
locks; strict;
comment	@# @;


1.14
date	2017.09.04.11.18.17;	author dcoppa;	state Exp;
branches;
next	1.13;
commitid	kuyflSG2Jd9fhyM7;

1.13
date	2017.08.16.06.38.37;	author dcoppa;	state Exp;
branches;
next	1.12;
commitid	lZBLwwR4xAWjexPz;

1.12
date	2016.11.04.08.57.31;	author dcoppa;	state Exp;
branches;
next	1.11;
commitid	ULMnGENTMVRWv5Oc;

1.11
date	2016.08.30.14.44.37;	author dcoppa;	state Exp;
branches;
next	1.10;
commitid	rAtiy7SSzxCCg4FI;

1.10
date	2016.06.09.10.56.59;	author dcoppa;	state Exp;
branches;
next	1.9;
commitid	dvUKuEA3Xejtr1Tu;

1.9
date	2015.04.23.05.54.04;	author dcoppa;	state Exp;
branches;
next	1.8;
commitid	TrtZ44ILkUGusEIW;

1.8
date	2013.03.14.13.25.30;	author dcoppa;	state Exp;
branches;
next	1.7;

1.7
date	2012.02.21.12.27.25;	author dcoppa;	state Exp;
branches;
next	1.6;

1.6
date	2011.09.09.09.51.43;	author dcoppa;	state Exp;
branches;
next	1.5;

1.5
date	2011.07.05.08.05.35;	author dcoppa;	state Exp;
branches;
next	1.4;

1.4
date	2011.05.02.21.22.58;	author dcoppa;	state Exp;
branches;
next	1.3;

1.3
date	2011.01.05.13.13.05;	author dcoppa;	state Exp;
branches;
next	1.2;

1.2
date	2010.09.13.07.24.24;	author dcoppa;	state dead;
branches;
next	1.1;

1.1
date	2010.07.11.14.46.13;	author dcoppa;	state Exp;
branches;
next	;


desc
@@


1.14
log
@
Respect -N / --no-menus option (broken in 2.17)
(upstream git commit 8ad7d16318975a46aaada5c2b4ecf22c089b88f5)

Silence -Wimplicit-fallthrough= warning (missing break)
(upstream git commit a0e2ed52478480513dc1f6963f3114c7841a0d87)
@
text
@$OpenBSD: patch-src_keyevents_c,v 1.13 2017/08/16 06:38:37 dcoppa Exp $

commit 8ad7d16318975a46aaada5c2b4ecf22c089b88f5
Author: Daniel Friesel <derf@@finalrewind.org>
Date:   Sat Sep 2 07:23:55 2017

Respect -N / --no-menus option (broken in 2.17)

Index: src/keyevents.c
--- src/keyevents.c.orig
+++ src/keyevents.c
@@@@ -183,7 +183,7 @@@@ void init_keyevents(void) {
 
 	free(confpath);
 
-	if (!conf && ((conf = fopen("/etc/feh/keys", "r")) == NULL))
+	if (!conf && ((conf = fopen("${SYSCONFDIR}/feh/keys", "r")) == NULL))
 		return;
 
 	while (fgets(line, sizeof(line), conf)) {
@@@@ -743,7 +743,7 @@@@ void feh_event_handle_generic(winwidget winwid, unsign
 	else if (feh_is_kp(&keys.size_to_image, state, keysym, button)) {
 		winwidget_size_to_image(winwid);
 	}
-	else if (feh_is_kp(&keys.toggle_menu, state, keysym, button)) {
+	else if (!opt.no_menus && feh_is_kp(&keys.toggle_menu, state, keysym, button)) {
 		winwidget_show_menu(winwid);
 	}
 	else if (feh_is_kp(&keys.close, state, keysym, button)) {
@


1.13
log
@
Bugfixing update to feh-2.19.2.
Fix segfault in feh_event_handle_keypress for certain key inputs.
@
text
@d1 8
a8 1
$OpenBSD: patch-src_keyevents_c,v 1.12 2016/11/04 08:57:31 dcoppa Exp $
d21 9
@


1.12
log
@
Update to feh-2.18
@
text
@d1 5
a5 4
$OpenBSD: patch-src_keyevents_c,v 1.11 2016/08/30 14:44:37 dcoppa Exp $
--- src/keyevents.c.orig	Tue Nov  1 11:03:51 2016
+++ src/keyevents.c	Fri Nov  4 09:52:50 2016
@@@@ -174,7 +174,7 @@@@ void init_keyevents(void) {
@


1.11
log
@
Update to feh-2.17
@
text
@d1 4
a4 4
$OpenBSD: patch-src_keyevents_c,v 1.10 2016/06/09 10:56:59 dcoppa Exp $
--- src/keyevents.c.orig	Sun Aug 28 22:25:42 2016
+++ src/keyevents.c	Tue Aug 30 16:28:12 2016
@@@@ -173,7 +173,7 @@@@ void init_keyevents(void) {
@


1.10
log
@
Update to feh-2.16
@
text
@d1 4
a4 4
$OpenBSD: patch-src_keyevents_c,v 1.9 2015/04/23 05:54:04 dcoppa Exp $
--- src/keyevents.c.orig	Thu Jun  9 09:02:41 2016
+++ src/keyevents.c	Thu Jun  9 12:27:08 2016
@@@@ -172,7 +172,7 @@@@ void init_keyevents(void) {
@


1.9
log
@
Update to feh-2.12.1
@
text
@d1 4
a4 4
$OpenBSD: patch-src_keyevents_c,v 1.8 2013/03/14 13:25:30 dcoppa Exp $
--- src/keyevents.c.orig	Wed Apr  8 11:21:11 2015
+++ src/keyevents.c	Thu Apr 23 07:46:02 2015
@@@@ -170,7 +170,7 @@@@ void init_keyevents(void) {
@


1.8
log
@Update to feh-2.9.1
@
text
@d1 4
a4 4
$OpenBSD: patch-src_keyevents_c,v 1.7 2012/02/21 12:27:25 dcoppa Exp $
--- src/keyevents.c.orig	Thu Feb 14 12:53:26 2013
+++ src/keyevents.c	Thu Mar 14 13:45:54 2013
@@@@ -171,7 +171,7 @@@@ void init_keyevents(void) {
@


1.7
log
@Update to feh-2.3
@
text
@d1 4
a4 4
$OpenBSD: patch-src_keyevents_c,v 1.6 2011/09/09 09:51:43 dcoppa Exp $
--- src/keyevents.c.orig	Thu Feb  2 21:10:57 2012
+++ src/keyevents.c	Tue Feb 21 12:38:52 2012
@@@@ -170,7 +170,7 @@@@ void init_keyevents(void) {
@


1.6
log
@Update to feh-1.16 (plus a bugfix from upstream git).
@
text
@d1 4
a4 4
$OpenBSD: patch-src_keyevents_c,v 1.5 2011/07/05 08:05:35 dcoppa Exp $
--- src/keyevents.c.orig	Mon Sep  5 11:00:25 2011
+++ src/keyevents.c	Fri Sep  9 11:27:11 2011
@@@@ -167,7 +167,7 @@@@ void init_keyevents(void) {
@


1.5
log
@Bugfixing update to feh-1.14.2
@
text
@d1 4
a4 4
$OpenBSD: patch-src_keyevents_c,v 1.4 2011/05/02 21:22:58 dcoppa Exp $
--- src/keyevents.c.orig	Mon Jul  4 14:49:17 2011
+++ src/keyevents.c	Tue Jul  5 09:59:07 2011
@@@@ -156,7 +156,7 @@@@ void init_keyevents(void) {
@


1.4
log
@Update to feh-1.13.
I take maintainership too, cause old maintainer is M.I.A.

OK sthen@@
@
text
@d1 4
a4 4
$OpenBSD: patch-src_keyevents_c,v 1.3 2011/01/05 13:13:05 dcoppa Exp $
--- src/keyevents.c.orig	Fri Dec  3 19:42:44 2010
+++ src/keyevents.c	Wed Jan  5 14:07:07 2011
@@@@ -155,7 +155,7 @@@@ void init_keyevents(void) {
@


1.3
log
@Fix zooming with --scale-down.

From upstream git
@
text
@d1 1
a1 1
$OpenBSD$
d4 9
a12 8
@@@@ -307,6 +307,7 @@@@ void feh_event_handle_keypress(XEvent * ev)
 	case XK_KP_Multiply:
 		len = 0;
 		winwid->zoom = 1;
+		winwid->old_zoom = 1.001; /* hack for --scale-down */
 		winwidget_center_image(winwid);
 		winwidget_render_image(winwid, 0, 0);
 		break;
@


1.2
log
@Update to feh-1.9

OK sthen@@, ajacoutot@@
@
text
@d1 5
a5 5
$OpenBSD: patch-src_keyevents_c,v 1.1 2010/07/11 14:46:13 dcoppa Exp $
--- src/keyevents.c.orig	Mon Jul  5 08:53:35 2010
+++ src/keyevents.c	Mon Jul  5 08:54:09 2010
@@@@ -261,11 +261,13 @@@@ void feh_event_handle_keypress(XEvent * ev)
 		/* erroneously recognized as '+' in the *kbuf switch. Work around this. */
d7 3
a9 2
 		winwid->zoom = winwid->zoom * 1.25;
+		winwidget_sanitise_offsets(winwid);
a11 7
 	case XK_KP_Subtract:
 		len = 0;
 		winwid->zoom = winwid->zoom * 0.75;
+		winwidget_sanitise_offsets(winwid);
 		winwidget_render_image(winwid, 0, 0);
 		break;
 	case XK_KP_Multiply:
@


1.1
log
@Update to feh-1.8.
Use ftp from base instead of wget for remote images support.

OK sthen@@
Maintainer timeout...
@
text
@d1 1
a1 1
$OpenBSD$
@

