head	1.1;
access;
symbols
	OPENBSD_6_2:1.1.0.4
	OPENBSD_6_2_BASE:1.1
	OPENBSD_6_1:1.1.0.2
	OPENBSD_6_1_BASE:1.1;
locks; strict;
comment	@# @;


1.1
date	2017.02.05.21.23.00;	author sthen;	state Exp;
branches;
next	;
commitid	8dU071YkFkpkxSqL;


desc
@@


1.1
log
@Change FFmpeg's TLS support to use SSLv23_*_method (allowing any
supported SSL/TLS version, in our case this is TLS1.0+) instead of the
confusingly-named TLSv1_*_method (TLSv1.0 only). Fixes e.g. "mplayer
https://ftp.openbsd.org/pub/OpenBSD/songs/song53.mp3". OK Brad.
@
text
@$OpenBSD$
--- libavformat/tls_openssl.c.orig	Sun Feb  5 20:55:04 2017
+++ libavformat/tls_openssl.c	Sun Feb  5 20:55:14 2017
@@@@ -208,7 +208,7 @@@@ static int tls_open(URLContext *h, const char *uri, in
     if ((ret = ff_tls_open_underlying(c, h, uri, options)) < 0)
         goto fail;
 
-    p->ctx = SSL_CTX_new(c->listen ? TLSv1_server_method() : TLSv1_client_method());
+    p->ctx = SSL_CTX_new(c->listen ? SSLv23_server_method() : SSLv23_client_method());
     if (!p->ctx) {
         av_log(h, AV_LOG_ERROR, "%s\n", ERR_error_string(ERR_get_error(), NULL));
         ret = AVERROR(EIO);
@
