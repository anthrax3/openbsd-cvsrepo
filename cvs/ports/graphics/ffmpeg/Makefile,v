head	1.162;
access;
symbols
	OPENBSD_6_1:1.157.0.2
	OPENBSD_6_1_BASE:1.157
	OPENBSD_6_0:1.149.0.2
	OPENBSD_6_0_BASE:1.149
	OPENBSD_5_9:1.143.0.2
	OPENBSD_5_9_BASE:1.143
	OPENBSD_5_8:1.122.0.4
	OPENBSD_5_8_BASE:1.122
	OPENBSD_5_7:1.111.0.2
	OPENBSD_5_7_BASE:1.111
	OPENBSD_5_6:1.104.0.2
	OPENBSD_5_6_BASE:1.104
	OPENBSD_5_5:1.102.0.2
	OPENBSD_5_5_BASE:1.102
	OPENBSD_5_4:1.99.0.2
	OPENBSD_5_4_BASE:1.99
	OPENBSD_5_3:1.95.0.2
	OPENBSD_5_3_BASE:1.95
	OPENBSD_5_2:1.88.0.2
	OPENBSD_5_2_BASE:1.88
	OPENBSD_5_1_BASE:1.84
	OPENBSD_5_1:1.84.0.2
	OPENBSD_5_0:1.76.0.2
	OPENBSD_5_0_BASE:1.76
	OPENBSD_4_9:1.68.0.2
	OPENBSD_4_9_BASE:1.68
	OPENBSD_4_8:1.56.0.2
	OPENBSD_4_8_BASE:1.56
	OPENBSD_4_7:1.50.0.2
	OPENBSD_4_7_BASE:1.50
	OPENBSD_4_6:1.46.0.2
	OPENBSD_4_6_BASE:1.46
	OPENBSD_4_5:1.45.0.2
	OPENBSD_4_5_BASE:1.45
	OPENBSD_4_4:1.38.0.2
	OPENBSD_4_4_BASE:1.38
	OPENBSD_4_3:1.35.0.2
	OPENBSD_4_3_BASE:1.35
	OPENBSD_4_2:1.28.0.2
	OPENBSD_4_2_BASE:1.28
	OPENBSD_4_1:1.26.0.2
	OPENBSD_4_1_BASE:1.26
	OPENBSD_4_0:1.22.0.2
	OPENBSD_4_0_BASE:1.22
	OPENBSD_3_9:1.18.0.2
	OPENBSD_3_9_BASE:1.18
	OPENBSD_3_8:1.17.0.2
	OPENBSD_3_8_BASE:1.17
	OPENBSD_3_7:1.16.0.2
	OPENBSD_3_7_BASE:1.16
	OPENBSD_3_6:1.10.0.2
	OPENBSD_3_6_BASE:1.10
	OPENBSD_3_5:1.8.0.2
	OPENBSD_3_5_BASE:1.8
	OPENBSD_3_4:1.4.0.2
	OPENBSD_3_4_BASE:1.4
	jolan_2003-jul-19:1.1.1.1
	jolan:1.1.1;
locks; strict;
comment	@# @;


1.162
date	2017.06.15.11.33.18;	author ajacoutot;	state Exp;
branches;
next	1.161;
commitid	K2SQ399oiVvP4XhD;

1.161
date	2017.05.31.08.08.16;	author espie;	state Exp;
branches;
next	1.160;
commitid	ij92FtFXiSiT1ani;

1.160
date	2017.05.28.11.59.52;	author zhuk;	state Exp;
branches;
next	1.159;
commitid	HtRedu3VFS8gP2KT;

1.159
date	2017.05.28.11.52.06;	author espie;	state Exp;
branches;
next	1.158;
commitid	f7VREtH3uxIaBTCc;

1.158
date	2017.05.27.04.54.31;	author espie;	state Exp;
branches;
next	1.157;
commitid	oA9cQ9pQa6A0Atbr;

1.157
date	2017.02.09.12.58.03;	author ajacoutot;	state Exp;
branches;
next	1.156;
commitid	XpCg0YuYlMfpptmx;

1.156
date	2017.02.05.21.23.00;	author sthen;	state Exp;
branches;
next	1.155;
commitid	8dU071YkFkpkxSqL;

1.155
date	2016.12.26.09.29.21;	author ajacoutot;	state Exp;
branches;
next	1.154;
commitid	rXX7kq5m6Dpdv6fS;

1.154
date	2016.12.11.09.27.53;	author ajacoutot;	state Exp;
branches;
next	1.153;
commitid	QNqQnErJEjJ1VxNw;

1.153
date	2016.12.05.09.02.29;	author ajacoutot;	state Exp;
branches;
next	1.152;
commitid	oQI5L2fkLhaPREvJ;

1.152
date	2016.10.17.07.51.00;	author ajacoutot;	state Exp;
branches;
next	1.151;
commitid	Wo4uP395zjJX9ZOv;

1.151
date	2016.10.08.17.50.46;	author ajacoutot;	state Exp;
branches;
next	1.150;
commitid	DTUrU6hWcFBAG1cF;

1.150
date	2016.09.06.12.37.11;	author ajacoutot;	state Exp;
branches;
next	1.149;
commitid	z3rQhI117DvrHlZm;

1.149
date	2016.05.03.06.05.49;	author ajacoutot;	state Exp;
branches;
next	1.148;
commitid	VfdMmnXKIRQjKU4e;

1.148
date	2016.04.07.06.01.19;	author ajacoutot;	state Exp;
branches;
next	1.147;
commitid	XQzqg9116vhXixw9;

1.147
date	2016.03.10.20.41.22;	author naddy;	state Exp;
branches;
next	1.146;
commitid	6DToP1kZahs6yMWe;

1.146
date	2016.03.09.17.29.36;	author ajacoutot;	state Exp;
branches;
next	1.145;
commitid	TFfaaPvpBDwqcHyX;

1.145
date	2016.03.07.07.11.35;	author ajacoutot;	state Exp;
branches;
next	1.144;
commitid	FnJIp1QTzf5KQpn7;

1.144
date	2016.02.25.03.53.53;	author ajacoutot;	state Exp;
branches;
next	1.143;
commitid	1k5OP9J3MODxZT4L;

1.143
date	2016.01.23.14.12.28;	author ajacoutot;	state Exp;
branches;
next	1.142;
commitid	tWjutqozd4IF7mm7;

1.142
date	2016.01.22.07.05.01;	author ajacoutot;	state Exp;
branches;
next	1.141;
commitid	QxWiiXgyevTr4Srf;

1.141
date	2016.01.18.15.34.45;	author ajacoutot;	state Exp;
branches;
next	1.140;
commitid	RwM3NoHU9JMWKEgE;

1.140
date	2016.01.16.09.01.26;	author ajacoutot;	state Exp;
branches;
next	1.139;
commitid	mJ17aVxdt3NrfqC7;

1.139
date	2016.01.14.06.09.43;	author ajacoutot;	state Exp;
branches;
next	1.138;
commitid	1MTT7RUn5DsgY3tS;

1.138
date	2015.12.17.09.54.33;	author ajacoutot;	state Exp;
branches;
next	1.137;
commitid	ucBAGhJ9OHl5k2Y0;

1.137
date	2015.12.10.06.53.38;	author ajacoutot;	state Exp;
branches;
next	1.136;
commitid	syJXIQ2pJKvIoUp8;

1.136
date	2015.12.06.08.51.46;	author ajacoutot;	state Exp;
branches;
next	1.135;
commitid	qmMp5nlfDfTw8ZGw;

1.135
date	2015.11.16.06.36.55;	author ajacoutot;	state Exp;
branches;
next	1.134;
commitid	QCUZ5eWQ2FAYYhVH;

1.134
date	2015.11.13.07.03.00;	author ajacoutot;	state Exp;
branches;
next	1.133;
commitid	5titZ14griQo6xYl;

1.133
date	2015.10.25.08.46.41;	author ajacoutot;	state Exp;
branches;
next	1.132;
commitid	SKomGDNtuQfFPemq;

1.132
date	2015.10.17.06.49.22;	author ajacoutot;	state Exp;
branches;
next	1.131;
commitid	qCaTAupMCq4yvb8q;

1.131
date	2015.10.13.05.44.18;	author ajacoutot;	state Exp;
branches;
next	1.130;
commitid	qst9LZIZleMKOm5n;

1.130
date	2015.10.03.19.39.47;	author sthen;	state Exp;
branches;
next	1.129;
commitid	DgxpqhOGbZEUfetT;

1.129
date	2015.10.01.15.14.49;	author ajacoutot;	state Exp;
branches;
next	1.128;
commitid	6XqTOMl0kzlKQsW1;

1.128
date	2015.09.27.06.35.33;	author ajacoutot;	state Exp;
branches;
next	1.127;
commitid	37JetHBZHzvjG329;

1.127
date	2015.09.23.09.16.45;	author ajacoutot;	state Exp;
branches;
next	1.126;
commitid	t74suKYQj33NdaVz;

1.126
date	2015.09.19.18.21.15;	author ajacoutot;	state Exp;
branches;
next	1.125;
commitid	x8H1hGNYM4aZaOCR;

1.125
date	2015.09.15.12.49.42;	author ajacoutot;	state Exp;
branches;
next	1.124;
commitid	ciTOHXX4AwC0OcBH;

1.124
date	2015.09.12.09.44.54;	author ajacoutot;	state Exp;
branches;
next	1.123;
commitid	2zCvmn8WdgiiJ5l4;

1.123
date	2015.09.10.07.10.04;	author ajacoutot;	state Exp;
branches;
next	1.122;
commitid	BDuwSNknZHV1yp3r;

1.122
date	2015.08.01.07.50.25;	author jasper;	state Exp;
branches
	1.122.4.1;
next	1.121;
commitid	MyhAcAAg0LgjPYeB;

1.121
date	2015.07.26.07.22.15;	author ajacoutot;	state Exp;
branches;
next	1.120;
commitid	dkXFOkRDvjfRGOaD;

1.120
date	2015.07.12.16.19.38;	author ajacoutot;	state Exp;
branches;
next	1.119;
commitid	ETFVs1NSoJGZz8Bc;

1.119
date	2015.06.29.06.19.32;	author ajacoutot;	state Exp;
branches;
next	1.118;
commitid	RGVFfcgCUKFMKOaq;

1.118
date	2015.06.10.06.34.45;	author ajacoutot;	state Exp;
branches;
next	1.117;
commitid	x24HO3ZekL9ai8k1;

1.117
date	2015.05.22.05.41.22;	author ajacoutot;	state Exp;
branches;
next	1.116;
commitid	PFps5C2KCif5oz97;

1.116
date	2015.05.16.07.10.30;	author ajacoutot;	state Exp;
branches;
next	1.115;
commitid	3QKgXkyWOXCunwlc;

1.115
date	2015.05.05.16.04.18;	author ajacoutot;	state Exp;
branches;
next	1.114;
commitid	Nobil7ynMSM4L7eA;

1.114
date	2015.05.01.08.41.30;	author ajacoutot;	state Exp;
branches;
next	1.113;
commitid	5D6nkN4nQcYxucet;

1.113
date	2015.04.28.07.13.15;	author ajacoutot;	state Exp;
branches;
next	1.112;
commitid	CjMx0XkY1ZrwLoh1;

1.112
date	2015.04.28.06.32.47;	author ajacoutot;	state Exp;
branches;
next	1.111;
commitid	A9iBYMQ3XssEpdrF;

1.111
date	2015.02.17.01.28.52;	author brad;	state Exp;
branches;
next	1.110;
commitid	soOYdJ8xlu39byvH;

1.110
date	2015.01.10.10.46.37;	author brad;	state Exp;
branches;
next	1.109;
commitid	Jvhk3PM2BVrIPd5L;

1.109
date	2014.11.04.09.31.01;	author landry;	state Exp;
branches;
next	1.108;
commitid	dZSMyAiHWapwDyYN;

1.108
date	2014.10.23.07.41.45;	author brad;	state Exp;
branches;
next	1.107;
commitid	3ZcbyNHYegRj327Y;

1.107
date	2014.10.19.23.14.23;	author brad;	state Exp;
branches;
next	1.106;
commitid	jAX6LQxB4XzyAjyo;

1.106
date	2014.09.04.05.49.49;	author brad;	state Exp;
branches;
next	1.105;
commitid	m9YYzLBzsqVir3EN;

1.105
date	2014.08.14.08.20.27;	author brad;	state Exp;
branches;
next	1.104;
commitid	pSVHmwDct53IFfXl;

1.104
date	2014.07.25.20.37.58;	author brad;	state Exp;
branches;
next	1.103;
commitid	wNkVRIVusJ28ppSi;

1.103
date	2014.05.16.01.34.50;	author brad;	state Exp;
branches;
next	1.102;

1.102
date	2013.12.28.00.40.05;	author brad;	state Exp;
branches
	1.102.2.1;
next	1.101;

1.101
date	2013.12.24.15.22.55;	author brad;	state Exp;
branches;
next	1.100;

1.100
date	2013.08.19.14.38.29;	author brad;	state Exp;
branches;
next	1.99;

1.99
date	2013.04.14.21.10.49;	author brad;	state Exp;
branches;
next	1.98;

1.98
date	2013.04.08.17.06.55;	author brad;	state Exp;
branches;
next	1.97;

1.97
date	2013.03.13.02.26.44;	author brad;	state Exp;
branches;
next	1.96;

1.96
date	2013.03.11.11.10.52;	author espie;	state Exp;
branches;
next	1.95;

1.95
date	2013.01.25.09.46.22;	author brad;	state Exp;
branches;
next	1.94;

1.94
date	2013.01.20.07.46.16;	author brad;	state Exp;
branches;
next	1.93;

1.93
date	2013.01.16.01.02.03;	author brad;	state Exp;
branches;
next	1.92;

1.92
date	2013.01.14.02.14.41;	author brad;	state Exp;
branches;
next	1.91;

1.91
date	2013.01.08.10.13.13;	author brad;	state Exp;
branches;
next	1.90;

1.90
date	2012.09.12.08.15.57;	author ajacoutot;	state Exp;
branches;
next	1.89;

1.89
date	2012.09.04.06.31.08;	author ajacoutot;	state Exp;
branches;
next	1.88;

1.88
date	2012.06.18.16.44.53;	author jasper;	state Exp;
branches;
next	1.87;

1.87
date	2012.06.09.23.05.49;	author sthen;	state Exp;
branches;
next	1.86;

1.86
date	2012.04.28.08.41.32;	author ajacoutot;	state Exp;
branches;
next	1.85;

1.85
date	2012.04.08.16.56.51;	author ajacoutot;	state Exp;
branches;
next	1.84;

1.84
date	2011.12.30.17.34.39;	author edd;	state Exp;
branches;
next	1.83;

1.83
date	2011.09.21.08.58.48;	author sthen;	state Exp;
branches;
next	1.82;

1.82
date	2011.09.12.21.04.48;	author sthen;	state Exp;
branches;
next	1.81;

1.81
date	2011.09.04.09.22.43;	author sthen;	state Exp;
branches;
next	1.80;

1.80
date	2011.08.28.11.17.48;	author sthen;	state Exp;
branches;
next	1.79;

1.79
date	2011.08.24.09.26.41;	author sthen;	state Exp;
branches;
next	1.78;

1.78
date	2011.08.23.11.59.59;	author sthen;	state Exp;
branches;
next	1.77;

1.77
date	2011.08.16.19.01.47;	author sthen;	state Exp;
branches;
next	1.76;

1.76
date	2011.08.03.18.44.07;	author dcoppa;	state Exp;
branches
	1.76.2.1;
next	1.75;

1.75
date	2011.07.11.14.04.42;	author jasper;	state Exp;
branches;
next	1.74;

1.74
date	2011.06.27.13.36.44;	author sthen;	state Exp;
branches;
next	1.73;

1.73
date	2011.06.24.11.16.21;	author sthen;	state Exp;
branches;
next	1.72;

1.72
date	2011.06.22.08.10.26;	author dcoppa;	state Exp;
branches;
next	1.71;

1.71
date	2011.06.04.09.20.36;	author sthen;	state Exp;
branches;
next	1.70;

1.70
date	2011.04.12.22.59.07;	author sthen;	state Exp;
branches;
next	1.69;

1.69
date	2011.03.29.20.01.43;	author edd;	state Exp;
branches;
next	1.68;

1.68
date	2011.02.12.10.48.56;	author jasper;	state Exp;
branches;
next	1.67;

1.67
date	2011.01.15.10.56.51;	author jasper;	state Exp;
branches;
next	1.66;

1.66
date	2010.11.22.10.16.08;	author espie;	state Exp;
branches;
next	1.65;

1.65
date	2010.11.19.09.02.33;	author jasper;	state Exp;
branches;
next	1.64;

1.64
date	2010.11.17.08.05.13;	author espie;	state Exp;
branches;
next	1.63;

1.63
date	2010.10.24.21.21.00;	author ajacoutot;	state Exp;
branches;
next	1.62;

1.62
date	2010.10.18.18.13.13;	author espie;	state Exp;
branches;
next	1.61;

1.61
date	2010.09.20.07.59.59;	author sthen;	state Exp;
branches;
next	1.60;

1.60
date	2010.09.15.15.40.00;	author jakemsr;	state Exp;
branches;
next	1.59;

1.59
date	2010.09.03.16.39.13;	author sthen;	state Exp;
branches;
next	1.58;

1.58
date	2010.08.25.23.27.21;	author sthen;	state Exp;
branches;
next	1.57;

1.57
date	2010.08.20.12.10.52;	author sthen;	state Exp;
branches;
next	1.56;

1.56
date	2010.08.07.22.41.47;	author sthen;	state Exp;
branches;
next	1.55;

1.55
date	2010.07.24.14.50.07;	author jolan;	state Exp;
branches;
next	1.54;

1.54
date	2010.07.10.22.45.19;	author naddy;	state Exp;
branches;
next	1.53;

1.53
date	2010.06.15.10.07.41;	author sebastia;	state Exp;
branches;
next	1.52;

1.52
date	2010.05.26.21.38.52;	author jakemsr;	state Exp;
branches;
next	1.51;

1.51
date	2010.04.26.01.57.13;	author jakemsr;	state Exp;
branches;
next	1.50;

1.50
date	2009.09.02.11.50.56;	author sthen;	state Exp;
branches;
next	1.49;

1.49
date	2009.08.10.06.31.44;	author kili;	state Exp;
branches;
next	1.48;

1.48
date	2009.07.19.22.27.46;	author sthen;	state Exp;
branches;
next	1.47;

1.47
date	2009.07.18.09.06.26;	author sthen;	state Exp;
branches;
next	1.46;

1.46
date	2009.04.14.19.52.08;	author kili;	state Exp;
branches;
next	1.45;

1.45
date	2009.01.29.11.30.27;	author sthen;	state Exp;
branches;
next	1.44;

1.44
date	2009.01.24.11.00.41;	author jakemsr;	state Exp;
branches;
next	1.43;

1.43
date	2009.01.24.10.31.15;	author ajacoutot;	state Exp;
branches;
next	1.42;

1.42
date	2008.12.13.02.58.00;	author jakemsr;	state Exp;
branches;
next	1.41;

1.41
date	2008.09.15.22.06.11;	author jakemsr;	state Exp;
branches;
next	1.40;

1.40
date	2008.09.08.23.28.28;	author brad;	state Exp;
branches;
next	1.39;

1.39
date	2008.09.05.01.10.21;	author brad;	state Exp;
branches;
next	1.38;

1.38
date	2008.07.25.20.25.59;	author sthen;	state Exp;
branches;
next	1.37;

1.37
date	2008.07.22.20.25.17;	author brad;	state Exp;
branches;
next	1.36;

1.36
date	2008.07.09.01.57.44;	author jakemsr;	state Exp;
branches;
next	1.35;

1.35
date	2008.01.30.03.58.52;	author jakemsr;	state Exp;
branches;
next	1.34;

1.34
date	2008.01.26.01.56.02;	author jakemsr;	state Exp;
branches;
next	1.33;

1.33
date	2008.01.04.17.48.35;	author espie;	state Exp;
branches;
next	1.32;

1.32
date	2007.10.19.14.32.57;	author jakemsr;	state Exp;
branches;
next	1.31;

1.31
date	2007.10.10.07.59.32;	author aanriot;	state Exp;
branches;
next	1.30;

1.30
date	2007.09.24.07.51.24;	author jakemsr;	state Exp;
branches;
next	1.29;

1.29
date	2007.09.15.20.09.40;	author simon;	state Exp;
branches;
next	1.28;

1.28
date	2007.06.29.06.15.52;	author jakemsr;	state Exp;
branches;
next	1.27;

1.27
date	2007.05.25.15.54.14;	author jakemsr;	state Exp;
branches;
next	1.26;

1.26
date	2007.03.02.23.38.28;	author kurt;	state Exp;
branches;
next	1.25;

1.25
date	2007.01.26.16.03.20;	author robert;	state Exp;
branches;
next	1.24;

1.24
date	2007.01.23.09.34.45;	author robert;	state Exp;
branches;
next	1.23;

1.23
date	2006.12.02.20.24.17;	author pvalchev;	state Exp;
branches;
next	1.22;

1.22
date	2006.08.02.10.10.35;	author espie;	state Exp;
branches;
next	1.21;

1.21
date	2006.07.31.15.03.15;	author millert;	state Exp;
branches;
next	1.20;

1.20
date	2006.03.22.08.08.42;	author jakemsr;	state Exp;
branches;
next	1.19;

1.19
date	2006.03.20.05.50.49;	author jakemsr;	state Exp;
branches;
next	1.18;

1.18
date	2005.12.31.08.45.56;	author steven;	state Exp;
branches;
next	1.17;

1.17
date	2005.04.20.16.46.54;	author naddy;	state Exp;
branches;
next	1.16;

1.16
date	2005.03.10.03.35.15;	author jolan;	state Exp;
branches;
next	1.15;

1.15
date	2005.02.09.23.41.42;	author naddy;	state Exp;
branches;
next	1.14;

1.14
date	2005.01.16.22.53.17;	author alek;	state Exp;
branches;
next	1.13;

1.13
date	2004.11.30.01.06.34;	author espie;	state Exp;
branches;
next	1.12;

1.12
date	2004.10.13.01.38.21;	author jolan;	state Exp;
branches;
next	1.11;

1.11
date	2004.10.07.06.12.11;	author jolan;	state Exp;
branches;
next	1.10;

1.10
date	2004.07.05.22.07.01;	author jolan;	state Exp;
branches;
next	1.9;

1.9
date	2004.04.18.00.36.22;	author jolan;	state Exp;
branches;
next	1.8;

1.8
date	2003.12.06.13.43.08;	author espie;	state Exp;
branches;
next	1.7;

1.7
date	2003.12.06.13.38.09;	author espie;	state Exp;
branches;
next	1.6;

1.6
date	2003.11.04.07.50.19;	author jolan;	state Exp;
branches;
next	1.5;

1.5
date	2003.09.26.14.40.29;	author jolan;	state Exp;
branches;
next	1.4;

1.4
date	2003.08.15.14.25.08;	author jolan;	state Exp;
branches;
next	1.3;

1.3
date	2003.08.04.06.08.22;	author jolan;	state Exp;
branches;
next	1.2;

1.2
date	2003.08.02.10.26.54;	author jolan;	state Exp;
branches;
next	1.1;

1.1
date	2003.07.19.18.16.34;	author jolan;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2003.07.19.18.16.34;	author jolan;	state Exp;
branches;
next	;

1.76.2.1
date	2011.08.21.16.51.13;	author jasper;	state Exp;
branches;
next	;

1.102.2.1
date	2014.07.17.23.00.27;	author brad;	state Exp;
branches;
next	;
commitid	MJmoxAoL7epFu7cq;

1.122.4.1
date	2016.01.16.09.40.53;	author jasper;	state Exp;
branches;
next	;
commitid	AqY6BdU4BYWn69k6;


desc
@@


1.162
log
@Update to ffmpeg-20170610.

from Brad (maintainer)
@
text
@# $OpenBSD: Makefile,v 1.161 2017/05/31 08:08:16 espie Exp $

COMMENT=	audio/video converter and streamer

V=		20170610
DISTNAME=	ffmpeg-git-${V}
PKGNAME=	ffmpeg-${V}
CATEGORIES=	graphics multimedia
MASTER_SITES=	http://comstyle.com/source/
EXTRACT_SUFX=	.tar.xz

SHARED_LIBS=	avcodec		22.2 \
		avdevice	10.0 \
		avfilter	7.3 \
		avformat	19.4 \
		avresample	1.0 \
		avutil		12.4 \
		postproc	16.1 \
		swresample	1.2 \
		swscale		6.1

HOMEPAGE=	http://ffmpeg.org/

MAINTAINER=	Brad Smith <brad@@comstyle.com>

# LGPLv2.1 and GPLv2
PERMIT_PACKAGE_CDROM=	patents
PERMIT_PACKAGE_FTP=	Yes

WANTLIB=	SDL X11 Xext Xv ass bz2 c crypto fontconfig freetype fribidi \
		gsm m mp3lame opus pthread sndio speex ssl v4l2 vorbis \
		vorbisenc vpx>=5 x264 x265>=2 xcb xcb-shape xcb-shm xcb-xfixes \
		xvidcore z

COMPILER =	clang
MODCLANG_ARCHS=	amd64
COMPILER_LANGS =	c

BUILD_DEPENDS=	textproc/texi2html
.if ${MACHINE_ARCH} == "amd64" || ${MACHINE_ARCH} == "i386"
BUILD_DEPENDS+=	devel/yasm
.endif
LIB_DEPENDS=	archivers/bzip2 \
		audio/lame \
		audio/libvorbis \
		audio/opus \
		audio/speex \
		audio/gsm \
		devel/sdl \
		multimedia/libass \
		multimedia/libv4l \
		multimedia/libvpx>=1.3.0 \
		multimedia/x264 \
		multimedia/x265>=1.5 \
		multimedia/xvidcore

# inter-library dependencies for the current configuration
LIBavcodec_EXTRALIBS=-L${LOCALBASE}/lib -lgsm -lmp3lame -lopus -lspeex -lvorbis -lvorbisenc -lvpx -lx264 -lx265 -lxvidcore -lz -pthread
LIBavdevice_EXTRALIBS=-L${LOCALBASE}/lib -L${X11BASE}/lib -lX11 -lXext -lXv -lxcb-render -lxcb-shape -lxcb-shm -lxcb-xfixes -lxcb -lsndio -lv4l2
LIBavfilter_EXTRALIBS=-L${LOCALBASE}/lib -L${X11BASE}/lib -lass -lfontconfig -lfreetype -lfribidi
LIBavformat_EXTRALIBS=-L${LOCALBASE}/lib -lbz2 -lssl -lcrypto -pthread
LIBavresample_EXTRALIBS=
LIBavutil_EXTRALIBS=-lm -pthread
LIBpostproc_EXTRALIBS=
LIBswresample_EXTRALIBS=-lm
LIBswscale_EXTRALIBS=-lm

.if ${MACHINE_ARCH:Marm}
# uses ARM EABI
FFMPEG_ARCH=	generic
.else
FFMPEG_ARCH=	${MACHINE_ARCH}
.endif

OPTFLAGS=	${CFLAGS}

# until the system headers are fixed properly.
OPTFLAGS+=	-Wno-redundant-decls

USE_GMAKE=	Yes
CONFIGURE_STYLE= simple
CONFIGURE_ARGS+= --enable-shared \
		--arch=${FFMPEG_ARCH} \
		--cc=${CC} \
		--disable-altivec \
		--disable-armv5te \
		--disable-armv6 \
		--disable-armv6t2 \
		--disable-debug \
		--disable-iconv \
		--disable-indev=jack \
		--disable-indev=oss \
		--disable-lzma \
		--disable-mips32r5 \
		--disable-mips64r6 \
		--disable-mipsdspr1 \
		--disable-mipsdspr2 \
		--disable-mipsfpu \
		--disable-mmi \
		--disable-msa \
		--disable-neon \
		--disable-outdev=oss \
		--disable-outdev=sdl \
		--disable-vfp \
		--enable-avresample \
		--enable-fontconfig \
		--enable-gpl \
		--enable-libass \
		--enable-libfreetype \
		--enable-libfribidi \
		--enable-libgsm \
		--enable-libmp3lame \
		--enable-libopus \
		--enable-libspeex \
		--enable-libv4l2 \
		--enable-libvorbis \
		--enable-libvpx \
		--enable-libx264 \
		--enable-libx265 \
		--enable-libxvid \
		--enable-nonfree \
		--enable-openssl \
		--extra-cflags="-I${LOCALBASE}/include -I${X11BASE}/include" \
		--extra-libs="-L${LOCALBASE}/lib -L${X11BASE}/lib" \
		--mandir=${PREFIX}/man \
		--optflags="${OPTFLAGS}"

CONFIGURE_ENV+=	LIBavcodec_EXTRALIBS="${LIBavcodec_EXTRALIBS}" \
		LIBavdevice_EXTRALIBS="${LIBavdevice_EXTRALIBS}" \
		LIBavfilter_EXTRALIBS="${LIBavfilter_EXTRALIBS}" \
		LIBavformat_EXTRALIBS="${LIBavformat_EXTRALIBS}" \
		LIBavresample_EXTRALIBS="${LIBavresample_EXTRALIBS}" \
		LIBavutil_EXTRALIBS="${LIBavutil_EXTRALIBS}" \
		LIBpostproc_EXTRALIBS="${LIBpostproc_EXTRALIBS}" \
		LIBswresample_EXTRALIBS="${LIBswresample_EXTRALIBS}" \
		LIBswscale_EXTRALIBS="${LIBswscale_EXTRALIBS}" \
		LIBavcodec_LINKFLAGS="-Wl,-rpath-link,${LOCALBASE}/lib" \
		LIBavdevice_LINKFLAGS="-Wl,-rpath-link,${LOCALBASE}/lib:${X11BASE}/lib" \
		LIBavfilter_LINKFLAGS="-Wl,-rpath-link,${LOCALBASE}/lib:${X11BASE}/lib" \
		LIBavformat_LINKFLAGS="-Wl,-rpath-link,${LOCALBASE}/lib" \
		LIBavresample_LINKFLAGS="" \
		LIBavutil_LINKFLAGS="" \
		LIBpostproc_LINKFLAGS="" \
		LIBswresample_LINKFLAGS="" \
		LIBswscale_LINKFLAGS="" \
		LIBavcodec_REQUIRES="libavutil libswresample opus speex vpx x264 x265" \
		LIBavdevice_REQUIRES="libavcodec libavfilter libavformat libavutil libpostproc libswresample libswscale" \
		LIBavfilter_REQUIRES="libavcodec libavformat libavresample libavutil libpostproc libswresample libswscale" \
		LIBavformat_REQUIRES="libavcodec libavutil libswresample" \
		LIBavresample_REQUIRES="libavutil" \
		LIBavutil_REQUIRES="" \
		LIBpostproc_REQUIRES="libavutil" \
		LIBswresample_REQUIRES="libavutil" \
		LIBswscale_REQUIRES="libavutil" \
		TMPDIR=${WRKBUILD}

VERSION_FLAGS=	libavcodec_VERSION=${LIBavcodec_VERSION} \
		libavdevice_VERSION=${LIBavdevice_VERSION} \
		libavfilter_VERSION=${LIBavfilter_VERSION} \
		libavformat_VERSION=${LIBavformat_VERSION} \
		libavresample_VERSION=${LIBavresample_VERSION} \
		libavutil_VERSION=${LIBavutil_VERSION} \
		libpostproc_VERSION=${LIBpostproc_VERSION} \
		libswresample_VERSION=${LIBswresample_VERSION} \
		libswscale_VERSION=${LIBswscale_VERSION}

MAKE_ENV=	V=1

MAKE_FLAGS=	${VERSION_FLAGS} \
		LIBavcodec_EXTRALIBS="-lavutil -lswresample ${LIBavcodec_EXTRALIBS}" \
		LIBavdevice_EXTRALIBS="-lavcodec -lavfilter -lavformat -lavutil -lpostproc -lswresample -lswscale ${LIBavdevice_EXTRALIBS}" \
		LIBavfilter_EXTRALIBS="-lavcodec -lavformat -lavresample -lavutil -lpostproc -lswresample -lswscale ${LIBavfilter_EXTRALIBS}" \
		LIBavformat_EXTRALIBS="-lavcodec -lavutil -lswresample ${LIBavformat_EXTRALIBS}" \
		LIBavresample_EXTRALIBS="-lavutil ${LIBavresample_EXTRALIBS}" \
		LIBavutil_EXTRALIBS="${LIBavutil_EXTRALIBS}" \
		LIBpostproc_EXTRALIBS="-lavutil ${LIBpostproc_EXTRALIBS}" \
		LIBswresample_EXTRALIBS="-lavutil ${LIBswresample_EXTRALIBS}" \
		LIBswscale_EXTRALIBS="-lavutil ${LIBswscale_EXTRALIBS}"
FAKE_FLAGS=	${VERSION_FLAGS} \
		LDCONFIG=true

.ifdef DEBUG
CONFIGURE_ARGS+=--disable-stripping
.endif

ALL_TARGET=	all tools/qt-faststart
TEST_TARGET=	check

HTML_DOCS=	developer faq ffmpeg ffplay ffprobe ffserver general libavfilter

post-install:
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/ffmpeg
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/ffmpeg
	${INSTALL_PROGRAM} ${WRKBUILD}/tools/qt-faststart ${PREFIX}/bin
.for doc in ${HTML_DOCS}
	${INSTALL_DATA} ${WRKBUILD}/doc/${doc}.html ${PREFIX}/share/doc/ffmpeg
.endfor
	${INSTALL_DATA} ${WRKBUILD}/doc/ffserver.conf \
		${PREFIX}/share/examples/ffmpeg

.include <bsd.port.mk>
@


1.161
log
@switch everything to new COMPILER idiom, even stuff that won't build with clang
yet, but at least that part is done.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.160 2017/05/28 11:59:52 zhuk Exp $
d5 1
a5 1
V=		20170208
a10 1
REVISION=	0
@


1.160
log
@Bump, to be on a safe side after fixing resulting plist.

okay espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.159 2017/05/28 11:52:06 espie Exp $
d36 1
a36 2
WANT_CXX =	base clang

d38 1
a38 1
MODCLANG_LANGS=	c
@


1.159
log
@stupid typo
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.158 2017/05/27 04:54:31 espie Exp $
d11 1
@


1.158
log
@WANT_CXX
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.157 2017/02/09 12:58:03 ajacoutot Exp $
d38 1
a38 1
MODCLANG_LANG=	c
@


1.157
log
@Update to ffmpeg-20170208.

from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.156 2017/02/05 21:23:00 sthen Exp $
d35 1
a35 1
MODULES=	lang/clang
d38 1
@


1.156
log
@Change FFmpeg's TLS support to use SSLv23_*_method (allowing any
supported SSL/TLS version, in our case this is TLS1.0+) instead of the
confusingly-named TLSv1_*_method (TLSv1.0 only). Fixes e.g. "mplayer
https://ftp.openbsd.org/pub/OpenBSD/songs/song53.mp3". OK Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.155 2016/12/26 09:29:21 ajacoutot Exp $
d5 1
a5 1
V=		20161210
a7 1
REVISION=	1
@


1.155
log
@doc/muxers: remove "-strict experimental" from tee muxer examples

from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.154 2016/12/11 09:27:53 ajacoutot Exp $
d8 1
a8 1
REVISION=	0
@


1.154
log
@Update to ffmpeg-20161210.

from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.153 2016/12/05 09:02:29 ajacoutot Exp $
d8 1
@


1.153
log
@Update to ffmpeg-20161203.

from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.152 2016/10/17 07:51:00 ajacoutot Exp $
d5 1
a5 1
V=		20161203
@


1.152
log
@Some more AAC fixes.

from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.151 2016/10/08 17:50:46 ajacoutot Exp $
d5 1
a5 1
V=		20161008
a7 1
REVISION=	0
@


1.151
log
@SECURITY update to ffmpeg-20161008.
CVE-2016-7562, CVE-2016-7122, CVE-2016-7450, CVE-2016-7502, CVE-2016-7555, CVE-2016-7785, CVE-2016-7905

from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.150 2016/09/06 12:37:11 ajacoutot Exp $
d8 1
@


1.150
log
@Update to ffmpeg-20160903.

from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.149 2016/05/03 06:05:49 ajacoutot Exp $
d5 1
a5 1
V=		20160903
@


1.149
log
@Update to a newer snapshot: ffmpeg-20160502.

from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.148 2016/04/07 06:01:19 ajacoutot Exp $
d5 1
a5 1
V=		20160502
@


1.148
log
@More AAC support improvement.

from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.147 2016/03/10 20:41:22 naddy Exp $
d5 1
a5 1
V=		20160113
a7 1
REVISION=	7
@


1.147
log
@requires --enable-shared
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.146 2016/03/09 17:29:36 ajacoutot Exp $
d8 1
a8 1
REVISION=	6
@


1.146
log
@Moar AAC.

from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.145 2016/03/07 07:11:35 ajacoutot Exp $
d83 1
a83 1
CONFIGURE_ARGS+= ${CONFIGURE_SHARED} \
@


1.145
log
@Merge some more AAC fixes.

from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.144 2016/02/25 03:53:53 ajacoutot Exp $
d8 1
a8 1
REVISION=	5
@


1.144
log
@aacenc: make a better estimate for the audio bitrate if not provided
aacenc: temporarily disable Mid/Side coding with multichannel files

from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.143 2016/01/23 14:12:28 ajacoutot Exp $
d8 1
a8 1
REVISION=	4
@


1.143
log
@Enable the libv4l support.

from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.142 2016/01/22 07:05:01 ajacoutot Exp $
d8 1
a8 1
REVISION=	3
@


1.142
log
@Yet again mor AAC fixes.

from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.141 2016/01/18 15:34:45 ajacoutot Exp $
d8 1
a8 1
REVISION=	2
d32 3
a34 2
		gsm m mp3lame opus pthread sndio speex ssl vorbis vorbisenc \
		vpx>=5 x264 x265>=2 xcb xcb-shape xcb-shm xcb-xfixes xvidcore z
d52 1
d60 1
a60 1
LIBavdevice_EXTRALIBS=-L${X11BASE}/lib -lX11 -lXext -lXv -lxcb-render -lxcb-shape -lxcb-shm -lxcb-xfixes -lxcb -lsndio
d116 1
@


1.141
log
@Moar AAC.

from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.140 2016/01/16 09:01:26 ajacoutot Exp $
d8 1
a8 1
REVISION=	1
@


1.140
log
@SECURITY fix for the AppleHTTP / HLS demuxers.
CVE-2016-1897 and CVE-2016-1898

from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.139 2016/01/14 06:09:43 ajacoutot Exp $
d8 1
a8 1
REVISION=	0
@


1.139
log
@Update to ffmpeg-20160113.

from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.138 2015/12/17 09:54:33 ajacoutot Exp $
d8 1
@


1.138
log
@Remove MIPS -Bsymbolic workaround now that the linker has been fixed.

from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.137 2015/12/10 06:53:38 ajacoutot Exp $
d5 1
a5 1
V=		20151112
a7 1
REVISION=	2
@


1.137
log
@Moar AAC fixes.

from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.136 2015/12/06 08:51:46 ajacoutot Exp $
d8 1
a8 1
REVISION=	1
@


1.136
log
@More AAC bits and remove the experimental status for the encoder.

from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.135 2015/11/16 06:36:55 ajacoutot Exp $
d8 1
a8 1
REVISION=	0
@


1.135
log
@Update to FFmpeg 20151112 (2.8.2).

from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.134 2015/11/13 07:03:00 ajacoutot Exp $
d8 1
@


1.134
log
@Backport some AAC and VPX commits.

from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.133 2015/10/25 08:46:41 ajacoutot Exp $
d5 1
a5 1
V=		20150909
a7 1
REVISION=	10
@


1.133
log
@More AAC fixes.

from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.132 2015/10/17 06:49:22 ajacoutot Exp $
d8 1
a8 1
REVISION=	9
@


1.132
log
@Guess what... more AAC stuffs.

from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.131 2015/10/13 05:44:18 ajacoutot Exp $
d8 1
a8 1
REVISION=	8
@


1.131
log
@Some more AAC stuffs.

from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.130 2015/10/03 19:39:47 sthen Exp $
d8 1
a8 1
REVISION=	7
@


1.130
log
@backport an FFmpeg fix for problems with some cases of HLS streams
requiring cookies.  ok brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.129 2015/10/01 15:14:49 ajacoutot Exp $
d8 1
a8 1
REVISION=	6
@


1.129
log
@Re-enable x265 everywhere.

from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.128 2015/09/27 06:35:33 ajacoutot Exp $
d8 1
a8 1
REVISION=	5
@


1.128
log
@Some more AAC stuffs.

from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.127 2015/09/23 09:16:45 ajacoutot Exp $
d8 1
a8 1
REVISION=	4
d33 1
a33 1
		vpx>=5 x264 xcb xcb-shape xcb-shm xcb-xfixes xvidcore z
d53 1
d57 1
a73 12
# x265 only builds on archs with working builtin 32-bit atomics
.if ${MACHINE_ARCH} == "alpha" || ${MACHINE_ARCH} == "amd64" || ${MACHINE_ARCH} == "i386" || ${MACHINE_ARCH} == "powerpc" || ${MACHINE_ARCH} == "sparc64"
LIB_DEPENDS+=	multimedia/x265>=1.5
WANTLIB+=	x265>=2
CONFIGURE_ARGS+=	--enable-libx265
CONFIGURE_ENV+=		LIBavcodec_REQUIRES="libavutil libswresample opus speex vpx x264 x265"
LIBavcodec_EXTRALIBS=-L${LOCALBASE}/lib -lgsm -lmp3lame -lopus -lspeex -lvorbis -lvorbisenc -lvpx -lx264 -lx265 -lxvidcore -lz -pthread
.else
CONFIGURE_ENV+=		LIBavcodec_REQUIRES="libavutil libswresample opus speex vpx x264"
LIBavcodec_EXTRALIBS=-L${LOCALBASE}/lib -lgsm -lmp3lame -lopus -lspeex -lvorbis -lvorbisenc -lvpx -lx264 -lxvidcore -lz -pthread
.endif

d117 1
d144 1
@


1.127
log
@Yet again more AAC encoder fixes.

from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.126 2015/09/19 18:21:15 ajacoutot Exp $
d8 1
a8 1
REVISION=	3
@


1.126
log
@Back port anohter bug fix for the AAC encoder.

from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.125 2015/09/15 12:49:42 ajacoutot Exp $
d8 1
a8 1
REVISION=	2
@


1.125
log
@Back port some more AAC encoder fixes.

from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.124 2015/09/12 09:44:54 ajacoutot Exp $
d8 1
a8 1
REVISION=	1
@


1.124
log
@Back port some AAC encoder fixes.

from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.123 2015/09/10 07:10:04 ajacoutot Exp $
d8 1
a8 1
REVISION=	0
@


1.123
log
@Update to ffmpeg-20150909.

from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.122 2015/08/01 07:50:25 jasper Exp $
d8 1
@


1.122
log
@- unbreak on mips64 with gcc 4.2 (similar patch has been merged upstream by now)
- also add --disable-mipsfpu to prevent 'illegal instructions'

from Donovan Watteau
ok brad (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.121 2015/07/26 07:22:15 ajacoutot Exp $
d5 1
a5 1
V=		20150723
a7 1
REVISION=	0
d12 1
a12 1
SHARED_LIBS=	avcodec		22.1 \
d14 2
a15 2
		avfilter	7.2 \
		avformat	19.3 \
d17 1
a17 1
		avutil		12.3 \
a100 1
		--disable-loongson3 \
d107 1
@


1.122.4.1
log
@SECURITY fix for the AppleHTTP / HLS demuxers.
CVE-2016-1897 and CVE-2016-1898
from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.122 2015/08/01 07:50:25 jasper Exp $
d8 1
a8 1
REVISION=	1
@


1.121
log
@Update to FFmpeg 20150723 (2.7.2).

from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.120 2015/07/12 16:19:38 ajacoutot Exp $
d8 1
d108 1
@


1.120
log
@Revert previous ("Build with Clang on i386.").
Several reports on ports@@ mentionned it breaks at runtime.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.119 2015/06/29 06:19:32 ajacoutot Exp $
d5 1
a5 1
V=		20150609
a7 1
REVISION=	1
@


1.119
log
@Build with Clang on i386.

from brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.118 2015/06/10 06:34:45 ajacoutot Exp $
d8 1
a8 1
REVISION=	0
d37 1
a37 1
MODCLANG_ARCHS=	amd64 i386
@


1.118
log
@Update to ffmpeg-20150609.

from brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.117 2015/05/22 05:41:22 ajacoutot Exp $
d8 1
d37 1
a37 1
MODCLANG_ARCHS=	amd64
@


1.117
log
@Correct the pkgconfig bits and re-add the use of the -Bsymbolic flag.

from brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.116 2015/05/16 07:10:30 ajacoutot Exp $
d5 1
a5 1
V=		20150412
a7 1
REVISION=	3
d12 1
a12 1
SHARED_LIBS=	avcodec		22.0 \
d14 2
a15 2
		avfilter	7.1 \
		avformat	19.2 \
d17 1
a17 1
		avutil		12.2 \
d19 1
a19 1
		swresample	1.1 \
a36 1
MODCLANG_LANGS=	c
d101 1
d103 2
d107 1
@


1.116
log
@Add libass support.

req. by and ok schwarze@@
from and ok brad@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.115 2015/05/05 16:04:18 ajacoutot Exp $
d8 1
a8 1
REVISION=	2
@


1.115
log
@Just use WRKBUILD for the TMPDIR.

from brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.114 2015/05/01 08:41:30 ajacoutot Exp $
d8 1
a8 1
REVISION=	1
d31 3
a33 3
WANTLIB=	SDL X11 Xext Xv bz2 c crypto gsm m mp3lame opus pthread \
		sndio speex ssl vorbis vorbisenc vpx>=5 x264 xcb xcb-shape \
		xcb-shm xcb-xfixes xvidcore z \
d51 1
d58 1
a58 1
LIBavfilter_EXTRALIBS=
d111 1
d113 3
d140 4
a143 4
		LIBavcodec_LINKFLAGS="" \
		LIBavdevice_LINKFLAGS="-Wl,-rpath-link,${X11BASE}/lib" \
		LIBavfilter_LINKFLAGS="" \
		LIBavformat_LINKFLAGS="" \
@


1.114
log
@Disable some AVX / FMA3 SIMD functions which are currently crashing VLC
when using DTS or some AAC audio.

from brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.113 2015/04/28 07:13:15 ajacoutot Exp $
a64 3
# configure wants a directory it can execute files in 
WRKTMP=		${WRKDIR}/tmp

d152 1
a152 1
		TMPDIR=${WRKTMP}
a186 3

pre-configure:
	@@mkdir -p ${WRKTMP}
@


1.113
log
@Backport a fix from upstream to quiet a warning when using the libvpx
encoder with VP9.

from brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.112 2015/04/28 06:32:47 ajacoutot Exp $
d8 1
a8 1
REVISION=	0
@


1.112
log
@Update to FFmpeg 20150412: a snapshot from the 2.6 branch currently at the 2.6.2
release.

Two of the lib dependencies got removed:
- libschroedinger: currently broken because of an issue with mutexes;
unmaintained upstream and its a niche codec
- libtheora: modern replacements such as VP8 / VP9 are more than good enough to
replace VP3 use

from brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.111 2015/02/17 01:28:52 brad Exp $
d8 1
@


1.111
log
@Enable x265 on PowerPC since as of 1.5 it now works.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.110 2015/01/10 10:46:37 brad Exp $
d5 1
a5 1
V=		20150107
a7 1
REVISION=	0
d12 4
a15 4
SHARED_LIBS=	avcodec		21.1 \
		avdevice	9.0 \
		avfilter	7.0 \
		avformat	19.1 \
d17 2
a18 2
		avutil		12.1 \
		postproc	16.0 \
d20 1
a20 1
		swscale		6.0
d30 3
a32 3
WANTLIB=	SDL X11 Xext Xfixes Xv bz2 c crypto gsm m mp3lame opus pthread \
		schroedinger-1.0 sndio speex ssl theoradec theoraenc vorbis \
		vorbisenc vpx>=5 x264 xvidcore z
a49 1
		multimedia/libtheora \
a50 1
		multimedia/schroedinger \
d55 1
a55 1
LIBavdevice_EXTRALIBS=-L${X11BASE}/lib -lX11 -lXext -lXfixes -lXv -lsndio
d79 2
a80 2
CONFIGURE_ENV+=		LIBavcodec_REQUIRES="libavutil libswresample opus schroedinger-1.0 speex theoraenc vpx x264 x265"
LIBavcodec_EXTRALIBS=-L${LOCALBASE}/lib -lgsm -lmp3lame -lopus -lschroedinger-1.0 -lspeex -ltheoradec -ltheoraenc -lvorbis -lvorbisenc -lvpx -lx264 -lx265 -lxvidcore -lz -pthread
d82 2
a83 2
CONFIGURE_ENV+=		LIBavcodec_REQUIRES="libavutil libswresample opus schroedinger-1.0 speex theoraenc vpx x264"
LIBavcodec_EXTRALIBS=-L${LOCALBASE}/lib -lgsm -lmp3lame -lopus -lschroedinger-1.0 -lspeex -ltheoradec -ltheoraenc -lvorbis -lvorbisenc -lvpx -lx264 -lxvidcore -lz -pthread
a104 1
		--disable-mips32r2 \
a115 1
		--enable-libschroedinger \
a116 1
		--enable-libtheora \
a122 1
		--enable-x11grab \
@


1.110
log
@Update to FFmpeg 20150107 snapshot. From 2.4 branch.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.109 2014/11/04 09:31:01 landry Exp $
d8 1
d77 4
a80 4
# x265 only builds on archs with working builtin atomics
.if ${MACHINE_ARCH} == "alpha" || ${MACHINE_ARCH} == "amd64" || ${MACHINE_ARCH} == "i386" || ${MACHINE_ARCH} == "sparc64"
LIB_DEPENDS+=	multimedia/x265
WANTLIB+=	x265
@


1.109
log
@Only enable x265 support on architectures where it actually builds (ie
so far alpha/amd64/i386/sparc64) to unbreak half of the tree (mplayer,
etc..) on other archs like ppc/mips64*.
Tested on amd64 & ppc.
ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.108 2014/10/23 07:41:45 brad Exp $
d5 1
a5 1
V=		20141010
a7 1
REVISION=	1
d30 3
a32 4
WANTLIB=	SDL X11 Xext Xfixes Xv bz2 c crypto gsm m mp3lame opus \
		pthread schroedinger-1.0>=2 sndio speex ssl theoradec \
		theoraenc vorbis vorbisenc vpx>=5 x264>=8 xvidcore \
		z
d52 2
a53 2
		multimedia/schroedinger>=1.0.10 \
		multimedia/x264>=20111027 \
d77 5
a81 5
.if ${MACHINE_ARCH} == "amd64" || ${MACHINE_ARCH} == "i386" || ${MACHINE_ARCH} == "sparc64" || ${MACHINE_ARCH} == "alpha"
LIB_DEPENDS +=	multimedia/x265
WANTLIB +=	x265
CONFIGURE_ARGS +=	--enable-libx265
CONFIGURE_ENV +=	LIBavcodec_REQUIRES="libavutil libswresample opus schroedinger-1.0 speex theoraenc vpx x264 x265"
d84 1
a84 1
CONFIGURE_ENV +=	LIBavcodec_REQUIRES="libavutil libswresample opus schroedinger-1.0 speex theoraenc vpx x264"
@


1.108
log
@Fix the configure script to be able to detect the presence of the
V4L2 VIDIOC_ENUM_FRAMESIZES ioctl and make use of it on OpenBSD.

Pushed upstream and commited.

From armani@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.107 2014/10/19 23:14:23 brad Exp $
d8 1
a8 1
REVISION=	0
d33 1
a33 1
		theoraenc vorbis vorbisenc vpx>=5 x264>=8 x265 xvidcore \
a55 1
		multimedia/x265 \
a58 1
LIBavcodec_EXTRALIBS=-L${LOCALBASE}/lib -lgsm -lmp3lame -lopus -lschroedinger-1.0 -lspeex -ltheoradec -ltheoraenc -lvorbis -lvorbisenc -lvpx -lx264 -lx265 -lxvidcore -lz -pthread
d78 12
a126 1
		--enable-libx265 \
a153 1
		LIBavcodec_REQUIRES="libavutil libswresample opus schroedinger-1.0 speex theoraenc vpx x264 x265" \
@


1.107
log
@Update to FFmpeg 20141010 snapshot. From 2.4 branch.

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.106 2014/09/04 05:49:49 brad Exp $
d8 1
@


1.106
log
@Enable the x265 support.

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.105 2014/08/14 08:20:27 brad Exp $
d5 1
a5 1
V=		20140810
a7 1
REVISION=	0
d12 1
a12 1
SHARED_LIBS=	avcodec		21.0 \
d15 1
a15 1
		avformat	19.0 \
d17 1
a17 1
		avutil		12.0 \
d19 1
a19 1
		swresample	1.0 \
d35 5
d97 1
@


1.105
log
@Update to FFmpeg 20140810 snapshot. From master branch.

ok ajacoutot@@ zhuk@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.104 2014/07/25 20:37:58 brad Exp $
d8 1
d33 2
a34 1
		theoraenc vorbis vorbisenc vpx>=5 x264>=8 xvidcore z
d51 1
d55 1
a55 1
LIBavcodec_EXTRALIBS=-L${LOCALBASE}/lib -lgsm -lmp3lame -lopus -lschroedinger-1.0 -lspeex -ltheoradec -ltheoraenc -lvorbis -lvorbisenc -lvpx -lx264 -lxvidcore -lz -pthread
d111 1
d139 1
a139 1
		LIBavcodec_REQUIRES="libavutil libswresample opus schroedinger-1.0 speex theoraenc vpx x264" \
@


1.104
log
@Fix LZO integer overflow issues. CVE-2014-4610

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.103 2014/05/16 01:34:50 brad Exp $
d5 1
a5 1
V=		20140412
a7 1
REVISION=	0
d12 9
a20 9
SHARED_LIBS=	avcodec		20.0 \
		avdevice	8.0 \
		avfilter	6.0 \
		avformat	18.0 \
		avresample	0.1 \
		avutil		11.2 \
		postproc	15.2 \
		swresample	0.2 \
		swscale		5.2
d135 2
a136 2
		LIBavcodec_REQUIRES="libavutil opus schroedinger-1.0 speex theoraenc vpx x264" \
		LIBavdevice_REQUIRES="libavcodec libavfilter libavformat libavutil" \
d138 1
a138 1
		LIBavformat_REQUIRES="libavcodec libavutil" \
d159 2
a160 2
		LIBavcodec_EXTRALIBS="-lavutil ${LIBavcodec_EXTRALIBS}" \
		LIBavdevice_EXTRALIBS="-lavcodec -lavfilter -lavformat -lavutil ${LIBavdevice_EXTRALIBS}" \
d162 1
a162 1
		LIBavformat_EXTRALIBS="-lavcodec -lavutil ${LIBavformat_EXTRALIBS}" \
a178 3

post-extract:
	@@rm ${WRKSRC}/VERSION
@


1.103
log
@Update to FFmpeg 20140412 snapshot. From 2.2 branch.

Update to MPlayer 20140412 snapshot.

Take MAINTAINER for MPlayer. ok edd@@

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.102 2013/12/28 00:40:05 brad Exp $
d8 1
@


1.102
log
@Some fixes for libavresample.

ok rpe@@ juanfra@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.101 2013/12/24 15:22:55 brad Exp $
d5 1
a5 1
V=		20131216
a7 1
REVISION=	0
d12 9
a20 9
SHARED_LIBS=	avcodec		19.1 \
		avdevice	7.1 \
		avfilter	5.1 \
		avformat	17.1 \
		avresample	0.0 \
		avutil		11.1 \
		postproc	15.1 \
		swresample	0.1 \
		swscale		5.1
d30 1
a30 1
WANTLIB=	SDL X11 Xext Xfixes bz2 c crypto gsm m mp3lame opus \
d32 1
a32 1
		theoraenc vorbis vorbisenc vpx x264>=8 xvidcore z
d46 1
a46 1
		multimedia/libvpx \
d53 1
a53 1
LIBavdevice_EXTRALIBS=-L${X11BASE}/lib -lX11 -lXext -lXfixes -lsndio
d57 1
a57 1
LIBavutil_EXTRALIBS=-lm
@


1.102.2.1
log
@Fix LZO integer overflow issues. CVE-2014-4610

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.102 2013/12/28 00:40:05 brad Exp $
d8 1
a8 1
REVISION=	1
@


1.101
log
@Update to FFmpeg 20131216 snapshot. From 1.2 branch.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.100 2013/08/19 14:38:29 brad Exp $
d8 1
d138 1
a138 1
		LIBavfilter_REQUIRES="libavcodec libavformat libavutil libpostproc libswresample libswscale" \
d162 1
a162 1
		LIBavfilter_EXTRALIBS="-lavcodec -lavformat -lavutil -lpostproc -lswresample -lswscale ${LIBavfilter_EXTRALIBS}" \
@


1.100
log
@Update to FFmpeg 20130718 snapshot. From 1.2 branch.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.99 2013/04/14 21:10:49 brad Exp $
d5 1
a5 1
V=		20130718
d16 1
d56 1
d97 1
d121 1
d130 1
d139 1
d150 1
d163 1
@


1.99
log
@The testsuite was fixed within the last 3 years to work with swscale
which has been the norm for that long so enable it.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.98 2013/04/08 17:06:55 brad Exp $
d5 1
a5 1
V=		20130319
@


1.98
log
@Update to FFmpeg 20130319 snapshot. From 1.2 branch.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.97 2013/03/13 02:26:44 brad Exp $
d168 1
a168 3

# regression tests incompatible with libswscale
NO_TEST=	Yes
@


1.97
log
@Update to FFmpeg 20130214 snapshot. From 1.1 branch.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.96 2013/03/11 11:10:52 espie Exp $
d5 1
a5 1
V=		20130214
d12 5
a16 5
SHARED_LIBS=	avcodec		19.0 \
		avdevice	7.0 \
		avfilter	5.0 \
		avformat	17.0 \
		avutil		11.0 \
d19 1
a19 1
		swscale		5.0
d85 1
@


1.96
log
@PERMIT_* / REGRESS -> TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.95 2013/01/25 09:46:22 brad Exp $
d5 1
a5 1
V=		20121026
a7 1
REVISION=	2
d12 7
a18 7
SHARED_LIBS=	avcodec		18.0 \
		avdevice	6.0 \
		avfilter	4.0 \
		avformat	16.0 \
		avutil		10.0 \
		postproc	15.0 \
		swresample	0.0 \
d29 3
a31 3
WANTLIB=	SDL X11 Xext Xfixes bz2 c crypto gsm m mp3lame pthread \
		schroedinger-1.0>=2 sndio speex ssl theoradec theoraenc \
		vorbis vorbisenc vpx x264>=8 xvidcore z
d40 1
d51 1
a51 1
LIBavcodec_EXTRALIBS=-L${LOCALBASE}/lib -lgsm -lmp3lame -lschroedinger-1.0 -lspeex -ltheoradec -ltheoraenc -lvorbis -lvorbisenc -lvpx -lx264 -lxvidcore -lz -pthread
a83 1
		--disable-armvfp \
d87 3
a89 1
		--disable-iwmmxt \
d93 1
d97 1
a106 1
		--enable-runtime-cpudetect \
d129 3
a131 3
		LIBavcodec_REQUIRES="libavutil schroedinger-1.0 speex theoraenc vpx x264" \
		LIBavdevice_REQUIRES="libavformat libavcodec libavfilter libavutil" \
		LIBavfilter_REQUIRES="libavformat libavcodec libavutil libswresample libswscale" \
d152 2
a153 2
		LIBavdevice_EXTRALIBS="-lavformat -lavcodec -lavfilter -lavutil ${LIBavdevice_EXTRALIBS}" \
		LIBavfilter_EXTRALIBS="-lavformat -lavcodec -lavutil -lswresample -lswscale ${LIBavfilter_EXTRALIBS}" \
@


1.95
log
@- Remove the --disable-avx flag as I found out after speaking to Antoine
  about Libav that digging into the CPU run-time detection code that the
  AVX support has an OS level check unlike the SSE code so it is safe.
- Revert back to not using the -Bsymbolic linker flag as was done for
  quite some time to workaround an issue with pthreads but enabling it
  exposed a bug with the mips64 linker and I'd rather do this consistently
  across all archs as was done before instead of only for mips64 as has
  been proposed.
- sync the libgsm hacking with my submitted diff from upstream.

ok ajacoutot@@ sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.94 2013/01/20 07:46:16 brad Exp $
a28 2
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
d167 1
a167 1
NO_REGRESS=	Yes
@


1.94
log
@Remove a hack for FFmpeg/Libav to workaround an assembler bug now that it
has been fixed.

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.93 2013/01/16 01:02:03 brad Exp $
d8 1
a8 1
REVISION=	1
a86 1
		--disable-avx \
@


1.93
log
@Disable the AVX support since it cannot be used yet on OpenBSD.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.92 2013/01/14 02:14:41 brad Exp $
d8 1
a8 1
REVISION=	0
@


1.92
log
@Update to FFmpeg 20121026 snapshot. From 0.10 branch.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.91 2013/01/08 10:13:13 brad Exp $
d8 1
d87 1
@


1.91
log
@- Fix generated libavcodec pkgc-config file for static linking.
- sync distinfo.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.90 2012/09/12 08:15:57 ajacoutot Exp $
d5 1
a5 1
V=		20120610
a7 1
REVISION=	2
d12 8
a19 7
SHARED_LIBS=	avcodec		17.0 \
		avdevice	5.0 \
		avfilter	3.0 \
		avformat	15.0 \
		avutil		9.0 \
		postproc	14.0 \
		swscale		4.0
d31 2
a32 2
WANTLIB=	SDL X11 Xext Xfixes bz2 c gsm m mp3lame pthread \
		schroedinger-1.0>=2 sndio speex theoradec theoraenc \
d55 1
a55 1
LIBavformat_EXTRALIBS=-L${LOCALBASE}/lib -lbz2
d58 1
d71 5
d103 2
d109 2
a110 1
		--mandir=${PREFIX}/man
d118 1
d126 1
d129 2
a130 2
		LIBavdevice_REQUIRES="libavformat libavcodec libavutil" \
		LIBavfilter_REQUIRES="libavformat libavcodec libavutil libswscale" \
d134 1
d144 1
d151 2
a152 2
		LIBavdevice_EXTRALIBS="-lavformat -lavcodec -lavutil ${LIBavdevice_EXTRALIBS}" \
		LIBavfilter_EXTRALIBS="-lavformat -lavcodec -lavutil -lswscale ${LIBavfilter_EXTRALIBS}" \
d156 1
d179 1
a181 1
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/ffmpeg
@


1.90
log
@* Remove bogus use of -rpath and replace with utilization of the
  -rpath-link linker flag
* Remove unnecessary patch for ffplay

from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.89 2012/09/04 06:31:08 ajacoutot Exp $
d8 1
a8 1
REVISION=	1
d52 1
a52 1
LIBavcodec_EXTRALIBS=-L${LOCALBASE}/lib -lgsm -lmp3lame -logg -lorc-0.4 -lschroedinger-1.0 -lspeex -ltheoradec -ltheoraenc -lvorbis -lvorbisenc -lvpx -lx264 -lxvidcore -lz -pthread
d117 7
@


1.89
log
@Keep --as-needed and remove pthread linking hacks.
Fix the pkg-config file.

from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.88 2012/06/18 16:44:53 jasper Exp $
d8 1
a8 1
REVISION=	0
d52 2
a53 2
LIBavcodec_EXTRALIBS=-L${LOCALBASE}/lib -Wl,-rpath,${LOCALBASE}/lib -lgsm -lmp3lame -logg -lorc-0.4 -lschroedinger-1.0 -lspeex -ltheoradec -ltheoraenc -lvorbis -lvorbisenc -lvpx -lx264 -lxvidcore -lz -pthread
LIBavdevice_EXTRALIBS=-L${X11BASE}/lib -Wl,-rpath,${X11BASE}/lib -lX11 -lXext -lXfixes -lsndio
d110 7
@


1.88
log
@- update to 20120610, various bug fixes

from brad (MAINTAINER)
ok dcoppa@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.87 2012/06/09 23:05:49 sthen Exp $
d8 1
d31 3
a33 3
WANTLIB=	SDL X11 Xext Xfixes bz2 c gsm m mp3lame ogg orc-0.4 \
		pthread schroedinger-1.0>=2 sndio speex theoradec \
		theoraenc vorbis vorbisenc vpx x264>=8 xvidcore z
d52 7
a58 7
LIBavcodec_EXTRALIBS=-L${LOCALBASE}/lib -pthread -Wl,-rpath,${LOCALBASE}/lib -lgsm -lmp3lame -logg -lorc-0.4 -lschroedinger-1.0 -lspeex -ltheoradec -ltheoraenc -lvorbis -lvorbisenc -lvpx -lx264 -lxvidcore -lz -lavutil -lm
LIBavdevice_EXTRALIBS=-L${LOCALBASE}/lib -L${X11BASE}/lib -Wl,-rpath,${LOCALBASE}/lib -Wl,-rpath,${X11BASE}/lib -pthread -lX11 -lXext -lXfixes -lsndio -lavformat -lbz2 -lavcodec -lgsm -lmp3lame -logg -lorc-0.4 -lschroedinger-1.0 -lspeex -ltheoradec -ltheoraenc -lvorbis -lvorbisenc -lvpx -lx264 -lxvidcore -lz -lavutil -lm
LIBavfilter_EXTRALIBS=-L${LOCALBASE}/lib -Wl,-rpath,${LOCALBASE}/lib -pthread -lavformat -lbz2 -lavcodec -lgsm -lmp3lame -logg -lorc-0.4 -lschroedinger-1.0 -lspeex -ltheoradec -ltheoraenc -lvorbis -lvorbisenc -lvpx -lx264 -lxvidcore -lz -lswscale -lavutil -lm
LIBavformat_EXTRALIBS=-L${LOCALBASE}/lib -Wl,-rpath,${LOCALBASE}/lib -pthread -lbz2 -lavcodec -lgsm -lmp3lame -logg -lorc-0.4 -lschroedinger-1.0 -lspeex -ltheoradec -ltheoraenc -lvorbis -lvorbisenc -lvpx -lx264 -lxvidcore -lz -lavutil -lm
LIBavutil_EXTRALIBS=-L${LOCALBASE}/lib -lm
LIBpostproc_EXTRALIBS=-L${LOCALBASE}/lib -lavutil -lm
LIBswscale_EXTRALIBS=-L${LOCALBASE}/lib -lavutil -lm
d123 4
a126 4
		LIBavcodec_EXTRALIBS="${LIBavcodec_EXTRALIBS}" \
		LIBavdevice_EXTRALIBS="${LIBavdevice_EXTRALIBS}" \
		LIBavfilter_EXTRALIBS="${LIBavfilter_EXTRALIBS}" \
		LIBavformat_EXTRALIBS="${LIBavformat_EXTRALIBS}" \
d128 2
a129 2
		LIBpostproc_EXTRALIBS="${LIBpostproc_EXTRALIBS}" \
		LIBswscale_EXTRALIBS="${LIBswscale_EXTRALIBS}"
@


1.87
log
@Update to a newer FFmpeg snapshot, including security and stability fixes:

- vqavideo: return error if image size is not a multiple of block size (CVE-2012-0947)
- h263dec: Disallow width/height changing with frame threads (CVE-2011-3937)
- adpcm: ADPCM Electronic Arts has always two channels (CVE-2012-0852)
- h264: Add check for invalid chroma_format_idc (CVE-2012-0851)
- dpcm: ignore extra unpaired bytes in stereo streams (CVE-2011-3951)
- rtpdec_asf: Fix integer underflow that could allow remote code execution (CVE-2011-4031)
- aacsbr: prevent out of bounds memcpy() (CVE-2012-0850)
- kmvc: Check palsize (CVE-2011-3952)

Further bugfixes in the following codecs: ea, png, qdm2, tqi, motionpixels

From Brad, ok jasper@@.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.86 2012/04/28 08:41:32 ajacoutot Exp $
d5 1
a5 1
V=		20120609
@


1.86
log
@Update to ffmpeg-20120422 (0.7 branch).
* fix a whole lot of security related issues and bugs

from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.85 2012/04/08 16:56:51 ajacoutot Exp $
d5 1
a5 1
V=		20120422
d10 1
a10 1
EXTRACT_SUFX=	.tar.bz2
@


1.85
log
@Enable support for the libxvid encoder.

from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.84 2011/12/30 17:34:39 edd Exp $
d5 1
a5 1
V=		20111126
a7 1
REVISION=	0
d12 5
a16 5
SHARED_LIBS=	avcodec		16.2 \
		avdevice	4.1 \
		avfilter	2.2 \
		avformat	14.2 \
		avutil		8.2 \
d18 1
a18 1
		swscale		3.2
a68 5
OPTFLAGS=	${CFLAGS}

# until the system headers are fixed properly.
OPTFLAGS+=	-Wno-redundant-decls

d100 1
a100 2
		--mandir=${PREFIX}/man \
		--optflags="${OPTFLAGS}"
@


1.84
log
@update ffmpeg to a stable snapshot, from brad, OK aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.83 2011/09/21 08:58:48 sthen Exp $
d8 1
d13 1
a13 1
SHARED_LIBS=	avcodec		16.1 \
d33 1
a33 1
		theoraenc vorbis vorbisenc vpx x264>=8 z
d48 2
a49 1
		multimedia/x264>=20111027
d52 4
a55 4
LIBavcodec_EXTRALIBS=-L${LOCALBASE}/lib -pthread -Wl,-rpath,${LOCALBASE}/lib -lgsm -lmp3lame -logg -lorc-0.4 -lschroedinger-1.0 -lspeex -ltheoradec -ltheoraenc -lvorbis -lvorbisenc -lvpx -lx264 -lz -lavutil -lm
LIBavdevice_EXTRALIBS=-L${LOCALBASE}/lib -L${X11BASE}/lib -Wl,-rpath,${LOCALBASE}/lib -Wl,-rpath,${X11BASE}/lib -pthread -lX11 -lXext -lXfixes -lsndio -lavformat -lbz2 -lavcodec -lgsm -lmp3lame -logg -lorc-0.4 -lschroedinger-1.0 -lspeex -ltheoradec -ltheoraenc -lvorbis -lvorbisenc -lvpx -lx264 -lz -lavutil -lm
LIBavfilter_EXTRALIBS=-L${LOCALBASE}/lib -Wl,-rpath,${LOCALBASE}/lib -pthread -lavformat -lbz2 -lavcodec -lgsm -lmp3lame -logg -lorc-0.4 -lschroedinger-1.0 -lspeex -ltheoradec -ltheoraenc -lvorbis -lvorbisenc -lvpx -lx264 -lz -lswscale -lavutil -lm
LIBavformat_EXTRALIBS=-L${LOCALBASE}/lib -Wl,-rpath,${LOCALBASE}/lib -pthread -lbz2 -lavcodec -lgsm -lmp3lame -logg -lorc-0.4 -lschroedinger-1.0 -lspeex -ltheoradec -ltheoraenc -lvorbis -lvorbisenc -lvpx -lx264 -lz -lavutil -lm
d101 1
@


1.83
log
@add a fix to FFmpeg, from Brad:
wavpack: Check error codes rather than working around error conditions
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.82 2011/09/12 21:04:48 sthen Exp $
d5 1
a5 1
V=		20110408
a7 1
REVISION=	11
d10 1
d12 5
a16 5
SHARED_LIBS=	avcodec		16.0 \
		avdevice	4.0 \
		avfilter	2.1 \
		avformat	14.1 \
		avutil		8.1 \
d18 1
a18 1
		swscale		3.1
d32 1
a32 1
		theoraenc vorbis vorbisenc vpx x264 z
d47 1
a47 1
		multimedia/x264
d68 5
d89 1
a98 1
		--enable-postproc \
d103 2
a104 1
		--mandir=${PREFIX}/man
d146 3
@


1.82
log
@Some FFmpeg security and bug fixes from upstream, from Brad:

- jpegdec: Actually search for and parse RSTn.
- mpeg4: Adjust dummy frame threshold for packed DivX.
- mpeg4: Fix another packed DivX issue.
- jpegdec: Better RSTn skiping.
- Fix memory corruption in case of memory allocation failure.
- cavsdec: Avoid possible crash with crafted input.
- rtp: Fix integer underflow that could allow remote code execution. MSVR-11-008
8
- rtpdec_asf: Fix memleak.
- mp3dec: Dont spam the user on multiple MP3 frames.
- wavpack: Fixed invalid access with corrupted extra bits sub-blocks.
- wavpack: Fixed invalid writes with corrupted bitstreams.
- wavpack: Fixed invalid access with corrupted bitstream.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.81 2011/09/04 09:22:43 sthen Exp $
d8 1
a8 1
REVISION=	10
@


1.81
log
@FFmpeg build/packaging tweaks from Brad:
- Stop using --disable-optimization to have the port obey the CFLAGS
  but instead modify the configure script appropriately
- Move most of the DESCR into the pkg-readme
- Remove unnecessary CPPFLAGS that was being added to CONFIGURE_ENV
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.80 2011/08/28 11:17:48 sthen Exp $
d8 1
a8 1
REVISION=	9
@


1.80
log
@add a fix for the Ogg demuxer, from upstream via Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.79 2011/08/24 09:26:41 sthen Exp $
d8 1
a8 1
REVISION=	8
a82 1
		--disable-optimizations \
d107 1
a107 2
		TMPDIR=${WRKTMP} \
		CPPFLAGS="-I${X11BASE}/include"
@


1.79
log
@Another cavs security-related bug fix; check run value validity. From Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.78 2011/08/23 11:59:59 sthen Exp $
d8 1
a8 1
REVISION=	7
@


1.78
log
@Fix crashes with invalid bitstreams in the cavs decoder (oCERT #2011-002),
From Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.77 2011/08/16 19:01:47 sthen Exp $
d8 1
a8 1
REVISION=	6
@


1.77
log
@Bug and security fixes for FFmpeg, from Brad;
- cavs decoder: security fix; insufficient boundary check. oCERT #2011-002
- ogg demux: fix demuxing chained audio streams, correct duration
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.76 2011/08/03 18:44:07 dcoppa Exp $
d8 1
a8 1
REVISION=	5
@


1.76
log
@Some security fixes and important bug fixes for the FFmpeg Matroska, Ogg
and Wavpack demuxers.

From Brad

OK sthen@@, ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.75 2011/07/11 14:04:42 jasper Exp $
d8 1
a8 1
REVISION=	4
@


1.76.2.1
log
@Bug and security fixes for FFmpeg, from Brad;
- cavs decoder: security fix; insufficient boundary check. oCERT #2011-002
- ogg demux: fix demuxing chained audio streams, correct duration
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.77 2011/08/16 19:01:47 sthen Exp $
d8 1
a8 1
REVISION=	5
@


1.75
log
@no need to keep using the gcc3 module on sparc

from brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.74 2011/06/27 13:36:44 sthen Exp $
d8 1
a8 1
REVISION=	3
@


1.74
log
@Record missing inter-library dependencies in .pc files, pkg-config
now only considers Requires not Requires.private unless linking
statically so the missing deps cause problems. From Nigel Taylor
and on ports@@ for a week, much testing by Nigel. I updated the
diff following faac removal.  Fixes multimedia/transcode build.

ok jasper@@ espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.73 2011/06/24 11:16:21 sthen Exp $
d8 1
a8 1
REVISION=	2
a28 3

MODULES=	gcc3
MODGCC3_ARCHES=	sparc
@


1.73
log
@Don't link to libfaac, it has a problem with incompatible licenses.
From Brad, ok dcoppa@@.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.72 2011/06/22 08:10:26 dcoppa Exp $
d8 1
a8 1
REVISION=	1
d53 7
a59 7
LIBavcodec_EXTRALIBS=-L${LOCALBASE}/lib -lgsm -lm -lmp3lame -logg -lorc-0.4 -lschroedinger-1.0 -lspeex -ltheoradec -ltheoraenc -lvorbis -lvorbisenc -lvpx -lx264 -lz -pthread -Wl,-rpath,${LOCALBASE}/lib
LIBavdevice_EXTRALIBS=-L${X11BASE}/lib -lX11 -lXext -lXfixes -lm -lsndio -Wl,-rpath,${LOCALBASE}/lib -Wl,-rpath,${X11BASE}/lib
LIBavfilter_EXTRALIBS=-lm
LIBavformat_EXTRALIBS=-L${LOCALBASE}/lib -lbz2 -lm -Wl,-rpath,${LOCALBASE}/lib
LIBavutil_EXTRALIBS=-lm
LIBpostproc_EXTRALIBS=-lm
LIBswscale_EXTRALIBS=-lm
d125 4
a128 4
		LIBavcodec_EXTRALIBS="-lavutil ${LIBavcodec_EXTRALIBS}" \
		LIBavdevice_EXTRALIBS="-lavformat -lavcodec -lavutil ${LIBavdevice_EXTRALIBS}" \
		LIBavfilter_EXTRALIBS="-lavformat -lavcodec -lavutil -lswscale ${LIBavfilter_EXTRALIBS}" \
		LIBavformat_EXTRALIBS="-lavcodec -lavutil ${LIBavformat_EXTRALIBS}" \
d130 2
a131 2
		LIBpostproc_EXTRALIBS="-lavutil ${LIBpostproc_EXTRALIBS}" \
		LIBswscale_EXTRALIBS="-lavutil ${LIBswscale_EXTRALIBS}"
@


1.72
log
@Fix a runtime CPU detection bug in libswscale that was messing up
thumbnails creation on amd64 (thumbnails had purple and green bars
all over them).

From upstream git commit 93c28a55fd84280d97c3c0dd7b0d546043242c34

OK Brad (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.71 2011/06/04 09:20:36 sthen Exp $
d8 1
a8 1
REVISION=	0
d12 1
a12 1
SHARED_LIBS=	avcodec		15.1 \
d33 3
a35 3
WANTLIB=	SDL X11 Xext Xfixes bz2 c faac gsm m mp3lame ogg \
		orc-0.4 pthread schroedinger-1.0>=2 sndio speex \
		theoradec theoraenc vorbis vorbisenc vpx x264 z
a41 1
		audio/faac \
d53 1
a53 1
LIBavcodec_EXTRALIBS=-L${LOCALBASE}/lib -lfaac -lgsm -lm -lmp3lame -logg -lorc-0.4 -lschroedinger-1.0 -lspeex -ltheoradec -ltheoraenc -lvorbis -lvorbisenc -lvpx -lx264 -lz -pthread -Wl,-rpath,${LOCALBASE}/lib 
a88 1
		--enable-libfaac \
a96 1
		--enable-nonfree \
@


1.71
log
@- clarify license marker
- consistently use ${...} not $(...)
from Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.70 2011/04/12 22:59:07 sthen Exp $
d8 1
@


1.70
log
@Update FFmpeg to 20110408 snapshot.

- Enable WebM encoding.
- Stop stripping the shared libraries which explains why I was
   seeing no symbol table with the shared libraries.
- Build all of FFmpeg with -fomit-frame-pointer on i386 instead of
   hacking the various Makefile's and having to add more files as
   further updates are made. Use default CFLAGS (-O2) on i386 now too
   instead of overriding with -O.
- Remove the UINT64_C hack.
- Update HOMEPAGE to use the ffmpeg.org domain.
- Various other cleaning up and fixes for the port.

From Brad, ok dcoppa@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.69 2011/03/29 20:01:43 edd Exp $
d23 1
a23 1
# LGPLv2.1 / GPLv2
d116 6
a121 6
VERSION_FLAGS=	libavcodec_VERSION=$(LIBavcodec_VERSION) \
		libavdevice_VERSION=$(LIBavdevice_VERSION) \
		libavfilter_VERSION=$(LIBavfilter_VERSION) \
		libavformat_VERSION=$(LIBavformat_VERSION) \
		libavutil_VERSION=$(LIBavutil_VERSION) \
		libpostproc_VERSION=$(LIBpostproc_VERSION) \
d142 1
a143 1
#REGRESS_TARGET=	codectest
@


1.69
log
@Update to a newer snapshot of ffmpeg. Maintainer timed out.
OK jakemsr@@, landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.68 2011/02/12 10:48:56 jasper Exp $
d3 1
a3 1
COMMENT=	audio/video converter and streamer with bktr(4) support
d5 1
a5 1
V=		20110306
d9 1
a9 3
#MASTER_SITES=	http://comstyle.com/source/ \
#		http://gormsby.com/downloads/
MASTER_SITES=	http://theunixzoo.co.uk/distfiles/
d11 1
a11 1
SHARED_LIBS=	avcodec		15.0 \
d13 3
a15 3
		avfilter	2.0 \
		avformat	14.0 \
		avutil		8.0 \
d17 1
a17 1
		swscale		3.0
d19 1
a19 1
HOMEPAGE=	http://ffmpeg.mplayerhq.hu/
d33 2
a34 2
		orc-0.4 pthread schroedinger-1.0>=2 sndio speex theora \
		theoradec theoraenc vorbis vorbisenc x264 z
d48 1
a51 10
# does not compile with asm, we suspect binutils
.if ${MACHINE_ARCH:Mpowerpc}
CONFIGURE_ARGS +=	--disable-asm
.endif

.if ${MACHINE_ARCH:Marm}
# uses ARM EABI
CONFIGURE_ARGS+=	--arch=generic
.endif

d53 1
a53 1
LIBavcodec_EXTRALIBS=-L${LOCALBASE}/lib -lfaac -lgsm -lm -lmp3lame -logg -lorc-0.4 -lschroedinger-1.0 -lspeex -ltheora -lvorbis -lvorbisenc -lx264 -lz -pthread -Wl,-rpath,${LOCALBASE}/lib
d64 7
d74 1
d76 1
d96 1
a99 1
		--enable-pthreads \
d128 2
a129 2
		LIBavdevice_EXTRALIBS="-lavcodec -lavformat -lavutil ${LIBavdevice_EXTRALIBS}" \
		LIBavfilter_EXTRALIBS="-lavcodec -lavutil -lswscale ${LIBavfilter_EXTRALIBS}" \
a133 1

d146 1
a146 9
HTML_DOCS=	developer faq ffmpeg ffplay ffprobe ffserver \
		general libavfilter

# When you are rolling your distfile, you need to get the version string
# from 'git describe --always' *before* you remove the .git directory.
MAKE_ENV +=	OBSD_VSTR=git-f4f4e12

post-extract:
	@@cp -f ${FILESDIR}/sndio_* ${WRKSRC}/libavdevice
@


1.68
log
@Security fixes for CVE-2010-4704, CVE-2010-4705 and CVE-2011-0480.

ok brad (MAINTAINER), naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.67 2011/01/15 10:56:51 jasper Exp $
d5 2
a6 2
V=		20100512
DISTNAME=	ffmpeg-svn-${V}
a7 1
REVISION=	6
d9 11
a19 10
MASTER_SITES=	http://comstyle.com/source/ \
		http://gormsby.com/downloads/

SHARED_LIBS=	avcodec		14.0 \
		avdevice	3.0 \
		avfilter	1.0 \
		avformat	13.0 \
		avutil		7.0 \
		postproc	13.0 \
		swscale		2.0
d34 1
a34 1
WANTLIB=	SDL X11 Xext Xfixes bz2 c faac faad gsm m mp3lame ogg \
a43 1
		audio/faad \
d53 5
d60 1
a60 1
CONFIGURE_ARGS+= --arch=generic
d64 1
a64 1
LIBavcodec_EXTRALIBS=-L${LOCALBASE}/lib -lfaac -lfaad -lgsm -lm -lmp3lame -logg -lorc-0.4 -lschroedinger-1.0 -lspeex -ltheora -lvorbis -lvorbisenc -lx264 -lz -pthread -Wl,-rpath,${LOCALBASE}/lib 
a78 1
		--disable-altivec \
a91 1
		--enable-libfaad \
d149 1
a149 1
HTML_DOCS=	developer faq ffmpeg-doc ffplay-doc ffprobe-doc ffserver-doc \
d151 4
@


1.67
log
@- remove USE_GROFF=Yes, manpages checked by brad.

from brad (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.66 2010/11/22 10:16:08 espie Exp $
d8 1
a8 1
REVISION=	5
@


1.66
log
@remaining WANTLIB go .>=   to >=
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.65 2010/11/19 09:02:33 jasper Exp $
a71 1
USE_GROFF =	Yes
@


1.65
log
@- adjust after recent schroedinger update

from brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.64 2010/11/17 08:05:13 espie Exp $
d35 1
a35 1
		orc-0.4 pthread schroedinger-1.0.>=2.0 sndio speex theora \
@


1.64
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.63 2010/10/24 21:21:00 ajacoutot Exp $
d8 1
a8 1
REVISION=	4
d34 3
a36 3
WANTLIB += SDL X11 Xext Xfixes bz2 c faac faad gsm m mp3lame ogg
WANTLIB += orc-0.4 pthread schroedinger-1.0 sndio speex theora
WANTLIB += theoradec theoraenc vorbis vorbisenc x264 z
d51 1
a51 1
		multimedia/schroedinger>=1.0.9 \
d55 1
a55 1
# XXX binutils
@


1.63
log
@Remove USE_X11.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62 2010/10/18 18:13:13 espie Exp $
d38 1
a38 1
BUILD_DEPENDS=	::textproc/texi2html
d40 1
a40 1
BUILD_DEPENDS+=	::devel/yasm
d42 11
a52 11
LIB_DEPENDS=	::archivers/bzip2 \
		::audio/faac \
		::audio/faad \
		::audio/lame \
		::audio/libvorbis \
		::audio/speex \
		::audio/gsm \
		::devel/sdl \
		::multimedia/libtheora \
		:schroedinger->=1.0.9:multimedia/schroedinger \
		::multimedia/x264
@


1.62
log
@USE_GROFF=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.61 2010/09/20 07:59:59 sthen Exp $
a70 1
USE_X11=	Yes
@


1.61
log
@Switch to new-style LIB_DEPENDS and tighten the pkgspec for schroedinger.
No change to the package -> no bump. ok Brad (maintainer).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.60 2010/09/15 15:40:00 jakemsr Exp $
d73 1
@


1.60
log
@better timestamp for recorded data: account for buffering
requested/ok maintainer
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59 2010/09/03 16:39:13 sthen Exp $
d34 3
a36 1
WANTLIB=	X11 Xext Xfixes c m ogg orc-0.4 pthread sndio z
d42 11
a52 11
LIB_DEPENDS=	SDL.>=4::devel/sdl \
		faac.>=1::audio/faac \
		faad.>=2::audio/faad \
		mp3lame.>=0.1::audio/lame \
		vorbis.>=4.0,vorbisenc.>=2.0::audio/libvorbis \
		speex::audio/speex \
		gsm::audio/gsm \
		x264.>=4::multimedia/x264 \
		theora,theoradec,theoraenc::multimedia/libtheora \
		schroedinger-1.0::multimedia/schroedinger \
		bz2.>=10::archivers/bzip2
@


1.59
log
@- Some clean up of the FFMpeg configure patch
- Update the sndio backend code to the newer libavdevice alsa code
which has been refactored and cleaned up a bit

From Brad (maintainer).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2010/08/25 23:27:21 sthen Exp $
d8 1
a8 1
REVISION=	3
@


1.58
log
@- chase the library change in multimedia/schroedinger; oil->orc
- add various other missing WANTLIB (and LIB_DEPENDS in some cases)
- while there move PKGNAME=..pX to REVISION, and move some ports
to new-style LIB_DEPENDS

original diff from Brad, extensive checking by me (clean build of everything
related to liboil).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.57 2010/08/20 12:10:52 sthen Exp $
d8 1
a8 1
REVISION=	2
d150 1
a150 1
	@@cp -f ${FILESDIR}/sndio.c ${WRKSRC}/libavdevice
@


1.57
log
@BUILD_DEPENDS on yasm on amd64/i386 and bump REVISION in case an
existing package was built without it. From Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2010/08/07 22:41:47 sthen Exp $
d8 1
a8 1
REVISION=	1
d10 2
a11 2
MASTER_SITES=	http://gormsby.com/downloads/ \
		http://comstyle.com/source/
d34 1
a34 1
WANTLIB=	X11 Xext Xfixes c m ogg oil-0.3 pthread sndio z
d58 1
a58 1
LIBavcodec_EXTRALIBS=-L${LOCALBASE}/lib -lfaac -lfaad -lgsm -lm -lmp3lame -logg -loil-0.3 -lschroedinger-1.0 -lspeex -ltheora -lvorbis -lvorbisenc -lx264 -lz -pthread -Wl,-rpath,${LOCALBASE}/lib 
@


1.56
log
@FFmpeg appears to require a newer version of binutils on arm; switch
to the generic target for now on that arch. It's slower, but at least
it builds...

okay espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55 2010/07/24 14:50:07 jolan Exp $
d8 1
a8 1
REVISION=	0
d37 3
@


1.55
log
@add mirror so this is fetchable again
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.54 2010/07/10 22:45:19 naddy Exp $
d48 5
@


1.54
log
@Remove a workaround no longer necessary now that i386 has switched to gcc4.
From maintainer
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2010/06/15 10:07:41 sebastia Exp $
d10 2
a11 1
MASTER_SITES=	http://comstyle.com/source/
@


1.53
log
@build with gcc3 on sparc
OK landry@@ sthen@@
MAINTAINER OKed x264
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.52 2010/05/26 21:38:52 jakemsr Exp $
d8 1
@


1.52
log
@update to ffmpeg subversion snapshot from 2010-05-12

update needed for newer x264 and for gcc4.  this causes yet more
fallout as some libav* functions other ports were using have been
fully deprecated.  commits coming rsn ...

mostly from new MAINTAINER
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 2010/04/26 01:57:13 jakemsr Exp $
d28 3
@


1.51
log
@sndio for audio recording.
NOTE: the audio recording muxer is still named 'oss' for compatability.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2009/09/02 11:50:56 sthen Exp $
d5 13
a17 9
V=			20080620
DISTNAME=		ffmpeg-svn-${V}
PKGNAME=		ffmpeg-${V}p13
SHARED_LIBS=		avutil		6.0 \
			avcodec		13.1 \
			avformat	12.0 \
			postproc	12.0 \
			avdevice	2.0 \
			swscale		1.0
d19 1
a19 1
CATEGORIES=		graphics multimedia
d21 1
a21 1
HOMEPAGE=		http://ffmpeg.mplayerhq.hu/
d23 1
a23 1
# GPL
d29 1
a29 2
# only available through SVN
MASTER_SITES=		http://jakemsr.trancell.org/distfiles/
d31 12
a42 22
BUILD_DEPENDS=		::textproc/texi2html
LIB_DEPENDS=		SDL.>=4::devel/sdl \
			faac.>=1::audio/faac \
			faad.>=2::audio/faad \
			mp3lame.>=0.1::audio/lame \
			vorbis.>=4.0,vorbisenc.>=2.0::audio/libvorbis \
			a52::audio/liba52 \
			x264.>=3::multimedia/x264 \
			theora::multimedia/libtheora \
			schroedinger-1.0::multimedia/schroedinger \
			Imlib2::graphics/imlib2 \
			bz2.>=10::archivers/bzip2

WANTLIB=		X11 Xext c freetype m ogg oil-0.3 pthread sndio z

USE_X11=		Yes
USE_GMAKE=		Yes

# libswscale/swscale_template.c will not compile without this.
.if ${MACHINE_ARCH} == "i386"
CFLAGS+=-fomit-frame-pointer
.endif
d45 4
a49 2
LIBavcodec_EXTRALIBS=-L${LOCALBASE}/lib -lfaac -lfaad -lmp3lame -lvorbis -lvorbisenc -la52 -lschroedinger-1.0 -loil-0.3 -ltheora -logg -lx264 -lz -lm -pthread -Wl,-rpath,${LOCALBASE}/lib 
LIBavformat_EXTRALIBS=-L${LOCALBASE}/lib -lbz2 -lm -Wl,-rpath,${LOCALBASE}/lib
a50 1
LIBavdevice_EXTRALIBS=-L${X11BASE}/lib -lX11 -lXext -lsndio -lm -Wl,-rpath,${LOCALBASE}/lib -Wl,-rpath,${X11BASE}/lib
d54 1
a54 1
WRKTMP=			${WRKDIR}/tmp
d56 64
a119 51
CONFIGURE_STYLE=	simple
CONFIGURE_ARGS+=	${CONFIGURE_SHARED} \
			--cc=${CC} \
			--mandir=${PREFIX}/man \
			--disable-debug \
			--disable-optimizations \
			--enable-gpl \
			--enable-pthreads \
			--enable-postproc \
			--enable-swscale \
			--enable-liba52 \
			--enable-libfaac \
			--enable-libfaad \
			--enable-libmp3lame \
			--enable-libschroedinger \
			--enable-libtheora \
			--enable-libvorbis \
			--enable-libx264 \
			--enable-x11grab \
			--extra-libs="-L${LOCALBASE}/lib -L${X11BASE}/lib" \
			--extra-cflags="-I${LOCALBASE}/include -I${X11BASE}/include" \
			--disable-decoder=cavs \
			--disable-altivec \
			--disable-armv6 \
			--disable-armvfp \
			--disable-iwmmxt \
			--disable-neon

CONFIGURE_ENV+=		LIBavutil_EXTRALIBS="${LIBavutil_EXTRALIBS}" \
			LIBavcodec_EXTRALIBS="${LIBavcodec_EXTRALIBS}" \
			LIBavformat_EXTRALIBS="${LIBavformat_EXTRALIBS}" \
			LIBpostproc_EXTRALIBS="${LIBpostproc_EXTRALIBS}" \
			LIBavdevice_EXTRALIBS="${LIBavdevice_EXTRALIBS}" \
			LIBswscale_EXTRALIBS="${LIBswscale_EXTRALIBS}" \
			TMPDIR=${WRKTMP} \
			CPPFLAGS="-I${X11BASE}/include"

VERSION_FLAGS=		libavutil_VERSION=$(LIBavutil_VERSION) \
			libavcodec_VERSION=$(LIBavcodec_VERSION) \
			libavformat_VERSION=$(LIBavformat_VERSION) \
			libpostproc_VERSION=$(LIBpostproc_VERSION) \
			libavdevice_VERSION=$(LIBavdevice_VERSION) \
			libswscale_VERSION=${LIBswscale_VERSION}

MAKE_FLAGS=		${VERSION_FLAGS} \
			LIBavutil_EXTRALIBS="${LIBavutil_EXTRALIBS}" \
			LIBavcodec_EXTRALIBS="-lavutil ${LIBavcodec_EXTRALIBS}" \
			LIBavformat_EXTRALIBS="-lavutil -lavcodec ${LIBavformat_EXTRALIBS}" \
			LIBpostproc_EXTRALIBS="-lavutil ${LIBpostproc_EXTRALIBS}" \
			LIBavdevice_EXTRALIBS="-lavutil -lavformat ${LIBavdevice_EXTRALIBS}" \
			LIBswscale_EXTRALIBS="-lavutil ${LIBswscale_EXTRALIBS}"
d121 2
a122 2
FAKE_FLAGS=		${VERSION_FLAGS} \
			LDCONFIG=true
d125 1
a125 1
CONFIGURE_ARGS+=	--disable-stripping
d128 1
a128 1
ALL_TARGET=		all tools/qt-faststart
d131 7
a137 1
NO_REGRESS=		Yes
d140 1
a140 1
	-mkdir ${WRKTMP}
d143 1
d146 1
a146 1
.for doc in faq ffmpeg-doc ffplay-doc ffserver-doc hooks
a148 1
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/ffmpeg
@


1.50
log
@Build+install tools/qt-faststart, a tool to rearrange moov atoms in h264
files in the .mov container, useful to prepare some files for network
streaming. Same effect as a more complex diff sent by Valery Masiutsin
some time ago. Sync WANTLIB while there.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2009/08/10 06:31:44 kili Exp $
d7 1
a7 1
PKGNAME=		ffmpeg-${V}p12
d41 1
a41 1
WANTLIB=		X11 Xext c freetype m ogg oil-0.3 ossaudio pthread z
d56 1
a56 1
LIBavdevice_EXTRALIBS=-L${X11BASE}/lib -lX11 -lXext -lossaudio -lm -Wl,-rpath,${LOCALBASE}/lib -Wl,-rpath,${X11BASE}/lib
@


1.49
log
@WANTLIB changes after xcb addition and bump.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2009/07/19 22:27:46 sthen Exp $
d7 1
a7 1
PKGNAME=		ffmpeg-${V}p11
d41 1
a41 2
WANTLIB=		X11 Xext c freetype m ogg oil-0.3 ossaudio pthread \
			pthread-stubs xcb z
d121 1
d130 1
@


1.48
log
@bump libavcodec minor and PKGNAME following addition of schroedinger,
no API change to libavcoded, but make sure depending packages get updated.
problem spotted by dhill@@, discussed with Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2009/07/18 09:06:26 sthen Exp $
d7 1
a7 1
PKGNAME=		ffmpeg-${V}p10
d41 2
a42 1
WANTLIB=		X11 Xext c freetype m pthread ogg oil-0.3 ossaudio z
@


1.47
log
@enable support for the Dirac codec with the newly imported schroedinger
library. From Brad, no OpenBSD/cats were harmed in this port...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2009/04/14 19:52:08 kili Exp $
d7 1
a7 1
PKGNAME=		ffmpeg-${V}p9
d9 1
a9 1
			avcodec		13.0 \
@


1.46
log
@
Some fixes after the x264 update.

From Brad.

"theoretically ok" ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2009/01/29 11:30:27 sthen Exp $
d7 1
a7 1
PKGNAME=		ffmpeg-${V}p8
d37 1
d41 1
a41 1
WANTLIB=		X11 Xext c freetype m pthread ogg ossaudio z
d53 1
a53 1
LIBavcodec_EXTRALIBS=-L${LOCALBASE}/lib -lfaac -lfaad -lmp3lame -lvorbis -lvorbisenc -la52 -ltheora -logg -lx264 -lz -lm -pthread -Wl,-rpath,${LOCALBASE}/lib 
d76 1
@


1.45
log
@SECURITY; fix http://www.trapkit.de/advisories/TKADV2009-004.txt
From Brad.

FFmpeg contains a type conversion vulnerability while parsing malformed 4X
movie files. The vulnerability may be exploited by a (remote) attacker to
execute arbitrary code in the context of FFmpeg or an application using
the FFmpeg library.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2009/01/24 11:00:41 jakemsr Exp $
d7 1
a7 1
PKGNAME=		ffmpeg-${V}p7
d35 1
a35 1
			x264.>=1::multimedia/x264 \
@


1.44
log
@there's no reason to stop SDL from doing audio playback conversions
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2009/01/24 10:31:15 ajacoutot Exp $
d7 1
a7 1
PKGNAME=		ffmpeg-${V}p6
@


1.43
log
@- do not strip bin/lib when DEBUG is defined
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2008/12/13 02:58:00 jakemsr Exp $
d7 1
a7 1
PKGNAME=		ffmpeg-${V}p5
@


1.42
log
@drop maintainership, bump pkgname
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2008/09/15 22:06:11 jakemsr Exp $
d114 4
@


1.41
log
@
- faad/faac update related changes
- bump PKGNAME

ok brad@@, also tested by ckuethe@@ a while back
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2008/09/08 23:28:28 brad Exp $
d7 1
a7 1
PKGNAME=		ffmpeg-${V}p4
a17 1
MAINTAINER=		Jacob Meuser <jakemsr@@openbsd.org>
@


1.40
log
@Enable the V4L2 input support.

ok jakemsr@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2008/09/05 01:10:21 brad Exp $
d7 1
a7 1
PKGNAME=		ffmpeg-${V}p3
d31 2
a32 2
			faac::audio/faac \
			faad.>=1::audio/faad \
@


1.39
log
@Fix FFmpeg's configure script so it can retreive and understand the
hardware architecture instead of the machine port. Also add support
for detecting the presence of AltiVec at run-time using the
machdep.altivec sysctl.

At the moment AltiVec is disabled but this at least allows the
configure script to build in the support if --disable-altivec is
removed. Facilitates further testing and debugging.

ok kili@@ jakemsr@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2008/07/25 20:25:59 sthen Exp $
d7 1
a7 1
PKGNAME=		ffmpeg-${V}p2
@


1.38
log
@shared library and PKGNAME bumps due to use of isinf/isnan/nan
following libc/libm changes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2008/07/22 20:25:17 brad Exp $
d7 1
a7 1
PKGNAME=		ffmpeg-${V}p1
d82 6
a87 1
			--disable-decoder=cavs
@


1.37
log
@Remove a patch that was only necessary for older snaps of x264.

ok jakemsr@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2008/07/09 01:57:44 jakemsr Exp $
d7 1
a7 1
PKGNAME=		ffmpeg-${V}p0
d9 1
a9 1
			avcodec		12.0 \
@


1.36
log
@
update to subversion snapshot from 2008-06-20.

added since last update:

- AVM2 (Flash 9) SWF muxer
- QT variant of IMA ADPCM encoder
- VFW grabber
- Ipod/Iphone compatible mp4 muxer
- Mimic decoder
- MSN TCP Webcam stream demuxer
- RL2 demuxer / decoder
- IFF demuxer
- 8SVX audio decoder
- BFI demuxer
- MAXIS EA XA (.xa) demuxer / decoder
- BFI video decoder
- OMA demuxer

also:
* headers have been moved to library specific subdirectories instead
  of all under ffmpeg.
* libswscale is now enabled in the build.


feedback/ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2008/01/30 03:58:52 jakemsr Exp $
d7 1
a7 1
PKGNAME=		ffmpeg-${V}
d36 1
a36 1
			x264::multimedia/x264 \
@


1.35
log
@no need to disable these SSE2 functions on i386 ater the recent
libpthread changes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2008/01/26 01:56:02 jakemsr Exp $
d5 1
a5 1
V=			20080118
d7 7
a13 6
PKGNAME=		ffmpeg-${V}p0
SHARED_LIBS=		avutil		5.0 \
			avcodec		11.0 \
			avformat	11.0 \
			postproc	11.0 \
			avdevice	1.0
d38 2
a39 1
			Imlib2::graphics/imlib2
d46 1
a46 1
# It's either this or disable mmx so postprocess_template.c will build.
d53 5
a57 4
LIBavcodec_EXTRALIBS=-lavutil -L${LOCALBASE}/lib -lfaac -lfaad -lmp3lame -lvorbis -lvorbisenc -la52 -ltheora -logg -lx264 -lz -lm -pthread -Wl,-rpath,${LOCALBASE}/lib 
LIBavformat_EXTRALIBS=-lavutil -lavcodec -lm -Wl,-rpath,${LOCALBASE}/lib
LIBpostproc_EXTRALIBS=-lavutil -lm
LIBavdevice_EXTRALIBS=-lavutil -lavformat -L${X11BASE}/lib -lX11 -lXext -lossaudio -lm -Wl,-rpath,${LOCALBASE}/lib -Wl,-rpath,${X11BASE}/lib
a67 1
			--enable-pp \
d70 2
d89 1
d93 8
a100 5
MAKE_FLAGS=		LIBavutil_VERSION=$(LIBavutil_VERSION) \
			LIBavcodec_VERSION=$(LIBavcodec_VERSION) \
			LIBavformat_VERSION=$(LIBavformat_VERSION) \
			LIBpostproc_VERSION=$(LIBpostproc_VERSION) \
			LIBavdevice_VERSION=$(LIBavdevice_VERSION) \
d102 12
a113 13
			LIBavcodec_EXTRALIBS="-L${WRKBUILD}/libavutil ${LIBavcodec_EXTRALIBS}" \
			LIBavformat_EXTRALIBS="-L${WRKBUILD}/libavutil -L${WRKBUILD}/libavcodec ${LIBavformat_EXTRALIBS}" \
			LIBpostproc_EXTRALIBS="-L${WRKBUILD}/libavutil ${LIBpostproc_EXTRALIBS}" \
			LIBavdevice_EXTRALIBS="-L${WRKBUILD}/libavutil -L${WRKBUILD}/libavformat ${LIBavdevice_EXTRALIBS}"

FAKE_FLAGS=		LDCONFIG=true \
			LIBavutil_VERSION=$(LIBavutil_VERSION) \
			LIBavcodec_VERSION=$(LIBavcodec_VERSION) \
			LIBavformat_VERSION=$(LIBavformat_VERSION) \
			LIBpostproc_VERSION=$(LIBpostproc_VERSION) \
			LIBavdevice_VERSION=$(LIBavdevice_VERSION)

REGRESS_TARGET=		codectest
@


1.34
log
@update to 20080118

relevent Changelog entries:

+- Monkey's Audio demuxer and decoder
+- additional SPARC (VIS) optimizations
+- AMV audio and video decoder
+- DNxHD encoder
+- H.264 PAFF decoding
+- Nellymoser ASAO decoder
+- Beam Software SIFF demuxer and decoder
+- libvorbis Vorbis decoding removed in favor of native decoder
+- IntraX8 (J-Frame) subdecoder for WMV2 and VC-1
+- Ogg muxer
+- PC Paintbrush PCX decoder
+- Sun Rasterfile decoder
+- TechnoTrend PVA demuxer
+- Linux Media Labs MPEG-4 (LMLM4) demuxer

port changes:

disable ff_fdct_sse2 usage on i386 and libpostproc's
temporal noise reduction filter, since they both regularly
cause segfaults.

ok deanna@@, brad@@

tested by a few others, thanks
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2008/01/04 17:48:35 espie Exp $
d7 1
a7 1
PKGNAME=		ffmpeg-${V}
@


1.33
log
@tweak FAKE_FLAGS semantics to saner defaults.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2007/10/19 14:32:57 jakemsr Exp $
d5 8
a12 6
DISTNAME=		ffmpeg-svn-20070910
PKGNAME=		${DISTNAME:S/-svn//}p1
SHARED_LIBS=		avutil		4.0 \
			avcodec		10.0 \
			avformat	10.0 \
			postproc	10.0
d51 2
a52 2
LIBavcodec_EXTRALIBS=-lavutil -lm -lz -L${LOCALBASE}/lib -lfaac -lfaad -lmp3lame -lvorbis -lvorbisenc -la52 -ltheora -logg -lx264 -pthread -Wl,-rpath,${LOCALBASE}/lib
LIBavformat_EXTRALIBS=-lavutil -lavcodec -lossaudio -lm -L${LOCALBASE}/lib -logg -L${X11BASE}/lib -lX11 -lXext -Wl,-rpath,${LOCALBASE}/lib  -Wl,-rpath,${X11BASE}/lib
d54 1
d62 1
d64 1
a64 1
			--disable-opts \
a71 1
			--enable-libogg \
d77 2
a78 1
			--extra-cflags="-I${LOCALBASE}/include -I${X11BASE}/include"
d84 1
a84 2
			LIBavcodec_REQUIRES="vorbis vorbisenc theora x264" \
			LIBavformat_REQUIRES="ogg" \
d92 1
d96 2
a97 1
			LIBpostproc_EXTRALIBS="-L${WRKBUILD}/libavutil ${LIBpostproc_EXTRALIBS}"
d103 2
a104 1
			LIBpostproc_VERSION=$(LIBpostproc_VERSION)
@


1.32
log
@- provide complete pkg-config information, instead of relying
  on inter-library dependency magic
- libavcodec needs libvorbis which needs libogg, so add ogg
  to libavcodec's dependency libs
- as of the previous commit, libavformat depends on libX11 and
  libXext, add them as dependency libs
- add RPATH info when linking libavcodec and libavformat, so
  applications that dlopen() libavcodec or libavformat have a
  better chance of finding dependency libs

fixes multimedia/ffmpeg2theora build problem noticed by sturm@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2007/10/10 07:59:32 aanriot Exp $
d94 1
a94 2
FAKE_FLAGS=		DESTDIR=${WRKINST} \
			LDCONFIG=true \
@


1.31
log
@enable "x11grab" which allows to grab the X11 display.

ok jakemsr@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2007/09/24 07:51:24 jakemsr Exp $
d6 1
a6 1
PKGNAME=		${DISTNAME:S/-svn//}p0
d49 3
a51 3
LIBavcodec_EXTRALIBS=-lavutil -lm -lz -L${LOCALBASE}/lib -lfaac -lfaad -lmp3lame -lvorbis -lvorbisenc -la52 -ltheora -lx264 -pthread
LIBavformat_EXTRALIBS=-lavutil -lavcodec -lossaudio -lm -L${LOCALBASE}/lib -logg
LIBpostproc_EXTRALIBS=-lavutil
d80 2
@


1.30
log
@update to snapshot from 2007-09-10

additions/changes in this update:

- RoQ muxer, audio encoder
- Renderware TXD demuxer and decoder
- extern C declarations for C++ removed from headers
- sws_flags command line option
- codebook generator
- RoQ video encoder
- QTRLE encoder
- OS/2 support removed
- AC-3 decoder
- NUT muxer (since r10052)
- Matroska muxer
- Slice-based parallel H.264 decoding

plus lots of bugfixes

prodding/testing/ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2007/09/15 20:09:40 simon Exp $
d6 1
a6 1
PKGNAME=		${DISTNAME:S/-svn//}
d59 1
a63 1
			--disable-debug \
d72 1
@


1.29
log
@remove surrounding quotes from COMMENT/BROKEN/PERMIT_*
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2007/06/29 06:15:52 jakemsr Exp $
d5 6
a10 6
DISTNAME=		ffmpeg-svn-20070501
PKGNAME=		${DISTNAME:S/-svn//}p0
SHARED_LIBS=		avutil		3.0 \
			avcodec		9.0 \
			avformat	9.0 \
			postproc	9.0
d34 2
a35 1
			theora::multimedia/libtheora
d37 1
a37 1
WANTLIB=		X11 Xext c freetype m pthread ogg ossaudio usbhid z
a59 1
			--enable-liba52 \
d64 1
d69 1
d71 3
a73 4
			--enable-libtheora \
			--enable-x264 \
			--extra-libs="-L${LOCALBASE}/lib" \
			--extra-cflags="-I${LOCALBASE}/include"
d79 2
a80 1
			TMPDIR=${WRKTMP}
@


1.28
log
@- use exact width data types for libfaad interaction
- LIB_DEPENDS libfaad >= 1.0
- bump PKGNAME

OK naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2007/05/25 15:54:14 jakemsr Exp $
d3 1
a3 1
COMMENT=	"audio/video converter and streamer with bktr(4) support"
d18 1
a18 1
PERMIT_PACKAGE_CDROM=	"patents"
@


1.27
log
@update to SVN snapshot from 20070501

several new codecs added, including an WMA encoder, Theora
encoding via libtheora, and H.264 encoding via x264

with feedback from brad@@, jolan@@, naddy@@ and Nikns Sainkin
<nikns at secure dot lv>

OK jolan@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2007/03/02 23:38:28 kurt Exp $
d6 1
a6 1
PKGNAME=		${DISTNAME:S/-svn//}
d29 1
a29 1
			faad::audio/faad \
@


1.26
log
@Disable building with swscale support since it breaks ffmpeg support in
vlc. ok pvalchev@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2007/01/26 16:03:20 robert Exp $
d5 7
a11 6
DISTNAME=		ffmpeg-cvs-20070110
PKGNAME=		${DISTNAME:S/-cvs//}p1
SHARED_LIBS=		avutil		2.0 \
			avcodec		8.0 \
			avformat	8.0 \
			postproc	8.0
d14 2
a15 2
HOMEPAGE=		http://www.ffmpeg.org/
MAINTAINER=		Nikns Siankin <nikns@@secure.lv>
d23 2
a24 2
# only available through CVS
MASTER_SITES=		ftp://ftp.secure.lv/pub/distfiles/
d31 4
a34 1
			vorbis.>=4.0,vorbisenc.>=2.0::audio/libvorbis
d46 9
d59 1
a59 1
			--enable-a52 \
d64 3
a66 3
			--enable-faac \
			--enable-faad \
			--enable-mp3lame \
d68 3
a70 1
			--enable-vorbis \
d72 1
a72 1
			--extra-cflags=-I${LOCALBASE}/include
d74 5
d83 5
a87 1
			LIBpostproc_VERSION=$(LIBpostproc_VERSION)
d97 3
@


1.25
log
@- fix library dependencies by adding ogg to WANTLIB
- avoid linking against ffmpeg libraries that are installed already
from Nikns Siankin
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2007/01/23 09:34:45 robert Exp $
d6 1
a6 1
PKGNAME=		${DISTNAME:S/-cvs//}p0
d10 1
a10 2
			postproc	8.0 \
			swscale		0.0
a50 1
			--enable-swscaler \
d63 1
a63 2
			LIBpostproc_VERSION=$(LIBpostproc_VERSION) \
			LIBswscale_VERSION=$(LIBswscale_VERSION)
d70 1
a70 2
			LIBpostproc_VERSION=$(LIBpostproc_VERSION) \
			LIBswscale_VERSION=$(LIBswscale_VERSION)
@


1.24
log
@- update to version 20070110 (cvs snapshot)
- Nikns Siankin <nikns@@secure.lv> takes mainteinership
- add support for several external codecs
- fix regress target
- and many more

from Nikns Siankin <nikns@@secure.lv>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2006/12/02 20:24:17 pvalchev Exp $
d6 1
a6 1
PKGNAME=		${DISTNAME:S/-cvs//}
d33 1
a33 1
WANTLIB=		X11 Xext c freetype m pthread ossaudio usbhid z
d58 1
a58 1
			--extra-ldflags="-lm -L${LOCALBASE}/lib" \
@


1.23
log
@Remove jakemsr@@ from maintainer position, as he has been inactive and
email has been bouncing for several months.  Jacob, if you get this
and/or get back to things, let us know.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2006/08/02 10:10:35 espie Exp $
d5 7
a11 6
DISTNAME=		ffmpeg-cvs-20060312
PKGNAME=		${DISTNAME:S/-cvs//}p2
SHARED_LIBS=		avutil		1.0 \
			avcodec		7.0 \
			avformat	7.0 \
			postproc	7.0
d15 1
d24 1
a24 1
MASTER_SITES=		http://www.jakemsr.com/
d27 6
a32 1
LIB_DEPENDS=		SDL.>=4::devel/sdl
d51 10
a60 1
			--disable-debug
d65 2
a66 1
			LIBpostproc_VERSION=$(LIBpostproc_VERSION)
d73 2
a74 1
			LIBpostproc_VERSION=$(LIBpostproc_VERSION)
d76 1
a76 1
WRKDIST=		${WRKDIR}/ffmpeg
@


1.22
log
@more new lib specs
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2006/07/31 15:03:15 millert Exp $
d6 1
a6 1
PKGNAME=		${DISTNAME:S/-cvs//}p1
a13 2

MAINTAINER=		Jacob Meuser <jakemsr@@openbsd.org>
@


1.21
log
@Fix a core dump during mpeg audio decoding; from revision 5658 of
the ffmpeg svn repo.  OK brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2006/03/22 08:08:42 jakemsr Exp $
d27 1
a27 1
LIB_DEPENDS=		SDL.4::devel/sdl
@


1.20
log
@- don't strip libraries on install
- bump PKGNAME
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2006/03/20 05:50:49 jakemsr Exp $
d6 1
a6 1
PKGNAME=		${DISTNAME:S/-cvs//}p0
@


1.19
log
@update to CVS as of 3/12/06.

relevant portion of the official ChangeLog:

- Fraps FPS1 video decoder
- Snow video encoder/decoder
- Sonic audio encoder/decoder
- Vorbis audio decoder
- Macromedia ADPCM decoder
- Duck TrueMotion 2 video decoder
- support for decoding FLX and DTA extensions in FLIC files
- H.264 custom quantization matrices support
- ffserver fixed, it should now be usable again
- QDM2 audio decoder
- Real Cooker audio decoder
- TrueSpeech audio decoder
- WMA2 audio decoder fixed, now all files should play correctly
- RealAudio 14.4 and 28.8 decoders fixed
- JPEG-LS encoder and decoder
- CamStudio video decoder
- build system improvements
- tabs and trailing whitespace removed from the codebase
- AIFF/AIFF-C audio format, encoding and decoding
- ADTS AAC file reading and writing
- Creative VOC file reading and writing
- American Laser Games multimedia (*.mm) playback system
- Zip Blocks Motion Video decoder
- Improved Theora/VP3 decoder
- True Audio (TTA) decoder
- AVS demuxer and video decoder

also, bktr(4) support has been integrated upstream, and most of the
source patches in the port are no longer necessary.

OK brad@@
@
text
@d1 1
a1 1
# $OpenBSD$
d6 1
a6 1
PKGNAME=		${DISTNAME:S/-cvs//}
@


1.18
log
@SHARED_LIBS
ok jakemsr@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2005/04/20 16:46:54 naddy Exp $
a3 5
DISTNAME=	FFMpeg-20050413
PKGNAME=	${DISTNAME:L}
SHARED_LIBS=	avcodec		6.0	\
		avformat	6.0	\
		postproc	6.0
d5 7
a11 3
CATEGORIES=	graphics x11
MASTER_SITES=	http://www.jakemsr.com/
#		http://mplayerhq.hu/MPlayer/cvs/
d13 1
a13 1
EXTRACT_SUFX=	.tar.bz2
d15 1
a15 3
HOMEPAGE=	http://www.ffmpeg.org/

MAINTAINER=	Jacob Meuser <jakemsr@@jakemsr.com>
d18 3
a20 1
PERMIT_DISTFILES_CDROM=	"patents"
a21 3
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes
WANTLIB=		X11 Xext c m ogg ossaudio pthread usbhid z
d23 9
a31 9
BUILD_DEPENDS=	::textproc/texi2html
LIB_DEPENDS=	SDL.2.0::devel/sdl \
		a52.0.0::audio/liba52 \
		mp3lame.0.1::audio/lame \
		vorbis.4.0,vorbisenc.2.0::audio/libvorbis

NO_REGRESS=	Yes	# Possible to adapt with some work
USE_GMAKE=	Yes
USE_X11=	Yes
d38 21
a58 27
CONFIGURE_STYLE=simple
CONFIGURE_ENV+=	CPPFLAGS="-I${LOCALBASE}/include"
CONFIGURE_ARGS+=${CONFIGURE_SHARED} \
		--cc=${CC} \
		--make=${MAKE_PROGRAM} \
		--extra-cflags="-I${LOCALBASE}/include" \
		--extra-ldflags="-L${LOCALBASE}/lib -L${X11BASE}/lib" \
		--disable-opts \
		--enable-a52 \
		--enable-pp \
		--enable-mp3lame \
		--enable-libogg \
		--enable-vorbis \
		--enable-gpl \
		--enable-pthreads \
		--disable-debug

MAKE_ENV+=	LDFLAGS="-L${X11BASE}/lib -L${LOCALBASE}/lib"
MAKE_FLAGS=	SLIBSUF=.so	\
		LIBavcodec_VERSION=$(LIBavcodec_VERSION)	\
		LIBavformat_VERSION=$(LIBavformat_VERSION)	\
		LIBpostproc_VERSION=$(LIBpostproc_VERSION)

# shared libpostproc
.if ${MACHINE_ARCH} != "m88k" && ${MACHINE_ARCH} != "vax"
CONFIGURE_ARGS+=--enable-shared-pp
.endif
d60 1
a60 2
post-extract:
	@@cp ${FILESDIR}/grab_bsdbktr.c ${WRKSRC}/libavformat/
d62 1
a62 1
do-install:
d64 3
d68 1
a68 2
	${INSTALL_DATA} ${WRKSRC}/doc/*.html ${PREFIX}/share/doc/ffmpeg
	${INSTALL_DATA} ${WRKSRC}/doc/ffserver.conf \
d70 1
a70 25
	${INSTALL_MAN} ${WRKSRC}/doc/*.1 ${PREFIX}/man/man1
	${INSTALL_PROGRAM} ${WRKBUILD}/ffmpeg ${PREFIX}/bin/ffmpeg
	${INSTALL_PROGRAM} ${WRKBUILD}/ffplay ${PREFIX}/bin/ffplay
	${INSTALL_PROGRAM} ${WRKBUILD}/ffserver ${PREFIX}/bin/ffserver
	${INSTALL_DATA_DIR} ${PREFIX}/include/ffmpeg
	${INSTALL_DATA_DIR} ${PREFIX}/include/postproc
	${INSTALL_DATA} ${WRKSRC}/libavcodec/{avcodec,common,rational,mpegaudio}.h \
		${PREFIX}/include/ffmpeg
	${INSTALL_DATA} ${WRKSRC}/libavformat/{avformat.h,avio.h,rtp.h,rtsp.h,rtspcodes.h} \
		${PREFIX}/include/ffmpeg
	${INSTALL_DATA} ${WRKBUILD}/libavcodec/libpostproc/postprocess.h \
		${PREFIX}/include/postproc
	${INSTALL_DATA} ${WRKBUILD}/libavcodec/libavcodec.a \
		${WRKBUILD}/libavformat/libavformat.a ${PREFIX}/lib
.if ${MACHINE_ARCH} != "m88k" && ${MACHINE_ARCH} != "vax"
	${INSTALL_DATA} \
		${WRKBUILD}/libavcodec/libavcodec.so.${LIBavcodec_VERSION} \
		${WRKBUILD}/libavformat/libavformat.so.${LIBavformat_VERSION} \
		${WRKBUILD}/libavcodec/libpostproc/libpostproc.so.${LIBpostproc_VERSION} \
		${PREFIX}/lib
.else
	${INSTALL_DATA} ${WRKBUILD}/libavcodec/libpostproc/libpostproc.a \
		${PREFIX}/lib
.endif
	
a71 1

@


1.17
log
@Update to 20050413; from Jacob Meuser <jakemsr@@jakemsr.com>.
Lots of bug fixes.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2005/03/10 03:35:15 jolan Exp $
d6 3
a41 3
# version numbers for the shared libraries
SV=		6.0

d43 1
a43 1
CONFIGURE_ENV+=	CPPFLAGS="-I${LOCALBASE}/include" SV="${SV}"
d60 4
d94 4
a97 3
	${INSTALL_DATA} ${WRKBUILD}/libavcodec/libavcodec.so.${SV} \
		${WRKBUILD}/libavformat/libavformat.so.${SV} \
		${WRKBUILD}/libavcodec/libpostproc/libpostproc.so.${SV} \
@


1.16
log
@always build bktr support and bump pkgname, from maintainer
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2005/02/09 23:41:42 naddy Exp $
d4 2
a5 2
DISTNAME=	FFMpeg-20050130
PKGNAME=	${DISTNAME:L}p0
d28 1
a28 1
		vorbis.3.0,vorbisenc.2.0::audio/libvorbis
d39 3
d43 1
a43 1
CONFIGURE_ENV+=	CPPFLAGS="-I${LOCALBASE}/include"
d53 1
a64 3

# version numbers for the shared libraries
SV=		5.0
@


1.15
log
@- update ffmpeg to snapshot 20050130
- remove inter-library dependencies
- chase fallout in dependent ports

From: Jacob Meuser <jakemsr@@jakemsr.com>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2005/01/16 22:53:17 alek Exp $
d5 1
a5 1
PKGNAME=	${DISTNAME:L}
a59 5
.endif

# bktr(4) support
.if ${MACHINE_ARCH} != "i386" && ${MACHINE_ARCH} != "powerpc"
CONFIGURE_ARGS+=--disable-v4l
@


1.14
log
@- Fix audio/liba52 dependency
- Bump PKGNAME

Patch from MAINTAINER
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2004/11/30 01:06:34 espie Exp $
d4 3
a6 3
DISTNAME=	ffmpeg-0.4.9-pre1
PKGNAME=	${DISTNAME:S/9-p/9p/}p0
SV=		4.9
d8 4
a11 1
MASTER_SITES=	${MASTER_SITE_SOURCEFORGE:=ffmpeg/}
d13 1
a13 1
HOMEPAGE=	http://ffmpeg.sourceforge.net/
d26 1
d47 1
d57 5
d67 2
a68 6
.if ${MACHINE_ARCH} != "m88k" && ${MACHINE_ARCH} != "vax"
CONFIGURE_ARGS+=--enable-a52bin
RUN_DEPENDS=	::audio/liba52
.else
CONFIGURE_ARGS+=--enable-a52
.endif
d85 1
a85 1
	${INSTALL_DATA} ${WRKSRC}/libavcodec/{avcodec,common,rational}.h \
d95 6
a100 3
		${PREFIX}/lib/libavcodec.so.${SV}
	${INSTALL_DATA} ${WRKBUILD}/libavformat/libavformat.so.${SV} \
		${PREFIX}/lib/libavformat.so.${SV}
d104 1
@


1.13
log
@WANTLIB markers
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2004/10/13 01:38:21 jolan Exp $
d5 1
a5 1
PKGNAME=	${DISTNAME:S/9-p/9p/}
a22 1
		a52::audio/liba52 \
a45 1
		--enable-a52bin \
d55 7
@


1.12
log
@build & install documentation, enable threads support, tweaks

from new maintainer Jacob Meuser
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2004/10/07 06:12:11 jolan Exp $
d19 1
@


1.11
log
@update to 0.4.9-pre1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2004/07/05 22:07:01 jolan Exp $
d12 2
d20 1
d24 1
a24 1
		vorbis.3.0,vorbisenc.2.0::audio/libvorbis \
d48 1
d62 1
d64 1
d67 1
@


1.10
log
@fix on no_shared_archs
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2004/04/18 00:36:22 jolan Exp $
d4 3
a6 3
DISTNAME=	ffmpeg-0.4.8
PKGNAME=	${DISTNAME}p1
SV=		${DISTNAME:S/ffmpeg-0.//}
a11 2
MAINTAINER=	Jolan Luff <jolan@@openbsd.org>

d44 1
d58 1
a58 3
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/ffmpeg
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/examples/ffmpeg
	${INSTALL_DATA} ${WRKSRC}/doc/*.html ${PREFIX}/share/doc/ffmpeg
d60 1
a60 2
		${PREFIX}/share/doc/examples/ffmpeg
	${INSTALL_MAN} ${WRKSRC}/doc/*.1 ${PREFIX}/man/man1
d66 1
a66 1
	${INSTALL_DATA} ${WRKSRC}/libavcodec/{avcodec,common}.h \
@


1.9
log
@experimental bktr(4) support, from freebsd
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2003/12/06 13:43:08 espie Exp $
d78 1
a78 1
.if !defined(NO_SHARED_LIBS)
@


1.8
log
@... and bump PKGNAME too, oops.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2003/12/06 13:38:09 espie Exp $
d3 1
a3 1
COMMENT=	"audio/video converter and streamer"
d5 3
a7 2
PKGNAME=	ffmpeg-0.4.8p0
CATEGORIES=	graphics
d20 5
d27 1
d35 19
a53 4
CONFIGURE_ARGS+=--cc=${CC} --make=gmake ${CONFIGURE_SHARED} \
		--disable-ffserver --disable-opts --enable-pp

SV=	0.4
d55 2
a56 2
pre-configure:
	@@perl -pi -e 's|_SV_|${SV}|g' ${WRKSRC}/configure
d59 6
d66 2
@


1.7
log
@install all headers.
ok jolan@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2003/11/04 07:50:19 jolan Exp $
d5 1
@


1.6
log
@Update to 0.4.8.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2003/09/26 14:40:29 jolan Exp $
d39 3
a41 1
	${INSTALL_DATA} ${WRKBUILD}/libavcodec/{avcodec,common}.h \
@


1.5
log
@Update to 0.4.7.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2003/08/15 14:25:08 jolan Exp $
d4 1
a4 1
DISTNAME=	ffmpeg-0.4.7
d28 1
a28 1
		--disable-ffserver
d30 1
a30 1
SV=	0.3
@


1.4
log
@Update to 20030813.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2003/08/04 06:08:22 jolan Exp $
d4 1
a4 2
DISTNAME=	ffmpeg-20030813
EXTRACT_SUFX=	.tar.bz2
d6 1
a6 1
MASTER_SITES=	http://www.videolan.org/pub/videolan/vlc/0.6.2/contrib/
d21 5
d30 1
a30 1
SV=	0.2
a33 7

post-configure:
# -fPIC causes a compilation error on i386
.if ${MACHINE_ARCH} != "i386"
	@@perl -pi -e 's|###CFLAGS|CFLAGS|g' ${WRKSRC}/libavcodec/Makefile \
		${WRKSRC}/libavformat/Makefile
.endif
@


1.3
log
@oops, this was ported with only x11/vlc in mind.  enable installation of
libavformat & the ffmpeg binary.  bump PKGNAME.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2003/08/02 10:26:54 jolan Exp $
d4 1
a4 2
DISTNAME=	ffmpeg-20030725
PKGNAME=	${DISTNAME}p0
d7 1
a7 1
MASTER_SITES=	http://www.videolan.org/pub/videolan/vlc/0.6.1/contrib/
d26 12
d49 4
a52 4
	${INSTALL_DATA} ${WRKBUILD}/libavcodec/libavcodec.so \
		${PREFIX}/lib/libavcodec.so.0.1
	${INSTALL_DATA} ${WRKBUILD}/libavformat/libavformat.so \
		${PREFIX}/lib/libavformat.so.0.1
@


1.2
log
@update to 20030725
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2003/07/19 18:16:34 jolan Exp $
d5 1
d28 1
d40 2
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d4 1
a4 1
DISTNAME=	ffmpeg-20030622
d7 1
a7 1
MASTER_SITES=	http://www.videolan.org/pub/videolan/vlc/0.6.0/contrib/
d23 2
a24 1
CONFIGURE_ARGS+=--cc=${CC} --make=gmake ${CONFIGURE_SHARED}
d37 1
a37 1
		${PREFIX}/lib/libavcodec.so.0.0
@


1.1.1.1
log
@import of ffmpeg-20030622:

FFmpeg is a complete solution to record, convert and stream audio and
video.  It includes libavcodec, the leading audio/video codec library.
@
text
@@
