head	1.2;
access;
symbols
	OPENBSD_6_1:1.1.0.8
	OPENBSD_6_1_BASE:1.1
	OPENBSD_6_0:1.1.0.6
	OPENBSD_6_0_BASE:1.1
	OPENBSD_5_9:1.1.0.2
	OPENBSD_5_9_BASE:1.1
	OPENBSD_5_8:1.1.0.4
	OPENBSD_5_8_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2017.05.15.19.54.22;	author rsadowski;	state dead;
branches;
next	1.1;
commitid	ZxOldxFfKWEXNImH;

1.1
date	2015.04.18.09.16.36;	author sthen;	state Exp;
branches;
next	;
commitid	4LxwcKXHGTPtpckL;


desc
@@


1.2
log
@update to gd-2.2.4

SECURITY fix for:
CVE-2016-9317,CVE-2016-6912,CVE-2016-10166,CVE-2016-10167,
CVE-2016-5767,CVE-2016-10168,CVE-2015-8874,CVE-2016-9933

Initial diff from me, diff to replace multimedia/libvpx with
graphics/libwebp from Brad Smith

ok sthen@@, "looks okay" @@landry
@
text
@$OpenBSD: patch-src_webpimg_c,v 1.1 2015/04/18 09:16:36 sthen Exp $

Fix the build with newer libvpx.

--- src/webpimg.c.orig	Sun Apr 12 19:49:36 2015
+++ src/webpimg.c	Sun Apr 12 19:50:47 2015
@@@@ -711,14 +711,14 @@@@ static WebPResult VPXEncode(const uint8* Y,
     codec_ctl(&enc, VP8E_SET_STATIC_THRESHOLD, 0);
     codec_ctl(&enc, VP8E_SET_TOKEN_PARTITIONS, 2);
 
-    vpx_img_wrap(&img, IMG_FMT_I420,
+    vpx_img_wrap(&img, VPX_IMG_FMT_I420,
                  y_width, y_height, 16, (uint8*)(Y));
-    img.planes[PLANE_Y] = (uint8*)(Y);
-    img.planes[PLANE_U] = (uint8*)(U);
-    img.planes[PLANE_V] = (uint8*)(V);
-    img.stride[PLANE_Y] = y_stride;
-    img.stride[PLANE_U] = uv_stride;
-    img.stride[PLANE_V] = uv_stride;
+    img.planes[VPX_PLANE_Y] = (uint8*)(Y);
+    img.planes[VPX_PLANE_U] = (uint8*)(U);
+    img.planes[VPX_PLANE_V] = (uint8*)(V);
+    img.stride[VPX_PLANE_Y] = y_stride;
+    img.stride[VPX_PLANE_U] = uv_stride;
+    img.stride[VPX_PLANE_V] = uv_stride;
 
     res = vpx_codec_encode(&enc, &img, 0, 1, 0, VPX_DL_BEST_QUALITY);
 
@


1.1
log
@Allow gd to build with newer libvpx, from Brad.
@
text
@d1 1
a1 1
$OpenBSD$
@

