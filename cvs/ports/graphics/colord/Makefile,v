head	1.65;
access;
symbols
	OPENBSD_6_2:1.65.0.2
	OPENBSD_6_2_BASE:1.65
	OPENBSD_6_1:1.62.0.2
	OPENBSD_6_1_BASE:1.62
	OPENBSD_6_0:1.60.0.2
	OPENBSD_6_0_BASE:1.60
	OPENBSD_5_9:1.57.0.2
	OPENBSD_5_9_BASE:1.57
	OPENBSD_5_8:1.53.0.4
	OPENBSD_5_8_BASE:1.53
	OPENBSD_5_7:1.49.0.2
	OPENBSD_5_7_BASE:1.49
	OPENBSD_5_6:1.39.0.2
	OPENBSD_5_6_BASE:1.39
	OPENBSD_5_5:1.33.0.2
	OPENBSD_5_5_BASE:1.33
	OPENBSD_5_4:1.28.0.2
	OPENBSD_5_4_BASE:1.28
	OPENBSD_5_3:1.18.0.2
	OPENBSD_5_3_BASE:1.18
	OPENBSD_5_2:1.14.0.2
	OPENBSD_5_2_BASE:1.14
	OPENBSD_5_1_BASE:1.5
	OPENBSD_5_1:1.5.0.2
	ajacoutot_20111102:1.1.1.1
	ajacoutot:1.1.1;
locks; strict;
comment	@# @;


1.65
date	2017.08.23.08.36.57;	author ajacoutot;	state Exp;
branches;
next	1.64;
commitid	zGWvRl1koYHoxapg;

1.64
date	2017.08.22.07.14.49;	author ajacoutot;	state Exp;
branches;
next	1.63;
commitid	cr7j04612sTKKGQP;

1.63
date	2017.08.17.13.33.36;	author ajacoutot;	state Exp;
branches;
next	1.62;
commitid	lDWXQQLCtNHNZuXK;

1.62
date	2016.10.05.08.10.26;	author ajacoutot;	state Exp;
branches;
next	1.61;
commitid	WaBZ1Xsgd9g4tobc;

1.61
date	2016.09.23.09.16.55;	author sthen;	state Exp;
branches;
next	1.60;
commitid	XLnI6AbHAmyVU5mO;

1.60
date	2016.04.25.15.02.46;	author ajacoutot;	state Exp;
branches;
next	1.59;
commitid	Cn8MWchyvYwcZl7z;

1.59
date	2016.04.04.22.57.45;	author naddy;	state Exp;
branches;
next	1.58;
commitid	FILF1LJRoZlYu0JV;

1.58
date	2016.03.11.20.28.26;	author naddy;	state Exp;
branches;
next	1.57;
commitid	UYLP8TE6V7RS2GhJ;

1.57
date	2015.11.28.08.31.56;	author ajacoutot;	state Exp;
branches;
next	1.56;
commitid	qxvOA5PuchtvNmxV;

1.56
date	2015.08.27.06.48.30;	author ajacoutot;	state Exp;
branches;
next	1.55;
commitid	fg1RtdQjUrtjJJWq;

1.55
date	2015.08.20.08.02.33;	author ajacoutot;	state Exp;
branches;
next	1.54;
commitid	9pkhAhBXQNZDl9Nl;

1.54
date	2015.08.15.11.13.42;	author ajacoutot;	state Exp;
branches;
next	1.53;
commitid	AXPeqyjAAuMdtb7k;

1.53
date	2015.06.09.05.17.52;	author ajacoutot;	state Exp;
branches;
next	1.52;
commitid	7AsofugWp5HwdnlB;

1.52
date	2015.04.09.07.20.24;	author ajacoutot;	state Exp;
branches;
next	1.51;
commitid	GjLbSXvqscgwry1f;

1.51
date	2015.04.04.09.30.30;	author ajacoutot;	state Exp;
branches;
next	1.50;
commitid	QSLndtZiU46ysFLn;

1.50
date	2015.04.04.09.21.01;	author ajacoutot;	state Exp;
branches;
next	1.49;
commitid	kS3kwKZogsvzYmEY;

1.49
date	2015.02.21.05.01.57;	author ajacoutot;	state Exp;
branches;
next	1.48;
commitid	bzT8lvLML3VlxNj3;

1.48
date	2015.01.16.08.59.06;	author ajacoutot;	state Exp;
branches;
next	1.47;
commitid	zijlNPx9RvGvc40G;

1.47
date	2014.12.05.07.19.35;	author ajacoutot;	state Exp;
branches;
next	1.46;
commitid	52NkxqMsi1q7hSrs;

1.46
date	2014.11.25.05.19.29;	author ajacoutot;	state Exp;
branches;
next	1.45;
commitid	tU9740XIkuvrgTSn;

1.45
date	2014.11.13.09.34.38;	author ajacoutot;	state Exp;
branches;
next	1.44;
commitid	AMun0vNXjXdRRnK2;

1.44
date	2014.10.13.07.19.42;	author ajacoutot;	state Exp;
branches;
next	1.43;
commitid	Rjukytr97XlPHEHD;

1.43
date	2014.10.07.07.33.30;	author ajacoutot;	state Exp;
branches;
next	1.42;
commitid	ZgmtBLbxl53zLX4G;

1.42
date	2014.09.13.16.36.53;	author ajacoutot;	state Exp;
branches;
next	1.41;
commitid	N2TalFGi4jKRwS2u;

1.41
date	2014.09.13.05.00.05;	author ajacoutot;	state Exp;
branches;
next	1.40;
commitid	uEUfyfePEdOOCTQi;

1.40
date	2014.08.26.07.18.12;	author ajacoutot;	state Exp;
branches;
next	1.39;
commitid	FoegEBmoBRJxpjKD;

1.39
date	2014.06.30.13.13.04;	author kettenis;	state Exp;
branches;
next	1.38;
commitid	LSTDi7CnZY3AJaJE;

1.38
date	2014.06.04.13.37.20;	author ajacoutot;	state Exp;
branches;
next	1.37;
commitid	aFdbieGsx3sl4Pxz;

1.37
date	2014.05.19.17.36.28;	author landry;	state Exp;
branches;
next	1.36;

1.36
date	2014.04.18.08.22.21;	author ajacoutot;	state Exp;
branches;
next	1.35;

1.35
date	2014.04.11.10.48.17;	author ajacoutot;	state Exp;
branches;
next	1.34;

1.34
date	2014.03.31.15.19.59;	author sthen;	state Exp;
branches;
next	1.33;

1.33
date	2014.01.28.08.46.34;	author ajacoutot;	state Exp;
branches;
next	1.32;

1.32
date	2013.12.10.13.51.16;	author ajacoutot;	state Exp;
branches;
next	1.31;

1.31
date	2013.11.11.15.52.40;	author ajacoutot;	state Exp;
branches;
next	1.30;

1.30
date	2013.09.13.14.23.01;	author ajacoutot;	state Exp;
branches;
next	1.29;

1.29
date	2013.08.06.19.10.05;	author ajacoutot;	state Exp;
branches;
next	1.28;

1.28
date	2013.06.01.18.35.24;	author ajacoutot;	state Exp;
branches;
next	1.27;

1.27
date	2013.05.30.18.17.18;	author ajacoutot;	state Exp;
branches;
next	1.26;

1.26
date	2013.04.30.09.09.40;	author stsp;	state Exp;
branches;
next	1.25;

1.25
date	2013.04.18.13.57.14;	author ajacoutot;	state Exp;
branches;
next	1.24;

1.24
date	2013.03.31.19.46.48;	author ajacoutot;	state Exp;
branches;
next	1.23;

1.23
date	2013.03.31.19.41.23;	author ajacoutot;	state Exp;
branches;
next	1.22;

1.22
date	2013.03.30.13.03.45;	author ajacoutot;	state Exp;
branches;
next	1.21;

1.21
date	2013.03.21.08.45.17;	author ajacoutot;	state Exp;
branches;
next	1.20;

1.20
date	2013.03.11.11.10.51;	author espie;	state Exp;
branches;
next	1.19;

1.19
date	2013.03.08.06.58.38;	author ajacoutot;	state Exp;
branches;
next	1.18;

1.18
date	2012.12.03.10.11.07;	author ajacoutot;	state Exp;
branches;
next	1.17;

1.17
date	2012.09.27.06.55.04;	author ajacoutot;	state Exp;
branches;
next	1.16;

1.16
date	2012.09.21.14.48.05;	author ajacoutot;	state Exp;
branches;
next	1.15;

1.15
date	2012.08.04.15.00.16;	author ajacoutot;	state Exp;
branches;
next	1.14;

1.14
date	2012.05.28.16.38.35;	author ajacoutot;	state Exp;
branches;
next	1.13;

1.13
date	2012.05.28.15.52.26;	author ajacoutot;	state Exp;
branches;
next	1.12;

1.12
date	2012.05.28.08.56.36;	author ajacoutot;	state Exp;
branches;
next	1.11;

1.11
date	2012.05.28.08.45.38;	author ajacoutot;	state Exp;
branches;
next	1.10;

1.10
date	2012.04.28.10.52.08;	author ajacoutot;	state Exp;
branches;
next	1.9;

1.9
date	2012.04.13.15.03.01;	author ajacoutot;	state Exp;
branches;
next	1.8;

1.8
date	2012.03.19.18.10.35;	author ajacoutot;	state Exp;
branches;
next	1.7;

1.7
date	2012.03.19.12.23.13;	author ajacoutot;	state Exp;
branches;
next	1.6;

1.6
date	2012.03.19.08.59.00;	author ajacoutot;	state Exp;
branches;
next	1.5;

1.5
date	2012.01.09.16.28.25;	author ajacoutot;	state Exp;
branches;
next	1.4;

1.4
date	2011.11.26.08.47.08;	author ajacoutot;	state Exp;
branches;
next	1.3;

1.3
date	2011.11.13.18.02.33;	author ajacoutot;	state Exp;
branches;
next	1.2;

1.2
date	2011.11.02.17.55.33;	author ajacoutot;	state Exp;
branches;
next	1.1;

1.1
date	2011.11.02.16.40.22;	author ajacoutot;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2011.11.02.16.40.22;	author ajacoutot;	state Exp;
branches;
next	;


desc
@@


1.65
log
@Add another skipv to PORTROACH.
@
text
@# $OpenBSD: Makefile,v 1.64 2017/08/22 07:14:49 ajacoutot Exp $

# XXX newer versions hard depend on gusb and udev...
PORTROACH=	skipv:1.4.0,1.4.1

COMMENT=	device color profile management daemon

V=		1.3.5
DISTNAME=	colord-${V}
EXTRACT_SUFX=	.tar.xz

SHARED_LIBS +=  colordprivate        1.1      # 2.5
SHARED_LIBS +=  colord               1.5      # 2.5

CATEGORIES=	graphics print

HOMEPAGE=	http://www.freedesktop.org/software/colord/

MAINTAINER=	Antoine Jacoutot <ajacoutot@@openbsd.org>

# GPLv2
PERMIT_PACKAGE_CDROM=	Yes

WANTLIB += c ffi gio-2.0 glib-2.0 gmodule-2.0 gobject-2.0 gthread-2.0
WANTLIB += iconv intl lcms2 m pcre polkit-gobject-1 pthread sqlite3
WANTLIB += z

MASTER_SITES=	http://www.freedesktop.org/software/colord/releases/

MODULES=	devel/dconf \
		textproc/intltool

BUILD_DEPENDS=	devel/gobject-introspection \
		lang/vala \
		textproc/docbook2x \
		x11/dbus

LIB_DEPENDS=	graphics/lcms2 \
		databases/sqlite3 \
		sysutils/polkit

# polkit(8) almost always needs to know the "active" session
RUN_DEPENDS +=	sysutils/consolekit

# /usr/local/share/dbus-1/system-services/
RUN_DEPENDS +=	x11/dbus,-suid

# cd-self-test.c:1528:colord_client_func: assertion failed (version == version_str)
TEST_DEPENDS=	STEM-=${V}:${BUILD_PKGPATH}

USE_GMAKE=	Yes

CONFIGURE_STYLE=gnu
CONFIGURE_ENV=	CPPFLAGS="-I${LOCALBASE}/include" \
		LDFLAGS="-L${LOCALBASE}/lib"

CONFIGURE_ARGS=	--enable-introspection \
		--enable-vala \
		--disable-systemd-login \
		--disable-udev \
		--disable-gusb \
		--with-daemon-user=_colord

# disable: takes a huge amount of time/RAM
CONFIGURE_ARGS += --disable-print-profiles
# until proven useful
CONFIGURE_ARGS += --disable-argyllcms-sensor
#BUILD_DEPENDS += graphics/argyll

# XXX configure: error: Package requirements (bash-completion >= 2.0) were not met
CONFIGURE_ARGS += --disable-bash-completion

FAKE_FLAGS=	sysconfdir="${PREFIX}/share/examples/colord"

# our old gcc does not handle some of the warning flags
MAKE_FLAGS=	WARNINGFLAGS_C=

pre-configure:
	${SUBST_CMD} ${WRKSRC}/lib/colord/cd-icc-store.c \
		${WRKSRC}/src/cd-main.c

post-install:
	rm -r ${WRKINST}/rules.d
	rm ${PREFIX}/lib/colord-sensors/*.{a,la}

.include <bsd.port.mk>
@


1.64
log
@Bump portroach.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.63 2017/08/17 13:33:36 ajacoutot Exp $
d4 1
a4 1
PORTROACH=	skipv:1.4.1
@


1.63
log
@Update to colord-1.3.5.
Skip 1.4.0 for now as it hard depends on udev and gusb.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62 2016/10/05 08:10:26 ajacoutot Exp $
d4 1
a4 1
PORTROACH=	skipv:1.4.0
@


1.62
log
@Update to colord-1.3.3.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.61 2016/09/23 09:16:55 sthen Exp $
d3 2
a4 1
PORTROACH=	limitw:1,even
d8 1
a8 1
V=		1.3.3
d13 1
a13 1
SHARED_LIBS +=  colord               1.4      # 2.5
@


1.61
log
@Cope with moving sqlite3 back to ports.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.60 2016/04/25 15:02:46 ajacoutot Exp $
d7 1
a7 1
V=		1.3.2
a9 1
REVISION=	0
@


1.60
log
@Update to colord-1.3.2.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59 2016/04/04 22:57:45 naddy Exp $
d10 1
d39 1
@


1.59
log
@g/c PFRAG.shared
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2016/03/11 20:28:26 naddy Exp $
d7 1
a7 1
V=		1.2.12
a9 1
REVISION=	1
d11 2
a12 2
SHARED_LIBS +=  colordprivate        1.1      # 2.4
SHARED_LIBS +=  colord               1.3      # 2.4
d24 2
a25 1
WANTLIB += lcms2 m pcre polkit-gobject-1 pthread sqlite3 z
a29 1
		devel/gettext \
@


1.58
log
@garbage collect CONFIGURE_SHARED
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.57 2015/11/28 08:31:56 ajacoutot Exp $
d10 1
a10 1
REVISION=	0
@


1.57
log
@Add PORTROACH annotation.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2015/08/27 06:48:30 ajacoutot Exp $
d56 1
a56 2
CONFIGURE_ARGS=	${CONFIGURE_SHARED} \
		--enable-introspection \
@


1.56
log
@Fix DBus @@sample files after recent dbus port update.
The dbus package does not install /etc/dbus-1/system.d/ anymore, so it
needs to be properly @@sample'd.
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.55 2015/08/20 08:02:33 ajacoutot Exp $
@


1.55
log
@Update to colord-1.2.12.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.54 2015/08/15 11:13:42 ajacoutot Exp $
d8 1
@


1.54
log
@Bump after the consolekit->consolekit2 renaming.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2015/06/09 05:17:52 ajacoutot Exp $
d5 1
a5 1
V=		1.2.11
a7 1
REVISION=	0
@


1.53
log
@Update to colord-1.2.11.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.52 2015/04/09 07:20:24 ajacoutot Exp $
d8 1
@


1.52
log
@Update to colord-1.2.10.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 2015/04/04 09:30:30 ajacoutot Exp $
d5 1
a5 1
V=		1.2.10
d9 2
a10 2
SHARED_LIBS +=  colordprivate        1.1      # 2.3
SHARED_LIBS +=  colord               1.2      # 2.3
@


1.51
log
@These need to RUN_DEPENDS on x11/dbus,-suid now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2015/04/04 09:21:01 ajacoutot Exp $
d5 1
a5 1
V=		1.2.9
a7 1
REVISION=	1
@


1.50
log
@Bump after the recent changes in packaging dbus and dconf.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2015/02/21 05:01:57 ajacoutot Exp $
d8 1
a8 1
REVISION=	0
d41 3
@


1.49
log
@Bugfix update to colord-1.2.9.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2015/01/16 08:59:06 ajacoutot Exp $
d8 1
@


1.48
log
@Update to colord-1.2.8.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2014/12/05 07:19:35 ajacoutot Exp $
d5 1
a5 1
V=		1.2.8
d9 2
a10 2
SHARED_LIBS +=  colordprivate        1.1      # 2.2
SHARED_LIBS +=  colord               1.2      # 2.2
@


1.47
log
@Update to colord-1.2.7.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2014/11/25 05:19:29 ajacoutot Exp $
d5 1
a5 1
V=		1.2.7
@


1.46
log
@Update to colord-1.2.6.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2014/11/13 09:34:38 ajacoutot Exp $
d5 1
a5 1
V=		1.2.6
@


1.45
log
@Update to colord-1.2.5.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2014/10/13 07:19:42 ajacoutot Exp $
d5 1
a5 1
V=		1.2.5
d60 2
@


1.44
log
@Update to colord-1.2.4.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2014/10/07 07:33:30 ajacoutot Exp $
d5 1
a5 1
V=		1.2.4
@


1.43
log
@Fix profile DB directory.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2014/09/13 16:36:53 ajacoutot Exp $
d5 1
a5 1
V=		1.2.3
a7 1
REVISION=	0
d10 1
a10 1
SHARED_LIBS +=  colord               1.1      # 2.2
@


1.42
log
@--disable-gtk-doc is handled by the infrastructure now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2014/09/13 05:00:05 ajacoutot Exp $
d8 1
@


1.41
log
@Update to colord-1.2.3.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2014/08/26 07:18:12 ajacoutot Exp $
a52 1
		--disable-gtk-doc \
a56 6

# If one of these tools is found at configure stage, it might be used,
# no matter whether we use --disable-gtk-doc or not.
CONFIGURE_ENV +=ac_cv_path_GTKDOC_CHECK="" \
		ac_cv_path_GTKDOC_REBASE="" \
		ac_cv_path_GTKDOC_MKPDF=""
@


1.40
log
@Update to colord-1.2.2.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2014/06/30 13:13:04 kettenis Exp $
d5 1
a5 1
V=		1.2.2
d9 2
a10 2
SHARED_LIBS +=  colordprivate        1.0      # 2.1
SHARED_LIBS +=  colord               1.0      # 2.1
@


1.39
log
@Builds again on hppa after fixing graphics/lcms2.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2014/06/04 13:37:20 ajacoutot Exp $
d5 1
a5 1
V=		1.2.1
@


1.38
log
@Update to colord-1.2.1.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2014/05/19 17:36:28 landry Exp $
a3 1
BROKEN-hppa= SIGBUS in cd-create-profile during build
@


1.37
log
@Mark as BROKEN-hppa: SIGBUS during build on cd-create-profile.
Not that this takes out a large chunk of the tree, but who cares about gnome3 on hppa..
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2014/04/18 08:22:21 ajacoutot Exp $
d6 1
a6 1
V=		1.2.0
a8 1
REVISION=	0
@


1.36
log
@Fix building the CMF spectra on OpenBSD/sparc64 (from upstream).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2014/04/11 10:48:17 ajacoutot Exp $
d4 1
@


1.35
log
@Update to colord-1.2.0.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2014/03/31 15:19:59 sthen Exp $
d8 1
@


1.34
log
@missing build dep on dbus
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2014/01/28 08:46:34 ajacoutot Exp $
d5 1
a5 1
V=		1.0.6
d9 2
a10 2
SHARED_LIBS +=  colordprivate        0.1      # 1.22
SHARED_LIBS +=  colord               0.4      # 1.22
d55 1
a55 1
		--disable-gudev \
d74 3
d78 2
a79 7
	${SUBST_CMD} ${WRKSRC}/src/{cd-profile-store.c,cd-profile.c}
	perl -pi -e 's,-Wclobbered,,g;' \
		-e 's,-Wempty-body,,g;' \
		-e 's,-Wignored-qualifiers,,g;' \
		-e 's,-Wtype-limits,,g;' \
		-e 's,-Wmissing-parameter-type,,g' \
		${WRKSRC}/configure
@


1.33
log
@Update to colord-1.0.6.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2013/12/10 13:51:16 ajacoutot Exp $
d32 2
a33 1
		textproc/docbook2x
@


1.32
log
@Update to colord-1.0.5.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2013/11/11 15:52:40 ajacoutot Exp $
d5 1
a5 1
V=		1.0.5
@


1.31
log
@Update to colord-1.0.4.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2013/09/13 14:23:01 ajacoutot Exp $
d5 1
a5 1
V=		1.0.4
d9 2
a10 2
SHARED_LIBS +=  colordprivate        0.1      # 1.21
SHARED_LIBS +=  colord               0.4      # 1.21
@


1.30
log
@Update to colord-1.0.3.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2013/08/06 19:10:05 ajacoutot Exp $
d5 1
a5 1
V=		1.0.3
@


1.29
log
@Update to colord 1.0.2.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2013/06/01 18:35:24 ajacoutot Exp $
d5 1
a5 1
V=		1.0.2
d9 2
a10 2
SHARED_LIBS +=  colordprivate        0.1      # 1.20
SHARED_LIBS +=  colord               0.4      # 1.20
d34 1
a34 1
LIB_DEPENDS=	graphics/lcms2>=2.4p0 \
@


1.28
log
@Update to colord-1.0.0.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2013/05/30 18:17:18 ajacoutot Exp $
d5 1
a5 1
V=		1.0.0
@


1.27
log
@Update to colord-0.1.34.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2013/04/30 09:09:40 stsp Exp $
d5 1
a5 1
V=		0.1.34
d9 2
a10 2
SHARED_LIBS +=  colordprivate        0.1      # 1.19
SHARED_LIBS +=  colord               0.3      # 1.19
@


1.26
log
@Fix colord build on sparc64 and other architectures.
Patch already committed upstream.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2013/04/18 13:57:14 ajacoutot Exp $
d5 1
a5 2
V=		0.1.33
REVISION=	0
d67 3
@


1.25
log
@Update to colord-0.1.33.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2013/03/31 19:46:48 ajacoutot Exp $
d6 1
@


1.24
log
@Forgot that part in previous.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2013/03/31 19:41:23 ajacoutot Exp $
d5 1
a5 1
V=		0.1.32
a7 1
REVISION=	0
@


1.23
log
@Update to colord-0.1.32.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2013/03/30 13:03:45 ajacoutot Exp $
d8 1
@


1.22
log
@Anything that uses polkit should really RUN_DEPENDS on consolekit;
otherwise we have no way to know the active session.

discussed/agreed with jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2013/03/21 08:45:17 ajacoutot Exp $
d5 1
a5 1
V=		0.1.30
a7 1
REVISION=	0
d9 2
a10 2
SHARED_LIBS +=  colordprivate        0.0      # 1.18
SHARED_LIBS +=  colord               0.2      # 1.18
d34 1
a34 1
LIB_DEPENDS=	graphics/lcms2 \
a68 22

### XXX RM FOR NEXT RELEASE
# rm the following patches
# patch-configure_ac
# patch-lib_Makefile_am
# patch-m4_intltool_m4
# patch-src_Makefile_am
# patch-src_cd-sensor_c
# patch-src_cd-sensor_h
AUTOCONF_VERSION=	2.69
AUTOMAKE_VERSION=	1.11
BUILD_DEPENDS +=	${MODGNU_AUTOMAKE_DEPENDS} \
			${MODGNU_AUTOCONF_DEPENDS} \
			devel/libtool

post-patch:
	cd ${WRKSRC} && env \
		AUTOCONF_VERSION=${AUTOCONF_VERSION} \
		AUTOMAKE_VERSION=${AUTOMAKE_VERSION} \
		autoreconf -i --force && \
		intltoolize --force
### END XXX
@


1.21
log
@USE_LIBTOOL=Yes is the default now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2013/03/11 11:10:51 espie Exp $
d8 1
d38 3
d42 1
a42 1
TEST_DEPENDS=STEM-=${V}:${BUILD_PKGPATH}
@


1.20
log
@PERMIT_* / REGRESS -> TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2013/03/08 06:58:38 ajacoutot Exp $
a40 1
USE_LIBTOOL=	Yes
@


1.19
log
@Update to colord-0.1.30.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2012/12/03 10:11:07 ajacoutot Exp $
a19 3
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
d38 1
a38 1
REGRESS_DEPENDS=STEM-=${V}:${BUILD_PKGPATH}
@


1.18
log
@Update to colord-0.1.25.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2012/09/27 06:55:04 ajacoutot Exp $
d5 2
a6 1
DISTNAME=	colord-0.1.25
d9 2
a10 1
SHARED_LIBS +=  colord               0.1      # 1.11
d29 2
a30 1
MODULES=	devel/gettext \
d33 2
a34 2
BUILD_DEPENDS=	lang/vala \
		devel/gobject-introspection \
d37 2
a38 2
LIB_DEPENDS=	sysutils/polkit \
		graphics/lcms2
d40 2
a41 3
# technically not needed, however it is handy to have some profiles to
# start working with
RUN_DEPENDS-main=graphics/shared-color-profiles
d54 1
d65 4
d71 22
d94 1
a94 2
	${SUBST_CMD} ${WRKSRC}/etc/colord.conf.in \
		 ${WRKSRC}/src/{cd-profile-store.c,cd-profile.c}
d104 1
@


1.17
log
@Update to colord-0.1.23.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2012/09/21 14:48:05 ajacoutot Exp $
d5 1
a5 1
DISTNAME=	colord-0.1.23
d50 1
a51 1
		--disable-reverse \
d53 2
a54 2
		--with-daemon-user=_colord \
		--disable-sane # needs gudev, libgusb
@


1.16
log
@Stupid autohell is stupid...
The situation is this: even when we --disable-gtk-doc, if gtk-doc is
actually installed at configure stage, tools like gtkdoc-rebase will be
picked up and run during the install target. That is bad because the
gtk-doc package may have been removed by then, especially during dpb(1)
bulks (we explicitely disable support for it so why should it stay...).

So for now, let's add the following env to configure whenever we use
--disable-gtk-doc, until a bettersolution is found...
CONFIGURE_ENV +=ac_cv_path_GTKDOC_CHECK="" \
		ac_cv_path_GTKDOC_REBASE="" \
		ac_cv_path_GTKDOC_MKPDF=""
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2012/08/04 15:00:16 ajacoutot Exp $
d5 1
a5 1
DISTNAME=	colord-0.1.22
d75 1
a75 1
	rm -r ${WRKINST}/lib
@


1.15
log
@Update to colord-0.1.22.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2012/05/28 16:38:35 ajacoutot Exp $
d55 6
@


1.14
log
@Seems I still don't quite understand the ports framework... with help
from espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2012/05/28 15:52:26 ajacoutot Exp $
d3 1
a3 2
COMMENT-main=	device color profile management daemon
COMMENT-gtk=	GTK integration for libcolord
d5 1
a5 2
V=		0.1.21
DISTNAME=	colord-${V}
a6 4
PKGNAME-main=	${DISTNAME}
PKGNAME-gtk=	colord-gtk-${V}

REVISION-main=	1
a8 1
SHARED_LIBS +=  colord-gtk           0.0      # 1.11
d10 1
a10 1
CATEGORIES=	graphics x11
d22 2
a23 5
WANTLIB += ffi gio-2.0 glib-2.0 gmodule-2.0 gobject-2.0 gthread-2.0
WANTLIB += lcms2 m pcre z

WANTLIB-main += ${WANTLIB}
WANTLIB-main += c polkit-gobject-1 pthread sqlite3
a26 5
PSEUDO_FLAVORS=	no_gtk bootstrap
FLAVOR?=

MULTI_PACKAGES=	-main -gtk

d34 1
a34 1
LIB_DEPENDS-main=sysutils/polkit \
a57 16
.include <bsd.port.arch.mk>

.if ${BUILD_PACKAGES:M-gtk}
WANTLIB-gtk += ${WANTLIB}
WANTLIB-gtk += GL X11 Xau Xcomposite Xcursor Xdamage Xdmcp Xext Xfixes
WANTLIB-gtk += Xi Xinerama Xrandr Xrender Xxf86vm atk-1.0 cairo cairo-gobject
WANTLIB-gtk += colord drm expat fontconfig freetype gdk-3 gdk_pixbuf-2.0
WANTLIB-gtk += gtk-3 pango-1.0 pangocairo-1.0 pangoft2-1.0 pixman-1
WANTLIB-gtk += png pthread-stubs stdc++ xcb xcb-render xcb-shm
LIB_DEPENDS-gtk=graphics/colord,-main \
		x11/gtk+3
CONFIGURE_ARGS += --enable-gtk
.else
CONFIGURE_ARGS += --disable-gtk
.endif

d69 1
a69 1
	rm -rf ${WRKINST}/lib
@


1.13
log
@Add GTK support and split colord into -main and -gtk.
Since -gtk adds a cyclic dependency with x11/gtk+3, hack around
PSEUDO_FLAVOR with a bootstrap and no_gtk FLAVORs.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2012/05/28 08:56:36 ajacoutot Exp $
d38 1
a38 1
FLAVOR?=	no_gtk bootstrap
@


1.12
log
@Disable gtk dependency that sneaked in.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2012/05/28 08:45:38 ajacoutot Exp $
d3 2
a4 1
COMMENT=	device color profile management daemon
d6 2
a7 1
DISTNAME=	colord-0.1.21
d9 4
a12 1
REVISION=	0
d17 1
a17 1
CATEGORIES=	graphics devel
d29 5
a33 2
WANTLIB += c ffi gio-2.0 glib-2.0 gmodule-2.0 gobject-2.0 gthread-2.0
WANTLIB += lcms2 m pcre polkit-gobject-1 pthread sqlite3 z
d37 5
d49 1
a49 1
LIB_DEPENDS=	sysutils/polkit \
d54 1
a54 1
RUN_DEPENDS=	graphics/shared-color-profiles
a67 1
		--disable-gtk \
d72 16
@


1.11
log
@Update to colord-0.1.21.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2012/04/28 10:52:08 ajacoutot Exp $
d7 1
d24 2
a25 8
WANTLIB += GL X11 Xau Xcomposite Xcursor Xdamage Xdmcp Xext Xfixes
WANTLIB += Xi Xinerama Xrandr Xrender Xxf86vm atk-1.0 c cairo
WANTLIB += cairo-gobject drm expat ffi fontconfig freetype gdk-3
WANTLIB += gdk_pixbuf-2.0 gio-2.0 glib-2.0 gmodule-2.0 gobject-2.0
WANTLIB += gthread-2.0 gtk-3 lcms2 m pango-1.0 pangocairo-1.0
WANTLIB += pangoft2-1.0 pcre pixman-1 png polkit-gobject-1 pthread
WANTLIB += pthread-stubs sqlite3 stdc++ xcb xcb-render xcb-shm
WANTLIB += z
d37 1
a37 2
		graphics/lcms2 \
		x11/gtk+3
d55 1
@


1.10
log
@--localstatedir=/var is the default now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2012/04/13 15:03:01 ajacoutot Exp $
d5 1
a5 1
DISTNAME=	colord-0.1.18
a6 1
REVISION=	1
d8 2
a9 1
SHARED_LIBS +=  colord               0.0      # 1.4
d23 8
a30 2
WANTLIB += c ffi gio-2.0 glib-2.0 gmodule-2.0 gobject-2.0 gthread-2.0
WANTLIB += lcms2 m pcre polkit-gobject-1 pthread sqlite3 z
d42 2
a43 1
		graphics/lcms2
d77 1
a77 5
	rm -rf ${WRKINST}/lib ${PREFIX}/var
	# needs gudev
	rm ${PREFIX}/share/examples/colord/dbus-1/system.d/org.freedesktop.colord-sane.conf \
		${PREFIX}/share/dbus-1/system-services/org.freedesktop.colord-sane.service \
		${PREFIX}/share/dbus-1/interfaces/org.freedesktop.colord.sane.xml
@


1.9
log
@Fix localstatedir.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2012/03/19 18:10:35 ajacoutot Exp $
a49 1
		--localstatedir=/var \
@


1.8
log
@Add extraunexec goo to remove the mapping and storage DB.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2012/03/19 12:23:13 ajacoutot Exp $
d7 1
a7 1
REVISION=	0
d50 1
@


1.7
log
@Add comment about libgusb.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2012/03/19 08:59:00 ajacoutot Exp $
d7 1
@


1.6
log
@Update to colord-0.1.18.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2012/01/09 16:28:25 ajacoutot Exp $
d54 1
a54 1
		--disable-sane # needs gudev
@


1.5
log
@Bugfix update to colord-0.1.15.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2011/11/26 08:47:08 ajacoutot Exp $
d5 1
a5 1
DISTNAME=	colord-0.1.15
d23 1
a23 2
WANTLIB += jpeg lcms2 m pcre polkit-gobject-1 pthread sane sqlite3
WANTLIB += tiff usb usb-1.0 z
d34 1
a34 3
LIB_DEPENDS=	devel/libusb1 \
		graphics/sane-backends \
		sysutils/polkit \
d52 3
a54 1
		--disable-gudev
d70 4
@


1.4
log
@SECURITY: bring a couple of patches from upstream to fix SA46940
(Multiple SQL Injection Vulnerabilities)

Build man pages while here.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2011/11/13 18:02:33 ajacoutot Exp $
d5 1
a5 1
DISTNAME=	colord-0.1.14
a6 2

REVISION=	1
@


1.3
log
@Missing textproc/intltool MODULE, spotted by nigel@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2011/11/02 17:55:33 ajacoutot Exp $
d8 1
a8 1
REVISION=	0
d34 2
a35 1
		devel/gobject-introspection
@


1.2
log
@Add a RUN_DEPENDS on shared-color-profiles.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2011/11/02 16:40:22 ajacoutot Exp $
d30 2
a31 1
MODULES=	devel/gettext
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d8 2
d39 4
@


1.1.1.1
log
@Import colord-0.1.14.

colord is a system activated daemon that makes it easy to manage,
install and generate color profiles to accurately color manage input and
output devices.

ok jasper@@ (on a previous diff)
@
text
@@
