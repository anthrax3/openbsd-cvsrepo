head	1.30;
access;
symbols
	OPENBSD_6_1:1.29.0.2
	OPENBSD_6_1_BASE:1.29
	OPENBSD_6_0:1.27.0.4
	OPENBSD_6_0_BASE:1.27
	OPENBSD_5_9:1.27.0.2
	OPENBSD_5_9_BASE:1.27
	OPENBSD_5_8:1.24.0.8
	OPENBSD_5_8_BASE:1.24
	OPENBSD_5_7:1.24.0.4
	OPENBSD_5_7_BASE:1.24
	OPENBSD_5_6:1.24.0.2
	OPENBSD_5_6_BASE:1.24
	OPENBSD_5_5:1.23.0.2
	OPENBSD_5_5_BASE:1.23
	OPENBSD_5_4:1.21.0.2
	OPENBSD_5_4_BASE:1.21
	OPENBSD_5_3:1.18.0.2
	OPENBSD_5_3_BASE:1.18
	OPENBSD_5_2:1.17.0.4
	OPENBSD_5_2_BASE:1.17
	OPENBSD_5_1_BASE:1.17
	OPENBSD_5_1:1.17.0.2
	OPENBSD_5_0:1.16.0.2
	OPENBSD_5_0_BASE:1.16
	OPENBSD_4_9:1.14.0.2
	OPENBSD_4_9_BASE:1.14
	OPENBSD_4_8:1.9.0.2
	OPENBSD_4_8_BASE:1.9
	OPENBSD_4_7:1.5.0.2
	OPENBSD_4_7_BASE:1.5
	OPENBSD_4_6:1.4.0.2
	OPENBSD_4_6_BASE:1.4
	sthen_20090419:1.1.1.1
	sthen:1.1.1;
locks; strict;
comment	@# @;


1.30
date	2017.04.19.11.16.03;	author sthen;	state Exp;
branches;
next	1.29;
commitid	RQY4uecaoLumt4eI;

1.29
date	2016.11.24.08.16.03;	author kirby;	state Exp;
branches;
next	1.28;
commitid	Ns7zHlM25gEC97w3;

1.28
date	2016.10.25.12.25.32;	author jca;	state Exp;
branches;
next	1.27;
commitid	Ig5yUZJCLZycf6En;

1.27
date	2015.10.08.12.02.03;	author jasper;	state Exp;
branches;
next	1.26;
commitid	Fd81pQbB9Yvd8TB7;

1.26
date	2015.09.22.18.47.52;	author pascal;	state Exp;
branches;
next	1.25;
commitid	rLFV4JCgkelUH8yf;

1.25
date	2015.09.12.14.15.32;	author ajacoutot;	state Exp;
branches;
next	1.24;
commitid	JQABuKOhSyuXchE5;

1.24
date	2014.04.13.01.01.39;	author naddy;	state Exp;
branches;
next	1.23;

1.23
date	2013.11.27.18.22.42;	author landry;	state Exp;
branches;
next	1.22;

1.22
date	2013.11.25.14.16.22;	author sthen;	state Exp;
branches;
next	1.21;

1.21
date	2013.06.04.18.41.47;	author naddy;	state Exp;
branches;
next	1.20;

1.20
date	2013.03.11.11.10.52;	author espie;	state Exp;
branches;
next	1.19;

1.19
date	2013.03.08.01.30.37;	author brad;	state Exp;
branches;
next	1.18;

1.18
date	2012.12.21.17.55.57;	author landry;	state Exp;
branches;
next	1.17;

1.17
date	2011.09.16.10.02.36;	author espie;	state Exp;
branches;
next	1.16;

1.16
date	2011.04.28.19.11.51;	author sthen;	state Exp;
branches;
next	1.15;

1.15
date	2011.03.15.19.49.42;	author jasper;	state Exp;
branches;
next	1.14;

1.14
date	2011.01.07.18.14.08;	author jasper;	state Exp;
branches;
next	1.13;

1.13
date	2010.11.22.10.16.08;	author espie;	state Exp;
branches;
next	1.12;

1.12
date	2010.11.17.08.05.13;	author espie;	state Exp;
branches;
next	1.11;

1.11
date	2010.10.24.21.21.00;	author ajacoutot;	state Exp;
branches;
next	1.10;

1.10
date	2010.10.18.18.13.13;	author espie;	state Exp;
branches;
next	1.9;

1.9
date	2010.07.15.14.27.17;	author sthen;	state Exp;
branches;
next	1.8;

1.8
date	2010.07.11.20.09.00;	author sthen;	state Exp;
branches;
next	1.7;

1.7
date	2010.06.16.09.26.28;	author sthen;	state Exp;
branches;
next	1.6;

1.6
date	2010.06.16.09.19.07;	author landry;	state Exp;
branches;
next	1.5;

1.5
date	2009.08.10.06.31.44;	author kili;	state Exp;
branches;
next	1.4;

1.4
date	2009.04.21.13.09.39;	author sthen;	state Exp;
branches;
next	1.3;

1.3
date	2009.04.21.09.20.26;	author sthen;	state Exp;
branches;
next	1.2;

1.2
date	2009.04.20.23.28.03;	author sthen;	state Exp;
branches;
next	1.1;

1.1
date	2009.04.19.11.14.37;	author sthen;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2009.04.19.11.14.37;	author sthen;	state Exp;
branches;
next	;


desc
@@


1.30
log
@Add ${CLANG_ARCHS} to "ONLY_FOR_ARCHS = ${GCC4_ARCHS}" lines to give them
a chance on aarch64.
@
text
@# $OpenBSD: Makefile,v 1.29 2016/11/24 08:16:03 kirby Exp $

ONLY_FOR_ARCHS = ${GCC4_ARCHS} ${CLANG_ARCHS}
.if (${MACHINE_ARCH} != "i386" && ${MACHINE_ARCH} != "amd64" && ${MACHINE_ARCH} != "arm64")
# likely to bump into MAXDSIZ on arch other than the above
MAKE_ENV +=	CXXNOOPT=-O0
.endif

BROKEN-hppa =	linking fails with 'cannot handle R_PARISC_PCREL17F'
BROKEN-alpha =	enblend-enblend.o: .got subsegment exceeds 64K (size 77816)

COMMENT =	blend seams in panoramic image mosaics

DISTNAME =	enblend-enfuse-4.2
CATEGORIES =	graphics

HOMEPAGE =	http://enblend.sourceforge.net/

MAINTAINER =	Stuart Henderson <sthen@@openbsd.org>

# GPLv2+, MIT
PERMIT_PACKAGE_CDROM =	Yes

WANTLIB += Half Iex IexMath IlmImf IlmThread Imath c gsl gslcblas
WANTLIB += jpeg lcms2 m png pthread tiff vigraimpex z

MASTER_SITES =	${MASTER_SITE_SOURCEFORGE:=enblend/}

MODULES =	gcc4
MODGCC4_ARCHS =	*
MODGCC4_LANGS +=c++
BUILD_DEPENDS =	devel/help2man\
		math/gnuplot \
		print/texlive/base \
		print/transfig \
		www/tidyp>=1.04p1
LIB_DEPENDS =	devel/gsl \
		graphics/ilmbase \
		graphics/lcms2 \
		graphics/vigra

SEPARATE_BUILD = Yes
CONFIGURE_STYLE = autoconf
AUTOCONF_VERSION = 2.69
USE_GMAKE = Yes

CPPFLAGS +=	-I${LOCALBASE}/include \
		-I${X11BASE}/include

LDFLAGS +=	-L${LOCALBASE}/lib \
		-L${X11BASE}/lib


CONFIGURE_ENV =	CPPFLAGS="${CPPFLAGS}" \
		LDFLAGS="${LDFLAGS}"

CXXFLAGS +=	-std=c++11 -pthread

# need to fix bashisms in doc/Makefile.in first
#post-build:
#	@@cd ${WRKBUILD}/doc && \
#	    ${SETENV} ${MAKE_ENV} ${MAKE_PROGRAM} xhtml

.include <bsd.port.mk>
@


1.29
log
@Update to enblend-enfuse-4.2.
 - enable SEPARATE_BUILD while here
 - drop some patches merged upstream.
With some tweaks and OK from sthen@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2016/10/25 12:25:32 jca Exp $
d3 2
a4 2
ONLY_FOR_ARCHS = ${GCC4_ARCHS}
.if (${MACHINE_ARCH} != "i386" && ${MACHINE_ARCH} != "amd64")
@


1.28
log
@No need to set MODGNU_CONFIG_GUESS_DIRS to its default value.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2015/10/08 12:02:03 jasper Exp $
d14 1
a14 4
DISTNAME =	enblend-enfuse-4.0
PKGNAME =	${DISTNAME:L}
WRKDIST =	${WRKDIR}/enblend-enfuse-4.0-753b534c819d
REVISION =	4
d24 2
a25 3
WANTLIB += GL GLEW GLU Half ICE Iex IexMath IlmImf IlmThread Imath
WANTLIB += SM X11 Xi Xmu boost_system c glut jpeg lcms m png pthread
WANTLIB += stdc++ tiff xmi z
d29 6
a34 1
BUILD_DEPENDS =	math/gnuplot \
d37 1
a37 3
LIB_DEPENDS =	devel/boost \
		graphics/glew \
		graphics/freeglut \
d39 2
a40 5
		graphics/lcms \
		graphics/libxmi \
		graphics/openexr \
		graphics/png \
		graphics/tiff
d42 1
d44 1
a44 1
AUTOCONF_VERSION = 2.61
d47 1
a47 2
CPPFLAGS +=	-I${WRKSRC}/src/vigra_impex \
		-I${LOCALBASE}/include \
d57 2
a62 4

# Fix with newer GNUplot versions. From Gentoo bz #334331
post-extract:
	@@sed -i 's,FreeSans 10,"FreeSans\,10",g' ${WRKSRC}/doc/*.gp.in
@


1.27
log
@sed -i
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2015/09/22 18:47:52 pascal Exp $
a47 1
MODGNU_CONFIG_GUESS_DIRS = ${WRKSRC}
@


1.26
log
@sync WANTLIB after openexr update

ok zhuk@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2015/09/12 14:15:32 ajacoutot Exp $
d69 1
a69 1
	@@perl -pi -e 's,FreeSans 10,"FreeSans\,10",g' ${WRKSRC}/doc/*.gp.in
@


1.25
log
@CONFIGURE_STYLE=autoconf implies "gnu".
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2014/04/13 01:01:39 naddy Exp $
d17 1
a17 1
REVISION =	3
d27 3
a29 3
WANTLIB =	GL GLEW GLU Half ICE Iex IlmImf IlmThread Imath SM X11 Xi Xmu
WANTLIB +=	boost_filesystem boost_system c glut>=4 jpeg lcms m png pthread
WANTLIB +=	stdc++ tiff xmi z
@


1.24
log
@Drop USE_GROFF since groff and mandoc produce identical output.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2013/11/27 18:22:42 landry Exp $
d46 1
a46 1
CONFIGURE_STYLE = autoconf gnu
@


1.23
log
@BROKEN-alpha: enblend-enblend.o: .got subsegment exceeds 64K (size 77816)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2013/11/25 14:16:22 sthen Exp $
a49 1
USE_GROFF =	Yes
@


1.22
log
@kill VMEM_WARNING
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2013/06/04 18:41:47 naddy Exp $
d10 1
@


1.21
log
@the png headers are now directly under include/
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2013/03/11 11:10:52 espie Exp $
a2 1
VMEM_WARNING =	Yes
@


1.20
log
@PERMIT_* / REGRESS -> TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2013/03/08 01:30:37 brad Exp $
a53 1
		-I${LOCALBASE}/include/libpng \
@


1.19
log
@Update for newer Boost.

From Amit Kulkarni.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2012/12/21 17:55:57 landry Exp $
a25 3
PERMIT_PACKAGE_FTP =	Yes
PERMIT_DISTFILES_CDROM =Yes
PERMIT_DISTFILES_FTP =	Yes
@


1.18
log
@Mark as BROKEN-hppa: it never built there.

/usr/bin/ld: enfuse-enfuse.o(.gnu.linkonce.t._ZNSaIPN5vigra15CachedFileImageIiEEEC1Ev+0x28): cannot reach 00001346__ZN9__gnu_cxx13new_allocatorIPN5vigra15CachedFileImageIiEEEC2Ev+0, recompile with -ffunction-sections
/usr/bin/ld: enfuse-enfuse.o(.gnu.linkonce.t._ZNSaIPN5vigra15CachedFileImageIiEEEC1Ev+0x28): cannot handle R_PARISC_PCREL17F for __gnu_cxx::new_allocator<vigra::CachedFileImage<int>*>::new_allocator()
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2011/09/16 10:02:36 espie Exp $
d17 1
a17 1
REVISION =	2
d49 2
a50 1
CONFIGURE_STYLE = gnu
@


1.17
log
@normalize pkgpath
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2011/04/28 19:11:51 sthen Exp $
d9 2
@


1.16
log
@- remove patch now we have FE_TONEAREST in fenv.h
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2011/03/15 19:49:42 jasper Exp $
d15 1
a15 1
REVISION =	1
@


1.15
log
@- switch from www/tidy to www/tidyp which is API compatible

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2011/01/07 18:14:08 jasper Exp $
d15 1
a15 1
REVISION =	0
@


1.14
log
@- fix after recent gnuplot update

spotted by landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2010/11/22 10:16:08 espie Exp $
d36 1
a36 1
		www/tidy
@


1.13
log
@remaining WANTLIB go .>=   to >=
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2010/11/17 08:05:13 espie Exp $
d15 1
d68 4
@


1.12
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2010/10/24 21:21:00 ajacoutot Exp $
d28 1
a28 1
WANTLIB +=	boost_filesystem boost_system c glut.>=4 jpeg lcms m png pthread
@


1.11
log
@Remove USE_X11.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2010/10/18 18:13:13 espie Exp $
d33 12
a44 12
BUILD_DEPENDS =	::math/gnuplot \
		::print/transfig \
		::www/tidy
LIB_DEPENDS =	::devel/boost \
		::graphics/glew \
		::graphics/freeglut \
		::graphics/ilmbase \
		::graphics/lcms \
		::graphics/libxmi \
		::graphics/openexr \
		::graphics/png \
		::graphics/tiff
@


1.10
log
@USE_GROFF=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2010/07/15 14:27:17 sthen Exp $
a58 1
USE_X11 =	Yes
@


1.9
log
@add missing BUILD_DEPENDS, packaging failure noted by espie@@
(missing .info files). no bump.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2010/07/11 20:09:00 sthen Exp $
d49 1
@


1.8
log
@update enblend-enfuse to 4.0, with a patch to allow documentation to
built with in-tree texinfo (it wanted the textdegree macro which wasn't
added until texinfo-4.11).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2010/06/16 09:26:28 sthen Exp $
d33 3
a35 1
BUILD_DEPENDS =	::print/transfig
d62 5
@


1.7
log
@add a comment saying quite how much ram is needed to build this
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2010/06/16 09:19:07 landry Exp $
d4 1
a4 5
# and I'm not joking! - don't waste build time on the following arch
# where MAXDSIZ is simply too low to compile this software:
NOT_FOR_ARCHS = m68k m88k sparc vax
# and restrict to -O0 for the largest files, except on selected arch
# (needs approx 1.3GB datasize to build with -O2 on 64-bit gcc4 arch)
d6 1
d12 3
a14 2
DISTNAME =	enblend-enfuse-3.2
PKGNAME =	${DISTNAME}p1
d27 3
a29 2
WANTLIB =	GL GLU ICE SM X11 Xi Xmu c jpeg m pthread pthread-stubs xcb \
		stdc++ z
d33 10
a42 10
BUILD_DEPENDS += ::devel/boost

LIB_DEPENDS =	GLEW::graphics/glew \
		glut.>=4::graphics/freeglut \
		Half,Iex,IlmThread,Imath::graphics/ilmbase \
		lcms::graphics/lcms \
		xmi::graphics/libxmi \
		IlmImf::graphics/openexr \
		png::graphics/png \
		tiff::graphics/tiff
d46 1
@


1.6
log
@Use -O0 instead of -01 on  !(i386||amd64), makes sparc64 happier, and
maybe alpha too.
ok/tweaks sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2009/08/10 06:31:44 kili Exp $
d8 1
@


1.5
log
@WANTLIB changes after xcb addition and bump.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2009/04/21 13:09:39 sthen Exp $
d7 3
a9 4
# and restrict to -O1 for the largest files, except on selected arch
.if (${MACHINE_ARCH} != "i386" && ${MACHINE_ARCH} != "sparc64" && \
    ${MACHINE_ARCH} != "amd64")
MAKE_ENV +=	CXXNOOPT=-O1
@


1.4
log
@restrict optimizer flags to -O1 except on amd64, i386, sparc64.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2009/04/21 09:20:26 sthen Exp $
d16 1
a16 1
PKGNAME =	${DISTNAME}p0
d29 2
a30 1
WANTLIB +=	GL GLU ICE SM X11 Xi Xmu c jpeg m pthread stdc++ z
@


1.3
log
@Makefile patch to allow building just the largest files with different
optimization levels. No package change yet -> no bump.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2009/04/20 23:28:03 sthen Exp $
d7 5
a11 6
# other arch may need MAXDSIZ adjustment, lower optimization levels,
# or may fail completely. i386 sparc64 and amd64 known to build given
# enough RAM.
#
# MAKE_ENV +=	CXXNOOPT=-O
# MAKE_ENV +=	CXXNOOPT=-O0
d16 1
@


1.2
log
@knock out a few arch which have no hope of building this
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2009/04/19 11:14:37 sthen Exp $
d10 3
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.template,v 1.54 2008/01/13 16:43:57 espie Exp $
d4 6
a9 1
# and I'm not joking!
@


1.1.1.1
log
@import graphics/enblend-enfuse:

Enblend combines images that partially overlap into a single large
image with no seams (panorama generation). This is a command-line
tool which performs the actual composition; another tool is required
to line up the images ready for input (e.g. Hugin).

Enfuse combines images that overlap into a single image with good
focus and exposure (exposure stacking for high dynamic range, focus
stacking for extended depth-of-field).

will be hooked to the build after tests on additional arch.
big thanks to Emmanuel Viaud for rewriting some C++ to build with GCC 3.
@
text
@@
