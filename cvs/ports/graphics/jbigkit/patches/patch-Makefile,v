head	1.5;
access;
symbols
	OPENBSD_6_2:1.5.0.14
	OPENBSD_6_2_BASE:1.5
	OPENBSD_6_1:1.5.0.12
	OPENBSD_6_1_BASE:1.5
	OPENBSD_6_0:1.5.0.10
	OPENBSD_6_0_BASE:1.5
	OPENBSD_5_9:1.5.0.6
	OPENBSD_5_9_BASE:1.5
	OPENBSD_5_8:1.5.0.8
	OPENBSD_5_8_BASE:1.5
	OPENBSD_5_7:1.5.0.4
	OPENBSD_5_7_BASE:1.5
	OPENBSD_5_6:1.5.0.2
	OPENBSD_5_6_BASE:1.5
	OPENBSD_5_5:1.4.0.4
	OPENBSD_5_5_BASE:1.4
	OPENBSD_5_4:1.4.0.2
	OPENBSD_5_4_BASE:1.4
	OPENBSD_5_3:1.3.0.30
	OPENBSD_5_3_BASE:1.3
	OPENBSD_5_2:1.3.0.28
	OPENBSD_5_2_BASE:1.3
	OPENBSD_5_1_BASE:1.3
	OPENBSD_5_1:1.3.0.26
	OPENBSD_5_0:1.3.0.24
	OPENBSD_5_0_BASE:1.3
	OPENBSD_4_9:1.3.0.22
	OPENBSD_4_9_BASE:1.3
	OPENBSD_4_8:1.3.0.20
	OPENBSD_4_8_BASE:1.3
	OPENBSD_4_7:1.3.0.18
	OPENBSD_4_7_BASE:1.3
	OPENBSD_4_6:1.3.0.16
	OPENBSD_4_6_BASE:1.3
	OPENBSD_4_5:1.3.0.14
	OPENBSD_4_5_BASE:1.3
	OPENBSD_4_4:1.3.0.12
	OPENBSD_4_4_BASE:1.3
	OPENBSD_4_3:1.3.0.10
	OPENBSD_4_3_BASE:1.3
	OPENBSD_4_2:1.3.0.8
	OPENBSD_4_2_BASE:1.3
	OPENBSD_4_1:1.3.0.6
	OPENBSD_4_1_BASE:1.3
	OPENBSD_4_0:1.3.0.4
	OPENBSD_4_0_BASE:1.3
	OPENBSD_3_9:1.3.0.2
	OPENBSD_3_9_BASE:1.3
	OPENBSD_3_8:1.2.0.8
	OPENBSD_3_8_BASE:1.2
	OPENBSD_3_7:1.2.0.6
	OPENBSD_3_7_BASE:1.2
	OPENBSD_3_6:1.2.0.4
	OPENBSD_3_6_BASE:1.2
	OPENBSD_3_5:1.2.0.2
	OPENBSD_3_5_BASE:1.2;
locks; strict;
comment	@# @;


1.5
date	2014.04.08.13.59.32;	author sthen;	state Exp;
branches;
next	1.4;

1.4
date	2013.04.13.08.53.10;	author ajacoutot;	state Exp;
branches
	1.4.4.1;
next	1.3;

1.3
date	2005.12.26.18.00.16;	author brad;	state Exp;
branches;
next	1.2;

1.2
date	2004.02.25.20.31.01;	author brad;	state Exp;
branches;
next	1.1;

1.1
date	2004.01.11.08.20.06;	author brad;	state Exp;
branches;
next	;

1.4.4.1
date	2014.05.20.08.56.38;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.5
log
@SECURITY update to jbigkit 2.1 (no ABI change)

  - fixed a buffer-overflow vulnerability in the jbig.c decoder,
    reported by Florian Weimer (Red Hat): CVE-2013-6369

  - fixed ability of corrupted input data to force jbig85.c decoder
    into an end-less loop

  - fixed a bug in the processing of private deterministic-prediction
    tables (DPPRIV=1) in jbig.c decoder

  - fixed integer-type mismatches in printf arguments on 64-bit systems

  - fuzz-testing script added
@
text
@$OpenBSD$
--- Makefile.orig	Tue Apr  8 14:41:53 2014
+++ Makefile	Tue Apr  8 14:42:35 2014
@@@@ -7,8 +7,6 @@@@ CC = gcc
 CFLAGS = -O2 -W -Wno-unused-result
 # CFLAGS = -O -g -W -Wall -Wno-unused-result -ansi -pedantic # -DDEBUG
 
-export CC CFLAGS
-
 VERSION=2.1
 
 all: lib pbm
@


1.4
log
@Update to jbigkit-2.0.
This adds the lightweitgh version of the jbig library: jbig85 which is
needed by a WIP update of graphics/splix.

from Martin Crossley with some tweaks
@
text
@d1 10
a10 5
$OpenBSD: patch-Makefile,v 1.3 2005/12/26 18:00:16 brad Exp $
--- Makefile.orig	Sat Aug 30 21:40:22 2008
+++ Makefile	Fri Apr 12 15:07:03 2013
@@@@ -13,22 +13,22 @@@@ CFLAGS = $(CCFLAGS) -I../libjbig
 VERSION=2.0
a12 27
-	@@echo "Enter 'make test' in order to start some automatic tests."
+#	@@echo "Enter '$(MAKE) test' in order to start some automatic tests."
 
 lib:
-	(cd libjbig;  make "CC=$(CC)" "CFLAGS=$(CFLAGS)")
+	(cd libjbig;  $(MAKE) "CC=$(CC)" "CFLAGS=$(CFLAGS)" "VERSION=$(VERSION)")
 
 pbm: lib
-	(cd pbmtools; make "CC=$(CC)" "CFLAGS=$(CFLAGS)")
+	(cd pbmtools; $(MAKE) "CC=$(CC)" "CFLAGS=$(CFLAGS)")
 
-test: lib pbm
-	(cd libjbig;  make "CC=$(CC)" "CFLAGS=$(CFLAGS)" test)
-	(cd pbmtools; make "CC=$(CC)" "CFLAGS=$(CFLAGS)" test)
+test regress: lib pbm
+	(cd libjbig;  $(MAKE) "CC=$(CC)" "CFLAGS=$(CFLAGS)" test)
+	(cd pbmtools; $(MAKE) "CC=$(CC)" "CFLAGS=$(CFLAGS)" test)
 
 clean:
 	rm -f *~ core
-	(cd libjbig; make clean)
-	(cd pbmtools; make clean)
+	(cd libjbig; $(MAKE) clean)
+	(cd pbmtools; $(MAKE) clean)
 
 distribution: clean
 	rm -f libjbig/libjbig*.a
@


1.4.4.1
log
@SECURITY update to jbigkit 2.1 (no ABI change)

ok sthen@@
@
text
@d1 5
a5 10
$OpenBSD: patch-Makefile,v 1.5 2014/04/08 13:59:32 sthen Exp $
--- Makefile.orig	Tue Apr  8 14:41:53 2014
+++ Makefile	Tue Apr  8 14:42:35 2014
@@@@ -7,8 +7,6 @@@@ CC = gcc
 CFLAGS = -O2 -W -Wno-unused-result
 # CFLAGS = -O -g -W -Wall -Wno-unused-result -ansi -pedantic # -DDEBUG
 
-export CC CFLAGS
-
 VERSION=2.1
d8 27
@


1.3
log
@upgrade to jbigkit 1.6
@
text
@d1 3
a3 3
$OpenBSD: patch-Makefile,v 1.2 2004/02/25 20:31:01 brad Exp $
--- Makefile.orig	Fri Jun 11 14:05:26 2004
+++ Makefile	Mon Dec 26 12:53:54 2005
d5 1
a5 1
 VERSION=1.6
d9 1
a9 1
+	@@echo "Enter '$(MAKE) test' in order to start some automatic tests."
d34 1
a34 1
 	rm -f libjbig/libjbig.a
@


1.2
log
@upgrade to jbigkit 1.5
@
text
@d1 3
a3 3
$OpenBSD: patch-Makefile,v 1.1 2004/01/11 08:20:06 brad Exp $
--- Makefile.orig	2003-06-11 12:55:50.000000000 -0400
+++ Makefile	2004-02-25 15:19:19.000000000 -0500
d5 1
a5 1
 VERSION=1.5
@


1.1
log
@- add license comment
- set LD_LIBRARY_PATH via MAKE_ENV
- remove test target
- sync patch names with update-patches
@
text
@d1 9
a9 5
$OpenBSD$
--- Makefile.orig	2000-04-08 07:19:41.000000000 -0400
+++ Makefile	2004-01-11 03:03:23.000000000 -0500
@@@@ -16,7 +16,7 @@@@ all: lib pbm
 	@@echo "Enter 'make test' in order to start some automatic tests."
d13 1
a13 1
+	(cd libjbig;  make "CC=$(CC)" "CFLAGS=$(CFLAGS)" "VERSION=$(VERSION)")
d16 19
a34 18
 	(cd pbmtools; make "CC=$(CC)" "CFLAGS=$(CFLAGS)")
@@@@ -45,3 +45,16 @@@@ distribution: clean
 	scp ANNOUNCE \
 	  $(DISTUID)@@$(DISTHOST):$(DISTPATH)/jbigkit-$(VERSION)-announce.txt
 	mv ../jbigkit-$(VERSION).tar.gz $(HOME)/.www/download/
+
+install:
+	${BSD_INSTALL_PROGRAM_DIR} ${PREFIX}/bin
+	${BSD_INSTALL_DATA_DIR} ${PREFIX}/include
+	${BSD_INSTALL_DATA_DIR} ${PREFIX}/lib
+	${BSD_INSTALL_MAN_DIR} ${PREFIX}/man/man1
+	cd pbmtools; ${BSD_INSTALL_PROGRAM} jbgtopbm pbmtojbg ${PREFIX}/bin; \
+	${BSD_INSTALL_MAN} jbgtopbm.1 pbmtojbg.1 ${PREFIX}/man/man1
+	${BSD_INSTALL_DATA} libjbig/jbig.h ${PREFIX}/include
+	${BSD_INSTALL_DATA} libjbig/libjbig.a ${PREFIX}/lib
+	@@if [ -f libjbig/libjbig.so.$(VERSION) ]; then \
+	 ${BSD_INSTALL_DATA} libjbig/libjbig.so.$(VERSION) ${PREFIX}/lib; \
+	fi
@

