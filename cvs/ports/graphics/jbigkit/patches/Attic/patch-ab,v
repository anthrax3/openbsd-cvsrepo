head	1.7;
access;
symbols
	OPENBSD_3_4:1.6.0.14
	OPENBSD_3_4_BASE:1.6
	OPENBSD_3_3:1.6.0.12
	OPENBSD_3_3_BASE:1.6
	OPENBSD_3_2:1.6.0.10
	OPENBSD_3_2_BASE:1.6
	OPENBSD_3_1:1.6.0.8
	OPENBSD_3_1_BASE:1.6
	OPENBSD_3_0:1.6.0.6
	OPENBSD_3_0_BASE:1.6
	OPENBSD_2_9_TRACKING_SWITCH:1.6
	OPENBSD_2_9:1.6.0.4
	OPENBSD_2_9_BASE:1.6
	OPENBSD_2_8:1.6.0.2
	OPENBSD_2_8_BASE:1.6
	OPENBSD_2_7:1.4.0.2
	OPENBSD_2_7_BASE:1.4
	OPENBSD_2_6:1.2.0.2
	OPENBSD_2_6_BASE:1.2
	brad_1999-05-08:1.1.1.1
	brad:1.1.1;
locks; strict;
comment	@# @;


1.7
date	2004.01.11.08.20.06;	author brad;	state dead;
branches;
next	1.6;

1.6
date	2000.10.16.19.47.30;	author brad;	state Exp;
branches;
next	1.5;

1.5
date	2000.09.24.02.38.01;	author brad;	state Exp;
branches;
next	1.4;

1.4
date	2000.03.23.06.52.00;	author brad;	state Exp;
branches;
next	1.3;

1.3
date	99.12.27.06.12.09;	author brad;	state Exp;
branches;
next	1.2;

1.2
date	99.06.11.18.28.00;	author brad;	state Exp;
branches;
next	1.1;

1.1
date	99.05.08.19.17.39;	author brad;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	99.05.08.19.17.39;	author brad;	state Exp;
branches;
next	;


desc
@@


1.7
log
@- add license comment
- set LD_LIBRARY_PATH via MAKE_ENV
- remove test target
- sync patch names with update-patches
@
text
@--- libjbig/Makefile.orig	Sat Apr  8 07:15:46 2000
+++ libjbig/Makefile	Mon Oct 16 15:18:00 2000
@@@@ -7,16 +7,31 @@@@
 # Options for the compiler: A high optimization level is suggested
 CFLAGS = -O -Wall -ansi -pedantic
 
-all: libjbig.a tstcodec
+PICFLAG= -fpic
+
+.if defined(NO_SHARED_LIBS) && ${NO_SHARED_LIBS:L} == "yes"
+all: libjbig.a
+.else
+all: libjbig.a libjbig.so.$(VERSION)
+.endif
 
 tstcodec: tstcodec.c jbig.c jbig.h jbig_tab.o
 	$(CC) $(CFLAGS) -o tstcodec -DTEST_CODEC tstcodec.c jbig.c \
 	jbig_tab.o
 
 libjbig.a: jbig.o jbig_tab.o
-	rm -f libjbig.a
-	ar rc libjbig.a jbig.o jbig_tab.o
-	ranlib libjbig.a
+	rm -f ${.TARGET}
+	ar rc ${.TARGET} ${.ALLSRC}
+	ranlib ${.TARGET}
+
+libjbig.so.$(VERSION): jbig.so jbig_tab.so
+	rm -f ${.TARGET}
+	${CC} -shared $(PICFLAG) -o ${.TARGET} ${.ALLSRC}
+	
+.SUFFIXES: .o .so
+
+.c.so:
+	${CC} ${CFLAGS} $(PICFLAG) -DPIC -c ${.IMPSRC} -o ${.TARGET}
 
 jbig.o: jbig.c jbig.h
 
@@@@ -24,4 +39,4 @@@@
 	./tstcodec
 
 clean:
-	rm -f *.o *~ core gmon.out dbg_d\=??.pbm tstcodec
+	rm -f *.o *~ core gmon.out dbg_d\=??.pbm tstcodec libjbig.so.$(VERSION) libjbig.a
@


1.6
log
@pass the pic flag along to the compiler when linking the shared library.
@
text
@@


1.5
log
@use "cc -shared" to create shared libraries
@
text
@d2 2
a3 2
+++ libjbig/Makefile	Sat Sep 23 22:21:30 2000
@@@@ -7,16 +7,29 @@@@
d8 2
d30 1
a30 1
+	${CC} -shared -o ${.TARGET} ${.ALLSRC}
d35 1
a35 1
+	${CC} ${CFLAGS} -fpic -DPIC -c ${.IMPSRC} -o ${.TARGET}
d39 1
a39 1
@@@@ -24,4 +37,4 @@@@
@


1.4
log
@- make use of MAKE_FLAGS
- re-do install target using BSD_INSTALL_ macros
@
text
@d1 3
a3 3
--- libjbig/Makefile.orig	Fri Apr 10 21:33:27 1998
+++ libjbig/Makefile	Wed Mar 22 20:31:42 2000
@@@@ -7,21 +7,40 @@@@
d8 1
a8 1
+.if defined(NO_SHARED_LIBS) && ${NO_SHARED_LIBS:U} == YES
d28 1
a28 1
+	ld -Bshareable -Bforcearchive -o ${.TARGET} ${.ALLSRC}
d30 1
a30 4
+.SUFFIXES: .c .o .so
+
+.c.o:
+	${CC} ${CFLAGS} -c ${.IMPSRC} -o ${.TARGET}
a35 3
+jbig_tab.o: jbig_tab.c jbig.h
+jbig.so: jbig.c jbig.h
+jbig_tab.so: jbig_tab.c jbig.h
d37 1
a37 1
 test: tstcodec
@


1.3
log
@upgrade to jbigkit 1.1
@
text
@d2 2
a3 8
+++ libjbig/Makefile	Thu Dec  9 15:43:07 1999
@@@@ -2,26 +2,47 @@@@
 # $Id: Makefile,v 1.7 1998-04-11 02:26:33+01 mgk25 Rel $
 
 # Select an ANSI/ISO C compiler here, GNU gcc is recommended
-CC = gcc
+#CC = gcc
 
d5 1
a5 2
-CFLAGS = -O -Wall -ansi -pedantic
+#CFLAGS += -Wall -ansi -pedantic
a7 2
+SOJBIGLIB=libjbig.so.$(VERSION)
+
d11 1
a11 1
+all: libjbig.a $(SOJBIGLIB)
d26 1
a26 1
+$(SOJBIGLIB): jbig.so jbig_tab.so
@


1.2
log
@use -fpic instead of -fPIC and use -Bforcearchive while linking
@
text
@d2 2
a3 2
+++ libjbig/Makefile	Wed Jun  9 10:24:38 1999
@@@@ -2,12 +2,14 @@@@
d15 1
a15 1
+SOJBIGLIB=libjbig.so.1.0
d17 3
d21 1
d25 1
a25 3
@@@@ -18,10 +20,20 @@@@
 	ar rc libjbig.a jbig.o jbig_tab.o
 	ranlib libjbig.a
d27 8
d39 8
d48 3
a51 6
+.SUFFIXES: .c .so
+.c.so:
+	${CC} -c -fpic -DPIC ${CFLAGS} ${.IMPSRC} -o ${.TARGET}
+jbig.so: jbig.c jbig.h
+jbig_tab.so: jbig_tab.c
+
d57 1
a57 1
+	rm -f *.o *~ core gmon.out dbg_d\=??.pbm tstcodec libjbig.so.1.0 libjbig.a
@


1.1
log
@Initial revision
@
text
@d2 1
a2 1
+++ libjbig/Makefile	Sat May  8 15:10:58 1999
d27 1
a27 1
+	ld -Bshareable -o ${.TARGET} ${.ALLSRC}
d33 1
a33 1
+	${CC} -c -fPIC -DPIC ${CFLAGS} ${.IMPSRC} -o ${.TARGET}
@


1.1.1.1
log
@add jbigkit port
-
A lossless image compression library
@
text
@@
