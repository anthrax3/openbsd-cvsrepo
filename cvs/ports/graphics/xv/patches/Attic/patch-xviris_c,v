head	1.2;
access;
symbols
	OPENBSD_3_7:1.1.0.2
	OPENBSD_3_7_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2005.04.12.17.28.04;	author naddy;	state dead;
branches;
next	1.1;

1.1
date	2004.09.21.18.46.04;	author sturm;	state Exp;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2005.05.23.20.23.54;	author robert;	state dead;
branches;
next	;


desc
@@


1.2
log
@SECURITY:
Fixes for multiple vulnerabilities.  Switch to centralized jumbo patch.
From rohee@@
@
text
@$OpenBSD: patch-xviris_c,v 1.1 2004/09/21 18:46:04 sturm Exp $

Add some sanity checking in RLE decoding.

--- xviris.c.orig	Thu Sep 16 00:21:14 2004
+++ xviris.c	Thu Sep 16 00:22:43 2004
@@@@ -267,6 +267,12 @@@@ static byte *getimagedata(fp, img)
 
     rlebuflen = 2 * xsize + 10;
     tablen    = ysize * zsize;
+
+    if (rlebuflen < 0 || tablen < 0 || (tablen * sizeof(long)) < 0) {
+      loaderr = "Bogus IRIS File!";
+      return (byte *)NULL;
+    }
+
     starttab  = (u_long *) malloc((size_t) tablen * sizeof(long));
     lengthtab = (u_long *) malloc((size_t) tablen * sizeof(long));
     rledat    = (byte *)   malloc((size_t) rlebuflen);
@


1.1
log
@Add some sanity checking in XV. Patches from Marcus Meissner
adapted by rohee@@ by way of millert@@

while here, adapt patches to regular naming scheme
@
text
@d1 1
a1 1
$OpenBSD$
@


1.1.2.1
log
@SECURITY:
Fixes for multiple vulnerabilities. Switch to centralized jumbo patch.
bump PKGNAME
http://www.vuxml.org/openbsd/e9b45990-abff-11d9-a42d-080020f8e4df.html

ok brad@@
@
text
@d1 1
a1 1
$OpenBSD: patch-xviris_c,v 1.1 2004/09/21 18:46:04 sturm Exp $
@


