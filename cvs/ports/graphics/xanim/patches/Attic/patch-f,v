head	1.6;
access;
symbols
	OPENBSD_5_7:1.5.0.62
	OPENBSD_5_7_BASE:1.5
	OPENBSD_5_6:1.5.0.60
	OPENBSD_5_6_BASE:1.5
	OPENBSD_5_5:1.5.0.58
	OPENBSD_5_5_BASE:1.5
	OPENBSD_5_4:1.5.0.56
	OPENBSD_5_4_BASE:1.5
	OPENBSD_5_3:1.5.0.54
	OPENBSD_5_3_BASE:1.5
	OPENBSD_5_2:1.5.0.52
	OPENBSD_5_2_BASE:1.5
	OPENBSD_5_1_BASE:1.5
	OPENBSD_5_1:1.5.0.50
	OPENBSD_5_0:1.5.0.48
	OPENBSD_5_0_BASE:1.5
	OPENBSD_4_9:1.5.0.46
	OPENBSD_4_9_BASE:1.5
	OPENBSD_4_8:1.5.0.44
	OPENBSD_4_8_BASE:1.5
	OPENBSD_4_7:1.5.0.42
	OPENBSD_4_7_BASE:1.5
	OPENBSD_4_6:1.5.0.40
	OPENBSD_4_6_BASE:1.5
	OPENBSD_4_5:1.5.0.38
	OPENBSD_4_5_BASE:1.5
	OPENBSD_4_4:1.5.0.36
	OPENBSD_4_4_BASE:1.5
	OPENBSD_4_3:1.5.0.34
	OPENBSD_4_3_BASE:1.5
	OPENBSD_4_2:1.5.0.32
	OPENBSD_4_2_BASE:1.5
	OPENBSD_4_1:1.5.0.30
	OPENBSD_4_1_BASE:1.5
	OPENBSD_4_0:1.5.0.28
	OPENBSD_4_0_BASE:1.5
	OPENBSD_3_9:1.5.0.26
	OPENBSD_3_9_BASE:1.5
	OPENBSD_3_8:1.5.0.24
	OPENBSD_3_8_BASE:1.5
	OPENBSD_3_7:1.5.0.22
	OPENBSD_3_7_BASE:1.5
	OPENBSD_3_6:1.5.0.20
	OPENBSD_3_6_BASE:1.5
	OPENBSD_3_5:1.5.0.18
	OPENBSD_3_5_BASE:1.5
	OPENBSD_3_4:1.5.0.16
	OPENBSD_3_4_BASE:1.5
	OPENBSD_3_3:1.5.0.14
	OPENBSD_3_3_BASE:1.5
	OPENBSD_3_2:1.5.0.12
	OPENBSD_3_2_BASE:1.5
	OPENBSD_3_1:1.5.0.10
	OPENBSD_3_1_BASE:1.5
	OPENBSD_3_0:1.5.0.8
	OPENBSD_3_0_BASE:1.5
	OPENBSD_2_9_TRACKING_SWITCH:1.5
	OPENBSD_2_9:1.5.0.6
	OPENBSD_2_9_BASE:1.5
	OPENBSD_2_8:1.5.0.4
	OPENBSD_2_8_BASE:1.5
	OPENBSD_2_7:1.5.0.2
	OPENBSD_2_7_BASE:1.5
	OPENBSD_2_6:1.4.0.4
	OPENBSD_2_6_BASE:1.4
	OPENBSD_2_5:1.4.0.2
	OPENBSD_2_5_BASE:1.4
	sound-fixed:1.1.1.1
	xanim-2_70_7_0:1.1.1;
locks; strict;
comment	@# @;


1.6
date	2015.06.29.22.38.59;	author ratchov;	state dead;
branches;
next	1.5;
commitid	azHGSY14OZ25LlqE;

1.5
date	2000.03.04.19.00.07;	author espie;	state Exp;
branches;
next	1.4;

1.4
date	99.03.22.17.34.45;	author espie;	state Exp;
branches;
next	1.3;

1.3
date	99.03.19.01.20.48;	author espie;	state Exp;
branches;
next	1.2;

1.2
date	98.12.07.00.11.59;	author espie;	state Exp;
branches;
next	1.1;

1.1
date	98.12.02.02.27.02;	author espie;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	98.12.02.02.27.02;	author espie;	state Exp;
branches;
next	;


desc
@@


1.6
log
@Regen patches. No md5 change in patched files. Suggested by sthen.
@
text
@--- Imakefile.orig	Sun Mar 21 23:36:26 1999
+++ Imakefile	Mon Mar 22 18:13:13 1999
@@@@ -96,7 +96,7 @@@@
 XCOMM   to link against symbols inside xanim.
 XCOMM 
 XCOMM ## Linux
-LD_FLAGS = -rdynamic
+XCOMM LD_FLAGS = -rdynamic
 XCOMM ## SunOS/Solaris use:
 XCOMM  LD_FLAGS =
 
@@@@ -111,17 +111,17 @@@@
 XCOMM NOTE: not all machines need the XA_DLL_LIB define.
 XCOMM #########################################################################
 XCOMM 
-XA_DLL_DEF = -DXA_DLL -DXA_PRINT
+XCOMM XA_DLL_DEF = -DXA_DLL -DXA_PRINT
 XCOMM ### Use this only if the above doesn't work
 XCOMM XA_DLL_DEF = -DXA_DLL
 XCOMM
 XCOMM ### You may need this library.
-XA_DLL_LIB = -ldl
+XCOMM XA_DLL_LIB = -ldl
 XCOMM
 XCOMM If you'd like to change the default directory that XAnim searches while
 XCOMM looking for dlls, then change the directory below.
 XCOMM
-XA_DLL_PATH = /usr/local/xanim/mods
+XCOMM XA_DLL_PATH = /usr/local/xanim/mods
 
 
 
@@@@ -267,8 +267,8 @@@@
 XCOMM  XA_AUDIO_DEFS =
 XCOMM 
 XCOMM ## -- Linux PCs ---------------------------------------------------------
-XA_AUDIO_DEFS = -DXA_LINUX_AUDIO
-XA_AUDIO_LIBS = -lc
+XCOMM XA_AUDIO_DEFS = -DXA_LINUX_AUDIO
+XCOMM XA_AUDIO_LIBS = -lc
 XCOMM 
 XCOMM  -- Linux PC's with OLD Rev sound drivers -------------------------------
 XCOMM  XA_AUDIO_DEFS = -DXA_LINUX_AUDIO -DXA_LINUX_OLDER_SND
@@@@ -309,6 +309,9 @@@@
 XCOMM  -- NetBSD-current (as of 30/April 1995)---------------------------------
 XCOMM  XA_AUDIO_DEFS = -DXA_NetBSD_AUDIO
 XCOMM 
+XCOMM  -- OpenBSD, from at least 2.4 to now
+XA_AUDIO_DEFS = -DXA_OpenBSD_AUDIO
+XCOMM 
 XCOMM  -- QNX 4.2 PC's --------------------------------------------------------
 XCOMM  XA_AUDIO_DEFS = -DXA_LINUX_AUDIO -DXA_SELECT
 XCOMM  XA_AUDIO_LIBS = -lc
@@@@ -442,7 +445,7 @@@@
 XCOMM    -- following symbols(XmbufDisplayBuffers, XmbufQueryExtension,
 XCOMM    --  XmbufCreateBuffers).
 XCOMM    -- NOTE_8: HP-UX machines need to comment this out.
-XCOMM  XA_MULTIBUF = -DXMBUF
+XA_MULTIBUF = -DXMBUF
 XCOMM 
 XCOMM ###########
 XCOMM 
@@@@ -465,7 +468,7 @@@@
 
 PROGRAMS = $(XANIM)
 
-INCLUDES = -I$(INCDIR) $(XA_INCS)
+INCLUDES = -I/usr/X11R6/include/X11 $(XA_INCS)
 
    LIBS1 = $(XA_LIBS) $(EXTENSIONLIB) $(XTOOLLIB) $(XLIB) -lm
 DEPLIBS1 = $(DEPEXTENSIONLIB) $(DEPXTOOLLIB) $(DEPXLIB)
@@@@ -504,43 +507,3 @@@@
 xaclean::
 	$(RM) $(OBJS1)
 
-
-XCOMM  DO NOT DELETE THIS LINE
-xanim.o: Imakefile xanim.h xa_config.h xa_x11.h xanim.c
-xa1.0_kpcd.o: xa1.0_kpcd.c
-unpacker.o: unpacker.c
-xa_acodec.o: Imakefile xanim.h xa_acodec.c
-xa_act.o: xanim.h xa_config.h xa_act.c
-xa_au.o: xanim.h xa_config.h xa_au.c
-xa_audio.o: Imakefile xanim.h xa_config.h xa_audio.h xa_audio.c
-xa_avi.o: Imakefile xanim.h xa_config.h xa_avi.h xa_codecs.h xa_xmpg.h xa_avi.c
-xa_cmap.o: xanim.h xa_config.h xa_cmap.c
-xa_color.o: xanim.h xa_color.c
-xa_dl.o: xanim.h xa_config.h xa_dl.h xa_dl.c
-xa_dumfx.o: xanim.h xa_dumfx.c
-xa_fli.o: xanim.h xa_config.h xa_fli.h xa_fli.c
-xa_formats.o: xanim.h xa_formats.c
-xa_gif.o: xanim.h xa_config.h xa_gif.h xa_gif.c
-xa_iff.o: xanim.h xa_config.h xa_iff.h xa_iff.c
-xa_input.o: xanim.h xa_input.c
-xa_ipc.o: Imakefile xanim.h xa_config.h xa_ipc.h xa_ipc.c
-xa_jmov.o: xanim.h xa_config.h xa_jmov.h xa_jmov.c
-xa_jpg.o: xanim.h xa_config.h xa_jpg.h xa_jpg.c
-xa_j6i.o: xanim.h xa_j6i.h xa_j6i.c
-xa_movi.o: xanim.h xa_config.h xa_movi.h xa_movi.c
-xa_mpg.o: xanim.h xa_config.h xa_mpg.h xa_xmpg.h xa_mpg.c xa_jpg.c
-xa_qt.o: Imakefile xanim.h xa_config.h xa_qt.h xa_codecs.h xa_qt.c
-xa_qt_decs.o: Imakefile xanim.h xa_config.h xa_qt.h xa_qt_decs.c
-xa_vid_codec.o: Imakefile xa_avi.h xa_qt.h xa_codecs.h xavid.h xavid_mod.h
-xa_vid_codec.o: xa_vid_codec.c
-xa_replay.o: xanim.h xa_config.h xa_replay.h xa_replay.c
-xa_rle.o: xanim.h xa_config.h xa_rle.h xa_rle.c
-xa_set.o: xanim.h xa_config.h xa_iff.h xa_iff.c xa_set.h xa_set.c
-xa_raw.o: xanim.h xa_raw.h xa_raw.c
-xa_show.o: Imakefile xanim.h xa_show.c
-xa_txt.o: xanim.h xa_config.h xa_txt.c
-xa_utils.o: xanim.h xa_config.h xa_utils.c
-xa_wav.o: xanim.h xa_config.h xa_avi.h xa_wav.c
-xa_8svx.o: xanim.h xa_8svx.h xa_8svx.c
-xa_x11.o: Imakefile xanim.h xa_config.h xa_x11.h xa_x11.c
-xa_gsm.o: xanim.h xa_gsm_state.h xa_gsm.h xa_gsm.c
@


1.5
log
@Fix Imakefile in a more robust way.
@
text
@@


1.4
log
@Minor upgrade: 2.80.1. A few patches to tweak, xanim.man is back.
The program itself does NOT have any new version number.
@
text
@d68 1
a68 1
+INCLUDES = -I$(INCDIR)/X11 $(XA_INCS)
@


1.3
log
@- Upgrade to xanim 2.80.0.
- cleaned up audio support, with less AUDIO_SETINFO, no more waiting
  forever on wss.
@
text
@d1 2
a2 2
--- Imakefile.orig	Tue Mar 16 00:58:48 1999
+++ Imakefile	Fri Mar 19 02:10:08 1999
d12 2
a13 2
@@@@ -109,8 +109,8 @@@@
 XCOMM  So far I've only tested this on Linux_x86, SunOS_Sparc and Solaris_Sparc
d16 6
a21 1
-XA_DLL_DEF = -DXA_DLL
a22 1
+XCOMM XA_DLL_DEF = -DXA_DLL
d24 6
d32 2
a33 2
 XCOMM #########################################################################
@@@@ -242,8 +242,8 @@@@
d44 1
a44 1
@@@@ -284,6 +284,9 @@@@
d54 1
a54 1
@@@@ -417,7 +420,7 @@@@
d63 1
a63 9
@@@@ -433,14 +436,14 @@@@
 
 XA_DEFS = $(XA_MISC_DEFS) $(XA_MOD_DEFS) $(XA_AUDIO_DEFS) -DXA_PETUNIA -DXA_KPCD
 XA_LIBS = $(XA_X11R6_LIBS) $(XA_MACH_LIBS) $(XA_MOD_LIBS) $(XA_AUDIO_LIBS) 
-XA_INCS = $(INCLUDE) -I./ $(XA_VIDEO_INCS) $(XA_AUDIO_INCS)
+XA_INCS = $(INCLUDE) -I. $(XA_VIDEO_INCS) $(XA_AUDIO_INCS)
 
 
 DEFINES  = $(XA_DEFS)
d72 1
a72 1
@@@@ -479,126 +482,3 @@@@
d78 1
a78 1
-xanim.o: Makefile xanim.h xa_config.h xa_x11.h xanim.c
d81 1
a81 1
-xa_acodec.o: Makefile xanim.h xa_acodec.c
d84 20
a103 73
-xa_audio.o: Makefile xanim.h xa_config.h xa_audio.h xa_audio.c
-xa_avi.o: Makefile xanim.h xa_config.h xa_avi.h xa_codecs.h
-xa_avi.o: xa_xmpg.h
-xa_avi.o: xa_avi.c
-xa_cmap.o: xanim.h
-xa_cmap.o: xa_config.h
-xa_cmap.o: xa_cmap.c
-xa_color.o: xanim.h
-xa_color.o: xa_color.c
-xa_dl.o: xanim.h
-xa_dl.o: xa_config.h
-xa_dl.o: xa_dl.h
-xa_dl.o: xa_dl.c
-xa_dumfx.o: xanim.h
-xa_dumfx.o: xa_dumfx.c
-xa_fli.o: xanim.h
-xa_fli.o: xa_config.h
-xa_fli.o: xa_fli.h
-xa_fli.o: xa_fli.c
-xa_formats.o: xanim.h
-xa_formats.o: xa_formats.c
-xa_gif.o: xanim.h
-xa_gif.o: xa_config.h
-xa_gif.o: xa_gif.h
-xa_gif.o: xa_gif.c
-xa_iff.o: xanim.h
-xa_iff.o: xa_config.h
-xa_iff.o: xa_iff.h
-xa_iff.o: xa_iff.c
-xa_input.o: xanim.h
-xa_input.o: xa_input.c
-xa_ipc.o: Makefile
-xa_ipc.o: xanim.h
-xa_ipc.o: xa_config.h
-xa_ipc.o: xa_ipc.h
-xa_ipc.o: xa_ipc.c
-xa_jmov.o: xanim.h
-xa_jmov.o: xa_config.h
-xa_jmov.o: xa_jmov.h
-xa_jmov.o: xa_jmov.c
-xa_jpg.o: xanim.h
-xa_jpg.o: xa_config.h
-xa_jpg.o: xa_jpg.h
-xa_jpg.o: xa_jpg.c
-xa_j6i.o: xanim.h
-xa_j6i.o: xa_j6i.h
-xa_j6i.o: xa_j6i.c
-xa_movi.o: xanim.h
-xa_movi.o: xa_config.h
-xa_movi.o: xa_movi.h
-xa_movi.o: xa_movi.c
-xa_mpg.o: xanim.h
-xa_mpg.o: xa_config.h
-xa_mpg.o: xa_mpg.h
-xa_mpg.o: xa_xmpg.h
-xa_mpg.o: xa_mpg.c
-xa_mpg.o: xa_jpg.c
-xa_qt.o: Makefile
-xa_qt.o: xanim.h
-xa_qt.o: xa_config.h
-xa_qt.o: xa_qt.h
-xa_qt.o: xa_codecs.h
-xa_qt.o: xa_qt.c
-xa_qt_decs.o: Makefile
-xa_qt_decs.o: xanim.h
-xa_qt_decs.o: xa_config.h
-xa_qt_decs.o: xa_qt.h
-xa_qt_decs.o: xa_qt_decs.c
-xa_vid_codec.o: xa_avi.h
-xa_vid_codec.o: xa_qt.h
-xa_vid_codec.o: xa_codecs.h
-xa_vid_codec.o: xavid.h
-xa_vid_codec.o: xavid_mod.h
d105 11
a115 41
-xa_replay.o: xanim.h
-xa_replay.o: xa_config.h
-xa_replay.o: xa_replay.h
-xa_replay.o: xa_replay.c
-xa_rle.o: xanim.h
-xa_rle.o: xa_config.h
-xa_rle.o: xa_rle.h
-xa_rle.o: xa_rle.c
-xa_set.o: xanim.h
-xa_set.o: xa_config.h
-xa_set.o: xa_iff.h
-xa_set.o: xa_iff.c
-xa_set.o: xa_set.h
-xa_set.o: xa_set.c
-xa_raw.o: xanim.h
-xa_raw.o: xa_raw.h
-xa_raw.o: xa_raw.c
-xa_show.o: Makefile
-xa_show.o: xanim.h
-xa_show.o: xa_show.c
-xa_txt.o: xanim.h
-xa_txt.o: xa_config.h
-xa_txt.o: xa_txt.c
-xa_utils.o: xanim.h
-xa_utils.o: xa_config.h
-xa_utils.o: xa_utils.c
-xa_wav.o: xanim.h
-xa_wav.o: xa_config.h
-xa_wav.o: xa_avi.h
-xa_wav.o: xa_wav.c
-xa_8svx.o: xanim.h
-xa_8svx.o: xa_8svx.h
-xa_8svx.o: xa_8svx.c
-xa_x11.o: Makefile
-xa_x11.o: xanim.h
-xa_x11.o: xa_config.h
-xa_x11.o: xa_x11.h
-xa_x11.o: xa_x11.c
-xa_gsm.o: xa_gsm_state.h
-xa_gsm.o: xa_gsm.h
-xa_gsm.o: xa_gsm.c
@


1.2
log
@Add missing code for SIGNED_1M so that amiga gets a chance to play audio...
won't help much until the dang kernel is fixed, but...

(this will probably fixed in xanim's next official release, if I can get
Podlipec to clean his audio code somewhat)
@
text
@d1 196
a196 160
--- xa_acodec.c.orig	Tue Mar 24 00:54:58 1998
+++ xa_acodec.c	Mon Dec  7 00:14:52 1998
@@@@ -161,6 +161,7 @@@@
   return(ocnt);
 }
 
+
 /********** XA_ADecode_PCMXM_PCM1M *********************************
  * Convert PCM 1+2 BPS Mono Samples into PCM 1 BPS Mono Samples
  * The order flag takes care of the various linear/signed/endian
@@@@ -192,7 +193,17 @@@@
   {
     if (inc_cnt < (1<<24))
     {	/*** Decode Sample ***/
-      dataL = (spec & 4)?(ibuf[1]):(*ibuf);	
+	   if (snd_hdr->volume_boost)
+			{
+			unsigned c = snd_hdr->volume_boost;
+			unsigned d = 8 - c;
+			if (spec & 4)
+				dataL = (ibuf[1]<<c) | (ibuf[0]>>d);
+			else
+				dataL = (ibuf[0]<<c) | (ibuf[1]>>d);
+			}
+		else
+			dataL = (spec & 4)?(ibuf[1]):(*ibuf);	
       ibuf += bps;	byte_cnt += bps;	samp_cnt--;
       inc_cnt += inc;
     }
@@@@ -1800,6 +1811,19 @@@@
   new_snd->inc = inc = (xaULONG)( finc * (double)(1<<24) );
   new_snd->inc_cnt = 0;
 
+  if (vaudiof->amp_scale < 2.0)
+  	new_snd->volume_boost = 0;
+  else if (vaudiof->amp_scale < 4.0)
+  	new_snd->volume_boost = 1;
+  else if (vaudiof->amp_scale < 8.0)
+  	new_snd->volume_boost = 2;
+  else if (vaudiof->amp_scale < 16.0)
+  	new_snd->volume_boost = 3;
+  else if (vaudiof->amp_scale < 32.0)
+  	new_snd->volume_boost = 4;
+  else 
+  	new_snd->volume_boost = 5;
+
   /* Determine Chunk Time */
   ftime = ((double)(xa_vaudio_hard_buff) * 1000.0) / (double)(hfreq);
   new_snd->ch_time = (xaLONG)ftime;
@@@@ -2071,6 +2095,7 @@@@
       break;
 
     case XA_AUDIO_LINEAR_1M:
+    case XA_AUDIO_SIGNED_1M:
       {
 	switch(itype)
 	{
@@@@ -2087,7 +2112,8 @@@@
 	  case XA_AUDIO_LINEAR_2SL:
 	  case XA_AUDIO_LINEAR_2SB:
 		new_snd->spec = 
-		    ((itype & XA_AUDIO_TYPE_MASK)==XA_AUDIO_LINEAR)?(0):(1);
+		    ((itype & XA_AUDIO_TYPE_MASK)==
+			 	(xa_audio_hard_type & XA_AUDIO_TYPE_MASK))?(0):(1);
 		if (itype & XA_AUDIO_BPS_2_MSK)
 		  new_snd->spec |= (itype & XA_AUDIO_BIGEND_MSK)?(2):(4);
 		if (itype & XA_AUDIO_STEREO_MSK)
@@@@ -2099,60 +2125,84 @@@@
 		if (xa_audio_hard_type & XA_AUDIO_BIGEND_MSK)
 			new_snd->spec = 0 | 4 | 8;
 		else	new_snd->spec = 1 | 4 | 8;
+		if (xa_audio_hard_type == XA_AUDIO_LINEAR_1M)
+			new_snd->spec |= 2;
 		new_snd->delta = XA_ADecode_ULAWx_PCMxM;
 		break;
 	  case XA_AUDIO_ULAW:
 		if (xa_audio_hard_type & XA_AUDIO_BIGEND_MSK)
 			new_snd->spec = 0 | 4;
 		else	new_snd->spec = 1 | 4;
+		if (xa_audio_hard_type == XA_AUDIO_LINEAR_1M)
+			new_snd->spec |= 2;
 		new_snd->delta = XA_ADecode_ULAWx_PCMxM;
 		break;
 	  case XA_AUDIO_ARMLAWS:
 		if (xa_audio_hard_type & XA_AUDIO_BIGEND_MSK)
 			new_snd->spec = 0 | 4 | 8;
 		else	new_snd->spec = 1 | 4 | 8;
+		if (xa_audio_hard_type == XA_AUDIO_LINEAR_1M)
+			new_snd->spec |= 2;
 		new_snd->delta = XA_ADecode_ARMLAWx_PCMxM;
 		break;
 	  case XA_AUDIO_ARMLAW:
 		if (xa_audio_hard_type & XA_AUDIO_BIGEND_MSK)
 			new_snd->spec = 0 | 4;
 		else	new_snd->spec = 1 | 4;
+		if (xa_audio_hard_type == XA_AUDIO_LINEAR_1M)
+			new_snd->spec |= 2;
 		new_snd->delta = XA_ADecode_ARMLAWx_PCMxM;
 		break;
 	  case XA_AUDIO_ADPCM_M:
-		new_snd->spec = 2 | 4;  /* 1 byte output */
+		new_snd->spec = 4;  /* 1 byte output */
+		if (xa_audio_hard_type == XA_AUDIO_LINEAR_1M)
+			new_snd->spec |= 2;
 		new_snd->delta = XA_ADecode_ADPCMM_PCM2M;
 		break;
 	  case XA_AUDIO_ADPCM_S:
-		new_snd->spec = 2 | 4;  /* 1 byte output */
+		new_snd->spec = 4;  /* 1 byte output */
+		if (xa_audio_hard_type == XA_AUDIO_LINEAR_1M)
+			new_snd->spec |= 2;
 		new_snd->delta = XA_ADecode_ADPCMS_PCM2M;
 		break;
 	  case XA_AUDIO_DVI_M:
-		new_snd->spec = 2 | 4;  /* 1 byte output */
+		new_snd->spec = 4;  /* 1 byte output */
+		if (xa_audio_hard_type == XA_AUDIO_LINEAR_1M)
+			new_snd->spec |= 2;
 		new_snd->delta = XA_ADecode_DVIM_PCMxM;
 		break;
 	  case XA_AUDIO_DVI_S:
-		new_snd->spec = 2 | 4;  /* 1 byte output */
+		new_snd->spec = 4;  /* 1 byte output */
+		if (xa_audio_hard_type == XA_AUDIO_LINEAR_1M)
+			new_snd->spec |= 2;
 		new_snd->delta = XA_ADecode_DVIS_PCMxM;
 		break;
 	  case XA_AUDIO_IMA4_M:
-		new_snd->spec = 2 | 4;  /* 1 byte output */
+		new_snd->spec = 4;  /* 1 byte output */
+		if (xa_audio_hard_type == XA_AUDIO_LINEAR_1M)
+			new_snd->spec |= 2;
 		new_snd->delta = XA_ADecode_IMA4M_PCMxM;
 		break;
 	  case XA_AUDIO_IMA4_S:
-		new_snd->spec = 2 | 4;  /* 1 byte output */
+		new_snd->spec = 4;  /* 1 byte output */
+		if (xa_audio_hard_type == XA_AUDIO_LINEAR_1M)
+			new_snd->spec |= 2;
 		new_snd->delta = XA_ADecode_IMA4S_PCMxM;
 		break;
 #ifdef GSM
 	  case XA_AUDIO_GSM:
 	  case XA_AUDIO_MSGSM:
-		new_snd->spec = 2 | 4;  /* 1 byte output */
+		new_snd->spec = 4;  /* 1 byte output */
+		if (xa_audio_hard_type == XA_AUDIO_LINEAR_1M)
+			new_snd->spec |= 2;
 		if (itype == XA_AUDIO_MSGSM_M) new_snd->spec |= 0x80;
 		new_snd->delta = XA_ADecode_GSMM_PCMxM;
 		break;
 #endif
 	  case XA_AUDIO_NOP:
-		new_snd->spec = 2 | 4;  /* 1 byte output */
+		new_snd->spec = 4;  /* 1 byte output */
+		if (xa_audio_hard_type == XA_AUDIO_LINEAR_1M)
+			new_snd->spec |= 2;
 		new_snd->delta = XA_ADecode_NOP_PCMXM;
 		break;
 	  default:
@


1.1
log
@Initial revision
@
text
@d1 2
a2 2
--- xa_acodec.c.orig	Wed Dec  2 03:05:20 1998
+++ xa_acodec.c	Wed Dec  2 03:05:34 1998
d30 1
a30 2
@@@@ -1799,6 +1810,19 @@@@
   finc = (double)(fadj_freq)/ (double)(ifreq);
d33 1
a33 1
+
d46 1
a46 1
 
d49 112
@


1.1.1.1
log
@Sound support, including 8 bit, with crossed fingers.
@
text
@@
