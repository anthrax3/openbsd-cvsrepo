head	1.12;
access;
symbols
	OPENBSD_3_8:1.11.0.2
	OPENBSD_3_8_BASE:1.11
	OPENBSD_3_7:1.9.0.4
	OPENBSD_3_7_BASE:1.9
	OPENBSD_3_6:1.9.0.2
	OPENBSD_3_6_BASE:1.9
	OPENBSD_3_5:1.7.0.4
	OPENBSD_3_5_BASE:1.7
	OPENBSD_3_4:1.7.0.2
	OPENBSD_3_4_BASE:1.7
	OPENBSD_3_3:1.6.0.4
	OPENBSD_3_3_BASE:1.6
	OPENBSD_3_2:1.6.0.2
	OPENBSD_3_2_BASE:1.6
	OPENBSD_3_1:1.5.0.6
	OPENBSD_3_1_BASE:1.5
	OPENBSD_3_0:1.5.0.4
	OPENBSD_3_0_BASE:1.5
	OPENBSD_2_9_TRACKING_SWITCH:1.5
	OPENBSD_2_9:1.5.0.2
	OPENBSD_2_9_BASE:1.5
	OPENBSD_2_8:1.3.0.2
	OPENBSD_2_8_BASE:1.3
	OPENBSD_2_7:1.2.0.2;
locks; strict;
comment	@# @;


1.12
date	2006.01.15.14.24.22;	author steven;	state dead;
branches;
next	1.11;

1.11
date	2005.06.04.14.39.21;	author naddy;	state Exp;
branches;
next	1.10;

1.10
date	2005.03.31.04.23.42;	author pvalchev;	state Exp;
branches;
next	1.9;

1.9
date	2004.08.13.06.16.38;	author brad;	state Exp;
branches;
next	1.8;

1.8
date	2004.06.24.07.44.58;	author brad;	state Exp;
branches;
next	1.7;

1.7
date	2003.06.30.20.41.15;	author sturm;	state Exp;
branches;
next	1.6;

1.6
date	2002.09.15.03.52.04;	author brad;	state Exp;
branches;
next	1.5;

1.5
date	2001.02.21.15.00.56;	author danh;	state Exp;
branches;
next	1.4;

1.4
date	2001.02.05.15.58.08;	author brad;	state Exp;
branches;
next	1.3;

1.3
date	2000.08.21.16.42.27;	author brad;	state Exp;
branches;
next	1.2;

1.2
date	2000.07.25.07.17.00;	author brad;	state Exp;
branches;
next	1.1;

1.1
date	2000.06.20.23.32.47;	author brad;	state Exp;
branches;
next	;


desc
@@


1.12
log
@- remove unneeded MODGNU_SHARED_LIBS and related patches
- remove old libtool and ltdl patches since we use the in-tree versions
@
text
@$OpenBSD: patch-ltmain_sh,v 1.11 2005/06/04 14:39:21 naddy Exp $
--- ltmain.sh.orig	Tue May 24 00:33:09 2005
+++ ltmain.sh	Sun May 29 20:00:07 2005
@@@@ -2641,7 +2641,7 @@@@ EOF
 	    add_dir=
 	    add=
 	    # Finalize command for both is simple: just hardcode it.
-	    if test "$hardcode_direct" = yes; then
+	    if test "$hardcode_direct" = yes && test -f $libdir/$linklib; then
 	      add="$libdir/$linklib"
 	    elif test "$hardcode_minus_L" = yes; then
 	      add_dir="-L$libdir"
@@@@ -5898,40 +5898,6 @@@@ relink_command=\"$relink_command\""
     # Exit here if they wanted silent mode.
     test "$show" = : && exit $EXIT_SUCCESS
 
-    $echo "----------------------------------------------------------------------"
-    $echo "Libraries have been installed in:"
-    for libdir in $libdirs; do
-      $echo "   $libdir"
-    done
-    $echo
-    $echo "If you ever happen to want to link against installed libraries"
-    $echo "in a given directory, LIBDIR, you must either use libtool, and"
-    $echo "specify the full pathname of the library, or use the \`-LLIBDIR'"
-    $echo "flag during linking and do at least one of the following:"
-    if test -n "$shlibpath_var"; then
-      $echo "   - add LIBDIR to the \`$shlibpath_var' environment variable"
-      $echo "     during execution"
-    fi
-    if test -n "$runpath_var"; then
-      $echo "   - add LIBDIR to the \`$runpath_var' environment variable"
-      $echo "     during linking"
-    fi
-    if test -n "$hardcode_libdir_flag_spec"; then
-      libdir=LIBDIR
-      eval flag=\"$hardcode_libdir_flag_spec\"
-
-      $echo "   - use the \`$flag' linker flag"
-    fi
-    if test -n "$admincmds"; then
-      $echo "   - have your system administrator run these commands:$admincmds"
-    fi
-    if test -f /etc/ld.so.conf; then
-      $echo "   - have your system administrator add LIBDIR to \`/etc/ld.so.conf'"
-    fi
-    $echo
-    $echo "See any operating system documentation about shared libraries for"
-    $echo "more information, such as the ld(1) and ld.so(8) manual pages."
-    $echo "----------------------------------------------------------------------"
     exit $EXIT_SUCCESS
     ;;
 
@


1.11
log
@Update to 6.2.3:
* Fixed an obscure heap-overflow vulnerability in the PNM reader.
* Avoid infinite loop if bogus XWD rad/green/blue masks are 0.

Also:
* Regression test fixes.
* No need to remove previously installed ImageMagick.

From new maintainer Bernd Ahlers <b.ahlers@@ba-net.org>.
@
text
@d1 1
a1 1
$OpenBSD: patch-ltmain_sh,v 1.10 2005/03/31 04:23:42 pvalchev Exp $
@


1.10
log
@update to ImageMagick-6.2.0-8; Bernd Ahlers <b.ahlers@@ba-net.org>
@
text
@d1 4
a4 4
$OpenBSD$
--- ltmain.sh.orig	Tue Jan 18 14:03:20 2005
+++ ltmain.sh	Tue Jan 18 14:05:20 2005
@@@@ -2611,7 +2611,7 @@@@ EOF
d13 1
a13 1
@@@@ -5804,40 +5804,6 @@@@ relink_command=\"$relink_command\""
@


1.9
log
@sync libtool patches

ok pvalchev@@
@
text
@d1 4
a4 26
$OpenBSD: patch-ltmain_sh,v 1.8 2004/06/24 07:44:58 brad Exp $
--- ltmain.sh.orig	Fri May 21 10:59:35 2004
+++ ltmain.sh	Tue Aug 10 13:42:50 2004
@@@@ -2151,10 +2151,17 @@@@ EOF
 	    absdir="$libdir"
 	  fi
 	else
-	  dir="$ladir/$objdir"
-	  absdir="$abs_ladir/$objdir"
-	  # Remove this search path later
-	  notinst_path="$notinst_path $abs_ladir"
+	  if test ! -f "$ladir/$objdir/$linklib" && test -f "$abs_ladir/$linklib"; then
+	    dir="$ladir"
+	    absdir="$abs_ladir"
+	    # Remove this search path later
+	    notinst_path="$notinst_path $abs_ladir"
+	  else
+	    dir="$ladir/$objdir"
+	    absdir="$abs_ladir/$objdir"
+	    # Remove this search path later
+	    notinst_path="$notinst_path $abs_ladir"
+	  fi
 	fi # $installed = yes
 	name=`$echo "X$laname" | $Xsed -e 's/\.la$//' -e 's/^lib//'`
 
@@@@ -2468,7 +2475,7 @@@@ EOF
d13 1
a13 1
@@@@ -5824,40 +5831,6 @@@@ relink_command=\"$relink_command\""
@


1.8
log
@upgrade to ImageMagick 6.0.0-2
@
text
@d1 5
a5 8
$OpenBSD: patch-ltmain_sh,v 1.7 2003/06/30 20:41:15 sturm Exp $
--- ltmain.sh.orig	2004-06-21 22:56:47.000000000 -0600
+++ ltmain.sh	2004-06-21 22:57:08.000000000 -0600
@@@@ -2273,7 +2273,6 @@@@ EOF
 	   { test "$prefer_static_libs" = no || test -z "$old_library"; }; then
 	  if test "$installed" = no; then
 	    notinst_deplibs="$notinst_deplibs $lib"
-	    need_relink=yes
d7 18
a24 1
 	  # This is a shared library
d26 10
a35 1
@@@@ -5824,40 +5823,6 @@@@ relink_command=\"$relink_command\""
@


1.7
log
@- fix build to work with recently updated libxml
- bump PKGNAME

"looks ok" brad@@
@
text
@d1 10
a10 25
$OpenBSD: patch-ltmain_sh,v 1.6 2002/09/15 03:52:04 brad Exp $
--- ltmain.sh.orig	Mon Dec 11 01:02:00 2000
+++ ltmain.sh	Sat Jun 28 22:04:17 2003
@@@@ -1097,7 +1097,18 @@@@ EOF
 	    # These systems don't actually have c library (as such)
 	    continue
 	    ;;
+	  *-*-openbsd*)
+	    # Do not include libc due to us having libc/libc_r.
+	    continue
+	    ;;
 	  esac
+        elif test "$arg" = "-lc_r"; then
+          case "$host" in
+          *-*-openbsd*)
+            # Do not include libc_r directly, use -pthread flag.
+            continue
+            ;;
+          esac
 	elif test "$arg" = "-lm"; then
 	  case "$host" in
 	  *-*-cygwin* | *-*-pw32* | *-*-beos*)
@@@@ -1110,6 +1121,10 @@@@ EOF
 	continue
 	;;
d12 1
a12 28
+      -?thread)
+        deplibs="$deplibs $arg"
+        ;;
+
       -module)
 	module=yes
 	continue
@@@@ -1682,6 +1697,9 @@@@ EOF
 	  fi
 	  continue
 	  ;;
+	-pthread)
+	  continue
+	  ;;
 	%DEPLIBS%)
 	  alldeplibs=yes
 	  continue
@@@@ -2602,6 +2620,9 @@@@ EOF
 	  *-*-cygwin* | *-*-mingw* | *-*-pw32* | *-*-os2* | *-*-beos*)
 	    # these systems don't actually have a c library (as such)!
 	    ;;
+	  *-*-openbsd*)
+	    # Do not include libc due to us having libc/libc_r.
+	    ;;
 	  *)
  	    # Add libc to deplibs on all other systems if necessary.
  	    if test $build_libtool_need_lc = "yes"; then
@@@@ -4505,40 +4526,6 @@@@ relink_command=\"$relink_command\""
d14 1
a14 1
     test "$show" = : && exit 0
d16 2
a17 2
-    echo "----------------------------------------------------------------------"
-    echo "Libraries have been installed in:"
d19 1
a19 1
-      echo "   $libdir"
d21 5
a25 5
-    echo
-    echo "If you ever happen to want to link against installed libraries"
-    echo "in a given directory, LIBDIR, you must either use libtool, and"
-    echo "specify the full pathname of the library, or use \`-LLIBDIR'"
-    echo "flag during linking and do at least one of the following:"
d27 2
a28 2
-      echo "   - add LIBDIR to the \`$shlibpath_var' environment variable"
-      echo "     during execution"
d31 2
a32 2
-      echo "   - add LIBDIR to the \`$runpath_var' environment variable"
-      echo "     during linking"
d38 1
a38 1
-      echo "   - use the \`$flag' linker flag"
d41 1
a41 1
-      echo "   - have your system administrator run these commands:$admincmds"
d44 1
a44 1
-      echo "   - have your system administrator add LIBDIR to \`/etc/ld.so.conf'"
d46 5
a50 5
-    echo
-    echo "See any operating system documentation about shared libraries for"
-    echo "more information, such as the ld(1) and ld.so(8) manual pages."
-    echo "----------------------------------------------------------------------"
     exit 0
@


1.6
log
@add RCS ids
@
text
@d1 3
a3 3
$OpenBSD$
--- ltmain.sh.orig	Sun Dec 10 19:02:22 2000
+++ ltmain.sh	Wed Feb 21 09:59:59 2001
d34 11
a44 1
@@@@ -2602,6 +2617,9 @@@@ EOF
d54 1
a54 1
@@@@ -4505,40 +4523,6 @@@@ relink_command=\"$relink_command\""
@


1.5
log
@sync libtool patch
@
text
@d1 1
@


1.4
log
@upgrade to ImageMagick 5.2.8
@
text
@d2 2
a3 2
+++ ltmain.sh	Sun Feb  4 20:53:38 2001
@@@@ -1097,6 +1097,10 @@@@
d12 7
d21 13
a33 1
@@@@ -2602,6 +2606,9 @@@@
d43 1
a43 1
@@@@ -4505,40 +4512,6 @@@@
@


1.3
log
@upgrade to ImageMagick 5.2.2
@
text
@d1 24
a24 3
--- ltmain.sh.orig	Thu Jul 13 10:26:33 2000
+++ ltmain.sh	Mon Aug 21 10:33:58 2000
@@@@ -4279,40 +4279,6 @@@@
@


1.2
log
@upgrade to ImageMagick 5.2.1
@
text
@d1 3
a3 3
--- ltmain.sh.orig	Tue Jun 27 16:55:26 2000
+++ ltmain.sh	Mon Jul 24 18:20:30 2000
@@@@ -4439,40 +4439,6 @@@@
@


1.1
log
@upgrade to ImageMagick 5.2.0, as recommended in PR#1245
@
text
@d1 3
a3 3
--- ltmain.sh.orig	Tue Jan 11 10:44:46 2000
+++ ltmain.sh	Mon Jun 12 13:52:02 2000
@@@@ -3558,40 +3558,6 @@@@
@

