head	1.39;
access;
symbols
	OPENBSD_6_2:1.39.0.8
	OPENBSD_6_2_BASE:1.39
	OPENBSD_6_1:1.39.0.6
	OPENBSD_6_1_BASE:1.39
	OPENBSD_6_0:1.39.0.4
	OPENBSD_6_0_BASE:1.39
	OPENBSD_5_9:1.39.0.2
	OPENBSD_5_9_BASE:1.39
	OPENBSD_5_8:1.38.0.4
	OPENBSD_5_8_BASE:1.38
	OPENBSD_5_7:1.36.0.2
	OPENBSD_5_7_BASE:1.36
	OPENBSD_5_6:1.35.0.2
	OPENBSD_5_6_BASE:1.35
	OPENBSD_5_5:1.34.0.2
	OPENBSD_5_5_BASE:1.34
	OPENBSD_5_4:1.32.0.2
	OPENBSD_5_4_BASE:1.32
	OPENBSD_5_3:1.28.0.2
	OPENBSD_5_3_BASE:1.28
	OPENBSD_5_2:1.26.0.2
	OPENBSD_5_2_BASE:1.26
	OPENBSD_5_1_BASE:1.25
	OPENBSD_5_1:1.25.0.2
	OPENBSD_5_0:1.21.0.2
	OPENBSD_5_0_BASE:1.21
	OPENBSD_4_9:1.20.0.2
	OPENBSD_4_9_BASE:1.20
	OPENBSD_4_8:1.17.0.4
	OPENBSD_4_8_BASE:1.17
	OPENBSD_4_7:1.17.0.2
	OPENBSD_4_7_BASE:1.17
	OPENBSD_4_6:1.16.0.2
	OPENBSD_4_6_BASE:1.16
	OPENBSD_4_5:1.10.0.2
	OPENBSD_4_5_BASE:1.10
	OPENBSD_4_4:1.8.0.2
	OPENBSD_4_4_BASE:1.8
	OPENBSD_4_3:1.7.0.2
	OPENBSD_4_3_BASE:1.7
	OPENBSD_4_2:1.2.0.2
	OPENBSD_4_2_BASE:1.2
	OPENBSD_4_1:1.1.1.1.0.2
	OPENBSD_4_1_BASE:1.1.1.1
	msf_20070205:1.1.1.1
	msf:1.1.1;
locks; strict;
comment	@# @;


1.39
date	2015.10.16.15.35.18;	author naddy;	state Exp;
branches;
next	1.38;
commitid	Ku9d8LM5Ync0faUc;

1.38
date	2015.03.27.08.11.28;	author ajacoutot;	state Exp;
branches;
next	1.37;
commitid	mHt3hIg3nxq5XDcy;

1.37
date	2015.03.26.12.14.15;	author sthen;	state Exp;
branches;
next	1.36;
commitid	qYDTmzXxLoW0kaEv;

1.36
date	2014.08.14.07.06.00;	author ajacoutot;	state Exp;
branches;
next	1.35;
commitid	Ox5isqCVDwHCpoCU;

1.35
date	2014.04.06.21.10.30;	author sthen;	state Exp;
branches;
next	1.34;

1.34
date	2013.10.11.23.49.46;	author naddy;	state Exp;
branches;
next	1.33;

1.33
date	2013.09.27.17.49.05;	author ajacoutot;	state Exp;
branches;
next	1.32;

1.32
date	2013.04.29.12.57.58;	author gonzalo;	state Exp;
branches;
next	1.31;

1.31
date	2013.04.02.17.26.34;	author ajacoutot;	state Exp;
branches;
next	1.30;

1.30
date	2013.03.11.23.01.31;	author fgsch;	state Exp;
branches;
next	1.29;

1.29
date	2013.03.11.11.10.51;	author espie;	state Exp;
branches;
next	1.28;

1.28
date	2013.02.06.14.23.06;	author ajacoutot;	state Exp;
branches;
next	1.27;

1.27
date	2012.09.04.03.40.33;	author jeremy;	state Exp;
branches;
next	1.26;

1.26
date	2012.06.15.08.32.16;	author ajacoutot;	state Exp;
branches;
next	1.25;

1.25
date	2011.12.20.11.25.35;	author sthen;	state Exp;
branches;
next	1.24;

1.24
date	2011.12.20.11.25.06;	author jasper;	state Exp;
branches;
next	1.23;

1.23
date	2011.12.03.20.30.09;	author ajacoutot;	state Exp;
branches;
next	1.22;

1.22
date	2011.09.16.10.02.36;	author espie;	state Exp;
branches;
next	1.21;

1.21
date	2011.06.12.10.11.39;	author jasper;	state Exp;
branches;
next	1.20;

1.20
date	2010.11.17.08.05.13;	author espie;	state Exp;
branches;
next	1.19;

1.19
date	2010.10.18.18.13.13;	author espie;	state Exp;
branches;
next	1.18;

1.18
date	2010.08.30.21.24.15;	author jasper;	state Exp;
branches;
next	1.17;

1.17
date	2009.12.22.16.06.40;	author ajacoutot;	state Exp;
branches;
next	1.16;

1.16
date	2009.06.11.18.27.02;	author ajacoutot;	state Exp;
branches;
next	1.15;

1.15
date	2009.06.08.16.58.15;	author ajacoutot;	state Exp;
branches;
next	1.14;

1.14
date	2009.06.07.05.32.02;	author ajacoutot;	state Exp;
branches;
next	1.13;

1.13
date	2009.04.15.08.26.28;	author landry;	state Exp;
branches;
next	1.12;

1.12
date	2009.04.02.06.22.33;	author kili;	state Exp;
branches;
next	1.11;

1.11
date	2009.03.15.18.29.31;	author espie;	state Exp;
branches;
next	1.10;

1.10
date	2009.01.24.11.07.04;	author landry;	state Exp;
branches;
next	1.9;

1.9
date	2008.10.08.16.02.29;	author jasper;	state Exp;
branches;
next	1.8;

1.8
date	2008.04.17.08.10.10;	author ajacoutot;	state Exp;
branches;
next	1.7;

1.7
date	2008.02.14.08.58.23;	author winiger;	state Exp;
branches;
next	1.6;

1.6
date	2007.12.15.20.43.07;	author ajacoutot;	state Exp;
branches;
next	1.5;

1.5
date	2007.11.20.18.53.21;	author mgrimm;	state Exp;
branches;
next	1.4;

1.4
date	2007.10.08.08.22.41;	author steven;	state Exp;
branches;
next	1.3;

1.3
date	2007.09.15.20.09.40;	author simon;	state Exp;
branches;
next	1.2;

1.2
date	2007.05.06.22.35.55;	author alek;	state Exp;
branches;
next	1.1;

1.1
date	2007.02.05.07.25.31;	author msf;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2007.02.05.07.25.31;	author msf;	state Exp;
branches;
next	;


desc
@@


1.39
log
@call gzip(1) directly
@
text
@# $OpenBSD: Makefile,v 1.38 2015/03/27 08:11:28 ajacoutot Exp $

COMMENT=	gtk2 comic book viewer

DISTNAME=	comix-4.0.4
REVISION=	4

CATEGORIES=	graphics

HOMEPAGE=	http://comix.sourceforge.net/

# GPLv2
PERMIT_PACKAGE_CDROM=	Yes

MASTER_SITES=	${MASTER_SITE_SOURCEFORGE:=comix/}

MODULES=	lang/python \
		devel/gconf2

MODGCONF2_LIBDEP= No
MODGCONF2_SCHEMAS_DIR= comix

BUILD_DEPENDS=	graphics/py-Pillow \
		x11/py-gtk2

RUN_DEPENDS=	graphics/py-Pillow \
		x11/py-gtk2 \
		misc/shared-mime-info \
		devel/desktop-file-utils \
		x11/gtk+3,-guic

NO_TEST=	Yes

post-extract:
		gzip -d ${WRKSRC}/comix.1.gz ${WRKSRC}/mime/comicthumb.1.gz

do-build:
		${SUBST_CMD} -c ${WRKSRC}/src/comix.py ${WRKSRC}/comix

do-install:
		cd ${WRKSRC} && ${MODPY_BIN} install.py --dir ${PREFIX} install
		# schemas files are always installed under LOCALBASE, not PREFIX
		${INSTALL_DATA_DIR} ${WRKINST}/${LOCALBASE}/${SCHEMAS_INSTDIR}/
		${INSTALL_DATA} ${WRKSRC}/mime/comicbook.schemas \
			${WRKINST}/${LOCALBASE}/${SCHEMAS_INSTDIR}/

PKG_ARCH=	*

.include <bsd.port.mk>
@


1.38
log
@x11/gtk+2,-guic -> x11/gtk+3,-guic && bump
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2015/03/26 12:14:15 sthen Exp $
d35 1
a35 1
		${GUNZIP_CMD} ${WRKSRC}/comix.1.gz ${WRKSRC}/mime/comicthumb.1.gz
@


1.37
log
@REVISION bumps for py-Pillow RDEP change
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2014/08/14 07:06:00 ajacoutot Exp $
d6 1
a6 1
REVISION=	3
d30 1
a30 1
		x11/gtk+2,-guic
@


1.36
log
@Bump after py-Pillow sub-packaging.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2014/04/06 21:10:30 sthen Exp $
d6 1
a6 1
REVISION=	2
@


1.35
log
@switch py-Imaging to py-Pillow, plus some "s/import Image/from PIL import Image/" patches where necessary
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2013/10/11 23:49:46 naddy Exp $
d6 1
a6 1
REVISION=	1
@


1.34
log
@Drop USE_GROFF since groff and mandoc produce identical output.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2013/09/27 17:49:05 ajacoutot Exp $
d6 1
a6 1
REVISION=	0
d23 1
a23 1
BUILD_DEPENDS=	graphics/py-Imaging \
d25 2
a26 2
		
RUN_DEPENDS=	graphics/py-Imaging \
@


1.33
log
@Bump after devel/gconf2,-main is gone.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2013/04/29 12:57:58 gonzalo Exp $
a31 1
USE_GROFF =	Yes
@


1.32
log
@Update for Comix to 4.0.4:

* Applied a workaround for a bug that caused the "Open" dialog to
  crash when trying to open a file when the file type filter had been
  reset to blank. This bug seems to only appear on some systems,
  probably depending on the installed GTK+ version.
* Fixed a bug that caused the error message for unfulfilled
  dependencies to not be printed properly.
* The rar/unrar program is now invoked in such a way as to keep
  broken or incomplete files extracted from RAR archives, since Comix
  might be able to display parts of these files anyway.

While here add HOMEPAGE.

Ok landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2013/04/02 17:26:34 ajacoutot Exp $
d6 1
@


1.31
log
@Sanitier depepdencies, these do not need to build depends on gtk+2,-guic.
RUN_DEPENDS = BUILD_DEPENDS is a known bad construct, but
BUILD_DEPENDS = RUN_DEPENDS is *not* that good either...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2013/03/11 23:01:31 fgsch Exp $
d5 1
a5 2
DISTNAME=	comix-4.0.3
REVISION=	13
d8 2
@


1.30
log
@bump after py-Imaging change.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2013/03/11 11:10:51 espie Exp $
d6 1
a6 1
REVISION=	12
d21 3
a23 2
BUILD_DEPENDS=	${RUN_DEPENDS} \
		x11/gtk+2,-guic
d27 2
a28 1
		devel/desktop-file-utils
@


1.29
log
@PERMIT_* / REGRESS -> TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2013/02/06 14:23:06 ajacoutot Exp $
d6 1
a6 1
REVISION=	11
@


1.28
log
@Quiet gconftool-2:
gconf_ping() will try to shutdown gconfd, but since installing pkg is
done as root, there is not gconfd nor dbus that can be started when
DISPLAY isn't set and an annoying warning is issued.

discussed with espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2012/09/04 03:40:33 jeremy Exp $
a11 3
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
d29 1
a29 1
NO_REGRESS=	Yes
@


1.27
log
@Remove msf@@ as maintainer from the ports he maintains, at his request,
as he no longer works on OpenBSD.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2012/06/15 08:32:16 ajacoutot Exp $
d6 1
a6 1
REVISION=	10
@


1.26
log
@gtk-update-icon-cache:
Don't redirect errors to /dev/null and don't return true(1)
unconditionally. Instead, don't check for the existence of index.theme.
This will allow us to catch errors that may be happening because of a
missing dependency in the chain.

Some hidden issues may appear, in which case please contact me.

discussed with and ok blind jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2011/12/20 11:25:35 sthen Exp $
d6 1
a6 1
REVISION=	9
a8 2

MAINTAINER=	Mathieu Sauve-Frankel <msf@@openbsd.org>
@


1.25
log
@remove useless PY_FLAVOR
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2011/12/20 11:25:06 jasper Exp $
d6 1
a6 1
REVISION=	8
@


1.24
log
@unbreak; py-Imaging is now flavourless
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2011/12/03 20:30:09 ajacoutot Exp $
a21 1
PY_FLAVOR=	python${MODPY_VERSION}
@


1.23
log
@Add a dependency on x11/gtk+2,-guic.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2011/09/16 10:02:36 espie Exp $
d6 1
a6 1
REVISION=	7
d29 1
a29 1
RUN_DEPENDS=	py-Imaging-*-${PY_FLAVOR}:graphics/py-Imaging,${PY_FLAVOR} \
@


1.22
log
@normalize pkgpath
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2011/06/12 10:11:39 jasper Exp $
d6 1
a6 1
REVISION=	6
d27 2
a28 1
BUILD_DEPENDS=	${RUN_DEPENDS}
@


1.21
log
@missed bump after python 27 switch
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2010/11/17 08:05:13 espie Exp $
d6 1
a6 1
REVISION=	5
@


1.20
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2010/10/18 18:13:13 espie Exp $
d6 1
a6 1
REVISION=	4
@


1.19
log
@USE_GROFF=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2010/08/30 21:24:15 jasper Exp $
d28 4
a31 4
RUN_DEPENDS=	:py-Imaging-*-${PY_FLAVOR}:graphics/py-Imaging,${PY_FLAVOR} \
		::x11/py-gtk2 \
		::misc/shared-mime-info \
		:desktop-file-utils-*:devel/desktop-file-utils
@


1.18
log
@- bump for pythonia
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2009/12/22 16:06:40 ajacoutot Exp $
d33 1
@


1.17
log
@Use @@unexec-delete instead of @@unexec for the *-update-* goos.

prodded by espie@@
discussed with espie@@ sthen@@ landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2009/06/11 18:27:02 ajacoutot Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p3
@


1.16
log
@Bump after recent gconf2 MODULE change.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2009/06/08 16:58:15 ajacoutot Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p2
@


1.15
log
@Bump after recent gconf2 MODULE changes.

"yep, bumps are cheap" kili@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2009/06/07 05:32:02 ajacoutot Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p1
@


1.14
log
@Convert to using the new gconf2.port.mk module.

ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2009/04/15 08:26:28 landry Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p0
@


1.13
log
@Update to comix 4.0.3, MAINTAINER timeout
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2009/04/02 06:22:33 kili Exp $
d6 2
d20 2
a21 1
MODULES=	lang/python
d24 3
a30 1
		::devel/gconf2 \
d44 1
a44 1
		${INSTALL_DATA_DIR} ${WRKINST}/${LOCALBASE}/share/schemas/comix/
d46 1
a46 1
			${WRKINST}/${LOCALBASE}/share/schemas/comix/
@


1.12
log
@
Unconfuse @@exec/@@unexec. Noticed by frantisek holop.

ok msf@@ (maintainer), ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2009/03/15 18:29:31 espie Exp $
d5 1
a5 2
DISTNAME=	comix-4.0.2
PKGNAME =	${DISTNAME}p1
@


1.11
log
@fix a few deps
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2009/01/24 11:07:04 landry Exp $
d6 1
a6 1
PKGNAME =	${DISTNAME}p0
@


1.10
log
@Update to comix 4.0.2, rewritten from scratch upstream.
Properly register mime types and install schema file while here.
Use PKG_SUBST instead of perl -pi dance.
With help from wcmaier@@ for python-fu and ajacoutot@@ for gconf-fu, tnx!

MAINTAINER timeout, ok ajacoutot@@
grudgingly-ok-though-itd-be-nice-if-people-just-used-distutils wcmaier@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2008/10/08 16:02:29 jasper Exp $
d6 1
@


1.9
log
@- update comix to 3.6.5

from frantisek holop, with a tweak by me
maintainer timed-out
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2008/04/17 08:10:10 ajacoutot Exp $
d5 1
a5 1
DISTNAME=	comix-3.6.5
d24 2
d31 1
a31 1
		${GUNZIP_CMD} ${WRKSRC}/comix.1.gz
d34 1
a34 1
		# defined as empty to override do-build target from python module
d37 5
a41 4
		cd ${WRKSRC} && ${MODPY_BIN} install.py --installdir ${PREFIX} \
		       	--no-mime --no-balloon install
		perl -pi -e "s,#!/usr/bin/env python,#!${MODPY_BIN}," \
			${PREFIX}/bin/comix
@


1.8
log
@- tweak the way the gtk-update-icon-cache goo is run

gtk-update-icon-cache is part of gtk+2: adding gtk+2 to run_depends just
to update the icon cache (which only gtk apps can use) is overkill to
say the least!
As from now, each time icons are installed under %D/share/icons, we try
to execute gtk-update-icon-cache and if it is not there, we just ignore
the error.
What it means is that if you have gtk+2 installed, then it'll run fine
and your apps will be able to use the cache. Otherwise, it will silently
fails which is fine since it means none of your apps would have been
able to take advantage of the cache anyway.

discussed with jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2008/02/14 08:58:23 winiger Exp $
d5 1
a5 2
DISTNAME=	comix-3.6.2
PKGNAME=	${DISTNAME}p5
@


1.7
log
@change dependency to flavoured py-Imaging
bump PKGNAME

ok mbalmer@@ msf@@
testing by Laurance Tratt
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2007/12/15 20:43:07 ajacoutot Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p4
@


1.6
log
@- add update-desktop-database and gtk-update-icon-cache goo
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2007/11/20 18:53:21 mgrimm Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p3
d20 2
d23 1
a23 1
RUN_DEPENDS=	::graphics/py-Imaging \
a27 2

PYTHON=		${LOCALBASE}/bin/python${MODPY_VERSION}
@


1.5
log
@gunzip the man page and install it in the proper location

ok msf@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2007/10/08 08:22:41 steven Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p2
d22 2
a23 1
		::x11/py-gtk2 
@


1.4
log
@bump PKGNAME after python version switch
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2007/09/15 20:09:40 simon Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p1
d27 3
@


1.3
log
@remove surrounding quotes from COMMENT/BROKEN/PERMIT_*
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2007/05/06 22:35:55 alek Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p0
@


1.2
log
@- use full path for python binary instead of 'env python'
- use python module
- tweak comment

ok msf@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2007/02/05 07:25:31 msf Exp $
d3 1
a3 1
COMMENT=	"gtk2 comic book viewer"
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d3 1
a3 1
COMMENT=	"a gtk2 comic book viewer"
d6 1
d19 1
a19 2
MODPY_VERSION?= 2.4

d21 1
a21 2
RUN_DEPENDS=	::lang/python/${MODPY_VERSION} \
		::graphics/py-Imaging \
a23 1
NO_BUILD=	Yes
d28 3
d32 1
a32 1
		cd ${WRKSRC} && ${PYTHON} install.py --installdir ${PREFIX} \
d34 2
@


1.1.1.1
log
@initial import of comix 3.6.2

Comix is a user-friendly, customizable image viewer. It is specifically
designed to handle comic books, but also serves as a generic viewer. It
reads images in ZIP, RAR or tar archives (also gzip or bzip2 compressed)
as well as plain image files.
@
text
@@
