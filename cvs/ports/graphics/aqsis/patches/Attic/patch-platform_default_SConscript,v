head	1.3;
access;
symbols
	OPENBSD_4_8:1.2.0.14
	OPENBSD_4_8_BASE:1.2
	OPENBSD_4_7:1.2.0.12
	OPENBSD_4_7_BASE:1.2
	OPENBSD_4_6:1.2.0.10
	OPENBSD_4_6_BASE:1.2
	OPENBSD_4_5:1.2.0.8
	OPENBSD_4_5_BASE:1.2
	OPENBSD_4_4:1.2.0.6
	OPENBSD_4_4_BASE:1.2
	OPENBSD_4_3:1.2.0.4
	OPENBSD_4_3_BASE:1.2
	OPENBSD_4_2:1.2.0.2
	OPENBSD_4_2_BASE:1.2;
locks; strict;
comment	@# @;


1.3
date	2010.09.22.12.52.36;	author ajacoutot;	state dead;
branches;
next	1.2;

1.2
date	2007.03.28.17.14.02;	author ajacoutot;	state Exp;
branches;
next	1.1;

1.1
date	2007.03.27.17.09.15;	author ajacoutot;	state Exp;
branches;
next	;


desc
@@


1.3
log
@Major update to aqsis-1.6.0.
Drop maintainership.

ok sthen@@
@
text
@$OpenBSD: patch-platform_default_SConscript,v 1.2 2007/03/28 17:14:02 ajacoutot Exp $
--- platform/default/SConscript.orig	Sun Feb  4 11:44:55 2007
+++ platform/default/SConscript	Wed Mar 28 13:47:31 2007
@@@@ -15,7 +15,7 @@@@ if os.environ.has_key('CXXFLAGS'):
 if os.environ.has_key('LDFLAGS'):
 	env.AppendUnique(LINKFLAGS = SCons.Util.CLVar(os.environ['LDFLAGS']))
 
-env.AppendUnique(CCFLAGS=['-Wall','-g', '-O2'])
+env.AppendUnique(CCFLAGS=['-Wall','-g'])
 env.AppendUnique(CPPPATH = [env.Dir('#/aqsistypes/posix')])
 env.AppendUnique(CPPDEFINES=[('PLUGINS', '1')])
 
@@@@ -24,7 +24,7 @@@@ if not env['debug']:
 
 # Point at the boost headers.
 # todo: need to find a way of determining this location automatically
-env.Replace(boost_include_path = ['/usr/include/boost'])
+env.Replace(boost_include_path = ['!!LOCALBASE!!/include'])
 
 # Find out where the TIFF headers are, look in common places.
 tiffiofile = env.FindFile('tiffio.h', ['$tiff_include_path', '/usr/include'])
@@@@ -131,7 +131,7 @@@@ if env.subst('$destdir') != '':
 env.AppendUnique(CPPDEFINES=[('DEFAULT_RC_PATH', '\\"' + env.Dir('$SYSCONFDIR').abspath + '\\"')])
 env.AppendUnique(CPPDEFINES=[('DEFAULT_SHADER_PATH', '\\"' + env.Dir('$SHADERDIR').abspath + '\\"')])
 env.Replace(SHLIB_VERSION_SUFFIX = '.%d.%d' %(version.major, version.minor))
-env.AppendUnique(SHLINKFLAGS=['-Wl,-soname=${TARGET.file}.%d' %version.major])
+env.AppendUnique(SHLINKFLAGS=['-Wl,-soname=${TARGET.file}'])
 
 if not env['no_rpath']:
 	env.AppendUnique(RPATH=[env.Dir('$RENDERENGINEDIR').abspath])
@@@@ -140,7 +140,7 @@@@ if not env['no_rpath']:
 env.PrependENVPath('LD_LIBRARY_PATH', env.Dir('$build_prefix/aqsistypes').abspath)
 
 env.Replace(slparse_ccflags = ['-O0'])
-env.Replace(aqsistypes_libs = ['dl'])
+#env.Replace(aqsistypes_libs = ['dl'])
 
 def Symlink(dest, src):
 	def _symlink_func(target, source, env, dest=dest, src=src):
@@@@ -158,12 +158,12 @@@@ def Symlink(dest, src):
 def PostInstallSharedLibrary(env, dir, source):
 	basename = os.path.join('%s', '%s') %(dir, source[0])
 	sourcename = os.path.join('%s', '%s${SHLIB_VERSION_SUFFIX}') %(dir, source[0])
-	if env.subst('$destdir') != '':
-		env.Command(os.path.join('$DESTDIR', '%s.%d' %(basename, version.major)), os.path.join('$DESTDIR', '%s' %(sourcename)), Symlink(os.path.join('$DESTDIR', '%s.%d' %(basename, version.major)), sourcename))
-		env.Command(os.path.join('$DESTDIR', '%s' %(basename)), os.path.join('$DESTDIR', '%s' %(sourcename)), Symlink(os.path.join('$DESTDIR', '%s' %(basename)), sourcename))
-	else:
-		env.Command('%s.%d' %(basename, version.major), sourcename, Symlink('%s.%d' %(basename, version.major), sourcename))
-		env.Command('%s' %(basename), sourcename, Symlink('%s' %(basename), sourcename))
+#	if env.subst('$destdir') != '':
+#		env.Command(os.path.join('$DESTDIR', '%s.%d' %(basename, version.major)), os.path.join('$DESTDIR', '%s' %(sourcename)), Symlink(os.path.join('$DESTDIR', '%s.%d' %(basename, version.major)), sourcename))
+#		env.Command(os.path.join('$DESTDIR', '%s' %(basename)), os.path.join('$DESTDIR', '%s' %(sourcename)), Symlink(os.path.join('$DESTDIR', '%s' %(basename)), sourcename))
+#	else:
+#		env.Command('%s.%d' %(basename, version.major), sourcename, Symlink('%s.%d' %(basename, version.major), sourcename))
+#		env.Command('%s' %(basename), sourcename, Symlink('%s' %(basename), sourcename))
 
 env.PostInstallSharedLibrary = PostInstallSharedLibrary
 
@


1.2
log
@- make it compiles under amd64
- do not force -O2 CFLAGS optimisation
- do not use hard-coded path for bison (from naddy@@)

ok jasper@@ naddy@@
@
text
@d1 1
a1 1
$OpenBSD: patch-platform_default_SConscript,v 1.1 2007/03/27 17:09:15 ajacoutot Exp $
@


1.1
log
@err, forgot to add the patches in my previous commit
@
text
@d1 1
a1 1
$OpenBSD$
d3 10
a12 1
+++ platform/default/SConscript	Thu Feb 22 11:05:05 2007
@

