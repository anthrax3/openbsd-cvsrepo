head	1.1;
access;
symbols
	OPENBSD_6_0:1.1.0.32
	OPENBSD_6_0_BASE:1.1
	OPENBSD_5_9:1.1.0.28
	OPENBSD_5_9_BASE:1.1
	OPENBSD_5_8:1.1.0.30
	OPENBSD_5_8_BASE:1.1
	OPENBSD_5_7:1.1.0.26
	OPENBSD_5_7_BASE:1.1
	OPENBSD_5_6:1.1.0.24
	OPENBSD_5_6_BASE:1.1
	OPENBSD_5_5:1.1.0.22
	OPENBSD_5_5_BASE:1.1
	OPENBSD_5_4:1.1.0.20
	OPENBSD_5_4_BASE:1.1
	OPENBSD_5_3:1.1.0.18
	OPENBSD_5_3_BASE:1.1
	OPENBSD_5_2:1.1.0.16
	OPENBSD_5_2_BASE:1.1
	OPENBSD_5_1_BASE:1.1
	OPENBSD_5_1:1.1.0.14
	OPENBSD_5_0:1.1.0.12
	OPENBSD_5_0_BASE:1.1
	OPENBSD_4_9:1.1.0.10
	OPENBSD_4_9_BASE:1.1
	OPENBSD_4_8:1.1.0.8
	OPENBSD_4_8_BASE:1.1
	OPENBSD_4_7:1.1.0.6
	OPENBSD_4_7_BASE:1.1
	OPENBSD_4_6:1.1.0.4
	OPENBSD_4_6_BASE:1.1
	OPENBSD_4_5:1.1.0.2
	OPENBSD_4_5_BASE:1.1;
locks; strict;
comment	@# @;


1.1
date	2008.09.23.00.44.17;	author brad;	state Exp;
branches;
next	;


desc
@@


1.1
log
@Upgrade to libmpeg2 0.5.1.

Tested on amd64/i386, arm by sthen@@, powerpc by merdely@@, also
builds on alpha/sparc64.

ok merdely@@
@
text
@$OpenBSD$
--- configure.ac.orig	Fri Jul 18 10:30:17 2008
+++ configure.ac	Tue Sep 16 21:35:39 2008
@@@@ -37,13 +37,6 @@@@ elif test x"$GCC" = x"yes"; then
     TRY_CFLAGS="$OPT_CFLAGS -Wall -Wpointer-arith -Wcast-align -Wcast-qual -Wstrict-prototypes -Wshadow -Waggregate-return -Wmissing-prototypes -Wnested-externs -Wsign-compare"
     AC_TRY_CFLAGS([$TRY_CFLAGS $CFLAGS],[OPT_CFLAGS="$TRY_CFLAGS"])
 
-    dnl -O3
-    changequote(<<,>>)
-    TRY_CFLAGS=`echo "$OPT_CFLAGS $CFLAGS"|sed "s/-O[0-9]*//g"`
-    changequote([,])
-    TRY_CFLAGS="$TRY_CFLAGS -O3"
-    AC_TRY_CFLAGS([$TRY_CFLAGS],[OPT_CFLAGS="$TRY_CFLAGS"])
-
     AC_ARG_ENABLE([debug],
 	[  --enable-debug          debug mode configuration])
     if test x"$enable_debug" = x"yes"; then
@@@@ -61,41 +54,7 @@@@ elif test x"$GCC" = x"yes"; then
     dnl arch-specific flags
     arm_conditional=false
     case "$host" in
-    i?86-* | k?-* | x86_64-* | amd64-*)
-	AC_DEFINE([ARCH_X86],,[x86 architecture])
-	case "$host" in
-	i386-*) TRY_CFLAGS="$OPT_CFLAGS -mcpu=i386";;
-	i486-*) TRY_CFLAGS="$OPT_CFLAGS -mcpu=i486";;
-	i586-*) TRY_CFLAGS="$OPT_CFLAGS -mcpu=pentium";;
-	i686-*) TRY_CFLAGS="$OPT_CFLAGS -mcpu=pentiumpro";;
-	k6-*)   TRY_CFLAGS="$OPT_CFLAGS -mcpu=k6";;
-	esac
-	AC_TRY_CFLAGS([$TRY_CFLAGS $CFLAGS],[OPT_CFLAGS="$TRY_CFLAGS"]);;
-    ppc-* | powerpc-*)
-	have_altivec=no
-	for TRY_CFLAGS in "-mpim-altivec -force_cpusubtype_ALL" -faltivec -maltivec -fvec; do
-	    AC_TRY_CFLAGS([$OPT_CFLAGS $TRY_CFLAGS $CFLAGS],
-		[save_CFLAGS="$CFLAGS"
-		 CFLAGS="$OPT_CFLAGS $TRY_CFLAGS $CFLAGS"
-		 AC_MSG_CHECKING([if <altivec.h> is needed])
-		 AC_TRY_COMPILE([],
-		    [typedef vector int t;
-		     vec_ld(0, (unsigned char *)0);],
-		    [have_altivec=yes; AC_MSG_RESULT(no)],
-		    [AC_TRY_COMPILE([#include <altivec.h>],
-			[typedef vector int t; vec_ld(0, (unsigned char *)0);],
-			[AC_DEFINE([HAVE_ALTIVEC_H],,
-			    [Define to 1 if you have the <altivec.h> header.])
-			 have_altivec=yes; AC_MSG_RESULT(yes)],
-			[AC_MSG_RESULT(unsupported)])])
-		 CFLAGS="$save_CFLAGS"])
-	    if test "$have_altivec" = "yes"; then
-		ARCH_OPT_CFLAGS="$TRY_CFLAGS"
-		AC_DEFINE([ARCH_PPC],,[ppc architecture])
-		break
-	    fi
-	done;;
-    sparc-* | sparc64-*)
+    sparc64-*)
 	AC_DEFINE([ARCH_SPARC],,[sparc architecture])
 	TRY_CFLAGS="$OPT_CFLAGS -mcpu=ultrasparc -mvis"
 	AC_TRY_CFLAGS([$TRY_CFLAGS $CFLAGS],[OPT_CFLAGS="$TRY_CFLAGS"]);;
@
