head	1.3;
access;
symbols
	OPENBSD_6_0:1.3.0.8
	OPENBSD_6_0_BASE:1.3
	OPENBSD_5_9:1.3.0.4
	OPENBSD_5_9_BASE:1.3
	OPENBSD_5_8:1.3.0.6
	OPENBSD_5_8_BASE:1.3
	OPENBSD_5_7:1.3.0.2
	OPENBSD_5_7_BASE:1.3
	OPENBSD_5_6:1.2.0.2
	OPENBSD_5_6_BASE:1.2
	OPENBSD_5_5:1.1.0.2
	OPENBSD_5_5_BASE:1.1;
locks; strict;
comment	@# @;


1.3
date	2015.01.30.21.38.37;	author zhuk;	state Exp;
branches;
next	1.2;
commitid	VjkrBcCY1HczItO8;

1.2
date	2014.06.03.20.41.36;	author zhuk;	state Exp;
branches;
next	1.1;
commitid	yaC4poq6LCZO15Ua;

1.1
date	2013.10.21.22.46.28;	author zhuk;	state Exp;
branches;
next	;


desc
@@


1.3
log
@Fix two build problems in OpenCV, triggered after recent changes in
ports tree (that doesn't meant that those problems come from lands other
than OpenCV itself):

1. Stop exporting opencv_java target: noone links to the libopencv_java.so,
   anyway, and it breaks find_package(OpenCV) when opencv-java is absent.
   The actual broken port was Digikam on i386 (yes, due to some funny
   reasons, this didn't trigger on amd64).

2. Switch to gstreamer1 since OpenCV picks it up nowadays, if the former
   is found. WANTLIB updates included.

Initial report and testing by sthen@@.

Okays:
   (1) by dcoppa@@, sthen@@ (implicit) and Rafael Sadowski (MAINTAINER).
   (2) by sthen@@ (implicit).
@
text
@$OpenBSD: patch-modules_java_CMakeLists_txt,v 1.2 2014/06/03 20:41:36 zhuk Exp $
1. JNI shared object is installed in the same directory, so this should
   be under lib/.
2. Avoid exporting opencv_java together with other targets, unbreaks calling
   find_package(OpenCV) without opencv-java package being installed.
--- modules/java/CMakeLists.txt.orig	Wed Oct  1 11:33:36 2014
+++ modules/java/CMakeLists.txt	Thu Jan 29 21:20:33 2015
@@@@ -280,7 +280,7 @@@@ else(ANDROID)
   if(WIN32)
     set(JAR_INSTALL_DIR java)
   else(WIN32)
-    set(JAR_INSTALL_DIR share/OpenCV/java)
+    set(JAR_INSTALL_DIR lib/OpenCV/java)
   endif(WIN32)
   install(FILES ${JAR_FILE} DESTINATION ${JAR_INSTALL_DIR} COMPONENT java)
 endif(ANDROID)
@@@@ -357,11 +357,11 @@@@ if(ANDROID)
           ARCHIVE DESTINATION ${OPENCV_LIB_INSTALL_PATH} COMPONENT java)
 else()
   if(NOT INSTALL_CREATE_DISTRIB)
-    ocv_install_target(${the_module} EXPORT OpenCVModules
+    ocv_install_target(${the_module}
             RUNTIME DESTINATION ${JAR_INSTALL_DIR} COMPONENT java
             LIBRARY DESTINATION ${JAR_INSTALL_DIR} COMPONENT java)
   else()
-    ocv_install_target(${the_module} EXPORT OpenCVModules
+    ocv_install_target(${the_module}
             RUNTIME DESTINATION ${JAR_INSTALL_DIR}/${OpenCV_ARCH} COMPONENT java
             LIBRARY DESTINATION ${JAR_INSTALL_DIR}/${OpenCV_ARCH} COMPONENT java)
   endif()
@


1.2
log
@Update OpenCV to 2.4.9. Initial patch from Rafael Sadowski (MAINTAINER),
with some tweaks from me, including enabling -java back on i386.

Tested on i386 and amd64.
@
text
@d1 7
a7 5
$OpenBSD: patch-modules_java_CMakeLists_txt,v 1.1 2013/10/21 22:46:28 zhuk Exp $
JNI shared object is installed in the same directory, so this should
be under lib/.
--- modules/java/CMakeLists.txt.orig	Fri Apr 11 12:15:26 2014
+++ modules/java/CMakeLists.txt	Mon May 26 22:11:21 2014
d17 14
@


1.1
log
@Update to 2.4.6.1. Sat in my tree until sthen@@ helped me to realize that.
Key notes:

  * OpenCV now has separate "opencv_nonfree" module, which contains all of
    the patented algorithms. It was decided on ports@@ to not create "nonfree"
    FLAVOR but just set PERMIT_PACKAGE_CDROM=No, while allowing FTP
    distribution.

  * OpenCV now have its own Java bindings. You could avoid building them by
    using the "no_java" PSEUDO_FLAVOR.

  * Documentation placement was cleaned up, too.

Input from sthen@@ and naddy@@. Tested on i386 and amd64 with Digikam from WIP.

Okay sthen@@ and Rafael Sadowski (MAINTAINER)
@
text
@d1 1
a1 1
$OpenBSD$
d4 3
a6 3
--- modules/java/CMakeLists.txt.orig	Sat Jul 27 23:22:08 2013
+++ modules/java/CMakeLists.txt	Sat Jul 27 23:28:22 2013
@@@@ -263,7 +263,7 @@@@ else(ANDROID)
d13 1
a13 1
   install(FILES ${JAR_FILE} DESTINATION ${JAR_INSTALL_DIR} COMPONENT main)
@

