head	1.42;
access;
symbols
	OPENBSD_6_2:1.42.0.2
	OPENBSD_6_2_BASE:1.42
	OPENBSD_6_1:1.38.0.2
	OPENBSD_6_1_BASE:1.38
	OPENBSD_6_0:1.37.0.2
	OPENBSD_6_0_BASE:1.37
	OPENBSD_5_9:1.35.0.2
	OPENBSD_5_9_BASE:1.35
	OPENBSD_5_8:1.34.0.6
	OPENBSD_5_8_BASE:1.34
	OPENBSD_5_7:1.34.0.2
	OPENBSD_5_7_BASE:1.34
	OPENBSD_5_6:1.27.0.2
	OPENBSD_5_6_BASE:1.27
	OPENBSD_5_5:1.23.0.2
	OPENBSD_5_5_BASE:1.23
	OPENBSD_5_4:1.19.0.2
	OPENBSD_5_4_BASE:1.19
	OPENBSD_5_3:1.17.0.2
	OPENBSD_5_3_BASE:1.17
	OPENBSD_5_2:1.12.0.2
	OPENBSD_5_2_BASE:1.12
	OPENBSD_5_1_BASE:1.11
	OPENBSD_5_1:1.11.0.2
	OPENBSD_5_0:1.3.0.2
	OPENBSD_5_0_BASE:1.3
	jasper_20112406:1.1.1.1
	jasper:1.1.1;
locks; strict;
comment	@# @;


1.42
date	2017.07.26.22.45.24;	author sthen;	state Exp;
branches;
next	1.41;
commitid	tD4MFrpYYDDL2UFT;

1.41
date	2017.07.16.19.18.57;	author espie;	state Exp;
branches;
next	1.40;
commitid	tt0GhWK5c4uf9ILG;

1.40
date	2017.04.19.11.16.03;	author sthen;	state Exp;
branches;
next	1.39;
commitid	RQY4uecaoLumt4eI;

1.39
date	2017.04.10.11.46.21;	author sthen;	state Exp;
branches;
next	1.38;
commitid	BLsh88fJB8thZTwY;

1.38
date	2016.11.29.00.27.23;	author sthen;	state Exp;
branches;
next	1.37;
commitid	lQ3kV37BXgsQC9Ti;

1.37
date	2016.04.15.08.53.49;	author shadchin;	state Exp;
branches;
next	1.36;
commitid	DdvlmL5VDlYoSZZS;

1.36
date	2016.03.20.16.12.24;	author naddy;	state Exp;
branches;
next	1.35;
commitid	guiZq8cnNbVyyHzx;

1.35
date	2015.11.23.20.34.07;	author zhuk;	state Exp;
branches;
next	1.34;
commitid	fVq3wILNycFddnS0;

1.34
date	2015.01.30.21.38.37;	author zhuk;	state Exp;
branches;
next	1.33;
commitid	VjkrBcCY1HczItO8;

1.33
date	2015.01.26.21.59.55;	author zhuk;	state Exp;
branches;
next	1.32;
commitid	SDbYvEzboN4sxEWM;

1.32
date	2015.01.24.11.18.39;	author zhuk;	state Exp;
branches;
next	1.31;
commitid	TapIxp4JlR6m5e24;

1.31
date	2015.01.24.10.56.43;	author zhuk;	state Exp;
branches;
next	1.30;
commitid	ioZH0CBQomXKU1Qk;

1.30
date	2014.09.30.17.18.37;	author sthen;	state Exp;
branches;
next	1.29;
commitid	iHGYechZ22kOOHfv;

1.29
date	2014.09.29.15.09.12;	author dcoppa;	state Exp;
branches;
next	1.28;
commitid	PwxIwzH2G6XBpIa4;

1.28
date	2014.09.18.16.30.00;	author zhuk;	state Exp;
branches;
next	1.27;
commitid	YmTsGGHXlbJjNw6D;

1.27
date	2014.06.07.14.55.29;	author zhuk;	state Exp;
branches;
next	1.26;
commitid	YACJgrJPKywScJuJ;

1.26
date	2014.06.03.20.41.36;	author zhuk;	state Exp;
branches;
next	1.25;
commitid	yaC4poq6LCZO15Ua;

1.25
date	2014.05.08.21.23.21;	author kurt;	state Exp;
branches;
next	1.24;

1.24
date	2014.05.07.15.42.16;	author kurt;	state Exp;
branches;
next	1.23;

1.23
date	2013.11.25.14.16.23;	author sthen;	state Exp;
branches;
next	1.22;

1.22
date	2013.10.24.08.44.36;	author zhuk;	state Exp;
branches;
next	1.21;

1.21
date	2013.10.23.17.06.51;	author zhuk;	state Exp;
branches;
next	1.20;

1.20
date	2013.10.21.22.46.27;	author zhuk;	state Exp;
branches;
next	1.19;

1.19
date	2013.03.21.08.45.19;	author ajacoutot;	state Exp;
branches;
next	1.18;

1.18
date	2013.03.11.11.10.54;	author espie;	state Exp;
branches;
next	1.17;

1.17
date	2013.01.19.10.13.15;	author brad;	state Exp;
branches;
next	1.16;

1.16
date	2012.12.29.20.49.17;	author landry;	state Exp;
branches;
next	1.15;

1.15
date	2012.12.16.12.09.17;	author sthen;	state Exp;
branches;
next	1.14;

1.14
date	2012.12.16.11.34.33;	author sthen;	state Exp;
branches;
next	1.13;

1.13
date	2012.09.06.12.38.35;	author ajacoutot;	state Exp;
branches;
next	1.12;

1.12
date	2012.05.03.06.35.31;	author ajacoutot;	state Exp;
branches;
next	1.11;

1.11
date	2011.12.05.09.36.32;	author espie;	state Exp;
branches;
next	1.10;

1.10
date	2011.12.04.22.49.22;	author espie;	state Exp;
branches;
next	1.9;

1.9
date	2011.11.16.23.28.37;	author sthen;	state Exp;
branches;
next	1.8;

1.8
date	2011.11.15.00.09.31;	author sthen;	state Exp;
branches;
next	1.7;

1.7
date	2011.11.14.09.54.45;	author sthen;	state Exp;
branches;
next	1.6;

1.6
date	2011.11.12.16.49.43;	author sthen;	state Exp;
branches;
next	1.5;

1.5
date	2011.11.02.09.57.22;	author jasper;	state Exp;
branches;
next	1.4;

1.4
date	2011.09.16.10.02.37;	author espie;	state Exp;
branches;
next	1.3;

1.3
date	2011.07.16.22.43.57;	author espie;	state Exp;
branches;
next	1.2;

1.2
date	2011.06.24.11.17.05;	author sthen;	state Exp;
branches;
next	1.1;

1.1
date	2011.06.24.09.30.21;	author jasper;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2011.06.24.09.30.21;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.42
log
@bump LIBCXX/LIBECXX/COMPILER_LIBCXX ports.
@
text
@# $OpenBSD: Makefile,v 1.41 2017/07/16 19:18:57 espie Exp $

ONLY_FOR_ARCHS =	${GCC4_ARCHS} ${CLANG_ARCHS}

CATEGORIES =		graphics devel
COMMENT-docs =		OpenCV documentation and examples
COMMENT-main =		library of programming functions for real time cv
COMMENT-java =		Java bindings for OpenCV

V =			2.4.13
GH_ACCOUNT =		Itseez
GH_PROJECT =		opencv
GH_TAGNAME = 		${V}

PKGNAME-main =		${PKGNAME}
PKGNAME-docs =		opencv-docs-$V
PKGNAME-java =		opencv-java-$V
REVISION-docs =		0
REVISION-java =		0
REVISION-main =		0

.for i in opencv_calib3d opencv_contrib opencv_core opencv_features2d \
  opencv_flann opencv_gpu opencv_highgui opencv_imgproc opencv_legacy \
  opencv_ml opencv_nonfree opencv_objdetect opencv_photo opencv_stitching \
  opencv_superres opencv_ts opencv_video opencv_videostab opencv_ocl
SHARED_LIBS += $i 2.0
.endfor

HOMEPAGE =		http://www.opencv.org/
MAINTAINER =		Rafael Sadowski <rafael@@sizeofvoid.org>

# "patents" means containing some patented algorithms, see
# http://docs.opencv.org/modules/nonfree/doc/nonfree.html
# As some source modules include this functionality, we couldn't
# just subpackage "nonfree". Excluding this, here we have a usual
# BSD license.
PERMIT_PACKAGE_FTP =		Yes
PERMIT_PACKAGE_CDROM =		patents
PERMIT_PACKAGE_CDROM-docs =	Yes

WANTLIB-main += ${MODPY_WANTLIB}
WANTLIB-main += Half Iex IlmImf IlmThread Imath X11 Xcomposite Xcursor
WANTLIB-main += Xdamage Xext Xfixes Xi Xinerama Xrandr Xrender atk-1.0
WANTLIB-main += avcodec avformat avresample avutil bz2 c cairo fontconfig
WANTLIB-main += freetype gdk-x11-2.0 gdk_pixbuf-2.0 gio-2.0 glib-2.0
WANTLIB-main += gobject-2.0 gstapp-1.0 gstbase-1.0 gstpbutils-1.0 gstreamer-1.0
WANTLIB-main += gstriff-1.0 gstvideo-1.0 gthread-2.0 gtk-x11-2.0 intl
WANTLIB-main += jasper jpeg m pango-1.0 pangocairo-1.0 pangoft2-1.0
WANTLIB-main += png pthread ${COMPILER_LIBCXX} swscale tiff z

WANTLIB-docs =

WANTLIB-java =  m pthread ${COMPILER_LIBCXX}
WANTLIB-java += opencv_calib3d opencv_contrib opencv_core opencv_features2d
WANTLIB-java += opencv_flann opencv_gpu opencv_highgui opencv_imgproc
WANTLIB-java += opencv_legacy opencv_ml opencv_nonfree opencv_objdetect
WANTLIB-java += opencv_ocl opencv_photo opencv_video

MULTI_PACKAGES =	-main -docs -java
PSEUDO_FLAVORS =	no_docs no_java
FLAVOR ?=

.include <bsd.port.arch.mk>

MODULES =		devel/cmake \
			lang/python

BUILD_DEPENDS =		devel/doxygen \
			math/py-numpy \
			math/eigen3

RUN_DEPENDS-main =	math/py-numpy
RUN_DEPENDS-docs =	${BUILD_PKGPATH},-main
RUN_DEPENDS-java =	${MODJAVA_RUN_DEPENDS}

LIB_DEPENDS-main =	${LIB_DEPENDS} \
			${MODPY_LIB_DEPENDS} \
			multimedia/gstreamer1/plugins-base \
			x11/gtk+2 \
			graphics/ffmpeg \
			graphics/ilmbase \
			graphics/jpeg \
			graphics/openexr \
			graphics/png \
			graphics/tiff
LIB_DEPENDS-docs =
LIB_DEPENDS-java =	${BUILD_PKGPATH},-main=${V}

# ATM opencv requires V4L1 compat, ask them to change it,
# then see WITH_V4L below.
CONFIGURE_ARGS =	-DBUILD_opencv_nonfree:Bool=On \
			-DBUILD_opencv_python:Bool=On \
			-DWITH_1394:Bool=Off \
			-DWITH_CUDA:Bool=Off \
			-DWITH_EIGEN:Bool=Off \
			-DWITH_FFMPEG:Bool=On \
			-DWITH_GSTREAMER:Bool=On \
			-DWITH_GTK:Bool=On \
			-DWITH_JPEG:Bool=On \
			-DWITH_PNG:Bool=On \
			-DWITH_TIFF:Bool=On \
			-DWITH_V4L:Bool=Off \
			-DPYTHON_EXECUTABLE:FILEPATH=${MODPY_BIN}

.if ${ARCH:Mi386}
# XXX PIE cannot be produced due to problems with inline assembly.
# Since OpenCV is mostly used as a library, switch to PIC.
CONFIGURE_ENV =		CFLAGS="${CFLAGS} -fPIC" \
			CXXFLAGS="${CXXFLAGS} -fPIC"
CONFIGURE_ARGS +=	-DENABLE_SSE3:Bool=Off
.endif

.if ${BUILD_PACKAGES:M-java}
MODULES +=		java
MODJAVA_VER =		1.8+
BUILD_DEPENDS +=	devel/apache-ant
.else
# Safe: Java will be detected, if present, but won't be used
CONFIGURE_ARGS +=	-DBUILD_opencv_java:Bool=Off
.endif

.if ${BUILD_PACKAGES:M-docs}
BUILD_DEPENDS +=	textproc/py-sphinx
ALL_TARGET =		all html_docs
CONFIGURE_ARGS +=	-DBUILD_DOCS:Bool=On \
			-DBUILD_EXAMPLES:Bool=On \
			-DINSTALL_C_EXAMPLES:Bool=On \
			-DINSTALL_PYTHON_EXAMPLES:Bool=On
.else
CONFIGURE_ARGS +=	-DBUILD_DOCS:Bool=Off \
			-DBUILD_EXAMPLES:Bool=Off \
			-DINSTALL_PYTHON_EXAMPLES:Bool=Off
.endif

CONFIG_ADJ_CMD =	perl -pi
.for _l _v in ${SHARED_LIBS}
CONFIG_ADJ_CMD +=	-e 's,lib${_l}.so([^.]),lib${_l}.so.${_v}$$1,g;'
.endfor

DOCDIR =		${PREFIX}/share/doc/OpenCV

post-patch:
	perl -pi -e 's@@^.*(#\s*include)@@$$1@@' \
		${WRKSRC}/samples/cpp/tutorial_code/core/how_to_scan_images/how_to_scan_images.cpp

post-install:
	${CONFIG_ADJ_CMD} ${PREFIX}/share/OpenCV/OpenCVConfig.cmake
	${MODPY_BIN} ${MODPY_LIBDIR}/compileall.py ${WRKINST}${MODPY_SITEPKG}
.if ${BUILD_PACKAGES:M-docs}
	rm -Rf ${DOCDIR}
	mv ${PREFIX}/share/OpenCV/doc ${DOCDIR}
	cp -R ${WRKBUILD}/doc/_html ${DOCDIR}/html
.endif

do-test:
	cd ${WRKBUILD}; \
	${MODPY_BIN} ${WRKSRC}/modules/ts/misc/run.py

.include <bsd.port.mk>
@


1.41
log
@use COMPILER_LIBCXX where applicable
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2017/04/19 11:16:03 sthen Exp $
d18 3
@


1.40
log
@Add ${CLANG_ARCHS} to "ONLY_FOR_ARCHS = ${GCC4_ARCHS}" lines to give them
a chance on aarch64.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2017/04/10 11:46:21 sthen Exp $
d46 1
a46 1
WANTLIB-main += png pthread ${LIBCXX} swscale tiff z
d50 1
a50 1
WANTLIB-java =  m pthread ${LIBCXX}
@


1.39
log
@use LIBCXX
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2016/11/29 00:27:23 sthen Exp $
d3 1
a3 1
ONLY_FOR_ARCHS =	${GCC4_ARCHS}
@


1.38
log
@update to opencv-2.4.13, from maintainer Rafael Sadowski with a few tweaks by me
and ok with him.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2016/04/15 08:53:49 shadchin Exp $
d46 1
a46 1
WANTLIB-main += png pthread stdc++ swscale tiff z
d50 1
a50 1
WANTLIB-java =  m pthread stdc++
@


1.37
log
@Unbreak after py-sphinx update to 1.4
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2016/03/20 16:12:24 naddy Exp $
a3 1
ONLY_FOR_ARCHS-java =	amd64 i386
d10 5
a14 2
V =			2.4.12.3
DISTNAME =		opencv-$V
d18 7
a24 1
REVISION-docs =		0
d29 8
a36 23
SHARED_LIBS =		opencv_calib3d			1.1 #1.2
SHARED_LIBS +=		opencv_contrib			1.1 #1.2
SHARED_LIBS +=		opencv_core			1.1 #1.2
SHARED_LIBS +=		opencv_features2d		1.1 #1.2
SHARED_LIBS +=		opencv_flann			1.1 #1.2
SHARED_LIBS +=		opencv_gpu			1.1 #1.2
SHARED_LIBS +=		opencv_highgui			1.1 #1.2
SHARED_LIBS +=		opencv_imgproc			1.1 #1.2
SHARED_LIBS +=		opencv_legacy			1.1 #1.2
SHARED_LIBS +=		opencv_ml			1.1 #1.2
SHARED_LIBS +=		opencv_nonfree			0.1 #0.2
SHARED_LIBS +=		opencv_objdetect		1.1 #1.2
SHARED_LIBS +=		opencv_photo			0.1 #0.2
SHARED_LIBS +=		opencv_stitching		0.1 #0.2
SHARED_LIBS +=		opencv_superres			0.1 #0.2
SHARED_LIBS +=		opencv_ts			0.1 #0.2
SHARED_LIBS +=		opencv_video			1.1 #1.2
SHARED_LIBS +=		opencv_videostab		0.1 #0.2
SHARED_LIBS +=		opencv_ocl			0.1 #2.5

GH_ACCOUNT =		Itseez
GH_PROJECT =		opencv
GH_COMMIT =		8e40becab12c642e7bbafb9fe87698e8b6bf28da
d38 2
a39 1
WANTLIB-main =  Half Iex IlmImf IlmThread Imath X11 Xcomposite Xcursor
d41 1
a41 1
WANTLIB-main += avcodec avformat avutil bz2 c cairo fontconfig
d43 4
a46 5
WANTLIB-main += gobject-2.0 gstapp-1.0 gstbase-1.0 gstpbutils-1.0
WANTLIB-main += gstreamer-1.0 gstriff-1.0 gstvideo-1.0 gthread-2.0 gtk-x11-2.0
WANTLIB-main += jasper jpeg m pango-1.0 pangocairo-1.0 avresample
WANTLIB-main += pangoft2-1.0 png pthread stdc++ swscale tiff xml2 z
WANTLIB-main += ${MODGETTEXT_WANTLIB} ${MODPY_WANTLIB}
d51 4
a54 5
WANTLIB-java += opencv_calib3d opencv_contrib opencv_core
WANTLIB-java += opencv_features2d opencv_flann opencv_highgui
WANTLIB-java += opencv_imgproc opencv_ml opencv_objdetect
WANTLIB-java += opencv_photo opencv_video
WANTLIB-java += opencv_gpu opencv_legacy opencv_nonfree opencv_ocl
a59 9
# "patents" means containing some patented algorithms, see
# http://docs.opencv.org/modules/nonfree/doc/nonfree.html
# As some source modules include this functionality, we couldn't
# just subpackage "nonfree". Excluding this, here we have a usual
# BSDL
PERMIT_PACKAGE_FTP =		Yes
PERMIT_PACKAGE_CDROM =		patents
PERMIT_PACKAGE_CDROM-docs =	Yes

a62 1
			devel/gettext \
a85 7
# XXX PIE cannot be produced due to problems with inline assembly.
# Since OpenCV is mostly used as a library, switch to PIC.
.if ${ARCH:Mi386}
CONFIGURE_ENV =		CFLAGS="${CFLAGS} -fPIC" \
			CXXFLAGS="${CXXFLAGS} -fPIC"
.endif

d102 8
d112 1
a112 1
MODJAVA_VER =		1.7+
d153 2
a154 7
	@@cd ${WRKBUILD}/bin; \
	failed=false; \
	for t in opencv_test*; do \
		echo "RUNNING TEST: $$t" >&2; \
		./$$t || failed=true; \
	done; \
	$$failed
@


1.36
log
@drop SHARED_ONLY from python and ruby ports
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2015/11/23 20:34:07 zhuk Exp $
d16 1
@


1.35
log
@Update OpenCV to 2.4.12.3.

This fixes library naming in pkg-config files, as it was reported on ports@@.
Also, it'd be last update before OpenCV 3.0, which is WIP (in openbsd-wip).

From maintainer Rafael Sadowski, thanks!
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2015/01/30 21:38:37 zhuk Exp $
a4 1
SHARED_ONLY =		Yes
@


1.34
log
@Fix two build problems in OpenCV, triggered after recent changes in
ports tree (that doesn't meant that those problems come from lands other
than OpenCV itself):

1. Stop exporting opencv_java target: noone links to the libopencv_java.so,
   anyway, and it breaks find_package(OpenCV) when opencv-java is absent.
   The actual broken port was Digikam on i386 (yes, due to some funny
   reasons, this didn't trigger on amd64).

2. Switch to gstreamer1 since OpenCV picks it up nowadays, if the former
   is found. WANTLIB updates included.

Initial report and testing by sthen@@.

Okays:
   (1) by dcoppa@@, sthen@@ (implicit) and Rafael Sadowski (MAINTAINER).
   (2) by sthen@@ (implicit).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2015/01/26 21:59:55 zhuk Exp $
d12 1
a12 1
V =			2.4.10
a16 2
REVISION-main =		1
REVISION-java =		0
d21 23
a43 22
SHARED_LIBS =		opencv_calib3d			1.0 #1.1
SHARED_LIBS +=		opencv_contrib			1.0 #1.1
SHARED_LIBS +=		opencv_core			1.0 #1.1
SHARED_LIBS +=		opencv_features2d		1.0 #1.1
SHARED_LIBS +=		opencv_flann			1.0 #1.1
SHARED_LIBS +=		opencv_gpu			1.0 #1.1
SHARED_LIBS +=		opencv_highgui			1.0 #1.1
SHARED_LIBS +=		opencv_imgproc			1.0 #1.1
SHARED_LIBS +=		opencv_legacy			1.0 #1.1
SHARED_LIBS +=		opencv_ml			1.0 #1.1
SHARED_LIBS +=		opencv_nonfree			0.0 #0.1
SHARED_LIBS +=		opencv_objdetect		1.0 #1.1
SHARED_LIBS +=		opencv_photo			0.0 #0.1
SHARED_LIBS +=		opencv_stitching		0.0 #0.1
SHARED_LIBS +=		opencv_superres			0.0 #0.1
SHARED_LIBS +=		opencv_ts			0.0 #0.1
SHARED_LIBS +=		opencv_video			1.0 #1.1
SHARED_LIBS +=		opencv_videostab		0.0 #0.1
SHARED_LIBS +=		opencv_ocl			0.0 #2.4

EXTRACT_SUFX =		.zip
MASTER_SITES =		${MASTER_SITE_SOURCEFORGE:=opencvlibrary/}
d51 1
a51 1
WANTLIB-main += jasper jpeg m pango-1.0 pangocairo-1.0
d84 2
a85 1
			math/py-numpy
d114 1
d124 2
a125 1
			-DWITH_V4L:Bool=Off
@


1.33
log
@Completely disable offending part of CPU features detection for i386.
It came between OpenCV 2.4.9 and 2.4.10, and continues to break on at least
sthen@@'s build system. In other words, this unbreaks OpenCV 2.4.10 on i386.

requested by sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2015/01/24 11:18:39 zhuk Exp $
d17 2
a18 1
REVISION-main =		0
d50 2
a51 2
WANTLIB-main += gmodule-2.0 gobject-2.0 gstapp-0.10 gstbase-0.10
WANTLIB-main += gstreamer-0.10 gstvideo-0.10 gthread-2.0 gtk-x11-2.0
d58 1
a58 1
WANTLIB-java =  m pthread stdc++ z
d63 1
d93 1
a93 1
			multimedia/gstreamer-0.10/plugins-base \
@


1.32
log
@Put back i386 to the list of ONLY_FOR_ARCHS-java. To be removed if problems
will arise again.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2015/01/24 10:56:43 zhuk Exp $
d17 1
@


1.31
log
@Update OpenCV to 2.4.10, mostly from Rafael Sadowski (MAINTAINER).

This switches the whole package to PIC (from PIE) due to problems with
inline assembly and build system specifics. Since OpenCV is used mostly
as a library, this shouldn't be a big problem.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2014/09/30 17:18:37 sthen Exp $
d4 1
a4 2
# XXX no i386 due to often JDK build failures
ONLY_FOR_ARCHS-java =	amd64
@


1.30
log
@hidden dep on eigen2/3, spotted by jasper@@; disabled with a cmake flag
for now, this can be revisited later if wanted.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2014/09/29 15:09:12 dcoppa Exp $
d13 1
a13 1
V =			2.4.9
a17 2
REVISION-main =		1
REVISION-docs =		0
d100 8
a107 1
LIB_DEPENDS-java =	${BUILD_PKGPATH},-main
@


1.29
log
@
Zap bogus file from pkg/PLIST-docs

Spotted by naddy@@
ok zhuk@@, Rafael Sadowski (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2014/09/18 16:30:00 zhuk Exp $
d18 1
a18 1
REVISION-main =		0
d109 1
@


1.28
log
@Fix linking problem, likely causing CMake crashes on i386 sthen@@ is seeing.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2014/06/07 14:55:29 zhuk Exp $
d19 1
@


1.27
log
@Remove i386 from ONLY_FOR_ARCHS-java: JDK still builds unreliably on i386.

Requested by sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2014/06/03 20:41:36 zhuk Exp $
d18 1
@


1.26
log
@Update OpenCV to 2.4.9. Initial patch from Rafael Sadowski (MAINTAINER),
with some tweaks from me, including enabling -java back on i386.

Tested on i386 and amd64.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2014/05/08 21:23:21 kurt Exp $
d4 2
a5 1
ONLY_FOR_ARCHS-java =	amd64 i386
@


1.25
log
@- base package should not depend on jdk. fix and bump. okay landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2014/05/07 15:42:16 kurt Exp $
d4 1
a4 2
# do not include i386 here until JDK 1.6 issues there are solved
ONLY_FOR_ARCHS-java =	amd64
d12 1
a12 1
V =			2.4.6.1
a17 3
REVISION-main=		0
REVISION-java=		0

d21 19
a39 18
SHARED_LIBS =		opencv_calib3d			1.0 #1.0
SHARED_LIBS +=		opencv_contrib			1.0 #1.0
SHARED_LIBS +=		opencv_core			1.0 #1.0
SHARED_LIBS +=		opencv_features2d		1.0 #1.0
SHARED_LIBS +=		opencv_flann			1.0 #1.0
SHARED_LIBS +=		opencv_gpu			1.0 #1.0
SHARED_LIBS +=		opencv_highgui			1.0 #1.0
SHARED_LIBS +=		opencv_imgproc			1.0 #1.0
SHARED_LIBS +=		opencv_legacy			1.0 #1.0
SHARED_LIBS +=		opencv_ml			1.0 #1.0
SHARED_LIBS +=		opencv_nonfree			0.0 #0.0
SHARED_LIBS +=		opencv_objdetect		1.0 #1.0
SHARED_LIBS +=		opencv_photo			0.0 #0.0
SHARED_LIBS +=		opencv_stitching		0.0 #0.0
SHARED_LIBS +=		opencv_superres			0.0 #0.0
SHARED_LIBS +=		opencv_ts			0.0 #0.0
SHARED_LIBS +=		opencv_video			1.0 #1.0
SHARED_LIBS +=		opencv_videostab		0.0 #0.0
d41 1
d116 1
a116 1
MODJAVA_VER =		1.6+
@


1.24
log
@- Unlink jdk/1.6 and make jdk/1.7 the default jdk for all java ports
- Adjust java.port.mk and cmake to use 1.7
- Adjust jdk/1.7 for pkg_add upgrades
okay sthen@@, jasper@@, ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2013/11/25 14:16:23 sthen Exp $
d19 1
d86 1
a86 2
RUN_DEPENDS-main =	${RUN_DEPENDS} \
			math/py-numpy
@


1.23
log
@kill VMEM_WARNING
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2013/10/24 08:44:36 zhuk Exp $
d18 2
@


1.22
log
@Do not enable Java bindings for OpenCV on i386 until JDK issues are solved.

prodded by sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2013/10/23 17:06:51 zhuk Exp $
a6 1
VMEM_WARNING =		Yes
@


1.21
log
@Missing BDEP on apache-ant, revealed by rpe@@.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2013/10/21 22:46:27 zhuk Exp $
d4 2
a5 1
ONLY_FOR_ARCHS-java =	i386 amd64
@


1.20
log
@Update to 2.4.6.1. Sat in my tree until sthen@@ helped me to realize that.
Key notes:

  * OpenCV now has separate "opencv_nonfree" module, which contains all of
    the patented algorithms. It was decided on ports@@ to not create "nonfree"
    FLAVOR but just set PERMIT_PACKAGE_CDROM=No, while allowing FTP
    distribution.

  * OpenCV now have its own Java bindings. You could avoid building them by
    using the "no_java" PSEUDO_FLAVOR.

  * Documentation placement was cleaned up, too.

Input from sthen@@ and naddy@@. Tested on i386 and amd64 with Digikam from WIP.

Okay sthen@@ and Rafael Sadowski (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2013/03/21 08:45:19 ajacoutot Exp $
d117 1
@


1.19
log
@USE_LIBTOOL=Yes is the default now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2013/03/11 11:10:54 espie Exp $
d3 70
a72 1
ONLY_FOR_ARCHS=		${GCC4_ARCHS}
d74 1
a74 2
BROKEN-sparc64 = 	error: cannot convert 'int*' to 'volatile _Atomic_word*'
SHARED_ONLY=		Yes
d76 1
a76 45
COMMENT-main=		library of programming functions for real time cv
COMMENT-docs=		documentation for OpenCV

V=			2.2.0
DISTNAME=		OpenCV-$V
PKGNAME-main=		opencv-$V
REVISION-main=		8
PKGNAME-docs=		opencv-docs-$V
REVISION-docs=		1
CATEGORIES=		graphics devel

SHARED_LIBS +=		opencv_calib3d			0.0
SHARED_LIBS +=		opencv_contrib			0.0
SHARED_LIBS +=		opencv_core			0.0
SHARED_LIBS +=		opencv_features2d		0.0
SHARED_LIBS +=		opencv_flann			0.0
SHARED_LIBS +=		opencv_gpu			0.0
SHARED_LIBS +=		opencv_highgui			0.0
SHARED_LIBS +=		opencv_imgproc			0.0
SHARED_LIBS +=		opencv_legacy			0.0
SHARED_LIBS +=		opencv_ml			0.0
SHARED_LIBS +=		opencv_objdetect		0.0
SHARED_LIBS +=		opencv_video			0.0

HOMEPAGE=		http://opencv.willowgarage.com/

MAINTAINER=		Rafael Sadowski <rafael@@sizeofvoid.org>

# BSD
PERMIT_PACKAGE_CDROM=	Yes

MASTER_SITES=		${MASTER_SITE_SOURCEFORGE:=opencvlibrary/}
EXTRACT_SUFX=		.tar.bz2

WANTLIB += GL Half Iex IlmImf Imath X11 Xcomposite Xcursor Xdamage
WANTLIB += Xext Xfixes Xi Xinerama Xrandr Xrender atk-1.0 avcodec
WANTLIB += avformat avutil bz2 c cairo expat fontconfig freetype
WANTLIB += gdk-x11-2.0 gdk_pixbuf-2.0 gio-2.0 glib-2.0 gmodule-2.0
WANTLIB += gobject-2.0 gstapp-0.10 gstbase-0.10 gstreamer-0.10
WANTLIB += gstvideo-0.10 gthread-2.0 gtk-x11-2.0 jasper jpeg m
WANTLIB += pango-1.0 pangocairo-1.0 pangoft2-1.0 pixman-1 png
WANTLIB += pthread pthread-stubs stdc++ swscale tiff xcb
WANTLIB += xcb-render xcb-shm xml2 z ${MODPY_WANTLIB}

MODULES=		devel/cmake \
d80 7
a86 1
MULTI_PACKAGES= 	-main -docs
d88 3
a90 2
CONFIGURE_STYLE=	cmake
LIB_DEPENDS-main=	multimedia/gstreamer-0.10/plugins-base \
d92 1
d94 1
d96 4
a99 13
			graphics/ffmpeg>=20121026

WANTLIB-docs=		# empty
LIB_DEPENDS-docs=	# empty
RUN_DEPENDS-docs=	# empty
PKG_ARCH-docs=		*


VMEM_WARNING=		Yes

RUN_DEPENDS-main=	math/py-numpy
BUILD_DEPENDS=		devel/doxygen \
			math/py-numpy
d103 5
a107 5
CONFIGURE_ARGS+=	-DBUILD_EXAMPLES:Bool=Off \
			-DINSTALL_C_EXAMPLES:Bool=Off \
			-DINSTALL_PYTHON_EXAMPLES:Bool=Off \
			-DBUILD_PYTHON_SUPPORT:Bool=On \
			-DBUILD_LATEX_DOCS:Bool=Off \
d109 54
a162 14
			-DWITH_V4L:Bool=Off \
			-DWITH_EIGEN2:Bool=Off \
			-DWITH_GSTREAMER:Bool=On \
			-DWITH_1394:Bool=Off \
			-DWITH_FFMPEG:Bool=On

MAKE_ENV+=		DOXYGEN_ENCODE_PATH_STRIP=${WRKSRC}

pre-patch:
	perl -i -pe 's/\r$$//' ${WRKSRC}/CMakeLists.txt

post-configure:
	find ${WRKSRC} -type f -iname "*.make" -exec \
		perl -pi -e 's/(CXX_DEFINES =).*/$1/' {} \;
@


1.18
log
@PERMIT_* / REGRESS -> TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2013/01/19 10:13:15 brad Exp $
a69 1
USE_LIBTOOL=		Yes
@


1.17
log
@Update for newer FFmpeg API.

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2012/12/29 20:49:17 landry Exp $
a37 3
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
@


1.16
log
@Mark as BROKEN-sparc64 : error: cannot convert 'int*' to 'volatile
_Atomic_word*
It never built there..
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2012/12/16 12:09:17 sthen Exp $
d14 1
a14 1
REVISION-main=		7
d45 9
a53 11
WANTLIB += GL Half Iex IlmImf Imath X11 Xcomposite Xcursor
WANTLIB += Xdamage Xext Xfixes Xi Xinerama Xrandr Xrender
WANTLIB += atk-1.0 avcodec avformat avutil bz2 c cairo
WANTLIB += expat fontconfig freetype gdk-x11-2.0 gdk_pixbuf-2.0
WANTLIB += gio-2.0 glib-2.0 gmodule-2.0 gobject-2.0 gsm gstapp-0.10
WANTLIB += gstbase-0.10 gstreamer-0.10 gstvideo-0.10 gthread-2.0
WANTLIB += gtk-x11-2.0 jasper jpeg m mp3lame ogg orc-0.4 pango-1.0
WANTLIB += pangocairo-1.0 pangoft2-1.0 pixman-1 png pthread pthread-stubs
WANTLIB += schroedinger-1.0 speex stdc++ swscale theoradec theoraenc
WANTLIB += tiff vorbis vorbisenc vpx x264 xcb xcb-render xcb-shm
WANTLIB += xml2 z ${MODPY_WANTLIB}
d66 1
a66 1
			graphics/ffmpeg
@


1.15
log
@set DOXYGEN_ENCODE_PATH_STRIP=${WRKSRC} and regen plist
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2012/12/16 11:34:33 sthen Exp $
d5 1
@


1.14
log
@sync plist; doxygen update
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2012/09/06 12:38:35 ajacoutot Exp $
d15 1
a15 1
REVISION-docs=		0
d95 2
@


1.13
log
@Bump after gstreamer-plugins-base subpackaging change.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2012/05/03 06:35:31 ajacoutot Exp $
d15 1
@


1.12
log
@Update opencv for newer FFmpeg API.

from Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2011/12/05 09:36:32 espie Exp $
d13 1
a13 1
REVISION-main=		6
@


1.11
log
@well, py-numpy is also a BUILD_DEPENDS, as opencv can detect it
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2011/12/04 22:49:22 espie Exp $
d13 1
a13 1
REVISION-main=		5
@


1.10
log
@explicitly disable eigen2 shadow dependency
(2nd bug found with dpb -J !)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2011/11/16 23:28:37 sthen Exp $
d78 2
a79 1
BUILD_DEPENDS=		devel/doxygen
@


1.9
log
@s/ONLY_FOR_ARCH/&S/
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2011/11/15 00:09:31 sthen Exp $
d89 1
@


1.8
log
@Better fix for the build on i386, Brad tracked down the actual problem.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2011/11/14 09:54:45 sthen Exp $
d3 1
a3 1
ONLY_FOR_ARCH=		${GCC4_ARCHS}
@


1.7
log
@partially revert last commit, it broke i386. problem seen by naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2011/11/12 16:49:43 sthen Exp $
d13 1
a13 1
REVISION-main=		4
@


1.6
log
@- remove bogus patch for FFmpeg & unnecessary workarounds for expl(), from Brad
- obey CFLAGS, from Brad
- strip ^M from file being patched, from me
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2011/11/02 09:57:22 jasper Exp $
d13 1
a13 1
REVISION-main=		3
@


1.5
log
@- regen WANTLIB
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2011/09/16 10:02:37 espie Exp $
d92 3
@


1.4
log
@normalize pkgpath
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2011/07/16 22:43:57 espie Exp $
d13 1
a13 1
REVISION-main=		2
d43 4
a46 4
WANTLIB += GL Half Iex IlmImf Imath X11 Xau Xcomposite Xcursor
WANTLIB += Xdamage Xdmcp Xext Xfixes Xi Xinerama Xrandr Xrender
WANTLIB += Xxf86vm atk-1.0 avcodec avformat avutil bz2 c cairo
WANTLIB += drm expat fontconfig freetype gdk-x11-2.0 gdk_pixbuf-2.0
@


1.3
log
@pch don't really work
in fact, it causes an ICE while building the port on amd64,
so patch it out, and bump.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2011/06/24 11:17:05 sthen Exp $
d13 1
a13 1
REVISION-main=		1
@


1.2
log
@Chase ffmpeg dep changes. Mostly from Brad ok dcoppa@@, plus opencv from me.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2011/06/24 09:30:21 jasper Exp $
d13 1
a13 1
REVISION-main=		0
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d13 1
d46 1
a46 1
WANTLIB += drm expat faac fontconfig freetype gdk-x11-2.0 gdk_pixbuf-2.0
@


1.1.1.1
log
@import opencv 2.2.0

The Open Computer Vision Library is a collection of algorithms and sample
code for various computer vision problems.

initial port by me, finished by Andreas Bihlmaier and
Rafael Sadowski (MAINTAINER), ok sthen@@
@
text
@@
