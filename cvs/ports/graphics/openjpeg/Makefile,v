head	1.26;
access;
symbols
	OPENBSD_6_1:1.26.0.2
	OPENBSD_6_1_BASE:1.26
	OPENBSD_6_0:1.22.0.2
	OPENBSD_6_0_BASE:1.22
	OPENBSD_5_9:1.21.0.2
	OPENBSD_5_9_BASE:1.21
	OPENBSD_5_8:1.21.0.4
	OPENBSD_5_8_BASE:1.21
	OPENBSD_5_7:1.19.0.6
	OPENBSD_5_7_BASE:1.19
	OPENBSD_5_6:1.19.0.4
	OPENBSD_5_6_BASE:1.19
	OPENBSD_5_5:1.19.0.2
	OPENBSD_5_5_BASE:1.19
	OPENBSD_5_4:1.17.0.2
	OPENBSD_5_4_BASE:1.17
	OPENBSD_5_3:1.11.0.2
	OPENBSD_5_3_BASE:1.11
	OPENBSD_5_2:1.10.0.2
	OPENBSD_5_2_BASE:1.10
	OPENBSD_5_1_BASE:1.5
	OPENBSD_5_1:1.5.0.10
	OPENBSD_5_0:1.5.0.8
	OPENBSD_5_0_BASE:1.5
	OPENBSD_4_9:1.5.0.6
	OPENBSD_4_9_BASE:1.5
	OPENBSD_4_8:1.5.0.4
	OPENBSD_4_8_BASE:1.5
	OPENBSD_4_7:1.5.0.2
	OPENBSD_4_7_BASE:1.5
	OPENBSD_4_6:1.4.0.8
	OPENBSD_4_6_BASE:1.4
	OPENBSD_4_5:1.4.0.6
	OPENBSD_4_5_BASE:1.4
	OPENBSD_4_4:1.4.0.4
	OPENBSD_4_4_BASE:1.4
	OPENBSD_4_3:1.4.0.2
	OPENBSD_4_3_BASE:1.4
	OPENBSD_4_2:1.2.0.4
	OPENBSD_4_2_BASE:1.2
	OPENBSD_4_1:1.2.0.2
	OPENBSD_4_1_BASE:1.2
	openjpeg_20070207:1.1.1.1
	todd:1.1.1;
locks; strict;
comment	@# @;


1.26
date	2016.11.19.14.28.11;	author sthen;	state Exp;
branches;
next	1.25;
commitid	4d9WtmurStN9ZAR0;

1.25
date	2016.10.27.08.37.51;	author ajacoutot;	state Exp;
branches;
next	1.24;
commitid	HLfaE58PfuvL95ES;

1.24
date	2016.10.26.18.16.49;	author jca;	state Exp;
branches;
next	1.23;
commitid	AqWyKaL3ZRdIQgJQ;

1.23
date	2016.10.01.11.54.15;	author naddy;	state Exp;
branches;
next	1.22;
commitid	VJ09Ih4WMjVIWTmz;

1.22
date	2016.03.09.18.29.10;	author naddy;	state Exp;
branches;
next	1.21;
commitid	EDvzhoInnIZEPAcV;

1.21
date	2015.05.22.11.31.16;	author ajacoutot;	state Exp;
branches;
next	1.20;
commitid	2khjHXfpTaOuNVcx;

1.20
date	2015.04.21.18.24.22;	author sthen;	state Exp;
branches;
next	1.19;
commitid	aorv38MSXkwQIPuw;

1.19
date	2013.12.10.12.26.46;	author sthen;	state Exp;
branches;
next	1.18;

1.18
date	2013.08.07.21.31.59;	author naddy;	state Exp;
branches;
next	1.17;

1.17
date	2013.07.09.20.32.52;	author espie;	state Exp;
branches;
next	1.16;

1.16
date	2013.07.09.20.01.38;	author espie;	state Exp;
branches;
next	1.15;

1.15
date	2013.07.05.06.12.45;	author brad;	state Exp;
branches;
next	1.14;

1.14
date	2013.06.28.12.05.18;	author espie;	state Exp;
branches;
next	1.13;

1.13
date	2013.03.21.08.45.19;	author ajacoutot;	state Exp;
branches;
next	1.12;

1.12
date	2013.03.11.11.10.54;	author espie;	state Exp;
branches;
next	1.11;

1.11
date	2012.09.17.12.31.35;	author jasper;	state Exp;
branches;
next	1.10;

1.10
date	2012.07.16.12.54.33;	author ajacoutot;	state Exp;
branches
	1.10.2.1;
next	1.9;

1.9
date	2012.07.11.08.31.28;	author sthen;	state Exp;
branches;
next	1.8;

1.8
date	2012.07.11.08.30.39;	author sthen;	state Exp;
branches;
next	1.7;

1.7
date	2012.03.30.07.09.26;	author sthen;	state Exp;
branches;
next	1.6;

1.6
date	2012.03.29.15.45.43;	author sthen;	state Exp;
branches;
next	1.5;

1.5
date	2009.07.14.15.35.24;	author sthen;	state Exp;
branches
	1.5.10.1;
next	1.4;

1.4
date	2007.12.03.00.36.44;	author todd;	state Exp;
branches;
next	1.3;

1.3
date	2007.09.15.20.09.42;	author simon;	state Exp;
branches;
next	1.2;

1.2
date	2007.02.17.15.55.08;	author steven;	state Exp;
branches;
next	1.1;

1.1
date	2007.02.08.00.29.22;	author todd;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2007.02.08.00.29.22;	author todd;	state Exp;
branches;
next	;

1.5.10.1
date	2012.07.11.08.58.39;	author sthen;	state Exp;
branches;
next	;

1.10.2.1
date	2012.09.17.12.33.35;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.26
log
@add portroach limit; 2.x is in graphics/openjp2
@
text
@# $OpenBSD: Makefile,v 1.25 2016/10/27 08:37:51 ajacoutot Exp $

COMMENT=		open-source JPEG 2000 codec library

V=			1.5.2
PORTROACH =		limit:^1
DISTNAME=		openjpeg-version.$V
PKGNAME=		openjpeg-$V
DISTFILES=		${DISTNAME}{version.$V}.tar.gz

SHARED_LIBS +=	openjpeg             5.0      # 6.2

CATEGORIES=		graphics

HOMEPAGE=		http://www.openjpeg.org/

MAINTAINER=		Stuart Henderson <sthen@@openbsd.org>

# BSD
PERMIT_PACKAGE_CDROM=	Yes

WANTLIB += c jpeg lcms2 m png pthread tiff z

# not using GH_* because it strips 'v' from version
MASTER_SITES =		https://github.com/uclouvain/openjpeg/archive/

CONFIGURE_STYLE=	gnu
SEPARATE_BUILD=		Yes

AUTOCONF_VERSION=	2.69
AUTOMAKE_VERSION=	1.14
BUILD_DEPENDS=		${MODGNU_AUTOCONF_DEPENDS} \
			${MODGNU_AUTOMAKE_DEPENDS} \
			devel/libtool

LIB_DEPENDS=		graphics/lcms2 \
			graphics/png \
			graphics/tiff

# XXX Yes, really, libtiff by itself won't be detected
LIB_DEPENDS +=		graphics/jpeg
CONFIGURE_ENV += TIFF_LIBS='-L${LOCALBASE}/lib -ltiff -ljpeg' \
	TIFF_CFLAGS='-I${LOCALBASE}/include'

pre-patch:
	perl -i -pe 's/\r$$//; s/\t*$$//;' ${WRKSRC}/libopenjpeg/opj_malloc.h

post-patch:
	cd ${WRKSRC} && env AUTOCONF_VERSION="${AUTOCONF_VERSION}" \
	    AUTOMAKE_VERSION="${AUTOMAKE_VERSION}" ./bootstrap.sh

post-install:
	cd ${PREFIX}/share/doc/ && mv openjpeg-* openjpeg

.include <bsd.port.mk>
@


1.25
log
@Needs devel/libtool to build.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2016/10/26 18:16:49 jca Exp $
d6 1
@


1.24
log
@Update to openjpeg-1.5.2

This doesn't solve all the problems currently affecting openjpeg, but
makes it easier to pick up fixes.  Cheating a bit, as the lib lost two
symbols, but those should never have been included in the library
anyway.

Feedback, tests and ok sthen@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2016/10/01 11:54:15 naddy Exp $
d32 2
a33 1
			${MODGNU_AUTOMAKE_DEPENDS}
@


1.23
log
@The ${PROJECT}.googlecode.com/files/ master sites are no longer
accessible, but the distfiles are still available at an archive URL.
Introduce MASTER_SITE_GOOGLECODE and use it for all affected ports.

ok czarkoff@@ danj@@ sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2016/03/09 18:29:10 naddy Exp $
d5 4
a8 2
DISTNAME=		openjpeg-1.5.1
REVISION=		1
d10 1
a10 1
SHARED_LIBS +=	openjpeg             5.0      # 6.0
d23 2
a24 1
MASTER_SITES=		${MASTER_SITE_GOOGLECODE:=openjpeg/}
d29 5
d45 4
@


1.22
log
@remove LIBM_CHECK for vax
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2015/05/22 11:31:16 ajacoutot Exp $
d21 1
a21 1
MASTER_SITES=		https://openjpeg.googlecode.com/files/
@


1.21
log
@"/usr/local/lib/pkgconfig/" is part of mtree(8).
Packages should not own this dir to prevent its deletion or a warning that it
cannot be removed because it's not empty at pkg_delete(1) time.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2015/04/21 18:24:22 sthen Exp $
a19 2

LIBM_CHECK = lrintf
@


1.20
log
@add some missing pthread to WANTLIB
(using modified portbump, thanks zhuk@@)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2013/12/10 12:26:46 sthen Exp $
d6 1
a6 1
REVISION=		0
@


1.19
log
@Update to OpenJPEG 1.5.1, note that there are still some known security
bugs (as pointed out by jca), but this is a better base from which to update.
Rolls in previous security fixes we had as patches.
Merge PFRAG.shared while there.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2013/08/07 21:31:59 naddy Exp $
d6 1
d19 2
a20 1
WANTLIB += c jpeg lcms2 m png tiff z
@


1.18
log
@move http://code.google.com, *.googlecode.com, and sites.google.com to https
suggested by bentley@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2013/07/09 20:32:52 espie Exp $
d5 1
a5 2
DISTNAME=		openjpeg-1.5.0
REVISION=		6
@


1.17
log
@yes, REALLY.
libtiff wants jpeg for linking.
the first patch wasn't enough, configure still wasn't detecting libtiff
properly on vax.

Now it should, and the lrintf part is being worked on.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2013/07/09 20:01:38 espie Exp $
d22 1
a22 1
MASTER_SITES=		http://openjpeg.googlecode.com/files/
@


1.16
log
@these will build when vax gets the functions
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2013/07/05 06:12:45 brad Exp $
d6 1
a6 1
REVISION=		5
d30 5
@


1.15
log
@change depends to how they were before rev 1.10.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2013/06/28 12:05:18 espie Exp $
d20 1
@


1.14
log
@give it a chance to build on vax
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2013/03/21 08:45:19 ajacoutot Exp $
d6 1
a6 1
REVISION=		4
d27 1
a27 4
			graphics/png

# LIB_DEPENDS do not propagate on non shared architectures
LIB_DEPENDS +=		graphics/jpeg \
@


1.13
log
@USE_LIBTOOL=Yes is the default now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2013/03/11 11:10:54 espie Exp $
d6 1
a6 1
REVISION=		3
d28 4
@


1.12
log
@PERMIT_* / REGRESS -> TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2012/09/17 12:31:35 jasper Exp $
a24 1
USE_LIBTOOL=		Yes
@


1.11
log
@security fix for
CVE-2012-3535 openjpeg: heap-based buffer overflow when decoding jpeg2000 file

ok sthen@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2012/07/16 12:54:33 ajacoutot Exp $
a17 3
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM= Yes
PERMIT_DISTFILES_FTP=	Yes
@


1.10
log
@Regen WANTLIB/DEPENDS.

ok sthen@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2012/07/11 08:31:28 sthen Exp $
d6 1
a6 1
REVISION=		2
@


1.10.2.1
log
@security fix for
CVE-2012-3535 openjpeg: heap-based buffer overflow when decoding jpeg2000 file

ok sthen@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2012/09/17 12:31:35 jasper Exp $
d6 1
a6 1
REVISION=		3
@


1.9
log
@SECURITY fix for CVE-2012-3358, heap buffer overflow when handling a
crafted JPEG2000 file.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2012/07/11 08:30:39 sthen Exp $
d6 1
a6 1
REVISION=		1
d22 1
a22 1
WANTLIB += c jpeg lcms2 m tiff z
d31 1
a31 2
			graphics/png \
			graphics/tiff
@


1.8
log
@libtool changes mean this now links dynamically not statically (which
appears to be correct, or at least what gnu LT does); sync WANTLIB/LIB_DEPENDS
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2012/03/30 07:09:26 sthen Exp $
d6 1
a6 1
REVISION=		0
@


1.7
log
@Add back the diff to not use memalign(), fixing !amd64. Add a proper comment
so it doesn't get lost in future. Build failure pointed out by naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2012/03/29 15:45:43 sthen Exp $
d6 1
d22 1
a22 1
WANTLIB += c m z
d30 1
a30 2
# static linked
BUILD_DEPENDS=		graphics/lcms2 \
@


1.6
log
@update to OpenJPEG 1.5.0, take maintainership. ok todd@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2009/07/14 15:35:24 sthen Exp $
d33 3
@


1.5
log
@- don't strip the library.  ok todd@@
- update to 1.3, fixing LP64 arch in the process. "even better indeed" todd@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2007/12/03 00:36:44 todd Exp $
d5 1
a5 2
DISTNAME=		openjpeg_v1_3
PKGNAME=		openjpeg-1.3
d7 1
a7 1
SHARED_LIBS=		openjpeg	4.0
d13 1
a13 1
MAINTAINER=		Todd T. Fries <todd@@OpenBSD.org>
d21 1
a21 1
MASTER_SITES=		${HOMEPAGE}
d23 1
a23 3
MAKE_ENV=		LIBopenjpeg_VERSION=${LIBopenjpeg_VERSION}
MAKE_FLAGS=		CC="${CC}" COMPILERFLAGS="${CFLAGS}"
WRKDIST=		${WRKDIR}/${DISTNAME:S/openjpeg/OpenJPEG/}
d25 3
a27 1
NO_REGRESS=		Yes
d29 7
a35 2
pre-patch:
	cd ${WRKSRC}/libopenjpeg; perl -i -pe 's/\r$$//' `find . -type f`
@


1.5.10.1
log
@MFC, SECURITY fix for CVE-2012-3358, heap buffer overflow when handling a
crafted JPEG2000 file.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2009/07/14 15:35:24 sthen Exp $
a5 1
REVISION=		0
@


1.4
log
@update to v1.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2007/09/15 20:09:42 simon Exp $
d5 2
a6 2
DISTNAME=		openjpeg_v1_2
PKGNAME=		openjpeg-1.2
d8 1
a8 1
SHARED_LIBS=		openjpeg	3.0
d26 1
a26 1
WRKDIST=		${WRKDIR}/trunk
d29 3
@


1.3
log
@remove surrounding quotes from COMMENT/BROKEN/PERMIT_*
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2007/02/17 15:55:08 steven Exp $
d5 2
a6 2
DISTNAME=		openjpeg_v1_1
PKGNAME=		openjpeg-1.1p1
d8 1
a8 1
SHARED_LIBS=		openjpeg	2.0
d26 1
a26 1
WRKDIST=		${WRKDIR}/OpenJPEG
@


1.2
log
@- build the shared library separately and with -fPIC, unbreaks build on amd64
- do not link with libstdc++ and bump major version
- honor CC and CFLAGS
- add SHA256 sum

feedback and ok naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2007/02/08 00:29:22 todd Exp $
d3 1
a3 1
COMMENT=		"open-source JPEG 2000 codec library"
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.template,v 1.50 2006/11/03 17:03:28 espie Exp $
d6 1
a6 1
PKGNAME=		openjpeg-1.1p0
d8 1
a8 1
SHARED_LIBS=		openjpeg	1.0
d25 1
d27 2
@


1.1.1.1
log
@OpenJPEG 1.1

The OpenJPEG library is an open-source JPEG 2000 codec written
in C language. It has been developed in order to promote the
use of JPEG 2000, the new still-image compression standard
from the Joint Photographic Experts Group (JPEG).
@
text
@@
