head	1.9;
access;
symbols
	OPENBSD_3_1:1.8.0.2
	OPENBSD_3_1_BASE:1.8;
locks; strict;
comment	@# @;


1.9
date	2002.04.26.02.19.04;	author brad;	state dead;
branches;
next	1.8;

1.8
date	2002.03.28.21.49.47;	author brad;	state Exp;
branches;
next	1.7;

1.7
date	2002.03.03.03.52.14;	author brad;	state Exp;
branches;
next	1.6;

1.6
date	2002.02.06.16.44.06;	author brad;	state Exp;
branches;
next	1.5;

1.5
date	2002.02.06.16.40.38;	author brad;	state Exp;
branches;
next	1.4;

1.4
date	2002.01.27.03.09.11;	author brad;	state Exp;
branches;
next	1.3;

1.3
date	2002.01.26.06.31.06;	author brad;	state Exp;
branches;
next	1.2;

1.2
date	2001.11.20.00.22.01;	author brad;	state Exp;
branches;
next	1.1;

1.1
date	2001.11.19.02.40.52;	author brad;	state Exp;
branches;
next	;


desc
@@


1.9
log
@upgrade to png 1.2.2
--
headers have been moved from include/ to include/libpng/.
for the short term sym-links have been created in include/ but will
be removed once all ports have been checked. porters should @@comment out
the sym-links to check ports locally.
@
text
@# makefile for libpng
# Copyright (C) 1995 Guy Eric Schalnat, Group 42, Inc.
# For conditions of distribution and use, see copyright notice in png.h

PREFIX?= /usr/local
LIBDIR=	${PREFIX}/lib
MANDIR= ${PREFIX}/man/cat

SHLIB_MAJOR=	3
SHLIB_MINOR=	0

LIB=	png
SRCS=	png.c pngerror.c pnggccrd.c pngget.c pngmem.c pngpread.c \
	pngread.c pngrio.c pngrtran.c pngrutil.c pngset.c pngtrans.c \
	pngwio.c pngwrite.c pngwtran.c pngwutil.c

HDRS=	png.h pngconf.h

CFLAGS+= -Wall
CPPFLAGS+= -I${.CURDIR} -DPNG_NO_ASSEMBLER_CODE -DPNG_USE_PNGGCCRD
LDADD=	-lz

NOPROFILE= Yes

CLEANFILES+= pngtest.o pngtest

MAN=	libpng.3 libpngpf.3 png.5
DOCS=	ANNOUNCE CHANGES LICENSE README libpng.txt

pngtest.o:	pngtest.c
	${CC} ${CPPFLAGS} ${CFLAGS} -c ${.ALLSRC} -o ${.TARGET}

pngtest:	pngtest.o
	${CC} ${LDFLAGS} ${.ALLSRC} -o ${.TARGET} -L${.OBJDIR} -lpng -lz -lm

test:	pngtest
	cd ${.OBJDIR} && env \
		LD_LIBRARY_PATH="${.OBJDIR}" ${.OBJDIR}/pngtest

beforeinstall:
	if [ ! -d ${DESTDIR}${PREFIX}/include ]; then \
	  ${INSTALL} -d -o root -g wheel ${DESTDIR}${PREFIX}/include; \
	fi
	if [ ! -d ${DESTDIR}${LIBDIR} ]; then \
	  ${INSTALL} -d -o root -g wheel ${DESTDIR}${LIBDIR}; \
	fi
	if [ ! -d ${DESTDIR}${LIBDIR}/debug ]; then \
	  ${INSTALL} -d -o root -g wheel ${DESTDIR}${LIBDIR}/debug; \
	fi
	if [ ! -d ${DESTDIR}${MANDIR}3 ]; then \
	  ${INSTALL} -d -o root -g wheel ${DESTDIR}${MANDIR}3; \
	fi
	if [ ! -d ${DESTDIR}${MANDIR}5 ]; then \
	  ${INSTALL} -d -o root -g wheel ${DESTDIR}${MANDIR}5; \
	fi
	if [ ! -d ${DESTDIR}${PREFIX}/share/doc/png ]; then \
	  ${INSTALL} -d -o root -g wheel ${DESTDIR}${PREFIX}/share/doc/png; \
	fi

afterinstall:
	@@rm -f ${DESTDIR}${LIBDIR}/libpng_pic.a
	@@rm -f ${DESTDIR}${LIBDIR}/debug/libpng.a
	@@rmdir ${DESTDIR}${LIBDIR}/debug 2>/dev/null || true
	${INSTALL} ${INSTALL_COPY} -o ${SHAREOWN} -g ${SHAREGRP} \
		-m ${NONBINMODE} ${HDRS} ${DESTDIR}${PREFIX}/include
	${INSTALL} ${INSTALL_COPY} -o ${SHAREOWN} -g ${SHAREGRP} \
		-m ${NONBINMODE} ${DOCS} ${DESTDIR}${PREFIX}/share/doc/png

.include <bsd.lib.mk>
@


1.8
log
@inter-library dependencies are sooo disgusting but do this to please ELF
systems for now until the broken programs can be fixed properly.
@
text
@@


1.7
log
@add PNG_USE_PNGGCCRD
--
Suggested by author of libpng
@
text
@d21 1
@


1.6
log
@oops, this change was not supposed to go in.
@
text
@d20 1
a20 1
CPPFLAGS+= -I${.CURDIR} -DPNG_NO_ASSEMBLER_CODE
@


1.5
log
@make sure the png port honors CC.
--
Pointed out by: naddy@@
@
text
@d20 1
a20 1
CPPFLAGS+= -I${.CURDIR} -DPNG_NO_ASSEMBLER_CODE -DPNG_USE_PNGGCCRD
@


1.4
log
@reorder source files in alpha order and add missing pnggccrd.c
@
text
@d20 1
a20 1
CPPFLAGS+= -I${.CURDIR} -DPNG_NO_ASSEMBLER_CODE
@


1.3
log
@add workaround for problem when DEBUGLIBS is defined.
--
Problem pointed out by marc@@ awhile ago
@
text
@d13 3
a15 3
SRCS=	png.c pngset.c pngget.c pngrutil.c pngtrans.c pngwutil.c \
	pngread.c pngrio.c pngwio.c pngwrite.c pngrtran.c \
	pngwtran.c pngmem.c pngerror.c pngpread.c
d62 1
a62 1
	rmdir ${DESTDIR}${LIBDIR}/debug 2>/dev/null || true
@


1.2
log
@use various definitions from bsd.own.mk for owner/group/perms
--
Suggested by naddy@@
@
text
@a22 1
DEBUGLIBS= No
d46 3
d61 2
@


1.1
log
@upgrade to png 1.2.0
--
Thanks to naddy@@ for doing a full tree build and finding out that nothing
broke because of this upgrade.
@
text
@d59 4
a62 4
	${INSTALL} ${INSTALL_COPY} -o root -g wheel -m 644 ${HDRS} \
		${DESTDIR}${PREFIX}/include
	${INSTALL} ${INSTALL_COPY} -o root -g wheel -m 644 ${DOCS} \
		${DESTDIR}${PREFIX}/share/doc/png
@

