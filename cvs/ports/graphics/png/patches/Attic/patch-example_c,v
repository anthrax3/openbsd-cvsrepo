head	1.1;
access;
symbols
	OPENBSD_4_5:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2009.06.12.01.59.58;	author william;	state dead;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2009.06.12.01.59.58;	author william;	state Exp;
branches;
next	;


desc
@@


1.1
log
@file patch-example_c was initially added on branch OPENBSD_4_5.
@
text
@@


1.1.2.1
log
@security update to png-1.3.33p0; patches from debian
resolves CVE-2008-5907 and CVE-2009-0040
@
text
@a0 14
$OpenBSD$
--- example.c.orig	Fri Oct 31 09:42:01 2008
+++ example.c	Thu Jun  4 16:26:40 2009
@@@@ -342,6 +342,10 @@@@ void read_png(FILE *fp, unsigned int sig_read)  /* fil
    /* The easiest way to read the image: */
    png_bytep row_pointers[height];
 
+   /* Clear the pointer array */
+   for (row = 0; row < height; row++)
+      row_pointers[row] = NULL;
+
    for (row = 0; row < height; row++)
    {
       row_pointers[row] = png_malloc(png_ptr, png_get_rowbytes(png_ptr,
@

