head	1.2;
access;
symbols
	OPENBSD_4_5:1.1.0.2
	OPENBSD_4_5_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2009.06.04.00.43.22;	author jasper;	state dead;
branches;
next	1.1;

1.1
date	2008.11.05.13.11.14;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.2
log
@- update libexif to 0.6.17
@
text
@$OpenBSD: patch-libexif_exif-data_c,v 1.1 2008/11/05 13:11:14 jasper Exp $

Fix for CVE-2007-6351: Integer overflow.

--- libexif/exif-data.c.orig	Wed Nov  5 14:04:58 2008
+++ libexif/exif-data.c	Wed Nov  5 14:05:25 2008
@@@@ -288,10 +288,10 @@@@ static void
 exif_data_load_data_thumbnail (ExifData *data, const unsigned char *d,
 			       unsigned int ds, ExifLong offset, ExifLong size)
 {
-	if (ds < offset + size) {
+	if ((ds < offset + size) || (offset > ds)) {
 		exif_log (data->priv->log, EXIF_LOG_CODE_DEBUG, "ExifData",
-			  "Bogus thumbnail offset and size: %i < %i + %i.",
-			  (int) ds, (int) offset, (int) size);
+			  "Bogus thumbnail offset (%u) or size (%u).",
+			  offset, size);
 		return;
 	}
 	if (data->data) 
@@@@ -314,7 +314,7 @@@@ if ((i) == ifd) {				\
 }							\
 if (data->ifd[(i)]->count) {				\
 	exif_log (data->priv->log, EXIF_LOG_CODE_DEBUG,	\
-		"ExifData", "Attemt to load IFD "	\
+		"ExifData", "Attempt to load IFD "	\
 		"'%s' multiple times detected. "	\
 		"Skipping...",				\
 		exif_ifd_get_name (i));			\
@


1.1
log
@- fix two security issues, CVE-2007-6351 and CVE-2007-6352.

patches from upstream cvs
@
text
@d1 1
a1 1
$OpenBSD$
@

