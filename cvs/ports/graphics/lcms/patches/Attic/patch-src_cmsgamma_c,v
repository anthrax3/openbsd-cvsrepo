head	1.1;
access;
symbols
	OPENBSD_4_5:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2009.06.20.01.34.27;	author william;	state dead;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2009.06.20.01.34.27;	author william;	state Exp;
branches;
next	;


desc
@@


1.1
log
@file patch-src_cmsgamma_c was initially added on branch OPENBSD_4_5.
@
text
@@


1.1.2.1
log
@SECURITY FIX

Resolves CVE-2009-0581, CVE-2009-0723, and CVE-2009-0733

patch from upstream via debian

ok robert@@
@
text
@a0 17
$OpenBSD$

CVE-2009-0581
CVE-2009-0723    
CVE-2009-0733

--- src/cmsgamma.c.orig	Fri Jul 27 06:00:02 2007
+++ src/cmsgamma.c	Thu Jun 18 23:57:39 2009
@@@@ -114,7 +114,7 @@@@ LPGAMMATABLE LCMSEXPORT cmsAllocGamma(int nEntries)
        LPGAMMATABLE p;
        size_t size;
 
-       if (nEntries > 65530 || nEntries < 0) {
+       if (nEntries > 65530 || nEntries <= 0) {
                 cmsSignalError(LCMS_ERRC_ABORTED, "Couldn't create gammatable of more than 65530 entries");
                 return NULL;
        }
@

