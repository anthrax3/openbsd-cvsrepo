head	1.3;
access;
symbols
	OPENBSD_5_7:1.2.0.2
	OPENBSD_5_7_BASE:1.2;
locks; strict;
comment	@# @;


1.3
date	2015.03.30.07.12.15;	author eric;	state dead;
branches;
next	1.2;
commitid	ldHPbnoi9QSnYLCJ;

1.2
date	2014.11.27.03.23.57;	author brad;	state Exp;
branches;
next	1.1;
commitid	CM0RtDLOGoufFNbg;

1.1
date	2014.11.17.12.50.14;	author eric;	state Exp;
branches;
next	;
commitid	PFP5VoFaKDS76pv8;


desc
@@


1.3
log
@update to cairo 1.14.2

ok ajacoutot@@
@
text
@$OpenBSD: patch-src_cairoint_h,v 1.2 2014/11/27 03:23:57 brad Exp $

http://cgit.freedesktop.org/cairo/commit/?id=99a35dd273f3deb4ae54310f1ed1746bfd9fae70

    CFF: Fix unaligned access

http://cgit.freedesktop.org/cairo/commit/?id=adbeb3d53c6c6e8ddcc63988200da4c5c9627717

    Improve performance of cpu_to_be32 and be32_to_cpu

--- src/cairoint.h.orig	Mon Oct 13 21:46:33 2014
+++ src/cairoint.h	Mon Nov 17 19:57:23 2014
@@@@ -229,7 +229,7 @@@@ be16_to_cpu(uint16_t v)
 static inline uint32_t cairo_const
 cpu_to_be32(uint32_t v)
 {
-    return (cpu_to_be16 (v) << 16) | cpu_to_be16 (v >> 16);
+    return (v >> 24) | ((v >> 8) & 0xff00) | ((v << 8) & 0xff0000) | (v << 24);
 }
 
 static inline uint32_t cairo_const
@@@@ -240,6 +240,32 @@@@ be32_to_cpu(uint32_t v)
 
 #endif
 
+/* Unaligned big endian access
+ */
+
+static inline uint16_t get_unaligned_be16 (const unsigned char *p)
+{
+    return p[0] << 8 | p[1];
+}
+
+static inline uint32_t get_unaligned_be32 (const unsigned char *p)
+{
+    return p[0] << 24 | p[1] << 16 | p[2] << 8 | p[3];
+}
+
+static inline void put_unaligned_be16 (uint16_t v, unsigned char *p)
+{
+    p[0] = (v >> 8) & 0xff;
+    p[1] = v & 0xff;
+}
+
+static inline void put_unaligned_be32 (uint32_t v, unsigned char *p)
+{
+    p[0] = (v >> 24) & 0xff;
+    p[1] = (v >> 16) & 0xff;
+    p[2] = (v >> 8)  & 0xff;
+    p[3] = v & 0xff;
+}
 
 /* The glibc versions of ispace() and isdigit() are slow in UTF-8 locales.
  */
@


1.2
log
@From upstream..

Improve performance of cpu_to_be32 and be32_to_cpu

maintainer timeout.
@
text
@d1 1
a1 1
$OpenBSD: patch-src_cairoint_h,v 1.1 2014/11/17 12:50:14 eric Exp $
@


1.1
log
@update to 1.14.0 + post-release fixes (from Brad)

please ajacoutot@@ landry@@
@
text
@d1 1
a1 1
$OpenBSD$
d7 4
d12 10
a21 1
+++ src/cairoint.h	Fri Oct 31 02:05:05 2014
@

