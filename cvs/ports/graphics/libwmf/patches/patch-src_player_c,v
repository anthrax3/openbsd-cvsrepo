head	1.3;
access;
symbols
	OPENBSD_6_1:1.3.0.8
	OPENBSD_6_1_BASE:1.3
	OPENBSD_6_0:1.3.0.6
	OPENBSD_6_0_BASE:1.3
	OPENBSD_5_9:1.3.0.2
	OPENBSD_5_9_BASE:1.3
	OPENBSD_5_8:1.3.0.4
	OPENBSD_5_8_BASE:1.3
	OPENBSD_5_7:1.2.0.28
	OPENBSD_5_7_BASE:1.2
	OPENBSD_5_6:1.2.0.26
	OPENBSD_5_6_BASE:1.2
	OPENBSD_5_5:1.2.0.24
	OPENBSD_5_5_BASE:1.2
	OPENBSD_5_4:1.2.0.22
	OPENBSD_5_4_BASE:1.2
	OPENBSD_5_3:1.2.0.20
	OPENBSD_5_3_BASE:1.2
	OPENBSD_5_2:1.2.0.18
	OPENBSD_5_2_BASE:1.2
	OPENBSD_5_1_BASE:1.2
	OPENBSD_5_1:1.2.0.16
	OPENBSD_5_0:1.2.0.14
	OPENBSD_5_0_BASE:1.2
	OPENBSD_4_9:1.2.0.12
	OPENBSD_4_9_BASE:1.2
	OPENBSD_4_8:1.2.0.10
	OPENBSD_4_8_BASE:1.2
	OPENBSD_4_7:1.2.0.8
	OPENBSD_4_7_BASE:1.2
	OPENBSD_4_6:1.2.0.6
	OPENBSD_4_6_BASE:1.2
	OPENBSD_4_5:1.2.0.4
	OPENBSD_4_5_BASE:1.2
	OPENBSD_4_4:1.2.0.2
	OPENBSD_4_4_BASE:1.2
	OPENBSD_4_3:1.1.0.12
	OPENBSD_4_3_BASE:1.1
	OPENBSD_4_2:1.1.0.10
	OPENBSD_4_2_BASE:1.1
	OPENBSD_4_1:1.1.0.8
	OPENBSD_4_1_BASE:1.1
	OPENBSD_4_0:1.1.0.6
	OPENBSD_4_0_BASE:1.1
	OPENBSD_3_8:1.1.0.4
	OPENBSD_3_9:1.1.0.2;
locks; strict;
comment	@# @;


1.3
date	2015.03.17.00.13.24;	author sthen;	state Exp;
branches;
next	1.2;
commitid	Lg3uVD4GVhHmlrwo;

1.2
date	2008.05.20.07.23.29;	author jasper;	state Exp;
branches
	1.2.28.1;
next	1.1;

1.1
date	2006.08.12.15.58.44;	author bernd;	state Exp;
branches
	1.1.2.1
	1.1.4.1;
next	;

1.1.2.1
date	2006.08.16.20.26.52;	author sturm;	state Exp;
branches;
next	;

1.1.4.1
date	2006.08.16.20.27.32;	author sturm;	state Exp;
branches;
next	;

1.2.28.1
date	2015.06.26.09.06.01;	author jasper;	state Exp;
branches;
next	;
commitid	QjrXfXEebR9gxr67;


desc
@@


1.3
log
@pull in stdint.h for SIZE_MAX
@
text
@$OpenBSD: patch-src_player_c,v 1.2 2008/05/20 07:23:29 jasper Exp $

Security fix for CVE-2006-3376. Diff from Ubuntu. (fixed by naddy@@)

--- src/player.c.orig	Tue Dec 10 19:30:26 2002
+++ src/player.c	Tue Mar 17 00:12:11 2015
@@@@ -22,6 +22,7 @@@@
 #endif
 
 #include <stdio.h>
+#include <stdint.h>
 #include <stdlib.h>
 #include <string.h>
 #include <math.h>
@@@@ -130,6 +131,13 @@@@ wmf_error_t wmf_scan (wmfAPI* API,unsigned long flags,
 		{	WMF_DEBUG (API,"bailing...");
 			return (API->err);
 		}
+	}
+
+	if (MAX_REC_SIZE(API) > SIZE_MAX / 2)
+	{
+		API->err = wmf_E_InsMem;
+		WMF_DEBUG (API,"bailing...");
+		return (API->err);
 	}
 
 /*	P->Parameters = (unsigned char*) wmf_malloc (API,(MAX_REC_SIZE(API)-3) * 2 * sizeof (unsigned char));
@


1.2
log
@- use expat instead of libxml and adjust WANTLIB accordingly
- add license marker
- set CONFIGURE_STYLE to gnu
- regen patch while here

from brad@@
@
text
@d1 1
a1 1
$OpenBSD: patch-src_player_c,v 1.1 2006/08/12 15:58:44 bernd Exp $
d5 13
a17 3
--- src/player.c.orig	Tue Dec 10 20:30:26 2002
+++ src/player.c	Tue May 20 09:19:22 2008
@@@@ -132,6 +132,13 @@@@ wmf_error_t wmf_scan (wmfAPI* API,unsigned long flags,
d19 2
a20 2
 	}
 
d26 2
a27 2
+	}
+
a28 2
  */	P->Parameters = (unsigned char*) wmf_malloc (API,(MAX_REC_SIZE(API)  ) * 2 * sizeof (unsigned char));
 
@


1.2.28.1
log
@- security fixes for CVE-2015-0848, CVE-2015-4588, CVE-2015-4695, CVE-2015-4696
* patches via redhat/debian

maintainer timed-out
@
text
@d1 1
a1 1
$OpenBSD: patch-src_player_c,v 1.3 2015/03/17 00:13:24 sthen Exp $
d5 5
a9 4
--- src/player.c.orig	Tue Dec 10 19:30:26 2002
+++ src/player.c	Tue Mar 17 00:12:11 2015
@@@@ -22,6 +22,7 @@@@
 #endif
a10 11
 #include <stdio.h>
+#include <stdint.h>
 #include <stdlib.h>
 #include <string.h>
 #include <math.h>
@@@@ -130,6 +131,13 @@@@ wmf_error_t wmf_scan (wmfAPI* API,unsigned long flags,
 		{	WMF_DEBUG (API,"bailing...");
 			return (API->err);
 		}
+	}
+
d16 4
a19 1
 	}
a20 1
 /*	P->Parameters = (unsigned char*) wmf_malloc (API,(MAX_REC_SIZE(API)-3) * 2 * sizeof (unsigned char));
@


1.1
log
@Security fix for CVE-2006-3376. (http://secunia.com/advisories/20921/)

help & ok naddy@@
@
text
@d1 1
a1 1
$OpenBSD$
d6 2
a7 4
+++ src/player.c	Thu Aug 10 19:14:09 2006
@@@@ -130,6 +131,13 @@@@ wmf_error_t wmf_scan (wmfAPI* API,unsign
 		{	WMF_DEBUG (API,"bailing...");
 			return (API->err);
d9 2
a10 2
+	}
+
d16 4
a19 1
 	}
a20 1
 /*	P->Parameters = (unsigned char*) wmf_malloc (API,(MAX_REC_SIZE(API)-3) * 2 * sizeof (unsigned char));
@


1.1.4.1
log
@MFC:
Security fix for CVE-2006-3376. (http://secunia.com/advisories/20921/)
@
text
@d1 1
a1 1
$OpenBSD: patch-src_player_c,v 1.1 2006/08/12 15:58:44 bernd Exp $
@


1.1.2.1
log
@MFC:
Security fix for CVE-2006-3376. (http://secunia.com/advisories/20921/)
@
text
@d1 1
a1 1
$OpenBSD: patch-src_player_c,v 1.1 2006/08/12 15:58:44 bernd Exp $
@

