head	1.1;
access;
symbols
	OPENBSD_5_6:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2014.09.18.14.58.27;	author jasper;	state dead;
branches
	1.1.2.1;
next	;
commitid	sgVygH4QElP9fKWA;

1.1.2.1
date	2014.09.18.14.58.27;	author jasper;	state Exp;
branches;
next	;
commitid	sgVygH4QElP9fKWA;


desc
@@


1.1
log
@file patch-PIL_Jpeg2KImagePlugin_py was initially added on branch OPENBSD_5_6.
@
text
@@


1.1.2.1
log
@Security fixes for CVE-2014-3589 and CVE-2014-3598
@
text
@a0 17
$OpenBSD$

Security fix for CVE-2014-3598
https://github.com/python-pillow/Pillow/commit/347a1d8d956f9e64af4463ee25311b60cdd5657d

--- PIL/Jpeg2KImagePlugin.py.orig	Thu Sep 18 16:56:15 2014
+++ PIL/Jpeg2KImagePlugin.py	Thu Sep 18 16:56:36 2014
@@@@ -65,6 +65,9 @@@@ def _parse_jp2_header(fp):
         else:
             hlen = 8
 
+        if lbox < hlen:
+            raise SyntaxError('Invalid JP2 header length')
+
         if tbox == b'jp2h':
             header = fp.read(lbox - hlen)
             break
@

