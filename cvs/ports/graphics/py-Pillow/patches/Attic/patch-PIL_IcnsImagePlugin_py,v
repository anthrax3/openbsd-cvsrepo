head	1.1;
access;
symbols
	OPENBSD_5_6:1.1.0.4
	OPENBSD_5_5:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2014.09.01.13.36.04;	author jasper;	state dead;
branches
	1.1.2.1
	1.1.4.1;
next	;
commitid	ta878vAgqp10eOXE;

1.1.2.1
date	2014.09.01.13.36.04;	author jasper;	state Exp;
branches;
next	;
commitid	ta878vAgqp10eOXE;

1.1.4.1
date	2014.09.18.14.58.27;	author jasper;	state Exp;
branches;
next	;
commitid	sgVygH4QElP9fKWA;


desc
@@


1.1
log
@file patch-PIL_IcnsImagePlugin_py was initially added on branch OPENBSD_5_5.
@
text
@@


1.1.4.1
log
@Security fixes for CVE-2014-3589 and CVE-2014-3598
@
text
@a0 16
$OpenBSD: patch-PIL_IcnsImagePlugin_py,v 1.1.2.1 2014/09/01 13:36:04 jasper Exp $

Security fix for CVE-2014-3589,
https://github.com/python-pillow/Pillow/commit/205e056f8f9b06ed7b925cf8aa0874bc4aaf8a7d

--- PIL/IcnsImagePlugin.py.orig	Sun Mar 30 07:30:28 2014
+++ PIL/IcnsImagePlugin.py	Thu Sep 18 16:53:07 2014
@@@@ -179,6 +179,8 @@@@ class IcnsFile:
         i = HEADERSIZE
         while i < filesize:
             sig, blocksize = nextheader(fobj)
+            if blocksize <= 0:
+                raise SyntaxError('invalid block header')
             i = i + HEADERSIZE
             blocksize = blocksize - HEADERSIZE
             dct[sig] = (i, blocksize)
@


1.1.2.1
log
@Security fix for CVE-2014-3589
@
text
@a0 16
$OpenBSD$

Security fix for CVE-2014-3589,
https://github.com/python-pillow/Pillow/commit/205e056f8f9b06ed7b925cf8aa0874bc4aaf8a7d

--- PIL/IcnsImagePlugin.py.orig	Mon Sep  1 15:30:32 2014
+++ PIL/IcnsImagePlugin.py	Mon Sep  1 15:31:17 2014
@@@@ -115,6 +115,8 @@@@ class IcnsFile:
         i = HEADERSIZE
         while i < filesize:
             sig, blocksize = nextheader(fobj)
+            if blocksize <= 0:
+                raise SyntaxError('invalid block header')
             i = i + HEADERSIZE
             blocksize = blocksize - HEADERSIZE
             dct[sig] = (i, blocksize)
@

