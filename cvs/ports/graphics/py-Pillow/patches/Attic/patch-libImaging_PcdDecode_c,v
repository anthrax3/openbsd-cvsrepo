head	1.2;
access;
symbols
	OPENBSD_5_8:1.2.0.2
	OPENBSD_5_9:1.1.0.2
	OPENBSD_5_9_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2016.03.01.01.02.30;	author sthen;	state dead;
branches
	1.2.2.1;
next	1.1;
commitid	oCeT9c3g5YISJeBe;

1.1
date	2016.02.02.23.08.40;	author sthen;	state Exp;
branches;
next	;
commitid	siZVdF6ZrFLbssuR;

1.2.2.1
date	2016.03.11.09.17.30;	author jasper;	state Exp;
branches;
next	;
commitid	AOLoj7UCCNH79ehS;


desc
@@


1.2
log
@update to py-Pillow 3.1.1
@
text
@$OpenBSD: patch-libImaging_PcdDecode_c,v 1.1 2016/02/02 23:08:40 sthen Exp $

From ae453aa18b66af54e7ff716f4ccb33adca60afd4 Mon Sep 17 00:00:00 2001
From: wiredfool <eric-github@@soroos.net>
Date: Tue, 2 Feb 2016 05:46:26 -0800
Subject: [PATCH] PCD decoder overruns the shuffle buffer, Fixes #568

--- libImaging/PcdDecode.c.orig	Tue Feb  2 23:05:01 2016
+++ libImaging/PcdDecode.c	Tue Feb  2 23:05:20 2016
@@@@ -47,7 +47,7 @@@@ ImagingPcdDecode(Imaging im, ImagingCodecState state, 
 	    out[0] = ptr[x];
 	    out[1] = ptr[(x+4*state->xsize)/2];
 	    out[2] = ptr[(x+5*state->xsize)/2];
-	    out += 4;
+	    out += 3;
 	}
 
 	state->shuffle((UINT8*) im->image[state->y],
@@@@ -62,7 +62,7 @@@@ ImagingPcdDecode(Imaging im, ImagingCodecState state, 
 	    out[0] = ptr[x+state->xsize];
 	    out[1] = ptr[(x+4*state->xsize)/2];
 	    out[2] = ptr[(x+5*state->xsize)/2];
-	    out += 4;
+	    out += 3;
 	}
 
 	state->shuffle((UINT8*) im->image[state->y],
@


1.2.2.1
log
@Add upstream patch to py-Pillow, fixing a buffer overflow in PcdDecode.c,
where the decoder writes assuming 4 bytes per pixel into a 3 byte per pixel
wide buffer, allowing writing 768 bytes off the end of the buffer. This
overwrites objects in Python's stack, leading to a crash.
https://github.com/python-pillow/Pillow/pull/1706, CVE-2016-2533
@
text
@d1 1
a1 1
$OpenBSD$
d8 2
a9 2
--- libImaging/PcdDecode.c.orig	Fri Mar 11 10:15:25 2016
+++ libImaging/PcdDecode.c	Fri Mar 11 10:15:38 2016
@


1.1
log
@Add upstream patch to py-Pillow, fixing a buffer overflow in PcdDecode.c,
where the decoder writes assuming 4 bytes per pixel into a 3 byte per pixel
wide buffer, allowing writing 768 bytes off the end of the buffer. This
overwrites objects in Python's stack, leading to a crash.
https://github.com/python-pillow/Pillow/pull/1706

(There's also a newer upstream release but that will need additional
checking before it can go in).
@
text
@d1 1
a1 1
$OpenBSD$
@

