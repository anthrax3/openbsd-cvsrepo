head	1.8;
access;
symbols
	OPENBSD_5_4:1.5.0.4
	OPENBSD_5_4_BASE:1.5
	OPENBSD_5_3:1.5.0.2
	OPENBSD_5_3_BASE:1.5
	OPENBSD_5_2:1.4.0.2
	OPENBSD_5_2_BASE:1.4
	OPENBSD_5_1_BASE:1.3
	OPENBSD_5_1:1.3.0.2
	OPENBSD_5_0:1.2.0.4
	OPENBSD_5_0_BASE:1.2
	OPENBSD_4_9:1.2.0.2
	OPENBSD_4_9_BASE:1.2
	OPENBSD_4_8:1.1.1.1.0.2
	OPENBSD_4_8_BASE:1.1.1.1
	ajacoutot_20100322:1.1.1.1
	ajacoutot:1.1.1;
locks; strict;
comment	@# @;


1.8
date	2013.09.27.08.40.58;	author ajacoutot;	state dead;
branches;
next	1.7;

1.7
date	2013.09.26.08.50.48;	author ajacoutot;	state Exp;
branches;
next	1.6;

1.6
date	2013.09.24.09.19.37;	author ajacoutot;	state Exp;
branches;
next	1.5;

1.5
date	2012.09.30.07.19.18;	author ajacoutot;	state Exp;
branches;
next	1.4;

1.4
date	2012.03.29.06.42.00;	author ajacoutot;	state Exp;
branches;
next	1.3;

1.3
date	2011.09.22.15.28.31;	author ajacoutot;	state Exp;
branches;
next	1.2;

1.2
date	2010.10.22.06.41.15;	author ajacoutot;	state Exp;
branches;
next	1.1;

1.1
date	2010.03.22.22.33.15;	author ajacoutot;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2010.03.22.22.33.15;	author ajacoutot;	state Exp;
branches;
next	;


desc
@@


1.8
log
@Much easier to just patch the vala file.
@
text
@$OpenBSD: patch-src_simple-scan_c,v 1.7 2013/09/26 08:50:48 ajacoutot Exp $
--- src/simple-scan.c.orig	Thu Sep 26 10:29:05 2013
+++ src/simple-scan.c	Thu Sep 26 10:38:12 2013
@@@@ -15,7 +15,9 @@@@
 #include <glib.h>
 #include <glib-object.h>
 #include <gtk/gtk.h>
+#ifndef __OpenBSD__
 #include <gudev/gudev.h>
+#endif
 #include <stdlib.h>
 #include <string.h>
 #include <stdio.h>
@@@@ -158,7 +160,9 @@@@ struct _SimpleScanClass {
 struct _SimpleScanPrivate {
 	ScanDevice* default_device;
 	gboolean have_devices;
+#ifndef __OpenBSD__
 	GUdevClient* udev_client;
+#endif
 	UserInterface* ui;
 	Scanner* scanner;
 	Book* book;
@@@@ -332,8 +336,10 @@@@ static void simple_scan_scanner_failed_cb (SimpleScan*
 static void _simple_scan_scanner_failed_cb_scanner_scan_failed (Scanner* _sender, gint error_code, const gchar* error_string, gpointer self);
 static void simple_scan_scanner_scanning_changed_cb (SimpleScan* self, Scanner* scanner);
 static void _simple_scan_scanner_scanning_changed_cb_scanner_scanning_changed (Scanner* _sender, gpointer self);
+#ifndef __OpenBSD__
 static void simple_scan_on_uevent (SimpleScan* self, GUdevClient* client, const gchar* action, GUdevDevice* device);
 static void _simple_scan_on_uevent_g_udev_client_uevent (GUdevClient* _sender, const gchar* action, GUdevDevice* device, gpointer self);
+#endif
 void user_interface_set_scan_devices (UserInterface* self, GList* devices);
 void user_interface_set_selected_device (UserInterface* self, const gchar* device);
 static void _scan_device_unref0_ (gpointer var);
@@@@ -521,11 +527,13 @@@@ static void _simple_scan_scanner_scanning_changed_cb_s
 }
 
 
+#ifndef __OpenBSD__
 static void _simple_scan_on_uevent_g_udev_client_uevent (GUdevClient* _sender, const gchar* action, GUdevDevice* device, gpointer self) {
 #line 67 "/home/bob/bzr/simple-scan/trunk/src/simple-scan.vala"
 	simple_scan_on_uevent (self, _sender, action, device);
 #line 528 "simple-scan.c"
 }
+#endif
 
 
 static void _scan_device_unref0_ (gpointer var) {
@@@@ -569,8 +577,10 @@@@ static void simple_scan_real_startup (GApplication* ba
 	gint _subsystems_size_;
 	gchar** _tmp18_;
 	gint _tmp18__length1;
+#ifndef __OpenBSD__
 	GUdevClient* _tmp19_;
 	GUdevClient* _tmp20_;
+#endif
 	ScanDevice* _tmp21_;
 #line 44 "/home/bob/bzr/simple-scan/trunk/src/simple-scan.vala"
 	self = (SimpleScan*) base;
@@@@ -662,6 +672,7 @@@@ static void simple_scan_real_startup (GApplication* ba
 	_tmp18_ = subsystems;
 #line 66 "/home/bob/bzr/simple-scan/trunk/src/simple-scan.vala"
 	_tmp18__length1 = subsystems_length1;
+#ifndef __OpenBSD__
 #line 66 "/home/bob/bzr/simple-scan/trunk/src/simple-scan.vala"
 	_tmp19_ = g_udev_client_new (_tmp18_);
 #line 66 "/home/bob/bzr/simple-scan/trunk/src/simple-scan.vala"
@@@@ -672,6 +683,7 @@@@ static void simple_scan_real_startup (GApplication* ba
 	_tmp20_ = self->priv->udev_client;
 #line 67 "/home/bob/bzr/simple-scan/trunk/src/simple-scan.vala"
 	g_signal_connect_object (_tmp20_, "uevent", (GCallback) _simple_scan_on_uevent_g_udev_client_uevent, self, 0);
+#endif
 #line 69 "/home/bob/bzr/simple-scan/trunk/src/simple-scan.vala"
 	_tmp21_ = self->priv->default_device;
 #line 69 "/home/bob/bzr/simple-scan/trunk/src/simple-scan.vala"
@@@@ -752,10 +764,12 @@@@ static void simple_scan_real_shutdown (GApplication* b
 	_user_interface_unref0 (self->priv->ui);
 #line 90 "/home/bob/bzr/simple-scan/trunk/src/simple-scan.vala"
 	self->priv->ui = NULL;
+#ifndef __OpenBSD__
 #line 91 "/home/bob/bzr/simple-scan/trunk/src/simple-scan.vala"
 	_g_object_unref0 (self->priv->udev_client);
 #line 91 "/home/bob/bzr/simple-scan/trunk/src/simple-scan.vala"
 	self->priv->udev_client = NULL;
+#endif
 #line 92 "/home/bob/bzr/simple-scan/trunk/src/simple-scan.vala"
 	_tmp0_ = self->priv->scanner;
 #line 92 "/home/bob/bzr/simple-scan/trunk/src/simple-scan.vala"
@@@@ -2596,6 +2610,7 @@@@ static void simple_scan_log_cb (const gchar* log_domai
 }
 
 
+#ifndef __OpenBSD__
 static void simple_scan_on_uevent (SimpleScan* self, GUdevClient* client, const gchar* action, GUdevDevice* device) {
 	Scanner* _tmp0_;
 #line 453 "/home/bob/bzr/simple-scan/trunk/src/simple-scan.vala"
@@@@ -2612,6 +2627,7 @@@@ static void simple_scan_on_uevent (SimpleScan* self, G
 	scanner_redetect (_tmp0_);
 #line 2613 "simple-scan.c"
 }
+#endif
 
 
 static glong string_strnlen (gchar* str, glong maxlen) {
@@@@ -3763,8 +3779,10 @@@@ static void simple_scan_finalize (GObject* obj) {
 	self = G_TYPE_CHECK_INSTANCE_CAST (obj, TYPE_SIMPLE_SCAN, SimpleScan);
 #line 32 "/home/bob/bzr/simple-scan/trunk/src/simple-scan.vala"
 	_scan_device_unref0 (self->priv->default_device);
+#ifndef __OpenBSD__
 #line 34 "/home/bob/bzr/simple-scan/trunk/src/simple-scan.vala"
 	_g_object_unref0 (self->priv->udev_client);
+#endif
 #line 35 "/home/bob/bzr/simple-scan/trunk/src/simple-scan.vala"
 	_user_interface_unref0 (self->priv->ui);
 #line 36 "/home/bob/bzr/simple-scan/trunk/src/simple-scan.vala"
@


1.7
log
@Update to simple-scan-3.10.0.
@
text
@d1 1
a1 1
$OpenBSD$
@


1.6
log
@Update to simple-scan-3.8.0.
@
text
@d1 3
a3 6
$OpenBSD: patch-src_simple-scan_c,v 1.5 2012/09/30 07:19:18 ajacoutot Exp $

No gudev under OpenBSD.

--- src/simple-scan.c.orig	Thu Mar 21 04:33:34 2013
+++ src/simple-scan.c	Tue Sep 24 10:43:42 2013
d35 1
a35 1
@@@@ -486,9 +492,11 @@@@ static void _simple_scan_scanner_scanning_changed_cb_s
d41 1
d43 1
d49 1
a49 1
@@@@ -527,8 +535,10 @@@@ static void simple_scan_real_startup (GApplication* ba
d58 1
d60 1
a60 3
 	G_APPLICATION_CLASS (simple_scan_parent_class)->startup ((GApplication*) G_TYPE_CHECK_INSTANCE_CAST (self, GTK_TYPE_APPLICATION, GtkApplication));
@@@@ -575,11 +585,13 @@@@ static void simple_scan_real_startup (GApplication* ba
 	_subsystems_size_ = subsystems_length1;
d62 1
d65 1
d67 2
a68 2
 	_g_object_unref0 (self->priv->udev_client);
 	self->priv->udev_client = _tmp19_;
d70 1
d73 1
d75 2
a76 4
 	if (_tmp21_ != NULL) {
 		GList* device_list;
@@@@ -629,8 +641,10 @@@@ static void simple_scan_real_shutdown (GApplication* b
 	self->priv->book = NULL;
d78 1
d81 1
d83 1
d86 1
d88 2
a89 3
 	scanner_free (_tmp0_);
 }
@@@@ -1742,6 +1756,7 @@@@ static void simple_scan_log_cb (const gchar* log_domai
d96 2
a97 3
 	g_return_if_fail (self != NULL);
@@@@ -1751,6 +1766,7 @@@@ static void simple_scan_on_uevent (SimpleScan* self, G
 	_tmp0_ = self->priv->scanner;
d99 1
d105 1
a105 12
@@@@ -2373,7 +2389,9 @@@@ gint simple_scan_main (gchar** args, int args_length1)
 		const gchar* _tmp37_;
 		gchar* _tmp38_;
 		_tmp30_ = scan_device_new ();
+#ifndef __OpenBSD__
 		_scan_device_unref0 (device);
+#endif
 		device = _tmp30_;
 		_tmp31_ = device;
 		_tmp32_ = args;
@@@@ -2450,7 +2468,9 @@@@ static void simple_scan_finalize (GObject* obj) {
 	SimpleScan * self;
d107 1
d110 1
d113 1
d115 1
a115 2
 	_scanner_unref0 (self->priv->scanner);
 	_book_unref0 (self->priv->book);
@


1.5
log
@Update to simple-scan-3.6.0.
@
text
@d1 1
a1 1
$OpenBSD: patch-src_simple-scan_c,v 1.4 2012/03/29 06:42:00 ajacoutot Exp $
d5 2
a6 2
--- src/simple-scan.c.orig	Tue Sep 25 05:11:56 2012
+++ src/simple-scan.c	Sun Sep 30 09:15:20 2012
d17 1
a17 1
@@@@ -159,7 +161,9 @@@@ struct _SimpleScanClass {
d27 1
a27 1
@@@@ -331,8 +335,10 @@@@ static void simple_scan_scanner_failed_cb (SimpleScan*
d38 1
a38 1
@@@@ -485,9 +491,11 @@@@ static void _simple_scan_scanner_scanning_changed_cb_s
d50 1
a50 1
@@@@ -526,8 +534,10 @@@@ static void simple_scan_real_startup (GApplication* ba
d61 1
a61 1
@@@@ -574,11 +584,13 @@@@ static void simple_scan_real_startup (GApplication* ba
d75 1
a75 1
@@@@ -628,8 +640,10 @@@@ static void simple_scan_real_shutdown (GApplication* b
d86 1
a86 1
@@@@ -1741,6 +1755,7 @@@@ static void simple_scan_log_cb (const gchar* log_domai
d94 1
a94 1
@@@@ -1750,6 +1765,7 @@@@ static void simple_scan_on_uevent (SimpleScan* self, G
d102 1
a102 1
@@@@ -2372,7 +2388,9 @@@@ gint simple_scan_main (gchar** args, int args_length1)
d112 1
a112 1
@@@@ -2449,7 +2467,9 @@@@ static void simple_scan_finalize (GObject* obj) {
@


1.4
log
@Update to simple-scan-3.3.92.
@
text
@d1 1
a1 1
$OpenBSD: patch-src_simple-scan_c,v 1.3 2011/09/22 15:28:31 ajacoutot Exp $
d5 3
a7 4
--- src/simple-scan.c.orig	Sat Mar 17 02:30:58 2012
+++ src/simple-scan.c	Fri Mar 23 22:11:44 2012
@@@@ -14,7 +14,9 @@@@
 
d10 1
d17 2
a18 2
@@@@ -164,7 +166,9 @@@@ struct _ApplicationClass {
 struct _ApplicationPrivate {
d24 1
a24 1
 	SimpleScan* ui;
d27 4
a30 4
@@@@ -347,8 +351,10 @@@@ static void application_scanner_failed_cb (Application
 static void _application_scanner_failed_cb_scanner_scan_failed (Scanner* _sender, gint error_code, const gchar* error_string, gpointer self);
 static void application_scanner_scanning_changed_cb (Application* self, Scanner* scanner);
 static void _application_scanner_scanning_changed_cb_scanner_scanning_changed (Scanner* _sender, gpointer self);
d32 2
a33 2
 static void application_on_uevent (Application* self, GUdevClient* client, const gchar* action, GUdevDevice* device);
 static void _application_on_uevent_g_udev_client_uevent (GUdevClient* _sender, const gchar* action, GUdevDevice* device, gpointer self);
d35 2
a36 2
 void simple_scan_set_scan_devices (SimpleScan* self, GList* devices);
 void simple_scan_set_selected_device (SimpleScan* self, const gchar* device);
d38 1
a38 1
@@@@ -485,9 +491,11 @@@@ static void _application_scanner_scanning_changed_cb_s
d43 2
a44 2
 static void _application_on_uevent_g_udev_client_uevent (GUdevClient* _sender, const gchar* action, GUdevDevice* device, gpointer self) {
 	application_on_uevent (self, _sender, action, device);
d50 1
a50 1
@@@@ -529,8 +537,10 @@@@ Application* application_construct (GType object_type,
d52 2
a53 2
 	gchar** _tmp21_;
 	gint _tmp21__length1;
d55 2
a56 2
 	GUdevClient* _tmp22_;
 	GUdevClient* _tmp23_;
d58 4
a61 4
 	ScanDevice* _tmp24_;
 	self = (Application*) g_type_create_instance (object_type);
 	_tmp0_ = device;
@@@@ -582,11 +592,13 @@@@ Application* application_construct (GType object_type,
d63 2
a64 2
 	_tmp21_ = subsystems;
 	_tmp21__length1 = subsystems_length1;
d66 1
a66 1
 	_tmp22_ = g_udev_client_new (_tmp21_);
d68 3
a70 3
 	self->priv->udev_client = _tmp22_;
 	_tmp23_ = self->priv->udev_client;
 	g_signal_connect (_tmp23_, "uevent", (GCallback) _application_on_uevent_g_udev_client_uevent, self);
d72 2
a73 2
 	_tmp24_ = self->priv->default_device;
 	if (_tmp24_ != NULL) {
d75 1
a75 2
@@@@ -1645,8 +1657,10 @@@@ static void application_quit_cb (Application* self, Si
 	_book_unref0 (self->priv->book);
d77 2
a78 1
 	ui = NULL;
d85 2
a86 2
 	gtk_main_quit ();
@@@@ -1766,6 +1780,7 @@@@ static void application_log_cb (const gchar* log_domai
d91 1
a91 1
 static void application_on_uevent (Application* self, GUdevClient* client, const gchar* action, GUdevDevice* device) {
d94 1
a94 1
@@@@ -1775,6 +1790,7 @@@@ static void application_on_uevent (Application* self, 
d102 13
a114 3
@@@@ -2582,7 +2598,9 @@@@ static void application_finalize (Application* obj) {
 	Application * self;
 	self = APPLICATION (obj);
d119 1
a119 1
 	_simple_scan_unref0 (self->priv->ui);
@


1.3
log
@Update to simple-scan-3.1.91, only version to support gtk+3.
@
text
@d1 1
a1 1
$OpenBSD: patch-src_simple-scan_c,v 1.2 2010/10/22 06:41:15 ajacoutot Exp $
d5 2
a6 2
--- src/simple-scan.c.orig	Mon Sep 12 05:29:13 2011
+++ src/simple-scan.c	Thu Sep 22 17:05:09 2011
d17 1
a17 1
@@@@ -163,7 +165,9 @@@@ struct _ApplicationClass {
d27 1
a27 1
@@@@ -346,8 +350,10 @@@@ static void application_scanner_failed_cb (Application
d38 1
a38 1
@@@@ -484,9 +490,11 @@@@ static void _application_scanner_scanning_changed_cb_s
d50 1
a50 1
@@@@ -528,8 +536,10 @@@@ Application* application_construct (GType object_type,
d61 1
a61 1
@@@@ -581,11 +591,13 @@@@ Application* application_construct (GType object_type,
d75 1
a75 1
@@@@ -1419,8 +1431,10 @@@@ static void application_quit_cb (Application* self, Si
d86 1
a86 1
@@@@ -1540,6 +1554,7 @@@@ static void application_log_cb (const gchar* log_domai
d94 1
a94 1
@@@@ -1549,6 +1564,7 @@@@ static void application_on_uevent (Application* self, 
d102 1
a102 1
@@@@ -2356,7 +2372,9 @@@@ static void application_finalize (Application* obj) {
@


1.2
log
@Update to simple-scan-2.32.0.1.
@
text
@d1 1
a1 1
$OpenBSD: patch-src_simple-scan_c,v 1.1.1.1 2010/03/22 22:33:15 ajacoutot Exp $
d5 2
a6 2
--- src/simple-scan.c.orig	Tue Aug 24 09:22:59 2010
+++ src/simple-scan.c	Fri Oct 22 07:57:34 2010
d8 3
a10 3
 #include <glib/gi18n.h>
 #include <gtk/gtk.h>
 #include <unistd.h>
d14 26
a39 1
 #include <dbus/dbus-glib.h>
a40 4
 #include <sane/sane.h> // For SANE_STATUS_CANCELLED
@@@@ -28,7 +30,9 @@@@ static ScanDevice *default_device = NULL;
 
 static gboolean have_devices = FALSE;
d43 3
a45 1
 static GUdevClient *udev_client;
a47 1
 static SimpleScan *ui;
d49 38
a86 11
@@@@ -404,7 +408,9 @@@@ quit_cb (SimpleScan *ui)
 {
     g_object_unref (book);
     g_object_unref (ui);
+#ifndef __OpenBSD__
     g_object_unref (udev_client);
+#endif
     scanner_free (scanner);
     gtk_main_quit ();
 }
@@@@ -541,17 +547,21 @@@@ get_options (int argc, char **argv)
d91 6
a96 4
 static void
 on_uevent (GUdevClient *client, const gchar *action, GUdevDevice *device)
 {
     scanner_redetect (scanner);
d101 11
a111 20
 int
 main (int argc, char **argv)
 {
+#ifndef __OpenBSD__
     const char *udev_subsystems[] = { "usb", NULL };
+#endif
     gchar *path;
 
     g_thread_init (NULL);
@@@@ -594,8 +604,10 @@@@ main (int argc, char **argv)
     g_signal_connect (G_OBJECT (scanner), "scan-failed", G_CALLBACK (scanner_failed_cb), NULL);
     g_signal_connect (G_OBJECT (scanner), "scanning-changed", G_CALLBACK (scanner_scanning_changed_cb), NULL);
 
+#ifndef __OpenBSD__
     udev_client = g_udev_client_new (udev_subsystems);
     g_signal_connect (udev_client, "uevent", G_CALLBACK (on_uevent), NULL);
+#endif
 
     if (default_device) {
         GList device_list;
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
$OpenBSD$
d5 2
a6 2
--- src/simple-scan.c.orig	Sat Mar 13 09:34:47 2010
+++ src/simple-scan.c	Sat Mar 13 09:36:03 2010
d14 1
d17 1
d19 19
a37 1
@@@@ -493,17 +495,21 @@@@ get_options (int argc, char **argv)
d49 1
a53 1
     GUdevClient *udev_client;
d59 1
a59 1
@@@@ -547,8 +553,10 @@@@ main (int argc, char **argv)
d68 2
a69 2
     if (default_device)
         ui_set_selected_device (ui, default_device);
@


1.1.1.1
log
@Import simple-scan-0.9.7

Simple Scan is an easy-to-use application, designed to let users connect
their scanner and quickly have the image/document in an appropriate
format.
Simple Scan is basically a frontend for SANE which means that all
SANE supported scanners will work and the interface is well tested.
@
text
@@
