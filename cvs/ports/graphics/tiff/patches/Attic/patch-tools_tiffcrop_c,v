head	1.2;
access;
symbols
	OPENBSD_5_7:1.1.0.10
	OPENBSD_5_7_BASE:1.1
	OPENBSD_5_6:1.1.0.8
	OPENBSD_5_6_BASE:1.1
	OPENBSD_5_5:1.1.0.6
	OPENBSD_5_5_BASE:1.1
	OPENBSD_5_4:1.1.0.4
	OPENBSD_5_4_BASE:1.1
	OPENBSD_5_3:1.1.0.2;
locks; strict;
comment	@# @;


1.2
date	2015.03.29.17.39.22;	author naddy;	state dead;
branches;
next	1.1;
commitid	DVvDfC6c0cv0tIBV;

1.1
date	2013.05.03.11.00.39;	author jasper;	state Exp;
branches
	1.1.2.1
	1.1.8.1
	1.1.10.1;
next	;

1.1.2.1
date	2013.05.03.11.04.00;	author jasper;	state Exp;
branches;
next	;

1.1.8.1
date	2015.03.29.20.58.58;	author naddy;	state dead;
branches;
next	;
commitid	yV7LOUcjZFa2iAbX;

1.1.10.1
date	2015.03.29.19.41.56;	author naddy;	state dead;
branches;
next	;
commitid	tay2jRrbkJ3GxbDm;


desc
@@


1.2
log
@Security update to 4.0.4beta (plus one further upstream fix).
Should fix CVE-2014-8127, CVE-2014-8128, CVE-2014-8129, CVE-2014-8130,
CVE-2014-9655, CVE-2015-1547.
@
text
@$OpenBSD: patch-tools_tiffcrop_c,v 1.1 2013/05/03 11:00:39 jasper Exp $

Security fix for CVE-2013-1961 libtiff (tiff2pdf): Stack-based buffer overflow
with malformed image-length and resolution

Patch from https://bugzilla.redhat.com/show_bug.cgi?id=952131

--- tools/tiffcrop.c.orig	Tue Dec 14 15:18:28 2010
+++ tools/tiffcrop.c	Fri May  3 12:05:14 2013
@@@@ -2077,7 +2077,7 @@@@ update_output_file (TIFF **tiffout, char *mode, int au
         return 1;
         }
 
-      sprintf (filenum, "-%03d%s", findex, export_ext);
+      snprintf(filenum, sizeof(filenum), "-%03d%s", findex, export_ext);
       filenum[14] = '\0';
       strncat (exportname, filenum, 15);
       }
@@@@ -2230,8 +2230,8 @@@@ main(int argc, char* argv[])
 
           /* dump.infilename is guaranteed to be NUL termimated and have 20 bytes 
              fewer than PATH_MAX */ 
-          memset (temp_filename, '\0', PATH_MAX + 1);              
-          sprintf (temp_filename, "%s-read-%03d.%s", dump.infilename, dump_images,
+          snprintf(temp_filename, sizeof(temp_filename), "%s-read-%03d.%s",
+		   dump.infilename, dump_images,
                   (dump.format == DUMP_TEXT) ? "txt" : "raw");
           if ((dump.infile = fopen(temp_filename, dump.mode)) == NULL)
             {
@@@@ -2249,8 +2249,8 @@@@ main(int argc, char* argv[])
 
           /* dump.outfilename is guaranteed to be NUL termimated and have 20 bytes 
              fewer than PATH_MAX */ 
-          memset (temp_filename, '\0', PATH_MAX + 1);              
-          sprintf (temp_filename, "%s-write-%03d.%s", dump.outfilename, dump_images,
+          snprintf(temp_filename, sizeof(temp_filename), "%s-write-%03d.%s",
+		   dump.outfilename, dump_images,
                   (dump.format == DUMP_TEXT) ? "txt" : "raw");
           if ((dump.outfile = fopen(temp_filename, dump.mode)) == NULL)
             {
@


1.1
log
@Security fixes for
CVE-2013-1960 - Heap-based buffer overflow
CVE-2013-1961 - Stack-based buffer overflow

ok sthen@@
@
text
@d1 1
a1 1
$OpenBSD$
@


1.1.8.1
log
@Security update to 4.0.4beta (plus one further upstream fix).
Should fix CVE-2014-8127, CVE-2014-8128, CVE-2014-8129, CVE-2014-8130,
CVE-2014-9655, CVE-2015-1547.
@
text
@d1 1
a1 1
$OpenBSD: patch-tools_tiffcrop_c,v 1.1 2013/05/03 11:00:39 jasper Exp $
@


1.1.10.1
log
@Security update to 4.0.4beta (plus one further upstream fix).
Should fix CVE-2014-8127, CVE-2014-8128, CVE-2014-8129, CVE-2014-8130,
CVE-2014-9655, CVE-2015-1547.
@
text
@d1 1
a1 1
$OpenBSD: patch-tools_tiffcrop_c,v 1.1 2013/05/03 11:00:39 jasper Exp $
@


1.1.2.1
log
@Security fixes for
CVE-2013-1960 - Heap-based buffer overflow
CVE-2013-1961 - Stack-based buffer overflow

ok sthen@@
@
text
@d1 1
a1 1
$OpenBSD: patch-tools_tiffcrop_c,v 1.1 2013/05/03 11:00:39 jasper Exp $
@

