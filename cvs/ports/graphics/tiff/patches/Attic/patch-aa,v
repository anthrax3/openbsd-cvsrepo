head	1.9;
access;
symbols
	OPENBSD_2_9_TRACKING_SWITCH:1.8
	OPENBSD_2_9:1.8.0.4
	OPENBSD_2_9_BASE:1.8
	OPENBSD_2_8:1.8.0.2
	OPENBSD_2_8_BASE:1.8
	OPENBSD_2_7:1.6.0.2
	OPENBSD_2_7_BASE:1.6
	brad_1999-10-26:1.1.1.2
	brad:1.1.1
	OPENBSD_2_3:1.2.0.2
	OPENBSD_2_3_BASE:1.2
	tiff3_3:1.1.1.1
	angelos:1.1.1;
locks; strict;
comment	@# @;


1.9
date	2001.10.10.15.15.00;	author wilfried;	state dead;
branches;
next	1.8;

1.8
date	2000.10.19.11.56.02;	author brad;	state Exp;
branches;
next	1.7;

1.7
date	2000.09.26.06.34.18;	author brad;	state Exp;
branches;
next	1.6;

1.6
date	2000.01.01.21.28.30;	author brad;	state Exp;
branches;
next	1.5;

1.5
date	99.11.04.23.19.46;	author brad;	state Exp;
branches;
next	1.4;

1.4
date	99.10.26.22.05.20;	author brad;	state Exp;
branches;
next	1.3;

1.3
date	98.06.10.02.56.24;	author marc;	state dead;
branches;
next	1.2;

1.2
date	98.02.13.22.27.45;	author marc;	state Exp;
branches;
next	1.1;

1.1
date	97.12.03.02.37.01;	author angelos;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	97.12.03.02.37.01;	author angelos;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	99.10.26.22.01.26;	author brad;	state Exp;
branches;
next	;


desc
@@


1.9
log
@use -fPIC rather than -fpic
regenerate the patches with update-patches
ok naddy@@
@
text
@--- libtiff/Makefile.in.orig	Sun Nov 28 15:15:36 1999
+++ libtiff/Makefile.in	Thu Oct 19 07:28:08 2000
@@@@ -62,7 +62,6 @@@@
 #
 CONF_LIBRARY=@@CONF_JPEG@@ @@CONF_ZIP@@
 COPTS	= @@GCOPTS@@
-OPTIMIZER=-O
 CFLAGS	= @@ENVOPTS@@ @@LIBCOPTS@@ ${COPTS} ${OPTIMIZER} ${IPATH} ${CONF_LIBRARY}
 #
 SRCS	= \
@@@@ -216,6 +215,9 @@@@
 OSFdso: ${OBJS}
 	${LD} -o libtiff.@@DSOSUF@@ -shared -error_unresolved ${OBJS} @@LIBJPEG@@ @@LIBGZ@@ -lc -lm
 
+OPENBSDdso: ${OBJS}
+	${CC} -shared @@LIBCOPTS@@ -o libtiff.@@DSOSUF_VERSION@@ ${OBJS} @@LIBJPEG@@ @@LIBGZ@@
+	touch $@@
 
 ${OBJS}: ${SRCDIR}/tiffio.h ${SRCDIR}/tiff.h ${SRCDIR}/tif_dir.h
 ${OBJS}: ${SRCDIR}/tiffcomp.h ${SRCDIR}/tiffiop.h ${SRCDIR}/tiffconf.h
@@@@ -323,15 +325,9 @@@@
 		-src $$i -O $$f;					\
 	done
 installDSO: @@DSO@@dso
-	if [ @@DSOSUF_VERSION@@ != @@DSOSUF@@ ]; then			\
-	    ${INSTALL} -idb tiff.sw.tools -m 555 -F @@DIR_LIB@@		\
+	${INSTALL} -idb tiff.sw.tools.nostrip -m 555 -F @@DIR_LIB@@	\
 		-O libtiff.@@DSOSUF_VERSION@@;				\
-	    ${INSTALL} -idb tiff.sw.tools -F @@DIR_LIB@@			\
-		-ln libtiff.@@DSOSUF_VERSION@@ -O libtiff.@@DSOSUF@@;	\
-	else								\
-	    ${INSTALL} -idb tiff.sw.tools -m 555 -F @@DIR_LIB@@		\
-		-O libtiff.@@DSOSUF@@;					\
-	fi
+
 install: all installHdrs
 	${INSTALL} -idb tiff.sw.dev -m 755 -dir @@DIR_LIB@@
 	${INSTALL} -idb tiff.sw.dev -m 444 -F @@DIR_LIB@@ -O libtiff.a
@


1.8
log
@pass the pic flag along to the compiler when linking the shared library.
@
text
@@


1.7
log
@use "cc -shared" for the creation of shared libraries
@
text
@d2 1
a2 1
+++ libtiff/Makefile.in	Tue Sep 26 02:09:07 2000
d16 1
a16 1
+	${CC} -shared -o libtiff.@@DSOSUF_VERSION@@ ${OBJS} @@LIBJPEG@@ @@LIBGZ@@
@


1.6
log
@upgrade to libtiff 3.5.4, biggest change:
- Removed LZW Compression to comply with Unisys patent extortion
- Changed default compression in tools to TIFF_PACKBITS, and changed usage
descriptions in tools to reflect removal of LZW compression
- Added Pixar tag support
@
text
@d1 2
a2 2
--- libtiff/Makefile.in.orig	Tue Dec 21 18:12:48 1999
+++ libtiff/Makefile.in	Tue Dec 21 18:16:04 1999
d16 1
a16 1
+	${LD} -x -Bshareable -Bforcearchive -o libtiff.@@DSOSUF_VERSION@@ ${OBJS} @@LIBJPEG@@ @@LIBGZ@@
@


1.5
log
@stop tiff from creating an unnecessary sym link durring install
@
text
@d1 3
a3 3
--- libtiff/Makefile.in.orig	Wed Sep  8 05:39:00 1999
+++ libtiff/Makefile.in	Thu Nov  4 13:58:18 1999
@@@@ -62,7 +62,7 @@@@
a7 1
+#OPTIMIZER=-O
d11 1
a11 1
@@@@ -216,6 +216,9 @@@@
d21 1
a21 1
@@@@ -323,15 +326,8 @@@@
d27 2
a28 1
-		-O libtiff.@@DSOSUF_VERSION@@;				\
d35 1
a35 2
+	    ${INSTALL} -idb tiff.sw.tools.nostrip -m 555 -F @@DIR_LIB@@	\
+		-O libtiff.@@DSOSUF_VERSION@@;
@


1.4
log
@add libtiff v3.5.2
@
text
@d2 1
a2 1
+++ libtiff/Makefile.in	Fri Oct 22 16:51:57 1999
d22 2
a23 1
@@@@ -324,10 +327,10 @@@@
d26 1
a26 1
 	if [ @@DSOSUF_VERSION@@ != @@DSOSUF@@ ]; then			\
d28 7
d36 4
a39 7
 		-O libtiff.@@DSOSUF_VERSION@@;				\
 	    ${INSTALL} -idb tiff.sw.tools -F @@DIR_LIB@@			\
-		-ln libtiff.@@DSOSUF_VERSION@@ -O libtiff.@@DSOSUF@@;	\
+		-lns libtiff.@@DSOSUF_VERSION@@ -O libtiff.@@DSOSUF@@;	\
 	else								\
 	    ${INSTALL} -idb tiff.sw.tools -m 555 -F @@DIR_LIB@@		\
 		-O libtiff.@@DSOSUF@@;					\
@


1.3
log
@1) remove tiff from graphics makefile as there is nothing to make
2) change tiff/Makefile to spit out message saying to use tiff34
   remove all tiff files, patches, and pkg data; they're no longer needed
3) install tiff34 as libtiff, tiff.h, and tiffio.h; add symbolic links
   so the old names of libtiff34, tiff34.h, and tiffio34.h still work.
4) Change ImageMagick to use -ltiff, not -ltiff34; remove the patch
   files and directory as they are no longer needed.
5) Change gimp to use -ltiff, not -ltiff34; remove the patch files and
   directory as they are no longer needed.

NOTE: with these changes ImageMagick and gimp require the updated tiff34
      port.
@
text
@d1 34
a34 99
*** libtiff/Makefile.gcc.orig	Thu Sep 29 17:01:24 1994
--- libtiff/Makefile.gcc	Fri Feb 13 14:18:48 1998
***************
*** 26,43 ****
  #
  # This Makefile is for use with gcc (2.2.2 or later)
  #
! DESTDIR=.
  #
  AR=	ar
  RANLIB=	ranlib
  NULL=
  
  IPATH=	-I.
  CONF_LIBRARY=\
  	${NULL}
! CC=	gcc
! COPTS=	-ansi -O
! CFLAGS=	${COPTS} ${IPATH} ${CONF_LIBRARY}
  #
  INCS=	tiff.h tiffio.h
  SRCS=	tif_fax3.c \
--- 26,42 ----
  #
  # This Makefile is for use with gcc (2.2.2 or later)
  #
! DESTDIR=${PREFIX}
  #
  AR=	ar
  RANLIB=	ranlib
+ INSTALL= install -o bin -g bin
  NULL=
  
  IPATH=	-I.
  CONF_LIBRARY=\
  	${NULL}
! CFLAGS+= ${COPTS} ${IPATH} ${CONF_LIBRARY}
  #
  INCS=	tiff.h tiffio.h
  SRCS=	tif_fax3.c \
***************
*** 101,113 ****
  	tif_write.o \
  	${NULL}
  ALL=	libtiff.a
  
  all:	 ${ALL}
  
! ${ALL}:	${OBJS}
  	${AR} rc libtiff.a $?
  	${RANLIB} libtiff.a
  
  ${OBJS}: tiffio.h tiff.h tiffcomp.h tiffiop.h tiffconf.h
  tif_fax3.o: tif_fax3.c g3states.h t4.h tif_fax3.h
  
--- 100,123 ----
  	tif_write.o \
  	${NULL}
  ALL=	libtiff.a
+ .if ${MACHINE_ARCH} != "alpha"
+ ALL+=	libtiff.so.3.3
+ .endif
  
  all:	 ${ALL}
  
! libtiff.a: ${OBJS}
  	${AR} rc libtiff.a $?
  	${RANLIB} libtiff.a
  
+ .SUFFIXES: .c .o .so
+ 
+ .c.so:
+ 	${CC} -fpic -DPIC ${CFLAGS} -c ${.IMPSRC} -o ${.TARGET}
+ 
+ libtiff.so.3.3: ${OBJS:S/o$/so/g}
+ 	ld -Bshareable -o libtiff.so.3.3 ${OBJS:S/o$/so/g}
+ 
  ${OBJS}: tiffio.h tiff.h tiffcomp.h tiffiop.h tiffconf.h
  tif_fax3.o: tif_fax3.c g3states.h t4.h tif_fax3.h
  
***************
*** 118,125 ****
  install: all installh
  	-for i in ${ALL}; do \
  		${INSTALL} -c -m 644 $$i ${DESTDIR}/lib/$$i; \
- 		${RANLIB} ${DESTDIR}/lib/$$i; \
  	done
  
  installh: ${INCS}
  	-for i in ${INCS}; do \
--- 128,135 ----
  install: all installh
  	-for i in ${ALL}; do \
  		${INSTALL} -c -m 644 $$i ${DESTDIR}/lib/$$i; \
  	done
+ 	${RANLIB} ${DESTDIR}/lib/libtiff.a
  
  installh: ${INCS}
  	-for i in ${INCS}; do \
@


1.2
log
@pr 404: don't make .so on alpha
@
text
@@


1.1
log
@Initial revision
@
text
@d1 2
a2 2
*** libtiff/Makefile.gcc.orig	Fri Sep 30 03:01:24 1994
--- libtiff/Makefile.gcc	Wed Oct  4 04:28:20 1995
d42 1
a42 2
*** 100,113 ****
  	tif_warning.o \
d45 1
a45 1
! ALL=	libtiff.a
d56 1
a56 2
--- 99,120 ----
  	tif_warning.o \
d59 4
a62 1
! ALL=	libtiff.a libtiff.so.3.3
d91 1
a91 1
--- 125,132 ----
d96 1
a96 1
+ 	ranlib ${DESTDIR}/lib/libtiff.a
@


1.1.1.1
log
@libtiff port.
@
text
@@


1.1.1.2
log
@add port of libtiff v3.5.2
@
text
@d1 98
a98 34
--- libtiff/Makefile.in.orig	Wed Sep  8 05:39:00 1999
+++ libtiff/Makefile.in	Fri Oct 22 16:51:57 1999
@@@@ -62,7 +62,7 @@@@
 #
 CONF_LIBRARY=@@CONF_JPEG@@ @@CONF_ZIP@@
 COPTS	= @@GCOPTS@@
-OPTIMIZER=-O
+#OPTIMIZER=-O
 CFLAGS	= @@ENVOPTS@@ @@LIBCOPTS@@ ${COPTS} ${OPTIMIZER} ${IPATH} ${CONF_LIBRARY}
 #
 SRCS	= \
@@@@ -216,6 +216,9 @@@@
 OSFdso: ${OBJS}
 	${LD} -o libtiff.@@DSOSUF@@ -shared -error_unresolved ${OBJS} @@LIBJPEG@@ @@LIBGZ@@ -lc -lm
 
+OPENBSDdso: ${OBJS}
+	${LD} -x -Bshareable -Bforcearchive -o libtiff.@@DSOSUF_VERSION@@ ${OBJS} @@LIBJPEG@@ @@LIBGZ@@
+	touch $@@
 
 ${OBJS}: ${SRCDIR}/tiffio.h ${SRCDIR}/tiff.h ${SRCDIR}/tif_dir.h
 ${OBJS}: ${SRCDIR}/tiffcomp.h ${SRCDIR}/tiffiop.h ${SRCDIR}/tiffconf.h
@@@@ -324,10 +327,10 @@@@
 	done
 installDSO: @@DSO@@dso
 	if [ @@DSOSUF_VERSION@@ != @@DSOSUF@@ ]; then			\
-	    ${INSTALL} -idb tiff.sw.tools -m 555 -F @@DIR_LIB@@		\
+	    ${INSTALL} -idb tiff.sw.tools.nostrip -m 555 -F @@DIR_LIB@@	\
 		-O libtiff.@@DSOSUF_VERSION@@;				\
 	    ${INSTALL} -idb tiff.sw.tools -F @@DIR_LIB@@			\
-		-ln libtiff.@@DSOSUF_VERSION@@ -O libtiff.@@DSOSUF@@;	\
+		-lns libtiff.@@DSOSUF_VERSION@@ -O libtiff.@@DSOSUF@@;	\
 	else								\
 	    ${INSTALL} -idb tiff.sw.tools -m 555 -F @@DIR_LIB@@		\
 		-O libtiff.@@DSOSUF@@;					\
@

