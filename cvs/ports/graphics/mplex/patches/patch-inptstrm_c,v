head	1.2;
access;
symbols
	OPENBSD_6_0:1.2.0.58
	OPENBSD_6_0_BASE:1.2
	OPENBSD_5_9:1.2.0.54
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.2.0.56
	OPENBSD_5_8_BASE:1.2
	OPENBSD_5_7:1.2.0.52
	OPENBSD_5_7_BASE:1.2
	OPENBSD_5_6:1.2.0.50
	OPENBSD_5_6_BASE:1.2
	OPENBSD_5_5:1.2.0.48
	OPENBSD_5_5_BASE:1.2
	OPENBSD_5_4:1.2.0.46
	OPENBSD_5_4_BASE:1.2
	OPENBSD_5_3:1.2.0.44
	OPENBSD_5_3_BASE:1.2
	OPENBSD_5_2:1.2.0.42
	OPENBSD_5_2_BASE:1.2
	OPENBSD_5_1_BASE:1.2
	OPENBSD_5_1:1.2.0.40
	OPENBSD_5_0:1.2.0.38
	OPENBSD_5_0_BASE:1.2
	OPENBSD_4_9:1.2.0.36
	OPENBSD_4_9_BASE:1.2
	OPENBSD_4_8:1.2.0.34
	OPENBSD_4_8_BASE:1.2
	OPENBSD_4_7:1.2.0.32
	OPENBSD_4_7_BASE:1.2
	OPENBSD_4_6:1.2.0.30
	OPENBSD_4_6_BASE:1.2
	OPENBSD_4_5:1.2.0.28
	OPENBSD_4_5_BASE:1.2
	OPENBSD_4_4:1.2.0.26
	OPENBSD_4_4_BASE:1.2
	OPENBSD_4_3:1.2.0.24
	OPENBSD_4_3_BASE:1.2
	OPENBSD_4_2:1.2.0.22
	OPENBSD_4_2_BASE:1.2
	OPENBSD_4_1:1.2.0.20
	OPENBSD_4_1_BASE:1.2
	OPENBSD_4_0:1.2.0.18
	OPENBSD_4_0_BASE:1.2
	OPENBSD_3_9:1.2.0.16
	OPENBSD_3_9_BASE:1.2
	OPENBSD_3_8:1.2.0.14
	OPENBSD_3_8_BASE:1.2
	OPENBSD_3_7:1.2.0.12
	OPENBSD_3_7_BASE:1.2
	OPENBSD_3_6:1.2.0.10
	OPENBSD_3_6_BASE:1.2
	OPENBSD_3_5:1.2.0.8
	OPENBSD_3_5_BASE:1.2
	OPENBSD_3_4:1.2.0.6
	OPENBSD_3_4_BASE:1.2
	OPENBSD_3_3:1.2.0.4
	OPENBSD_3_3_BASE:1.2
	OPENBSD_3_2:1.2.0.2
	OPENBSD_3_2_BASE:1.2
	OPENBSD_3_1:1.1.1.1.0.4
	OPENBSD_3_1_BASE:1.1.1.1
	OPENBSD_3_0:1.1.1.1.0.2
	OPENBSD_3_0_BASE:1.1.1.1
	OPENBSD_2_9_TRACKING_SWITCH:1.1.1.1
	mplex:1.1.1.1
	angelos:1.1.1;
locks; strict;
comment	@# @;


1.2
date	2002.08.12.19.33.31;	author wcobb;	state Exp;
branches;
next	1.1;

1.1
date	2001.06.19.03.23.26;	author angelos;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2001.06.19.03.23.26;	author angelos;	state Exp;
branches;
next	;


desc
@@


1.2
log
@- pull in missing prototypes.
- fix format strings.
- remove unnecessary statics from headers, reduce executable size.
- disable insane verbosity that just slows down encoding.
@
text
@$OpenBSD: patch-inptstrm_c,v 1.1.1.1 2001/06/19 03:23:26 angelos Exp $
--- inptstrm.c.orig	Wed May 31 10:04:11 1995
+++ inptstrm.c	Thu Jul 18 16:00:00 2002
@@@@ -5,18 +5,43 @@@@
     Basic Checks on MPEG Streams
 *************************************************************************/
 
+extern int Interactive;
+
 void marker_bit (bs, what)
 Bit_stream_struc *bs;
 unsigned int what;
 {
     if (what != get1bit(bs))
     {
-        printf ("\nError in MPEG stream at offset (bits) %ul: supposed marker bit not found.\n",sstell(bs));
+        printf ("\nError in MPEG stream at offset (bits) %lu: supposed marker bit not found.\n",sstell(bs));
         exit (1);
     }
 }
 
-
+unsigned int bitrate_index [3][16] =
+    {{0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,0},
+     {0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,0},
+     {0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,0}};
+
+static double picture_rates [9] = { 0., 24000./1001., 24., 25., 
+	30000./1001., 30., 50., 60000./1001., 60. };
+    
+static double ratio [16] = { 0., 1., 0.6735, 0.7031, 0.7615, 0.8055,
+	0.8437, 0.8935, 0.9157, 0.9815, 1.0255, 1.0695, 1.0950, 1.1575,
+	1.2015, 0.};
+
+static double frequency [4] = {44.1, 48, 32, 0};
+static unsigned int slots [4] = {12, 144, 0, 0};
+static unsigned int samples [4] = {384, 1152, 0, 0};
+
+static char mode [4][15] =
+    { "stereo", "joint stereo", "dual channel", "single channel" };
+static char copyright [2][20] =
+    { "no copyright","copyright protected" };
+static char original [2][10] =
+    { "copy","original" };
+static char emphasis [4][20] =
+    { "none", "50/15 microseconds", "reserved", "CCITT J.17" };
 
 /*************************************************************************
     MPEG Verifikation der Inputfiles
@@@@ -293,7 +318,7 @@@@ unsigned int length;
 	} else break;
     } while (!end_bs(&video_bs));
 
-    printf ("\nDone, stream bit offset %ld.\n",offset_bits);
+    printf ("\nDone, stream bit offset %d.\n",offset_bits);
 
     video_info->stream_length = offset_bits >> 3;
     for (i=0; i<4; i++)
@@@@ -310,7 +335,8 @@@@ unsigned int length;
     fclose (info_file);
     output_info_video (video_info);
 
-    ask_continue ();
+    if (Interactive)
+        ask_continue ();
 }
 
 /*************************************************************************
@@@@ -414,7 +440,7 @@@@ printf("\n+------------------ AUDIO STRE
     else if (audio_info->bit_rate == 0xf)
 	printf ("Bit rate       : reserved\n");
     else
-	printf ("Bit rate       : %8u bytes/sec (%3u kbit/sec)\n",
+	printf ("Bit rate       : %8lu bytes/sec (%3lu kbit/sec)\n",
 		 bitrate*128, bitrate);
 
     if (audio_info->frequency == 3)
@@@@ -456,7 +482,6 @@@@ unsigned int length;
     FILE* info_file;
     Bit_stream_struc audio_bs;
     unsigned int offset_bits=0;
-    unsigned int stream_length=0; 
     unsigned int framesize;
     unsigned int padding_bit;
     unsigned int skip;
@@@@ -464,7 +489,6 @@@@ unsigned int length;
     double PTS;
     double samples_per_second;
     Aaunit_struc access_unit;
-    unsigned long syncword;
     int i;
     unsigned int prozent;
     unsigned int old_prozent=0;
@@@@ -559,13 +583,14 @@@@ unsigned int length;
 	else break;
     } while (!end_bs(&audio_bs));
 
-    printf ("\nDone, stream bit offset %ld.\n",offset_bits);
+    printf ("\nDone, stream bit offset %d.\n",offset_bits);
 
     audio_info->stream_length = offset_bits >> 3;
     close_bit_stream_r (&audio_bs);
     fclose (info_file);
     output_info_audio (audio_info);
-    ask_continue ();
+    if (Interactive)
+        ask_continue ();
 
 }
 
@


1.1
log
@Initial revision
@
text
@d1 7
a7 5
$OpenBSD$
--- inptstrm.c.orig	Wed May 31 09:04:11 1995
+++ inptstrm.c	Sun Jun 10 00:43:14 2001
@@@@ -1,4 +1,5 @@@@
 #include "main.h"
d9 39
d49 7
a55 1
     MPEG Streams Kontrolle
d57 3
a59 1
@@@@ -310,6 +311,7 @@@@ unsigned int length;
d63 3
a65 2
+  if( Interactive )
     ask_continue ();
d68 34
a101 1
@@@@ -565,6 +567,7 @@@@ unsigned int length;
d105 3
a107 2
+  if( Interactive )
     ask_continue ();
d110 1
@


1.1.1.1
log
@Initial import of mplex, based on FreeBSD port.

Multiplex MPEG video/audio streams.
@
text
@@
