head	1.1;
access;
symbols
	OPENBSD_6_0:1.1.0.4
	OPENBSD_6_0_BASE:1.1
	OPENBSD_5_9:1.1.0.2
	OPENBSD_5_9_BASE:1.1;
locks; strict;
comment	@# @;


1.1
date	2015.09.02.18.50.08;	author juanfra;	state Exp;
branches;
next	;
commitid	0sMvqu9WEOrZpqLd;


desc
@@


1.1
log
@Update to pdf2djvu 0.8.1.
@
text
@$OpenBSD$

https://bitbucket.org/jwilk/pdf2djvu/issues/108/pdf2djvu-081-the-tests-fail-on-openbsd

--- tests/common.py.orig	Thu Aug 13 17:49:20 2015
+++ tests/common.py	Mon Aug 31 20:22:47 2015
@@@@ -133,6 +133,9 @@@@ class case(object):
             env=env,
         )
         stdout, stderr = child.communicate()
+        if sys.platform.startswith('openbsd'):
+            # FIXME: https://bitbucket.org/jwilk/pdf2djvu/issues/108
+            stderr = re(r'Magick: Failed to close module [(]"\w*: Invalid handle\"[)].\n').sub('', stderr)
         stderr = re(r'^(?:  \S+ --> \S+ \(\d+ bytes\)\n)+$').sub('', stderr)  # strip djvuextract cruft
         return ipc_result(stdout, stderr, child.returncode)
 
@
