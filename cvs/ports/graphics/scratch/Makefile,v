head	1.11;
access;
symbols
	OPENBSD_6_1:1.11.0.6
	OPENBSD_6_1_BASE:1.11
	OPENBSD_6_0:1.11.0.4
	OPENBSD_6_0_BASE:1.11
	OPENBSD_5_9:1.11.0.2
	OPENBSD_5_9_BASE:1.11
	OPENBSD_5_8:1.9.0.4
	OPENBSD_5_8_BASE:1.9
	OPENBSD_5_7:1.8.0.6
	OPENBSD_5_7_BASE:1.8
	OPENBSD_5_6:1.8.0.4
	OPENBSD_5_6_BASE:1.8
	OPENBSD_5_5:1.8.0.2
	OPENBSD_5_5_BASE:1.8
	OPENBSD_5_4:1.7.0.2
	OPENBSD_5_4_BASE:1.7
	OPENBSD_5_3:1.4.0.2
	OPENBSD_5_3_BASE:1.4
	OPENBSD_5_2:1.3.0.8
	OPENBSD_5_2_BASE:1.3
	OPENBSD_5_1_BASE:1.3
	OPENBSD_5_1:1.3.0.6
	OPENBSD_5_0:1.3.0.4
	OPENBSD_5_0_BASE:1.3
	OPENBSD_4_9:1.3.0.2
	OPENBSD_4_9_BASE:1.3
	OPENBSD_4_8:1.2.0.6
	OPENBSD_4_8_BASE:1.2
	OPENBSD_4_7:1.2.0.4
	OPENBSD_4_7_BASE:1.2
	OPENBSD_4_6:1.2.0.2
	OPENBSD_4_6_BASE:1.2
	OPENBSD_4_5:1.1.1.1.0.2
	OPENBSD_4_5_BASE:1.1.1.1
	sthen_20090203:1.1.1.1
	sthen:1.1.1;
locks; strict;
comment	@# @;


1.11
date	2015.11.02.11.56.55;	author espie;	state Exp;
branches;
next	1.10;
commitid	ox8NBCUwS6UB4UwE;

1.10
date	2015.08.25.12.57.33;	author sthen;	state Exp;
branches;
next	1.9;
commitid	uwqnsxBmJQFSoMQ9;

1.9
date	2015.03.27.08.11.29;	author ajacoutot;	state Exp;
branches;
next	1.8;
commitid	mHt3hIg3nxq5XDcy;

1.8
date	2013.11.12.20.12.02;	author stu;	state Exp;
branches;
next	1.7;

1.7
date	2013.05.16.17.20.12;	author sthen;	state Exp;
branches;
next	1.6;

1.6
date	2013.05.14.09.42.47;	author sthen;	state Exp;
branches;
next	1.5;

1.5
date	2013.03.11.11.10.55;	author espie;	state Exp;
branches;
next	1.4;

1.4
date	2013.01.08.15.23.15;	author sthen;	state Exp;
branches;
next	1.3;

1.3
date	2010.11.17.08.05.16;	author espie;	state Exp;
branches;
next	1.2;

1.2
date	2009.04.09.11.38.29;	author jasper;	state Exp;
branches;
next	1.1;

1.1
date	2009.02.03.14.56.56;	author sthen;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2009.02.03.14.56.56;	author sthen;	state Exp;
branches;
next	;


desc
@@


1.11
log
@a few minor pkg_subst fixes, for the coming patch (disallow -c without -m
outside of WRKDIR)
@
text
@# $OpenBSD: Makefile,v 1.10 2015/08/25 12:57:33 sthen Exp $

COMMENT =	visual programming environment and toolkit

DISTNAME =	${PKGNAME}.src
PKGNAME =	scratch-1.4.0.7
REVISION =	2
CATEGORIES =	graphics
HOMEPAGE =	http://scratch.mit.edu/
MAINTAINER =	Stuart Cassoff <stwo@@users.sourceforge.net>

# GPLv2 / MIT / Creative Commons (CC BY-SA 3.0)
PERMIT_PACKAGE_CDROM =	Yes

WANTLIB =	X11 Xau Xdmcp Xext Xrender cairo expat fontconfig freetype \
		glib-2.0 gmodule-2.0 gobject-2.0 graphite2 harfbuzz \
		m pango-1.0 pangocairo-1.0 pangoft2-1.0 pcre pixman-1 \
		png pthread pthread-stubs xcb xcb-render xcb-shm z

MASTER_SITES =	http://download.scratch.mit.edu/
MODULES =	devel/gettext

# not actually needed to build, but avoid wasting time on !squeak arches.
BUILD_DEPENDS =	lang/squeak/vm

RUN_DEPENDS =	lang/squeak/vm \
		devel/desktop-file-utils \
		devel/xdg-utils \
		misc/shared-mime-info \
		x11/gtk+3,-guic

LIB_DEPENDS =	devel/pango
SEPARATE_BUILD = Yes
NO_TEST =	Yes
CFLAGS +=	-Wall -fPIC -shared
SUBST_VARS =	SC_DIR

SC_DIR =	${PREFIX}/share/scratch

post-extract:
	gunzip -o ${WRKSRC}/src/man/scratch.1 ${WRKSRC}/src/man/scratch.1.gz

do-build:
	@@${SUBST_CMD} -m 555 -c ${FILESDIR}/scratch ${WRKBUILD}/scratch
	@@${SUBST_CMD} -c ${WRKSRC}/src/man/scratch.1 ${WRKBUILD}/scratch.1
	cd ${WRKSRC}/src/plugins/unicode && ${CC} ${CFLAGS} *.c \
		`pkg-config --cflags --libs pangocairo` \
		-o ${WRKBUILD}/UnicodePlugin
.for p in Scratch Camera
	cd ${WRKSRC}/src/plugins/${p:L} && ${CC} ${CFLAGS} *.c \
		-o ${WRKBUILD}/${p}Plugin
.endfor

do-install:
	${INSTALL_DATA_DIR} ${SC_DIR}/Plugins
.for p in Unicode Scratch Camera
	${INSTALL_DATA} ${WRKBUILD}/${p}Plugin ${SC_DIR}/Plugins/${p}Plugin
.endfor
.for f in Help locale Media Projects Scratch.image Scratch.ini \
		LICENSE gpl-2.0.txt
	cp -r ${WRKSRC}/$f ${SC_DIR}/$f
.endfor
	chown -R ${SHAREOWN}:${SHAREGRP} ${SC_DIR}
	find ${SC_DIR} -type d -exec chmod 755 {} ';'
	find ${SC_DIR} -type f -exec chmod 444 {} ';'
	${INSTALL_SCRIPT} ${WRKBUILD}/scratch ${PREFIX}/bin/scratch
	${INSTALL_MAN_DIR} ${PREFIX}/man/man1
	${INSTALL_MAN} ${WRKBUILD}/scratch.1 ${PREFIX}/man/man1/scratch.1
	${INSTALL_DATA_DIR} ${PREFIX}/share/applications
	${INSTALL_DATA} ${WRKSRC}/src/scratch.desktop \
		${PREFIX}/share/applications
	${INSTALL_DATA_DIR} ${PREFIX}/share/mime/packages
	${INSTALL_DATA} ${WRKSRC}/src/scratch.xml \
		${PREFIX}/share/mime/packages
.for d in 128x128 32x32 48x48
	${INSTALL_DATA_DIR} ${PREFIX}/share/icons/hicolor/$d/apps
	${INSTALL_DATA} ${WRKSRC}/src/icons/$d/scratch* \
		${PREFIX}/share/icons/hicolor/$d/apps
.endfor
.for d in 128x128 48x48
	${INSTALL_DATA_DIR} ${PREFIX}/share/icons/hicolor/$d/mimetypes
	${INSTALL_DATA} ${WRKSRC}/src/icons/$d/*mime* \
		${PREFIX}/share/icons/hicolor/$d/mimetypes
.endfor

.include <bsd.port.mk>
@


1.10
log
@wantlib
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2015/03/27 08:11:29 ajacoutot Exp $
d44 1
a44 1
	@@${SUBST_CMD} -c ${FILESDIR}/scratch ${WRKBUILD}/scratch
@


1.9
log
@x11/gtk+2,-guic -> x11/gtk+3,-guic && bump
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2013/11/12 20:12:02 stu Exp $
d7 1
a7 1
REVISION =	1
d16 1
a16 1
		glib-2.0 gmodule-2.0 gobject-2.0 harfbuzz \
@


1.8
log
@Tidy Makefile.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2013/05/16 17:20:12 sthen Exp $
d7 1
a7 1
REVISION =	0
d30 1
a30 1
		x11/gtk+2,-guic
@


1.7
log
@use gettext MODULE
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2013/05/14 09:42:47 sthen Exp $
d3 1
a3 1
COMMENT =		visual programming environment and toolkit
d5 6
a10 7
DISTNAME =		${PKGNAME}.src
PKGNAME =		scratch-1.4.0.7
REVISION =		0
CATEGORIES =		graphics
HOMEPAGE =		http://scratch.mit.edu/

MAINTAINER =		Stuart Cassoff <stwo@@users.sourceforge.net>
d20 2
a21 4
MASTER_SITES =		http://download.scratch.mit.edu/

MODULES =		devel/gettext
LIB_DEPENDS=		devel/pango
d24 1
a24 9
BUILD_DEPENDS =		lang/squeak/vm
RUN_DEPENDS =		lang/squeak/vm \
			devel/desktop-file-utils \
			devel/xdg-utils \
			misc/shared-mime-info \
			x11/gtk+2,-guic

SEPARATE_BUILD =	Yes
NO_TEST =		Yes
d26 11
a36 2
CFLAGS +=		-Wall -fPIC -shared
SUBST_VARS =		SC_DIR
d38 1
a38 1
SC_DIR =		${PREFIX}/share/scratch
@


1.6
log
@update to Scratch 1.4.0.7, from stu@@ (maintainer), tested by Lars Engblom.
"I'll do the update today" stu@@, 18 April. it's been a while, so committing
for him ;) additional tweak: build dep on squeak, to avoid wasting time on
!squeak arches.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2013/03/11 11:10:55 espie Exp $
d7 1
d17 1
a17 1
		glib-2.0 gmodule-2.0 gobject-2.0 harfbuzz iconv intl \
d23 1
@


1.5
log
@PERMIT_* / REGRESS -> TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2013/01/08 15:23:15 sthen Exp $
d5 2
a6 2
DISTNAME =		scratch-1.3
REVISION =		0
a8 2
MASTER_SITES =		${HOMEPAGE:=files/}
DISTFILES =		WinScratch1.3.zip
d12 1
a12 1
# MIT
d15 16
a30 2
BUILD_DEPENDS=		archivers/unzip
RUN_DEPENDS =		lang/squeak/vm
d32 1
a32 2
EXTRACT_ONLY =
NO_BUILD =		Yes
d35 18
a52 3
SCRATCH_LIB_DIR =	${PREFIX}/lib/scratch
SCRATCH_SHARE_DIR =	${PREFIX}/share/scratch
SCRATCH_SUBDIR =	WinScratch1.3/Scratch\ 1.3
d55 29
a83 15
	${INSTALL_DATA_DIR} ${SCRATCH_LIB_DIR}
	${INSTALL_DATA_DIR} ${SCRATCH_SHARE_DIR}
	unzip -oq ${DISTDIR}/${DISTFILES} \
	    -x ${SCRATCH_SUBDIR}/*.dll ${SCRATCH_SUBDIR}/Scratch.exe \
	    -d ${SCRATCH_SHARE_DIR}
	gzip < ${SCRATCH_SHARE_DIR}/${SCRATCH_SUBDIR}/Scratch.image > \
	    ${SCRATCH_LIB_DIR}/Scratch.image.gz
	chmod 444 ${SCRATCH_LIB_DIR}/Scratch.image.gz
	rm -f ${SCRATCH_SHARE_DIR}/${SCRATCH_SUBDIR}/Scratch.image
	mv ${SCRATCH_SHARE_DIR}/${SCRATCH_SUBDIR}/* ${SCRATCH_SHARE_DIR}
	rm -rf ${SCRATCH_SHARE_DIR}/${SCRATCH_SUBDIR:H}
	find ${SCRATCH_SHARE_DIR} -type d -exec chmod 755 {} ';'
	find ${SCRATCH_SHARE_DIR} -type f -exec chmod 444 {} ';'
.for i in Help locale Scratch.ini license.txt
	mv ${SCRATCH_SHARE_DIR}/$i ${SCRATCH_LIB_DIR}/$i
a84 3
	${SUBST_CMD} -c ${FILESDIR}/iniscratch ${SCRATCH_SHARE_DIR}/iniscratch
	chown ${SHAREOWN}:${SHAREGRP} ${SCRATCH_SHARE_DIR}/iniscratch
	${INSTALL_SCRIPT} ${FILESDIR}/scratch ${PREFIX}/bin
@


1.4
log
@fix paths in iniscratch; pointed out by "Beni" and Lars Engblom
(there still a problem apparently with the squeak vm in -current, so this
port doesn't actually work at present..).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2010/11/17 08:05:16 espie Exp $
a15 3
PERMIT_PACKAGE_FTP =	Yes
PERMIT_DISTFILES_CDROM =Yes
PERMIT_DISTFILES_FTP =	Yes
d22 1
a22 1
NO_REGRESS =		Yes
@


1.3
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2009/04/09 11:38:29 jasper Exp $
d6 1
@


1.2
log
@- missing build dependency
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2009/02/03 14:56:56 sthen Exp $
d19 2
a20 2
BUILD_DEPENDS=		::archivers/unzip
RUN_DEPENDS =		:squeak-vm-*:lang/squeak/vm
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d19 1
@


1.1.1.1
log
@import graphics/scratch:

A new programming language that makes it easy to create your own
interactive stories, animations, games, music, and art - and share your
creations on the web. Designed to help young people (ages 8 and up)
develop 21st century learning skills. As they create Scratch projects,
young people learn important mathematical and computational ideas, while
also gaining a deeper understanding of the process of design.

from maintainer Stuart Cassoff, with tweaks by me and input from
ajacoutot@@.
@
text
@@
