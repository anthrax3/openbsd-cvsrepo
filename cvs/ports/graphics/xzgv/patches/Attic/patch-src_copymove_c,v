head	1.3;
access;
symbols
	OPENBSD_4_5:1.2.0.14
	OPENBSD_4_5_BASE:1.2
	OPENBSD_4_4:1.2.0.12
	OPENBSD_4_4_BASE:1.2
	OPENBSD_4_3:1.2.0.10
	OPENBSD_4_3_BASE:1.2
	OPENBSD_4_2:1.2.0.8
	OPENBSD_4_2_BASE:1.2
	OPENBSD_4_1:1.2.0.6
	OPENBSD_4_1_BASE:1.2
	OPENBSD_4_0:1.2.0.4
	OPENBSD_4_0_BASE:1.2
	OPENBSD_3_9:1.2.0.2
	OPENBSD_3_9_BASE:1.2
	OPENBSD_3_8:1.1.1.1.0.2
	OPENBSD_3_8_BASE:1.1.1.1
	alek_20050522:1.1.1.1
	alek:1.1.1;
locks; strict;
comment	@# @;


1.3
date	2009.03.06.08.54.22;	author jasper;	state dead;
branches;
next	1.2;

1.2
date	2005.11.14.17.09.22;	author pvalchev;	state Exp;
branches;
next	1.1;

1.1
date	2005.05.22.11.32.11;	author alek;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2005.05.22.11.32.11;	author alek;	state Exp;
branches;
next	;


desc
@@


1.3
log
@- update xzgv to 0.9
* this makes this port switch to gtk+2, and get ride of ancient gtk+1
- update ${HOMEPAGE} and ${MASTER_SITES}

from Julian Leyh (MAINTAINER), thanks
@
text
@$OpenBSD: patch-src_copymove_c,v 1.2 2005/11/14 17:09:22 pvalchev Exp $
--- src/copymove.c.orig	Thu Nov 16 15:59:48 2000
+++ src/copymove.c	Thu May 12 15:31:52 2005
@@@@ -57,15 +57,17 @@@@ if(!cm_isdir(dstdir)) return(0);
 if((in=fopen(src,"rb"))==NULL)
   return(0);
 
-if((dst=malloc(strlen(dstdir)+strlen(src)+2))==NULL)	/* +2 for / and NUL */
+siz=strlen(dstdir)+strlen(src)+1; /* +2 for / and NUL */
+
+if((dst=malloc(siz))==NULL)
   return(0);
 
-strcpy(dst,dstdir);
-strcat(dst,"/");
+strlcpy(dst,dstdir,siz);
+strlcat(dst,"/",siz);
 if(strrchr(src,'/'))
-  strcat(dst,strrchr(src,'/')+1);
+  strlcat(dst,strrchr(src,'/')+1,siz);
 else
-  strcat(dst,src);
+  strlcat(dst,src,siz);
 
 /* check it doesn't already exist */
 if((out=fopen(dst,"rb"))!=NULL)
@@@@ -114,18 +116,21 @@@@ int movefile(char *src,char *dstdir)
 struct stat sbuf;
 struct utimbuf utbuf;
 char *dst;
+int siz;
 
 if(!cm_isdir(dstdir)) return(0);
 
-if((dst=malloc(strlen(dstdir)+strlen(src)+2))==NULL)	/* +2 for / and NUL */
+siz=strlen(dstdir)+strlen(src)+2; /* +2 for / and NUL */
+
+if((dst=malloc(siz))==NULL)
   return(0);
 
-strcpy(dst,dstdir);
-strcat(dst,"/");
+strlcpy(dst,dstdir,siz);
+strlcat(dst,"/",siz);
 if(strrchr(src,'/'))
-  strcat(dst,strrchr(src,'/')+1);
+  strlcat(dst,strrchr(src,'/')+1,siz);
 else
-  strcat(dst,src);
+  strlcat(dst,src,siz);
 
 /* fail if dest file already exists */
 if(stat(dst,&sbuf)==0)
@@@@ -328,9 +333,9 @@@@ for(done=f=0;f<numrows;f++)
   
   if(!(*copy_or_move_ptr)(ptr,destdir))
     {
-    sprintf(buf,"Error %s ",cm_do_move?"moving":"copying");
+    snprintf(buf,sizeof(buf),"Error %s ",cm_do_move?"moving":"copying");
     /* if it's a really big filename just say "file" :-) */
-    strcat(buf,(strlen(ptr)>100)?"file":ptr);
+    strlcat(buf,(strlen(ptr)>100)?"file":ptr,sizeof(buf));
     
     if(mainwin)
       {
@


1.2
log
@remove completely flawed strncmp patches
@
text
@d1 1
a1 1
$OpenBSD: patch-src_copymove_c,v 1.1.1.1 2005/05/22 11:32:11 alek Exp $
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
$OpenBSD$
a65 9
@@@@ -377,7 +382,7 @@@@ static void cb_ok_button(GtkWidget *butt
 char *ptr=gtk_entry_get_text(GTK_ENTRY(entry));
 int isdir;
 
-if(!ptr || *ptr==0 || strcmp(ptr,".")==0)
+if(!ptr || *ptr==0 || strncmp(ptr,".",2)==0)
   {
   gtk_widget_destroy(dir_win);
   return;
@


1.1.1.1
log
@Import xzgv 0.8

xzgv is a picture viewer for X, with a thumbnail-based file selector.
It uses GTK+ and Imlib. Most file formats are supported, and the
thumbnails used are compatible with xv, zgv, and the Gimp. It can also
be used with `xzgv file(s)', to effectively bypass the file selector.

From Julian Leyh <oenone@@oenone.de>
@
text
@@
