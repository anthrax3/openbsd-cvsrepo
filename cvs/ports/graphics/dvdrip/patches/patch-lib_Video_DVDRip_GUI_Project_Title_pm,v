head	1.1;
access;
symbols
	OPENBSD_6_1:1.1.0.16
	OPENBSD_6_1_BASE:1.1
	OPENBSD_6_0:1.1.0.14
	OPENBSD_6_0_BASE:1.1
	OPENBSD_5_9:1.1.0.10
	OPENBSD_5_9_BASE:1.1
	OPENBSD_5_8:1.1.0.12
	OPENBSD_5_8_BASE:1.1
	OPENBSD_5_7:1.1.0.8
	OPENBSD_5_7_BASE:1.1
	OPENBSD_5_6:1.1.0.6
	OPENBSD_5_6_BASE:1.1
	OPENBSD_5_5:1.1.0.4
	OPENBSD_5_5_BASE:1.1
	OPENBSD_5_4:1.1.0.2
	OPENBSD_5_4_BASE:1.1;
locks; strict;
comment	@# @;


1.1
date	2013.04.06.18.36.21;	author stsp;	state Exp;
branches;
next	;


desc
@@


1.1
log
@Update to dvdrip-0.98.11. Add missing run deps on subtitleripper and xine,
install .desktop icon, provide useful default for DVD device name, and make
drive close/eject buttons work. Also tweak the Linux-specific DVD mounting
code which is required for subtitle ripping -- it now supports an fstab entry
or automatically mounts at a temporary dir, both intended for use with sysctl
kern.usermount=1 since running dvdrip as root is... not recommended.
ok sthen@@
@
text
@$OpenBSD$
Fix DVD drive close/eject buttons.
--- lib/Video/DVDRip/GUI/Project/Title.pm.orig	Sat Feb 28 19:27:59 2009
+++ lib/Video/DVDRip/GUI/Project/Title.pm	Fri Apr  5 18:42:11 2013
@@@@ -431,12 +431,10 @@@@ sub view_title {
 sub eject_dvd {
     my $self = shift;
 
-    my $title = $self->selected_title;
+    my $dev = $self->project->dvd_device;
+    $dev =~ s/^\/dev\/(cd[0-9])[a-p]/\1/;
+    my $command = $self->config('eject_command') . " " . $dev;
 
-    my $command
-        = $self->config('eject_command') . " " .
-            $title->project->dvd_device;
-
     system("$command &");
 
     1;
@@@@ -445,10 +443,9 @@@@ sub eject_dvd {
 sub insert_dvd {
     my $self = shift;
 
-    my $title = $self->selected_title;
-
-    my $command = $self->config('eject_command') . " -t "
-        . $title->project->dvd_device;
+    my $dev = $self->project->dvd_device;
+    $dev =~ s/^\/dev\/(cd[0-9])[a-p]/\1/;
+    my $command = $self->config('eject_command') . " -t " . $dev;
 
     system("$command &");
 
@
