head	1.2;
access;
symbols
	OPENBSD_6_1:1.2.0.8
	OPENBSD_6_1_BASE:1.2
	OPENBSD_6_0:1.2.0.6
	OPENBSD_6_0_BASE:1.2
	OPENBSD_5_9:1.2.0.2
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.2.0.4
	OPENBSD_5_8_BASE:1.2
	OPENBSD_5_7:1.1.1.1.0.6
	OPENBSD_5_7_BASE:1.1.1.1
	OPENBSD_5_6:1.1.1.1.0.4
	OPENBSD_5_6_BASE:1.1.1.1
	OPENBSD_5_5:1.1.1.1.0.2
	OPENBSD_5_5_BASE:1.1.1.1
	sthen_20130925:1.1.1.1
	sthen:1.1.1;
locks; strict;
comment	@# @;


1.2
date	2015.03.27.11.34.23;	author sthen;	state Exp;
branches;
next	1.1;
commitid	XFfu8IlhUaexMZbX;

1.1
date	2013.09.25.07.49.50;	author sthen;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2013.09.25.07.49.50;	author sthen;	state Exp;
branches;
next	;


desc
@@


1.2
log
@update to giflib-5.1.1
@
text
@$OpenBSD: patch-tests_makefile,v 1.1.1.1 2013/09/25 07:49:50 sthen Exp $

#1, gmake-ism

#2, unsure if this is a test bug or a command-line parser bug, but the -p
value isn't read in the original order; same on Linux

#3, "head --bytes=-20" means "display most of the file, but trim last 20 bytes"
which isn't easily replicable with base tools, so just use ghead from coreutils

--- tests/makefile.orig	Wed May 14 19:17:54 2014
+++ tests/makefile	Tue Dec 30 14:41:31 2014
@@@@ -27,12 +27,12 @@@@ rebuild: render-rebuild \
 UTILS = ../util
 PICS = ../pic
 
-GIFS := $(shell ls ../pic/*.gif)
+GIFS := `ls ../pic/*.gif`
 
 # Test decompression and rendering by unpacking images,
 # converting them to RGB, and comparing that result to a check file.
 render-regress:
-	@@for test in $(GIFS); \
+	for test in $(GIFS); \
 	do \
 	    stem=`basename $${test} | sed -e "s/.gif$$//"`; \
 	    if echo "Testing RGB rendering of $${test}" >&2; \
@@@@ -103,10 +103,10 @@@@ giffilter-regress:
 
 giffix-rebuild:
 	@@echo "Rebuilding giffix test."
-	@@head --bytes=-20 <$(PICS)/treescap.gif | $(UTILS)/giffix 2>/dev/null | $(UTILS)/gifbuild -d >giffixed.ico
+	@@ghead --bytes=-20 <$(PICS)/treescap.gif | $(UTILS)/giffix 2>/dev/null | $(UTILS)/gifbuild -d >giffixed.ico
 giffix-regress:
 	@@echo "giffix: Testing giffix behavior"
-	@@head --bytes=-20 <$(PICS)/treescap.gif | $(UTILS)/giffix 2>/dev/null | $(UTILS)/gifbuild -d | diff -u giffixed.ico -
+	@@ghead --bytes=-20 <$(PICS)/treescap.gif | $(UTILS)/giffix 2>/dev/null | $(UTILS)/gifbuild -d | diff -u giffixed.ico -
 
 gifinto-regress:
 	@@echo "gifinto: Checking behavior on short files."
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
$OpenBSD$
d11 3
a13 3
--- tests/makefile.orig	Mon Sep 23 21:44:53 2013
+++ tests/makefile	Mon Sep 23 22:27:54 2013
@@@@ -29,12 +29,12 @@@@ rebuild: render-rebuild \
d28 1
a28 10
@@@@ -52,7 +52,7 @@@@ render-rebuild:
 
 gif2raw-regress:
 	@@echo "gif2raw: Checking that it can self-invert."
-	@@$(UTILS)/gif2raw <$(PICS)/treescap.gif | $(UTILS)/gif2raw -s 40 40 -p treescap.map | $(UTILS)/gif2rgb | cmp - treescap.rgb
+	@@$(UTILS)/gif2raw <$(PICS)/treescap.gif | $(UTILS)/gif2raw -p treescap.map -s 40 40 | $(UTILS)/gif2rgb | cmp - treescap.rgb
 
 gif2rgb-rebuild:
 	@@echo "Rebuilding gif2rgb checkfile."
@@@@ -109,10 +109,10 @@@@ giffilter-regress:
@


1.1.1.1
log
@import ports/graphics/giflib, current maintained code to replace libungif.
ok aja@@ jasper@@
@
text
@@
