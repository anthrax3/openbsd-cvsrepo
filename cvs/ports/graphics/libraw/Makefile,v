head	1.25;
access;
symbols
	OPENBSD_6_1:1.22.0.2
	OPENBSD_6_1_BASE:1.22
	OPENBSD_6_0:1.19.0.2
	OPENBSD_6_0_BASE:1.19
	OPENBSD_5_9:1.16.0.2
	OPENBSD_5_9_BASE:1.16
	OPENBSD_5_8:1.13.0.4
	OPENBSD_5_8_BASE:1.13
	OPENBSD_5_7:1.11.0.2
	OPENBSD_5_7_BASE:1.11
	OPENBSD_5_6:1.10.0.2
	OPENBSD_5_6_BASE:1.10
	OPENBSD_5_5:1.8.0.4
	OPENBSD_5_5_BASE:1.8
	OPENBSD_5_4:1.8.0.2
	OPENBSD_5_4_BASE:1.8
	OPENBSD_5_3:1.4.0.4
	OPENBSD_5_3_BASE:1.4
	OPENBSD_5_2:1.4.0.2
	OPENBSD_5_2_BASE:1.4
	OPENBSD_5_1_BASE:1.3
	OPENBSD_5_1:1.3.0.6
	OPENBSD_5_0:1.3.0.4
	OPENBSD_5_0_BASE:1.3
	OPENBSD_4_9:1.3.0.2
	OPENBSD_4_9_BASE:1.3
	OPENBSD_4_8:1.1.1.1.0.2
	OPENBSD_4_8_BASE:1.1.1.1
	phessler_20100723:1.1.1.1
	phessler:1.1.1;
locks; strict;
comment	@# @;


1.25
date	2017.07.03.17.29.06;	author rsadowski;	state Exp;
branches;
next	1.24;
commitid	ArwcKRKFXOh1xPnx;

1.24
date	2017.04.27.23.15.00;	author sthen;	state Exp;
branches;
next	1.23;
commitid	hnbqDWWNsEbCusPa;

1.23
date	2017.04.10.11.46.21;	author sthen;	state Exp;
branches;
next	1.22;
commitid	BLsh88fJB8thZTwY;

1.22
date	2017.03.14.02.57.27;	author jca;	state Exp;
branches;
next	1.21;
commitid	jNmoZdqyb5Mz31Ik;

1.21
date	2016.09.01.10.53.27;	author jasper;	state Exp;
branches;
next	1.20;
commitid	LdsIxWmxagN2Kq33;

1.20
date	2016.08.27.15.56.27;	author ajacoutot;	state Exp;
branches;
next	1.19;
commitid	XkS6k7XebcdeCfDb;

1.19
date	2016.03.11.19.59.15;	author naddy;	state Exp;
branches;
next	1.18;
commitid	pguKLBEFv33DrgKU;

1.18
date	2016.03.01.08.05.30;	author kirby;	state Exp;
branches;
next	1.17;
commitid	zLlArIuUsoq6HTVy;

1.17
date	2016.02.29.23.50.13;	author sthen;	state Exp;
branches;
next	1.16;
commitid	cYxsFEZLObfOSo5S;

1.16
date	2016.02.21.16.17.25;	author jsg;	state Exp;
branches;
next	1.15;
commitid	IZQsfcjAwN1evvTh;

1.15
date	2016.02.19.09.07.38;	author tobiasu;	state Exp;
branches;
next	1.14;
commitid	RT4UV4sw690KvalX;

1.14
date	2015.12.25.08.39.46;	author ajacoutot;	state Exp;
branches;
next	1.13;
commitid	lWzNW4D9TtO7X1J3;

1.13
date	2015.05.31.06.45.29;	author kirby;	state Exp;
branches;
next	1.12;
commitid	UHhT5aNLS6mNIBkE;

1.12
date	2015.05.22.11.31.15;	author ajacoutot;	state Exp;
branches;
next	1.11;
commitid	2khjHXfpTaOuNVcx;

1.11
date	2014.09.22.08.25.57;	author jasper;	state Exp;
branches
	1.11.2.1;
next	1.10;
commitid	KwGXyM7FPzPPCHK5;

1.10
date	2014.03.31.20.24.06;	author landry;	state Exp;
branches;
next	1.9;

1.9
date	2014.03.18.11.37.53;	author jasper;	state Exp;
branches;
next	1.8;

1.8
date	2013.06.18.18.39.58;	author sthen;	state Exp;
branches;
next	1.7;

1.7
date	2013.05.28.13.51.12;	author sthen;	state Exp;
branches;
next	1.6;

1.6
date	2013.03.21.08.45.18;	author ajacoutot;	state Exp;
branches;
next	1.5;

1.5
date	2013.03.11.11.10.54;	author espie;	state Exp;
branches;
next	1.4;

1.4
date	2012.02.26.15.07.39;	author ajacoutot;	state Exp;
branches
	1.4.4.1;
next	1.3;

1.3
date	2010.10.24.12.13.27;	author phessler;	state Exp;
branches;
next	1.2;

1.2
date	2010.08.22.12.12.26;	author phessler;	state Exp;
branches;
next	1.1;

1.1
date	2010.07.23.16.05.40;	author phessler;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2010.07.23.16.05.40;	author phessler;	state Exp;
branches;
next	;

1.4.4.1
date	2013.06.19.06.44.02;	author jasper;	state Exp;
branches;
next	;

1.11.2.1
date	2015.06.01.07.51.22;	author jasper;	state Exp;
branches;
next	;
commitid	HLsBt1IdEJ66zClb;


desc
@@


1.25
log
@update LibRaw to 0.18.2

 ok and nits (MASTER_SITES, kill MODGCC4_LANGS) from jca@@
@
text
@# $OpenBSD: Makefile,v 1.24 2017/04/27 23:15:00 sthen Exp $

BROKEN-hppa =		undefined reference to __sync_fetch_and_add_4

COMMENT =		library for reading RAW files

DISTNAME =		LibRaw-0.18.2
PKGNAME =		${DISTNAME:L}
CATEGORIES =		graphics

SHARED_LIBS +=  raw                  2.0      # 15.0
SHARED_LIBS +=  raw_r                2.0      # 15.0

HOMEPAGE =		https://www.libraw.org/

# LGPL v2.1 OR CDDL v1.0 OR their own
PERMIT_PACKAGE_CDROM =	Yes

WANTLIB += c jasper jpeg lcms2 m pthread ${LIBCXX}

MASTER_SITES =		https://www.libraw.org/data/

COMPILER =		gcc
# for atomic builtins (__sync_fetch_and_add_4)
MODGCC4_ARCHS =		arm

LIB_DEPENDS =		graphics/jasper \
			graphics/lcms2

SEPARATE_BUILD = 	Yes
CONFIGURE_STYLE =	gnu
CONFIGURE_ENV =		CPPFLAGS="-I${LOCALBASE}/include" \
			LDFLAGS="-L${LOCALBASE}/lib"

.include <bsd.port.mk>
@


1.24
log
@Don't hardcode libstdc++
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2017/04/10 11:46:21 sthen Exp $
d7 1
a7 2
V =			0.17.2
DISTNAME =		LibRaw-${V}
a8 1
REVISION =		0
d11 2
a12 2
SHARED_LIBS +=  raw                  1.0      # 15.0
SHARED_LIBS +=  raw_r                1.0      # 15.0
d14 1
a14 1
HOMEPAGE =		http://www.libraw.org/
d21 1
a21 1
MASTER_SITES =		http://www.libraw.org/data/
d23 1
a23 1
MODULES =		gcc4
a25 1
MODGCC4_LANGS =		c++
@


1.23
log
@use LIBCXX
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2017/03/14 02:57:27 jca Exp $
d10 1
@


1.22
log
@Use lang/gcc for atomic builtins on arm
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2016/09/01 10:53:27 jasper Exp $
d20 1
a20 1
WANTLIB += c jasper jpeg lcms2 m pthread stdc++
@


1.21
log
@retire sparc
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2016/08/27 15:56:27 ajacoutot Exp $
a2 1
BROKEN-arm =		undefined reference to __sync_fetch_and_add_4
d23 5
@


1.20
log
@Update to libraw-0.17.2.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2016/03/11 19:59:15 naddy Exp $
a4 1
BROKEN-sparc =		undefined reference to __sync_fetch_and_add_4
@


1.19
log
@garbage collect CONFIGURE_SHARED
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2016/03/01 08:05:30 kirby Exp $
a2 1
COMMENT =		library for reading RAW files
d7 3
a9 1
V =			0.17.1
d31 2
@


1.18
log
@enable SEPARATE_BUILD
ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2016/02/29 23:50:13 sthen Exp $
a29 1
CONFIGURE_ARGS =	${CONFIGURE_SHARED}
@


1.17
log
@update to LibRaw-0.17.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2016/02/21 16:17:25 jsg Exp $
d28 1
@


1.16
log
@Don't attempt to build on arm.  sync atomic builtins required.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2016/02/19 09:07:38 tobiasu Exp $
d8 1
a8 1
V =			0.16.0
a11 1
REVISION =		1
d13 2
a14 2
SHARED_LIBS +=  raw                  0.0      # 10.0
SHARED_LIBS +=  raw_r                0.0      # 10.0
@


1.15
log
@mark broken on sparc, missing atomic ops
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2015/12/25 08:39:46 ajacoutot Exp $
d4 1
@


1.14
log
@Remove some BROKEN markers for ports that should build now with the new libgcc
assisted built-in atomic ops for mips64.

from Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2015/05/31 06:45:29 kirby Exp $
d5 1
@


1.13
log
@fix CVE-2015-3885 for embedded dcraw.
reported by Sevan / Venture37 on ports@@, thanks
looks ok to kili@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2015/05/22 11:31:15 ajacoutot Exp $
a4 1
BROKEN-mips64 =		undefined reference to __sync_fetch_and_add_4
@


1.12
log
@"/usr/local/lib/pkgconfig/" is part of mtree(8).
Packages should not own this dir to prevent its deletion or a warning that it
cannot be removed because it's not empty at pkg_delete(1) time.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2014/09/22 08:25:57 jasper Exp $
d11 1
a11 1
REVISION =		0
@


1.11
log
@add mips64 to BROKEN list
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2014/03/31 20:24:06 landry Exp $
d11 1
@


1.11.2.1
log
@Security fixes for CVE-2015-3885
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2014/09/22 08:25:57 jasper Exp $
a8 1
REVISION =		0
@


1.10
log
@BROKEN-hppa =  undefined reference to __sync_fetch_and_add_4
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2014/03/18 11:37:53 jasper Exp $
d4 2
a5 1
BROKEN-hppa =	undefined reference to __sync_fetch_and_add_4
@


1.9
log
@update to libraw-0.16.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2013/06/18 18:39:58 sthen Exp $
d4 1
@


1.8
log
@patch libraw for CVE-2013-2126; incorrect error handling with broken full
colour images could result in a crash or possibly code execution
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2013/05/28 13:51:12 sthen Exp $
d5 1
a5 2
V =			0.14.8
REVISION =		0
d10 2
a11 2
SHARED_LIBS +=  raw                  0.0      # 5.0
SHARED_LIBS +=  raw_r                0.0      # 5.0
d18 1
a18 1
WANTLIB += c jasper lcms2 m pthread stdc++
a20 1
NO_TEST =		Yes
a24 1

a25 2
CONFIGURE_ENV =		CPPFLAGS="-I${LOCALBASE}/include" \
			 LDFLAGS="-L${LOCALBASE}/lib"
@


1.7
log
@update to latest 0.14.x libraw (N.B. 0.15.2 has a buffer overflow fix but it's
not yet clear whether this is in old code, or newly-added code for 0.15.x,
and 0.15.x changes API which breaks shotwell build).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2013/03/21 08:45:18 ajacoutot Exp $
d6 1
@


1.6
log
@USE_LIBTOOL=Yes is the default now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2013/03/11 11:10:54 espie Exp $
d5 1
a5 1
V =			0.14.5
@


1.5
log
@PERMIT_* / REGRESS -> TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2012/02/26 15:07:39 ajacoutot Exp $
a25 1
USE_LIBTOOL =		Yes
@


1.4
log
@Update to libraw-0.14.5.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2010/10/24 12:13:27 phessler Exp $
a16 3
PERMIT_PACKAGE_FTP =	Yes
PERMIT_DISTFILES_CDROM =Yes
PERMIT_DISTFILES_FTP =	Yes
d21 1
a21 1
NO_REGRESS =		Yes
@


1.4.4.1
log
@Security fix for CVE-2013-2126: incorrect error handling with broken full
colour images could result in a crash or possibly code execution
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2012/02/26 15:07:39 ajacoutot Exp $
a7 1
REVISION =		0
@


1.3
log
@use -fPIC so the library can be used in some other software (coming soon)
while here, adjust .pc file to be in the same style as other .pc files

bump REVISION

OK landry@@
@
text
@d1 2
a2 1
# $OpenBSD: Makefile,v 1.2 2010/08/22 12:12:26 phessler Exp $
d5 1
a5 1
V =			0.9.1
a7 1
REVISION =		1
d10 3
d21 2
d26 4
a29 1
#WANTLIB +=		c m pthread stdc++
d31 4
a34 10
pre-configure:
	@@cp ${FILESDIR}/raw.pc ${WRKBUILD}
	@@perl -pi -e 's,%%VERSION%%,${V},g' ${WRKBUILD}/raw.pc

do-install:
	${INSTALL_DATA_DIR} ${PREFIX}/include/libraw/
	${INSTALL_DATA} ${WRKBUILD}/libraw/* ${PREFIX}/include/libraw/
	${INSTALL_SCRIPT} ${WRKBUILD}/lib/libraw* ${PREFIX}/lib
	${INSTALL_DATA_DIR} ${PREFIX}/lib/pkgconfig/
	${INSTALL_SCRIPT} ${WRKBUILD}/raw.pc ${PREFIX}/lib/pkgconfig/
@


1.2
log
@add a pkg-config .pc file for libraw

makes other ports nicer to write
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2010/07/23 16:05:40 phessler Exp $
d7 1
a7 1
REVISION =		0
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.template,v 1.55 2008/08/23 15:28:00 ajacoutot Exp $
d4 2
a5 1
DISTNAME =		LibRaw-0.9.1
d7 1
d23 4
d31 2
@


1.1.1.1
log
@LibRaw is a library for reading RAW files obtained from digital photo
cameras (CRW/CR2, NEF, RAF, DNG, and others).

LibRaw is based on the source codes of the dcraw utility, where part of
drawbacks have already been eliminated and part will be fixed in future.
The users of the library are provided with API to be built into their
software programs.

requested by (and OK) landry@@ at c2k10....

(this time, imported into a better dir path)
@
text
@@
