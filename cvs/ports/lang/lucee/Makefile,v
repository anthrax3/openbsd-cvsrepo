head	1.5;
access;
symbols
	OPENBSD_6_2:1.5.0.2
	OPENBSD_6_2_BASE:1.5
	OPENBSD_6_1:1.3.0.2
	OPENBSD_6_1_BASE:1.3
	sthen_20160913:1.1.1.1
	sthen:1.1.1;
locks; strict;
comment	@# @;


1.5
date	2017.07.27.12.42.21;	author sthen;	state Exp;
branches;
next	1.4;
commitid	COoeyCQhrFDdsUdp;

1.4
date	2017.06.06.14.17.44;	author sthen;	state Exp;
branches;
next	1.3;
commitid	6IOdDmqjduC3hhe4;

1.3
date	2016.11.14.17.31.39;	author sthen;	state Exp;
branches;
next	1.2;
commitid	h94ldgd8QJDRQ0Ix;

1.2
date	2016.11.12.15.55.22;	author sthen;	state Exp;
branches;
next	1.1;
commitid	IIJGHccfGPcnhes3;

1.1
date	2016.09.13.16.24.37;	author sthen;	state Exp;
branches
	1.1.1.1;
next	;
commitid	rl4SYVGREOUdIe1B;

1.1.1.1
date	2016.09.13.16.24.37;	author sthen;	state Exp;
branches;
next	;
commitid	rl4SYVGREOUdIe1B;


desc
@@


1.5
log
@update to lucee-5.2.1.9
@
text
@# $OpenBSD: Makefile,v 1.4 2017/06/06 14:17:44 sthen Exp $

COMMENT=		JVM-based scripting language for web apps (open-source CFML)

V=			5.2.1.9
DISTNAME=		lucee-$V
EXTRACT_SUFX=		.war
DISTFILES=		${DISTNAME}${EXTRACT_SUFX}{$V}

CATEGORIES=		lang www

HOMEPAGE=		http://lucee.org/

MAINTAINER =		Stuart Henderson <sthen@@openbsd.org>

# LGPLv2.1
PERMIT_PACKAGE_CDROM=	Yes

MASTER_SITES =		http://cdn.lucee.org/rest/update/provider/war/

# doesn't actually need tomcat to build, but listing it here avoids
# wasting time on arch where it's unavailable
BUILD_DEPENDS=		archivers/unzip \
			${RUN_DEPENDS}
RUN_DEPENDS=		tomcat->=8,<9:www/tomcat/v8
SUBST_VARS=		CATALINA_BASE

NO_BUILD=		Yes
NO_TEST=		Yes
PKG_ARCH=		*

CATALINA_BASE=		/var/tomcat
PREFIX=			${CATALINA_BASE}

do-extract:
	mkdir ${WRKSRC}; cd ${WRKSRC}; unzip ${FULLDISTDIR}/${DISTNAME}${EXTRACT_SUFX}

# Avoid conflicting servlet names with any alternative version of Railo/Lucee
# that's installed via .WAR files. Idea from jamiekrug.com. In pre-patch to
# assist with patch/edit/update-patches cycle. Also strips horizontal
# whitespace at eol.
pre-patch:
	perl -pi -e 's,<servlet-name>,<servlet-name>PKG_,g;' \
	    -e 's,\h*\r*$$,,;' ${WRKSRC}/WEB-INF/web.xml
	echo >> ${WRKSRC}/WEB-INF/web.xml

post-patch:
	perl -pi -e 's,/var/tomcat/,${CATALINA_BASE}/,g' ${WRKSRC}/WEB-INF/web.xml

do-install:
	${INSTALL_DATA_DIR} ${PREFIX}/{lucee,lib,conf,webapps/lucee-default}
	cd ${WRKSRC} && pax -rw * ${PREFIX}/webapps/lucee-default
	mv ${PREFIX}/webapps/lucee-default/WEB-INF/lib/* ${PREFIX}/lib/
	rm -r ${PREFIX}/webapps/lucee-default/WEB-INF
	chown -R ${SHAREOWN}:${SHAREGRP} ${PREFIX}/*
	${INSTALL_DATA} ${WRKSRC}/WEB-INF/web.xml ${PREFIX}/conf/web-lucee.xml.dist

.include <bsd.port.mk>
@


1.4
log
@update to lucee-5.1.4.19
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2016/11/14 17:31:39 sthen Exp $
d5 1
a5 1
V=			5.1.4.19
@


1.3
log
@update to lucee-5.1.0.34 (moving to the 5.1-stable branch).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2016/11/12 15:55:22 sthen Exp $
d5 1
a5 1
V=			5.1.0.34
@


1.2
log
@update to Lucee 4.5.3.020
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2016/09/13 16:24:37 sthen Exp $
d3 1
a3 1
COMMENT=		open-source CFML engine
d5 1
a5 1
V=			4.5.3.020
d8 1
d19 1
a19 1
MASTER_SITES =		http://cdn.lucee.org/
d25 1
a25 1
RUN_DEPENDS=		tomcat->=7,<8:www/tomcat/v7
d36 1
a36 1
	mkdir ${WRKSRC}; cd ${WRKSRC}; unzip ${FULLDISTDIR}/${DISTFILES}
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2014/10/23 17:25:45 sthen Exp $
d5 1
a5 1
V=			4.5.3.018
@


1.1.1.1
log
@import ports/lang/lucee, to replace railo.  ok daniel@@ jca@@

Lucee is a light-weight dynamic scripting language for the JVM that
enables the rapid development of simple to highly sophisticated web
applications. Lucee is fully compatible with the CFML Script and Tag
Language.

Lucee is a JVM language and runs on the JVM as a servlet and will work
with any servlet container (e.g. Apache Tomcat, Eclipse Jetty) or
application server (e.g. JBoss AS, GlassFish). This package is setup
to run Lucee under Tomcat.
@
text
@@
