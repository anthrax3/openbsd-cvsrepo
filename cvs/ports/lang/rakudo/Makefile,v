head	1.31;
access;
symbols
	OPENBSD_6_0:1.29.0.2
	OPENBSD_6_0_BASE:1.29
	OPENBSD_5_9:1.27.0.2
	OPENBSD_5_9_BASE:1.27
	OPENBSD_5_8:1.21.0.4
	OPENBSD_5_8_BASE:1.21
	OPENBSD_5_7:1.20.0.2
	OPENBSD_5_7_BASE:1.20
	OPENBSD_5_6:1.19.0.4
	OPENBSD_5_6_BASE:1.19
	OPENBSD_5_5:1.19.0.2
	OPENBSD_5_5_BASE:1.19
	OPENBSD_5_4:1.18.0.2
	OPENBSD_5_4_BASE:1.18
	OPENBSD_5_3:1.16.0.2
	OPENBSD_5_3_BASE:1.16
	OPENBSD_5_2:1.13.0.2
	OPENBSD_5_2_BASE:1.13
	OPENBSD_5_1_BASE:1.10
	OPENBSD_5_1:1.10.0.2
	OPENBSD_5_0:1.6.0.2
	OPENBSD_5_0_BASE:1.6
	landry_20110320:1.1.1.1
	pstumpf:1.1.1;
locks; strict;
comment	@# @;


1.31
date	2017.03.07.21.21.51;	author pascal;	state Exp;
branches;
next	1.30;
commitid	62QD7laZF1CIuSA8;

1.30
date	2016.08.06.16.31.37;	author pascal;	state Exp;
branches;
next	1.29;
commitid	CBin5zPXFwtHC2fF;

1.29
date	2016.05.07.12.40.57;	author pascal;	state Exp;
branches;
next	1.28;
commitid	Fec0PsLcTwj1Q99H;

1.28
date	2016.03.16.16.46.32;	author naddy;	state Exp;
branches;
next	1.27;
commitid	4Ekn8nPgVVHWLTwe;

1.27
date	2015.12.28.09.30.07;	author pascal;	state Exp;
branches;
next	1.26;
commitid	1kEiVCrxPYt4zWHG;

1.26
date	2015.12.28.00.13.59;	author pascal;	state Exp;
branches;
next	1.25;
commitid	bInWYC1UzOBZWRUv;

1.25
date	2015.12.27.20.37.32;	author pascal;	state Exp;
branches;
next	1.24;
commitid	I8i5cVZUICeo4woI;

1.24
date	2015.12.10.18.01.06;	author pascal;	state Exp;
branches;
next	1.23;
commitid	M97tWicJ4FRlOw15;

1.23
date	2015.11.05.11.52.32;	author pascal;	state Exp;
branches;
next	1.22;
commitid	9XBltNRTkKND4ZwT;

1.22
date	2015.08.25.14.21.25;	author sthen;	state Exp;
branches;
next	1.21;
commitid	O1OzcgObqSjglEQi;

1.21
date	2015.04.09.17.35.55;	author pascal;	state Exp;
branches;
next	1.20;
commitid	jfqwEY2JC1osabl0;

1.20
date	2015.02.03.12.25.45;	author pascal;	state Exp;
branches;
next	1.19;
commitid	WpXitnW2csrg8bOV;

1.19
date	2013.11.25.14.16.23;	author sthen;	state Exp;
branches;
next	1.18;

1.18
date	2013.06.02.14.03.19;	author pascal;	state Exp;
branches;
next	1.17;

1.17
date	2013.03.11.11.20.28;	author espie;	state Exp;
branches;
next	1.16;

1.16
date	2012.12.07.08.44.05;	author ajacoutot;	state Exp;
branches;
next	1.15;

1.15
date	2012.11.05.17.57.51;	author pascal;	state Exp;
branches;
next	1.14;

1.14
date	2012.08.06.13.09.39;	author landry;	state Exp;
branches;
next	1.13;

1.13
date	2012.07.13.09.47.01;	author pascal;	state Exp;
branches;
next	1.12;

1.12
date	2012.05.09.13.51.35;	author pascal;	state Exp;
branches;
next	1.11;

1.11
date	2012.03.08.15.02.06;	author pascal;	state Exp;
branches;
next	1.10;

1.10
date	2011.11.13.16.07.09;	author pirofti;	state Exp;
branches;
next	1.9;

1.9
date	2011.10.19.13.31.58;	author ajacoutot;	state Exp;
branches;
next	1.8;

1.8
date	2011.10.17.08.00.51;	author ajacoutot;	state Exp;
branches;
next	1.7;

1.7
date	2011.08.20.16.47.54;	author landry;	state Exp;
branches;
next	1.6;

1.6
date	2011.05.22.20.23.27;	author landry;	state Exp;
branches;
next	1.5;

1.5
date	2011.04.12.13.48.57;	author jasper;	state Exp;
branches;
next	1.4;

1.4
date	2011.03.22.08.03.20;	author jasper;	state Exp;
branches;
next	1.3;

1.3
date	2011.03.22.08.02.55;	author jasper;	state Exp;
branches;
next	1.2;

1.2
date	2011.03.20.13.10.31;	author ajacoutot;	state Exp;
branches;
next	1.1;

1.1
date	2011.03.20.12.11.56;	author landry;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2011.03.20.12.11.56;	author landry;	state Exp;
branches;
next	;


desc
@@


1.31
log
@Update to Rakudo 2017.02.
@
text
@# $OpenBSD: Makefile,v 1.30 2016/08/06 16:31:37 pascal Exp $

COMMENT =		Rakudo Perl 6 compiler

V =			2017.02
DISTNAME =		rakudo-$V

NQP_VERSION =		2017.02

CATEGORIES =		lang perl6

HOMEPAGE =		http://rakudo.org

MAINTAINER =		Pascal Stumpf <pascal@@stumpf.co>

# Artistic 2
PERMIT_PACKAGE_CDROM =	Yes

WANTLIB += atomic_ops ffi kvm m moar pthread

GH_ACCOUNT =		rakudo
GH_PROJECT =		rakudo
GH_TAGNAME =		$V
MASTER_SITES =		${MASTER_SITES_GITHUB}

BUILD_DEPENDS =	lang/nqp>=${NQP_VERSION} \
		math/libtommath
LIB_DEPENDS =	lang/moarvm
RUN_DEPENDS =	lang/nqp>=${NQP_VERSION}

CONFIGURE_STYLE =	simple
CONFIGURE_SCRIPT =	/usr/bin/perl Configure.pl
CONFIGURE_ARGS +=	--prefix="${PREFIX}"

.include <bsd.port.mk>
@


1.30
log
@Update to 2016.07; similar diff from Caspar Schutijser.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2016/05/07 12:40:57 pascal Exp $
d5 1
a5 1
V =			2016.07.1
d8 1
a8 1
NQP_VERSION =		2016.07
@


1.29
log
@Update my mail address.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2016/03/16 16:46:32 naddy Exp $
d5 1
a5 1
V =			2015.12
a6 1
REVISION =		2
d8 1
a8 1
NQP_VERSION =		2015.12
@


1.28
log
@remove SHARED_ONLY from ports that don't use any MODULES
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2015/12/28 09:30:07 pascal Exp $
d7 1
a7 1
REVISION =		1
d15 1
a15 1
MAINTAINER =		Pascal Stumpf <Pascal.Stumpf@@cubes.de>
@


1.27
log
@previous was *still* not enough.  using checksums as filenames is apparently
a bad idea too ...
@
text
@d1 1
a1 3
# $OpenBSD: Makefile,v 1.26 2015/12/28 00:13:59 pascal Exp $

SHARED_ONLY =		Yes
@


1.26
log
@Upstream has decided to include a timestamp in certain filenames.  Comment out
the corresponding plist entries to at least get this to package until they
figure it out.

found the hard way by kili@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2015/12/27 20:37:32 pascal Exp $
d9 1
a9 1
REVISION =		0
@


1.25
log
@Update to 2015.12.  Fix from upstream to respect DESTDIR.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2015/12/10 18:01:06 pascal Exp $
d9 1
@


1.24
log
@Update to 2015.11, from Carl Bingham.  Kill duplicate LIB_DEPENDS, noticed
by sthen@@.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2015/11/05 11:52:32 pascal Exp $
d7 1
a7 1
V =			2015.11
d10 1
a10 1
NQP_VERSION =		2015.11
@


1.23
log
@Update to 2015.10; similar diff from Carlin Bingham.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2015/08/25 14:21:25 sthen Exp $
d7 1
a7 1
V =			2015.10
d10 1
a10 1
NQP_VERSION =		2015.10
a31 1
LIB_DEPENDS =	lang/moarvm
@


1.22
log
@WANTLIB/LIB_DEPENDS
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2015/04/09 17:35:55 pascal Exp $
d7 1
a7 2
V =			2015.03
REVISION =		0
d10 1
a10 1
NQP_VERSION =		2015.03
d21 1
a21 1
WANTLIB += atomic_ops kvm m moar pthread
d28 3
a30 1
BUILD_DEPENDS =	lang/nqp>=${NQP_VERSION}
@


1.21
log
@Update to rakudo 2015.03, on MoarVM.  This port is no longer based on the
'star' distribution, but on plain rakudo.  Module precompilation at the
fake stage is too ugly and brittle, and upstream encourages packagers to
provide modules as individual packages.

So here's a bare-bones rakudo.  Panda and other stuff will follow eventually.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2015/02/03 12:25:45 pascal Exp $
d8 1
d22 2
d31 1
@


1.20
log
@Missing RUN_DEPENDS on nqp, noticed by landry@@.
@
text
@d1 1
a1 5
# $OpenBSD: Makefile,v 1.19 2013/11/25 14:16:23 sthen Exp $

# Memory hog, stuck for days on the same file during build.
NOT_FOR_ARCHS =		sh
BROKEN-sparc64 =	error:imcc:syntax error, unexpected IF
d7 4
a10 9
PORTNAME =		rakudo
V =			2013.05
DISTNAME =		rakudo-star-$V
PKGNAME =		rakudo-$V
REVISION =		0

PARROT_VERSION =	5.4.0
NQP_VERSION =		2013.05
SUBST_VARS +=		PARROT_VERSION
d21 4
a24 4
WANTLIB = 		c gmp icudata icuuc m ncurses parrot pthread
WANTLIB += 		readline stdc++ util ffi

MASTER_SITES =		${HOMEPAGE}/downloads/star/
d26 2
a27 7
BUILD_DEPENDS =		lang/nqp>=${NQP_VERSION}
RUN_DEPENDS =		lang/nqp>=${NQP_VERSION}
LIB_DEPENDS =		lang/parrot>=${PARROT_VERSION} \
			textproc/icu4c

FAKE_FLAGS =		PERL6LIB="${WRKINST}${PREFIX}/lib/parrot/${PARROT_VERSION}/languages/nqp/lib:${WRKINST}${PREFIX}/lib/parrot/${PARROT_VERSION}/languages/perl6/lib"
FAKE_FLAGS +=		LD_LIBRARY_PATH="${WRKINST}${PREFIX}/lib/parrot/${PARROT_VERSION}/dynext"
d31 1
a31 15
CONFIGURE_ARGS +=	--prefix="${PREFIX}" \
			--with-nqp="${LOCALBASE}/bin/nqp"

TEST_TARGET =	rakudo-test rakudo-spectest

post-install:
	cd ${WRKSRC}/docs && ${INSTALL_DATA} UsingPerl6-draft.pdf \
		cheatsheet.txt ${PREFIX}/share/doc/rakudo
	cd ${WRKSRC}/docs/announce && ${INSTALL_DATA} * \
		${PREFIX}/share/doc/rakudo/announce

pre-test:
	#no need to check out git repository
	perl -pi -e 's/spectest_checkout spectest_update// if /^testable/' \
		${WRKSRC}/rakudo-$V/Makefile
@


1.19
log
@kill VMEM_WARNING
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2013/06/02 14:03:19 pascal Exp $
d15 1
d36 1
@


1.18
log
@Update to 2013.05; ok landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2013/03/11 11:20:28 espie Exp $
a30 2

VMEM_WARNING =		Yes
@


1.17
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2012/12/07 08:44:05 ajacoutot Exp $
a5 1
BROKEN-powerpc =	exists_keyed_str() not implemented in class 'NQPMu'
d12 3
a14 3
VERSION =		2012.10
DISTNAME =		${PORTNAME}-star-${VERSION}
PKGNAME =		${PORTNAME}-${VERSION}
d16 2
a17 1
PARROT_VERSION =	4.9.0
d22 1
a22 1
HOMEPAGE =		http://rakudo.org/
d34 1
a34 1
MASTER_SITES =		http://cloud.github.com/downloads/rakudo/star/
d36 1
a36 1
BUILD_DEPENDS =		lang/nqp
a45 1
			--with-parrot="${LOCALBASE}/bin/parrot" \
d59 1
a59 1
		${WRKSRC}/rakudo-${VERSION}/Makefile
@


1.16
log
@This has been BROKEN forever on powerpc, exists_keyed_str() not implemented in class 'NQPMu'.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2012/11/05 17:57:51 pascal Exp $
a27 3
PERMIT_PACKAGE_FTP =	Yes
PERMIT_DISTFILES_CDROM =Yes
PERMIT_DISTFILES_FTP =	Yes
d49 1
a49 1
REGRESS_TARGET =	rakudo-test rakudo-spectest
d57 1
a57 1
pre-regress:
@


1.15
log
@Update to parrot 4.9.0, nqp/rakudo 2012.10.  Tested on amd64/powerpc.  Still
broken on sparc64 (though differently), tested by landry@@.

ok landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2012/08/06 13:09:39 landry Exp $
d6 1
@


1.14
log
@Mark as BROKEN-sparc64, almost killed the build machine..
ok sthen@@ a while ago.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2012/07/13 09:47:01 pascal Exp $
d5 1
a5 1
BROKEN-sparc64 =	build stuck on CORE.setting.pir generation
d12 2
a13 2
VERSION =		2012.06
DISTNAME =		${PORTNAME}-star-${VERSION:S/.1//}
d16 1
a16 1
PARROT_VERSION =	4.5.0
@


1.13
log
@Update to rakudo 2012.06.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2012/05/09 13:51:35 pascal Exp $
d5 1
@


1.12
log
@Update to rakudo 2012.04.1.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2012/03/08 15:02:06 pascal Exp $
d11 1
a11 1
VERSION =		2012.04.1
d15 1
a15 1
PARROT_VERSION =	4.3.0
d31 1
a31 1
WANTLIB += 		readline stdc++ util
@


1.11
log
@Update to rakudo 2012.02.

sparc64 testing and ok landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2011/11/13 16:07:09 pirofti Exp $
d11 2
a12 2
VERSION =		2012.02
DISTNAME =		${PORTNAME}-star-${VERSION}
d15 1
a15 1
PARROT_VERSION =	4.1.0
@


1.10
log
@Disable on landisk. Takes forever to build. Okay ajacoutot@@.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2011/10/19 13:31:58 ajacoutot Exp $
d6 2
d11 1
a11 1
VERSION =		2011.07
d15 1
a15 1
PARROT_VERSION =	3.6.0
d30 1
a30 1
WANTLIB = 		c icudata icui18n icuuc m ncurses parrot pthread
d37 1
d41 2
a42 1
FAKE_FLAGS =		PERL6LIB="${WRKINST}${PREFIX}/lib/parrot/${PARROT_VERSION}/languages/perl6/lib"
d46 3
a48 2
CONFIGURE_ARGS +=	--prefix=${PREFIX} \
			--parrot-config="${LOCALBASE}/bin/parrot_config"
d61 1
a61 1
		${WRKSRC}/rakudo/Makefile
@


1.9
log
@Remove BROKEN on powerpc now that parrot has been fixed.
@
text
@d1 4
a4 1
# $OpenBSD: Makefile,v 1.8 2011/10/17 08:00:51 ajacoutot Exp $
@


1.8
log
@This has been broken forever on powerpc, so mark it as such.
@
text
@d1 1
a1 3
# $OpenBSD: Makefile,v 1.7 2011/08/20 16:47:54 landry Exp $

BROKEN-powerpc =	does not package (Model.pir does not exist)
@


1.7
log
@Update to rakudo 2011-07, from maintainer Pascal Stumpf.
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.6 2011/05/22 20:23:27 landry Exp $
@


1.6
log
@Update to rakudo 2011.04 from maintainer Pascal Stumpf.
Use ${PARROT_VERSION} in PLIST to avoid churn upon next update.
Tested on amd64/ppc by myself.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2011/04/12 13:48:57 jasper Exp $
d6 1
a6 1
VERSION =		2011.04
d10 1
a10 1
PARROT_VERSION =	3.3.0
d32 1
a32 1
LIB_DEPENDS =		lang/parrot=3.3.0 \
@


1.5
log
@add VMEM_WARNING

ok landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2011/03/22 08:03:20 jasper Exp $
d6 1
a6 1
VERSION =		2011.01
d10 2
a11 1
REVISION =		1
d15 1
a15 1
HOMEPAGE =		http://rakudo.org
d25 1
a25 1
WANTLIB = 		c icudata icui18n icuuc m ncurses parrot=1.0 pthread
d32 1
a32 1
LIB_DEPENDS =		lang/parrot=3.0.0 \
d34 2
@


1.4
log
@unfuck rcs id too
@
text
@d1 1
a1 1
# $OpenBSD$
d27 1
@


1.3
log
@- fix libspec for parrot which was backwards (1.0 vs 0.1)
@
text
@d1 1
a1 1
# $OpenBSD
@


1.2
log
@Lowercase COMMENT.
@
text
@d10 1
a10 1
REVISION =		0
d24 1
a24 1
WANTLIB = 		c icudata icui18n icuuc m ncurses parrot=0.1 pthread
@


1.1
log
@Initial revision
@
text
@d3 1
a3 1
COMMENT =		Rakudo Perl 6 Compiler
d9 2
@


1.1.1.1
log
@Import rakudo 2011.01:

Rakudo is an implementation of the Perl 6 programming language, based on
the Parrot VM.

From MAINTAINER Pascal Stumpf (thanks!), joint testing on
arm/mips64el by kili & sparc64/ppc by me.
@
text
@@
