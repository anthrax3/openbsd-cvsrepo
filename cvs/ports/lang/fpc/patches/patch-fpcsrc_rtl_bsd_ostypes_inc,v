head	1.2;
access;
symbols
	OPENBSD_6_2:1.2.0.8
	OPENBSD_6_2_BASE:1.2
	OPENBSD_6_1:1.2.0.6
	OPENBSD_6_1_BASE:1.2
	OPENBSD_6_0:1.2.0.4
	OPENBSD_6_0_BASE:1.2
	OPENBSD_5_9:1.2.0.2
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.1.0.10
	OPENBSD_5_8_BASE:1.1
	OPENBSD_5_7:1.1.0.6
	OPENBSD_5_7_BASE:1.1
	OPENBSD_5_6:1.1.0.4
	OPENBSD_5_6_BASE:1.1
	OPENBSD_5_5:1.1.0.2
	OPENBSD_5_5_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2015.12.22.14.43.55;	author pascal;	state Exp;
branches;
next	1.1;
commitid	5iH5WYNU9sfWWqkb;

1.1
date	2013.08.18.09.21.59;	author pascal;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Update to FPC 3.0.0.  Bootstrap hosted by aja@@, thanks!
@
text
@$OpenBSD: patch-fpcsrc_rtl_bsd_ostypes_inc,v 1.1 2013/08/18 09:21:59 pascal Exp $

Adjust for struct changes.

--- fpcsrc/rtl/bsd/ostypes.inc.orig	Sun Dec  7 21:27:02 2014
+++ fpcsrc/rtl/bsd/ostypes.inc	Thu Nov 26 15:20:29 2015
@@@@ -87,6 +87,9 @@@@ TYPE
         st_qspare1    : cint64;            // was recursive change detect
         st_qspare2    : cint64;
 {$else dragonfly}
+{$ifdef openbsd}
+	st_mode       : mode_t;             // inode protection mode
+{$endif}
         st_dev        : dev_t;             // inode's device
 {$ifdef darwinarm}
         st_mode       : mode_t;            // inode protection mode
@@@@ -99,16 +102,15 @@@@ TYPE
         st_ino        : ino_t;             // inode's number
 {$else not netbsd}
         st_ino        : ino_t;             // inode's number
+{$ifndef openbsd}
         st_mode       : mode_t;            // inode protection mode
+{$endif}
 {$endif not netbsd}
         st_nlink      : nlink_t;           // number of hard links
 {$endif}
         st_uid        : uid_t;             // user ID of the file's owner
         st_gid        : gid_t;             // group ID of the file's group
         st_rdev       : dev_t;             // device type
-{$ifdef openbsd}
-        st_padd0      : cint;
-{$endif}
         st_atime      : time_t;            // time of last access
         st_atimensec  : clong;             // nsec of last access
         st_mtime      : time_t;            // time of last data modification
@@@@ -146,10 +148,18 @@@@ TYPE
   { directory services }
 {$ifndef darwinarm}
    dirent  = record
+{$ifdef openbsd}
+	d_fileno      : ino_t;
+	d_off         : off_t;
+{$else}
         d_fileno      : cuint32;                        // file number of entry
+{$endif}
         d_reclen      : cuint16;                        // length of this record
         d_type        : cuint8;                         // file type, see below
         d_namlen      : cuint8;                         // length of string in d_name
+{$ifdef openbsd}
+	d_padding     : array[1..4] of cuint8;
+{$endif}
         d_name        : array[0..(255 + 1)-1] of char;  // name must be no longer than this
    end;
 {$else not darwinarm}
@@@@ -174,6 +184,11 @@@@ TYPE
         dd_size   : clong;        // amount of data returned by getdirentries
         dd_buf    : pchar;        // data buffer
         dd_len    : cint;         // size of data buffer
+{$ifdef openbsd}
+	dd_curpos : off_t;
+	dd_lock   : pointer;
+	dd_rewind : clong;
+{$else}
 {$ifdef netbsdpowerpc}
         dd_pad1   : cint;
         dd_seek   : cint64;        // magic cookie returned by getdirentries
@@@@ -186,6 +201,7 @@@@ TYPE
         __dd_lock : pthread_mutex_t; // for thread locking
         __dd_td : pointer;        // telldir position recording
 {$endif}
+{$endif not openbsd}
    end;
    TDir    = dir;
    pDir    = ^dir;
@


1.1
log
@Adjust FPC to recent ABI changes and regenerate bootstrap.  Work started by
sthen@@; it just needed some more tweaks.  Again, bootstrap hosted by aja@@ -
thanks!
@
text
@d1 1
a1 1
$OpenBSD$
d5 6
a10 6
--- fpcsrc/rtl/bsd/ostypes.inc.orig	Sun Apr 22 22:13:48 2012
+++ fpcsrc/rtl/bsd/ostypes.inc	Sat Aug 17 11:13:38 2013
@@@@ -63,6 +63,9 @@@@ TYPE
 
   { file characteristics services }
    stat    = record { the types are real}
d12 1
a12 1
+        st_mode       : mode_t;            // inode protection mode
d17 1
a17 1
@@@@ -75,16 +78,15 @@@@ TYPE
d36 1
a36 1
@@@@ -121,10 +123,16 @@@@ TYPE
a39 2
-        d_fileno      : cuint32;                        // file number of entry
+        d_fileno      : ino_t;                        // file number of entry
d41 1
d43 2
d55 1
a55 1
@@@@ -149,6 +157,11 @@@@ TYPE
d67 1
a67 1
@@@@ -161,6 +174,7 @@@@ TYPE
@

