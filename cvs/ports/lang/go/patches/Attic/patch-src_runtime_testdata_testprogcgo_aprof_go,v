head	1.2;
access;
symbols
	OPENBSD_6_0:1.1.0.2
	OPENBSD_6_0_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2016.08.18.17.23.03;	author jsing;	state dead;
branches;
next	1.1;
commitid	3gjN7l5yQTvsZq8b;

1.1
date	2016.05.20.16.03.24;	author jsing;	state Exp;
branches;
next	;
commitid	7lG7DXdVZBlxCNbt;


desc
@@


1.2
log
@Upgrade lang/go to 1.7.

ok czarkoff@@ pea@@
@
text
@$OpenBSD: patch-src_runtime_testdata_testprogcgo_aprof_go,v 1.1 2016/05/20 16:03:24 jsing Exp $
--- src/runtime/testdata/testprogcgo/aprof.go.orig	Sat May 21 01:03:57 2016
+++ src/runtime/testdata/testprogcgo/aprof.go	Sat May 21 01:04:29 2016
@@@@ -17,6 +17,7 @@@@ import (
 	"bytes"
 	"fmt"
 	"runtime/pprof"
+	"time"
 )
 
 func init() {
@@@@ -31,7 +32,13 @@@@ func CgoCCodeSIGPROF() {
 	go func() {
 		for {
 			<-c
+			start := time.Now()
 			for i := 0; i < 1e7; i++ {
+				if i%1000 == 0 {
+					if time.Since(start) > time.Second {
+						break
+					}
+				}
 				C.GoNop()
 			}
 			c <- true
@


1.1
log
@Update lang/go to 1.6.2.
@
text
@d1 1
a1 1
$OpenBSD$
@

