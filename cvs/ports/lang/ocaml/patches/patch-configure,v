head	1.21;
access;
symbols
	OPENBSD_6_1:1.21.0.2
	OPENBSD_6_1_BASE:1.21
	OPENBSD_6_0:1.20.0.2
	OPENBSD_6_0_BASE:1.20
	OPENBSD_5_9:1.19.0.4
	OPENBSD_5_9_BASE:1.19
	OPENBSD_5_8:1.19.0.6
	OPENBSD_5_8_BASE:1.19
	OPENBSD_5_7:1.19.0.2
	OPENBSD_5_7_BASE:1.19
	OPENBSD_5_6:1.17.0.4
	OPENBSD_5_6_BASE:1.17
	OPENBSD_5_5:1.17.0.2
	OPENBSD_5_5_BASE:1.17
	OPENBSD_5_4:1.16.0.4
	OPENBSD_5_4_BASE:1.16
	OPENBSD_5_3:1.16.0.2
	OPENBSD_5_3_BASE:1.16
	OPENBSD_5_2:1.14.0.8
	OPENBSD_5_2_BASE:1.14
	OPENBSD_5_1_BASE:1.14
	OPENBSD_5_1:1.14.0.6
	OPENBSD_5_0:1.14.0.4
	OPENBSD_5_0_BASE:1.14
	OPENBSD_4_9:1.14.0.2
	OPENBSD_4_9_BASE:1.14
	OPENBSD_4_8:1.12.0.2
	OPENBSD_4_8_BASE:1.12
	OPENBSD_4_7:1.11.0.4
	OPENBSD_4_7_BASE:1.11
	OPENBSD_4_6:1.11.0.2
	OPENBSD_4_6_BASE:1.11
	OPENBSD_4_5:1.10.0.10
	OPENBSD_4_5_BASE:1.10
	OPENBSD_4_4:1.10.0.8
	OPENBSD_4_4_BASE:1.10
	OPENBSD_4_3:1.10.0.6
	OPENBSD_4_3_BASE:1.10
	OPENBSD_4_2:1.10.0.4
	OPENBSD_4_2_BASE:1.10
	OPENBSD_4_1:1.10.0.2
	OPENBSD_4_1_BASE:1.10
	OPENBSD_4_0:1.9.0.2
	OPENBSD_4_0_BASE:1.9
	OPENBSD_3_9:1.8.0.4
	OPENBSD_3_9_BASE:1.8
	OPENBSD_3_8:1.8.0.2
	OPENBSD_3_8_BASE:1.8
	OPENBSD_3_7:1.6.0.4
	OPENBSD_3_7_BASE:1.6
	OPENBSD_3_6:1.6.0.2
	OPENBSD_3_6_BASE:1.6
	OPENBSD_3_5:1.5.0.2
	OPENBSD_3_5_BASE:1.5
	OPENBSD_3_4:1.2.0.6
	OPENBSD_3_4_BASE:1.2
	OPENBSD_3_3:1.2.0.4
	OPENBSD_3_3_BASE:1.2
	OPENBSD_3_2:1.2.0.2
	OPENBSD_3_2_BASE:1.2;
locks; strict;
comment	@# @;


1.21
date	2016.09.07.10.02.59;	author jasper;	state Exp;
branches;
next	1.20;
commitid	5Td9kF5wcdaSXoGW;

1.20
date	2016.06.24.15.59.12;	author krw;	state Exp;
branches;
next	1.19;
commitid	uNq7PAnG26SO2XnT;

1.19
date	2014.10.25.11.55.54;	author chrisz;	state Exp;
branches;
next	1.18;
commitid	iFA3dUi7gSvf6rCS;

1.18
date	2014.09.02.09.24.44;	author chrisz;	state Exp;
branches;
next	1.17;
commitid	KxJKmDEHHsyD4e4B;

1.17
date	2013.11.25.14.40.15;	author dcoppa;	state Exp;
branches;
next	1.16;

1.16
date	2012.11.01.07.57.26;	author avsm;	state Exp;
branches;
next	1.15;

1.15
date	2012.08.18.21.49.16;	author avsm;	state Exp;
branches;
next	1.14;

1.14
date	2010.12.17.18.42.04;	author dcoppa;	state Exp;
branches;
next	1.13;

1.13
date	2010.12.07.15.01.35;	author dcoppa;	state Exp;
branches;
next	1.12;

1.12
date	2010.06.04.13.58.18;	author avsm;	state Exp;
branches;
next	1.11;

1.11
date	2009.03.11.21.19.49;	author avsm;	state Exp;
branches;
next	1.10;

1.10
date	2007.02.08.14.32.57;	author avsm;	state Exp;
branches;
next	1.9;

1.9
date	2006.05.28.15.28.54;	author avsm;	state Exp;
branches;
next	1.8;

1.8
date	2005.05.28.20.55.45;	author avsm;	state Exp;
branches;
next	1.7;

1.7
date	2005.05.09.13.50.41;	author avsm;	state Exp;
branches;
next	1.6;

1.6
date	2004.06.22.18.14.44;	author avsm;	state Exp;
branches;
next	1.5;

1.5
date	2004.03.05.21.54.36;	author avsm;	state Exp;
branches;
next	1.4;

1.4
date	2004.01.25.17.02.59;	author sturm;	state Exp;
branches;
next	1.3;

1.3
date	2003.12.31.17.05.28;	author sturm;	state Exp;
branches;
next	1.2;

1.2
date	2002.09.12.17.02.47;	author pvalchev;	state Exp;
branches;
next	1.1;

1.1
date	2002.08.25.20.44.40;	author naddy;	state Exp;
branches;
next	;


desc
@@


1.21
log
@remove handling of zaurus
@
text
@$OpenBSD: patch-configure,v 1.20 2016/06/24 15:59:12 krw Exp $
--- configure.orig	Mon Apr 25 15:36:01 2016
+++ configure	Wed Sep  7 12:02:30 2016
@@@@ -839,6 +839,7 @@@@ case "$target" in
   s390x*-*-linux*)              arch=s390x; model=z10; system=elf;;
   armv6*-*-linux-gnueabihf)     arch=arm; model=armv6; system=linux_eabihf;;
   arm*-*-linux-gnueabihf)       arch=arm; system=linux_eabihf;;
+  arm*-*-openbsd*)              arch=arm; system=bsd;;
   armv7*-*-linux-gnueabi)       arch=arm; model=armv7; system=linux_eabi;;
   armv6t2*-*-linux-gnueabi)     arch=arm; model=armv6t2; system=linux_eabi;;
   armv6*-*-linux-gnueabi)       arch=arm; model=armv6; system=linux_eabi;;
@@@@ -1673,11 +1674,11 @@@@ echo "X11_LINK=$x11_link" >> Makefile
 
 # Look for BFD library
 
-if sh ./hasgot -DPACKAGE=ocaml -i bfd.h && \
-   sh ./hasgot -DPACKAGE=ocaml -lbfd -ldl -liberty -lz bfd_openr; then
+if sh ./hasgot -I${OPENBSD_LOCALBASE}/include -DPACKAGE=ocaml -i bfd.h && \
+   sh ./hasgot -L${OPENBSD_LOCALBASE}/lib -DPACKAGE=ocaml -lbfd -liberty -lz bfd_openr; then
   inf "BFD library found."
   echo "#define HAS_LIBBFD" >> s.h
-  echo "LIBBFD_LINK=-lbfd -ldl -liberty -lz" >> Makefile
+  echo "LIBBFD_LINK=-I${OPENBSD_LOCALBASE}/include -L${OPENBSD_LOCALBASE}/lib -lbfd -liberty -lz" >> Makefile
   echo LIBBFD_INCLUDE= >>Makefile
 elif sh ./hasgot -DPACKAGE=ocaml -I/opt/local/include -i bfd.h && \
      sh ./hasgot -DPACKAGE=ocaml -L/opt/local/lib -lbfd -ldl \
@


1.20
log
@Upgrade Ocaml to 4.3.0 and tweak ports the minimal amount to keep
them all compiling.

Tweaks include updating

ocaml-batteries 2.3.1 -> 2.5.0
ocaml-lwt 2.4.8 -> 2.5.2
ocaml-ppx-tools 0.99.2 -> 4.03.0
ocaml-camlp4 4.02+6 -> 4.03+1
utop 1.15 -> 1.19.2

and fixes to coccinelle and wyrd to let them build on bytecode archs.

Other necessary tweaks from the various homes of the projects.

Everything still builds on amd64 (native and bytecode) and sparc64 (bytecode).

ok anil@@ sthen@@ so final 4.3.0 tweaks can be done in-tree.
@
text
@d1 4
a4 4
$OpenBSD: patch-configure,v 1.19 2014/10/25 11:55:54 chrisz Exp $
--- configure.orig	Mon Apr 25 09:36:01 2016
+++ configure	Wed May 18 13:01:05 2016
@@@@ -839,6 +839,8 @@@@
a8 1
+  zaurus*-*-openbsd*)           arch=arm; system=bsd;;
d12 1
a12 1
@@@@ -1673,11 +1675,11 @@@@
@


1.19
log
@update to OCaml 4.02.1.
Tested upgrade from 4.02.0 without revision bumping other packages.

ok avsm@@. espie@@ had a look -> no revision bumps needed.
@
text
@d1 5
a5 5
$OpenBSD: patch-configure,v 1.18 2014/09/02 09:24:44 chrisz Exp $
--- configure.orig	Fri Oct  3 21:25:46 2014
+++ configure	Sat Oct 18 12:19:58 2014
@@@@ -822,6 +822,8 @@@@ case "$target" in
                                 if $arch64;then model=ppc64;else model=ppc;fi;;
d13 1
a13 1
@@@@ -1602,11 +1604,11 @@@@ echo "X11_LINK=$x11_link" >> Makefile
d25 3
a27 3
 else
   wrn "BFD library not found, 'objinfo' will be unable to display info on .cmxs files."
   echo "LIBBFD_LINK=" >> Makefile
@


1.18
log
@Upgrade OCaml to 4.02. Since camlp4 is now a seperate port,
add / change BUILD_DEPENDS for all ports using camlp4.
Findlib is changed because it won't use camlp4 and doesn't install
the Bytes module anymore, which is now included in OCaml 4.02.

ok avsm@@
@
text
@d1 4
a4 4
$OpenBSD$
--- configure.orig	Sun Aug 31 21:04:23 2014
+++ configure	Sun Aug 31 21:06:35 2014
@@@@ -816,6 +816,8 @@@@ case "$target" in
d13 1
a13 11
@@@@ -1324,7 +1326,8 @@@@ fi
 # Determine if system stack overflows can be detected
 
 case "$arch,$system" in
-  i386,linux_elf|amd64,linux|power,rhapsody|amd64,macosx|i386,macosx)
+  i386,linux_elf|amd64,linux|power,rhapsody|amd64,macosx|i386,macosx| \
+  amd64,openbsd|i386,bsd_elf)
     inf "System stack overflow can be detected."
     echo "#define HAS_STACK_OVERFLOW_DETECTION" >> s.h;;
   *)
@@@@ -1581,11 +1584,11 @@@@ echo "X11_LINK=$x11_link" >> Makefile
d17 4
a20 4
-if ./hasgot -i bfd.h && \
-   ./hasgot -lbfd -ldl -liberty -lz bfd_openr; then
+if ./hasgot -I${OPENBSD_LOCALBASE}/include -DPACKAGE=ocaml -i bfd.h && \
+   ./hasgot -L${OPENBSD_LOCALBASE}/lib -DPACKAGE=ocaml -lbfd -liberty -lz bfd_openr; then
@


1.17
log
@Update to ocaml-4.01.0

Tested in a bulk build by landry@@
@
text
@d1 4
a4 19
$OpenBSD: patch-configure,v 1.16 2012/11/01 07:57:26 avsm Exp $
--- configure.orig	Wed Nov 13 16:47:53 2013
+++ configure	Wed Nov 13 16:55:03 2013
@@@@ -649,11 +649,11 @@@@ if test $withsharedlibs = "yes"; then
     sparc*-*-linux*)              natdynlink=true;;
     i686-*-kfreebsd*)             natdynlink=true;;
     x86_64-*-kfreebsd*)           natdynlink=true;;
-    i[345]86-*-freebsd*)          natdynlink=true;;
+    i[3456]86-*-freebsd*)          natdynlink=true;;
     x86_64-*-freebsd*)            natdynlink=true;;
-    i[345]86-*-openbsd*)          natdynlink=true;;
+    i[3456]86-*-openbsd*)          natdynlink=true;;
     x86_64-*-openbsd*)            natdynlink=true;;
-    i[345]86-*-netbsd*)           natdynlink=true;;
+    i[3456]86-*-netbsd*)           natdynlink=true;;
     x86_64-*-netbsd*)             natdynlink=true;;
     i386-*-gnu0.3)                natdynlink=true;;
     arm*-*-linux*)                natdynlink=true;;
@@@@ -702,6 +702,8 @@@@ case "$host" in
d13 11
a23 16
@@@@ -797,10 +799,14 @@@@ case "$arch,$model,$system" in
   i386,*,bsd_elf) profiling='prof';;
   amd64,*,macosx) profiling='prof';;
   i386,*,macosx) profiling='prof';;
+  sparc,*,bsd) profiling='prof';;
   sparc,*,solaris)
     profiling='prof'
     case "$nativecc" in gcc*) ;; *) cc_profile='-xpg';; esac;;
   amd64,*,linux) profiling='prof';;
+  amd64,*,openbsd) profiling='prof';;
+  power,*,elf) profiling='prof';;
+  power,*,*bsd*) profiling='prof';;
   amd64,*,gnu) profiling='prof';;
   arm,*,linux*) profiling='prof';;
   *) profiling='noprof';;
@@@@ -1563,11 +1569,11 @@@@ fi
d29 3
a31 3
+if ./hasgot -I${OPENBSD_LOCALBASE}/include -i bfd.h && \
+   ./hasgot -L${OPENBSD_LOCALBASE}/lib -lbfd -liberty -lz bfd_openr; then
   echo "BFD library found."
d36 1
a36 1
   echo "BFD library not found, 'objinfo' will be unable to display info on .cmxs files"
@


1.16
log
@unbreak ocaml on macppc by fixing the configure script
@
text
@d1 4
a4 4
$OpenBSD: patch-configure,v 1.15 2012/08/18 21:49:16 avsm Exp $
--- configure.orig	Tue Jun 26 16:33:50 2012
+++ configure	Thu Nov  1 01:28:40 2012
@@@@ -641,11 +641,11 @@@@ if test $withsharedlibs = "yes"; then
d19 3
a21 8
@@@@ -688,10 +688,13 @@@@ case "$host" in
   i[3456]86-*-gnu*)             arch=i386; system=gnu;;
   powerpc*-*-linux*)            arch=power; model=ppc; system=elf;;
   powerpc-*-netbsd*)            arch=power; model=ppc; system=elf;;
+  powerpc-*-openbsd*)           arch=power; model=ppc; system=bsd;;
   powerpc-*-rhapsody*)          arch=power; model=ppc; system=rhapsody;;
   powerpc-*-darwin*)            arch=power; system=rhapsody
                                 if $arch64; then model=ppc64; else model=ppc; fi;;
d28 1
a28 1
@@@@ -780,10 +783,14 @@@@ case "$arch,$model,$system" in
d43 1
a43 1
@@@@ -1543,11 +1550,11 @@@@ fi
@


1.15
log
@update to ocaml-4.00.0

- uses new ocaml_native and ocaml_native_dynlink arch properties
- changelog: http://caml.inria.fr/pub/distrib/ocaml-4.00/notes/Changes

From Christopher Zimmermann <madroach@@gmerlin.de> with fixes from me
@
text
@d1 3
a3 3
$OpenBSD: patch-configure,v 1.14 2010/12/17 18:42:04 dcoppa Exp $
--- configure.orig	Tue Jun 26 17:33:50 2012
+++ configure	Mon Jul 30 12:28:54 2012
d23 1
a23 1
+  powerpc-*-openbsd*)           arch=power; model=ppc; system=elf;;
d28 2
a29 2
+  arm*-*-openbsd*)              arch=arm; system=openbsd;;
+  zaurus*-*-openbsd*)           arch=arm; system=openbsd;;
d33 1
a33 1
@@@@ -780,10 +783,13 @@@@ case "$arch,$model,$system" in
d44 1
d48 1
a48 1
@@@@ -1543,11 +1549,11 @@@@ fi
@


1.14
log
@Fix build on amd64.
Problem reported by landry@@ and kili@@.

OK landry@@
@
text
@d1 5
a5 4
$OpenBSD: patch-configure,v 1.13 2010/12/07 15:01:35 dcoppa Exp $
--- configure.orig	Wed Jul 28 15:18:22 2010
+++ configure	Thu Nov 18 10:07:33 2010
@@@@ -629,6 +629,8 @@@@ if test $withsharedlibs = "yes"; then
d8 9
d18 2
a19 7
+    i[3456]86-*-openbsd*)         natdynlink=true;;
+    x86_64-*-openbsd*)            natdynlink=true;;
   esac
 fi
 
@@@@ -674,6 +676,7 @@@@ case "$host" in
                                 fi;;
d21 3
a23 6
   mips-*-irix6*)                arch=mips; system=irix;;
+  mips*-*-openbsd*)             arch=mips; system=openbsd;;
   hppa1.1-*-hpux*)              arch=hppa; system=hpux;;
   hppa2.0*-*-hpux*)             arch=hppa; system=hpux;;
   hppa*-*-linux*)               arch=hppa; system=linux;;
@@@@ -683,8 +686,11 @@@@ case "$host" in
d27 1
a27 3
+  powerpc-*-openbsd*)           arch=power; model=ppc; system=bsd;;
   arm*-*-linux*)                arch=arm; system=linux;;
   arm*-*-gnu*)                  arch=arm; system=gnu;;
d30 4
a33 10
   ia64-*-linux*)                arch=ia64; system=linux;;
   ia64-*-gnu*)                  arch=ia64; system=gnu;;
   ia64-*-freebsd*)              arch=ia64; system=freebsd;;
@@@@ -784,11 +790,15 @@@@ if test -n "$asppoption"; then aspp="$asppoption"; fi
 cc_profile='-pg'
 case "$arch,$model,$system" in
   alpha,*,digital) profiling='prof';;
+  alpha,*,openbsd) profiling='prof';;
   i386,*,linux_elf) profiling='prof';;
   i386,*,gnu) profiling='prof';;
a36 2
+  amd64,*,openbsd) profiling='prof';;
+  power,*,bsd) profiling='prof';;
d41 7
a47 1
@@@@ -1570,11 +1580,11 @@@@ fi
@


1.13
log
@Update to ocaml-3.12.0

Maintainer timeout.

OK landry@@, jasper@@
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.12 2010/06/04 13:58:18 avsm Exp $
d9 1
a9 1
+    amd64-*-openbsd*)             natdynlink=true;;
d33 1
a33 9
@@@@ -694,6 +700,7 @@@@ case "$host" in
   x86_64-*-netbsd*)             arch=amd64; system=netbsd;;
   x86_64-*-openbsd*)            arch=amd64; system=openbsd;;
   x86_64-*-darwin9.5)           arch=amd64; system=macosx;;
+  amd64-*-openbsd*)             arch=amd64; system=openbsd;;
 esac
 
 # Some platforms exist both in 32-bit and 64-bit variants, not distinguished
@@@@ -784,11 +791,15 @@@@ if test -n "$asppoption"; then aspp="$asppoption"; fi
d49 1
a49 1
@@@@ -1570,11 +1581,11 @@@@ fi
@


1.12
log
@update to ocaml-3.11.2, mainly bugfixes. from dcoppa@@ with minor PLIST tweaks from me
@
text
@d1 21
a21 5
$OpenBSD: patch-configure,v 1.11 2009/03/11 21:19:49 avsm Exp $
--- configure.orig	Tue Nov 17 14:28:44 2009
+++ configure	Wed Jun  2 20:23:28 2010
@@@@ -648,9 +648,12 @@@@ case "$host" in
   powerpc-*-netbsd*)            arch=power; model=ppc; system=elf;;
d24 1
a24 3
-                                if $arch64; then model=ppc64; else model=ppc; fi;;
+                                if $arch64; then model=ppc64; else
+  model=ppc; fi;;
d28 1
d33 1
a33 1
@@@@ -660,6 +663,7 @@@@ case "$host" in
d41 1
a41 1
@@@@ -750,11 +754,15 @@@@ if test -n "$asppoption"; then aspp="$asppoption"; fi
d57 15
@


1.11
log
@update ocaml to 3.11.0
tested by krw@@ and Richard Bonichon <richard.bonichon@@gmail.com>
@
text
@d1 4
a4 4
$OpenBSD$
--- configure.orig	Wed Dec 10 09:41:04 2008
+++ configure	Wed Dec 10 09:50:14 2008
@@@@ -635,9 +635,12 @@@@ case "$host" in
d18 1
a18 1
@@@@ -647,6 +650,7 @@@@ case "$host" in
d26 1
a26 1
@@@@ -734,11 +738,15 @@@@ if test -n "$asppoption"; then aspp="$asppoption"; fi
@


1.10
log
@- support shared libraries in OCaml, for dynamic top level to work.
- fix bad string handling in ocamlyacc, spotted by Ray Lai w/ malloc flags
- bump PKGNAME
@
text
@d1 10
a10 24
$OpenBSD: patch-configure,v 1.9 2006/05/28 15:28:54 avsm Exp $
--- configure.orig	Tue Dec 26 23:30:01 2006
+++ configure	Tue Dec 26 23:29:28 2006
@@@@ -483,7 +483,7 @@@@ mksharedlibrpath=''
 
 if test $withsharedlibs = "yes"; then
   case "$host" in
-    *-*-linux-gnu|*-*-linux|*-*-freebsd[3-9]*|*-*-gnu*)
+    *-*-linux-gnu|*-*-linux|*-*-freebsd[3-9]*|*-*-openbsd*|*-*-gnu*)
       sharedcccompopts="-fPIC"
       mksharedlib="$bytecc -shared -o"
       bytecclinkopts="$bytecclinkopts -Wl,-E"
@@@@ -566,6 +566,7 @@@@ case "$host" in
   alpha*-*-freebsd*)            arch=alpha; system=freebsd;;
   alpha*-*-netbsd*)             arch=alpha; system=netbsd;;
   alpha*-*-openbsd*)            arch=alpha; system=openbsd;;
+  amd64-*-openbsd*)		arch=amd64; system=openbsd;;
   sparc*-*-sunos4.*)            arch=sparc; system=sunos;;
   sparc*-*-solaris2.*)          arch=sparc; system=solaris;;
   sparc*-*-*bsd*)               arch=sparc; system=bsd;;
@@@@ -586,9 +587,11 @@@@ case "$host" in
   hppa*-*-gnu*)                 arch=hppa; system=gnu;;
   powerpc-*-linux*)             arch=power; model=ppc; system=elf;;
   powerpc-*-netbsd*)            arch=power; model=ppc; system=bsd;;
a11 2
   powerpc-*-rhapsody*)          arch=power; model=ppc; system=rhapsody;;
   powerpc-*-darwin*)            arch=power; model=ppc; system=rhapsody;;
d13 1
a14 1
   arm*-*-gnu*)                  arch=arm; system=gnu;;
d17 10
a26 1
@@@@ -664,9 +667,13 @@@@ esac
d34 2
@


1.9
log
@upgrade to ocaml-3.09.2, sturm@@ ok
@
text
@d1 12
a12 3
$OpenBSD: patch-configure,v 1.8 2005/05/28 20:55:45 avsm Exp $
--- configure.orig	Thu Mar 30 11:00:19 2006
+++ configure	Tue May  2 12:02:42 2006
@


1.8
log
@native code works on the zaurus now!
@
text
@d1 4
a4 4
$OpenBSD: patch-configure,v 1.7 2005/05/09 13:50:41 avsm Exp $
--- configure.orig	Mon Jan 24 08:22:46 2005
+++ configure	Sat May 28 13:04:41 2005
@@@@ -563,6 +563,7 @@@@ case "$host" in
d12 2
a13 2
@@@@ -579,9 +580,11 @@@@ case "$host" in
   hppa*-*-linux*)		arch=hppa; system=linux;;
d20 2
a21 1
+  zaurus*-*-openbsd*)		arch=arm; system=openbsd;;
d23 2
a24 3
   ia64-*-freebsd*)              arch=ia64; system=freebsd;;
   x86_64-*-linux*)              arch=amd64; system=linux;;
@@@@ -651,8 +654,12 @@@@ esac
d30 1
a37 11
@@@@ -683,10 +690,6 @@@@ case "$host" in
           echo "objcopy and nm found in $d"
           if test `$d/objcopy --help | grep -s -c 'redefine-sym'` -eq 0; then
             echo "$d/objcopy does not support option --redefine-sym, discarded"
-            continue;
-          fi
-          if test `$d/nm --version | grep -s -c 'GNU nm'` -eq 0; then
-            echo "$d/nm is not from GNU binutils, discarded"
             continue;
           fi
           binutils_objcopy="$d/objcopy"
@


1.7
log
@upgrade to ocaml-3.08.3, tested on many architectures by krw@@
@
text
@d1 3
a3 3
$OpenBSD: patch-configure,v 1.6 2004/06/22 18:14:44 avsm Exp $
--- configure.orig	Mon Jan 24 15:22:46 2005
+++ configure	Wed Mar 23 13:32:24 2005
d12 1
a12 1
@@@@ -579,6 +580,7 @@@@ case "$host" in
d20 5
a24 1
@@@@ -651,8 +653,12 @@@@ esac
d37 1
a37 1
@@@@ -683,10 +689,6 @@@@ case "$host" in
@


1.6
log
@support native code compilation (ocamlopt) on macppc as well, for nordin@@
to hack on
@
text
@d1 4
a4 4
$OpenBSD: patch-configure,v 1.5 2004/03/05 21:54:36 avsm Exp $
--- configure.orig	Thu Sep 25 02:17:13 2003
+++ configure	Tue Jun 22 04:43:09 2004
@@@@ -537,6 +537,7 @@@@ case "$host" in
d12 2
a13 2
@@@@ -555,6 +556,7 @@@@ case "$host" in
   powerpc-*-aix*)               arch=power; model=ppc; system=aix;;
d16 1
a16 1
+  macppc-*-openbsd*)            arch=power; model=ppc; system=bsd;;
d20 1
a20 1
@@@@ -629,8 +631,12 @@@@ esac
d33 11
a43 20
@@@@ -654,8 +660,8 @@@@ if test "$arch" != "none"; then
         echo "$d/objcopy does not support option --redefine-sym, discarded"
         continue;
       fi
-      if test `$d/nm --version | grep -s -c 'GNU nm'` -eq 0; then
-        echo "$d/nm is not from GNU binutils, discarded"
+      if test `$d/nm --version 2>&1|grep -E -s -c 'GNU nm|OpenBSD'` -eq 0; then
+        echo "$d/nm is not from GNU binutils or OpenBSD, discarded"
         continue;
       fi
       binutils_objcopy="$d/objcopy"
@@@@ -1411,7 +1417,7 @@@@ fi
 
 (
 cd ../../camlp4/config
-EXE=$exe ./configure_batch -bindir "$bindir" -libdir "$libdir" -mandir "$mandir" -ocaml-top ../.. > /dev/null
+EXE=$exe ./configure_batch -prefix "$prefix" -ocaml-top ../.. > /dev/null
 )
 
 # Final twiddling of compiler options to work around known bugs
@


1.5
log
@support native code compilation on amd64, resulting in crazy fast ocaml
sturm@@, pvalchev@@ ok
@
text
@d1 3
a3 3
$OpenBSD: patch-configure,v 1.4 2004/01/25 17:02:59 sturm Exp $
--- configure.orig	2003-09-25 09:17:13.000000000 +0100
+++ configure	2004-03-05 15:44:08.000000000 +0000
d20 1
a20 1
@@@@ -629,8 +631,11 @@@@ esac
d28 1
d33 1
a33 1
@@@@ -654,8 +659,8 @@@@ if test "$arch" != "none"; then
d44 1
a44 1
@@@@ -1411,7 +1416,7 @@@@ fi
@


1.4
log
@enable profiling support on all native archs to fix packaging

tested by pval(alpha) and marcm(sparc) thanks!
@
text
@d1 12
a12 4
$OpenBSD: patch-configure,v 1.3 2003/12/31 17:05:28 sturm Exp $
--- configure.orig	2003-09-25 10:17:13.000000000 +0200
+++ configure	2004-01-24 09:51:55.000000000 +0100
@@@@ -555,6 +555,7 @@@@ case "$host" in
d20 1
a20 1
@@@@ -629,8 +630,10 @@@@ esac
d27 1
d32 12
a43 1
@@@@ -1411,7 +1414,7 @@@@ fi
@


1.3
log
@update to ocaml 3.07
@
text
@d1 3
a3 3
$OpenBSD$
--- configure.orig	2003-09-29 23:08:30.000000000 +0200
+++ configure	2003-09-29 23:10:36.000000000 +0200
d12 12
a23 1
@@@@ -1411,7 +1412,7 @@@@ fi
@


1.2
log
@at least recognise OpenBSD/macppc, does not work yet fully; from Nikolay Sturm
@
text
@d1 4
a4 5
$OpenBSD: patch-configure,v 1.1 2002/08/25 20:44:40 naddy Exp $
--- configure.orig	Wed Aug  7 14:45:00 2002
+++ configure	Wed Sep 11 08:46:17 2002
@@@@ -528,6 +528,7 @@@@ case "$host" in
   rs6000-*-aix*)                arch=power; model=rs6000; system=aix;;
d7 2
a8 1
+  macppc-*-*bsd*)               arch=power; model=ppc; system=elf;;
d12 1
a12 1
@@@@ -1325,7 +1326,7 @@@@ fi
@


1.1
log
@Update to 3.06 which includes camlp4.
From Nikolay Sturm <sturm@@sec.informatik.tu-darmstadt.de>.
@
text
@d1 1
a1 1
$OpenBSD$
d3 10
a12 2
+++ configure	Thu Aug 22 09:23:56 2002
@@@@ -1325,7 +1325,7 @@@@ fi
@

