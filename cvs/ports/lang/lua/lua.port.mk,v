head	1.35;
access;
symbols
	OPENBSD_6_2:1.35.0.4
	OPENBSD_6_2_BASE:1.35
	OPENBSD_6_1:1.35.0.2
	OPENBSD_6_1_BASE:1.35
	OPENBSD_6_0:1.34.0.2
	OPENBSD_6_0_BASE:1.34
	OPENBSD_5_9:1.33.0.2
	OPENBSD_5_9_BASE:1.33
	OPENBSD_5_8:1.32.0.4
	OPENBSD_5_8_BASE:1.32
	OPENBSD_5_7:1.30.0.2
	OPENBSD_5_7_BASE:1.30
	OPENBSD_5_6:1.28.0.6
	OPENBSD_5_6_BASE:1.28
	OPENBSD_5_5:1.28.0.4
	OPENBSD_5_5_BASE:1.28
	OPENBSD_5_4:1.28.0.2
	OPENBSD_5_4_BASE:1.28
	OPENBSD_5_3:1.25.0.2
	OPENBSD_5_3_BASE:1.25
	OPENBSD_5_2:1.20.0.2
	OPENBSD_5_2_BASE:1.20
	OPENBSD_5_1_BASE:1.7
	OPENBSD_5_1:1.7.0.2
	OPENBSD_5_0:1.6.0.4
	OPENBSD_5_0_BASE:1.6
	OPENBSD_4_9:1.6.0.2
	OPENBSD_4_9_BASE:1.6
	OPENBSD_4_8:1.4.0.2
	OPENBSD_4_8_BASE:1.4
	OPENBSD_4_7:1.1.0.8
	OPENBSD_4_7_BASE:1.1
	OPENBSD_4_6:1.1.0.6
	OPENBSD_4_6_BASE:1.1
	OPENBSD_4_5:1.1.0.4
	OPENBSD_4_5_BASE:1.1
	OPENBSD_4_4:1.1.0.2
	OPENBSD_4_4_BASE:1.1;
locks; strict;
comment	@# @;


1.35
date	2016.10.31.18.46.09;	author jca;	state Exp;
branches;
next	1.34;
commitid	OuiDwyzgQUjIXUee;

1.34
date	2016.06.07.11.51.52;	author jca;	state Exp;
branches;
next	1.33;
commitid	8zWXtDc1AD7uZ4Ox;

1.33
date	2015.10.18.20.20.50;	author sthen;	state Exp;
branches;
next	1.32;
commitid	pCwEYEorUazztnbO;

1.32
date	2015.07.14.23.14.42;	author jasper;	state Exp;
branches;
next	1.31;
commitid	tyIjMSEIXjgmE9ZW;

1.31
date	2015.06.22.19.46.57;	author jasper;	state Exp;
branches;
next	1.30;
commitid	tJsfzlbbm502VR1S;

1.30
date	2015.01.14.20.10.10;	author jturner;	state Exp;
branches;
next	1.29;
commitid	3S7GBxJaUbrn7iyq;

1.29
date	2015.01.14.20.07.45;	author jturner;	state Exp;
branches;
next	1.28;
commitid	Jfb7ijkE0wmH1E2W;

1.28
date	2013.06.02.16.59.48;	author jasper;	state Exp;
branches;
next	1.27;

1.27
date	2013.05.30.16.43.38;	author jasper;	state Exp;
branches;
next	1.26;

1.26
date	2013.03.11.11.20.28;	author espie;	state Exp;
branches;
next	1.25;

1.25
date	2013.02.09.14.49.51;	author sthen;	state Exp;
branches;
next	1.24;

1.24
date	2012.12.11.22.12.12;	author sthen;	state Exp;
branches;
next	1.23;

1.23
date	2012.10.31.13.39.32;	author gsoares;	state Exp;
branches;
next	1.22;

1.22
date	2012.09.19.08.14.51;	author jasper;	state Exp;
branches;
next	1.21;

1.21
date	2012.08.05.08.07.28;	author sthen;	state Exp;
branches;
next	1.20;

1.20
date	2012.07.19.20.25.16;	author jasper;	state Exp;
branches;
next	1.19;

1.19
date	2012.07.12.12.54.50;	author jasper;	state Exp;
branches;
next	1.18;

1.18
date	2012.07.11.10.10.57;	author jasper;	state Exp;
branches;
next	1.17;

1.17
date	2012.07.11.10.06.11;	author jasper;	state Exp;
branches;
next	1.16;

1.16
date	2012.07.10.18.34.26;	author jasper;	state Exp;
branches;
next	1.15;

1.15
date	2012.07.10.17.14.53;	author jasper;	state Exp;
branches;
next	1.14;

1.14
date	2012.07.10.15.09.25;	author jasper;	state Exp;
branches;
next	1.13;

1.13
date	2012.05.15.19.24.21;	author jasper;	state Exp;
branches;
next	1.12;

1.12
date	2012.05.15.18.14.44;	author jasper;	state Exp;
branches;
next	1.11;

1.11
date	2012.05.15.18.03.18;	author jasper;	state Exp;
branches;
next	1.10;

1.10
date	2012.05.15.15.11.06;	author jasper;	state Exp;
branches;
next	1.9;

1.9
date	2012.05.15.12.25.17;	author jasper;	state Exp;
branches;
next	1.8;

1.8
date	2012.05.11.20.48.38;	author jasper;	state Exp;
branches;
next	1.7;

1.7
date	2011.11.17.23.48.13;	author sthen;	state Exp;
branches;
next	1.6;

1.6
date	2010.11.17.08.05.18;	author espie;	state Exp;
branches;
next	1.5;

1.5
date	2010.09.09.17.32.36;	author jasper;	state Exp;
branches;
next	1.4;

1.4
date	2010.06.15.22.05.24;	author jasper;	state Exp;
branches;
next	1.3;

1.3
date	2010.06.15.21.20.39;	author jasper;	state Exp;
branches;
next	1.2;

1.2
date	2010.06.15.21.17.46;	author jasper;	state Exp;
branches;
next	1.1;

1.1
date	2008.06.11.05.00.01;	author landry;	state Exp;
branches;
next	;


desc
@@


1.35
log
@Stop automatic addition of lua5x FLAVORS.

Now if a port wants to declare support for lua52/lua53, it must do so
explicitely.  Hopefully this will result in lua libraries being better
tested with the lua versions we support.

Agreement from sthen@@ when discussed on ports@@, bulk build tests by
ajacoutot@@.
@
text
@# $OpenBSD: lua.port.mk,v 1.34 2016/06/07 11:51:52 jca Exp $

CATEGORIES +=	lang/lua

#
# Handle multiple versions/flavors.
# Defaults to MODLUA_DEFAULT_VERSION if no FLAVOR is set.
#

# Define the default version and use that if MODLUA_VERSION is not set.
MODLUA_DEFAULT_VERSION =	5.1

FLAVOR ?=		# empty

# without a flavor, assume ${MODLUA_DEFAULT_VERSION}
.if ${FLAVOR:Mlua52}
MODLUA_VERSION =		5.2
.elif ${FLAVOR:Mlua53}
MODLUA_VERSION =		5.3
.else
MODLUA_VERSION ?=		${MODLUA_DEFAULT_VERSION}
.endif

.if "${MODLUA_VERSION}" == "5.1"
_MODLUA_PKG_PREFIX =	lua
MODLUA_FLAVOR =		# empty
.elif "${MODLUA_VERSION}" == "5.2"
_MODLUA_PKG_PREFIX =	lua52
MODLUA_FLAVOR =		lua52
.elif "${MODLUA_VERSION}" == "5.3"
_MODLUA_PKG_PREFIX =	lua53
MODLUA_FLAVOR =		lua53
.else
ERRORS +=		"Invalid MODLUA_VERSION set: ${MODLUA_VERSION}."
.endif

# Based on lua version, adjust the prefix. But don't change the prefix
# of default (5.1) packages. Unless it's just a standalone application
# that happens to embed lua (in which case MODLUA_SA needs to be set
# and we'll just append the flavor suffix.
MODLUA_SA ?=	No

.if "${MODLUA_VERSION}" != "5.1"
.if !${MODLUA_SA:L:Myes}
FULLPKGNAME ?=	${PKGNAME:S/^lua/${_MODLUA_PKG_PREFIX}/}
.endif
.endif

#
# Shorthand variables used for common tasks, e.g. pkg-config use ${MODLUA_DEP}.
#
MODLUA_DEP_VERSION ?=	${MODLUA_VERSION:S/.//g}
MODLUA_DEP =		lua${MODLUA_DEP_VERSION}

MODLUA_WANTLIB =	lua${MODLUA_VERSION}
MODLUA_LIB =		-l${MODLUA_WANTLIB}

_MODLUA_RUN_DEPENDS =	lang/lua/${MODLUA_VERSION}

MODLUA_LIB_DEPENDS =	${_MODLUA_RUN_DEPENDS}

MODLUA_BIN =		${LOCALBASE}/bin/lua${MODLUA_DEP_VERSION}

# Propagate the flavor to all dependencies
.for r in ${MODLUA_RUN_DEPENDS}
_MODLUA_RUN_DEPS +=	${r},${MODLUA_FLAVOR}
.endfor

.for b in ${MODLUA_BUILD_DEPENDS}
_MODLUA_BUILD_DEPENDS +=	${b},${MODLUA_FLAVOR}
.endfor

.for x in ${MODLUA_TEST_DEPENDS}
_MODLUA_TEST_DEPENDS +=${x},${MODLUA_FLAVOR}
.endfor

#
# Default directories
#

# Where the lua distribution headers have been installed to.
MODLUA_INCL_DIR =	${LOCALBASE}/include/lua-${MODLUA_VERSION}/

# Where the example will be installed
MODLUA_EXAMPLEDIR =	${PREFIX}/share/examples/${FULLPKGNAME}/

# Where the docs will be installed
MODLUA_DOCDIR =		${PREFIX}/share/doc/${FULLPKGNAME}/

# Where the lua libraries will be installed to
MODLUA_LIBDIR =		${PREFIX}/lib/lua/${MODLUA_VERSION}/

# Where the lua modules will be installed to
MODLUA_DATADIR =	${PREFIX}/share/lua/${MODLUA_VERSION}/

#
# Fixup run/build dependencies if needed
#
MODLUA_RUNDEP ?=	Yes
MODLUA_BUILDDEP ?=	Yes

.if ${MODLUA_RUNDEP:L} == yes
RUN_DEPENDS +=		${_MODLUA_RUN_DEPENDS} \
			${_MODLUA_RUN_DEPS}
.endif

.if ${NO_BUILD:L} == "no" && "${MODLUA_BUILDDEP:L}" == "yes"
BUILD_DEPENDS +=	${_MODLUA_BUILD_DEPENDS} \
			${_MODLUA_RUN_DEPENDS}
.endif

TEST_DEPENDS +=	${_MODLUA_TEST_DEPENDS}

SUBST_VARS +=	MODLUA_VERSION MODLUA_LIB MODLUA_INCL_DIR \
		MODLUA_EXAMPLEDIR MODLUA_DOCDIR MODLUA_LIBDIR \
		MODLUA_DATADIR MODLUA_DEP MODLUA_DEP_VERSION \
		MODLUA_BIN
@


1.34
log
@Allow one to restrict the lua FLAVORS available in a lua port.

Previously declaring eg. FLAVORS = lua52 in the Makefile would still
allow you to build the lua53 FLAVOR.  No objection from ports
@
text
@d1 1
a1 1
# $OpenBSD: lua.port.mk,v 1.33 2015/10/18 20:20:50 sthen Exp $
a11 12

# If a port already has flavors, append our lua flavors to it, unless it
# requests specific versions of lua. Otherwise set the FLAVORS list to
# just the lua flavors.
_MODLUA_FLAVORS =	lua52 lua53
.if !defined(MODLUA_VERSION)
.  if !defined(FLAVORS)
FLAVORS ?=		${_MODLUA_FLAVORS}
.  elif !${FLAVORS:M${_MODLUA_FLAVORS}}
FLAVORS +=		${_MODLUA_FLAVORS}
.  endif
.endif
@


1.33
log
@Only append lua52/lua53 to FLAVORS if MODLUA_VERSION is not defined.
I think this matches the intent of the comment above, and avoids producing
flavours for various ports (games, etc) where it doesn't make sense to
support multiple versions of lua. Makes sense to jasper@@, and it doesn't
produce any unexpected changes to 'dump-vars' output across the tree.

Thanks to Pascal de Bruijn from darktable for letting me know about the
forthcoming darktable release and identifying this as an issue with
the port.
@
text
@d1 1
a1 1
# $OpenBSD: lua.port.mk,v 1.32 2015/07/14 23:14:42 jasper Exp $
d14 1
a14 1
# requests a specific version of lua. Otherwise set the FLAVORS list to
d16 1
d19 3
a21 3
FLAVORS ?=		lua52 lua53
.  else
FLAVORS +=		lua52 lua53
@


1.32
log
@spacing
@
text
@d1 1
a1 1
# $OpenBSD: lua.port.mk,v 1.31 2015/06/22 19:46:57 jasper Exp $
d13 5
a17 3
# If a port already has flavors, append our lua flavors to it, unless it requests a specific
# version of lua. Otherwise set the FLAVORS list to just the lua flavors.
.if !defined(MODLUA_VERSION) && !defined(FLAVORS)
d19 1
a19 1
.else
d21 1
@


1.31
log
@no need for making it unobvious how _MODLUA_RUN_DEPENDS gets set
@
text
@d1 1
a1 1
# $OpenBSD: lua.port.mk,v 1.30 2015/01/14 20:10:10 jturner Exp $
d3 1
a3 1
CATEGORIES+=	lang/lua
d11 1
a11 1
MODLUA_DEFAULT_VERSION=	5.1
d16 1
a16 1
FLAVORS?=		lua52 lua53
d18 1
a18 1
FLAVORS+=		lua52 lua53
d21 1
a21 1
FLAVOR?=		# empty
d25 1
a25 1
MODLUA_VERSION=		5.2
d27 1
a27 1
MODLUA_VERSION=		5.3
d29 1
a29 1
MODLUA_VERSION?=	${MODLUA_DEFAULT_VERSION}
d33 2
a34 2
_MODLUA_PKG_PREFIX=	lua
MODLUA_FLAVOR=		# empty
d36 2
a37 2
_MODLUA_PKG_PREFIX=	lua52
MODLUA_FLAVOR=		lua52
d39 2
a40 2
_MODLUA_PKG_PREFIX=	lua53
MODLUA_FLAVOR=		lua53
d42 1
a42 1
ERRORS+=		"Invalid MODLUA_VERSION set: ${MODLUA_VERSION}."
d49 1
a49 1
MODLUA_SA?=		No
d53 1
a53 1
FULLPKGNAME?=${PKGNAME:S/^lua/${_MODLUA_PKG_PREFIX}/}
d60 2
a61 2
MODLUA_DEP_VERSION?=	${MODLUA_VERSION:S/.//g}
MODLUA_DEP=		lua${MODLUA_DEP_VERSION}
d63 2
a64 2
MODLUA_WANTLIB=		lua${MODLUA_VERSION}
MODLUA_LIB=		-l${MODLUA_WANTLIB}
d66 1
a66 1
_MODLUA_RUN_DEPENDS=	lang/lua/${MODLUA_VERSION}
d68 1
a68 1
MODLUA_LIB_DEPENDS=	${_MODLUA_RUN_DEPENDS}
d70 1
a70 1
MODLUA_BIN=		${LOCALBASE}/bin/lua${MODLUA_DEP_VERSION}
d74 1
a74 1
_MODLUA_RUN_DEPS+=	${r},${MODLUA_FLAVOR}
d78 1
a78 1
_MODLUA_BUILD_DEPENDS+=	${b},${MODLUA_FLAVOR}
d82 1
a82 1
_MODLUA_TEST_DEPENDS+=${x},${MODLUA_FLAVOR}
d90 1
a90 1
MODLUA_INCL_DIR=	${LOCALBASE}/include/lua-${MODLUA_VERSION}/
d93 1
a93 1
MODLUA_EXAMPLEDIR=	${PREFIX}/share/examples/${FULLPKGNAME}/
d96 1
a96 1
MODLUA_DOCDIR=		${PREFIX}/share/doc/${FULLPKGNAME}/
d99 1
a99 1
MODLUA_LIBDIR=		${PREFIX}/lib/lua/${MODLUA_VERSION}/
d102 1
a102 1
MODLUA_DATADIR=		${PREFIX}/share/lua/${MODLUA_VERSION}/
d107 2
a108 2
MODLUA_RUNDEP?=		Yes
MODLUA_BUILDDEP?=	Yes
d111 1
a111 1
RUN_DEPENDS+=		${_MODLUA_RUN_DEPENDS} \
d116 1
a116 1
BUILD_DEPENDS+=		${_MODLUA_BUILD_DEPENDS} \
d120 1
a120 1
TEST_DEPENDS+=	${_MODLUA_TEST_DEPENDS}
d122 1
a122 1
SUBST_VARS+=	MODLUA_VERSION MODLUA_LIB MODLUA_INCL_DIR \
@


1.30
log
@Fix typo s/land/lang
@
text
@d1 1
a1 1
# $OpenBSD: lua.port.mk,v 1.29 2015/01/14 20:07:45 jturner Exp $
d66 1
a66 7
.if "${MODLUA_VERSION}" == "5.1"
_MODLUA_RUN_DEPENDS=	lang/lua/5.1
.elif "${MODLUA_VERSION}" == "5.2"
_MODLUA_RUN_DEPENDS=	lang/lua/5.2
.elif "${MODLUA_VERSION}" == "5.3"
_MODLUA_RUN_DEPENDS=	lang/lua/5.3
.endif
@


1.29
log
@Hook up Lua 5.3. ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: lua.port.mk,v 1.28 2013/06/02 16:59:48 jasper Exp $
d71 1
a71 1
_MODLUA_RUN_DEPENDS=	land/lua/5.3
@


1.28
log
@revert previous; needs more work.
@
text
@d1 1
a1 1
# $OpenBSD: lua.port.mk,v 1.26 2013/03/11 11:20:28 espie Exp $
d16 1
a16 1
FLAVORS?=		lua52
d18 1
a18 1
FLAVORS+=		lua52
d26 2
d38 3
d70 2
@


1.27
log
@add support for MODLUA_LIB_DEPENDS and remove a bogus line while here
@
text
@d67 2
a75 4
.for l in ${MODLUA_LIB_DEPENDS}
_MODLUA_LIB_DEPENDS+=	${l},${MODLUA_FLAVOR}
.endfor

a117 2

LIB_DEPENDS +=		${_MODLUA_LIB_DEPENDS}
@


1.26
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: lua.port.mk,v 1.25 2013/02/09 14:49:51 sthen Exp $
a66 2
MODLUA_LIB_DEPENDS=	${_MODLUA_RUN_DEPENDS}

d74 4
d120 2
@


1.25
log
@Don't use ${FLAVOR:L}, we only support lower-case flavours now.
OK ajacoutot@@ espie@@
@
text
@d1 1
a1 1
# $OpenBSD: lua.port.mk,v 1.24 2012/12/11 22:12:12 sthen Exp $
d80 2
a81 2
.for x in ${MODLUA_REGRESS_DEPENDS}
_MODLUA_REGRESS_DEPENDS+=${x},${MODLUA_FLAVOR}
d119 1
a119 1
REGRESS_DEPENDS+=	${_MODLUA_REGRESS_DEPENDS}
@


1.24
log
@allow MODLUA_VERSION to be overridden; ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: lua.port.mk,v 1.23 2012/10/31 13:39:32 gsoares Exp $
d24 1
a24 1
.if ${FLAVOR:L:Mlua52}
@


1.23
log
@add MODLUA_BIN to SUBST_VAR
no bump needed in lua packages, since this doesn't affect generated packages

OK jasper@@ sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: lua.port.mk,v 1.22 2012/09/19 08:14:51 jasper Exp $
d27 1
a27 1
MODLUA_VERSION=		${MODLUA_DEFAULT_VERSION}
@


1.22
log
@the heuristic to set pkg_arch was wrong; so remove it alltogether.
@
text
@d1 1
a1 1
# $OpenBSD: lua.port.mk,v 1.21 2012/08/05 08:07:28 sthen Exp $
d123 2
a124 1
		MODLUA_DATADIR MODLUA_DEP MODLUA_DEP_VERSION
@


1.21
log
@XXX comment, PKG_ARCH=* is set too easily. Add reminder to remove workaround
from games/freedroidrpg when this is fixed.
@
text
@d1 1
a1 1
# $OpenBSD: lua.port.mk,v 1.20 2012/07/19 20:25:16 jasper Exp $
a119 6

# XXX This sets PKG_ARCH=* too easily.
# When this is fixed, revert games/freedroidrpg r1.20
.if !defined(SHARED_ONLY) || ${SHARED_ONLY:L} == "no"
PKG_ARCH=		*
.endif
@


1.20
log
@add MODLUA_DEP_VERSION to SUBST_VARS
@
text
@d1 1
a1 1
# $OpenBSD: lua.port.mk,v 1.19 2012/07/12 12:54:50 jasper Exp $
d121 2
@


1.19
log
@fix net/nmap
@
text
@d1 1
a1 1
# $OpenBSD: lua.port.mk,v 1.18 2012/07/11 10:10:57 jasper Exp $
d127 1
a127 1
		MODLUA_DATADIR MODLUA_DEP
@


1.18
log
@check for invalid modlua_versions
@
text
@d1 1
a1 1
# $OpenBSD: lua.port.mk,v 1.16 2012/07/10 18:34:26 jasper Exp $
d67 1
a67 1
MODLUA_LIB_DEPENDS=	${MODLUA_RUN_DEPENDS}
@


1.17
log
@redo flavor handling
@
text
@d24 3
a26 1
.if empty(FLAVOR)
a27 2
.elif ${FLAVOR:L:Mlua52}
MODLUA_VERSION=		"5.2"
d36 2
@


1.16
log
@start fixing flavors
@
text
@d1 1
a1 1
# $OpenBSD: lua.port.mk,v 1.15 2012/07/10 17:14:53 jasper Exp $
d13 5
a17 2
# The default version is not a flavor, but any other version is.
.if defined(FLAVORS)
a18 2
.else
FLAVORS?=		lua52
d23 1
d27 1
a27 1
MODLUA_VERSION=		5.2
a35 2
.else
ERRORS +=		"Fatal: Invalid MODLUA_VERSION: ${MODLUA_VERSION}"
@


1.15
log
@if a port already has flavors, allow it to use the lua52 flavor too.

spotted by william@@
@
text
@d1 1
a1 1
# $OpenBSD: lua.port.mk,v 1.14 2012/07/10 15:09:25 jasper Exp $
a25 2
.else
ERRORS +=		"Fatal: Invalid FLAVOR set: ${FLAVOR}"
d28 1
a28 1
.if ${MODLUA_VERSION} == "5.1"
d31 1
a31 1
.elif ${MODLUA_VERSION} == "5.2"
d35 1
a35 1
ERRORS +=		"Fatal: Invalid MODLUA_VERSION"
d44 1
a44 1
.if ${MODLUA_VERSION} != "5.1"
d59 1
a59 1
.if ${MODLUA_VERSION} == "5.1"
d61 1
a61 1
.elif ${MODLUA_VERSION} == "5.2"
d112 1
a112 1
.if ${NO_BUILD:L} == "no" && ${MODLUA_BUILDDEP:L} == "yes"
@


1.14
log
@- rewrite lua.port.mk to support multiple lua versions.

written and rewritten above and in budapest, with some help from sthen@@ (and his cider)
@
text
@d1 1
a1 1
# $OpenBSD: lua.port.mk,v 1.8 2012/05/11 20:48:38 jasper Exp $
d14 3
a16 1
.if !defined(FLAVORS)
@


1.13
log
@drop an underscore
@
text
@d1 1
a1 1
# $OpenBSD: lua.port.mk,v 1.10 2012/05/15 15:11:06 jasper Exp $
d5 44
a48 2
# Major.Minor of current lua version provided by lang/lua
MODLUA_VERSION=	5.1
d50 14
a63 1
MODLUA_WANTLIB=	lua
a64 1
MODLUA_RUN_DEPENDS=	lang/lua
d66 22
a87 1
_MODLUA_BUILD_DEPENDS=	${MODLUA_RUN_DEPENDS}
d93 1
a93 1
MODLUA_DOCDIR=	${PREFIX}/share/doc/${FULLPKGNAME}/
d96 1
a96 1
MODLUA_LIBDIR=	${PREFIX}/lib/lua/${MODLUA_VERSION}/
d99 1
a99 1
MODLUA_DATADIR=	${PREFIX}/share/lua/${MODLUA_VERSION}/
d101 3
d108 2
a109 1
RUN_DEPENDS+=	${MODLUA_RUN_DEPENDS}
d113 2
a114 1
BUILD_DEPENDS+=	${_MODLUA_BUILD_DEPENDS}
d117 2
d120 1
a120 1
PKG_ARCH=*
d123 3
a125 1
SUBST_VARS+=	MODLUA_VERSION
@


1.12
log
@add MODLUA_BUILD_DEP and rename MODLUA_RUN_DEP for consistency
@
text
@d26 2
a27 2
MODLUA_RUN_DEP?=	Yes
MODLUA_BUILD_DEP?=	Yes
d29 1
a29 1
.if ${MODLUA_RUN_DEP:L} == yes
d33 1
a33 1
.if ${NO_BUILD:L} == "no" && ${MODLUA_BUILD_DEP:L} == "yes"
@


1.11
log
@add support for retrieving MODLUA_WANTLIB and MODLUA_LIB_DEPENDS through the module.
@
text
@d26 4
a29 2
MODLUA_RUNDEP?=	Yes
.if ${MODLUA_RUNDEP:L} == yes
d33 1
a33 1
.if ${NO_BUILD:L} == "no"
@


1.10
log
@add MODLUA_EXAMPLEDIR too
@
text
@d1 1
a1 1
# $OpenBSD: lua.port.mk,v 1.9 2012/05/15 12:25:17 jasper Exp $
d8 6
d28 1
a28 1
RUN_DEPENDS+=	lang/lua
d32 1
a32 1
BUILD_DEPENDS+=	lang/lua
@


1.9
log
@add MODLUA_DOCDIR, this will help when we have two lua versions with which
ports can be built with..
@
text
@d1 1
a1 1
# $OpenBSD: lua.port.mk,v 1.8 2012/05/11 20:48:38 jasper Exp $
d7 3
@


1.8
log
@add MODLUA_VERSION to SUBST_VARS, this will ease the PLIST churn when
lua gets updated to 5.2...
@
text
@d1 1
a1 1
# $OpenBSD: lua.port.mk,v 1.7 2011/11/17 23:48:13 sthen Exp $
d7 3
@


1.7
log
@Support MODLUA_RUNDEP to control adding lua to RUN_DEPENDS, from Simon Kuhnle
@
text
@d1 1
a1 1
# $OpenBSD: lua.port.mk,v 1.6 2010/11/17 08:05:18 espie Exp $
d26 2
@


1.6
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: lua.port.mk,v 1.5 2010/09/09 17:32:36 jasper Exp $
d14 2
d17 1
@


1.5
log
@- automatically set PKG_ARCH=* when SHARED_ONLY is not set

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: lua.port.mk,v 1.4 2010/06/15 22:05:24 jasper Exp $
d14 1
a14 1
RUN_DEPENDS+=	::lang/lua
d17 1
a17 1
BUILD_DEPENDS+=	::lang/lua
@


1.4
log
@tyop
@
text
@d1 1
a1 1
# $OpenBSD: lua.port.mk,v 1.3 2010/06/15 21:20:39 jasper Exp $
d18 4
@


1.3
log
@- tweak names to have the "MOD" prefix.
@
text
@d1 1
a1 1
# $OpenBSD: lua.port.mk,v 1.2 2010/06/15 21:17:46 jasper Exp $
d9 1
a9 1
MODLUA_LIBDIR=	${PREFIX}/lib/lua/${LUA_VERSION}/
d12 1
a12 1
MODLUA_DATADIR=	${PREFIX}/share/lua/${LUA_VERSION}/
@


1.2
log
@- introduce LUA_VERSION, LUA_LIBDIR and LUA_DATADIR. the latter two are
duplicated in (almost) every lua port, so they should move to lua.port.mk
* lua modules will be switched over soon

ok landry@@ jolan@@
@
text
@d1 1
a1 1
# $OpenBSD: lua.port.mk,v 1.1 2008/06/11 05:00:01 landry Exp $
d6 1
a6 1
LUA_VERSION=	5.1
d9 1
a9 1
LUA_LIBDIR=	${PREFIX}/lib/lua/${LUA_VERSION}/
d12 1
a12 1
LUA_DATADIR=	${PREFIX}/share/lua/${LUA_VERSION}/
@


1.1
log
@Add a simple lua MODULE, can be used by potential new lua ports.

ok wcmaier@@ ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD$
d4 9
@

