head	1.3;
access;
symbols
	OPENBSD_3_9:1.1.0.2
	OPENBSD_3_9_BASE:1.1;
locks; strict;
comment	@# @;


1.3
date	2006.07.30.04.25.41;	author pedro;	state dead;
branches;
next	1.2;

1.2
date	2006.06.27.03.43.19;	author pedro;	state Exp;
branches;
next	1.1;

1.1
date	2006.01.18.11.17.03;	author pedro;	state Exp;
branches;
next	;


desc
@@


1.3
log
@Update to Lua 5.1, okay jolan@@
@
text
@$OpenBSD: patch-src_lib_liolib_c,v 1.2 2006/06/27 03:43:19 pedro Exp $
--- src/lib/liolib.c.orig	Tue Jun 27 00:34:01 2006
+++ src/lib/liolib.c	Tue Jun 27 00:34:58 2006
@@@@ -189,9 +189,9 @@@@ static int io_tostring (lua_State *L) {
   char buff[128];
   FileHandle *fh = topfile(L, 1);
   if (fh->f == NULL)
-    strcpy(buff, "closed");
+    strlcpy(buff, "closed", sizeof(buff));
   else
-    sprintf(buff, "%p", lua_touserdata(L, 1));
+    snprintf(buff, sizeof(buff), "%p", lua_touserdata(L, 1));
   lua_pushfstring(L, "file (%s)", buff);
   return 1;
 }
@


1.2
log
@Update to Lua 5.0.3
@
text
@d1 1
a1 1
$OpenBSD: patch-src_lib_liolib_c,v 1.1 2006/01/18 11:17:03 pedro Exp $
@


1.1
log
@Replace the very few uses of strcpy(), strcat() and sprintf() by their
safe counterparts, okay jolan@@
@
text
@d1 4
a4 4
$OpenBSD$
--- src/lib/liolib.c.orig	Tue Jan 17 13:46:10 2006
+++ src/lib/liolib.c	Tue Jan 17 13:46:46 2006
@@@@ -178,9 +178,9 @@@@ static int io_tostring (lua_State *L) {
d6 2
a7 2
   FILE **f = topfile(L, 1);
   if (*f == NULL)
@

