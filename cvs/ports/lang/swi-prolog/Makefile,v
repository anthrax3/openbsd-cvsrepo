head	1.73;
access;
symbols
	OPENBSD_6_1:1.70.0.2
	OPENBSD_6_1_BASE:1.70
	OPENBSD_6_0:1.66.0.2
	OPENBSD_6_0_BASE:1.66
	OPENBSD_5_9:1.63.0.2
	OPENBSD_5_9_BASE:1.63
	OPENBSD_5_8:1.59.0.4
	OPENBSD_5_8_BASE:1.59
	OPENBSD_5_7:1.56.0.2
	OPENBSD_5_7_BASE:1.56
	OPENBSD_5_6:1.54.0.2
	OPENBSD_5_6_BASE:1.54
	OPENBSD_5_5:1.51.0.2
	OPENBSD_5_5_BASE:1.51
	OPENBSD_5_4:1.50.0.2
	OPENBSD_5_4_BASE:1.50
	OPENBSD_5_3:1.46.0.2
	OPENBSD_5_3_BASE:1.46
	OPENBSD_5_2:1.40.0.2
	OPENBSD_5_2_BASE:1.40
	OPENBSD_5_1_BASE:1.39
	OPENBSD_5_1:1.39.0.2
	OPENBSD_5_0:1.35.0.2
	OPENBSD_5_0_BASE:1.35
	OPENBSD_4_9:1.29.0.2
	OPENBSD_4_9_BASE:1.29
	OPENBSD_4_8:1.22.0.2
	OPENBSD_4_8_BASE:1.22
	OPENBSD_4_7:1.20.0.2
	OPENBSD_4_7_BASE:1.20
	OPENBSD_4_6:1.18.0.2
	OPENBSD_4_6_BASE:1.18
	OPENBSD_4_5:1.16.0.2
	OPENBSD_4_5_BASE:1.16
	OPENBSD_4_4:1.13.0.2
	OPENBSD_4_4_BASE:1.13
	OPENBSD_4_3:1.11.0.2
	OPENBSD_4_3_BASE:1.11
	OPENBSD_4_2:1.8.0.2
	OPENBSD_4_2_BASE:1.8
	OPENBSD_4_1:1.5.0.2
	OPENBSD_4_1_BASE:1.5
	espie:1.1.1.1
	swi-prolog:1.1.1;
locks; strict;
comment	@# @;


1.73
date	2017.09.29.19.46.53;	author naddy;	state Exp;
branches;
next	1.72;
commitid	50gB9pSdLV3LZMhI;

1.72
date	2017.09.26.17.06.05;	author naddy;	state Exp;
branches;
next	1.71;
commitid	zYLrIFTxND59EbSg;

1.71
date	2017.08.21.19.25.52;	author naddy;	state Exp;
branches;
next	1.70;
commitid	Z3cWrrxfHRTDG802;

1.70
date	2017.03.14.12.23.21;	author jca;	state Exp;
branches;
next	1.69;
commitid	8ZirODuvcMiVW40L;

1.69
date	2017.03.14.12.22.41;	author jca;	state Exp;
branches;
next	1.68;
commitid	uxs2vcU7tv0RQOuW;

1.68
date	2017.03.04.21.59.55;	author sthen;	state Exp;
branches;
next	1.67;
commitid	nhvOH4eNwFCqyURR;

1.67
date	2016.09.10.13.03.42;	author ajacoutot;	state Exp;
branches;
next	1.66;
commitid	4KcvAK91uGdTLejD;

1.66
date	2016.05.12.01.17.13;	author naddy;	state Exp;
branches;
next	1.65;
commitid	yWplpZyyaU1NC3LP;

1.65
date	2016.03.15.21.12.06;	author naddy;	state Exp;
branches;
next	1.64;
commitid	REgAryzDV2rrmYB6;

1.64
date	2016.03.10.11.50.13;	author naddy;	state Exp;
branches;
next	1.63;
commitid	jyYyxI4cQA4JapGp;

1.63
date	2016.02.21.16.17.26;	author jsg;	state Exp;
branches;
next	1.62;
commitid	IZQsfcjAwN1evvTh;

1.62
date	2015.12.25.08.39.46;	author ajacoutot;	state Exp;
branches;
next	1.61;
commitid	lWzNW4D9TtO7X1J3;

1.61
date	2015.12.20.00.16.27;	author naddy;	state Exp;
branches;
next	1.60;
commitid	7FwUBfDRx93p0qtP;

1.60
date	2015.11.24.09.11.05;	author jasper;	state Exp;
branches;
next	1.59;
commitid	x9aAifyKiYiivEom;

1.59
date	2015.06.17.20.03.11;	author sthen;	state Exp;
branches;
next	1.58;
commitid	ASHe8W1wzY7eB3KC;

1.58
date	2015.05.22.11.31.16;	author ajacoutot;	state Exp;
branches;
next	1.57;
commitid	2khjHXfpTaOuNVcx;

1.57
date	2015.05.05.17.00.18;	author sthen;	state Exp;
branches;
next	1.56;
commitid	ukCYGVBlglFzny8e;

1.56
date	2015.02.16.22.57.09;	author naddy;	state Exp;
branches;
next	1.55;
commitid	0dx3c9ckf7dE4tx1;

1.55
date	2015.01.02.14.26.12;	author sthen;	state Exp;
branches;
next	1.54;
commitid	opt64GLzbD0TGQDJ;

1.54
date	2014.07.16.12.35.23;	author espie;	state Exp;
branches;
next	1.53;
commitid	C2ydepHwgMXxFvHx;

1.53
date	2014.04.24.21.47.24;	author edd;	state Exp;
branches;
next	1.52;

1.52
date	2014.04.04.17.17.03;	author edd;	state Exp;
branches;
next	1.51;

1.51
date	2014.01.12.14.58.30;	author naddy;	state Exp;
branches;
next	1.50;

1.50
date	2013.07.10.09.10.44;	author edd;	state Exp;
branches;
next	1.49;

1.49
date	2013.07.07.21.25.31;	author naddy;	state Exp;
branches;
next	1.48;

1.48
date	2013.05.06.17.49.37;	author naddy;	state Exp;
branches;
next	1.47;

1.47
date	2013.03.11.11.20.28;	author espie;	state Exp;
branches;
next	1.46;

1.46
date	2013.02.01.16.34.36;	author naddy;	state Exp;
branches;
next	1.45;

1.45
date	2013.01.08.13.36.47;	author jasper;	state Exp;
branches;
next	1.44;

1.44
date	2012.12.20.15.52.36;	author landry;	state Exp;
branches;
next	1.43;

1.43
date	2012.11.30.15.16.48;	author jasper;	state Exp;
branches;
next	1.42;

1.42
date	2012.10.15.15.18.32;	author sthen;	state Exp;
branches;
next	1.41;

1.41
date	2012.10.01.21.16.00;	author edd;	state Exp;
branches;
next	1.40;

1.40
date	2012.06.21.13.56.57;	author sthen;	state Exp;
branches
	1.40.2.1;
next	1.39;

1.39
date	2012.01.13.00.55.14;	author naddy;	state Exp;
branches;
next	1.38;

1.38
date	2011.09.17.16.06.32;	author edd;	state Exp;
branches;
next	1.37;

1.37
date	2011.09.15.15.36.54;	author jasper;	state Exp;
branches;
next	1.36;

1.36
date	2011.08.18.10.51.08;	author edd;	state Exp;
branches;
next	1.35;

1.35
date	2011.07.18.19.06.37;	author naddy;	state Exp;
branches
	1.35.2.1;
next	1.34;

1.34
date	2011.04.28.19.18.22;	author jasper;	state Exp;
branches;
next	1.33;

1.33
date	2011.04.28.18.59.18;	author jasper;	state Exp;
branches;
next	1.32;

1.32
date	2011.04.16.11.49.01;	author jasper;	state Exp;
branches;
next	1.31;

1.31
date	2011.04.11.06.43.39;	author jasper;	state Exp;
branches;
next	1.30;

1.30
date	2011.04.08.07.55.16;	author jasper;	state Exp;
branches;
next	1.29;

1.29
date	2011.01.15.01.09.43;	author naddy;	state Exp;
branches;
next	1.28;

1.28
date	2010.12.27.16.07.08;	author jasper;	state Exp;
branches;
next	1.27;

1.27
date	2010.12.22.23.24.21;	author jasper;	state Exp;
branches;
next	1.26;

1.26
date	2010.11.17.08.05.18;	author espie;	state Exp;
branches;
next	1.25;

1.25
date	2010.10.24.21.24.05;	author ajacoutot;	state Exp;
branches;
next	1.24;

1.24
date	2010.10.24.21.11.46;	author sthen;	state Exp;
branches;
next	1.23;

1.23
date	2010.10.18.19.20.42;	author espie;	state Exp;
branches;
next	1.22;

1.22
date	2010.07.24.23.05.08;	author naddy;	state Exp;
branches;
next	1.21;

1.21
date	2010.06.10.18.18.31;	author landry;	state Exp;
branches;
next	1.20;

1.20
date	2010.01.27.21.43.28;	author naddy;	state Exp;
branches;
next	1.19;

1.19
date	2009.08.10.17.31.07;	author kili;	state Exp;
branches;
next	1.18;

1.18
date	2009.06.22.17.00.23;	author naddy;	state Exp;
branches;
next	1.17;

1.17
date	2009.03.08.23.05.12;	author sthen;	state Exp;
branches;
next	1.16;

1.16
date	2009.02.09.20.48.23;	author naddy;	state Exp;
branches;
next	1.15;

1.15
date	2008.08.29.12.30.21;	author espie;	state Exp;
branches;
next	1.14;

1.14
date	2008.08.29.11.52.20;	author espie;	state Exp;
branches;
next	1.13;

1.13
date	2008.07.30.19.47.09;	author martynas;	state Exp;
branches;
next	1.12;

1.12
date	2008.07.04.16.46.10;	author naddy;	state Exp;
branches;
next	1.11;

1.11
date	2008.02.22.21.09.04;	author naddy;	state Exp;
branches;
next	1.10;

1.10
date	2008.01.04.17.48.36;	author espie;	state Exp;
branches;
next	1.9;

1.9
date	2007.11.14.09.43.39;	author steven;	state Exp;
branches;
next	1.8;

1.8
date	2007.07.27.22.01.38;	author naddy;	state Exp;
branches;
next	1.7;

1.7
date	2007.07.10.20.53.59;	author kili;	state Exp;
branches;
next	1.6;

1.6
date	2007.06.10.23.32.27;	author kili;	state Exp;
branches;
next	1.5;

1.5
date	2007.02.14.16.55.28;	author steven;	state Exp;
branches;
next	1.4;

1.4
date	2007.01.27.17.35.46;	author espie;	state Exp;
branches;
next	1.3;

1.3
date	2006.11.13.11.20.25;	author steven;	state Exp;
branches;
next	1.2;

1.2
date	2006.10.18.17.56.14;	author espie;	state Exp;
branches;
next	1.1;

1.1
date	2006.10.09.10.20.24;	author espie;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2006.10.09.10.20.24;	author espie;	state Exp;
branches;
next	;

1.35.2.1
date	2011.09.15.15.37.03;	author jasper;	state Exp;
branches;
next	;

1.40.2.1
date	2013.01.08.13.36.53;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.73
log
@sync with mail/maildrop as far as applicable
@
text
@# $OpenBSD: Makefile,v 1.72 2017/09/26 17:06:05 naddy Exp $

BROKEN-hppa =		undefined reference to __sync_fetch_and_add_4
BROKEN-sparc64 =	infinite loop or aborts during build

COMMENT =		Prolog for the real world

V =			6.6.4
REVISION =		12
DISTNAME =		pl-$V
PKGNAME =		swi-prolog-$V
CATEGORIES =		lang

SHARED_LIBS =		pl	5.0

HOMEPAGE =		http://www.swi-prolog.org/

MAINTAINER =		Edd Barrett <edd@@openbsd.org>

# LGPLv2.1
PERMIT_PACKAGE_CDROM =	Yes

WANTLIB += ICE SM X11 Xext Xft Xinerama Xpm Xt c crypto execinfo
WANTLIB += fontconfig freetype gmp jpeg m ncursesw pthread readline ssl
WANTLIB += z

MASTER_SITES =		${HOMEPAGE}download/stable/src/ \
			https://distfiles.nl/

CONFIGURE_STYLE =		gnu
MODGNU_CONFIG_GUESS_DIRS =	${WRKSRC}/src \
				${WRKSRC}/packages/jpl \
				${WRKSRC}/packages/xpce/src

CONFIGURE_ENV +=	CIFLAGS=' -I${LOCALBASE}/include' \
			LDFLAGS=' -L${LOCALBASE}/lib' \
			COFLAGS='${CFLAGS}'

CONFIGURE_ARGS =	--enable-mt \
			--disable-custom-flags \
			--with-world \
			--with-jpeg=${LOCALBASE} \
			--enable-shared

USE_GMAKE =		Yes

# Don't pick up bash
MAKE_ENV =		MAKESHELL=/bin/sh

MAKE_FLAGS =		SONAMEOPT= \
			SHAREDV=libpl.so.${LIBpl_VERSION}

MODULES =		gcc4
# for atomic builtins
MODGCC4_ARCHS =		arm

AUTOCONF_VERSION =	2.69
BUILD_DEPENDS =		${MODGNU_AUTOCONF_DEPENDS} \
			${RUN_DEPENDS}
LIB_DEPENDS =		devel/gmp \
			devel/libexecinfo \
			graphics/jpeg

FULLARCH =		${MACHINE_ARCH:S/amd64/x86_64/}-openbsd${OSREV}
SUBST_VARS +=		V BOOT FULLARCH

# only packages/clib/maildrop/rfc822/configure.in is patched
pre-configure:
	cd ${WRKSRC}/packages/clib/maildrop/rfc822 && \
	    AUTOCONF_VERSION=${AUTOCONF_VERSION} autoconf

post-install:
	cd ${PREFIX}/lib && \
		ln -sf swipl-$V/lib/${FULLARCH}/libpl.so.${LIBpl_VERSION}
	mv ${PREFIX}/lib/swipl-${V}/doc ${PREFIX}/share/doc/swipl

# Swipl multithreading flaky at best on OpenBSD.
# We are not sure if this is our threading implementation or their code.
# The following tests fail (hang). We remove them to allow the rest
# of the tests to execute atleast.
# When updating, uncomment these to see if they still fail.
pre-test:
	rm -f ${WRKBUILD}/src/Tests/core/test_resource_error.pl

.include <bsd.port.arch.mk>

.if ${PROPERTIES:Mlp64}
BOOT =	boot64
.else
BOOT =	boot32
.endif

.include <bsd.port.mk>
@


1.72
log
@Unbreak autoconf check with clang by not using nested functions
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.71 2017/08/21 19:25:52 naddy Exp $
d57 3
a59 1
BUILD_DEPENDS =		${RUN_DEPENDS}
d66 5
@


1.71
log
@bump for plist changes 6.1 -> 6.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.70 2017/03/14 12:23:21 jca Exp $
d9 1
a9 1
REVISION =		11
@


1.70
log
@Use lang/gcc for atomic builtins on arm

ok edd@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.68 2017/03/04 21:59:55 sthen Exp $
d9 1
a9 1
REVISION =		10
@


1.69
log
@Fix MASTER_SITES

ok edd@@ (maintainer)
@
text
@d3 1
a3 2
BROKEN-arm =		undefined reference to `__sync_fetch_and_add_4'
BROKEN-hppa =		undefined reference to `__sync_fetch_and_add_4'
d52 4
@


1.68
log
@bump ports with openbsd version number in filenames
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.67 2016/09/10 13:03:42 ajacoutot Exp $
d28 1
a28 1
MASTER_SITES =		${HOMEPAGE}/download/stable/src/ \
@


1.67
log
@First pass at pre-entively fixing ports that would break once guenther's header
pollution diff is in.

lang/squeak/vm does not build but it's due to the recent audio changes
games/xbattle: also fixes some conflicting implicit decl
print/hplip: also fixes some conflicting implicit decl
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.66 2016/05/12 01:17:13 naddy Exp $
d10 1
a10 1
REVISION =		9
@


1.66
log
@bump for plist changes 5.9 -> 6.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.65 2016/03/15 21:12:06 naddy Exp $
d10 1
a10 1
REVISION =		8
@


1.65
log
@replace after-bsd.port.mk hack with PROPERTIES check, regen PLIST
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.64 2016/03/10 11:50:13 naddy Exp $
d10 1
a10 1
REVISION =		7
@


1.64
log
@requires --enable-shared
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.63 2016/02/21 16:17:26 jsg Exp $
d10 1
a10 1
REVISION =		6
d75 1
a75 1
.include <bsd.port.mk>
d77 1
a77 2
.for _m in ${MACHINE_ARCH}
.  if !empty(LP64_ARCHS:M${_m})
d79 5
a83 3
.  endif
.endfor
BOOT ?=	boot32
@


1.63
log
@Don't attempt to build on arm.  sync atomic builtins required.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62 2015/12/25 08:39:46 ajacoutot Exp $
d44 1
a44 1
			${CONFIGURE_SHARED}
@


1.62
log
@Remove some BROKEN markers for ports that should build now with the new libgcc
assisted built-in atomic ops for mips64.

from Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.61 2015/12/20 00:16:27 naddy Exp $
d3 1
@


1.61
log
@bump for plist changes 5.8 -> 5.9
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.60 2015/11/24 09:11:05 jasper Exp $
a2 1
BROKEN-mips64 = 	undefined reference to `__sync_fetch_and_add_8'
@


1.60
log
@switch distfiles.nl to SSL, setup with security/letsencrypt/client
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59 2015/06/17 20:03:11 sthen Exp $
d10 1
a10 1
REVISION =		5
@


1.59
log
@port REVISION bumps as base has moved to 5.8
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2015/05/22 11:31:16 ajacoutot Exp $
d29 1
a29 1
			http://distfiles.nl/
@


1.58
log
@"/usr/local/lib/pkgconfig/" is part of mtree(8).
Packages should not own this dir to prevent its deletion or a warning that it
cannot be removed because it's not empty at pkg_delete(1) time.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.57 2015/05/05 17:00:18 sthen Exp $
d10 1
a10 1
REVISION =		4
@


1.57
log
@sync WANTLIB
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2015/02/16 22:57:09 naddy Exp $
d10 1
a10 1
REVISION =		3
@


1.56
log
@Drop USE_GROFF from ports where the formatting differences are acceptable
or mandoc provides the more useful output.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55 2015/01/02 14:26:12 sthen Exp $
d10 1
a10 1
REVISION =		2
d24 4
a57 4

WANTLIB += ICE SM X11 Xext Xft Xinerama Xpm Xt c crypto execinfo
WANTLIB += fontconfig gmp jpeg m ncursesw pthread
WANTLIB += readline ssl z
@


1.55
log
@bump REVISION for 5.7
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.54 2014/07/16 12:35:23 espie Exp $
a42 1
USE_GROFF =		Yes
@


1.54
log
@more 5.6 bumps
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2014/04/24 21:47:24 edd Exp $
d10 1
a10 1
REVISION =		1
@


1.53
log
@SWI Prolog: Unbreak the build (OpenSSL).

OK naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.52 2014/04/04 17:17:03 edd Exp $
d10 1
a10 1
REVISION =		0
@


1.52
log
@Update SWI Prolog to version 6.6.4.

OK ajacoutot@@, benoit@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2013/07/10 09:10:44 edd Exp $
d10 1
@


1.51
log
@bump for plist changes 5.4 -> 5.5
@
text
@d9 1
a9 1
V =			6.2.6
a11 1
REVISION =		0
d14 1
a14 1
SHARED_LIBS =		pl	4.0
d18 2
d26 1
a26 3
CONFIGURE_STYLE =	autoconf
AUTOCONF_VERSION =	2.68
AUTOCONF_DIR =		${WRKSRC}/src ${WRKSRC}/packages/semweb
d33 1
a33 1
			COFLAGS='-O2 -pipe -g'
a71 1
# Still failing 20130623 :(
a72 1
	rm -f ${WRKBUILD}/src/Tests/thread/test_signal.pl
@


1.50
log
@Update to swi-prolog-6.2.6 and move docs to where you would expect.

OK jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2013/07/07 21:25:31 naddy Exp $
d12 1
@


1.49
log
@bump for plist changes 5.3 -> 5.4
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2013/05/06 17:49:37 naddy Exp $
d9 1
a9 1
V =			6.2.2
a11 1
REVISION =		2
d56 1
a56 1
WANTLIB += expat fontconfig freetype gmp jpeg m ncursesw pthread
d65 1
d72 1
@


1.48
log
@avoid picking up bash in a sub-configure started during the build stage
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2013/03/11 11:20:28 espie Exp $
d12 1
a12 1
REVISION =		1
@


1.47
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2013/02/01 16:34:36 naddy Exp $
d44 3
@


1.46
log
@bump for plist changes 5.2 -> 5.3
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2013/01/08 13:36:47 jasper Exp $
a20 3
PERMIT_PACKAGE_FTP =	Yes
PERMIT_DISTFILES_CDROM =Yes
PERMIT_DISTFILES_FTP =	Yes
d69 1
a69 1
pre-regress:
@


1.45
log
@Security fixes for CVE-2012-6089 and CVE-2012-6090,
Multiple (stack-based) buffer overflows in patch canonisation code and when expanding file-names with long paths

Patches taken from upstream
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2012/12/20 15:52:36 landry Exp $
d12 1
a12 1
REVISION =		0
@


1.44
log
@Mark as BROKEN on sparc64 and hppa. crashes/infinite loops on the
former, undefined refs to atomic ops on the latter.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2012/11/30 15:16:48 jasper Exp $
d12 1
@


1.43
log
@mark broken on mips64
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2012/10/15 15:18:32 sthen Exp $
d4 2
@


1.42
log
@zap trailing whitespace in files where it's present on PERMIT_* lines
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.41 2012/10/01 21:16:00 edd Exp $
@


1.41
log
@Update to swi-prolog-6.2.2.

OK jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2012/06/21 13:56:57 sthen Exp $
d17 1
a17 1
PERMIT_DISTFILES_CDROM =Yes 
@


1.40
log
@bump for plist changes 5.1 -> 5.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2012/01/13 00:55:14 naddy Exp $
d5 1
a5 2
V =			5.10.5
XV =			6.6.66
a7 1
REVISION =		1
d10 1
a10 1
SHARED_LIBS =		pl	3.0
d17 1
a17 1
PERMIT_DISTFILES_CDROM = Yes 
d24 1
a24 1
AUTOCONF_VERSION =	2.67
d30 4
a33 2
CONFIGURE_ENV +=	LDFLAGS=-L${LOCALBASE}/lib \
			CPPFLAGS=-I${LOCALBASE}/include
a46 1
RUN_DEPENDS =		graphics/jpeg
d48 2
a49 1
			devel/libexecinfo
d51 3
a53 2
WANTLIB +=	ICE SM X11 Xext Xft Xinerama Xpm Xt c crypto execinfo gmp 
WANTLIB +=	jpeg m ncursesw pthread readline ssl z
d56 1
a56 9
SUBST_VARS =		V XV FULLARCH BOOT

# warning: #warning "<malloc.h> is obsolete, use <stdlib.h>"
pre-patch:
	find ${WRKSRC}/packages/{clib,sgml,xpce} -name '*.[ch]' | \
	  xargs fgrep -l malloc.h | \
	while read i; do \
		sed -e 's/malloc.h/stdlib.h/' $$i >$$i.bak && mv $$i.bak $$i; \
	done
d60 1
a60 8
		ln -s swipl-$V/lib/${FULLARCH}/libpl.so.${LIBpl_VERSION}
	mv ${PREFIX}/lib/swipl-${V}/xpce-${XV}/man/xpce-client.1 \
		${PREFIX}/man/man1/

# XXX figure out why these tests fail
######pre-regress:
######	rm ${WRKBUILD}/src/Tests/thread/agc.pl
######	rm ${WRKBUILD}/src/Tests/thread/agc2.pl
d62 8
@


1.40.2.1
log
@Security fixes for CVE-2012-6089 and CVE-2012-6090,
Multiple (stack-based) buffer overflows in patch canonisation code and when expanding file-names with long paths

Patches taken from upstream
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2012/06/21 13:56:57 sthen Exp $
d9 1
a9 1
REVISION =		2
@


1.39
log
@bump revision for plist changes 5.0 -> 5.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2011/09/17 16:06:32 edd Exp $
d9 1
a9 1
REVISION =		0
@


1.38
log
@Update swi-prolog to 5.10.5.

OK jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2011/09/15 15:36:54 jasper Exp $
d9 1
@


1.37
log
@  Security fix for CVE-2011-2896,
    SWI-Prolog XPCE Component "LZWReadByte()" Buffer Overflow Vulnerability
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2011/08/18 10:51:08 edd Exp $
d5 1
a5 1
V =			5.10.4
a8 1
REVISION =		4
d47 2
a48 1
LIB_DEPENDS =		devel/gmp
d50 2
a51 2
WANTLIB +=	ICE SM X11 Xext Xft Xinerama Xpm Xt c crypto gmp jpeg m
WANTLIB +=	ncursesw pthread readline ssl z
d65 10
a74 1
	cd ${PREFIX}/lib && ln -s swipl-$V/lib/${FULLARCH}/libpl.so.${LIBpl_VERSION}
@


1.36
log
@Add gmp support, so as to enable missing arithmetic functions (eg.
rationalize/1). Also fix WANTLIB.

OK jasper@@

NOTE: port-lib-depends-check is still broken for this port. For now we can use
lib-depends-check instead.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2011/07/18 19:06:37 naddy Exp $
d9 1
a9 1
REVISION =		3
@


1.35
log
@bump revision for plist changes 4.9 -> 5.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2011/04/28 19:18:22 jasper Exp $
d9 1
a9 1
REVISION =		2
d31 3
d48 4
a51 1
WANTLIB +=  c m ncursesw pthread pthread-stubs readline z
@


1.35.2.1
log
@  Security fix for CVE-2011-2896,
    SWI-Prolog XPCE Component "LZWReadByte()" Buffer Overflow Vulnerability
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2011/07/18 19:06:37 naddy Exp $
d9 1
a9 1
REVISION =		3
@


1.34
log
@make build logs a lot easier to read by zapping the
"<malloc.h> is obsolete, use <stdlib.h>" warnings.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2011/04/28 18:59:18 jasper Exp $
d9 1
a9 1
REVISION =		1
@


1.33
log
@- enable rdf and sgml libraries now that libc has swprintf()
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2011/04/16 11:49:01 jasper Exp $
d49 8
@


1.32
log
@- switch to autoconf 2.67. config.h was checked.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2011/04/11 06:43:39 jasper Exp $
d9 1
a9 1
REVISION =		0
a48 5

# Don't build sgml (and dependant RDF), as it requires having swprintf()
# and the like.
post-extract:
	@@rm -fr ${WRKSRC}/packages/{sgml,RDF}
@


1.31
log
@this does need jpeg after all
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2011/04/08 07:55:16 jasper Exp $
d26 1
a26 1
AUTOCONF_VERSION =	2.65 # 2.67
@


1.30
log
@- update to 5.10.4
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2011/01/15 01:09:43 naddy Exp $
d9 1
d34 1
d43 2
@


1.29
log
@bump revision for plist changes 4.8 -> 4.9
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2010/12/27 16:07:08 jasper Exp $
d5 1
a5 1
V =			5.10.2
a8 1
REVISION =		0
d25 1
a25 1
AUTOCONF_VERSION =	2.61 # 2.64
a32 1
			--with-jpeg=${LOCALBASE} \
d41 1
a41 5
WANTLIB += ICE SM X11 Xau Xdmcp Xext Xft Xinerama Xpm Xrender
WANTLIB += Xt c expat fontconfig freetype m ncursesw pthread pthread-stubs
WANTLIB += readline xcb z jpeg

LIB_DEPENDS =		graphics/jpeg
d46 2
a50 2
# Don't build sgml (and dependant RDF), as it requires having swprintf()
# and the like.
@


1.28
log
@- update swi-prolog to 5.10.2
- unbreak on hppa (tested by landry@@)

If you are upgrading from an older release (e.g. 5.6.x) it is advised to
read the upgrading guide which is available from
http://www.swi-prolog.org/Upgrade-5.8.html
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2010/12/22 23:24:21 jasper Exp $
d9 1
@


1.27
log
@- make this fetchable again
- set a license version
- make Makefile somewhat readable
- reformat DESCR
- regen PLIST
- regen WANTLIB
@
text
@d1 1
a1 3
# $OpenBSD: Makefile,v 1.26 2010/11/17 08:05:18 espie Exp $

BROKEN-hppa =		build stalls during bootstrap in packages/chr 
d5 2
a6 2
V =			5.6.59
XV =			6.6.58
a8 1
REVISION =		6
d11 1
a11 1
SHARED_LIBS =		pl	2.0
d21 2
a22 1
MASTER_SITES =		http://distfiles.nl/
d25 1
a25 1
AUTOCONF_VERSION =	2.60
a32 1
			--disable-gmp \
a33 1
			--without-sgml \
d51 5
@


1.26
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2010/10/24 21:24:05 ajacoutot Exp $
d5 2
a6 1
CATEGORIES =		lang
a8 2
FULLARCH =		${MACHINE_ARCH:S/amd64/x86_64/}-openbsd${OSREV}
SUBST_VARS =		V XV FULLARCH
d11 2
a12 4
REVISION =		5
MASTER_SITES =		http://gollem.science.uva.nl/cgi-bin/nph-download/SWI-Prolog/
COMMENT =		Prolog for the real world
HOMEPAGE =		http://www.swi-prolog.org/
d16 3
a18 1
# LGPL
d24 2
d41 1
a41 1
USE_GROFF =	Yes
d47 1
a47 1
WANTLIB += Xt c expat fontconfig freetype m ncurses pthread pthread-stubs
d51 3
a53 1
SUBST_VARS +=		BOOT
@


1.25
log
@Remove USE_X11.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2010/10/24 21:11:46 sthen Exp $
d49 1
a49 1
LIB_DEPENDS =		::graphics/jpeg
@


1.24
log
@new lib_depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2010/10/18 19:20:42 espie Exp $
a38 1
USE_X11 =		Yes
@


1.23
log
@USE_GROFF=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2010/07/24 23:05:08 naddy Exp $
d48 1
a48 1
WANTLIB += readline xcb z
d50 1
a50 1
LIB_DEPENDS =		jpeg::graphics/jpeg
@


1.22
log
@bump PKGNAME for PLIST changes 4.7 -> 4.8
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2010/06/10 18:18:31 landry Exp $
d41 1
@


1.21
log
@Mark as BROKEN on hppa, build stalls hard when bootstrapping in packages/chr.
If someone wants to fix it, be my guest.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2010/01/27 21:43:28 naddy Exp $
d11 2
a12 1
PKGNAME =		swi-prolog-$Vp4
@


1.20
log
@bump PKGNAME for PLIST changes 4.6 -> 4.7
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.19 2009/08/10 17:31:07 kili Exp $
@


1.19
log
@WANTLIB changes after xcb addition and bump.

For some unknown reason, I forgot to commit lang/*
this morning.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2009/06/22 17:00:23 naddy Exp $
d9 1
a9 1
PKGNAME =		swi-prolog-$Vp3
@


1.18
log
@bump PKGNAME for PLIST changes 4.5 -> 4.6
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2009/03/08 23:05:12 sthen Exp $
d9 1
a9 1
PKGNAME =		swi-prolog-$Vp2
d43 2
a44 2
WANTLIB += Xt c expat fontconfig freetype m ncurses pthread readline
WANTLIB += z
@


1.17
log
@fix WANTLIB and bump.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2009/02/09 20:48:23 naddy Exp $
d9 1
a9 1
PKGNAME =		swi-prolog-$Vp1
@


1.16
log
@bump PKGNAME for PLIST changes 4.4 -> 4.5
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2008/08/29 12:30:21 espie Exp $
d9 1
a9 1
PKGNAME =		swi-prolog-$Vp0
d42 3
a44 3
WANTLIB =		ICE Xrender readline SM freetype Xt pthread \
			c Xinerama Xft Xpm m fontconfig X11 ncurses z \
			Xau Xdmcp expat
@


1.15
log
@update to 5.6.59
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2008/08/29 11:52:20 espie Exp $
d9 1
a9 1
PKGNAME =		swi-prolog-$V
@


1.14
log
@fix stupid conflict marker introduced ages ago that my friends forgot to fix...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2008/07/30 19:47:09 martynas Exp $
d3 10
a12 10
CATEGORIES=		lang
V=			5.6.27
XV=			6.6.27
FULLARCH=		${MACHINE_ARCH:S/amd64/x86_64/}-openbsd${OSREV}
SUBST_VARS=		V XV FULLARCH
DISTNAME=		pl-$V
PKGNAME=		swi-prolog-$Vp7
MASTER_SITES=		http://gollem.science.uva.nl/cgi-bin/nph-download/SWI-Prolog/
COMMENT=		Prolog for the real world
HOMEPAGE=		http://www.swi-prolog.org/
d14 1
a14 1
SHARED_LIBS=		pl	1.0
d17 9
a25 9
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM= Yes 
PERMIT_DISTFILES_FTP=	Yes

CONFIGURE_STYLE=	autoconf
AUTOCONF_VERSION=	2.59
AUTOCONF_DIR=		${WRKSRC}/src ${WRKSRC}/packages/semweb
MODGNU_CONFIG_GUESS_DIRS=	${WRKSRC}/src \
d28 1
a28 1
CONFIGURE_ARGS=		--enable-mt \
d36 2
a37 2
USE_X11=		Yes
USE_GMAKE=		Yes
d39 1
a39 1
MAKE_FLAGS=		SONAMEOPT= \
d42 1
a42 1
WANTLIB=		ICE Xrender readline SM freetype Xt pthread \
d46 2
a47 2
LIB_DEPENDS=		jpeg::graphics/jpeg
SUBST_VARS+=		BOOT
d56 1
a56 1
BOOT=boot64
d59 1
a59 1
BOOT?=boot32
@


1.13
log
@last round of library bumps due to libc/libm changes.  from sthen@@
double-checked & ok naddy@@, go for it pval@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2008/07/04 16:46:10 naddy Exp $
d9 1
a9 1
PKGNAME=		swi-prolog-$Vp6
d48 3
@


1.12
log
@bump PKGNAME for PLIST changes 4.3 -> 4.4
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2008/02/22 21:09:04 naddy Exp $
d9 1
a9 1
PKGNAME=		swi-prolog-$Vp5
d14 1
a14 1
SHARED_LIBS=		pl	0.0
@


1.11
log
@bump PKGNAME for PLIST changes 4.2 -> 4.3
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2008/01/04 17:48:36 espie Exp $
d9 1
a9 1
PKGNAME=		swi-prolog-$Vp4
@


1.10
log
@tweak FAKE_FLAGS semantics to saner defaults.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2007/11/14 09:43:39 steven Exp $
d9 1
a9 1
PKGNAME=		swi-prolog-$Vp3
@


1.9
log
@fix WANTLIB
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2007/07/27 22:01:38 naddy Exp $
a40 2
FAKE_FLAGS=		${MAKE_FLAGS} \
			DESTDIR=${WRKINST}
@


1.8
log
@bump package name due to OSREV increment
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2007/07/10 20:53:59 kili Exp $
d9 1
a9 1
PKGNAME=		swi-prolog-$Vp2
d45 2
a46 1
			c Xinerama Xft Xpm m fontconfig X11 ncurses z
@


1.7
log
@
Unbreak for amd64. Noticed, suggested and ok, steven@@.

Zap a -O3 from packages/semweb and honor our CFLAGS instead (also
noticed by steven@@). No ok (or any feedback at all) for this. But I'm
pretty sure it doesn't break *%&$#@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2007/06/10 23:32:27 kili Exp $
d9 1
a9 1
PKGNAME=		swi-prolog-$Vp1
d11 1
a11 1
COMMENT=		'prolog for the real world'
@


1.6
log
@
Spread our own config.guess where appropriate and unbreak the build
at least on powerpc.
While here, s/WRKDIST/WRKSRC/

Suggested by (after a naive patch from me) and ok, espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2007/02/14 16:55:28 steven Exp $
d6 1
a6 1
FULLARCH=		${MACHINE_ARCH}-openbsd${OSREV}
d9 1
a9 1
PKGNAME=		swi-prolog-$Vp0
d24 1
a24 1
AUTOCONF_DIR=		${WRKSRC}/src
@


1.5
log
@bump PKGNAME due to PLIST changes after 4.0 -> 4.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2007/01/27 17:35:46 espie Exp $
d24 4
a27 1
AUTOCONF_DIR=		${WRKDIST}/src
@


1.4
log
@update to 5.6.27. We lose the sgml package temporarily (wide-chars),
but we gain sparc64 support ! seems the fixes for win64 also fixed
our problems.

Add a few SUBST variables to simplify packing-list comparisons.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2006/11/13 11:20:25 steven Exp $
d9 1
a9 1
PKGNAME=		swi-prolog-$V
@


1.3
log
@USE_X11
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2006/10/18 17:56:14 espie Exp $
d4 4
a7 2
V=			5.6.18
SUBST_VARS=		V
d30 1
d37 1
a37 2
			SHAREDV=libpl.so.${LIBpl_VERSION} \
			CONFIGURE_ARGS='$(CONFIGURE_ARGS)'
d42 1
a42 1
			c Xinerama Xft Xpm m fontconfig X11 ncurses
@


1.2
log
@variant part for 64 bit architectures.
No pkg bump, since it doesn't affect the packages that were already
building correctly.

found out by nikolay.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2006/10/09 10:20:24 espie Exp $
d30 1
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d42 1
d45 7
@


1.1.1.1
log
@prolog interpreter that works, since gnu-prolog depends on a memory model
that doesn't work well for us.
@
text
@@
