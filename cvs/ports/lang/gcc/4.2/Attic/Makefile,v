head	1.98;
access;
symbols
	OPENBSD_5_7:1.97.0.2
	OPENBSD_5_7_BASE:1.97
	OPENBSD_5_6:1.95.0.6
	OPENBSD_5_6_BASE:1.95
	OPENBSD_5_5:1.95.0.4
	OPENBSD_5_5_BASE:1.95
	OPENBSD_5_4:1.95.0.2
	OPENBSD_5_4_BASE:1.95
	OPENBSD_5_3:1.93.0.2
	OPENBSD_5_3_BASE:1.93
	OPENBSD_5_2:1.79.0.2
	OPENBSD_5_2_BASE:1.79
	OPENBSD_5_1_BASE:1.74
	OPENBSD_5_1:1.74.0.2
	OPENBSD_5_0:1.61.0.2
	OPENBSD_5_0_BASE:1.61
	OPENBSD_4_9:1.60.0.2
	OPENBSD_4_9_BASE:1.60
	OPENBSD_4_8:1.49.0.2
	OPENBSD_4_8_BASE:1.49
	OPENBSD_4_7:1.47.0.2
	OPENBSD_4_7_BASE:1.47
	OPENBSD_4_6:1.36.0.2
	OPENBSD_4_6_BASE:1.36
	OPENBSD_4_5:1.27.0.2
	OPENBSD_4_5_BASE:1.27
	OPENBSD_4_4:1.22.0.2
	OPENBSD_4_4_BASE:1.22
	OPENBSD_4_3:1.20.0.2
	OPENBSD_4_3_BASE:1.20
	OPENBSD_4_2:1.15.0.2
	OPENBSD_4_2_BASE:1.15
	OPENBSD_4_1:1.8.0.2
	OPENBSD_4_1_BASE:1.8
	OPENBSD_4_0:1.2.0.2
	OPENBSD_4_0_BASE:1.2
	fsf:1.1.1.1
	gcc:1.1.1;
locks; strict;
comment	@# @;


1.98
date	2015.03.19.16.56.02;	author pascal;	state dead;
branches;
next	1.97;
commitid	4NK6qdfGpCJ0tDvy;

1.97
date	2015.01.02.14.26.12;	author sthen;	state Exp;
branches;
next	1.96;
commitid	opt64GLzbD0TGQDJ;

1.96
date	2014.11.22.17.00.13;	author espie;	state Exp;
branches;
next	1.95;
commitid	KElAdqgn3kzh9cwq;

1.95
date	2013.03.21.08.46.32;	author ajacoutot;	state Exp;
branches;
next	1.94;

1.94
date	2013.03.11.11.20.27;	author espie;	state Exp;
branches;
next	1.93;

1.93
date	2013.02.04.21.23.40;	author tobiasu;	state Exp;
branches;
next	1.92;

1.92
date	2013.02.01.16.34.36;	author naddy;	state Exp;
branches;
next	1.91;

1.91
date	2013.01.28.01.03.05;	author tobiasu;	state Exp;
branches;
next	1.90;

1.90
date	2013.01.27.15.00.23;	author tobiasu;	state Exp;
branches;
next	1.89;

1.89
date	2012.12.28.14.32.00;	author espie;	state Exp;
branches;
next	1.88;

1.88
date	2012.12.27.18.16.44;	author espie;	state Exp;
branches;
next	1.87;

1.87
date	2012.11.06.00.57.43;	author tobiasu;	state Exp;
branches;
next	1.86;

1.86
date	2012.10.07.20.09.44;	author landry;	state Exp;
branches;
next	1.85;

1.85
date	2012.09.28.15.02.28;	author pascal;	state Exp;
branches;
next	1.84;

1.84
date	2012.09.26.17.36.46;	author naddy;	state Exp;
branches;
next	1.83;

1.83
date	2012.09.01.00.00.32;	author pascal;	state Exp;
branches;
next	1.82;

1.82
date	2012.08.29.20.51.41;	author sthen;	state Exp;
branches;
next	1.81;

1.81
date	2012.08.28.23.39.12;	author sthen;	state Exp;
branches;
next	1.80;

1.80
date	2012.08.20.12.35.41;	author pascal;	state Exp;
branches;
next	1.79;

1.79
date	2012.06.21.13.56.57;	author sthen;	state Exp;
branches;
next	1.78;

1.78
date	2012.05.07.10.34.33;	author pascal;	state Exp;
branches;
next	1.77;

1.77
date	2012.05.04.08.47.55;	author pascal;	state Exp;
branches;
next	1.76;

1.76
date	2012.04.23.14.12.18;	author pascal;	state Exp;
branches;
next	1.75;

1.75
date	2012.02.22.12.40.04;	author kurt;	state Exp;
branches;
next	1.74;

1.74
date	2012.01.23.22.20.34;	author espie;	state Exp;
branches;
next	1.73;

1.73
date	2012.01.23.14.59.57;	author espie;	state Exp;
branches;
next	1.72;

1.72
date	2012.01.23.14.47.37;	author espie;	state Exp;
branches;
next	1.71;

1.71
date	2012.01.13.00.55.14;	author naddy;	state Exp;
branches;
next	1.70;

1.70
date	2012.01.04.12.29.01;	author sthen;	state Exp;
branches;
next	1.69;

1.69
date	2011.12.03.15.54.05;	author naddy;	state Exp;
branches;
next	1.68;

1.68
date	2011.11.24.17.55.58;	author nigel;	state Exp;
branches;
next	1.67;

1.67
date	2011.11.16.12.32.49;	author espie;	state Exp;
branches;
next	1.66;

1.66
date	2011.10.04.07.08.54;	author espie;	state Exp;
branches;
next	1.65;

1.65
date	2011.09.25.14.12.10;	author espie;	state Exp;
branches;
next	1.64;

1.64
date	2011.09.25.12.19.23;	author espie;	state Exp;
branches;
next	1.63;

1.63
date	2011.09.16.10.31.20;	author espie;	state Exp;
branches;
next	1.62;

1.62
date	2011.09.15.17.25.34;	author espie;	state Exp;
branches;
next	1.61;

1.61
date	2011.07.18.19.06.36;	author naddy;	state Exp;
branches;
next	1.60;

1.60
date	2011.02.08.09.37.51;	author espie;	state Exp;
branches;
next	1.59;

1.59
date	2011.01.15.01.09.43;	author naddy;	state Exp;
branches;
next	1.58;

1.58
date	2010.11.28.21.30.37;	author jasper;	state Exp;
branches;
next	1.57;

1.57
date	2010.11.26.14.17.17;	author espie;	state Exp;
branches;
next	1.56;

1.56
date	2010.11.22.09.23.58;	author espie;	state Exp;
branches;
next	1.55;

1.55
date	2010.11.17.08.05.17;	author espie;	state Exp;
branches;
next	1.54;

1.54
date	2010.11.13.16.26.41;	author naddy;	state Exp;
branches;
next	1.53;

1.53
date	2010.11.07.19.12.42;	author espie;	state Exp;
branches;
next	1.52;

1.52
date	2010.10.31.22.38.42;	author kurt;	state Exp;
branches;
next	1.51;

1.51
date	2010.10.29.08.50.38;	author naddy;	state Exp;
branches;
next	1.50;

1.50
date	2010.10.18.19.20.41;	author espie;	state Exp;
branches;
next	1.49;

1.49
date	2010.07.24.23.05.08;	author naddy;	state Exp;
branches;
next	1.48;

1.48
date	2010.07.10.13.33.46;	author naddy;	state Exp;
branches;
next	1.47;

1.47
date	2010.01.27.21.43.28;	author naddy;	state Exp;
branches;
next	1.46;

1.46
date	2009.12.20.10.40.05;	author landry;	state Exp;
branches;
next	1.45;

1.45
date	2009.12.20.10.15.36;	author espie;	state Exp;
branches;
next	1.44;

1.44
date	2009.11.20.21.08.19;	author naddy;	state Exp;
branches;
next	1.43;

1.43
date	2009.11.20.17.41.16;	author naddy;	state Exp;
branches;
next	1.42;

1.42
date	2009.11.18.00.49.09;	author sthen;	state Exp;
branches;
next	1.41;

1.41
date	2009.11.12.10.13.19;	author espie;	state Exp;
branches;
next	1.40;

1.40
date	2009.10.15.18.02.33;	author steven;	state Exp;
branches;
next	1.39;

1.39
date	2009.10.10.22.48.29;	author jasper;	state Exp;
branches;
next	1.38;

1.38
date	2009.09.23.20.57.02;	author jasper;	state Exp;
branches;
next	1.37;

1.37
date	2009.07.13.23.13.34;	author jsg;	state Exp;
branches;
next	1.36;

1.36
date	2009.06.22.17.00.23;	author naddy;	state Exp;
branches;
next	1.35;

1.35
date	2009.06.11.21.45.07;	author pvalchev;	state Exp;
branches;
next	1.34;

1.34
date	2009.06.07.01.22.05;	author robert;	state Exp;
branches;
next	1.33;

1.33
date	2009.06.04.18.24.20;	author kurt;	state Exp;
branches;
next	1.32;

1.32
date	2009.05.16.23.50.31;	author sthen;	state Exp;
branches;
next	1.31;

1.31
date	2009.05.09.20.01.13;	author robert;	state Exp;
branches;
next	1.30;

1.30
date	2009.04.27.12.30.26;	author kurt;	state Exp;
branches;
next	1.29;

1.29
date	2009.04.21.21.02.34;	author kurt;	state Exp;
branches;
next	1.28;

1.28
date	2009.04.16.18.36.48;	author espie;	state Exp;
branches;
next	1.27;

1.27
date	2009.02.09.20.48.23;	author naddy;	state Exp;
branches;
next	1.26;

1.26
date	2009.01.26.22.09.19;	author landry;	state Exp;
branches;
next	1.25;

1.25
date	2009.01.19.21.39.29;	author naddy;	state Exp;
branches;
next	1.24;

1.24
date	2009.01.18.18.47.05;	author robert;	state Exp;
branches;
next	1.23;

1.23
date	2008.09.11.19.22.05;	author martynas;	state Exp;
branches;
next	1.22;

1.22
date	2008.07.04.19.41.21;	author naddy;	state Exp;
branches;
next	1.21;

1.21
date	2008.06.12.01.14.06;	author kurt;	state Exp;
branches;
next	1.20;

1.20
date	2008.02.23.00.26.07;	author naddy;	state Exp;
branches;
next	1.19;

1.19
date	2007.12.20.16.11.35;	author ajacoutot;	state Exp;
branches;
next	1.18;

1.18
date	2007.10.22.16.28.45;	author espie;	state Exp;
branches;
next	1.17;

1.17
date	2007.09.22.07.52.07;	author sturm;	state Exp;
branches;
next	1.16;

1.16
date	2007.09.16.00.27.05;	author merdely;	state Exp;
branches;
next	1.15;

1.15
date	2007.07.30.23.31.46;	author naddy;	state Exp;
branches;
next	1.14;

1.14
date	2007.06.19.21.23.37;	author ajacoutot;	state Exp;
branches;
next	1.13;

1.13
date	2007.05.16.10.19.14;	author steven;	state Exp;
branches;
next	1.12;

1.12
date	2007.04.01.16.44.19;	author sturm;	state Exp;
branches;
next	1.11;

1.11
date	2007.03.20.10.48.52;	author espie;	state Exp;
branches;
next	1.10;

1.10
date	2007.03.17.22.34.13;	author espie;	state Exp;
branches;
next	1.9;

1.9
date	2007.03.17.21.58.45;	author espie;	state Exp;
branches;
next	1.8;

1.8
date	2007.02.14.16.55.28;	author steven;	state Exp;
branches;
next	1.7;

1.7
date	2006.11.25.16.26.46;	author espie;	state Exp;
branches;
next	1.6;

1.6
date	2006.11.01.23.57.24;	author naddy;	state Exp;
branches;
next	1.5;

1.5
date	2006.10.20.13.43.18;	author espie;	state Exp;
branches;
next	1.4;

1.4
date	2006.10.20.11.03.38;	author espie;	state Exp;
branches;
next	1.3;

1.3
date	2006.10.06.12.42.42;	author kurt;	state Exp;
branches;
next	1.2;

1.2
date	2006.08.01.08.58.11;	author espie;	state Exp;
branches;
next	1.1;

1.1
date	2006.07.31.09.50.53;	author espie;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2006.07.31.09.50.53;	author espie;	state Exp;
branches;
next	;


desc
@@


1.98
log
@remove 4.2.  long unused, doesn't build, tobiasu@@ doesn't need it any more.

prompted by naddy@@, ok tobiasu@@
@
text
@# $OpenBSD: Makefile,v 1.97 2015/01/02 14:26:12 sthen Exp $

# TODO: hppa mips64 mips64el sparc
ONLY_FOR_ARCHS = alpha i386 sparc64 powerpc amd64 arm sh

DPB_PROPERTIES = parallel

V = 4.2.4
FULL_VERSION = $V
FULL_PKGVERSION = $V

ADASTRAP_LIBC-i386 = 60.1
ADASTRAP-i386 = adastrap-i386-$V-5.tgz
ADASTRAP_LIBC-amd64 = 66.0
ADASTRAP-amd64 = adastrap-amd64-$V-1.tgz
ADASTRAP_LIBC-sparc64 = 66.0
ADASTRAP-sparc64 = adastrap-sparc64-$V-1.tgz

PKGNAME-main =  gcc-${FULL_PKGVERSION}
PKGNAME-c++ =   g++-${FULL_PKGVERSION}
PKGNAME-estdc = libstdc++-${FULL_PKGVERSION}
PKGNAME-f95 =   g95-${FULL_PKGVERSION}
PKGNAME-java =  gcj-${FULL_PKGVERSION}
PKGNAME-objc =  gobjc-${FULL_PKGVERSION}
PKGNAME-ada =   gnat-${FULL_PKGVERSION}

REVISION = 19
EPOCH = 0

SHARED_LIBS =	estdc++		13.0 \
		gfortran	2.0 \
		-org-w3c-dom	1.0 \
		-org-xml-sax	1.0 \
		gcj		0.0 \
		ffi		0.0 \
		gcj-tools	0.0 \
		gij		0.0 \
		objc		2.0 \
		objc_gc		2.0 \
		ssp		0.0 \
		gomp		1.0

MAINTAINER =	Marc Espie <espie@@openbsd.org>

USE_GROFF =	Yes
PSEUDO_FLAVORS = no_c++ no_f95 no_objc no_java no_ada full
FLAVOR ?= 

# XXX bootstrap currently broken
ONLY_FOR_ARCHS-ada = #i386 amd64 sparc64
ONLY_FOR_ARCHS-java = amd64 sparc64 i386

MULTI_PACKAGES = -main -f95 -objc -java -c++ -estdc -ada

.include <bsd.port.arch.mk>

# kill both C++ subpackages
.if !${BUILD_PACKAGES:M-c++}
BUILD_PACKAGES := ${BUILD_PACKAGES:N-estdc}
.endif

DISTFILES =  ${DISTNAME}.tar.bz2
SUPDISTFILES =	${ADASTRAP-i386}:0 ${ADASTRAP-amd64}:0 ${ADASTRAP-sparc64}:0

BUILD_DEPENDS += devel/autoconf/2.59
BUILD_DEPENDS += devel/metaauto

BUILD_DEPENDS += devel/bison


TEST_DEPENDS = 	devel/dejagnu \
			devel/autogen

DISTNAME =   	gcc-${FULL_VERSION}


MASTER_SITES =	${MASTER_SITE_GCC:=releases/gcc-$(FULL_VERSION)/}
MASTER_SITES0 = http://distfiles.tmux.org/adastrap/

CONFIGURE_STYLE =	gnu
MODGNU_CONFIG_GUESS_DIRS =	${WRKSRC} ${WRKSRC}/gcc

LANGS = c
.if ${BUILD_PACKAGES:M-c++}
LANGS := ${LANGS},c++
TEST_DEPENDS += 	libstdc++->=4.2,<4.3|libstdc++->=4.2v0,<4.3v0:${BUILD_PKGPATH},-estdc
.endif
.if ${BUILD_PACKAGES:M-f95}
LANGS := ${LANGS},fortran
CONFIGURE_ARGS += --with-gmp=${LOCALBASE}
.endif
.if ${BUILD_PACKAGES:M-objc}
LANGS := ${LANGS},objc
.endif
.if ${BUILD_PACKAGES:M-java}
LANGS := ${LANGS},java
BUILD_DEPENDS += archivers/zip>=2.3p0
CONFIGURE_ARGS += --enable-libgcj
.endif
.if ${BUILD_PACKAGES:M-ada}
LANGS := ${LANGS},ada
DISTFILES += ${ADASTRAP-${MACHINE_ARCH}}:0
CONFIGURE_ENV = ADAC=${WRKDIR}/bin/egcc GNATBIND=${WRKDIR}/bin/gnatbind
MAKE_ENV = ADAC=${WRKDIR}/bin/egcc GNATBIND=${WRKDIR}/bin/gnatbind
CC = ${WRKDIR}/bin/egcc
TEST_DEPENDS += ${BUILD_PKGPATH},-ada
.endif

post-extract:
.for f in egcc gnatbind gnatmake gnatlink
	echo "#! /bin/sh" >${WRKDIR}/bin/$f
	echo 'GNAT_ROOT=${WRKDIR}/bootstrap GCC_ROOT=${WRKDIR}/bootstrap LD_LIBRARY_PATH=${WRKDIR}/bootstrap/system-libs exec ${WRKDIR}/bootstrap/bin/$f "$$@@"' >>${WRKDIR}/bin/$f
	chmod a+x ${WRKDIR}/bin/$f
.endfor
	ln -s /usr/bin/nm ${WRKDIR}/bin/enm
	echo "# This file automatically generated" >> ${WRKSRC}/libversions
.for l v in ${SHARED_LIBS}
	echo "LIB$l_LTVERSION = -version-info ${v:S/./:/}" >> ${WRKSRC}/libversions
.endfor

post-install:
.if ${BUILD_PACKAGES:M-ada}
	chown -R ${SHAREOWN}:${SHAREGRP} ${PREFIX}/lib/gcc/*/$V/adainclude
	chown -R ${SHAREOWN}:${SHAREGRP} ${PREFIX}/lib/gcc/*/$V/adalib
.endif
	chown -R ${SHAREOWN}:${SHAREGRP} ${PREFIX}/lib/gcc/*/$V/include

EXTRA_ENV += am_cv_func_iconv=no JAR=no
EXTRA_ENV += ac_cv_prog_M4=/usr/bin/m4
EXTRA_ENV += ac_cv_header_magic_h=no
EXTRA_ENV += lt_cv_path_SED=/usr/bin/sed
MAKE_FLAGS +=	ac_cv_path_mkdir=/bin/mkdir

CONFIGURE_ENV +=  ${EXTRA_ENV}
MAKE_ENV += ${EXTRA_ENV}

# Note: the configure target passes CFLAGS to the configure script anyways.

CFLAGS = -O2 -g


CONFIGURE_ARGS += \
	--verbose \
	--program-transform-name=s,^,e, \
	--disable-nls  \
	--disable-checking \
	--with-system-zlib \
	--disable-libmudflap \
	--disable-libgomp \
	--disable-tls \
	--with-as=/usr/bin/as \
	--with-ld=/usr/bin/ld \
	--with-gnu-ld \
	--with-gnu-as \
	--enable-threads=posix \
	--enable-wchar_t \
	--disable-libstdcxx-pch \
	--enable-languages=${LANGS}

# This is needed, as internal cpp is no longer compatible with the
# visible beast
CONFIGURE_ARGS += --enable-cpp

CONFIGURE_ARGS += --with-gnu-as
CONFIGURE_ARGS += --with-gnu-ld
CONFIGURE_ARGS += ${CONFIGURE_SHARED}

.if ${MACHINE_ARCH} == "sh"
CONFIGURE_ARGS += -disable-multilib
CONFIGURE_ARGS += --with-endian=little
.endif

post-patch:
	cd ${WRKDIST}/libstdc++-v3 && AUTOCONF_VERSION=2.59 autoconf

SEPARATE_BUILD = flavored

USE_GMAKE = yes

.if ${FLAVOR:Mfull}
# you shouldn't skip bootstrap unless you know what you're doing
# use bootstrap-lean if you're pressed for space
ALL_TARGET = bootstrap
.else
# skip the stage2/stage3 bullshit under normal circumstances
ALL_TARGET = bootstrap2
.endif

MAKE_FLAGS = libstdc___la_LDFLAGS='-version-info 31:0:0 -lm'


.if ${MACHINE_ARCH} == "m68k" || ${MACHINE_ARCH} == "sparc"  || ${MACHINE_ARCH} == "amd64"
PKG_ARGS += -DPIC=1
.else
PKG_ARGS += -DPIC=0
.endif

.if ${MACHINE_ARCH} == "powerpc"
PKG_ARGS += -DPPC=1
.else
PKG_ARGS += -DPPC=0
.endif
.if ${MACHINE_ARCH} == "i386" || ${MACHINE_ARCH} == "amd64"
PKG_ARGS += -DI386=1
.else
PKG_ARGS += -DI386=0
.endif

RUN_DEPENDS =		gcc-${FULL_PKGVERSION}v0:${BUILD_PKGPATH}
WANTLIB =		c

RUN_DEPENDS-main =
RUN_DEPENDS-estdc =
RUN_DEPENDS-java =	archivers/unzip \
			archivers/zip>=2.3p0

RUN_DEPENDS-c++ =	${RUN_DEPENDS} libstdc++->=4.2,<4.3|libstdc++->=4.2v0,<4.3v0:${BUILD_PKGPATH},-estdc
RUN_DEPENDS-ada =	${FULLPKGNAME-main}:${BUILD_PKGPATH}
WANTLIB-estdc =		m
WANTLIB-java =		c m pthread z

LIB_DEPENDS-f95 =	devel/gmp>=4.2 \
			devel/mpfr
WANTLIB-f95 =		${WANTLIB} gmp mpfr
.include <bsd.port.mk>

ADA_PACKAGE = ${PACKAGE_REPOSITORY}/${MACHINE_ARCH}/all/${FULLPKGNAME-ada}.tgz
GCC_PACKAGE = ${PACKAGE_REPOSITORY}/${MACHINE_ARCH}/all/${FULLPKGNAME-main}.tgz

adastrap: ${ADA_PACKAGE} ${GCC_PACKAGE}
.if !defined(ADASTRAP_LIBC-${MACHINE_ARCH})
	@@echo 1>&2 "Error: you must specify a libc to bundle"
	@@exit 1
.else
	mkdir -p ${WRKDIR}/prepare/bootstrap/system-libs
	cp /usr/lib/libc.so.${ADASTRAP_LIBC-${MACHINE_ARCH}} \
		${WRKDIR}/prepare/bootstrap/system-libs
	cd ${WRKDIR}/prepare/bootstrap && tar zxf ${ADA_PACKAGE}
	cd ${WRKDIR}/prepare/bootstrap && tar zxf ${GCC_PACKAGE}
	rm -rf ${WRKDIR}/prepare/bootstrap/{+*,info,man}
	if ! ldd ${WRKDIR}/prepare/bootstrap/bin/egcc | \
		fgrep libc.so.${ADASTRAP_LIBC-${MACHINE_ARCH}} >/dev/null; then \
		echo 1>&2 "Error: adastrap egcc linked against wrong libc"; \
		exit 1; \
	fi
	cd ${WRKDIR}/prepare && \
		tar zcf ${FULLDISTDIR}/${ADASTRAP-${MACHINE_ARCH}} bootstrap
.endif

@


1.97
log
@bump REVISION for 5.7
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.96 2014/11/22 17:00:13 espie Exp $
@


1.96
log
@ada bootstrap missing. not sure it's gonna get fixed. No matter, just
disable the subpackage (minimizes diffs to other gccs)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.95 2013/03/21 08:46:32 ajacoutot Exp $
d27 1
a27 7
REVISION-main = 15
REVISION-c++ = 18
REVISION-estdc = 5
REVISION-f95 = 16
REVISION-java = 16
REVISION-objc = 15
REVISION-ada = 13
@


1.95
log
@USE_LIBTOOL=Yes is the default now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.94 2013/03/11 11:20:27 espie Exp $
d55 2
a56 1
ONLY_FOR_ARCHS-ada = i386 amd64 sparc64
@


1.94
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.93 2013/02/04 21:23:40 tobiasu Exp $
a71 1
USE_LIBTOOL =	Yes
@


1.93
log
@Add our SH backend.

ok espie@@ pascal@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.92 2013/02/01 16:34:36 naddy Exp $
d77 1
a77 1
REGRESS_DEPENDS = 	devel/dejagnu \
d92 1
a92 1
REGRESS_DEPENDS += 	libstdc++->=4.2,<4.3|libstdc++->=4.2v0,<4.3v0:${BUILD_PKGPATH},-estdc
d112 1
a112 1
REGRESS_DEPENDS += ${BUILD_PKGPATH},-ada
@


1.92
log
@bump for plist changes 5.2 -> 5.3
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.91 2013/01/28 01:03:05 tobiasu Exp $
d3 2
a4 2
# TODO: hppa mips64 mips64el sh sparc
ONLY_FOR_ARCHS = alpha i386 sparc64 powerpc amd64 arm
d173 5
@


1.91
log
@Remove sparc, m68k, and vax from the list of working architectures.
Their respective gcc backend ports are unfinished and broken.

ok pascal@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.90 2013/01/27 15:00:23 tobiasu Exp $
d27 2
a28 2
REVISION-main = 14
REVISION-c++ = 17
d30 4
a33 4
REVISION-f95 = 15
REVISION-java = 15
REVISION-objc = 14
REVISION-ada = 12
@


1.90
log
@Add our ARM backend to prepare for later gnat cross-compile adventures.

Rein damit pascal@@
@
text
@d1 4
a4 1
# $OpenBSD: Makefile,v 1.89 2012/12/28 14:32:00 espie Exp $
a5 2
ONLY_FOR_ARCHS = alpha i386 m68k sparc sparc64 powerpc vax amd64 arm
#BROKEN=adjust for types changes
@


1.89
log
@a little overkill on autoconf override magic...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.88 2012/12/27 18:16:44 espie Exp $
d3 1
a3 1
ONLY_FOR_ARCHS = alpha i386 m68k sparc sparc64 powerpc vax amd64
@


1.88
log
@make darn sure we don't detect gnu stuff
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.87 2012/11/06 00:57:43 tobiasu Exp $
d133 8
a140 5
fucks_up =	am_cv_func_iconv=no
fucks_up +=	ac_cv_prog_M4=/usr/bin/m4
fucks_up += 	lt_cv_path_SED=/usr/bin/sed
CONFIGURE_ENV +=  ${fucks_up}
MAKE_ENV += ${fucks_up}
@


1.87
log
@Add Ada support on amd64 and sparc64

Also unbreak and improve adastrap generation
Cleanup bootstrap libc handling

ok pascal@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.86 2012/10/07 20:09:44 landry Exp $
d132 6
a137 2
CONFIGURE_ENV += am_cv_func_iconv=no
CONFIGURE_ENV += ac_cv_prog_M4=/usr/bin/m4
@


1.86
log
@Sync the config/openbsd.h and config/sparc/openbsd64.h patches with
respectively r1.9 and r1.6 of base gcc ones adding #define
NO_IMPLICIT_EXTERN_C. While here add the missing #define
NO_UNSAFE_BUILTINS to gfortran/gcc 4.2, Bump all REVISIONs.
ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.85 2012/09/28 15:02:28 pascal Exp $
d10 7
a16 4
BOOTSTRAP_GEN = 5
# XXX adastrap bundles libc.so.60.1 (from OpenBSD 5.0) to build on i386
LIBC_VERSION = 60.1
ADASTRAP = adastrap-i386-$V-${BOOTSTRAP_GEN}.tgz
d26 1
a26 1
REVISION-main = 13
d32 1
a32 1
REVISION-ada = 11
d54 1
a54 1
ONLY_FOR_ARCHS-ada = i386
d67 1
a67 1
SUPDISTFILES =	${ADASTRAP}:0
d107 1
a107 1
DISTFILES += ${ADASTRAP}:0
a124 3
.if ${BUILD_PACKAGES:M-ada}
	${WRKDIR}/bin/egcc -v # if this fails, you must extract suitable libraries from the relevant OpenBSD release or use the no_ada FLAVOR.
.endif
d162 2
a163 2
CONFIGURE_ARGS += --with-gnu-as 
CONFIGURE_ARGS += --with-gnu-ld 
d211 1
d220 2
a221 2
ADA_PACKAGE = ${PACKAGE_REPOSITORY}/i386/all/${PKGNAME-ada}${PKG_SUFX}
GCC_PACKAGE = ${PACKAGE_REPOSITORY}/i386/all/${PKGNAME-main}${PKG_SUFX}
d224 1
a224 1
.if !defined(LIBC_VERSION)
d229 2
a230 1
	cp /usr/lib/libc.so.${LIBC_VERSION} ${WRKDIR}/prepare/bootstrap/system-libs
d234 7
a240 1
	cd ${WRKDIR}/prepare && tar zcf ${FULLDISTDIR}/${ADASTRAP} bootstrap
@


1.85
log
@Unify MASTER_SITES for adastrap; they're now all hosted by Tobias Ulmer on
tmux.org.  Makes gnat bootstrapping work a little easier for him.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.84 2012/09/26 17:36:46 naddy Exp $
d23 7
a29 7
REVISION-main = 12
REVISION-c++ = 16
REVISION-estdc = 4
REVISION-f95 = 14
REVISION-java = 14
REVISION-objc = 13
REVISION-ada = 12
@


1.84
log
@Add DPB_PROPERTIES=parallel for some big ports.
Required to make full use of the amd64 package building cluster.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.83 2012/09/01 00:00:32 pascal Exp $
d80 1
a80 2
#MASTER_SITES0 =	http://distfiles.bsdfrog.org/
MASTER_SITES0 = ftp://quatramaran.ens.fr/pub/espie/
@


1.83
log
@Patch GCC and derived ports to use PIE by default on the same architectures it
is enabled on in base; except for gcc 3.3, which does not have PIE support and
therefore needs to pass -nopie to the linker.

Also, sync powerpc pthread specs with base.  From Brad.

ok naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.82 2012/08/29 20:51:41 sthen Exp $
d5 1
@


1.82
log
@missing bump, pointed out by nigel@@
adjust comment about bundled libc for adastrap while there
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.81 2012/08/28 23:39:12 sthen Exp $
d22 2
a23 2
REVISION-main = 11
REVISION-c++ = 15
d25 4
a28 4
REVISION-f95 = 13
REVISION-java = 13
REVISION-objc = 12
REVISION-ada = 11
d155 1
@


1.81
log
@sync OBSD_LIB_SPEC in the ports tree compilers with the updated one
in base; from Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.80 2012/08/20 12:35:41 pascal Exp $
d10 1
a10 1
# XXX this needs libc.so.60.1 (from OpenBSD 5.0) to build on i386
d24 1
a24 1
REVISION-estdc = 3
@


1.80
log
@Sync -pthread semantics with base gcc.  From Brad.

ok matthew@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.79 2012/06/21 13:56:57 sthen Exp $
d22 2
a23 2
REVISION-main = 10
REVISION-c++ = 14
d25 4
a28 4
REVISION-f95 = 12
REVISION-java = 12
REVISION-objc = 11
REVISION-ada = 10
d210 1
a210 1
WANTLIB-estdc =		c m
@


1.79
log
@bump for plist changes 5.1 -> 5.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.78 2012/05/07 10:34:33 pascal Exp $
d22 2
a23 2
REVISION-main = 9
REVISION-c++ = 13
d25 4
a28 4
REVISION-f95 = 11
REVISION-java = 11
REVISION-objc = 10
REVISION-ada = 9
@


1.78
log
@Don't hardcode GC_nprocs to 1 in boehm-gc, but get it from sysconf instead,
following a similar change in devel/boehm-gc.
From Brad.

ok kurt@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.77 2012/05/04 08:47:55 pascal Exp $
d22 7
a28 7
REVISION-main = 8
REVISION-c++ = 12
REVISION-estdc = 2
REVISION-f95 = 10
REVISION-java = 10
REVISION-objc = 9
REVISION-ada = 8
@


1.77
log
@Do not let different versions of libstdc++ conflict with each other.  At the
same time, make sure that g++ is never installed alongside a higher version
of libstdc++, so that stuff will always link to the correct library.

feedback espie@@ and kurt@@, ok kurt@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.76 2012/04/23 14:12:18 pascal Exp $
d26 1
a26 1
REVISION-java = 9
@


1.76
log
@Define _REENTRANT, not _POSIX_THREADS for -pthread; ok kurt@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.75 2012/02/22 12:40:04 kurt Exp $
d23 2
a24 2
REVISION-c++ = 11
REVISION-estdc = 1
@


1.75
log
@Port boehm-gc rthread support from boehm-gc port. Tested in bulk by espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.74 2012/01/23 22:20:34 espie Exp $
d22 2
a23 2
REVISION-main = 7
REVISION-c++ = 10
d25 4
a28 4
REVISION-f95 = 9
REVISION-java = 8
REVISION-objc = 8
REVISION-ada = 7
d133 1
a133 1
CONFIGURE_ENV += ac_cv_prog_CONFIGURED_M4=/usr/bin/m4
@


1.74
log
@same dance as for 4.6: stop at stage2, oh and use CONFIG_SITE everywhere
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.73 2012/01/23 14:59:57 espie Exp $
d26 1
a26 1
REVISION-java = 7
@


1.73
log
@switch to a new way of bundling bootstrap: this bundles the official
libc.so from OpenBSD 5.0, and tweaks the ada scripts to LD_LIBRARY_PATH
the bundled library.

That way, we should be able to get away by providing a new bootstrap ways
less often (preferably every release, but things won't break if we do it
even LESS often).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.72 2012/01/23 14:47:37 espie Exp $
d47 1
a47 1
PSEUDO_FLAVORS = no_c++ no_f95 no_objc no_java no_ada
d172 1
d176 4
@


1.72
log
@tweak infra to be able to bundle libc in adastrap
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.71 2012/01/13 00:55:14 naddy Exp $
d9 1
a9 1
BOOTSTRAP_GEN = 4
d79 2
a80 2
MASTER_SITES0 =	http://distfiles.bsdfrog.org/
#MASTER_SITES0 = ftp://quatramaran.ens.fr/pub/espie/
@


1.71
log
@bump revision for plist changes 5.0 -> 5.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.70 2012/01/04 12:29:01 sthen Exp $
d11 1
a111 3
.if ${BUILD_PACKAGES:M-ada}
	${WRKDIR}/bootstrap/bin/egcc -v # if this fails, you must extract suitable libraries from the relevant OpenBSD release or use the no_ada FLAVOR.
.endif
d114 1
a114 1
	echo 'GNAT_ROOT=${WRKDIR}/bootstrap GCC_ROOT=${WRKDIR}/bootstrap exec ${WRKDIR}/bootstrap/bin/$f "$$@@"' >>${WRKDIR}/bin/$f
d122 3
d217 6
a222 1
	mkdir -p ${WRKDIR}/prepare/bootstrap
d227 1
@


1.70
log
@- update adastrap to a newer version built by kili@@ against libc.so.60.1
(from OpenBSD 5.0-release), thanks ajacoutot@@ for hosting the distfile.

- check that the bootstrap egcc can actually run; the reason for failure
due to missing libs is now clear (previously it was a cryptic "C compiler
cannot create executables" type message during configure).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.69 2011/12/03 15:54:05 naddy Exp $
d21 2
a22 2
REVISION-main = 6
REVISION-c++ = 9
d24 4
a27 4
REVISION-f95 = 8
REVISION-java = 6
REVISION-objc = 7
REVISION-ada = 6
@


1.69
log
@Merge in fixes for alpha from base (miod@@):

builtins.c:
Allow MD backend to prevent the optimization of a bcopy() or memmove() of
size 1 (the size being known at compile-time) into an inline mempcpy()
expansion, which will in turn expand into a byte load and store operation.
This expansion loses precious address alignment information at some point
(because everybody knows that you can read a byte from any address, right?),
and this loses bigtime on strict alignment platforms which lack the ability
to accesse bytes directly, such as alpha (unless compiling with -mbwx and
runnning on a BWX-capable cpu).

config/alpha:
Require alignment of local arrays on word boundaries, and enable
the builtins.c `one-byte memcpy' workaround.

ok espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.68 2011/11/24 17:55:58 nigel Exp $
d9 2
a10 2
BOOTSTRAP_GEN = 3
# XXX this needs libc.so.53.0 to build on i386
d78 2
a79 1
MASTER_SITES0 =	ftp://quatramaran.ens.fr/pub/espie/
d111 3
@


1.68
log
@Add zip and unzip used by ejar script to RUN_DEPENDS-java and bump.

Ok espie@@ (Maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.67 2011/11/16 12:32:49 espie Exp $
d21 4
a24 4
REVISION-main = 5
REVISION-c++ = 8
REVISION-estdc = 0
REVISION-f95 = 7
d26 1
a26 1
REVISION-objc = 6
@


1.67
log
@synch with recent changes in src.
mostly from brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.66 2011/10/04 07:08:54 espie Exp $
d25 1
a25 1
REVISION-java = 5
d196 2
a197 1
RUN_DEPENDS-java =
@


1.66
log
@use BUILD_PKGPATH
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.65 2011/09/25 14:12:10 espie Exp $
d21 3
a23 2
REVISION-main = 4
REVISION-c++ = 7
d30 1
a30 1
SHARED_LIBS =	estdc++		11.0 \
@


1.65
log
@put ada at the end, so if it doesn't package, it's not such a bummer...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.64 2011/09/25 12:19:23 espie Exp $
d190 1
a190 1
RUN_DEPENDS =		gcc-${FULL_PKGVERSION}v0:${PKGPATH}
d197 1
a197 1
RUN_DEPENDS-c++ =	${RUN_DEPENDS} libstdc++->=4.2,<4.3|libstdc++->=4.2v0,<4.3v0:${PKGPATH},-estdc
@


1.64
log
@use bsd.port.arch.mk
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.63 2011/09/16 10:31:20 espie Exp $
d51 1
a51 1
MULTI_PACKAGES = -main -f95 -objc -java -ada -c++ -estdc
@


1.63
log
@normalize pkgpath
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62 2011/09/15 17:25:34 espie Exp $
d45 1
a45 1
PSEUDO_FLAVORS = no_c++ no_fortran no_objc no_java no_ada
d51 1
a51 1
MULTI_PACKAGES = -main
d53 1
a53 1
BUILD = c
d55 3
a57 31
.if !${FLAVOR:L:Mno_fortran}
MULTI_PACKAGES += -f95
BUILD += fortran
.endif

.if !${FLAVOR:L:Mno_objc}
MULTI_PACKAGES += -objc
BUILD += objc
.endif

.if !${FLAVOR:L:Mno_java}
MULTI_PACKAGES += -java
.  for _a in ${MACHINE_ARCH} ${ARCH}
.    if ${ONLY_FOR_ARCHS-java:M${_a}}
BUILD += java
.    endif
.  endfor
.endif

.if !${FLAVOR:L:Mno_ada}
MULTI_PACKAGES += -ada
.  for _a in ${MACHINE_ARCH} ${ARCH}
.    if ${ONLY_FOR_ARCHS-ada:M${_a}}
BUILD += ada
.    endif
.  endfor
.endif

.if !${FLAVOR:L:Mno_c++} || ${BUILD:Mjava}
MULTI_PACKAGES += -c++ -estdc
BUILD += c++
d83 1
a83 1
.if ${BUILD:Mc++}
d87 1
a87 1
.if ${BUILD:Mfortran}
d91 1
a91 1
.if ${BUILD:Mobjc}
d94 1
a94 1
.if ${BUILD:Mjava}
d99 1
a99 1
.if ${BUILD:Mada}
d121 1
a121 1
.if ${BUILD:Mada} == "yes"
@


1.62
log
@modernize gcc build: pseudo-flavors, multi-packages, and ONLY_FOR_ARCHS-*

(prevent bulk from building gcc 4 twice, once for java, once for objc)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.61 2011/07/18 19:06:36 naddy Exp $
d22 2
a23 2
REVISION-c++ = 6
REVISION-f95 = 6
d25 2
a26 2
REVISION-objc = 5
REVISION-ada = 5
@


1.61
log
@bump revision for plist changes 4.9 -> 5.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.60 2011/02/08 09:37:51 espie Exp $
d45 13
a57 8
PSEUDO_FLAVORS = c++ fortran objc java ada
.if ${MACHINE_ARCH} == "i386"
FLAVOR ?= c++ fortran objc ada java
.endif
.if ${MACHINE_ARCH} == "amd64" || ${MACHINE_ARCH} == "sparc64"
FLAVOR ?= c++ fortran objc java
.else
FLAVOR ?= c++ fortran objc
d60 26
a85 2
.if ${FLAVOR:L:Mjava}
FLAVOR += c++
a97 2
MULTI_PACKAGES = -main

d111 1
a111 1
.if ${FLAVOR:L:Mc++}
a112 1
MULTI_PACKAGES += -c++ -estdc
d115 1
a115 1
.if ${FLAVOR:L:Mfortran}
a116 1
MULTI_PACKAGES += -f95
d119 1
a119 1
.if ${FLAVOR:L:Mobjc}
a120 1
MULTI_PACKAGES += -objc
d122 1
a122 1
.if ${FLAVOR:L:Mjava}
a123 1
MULTI_PACKAGES += -java
d127 1
a127 1
.if ${FLAVOR:L:Mada}
a128 1
MULTI_PACKAGES += -ada
d149 1
a149 1
.if ${FLAVOR:L:Mada}
@


1.60
log
@add PRAGMA_POP_PUSH_PACK support on i386 and amd64, to allow chromium9 to
work.
Limit it to i386 and amd64 so that it has minimal impact.
As discussed with naddy@@/jasper@@/sthen@@/miod@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59 2011/01/15 01:09:43 naddy Exp $
d21 6
a26 6
REVISION-main = 3
REVISION-c++ = 5
REVISION-f95 = 5
REVISION-java = 4
REVISION-objc = 4
REVISION-ada = 4
@


1.59
log
@bump revision for plist changes 4.8 -> 4.9
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2010/11/28 21:30:37 jasper Exp $
d21 6
a26 6
REVISION-main = 2
REVISION-c++ = 4
REVISION-f95 = 4
REVISION-java = 3
REVISION-objc = 3
REVISION-ada = 3
@


1.58
log
@- add missing conflict markers between g95 and (lib)gfortran.

ok steven@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.57 2010/11/26 14:17:17 espie Exp $
d21 6
a26 6
REVISION-main = 1
REVISION-c++ = 3
REVISION-f95 = 3
REVISION-java = 2
REVISION-objc = 2
REVISION-ada = 2
@


1.57
log
@zap autoconf-N: part, since it's now default
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2010/11/22 09:23:58 espie Exp $
d23 1
a23 1
REVISION-f95 = 2
@


1.56
log
@missed some
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55 2010/11/17 08:05:17 espie Exp $
d62 1
a62 1
BUILD_DEPENDS += autoconf-2.59:devel/autoconf/2.59
@


1.55
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.54 2010/11/13 16:26:41 naddy Exp $
d71 2
a72 2
REGRESS_DEPENDS = 	::devel/dejagnu \
			::devel/autogen
d196 1
a196 1
RUN_DEPENDS =		:gcc-${FULL_PKGVERSION}v0:${PKGPATH}
@


1.54
log
@enable on alpha
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2010/11/07 19:12:42 espie Exp $
d62 2
a63 2
BUILD_DEPENDS += :autoconf-2.59:devel/autoconf/2.59
BUILD_DEPENDS += ::devel/metaauto
d66 1
a66 1
BUILD_DEPENDS += :bison-*:devel/bison
d87 1
a87 1
REGRESS_DEPENDS += 	:libstdc++->=4.2,<4.3|libstdc++->=4.2v0,<4.3v0:${BUILD_PKGPATH},-estdc
d101 1
a101 1
BUILD_DEPENDS += :zip->=2.3p0:archivers/zip
d111 1
a111 1
REGRESS_DEPENDS += ::${BUILD_PKGPATH},-ada
d203 1
a203 1
RUN_DEPENDS-c++ =	${RUN_DEPENDS} :libstdc++->=4.2,<4.3|libstdc++->=4.2v0,<4.3v0:${PKGPATH},-estdc
d207 2
a208 2
LIB_DEPENDS-f95 =	:gmp->=4.2:devel/gmp \
			::devel/mpfr
@


1.53
log
@convert WANTLIB on geo/lang
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.52 2010/10/31 22:38:42 kurt Exp $
d3 1
a3 3
ONLY_FOR_ARCHS = i386 m68k sparc sparc64 powerpc vax amd64
# work in progress
#ONLY_FOR_ARCHS += alpha
@


1.52
log
@Correct UTHREAD_SP_OFFSET on i386 after layout change in struct
_machdep_state (last release). Fixes classpath build on i386.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 2010/10/29 08:50:38 naddy Exp $
d209 3
a211 3
LIB_DEPENDS-f95 =	gmp:gmp->=4.2:devel/gmp \
			mpfr::devel/mpfr

@


1.51
log
@add the bits to actually support the alpha arch, but don't enable yet
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2010/10/18 19:20:41 espie Exp $
d26 1
a26 1
REVISION-java = 1
@


1.50
log
@USE_GROFF=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2010/07/24 23:05:08 naddy Exp $
d3 3
a5 1
ONLY_FOR_ARCHS = alpha i386 m68k sparc sparc64 powerpc vax amd64
@


1.49
log
@bump PKGNAME for PLIST changes 4.7 -> 4.8
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2010/07/10 13:33:46 naddy Exp $
d44 1
@


1.48
log
@use REVISION/EPOCH
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2010/01/27 21:43:28 naddy Exp $
d21 6
a26 6
REVISION-main = 0
REVISION-c++ = 2
REVISION-f95 = 1
REVISION-java = 0
REVISION-objc = 1
REVISION-ada = 1
@


1.47
log
@bump PKGNAME for PLIST changes 4.6 -> 4.7
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2009/12/20 10:40:05 landry Exp $
d13 16
a28 7
PKGNAME-main =  gcc-${FULL_PKGVERSION}p0v0
PKGNAME-c++ =   g++-${FULL_PKGVERSION}p2v0
PKGNAME-estdc = libstdc++-${FULL_PKGVERSION}v0
PKGNAME-f95 =   g95-${FULL_PKGVERSION}p1v0
PKGNAME-java =  gcj-${FULL_PKGVERSION}p0v0
PKGNAME-objc =  gobjc-${FULL_PKGVERSION}p1v0
PKGNAME-ada =   gnat-${FULL_PKGVERSION}p1v0
@


1.46
log
@Add an #XXX mentioning that libc.so.53.0 is needed to build gcc4 on
i386, as it's required by ada bootstrap. Should save some head
scratching to ppl not using packages, as advised.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2009/12/20 10:15:36 espie Exp $
d13 2
a14 2
PKGNAME-main =  gcc-${FULL_PKGVERSION}v0
PKGNAME-c++ =   g++-${FULL_PKGVERSION}p1v0
d16 4
a19 4
PKGNAME-f95 =   g95-${FULL_PKGVERSION}p0v0
PKGNAME-java =  gcj-${FULL_PKGVERSION}v0
PKGNAME-objc =  gobjc-${FULL_PKGVERSION}p0v0
PKGNAME-ada =   gnat-${FULL_PKGVERSION}p0v0
@


1.45
log
@regen'd bootstrap
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2009/11/20 21:08:19 naddy Exp $
d10 1
@


1.44
log
@fix dependency on gcc subpackage
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2009/11/20 17:41:16 naddy Exp $
d9 1
a9 1
BOOTSTRAP_GEN = 2
@


1.43
log
@bump c++ package after dependency change
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2009/11/18 00:49:09 sthen Exp $
d13 1
a13 1
PKGNAME-c++ =   g++-${FULL_PKGVERSION}p0v0
d15 1
a15 1
PKGNAME-f95 =   g95-${FULL_PKGVERSION}v0
d17 2
a18 2
PKGNAME-objc =  gobjc-${FULL_PKGVERSION}v0
PKGNAME-ada =   gnat-${FULL_PKGVERSION}v0
d185 1
a185 1
RUN_DEPENDS =		:gcc-${FULL_PKGVERSION}:${PKGPATH}
@


1.42
log
@- fix dependencies following libstdc++ bump from 4.2.4p3 to 4.2.4v0
- bump relevant PKGNAMEs
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2009/11/12 10:13:19 espie Exp $
d13 1
a13 1
PKGNAME-c++ =   g++-${FULL_PKGVERSION}v0
@


1.41
log
@new version numbering, so that updates from 4.5 work
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2009/10/15 18:02:33 steven Exp $
d76 1
a76 1
REGRESS_DEPENDS += 	:libstdc++->=4.2,<4.3:${BUILD_PKGPATH},-estdc
d192 1
a192 1
RUN_DEPENDS-c++ =	${RUN_DEPENDS} :libstdc++->=4.2,<4.3:${PKGPATH},-estdc
@


1.40
log
@provide gfortran shared library
adjust gcc4 module to provide fortran language and corresponding compiler
and dependencies

"go for it" espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2009/10/10 22:48:29 jasper Exp $
d12 7
a18 7
PKGNAME-main =  gcc-${FULL_PKGVERSION}p3
PKGNAME-c++ =   g++-${FULL_PKGVERSION}p5
PKGNAME-estdc = libstdc++-${FULL_PKGVERSION}p3
PKGNAME-f95 =   g95-${FULL_PKGVERSION}p3
PKGNAME-java =  gcj-${FULL_PKGVERSION}p3
PKGNAME-objc =  gobjc-${FULL_PKGVERSION}p2
PKGNAME-ada =   gnat-${FULL_PKGVERSION}p1
@


1.39
log
@- resolve conflict of gcj with devel/libffi:
gcj only needs the internal libffi copy to build and links statically against
it. so there is no point in installing the libffi headers and libraries from
the gcc tree.

discussed with espie@@ kurt@@ and upstream libffi maintainer

ok espie@@ kurt@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2009/09/23 20:57:02 jasper Exp $
d15 1
a15 2
PKGNAME-g77 =   g77-${FULL_PKGVERSION}p0
PKGNAME-f95 =   g95-${FULL_PKGVERSION}p2
@


1.38
log
@- add @@conflict marker for libffi with gcj

ok kurt@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2009/07/13 23:13:34 jsg Exp $
d17 1
a17 1
PKGNAME-java =  gcj-${FULL_PKGVERSION}p2
@


1.37
log
@teach gcc about our kprintf and syslog format attributes,
adapted from the in tree gcc 3.3.5, and already included in
the llvm-gcc port.

ok kurt@@ espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2009/06/22 17:00:23 naddy Exp $
d17 1
a17 1
PKGNAME-java =  gcj-${FULL_PKGVERSION}p1
@


1.36
log
@bump PKGNAME for PLIST changes 4.5 -> 4.6
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2009/06/11 21:45:07 pvalchev Exp $
d12 1
a12 1
PKGNAME-main =  gcc-${FULL_PKGVERSION}p2
@


1.35
log
@Make the c++ subpackage depend on libstdc++>=4.2,<4.3 to prevent
people from screwing themselves by using libstdc++-3.x which will fail
only in bizarre ways (embarassing how long it took me to debug this)

ok robert@@
"finally! ok" todd@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2009/06/07 01:22:05 robert Exp $
d12 2
a13 2
PKGNAME-main =  gcc-${FULL_PKGVERSION}p1
PKGNAME-c++ =   g++-${FULL_PKGVERSION}p4
d16 4
a19 4
PKGNAME-f95 =   g95-${FULL_PKGVERSION}p1
PKGNAME-java =  gcj-${FULL_PKGVERSION}p0
PKGNAME-objc =  gobjc-${FULL_PKGVERSION}p1
PKGNAME-ada =   gnat-${FULL_PKGVERSION}p0
@


1.34
log
@add wchar_t support to gcc 4.2 because some upcoming ports are going to need
it. this is not much different from the in-tree gcc way of doing it.
tested with openoffice and with some other uncommited stuff.
bump needed PKGNAMEs
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2009/06/04 18:24:20 kurt Exp $
d13 1
a13 1
PKGNAME-c++ =   g++-${FULL_PKGVERSION}p3
d193 1
a193 1
RUN_DEPENDS-c++ =	${RUN_DEPENDS} ::${PKGPATH},-estdc
@


1.33
log
@- enable dwarf2 exceptions (w/major bump for libestdc++)
- add gcj support for i386, amd64 and sparc64
- add MODGCC4_LANGS=java support to gcc4.port.mk
okay robert@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2009/05/16 23:50:31 sthen Exp $
d13 2
a14 2
PKGNAME-c++ =   g++-${FULL_PKGVERSION}p2
PKGNAME-estdc = libstdc++-${FULL_PKGVERSION}p2
d144 1
@


1.32
log
@the last commit which changed back to sjlj exception handling didn't
touch the library version, but it was required.  bump libstdc++ major
and PKGNAME-estdc.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2009/05/09 20:01:13 robert Exp $
d14 1
a14 1
PKGNAME-estdc = libstdc++-${FULL_PKGVERSION}p1
d20 1
a20 1
SHARED_LIBS =	estdc++		10.0 \
d24 4
a27 1
		gcj		5.0 \
d37 4
a40 1
FLAVOR ?= c++ fortran objc ada
d91 1
a91 1
CONFIGURE_ARGS += --enable-java-gc=system-boehm
a143 1
	--enable-sjlj-exceptions \
d190 1
d194 1
a197 2

LIB_DEPENDS-java =	gc::devel/boehm-gc
@


1.31
log
@Go back to sjlj exceptions from dwarf2 because OpenOffice got broken with
it. The problem needs to be tracked down.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2009/04/27 12:30:26 kurt Exp $
d14 1
a14 1
PKGNAME-estdc = libstdc++-${FULL_PKGVERSION}p0
d20 1
a20 1
SHARED_LIBS =	estdc++		9.0 \
@


1.30
log
@@@comment's also need pkg bumps.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2009/04/21 21:02:34 kurt Exp $
d12 8
a19 8
PKGNAME-main =  gcc-${FULL_PKGVERSION}p0
PKGNAME-c++ =   g++-${FULL_PKGVERSION}p0
PKGNAME-estdc = libstdc++-${FULL_PKGVERSION}
PKGNAME-g77 =   g77-${FULL_PKGVERSION}
PKGNAME-f95 =   g95-${FULL_PKGVERSION}p0
PKGNAME-java =  gcj-${FULL_PKGVERSION}
PKGNAME-objc =  gobjc-${FULL_PKGVERSION}p0
PKGNAME-ada =   gnat-${FULL_PKGVERSION}
d138 1
@


1.29
log
@minor pkg/* corrections on -DPIC=1 archs. okay espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2009/04/16 18:36:48 espie Exp $
d12 1
a12 1
PKGNAME-main =  gcc-${FULL_PKGVERSION}
d16 1
a16 1
PKGNAME-f95 =   g95-${FULL_PKGVERSION}
@


1.28
log
@move to gcc 4.2.4, with a lot of work from kurt@@ as well.
Doesn't build on alpha yet, but should be on the way...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2009/02/09 20:48:23 naddy Exp $
d13 1
a13 1
PKGNAME-c++ =   g++-${FULL_PKGVERSION}
d18 1
a18 1
PKGNAME-objc =  gobjc-${FULL_PKGVERSION}
@


1.27
log
@bump PKGNAME for PLIST changes 4.4 -> 4.5
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2009/01/26 22:09:19 landry Exp $
d3 1
a3 1
ONLY_FOR_ARCHS=	alpha i386 m68k sparc sparc64 powerpc vax amd64
d6 15
a20 14
V=4.2.0
DATE=20070307
FULL_VERSION=4.2-${DATE}
FULL_PKGVERSION=4.2.${DATE}

PKGNAME-main=  gcc-${FULL_PKGVERSION}p11
PKGNAME-c++ =  g++-${FULL_PKGVERSION}p9
PKGNAME-estdc= libstdc++-${FULL_PKGVERSION}p6
PKGNAME-g77=   g77-${FULL_PKGVERSION}p4
PKGNAME-f95=   g95-${FULL_PKGVERSION}p8
PKGNAME-java=  gcj-${FULL_PKGVERSION}p3
PKGNAME-objc=  gobjc-${FULL_PKGVERSION}p8
PKGNAME-ada=   gnat-${FULL_PKGVERSION}p7
SHARED_LIBS=	estdc++		8.0 \
d30 1
a30 1
MAINTAINER=	Marc Espie <espie@@openbsd.org>
d32 1
a32 1
PSEUDO_FLAVORS=c++ fortran objc java ada
d34 1
a34 1
FLAVOR?=c++ fortran objc ada
d36 1
a36 1
FLAVOR?=c++ fortran objc
d40 1
a40 1
FLAVOR+=c++
d43 2
a44 2
DISTFILES=  ${DISTNAME}.tar.bz2
SUPDISTFILES=	adastrap-i386-3.3.6-5.tgz:0
d46 3
a48 3
BUILD_DEPENDS+= :autoconf-2.59:devel/autoconf/2.59
BUILD_DEPENDS+=	::devel/metaauto
USE_LIBTOOL=	Yes
d50 1
a50 1
BUILD_DEPENDS+= :bison-*:devel/bison
d53 1
a53 1
MULTI_PACKAGES=	-main
d55 2
a56 1
REGRESS_DEPENDS=::devel/dejagnu
d58 1
a59 1
DISTNAME=   	gcc-${FULL_VERSION}
d61 2
d64 2
a65 2
MASTER_SITES=	${MASTER_SITE_GCC:=snapshots/$(FULL_VERSION)/}
MASTER_SITES0=	ftp://quatramaran.ens.fr/pub/espie/
d67 1
a67 4
CONFIGURE_STYLE=	gnu
MODGNU_CONFIG_GUESS_DIRS=	${WRKSRC} ${WRKSRC}/gcc

LANGS=c
d69 3
a71 2
LANGS:=${LANGS},c++
MULTI_PACKAGES+=-c++ -estdc
d74 3
a76 3
LANGS:=${LANGS},fortran
MULTI_PACKAGES+=-f95
CONFIGURE_ARGS+=--with-gmp=${LOCALBASE}
d79 2
a80 2
LANGS:=${LANGS},objc
MULTI_PACKAGES+=-objc
d83 4
a86 3
LANGS:=${LANGS},java
#MULTI_PACKAGES+=-java
CONFIGURE_ARGS+=--enable-java-gc=system-boehm
d89 7
a95 6
LANGS:=${LANGS},ada
MULTI_PACKAGES+=-ada
DISTFILES+=adastrap-${MACHINE_ARCH}-3.3.6-5.tgz:0
CONFIGURE_ENV=ADAC=${WRKDIR}/bin/egcc GNATBIND=${WRKDIR}/bin/gnatbind
MAKE_ENV=ADAC=${WRKDIR}/bin/egcc GNATBIND=${WRKDIR}/bin/gnatbind
CC=${WRKDIR}/bin/egcc
d116 2
a117 2
CONFIGURE_ENV+=am_cv_func_iconv=no
CONFIGURE_ENV+=ac_cv_prog_CONFIGURED_M4=/usr/bin/m4
d121 1
a121 1
CFLAGS=-O2 -g
d124 1
a124 1
CONFIGURE_ARGS+= \
d137 1
a137 1
	--enable-sjlj-exceptions \
d142 1
a142 4
CONFIGURE_ARGS+=--enable-cpp

# if you wish to try your luck
#CONFIGURE_ARGS+= --enable-threads=posix
d151 1
a151 1
SEPARATE_BUILD=flavored
d153 1
a153 1
USE_GMAKE= yes
d157 1
a157 1
ALL_TARGET=bootstrap
d159 1
a159 1
MAKE_FLAGS=libstdc___la_LDFLAGS='-version-info 31:0:0 -lm'
d163 1
a163 1
PKG_ARGS+=-DPIC=1
d165 1
a165 1
PKG_ARGS+=-DPIC=0
d169 1
a169 1
PKG_ARGS+=-DPPC=1
d171 1
a171 1
PKG_ARGS+=-DPPC=0
d174 1
a174 1
PKG_ARGS+=-DI386=1
d176 1
a176 1
PKG_ARGS+=-DI386=0
d179 2
a180 2
RUN_DEPENDS=		:gcc-${FULL_PKGVERSION}:${PKGPATH}
WANTLIB=		c
d182 2
a183 2
RUN_DEPENDS-main=
RUN_DEPENDS-estdc=
d186 1
a186 1
WANTLIB-estdc=		c m
d188 1
a188 1
LIB_DEPENDS-f95=	gmp:gmp->=4.2:devel/gmp \
d191 1
a191 1
LIB_DEPENDS-java=	gc::devel/boehm-gc
d194 11
@


1.26
log
@SUBPACKAGE -estdc doesn't need to RUN_DEPENDS on gcc.
Diff from Mikolaj Kucharski on ports@@, thanks!

ok espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2009/01/19 21:39:29 naddy Exp $
d11 2
a12 2
PKGNAME-main=  gcc-${FULL_PKGVERSION}p10
PKGNAME-c++ =  g++-${FULL_PKGVERSION}p8
d15 1
a15 1
PKGNAME-f95=   g95-${FULL_PKGVERSION}p7
d17 2
a18 2
PKGNAME-objc=  gobjc-${FULL_PKGVERSION}p7
PKGNAME-ada=   gnat-${FULL_PKGVERSION}p6
@


1.25
log
@Include the headers for MMX/SSE/etc on amd64, too.
From: Pierre Riteau <pierre.riteau@@gmail.com>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2009/01/18 18:47:05 robert Exp $
d13 1
a13 1
PKGNAME-estdc= libstdc++-${FULL_PKGVERSION}p5
d182 1
@


1.24
log
@Enable sjlj exceptions by default because the other implementation does not
work on OpenBSD, and exceptions are hevaily used by OpenOffice.Org.

Backport PR libstdc++/31481 from GCC repository because this fix is needed
by openoffice:
	PR libstdc++/31481
	* include/ext/type_traits.h (__numeric_traits): Move...
	* include/ext/numeric_traits.h: ... here; fix type of
	__max_digits10.
	* include/ext/pb_ds/detail/type_utils.hpp: Include
	<ext/numeric_traits.h> too.
	* include/tr1/random: Likewise.

Tested with both openoffice and webkit. bump needed PKGNAMEs;
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2008/09/11 19:22:05 martynas Exp $
d11 1
a11 1
PKGNAME-main=  gcc-${FULL_PKGVERSION}p9
d172 1
a172 1
.if ${MACHINE_ARCH} == "i386"
a191 1

@


1.23
log
@our math.h does not need quirks for gcc anymore.  fix-includes
script does not produce math.h, and just uses the system one, so
remove it from PLIST.  makes gccs package again.  spotted&ok naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2008/07/04 19:41:21 naddy Exp $
d11 3
a13 3
PKGNAME-main=  gcc-${FULL_PKGVERSION}p8
PKGNAME-c++ =  g++-${FULL_PKGVERSION}p7
PKGNAME-estdc= libstdc++-${FULL_PKGVERSION}p4
a59 1

d133 1
a138 5

.if ${FLAVOR:L:Mjava}
CONFIGURE_ARGS+=--enable-sjlj-exceptions
.endif

@


1.22
log
@bump PKGNAME for PLIST changes 4.3 -> 4.4
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2008/06/12 01:14:06 kurt Exp $
d11 1
a11 1
PKGNAME-main=  gcc-${FULL_PKGVERSION}p7
@


1.21
log
@- enable _cxa_atexit support
- implement pre-compiled header support using brk/sbrk. idea from drahn@@
okay espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2008/02/23 00:26:07 naddy Exp $
d11 2
a12 2
PKGNAME-main=  gcc-${FULL_PKGVERSION}p6
PKGNAME-c++ =  g++-${FULL_PKGVERSION}p6
d15 1
a15 1
PKGNAME-f95=   g95-${FULL_PKGVERSION}p6
d17 2
a18 2
PKGNAME-objc=  gobjc-${FULL_PKGVERSION}p6
PKGNAME-ada=   gnat-${FULL_PKGVERSION}p5
@


1.20
log
@bump PKGNAME for PLIST changes 4.2 -> 4.3
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2007/12/20 16:11:35 ajacoutot Exp $
d11 5
a15 5
PKGNAME-main=  gcc-${FULL_PKGVERSION}p5
PKGNAME-c++ =  g++-${FULL_PKGVERSION}p5
PKGNAME-estdc= libstdc++-${FULL_PKGVERSION}p3
PKGNAME-g77=   g77-${FULL_PKGVERSION}p3
PKGNAME-f95=   g95-${FULL_PKGVERSION}p5
d17 3
a19 3
PKGNAME-objc=  gobjc-${FULL_PKGVERSION}p5
PKGNAME-ada=   gnat-${FULL_PKGVERSION}p4
SHARED_LIBS=	estdc++		7.0 \
@


1.19
log
@- add a common DESCR for all GCC versions (and their subpackages) ;
except for version 3.3 which already has a specific one ;
versions 3.4, 4.0 and 4.1 have been broken for a while so no bump

ok espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2007/10/22 16:28:45 espie Exp $
d11 2
a12 2
PKGNAME-main=  gcc-${FULL_PKGVERSION}p4
PKGNAME-c++ =  g++-${FULL_PKGVERSION}p4
d15 1
a15 1
PKGNAME-f95=   g95-${FULL_PKGVERSION}p4
d17 2
a18 2
PKGNAME-objc=  gobjc-${FULL_PKGVERSION}p4
PKGNAME-ada=   gnat-${FULL_PKGVERSION}p3
@


1.18
log
@fix ada bootstrap wrt recent libc
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2007/09/22 07:52:07 sturm Exp $
d11 8
a18 8
PKGNAME-main=  gcc-${FULL_PKGVERSION}p3
PKGNAME-c++ =  g++-${FULL_PKGVERSION}p3
PKGNAME-estdc= libstdc++-${FULL_PKGVERSION}p2
PKGNAME-g77=   g77-${FULL_PKGVERSION}p2
PKGNAME-f95=   g95-${FULL_PKGVERSION}p3
PKGNAME-java=  gcj-${FULL_PKGVERSION}p2
PKGNAME-objc=  gobjc-${FULL_PKGVERSION}p3
PKGNAME-ada=   gnat-${FULL_PKGVERSION}p2
a52 2
# No sub packages description
DESCR=${PKGDIR}/DESCR
@


1.17
log
@bump after COMMENT changes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2007/09/16 00:27:05 merdely Exp $
d43 1
a43 1
SUPDISTFILES=	adastrap-i386-3.3.6-4.tgz:0
d91 1
a91 1
DISTFILES+=adastrap-${MACHINE_ARCH}-3.3.6-4.tgz:0
@


1.16
log
@Remove surrounding quotes in COMMENT*/PERMIT_*/BROKEN
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2007/07/30 23:31:46 naddy Exp $
d11 8
a18 8
PKGNAME-main=  gcc-${FULL_PKGVERSION}p2
PKGNAME-c++ =  g++-${FULL_PKGVERSION}p2
PKGNAME-estdc= libstdc++-${FULL_PKGVERSION}p1
PKGNAME-g77=   g77-${FULL_PKGVERSION}p1
PKGNAME-f95=   g95-${FULL_PKGVERSION}p2
PKGNAME-java=  gcj-${FULL_PKGVERSION}p1
PKGNAME-objc=  gobjc-${FULL_PKGVERSION}p2
PKGNAME-ada=   gnat-${FULL_PKGVERSION}p1
@


1.15
log
@bump package names due to OSREV increment and corresponding plist changes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2007/06/19 21:23:37 ajacoutot Exp $
d4 1
a4 1
#BROKEN='adjust for types changes'
@


1.14
log
@- activate powerpc support at last
- explicitly disable tls (Thread-local storage) so it is not incorrectly
detected on some arch(s)

ok espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2007/05/16 10:19:14 steven Exp $
d11 2
a12 2
PKGNAME-main=  gcc-${FULL_PKGVERSION}p1
PKGNAME-c++ =  g++-${FULL_PKGVERSION}p1
d14 5
a18 5
PKGNAME-g77=   g77-${FULL_PKGVERSION}p0
PKGNAME-f95=   g95-${FULL_PKGVERSION}p1
PKGNAME-java=  gcj-${FULL_PKGVERSION}p0
PKGNAME-objc=  gobjc-${FULL_PKGVERSION}p1
PKGNAME-ada=   gnat-${FULL_PKGVERSION}p0
@


1.13
log
@add homepage

ok espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2007/04/01 16:44:19 sturm Exp $
d11 3
a13 3
PKGNAME-main=  gcc-${FULL_PKGVERSION}p0
PKGNAME-c++ =  g++-${FULL_PKGVERSION}p0
PKGNAME-estdc= libstdc++-${FULL_PKGVERSION}p0
d15 1
a15 1
PKGNAME-f95=   g95-${FULL_PKGVERSION}p0
d17 1
a17 1
PKGNAME-objc=  gobjc-${FULL_PKGVERSION}p0
d131 1
@


1.12
log
@really depend on specified autoconf/automake version
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2007/03/20 10:48:52 espie Exp $
d11 8
a18 8
PKGNAME-main=  gcc-${FULL_PKGVERSION}
PKGNAME-c++ =  g++-${FULL_PKGVERSION}
PKGNAME-estdc= libstdc++-${FULL_PKGVERSION}
PKGNAME-g77=   g77-${FULL_PKGVERSION}
PKGNAME-f95=   g95-${FULL_PKGVERSION}
PKGNAME-java=  gcj-${FULL_PKGVERSION}
PKGNAME-objc=  gobjc-${FULL_PKGVERSION}
PKGNAME-ada=   gnat-${FULL_PKGVERSION}
@


1.11
log
@update to a more recent snapshot.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2007/03/17 22:34:13 espie Exp $
d45 1
a45 1
BUILD_DEPENDS+= ::devel/autoconf/2.59
@


1.10
log
@revert commit mistake
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2007/02/14 16:55:28 steven Exp $
d7 1
a7 1
DATE=20061024
d11 2
a12 2
PKGNAME-main=  gcc-${FULL_PKGVERSION}p0
PKGNAME-c++ =  g++-${FULL_PKGVERSION}p0
d15 1
a15 1
PKGNAME-f95=   g95-${FULL_PKGVERSION}p0
d17 2
a18 2
PKGNAME-objc=  gobjc-${FULL_PKGVERSION}p0
PKGNAME-ada=   gnat-${FULL_PKGVERSION}p0
@


1.9
log
@new gcc snapshot, this one compiles again on i386 !
NOTE: this needs current -src, in particular current includes
for libgfortran to build correctly (semantics change in __extern inline
that lead to duplicate isalnum symbols otherwise).
@
text
@d6 4
a9 4
V=4.3.0
DATE=20070309
FULL_VERSION=4.3-${DATE}
FULL_PKGVERSION=4.3.${DATE}
d11 2
a12 2
PKGNAME-main=  gcc-${FULL_PKGVERSION}
PKGNAME-c++ =  g++-${FULL_PKGVERSION}
d15 1
a15 1
PKGNAME-f95=   g95-${FULL_PKGVERSION}
d17 2
a18 2
PKGNAME-objc=  gobjc-${FULL_PKGVERSION}
PKGNAME-ada=   gnat-${FULL_PKGVERSION}
a67 1
CONFIGURE_ARGS+=--with-gmp=${LOCALBASE}
d77 1
d164 1
a164 7
BASIC_MAKE_FLAGS=libstdc___la_LDFLAGS='-version-info 31:0:0 -lm'
MAKE_FLAGS=${BASIC_MAKE_FLAGS} \
	INSTALL='/usr/bin/install -c' \
	INSTALL_PROGRAM='/usr/bin/install -c -m 555' \
	INSTALL_DATA='/usr/bin/install -c -m 444' \

FAKE_FLAGS=DESTDIR=${WRKINST} ${BASIC_MAKE_FLAGS}
a189 1
LIB_DEPENDS-estdc=
d192 1
a192 1
LIB_DEPENDS+=		gmp:gmp->=4.2:devel/gmp \
d195 1
a195 2
LIB_DEPENDS-java=	${LIB_DEPENDS} \
			gc::devel/boehm-gc
@


1.8
log
@bump PKGNAME due to PLIST changes after 4.0 -> 4.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2006/11/25 16:26:46 espie Exp $
d6 4
a9 4
V=4.2.0
DATE=20061024
FULL_VERSION=4.2-${DATE}
FULL_PKGVERSION=4.2.${DATE}
d11 2
a12 2
PKGNAME-main=  gcc-${FULL_PKGVERSION}p0
PKGNAME-c++ =  g++-${FULL_PKGVERSION}p0
d15 1
a15 1
PKGNAME-f95=   g95-${FULL_PKGVERSION}p0
d17 2
a18 2
PKGNAME-objc=  gobjc-${FULL_PKGVERSION}p0
PKGNAME-ada=   gnat-${FULL_PKGVERSION}p0
d68 1
a77 1
CONFIGURE_ARGS+=--with-gmp=${LOCALBASE}
d164 7
a170 1
MAKE_FLAGS=libstdc___la_LDFLAGS='-version-info 31:0:0 -lm'
d196 1
d199 1
a199 1
LIB_DEPENDS-f95=	gmp:gmp->=4.2:devel/gmp \
d202 2
a203 1
LIB_DEPENDS-java=	gc::devel/boehm-gc
@


1.7
log
@clean-up:
- use PSEUDO_FLAVORS
- fix ownership of various files
- new MULTI_PACKAGES
- slightly newer snapshot
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2006/11/01 23:57:24 naddy Exp $
d11 2
a12 2
PKGNAME-main=  gcc-${FULL_PKGVERSION}
PKGNAME-c++ =  g++-${FULL_PKGVERSION}
d15 1
a15 1
PKGNAME-f95=   g95-${FULL_PKGVERSION}
d17 2
a18 2
PKGNAME-objc=  gobjc-${FULL_PKGVERSION}
PKGNAME-ada=   gnat-${FULL_PKGVERSION}
@


1.6
log
@switch -f95 gmp dependency to gmp and mpfr
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2006/10/20 13:43:18 espie Exp $
d7 1
a7 1
DATE=20061014
d11 1
a11 1
PKGNAME=       gcc-${FULL_PKGVERSION}
d15 1
a15 1
PKGNAME-f95=   g95-${FULL_PKGVERSION}p0
d31 1
a31 7
ADAI386=	adastrap-i386-3.3.6-4.tgz:0
DISTFILES=  ${DISTNAME}.tar.bz2
SUPDISTFILES=	${ADAI386}
MAKE_GXX=Yes
MAKE_FORTRAN=Yes
MAKE_OBJC=Yes
#MAKE_JAVA=Yes
d33 3
a35 2
MAKE_ADA=Yes
DISTFILES+=${ADAI386}
d38 3
a40 5
MAKE_GXX?=No
MAKE_FORTRAN?=No
MAKE_OBJC?=No
MAKE_JAVA?=No
MAKE_ADA?=No
d42 2
a48 13
SUBPACKAGE?=
WANTLIB=c
.if ${SUBPACKAGE} == "-estdc"
WANTLIB+=m
.endif

.if ${MAKE_JAVA:L} == "yes"
.  if !defined(PACKAGING) || ${SUBPACKAGE} == "-java"
LIB_DEPENDS+=gc::devel/boehm-gc
.  endif
.endif

# This can be patched out, apart from java that wants a pure parser.
d52 1
a52 5
.if ${MAKE_JAVA:L} == "yes"
MAKE_GXX=Yes
.endif

MULTI_PACKAGES=
a57 5
# No way around it, java wants a pure parser
.if ${MAKE_JAVA:L} == "yes"
BUILD_DEPENDS+=:bison-*:devel/bison
.endif

d70 1
a70 1
.if ${MAKE_GXX:L} == "yes"
d74 1
a74 1
.if ${MAKE_FORTRAN:L} == "yes"
d79 1
a79 1
.if ${MAKE_OBJC:L} == "yes"
d83 1
a83 1
.if ${MAKE_JAVA:L} == "yes"
d88 1
a88 1
.if ${MAKE_ADA:L} == "yes"
d91 1
a91 1
#DISTFILES+=adastrap-${MACHINE_ARCH}-4.0-20050102-1.tgz:0
d109 6
d141 1
a141 1
.if ${MAKE_JAVA:L} == "yes"
d156 1
a156 1
SEPARATE_BUILD=concurrent
d184 12
a195 13
SUBPACKAGE?=
.if defined(PACKAGING)
.  if !empty(SUBPACKAGE) && ${SUBPACKAGE} != "-estdc"
RUN_DEPENDS+=::${PKGPATH}
.  endif
.  if ${SUBPACKAGE} == "-c++"
RUN_DEPENDS+=:gcc-${FULL_PKGVERSION}:${PKGPATH},-estdc
.  endif
.endif
.if !defined(PACKAGING) || ${SUBPACKAGE} == "-f95"
LIB_DEPENDS+=gmp:gmp->=4.2:devel/gmp
LIB_DEPENDS+=mpfr::devel/mpfr
.endif
@


1.5
log
@update to a recent snapshot, and fix some bullshit
can probably compile on amd64 now
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2006/10/20 11:03:38 espie Exp $
d15 1
d215 2
a216 1
LIB_DEPENDS+=gmp:gmp->=4.1.4:devel/gmp
@


1.4
log
@bump ada bootstrap for libc changes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2006/10/06 12:42:42 kurt Exp $
d3 1
a3 1
ONLY_FOR_ARCHS=	alpha i386 m68k sparc sparc64 powerpc vax
d7 1
a7 1
DATE=20060715
d11 7
a17 7
PKGNAME=       gcc-${FULL_PKGVERSION}p0
PKGNAME-c++ =  g++-${FULL_PKGVERSION}p0
PKGNAME-estdc= libstdc++-${FULL_PKGVERSION}p0
PKGNAME-g77=   g77-${FULL_PKGVERSION}p0
PKGNAME-java=  gcj-${FULL_PKGVERSION}p0
PKGNAME-objc=  gobjc-${FULL_PKGVERSION}p0
PKGNAME-ada=   gnat-${FULL_PKGVERSION}p0
d187 1
a187 1
.if ${MACHINE_ARCH} == "m68k" || ${MACHINE_ARCH} == "sparc"
@


1.3
log
@correct defines for SIZE_TYPE and PTRDIFF_TYPE which fixes this error:
http://gcc.gnu.org/bugzilla/show_bug.cgi?id=28582
"error: 'operator new' takes type 'size_t' ('unsigned int') as first
parameter". help from kettenis@@, okay espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2006/08/01 08:58:11 espie Exp $
d30 1
a30 1
ADAI386=	adastrap-i386-3.3.6-3.tgz:0
@


1.2
log
@fix after compile on sparc64.
There is (again) something fishy with exceptions on sparc64...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2006/07/31 09:50:53 espie Exp $
d10 8
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2006/03/06 16:40:59 espie Exp $
d189 5
@


1.1.1.1
log
@4.2 branch of gcc
@
text
@@
