head	1.5;
access;
symbols
	OPENBSD_5_8:1.4.0.8
	OPENBSD_5_8_BASE:1.4
	OPENBSD_5_7:1.4.0.4
	OPENBSD_5_7_BASE:1.4
	OPENBSD_5_6:1.4.0.2
	OPENBSD_5_6_BASE:1.4
	OPENBSD_5_5:1.3.0.2
	OPENBSD_5_5_BASE:1.3
	OPENBSD_5_4:1.2.0.2
	OPENBSD_5_4_BASE:1.2
	pascal_20130804:1.1.1.1
	pascal:1.1.1;
locks; strict;
comment	@# @;


1.5
date	2015.09.10.08.23.55;	author pascal;	state dead;
branches;
next	1.4;
commitid	ovY05rVdcfWNuWWc;

1.4
date	2014.05.25.21.45.39;	author pascal;	state Exp;
branches;
next	1.3;

1.3
date	2013.12.02.22.34.55;	author pascal;	state Exp;
branches;
next	1.2;

1.2
date	2013.06.07.07.55.22;	author pascal;	state Exp;
branches;
next	1.1;

1.1
date	2013.04.08.08.20.25;	author pascal;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2013.04.08.08.20.25;	author pascal;	state Exp;
branches;
next	;


desc
@@


1.5
log
@tedu gcc 4.8

ok sthen@@ tobiasu@@
@
text
@$OpenBSD: patch-gcc_config_i386_i386_c,v 1.4 2014/05/25 21:45:39 pascal Exp $
--- gcc/config/i386/i386.c.orig	Thu May  8 21:32:34 2014
+++ gcc/config/i386/i386.c	Thu May 22 20:04:20 2014
@@@@ -2265,6 +2265,8 @@@@ struct ix86_frame
   HOST_WIDE_INT reg_save_offset;
   HOST_WIDE_INT sse_reg_save_offset;
 
+  HOST_WIDE_INT local_size;
+
   /* When save_regs_using_mov is set, emit prologue using
      move instead of push instructions.  */
   bool save_regs_using_mov;
@@@@ -8941,6 +8943,7 @@@@ ix86_compute_frame_layout (struct ix86_frame *frame)
   HOST_WIDE_INT size = get_frame_size ();
   HOST_WIDE_INT to_allocate;
 
+  frame->local_size = size;
   frame->nregs = ix86_nsaved_regs ();
   frame->nsseregs = ix86_nsaved_sseregs ();
 
@@@@ -10292,6 +10295,9 @@@@ ix86_expand_prologue (void)
       m->fs.sp_offset = INCOMING_FRAME_SP_OFFSET;
       m->fs.realigned = true;
     }
+
+  if (warn_stack_larger_than && frame.local_size > stack_larger_than_size)
+    warning (OPT_Wstack_larger_than_, "stack usage is %ld bytes", frame.local_size);
 
   int_registers_saved = (frame.nregs == 0);
   sse_registers_saved = (frame.nsseregs == 0);
@


1.4
log
@Update to gcc 4.8.3.  Tested on sparc64 and adastraps hosted by tobiasu@@.

"rein damit" tobiasu@@
@
text
@d1 1
a1 1
$OpenBSD: patch-gcc_config_i386_i386_c,v 1.3 2013/12/02 22:34:55 pascal Exp $
@


1.3
log
@Update to 4.8.2; adastraps hosted by/testing/ok tobiasu@@
@
text
@d1 3
a3 3
$OpenBSD: patch-gcc_config_i386_i386_c,v 1.2 2013/06/07 07:55:22 pascal Exp $
--- gcc/config/i386/i386.c.orig	Fri Aug 23 12:01:34 2013
+++ gcc/config/i386/i386.c	Wed Oct 16 18:56:48 2013
d13 1
a13 1
@@@@ -8979,6 +8981,7 @@@@ ix86_compute_frame_layout (struct ix86_frame *frame)
d21 1
a21 1
@@@@ -10330,6 +10333,9 @@@@ ix86_expand_prologue (void)
@


1.2
log
@Update to GCC 4.8.1, tested and adastrap-sparc64 built by tobiasu@@.
@
text
@d1 3
a3 3
$OpenBSD: patch-gcc_config_i386_i386_c,v 1.1.1.1 2013/04/08 08:20:25 pascal Exp $
--- gcc/config/i386/i386.c.orig	Fri May 17 17:06:36 2013
+++ gcc/config/i386/i386.c	Sat Jun  1 08:55:09 2013
d13 1
a13 1
@@@@ -8958,6 +8960,7 @@@@ ix86_compute_frame_layout (struct ix86_frame *frame)
d21 1
a21 1
@@@@ -10309,6 +10312,9 @@@@ ix86_expand_prologue (void)
@


1.1
log
@Initial revision
@
text
@d1 3
a3 3
$OpenBSD: patch-gcc_config_i386_i386_c,v 1.3 2012/09/28 18:45:42 pascal Exp $
--- gcc/config/i386/i386.c.orig	Thu Feb 21 11:57:10 2013
+++ gcc/config/i386/i386.c	Tue Mar  5 19:45:41 2013
d13 1
a13 1
@@@@ -8953,6 +8955,7 @@@@ ix86_compute_frame_layout (struct ix86_frame *frame)
d21 1
a21 1
@@@@ -10304,6 +10307,9 @@@@ ix86_expand_prologue (void)
@


1.1.1.1
log
@Import gcc 4.8.

For a full Changelog, see: http://gcc.gnu.org/gcc-4.8/changes.html

Tested by me on amd64, i386 and powerpc and by brad@@ on sparc64.

Adds support for -java on powerpc.  -faggressive-loop-optimizations is
disabled by default in the port, and the default debugging format changed
to DWARF2 (instead of 4).

tweaks and ok tobiasu@@
@
text
@@
