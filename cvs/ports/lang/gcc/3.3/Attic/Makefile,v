head	1.65;
access;
symbols
	OPENBSD_5_2:1.59.0.2
	OPENBSD_5_2_BASE:1.59
	OPENBSD_5_1_BASE:1.55
	OPENBSD_5_1:1.55.0.2
	OPENBSD_5_0:1.50.0.2
	OPENBSD_5_0_BASE:1.50
	OPENBSD_4_9:1.49.0.2
	OPENBSD_4_9_BASE:1.49
	OPENBSD_4_8:1.44.0.2
	OPENBSD_4_8_BASE:1.44
	OPENBSD_4_7:1.42.0.2
	OPENBSD_4_7_BASE:1.42
	OPENBSD_4_6:1.37.0.2
	OPENBSD_4_6_BASE:1.37
	OPENBSD_4_5:1.35.0.2
	OPENBSD_4_5_BASE:1.35
	OPENBSD_4_4:1.31.0.2
	OPENBSD_4_4_BASE:1.31
	OPENBSD_4_3:1.29.0.2
	OPENBSD_4_3_BASE:1.29
	OPENBSD_4_2:1.25.0.2
	OPENBSD_4_2_BASE:1.25
	OPENBSD_4_1:1.22.0.2
	OPENBSD_4_1_BASE:1.22
	OPENBSD_4_0:1.18.0.2
	OPENBSD_4_0_BASE:1.18
	OPENBSD_3_9:1.15.0.2
	OPENBSD_3_9_BASE:1.15
	OPENBSD_3_8:1.8.0.2
	OPENBSD_3_8_BASE:1.8
	OPENBSD_3_7:1.6.0.2
	OPENBSD_3_7_BASE:1.6
	gcc:1.1.1.1
	FSF:1.1.1;
locks; strict;
comment	@# @;


1.65
date	2013.01.22.04.05.31;	author brad;	state dead;
branches;
next	1.64;

1.64
date	2012.10.07.20.09.44;	author landry;	state Exp;
branches;
next	1.63;

1.63
date	2012.09.28.15.02.28;	author pascal;	state Exp;
branches;
next	1.62;

1.62
date	2012.09.01.00.00.32;	author pascal;	state Exp;
branches;
next	1.61;

1.61
date	2012.08.28.23.39.12;	author sthen;	state Exp;
branches;
next	1.60;

1.60
date	2012.08.20.12.35.41;	author pascal;	state Exp;
branches;
next	1.59;

1.59
date	2012.06.21.13.56.57;	author sthen;	state Exp;
branches;
next	1.58;

1.58
date	2012.05.04.08.47.55;	author pascal;	state Exp;
branches;
next	1.57;

1.57
date	2012.04.24.09.47.31;	author sthen;	state Exp;
branches;
next	1.56;

1.56
date	2012.04.23.14.06.42;	author pascal;	state Exp;
branches;
next	1.55;

1.55
date	2012.01.13.00.55.14;	author naddy;	state Exp;
branches;
next	1.54;

1.54
date	2011.11.16.15.23.46;	author espie;	state Exp;
branches;
next	1.53;

1.53
date	2011.09.26.14.06.51;	author naddy;	state Exp;
branches;
next	1.52;

1.52
date	2011.09.16.10.31.20;	author espie;	state Exp;
branches;
next	1.51;

1.51
date	2011.09.15.17.25.34;	author espie;	state Exp;
branches;
next	1.50;

1.50
date	2011.07.18.19.06.36;	author naddy;	state Exp;
branches;
next	1.49;

1.49
date	2011.01.15.01.07.45;	author naddy;	state Exp;
branches;
next	1.48;

1.48
date	2010.11.26.14.17.17;	author espie;	state Exp;
branches;
next	1.47;

1.47
date	2010.11.22.09.23.58;	author espie;	state Exp;
branches;
next	1.46;

1.46
date	2010.11.17.08.05.17;	author espie;	state Exp;
branches;
next	1.45;

1.45
date	2010.10.18.19.20.41;	author espie;	state Exp;
branches;
next	1.44;

1.44
date	2010.07.24.23.05.08;	author naddy;	state Exp;
branches;
next	1.43;

1.43
date	2010.07.17.13.31.25;	author espie;	state Exp;
branches;
next	1.42;

1.42
date	2010.02.14.20.13.18;	author naddy;	state Exp;
branches;
next	1.41;

1.41
date	2010.01.27.21.43.28;	author naddy;	state Exp;
branches;
next	1.40;

1.40
date	2009.10.15.10.46.02;	author phessler;	state Exp;
branches;
next	1.39;

1.39
date	2009.10.10.22.48.28;	author jasper;	state Exp;
branches;
next	1.38;

1.38
date	2009.09.23.20.57.02;	author jasper;	state Exp;
branches;
next	1.37;

1.37
date	2009.06.22.17.00.23;	author naddy;	state Exp;
branches;
next	1.36;

1.36
date	2009.03.16.10.24.28;	author espie;	state Exp;
branches;
next	1.35;

1.35
date	2009.02.09.20.48.23;	author naddy;	state Exp;
branches;
next	1.34;

1.34
date	2008.09.11.19.22.05;	author martynas;	state Exp;
branches;
next	1.33;

1.33
date	2008.08.28.19.04.40;	author martynas;	state Exp;
branches;
next	1.32;

1.32
date	2008.08.20.09.56.17;	author espie;	state Exp;
branches;
next	1.31;

1.31
date	2008.07.25.20.50.26;	author martynas;	state Exp;
branches;
next	1.30;

1.30
date	2008.07.04.19.41.21;	author naddy;	state Exp;
branches;
next	1.29;

1.29
date	2008.02.23.00.26.07;	author naddy;	state Exp;
branches;
next	1.28;

1.28
date	2007.12.25.19.47.35;	author ajacoutot;	state Exp;
branches;
next	1.27;

1.27
date	2007.10.22.16.28.45;	author espie;	state Exp;
branches;
next	1.26;

1.26
date	2007.09.20.15.27.53;	author sturm;	state Exp;
branches;
next	1.25;

1.25
date	2007.07.30.23.31.46;	author naddy;	state Exp;
branches;
next	1.24;

1.24
date	2007.05.16.10.19.14;	author steven;	state Exp;
branches;
next	1.23;

1.23
date	2007.04.01.16.44.19;	author sturm;	state Exp;
branches;
next	1.22;

1.22
date	2007.02.14.16.55.28;	author steven;	state Exp;
branches;
next	1.21;

1.21
date	2006.12.26.14.02.15;	author steven;	state Exp;
branches;
next	1.20;

1.20
date	2006.11.22.01.17.45;	author espie;	state Exp;
branches;
next	1.19;

1.19
date	2006.10.20.11.03.38;	author espie;	state Exp;
branches;
next	1.18;

1.18
date	2006.07.28.10.32.55;	author steven;	state Exp;
branches;
next	1.17;

1.17
date	2006.03.06.16.40.59;	author espie;	state Exp;
branches;
next	1.16;

1.16
date	2006.03.04.13.44.19;	author espie;	state Exp;
branches;
next	1.15;

1.15
date	2006.01.22.23.21.46;	author sturm;	state Exp;
branches;
next	1.14;

1.14
date	2006.01.13.20.07.53;	author espie;	state Exp;
branches;
next	1.13;

1.13
date	2006.01.08.21.35.08;	author espie;	state Exp;
branches;
next	1.12;

1.12
date	2005.10.30.19.24.11;	author espie;	state Exp;
branches;
next	1.11;

1.11
date	2005.09.14.10.41.02;	author espie;	state Exp;
branches;
next	1.10;

1.10
date	2005.09.11.07.40.58;	author espie;	state Exp;
branches;
next	1.9;

1.9
date	2005.09.05.14.55.35;	author espie;	state Exp;
branches;
next	1.8;

1.8
date	2005.08.24.22.54.42;	author espie;	state Exp;
branches;
next	1.7;

1.7
date	2005.05.16.11.14.36;	author espie;	state Exp;
branches;
next	1.6;

1.6
date	2005.02.28.12.36.13;	author espie;	state Exp;
branches;
next	1.5;

1.5
date	2005.02.27.15.41.59;	author espie;	state Exp;
branches;
next	1.4;

1.4
date	2005.02.21.15.44.48;	author alek;	state Exp;
branches;
next	1.3;

1.3
date	2005.01.08.19.18.44;	author espie;	state Exp;
branches;
next	1.2;

1.2
date	2005.01.05.22.44.10;	author espie;	state Exp;
branches;
next	1.1;

1.1
date	2005.01.03.15.21.26;	author espie;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2005.01.03.15.21.26;	author espie;	state Exp;
branches;
next	;


desc
@@


1.65
log
@tedu older version of gcc

ok pascal@@
@
text
@# $OpenBSD: Makefile,v 1.64 2012/10/07 20:09:44 landry Exp $

ONLY_FOR_ARCHS =	alpha amd64 i386 m68k sparc sparc64 powerpc vax

V = 3.3.6
FULL_VERSION = 3.3.6
FULL_PKGVERSION = 3.3.6
BOOTSTRAP_GEN = 8
ADASTRAP = adastrap-i386-3.3.6-${BOOTSTRAP_GEN}.tgz

PKGNAME-main =	gcc-${FULL_PKGVERSION}
PKGNAME-c++ =	g++-${FULL_PKGVERSION}
PKGNAME-estdc =	libstdc++-${FULL_PKGVERSION}
PKGNAME-g77 =	g77-${FULL_PKGVERSION}
PKGNAME-java =	gcj-${FULL_PKGVERSION}
PKGNAME-objc =	gobjc-${FULL_PKGVERSION}
PKGNAME-ada =	gnat-${FULL_PKGVERSION}
SHARED_LIBS =	estdc++		7.0 \
		g2c		1.0 \
		-org-w3c-dom	1.0 \
		-org-xml-sax	1.0 \
		gcj		5.0 \
		objc		2.0 \
		objc_gc		2.0

REVISION-main =		7
REVISION-c++ =		9
REVISION-estdc =	3
REVISION-g77 =		8
REVISION-java =		8
REVISION-objc =		8
REVISION-ada =		8
EPOCH = 		0

MAINTAINER =	Marc Espie <espie@@openbsd.org>

PSEUDO_FLAVORS = no_c++ no_g77 no_objc no_java no_ada
FLAVOR ?= 

# currently broken on i386 ? so empty
ONLY_FOR_ARCHS-ada =
# not really interesting either
ONLY_FOR_ARCHS-java =

BUILD_DEPENDS =		devel/autoconf/2.13
BUILD_DEPENDS +=	devel/metaauto

# This can be patched out, apart from java that wants a pure parser.
BUILD_DEPENDS += 	devel/bison


MULTI_PACKAGES =	-main -g77 -objc -java -c++ -estdc -ada

.include <bsd.port.arch.mk>

# kill both C++ subpackages
.if !${BUILD_PACKAGES:M-c++}
BUILD_PACKAGES := ${BUILD_PACKAGES:N-estdc}
.endif

USE_GROFF =		Yes

REGRESS_DEPENDS =	devel/dejagnu

DISTNAME =		gcc-${FULL_VERSION}

DISTFILES =  		${DISTNAME}.tar.bz2
SUPDISTFILES =		${ADASTRAP}:0

MASTER_SITES =	${MASTER_SITE_GCC:=releases/gcc-$(FULL_VERSION)/}
MASTER_SITES0 =	http://distfiles.tmux.org/adastrap/

CONFIGURE_STYLE =	gnu
MODGNU_CONFIG_GUESS_DIRS =	${WRKSRC} ${WRKSRC}/gcc

LANGS = c

.if ${BUILD_PACKAGES:M-c++}
LANGS := 		${LANGS},c++
.endif

.if ${BUILD_PACKAGES:M-g77}
LANGS :=		${LANGS},f77
.endif

.if ${BUILD_PACKAGES:M-objc}
LANGS := 		${LANGS},objc
.endif

.if ${BUILD_PACKAGES:M-java}
LANGS :=		${LANGS},java
CONFIGURE_ARGS +=	--enable-java-gc=system-boehm
.endif

.if ${BUILD_PACKAGES:M-ada}
LANGS :=	${LANGS},ada
DISTFILES +=	${ADASTRAP}:0
CONFIGURE_ENV = ADAC=${WRKDIR}/bin/egcc GNATBIND=${WRKDIR}/bin/gnatbind
MAKE_ENV =	ADAC=${WRKDIR}/bin/egcc GNATBIND=${WRKDIR}/bin/gnatbind

post-build:
	cd ${WRKBUILD}/gcc && ${MAKE_PROGRAM} gnatlib_and_tools
.endif

post-extract:
.if ${BUILD_PACKAGES:M-ada}
.  for f in egcc gnatbind gnatmake gnatlink
	echo "#! /bin/sh" >${WRKDIR}/bin/$f
	echo 'GNAT_ROOT=${WRKDIR}/bootstrap GCC_ROOT=${WRKDIR}/bootstrap exec ${WRKDIR}/bootstrap/bin/$f "$$@@"' >>${WRKDIR}/bin/$f
	chmod a+x ${WRKDIR}/bin/$f
.  endfor
.endif
	echo "# This file automatically generated" >> ${WRKSRC}/libversions
.for l v in ${SHARED_LIBS}
	echo "LIB$l_LTVERSION = -version-info ${v:S/./:/}" >> ${WRKSRC}/libversions
.endfor

post-install:
.if ${BUILD_PACKAGES:M-ada}
	chown -R ${SHAREOWN}:${SHAREGRP} ${PREFIX}/lib/gcc-lib/*/$V/adainclude
.endif
	chown -R ${SHAREOWN}:${SHAREGRP} ${PREFIX}/lib/gcc-lib/*/$V/include

CONFIGURE_ENV +=	am_cv_func_iconv=no

CONFIGURE_ARGS = \
	--verbose \
	--program-transform-name=s,^,e, \
	--disable-nls  \
	--with-system-zlib \
	--enable-languages=${LANGS}

# This is needed, as internal cpp is no longer compatible with the
# visible beast
CONFIGURE_ARGS += --enable-cpp

.if ${BUILD_PACKAGES:M-java}
CONFIGURE_ARGS += --enable-sjlj-exceptions
# No way around it, java wants a pure parser
BUILD_DEPENDS += devel/bison
.endif

CONFIGURE_ARGS += --enable-threads=posix
CONFIGURE_ARGS += --with-gnu-as 
CONFIGURE_ARGS += --with-gnu-ld 
CONFIGURE_ARGS += ${CONFIGURE_SHARED}

SEPARATE_BUILD = flavored

USE_GMAKE = 	Yes

# you shouldn't skip bootstrap unless you know what you're doing
# use bootstrap-lean if you're pressed for space
ALL_TARGET = bootstrap

.if ${MACHINE_ARCH} == "m68k" || ${MACHINE_ARCH} == "sparc"
PKG_ARGS += -DPIC=1
.else
PKG_ARGS += -DPIC=0
.endif

.if ${MACHINE_ARCH} == "powerpc"
PKG_ARGS += -DPPC=1
.else
PKG_ARGS += -DPPC=0
.endif

RUN_DEPENDS =	gcc-${FULL_PKGVERSION}v0:${PKGPATH}
WANTLIB =	c

RUN_DEPENDS-main =

RUN_DEPENDS-estdc =
WANTLIB-estdc =

LIB_DEPENDS-java = devel/boehm-gc
WANTLIB-java =	${WANTLIB} gc

RUN_DEPENDS-c++ = ${RUN_DEPENDS} libstdc++->=3.3,<3.4|libstdc++->=3.3v0,<3.4v0:${PKGPATH},-estdc


.include <bsd.port.mk>

ADA_PACKAGE = ${PACKAGE_REPOSITORY}/i386/all/${PKGNAME-ada}${PKG_SUFX}
GCC_PACKAGE = ${PACKAGE_REPOSITORY}/i386/all/${PKGNAME-main}${PKG_SUFX}


adastrap: ${ADA_PACKAGE} ${GCC_PACKAGE}
	mkdir -p ${WRKDIR}/prepare/bootstrap
	cd ${WRKDIR}/prepare/bootstrap && tar zxf ${ADA_PACKAGE}
	cd ${WRKDIR}/prepare/bootstrap && tar zxf ${GCC_PACKAGE}
	rm -rf ${WRKDIR}/prepare/bootstrap/{+*,info,man}
	cd ${WRKDIR}/prepare && tar zcf ${FULLDISTDIR}/${ADASTRAP} bootstrap
@


1.64
log
@Sync the config/openbsd.h and config/sparc/openbsd64.h patches with
respectively r1.9 and r1.6 of base gcc ones adding #define
NO_IMPLICIT_EXTERN_C. While here add the missing #define
NO_UNSAFE_BUILTINS to gfortran/gcc 4.2, Bump all REVISIONs.
ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.63 2012/09/28 15:02:28 pascal Exp $
@


1.63
log
@Unify MASTER_SITES for adastrap; they're now all hosted by Tobias Ulmer on
tmux.org.  Makes gnat bootstrapping work a little easier for him.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62 2012/09/01 00:00:32 pascal Exp $
d26 7
a32 7
REVISION-main =		6
REVISION-c++ =		8
REVISION-estdc =	2
REVISION-g77 =		7
REVISION-java =		7
REVISION-objc =		7
REVISION-ada =		7
@


1.62
log
@Patch GCC and derived ports to use PIE by default on the same architectures it
is enabled on in base; except for gcc 3.3, which does not have PIE support and
therefore needs to pass -nopie to the linker.

Also, sync powerpc pthread specs with base.  From Brad.

ok naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.61 2012/08/28 23:39:12 sthen Exp $
d71 1
a71 1
MASTER_SITES0 =	ftp://quatramaran.ens.fr/pub/espie/
@


1.61
log
@sync OBSD_LIB_SPEC in the ports tree compilers with the updated one
in base; from Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.60 2012/08/20 12:35:41 pascal Exp $
d26 2
a27 2
REVISION-main =		5
REVISION-c++ =		7
d29 4
a32 4
REVISION-g77 =		6
REVISION-java =		6
REVISION-objc =		6
REVISION-ada =		6
@


1.60
log
@Sync -pthread semantics with base gcc.  From Brad.

ok matthew@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59 2012/06/21 13:56:57 sthen Exp $
d26 2
a27 2
REVISION-main =		4
REVISION-c++ =		6
d29 4
a32 4
REVISION-g77 =		5
REVISION-java =		5
REVISION-objc =		5
REVISION-ada =		5
@


1.59
log
@bump for plist changes 5.1 -> 5.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2012/05/04 08:47:55 pascal Exp $
d26 2
a27 2
REVISION-main =		3
REVISION-c++ =		5
d29 4
a32 4
REVISION-g77 =		4
REVISION-java =		4
REVISION-objc =		4
REVISION-ada =		4
@


1.58
log
@Do not let different versions of libstdc++ conflict with each other.  At the
same time, make sure that g++ is never installed alongside a higher version
of libstdc++, so that stuff will always link to the correct library.

feedback espie@@ and kurt@@, ok kurt@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.57 2012/04/24 09:47:31 sthen Exp $
d26 7
a32 7
REVISION-main =		2
REVISION-c++ =		4
REVISION-estdc =	1
REVISION-g77 =		3
REVISION-java =		3
REVISION-objc =		3
REVISION-ada =		3
@


1.57
log
@missing bump -estdc
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2012/04/23 14:06:42 pascal Exp $
d27 2
a28 2
REVISION-c++ =		3
REVISION-estdc =	0
@


1.56
log
@- define _REENTRANT, not _POSIX_THREADS for -pthread
- enable thread model posix; bump estdc++ major
- fix manpages: install cpp.1 and gcov.1 with an 'e' prefix, and install
  another copy of gcc.1 as eg++.1 instead of an effectively empty page.

feedback and ok kurt@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55 2012/01/13 00:55:14 naddy Exp $
d28 1
a28 1
#REVISION-estdc =
@


1.55
log
@bump revision for plist changes 5.0 -> 5.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.54 2011/11/16 15:23:46 espie Exp $
d18 1
a18 1
SHARED_LIBS =	estdc++		6.0 \
d26 2
a27 2
REVISION-main =		1
REVISION-c++ =		2
d29 4
a32 4
REVISION-g77 =		2
REVISION-java =		2
REVISION-objc =		2
REVISION-ada =		2
d143 1
a143 4

# if you wish to try your luck
#CONFIGURE_ARGS += --enable-threads=posix

@


1.54
log
@fix obvious typo, if someone's ever going to fix it
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2011/09/26 14:06:51 naddy Exp $
d26 2
a27 2
REVISION-main =		0
REVISION-c++ =		1
d29 4
a32 4
REVISION-g77 =		1
REVISION-java =		1
REVISION-objc =		1
REVISION-ada =		1
@


1.53
log
@use bsd.port.arch.mk framework
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.52 2011/09/16 10:31:20 espie Exp $
d106 1
a106 1
.if ${BUILD_PACKAGES:M-ada} == "yes"
@


1.52
log
@normalize pkgpath
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 2011/09/15 17:25:34 espie Exp $
d37 2
a38 3
PSEUDO_FLAVORS = no_c++ no_fortran no_objc no_java no_ada

.include <bsd.own.mk>
a44 2
FLAVOR ?= 

d52 1
a52 2
MULTI_PACKAGES =	-main
BUILD = c
d54 1
a54 27
.if !${FLAVOR:L:Mno_fortran}
MULTI_PACKAGES += -g77
BUILD += fortran
.endif

.if !${FLAVOR:L:Mno_objc}
MULTI_PACKAGES += -objc
BUILD += objc
.endif

.if ${FLAVOR:L:Mno_java}
MULTI_PACKAGES += -java
.  for _a in ${MACHINE_ARCH} ${ARCH}
.    if ${ONLY_FOR_ARCHS-java:M${_a}}
BUILD += java
.    endif
.  endfor
.endif

.if !${FLAVOR:L:Mno_ada}
MULTI_PACKAGES += -ada
.  for _a in ${MACHINE_ARCH} ${ARCH}
.    if ${ONLY_FOR_ARCHS-ada:M${_a}}
BUILD += ada
.    endif
.  endfor
.endif
d56 3
a58 3
.if !${FLAVOR:L:Mno_c++} || ${BUILD:Mjava}
MULTI_PACKAGES += -c++ -estdc
BUILD += c++
d78 1
a78 1
.if ${BUILD:Mc++}
d82 1
a82 1
.if ${BUILD:Mfortran}
d86 1
a86 1
.if ${BUILD:Mobjc}
d90 1
a90 1
.if ${BUILD:Mjava}
d95 1
a95 1
.if ${BUILD:Mada}
d106 1
a106 1
.if ${BUILD:Mada} == "yes"
d119 1
a119 1
.if ${BUILD:Mada}
d137 1
a137 1
.if ${BUILD:Mjava}
@


1.51
log
@modernize gcc build: pseudo-flavors, multi-packages, and ONLY_FOR_ARCHS-*

(prevent bulk from building gcc 4 twice, once for java, once for objc)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2011/07/18 19:06:36 naddy Exp $
d27 1
a27 1
REVISION-c++ =		0
d29 4
a32 4
REVISION-g77 =		0
REVISION-java =		0
REVISION-objc =		0
REVISION-ada =		0
@


1.50
log
@bump revision for plist changes 4.9 -> 5.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2011/01/15 01:07:45 naddy Exp $
d37 1
a37 1
PSEUDO_FLAVORS =	c++ fortran objc java ada
d43 2
d46 1
a46 5
FLAVOR ?= c++ fortran objc ada

.if ${FLAVOR:L:Mjava}
FLAVOR += c++
.endif
d56 35
d108 1
a108 1
.if ${FLAVOR:L:Mc++}
a109 1
MULTI_PACKAGES += 	-c++ -estdc
d112 1
a112 1
.if ${FLAVOR:L:Mfortran}
a113 1
MULTI_PACKAGES +=	-g77
d116 1
a116 1
.if ${FLAVOR:L:Mobjc}
a117 1
MULTI_PACKAGES += 	-objc
d120 1
a120 1
.if ${FLAVOR:L:Mjava}
a121 1
MULTI_PACKAGES +=	-java
d125 1
a125 9
BUILD_ADA = No
.if ${FLAVOR:L:Mada}
MULTI_PACKAGES +=	-ada
# currently broken everywhere
.  if ${MACHINE_ARCH:L} == "i386"
#BUILD_ADA = yes
.  endif
.endif
.if ${BUILD_ADA:L} == "yes"
d136 1
a136 1
.if ${BUILD_ADA:L} == "yes"
d149 1
a149 1
.if ${BUILD_ADA:L} == "yes"
d167 1
a167 1
.if ${FLAVOR:L:Mjava}
@


1.49
log
@Epoch bump for lang/gcc/3.3 because the version number shouldn't
count as older than one from 2005.

Revision bump for all ports that depend on libstdc++-3 because the
package specs have changed.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2010/11/26 14:17:17 espie Exp $
d26 8
a33 1
EPOCH = 	0
@


1.48
log
@zap autoconf-N: part, since it's now default
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2010/11/22 09:23:58 espie Exp $
d26 1
a26 7
REVISION-main =		17
REVISION-c++ =		16
REVISION-estdc =	5
REVISION-g77 =		15
REVISION-java =		13
REVISION-objc =		15
REVISION-ada =		13
d173 1
a173 1
RUN_DEPENDS =	gcc-${FULL_PKGVERSION}:${PKGPATH}
d184 1
a184 1
RUN_DEPENDS-c++ = ${RUN_DEPENDS} ${PKGPATH},-estdc
@


1.47
log
@missed some
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2010/11/17 08:05:17 espie Exp $
d49 1
a49 1
BUILD_DEPENDS =		autoconf-2.13:devel/autoconf/2.13
@


1.46
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2010/10/18 19:20:41 espie Exp $
d49 2
a50 2
BUILD_DEPENDS =		:autoconf-2.13:devel/autoconf/2.13
BUILD_DEPENDS +=	::devel/metaauto
@


1.45
log
@USE_GROFF=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2010/07/24 23:05:08 naddy Exp $
d53 1
a53 1
BUILD_DEPENDS += 	:bison-*:devel/bison
d57 1
a57 1
USE_GROFF =	Yes
d59 1
a59 1
REGRESS_DEPENDS =	::devel/dejagnu
d148 1
a148 1
BUILD_DEPENDS += ::devel/bison
d179 1
a179 1
RUN_DEPENDS =	:gcc-${FULL_PKGVERSION}:${PKGPATH}
d187 1
a187 1
LIB_DEPENDS-java = ::devel/boehm-gc
d190 1
a190 1
RUN_DEPENDS-c++ = ${RUN_DEPENDS} ::${PKGPATH},-estdc
@


1.44
log
@bump PKGNAME for PLIST changes 4.7 -> 4.8
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2010/07/17 13:31:25 espie Exp $
d57 1
@


1.43
log
@modernize, zap ada for now (doesn't build on i386 ?)
bump everything since we use the default DESCRs now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2010/02/14 20:13:18 naddy Exp $
d26 2
a27 2
REVISION-main =		16
REVISION-c++ =		15
d29 4
a32 4
REVISION-g77 =		14
REVISION-java =		12
REVISION-objc =		14
REVISION-ada =		12
@


1.42
log
@sync Ada bootstrap; with and ok espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2010/01/27 21:43:28 naddy Exp $
d3 1
a3 1
ONLY_FOR_ARCHS=	alpha amd64 i386 m68k sparc sparc64 powerpc vax
d5 3
a7 3
V=3.3.6
FULL_VERSION=3.3.6
FULL_PKGVERSION=3.3.6
d11 8
a18 8
PKGNAME-main=	gcc-${FULL_PKGVERSION}p15
PKGNAME-c++ =	g++-${FULL_PKGVERSION}p14
PKGNAME-estdc=	libstdc++-${FULL_PKGVERSION}p4
PKGNAME-g77=	g77-${FULL_PKGVERSION}p12
PKGNAME-java=	gcj-${FULL_PKGVERSION}p11
PKGNAME-objc=	gobjc-${FULL_PKGVERSION}p13
PKGNAME-ada=	gnat-${FULL_PKGVERSION}p11
SHARED_LIBS=	estdc++		6.0 \
d26 7
a32 1
MAINTAINER=	Marc Espie <espie@@openbsd.org>
d34 1
a34 1
PSEUDO_FLAVORS=c++ fortran objc java ada
d36 8
a43 5
.if ${MACHINE_ARCH} == "i386"
FLAVOR?=c++ fortran objc ada
.else
FLAVOR?=c++ fortran objc
.endif
d46 1
a46 1
FLAVOR+=c++
d49 2
a50 2
BUILD_DEPENDS=	:autoconf-2.13:devel/autoconf/2.13
BUILD_DEPENDS+=	::devel/metaauto
d53 1
a53 1
BUILD_DEPENDS+= :bison-*:devel/bison
d56 1
a56 10
MULTI_PACKAGES=-main
# No sub packages description
DESCR=${PKGDIR}/DESCR
DESCR-main = ${DESCR}
DESCR-c++ = ${DESCR}
DESCR-estdc = ${DESCR}
DESCR-g77 = ${DESCR}
DESCR-java = ${DESCR}
DESCR-objc = ${DESCR}
DESCR-ada= ${DESCR}
d58 1
a58 1
REGRESS_DEPENDS=::devel/dejagnu
d60 1
a60 1
DISTNAME=	gcc-${FULL_VERSION}
d62 2
a63 2
DISTFILES=  ${DISTNAME}.tar.bz2
SUPDISTFILES=${ADASTRAP}:0
d65 2
a66 2
MASTER_SITES=	${MASTER_SITE_GCC:=releases/gcc-$(FULL_VERSION)/}
MASTER_SITES0=	ftp://quatramaran.ens.fr/pub/espie/
d68 2
a69 2
CONFIGURE_STYLE=	gnu
MODGNU_CONFIG_GUESS_DIRS=	${WRKSRC} ${WRKSRC}/gcc
d71 1
a71 1
LANGS=c
d74 2
a75 2
LANGS:=${LANGS},c++
MULTI_PACKAGES+=-c++ -estdc
d79 2
a80 2
LANGS:=${LANGS},f77
MULTI_PACKAGES+=-g77
d84 2
a85 2
LANGS:=${LANGS},objc
MULTI_PACKAGES+=-objc
d89 3
a91 3
LANGS:=${LANGS},java
MULTI_PACKAGES+=-java
CONFIGURE_ARGS+=--enable-java-gc=system-boehm
d94 1
d96 11
a106 5
LANGS:=${LANGS},ada
MULTI_PACKAGES+=-ada
DISTFILES+=${ADASTRAP}:0
CONFIGURE_ENV=ADAC=${WRKDIR}/bin/egcc GNATBIND=${WRKDIR}/bin/gnatbind
MAKE_ENV=ADAC=${WRKDIR}/bin/egcc GNATBIND=${WRKDIR}/bin/gnatbind
d113 1
a113 1
.if ${FLAVOR:L:Mada}
d126 1
a126 1
.if ${FLAVOR:L:Mada}
d131 1
a131 1
CONFIGURE_ENV+=am_cv_func_iconv=no
d133 1
a133 1
CONFIGURE_ARGS= \
d142 1
a142 1
CONFIGURE_ARGS+=--enable-cpp
d145 1
a145 1
CONFIGURE_ARGS+=--enable-sjlj-exceptions
d147 1
a147 1
BUILD_DEPENDS+=:bison-*:devel/bison
d152 1
a152 1
#CONFIGURE_ARGS+= --enable-threads=posix
d158 1
a158 1
SEPARATE_BUILD=flavored
d160 1
a160 1
USE_GMAKE= yes
d164 1
a164 1
ALL_TARGET=bootstrap
d167 1
a167 1
PKG_ARGS+=-DPIC=1
d169 1
a169 1
PKG_ARGS+=-DPIC=0
d173 1
a173 1
PKG_ARGS+=-DPPC=1
d175 1
a175 1
PKG_ARGS+=-DPPC=0
d178 2
a179 2
RUN_DEPENDS=	:gcc-${FULL_PKGVERSION}:${PKGPATH}
WANTLIB=c
d181 1
a181 1
RUN_DEPENDS-main=
d183 2
a184 2
RUN_DEPENDS-estdc=
WANTLIB-estdc=
d186 2
a187 1
LIB_DEPENDS-java=gc::devel/boehm-gc
d189 1
a189 1
RUN_DEPENDS-c++ =${RUN_DEPENDS} ::${PKGPATH},-estdc
d194 2
a195 2
ADA_PACKAGE=${PACKAGE_REPOSITORY}/i386/all/${PKGNAME-ada}${PKG_SUFX}
GCC_PACKAGE=${PACKAGE_REPOSITORY}/i386/all/${PKGNAME-main}${PKG_SUFX}
@


1.41
log
@bump PKGNAME for PLIST changes 4.6 -> 4.7
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2009/10/15 10:46:02 phessler Exp $
d8 1
a8 1
BOOTSTRAP_GEN = 7
@


1.40
log
@fix LIB_DEPEND, so gcc3-c++ will package again.
(only important on gcc2 arches)

OK espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2009/10/10 22:48:28 jasper Exp $
d11 2
a12 2
PKGNAME-main=	gcc-${FULL_PKGVERSION}p14
PKGNAME-c++ =	g++-${FULL_PKGVERSION}p13
d14 4
a17 4
PKGNAME-g77=	g77-${FULL_PKGVERSION}p11
PKGNAME-java=	gcj-${FULL_PKGVERSION}p10
PKGNAME-objc=	gobjc-${FULL_PKGVERSION}p12
PKGNAME-ada=	gnat-${FULL_PKGVERSION}p10
@


1.39
log
@- resolve conflict of gcj with devel/libffi:
gcj only needs the internal libffi copy to build and links statically against
it. so there is no point in installing the libffi headers and libraries from
the gcc tree.

discussed with espie@@ kurt@@ and upstream libffi maintainer

ok espie@@ kurt@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2009/09/23 20:57:02 jasper Exp $
d12 2
a13 2
PKGNAME-c++ =	g++-${FULL_PKGVERSION}p12
PKGNAME-estdc=	libstdc++-${FULL_PKGVERSION}p3
@


1.38
log
@- add @@conflict marker for libffi with gcj

ok kurt@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2009/06/22 17:00:23 naddy Exp $
d15 1
a15 1
PKGNAME-java=	gcj-${FULL_PKGVERSION}p9
@


1.37
log
@bump PKGNAME for PLIST changes 4.5 -> 4.6
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2009/03/16 10:24:28 espie Exp $
d15 1
a15 1
PKGNAME-java=	gcj-${FULL_PKGVERSION}p8
@


1.36
log
@fix dep, regen adastrap for -current
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2009/02/09 20:48:23 naddy Exp $
d11 2
a12 2
PKGNAME-main=	gcc-${FULL_PKGVERSION}p13
PKGNAME-c++ =	g++-${FULL_PKGVERSION}p11
d14 4
a17 4
PKGNAME-g77=	g77-${FULL_PKGVERSION}p10
PKGNAME-java=	gcj-${FULL_PKGVERSION}p7
PKGNAME-objc=	gobjc-${FULL_PKGVERSION}p11
PKGNAME-ada=	gnat-${FULL_PKGVERSION}p9
@


1.35
log
@bump PKGNAME for PLIST changes 4.4 -> 4.5
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2008/09/11 19:22:05 martynas Exp $
d8 1
a8 1
BOOTSTRAP_GEN = 6
d40 1
a40 1
BUILD_DEPENDS=	:autoconf-2.13*:devel/autoconf/2.13
@


1.34
log
@our math.h does not need quirks for gcc anymore.  fix-includes
script does not produce math.h, and just uses the system one, so
remove it from PLIST.  makes gccs package again.  spotted&ok naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2008/08/28 19:04:40 martynas Exp $
d11 2
a12 2
PKGNAME-main=	gcc-${FULL_PKGVERSION}p12
PKGNAME-c++ =	g++-${FULL_PKGVERSION}p10
d14 4
a17 4
PKGNAME-g77=	g77-${FULL_PKGVERSION}p9
PKGNAME-java=	gcj-${FULL_PKGVERSION}p6
PKGNAME-objc=	gobjc-${FULL_PKGVERSION}p10
PKGNAME-ada=	gnat-${FULL_PKGVERSION}p8
@


1.33
log
@- works on amd64, so mark it in ONLY_FOR_ARCHS
- adapt 128-bit arithmetics fix
tested by Simon Kuhnle
tested by/ok sthen@@, ok espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2008/08/20 09:56:17 espie Exp $
d11 1
a11 1
PKGNAME-main=	gcc-${FULL_PKGVERSION}p11
@


1.32
log
@fix bootstrap for ada and -current
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2008/07/25 20:50:26 martynas Exp $
d3 1
a3 1
ONLY_FOR_ARCHS=	alpha i386 m68k sparc sparc64 powerpc vax
d11 1
a11 1
PKGNAME-main=	gcc-${FULL_PKGVERSION}p10
@


1.31
log
@adapt the C++ fix for C99 math functions, and bump c++ pkgname:
don't undefine C99 math macros, if !_GLIBCPP_USE_C99, so that we
can use these functions in C++.
espie@@ agrees
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2008/07/04 19:41:21 naddy Exp $
d8 2
d63 1
a63 1
SUPDISTFILES=adastrap-i386-3.3.6-5.tgz:0
d97 1
a97 1
DISTFILES+=adastrap-${MACHINE_ARCH}-3.3.6-5.tgz:0
d183 1
d185 11
@


1.30
log
@bump PKGNAME for PLIST changes 4.3 -> 4.4
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2008/02/23 00:26:07 naddy Exp $
d10 1
a10 1
PKGNAME-c++ =	g++-${FULL_PKGVERSION}p9
@


1.29
log
@bump PKGNAME for PLIST changes 4.2 -> 4.3
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2007/12/25 19:47:35 ajacoutot Exp $
d9 2
a10 2
PKGNAME-main=	gcc-${FULL_PKGVERSION}p9
PKGNAME-c++ =	g++-${FULL_PKGVERSION}p8
d12 4
a15 4
PKGNAME-g77=	g77-${FULL_PKGVERSION}p8
PKGNAME-java=	gcj-${FULL_PKGVERSION}p5
PKGNAME-objc=	gobjc-${FULL_PKGVERSION}p9
PKGNAME-ada=	gnat-${FULL_PKGVERSION}p7
@


1.28
log
@- fix packaging; my bad
- bump PKGNAMEs for version 3.3

noticed by sturm@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2007/10/22 16:28:45 espie Exp $
d9 2
a10 2
PKGNAME-main=	gcc-${FULL_PKGVERSION}p8
PKGNAME-c++ =	g++-${FULL_PKGVERSION}p7
d12 4
a15 4
PKGNAME-g77=	g77-${FULL_PKGVERSION}p7
PKGNAME-java=	gcj-${FULL_PKGVERSION}p4
PKGNAME-objc=	gobjc-${FULL_PKGVERSION}p8
PKGNAME-ada=	gnat-${FULL_PKGVERSION}p6
@


1.27
log
@fix ada bootstrap wrt recent libc
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2007/09/20 15:27:53 sturm Exp $
d9 7
a15 7
PKGNAME-main=	gcc-${FULL_PKGVERSION}p7
PKGNAME-c++ =	g++-${FULL_PKGVERSION}p6
PKGNAME-estdc=	libstdc++-${FULL_PKGVERSION}p2
PKGNAME-g77=	g77-${FULL_PKGVERSION}p6
PKGNAME-java=	gcj-${FULL_PKGVERSION}p3
PKGNAME-objc=	gobjc-${FULL_PKGVERSION}p7
PKGNAME-ada=	gnat-${FULL_PKGVERSION}p5
d48 7
a57 2


a59 1

a181 1

@


1.26
log
@missing PKGNAME bumps
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2007/07/30 23:31:46 naddy Exp $
d57 1
a57 1
SUPDISTFILES=adastrap-i386-3.3.6-4.tgz:0
d91 1
a91 1
DISTFILES+=adastrap-${MACHINE_ARCH}-3.3.6-4.tgz:0
@


1.25
log
@bump package names due to OSREV increment and corresponding plist changes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2007/05/16 10:19:14 steven Exp $
d9 7
a15 7
PKGNAME-main=	gcc-${FULL_PKGVERSION}p6
PKGNAME-c++ =	g++-${FULL_PKGVERSION}p5
PKGNAME-estdc=	libstdc++-${FULL_PKGVERSION}p1
PKGNAME-g77=	g77-${FULL_PKGVERSION}p5
PKGNAME-java=	gcj-${FULL_PKGVERSION}p2
PKGNAME-objc=	gobjc-${FULL_PKGVERSION}p6
PKGNAME-ada=	gnat-${FULL_PKGVERSION}p4
@


1.24
log
@add homepage

ok espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2007/04/01 16:44:19 sturm Exp $
d9 2
a10 2
PKGNAME-main=	gcc-${FULL_PKGVERSION}p5
PKGNAME-c++ =	g++-${FULL_PKGVERSION}p4
d12 4
a15 4
PKGNAME-g77=	g77-${FULL_PKGVERSION}p4
PKGNAME-java=	gcj-${FULL_PKGVERSION}p1
PKGNAME-objc=	gobjc-${FULL_PKGVERSION}p5
PKGNAME-ada=	gnat-${FULL_PKGVERSION}p3
@


1.23
log
@really depend on specified autoconf/automake version
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2007/02/14 16:55:28 steven Exp $
d9 7
a15 7
PKGNAME-main=	gcc-${FULL_PKGVERSION}p4
PKGNAME-c++ =	g++-${FULL_PKGVERSION}p3
PKGNAME-estdc=	libstdc++-${FULL_PKGVERSION}p0
PKGNAME-g77=	g77-${FULL_PKGVERSION}p3
PKGNAME-java=	gcj-${FULL_PKGVERSION}p0
PKGNAME-objc=	gobjc-${FULL_PKGVERSION}p4
PKGNAME-ada=	gnat-${FULL_PKGVERSION}p2
@


1.22
log
@bump PKGNAME due to PLIST changes after 4.0 -> 4.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2006/12/26 14:02:15 steven Exp $
d38 1
a38 1
BUILD_DEPENDS=	::devel/autoconf/2.13
@


1.21
log
@better chown statement which also fixes the group of files in the -objc
subpackage.

ok espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2006/11/22 01:17:45 espie Exp $
d9 2
a10 2
PKGNAME-main=	gcc-${FULL_PKGVERSION}p3
PKGNAME-c++ =	g++-${FULL_PKGVERSION}p2
d12 1
a12 1
PKGNAME-g77=	g77-${FULL_PKGVERSION}p2
d14 2
a15 2
PKGNAME-objc=	gobjc-${FULL_PKGVERSION}p3
PKGNAME-ada=	gnat-${FULL_PKGVERSION}p1
@


1.20
log
@new MULTI_PACKAGES
fix ownership of a few files
turn MAKE_xxx into PSEUDO_FLAVORS
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2006/10/20 11:03:38 espie Exp $
d14 1
a14 1
PKGNAME-objc=	gobjc-${FULL_PKGVERSION}p2
d116 1
a116 1
	chown ${SHAREOWN}:${SHAREGRP} ${PREFIX}/lib/gcc-lib/*/$V/include/*
@


1.19
log
@bump ada bootstrap for libc changes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2006/07/28 10:32:55 steven Exp $
d9 1
a9 1
PKGNAME=	gcc-${FULL_PKGVERSION}p2
d26 2
a27 4
MAKE_GXX=Yes
MAKE_FORTRAN=Yes
MAKE_OBJC=Yes
#MAKE_JAVA=Yes
d29 3
a31 1
MAKE_ADA=Yes
d34 3
a36 5
MAKE_GXX?=No
MAKE_FORTRAN?=No
MAKE_OBJC?=No
MAKE_JAVA?=No
MAKE_ADA?=No
a39 11
SUBPACKAGE?=

.if defined(PACKAGING) && ${SUBPACKAGE} != "-estdc"
WANTLIB=c
.endif

.if ${MAKE_JAVA:L} == "yes"
.  if !defined(PACKAGING) || ${SUBPACKAGE} == "-java"
LIB_DEPENDS+=gc::devel/boehm-gc
.  endif
.endif
d45 1
a45 5
.if ${MAKE_JAVA:L} == "yes"
MAKE_GXX=Yes
.endif

MULTI_PACKAGES=
a50 4
# No way around it, java wants a pure parser
.if ${MAKE_JAVA:L} == "yes"
BUILD_DEPENDS+=:bison-*:devel/bison
.endif
d66 2
a67 1
.if ${MAKE_GXX:L} == "yes"
d71 2
a72 1
.if ${MAKE_FORTRAN:L} == "yes"
d76 2
a77 1
.if ${MAKE_OBJC:L} == "yes"
d81 2
a82 1
.if ${MAKE_JAVA:L} == "yes"
d87 2
a88 1
.if ${MAKE_ADA:L} == "yes"
a91 3
#CONFIGURE_ENV=ADAC=${LOCALBASE}/bin/egcc GNATBIND=${LOCALBASE}/bin/gnatbind
#MAKE_ENV=ADAC=${LOCALBASE}/bin/egcc GNATBIND=${LOCALBASE}/bin/gnatbind
#BUILD_DEPENDS+=:gnat-*:lang/gcc/3.3,-ada
a96 1

d100 1
a100 1
.if ${MAKE_ADA:L} == "yes"
d112 6
d131 1
a131 1
.if ${MAKE_JAVA:L} == "yes"
d133 2
d145 1
a145 1
SEPARATE_BUILD=concurrent
d165 11
a175 8
.if defined(PACKAGING) && defined(SUBPACKAGE)
.  if !empty(SUBPACKAGE) && ${SUBPACKAGE} != "-estdc"
RUN_DEPENDS+=:gcc-${FULL_PKGVERSION}:${PKGPATH}
.  endif
.  if ${SUBPACKAGE} == "-c++"
RUN_DEPENDS+=::${PKGPATH},-estdc
.  endif
.endif
@


1.18
log
@bump PKGNAME due to PLIST changes after 3.9 -> 4.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2006/03/06 16:40:59 espie Exp $
d78 1
a78 1
SUPDISTFILES=adastrap-i386-3.3.6-3.tgz:0
d107 1
a107 1
DISTFILES+=adastrap-${MACHINE_ARCH}-3.3.6-3.tgz:0
@


1.17
log
@update adabootstrap files to -current.
noticed by steven@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2006/03/04 13:44:19 espie Exp $
d9 2
a10 2
PKGNAME=	gcc-${FULL_PKGVERSION}p1
PKGNAME-c++ =	g++-${FULL_PKGVERSION}p1
d12 1
a12 1
PKGNAME-g77=	g77-${FULL_PKGVERSION}p1
d14 2
a15 2
PKGNAME-objc=	gobjc-${FULL_PKGVERSION}p1
PKGNAME-ada=	gnat-${FULL_PKGVERSION}p0
@


1.16
log
@fix obvious mistake on !i386, surprised nobody spotted it yet.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2006/01/22 23:21:46 sturm Exp $
d78 1
a78 1
SUPDISTFILES=adastrap-i386-3.3.6-2.tgz:0
d107 1
a107 1
DISTFILES+=adastrap-${MACHINE_ARCH}-3.3.6-2.tgz:0
@


1.15
log
@bump PKGNAME due to PLIST changes after 3.8 -> 3.9
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2006/01/13 20:07:53 espie Exp $
d114 5
d120 2
a121 1
.for f in egcc gnatbind gnatmake gnatlink
d125 2
a126 1
.endfor
a131 4
post-build:
	cd ${WRKBUILD}/gcc && ${MAKE_PROGRAM} gnatlib_and_tools

.endif
@


1.14
log
@type changes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2006/01/08 21:35:08 espie Exp $
d9 2
a10 2
PKGNAME=	gcc-${FULL_PKGVERSION}p0
PKGNAME-c++ =	g++-${FULL_PKGVERSION}p0
d12 1
a12 1
PKGNAME-g77=	g77-${FULL_PKGVERSION}p0
d14 2
a15 1
PKGNAME-objc=	gobjc-${FULL_PKGVERSION}p0
@


1.13
log
@shared libs, in a somewhat twisted way, but it works...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2005/10/30 19:24:11 espie Exp $
d9 13
a21 13
PKGNAME=	gcc-${FULL_PKGVERSION}
PKGNAME-c++ =	g++-${FULL_PKGVERSION}
PKGNAME-estdc=	libstdc++-${FULL_PKGVERSION}
PKGNAME-g77=	g77-${FULL_PKGVERSION}
PKGNAME-java=	gcj-${FULL_PKGVERSION}
PKGNAME-objc=	gobjc-${FULL_PKGVERSION}
SHARED_LIBS=	estdc++		5.7 \
		g2c		0.0 \
		-org-w3c-dom	0.0 \
		-org-xml-sax	0.0 \
		gcj		4.0 \
		objc		1.0 \
		objc_gc		1.0
@


1.12
log
@3.3.6
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2005/09/14 10:41:02 espie Exp $
d15 7
d119 4
a159 3

MAKE_FLAGS=libstdc___la_LDFLAGS='-version-info 31:0:0 -lm'

@


1.11
log
@@@pkgpath annotations to help update
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2005/09/11 07:40:58 espie Exp $
d6 2
a7 2
FULL_VERSION=3.3-20050223
FULL_PKGVERSION=3.3.20050223
d9 6
a14 6
PKGNAME=	gcc-${FULL_PKGVERSION}p0
PKGNAME-c++ =	g++-${FULL_PKGVERSION}p0
PKGNAME-estdc=	libstdc++-${FULL_PKGVERSION}p0
PKGNAME-g77=	g77-${FULL_PKGVERSION}p0
PKGNAME-java=	gcj-${FULL_PKGVERSION}p0
PKGNAME-objc=	gobjc-${FULL_PKGVERSION}p0
d72 1
a72 1
MASTER_SITES=	${MASTER_SITE_GCC:=snapshots/$(FULL_VERSION)/}
@


1.10
log
@fix package names.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2005/09/05 14:55:35 espie Exp $
d8 7
@


1.9
log
@much more restrictive dependencies. For starters, g++-3.3.6 won't find
gcc-3.3.5...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2005/08/24 22:54:42 espie Exp $
d7 1
a59 6
PKGNAME=	gcc-${FULL_VERSION}p0
PKGNAME-c++ =	g++-${FULL_VERSION}p0
PKGNAME-g77=	g77-${FULL_VERSION}p0
PKGNAME-java=	gcj-${FULL_VERSION}p0
PKGNAME-objc=	gobjc-${FULL_VERSION}p0
PKGNAME-ada=	gnat-${FULL_VERSION}p0
d160 1
a160 1
RUN_DEPENDS+=:gcc-${FULL_VERSION}:${PKGPATH}
@


1.8
log
@use a new regen'd ada bootstrap that matches 3.8 libraries.

okay pvalchev@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2005/05/16 11:14:36 espie Exp $
d60 5
d165 1
a165 1
RUN_DEPENDS+=::${PKGPATH}
@


1.7
log
@get PKGNAMEs to bump correctly.
With the recent svscanf change, stdio no longer gets tweaked.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2005/02/28 12:36:13 espie Exp $
d63 1
a63 1
SUPDISTFILES=adastrap-i386-3.3.5-1.tgz:0
d92 1
a92 1
DISTFILES+=adastrap-${MACHINE_ARCH}-3.3.5-1.tgz:0
@


1.6
log
@update DESCR to match current reality.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2005/02/27 15:41:59 espie Exp $
d58 2
a59 2
DISTNAME=   gcc-${FULL_VERSION}
PKGNAME=   gcc-${FULL_VERSION}p0
@


1.5
log
@switch to a more recent snapshot off the 3.3 branch.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2005/02/21 15:44:48 alek Exp $
d59 1
@


1.4
log
@Adjust WANTLIB marker
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2005/01/08 19:18:44 espie Exp $
d5 2
a6 2
V=3.3.5
FULL_VERSION=$V
d64 1
a64 1
MASTER_SITES=	${MASTER_SITE_GCC:=releases/gcc-$(FULL_VERSION)/}
@


1.3
log
@finally works with a `clean' bootstrap archive.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2005/01/05 22:44:10 espie Exp $
a9 3
WANTLIB=c z


d27 4
@


1.2
log
@so ada works, in fact...
need to figure out a simpler bootstrap there...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2005/01/03 15:21:26 espie Exp $
d17 3
a19 1
#MAKE_ADA=Yes
d61 1
d64 1
d90 13
a103 4
CONFIGURE_ENV=ADAC=${LOCALBASE}/bin/egcc GNATBIND=${LOCALBASE}/bin/gnatbind
MAKE_ENV=ADAC=${LOCALBASE}/bin/egcc GNATBIND=${LOCALBASE}/bin/gnatbind
BUILD_DEPENDS+=:gnat-*:lang/gcc/3.3,-ada
#CONFIGURE_ENV=ADAC=${HOME}/bin/adac GNATBIND=${HOME}/x/usr/bin/gnatbind
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2004/11/23 11:25:02 espie Exp $
a24 1

d89 5
a93 2
CC=${LOCALBASE}/bin/egcc
BUILD_DEPENDS+=:gnat-*:lang/egcs/stable,-ada
a95 5

# Note: the configure target passes CFLAGS to the configure script anyways.

CFLAGS=-O2 -g

@


1.1.1.1
log
@somewhat cleaner port of gcc 3.3.x.
not ready yet...
@
text
@@
