head	1.30;
access;
symbols
	OPENBSD_5_3:1.23.0.2
	OPENBSD_5_3_BASE:1.23
	OPENBSD_5_2:1.9.0.2
	OPENBSD_5_2_BASE:1.9
	pascal_20120423:1.1.1.1
	pascal:1.1.1;
locks; strict;
comment	@# @;


1.30
date	2013.06.18.21.06.53;	author espie;	state dead;
branches;
next	1.29;

1.29
date	2013.06.18.20.24.29;	author sthen;	state Exp;
branches;
next	1.28;

1.28
date	2013.06.07.07.54.47;	author pascal;	state Exp;
branches;
next	1.27;

1.27
date	2013.05.03.23.13.49;	author tobiasu;	state Exp;
branches;
next	1.26;

1.26
date	2013.04.04.04.21.14;	author tobiasu;	state Exp;
branches;
next	1.25;

1.25
date	2013.03.21.08.46.32;	author ajacoutot;	state Exp;
branches;
next	1.24;

1.24
date	2013.03.11.11.20.27;	author espie;	state Exp;
branches;
next	1.23;

1.23
date	2013.02.11.14.29.54;	author jasper;	state Exp;
branches;
next	1.22;

1.22
date	2013.02.01.16.34.36;	author naddy;	state Exp;
branches;
next	1.21;

1.21
date	2012.12.28.14.32.01;	author espie;	state Exp;
branches;
next	1.20;

1.20
date	2012.11.06.00.57.43;	author tobiasu;	state Exp;
branches;
next	1.19;

1.19
date	2012.10.07.20.09.45;	author landry;	state Exp;
branches;
next	1.18;

1.18
date	2012.09.28.18.45.42;	author pascal;	state Exp;
branches;
next	1.17;

1.17
date	2012.09.28.15.02.29;	author pascal;	state Exp;
branches;
next	1.16;

1.16
date	2012.09.04.10.11.56;	author pascal;	state Exp;
branches;
next	1.15;

1.15
date	2012.09.03.13.24.58;	author pascal;	state Exp;
branches;
next	1.14;

1.14
date	2012.09.01.00.00.32;	author pascal;	state Exp;
branches;
next	1.13;

1.13
date	2012.08.28.23.39.12;	author sthen;	state Exp;
branches;
next	1.12;

1.12
date	2012.08.27.20.06.16;	author sthen;	state Exp;
branches;
next	1.11;

1.11
date	2012.08.23.19.19.16;	author sthen;	state Exp;
branches;
next	1.10;

1.10
date	2012.08.20.12.35.41;	author pascal;	state Exp;
branches;
next	1.9;

1.9
date	2012.07.15.08.56.26;	author pascal;	state Exp;
branches;
next	1.8;

1.8
date	2012.07.01.18.56.45;	author pascal;	state Exp;
branches;
next	1.7;

1.7
date	2012.06.21.13.56.57;	author sthen;	state Exp;
branches;
next	1.6;

1.6
date	2012.05.07.10.34.33;	author pascal;	state Exp;
branches;
next	1.5;

1.5
date	2012.05.03.11.49.14;	author espie;	state Exp;
branches;
next	1.4;

1.4
date	2012.05.03.11.22.29;	author espie;	state Exp;
branches;
next	1.3;

1.3
date	2012.04.23.21.22.09;	author espie;	state Exp;
branches;
next	1.2;

1.2
date	2012.04.23.16.30.48;	author pascal;	state Exp;
branches;
next	1.1;

1.1
date	2012.04.23.15.56.40;	author pascal;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2012.04.23.15.56.40;	author pascal;	state Exp;
branches;
next	;


desc
@@


1.30
log
@bye bye
@
text
@# $OpenBSD: Makefile,v 1.29 2013/06/18 20:24:29 sthen Exp $

ONLY_FOR_ARCHS = amd64 i386 powerpc sparc64
BROKEN-sparc64 = ICE in libgcc

V = 4.7.3
FULL_VERSION = $V
FULL_PKGVERSION = $V

ADASTRAP_LIBC-i386 = 68.2
ADASTRAP_LIBM-i386 = 8.0
ADASTRAP-i386 = adastrap-i386-$V-0.tar.xz
ADASTRAP_LIBC-amd64 = 67.0
ADASTRAP_LIBM-amd64 = 8.0
ADASTRAP-amd64 = adastrap-amd64-$V-0.tar.xz

PKGNAME-main =  gcc-${FULL_PKGVERSION}
PKGNAME-c++ =   g++-${FULL_PKGVERSION}
PKGNAME-estdc = libstdc++-${FULL_PKGVERSION}
PKGNAME-f95 =   g95-${FULL_PKGVERSION}
# problem in boehm-gc
#PKGNAME-java =  gcj-${FULL_PKGVERSION}
PKGNAME-objc =  gobjc-${FULL_PKGVERSION}
PKGNAME-ada =   gnat-${FULL_PKGVERSION}
# needs [gs]etcontext
#PKGNAME-go =	gccgo-${FULL_PKGVERSION}
PKGSPEC-main = gcc->=4.7,<4.8

REVISION-main = 4
REVISION-c++ = 2
REVISION-estdc = 0
REVISION-f95 = 1
REVISION-objc = 1
REVISION-ada = 3

SHARED_LIBS =	estdc++		15.0 \
		gfortran	4.0 \
		gcj		2.0 \
		gcj-tools	2.0 \
		gij		2.0 \
		objc		4.0 \
		ssp		2.0 \
		lto_plugin      1.0 \
		go		1.0 \
		itm		0.0


PSEUDO_FLAVORS = no_c++ no_f95 no_objc no_java no_ada no_go full
FLAVOR ?= 

ONLY_FOR_ARCHS-ada = i386 amd64
ONLY_FOR_ARCHS-java = amd64 i386 sparc64

MULTI_PACKAGES = -main -f95 -objc -c++ -estdc -ada

MAINTAINER =	Pascal Stumpf <Pascal.Stumpf@@cubes.de>

.include <bsd.port.arch.mk>

# kill both C++ subpackages
.if !${BUILD_PACKAGES:M-c++}
BUILD_PACKAGES := ${BUILD_PACKAGES:N-estdc}
.endif

DISTNAME =   	gcc-${FULL_VERSION}
DISTFILES =	${DISTNAME}.tar.bz2
# there's no ecj-4.7.jar
ECJ =		ecj-4.5.jar
SUPDISTFILES =	${ADASTRAP-i386}:0 ${ADASTRAP-amd64}:0 ${ECJ}:1
EXTRACT_ONLY =	${DISTNAME}.tar.bz2


BUILD_DEPENDS +=	devel/bison \
			devel/libexecinfo

TEST_DEPENDS = 	devel/dejagnu \
			devel/autogen

MASTER_SITES =	${MASTER_SITE_GCC:=releases/gcc-$(FULL_VERSION)/}
MASTER_SITES0 =	http://distfiles.tmux.org/adastrap/
MASTER_SITES1 =	ftp://sources.redhat.com/pub/java/

LANGS = c
.if ${BUILD_PACKAGES:M-c++}
LANGS := ${LANGS},c++
TEST_DEPENDS += 	${BUILD_PKGPATH},-estdc>=4.7,<4.8
.endif
.if ${BUILD_PACKAGES:M-f95}
LANGS := ${LANGS},fortran
.endif
.if ${BUILD_PACKAGES:M-objc}
LANGS := ${LANGS},objc
.endif
.if ${BUILD_PACKAGES:M-java}
LANGS := ${LANGS},java
DISTFILES +=		${ECJ}:1
BUILD_DEPENDS +=	archivers/zip>=2.3p0
CONFIGURE_ARGS +=	--enable-libgcj --without-jar
VMEM_WARNING =		Yes
.endif
.if ${BUILD_PACKAGES:M-ada}
LANGS := ${LANGS},ada
DISTFILES += ${ADASTRAP-${MACHINE_ARCH}}:0
EXTRACT_ONLY += ${ADASTRAP-${MACHINE_ARCH}}
EXTRA_ENV += ADAC=${WRKDIR}/bin/egcc GNATBIND=${WRKDIR}/bin/gnatbind
CC = ${WRKDIR}/bin/egcc
TEST_DEPENDS += ${BUILD_PKGPATH},-ada
.endif
#.if ${BUILD_PACKAGES:M-go}
#LANGS := ${LANGS},go
#.endif

CONFIGURE_STYLE =		gnu
MODGNU_CONFIG_GUESS_DIRS =	${WRKSRC} ${WRKSRC}/gcc

EXTRA_ENV += am_cv_func_iconv=no JAR=no
EXTRA_ENV += ac_cv_prog_M4=/usr/bin/m4
EXTRA_ENV += ac_cv_header_magic_h=no
EXTRA_ENV += lt_cv_path_SED=/usr/bin/sed
EXTRA_ENV += STRIP=/usr/bin/strip
MAKE_FLAGS +=	 ac_cv_path_mkdir=/bin/mkdir

CONFIGURE_ENV += ${EXTRA_ENV}
MAKE_ENV += ${EXTRA_ENV}

# Note: the configure target passes CFLAGS to the configure script anyways.

CFLAGS = -O2 -g

CONFIGURE_ARGS += \
	--verbose \
	--program-transform-name=s,^,e, \
	--disable-nls  \
	--disable-checking \
	--with-system-zlib \
	--disable-libmudflap \
	--disable-libgomp \
	--disable-tls \
	--with-as=/usr/bin/as \
	--with-ld=/usr/bin/ld \
	--with-gnu-ld \
	--with-gnu-as \
	--enable-threads=posix \
	--enable-wchar_t \
	--with-gmp="${LOCALBASE}" \
	--disable-libstdcxx-pch \
	--enable-languages=${LANGS}

# This is needed, as internal cpp is no longer compatible with the
# visible beast
CONFIGURE_ARGS += --enable-cpp

CONFIGURE_ARGS += ${CONFIGURE_SHARED}

SEPARATE_BUILD = flavored

USE_GMAKE = yes

.if ${FLAVOR:Mfull}
# you shouldn't skip bootstrap unless you know what you're doing
# use bootstrap-lean if you're pressed for space
ALL_TARGET = bootstrap
.else
# skip the stage2/stage3 bullshit under normal circumstances
ALL_TARGET = bootstrap2
.endif

MAKE_FLAGS += libstdc___la_LDFLAGS='-version-info 31:0:0 -lm'

.if ${MACHINE_ARCH} == "sparc"  || ${MACHINE_ARCH} == "amd64"
PIC = 1
PKG_ARGS += -DPIC=1
.else
PIC = 0
PKG_ARGS += -DPIC=0
.endif

.if ${MACHINE_ARCH} == "powerpc"
PKG_ARGS += -DPPC=1
.else
PKG_ARGS += -DPPC=0
.endif

.if ${MACHINE_ARCH} == "i386" || ${MACHINE_ARCH} == "amd64"
PKG_ARGS += -DI386=1
.else
PKG_ARGS += -DI386=0
.endif

RUN_DEPENDS =		${BUILD_PKGPATH},-main
WANTLIB =		c gmp m mpc mpfr z

RUN_DEPENDS-main =
RUN_DEPENDS-estdc =

RUN_DEPENDS-c++ =	${RUN_DEPENDS} \
			${BUILD_PKGPATH},-estdc>=4.7,<4.8
RUN_DEPENDS-ada =	${FULLPKGNAME-main}:${BUILD_PKGPATH}
WANTLIB-estdc =		m
WANTLIB-java =		${WANTLIB} pthread
WANTLIB-main =		${WANTLIB} pthread

LIB_DEPENDS +=		devel/gmp>=4.2 \
			devel/mpfr \
			devel/libmpc
LIB_DEPENDS-estdc =

.if ${MACHINE_ARCH:Mamd64}
CONFIG = x86_64-unknown-openbsd${OSREV}
.endif

post-extract:
.for f in egcc gnatbind gnatmake gnatlink
	echo "#! /bin/sh" >${WRKDIR}/bin/$f
	echo 'GNAT_ROOT=${WRKDIR}/bootstrap GCC_ROOT=${WRKDIR}/bootstrap LD_LIBRARY_PATH=${WRKDIR}/bootstrap/system-libs exec ${WRKDIR}/bootstrap/bin/$f "$$@@"' >>${WRKDIR}/bin/$f
	chmod a+x ${WRKDIR}/bin/$f
.endfor
	ln -sf /usr/bin/nm ${WRKDIR}/bin/enm
	echo "# This file automatically generated" >> ${WRKSRC}/libversions
.for l v in ${SHARED_LIBS}
	echo "LIB$l_LTVERSION = -version-info ${v:S/./:/}" >> \
		${WRKSRC}/libversions
.endfor
.if ${BUILD_PACKAGES:M-java}
	cp ${FULLDISTDIR}/${ECJ} ${WRKSRC}/ecj.jar
.endif

post-install:
.if ${BUILD_PACKAGES:M-ada}
	chown -R ${SHAREOWN}:${SHAREGRP} ${PREFIX}/lib/gcc/*/$V/adainclude
	chown -R ${SHAREOWN}:${SHAREGRP} ${PREFIX}/lib/gcc/*/$V/adalib
.endif
	chown -R ${SHAREOWN}:${SHAREGRP} ${PREFIX}/lib/gcc/*/$V/include
	chown -R ${SHAREOWN}:${SHAREGRP} ${PREFIX}/lib/gcc/*/$V/include-fixed
	chown ${BINOWN}:${BINGRP} ${PREFIX}/lib/gcc/${CONFIG}/${V}/libgcc.a
	chown ${BINOWN}:${BINGRP} ${PREFIX}/lib/gcc/${CONFIG}/${V}/libgcov.a
.if ${PIC} == "1"
	chown ${BINOWN}:${BINGRP} ${PREFIX}/lib/gcc/${CONFIG}/${V}/fpic/libgcc.a
	chown ${BINOWN}:${BINGRP} \
		${PREFIX}/lib/gcc/${CONFIG}/${V}/fpic/libgcov.a
.endif

.include <bsd.port.mk>

ADA_PACKAGE = ${PACKAGE_REPOSITORY}/${MACHINE_ARCH}/all/${FULLPKGNAME-ada}.tgz
GCC_PACKAGE = ${PACKAGE_REPOSITORY}/${MACHINE_ARCH}/all/${FULLPKGNAME-main}.tgz

adastrap: ${ADA_PACKAGE} ${GCC_PACKAGE}
.if !defined(ADASTRAP_LIBC-${MACHINE_ARCH}) || \
	!defined(ADASTRAP_LIBM-${MACHINE_ARCH})
	@@echo 1>&2 "Error: you must specify libc and libm to bundle"
	@@exit 1
.else
	mkdir -p ${WRKDIR}/prepare/bootstrap/system-libs
	cp /usr/lib/libc.so.${ADASTRAP_LIBC-${MACHINE_ARCH}} \
		${WRKDIR}/prepare/bootstrap/system-libs
	cp /usr/lib/libm.so.${ADASTRAP_LIBM-${MACHINE_ARCH}} \
		${WRKDIR}/prepare/bootstrap/system-libs
	cd ${WRKDIR}/prepare/bootstrap && tar zxf ${ADA_PACKAGE}
	cd ${WRKDIR}/prepare/bootstrap && tar zxf ${GCC_PACKAGE}
	rm -rf ${WRKDIR}/prepare/bootstrap/{+*,info,man}
	if ! ldd ${WRKDIR}/prepare/bootstrap/bin/egcc | \
		fgrep libc.so.${ADASTRAP_LIBC-${MACHINE_ARCH}} >/dev/null; then \
		echo 1>&2 "Error: adastrap egcc linked against unbundled libc"; \
		exit 1; \
	fi
	if ! ldd ${WRKDIR}/prepare/bootstrap/bin/egcc | \
		fgrep libm.so.${ADASTRAP_LIBM-${MACHINE_ARCH}} >/dev/null; then \
		echo 1>&2 "Error: adastrap egcc linked against unbundled libm"; \
		exit 1; \
	fi
	cd ${WRKDIR}/prepare && tar cf - bootstrap | \
		xz > ${FULLDISTDIR}/${ADASTRAP-${MACHINE_ARCH}}
.endif

@


1.29
log
@regen PLIST to unbreak following kerberosV update; com_err.h no longer
needs to be "fixed."  ok pascal@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2013/06/07 07:54:47 pascal Exp $
@


1.28
log
@Update to GCC 4.7.3.  Also tested by tobiasu@@.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2013/05/03 23:13:49 tobiasu Exp $
d29 1
a29 1
REVISION-main = 3
@


1.27
log
@Sync 4.8 changes to 4.7 and 4.6

- Absolute path for STRIP
- Enable ncpu detection in gnatlib
- Force sequential "make install" target
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2013/04/04 04:21:14 tobiasu Exp $
d6 1
a6 1
V = 4.7.2
d10 1
a10 1
ADASTRAP_LIBC-i386 = 67.0
d12 1
a12 1
ADASTRAP-i386 = adastrap-i386-$V-1.tar.xz
d15 1
a15 1
ADASTRAP-amd64 = adastrap-amd64-$V-1.tar.xz
@


1.26
log
@Update adastrap tarball due to libm major bump. Bundle libm with adastrap
as we do for libc since it's cheap to do and can save us some work in the
future.

ok pascal@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2013/03/21 08:46:32 ajacoutot Exp $
d34 1
a34 1
REVISION-ada = 2
d120 1
@


1.25
log
@USE_LIBTOOL=Yes is the default now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2013/03/11 11:20:27 espie Exp $
d10 6
a15 4
ADASTRAP_LIBC-i386 = 63.0
ADASTRAP-i386 = adastrap-i386-$V-0.tar.xz
ADASTRAP_LIBC-amd64 = 66.0
ADASTRAP-amd64 = adastrap-amd64-$V-0.tar.xz
d248 3
a250 2
.if !defined(ADASTRAP_LIBC-${MACHINE_ARCH})
	@@echo 1>&2 "Error: you must specify a libc to bundle"
d256 2
d263 6
a268 1
		echo 1>&2 "Error: adastrap egcc linked against wrong libc"; \
@


1.24
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2013/02/11 14:29:54 jasper Exp $
a69 1
USE_LIBTOOL =	Yes
@


1.23
log
@move two files from -main to -c++ to fix a conflict between gcc version.
the conflict was already marked, but these two files were in the wrong PLIST.

ok pascal@@ (MAINTAINER) sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2013/02/01 16:34:36 naddy Exp $
d75 1
a75 1
REGRESS_DEPENDS = 	devel/dejagnu \
d85 1
a85 1
REGRESS_DEPENDS += 	${BUILD_PKGPATH},-estdc>=4.7,<4.8
d106 1
a106 1
REGRESS_DEPENDS += ${BUILD_PKGPATH},-ada
@


1.22
log
@bump for plist changes 5.2 -> 5.3
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2012/12/28 14:32:01 espie Exp $
d27 2
a28 2
REVISION-main = 2
REVISION-c++ = 1
@


1.21
log
@a little overkill on autoconf override magic...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2012/11/06 00:57:43 tobiasu Exp $
d27 2
a28 2
REVISION-main = 1
REVISION-c++ = 0
d30 3
a32 3
REVISION-f95 = 0
REVISION-objc = 0
REVISION-ada = 1
@


1.20
log
@Add Ada support on amd64 and sparc64

Also unbreak and improve adastrap generation
Cleanup bootstrap libc handling

ok pascal@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2012/10/07 20:09:45 landry Exp $
d118 1
@


1.19
log
@Sync the config/openbsd.h and config/sparc/openbsd64.h patches with
respectively r1.9 and r1.6 of base gcc ones adding #define
NO_IMPLICIT_EXTERN_C. While here add the missing #define
NO_UNSAFE_BUILTINS to gfortran/gcc 4.2, Bump all REVISIONs.
ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2012/09/28 18:45:42 pascal Exp $
d9 5
a13 3
BOOTSTRAP_GEN = 0
LIBC_VERSION = 63.0
ADASTRAP = adastrap-i386-$V-${BOOTSTRAP_GEN}.tar.xz
d27 1
a27 1
REVISION-main = 0
d32 1
a32 1
REVISION-ada = 0
d49 1
a49 1
ONLY_FOR_ARCHS-ada = i386
d67 1
a67 1
SUPDISTFILES =	${ADASTRAP}:0 ${ECJ}:1
d102 2
a103 2
DISTFILES += ${ADASTRAP}:0
EXTRACT_ONLY += ${ADASTRAP}
d195 1
a220 5
.if ${BUILD_PACKAGES:M-ada}
	# XXX cheat a bit
	cd ${WRKDIR}/bootstrap/system-libs && ln -sf libc.so.${LIBC_VERSION} libc.so.61.0
	${WRKDIR}/bin/egcc -v # if this fails, you must extract suitable libraries from the relevant OpenBSD release or use the no_ada FLAVOR.
.endif
d242 2
a243 2
ADA_PACKAGE = ${PACKAGE_REPOSITORY}/i386/all/${PKGNAME-ada}.tgz
GCC_PACKAGE = ${PACKAGE_REPOSITORY}/i386/all/${PKGNAME-main}.tgz
d246 1
a246 1
.if !defined(LIBC_VERSION)
d251 2
a252 1
	cp /usr/lib/libc.so.${LIBC_VERSION} ${WRKDIR}/prepare/bootstrap/system-libs
d256 5
d262 1
a262 1
		xz > ${FULLDISTDIR}/${ADASTRAP}
@


1.18
log
@Bugfix update to 4.7.2.  Also, remove sparc from ONLY_FOR_ARCHS and put myself
as MAINTAINER.

no objection from espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2012/09/04 10:11:56 pascal Exp $
d24 7
@


1.17
log
@Unify MASTER_SITES for adastrap; they're now all hosted by Tobias Ulmer on
tmux.org.  Makes gnat bootstrapping work a little easier for him.
@
text
@d3 1
a3 1
ONLY_FOR_ARCHS = amd64 i386 powerpc sparc sparc64
d6 1
a6 1
V = 4.7.1
a24 7
REVISION-main =	4
REVISION-c++ =	4
REVISION-estdc = 3
REVISION-f95 =	4
REVISION-objc = 4
REVISION-ada =	4

d44 2
@


1.16
log
@adapt a sparc64 patch; still not enough because it decides to segfault in
libgcc.

found by landry@@ in a bulk.  fuck gcc.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2012/09/03 13:24:58 pascal Exp $
d75 1
a75 3
#MASTER_SITES0 = http://spacehopper.org/mirrors/
#MASTER_SITES0 = ftp://quatramaran.ens.fr/pub/espie/
MASTER_SITES0 =	http://distfiles.bsdfrog.org/
@


1.15
log
@Make gcc 4.[67] use __guard_local instead of __guard.  From Brad.

ok matthew@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2012/09/01 00:00:32 pascal Exp $
d4 1
@


1.14
log
@Patch GCC and derived ports to use PIE by default on the same architectures it
is enabled on in base; except for gcc 3.3, which does not have PIE support and
therefore needs to pass -nopie to the linker.

Also, sync powerpc pthread specs with base.  From Brad.

ok naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2012/08/28 23:39:12 sthen Exp $
d24 2
a25 2
REVISION-main =	3
REVISION-c++ =	3
d27 3
a29 3
REVISION-f95 =	3
REVISION-objc = 3
REVISION-ada =	3
@


1.13
log
@sync OBSD_LIB_SPEC in the ports tree compilers with the updated one
in base; from Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2012/08/27 20:06:16 sthen Exp $
d24 2
a25 2
REVISION-main =	2
REVISION-c++ =	2
d27 3
a29 3
REVISION-f95 =	2
REVISION-objc = 2
REVISION-ada =	2
d140 1
@


1.12
log
@oops, lost "m" in WANTLIB-estdc in wantlib sync commit; fix and bump REVISION.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2012/08/23 19:19:16 sthen Exp $
d24 6
a29 2
REVISION =	1
REVISION-estdc = 2
d191 1
a191 1
WANTLIB-estdc =		c m
@


1.11
log
@sync wantlib
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2012/08/20 12:35:41 pascal Exp $
d25 1
d187 1
a187 1
WANTLIB-estdc =		c
@


1.10
log
@Sync -pthread semantics with base gcc.  From Brad.

ok matthew@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2012/07/15 08:56:26 pascal Exp $
d24 1
a24 6
REVISION-main =	0
REVISION-c++ =	0
REVISION-estdc = 0
REVISION-f95 =	0
REVISION-objc = 0
REVISION-ada =	0
d179 1
a179 1
WANTLIB =		c gmp mpc mpfr z
d186 3
a188 4
WANTLIB-estdc =		m
WANTLIB-f95 =		${WANTLIB} m
WANTLIB-java =		${WANTLIB} m pthread
WANTLIB-go =		${WANTLIB} m
@


1.9
log
@Disable -java until I get around to fixing it.

ok espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2012/07/01 18:56:45 pascal Exp $
d23 7
@


1.8
log
@Update to gcc 4.7.1.

- add some fixes for hppa, though it still isn't ready for prime time yet.
  Chances are it will only work with -O1, pending testing.  Many optimisations
  lead to broken code and segfaults on hppa.  Joint work with jsg@@.
- fix libstdc++ upgrade path
- bring in recent fixes for execinfo/magic.h from 4.6

ok espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2012/06/21 13:56:57 sthen Exp $
d16 2
a17 1
PKGNAME-java =  gcj-${FULL_PKGVERSION}
d42 1
a42 1
MULTI_PACKAGES = -main -f95 -objc -java -c++ -estdc -ada
@


1.7
log
@bump for plist changes 5.1 -> 5.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2012/05/07 10:34:33 pascal Exp $
d3 1
a3 1
ONLY_FOR_ARCHS = amd64 i386 hppa powerpc sparc sparc64
d5 1
a5 1
V = 4.7.0
a20 3
REVISION = 1
REVISION-c++ = 2
REVISION-java = 3
d59 2
a60 1
BUILD_DEPENDS +=	devel/bison
d106 1
@


1.6
log
@Don't hardcode GC_nprocs to 1 in boehm-gc, but get it from sysconf instead,
following a similar change in devel/boehm-gc.
From Brad.

ok kurt@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2012/05/03 11:49:14 espie Exp $
d21 3
a23 3
REVISION = 0
REVISION-c++ = 1
REVISION-java = 2
@


1.5
log
@g++ 4.7 doesn't really work with gcc 3.3.6, since it won't find -lgcc
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2012/05/03 11:22:29 espie Exp $
d23 1
a23 1
REVISION-java = 1
@


1.4
log
@give C++ a chance to work...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2012/04/23 21:22:09 espie Exp $
d21 4
a24 2
REVISION-c++ = 0
REVISION-java = 0
@


1.3
log
@well, void distfile names are a bad idea.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2012/04/23 16:30:48 pascal Exp $
d21 2
@


1.2
log
@aja is mirroring adastrap; thanks!
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2012/04/23 15:56:40 pascal Exp $
d10 1
a10 1
#ADASTRAP = adastrap-i386-$V-${BOOTSTRAP_GEN}.tar.xz
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2012/04/02 08:51:30 pascal Exp $
d64 1
a64 1
MASTER_SITES0 =	http://spacehopper.org/mirrors/
d66 1
@


1.1.1.1
log
@Import gcc 4.7.

ok espie@@
@
text
@@
