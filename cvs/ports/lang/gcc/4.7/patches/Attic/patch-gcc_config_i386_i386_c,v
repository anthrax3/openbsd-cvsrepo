head	1.5;
access;
symbols
	OPENBSD_5_3:1.3.0.2
	OPENBSD_5_3_BASE:1.3
	OPENBSD_5_2:1.2.0.2
	OPENBSD_5_2_BASE:1.2
	pascal_20120423:1.1.1.1
	pascal:1.1.1;
locks; strict;
comment	@# @;


1.5
date	2013.06.18.21.06.53;	author espie;	state dead;
branches;
next	1.4;

1.4
date	2013.06.07.07.54.47;	author pascal;	state Exp;
branches;
next	1.3;

1.3
date	2012.09.28.18.45.42;	author pascal;	state Exp;
branches;
next	1.2;

1.2
date	2012.07.01.18.56.45;	author pascal;	state Exp;
branches;
next	1.1;

1.1
date	2012.04.23.15.56.42;	author pascal;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2012.04.23.15.56.42;	author pascal;	state Exp;
branches;
next	;


desc
@@


1.5
log
@bye bye
@
text
@$OpenBSD: patch-gcc_config_i386_i386_c,v 1.4 2013/06/07 07:54:47 pascal Exp $
--- gcc/config/i386/i386.c.orig	Tue Apr  2 18:54:39 2013
+++ gcc/config/i386/i386.c	Thu Apr 11 13:44:27 2013
@@@@ -2414,6 +2414,8 @@@@ struct ix86_frame
   HOST_WIDE_INT reg_save_offset;
   HOST_WIDE_INT sse_reg_save_offset;
 
+  HOST_WIDE_INT local_size;
+
   /* When save_regs_using_mov is set, emit prologue using
      move instead of push instructions.  */
   bool save_regs_using_mov;
@@@@ -8844,6 +8846,7 @@@@ ix86_compute_frame_layout (struct ix86_frame *frame)
   HOST_WIDE_INT size = get_frame_size ();
   HOST_WIDE_INT to_allocate;
 
+  frame->local_size = size;
   frame->nregs = ix86_nsaved_regs ();
   frame->nsseregs = ix86_nsaved_sseregs ();
 
@@@@ -10189,6 +10192,9 @@@@ ix86_expand_prologue (void)
       m->fs.sp_offset = INCOMING_FRAME_SP_OFFSET;
       m->fs.realigned = true;
     }
+
+  if (warn_stack_larger_than && frame.local_size > stack_larger_than_size)
+    warning (OPT_Wstack_larger_than_, "stack usage is %d bytes", frame.local_size);
 
   int_registers_saved = (frame.nregs == 0);
   sse_registers_saved = (frame.nsseregs == 0);
@


1.4
log
@Update to GCC 4.7.3.  Also tested by tobiasu@@.
@
text
@d1 1
a1 1
$OpenBSD: patch-gcc_config_i386_i386_c,v 1.3 2012/09/28 18:45:42 pascal Exp $
@


1.3
log
@Bugfix update to 4.7.2.  Also, remove sparc from ONLY_FOR_ARCHS and put myself
as MAINTAINER.

no objection from espie@@
@
text
@d1 3
a3 3
$OpenBSD: patch-gcc_config_i386_i386_c,v 1.2 2012/07/01 18:56:45 pascal Exp $
--- gcc/config/i386/i386.c.orig	Thu Sep 13 19:32:23 2012
+++ gcc/config/i386/i386.c	Mon Sep 24 16:32:08 2012
d13 1
a13 1
@@@@ -8832,6 +8834,7 @@@@ ix86_compute_frame_layout (struct ix86_frame *frame)
d21 1
a21 1
@@@@ -10168,6 +10171,9 @@@@ ix86_expand_prologue (void)
@


1.2
log
@Update to gcc 4.7.1.

- add some fixes for hppa, though it still isn't ready for prime time yet.
  Chances are it will only work with -O1, pending testing.  Many optimisations
  lead to broken code and segfaults on hppa.  Joint work with jsg@@.
- fix libstdc++ upgrade path
- bring in recent fixes for execinfo/magic.h from 4.6

ok espie@@
@
text
@d1 3
a3 3
$OpenBSD: patch-gcc_config_i386_i386_c,v 1.1.1.1 2012/04/23 15:56:42 pascal Exp $
--- gcc/config/i386/i386.c.orig	Fri May 25 15:34:07 2012
+++ gcc/config/i386/i386.c	Wed Jun 20 14:39:11 2012
d13 1
a13 1
@@@@ -8820,6 +8822,7 @@@@ ix86_compute_frame_layout (struct ix86_frame *frame)
d21 1
a21 1
@@@@ -10147,6 +10150,9 @@@@ ix86_expand_prologue (void)
d29 2
a30 2
   if (frame_pointer_needed && !m->fs.fp_valid)
     {
@


1.1
log
@Initial revision
@
text
@d1 4
a4 4
$OpenBSD: patch-gcc_config_i386_i386_c,v 1.1 2012/03/31 20:02:03 pascal Exp $
--- gcc/config/i386/i386.c.orig	Tue Feb 28 16:28:32 2012
+++ gcc/config/i386/i386.c	Mon Apr  2 16:38:17 2012
@@@@ -2413,6 +2413,8 @@@@ struct ix86_frame
d13 1
a13 1
@@@@ -8825,6 +8827,7 @@@@ ix86_compute_frame_layout (struct ix86_frame *frame)
d21 1
a21 1
@@@@ -10152,6 +10155,9 @@@@ ix86_expand_prologue (void)
@


1.1.1.1
log
@Import gcc 4.7.

ok espie@@
@
text
@@
