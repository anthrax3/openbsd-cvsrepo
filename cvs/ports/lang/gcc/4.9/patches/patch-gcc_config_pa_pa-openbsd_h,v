head	1.2;
access;
symbols
	OPENBSD_6_0:1.2.0.2
	OPENBSD_6_0_BASE:1.2
	OPENBSD_5_9:1.1.0.4
	OPENBSD_5_9_BASE:1.1
	OPENBSD_5_8:1.1.0.6
	OPENBSD_5_8_BASE:1.1
	OPENBSD_5_7:1.1.0.2
	OPENBSD_5_7_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2016.07.14.07.22.31;	author tobiasu;	state Exp;
branches;
next	1.1;
commitid	tJZesWLhyP8qZcZs;

1.1
date	2015.02.03.20.32.12;	author pascal;	state Exp;
branches;
next	;
commitid	LzgH25QAJKFopjkX;


desc
@@


1.2
log
@Sync startfile spec, fixes egcc -static to link against rcrt0

ok stefan@@ pascal@@ naddy@@
@
text
@$OpenBSD: patch-gcc_config_pa_pa-openbsd_h,v 1.1 2015/02/03 20:32:12 pascal Exp $
--- gcc/config/pa/pa-openbsd.h.orig	Thu Jan  2 23:23:26 2014
+++ gcc/config/pa/pa-openbsd.h	Sat Jul  9 22:26:21 2016
@@@@ -138,14 +138,15 @@@@ along with GCC; see the file COPYING3.  If not see
    %{shared:-shared} %{R*} \
    %{static:-Bstatic} \
    %{!static:-Bdynamic} \
+   %{rdynamic:-export-dynamic} \
    %{assert*} \
    -dynamic-linker /usr/libexec/ld.so"
 
 #undef STARTFILE_SPEC
 #define STARTFILE_SPEC "\
-	%{!shared: %{pg:gcrt0%O%s} %{!pg:%{p:gcrt0%O%s} %{!p:crt0%O%s}} \
-	crtbegin%O%s} %{shared:crtbeginS%O%s}"
-
+	%{!shared: %{pg:gcrt0%O%s} %{!pg:%{p:gcrt0%O%s} \
+	%{!p:%{!static:crt0%O%s} %{static:%{nopie:crt0%O%s} \
+	%{!nopie:rcrt0%O%s}}}} crtbegin%O%s} %{shared:crtbeginS%O%s}"
 #undef ENDFILE_SPEC
 #define ENDFILE_SPEC "%{!shared:crtend%O%s} %{shared:crtendS%O%s}"
 
@


1.1
log
@Finally fix newer GCC on hppa by removing --disable-checking from
CONFIGURE_ARGS.  While it may have had some value in the past, nowadays it's
just another (essentially untested) deviation from the mainstream.

Also:
* Restore -fstrict-aliasing and -fstrict-overflow behaviour
* Support -rdynamic on hppa
* libatomic is actually supported on every POSIX system, so remove useless
  PFRAGs.

Tested on amd64, hppa and sparc64; ok tobiasu@@
@
text
@d1 4
a4 4
$OpenBSD$
--- gcc/config/pa/pa-openbsd.h.orig	Mon Feb  2 09:25:56 2015
+++ gcc/config/pa/pa-openbsd.h	Mon Feb  2 09:26:04 2015
@@@@ -138,6 +138,7 @@@@ along with GCC; see the file COPYING3.  If not see
d11 11
@

