head	1.1;
access;
symbols
	OPENBSD_6_1:1.1.0.10
	OPENBSD_6_1_BASE:1.1
	OPENBSD_6_0:1.1.0.8
	OPENBSD_6_0_BASE:1.1
	OPENBSD_5_9:1.1.0.4
	OPENBSD_5_9_BASE:1.1
	OPENBSD_5_8:1.1.0.6
	OPENBSD_5_8_BASE:1.1
	OPENBSD_5_7:1.1.0.2
	OPENBSD_5_7_BASE:1.1;
locks; strict;
comment	@# @;


1.1
date	2015.02.17.12.04.44;	author tobiasu;	state Exp;
branches;
next	;
commitid	uFB3s9SV6geLLhES;


desc
@@


1.1
log
@Add memcpy() workaround and reenable Ada support
Rename all egnat* binaries back to gnat*, sync with 4.8
Add hppa Ada support
Delete debug patch for a linker issue solved some time ago

funktioniert pascal@@
@
text
@$OpenBSD: patch-gcc_ada_osint_adb,v 1.1 2015/01/08 20:23:21 pascal Exp $

GNAT tools try to guess the name of the gcc binary by looking at their
own prefix and suffix. Subsequently they're trying to compile code using
the base gcc if argv[0] does't start with "e".
This hack to their name-guessing hack fixes the problem while touching the
least amount of files.

--- gcc/ada/osint.adb.orig	Tue Feb 25 16:02:01 2014
+++ gcc/ada/osint.adb	Sat Feb 14 18:33:49 2015
@@@@ -2272,6 +2272,13 @@@@ package body Osint is
          Start_Of_Suffix := End_Of_Prefix + Prog'Length + 1;
       end if;
 
+      if Nam = "gcc" and then
+         Name_Buffer (Start_Of_Prefix .. End_Of_Prefix) = "" and then
+         Name_Buffer (Start_Of_Suffix .. Name_Len) = ""
+      then
+         return new String'("egcc");
+      end if;
+
       --  Create the new program name
 
       return new String'
@
