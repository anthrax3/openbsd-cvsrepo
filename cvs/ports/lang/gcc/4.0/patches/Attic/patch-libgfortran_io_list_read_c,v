head	1.4;
access;
symbols
	OPENBSD_5_1_BASE:1.3
	OPENBSD_5_1:1.3.0.26
	OPENBSD_5_0:1.3.0.24
	OPENBSD_5_0_BASE:1.3
	OPENBSD_4_9:1.3.0.22
	OPENBSD_4_9_BASE:1.3
	OPENBSD_4_8:1.3.0.20
	OPENBSD_4_8_BASE:1.3
	OPENBSD_4_7:1.3.0.18
	OPENBSD_4_7_BASE:1.3
	OPENBSD_4_6:1.3.0.16
	OPENBSD_4_6_BASE:1.3
	OPENBSD_4_5:1.3.0.14
	OPENBSD_4_5_BASE:1.3
	OPENBSD_4_4:1.3.0.12
	OPENBSD_4_4_BASE:1.3
	OPENBSD_4_3:1.3.0.10
	OPENBSD_4_3_BASE:1.3
	OPENBSD_4_2:1.3.0.8
	OPENBSD_4_2_BASE:1.3
	OPENBSD_4_1:1.3.0.6
	OPENBSD_4_1_BASE:1.3
	OPENBSD_4_0:1.3.0.4
	OPENBSD_4_0_BASE:1.3
	OPENBSD_3_9:1.3.0.2
	OPENBSD_3_9_BASE:1.3
	OPENBSD_3_8:1.1.0.2
	OPENBSD_3_8_BASE:1.1;
locks; strict;
comment	@# @;


1.4
date	2012.04.23.15.17.56;	author pascal;	state dead;
branches;
next	1.3;

1.3
date	2006.01.09.15.31.47;	author espie;	state Exp;
branches;
next	1.2;

1.2
date	2005.10.20.23.28.02;	author espie;	state Exp;
branches;
next	1.1;

1.1
date	2005.06.16.18.04.41;	author espie;	state Exp;
branches;
next	;


desc
@@


1.4
log
@tedu old versions of gcc

ok kurt@@ espie@@ sthen@@
@
text
@$OpenBSD: patch-libgfortran_io_list_read_c,v 1.3 2006/01/09 15:31:47 espie Exp $
--- libgfortran/io/list_read.c.orig	Sat Nov 12 23:22:53 2005
+++ libgfortran/io/list_read.c	Mon Jan  9 13:36:29 2006
@@@@ -1666,8 +1666,8 @@@@ nml_touch_nodes (namelist_info * nl)
   index_type len = strlen (nl->var_name) + 1;
   int dim;
   char * ext_name = (char*)get_mem (len + 1);
-  strcpy (ext_name, nl->var_name);
-  strcat (ext_name, "%");
+  strlcpy (ext_name, nl->var_name, len + 1);
+  strlcat (ext_name, "%", len + 1);
   for (nl = nl->next; nl; nl = nl->next)
     {
       if (strncmp (nl->var_name, ext_name, len) == 0)
@@@@ -1910,8 +1910,8 @@@@ nml_read_obj (namelist_info * nl, index_
 	  case GFC_DTYPE_DERIVED:
 	    obj_name_len = strlen (nl->var_name) + 1;
 	    obj_name = get_mem (obj_name_len+1);
-	    strcpy (obj_name, nl->var_name);
-	    strcat (obj_name, "%");
+	    strlcpy (obj_name, nl->var_name, obj_name_len+1);
+	    strlcat (obj_name, "%", obj_name_len+1);
 
 	    /* Now loop over the components. Update the component pointer
 	       with the return value from nml_write_obj.  This loop jumps
@@@@ -2118,11 +2118,11 @@@@ get_name:
 
   if (component_flag)
     {
-      ext_name = (char*)get_mem (strlen (root_nl->var_name)
-				  + (saved_string ? strlen (saved_string) : 0)
-				  + 1);
-      strcpy (ext_name, root_nl->var_name);
-      strcat (ext_name, saved_string);
+      index_type ext_name_len = strlen (root_nl->var_name) + 
+      		(saved_string ? strlen (saved_string) : 0) + 1;
+      ext_name = (char*)get_mem (ext_name_len);
+      strlcpy (ext_name, root_nl->var_name, ext_name_len);
+      strlcat (ext_name, saved_string, ext_name_len);
       nl = find_nml_node (ext_name);
       free_mem (ext_name);
     }
@


1.3
log
@newer snapshot, and enough for SHARED_LIBS...
@
text
@d1 1
a1 1
$OpenBSD: patch-libgfortran_io_list_read_c,v 1.2 2005/10/20 23:28:02 espie Exp $
@


1.2
log
@Update to more recent snapshot
@
text
@d1 4
a4 4
$OpenBSD: patch-libgfortran_io_list_read_c,v 1.1 2005/06/16 18:04:41 espie Exp $
--- libgfortran/io/list_read.c.orig	Mon Sep  5 23:14:36 2005
+++ libgfortran/io/list_read.c	Tue Oct  4 02:01:18 2005
@@@@ -1665,8 +1665,8 @@@@ nml_touch_nodes (namelist_info * nl)
d15 1
a15 1
@@@@ -1909,8 +1909,8 @@@@ nml_read_obj (namelist_info * nl, index_
d26 1
a26 1
@@@@ -2117,11 +2117,11 @@@@ get_name:
@


1.1
log
@zap strcpy/strcat/sprintf in gfortran.
@
text
@d1 4
a4 4
$OpenBSD$
--- libgfortran/io/list_read.c.orig	Thu Jun 16 19:20:22 2005
+++ libgfortran/io/list_read.c	Thu Jun 16 19:22:37 2005
@@@@ -1656,8 +1656,8 @@@@ nml_touch_nodes (namelist_info * nl)
d15 1
a15 1
@@@@ -1900,8 +1900,8 @@@@ nml_read_obj (namelist_info * nl, index_
d26 1
a26 1
@@@@ -2108,11 +2108,11 @@@@ get_name:
@

