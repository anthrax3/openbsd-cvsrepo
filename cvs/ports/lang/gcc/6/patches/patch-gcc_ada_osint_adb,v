head	1.1;
branch	1.1.1;
access;
symbols
	OPENBSD_6_2:1.1.1.1.0.4
	OPENBSD_6_2_BASE:1.1.1.1
	OPENBSD_6_1:1.1.1.1.0.2
	OPENBSD_6_1_BASE:1.1.1.1
	pascal_20160904:1.1.1.1
	pascal:1.1.1;
locks; strict;
comment	@# @;


1.1
date	2016.09.04.16.20.15;	author pascal;	state Exp;
branches
	1.1.1.1;
next	;
commitid	kt4pzu6QIrUczPNq;

1.1.1.1
date	2016.09.04.16.20.15;	author pascal;	state Exp;
branches;
next	;
commitid	kt4pzu6QIrUczPNq;


desc
@@



1.1
log
@Initial revision
@
text
@$OpenBSD: patch-gcc_ada_osint_adb,v 1.1 2015/02/17 12:04:44 tobiasu Exp $

GNAT tools try to guess the name of the gcc binary by looking at their
own prefix and suffix. Subsequently they're trying to compile code using
the base gcc if argv[0] does't start with "e".
This hack to their name-guessing hack fixes the problem while touching the
least amount of files.

--- gcc/ada/osint.adb.orig	Mon Nov 30 12:59:09 2015
+++ gcc/ada/osint.adb	Tue Aug 23 15:48:15 2016
@@@@ -2262,6 +2262,13 @@@@ package body Osint is
          Start_Of_Suffix := End_Of_Prefix + Prog'Length + 1;
       end if;
 
+      if Nam = "gcc" and then
+         Name_Buffer (Start_Of_Prefix .. End_Of_Prefix) = "" and then
+         Name_Buffer (Start_Of_Suffix .. Name_Len) = ""
+      then
+         return new String'("egcc");
+      end if;
+
       --  Create the new program name
 
       return new String'
@


1.1.1.1
log
@Import GCC 6.2.0.

ok espie@@
@
text
@@
