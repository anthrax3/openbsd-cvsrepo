head	1.4;
access;
symbols
	OPENBSD_5_3:1.2.0.6
	OPENBSD_5_3_BASE:1.2
	OPENBSD_5_2:1.2.0.4
	OPENBSD_5_2_BASE:1.2
	OPENBSD_5_1_BASE:1.2
	OPENBSD_5_1:1.2.0.2
	fgsch_20110920:1.1.1.1
	fgsch:1.1.1;
locks; strict;
comment	@# @;


1.4
date	2013.04.28.00.55.26;	author fgsch;	state dead;
branches;
next	1.3;

1.3
date	2013.03.31.21.35.26;	author bcallah;	state Exp;
branches;
next	1.2;

1.2
date	2011.12.10.19.06.03;	author naddy;	state Exp;
branches;
next	1.1;

1.1
date	2011.09.20.10.51.26;	author fgsch;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2011.09.20.10.51.26;	author fgsch;	state Exp;
branches;
next	;


desc
@@


1.4
log
@Update to 3.2.4.
Bring patches from 2.7, remove unneeded ones, change plist to not conflict
with upcoming 3.3.1 version and update changes specific to OpenBSD.
@
text
@Fix INSTSONAME. Same as Python 2.7

$OpenBSD: patch-configure_in,v 1.3 2013/03/31 21:35:26 bcallah Exp $
--- configure.in.orig	Wed Apr 11 02:54:08 2012
+++ configure.in	Sun Mar 31 16:59:35 2013
@@@@ -764,6 +764,9 @@@@ if test $enable_shared = "yes"; then
 	      FreeBSD*)
 		SOVERSION=`echo $SOVERSION|cut -d "." -f 1`
 		;;
+	      OpenBSD*)
+		SOVERSION=${LIBpython3.2m_VERSION}
+		;;
 	  esac
 	  INSTSONAME="$LDLIBRARY".$SOVERSION
 	  if test "$with_pydebug" != yes
@@@@ -1780,7 +1783,7 @@@@ then
 	BSD/OS*/4*)
 		LDSHARED="gcc -shared"
 		LDCXXSHARED="g++ -shared";;
-	FreeBSD*)
+	FreeBSD*|OpenBSD*)
 		if [[ "`$CC -dM -E - </dev/null | grep __ELF__`" != "" ]]
 		then
 			LDSHARED='$(CC) -shared'
@@@@ -1788,22 +1791,6 @@@@ then
 		else
 			LDSHARED="ld -Bshareable"
 		fi;;
-	OpenBSD*)
-		if [[ "`$CC -dM -E - </dev/null | grep __ELF__`" != "" ]]
-		then
-				LDSHARED='$(CC) -shared $(CCSHARED)'
-				LDCXXSHARED='$(CXX) -shared $(CCSHARED)'
-		else
-				case `uname -r` in
-				[[01]].* | 2.[[0-7]] | 2.[[0-7]].*)
-				   LDSHARED="ld -Bshareable ${LDFLAGS}"
-				   ;;
-				*)
-				   LDSHARED='$(CC) -shared $(CCSHARED)'
-				   LDCXXSHARED='$(CXX) -shared $(CCSHARED)'
-				   ;;
-				esac
-		fi;;
 	NetBSD*|DragonFly*)
 		LDSHARED='$(CC) -shared'
 		LDCXXSHARED='$(CXX) -shared';;
@@@@ -1953,9 +1940,14 @@@@ AC_CHECK_LIB(dld, shl_load)	# Dynamic linking for HP-U
 
 # only check for sem_init if thread support is requested
 if test "$with_threads" = "yes" -o -z "$with_threads"; then
-    AC_SEARCH_LIBS(sem_init, pthread rt posix4) # 'Real Time' functions on Solaris
-						# posix4 on Solaris 2.6
-						# pthread (first!) on Linux
+	case $ac_sys_system/$ac_sys_release in
+        OpenBSD*)
+		LIBS="-pthread ${LIBS}" ;;
+	*)
+    		AC_SEARCH_LIBS(sem_init, pthread rt posix4) ;;  # 'Real Time' functions on Solaris
+								# posix4 on Solaris 2.6
+								# pthread (first!) on Linux
+	esac
 fi
 
 # check if we need libintl for locale functions
@


1.3
log
@Fix a hardcoded INSTSONAME, which happens to be wrong for Python 2.7
Bump everyone's REVISION.
ok sthen@@
@
text
@d3 1
a3 1
$OpenBSD: patch-configure_in,v 1.2 2011/12/10 19:06:03 naddy Exp $
@


1.2
log
@./configure[7897]: LIBS: not found

Don't introduce a syntax error in configure; sh(1) is not make(1)
and here the expansion happens in sh.  ok rpointel@@
@
text
@d1 16
a16 4
$OpenBSD: patch-configure_in,v 1.1.1.1 2011/09/20 10:51:26 fgsch Exp $
--- configure.in.orig	Sat Sep  3 18:16:50 2011
+++ configure.in	Mon Sep  5 20:00:17 2011
@@@@ -1773,7 +1773,7 @@@@
d25 1
a25 1
@@@@ -1781,22 +1781,6 @@@@
d48 1
a48 1
@@@@ -1946,9 +1930,14 @@@@
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
$OpenBSD: patch-configure_in,v 1.3 2011/09/10 05:16:20 rpointel Exp $
d45 1
a45 1
+		LIBS="-pthread $(LIBS)" ;;
@


1.1.1.1
log
@Reimport 3.2 under lang/python in preparation to merge lang/python3 under
lang/python.
remi@@ sthen@@ ok.
@
text
@@
