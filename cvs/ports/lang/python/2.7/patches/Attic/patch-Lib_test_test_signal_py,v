head	1.5;
access;
symbols
	OPENBSD_5_1_BASE:1.4
	OPENBSD_5_1:1.4.0.2
	OPENBSD_5_0:1.3.0.2
	OPENBSD_5_0_BASE:1.3
	rpointel_20110424:1.1.1.1
	rpointel:1.1.1;
locks; strict;
comment	@# @;


1.5
date	2012.02.27.19.30.46;	author rpointel;	state dead;
branches;
next	1.4;

1.4
date	2011.09.14.09.23.11;	author fgsch;	state Exp;
branches;
next	1.3;

1.3
date	2011.07.07.21.32.39;	author jasper;	state Exp;
branches;
next	1.2;

1.2
date	2011.05.08.22.46.19;	author fgsch;	state Exp;
branches;
next	1.1;

1.1
date	2011.04.24.09.31.44;	author rpointel;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2011.04.24.09.31.44;	author rpointel;	state Exp;
branches;
next	;


desc
@@


1.5
log
@Update Python to 2.7.2 and remove hacks for old pthread.
ok fgsch@@ and aja@@.
@
text
@$OpenBSD: patch-Lib_test_test_signal_py,v 1.4 2011/09/14 09:23:11 fgsch Exp $

workarounds for breakage caused by libpthread

--- Lib/test/test_signal.py.orig	Sun Nov 21 13:34:58 2010
+++ Lib/test/test_signal.py	Sat Sep 10 17:13:14 2011
@@@@ -461,8 +461,8 @@@@ class ItimerTest(unittest.TestCase):
         self.assertEqual(self.hndl_called, True)
 
     # Issue 3864. Unknown if this affects earlier versions of freebsd also.
-    @@unittest.skipIf(sys.platform=='freebsd6',
-        'itimer not reliable (does not mix well with threading) on freebsd6')
+    @@unittest.skipIf(sys.platform in ('freebsd6', 'openbsd3', 'openbsd4', 'openbsd5'),
+        'itimer not reliable (does not mix well with threading) on some BSDs.')
     def test_itimer_prof(self):
         self.itimer = signal.ITIMER_PROF
         signal.signal(signal.SIGPROF, self.sig_prof)
@


1.4
log
@siginterrupt test is passing now. remove skipIf from here.
no bump required.
@
text
@d1 1
a1 1
$OpenBSD: patch-Lib_test_test_signal_py,v 1.3 2011/07/07 21:32:39 jasper Exp $
@


1.3
log
@recognize openbsd5, may need some more work
@
text
@d1 1
a1 1
$OpenBSD: patch-Lib_test_test_signal_py,v 1.2 2011/05/08 22:46:19 fgsch Exp $
d5 3
a7 12
--- Lib/test/test_signal.py.orig	Sun Nov 21 14:34:58 2010
+++ Lib/test/test_signal.py	Wed Jul  6 15:54:12 2011
@@@@ -362,6 +362,8 @@@@ class SiginterruptTest(unittest.TestCase):
         i = self.readpipe_interrupted()
         self.assertTrue(i)
 
+    @@unittest.skipIf(sys.platform in ('openbsd3', 'openbsd4', 'openbsd5'),
+        'siginterrupt not reliable (does not mix well with threading) on some BSDs.')
     def test_siginterrupt_off(self):
         """If a signal handler is installed and siginterrupt is called with
         a false value for the second argument, when that signal arrives, it
@@@@ -461,8 +463,8 @@@@ class ItimerTest(unittest.TestCase):
@


1.2
log
@Use skipIf and mention the platforms explicitly.
@
text
@d1 1
a1 1
$OpenBSD: patch-Lib_test_test_signal_py,v 1.1.1.1 2011/04/24 09:31:44 rpointel Exp $
d5 2
a6 2
--- Lib/test/test_signal.py.orig	Sun Nov 21 13:34:58 2010
+++ Lib/test/test_signal.py	Sat May  7 10:45:56 2011
d11 1
a11 1
+    @@unittest.skipIf(sys.platform in ('openbsd3', 'openbsd4'),
d22 1
a22 1
+    @@unittest.skipIf(sys.platform in ('freebsd6', 'openbsd3', 'openbsd4'),
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
$OpenBSD$
d5 10
a14 3
--- Lib/test/test_signal.py.orig	Sun Nov 21 14:34:58 2010
+++ Lib/test/test_signal.py	Sun Mar 27 20:21:27 2011
@@@@ -367,6 +367,12 @@@@
d16 1
a16 12
         does not interrupt a syscall that's in progress.
         """
+        if sys.platform.startswith('openbsd'):
+            if test_support.verbose:
+                sys.stderr.write('skipping -- siginterrupt not reliable (does '
+                                 'not mix well with threading) on %s\n' %
+                                 sys.platform)
+            return
         signal.siginterrupt(self.signum, 0)
         i = self.readpipe_interrupted()
         self.assertFalse(i)
@@@@ -461,8 +467,8 @@@@
d22 2
a23 2
+    @@unittest.skipIf(sys.platform=='freebsd6' or sys.platform.startswith('openbsd'),
+        'itimer not reliable (does not mix well with threading) on %s\n' % sys.platform)
@


1.1.1.1
log
@Import Python 2.7.1.
Thanks a lot to landry@@, fgsch@@ for feedback.
Need tests before doing this version the default.

@
text
@@
