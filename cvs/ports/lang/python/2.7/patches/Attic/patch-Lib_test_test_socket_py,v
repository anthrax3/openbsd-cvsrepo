head	1.6;
access;
symbols
	OPENBSD_5_7:1.5.0.2
	OPENBSD_5_7_BASE:1.5
	OPENBSD_5_6:1.4.0.2
	OPENBSD_5_6_BASE:1.4
	OPENBSD_5_5:1.3.0.4
	OPENBSD_5_5_BASE:1.3
	OPENBSD_5_4:1.3.0.2;
locks; strict;
comment	@# @;


1.6
date	2015.05.31.07.56.10;	author rpointel;	state dead;
branches;
next	1.5;
commitid	qCtVfCdwLsiLYx98;

1.5
date	2014.12.14.08.32.55;	author rpointel;	state Exp;
branches;
next	1.4;
commitid	9umKNgkjnmUkN8MF;

1.4
date	2014.07.11.06.59.43;	author rpointel;	state Exp;
branches;
next	1.3;
commitid	AwBHCcOhAdtRO1qA;

1.3
date	2014.02.09.09.49.26;	author rpointel;	state Exp;
branches
	1.3.2.1;
next	1.2;

1.2
date	2011.05.05.23.25.44;	author fgsch;	state dead;
branches;
next	1.1;

1.1
date	2011.04.26.19.42.31;	author rpointel;	state Exp;
branches;
next	;

1.3.2.1
date	2014.02.09.17.55.27;	author rpointel;	state Exp;
branches;
next	;


desc
@@


1.6
log
@update python to 2.7.10.
ok aja@@
@
text
@$OpenBSD: patch-Lib_test_test_socket_py,v 1.5 2014/12/14 08:32:55 rpointel Exp $
security fix: http://bugs.python.org/issue20246

--- Lib/test/test_socket.py.orig	Wed Dec 10 16:59:47 2014
+++ Lib/test/test_socket.py	Sat Dec 13 12:13:40 2014
@@@@ -1694,6 +1694,16 @@@@ class BufferIOTest(SocketConnectedTest):
 
     _testRecvFromIntoEmptyBuffer = _testRecvFromIntoArray
 
+    def testRecvFromIntoSmallBuffer(self):
+        # See issue #20246.
+        buf = bytearray(8)
+        self.assertRaises(ValueError, self.cli_conn.recvfrom_into, buf, 1024)
+
+    def _testRecvFromIntoSmallBuffer(self):
+        with test_support.check_py3k_warnings():
+            buf = buffer(MSG)
+        self.serv_conn.send(buf)
+
 
 TIPC_STYPE = 2000
 TIPC_LOWER = 200
@


1.5
log
@Update Python 2.7 to 2.7.9.
ok sthen@@, also tested on macppc by Fred <openbsd@@crowsons.com> (thanks).
@
text
@d1 1
a1 1
$OpenBSD: patch-Lib_test_test_socket_py,v 1.4 2014/07/11 06:59:43 rpointel Exp $
@


1.4
log
@Update Python to 2.7.8.
Changelog: http://hg.python.org/cpython/raw-file/v2.7.8/Misc/NEWS
ok daniel@@ (thanks for the 2 patches).
@
text
@d1 1
a1 1
$OpenBSD: patch-Lib_test_test_socket_py,v 1.3 2014/02/09 09:49:26 rpointel Exp $
d4 3
a6 3
--- Lib/test/test_socket.py.orig	Mon Jun 30 04:05:36 2014
+++ Lib/test/test_socket.py	Wed Jul  9 11:41:15 2014
@@@@ -1660,6 +1660,16 @@@@ class BufferIOTest(SocketConnectedTest):
@


1.3
log
@Security fix for Python 2.7 and 3.3.
More information: http://bugs.python.org/issue20246
http://seclists.org/oss-sec/2014/q1/284

go aja@@ espie@@
@
text
@d1 1
a1 1
$OpenBSD$
d4 3
a6 3
--- Lib/test/test_socket.py.orig
+++ Lib/test/test_socket.py
@@@@ -1620,6 +1620,16 @@@@ class BufferIOTest(SocketConnectedTest):
d8 1
a8 1
     _testRecvFromIntoMemoryview = _testRecvFromIntoArray
d20 3
@


1.3.2.1
log
@Security fix: buffer overflow in socket.recvfrom_into
More information: http://bugs.python.org/issue20246

ok jasper@@ (thanks).
@
text
@@


1.2
log
@- revert the handling of async callbacks pre 2.7 for the time being. this
  fixes the hangs and some other problems and allow us to move further while
  a proper fix is investigated. as a result remove the patches to test_io
  and test_socket, they are ok now.
- remove the distutils diff. it doesn't seem right, nobody really knows why
  it's there and it actually breaks things with this version.
- bump
discussed and ok rpointel martynas sthen djm
@
text
@d1 6
a6 6
$OpenBSD: patch-Lib_test_test_socket_py,v 1.1 2011/04/26 19:42:31 rpointel Exp $
--- Lib/test/test_socket.py.orig	Fri Nov 26 09:28:05 2010
+++ Lib/test/test_socket.py	Tue Apr 26 13:06:02 2011
@@@@ -655,6 +655,7 @@@@
             c.close()
             s.close()
d8 1
a8 3
+    @@unittest.skip("Skipped on OpenBSD because triggers an infinite loop")
     def test_sendall_interrupted(self):
         self.check_sendall_interrupted(False)
d10 10
@


1.1
log
@Added 2 patch to permit to 'make regress' without blocking...
Used @@unittest.skip instead of commenting out the test.
Corrected wrong value of LDSHARED in sysconfig, cf http://bugs.python.org/issue10547.
Bump REVISION.
ok landry@@ (thanks).
@
text
@d1 1
a1 1
$OpenBSD$
@

