head	1.10;
access;
symbols
	OPENBSD_6_2:1.10.0.4
	OPENBSD_6_2_BASE:1.10
	OPENBSD_6_1:1.10.0.2
	OPENBSD_6_1_BASE:1.10
	OPENBSD_6_0:1.9.0.2
	OPENBSD_6_0_BASE:1.9
	OPENBSD_5_9:1.8.0.4
	OPENBSD_5_9_BASE:1.8
	OPENBSD_5_8:1.8.0.6
	OPENBSD_5_8_BASE:1.8
	OPENBSD_5_7:1.8.0.2
	OPENBSD_5_7_BASE:1.8
	OPENBSD_5_6:1.7.0.4
	OPENBSD_5_6_BASE:1.7
	OPENBSD_5_5:1.7.0.2
	OPENBSD_5_5_BASE:1.7
	OPENBSD_5_4:1.6.0.2
	OPENBSD_5_4_BASE:1.6
	OPENBSD_5_3:1.4.0.4
	OPENBSD_5_3_BASE:1.4
	OPENBSD_5_2:1.4.0.2
	OPENBSD_5_2_BASE:1.4
	OPENBSD_5_1_BASE:1.2
	OPENBSD_5_1:1.2.0.4
	OPENBSD_5_0:1.2.0.2
	OPENBSD_5_0_BASE:1.2
	rpointel_20110424:1.1.1.1
	rpointel:1.1.1;
locks; strict;
comment	@# @;


1.10
date	2016.12.19.20.47.26;	author rpointel;	state Exp;
branches;
next	1.9;
commitid	jVLo58xQtdk9FGNQ;

1.9
date	2016.07.03.20.10.33;	author rpointel;	state Exp;
branches;
next	1.8;
commitid	MyKdUN8Nyp3exDlk;

1.8
date	2014.12.14.08.32.55;	author rpointel;	state Exp;
branches;
next	1.7;
commitid	9umKNgkjnmUkN8MF;

1.7
date	2014.01.09.18.03.35;	author fgsch;	state Exp;
branches;
next	1.6;

1.6
date	2013.05.22.12.39.30;	author fgsch;	state Exp;
branches;
next	1.5;

1.5
date	2013.04.13.22.31.42;	author fgsch;	state Exp;
branches;
next	1.4;

1.4
date	2012.04.27.08.18.59;	author rpointel;	state Exp;
branches;
next	1.3;

1.3
date	2012.02.27.19.30.46;	author rpointel;	state Exp;
branches;
next	1.2;

1.2
date	2011.07.06.12.05.56;	author jasper;	state Exp;
branches;
next	1.1;

1.1
date	2011.04.24.09.31.44;	author rpointel;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2011.04.24.09.31.44;	author rpointel;	state Exp;
branches;
next	;


desc
@@


1.10
log
@update Python to 2.7.13.
ok juanfra@@ shadchin@@
@
text
@$OpenBSD: patch-Makefile_pre_in,v 1.9 2016/07/03 20:10:33 rpointel Exp $
--- Makefile.pre.in.orig	Sat Dec 17 21:05:06 2016
+++ Makefile.pre.in	Sun Dec 18 08:21:50 2016
@@@@ -583,7 +583,7 @@@@ gdbhooks: $(BUILDPYTHON)-gdb.py
 
 SRC_GDB_HOOKS=$(srcdir)/Tools/gdb/libpython.py
 $(BUILDPYTHON)-gdb.py: $(SRC_GDB_HOOKS)
-	$(INSTALL_DATA) $(SRC_GDB_HOOKS) $(BUILDPYTHON)-gdb.py
+	cp $(SRC_GDB_HOOKS) $(BUILDPYTHON)-gdb.py
 
 # This rule is here for OPENSTEP/Rhapsody/MacOSX. It builds a temporary
 # minimal framework (not including the Lib directory and such) in the current
@


1.9
log
@forgotten make update-patches, spotted by danj@@.
inputs and ok sthen@@.
@
text
@d1 4
a4 4
$OpenBSD: patch-Makefile_pre_in,v 1.8 2014/12/14 08:32:55 rpointel Exp $
--- Makefile.pre.in.orig	Sat Jun 25 23:49:31 2016
+++ Makefile.pre.in	Fri Jul  1 10:35:01 2016
@@@@ -584,7 +584,7 @@@@ gdbhooks: $(BUILDPYTHON)-gdb.py
@


1.8
log
@Update Python 2.7 to 2.7.9.
ok sthen@@, also tested on macppc by Fred <openbsd@@crowsons.com> (thanks).
@
text
@d1 4
a4 4
$OpenBSD: patch-Makefile_pre_in,v 1.7 2014/01/09 18:03:35 fgsch Exp $
--- Makefile.pre.in.orig	Wed Dec 10 16:59:50 2014
+++ Makefile.pre.in	Sat Dec 13 12:13:40 2014
@@@@ -512,7 +512,7 @@@@ gdbhooks: $(BUILDPYTHON)-gdb.py
@


1.7
log
@Update to python to 2.7.6.
Tested on i386, amd64 and macppc. macppc included a diff that's not part
of this update but will be added at a later time.
Committing on behalf of rpointel@@. sthen@@ OK
@
text
@d1 4
a4 4
$OpenBSD: patch-Makefile_pre_in,v 1.6 2013/05/22 12:39:30 fgsch Exp $
--- Makefile.pre.in.orig	Sun Nov 10 08:36:41 2013
+++ Makefile.pre.in	Mon Nov 11 15:27:59 2013
@@@@ -499,7 +499,7 @@@@ gdbhooks: $(BUILDPYTHON)-gdb.py
@


1.6
log
@Update to 2.7.5.
ok ajacoutot@@ as part of a larger diff.
@
text
@d1 4
a4 4
$OpenBSD: patch-Makefile_pre_in,v 1.5 2013/04/13 22:31:42 fgsch Exp $
--- Makefile.pre.in.orig	Sun May 12 04:32:49 2013
+++ Makefile.pre.in	Sat May 18 21:26:38 2013
@@@@ -494,7 +494,7 @@@@ gdbhooks: $(BUILDPYTHON)-gdb.py
@


1.5
log
@Update python 2.7 to 2.7.4.

This is a slighly different version that I sent that includes an updated
kqueue diff that works with python 2 and 3 and puts test_bsddb and
test_bsddb3 back on the skip list as they're not built outside amd64
and i386.

Only 2 tests are known to fail: test_kqueue (broken) and test_threading
(failing on 2.7.3, under investigation but likely broken). If something
else fails please send your test.log.

Tested on a bulk by landry, sparc64 by brad, ppc gonzalo and amd64 by me.
@
text
@d1 4
a4 4
$OpenBSD: patch-Makefile_pre_in,v 1.4 2012/04/27 08:18:59 rpointel Exp $
--- Makefile.pre.in.orig	Sat Apr  6 15:02:34 2013
+++ Makefile.pre.in	Mon Apr  8 00:18:17 2013
@@@@ -489,7 +489,7 @@@@ gdbhooks: $(BUILDPYTHON)-gdb.py
@


1.4
log
@Update Python 2.7.2 to 2.7.3.
ok mpi@@, gonzalo@@. tested in a bulk build by landry@@.
@
text
@d1 4
a4 22
$OpenBSD: patch-Makefile_pre_in,v 1.3 2012/02/27 19:30:46 rpointel Exp $
--- Makefile.pre.in.orig	Tue Apr 10 01:07:33 2012
+++ Makefile.pre.in	Fri Apr 13 07:49:16 2012
@@@@ -364,6 +364,8 @@@@ LIBRARY_OBJS=	\
 #########################################################################
 # Rules
 
+everything: all $(srcdir)/Lib/$(PLATDIR)
+
 # Default target
 all:		build_all
 build_all:	$(BUILDPYTHON) oldsharedmods sharedmods gdbhooks
@@@@ -399,7 +401,7 @@@@ coverage:
 $(BUILDPYTHON):	Modules/python.o $(LIBRARY) $(LDLIBRARY)
 		$(LINKCC) $(LDFLAGS) $(LINKFORSHARED) -o $@@ \
 			Modules/python.o \
-			$(BLDLIBRARY) $(LIBS) $(MODLIBS) $(SYSLIBS) $(LDLAST)
+			-lpython$(VERSION) $(LIBS) $(MODLIBS) $(SYSLIBS) $(LDLAST)
 
 platform: $(BUILDPYTHON)
 	$(RUNSHARED) ./$(BUILDPYTHON) -E -c 'import sys ; from sysconfig import get_platform ; print get_platform()+"-"+sys.version[0:3]' >platform
@@@@ -448,8 +450,12 @@@@ gdbhooks: $(BUILDPYTHON)-gdb.py
a10 4
+# This rule for OpenBSD...
+$(LDLIBRARY):      $(LIBRARY)
+	$(LDSHARED) -o $@@ $(LIBRARY_OBJS)
+
a12 41
 # directory.
@@@@ -795,9 +801,6 @@@@ bininstall:	altbininstall
 	then rm -f $(DESTDIR)$(BINDIR)/$(PYTHON); \
 	else true; \
 	fi
-	(cd $(DESTDIR)$(BINDIR); $(LN) -s python2$(EXE) $(PYTHON))
-	-rm -f $(DESTDIR)$(BINDIR)/python2$(EXE)
-	(cd $(DESTDIR)$(BINDIR); $(LN) -s python$(VERSION)$(EXE) python2$(EXE))
 	-rm -f $(DESTDIR)$(BINDIR)/python2-config
 	(cd $(DESTDIR)$(BINDIR); $(LN) -s python$(VERSION)-config python2-config)
 	-rm -f $(DESTDIR)$(BINDIR)/python-config
@@@@ -811,7 +814,7 @@@@ bininstall:	altbininstall
 # Install the interpreter with $(VERSION) affixed
 # This goes into $(exec_prefix)
 altbininstall:	$(BUILDPYTHON)
-	@@for i in $(BINDIR) $(LIBDIR); \
+	@@for i in $(BINDIR) $(LIBDIR) $(LIBPL); \
 	do \
 		if test ! -d $(DESTDIR)$$i; then \
 			echo "Creating directory $$i"; \
@@@@ -827,7 +830,8 @@@@ altbininstall:	$(BUILDPYTHON)
 			$(INSTALL_SHARED) $(LDLIBRARY) $(DESTDIR)$(LIBDIR)/$(INSTSONAME); \
 			if test $(LDLIBRARY) != $(INSTSONAME); then \
 				(cd $(DESTDIR)$(LIBDIR); $(LN) -sf $(INSTSONAME) $(LDLIBRARY)) \
-			fi \
+			fi ; \
+			(cd $(DESTDIR)$(LIBPL); $(LN) -sf $(LIBDIR)/$(LDLIBRARY)) \
 		fi; \
 	else	true; \
 	fi
@@@@ -960,8 +964,8 @@@@ libinstall:	build_all $(srcdir)/Lib/$(PLATDIR) $(srcdi
 		./$(BUILDPYTHON) -Wi -t -c "import lib2to3.pygram, lib2to3.patcomp;lib2to3.patcomp.PatternCompiler()"
 
 # Create the PLATDIR source directory, if one wasn't distributed..
-$(srcdir)/Lib/$(PLATDIR):
-	mkdir $(srcdir)/Lib/$(PLATDIR)
+$(srcdir)/Lib/$(PLATDIR): $(BUILDPYTHON)
+	mkdir -p $(srcdir)/Lib/$(PLATDIR)
 	cp $(srcdir)/Lib/plat-generic/regen $(srcdir)/Lib/$(PLATDIR)/regen
 	export PATH; PATH="`pwd`:$$PATH"; \
 	export PYTHONPATH; PYTHONPATH="`pwd`/Lib"; \
@


1.3
log
@Update Python to 2.7.2 and remove hacks for old pthread.
ok fgsch@@ and aja@@.
@
text
@d1 4
a4 4
$OpenBSD: patch-Makefile_pre_in,v 1.2 2011/07/06 12:05:56 jasper Exp $
--- Makefile.pre.in.orig	Sat Jun 11 17:46:26 2011
+++ Makefile.pre.in	Sun Feb 19 19:10:29 2012
@@@@ -363,6 +363,8 @@@@ LIBRARY_OBJS=	\
d13 1
a13 1
@@@@ -398,7 +400,7 @@@@ coverage:
d22 1
a22 1
@@@@ -447,8 +449,12 @@@@ gdbhooks: $(BUILDPYTHON)-gdb.py
d36 1
a36 1
@@@@ -792,7 +798,6 @@@@ bininstall:	altbininstall
d40 5
a44 1
-	(cd $(DESTDIR)$(BINDIR); $(LN) python$(VERSION)$(EXE) $(PYTHON))
d46 1
a46 3
 	(cd $(DESTDIR)$(BINDIR); $(LN) -s python$(VERSION)-config python-config)
 	-test -d $(DESTDIR)$(LIBPC) || $(INSTALL) -d -m $(DIRMODE) $(DESTDIR)$(LIBPC)
@@@@ -802,7 +807,7 @@@@ bininstall:	altbininstall
d55 1
a55 1
@@@@ -818,7 +823,8 @@@@ altbininstall:	$(BUILDPYTHON)
d65 1
a65 1
@@@@ -947,8 +953,8 @@@@ libinstall:	build_all $(srcdir)/Lib/$(PLATDIR)
@


1.2
log
@regen
@
text
@d1 4
a4 4
$OpenBSD: patch-Makefile_pre_in,v 1.1.1.1 2011/04/24 09:31:44 rpointel Exp $
--- Makefile.pre.in.orig	Thu Oct 14 13:37:30 2010
+++ Makefile.pre.in	Wed Jul  6 14:05:40 2011
@@@@ -360,6 +360,8 @@@@ LIBRARY_OBJS=	\
d13 1
a13 1
@@@@ -395,7 +397,7 @@@@ coverage:
d22 1
a22 1
@@@@ -444,8 +446,12 @@@@ gdbhooks: $(BUILDPYTHON)-gdb.py
d36 1
a36 1
@@@@ -787,7 +793,6 @@@@ bininstall:	altbininstall
d44 1
a44 1
@@@@ -797,7 +802,7 @@@@ bininstall:	altbininstall
d53 1
a53 1
@@@@ -813,7 +818,8 @@@@ altbininstall:	$(BUILDPYTHON)
d63 1
a63 1
@@@@ -942,8 +948,8 @@@@ libinstall:	build_all $(srcdir)/Lib/$(PLATDIR)
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
$OpenBSD$
d3 2
a4 2
+++ Makefile.pre.in	Mon Apr 11 22:39:56 2011
@@@@ -360,6 +360,8 @@@@
d13 1
a13 1
@@@@ -395,7 +397,7 @@@@
d22 1
a22 1
@@@@ -444,8 +446,12 @@@@
d36 1
a36 1
@@@@ -787,7 +793,6 @@@@
d44 1
a44 1
@@@@ -797,7 +802,7 @@@@
d53 1
a53 1
@@@@ -813,7 +818,8 @@@@
d63 1
a63 1
@@@@ -942,8 +948,8 @@@@
@


1.1.1.1
log
@Import Python 2.7.1.
Thanks a lot to landry@@, fgsch@@ for feedback.
Need tests before doing this version the default.

@
text
@@
