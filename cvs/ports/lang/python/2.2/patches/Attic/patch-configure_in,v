head	1.7;
access;
symbols
	OPENBSD_3_7:1.6.0.4
	OPENBSD_3_7_BASE:1.6
	OPENBSD_3_6:1.6.0.2
	OPENBSD_3_6_BASE:1.6
	OPENBSD_3_5:1.5.0.2
	OPENBSD_3_5_BASE:1.5
	OPENBSD_3_4:1.4.0.6
	OPENBSD_3_4_BASE:1.4
	OPENBSD_3_3:1.4.0.4
	OPENBSD_3_3_BASE:1.4
	OPENBSD_3_2:1.4.0.2
	OPENBSD_3_2_BASE:1.4
	OPENBSD_3_1:1.1.0.2
	OPENBSD_3_1_BASE:1.1;
locks; strict;
comment	@# @;


1.7
date	2005.05.22.12.01.13;	author alek;	state dead;
branches;
next	1.6;

1.6
date	2004.05.12.22.27.24;	author brad;	state Exp;
branches;
next	1.5;

1.5
date	2003.12.30.22.21.25;	author sturm;	state Exp;
branches;
next	1.4;

1.4
date	2002.05.12.01.05.49;	author brad;	state Exp;
branches;
next	1.3;

1.3
date	2002.05.11.21.35.13;	author matt;	state Exp;
branches;
next	1.2;

1.2
date	2002.04.16.03.40.02;	author brad;	state Exp;
branches;
next	1.1;

1.1
date	2002.02.15.19.42.18;	author matt;	state Exp;
branches;
next	;


desc
@@


1.7
log
@Please use lang/python/2.3

ok mbalmer@@, xsa@@, krw@@ and others too
@
text
@$OpenBSD: patch-configure_in,v 1.6 2004/05/12 22:27:24 brad Exp $
--- configure.in.orig	2003-03-29 17:25:17.000000000 -0500
+++ configure.in	2004-04-19 21:37:54.000000000 -0400
@@@@ -827,14 +827,28 @@@@ then
 	Linux*) LDSHARED='$(CC) -shared';;
 	dgux*) LDSHARED="ld -G";;
 	BSD/OS*/4*) LDSHARED="gcc -shared";;
-	OpenBSD*|FreeBSD*)
+	FreeBSD*)
 		if [[ "`$CC -dM -E - </dev/null | grep __ELF__`" != "" ]]
 		then
 			LDSHARED="cc -shared ${LDFLAGS}"
 		else
 			LDSHARED="ld -Bshareable ${LDFLAGS}"
 		fi;;
-	NetBSD*) LDSHARED="cc -shared ${LDFLAGS}";;
+	OpenBSD*)
+		if [[ "`$CC -dM -E - </dev/null | grep __ELF__`" != "" ]]
+		then
+			LDSHARED='$(CC) -shared $(CCSHARED) ${LDFLAGS}'
+		else
+			case `uname -r` in
+			[[01]].* | 2.[[0-7]] | 2.[[0-7]].*)
+			   LDSHARED="ld -Bshareable ${LDFLAGS}"
+			   ;;
+			*)
+			   LDSHARED='$(CC) -shared $(CCSHARED) ${LDFLAGS}'
+			   ;;
+			esac
+		fi;;
+	NetBSD*) LDSHARED="${CC} -shared ${LDFLAGS}";;
 	OpenUNIX*|UnixWare*)
 		if test "$GCC" = "yes"
 		then LDSHARED="$(CC) -shared"
@@@@ -1083,8 +1097,8 @@@@ yes
     # on HP/UX, pthread.h renames pthread_create to a different symbol name.
     # So we really have to include pthread.h, and then link.
     _libs=$LIBS
-    LIBS="$LIBS -lpthread"
-    AC_MSG_CHECKING([for pthread_create in -lpthread])
+    LIBS="$LIBS -pthread"
+    AC_MSG_CHECKING([for pthread_create in -pthread])
     AC_TRY_LINK([#include <pthread.h>
 
 void * start_routine (void *arg) { exit (0); }], [
@@@@ -1102,7 +1116,7 @@@@ pthread_create (NULL, NULL, start_routin
     LIBOBJS="$LIBOBJS thread.o"],[
     AC_CHECK_LIB(pthreads, pthread_create, [AC_DEFINE(WITH_THREAD)
     posix_threads=yes
-    LIBS="$LIBS -lpthreads"
+    LIBS="$LIBS -pthreads"
     LIBOBJS="$LIBOBJS thread.o"], [
     AC_CHECK_LIB(c_r, pthread_create, [AC_DEFINE(WITH_THREAD)
     posix_threads=yes
@@@@ -1114,7 +1128,7 @@@@ pthread_create (NULL, NULL, start_routin
     LIBOBJS="$LIBOBJS thread.o"], [
     AC_CHECK_LIB(pthread, __pthread_create_system, [AC_DEFINE(WITH_THREAD)
     posix_threads=yes
-    LIBS="$LIBS -lpthread"
+    LIBS="$LIBS -pthread"
     LIBOBJS="$LIBOBJS thread.o"], [
     AC_CHECK_LIB(cma, pthread_create, [AC_DEFINE(WITH_THREAD)
     posix_threads=yes
@


1.6
log
@Make sure to pass the PIC flag when linking.
@
text
@d1 1
a1 1
$OpenBSD: patch-configure_in,v 1.5 2003/12/30 22:21:25 sturm Exp $
@


1.5
log
@update to python 2.2.3, lots of bugfixes

from Aleksander Piotrowski <aleksander dot piotrowski at nic dot com dot pl>
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.4 2002/05/12 01:05:49 brad Exp $
--- configure.in.orig	2003-03-29 23:25:17.000000000 +0100
+++ configure.in	2003-12-30 19:14:57.000000000 +0100
@@@@ -827,14 +827,14 @@@@ then
d17 15
a31 1
+	OpenBSD*|NetBSD*) LDSHARED="${CC} -shared ${LDFLAGS}";;
d35 1
a35 1
@@@@ -1083,8 +1083,8 @@@@ yes
d46 1
a46 1
@@@@ -1102,7 +1102,7 @@@@ pthread_create (NULL, NULL, start_routin
d55 1
a55 1
@@@@ -1114,7 +1114,7 @@@@ pthread_create (NULL, NULL, start_routin
@


1.4
log
@fixes for shared lib support
@
text
@d1 5
a5 9
$OpenBSD: patch-configure_in,v 1.3 2002/05/11 21:35:13 matt Exp $

        This has been submitted to the Python team as part of patch
        554719.

--- configure.in.orig	Mon Mar 11 05:14:23 2002
+++ configure.in	Sat May 11 20:24:08 2002
@@@@ -802,7 +802,21 @@@@ then
 	Linux*) LDSHARED="gcc -shared";;
d8 2
a9 16
-	OpenBSD*|NetBSD*|FreeBSD*)
+	OpenBSD*)
+		if [[ "`$CC -dM -E - </dev/null | grep __ELF__`" != "" ]]
+		then
+			LDSHARED='$(CC) -shared $(CCSHARED) ${LDFLAGS}'
+		else
+			case `uname -r` in
+			[01].* | 2.[[0-7]] | 2.[[0-7]].*)
+			  LDSHARED="ld -Bshareable ${LDFLAGS}"
+			  ;;
+			*)
+			  LDSHARED='$(CC) -shared $(CCSHARED) ${LDFLAGS}'
+			  ;;
+			esac
+		fi;;
+	NetBSD*|FreeBSD*)
d13 36
a48 2
@@@@ -1016,6 +1030,14 @@@@ then
     AC_DEFINE(WITH_THREAD)
a49 12
     LIBOBJS="$LIBOBJS thread.o"
+elif test "$ac_sys_system" = "OpenBSD"
+then
+    posix_threads=yes
+    LIBS="-pthread $LIBS"
+    LIBOBJS="$LIBOBJS thread.o"
+    AC_DEFINE(WITH_THREAD)
+    AC_DEFINE(_REENTRANT)
+    AC_DEFINE(_POSIX_THREADS)
 else
     if test ! -z "$with_threads" -a -d "$with_threads"
     then LDFLAGS="$LDFLAGS -L$with_threads"
@


1.3
log
@- 2.2 -> 2.2.1
- annotate patches submitted to Python patch tracker
- 100% license compliance: install CHANGES.OpenBSD file
@
text
@d1 1
a1 1
$OpenBSD: patch-configure_in,v 1.2 2002/04/16 03:40:02 brad Exp $
d7 1
a7 1
+++ configure.in	Fri Apr 19 09:05:16 2002
d16 1
a16 1
+			LDSHARED="cc -shared ${LDFLAGS}"
d20 1
a20 1
+			  LDSHARED="ld -Bshareable"
d23 1
a23 1
+			  LDSHARED='$(CC) -shared $(CCSHARED)'
@


1.2
log
@OpenBSD threads.
@
text
@d1 8
a8 4
$OpenBSD: patch-configure_in,v 1.1 2002/02/15 19:42:18 matt Exp $
--- configure.in.orig	Fri Dec  7 10:38:26 2001
+++ configure.in	Fri Mar 15 10:36:34 2002
@@@@ -799,7 +799,21 @@@@ then
d31 1
a31 1
@@@@ -1013,6 +1027,14 @@@@ then
@


1.1
log
@Python 2.1.2 and Python 2.2.

Major changes:

- no more threads flavor, threads is now the default.

- subpackage modules that depend on other packages instead of having
largely redundant flavors (unless platform has no shared libs, then
flavors count again)

- shared libpython stuff disabled until someone can figure out why
it makes Zope crash
@
text
@d1 3
a3 3
$OpenBSD$
--- configure.in.orig	Fri Dec  7 07:38:26 2001
+++ configure.in	Mon Dec 17 12:06:44 2001
d27 15
@

