head	1.68;
access;
symbols
	OPENBSD_6_1:1.67.0.2
	OPENBSD_6_1_BASE:1.67
	OPENBSD_6_0:1.66.0.4
	OPENBSD_6_0_BASE:1.66
	OPENBSD_5_9:1.66.0.2
	OPENBSD_5_9_BASE:1.66
	OPENBSD_5_8:1.65.0.6
	OPENBSD_5_8_BASE:1.65
	OPENBSD_5_7:1.65.0.2
	OPENBSD_5_7_BASE:1.65
	OPENBSD_5_6:1.64.0.2
	OPENBSD_5_6_BASE:1.64
	OPENBSD_5_5:1.63.0.4
	OPENBSD_5_5_BASE:1.63
	OPENBSD_5_4:1.63.0.2
	OPENBSD_5_4_BASE:1.63
	OPENBSD_5_3:1.60.0.6
	OPENBSD_5_3_BASE:1.60
	OPENBSD_5_2:1.60.0.4
	OPENBSD_5_2_BASE:1.60
	OPENBSD_5_1_BASE:1.60
	OPENBSD_5_1:1.60.0.2
	OPENBSD_5_0:1.58.0.2
	OPENBSD_5_0_BASE:1.58
	OPENBSD_4_9:1.56.0.6
	OPENBSD_4_9_BASE:1.56
	OPENBSD_4_8:1.56.0.4
	OPENBSD_4_8_BASE:1.56
	OPENBSD_4_7:1.56.0.2
	OPENBSD_4_7_BASE:1.56
	OPENBSD_4_6:1.55.0.4
	OPENBSD_4_6_BASE:1.55
	OPENBSD_4_5:1.55.0.2
	OPENBSD_4_5_BASE:1.55
	OPENBSD_4_4:1.54.0.8
	OPENBSD_4_4_BASE:1.54
	OPENBSD_4_3:1.54.0.6
	OPENBSD_4_3_BASE:1.54
	OPENBSD_4_2:1.54.0.4
	OPENBSD_4_2_BASE:1.54
	OPENBSD_4_1:1.54.0.2
	OPENBSD_4_1_BASE:1.54
	OPENBSD_4_0:1.53.0.6
	OPENBSD_4_0_BASE:1.53
	OPENBSD_3_9:1.53.0.4
	OPENBSD_3_9_BASE:1.53
	OPENBSD_3_8:1.53.0.2
	OPENBSD_3_8_BASE:1.53
	OPENBSD_3_7:1.50.0.6
	OPENBSD_3_7_BASE:1.50
	OPENBSD_3_6:1.50.0.4
	OPENBSD_3_6_BASE:1.50
	OPENBSD_3_5:1.50.0.2
	OPENBSD_3_5_BASE:1.50
	OPENBSD_3_4:1.49.0.8
	OPENBSD_3_4_BASE:1.49
	OPENBSD_3_3:1.49.0.6
	OPENBSD_3_3_BASE:1.49
	OPENBSD_3_2:1.49.0.4
	OPENBSD_3_2_BASE:1.49
	OPENBSD_3_1:1.49.0.2
	OPENBSD_3_1_BASE:1.49
	OPENBSD_3_0:1.44.0.2
	OPENBSD_3_0_BASE:1.44
	OPENBSD_2_9_TRACKING_SWITCH:1.36
	OPENBSD_2_9:1.29.0.2
	OPENBSD_2_9_BASE:1.29
	OPENBSD_2_8:1.22.0.2
	OPENBSD_2_8_BASE:1.22
	OPENBSD_2_7:1.14.0.2
	OPENBSD_2_7_BASE:1.14
	OPENBSD_2_6:1.2.0.4
	OPENBSD_2_6_BASE:1.2
	OPENBSD_2_5:1.2.0.2
	OPENBSD_2_5_BASE:1.2
	OPENBSD_2_4:1.1.1.1.0.4
	OPENBSD_2_4_BASE:1.1.1.1
	OPENBSD_2_3:1.1.1.1.0.2
	OPENBSD_2_3_BASE:1.1.1.1
	python-1_5:1.1.1.1
	python:1.1.1;
locks; strict;
comment	@# @;


1.68
date	2017.07.08.08.28.00;	author landry;	state Exp;
branches;
next	1.67;
commitid	3yI3SLATUJ2eVpSH;

1.67
date	2016.12.26.19.42.49;	author rpointel;	state Exp;
branches;
next	1.66;
commitid	Hvhbu7rI1PnS9hxi;

1.66
date	2015.09.23.19.24.41;	author rpointel;	state Exp;
branches;
next	1.65;
commitid	ddnU4dmR8Dk2DFQh;

1.65
date	2014.11.02.07.48.30;	author rpointel;	state Exp;
branches;
next	1.64;
commitid	xKxDOgg8HD2VoLIP;

1.64
date	2014.04.13.07.41.28;	author rpointel;	state Exp;
branches;
next	1.63;

1.63
date	2013.06.04.07.29.13;	author fgsch;	state Exp;
branches;
next	1.62;

1.62
date	2013.05.30.14.45.07;	author ajacoutot;	state Exp;
branches;
next	1.61;

1.61
date	2013.05.03.08.52.13;	author fgsch;	state Exp;
branches;
next	1.60;

1.60
date	2011.12.20.13.08.06;	author fgsch;	state Exp;
branches;
next	1.59;

1.59
date	2011.09.21.14.39.06;	author fgsch;	state Exp;
branches;
next	1.58;

1.58
date	2011.07.13.08.03.40;	author jasper;	state Exp;
branches;
next	1.57;

1.57
date	2011.05.15.08.25.45;	author rpointel;	state Exp;
branches;
next	1.56;

1.56
date	2010.02.01.17.00.13;	author espie;	state Exp;
branches;
next	1.55;

1.55
date	2008.10.18.12.04.37;	author djm;	state Exp;
branches;
next	1.54;

1.54
date	2006.11.01.21.20.04;	author alek;	state Exp;
branches;
next	1.53;

1.53
date	2005.06.07.01.13.52;	author alek;	state Exp;
branches;
next	1.52;

1.52
date	2005.05.22.12.01.13;	author alek;	state Exp;
branches;
next	1.51;

1.51
date	2005.05.17.17.53.25;	author alek;	state Exp;
branches;
next	1.50;

1.50
date	2003.12.31.17.40.20;	author sturm;	state Exp;
branches;
next	1.49;

1.49
date	2002.02.15.19.42.18;	author matt;	state Exp;
branches;
next	1.48;

1.48
date	2001.11.16.22.18.27;	author jasoni;	state Exp;
branches;
next	1.47;

1.47
date	2001.11.06.17.40.31;	author shell;	state Exp;
branches;
next	1.46;

1.46
date	2001.11.05.22.46.53;	author shell;	state Exp;
branches;
next	1.45;

1.45
date	2001.10.27.03.01.53;	author brad;	state Exp;
branches;
next	1.44;

1.44
date	2001.10.16.16.34.01;	author brad;	state Exp;
branches;
next	1.43;

1.43
date	2001.10.12.13.41.05;	author wilfried;	state Exp;
branches;
next	1.42;

1.42
date	2001.10.12.13.40.14;	author wilfried;	state Exp;
branches;
next	1.41;

1.41
date	2001.10.05.23.25.12;	author naddy;	state Exp;
branches;
next	1.40;

1.40
date	2001.09.29.14.41.35;	author espie;	state Exp;
branches;
next	1.39;

1.39
date	2001.09.24.16.54.24;	author espie;	state Exp;
branches;
next	1.38;

1.38
date	2001.09.14.15.24.15;	author brad;	state Exp;
branches;
next	1.37;

1.37
date	2001.09.05.02.55.14;	author fgsch;	state Exp;
branches;
next	1.36;

1.36
date	2001.08.02.20.13.43;	author jasoni;	state Exp;
branches;
next	1.35;

1.35
date	2001.07.29.04.20.16;	author brad;	state Exp;
branches;
next	1.34;

1.34
date	2001.07.29.02.49.04;	author jasoni;	state Exp;
branches;
next	1.33;

1.33
date	2001.07.29.02.47.21;	author jasoni;	state Exp;
branches;
next	1.32;

1.32
date	2001.07.28.18.43.49;	author matt;	state Exp;
branches;
next	1.31;

1.31
date	2001.07.19.18.07.14;	author jasoni;	state Exp;
branches;
next	1.30;

1.30
date	2001.06.05.17.00.21;	author jasoni;	state Exp;
branches;
next	1.29;

1.29
date	2001.03.29.16.54.05;	author jasoni;	state Exp;
branches;
next	1.28;

1.28
date	2001.03.22.00.28.33;	author espie;	state Exp;
branches;
next	1.27;

1.27
date	2001.01.19.06.59.12;	author jasoni;	state Exp;
branches;
next	1.26;

1.26
date	2000.12.13.05.26.48;	author jasoni;	state Exp;
branches;
next	1.25;

1.25
date	2000.11.21.16.57.16;	author jasoni;	state Exp;
branches;
next	1.24;

1.24
date	2000.11.20.22.15.30;	author jasoni;	state Exp;
branches;
next	1.23;

1.23
date	2000.11.20.21.57.35;	author jasoni;	state Exp;
branches;
next	1.22;

1.22
date	2000.10.22.14.03.22;	author espie;	state Exp;
branches;
next	1.21;

1.21
date	2000.09.08.07.55.54;	author jasoni;	state Exp;
branches;
next	1.20;

1.20
date	2000.07.21.07.46.07;	author brad;	state Exp;
branches;
next	1.19;

1.19
date	2000.07.20.04.11.04;	author jasoni;	state Exp;
branches;
next	1.18;

1.18
date	2000.07.14.02.15.56;	author matt;	state Exp;
branches;
next	1.17;

1.17
date	2000.06.28.13.51.23;	author espie;	state Exp;
branches;
next	1.16;

1.16
date	2000.06.10.18.11.57;	author espie;	state Exp;
branches;
next	1.15;

1.15
date	2000.06.02.17.14.45;	author jasoni;	state Exp;
branches;
next	1.14;

1.14
date	2000.04.03.17.11.44;	author espie;	state Exp;
branches
	1.14.2.1;
next	1.13;

1.13
date	2000.03.27.18.17.28;	author espie;	state Exp;
branches;
next	1.12;

1.12
date	2000.03.24.23.28.14;	author espie;	state Exp;
branches;
next	1.11;

1.11
date	2000.03.08.05.42.05;	author jasoni;	state Exp;
branches;
next	1.10;

1.10
date	2000.03.05.18.30.31;	author espie;	state Exp;
branches;
next	1.9;

1.9
date	2000.02.15.05.04.38;	author turan;	state Exp;
branches;
next	1.8;

1.8
date	2000.02.12.06.29.57;	author turan;	state Exp;
branches;
next	1.7;

1.7
date	2000.02.12.00.43.59;	author espie;	state Exp;
branches;
next	1.6;

1.6
date	2000.02.11.00.37.28;	author espie;	state Exp;
branches;
next	1.5;

1.5
date	99.12.31.04.22.42;	author brad;	state Exp;
branches;
next	1.4;

1.4
date	99.12.25.02.34.05;	author brad;	state Exp;
branches;
next	1.3;

1.3
date	99.12.13.04.53.02;	author jasoni;	state Exp;
branches;
next	1.2;

1.2
date	99.02.23.04.24.10;	author marc;	state Exp;
branches;
next	1.1;

1.1
date	98.01.24.22.33.50;	author don;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	98.01.24.22.33.50;	author don;	state Exp;
branches;
next	;

1.14.2.1
date	2000.09.15.04.55.40;	author marc;	state Exp;
branches;
next	;


desc
@@


1.68
log
@Retire python 3.4 and 3.5, python 3.6 is the default python3 version
since 7 months, and nothing uses those anymore.
ok rpointel@@ (MAINTAINER) ajacoutot@@
@
text
@# $OpenBSD: Makefile,v 1.67 2016/12/26 19:42:49 rpointel Exp $

SUBDIR =
SUBDIR +=	2.7
SUBDIR +=	3.6

.include <bsd.port.subdir.mk>

@


1.67
log
@link Python 3.6 to the build
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.66 2015/09/23 19:24:41 rpointel Exp $
a4 2
SUBDIR +=	3.4
SUBDIR +=	3.5
@


1.66
log
@+3.5
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.65 2014/11/02 07:48:30 rpointel Exp $
d7 1
@


1.65
log
@unlink 3.3
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.64 2014/04/13 07:41:28 rpointel Exp $
d6 1
@


1.64
log
@link 3.4 to the build to have better test coverage on weird architectures.
ok sthen@@.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.63 2013/06/04 07:29:13 fgsch Exp $
a4 1
SUBDIR +=	3.3
@


1.63
log
@disconnect python 2.5 from the tree.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62 2013/05/30 14:45:07 ajacoutot Exp $
d6 1
@


1.62
log
@-3.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.61 2013/05/03 08:52:13 fgsch Exp $
a3 1
SUBDIR +=	2.5
@


1.61
log
@hook python 3.3.  3.2 is still the default until some issues are sorted
with 3.3.
needed by and ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.60 2011/12/20 13:08:06 fgsch Exp $
a5 1
SUBDIR +=	3.2
@


1.60
log
@RIP python2.4.
jasper@@ ok
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59 2011/09/21 14:39:06 fgsch Exp $
d7 1
@


1.59
log
@Move python 3.2 to the one under python
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2011/07/13 08:03:40 jasper Exp $
a3 1
SUBDIR +=	2.4
@


1.58
log
@sync
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.57 2011/05/15 08:25:45 rpointel Exp $
d7 1
@


1.57
log
@add python2.7 to the build.
ok landry@@ sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2010/02/01 17:00:13 espie Exp $
a5 1
SUBDIR +=	2.6
@


1.56
log
@SUBDIR += is wrong: it means the makefile will pick up SUBDIR from env, thus
breaking cd /usr/ports && SUBDIR=some/path make something for
category makefiles. While there, also put spaces around += uniformously.
okay naddy@@, jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55 2008/10/18 12:04:37 djm Exp $
d7 1
@


1.55
log
@out with 2.3
in with 2.6
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.54 2006/11/01 21:20:04 alek Exp $
d3 4
a6 3
SUBDIR+=	2.4
SUBDIR+=	2.5
SUBDIR+=	2.6
@


1.54
log
@Add 2.5
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2005/06/07 01:13:52 alek Exp $
a2 1
SUBDIR+=	2.3
d5 1
@


1.53
log
@Add 2.4
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.52 2005/05/22 12:01:13 alek Exp $
d5 1
@


1.52
log
@Please use lang/python/2.3

ok mbalmer@@, xsa@@, krw@@ and others too
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 2005/05/17 17:53:25 alek Exp $
d4 1
@


1.51
log
@Remove old version as we have newer ones.

ok mbalmer@@, krw@@ (and others too)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2003/12/31 17:40:20 sturm Exp $
a2 1
SUBDIR+=	2.2
@


1.50
log
@adapt to python 2.3
new subpackage -bsddb for python 2.3 only
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2002/02/15 19:42:18 matt Exp $
a2 1
SUBDIR+=	2.1
@


1.49
log
@Python 2.1.2 and Python 2.2.

Major changes:

- no more threads flavor, threads is now the default.

- subpackage modules that depend on other packages instead of having
largely redundant flavors (unless platform has no shared libs, then
flavors count again)

- shared libpython stuff disabled until someone can figure out why
it makes Zope crash
@
text
@d1 1
a1 1
# $OpenBSD$
d3 1
d5 1
a5 1
SUBDIR+=	2.1
@


1.48
log
@add regress target
@
text
@d1 1
a1 2
# $OpenBSD: Makefile,v 1.47 2001/11/06 17:40:31 shell Exp $
# Uses threads
d3 2
a4 2
COMMENT= 	"interpreted object-oriented programming language"
COMMENT-tools=	"extra tools for python"
d6 1
a6 10
VERSION=	2.1.1
PKGNAME=	python-${VERSION}
DISTNAME=	Python-${VERSION}
CATEGORIES=	lang
NEED_VERSION=	1.475
MASTER_SITES=	ftp://ftp.python.org/pub/%SUBDIR%/ \
		ftp://python.mirrors.netnumina.com/python/pub/%SUBDIR%/ \
		http://www.linux.org.hk/mirror/python/ftp/%SUBDIR%/
MASTER_SITE_SUBDIR= python/${VERSION}
EXTRACT_SUFX=	.tgz
a7 105
HOMEPAGE=	http://www.python.org/

MAINTAINER=	Jason Ish <jasoni@@openbsd.org>

PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes

FLAVORS=	tk threads no_tools
.if ${MACHINE_ARCH} == "i386"
FLAVOR?=	threads
.else
FLAVOR?=
.endif

# Don't package tools if not needed
.if empty(FLAVOR:L:Mno_tools)
MULTI_PACKAGES=	-tools
.endif

# The tools package is not flavor dependent.
FULLPKGNAME-tools=python-tools-${VERSION}
FULLPKGNAME=${PKGNAME}${FLAVOR_EXT:S/-no_tools//}

LIB_DEPENDS=	gmp::devel/gmp

.if ${FLAVOR:L:Mtk}
LIB_DEPENDS+=	tk83::x11/tk/8.3
SETUP_LOCAL+=	Setup.tk
.endif

CONFIGURE_STYLE= autoconf dest
CONFIGURE_ARGS+= ${CONFIGURE_SHARED}
CONFIGURE_ARGS+= --with-fpectl

REGRESS_TARGET=	test

# Threads support is compiled in by default only on i386 for now.
.if ${FLAVOR:L:Mthreads}
.if ${MACHINE_ARCH} != "i386"
BROKEN="Support for ${MACHINE_ARCH} threads is currently broken"
.else
CONFIGURE_ARGS+= --with-threads
.endif
.else
CONFIGURE_ARGS+= --without-threads
.endif

.if ${MACHINE_ARCH} == "alpha" || ${MACHINE_ARCH} == "sparc64"
NO64BIT=	\#
.endif

ALL_TARGET=	all ./Lib/plat-openbsd3

pre-configure:
	@@echo ""
	@@echo "***"
	@@echo "*** Building Python with ${FLAVOR}"
	@@echo "***"
	@@echo "*** You can set ${FLAVORS} by typing"
	@@echo "*** env FLAVOR=\"set of options\" ${MAKE_PROGRAM}"
	@@echo "***"
	@@echo ""

post-configure:
	@@sed -e 's,@@NOSHARED@@,${NOSHARED},g' \
	     -e 's,@@NO64BIT@@,${NO64BIT},g'   \
		${FILESDIR}/Setup > ${WRKSRC}/Modules/Setup
.for file in ${SETUP_LOCAL}
	@@sed -e 's,@@NOSHARED@@,${NOSHARED},g' \
		${FILESDIR}/${file} >> ${WRKSRC}/Modules/Setup.local
.endfor
	@@cd ${WRKSRC} && ${MAKE_PROGRAM} Makefile

patch:

post-install:
	${INSTALL_SCRIPT} ${WRKSRC}/Tools/scripts/pydoc ${PREFIX}/bin
	${INSTALL_DATA} ${WRKSRC}/libpython2.1.a ${PREFIX}/lib/python2.1/config
	@@if [ -f ${PREFIX}/lib/python2.1/config/libpython2.1.so.0.0 ]; then \
		cd ${PREFIX}/lib && ln -s python2.1/config/libpython2.1.so.0.0; \
	fi
	@@strip ${PREFIX}/bin/python
	@@cd ${WRKSRC}; tar -cf - Tools | (cd ${PREFIX}/lib/python2.1; \
		tar -xf -)
	 
.include <bsd.port.mk>

.if defined(NO64BIT)
SED_PLIST+=-e '/%%mm%%/d'
.else
SED_PLIST+=-e '/%%mm%%/r${PKGDIR}/PFRAG.mm' -e '//d'
.endif

.if defined(NO_SHARED_LIBS) && ${NO_SHARED_LIBS:U} == YES
NOSHARED=	\#
CONFIGURE_ENV+=	OPT='${CFLAGS}' LDFLAGS='-L${WRKSRC}'
.else
CONFIGURE_ENV+=	OPT='${CFLAGS} -fPIC' LDFLAGS='-L${WRKSRC}'
MAKE_FLAGS+= MAJOR=0 MINOR=0 LDLIBRARY=libpython2.1.so.0.0 \
	LD_LIBRARY_PATH=${WRKSRC}
FAKE_FLAGS+= MAJOR=0 MINOR=0 LDLIBRARY=libpython2.1.so.0.0 \
	LD_LIBRARY_PATH=${WRKSRC} RANLIB=:
.endif
@


1.47
log
@oops.. missed '\' in my last commit.
reported by Kenneth R Westerback <kwesterback@@home.com>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2001/11/05 22:46:53 shell Exp $
d52 3
a54 1
CONFIGURE_ARGS+= --with-fpectl 
@


1.46
log
@new MASTER_SITES, ok jasoni@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2001/10/27 03:01:53 brad Exp $
d13 1
a13 1
		ftp://python.mirrors.netnumina.com/python/pub/%SUBDIR%/
@


1.45
log
@- only enable threads FLAVOR by default on i386.
- mark threads usage BROKEN on anything other than i386 for now.
- suggest using env when trying to set FLAVOR variable from command line.
- simplify Makefile a bit and push some of it out into the autoconf script where it properly
belongs.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2001/10/16 16:34:01 brad Exp $
d14 1
@


1.44
log
@fix dependency entries for gmp. BUILD_DEPENDS -> LIB_DEPENDS.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2001/10/12 13:41:05 wilfried Exp $
d11 1
a11 1
NEED_VERSION=	1.413
d27 3
a29 1
.if ${MACHINE_ARCH} == "sparc" || ${MACHINE_ARCH} == "sparc64"
a30 2
.else
FLAVOR?=	threads
d33 1
a33 1
# don't package tools if not needed
d42 2
d45 1
a45 1
LIB_DEPENDS=	tk83::x11/tk/8.3
d53 1
a53 4
LIB_DEPENDS+=	gmp::devel/gmp

# If libc_r exists, thread support is compiled in by default unless this
# is a SPARC system where threads are currently non functional.
d55 1
a55 1
.if (${MACHINE_ARCH} == "sparc" || ${MACHINE_ARCH} == "sparc64")
a56 2
.elif !exists(/usr/lib/libc_r.a) 
BROKEN="No thread support on this machine"
d68 1
a68 1
ALL_TARGET=all ./Lib/plat-openbsd3
d76 1
a76 1
	@@echo "*** FLAVOR=\"set of options\" ${MAKE_PROGRAM}"
d93 2
a94 2
	@@${INSTALL_SCRIPT} ${WRKSRC}/Tools/scripts/pydoc ${PREFIX}/bin
	@@${INSTALL_DATA} ${WRKSRC}/libpython2.1.a ${PREFIX}/lib/python2.1/config
a97 1

a101 1

d112 1
a112 2
CONFIGURE_ENV+=	OPT='${CFLAGS}' LDSHARED="cc -shared -fPIC" \
    LDFLAGS='-L${WRKSRC}'
d114 1
a114 2
CONFIGURE_ENV+= OPT='${CFLAGS} -fPIC' LDSHARED='cc -shared -fPIC' \
	LDFLAGS='-L${WRKSRC}'
a119 1

@


1.43
log
@sparc64 is a 64bit platform, ok espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2001/10/12 13:40:14 wilfried Exp $
d51 1
a51 1
BUILD_DEPENDS=	::devel/gmp
@


1.42
log
@Don't use threads as default FLAVOR for sparc/sparc64, ok espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2001/10/05 23:25:12 naddy Exp $
d67 1
a67 1
.if ${MACHINE_ARCH} == "alpha"
@


1.41
log
@-fPIC, damn it
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2001/09/29 14:41:35 espie Exp $
d27 3
d31 1
d56 1
a56 1
.if (${MACHINE_ARCH} == "sparc") 
@


1.40
log
@python lib is large enough to necessitate PIC on sparc.
found my naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2001/09/24 16:54:24 espie Exp $
d116 1
a116 1
CONFIGURE_ENV+= OPT='${CFLAGS} -fpic' LDSHARED='cc -shared -fPIC' \
@


1.39
log
@shared libpython. ok jasoni@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2001/09/14 15:24:15 brad Exp $
d113 1
a113 1
CONFIGURE_ENV+=	OPT='${CFLAGS}' LDSHARED="cc -shared -fpic" \
d116 1
a116 1
CONFIGURE_ENV+= OPT='${CFLAGS} -fpic' LDSHARED='cc -shared -fpic' \
@


1.38
log
@typo
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2001/09/05 02:55:14 fgsch Exp $
a45 1
CONFIGURE_ENV+=	OPT='${CFLAGS}' LDSHARED="cc -shared -fpic"
d47 1
a47 1
BUILD_DEPENDS=	${LOCALBASE}/lib/libgmp.a::devel/gmp
d67 2
a78 1
# Depends on NO_SHARED_LIBS.
d80 8
a87 1
	cd ${.CURDIR} && ${MAKE_PROGRAM} finish-setup
d93 5
d101 1
d113 9
a122 10

finish-setup:
	@@sed -e 's,@@NOSHARED@@,${NOSHARED},g' \
	     -e 's,@@NO64BIT@@,${NO64BIT},g'   \
		${FILESDIR}/Setup > ${WRKSRC}/Modules/Setup
.for file in ${SETUP_LOCAL}
	@@sed -e 's,@@NOSHARED@@,${NOSHARED},g' \
		${FILESDIR}/${file} >> ${WRKSRC}/Modules/Setup.local
.endfor
	@@cd ${WRKSRC}; ${MAKE_PROGRAM} Makefile
@


1.37
log
@Uses threads.
@
text
@d1 2
a2 2
# $OpenBSD: Makefile,v 1.36 2001/08/02 20:13:43 jasoni Exp $
# Use threads
@


1.36
log
@add another master site
@
text
@d1 2
a2 1
# $OpenBSD: Makefile,v 1.35 2001/07/29 04:20:16 brad Exp $
@


1.35
log
@- make -> ${MAKE_PROGRAM}
- remove subshell
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2001/07/29 02:49:04 jasoni Exp $
d11 3
a13 1
MASTER_SITES=	ftp://ftp.python.org/pub/python/${VERSION}/
@


1.34
log
@oops, remove unneeded commented out line
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2001/07/29 02:47:21 jasoni Exp $
d10 1
a10 1
NEED_VERSION=	1.405
d71 1
a71 1
	@@echo "*** FLAVOR=\"set of options\" make"
d77 1
a77 1
	cd ${.CURDIR} && make finish-setup
d107 1
a107 1
	(cd ${WRKSRC}; make Makefile)
@


1.33
log
@update to 2.1.1; bugfix release
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2001/07/28 18:43:49 matt Exp $
a45 2

#WRKDIST=	${WRKDIR}/Python-${VERSION}
@


1.32
log
@modernize, resp CFLAGS, use cc instead of ld for so's (ok jasoni@@)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2001/07/19 18:07:14 jasoni Exp $
d6 1
a6 1
VERSION=	2.1
d86 1
a86 1
	@@cd ${WRKSRC}; tar -cf - Tools | (cd ${PREFIX}/lib/python${VERSION}; \
@


1.31
log
@fix flavor message; thanks heko@@iki.fi
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2001/06/05 17:00:21 jasoni Exp $
d10 1
a10 1
NEED_VERSION=	1.363
d40 1
a40 1
CONFIGURE_STYLE= gnu dest
d43 1
a43 1
MAKE_FLAGS+=	OPT="${CFLAGS}"
d109 2
a110 1
	(cd ${WRKSRC}; make Makefile)@


1.30
log
@Upgrade to Python v2.1.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2001/03/29 16:54:05 jasoni Exp $
d71 3
a73 2
	@@echo "*** You can set ${FLAVORS} by saying"
	@@echo "*** make FLAVOR=\"set of options\""
@


1.29
log
@move comment to makefile
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2001/03/22 00:28:33 espie Exp $
d6 3
a8 2
VERSION=	2.0
DISTNAME=	python-${VERSION}
d11 2
a12 1
MASTER_SITES=	ftp://www.python.org/pub/python/src/ 
d47 1
a47 1
WRKDIST=	${WRKDIR}/Python-${VERSION}
d80 2
d83 1
d85 3
a87 2
	@@cd ${WRKSRC}; tar -cf - Tools | (cd ${PREFIX}/lib/python${VERSION}; tar -xf -)
	
d108 1
@


1.28
log
@Use new bsd.port.mk to set FULLPKGNAME correctly.
@
text
@d1 4
a4 1
# $OpenBSD: Makefile,v 1.27 2001/01/19 06:59:12 jasoni Exp $
@


1.27
log
@- depend on gmp port
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2000/12/13 05:26:48 jasoni Exp $
d6 1
a6 1
NEED_VERSION=	1.310
d26 4
a79 8

# The tools package is not flavor dependent.
.if defined(SUBPACKAGE) && ${SUBPACKAGE} == "-tools"
PKGNAME=python-tools-${VERSION}
.endif
.if ${FLAVOR:L:Mno_tools}
PKGNAME:=${PKGNAME:S/-no_tools//}
.endif
@


1.26
log
@- Remove Python 2.0 from python2, this was a mistake.
- Move Python 2.0 to python.
- Remove Python 1.6
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2000/12/04 03:36:42 jasoni Exp $
d35 2
@


1.25
log
@- fix glitch in revert
- add a second master_site
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2000/10/22 14:03:22 espie Exp $
d3 2
a4 2
DISTNAME=	Python-1.6
PKGNAME=	python-1.6
d7 1
a7 2
MASTER_SITES=	ftp://www.python.org/pub/python/src/ \
		ftp://ftp.cwi.nl/pub/python/src/
d36 1
a36 1
WRKDIST=	${WRKDIR}/Python-1.6
d46 1
a46 1
CONFIGURE_ARGS+= --with-thread
d48 2
d71 1
a71 1
	@@cd ${WRKSRC}; tar -cf - Tools | (cd ${PREFIX}/lib/python1.6; tar -xf -)
d77 1
a77 1
PKGNAME=python-tools-1.6
@


1.24
log
@- Revert back to Python 1.6
- 2.0 will be imported separately
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2000/09/08 07:55:54 jasoni Exp $
d7 2
a8 1
MASTER_SITES=	ftp://www.python.org/pub/python/src/ 
d12 1
a12 1
MAINTAINER=	jasoni@@openbsd.org
a66 5

post-build:
	@@cd ${WRKDIST} && \
		${SETENV} ${MAKE_ENV} ${MAKE_PROGRAM} \
		${FAKE_FLAGS} -f ${MAKE_FILE} test
@


1.23
log
@- Update to Python 2.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2000/10/22 14:03:22 espie Exp $
d3 2
a4 2
VERSION=	2.0
DISTNAME=	python-${VERSION}
d11 1
a11 1
MAINTAINER=	Jason Ish <jasoni@@openbsd.org>
d36 1
a36 1
WRKDIST=	${WRKDIR}/Python-${VERSION}
d38 2
a39 1
# If libc_r exists, thread support is compiled in by default.
d41 3
a43 1
.if !exists(/usr/lib/libc_r.a) 
d46 1
a46 1
CONFIGURE_ARGS+= --with-threads
a47 2
.else
CONFIGURE_ARGS+= --without-threads
d67 5
d74 1
a74 1
	@@cd ${WRKSRC}; tar -cf - Tools | (cd ${PREFIX}/lib/python${VERSION}; tar -xf -)
d80 1
a80 1
PKGNAME=python-tools-${VERSION}
@


1.22
log
@Complete a few MAINTAINER names.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2000/09/08 07:55:54 jasoni Exp $
d3 2
a4 2
DISTNAME=	Python-1.6
PKGNAME=	python-1.6
d36 1
a36 1
WRKDIST=	${WRKDIR}/Python-1.6
d38 1
a38 2
# If libc_r exists, thread support is compiled in by default unless this
# is a SPARC system where threads are currently non functional.
d40 1
a40 3
.if (${MACHINE_ARCH} == "sparc") 
BROKEN="Support for ${MACHINE_ARCH} threads is currently broken"
.elif !exists(/usr/lib/libc_r.a) 
d43 1
a43 1
CONFIGURE_ARGS+= --with-thread
d45 2
d68 1
a68 1
	@@cd ${WRKSRC}; tar -cf - Tools | (cd ${PREFIX}/lib/python1.6; tar -xf -)
d74 1
a74 1
PKGNAME=python-tools-1.6
@


1.21
log
@- Update to Python 1.6
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2000/07/21 07:46:07 brad Exp $
d11 1
a11 1
MAINTAINER=	jasoni@@openbsd.org
@


1.20
log
@- bump NEED_VERSION
- remove empty LIB_DEPENDS line
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2000/07/20 04:11:04 jasoni Exp $
d3 2
a4 2
DISTNAME=	py152
PKGNAME=	python-1.5.2
d7 1
a7 3
MASTER_SITES=	ftp://www.python.org/pub/python/src/ \
		ftp://ftp.cwi.nl/pub/python/src/
EXTRACT_SUFX=	.tgz
d18 2
a19 2
FLAVORS=	tk mpz threads no_tools
FLAVOR?=	threads mpz
d27 1
a27 1
LIB_DEPENDS=	tk80.1.5::x11/tk/8.0
d36 1
a36 1
WRKDIST=	${WRKDIR}/Python-1.5.2
a49 5
# The mpz module will be built when flavor is specified.
.if ${FLAVOR:L:Mmpz}
SETUP_LOCAL+=	Setup.gmp
.endif

d60 1
d69 1
a69 1
	@@cd ${WRKSRC}; tar -cf - Tools | (cd ${PREFIX}/lib/python1.5; tar -xf -)
d75 1
a75 1
PKGNAME=python-tools-1.5.2
@


1.19
log
@- remove LICENSE_TYPE
- remove FAKE=Yes
- HAS_CONFIGURE -> CONFIGURE_STYLE
- add homepage to DESCR
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2000/07/14 02:15:56 matt Exp $
d6 1
a6 1
NEED_VERSION=	1.302
d20 2
a21 2
FLAVORS=tk mpz threads no_tools
FLAVOR?=threads mpz
a27 2
LIB_DEPENDS=

d29 1
a29 1
LIB_DEPENDS+=	tk80.1.5::x11/tk/8.0
@


1.18
log
@no-tools -> no_tools (FLAVOR); hyphens used as delimiter in package name

Approved-By: jasoni
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2000/06/28 13:51:23 espie Exp $
a14 1
LICENSE_TYPE=		BSD
d35 1
a35 2
FAKE=		Yes
HAS_CONFIGURE=	Yes
a36 1
CONFIGURE_ARGS+= --prefix='$${DESTDIR}${PREFIX}'
@


1.17
log
@Kill PLIST.sed
Add @@comment

Simplify ruby build, now that bsd.port.mk has proper support
for variable substitutions.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2000/06/10 18:11:57 espie Exp $
d21 1
a21 1
FLAVORS=tk mpz threads no-tools
d25 1
a25 1
.if empty(FLAVOR:L:Mno-tools)
d88 2
a89 2
.if ${FLAVOR:L:Mno-tools}
PKGNAME:=${PKGNAME:S/-no-tools//}
@


1.16
log
@Add `no-tools' pseudo-flavor to avoid registering the same package three
times.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2000/06/02 17:14:45 jasoni Exp $
d6 1
a6 1
NEED_VERSION=	1.270
@


1.15
log
@Enable the gmp module.
Remove the tools flavor in favor of a tools package.
Don't enable Tk flavor by default.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2000/04/03 17:11:44 espie Exp $
a10 2
MULTI_PACKAGES=	-tools

d21 1
a21 1
FLAVORS=tk mpz threads
d24 5
d87 3
@


1.14
log
@FLAVORed python.
- mark mpz flavor as broken currently (?)
- register tools as a flavor, where it should build a separate package.
But the required framework is not finished yet.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2000/03/27 18:17:28 espie Exp $
d6 1
a6 1
NEED_VERSION=	1.251
d11 4
d23 2
a24 4
FLAVORS=tk tools mpz threads

# Support for Tk is compiled in by default.
FLAVOR?=tk tools threads
a39 1

d54 1
a54 1
# The mpz module will be built on machines with a full source tree.
a55 2
.  if exists(/usr/src/gnu/lib/libgmp/mpn/generic/gmp-mparam.h)
BROKEN="Currently disabled"
a56 3
.  else
BROKEN="Need a full source tree for that module"
.  endif
a76 1
.if ${FLAVOR:L:Mtools}
a77 1
.endif
d81 5
a103 1

@


1.14.2.1
log
@bring lang as of cut-over date into 2.7 branch
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2000/07/21 07:46:07 brad Exp $
d6 1
a6 1
NEED_VERSION=	1.310
a10 2
HOMEPAGE=	http://www.python.org/

d13 1
d19 4
a22 2
FLAVORS=	tk mpz threads no_tools
FLAVOR?=	threads mpz
d24 1
a24 4
# don't package tools if not needed
.if empty(FLAVOR:L:Mno_tools)
MULTI_PACKAGES=	-tools
.endif
d27 1
a27 1
LIB_DEPENDS=	tk80.1.5::x11/tk/8.0
d31 2
a32 1
CONFIGURE_STYLE= gnu dest
d34 1
d38 1
d53 1
a53 1
# The mpz module will be built when flavor is specified.
d55 2
d58 3
d81 1
d83 1
a86 8
# The tools package is not flavor dependent.
.if defined(SUBPACKAGE) && ${SUBPACKAGE} == "-tools"
PKGNAME=python-tools-1.5.2
.endif
.if ${FLAVOR:L:Mno_tools}
PKGNAME:=${PKGNAME:S/-no_tools//}
.endif

d105 1
@


1.13
log
@Fix tcl/tk 8.0 and 8.3 dependencies...

tcl/tk 8.2 still needs to be updated to 8.3 to fully clean up that mess.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2000/03/24 23:28:14 espie Exp $
d6 1
a6 1
NEED_VERSION=	1.230
d19 11
a29 1
LIB_DEPENDS=	${TK_DEPENDS}
a37 1
PLIST=	${WRKDIR}/PLIST
a40 7
# Support for Tk is compiled in by default.
WITH_TK?=	Yes
.if ${WITH_TK:U} == YES
TK_DEPENDS=	tk80.1.5::x11/tk/8.0
SETUP_LOCAL+=	Setup.tk
.endif

d43 5
a47 2
.if (${MACHINE_ARCH} == "sparc")
WITH_THREADS?=	No
d49 1
a49 1
WITH_THREADS?=	Yes
a50 2
.if exists(/usr/lib/libc_r.a) && defined(WITH_THREADS) && ${WITH_THREADS:U} == YES
CONFIGURE_ARGS+= --with-thread
d54 7
a60 10
# Currently disabled.
#.if exists(/usr/src/gnu/lib/libgmp/mpn/generic/gmp-mparam.h)
#WITH_MPZ=	Yes
#SETUP_LOCAL+=	Setup.gmp
#.endif

# Install additional tools be default.
WITH_TOOLS?=	Yes
.if defined(WITH_TOOLS) && ${WITH_TOOLS:U} == YES
PLIST_TOOLS=	PLIST.Tools
d70 3
a72 9
	@@echo "*** Python is built with support for Tk and threads"
	@@echo "*** (if you have threads) by default.  The optional"
	@@echo "*** Python tools will also be installed by default"
	@@echo "*** To turn these options off, set the approriate"
	@@echo "*** variable to 'no'."
	@@echo "*** 		WITH_TK=no"
	@@echo "***		WITH_THREADS=no"
	@@echo "***		WITH_TOOLS=no"
	@@echo "***"
d77 1
d81 1
a81 1
.if defined(WITH_TOOLS) && ${WITH_TOOLS:L} == yes
d87 6
a94 3
PLIST_PRE=	${FILESDIR}/PLIST.noshared
.else
PLIST_PRE=	${FILESDIR}/PLIST
d97 1
a97 1
post-configure:
d105 1
a105 17
	@@cp ${PLIST_PRE} ${PLIST}
.if !defined(NO_SHARED_LIBS)
.if !defined(NO64BIT)
	@@cat ${FILESDIR}/PLIST.mm >> ${PLIST}
.endif
.if defined(WITH_TK) && ${WITH_TK:U} == YES
	@@cat ${FILESDIR}/PLIST.tk >> ${PLIST}
.endif
.if defined(WITH_GMP) && ${WITH_GMP:U} == YES
	@@cat ${FILESDIR}/PLIST.gmp >> ${PLIST}
.endif
.endif
.if defined(WITH_TOOLS) && ${WITH_TOOLS} == YES
	@@cat ${FILESDIR}/PLIST.Tools >> ${PLIST}
.endif
	@@sort -r -o ${PLIST}.new ${PLIST}
	@@mv ${PLIST}.new ${PLIST}
@


1.12
log
@Introduce :: in *_DEPENDS as a place holder for a package spec
Bump NEED_VERSION.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2000/03/08 05:42:05 jasoni Exp $
d6 1
a6 1
NEED_VERSION=	 1.230
d35 1
a35 1
TK_DEPENDS=	tk80.1.5::x11/tk80
@


1.11
log
@Fake.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2000/03/05 18:30:31 espie Exp $
d6 1
a6 1
NEED_VERSION=	1.223
d35 1
a35 1
TK_DEPENDS=	tk80.1.5:x11/tk80
@


1.10
log
@PORTSDIR no longer needed in *DEPENDS.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2000/02/15 05:04:38 turan Exp $
d21 2
a22 1
GNU_CONFIGURE=	Yes
d24 1
@


1.9
log
@espie will not shut up about this, DISTF -> DISTFILES, PKG -> PACKAGE
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2000/02/12 06:29:57 turan Exp $
d6 1
a9 1
NEED_VERSION=	1.195
d14 4
a17 4
PERMIT_PACKAGE_CDROM=	YES
PERMIT_PACKAGE_FTP=	YES
PERMIT_DISTFILES_CDROM=	YES
PERMIT_DISTFILES_FTP=	YES
d21 1
a21 1
GNU_CONFIGURE=	yes
d32 2
a33 2
.if defined(WITH_TK) && ${WITH_TK:U} == YES
TK_DEPENDS=	tk80.1.5:${PORTSDIR}/x11/tk80
@


1.8
log
@bsd licenses
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2000/02/12 00:43:59 espie Exp $
d14 4
a17 4
PERMIT_PKG_CDROM=	YES
PERMIT_PKG_FTP=		YES
PERMIT_DISTF_CDROM=	YES
PERMIT_DISTF_FTP=	YES
@


1.7
log
@Change MAKE_FLAGS to remove the -f.

Actually reading the Makefiles proved that about one third of them was
confused about this already...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2000/02/11 00:37:28 espie Exp $
d12 6
@


1.6
log
@Use WRKDIST where appropriate.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 1999/12/31 04:22:42 brad Exp $
d9 1
a9 1
NEED_VERSION=	1.191
@


1.5
log
@- make sure the PLIST that is created is done so in the work dir
- add check for ${NO_SHARED_LIBS:U} == YES
- sort final PLIST and output as PLIST.new, then move into place
- sort PLIST and PLIST.noshared
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 1999/12/25 02:34:05 brad Exp $
d9 1
d22 1
a22 1
WRKSRC=	${WRKDIR}/Python-1.5.2
@


1.4
log
@- cleanup Makefile
- remove deprecated variables
- disable use of threads on SPARC
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 1999/12/13 04:53:02 jasoni Exp $
d19 2
d83 1
a83 1
.if defined(NO_SHARED_LIBS)
d113 2
a114 1
	@@sort -r -o ${PLIST} ${PLIST}
@


1.3
log
@- Update to v 1.5.2.
- Clean up and remove FreeBSD stuff.
@
text
@d1 1
a1 2
# $OpenBSD: Makefile,v 1.2 1999/02/23 04:24:10 marc Exp $
#
d3 17
a19 14
DISTNAME=		py152
PKGNAME=		python-1.5.2
CATEGORIES=		lang
MASTER_SITES=		ftp://www.python.org/pub/python/src/ \
			ftp://ftp.cwi.nl/pub/python/src/
EXTRACT_SUFX=		.tgz

MAINTAINER=		jasoni@@openbsd.org

LIB_DEPENDS=		${TK_DEPENDS}
WRKSRC=			${WRKDIR}/Python-1.5.2
GNU_CONFIGURE=		YES
CONFIGURE_ARGS+=	${CONFIGURE_SHARED} --with-fpectl 
MAKE_FLAGS+=		"OPT=${CFLAGS}"
d22 1
a22 1
WITH_TK?=		YES	
d24 2
a25 2
TK_DEPENDS=		tk80\\.1\\.:${PORTSDIR}/x11/tk80
SETUP_LOCAL+=		Setup.tk
d28 7
a34 2
# If libc_r exists, thread support is compiled in by default.
WITH_THREADS?=		YES
d36 1
a36 1
CONFIGURE_ARGS+=	--with-thread
d42 2
a43 2
#WITH_MPZ=		YES
#SETUP_LOCAL+=		Setup.gmp
d47 1
a47 1
WITH_TOOLS?=		YES
d49 1
a49 1
PLIST_TOOLS=		PLIST.Tools
d53 1
a53 1
NO64BIT=		\#
d57 12
a68 12
	@@${ECHO}
	@@${ECHO} "***"
	@@${ECHO} "*** Python is built with support for Tk and threads"
	@@${ECHO} "*** (if you have threads) by default.  The optional"
	@@${ECHO} "*** Python tools will also be installed by default"
	@@${ECHO} "*** To turn these options off, set the approriate"
	@@${ECHO} "*** variable to 'no'."
	@@${ECHO} "*** 		WITH_TK=no"
	@@${ECHO} "***		WITH_THREADS=no"
	@@${ECHO} "***		WITH_TOOLS=no"
	@@${ECHO} "***"
	@@${ECHO}
d74 1
a74 1
	strip ${PREFIX}/bin/python
d76 1
a76 1
	@@cd ${WRKSRC}; tar cf - Tools | (cd ${PREFIX}/lib/python1.5; tar xf -)
d82 2
a83 2
NOSHARED=		\#
PLIST_PRE=		${FILESDIR}/PLIST.noshared
d85 1
a85 1
PLIST_PRE=		${FILESDIR}/PLIST
d89 3
a91 3
	@@${SED} -e 's,@@NOSHARED@@,${NOSHARED},g' \
	        -e 's,@@NO64BIT@@,${NO64BIT},g'   \
	       ${FILESDIR}/Setup > ${WRKSRC}/Modules/Setup
d93 2
a94 2
	@@${SED} -e 's,@@NOSHARED@@,${NOSHARED},g' \
	       ${FILESDIR}/${file} >> ${WRKSRC}/Modules/Setup.local
d96 1
a96 1
	@@${CP} ${PLIST_PRE} ${PLIST}
d99 1
a99 1
	@@${CAT} ${FILESDIR}/PLIST.mm >> ${PLIST}
d102 1
a102 1
	@@${CAT} ${FILESDIR}/PLIST.tk >> ${PLIST}
d105 1
a105 1
	@@${CAT} ${FILESDIR}/PLIST.gmp >> ${PLIST}
d109 1
a109 1
	@@${CAT} ${FILESDIR}/PLIST.Tools >> ${PLIST}
@


1.2
log
@verify sources, build, install, and uninstall
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 1998/01/24 22:33:50 don Exp $
d4 14
a17 17
DISTNAME=	python1.5
PKGNAME=	python-1.5
CATEGORIES=	lang tk80
MASTER_SITES=	ftp://www.python.org/pub/python/src/ \
		ftp://ftp.cwi.nl/pub/python/src/

MAINTAINER=	don@@OpenBSD.ORG

LIB_DEPENDS=	${TK_DEPENDS}

EXTRACT_ONLY=	${DISTNAME}${EXTRACT_SUFX}
WRKSRC=		${WRKDIR}/Python-1.5
GNU_CONFIGURE=	yes
CONFIGURE_ARGS=	--with-fpectl
MAKE_FLAGS=	'OPT=${CFLAGS}'
INSTALL_TARGET=	install
MAN1=		python.1
a18 6
#
# The standard setup file
#
SETUP_FILE=	Setup

#
d20 4
a23 5
#
WITH_TK?=	yes
.if defined(WITH_TK) && $(WITH_TK) == yes
TK_DEPENDS=	tk80\\.1\\.:${PORTSDIR}/x11/tk80
SETUP_LOCAL=	Setup.tk
d26 3
a28 9
#
# If you want to use Python's thread module, you need to set WITH_THREADS
# to 'yes', and you must have the FreeBSD threading c library (libc_r)
# installed. See 'man 3 pthread' for details on libc_r.
#
# This option is enabled by default.
#
WITH_THREADS?=	yes
.if exists(/usr/lib/libc_r.a) && defined(WITH_THREADS) && ${WITH_THREADS} == yes
d32 15
a46 5
#
# The mpz module is built on machines with a full source tree
#
.if exists(/usr/src/contrib/libgmp/gmp-impl.h)
SETUP_LOCAL+=	Setup.gmp
d49 15
a64 4
	${CP} ${FILESDIR}/${SETUP_FILE} ${WRKSRC}/Modules/Setup
.for file in ${SETUP_LOCAL}
	${CAT} ${FILESDIR}/${file} >> ${WRKSRC}/Modules/Setup.local
.endfor
d68 5
d74 31
a104 1
.include <bsd.port.mk>
@


1.1
log
@Initial revision
@
text
@d1 1
a1 6
# OpenBSD makefile for:	python
# Version required:	1.5
# Date created:		9 January 1998
# Whom:			Don Schmidt
#
# $OpenBSD$
@


1.1.1.1
log
@Initial import
@
text
@@
