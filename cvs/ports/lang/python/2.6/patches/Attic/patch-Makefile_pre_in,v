head	1.4;
access;
symbols
	OPENBSD_4_9:1.3.0.4
	OPENBSD_4_9_BASE:1.3
	OPENBSD_4_8:1.3.0.2
	OPENBSD_4_8_BASE:1.3
	OPENBSD_4_7:1.2.0.4
	OPENBSD_4_7_BASE:1.2
	OPENBSD_4_6:1.2.0.2
	OPENBSD_4_6_BASE:1.2
	OPENBSD_4_5:1.1.0.2
	OPENBSD_4_5_BASE:1.1;
locks; strict;
comment	@# @;


1.4
date	2011.07.13.08.03.32;	author jasper;	state dead;
branches;
next	1.3;

1.3
date	2010.07.23.13.56.26;	author sthen;	state Exp;
branches;
next	1.2;

1.2
date	2009.05.03.22.26.27;	author djm;	state Exp;
branches;
next	1.1;

1.1
date	2008.10.18.12.03.56;	author djm;	state Exp;
branches;
next	;


desc
@@


1.4
log
@Retire this version of the 2.x family. All ports either use the
default (2.7) or are using an even older version (2.4/2.5) so 2.6 can go.

ok sthen@@ rpointel@@
@
text
@$OpenBSD: patch-Makefile_pre_in,v 1.3 2010/07/23 13:56:26 sthen Exp $
--- Makefile.pre.in.orig	Thu Dec 24 14:19:38 2009
+++ Makefile.pre.in	Thu Jun 17 13:51:01 2010
@@@@ -350,6 +350,8 @@@@ LIBRARY_OBJS=	\
 #########################################################################
 # Rules
 
+everything: all $(srcdir)/Lib/$(PLATDIR)
+
 # Default target
 all:		build_all
 build_all:	$(BUILDPYTHON) oldsharedmods sharedmods
@@@@ -385,7 +387,7 @@@@ coverage:
 $(BUILDPYTHON):	Modules/python.o $(LIBRARY) $(LDLIBRARY)
 		$(LINKCC) $(LDFLAGS) $(LINKFORSHARED) -o $@@ \
 			Modules/python.o \
-			$(BLDLIBRARY) $(LIBS) $(MODLIBS) $(SYSLIBS) $(LDLAST)
+			-lpython$(VERSION) $(LIBS) $(MODLIBS) $(SYSLIBS) $(LDLAST)
 
 platform: $(BUILDPYTHON)
 	$(RUNSHARED) ./$(BUILDPYTHON) -E -c 'import sys ; from distutils.util import get_platform ; print get_platform()+"-"+sys.version[0:3]' >platform
@@@@ -425,6 +427,11 @@@@ libpython$(VERSION).dylib: $(LIBRARY_OBJS)
 libpython$(VERSION).sl: $(LIBRARY_OBJS)
 	$(LDSHARED) $(LDFLAGS) -o $@@ $(LIBRARY_OBJS) $(MODLIBS) $(SHLIBS) $(LIBC) $(LIBM) $(LDLAST)
 
+# This rule for OpenBSD...
+$(LDLIBRARY):      $(LIBRARY)
+	$(LDSHARED) -o $@@ $(LIBRARY_OBJS)
+
+
 # This rule is here for OPENSTEP/Rhapsody/MacOSX. It builds a temporary
 # minimal framework (not including the Lib directory and such) in the current
 # directory.
@@@@ -760,14 +767,13 @@@@ bininstall:	altbininstall
 	then rm -f $(DESTDIR)$(BINDIR)/$(PYTHON); \
 	else true; \
 	fi
-	(cd $(DESTDIR)$(BINDIR); $(LN) python$(VERSION)$(EXE) $(PYTHON))
 	-rm -f $(DESTDIR)$(BINDIR)/python-config
 	(cd $(DESTDIR)$(BINDIR); $(LN) -s python$(VERSION)-config python-config)
 
 # Install the interpreter with $(VERSION) affixed
 # This goes into $(exec_prefix)
 altbininstall:	$(BUILDPYTHON)
-	@@for i in $(BINDIR) $(LIBDIR); \
+	@@for i in $(BINDIR) $(LIBDIR) $(LIBPL); \
 	do \
 		if test ! -d $(DESTDIR)$$i; then \
 			echo "Creating directory $$i"; \
@@@@ -783,7 +789,8 @@@@ altbininstall:	$(BUILDPYTHON)
 			$(INSTALL_SHARED) $(LDLIBRARY) $(DESTDIR)$(LIBDIR)/$(INSTSONAME); \
 			if test $(LDLIBRARY) != $(INSTSONAME); then \
 				(cd $(DESTDIR)$(LIBDIR); $(LN) -sf $(INSTSONAME) $(LDLIBRARY)) \
-			fi \
+			fi ; \
+			(cd $(DESTDIR)$(LIBPL); $(LN) -sf $(LIBDIR)/$(LDLIBRARY)) \
 		fi; \
 	else	true; \
 	fi
@@@@ -799,7 +806,7 @@@@ maninstall:
 		fi; \
 	done
 	$(INSTALL_DATA) $(srcdir)/Misc/python.man \
-		$(DESTDIR)$(MANDIR)/man1/python.1
+		$(DESTDIR)$(MANDIR)/man1/python$(VERSION).1
 
 # Install the library
 PLATDIR=	plat-$(MACHDEP)
@@@@ -906,8 +913,8 @@@@ libinstall:	build_all $(srcdir)/Lib/$(PLATDIR)
 		./$(BUILDPYTHON) -Wi -t -c "import lib2to3.pygram, lib2to3.patcomp;lib2to3.patcomp.PatternCompiler()"
 
 # Create the PLATDIR source directory, if one wasn't distributed..
-$(srcdir)/Lib/$(PLATDIR):
-	mkdir $(srcdir)/Lib/$(PLATDIR)
+$(srcdir)/Lib/$(PLATDIR): $(BUILDPYTHON)
+	mkdir -p $(srcdir)/Lib/$(PLATDIR)
 	cp $(srcdir)/Lib/plat-generic/regen $(srcdir)/Lib/$(PLATDIR)/regen
 	export PATH; PATH="`pwd`:$$PATH"; \
 	export PYTHONPATH; PYTHONPATH="`pwd`/Lib"; \
@


1.3
log
@Update Python to 2.6.5, committing on behalf of fgsch@@ whose laptop is broken.
@
text
@d1 1
a1 1
$OpenBSD: patch-Makefile_pre_in,v 1.2 2009/05/03 22:26:27 djm Exp $
@


1.2
log
@python-2.6.2
@
text
@d1 3
a3 3
$OpenBSD: patch-Makefile_pre_in,v 1.1 2008/10/18 12:03:56 djm Exp $
--- Makefile.pre.in.orig	Tue Feb 24 22:07:44 2009
+++ Makefile.pre.in	Sun Apr 19 23:12:20 2009
d13 2
a14 1
@@@@ -386,6 +388,7 @@@@ $(BUILDPYTHON):	Modules/python.o $(LIBRARY) $(LDLIBRAR
d17 1
a17 1
 			$(BLDLIBRARY) $(LIBS) $(MODLIBS) $(SYSLIBS) $(LDLAST)
d22 1
a22 1
@@@@ -425,6 +428,11 @@@@ libpython$(VERSION).dylib: $(LIBRARY_OBJS)
d34 1
a34 1
@@@@ -760,14 +768,13 @@@@ bininstall:	altbininstall
d50 1
a50 1
@@@@ -783,7 +790,8 @@@@ altbininstall:	$(BUILDPYTHON)
d60 1
a60 1
@@@@ -799,7 +807,7 @@@@ maninstall:
d69 1
a69 1
@@@@ -906,8 +914,8 @@@@ libinstall:	build_all $(srcdir)/Lib/$(PLATDIR)
@


1.1
log
@port of Python-2.6, with 100% fewer build knobs!

Thanks to Ian Darwin, Will Maier and Aleksander Piotrowski for feedback
@
text
@d1 3
a3 3
$OpenBSD: patch-Makefile_pre_in,v 1.5 2008/06/09 12:34:55 espie Exp $
--- Makefile.pre.in.orig	Sat Sep  6 08:59:17 2008
+++ Makefile.pre.in	Wed Sep 17 10:49:33 2008
d21 1
a21 1
@@@@ -421,6 +424,11 @@@@ libpython$(VERSION).so: $(LIBRARY_OBJS)
d23 1
a23 1
 	$(LDSHARED) $(LDFLAGS) -o $@@ $(LIBRARY_OBJS) $(SHLIBS) $(LIBC) $(LIBM) $(LDLAST)
d33 1
a33 1
@@@@ -752,14 +760,13 @@@@ bininstall:	altbininstall
d49 4
a52 12
@@@@ -768,14 +775,12 @@@@ altbininstall:	$(BUILDPYTHON)
 		fi; \
 	done
 	$(INSTALL_PROGRAM) $(BUILDPYTHON) $(DESTDIR)$(BINDIR)/python$(VERSION)$(EXE)
-	if test -f libpython$(VERSION)$(SO); then \
+	if test -f $(LDLIBRARY); then \
 		if test "$(SO)" = .dll; then \
 			$(INSTALL_SHARED) libpython$(VERSION)$(SO) $(DESTDIR)$(BINDIR); \
 		else \
-			$(INSTALL_SHARED) libpython$(VERSION)$(SO) $(DESTDIR)$(LIBDIR)/$(INSTSONAME); \
-			if test libpython$(VERSION)$(SO) != $(INSTSONAME); then \
-				(cd $(DESTDIR)$(LIBDIR); $(LN) -sf $(INSTSONAME) libpython$(VERSION)$(SO)); \
d54 2
a55 2
+			$(INSTALL_SHARED) $(LDLIBRARY) $(DESTDIR)$(LIBPL)/$(LDLIBRARY); \
+			(cd $(DESTDIR)$(LIBDIR); $(LN) -s python$(VERSION)/config/$(LDLIBRARY)); \
d59 1
a59 1
@@@@ -791,7 +796,7 @@@@ maninstall:
d68 1
a68 1
@@@@ -898,8 +903,8 @@@@ libinstall:	build_all $(srcdir)/Lib/$(PLATDIR)
@

