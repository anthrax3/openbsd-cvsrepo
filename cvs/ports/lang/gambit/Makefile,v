head	1.28;
access;
symbols
	OPENBSD_6_0:1.25.0.2
	OPENBSD_6_0_BASE:1.25
	OPENBSD_5_9:1.24.0.2
	OPENBSD_5_9_BASE:1.24
	OPENBSD_5_8:1.18.0.4
	OPENBSD_5_8_BASE:1.18
	OPENBSD_5_7:1.13.0.2
	OPENBSD_5_7_BASE:1.13
	OPENBSD_5_6:1.10.0.2
	OPENBSD_5_6_BASE:1.10
	OPENBSD_5_5:1.7.0.4
	OPENBSD_5_5_BASE:1.7
	OPENBSD_5_4:1.7.0.2
	OPENBSD_5_4_BASE:1.7
	OPENBSD_5_3:1.4.0.2
	OPENBSD_5_3_BASE:1.4
	OPENBSD_5_2:1.2.0.2
	OPENBSD_5_2_BASE:1.2
	jasper_20122004:1.1.1.1
	jasper:1.1.1;
locks; strict;
comment	@# @;


1.28
date	2017.02.13.16.07.07;	author juanfra;	state Exp;
branches;
next	1.27;
commitid	QSJTskHqhZ6hzlRX;

1.27
date	2017.01.05.00.23.13;	author juanfra;	state Exp;
branches;
next	1.26;
commitid	CAaHEALSeUUziTOy;

1.26
date	2016.11.21.22.37.21;	author juanfra;	state Exp;
branches;
next	1.25;
commitid	TBssDhckzBqojb0R;

1.25
date	2016.03.16.21.19.38;	author naddy;	state Exp;
branches;
next	1.24;
commitid	eS3Ayl3CL8hkKETd;

1.24
date	2016.02.09.02.02.49;	author juanfra;	state Exp;
branches;
next	1.23;
commitid	TWDmc2UAH03BpCzT;

1.23
date	2016.02.04.22.16.19;	author juanfra;	state Exp;
branches;
next	1.22;
commitid	1zrNV8YoQ5WqLRKx;

1.22
date	2016.01.27.18.47.02;	author juanfra;	state Exp;
branches;
next	1.21;
commitid	lf0cHYAW8RpYx70p;

1.21
date	2015.09.06.22.32.17;	author juanfra;	state Exp;
branches;
next	1.20;
commitid	0kxQs1ZSfkJplMyo;

1.20
date	2015.08.26.15.38.46;	author juanfra;	state Exp;
branches;
next	1.19;
commitid	joL44pHVfd0PZAaS;

1.19
date	2015.08.24.16.36.32;	author juanfra;	state Exp;
branches;
next	1.18;
commitid	1WWG1xyUR8VNdofV;

1.18
date	2015.07.24.23.43.17;	author juanfra;	state Exp;
branches;
next	1.17;
commitid	mHtiT1TslaedR7Fh;

1.17
date	2015.05.21.17.50.00;	author juanfra;	state Exp;
branches;
next	1.16;
commitid	n2I1TCPllGQgUwzf;

1.16
date	2015.04.21.21.32.06;	author juanfra;	state Exp;
branches;
next	1.15;
commitid	THbaePe64ebtBiP2;

1.15
date	2015.03.19.15.47.38;	author juanfra;	state Exp;
branches;
next	1.14;
commitid	PZvDaLSC3uRYKLOw;

1.14
date	2015.03.14.23.34.17;	author juanfra;	state Exp;
branches;
next	1.13;
commitid	hKgXZD5GB1CbLGa2;

1.13
date	2014.12.08.14.28.00;	author landry;	state Exp;
branches;
next	1.12;
commitid	D3xTQ4iYU18HgAB0;

1.12
date	2014.10.26.14.22.05;	author jasper;	state Exp;
branches;
next	1.11;
commitid	9Jgv8VvZa5Qmf8BS;

1.11
date	2014.09.29.16.12.51;	author juanfra;	state Exp;
branches;
next	1.10;
commitid	8cmV7RxXkyzt0Nm1;

1.10
date	2014.07.13.08.59.41;	author armani;	state Exp;
branches;
next	1.9;
commitid	msCjHPJ9YLw9vc5W;

1.9
date	2014.03.10.22.16.19;	author juanfra;	state Exp;
branches;
next	1.8;

1.8
date	2014.03.09.20.00.32;	author jasper;	state Exp;
branches;
next	1.7;

1.7
date	2013.06.12.12.57.20;	author jasper;	state Exp;
branches;
next	1.6;

1.6
date	2013.05.30.15.51.47;	author jasper;	state Exp;
branches;
next	1.5;

1.5
date	2013.03.11.11.20.27;	author espie;	state Exp;
branches;
next	1.4;

1.4
date	2012.12.21.18.04.02;	author landry;	state Exp;
branches;
next	1.3;

1.3
date	2012.12.13.14.41.51;	author naddy;	state Exp;
branches;
next	1.2;

1.2
date	2012.07.07.09.39.55;	author jasper;	state Exp;
branches;
next	1.1;

1.1
date	2012.04.20.10.47.40;	author jasper;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2012.04.20.10.47.40;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.28
log
@Update to gambit 4.8.8.
@
text
@# $OpenBSD: Makefile,v 1.27 2017/01/05 00:23:13 juanfra Exp $

COMMENT=	complete, efficient and reliable implementation of Scheme

V=		4.8.8
DISTNAME=	gambit-v${V:S/./_/g}
PKGNAME=	gambit-$V
API_V=		${V:R:S/./0/}00${V:E}
SUBST_VARS+=	API_V

CATEGORIES=	lang

HOMEPAGE=	http://gambitscheme.org/

# LGPLv2.1 / Apachev2.0
PERMIT_PACKAGE_CDROM=	Yes

MASTER_SITES=	http://www.iro.umontreal.ca/~gambit/download/gambit/v${V:R}/source/
EXTRACT_SUFX=	.tgz

WANTLIB +=	c m util

CONFIGURE_STYLE=gnu
CONFIGURE_ARGS+=--disable-cplusplus \
		--disable-absolute-shared-libs \
		--docdir=${PREFIX}/share/doc/gambit/ \
		--includedir=${PREFIX}/include/gambit/ \
		--libdir=${PREFIX}/lib/gambit/ \
		--enable-c-opt="${CFLAGS}"

MAKE_FILE=	${WRKSRC}/makefile

# On sparc64, gcc crashes with the default stack limit:
# "cc: Internal error: Illegal instruction" on _gambc.c
do-build:
	ulimit -s 12288 && cd ${WRKSRC} && ${SETENV} ${MAKE_ENV} \
		${MAKE_PROGRAM} ${MAKE_FLAGS} -f ${MAKE_FILE} ${ALL_TARGET}

do-test:
	cd ${WRKSRC}/tests && ${SETENV} ${TEST_ENV} ${MAKE_PROGRAM} \
		${TEST_FLAGS} -f makefile ${TEST_TARGET}

# alpha: "cc1: out of memory allocating 1608 bytes"
# hppa: "virtual memory exhausted: Cannot allocate memory" (in a system with 2GB RAM)
.if ${MACHINE_ARCH} == "alpha" || ${MACHINE_ARCH} == "hppa"
CFLAGS += -O0
.endif

.include <bsd.port.mk>
@


1.27
log
@Update to gambit 4.8.7.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2016/11/21 22:37:21 juanfra Exp $
d5 1
a5 1
V=		4.8.7
@


1.26
log
@Update to gambit 4.8.6.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2016/03/16 21:19:38 naddy Exp $
d5 1
a5 1
V=		4.8.6
@


1.25
log
@remove SHARED_ONLY from ports that use only the gnu module
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2016/02/09 02:02:49 juanfra Exp $
d5 1
a5 1
V=		4.8.4
@


1.24
log
@Remove the comment. The workaround fixed the build.
@
text
@d1 1
a1 3
# $OpenBSD: Makefile,v 1.23 2016/02/04 22:16:19 juanfra Exp $

SHARED_ONLY=	Yes
@


1.23
log
@"cc1: out of memory allocating 1608 bytes".

Adding -O0 for the next bulk build. I don't have a machine where to
test the workaround. I will remove the comment when I know if that
helps with the bug or not.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2016/01/27 18:47:02 juanfra Exp $
d45 1
a45 1
# XXX alpha: "cc1: out of memory allocating 1608 bytes" (workaround not tested)
@


1.22
log
@Update to Gambit 4.8.4.

In addition to the update, I'm removing the shared libs. The term
"shared" is misleading here, gambit will continue generating
dynamically linked binaries by default and the only static libraries
linked will be its own libraries. Nothing uses the non-versioned
gambit shared libraries in the ports tree.

OK jasper@@.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2015/09/06 22:32:17 juanfra Exp $
d45 1
d47 1
a47 1
.if ${MACHINE_ARCH} == "hppa"
@


1.21
log
@Update to Gambit 4.7.9. OK jasper@@.

Remove the references to "gambit-c". More info:
http://article.gmane.org/gmane.lisp.scheme.gambit/7938
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2015/08/26 15:38:46 juanfra Exp $
d7 2
a8 2
V=		4.7.9
DISTNAME=	gambc-v${V:S/./_/g}
d26 1
a26 2
CONFIGURE_ARGS+=${CONFIGURE_SHARED} \
		--disable-cplusplus \
a39 5

post-install:
.for l in gambc gambcgsc gambcgsi
	cd ${PREFIX}/lib/ && ln -s gambit/lib$l.so
.endfor
@


1.20
log
@Fix the problem on sparc64.

GCC crashes with the default stack size limit. Gambit passes the tests
with the default limits.

OK jasper@@.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2015/08/24 16:36:32 juanfra Exp $
d7 1
a7 1
V=		4.7.8
d29 3
a31 3
		--docdir=${PREFIX}/share/doc/gambit-c/ \
		--includedir=${PREFIX}/include/gambit-c/ \
		--libdir=${PREFIX}/lib/gambit-c/ \
d44 1
a44 1
	cd ${PREFIX}/lib/ && ln -s gambit-c/lib$l.so
@


1.19
log
@Update to Gambit 4.7.8.

Workaround for sparc64. OK jasper@@.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2015/07/24 23:43:17 juanfra Exp $
d36 6
d52 1
a52 2
# XXX sparc64: "cc: Internal error: Illegal instruction" on __gambc.c
.if ${MACHINE_ARCH} == "hppa" || ${MACHINE_ARCH} == "sparc64"
@


1.18
log
@Update to gambit 4.7.7. Regex and OK jasper@@.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2015/05/21 17:50:00 juanfra Exp $
d7 1
a7 1
V=		4.7.7
d45 3
a47 2
# "virtual memory exhausted: Cannot allocate memory" (in a system with 2GB RAM)
.if ${MACHINE_ARCH} == "hppa"
@


1.17
log
@Add a note about gambit 4.7.6.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2015/04/21 21:32:06 juanfra Exp $
d7 1
a7 2
# 4.7.6 has a broken configure script due to an incompatible regex
V=		4.7.5
d10 2
@


1.16
log
@Update to gambit 4.7.5. OK jasper@@.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2015/03/19 15:47:38 juanfra Exp $
d7 1
@


1.15
log
@Unbreak gambit on hppa. All tests passed. OK landry@@.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2015/03/14 23:34:17 juanfra Exp $
d7 1
a7 1
V=		4.7.4
@


1.14
log
@Update to Gambit 4.7.4. OK jasper@@.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2014/12/08 14:28:00 landry Exp $
a3 1
BROKEN-hppa=	ICE on _gambc.c since 2014-09-29 
d42 5
@


1.13
log
@BROKEN-hppa: gcc ICE on _gambc.c since end of september
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2014/10/26 14:22:05 jasper Exp $
d8 1
a8 1
V=		4.7.3
a34 3
# Until we figure out how to make it play nice with a staged directory.
NO_TEST=	Yes

d39 4
@


1.12
log
@update to gambit-4.7.3
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2014/09/29 16:12:51 juanfra Exp $
d4 1
@


1.11
log
@Unbreak gambit on hppa. The package builds and the interpreter works fine.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2014/07/13 08:59:41 armani Exp $
d7 1
a7 2
V=		4.7.2
REVISION=	1
d21 1
a21 1
WANTLIB += c m util
d24 2
a25 2
CONFIGURE_ARGS+=--disable-cplusplus \
		${CONFIGURE_SHARED} \
d34 1
a34 1
# Untill we figure out how to make it play nice with a staged directory.
@


1.10
log
@Complete homepage url with http://

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2014/03/10 22:16:19 juanfra Exp $
a5 1
BROKEN-hppa =	cc: Internal error: Illegal instruction
@


1.9
log
@Gambit overwrites our default cflags with -O1. ok sthen@@ jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2014/03/09 20:00:32 jasper Exp $
d9 1
a9 1
REVISION=	0
d15 1
a15 1
HOMEPAGE=	gambitscheme.org/
@


1.8
log
@- update to gambit-4.7.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2013/06/12 12:57:20 jasper Exp $
d9 1
d31 2
a32 1
		--libdir=${PREFIX}/lib/gambit-c/
@


1.7
log
@add link to upstream issue tracker.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2013/05/30 15:51:47 jasper Exp $
d8 1
a8 1
V=		4.6.8
d14 1
a14 1
HOMEPAGE=	http://dynamo.iro.umontreal.ca/~gambit/
a30 3

# https://github.com/feeley/gambit/pull/29
CONFIGURE_ARGS+=ac_cv_func_get_fpc_csr=no
@


1.6
log
@- update to gambit-4.6.8
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2013/03/11 11:20:27 espie Exp $
d30 4
a33 2
		--libdir=${PREFIX}/lib/gambit-c/ \
		ac_cv_func_get_fpc_csr=no
@


1.5
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2012/12/21 18:04:02 landry Exp $
d8 1
a8 1
V=		4.6.6
a10 1
REVISION=	0
d30 2
a31 1
		--libdir=${PREFIX}/lib/gambit-c/
@


1.4
log
@Mark as BROKEN-hppa: it never built there.
cc: Internal error: Illegal instruction on _gambc.c
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2012/12/13 14:41:51 naddy Exp $
a18 3
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
d36 1
a36 1
NO_REGRESS=	Yes
@


1.3
log
@bump: this uses openpty since we fixed ac_cv_func_openpty in config.site
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2012/07/07 09:39:55 jasper Exp $
d6 1
@


1.2
log
@- update to 4.6.6
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2012/04/20 10:47:40 jasper Exp $
d10 1
d45 1
a45 1
.include <bsd.port.mk>@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d7 1
a7 1
V=		4.6.5
@


1.1.1.1
log
@import gambit 4.6.5

The Gambit Scheme system is a complete, portable, efficient and reliable
implementation of the Scheme programming language.
The Gambit-C system conforms to the R4RS, R5RS and IEEE Scheme
standards.  The full numeric tower is implemented, including: infinite
precision integers (bignums), rationals, inexact reals (floating point
numbers), and complex numbers.

ok sthen@@
@
text
@@
