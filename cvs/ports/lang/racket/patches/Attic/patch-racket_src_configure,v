head	1.4;
access;
symbols
	OPENBSD_5_6:1.2.0.2
	OPENBSD_5_6_BASE:1.2;
locks; strict;
comment	@# @;


1.4
date	2014.11.11.23.51.51;	author juanfra;	state dead;
branches;
next	1.3;
commitid	jJZWunEk9OSNbvdS;

1.3
date	2014.08.19.22.51.20;	author juanfra;	state Exp;
branches;
next	1.2;
commitid	QvmIDKxGqUJQ9ATx;

1.2
date	2014.05.14.17.51.40;	author juanfra;	state Exp;
branches;
next	1.1;

1.1
date	2014.04.09.03.34.48;	author juanfra;	state Exp;
branches;
next	;


desc
@@


1.4
log
@Update to racket 6.1.1.

The installation of the shared lib is not recommended by upstream and
nobody is using it, so I'm removing the lib from the package.
@
text
@$OpenBSD: patch-racket_src_configure,v 1.3 2014/08/19 22:51:20 juanfra Exp $
--- src/configure.orig	Thu Jul 17 19:37:10 2014
+++ src/configure	Sat Jul 19 21:38:36 2014
@@@@ -6539,7 +6539,7 @@@@ if test "${enable_shared}" = "yes" ; then
     plt_lib_version=`grep " MZSCHEME_VERSION " ${srcdir}/racket/src/schvers.h | cut -d '"' -f 2`
   fi
 
-  AR="${LIBTOOLPROG} --mode=link --tag=CC $CC${need_gcc_static_libgcc}${ar_libtool_no_undefined} -release ${plt_lib_version} -rpath ${abslibdir} \$(ARLIBFLAGS) -o"
+  AR="${LIBTOOLPROG} --mode=link --tag=CC $CC${need_gcc_static_libgcc}${ar_libtool_no_undefined} -version-info ${LIBracket3m_MAJOR}:${LIBracket3m_MINOR} -rpath ${abslibdir} \$(ARLIBFLAGS) -o"
   STATIC_AR="${LIBTOOLPROG} --mode=link --tag=CC $CC -o"
   ARFLAGS=""
   RANLIB=":"
@


1.3
log
@Update to Racket 6.1. Tested on amd64 and i386.
@
text
@d1 1
a1 1
$OpenBSD: patch-racket_src_configure,v 1.2 2014/05/14 17:51:40 juanfra Exp $
@


1.2
log
@Update to Racket 6.0.1. ok jturner@@.
@
text
@d1 4
a4 32
$OpenBSD: patch-racket_src_configure,v 1.1 2014/04/09 03:34:48 juanfra Exp $

"enable pthreads by default, but don't force enabled" (needed for platforms
without CAS)

https://github.com/plt/racket/commit/2ff4802a14b7b03c80d0caee785f5b3699c3a01e

--- src/configure.orig	Thu Apr 17 21:58:55 2014
+++ src/configure	Fri May  9 01:24:28 2014
@@@@ -4442,7 +4442,7 @@@@ case "$host_os" in
     ;;
   openbsd*)
     LIBS="$LIBS -Wl,--export-dynamic"
-    enable_pthread=yes
+    enable_pthread_by_default=yes
     try_kqueue_syscall=yes
     ;;
   dragonfly*)
@@@@ -6215,6 +6215,12 @@@@ fi
 
 ############### pthread ###################
 
+if test "${enable_pthread}" = "" ; then
+  if test "${enable_pthread_by_default}" = "yes" ; then
+    enable_pthread=yes
+  fi
+fi
+
 if test "${enable_pthread}" = "yes" ; then
   if test "${use_flag_pthread}" = "yes" ; then
     PREFLAGS="$PREFLAGS -pthread"
@@@@ -6492,7 +6498,7 @@@@ if test "${enable_shared}" = "yes" ; then
@


1.1
log
@Update to racket 6, plus some additional changes.

Tested by bcallah@@ (i386), jturner@@ (amd64) and me (both platforms).

Help and OK from jturner@@ to an old similar diff. Change from
RUN_DEPENDS to LIB_DEPENDS of some deps suggested by sthen@@ and OK
from him.
@
text
@d1 32
a32 4
$OpenBSD: patch-src_configure,v 1.1.1.1 2013/09/19 14:55:55 sthen Exp $
--- src/configure.orig	Sat Jan 11 19:20:47 2014
+++ src/configure	Sun Jan 26 02:08:24 2014
@@@@ -9164,7 +9164,7 @@@@ if test "${enable_shared}" = "yes" ; then
@

