head	1.2;
access;
symbols
	OPENBSD_4_7:1.1.0.12
	OPENBSD_4_7_BASE:1.1
	OPENBSD_4_6:1.1.0.10
	OPENBSD_4_6_BASE:1.1
	OPENBSD_4_5:1.1.0.8
	OPENBSD_4_5_BASE:1.1
	OPENBSD_4_4:1.1.0.6
	OPENBSD_4_4_BASE:1.1
	OPENBSD_4_3:1.1.0.4
	OPENBSD_4_3_BASE:1.1
	OPENBSD_4_2:1.1.0.2
	OPENBSD_4_2_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2010.04.22.21.49.37;	author kili;	state dead;
branches;
next	1.1;

1.1
date	2007.07.22.22.37.25;	author kili;	state Exp;
branches;
next	;


desc
@@


1.2
log
@
Update to 6.12.2.

Many thanks to Darrin Chandler and dcoppa@@ for testing, reporting about
broken stuff, missing dependencies here and in ports depending on ghc.

Notes and rants:

- Bootstrapping is done using precompiled binaries, since .hc
  bootstrapping still doesn't work. I really hate this.

  THIS MEANS THAT GHC IS NOW AND WILL STAY LEGACY-ONLY (i386 and amd64)

  At least until someone fixes it. I tried for more than two year
  (well, only in my spare time and during my vacations) and failed.

- libgmp is currently disabled, because I didn't yet hack the GHC build
  system to use the system libgmp instead of the patched one included
  in GHC.

- The haddock ncluded in the ghc distfile is replaced by the version
  of haddock found in devel/haddock. Haddock itself is @@commented
  in the ghc PLIST. Unfortunately, this needs an ugly hack that
  introduces an otherwise useless pseudo flavor `no_deps' in
  devel/haddock.

- CLDouble has been removed from GHC some time ago, because it was
  an alias for double (AFAIK there's now support for long double
  in GHC). As this isn't a really big problem, it currently breaks
  c2hs, which I'll mark broken temporarily before committing the
  ghc update.

- The external codeset defaults to latin1 (suggested by Simon Marlow)
  and can be overridden by setting the HS_ENCODING to any codeset
  supported by libiconv.

- ghc.port.mk still needs some love, especially for letting a port add
  additional parameters to certain invocations of ${MODGHC_SETUP_PROG}.
@
text
@$OpenBSD: patch-libraries_Cabal_Distribution_PreProcess_hs,v 1.1 2007/07/22 22:37:25 kili Exp $

Pass more complete LDFLAGS to the hsc2hs preprocessor. Inspired by
development revision of Cabal, but much less intrusive, and I think
their approach is wrong, because it passes -R options via --lflags
to hsc2hs, which in turn passes it to ghc and then bails out.

--- libraries/Cabal/Distribution/PreProcess.hs.orig	Wed Apr 25 19:23:22 2007
+++ libraries/Cabal/Distribution/PreProcess.hs	Sun Jul 22 19:59:12 2007
@@@@ -237,6 +237,7 @@@@ ppHsc2hs bi lbi
                          ++ [opt | opt@@('-':c:_) <- ccOptions bi, c == 'D' || c == 'I']
                          ++ ["--cflag=" ++ opt | opt@@('-':'U':_) <- ccOptions bi]
                          ++ ["--lflag=-L" ++ dir | dir <- extraLibDirs bi]
+			 ++ ["--lflag=" ++ opt | opt@@('-':'L':_) <- ldOptions bi]
                          ++ ["--lflag=-l" ++ lib | lib <- extraLibs bi])
 
 ppC2hs :: BuildInfo -> LocalBuildInfo -> PreProcessor
@


1.1
log
@
Let the Cabal libraries pass the complete LDFLAGS to hsc2hs.
@
text
@d1 1
a1 1
$OpenBSD$
@

