head	1.4;
access;
symbols
	OPENBSD_6_0:1.4.0.4
	OPENBSD_6_0_BASE:1.4
	OPENBSD_5_9:1.4.0.2
	OPENBSD_5_9_BASE:1.4
	OPENBSD_5_8:1.3.0.6
	OPENBSD_5_8_BASE:1.3
	OPENBSD_5_7:1.3.0.2
	OPENBSD_5_7_BASE:1.3
	OPENBSD_5_6:1.2.0.6
	OPENBSD_5_6_BASE:1.2
	OPENBSD_5_5:1.2.0.4
	OPENBSD_5_5_BASE:1.2
	OPENBSD_5_4:1.2.0.2
	OPENBSD_5_4_BASE:1.2
	OPENBSD_5_3:1.1.0.2
	OPENBSD_5_3_BASE:1.1;
locks; strict;
comment	@# @;


1.4
date	2015.09.19.07.42.57;	author kili;	state Exp;
branches;
next	1.3;
commitid	wrrXExsbhXWvHmhw;

1.3
date	2014.11.22.20.23.23;	author kili;	state Exp;
branches;
next	1.2;
commitid	f8HFLM9LK5anF9Xl;

1.2
date	2013.07.18.21.43.24;	author kili;	state Exp;
branches;
next	1.1;

1.1
date	2012.11.05.20.20.07;	author kili;	state Exp;
branches;
next	;


desc
@@


1.4
log
@Update to ghc-7.10.2.

Updates to all hs-* ports related to meta/haskell-platform will
follow soon. Other hs-* ports will be fixed during the next days.
@
text
@$OpenBSD: patch-utils_ghc-pkg_Main_hs,v 1.3 2014/11/22 20:23:23 kili Exp $

Horrible hack to get rid of the annoying warnings when running
pkg_add -u. This means that you do NOT get any such warning when
running ghc-pkg unregister ... -v0 --force.

--- utils/ghc-pkg/Main.hs.orig	Tue Jul 21 15:52:50 2015
+++ utils/ghc-pkg/Main.hs	Tue Sep  1 16:16:37 2015
@@@@ -1119,7 +1119,7 @@@@ modifyPackage fn pkgarg verbosity my_flags force = do
             = display pkgid
         | otherwise = display pkgid ++ "@@" ++ display (packageKey pkg)
         where pkgid = sourcePackageId pkg
-  when (not (null newly_broken)) $
+  when (not (null newly_broken || (force == ForceAll && verbosity <= Silent))) $
       dieOrForceAll force ("unregistering would break the following packages: "
               ++ unwords (map displayQualPkgId newly_broken))
 
@


1.3
log
@Update to ghc-7.8.3, but mark as broken until all other
hs ports are done.

Please note that it still doesn't use shared libraries, so
still no ghci (and a lot of hs-ports not buildable) on i386.
@
text
@d1 1
a1 1
$OpenBSD: patch-utils_ghc-pkg_Main_hs,v 1.2 2013/07/18 21:43:24 kili Exp $
d7 6
a12 6
--- utils/ghc-pkg/Main.hs.orig	Thu Jul 10 06:27:17 2014
+++ utils/ghc-pkg/Main.hs	Sun Nov  2 21:50:32 2014
@@@@ -953,7 +953,7 @@@@ modifyPackage fn pkgid verbosity my_flags force = do
       new_broken = map sourcePackageId (brokenPackages (allPackagesInStack new_stack))
       newly_broken = filter (`notElem` map sourcePackageId old_broken) new_broken
   --
d15 3
a17 3
       dieOrForceAll force ("unregistering " ++ display pkgid ++
            " would break the following packages: "
               ++ unwords (map display newly_broken))
@


1.2
log
@Update to ghc-7.6.3, revert my last two obsolete changes and
mark it as broken until all depending ports have been updated.
@
text
@d1 1
a1 1
$OpenBSD: patch-utils_ghc-pkg_Main_hs,v 1.1 2012/11/05 20:20:07 kili Exp $
d7 3
a9 3
--- utils/ghc-pkg/Main.hs.orig	Thu Apr 18 23:22:47 2013
+++ utils/ghc-pkg/Main.hs	Sun Jul  7 16:00:36 2013
@@@@ -929,7 +929,7 @@@@ modifyPackage fn pkgid verbosity my_flags force = do
@


1.1
log
@Stop ghc-pkg unregister <pkgname> -v0 --force issuing warnings that
this would break other packages.

Please note that those warnings are only disabled if both
-v0 *and* --force are given.

'no objections' dcoppa@@
@
text
@d1 1
a1 1
$OpenBSD$
d7 3
a9 3
--- utils/ghc-pkg/Main.hs.orig	Wed Jun  6 19:10:25 2012
+++ utils/ghc-pkg/Main.hs	Sun Nov  4 20:45:43 2012
@@@@ -915,7 +915,7 @@@@ modifyPackage fn pkgid verbosity my_flags force = do
@

