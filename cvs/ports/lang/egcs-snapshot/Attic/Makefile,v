head	1.52;
access;
symbols
	OPENBSD_2_5:1.39.0.2
	OPENBSD_2_5_BASE:1.39
	OPENBSD_2_4:1.2.0.2
	OPENBSD_2_4_BASE:1.2
	ss-19980921:1.1.1.1
	OpenBSD-ports:1.1.1;
locks; strict;
comment	@# @;


1.52
date	99.08.22.16.57.09;	author espie;	state dead;
branches;
next	1.51;

1.51
date	99.07.04.18.20.26;	author espie;	state Exp;
branches;
next	1.50;

1.50
date	99.06.17.17.06.39;	author espie;	state Exp;
branches;
next	1.49;

1.49
date	99.06.02.23.32.47;	author espie;	state Exp;
branches;
next	1.48;

1.48
date	99.06.01.20.59.34;	author espie;	state Exp;
branches;
next	1.47;

1.47
date	99.05.25.20.18.25;	author espie;	state Exp;
branches;
next	1.46;

1.46
date	99.05.25.19.55.21;	author espie;	state Exp;
branches;
next	1.45;

1.45
date	99.05.18.17.07.16;	author espie;	state Exp;
branches;
next	1.44;

1.44
date	99.05.14.01.15.29;	author espie;	state Exp;
branches;
next	1.43;

1.43
date	99.05.05.13.08.21;	author espie;	state Exp;
branches;
next	1.42;

1.42
date	99.04.29.16.54.19;	author espie;	state Exp;
branches;
next	1.41;

1.41
date	99.04.28.15.40.26;	author espie;	state Exp;
branches;
next	1.40;

1.40
date	99.04.18.20.54.38;	author espie;	state Exp;
branches;
next	1.39;

1.39
date	99.03.22.00.25.33;	author espie;	state Exp;
branches;
next	1.38;

1.38
date	99.03.07.14.15.33;	author espie;	state Exp;
branches;
next	1.37;

1.37
date	99.03.02.04.41.04;	author marc;	state Exp;
branches;
next	1.36;

1.36
date	99.02.28.18.17.06;	author espie;	state Exp;
branches;
next	1.35;

1.35
date	99.02.23.16.54.48;	author espie;	state Exp;
branches;
next	1.34;

1.34
date	99.02.23.09.28.23;	author espie;	state Exp;
branches;
next	1.33;

1.33
date	99.02.21.01.04.59;	author espie;	state Exp;
branches;
next	1.32;

1.32
date	99.02.20.04.26.13;	author espie;	state Exp;
branches;
next	1.31;

1.31
date	99.02.18.02.37.32;	author marc;	state Exp;
branches;
next	1.30;

1.30
date	99.02.14.19.33.31;	author espie;	state Exp;
branches;
next	1.29;

1.29
date	99.02.13.00.53.48;	author espie;	state Exp;
branches;
next	1.28;

1.28
date	99.02.09.10.47.44;	author espie;	state Exp;
branches;
next	1.27;

1.27
date	99.02.08.20.34.26;	author espie;	state Exp;
branches;
next	1.26;

1.26
date	99.02.06.16.31.14;	author espie;	state Exp;
branches;
next	1.25;

1.25
date	99.02.04.13.21.12;	author espie;	state Exp;
branches;
next	1.24;

1.24
date	99.02.03.18.02.53;	author espie;	state Exp;
branches;
next	1.23;

1.23
date	99.02.02.01.19.36;	author espie;	state Exp;
branches;
next	1.22;

1.22
date	99.01.31.23.20.41;	author espie;	state Exp;
branches;
next	1.21;

1.21
date	99.01.24.21.36.11;	author espie;	state Exp;
branches;
next	1.20;

1.20
date	99.01.18.10.23.25;	author espie;	state Exp;
branches;
next	1.19;

1.19
date	99.01.13.13.58.45;	author espie;	state Exp;
branches;
next	1.18;

1.18
date	99.01.13.00.09.03;	author espie;	state Exp;
branches;
next	1.17;

1.17
date	99.01.12.11.28.44;	author espie;	state Exp;
branches;
next	1.16;

1.16
date	99.01.12.11.27.39;	author espie;	state Exp;
branches;
next	1.15;

1.15
date	99.01.12.00.19.49;	author espie;	state Exp;
branches;
next	1.14;

1.14
date	99.01.10.02.50.02;	author espie;	state Exp;
branches;
next	1.13;

1.13
date	99.01.09.16.55.27;	author espie;	state Exp;
branches;
next	1.12;

1.12
date	98.12.21.21.13.01;	author espie;	state Exp;
branches;
next	1.11;

1.11
date	98.12.19.00.55.44;	author espie;	state Exp;
branches;
next	1.10;

1.10
date	98.12.17.23.04.10;	author espie;	state Exp;
branches;
next	1.9;

1.9
date	98.12.17.05.13.23;	author marc;	state Exp;
branches;
next	1.8;

1.8
date	98.12.16.17.52.29;	author espie;	state Exp;
branches;
next	1.7;

1.7
date	98.12.05.23.25.58;	author espie;	state Exp;
branches;
next	1.6;

1.6
date	98.12.03.02.33.34;	author espie;	state Exp;
branches;
next	1.5;

1.5
date	98.11.25.00.54.02;	author espie;	state Exp;
branches;
next	1.4;

1.4
date	98.11.17.17.39.33;	author espie;	state Exp;
branches;
next	1.3;

1.3
date	98.11.16.21.11.13;	author espie;	state Exp;
branches;
next	1.2;

1.2
date	98.10.02.18.57.28;	author espie;	state Exp;
branches;
next	1.1;

1.1
date	98.09.25.22.45.26;	author espie;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	98.09.25.22.45.26;	author espie;	state Exp;
branches;
next	;


desc
@@


1.52
log
@Bye, bye... moved around.
@
text
@# $OpenBSD: Makefile,v 1.51 1999/07/04 18:20:26 espie Exp $

# This is a configuration file for egcs, snapshot flavor
# PLEASE use the regular egcs-stable for serious work, resort to this one
# for experimentations and testing.

# it only works right with a recent bsd.port.mk.
NEED_VERSION=1.73

# we could remove this dependency by patching configure, but this is not
# reasonable...
BUILD_DEPENDS=	autoconf:${PORTSDIR}/devel/autoconf

CATEGORIES=	lang 
MAINTAINER=	Marc.Espie@@openbsd.org
MIRROR_DISTFILE=no

# Testers for the new configurations:
# Jason L.Wright & Marco S.Hyman for sparc,
# Michael Shalayeff for hppa,
# Wim Van Deputte for alpha,
# Steve Murphee for m88k,
# Per Fogelstrom and Todd Millert for mips,
# Dale Rahn for rs6000.

# user configuration section

# see files/tests for precise testing procedure


# cygnus packaging scheme is now working, though it is weird.
# namely, testsuite holds all the tests. g++-tests no longer exists,
# and g77-tests only holds duplicates from the main testsuite archive.
MAKE_TESTS=yes
MAKE_GXX=yes
MAKE_FORTRAN=yes
MAKE_CHILL=yes
MAKE_OBJC=yes
MAKE_JAVA=yes

.if defined(MAKE_TESTS)
BUILD_DEPENDS+=	runtest:${PORTSDIR}/devel/dejagnu
.endif

# if you want/need to use the mammoth archive
ONE_ARCHIVE=yes


LATEST_DATE=1999-06-29

#### fetch section
# configuration is built so that you can test the next snapshot easily,
# define NEXT_DATE to the next snapshot... 

# You also may have to remove/add some patches, as these things ARE
# usually passed along to the egcs ml.
#NEXT_DATE=1999-06-29
#PATCH_DEBUG=yes

LATEST != echo ${LATEST_DATE} | sed -e s/-//g;
DIRECTORY=egcs/snapshots/%SUBDIR%/
.if defined(NEXT_DATE)
NEXT != echo ${NEXT_DATE} | sed -e s/-//g;
DISTNAME=	egcs-${NEXT}
.else
DISTNAME=   egcs-${LATEST}
.endif

# getting the right archives where they should be
MASTER_SITE_SUBDIR=${LATEST_DATE}
PATCH_SITE_SUBDIR=${NEXT_DATE}

DIST_SUBDIR=egcs

PATCH_DIST_STRIP=-p1

.if defined(ONE_ARCHIVE)
DISTFILES=  egcs-${LATEST}${EXTRACT_SUFX}
.else

DISTFILES=	egcs-core-${LATEST}${EXTRACT_SUFX}
.if defined(MAKE_TESTS)
DISTFILES+=egcs-tests-${LATEST}${EXTRACT_SUFX}
.endif

.if defined(MAKE_GXX)
DISTFILES+=     egcs-g++-${LATEST}${EXTRACT_SUFX}
.endif

.if defined(MAKE_FORTRAN)
DISTFILES+=     egcs-g77-${LATEST}${EXTRACT_SUFX}
.endif

.if defined(MAKE_JAVA)
DISTFILES+=egcs-java-${LATEST}${EXTRACT_SUFX}
.endif

.if defined(MAKE_OBJC)
DISTFILES+=egcs-objc-${LATEST}${EXTRACT_SUFX}
.endif

.if defined(MAKE_CHILL)
DISTFILES+=egcs-chill-${LATEST}${EXTRACT_SUFX}
.endif

.endif

.if ! (defined(JUST_BUMP) && defined(NEXT_DATE))
SUPDISTFILES=egcs-${LATEST}${EXTRACT_SUFX}
.for sub in core tests g++ g77 java objc chill
SUPDISTFILES+=egcs-${sub}-${LATEST}${EXTRACT_SUFX}
.endfor
.endif


MASTER_SITES=	
MASTER_SITES+=	ftp://egcs.cygnus.com/pub/${DIRECTORY} 
MASTER_SITES+=	ftp://ftp.lip6.fr/pub/${DIRECTORY}
MASTER_SITES+= ftp://ftp.goof.com/pub/pcg/${DIRECTORY}
MASTER_SITES+= ftp://go.cygnus.com/pub/ftp.cygnus.com/${DIRECTORY}
#MASTER_SITES+= ftp://cambridge.cygnus.com/pub/${DIRECTORY}
MASTER_SITES+= ftp://sunsite.doc.ic.ac.uk/Mirrors/egcs.cygnus.com/pub/${DIRECTORY}
MASTER_SITES+= ftp://gd.tuwien.ac.at/gnu/${DIRECTORY}
#MASTER_SITES+= ftp://ftp.ilog.fr/pub/Mirrors/${DIRECTORY}
#MASTER_SITES+= ftp://ftp.irisa.fr/pub/mirrors/${DIRECTORY}

MASTER_SITES+= ftp://ftp.gts.cz/pub/MIRRORS/ftp.cygnus.com/pub/${DIRECTORY}
MASTER_SITES+= ftp://sunsite.auc.dk/pub/${DIRECTORY}
MASTER_SITES+= ftp://ftp.fu-berlin.de/unix/languages/${DIRECTORY}
MASTER_SITES+= ftp://ftp.gwdg.de/pub/cygnus/${DIRECTORY}
MASTER_SITES+= ftp://ftp.mpi-sb.mpg.de/pub/gnu/mirror/egcs.cygnus.com/${DIRECTORY}
MASTER_SITES+= ftp://ftp.uni-trier.de/pub/languages/c/implementation/${DIRECTORY}
MASTER_SITES+= ftp://ftp.sunet.se/pub/gnu/${DIRECTORY}
#MASTER_SITES+= ftp://ftp.unicamp.br/pub/gnu/=EXTRA=/cygnus/${DIRECTORY}
MASTER_SITES+= ftp://ftp.lbi.ro/mirrors/ftp.cygnus.com/pub/${DIRECTORY}
MASTER_SITES+= ftp://ftp.ntua.gr/pub/gnu/${DIRECTORY}
MASTER_SITES+= ftp://ftp.nluug.nl/pub/languages/${DIRECTORY}
MASTER_SITES+= ftp://ftp.dti.ad.jp/pub/lang/${DIRECTORY}
MASTER_SITES+= ftp://ftp.win.or.jp/pub/lang/${DIRECTORY}
MASTER_SITES+= ftp://ftp.telewaynet.ad.jp/pub/lang/${DIRECTORY}
MASTER_SITES+= ftp://ftp.lab.kdd.co.jp/lang/${DIRECTORY}
#MASTER_SITES+= ftp://ftp.funet.fi/mirrors/ftp.cygnus.com/pub/${DIRECTORY}
#MASTER_SITES+= ftp://ftp.crc.ca/pub/packages/${DIRECTORY}
MASTER_SITES+= ftp://ftp.nc.orc.ru/pub/${DIRECTORY}
#MASTER_SITES+= ftp://ftp.u-aizu.ac.jp/pub/lang/C/pcg/${DIRECTORY}
MASTER_SITES+= ftp://ftp.maisel.int-evry.fr/pub/linux/pentium/${DIRECTORY}
MASTER_SITES+= ftp://ftp.yggdrasil.com/mirrors/site/egcs.cygnus.com/pub/${DIRECTORY}
MASTER_SITES+= ftp://unix.hensa.ac.uk/mirrors/egcs.cygnus.com/pub/${DIRECTORY}

# couldn't contact those, maybe they work ?
MASTER_SITES+= ftp://sunsite.mff.cuni.cz/pub/GNU/${DIRECTORY}
MASTER_SITES+= ftp://sunsite.icm.edu.pl/pub/programming/${DIRECTORY}
MASTER_SITES+= ftp://ftp.task.gda.pl/mirror/egcs.cygnus.com/pub/${DIRECTORY}
MASTER_SITES+= ftp://ftp.lca.uevora.pt/pub/${DIRECTORY}
MASTER_SITES+= ftp://cair-archive.kaist.ac.kr/pub/gnu/${DIRECTORY}
MASTER_SITES+= ftp://linux.ihep.su/pub/cygnus/${DIRECTORY}
MASTER_SITES+= ftp://linux.cis.nctu.edu.tw/pub/packages/pcg/${DIRECTORY}
MASTER_SITES+= ftp://ftp.ninemoons.com/pub/mirrors/${DIRECTORY}

PATCH_SITES = ${MASTER_SITES}

# add a possible next snapshot

.if defined(NEXT)
.if defined(ONE_ARCHIVE)
PATCHFILES=egcs-${LATEST}-${NEXT}.diff.gz

.else
PATCHFILES=egcs-core-${LATEST}-${NEXT}.diff.gz
.if defined(MAKE_TESTS)
PATCHFILES+=egcs-tests-${LATEST}-${NEXT}.diff.gz
.endif
.if defined(MAKE_GXX)
PATCHFILES+=egcs-g++-${LATEST}-${NEXT}.diff.gz
.if defined(MAKE_TESTS)
PATCHFILES+=egcs-g++-tests-${LATEST}-${NEXT}.diff.gz
.endif
.endif
.if defined(MAKE_FORTRAN)
PATCHFILES+=egcs-g77-${LATEST}-${NEXT}.diff.gz
.if defined(MAKE_TESTS)
PATCHFILES+=egcs-g77-testsuite-${LATEST}-${NEXT}.diff.gz
.endif
.endif
.if defined(MAKE_JAVA)
PATCHFILES+=egcs-java-${LATEST}-${NEXT}.diff.gz
.endif
.if defined(MAKE_OBJC)
PATCHFILES+=egcs-objc-${LATEST}-${NEXT}.diff.gz
.endif
.if defined(MAKE_CHILL)
PATCHFILES+=egcs-chill-${LATEST}-${NEXT}.diff.gz
.endif
.endif

SUPPATCHFILES=egcs-${LATEST}-${NEXT}.diff.gz
.for sub in core tests g++ g77 java objc chill
SUPPATCHFILES+=egcs-${sub}-${LATEST}-${NEXT}.diff.gz
.endfor

.endif

# Misc bug sections
pre-fetch:
.if (${MACHINE_ARCH} == "i386")
	@@(cd /tmp && /usr/bin/as -k ${FILESDIR}/gas-bug/test-i386-gas.s) || \
	(${ECHO} "Your gas has a bug, see ${FILESDIR}/gas-bug for details"; ${FALSE})
.endif
#	@@if [ -f /usr/lib/libc.so.* ]; \
#	then \
#		ldd /usr/lib/libc.so.* 2>/dev/null || \
#		(${ECHO} "Your ldd must be patched, see ${FILESDIR}/ldd-patch"; ${FALSE}) \
#	fi


makesum:
	@@${ECHO} ">>>Please make addsum to avoid clobbering old checksums"
	@@${FALSE}

# synch the date
.if defined(NEXT)
post-extract:
	${MV} ${WRKDIR}/egcs-${LATEST} ${WRKSRC}
.endif


#### 
# Patch section

PATCH_LIST=patch-core-*
.if defined(MAKE_GXX)
PATCH_LIST+=patch-g++-*
.endif
.if defined(MAKE_OBJC)
PATCH_LIST+=patch-objc-*
.endif
.if defined(MAKE_CHILL)
PATCH_LIST+=patch-chill-*
.endif
.if defined(MAKE_FORTRAN)
PATCH_LIST+=patch-g77-*
.endif
.if defined(MAKE_JAVA)
PATCH_LIST+=patch-java-*
.endif

# get openbsd configuration files where they should be
post-patch:
		# avoid packaging include copies along...
	find ${WRKSRC} -name \*.orig|xargs ${RM}
	${CP} -R ${FILESDIR}/config/* ${WRKSRC}
	cd ${WRKSRC}; \
	for f in `cat ${FILESDIR}/fixdepend`; \
	do \
		[ -f $$f ] && touch $$f; \
	done 
# rebuild configure files after patching, then move source around !!!
# XXX: don't try to autoconf the main configure file, it's not autoconf.
	cd ${WRKSRC}/gcc && PATH=${PORTPATH} autoreconf
	cd ${WRKSRC}/libiberty && PATH=${PORTPATH} autoreconf




####
# configure section
#
# define AS_PATH/LD_PATH is you don't want to use the default as/ld.
# This should not be used for regular releases, but if you're using this
# snapshot, you know what you're doing, don't you ?

GNU_CONFIGURE=	yes

#CONFIGURE_SCRIPT=../source/configure

LANGS=c
.if defined(MAKE_GXX)
LANGS+=c++
.endif
.if defined(MAKE_FORTRAN)
LANGS+=f77
.endif
.if defined(MAKE_CHILL)
LANGS+=CHILL
.endif
.if defined(MAKE_OBJC)
LANGS+=objc
.endif
.if defined(MAKE_JAVA)
LANGS+=java
.endif

# Note: the configure target passes CFLAGS to the configure script anyways.

#CFLAGS='-g -O2'
CONFIGURE_ENV=LANGUAGES='${LANGS}'  



CONFIGURE_ARGS= --prefix=${PREFIX} \
--verbose --program-transform-name=s,^,e, \
--disable-subdir-texinfo \
--disable-nls


# This is needed, as internal cpp is no longer compatible with the
# visible beast
CONFIGURE_ARGS+=--enable-cpp


# if you wish to try your luck
#CONFIGURE_ARGS+= --enable-threads=yes

.if defined(AS_PATH)
CONFIGURE_ARGS += --with-as=${AS_PATH}
.else
CONFIGURE_ARGS += --with-gnu-as 
.endif

.if defined(LD_PATH)
CONFIGURE_ARGS += --with-ld=${LD_PATH}
.else
CONFIGURE_ARGS += --with-gnu-ld 
.endif

CONFIGURE_ARGS += ${CONFIGURE_SHARED}

SEPARATE_BUILD=concurrent
#WRKBUILD=${WRKDIR}/build-${MACHINE_ARCH}



####
# build section
# should work without gmake. If it turns out to be needed, this must be 
# reported to MAINTAINER.
#USE_GMAKE= yes

# you shouldn't skip bootstrap unless you know what you're doing
# use bootstrap-lean if you're pressed for space
ALL_TARGET=bootstrap
# ALL_TARGET=bootstrap-lean

# desactivate the fixincludes mechanism by supplying a script which does
# nothing
pre-build:
	echo "#!/bin/sh" >${WRKBUILD}/gcc/fixinc.sh

# XXX we need to override do-build to get the warnings from within make
do-build:
	@@(cd ${WRKBUILD}; \
	${MAKE_ENV} ${MAKE_PROGRAM} ${MAKE_FLAGS} ${MAKEFILE} ${ALL_TARGET} 2>warnings) || \
	(echo "*** Make bootstrap failed."; \
	echo "*** Look at ${WRKBUILD}/warnings for errors"; ${FALSE})

####
# Install & tests section 

# Tests no longer need to be performed at the end of install, this
# was a bug in libstdc++/openbsd.ml
.if defined(MAKE_TESTS)
TEST_RESULT=${WRKBUILD}/test.result

post-build:
	@@(cd ${WRKBUILD}; ulimit -c 0; \
	${MAKE_ENV} ${MAKE_PROGRAM} ${MAKE_FLAGS} ${MAKEFILE} check && \
	${WRKSRC}/contrib/test_summary >${TEST_RESULT})
	@@${ECHO} "Please send the tests results to the egcs project"
	@@${ECHO} "By invoking make send-results"

send-results: 
	[ -f ${TEST_RESULT} ] && sh ${TEST_RESULT}
.endif

PLIST=${WRKBUILD}/PLIST

M4FLAGS=-Uinclude -DDISTNAME=${DISTNAME}
.if defined(MAKE_GXX)
M4FLAGS+= -DGXX
.endif
.if defined(MAKE_FORTRAN)
M4FLAGS+= -DFORTRAN
.endif
.if defined(MAKE_CHILL)
M4FLAGS+= -DCHILL
.endif
.if defined(MAKE_OBJC)
M4FLAGS+= -DOBJC
.endif
.if defined(MAKE_JAVA)
M4FLAGS+= -DJAVA
.endif

special: extract
		# avoid packaging include copies along...
	find ${WRKSRC} -name \*.orig|xargs ${RM}
	-${RM} -rf ${WRKSRC}/texinfo 
	
GCC_NAME=${WRKBUILD}/gcc/xgcc
pre-install:
	${M4} ${M4FLAGS} -DARCH=`${GCC_NAME} -dumpmachine` \
	-DVERSION=`${GCC_NAME} -dumpversion` \
	<${FILESDIR}/PLIST.template >${PLIST}

.include <bsd.port.mk>

.if !defined(NO_SHARED_LIBS)
M4FLAGS+= -DDYNAMIC
.endif
@


1.51
log
@990629 snapshot
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 1999/06/17 17:06:39 espie Exp $
@


1.50
log
@Bump to 990616

PLIST not verified yet
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 1999/06/02 23:32:47 espie Exp $
d49 1
a49 1
LATEST_DATE=1999-06-16
d57 1
a57 1
#NEXT_DATE=1999-06-16
@


1.49
log
@Update to 990602 snapshot
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 1999/06/01 20:59:34 espie Exp $
d49 1
a49 1
LATEST_DATE=1999-06-02
d57 1
a57 1
#NEXT_DATE=1999-06-02
d209 5
a213 5
	@@if [ -f /usr/lib/libc.so.* ]; \
	then \
		ldd /usr/lib/libc.so.* 2>/dev/null || \
		(${ECHO} "Your ldd must be patched, see ${FILESDIR}/ldd-patch"; ${FALSE}) \
	fi
d399 1
d401 2
a402 2
	${M4} ${M4FLAGS} -DARCH=`${WRKSRC}/config.guess` \
	-DVERSION=`${SED} -e 's/.*"\([a-z]*-[0-9.]*\) .*/\1/' <${WRKSRC}/gcc/version.c` \
@


1.48
log
@Oops, forgot that one.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 1999/05/25 20:18:25 espie Exp $
d49 1
a49 1
LATEST_DATE=1999-05-24
d57 1
a57 1
#NEXT_DATE=1999-05-24
d372 1
a372 1
	[ -f ${TEST_RESULT}] && sh ${TEST_RESULT}
@


1.47
log
@let PLIST work again, since the version number scheme changed...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 1999/05/25 19:55:21 espie Exp $
d328 1
a328 1
SEPARATE_BUILD=yes
@


1.46
log
@990524 snapshot.

Use make `features' properly, variable expansion is tricky...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 1999/05/18 17:07:16 espie Exp $
d401 1
a401 1
	-DVERSION=`${SED} -e 's/.*\(egcs-[0-9.]*\) .*/\1/' <${WRKSRC}/gcc/version.c` \
@


1.45
log
@19990517 compiles and tests okay.

The recent changes to collect2 (needed by java) mean ldd must be updated,
the Makefile now checks for that problem.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 1999/05/14 01:15:29 espie Exp $
d49 1
a49 1
LATEST_DATE=1999-05-17
d57 1
a57 1
#NEXT_DATE=1999-05-17
d302 2
a303 1
--disable-subdir-texinfo
d371 2
a372 2
send-results: ${TEST_RESULT}
	sh ${TEST_RESULT}
@


1.44
log
@Patch configure.in to disable texinfo instead of removing the dir.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 1999/05/05 13:08:21 espie Exp $
d49 1
a49 1
LATEST_DATE=1999-05-02
d57 1
a57 1
#NEXT_DATE=1999-05-02
d204 1
a205 1
pre-fetch:
d209 5
@


1.43
log
@990502 compiles.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 1999/04/29 16:54:19 espie Exp $
a246 1
	-${RM} -rf ${WRKSRC}/texinfo 
d297 1
@


1.42
log
@Update to 990428... remove patches that are now in the official version.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 1999/04/28 15:40:26 espie Exp $
d49 1
a49 1
LATEST_DATE=1999-04-28
d57 1
a57 1
#NEXT_DATE=1999-04-28
@


1.41
log
@Update to 19990418 snapshot

A few odds and end fixed with PLIST.template

Framework to detect the gas i386 problem

Removed bogus patch
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 1999/04/18 20:54:38 espie Exp $
d49 1
a49 1
LATEST_DATE=1999-04-18
d57 1
a57 1
#NEXT_DATE=1999-04-18
d108 1
d113 1
d117 1
a117 1
#MASTER_SITES+=	ftp://egcs.cygnus.com/pub/${DIRECTORY} 
d119 1
a120 1
MASTER_SITES+= ftp://ftp.goof.com/pub/pcg/${DIRECTORY}
@


1.40
log
@Upgrade to 19990412 snapshot

Add a few things to simplify testing still more.

Introduce SUPDISTFILES/SUPPATCHFILES to use by a pending bsd.port.mk...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 1999/03/22 00:25:33 espie Exp $
d49 1
a49 1
LATEST_DATE=1999-04-12
d53 1
a53 2
# define NEXT_DATE to the next snapshot... you lose the ability to check
# md5 sums, though.
d115 1
a115 1
MASTER_SITES+=	ftp://egcs.cygnus.com/pub/${DIRECTORY} 
d201 8
d295 6
a300 1
--verbose --program-transform-name=s,^,e, 
d321 1
a321 1
WRKBUILD=${WRKDIR}/build-${MACHINE_ARCH}
d336 5
d351 2
a352 2
# Tests should be performed at the end of install, since they depend upon
# having the correct flavor of libstdc++.so.
d356 1
a356 1
post-install:
d360 1
a360 1
	@@${ECHO} "Please send the tests results to the egcs projects"
d386 5
@


1.39
log
@???
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 1999/03/07 14:15:33 espie Exp $
d49 1
a49 1
LATEST_DATE=1999-03-14
d58 1
a58 1
NEXT_DATE=1999-03-21
d109 6
a120 1
MASTER_SITES+= ftp://ftp.ninemoons.com/pub/mirrors/${DIRECTORY}
d157 1
d195 5
d202 4
d236 1
a236 1
	#find ${WRKSRC} -name \*.orig|xargs ${RM}
d280 6
a285 1
CONFIGURE_ENV=LANGUAGES='${LANGS}' CFLAGS='-O2'
d328 5
a332 2
	(echo "Make bootstrap failed."; \
	echo "Don't forget to look at ${WRKBUILD}/warnings"; ${FALSE})
d334 2
d337 11
a347 3
post-build:
	@@(cd ${WRKBUILD}; \
	${MAKE_ENV} ${MAKE_PROGRAM} ${MAKE_FLAGS} ${MAKEFILE} check)
a348 3

####
# Install section
@


1.38
log
@- 19990307 snapshot
- consistent version number for libstdc++.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 1999/03/02 04:41:04 marc Exp $
d49 1
a49 1
LATEST_DATE=1999-02-28
d58 1
a58 1
NEXT_DATE=1999-03-07
@


1.37
log
@fix earlier bogus changes to Makefile where a value that
was defined in bsd.port.mk was checked before bsd.port.mk was included;
this should make ports with optional shared libs build on the alpha,
again.  However, chages require the latest bsd.port.mk
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 1999/02/28 18:17:06 espie Exp $
d58 1
a58 1
#NEXT_DATE=1999-02-28
@


1.36
log
@Synch with 19990228 snapshot
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 1999/02/23 16:54:48 espie Exp $
d8 1
a8 1
NEED_VERSION=1.64
d286 1
a286 3
.if !defined(NO_SHARED_LIBS)
CONFIGURE_ARGS+=--enable-shared
.endif
a337 3
.if !defined(NO_SHARED_LIBS)
M4FLAGS+= -DDYNAMIC
.endif
d345 4
@


1.35
log
@Split up tests to post-build.
Assert LD_LIBRARY_PATH, try to avoid tripping up on gcc 2.8.1 libstdc++
while doing the tests...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 1999/02/23 09:28:23 espie Exp $
d49 1
a49 1
LATEST_DATE=1999-02-21
d58 1
a58 1
#NEXT_DATE=1999-02-14
d229 4
d290 1
a292 5
# rebuild configure files after patching, then move source around !!!
# XXX: don't try to autoconf the main configure file, it's not autoconf.
pre-configure:
	cd ${WRKSRC}/gcc && PATH=${PORTPATH} autoreconf
	cd ${WRKSRC}/libiberty && PATH=${PORTPATH} autoreconf
d316 1
a316 2
	${MAKE_ENV} LD_LIBRARY_PATH=${PREFIX}/lib \
	${MAKE_PROGRAM} ${MAKE_FLAGS} ${MAKEFILE} check)
@


1.34
log
@Then upgrade to 980221 snapshot
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 1999/02/21 01:04:59 espie Exp $
a304 3
.if defined(MAKE_TESTS)
ALL_TARGET+=check
.endif
d313 6
@


1.33
log
@Make sure NO_SHARED_LIBS is obeyed.
@
text
@d1 2
a2 7
# OpenBSD makefile for:	egcs
# Version required:	recent enough snapshot, check below
# Date created:		25 sep 98
# Whom:			Marc Espie
#
# $OpenBSD: Makefile,v 1.32 1999/02/20 04:26:13 espie Exp $
#
d21 4
a24 1
# Wim Van Deputte for alpha.
d49 1
a49 1
LATEST_DATE=1999-02-14
@


1.32
log
@This does match what the FSF took in.
If you're wondering about the added blank lines at the end
of all Makefile fragments, just think how it will look when it is
inserted in the Makefile.
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.31 1999/02/18 02:37:32 marc Exp $
d13 1
a13 1
NEED_VERSION=1.60
@


1.31
log
@use NO_SHARED_LIBS instead of test for alpha;
use PLIST.noshared instead of PLIST.alpha
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.30 1999/02/14 19:33:31 espie Exp $
d12 3
a16 2

NEED_VERSION=1.60
a18 1

d300 1
a300 1
# reported to the egcs folks
d340 1
a340 1
.if (${MACHINE_ARCH}) != "alpha")
@


1.30
log
@Update to 990214 snapshot.
This snapshot disables recent loop changes, so the regressions from
990131 -> 990208 should no longer be there, I hope.

Removed patches have been folded back to mainstream.
This is a slight problem, as someone who wants to use an older snapshot
will have to track the CVS history of this port to find out what he
needs...

Fixed small PATH problem with autoreconf, thanks pefo.

New mips tweaks not yet in.
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.29 1999/02/13 00:53:48 espie Exp $
d284 1
a284 1
.if (${MACHINE_ARCH} != "alpha")
@


1.29
log
@Add generic xm* fragments to prevent nasty surprises, such as being
mistaken for systemV :) (and real nasties, too)
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.28 1999/02/09 10:47:44 espie Exp $
d51 1
a51 1
LATEST_DATE=1999-01-31
d60 1
a60 1
NEXT_DATE=1999-02-08
a225 1
	${MV} ${WRKSRC}/libiberty/mkstemp.c ${WRKSRC}/libiberty/mkstemps.c
d293 2
a294 2
	cd ${WRKSRC}/gcc && autoreconf
	cd ${WRKSRC}/libiberty && autoreconf
@


1.28
log
@Forgot yet another WRKBUILD for the PLIST to be generated correctly...
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.27 1999/02/08 20:34:26 espie Exp $
d223 1
a223 1
	find ${WRKSRC} -name \*.orig|xargs ${RM}
@


1.27
log
@Update to 990208 snapshot: mainly kill all patches that I've got into egcs,
synch configure.in line numbers
and add a symbolic MASK_SNAKE I had forgotten for hppa.
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.26 1999/02/06 16:31:14 espie Exp $
d223 1
a223 1
	#find ${WRKSRC} -name \*.orig|xargs ${RM}
d346 1
a346 1
	${M4} ${M4FLAGS} -DARCH=`${WRKDIR}/source/config.guess` \
@


1.26
log
@Cleaning up configuration, and comments...
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.25 1999/02/04 13:21:12 espie Exp $
d60 1
a60 1
#NEXT_DATE=1999-01-17
d317 1
a317 1
	echo "Don't forget to look at ${WRKSRC}/warnings"; ${FALSE})
@


1.25
log
@Fiddle with openbsd.h, rs6000/openbsd.h so that it can include the
current configuration.

Fix blunder in Makefile.
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.24 1999/02/03 18:02:53 espie Exp $
d323 1
a323 1
PLIST=${WRKDIR}/PLIST
@


1.24
log
@Thread support, approximation...
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.23 1999/02/02 01:19:36 espie Exp $
d347 1
a347 1
	-DVERSION=`${SED} -e 's/.*\(egcs-[0-9.]*\) .*/\1/' <${WRKDIR}/source/gcc/version.c` \
@


1.23
log
@Remove ONLY_FOR_ARCHS, makes little sense now...

rs6000 is special, as it incorporates everything into one file...
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.22 1999/01/31 23:20:41 espie Exp $
d15 1
d245 1
a245 1
CONFIGURE_SCRIPT=../source/configure
d264 2
a265 1
CONFIGURE_ENV=CFLAGS='-O2' LANGUAGES='${LANGS}'
d270 3
d289 1
a295 2
	-${MV} ${WRKSRC} ${WRKDIR}/source
	${MKDIR} ${WRKSRC}
d314 1
a314 1
	@@(cd ${WRKSRC}; \
@


1.22
log
@Update to 19990131 snapshot, plus rename libiberty/mkstemp.c to
a more sensible name for autoconfiguration.
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.21 1999/01/24 21:36:11 espie Exp $
a25 1
ONLY_FOR_ARCHS = i386 sparc m68k alpha pa mips
@


1.21
log
@Update to 19990124 snapshot.
Adjust PLIST.template as it was missing some directories.
Rebuild configure.in patch to only add collect2 when needed, plus typo fix.
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.20 1999/01/18 10:23:25 espie Exp $
d48 1
a48 1
#ONE_ARCHIVE=yes
d51 1
a51 1
LATEST_DATE=1999-01-24
d226 1
d264 1
a264 1
CONFIGURE_ENV=CFLAGS='-O2 -g' LANGUAGES='${LANGS}'
@


1.20
log
@Upgrade to 19990117. Fix a few details for integrating pa & alpha.
First shot at mips.
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.19 1999/01/13 13:58:45 espie Exp $
d48 1
a48 1
ONE_ARCHIVE=yes
d51 1
a51 1
LATEST_DATE=1999-01-12
d60 1
a60 1
NEXT_DATE=1999-01-17
@


1.19
log
@A few tweaks, easing the life of c++filt...
documentation for rationale behind new config.
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.18 1999/01/13 00:09:03 espie Exp $
d26 1
a26 1
ONLY_FOR_ARCHS = i386 sparc m68k alpha pa
d39 1
a39 1
#MAKE_CHILL=yes
d60 1
a60 1
#NEXT_DATE=1998-12-20
@


1.18
log
@New snapshot is out.
Upgrade i386.readme to results of previous snapshots.
Come on, give me alpha/sparc test result files :)
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.17 1999/01/12 11:28:44 espie Exp $
d22 4
a25 3
# with some help from Jason L.Wright & Marco S.Hyman for sparc,
# from Michael Shalayeff for hppa,
# from Wim Van Deputte for alpha.
d39 1
a39 1
MAKE_CHILL=yes
@


1.17
log
@spelling family names from memory is a bad idea...
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.16 1999/01/12 11:27:39 espie Exp $
d38 1
a38 1
#MAKE_CHILL=yes
d47 1
a47 1
#ONE_ARCHIVE=yes
d50 1
a50 1
LATEST_DATE=1999-01-03
@


1.16
log
@- fixed up i386/*VTABLE once more... this time for good.
- clean up openbsd.h comments
- add patch to auto-detect mkstemps. Accordingly, need to run
autoreconf in gcc and in libiberty.
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.15 1999/01/12 00:19:49 espie Exp $
d24 1
a24 1
# from Wim Van Den Putte for alpha.
@


1.15
log
@partial archives are no longer bogus.

i386/openbsd.h does include unix.h which yields a perfectly good definition
of the *THUNK macro.

trivial fix to a bug in gcc.c.
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.14 1999/01/10 02:50:02 espie Exp $
d22 3
a24 1
# with some help from Jason L. Wright for sparc...
d38 1
a38 1
MAKE_CHILL=yes
d284 1
a284 1
# rebuild configure file after patching, then move source around !!!
d287 2
a288 1
	cd ${WRKSRC}/gcc && autoconf
d312 1
a312 1
	echo "Don't forget to look at ${WRKSRC}/warnings")
@


1.14
log
@Update to 990103 snapshot.
Inform user of the warnings file in case of a bootstrap crash.

Major change: add alpha & pa configuration, and clean up ALL
openbsd configuration files thoroughly... this is probably going to
break a few things.
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.13 1999/01/09 16:55:27 espie Exp $
d23 1
a23 1
ONLY_FOR_ARCHS = i386 sparc m68k sparc pa
d30 3
a32 2
# as of 19981213, cygnus snapshot packaging scheme is still BROKEN.
# YOU MUST USE THE MAMMOTH ARCHIVE !!!
d35 4
a38 4
#MAKE_FORTRAN=yes
#MAKE_CHILL=yes
#MAKE_OBJC=yes
#MAKE_JAVA=yes
d45 1
a45 1
ONE_ARCHIVE=yes
a87 3
.if defined(MAKE_TESTS)
DISTFILES+=egcs-g++-tests-${LATEST}${EXTRACT_SUFX}
.endif
a91 3
.if defined(MAKE_TESTS)
DISTFILES+=egcs-g77-testsuite-${LATEST}${EXTRACT_SUFX}
.endif
@


1.13
log
@CFLAGS buglet.

autoconf 2.13 available.
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.12 1998/12/21 21:13:01 espie Exp $
d23 1
a23 1
ONLY_FOR_ARCHS = i386 sparc m68k
d34 4
a37 4
MAKE_FORTRAN=yes
MAKE_CHILL=yes
MAKE_OBJC=yes
MAKE_JAVA=yes
d47 1
a47 1
LATEST_DATE=1998-12-20
d225 1
a225 1
	find ${WRKSRC} -name \*.orig|xargs ${RM}
d311 4
a314 2
	@@(cd ${WRKSRC}; ${MAKE_ENV} ${MAKE_PROGRAM} ${MAKE_FLAGS} ${MAKEFILE} ${ALL_TARGET} 2>warnings)

@


1.12
log
@Update to 1998-12-20 snapshot,
update test results as well,
add threads to openbsd.h.
@
text
@d2 1
a2 1
# Version required:	snapshot 1998-11-22
d6 1
a6 1
# $OpenBSD: Makefile,v 1.11 1998/12/19 00:55:44 espie Exp $
d8 1
a8 1
# This is a configuration file for egcs, recent snapshot
a10 1
# Right now, we can only configure i386. Bound to change in the future
d15 1
a15 3
# we HAVE to provide configure NOW, since the autoconf people have not 
# released autoconf 2.12.1, BUT egcs uses that ANYWAY. Fuck !!!
#BUILD_DEPENDS=	autoconf:${PORTSDIR}/devel/autoconf
a21 1
# this will improve over time as more and more architectures are handled
d265 1
a265 1
CONFIGURE_ENV=CFLAGS=-O2 LANGUAGES='${LANGS}'
a288 1
# DON'T invoke autoconf unless you have autoconf >= 2.12.1
d290 1
a290 1
#	cd ${WRKSRC}/gcc && autoconf
@


1.11
log
@checked some mirrors
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.10 1998/12/17 23:04:10 espie Exp $
d51 1
a51 1
LATEST_DATE=1998-12-13
d60 1
a60 1
#NEXT_DATE=1998-12-13
d233 1
a233 1
	for f in `cat ${FILESDIR}/fixdepend`;
@


1.10
log
@Updated to latest snapshot.
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.9 1998/12/17 05:13:23 marc Exp $
d117 43
a159 5
# to do: check egcs-stable mirror list for sites which carry snapshots

MASTER_SITES=	\
	ftp://egcs.cygnus.com/pub/${DIRECTORY} \
	ftp://ftp.lip6.fr/pub/${DIRECTORY}
@


1.9
log
@MIRROR_DISTFILE=no; changes to often to mirror
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.8 1998/12/16 17:52:29 espie Exp $
d34 1
a34 1
# as of 19981122, cygnus snapshot packaging scheme is BROKEN.
d51 1
a51 1
LATEST_DATE=1998-12-06
d60 1
a60 1
NEXT_DATE=1998-12-13
d73 2
a74 2
MASTER_SITE_SUBDIR=${LATEST}
PATCH_SITE_SUBDIR=${NEXT}
a77 1
PATCH_SITES = ${MASTER_SITES}
d119 2
a120 1
MASTER_SITES=	ftp://egcs.cygnus.com/pub/${DIRECTORY} \
d123 1
@


1.8
log
@Update to 19981213 snapshot.
- use new `enable-languages' mechanism,
- depend i386/openbsd.h on flag_pic
- remove temp fix for m68k
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.7 1998/12/05 23:25:58 espie Exp $
d23 1
@


1.7
log
@m68k builds, at least this release!
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.6 1998/12/03 02:33:34 espie Exp $
a25 2

# 981130 builds for m68k, thanks to Andreas Schwab patch !
d50 1
a50 1
LATEST_DATE=1998-11-30
d56 1
d59 1
a59 1
#NEXT_DATE=1998-11-30
a191 3
.if !defined(MAKE_CHILL)
	-${RM} -rf ${WRKSRC}/gcc/ch ${WRKSRC}/libchill
.endif
d193 1
a193 20
	for f in gcc/c-parse.y \
		 gcc/cstamp-h.in \
		 gcc/c-gperf.h \
		 gcc/c-parse.c \
		 gcc/c-parse.h \
		 gcc/cexp.c \
		 gcc/cp/parse.c \
		 gcc/cp/parse.h \
		 gcc/objc/objc-parse.c \
		 gcc/objc/objc-parse.y \
		 gcc/java/parse.h \
		 gcc/java/parse.c \
		 gcc/java/parse-scan.c \
		 libf2c/libU77/stamp-h.in \
		 contrib/fixinc/fixincl.x \
		 contrib/fixinc/inclhack.sh \
		 contrib/fixinc/fixincl.sh \
		 gcc/fixinc/fixincl.x \
		 gcc/fixinc/inclhack.sh \
		 gcc/fixinc/fixincl.sh; \
d212 18
a229 1
CONFIGURE_ENV=CFLAGS=-O2
d231 1
a231 1
--verbose --program-transform-name=s,^,e,
d249 1
@


1.6
log
@Update to snapshot 981130.
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.5 1998/11/25 00:54:02 espie Exp $
d26 3
a28 1
ONLY_FOR_ARCHS = i386 sparc
d52 1
a52 1
LATEST_DATE=1998-11-22
d58 4
a61 2
NEXT_DATE=1998-11-30
PATCH_DEBUG=yes
@


1.5
log
@Moving stuff around, now that we have a better Makefile.
More configurability, newer snapshot, and killed gnu-make
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.4 1998/11/17 17:39:33 espie Exp $
d15 5
a19 1
BUILD_DEPENDS=	autoconf:${PORTSDIR}/devel/autoconf
d56 2
a57 2
#NEXT_DATE=1998-11-22
#PATCH_DEBUG=yes
a182 2
PATCH_LIST+=

d185 2
d192 24
d254 1
d256 1
a256 1
	cd ${WRKSRC}/gcc && autoconf
d307 1
a307 1
	m4 ${M4FLAGS} -DARCH=`${WRKDIR}/source/config.guess` \
@


1.4
log
@Clean Makefile up, mv patches around for conditional inclusion,
add beginning of m68k config.
@
text
@d2 1
a2 1
# Version required:	snapshot 1998-11-09
d6 1
a6 1
# $OpenBSD: Makefile,v 1.3 1998/11/16 21:11:13 espie Exp $
d21 2
a22 1
ONLY_FOR_ARCHS = i386
d28 3
d34 3
d38 3
d42 2
a43 2
# these are broken, as of 1998-11-09
MAKE_CHILL=yes
a44 3
# java archive is truncated, objc too
#MAKE_OBJC=yes
#MAKE_JAVA=yes
d46 1
a46 2

LATEST_DATE=1998-11-09
d52 1
a52 1
# NEXT_DATE=1998-11-20
d73 4
d108 2
d119 4
d148 1
a160 2
# this rigmarole is needed as all patches DON'T necessarily apply 
# to every configuration
d162 1
a162 4
pre-patch:
	-${RM} -f ${PATCHDIR}/*
	-${MKDIR} ${PATCHDIR}
	${CP} ${FILESDIR}/patches/patch-core-* ${PATCHDIR}
d164 13
a176 1
	${CP} ${FILESDIR}/patches/patch-g++-* ${PATCHDIR}
d179 2
d186 1
a186 1
	-${RM} -rf ${WRKSRC}/gcc/ch
a190 1
GNU_CONFIGURE=	yes
d196 1
a196 1
# This should not be used for regular releases, but if you're on this
d198 3
d224 1
a224 1
# rebuild configure file after patching, then move file around !!!
a225 1
# + kludge to build in a separate directory.
d227 1
a227 1
#	cd ${WRKSRC}/gcc && autoconf
d234 2
a235 1
# should work without gmake. If it turns out to be needed, this is a bug
d239 1
a239 1
# use bootstrap-lean if you don't have room.
d242 7
d255 2
d261 2
a262 2
.if defined(MAKE_G77)
M4FLAGS+= -DG77
d267 1
a267 1
.if defined(OBJC)
d270 3
d280 1
a280 4
	<${FILESDIR}/PLIST.template >${PKGDIR}/PLIST

pre-clean:
	-${RM} ${PKGDIR}/PLIST ${PATCHDIR}/*
@


1.3
log
@Update to recent snapshot, make it more configurable too
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.2 1998/10/02 18:57:28 espie Exp $
d8 14
d23 1
a23 2
# This is a configuration file for egcs, recent snapshot
# right now, we only configure i386, C and C++.
a24 1
# user configuration
d26 1
a29 1
MAKE_OBJC=yes
d32 5
a36 2
# these are broken, as of this snapshot...
#MAKE_CHILL=yes
d39 8
a47 1
# this configuration allow for ONE level of diff-files
d49 1
a49 1
LATEST=19981109
d51 2
a52 1
.if defined(NEXT)
a56 3
CATEGORIES=	lang 
MAINTAINER=	Marc.Espie@@openbsd.org

d98 2
d103 3
d135 19
a153 1
# to do: check egcs-stable mirror list for sites which carry snapshots
d155 7
a162 1
BUILD_DEPENDS=	autoconf:${PORTSDIR}/devel/autoconf
a163 2
# will improve over time as more and more architectures are handled
ONLY_FOR_ARCHS = i386
a165 5
USE_GMAKE= yes

# don't make bootstrap if you're impatient/you know what you're doing
# use bootstrap-lean if you don't have room.
ALL_TARGET=bootstrap
d167 6
d177 2
a178 2
--verbose --with-gnu-ld --with-gnu-as \
--program-transform-name=s,^,e,
d180 4
a183 2
.if (${MACHINE_ARCH} != "alpha")
CONFIGURE_ARGS+=--enable-shared
d186 5
d192 2
a193 3
.if defined(NEXT)
post-extract:
	mv ${WRKDIR}/egcs-${LATEST} ${WRKSRC}
a195 5
# get openbsd configuration files where they should be
post-patch:
	cp -R ${FILESDIR}/config/* ${WRKSRC}
	rm -rf ${WRKSRC}/texinfo 

d200 19
a218 3
	cd ${WRKSRC}/gcc && autoconf
	mv ${WRKSRC} ${WRKDIR}/source
	mkdir ${WRKSRC}
d239 1
a239 1
	-DVERSION=`sed -e 's/.*\(egcs-[0-9.]*\) .*/\1/' <${WRKDIR}/source/gcc/version.c` \
d243 1
a243 1
	-rm ${PKGDIR}/PLIST
@


1.2
log
@Slight changes, check compilation on i386.
@
text
@d2 1
a2 1
# Version required:	snapshot 1998-09-21
d6 1
a6 1
# $OpenBSD: Makefile,v 1.1.1.1 1998/09/25 22:45:26 espie Exp $
d12 34
a45 3
LATEST=19980921
DIRECTORY=egcs/snapshots/1998-09-21/
DISTNAME=	egcs-${LATEST}
d48 5
d54 23
a76 2
# see files/tests for testing procedure
DISTFILES+=egcs-tests-${LATEST}${EXTRACT_SUFX}
a77 1
CATEGORIES=	lang 
d81 31
a111 1
MAINTAINER=	Marc.Espie@@openbsd.org
d129 1
a129 1
--verbose \
d136 6
d145 1
a145 1
	rm -rf ${WRKSRC}/texinfo ${WRKSRC}/gcc/ch
d154 25
@


1.1
log
@Initial revision
@
text
@d6 1
a6 1
# $OpenBSD$
d18 3
d27 1
a27 2
# Should be CONFIGURE_DEPENDS, if we had it
DEPENDS=  ${PORTSDIR}/devel/autoconf:${PORTSDIR}/devel/autoconf
d29 2
a30 1
ONLY_FOR_ARCHS= i386
a33 1
MAKE_ENV="CFLAGS=-O2"
d39 1
a39 2
# should remove --enable-shared for alpha
# use --enable-haifa- on some archs (alpha, sparc, pa-risc)
d41 8
a48 2
CONFIGURE_ARGS=--verbose --enable-shared --program-prefix=e
INSTALL_TARGET=	install
a50 5
post-extract:
	cp -R files/* ${WRKSRC}
	rm -rf ${WRKSRC}/texinfo

# we should change libstdc++ name so that we will get the right one
d52 2
a53 2
	
CONFIGURE_SCRIPT=../source/configure
d59 1
a59 1
	cd ${WRKSRC}/gcc && /usr/local/bin/autoconf
@


1.1.1.1
log
@recent egcs snapshot
@
text
@@
