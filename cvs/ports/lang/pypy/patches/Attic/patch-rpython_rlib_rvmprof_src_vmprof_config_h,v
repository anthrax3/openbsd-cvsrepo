head	1.3;
access;
symbols
	OPENBSD_6_0:1.2.0.2
	OPENBSD_6_0_BASE:1.2;
locks; strict;
comment	@# @;


1.3
date	2016.08.15.09.16.40;	author edd;	state dead;
branches;
next	1.2;
commitid	y220xCvgP9gANDG7;

1.2
date	2016.06.13.08.44.17;	author edd;	state Exp;
branches;
next	1.1;
commitid	0Qs53ofqgeK515e6;

1.1
date	2016.04.19.11.14.54;	author edd;	state Exp;
branches;
next	;
commitid	SJlWayhz9PAVXwB9;


desc
@@


1.3
log
@lang/pypy: Fix build for W^X and update to 5.3.1.

Note that the W^X patch only makes the CPython-based no_bootstrap build work,
and that the PyPy JIT itself is still not W^X compliant. This will require more
work.

OK jca@@, thanks.
@
text
@$OpenBSD: patch-rpython_rlib_rvmprof_src_vmprof_config_h,v 1.2 2016/06/13 08:44:17 edd Exp $
--- rpython/rlib/rvmprof/src/vmprof_config.h.orig	Sun Jun  5 16:45:04 2016
+++ rpython/rlib/rvmprof/src/vmprof_config.h	Sun Jun  5 16:47:15 2016
@@@@ -1,10 +1,14 @@@@
+#if !defined(__OpenBSD__)
 #define HAVE_SYS_UCONTEXT_H
+#endif
 #if defined(__FreeBSD__) || defined(__FreeBSD_kernel__)
   #ifdef __i386__
     #define PC_FROM_UCONTEXT uc_mcontext.mc_eip
   #else
     #define PC_FROM_UCONTEXT uc_mcontext.mc_rip
   #endif
+#elif defined(__OpenBSD__)
+#define PC_FROM_UCONTEXT sc_rip
 #elif defined( __APPLE__)
   #if ((ULONG_MAX) == (UINT_MAX))
     #define PC_FROM_UCONTEXT uc_mcontext->__ss.__eip
@


1.2
log
@lang/pypy: Update to 5.3.0.

Looks OK, jca@@, thanks.
@
text
@d1 1
a1 1
$OpenBSD$
@


1.1
log
@lang/pypy: Update to 5.0.1.

Reads OK, sthen@@
@
text
@d2 3
a4 3
--- rpython/rlib/rvmprof/src/vmprof_config.h.orig	Fri Mar 18 17:52:25 2016
+++ rpython/rlib/rvmprof/src/vmprof_config.h	Tue Apr  5 14:43:56 2016
@@@@ -1,6 +1,10 @@@@
d8 6
a13 2
 #if defined(__FreeBSD__) || defined(__APPLE__)
 #define PC_FROM_UCONTEXT uc_mcontext.mc_rip
d16 3
a18 3
 #else
 #define PC_FROM_UCONTEXT uc_mcontext.gregs[REG_RIP]
 #endif
@

