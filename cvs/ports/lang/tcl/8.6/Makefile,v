head	1.16;
access;
symbols
	OPENBSD_6_0:1.16.0.2
	OPENBSD_6_0_BASE:1.16
	OPENBSD_5_9:1.13.0.2
	OPENBSD_5_9_BASE:1.13
	OPENBSD_5_8:1.13.0.4
	OPENBSD_5_8_BASE:1.13
	OPENBSD_5_7:1.12.0.2
	OPENBSD_5_7_BASE:1.12
	OPENBSD_5_6:1.10.0.4
	OPENBSD_5_6_BASE:1.10
	OPENBSD_5_5:1.10.0.2
	OPENBSD_5_5_BASE:1.10
	OPENBSD_5_4:1.6.0.2
	OPENBSD_5_4_BASE:1.6
	OPENBSD_5_3:1.2.0.2
	OPENBSD_5_3_BASE:1.2
	stu_20130202:1.1.1.1
	stu:1.1.1;
locks; strict;
comment	@# @;


1.16
date	2016.06.29.16.14.43;	author espie;	state Exp;
branches;
next	1.15;
commitid	c1yQMbJbfo0CFBcL;

1.15
date	2016.03.15.21.13.32;	author naddy;	state Exp;
branches;
next	1.14;
commitid	ip6F83eeYgRkUET3;

1.14
date	2016.03.11.20.28.27;	author naddy;	state Exp;
branches;
next	1.13;
commitid	UYLP8TE6V7RS2GhJ;

1.13
date	2015.05.22.04.17.01;	author stu;	state Exp;
branches;
next	1.12;
commitid	1z4XWzlHAxv6nkCN;

1.12
date	2014.10.21.05.08.53;	author stu;	state Exp;
branches;
next	1.11;
commitid	nUJwtCApQhe1dLLv;

1.11
date	2014.09.07.18.49.13;	author stu;	state Exp;
branches;
next	1.10;
commitid	mfMxhuNj9srwScLj;

1.10
date	2014.01.11.12.56.41;	author ajacoutot;	state Exp;
branches;
next	1.9;

1.9
date	2013.11.04.16.30.46;	author stu;	state Exp;
branches;
next	1.8;

1.8
date	2013.10.21.19.14.55;	author naddy;	state Exp;
branches;
next	1.7;

1.7
date	2013.09.22.10.33.12;	author stu;	state Exp;
branches;
next	1.6;

1.6
date	2013.07.16.02.48.45;	author stu;	state Exp;
branches;
next	1.5;

1.5
date	2013.07.09.16.14.20;	author stu;	state Exp;
branches;
next	1.4;

1.4
date	2013.07.06.11.05.30;	author stu;	state Exp;
branches;
next	1.3;

1.3
date	2013.03.11.11.20.28;	author espie;	state Exp;
branches;
next	1.2;

1.2
date	2013.02.07.22.46.53;	author stu;	state Exp;
branches;
next	1.1;

1.1
date	2013.02.02.11.15.01;	author stu;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2013.02.02.11.15.01;	author stu;	state Exp;
branches;
next	;


desc
@@


1.16
log
@add is-branch to all trivial ports that exist as multiple branches.
@
text
@# $OpenBSD: Makefile,v 1.15 2016/03/15 21:13:32 naddy Exp $

COMMENT =		Tool Command Language

P =			4
DISTNAME =		tcl8.6.${P}
PKGNAME =		tcl-8.6.${P}
REVISION =		1
SHARED_LIBS =		tcl86 1.2
CATEGORIES =		lang lang/tcl
HOMEPAGE =		http://www.tcl.tk/
MAINTAINER =		Stuart Cassoff <stwo@@users.sourceforge.net>

# BSD
PERMIT_PACKAGE_CDROM =	Yes

WANTLIB =		c m pthread z

MASTER_SITES =		${MASTER_SITE_SOURCEFORGE:=tcl/}
DISTFILES =		tcl-core8.6.${P}-src.tar.gz

MAKE_FLAGS =		TCL_LIBRARY='$$(prefix)/lib/tcl/tcl$$(VERSION)'

FAKE_FLAGS =		INSTALL_DATA_DIR="${INSTALL_DATA_DIR}" \
			INSTALL_LIBRARY="${INSTALL_DATA}" \
			INSTALL_DATA="${INSTALL_DATA}" \
			INSTALL_PROGRAM="${INSTALL_PROGRAM}" \
			CONFIG_INSTALL_DIR='$$(SCRIPT_INSTALL_DIR)' \
			INSTALL_PACKAGE_TARGETS=''

TEST_FLAGS =		HOME=${TESTHOME} TESTFLAGS="${TESTFLAGS}"
SEPARATE_BUILD =	Yes
USE_GROFF =		Yes
CONFIGURE_STYLE =	gnu old

CONFIGURE_ARGS +=	--includedir="${PREFIX}/include/tcl8.6" \
			--mandir="${PREFIX}/lib/tcl/tcl8.6/man" \
			--sysconfdir="${SYSCONFDIR}" \
			--enable-man-symlinks \
			--disable-rpath \
			EXTRA_INSTALL_BINARIES='@@echo "Installing libtcl86.a to $$(LIB_INSTALL_DIR)/" \
			&& $$(INSTALL_DATA) libtcl86.a $$(LIB_INSTALL_DIR)/libtcl86.a \
			&& (cd $$(LIB_INSTALL_DIR) ; $$(RANLIB) libtcl86.a)' \
			SHLIB_VERSION="${LIBtcl86_VERSION}"

ALL_TARGET =		binaries libtcl86.a

WRKSRC =		${WRKDIST}/unix
TEST_TARGET =		test-tcl

TESTHOME =		${WRKDIR}/testhome
# Use TESTFLAGS to control the Tcl tests
TESTFLAGS =

# These tests will always fail due to assumptions that don't hold on OpenBSD.
# Skip them until they're improved.
# fCmd-9.4.b expects to be able to overwrite a read-only directory.
# http-4.14 and many socket-14.* expect certain socket errors to occur
#   later rather than sooner. Bug 2911139.
TESTFLAGS += -skip 'fCmd-9.4.b http-4.14 socket-14.*'

pre-configure:
	@@${SUBST_CMD} ${WRKDIST}/library/init.tcl

pre-test:
	mkdir -p ${TESTHOME}

post-install:
	${INSTALL_DATA} ${WRKDIST}/license.terms ${PREFIX}/lib/tcl/tcl8.6/man
	ln -s libtcl86.a ${PREFIX}/lib/libtcl86_pic.a
	ln -s libtclstub86.a ${PREFIX}/lib/libtclstub86_pic.a

.include <bsd.port.mk>
@


1.15
log
@get rid of NO_SHARED_LIBS and PFRAG.shared
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2016/03/11 20:28:27 naddy Exp $
d8 1
a8 1
REVISION =		0
@


1.14
log
@garbage collect CONFIGURE_SHARED
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2015/05/22 04:17:01 stu Exp $
d8 1
d41 3
d46 1
a46 10
.include <bsd.port.arch.mk>

ALL_TARGET =		binaries

.if ${NO_SHARED_LIBS:L} == "no"
ALL_TARGET +=		libtcl86.a
CONFIGURE_ARGS +=	EXTRA_INSTALL_BINARIES='@@echo "Installing libtcl86.a to $$(LIB_INSTALL_DIR)/" \
			&& $$(INSTALL_DATA) libtcl86.a $$(LIB_INSTALL_DIR)/libtcl86.a \
			&& (cd $$(LIB_INSTALL_DIR) ; $$(RANLIB) libtcl86.a)'
.endif
a69 1
.if ${NO_SHARED_LIBS:L} == "no"
a71 1
.endif
@


1.13
log
@Update to 8.6.4.

Discontinue the installation of private header files.
Discontinue patching an irrelevant file.
Use INSTALL_* as with the other Tcl/Tk ports. Better stripping.
Setup Tcl package path at configure time.
Cleanup README and adjust for new man.conf.
Improved lib/package/module path config/runtime.
Skip tests that will always fail due to assumptions that don't hold on OpenBSD.
Port improvements for less diff churn on future port updates.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2014/10/21 05:08:53 stu Exp $
d35 1
a35 2
CONFIGURE_ARGS +=	${CONFIGURE_SHARED} \
			--includedir="${PREFIX}/include/tcl8.6" \
@


1.12
log
@Remove unecessary dir in Tcl's own module path.
Adjust extension module path to not conflict with anything in SUBST_VARS.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2014/09/07 18:49:13 stu Exp $
d5 4
a8 4
DISTNAME =		tcl8.6.2
PKGNAME =		tcl-8.6.2
REVISION =		0
SHARED_LIBS =		tcl86 1.1
d19 1
a19 1
DISTFILES =		tcl-core8.6.2-src.tar.gz
d21 1
a21 2
MAKE_FLAGS +=		TCL_PACKAGE_PATH='$$(prefix)/lib/tcl' \
			TCL_LIBRARY='$$(prefix)/lib/tcl/tcl$$(VERSION)'
d23 6
a28 2
FAKE_FLAGS =		INSTALL_PACKAGE_TARGETS='' \
			CONFIG_INSTALL_DIR='$$(SCRIPT_INSTALL_DIR)'
a40 1
			EXTRA_INSTALL="install-private-headers" \
d45 2
d48 1
a48 1
ALL_TARGET =		binaries libtcl86.a
a51 2
.else
ALL_TARGET =		binaries
a55 1
SUBST_VARS +=		_README_DIR
d61 7
d69 1
a69 1
	@@${SUBST_CMD} ${WRKSRC}/installManPage
@


1.11
log
@Update to 8.6.2.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2014/01/11 12:56:41 ajacoutot Exp $
d7 1
@


1.10
log
@Do not hardcode /usr/local.
Do not use SYSCONFDIR for base system etc files.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2013/11/04 16:30:46 stu Exp $
d5 3
a7 4
DISTNAME =		tcl8.6.1
PKGNAME =		tcl-8.6.1
REVISION =		2
SHARED_LIBS =		tcl86 0.1
d18 1
a18 1
DISTFILES =		tcl-core8.6.1-src.tar.gz
@


1.9
log
@Unbreak man page rendering. Thanks to schwarze@@ for roff help.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2013/10/21 19:14:55 naddy Exp $
d7 1
a7 1
REVISION =		1
@


1.8
log
@remove local changes to generate cat man pages and instead just
install the source man pages; ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2013/09/22 10:33:12 stu Exp $
d7 1
a7 1
REVISION =		0
@


1.7
log
@Update to 8.6.1.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2013/07/16 02:48:45 stu Exp $
d7 1
d25 1
a25 4
			CONFIG_INSTALL_DIR='$$(SCRIPT_INSTALL_DIR)' \
			MAN1_INSTALL_DIR='$$(MAN_INSTALL_DIR)/cat1' \
			MAN3_INSTALL_DIR='$$(MAN_INSTALL_DIR)/cat3' \
			MANN_INSTALL_DIR='$$(MAN_INSTALL_DIR)/catn'
@


1.6
log
@Sync patch in README with recent /etc/man.conf changes.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2013/07/09 16:14:20 stu Exp $
d5 3
a7 4
DISTNAME =		tcl8.6.0
PKGNAME =		tcl-8.6.0
REVISION =		3
SHARED_LIBS =		tcl86 0.0
d18 1
a18 1
DISTFILES =		tcl-core8.6.0-src.tar.gz
a49 1
CONFIGURE_ARGS +=	tcl_cv_ld_elf=yes
@


1.5
log
@Don't misrename manpages.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2013/07/06 11:05:30 stu Exp $
d7 1
a7 1
REVISION =		2
@


1.4
log
@M88k is elf now.
Skip unneeded elf check in configure.
Whitespace tweaks.

Thanks to miod@@ for original patch.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2013/03/11 11:20:28 espie Exp $
d7 1
a7 1
REVISION =		1
@


1.3
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2013/02/07 22:46:53 stu Exp $
d7 1
a7 1
REVISION =		0
d51 1
d57 1
a57 1
TEST_TARGET =	test-tcl
@


1.2
log
@Use the core dist instead of the bundled one.

ok landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2013/02/02 11:15:01 stu Exp $
a14 3
PERMIT_PACKAGE_FTP =	Yes
PERMIT_DISTFILES_CDROM =Yes
PERMIT_DISTFILES_FTP =	Yes
d30 1
a30 1
REGRESS_FLAGS =		HOME=${TESTHOME} TESTFLAGS="${TESTFLAGS}"
d56 1
a56 1
REGRESS_TARGET =	test-tcl
d66 1
a66 1
pre-regress:
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d7 1
d22 1
a22 1
DISTFILES =		${DISTNAME}-src.tar.gz
@


1.1.1.1
log
@Import Tcl 8.6.0
Highlights: OO, IPV6, coroutines, zlib, threads
Release info: http://tcl.tk/software/tcltk/8.6.html

ok landry@@, sthen@@
@
text
@@
