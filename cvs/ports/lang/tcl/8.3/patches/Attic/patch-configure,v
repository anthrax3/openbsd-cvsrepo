head	1.12;
access;
symbols
	OPENBSD_4_2:1.11.0.4
	OPENBSD_4_2_BASE:1.11
	OPENBSD_4_1:1.11.0.2
	OPENBSD_4_1_BASE:1.11
	OPENBSD_4_0:1.10.0.4
	OPENBSD_4_0_BASE:1.10
	OPENBSD_3_9:1.10.0.2
	OPENBSD_3_9_BASE:1.10
	OPENBSD_3_8:1.9.0.12
	OPENBSD_3_8_BASE:1.9
	OPENBSD_3_7:1.9.0.10
	OPENBSD_3_7_BASE:1.9
	OPENBSD_3_6:1.9.0.8
	OPENBSD_3_6_BASE:1.9
	OPENBSD_3_5:1.9.0.6
	OPENBSD_3_5_BASE:1.9
	OPENBSD_3_4:1.9.0.4
	OPENBSD_3_4_BASE:1.9
	OPENBSD_3_3:1.9.0.2
	OPENBSD_3_3_BASE:1.9
	OPENBSD_3_2:1.8.0.4
	OPENBSD_3_2_BASE:1.8
	OPENBSD_3_1:1.8.0.2
	OPENBSD_3_1_BASE:1.8
	OPENBSD_3_0:1.5.0.2
	OPENBSD_3_0_BASE:1.5
	OPENBSD_2_9_TRACKING_SWITCH:1.2;
locks; strict;
comment	@# @;


1.12
date	2007.10.24.15.40.18;	author steven;	state dead;
branches;
next	1.11;

1.11
date	2006.10.18.13.10.37;	author naddy;	state Exp;
branches;
next	1.10;

1.10
date	2006.01.08.12.57.04;	author alek;	state Exp;
branches;
next	1.9;

1.9
date	2002.11.29.09.45.51;	author kevlo;	state Exp;
branches;
next	1.8;

1.8
date	2001.11.20.07.21.17;	author pvalchev;	state Exp;
branches;
next	1.7;

1.7
date	2001.10.26.06.48.23;	author kevlo;	state Exp;
branches;
next	1.6;

1.6
date	2001.10.24.14.37.53;	author brad;	state Exp;
branches;
next	1.5;

1.5
date	2001.10.10.01.01.44;	author pvalchev;	state Exp;
branches;
next	1.4;

1.4
date	2001.10.08.09.21.38;	author matthieu;	state Exp;
branches;
next	1.3;

1.3
date	2001.09.08.18.24.32;	author pvalchev;	state Exp;
branches;
next	1.2;

1.2
date	2001.08.04.18.10.35;	author pvalchev;	state Exp;
branches;
next	1.1;

1.1
date	2001.05.12.08.57.24;	author kevlo;	state Exp;
branches;
next	;


desc
@@


1.12
log
@remove old tcl/tk 8.3

ok naddy
@
text
@$OpenBSD: patch-configure,v 1.11 2006/10/18 13:10:37 naddy Exp $
--- configure.orig	Fri Oct 18 22:44:46 2002
+++ configure	Wed Oct 18 13:02:50 2006
@@@@ -5443,7 +5443,7 @@@@ if eval "test \"`echo '$ac_cv_header_'$a
   
 		# NetBSD/SPARC needs -fPIC, -fpic will not do.
 		SHLIB_CFLAGS="-fPIC"
-		SHLIB_LD="ld -Bshareable -x"
+		SHLIB_LD="${CC} -shared ${SHLIB_CFLAGS}"
 		SHLIB_LD_LIBS=""
 		SHLIB_SUFFIX=".so"
 		DL_OBJS="tclLoadDl.o"
@@@@ -5465,11 +5465,11 @@@@ if (eval "$ac_cpp conftest.$ac_ext") 2>&
   egrep "yes" >/dev/null 2>&1; then
   rm -rf conftest*
   echo "$ac_t""yes" 1>&6
-		    SHARED_LIB_SUFFIX='${TCL_TRIM_DOTS}\$\{DBGX\}.so'
+		    SHARED_LIB_SUFFIX='${TCL_TRIM_DOTS}\$\{DBGX\}.so.${LIBtcl83_VERSION}'
 else
   rm -rf conftest*
   echo "$ac_t""no" 1>&6
-		    SHARED_LIB_SUFFIX='${TCL_TRIM_DOTS}\$\{DBGX\}.so.1.0'
+		    SHARED_LIB_SUFFIX='${TCL_TRIM_DOTS}\$\{DBGX\}.so.${LIBtcl83_VERSION}'
 		
 fi
 rm -f conftest*
@@@@ -6292,7 +6292,7 @@@@ else
     esac
     TCL_SHLIB_CFLAGS=""
     eval "TCL_LIB_FILE=libtcl${TCL_UNSHARED_LIB_SUFFIX}"
-    MAKE_LIB="\${STLIB_LD} \$@@ \${OBJS}"
+    MAKE_LIB="\${STLIB_LD} \${TCL_LIB_FILE} \${OBJS}; \${RANLIB} \${TCL_LIB_FILE}"
 fi
 
 # tclConfig.sh needs a version of the _LIB_SUFFIX that has been eval'ed
@@@@ -6359,7 +6359,7 @@@@ eval "TCL_STUB_LIB_FILE=libtclstub${TCL_
 # Replace DBGX with TCL_DBGX
 eval "TCL_STUB_LIB_FILE=\"${TCL_STUB_LIB_FILE}\""
 
-MAKE_STUB_LIB="\${STLIB_LD} \$@@ \${STUB_LIB_OBJS}"
+MAKE_STUB_LIB="\${STLIB_LD} \${TCL_STUB_LIB_FILE} \${STUB_LIB_OBJS}; \${RANLIB} \${TCL_STUB_LIB_FILE}"
 
 if test "${TCL_LIB_VERSIONS_OK}" = "ok"; then
     TCL_STUB_LIB_FLAG="-ltclstub${TCL_VERSION}\${TCL_DBGX}"
@


1.11
log
@unconditionally use -fPIC (over -fpic)
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.10 2006/01/08 12:57:04 alek Exp $
@


1.10
log
@SHARED_LIBS
@
text
@d1 4
a4 6
$OpenBSD: patch-configure,v 1.9 2002/11/29 09:45:51 kevlo Exp $
--- configure.orig	Fri Oct 18 20:44:46 2002
+++ configure	Fri Nov 29 16:28:19 2002
@@@@ -5441,9 +5441,14 @@@@ fi
 if eval "test \"`echo '$ac_cv_header_'$ac_safe`\" = yes"; then
   echo "$ac_t""yes" 1>&6
d6 2
a7 2
-		# NetBSD/SPARC needs -fPIC, -fpic will not do.
-		SHLIB_CFLAGS="-fPIC"
a8 7
+		# OpenBSD/SPARC[64] needs -fPIC, -fpic will not do.
+		case `machine` in
+		sparc|sparc64)
+			SHLIB_CFLAGS="-fPIC";;
+		*)
+			SHLIB_CFLAGS="-fpic";;
+		esac
d13 1
a13 1
@@@@ -5465,11 +5470,11 @@@@ if (eval "$ac_cpp conftest.$ac_ext") 2>&
d27 1
a27 1
@@@@ -6292,7 +6297,7 @@@@ else
d36 1
a36 1
@@@@ -6359,7 +6364,7 @@@@ eval "TCL_STUB_LIB_FILE=libtclstub${TCL_
@


1.9
log
@upgrade to 8.3.5
@
text
@d1 1
a1 1
$OpenBSD$
d27 1
a27 1
+		    SHARED_LIB_SUFFIX='${TCL_TRIM_DOTS}\$\{DBGX\}.so.1.3'
d32 1
a32 1
+		    SHARED_LIB_SUFFIX='${TCL_TRIM_DOTS}\$\{DBGX\}.so.1.3'
@


1.8
log
@libdl hacks no more
@
text
@d1 4
a4 3
--- configure.orig	Fri Oct 19 18:24:15 2001
+++ configure	Mon Nov 19 23:25:15 2001
@@@@ -5328,9 +5328,14 @@@@ fi
d11 1
a11 1
+		# OpenBSD/SPARC needs -fPIC, -fpic will not do.
d13 1
a13 1
+		sparc*)
d16 1
a16 1
+ 			SHLIB_CFLAGS="-fpic";;
d22 1
a22 1
@@@@ -5352,11 +5357,11 @@@@ if (eval "$ac_cpp conftest.$ac_ext") 2>&
d36 10
a45 10
@@@@ -6101,7 +6106,7 @@@@ if test "${SHARED_BUILD}" = "1" -a "${SH
     TCL_SHLIB_CFLAGS="${SHLIB_CFLAGS}"
     eval "TCL_LIB_FILE=libtcl${TCL_SHARED_LIB_SUFFIX}"
     if test "x$DL_OBJS" = "xtclLoadAout.o"; then
-	MAKE_LIB="\${STLIB_LD} \$@@ \${OBJS}"
+	MAKE_LIB="\${STLIB_LD} \${TCL_LIB_FILE} \${OBJS}; \${RANLIB} \${TCL_LIB_FILE}"
     else
 	MAKE_LIB="\${SHLIB_LD} ${TCL_SHLIB_LD_EXTRAS} -o \$@@ \${OBJS} ${SHLIB_LD_LIBS}"
     fi
@@@@ -6186,7 +6191,7 @@@@ eval "TCL_STUB_LIB_FILE=libtclstub${TCL_
@


1.7
log
@- upgrade to version 8.3.4
- fix CATEGORIES
- bump NEED_VERSION
@
text
@d1 3
a3 3
--- configure.orig	Fri Oct 26 13:02:59 2001
+++ configure	Fri Oct 26 13:34:07 2001
@@@@ -5328,13 +5328,23 @@@@
d21 1
a21 11
-		DL_LIBS=""
+		case `echo __ELF__ | gcc -E - | grep __ELF__` in
+		__ELF__)
+			DL_LIBS="";;
+		*)
+			DL_LIBS="-ldl";;
+		esac
 		LDFLAGS=""
 		LD_SEARCH_FLAGS='-Wl,-rpath,${LIB_RUNTIME_DIR}'
 		echo $ac_n "checking for ELF""... $ac_c" 1>&6
@@@@ -5352,11 +5362,11 @@@@
d35 1
a35 1
@@@@ -6101,7 +6111,7 @@@@
d44 1
a44 1
@@@@ -6186,7 +6196,7 @@@@
@


1.6
log
@We get 64bit bins by default on 64bit archs. There is no need to add
this crap.
@
text
@d1 3
a3 4
$OpenBSD: patch-configure,v 1.5 2001/10/10 01:01:44 pvalchev Exp $
--- configure.orig	Fri Apr  6 14:51:46 2001
+++ configure	Wed Oct 24 10:25:17 2001
@@@@ -5112,13 +5112,23 @@@@ fi
d13 4
a16 4
+		    SHLIB_CFLAGS="-fPIC";;
+		 *)
+		    SHLIB_CFLAGS="-fpic";;
+	        esac
d31 1
a31 1
@@@@ -5136,11 +5146,11 @@@@ if (eval "$ac_cpp conftest.$ac_ext") 2>&
d45 2
a46 2
@@@@ -5848,10 +5858,9 @@@@ if test "${SHARED_BUILD}" = "1" -a "${SH
     TCL_LD_SEARCH_FLAGS="${LD_SEARCH_FLAGS}"
d49 2
a50 2
-	MAKE_LIB="ar cr \${TCL_LIB_FILE} \${OBJS}"
+	MAKE_LIB="ar cr \${TCL_LIB_FILE} \${OBJS}; \${RANLIB} \${TCL_LIB_FILE}"
d52 1
a52 2
 	MAKE_LIB="\${SHLIB_LD} -o \${TCL_LIB_FILE} \${OBJS} ${SHLIB_LD_LIBS}"
-	RANLIB=":"
d54 1
a54 3
 else
     case $system in
@@@@ -5935,7 +5944,7 @@@@ eval "STUB_LIB_FILE=libtclstub${TCL_UNSH
d56 1
a56 4
 eval "STUB_LIB_FILE=\"${STUB_LIB_FILE}\""
 
-MAKE_STUB_LIB="ar cr \${STUB_LIB_FILE} \${STUB_LIB_OBJS}"
+MAKE_STUB_LIB="ar cr \${STUB_LIB_FILE} \${STUB_LIB_OBJS}; \${RANLIB} \${STUB_LIB_FILE}"
d58 2
a59 1
 TCL_STUB_LIB_FILE=${STUB_LIB_FILE}
d61 2
@


1.5
log
@Link with libdl on all ELF platforms, instead of fixing those for every
case one by one; fixes alpha.  Relies on __ELF__ being predefined.
tested on i386, ppc, alpha
@
text
@d1 3
a3 3
$OpenBSD: patch-configure,v 1.4 2001/10/08 09:21:38 matthieu Exp $
--- configure.orig	Fri Apr  6 12:51:46 2001
+++ configure	Tue Oct  9 00:02:00 2001
d46 1
a46 13
@@@@ -5161,7 +5171,10 @@@@ else
 	    
 fi
 
-
+	    if test "$do64bit" = "yes" ; then
+		 do64bit_ok=yes
+	    fi
+	    
 	    # FreeBSD doesn't handle version numbers with dots.
 
 	    UNSHARED_LIB_SUFFIX='${TCL_TRIM_DOTS}\$\{DBGX\}.a'
@@@@ -5848,10 +5861,9 @@@@ if test "${SHARED_BUILD}" = "1" -a "${SH
d58 1
a58 1
@@@@ -5935,7 +5947,7 @@@@ eval "STUB_LIB_FILE=libtclstub${TCL_UNSH
@


1.4
log
@First pass at getting tcl 8.3 working on sparc64.
A number of regression tests fail though. ok pvalchev@@
@
text
@d1 4
a4 4
$OpenBSD: patch-configure,v 1.3 2001/09/08 18:24:32 pvalchev Exp $
--- configure.orig	Fri Apr  6 20:51:46 2001
+++ configure	Sun Oct  7 02:52:49 2001
@@@@ -5112,13 +5112,23 @@@@
d23 4
a26 2
+		case `arch -s` in
+		powerpc|sparc64)
a27 2
+		*)
+			DL_LIBS="";;
d32 1
a32 1
@@@@ -5136,11 +5146,11 @@@@
d46 1
a46 1
@@@@ -5161,7 +5171,10 @@@@
d58 1
a58 1
@@@@ -5848,10 +5861,9 @@@@
d70 1
a70 1
@@@@ -5935,7 +5947,7 @@@@
@


1.3
log
@`machine` -> `arch -s` to reflect powerpc-based ports name change
and make this work again
@
text
@d1 4
a4 4
$OpenBSD: patch-configure,v 1.2 2001/08/04 18:10:35 pvalchev Exp $
--- configure.orig	Fri Apr  6 12:51:46 2001
+++ configure	Sat Sep  8 11:52:47 2001
@@@@ -5112,13 +5112,23 @@@@ fi
d13 1
a13 1
+		sparc)
d24 1
a24 1
+		powerpc)
d32 1
a32 1
@@@@ -5136,11 +5146,11 @@@@ if (eval "$ac_cpp conftest.$ac_ext") 2>&
d46 13
a58 1
@@@@ -5848,10 +5858,9 @@@@ if test "${SHARED_BUILD}" = "1" -a "${SH
d70 1
a70 1
@@@@ -5935,7 +5944,7 @@@@ eval "STUB_LIB_FILE=libtclstub${TCL_UNSH
@


1.2
log
@build correct shared libraries on ELF platforms.  tested on powerpc, ok brad
@
text
@d1 3
a3 3
$OpenBSD$
--- configure.orig	Fri Apr  6 11:51:46 2001
+++ configure	Fri Aug  3 22:12:29 2001
d23 1
a23 1
+		case `machine` in
@


1.1
log
@upgrade to version 8.3.3
@
text
@d1 4
a4 3
--- configure.orig	Tue Aug  8 14:17:11 2000
+++ configure	Thu Nov  2 10:19:48 2000
@@@@ -5063,13 +5063,23 @@@@
d32 6
a37 1
@@@@ -5091,7 +5101,7 @@@@
d46 1
a46 1
@@@@ -5787,10 +5797,9 @@@@
d58 1
a58 1
@@@@ -5874,7 +5883,7 @@@@
@

