head	1.5;
access;
symbols
	OPENBSD_2_9_TRACKING_SWITCH:1.3
	OPENBSD_2_9:1.3.0.2
	OPENBSD_2_9_BASE:1.3
	OPENBSD_2_8:1.2.0.2
	OPENBSD_2_8_BASE:1.2
	OPENBSD_2_7:1.1.1.1.0.2
	OPENBSD_2_7_BASE:1.1.1.1
	kevlo_2000-Mar-27:1.1.1.1
	kevlo:1.1.1;
locks; strict;
comment	@# @;


1.5
date	2001.10.10.04.17.40;	author pvalchev;	state dead;
branches;
next	1.4;

1.4
date	2001.09.08.18.24.32;	author pvalchev;	state Exp;
branches;
next	1.3;

1.3
date	2001.03.08.02.25.34;	author brad;	state Exp;
branches;
next	1.2;

1.2
date	2000.11.02.17.31.33;	author espie;	state Exp;
branches;
next	1.1;

1.1
date	2000.03.27.02.08.46;	author kevlo;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2000.03.27.02.08.46;	author kevlo;	state Exp;
branches;
next	;


desc
@@


1.5
log
@- Link with -ldl on all ELF platforms
- Rename patches while here
@
text
@--- configure.orig	Tue Mar  9 01:51:26 1999
+++ configure	Wed Mar  7 20:55:25 2001
@@@@ -4095,16 +4095,26 @@@@
 fi
 if eval "test \"`echo '$ac_cv_header_'$ac_safe`\" = yes"; then
   echo "$ac_t""yes" 1>&6
-  
-	    SHLIB_CFLAGS="-fpic"
-	    SHLIB_LD="ld -Bshareable -x"
+
+	    case `machine` in
+	    sparc)
+		SHLIB_CFLAGS="-fPIC";;
+	    *)
+		SHLIB_CFLAGS="-fpic";;
+	    esac
+	    SHLIB_LD="${CC} -shared ${SHLIB_CFLAGS}"
 	    SHLIB_LD_LIBS=""
 	    SHLIB_SUFFIX=".so"
 	    DL_OBJS="tclLoadDl.o"
-	    DL_LIBS=""
+	    case `arch -s` in
+	    powerpc)
+		    DL_LIBS="-ldl";;
+	    *)
+		    DL_LIBS="";;
+	    esac
 	    LD_FLAGS=""
 	    LD_SEARCH_FLAGS=""
-	    TCL_SHARED_LIB_SUFFIX='${TCL_TRIM_DOTS}\$\{DBGX\}.so.1.0'
+	    TCL_SHARED_LIB_SUFFIX='${TCL_TRIM_DOTS}\$\{DBGX\}.so.1.5'
 	
 else
   echo "$ac_t""no" 1>&6
@@@@ -4656,10 +4666,9 @@@@
     TCL_LD_SEARCH_FLAGS="${LD_SEARCH_FLAGS}"
     eval "TCL_LIB_FILE=libtcl${TCL_SHARED_LIB_SUFFIX}"
     if test "x$DL_OBJS" = "xtclLoadAout.o"; then
-	MAKE_LIB="ar cr \${TCL_LIB_FILE} \${OBJS}"
+	MAKE_LIB="ar cr \${TCL_LIB_FILE} \${OBJS}; \${RANLIB} \${TCL_LIB_FILE}"
     else
 	MAKE_LIB="\${SHLIB_LD} -o \${TCL_LIB_FILE} \${OBJS} ${SHLIB_LD_LIBS}"
-	RANLIB=":"
     fi
 else
     TCL_SHARED_BUILD=0
@


1.4
log
@`machine` -> `arch -s` to reflect powerpc-based ports name change
and make this work again
@
text
@@


1.3
log
@don't hardcode compiler when linking the shared library.
@
text
@d22 1
a22 1
+	    case `machine` in
@


1.2
log
@Allow powerpc build, use -shared everywhere.
From drahn@@
@
text
@d1 2
a2 2
--- configure.orig	Tue Mar  9 00:51:26 1999
+++ configure	Thu Nov  2 09:56:59 2000
d17 1
a17 1
+	    SHLIB_LD="cc -shared ${SHLIB_CFLAGS}"
@


1.1
log
@Initial revision
@
text
@d1 3
a3 3
--- configure.orig	Tue Mar  9 01:51:26 1999
+++ configure	Thu Jan 13 18:03:25 2000
@@@@ -4095,16 +4095,21 @@@@
d17 1
a17 1
+	    SHLIB_LD="ld -Bshareable -Bforcearchive -x"
d21 7
a27 1
 	    DL_LIBS=""
d35 1
a35 1
@@@@ -4656,10 +4661,9 @@@@
@


1.1.1.1
log
@Initial import of tcl
@
text
@@
