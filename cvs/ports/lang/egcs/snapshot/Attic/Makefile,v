head	1.100;
access;
symbols
	OPENBSD_3_6:1.98.0.4
	OPENBSD_3_6_BASE:1.98
	OPENBSD_3_5:1.98.0.2
	OPENBSD_3_5_BASE:1.98
	OPENBSD_3_4:1.94.0.2
	OPENBSD_3_4_BASE:1.94
	OPENBSD_3_3:1.91.0.4
	OPENBSD_3_3_BASE:1.91
	OPENBSD_3_2:1.91.0.2
	OPENBSD_3_2_BASE:1.91
	OPENBSD_3_1:1.87.0.2
	OPENBSD_3_1_BASE:1.87
	OPENBSD_3_0:1.86.0.2
	OPENBSD_3_0_BASE:1.86
	OPENBSD_2_9_TRACKING_SWITCH:1.84
	OPENBSD_2_9:1.84.0.2
	OPENBSD_2_9_BASE:1.84
	OPENBSD_2_8:1.81.0.2
	OPENBSD_2_8_BASE:1.81
	OPENBSD_2_7:1.72.0.2
	OPENBSD_2_7_BASE:1.72
	OPENBSD_2_6:1.56.0.2
	OPENBSD_2_6_BASE:1.56
	OPENBSD_2_5:1.39.0.2
	OPENBSD_2_5_BASE:1.39
	OPENBSD_2_4:1.2.0.2
	OPENBSD_2_4_BASE:1.2
	ss-19980921:1.1.1.1
	OpenBSD-ports:1.1.1;
locks; strict;
comment	@# @;


1.100
date	2004.10.16.19.28.43;	author espie;	state dead;
branches;
next	1.99;

1.99
date	2004.09.15.19.16.07;	author espie;	state Exp;
branches;
next	1.98;

1.98
date	2003.11.19.10.07.04;	author espie;	state Exp;
branches;
next	1.97;

1.97
date	2003.11.19.01.40.23;	author espie;	state Exp;
branches;
next	1.96;

1.96
date	2003.11.15.16.51.52;	author espie;	state Exp;
branches;
next	1.95;

1.95
date	2003.11.13.19.04.09;	author espie;	state Exp;
branches;
next	1.94;

1.94
date	2003.08.26.17.11.08;	author sturm;	state Exp;
branches;
next	1.93;

1.93
date	2003.06.10.15.43.20;	author brad;	state Exp;
branches;
next	1.92;

1.92
date	2003.04.10.18.08.56;	author jsyn;	state Exp;
branches;
next	1.91;

1.91
date	2002.09.19.11.57.36;	author naddy;	state Exp;
branches;
next	1.90;

1.90
date	2002.09.18.15.35.39;	author espie;	state Exp;
branches;
next	1.89;

1.89
date	2002.06.06.13.46.39;	author espie;	state Exp;
branches;
next	1.88;

1.88
date	2002.06.05.23.58.49;	author espie;	state Exp;
branches;
next	1.87;

1.87
date	2001.11.10.15.00.48;	author espie;	state Exp;
branches;
next	1.86;

1.86
date	2001.09.30.19.36.46;	author espie;	state Exp;
branches;
next	1.85;

1.85
date	2001.09.10.23.55.11;	author miod;	state Exp;
branches;
next	1.84;

1.84
date	2001.03.21.14.44.01;	author wilfried;	state Exp;
branches;
next	1.83;

1.83
date	2001.03.17.16.15.50;	author wilfried;	state Exp;
branches;
next	1.82;

1.82
date	2001.03.16.15.53.15;	author espie;	state Exp;
branches;
next	1.81;

1.81
date	2000.10.22.15.42.26;	author espie;	state Exp;
branches;
next	1.80;

1.80
date	2000.10.10.00.40.47;	author espie;	state Exp;
branches;
next	1.79;

1.79
date	2000.08.01.14.44.43;	author espie;	state Exp;
branches;
next	1.78;

1.78
date	2000.07.26.14.01.46;	author espie;	state Exp;
branches;
next	1.77;

1.77
date	2000.07.20.00.18.28;	author espie;	state Exp;
branches;
next	1.76;

1.76
date	2000.07.19.21.20.57;	author espie;	state Exp;
branches;
next	1.75;

1.75
date	2000.07.14.18.16.22;	author espie;	state Exp;
branches;
next	1.74;

1.74
date	2000.06.28.00.14.45;	author espie;	state Exp;
branches;
next	1.73;

1.73
date	2000.06.27.22.14.26;	author espie;	state Exp;
branches;
next	1.72;

1.72
date	2000.04.18.23.34.45;	author espie;	state Exp;
branches
	1.72.2.1;
next	1.71;

1.71
date	2000.04.18.23.23.15;	author espie;	state Exp;
branches;
next	1.70;

1.70
date	2000.03.29.23.26.17;	author espie;	state Exp;
branches;
next	1.69;

1.69
date	2000.03.24.23.28.13;	author espie;	state Exp;
branches;
next	1.68;

1.68
date	2000.03.05.18.30.30;	author espie;	state Exp;
branches;
next	1.67;

1.67
date	2000.02.22.17.08.41;	author espie;	state Exp;
branches;
next	1.66;

1.66
date	2000.02.16.10.52.11;	author espie;	state Exp;
branches;
next	1.65;

1.65
date	2000.02.15.05.04.36;	author turan;	state Exp;
branches;
next	1.64;

1.64
date	2000.02.12.08.02.22;	author turan;	state Exp;
branches;
next	1.63;

1.63
date	2000.02.02.18.35.23;	author espie;	state Exp;
branches;
next	1.62;

1.62
date	99.12.14.00.19.15;	author espie;	state Exp;
branches;
next	1.61;

1.61
date	99.12.03.11.30.11;	author espie;	state Exp;
branches;
next	1.60;

1.60
date	99.12.01.17.38.43;	author espie;	state Exp;
branches;
next	1.59;

1.59
date	99.11.24.00.15.04;	author espie;	state Exp;
branches;
next	1.58;

1.58
date	99.11.14.22.00.36;	author turan;	state Exp;
branches;
next	1.57;

1.57
date	99.11.03.03.14.58;	author turan;	state Exp;
branches;
next	1.56;

1.56
date	99.09.09.14.25.11;	author espie;	state Exp;
branches;
next	1.55;

1.55
date	99.09.07.15.04.02;	author espie;	state Exp;
branches;
next	1.54;

1.54
date	99.09.06.13.58.44;	author espie;	state Exp;
branches;
next	1.53;

1.53
date	99.08.24.22.52.38;	author espie;	state Exp;
branches;
next	1.52;

1.52
date	99.08.22.16.53.37;	author espie;	state Exp;
branches;
next	1.51;

1.51
date	99.07.04.18.20.26;	author espie;	state Exp;
branches;
next	1.50;

1.50
date	99.06.17.17.06.39;	author espie;	state Exp;
branches;
next	1.49;

1.49
date	99.06.02.23.32.47;	author espie;	state Exp;
branches;
next	1.48;

1.48
date	99.06.01.20.59.34;	author espie;	state Exp;
branches;
next	1.47;

1.47
date	99.05.25.20.18.25;	author espie;	state Exp;
branches;
next	1.46;

1.46
date	99.05.25.19.55.21;	author espie;	state Exp;
branches;
next	1.45;

1.45
date	99.05.18.17.07.16;	author espie;	state Exp;
branches;
next	1.44;

1.44
date	99.05.14.01.15.29;	author espie;	state Exp;
branches;
next	1.43;

1.43
date	99.05.05.13.08.21;	author espie;	state Exp;
branches;
next	1.42;

1.42
date	99.04.29.16.54.19;	author espie;	state Exp;
branches;
next	1.41;

1.41
date	99.04.28.15.40.26;	author espie;	state Exp;
branches;
next	1.40;

1.40
date	99.04.18.20.54.38;	author espie;	state Exp;
branches;
next	1.39;

1.39
date	99.03.22.00.25.33;	author espie;	state Exp;
branches;
next	1.38;

1.38
date	99.03.07.14.15.33;	author espie;	state Exp;
branches;
next	1.37;

1.37
date	99.03.02.04.41.04;	author marc;	state Exp;
branches;
next	1.36;

1.36
date	99.02.28.18.17.06;	author espie;	state Exp;
branches;
next	1.35;

1.35
date	99.02.23.16.54.48;	author espie;	state Exp;
branches;
next	1.34;

1.34
date	99.02.23.09.28.23;	author espie;	state Exp;
branches;
next	1.33;

1.33
date	99.02.21.01.04.59;	author espie;	state Exp;
branches;
next	1.32;

1.32
date	99.02.20.04.26.13;	author espie;	state Exp;
branches;
next	1.31;

1.31
date	99.02.18.02.37.32;	author marc;	state Exp;
branches;
next	1.30;

1.30
date	99.02.14.19.33.31;	author espie;	state Exp;
branches;
next	1.29;

1.29
date	99.02.13.00.53.48;	author espie;	state Exp;
branches;
next	1.28;

1.28
date	99.02.09.10.47.44;	author espie;	state Exp;
branches;
next	1.27;

1.27
date	99.02.08.20.34.26;	author espie;	state Exp;
branches;
next	1.26;

1.26
date	99.02.06.16.31.14;	author espie;	state Exp;
branches;
next	1.25;

1.25
date	99.02.04.13.21.12;	author espie;	state Exp;
branches;
next	1.24;

1.24
date	99.02.03.18.02.53;	author espie;	state Exp;
branches;
next	1.23;

1.23
date	99.02.02.01.19.36;	author espie;	state Exp;
branches;
next	1.22;

1.22
date	99.01.31.23.20.41;	author espie;	state Exp;
branches;
next	1.21;

1.21
date	99.01.24.21.36.11;	author espie;	state Exp;
branches;
next	1.20;

1.20
date	99.01.18.10.23.25;	author espie;	state Exp;
branches;
next	1.19;

1.19
date	99.01.13.13.58.45;	author espie;	state Exp;
branches;
next	1.18;

1.18
date	99.01.13.00.09.03;	author espie;	state Exp;
branches;
next	1.17;

1.17
date	99.01.12.11.28.44;	author espie;	state Exp;
branches;
next	1.16;

1.16
date	99.01.12.11.27.39;	author espie;	state Exp;
branches;
next	1.15;

1.15
date	99.01.12.00.19.49;	author espie;	state Exp;
branches;
next	1.14;

1.14
date	99.01.10.02.50.02;	author espie;	state Exp;
branches;
next	1.13;

1.13
date	99.01.09.16.55.27;	author espie;	state Exp;
branches;
next	1.12;

1.12
date	98.12.21.21.13.01;	author espie;	state Exp;
branches;
next	1.11;

1.11
date	98.12.19.00.55.44;	author espie;	state Exp;
branches;
next	1.10;

1.10
date	98.12.17.23.04.10;	author espie;	state Exp;
branches;
next	1.9;

1.9
date	98.12.17.05.13.23;	author marc;	state Exp;
branches;
next	1.8;

1.8
date	98.12.16.17.52.29;	author espie;	state Exp;
branches;
next	1.7;

1.7
date	98.12.05.23.25.58;	author espie;	state Exp;
branches;
next	1.6;

1.6
date	98.12.03.02.33.34;	author espie;	state Exp;
branches;
next	1.5;

1.5
date	98.11.25.00.54.02;	author espie;	state Exp;
branches;
next	1.4;

1.4
date	98.11.17.17.39.33;	author espie;	state Exp;
branches;
next	1.3;

1.3
date	98.11.16.21.11.13;	author espie;	state Exp;
branches;
next	1.2;

1.2
date	98.10.02.18.57.28;	author espie;	state Exp;
branches;
next	1.1;

1.1
date	98.09.25.22.45.26;	author espie;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	98.09.25.22.45.26;	author espie;	state Exp;
branches;
next	;

1.72.2.1
date	2000.09.15.04.55.17;	author marc;	state Exp;
branches;
next	;


desc
@@


1.100
log
@kill dup snapshot dir.
@
text
@# $OpenBSD: Makefile,v 1.99 2004/09/15 19:16:07 espie Exp $

ONLY_FOR_ARCHS=	alpha i386 m68k sparc sparc64 powerpc vax

MAKE_GXX=Yes
MAKE_FORTRAN=Yes
MAKE_OBJC=Yes
# Java is still mostly broken (boehm-gc)

.if ${MACHINE_ARCH} == "i386"
MAKE_JAVA=Yes
#MAKE_ADA=Yes
#AS_PATH=/usr/bin/as
#LD_PATH=/usr/bin/ld
.endif

MAKE_GXX?=No
MAKE_FORTRAN?=No
MAKE_OBJC?=No
MAKE_JAVA?=No
MAKE_ADA?=No

MYDIR=lang/egcs/snapshot

# This is a configuration file for gcc

COM=		'GNU compiler collection'
COMMENT=	${COM}: core C compiler
COMMENT-c++ =	${COM}: C++ compiler
COMMENT-estdc=	${COM}: C++ compiler library
COMMENT-g77=	${COM}: f77 compiler
COMMENT-java=	${COM}: java compiler
COMMENT-objc=	${COM}: obj C compiler
COMMENT-ada=	${COM}: Ada compiler

PKGNAME=	gcc-$V
PKGNAME-c++ =	g++-$V
PKGNAME-estdc =	libstdc++-$V
PKGNAME-g77=	g77-$V
PKGNAME-java=	gcj-$V
PKGNAME-objc=	gobjc-$V
PKGNAME-ada=	gnat-$V

BUILD_DEPENDS=	::devel/autoconf/2.13
BUILD_DEPENDS+=	::devel/metaauto
SUBPACKAGE?=
.if ${MAKE_JAVA:L} == "yes"
.  if !defined(PACKAGING) || ${SUBPACKAGE} == "-java"
LIB_DEPENDS+=gc::devel/boehm-gc
.  endif
.endif

# This can be patched out, apart from java that wants a pure parser.
BUILD_DEPENDS+= :bison-*:devel/bison

CATEGORIES=	lang 
MAINTAINER=	Marc Espie <espie@@openbsd.org>


PERMIT_PACKAGE_FTP=Yes
PERMIT_DISTFILES_FTP=Yes
PERMIT_PACKAGE_CDROM=Yes
PERMIT_DISTFILES_CDROM=Yes

# user configuration section

# see files/tests for precise testing procedure


.if ${MAKE_JAVA:L} == "yes"
MAKE_GXX=Yes
.endif

MULTI_PACKAGES=
# No sub packages description
DESCR=${PKGDIR}/DESCR

REGRESS_DEPENDS=::devel/dejagnu

# No way around it, java wants a pure parser
.if ${MAKE_JAVA:L} == "yes"
BUILD_DEPENDS+=:bison-*:devel/bison
.endif

#### fetch section

V=3.3.2
DIRECTORY=releases/${DISTNAME}/
DISTNAME=   gcc-$V

# getting the right archives where they should be
MASTER_SITE_SUBDIR=${LATEST_DATE}

DIST_SUBDIR=egcs

DISTFILES=  gcc-$V.tar.bz2

SITES=	

SITES+= ftp://ftp.uvsq.fr/pub/gcc/${DIRECTORY}
SITES+= ftp://ftp.grolier.fr/pub/egcs/${DIRECTORY}
SITES+= ftp://gd.tuwien.ac.at/gnu/gcc/${DIRECTORY}
SITES+= ftp://chardonnay.elis.rug.ac.be/pub/mirrors/gcc.cygnus.com/pub/gcc/${DIRECTORY}
SITES+= ftp://gd.tuwien.ac.at/gnu/gcc/${DIRECTORY}
SITES+=	ftp://egcs.cygnus.com/pub/egcs/${DIRECTORY} 
SITES+= ftp://ftp.goof.com/pub/pcg/egcs/${DIRECTORY}
SITES+= ftp://go.cygnus.com/pub/ftp.cygnus.com/egcs/${DIRECTORY}
SITES+= ftp://cambridge.cygnus.com/pub/egcs/${DIRECTORY}
SITES+= ftp://sunsite.doc.ic.ac.uk/Mirrors/egcs.cygnus.com/pub/egcs/${DIRECTORY}

SITES+= ftp://ftp.gts.cz/pub/MIRRORS/ftp.cygnus.com/pub/egcs/${DIRECTORY}
SITES+= ftp://sunsite.auc.dk/pub/egcs/${DIRECTORY}
SITES+= ftp://ftp.fu-berlin.de/unix/languages/egcs/egcs/${DIRECTORY}
SITES+= ftp://ftp.gwdg.de/pub/cygnus/egcs/${DIRECTORY}
SITES+= ftp://ftp.mpi-sb.mpg.de/pub/gnu/mirror/egcs.cygnus.com/egcs/${DIRECTORY}
SITES+= ftp://ftp.uni-trier.de/pub/languages/c/implementation/egcs/${DIRECTORY}
SITES+= ftp://ftp.sunet.se/pub/gnu/egcs/${DIRECTORY}
SITES+= ftp://ftp.unicamp.br/pub/gnu/=EXTRA=/cygnus/egcs/${DIRECTORY}
SITES+= ftp://ftp.lbi.ro/mirrors/ftp.cygnus.com/pub/egcs/${DIRECTORY}
SITES+= ftp://ftp.ntua.gr/pub/gnu/egcs/${DIRECTORY}
SITES+= ftp://ftp.nluug.nl/pub/languages/egcs/${DIRECTORY}
SITES+= ftp://ftp.dti.ad.jp/pub/lang/egcs/${DIRECTORY}
SITES+= ftp://ftp.win.or.jp/pub/lang/egcs/${DIRECTORY}
SITES+= ftp://ftp.telewaynet.ad.jp/pub/lang/egcs/${DIRECTORY}
SITES+= ftp://ftp.lab.kdd.co.jp/lang/egcs/${DIRECTORY}
SITES+= ftp://ftp.crc.ca/pub/packages/egcs/${DIRECTORY}
SITES+= ftp://ftp.nc.orc.ru/pub/egcs/${DIRECTORY}
SITES+= ftp://ftp.u-aizu.ac.jp/pub/lang/C/pcg/egcs/${DIRECTORY}
SITES+= ftp://ftp.maisel.int-evry.fr/pub/linux/pentium/egcs/${DIRECTORY}
SITES+= ftp://ftp.yggdrasil.com/mirrors/site/egcs.cygnus.com/pub/egcs/${DIRECTORY}
SITES+= ftp://unix.hensa.ac.uk/mirrors/egcs.cygnus.com/pub/egcs/${DIRECTORY}

# Can't contact those, maybe they work ?
SITES+= ftp://sunsite.mff.cuni.cz/pub/GNU/egcs/${DIRECTORY}
SITES+= ftp://sunsite.icm.edu.pl/pub/programming/egcs/${DIRECTORY}
SITES+= ftp://ftp.task.gda.pl/mirror/egcs.cygnus.com/pub/egcs/${DIRECTORY}
SITES+= ftp://ftp.lca.uevora.pt/pub/egcs/${DIRECTORY}
SITES+= ftp://cair-archive.kaist.ac.kr/pub/gnu/egcs/${DIRECTORY}
SITES+= ftp://linux.ihep.su/pub/cygnus/egcs/${DIRECTORY}
SITES+= ftp://linux.cis.nctu.edu.tw/pub/packages/pcg/egcs/${DIRECTORY}
SITES+= ftp://ftp.ninemoons.com/pub/mirrors/egcs/${DIRECTORY}

# Only contains empty gcc-3.0 directory - maybe it gets updated at 
# some point?
SITES+= ftp://ftp.funet.fi/mirrors/ftp.cygnus.com/pub/egcs/${DIRECTORY}

# Bad mirrors (no snapshot)
# ftp.lip6.fr, ftp.ilog.fr, ftp.irisa.fr
# No route to host
# mirrors.aarnet.edu.au
#SITES+=	ftp://ftp.lip6.fr/pub/egcs/${DIRECTORY}
#SITES+= ftp://ftp.ilog.fr/pub/Mirrors/egcs/${DIRECTORY}
#SITES+= ftp://ftp.irisa.fr/pub/mirrors/egcs.cygwin.com/gcc/${DIRECTORY}
MASTER_SITES=${SITES:S/%DATE%/${LATEST_DATE}/}

# add a possible next snapshot

#### 
# Patch section

#ac_dirs=gcc libiberty libstdc++-v3 libf2c/libI77 libffi fastjar libjava
ac_dirs=gcc libiberty libf2c/libI77 libffi fastjar libjava
rm_dirs=zlib texinfo boehm-gc

# get openbsd configuration files where they should be
post-patch:
#	cp -R ${FILESDIR}/config/* ${WRKSRC}
#	cp -R ${FILESDIR}/include/* ${WRKSRC}/gcc/ginclude
	cp ${FILESDIR}/config/gcc/config/i386/openbsdelf.h \
	    ${WRKSRC}/gcc/config/i386/openbsdelf.h 
	cp ${FILESDIR}/config/gcc/config/exec-stack.h \
	    ${WRKSRC}/gcc/config/exec-stack.h 
	cd ${WRKSRC} && contrib/gcc_update --touch
# rebuild configure files after patching, then move source around !!!
# XXX: don't try to autoconf the main configure file, it's not autoconf.
#	cd ${WRKSRC}/libstdc++-v3 && PATH=${PORTPATH} AUTOCONF_VERSION=2.13 autoheader
.for ac_dir in ${ac_dirs}
	cd ${WRKSRC}/${ac_dir} && PATH=${PORTPATH} AUTOCONF_VERSION=2.13 autoconf
.endfor
	cd ${WRKSRC} && rm -rf ${rm_dirs}




####
# configure section
#
# define AS_PATH/LD_PATH is you don't want to use the default as/ld.
# This should not be used for regular releases, but if you're using this
# snapshot, you know what you're doing, don't you ?

CONFIGURE_STYLE=	gnu
MODGNU_CONFIG_GUESS_DIRS=	${WRKSRC} ${WRKSRC}/gcc

LANGS=c
.if ${MAKE_GXX:L} == "yes"
LANGS:=${LANGS},c++
MULTI_PACKAGES+=-c++ -estdc
.endif
.if ${MAKE_FORTRAN:L} == "yes"
LANGS:=${LANGS},f77
MULTI_PACKAGES+=-g77
.endif
.if ${MAKE_OBJC:L} == "yes"
LANGS:=${LANGS},objc
MULTI_PACKAGES+=-objc
.endif
.if ${MAKE_JAVA:L} == "yes"
LANGS:=${LANGS},java
MULTI_PACKAGES+=-java
CONFIGURE_ARGS+=--enable-java-gc=system-boehm
.endif
.if ${MAKE_ADA:L} == "yes"
LANGS:=${LANGS},ada
MULTI_PACKAGES+=-ada

CONFIGURE_ENV=ADAC=${LOCALBASE}/bin/egcc GNATBIND=${LOCALBASE}/bin/gnatbind
MAKE_ENV=ADAC=${LOCALBASE}/bin/egcc GNATBIND=${LOCALBASE}/bin/gnatbind
CC=${LOCALBASE}/bin/egcc
BUILD_DEPENDS+=:gnat-*:lang/egcs/stable,-ada
.endif
CONFIGURE_ENV+=am_cv_func_iconv=no

# Note: the configure target passes CFLAGS to the configure script anyways.

CFLAGS=-O2 -g


CONFIGURE_ARGS= --verbose --program-transform-name=s,^,e, \
--disable-nls  --with-system-zlib

# This is needed, as internal cpp is no longer compatible with the
# visible beast
CONFIGURE_ARGS+=--enable-cpp
CONFIGURE_ARGS+=--enable-languages=${LANGS}

.if ${MAKE_JAVA:L} == "yes"
CONFIGURE_ARGS+=--enable-sjlj-exceptions

.endif


# if you wish to try your luck
#CONFIGURE_ARGS+= --enable-threads=posix

.if defined(AS_PATH)
CONFIGURE_ARGS += --with-as=${AS_PATH}
.else
CONFIGURE_ARGS += --with-gnu-as 
.endif

.if defined(LD_PATH)
CONFIGURE_ARGS += --with-ld=${LD_PATH}
.else
CONFIGURE_ARGS += --with-gnu-ld 
.endif

CONFIGURE_ARGS += ${CONFIGURE_SHARED}

SEPARATE_BUILD=concurrent



####
# build section
# Issues without gmake:
# stuff doesn't get passed thru correctly to libtool in multi-do
# libstdc++-v3 wants gmake
# java wants gmake
USE_GMAKE= yes

# you shouldn't skip bootstrap unless you know what you're doing
# use bootstrap-lean if you're pressed for space
ALL_TARGET=bootstrap
#ALL_TARGET=bootstrap3
# ALL_TARGET=bootstrap-lean
MAKE_FLAGS=libstdc___la_LDFLAGS='-version-info 31:0:0 -lm'

# desactivate the fixincludes mechanism by supplying a script which does
# nothing
pre-build:
	sed -e s,@@WRKBUILD@@,${WRKBUILD}, -e s,@@FILESDIR@@,${FILESDIR}, \
	${FILESDIR}/fixinc.sh.m4 >${WRKSRC}/gcc/fixinc/openbsd-special
	chmod a+x ${WRKSRC}/gcc/fixinc/openbsd-special
	echo "cp ${WRKSRC}/gcc/fixinc/openbsd-special ${WRKBUILD}/gcc/fixinc.sh" >${WRKSRC}/gcc/fixinc/mkfixinc.sh

####
# Install & tests section 

post-build:
		# avoid packaging include copies along...
	find ${WRKBUILD} -name \*.orig|xargs rm
.if ${MAKE_ADA:L} == "yes"
	cd ${WRKBUILD}/gcc && env ${MAKE_ENV} ${MAKE_PROGRAM} ${MAKE_FLAGS} gnatlib_and_tools
.endif


post-install:
	-ldconfig -U ${PREFIX}/lib ${PREFIX}/lib/. ${PREFIX}/lib/fpic ${PREFIX}/lib/nof

# Tests still need to be performed at the end of install, I don't know why.

REGRESS_DEPENDS+=::${MYDIR}
.if ${MAKE_GXX:L} == "yes"
REGRESS_DEPENDS+=::${MYDIR},-c++,-estdc
.endif
.if ${MAKE_FORTRAN:L} == "yes"
REGRESS_DEPENDS+=::${MYDIR},-g77
.endif
.if ${MAKE_OBJC:L} == "yes"
REGRESS_DEPENDS+=::${MYDIR},-objc
.endif
.if ${MAKE_JAVA:L} == "yes"
REGRESS_DEPENDS+=::${MYDIR},-java
.endif
.if ${MAKE_ADA:L} == "yes"
REGRESS_DEPENDS+=::${MYDIR},-ada
.endif

TEST_RESULT=${WRKBUILD}/test.result

do-regress:
	@@cd ${WRKBUILD}; ulimit -c 0; \
	${MAKE_ENV} ${MAKE_PROGRAM} -k -f ${MAKE_FILE} check && \
	${WRKSRC}/contrib/test_summary >${TEST_RESULT}
	@@echo "Please send the tests results to the gcc project"
	@@echo "By invoking make send-results"

send-results: 
	[ -f ${TEST_RESULT} ] && sh ${TEST_RESULT}


.if ${MACHINE_ARCH} == "m68k" || ${MACHINE_ARCH} == "sparc"
PKG_ARGS+=-DPIC=1
.else
PKG_ARGS+=-DPIC=0
.endif

.if ${MACHINE_ARCH} == "powerpc"
PKG_ARGS+=-DPPC=1
.else
PKG_ARGS+=-DPPC=0
.endif

GCC_NAME=${WRKBUILD}/gcc/xgcc

.if defined(PACKAGING) && defined(SUBPACKAGE)
.  if !empty(SUBPACKAGE) && ${SUBPACKAGE} != "-estdc"
RUN_DEPENDS+=::${MYDIR}
.  endif
.  if ${SUBPACKAGE} == "-c++"
RUN_DEPENDS+=::${MYDIR},-estdc
.  endif
.endif

CONFIG=${MACHINE_ARCH}-unknown-openbsd${OSREV}
SUBST_VARS=CONFIG V
.include <bsd.port.mk>

@


1.99
log
@new plists.
some fragment games with python.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.98 2003/11/19 10:07:04 espie Exp $
@


1.98
log
@If I don't copy things twice, suddenly, java does not rebuild.
Sigh.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.97 2003/11/19 01:40:23 espie Exp $
d334 1
a334 1
SED_PLIST=|sed -e '/^IFPIC:/s///'
d336 1
a336 1
SED_PLIST=|sed -e '/^IFPIC:/d'
d340 1
a340 1
SED_PLIST+=|sed -e '/^IFPPC:/s///'
d342 1
a342 1
SED_PLIST+=|sed -e '/^IFPPC:/d'
@


1.97
log
@snapshot!=stable. Thx Chris Cappuccio.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.96 2003/11/15 16:51:52 espie Exp $
a9 1

a292 2
	mkdir -p ${WRKBUILD}/gcc/include/machine
	cp ${FILESDIR}/include/machine/ansi.h ${WRKBUILD}/gcc/include/machine
a294 3
.endif
.if ${MAKE_JAVA:L} == "yes"
	cd ${WRKBUILD} && env ${MAKE_ENV} ${MAKE_PROGRAM} ${MAKE_ARGS} all-target-libjava
@


1.96
log
@Force libjava rebuild after normal build so that it won't rebuild
during install (I know, dirty hack...)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.95 2003/11/13 19:04:09 espie Exp $
d24 2
a31 1
COMMENT-chill=	${COM}: Chill compiler
a39 1
PKGNAME-chill=	gchill-$V
d267 4
a270 2
# should work without gmake. If it turns out to be needed, this must be 
# reported to MAINTAINER.
d309 1
a309 1
REGRESS_DEPENDS+=::lang/egcs/stable
d311 1
a311 1
REGRESS_DEPENDS+=::lang/egcs/stable,-c++,-estdc
d314 1
a314 1
REGRESS_DEPENDS+=::lang/egcs/stable,-g77
d317 1
a317 1
REGRESS_DEPENDS+=::lang/egcs/stable,-objc
d320 1
a320 1
REGRESS_DEPENDS+=::lang/egcs/stable,-java
d323 1
a323 1
REGRESS_DEPENDS+=::lang/egcs/stable,-ada
d355 1
a355 1
RUN_DEPENDS+=::lang/egcs/stable
d358 1
a358 1
RUN_DEPENDS+=::lang/egcs/stable,-estdc
@


1.95
log
@Preliminary port of gcc 3.3.2, in `snapshot' because it's not yet quite
stable (and stable is actually used right now).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.80 2003/06/30 12:19:23 espie Exp $
d296 3
@


1.94
log
@make mirror-maker happy by commenting a broken BUILD_DEPEND in this
BROKEN port

ok naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.93 2003/06/10 15:43:20 brad Exp $
d3 1
a3 1
ONLY_FOR_ARCHS=	alpha i386 m68k sparc sparc64
a4 1
MAKE_ADA=Yes
d8 2
d11 1
a11 1
# Java is still mostly broken (boehm-gc)
d13 4
a16 1
BROKEN=	Waiting for a recent snapshot that #??#@@ works
d18 5
d27 26
a52 18
COMMENT=	"${COM}: core C compiler"
COMMENT-c++ =	"${COM}: C++ compiler"
COMMENT-chill=	"${COM}: Chill compiler"
COMMENT-g77=	"${COM}: f77 compiler"
COMMENT-java=	"${COM}: java compiler"
COMMENT-objc=	"${COM}: obj C compiler"
COMMENT-ada=	"${COM}: Ada compiler"

PKGNAME=	gcc-${FULLV}
PKGNAME-c++ =	g++-${FULLV}
PKGNAME-chill=	gchill-${FULLV}
PKGNAME-g77=	g77-${FULLV}
PKGNAME-java=	gcj-${FULLV}
PKGNAME-objc=	gobjc-${FULLV}
PKGNAME-ada=	gnat-${FULLV}

# use autoconf dependency framework
#BUILD_DEPENDS=	::devel/autoconf
d71 1
a71 1
.if defined(MAKE_JAVA) && ${MAKE_JAVA:L} == "yes"
d82 1
a82 1
.if defined(MAKE_JAVA) && ${MAKE_JAVA:L} == "yes"
a84 1
LATEST_DATE=2002-06-17
a86 2
# configuration is built so that you can test the next snapshot easily,
# define NEXT_DATE to the next snapshot... 
d88 3
a90 16
# You also may have to remove/add some patches, as these things ARE
# usually passed along to the egcs ml.
#NEXT_DATE=2000-02-21
#PATCH_DEBUG=yes

V=3.1.1
LATEST=${LATEST_DATE:S/-//g}
DIRECTORY=snapshots/%DATE%/
.if defined(NEXT_DATE)
NEXT=${NEXT_DATE:S/-//g}
DISTNAME=	gcc-${NEXT}
FULLV=$V_${NEXT}
.else
DISTNAME=   gcc-${LATEST}
FULLV=$V_${LATEST}
.endif
a93 1
PATCH_SITE_SUBDIR=${NEXT_DATE}
d97 1
a97 3
PATCH_DIST_STRIP=-p1

DISTFILES=  gcc-${LATEST}${EXTRACT_SUFX}
d101 1
a101 2
SITES+=	ftp://gcc.gnu.org/pub/gcc/${DIRECTORY}
SITES+= ftp://ftp.uvsq.fr/pub/egcs/${DIRECTORY}
a126 1
SITES+= ftp://ftp.funet.fi/mirrors/ftp.cygnus.com/pub/egcs/${DIRECTORY}
d144 4
d157 1
a157 14
.if defined(NEXT)
PATCHFILES=egcs-${LATEST}-${NEXT}.diff.gz
.endif

makesum:
	@@echo 1>&2 ">>>Please make addsum to avoid clobbering old checksums"
	@@exit 1

# synch the date
.if defined(NEXT)
post-extract:
	mv ${WRKDIR}/egcs-${LATEST} ${WRKSRC}
.endif

d162 4
d170 4
d177 5
a181 10
	cd ${WRKSRC}/gcc && PATH=${PORTPATH} autoconf
	cd ${WRKSRC}/libiberty && PATH=${PORTPATH} autoconf
	cd ${WRKSRC}/libstdc++-v3 && PATH=${PORTPATH} autoheader
	cd ${WRKSRC}/libstdc++-v3 && PATH=${PORTPATH} autoconf
	cd ${WRKSRC}/libf2c/libI77 && PATH=${PORTPATH} autoconf
	cd ${WRKSRC}/libffi && PATH=${PORTPATH} autoconf
	cd ${WRKSRC}/fastjar && PATH=${PORTPATH} autoconf
	cd ${WRKSRC}/libjava && PATH=${PORTPATH} autoconf
	cd ${WRKSRC} && rm -rf texinfo
	cd ${WRKSRC} && rm -rf zlib
d193 1
a193 1
CONFIGURE_STYLE=	gnu dest
d197 1
a197 1
.if defined(MAKE_GXX) && ${MAKE_GXX:L} == "yes"
d199 1
a199 1
MULTI_PACKAGES+=-c++
d201 1
a201 1
.if defined(MAKE_FORTRAN) && ${MAKE_FORTRAN:L} == "yes"
d205 1
a205 1
.if defined(MAKE_OBJC) && ${MAKE_OBJC:L} == "yes"
d209 1
a209 1
.if defined(MAKE_JAVA) && ${MAKE_JAVA:L} == "yes"
d212 1
d214 1
a214 1
.if defined(MAKE_ADA) && ${MAKE_ADA:L} == "yes"
d220 2
d223 1
d238 1
a238 1
.if defined(MAKE_JAVA) && ${MAKE_JAVA:L} == "yes"
d240 1
d245 1
a245 1
#CONFIGURE_ARGS+= --enable-threads=yes
a277 2
FAKE_FLAGS=DESTDIR=${WRKINST}

d294 1
a294 1
.if defined(MAKE_ADA) && ${MAKE_ADA:L} == "yes"
d300 1
a300 1
	-ldconfig -U ${PREFIX}/lib ${PREFIX}/lib/fpic
d304 3
a306 3
REGRESS_DEPENDS+=::lang/egcs/snapshot
.if defined(MAKE_GXX) && ${MAKE_GXX:L} == "yes"
REGRESS_DEPENDS+=::lang/egcs/snapshot,-c++
d308 2
a309 2
.if defined(MAKE_FORTRAN) && ${MAKE_FORTRAN:L} == "yes"
REGRESS_DEPENDS+=::lang/egcs/snapshot,-g77
d311 2
a312 2
.if defined(MAKE_OBJC) && ${MAKE_OBJC:L} == "yes"
REGRESS_DEPENDS+=::lang/egcs/snapshot,-objc
d314 2
a315 2
.if defined(MAKE_JAVA) && ${MAKE_JAVA:L} == "yes"
REGRESS_DEPENDS+=::lang/egcs/snapshot,-java
d317 2
a318 2
.if defined(MAKE_ADA) && ${MAKE_ADA:L} == "yes"
REGRESS_DEPENDS+=::lang/egcs/snapshot,-ada
d334 1
a334 1
.if ${MACHINE_ARCH} == "i386" || ${MACHINE_ARCH} == "m68k" || ${MACHINE_ARCH} == "sparc"
d339 7
d349 5
a353 2
.  if !empty(SUBPACKAGE)
RUN_DEPENDS+=::lang/egcs/snapshot
d358 1
a358 1
SUBST_VARS=V CONFIG
@


1.93
log
@lang/egcs/dejagnu -> devel/dejagnu
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.92 2003/04/10 18:08:56 jsyn Exp $
d34 2
a35 1
BUILD_DEPENDS=	::devel/autoconf
@


1.92
log
@quote COMMENTs; ok naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.91 2002/09/19 11:57:36 naddy Exp $
d61 1
a61 1
REGRESS_DEPENDS=::lang/egcs/dejagnu
@


1.91
log
@don't double-quote BROKEN, bsd.port.mk already does the same
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.90 2002/09/18 15:35:39 espie Exp $
d18 7
a24 7
COMMENT=	${COM}: core C compiler
COMMENT-c++ =	${COM}: C++ compiler
COMMENT-chill=	${COM}: Chill compiler
COMMENT-g77=	${COM}: f77 compiler
COMMENT-java=	${COM}: java compiler
COMMENT-objc=	${COM}: obj C compiler
COMMENT-ada=	${COM}: Ada compiler
@


1.90
log
@sigh... both 20020909 and 20020916 don't build, for apparently different
reasons.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.89 2002/06/06 13:46:39 espie Exp $
d12 1
a12 1
BROKEN="Waiting for a recent snapshot that #??#@@ works"
@


1.89
log
@dependencies should refer to snapshot, not stable.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.88 2002/06/05 23:58:49 espie Exp $
d12 1
a39 1
NEED_VERSION=	1.474
d67 1
a67 1
LATEST_DATE=2002-06-03
@


1.88
log
@Resurrect snapshot port, easy to do,since it's the gcc 3.1 branch.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2002/05/30 08:57:32 espie Exp $
d310 1
a310 1
REGRESS_DEPENDS+=::lang/egcs/stable
d312 1
a312 1
REGRESS_DEPENDS+=::lang/egcs/stable,-c++
d315 1
a315 1
REGRESS_DEPENDS+=::lang/egcs/stable,-g77
d318 1
a318 1
REGRESS_DEPENDS+=::lang/egcs/stable,-objc
d321 1
a321 1
REGRESS_DEPENDS+=::lang/egcs/stable,-java
d324 1
a324 1
REGRESS_DEPENDS+=::lang/egcs/stable,-ada
d349 1
a349 1
RUN_DEPENDS+=::lang/egcs/stable
@


1.87
log
@Kill first component of BUILD_DEPENDS.

Fix sawfish comment while I'm at it.
`window manager for the X windows system'.
Like DUH ! It's going to be a window manager for my microwave oven ?
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.86 2001/09/30 19:36:46 espie Exp $
d3 1
a3 1
# This is a configuration file for egcs, snapshot flavor
d5 12
a16 2
BROKEN=		"Need to be updated beyond stable port"
COM=		'GNU compiler collection (experimental)'
d23 1
d25 7
a31 6
PKGNAME=	${DISTNAME}-core
PKGNAME-c++ =	${DISTNAME}-c++
PKGNAME-chill=	${DISTNAME}-chill
PKGNAME-g77=	${DISTNAME}-g77
PKGNAME-java=	${DISTNAME}-java
PKGNAME-objc=	${DISTNAME}-objc
a32 2
# we could remove this dependency by patching configure, but this is not
# reasonable...
d35 3
d39 1
a39 1
NEED_VERSION=	1.489
a42 2
# experimental port, changes once a week, don't bother remirroring distfiles.

d45 2
a46 10
PERMIT_PACKAGE_CDROM="Probably meaningless"
PERMIT_DISTFILES_CDROM="Probably meaningless"

# Testers for the new configurations:
# Jason L.Wright & Marco S.Hyman for sparc,
# Michael Shalayeff for hppa,
# Wim Van Deputte for alpha,
# Steve Murphree for m88k,
# Per Fogelstrom and Todd Miller for mips,
# Dale Rahn for rs6000.
d53 1
a53 4
# cygnus packaging scheme is now working, though it is weird.
# namely, testsuite holds all the tests. g++-tests no longer exists,
# and g77-tests only holds duplicates from the main testsuite archive.
MAKE_TESTS=yes
d55 1
a55 5
MAKE_FORTRAN=Yes
# we don't care about chill
#MAKE_CHILL=yes
MAKE_OBJC=Yes
MAKE_JAVA=Yes
d61 1
a61 25
PATCH_LIST=patch-core-*
.if defined(MAKE_GXX)
PATCH_LIST+=patch-g++-*
MULTI_PACKAGES+=-c++
.endif
.if defined(MAKE_OBJC)
PATCH_LIST+=patch-objc-*
MULTI_PACKAGES+=-objc
.endif
.if defined(MAKE_CHILL)
PATCH_LIST+=patch-chill-*
MULTI_PACKAGES+=-chill
.endif
.if defined(MAKE_FORTRAN)
PATCH_LIST+=patch-g77-*
MULTI_PACKAGES+=-g77
.endif
.if defined(MAKE_JAVA)
PATCH_LIST+=patch-java-*
MULTI_PACKAGES+=-java
.endif

.if defined(MAKE_TESTS) && ${MAKE_TESTS:L} == "yes"
BUILD_DEPENDS+=	::lang/egcs/dejagnu
.endif
d65 1
a65 1
BUILD_DEPENDS+=::devel/bison
d67 1
a67 2

LATEST_DATE=2001-11-05
d78 1
d84 1
d87 1
a155 3
FAKE_FLAGS=	DESTDIR=${WRKINST}
# add a possible next snapshot

d176 2
a177 2
	cp -R ${FILESDIR}/config/* ${WRKSRC}
	cp -R ${FILESDIR}/include/* ${WRKSRC}/gcc/ginclude
d183 2
d186 3
d190 1
d203 1
a203 2

#CONFIGURE_SCRIPT=../source/configure
d206 1
a206 1
.if defined(MAKE_GXX)
d208 1
d210 1
a210 1
.if defined(MAKE_FORTRAN)
d212 1
d214 1
a214 4
.if defined(MAKE_CHILL)
LANGS.=${LANGS},CHILL
.endif
.if defined(MAKE_OBJC)
d216 1
d218 1
a218 1
.if defined(MAKE_JAVA)
d220 8
d236 1
a236 1
--disable-nls 
d243 4
a265 1
#WRKBUILD=${WRKDIR}/build-${MACHINE_ARCH}
d273 1
a273 1
#USE_GMAKE= yes
d280 3
d300 7
d309 18
a326 1
.if defined(MAKE_TESTS)
d329 5
a333 5
post-install:
	@@(cd ${WRKBUILD}; ulimit -c 0; \
	${MAKE_ENV} make -f ${MAKE_FILE} check && \
	${WRKSRC}/contrib/test_summary >${TEST_RESULT})
	@@echo "Please send the tests results to the egcs project"
d338 4
d343 1
d345 1
d347 5
a351 5
SED_PLIST=|sed -e s/@@GCCARCH@@/`${GCC_NAME} -dumpmachine`/ \
	-e s/@@VERSION@@/`${GCC_NAME} -dumpversion`/ \
	-e 's/@@COREPKG@@/${DISTNAME}-core/'

GCC_NAME=${WRKBUILD}/gcc/xgcc
d353 2
@


1.86
log
@No use building it right now, since stable/ is more recent.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.85 2001/09/10 23:55:11 miod Exp $
d5 1
a5 1
BROKEN=		"Older than stable port, needs to be updated"
d23 1
a23 1
BUILD_DEPENDS=	autoconf::devel/autoconf
d26 1
a26 1
NEED_VERSION=	1.361
d88 1
a88 1
BUILD_DEPENDS+=	runtest::lang/egcs/dejagnu
d93 1
a93 1
BUILD_DEPENDS+=bison::devel/bison
d96 1
a96 1
LATEST_DATE=2000-07-31
d111 1
a111 1
DISTNAME=	egcs-${NEXT}
d113 1
a113 1
DISTNAME=   egcs-${LATEST}
d124 1
a124 1
DISTFILES=  egcs-${LATEST}${EXTRACT_SUFX}
d128 1
@


1.85
log
@Typos
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.84 2001/03/21 14:44:01 wilfried Exp $
d5 1
@


1.84
log
@add a space between 'COMMENT-c++' and '=' to prevent make to
think we wanted to add '+=' something to 'COMMENT-c+'
also for PKGNAME-c++
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.83 2001/03/17 16:15:50 wilfried Exp $
d40 2
a41 2
# Steve Murphee for m88k,
# Per Fogelstrom and Todd Millert for mips,
@


1.83
log
@must enclose COMMENT in quotes if it contains shell meta-chars
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.82 2001/03/16 15:53:15 espie Exp $
d7 1
a7 1
COMMENT-c++=	${COM}: C++ compiler
d14 1
a14 1
PKGNAME-c++=	${DISTNAME}-c++
@


1.82
log
@Simplify
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.81 2000/10/22 15:42:26 espie Exp $
d5 1
a5 1
COM=		GNU compiler collection (experimental)
@


1.81
log
@Kill
FAKE=Yes
HAS_CONFIGURE, GNU_CONFIGURE, USE_IMAKE, NO_INSTALL_MANPAGES, USE_AUTOCONF
and bump NEED_VERSION accordingly.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.80 2000/10/10 00:40:47 espie Exp $
a3 2
# PLEASE use the regular egcs-stable for serious work, resort to this one
# for experimentations and testing.
d5 14
a18 1
# it only works right with a recent bsd.port.mk.
d25 1
a25 1
NEED_VERSION=	1.305
a62 5
SUBPACKAGE?=
.if empty(SUBPACKAGE)
PKGNAME=${DISTNAME}-core
.endif

@


1.80
log
@Fix my address. Dust off details.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.79 2000/08/01 14:44:43 espie Exp $
d14 1
a14 1
NEED_VERSION=	1.302
@


1.79
log
@2000-07-31
- use enable-languages, as this is more tested (and LANGUAGES= failed this
time...),
- remove patch that has been folded,
- sync the cpp -> cpp0 change, and the libtool update.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.78 2000/07/26 14:01:46 espie Exp $
d15 1
a15 1
MAINTAINER=	Marc.Espie@@openbsd.org
@


1.78
log
@Bump to 0724 snapshot.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.77 2000/07/20 00:18:28 espie Exp $
d89 1
a89 1
LATEST_DATE=2000-07-24
d223 1
a223 1
LANGS+=c++
d226 1
a226 1
LANGS+=f77
d229 1
a229 1
LANGS+=CHILL
d232 1
a232 1
LANGS+=objc
d235 1
a235 1
LANGS+=java
a240 2
CONFIGURE_ENV=LANGUAGES='${LANGS}'  

d244 1
a244 1
--disable-nls
d249 1
d282 1
a282 1
ALL_TARGET=bootstrap 
@


1.77
log
@Can't be helped... java wants to build a pure parser, so bison
is mandatory for it.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.76 2000/07/19 21:20:57 espie Exp $
d89 1
a89 1
LATEST_DATE=2000-07-17
a245 1
--disable-subdir-texinfo \
@


1.76
log
@Bump to 2000-07-17 snapshot, notice that vax and m88k have been folded.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.75 2000/07/14 18:16:22 espie Exp $
d41 1
a41 1
#MAKE_TESTS=yes
d80 1
a80 1
.if defined(MAKE_TESTS)
d82 5
@


1.75
log
@Bump to 07-10 snapshot.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.74 2000/06/28 00:14:45 espie Exp $
d84 1
a84 1
LATEST_DATE=2000-07-10
@


1.74
log
@Use the right dejagnu
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.73 2000/06/27 22:14:26 espie Exp $
d84 1
a84 1
LATEST_DATE=2000-06-26
d96 1
a96 1
DIRECTORY=egcs/snapshots/%DATE%/
d115 34
a148 32
SITES+=	ftp://egcs.cygnus.com/pub/${DIRECTORY} 
SITES+=	ftp://ftp.lip6.fr/pub/${DIRECTORY}
SITES+= ftp://ftp.goof.com/pub/pcg/${DIRECTORY}
SITES+= ftp://go.cygnus.com/pub/ftp.cygnus.com/${DIRECTORY}
SITES+= ftp://cambridge.cygnus.com/pub/${DIRECTORY}
SITES+= ftp://sunsite.doc.ic.ac.uk/Mirrors/egcs.cygnus.com/pub/${DIRECTORY}
SITES+= ftp://gd.tuwien.ac.at/gnu/${DIRECTORY}
SITES+= ftp://ftp.ilog.fr/pub/Mirrors/${DIRECTORY}
SITES+= ftp://ftp.irisa.fr/pub/mirrors/${DIRECTORY}

SITES+= ftp://ftp.gts.cz/pub/MIRRORS/ftp.cygnus.com/pub/${DIRECTORY}
SITES+= ftp://sunsite.auc.dk/pub/${DIRECTORY}
SITES+= ftp://ftp.fu-berlin.de/unix/languages/${DIRECTORY}
SITES+= ftp://ftp.gwdg.de/pub/cygnus/${DIRECTORY}
SITES+= ftp://ftp.mpi-sb.mpg.de/pub/gnu/mirror/egcs.cygnus.com/${DIRECTORY}
SITES+= ftp://ftp.uni-trier.de/pub/languages/c/implementation/${DIRECTORY}
SITES+= ftp://ftp.sunet.se/pub/gnu/${DIRECTORY}
SITES+= ftp://ftp.unicamp.br/pub/gnu/=EXTRA=/cygnus/${DIRECTORY}
SITES+= ftp://ftp.lbi.ro/mirrors/ftp.cygnus.com/pub/${DIRECTORY}
SITES+= ftp://ftp.ntua.gr/pub/gnu/${DIRECTORY}
SITES+= ftp://ftp.nluug.nl/pub/languages/${DIRECTORY}
SITES+= ftp://ftp.dti.ad.jp/pub/lang/${DIRECTORY}
SITES+= ftp://ftp.win.or.jp/pub/lang/${DIRECTORY}
SITES+= ftp://ftp.telewaynet.ad.jp/pub/lang/${DIRECTORY}
SITES+= ftp://ftp.lab.kdd.co.jp/lang/${DIRECTORY}
SITES+= ftp://ftp.funet.fi/mirrors/ftp.cygnus.com/pub/${DIRECTORY}
SITES+= ftp://ftp.crc.ca/pub/packages/${DIRECTORY}
SITES+= ftp://ftp.nc.orc.ru/pub/${DIRECTORY}
SITES+= ftp://ftp.u-aizu.ac.jp/pub/lang/C/pcg/${DIRECTORY}
SITES+= ftp://ftp.maisel.int-evry.fr/pub/linux/pentium/${DIRECTORY}
SITES+= ftp://ftp.yggdrasil.com/mirrors/site/egcs.cygnus.com/pub/${DIRECTORY}
SITES+= ftp://unix.hensa.ac.uk/mirrors/egcs.cygnus.com/pub/${DIRECTORY}
d151 16
a166 9
SITES+= ftp://sunsite.mff.cuni.cz/pub/GNU/${DIRECTORY}
SITES+= ftp://sunsite.icm.edu.pl/pub/programming/${DIRECTORY}
SITES+= ftp://ftp.task.gda.pl/mirror/egcs.cygnus.com/pub/${DIRECTORY}
SITES+= ftp://ftp.lca.uevora.pt/pub/${DIRECTORY}
SITES+= ftp://cair-archive.kaist.ac.kr/pub/gnu/${DIRECTORY}
SITES+= ftp://linux.ihep.su/pub/cygnus/${DIRECTORY}
SITES+= ftp://linux.cis.nctu.edu.tw/pub/packages/pcg/${DIRECTORY}
SITES+= ftp://ftp.ninemoons.com/pub/mirrors/${DIRECTORY}

a168 1
FAKE=		Yes
d212 1
a212 1
HAS_CONFIGURE=	yes
d235 1
a235 1
CFLAGS=-O2
d240 1
a240 2
CONFIGURE_ARGS= --prefix='$${DESTDIR}${PREFIX}' \
--verbose --program-transform-name=s,^,e, \
@


1.73
log
@Bump to 2000-06-26 snapshot, and catch up on backlogged patches.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.72 2000/04/18 23:34:45 espie Exp $
d81 1
a81 1
BUILD_DEPENDS+=	runtest::devel/dejagnu
@


1.72
log
@Forgot to bump NEED_VERSION
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.71 2000/04/18 23:23:15 espie Exp $
d14 1
a14 1
NEED_VERSION=	1.270
d84 1
a84 1
LATEST_DATE=2000-03-13
a183 2
		# avoid packaging include copies along...
	find ${WRKSRC} -name \*.orig|xargs rm
d192 1
a283 7
# XXX we need to override do-build to get the warnings from within make
do-build:
	@@{ cd ${WRKBUILD}; \
	${MAKE_ENV} make ${ALL_TARGET} 2>warnings; } || \
	{ echo "*** Make bootstrap failed."; \
	echo "*** Look at ${WRKBUILD}/warnings for errors"; exit 1; }

d288 2
@


1.72.2.1
log
@bring lang as of cut-over date into 2.7 branch
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.79 2000/08/01 14:44:43 espie Exp $
d14 1
a14 1
NEED_VERSION=	1.302
d41 1
a41 1
MAKE_TESTS=yes
d80 2
a81 2
.if defined(MAKE_TESTS) && ${MAKE_TESTS:L} == "yes"
BUILD_DEPENDS+=	runtest::lang/egcs/dejagnu
d84 1
a84 6
# No way around it, java wants a pure parser
.if defined(MAKE_JAVA) && ${MAKE_JAVA:L} == "yes"
BUILD_DEPENDS+=bison::devel/bison
.endif

LATEST_DATE=2000-07-31
d96 1
a96 1
DIRECTORY=snapshots/%DATE%/
d115 32
d148 9
a156 33
SITES+= ftp://ftp.uvsq.fr/pub/egcs/${DIRECTORY}
SITES+= ftp://ftp.grolier.fr/pub/egcs/${DIRECTORY}
SITES+= ftp://gd.tuwien.ac.at/gnu/gcc/${DIRECTORY}
SITES+= ftp://chardonnay.elis.rug.ac.be/pub/mirrors/gcc.cygnus.com/pub/gcc/${DIRECTORY}
SITES+= ftp://gd.tuwien.ac.at/gnu/gcc/${DIRECTORY}
SITES+=	ftp://egcs.cygnus.com/pub/egcs/${DIRECTORY} 
SITES+= ftp://ftp.goof.com/pub/pcg/egcs/${DIRECTORY}
SITES+= ftp://go.cygnus.com/pub/ftp.cygnus.com/egcs/${DIRECTORY}
SITES+= ftp://cambridge.cygnus.com/pub/egcs/${DIRECTORY}
SITES+= ftp://sunsite.doc.ic.ac.uk/Mirrors/egcs.cygnus.com/pub/egcs/${DIRECTORY}

SITES+= ftp://ftp.gts.cz/pub/MIRRORS/ftp.cygnus.com/pub/egcs/${DIRECTORY}
SITES+= ftp://sunsite.auc.dk/pub/egcs/${DIRECTORY}
SITES+= ftp://ftp.fu-berlin.de/unix/languages/egcs/egcs/${DIRECTORY}
SITES+= ftp://ftp.gwdg.de/pub/cygnus/egcs/${DIRECTORY}
SITES+= ftp://ftp.mpi-sb.mpg.de/pub/gnu/mirror/egcs.cygnus.com/egcs/${DIRECTORY}
SITES+= ftp://ftp.uni-trier.de/pub/languages/c/implementation/egcs/${DIRECTORY}
SITES+= ftp://ftp.sunet.se/pub/gnu/egcs/${DIRECTORY}
SITES+= ftp://ftp.unicamp.br/pub/gnu/=EXTRA=/cygnus/egcs/${DIRECTORY}
SITES+= ftp://ftp.lbi.ro/mirrors/ftp.cygnus.com/pub/egcs/${DIRECTORY}
SITES+= ftp://ftp.ntua.gr/pub/gnu/egcs/${DIRECTORY}
SITES+= ftp://ftp.nluug.nl/pub/languages/egcs/${DIRECTORY}
SITES+= ftp://ftp.dti.ad.jp/pub/lang/egcs/${DIRECTORY}
SITES+= ftp://ftp.win.or.jp/pub/lang/egcs/${DIRECTORY}
SITES+= ftp://ftp.telewaynet.ad.jp/pub/lang/egcs/${DIRECTORY}
SITES+= ftp://ftp.lab.kdd.co.jp/lang/egcs/${DIRECTORY}
SITES+= ftp://ftp.funet.fi/mirrors/ftp.cygnus.com/pub/egcs/${DIRECTORY}
SITES+= ftp://ftp.crc.ca/pub/packages/egcs/${DIRECTORY}
SITES+= ftp://ftp.nc.orc.ru/pub/egcs/${DIRECTORY}
SITES+= ftp://ftp.u-aizu.ac.jp/pub/lang/C/pcg/egcs/${DIRECTORY}
SITES+= ftp://ftp.maisel.int-evry.fr/pub/linux/pentium/egcs/${DIRECTORY}
SITES+= ftp://ftp.yggdrasil.com/mirrors/site/egcs.cygnus.com/pub/egcs/${DIRECTORY}
SITES+= ftp://unix.hensa.ac.uk/mirrors/egcs.cygnus.com/pub/egcs/${DIRECTORY}
a157 17
# Can't contact those, maybe they work ?
SITES+= ftp://sunsite.mff.cuni.cz/pub/GNU/egcs/${DIRECTORY}
SITES+= ftp://sunsite.icm.edu.pl/pub/programming/egcs/${DIRECTORY}
SITES+= ftp://ftp.task.gda.pl/mirror/egcs.cygnus.com/pub/egcs/${DIRECTORY}
SITES+= ftp://ftp.lca.uevora.pt/pub/egcs/${DIRECTORY}
SITES+= ftp://cair-archive.kaist.ac.kr/pub/gnu/egcs/${DIRECTORY}
SITES+= ftp://linux.ihep.su/pub/cygnus/egcs/${DIRECTORY}
SITES+= ftp://linux.cis.nctu.edu.tw/pub/packages/pcg/egcs/${DIRECTORY}
SITES+= ftp://ftp.ninemoons.com/pub/mirrors/egcs/${DIRECTORY}

# Bad mirrors (no snapshot)
# ftp.lip6.fr, ftp.ilog.fr, ftp.irisa.fr
# No route to host
# mirrors.aarnet.edu.au
#SITES+=	ftp://ftp.lip6.fr/pub/egcs/${DIRECTORY}
#SITES+= ftp://ftp.ilog.fr/pub/Mirrors/egcs/${DIRECTORY}
#SITES+= ftp://ftp.irisa.fr/pub/mirrors/egcs.cygwin.com/gcc/${DIRECTORY}
d160 1
d184 2
a193 1
	cd ${WRKSRC} && rm -rf texinfo
d205 1
a205 1
CONFIGURE_STYLE=	gnu dest
d211 1
a211 1
LANGS:=${LANGS},c++
d214 1
a214 1
LANGS:=${LANGS},f77
d217 1
a217 1
LANGS.=${LANGS},CHILL
d220 1
a220 1
LANGS:=${LANGS},objc
d223 1
a223 1
LANGS:=${LANGS},java
d228 3
a230 1
CFLAGS=-O2 -g
d233 4
a236 2
CONFIGURE_ARGS= --verbose --program-transform-name=s,^,e, \
--disable-nls 
a240 1
CONFIGURE_ARGS+=--enable-languages=${LANGS}
d273 1
a273 1
ALL_TARGET=bootstrap
d285 7
a295 2
		# avoid packaging include copies along...
	find ${WRKBUILD} -name \*.orig|xargs rm
@


1.71
log
@MULTI_PACKAGES gcc.
Splits one large 5Mb packages into core/c++/f77/java, all around 1Mb.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.70 2000/03/29 23:26:17 espie Exp $
d14 1
a14 1
NEED_VERSION=	1.230
@


1.70
log
@20000313 snapshot.
Simplify framework somewhere (don't go around downloading n+ distinct
archives)
Fake
Remove fixinc.sh more `permanently'.

20000327 snapshot and more tests pending
(sjlj is broken, I have a patch by Jeff to test).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62 1999/12/14 00:19:15 espie Exp $
d21 1
a21 1
PERMIT_DISTFILES_FTP="Yes, but wasteful"
d42 2
a43 2
MAKE_GXX=yes
MAKE_FORTRAN=yes
d46 33
a78 2
MAKE_OBJC=yes
MAKE_JAVA=yes
a181 17
PATCH_LIST=patch-core-*
.if defined(MAKE_GXX)
PATCH_LIST+=patch-g++-*
.endif
.if defined(MAKE_OBJC)
PATCH_LIST+=patch-objc-*
.endif
.if defined(MAKE_CHILL)
PATCH_LIST+=patch-chill-*
.endif
.if defined(MAKE_FORTRAN)
PATCH_LIST+=patch-g77-*
.endif
.if defined(MAKE_JAVA)
PATCH_LIST+=patch-java-*
.endif

d315 3
a317 18
PLIST=${WRKBUILD}/PLIST

M4FLAGS=-Uinclude -DDISTNAME=${DISTNAME}
.if defined(MAKE_GXX)
M4FLAGS+= -DGXX
.endif
.if defined(MAKE_FORTRAN)
M4FLAGS+= -DFORTRAN
.endif
.if defined(MAKE_CHILL)
M4FLAGS+= -DCHILL
.endif
.if defined(MAKE_OBJC)
M4FLAGS+= -DOBJC
.endif
.if defined(MAKE_JAVA)
M4FLAGS+= -DJAVA
.endif
a319 4
pre-install:
	m4 ${M4FLAGS} -DARCH=`${GCC_NAME} -dumpmachine` \
	-DVERSION=`${GCC_NAME} -dumpversion` \
	<${FILESDIR}/PLIST.template >${PLIST}
a322 3
.if !defined(NO_SHARED_LIBS)
M4FLAGS+= -DDYNAMIC
.endif
@


1.69
log
@Introduce :: in *_DEPENDS as a place holder for a package spec
Bump NEED_VERSION.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.68 2000/03/05 18:30:30 espie Exp $
d14 1
a14 1
NEED_VERSION=	 1.230
a16 5
LICENSE_TYPE=		GPL
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
d18 6
a23 1
MIRROR_DISTFILE=no
d44 1
a44 1
# chill is temporarily broken
d53 1
a53 5
# if you want/need to use the mammoth archive
ONE_ARCHIVE=yes


LATEST_DATE=1999-12-08
d61 1
a61 1
#NEXT_DATE=1999-12-08
d74 2
a80 1
.if defined(ONE_ARCHIVE)
a81 36
.else

DISTFILES=	egcs-core-${LATEST}${EXTRACT_SUFX}
.if defined(MAKE_TESTS)
DISTFILES+=egcs-tests-${LATEST}${EXTRACT_SUFX}
.endif

.if defined(MAKE_GXX)
DISTFILES+=     egcs-g++-${LATEST}${EXTRACT_SUFX}
.endif

.if defined(MAKE_FORTRAN)
DISTFILES+=     egcs-g77-${LATEST}${EXTRACT_SUFX}
.endif

.if defined(MAKE_JAVA)
DISTFILES+=egcs-java-${LATEST}${EXTRACT_SUFX}
.endif

.if defined(MAKE_OBJC)
DISTFILES+=egcs-objc-${LATEST}${EXTRACT_SUFX}
.endif

.if defined(MAKE_CHILL)
DISTFILES+=egcs-chill-${LATEST}${EXTRACT_SUFX}
.endif

.endif

.if ! (defined(JUST_BUMP) && defined(NEXT_DATE))
SUPDISTFILES=egcs-${LATEST}${EXTRACT_SUFX}
.for sub in core g++ g77 java objc chill
SUPDISTFILES+=egcs-${sub}-${LATEST}${EXTRACT_SUFX}
.endfor
.endif

d84 1
a85 1
SITES+=	ftp://egcs.cygnus.com/pub/${DIRECTORY} 
d88 1
a88 1
#SITES+= ftp://cambridge.cygnus.com/pub/${DIRECTORY}
d91 2
a92 2
#SITES+= ftp://ftp.ilog.fr/pub/Mirrors/${DIRECTORY}
#SITES+= ftp://ftp.irisa.fr/pub/mirrors/${DIRECTORY}
d101 1
a101 1
#SITES+= ftp://ftp.unicamp.br/pub/gnu/=EXTRA=/cygnus/${DIRECTORY}
d109 2
a110 2
#SITES+= ftp://ftp.funet.fi/mirrors/ftp.cygnus.com/pub/${DIRECTORY}
#SITES+= ftp://ftp.crc.ca/pub/packages/${DIRECTORY}
d112 1
a112 1
#SITES+= ftp://ftp.u-aizu.ac.jp/pub/lang/C/pcg/${DIRECTORY}
d117 1
a117 1
# couldn't contact those, maybe they work ?
d129 2
d134 1
a134 37
MASTER_SITES0=${SITES:S/%DATE%/${NEXT_DATE}/}
.if defined(ONE_ARCHIVE)
PATCHFILES=egcs-${LATEST}-${NEXT}.diff.gz:0

.else
PATCHFILES=egcs-core-${LATEST}-${NEXT}.diff.gz:0
.if defined(MAKE_TESTS)
PATCHFILES+=egcs-tests-${LATEST}-${NEXT}.diff.gz:0
.endif
.if defined(MAKE_GXX)
PATCHFILES+=egcs-g++-${LATEST}-${NEXT}.diff.gz:0
.if defined(MAKE_TESTS)
PATCHFILES+=egcs-g++-tests-${LATEST}-${NEXT}.diff.gz:0
.endif
.endif
.if defined(MAKE_FORTRAN)
PATCHFILES+=egcs-g77-${LATEST}-${NEXT}.diff.gz:0
.if defined(MAKE_TESTS)
PATCHFILES+=egcs-g77-testsuite-${LATEST}-${NEXT}.diff.gz:0
.endif
.endif
.if defined(MAKE_JAVA)
PATCHFILES+=egcs-java-${LATEST}-${NEXT}.diff.gz:0
.endif
.if defined(MAKE_OBJC)
PATCHFILES+=egcs-objc-${LATEST}-${NEXT}.diff.gz:0
.endif
.if defined(MAKE_CHILL)
PATCHFILES+=egcs-chill-${LATEST}-${NEXT}.diff.gz:0
.endif
.endif

SUPDISTFILES=egcs-${LATEST}-${NEXT}.diff.gz:0
.for sub in core tests g++ g77 java objc chill
SUPDISTFILES+=egcs-${sub}-${LATEST}-${NEXT}.diff.gz:0
.endfor

d138 1
a138 1
	@@echo 1>&2">>>Please make addsum to avoid clobbering old checksums"
d191 1
a191 1
GNU_CONFIGURE=	yes
d214 1
a214 1
CFLAGS=-g -O2
d219 1
a219 1
CONFIGURE_ARGS= --prefix=${PREFIX} \
a223 1

d267 3
a269 2
	${FILESDIR}/fixinc.sh.m4 >${WRKBUILD}/gcc/fixinc.sh
	chmod a+x ${WRKBUILD}/gcc/fixinc.sh
d291 1
a291 1
	${MAKE_ENV} make -f Makefile check && \
@


1.68
log
@PORTSDIR no longer needed in *DEPENDS.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.67 2000/02/22 17:08:41 espie Exp $
d11 1
a11 1
BUILD_DEPENDS=	autoconf:devel/autoconf
d14 1
a14 1
NEED_VERSION=	1.223
d50 1
a50 1
BUILD_DEPENDS+=	runtest:devel/dejagnu
@


1.67
log
@MAKEFILE-> MAKE_FILE
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.66 2000/02/16 10:52:11 espie Exp $
a7 1
NEED_VERSION=1.210
d11 1
a11 1
BUILD_DEPENDS=	autoconf:${PORTSDIR}/devel/autoconf
d14 1
d18 4
a21 4
PERMIT_PACKAGE_CDROM=	YES
PERMIT_PACKAGE_FTP=	YES
PERMIT_DISTFILES_CDROM=	YES
PERMIT_DISTFILES_FTP=	YES
d50 1
a50 1
BUILD_DEPENDS+=	runtest:${PORTSDIR}/devel/dejagnu
@


1.66
log
@All the Makefiles cvs missed first time around...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.65 2000/02/15 05:04:36 turan Exp $
d8 1
a8 1
NEED_VERSION=1.178
d364 1
a364 1
	${MAKE_ENV} make -f ${MAKEFILE} check && \
@


1.65
log
@espie will not shut up about this, DISTF -> DISTFILES, PKG -> PACKAGE
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.64 2000/02/12 08:02:22 turan Exp $
d244 1
a244 1
	find ${WRKSRC} -name \*.orig|xargs ${RM}
@


1.64
log
@gpl licenses
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.63 2000/02/02 18:35:23 espie Exp $
d18 4
a21 4
PERMIT_PKG_CDROM=	YES
PERMIT_PKG_FTP=		YES
PERMIT_DISTF_CDROM=	YES
PERMIT_DISTF_FTP=	YES
@


1.63
log
@Kill last PATCH_SITES, now that I've fixed the double typo. sigh.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62 1999/12/14 00:19:15 espie Exp $
d16 7
@


1.62
log
@Update to 991208 snapshot, quite a few bugs fixed as usual.
Highlight: inlining on function trees should be active in C++.

Reword include files fixing so that it wedges in where it is
supposed to, as latest tweaks to va_list means the stage1 compiler
needs correct includes.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.61 1999/12/03 11:30:11 espie Exp $
d8 1
a8 1
NEED_VERSION=1.73
d61 2
a62 2
LATEST != echo ${LATEST_DATE} | sed -e s/-//g;
DIRECTORY=egcs/snapshots/%SUBDIR%/
d64 1
a64 1
NEXT != echo ${NEXT_DATE} | sed -e s/-//g;
a70 2
MASTER_SITE_SUBDIR=${LATEST_DATE}
PATCH_SITE_SUBDIR=${NEXT_DATE}
d115 33
a147 33
MASTER_SITES=	
MASTER_SITES+=	ftp://ftp.lip6.fr/pub/${DIRECTORY}
MASTER_SITES+=	ftp://egcs.cygnus.com/pub/${DIRECTORY} 
MASTER_SITES+= ftp://ftp.goof.com/pub/pcg/${DIRECTORY}
MASTER_SITES+= ftp://go.cygnus.com/pub/ftp.cygnus.com/${DIRECTORY}
#MASTER_SITES+= ftp://cambridge.cygnus.com/pub/${DIRECTORY}
MASTER_SITES+= ftp://sunsite.doc.ic.ac.uk/Mirrors/egcs.cygnus.com/pub/${DIRECTORY}
MASTER_SITES+= ftp://gd.tuwien.ac.at/gnu/${DIRECTORY}
#MASTER_SITES+= ftp://ftp.ilog.fr/pub/Mirrors/${DIRECTORY}
#MASTER_SITES+= ftp://ftp.irisa.fr/pub/mirrors/${DIRECTORY}

MASTER_SITES+= ftp://ftp.gts.cz/pub/MIRRORS/ftp.cygnus.com/pub/${DIRECTORY}
MASTER_SITES+= ftp://sunsite.auc.dk/pub/${DIRECTORY}
MASTER_SITES+= ftp://ftp.fu-berlin.de/unix/languages/${DIRECTORY}
MASTER_SITES+= ftp://ftp.gwdg.de/pub/cygnus/${DIRECTORY}
MASTER_SITES+= ftp://ftp.mpi-sb.mpg.de/pub/gnu/mirror/egcs.cygnus.com/${DIRECTORY}
MASTER_SITES+= ftp://ftp.uni-trier.de/pub/languages/c/implementation/${DIRECTORY}
MASTER_SITES+= ftp://ftp.sunet.se/pub/gnu/${DIRECTORY}
#MASTER_SITES+= ftp://ftp.unicamp.br/pub/gnu/=EXTRA=/cygnus/${DIRECTORY}
MASTER_SITES+= ftp://ftp.lbi.ro/mirrors/ftp.cygnus.com/pub/${DIRECTORY}
MASTER_SITES+= ftp://ftp.ntua.gr/pub/gnu/${DIRECTORY}
MASTER_SITES+= ftp://ftp.nluug.nl/pub/languages/${DIRECTORY}
MASTER_SITES+= ftp://ftp.dti.ad.jp/pub/lang/${DIRECTORY}
MASTER_SITES+= ftp://ftp.win.or.jp/pub/lang/${DIRECTORY}
MASTER_SITES+= ftp://ftp.telewaynet.ad.jp/pub/lang/${DIRECTORY}
MASTER_SITES+= ftp://ftp.lab.kdd.co.jp/lang/${DIRECTORY}
#MASTER_SITES+= ftp://ftp.funet.fi/mirrors/ftp.cygnus.com/pub/${DIRECTORY}
#MASTER_SITES+= ftp://ftp.crc.ca/pub/packages/${DIRECTORY}
MASTER_SITES+= ftp://ftp.nc.orc.ru/pub/${DIRECTORY}
#MASTER_SITES+= ftp://ftp.u-aizu.ac.jp/pub/lang/C/pcg/${DIRECTORY}
MASTER_SITES+= ftp://ftp.maisel.int-evry.fr/pub/linux/pentium/${DIRECTORY}
MASTER_SITES+= ftp://ftp.yggdrasil.com/mirrors/site/egcs.cygnus.com/pub/${DIRECTORY}
MASTER_SITES+= ftp://unix.hensa.ac.uk/mirrors/egcs.cygnus.com/pub/${DIRECTORY}
d150 8
a157 8
MASTER_SITES+= ftp://sunsite.mff.cuni.cz/pub/GNU/${DIRECTORY}
MASTER_SITES+= ftp://sunsite.icm.edu.pl/pub/programming/${DIRECTORY}
MASTER_SITES+= ftp://ftp.task.gda.pl/mirror/egcs.cygnus.com/pub/${DIRECTORY}
MASTER_SITES+= ftp://ftp.lca.uevora.pt/pub/${DIRECTORY}
MASTER_SITES+= ftp://cair-archive.kaist.ac.kr/pub/gnu/${DIRECTORY}
MASTER_SITES+= ftp://linux.ihep.su/pub/cygnus/${DIRECTORY}
MASTER_SITES+= ftp://linux.cis.nctu.edu.tw/pub/packages/pcg/${DIRECTORY}
MASTER_SITES+= ftp://ftp.ninemoons.com/pub/mirrors/${DIRECTORY}
d159 1
a159 1
PATCH_SITES = ${MASTER_SITES}
d164 1
d166 1
a166 1
PATCHFILES=egcs-${LATEST}-${NEXT}.diff.gz
d169 1
a169 1
PATCHFILES=egcs-core-${LATEST}-${NEXT}.diff.gz
d171 1
a171 1
PATCHFILES+=egcs-tests-${LATEST}-${NEXT}.diff.gz
d174 1
a174 1
PATCHFILES+=egcs-g++-${LATEST}-${NEXT}.diff.gz
d176 1
a176 1
PATCHFILES+=egcs-g++-tests-${LATEST}-${NEXT}.diff.gz
d180 1
a180 1
PATCHFILES+=egcs-g77-${LATEST}-${NEXT}.diff.gz
d182 1
a182 1
PATCHFILES+=egcs-g77-testsuite-${LATEST}-${NEXT}.diff.gz
d186 1
a186 1
PATCHFILES+=egcs-java-${LATEST}-${NEXT}.diff.gz
d189 1
a189 1
PATCHFILES+=egcs-objc-${LATEST}-${NEXT}.diff.gz
d192 1
a192 1
PATCHFILES+=egcs-chill-${LATEST}-${NEXT}.diff.gz
d196 1
a196 1
SUPPATCHFILES=egcs-${LATEST}-${NEXT}.diff.gz
d198 1
a198 1
SUPPATCHFILES+=egcs-${sub}-${LATEST}-${NEXT}.diff.gz
@


1.61
log
@19991201 snapshot.
Fixes at least one regression in the C testsuite.
No new regressions seen so far.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.60 1999/12/01 17:38:43 espie Exp $
d50 1
a50 1
LATEST_DATE=1999-12-01
d58 1
a58 1
#NEXT_DATE=1999-12-01
d334 3
a336 1
	echo "#!/bin/sh" >${WRKBUILD}/gcc/fixinc.sh
d340 4
a343 4
	@@(cd ${WRKBUILD}; \
	${MAKE_ENV} make ${ALL_TARGET} 2>warnings) || \
	(echo "*** Make bootstrap failed."; \
	echo "*** Look at ${WRKBUILD}/warnings for errors"; ${FALSE})
@


1.60
log
@Update to 991122 snapshot, which fixes a few issues yet.
Update i386 test-results to something more current.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59 1999/11/24 00:15:04 espie Exp $
d50 1
a50 1
LATEST_DATE=1999-11-22
d58 1
a58 1
#NEXT_DATE=1999-11-22
@


1.59
log
@Argh. I was SURE I had repaired that port WEEKS ago.
So, here goes.

- retrieve a recent snapshot of egcs, to justify the port's existence,
- remove outdated fixes, now that we're synching with 2.6,
- update patches to deal with the current snapshot,
- get a description that matches better what's going on,
- add fixed include files to match the new varargs handling (complexity
is now within gcc, instead of arch-dependent include files).

Builds on i386, at least.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 1999/11/14 22:00:36 turan Exp $
d50 1
a50 1
LATEST_DATE=1999-11-10
d58 1
a58 1
#NEXT_DATE=1999-09-13
d358 2
a359 2
	@@${ECHO} "Please send the tests results to the egcs project"
	@@${ECHO} "By invoking make send-results"
@


1.58
log
@i cannot spell BROKEN
@
text
@d1 1
a1 3
# $OpenBSD: Makefile,v 1.57 1999/11/03 03:14:58 turan Exp $

BROKEN=	/usr/ports/lang/egcs/snapshot/work/egcs-19990907/gcc/configure[3588]: syntax error: newline unexpected
d34 1
a34 1
MAKE_TESTS=yes
d50 1
a50 1
LATEST_DATE=1999-09-07
d58 1
a58 1
#NEXT_DATE=1999-09-07
a203 13
# Misc bug sections
pre-fetch:
.if (${MACHINE_ARCH} == "i386")
	@@(cd /tmp && /usr/bin/as -k ${FILESDIR}/gas-bug/test-i386-gas.s) || \
	(${ECHO} "Your gas has a bug, see ${FILESDIR}/gas-bug for details"; ${FALSE})
.endif
#	@@if [ -f /usr/lib/libc.so.* ]; \
#	then \
#		ldd /usr/lib/libc.so.* 2>/dev/null || \
#		(${ECHO} "Your ldd must be patched, see ${FILESDIR}/ldd-patch"; ${FALSE}) \
#	fi


d205 2
a206 2
	@@${ECHO} ">>>Please make addsum to avoid clobbering old checksums"
	@@${FALSE}
d211 1
a211 1
	${MV} ${WRKDIR}/egcs-${LATEST} ${WRKSRC}
d239 2
a240 1
	${CP} -R ${FILESDIR}/config/* ${WRKSRC}
d246 1
d327 2
a328 1
ALL_TARGET=bootstrap
d339 1
a339 1
	${MAKE_ENV} ${MAKE_PROGRAM} ${MAKE_FLAGS} ${MAKEFILE} ${ALL_TARGET} 2>warnings) || \
d346 5
a350 2
# Tests no longer need to be performed at the end of install, this
# was a bug in libstdc++/openbsd.ml
d354 1
a354 1
post-build:
d356 1
a356 1
	${MAKE_ENV} ${MAKE_PROGRAM} ${MAKE_FLAGS} ${MAKEFILE} check && \
d363 1
a384 5
special: extract
		# avoid packaging include copies along...
	find ${WRKSRC} -name \*.orig|xargs ${RM}
	-${RM} -rf ${WRKSRC}/texinfo 
	
d387 1
a387 1
	${M4} ${M4FLAGS} -DARCH=`${GCC_NAME} -dumpmachine` \
@


1.57
log
@broken.  compile problems on i386.  maint notified.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 1999/09/09 14:25:11 espie Exp $
d3 1
a3 1
ROKEN=	/usr/ports/lang/egcs/snapshot/work/egcs-19990907/gcc/configure[3588]: syntax error: newline unexpected
@


1.56
log
@Update to 990907, including i386 test results,
- use contrib/egcs-update instead of rolling our own,
- autoreconf does not perform as I expected, autoconf does.
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.55 1999/09/07 15:04:02 espie Exp $
@


1.55
log
@egcs snapshot temporarily broken... wait for next snapshot.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.54 1999/09/06 13:58:44 espie Exp $
a9 2
BROKEN="latest (990830) snapshot is broken, but cvs-current works"

d34 4
a37 3
#MAKE_TESTS=yes
#MAKE_GXX=yes
#MAKE_FORTRAN=yes
d39 2
a40 2
#MAKE_OBJC=yes
#MAKE_JAVA=yes
d50 1
a50 1
LATEST_DATE=1999-08-30
d58 1
a58 1
#NEXT_DATE=1999-06-29
d256 2
a257 2
	cd ${WRKSRC}/gcc && PATH=${PORTPATH} autoreconf
	cd ${WRKSRC}/libiberty && PATH=${PORTPATH} autoreconf
@


1.54
log
@Update to 990830 snapshot
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 1999/08/24 22:52:38 espie Exp $
d10 2
d36 3
a38 3
MAKE_TESTS=yes
MAKE_GXX=yes
MAKE_FORTRAN=yes
d40 2
a41 2
MAKE_OBJC=yes
MAKE_JAVA=yes
d254 1
a254 5
	cd ${WRKSRC}; \
	for f in `cat ${FILESDIR}/fixdepend`; \
	do \
		[ -f $$f ] && touch $$f; \
	done 
d293 1
a293 1
#CFLAGS='-g -O2'
@


1.53
log
@990824 snapshot.
Past the 2.95.1 release, lots of changes since last snapshot
(joins `mainstream' egcs development again)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.52 1999/08/22 16:53:37 espie Exp $
d37 1
a37 1
MAKE_CHILL=yes
d49 1
a49 1
LATEST_DATE=1999-08-24
@


1.52
log
@Update experimental snapshot as well.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 1999/07/04 18:20:26 espie Exp $
d34 1
a34 1
#MAKE_TESTS=yes
d49 1
a49 1
LATEST_DATE=1999-08-08
d341 1
a341 2
#ALL_TARGET=bootstrap
ALL_TARGET=bootstrap3
@


1.51
log
@990629 snapshot
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 1999/06/17 17:06:39 espie Exp $
d34 1
a34 1
MAKE_TESTS=yes
d49 1
a49 1
LATEST_DATE=1999-06-29
d110 1
a110 1
.for sub in core tests g++ g77 java objc chill
d117 1
a118 1
MASTER_SITES+=	ftp://ftp.lip6.fr/pub/${DIRECTORY}
d341 2
a342 1
ALL_TARGET=bootstrap
@


1.50
log
@Bump to 990616

PLIST not verified yet
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 1999/06/02 23:32:47 espie Exp $
d49 1
a49 1
LATEST_DATE=1999-06-16
d57 1
a57 1
#NEXT_DATE=1999-06-16
@


1.49
log
@Update to 990602 snapshot
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 1999/06/01 20:59:34 espie Exp $
d49 1
a49 1
LATEST_DATE=1999-06-02
d57 1
a57 1
#NEXT_DATE=1999-06-02
d209 5
a213 5
	@@if [ -f /usr/lib/libc.so.* ]; \
	then \
		ldd /usr/lib/libc.so.* 2>/dev/null || \
		(${ECHO} "Your ldd must be patched, see ${FILESDIR}/ldd-patch"; ${FALSE}) \
	fi
d399 1
d401 2
a402 2
	${M4} ${M4FLAGS} -DARCH=`${WRKSRC}/config.guess` \
	-DVERSION=`${SED} -e 's/.*"\([a-z]*-[0-9.]*\) .*/\1/' <${WRKSRC}/gcc/version.c` \
@


1.48
log
@Oops, forgot that one.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 1999/05/25 20:18:25 espie Exp $
d49 1
a49 1
LATEST_DATE=1999-05-24
d57 1
a57 1
#NEXT_DATE=1999-05-24
d372 1
a372 1
	[ -f ${TEST_RESULT}] && sh ${TEST_RESULT}
@


1.47
log
@let PLIST work again, since the version number scheme changed...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 1999/05/25 19:55:21 espie Exp $
d328 1
a328 1
SEPARATE_BUILD=yes
@


1.46
log
@990524 snapshot.

Use make `features' properly, variable expansion is tricky...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 1999/05/18 17:07:16 espie Exp $
d401 1
a401 1
	-DVERSION=`${SED} -e 's/.*\(egcs-[0-9.]*\) .*/\1/' <${WRKSRC}/gcc/version.c` \
@


1.45
log
@19990517 compiles and tests okay.

The recent changes to collect2 (needed by java) mean ldd must be updated,
the Makefile now checks for that problem.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 1999/05/14 01:15:29 espie Exp $
d49 1
a49 1
LATEST_DATE=1999-05-17
d57 1
a57 1
#NEXT_DATE=1999-05-17
d302 2
a303 1
--disable-subdir-texinfo
d371 2
a372 2
send-results: ${TEST_RESULT}
	sh ${TEST_RESULT}
@


1.44
log
@Patch configure.in to disable texinfo instead of removing the dir.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 1999/05/05 13:08:21 espie Exp $
d49 1
a49 1
LATEST_DATE=1999-05-02
d57 1
a57 1
#NEXT_DATE=1999-05-02
d204 1
a205 1
pre-fetch:
d209 5
@


1.43
log
@990502 compiles.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 1999/04/29 16:54:19 espie Exp $
a246 1
	-${RM} -rf ${WRKSRC}/texinfo 
d297 1
@


1.42
log
@Update to 990428... remove patches that are now in the official version.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 1999/04/28 15:40:26 espie Exp $
d49 1
a49 1
LATEST_DATE=1999-04-28
d57 1
a57 1
#NEXT_DATE=1999-04-28
@


1.41
log
@Update to 19990418 snapshot

A few odds and end fixed with PLIST.template

Framework to detect the gas i386 problem

Removed bogus patch
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 1999/04/18 20:54:38 espie Exp $
d49 1
a49 1
LATEST_DATE=1999-04-18
d57 1
a57 1
#NEXT_DATE=1999-04-18
d108 1
d113 1
d117 1
a117 1
#MASTER_SITES+=	ftp://egcs.cygnus.com/pub/${DIRECTORY} 
d119 1
a120 1
MASTER_SITES+= ftp://ftp.goof.com/pub/pcg/${DIRECTORY}
@


1.40
log
@Upgrade to 19990412 snapshot

Add a few things to simplify testing still more.

Introduce SUPDISTFILES/SUPPATCHFILES to use by a pending bsd.port.mk...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 1999/03/22 00:25:33 espie Exp $
d49 1
a49 1
LATEST_DATE=1999-04-12
d53 1
a53 2
# define NEXT_DATE to the next snapshot... you lose the ability to check
# md5 sums, though.
d115 1
a115 1
MASTER_SITES+=	ftp://egcs.cygnus.com/pub/${DIRECTORY} 
d201 8
d295 6
a300 1
--verbose --program-transform-name=s,^,e, 
d321 1
a321 1
WRKBUILD=${WRKDIR}/build-${MACHINE_ARCH}
d336 5
d351 2
a352 2
# Tests should be performed at the end of install, since they depend upon
# having the correct flavor of libstdc++.so.
d356 1
a356 1
post-install:
d360 1
a360 1
	@@${ECHO} "Please send the tests results to the egcs projects"
d386 5
@


1.39
log
@???
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 1999/03/07 14:15:33 espie Exp $
d49 1
a49 1
LATEST_DATE=1999-03-14
d58 1
a58 1
NEXT_DATE=1999-03-21
d109 6
a120 1
MASTER_SITES+= ftp://ftp.ninemoons.com/pub/mirrors/${DIRECTORY}
d157 1
d195 5
d202 4
d236 1
a236 1
	#find ${WRKSRC} -name \*.orig|xargs ${RM}
d280 6
a285 1
CONFIGURE_ENV=LANGUAGES='${LANGS}' CFLAGS='-O2'
d328 5
a332 2
	(echo "Make bootstrap failed."; \
	echo "Don't forget to look at ${WRKBUILD}/warnings"; ${FALSE})
d334 2
d337 11
a347 3
post-build:
	@@(cd ${WRKBUILD}; \
	${MAKE_ENV} ${MAKE_PROGRAM} ${MAKE_FLAGS} ${MAKEFILE} check)
a348 3

####
# Install section
@


1.38
log
@- 19990307 snapshot
- consistent version number for libstdc++.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 1999/03/02 04:41:04 marc Exp $
d49 1
a49 1
LATEST_DATE=1999-02-28
d58 1
a58 1
NEXT_DATE=1999-03-07
@


1.37
log
@fix earlier bogus changes to Makefile where a value that
was defined in bsd.port.mk was checked before bsd.port.mk was included;
this should make ports with optional shared libs build on the alpha,
again.  However, chages require the latest bsd.port.mk
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 1999/02/28 18:17:06 espie Exp $
d58 1
a58 1
#NEXT_DATE=1999-02-28
@


1.36
log
@Synch with 19990228 snapshot
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 1999/02/23 16:54:48 espie Exp $
d8 1
a8 1
NEED_VERSION=1.64
d286 1
a286 3
.if !defined(NO_SHARED_LIBS)
CONFIGURE_ARGS+=--enable-shared
.endif
a337 3
.if !defined(NO_SHARED_LIBS)
M4FLAGS+= -DDYNAMIC
.endif
d345 4
@


1.35
log
@Split up tests to post-build.
Assert LD_LIBRARY_PATH, try to avoid tripping up on gcc 2.8.1 libstdc++
while doing the tests...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 1999/02/23 09:28:23 espie Exp $
d49 1
a49 1
LATEST_DATE=1999-02-21
d58 1
a58 1
#NEXT_DATE=1999-02-14
d229 4
d290 1
a292 5
# rebuild configure files after patching, then move source around !!!
# XXX: don't try to autoconf the main configure file, it's not autoconf.
pre-configure:
	cd ${WRKSRC}/gcc && PATH=${PORTPATH} autoreconf
	cd ${WRKSRC}/libiberty && PATH=${PORTPATH} autoreconf
d316 1
a316 2
	${MAKE_ENV} LD_LIBRARY_PATH=${PREFIX}/lib \
	${MAKE_PROGRAM} ${MAKE_FLAGS} ${MAKEFILE} check)
@


1.34
log
@Then upgrade to 980221 snapshot
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 1999/02/21 01:04:59 espie Exp $
a304 3
.if defined(MAKE_TESTS)
ALL_TARGET+=check
.endif
d313 6
@


1.33
log
@Make sure NO_SHARED_LIBS is obeyed.
@
text
@d1 2
a2 7
# OpenBSD makefile for:	egcs
# Version required:	recent enough snapshot, check below
# Date created:		25 sep 98
# Whom:			Marc Espie
#
# $OpenBSD: Makefile,v 1.32 1999/02/20 04:26:13 espie Exp $
#
d21 4
a24 1
# Wim Van Deputte for alpha.
d49 1
a49 1
LATEST_DATE=1999-02-14
@


1.32
log
@This does match what the FSF took in.
If you're wondering about the added blank lines at the end
of all Makefile fragments, just think how it will look when it is
inserted in the Makefile.
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.31 1999/02/18 02:37:32 marc Exp $
d13 1
a13 1
NEED_VERSION=1.60
@


1.31
log
@use NO_SHARED_LIBS instead of test for alpha;
use PLIST.noshared instead of PLIST.alpha
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.30 1999/02/14 19:33:31 espie Exp $
d12 3
a16 2

NEED_VERSION=1.60
a18 1

d300 1
a300 1
# reported to the egcs folks
d340 1
a340 1
.if (${MACHINE_ARCH}) != "alpha")
@


1.30
log
@Update to 990214 snapshot.
This snapshot disables recent loop changes, so the regressions from
990131 -> 990208 should no longer be there, I hope.

Removed patches have been folded back to mainstream.
This is a slight problem, as someone who wants to use an older snapshot
will have to track the CVS history of this port to find out what he
needs...

Fixed small PATH problem with autoreconf, thanks pefo.

New mips tweaks not yet in.
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.29 1999/02/13 00:53:48 espie Exp $
d284 1
a284 1
.if (${MACHINE_ARCH} != "alpha")
@


1.29
log
@Add generic xm* fragments to prevent nasty surprises, such as being
mistaken for systemV :) (and real nasties, too)
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.28 1999/02/09 10:47:44 espie Exp $
d51 1
a51 1
LATEST_DATE=1999-01-31
d60 1
a60 1
NEXT_DATE=1999-02-08
a225 1
	${MV} ${WRKSRC}/libiberty/mkstemp.c ${WRKSRC}/libiberty/mkstemps.c
d293 2
a294 2
	cd ${WRKSRC}/gcc && autoreconf
	cd ${WRKSRC}/libiberty && autoreconf
@


1.28
log
@Forgot yet another WRKBUILD for the PLIST to be generated correctly...
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.27 1999/02/08 20:34:26 espie Exp $
d223 1
a223 1
	find ${WRKSRC} -name \*.orig|xargs ${RM}
@


1.27
log
@Update to 990208 snapshot: mainly kill all patches that I've got into egcs,
synch configure.in line numbers
and add a symbolic MASK_SNAKE I had forgotten for hppa.
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.26 1999/02/06 16:31:14 espie Exp $
d223 1
a223 1
	#find ${WRKSRC} -name \*.orig|xargs ${RM}
d346 1
a346 1
	${M4} ${M4FLAGS} -DARCH=`${WRKDIR}/source/config.guess` \
@


1.26
log
@Cleaning up configuration, and comments...
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.25 1999/02/04 13:21:12 espie Exp $
d60 1
a60 1
#NEXT_DATE=1999-01-17
d317 1
a317 1
	echo "Don't forget to look at ${WRKSRC}/warnings"; ${FALSE})
@


1.25
log
@Fiddle with openbsd.h, rs6000/openbsd.h so that it can include the
current configuration.

Fix blunder in Makefile.
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.24 1999/02/03 18:02:53 espie Exp $
d323 1
a323 1
PLIST=${WRKDIR}/PLIST
@


1.24
log
@Thread support, approximation...
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.23 1999/02/02 01:19:36 espie Exp $
d347 1
a347 1
	-DVERSION=`${SED} -e 's/.*\(egcs-[0-9.]*\) .*/\1/' <${WRKDIR}/source/gcc/version.c` \
@


1.23
log
@Remove ONLY_FOR_ARCHS, makes little sense now...

rs6000 is special, as it incorporates everything into one file...
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.22 1999/01/31 23:20:41 espie Exp $
d15 1
d245 1
a245 1
CONFIGURE_SCRIPT=../source/configure
d264 2
a265 1
CONFIGURE_ENV=CFLAGS='-O2' LANGUAGES='${LANGS}'
d270 3
d289 1
a295 2
	-${MV} ${WRKSRC} ${WRKDIR}/source
	${MKDIR} ${WRKSRC}
d314 1
a314 1
	@@(cd ${WRKSRC}; \
@


1.22
log
@Update to 19990131 snapshot, plus rename libiberty/mkstemp.c to
a more sensible name for autoconfiguration.
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.21 1999/01/24 21:36:11 espie Exp $
a25 1
ONLY_FOR_ARCHS = i386 sparc m68k alpha pa mips
@


1.21
log
@Update to 19990124 snapshot.
Adjust PLIST.template as it was missing some directories.
Rebuild configure.in patch to only add collect2 when needed, plus typo fix.
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.20 1999/01/18 10:23:25 espie Exp $
d48 1
a48 1
#ONE_ARCHIVE=yes
d51 1
a51 1
LATEST_DATE=1999-01-24
d226 1
d264 1
a264 1
CONFIGURE_ENV=CFLAGS='-O2 -g' LANGUAGES='${LANGS}'
@


1.20
log
@Upgrade to 19990117. Fix a few details for integrating pa & alpha.
First shot at mips.
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.19 1999/01/13 13:58:45 espie Exp $
d48 1
a48 1
ONE_ARCHIVE=yes
d51 1
a51 1
LATEST_DATE=1999-01-12
d60 1
a60 1
NEXT_DATE=1999-01-17
@


1.19
log
@A few tweaks, easing the life of c++filt...
documentation for rationale behind new config.
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.18 1999/01/13 00:09:03 espie Exp $
d26 1
a26 1
ONLY_FOR_ARCHS = i386 sparc m68k alpha pa
d39 1
a39 1
#MAKE_CHILL=yes
d60 1
a60 1
#NEXT_DATE=1998-12-20
@


1.18
log
@New snapshot is out.
Upgrade i386.readme to results of previous snapshots.
Come on, give me alpha/sparc test result files :)
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.17 1999/01/12 11:28:44 espie Exp $
d22 4
a25 3
# with some help from Jason L.Wright & Marco S.Hyman for sparc,
# from Michael Shalayeff for hppa,
# from Wim Van Deputte for alpha.
d39 1
a39 1
MAKE_CHILL=yes
@


1.17
log
@spelling family names from memory is a bad idea...
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.16 1999/01/12 11:27:39 espie Exp $
d38 1
a38 1
#MAKE_CHILL=yes
d47 1
a47 1
#ONE_ARCHIVE=yes
d50 1
a50 1
LATEST_DATE=1999-01-03
@


1.16
log
@- fixed up i386/*VTABLE once more... this time for good.
- clean up openbsd.h comments
- add patch to auto-detect mkstemps. Accordingly, need to run
autoreconf in gcc and in libiberty.
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.15 1999/01/12 00:19:49 espie Exp $
d24 1
a24 1
# from Wim Van Den Putte for alpha.
@


1.15
log
@partial archives are no longer bogus.

i386/openbsd.h does include unix.h which yields a perfectly good definition
of the *THUNK macro.

trivial fix to a bug in gcc.c.
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.14 1999/01/10 02:50:02 espie Exp $
d22 3
a24 1
# with some help from Jason L. Wright for sparc...
d38 1
a38 1
MAKE_CHILL=yes
d284 1
a284 1
# rebuild configure file after patching, then move source around !!!
d287 2
a288 1
	cd ${WRKSRC}/gcc && autoconf
d312 1
a312 1
	echo "Don't forget to look at ${WRKSRC}/warnings")
@


1.14
log
@Update to 990103 snapshot.
Inform user of the warnings file in case of a bootstrap crash.

Major change: add alpha & pa configuration, and clean up ALL
openbsd configuration files thoroughly... this is probably going to
break a few things.
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.13 1999/01/09 16:55:27 espie Exp $
d23 1
a23 1
ONLY_FOR_ARCHS = i386 sparc m68k sparc pa
d30 3
a32 2
# as of 19981213, cygnus snapshot packaging scheme is still BROKEN.
# YOU MUST USE THE MAMMOTH ARCHIVE !!!
d35 4
a38 4
#MAKE_FORTRAN=yes
#MAKE_CHILL=yes
#MAKE_OBJC=yes
#MAKE_JAVA=yes
d45 1
a45 1
ONE_ARCHIVE=yes
a87 3
.if defined(MAKE_TESTS)
DISTFILES+=egcs-g++-tests-${LATEST}${EXTRACT_SUFX}
.endif
a91 3
.if defined(MAKE_TESTS)
DISTFILES+=egcs-g77-testsuite-${LATEST}${EXTRACT_SUFX}
.endif
@


1.13
log
@CFLAGS buglet.

autoconf 2.13 available.
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.12 1998/12/21 21:13:01 espie Exp $
d23 1
a23 1
ONLY_FOR_ARCHS = i386 sparc m68k
d34 4
a37 4
MAKE_FORTRAN=yes
MAKE_CHILL=yes
MAKE_OBJC=yes
MAKE_JAVA=yes
d47 1
a47 1
LATEST_DATE=1998-12-20
d225 1
a225 1
	find ${WRKSRC} -name \*.orig|xargs ${RM}
d311 4
a314 2
	@@(cd ${WRKSRC}; ${MAKE_ENV} ${MAKE_PROGRAM} ${MAKE_FLAGS} ${MAKEFILE} ${ALL_TARGET} 2>warnings)

@


1.12
log
@Update to 1998-12-20 snapshot,
update test results as well,
add threads to openbsd.h.
@
text
@d2 1
a2 1
# Version required:	snapshot 1998-11-22
d6 1
a6 1
# $OpenBSD: Makefile,v 1.11 1998/12/19 00:55:44 espie Exp $
d8 1
a8 1
# This is a configuration file for egcs, recent snapshot
a10 1
# Right now, we can only configure i386. Bound to change in the future
d15 1
a15 3
# we HAVE to provide configure NOW, since the autoconf people have not 
# released autoconf 2.12.1, BUT egcs uses that ANYWAY. Fuck !!!
#BUILD_DEPENDS=	autoconf:${PORTSDIR}/devel/autoconf
a21 1
# this will improve over time as more and more architectures are handled
d265 1
a265 1
CONFIGURE_ENV=CFLAGS=-O2 LANGUAGES='${LANGS}'
a288 1
# DON'T invoke autoconf unless you have autoconf >= 2.12.1
d290 1
a290 1
#	cd ${WRKSRC}/gcc && autoconf
@


1.11
log
@checked some mirrors
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.10 1998/12/17 23:04:10 espie Exp $
d51 1
a51 1
LATEST_DATE=1998-12-13
d60 1
a60 1
#NEXT_DATE=1998-12-13
d233 1
a233 1
	for f in `cat ${FILESDIR}/fixdepend`;
@


1.10
log
@Updated to latest snapshot.
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.9 1998/12/17 05:13:23 marc Exp $
d117 43
a159 5
# to do: check egcs-stable mirror list for sites which carry snapshots

MASTER_SITES=	\
	ftp://egcs.cygnus.com/pub/${DIRECTORY} \
	ftp://ftp.lip6.fr/pub/${DIRECTORY}
@


1.9
log
@MIRROR_DISTFILE=no; changes to often to mirror
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.8 1998/12/16 17:52:29 espie Exp $
d34 1
a34 1
# as of 19981122, cygnus snapshot packaging scheme is BROKEN.
d51 1
a51 1
LATEST_DATE=1998-12-06
d60 1
a60 1
NEXT_DATE=1998-12-13
d73 2
a74 2
MASTER_SITE_SUBDIR=${LATEST}
PATCH_SITE_SUBDIR=${NEXT}
a77 1
PATCH_SITES = ${MASTER_SITES}
d119 2
a120 1
MASTER_SITES=	ftp://egcs.cygnus.com/pub/${DIRECTORY} \
d123 1
@


1.8
log
@Update to 19981213 snapshot.
- use new `enable-languages' mechanism,
- depend i386/openbsd.h on flag_pic
- remove temp fix for m68k
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.7 1998/12/05 23:25:58 espie Exp $
d23 1
@


1.7
log
@m68k builds, at least this release!
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.6 1998/12/03 02:33:34 espie Exp $
a25 2

# 981130 builds for m68k, thanks to Andreas Schwab patch !
d50 1
a50 1
LATEST_DATE=1998-11-30
d56 1
d59 1
a59 1
#NEXT_DATE=1998-11-30
a191 3
.if !defined(MAKE_CHILL)
	-${RM} -rf ${WRKSRC}/gcc/ch ${WRKSRC}/libchill
.endif
d193 1
a193 20
	for f in gcc/c-parse.y \
		 gcc/cstamp-h.in \
		 gcc/c-gperf.h \
		 gcc/c-parse.c \
		 gcc/c-parse.h \
		 gcc/cexp.c \
		 gcc/cp/parse.c \
		 gcc/cp/parse.h \
		 gcc/objc/objc-parse.c \
		 gcc/objc/objc-parse.y \
		 gcc/java/parse.h \
		 gcc/java/parse.c \
		 gcc/java/parse-scan.c \
		 libf2c/libU77/stamp-h.in \
		 contrib/fixinc/fixincl.x \
		 contrib/fixinc/inclhack.sh \
		 contrib/fixinc/fixincl.sh \
		 gcc/fixinc/fixincl.x \
		 gcc/fixinc/inclhack.sh \
		 gcc/fixinc/fixincl.sh; \
d212 18
a229 1
CONFIGURE_ENV=CFLAGS=-O2
d231 1
a231 1
--verbose --program-transform-name=s,^,e,
d249 1
@


1.6
log
@Update to snapshot 981130.
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.5 1998/11/25 00:54:02 espie Exp $
d26 3
a28 1
ONLY_FOR_ARCHS = i386 sparc
d52 1
a52 1
LATEST_DATE=1998-11-22
d58 4
a61 2
NEXT_DATE=1998-11-30
PATCH_DEBUG=yes
@


1.5
log
@Moving stuff around, now that we have a better Makefile.
More configurability, newer snapshot, and killed gnu-make
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.4 1998/11/17 17:39:33 espie Exp $
d15 5
a19 1
BUILD_DEPENDS=	autoconf:${PORTSDIR}/devel/autoconf
d56 2
a57 2
#NEXT_DATE=1998-11-22
#PATCH_DEBUG=yes
a182 2
PATCH_LIST+=

d185 2
d192 24
d254 1
d256 1
a256 1
	cd ${WRKSRC}/gcc && autoconf
d307 1
a307 1
	m4 ${M4FLAGS} -DARCH=`${WRKDIR}/source/config.guess` \
@


1.4
log
@Clean Makefile up, mv patches around for conditional inclusion,
add beginning of m68k config.
@
text
@d2 1
a2 1
# Version required:	snapshot 1998-11-09
d6 1
a6 1
# $OpenBSD: Makefile,v 1.3 1998/11/16 21:11:13 espie Exp $
d21 2
a22 1
ONLY_FOR_ARCHS = i386
d28 3
d34 3
d38 3
d42 2
a43 2
# these are broken, as of 1998-11-09
MAKE_CHILL=yes
a44 3
# java archive is truncated, objc too
#MAKE_OBJC=yes
#MAKE_JAVA=yes
d46 1
a46 2

LATEST_DATE=1998-11-09
d52 1
a52 1
# NEXT_DATE=1998-11-20
d73 4
d108 2
d119 4
d148 1
a160 2
# this rigmarole is needed as all patches DON'T necessarily apply 
# to every configuration
d162 1
a162 4
pre-patch:
	-${RM} -f ${PATCHDIR}/*
	-${MKDIR} ${PATCHDIR}
	${CP} ${FILESDIR}/patches/patch-core-* ${PATCHDIR}
d164 13
a176 1
	${CP} ${FILESDIR}/patches/patch-g++-* ${PATCHDIR}
d179 2
d186 1
a186 1
	-${RM} -rf ${WRKSRC}/gcc/ch
a190 1
GNU_CONFIGURE=	yes
d196 1
a196 1
# This should not be used for regular releases, but if you're on this
d198 3
d224 1
a224 1
# rebuild configure file after patching, then move file around !!!
a225 1
# + kludge to build in a separate directory.
d227 1
a227 1
#	cd ${WRKSRC}/gcc && autoconf
d234 2
a235 1
# should work without gmake. If it turns out to be needed, this is a bug
d239 1
a239 1
# use bootstrap-lean if you don't have room.
d242 7
d255 2
d261 2
a262 2
.if defined(MAKE_G77)
M4FLAGS+= -DG77
d267 1
a267 1
.if defined(OBJC)
d270 3
d280 1
a280 4
	<${FILESDIR}/PLIST.template >${PKGDIR}/PLIST

pre-clean:
	-${RM} ${PKGDIR}/PLIST ${PATCHDIR}/*
@


1.3
log
@Update to recent snapshot, make it more configurable too
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.2 1998/10/02 18:57:28 espie Exp $
d8 14
d23 1
a23 2
# This is a configuration file for egcs, recent snapshot
# right now, we only configure i386, C and C++.
a24 1
# user configuration
d26 1
a29 1
MAKE_OBJC=yes
d32 5
a36 2
# these are broken, as of this snapshot...
#MAKE_CHILL=yes
d39 8
a47 1
# this configuration allow for ONE level of diff-files
d49 1
a49 1
LATEST=19981109
d51 2
a52 1
.if defined(NEXT)
a56 3
CATEGORIES=	lang 
MAINTAINER=	Marc.Espie@@openbsd.org

d98 2
d103 3
d135 19
a153 1
# to do: check egcs-stable mirror list for sites which carry snapshots
d155 7
a162 1
BUILD_DEPENDS=	autoconf:${PORTSDIR}/devel/autoconf
a163 2
# will improve over time as more and more architectures are handled
ONLY_FOR_ARCHS = i386
a165 5
USE_GMAKE= yes

# don't make bootstrap if you're impatient/you know what you're doing
# use bootstrap-lean if you don't have room.
ALL_TARGET=bootstrap
d167 6
d177 2
a178 2
--verbose --with-gnu-ld --with-gnu-as \
--program-transform-name=s,^,e,
d180 4
a183 2
.if (${MACHINE_ARCH} != "alpha")
CONFIGURE_ARGS+=--enable-shared
d186 5
d192 2
a193 3
.if defined(NEXT)
post-extract:
	mv ${WRKDIR}/egcs-${LATEST} ${WRKSRC}
a195 5
# get openbsd configuration files where they should be
post-patch:
	cp -R ${FILESDIR}/config/* ${WRKSRC}
	rm -rf ${WRKSRC}/texinfo 

d200 19
a218 3
	cd ${WRKSRC}/gcc && autoconf
	mv ${WRKSRC} ${WRKDIR}/source
	mkdir ${WRKSRC}
d239 1
a239 1
	-DVERSION=`sed -e 's/.*\(egcs-[0-9.]*\) .*/\1/' <${WRKDIR}/source/gcc/version.c` \
d243 1
a243 1
	-rm ${PKGDIR}/PLIST
@


1.2
log
@Slight changes, check compilation on i386.
@
text
@d2 1
a2 1
# Version required:	snapshot 1998-09-21
d6 1
a6 1
# $OpenBSD: Makefile,v 1.1.1.1 1998/09/25 22:45:26 espie Exp $
d12 34
a45 3
LATEST=19980921
DIRECTORY=egcs/snapshots/1998-09-21/
DISTNAME=	egcs-${LATEST}
d48 5
d54 23
a76 2
# see files/tests for testing procedure
DISTFILES+=egcs-tests-${LATEST}${EXTRACT_SUFX}
a77 1
CATEGORIES=	lang 
d81 31
a111 1
MAINTAINER=	Marc.Espie@@openbsd.org
d129 1
a129 1
--verbose \
d136 6
d145 1
a145 1
	rm -rf ${WRKSRC}/texinfo ${WRKSRC}/gcc/ch
d154 25
@


1.1
log
@Initial revision
@
text
@d6 1
a6 1
# $OpenBSD$
d18 3
d27 1
a27 2
# Should be CONFIGURE_DEPENDS, if we had it
DEPENDS=  ${PORTSDIR}/devel/autoconf:${PORTSDIR}/devel/autoconf
d29 2
a30 1
ONLY_FOR_ARCHS= i386
a33 1
MAKE_ENV="CFLAGS=-O2"
d39 1
a39 2
# should remove --enable-shared for alpha
# use --enable-haifa- on some archs (alpha, sparc, pa-risc)
d41 8
a48 2
CONFIGURE_ARGS=--verbose --enable-shared --program-prefix=e
INSTALL_TARGET=	install
a50 5
post-extract:
	cp -R files/* ${WRKSRC}
	rm -rf ${WRKSRC}/texinfo

# we should change libstdc++ name so that we will get the right one
d52 2
a53 2
	
CONFIGURE_SCRIPT=../source/configure
d59 1
a59 1
	cd ${WRKSRC}/gcc && /usr/local/bin/autoconf
@


1.1.1.1
log
@recent egcs snapshot
@
text
@@
