head	1.2;
access;
symbols
	OPENBSD_4_8:1.1.0.2
	OPENBSD_4_8_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2010.08.18.10.51.55;	author robert;	state dead;
branches;
next	1.1;

1.1
date	2010.04.16.11.59.45;	author robert;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Update to 2.6.7; remove patches that were merged backed to upstream
@
text
@$OpenBSD: patch-mono_metadata_boehm-gc_c,v 1.1 2010/04/16 11:59:45 robert Exp $
--- mono/metadata/boehm-gc.c.orig	Fri Apr 16 11:24:54 2010
+++ mono/metadata/boehm-gc.c	Fri Apr 16 11:26:01 2010
@@@@ -84,6 +84,17 @@@@ mono_gc_base_init (void)
 	}
 #elif defined(HAVE_PTHREAD_GET_STACKSIZE_NP) && defined(HAVE_PTHREAD_GET_STACKADDR_NP)
 		GC_stackbottom = (char*)pthread_get_stackaddr_np (pthread_self ());
+#elif defined(__OpenBSD__)
+#  include <pthread_np.h>
+	{
+		stack_t ss;
+		int rslt;
+
+		rslt = pthread_stackseg_np(pthread_self(), &ss);
+		g_assert (rslt == 0);
+
+		GC_stackbottom = (char*)ss.ss_sp;
+	}
 #else
 	{
 		int dummy;
@


1.1
log
@Correctly calculate GC_stackbottom on OpenBSD and set the threadstack size
to a high value just like other BSD -s.
@
text
@d1 1
a1 1
$OpenBSD$
@

