head	1.5;
access;
symbols
	OPENBSD_4_7:1.4.0.2
	OPENBSD_4_7_BASE:1.4
	OPENBSD_4_6:1.1.0.4
	OPENBSD_4_6_BASE:1.1
	OPENBSD_4_5:1.1.0.2
	OPENBSD_4_5_BASE:1.1;
locks; strict;
comment	@# @;


1.5
date	2010.03.20.17.16.44;	author robert;	state dead;
branches;
next	1.4;

1.4
date	2009.09.22.17.55.23;	author ajacoutot;	state Exp;
branches;
next	1.3;

1.3
date	2009.09.22.11.19.37;	author ajacoutot;	state Exp;
branches;
next	1.2;

1.2
date	2009.09.06.07.25.27;	author ajacoutot;	state Exp;
branches;
next	1.1;

1.1
date	2009.01.21.16.06.59;	author ajacoutot;	state Exp;
branches;
next	;


desc
@@


1.5
log
@- update to the latest stable version: 2.6.3
- move to autoconf
- regen patches

ok ajacoutot@@, jasper@@
@
text
@$OpenBSD: patch-configure,v 1.4 2009/09/22 17:55:23 ajacoutot Exp $
--- configure.orig	Sat Aug 15 03:06:17 2009
+++ configure	Mon Sep 21 23:43:54 2009
@@@@ -3013,8 +3013,11 @@@@ _ACEOF
 		;;
 	*-*-*openbsd*)
 		platform_win32=no
-		CPPFLAGS="$CPPFLAGS -D_THREAD_SAFE -DGC_FREEBSD_THREADS -DPLATFORM_BSD"
-		libmono_cflags="-D_THREAD_SAFE"
+		CPPFLAGS="$CPPFLAGS -D_THREAD_SAFE -DGC_FREEBSD_THREADS -DPLATFORM_BSD -D_GNU_SOURCE -D_REENTRANT -DUSE_MMAP"
+		if test "x$disable_munmap" != "xyes"; then
+			CPPFLAGS="$CPPFLAGS -DUSE_MUNMAP"
+		fi
+		libmono_cflags="-D_THREAD_SAFE -D_REENTRANT"
 		LDFLAGS="$LDFLAGS -pthread"
 		libmono_ldflags="-pthread"
 		need_link_unlink=yes
@@@@ -22353,6 +22356,7 @@@@ cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 $ac_includes_default
+#include <sys/param.h>
 #include <$ac_header>
 _ACEOF
 rm -f conftest.$ac_objext
@@@@ -29227,13 +29231,13 @@@@ fi
 
 		;;
 		*)
-			{ echo "$as_me:$LINENO: checking for main in -lpthread" >&5
-echo $ECHO_N "checking for main in -lpthread... $ECHO_C" >&6; }
+			{ echo "$as_me:$LINENO: checking for main in -pthread" >&5
+echo $ECHO_N "checking for main in -pthread... $ECHO_C" >&6; }
 if test "${ac_cv_lib_pthread_main+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   ac_check_lib_save_LIBS=$LIBS
-LIBS="-lpthread  $LIBS"
+LIBS="-pthread  $LIBS"
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@@@ -29283,7 +29287,7 @@@@ fi
 { echo "$as_me:$LINENO: result: $ac_cv_lib_pthread_main" >&5
 echo "${ECHO_T}$ac_cv_lib_pthread_main" >&6; }
 if test $ac_cv_lib_pthread_main = yes; then
-  LIBS="$LIBS -lpthread"
+  LIBS="$LIBS -pthread"
 fi
 
 		;;
@@@@ -37294,6 +37298,7 @@@@ _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
+#include <sys/param.h>
 #include <sys/types.h>
 		 #include <sys/sysctl.h>
 		 #include <sys/proc.h>
@@@@ -37337,6 +37342,7 @@@@ _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
+#include <sys/param.h>
 #include <sys/types.h>
 		 #include <sys/sysctl.h>
 		 #include <sys/proc.h>
@@@@ -39366,7 +39372,7 @@@@ echo "${ECHO_T}$try_dev_random" >&6; }
 
 case "{$target}" in
     *-openbsd*)
-    NAME_DEV_RANDOM="/dev/srandom"
+    NAME_DEV_RANDOM="/dev/arandom"
     ;;
 
 
@@@@ -39870,8 +39876,8 @@@@ JIT_SUPPORTED=no
 INTERP_SUPPORTED=no
 LIBC="libc.so.6"
 INTL="libc.so.6"
-SQLITE="libsqlite.so.0"
-SQLITE3="libsqlite3.so.0"
+SQLITE="libsqlite.so"
+SQLITE3="libsqlite3.so"
 X11="libX11.so"
 
 sizeof_register="SIZEOF_VOID_P"
@@@@ -40163,6 +40169,15 @@@@ _ACEOF
 		ACCESS_UNALIGNED="no"
 		JIT_SUPPORTED=yes
 		jit_wanted=true
+		;;
+	arm*-openbsd*)
+		TARGET=ARM;
+		arch_target=arm;
+		ACCESS_UNALIGNED="no"
+		JIT_SUPPORTED=yes
+		jit_wanted=true
+		INTERP_SUPPORTED=no
+		interp_wanted=false
 		;;
 	s390-*-linux*)
 		TARGET=S390;
@


1.4
log
@More work into making this compile on armish.
We are up to the point where it segfaults during build as some other arches
used to in the past... so somehow, this is an improvement ;-)
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.3 2009/09/22 11:19:37 ajacoutot Exp $
@


1.3
log
@Add some patches from sthen@@ and I to help build this on arm.
Not there yet... but working on it.
No package change.
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.2 2009/09/06 07:25:27 ajacoutot Exp $
d97 4
a100 4
+		JIT_SUPPORTED=no
+		jit_wanted=no
+		INTERP_SUPPORTED=yes
+		interp_wanted=true
@


1.2
log
@Major update to mono-2.5.
While beeing a development release, this is the most stable version I
used on OpenBSD for now. Several patches are removed as they went
upstream. Thanks to jolan@@ for pointing me at this release and cooking a
couple of patches.

Fix build on powerpc and add it to ONLY_FOR_ARCHS ; slightly tested on
macppc.

A similar port was successfuly tested by jolan@@ on amd64.

no objection alek@@ (maintainer)
ok jolan@@ ok jasper@@
@
text
@d1 3
a3 3
$OpenBSD: patch-configure,v 1.1 2009/01/21 16:06:59 ajacoutot Exp $
--- configure.orig	Wed Aug 19 19:39:29 2009
+++ configure	Tue Sep  1 14:43:13 2009
d88 16
@


1.1
log
@- use FAKE_FLAGS instead of the post-install danse; install more @@sample
files in the process
- link with -pthread, not -lpthread
@
text
@d1 26
a26 4
$OpenBSD$
--- configure.orig	Wed Jan 21 15:49:57 2009
+++ configure	Wed Jan 21 15:50:25 2009
@@@@ -29044,13 +29044,13 @@@@ fi
d43 1
a43 1
@@@@ -29100,7 +29100,7 @@@@ fi
d52 36
@

