head	1.11;
access;
symbols
	OPENBSD_5_9:1.10.0.2
	OPENBSD_5_9_BASE:1.10
	OPENBSD_5_8:1.8.0.6
	OPENBSD_5_8_BASE:1.8
	OPENBSD_5_7:1.8.0.2
	OPENBSD_5_7_BASE:1.8
	OPENBSD_5_6:1.6.0.2
	OPENBSD_5_6_BASE:1.6
	OPENBSD_5_5:1.5.0.10
	OPENBSD_5_5_BASE:1.5
	OPENBSD_5_4:1.5.0.8
	OPENBSD_5_4_BASE:1.5
	OPENBSD_5_3:1.5.0.6
	OPENBSD_5_3_BASE:1.5
	OPENBSD_5_2:1.5.0.4
	OPENBSD_5_2_BASE:1.5
	OPENBSD_5_1_BASE:1.5
	OPENBSD_5_1:1.5.0.2
	OPENBSD_5_0:1.4.0.2
	OPENBSD_5_0_BASE:1.4
	OPENBSD_4_9:1.3.0.2
	OPENBSD_4_9_BASE:1.3
	OPENBSD_4_6:1.1.0.4
	OPENBSD_4_6_BASE:1.1
	OPENBSD_4_5:1.1.0.2
	OPENBSD_4_5_BASE:1.1;
locks; strict;
comment	@# @;


1.11
date	2016.06.26.10.40.28;	author robert;	state dead;
branches;
next	1.10;
commitid	YqBeENcK7ZoJnmmW;

1.10
date	2015.12.15.15.32.04;	author robert;	state Exp;
branches;
next	1.9;
commitid	b3qz3HfheGXwtFx4;

1.9
date	2015.10.03.11.53.44;	author robert;	state Exp;
branches;
next	1.8;
commitid	Qu7fVLbJQ0CAaeEB;

1.8
date	2015.01.17.12.24.25;	author robert;	state Exp;
branches;
next	1.7;
commitid	g3IxNsPpT9D7c8OV;

1.7
date	2014.12.29.10.49.12;	author robert;	state Exp;
branches;
next	1.6;
commitid	sXBuhXfgcPHWPwW0;

1.6
date	2014.07.09.11.39.17;	author robert;	state Exp;
branches;
next	1.5;
commitid	rfOnxOCfdtnXRGha;

1.5
date	2011.11.03.09.55.12;	author ajacoutot;	state Exp;
branches;
next	1.4;

1.4
date	2011.03.02.08.37.51;	author robert;	state Exp;
branches;
next	1.3;

1.3
date	2010.08.18.10.51.55;	author robert;	state Exp;
branches;
next	1.2;

1.2
date	2009.09.06.07.25.27;	author ajacoutot;	state dead;
branches;
next	1.1;

1.1
date	2008.10.15.21.33.25;	author robert;	state Exp;
branches;
next	;


desc
@@


1.11
log
@update to 4.4.0.182
@
text
@$OpenBSD: patch-mono_metadata_class_c,v 1.10 2015/12/15 15:32:04 robert Exp $
--- mono/metadata/class.c.orig	Thu Nov 12 10:00:29 2015
+++ mono/metadata/class.c	Sun Dec 13 18:11:19 2015
@@@@ -1954,7 +1954,9 @@@@ mono_class_layout_fields (MonoClass *class)
 					field->offset &= ~(align - 1);
 				}
 				/*TypeBuilders produce all sort of weird things*/
-				g_assert (image_is_dynamic (class->image) || field->offset > 0);
+				/*can't have this assert on 2.6 since its SRE has much more trouble handl
+				 * ing inflated types in SRE context.*/
+				/*g_assert (image_is_dynamic (class->image) || field->offset > 0);*/
 				real_size = field->offset + size;
 			}
 
@


1.10
log
@update to 4.2.1.102; tested by and ok ajacoutot@@
@
text
@d1 1
a1 1
$OpenBSD: patch-mono_metadata_class_c,v 1.9 2015/10/03 11:53:44 robert Exp $
@


1.9
log
@update to mono-4.0.4.1 and introduce the MODMONO_GMCS_COMPAT flag
in the mono module because upstream has merged all the compilers
into mcs
@
text
@d1 4
a4 4
$OpenBSD: patch-mono_metadata_class_c,v 1.8 2015/01/17 12:24:25 robert Exp $
--- mono/metadata/class.c.orig	Wed Aug 26 00:09:13 2015
+++ mono/metadata/class.c	Sat Sep 26 19:00:06 2015
@@@@ -1934,7 +1934,9 @@@@ mono_class_layout_fields (MonoClass *class)
@


1.8
log
@update to 3.12.0
@
text
@d1 4
a4 4
$OpenBSD: patch-mono_metadata_class_c,v 1.7 2014/12/29 10:49:12 robert Exp $
--- mono/metadata/class.c.orig	Mon Jan 12 18:15:08 2015
+++ mono/metadata/class.c	Sat Jan 17 12:34:41 2015
@@@@ -1931,7 +1931,9 @@@@ mono_class_layout_fields (MonoClass *class)
@


1.7
log
@update to 3.10.0
@
text
@d1 4
a4 4
$OpenBSD$
--- mono/metadata/class.c.orig	Sun Dec 28 16:26:02 2014
+++ mono/metadata/class.c	Sun Dec 28 16:26:29 2014
@@@@ -1895,7 +1895,9 @@@@ mono_class_layout_fields (MonoClass *class)
@


1.6
log
@update to mono-3.4.0
@
text
@d1 4
a4 4
$OpenBSD: patch-mono_metadata_class_c,v 1.5 2011/11/03 09:55:12 ajacoutot Exp $
--- mono/metadata/class.c.orig	Mon Mar 31 22:25:10 2014
+++ mono/metadata/class.c	Tue Jul  8 10:25:55 2014
@@@@ -1894,7 +1894,8 @@@@ mono_class_layout_fields (MonoClass *class)
d8 4
a11 3
-				g_assert (class->image->dynamic || field->offset > 0);
+				/*can't have this assert on 2.6 since its SRE has much more trouble handling inflated types in SRE context.*/
+				/*g_assert (class->image->dynamic || field->offset > 0);*/
@


1.5
log
@Fix prefix/exec_prefix in pkgconfig files.
spotted by Vadim Zhukov

Regen patches while here.
@
text
@d1 4
a4 4
$OpenBSD: patch-mono_metadata_class_c,v 1.4 2011/03/02 08:37:51 robert Exp $
--- mono/metadata/class.c.orig	Tue Aug 23 02:10:06 2011
+++ mono/metadata/class.c	Thu Nov  3 08:54:45 2011
@@@@ -1736,7 +1736,8 @@@@ mono_class_layout_fields (MonoClass *class)
@


1.4
log
@update to 2.10.1
@
text
@d1 4
a4 4
$OpenBSD: patch-mono_metadata_class_c,v 1.3 2010/08/18 10:51:55 robert Exp $
--- mono/metadata/class.c.orig	Wed Feb 23 20:21:01 2011
+++ mono/metadata/class.c	Sun Feb 27 14:15:30 2011
@@@@ -1721,7 +1721,8 @@@@ mono_class_layout_fields (MonoClass *class)
@


1.3
log
@Update to 2.6.7; remove patches that were merged backed to upstream
@
text
@d1 4
a4 4
$OpenBSD$
--- mono/metadata/class.c.orig	Wed Aug 18 10:21:01 2010
+++ mono/metadata/class.c	Wed Aug 18 10:21:14 2010
@@@@ -1722,7 +1722,8 @@@@ mono_class_layout_fields (MonoClass *class)
@


1.2
log
@Major update to mono-2.5.
While beeing a development release, this is the most stable version I
used on OpenBSD for now. Several patches are removed as they went
upstream. Thanks to jolan@@ for pointing me at this release and cooking a
couple of patches.

Fix build on powerpc and add it to ONLY_FOR_ARCHS ; slightly tested on
macppc.

A similar port was successfuly tested by jolan@@ on amd64.

no objection alek@@ (maintainer)
ok jolan@@ ok jasper@@
@
text
@d1 13
a13 15
$OpenBSD: patch-mono_metadata_class_c,v 1.1 2008/10/15 21:33:25 robert Exp $
--- mono/metadata/class.c.orig	Wed Oct 15 22:15:14 2008
+++ mono/metadata/class.c	Wed Oct 15 22:39:45 2008
@@@@ -7445,7 +7445,10 @@@@ mono_generic_class_is_generic_type_definition (MonoGen
 gboolean
 mono_class_generic_sharing_enabled (MonoClass *class)
 {
-#if defined(__i386__) || defined(__x86_64__)
+#if (defined(__NetBSD__) || defined(__OpenBSD__)) && defined(__x86_64__)
+/* https://bugzilla.novell.com/show_bug.cgi?id=434457 */
+	static gboolean supported = FALSE;
+#elif defined(__i386__) || defined(__x86_64__)
 	static gboolean supported = TRUE;
 #else
 	/* Not supported by the JIT backends */
@


1.1
log
@we don't have MAP_32BIT on amd64 so don't use it and disable generic
code sharing; makes mono work on amd64
@
text
@d1 1
a1 1
$OpenBSD$
@

