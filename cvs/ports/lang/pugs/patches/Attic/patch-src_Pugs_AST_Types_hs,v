head	1.2;
access;
symbols
	OPENBSD_5_3:1.1.0.10
	OPENBSD_5_3_BASE:1.1
	OPENBSD_5_2:1.1.0.8
	OPENBSD_5_2_BASE:1.1
	OPENBSD_5_1_BASE:1.1
	OPENBSD_5_1:1.1.0.6
	OPENBSD_5_0:1.1.0.4
	OPENBSD_5_0_BASE:1.1
	OPENBSD_4_9:1.1.0.2
	OPENBSD_4_9_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2013.07.19.07.08.22;	author kili;	state dead;
branches;
next	1.1;

1.1
date	2010.09.14.18.58.01;	author kili;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Update to Pugs-6.2.13.20130611 (no longer marked as broken).
@
text
@$OpenBSD: patch-src_Pugs_AST_Types_hs,v 1.1 2010/09/14 18:58:01 kili Exp $
--- src/Pugs/AST/Types.hs.orig	Wed Dec 16 15:02:44 2009
+++ src/Pugs/AST/Types.hs	Tue Sep 14 20:37:46 2010
@@@@ -21,7 +21,11 @@@@ data VThread = MkThread
     { threadId      :: ThreadId
     , threadLock    :: TMVar Val
     }
-    deriving (Show, Eq, Ord, Typeable)
+    deriving (Show, Ord, Typeable)
+
+instance Eq VThread where
+    v == w = threadId v == threadId w &&
+             addressOf (threadLock v) == addressOf (threadLock w)
 
 data VSubst
     = MkSubst
@


1.1
log
@Pugs.Types defined an Eq instance for Control.Concurrent.STM.TMVar (from
the stm package), which is no longer possible, because TMVar is deriving
Eq now. So move the (somewhat crude)  comparision based on addressOf (which
comes from the hs-pugs-compat package) into Pugs.AST.Types, providing an
explicit Eq instance for VThread.

IMHO, instance declarations for standard type classes on types imported
from other Haskell packages are evil.

Breakage noticed by naddy@@.

While here, update WANTLIB and bump.
@
text
@d1 1
a1 1
$OpenBSD$
@

