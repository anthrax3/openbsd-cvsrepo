head	1.3;
access;
symbols
	OPENBSD_6_0:1.2.0.12
	OPENBSD_6_0_BASE:1.2
	OPENBSD_5_9:1.2.0.8
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.2.0.10
	OPENBSD_5_8_BASE:1.2
	OPENBSD_5_7:1.2.0.6
	OPENBSD_5_7_BASE:1.2
	OPENBSD_5_6:1.2.0.4
	OPENBSD_5_6_BASE:1.2
	OPENBSD_5_5:1.2.0.2
	OPENBSD_5_5_BASE:1.2
	OPENBSD_5_4:1.1.0.2
	OPENBSD_5_4_BASE:1.1;
locks; strict;
comment	@# @;


1.3
date	2016.10.31.12.02.49;	author jeremy;	state dead;
branches;
next	1.2;
commitid	pPsbAZN3VgmbxJ7Y;

1.2
date	2014.01.21.10.06.07;	author jasper;	state Exp;
branches;
next	1.1;

1.1
date	2013.05.17.20.11.43;	author jeremy;	state Exp;
branches;
next	;


desc
@@


1.3
log
@Send ruby 2.0 to the Attic

It was unhooked from the build back in September.
@
text
@$OpenBSD: patch-lib_rubygems_ext_ext_conf_builder_rb,v 1.2 2014/01/21 10:06:07 jasper Exp $

Ugly hack to make --user-install option work.  Without this, when
a user uses gem install --user-install, it calls
/usr/bin/install -o root -g bin, which fails due to permission issues.
This removes the -o root -g bin, so it can succeed as a regular user.

--- lib/rubygems/ext/ext_conf_builder.rb.orig	Thu Jul 25 17:42:22 2013
+++ lib/rubygems/ext/ext_conf_builder.rb	Tue Jan 21 09:54:37 2014
@@@@ -24,6 +24,11 @@@@ class Gem::Ext::ExtConfBuilder < Gem::Ext::Builder
         siteconf.puts "RbConfig::MAKEFILE_CONFIG['#{dir}'] = dest_path"
         siteconf.puts "RbConfig::CONFIG['#{dir}'] = dest_path"
       end
+      unless Process.euid == 0
+        %w[INSTALL INSTALL_DATA INSTALL_SCRIPT INSTALL_PROGRAM].each do |ins|
+          siteconf.puts "RbConfig::MAKEFILE_CONFIG['#{ins}'] = RbConfig::CONFIG['#{ins}'] = RbConfig::CONFIG['#{ins}'].gsub(/-o root -g bin/, '')"
+        end
+      end
 
       siteconf.flush
 
@


1.2
log
@regen
@
text
@d1 1
a1 1
$OpenBSD: patch-lib_rubygems_ext_ext_conf_builder_rb,v 1.1 2013/05/17 20:11:43 jeremy Exp $
@


1.1
log
@Update to ruby 2.0.0-p195, with a security fix for CVE-2013-2065
and other significant bugfixes for new features introduced in
ruby 2.0, plus some miscellaneous bugfixes.

This includes an update to the embedded rubygems, which changes
how native extension gems are built, so update the patch to
ensure --user-install continues to work as a regular user with
such gems.
@
text
@d1 1
a1 1
$OpenBSD$
d8 3
a10 3
--- lib/rubygems/ext/ext_conf_builder.rb.orig	Tue May 14 09:03:40 2013
+++ lib/rubygems/ext/ext_conf_builder.rb	Tue May 14 09:06:11 2013
@@@@ -22,6 +22,11 @@@@ class Gem::Ext::ExtConfBuilder < Gem::Ext::Builder
@

