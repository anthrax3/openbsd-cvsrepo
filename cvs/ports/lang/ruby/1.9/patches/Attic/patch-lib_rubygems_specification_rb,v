head	1.2;
access;
symbols
	OPENBSD_5_8:1.1.0.8
	OPENBSD_5_8_BASE:1.1
	OPENBSD_5_7:1.1.0.4
	OPENBSD_5_7_BASE:1.1
	OPENBSD_5_6:1.1.0.2
	OPENBSD_5_6_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2015.08.29.16.25.39;	author jeremy;	state dead;
branches;
next	1.1;
commitid	WYYJd508S3pt2o6T;

1.1
date	2014.06.25.15.38.39;	author jeremy;	state Exp;
branches;
next	;
commitid	YlfEcXPhXr6QxoVQ;


desc
@@


1.2
log
@Send lang/ruby/1.9 to the Attic, now that we are no longer building
extension libraries for ruby 2.0 by default.

OK jasper@@
@
text
@$OpenBSD: patch-lib_rubygems_specification_rb,v 1.1 2014/06/25 15:38:39 jeremy Exp $

Backport fix for Gem.refresh from upstream commit
b61c621fb2e00e215bcc8ad7d9fe45433881da14.

--- lib/rubygems/specification.rb.orig	Tue Jun 24 14:21:46 2014
+++ lib/rubygems/specification.rb	Tue Jun 24 14:21:52 2014
@@@@ -275,6 +275,12 @@@@ class Gem::Specification
 
       @@@@all = specs.values
 
+      # After a reset, make sure already loaded specs
+      # are still marked as activated.
+      specs = {}
+      Gem.loaded_specs.each_value{|s| specs[s] = true}
+      @@@@all.each{|s| s.activated = true if specs[s]}
+
       _resort!
     end
     @@@@all
@


1.1
log
@Backport an upstream rubygems patch fixing issues with Gem.refresh.

OK ajacoutot@@
@
text
@d1 1
a1 1
$OpenBSD$
@

