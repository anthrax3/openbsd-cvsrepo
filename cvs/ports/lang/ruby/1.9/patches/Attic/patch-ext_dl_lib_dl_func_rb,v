head	1.1;
access;
symbols
	OPENBSD_5_3:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2013.05.20.20.14.29;	author jeremy;	state dead;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2013.05.20.20.14.29;	author jeremy;	state Exp;
branches;
next	;


desc
@@


1.1
log
@file patch-ext_dl_lib_dl_func_rb was initially added on branch OPENBSD_5_3.
@
text
@@


1.1.2.1
log
@Add fix for CVE-2013-2065: Object taint bypassing in DL and Fiddle

Requested by jasper@@
@
text
@a0 16
$OpenBSD$

Fix CVE-2013-2065.

--- ext/dl/lib/dl/func.rb.orig	Thu Dec 20 01:52:46 2012
+++ ext/dl/lib/dl/func.rb	Mon May 20 05:54:19 2013
@@@@ -92,6 +92,9 @@@@ module DL
         super
       else
         funcs = []
+        if $SAFE >= 1 && args.any? { |x| x.tainted? }
+          raise SecurityError, "tainted parameter not allowed"
+        end
         _args = wrap_args(args, @@stack.types, funcs, &block)
         r = @@cfunc.call(@@stack.pack(_args))
         funcs.each{|f| f.unbind_at_call()}
@

