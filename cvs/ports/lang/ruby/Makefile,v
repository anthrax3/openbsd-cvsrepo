head	1.86;
access;
symbols
	OPENBSD_6_0:1.84.0.4
	OPENBSD_6_0_BASE:1.84
	OPENBSD_5_9:1.84.0.2
	OPENBSD_5_9_BASE:1.84
	OPENBSD_5_8:1.82.0.6
	OPENBSD_5_8_BASE:1.82
	OPENBSD_5_7:1.82.0.2
	OPENBSD_5_7_BASE:1.82
	OPENBSD_5_6:1.81.0.4
	OPENBSD_5_6_BASE:1.81
	OPENBSD_5_5:1.81.0.2
	OPENBSD_5_5_BASE:1.81
	OPENBSD_5_4:1.80.0.2
	OPENBSD_5_4_BASE:1.80
	OPENBSD_5_3:1.79.0.10
	OPENBSD_5_3_BASE:1.79
	OPENBSD_5_2:1.79.0.8
	OPENBSD_5_2_BASE:1.79
	OPENBSD_5_1_BASE:1.79
	OPENBSD_5_1:1.79.0.6
	OPENBSD_5_0:1.79.0.4
	OPENBSD_5_0_BASE:1.79
	OPENBSD_4_9:1.79.0.2
	OPENBSD_4_9_BASE:1.79
	OPENBSD_4_8:1.77.0.2
	OPENBSD_4_8_BASE:1.77
	OPENBSD_4_7:1.74.0.2
	OPENBSD_4_7_BASE:1.74
	OPENBSD_4_6:1.72.0.2
	OPENBSD_4_6_BASE:1.72
	OPENBSD_4_5:1.66.0.2
	OPENBSD_4_5_BASE:1.66
	OPENBSD_4_4:1.62.0.2
	OPENBSD_4_4_BASE:1.62
	OPENBSD_4_3:1.58.0.2
	OPENBSD_4_3_BASE:1.58
	OPENBSD_4_2:1.55.0.2
	OPENBSD_4_2_BASE:1.55
	OPENBSD_4_1:1.54.0.2
	OPENBSD_4_1_BASE:1.54
	OPENBSD_4_0:1.41.0.2
	OPENBSD_4_0_BASE:1.41
	OPENBSD_3_9:1.36.0.2
	OPENBSD_3_9_BASE:1.36
	OPENBSD_3_8:1.31.0.2
	OPENBSD_3_8_BASE:1.31
	OPENBSD_3_7:1.30.0.2
	OPENBSD_3_7_BASE:1.30
	OPENBSD_3_6:1.29.0.2
	OPENBSD_3_6_BASE:1.29
	OPENBSD_3_5:1.27.0.2
	OPENBSD_3_5_BASE:1.27
	OPENBSD_3_4:1.25.0.4
	OPENBSD_3_4_BASE:1.25
	OPENBSD_3_3:1.25.0.2
	OPENBSD_3_3_BASE:1.25
	OPENBSD_3_2:1.23.0.2
	OPENBSD_3_2_BASE:1.23
	OPENBSD_3_1:1.20.0.2
	OPENBSD_3_1_BASE:1.20
	OPENBSD_3_0:1.13.0.2
	OPENBSD_3_0_BASE:1.13
	OPENBSD_2_9_TRACKING_SWITCH:1.13
	OPENBSD_2_9:1.12.0.2
	OPENBSD_2_9_BASE:1.12
	OPENBSD_2_8:1.8.0.2
	OPENBSD_2_8_BASE:1.8
	OPENBSD_2_7:1.1.1.1.0.2
	OPENBSD_2_7_BASE:1.1.1.1
	ruby_1_4_3:1.1.1.1
	ruby:1.1.1;
locks; strict;
comment	@# @;


1.86
date	2017.01.06.16.00.21;	author jeremy;	state Exp;
branches;
next	1.85;
commitid	XxyeqLsKqLrK59N4;

1.85
date	2016.09.06.15.38.41;	author jeremy;	state Exp;
branches;
next	1.84;
commitid	kvuGc6TrftTlKSCS;

1.84
date	2016.01.07.00.53.23;	author jeremy;	state Exp;
branches;
next	1.83;
commitid	vvzPMA4CEb2UkVVW;

1.83
date	2015.08.29.16.25.39;	author jeremy;	state Exp;
branches;
next	1.82;
commitid	WYYJd508S3pt2o6T;

1.82
date	2015.01.08.18.49.20;	author jeremy;	state Exp;
branches;
next	1.81;
commitid	HoNTgKJcFUSOoErR;

1.81
date	2014.01.03.17.53.38;	author jeremy;	state Exp;
branches;
next	1.80;

1.80
date	2013.03.19.23.39.10;	author jeremy;	state Exp;
branches;
next	1.79;

1.79
date	2010.09.23.21.58.50;	author jeremy;	state Exp;
branches;
next	1.78;

1.78
date	2010.09.14.12.03.42;	author jasper;	state Exp;
branches;
next	1.77;

1.77
date	2010.07.24.23.05.08;	author naddy;	state Exp;
branches
	1.77.2.1;
next	1.76;

1.76
date	2010.05.03.17.01.33;	author jcs;	state Exp;
branches;
next	1.75;

1.75
date	2010.04.15.14.11.01;	author ajacoutot;	state Exp;
branches;
next	1.74;

1.74
date	2010.01.27.21.43.28;	author naddy;	state Exp;
branches
	1.74.2.1;
next	1.73;

1.73
date	2009.08.10.17.31.07;	author kili;	state Exp;
branches;
next	1.72;

1.72
date	2009.06.22.17.00.23;	author naddy;	state Exp;
branches;
next	1.71;

1.71
date	2009.06.16.09.12.44;	author bernd;	state Exp;
branches;
next	1.70;

1.70
date	2009.04.27.10.54.09;	author bernd;	state Exp;
branches;
next	1.69;

1.69
date	2009.03.23.00.35.44;	author jakemsr;	state Exp;
branches;
next	1.68;

1.68
date	2009.03.09.17.54.21;	author espie;	state Exp;
branches;
next	1.67;

1.67
date	2009.03.07.12.30.17;	author bernd;	state Exp;
branches;
next	1.66;

1.66
date	2009.02.09.20.48.23;	author naddy;	state Exp;
branches
	1.66.2.1;
next	1.65;

1.65
date	2009.02.03.21.15.28;	author bernd;	state Exp;
branches;
next	1.64;

1.64
date	2009.01.31.09.54.31;	author bernd;	state Exp;
branches;
next	1.63;

1.63
date	2008.09.28.15.43.05;	author bernd;	state Exp;
branches;
next	1.62;

1.62
date	2008.07.25.20.25.59;	author sthen;	state Exp;
branches;
next	1.61;

1.61
date	2008.07.21.09.40.42;	author bernd;	state Exp;
branches;
next	1.60;

1.60
date	2008.07.04.19.57.06;	author naddy;	state Exp;
branches;
next	1.59;

1.59
date	2008.03.29.12.05.27;	author bernd;	state Exp;
branches;
next	1.58;

1.58
date	2008.02.22.19.16.49;	author naddy;	state Exp;
branches
	1.58.2.1;
next	1.57;

1.57
date	2007.12.27.18.32.32;	author bernd;	state Exp;
branches;
next	1.56;

1.56
date	2007.09.16.00.27.06;	author merdely;	state Exp;
branches;
next	1.55;

1.55
date	2007.07.27.19.17.11;	author naddy;	state Exp;
branches;
next	1.54;

1.54
date	2007.02.13.23.47.13;	author espie;	state Exp;
branches;
next	1.53;

1.53
date	2007.01.11.09.34.40;	author bernd;	state Exp;
branches;
next	1.52;

1.52
date	2006.12.31.01.04.09;	author msf;	state Exp;
branches;
next	1.51;

1.51
date	2006.12.04.13.26.51;	author bernd;	state Exp;
branches;
next	1.50;

1.50
date	2006.11.27.09.52.52;	author bernd;	state Exp;
branches;
next	1.49;

1.49
date	2006.11.24.09.45.08;	author bernd;	state Exp;
branches;
next	1.48;

1.48
date	2006.11.19.11.54.44;	author msf;	state Exp;
branches;
next	1.47;

1.47
date	2006.11.02.12.46.13;	author bernd;	state Exp;
branches;
next	1.46;

1.46
date	2006.10.26.18.15.24;	author bernd;	state Exp;
branches;
next	1.45;

1.45
date	2006.10.26.17.57.16;	author bernd;	state Exp;
branches;
next	1.44;

1.44
date	2006.10.22.08.45.39;	author steven;	state Exp;
branches;
next	1.43;

1.43
date	2006.10.19.01.03.17;	author bernd;	state Exp;
branches;
next	1.42;

1.42
date	2006.10.02.07.48.08;	author bernd;	state Exp;
branches;
next	1.41;

1.41
date	2006.08.09.22.14.11;	author bernd;	state Exp;
branches
	1.41.2.1;
next	1.40;

1.40
date	2006.08.03.13.09.09;	author espie;	state Exp;
branches;
next	1.39;

1.39
date	2006.07.28.06.29.34;	author steven;	state Exp;
branches;
next	1.38;

1.38
date	2006.07.06.08.22.20;	author bernd;	state Exp;
branches;
next	1.37;

1.37
date	2006.06.10.16.50.15;	author sturm;	state Exp;
branches;
next	1.36;

1.36
date	2006.01.22.16.30.36;	author alek;	state Exp;
branches
	1.36.2.1;
next	1.35;

1.35
date	2006.01.08.10.39.31;	author alek;	state Exp;
branches;
next	1.34;

1.34
date	2005.12.29.17.27.31;	author msf;	state Exp;
branches;
next	1.33;

1.33
date	2005.10.18.17.33.20;	author couderc;	state Exp;
branches;
next	1.32;

1.32
date	2005.09.04.23.31.07;	author espie;	state Exp;
branches;
next	1.31;

1.31
date	2005.06.30.22.37.12;	author robert;	state Exp;
branches;
next	1.30;

1.30
date	2005.02.24.13.20.41;	author alek;	state Exp;
branches
	1.30.2.1;
next	1.29;

1.29
date	2004.08.23.08.43.16;	author espie;	state Exp;
branches
	1.29.2.1;
next	1.28;

1.28
date	2004.06.23.14.17.05;	author naddy;	state Exp;
branches;
next	1.27;

1.27
date	2004.02.20.22.52.57;	author couderc;	state Exp;
branches
	1.27.2.1;
next	1.26;

1.26
date	2003.12.27.23.40.35;	author jose;	state Exp;
branches;
next	1.25;

1.25
date	2002.12.26.15.48.22;	author couderc;	state Exp;
branches
	1.25.4.1;
next	1.24;

1.24
date	2002.10.27.14.10.23;	author naddy;	state Exp;
branches;
next	1.23;

1.23
date	2002.09.20.14.58.38;	author couderc;	state Exp;
branches;
next	1.22;

1.22
date	2002.07.03.16.31.28;	author couderc;	state Exp;
branches;
next	1.21;

1.21
date	2002.06.29.13.39.26;	author couderc;	state Exp;
branches;
next	1.20;

1.20
date	2002.03.24.22.38.50;	author brad;	state Exp;
branches;
next	1.19;

1.19
date	2002.03.16.01.03.56;	author krw;	state Exp;
branches;
next	1.18;

1.18
date	2002.03.06.18.59.21;	author lebel;	state Exp;
branches;
next	1.17;

1.17
date	2002.02.21.00.48.11;	author krw;	state Exp;
branches;
next	1.16;

1.16
date	2001.10.29.23.01.07;	author krw;	state Exp;
branches;
next	1.15;

1.15
date	2001.10.26.01.25.05;	author krw;	state Exp;
branches;
next	1.14;

1.14
date	2001.10.26.00.35.51;	author krw;	state Exp;
branches;
next	1.13;

1.13
date	2001.07.03.06.34.53;	author jsyn;	state Exp;
branches;
next	1.12;

1.12
date	2001.03.23.14.12.32;	author espie;	state Exp;
branches;
next	1.11;

1.11
date	2001.02.21.17.17.17;	author espie;	state Exp;
branches;
next	1.10;

1.10
date	2001.01.08.21.36.42;	author espie;	state Exp;
branches;
next	1.9;

1.9
date	2001.01.05.16.35.59;	author brad;	state Exp;
branches;
next	1.8;

1.8
date	2000.10.22.15.42.30;	author espie;	state Exp;
branches;
next	1.7;

1.7
date	2000.10.10.00.40.48;	author espie;	state Exp;
branches;
next	1.6;

1.6
date	2000.09.05.13.56.24;	author espie;	state Exp;
branches;
next	1.5;

1.5
date	2000.08.16.18.54.48;	author espie;	state Exp;
branches;
next	1.4;

1.4
date	2000.07.04.13.47.55;	author espie;	state Exp;
branches;
next	1.3;

1.3
date	2000.06.28.13.51.24;	author espie;	state Exp;
branches;
next	1.2;

1.2
date	2000.05.18.18.37.59;	author espie;	state Exp;
branches;
next	1.1;

1.1
date	2000.03.28.13.16.02;	author espie;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2000.03.28.13.16.02;	author espie;	state Exp;
branches
	1.1.1.1.2.1;
next	;

1.1.1.1.2.1
date	2000.09.15.04.55.45;	author marc;	state Exp;
branches;
next	;

1.25.4.1
date	2004.08.18.00.03.59;	author robert;	state Exp;
branches;
next	;

1.27.2.1
date	2004.08.18.00.03.02;	author robert;	state Exp;
branches;
next	;

1.29.2.1
date	2005.07.01.11.39.57;	author robert;	state Exp;
branches;
next	;

1.30.2.1
date	2005.07.01.11.38.53;	author robert;	state Exp;
branches;
next	;

1.36.2.1
date	2006.11.04.11.46.17;	author sturm;	state Exp;
branches;
next	1.36.2.2;

1.36.2.2
date	2006.12.05.06.05.27;	author sturm;	state Exp;
branches;
next	;

1.41.2.1
date	2006.11.04.11.09.24;	author sturm;	state Exp;
branches;
next	1.41.2.2;

1.41.2.2
date	2006.12.05.07.24.26;	author sturm;	state Exp;
branches;
next	;

1.58.2.1
date	2008.06.15.02.09.16;	author robert;	state Exp;
branches;
next	;

1.66.2.1
date	2009.06.19.02.48.23;	author william;	state Exp;
branches;
next	1.66.2.2;

1.66.2.2
date	2009.08.19.01.18.10;	author william;	state Exp;
branches;
next	;

1.74.2.1
date	2010.09.25.03.28.52;	author william;	state Exp;
branches;
next	;

1.77.2.1
date	2010.09.25.03.30.57;	author william;	state Exp;
branches;
next	;


desc
@@


1.86
log
@Hookup ruby 2.4 to the build
@
text
@# $OpenBSD: Makefile,v 1.85 2016/09/06 15:38:41 jeremy Exp $

SUBDIR =
SUBDIR += 1.8
SUBDIR += 2.1
SUBDIR += 2.2
SUBDIR += 2.3
SUBDIR += 2.4

.include <bsd.port.subdir.mk>
@


1.85
log
@Unhook ruby 2.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.84 2016/01/07 00:53:23 jeremy Exp $
d8 1
@


1.84
log
@Hookup ruby 2.3 to the build
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.83 2015/08/29 16:25:39 jeremy Exp $
a4 1
SUBDIR += 2.0
@


1.83
log
@Send lang/ruby/1.9 to the Attic, now that we are no longer building
extension libraries for ruby 2.0 by default.

OK jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.82 2015/01/08 18:49:20 jeremy Exp $
d8 1
@


1.82
log
@Hook ruby 2.2 up to the build
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.81 2014/01/03 17:53:38 jeremy Exp $
a4 1
SUBDIR += 1.9
@


1.81
log
@Hook ruby 2.1 up to the build
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.80 2013/03/19 23:39:10 jeremy Exp $
d8 1
@


1.80
log
@Link ruby 2.0 to the build.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.79 2010/09/23 21:58:50 jeremy Exp $
d7 1
@


1.79
log
@Split the lang/ruby port into separate ports for ruby 1.8 and ruby
1.9, similar to how the lang/python ports are handled.  ruby 1.8
now installs as ruby18 and ruby 1.9 installs as ruby19.  The
included MESSAGE files for both ports let you know the symlinks to
set up if you want to make that version the default system ruby.

Split port originally started by bernd@@, many changes since by me,
help and support from jcs@@, landry@@, jasper@@, and sthen@@.

This causes a large amount of fallout in dependent ruby ports,
which will be committed shortly.

OK jcs@@, landry@@, jasper@@, sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.78 2010/09/14 12:03:42 jasper Exp $
d6 1
@


1.78
log
@Apply a SECURITY FIX from upstream ruby for a WEBrick HTTP server XSS
vulnerability (CVE-2010-0541).

from TAKAHASHI Kaoru
maintainer timed-out
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.77 2010/07/24 23:05:08 naddy Exp $
d3 3
a5 1
SHARED_ONLY=		Yes
d7 1
a7 89
COMMENT-main=		object oriented script language with threads
COMMENT-iconv=		libiconv interface for ruby
COMMENT-gdbm=		gdbm interface for ruby
COMMENT-tk=		tk interface for ruby

VERSION=		1.8.6
PATCHLEVEL=		369
DISTNAME=		ruby-${VERSION}-p${PATCHLEVEL}
SHARED_LIBS=		ruby 2.0
PKGNAME-main=		ruby-${VERSION}.${PATCHLEVEL}
PKGNAME-iconv=		ruby-iconv-${VERSION}.${PATCHLEVEL}
PKGNAME-gdbm=		ruby-gdbm-${VERSION}.${PATCHLEVEL}
PKGNAME-tk=		ruby-tk-${VERSION}.${PATCHLEVEL}
REVISION-main=		4
REVISION-iconv=		4
REVISION-gdbm=		3
REVISION-tk=		4

CATEGORIES=		lang

HOMEPAGE=		http://www.ruby-lang.org/

MAINTAINER=		Bernd Ahlers <bernd@@openbsd.org>

# GPL/Artistic/BSD/Public Domain/Beer-Ware
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes

MASTER_SITES=		ftp://www.ruby-lang.org/pub/ruby/1.8/ \
                	ftp://mirror.nucba.ac.jp/pub/ruby/1.8/ \
                	ftp://ftp.kr.freebsd.org/pub/ruby/1.8/

CONFIGURE_STYLE=	gnu
CONFIGURE_ARGS=		${CONFIGURE_SHARED} \
			--enable-ipv6 \
			--with-dbm-type=bogus \
			--with-opt-dir="${LOCALBASE}"
CONFIGURE_ENV=		PREFIX="${PREFIX}" \
			LIBruby_VERSION=${LIBruby_VERSION} \
			CPPFLAGS="-DOPENSSL_NO_STATIC_ENGINE"

MODULES=		converters/libiconv

WANTLIB-main= 		c m readline termcap util crypto ncurses ssl z
LIB_DEPENDS-main=
RUN_DEPENDS-main=

PSEUDO_FLAVORS= 	no_x11
FLAVOR?=

MULTI_PACKAGES=		-main -iconv -gdbm

.if !${FLAVOR:L:Mno_x11}
USE_X11=		Yes
MULTI_PACKAGES+=	-tk
CONFIGURE_ARGS+=	--with-tcl-include=${PREFIX}/include/tcl8.5 \
			--with-tk-include=${PREFIX}/include/tk8.5 \
			--with-X11-dir=${X11BASE}
.endif

WANTLIB-iconv=		c m
LIB_DEPENDS-iconv=	ruby.>=1::lang/ruby \
			${MODLIBICONV_LIB_DEPENDS}
RUN_DEPENDS-iconv=	${MODLIBICONV_RUN_DEPENDS}

WANTLIB-gdbm=		c m
LIB_DEPENDS-gdbm=	gdbm.>=3::databases/gdbm \
			ruby.>=1::lang/ruby
RUN_DEPENDS-gdbm=

.if !${FLAVOR:L:Mno_x11}
WANTLIB-tk=		X11 c m pthread-stubs tcl85 xcb
LIB_DEPENDS-tk=		tk85:tk->=8.5,<8.6:x11/tk/8.5 \
			ruby.>=1::lang/ruby
RUN_DEPENDS-tk=
.endif

REGRESS_DEPENDS=	:${PKGNAME-main}:lang/ruby
INSTALL_TARGET=		install install-doc
REV=			1.8
SUB=			${MACHINE_ARCH:S/amd64/x86_64/}-openbsd${OSREV}
SUBST_VARS=		SUB REV

# Building the ruby documentation consumes lots of memory.
VMEM_WARNING=		Yes

.include <bsd.port.mk>
@


1.77
log
@bump PKGNAME for PLIST changes 4.7 -> 4.8
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.76 2010/05/03 17:01:33 jcs Exp $
d18 1
a18 1
REVISION-main=		3
@


1.77.2.1
log
@MFC:

SECURITY FIX

Resolves CVE-2010-0541

ok bernd@@ jeremy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.77 2010/07/24 23:05:08 naddy Exp $
d18 1
a18 1
REVISION-main=		4
@


1.76
log
@add a patch to prevent seg faulting when loading compiled modules on
amd64

bump pkgname

ok bernd@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.75 2010/04/15 14:11:01 ajacoutot Exp $
d14 8
a21 4
PKGNAME-main=		ruby-${VERSION}.${PATCHLEVEL}p2
PKGNAME-iconv=		ruby-iconv-${VERSION}.${PATCHLEVEL}p3
PKGNAME-gdbm=		ruby-gdbm-${VERSION}.${PATCHLEVEL}p2
PKGNAME-tk=		ruby-tk-${VERSION}.${PATCHLEVEL}p3
@


1.75
log
@Consistency: remove the 1, 2 or even 3 empty blank lines.

sthen@@ agrees
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.74 2010/01/27 21:43:28 naddy Exp $
d14 4
a17 4
PKGNAME-main=		ruby-${VERSION}.${PATCHLEVEL}p1
PKGNAME-iconv=		ruby-iconv-${VERSION}.${PATCHLEVEL}p2
PKGNAME-gdbm=		ruby-gdbm-${VERSION}.${PATCHLEVEL}p1
PKGNAME-tk=		ruby-tk-${VERSION}.${PATCHLEVEL}p2
@


1.74
log
@bump PKGNAME for PLIST changes 4.6 -> 4.7
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.73 2009/08/10 17:31:07 kili Exp $
d15 1
a15 1
PKGNAME-iconv=		ruby-iconv-${VERSION}.${PATCHLEVEL}p1
@


1.74.2.1
log
@MFC:

SECURITY FIX

Resolves CVE-2010-0541

ok bernd@@ jeremy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.74 2010/01/27 21:43:28 naddy Exp $
d14 1
a14 1
PKGNAME-main=		ruby-${VERSION}.${PATCHLEVEL}p2
@


1.73
log
@WANTLIB changes after xcb addition and bump.

For some unknown reason, I forgot to commit lang/*
this morning.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.72 2009/06/22 17:00:23 naddy Exp $
d14 4
a17 4
PKGNAME-main=		ruby-${VERSION}.${PATCHLEVEL}p0
PKGNAME-iconv=		ruby-iconv-${VERSION}.${PATCHLEVEL}p0
PKGNAME-gdbm=		ruby-gdbm-${VERSION}.${PATCHLEVEL}p0
PKGNAME-tk=		ruby-tk-${VERSION}.${PATCHLEVEL}p1
@


1.72
log
@bump PKGNAME for PLIST changes 4.5 -> 4.6
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.71 2009/06/16 09:12:44 bernd Exp $
d17 1
a17 1
PKGNAME-tk=		ruby-tk-${VERSION}.${PATCHLEVEL}p0
d74 1
a74 1
WANTLIB-tk=		X11 c m tcl85
@


1.71
log
@Security update to ruby-1.8.6-p369.

Fixes a denial of service vulnerability in the BigDecimal
standard library of Ruby.

http://www.ruby-lang.org/en/news/2009/06/09/dos-vulnerability-in-bigdecimal/
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.70 2009/04/27 10:54:09 bernd Exp $
d14 4
a17 4
PKGNAME-main=		ruby-${VERSION}.${PATCHLEVEL}
PKGNAME-iconv=		ruby-iconv-${VERSION}.${PATCHLEVEL}
PKGNAME-gdbm=		ruby-gdbm-${VERSION}.${PATCHLEVEL}
PKGNAME-tk=		ruby-tk-${VERSION}.${PATCHLEVEL}
@


1.70
log
@Update to ruby-1.8.6.368.

Including security fixes for CVE-2008-1447 and CVE-2007-1558.

Tested by Jeremy Evans, jcs@@, sturm@@ and msf@@. Thank you!
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.69 2009/03/23 00:35:44 jakemsr Exp $
d11 1
a11 1
PATCHLEVEL=		368
@


1.69
log
@use /dev/arandom instead of /dev/urandom.  reading from /dev/urandom is
too slow.

ok bernd@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.68 2009/03/09 17:54:21 espie Exp $
d11 1
a11 1
PATCHLEVEL=		287
d14 4
a17 4
PKGNAME-main=		ruby-${VERSION}.${PATCHLEVEL}p4
PKGNAME-iconv=		ruby-iconv-${VERSION}.${PATCHLEVEL}p0
PKGNAME-gdbm=		ruby-gdbm-${VERSION}.${PATCHLEVEL}p0
PKGNAME-tk=		ruby-tk-${VERSION}.${PATCHLEVEL}p1
@


1.68
log
@zap obsolete spec, replace tk-8.5* with tk->=8.5,<8.6
bump corresponding pkgname
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.67 2009/03/07 12:30:17 bernd Exp $
d14 1
a14 1
PKGNAME-main=		ruby-${VERSION}.${PATCHLEVEL}p3
@


1.67
log
@Bring back the fix for short-named constants.
This previous problems should be gone now.
(ruby svn r18485 and r22679)

Thanks to Jeremy Evans!
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.66 2009/02/09 20:48:23 naddy Exp $
d17 1
a17 1
PKGNAME-tk=		ruby-tk-${VERSION}.${PATCHLEVEL}p0
d75 1
a75 1
LIB_DEPENDS-tk=		tk85:tk-8.5.*:x11/tk/8.5 \
@


1.66
log
@bump PKGNAME for PLIST changes 4.4 -> 4.5
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.65 2009/02/03 21:15:28 bernd Exp $
d14 1
a14 1
PKGNAME-main=		ruby-${VERSION}.${PATCHLEVEL}p2
@


1.66.2.1
log
@SECURITY FIX
Fixes a denial of service vulnerability in the
BigDecimal standard library of Ruby.

http://www.ruby-lang.org/en/news/2009/06/09/dos-vulnerability-in-bigdecimal/

patch from bernd@@, thanks!

ok robert@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.66 2009/02/09 20:48:23 naddy Exp $
d14 1
a14 1
PKGNAME-main=		ruby-${VERSION}.${PATCHLEVEL}p3
@


1.66.2.2
log
@MFC:

SECURITY FIX

ruby-1.8.6-p369

Resolves many security issues and bugs

Does not contain the arandom change in -current.

ok robert@@, discussed with bernd@@ (thanks!)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.72 2009/06/22 17:00:23 naddy Exp $
d11 1
a11 1
PATCHLEVEL=		369
d14 1
a14 1
PKGNAME-main=		ruby-${VERSION}.${PATCHLEVEL}p0
@


1.65
log
@Revert last "fix". I causes problems with some Ruby code which worked before.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.64 2009/01/31 09:54:31 bernd Exp $
d14 4
a17 4
PKGNAME-main=		ruby-${VERSION}.${PATCHLEVEL}p1
PKGNAME-iconv=		ruby-iconv-${VERSION}.${PATCHLEVEL}
PKGNAME-gdbm=		ruby-gdbm-${VERSION}.${PATCHLEVEL}
PKGNAME-tk=		ruby-tk-${VERSION}.${PATCHLEVEL}
@


1.64
log
@Fix usage of short-named constants. (ruby svn r18485)

From msf@@.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.63 2008/09/28 15:43:05 bernd Exp $
d14 1
a14 1
PKGNAME-main=		ruby-${VERSION}.${PATCHLEVEL}p0
@


1.63
log
@Security update to ruby-1.8.6.287.

This fixes a DNS spoofing vulnerability in Ruby's resolver lib. (CVE-2008-1447)

A DoS vulnerability in WEBrick(CVE-2008-3656), problems with Ruby's
safelevel implementation (CVE-2008-3655) and a taint check problem
in Ruby's dynamic loader (CVE-2008-3657) got fixed as well.

This also contains a fix for the REXML DoS issue. (CVE-2008-3790)

More information:
http://www.ruby-lang.org/en/news/2008/08/08/multiple-vulnerabilities-in-ruby/
http://www.ruby-lang.org/en/news/2008/08/23/dos-vulnerability-in-rexml/

Tested by Jeremy Evans and jcs@@. Thanks!
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62 2008/07/25 20:25:59 sthen Exp $
d14 1
a14 1
PKGNAME-main=		ruby-${VERSION}.${PATCHLEVEL}
@


1.62
log
@shared library and PKGNAME bumps due to use of isinf/isnan/nan
following libc/libm changes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.61 2008/07/21 09:40:42 bernd Exp $
d11 1
a11 1
PATCHLEVEL=		114
d14 4
a17 4
PKGNAME-main=		ruby-${VERSION}.${PATCHLEVEL}p2
PKGNAME-iconv=		ruby-iconv-${VERSION}.${PATCHLEVEL}p0
PKGNAME-gdbm=		ruby-gdbm-${VERSION}.${PATCHLEVEL}p0
PKGNAME-tk=		ruby-tk-${VERSION}.${PATCHLEVEL}p0
d58 2
a59 2
CONFIGURE_ARGS+=	--with-tcl-include=${PREFIX}/include/tcl8.4 \
			--with-tk-include=${PREFIX}/include/tk8.4 \
d74 2
a75 2
WANTLIB-tk=		X11 c m tcl84
LIB_DEPENDS-tk=		tk84:tk-8.4.*:x11/tk/8.4 \
@


1.61
log
@Security fixes for CVE-2008-1891, CVE-2008-2662, CVE-2008-2663,
CVE-2008-2664, CVE-2008-2725 and CVE-2008-2726.

More info: http://secunia.com/advisories/29794/

with help from jcs@@
tested by msf@@, jcs@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.60 2008/07/04 19:57:06 naddy Exp $
d13 2
a14 2
SHARED_LIBS=		ruby 1.86
PKGNAME-main=		ruby-${VERSION}.${PATCHLEVEL}p1
@


1.60
log
@bump PKGNAME for PLIST changes 4.3 -> 4.4
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59 2008/03/29 12:05:27 bernd Exp $
d14 1
a14 1
PKGNAME-main=		ruby-${VERSION}.${PATCHLEVEL}p0
@


1.59
log
@Security update to ruby-1.8.6.114. (CVE-2008-1145)

More information:
http://secunia.com/advisories/29232/
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2008/02/22 19:16:49 naddy Exp $
d14 4
a17 4
PKGNAME-main=		ruby-${VERSION}.${PATCHLEVEL}
PKGNAME-iconv=		ruby-iconv-${VERSION}.${PATCHLEVEL}
PKGNAME-gdbm=		ruby-gdbm-${VERSION}.${PATCHLEVEL}
PKGNAME-tk=		ruby-tk-${VERSION}.${PATCHLEVEL}
@


1.58
log
@bump PKGNAME for PLIST changes 4.2 -> 4.3
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.57 2007/12/27 18:32:32 bernd Exp $
d11 1
a11 1
PATCHLEVEL=		111
d14 4
a17 4
PKGNAME-main=		ruby-${VERSION}.${PATCHLEVEL}p0
PKGNAME-iconv=		ruby-iconv-${VERSION}.${PATCHLEVEL}p0
PKGNAME-gdbm=		ruby-gdbm-${VERSION}.${PATCHLEVEL}p0
PKGNAME-tk=		ruby-tk-${VERSION}.${PATCHLEVEL}p0
@


1.58.2.1
log
@Security update to ruby-1.8.6.114. (CVE-2008-1145)

More information:
http://secunia.com/advisories/29232/

from William Yodlowsky
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2008/02/22 19:16:49 naddy Exp $
d11 1
a11 1
PATCHLEVEL=		114
d14 4
a17 4
PKGNAME-main=		ruby-${VERSION}.${PATCHLEVEL}
PKGNAME-iconv=		ruby-iconv-${VERSION}.${PATCHLEVEL}
PKGNAME-gdbm=		ruby-gdbm-${VERSION}.${PATCHLEVEL}
PKGNAME-tk=		ruby-tk-${VERSION}.${PATCHLEVEL}
@


1.57
log
@Update to ruby-1.8.6 patchlevel 111.

This is a long overdue update which contains lots of bug fixes and some
security fixes.

Take over maintainership from msf@@.

Tested by many. Thank you very much!

ok jcs@@, msf@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2007/09/16 00:27:06 merdely Exp $
d14 4
a17 4
PKGNAME-main=		ruby-${VERSION}.${PATCHLEVEL}
PKGNAME-iconv=		ruby-iconv-${VERSION}.${PATCHLEVEL}
PKGNAME-gdbm=		ruby-gdbm-${VERSION}.${PATCHLEVEL}
PKGNAME-tk=		ruby-tk-${VERSION}.${PATCHLEVEL}
@


1.56
log
@Remove surrounding quotes in COMMENT*/PERMIT_*/BROKEN
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55 2007/07/27 19:17:11 naddy Exp $
d10 8
a17 7
VERSION=		1.8.5
DISTNAME=		ruby-${VERSION}
SHARED_LIBS=		ruby 1.85
PKGNAME-main=		${DISTNAME}p7
PKGNAME-iconv=		ruby-iconv-${VERSION}p4
PKGNAME-gdbm=		ruby-gdbm-${VERSION}p4
PKGNAME-tk=		ruby-tk-${VERSION}p4
d23 1
a23 1
MAINTAINER=		Mathieu Sauve-Frankel <msf@@openbsd.org>
d80 1
a80 1
REGRESS_DEPENDS=	::lang/ruby
@


1.55
log
@bump package name to accommodate OpenBSD 4.1 -> 4.2 change in MODRUBY_ARCH
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.54 2007/02/13 23:47:13 espie Exp $
d5 4
a8 4
COMMENT-main=		"object oriented script language with threads"
COMMENT-iconv=		"libiconv interface for ruby"
COMMENT-gdbm=		"gdbm interface for ruby"
COMMENT-tk=		"tk interface for ruby"
@


1.54
log
@bump pkgnames after the 4.1 bump.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2007/01/11 09:34:40 bernd Exp $
d13 4
a16 4
PKGNAME-main=		${DISTNAME}p6
PKGNAME-iconv=		ruby-iconv-${VERSION}p3
PKGNAME-gdbm=		ruby-gdbm-${VERSION}p3
PKGNAME-tk=		ruby-tk-${VERSION}p3
@


1.53
log
@Fix an 'undefined symbol' error with openssl when using LD_BIND_NOW.

from markus@@, ok msf@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.52 2006/12/31 01:04:09 msf Exp $
d13 4
a16 4
PKGNAME-main=		${DISTNAME}p5
PKGNAME-iconv=		ruby-iconv-${VERSION}p2
PKGNAME-gdbm=		ruby-gdbm-${VERSION}p2
PKGNAME-tk=		ruby-tk-${VERSION}p2
@


1.52
log
@add a missing include to rdoc. from ruby subversion, pointed out by ray@@
bump PKGNAME
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 2006/12/04 13:26:51 bernd Exp $
d13 1
a13 1
PKGNAME-main=		${DISTNAME}p4
d40 2
a41 1
			LIBruby_VERSION=${LIBruby_VERSION}
@


1.51
log
@Fix some more security problems in cgi.rb.

ok msf@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2006/11/27 09:52:52 bernd Exp $
d13 1
a13 1
PKGNAME-main=		${DISTNAME}p3
@


1.50
log
@Add VMEM_WARNING=Yes. Building the ruby documentation consumes lots of
memory.

discussed with msf@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2006/11/24 09:45:08 bernd Exp $
d13 1
a13 1
PKGNAME-main=		${DISTNAME}p2
@


1.49
log
@Switch to new MULTI_PACKAGES. ok espie@@, msf@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2006/11/19 11:54:44 msf Exp $
d83 3
@


1.48
log
@unbreak no_x11 flavor. spotted by Jason LaRiviere.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2006/11/02 12:46:13 bernd Exp $
d5 1
a5 1
COMMENT=		"object oriented script language with threads"
d13 1
a13 1
PKGNAME=		${DISTNAME}p1
d42 5
a46 1
WANTLIB= 		c m
d51 1
a51 2
MULTI_PACKAGES=		-iconv -gdbm
SUBPACKAGE?=
d61 9
a69 17
.if !defined(PACKAGING) || ${SUBPACKAGE} == ""
WANTLIB+=		readline termcap util crypto ncurses ssl z
.endif

.if !defined(PACKAGING) || ${SUBPACKAGE} == "-iconv"
MODULES+=		converters/libiconv
.  if defined(PACKAGING)
LIB_DEPENDS+=		ruby.>=1::lang/ruby
.  endif
.endif

.if !defined(PACKAGING) || ${SUBPACKAGE} == "-gdbm"
LIB_DEPENDS+=		gdbm.>=3::databases/gdbm
.  if defined(PACKAGING)
LIB_DEPENDS+=		ruby.>=1::lang/ruby
.  endif
.endif
d72 4
a75 7
.  if !defined(PACKAGING) || ${SUBPACKAGE} == "-tk"
WANTLIB+=		X11 tcl84
LIB_DEPENDS+=		tk84:tk-8.4.*:x11/tk/8.4
.    if defined(PACKAGING)
LIB_DEPENDS+=		ruby.>=1::lang/ruby
.    endif
.  endif
@


1.47
log
@Security fix for CVE-2006-5467 from ruby CVS.

More info:
http://rubyforge.org/pipermail/mongrel-users/2006-October/001946.html
http://www.securityfocus.com/bid/20777/info

ok msf@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2006/10/26 18:15:24 bernd Exp $
d76 2
a77 1
.if !defined(PACKAGING) || ${SUBPACKAGE} == "-tk"
d80 1
a80 1
.  if defined(PACKAGING)
d82 1
@


1.46
log
@Args, LIB_DEPENDS should be correct now... Sorry.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2006/10/26 17:57:16 bernd Exp $
d13 1
a13 1
PKGNAME=		${DISTNAME}p0
@


1.45
log
@Fix LIB_DEPENDS for subpackages and bump PKGNAMEs.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2006/10/22 08:45:39 steven Exp $
d14 3
a16 3
PKGNAME-iconv=		ruby-iconv-${VERSION}p1
PKGNAME-gdbm=		ruby-gdbm-${VERSION}p1
PKGNAME-tk=		ruby-tk-${VERSION}p1
d65 1
a65 1
LIB_DEPENDS+=		ruby.>=1:ruby-${VERSION}*:lang/ruby
d72 1
a72 1
LIB_DEPENDS+=		ruby.>=1:ruby-${VERSION}*:lang/ruby
d80 1
a80 1
LIB_DEPENDS+=		ruby.>=1:ruby-${VERSION}*:lang/ruby
d84 1
a84 1
REGRESS_DEPENDS=	:ruby-${VERSION}*:lang/ruby
@


1.44
log
@bump PKGNAME after some packaging changes earlier

okay bernd
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2006/10/19 01:03:17 bernd Exp $
d14 3
a16 3
PKGNAME-iconv=		ruby-iconv-${VERSION}p0
PKGNAME-gdbm=		ruby-gdbm-${VERSION}p0
PKGNAME-tk=		ruby-tk-${VERSION}p0
d65 1
a65 1
LIB_DEPENDS+=		ruby.>=1:${PKGNAME}:lang/ruby
d72 1
a72 1
LIB_DEPENDS+=		ruby.>=1:${PKGNAME}:lang/ruby
d80 1
a80 1
LIB_DEPENDS+=		ruby.>=1:${PKGNAME}:lang/ruby
d84 1
a84 1
REGRESS_DEPENDS=	:${PKGNAME}:lang/ruby
@


1.43
log
@- Clean up Makfile to make it more readable.
- Better dependencies for the subpackages. Bump PKGNAMEs.

ok msf@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2006/10/02 07:48:08 bernd Exp $
d13 1
@


1.42
log
@Update to ruby-1.8.5.

See http://eigenclass.org/hiki.rb?ruby+1.8.5+changelog for a summary of
changes.

tested by krw@@
ok msf@@, sturm@@
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.41 2006/08/09 22:14:11 bernd Exp $
a9 1
SHARED_ONLY=		Yes
d13 3
a15 3
PKGNAME-iconv=		ruby-iconv-${VERSION}
PKGNAME-gdbm=		ruby-gdbm-${VERSION}
PKGNAME-tk=		ruby-tk-${VERSION}
d21 1
a21 1
MAINTAINER=		Mathieu Sauve-Frankel <msf@@openbsd.org> 
d33 10
a48 3
MODULES=		converters/libiconv
LIB_DEPENDS+=		gdbm.>=3::databases/gdbm

d50 1
a51 13
LIB_DEPENDS+=		tk84:tk-8.4.*:x11/tk/8.4 
.endif 

CONFIGURE_STYLE=	gnu
CONFIGURE_ARGS+=	${CONFIGURE_SHARED} \
			--enable-ipv6 \
			--with-dbm-type=bogus \
			--with-opt-dir="${LOCALBASE}"
CONFIGURE_ENV+=		PREFIX="${PREFIX}" \
			LIBruby_VERSION=${LIBruby_VERSION}

.if !${FLAVOR:L:Mno_x11}
USE_X11=		Yes
d54 5
a58 1
			--with-X11-dir=${X11BASE} 
d61 6
a66 1
INSTALL_TARGET=		install install-doc
d68 4
a71 19
WANTLIB= 		ssl termcap ncurses c crypto m util z readline
.if defined(PACKAGING)
.  if empty(SUBPACKAGE)
MODULES=	
LIB_DEPENDS=
.  elif ${SUBPACKAGE} == "-iconv"
MODULES=		converters/libiconv
LIB_DEPENDS=		ruby.>=1.84::lang/ruby
WANTLIB=		c m
.  elif ${SUBPACKAGE} == "-gdbm"
MODULES=
LIB_DEPENDS=		ruby.>=1.84::lang/ruby \
			gdbm.>=3::databases/gdbm
WANTLIB=		c m
.  elif ${SUBPACKAGE} == "-tk"
MODULES=		
LIB_DEPENDS=		ruby.>=1.84::lang/ruby \
			tk84:tk-8.4.*:x11/tk/8.4
WANTLIB=		X11 tcl84.>=1 c m
d73 1
a73 1
.endif 
d75 7
a81 1
REGRESS_DEPENDS=	::lang/ruby
d83 5
a87 3
REV=1.8
SUB=${MACHINE_ARCH:S/amd64/x86_64/}-openbsd${OSREV}
SUBST_VARS=SUB REV
@


1.41
log
@Explicitly depend on tk-8.4.*. This fixes package updates for ruby-tk if
more than one tk version is installed.

ok sturm@@, msf@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2006/08/03 13:09:09 espie Exp $
d9 1
a9 1
VERSION=		1.8.4
d11 4
a14 5
SHARED_LIBS=		ruby 1.84
PKGNAME=		${DISTNAME}p4
PKGNAME-iconv=		ruby-iconv-${VERSION}p1
PKGNAME-gdbm=		ruby-gdbm-${VERSION}p1
PKGNAME-tk=		ruby-tk-${VERSION}p2
@


1.41.2.1
log
@MFC:
Security fix for CVE-2006-5467 from ruby CVS.

More info:
http://rubyforge.org/pipermail/mongrel-users/2006-October/001946.html
http://www.securityfocus.com/bid/20777/info
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2006/08/09 22:14:11 bernd Exp $
d12 1
a12 1
PKGNAME=		${DISTNAME}p5
@


1.41.2.2
log
@MFC:
Fix some more security problems in cgi.rb.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41.2.1 2006/11/04 11:09:24 sturm Exp $
d12 1
a12 1
PKGNAME=		${DISTNAME}p6
@


1.40
log
@new lib specs
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2006/07/28 06:29:34 steven Exp $
d15 1
a15 1
PKGNAME-tk=		ruby-tk-${VERSION}p1
d44 1
a44 1
LIB_DEPENDS+=		tk84::x11/tk/8.4 
d81 1
a81 1
			tk84::x11/tk/8.4
@


1.39
log
@bump PKGNAME due to PLIST changes after 3.9 -> 4.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2006/07/06 08:22:20 bernd Exp $
d40 1
a40 1
LIB_DEPENDS+=		gdbm.3::databases/gdbm
d44 1
a44 1
LIB_DEPENDS+=		tk84.::x11/tk/8.4 
d71 1
a71 1
LIB_DEPENDS=		ruby.1.84::lang/ruby
d75 2
a76 2
LIB_DEPENDS=		ruby.1.84::lang/ruby \
			gdbm.3::databases/gdbm
d80 3
a82 3
LIB_DEPENDS=		ruby.1.84::lang/ruby \
			tk84.::x11/tk/8.4
WANTLIB=		X11 tcl84.1 c m
@


1.38
log
@- add ruby to REGRESS_DEPENDS
- fix a typo in webrick/httpservlet/filehandler.rb. (from ruby CVS)

ok sturm@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2006/06/10 16:50:15 sturm Exp $
d12 4
a15 4
PKGNAME=		${DISTNAME}p3
PKGNAME-iconv=		ruby-iconv-${VERSION}p0
PKGNAME-gdbm=		ruby-gdbm-${VERSION}p0
PKGNAME-tk=		ruby-tk-${VERSION}p0
@


1.37
log
@don't try creating existing directories in mkdir_p(), needed for
upcomming ports to not get systrace warnings (and it's good practice
anyways)

ok msf@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2006/01/22 16:30:36 alek Exp $
d12 1
a12 1
PKGNAME=		${DISTNAME}p2
d85 2
@


1.36
log
@bump PKGNAMEs due to PLIST changes after 3.8 -> 3.9
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2006/01/08 10:39:31 alek Exp $
d12 1
a12 1
PKGNAME=		${DISTNAME}p1
@


1.36.2.1
log
@MFC:
Security fix for CVE-2006-5467 from ruby CVS.

More info:
http://rubyforge.org/pipermail/mongrel-users/2006-October/001946.html
http://www.securityfocus.com/bid/20777/info
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2006/01/22 16:30:36 alek Exp $
d12 1
a12 1
PKGNAME=		${DISTNAME}p5
@


1.36.2.2
log
@MFC:
Fix some more security problems in cgi.rb.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36.2.1 2006/11/04 11:46:17 sturm Exp $
d12 1
a12 1
PKGNAME=		${DISTNAME}p6
@


1.35
log
@- SHARED_LIBS
- Regen PLIST
- Bump PKGNAME

ok msf@@, steven@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2005/12/29 17:27:31 msf Exp $
d12 4
a15 4
PKGNAME=		${DISTNAME}p0
PKGNAME-iconv=		ruby-iconv-${VERSION}
PKGNAME-gdbm=		ruby-gdbm-${VERSION}
PKGNAME-tk=		ruby-tk-${VERSION}
@


1.34
log
@- update ruby to 1.8.4
- add no_x11 PSEUDO_FLAVOR and remove old tk FLAVOR
- add tk, iconv, and gdbm SUBPACKAGES
- take MAINTAINER

"commit now" naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2005/10/18 17:33:20 couderc Exp $
d11 2
d52 2
a53 1
CONFIGURE_ENV+=		PREFIX="${PREFIX}"
@


1.33
log
@dropping maintainership
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2005/09/04 23:31:07 espie Exp $
d4 3
d9 1
a9 1
VERSION=		1.8.1
d11 4
a14 1
PKGNAME=		${DISTNAME}p1
d19 3
a21 1
# GPL
a25 1
WANTLIB=		ssl termcap m ncurses crypto c util z readline
d27 9
a35 3
MASTER_SITES=	ftp://www.ruby-lang.org/pub/ruby/1.8/ \
                ftp://mirror.nucba.ac.jp/pub/ruby/1.8/ \
                ftp://ftp.kr.freebsd.org/pub/ruby/1.8/
d37 2
a38 2
CONFIGURE_STYLE=	gnu
CONFIGURE_ARGS+=	${CONFIGURE_SHARED}
d40 4
a43 2
FLAVORS=	tk
FLAVOR?=
d45 6
a50 3
.if ${FLAVOR:L} == "tk"
LIB_DEPENDS=	tcl84.::lang/tcl/8.4 \
		tk84.::x11/tk/8.4
d52 2
a56 2
.else
CONFIGURE_ARGS+=	--without-x11
a57 1
CONFIGURE_ARGS+=	--with-dbm-type=bogus
d59 23
a81 1
REGRESS_TARGET=	test
@


1.32
log
@duplicate mkdir
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2005/06/30 22:37:12 robert Exp $
a11 2

MAINTAINER=		Damien Couderc <couderc@@openbsd.org>
@


1.31
log
@SECURITY:
fix an arbitrary command execution vulnerability; bump PKGNAME

http://www.vuxml.org/openbsd/e80d814e-e9b6-11d9-a5c1-00065bd5b0b6.html
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2005/02/24 13:20:41 alek Exp $
d8 1
a8 1
PKGNAME=		${DISTNAME}p0
@


1.30
log
@Add/fix WANTLIB markers
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2004/08/23 08:43:16 espie Exp $
d8 1
@


1.30.2.1
log
@SECURITY:
fix an arbitrary command execution vulnerability; bump PKGNAME
http://www.vuxml.org/openbsd/e80d814e-e9b6-11d9-a5c1-00065bd5b0b6.html

ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2005/02/24 13:20:41 alek Exp $
a7 1
PKGNAME=		${DISTNAME}p0
@


1.29
log
@make sure ruby doesn't pick db dependencies along the way.
after 3.6, think about gdbm/db flavors ?

okay pvalchev@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2004/06/23 14:17:05 naddy Exp $
d19 1
@


1.29.2.1
log
@SECURITY:
fix an arbitrary command execution vulnerability; bump PKGNAME
http://www.vuxml.org/openbsd/e80d814e-e9b6-11d9-a5c1-00065bd5b0b6.html

ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2004/08/23 08:43:16 espie Exp $
a7 1
PKGNAME=		${DISTNAME}p0
@


1.28
log
@- Fix packaging on amd64.
- Enable regression test.

ok couderc@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2004/02/20 22:52:57 couderc Exp $
d5 1
d40 1
@


1.27
log
@update to 1.8.1
@
text
@d1 1
a1 1
# $OpenBSD$
d40 1
a40 1
NO_REGRESS=		Yes
d43 1
a43 1
SUB=${MACHINE_ARCH}-openbsd${OSREV}
@


1.27.2.1
log
@SECURITY:
Andres Salomon noticed a problem in the CGI session management of Ruby.
CGI::Session's FileStore implementations store session information insecurely.
They simply create files, ignoring permission issues. The added patch fixes
this issue.

ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2004/02/20 22:52:57 couderc Exp $
a6 1
PKGNAME=		${DISTNAME}p1
@


1.26
log
@update to tcl/tk 8.4, ok brad@@ naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2002/12/26 15:48:22 couderc Exp $
d3 1
a3 1
COMMENT=	"object oriented script language with threads"
d5 3
a7 3
VERSION=	1.6.8
DISTNAME=	ruby-${VERSION}
CATEGORIES=	lang
d9 1
a9 3
MASTER_SITES=	ftp://www.ruby-lang.org/pub/ruby/ \
		ftp://mirror.nucba.ac.jp/pub/ruby/ \
		ftp://ftp.kr.freebsd.org/pub/ruby/
d11 1
a11 1
MASTER_SITES0=	${MASTER_SITES:C,$,doc/,}
d13 5
a17 4
BINARCH=	${DISTNAME}.tar.gz
MANARCH=	ruby-man-1.4.6.tar.gz
DISTFILES=	${BINARCH} ${MANARCH}:0
EXTRACT_ONLY=	${BINARCH}
d19 3
a21 2
HOMEPAGE=	http://www.ruby-lang.org/
MAINTAINER=	Damien Couderc <couderc@@openbsd.org>
d23 2
a24 4
PERMIT_DISTFILES_FTP=	Yes
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_PACKAGE_CDROM=	Yes
a28 11
CONFIGURE_STYLE=	autoconf
SEPARATE_BUILD=		concurrent

# XXX workaround gcc bugs on sparc64 (for sha1.o)
.if ${MACHINE_ARCH:Msparc64}
CFLAGS+=	-O0
.endif

CONFIGURE_ENV=	YACC=yacc
CONFIGURE_ARGS=	${CONFIGURE_SHARED}

d40 1
a40 15
REGRESS_TARGET=	test

# Force rebuild of parse.c with yacc
post-extract: 
	cd ${WRKSRC} && rm parse.c

# buglet fix: lex.c should be in object dir
post-configure:
	cp ${WRKSRC}/lex.c ${WRKBUILD}/lex.c

post-install:
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/ruby
	cd ${PREFIX}/share/doc && \
	tar -s/ruby-man-1.4/ruby/ -zxf ${FULLDISTDIR}/${MANARCH}
	@@strip ${PREFIX}/bin/ruby
d42 1
a42 1
REV=1.6
@


1.25
log
@Update to 1.6.8
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2002/10/27 14:10:23 naddy Exp $
d43 2
a44 2
LIB_DEPENDS=	tcl83.::lang/tcl/8.3 \
		tk83.::x11/tk/8.3
d46 2
a47 2
CONFIGURE_ARGS+=	--with-tcl-include=${PREFIX}/include/tcl8.3 \
			--with-tk-include=${PREFIX}/include/tk8.3 \
@


1.25.4.1
log
@SECURITY:
Andres Salomon noticed a problem in the CGI session management of Ruby.
CGI::Session's FileStore implementations store session information insecurely.
They simply create files, ignoring permission issues. The added patch fixes
this issue.

ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2002/12/26 15:48:22 couderc Exp $
a6 1
PKGNAME=	${DISTNAME}p1
@


1.24
log
@Enable regression tests.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2002/09/20 14:58:38 couderc Exp $
d4 2
a5 1
VERSION=	1.6.7
@


1.23
log
@Fix tk flavor (noticed by Jim Geovedi)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2002/07/03 16:31:28 couderc Exp $
d52 1
@


1.22
log
@Move tk stuff to a flavor so default install does not need tcl/tk.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2002/06/29 13:39:26 couderc Exp $
d3 1
a3 1
COMMENT=	object oriented script language with threads
d7 1
a7 1
NEED_VERSION=	1.362
@


1.21
log
@Fix for ELF machines from drahn@@, ok krw@@
Taking maintainer, ok krw@@ & espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2002/03/24 22:38:50 brad Exp $
d27 2
a28 2
LIB_DEPENDS=	tcl83.::lang/tcl/8.3 \
		tk83.::x11/tk/8.3
d39 13
a51 4
CONFIGURE_ARGS=	${CONFIGURE_SHARED} \
		--with-tcl-include=${PREFIX}/include/tcl8.3 \
		--with-tk-include=${PREFIX}/include/tk8.3 \
		--with-X11-dir=${X11BASE} 
@


1.20
log
@MACHINE vs. MACHINE_ARCH problem, change SUB to use MACHINE_ARCH to fix the generated PLIST. Fixes breakage on powerpc systems, should fix m68k too.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2002/03/16 01:03:56 krw Exp $
d20 1
a20 1
MAINTAINER=	Ken Westerback <krw@@openbsd.org>
@


1.19
log
@Update to version 1.6.7.

The release of 1.6.7 was brought to my attention by
John.Jeffery@@jpj.com.au.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2002/03/06 18:59:21 lebel Exp $
d59 1
a59 1
SUB=${ARCH}-openbsd${OSREV}
@


1.18
log
@XXX workaround a gcc optimization bug on sparc64 (for sha1.o)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2002/02/21 00:48:11 krw Exp $
d4 1
a4 1
VERSION=	1.6.6
@


1.17
log
@Update to version 1.6.6.

Remove files/* in favour of distinfo.

Update master sites to ones with 1.6.6, drop unresponsive sites
and those who still don't have 1.6.6.

Cosmetic whitespace adjustments in Makefile.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2001/10/29 23:01:07 krw Exp $
d32 5
@


1.16
log
@Fix HOMEPAGE. Noted by Sebastian Stark.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2001/10/26 01:25:05 krw Exp $
d4 3
a6 3
VERSION=1.6.5
DISTNAME=ruby-${VERSION}
CATEGORIES = lang
d8 10
a17 11
MASTER_SITES=ftp://ftp.netlab.co.jp/pub/lang/ruby/ \
    ftp://ftp.iij.ad.jp/pub/lang/ruby/ \
    ftp://ftp.TokyoNet.AD.JP/pub/misc/ruby/ \
    ftp://ftp.krnet.ne.jp/pub/ruby/ 

MASTER_SITES0=${MASTER_SITES:C,$,doc/,}

BINARCH=${DISTNAME}.tar.gz
MANARCH=ruby-man-1.4.6.tar.gz
DISTFILES=${BINARCH} ${MANARCH}:0
EXTRACT_ONLY=${BINARCH}
d19 1
a19 1
HOMEPAGE=http://www.ruby-lang.org/
d21 1
d27 2
a28 2
LIB_DEPENDS=tcl83.::lang/tcl/8.3 \
            tk83.::x11/tk/8.3
d31 1
a31 1
SEPARATE_BUILD=	concurrent
d33 5
a37 5
CONFIGURE_ENV=YACC=yacc
CONFIGURE_ARGS=${CONFIGURE_SHARED} \
    --with-tcl-include=${PREFIX}/include/tcl8.3 \
    --with-tk-include=${PREFIX}/include/tk8.3 \
    --with-X11-dir=${X11BASE} 
d41 1
a41 1
	cd ${WRKSRC} && rm parse.c 
@


1.15
log
@Update to 1.6.5
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2001/10/26 00:35:51 krw Exp $
d20 1
a20 1
HOMEPAGE=http://www.netlab.co.jp/ruby/
@


1.14
log
@Update ruby port to 1.6.4. Take over as maintainer. ok espie@@.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2001/07/03 06:34:53 jsyn Exp $
d4 1
a4 1
VERSION=1.6.4
@


1.13
log
@add binary stripping; ok espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2001/03/23 14:12:32 espie Exp $
d4 1
a4 1
VERSION=1.6.2
d21 1
a21 1
MAINTAINER=	Marc Espie <espie@@openbsd.org>
@


1.12
log
@fix shared library name.
Remove COMMENT while I'm at it.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2001/02/21 17:17:17 espie Exp $
d51 1
a51 1

@


1.11
log
@Update to ruby 1.6.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2001/01/08 21:36:42 espie Exp $
d3 1
d7 1
a7 1
NEED_VERSION=	1.336
@


1.10
log
@missed old style dependencies.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2001/01/05 16:35:59 brad Exp $
d3 1
a3 1
VERSION=1.4.6
d15 1
a15 1
MANARCH=ruby-man-${VERSION}.tar.gz
d52 1
a52 1
REV=1.4
@


1.9
log
@bye bye NO_CDROM and MIRROR_DISTFILE
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2000/10/22 15:42:30 espie Exp $
d26 2
a27 2
LIB_DEPENDS=tcl83.:${PORTSDIR}/lang/tcl/8.3 \
            tk83.:${PORTSDIR}/x11/tk/8.3
@


1.8
log
@Kill
FAKE=Yes
HAS_CONFIGURE, GNU_CONFIGURE, USE_IMAKE, NO_INSTALL_MANPAGES, USE_AUTOCONF
and bump NEED_VERSION accordingly.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2000/10/10 00:40:48 espie Exp $
d6 1
a6 1
NEED_VERSION=	1.310
a24 1
NO_CDROM="st.[ch] is rumored to be public domain, copyright unclear"
@


1.7
log
@Fix my address. Dust off details.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2000/09/05 13:56:24 espie Exp $
d30 1
a30 1
CONFIGURE_STYLE=	gnu
a37 2

USE_AUTOCONF=Yes
@


1.6
log
@Update to release 1.4.6.
mkstemp patch no longer needed, as the new mktemp usage is safe.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2000/08/16 18:54:48 espie Exp $
d20 1
a20 1
MAINTAINER=	espie@@cvs.openbsd.org
@


1.5
log
@oops
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2000/07/04 13:47:55 espie Exp $
d3 2
a4 1
DISTNAME=ruby-1.4.4
d15 1
a15 1
MANARCH=ruby-man-1.4.4.tar.gz
d20 1
a20 1
MAINTAINER=espie@@cvs.openbsd.org
@


1.4
log
@Fix thinko

(need to update to 1.5)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2000/06/28 13:51:24 espie Exp $
d38 1
a38 1
#USE_AUTOCONF=Yes
@


1.3
log
@Kill PLIST.sed
Add @@comment

Simplify ruby build, now that bsd.port.mk has proper support
for variable substitutions.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2000/05/18 18:37:59 espie Exp $
d5 1
a5 1
NEED_VERSION=	1.308
@


1.2
log
@Version 1.4.4
Set patches according to update-patches.
Redo PLIST according to newer bsd.port.mk.
Remove patch that's now part of ruby proper.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2000/03/28 13:16:02 espie Exp $
d5 1
d29 1
a29 1
GNU_CONFIGURE=	Yes
a30 1
FAKE=		Yes
d54 4
a58 3

# Need to do this late, because I want to substitute the fragment as well.
SED_PLIST+=|sed -e 's/REV/1.4/' -e 's/SUB/${ARCH}-openbsd${OSREV}/'
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d3 1
a3 1
DISTNAME=ruby-1.4.3
d13 1
a13 1
MANARCH=ruby-man-1.4.3.tar.gz
a52 6
PLIST=${WRKBUILD}/PLIST

M4FLAGS=-Uinclude -Uindex -DSUB=${ARCH}-openbsd${OSREV} -DREV=1.4
pre-package: 
	@@cd ${.CURDIR} && make ${PLIST}

a54 6
.if !defined(NO_SHARED_LIBS)
M4FLAGS+= -DDYNAMIC
.endif

${PLIST}: ${FILESDIR}/PLIST.template
	m4 ${M4FLAGS} <${FILESDIR}/PLIST.template >${PLIST}
d56 2
@


1.1.1.1
log
@ruby 1.4.3: a nice language, very similar to perl, but with with interesting
differences.
@
text
@@


1.1.1.1.2.1
log
@bring lang as of cut-over date into 2.7 branch
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2000/07/04 13:47:55 espie Exp $
d3 1
a3 1
DISTNAME=ruby-1.4.4
a4 1
NEED_VERSION=	1.310
d13 1
a13 1
MANARCH=ruby-man-1.4.4.tar.gz
d28 1
a28 1
CONFIGURE_STYLE=	gnu
d30 1
d53 5
a58 3
REV=1.4
SUB=${ARCH}-openbsd${OSREV}
SUBST_VARS=SUB REV
d61 7
@

