head	1.4;
access;
symbols;
locks; strict;
comment	@# @;


1.4
date	2009.04.27.10.54.09;	author bernd;	state dead;
branches;
next	1.3;

1.3
date	2009.03.07.12.30.17;	author bernd;	state Exp;
branches;
next	1.2;

1.2
date	2009.02.03.21.15.28;	author bernd;	state dead;
branches;
next	1.1;

1.1
date	2009.01.31.09.54.31;	author bernd;	state Exp;
branches;
next	;


desc
@@


1.4
log
@Update to ruby-1.8.6.368.

Including security fixes for CVE-2008-1447 and CVE-2007-1558.

Tested by Jeremy Evans, jcs@@, sturm@@ and msf@@. Thank you!
@
text
@$OpenBSD: patch-node_h,v 1.3 2009/03/07 12:30:17 bernd Exp $

Fix usage of short-named constants.

http://svn.ruby-lang.org/cgi-bin/viewvc.cgi?view=rev&revision=18485
https://bugs.launchpad.net/ubuntu/+source/ruby1.8/+bug/282302

--- node.h.orig	Mon Jul  7 08:01:50 2008
+++ node.h	Tue Jan 27 09:46:14 2009
@@@@ -319,7 +319,7 @@@@ extern NODE *ruby_top_cref;
 #define NEW_MODULE(n,b) NEW_NODE(NODE_MODULE,n,NEW_SCOPE(b),0)
 #define NEW_COLON2(c,i) NEW_NODE(NODE_COLON2,c,i,0)
 #define NEW_COLON3(i) NEW_NODE(NODE_COLON3,0,i,0)
-#define NEW_CREF(c) (NEW_NODE(NODE_CREF,0,0,c))
+#define NEW_CREF(c,n) NEW_NODE(NODE_CREF,c,0,n)
 #define NEW_DOT2(b,e) NEW_NODE(NODE_DOT2,b,e,0)
 #define NEW_DOT3(b,e) NEW_NODE(NODE_DOT3,b,e,0)
 #define NEW_ATTRSET(a) NEW_NODE(NODE_ATTRSET,a,0,0)
@


1.3
log
@Bring back the fix for short-named constants.
This previous problems should be gone now.
(ruby svn r18485 and r22679)

Thanks to Jeremy Evans!
@
text
@d1 1
a1 1
$OpenBSD$
@


1.2
log
@Revert last "fix". I causes problems with some Ruby code which worked before.
@
text
@d1 1
a1 1
$OpenBSD: patch-node_h,v 1.1 2009/01/31 09:54:31 bernd Exp $
@


1.1
log
@Fix usage of short-named constants. (ruby svn r18485)

From msf@@.
@
text
@d1 1
a1 1
$OpenBSD$
@

