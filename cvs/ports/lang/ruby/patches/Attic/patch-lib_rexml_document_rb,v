head	1.2;
access;
symbols
	OPENBSD_4_8:1.1.0.8
	OPENBSD_4_8_BASE:1.1
	OPENBSD_4_7:1.1.0.6
	OPENBSD_4_7_BASE:1.1
	OPENBSD_4_6:1.1.0.4
	OPENBSD_4_6_BASE:1.1
	OPENBSD_4_5:1.1.0.2
	OPENBSD_4_5_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2010.09.23.22.04.13;	author jeremy;	state dead;
branches;
next	1.1;

1.1
date	2008.09.28.15.43.05;	author bernd;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Remove files that I checked out with -r HEAD
@
text
@$OpenBSD: patch-lib_rexml_document_rb,v 1.1 2008/09/28 15:43:05 bernd Exp $

http://www.ruby-lang.org/en/news/2008/08/23/dos-vulnerability-in-rexml/

--- lib/rexml/document.rb.orig	Sun Nov  4 05:50:15 2007
+++ lib/rexml/document.rb	Thu Sep  4 09:53:31 2008
@@@@ -18,6 +18,18 @@@@ module REXML
   # you create, you must add one; REXML documents do not write a default
 	# declaration for you.  See |DECLARATION| and |write|.
 	class Document < Element
+		@@@@entity_expansion_limit = 10_000
+		def self.entity_expansion_limit= val
+			@@@@entity_expansion_limit = val
+		end
+
+		def record_entity_expansion!
+			@@number_of_expansions ||= 0
+			@@number_of_expansions += 1
+			if @@number_of_expansions > @@@@entity_expansion_limit
+				raise "Number of entity expansions exceeded, processing aborted."
+			end
+		end
 		# A convenient default XML declaration.  If you want an XML declaration,
 		# the easiest way to add one is mydoc << Document::DECLARATION
     # +DEPRECATED+
@


1.1
log
@Security update to ruby-1.8.6.287.

This fixes a DNS spoofing vulnerability in Ruby's resolver lib. (CVE-2008-1447)

A DoS vulnerability in WEBrick(CVE-2008-3656), problems with Ruby's
safelevel implementation (CVE-2008-3655) and a taint check problem
in Ruby's dynamic loader (CVE-2008-3657) got fixed as well.

This also contains a fix for the REXML DoS issue. (CVE-2008-3790)

More information:
http://www.ruby-lang.org/en/news/2008/08/08/multiple-vulnerabilities-in-ruby/
http://www.ruby-lang.org/en/news/2008/08/23/dos-vulnerability-in-rexml/

Tested by Jeremy Evans and jcs@@. Thanks!
@
text
@d1 1
a1 1
$OpenBSD$
@

