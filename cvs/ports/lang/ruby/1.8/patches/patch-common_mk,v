head	1.2;
access;
symbols
	OPENBSD_6_1:1.2.0.22
	OPENBSD_6_1_BASE:1.2
	OPENBSD_6_0:1.2.0.20
	OPENBSD_6_0_BASE:1.2
	OPENBSD_5_9:1.2.0.16
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.2.0.18
	OPENBSD_5_8_BASE:1.2
	OPENBSD_5_7:1.2.0.14
	OPENBSD_5_7_BASE:1.2
	OPENBSD_5_6:1.2.0.12
	OPENBSD_5_6_BASE:1.2
	OPENBSD_5_5:1.2.0.10
	OPENBSD_5_5_BASE:1.2
	OPENBSD_5_4:1.2.0.8
	OPENBSD_5_4_BASE:1.2
	OPENBSD_5_3:1.2.0.6
	OPENBSD_5_3_BASE:1.2
	OPENBSD_5_2:1.2.0.4
	OPENBSD_5_2_BASE:1.2
	OPENBSD_5_1_BASE:1.2
	OPENBSD_5_1:1.2.0.2
	OPENBSD_5_0:1.1.0.4
	OPENBSD_5_0_BASE:1.1
	OPENBSD_4_9:1.1.0.2
	OPENBSD_4_9_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2011.11.15.00.05.16;	author jeremy;	state Exp;
branches;
next	1.1;

1.1
date	2010.09.23.21.58.50;	author jeremy;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Add no_ri_docs PSUEDO_FLAVOR to skip building the ri documentation,
which should allow building on arches without enough memory to
generate the ri files.  Also, set PKG_ARCH=* for the ri_docs
subpackage, so that such arches can still use the documentation,
idea from sthen@@. Original idea for PSUEDO_FLAVOR from phessler@@.

OK sthen@@
@
text
@$OpenBSD: patch-common_mk,v 1.1 2010/09/23 21:58:50 jeremy Exp $

Build the ext stuff during the build phase so we don't have to
run 'make clean' as root.

--- common.mk.orig	Sun Nov 21 23:22:16 2010
+++ common.mk	Mon Nov 14 04:14:50 2011
@@@@ -79,7 +79,9 @@@@ PRE_LIBRUBY_UPDATE = $(MINIRUBY) -e 'ARGV[1] or File.u
 TESTSDIR      = $(srcdir)/test
 TESTWORKDIR   = testwork
 
-all: $(MKFILES) $(PREP) $(RBCONFIG) $(LIBRUBY)
+all: $(MKFILES) $(PREP) $(RBCONFIG) $(LIBRUBY) all-extmk
+
+all-extmk:
 	@@$(MINIRUBY) $(srcdir)/ext/extmk.rb --make="$(MAKE)" $(EXTMK_ARGS)
 prog: $(PROGRAM) $(WPROGRAM)
 
@@@@ -252,7 +254,7 @@@@ dont-install-man:
 post-no-install-man::
 	@@$(NULLCMD)
 
-install-doc: rdoc pre-install-doc do-install-doc post-install-doc
+install-doc: pre-install-doc do-install-doc post-install-doc
 pre-install-doc:: install-prereq
 do-install-doc: $(PROGRAM)
 	$(MINIRUBY) $(srcdir)/instruby.rb --make="$(MAKE)" $(INSTRUBY_ARGS) --install=rdoc --rdoc-output="$(RDOCOUT)"
@


1.1
log
@Split the lang/ruby port into separate ports for ruby 1.8 and ruby
1.9, similar to how the lang/python ports are handled.  ruby 1.8
now installs as ruby18 and ruby 1.9 installs as ruby19.  The
included MESSAGE files for both ports let you know the symlinks to
set up if you want to make that version the default system ruby.

Split port originally started by bernd@@, many changes since by me,
help and support from jcs@@, landry@@, jasper@@, and sthen@@.

This causes a large amount of fallout in dependent ruby ports,
which will be committed shortly.

OK jcs@@, landry@@, jasper@@, sthen@@
@
text
@d1 1
a1 1
$OpenBSD: patch-common_mk,v 1.1 2007/12/27 18:32:33 bernd Exp $
d3 1
a3 1
Build the docs and the ext stuff during the build phase so we don't have to
d6 2
a7 2
--- common.mk.orig	Thu Dec 24 10:01:58 2009
+++ common.mk	Sat Dec 26 15:31:27 2009
d13 1
a13 1
+all: $(MKFILES) $(PREP) $(RBCONFIG) $(LIBRUBY) all-extmk rdoc
@

