head	1.45;
access;
symbols
	OPENBSD_6_1:1.43.0.2
	OPENBSD_6_1_BASE:1.43
	OPENBSD_6_0:1.41.0.2
	OPENBSD_6_0_BASE:1.41
	OPENBSD_5_9:1.37.0.2
	OPENBSD_5_9_BASE:1.37
	OPENBSD_5_8:1.36.0.4
	OPENBSD_5_8_BASE:1.36
	OPENBSD_5_7:1.35.0.2
	OPENBSD_5_7_BASE:1.35
	OPENBSD_5_6:1.30.0.4
	OPENBSD_5_6_BASE:1.30
	OPENBSD_5_5:1.30.0.2
	OPENBSD_5_5_BASE:1.30
	OPENBSD_5_4:1.28.0.2
	OPENBSD_5_4_BASE:1.28
	OPENBSD_5_3:1.26.0.2
	OPENBSD_5_3_BASE:1.26
	OPENBSD_5_2:1.24.0.2
	OPENBSD_5_2_BASE:1.24
	OPENBSD_5_1_BASE:1.20
	OPENBSD_5_1:1.20.0.2
	OPENBSD_5_0:1.15.0.2
	OPENBSD_5_0_BASE:1.15
	OPENBSD_4_9:1.10.0.2
	OPENBSD_4_9_BASE:1.10;
locks; strict;
comment	@# @;


1.45
date	2017.09.16.22.54.58;	author jeremy;	state Exp;
branches;
next	1.44;
commitid	GEYS4QMl4MMO38U4;

1.44
date	2017.06.12.10.57.57;	author ajacoutot;	state Exp;
branches;
next	1.43;
commitid	Jrodt0XCK48q56Zk;

1.43
date	2016.09.01.14.23.58;	author jeremy;	state Exp;
branches;
next	1.42;
commitid	lxH8rPq0pLJAEECJ;

1.42
date	2016.08.19.19.09.34;	author jeremy;	state Exp;
branches;
next	1.41;
commitid	9VhI2kMdFGNKcRa8;

1.41
date	2016.07.15.15.53.05;	author jeremy;	state Exp;
branches;
next	1.40;
commitid	J7Wr9v5DZaPhA8g4;

1.40
date	2016.06.29.16.14.42;	author espie;	state Exp;
branches;
next	1.39;
commitid	c1yQMbJbfo0CFBcL;

1.39
date	2016.04.27.12.07.09;	author naddy;	state Exp;
branches;
next	1.38;
commitid	delzC7MPADuM0J8w;

1.38
date	2016.02.29.20.46.53;	author jeremy;	state Exp;
branches;
next	1.37;
commitid	JkjyEbujZnqp0jTC;

1.37
date	2015.12.18.17.36.31;	author jeremy;	state Exp;
branches;
next	1.36;
commitid	Kf6NGU2lhtduuafn;

1.36
date	2015.04.15.21.58.16;	author jeremy;	state Exp;
branches
	1.36.4.1;
next	1.35;
commitid	f7uSAf7SQUJZjAQo;

1.35
date	2015.02.16.22.57.09;	author naddy;	state Exp;
branches
	1.35.2.1;
next	1.34;
commitid	0dx3c9ckf7dE4tx1;

1.34
date	2014.11.14.17.51.42;	author jeremy;	state Exp;
branches;
next	1.33;
commitid	9uBx38Sgo8p9FNOV;

1.33
date	2014.11.14.17.41.50;	author jeremy;	state Exp;
branches;
next	1.32;
commitid	k0JASdFbZbdK7jQL;

1.32
date	2014.11.01.04.56.40;	author jeremy;	state Exp;
branches;
next	1.31;
commitid	NHHj3kQezLuqheK5;

1.31
date	2014.10.15.02.06.35;	author jeremy;	state Exp;
branches;
next	1.30;
commitid	YbqGQnpgercW6GRD;

1.30
date	2013.11.25.14.16.23;	author sthen;	state Exp;
branches
	1.30.2.1
	1.30.4.1;
next	1.29;

1.29
date	2013.11.24.02.27.08;	author jeremy;	state Exp;
branches;
next	1.28;

1.28
date	2013.07.17.15.48.25;	author jeremy;	state Exp;
branches
	1.28.2.1;
next	1.27;

1.27
date	2013.03.11.11.20.28;	author espie;	state Exp;
branches;
next	1.26;

1.26
date	2012.10.08.13.15.17;	author jeremy;	state Exp;
branches
	1.26.2.1;
next	1.25;

1.25
date	2012.09.18.16.02.53;	author jeremy;	state Exp;
branches;
next	1.24;

1.24
date	2012.07.03.19.58.39;	author jeremy;	state Exp;
branches;
next	1.23;

1.23
date	2012.03.30.19.03.24;	author phessler;	state Exp;
branches;
next	1.22;

1.22
date	2012.03.08.12.13.01;	author ajacoutot;	state Exp;
branches;
next	1.21;

1.21
date	2012.02.28.00.17.17;	author jeremy;	state Exp;
branches;
next	1.20;

1.20
date	2012.01.05.02.09.02;	author jeremy;	state Exp;
branches;
next	1.19;

1.19
date	2011.12.02.14.36.15;	author espie;	state Exp;
branches;
next	1.18;

1.18
date	2011.11.17.11.47.12;	author jeremy;	state Exp;
branches;
next	1.17;

1.17
date	2011.11.15.00.05.16;	author jeremy;	state Exp;
branches;
next	1.16;

1.16
date	2011.11.08.23.40.05;	author jeremy;	state Exp;
branches;
next	1.15;

1.15
date	2011.07.19.17.06.39;	author jeremy;	state Exp;
branches;
next	1.14;

1.14
date	2011.07.18.19.06.37;	author naddy;	state Exp;
branches;
next	1.13;

1.13
date	2011.07.11.04.15.19;	author jeremy;	state Exp;
branches;
next	1.12;

1.12
date	2011.05.25.18.20.43;	author jasper;	state Exp;
branches;
next	1.11;

1.11
date	2011.03.07.18.57.38;	author jeremy;	state Exp;
branches;
next	1.10;

1.10
date	2011.01.15.01.09.43;	author naddy;	state Exp;
branches
	1.10.2.1;
next	1.9;

1.9
date	2011.01.06.04.01.52;	author jeremy;	state Exp;
branches;
next	1.8;

1.8
date	2010.11.24.21.26.19;	author jeremy;	state Exp;
branches;
next	1.7;

1.7
date	2010.11.17.08.05.18;	author espie;	state Exp;
branches;
next	1.6;

1.6
date	2010.11.07.19.12.42;	author espie;	state Exp;
branches;
next	1.5;

1.5
date	2010.11.06.10.18.38;	author espie;	state Exp;
branches;
next	1.4;

1.4
date	2010.10.24.21.24.04;	author ajacoutot;	state Exp;
branches;
next	1.3;

1.3
date	2010.10.18.19.20.42;	author espie;	state Exp;
branches;
next	1.2;

1.2
date	2010.10.12.15.39.06;	author jeremy;	state Exp;
branches;
next	1.1;

1.1
date	2010.09.23.21.58.50;	author jeremy;	state Exp;
branches;
next	;

1.10.2.1
date	2011.03.09.16.04.05;	author jasper;	state Exp;
branches;
next	1.10.2.2;

1.10.2.2
date	2011.05.25.18.21.18;	author jasper;	state Exp;
branches;
next	;

1.26.2.1
date	2013.07.18.18.57.35;	author jeremy;	state Exp;
branches;
next	;

1.28.2.1
date	2013.11.26.13.49.05;	author jasper;	state Exp;
branches;
next	;

1.30.2.1
date	2014.11.17.10.21.49;	author jasper;	state Exp;
branches;
next	;
commitid	pGV5LpHnyFLnV1OJ;

1.30.4.1
date	2014.11.17.10.15.29;	author jasper;	state Exp;
branches;
next	1.30.4.2;
commitid	ZLz9L4D7WtOtgDkN;

1.30.4.2
date	2015.04.16.18.48.53;	author jeremy;	state Exp;
branches;
next	;
commitid	SvtHb7S3fP5jbSUW;

1.35.2.1
date	2015.04.21.10.32.41;	author jasper;	state Exp;
branches;
next	;
commitid	lReEEhWci49O9H8q;

1.36.4.1
date	2015.12.24.10.39.41;	author jasper;	state Exp;
branches;
next	;
commitid	D5kBozkK9C1lNHkQ;


desc
@@


1.45
log
@Backport security fixes from ruby 2.2.8 to ruby 1.8.7.  Fixes
CVE-2017-0898 and CVE-2017-10784.  Regen patches while here.
@
text
@# $OpenBSD: Makefile,v 1.44 2017/06/12 10:57:57 ajacoutot Exp $

COMMENT-main=		object oriented script language with threads
COMMENT-iconv=		libiconv interface for ruby
COMMENT-gdbm=		gdbm interface for ruby
COMMENT-tk=		tk interface for ruby
COMMENT-ri_docs=	ri documentation files ruby

VERSION=		1.8.7
PATCHLEVEL=		374
RUBYLIBREV=		1.8

SHARED_LIBS=		ruby18 0.0
PKGNAME-main=		ruby-${VERSION}.${PATCHLEVEL}
PKGNAME-iconv=		ruby-iconv-${VERSION}.${PATCHLEVEL}
PKGNAME-gdbm=		ruby-gdbm-${VERSION}.${PATCHLEVEL}
PKGNAME-tk=		ruby-tk-${VERSION}.${PATCHLEVEL}
PKGNAME-ri_docs=	ruby-ri_docs-${VERSION}.${PATCHLEVEL}

PKG_ARCH-ri_docs=	*
PKGSPEC-main=		ruby->=1.8,<1.9

REVISION-main=		9
REVISION-iconv=		0
REVISION-ri_docs=	2

CONFIGURE_ARGS=		--program-suffix=18 \
			--enable-ipv6 \
			--with-dbm-type=bogus \
			--with-opt-dir="${LOCALBASE}" \
			--disable-option-checking

CONFIGURE_ENV=		LIBruby18_VERSION=${LIBruby18_VERSION}

WANTLIB-main= 		c m readline termcap util crypto ncurses ssl z
LIB_DEPENDS-main=
RUN_DEPENDS-main=

PSEUDO_FLAVORS= 	no_tk no_ri_docs bootstrap
# Do not build the RI docs on slow arches
.if ${MACHINE_ARCH:Marm}
FLAVOR?=		no_ri_docs bootstrap
.else
FLAVOR?=
.endif

MULTI_PACKAGES=		-main -iconv -gdbm -tk -ri_docs
.include <bsd.port.arch.mk>

WANTLIB-iconv =		c iconv m ruby18
LIB_DEPENDS-iconv =	converters/libiconv \
			lang/ruby/${REV},-main
RUN_DEPENDS-iconv =

WANTLIB-gdbm =		c gdbm>=3 m ruby18
LIB_DEPENDS-gdbm =	databases/gdbm \
			lang/ruby/${REV},-main
RUN_DEPENDS-gdbm =       

.if ${BUILD_PACKAGES:M-tk}
CONFIGURE_ARGS+=	--with-tcl-include=${PREFIX}/include/tcl8.5 \
			--with-tk-include=${PREFIX}/include/tk8.5 \
			--with-X11-dir=${X11BASE}
WANTLIB-tk =		X11 c m ruby18 tcl85 tk85
LIB_DEPENDS-tk =	tk->=8.5,<8.6:x11/tk/8.5 \
			lang/ruby/${REV},-main
RUN_DEPENDS-tk =		
.endif

.if ${BUILD_PACKAGES:M-ri_docs}
ALL_TARGET =		all rdoc
INSTALL_TARGET =	install install-doc
.endif

post-install:
	${FIX_RBCONFIG}

# Known regression failures in OpenSSL extension on sparc64
# Known regression failure in IO.readpartial on all arch
# Known regression failure in test_connection_refused_in_request on all arch
TEST_DEPENDS=	${FULLPKGNAME-main}:${BUILD_PKGPATH}

.include <bsd.port.mk>
@


1.44
log
@Remove trailing lines.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2016/09/01 14:23:58 jeremy Exp $
d23 1
a23 1
REVISION-main=		8
d25 1
a25 1
REVISION-ri_docs=	1
@


1.43
log
@Remove references to sparc and vax
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2016/08/19 19:09:34 jeremy Exp $
d24 1
@


1.42
log
@Add USE_WXNEEDED to ruby, to get devel/ruby-therubyracer working

Original diff from awolk@@, OK sthen@@

Change to use USE_WXNEEDED by me
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2016/07/15 15:53:05 jeremy Exp $
d40 1
a40 1
.if ${MACHINE_ARCH:Marm} || ${MACHINE_ARCH:Msparc} || ${MACHINE_ARCH:Mvax}
@


1.41
log
@Fix REVISION-main bumps
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2016/06/29 16:14:42 espie Exp $
d23 1
a23 1
REVISION-main=		7
@


1.40
log
@add is-branch to all trivial ports that exist as multiple branches.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2016/04/27 12:07:09 naddy Exp $
d23 1
a23 1
REVISION-main=		6
@


1.39
log
@replace the libiconv module with regular dependencies; ok jeremy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2016/02/29 20:46:53 jeremy Exp $
d23 1
a23 1
REVISION-main=		5
@


1.38
log
@Make dpb not try to build -ri_docs subpackages on slow arches

The previous way was bogus.  Use bsd.port.arch.mk to remove
MULTI_PACKAGES instead of having the lack of no_* FLAVOR add them.

Change the no_x11 PSUEDO_FLAVOR to no_tk, since what it does is turn
off the -tk subpackage.

Remove post-install target from Makefile.inc, and use a manually
post-install in every version.  This is necessary due to
bsd.port.arch.mk usage.

Noticed by tobiasu@@
Guidance from espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2015/12/18 17:36:31 jeremy Exp $
d24 1
a24 1
REVISION-ri_docs=	0
a33 2
MODULES=		converters/libiconv

d49 2
a50 2
WANTLIB-iconv =		${MODLIBICONV_WANTLIB} c m ruby18
LIB_DEPENDS-iconv =	${MODLIBICONV_LIB_DEPENDS} \
d52 1
a52 1
RUN_DEPENDS-iconv =	${MODLIBICONV_RUN_DEPENDS}
d64 1
a64 1
LIB_DEPENDS-tk =		tk->=8.5,<8.6:x11/tk/8.5 \
@


1.37
log
@Backport fix for CVE-2009-5147 and CVE-2015-7551 from r23405
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2015/04/15 21:58:16 jeremy Exp $
d40 1
a40 1
PSEUDO_FLAVORS= 	no_x11 no_ri_docs
d43 1
a43 1
FLAVOR?=		no_ri_docs
d48 2
a49 1
MULTI_PACKAGES=		-main -iconv -gdbm
d61 1
a61 2
.if !${FLAVOR:Mno_x11}
MULTI_PACKAGES+=	-tk
d71 1
a71 2
.if !${FLAVOR:Mno_ri_docs}
MULTI_PACKAGES +=	-ri_docs
d75 3
@


1.36
log
@Add patch to fix overly permissive matching of hostnames, CVE-2015-1855.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2015/02/16 22:57:09 naddy Exp $
d23 1
a23 1
REVISION-main=		4
@


1.36.4.1
log
@Security fixes for CVE-2009-5147 and CVE-2015-7551
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2015/04/15 21:58:16 jeremy Exp $
d23 1
a23 1
REVISION-main=		5
@


1.35
log
@Drop USE_GROFF from ports where the formatting differences are acceptable
or mandoc provides the more useful output.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2014/11/14 17:51:42 jeremy Exp $
d23 1
a23 1
REVISION-main=		3
@


1.35.2.1
log
@Backport fix for regression introduced by fix for CVE-2013-4073
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2015/02/16 22:57:09 naddy Exp $
d23 1
a23 1
REVISION-main=		4
@


1.34
log
@Fix build of ri-docs subpackage.

The previously backported patch was handled slightly differently by
upstream, so one of the methods no longer exists, and needs to be
removed from the ri docs.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2014/11/14 17:41:50 jeremy Exp $
a34 1
USE_GROFF =		Yes
@


1.33
log
@Backport security fix for CVE-2014-8090

While here, remove previously backported patch that was already handled
upstream.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2014/11/01 04:56:40 jeremy Exp $
d24 1
@


1.32
log
@Backport security fix for CVE-2014-8080
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2014/10/15 02:06:35 jeremy Exp $
d23 1
a23 1
REVISION-main=		2
@


1.31
log
@Allow gem install to work for gems with C extensions.  As a bonus,
remove the need to use FAKE_AS_ROOT = always-wrap.

landry@@ phessler@@ naddy@@ in favor
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2013/11/25 14:16:23 sthen Exp $
d23 1
a23 1
REVISION-main=		1
@


1.30
log
@kill VMEM_WARNING
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2013/11/24 02:27:08 jeremy Exp $
d11 1
d23 1
a23 1
REVISION-main=		0
@


1.30.2.1
log
@security fix for CVE-2014-8090

committing on behalf of jeremy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2013/11/25 14:16:23 sthen Exp $
d22 1
a22 1
REVISION-main=		1
@


1.30.4.1
log
@security fix for CVE-2014-8090

committing on behalf of jeremy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2013/11/25 14:16:23 sthen Exp $
d22 1
a22 2
REVISION-main=		1
REVISION-ri_docs=	0
@


1.30.4.2
log
@Add patch to fix overly permissive matching of hostnames, CVE-2015-1855.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30.4.1 2014/11/17 10:15:29 jasper Exp $
d22 1
a22 1
REVISION-main=		2
@


1.29
log
@Add patch to fix heap overflow in floating point parser (CVE-2013-4164).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2013/07/17 15:48:25 jeremy Exp $
a73 1
VMEM_WARNING =		Yes
@


1.28
log
@Update to ruby 1.8.7-p374, fixing CVE-2013-4073, with an extra patch
to fix a regression.  This will probably be the last official
release of ruby 1.8, since it is now completely unsupported upstream.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2013/03/11 11:20:28 espie Exp $
d21 2
@


1.28.2.1
log
@backport security fix for CVE-2013-4164

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2013/07/17 15:48:25 jeremy Exp $
a17 2

REVISION-main =		0
@


1.27
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2012/10/08 13:15:17 jeremy Exp $
d10 1
a10 1
PATCHLEVEL=		370
a17 2

REVISION-main=		1
@


1.26
log
@Backport security fix from ruby developer Shugo Maeda, similar to
SVN revision 37068.

OK jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2012/09/18 16:02:53 jeremy Exp $
d80 1
a80 1
REGRESS_DEPENDS=	${FULLPKGNAME-main}:${BUILD_PKGPATH}
@


1.26.2.1
log
@Backport security fix for CVE-2013-4073 from ruby svn r41676, along with
fix for regression from r42016.

OK jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2012/10/08 13:15:17 jeremy Exp $
d19 1
a19 1
REVISION-main=		2
@


1.25
log
@Fix a backport of a patch that never made it to ruby 1.8.7, which left
out the definition of a new function added in the patch.  Allows usage
of the ruby 1.8 socket extension with LD_BIND_NOW=1.

OK naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2012/07/03 19:58:39 jeremy Exp $
d19 1
a19 1
REVISION-main=		0
@


1.24
log
@Update to ruby 1.8.7-p370.

One of our local patches for a security fix was applied upstream, so
remove that patch.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2012/03/30 19:03:24 phessler Exp $
d18 2
@


1.23
log
@do not generate RI docs on the "slow" arches.  This takes far too long,
and too much memory.

OK jeremy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2012/03/08 12:13:01 ajacoutot Exp $
d10 1
a10 1
PATCHLEVEL=		358
a17 2

REVISION-main=		0
@


1.22
log
@Garbage collect the /dev/arandom patches.

from Brad
ok landry@@ sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2012/02/28 00:17:17 jeremy Exp $
d40 4
d45 1
@


1.21
log
@Update to 1.8.7p358
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2012/01/05 02:09:02 jeremy Exp $
d18 2
@


1.20
log
@Update to 1.8.7-p357, fixing the denial of service vulnerability
described in CERT-2011-003.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2011/12/02 14:36:15 espie Exp $
d10 1
a10 1
PATCHLEVEL=		357
@


1.19
log
@bye bye FLAVOR:L
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2011/11/17 11:47:12 jeremy Exp $
d10 1
a10 1
PATCHLEVEL=		352
a17 6

REVISION-main=		2
REVISION-iconv=		1
REVISION-gdbm=		1
REVISION-tk=		1
REVISION-ri_docs=	0
@


1.18
log
@Don't show the VMEM_WARNING when building ruby with the no_ri_docs
PSUEDO_FLAVOR, since the ri docs are the only thing that takes a
lot of memory.

OK ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2011/11/15 00:05:16 jeremy Exp $
d58 1
a58 1
.if !${FLAVOR:L:Mno_x11}
d69 1
a69 1
.if !${FLAVOR:L:Mno_ri_docs}
@


1.17
log
@Add no_ri_docs PSUEDO_FLAVOR to skip building the ri documentation,
which should allow building on arches without enough memory to
generate the ri files.  Also, set PKG_ARCH=* for the ri_docs
subpackage, so that such arches can still use the documentation,
idea from sthen@@. Original idea for PSUEDO_FLAVOR from phessler@@.

OK sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2011/11/08 23:40:05 jeremy Exp $
d73 1
@


1.16
log
@Add an -ri_docs multipackage to hold the ri documentation files.  These
aren't used very often, slow down installation significantly, and bloat
the package.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2011/07/19 17:06:39 jeremy Exp $
d23 1
d25 1
d43 1
a43 1
PSEUDO_FLAVORS= 	no_x11
d46 1
a46 1
MULTI_PACKAGES=		-main -iconv -gdbm -ri_docs
d67 6
@


1.15
log
@Override the arch setting to remove OpenBSD version from it,
so ports don't have to be bumped when OpenBSD version changes.

OK landry@@, jcs@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2011/07/18 19:06:37 naddy Exp $
d7 1
d17 1
d19 1
a19 1
REVISION-main=		1
d44 1
a44 1
MULTI_PACKAGES=		-main -iconv -gdbm
@


1.14
log
@bump revision for plist changes 4.9 -> 5.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2011/07/11 04:15:19 jeremy Exp $
d17 4
a20 4
REVISION-main=		0
REVISION-iconv=		0
REVISION-gdbm=		0
REVISION-tk=		0
@


1.13
log
@Update to 1.8.7-p352.

"looks ok to me" landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2011/05/25 18:20:43 jasper Exp $
d16 5
@


1.12
log
@Security fix for CVE-2011-0188
Ruby BigDecimal Integer Truncation Vulnerability

Fix from upstream svn. Only 64-bit hosts are affected.

ok jeremy@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2011/03/07 18:57:38 jeremy Exp $
d9 1
a9 1
PATCHLEVEL=		334
a15 2

REVISION-main=		0
@


1.11
log
@Bump to ruby 1.8.7p334, fixing two security vulnerabilities:

* FileUtils is vulnerable to symlink race attacks
* Exception methods can bypass $SAFE
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2011/01/15 01:09:43 naddy Exp $
d16 2
@


1.10
log
@bump revision for plist changes 4.8 -> 4.9
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2011/01/06 04:01:52 jeremy Exp $
d9 1
a9 1
PATCHLEVEL=		330
a15 4
REVISION-main=		0
REVISION-iconv=		0
REVISION-gdbm=		0
REVISION-tk=		0
@


1.10.2.1
log
@Security fix for CVE-2011-1004 and CVE-2011-1005.

ok jeremy@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2011/01/15 01:09:43 naddy Exp $
d16 1
a16 1
REVISION-main=		1
@


1.10.2.2
log
@Security fix for CVE-2011-0188
Ruby BigDecimal Integer Truncation Vulnerability

Fix from upstream svn. Only 64-bit hosts are affected.

ok jeremy@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10.2.1 2011/03/09 16:04:05 jasper Exp $
d16 1
a16 1
REVISION-main=		2
@


1.9
log
@Update ruby 1.8 port to 1.8.7p330, only minor bugfixes.  While here,
fix REGRESS_DEPENDS.

OK landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2010/11/24 21:26:19 jeremy Exp $
d16 4
@


1.8
log
@Add a PKGSPEC entry to restrict ports depending on lang/ruby/1.8 to
depend on ruby-1.8 and not ruby-1.9.  This PKGSPEC is slightly
different from the previous one used in ruby.port.mk, so all
dependent ports need to be REVISION bumped (which will happen soon).
In addition, since the subpackages depend on the -main package and
also had a slightly different pkgspec, they need to be bumped as well.

OK landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2010/11/17 08:05:18 espie Exp $
d9 1
a9 1
PATCHLEVEL=		302
a16 5
REVISION-main =		0
REVISION-iconv =	0
REVISION-gdbm =		0
REVISION-tk =		0

d63 1
a63 1
REGRESS_DEPENDS=	${FULLPKGNAME}:${BUILD_PKGPATH}
@


1.7
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2010/11/07 19:12:42 espie Exp $
d17 6
a22 1
REVISION-main=		0
d46 1
a46 1
			ruby->=1.8,<=1.9:lang/ruby/${REV},-main
d51 1
a51 1
			ruby->=1.8,<=1.9:lang/ruby/${REV},-main
d61 1
a61 1
			ruby->=1.8,<=1.9:lang/ruby/${REV},-main
d68 1
a68 1
REGRESS_DEPENDS=	ruby->=1.8,<=1.9:${BUILD_PKGPATH}
@


1.6
log
@convert WANTLIB on geo/lang
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2010/11/06 10:18:38 espie Exp $
d28 1
a28 1
USE_GROFF =	Yes
d41 1
a41 1
			:ruby->=1.8,<=1.9:lang/ruby/${REV},-main
d44 3
a46 3
WANTLIB-gdbm =		c gdbm.>=3 m ruby18
LIB_DEPENDS-gdbm =	::databases/gdbm \
			:ruby->=1.8,<=1.9:lang/ruby/${REV},-main
d55 2
a56 2
LIB_DEPENDS-tk =		:tk->=8.5,<8.6:x11/tk/8.5 \
			:ruby->=1.8,<=1.9:lang/ruby/${REV},-main
d63 1
a63 1
REGRESS_DEPENDS=	:ruby->=1.8,<=1.9:${BUILD_PKGPATH}
@


1.5
log
@convert libiconv to new wantlib
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2010/10/24 21:24:04 ajacoutot Exp $
d39 2
a40 2
WANTLIB-iconv=		${MODLIBICONV_WANTLIB} c m ruby18
LIB_DEPENDS-iconv=	${MODLIBICONV_LIB_DEPENDS} \
d42 1
a42 1
RUN_DEPENDS-iconv=	${MODLIBICONV_RUN_DEPENDS}
d44 2
a45 2
WANTLIB-gdbm=		c gdbm m ruby18
LIB_DEPENDS-gdbm=	gdbm.>=3::databases/gdbm \
d47 1
a47 1
RUN_DEPENDS-gdbm=       
d54 2
a55 2
WANTLIB-tk=		X11 c m ruby18 tcl85 tk85
LIB_DEPENDS-tk=		:tk->=8.5,<8.6:x11/tk/8.5 \
d57 1
a57 1
RUN_DEPENDS-tk=		
@


1.4
log
@Remove USE_X11.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2010/10/18 19:20:42 espie Exp $
d39 1
a39 1
WANTLIB-iconv=		c m ruby18
@


1.3
log
@USE_GROFF=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2010/10/12 15:39:06 jeremy Exp $
a49 1
USE_X11=		Yes
@


1.2
log
@Modify FileUtils.mkdir_p to behave more like mkdir(1) -p. Instead of
attempting to create all intermediate directories and rescuing failures,
don't attempt to create directories that already exist.  Fixes systrace
warnings when building ruby ports.

ok landry
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1 2010/09/23 21:58:50 jeremy Exp $
d28 1
@


1.1
log
@Split the lang/ruby port into separate ports for ruby 1.8 and ruby
1.9, similar to how the lang/python ports are handled.  ruby 1.8
now installs as ruby18 and ruby 1.9 installs as ruby19.  The
included MESSAGE files for both ports let you know the symlinks to
set up if you want to make that version the default system ruby.

Split port originally started by bernd@@, many changes since by me,
help and support from jcs@@, landry@@, jasper@@, and sthen@@.

This causes a large amount of fallout in dependent ruby ports,
which will be committed shortly.

OK jcs@@, landry@@, jasper@@, sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.66 2009/02/09 20:48:23 naddy Exp $
d16 2
@

