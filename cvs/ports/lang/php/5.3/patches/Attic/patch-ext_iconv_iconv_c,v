head	1.4;
access;
symbols
	OPENBSD_5_7:1.3.0.16
	OPENBSD_5_7_BASE:1.3
	OPENBSD_5_6:1.3.0.14
	OPENBSD_5_6_BASE:1.3
	OPENBSD_5_5:1.3.0.12
	OPENBSD_5_5_BASE:1.3
	OPENBSD_5_4:1.3.0.10
	OPENBSD_5_4_BASE:1.3
	OPENBSD_5_3:1.3.0.8
	OPENBSD_5_3_BASE:1.3
	OPENBSD_5_2:1.3.0.6
	OPENBSD_5_2_BASE:1.3
	OPENBSD_5_1_BASE:1.3
	OPENBSD_5_1:1.3.0.4
	OPENBSD_5_0:1.3.0.2
	OPENBSD_5_0_BASE:1.3
	OPENBSD_4_9:1.2.0.2
	OPENBSD_4_9_BASE:1.2
	OPENBSD_4_8:1.1.1.1.0.2
	OPENBSD_4_8_BASE:1.1.1.1
	robert_20100627:1.1.1.1
	robert:1.1.1;
locks; strict;
comment	@# @;


1.4
date	2015.06.10.12.53.49;	author robert;	state dead;
branches;
next	1.3;
commitid	SoY9NzRxZwkmSXir;

1.3
date	2011.06.18.19.49.50;	author sthen;	state Exp;
branches;
next	1.2;

1.2
date	2011.01.05.09.31.23;	author robert;	state Exp;
branches;
next	1.1;

1.1
date	2010.06.27.20.28.46;	author robert;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2010.06.27.20.28.46;	author robert;	state Exp;
branches;
next	;


desc
@@


1.4
log
@bye-bye php-5.3; prodded by aja@@
@
text
@$OpenBSD: patch-ext_iconv_iconv_c,v 1.3 2011/06/18 19:49:50 sthen Exp $
--- ext/iconv/iconv.c.orig.port	Wed Dec  1 14:03:36 2010
+++ ext/iconv/iconv.c	Sat Jun 18 12:14:49 2011
@@@@ -334,7 +334,7 @@@@ static php_iconv_err_t _php_iconv_appendl(smart_str *d
 
 			out_p = (d)->c + (d)->len;
 
-			if (iconv(cd, (char **)&in_p, &in_left, (char **) &out_p, &out_left) == (size_t)-1) {
+			if (iconv(cd, (const char **)&in_p, &in_left, (char **) &out_p, &out_left) == (size_t)-1) {
 #if ICONV_SUPPORTS_ERRNO
 				switch (errno) { 
 					case EINVAL:
@@@@ -498,7 +498,7 @@@@ PHP_ICONV_API php_iconv_err_t php_iconv_string(const c
 	out_p = out_buf;
 
 	while (in_left > 0) {
-		result = iconv(cd, (char **) &in_p, &in_left, (char **) &out_p, &out_left);
+		result = iconv(cd, (const char **) &in_p, &in_left, (char **) &out_p, &out_left);
 		out_size = bsz - out_left;
 		if (result == (size_t)(-1)) {
 			if (errno == E2BIG && in_left > 0) {
@@@@ -612,7 +612,7 @@@@ static php_iconv_err_t _php_iconv_strlen(unsigned int 
 
 		prev_in_left = in_left;
 
-		if (iconv(cd, (char **)&in_p, &in_left, (char **) &out_p, &out_left) == (size_t)-1) {
+		if (iconv(cd, (const char **)&in_p, &in_left, (char **) &out_p, &out_left) == (size_t)-1) {
 			if (prev_in_left == in_left) {
 				break;
 			}
@@@@ -733,7 +733,7 @@@@ static php_iconv_err_t _php_iconv_substr(smart_str *pr
 
 		prev_in_left = in_left;
 
-		if (iconv(cd1, (char **)&in_p, &in_left, (char **) &out_p, &out_left) == (size_t)-1) {
+		if (iconv(cd1, (const char **)&in_p, &in_left, (char **) &out_p, &out_left) == (size_t)-1) {
 			if (prev_in_left == in_left) {
 				break;
 			}
@@@@ -865,7 +865,7 @@@@ static php_iconv_err_t _php_iconv_strpos(unsigned int 
 
 		prev_in_left = in_left;
 
-		if (iconv(cd, (char **)&in_p, &in_left, (char **) &out_p, &out_left) == (size_t)-1) {
+		if (iconv(cd, (const char **)&in_p, &in_left, (char **) &out_p, &out_left) == (size_t)-1) {
 			if (prev_in_left == in_left) {
 #if ICONV_SUPPORTS_ERRNO
 				switch (errno) {
@@@@ -1114,7 +1114,7 @@@@ static php_iconv_err_t _php_iconv_mime_encode(smart_st
 
 					out_left = out_size - out_reserved;
 
-					if (iconv(cd, (char **)&in_p, &in_left, (char **) &out_p, &out_left) == (size_t)-1) {
+					if (iconv(cd, (const char **)&in_p, &in_left, (char **) &out_p, &out_left) == (size_t)-1) {
 #if ICONV_SUPPORTS_ERRNO
 						switch (errno) {
 							case EINVAL:
@@@@ -1214,7 +1214,7 @@@@ static php_iconv_err_t _php_iconv_mime_encode(smart_st
 					out_p = buf;
 					out_left = out_size;
 
-					if (iconv(cd, (char **)&in_p, &in_left, (char **) &out_p, &out_left) == (size_t)-1) {
+					if (iconv(cd, (const char **)&in_p, &in_left, (char **) &out_p, &out_left) == (size_t)-1) {
 #if ICONV_SUPPORTS_ERRNO
 						switch (errno) {
 							case EINVAL:
@@@@ -2542,7 +2542,7 @@@@ static int php_iconv_stream_filter_append_bucket(
 		tcnt = self->stub_len;
 
 		while (tcnt > 0) {
-			if (iconv(self->cd, &pt, &tcnt, &pd, &ocnt) == (size_t)-1) {
+			if (iconv(self->cd, (const char **)&pt, &tcnt, &pd, &ocnt) == (size_t)-1) {
 #if ICONV_SUPPORTS_ERRNO
 				switch (errno) {
 					case EILSEQ:
@


1.3
log
@Use PATCHORIG, regen patches and rename the files which didn't match the
normal update-patches filenames. This avoids update-patches picking up the
.orig files in PHP distfiles and make it easier to keep in-sync. ok robert@@
@
text
@d1 1
a1 1
$OpenBSD$
@


1.2
log
@update both to their current version 5.3.4 and 5.2.16 and fix wantlibs.
update patches while here
@
text
@d1 3
a3 2
--- ext/iconv/iconv.c.orig	Wed Dec  1 15:03:36 2010
+++ ext/iconv/iconv.c	Wed Jan  5 10:02:06 2011
@


1.1
log
@Initial revision
@
text
@d1 3
a3 3
--- ext/iconv/iconv.c.orig	Thu Nov  1 20:13:49 2007
+++ ext/iconv/iconv.c	Tue Nov 13 11:45:09 2007
@@@@ -345,7 +345,7 @@@@ static php_iconv_err_t _php_iconv_appendl(smart_str *d
d12 1
a12 1
@@@@ -509,7 +509,7 @@@@ PHP_ICONV_API php_iconv_err_t php_iconv_string(const c
d21 1
a21 1
@@@@ -623,7 +623,7 @@@@ static php_iconv_err_t _php_iconv_strlen(unsigned int 
d30 1
a30 1
@@@@ -744,7 +744,7 @@@@ static php_iconv_err_t _php_iconv_substr(smart_str *pr
d39 1
a39 1
@@@@ -876,7 +876,7 @@@@ static php_iconv_err_t _php_iconv_strpos(unsigned int 
d48 1
a48 1
@@@@ -1125,7 +1125,7 @@@@ static php_iconv_err_t _php_iconv_mime_encode(smart_st
d57 1
a57 1
@@@@ -1225,7 +1225,7 @@@@ static php_iconv_err_t _php_iconv_mime_encode(smart_st
d66 1
a66 1
@@@@ -2534,7 +2534,7 @@@@ static int php_iconv_stream_filter_append_bucket(
@


1.1.1.1
log
@Import a reworked port of php to lang/php. The basic difference is that
there are no core and extensions packages anymore, everything is built by
the main ports itself and the package names have changed to php-${V} or
php-mysql-${V} for modules.

The new ports allows you to install all of the php versions just like python
so you can actually run different webservers with different versions of php
because you can't load two modules to one. You can only do that with fastcgi.

The port tries to share all the files that can be shared and the different
extensions are located in the local version's Makefile instead of Makefile.inc.

The other change is that *all* of the configuration has moved to /etc out
of /var/www because that was a realy stupid concept, since apache if you
use it chrooted, will load all of the extensions before doing the actual
chroot.

This port is not linked to the build yet because several issues have to
be resolved first, like providing a way to update from php5-* packages,
and probably other things that do not come into my mind right now,
because the Bullfrog is making me crazy.
@
text
@@
