head	1.7;
access;
symbols
	OPENBSD_5_7:1.6.0.2
	OPENBSD_5_7_BASE:1.6
	OPENBSD_5_6:1.5.0.2
	OPENBSD_5_6_BASE:1.5
	OPENBSD_5_5:1.4.0.6
	OPENBSD_5_5_BASE:1.4
	OPENBSD_5_4:1.4.0.4
	OPENBSD_5_4_BASE:1.4
	OPENBSD_5_3:1.4.0.2
	OPENBSD_5_3_BASE:1.4
	OPENBSD_5_2:1.3.0.4
	OPENBSD_5_2_BASE:1.3
	OPENBSD_5_1_BASE:1.3
	OPENBSD_5_1:1.3.0.2;
locks; strict;
comment	@# @;


1.7
date	2015.06.10.12.53.49;	author robert;	state dead;
branches;
next	1.6;
commitid	SoY9NzRxZwkmSXir;

1.6
date	2014.09.11.19.09.01;	author robert;	state Exp;
branches;
next	1.5;
commitid	kmiinGLnbjdLOUDA;

1.5
date	2014.03.27.10.41.21;	author sthen;	state Exp;
branches
	1.5.2.1;
next	1.4;

1.4
date	2012.08.05.12.00.54;	author sthen;	state Exp;
branches;
next	1.3;

1.3
date	2012.01.21.23.59.43;	author sthen;	state Exp;
branches;
next	1.2;

1.2
date	2012.01.21.23.34.35;	author sthen;	state dead;
branches;
next	1.1;

1.1
date	2012.01.13.17.59.08;	author sthen;	state Exp;
branches;
next	;

1.5.2.1
date	2014.09.12.18.42.54;	author robert;	state Exp;
branches;
next	;
commitid	7Ukt7I2Y7gM0b0Xr;


desc
@@


1.7
log
@bye-bye php-5.3; prodded by aja@@
@
text
@$OpenBSD: patch-sapi_fpm_php-fpm_conf_in,v 1.6 2014/09/11 19:09:01 robert Exp $
--- sapi/fpm/php-fpm.conf.in.orig.port	Thu Sep 11 20:56:35 2014
+++ sapi/fpm/php-fpm.conf.in	Thu Sep 11 20:57:03 2014
@@@@ -148,7 +148,7 @@@@ group = @@php_fpm_group@@
 ;                            specific port;
 ;   '/path/to/unix/socket' - to listen on a unix socket.
 ; Note: This value is mandatory.
-listen = 127.0.0.1:9000
+listen = /var/www/run/php-fpm.sock
 
 ; Set listen(2) backlog. A value of '-1' means unlimited.
 ; Default Value: 128 (-1 on FreeBSD and OpenBSD)
@@@@ -159,9 +159,9 @@@@ listen = 127.0.0.1:9000
 ; BSD-derived systems allow connections regardless of permissions. 
 ; Default Values: user and group are set as the running user
 ;                 mode is set to 0660
-;listen.owner = @@php_fpm_user@@
-;listen.group = @@php_fpm_group@@
-;listen.mode = 0660
++listen.owner = www
++listen.group = www
++listen.mode = 0660
  
 ; List of ipv4 addresses of FastCGI clients which are allowed to connect.
 ; Equivalent to the FCGI_WEB_SERVER_ADDRS environment variable in the original
@@@@ -453,7 +453,7 @@@@ pm.max_spare_servers = 3
 ;       possible. However, all PHP paths will be relative to the chroot
 ;       (error_log, sessions.save_path, ...).
 ; Default Value: not set
-;chroot = 
+chroot = /var/www
  
 ; Chdir to this directory at the start.
 ; Note: relative path can be used.
@


1.6
log
@update to 5.3.29; includes security fix for CVE-2014-3981 and CVE-2014-3515
@
text
@d1 1
a1 1
$OpenBSD$
@


1.5
log
@switch sample php-fpm config to using unix sockets. ok robert@@,
tested with new nginx sample config, everything in chroot.
@
text
@d1 3
a3 3
$OpenBSD: patch-sapi_fpm_php-fpm_conf_in,v 1.1.1.1 2013/08/07 16:35:46 robert Exp $
--- sapi/fpm/php-fpm.conf.in.orig.port	Tue Dec 10 19:04:57 2013
+++ sapi/fpm/php-fpm.conf.in	Wed Mar 26 23:03:21 2014
d16 1
a16 1
 ;                 mode is set to 0666
d19 4
a22 4
-;listen.mode = 0666
+listen.owner = www
+listen.group = www
+listen.mode = 0660
@


1.5.2.1
log
@MFC PHP security update to 5.3.29; includes security fix for CVE-2014-3981 and CVE-2014-3515

ok jasper@@
@
text
@d1 3
a3 3
$OpenBSD: patch-sapi_fpm_php-fpm_conf_in,v 1.6 2014/09/11 19:09:01 robert Exp $
--- sapi/fpm/php-fpm.conf.in.orig.port	Thu Sep 11 20:56:35 2014
+++ sapi/fpm/php-fpm.conf.in	Thu Sep 11 20:57:03 2014
d16 1
a16 1
 ;                 mode is set to 0660
d19 4
a22 4
-;listen.mode = 0660
++listen.owner = www
++listen.group = www
++listen.mode = 0660
@


1.4
log
@update PHP to 5.3.15 for real this time (committed previous from wrong machine)
@
text
@d1 25
a25 3
$OpenBSD: patch-sapi_fpm_php-fpm_conf_in,v 1.3 2012/01/21 23:59:43 sthen Exp $
--- sapi/fpm/php-fpm.conf.in.orig.port	Thu Jul 12 23:17:37 2012
+++ sapi/fpm/php-fpm.conf.in	Sat Jul 21 10:36:15 2012
@


1.3
log
@Enable chroot in the example php-fpm.conf file, mention it in DESCR-fpm.
ok robert@@
@
text
@d1 4
a4 4
$OpenBSD$
--- sapi/fpm/php-fpm.conf.in.orig.port	Sat Oct  8 22:04:10 2011
+++ sapi/fpm/php-fpm.conf.in	Fri Jan 20 13:55:43 2012
@@@@ -437,7 +437,7 @@@@ pm.max_spare_servers = 3
@


1.2
log
@update php-5.3 to 5.3.9
- SECURITY fixes: CVE-2012-0057 CVE-2011-4566 CVE-2012-0788 CVE-2012-0789
- sync WANTLIB for php-5.2 while there

ok robert@@
@
text
@d1 9
a9 15
$OpenBSD: patch-sapi_fpm_php-fpm_conf_in,v 1.1 2012/01/13 17:59:08 sthen Exp $
--- sapi/fpm/php-fpm.conf.in.orig.port	Mon Jul  4 22:22:56 2011
+++ sapi/fpm/php-fpm.conf.in	Fri Jan 13 00:28:10 2012
@@@@ -168,12 +168,12 @@@@ pm.max_children = 50
 ; The desired minimum number of idle server processes.
 ; Note: Used only when pm is set to 'dynamic'
 ; Note: Mandatory when pm is set to 'dynamic'
-;pm.min_spare_servers = 5
+pm.min_spare_servers = 5
 
 ; The desired maximum number of idle server processes.
 ; Note: Used only when pm is set to 'dynamic'
 ; Note: Mandatory when pm is set to 'dynamic'
-;pm.max_spare_servers = 35
+pm.max_spare_servers = 35
d11 2
a12 2
 ; The number of requests each child process should execute before respawning.
 ; This can be useful to work around memory leaks in 3rd party libraries. For
@


1.1
log
@- set SHARED_ONLY and roll PFRAG.shared-main into PLIST-main

- uncomment a couple of lines in the default php-fpm.conf so you
don't have to make any changes before it will start up

- add missing crypt_blowfish.h header to PLIST-main

ok robert@@
@
text
@d1 1
a1 1
$OpenBSD$
@

