head	1.44;
access;
symbols
	OPENBSD_5_4:1.43.0.2
	OPENBSD_5_4_BASE:1.43
	OPENBSD_5_3:1.33.0.2
	OPENBSD_5_3_BASE:1.33
	OPENBSD_5_2:1.29.0.2
	OPENBSD_5_2_BASE:1.29
	OPENBSD_5_1_BASE:1.22
	OPENBSD_5_1:1.22.0.2
	OPENBSD_5_0:1.17.0.2
	OPENBSD_5_0_BASE:1.17
	OPENBSD_4_9:1.6.0.2
	OPENBSD_4_9_BASE:1.6
	OPENBSD_4_8:1.1.1.1.0.2
	OPENBSD_4_8_BASE:1.1.1.1
	robert_20100627:1.1.1.1
	robert:1.1.1;
locks; strict;
comment	@# @;


1.44
date	2013.08.08.18.54.54;	author robert;	state dead;
branches;
next	1.43;

1.43
date	2013.06.22.13.30.55;	author naddy;	state Exp;
branches;
next	1.42;

1.42
date	2013.06.20.06.54.38;	author ajacoutot;	state Exp;
branches;
next	1.41;

1.41
date	2013.06.18.14.22.30;	author sthen;	state Exp;
branches;
next	1.40;

1.40
date	2013.06.17.19.30.33;	author ajacoutot;	state Exp;
branches;
next	1.39;

1.39
date	2013.06.12.20.36.33;	author brad;	state Exp;
branches;
next	1.38;

1.38
date	2013.05.26.13.43.54;	author espie;	state Exp;
branches;
next	1.37;

1.37
date	2013.05.25.00.33.09;	author brad;	state Exp;
branches;
next	1.36;

1.36
date	2013.04.18.08.38.54;	author sthen;	state Exp;
branches;
next	1.35;

1.35
date	2013.04.14.23.22.11;	author sthen;	state Exp;
branches;
next	1.34;

1.34
date	2013.03.21.08.33.52;	author landry;	state Exp;
branches;
next	1.33;

1.33
date	2012.11.30.12.56.02;	author sthen;	state Exp;
branches;
next	1.32;

1.32
date	2012.11.28.10.47.12;	author sthen;	state Exp;
branches;
next	1.31;

1.31
date	2012.09.27.16.45.51;	author ajacoutot;	state Exp;
branches;
next	1.30;

1.30
date	2012.08.23.19.19.17;	author sthen;	state Exp;
branches;
next	1.29;

1.29
date	2012.07.02.08.14.26;	author jasper;	state Exp;
branches;
next	1.28;

1.28
date	2012.06.21.06.58.51;	author ajacoutot;	state Exp;
branches;
next	1.27;

1.27
date	2012.06.17.06.49.07;	author ajacoutot;	state Exp;
branches;
next	1.26;

1.26
date	2012.06.16.12.51.07;	author sthen;	state Exp;
branches;
next	1.25;

1.25
date	2012.05.07.14.41.56;	author ajacoutot;	state Exp;
branches;
next	1.24;

1.24
date	2012.04.28.08.34.56;	author sthen;	state Exp;
branches;
next	1.23;

1.23
date	2012.04.23.17.15.18;	author espie;	state Exp;
branches;
next	1.22;

1.22
date	2012.01.29.14.53.20;	author espie;	state Exp;
branches;
next	1.21;

1.21
date	2012.01.25.11.17.22;	author sthen;	state Exp;
branches;
next	1.20;

1.20
date	2012.01.21.23.34.35;	author sthen;	state Exp;
branches;
next	1.19;

1.19
date	2012.01.13.17.59.07;	author sthen;	state Exp;
branches;
next	1.18;

1.18
date	2011.09.16.10.31.21;	author espie;	state Exp;
branches;
next	1.17;

1.17
date	2011.07.26.10.54.07;	author sthen;	state Exp;
branches;
next	1.16;

1.16
date	2011.07.22.10.28.54;	author sthen;	state Exp;
branches;
next	1.15;

1.15
date	2011.07.15.12.57.42;	author robert;	state Exp;
branches;
next	1.14;

1.14
date	2011.07.14.12.40.48;	author robert;	state Exp;
branches;
next	1.13;

1.13
date	2011.07.09.00.41.44;	author robert;	state Exp;
branches;
next	1.12;

1.12
date	2011.07.08.18.24.00;	author robert;	state Exp;
branches;
next	1.11;

1.11
date	2011.05.12.17.07.20;	author sthen;	state Exp;
branches;
next	1.10;

1.10
date	2011.05.12.14.30.12;	author robert;	state Exp;
branches;
next	1.9;

1.9
date	2011.03.26.10.23.13;	author sthen;	state Exp;
branches;
next	1.8;

1.8
date	2011.03.21.19.50.18;	author jasper;	state Exp;
branches;
next	1.7;

1.7
date	2011.03.21.18.29.07;	author ajacoutot;	state Exp;
branches;
next	1.6;

1.6
date	2011.01.17.19.30.26;	author sthen;	state Exp;
branches;
next	1.5;

1.5
date	2011.01.05.09.31.23;	author robert;	state Exp;
branches;
next	1.4;

1.4
date	2010.11.17.08.05.18;	author espie;	state Exp;
branches;
next	1.3;

1.3
date	2010.10.18.19.20.42;	author espie;	state Exp;
branches;
next	1.2;

1.2
date	2010.09.10.10.42.17;	author robert;	state Exp;
branches;
next	1.1;

1.1
date	2010.06.27.20.28.44;	author robert;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2010.06.27.20.28.44;	author robert;	state Exp;
branches;
next	;


desc
@@


1.44
log
@bye-bye php 5.2, you have been rotten dead already
welcome 5.4 to the build which replaces 5.2 by default
@
text
@# $OpenBSD: Makefile,v 1.43 2013/06/22 13:30:55 naddy Exp $

# XXX use the bundled libtool because it needs some specific options we
# don't have.
USE_LIBTOOL=	No

PV=		5.2
V=		5.2.17
SUHOSIN_PHPV=	5.2.16
SUHOSIN_P_V=	0.9.7

REVISION=		14
REVISION-main=		16
REVISION-fastcgi=	16
REVISION-fpm=		15
REVISION-imap=		16
REVISION-mysql=		16
REVISION-mysqli=	16
REVISION-pdo_mysql=	16

# remove if updating; defaulting to tar.bz2 but there's no point
# fetching new files for 5.2 unless it's updated.
DISTFILES=	php-${V}.tar.gz

INI_TEMPLATES=	dist recommended

# dbase
MULTI_PACKAGES+=	-dbase
COMMENT-dbase=		dBase database access extensions for php5
CONFIGURE_ARGS+=	--enable-dbase=shared
LIB_DEPENDS-dbase=
WANTLIB-dbase=		c pthread

# mhash
MULTI_PACKAGES+=	-mhash
COMMENT-mhash=		mhash extensions for php5
CONFIGURE_ARGS+=	--with-mhash=shared,${LOCALBASE}
LIB_DEPENDS-mhash=	security/mhash
WANTLIB-mhash=		c mhash>=2 pthread

# ncurses
MULTI_PACKAGES+=	-ncurses
COMMENT-ncurses=	ncurses extensions for php5
CONFIGURE_ARGS+=	--with-ncurses=shared,${LOCALBASE}
LIB_DEPENDS-ncurses=
WANTLIB-ncurses=	c ncurses panel pthread

# sybase-ct
MULTI_PACKAGES+=	-sybase_ct
COMMENT-sybase_ct=	sybase database access extensions for php5
CONFIGURE_ARGS+=        --with-sybase-ct=shared,${LOCALBASE}
LIB_DEPENDS-sybase_ct=	databases/freetds
WANTLIB-sybase_ct=	c ct pthread

.include <bsd.port.mk>
@


1.43
log
@bump -fastcgi after hx509 and ntlm removal from Kerberos
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2013/06/20 06:54:38 ajacoutot Exp $
@


1.42
log
@Unbreak after hx509 and ntlm removal from Kerberos.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2013/06/18 14:22:30 sthen Exp $
d14 1
a14 1
REVISION-fastcgi=	15
@


1.41
log
@tweak bumps
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2013/06/17 19:30:33 ajacoutot Exp $
d13 1
a13 1
REVISION-main=		15
d16 1
a16 1
REVISION-imap=		15
@


1.40
log
@Unbreak with new Heimdal; get rid of self-cooked krb5-config since we
have it in base now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2013/06/12 20:36:33 brad Exp $
a10 1
REVISION=	14
d12 5
a16 4
REVISION-main=		0
REVISION-fastcgi=	0
REVISION-fpm=		0
REVISION-imap=		0
@


1.39
log
@Revert back to using MySQL 5.1 for the time being. MariaDB 5.5 introduces
a new libmysqlclient non-blocking API which utilizes co-routines. The X86
specific GCC ASM co-routine support hid the fact that there was an issue.
The only fallback code so far is POSIX user contexts which OpenBSD does not
support.

Input from and Ok sthen@@ jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2013/05/26 13:43:54 espie Exp $
d13 4
@


1.38
log
@fix brad booboo.
typical
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2013/05/25 00:33:09 brad Exp $
d13 3
a15 3
REVISION-mysql=		15
REVISION-mysqli=	15
REVISION-pdo_mysql=	15
@


1.37
log
@Switch from using MySQL to using MariaDB. MariaDB is a drop-in replacement.


ok sthen aja
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2013/04/18 08:38:54 sthen Exp $
d13 3
a15 3
REVISION-mysql=		0
REVISION-mysqli=	0
REVISION-pdo_mysql=	0
@


1.36
log
@update to PHP 5.3.24 and switch 5.3 to tar.bz2 distfiles
ok (and original diff for 5.3.23) william@@, maintainer timeout
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2013/04/14 23:22:11 sthen Exp $
d12 4
@


1.35
log
@fix with libxml 2.9
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2013/03/21 08:33:52 landry Exp $
d11 1
d13 3
a15 1
REVISION=		14
@


1.34
log
@Explicitely set USE_LIBTOOL=No for ports we know don't work with our
libtool.
Joint work with ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2012/11/30 12:56:02 sthen Exp $
d12 1
a12 2
REVISION=		13
REVISION-imap=		14
@


1.33
log
@For the ap2 flavour, strip the unwanted subpackages from MULTI_PACKAGES rather
than BUILD_PACKAGES (which is for pseudo-flavours). Reported by naddy.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2012/11/28 10:47:12 sthen Exp $
d3 3
a5 2
# doesn't set USE_LIBTOOL but use the bundled one because it needs some
# specific options we don't have.
@


1.32
log
@- update to PHP 5.3.19, with a re-rolled suhosin patch (the last official
one has a patch conflict due to copyright date changes)

- don't build pointless -ap2 flavoured subpackages (modules, fpm, fastcgi)

ok robert@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2012/09/27 16:45:51 ajacoutot Exp $
a42 5

.include <bsd.port.arch.mk>
.if ${FLAVOR:L:Map2}
BUILD_PACKAGES :=	${BUILD_PACKAGES:N-fastcgi}
.endif
@


1.31
log
@Use c-client from re-alpine (php-imap).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2012/08/23 19:19:17 sthen Exp $
d43 5
@


1.30
log
@sync wantlib
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2012/07/02 08:14:26 jasper Exp $
d12 1
@


1.29
log
@Allow building against OpenSSL without SSLv2 support.

from brad
ok robert@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2012/06/21 06:58:51 ajacoutot Exp $
d11 1
a11 10
REVISION=		6
REVISION-main=		12
REVISION-curl=		8
REVISION-fastcgi=	10
REVISION-snmp=		7
REVISION-gd=		7
REVISION-dbase=		7
REVISION-mhash=		7
REVISION-ncurses=	7
REVISION-sybase_ct=	7
d20 1
a20 1
WANTLIB-dbase=
d27 1
a27 1
WANTLIB-mhash=		mhash>=2
d34 1
a34 1
WANTLIB-ncurses=	ncurses panel
d41 1
a41 1
WANTLIB-sybase_ct=	ct
@


1.28
log
@Merge pdo_sqlite into the core package; we have sqlite3 in base now.

input/ok sthen@@ robert@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2012/06/17 06:49:07 ajacoutot Exp $
d12 1
a12 1
REVISION-main=		11
@


1.27
log
@Put the ln(1) and rm(1) commands on one line so that lazy people like me
can just copy/paste it.

ok robert (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2012/06/16 12:51:07 sthen Exp $
d12 1
a12 1
REVISION-main=		10
a16 1
REVISION-pdo_sqlite =	7
@


1.26
log
@update to PHP 5.3.14, "please do" robert@@
- also build the zip extension, from wen heping
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2012/05/07 14:41:56 ajacoutot Exp $
d11 11
a21 11
REVISION=		5
REVISION-main=		9
REVISION-curl=		7
REVISION-fastcgi=	9
REVISION-snmp=		6
REVISION-gd=		6
REVISION-pdo_sqlite =	6
REVISION-dbase=		6
REVISION-mhash=		6
REVISION-ncurses=	6
REVISION-sybase_ct=	6
@


1.25
log
@Add missing @@sample.

ok robert@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2012/04/28 08:34:56 sthen Exp $
d13 1
@


1.24
log
@Let php-config-5.[23] --php-binary report the correct path. This fixes
regression tests in pecl ports.  Part of my pecl.port.mk work which was
OK'd by jasper@@ (maintainer timeout).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2012/04/23 17:15:18 espie Exp $
d17 4
@


1.23
log
@first pass at handling sqlite3 move
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2012/01/29 14:53:20 espie Exp $
d12 1
a12 1
REVISION-main=		8
@


1.22
log
@allow for simultaneous install of 5.2 and 5.3 extensions.

This solves some nasty 5.0 -> current update problems.

Up to 5.0, lots of php-using packages were depending on php-mysql-5.2.
So the dependencies would update to php-mysql-5.2 from current.
BUT the php-using packages are now depending on 5.3 -> internal conflict !

With this change, things work again. After the update, you end up with
php-mysql-5.2 AND php-mysql-5.3, you can then try pkg_delete -a to weed
out "unneeded" php*-5.2

okay sthen@@, ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2012/01/25 11:17:22 sthen Exp $
d16 1
@


1.21
log
@Update the Suhosin extension to 0.9.33 fixing CVE-2012-0807.
Stack overflow, only affects a very specific and unusual non-default
configuration: transparent cookie encryption enabled, HTTP response
splitting protection disabled, *and* a PHP application must allow
unfiltered user input to header() in order to be affected.

Good write-up at http://seclists.org/fulldisclosure/2012/Jan/295
ok robert@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2012/01/21 23:34:35 sthen Exp $
d11 1
a11 1
REVISION=		4
d13 3
a15 3
REVISION-fastcgi=	8
REVISION-snmp=		5
REVISION-gd=		5
@


1.20
log
@update php-5.3 to 5.3.9
- SECURITY fixes: CVE-2012-0057 CVE-2011-4566 CVE-2012-0788 CVE-2012-0789
- sync WANTLIB for php-5.2 while there

ok robert@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2012/01/13 17:59:07 sthen Exp $
d12 2
a13 2
REVISION-main=		7
REVISION-fastcgi=	7
@


1.19
log
@- set SHARED_ONLY and roll PFRAG.shared-main into PLIST-main

- uncomment a couple of lines in the default php-fpm.conf so you
don't have to make any changes before it will start up

- add missing crypt_blowfish.h header to PLIST-main

ok robert@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2011/09/16 10:31:21 espie Exp $
d14 1
@


1.18
log
@normalize pkgpath
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2011/07/26 10:54:07 sthen Exp $
d12 1
a12 1
REVISION-main=		6
@


1.17
log
@The php-gd module no longer has a no_x11 flavour; add an @@pkgpath so
that the new package can replace the no_x11 flavour of the old package.
ok robert@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2011/07/22 10:28:54 sthen Exp $
d11 4
a14 4
REVISION=		3
REVISION-main=		5
REVISION-fastcgi=	6
REVISION-gd=		4
@


1.16
log
@Make the description agree with the suggested commands when linking
php.conf from modules.sample into modules; ok robert@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2011/07/15 12:57:42 robert Exp $
d14 1
@


1.15
log
@fastcgi is hard without fastcgi support so enable it
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2011/07/14 12:40:48 robert Exp $
d12 1
a12 1
REVISION-main=		4
@


1.14
log
@make sure to read the correct php configuraion file, noticed by ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2011/07/09 00:41:44 robert Exp $
d13 1
a13 1
REVISION-fastcgi=	5
@


1.13
log
@fix fastcgi path
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2011/07/08 18:24:00 robert Exp $
d12 2
a13 2
REVISION-main=		3
REVISION-fastcgi=	4
@


1.12
log
@switch to lang/php
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2011/05/12 17:07:20 sthen Exp $
d13 1
a13 1
REVISION-fastcgi=	3
@


1.11
log
@fix curl updates
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2011/05/12 14:30:12 robert Exp $
d11 1
a11 1
REVISION=		0
d13 1
a13 2
REVISION-fastcgi=	1
REVISION-curl=		1
@


1.10
log
@fix update from www/php5
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2011/03/26 10:23:13 sthen Exp $
d14 1
@


1.9
log
@don't pick up an installed gsed; problem noticed by landry@@, ok robert@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2011/03/21 19:50:18 jasper Exp $
d11 3
a13 2
REVISION-main=		2
REVISION-fastcgi=	0
@


1.8
log
@- fix the autoconf bits for openssl's pkg-config files as well as a fix
for one of the autoconf tests which assumes libssl is linked with libcrypto.

from brad
ok robert@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2011/03/21 18:29:07 ajacoutot Exp $
d11 1
a11 1
REVISION-main=		1
@


1.7
log
@Add femail,-chroot as a RUN_DEPENDS for php*-core. It is super small and
is nice to have around from the start.

Idea from sthen@@

ok robert@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2011/01/17 19:30:26 sthen Exp $
d11 2
a12 1
REVISION-main=	0
@


1.6
log
@security update to 5.2.17/5.3.5; note that this port is still unlinked and WIP
ok robert@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2011/01/05 09:31:23 robert Exp $
d10 2
@


1.5
log
@update both to their current version 5.3.4 and 5.2.16 and fix wantlibs.
update patches while here
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2010/11/17 08:05:18 espie Exp $
d7 2
a8 1
V=		5.2.16
@


1.4
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2010/10/18 19:20:42 espie Exp $
d7 1
a7 2
V=		5.2.14
SUHOSIN_V=	0.9.29
a9 6
DISTNAME=	php5-${V}
PKGNAME-main=	php5-${V}
PKGNAME-fastcgi=php5-fastcgi-${V}

WRKDIST=	${WRKDIR}/php-${V}

a10 1
USE_GROFF =	Yes
a11 1
# Loadable php extensions
d17 1
d24 1
a24 1
WANTLIB-mhash=		${WANTLIB} mhash>=2
d31 1
a31 1
WANTLIB-ncurses=	${WANTLIB} ncurses panel
d38 1
a38 1
WANTLIB-sybase_ct =	${WANTLIB} ct
@


1.3
log
@USE_GROFF=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2010/09/10 10:42:17 robert Exp $
d31 2
a32 1
LIB_DEPENDS-mhash=	mhash.>=2::security/mhash
d45 2
a46 1
LIB_DEPENDS-sybase_ct=	ct::databases/freetds
@


1.2
log
@update this php port to 5.2.14 too
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2010/06/27 20:28:44 robert Exp $
d18 1
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.57 2010/03/21 09:05:55 robert Exp $
d7 1
a7 1
V=		5.2.13
d10 6
@


1.1.1.1
log
@Import a reworked port of php to lang/php. The basic difference is that
there are no core and extensions packages anymore, everything is built by
the main ports itself and the package names have changed to php-${V} or
php-mysql-${V} for modules.

The new ports allows you to install all of the php versions just like python
so you can actually run different webservers with different versions of php
because you can't load two modules to one. You can only do that with fastcgi.

The port tries to share all the files that can be shared and the different
extensions are located in the local version's Makefile instead of Makefile.inc.

The other change is that *all* of the configuration has moved to /etc out
of /var/www because that was a realy stupid concept, since apache if you
use it chrooted, will load all of the extensions before doing the actual
chroot.

This port is not linked to the build yet because several issues have to
be resolved first, like providing a way to update from php5-* packages,
and probably other things that do not come into my mind right now,
because the Bullfrog is making me crazy.
@
text
@@
