head	1.3;
access;
symbols
	OPENBSD_3_3:1.2.0.14
	OPENBSD_3_3_BASE:1.2
	OPENBSD_3_2:1.2.0.12
	OPENBSD_3_2_BASE:1.2
	OPENBSD_3_1:1.2.0.10
	OPENBSD_3_1_BASE:1.2
	OPENBSD_3_0:1.2.0.8
	OPENBSD_3_0_BASE:1.2
	OPENBSD_2_9_TRACKING_SWITCH:1.2
	OPENBSD_2_9:1.2.0.6
	OPENBSD_2_9_BASE:1.2
	OPENBSD_2_8:1.2.0.4
	OPENBSD_2_8_BASE:1.2
	OPENBSD_2_7:1.2.0.2
	OPENBSD_2_7_BASE:1.2
	OPENBSD_2_6:1.1.1.1.0.8
	OPENBSD_2_6_BASE:1.1.1.1
	OPENBSD_2_5:1.1.1.1.0.6
	OPENBSD_2_5_BASE:1.1.1.1
	OPENBSD_2_4:1.1.1.1.0.4
	OPENBSD_2_4_BASE:1.1.1.1
	OPENBSD_2_3:1.1.1.1.0.2
	OPENBSD_2_3_BASE:1.1.1.1
	STk-3_1:1.1.1.1
	STk:1.1.1;
locks; strict;
comment	@# @;


1.3
date	2003.05.19.08.50.43;	author naddy;	state dead;
branches;
next	1.2;

1.2
date	99.11.24.04.22.22;	author brad;	state Exp;
branches;
next	1.1;

1.1
date	98.02.05.17.17.22;	author don;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	98.02.05.17.17.22;	author don;	state Exp;
branches;
next	;


desc
@@


1.3
log
@* Update to 4.0.1, which also fixes DESTDIR/PREFIX handling.
* Fix dynamic loading patches.
* General clean-up.
@
text
@--- Src/dynload.c.orig	Tue Sep 17 07:20:59 1996
+++ Src/dynload.c	Tue Nov 23 18:02:17 1999
@@@@ -37,12 +37,16 @@@@
 #include <dld.h>
 #endif
 
-#if defined(NETBSD1)	     
+#if defined(NETBSD1) || defined(OPENBSD)
 #include <sys/types.h>
 #include <nlist.h>
+#ifdef USE_DYNLOAD
 #include <link.h>
+#endif
+#if defined(NETBSD1)
 #define dlerror() "dlerror"  /* dlerror() isn't implemented in NetBSD 1.0 */
 #endif
+#endif
 
 #ifdef HPUX
 #include <dl.h>
@@@@ -53,7 +57,7 @@@@
 #ifdef USE_DYNLOAD
 static SCM list_of_files = NULL;
 
-#if defined(SUNOS4) || defined(SUNOS5) || defined(NETBSD1) || defined(FREEBSD) || defined(IRIX5) || defined(OSF1) ||defined(LINUX_ELF)
+#if defined(SUNOS4) || defined(SUNOS5) || defined(NETBSD1) || defined(OPENBSD) || defined(FREEBSD) || defined(IRIX5) || defined(OSF1) ||defined(LINUX_ELF)
 
 static void load_and_call(char *path, char *fct_name)
 {
@@@@ -224,7 +228,7 @@@@
   for (p = path, slash = p-1; *p; p++)		/* Find position of last '/' */
     if (*p == '/') slash = p;
 
-#if defined(NETBSD1) || defined(FREEBSD)
+#if defined(NETBSD1) || defined(OPENBSD) || defined(FREEBSD)
   sprintf(fct_name, "_STk_init_%s", slash + 1);
 #else
   sprintf(fct_name, "STk_init_%s", slash + 1);
@


1.2
log
@- remove BROKEN tag
- upgrade to STk 3.1.1
- change maintainer to ports@@
- fix PLIST problem by using sed for some variable substitution
- fix compilation on archs that do not support dynamic loading of modules
  (fixes compilation on Alpha, needs testing on pmax and arc)
@
text
@@


1.1
log
@Initial revision
@
text
@d1 38
a38 65
*** STk-3.1/Src/dynload.c.orig	Sun Jul 21 14:24:39 1996
--- STk-3.1/Src/dynload.c	Wed Feb  4 22:56:09 1998
***************
*** 37,48 ****
  #include <dld.h>
  #endif
  
! #if defined(NETBSD1)	     
  #include <sys/types.h>
  #include <nlist.h>
  #include <link.h>
  #define dlerror() "dlerror"  /* dlerror() isn't implemented in NetBSD 1.0 */
  #endif
  
  #ifdef HPUX
  #include <dl.h>
--- 37,50 ----
  #include <dld.h>
  #endif
  
! #if defined(NETBSD1) || defined(OPENBSD)	     
  #include <sys/types.h>
  #include <nlist.h>
  #include <link.h>
+ #if defined(NETBSD1)
  #define dlerror() "dlerror"  /* dlerror() isn't implemented in NetBSD 1.0 */
  #endif
+ #endif
  
  #ifdef HPUX
  #include <dl.h>
***************
*** 53,59 ****
  #ifdef USE_DYNLOAD
  static SCM list_of_files = NULL;
  
! #if defined(SUNOS4) || defined(SUNOS5) || defined(NETBSD1) || defined(FREEBSD) || defined(IRIX5) || defined(OSF1) ||defined(LINUX_ELF)
  
  static void load_and_call(char *path, char *fct_name)
  {
--- 55,61 ----
  #ifdef USE_DYNLOAD
  static SCM list_of_files = NULL;
  
! #if defined(SUNOS4) || defined(SUNOS5) || defined(NETBSD1) || defined(OPENBSD) || defined(FREEBSD) || defined(IRIX5) || defined(OSF1) ||defined(LINUX_ELF)
  
  static void load_and_call(char *path, char *fct_name)
  {
***************
*** 224,230 ****
    for (p = path, slash = p-1; *p; p++)		/* Find position of last '/' */
      if (*p == '/') slash = p;
  
! #if defined(NETBSD1) || defined(FREEBSD)
    sprintf(fct_name, "_STk_init_%s", slash + 1);
  #else
    sprintf(fct_name, "STk_init_%s", slash + 1);
--- 226,232 ----
    for (p = path, slash = p-1; *p; p++)		/* Find position of last '/' */
      if (*p == '/') slash = p;
  
! #if defined(NETBSD1) || defined(OPENBSD) || defined(FREEBSD)
    sprintf(fct_name, "_STk_init_%s", slash + 1);
  #else
    sprintf(fct_name, "STk_init_%s", slash + 1);
@


1.1.1.1
log
@Initial import
@
text
@@
