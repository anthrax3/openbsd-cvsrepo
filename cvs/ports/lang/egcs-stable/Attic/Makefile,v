head	1.21;
access;
symbols
	OPENBSD_2_5:1.20.0.2
	OPENBSD_2_5_BASE:1.20
	OPENBSD_2_4:1.4.0.2
	OPENBSD_2_4_BASE:1.4
	rel1_1b:1.1.1.1
	OpenBSD-ports:1.1.1;
locks; strict;
comment	@# @;


1.21
date	99.08.22.16.57.13;	author espie;	state dead;
branches;
next	1.20;

1.20
date	99.04.02.22.49.19;	author espie;	state Exp;
branches;
next	1.19;

1.19
date	99.03.25.21.51.27;	author espie;	state Exp;
branches;
next	1.18;

1.18
date	99.03.21.07.51.08;	author espie;	state Exp;
branches;
next	1.17;

1.17
date	99.03.09.20.27.51;	author espie;	state Exp;
branches;
next	1.16;

1.16
date	99.03.09.17.22.51;	author espie;	state Exp;
branches;
next	1.15;

1.15
date	99.03.09.17.12.05;	author espie;	state Exp;
branches;
next	1.14;

1.14
date	99.03.02.04.41.04;	author marc;	state Exp;
branches;
next	1.13;

1.13
date	99.02.26.17.48.37;	author espie;	state Exp;
branches;
next	1.12;

1.12
date	99.02.26.16.18.43;	author espie;	state Exp;
branches;
next	1.11;

1.11
date	99.02.21.04.26.13;	author marc;	state Exp;
branches;
next	1.10;

1.10
date	99.02.18.02.37.33;	author marc;	state Exp;
branches;
next	1.9;

1.9
date	99.01.09.16.53.22;	author espie;	state Exp;
branches;
next	1.8;

1.8
date	98.12.23.02.45.07;	author espie;	state Exp;
branches;
next	1.7;

1.7
date	98.12.19.00.57.57;	author espie;	state Exp;
branches;
next	1.6;

1.6
date	98.12.10.12.24.21;	author d;	state Exp;
branches;
next	1.5;

1.5
date	98.12.04.00.24.31;	author espie;	state Exp;
branches;
next	1.4;

1.4
date	98.10.13.14.52.34;	author espie;	state Exp;
branches;
next	1.3;

1.3
date	98.10.11.14.08.23;	author espie;	state Exp;
branches;
next	1.2;

1.2
date	98.10.02.18.51.24;	author espie;	state Exp;
branches;
next	1.1;

1.1
date	98.09.26.08.53.03;	author espie;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	98.09.26.08.53.03;	author espie;	state Exp;
branches;
next	;


desc
@@


1.21
log
@Bye, bye... moved around.
@
text
@# $OpenBSD: Makefile,v 1.20 1999/04/02 22:49:19 espie Exp $

# This is a configuration file for egcs, stable release.

# it only works right with a recent bsd.port.mk.
NEED_VERSION=1.73

# we could remove this dependency by patching configure, but this is not
# reasonable...
BUILD_DEPENDS=	autoconf:${PORTSDIR}/devel/autoconf

CATEGORIES=	lang 
MAINTAINER=	Marc.Espie@@openbsd.org

# These are the only archs that don't exhibit problems right out of the
# box right now. see egcs-snapshot for credits
# If you use another platform, go to egcs-snapshot instead

ONLY_FOR_ARCHS = i386 sparc m68k alpha

# user configuration section

# see files/tests for testing procedure
#MAKE_TESTS=yes
MAKE_GXX=yes
MAKE_FORTRAN=yes
MAKE_OBJC=yes
# not in the 1.1.x releases
#MAKE_CHILL=yes
#MAKE_JAVA=yes

.if defined(MAKE_TESTS)
BUILD_DEPENDS+=	runtest:${PORTSDIR}/devel/dejagnu
.endif

# if you want/need to use the mammoth archive. 
# XXX: I'm not sure partial archives work
#ONE_ARCHIVE=yes

#### fetch section
VERSION= 1.1.2

DIRECTORY=egcs/releases/%SUBDIR%/

# getting the right archives where they should be
MASTER_SITE_SUBDIR=egcs-1.1.2
DISTNAME= egcs-${VERSION}

DIST_SUBDIR=egcs

.if defined(ONE_ARCHIVE)
DISTFILES= egcs-${VERSION}${EXTRACT_SUFX}
.else

DISTFILES=	egcs-core-${VERSION}${EXTRACT_SUFX}
.if defined(MAKE_GXX)
DISTFILES+=     egcs-g++-${VERSION}${EXTRACT_SUFX}
.endif
.if defined(MAKE_TESTS)
DISTFILES+=egcs-tests-${VERSION}${EXTRACT_SUFX}
.endif
.if defined(MAKE_FORTRAN)
DISTFILES+=egcs-g77-${VERSION}${EXTRACT_SUFX}
.endif
.if defined(MAKE_OBJC)
DISTFILES+=egcs-objc-${VERSION}${EXTRACT_SUFX}
.endif
.endif

MASTER_SITES=	ftp://egcs.cygnus.com/pub/${DIRECTORY} 
MASTER_SITES+=	ftp://ftp.lip6.fr/pub/${DIRECTORY}
MASTER_SITES+=	ftp://mirror.aarnet.edu.au/pub/${DIRECTORY}
MASTER_SITES+= ftp://go.cygnus.com/pub/ftp.cygnus.com/${DIRECTORY}
MASTER_SITES+= ftp://ftp.goof.com/pub/pcg/${DIRECTORY}
MASTER_SITES+= ftp://cambridge.cygnus.com/pub/${DIRECTORY}
MASTER_SITES+= ftp://ftp.ninemoons.com/pub/mirrors/${DIRECTORY}
MASTER_SITES+= ftp://sunsite.doc.ic.ac.uk/Mirrors/egcs.cygnus.com/pub/${DIRECTORY}
MASTER_SITES+= ftp://gd.tuwien.ac.at/gnu/${DIRECTORY}
MASTER_SITES+= ftp://ftp.ilog.fr/pub/Mirrors/${DIRECTORY}
MASTER_SITES+= ftp://ftp.irisa.fr/pub/mirrors/${DIRECTORY}
MASTER_SITES+= ftp://ftp.gts.cz/pub/MIRRORS/ftp.cygnus.com/pub/${DIRECTORY}
MASTER_SITES+= ftp://sunsite.auc.dk/pub/${DIRECTORY}
MASTER_SITES+= ftp://ftp.fu-berlin.de/unix/languages/${DIRECTORY}
MASTER_SITES+= ftp://ftp.gwdg.de/pub/cygnus/${DIRECTORY}
MASTER_SITES+= ftp://ftp.mpi-sb.mpg.de/pub/gnu/mirror/egcs.cygnus.com/${DIRECTORY}
MASTER_SITES+= ftp://ftp.uni-trier.de/pub/languages/c/implementation/${DIRECTORY}
MASTER_SITES+= ftp://ftp.sunet.se/pub/gnu/${DIRECTORY}
MASTER_SITES+= ftp://ftp.unicamp.br/pub/gnu/=EXTRA=/cygnus/${DIRECTORY}
MASTER_SITES+= ftp://ftp.lbi.ro/mirrors/ftp.cygnus.com/pub/${DIRECTORY}
MASTER_SITES+= ftp://ftp.ntua.gr/pub/gnu/${DIRECTORY}
MASTER_SITES+= ftp://ftp.nluug.nl/pub/languages/${DIRECTORY}
MASTER_SITES+= ftp://ftp.dti.ad.jp/pub/lang/${DIRECTORY}
MASTER_SITES+= ftp://ftp.win.or.jp/pub/lang/${DIRECTORY}
MASTER_SITES+= ftp://ftp.telewaynet.ad.jp/pub/lang/${DIRECTORY}
MASTER_SITES+= ftp://ftp.lab.kdd.co.jp/lang/${DIRECTORY}
MASTER_SITES+= ftp://ftp.funet.fi/mirrors/ftp.cygnus.com/pub/${DIRECTORY}
MASTER_SITES+= ftp://ftp.crc.ca/pub/packages/egcs/%SUBDIR%/
MASTER_SITES+= ftp://ftp.nc.orc.ru/pub/${DIRECTORY}
MASTER_SITES+= ftp://ftp.u-aizu.ac.jp/pub/lang/C/pcg/${DIRECTORY}
MASTER_SITES+= ftp://ftp.maisel.int-evry.fr/pub/linux/pentium/${DIRECTORY}
MASTER_SITES+= ftp://ftp.yggdrasil.com/mirrors/site/egcs.cygnus.com/pub/${DIRECTORY}
MASTER_SITES+= ftp://unix.hensa.ac.uk/mirrors/egcs.cygnus.com/pub/${DIRECTORY}

# couldn't contact those, maybe they work ?
MASTER_SITES+= ftp://sunsite.mff.cuni.cz/pub/GNU/${DIRECTORY}
MASTER_SITES+= ftp://sunsite.icm.edu.pl/pub/programming/${DIRECTORY}
MASTER_SITES+= ftp://ftp.task.gda.pl/mirror/egcs.cygnus.com/pub/${DIRECTORY}
MASTER_SITES+= ftp://ftp.lca.uevora.pt/pub/${DIRECTORY}
MASTER_SITES+= ftp://cair-archive.kaist.ac.kr/pub/gnu/${DIRECTORY}
MASTER_SITES+= ftp://linux.ihep.su/pub/cygnus/${DIRECTORY}
MASTER_SITES+= ftp://linux.cis.nctu.edu.tw/pub/packages/pcg/${DIRECTORY}

PATCH_SITES= ${MASTER_SITES}

#### 
# Patch section

PATCH_LIST=patch-core-*
.if defined(MAKE_GXX)
PATCH_LIST+=patch-g++-*
.endif
.if defined(MAKE_OBJC)
PATCH_LIST+=patch-objc-*
.endif
.if defined(MAKE_CHILL)
PATCH_LIST+=patch-chill-*
.endif
.if defined(MAKE_FORTRAN)
PATCH_LIST+=patch-g77-*
.endif
.if defined(MAKE_JAVA)
PATCH_LIST+=patch-java-*
.endif

# get openbsd configuration files where they should be
post-patch:
	${CP} -R ${FILESDIR}/config/* ${WRKSRC}
	${RM} -rf ${WRKSRC}/texinfo 
.if !defined(MAKE_GXX)
	-${RM} -rf ${WRKSRC}/gcc/cp ${WRKSRC}/libstdc++ ${WRKSRC}/libio
.endif
.if !defined(MAKE_FORTRAN)
	-${RM} -rf ${WRKSRC}/gcc/f ${WRKSRC}/libf2c
.endif
.if !defined(MAKE_OBJC)
	-${RM} -rf ${WRKSRC}/gcc/objc
.endif

####
# configure section
#

GNU_CONFIGURE=	yes

CONFIGURE_ENV=CFLAGS=-O2
CONFIGURE_ARGS= --prefix=${PREFIX} \
--verbose --with-gnu-ld --with-gnu-as \
--program-transform-name=s,^,e,

CONFIGURE_ARGS+=${CONFIGURE_SHARED}

# Not really stable yet
# CONFIGURE_ARGS+= --enable-threads=yes

SEPARATE_BUILD=simple

# rebuild configure files after patching, then move source around !!!
# XXX: don't try to autoconf the main configure file, it's not autoconf.
pre-configure:
	cd ${WRKSRC}/gcc && PATH=${PORTPATH} autoreconf
	cd ${WRKSRC}/libiberty && PATH=${PORTPATH} autoreconf

####
# build section
# should work without gmake. If it turns out to be needed, this must be 
# reported to MAINTAINER.
#USE_GMAKE= yes

# you shouldn't skip bootstrap unless you know what you're doing
# use bootstrap-lean if you're pressed for space
ALL_TARGET=bootstrap
# ALL_TARGET=bootstrap-lean
# XXX we need to override do-build to get the warnings from within make
do-build:
	@@(cd ${WRKBUILD}; \
	${MAKE_ENV} ${MAKE_PROGRAM} ${MAKE_FLAGS} ${MAKEFILE} ${ALL_TARGET} 2>warnings) || \
	(echo "*** Make bootstrap failed."; \
	echo "*** Look at ${WRKBUILD}/warnings for errors"; ${FALSE})

####
# Install & tests section 

# Tests should be performed at the end of install, since they depend upon
# having the correct flavor of libstdc++.so.

.if defined(MAKE_TESTS)
post-install:
	@@(cd ${WRKBUILD}; \
	${MAKE_ENV} ${MAKE_PROGRAM} ${MAKE_FLAGS} ${MAKEFILE} check)
.endif

PLIST=${WRKBUILD}/PLIST

M4FLAGS=-Uinclude -DDISTNAME=${DISTNAME}
.if defined(MAKE_GXX)
M4FLAGS+= -DGXX
.endif
.if defined(MAKE_FORTRAN)
M4FLAGS+= -DFORTRAN
.endif
.if defined(MAKE_CHILL)
M4FLAGS+= -DCHILL
.endif
.if defined(MAKE_OBJC)
M4FLAGS+= -DOBJC
.endif
.if defined(MAKE_JAVA)
M4FLAGS+= -DJAVA
.endif

pre-install:
	${M4} ${M4FLAGS} -DARCH=`${WRKSRC}/config.guess` \
	-DVERSION=`${SED} -e 's/.*\"\(egcs-[0-9.]*\) .*/\1/' <${WRKSRC}/gcc/version.c` \
	<${FILESDIR}/PLIST.template >${PLIST}

.include <bsd.port.mk>

.if !defined(NO_SHARED_LIBS)
M4FLAGS+= -DDYNAMIC
.endif
@


1.20
log
@*Now* we don't make tests.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 1999/03/25 21:51:27 espie Exp $
@


1.19
log
@move tests to the post-install stage, to grab the right flavor of
libstdc++.

Adjust PLIST for the right libstdc++ version.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 1999/03/21 07:51:08 espie Exp $
d24 1
a24 1
MAKE_TESTS=no
@


1.18
log
@forgot that one...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 1999/03/09 20:27:51 espie Exp $
d162 3
a182 4
.if defined(MAKE_TESTS)
ALL_TARGET+=check
.endif

d187 2
a188 2
	(echo "Make bootstrap failed."; \
	echo "Don't forget to look at ${WRKBUILD}/warnings"; ${FALSE})
d191 10
a200 1
# Install section
@


1.17
log
@Remove conflicts... somedays I hate cvs. Thanks marc@@ !
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 1999/03/09 17:22:51 espie Exp $
d38 1
a38 1
ONE_ARCHIVE=yes
d41 1
a41 2
VERSION= 1.1.2-pre2
PREPATCH= 1.1.2-pre3
d43 1
a43 1
DIRECTORY=egcs/%SUBDIR%/
d46 1
a46 5
MASTER_SITE_SUBDIR=snapshots/egcs-1.1.2-prerelease
PATCH_SITE_SUBDIR=snapshots/egcs-1.1.2-prerelease
.if defined(PREPATCH)
DISTNAME= egcs-${PREPATCH}
.else
a47 1
.endif
a50 2
PATCH_DIST_STRIP=-p1

a114 29
# prepare for new release
.if defined(PREPATCH)
.if defined(ONE_ARCHIVE)
PATCHFILES+= egcs-${VERSION}-${PREPATCH}.diff.gz
.else

PATCHFILES+= egcs-core-${VERSION}-${PREPATCH}.diff.gz
.if defined(MAKE_GXX)
PATCHFILES+= egcs-g++-${VERSION}-${PREPATCH}.diff.gz
.endif
.if defined(MAKE_TESTS)
PATCHFILES+= egcs-tests-${VERSION}-${PREPATCH}.diff.gz
.endif
.if defined(MAKE_FORTRAN)
PATCHFILES+= egcs-g77-${VERSION}-${PREPATCH}.diff.gz
.endif
.if defined(MAKE_OBJC)
PATCHFILES+= egcs-objc-${VERSION}-${PREPATCH}.diff.gz
.endif
.endif

.endif

# synch the date
.if defined(PREPATCH)
post-extract:
	${MV} ${WRKDIR}/egcs-${VERSION} ${WRKSRC}
.endif

d162 1
a162 1
SEPARATE_BUILD=yes
@


1.16
log
@Missed those
@
text
@d1 1
a1 11
<<<<<<< Makefile
# $OpenBSD: Makefile,v 1.11 1999/02/21 04:26:13 marc Exp $
=======
# OpenBSD makefile for:	egcs
# Version required:	release 1.1.1, preparing for 1.1.2
# Date created:		25 sep 98
# Whom:			Marc Espie
#
# $OpenBSD: Makefile,v 1.15 1999/03/09 17:12:05 espie Exp $
#
>>>>>>> 1.12
a14 3
<<<<<<< Makefile
NEED_VERSION=	1.67
=======
a17 1
>>>>>>> 1.12
@


1.15
log
@Update to 1.1.2-prerelease 3.
Remove all files that ARE in egcs-1.1.2-prerelease 3
@
text
@d1 3
d9 1
a9 1
# $OpenBSD: Makefile,v 1.14 1999/03/02 04:41:04 marc Exp $
d11 1
d25 3
d31 1
@


1.14
log
@fix earlier bogus changes to Makefile where a value that
was defined in bsd.port.mk was checked before bsd.port.mk was included;
this should make ports with optional shared libs build on the alpha,
again.  However, chages require the latest bsd.port.mk
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.13 1999/02/26 17:48:37 espie Exp $
d48 1
a48 1
#PREPATCH= 1.1.2-pre1
d205 1
a205 1
WRKBUILD=${WRKDIR}/build-${MACHINE_ARCH}
@


1.13
log
@Temporary: prerelease does live in the snapshot directory
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.12 1999/02/26 16:18:43 espie Exp $
d12 1
a12 1
NEED_VERSION=1.64
d203 1
a203 3
.if !defined(NO_SHARED_LIBS)
CONFIGURE_ARGS+=--enable-shared
.endif
a254 3
.if !defined(NO_SHARED_LIBS)
M4FLAGS+= -DDYNAMIC
.endif
d262 4
@


1.12
log
@Prepare for 1.1.2 release
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.9 1999/01/09 16:53:22 espie Exp $
d53 1
a53 1
MASTER_SITE_SUBDIR=releases/egcs-${VERSION}
@


1.11
log
@needs version 1.64 (or later) of bsd.port.mk
to build/install correctly; PLIST.noshared
@
text
@d2 1
a2 1
# Version required:	release 1.1b, plus pre-rel 1.1.1 patch 1/2
d6 1
a6 1
# $OpenBSD: Makefile,v 1.10 1999/02/18 02:37:33 marc Exp $
d11 7
d21 3
a23 1
NEED_VERSION=	1.64
d25 1
a25 3
# this will improve over time as more and more architectures are handled
# with some help from Jason L. Wright for sparc...
ONLY_FOR_ARCHS = i386 sparc m68k
d34 1
a34 2

# not yet in 1.1.1
d42 2
a43 1
# if you want/need to use the mammoth archive
d46 15
a60 3
VERSION=1.1.1
DISTNAME=	egcs-${VERSION}
DIRECTORY=egcs/releases/%SUBDIR%/
d62 2
a63 1
MASTER_SITE_SUBDIR=${DISTNAME}
a75 1
# to be added...
a83 2
MAKE_ENV+=LANGUAGES="c proto gcov objc"

d128 29
a156 1
PATCH_DIST_STRIP=-p1
a195 6
# we could remove the dependency on autoconf by patching configure, 
# but this is not reasonable...

USE_AUTOCONF=yes
AUTOCONF_DIR=${WRKDIR}/source/gcc

d198 1
a198 3
CONFIGURE_SCRIPT=../source/configure

#CONFIGURE_ENV=CFLAGS=-O2
d207 3
a209 1
# move source around after rebuilding configure file.
d212 2
a213 2
	-${MV} ${WRKSRC} ${WRKDIR}/source
	${MKDIR} ${WRKSRC}
d218 1
a218 1
# reported to the egcs folks
d221 2
d224 1
d231 4
a234 2
	@@(cd ${WRKSRC}; ${MAKE_ENV} ${MAKE_PROGRAM} ${MAKE_FLAGS} ${MAKEFILE} ${ALL_TARGET} 2>warnings)

d239 1
a239 1
PLIST=${WRKDIR}/PLIST
d257 1
a257 1
.if (${MACHINE_ARCH}) != "alpha")
d262 2
a263 2
	${M4} ${M4FLAGS} -DARCH=`${WRKDIR}/source/config.guess` \
	-DVERSION=`${SED} -e 's/.*\"\(egcs-[0-9.]*\) .*/\1/' <${WRKDIR}/source/gcc/version.c` \
@


1.10
log
@use NO_SHARED_LIBS instead of test for alpha;
use PLIST.noshared instead of PLIST.alpha
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.9 1999/01/09 16:53:22 espie Exp $
d13 2
@


1.9
log
@There apparently is a bug in gas that makes it necessary to bootstrap
with standard CFLAGS (-g -O2).
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.8 1998/12/23 02:45:07 espie Exp $
d164 1
a164 1
.if (${MACHINE_ARCH} != "alpha")
@


1.8
log
@*Use* the AUTOCONF macros I added to bsd.port.mk.
Thanks jason@@ for reminding me...
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.7 1998/12/19 00:57:57 espie Exp $
d9 1
a9 2
# This is a configuration file for egcs, stable release
# right now, we only configure i386.
d159 1
a159 1
CONFIGURE_ENV=CFLAGS=-O2
@


1.7
log
@Mirrors & finicking
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.6 1998/12/10 12:24:21 d Exp $
a11 4
# we could remove this dependency by patching configure, but this is not
# reasonable...
BUILD_DEPENDS=	autoconf:${PORTSDIR}/devel/autoconf

d150 6
d169 1
a169 1
# rebuild configure file after patching, then move source around !!!
a171 1
	cd ${WRKSRC}/gcc && autoconf
@


1.6
log
@australians have mirrors too
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.5 1998/12/04 00:24:31 espie Exp $
d26 1
a26 1
MAKE_TESTS=yes
d40 1
a40 1
#ONE_ARCHIVE=yes
d48 4
d66 1
d68 1
a80 1
MASTER_SITES+= ftp://sunsite.mff.cuni.cz/pub/GNU/${DIRECTORY}
a86 2
MASTER_SITES+= ftp://sunsite.icm.edu.pl/pub/programming/${DIRECTORY}
MASTER_SITES+= ftp://ftp.task.gda.pl/mirror/egcs.cygnus.com/pub/${DIRECTORY}
a88 1
MASTER_SITES+= ftp://ftp.lca.uevora.pt/pub/${DIRECTORY}
a89 1
MASTER_SITES+= ftp://moshpit.cygnus.com/pub/${DIRECTORY}
a95 1
MASTER_SITES+= ftp://cair-archive.kaist.ac.kr/pub/gnu/${DIRECTORY}
d97 1
a97 1
MASTER_SITES+= ftp://ftp.crc.ca/pub/packages/${DIRECTORY}
d99 11
a110 2
MASTER_SITES+= ftp://ftp.goof.com/pub/pcg/${DIRECTORY}
MASTER_SITES+= ftp://ftp.u-aizu.ac.jp/pub/lang/C/pcg/${DIRECTORY}
a111 1
MASTER_SITES+= ftp://ftp.maisel.int-evry.fr/pub/linux/pentium/${DIRECTORY}
d113 1
a113 1
PATCH_SITE= ${MASTER_SITES}
a114 3
#PATCHFILES= egcs-1.1b-1.1.1-prerelease.diff.gz
#PATCHFILES+= egcs-1.1.1-prerelease-1.1.1-prerelease-2.diff.gz
#PATCHFILES+= egcs-1.1.1-prerelease-2-1.1.1-prerelease-3.diff.gz
@


1.5
log
@Update to release 1.1.1
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.4 1998/10/13 14:52:34 espie Exp $
d66 1
@


1.4
log
@Clean-up.
@
text
@d2 1
a2 1
# Version required:	release 1.1b
d6 1
a6 1
# $OpenBSD: Makefile,v 1.3 1998/10/11 14:08:23 espie Exp $
d10 1
a10 2
# right now, we only configure i386, C and C++.
# g77 and objc didn't make it for 2.4.
d12 12
a23 2
DISTNAME=	egcs-1.1b
DIRECTORY=egcs/releases/egcs-1.1b/
a24 2
DISTFILES=	egcs-core-1.1b${EXTRACT_SUFX}
DISTFILES+=     egcs-g++-1.1b${EXTRACT_SUFX}
d26 29
a54 1
#DISTFILES+=egcs-tests-1.1b${EXTRACT_SUFX}
d56 7
a62 2
#DISTFILES+=egcs-g77-1.1b${EXTRACT_SUFX}
#DISTFILES+=egcs-objc-1.1b${EXTRACT_SUFX}
a63 1
CATEGORIES=	lang 
d104 25
a128 1
MAINTAINER=	Marc.Espie@@openbsd.org
d130 13
a142 1
BUILD_DEPENDS=	autoconf:${PORTSDIR}/devel/autoconf
d144 3
a146 2
# will improve over time as more and more architectures are handled
ONLY_FOR_ARCHS = i386 amiga atari hp300 mac68k mvme68k
a148 5
USE_GMAKE= yes

# don't make bootstrap if you're impatient/you know what you're doing
# use bootstrap-lean if you don't have room.
ALL_TARGET=bootstrap
d156 1
d161 1
a161 6
# get openbsd configuration files where they should be
post-patch:
	cp -R ${FILESDIR}/config/* ${WRKSRC}
	rm -rf ${WRKSRC}/texinfo

# rebuild configure file after patching, then move file around !!!
a162 1
# + kludge to build in a separate directory.
d165 13
a177 2
	mv ${WRKSRC} ${WRKDIR}/source
	mkdir ${WRKSRC}
d179 28
a206 7
# use the same trick that's used for emacs
pre-install:
.if (${MACHINE_ARCH} != "alpha")
	${RM} -f ${PKGDIR}/PLIST
	${SED} -e "s/ARCH/`${WRKDIR}/source/config.guess`/" ${FILESDIR}/PLIST.template >${PKGDIR}/PLIST
.else
	cp ${FILESDIR}/PLIST.alpha ${PKGDIR}/PLIST
d208 1
a208 1
	
d210 4
@


1.3
log
@Tentative configurations for some more architectures,
Fix buglet: PLIST generated from template, shouldn't be in repo.

Add large list of mirrors to Makefile, change config slightly.
Man/info pages installed under nicer names.
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.2 1998/10/02 18:51:24 espie Exp $
d83 1
a83 1
--verbose --with-gnu-ld ---with-gnu-as \
@


1.2
log
@Some files moved around to accommodate libstdc++ config.
i386 setup checked, initial m68k setup (not yet tested).
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.1.1.1 1998/09/26 08:53:03 espie Exp $
d11 1
d20 3
d27 37
d83 1
a83 1
--verbose \
@


1.1
log
@Initial revision
@
text
@d2 1
a2 1
# Version required:	egcs release 1.1b
d6 1
a6 1
# $OpenBSD$
d17 3
d26 1
a26 2
# Should be CONFIGURE_DEPENDS, if we had it
DEPENDS=  ${PORTSDIR}/devel/autoconf:${PORTSDIR}/devel/autoconf
d28 2
a29 1
ONLY_FOR_ARCHS= i386
a32 1
MAKE_ENV="CFLAGS=-O2"
d38 1
a38 2
# should remove --enable-shared for alpha
# use --enable-haifa- on some archs (alpha, sparc, pa-risc)
d40 7
a46 2
CONFIGURE_ARGS=--verbose --enable-shared --program-prefix=e
INSTALL_TARGET=	install
d49 2
a50 2
post-extract:
	cp -R files/* ${WRKSRC}
a52 5
# we should change libstdc++ name so that we will get the right one
post-patch:
	
CONFIGURE_SCRIPT=../source/configure

d57 1
a57 1
	cd ${WRKSRC}/gcc && /usr/local/bin/autoconf
d61 10
@


1.1.1.1
log
@egcs ports, stable release flavor
@
text
@@
