head	1.20;
access;
symbols
	OPENBSD_6_1:1.19.0.6
	OPENBSD_6_1_BASE:1.19
	OPENBSD_6_0:1.19.0.4
	OPENBSD_6_0_BASE:1.19
	OPENBSD_5_9:1.19.0.2
	OPENBSD_5_9_BASE:1.19
	OPENBSD_5_8:1.17.0.4
	OPENBSD_5_8_BASE:1.17
	OPENBSD_5_7:1.15.0.2
	OPENBSD_5_7_BASE:1.15
	OPENBSD_5_6:1.13.0.2
	OPENBSD_5_6_BASE:1.13
	OPENBSD_5_5:1.11.0.2
	OPENBSD_5_5_BASE:1.11
	OPENBSD_5_4:1.10.0.2
	OPENBSD_5_4_BASE:1.10
	OPENBSD_5_3:1.9.0.2
	OPENBSD_5_3_BASE:1.9
	OPENBSD_5_2:1.7.0.2
	OPENBSD_5_2_BASE:1.7
	OPENBSD_5_1_BASE:1.6
	OPENBSD_5_1:1.6.0.2
	OPENBSD_5_0:1.4.0.4
	OPENBSD_5_0_BASE:1.4
	OPENBSD_4_9:1.4.0.2
	OPENBSD_4_9_BASE:1.4
	stu_20110113:1.1.1.1
	stu:1.1.1;
locks; strict;
comment	@# @;


1.20
date	2017.04.23.20.52.33;	author stu;	state Exp;
branches;
next	1.19;
commitid	unVx1ShIHsdnArjY;

1.19
date	2015.11.24.09.11.05;	author jasper;	state Exp;
branches;
next	1.18;
commitid	x9aAifyKiYiivEom;

1.18
date	2015.09.30.18.57.13;	author stu;	state Exp;
branches;
next	1.17;
commitid	PWbLPZwMPhH8ZXvw;

1.17
date	2015.06.05.07.24.21;	author stu;	state Exp;
branches;
next	1.16;
commitid	Km5BbQqpLYZjGC8j;

1.16
date	2015.04.05.16.48.44;	author stu;	state Exp;
branches;
next	1.15;
commitid	T9ud5MtmdCpDGEN3;

1.15
date	2014.09.30.20.26.38;	author stu;	state Exp;
branches;
next	1.14;
commitid	GKBN8ZXUvmJxZXfb;

1.14
date	2014.08.30.17.19.39;	author stu;	state Exp;
branches;
next	1.13;
commitid	mPW7hX2ER9ArSZ6f;

1.13
date	2014.05.04.17.33.34;	author stu;	state Exp;
branches;
next	1.12;

1.12
date	2014.03.14.22.08.41;	author stu;	state Exp;
branches;
next	1.11;

1.11
date	2013.09.25.12.25.17;	author stu;	state Exp;
branches;
next	1.10;

1.10
date	2013.03.11.11.20.27;	author espie;	state Exp;
branches;
next	1.9;

1.9
date	2013.02.07.15.22.58;	author stu;	state Exp;
branches;
next	1.8;

1.8
date	2012.08.26.15.43.51;	author stu;	state Exp;
branches;
next	1.7;

1.7
date	2012.07.04.17.47.27;	author stu;	state Exp;
branches;
next	1.6;

1.6
date	2011.10.24.16.50.07;	author stu;	state Exp;
branches;
next	1.5;

1.5
date	2011.10.21.16.23.45;	author espie;	state Exp;
branches;
next	1.4;

1.4
date	2011.01.19.23.22.05;	author stu;	state Exp;
branches;
next	1.3;

1.3
date	2011.01.19.22.50.11;	author jasper;	state Exp;
branches;
next	1.2;

1.2
date	2011.01.17.22.09.35;	author stu;	state Exp;
branches;
next	1.1;

1.1
date	2011.01.13.13.30.46;	author stu;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2011.01.13.13.30.46;	author stu;	state Exp;
branches;
next	;


desc
@@


1.20
log
@Update to beta39.
In the port Makefile, put all the testing bits together in one place.
@
text
@# $OpenBSD: Makefile,v 1.19 2015/11/24 09:11:05 jasper Exp $

COMMENT =	Tcl implementation for the CLR

V =		1.0
P =		6234.51946
DISTNAME =	eagle-${V}
PKGNAME =	${DISTNAME}-beta39
CATEGORIES =	lang lang/tcl
HOMEPAGE =	http://eagle.to/
MAINTAINER =	Stuart Cassoff <stwo@@users.sourceforge.net>

# BSD
PERMIT_PACKAGE_CDROM =	Yes

MASTER_SITES =	${MASTER_SITE_SOURCEFORGE:=eagle/} \
		https://eagle.to/releases/${V}.${P}/ \
		https://distfiles.nl/

DISTFILES =	EagleBinaryMonoOnUnix${V}.${P}.rar
EXTRACT_CASES =	*.rar) ${LOCALBASE}/bin/unrar x -idq ${DISTDIR}/$$archive;;

MODULES =	lang/mono
MODMONO_DEPS =	No

BUILD_DEPENDS =	archivers/unrar
RUN_DEPENDS =	${MODMONO_RUN_DEPENDS}
TEST_DEPENDS =	${MODMONO_RUN_DEPENDS}

TEST_IS_INTERACTIVE = X11

NO_BUILD =	Yes
WRKSRC =	${WRKDIR}/Eagle

EAGLE_DIR =	libdata/Eagle
EAGLE_INS_DIR = ${PREFIX}/${EAGLE_DIR}
EAGLE_BIN_DIR =	${EAGLE_INS_DIR}/bin
EAGLE_LIB_DIR =	${EAGLE_INS_DIR}/lib/Eagle${V}
EAGLE_BIN =	${PREFIX}/bin/eagle

# Skip tests that are too timing-sensitive to succeed everywhere
EAGLE_TEST_FLAGS = -notFile 'benchmark.eagle perf*.eagle'

# Skip tests that may hang or fail due to pthread and/or Mono issues
EAGLE_TEST_FLAGS += -skip 'interp-1.72 object-8.108 object-10.* socket-2.2 host-1.3'

# "-namespaces 1" enables namespace tests
# "set no(bigLists) 1" avoids oom problems
# "set no(exec) 1; set no(compileCSharp) 1" to work around Mono bugs
# "set no(tcl) 1" ignores any installed Tcl
# "set test_log {}" disables logging test results to a file
# "set test_(all_)path {...}" to work around Eagle test bugs

do-test:
	${SETENV} ${ALL_TEST_ENV} ${ALL_TEST_FLAGS} \
	${LOCALBASE}/bin/mono ${WRKSRC}/bin/EagleShell.exe \
	-namespaces 1 \
	-preInitialize 'set no(bigLists) 1; set no(exec) 1; set no(compileCSharp) 1; set no(tcl) 1' \
	-preInitialize 'set test_log {}; set test_path {${WRKSRC}/Tests}; set test_all_path {${WRKSRC}/lib/Test1.0}' \
	-file ${WRKSRC}/Tests/all.eagle \
	${EAGLE_TEST_FLAGS}

do-install:
	${INSTALL_DATA_DIR} ${EAGLE_BIN_DIR} ${EAGLE_LIB_DIR}
.for SRC GLOB DEST in \
		bin		*		${EAGLE_BIN_DIR} \
		lib/Eagle${V}	*		${EAGLE_LIB_DIR} \
		.		license.terms	${EAGLE_INS_DIR}

	${INSTALL_DATA} ${WRKSRC}/${SRC}/${GLOB} ${DEST}
.endfor
	echo '#! /bin/sh' > ${EAGLE_BIN}
	echo 'exec mono ${TRUEPREFIX}/${EAGLE_DIR}/bin/EagleShell.exe $${1+"$$@@"}' >> ${EAGLE_BIN}
	chown ${BINOWN}:${BINGRP} ${EAGLE_BIN}
	chmod ${BINMODE} ${EAGLE_BIN}
	rm ${EAGLE_BIN_DIR}/EagleShell32.exe

.include <bsd.port.mk>
@


1.19
log
@switch distfiles.nl to SSL, setup with security/letsencrypt/client
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2015/09/30 18:57:13 stu Exp $
d6 1
a6 1
P =		5749.32588
d8 1
a8 1
PKGNAME =	${DISTNAME}-beta34
d17 1
a17 1
		${HOMEPAGE:=releases/${V}.${P}/} \
d19 1
d45 17
a61 1
EAGLE_TEST_FLAGS += -skip 'interp-1.72 object-8.108 object-10.* socket-2.2'
a76 14

# "-namespaces 1" enables namespace tests
# "set no(bigLists) 1" avoids oom problems
# "set no(exec) 1; set no(compileCSharp) 1" is needed to work around Mono bugs
# "set test_log {}" disables logging test results to a file
# "set test_(all_)path {...}" work around Eagle test bugs
do-test:
	${SETENV} ${ALL_TEST_ENV} ${ALL_TEST_FLAGS} \
	${LOCALBASE}/bin/mono ${WRKSRC}/bin/EagleShell.exe \
	-namespaces 1 \
	-preInitialize 'set no(bigLists) 1; set no(exec) 1; set no(compileCSharp) 1; set test_log {}' \
	-preInitialize 'set test_path {${WRKSRC}/Tests}; set test_all_path {${WRKSRC}/lib/Test1.0}' \
	-file ${WRKSRC}/Tests/all.eagle \
	${EAGLE_TEST_FLAGS}
@


1.18
log
@Update to beta34.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2015/06/05 07:24:21 stu Exp $
d18 1
a18 1
		http://distfiles.nl/
@


1.17
log
@Update to beta33.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2015/04/05 16:48:44 stu Exp $
d6 1
a6 1
P =		5633.18513
d8 1
a8 1
PKGNAME =	${DISTNAME}-beta33
d43 2
a44 2
# Skip tests that may hang due to pthread and/or Mono issues
EAGLE_TEST_FLAGS += -skip 'object-10.* socket-2.2'
d65 1
d71 1
@


1.16
log
@Update to beta32.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2014/09/30 20:26:38 stu Exp $
d6 1
a6 1
P =		5542.25903
d8 1
a8 1
PKGNAME =	${DISTNAME}-beta32
d43 3
d59 1
@


1.15
log
@Update to beta31.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2014/08/30 17:19:39 stu Exp $
d6 1
a6 1
P =		5384.19912
d8 1
a8 1
PKGNAME =	${DISTNAME}-beta31
@


1.14
log
@Adjust for ALL_TEST_ENV.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2014/05/04 17:33:34 stu Exp $
d6 1
a6 1
P =		5217.20046
d8 1
a8 1
PKGNAME =	${DISTNAME}-beta30
d41 1
a41 3
# Skip tests that use too much memory and/or hang
EAGLE_TEST_FLAGS = -notFile 'benchmark.eagle delayout.eagle perf*.eagle' \
		   -skip 'lmap-7.7 lmap-7.8'
a56 1
# "set test_log {}" disables logging test results to a file
d58 1
d60 1
d65 1
a65 1
	-preInitialize 'set no(exec) 1; set no(compileCSharp) 1; set test_log {}' \
@


1.13
log
@Update to beta30.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2014/03/14 22:08:41 stu Exp $
d63 1
a63 1
	${SETENV} ${MAKE_ENV} ${ALL_TEST_FLAGS} \
@


1.12
log
@Update to beta29.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2013/09/25 12:25:17 stu Exp $
d6 1
a6 1
P =		5173.31244
d8 1
a8 1
PKGNAME =	${DISTNAME}-beta29
d59 2
d65 1
@


1.11
log
@Update to beta28.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2013/03/11 11:20:27 espie Exp $
d6 1
a6 1
P =		5000.25377
d8 1
a8 1
PKGNAME =	${DISTNAME}-beta28
d27 1
a27 1
TEST_DEPENDS=${MODMONO_RUN_DEPENDS}
d41 1
a41 1
# Skip tests that use too much memory and hang
d59 1
d63 1
a63 1
	-preInitialize 'set test_log {}' \
@


1.10
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2013/02/07 15:22:58 stu Exp $
d6 1
a6 1
P =		4691.37889
d8 1
a8 1
PKGNAME =	${DISTNAME}-beta26
d40 4
a43 2
# Some tests are too timing-sensitive to succeed everywhere so don't run them
EAGLE_TEST_FLAGS = -notFile 'benchmark.eagle delayout.eagle perf*.eagle'
@


1.9
log
@Update to Eagle beta26.

ok landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2012/08/26 15:43:51 stu Exp $
a14 3
PERMIT_PACKAGE_FTP =	Yes
PERMIT_DISTFILES_CDROM =Yes
PERMIT_DISTFILES_FTP =	Yes
d27 1
a27 1
REGRESS_DEPENDS=${MODMONO_RUN_DEPENDS}
d29 1
a29 1
REGRESS_IS_INTERACTIVE = X11
d41 1
a41 1
EAGLE_REGRESS_FLAGS = -notFile 'benchmark.eagle delayout.eagle perf*.eagle'
d57 2
a58 2
do-regress:
	${SETENV} ${MAKE_ENV} ${ALL_REGRESS_FLAGS} \
d62 1
a62 1
	${EAGLE_REGRESS_FLAGS}
@


1.8
log
@Update to beta-24.

Ok sebastia@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2012/07/04 17:47:27 stu Exp $
d6 1
a6 1
P =		4567.36231
d8 1
a8 1
PKGNAME =	${DISTNAME}-beta24
d44 1
a44 3
# Socket-2.2 hangs so skip it
EAGLE_REGRESS_FLAGS =	-notFile 'benchmark.eagle delayout.eagle perf*.eagle' \
			-skip socket-2.2
@


1.7
log
@Update to beta-23.

ok landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2011/10/24 16:50:07 stu Exp $
d6 1
a6 1
P =		4511.33815
d8 1
a8 1
PKGNAME =	${DISTNAME}-beta23
d43 5
a61 1
# Some tests are too timing-sensitive to succeed everywhere so don't run them
d67 1
a67 1
	-notFile 'benchmark.eagle delayout.eagle perf*.eagle'
@


1.6
log
@Update to beta-19.

ok jasper@@, sebastia@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2011/10/21 16:23:45 espie Exp $
d6 1
a6 1
P =		4312.34328
d8 1
a8 1
PKGNAME =	${DISTNAME}-beta19
@


1.5
log
@CHMOD and CHOWN serve no useful purpose, they're just chown/chmod
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2011/01/19 23:22:05 stu Exp $
d6 1
a6 1
P =		4031.13865
d8 1
a8 1
PKGNAME =	${DISTNAME}-beta13
d61 2
a62 2
	-preinit 'set test_log ""' \
	-file ${WRKSRC}/tests/all.eagle \
@


1.4
log
@Eagle is now also on sf; a more reliable place for the distfile.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2011/01/19 22:50:11 jasper Exp $
d54 2
a55 2
	${CHOWN} ${BINOWN}:${BINGRP} ${EAGLE_BIN}
	${CHMOD} ${BINMODE} ${EAGLE_BIN}
@


1.3
log
@- add a mirror for the distfile.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2011/01/17 22:09:35 stu Exp $
d19 2
a20 1
MASTER_SITES =	${HOMEPAGE:=releases/${V}.${P}/} \
@


1.2
log
@Update to beta-13.\nOk jasper@@.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2011/01/13 13:30:46 stu Exp $
d19 2
a20 1
MASTER_SITES =	${HOMEPAGE:=releases/${V}.${P}/}
d48 1
a48 1
		
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d6 1
a6 1
P =		4010.41132
d8 1
a8 1
PKGNAME =	${DISTNAME}-beta12
@


1.1.1.1
log
@Import eagle 1.0-beta12:
Eagle (Extensible Adaptable Generalized Logic Engine) is an
implementation of the Tcl language for the Common Language Runtime
(CLR). Eagle was written from scratch based on the design and
implementation of Tcl 8.4 and provides most of the functionality of the
Tcl 8.4 interpreter while borrowing selected features from Tcl 8.5 and
the upcoming Tcl 8.6, in addition to adding entirely new features.
Feedback and ok from jasper@@ and thanks to all for their patience with me.
@
text
@@
