head	1.4;
access;
symbols
	OPENBSD_2_7:1.3.0.8
	OPENBSD_2_7_BASE:1.3
	OPENBSD_2_6:1.3.0.6
	OPENBSD_2_6_BASE:1.3
	OPENBSD_2_5:1.3.0.4
	OPENBSD_2_5_BASE:1.3
	OPENBSD_2_4:1.3.0.2
	OPENBSD_2_4_BASE:1.3;
locks; strict;
comment	@# @;


1.4
date	2000.07.02.11.05.48;	author fgsch;	state dead;
branches;
next	1.3;

1.3
date	98.09.08.05.43.36;	author marc;	state Exp;
branches
	1.3.8.1;
next	1.2;

1.2
date	98.08.16.23.36.10;	author marc;	state Exp;
branches;
next	1.1;

1.1
date	98.04.28.02.27.16;	author angelos;	state Exp;
branches;
next	;

1.3.8.1
date	2000.09.15.05.11.51;	author marc;	state dead;
branches;
next	;


desc
@@


1.4
log
@Update to release 1.4.3. Use CONFIGURE_STYLE and FLAVORS. Fake as well.
bump NEED_VERSION. Still a few things to do, tho.
@
text
@--- src/auth.c.~1~	Mon Sep  7 21:52:28 1998
+++ src/auth.c	Mon Sep  7 21:54:15 1998
@@@@ -64,17 +64,20 @@@@
 		(void) sscanf (authcmd, "%*d.%*d.%d", &cookiefd);
 
 	if (cookiefd == -1) {
+		int fdfd;
 		char tempfile[BUFSIZ];
 
 		sprintf (tempfile, "%stin_AXXXXXX", TMPDIR);
-		if (!mktemp (tempfile)) {
+		fdfd = mkstemp(tempfile);
+		if (fdfd == -1) {
 			error_message (txt_cannot_create_uniq_name);
 #ifdef DEBUG
 			debug_nntp ("authorization", txt_cannot_create_uniq_name);
 #endif /* DEBUG */
 			return FALSE;
 		} else {
-			if ((fp = fopen (tempfile, "w+")) != (FILE *) 0) {
+			fp = fdopen (fdfd, "w+");
+			if (fp) {
 				cookiefd = fileno (fp);
 				(void) unlink (tempfile);
 			} else {
@


1.3
log
@update to  1.4.980818
@
text
@@


1.3.8.1
log
@bring news as of cut-over date into 2.7 branch
@
text
@@


1.2
log
@update to 1.4.980730
@
text
@d1 7
a7 11
--- src/auth.c.~1~	Mon Jul 27 12:05:01 1998
+++ src/auth.c	Sat Aug 15 17:20:53 1998
@@@@ -44,6 +44,7 @@@@
 	FILE *fp;
 	t_bool builtinauth = FALSE;
 	static int cookiefd = -1;
+	int fdfd;
 #ifdef HAVE_PUTENV
 	char *new_env;
 	static char *old_env = 0;
@@@@ -64,14 +65,16 @@@@
d17 1
a17 1
 #endif
@


1.1
log
@mktemp->mkstemp
@
text
@d1 29
a29 44
*** src/auth.c.orig	Mon Apr 27 22:20:02 1998
--- src/auth.c	Mon Apr 27 22:21:05 1998
***************
*** 43,48 ****
--- 43,49 ----
  	FILE *fp;
  	t_bool builtinauth = FALSE;
  	static int cookiefd = -1;
+         int fdfd;
  #ifdef HAVE_PUTENV
  	char *new_env;
  	static char *old_env = 0;
***************
*** 64,77 ****
  		char tempfile[BUFSIZ];
  
  		sprintf (tempfile, "%stin_AXXXXXX", TMPDIR);
! 		if (!mktemp (tempfile)) {
  			error_message (txt_cannot_create_uniq_name, "");
  #ifdef DEBUG
  			debug_nntp ("authorization", txt_cannot_create_uniq_name);
  #endif
  			return FALSE;
  		} else {
! 			fp = fopen (tempfile, "w+");
  			if (!fp) {
  				error_message (txt_cannot_open, tempfile);
  				return FALSE;
--- 65,79 ----
  		char tempfile[BUFSIZ];
  
  		sprintf (tempfile, "%stin_AXXXXXX", TMPDIR);
! 		fdfd = mkstemp(tempfile);
! 		if (fdfd == -1) {
  			error_message (txt_cannot_create_uniq_name, "");
  #ifdef DEBUG
  			debug_nntp ("authorization", txt_cannot_create_uniq_name);
  #endif
  			return FALSE;
  		} else {
! 			fp = fdopen (fdfd, "w+");
  			if (!fp) {
  				error_message (txt_cannot_open, tempfile);
  				return FALSE;
@

