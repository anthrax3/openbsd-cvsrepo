head	1.2;
access;
symbols
	OPENBSD_6_2:1.2.0.14
	OPENBSD_6_2_BASE:1.2
	OPENBSD_6_1:1.2.0.12
	OPENBSD_6_1_BASE:1.2
	OPENBSD_6_0:1.2.0.10
	OPENBSD_6_0_BASE:1.2
	OPENBSD_5_9:1.2.0.6
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.2.0.8
	OPENBSD_5_8_BASE:1.2
	OPENBSD_5_7:1.2.0.4
	OPENBSD_5_7_BASE:1.2
	OPENBSD_5_6:1.2.0.2
	OPENBSD_5_6_BASE:1.2;
locks; strict;
comment	@# @;


1.2
date	2014.07.10.08.18.37;	author giovanni;	state Exp;
branches;
next	1.1;
commitid	RJSOMNhrAimeXpZ8;

1.1
date	2014.04.29.16.41.36;	author giovanni;	state Exp;
branches;
next	;


desc
@@


1.2
log
@
bugfix update to 2.2.1
@
text
@$OpenBSD: patch-src_sigfile_c,v 1.1 2014/04/29 16:41:36 giovanni Exp $
--- src/sigfile.c.orig	Wed Dec 25 11:16:53 2013
+++ src/sigfile.c	Tue Jul  8 19:47:12 2014
@@@@ -162,8 +162,6 @@@@ static FILE *
 open_random_sig(
 	char *sigdir)
 {
-	srand((unsigned int) time(NULL));
-
 	if (chdir(sigdir) == 0) {
 		if (thrashdir(sigdir) || !*sigfile) {
 #ifdef DEBUG
@@@@ -236,7 +234,7 @@@@ thrashdir(
 			return 1;
 		}
 #endif /* HAVE_REWINDDIR */
-		pick = rand() % numentries + 1;
+		pick = arc4random_uniform(numentries) + 1;
 		while (--pick >= 0) {
 			if ((dp = readdir(dirp)) == NULL)
 				break;
@


1.1
log
@
Update to 2.2.0
add some arc4random patches
take maintainership
ok & hints Joachim Shipper (old maintainer)
@
text
@d1 3
a3 3
$OpenBSD$
--- src/sigfile.c.orig	Fri Apr 18 12:55:26 2014
+++ src/sigfile.c	Fri Apr 18 12:58:04 2014
d10 1
a10 1
 	if (chdir(sigdir) == 0)  {
@

