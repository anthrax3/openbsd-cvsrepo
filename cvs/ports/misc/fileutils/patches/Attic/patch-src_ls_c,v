head	1.5;
access;
symbols
	OPENBSD_5_2:1.4.0.8
	OPENBSD_5_2_BASE:1.4
	OPENBSD_5_1_BASE:1.4
	OPENBSD_5_1:1.4.0.6
	OPENBSD_5_0:1.4.0.4
	OPENBSD_5_0_BASE:1.4
	OPENBSD_4_9:1.4.0.2
	OPENBSD_4_9_BASE:1.4
	OPENBSD_4_8:1.3.0.32
	OPENBSD_4_8_BASE:1.3
	OPENBSD_4_7:1.3.0.30
	OPENBSD_4_7_BASE:1.3
	OPENBSD_4_6:1.3.0.28
	OPENBSD_4_6_BASE:1.3
	OPENBSD_4_5:1.3.0.26
	OPENBSD_4_5_BASE:1.3
	OPENBSD_4_4:1.3.0.24
	OPENBSD_4_4_BASE:1.3
	OPENBSD_4_3:1.3.0.22
	OPENBSD_4_3_BASE:1.3
	OPENBSD_4_2:1.3.0.20
	OPENBSD_4_2_BASE:1.3
	OPENBSD_4_1:1.3.0.18
	OPENBSD_4_1_BASE:1.3
	OPENBSD_4_0:1.3.0.16
	OPENBSD_4_0_BASE:1.3
	OPENBSD_3_9:1.3.0.14
	OPENBSD_3_9_BASE:1.3
	OPENBSD_3_8:1.3.0.12
	OPENBSD_3_8_BASE:1.3
	OPENBSD_3_7:1.3.0.10
	OPENBSD_3_7_BASE:1.3
	OPENBSD_3_6:1.3.0.8
	OPENBSD_3_6_BASE:1.3
	OPENBSD_3_5:1.3.0.6
	OPENBSD_3_5_BASE:1.3
	OPENBSD_3_4:1.3.0.4
	OPENBSD_3_4_BASE:1.3
	OPENBSD_3_3:1.3.0.2
	OPENBSD_3_3_BASE:1.3
	OPENBSD_3_2:1.2.0.6
	OPENBSD_3_2_BASE:1.2
	OPENBSD_3_1:1.2.0.4
	OPENBSD_3_1_BASE:1.2
	OPENBSD_3_0:1.2.0.2
	OPENBSD_3_0_BASE:1.2
	OPENBSD_2_9_TRACKING_SWITCH:1.2
	OPENBSD_2_9:1.1.0.2
	OPENBSD_2_9_BASE:1.1;
locks; strict;
comment	@# @;


1.5
date	2012.10.24.13.22.35;	author ajacoutot;	state dead;
branches;
next	1.4;

1.4
date	2010.11.03.06.56.37;	author jasper;	state Exp;
branches;
next	1.3;

1.3
date	2003.02.25.04.27.35;	author brad;	state Exp;
branches;
next	1.2;

1.2
date	2001.07.21.14.56.26;	author lebel;	state Exp;
branches;
next	1.1;

1.1
date	2001.03.15.18.17.54;	author wilfried;	state Exp;
branches;
next	;


desc
@@


1.5
log
@These ports have been unhooked for a while and replaced by coreutils, so
remove them.

ok naddy@@
@
text
@$OpenBSD: patch-src_ls_c,v 1.4 2010/11/03 06:56:37 jasper Exp $
--- src/ls.c.orig	Sun Apr 29 11:42:47 2001
+++ src/ls.c	Wed Nov  3 07:55:57 2010
@@@@ -510,13 +510,13 @@@@ enum color_type
 enum indicator_no
   {
     C_LEFT, C_RIGHT, C_END, C_NORM, C_FILE, C_DIR, C_LINK, C_FIFO, C_SOCK,
-    C_BLK, C_CHR, C_MISSING, C_ORPHAN, C_EXEC, C_DOOR
+    C_BLK, C_CHR, C_MISSING, C_ORPHAN, C_EXEC, C_DOOR, C_UID, C_GID, C_WRO, C_WT
   };
 
 static const char *const indicator_name[]=
   {
     "lc", "rc", "ec", "no", "fi", "di", "ln", "pi", "so",
-    "bd", "cd", "mi", "or", "ex", "do", NULL
+    "bd", "cd", "mi", "or", "ex", "do", "su", "sg", "wo", "wt", NULL
   };
 
 struct color_ext_type
@@@@ -542,7 +542,11 @@@@ static struct bin_str color_indicator[] =
     { 0, NULL },			/* mi: Missing file: undefined */
     { 0, NULL },			/* or: Orphanned symlink: undefined */
     { LEN_STR_PAIR ("01;32") },		/* ex: Executable: bright green */
-    { LEN_STR_PAIR ("01;35") }		/* do: Door: bright magenta */
+    { LEN_STR_PAIR ("01;35") },		/* do: Door: bright magenta */
+    { LEN_STR_PAIR ("37;41") },         /* su: setuid: white on red */
+    { LEN_STR_PAIR ("30;43") },         /* sg: setgid: black on yellow */
+    { LEN_STR_PAIR ("37;44") },         /* wo: writeable-other:white on blue */
+    { LEN_STR_PAIR ("37;42") },         /* wt: wo w/ sticky: white on green */
   };
 
 /* FIXME: comment  */
@@@@ -2883,7 +2887,14 @@@@ print_color_indicator (const char *name, unsigned int 
   else
     {
       if (S_ISDIR (mode))
-	type = C_DIR;
+        {
+          if ((mode && MODE_WT) == MODE_WT)
+            type = C_WT;
+          else if ((mode && MODE_WRO) == MODE_WRO)
+            type = C_WRO;
+          else
+            type = C_DIR;
+        }
       else if (S_ISLNK (mode))
 	type = ((!linkok && color_indicator[C_ORPHAN].string)
 		? C_ORPHAN : C_LINK);
@@@@ -2898,7 +2909,13 @@@@ print_color_indicator (const char *name, unsigned int 
       else if (S_ISDOOR (mode))
 	type = C_DOOR;
 
-      if (type == C_FILE && (mode & S_IXUGO) != 0)
+      if ((type == C_FILE) && ((mode & S_ISUID) != 0))
+        type = C_UID;
+
+      else if ((type == C_FILE) && ((mode & S_ISGID) != 0))
+        type = C_GID;
+
+      else if (type == C_FILE && (mode & S_IXUGO) != 0)
 	type = C_EXEC;
 
       /* Check the file's suffix only if still classified as C_FILE.  */
@


1.4
log
@- regen patches, add missing rcs id's
@
text
@d1 1
a1 1
$OpenBSD: patch-src_rm_c,v 1.1 2003/02/25 14:35:43 brad Exp $
@


1.3
log
@sync with update-patches
@
text
@d1 3
a3 2
--- src/ls.c.orig	Sun Apr 29 05:42:47 2001
+++ src/ls.c	Mon Feb 24 23:18:38 2003
d20 1
a20 1
@@@@ -542,7 +542,11 @@@@ static struct bin_str color_indicator[] 
d33 1
a33 1
@@@@ -2883,7 +2887,14 @@@@ print_color_indicator (const char *name,
d49 1
a49 1
@@@@ -2898,7 +2909,13 @@@@ print_color_indicator (const char *name,
@


1.2
log
@update misc/fileutils to 4.1; thanks Heikki Korpela <heko@@iki.fi>
@
text
@d1 3
a3 3
--- src/ls.c.orig	Sun Apr 29 12:42:47 2001
+++ src/ls.c	Fri Jul 20 21:01:39 2001
@@@@ -510,13 +510,13 @@@@
d19 1
a19 1
@@@@ -542,7 +542,11 @@@@
d32 1
a32 1
@@@@ -2883,7 +2887,14 @@@@
d48 1
a48 1
@@@@ -2898,7 +2909,13 @@@@
@


1.1
log
@patches from gnuls
@
text
@d1 3
a3 4
$OpenBSD: update-patches,v 1.3 2000/06/09 17:08:37 espie Exp $
--- src/ls.c.orig	Sat Sep 19 13:09:23 1998
+++ src/ls.c	Thu Mar 15 08:11:07 2001
@@@@ -368,13 +368,13 @@@@ enum color_type
d7 2
a8 2
-    C_BLK, C_CHR, C_MISSING, C_ORPHAN, C_EXEC
+    C_BLK, C_CHR, C_MISSING, C_ORPHAN, C_EXEC, C_UID, C_GID, C_WRO, C_WT
d14 2
a15 2
-    "bd", "cd", "mi", "or", "ex", NULL
+    "bd", "cd", "mi", "or", "ex", "su", "sg", "wo", "wt", NULL
d18 2
a19 3
 struct col_ext_type
@@@@ -399,7 +399,11 @@@@ static struct bin_str color_indicator[] 
     { LEN_STR_PAIR ("01;33") },		/* cd: Char device: bright yellow */
d22 3
a24 2
-    { LEN_STR_PAIR ("01;32") }		/* ex: Executable: bright green */
+    { LEN_STR_PAIR ("01;32") },		/* ex: Executable: bright green */
d32 1
a32 1
@@@@ -2477,7 +2481,14 @@@@ print_color_indicator (const char *name,
a44 2
 
 #ifdef S_ISLNK
d46 5
a50 3
@@@@ -2505,7 +2516,13 @@@@ print_color_indicator (const char *name,
 	type = C_CHR;
 #endif
@

