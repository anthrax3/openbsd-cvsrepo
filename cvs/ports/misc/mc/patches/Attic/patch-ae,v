head	1.3;
access;
symbols
	OPENBSD_2_8:1.2.0.4
	OPENBSD_2_8_BASE:1.2
	OPENBSD_2_7:1.2.0.2
	OPENBSD_2_7_BASE:1.2
	kevlo_2000-Feb-3:1.1.1.1
	kevlo:1.1.1;
locks; strict;
comment	@# @;


1.3
date	2001.03.05.06.36.09;	author fgsch;	state dead;
branches;
next	1.2;

1.2
date	2000.04.28.23.33.17;	author fgsch;	state Exp;
branches;
next	1.1;

1.1
date	2000.02.03.02.11.32;	author kevlo;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2000.02.03.02.11.32;	author kevlo;	state Exp;
branches;
next	;


desc
@@


1.3
log
@Partial update to 4.5.51; still marked as broken till i fix some things.
@
text
@--- vfs/vfs.c.orig	Mon May 25 07:16:04 1998
+++ vfs/vfs.c	Thu Apr 27 11:20:45 2000
@@@@ -1274,13 +1274,25 @@@@
     fdin = mc_open (filename, O_RDONLY);
     if (fdin == -1)
         return NULL;
+#ifdef __OpenBSD__
+#define TEMPFILE	"/tmp/mcXXXXXXXXXX"
+    tmp = xmalloc (sizeof(TEMPFILE), TEMPFILE);
+    strcpy (tmp, TEMPFILE);
+    fdout = mkstemp (tmp);
+#else
     tmp = tmpnam(NULL);
     fdout = creat (tmp, 0600);
+#endif
     if (fdout == -1) {
         mc_close (fdin);
+#ifdef __OpenBSD__
+        free (tmp);
+#endif
         return NULL;
     }
+#ifndef __OpenBSD__
     tmp = strdup (tmp);
+#endif
     while ((i = mc_read (fdin, buffer, sizeof (buffer))) == sizeof (buffer)) {
         write (fdout, buffer, i);
     }
@


1.2
log
@rearrange Makefile; start working on correct fixes. still a few warnings
to go.
@
text
@@


1.1
log
@Initial revision
@
text
@d1 28
a28 11
--- vfs/extfs.c.orig	Sun Jan 16 01:31:07 2000
+++ vfs/extfs.c	Sun Jan 16 01:31:27 2000
@@@@ -749,7 +749,7 @@@@ static void *extfs_open (char *file, int
     if (entry->inode->local_filename == NULL) {
         char *cmd, *archive_name;
         
-        entry->inode->local_filename = strdup (tmpnam (NULL));
+        entry->inode->local_filename = strdup (mkstemp (NULL));
 	p = extfs_get_path_from_entry (entry);
 	q = name_quote (p, 0);
 	free (p);
@


1.1.1.1
log
@Initial import of mc version 4.1.35.
The Midnight Commander is a free Norton Commander Clone with many useful 
features.

Submitted by:	Ryan Erwin <ryan@@erwin.org>
@
text
@@
