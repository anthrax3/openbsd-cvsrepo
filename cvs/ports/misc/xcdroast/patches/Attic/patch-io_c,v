head	1.3;
access;
symbols
	OPENBSD_3_2:1.1.1.1.0.2
	OPENBSD_3_2_BASE:1.1.1.1
	wilfried_2002-07-14:1.1.1.1
	wilfried:1.1.1;
locks; strict;
comment	@# @;


1.3
date	2003.02.17.18.10.35;	author naddy;	state dead;
branches;
next	1.2;

1.2
date	2002.10.13.22.39.45;	author pvalchev;	state Exp;
branches;
next	1.1;

1.1
date	2002.07.14.19.34.28;	author wilfried;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2002.07.14.19.34.28;	author wilfried;	state Exp;
branches;
next	;


desc
@@


1.3
log
@Update to 0.98alpha13 for compatibility with cdrtools 2.0.
From: Jolan Luff <jolan@@cryptonomicon.org>
@
text
@$OpenBSD: patch-io_c,v 1.2 2002/10/13 22:39:45 pvalchev Exp $
--- io.c.orig	Tue May 14 08:37:51 2002
+++ io.c	Tue May 14 08:38:12 2002
@@@@ -20,7 +20,8 @@@@
 # include <sys/soundcard.h>
 # include <sys/ioctl.h>
 #endif
-#ifdef sun 
+#if defined(sun) || defined (__OpenBSD__) 
+# include <sys/ioctl.h>
 # include <sys/audioio.h>
 #endif
 #ifdef hpux 
@@@@ -996,7 +997,7 @@@@ GList *get_dsp_devices() {
 GList *dsp;
 GList *loop;
 struct stat buf;
-#ifdef sun
+#if defined(sun) || defined(__OpenBSD__)
 gchar *audiodev;
 #endif
 	dsp = NULL;
@@@@ -1011,7 +1012,7 @@@@ gchar *audiodev;
 		dsp = g_list_append(dsp,"/dev/dsp1");
 	}
 #endif
-#ifdef sun
+#if defined(sun) || defined(__OpenBSD__)
 	/* check if the user has any special audio-hardware running,
 	   which set the AUDIODEV-environment-variable */
 	audiodev = getenv("AUDIODEV");
@@@@ -1084,7 +1085,7 @@@@ gchar tmp2[MAXLINE];
 		}	
 	}	
 #endif
-#ifdef sun
+#if defined(sun) || defined(__OpenBSD__)
 
 	g_snprintf(tmp,MAXLINE,"%s%s",dsp,"ctl");
 
@@@@ -1991,7 +1992,7 @@@@ pid_t pid;
 		}
 
 		/* startup child */
-		if (execl("/bin/sh", "sh", "-c", cmd ,NULL) < 0) {
+		if (execl("/bin/sh", "sh", "-c", cmd ,(void*)NULL) < 0) {
 			g_error("execl error\n");
 		}
  
@@@@ -2365,7 +2366,7 @@@@ gint mix;
 #if defined(linux) || defined(__FreeBSD__)
 gint val;
 #endif
-#ifdef sun
+#if defined(sun) || defined(__OpenBSD__)
 audio_info_t ainfo;
 #endif
 #ifdef hpux
@@@@ -2400,7 +2401,7 @@@@ struct audio_gains again;
 	return ((val & 0x7f) + ((val >> 8) & 0x7f))/2;
 
 #endif
-#ifdef sun
+#if defined(sun) || defined(__OpenBSD__)
 
 	dodebug(10,"quering mixer %s\n", setupdata.mix_device);
 	mix = open(setupdata.mix_device, O_RDONLY);
@@@@ -2450,7 +2451,7 @@@@ struct audio_gains again;
 
 gint set_mixer(gint val) {
 gint mix;
-#ifdef sun
+#if defined(sun) || defined(__OpenBSD__)
 audio_info_t ainfo;
 #endif
 #ifdef hpux
@@@@ -2482,7 +2483,7 @@@@ struct audio_gains again;
 	close(mix);
 
 #endif 
-#ifdef sun
+#if defined(sun) || defined(__OpenBSD__)
 
 	dodebug(10,"setting mixer %s to %d\n", setupdata.mix_device, val);
 	mix = open(setupdata.mix_device, O_WRONLY);
@@@@ -3275,6 +3276,9 @@@@ gint ret,found;
 		/* got the message that no medium is present?
 		   in this case, ignore return code */ 
 		if (strstr(line,"medium not present")) {
+			found = 1;
+		}
+		if (strstr(line,"Device not ready")) {
 			found = 1;
 		}
 	}
@


1.2
log
@Changes from maintainer Jolan Luff <jolan@@cryptonomicon.org>
- cast NULL to (void *) in execl call to make sure it is 64 bit
on 64 bit address systems; per new gcc warning
- Respect ${SYSCONFDIR}, ${LOCALBASE}
- fix some formatting
@
text
@d1 1
a1 1
$OpenBSD: patch-io_c,v 1.1.1.1 2002/07/14 19:34:28 wilfried Exp $
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
$OpenBSD$
d41 9
@


1.1.1.1
log
@Import of xcdroast-0.98alpha9, from Jolan Luff <jolan@@enteract.com>

X-CD-Roast is a program dedicated to easy CD creation under most
UNIX platforms.  It combines command line tools like cdrecord,
cdda2wav, and mkisofs into a nice graphical user interface.
@
text
@@
