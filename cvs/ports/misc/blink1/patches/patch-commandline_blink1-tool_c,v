head	1.1;
access;
symbols
	OPENBSD_6_1:1.1.0.6
	OPENBSD_6_1_BASE:1.1
	OPENBSD_6_0:1.1.0.4
	OPENBSD_6_0_BASE:1.1
	OPENBSD_5_9:1.1.0.2
	OPENBSD_5_9_BASE:1.1;
locks; strict;
comment	@# @;


1.1
date	2015.12.23.10.53.54;	author bluhm;	state Exp;
branches;
next	;
commitid	mSNKIWDrDNYMhaAY;


desc
@@


1.1
log
@Update blink1 to 1.98.  Replace sprintf() and strcpy() with snprintf()
and strncpy() to avoid linker warnings.  Fix a bus error that occurs
when pulling the blink(1) device from the USB port while running
blink1-tool --blink.
OK jung@@
@
text
@$OpenBSD$
--- commandline/blink1-tool.c.orig	Wed Sep  9 03:06:56 2015
+++ commandline/blink1-tool.c	Wed Dec 23 00:00:26 2015
@@@@ -509,7 +509,7 @@@@ int main(int argc, char** argv)
             dev = blink1_openById( deviceIds[0] );
             rc = blink1_getVersion(dev);
             blink1_close(dev);
-            sprintf(verbuf, ", fw version: %d", rc);
+            snprintf(verbuf, sizeof(verbuf), ", fw version: %d", rc);
         }
         msg("blink1-tool version: %s%s\n",BLINK1_VERSION,verbuf);
         exit(0);
@@@@ -741,7 +741,8 @@@@ int main(int argc, char** argv)
             do_rand =1;
         }
         char ledstr[16];
-        sprintf(ledstr, "#%2.2x%2.2x%2.2x", rgbbuf.r,rgbbuf.g,rgbbuf.b);
+        snprintf(ledstr, sizeof(ledstr), "#%2.2x%2.2x%2.2x",
+            rgbbuf.r,rgbbuf.g,rgbbuf.b);
         msg("chase effect %d to %d (with %d leds), color %s, ",
             led_start, led_end, chase_length,
             ((do_rand) ? "random" : ledstr));
@
