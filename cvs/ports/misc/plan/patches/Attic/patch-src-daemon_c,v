head	1.2;
access;
symbols
	OPENBSD_3_7:1.1.0.22
	OPENBSD_3_7_BASE:1.1
	OPENBSD_3_6:1.1.0.20
	OPENBSD_3_6_BASE:1.1
	OPENBSD_3_5:1.1.0.18
	OPENBSD_3_5_BASE:1.1
	OPENBSD_3_4:1.1.0.16
	OPENBSD_3_4_BASE:1.1
	OPENBSD_3_3:1.1.0.14
	OPENBSD_3_3_BASE:1.1
	OPENBSD_3_2:1.1.0.12
	OPENBSD_3_2_BASE:1.1
	OPENBSD_3_1:1.1.0.10
	OPENBSD_3_1_BASE:1.1
	OPENBSD_3_0:1.1.0.8
	OPENBSD_3_0_BASE:1.1
	OPENBSD_2_9_TRACKING_SWITCH:1.1
	OPENBSD_2_9:1.1.0.6
	OPENBSD_2_9_BASE:1.1
	OPENBSD_2_8:1.1.0.4
	OPENBSD_2_8_BASE:1.1
	OPENBSD_2_7:1.1.0.2
	OPENBSD_2_7_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2005.08.10.07.53.44;	author mbalmer;	state dead;
branches;
next	1.1;

1.1
date	2000.04.21.21.26.18;	author turan;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Update to plan version 1.9

help & comments sturm@@ and bernd ahlers, sturm@@ ok
@
text
@--- src/daemon.c.orig	Tue Apr  1 14:40:28 1997
+++ src/daemon.c	Sun Jun 22 14:17:04 1997
@@@@ -68,6 +68,14 @@@@
 void *toplevel = 0;		/* dummy for formfile.c */
 #endif
 
+#if (defined BSD && !defined OSF)
+typedef union wait wait_type;
+#define WAIT_STATUS(x) (x.w_status)
+#else
+typedef int wait_type;
+#define WAIT_STATUS(x) (x)
+#endif
+
 static void popup_window(), send_mail(), write_script(), exec_program();
 static char *get_subject(), *get_subtitle(), *get_icontitle();
 #ifdef MIPS
@@@@ -210,6 +218,7 @@@@
 			sleep(twait);
 #endif
 			refresh_lock(LOCK_PATH);
+#ifndef RABBITS
 #ifdef SUN
 			if (pw) {
 			    struct utmp	ut;
@@@@ -259,6 +268,7 @@@@
 			    }
 			}
 #endif
+#endif
 			total_wait -= twait;
 		    }
 		}
@@@@ -411,12 +421,10 @@@@
 	int sig;
 {
 	char			path[40];	/* script to delete */
-#if (defined BSD && !defined OSF)
-	union wait		dummy;
-#else
-	int			dummy;
-#endif
-	sprintf(path, "/tmp/pland%d", wait(&dummy));
+	wait_type               dummy;
+
+	sprintf(path, "/tmp/pland%d", wait(&WAIT_STATUS(dummy)));
+
 	if (debug)
 		printf("%s: deleting script \"%s\"\n", progname, path);
 	(void)unlink(path);
@


1.1
log
@reorder patches and fix broken port.
@
text
@@

