head	1.29;
access;
symbols
	OPENBSD_6_1:1.29.0.6
	OPENBSD_6_1_BASE:1.29
	OPENBSD_6_0:1.29.0.4
	OPENBSD_6_0_BASE:1.29
	OPENBSD_5_9:1.29.0.2
	OPENBSD_5_9_BASE:1.29
	OPENBSD_5_8:1.27.0.4
	OPENBSD_5_8_BASE:1.27
	OPENBSD_5_7:1.21.0.2
	OPENBSD_5_7_BASE:1.21
	OPENBSD_5_6:1.19.0.2
	OPENBSD_5_6_BASE:1.19
	OPENBSD_5_5:1.18.0.4
	OPENBSD_5_5_BASE:1.18
	OPENBSD_5_4:1.18.0.2
	OPENBSD_5_4_BASE:1.18
	OPENBSD_5_3:1.16.0.2
	OPENBSD_5_3_BASE:1.16
	OPENBSD_5_2:1.15.0.2
	OPENBSD_5_2_BASE:1.15
	OPENBSD_5_1_BASE:1.14
	OPENBSD_5_1:1.14.0.2
	OPENBSD_5_0:1.10.0.2
	OPENBSD_5_0_BASE:1.10
	OPENBSD_4_9:1.4.0.2
	OPENBSD_4_9_BASE:1.4
	OPENBSD_4_8:1.1.1.1.0.4
	OPENBSD_4_8_BASE:1.1.1.1
	OPENBSD_4_7:1.1.1.1.0.2
	OPENBSD_4_7_BASE:1.1.1.1
	msf_20091112:1.1.1.1
	msf:1.1.1;
locks; strict;
comment	@# @;


1.29
date	2015.11.10.15.41.47;	author sebastia;	state Exp;
branches;
next	1.28;
commitid	NlYjLBRFisjvvWnh;

1.28
date	2015.11.05.10.49.03;	author jasper;	state Exp;
branches;
next	1.27;
commitid	av19uy3kiusu7oQR;

1.27
date	2015.07.10.17.10.09;	author jasper;	state Exp;
branches;
next	1.26;
commitid	SOYIZNizvYNoe91F;

1.26
date	2015.06.24.06.50.19;	author jasper;	state Exp;
branches;
next	1.25;
commitid	j9e6rEKPQs9wW2iM;

1.25
date	2015.06.23.16.38.10;	author jasper;	state Exp;
branches;
next	1.24;
commitid	vQirt5gq1WScVB6u;

1.24
date	2015.06.22.13.08.20;	author jasper;	state Exp;
branches;
next	1.23;
commitid	jGSzLxzI7U7pgVEu;

1.23
date	2015.05.08.09.08.44;	author espie;	state Exp;
branches;
next	1.22;
commitid	8WaxsMNN6opOzn9t;

1.22
date	2015.04.18.13.35.27;	author schwarze;	state Exp;
branches;
next	1.21;
commitid	BCzeSMZntRA6GlN0;

1.21
date	2015.02.10.17.53.51;	author sebastia;	state Exp;
branches;
next	1.20;
commitid	2XhkpcjyLTZ838Mv;

1.20
date	2014.12.29.09.28.22;	author jasper;	state Exp;
branches;
next	1.19;
commitid	zUi7VaiTOe5qi2IN;

1.19
date	2014.05.13.22.57.26;	author sthen;	state Exp;
branches;
next	1.18;

1.18
date	2013.06.04.07.57.13;	author fgsch;	state Exp;
branches;
next	1.17;

1.17
date	2013.03.11.11.35.56;	author espie;	state Exp;
branches;
next	1.16;

1.16
date	2012.08.04.15.28.14;	author ajacoutot;	state Exp;
branches;
next	1.15;

1.15
date	2012.07.18.14.03.44;	author jasper;	state Exp;
branches;
next	1.14;

1.14
date	2012.01.13.20.54.25;	author sthen;	state Exp;
branches;
next	1.13;

1.13
date	2011.12.17.22.01.13;	author sthen;	state Exp;
branches;
next	1.12;

1.12
date	2011.10.01.08.30.37;	author jasper;	state Exp;
branches;
next	1.11;

1.11
date	2011.09.16.11.13.40;	author espie;	state Exp;
branches;
next	1.10;

1.10
date	2011.07.08.04.31.57;	author ajacoutot;	state Exp;
branches;
next	1.9;

1.9
date	2011.06.15.11.02.59;	author landry;	state Exp;
branches;
next	1.8;

1.8
date	2011.06.08.18.00.50;	author jasper;	state Exp;
branches;
next	1.7;

1.7
date	2011.04.28.11.28.43;	author landry;	state Exp;
branches;
next	1.6;

1.6
date	2011.04.16.13.54.51;	author ajacoutot;	state Exp;
branches;
next	1.5;

1.5
date	2011.04.16.09.11.07;	author landry;	state Exp;
branches;
next	1.4;

1.4
date	2010.11.19.22.31.37;	author espie;	state Exp;
branches;
next	1.3;

1.3
date	2010.10.18.18.36.57;	author espie;	state Exp;
branches;
next	1.2;

1.2
date	2010.08.30.21.21.54;	author sthen;	state Exp;
branches;
next	1.1;

1.1
date	2009.11.12.13.10.33;	author msf;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2009.11.12.13.10.33;	author msf;	state Exp;
branches;
next	;


desc
@@


1.29
log
@Switch from erlang 16 to erlang 18, which now allows me to secure
communication with SSL which I was unable to get to work with erlang 16.

OK jasper@@
@
text
@# $OpenBSD: Makefile,v 1.28 2015/11/05 10:49:03 jasper Exp $

COMMENT =	highly reliable Enterprise Messaging System

V =		3.5.6
REVISION =	0
DISTNAME =	rabbitmq-server-$V
PKGNAME =	rabbitmq-$V
CATEGORIES =	net

HOMEPAGE =	http://www.rabbitmq.com/

MAINTAINER =	Sebastian Reitenbach <sebastia@@openbsd.org>

# MPL
PERMIT_PACKAGE_CDROM = Yes

MASTER_SITES =	http://www.rabbitmq.com/releases/rabbitmq-server/v${V}/

MODULES =	lang/erlang \
		lang/python
MODERL_VERSION = 18
MODPY_RUNDEP =	No

USE_GMAKE =	Yes
CONFIGURE_STYLE = none

BUILD_DEPENDS =	archivers/unzip \
		archivers/zip \
		textproc/docbook \
		textproc/docbook-xsl \
		textproc/libxslt \
		textproc/xmlto

MAKE_ENV =	PYTHON=${MODPY_BIN} VERSION=${V}

RABBITUSER =	_rabbitmq

SUBST_VARS +=	RABBITUSER V

MODPY_ADJ_FILES +=	plugins-src/rabbitmq-amqp1.0/codegen.py
MODPY_ADJ_FILES +=	plugins-src/rabbitmq-management/bin/rabbitmqadmin

NO_TEST =	Yes

pre-build:
	${SUBST_CMD} ${WRKSRC}/scripts/rabbitmqctl \
		${WRKSRC}/scripts/rabbitmq-defaults

post-install:
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/rabbitmq
	@@for file in INSTALL LICENSE*; do \
		mv ${PREFIX}/lib/rabbitmq/$$file \
			${PREFIX}/share/doc/rabbitmq; \
	done
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/rabbitmq
	${SUBST_CMD} -m 0644 -c ${FILESDIR}/rabbitmq.conf \
		${PREFIX}/share/examples/rabbitmq/rabbitmq-env.conf

.include <bsd.port.mk>
@


1.28
log
@- update to rabbitmq-server-3.5.6
- sebastia@@ takes over maintainership

OK sebastia@@ and piotr sikori (previous MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2015/07/10 17:10:09 jasper Exp $
d6 1
d22 1
@


1.27
log
@bump after erlang dependency change

reminded by aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2015/06/24 06:50:19 jasper Exp $
d5 1
a5 2
V =		3.4.2
REVISION =	4
d12 1
a12 1
MAINTAINER =	Piotr Sikora <piotr.sikora@@frickle.com>
d45 2
a46 1
	${SUBST_CMD} ${WRKSRC}/scripts/rabbitmqctl
@


1.26
log
@switch to using the erlang module
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2015/06/23 16:38:10 jasper Exp $
d6 1
a6 1
REVISION =	3
@


1.25
log
@tidy up erlang dependencies
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2015/06/22 13:08:20 jasper Exp $
d6 1
a6 1
REVISION =	2
d20 2
a21 1
MODULES =	lang/python
d27 1
a27 2
BUILD_DEPENDS =	${RUN_DEPENDS} \
		archivers/unzip \
a33 2
RUN_DEPENDS =	lang/erlang/16

d40 1
a40 1
MODPY_ADJ_FILES +=	plugins-src/rabbitmq-amqp1.0/codegen.py 
@


1.24
log
@bump after MODERL_RUN_DEPENDS change
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2015/05/08 09:08:44 espie Exp $
d6 1
a6 1
REVISION =	1
d34 1
a34 1
RUN_DEPENDS =	lang/erlang>=15b.01p0v0
@


1.23
log
@don't depend on modes in the ports tree being what we want installed
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2015/04/18 13:35:27 schwarze Exp $
d6 1
a6 1
REVISION =	0
@


1.22
log
@Drop USE_GROFF (almost exclusively additional blank lines).  No bump needed.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2015/02/10 17:53:51 sebastia Exp $
d57 1
a57 1
	${SUBST_CMD} -c ${FILESDIR}/rabbitmq.conf \
@


1.21
log
@ * add proper python shebang to rabbitmqadmin plugin command line tool,
 * unbreak rabbitmqctl eval '' and friends, the patch to rabbitmqctl
   that existed to run the code seems to be superfluous, and broke that

OK jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2014/12/29 09:28:22 jasper Exp $
a23 2
USE_GROFF =	Yes

@


1.20
log
@- update to rabbitmq-3.4.2

ok MAINTAINER
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2014/05/13 22:57:26 sthen Exp $
d6 1
d44 2
a45 1
MODPY_ADJ_FILES =	plugins-src/rabbitmq-amqp1.0/codegen.py
@


1.19
log
@missing build dep on docbook-xsl; without it, it tries to fetch as an
xml external entity over the network at build time.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2013/06/04 07:57:13 fgsch Exp $
d5 1
a5 1
V =		2.8.4
a8 1
REVISION =	1
d43 3
a45 4
# help 'make update-patches' work.  if upstream do this often,
# consider PATCHORIG and regenerating patches.
post-extract:
	rm ${WRKSRC}/plugins-src/mochiweb-wrapper/mochiweb-git/src/mochiweb_request.erl.orig
d57 1
a57 1
	${INSTALL_DATA} ${FILESDIR}/rabbitmq.conf \
@


1.18
log
@Remove MODPY_JSON from RDEP and bump.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2013/03/11 11:35:56 espie Exp $
d32 1
@


1.17
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2012/08/04 15:28:14 ajacoutot Exp $
d9 1
a9 1
REVISION =	0
a28 1
		${MODPY_JSON} \
@


1.16
log
@Set rc_usercheck to NO.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2012/07/18 14:03:44 jasper Exp $
a16 3
PERMIT_PACKAGE_FTP = Yes
PERMIT_DISTFILES_CDROM = Yes
PERMIT_DISTFILES_FTP = Yes
@


1.15
log
@- update to 2.8.4

from piotr sikora (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2012/01/13 20:54:25 sthen Exp $
d9 1
@


1.14
log
@update RabbitMQ to 2.7.1

- disable unnecessary use of nmap/lsof
- from maintainer Piotr Sikora with small tweaks from me
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2011/12/17 22:01:13 sthen Exp $
d5 1
a5 1
V =		2.7.1
d38 1
a38 1
RUN_DEPENDS =	lang/erlang
@


1.13
log
@Where a program with an rc script _requires_ a certain command line
parameter to daemonize, move the parameter from daemon to daemon_flags,
so that the user cannot inadvertently prevent it from daemonizing by
adjusting the flags.

Discussed with ajacoutot and schwarze, this method was suggested
by schwarze@@ as a simpler alternative to my diff. ok aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2011/10/01 08:30:37 jasper Exp $
d5 1
a5 2
V =		2.6.1
REVISION =	0
d23 1
a23 1
MODPY_RUNDEPS =	No
d32 3
d40 1
a40 1
MAKE_ENV =	PYTHON=${MODPY_BIN}
d44 6
a49 1
SUBST_VARS +=	RABBITUSER
d56 1
a56 1
	@@for file in INSTALL LICENSE LICENSE-MPL-RabbitMQ ; do \
@


1.12
log
@- update to 2.6.1

from Piotr Sikora (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2011/09/16 11:13:40 espie Exp $
d6 1
@


1.11
log
@normalize pkgpath
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2011/07/08 04:31:57 ajacoutot Exp $
d5 1
a5 1
V =		2.5.0
a8 2

REVISION =	1
@


1.10
log
@Add a small comment to the rc script -- no functionnal change.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2011/06/15 11:02:59 landry Exp $
d10 1
a10 1
REVISION =	0
@


1.9
log
@Update to rabbitmq 2.5.0, from MAINTAINER Piotr Sikora.
Regress target still SIGBUSes on sparc64..
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2011/06/08 18:00:50 jasper Exp $
d9 2
@


1.8
log
@bump after default python version switch
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2011/04/28 11:28:43 landry Exp $
d5 1
a5 1
V =		2.4.1
a8 2

REVISION =	2
@


1.7
log
@Various fixes from Piotr Sikora (maintainer) :
- simplify rabbitmqctl diff, use su to make sure command is run as ${RABBITUSER}
- change _rabbitmq shell to /sbin/nologin,
- remove redundant setting of PYTHON,
- remove unnecessary SUBST_CMD calls,
- remove trailing space in MAKE_ENV.
discussed with maintainer and ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2011/04/16 13:54:51 ajacoutot Exp $
d10 1
a10 1
REVISION =	1
@


1.6
log
@Tweak rc script:
* make rc_check return 1 in case the daemon is not running
* proper indent
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2011/04/16 09:11:07 landry Exp $
d10 1
a10 1
REVISION =	0
d39 1
a39 1
MAKE_ENV =	PYTHON=${MODPY_BIN} 
d43 1
a43 1
SUBST_VARS +=	RABBITUSER MODPY_VERSION
d46 1
a46 3
	${SUBST_CMD} ${WRKSRC}/scripts/rabbitmqctl \
		${WRKSRC}/scripts/rabbitmq-env \
		${WRKSRC}/Makefile
@


1.5
log
@Update to rabbitMQ 2.4.1, joint work from viq & Piotr Sikora, with small
tweaks by me (don't silent SUBST_CMD, no need to cvs rm/add
files/rabbitmq.conf as it can be installed with the correct name)

- add rc script, remove pkg/MESSAGE
- fix rabbitmqctl args passing
- install config file as rabbitmq-env.conf

Needed by an upcoming erlang update..

Maintainer timeout, Piotr Sikora takes maintainership.
ok stuartslolbunny@@ (!?)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2010/10/18 18:36:57 espie Exp $
d9 2
@


1.4
log
@new depends
@
text
@d5 1
a5 1
V =		1.6.0
a7 1
REVISION =	0
d12 1
a12 1
MAINTAINER =	Mathieu Sauve-Frankel <msf@@openbsd.org>
d31 4
a34 1
		devel/py-simplejson
d39 4
d44 3
a46 3
	@@${SUBST_CMD} ${WRKSRC}/scripts/rabbitmqctl \
		${WRKSRC}/scripts/rabbitmq-multi \
		${WRKSRC}/scripts/rabbitmq-server
d56 1
a56 1
		${PREFIX}/share/examples/rabbitmq/
@


1.3
log
@USE_GROFF=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2010/08/30 21:21:54 sthen Exp $
d32 2
a33 2
		::devel/py-simplejson
RUN_DEPENDS =	::lang/erlang
@


1.2
log
@bumps for new python
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2009/11/12 13:10:33 msf Exp $
d27 1
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d8 1
@


1.1.1.1
log
@initial import of rabbitmq-1.6.0

RabbitMQ is a complete and highly reliable Enterprise Messaging 
System. The RabbitMQ client libraries and broker daemon can be used 
together to create an AMQP network, or used individually to bring 
the benefits of RabbitMQ to established networks. 

ok bernd@@
@
text
@@
