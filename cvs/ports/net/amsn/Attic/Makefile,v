head	1.31;
access;
symbols
	OPENBSD_5_9:1.29.0.8
	OPENBSD_5_9_BASE:1.29
	OPENBSD_5_8:1.29.0.10
	OPENBSD_5_8_BASE:1.29
	OPENBSD_5_7:1.29.0.6
	OPENBSD_5_7_BASE:1.29
	OPENBSD_5_6:1.29.0.4
	OPENBSD_5_6_BASE:1.29
	OPENBSD_5_5:1.29.0.2
	OPENBSD_5_5_BASE:1.29
	OPENBSD_5_4:1.28.0.2
	OPENBSD_5_4_BASE:1.28
	OPENBSD_5_3:1.25.0.2
	OPENBSD_5_3_BASE:1.25
	OPENBSD_5_2:1.21.0.2
	OPENBSD_5_2_BASE:1.21
	OPENBSD_5_1_BASE:1.20
	OPENBSD_5_1:1.20.0.2
	OPENBSD_5_0:1.19.0.2
	OPENBSD_5_0_BASE:1.19
	OPENBSD_4_9:1.15.0.2
	OPENBSD_4_9_BASE:1.15
	OPENBSD_4_8:1.9.0.2
	OPENBSD_4_8_BASE:1.9
	OPENBSD_4_7:1.8.0.2
	OPENBSD_4_7_BASE:1.8
	OPENBSD_4_6:1.6.0.2
	OPENBSD_4_6_BASE:1.6
	OPENBSD_4_5:1.5.0.2
	OPENBSD_4_5_BASE:1.5
	OPENBSD_4_4:1.3.0.4
	OPENBSD_4_4_BASE:1.3
	OPENBSD_4_3:1.3.0.2
	OPENBSD_4_3_BASE:1.3
	steven-20071022:1.1.1.1
	steven:1.1.1;
locks; strict;
comment	@# @;


1.31
date	2016.04.21.20.28.26;	author naddy;	state dead;
branches;
next	1.30;
commitid	iy5UPuNw6GqcOIVp;

1.30
date	2016.04.04.16.09.09;	author naddy;	state Exp;
branches;
next	1.29;
commitid	u3lQjrjlcAL26lGp;

1.29
date	2013.11.09.18.22.02;	author zhuk;	state Exp;
branches;
next	1.28;

1.28
date	2013.06.04.18.41.54;	author naddy;	state Exp;
branches;
next	1.27;

1.27
date	2013.06.01.14.18.40;	author ajacoutot;	state Exp;
branches;
next	1.26;

1.26
date	2013.03.11.11.35.45;	author espie;	state Exp;
branches;
next	1.25;

1.25
date	2012.09.30.07.49.04;	author jasper;	state Exp;
branches;
next	1.24;

1.24
date	2012.09.28.14.25.06;	author jasper;	state Exp;
branches;
next	1.23;

1.23
date	2012.08.13.14.07.01;	author naddy;	state Exp;
branches;
next	1.22;

1.22
date	2012.08.12.17.33.04;	author jasper;	state Exp;
branches;
next	1.21;

1.21
date	2012.04.05.16.08.55;	author jasper;	state Exp;
branches;
next	1.20;

1.20
date	2011.09.23.20.57.16;	author sthen;	state Exp;
branches;
next	1.19;

1.19
date	2011.07.15.11.10.40;	author naddy;	state Exp;
branches;
next	1.18;

1.18
date	2011.07.08.20.38.00;	author naddy;	state Exp;
branches;
next	1.17;

1.17
date	2011.07.07.13.14.29;	author jasper;	state Exp;
branches;
next	1.16;

1.16
date	2011.03.31.16.41.30;	author ajacoutot;	state Exp;
branches;
next	1.15;

1.15
date	2010.11.19.22.31.32;	author espie;	state Exp;
branches;
next	1.14;

1.14
date	2010.11.11.11.54.08;	author espie;	state Exp;
branches;
next	1.13;

1.13
date	2010.09.14.18.34.14;	author jasper;	state Exp;
branches;
next	1.12;

1.12
date	2010.09.14.12.35.58;	author jasper;	state Exp;
branches;
next	1.11;

1.11
date	2010.09.14.12.35.12;	author jasper;	state Exp;
branches;
next	1.10;

1.10
date	2010.09.14.12.34.42;	author jasper;	state Exp;
branches;
next	1.9;

1.9
date	2010.07.12.22.07.37;	author sthen;	state Exp;
branches;
next	1.8;

1.8
date	2009.12.22.00.31.22;	author sthen;	state Exp;
branches;
next	1.7;

1.7
date	2009.08.10.06.33.43;	author kili;	state Exp;
branches;
next	1.6;

1.6
date	2009.03.11.21.38.40;	author sthen;	state Exp;
branches;
next	1.5;

1.5
date	2009.02.11.20.22.45;	author pea;	state Exp;
branches;
next	1.4;

1.4
date	2008.08.31.17.16.22;	author steven;	state Exp;
branches;
next	1.3;

1.3
date	2008.02.02.21.17.49;	author steven;	state Exp;
branches;
next	1.2;

1.2
date	2007.12.15.21.00.30;	author ajacoutot;	state Exp;
branches;
next	1.1;

1.1
date	2007.10.22.19.32.24;	author steven;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2007.10.22.19.32.24;	author steven;	state Exp;
branches;
next	;


desc
@@


1.31
log
@remove clients for discontinued Microsoft Messenger service
noticed by Frederic Cambus
@
text
@#$OpenBSD: Makefile,v 1.30 2016/04/04 16:09:09 naddy Exp $

COMMENT=	open source MSN Messenger clone

V=		0.98.9
DISTNAME=	amsn-$V-src
PKGNAME=	${DISTNAME:S/-src//}
REVISION=	5
CATEGORIES=	net

HOMEPAGE=	http://www.amsn-project.net/

MAINTAINER=	Azwaw OUSADOU <bsdmaniak@@gmail.com>

# GPLv2
PERMIT_PACKAGE_CDROM=   Yes

MASTER_SITES=	${MASTER_SITE_SOURCEFORGE:=project/amsn/amsn/${V}/}
EXTRACT_SUFX=	.tar.bz2

WANTLIB += ICE SM X11 jpeg m png stdc++ z

LIB_DEPENDS=	graphics/jpeg \
		graphics/png
RUN_DEPENDS+=	${MODTK_RUN_DEPENDS} \
		security/tcltls \
		x11/bwidget \
		devel/desktop-file-utils
BUILD_DEPENDS=	${MODTK_BUILD_DEPENDS} \
		security/tcltls

MODTK_THREADED= Yes
MODULES=	devel/gettext \
		x11/tk

USE_GMAKE=	Yes
MAKE_FLAGS=	verbose=yes
CONFIGURE_STYLE=gnu
CONFIGURE_ARGS+=--disable-libv4l \
		--disable-upnp \
		--with-tcl="${MODTCL_LIBDIR}" \
		--with-tk="${MODTK_LIBDIR}"

CONFIGURE_ENV+=	CPPFLAGS="-I${X11BASE}/include -I${LOCALBASE}/include" \
		LDFLAGS="-lm -L${LOCALBASE}/lib" \
		TK_INC_SPEC="${MODTK_INCDIR}/generic" \
		TCLSH="${MODTCL_BIN}"

WRKDIST=	${WRKDIR}/amsn-$V/

NO_TEST=	Yes # Generic tcl/tk tests.

pre-configure:
	@@${SUBST_CMD} ${WRKSRC}/amsn*
	@@${MODTCL_WISH_ADJ} ${WRKSRC}/amsn

post-install:
.for a in amsn amsn-remote amsn-remote-CLI
	cd ${PREFIX}/bin && ln -s ../share/amsn/$a
.endfor
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/amsn
	${INSTALL_DATA} ${WRKSRC}/{FAQ,README} ${PREFIX}/share/doc/amsn
	${INSTALL_DATA} ${WRKSRC}/docs/{FAQ,README}* ${PREFIX}/share/doc/amsn

.include <bsd.port.mk>
@


1.30
log
@g/c PFRAG.shared
@
text
@d1 1
a1 1
#$OpenBSD: Makefile,v 1.29 2013/11/09 18:22:02 zhuk Exp $
@


1.29
log
@Fix MODTCL_TCLSH_ADJ and MODTCL_WISH_ADJ.

Review, input, okay and prodding to commit by stu@@
@
text
@d1 1
a1 1
#$OpenBSD: Makefile,v 1.28 2013/06/04 18:41:54 naddy Exp $
d8 1
a8 1
REVISION=	4
@


1.28
log
@the png headers are now directly under include/
@
text
@d1 1
a1 1
#$OpenBSD: Makefile,v 1.27 2013/06/01 14:18:40 ajacoutot Exp $
d8 1
a8 1
REVISION=	3
@


1.27
log
@Remove pthread patches.
@
text
@d1 1
a1 1
#$OpenBSD: Makefile,v 1.26 2013/03/11 11:35:45 espie Exp $
d44 1
a44 2
CONFIGURE_ENV+=	CPPFLAGS="-I${X11BASE}/include -I${LOCALBASE}/include \
		    -I${LOCALBASE}/include/libpng" \
@


1.26
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
#$OpenBSD: Makefile,v 1.25 2012/09/30 07:49:04 jasper Exp $
d8 1
a8 1
REVISION=	2
@


1.25
log
@- fixup WANTLIB
@
text
@d1 1
a1 1
#$OpenBSD: Makefile,v 1.24 2012/09/28 14:25:06 jasper Exp $
a16 3
PERMIT_PACKAGE_FTP=     Yes
PERMIT_DISTFILES_CDROM= Yes
PERMIT_DISTFILES_FTP=   Yes
d52 1
a52 1
NO_REGRESS=	Yes # Generic tcl/tk tests.
@


1.24
log
@- disable farstream support which is now gstreamer-1.

as discussed with aja@@
@
text
@d1 1
a1 1
#$OpenBSD: Makefile,v 1.23 2012/08/13 14:07:01 naddy Exp $
d8 1
a8 1
REVISION=	1
d24 1
a24 2
WANTLIB=	ICE SM X11 m stdc++ z glib-2.0 gmodule-2.0 gobject-2.0 \
		gthread-2.0 gstbase-0.10 gstreamer-0.10 xml2 jpeg png
@


1.23
log
@0.98.9 does not require access to private libpng data structures any longer
ok maintainer, jasper@@
@
text
@d1 1
a1 1
#$OpenBSD: Makefile,v 1.22 2012/08/12 17:33:04 jasper Exp $
d8 1
a8 1
REVISION=	0
d25 1
a25 2
		gthread-2.0 gstbase-0.10 gstreamer-0.10 xml2 jpeg png \
		farstream-0.1 gstinterfaces-0.10
d28 1
a28 2
		graphics/png \
		net/farstream
@


1.22
log
@- update to 0.98.9

from Azwaw OUSADOU (MAINTAINER)
@
text
@d1 1
a1 1
#$OpenBSD: Makefile,v 1.21 2012/04/05 16:08:55 jasper Exp $
d8 1
d36 1
a36 2
		security/tcltls \
		graphics/png:configure
d51 1
a51 1
		    -I${WRKDIR}/libpng" \
a62 1
	ln -s ${WRKDIR}/graphics/png/libpng-* ${WRKDIR}/libpng
@


1.21
log
@- switch for farsight2 to farstream. all patches taken from upstream repositories.

ok aja@@
@
text
@d1 1
a1 1
#$OpenBSD: Makefile,v 1.20 2011/09/23 20:57:16 sthen Exp $
d5 1
a5 2
V=		0.98.4
REVISION=	0
d24 2
a25 2
		gthread-2.0 gstbase-0.10 gstinterfaces-0.10 \
		gstreamer-0.10 xml2 jpeg png farstream-0.1
a36 1
# CxImage requires access to internal png headers.
a43 1

@


1.20
log
@amsn requires internal headers from libpng; currently this requires a manual
change for every update to png to pass in the correct directory version to
configure. Change this to create a symlink to the dir in pre-configure, and
pass the path to the symlink to configure instead, so png updates don't need
to touch this. Discussed with naddy@@.
@
text
@d1 1
a1 1
#$OpenBSD: Makefile,v 1.19 2011/07/15 11:10:40 naddy Exp $
d6 1
d26 1
a26 1
		gstreamer-0.10 xml2 jpeg png gstfarsight-0.10
d30 1
a30 1
		net/farsight2
d46 1
@


1.19
log
@SECURITY update to png-1.5.4:
1. buffer overwrite in png_rgb_to_gray (CVE-2011-2690)
2. crash in png_default_error due to use of NULL Pointer (CVE-2011-2691)
3. memory corruption when handling empty sCAL chunks (CVE-2011-2692)
@
text
@d1 1
a1 1
#$OpenBSD: Makefile,v 1.18 2011/07/08 20:38:00 naddy Exp $
a9 4
# CxImage requires access to internal png headers.
# This must be in sync with graphics/png
PNG_V=		1.5.4

d37 1
d52 1
a52 1
		    -I${WRKDIR}/graphics/png/libpng-${PNG_V}" \
d64 1
@


1.18
log
@Fix build with png-1.5.
All fixes by yours truly.
@
text
@d1 1
a1 1
#$OpenBSD: Makefile,v 1.17 2011/07/07 13:14:29 jasper Exp $
d12 1
a12 1
PNG_V=		1.5.2
@


1.17
log
@- update to 0.98.4

from Azwaw OUSADOU (MAINTAINER)
@
text
@d1 1
a1 1
#$OpenBSD: Makefile,v 1.16 2011/03/31 16:41:30 ajacoutot Exp $
d10 4
d39 2
a40 1
		security/tcltls
d54 2
a55 1
CONFIGURE_ENV+=	CPPFLAGS="-I${X11BASE}/include -I${LOCALBASE}/include -I${LOCALBASE}/include/libpng" \
@


1.16
log
@Use @@unexec-delete.
@
text
@d1 1
a1 1
#$OpenBSD: Makefile,v 1.15 2010/11/19 22:31:32 espie Exp $
d5 1
a5 1
V=		0.98.3
a7 1
REVISION=	1
d20 1
a20 1
MASTER_SITES=	${MASTER_SITE_SOURCEFORGE:=amsn/${V}/}
a22 1

d44 4
a47 5
CONFIGURE_ARGS=	--with-tcl=${MODTCL_LIBDIR} \
		--with-tk=${MODTK_LIBDIR} \
		--enable-debug \
		--disable-libv4l \
		--disable-upnp
d49 1
a49 1
CONFIGURE_ENV= 	CPPFLAGS="-I${X11BASE}/include -I${LOCALBASE}/include -I${LOCALBASE}/include/libpng" \
@


1.15
log
@new depends
@
text
@d1 1
a1 1
#$OpenBSD: Makefile,v 1.14 2010/11/11 11:54:08 espie Exp $
d8 1
a8 1
REVISION=	0
@


1.14
log
@WANTLIB conversion
@
text
@d1 1
a1 1
#$OpenBSD: Makefile,v 1.13 2010/09/14 18:34:14 jasper Exp $
d29 3
a31 3
LIB_DEPENDS=	::graphics/jpeg \
		::graphics/png \
		::net/farsight2
d33 3
a35 3
		::security/tcltls \
		::x11/bwidget \
		:desktop-file-utils-*:devel/desktop-file-utils
d37 1
a37 1
		::security/tcltls
@


1.13
log
@- azwaw OUSADOU takes maintainership
- remove patch
@
text
@d1 1
a1 1
#$OpenBSD: Makefile,v 1.12 2010/09/14 12:35:58 jasper Exp $
d27 1
a27 1
		gstreamer-0.10 xml2
d29 3
a31 3
LIB_DEPENDS=	jpeg::graphics/jpeg \
		png::graphics/png \
		gstfarsight-0.10::net/farsight2
@


1.12
log
@grmbl, set license version
@
text
@d1 1
a1 1
#$OpenBSD: Makefile,v 1.11 2010/09/14 12:35:12 jasper Exp $
d8 1
d12 2
@


1.11
log
@- missed in previous, no bump as it was committed < 1 minute ago
@
text
@d1 1
a1 1
#$OpenBSD: Makefile,v 1.10 2010/09/14 12:34:42 jasper Exp $
d12 1
a12 1
# GPL
d37 1
a37 1
MODULES=	devel/gettxt \
@


1.10
log
@- update amsn to 0.98.3

from Azwaw OUSADOU, with some tweaks by me
@
text
@d1 1
a1 1
#$OpenBSD: Makefile,v 1.9 2010/07/12 22:07:37 sthen Exp $
d23 1
a23 1
		gthread-2.0 iconv intl gstbase-0.10 gstinterfaces-0.10 \
d37 2
a38 1
MODULES=	x11/tk
@


1.9
log
@use REVISION, checked with before/after make show=PKGNAMES (plus some
extra-careful checking where there are complicated PSEUDO_FLAVORS).
@
text
@d1 1
a1 1
#$OpenBSD: Makefile,v 1.8 2009/12/22 00:31:22 sthen Exp $
d5 3
a7 2
DISTNAME=	amsn-0.97.2
REVISION=	3
d18 1
a18 1
MASTER_SITES=	${MASTER_SITE_SOURCEFORGE:=amsn/}
d21 4
a24 1
WANTLIB=	ICE SM X11 m pthread-stubs stdc++ xcb z
d27 2
a28 1
		png::graphics/png
d36 1
d43 4
a46 1
		--with-tk=${MODTK_LIBDIR}
d48 2
a49 2
CONFIGURE_ENV= 	CPPFLAGS="-I${LOCALBASE}/include -I${LOCALBASE}/include/libpng" \
		LDFLAGS="-lm -L${LOCALBASE}/lib -fPIC" \
d53 4
d59 1
@


1.8
log
@Use @@unexec-delete instead of @@unexec for the *-update-* goos.
prodded by espie@@
discussed with espie@@ ajacoutot@@ landry@@
@
text
@d1 1
a1 1
#$OpenBSD: Makefile,v 1.7 2009/08/10 06:33:43 kili Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p3
@


1.7
log
@WANTLIB changes after xcb addition and bump.
@
text
@d1 1
a1 1
#$OpenBSD: Makefile,v 1.6 2009/03/11 21:38:40 sthen Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p2
@


1.6
log
@bump following tk dep changes
@
text
@d1 1
a1 1
#$OpenBSD: Makefile,v 1.5 2009/02/11 20:22:45 pea Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p1
d20 1
a20 1
WANTLIB=	ICE SM X11 m z stdc++
@


1.5
log
@Fixes amsn startup.
Patch from Azwaw Ousadou <bsdmaniak at gmail.com>, thanks.

ok ajacoutot@@
@
text
@d1 1
a1 1
#$OpenBSD: Makefile,v 1.4 2008/08/31 17:16:22 steven Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p0
@


1.4
log
@update to 0.97.2

similar diff from bsdmaniak at gmail
@
text
@d1 1
a1 1
#$OpenBSD: Makefile,v 1.3 2008/02/02 21:17:49 steven Exp $
d6 1
@


1.3
log
@update to 0.97

based on a diff by Azwaw Ousadou (bsdmaniak at gmail)
@
text
@d1 1
a1 1
#$OpenBSD: Makefile,v 1.2 2007/12/15 21:00:30 ajacoutot Exp $
d5 1
a5 1
DISTNAME=	amsn-0.97
d23 1
a23 1
RUN_DEPENDS=	:tk-8.4.*:x11/tk/8.4 \
d27 1
a27 1
BUILD_DEPENDS= 	:tk-8.4.*:x11/tk/8.4 \
d30 2
d35 2
a36 2
CONFIGURE_ARGS=	--with-tcl=${LOCALBASE}/lib/tcl8.4 \
		--with-tk=${LOCALBASE}/lib/tk8.4
d40 2
a41 2
		TK_INC_SPEC="${LOCALBASE}/include/tk8.4/generic" \
		TCLSH="${LOCALBASE}/bin/tclsh8.4"
d44 1
a44 1
	perl -pi -e 's|__LOCALBASE__|${LOCALBASE}|' ${WRKSRC}/amsn*
@


1.2
log
@- add update-desktop-database goo

This port will eventually needs the gtk-update-icon-cache goo, but we're
still trying to figure out how to do this without run_depends on gtk+2
discussed with jasper@@
@
text
@d1 1
a1 1
#$OpenBSD: Makefile,v 1.1.1.1 2007/10/22 19:32:24 steven Exp $
d5 1
a5 2
DISTNAME=	amsn-0.96
PKGNAME=	${DISTNAME}p0
d32 1
a32 1
CONFIGURE_STYLE=gnu dest
a42 1
	perl -pi -e 's|AMSN_BWidget|BWidget|' ${WRKSRC}/*.tcl
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
#$OpenBSD$
d6 1
d26 2
a27 1
		::x11/bwidget
@


1.1.1.1
log
@MSN messenger clone
@
text
@@
