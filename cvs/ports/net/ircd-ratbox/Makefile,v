head	1.28;
access;
symbols
	OPENBSD_6_1:1.27.0.2
	OPENBSD_6_1_BASE:1.27
	OPENBSD_6_0:1.25.0.2
	OPENBSD_6_0_BASE:1.25
	OPENBSD_5_9:1.23.0.2
	OPENBSD_5_9_BASE:1.23
	OPENBSD_5_8:1.20.0.10
	OPENBSD_5_8_BASE:1.20
	OPENBSD_5_7:1.20.0.6
	OPENBSD_5_7_BASE:1.20
	OPENBSD_5_6:1.20.0.4
	OPENBSD_5_6_BASE:1.20
	OPENBSD_5_5:1.20.0.2
	OPENBSD_5_5_BASE:1.20
	OPENBSD_5_4:1.19.0.2
	OPENBSD_5_4_BASE:1.19
	OPENBSD_5_3:1.17.0.2
	OPENBSD_5_3_BASE:1.17
	OPENBSD_5_2:1.16.0.2
	OPENBSD_5_2_BASE:1.16
	OPENBSD_5_1_BASE:1.15
	OPENBSD_5_1:1.15.0.2
	OPENBSD_5_0:1.13.0.2
	OPENBSD_5_0_BASE:1.13
	OPENBSD_4_9:1.12.0.2
	OPENBSD_4_9_BASE:1.12
	OPENBSD_4_8:1.6.0.2
	OPENBSD_4_8_BASE:1.6
	OPENBSD_4_7:1.5.0.2
	OPENBSD_4_7_BASE:1.5
	OPENBSD_4_6:1.2.0.2
	OPENBSD_4_6_BASE:1.2
	OPENBSD_4_5:1.1.1.1.0.2
	OPENBSD_4_5_BASE:1.1.1.1
	simon_20090209:1.1.1.1
	simon:1.1.1;
locks; strict;
comment	@# @;


1.28
date	2017.09.22.21.37.18;	author sthen;	state Exp;
branches;
next	1.27;
commitid	vOwcbJQSn1uHO6ug;

1.27
date	2016.11.08.21.53.16;	author sthen;	state Exp;
branches;
next	1.26;
commitid	4dibJeZunzEGIeW6;

1.26
date	2016.09.23.09.16.56;	author sthen;	state Exp;
branches;
next	1.25;
commitid	XLnI6AbHAmyVU5mO;

1.25
date	2016.03.16.21.19.38;	author naddy;	state Exp;
branches;
next	1.24;
commitid	eS3Ayl3CL8hkKETd;

1.24
date	2016.03.07.07.12.44;	author ajacoutot;	state Exp;
branches;
next	1.23;
commitid	x0zUTd0g88tjLEVR;

1.23
date	2015.12.20.07.52.43;	author ajacoutot;	state Exp;
branches;
next	1.22;
commitid	6JWDgLHp3KSWD8ZJ;

1.22
date	2015.12.16.06.42.57;	author ajacoutot;	state Exp;
branches;
next	1.21;
commitid	aR0NHkaY2pRGj9Ld;

1.21
date	2015.11.05.19.08.58;	author jca;	state Exp;
branches;
next	1.20;
commitid	UGP8xDGOujwrZOVl;

1.20
date	2013.10.31.01.25.07;	author brad;	state Exp;
branches
	1.20.10.1;
next	1.19;

1.19
date	2013.03.21.08.46.34;	author ajacoutot;	state Exp;
branches;
next	1.18;

1.18
date	2013.03.11.11.35.48;	author espie;	state Exp;
branches;
next	1.17;

1.17
date	2012.12.31.22.53.43;	author brad;	state Exp;
branches;
next	1.16;

1.16
date	2012.04.23.17.15.18;	author espie;	state Exp;
branches
	1.16.2.1;
next	1.15;

1.15
date	2011.11.27.10.57.24;	author fgsch;	state Exp;
branches;
next	1.14;

1.14
date	2011.09.16.11.13.38;	author espie;	state Exp;
branches;
next	1.13;

1.13
date	2011.05.01.20.22.34;	author sthen;	state Exp;
branches;
next	1.12;

1.12
date	2010.12.27.14.50.23;	author ajacoutot;	state Exp;
branches;
next	1.11;

1.11
date	2010.12.24.10.40.05;	author ajacoutot;	state Exp;
branches;
next	1.10;

1.10
date	2010.11.19.22.31.33;	author espie;	state Exp;
branches;
next	1.9;

1.9
date	2010.11.09.11.56.17;	author jasper;	state Exp;
branches;
next	1.8;

1.8
date	2010.11.09.11.53.53;	author ajacoutot;	state Exp;
branches;
next	1.7;

1.7
date	2010.11.09.11.33.34;	author fgsch;	state Exp;
branches;
next	1.6;

1.6
date	2010.04.02.21.55.38;	author fgsch;	state Exp;
branches;
next	1.5;

1.5
date	2010.02.01.10.32.07;	author jasper;	state Exp;
branches;
next	1.4;

1.4
date	2009.10.19.21.01.16;	author fgsch;	state Exp;
branches;
next	1.3;

1.3
date	2009.10.04.12.56.23;	author fgsch;	state Exp;
branches;
next	1.2;

1.2
date	2009.06.23.14.02.03;	author simon;	state Exp;
branches
	1.2.2.1;
next	1.1;

1.1
date	2009.02.09.09.41.54;	author simon;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2009.02.09.09.41.54;	author simon;	state Exp;
branches;
next	;

1.2.2.1
date	2010.02.10.04.48.15;	author william;	state Exp;
branches;
next	;

1.16.2.1
date	2013.01.02.01.06.45;	author brad;	state Exp;
branches;
next	;

1.20.10.1
date	2015.12.17.09.56.35;	author jasper;	state Exp;
branches;
next	;
commitid	fmdxIn4MPxp0swh1;


desc
@@


1.28
log
@WANTLIB+=m for a bunch of things (chasing sqlite3 fts5 addition)
@
text
@# $OpenBSD: Makefile,v 1.27 2016/11/08 21:53:16 sthen Exp $

COMMENT =	advanced, stable and fast irc server

DISTNAME =	ircd-ratbox-3.0.10
CATEGORIES =	net
MASTER_SITES =	${HOMEPAGE}download/
EXTRACT_SUFX =	.tar.bz2
REVISION =	2

HOMEPAGE =	http://www.ratbox.org/

# GPLv2+
PERMIT_PACKAGE_CDROM =		Yes

WANTLIB =		c crypto ltdl m pthread sqlite3 ssl z

LIB_DEPENDS =		databases/sqlite3 \
			devel/libtool,-ltdl

CONFDIR =		${SYSCONFDIR}/ircd-ratbox
LOGDIR =		${LOCALSTATEDIR}/log/ircd-ratbox

SUBST_VARS +=		CONFDIR LOGDIR

LIBTOOL_FLAGS =		--tag=disable-static
CONFIGURE_STYLE =	gnu
CONFIGURE_ARGS =	--enable-openssl=/usr \
			--with-confdir=${CONFDIR} \
			--with-logdir=${LOGDIR} \
			--with-helpdir=${PREFIX}/share/ircd-ratbox/help \
			--with-moduledir=${PREFIX}/lib/ircd-ratbox/modules \
			--enable-services \
			--with-sqlite3=${LOCALBASE} \
			--with-zlib-path=/usr
CONFIGURE_ENV =		CPPFLAGS="-I${LOCALBASE}/include" \
			LDFLAGS="-L${LOCALBASE}/lib"

NO_TEST =		Yes

# Hack to make the nick length configurable at build time
NICKLEN ?=
.if ${NICKLEN}
FLAVORS =		nicklen_${NICKLEN}
FLAVOR =		nicklen_${NICKLEN}
CONFIGURE_ARGS +=	--with-nicklen=${NICKLEN}
.endif

DOCS =		README.cidr_bans challenge.txt modeg.txt \
		modes.txt monitor.txt server-version-info services.txt \
		tgchange.txt

pre-configure:
	@@${SUBST_CMD} ${WRKSRC}/doc/example.conf \
	    ${WRKSRC}/doc/example.efnet.conf

post-install:
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/ircd-ratbox
	${INSTALL_DATA} ${WRKINST}${CONFDIR}/* \
	    ${PREFIX}/share/examples/ircd-ratbox
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/ircd-ratbox
	cd ${WRKSRC}/doc && ${INSTALL_DATA} ${DOCS} \
	    ${PREFIX}/share/doc/ircd-ratbox
	@@find ${PREFIX}/lib -name '*.la' -print | xargs rm

.include <bsd.port.mk>
@


1.27
log
@WANTLIB += pthread
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2016/09/23 09:16:56 sthen Exp $
d9 1
a9 1
REVISION =	1
d16 1
a16 1
WANTLIB =		c crypto ltdl pthread sqlite3 ssl z
@


1.26
log
@Cope with moving sqlite3 back to ports.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2016/03/16 21:19:38 naddy Exp $
d9 1
a9 1
REVISION =	0
d16 1
a16 1
WANTLIB =		c crypto ltdl sqlite3 ssl z
@


1.25
log
@remove SHARED_ONLY from ports that use only the gnu module
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2016/03/07 07:12:44 ajacoutot Exp $
d9 1
d18 2
a19 1
LIB_DEPENDS =		devel/libtool,-ltdl
@


1.24
log
@Update to ircd-ratbox-3.0.10.

from Brad
@
text
@d1 1
a1 3
# $OpenBSD: Makefile,v 1.23 2015/12/20 07:52:43 ajacoutot Exp $

SHARED_ONLY =	Yes
@


1.23
log
@Use ${LOCALSTATEDIR}.

from Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2015/12/16 06:42:57 ajacoutot Exp $
d7 1
a7 1
DISTNAME =	ircd-ratbox-3.0.9
a10 1
REVISION =	0
@


1.22
log
@Udate to ircd-ratbox 3.0.9.
- Fixes a remote DoS issue, CVE 2015-5290.

from Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2015/11/05 19:08:58 jca Exp $
d11 1
d23 1
a23 1
LOGDIR =		/var/log/ircd-ratbox
@


1.21
log
@Drop MAINTAINER, the mail address bounces.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2013/10/31 01:25:07 brad Exp $
d7 1
a7 2
DISTNAME =	ircd-ratbox-3.0.8
REVISION =	1
d27 1
a27 2
CONFIGURE_STYLE =	autoconf
AUTOCONF_VERSION =	2.68
@


1.20
log
@Bring in a typo fix for the same code in ircd-ratbox as submitted
for ircd-hybrid by Adam Jeanguenat <avj at voyager dot 6v6 dot org>.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2013/03/21 08:46:34 ajacoutot Exp $
d8 1
a8 1
REVISION =	0
a13 2

MAINTAINER =	Simon Bertrang <simon@@openbsd.org>
@


1.20.10.1
log
@- update to ircd-ratbox 3.0.9
* various bugfixes including CVE-2015-5290
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2015/12/16 06:42:57 ajacoutot Exp $
d7 2
a8 1
DISTNAME =	ircd-ratbox-3.0.9
d15 2
d30 2
a31 1
CONFIGURE_STYLE =	gnu
@


1.19
log
@USE_LIBTOOL=Yes is the default now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2013/03/11 11:35:48 espie Exp $
d8 1
@


1.18
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2012/12/31 22:53:43 brad Exp $
a27 1
USE_LIBTOOL =		Yes
@


1.17
log
@Update to ircd-ratbox 3.0.8. Fixes a remote DoS issue.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2012/04/23 17:15:18 espie Exp $
a17 3
PERMIT_PACKAGE_FTP =		Yes
PERMIT_DISTFILES_CDROM =	Yes
PERMIT_DISTFILES_FTP =		Yes
d43 1
a43 1
NO_REGRESS =		Yes
@


1.16
log
@first pass at handling sqlite3 move
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2011/11/27 10:57:24 fgsch Exp $
d7 1
a7 1
DISTNAME =	ircd-ratbox-3.0.7
a10 1
REVISION =	0
@


1.16.2.1
log
@MFC:

Update to ircd-ratbox 3.0.8. Fixes a remote DoS issue.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2012/04/23 17:15:18 espie Exp $
d7 1
a7 1
DISTNAME =	ircd-ratbox-3.0.8
d11 1
@


1.15
log
@update to ircd-ratbox 3.0.7.
from brad. maintainer timed out
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2011/09/16 11:13:38 espie Exp $
d11 1
d25 1
a25 2
LIB_DEPENDS =		databases/sqlite3 \
			devel/libtool,-ltdl
@


1.14
log
@normalize pkgpath
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2011/05/01 20:22:34 sthen Exp $
d4 1
d7 1
a7 1
DISTNAME =	ircd-ratbox-3.0.6
d9 1
a9 2
REVISION =	5

d12 1
a12 2
HOMEPAGE =	http://www.ircd-ratbox.org/
MASTER_SITES =	${HOMEPAGE}download/testing/
d16 1
a16 1
# GPLv2
a26 3
USE_LIBTOOL =		Yes
NO_REGRESS =		Yes

d32 2
a33 5
CONFIGURE_ENV +=	CPPFLAGS="-I${LOCALBASE}/include" \
			LDFLAGS="-L${LOCALBASE}/lib"

AUTOCONF_VERSION =	2.65

d35 2
a36 3
CONFIGURE_ARGS =	--enable-ipv6 \
			--enable-openssl=/usr \
			--enable-kqueue \
a38 1
			--with-rundir=/var/run/ircd-ratbox \
d44 4
d62 1
a62 1
	${SUBST_CMD} ${WRKSRC}/doc/example.conf \
d72 1
@


1.13
log
@Use correct AUTOCONF_VERSION, from Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2010/12/27 14:50:23 ajacoutot Exp $
d8 1
a8 1
REVISION =	4
@


1.12
log
@Simplify after recent rc.subr change.
The framework is now stable and we will start documenting it (at last).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2010/12/24 10:40:05 ajacoutot Exp $
d39 1
a39 1
AUTOCONF_VERSION =	2.62
@


1.11
log
@Cope with recent rc.subr changes.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2010/11/19 22:31:33 espie Exp $
d8 1
a8 1
REVISION =	3
@


1.10
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2010/11/09 11:56:17 jasper Exp $
d8 1
a8 1
REVISION =	2
@


1.9
log
@- better filename for the script
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2010/11/09 11:53:53 ajacoutot Exp $
d25 2
a26 2
LIB_DEPENDS =		::databases/sqlite3 \
			:libltdl-*:devel/libtool,-ltdl
@


1.8
log
@Use tab for consistency with other rc scripts.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2010/11/09 11:33:34 fgsch Exp $
d8 1
a8 1
REVISION =	1
@


1.7
log
@Add rc script and move to new style LIB_DEPENDS.
jasper@@ ok.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2010/04/02 21:55:38 fgsch Exp $
d8 1
a8 1
REVISION =	0
@


1.6
log
@use underscore within the flavor's name as dash is not allowed.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2010/02/01 10:32:07 jasper Exp $
d8 2
d23 1
a23 1
WANTLIB =		c crypto ssl z
d25 2
a26 2
LIB_DEPENDS =		sqlite3::databases/sqlite3 \
			ltdl:libltdl-*:devel/libtool,-ltdl
@


1.5
log
@SECURITY UPDATE of ircd-ratbox to 3.0.6
- among the bugfixes is are fixes for CVE-2010-0300 and CVE-2009-4016.

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2009/10/19 21:01:16 fgsch Exp $
d55 2
a56 2
FLAVORS =		nicklen-${NICKLEN}
FLAVOR =		nicklen-${NICKLEN}
@


1.4
log
@Hack to allow to change the default nick length.
martynas@@ and simon@@ (maintainer) agreed.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2009/10/04 12:56:23 fgsch Exp $
d6 1
a6 2
DISTNAME =	ircd-ratbox-3.0.4
PKGNAME =	${DISTNAME}p1
@


1.3
log
@create /var/run/ircd-ratbox at starting time, not as a @@sample.  while
i'm here indent and improve comment.
maintainer timed out. martynas@@ ok.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2009/06/23 14:02:03 simon Exp $
d7 1
a7 1
PKGNAME =	${DISTNAME}p0
d52 8
@


1.2
log
@update to version 3.0.4 and set NO_REGRESS

prodded by same diff from Michiel van Baak, thanks!
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2009/02/09 09:41:54 simon Exp $
d4 1
a4 1
COMMENT =	advanced, stable and fast ircd
d7 1
d58 2
a59 1
	${SUBST_CMD} ${WRKSRC}/doc/example.conf ${WRKSRC}/doc/example.efnet.conf
@


1.2.2.1
log
@SECURITY FIX

Resolves CVE-2009-4016 and CVE-2010-0300

patches from upstream

ok simon@@ jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2009/06/23 14:02:03 simon Exp $
a6 1
PKGNAME =	${DISTNAME}p0
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d6 1
a6 1
DISTNAME =	ircd-ratbox-3.0.1
d27 1
@


1.1.1.1
log
@import ircd-ratbox

ircd-ratbox is an advanced, stable and fast ircd.
It is the primary ircd used on EFNet, combining the stability of an ircd
required for a large production network together with a rich set of
features, making it also suitable for use on smaller networks. 

Features include:
 * optional SSL support to enable encrypted connections between clients
   and servers, as well as server to server links
 * support for SSL only channels (channel mode +S)
 * uses sqlite3 for handling and storing k/x/d lines
 * support for global CIDR limits
 * provides adminwall command allowing admins to broadcast messages to
   each other
 * support to force nick changes

request, testing and feedback by Michiel van Baak
setusercontext() idea from form@@ via bernd@@
tested on armish and ok by sthen@@
@
text
@@
