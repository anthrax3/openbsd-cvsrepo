head	1.1;
access;
symbols
	OPENBSD_6_1:1.1.0.4
	OPENBSD_6_1_BASE:1.1
	OPENBSD_6_0:1.1.0.2
	OPENBSD_6_0_BASE:1.1;
locks; strict;
comment	@# @;


1.1
date	2016.06.06.10.15.53;	author dcoppa;	state Exp;
branches;
next	;
commitid	isQT5jrSapOX7XwZ;


desc
@@


1.1
log
@
proactively fix build with newer libminiupnpc
@
text
@$OpenBSD$

commit d0f0cd5ce38bac67ecc55e4cc5dd2e1883ebc2e4
Author: ygrek <ygrek@@autistici.org>
Date:   Sat Oct 17 16:00:17 2015 -0700

fix build with libminiupnpc 1.9 (closes #13)

--- src/utils/net/upnp_stubs.c.orig	Mon Jun  6 11:50:22 2016
+++ src/utils/net/upnp_stubs.c	Mon Jun  6 11:52:06 2016
@@@@ -640,7 +640,17 @@@@ upnpPulse( ml_upnpmp_t * map )
     {
         struct UPNPDev * devlist;
         errno = 0;
-        devlist = upnpDiscover( 2000, NULL, NULL, 0, 0, 0 );
+        devlist = upnpDiscover(
+          2000, /* delay */
+          NULL, /* multicastif */
+          NULL, /* minissdpsock */
+          0,    /* localport */
+          0,    /* ipv6 */
+#if MINIUPNPC_API_VERSION >= 14
+          2,    /* ttl */
+#endif
+          NULL  /* error */
+        );
         if( devlist == NULL )
         {
             dbg_printf( "upnpDiscover failed (errno %d - %s)\n", errno,  str_errno( errno ) );
@
