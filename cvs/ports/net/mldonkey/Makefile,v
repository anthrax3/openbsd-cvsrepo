head	1.22;
access;
symbols
	OPENBSD_6_1:1.18.0.2
	OPENBSD_6_1_BASE:1.18
	OPENBSD_6_0:1.17.0.2
	OPENBSD_6_0_BASE:1.17
	OPENBSD_5_9:1.15.0.2
	OPENBSD_5_9_BASE:1.15
	OPENBSD_5_8:1.14.0.6
	OPENBSD_5_8_BASE:1.14
	OPENBSD_5_7:1.14.0.2
	OPENBSD_5_7_BASE:1.14
	OPENBSD_5_6:1.11.0.18
	OPENBSD_5_6_BASE:1.11
	OPENBSD_5_5:1.11.0.16
	OPENBSD_5_5_BASE:1.11
	OPENBSD_5_4:1.11.0.14
	OPENBSD_5_4_BASE:1.11
	OPENBSD_5_3:1.11.0.12
	OPENBSD_5_3_BASE:1.11
	OPENBSD_5_2:1.11.0.10
	OPENBSD_5_2_BASE:1.11
	OPENBSD_5_1_BASE:1.11
	OPENBSD_5_1:1.11.0.8
	OPENBSD_5_0:1.11.0.6
	OPENBSD_5_0_BASE:1.11
	OPENBSD_4_9:1.11.0.4
	OPENBSD_4_9_BASE:1.11
	OPENBSD_4_8:1.11.0.2
	OPENBSD_4_8_BASE:1.11
	OPENBSD_4_7:1.10.0.2
	OPENBSD_4_7_BASE:1.10
	OPENBSD_4_6:1.9.0.12
	OPENBSD_4_6_BASE:1.9
	OPENBSD_4_5:1.9.0.10
	OPENBSD_4_5_BASE:1.9
	OPENBSD_4_4:1.9.0.8
	OPENBSD_4_4_BASE:1.9
	OPENBSD_4_3:1.9.0.6
	OPENBSD_4_3_BASE:1.9
	OPENBSD_4_2:1.9.0.4
	OPENBSD_4_2_BASE:1.9
	OPENBSD_4_1:1.9.0.2
	OPENBSD_4_1_BASE:1.9
	OPENBSD_4_0:1.8.0.12
	OPENBSD_4_0_BASE:1.8
	OPENBSD_3_9:1.8.0.10
	OPENBSD_3_9_BASE:1.8
	OPENBSD_3_8:1.8.0.8
	OPENBSD_3_8_BASE:1.8
	OPENBSD_3_7:1.8.0.6
	OPENBSD_3_7_BASE:1.8
	OPENBSD_3_6:1.8.0.4
	OPENBSD_3_6_BASE:1.8
	OPENBSD_3_5:1.8.0.2
	OPENBSD_3_5_BASE:1.8
	OPENBSD_3_4:1.3.0.2
	OPENBSD_3_4_BASE:1.3
	espie:1.1.1.1
	mldonkey:1.1.1;
locks; strict;
comment	@# @;


1.22
date	2017.07.26.22.45.28;	author sthen;	state Exp;
branches;
next	1.21;
commitid	tD4MFrpYYDDL2UFT;

1.21
date	2017.07.16.19.18.58;	author espie;	state Exp;
branches;
next	1.20;
commitid	tt0GhWK5c4uf9ILG;

1.20
date	2017.05.15.19.56.03;	author rsadowski;	state Exp;
branches;
next	1.19;
commitid	9o62ZeM7dBsDrb2c;

1.19
date	2017.04.10.11.46.32;	author sthen;	state Exp;
branches;
next	1.18;
commitid	HY6VNZxjJWzKQFDV;

1.18
date	2016.11.23.14.16.10;	author dcoppa;	state Exp;
branches;
next	1.17;
commitid	dzxBx0wpnpwMKWZi;

1.17
date	2016.06.06.10.15.53;	author dcoppa;	state Exp;
branches;
next	1.16;
commitid	isQT5jrSapOX7XwZ;

1.16
date	2016.03.01.09.05.33;	author dcoppa;	state Exp;
branches;
next	1.15;
commitid	lb3VPc3oucs5KdPI;

1.15
date	2015.12.23.14.46.06;	author dcoppa;	state Exp;
branches;
next	1.14;
commitid	FlNGK0gnSKcZtJsh;

1.14
date	2015.02.10.11.50.09;	author dcoppa;	state Exp;
branches;
next	1.13;
commitid	VW0Hf19vGjq12TuB;

1.13
date	2014.10.31.08.42.16;	author dcoppa;	state Exp;
branches;
next	1.12;
commitid	khepQdzVXEj766zx;

1.12
date	2014.10.31.08.19.39;	author dcoppa;	state Exp;
branches;
next	1.11;
commitid	UvUOBExHGCD0k5ZR;

1.11
date	2010.04.20.07.18.39;	author jasper;	state Exp;
branches;
next	1.10;

1.10
date	2010.02.01.17.00.14;	author espie;	state Exp;
branches;
next	1.9;

1.9
date	2006.09.18.10.30.20;	author espie;	state Exp;
branches;
next	1.8;

1.8
date	2004.03.07.19.14.02;	author espie;	state Exp;
branches;
next	1.7;

1.7
date	2004.02.13.17.39.54;	author espie;	state Exp;
branches;
next	1.6;

1.6
date	2003.12.31.17.26.35;	author sturm;	state Exp;
branches;
next	1.5;

1.5
date	2003.12.31.17.06.42;	author sturm;	state Exp;
branches;
next	1.4;

1.4
date	2003.12.09.11.07.06;	author espie;	state Exp;
branches;
next	1.3;

1.3
date	2003.06.29.07.57.18;	author sturm;	state Exp;
branches
	1.3.2.1;
next	1.2;

1.2
date	2003.06.17.16.36.05;	author lebel;	state Exp;
branches;
next	1.1;

1.1
date	2003.06.17.15.39.33;	author espie;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2003.06.17.15.39.33;	author espie;	state Exp;
branches;
next	;

1.3.2.1
date	2003.12.11.23.40.49;	author margarida;	state Exp;
branches;
next	;


desc
@@


1.22
log
@bump LIBCXX/LIBECXX/COMPILER_LIBCXX ports.
@
text
@# $OpenBSD: Makefile,v 1.21 2017/07/16 19:18:58 espie Exp $

COMMENT =	e-donkey client
DISTNAME =	mldonkey-3.1.5
REVISION =	6
CATEGORIES =	net

HOMEPAGE =	http://mldonkey.sourceforge.net/Main_Page
MASTER_SITES =	${MASTER_SITE_SOURCEFORGE:=mldonkey/}

MAINTAINER =	David Coppa <dcoppa@@openbsd.org>

# GPLv2
PERMIT_PACKAGE_CDROM =	Yes

WANTLIB += X11 Xcomposite Xcursor Xdamage Xext Xfixes Xi Xinerama
WANTLIB += Xrandr Xrender atk-1.0 bz2 c cairo charset fontconfig
WANTLIB += freetype gd gdk-x11-2.0 gdk_pixbuf-2.0 gio-2.0 glib-2.0
WANTLIB += gobject-2.0 gtk-x11-2.0 jpeg m magic miniupnpc natpmp
WANTLIB += pango-1.0 pangocairo-1.0 pangoft2-1.0 png pthread rsvg-2
WANTLIB += ${COMPILER_LIBCXX} tiff webp z

EXTRACT_SUFX =		.tar.bz2

CONFIGURE_STYLE =	gnu
CONFIGURE_ARGS +=	--enable-gui=newgui2 \
			--enable-upnp-natpmp
CONFIGURE_ENV +=	CPPFLAGS='-I${LOCALBASE}/include -I${X11BASE}/include' \
			LDFLAGS='-L${LOCALBASE}/lib -L${X11BASE}/lib' \
			ac_cv_prog_RPMBUILD="" \
			ac_cv_prog_WGET=""

MODGNU_CONFIG_GUESS_DIRS =	${WRKSRC}/config
WRKCONF =			${WRKSRC}/config

USE_GMAKE =	Yes
MODULES =	lang/ocaml devel/gettext
BUILD_DEPENDS =	lang/ocaml-camlp4 x11/lablgtk2
LIB_DEPENDS =	archivers/bzip2 \
		devel/libmagic \
		graphics/gd \
		net/miniupnp/libnatpmp \
		net/miniupnp/miniupnpc>=1.9 \
		x11/gnome/librsvg \
		x11/gtk+2

.include <bsd.port.arch.mk>
.if ${PROPERTIES:Mocaml_native}
FAKE_FLAGS =	OCAML_NATIVE=yes
.else
FAKE_FLAGS =	OCAML_NATIVE=no
.endif

NO_TEST =	Yes

.include <bsd.port.arch.mk>
pre-patch:
	@@cd ${WRKSRC}; perl -i -pe 's/\r$$//' `find . -type f`

post-install:
	${INSTALL_DATA_DIR} ${PREFIX}/share/mldonkey
	cp -R ${WRKDIST}/distrib ${PREFIX}/share/mldonkey/
.if ${PROPERTIES:Mocaml_native}
	@@cd ${PREFIX}/bin && strip mlnet mlgui mlnet+gui
.endif

.include <bsd.port.mk>
@


1.21
log
@use COMPILER_LIBCXX where applicable
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2017/05/15 19:56:03 rsadowski Exp $
d5 1
a5 1
REVISION =	5
@


1.20
log
@Bump REVISION and adjust WANTLIB after gd update

ok sthen@@, "looks okay" @@landry
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2017/04/10 11:46:32 sthen Exp $
d21 1
a21 1
WANTLIB += ${LIBCXX} tiff webp z
@


1.19
log
@use LIBCXX
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2016/11/23 14:16:10 dcoppa Exp $
d5 1
a5 1
REVISION =	4
d21 1
a21 1
WANTLIB += ${LIBCXX} tiff vpx z
@


1.18
log
@
Other fixes for Ocaml-4.03
(upstream git commit f8d595df4fe01512fd945bb6d524958d1361a0a8)

...And regen patches while here
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2016/06/06 10:15:53 dcoppa Exp $
d21 1
a21 1
WANTLIB += stdc++ tiff vpx z
@


1.17
log
@
proactively fix build with newer libminiupnpc
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2016/03/01 09:05:33 dcoppa Exp $
d5 1
a5 1
REVISION =	3
@


1.16
log
@
Switch to CONFIGURE_STYLE=gnu

OK naddy@@ for after the unlock
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2015/12/23 14:46:06 dcoppa Exp $
d5 1
a5 1
REVISION =	2
@


1.15
log
@
Fix problems found by gcc5
(upstream git commit cca5f2d631c790ffc79e7533653315c8acb85875)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2015/02/10 11:50:09 dcoppa Exp $
d25 1
a25 5
CONFIGURE_STYLE =	autoconf no-autoheader
AUTOCONF_DIR =		${WRKSRC}/config
AUTOCONF_VERSION =	2.69
MODGNU_CONFIG_GUESS_DIRS=${WRKSRC}/config

d32 3
@


1.14
log
@
Merge fixes from upstream:

update default blocklist url
(upstream git commit fbc2cfe4ed7046bf88ed123b504bbbee2376bf79)

BT/DHT: update public router addresses
(upstream git commit ea463573d490d1c44c57ec87b63d3d5d08489e96)

fix buffer overflows in DNS resolution
(upstream git commit 1e7341ef879a0f42e304bdd24f3339245214b58a)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2014/10/31 08:42:16 dcoppa Exp $
d5 1
a5 1
REVISION =	1
d58 3
@


1.13
log
@
Add @@pkgpath marker and bump

Reminded by ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2014/10/31 08:19:39 dcoppa Exp $
d5 1
a5 1
REVISION =	0
@


1.12
log
@
Move net/mldonkey/stable to net/mldonkey
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.60 2014/09/02 09:24:44 chrisz Exp $
d5 1
@


1.11
log
@- remove mldonkey/snapshot, it's outdated by stable/, it's BROKEN and
still depends on gtk+1.

agreed by espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2010/02/01 17:00:14 espie Exp $
d3 3
a5 2
SUBDIR =
SUBDIR += stable
d7 58
a64 1
.include <bsd.port.subdir.mk>
@


1.10
log
@SUBDIR += is wrong: it means the makefile will pick up SUBDIR from env, thus
breaking cd /usr/ports && SUBDIR=some/path make something for
category makefiles. While there, also put spaces around += uniformously.
okay naddy@@, jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2006/09/18 10:30:20 espie Exp $
a4 1
#SUBDIR += snapshot
@


1.9
log
@unlink the snapshot dir, it's unlikely to come back for now...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2004/03/07 19:14:02 espie Exp $
d3 3
a5 2
SUBDIR+= stable
#SUBDIR+= snapshot
@


1.8
log
@replace single version with stable/snapshot
okay pval
@
text
@d1 1
a1 1
# $OpenBSD$
d4 1
a4 1
SUBDIR+= snapshot
@


1.7
log
@update to 2.5.11.
Also activates better new, faster sha1.
The detection code is bogus and linux-specific.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2003/12/31 17:26:35 sturm Exp $
d3 2
a4 2
COMMENT='e-donkey client'
CATEGORIES=net
d6 1
a6 28
MAINTAINER=Marc Espie <espie@@openbsd.org>

# GPL
PERMIT_PACKAGE_FTP=	Yes
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
CONFIGURE_STYLE=	gnu
CONFIGURE_ARGS+=	--enable-ocamlver=3.07

HOMEPAGE=http://savannah.nongnu.org/projects/mldonkey/

MASTER_SITES=http://savannah.nongnu.org/download/mldonkey/
DISTNAME=mldonkey-2.5.11
WRKDIST=${WRKDIR}/mldonkey-2.5.11

USE_GMAKE=Yes
MODULES=ocaml
BUILD_DEPENDS=::x11/lablgtk
LIB_DEPENDS=gdk.1,gtk.1::x11/gtk+
FAKE_FLAGS=prefix=${DESTDIR}${PREFIX} MODOCAML_NATIVE=${MODOCAML_NATIVE}
NO_REGRESS=Yes

post-install:
	mkdir -p ${PREFIX}/share/mldonkey
	cp -R ${WRKDIST}/distrib ${PREFIX}/share/mldonkey

.include <bsd.port.mk>
@


1.6
log
@bump PKGNAME
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2003/12/31 17:06:42 sturm Exp $
d18 3
a20 5
MASTER_SITES=http://savannah.nongnu.org/download/mldonkey/release-2.5-4/official/
DISTNAME=mldonkey-2.5.4
PKGNAME=${DISTNAME}p0
DISTFILES=mldonkey-2.5-4.tar.gz
WRKDIST=${WRKDIR}/mldonkey-2.5-4
@


1.5
log
@compile with ocaml 3.07
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2003/12/09 11:07:06 espie Exp $
d20 1
@


1.4
log
@Update to 2.5.4, so that servers are happy again.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2003/06/29 07:57:18 sturm Exp $
d14 1
d28 1
@


1.3
log
@- fix installation on archs without native code compiler
- don't install mlnet as mlgui/mlim, but use mlgui/mlim
- bump PKGNAME

"it's good with me" pval@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2003/06/17 16:36:05 lebel Exp $
d17 4
a20 5
MASTER_SITES=http://savannah.nongnu.org/download/mldonkey/release-2.5-3/official/
DISTNAME=mldonkey-2.5.3
PKGNAME=${DISTNAME}p0
DISTFILES=mldonkey-2.5-3.sources.tar.gz
WRKDIST=${WRKDIR}/mldonkey-2.5-3
d25 1
@


1.3.2.1
log
@MFC:
Update to 2.5.4, so that servers are happy again.
--
Requested by espie@@, ok pvalchev@@ brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2003/12/09 11:07:06 espie Exp $
d17 5
a21 5
MASTER_SITES=http://savannah.nongnu.org/download/mldonkey/release-2.5-4/official/

DISTNAME=mldonkey-2.5.4
DISTFILES=mldonkey-2.5-4.tar.gz
WRKDIST=${WRKDIR}/mldonkey-2.5-4
a25 1
LIB_DEPENDS=gdk.1,gtk.1::x11/gtk+
@


1.2
log
@add OpenBSD tag
@
text
@d1 1
a1 1
# $OpenBSD$
d19 1
d26 1
a26 1
FAKE_FLAGS=prefix=${DESTDIR}${PREFIX}
@


1.1
log
@Initial revision
@
text
@d1 2
@


1.1.1.1
log
@only got positive feedback, and a lot of it...
so let's get this show on the road.
@
text
@@
