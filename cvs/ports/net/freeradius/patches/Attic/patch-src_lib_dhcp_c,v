head	1.1;
access;
symbols
	OPENBSD_4_8:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2010.10.26.03.36.42;	author william;	state dead;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2010.10.26.03.36.42;	author william;	state Exp;
branches;
next	;


desc
@@


1.1
log
@file patch-src_lib_dhcp_c was initially added on branch OPENBSD_4_8.
@
text
@@


1.1.2.1
log
@SECURITY FIX

CVE-2010-3696
http://github.com/alandekok/freeradius-server/commit/4dc7800b866f889a1247685bbaa6dd4238a56279

CVE-2010-3697
http://github.com/alandekok/freeradius-server/commit/ff94dd35673bba1476594299d31ce8293b8bd223

from pea@@, thanks!

ok ajacoutot
@
text
@a0 15
$OpenBSD$

CVE-2010-3696

--- src/lib/dhcp.c.orig	Mon Oct 11 09:45:32 2010
+++ src/lib/dhcp.c	Mon Oct 11 09:46:15 2010
@@@@ -714,7 +714,7 @@@@ int fr_dhcp_decode(RADIUS_PACKET *packet)
 			}
 
 			*tail = vp;
-			while (*tail) tail = &vp->next;
+			while (*tail) tail = &(*tail)->next;
 			p += alen;
 		} /* loop over array entries */
 	} /* loop over the entire packet */
@

