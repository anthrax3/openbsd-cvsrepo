head	1.2;
access;
symbols
	OPENBSD_5_0:1.1.0.2
	OPENBSD_5_0_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2011.09.27.09.45.53;	author sthen;	state dead;
branches;
next	1.1;

1.1
date	2011.03.26.12.00.53;	author sthen;	state Exp;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2011.09.27.09.47.24;	author sthen;	state dead;
branches;
next	;


desc
@@


1.2
log
@SECURITY update to quagga 0.99.19

CVE-2011-3323: ospf6d *stack-based buffer overflow*, inter-area-prefix LSAs
CVE-2011-3324: ospf6d assertion failure; DD LSAs with over-length header
CVE-2011-3325: ospf crash(?) if a hello has a truncated header or invalid type
CVE-2011-3326: ospf null deref if a link state update LSA has an unknown type
CVE-2011-3327: bgp buffer overflow with malformed UPDATE (extended communities)
@
text
@$OpenBSD: patch-ospfd_ospf_opaque_c,v 1.1 2011/03/26 12:00:53 sthen Exp $

ospfd: Compile fix for opaque support
http://code.quagga.net/cgi-bin/gitweb.cgi?p=quagga.git;a=commitdiff;h=d71ea65270408a45e4bec036671ec73b24b994b4

--- ospfd/ospf_opaque.c.orig	Mon Mar 21 09:43:52 2011
+++ ospfd/ospf_opaque.c	Sat Mar 26 11:18:46 2011
@@@@ -251,7 +251,7 @@@@ struct ospf_opaque_functab
   void (* config_write_debug )(struct vty *vty);
   void (* show_opaque_info   )(struct vty *vty, struct ospf_lsa *lsa);
   int  (* lsa_originator)(void *arg);
-  void (* lsa_refresher )(struct ospf_lsa *lsa);
+  struct ospf_lsa *(* lsa_refresher )(struct ospf_lsa *lsa);
   int (* new_lsa_hook)(struct ospf_lsa *lsa);
   int (* del_lsa_hook)(struct ospf_lsa *lsa);
 };
@@@@ -354,7 +354,7 @@@@ ospf_register_opaque_functab (
   void (* config_write_debug )(struct vty *vty),
   void (* show_opaque_info   )(struct vty *vty, struct ospf_lsa *lsa),
   int  (* lsa_originator)(void *arg),
-  void (* lsa_refresher )(struct ospf_lsa *lsa),
+  struct ospf_lsa *(* lsa_refresher )(struct ospf_lsa *lsa),
   int (* new_lsa_hook)(struct ospf_lsa *lsa),
   int (* del_lsa_hook)(struct ospf_lsa *lsa))
 {
@@@@ -1608,12 +1608,13 @@@@ out:
   return new;
 }
 
-void
+struct ospf_lsa *
 ospf_opaque_lsa_refresh (struct ospf_lsa *lsa)
 {
   struct ospf *ospf;
   struct ospf_opaque_functab *functab;
-
+  struct ospf_lsa *new = NULL;
+  
   ospf = ospf_lookup ();
 
   if ((functab = ospf_opaque_functab_lookup (lsa)) == NULL
@@@@ -1633,9 +1634,9 @@@@ ospf_opaque_lsa_refresh (struct ospf_lsa *lsa)
       ospf_lsa_flush (ospf, lsa);
     }
   else
-    (* functab->lsa_refresher)(lsa);
+    new = (* functab->lsa_refresher)(lsa);
 
-  return;
+  return new;
 }
 
 /*------------------------------------------------------------------------*
@


1.1
log
@- SECURITY update to 0.99.18 (pointed out by Brad)
CVE-2010-1674 null pointer deref with malformed BGP Extended Communities
CVE-2010-1675 BGP session reset with malformed AS-path

- install info documentation

- patches added: build fixes from upstream
@
text
@d1 1
a1 1
$OpenBSD$
@


1.1.2.1
log
@MFC: SECURITY update to quagga 0.99.19

CVE-2011-3323: ospf6d *stack-based buffer overflow*, inter-area-prefix LSAs
CVE-2011-3324: ospf6d assertion failure; DD LSAs with over-length header
CVE-2011-3325: ospf crash(?) if a hello has a truncated header or invalid type
CVE-2011-3326: ospf null deref if a link state update LSA has an unknown type
CVE-2011-3327: bgp buffer overflow with malformed UPDATE (extended communities)
@
text
@d1 1
a1 1
$OpenBSD: patch-ospfd_ospf_opaque_c,v 1.1 2011/03/26 12:00:53 sthen Exp $
@


