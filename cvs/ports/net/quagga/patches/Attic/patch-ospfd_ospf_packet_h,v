head	1.2;
access;
symbols;
locks; strict;
comment	@# @;


1.2
date	2012.03.31.10.51.47;	author sthen;	state dead;
branches;
next	1.1;

1.1
date	2012.03.20.20.56.26;	author sthen;	state Exp;
branches;
next	;


desc
@@


1.2
log
@update to quagga 0.99.20.1 rolling in the security fixes which we had as
separate patches.

multicast support changed in 0.99.20 and not fully tested, no response to
my ports@@ call for testing, so if this breaks things send me a mail with
details.
@
text
@$OpenBSD: patch-ospfd_ospf_packet_h,v 1.1 2012/03/20 20:56:26 sthen Exp $

from 0.99.20.1 upstream

--- ospfd/ospf_packet.h.orig	Mon Sep 26 15:45:54 2011
+++ ospfd/ospf_packet.h	Tue Mar 20 20:05:06 2012
@@@@ -46,6 +46,10 @@@@
 
 #define OSPF_HELLO_REPLY_DELAY          1
 
+/* Return values of functions involved in packet verification, see ospf6d. */
+#define MSG_OK    0
+#define MSG_NG    1
+
 struct ospf_packet
 {
   struct ospf_packet *next;
@@@@ -117,6 +121,10 @@@@ struct ospf_db_desc
   u_int32_t dd_seqnum;
 };
 
+struct ospf_ls_update
+{
+  u_int32_t num_lsas;
+};
 
 /* Macros. */
 /* XXX Perhaps obsolete; function in ospf_packet.c */
@@@@ -162,5 +170,8 @@@@ extern int ospf_ls_upd_timer (struct thread *);
 extern int ospf_ls_ack_timer (struct thread *);
 extern int ospf_poll_timer (struct thread *);
 extern int ospf_hello_reply_timer (struct thread *);
+
+extern const struct message ospf_packet_type_str[];
+extern const size_t ospf_packet_type_str_max;
 
 #endif /* _ZEBRA_OSPF_PACKET_H */
@


1.1
log
@add SECURITY patches from quagga 0.99.20.1

CVE-2012-0249 - Quagga ospfd DoS on malformed LS-Update packet
CVE-2012-0250 - Quagga ospfd DoS on malformed Network-LSA data
CVE-2012-0255 - Quagga bgpd DoS on malformed OPEN message
@
text
@d1 1
a1 1
$OpenBSD$
@

