head	1.2;
access;
symbols
	OPENBSD_6_1:1.2.0.4
	OPENBSD_6_1_BASE:1.2
	OPENBSD_6_0:1.2.0.2
	OPENBSD_6_0_BASE:1.2
	OPENBSD_5_9:1.1.0.12
	OPENBSD_5_9_BASE:1.1
	OPENBSD_5_8:1.1.0.14
	OPENBSD_5_8_BASE:1.1
	OPENBSD_5_7:1.1.0.10
	OPENBSD_5_7_BASE:1.1
	OPENBSD_5_6:1.1.0.8
	OPENBSD_5_6_BASE:1.1
	OPENBSD_5_5:1.1.0.6
	OPENBSD_5_5_BASE:1.1
	OPENBSD_5_4:1.1.0.4
	OPENBSD_5_4_BASE:1.1
	OPENBSD_5_3:1.1.0.2
	OPENBSD_5_3_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2016.03.22.12.57.54;	author jca;	state Exp;
branches;
next	1.1;
commitid	UMHjWDfFsEz4krLO;

1.1
date	2013.01.04.00.24.10;	author sthen;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Update to 1.0.20160315, ok sthen@@ (maintainer)

Announce:

  https://lists.quagga.net/pipermail/quagga-users/2016-March/014293.html

ChangeLog:

  http://savannah.spinellicreations.com/quagga/quagga-1.0.20160315.changelog.txt
  http://savannah.spinellicreations.com/quagga/quagga-1.0.20160309.changelog.txt

Note that this update brings a fix for CVE-2016-2342.  This vulnerability
affects quagga MPLS VPN setups which probably aren't possible on OpenBSD.
@
text
@$OpenBSD: patch-lib_sockopt_h,v 1.1 2013/01/04 00:24:10 sthen Exp $

Revert 69bf3a39; does not work on at least (Open/Net)BSD.
This can be put back if we get RFC3678 support.

--- lib/sockopt.h.orig	Wed Mar 16 00:17:17 2016
+++ lib/sockopt.h	Mon Mar 21 02:12:14 2016
@@@@ -85,8 +85,12 @@@@ extern int setsockopt_ipv6_tclass (int, int);
 
 extern int setsockopt_ipv4_multicast_if(int sock, ifindex_t ifindex);
 extern int setsockopt_ipv4_multicast(int sock, int optname,
+                                     struct in_addr if_addr
+					 /* required: interface to join on */,
                                      unsigned int mcast_addr,
-			             ifindex_t ifindex);
+			             ifindex_t ifindex
+					 /* optional: if non-zero, may be used
+					 	instead of if_addr */);
 extern int setsockopt_ipv4_tos(int sock, int tos);
 
 /* Ask for, and get, ifindex, by whatever method is supported. */
@


1.1
log
@revert multicast changes in last upstream release, they do not work on OS
which require the interface IP address for IP_{ADD,DROP}_MEMBERSHIP

reported by Raphael Mazelier
@
text
@d1 1
a1 1
$OpenBSD$
d6 3
a8 5
--- lib/sockopt.h.orig	Tue Apr 17 14:56:26 2012
+++ lib/sockopt.h	Thu Jan  3 00:24:26 2013
@@@@ -83,11 +83,13 @@@@ extern int setsockopt_ipv6_tclass (int, int);
   (((af) == AF_INET) : SOPT_SIZE_CMSG_IFINDEX_IPV4() \
                     ? SOPT_SIZE_CMSG_PKTINFO_IPV6())
d10 3
a12 5
-extern int setsockopt_ipv4_multicast_if(int sock,
-			             unsigned int ifindex);
-extern int setsockopt_ipv4_multicast(int sock, int optname,
+extern int setsockopt_multicast_ipv4(int sock, int optname, 
+			             struct in_addr if_addr
d15 2
a16 2
-			             unsigned int ifindex);
+			             unsigned int ifindex
@

