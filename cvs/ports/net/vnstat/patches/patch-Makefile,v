head	1.5;
access;
symbols
	OPENBSD_6_1:1.5.0.8
	OPENBSD_6_1_BASE:1.5
	OPENBSD_6_0:1.5.0.6
	OPENBSD_6_0_BASE:1.5
	OPENBSD_5_9:1.5.0.2
	OPENBSD_5_9_BASE:1.5
	OPENBSD_5_8:1.5.0.4
	OPENBSD_5_8_BASE:1.5
	OPENBSD_5_7:1.4.0.2
	OPENBSD_5_7_BASE:1.4
	OPENBSD_5_6:1.2.0.10
	OPENBSD_5_6_BASE:1.2
	OPENBSD_5_5:1.2.0.8
	OPENBSD_5_5_BASE:1.2
	OPENBSD_5_4:1.2.0.6
	OPENBSD_5_4_BASE:1.2
	OPENBSD_5_3:1.2.0.4
	OPENBSD_5_3_BASE:1.2
	OPENBSD_5_2:1.2.0.2
	OPENBSD_5_2_BASE:1.2
	OPENBSD_5_1_BASE:1.1.1.1
	OPENBSD_5_1:1.1.1.1.0.6
	OPENBSD_5_0:1.1.1.1.0.4
	OPENBSD_5_0_BASE:1.1.1.1
	OPENBSD_4_9:1.1.1.1.0.2
	OPENBSD_4_9_BASE:1.1.1.1
	pea_20101025:1.1.1.1
	pea:1.1.1;
locks; strict;
comment	@# @;


1.5
date	2015.06.01.16.23.09;	author pea;	state Exp;
branches;
next	1.4;
commitid	JT2bucB9l0fnRcoh;

1.4
date	2015.01.06.13.19.35;	author jasper;	state Exp;
branches;
next	1.3;
commitid	66xYekJXOPJ4Lb3P;

1.3
date	2015.01.05.09.46.42;	author jasper;	state Exp;
branches;
next	1.2;
commitid	zhIc1sSLDbrbu7An;

1.2
date	2012.03.09.09.33.03;	author pea;	state Exp;
branches;
next	1.1;

1.1
date	2010.10.25.10.14.53;	author pea;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2010.10.25.10.14.53;	author pea;	state Exp;
branches;
next	;


desc
@@


1.5
log
@Update to 1.14

ok ajacoutot@@
@
text
@$OpenBSD: patch-Makefile,v 1.4 2015/01/06 13:19:35 jasper Exp $

- From 6a34745f0e84a990a8fa48e1f1f25be0f08c92a9 Mon Sep 17 00:00:00 2001
  From: Jasper Lievisse Adriaanse <jasper@@humppa.nl>
  Date: Sat, 3 Jan 2015 14:30:52 +0100
  Subject: [PATCH] Allow for overriding BIN, SBIN and MAN

- From e4b9c2747bb044f48b35ea02294e73d7c366d9d9 Mon Sep 17 00:00:00 2001
  From: Jasper Lievisse Adriaanse <jasper@@humppa.nl>
  Date: Sat, 3 Jan 2015 14:34:50 +0100
  Subject: [PATCH] make the path to vnstat.conf variable

- From ee354ae5e61f332d22b9242f5a2d5af07e4a5373 Mon Sep 17 00:00:00 2001
  From: Jasper Lievisse Adriaanse <jasper@@humppa.nl>
  Date: Sun, 4 Jan 2015 22:04:20 +0100
  Subject: [PATCH] Adjust manpages for /var/db/ too, just like vnstat.conf

--- Makefile.orig	Mon Jan  5 23:19:37 2015
+++ Makefile	Mon Jun  1 16:37:25 2015
@@@@ -5,11 +5,12 @@@@ MAN ?= $(DESTDIR)/usr/share/man
 ETC ?= $(DESTDIR)/etc/
 
 # bin and man dirs for *BSD
-BIN_BSD ?= $(DESTDIR)/usr/local/bin
-SBIN_BSD ?= $(DESTDIR)/usr/local/sbin
-MAN_BSD ?= $(DESTDIR)/usr/local/man
-ETC_BSD ?= $(DESTDIR)/etc
+BIN_BSD ?= ${PREFIX}/bin
+SBIN_BSD ?= ${PREFIX}/sbin
+MAN_BSD ?= ${PREFIX}/man
+ETC_BSD ?= ${PREFIX}/share/examples/vnstat
 
+
 .PHONY: vnstat tests check all clean debug install uninstall bsdinstall bsduninstall dist
 
 default: vnstat
@@@@ -140,7 +141,6 @@@@ bsdinstall:
 	fi
 
 # install binaries
-	install -d -m 755 $(DESTDIR)/var/db/vnstat
 	install -s -m 755 src/vnstat $(BIN_BSD)
 	install -s -m 755 src/vnstatd $(SBIN_BSD)
 
@@@@ -166,14 +166,9 @@@@ bsdinstall:
 	install -m 644 man/vnstat.1 $(MAN_BSD)/man1
 	install -m 644 man/vnstatd.1 $(MAN_BSD)/man1
 	install -m 644 man/vnstat.conf.5 $(MAN_BSD)/man5
-	gzip -f9 $(MAN_BSD)/man1/vnstat.1
-	gzip -f9 $(MAN_BSD)/man1/vnstatd.1
-	gzip -f9 $(MAN_BSD)/man5/vnstat.conf.5
 	@@if [ -f "src/vnstati" ]; \
 	then echo install -m 644 man/vnstati.1 $(MAN_BSD)/man1; \
 	install -m 644 man/vnstati.1 $(MAN_BSD)/man1; \
-	echo gzip -f9 $(MAN_BSD)/man1/vnstati.1; \
-	gzip -f9 $(MAN_BSD)/man1/vnstati.1; \
 	fi
 
 # remove vnstat.conf.1 is such exists in the wrong place
@


1.4
log
@merge some fixes that I actually intended to commit
- tweak to Makefile to get rid of post-configure

ok pea@@
@
text
@d1 1
a1 1
$OpenBSD: patch-Makefile,v 1.2 2012/03/09 09:33:03 pea Exp $
d18 4
a21 4
--- Makefile.orig	Sun Aug 31 12:41:32 2014
+++ Makefile	Sun Jan  4 22:03:02 2015
@@@@ -4,9 +4,10 @@@@ SBIN = $(DESTDIR)/usr/sbin
 MAN = $(DESTDIR)/usr/share/man
d24 4
a27 3
-BIN_BSD = $(DESTDIR)/usr/local/bin
-SBIN_BSD = $(DESTDIR)/usr/local/sbin
-MAN_BSD = $(DESTDIR)/usr/local/man
d33 1
d36 2
a37 1
@@@@ -138,7 +139,6 @@@@ bsdinstall:
d45 1
a45 25
@@@@ -148,26 +148,26 @@@@ bsdinstall:
 	fi
 
 # install default config if such doesn't exist
-	@@if [ ! -f "$(DESTDIR)/etc/vnstat.conf" ]; \
-	then echo "Installing config to $(DESTDIR)/etc/vnstat.conf"; \
-	install -d -m 755 $(DESTDIR)/etc; \
-	install -m 644 cfg/vnstat.conf $(DESTDIR)/etc/vnstat.conf; \
-	sed -e 's/lib/db/g' $(DESTDIR)/etc/vnstat.conf >$(DESTDIR)/etc/vnstat.conf.bsd; \
-	mv -f $(DESTDIR)/etc/vnstat.conf.bsd $(DESTDIR)/etc/vnstat.conf; \
+	@@if [ ! -f "$(ETC_BSD)/vnstat.conf" ]; \
+	then echo "Installing config to $(ETC_BSD)/vnstat.conf"; \
+	install -d -m 755 $(ETC_BSD); \
+	install -m 644 cfg/vnstat.conf $(ETC_BSD)/vnstat.conf; \
+	sed -e 's/lib/db/g' $(ETC_BSD)/vnstat.conf >$(ETC_BSD)/vnstat.conf.bsd; \
+	mv -f $(ETC_BSD)/vnstat.conf.bsd $(ETC_BSD)/vnstat.conf; \
 	fi
 
-# update man page	
+# update man page
+	for m in vnstat.1 vnstati.1 vnstatd.1 vnstat.conf.5; do \
+	sed -e 's/lib/db/g' man/$$m > man/$$m.tmp; \
+	mv -f man/$$m.tmp man/$$m; \
+	done
+
@


1.3
log
@- update to vnstat-1.12
- rework Makefile patch and don't patch /var/lib to /var/db as the
  bsdinstall target already takes care of that

ok aja@@ (on an earlier diff), pea@@ (MAINTAINER)
@
text
@d2 16
d19 1
a19 1
+++ Makefile	Sat Jan  3 14:42:29 2015
d42 1
a42 1
@@@@ -148,12 +148,12 @@@@ bsdinstall:
d60 21
a80 1
 # update man page	
@


1.2
log
@Update to 1.11
Initial diff from Gonzalo L. R. (gonzalo at x61.com.ar)

ok sthen@@
@
text
@d1 4
a4 4
$OpenBSD: patch-Makefile,v 1.1.1.1 2010/10/25 10:14:53 pea Exp $
--- Makefile.orig	Sun May 29 22:41:34 2011
+++ Makefile	Thu Mar  8 18:17:10 2012
@@@@ -4,20 +4,20 @@@@ SBIN = $(DESTDIR)/usr/sbin
d14 1
d16 1
a16 1
 default: vnstat
d18 1
a18 15
 vnstat:
-	+make -C src
+	+$(MAKE) -C src
 
 all:
-	+make -C src all
+	+$(MAKE) -C src all
 
 clean:
-	make -C src clean
+	$(MAKE) -C src clean
 
 install:
 	@@echo "Installing vnStat..."
@@@@ -126,7 +126,6 @@@@ bsdinstall:
d26 2
a27 1
@@@@ -137,25 +136,18 @@@@ bsdinstall:
d30 1
a30 1
 	@@if [ ! -f $(DESTDIR)/etc/vnstat.conf ]; \
d36 6
a41 3
+	then echo "Installing config to ${PREFIX}/share/exemples/vnstat/vnstat.conf"; \
+	install -d ${PREFIX}/share/examples/vnstat/; \
+	install -m 644 cfg/vnstat.conf ${PREFIX}/share/examples/vnstat/vnstat.conf; \
a44 14
 	install -m 644 man/vnstat.1 $(MAN_BSD)/man1
 	install -m 644 man/vnstatd.1 $(MAN_BSD)/man1
 	install -m 644 man/vnstat.conf.5 $(MAN_BSD)/man5
-	gzip -f9 $(MAN_BSD)/man1/vnstat.1
-	gzip -f9 $(MAN_BSD)/man1/vnstatd.1
-	gzip -f9 $(MAN_BSD)/man5/vnstat.conf.5
 	@@if [ -f "src/vnstati" ]; \
 	then echo install -m 644 man/vnstati.1 $(MAN_BSD)/man1; \
 	install -m 644 man/vnstati.1 $(MAN_BSD)/man1; \
-	echo gzip -f9 $(MAN_BSD)/man1/vnstati.1; \
-	gzip -f9 $(MAN_BSD)/man1/vnstati.1; \
 	fi
 
 # remove vnstat.conf.1 is such exists in the wrong place
@


1.1
log
@Initial revision
@
text
@d1 3
a3 3
$OpenBSD$
--- Makefile.orig	Sat Aug  1 21:23:43 2009
+++ Makefile	Fri Sep 24 16:45:07 2010
d35 1
a35 1
-	install -dm 755 $(DESTDIR)/var/db/vnstat
d39 1
a39 1
@@@@ -137,24 +136,18 @@@@ bsdinstall:
d44 2
a45 1
-	install -D -m 644 cfg/vnstat.conf $(DESTDIR)/etc/vnstat.conf; \
@


1.1.1.1
log
@Import of vnstat:
vnStat is a console-based network traffic monitor for Linux and BSD that
keeps a log of network traffic for the selected interface(s). It uses the
network interface statistics provided by the kernel as information source.
This means that vnStat won't actually be sniffing any traffic and also
ensures light use of system resources.

With tweaks and advices from jasper@@. Thanks

ok jasper@@
@
text
@@
