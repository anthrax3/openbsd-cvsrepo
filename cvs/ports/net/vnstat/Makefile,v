head	1.27;
access;
symbols
	OPENBSD_6_2:1.27.0.8
	OPENBSD_6_2_BASE:1.27
	OPENBSD_6_1:1.27.0.6
	OPENBSD_6_1_BASE:1.27
	OPENBSD_6_0:1.27.0.4
	OPENBSD_6_0_BASE:1.27
	OPENBSD_5_9:1.27.0.2
	OPENBSD_5_9_BASE:1.27
	OPENBSD_5_8:1.25.0.4
	OPENBSD_5_8_BASE:1.25
	OPENBSD_5_7:1.20.0.2
	OPENBSD_5_7_BASE:1.20
	OPENBSD_5_6:1.18.0.2
	OPENBSD_5_6_BASE:1.18
	OPENBSD_5_5:1.17.0.2
	OPENBSD_5_5_BASE:1.17
	OPENBSD_5_4:1.15.0.2
	OPENBSD_5_4_BASE:1.15
	OPENBSD_5_3:1.13.0.2
	OPENBSD_5_3_BASE:1.13
	OPENBSD_5_2:1.12.0.2
	OPENBSD_5_2_BASE:1.12
	OPENBSD_5_1_BASE:1.9
	OPENBSD_5_1:1.9.0.2
	OPENBSD_5_0:1.7.0.2
	OPENBSD_5_0_BASE:1.7
	OPENBSD_4_9:1.6.0.2
	OPENBSD_4_9_BASE:1.6
	pea_20101025:1.1.1.1
	pea:1.1.1;
locks; strict;
comment	@# @;


1.27
date	2015.10.05.16.29.02;	author sthen;	state Exp;
branches;
next	1.26;
commitid	AqjFzXOPaoxpieFE;

1.26
date	2015.08.25.07.30.30;	author ajacoutot;	state Exp;
branches;
next	1.25;
commitid	x3rR2VHR7RvISfgT;

1.25
date	2015.07.18.01.29.03;	author ajacoutot;	state Exp;
branches;
next	1.24;
commitid	J2kKjmknC9ztCRz3;

1.24
date	2015.06.04.05.44.11;	author ajacoutot;	state Exp;
branches;
next	1.23;
commitid	v42x9zXYqKjWH6Xn;

1.23
date	2015.06.03.12.39.51;	author ajacoutot;	state Exp;
branches;
next	1.22;
commitid	rYSUlNRGFQTLPgv8;

1.22
date	2015.06.03.12.34.10;	author pea;	state Exp;
branches;
next	1.21;
commitid	P2fWEbvmMvyZJ7jc;

1.21
date	2015.06.01.16.23.09;	author pea;	state Exp;
branches;
next	1.20;
commitid	JT2bucB9l0fnRcoh;

1.20
date	2015.01.06.13.19.35;	author jasper;	state Exp;
branches;
next	1.19;
commitid	66xYekJXOPJ4Lb3P;

1.19
date	2015.01.05.09.46.42;	author jasper;	state Exp;
branches;
next	1.18;
commitid	zhIc1sSLDbrbu7An;

1.18
date	2014.03.17.23.22.02;	author sthen;	state Exp;
branches;
next	1.17;

1.17
date	2013.09.02.16.02.40;	author ajacoutot;	state Exp;
branches;
next	1.16;

1.16
date	2013.08.31.17.29.59;	author ajacoutot;	state Exp;
branches;
next	1.15;

1.15
date	2013.03.11.11.35.58;	author espie;	state Exp;
branches;
next	1.14;

1.14
date	2013.03.08.10.37.03;	author jasper;	state Exp;
branches;
next	1.13;

1.13
date	2012.08.06.08.46.59;	author ajacoutot;	state Exp;
branches;
next	1.12;

1.12
date	2012.05.17.07.30.27;	author sthen;	state Exp;
branches;
next	1.11;

1.11
date	2012.04.05.19.58.09;	author jasper;	state Exp;
branches;
next	1.10;

1.10
date	2012.03.09.09.33.03;	author pea;	state Exp;
branches;
next	1.9;

1.9
date	2011.12.17.22.01.13;	author sthen;	state Exp;
branches;
next	1.8;

1.8
date	2011.11.16.00.20.09;	author sthen;	state Exp;
branches;
next	1.7;

1.7
date	2011.06.02.13.41.40;	author ajacoutot;	state Exp;
branches;
next	1.6;

1.6
date	2010.12.27.14.50.23;	author ajacoutot;	state Exp;
branches;
next	1.5;

1.5
date	2010.12.24.10.40.05;	author ajacoutot;	state Exp;
branches;
next	1.4;

1.4
date	2010.12.13.16.14.38;	author ajacoutot;	state Exp;
branches;
next	1.3;

1.3
date	2010.11.19.22.31.39;	author espie;	state Exp;
branches;
next	1.2;

1.2
date	2010.11.08.13.20.44;	author pea;	state Exp;
branches;
next	1.1;

1.1
date	2010.10.25.10.14.53;	author pea;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2010.10.25.10.14.53;	author pea;	state Exp;
branches;
next	;


desc
@@


1.27
log
@REVISION bumps following the additional member in struct if_data,
to make sure packages get updated
@
text
@# $OpenBSD: Makefile,v 1.26 2015/08/25 07:30:30 ajacoutot Exp $

COMMENT-main =		network traffic monitor
COMMENT-vnstati =	image output support for vnstat

V = 			1.14
REVISION-main = 	4
REVISION-vnstati = 	1
DISTNAME =		vnstat-${V}
PKGNAME-main = 		${DISTNAME}
PKGNAME-vnstati = 	vnstati-${V}

CATEGORIES =	net sysutils

HOMEPAGE =	http://humdi.net/vnstat/

MASTER_SITES =	${HOMEPAGE}

MAINTAINER =	Pierre-Emmanuel Andre <pea@@openbsd.org>

# GPLv2
PERMIT_PACKAGE_CDROM =	Yes

WANTLIB 	= c m
WANTLIB-vnstati = ${WANTLIB} gd pthread

MULTI_PACKAGES = -main -vnstati

LIB_DEPENDS-vnstati = graphics/gd
RUN_DEPENDS-vnstati = net/vnstat

USE_GMAKE =	Yes

NO_TEST =	Yes

INSTALL_TARGET = bsdinstall

MAKE_FLAGS =	CC="${CC}" CFLAGS="${CFLAGS} -I${LOCALBASE}/include" \
		LDFLAGS="-L${LOCALBASE}/lib -L${X11BASE}/lib"

post-install:
	${INSTALL_DATA} ${WRKSRC}/examples/vnstat.cgi ${PREFIX}/share/examples/vnstat/

.include <bsd.port.mk>
@


1.26
log
@/var/run content is already removed by /etc/rc, so no need to handle that in
the package. If a /var/run/foo directory must exist for proper start of a
software, then the rc.d script should take care of it.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2015/07/18 01:29:03 ajacoutot Exp $
d6 5
a10 3
V = 		1.14
DISTNAME =	vnstat-${V}
PKGNAME-main = 	${DISTNAME}
a11 2
REVISION-main = 	3
REVISION-vnstati = 	1
@


1.25
log
@sudo(8) -> su(1)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2015/06/04 05:44:11 ajacoutot Exp $
d10 1
a10 1
REVISION-main = 	2
@


1.24
log
@Oops, really fix *_DEPENDS, my bad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2015/06/03 12:39:51 ajacoutot Exp $
d10 1
a10 1
REVISION-main = 	1
@


1.23
log
@Tweak depends/wantlib.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2015/06/03 12:34:10 pea Exp $
d11 1
a11 1
REVISION-vnstati = 	0
d29 2
a30 1
RUN_DEPENDS-vnstati = graphics/gd
@


1.22
log
@Split vnstat into 2 packages: vnstat and vnstati
No more needs to install gd and it's dependencies with vnstat.
If you want to generate output images, please install vnstati.

With a lot of help and ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2015/06/01 16:23:09 pea Exp $
d10 2
a11 1
REVISION-main = 	0
d24 1
a24 1
WANTLIB-main 	= c m
d29 1
a29 1
LIB_DEPENDS-vnstati = graphics/gd
@


1.21
log
@Update to 1.14

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2015/01/06 13:19:35 jasper Exp $
d3 8
a10 1
COMMENT =	network traffic monitor
a11 1
DISTNAME =	vnstat-1.14
d23 4
a26 1
WANTLIB =	c gd m pthread
d28 1
a28 1
LIB_DEPENDS =	graphics/gd
@


1.20
log
@merge some fixes that I actually intended to commit
- tweak to Makefile to get rid of post-configure

ok pea@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2015/01/05 09:46:42 jasper Exp $
d5 1
a5 2
DISTNAME =	vnstat-1.12
REVISION =	0
@


1.19
log
@- update to vnstat-1.12
- rework Makefile patch and don't patch /var/lib to /var/db as the
  bsdinstall target already takes care of that

ok aja@@ (on an earlier diff), pea@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2014/03/17 23:22:02 sthen Exp $
d6 1
a29 3

post-configure:
	perl -pi -e 's,/var/lib,/var/db,g' ${WRKSRC}/man/*.1
@


1.18
log
@sync follow graphics/gd update
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2013/09/02 16:02:40 ajacoutot Exp $
d5 1
a5 2
DISTNAME =	vnstat-1.11
REVISION =	7
d10 1
a10 1
MASTER_SITES = ${HOMEPAGE}
@


1.17
log
@Make the documentation a bit clearer.

ok pea@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2013/08/31 17:29:59 ajacoutot Exp $
d6 1
a6 1
REVISION =	6
d18 1
a18 1
WANTLIB =	c gd m
@


1.16
log
@/var/lib -> /var/db in ma pages.

ok pea@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2013/03/11 11:35:58 espie Exp $
d6 1
a6 1
REVISION =	4
@


1.15
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2013/03/08 10:37:03 jasper Exp $
d6 1
a6 1
REVISION =	3
d30 3
@


1.14
log
@- install vnstat.cgi

ok pea@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2012/08/06 08:46:59 ajacoutot Exp $
a16 3
PERMIT_PACKAGE_FTP =	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP =	Yes
d24 1
a24 1
NO_REGRESS =	Yes
@


1.13
log
@${SYSCONFDIR}/rc.d -> ${RCDIR}
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2012/05/17 07:30:27 sthen Exp $
d6 1
a6 1
REVISION =	2
d33 3
@


1.12
log
@packaging fixes to vnstat, ok pea@@ :

- remove bogus empty @@sample line from PLIST causing "File /usr/local/
is not a file" messages at pkg_delete time

- grammar tweak in README
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2012/04/05 19:58:09 jasper Exp $
d6 1
a6 1
REVISION =	1
@


1.11
log
@- don't give _vnstat a login shell

ok pea@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2012/03/09 09:33:03 pea Exp $
d3 1
a3 1
COMMENT = 	network traffic monitor
d5 3
a7 3
DISTNAME = 	vnstat-1.11
REVISION =	0
CATEGORIES = 	net sysutils
d9 1
a9 1
HOMEPAGE = 	http://humdi.net/vnstat/
d13 1
a13 1
MAINTAINER = 	Pierre-Emmanuel Andre <pea@@openbsd.org>
d16 2
a17 2
PERMIT_PACKAGE_CDROM = 	Yes
PERMIT_PACKAGE_FTP = 	Yes
d19 1
a19 1
PERMIT_DISTFILES_FTP = 	Yes
d21 1
a21 1
WANTLIB = 	c gd m
d23 1
a23 1
LIB_DEPENDS = 	graphics/gd
d25 1
a25 1
USE_GMAKE = 	Yes
d27 1
a27 1
NO_REGRESS = 	Yes
d31 1
a31 1
MAKE_FLAGS = 	CC="${CC}" CFLAGS="${CFLAGS} -I${LOCALBASE}/include" \
@


1.10
log
@Update to 1.11
Initial diff from Gonzalo L. R. (gonzalo at x61.com.ar)

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2011/12/17 22:01:13 sthen Exp $
d6 1
@


1.9
log
@Where a program with an rc script _requires_ a certain command line
parameter to daemonize, move the parameter from daemon to daemon_flags,
so that the user cannot inadvertently prevent it from daemonizing by
adjusting the flags.

Discussed with ajacoutot and schwarze, this method was suggested
by schwarze@@ as a simpler alternative to my diff. ok aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2011/11/16 00:20:09 sthen Exp $
d5 1
a5 1
DISTNAME = 	vnstat-1.10
a7 2
REVISION = 	6

d20 1
a20 1
WANTLIB = 	c m gd
a29 1
LDFLAGS += 	-L${LOCALBASE}/lib -L/usr/X11R6/lib
d31 1
a31 1
		LDFLAGS="${LDFLAGS}"
@


1.8
log
@bumps; net/if.h
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2011/06/02 13:41:40 ajacoutot Exp $
d8 1
a8 1
REVISION = 	5
@


1.7
log
@Add a consistent header that substitutes FULLPKGNAME for the READMEs.

ok jasper@@ sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2010/12/27 14:50:23 ajacoutot Exp $
d8 1
a8 1
REVISION = 	4
@


1.6
log
@Simplify after recent rc.subr change.
The framework is now stable and we will start documenting it (at last).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2010/12/24 10:40:05 ajacoutot Exp $
d8 1
a8 1
REVISION = 	3
@


1.5
log
@Cope with recent rc.subr changes.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2010/12/13 16:14:38 ajacoutot Exp $
d8 1
a8 1
REVISION = 	2
@


1.4
log
@Move to using daemon_user.

ok pea@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2010/11/19 22:31:39 espie Exp $
d8 1
a8 1
REVISION = 	1
@


1.3
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2010/11/08 13:20:44 pea Exp $
d8 1
a8 1
REVISION = 	0
@


1.2
log
@+ new readme location
+ add rc script

With tweaks/advices from jasper@@
ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2010/10/25 10:14:53 pea Exp $
d24 1
a24 1
LIB_DEPENDS = 	::graphics/gd
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d8 2
a34 7

post-install:
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/vnstat
	${SUBST_CMD} -c ${FILESDIR}/README.OpenBSD \
		${PREFIX}/share/doc/vnstat/README.OpenBSD
	chown ${SHAREOWN}:${SHAREGRP} \
		${PREFIX}/share/doc/vnstat/README.OpenBSD
@


1.1.1.1
log
@Import of vnstat:
vnStat is a console-based network traffic monitor for Linux and BSD that
keeps a log of network traffic for the selected interface(s). It uses the
network interface statistics provided by the kernel as information source.
This means that vnStat won't actually be sniffing any traffic and also
ensures light use of system resources.

With tweaks and advices from jasper@@. Thanks

ok jasper@@
@
text
@@
