head	1.12;
access;
symbols
	OPENBSD_6_1:1.12.0.2
	OPENBSD_6_1_BASE:1.12
	OPENBSD_6_0:1.8.0.2
	OPENBSD_6_0_BASE:1.8
	OPENBSD_5_9:1.5.0.2
	OPENBSD_5_9_BASE:1.5
	OPENBSD_5_8:1.2.0.4
	OPENBSD_5_8_BASE:1.2
	OPENBSD_5_7:1.1.1.1.0.2
	OPENBSD_5_7_BASE:1.1.1.1
	ajacoutot_20150125:1.1.1.1
	ajacoutot:1.1.1;
locks; strict;
comment	@# @;


1.12
date	2017.03.16.16.02.52;	author ajacoutot;	state Exp;
branches;
next	1.11;
commitid	DmcNMtTH6KKTbuqx;

1.11
date	2016.09.13.07.45.04;	author ajacoutot;	state Exp;
branches;
next	1.10;
commitid	onE82jfwZnweIas0;

1.10
date	2016.08.01.14.13.28;	author ajacoutot;	state Exp;
branches;
next	1.9;
commitid	wyYpszn7jPuLJVus;

1.9
date	2016.07.30.14.28.40;	author ajacoutot;	state Exp;
branches;
next	1.8;
commitid	vZpPIVlxZrUyghvT;

1.8
date	2016.07.05.14.32.12;	author sthen;	state Exp;
branches;
next	1.7;
commitid	UV3ceLtQzb4zApIC;

1.7
date	2016.06.29.16.14.44;	author espie;	state Exp;
branches;
next	1.6;
commitid	c1yQMbJbfo0CFBcL;

1.6
date	2016.03.20.16.12.25;	author naddy;	state Exp;
branches;
next	1.5;
commitid	guiZq8cnNbVyyHzx;

1.5
date	2016.01.18.22.30.44;	author sthen;	state Exp;
branches;
next	1.4;
commitid	ccKSKYYx8skA6HTd;

1.4
date	2015.12.30.05.56.47;	author ajacoutot;	state Exp;
branches;
next	1.3;
commitid	5BIIwiBQsy6uKBGg;

1.3
date	2015.08.27.06.48.30;	author ajacoutot;	state Exp;
branches;
next	1.2;
commitid	fg1RtdQjUrtjJJWq;

1.2
date	2015.04.04.09.21.03;	author ajacoutot;	state Exp;
branches;
next	1.1;
commitid	kS3kwKZogsvzYmEY;

1.1
date	2015.01.25.09.33.53;	author ajacoutot;	state Exp;
branches
	1.1.1.1;
next	;
commitid	M22kM0R3DipkWSHK;

1.1.1.1
date	2015.01.25.09.33.53;	author ajacoutot;	state Exp;
branches;
next	;
commitid	M22kM0R3DipkWSHK;


desc
@@


1.12
log
@Update to netatalk-3.1.11.
@
text
@# $OpenBSD: Makefile,v 1.11 2016/09/13 07:45:04 ajacoutot Exp $

COMMENT=		AFP file and print services for IP networks

V=			3.1.11
DISTNAME=		netatalk-${V}
EXTRACT_SUFX=		.tar.bz2
PKGSPEC=		netatalk->=3,<4

SHARED_LIBS +=  atalk                16.0     # 16.0

CATEGORIES=		net

HOMEPAGE=		http://netatalk.sourceforge.net/

MAINTAINER=		Antoine Jacoutot <ajacoutot@@openbsd.org>

# GPLv2+
PERMIT_PACKAGE_CDROM=	Yes

WANTLIB += avahi-client avahi-common c crypto db dbus-1 dbus-glib-1
WANTLIB += event_core event_extra ffi gcrypt gio-2.0 glib-2.0
WANTLIB += gmodule-2.0 gobject-2.0 gpg-error gthread-2.0 iconv
WANTLIB += intl pcre pthread tdb z

MASTER_SITES=		${MASTER_SITE_SOURCEFORGE:=netatalk/}

MODULES=		lang/python

MODPY_BUILDDEP=		No
MODPY_ADJ_FILES=	contrib/shell_utils/afpstats

LIB_DEPENDS=		databases/db/v4 \
			databases/tdb \
			devel/libevent2 \
			net/avahi \
			security/libgcrypt \
			x11/dbus-glib

# afpstats(1)
RUN_DEPENDS +=		x11/dbus-python

LIBTOOL_FLAGS=		--tag=disable-static

CONFIGURE_STYLE=	gnu

CONFIGURE_ENV=		CPPFLAGS="-I${LOCALBASE}/include" \
			LDFLAGS="-L${LOCALBASE}/lib" \
			ac_cv_path_MYSQL_CONFIG=

CONFIGURE_ARGS=		--disable-cups \
			--with-pkgconfdir=${SYSCONFDIR}/netatalk \
			--with-ssl-dir=/usr \
			--with-tdb=${LOCALBASE} \
			--with-libevent-header=${LOCALBASE}/include \
			--with-libevent-lib=${LOCALBASE}/lib \
			--without-ldap \
			--without-pam

# XXX does not build
CONFIGURE_ARGS +=	--disable-quota

FAKE_FLAGS=		sysconfdir=${PREFIX}/share/examples/netatalk \
			pkgconfdir=${PREFIX}/share/examples/netatalk/netatalk \
			localstatedir=${PREFIX}/share/examples/netatalk/var

post-install:
	rm ${PREFIX}/lib/netatalk/*.la

.include <bsd.port.mk>
@


1.11
log
@Update to netatalk-3.1.10.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2016/08/01 14:13:28 ajacoutot Exp $
d5 1
a5 1
V=			3.1.10
@


1.10
log
@Tweak config file.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2016/07/30 14:28:40 ajacoutot Exp $
d5 1
a5 1
V=			3.1.9
a8 1
REVISION=		0
@


1.9
log
@Update to netatalk-3.1.9 and simplify getpwnam_shadow() patching.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2016/07/05 14:32:12 sthen Exp $
d8 2
a9 1
PKGSPEC =               netatalk->=3,<4
@


1.8
log
@use getpwnam_shadow to unbreak netatalk3, from Nils Frohberg, ok ajacoutot
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2016/06/29 16:14:44 espie Exp $
d5 1
a5 2
V=			3.1.8
REVISION=		2
d23 2
a24 2
WANTLIB += gmodule-2.0 gobject-2.0 gpg-error gthread-2.0 pcre
WANTLIB += pthread tdb z
d28 1
a28 2
MODULES=		devel/gettext \
			lang/python
@


1.7
log
@add is-branch to all trivial ports that exist as multiple branches.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2016/03/20 16:12:25 naddy Exp $
d6 1
a6 1
REVISION=		1
@


1.6
log
@drop SHARED_ONLY from python and ruby ports
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2016/01/18 22:30:44 sthen Exp $
d6 1
a6 1
REVISION=		0
@


1.5
log
@In the last update netatalk3 changed behaviour to listening on :: rather
than 0.0.0.0 by default. This isn't good on OpenBSD which deliberately
doesn't allow IPv4 connections on an IPv6 socket so revert that change.

Failure reported and fix tested by Johan Huldtgren, ok aja@@
@
text
@d1 1
a1 3
# $OpenBSD: Makefile,v 1.4 2015/12/30 05:56:47 ajacoutot Exp $

SHARED_ONLY=		Yes
@


1.4
log
@Update to netatalk-3.1.8.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2015/08/27 06:48:30 ajacoutot Exp $
d8 1
@


1.3
log
@Fix DBus @@sample files after recent dbus port update.
The dbus package does not install /etc/dbus-1/system.d/ anymore, so it
needs to be properly @@sample'd.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2015/04/04 09:21:03 ajacoutot Exp $
d7 1
a7 1
V=			3.1.7
a10 1
REVISION=		1
d26 1
a26 1
WANTLIB += pthread z
d37 1
d57 1
a64 3

# XXX our tdb is too old
#CONFIGURE_ARGS +=	--with-tdb=${LOCALBASE}
@


1.2
log
@Bump after the recent changes in packaging dbus and dconf.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2015/01/25 09:33:53 ajacoutot Exp $
d11 1
a11 1
REVISION=		0
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2014/12/08 10:57:09 ajacoutot Exp $
d11 1
@


1.1.1.1
log
@Import netatalk-3.1.7.

Netatalk is an OpenSource software package, that can be used to turn a
*NIX machine into an extremely high-performance and reliable file server
for Macintosh computers.
<...>

Sharing the same name as net/netatalk but with a different pkgspec so
users can choose which one to install.
Successfully tested as an Apple Time Machine backup device.

input and ok sthen@@, jasper@@
@
text
@@
