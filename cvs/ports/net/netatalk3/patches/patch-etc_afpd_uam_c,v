head	1.2;
access;
symbols
	OPENBSD_6_1:1.2.0.2
	OPENBSD_6_1_BASE:1.2
	OPENBSD_6_0:1.1.0.2
	OPENBSD_6_0_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2016.07.30.14.28.40;	author ajacoutot;	state Exp;
branches;
next	1.1;
commitid	vZpPIVlxZrUyghvT;

1.1
date	2016.07.05.14.32.12;	author sthen;	state Exp;
branches;
next	;
commitid	UV3ceLtQzb4zApIC;


desc
@@


1.2
log
@Update to netatalk-3.1.9 and simplify getpwnam_shadow() patching.
@
text
@$OpenBSD$
--- etc/afpd/uam.c.orig	Fri Jul 29 14:34:05 2016
+++ etc/afpd/uam.c	Fri Jul 29 14:33:29 2016
@@@@ -205,7 +205,7 @@@@ struct passwd *uam_getname(void *private, char *name, 
     char *p;
     size_t namelen, gecoslen = 0, pwnamelen = 0;
 
-    if ((pwent = getpwnam(name)))
+    if ((pwent = getpwnam_shadow(name)))
         return pwent;
         
     /* if we have a NT domain name try with it */
@


1.1
log
@use getpwnam_shadow to unbreak netatalk3, from Nils Frohberg, ok ajacoutot
@
text
@d2 2
a3 2
--- etc/afpd/uam.c.orig	Thu Jun  9 12:07:15 2016
+++ etc/afpd/uam.c	Thu Jun  9 12:07:26 2016
@

