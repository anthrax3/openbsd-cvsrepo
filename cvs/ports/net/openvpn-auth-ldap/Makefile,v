head	1.14;
access;
symbols
	OPENBSD_6_1:1.9.0.2
	OPENBSD_6_1_BASE:1.9
	OPENBSD_6_0:1.6.0.2
	OPENBSD_6_0_BASE:1.6
	OPENBSD_5_9:1.5.0.2
	OPENBSD_5_9_BASE:1.5
	OPENBSD_5_8:1.4.0.10
	OPENBSD_5_8_BASE:1.4
	OPENBSD_5_7:1.4.0.6
	OPENBSD_5_7_BASE:1.4
	OPENBSD_5_6:1.4.0.4
	OPENBSD_5_6_BASE:1.4
	OPENBSD_5_5:1.4.0.2
	OPENBSD_5_5_BASE:1.4
	OPENBSD_5_4:1.3.0.2
	OPENBSD_5_4_BASE:1.3
	OPENBSD_5_3:1.2.0.4
	OPENBSD_5_3_BASE:1.2
	OPENBSD_5_2:1.2.0.2
	OPENBSD_5_2_BASE:1.2
	OPENBSD_5_1_BASE:1.1.1.1
	OPENBSD_5_1:1.1.1.1.0.2
	jsing_2012-Jan-28:1.1.1.1
	jsing:1.1.1;
locks; strict;
comment	@# @;


1.14
date	2017.08.03.14.46.33;	author jca;	state Exp;
branches;
next	1.13;
commitid	AZ67AUTAnM9GfDZA;

1.13
date	2017.07.27.09.55.45;	author sthen;	state Exp;
branches;
next	1.12;
commitid	B5vWYrki33kPVNK6;

1.12
date	2017.06.20.22.29.38;	author jca;	state Exp;
branches;
next	1.11;
commitid	AZkxk6xFLbzPHTJj;

1.11
date	2017.06.19.21.02.11;	author sebastia;	state Exp;
branches;
next	1.10;
commitid	l5VUOEUhqN6Wb0nk;

1.10
date	2017.06.12.10.57.57;	author ajacoutot;	state Exp;
branches;
next	1.9;
commitid	Jrodt0XCK48q56Zk;

1.9
date	2016.11.12.21.18.05;	author jca;	state Exp;
branches;
next	1.8;
commitid	2Nh0m0ByUuY78Dpb;

1.8
date	2016.11.12.21.17.02;	author jca;	state Exp;
branches;
next	1.7;
commitid	ySdq2Q0I4x4iQM1l;

1.7
date	2016.10.01.11.54.16;	author naddy;	state Exp;
branches;
next	1.6;
commitid	VJ09Ih4WMjVIWTmz;

1.6
date	2016.03.17.11.44.56;	author sthen;	state Exp;
branches;
next	1.5;
commitid	04zFY4HN8zRxhd6z;

1.5
date	2016.01.26.13.05.26;	author sthen;	state Exp;
branches;
next	1.4;
commitid	cMxRj4DrHN3KQ6NU;

1.4
date	2013.08.07.21.32.20;	author naddy;	state Exp;
branches;
next	1.3;

1.3
date	2013.03.11.11.35.50;	author espie;	state Exp;
branches;
next	1.2;

1.2
date	2012.03.29.13.38.48;	author sthen;	state Exp;
branches;
next	1.1;

1.1
date	2012.01.27.13.45.50;	author jsing;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2012.01.27.13.45.50;	author jsing;	state Exp;
branches;
next	;


desc
@@


1.14
log
@Respect LDFLAGS & fix configure check for libobjc2

clang from ports did pass -L/usr/local/lib to the linker, gcc or clang
from base don't do that, so fix detection.  Note that "gcc" is used at
configure time if available, even if the actual build uses "cc".

Maintainer timeout.
@
text
@# $OpenBSD: Makefile,v 1.13 2017/07/27 09:55:45 sthen Exp $

COMMENT =		LDAP authentication plugin for OpenVPN 2.x

# XXX probably broken with clang, please check WANTLIB when fixing

VERSION =		2.0.3
REVISION =		6
DISTNAME =		auth-ldap-${VERSION}
PKGNAME =		openvpn-${DISTNAME}
CATEGORIES =		net security

HOMEPAGE =		https://github.com/threerings/openvpn-auth-ldap

MAINTAINER =		Joel Sing <jsing@@openbsd.org>

# BSD
PERMIT_PACKAGE_CDROM =	 Yes

MODULES =		x11/gnustep
MODGNUSTEP_NEEDS_GUI =	No
WANTLIB =		lber ldap 

MASTER_SITES =		${MASTER_SITE_GOOGLECODE:=openvpn-auth-ldap/}

RUN_DEPENDS =		net/openvpn
LIB_DEPENDS =		databases/openldap
BUILD_DEPENDS =		${RUN_DEPENDS} \
			devel/check \
			devel/re2c

SEPARATE_BUILD =	Yes

AUTOCONF_VERSION =	2.69
CONFIGURE_STYLE =	autoconf
MAKE_FILE =		Makefile

CONFIGURE_ARGS =  --with-check=${LOCALBASE} \
		  --with-openldap=${LOCALBASE} \
		  --with-openvpn=${LOCALBASE}/include/openvpn
CONFIGURE_ENV =		CPPFLAGS="-I${LOCALBASE}/include" \
			LDFLAGS="-L${LOCALBASE}/lib ${LDFLAGS}"

SAMPLES_DIR =		${PREFIX}/share/examples/openvpn-auth-ldap

post-install:
	${INSTALL_DATA_DIR} ${SAMPLES_DIR}
	${INSTALL_DATA} ${WRKSRC}/auth-ldap.conf ${SAMPLES_DIR}/auth-ldap.conf

do-test:
	cd ${WRKBUILD}/tests && ${MAKE} test

.include <bsd.port.mk>
@


1.13
log
@add COMPILER_LIBCXX to WANTLIB and bump
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2017/06/20 22:29:38 jca Exp $
d38 1
a38 2
CONFIGURE_ARGS += --prefix=${LOCALBASE} \
		  --with-check=${LOCALBASE} \
d41 2
@


1.12
log
@Drop extra line, and ack successful test reports from Sebastien Leclerc
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2017/06/19 21:02:11 sebastia Exp $
d5 2
d8 1
a8 1
REVISION =		5
@


1.11
log
@Use the modern libobjc2 runtime from x11/gnustep/libbojc2, make
use of the gnustep module.

Patches for the modern runtime from Debian (pointer to it from jca@@)

Additionally, some failing tests, due to using the modern runtime, are disabled

The package is currently broken, and this is an attempt to fix it, and
give people a chance to actually test it.

proposed to go ahead by sthen@@, also OK espie@@, jca@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2017/06/12 10:57:57 ajacoutot Exp $
a39 2

#TEST_TARGET =		test
@


1.10
log
@Remove trailing lines.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2016/11/12 21:18:05 jca Exp $
d6 1
a6 1
REVISION =		4
d18 3
a20 1
WANTLIB =		lber ldap objc
d32 3
a34 1
CONFIGURE_STYLE =	gnu
d41 1
a41 1
TEST_TARGET =		test
d48 3
@


1.9
log
@Enable tests.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2016/10/01 11:54:16 naddy Exp $
d6 1
a6 1
REVISION =		3
@


1.8
log
@Ensure that we link against libobjc.so from base.

Newer libobjc from ports isn't compatible.  Problem reported by
Sebastien Leclerc.
@
text
@d25 1
d33 1
d36 2
@


1.7
log
@The ${PROJECT}.googlecode.com/files/ master sites are no longer
accessible, but the distfiles are still available at an archive URL.
Introduce MASTER_SITE_GOOGLECODE and use it for all affected ports.

ok czarkoff@@ danj@@ sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2016/03/17 11:44:56 sthen Exp $
d6 1
a6 1
REVISION =		2
@


1.6
log
@remove a couple of PFRAG.shared
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2016/01/26 13:05:26 sthen Exp $
d20 1
a20 1
MASTER_SITES =		https://openvpn-auth-ldap.googlecode.com/files/
@


1.5
log
@Chase Location: header redirects for googlecode-hosted HOMEPAGEs and
bump REVISION.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2013/08/07 21:32:20 naddy Exp $
d6 1
a6 1
REVISION =		1
@


1.4
log
@move http://code.google.com, *.googlecode.com, and sites.google.com to https
suggested by bentley@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2013/03/11 11:35:50 espie Exp $
d6 1
a8 1
REVISION =		0
d11 1
a11 1
HOMEPAGE =		https://code.google.com/p/openvpn-auth-ldap/
@


1.3
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2012/03/29 13:38:48 sthen Exp $
d8 1
d11 1
a11 1
HOMEPAGE =		http://code.google.com/p/openvpn-auth-ldap/
d20 1
a20 1
MASTER_SITES =		http://openvpn-auth-ldap.googlecode.com/files/
@


1.2
log
@Change SEPARATE_BUILD=(concurrent|simple) to Yes; bsd.port.mk doesn't
make a distinction between these.  ok aja@@ dcoppa@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2012/01/27 13:45:50 jsing Exp $
a15 3
PERMIT_PACKAGE_FTP =	 Yes
PERMIT_DISTFILES_CDROM = Yes
PERMIT_DISTFILES_FTP =	 Yes
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.template,v 1.60 2010/10/24 20:41:23 ajacoutot Exp $
d29 1
a29 1
SEPARATE_BUILD =	simple
@


1.1.1.1
log
@Import openvpn-auth-ldap port.

With feedback from sthen@@

ok sthen@@
@
text
@@
