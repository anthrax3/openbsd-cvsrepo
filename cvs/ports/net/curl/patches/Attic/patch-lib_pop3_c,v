head	1.1;
access;
symbols
	OPENBSD_5_0:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2012.01.27.23.08.01;	author ajacoutot;	state dead;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2012.01.27.23.08.01;	author ajacoutot;	state Exp;
branches;
next	;


desc
@@


1.1
log
@file patch-lib_pop3_c was initially added on branch OPENBSD_5_0.
@
text
@@


1.1.2.1
log
@SECURITY fix for multiple vulnerabilities:
URL sanitize: reject URLs containing bad data (CVE-2012-0036)
OpenSSL: don't disable security work-around

ok sthen@@ naddy@@ (maintainer)
@
text
@a0 21
$OpenBSD$

From upstream: 75ca568fa1c19de4c5358fed246686de8467c238
URL sanitize: reject URLs containing bad data
CVE-2012-0036: http://curl.haxx.se/docs/adv_20120124.html

--- lib/pop3.c.orig	Tue Jun 21 17:55:39 2011
+++ lib/pop3.c	Fri Jan 27 08:41:52 2012
@@@@ -900,11 +900,7 @@@@ static CURLcode pop3_parse_url_path(struct connectdata
   const char *path = data->state.path;
 
   /* url decode the path and use this mailbox */
-  pop3c->mailbox = curl_easy_unescape(data, path, 0, NULL);
-  if(!pop3c->mailbox)
-    return CURLE_OUT_OF_MEMORY;
-
-  return CURLE_OK;
+  return Curl_urldecode(data, path, 0, &pop3c->mailbox, NULL, TRUE);
 }
 
 /* call this when the DO phase has completed */
@

