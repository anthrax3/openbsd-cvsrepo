head	1.2;
access;
symbols
	OPENBSD_3_5:1.1.0.6
	OPENBSD_3_7:1.1.0.4
	OPENBSD_3_7_BASE:1.1
	OPENBSD_3_6:1.1.0.2;
locks; strict;
comment	@# @;


1.2
date	2005.05.26.23.13.28;	author naddy;	state dead;
branches;
next	1.1;

1.1
date	2005.03.14.22.52.20;	author naddy;	state Exp;
branches
	1.1.2.1
	1.1.4.1
	1.1.6.1;
next	;

1.1.2.1
date	2005.03.15.22.20.39;	author robert;	state Exp;
branches;
next	1.1.2.2;

1.1.2.2
date	2005.10.22.06.41.40;	author sturm;	state dead;
branches;
next	;

1.1.4.1
date	2005.10.22.06.42.22;	author sturm;	state dead;
branches;
next	;

1.1.6.1
date	2005.03.29.20.25.38;	author sturm;	state Exp;
branches;
next	;


desc
@@


1.2
log
@maintenance update to 7.14.0 and take maintainer
@
text
@$OpenBSD: patch-lib_http_ntlm_c,v 1.1 2005/03/14 22:52:20 naddy Exp $
--- lib/http_ntlm.c.orig	Mon Mar 14 21:15:15 2005
+++ lib/http_ntlm.c	Mon Mar 14 21:16:43 2005
@@@@ -105,7 +105,6 @@@@ CURLntlm Curl_input_ntlm(struct connectd
     header++;
 
   if(checkprefix("NTLM", header)) {
-    unsigned char buffer[256];
     header += strlen("NTLM");
 
     while(*header && isspace((int)*header))
@@@@ -126,7 +125,12 @@@@ CURLntlm Curl_input_ntlm(struct connectd
          32 (48) start of data block
       */
 
-      size_t size = Curl_base64_decode(header, (char *)buffer);
+      size_t size;
+      unsigned char *buffer = (unsigned char *)malloc(strlen(header));
+      if (buffer == NULL)
+        return CURLNTLM_BAD;
+
+      size = Curl_base64_decode(header, (char *)buffer);
 
       ntlm->state = NTLMSTATE_TYPE2; /* we got a type-2 */
 
@


1.1
log
@SECURITY:
Fix NT LAN Manager (NTLM) authentication handling. By sending a
specially crafted long NTLM reply packet, a remote attacker could
overflow the reply buffer.  This could lead to execution of arbitrary
attacker specified code with the privileges of the application using
the cURL library.  CAN-2005-0490.  From Ubuntu.

ok brad@@, pval@@
@
text
@d1 1
a1 1
$OpenBSD$
@


1.1.4.1
log
@MFC:
Update to 7.15.0.
libcurl's NTLM function could overflow a stack-based buffer if given
a too long user name or domain name.  CAN-2005-3185.

ok brad
@
text
@d1 1
a1 1
$OpenBSD: patch-lib_http_ntlm_c,v 1.1 2005/03/14 22:52:20 naddy Exp $
@


1.1.6.1
log
@MFC:

Fix NT LAN Manager (NTLM) authentication handling. By sending a
specially crafted long NTLM reply packet, a remote attacker could
overflow the reply buffer.  This could lead to execution of arbitrary
attacker specified code with the privileges of the application using
the cURL library.  CAN-2005-0490.  From Ubuntu.

ok brad@@
@
text
@d2 2
a3 2
--- lib/http_ntlm.c.orig	2005-03-29 19:40:02.000000000 +0200
+++ lib/http_ntlm.c	2005-03-29 19:41:34.000000000 +0200
d16 1
a16 1
-      int size = Curl_base64_decode(header, buffer);
@


1.1.2.1
log
@SECURITY:
Fix NT LAN Manager (NTLM) authentication handling. By sending a
specially crafted long NTLM reply packet, a remote attacker could
overflow the reply buffer.  This could lead to execution of arbitrary
attacker specified code with the privileges of the application using
the cURL library.
http://www.vuxml.org/openbsd/531c3456-94dc-11d9-a433-080020fe8945.html

ok brad@@
@
text
@@


1.1.2.2
log
@MFC:
Update to 7.15.0.
libcurl's NTLM function could overflow a stack-based buffer if given
a too long user name or domain name.  CAN-2005-3185.

ok brad
@
text
@d1 1
a1 1
$OpenBSD: patch-lib_http_ntlm_c,v 1.1.2.1 2005/03/15 22:20:39 robert Exp $
@


