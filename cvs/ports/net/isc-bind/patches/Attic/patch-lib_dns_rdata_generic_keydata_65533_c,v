head	1.1;
access;
symbols
	OPENBSD_5_4:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2014.01.16.13.55.38;	author jasper;	state dead;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2014.01.16.13.55.38;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.1
log
@file patch-lib_dns_rdata_generic_keydata_65533_c was initially added on branch OPENBSD_5_4.
@
text
@@


1.1.2.1
log
@Backport two security fixes (CVE-2013-4854 and CVE-2014-0591)

ok sthen@@
@
text
@a0 15
$OpenBSD$

Security fix for CVE-2013-4854

--- lib/dns/rdata/generic/keydata_65533.c.orig	Sun Dec 29 17:02:40 2013
+++ lib/dns/rdata/generic/keydata_65533.c	Sun Dec 29 17:03:17 2013
@@@@ -194,7 +194,7 @@@@ fromwire_keydata(ARGS_FROMWIRE) {
 	UNUSED(options);
 
 	isc_buffer_activeregion(source, &sr);
-	if (sr.length < 4)
+	if (sr.length < 16)
 		return (ISC_R_UNEXPECTEDEND);
 
 	isc_buffer_forward(source, sr.length);
@

