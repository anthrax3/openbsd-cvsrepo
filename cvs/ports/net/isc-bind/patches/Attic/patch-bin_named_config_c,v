head	1.3;
access;
symbols
	OPENBSD_5_7:1.2.0.2
	OPENBSD_5_7_BASE:1.2
	OPENBSD_5_6:1.1.0.2;
locks; strict;
comment	@# @;


1.3
date	2015.03.14.21.01.54;	author sthen;	state dead;
branches;
next	1.2;
commitid	MQ9hkp7cdnkMulNE;

1.2
date	2014.12.17.23.39.17;	author sthen;	state Exp;
branches
	1.2.2.1;
next	1.1;
commitid	GJ7YUXt1muHPRvJO;

1.1
date	2014.12.09.17.21.36;	author sthen;	state Exp;
branches
	1.1.2.1;
next	;
commitid	vQgekxsrnYovudZN;

1.1.2.1
date	2014.12.09.17.54.11;	author sthen;	state Exp;
branches;
next	1.1.2.2;
commitid	yVHy4IkF9dXKqnwu;

1.1.2.2
date	2015.07.30.23.26.59;	author sthen;	state dead;
branches;
next	;
commitid	bay3dsxiFY57Acn5;

1.2.2.1
date	2015.06.10.22.47.24;	author sthen;	state dead;
branches;
next	;
commitid	mM8rqZxS2P7ASQW6;


desc
@@


1.3
log
@update to BIND 9.10.2
@
text
@$OpenBSD: patch-bin_named_config_c,v 1.2 2014/12/17 23:39:17 sthen Exp $

From be7fba80190c33b0e50f086509b42bb319bb95b4 Mon Sep 17 00:00:00 2001
From: Evan Hunt <each@@isc.org>
Date: Mon, 15 Dec 2014 22:28:06 -0800
Subject: [PATCH 1/1] [master] adjust max-recursion-queries

--- bin/named/config.c.orig	Tue Dec  9 17:03:45 2014
+++ bin/named/config.c	Tue Dec  9 17:04:17 2014
@@@@ -169,7 +169,7 @@@@ options {\n\
 	clients-per-query 10;\n\
 	max-clients-per-query 100;\n\
 	max-recursion-depth 7;\n\
-	max-recursion-queries 50;\n\
+	max-recursion-queries 75;\n\
 	zero-no-soa-ttl-cache no;\n\
 	nsec3-test-zone no;\n\
 	allow-new-zones no;\n\
@


1.2
log
@Revert previous BIND workaround for query failures when coming up cold.
Instead, cherrypick a fix from git at source.isc.org; this exempts TLD and
root zone lookups from max-recursion-queries and changes the default to 75.
@
text
@d1 1
a1 1
$OpenBSD: patch-bin_named_config_c,v 1.1 2014/12/09 17:21:36 sthen Exp $
@


1.2.2.1
log
@MFC: SECURITY update to BIND 9.10.2-P1, various problems with RPZ (policy zones),
and a possible crash with async zone loads. https://kb.isc.org/article/AA-01266

"If you are using RPZ in BIND 9.10 in a production environment, and
particularly if you have multiple policy zones, you should upgrade to
BIND 9.10.2-P1. Otherwise, this upgrade is not urgent."
@
text
@d1 1
a1 1
$OpenBSD: patch-bin_named_config_c,v 1.2 2014/12/17 23:39:17 sthen Exp $
@


1.1
log
@Update to BIND 9.10.1-P1, including query limits for recursion (DoS avoidance,
CVE-2014-8500), assertion DoS (recursive only, only with prefetch enabled,
CVE-2014-3214), assertion DoS (EDNS option processing, CVE-2014-3859) and
fixes to GeoIP (CVE-2014-8680 and another unclassified).

https://kb.isc.org/article/AA-01223/81/BIND-9.10.1-P1-Release-Notes.html

Add a local patch to increase the default query limit, during testing it
appears that the standard defaults can be easily falsely triggered during
priming at startup.
@
text
@d1 1
a1 1
$OpenBSD$
d3 4
a6 4
Increase query limit until a level at which a query with "dig @@::1
www.ibm.com a" succeeds at startup. 150 was not enough.

https://lists.isc.org/pipermail/bind-users/2014-December/094240.html
d15 1
a15 1
+	max-recursion-queries 200;\n\
@


1.1.2.1
log
@MFC BIND update:

Update to BIND 9.10.1-P1, including query limits for recursion (DoS avoidance,
CVE-2014-8500), assertion DoS (recursive only, only with prefetch enabled,
CVE-2014-3214), assertion DoS (EDNS option processing, CVE-2014-3859) and
fixes to GeoIP (CVE-2014-8680 and another unclassified).

https://kb.isc.org/article/AA-01223/81/BIND-9.10.1-P1-Release-Notes.html

Add a local patch to increase the default query limit, during testing it
appears that the standard defaults can be easily falsely triggered during
priming at startup.
@
text
@d1 1
a1 1
$OpenBSD: patch-bin_named_config_c,v 1.1 2014/12/09 17:21:36 sthen Exp $
@


1.1.2.2
log
@Apply BIND security update to OPENBSD_5_6 as well

Security update to BIND 9.10.2p3 - a failure to reset a value to NULL in tkey.c
could result in an assertion failure. (CVE-2015-5477)
@
text
@d1 1
a1 1
$OpenBSD: patch-bin_named_config_c,v 1.1.2.1 2014/12/09 17:54:11 sthen Exp $
@


