head	1.1;
access;
symbols
	OPENBSD_6_0:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2017.01.24.11.46.35;	author sthen;	state Exp;
branches
	1.1.2.1;
next	;
commitid	XRs8XNeIv80JWdqa;

1.1.2.1
date	2017.02.09.00.05.52;	author sthen;	state Exp;
branches;
next	;
commitid	DEfadRDbdVXIVfRp;


desc
@@


1.1
log
@add pledges for dig/host/nslookup in the ports version of BIND. initial
pledge is "stdio rpath inet unix dns", dropping to "stdio inet dns"
after argument parsing.

access to resolv.conf is required late; the dns pledge is used for this
rather than requiring full rpath; however contrary to the version in
base, inet is allowed as well, so that it can be used as a debug tool
for servers on alternate ports.

works fine for me; no feedback after posting yet so committing to get
real-world testing. please report any issues.
@
text
@$OpenBSD$
--- lib/isc/unix/net.c.orig	Mon Jan 16 09:47:30 2017
+++ lib/isc/unix/net.c	Mon Jan 16 09:48:12 2017
@@@@ -731,7 +731,7 @@@@ try_dscp_v6(void) {
 	if (setsockopt(s, IPPROTO_IPV6, IPV6_TCLASS, &dscp, sizeof(dscp)) == 0)
 		dscp_result |= ISC_NET_DSCPSETV6;
 
-#ifdef IPV6_RECVTCLASS
+#if 0 /* pledge doesn't allow setsockopt IPV6_RECVTCLASS */
 	on = 1;
 	if (setsockopt(s, IPPROTO_IPV6, IPV6_RECVTCLASS, &on, sizeof(on)) == 0)
 		dscp_result |= ISC_NET_DSCPRECVV6;
@


1.1.2.1
log
@update to BIND 9.10.4-P6

* If a server is configured with a response policy zone (RPZ) that
rewrites an answer with local data, and is also configured for DNS64
address mapping, a NULL pointer can be read triggering a server crash.
This flaw is disclosed in CVE-2017-3135. [RT #44434]

* A synthesized CNAME record appearing in a response before the associated
DNAME could be cached, when it should not have been. This was a
regression introduced while addressing CVE-2016-8864. [RT #44318]
@
text
@d1 1
a1 1
$OpenBSD: patch-lib_isc_unix_net_c,v 1.1 2017/01/24 11:46:35 sthen Exp $
@

