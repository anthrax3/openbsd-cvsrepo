head	1.70;
access;
symbols
	OPENBSD_6_1:1.65.0.2
	OPENBSD_6_1_BASE:1.65
	OPENBSD_6_0:1.59.0.2
	OPENBSD_6_0_BASE:1.59
	OPENBSD_5_9:1.53.0.2
	OPENBSD_5_9_BASE:1.53
	OPENBSD_5_8:1.44.0.4
	OPENBSD_5_8_BASE:1.44
	OPENBSD_5_7:1.37.0.2
	OPENBSD_5_7_BASE:1.37
	OPENBSD_5_6:1.28.0.2
	OPENBSD_5_6_BASE:1.28
	OPENBSD_5_5:1.24.0.2
	OPENBSD_5_5_BASE:1.24
	OPENBSD_5_4:1.17.0.2
	OPENBSD_5_4_BASE:1.17
	OPENBSD_5_3:1.9.0.2
	OPENBSD_5_3_BASE:1.9
	OPENBSD_5_2:1.1.1.1.0.2
	OPENBSD_5_2_BASE:1.1.1.1
	sthen_20120719:1.1.1.1
	sthen:1.1.1;
locks; strict;
comment	@# @;


1.70
date	2017.07.10.07.38.04;	author sthen;	state Exp;
branches;
next	1.69;
commitid	rz2kazzkS5jEJXek;

1.69
date	2017.06.29.21.14.54;	author sthen;	state Exp;
branches;
next	1.68;
commitid	qdCK81ujxfrwzQLn;

1.68
date	2017.06.15.09.01.49;	author sthen;	state Exp;
branches;
next	1.67;
commitid	I4rITsFMWJh7h7co;

1.67
date	2017.05.03.20.20.42;	author sthen;	state Exp;
branches;
next	1.66;
commitid	Mn85r2RkIV0pryCt;

1.66
date	2017.04.13.10.35.33;	author sthen;	state Exp;
branches;
next	1.65;
commitid	Hj45ksO8cU27VTyV;

1.65
date	2017.02.09.00.04.40;	author sthen;	state Exp;
branches
	1.65.2.1;
next	1.64;
commitid	pOLpGLCty1M5N6FT;

1.64
date	2017.01.24.11.46.35;	author sthen;	state Exp;
branches;
next	1.63;
commitid	XRs8XNeIv80JWdqa;

1.63
date	2017.01.12.12.22.20;	author sthen;	state Exp;
branches;
next	1.62;
commitid	mqy83H0cNnOPtJTk;

1.62
date	2016.11.01.21.02.03;	author sthen;	state Exp;
branches;
next	1.61;
commitid	TKcP6LPHrXmCnkvE;

1.61
date	2016.09.27.19.49.10;	author sthen;	state Exp;
branches;
next	1.60;
commitid	294IPbIhPfb3tCrC;

1.60
date	2016.09.13.16.12.14;	author naddy;	state Exp;
branches;
next	1.59;
commitid	LsYahYRn03mp1yEc;

1.59
date	2016.07.19.10.46.15;	author sthen;	state Exp;
branches
	1.59.2.1;
next	1.58;
commitid	0LEUh7KnWZCaiUOo;

1.58
date	2016.05.26.09.25.25;	author sthen;	state Exp;
branches;
next	1.57;
commitid	yTbYOxz8SEoCw02K;

1.57
date	2016.04.29.11.01.02;	author sthen;	state Exp;
branches;
next	1.56;
commitid	CaWc4RaXgTEhrNgh;

1.56
date	2016.03.11.20.28.28;	author naddy;	state Exp;
branches;
next	1.55;
commitid	UYLP8TE6V7RS2GhJ;

1.55
date	2016.03.10.00.03.34;	author sthen;	state Exp;
branches;
next	1.54;
commitid	bViOr7EpTkDQieoW;

1.54
date	2016.03.01.00.07.17;	author sthen;	state Exp;
branches;
next	1.53;
commitid	QBhOYg1ODJRuhu7C;

1.53
date	2016.01.19.22.24.05;	author sthen;	state Exp;
branches
	1.53.2.1;
next	1.52;
commitid	7jLzHvO1fLZuraFH;

1.52
date	2015.12.17.17.07.41;	author sthen;	state Exp;
branches;
next	1.51;
commitid	SwOV06MYoMqTLkNR;

1.51
date	2015.12.15.22.43.37;	author sthen;	state Exp;
branches;
next	1.50;
commitid	0MUDu7nn4qyXA1xU;

1.50
date	2015.10.07.19.36.50;	author sthen;	state Exp;
branches;
next	1.49;
commitid	36EFkoqHoECCWnKg;

1.49
date	2015.10.03.19.44.51;	author sthen;	state Exp;
branches;
next	1.48;
commitid	LZbfDzhBUvRK80FB;

1.48
date	2015.09.25.14.02.31;	author sthen;	state Exp;
branches;
next	1.47;
commitid	BVz4tJZeqsFcsueN;

1.47
date	2015.09.16.15.28.16;	author sthen;	state Exp;
branches;
next	1.46;
commitid	18fPTm0hn2Ige1VR;

1.46
date	2015.09.02.20.25.43;	author sthen;	state Exp;
branches;
next	1.45;
commitid	IPf3EwI7C2ARgKNy;

1.45
date	2015.08.24.20.46.49;	author sthen;	state Exp;
branches;
next	1.44;
commitid	oOoDfz8eKLMhYSsL;

1.44
date	2015.07.28.20.03.35;	author sthen;	state Exp;
branches
	1.44.4.1;
next	1.43;
commitid	uuBS3snj0vCXgPuR;

1.43
date	2015.07.15.06.43.31;	author sthen;	state Exp;
branches;
next	1.42;
commitid	ssVh6cwSm5nkijE4;

1.42
date	2015.07.07.19.32.47;	author sthen;	state Exp;
branches;
next	1.41;
commitid	1E3g86MFoK2q2zgz;

1.41
date	2015.06.10.22.40.41;	author sthen;	state Exp;
branches;
next	1.40;
commitid	V0FdRMDB3s7PCadL;

1.40
date	2015.05.16.10.15.53;	author kettenis;	state Exp;
branches;
next	1.39;
commitid	aHNWFchyU3Xyek3q;

1.39
date	2015.03.14.22.26.21;	author sthen;	state Exp;
branches;
next	1.38;
commitid	34HlTKdTSJ3JfhO3;

1.38
date	2015.03.14.21.01.54;	author sthen;	state Exp;
branches;
next	1.37;
commitid	MQ9hkp7cdnkMulNE;

1.37
date	2015.02.18.22.49.44;	author sthen;	state Exp;
branches
	1.37.2.1;
next	1.36;
commitid	8V8Fh4LPMnHir2wB;

1.36
date	2015.01.30.15.15.42;	author sthen;	state Exp;
branches;
next	1.35;
commitid	EjCLMLjF9WrweSsq;

1.35
date	2015.01.15.22.34.02;	author sthen;	state Exp;
branches;
next	1.34;
commitid	c0TqCYxJErBomqr3;

1.34
date	2015.01.15.18.10.38;	author landry;	state Exp;
branches;
next	1.33;
commitid	uEljy9hzDyerLl26;

1.33
date	2014.12.17.23.39.17;	author sthen;	state Exp;
branches;
next	1.32;
commitid	GJ7YUXt1muHPRvJO;

1.32
date	2014.12.09.17.21.36;	author sthen;	state Exp;
branches;
next	1.31;
commitid	vQgekxsrnYovudZN;

1.31
date	2014.09.23.09.42.41;	author sthen;	state Exp;
branches;
next	1.30;
commitid	FrEeLL4FjioFWSQ6;

1.30
date	2014.08.22.20.56.00;	author sthen;	state Exp;
branches;
next	1.29;
commitid	L5BtNAECepeENt3k;

1.29
date	2014.08.22.20.32.13;	author sthen;	state Exp;
branches;
next	1.28;
commitid	yw5iSs0sfRNvewuY;

1.28
date	2014.06.11.22.44.05;	author sthen;	state Exp;
branches
	1.28.2.1;
next	1.27;
commitid	vwbdLbWKev4HEfEB;

1.27
date	2014.05.08.22.14.56;	author sthen;	state Exp;
branches;
next	1.26;

1.26
date	2014.05.01.20.19.25;	author sthen;	state Exp;
branches;
next	1.25;

1.25
date	2014.04.15.08.53.04;	author ajacoutot;	state Exp;
branches;
next	1.24;

1.24
date	2014.01.31.10.14.46;	author sthen;	state Exp;
branches;
next	1.23;

1.23
date	2014.01.31.10.12.57;	author sthen;	state Exp;
branches;
next	1.22;

1.22
date	2014.01.13.17.13.11;	author sthen;	state Exp;
branches;
next	1.21;

1.21
date	2013.11.06.20.37.11;	author sthen;	state Exp;
branches;
next	1.20;

1.20
date	2013.09.19.23.33.11;	author sthen;	state Exp;
branches;
next	1.19;

1.19
date	2013.08.28.20.55.22;	author rpe;	state Exp;
branches;
next	1.18;

1.18
date	2013.08.06.20.09.00;	author sthen;	state Exp;
branches;
next	1.17;

1.17
date	2013.06.05.00.32.18;	author sthen;	state Exp;
branches
	1.17.2.1;
next	1.16;

1.16
date	2013.05.31.10.09.03;	author sthen;	state Exp;
branches;
next	1.15;

1.15
date	2013.05.29.20.19.15;	author sthen;	state Exp;
branches;
next	1.14;

1.14
date	2013.04.13.12.41.01;	author sthen;	state Exp;
branches;
next	1.13;

1.13
date	2013.04.03.20.17.23;	author sthen;	state Exp;
branches;
next	1.12;

1.12
date	2013.03.28.09.18.51;	author sthen;	state Exp;
branches;
next	1.11;

1.11
date	2013.03.21.08.46.34;	author ajacoutot;	state Exp;
branches;
next	1.10;

1.10
date	2013.03.11.11.35.48;	author espie;	state Exp;
branches;
next	1.9;

1.9
date	2013.02.09.14.49.52;	author sthen;	state Exp;
branches
	1.9.2.1;
next	1.8;

1.8
date	2013.01.04.13.34.51;	author sthen;	state Exp;
branches;
next	1.7;

1.7
date	2012.12.04.21.48.27;	author sthen;	state Exp;
branches;
next	1.6;

1.6
date	2012.10.09.22.46.17;	author sthen;	state Exp;
branches;
next	1.5;

1.5
date	2012.09.12.17.21.52;	author sthen;	state Exp;
branches;
next	1.4;

1.4
date	2012.09.02.10.55.59;	author naddy;	state Exp;
branches;
next	1.3;

1.3
date	2012.08.31.09.16.35;	author sthen;	state Exp;
branches;
next	1.2;

1.2
date	2012.08.07.07.44.27;	author sthen;	state Exp;
branches;
next	1.1;

1.1
date	2012.07.19.08.36.45;	author sthen;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2012.07.19.08.36.45;	author sthen;	state Exp;
branches
	1.1.1.1.2.1;
next	;

1.1.1.1.2.1
date	2012.09.12.17.49.07;	author sthen;	state Exp;
branches;
next	1.1.1.1.2.2;

1.1.1.1.2.2
date	2012.10.09.23.44.52;	author sthen;	state Exp;
branches;
next	1.1.1.1.2.3;

1.1.1.1.2.3
date	2012.12.04.21.49.22;	author sthen;	state Exp;
branches;
next	1.1.1.1.2.4;

1.1.1.1.2.4
date	2013.03.28.09.19.23;	author sthen;	state Exp;
branches;
next	;

1.9.2.1
date	2013.05.01.09.06.03;	author sthen;	state Exp;
branches;
next	;

1.17.2.1
date	2014.01.16.13.55.38;	author jasper;	state Exp;
branches;
next	;

1.28.2.1
date	2014.12.09.17.54.11;	author sthen;	state Exp;
branches;
next	1.28.2.2;
commitid	yVHy4IkF9dXKqnwu;

1.28.2.2
date	2015.02.18.22.51.18;	author sthen;	state Exp;
branches;
next	1.28.2.3;
commitid	G3KZYRjeooj5cD4I;

1.28.2.3
date	2015.07.30.23.26.59;	author sthen;	state Exp;
branches;
next	;
commitid	bay3dsxiFY57Acn5;

1.37.2.1
date	2015.06.10.22.47.24;	author sthen;	state Exp;
branches;
next	1.37.2.2;
commitid	mM8rqZxS2P7ASQW6;

1.37.2.2
date	2015.07.07.19.34.10;	author sthen;	state Exp;
branches;
next	1.37.2.3;
commitid	8skgbXV6j5pSIpPA;

1.37.2.3
date	2015.07.28.20.04.17;	author sthen;	state Exp;
branches;
next	1.37.2.4;
commitid	ucxq0GqwrADHxYW9;

1.37.2.4
date	2015.09.02.20.28.13;	author sthen;	state Exp;
branches;
next	;
commitid	8NYp3hn5T9lh31vU;

1.44.4.1
date	2015.09.02.20.27.37;	author sthen;	state Exp;
branches;
next	1.44.4.2;
commitid	bKy7i9poh0iAfx49;

1.44.4.2
date	2015.12.17.17.06.39;	author sthen;	state Exp;
branches;
next	1.44.4.3;
commitid	4Dy38fwPfoAutUmr;

1.44.4.3
date	2016.01.22.14.54.09;	author jasper;	state Exp;
branches;
next	1.44.4.4;
commitid	J3TtuDUkyDoDtBK8;

1.44.4.4
date	2016.03.10.09.57.19;	author jasper;	state Exp;
branches;
next	;
commitid	Zand63mbnsFh8MEh;

1.53.2.1
date	2016.07.20.11.46.54;	author jasper;	state Exp;
branches;
next	;
commitid	tPQ0vO0XzybePq1e;

1.59.2.1
date	2016.09.27.19.49.58;	author sthen;	state Exp;
branches;
next	1.59.2.2;
commitid	wCBW2XZSAjXfcodV;

1.59.2.2
date	2016.11.01.21.05.37;	author sthen;	state Exp;
branches;
next	1.59.2.3;
commitid	nZ8BjgJsWKT9mj0m;

1.59.2.3
date	2017.01.12.12.24.04;	author sthen;	state Exp;
branches;
next	1.59.2.4;
commitid	vKm9AWHdV4qClMm0;

1.59.2.4
date	2017.02.09.00.05.52;	author sthen;	state Exp;
branches;
next	;
commitid	DEfadRDbdVXIVfRp;

1.65.2.1
date	2017.04.13.10.36.11;	author sthen;	state Exp;
branches;
next	1.65.2.2;
commitid	2Wr7UwCoFczu4fJg;

1.65.2.2
date	2017.06.15.09.02.53;	author sthen;	state Exp;
branches;
next	1.65.2.3;
commitid	eRLhuEKkg8KPPcb4;

1.65.2.3
date	2017.06.29.21.15.31;	author sthen;	state Exp;
branches;
next	1.65.2.4;
commitid	qg78PvZeYjnOg0P5;

1.65.2.4
date	2017.07.10.07.38.05;	author sthen;	state Exp;
branches;
next	;
commitid	8nGlpgQFh7NkGmuI;


desc
@@


1.70
log
@update to BIND-9.10.5-P3

9.10.5-P2 broke verification of TSIG signed TCP message sequences where
not all the messages contain TSIG records. These may be used in AXFR and
IXFR responses. [RT #45509]
@
text
@# $OpenBSD: Makefile,v 1.69 2017/06/29 21:14:54 sthen Exp $

COMMENT=	Berkeley Internet Name Daemon: DNS server and tools

V=		9.10.5-P3

DISTNAME=	bind-$V
PKGNAME=	isc-bind-${V:S/-P/pl/}

SHARED_LIBS +=	isc                  3.3      # 170.0
SHARED_LIBS +=	isccc                0.0      # 140.5
SHARED_LIBS +=	dns                  5.0      # 170.2
SHARED_LIBS +=	isccfg               0.4      # 144.0
SHARED_LIBS +=	bind9                0.1      # 140.12
SHARED_LIBS +=	lwres                0.1      # 141.3
SHARED_LIBS +=	irs                  0.0      # 141.5

# not installed:
#SHARED_LIBS +=	isc-nosymtbl         148.2    # 170.0
#SHARED_LIBS +=	t_api                0.0      # unknown

CATEGORIES=	net

HOMEPAGE=	http://www.isc.org/software/bind

MAINTAINER=	Stuart Henderson <sthen@@openbsd.org>

# ISC
PERMIT_PACKAGE_CDROM=	Yes

WANTLIB=	c iconv json-c lzma m pthread xml2 z

MASTER_SITES=	${MASTER_SITE_ISC:=bind9/$V/}

MODULES=	lang/python
# used for dnssec-checkds/dnssec-coverage, but don't want to force the run dep.
# XXX subpackage?
MODPY_RUNDEP=	No
LIB_DEPENDS=	converters/libiconv \
		devel/json-c \
		textproc/libxml

SEPARATE_BUILD=	Yes
CONFIGURE_STYLE= gnu
CONFIGURE_ARGS=	--enable-filter-aaaa \
		--enable-threads \
		--with-libtool \
		--without-readline \
		--with-python=${MODPY_BIN}

CONFIGURE_ENV=	STD_CDEFINES="-DDIG_SIGCHASE=1"

FAKE_FLAGS=	sysconfdir=${PREFIX}/share/examples/bind9

FLAVORS=	geoip no_ssl
FLAVOR?=
.if ${FLAVOR:Mgeoip}
CONFIGURE_ARGS+= --with-geoip
LIB_DEPENDS+=	net/GeoIP
WANTLIB+=	GeoIP
.endif

.if ${FLAVOR:Mno_ssl}
CONFIGURE_ARGS+= --without-openssl
.else
WANTLIB+=	crypto
.endif

# not strictly speaking interactive, but it configures temporary addresses on
# lo0 as root, so let's try and avoid running it unintentionally
TEST_IS_INTERACTIVE= Yes

pre-test:
	cd ${WRKSRC}/bin/tests/system && ${SUDO} ./ifconfig.sh up

post-test:
	cd ${WRKSRC}/bin/tests/system && ${SUDO} ./ifconfig.sh down

post-install:
	cd ${FILESDIR}; ${INSTALL_DATA} localhost loopback loopback6.arpa \
	    named.conf root.hint ${PREFIX}/share/examples/bind9/

.include <bsd.port.mk>
@


1.69
log
@Update to BIND 9.10.5-P2

An error in TSIG handling could permit unauthorized zone transfers
or zone updates. CVE-2017-3142, CVE-2017-3143.

Also updates the address of b.root in hints.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.68 2017/06/15 09:01:49 sthen Exp $
d5 1
a5 1
V=		9.10.5-P2
@


1.68
log
@update to BIND 9.10.5-P1

* With certain RPZ configurations, a response with TTL 0 could cause
named to go into an infinite query loop. This flaw is disclosed in
CVE-2017-3140. [RT #45181]

A server is potentially vulnerable to degradation of service if
1. the server is configured to use RPZ,
2. the server uses NSDNAME or NSIP policy rules, and
3. an attacker can cause the server to process a specific query
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.67 2017/05/03 20:20:42 sthen Exp $
d5 1
a5 1
V=		9.10.5-P1
@


1.67
log
@update to BIND 9.10.5
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.66 2017/04/13 10:35:33 sthen Exp $
d5 1
a5 1
V=		9.10.5
@


1.66
log
@update to BIND 9.10.4-P8 (-P7 was withdrawn)

CVE-2017-3136: An error handling synthesized records could cause an
assertion failure when using DNS64 with "break-dnssec yes;"

CVE-2017-3137: A response packet can cause a resolver to terminate when
processing an answer containing a CNAME or DNAME

CVE-2017-3138: named exits with a REQUIRE assertion failure if it receives
a null command string on its control channel
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.65 2017/02/09 00:04:40 sthen Exp $
d5 1
a5 1
V=		9.10.4-P8
d10 5
a14 5
SHARED_LIBS +=	isc                  3.2      # 161.1
SHARED_LIBS +=	isccc                0.0      # 140.4
SHARED_LIBS +=	dns                  4.4      # 164.3
SHARED_LIBS +=	isccfg               0.4      # 143.1
SHARED_LIBS +=	bind9                0.1      # 140.11
d16 1
a16 1
SHARED_LIBS +=	irs                  0.0      # 141.4
d19 1
a19 1
#SHARED_LIBS +=	isc-nosymtbl         148.2    # 148.2
d37 1
@


1.65
log
@update to BIND 9.10.4-P6

* If a server is configured with a response policy zone (RPZ) that
rewrites an answer with local data, and is also configured for DNS64
address mapping, a NULL pointer can be read triggering a server crash.
This flaw is disclosed in CVE-2017-3135. [RT #44434]

* A synthesized CNAME record appearing in a response before the associated
DNAME could be cached, when it should not have been. This was a
regression introduced while addressing CVE-2016-8864. [RT #44318]
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.64 2017/01/24 11:46:35 sthen Exp $
d5 1
a5 1
V=		9.10.4-P6
@


1.65.2.1
log
@MFC update to BIND 9.10.4-P8 (-P7 was withdrawn)

CVE-2017-3136: An error handling synthesized records could cause an
assertion failure when using DNS64 with "break-dnssec yes;"

CVE-2017-3137: A response packet can cause a resolver to terminate when
processing an answer containing a CNAME or DNAME

CVE-2017-3138: named exits with a REQUIRE assertion failure if it receives
a null command string on its control channel
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.66 2017/04/13 10:35:33 sthen Exp $
d5 1
a5 1
V=		9.10.4-P8
@


1.65.2.2
log
@update to BIND 9.10.5-P1

* With certain RPZ configurations, a response with TTL 0 could cause
named to go into an infinite query loop. This flaw is disclosed in
CVE-2017-3140. [RT #45181]

A server is potentially vulnerable to degradation of service if
1. the server is configured to use RPZ,
2. the server uses NSDNAME or NSIP policy rules, and
3. an attacker can cause the server to process a specific query
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.68 2017/06/15 09:01:49 sthen Exp $
d5 1
a5 1
V=		9.10.5-P1
d10 5
a14 5
SHARED_LIBS +=	isc                  3.3      # 170.0
SHARED_LIBS +=	isccc                0.0      # 140.5
SHARED_LIBS +=	dns                  5.0      # 170.2
SHARED_LIBS +=	isccfg               0.4      # 144.0
SHARED_LIBS +=	bind9                0.1      # 140.12
d16 1
a16 1
SHARED_LIBS +=	irs                  0.0      # 141.5
d19 1
a19 1
#SHARED_LIBS +=	isc-nosymtbl         148.2    # 170.0
a36 1
# XXX subpackage?
@


1.65.2.3
log
@Update to BIND 9.10.5-P2

An error in TSIG handling could permit unauthorized zone transfers
or zone updates. CVE-2017-3142, CVE-2017-3143.

Also updates the address of b.root in hints.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.69 2017/06/29 21:14:54 sthen Exp $
d5 1
a5 1
V=		9.10.5-P2
@


1.65.2.4
log
@update to BIND-9.10.5-P3

9.10.5-P2 broke verification of TSIG signed TCP message sequences where
not all the messages contain TSIG records. These may be used in AXFR and
IXFR responses. [RT #45509]
@
text
@d5 1
a5 1
V=		9.10.5-P3
@


1.64
log
@add pledges for dig/host/nslookup in the ports version of BIND. initial
pledge is "stdio rpath inet unix dns", dropping to "stdio inet dns"
after argument parsing.

access to resolv.conf is required late; the dns pledge is used for this
rather than requiring full rpath; however contrary to the version in
base, inet is allowed as well, so that it can be used as a debug tool
for servers on alternate ports.

works fine for me; no feedback after posting yet so committing to get
real-world testing. please report any issues.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.63 2017/01/12 12:22:20 sthen Exp $
d5 1
a5 2
V=		9.10.4-P5
REVISION=	0
@


1.63
log
@SECURITY update to BIND 9.10.4-P5

Named could mishandle authority sections that were missing RRSIGs triggering
an assertion failure.  CVE-2016-9444

Named mishandled some responses where covering RRSIG records are returned
without the requested data resulting in a assertion failure.  CVE-2016-9147

Named incorrectly tried to cache TKEY records which could trigger an
assertion failure when there was a class mismatch.  CVE-2016-9131
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62 2016/11/01 21:02:03 sthen Exp $
d6 2
@


1.62
log
@update to BIND 9.10.4-P1, fixing a resolver DoS in DNAME handling. CVE-2016-8864
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.61 2016/09/27 19:49:10 sthen Exp $
d5 1
a5 1
V=		9.10.4-P4
@


1.61
log
@update to BIND 9.10.4-P3, fixing
https://kb.isc.org/article/AA-01393/74/CVE-2016-2775 (lwres only)
https://kb.isc.org/article/AA-01419/74/CVE-2016-2776 ("all servers if
they can receive request packets from any source")
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.60 2016/09/13 16:12:14 naddy Exp $
d5 1
a5 1
V=		9.10.4-P3
@


1.60
log
@replace libiconv module
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59 2016/07/19 10:46:15 sthen Exp $
d5 1
a5 1
V=		9.10.4-P2
@


1.59
log
@Update to BIND 9.10.4-P2, fixes CVE-2016-2775 ("getrrsetbyname with a non
absolute name could trigger an infinite recursion bug in lwres[..]"; affects
users of lwresd and users with "lwres" enabled in their configuration).
Also has a couple of regression fixes. OK naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2016/05/26 09:25:25 sthen Exp $
d30 1
a30 1
WANTLIB=	c json-c lzma m pthread xml2 z
d34 1
a34 2
MODULES=	converters/libiconv \
		lang/python
d37 2
a38 1
LIB_DEPENDS=	devel/json-c \
@


1.59.2.1
log
@-stable update to BIND 9.10.4-P3, fixing
https://kb.isc.org/article/AA-01393/74/CVE-2016-2775 (lwres only)
https://kb.isc.org/article/AA-01419/74/CVE-2016-2776 ("all servers if
they can receive request packets from any source")
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59 2016/07/19 10:46:15 sthen Exp $
d5 1
a5 1
V=		9.10.4-P3
@


1.59.2.2
log
@update to BIND 9.10.4-P1, fixing a resolver DoS in DNAME handling. CVE-2016-8864
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59.2.1 2016/09/27 19:49:58 sthen Exp $
d5 1
a5 1
V=		9.10.4-P4
@


1.59.2.3
log
@MFC: SECURITY update to BIND 9.10.4-P5

Named could mishandle authority sections that were missing RRSIGs triggering
an assertion failure.  CVE-2016-9444

Named mishandled some responses where covering RRSIG records are returned
without the requested data resulting in a assertion failure.  CVE-2016-9147

Named incorrectly tried to cache TKEY records which could trigger an
assertion failure when there was a class mismatch.  CVE-2016-9131
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.63 2017/01/12 12:22:20 sthen Exp $
d5 1
a5 1
V=		9.10.4-P5
d30 1
a30 1
WANTLIB=	c iconv json-c lzma m pthread xml2 z
d34 2
a35 1
MODULES=	lang/python
d38 1
a38 2
LIB_DEPENDS=	converters/libiconv \
		devel/json-c \
@


1.59.2.4
log
@update to BIND 9.10.4-P6

* If a server is configured with a response policy zone (RPZ) that
rewrites an answer with local data, and is also configured for DNS64
address mapping, a NULL pointer can be read triggering a server crash.
This flaw is disclosed in CVE-2017-3135. [RT #44434]

* A synthesized CNAME record appearing in a response before the associated
DNAME could be cached, when it should not have been. This was a
regression introduced while addressing CVE-2016-8864. [RT #44318]
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.65 2017/02/09 00:04:40 sthen Exp $
d5 1
a5 2
V=		9.10.4-P6

@


1.58
log
@update to BIND 9.10.4-P1, fixing a problem where adjacent bitfields
were protected by different locks.

See http://fanf.livejournal.com/144615.html for an informative write-up
on the issue: "Even the Deathstation 9000 can't screw up the BIND 9.10.4
fix".
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.57 2016/04/29 11:01:02 sthen Exp $
d5 1
a5 1
V=		9.10.4-P1
@


1.57
log
@update to bind-9.10.4
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2016/03/11 20:28:28 naddy Exp $
d5 1
a5 1
V=		9.10.4
@


1.56
log
@garbage collect CONFIGURE_SHARED
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55 2016/03/10 00:03:34 sthen Exp $
d5 1
a5 1
V=		9.10.3-P4
d9 5
a13 5
SHARED_LIBS +=	isc                  3.1      # 160.0
SHARED_LIBS +=	isccc                0.0      # 140.3
SHARED_LIBS +=	dns                  4.3      # 162.0
SHARED_LIBS +=	isccfg               0.4      # 143.0
SHARED_LIBS +=	bind9                0.1      # 140.10
d42 1
a42 2
CONFIGURE_STYLE= autoconf
AUTOCONF_VERSION= 2.69
@


1.55
log
@update to BIND 9.10.3-P4, fixes crashes (assertion failures), one present
since 9.0.0.  CVE-2016-1285 CVE-2016-1286 CVE-2016-2088
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.54 2016/03/01 00:07:17 sthen Exp $
d44 1
a44 2
CONFIGURE_ARGS=	${CONFIGURE_SHARED} \
		--enable-filter-aaaa \
@


1.54
log
@bump (GeoIP pkgpath change)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2016/01/19 22:24:05 sthen Exp $
d5 1
a5 2
V=		9.10.3-P3
REVISION=	0
@


1.53
log
@update to BIND 9.10.3P3

- Fixed a regression in resolver.c:possibly_mark() which caused
known-bogus servers to be queried anyway. [RT #41321]

- render_ecs errors were mishandled when printing out a OPT record
resulting in a assertion failure. (CVE-2015-8705) [RT #41397]

- Specific APL data could trigger a INSIST. (CVE-2015-8704) [RT #41396]
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.52 2015/12/17 17:07:41 sthen Exp $
d6 1
@


1.53.2.1
log
@Update to BIND 9.10.4-P2, fixes CVE-2016-2775 ("getrrsetbyname with a non
absolute name could trigger an infinite recursion bug in lwres[..]"; affects
users of lwresd and users with "lwres" enabled in their configuration).

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2016/01/19 22:24:05 sthen Exp $
d5 1
a5 1
V=		9.10.4-P2
d9 7
a15 7
SHARED_LIBS +=  isc                  3.2      # 161.1
SHARED_LIBS +=  isccc                0.0      # 140.4
SHARED_LIBS +=  dns                  4.4      # 164.3
SHARED_LIBS +=  isccfg               0.4      # 143.1
SHARED_LIBS +=  bind9                0.1      # 140.11
SHARED_LIBS +=  lwres                0.1      # 141.3
SHARED_LIBS +=  irs                  0.0      # 141.4
d18 2
a19 2
#SHARED_LIBS += isc-nosymtbl         148.2    # 148.2
#SHARED_LIBS += t_api                0.0      # unknown
@


1.52
log
@bump isc-bind REVISION to avoid warnings with updates (different deps
between 5.8-stable and -current)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 2015/12/15 22:43:37 sthen Exp $
d5 1
a5 2
V=		9.10.3-P2
REVISION=	0
@


1.51
log
@update to bind-9.10.3-P2

4260.   [security]      Insufficient testing when parsing a message allowed
                        records with an incorrect class to be be accepted,
                        triggering a REQUIRE failure when those records
                        were subsequently cached. (CVE-2015-8000) [RT #40987]

4253.   [security]      Address fetch context reference count handling error
                        on socket error. (CVE-2015-8461) [RT#40945]
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2015/10/07 19:36:50 sthen Exp $
d6 1
@


1.50
log
@oops, forgot to re-add json-c to WANTLIB/LIB_DEPENDS in previous commit.
spotted by nigel@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2015/10/03 19:44:51 sthen Exp $
d5 1
a5 2
V=		9.10.3
REVISION=	2
@


1.49
log
@reenable json stats in BIND, there used to be a problem with build on arch
without sync_val_compare_and_swap_4 but this was worked around in json-c.
reminded by jca.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2015/09/25 14:02:31 sthen Exp $
d6 1
a6 1
REVISION=	1
d31 1
a31 1
WANTLIB=	c lzma m pthread xml2 z
d39 2
a40 1
LIB_DEPENDS=	textproc/libxml
@


1.48
log
@build dig with SIGCHASE support
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2015/09/16 15:28:16 sthen Exp $
d6 1
a6 1
REVISION=	0
d10 1
a10 1
SHARED_LIBS +=	isc                  3.0      # 160.0
d12 1
a12 1
SHARED_LIBS +=	dns                  4.2      # 162.0
a51 4

# JSON stats support is built if json-c is found at build time; however this
# breaks on hppa and mips64, so it's forcibly disabled at this time.
CONFIGURE_ARGS+= --without-libjson
@


1.47
log
@update to BIND 9.10.3. add a bunch of patches because they now support
OpenSSL 1.1 api (OPENSSL_VERSION_NUMBER < / >= 0x10100000L checks).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2015/09/02 20:25:43 sthen Exp $
d6 1
d50 2
@


1.46
log
@SECURITY update to bind-9.10.2-P4: CVE-2015-5722, CVE-2015-5986
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2015/08/24 20:46:49 sthen Exp $
d5 1
a5 1
V=		9.10.2-P4
d9 7
a15 7
SHARED_LIBS +=	isc                  2.1      # 148.2
SHARED_LIBS +=	isccc                0.0      # 140.1
SHARED_LIBS +=	dns                  4.1      # 161.2
SHARED_LIBS +=	isccfg               0.3      # 142.4
SHARED_LIBS +=	bind9                0.1      # 140.9
SHARED_LIBS +=	lwres                0.1      # 141.2
SHARED_LIBS +=	irs                  0.0      # 141.2
d47 1
@


1.45
log
@Add a no_ssl flavour to BIND.
Expand the comment about json-c as that's broken on mips64 as well as hppa.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2015/07/28 20:03:35 sthen Exp $
d5 1
a5 2
V=		9.10.2-P3
REVISION=	0
@


1.44
log
@Security update to BIND 9.10.2p3 - a failure to reset a value to NULL in tkey.c
could result in an assertion failure. (CVE-2015-5477)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2015/07/15 06:43:31 sthen Exp $
d6 1
d31 1
a31 1
WANTLIB=	c crypto lzma m pthread xml2 z
d51 1
a51 1
# breaks on hppa, so it's forcibly disabled at this time.
d56 1
a56 1
FLAVORS=	geoip
d62 6
@


1.44.4.1
log
@SECURITY update to bind-9.10.2-P4: CVE-2015-5722, CVE-2015-5986
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2015/07/28 20:03:35 sthen Exp $
d5 1
a5 1
V=		9.10.2-P4
@


1.44.4.2
log
@MFC update to bind-9.10.3-P2

4260.   [security]      Insufficient testing when parsing a message allowed
                        records with an incorrect class to be be accepted,
                        triggering a REQUIRE failure when those records
                        were subsequently cached. (CVE-2015-8000) [RT #40987]

4253.   [security]      Address fetch context reference count handling error
                        on socket error. (CVE-2015-8461) [RT#40945]
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2015/10/07 19:36:50 sthen Exp $
d5 1
a5 1
V=		9.10.3-P2
d9 7
a15 7
SHARED_LIBS +=	isc                  3.1      # 160.0
SHARED_LIBS +=	isccc                0.0      # 140.3
SHARED_LIBS +=	dns                  4.3      # 162.0
SHARED_LIBS +=	isccfg               0.4      # 143.0
SHARED_LIBS +=	bind9                0.1      # 140.10
SHARED_LIBS +=	lwres                0.1      # 141.3
SHARED_LIBS +=	irs                  0.0      # 141.4
a46 1
		--without-readline \
a51 1
CONFIGURE_ENV=	STD_CDEFINES="-DDIG_SIGCHASE=1"
@


1.44.4.3
log
@- security update to BIND 9.10.3P3
https://kb.isc.org/article/AA-01346/0/BIND-9.10.3-P3-Release-Notes.html
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44.4.2 2015/12/17 17:06:39 sthen Exp $
d5 1
a5 1
V=		9.10.3-P3
@


1.44.4.4
log
@update to BIND 9.10.3-P4
https://kb.isc.org/article/AA-01363/81/BIND-9.10.3-P4-Release-Notes.html
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44.4.3 2016/01/22 14:54:09 jasper Exp $
d5 1
a5 1
V=		9.10.3-P4
@


1.43
log
@Build BIND with --enable-filter-aaaa, no change by default, but this allows
use of the filter-aaaa-on-v4 config option. Req'd by Marcus Andree.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2015/07/07 19:32:47 sthen Exp $
d5 1
a5 1
V=		9.10.2-P2
a6 1
REVISION=	0
d11 1
a11 1
SHARED_LIBS +=	dns                  4.1      # 160.1
@


1.42
log
@update to BIND 9.10.2-P2, fixes CVE-2015-4620 - querying a malicious zone can
trigger a "REQUIRE" assertion failure in the resolver if DNSSEC validation
is enabled.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2015/06/10 22:40:41 sthen Exp $
d7 1
d45 1
@


1.41
log
@SECURITY update to BIND 9.10.2-P1, various problems with RPZ (policy zones),
and a possible crash with async zone loads. https://kb.isc.org/article/AA-01266

    "If you are using RPZ in BIND 9.10 in a production environment, and
    particularly if you have multiple policy zones, you should upgrade to
    BIND 9.10.2-P1. Otherwise, this upgrade is not urgent."
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2015/05/16 10:15:53 kettenis Exp $
d5 1
a5 1
V=		9.10.2-P1
@


1.40
log
@Use $CC to link shared library to make sure crtbeginS.o gets linked in.
Switches CONFIGURE_STYLE to autoconf to make sure configure gets regenerated.

ok (and help from) sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2015/03/14 22:26:21 sthen Exp $
d5 1
a5 2
V=		9.10.2
REVISION=	1
@


1.39
log
@take MAINTAINER
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2015/03/14 21:01:54 sthen Exp $
d6 1
a6 1
REVISION=	0
d42 2
a43 1
CONFIGURE_STYLE= gnu
@


1.38
log
@update to BIND 9.10.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2015/02/18 22:49:44 sthen Exp $
d6 1
d25 2
@


1.37
log
@update to BIND 9.10.2P2

   On servers configured to perform DNSSEC validation using managed
   trust anchors (i.e., keys configured explicitly via managed-keys, or
   implicitly via dnssec-validation auto; or dnssec-lookaside auto;),
   revoking a trust anchor and sending a new untrusted replacement could
   cause named to crash with an assertion failure.  This could occur in
   the event of a botched key rollover, or potentially as a result of a
   deliberate attack if the attacker was in position to monitor the
   victim's DNS traffic.  This flaw was discovered by Jan-Piet Mens, and
   is disclosed in [CVE-2015-1349] [RT #38344] (**)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2015/01/30 15:15:42 sthen Exp $
d5 1
a5 1
V=		9.10.1-P2
d9 1
a9 1
SHARED_LIBS +=	isc                  2.0      # 146.0
d11 4
a14 4
SHARED_LIBS +=	dns                  4.0      # 147.0
SHARED_LIBS +=	isccfg               0.3      # 142.3
SHARED_LIBS +=	bind9                0.1      # 140.7
SHARED_LIBS +=	lwres                0.1      # 141.0
d18 1
a18 1
#SHARED_LIBS +=	isc-nosymtbl         0.0      # 146.0
@


1.37.2.1
log
@MFC: SECURITY update to BIND 9.10.2-P1, various problems with RPZ (policy zones),
and a possible crash with async zone loads. https://kb.isc.org/article/AA-01266

"If you are using RPZ in BIND 9.10 in a production environment, and
particularly if you have multiple policy zones, you should upgrade to
BIND 9.10.2-P1. Otherwise, this upgrade is not urgent."
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2015/06/10 22:40:41 sthen Exp $
d5 1
a5 1
V=		9.10.2-P1
d9 1
a9 1
SHARED_LIBS +=	isc                  2.1      # 148.2
d11 4
a14 4
SHARED_LIBS +=	dns                  4.1      # 160.1
SHARED_LIBS +=	isccfg               0.3      # 142.4
SHARED_LIBS +=	bind9                0.1      # 140.9
SHARED_LIBS +=	lwres                0.1      # 141.2
d18 1
a18 1
#SHARED_LIBS +=	isc-nosymtbl         148.2    # 148.2
a24 2
MAINTAINER=	Stuart Henderson <sthen@@openbsd.org>

d39 1
a39 2
CONFIGURE_STYLE= autoconf
AUTOCONF_VERSION= 2.69
@


1.37.2.2
log
@MFC update to BIND 9.10.2-P2, fixes CVE-2015-4620 - querying a malicious zone
can trigger a "REQUIRE" assertion failure in the resolver if DNSSEC validation
is enabled.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2015/07/07 19:32:47 sthen Exp $
d5 1
a5 1
V=		9.10.2-P2
@


1.37.2.3
log
@Security update to BIND 9.10.2p3 - a failure to reset a value to NULL in tkey.c
could result in an assertion failure. (CVE-2015-5477)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2015/07/28 20:03:35 sthen Exp $
d5 1
a5 1
V=		9.10.2-P3
d11 1
a11 1
SHARED_LIBS +=	dns                  4.1      # 161.2
a43 1
		--enable-filter-aaaa \
@


1.37.2.4
log
@SECURITY update to bind-9.10.2-P4: CVE-2015-5722, CVE-2015-5986
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37.2.3 2015/07/28 20:04:17 sthen Exp $
d5 1
a5 1
V=		9.10.2-P4
@


1.36
log
@previous change ("Disable json stats in bind") resulted in losing a couple
of symbols from libdns; bump SHARED_LIBS version and REVISION.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2015/01/15 22:34:02 sthen Exp $
d5 1
a5 2
V=		9.10.1-P1
REVISION=	2
d45 1
a45 1
# JSON stats support is build if json-c is found at build time; however this
@


1.35
log
@Disable json stats in bind and zap BROKEN-hppa.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2015/01/15 18:10:38 landry Exp $
d6 1
a6 1
REVISION=	1
d12 1
a12 1
SHARED_LIBS +=	dns                  3.0      # 147.0
@


1.34
log
@BROKEN-hppa =   uses json-c which requires atomic ops
@
text
@d1 1
a1 5
# $OpenBSD: Makefile,v 1.33 2014/12/17 23:39:17 sthen Exp $

# XXX should we rename the rc script to either named.rc or isc_bind.rc ?
# XXX how about also the package now we don't need to distinguish from the
# XXX version in base?
a3 1
BROKEN-hppa =	uses json-c which requires atomic ops
d6 1
a6 1
REVISION=	0
d29 1
a29 1
WANTLIB=	c crypto json-c lzma m pthread xml2 z
d37 1
a37 2
LIB_DEPENDS=	devel/json-c \
		textproc/libxml
a41 1
		--enable-newstats \
d45 4
@


1.33
log
@Revert previous BIND workaround for query failures when coming up cold.
Instead, cherrypick a fix from git at source.isc.org; this exempts TLD and
root zone lookups from max-recursion-queries and changes the default to 75.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2014/12/09 17:21:36 sthen Exp $
d8 1
@


1.32
log
@Update to BIND 9.10.1-P1, including query limits for recursion (DoS avoidance,
CVE-2014-8500), assertion DoS (recursive only, only with prefetch enabled,
CVE-2014-3214), assertion DoS (EDNS option processing, CVE-2014-3859) and
fixes to GeoIP (CVE-2014-8680 and another unclassified).

https://kb.isc.org/article/AA-01223/81/BIND-9.10.1-P1-Release-Notes.html

Add a local patch to increase the default query limit, during testing it
appears that the standard defaults can be easily falsely triggered during
priming at startup.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2014/09/23 09:42:41 sthen Exp $
d10 1
@


1.31
log
@update to BIND 9.10.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2014/08/22 20:56:00 sthen Exp $
d9 1
a9 1
V=		9.10.1
d13 1
a13 1
SHARED_LIBS +=	isc                  1.1      # 145.0
d15 3
a17 3
SHARED_LIBS +=	dns                  2.0      # 146.2
SHARED_LIBS +=	isccfg               0.2      # 142.2
SHARED_LIBS +=	bind9                0.0      # 140.6
d22 1
a22 1
#SHARED_LIBS +=	isc-nosymtbl         0.0      # 145.0
d32 1
a32 1
WANTLIB=	c crypto json-c m pthread xml2 z
@


1.30
log
@add comment (notes for possible renamings, things are a tad inconsistent at present)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2014/08/22 20:32:13 sthen Exp $
d9 1
a9 2
V=		9.10.0-P2
REVISION=	0
d13 1
a13 1
SHARED_LIBS +=	isc                  1.0      # 143.1
d15 5
a19 5
SHARED_LIBS +=	dns                  1.0      # 144.1
SHARED_LIBS +=	isccfg               0.2      # 142.0
SHARED_LIBS +=	bind9                0.0      # 140.4
SHARED_LIBS +=	lwres                0.0      # 140.1
SHARED_LIBS +=	irs                  0.0      # 141.1
d22 1
a22 1
#SHARED_LIBS +=	isc-nosymtbl         0.0      # 143.1
d32 1
a32 1
WANTLIB=	c crypto m pthread xml2 z
d40 2
a41 1
LIB_DEPENDS=	textproc/libxml
@


1.29
log
@install sample configs and switch to running as _bind uid
@
text
@d1 5
a5 1
# $OpenBSD: Makefile,v 1.28 2014/06/11 22:44:05 sthen Exp $
@


1.28
log
@Update to BIND 9.10.0-P2, fixes CVE-2014-3859 "A query specially crafted to
exploit a defect in EDNS option processing can cause named to terminate with
an assertion failure. This fixes a missing isc_buffer_availablelength check
when printing out a packet." (This doesn't affect 9.9.x in 5.5-stable).

A few other fixes most of which don't affect us (one notable one is a
fix for GCC 4.9.0 optimizing away a null pointer check, more info on this
at https://kb.isc.org/article/AA-01167/)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2014/05/08 22:14:56 sthen Exp $
d6 1
d66 4
@


1.28.2.1
log
@MFC BIND update:

Update to BIND 9.10.1-P1, including query limits for recursion (DoS avoidance,
CVE-2014-8500), assertion DoS (recursive only, only with prefetch enabled,
CVE-2014-3214), assertion DoS (EDNS option processing, CVE-2014-3859) and
fixes to GeoIP (CVE-2014-8680 and another unclassified).

https://kb.isc.org/article/AA-01223/81/BIND-9.10.1-P1-Release-Notes.html

Add a local patch to increase the default query limit, during testing it
appears that the standard defaults can be easily falsely triggered during
priming at startup.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2014/12/09 17:21:36 sthen Exp $
d5 1
a5 1
V=		9.10.1-P1
d9 1
a9 1
SHARED_LIBS +=	isc                  2.0      # 146.0
d11 5
a15 5
SHARED_LIBS +=	dns                  3.0      # 147.0
SHARED_LIBS +=	isccfg               0.3      # 142.3
SHARED_LIBS +=	bind9                0.1      # 140.7
SHARED_LIBS +=	lwres                0.1      # 141.0
SHARED_LIBS +=	irs                  0.0      # 141.2
d18 1
a18 1
#SHARED_LIBS +=	isc-nosymtbl         0.0      # 146.0
d28 1
a28 1
WANTLIB=	c crypto json-c m pthread xml2 z
d36 1
a36 2
LIB_DEPENDS=	devel/json-c \
		textproc/libxml
@


1.28.2.2
log
@Update to BIND 9.10.1P2

   On servers configured to perform DNSSEC validation using managed
   trust anchors (i.e., keys configured explicitly via managed-keys, or
   implicitly via dnssec-validation auto; or dnssec-lookaside auto;),
   revoking a trust anchor and sending a new untrusted replacement could
   cause named to crash with an assertion failure.  This could occur in
   the event of a botched key rollover, or potentially as a result of a
   deliberate attack if the attacker was in position to monitor the
   victim's DNS traffic.  This flaw was discovered by Jan-Piet Mens, and
   is disclosed in [CVE-2015-1349] [RT #38344] (**)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28.2.1 2014/12/09 17:54:11 sthen Exp $
d5 1
a5 1
V=		9.10.1-P2
@


1.28.2.3
log
@Apply BIND security update to OPENBSD_5_6 as well

Security update to BIND 9.10.2p3 - a failure to reset a value to NULL in tkey.c
could result in an assertion failure. (CVE-2015-5477)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28.2.2 2015/02/18 22:51:18 sthen Exp $
d5 1
a5 1
V=		9.10.2-P3
d9 7
a15 7
SHARED_LIBS +=  isc                  2.1      # 148.2
SHARED_LIBS +=  isccc                0.0      # 140.1
SHARED_LIBS +=  dns                  4.1      # 161.2
SHARED_LIBS +=  isccfg               0.3      # 142.4
SHARED_LIBS +=  bind9                0.1      # 140.9
SHARED_LIBS +=  lwres                0.1      # 141.2
SHARED_LIBS +=  irs                  0.0      # 141.2
@


1.27
log
@fix a remote-triggerable assertion crash in pre-fetch in the recursor,
introduced in BIND 9.10.0 (we only updated to this recently so no -stable
impact).  workaround "prefetch 0;".  CVE-2014-3214
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2014/05/01 20:19:25 sthen Exp $
d5 1
a5 1
V=		9.10.0-P1
@


1.26
log
@update to BIND 9.10.0 and add a flavour for the new geolocation support
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2014/04/15 08:53:04 ajacoutot Exp $
d5 1
a5 1
V=		9.10.0
@


1.25
log
@No need to explicitely SUBST_VARS LOCALSTATEDIR anymore.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2014/01/31 10:14:46 sthen Exp $
d5 1
a5 1
V=		9.9.5
d9 11
a19 6
SHARED_LIBS +=	bind9                0.0      # 90.9
SHARED_LIBS +=	dns                  0.1      # 102.2
SHARED_LIBS +=	isc                  0.2      # 100.0
SHARED_LIBS +=	isccc                0.0      # 90.6
SHARED_LIBS +=	isccfg               0.1      # 91.0
SHARED_LIBS +=	lwres                0.0      # 90.7
d47 8
@


1.24
log
@sync upstream lib versions in comments in SHARED_LIBS lines; no pkg change
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2014/01/31 10:12:57 sthen Exp $
a31 1
SUBST_VARS=	LOCALSTATEDIR
@


1.23
log
@update to BIND 9.9.5
- patch to add another missing stdint.h inclusion for uintptr_t
- enable regression tests (these set temporary aliases on lo0;
should be safe, but I've set TEST_INTERACTIVE to avoid any unintended
consequences on bulk test runs).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2014/01/13 17:13:11 sthen Exp $
d9 6
a14 6
SHARED_LIBS +=  bind9                     0.0 # 90.8
SHARED_LIBS +=  dns                       0.1 # 101.1
SHARED_LIBS +=  isc                       0.2 # 97.1
SHARED_LIBS +=  isccc                     0.0 # 90.4
SHARED_LIBS +=  isccfg                    0.1 # 90.7
SHARED_LIBS +=  lwres                     0.0 # 90.5
@


1.22
log
@Update to BIND 9.9.4-P2, CVE-2014-0591 - an assertion can be triggered by
a crafted query against an NSEC3-signed zone, causing the server to exit.
Affects authoritative nameservers serving at least one NSEC3-signed zone.
Does not affect recursive-only servers, or auth servers which do not serve
NSEC3-signed zones.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2013/11/06 20:37:11 sthen Exp $
d5 1
a5 1
V=		9.9.4-P2
d10 2
a11 2
SHARED_LIBS +=  dns                       0.0 # 101.1
SHARED_LIBS +=  isc                       0.1 # 97.1
d13 1
a13 1
SHARED_LIBS +=  isccfg                    0.0 # 90.7
d43 10
@


1.21
log
@Update to BIND 9.9.4-PL1 - treat an all-zero netmask as invalid when
generating the localnets acl.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2013/09/19 23:33:11 sthen Exp $
d5 1
a5 1
V=		9.9.4-P1
@


1.20
log
@update to BIND 9.9.4 - this release rolls in the RRL patches (ratelimit
flavour) to the main release, so pkgpath/conflict markers are set so that
updates are handled correctly
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2013/08/06 20:09:00 sthen Exp $
d5 1
a5 1
V=		9.9.4
@


1.19
log
@RRL patches version naming scheme changed and
bump REVISION due to slightly changed patch file

with feedback from and ok sthen@@
@
text
@d5 1
a5 2
V=		9.9.3-P2
REVISION=	0
d9 6
a14 6
SHARED_LIBS +=  bind9                     0.0 # 60.4
SHARED_LIBS +=  dns                       0.0 # 70.2
SHARED_LIBS +=  isc                       0.0 # 63.1
SHARED_LIBS +=  isccc                     0.0 # 60.0
SHARED_LIBS +=  isccfg                    0.0 # 62.0
SHARED_LIBS +=  lwres                     0.0 # 60.1
a25 10
MASTER_SITES0=	http://ss.vix.su/~vjs/

FLAVORS=	ratelimit
FLAVOR?=

.if ${FLAVOR:Mratelimit}
PATCHFILES+=	rl-${V}.patch:0
.else
SUPDISTFILES+=	rl-${V}.patch:0
.endif
@


1.18
log
@SECURITY update to BIND 9.9.3p2. CVE-2013-4854: A specially crafted
query that includes malformed rdata can cause named to terminate with an
assertion failure while rejecting the malformed query. Authoritative and
recursive servers are equally vulnerable. Intentional exploitation of
this condition can cause a denial of service in all nameservers running
affected versions of BIND 9. Access Control Lists do not provide any
protection from malicious clients.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2013/06/05 00:32:18 sthen Exp $
d6 1
a6 1
RV=		9.9.3
d33 1
a33 1
PATCHFILES+=	rl-${RV}.patch:0
d35 1
a35 1
SUPDISTFILES+=	rl-${RV}.patch:0
@


1.17
log
@CVE-2013-3919 update to BIND 9.9.3-P1, recursive resolver can be crashed by
a query for a malformed zone. This was introduced in the recent 9.9.3 release.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2013/05/31 10:09:03 sthen Exp $
d5 1
a5 1
V=		9.9.3-P1
@


1.17.2.1
log
@Backport two security fixes (CVE-2013-4854 and CVE-2014-0591)

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2013/06/05 00:32:18 sthen Exp $
a8 1
REVISION=	0
@


1.16
log
@switch to upstream RRL patches now they're available.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2013/05/29 20:19:15 sthen Exp $
d5 1
a5 1
V=		9.9.3
@


1.15
log
@update to BIND 9.9.3
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2013/04/03 20:17:23 sthen Exp $
d6 1
a6 1
RV=		9.9.3rc1.unofficial
d27 1
a27 2
MASTER_SITES0=	http://spacehopper.org/mirrors/
#MASTER_SITES0=	http://ss.vix.su/~vjs/
@


1.14
log
@update to newer RRL patch (affects FLAVOR=ratelimit only)
@
text
@d3 1
a3 1
COMMENT=	Berkeley Internet Name Daemon
d5 2
a6 3
V=		9.9.2-P2
RV=		9.9.2-P2
REVISION=	1
d24 1
a24 1
WANTLIB += c crypto m pthread xml2 z
d27 2
a28 1
MASTER_SITES0=	http://ss.vix.su/~vjs/
d39 4
a42 1
MODULES=	converters/libiconv
d49 1
d51 2
a52 1
		--with-libtool
@


1.13
log
@Normally newer versions of BIND default to one UDP listener per interface
per CPU. As found by Marc Peters, this doesn't work too well on a t5120
with 64 threads, so change the default settings in the rc.d script to -U 4
to cap this to 4, or the number of CPUs if less.

As usual with rc.d scripts, if you need to override flags, set
isc_named_flags="..." in rc.conf.local.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2013/03/28 09:18:51 sthen Exp $
d6 2
a7 2
RV=		9.9.2
REVISION=	0
d28 1
a28 1
MASTER_SITES0=	http://ss.vix.com/~vixie/
@


1.12
log
@SECURITY update for ports/net/isc-bind (affects 9.7 and up), CVE-2013-2266

"A critical defect in BIND 9 allows an attacker to cause excessive memory
consumption in named or other programs linked to libdns.

The problem is encountered when a program compiled to link to libdns
receives a maliciously-constructed regular expression via any of several
delivery methods."

https://kb.isc.org/article/AA-0087
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2013/03/21 08:46:34 ajacoutot Exp $
d7 1
@


1.11
log
@USE_LIBTOOL=Yes is the default now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2013/03/11 11:35:48 espie Exp $
d5 1
a5 2
V=		9.9.2-P1
REVISION=	0
@


1.10
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2013/02/09 14:49:52 sthen Exp $
a43 1
USE_LIBTOOL=	Yes
@


1.9
log
@Don't use ${FLAVOR:L}, we only support lower-case flavours now.
OK ajacoutot@@ espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2013/01/04 13:34:51 sthen Exp $
a23 3
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM= Yes
PERMIT_DISTFILES_FTP=	Yes
@


1.9.2.1
log
@MFC - BIND 9.9.2-P2: CVE-2013-2266 https://kb.isc.org/article/AA-00871
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2013/04/13 12:41:01 sthen Exp $
d5 3
a7 3
V=		9.9.2-P2
RV=		9.9.2-P2
REVISION=	1
d31 1
a31 1
MASTER_SITES0=	http://ss.vix.su/~vjs/
@


1.8
log
@sync new address for D root
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2012/12/04 21:48:27 sthen Exp $
d36 1
a36 1
.if ${FLAVOR:L:Mratelimit}
@


1.7
log
@SECURITY update to BIND 9.9.2-P1

A specific query can cause BIND nameservers using DNS64 to exit
with a REQUIRE assertion failure.

BIND nameservers that are not using DNS64 are not at risk.
https://kb.isc.org/article/AA-00828  CVE-2012-5688
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2012/10/09 22:46:17 sthen Exp $
d6 1
@


1.6
log
@Update to BIND 9.9.1P4: CVE-2012-5166

If specific combinations of RDATA are loaded into a nameserver, either
via cache or an authoritative zone, a subsequent query for a related
record will cause named to lock up.

See https://kb.isc.org/article/AA-00801 for more details.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2012/09/12 17:21:52 sthen Exp $
d5 2
a6 2
V=		9.9.1-P4
RV=		9.9.1-P2
@


1.5
log
@SECURITY update to BIND 9.9.1-P3, fixes CVE-2012-4244
https://kb.isc.org/article/AA-00778

If a record with RDATA in excess of 65535 bytes is loaded into a
nameserver, a subsequent query for that record will cause named to exit
with an assertion failure.

This vulnerability can be exploited remotely against recursive servers
by inducing them to query for records provided by an authoritative
server. It affects authoritative servers if a zone containing this type
of resource record is loaded from file or provided via zone transfer.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2012/09/02 10:55:59 naddy Exp $
d5 1
a5 1
V=		9.9.1-P3
@


1.4
log
@bump after DESCR changed when ratelimit flavor was added
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2012/08/31 09:16:35 sthen Exp $
d5 2
a6 1
V=		9.9.1-P2
a8 1
REVISION=	0
d36 1
a36 1
PATCHFILES+=	rl-$V.patch:0
d38 1
a38 1
SUPDISTFILES+=	rl-$V.patch:0
@


1.3
log
@add "ratelimit" flavour to net/isc-bind to build it with the experimental DNS
response rate limiting (DNS RRL) patchset, http://www.redbarn.org/dns/ratelimits
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2012/08/07 07:44:27 sthen Exp $
d8 1
@


1.2
log
@Security update to BIND 9.9.1-P2, from Brad.

CVE-2012-3868: High TCP Query Load Can Trigger a Memory Leak
CVE-2012-3817: Heavy DNSSEC Validation Load Can Cause a "Bad Cache"
Assertion Failure
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2012/07/19 08:36:45 sthen Exp $
d29 10
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d5 1
a5 1
V=		9.9.1-P1
@


1.1.1.1
log
@import BIND 9.9.1-P1 as ports/net/isc-bind - this is newer than the
version of BIND than is in the base OS (some people require features
from this version e.g. DNS64), but note that it does not include
the hardening changes made to the version in base.

feedback from naddy@@ giovanni@@, ok giovanni@@.

"BIND is open source software that implements the Domain Name System
(DNS) protocols for the Internet. It is a reference implementation
of those protocols, but it is also production-grade software,
suitable for use in high-volume and high-reliability applications."
@
text
@@


1.1.1.1.2.1
log
@MFC req'd by jasper: SECURITY update to BIND 9.9.1-P3, fixes CVE-2012-4244
https://kb.isc.org/article/AA-00778

If a record with RDATA in excess of 65535 bytes is loaded into a
nameserver, a subsequent query for that record will cause named to exit
with an assertion failure.

This vulnerability can be exploited remotely against recursive servers
by inducing them to query for records provided by an authoritative
server. It affects authoritative servers if a zone containing this type
of resource record is loaded from file or provided via zone transfer.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2012/09/12 17:21:52 sthen Exp $
d5 1
a5 2
V=		9.9.1-P3
RV=		9.9.1-P2
a28 10
MASTER_SITES0=	http://ss.vix.com/~vixie/

FLAVORS=	ratelimit
FLAVOR?=

.if ${FLAVOR:L:Mratelimit}
PATCHFILES+=	rl-${RV}.patch:0
.else
SUPDISTFILES+=	rl-${RV}.patch:0
.endif
@


1.1.1.1.2.2
log
@MFC: Update to BIND 9.9.1P4: CVE-2012-5166

If specific combinations of RDATA are loaded into a nameserver, either
via cache or an authoritative zone, a subsequent query for a related
record will cause named to lock up.

See https://kb.isc.org/article/AA-00801 for more details.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2012/10/09 22:46:17 sthen Exp $
d5 1
a5 1
V=		9.9.1-P4
@


1.1.1.1.2.3
log
@MFC:  SECURITY update to BIND 9.9.2-P1

A specific query can cause BIND nameservers using DNS64 to exit
with a REQUIRE assertion failure.

BIND nameservers that are not using DNS64 are not at risk.
https://kb.isc.org/article/AA-00828  CVE-2012-5688
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2012/12/04 21:48:27 sthen Exp $
d5 2
a6 2
V=		9.9.2-P1
RV=		9.9.2
@


1.1.1.1.2.4
log
@5.2 SECURITY update for ports/net/isc-bind (affects 9.7 and up), CVE-2013-2266

"A critical defect in BIND 9 allows an attacker to cause excessive memory
consumption in named or other programs linked to libdns.

The problem is encountered when a program compiled to link to libdns
receives a maliciously-constructed regular expression via any of several
delivery methods."

https://kb.isc.org/article/AA-0087

(sync root server hints while there).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1.2.3 2012/12/04 21:49:22 sthen Exp $
d5 1
a5 1
V=		9.9.2-P2
@


