head	1.124;
access;
symbols
	OPENBSD_6_1:1.120.0.2
	OPENBSD_6_1_BASE:1.120
	OPENBSD_6_0:1.115.0.2
	OPENBSD_6_0_BASE:1.115
	OPENBSD_5_9:1.113.0.2
	OPENBSD_5_9_BASE:1.113
	OPENBSD_5_8:1.106.0.4
	OPENBSD_5_8_BASE:1.106
	OPENBSD_5_7:1.102.0.2
	OPENBSD_5_7_BASE:1.102
	OPENBSD_5_6:1.100.0.4
	OPENBSD_5_6_BASE:1.100
	OPENBSD_5_5:1.100.0.2
	OPENBSD_5_5_BASE:1.100
	OPENBSD_5_4:1.94.0.2
	OPENBSD_5_4_BASE:1.94
	OPENBSD_5_3:1.87.0.2
	OPENBSD_5_3_BASE:1.87
	OPENBSD_5_2:1.80.0.2
	OPENBSD_5_2_BASE:1.80
	OPENBSD_5_1_BASE:1.74
	OPENBSD_5_1:1.74.0.2
	OPENBSD_5_0:1.66.0.2
	OPENBSD_5_0_BASE:1.66
	OPENBSD_4_9:1.50.0.2
	OPENBSD_4_9_BASE:1.50
	OPENBSD_4_8:1.30.0.2
	OPENBSD_4_8_BASE:1.30
	OPENBSD_4_7:1.13.0.2
	OPENBSD_4_7_BASE:1.13
	OPENBSD_4_6:1.7.0.2
	OPENBSD_4_6_BASE:1.7
	ajacoutot_20090603:1.1.1.1
	ajacoutot:1.1.1;
locks; strict;
comment	@# @;


1.124
date	2017.07.13.07.36.39;	author ajacoutot;	state Exp;
branches;
next	1.123;
commitid	OWESGEgoCecMBlUK;

1.123
date	2017.05.30.18.53.37;	author ajacoutot;	state Exp;
branches;
next	1.122;
commitid	qayU2xZGXeWa491j;

1.122
date	2017.05.16.19.31.34;	author landry;	state Exp;
branches;
next	1.121;
commitid	5FFio2V8SKoecSnW;

1.121
date	2017.04.22.13.43.21;	author ajacoutot;	state Exp;
branches;
next	1.120;
commitid	Obqvqlta0q6jFX3r;

1.120
date	2016.11.11.07.56.23;	author ajacoutot;	state Exp;
branches;
next	1.119;
commitid	Ktkva4NrPy2YkC9a;

1.119
date	2016.11.11.07.40.02;	author ajacoutot;	state Exp;
branches;
next	1.118;
commitid	byChtLXTBCHnuRvR;

1.118
date	2016.11.10.16.54.02;	author ajacoutot;	state Exp;
branches;
next	1.117;
commitid	sANjgKecMxUpyUk1;

1.117
date	2016.09.12.15.28.30;	author jca;	state Exp;
branches;
next	1.116;
commitid	r4yrdkpkVLYaoBsQ;

1.116
date	2016.08.17.20.58.19;	author sthen;	state Exp;
branches;
next	1.115;
commitid	3YTVpXXidJQjfavt;

1.115
date	2016.04.04.22.57.45;	author naddy;	state Exp;
branches;
next	1.114;
commitid	FILF1LJRoZlYu0JV;

1.114
date	2016.03.11.20.28.28;	author naddy;	state Exp;
branches;
next	1.113;
commitid	UYLP8TE6V7RS2GhJ;

1.113
date	2015.12.06.08.29.35;	author ajacoutot;	state Exp;
branches;
next	1.112;
commitid	GoLwf2jrcVlXZbbh;

1.112
date	2015.10.24.09.18.13;	author ajacoutot;	state Exp;
branches;
next	1.111;
commitid	bVbBbScpUnHNNm9z;

1.111
date	2015.10.08.21.19.22;	author sthen;	state Exp;
branches;
next	1.110;
commitid	pVDZUjJm7yyuQSI1;

1.110
date	2015.09.18.19.35.04;	author jasper;	state Exp;
branches;
next	1.109;
commitid	KFkCPjLsaNfzSnD4;

1.109
date	2015.09.18.19.16.14;	author jasper;	state Exp;
branches;
next	1.108;
commitid	YfC6BYVZMKSoGSuL;

1.108
date	2015.08.27.06.48.30;	author ajacoutot;	state Exp;
branches;
next	1.107;
commitid	fg1RtdQjUrtjJJWq;

1.107
date	2015.08.12.22.27.31;	author sthen;	state Exp;
branches;
next	1.106;
commitid	SHEFBfUb4YY8KIkG;

1.106
date	2015.07.28.14.46.13;	author ajacoutot;	state Exp;
branches;
next	1.105;
commitid	QGW6SOseohljZeQH;

1.105
date	2015.07.28.14.33.58;	author sthen;	state Exp;
branches;
next	1.104;
commitid	t0r6A5oFphZnfEux;

1.104
date	2015.04.04.09.30.30;	author ajacoutot;	state Exp;
branches;
next	1.103;
commitid	QSLndtZiU46ysFLn;

1.103
date	2015.04.04.09.21.02;	author ajacoutot;	state Exp;
branches;
next	1.102;
commitid	kS3kwKZogsvzYmEY;

1.102
date	2015.01.24.16.56.39;	author ajacoutot;	state Exp;
branches;
next	1.101;
commitid	q7UB33coeDDdBnOG;

1.101
date	2014.12.31.11.53.54;	author jasper;	state Exp;
branches;
next	1.100;
commitid	M8vBMh5WB4Y3at41;

1.100
date	2014.02.07.07.48.03;	author ajacoutot;	state Exp;
branches;
next	1.99;

1.99
date	2013.11.28.10.53.28;	author ajacoutot;	state Exp;
branches;
next	1.98;

1.98
date	2013.11.03.15.55.19;	author ajacoutot;	state Exp;
branches;
next	1.97;

1.97
date	2013.11.02.21.47.56;	author ajacoutot;	state Exp;
branches;
next	1.96;

1.96
date	2013.10.31.21.12.12;	author sthen;	state Exp;
branches;
next	1.95;

1.95
date	2013.09.10.13.26.47;	author ajacoutot;	state Exp;
branches;
next	1.94;

1.94
date	2013.05.31.21.12.02;	author ajacoutot;	state Exp;
branches;
next	1.93;

1.93
date	2013.05.31.15.35.25;	author ajacoutot;	state Exp;
branches;
next	1.92;

1.92
date	2013.05.23.13.40.38;	author ajacoutot;	state Exp;
branches;
next	1.91;

1.91
date	2013.05.09.15.17.32;	author ajacoutot;	state Exp;
branches;
next	1.90;

1.90
date	2013.04.28.08.18.55;	author ajacoutot;	state Exp;
branches;
next	1.89;

1.89
date	2013.03.21.08.46.33;	author ajacoutot;	state Exp;
branches;
next	1.88;

1.88
date	2013.03.11.11.35.45;	author espie;	state Exp;
branches;
next	1.87;

1.87
date	2013.01.26.10.25.31;	author ajacoutot;	state Exp;
branches;
next	1.86;

1.86
date	2013.01.20.15.19.00;	author ajacoutot;	state Exp;
branches;
next	1.85;

1.85
date	2013.01.20.14.19.43;	author ajacoutot;	state Exp;
branches;
next	1.84;

1.84
date	2013.01.20.10.44.17;	author ajacoutot;	state Exp;
branches;
next	1.83;

1.83
date	2013.01.13.19.49.37;	author ajacoutot;	state Exp;
branches;
next	1.82;

1.82
date	2012.12.21.12.13.36;	author sthen;	state Exp;
branches;
next	1.81;

1.81
date	2012.09.01.14.36.58;	author ajacoutot;	state Exp;
branches;
next	1.80;

1.80
date	2012.04.28.13.44.56;	author espie;	state Exp;
branches;
next	1.79;

1.79
date	2012.04.28.10.52.08;	author ajacoutot;	state Exp;
branches;
next	1.78;

1.78
date	2012.03.02.07.11.23;	author ajacoutot;	state Exp;
branches;
next	1.77;

1.77
date	2012.02.29.15.43.16;	author ajacoutot;	state Exp;
branches;
next	1.76;

1.76
date	2012.02.22.10.27.03;	author ajacoutot;	state Exp;
branches;
next	1.75;

1.75
date	2012.02.20.18.01.19;	author espie;	state Exp;
branches;
next	1.74;

1.74
date	2011.12.17.22.01.13;	author sthen;	state Exp;
branches;
next	1.73;

1.73
date	2011.11.11.11.39.52;	author espie;	state Exp;
branches;
next	1.72;

1.72
date	2011.10.17.10.03.51;	author espie;	state Exp;
branches;
next	1.71;

1.71
date	2011.10.17.06.41.43;	author ajacoutot;	state Exp;
branches;
next	1.70;

1.70
date	2011.10.11.16.03.45;	author espie;	state Exp;
branches;
next	1.69;

1.69
date	2011.10.02.15.27.31;	author ajacoutot;	state Exp;
branches;
next	1.68;

1.68
date	2011.09.30.12.29.54;	author ajacoutot;	state Exp;
branches;
next	1.67;

1.67
date	2011.09.16.11.13.37;	author espie;	state Exp;
branches;
next	1.66;

1.66
date	2011.07.20.08.45.00;	author ajacoutot;	state Exp;
branches;
next	1.65;

1.65
date	2011.07.14.18.48.15;	author ajacoutot;	state Exp;
branches;
next	1.64;

1.64
date	2011.06.22.15.27.55;	author shadchin;	state Exp;
branches;
next	1.63;

1.63
date	2011.06.17.08.43.06;	author landry;	state Exp;
branches;
next	1.62;

1.62
date	2011.06.13.07.11.30;	author ajacoutot;	state Exp;
branches;
next	1.61;

1.61
date	2011.06.13.07.04.11;	author ajacoutot;	state Exp;
branches;
next	1.60;

1.60
date	2011.06.08.18.00.49;	author jasper;	state Exp;
branches;
next	1.59;

1.59
date	2011.06.02.17.09.32;	author kili;	state Exp;
branches;
next	1.58;

1.58
date	2011.05.12.05.54.16;	author ajacoutot;	state Exp;
branches;
next	1.57;

1.57
date	2011.05.01.17.56.46;	author ajacoutot;	state Exp;
branches;
next	1.56;

1.56
date	2011.04.25.10.02.43;	author ajacoutot;	state Exp;
branches;
next	1.55;

1.55
date	2011.04.08.07.11.08;	author jasper;	state Exp;
branches;
next	1.54;

1.54
date	2011.04.07.08.25.35;	author ajacoutot;	state Exp;
branches;
next	1.53;

1.53
date	2011.03.17.16.49.27;	author ajacoutot;	state Exp;
branches;
next	1.52;

1.52
date	2011.03.03.10.18.53;	author jasper;	state Exp;
branches;
next	1.51;

1.51
date	2011.03.02.06.34.40;	author ajacoutot;	state Exp;
branches;
next	1.50;

1.50
date	2011.01.17.13.18.13;	author landry;	state Exp;
branches
	1.50.2.1;
next	1.49;

1.49
date	2011.01.16.16.44.27;	author ajacoutot;	state Exp;
branches;
next	1.48;

1.48
date	2011.01.16.15.39.04;	author ajacoutot;	state Exp;
branches;
next	1.47;

1.47
date	2010.12.27.14.50.23;	author ajacoutot;	state Exp;
branches;
next	1.46;

1.46
date	2010.12.24.10.40.05;	author ajacoutot;	state Exp;
branches;
next	1.45;

1.45
date	2010.12.14.14.55.02;	author ajacoutot;	state Exp;
branches;
next	1.44;

1.44
date	2010.11.30.16.37.21;	author ajacoutot;	state Exp;
branches;
next	1.43;

1.43
date	2010.11.19.22.31.32;	author espie;	state Exp;
branches;
next	1.42;

1.42
date	2010.11.06.19.05.28;	author ajacoutot;	state Exp;
branches;
next	1.41;

1.41
date	2010.11.06.16.07.00;	author espie;	state Exp;
branches;
next	1.40;

1.40
date	2010.11.05.10.06.44;	author espie;	state Exp;
branches;
next	1.39;

1.39
date	2010.10.29.12.54.43;	author ajacoutot;	state Exp;
branches;
next	1.38;

1.38
date	2010.10.28.20.43.49;	author ajacoutot;	state Exp;
branches;
next	1.37;

1.37
date	2010.10.28.11.39.47;	author ajacoutot;	state Exp;
branches;
next	1.36;

1.36
date	2010.10.24.21.30.01;	author ajacoutot;	state Exp;
branches;
next	1.35;

1.35
date	2010.10.18.18.36.45;	author espie;	state Exp;
branches;
next	1.34;

1.34
date	2010.10.11.08.16.51;	author jasper;	state Exp;
branches;
next	1.33;

1.33
date	2010.09.16.18.53.29;	author ajacoutot;	state Exp;
branches;
next	1.32;

1.32
date	2010.08.30.21.14.35;	author sthen;	state Exp;
branches;
next	1.31;

1.31
date	2010.08.21.19.41.10;	author ajacoutot;	state Exp;
branches;
next	1.30;

1.30
date	2010.07.31.14.33.20;	author ajacoutot;	state Exp;
branches
	1.30.2.1;
next	1.29;

1.29
date	2010.07.17.14.12.38;	author ajacoutot;	state Exp;
branches;
next	1.28;

1.28
date	2010.07.12.22.07.37;	author sthen;	state Exp;
branches;
next	1.27;

1.27
date	2010.07.07.18.57.38;	author ajacoutot;	state Exp;
branches;
next	1.26;

1.26
date	2010.07.06.13.02.14;	author espie;	state Exp;
branches;
next	1.25;

1.25
date	2010.07.05.08.25.08;	author espie;	state Exp;
branches;
next	1.24;

1.24
date	2010.07.05.06.15.23;	author ajacoutot;	state Exp;
branches;
next	1.23;

1.23
date	2010.06.28.19.50.10;	author ajacoutot;	state Exp;
branches;
next	1.22;

1.22
date	2010.06.28.19.30.13;	author ajacoutot;	state Exp;
branches;
next	1.21;

1.21
date	2010.06.28.18.52.31;	author robert;	state Exp;
branches;
next	1.20;

1.20
date	2010.06.28.18.33.59;	author robert;	state Exp;
branches;
next	1.19;

1.19
date	2010.06.28.18.33.41;	author robert;	state Exp;
branches;
next	1.18;

1.18
date	2010.04.08.18.53.40;	author ajacoutot;	state Exp;
branches;
next	1.17;

1.17
date	2010.04.08.14.21.24;	author ajacoutot;	state Exp;
branches;
next	1.16;

1.16
date	2010.04.05.10.59.29;	author robert;	state Exp;
branches;
next	1.15;

1.15
date	2010.03.29.07.52.26;	author ajacoutot;	state Exp;
branches;
next	1.14;

1.14
date	2010.03.20.17.02.13;	author ajacoutot;	state Exp;
branches;
next	1.13;

1.13
date	2009.12.22.00.31.22;	author sthen;	state Exp;
branches
	1.13.2.1;
next	1.12;

1.12
date	2009.10.13.21.15.57;	author jasper;	state Exp;
branches;
next	1.11;

1.11
date	2009.10.09.18.17.25;	author ajacoutot;	state Exp;
branches;
next	1.10;

1.10
date	2009.10.09.17.36.20;	author ajacoutot;	state Exp;
branches;
next	1.9;

1.9
date	2009.10.04.07.48.37;	author ajacoutot;	state Exp;
branches;
next	1.8;

1.8
date	2009.08.10.06.33.43;	author kili;	state Exp;
branches;
next	1.7;

1.7
date	2009.06.26.22.12.20;	author ajacoutot;	state Exp;
branches;
next	1.6;

1.6
date	2009.06.16.21.50.01;	author jasper;	state Exp;
branches;
next	1.5;

1.5
date	2009.06.06.18.36.43;	author ajacoutot;	state Exp;
branches;
next	1.4;

1.4
date	2009.06.06.08.02.08;	author ajacoutot;	state Exp;
branches;
next	1.3;

1.3
date	2009.06.04.21.42.40;	author ajacoutot;	state Exp;
branches;
next	1.2;

1.2
date	2009.06.03.19.42.55;	author ajacoutot;	state Exp;
branches;
next	1.1;

1.1
date	2009.06.03.16.27.12;	author ajacoutot;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2009.06.03.16.27.12;	author ajacoutot;	state Exp;
branches;
next	;

1.13.2.1
date	2010.07.27.02.48.43;	author william;	state Exp;
branches;
next	;

1.30.2.1
date	2010.11.20.04.45.32;	author william;	state Exp;
branches;
next	;

1.50.2.1
date	2011.03.09.09.20.52;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.124
log
@Update to avahi-0.7.
@
text
@# $OpenBSD: Makefile,v 1.123 2017/05/30 18:53:37 ajacoutot Exp $

ONLY_FOR_ARCHS-mono=	${MONO_ARCHS}

COMMENT-main=		framework for Multicast DNS Service Discovery
COMMENT-gtk=		gtk+2 avahi-ui libraries
COMMENT-gtk3=		gtk+3 avahi-ui libraries
COMMENT-gui=		GUI client utilities for avahi
COMMENT-mono=		mono (.NET) bindings for avahi
COMMENT-python=		python bindings for avahi
COMMENT-ui=		common avahi-ui header for gtk+2 and gtk+3

V=			0.7
GH_ACCOUNT=		lathiat
GH_PROJECT=		avahi
GH_TAGNAME=		v${V}

PKGNAME-main=		avahi-${V}
PKGNAME-gtk=		avahi-gtk-${V}
PKGNAME-gtk3=		avahi-gtk3-${V}
PKGNAME-gui=		avahi-gui-${V}
PKGNAME-mono=		mono-avahi-${V}
PKGNAME-python=		py-avahi-${V}
PKGNAME-ui=		avahi-ui-${V}

CATEGORIES=		net devel

MAINTAINER=		Antoine Jacoutot <ajacoutot@@openbsd.org>

SHARED_LIBS +=  avahi-common         0.1      # 8.3
SHARED_LIBS +=  avahi-core           0.1      # 7.2
SHARED_LIBS +=  avahi-client         0.1      # 5.9
SHARED_LIBS +=  avahi-glib           0.1      # 1.2
SHARED_LIBS +=  avahi-gobject        0.1      # 0.5
SHARED_LIBS +=  dns_sd               0.1      # 1.0
SHARED_LIBS +=  howl                 0.1      # 0.0
SHARED_LIBS +=  avahi-ui             0.1      # 1.4
SHARED_LIBS +=  avahi-ui-gtk3        0.1      # 1.4

HOMEPAGE=		http://www.avahi.org/

# LGPLv2.1
PERMIT_PACKAGE_CDROM=	Yes

PSEUDO_FLAVORS=		no_gui no_mono bootstrap
FLAVOR?=		no_gui no_mono bootstrap

MULTI_PACKAGES= 	-main -mono -gui -gtk -gtk3 -python -ui

MODULES=		textproc/intltool

BUILD_DEPENDS=		converters/xmltoman \
			devel/gobject-introspection \

WANTLIB-main += c expat glib-2.0 gobject-2.0 pcre pthread gdbm daemon
WANTLIB-main += dbus-1 ffi iconv intl

RUN_DEPENDS-main=	${RUN_DEPENDS}

# /usr/local/share/dbus-1/system-services/
RUN_DEPENDS-main +=	x11/dbus,-suid

LIB_DEPENDS-main=	devel/glib2 \
			databases/gdbm \
			devel/libdaemon \
			x11/dbus

.include <bsd.port.arch.mk>

.if !${BUILD_PACKAGES:M-gui}
# all these vanish together
BUILD_PACKAGES :=	${BUILD_PACKAGES:N-mono:N-gtk:N-gtk3:N-python:N-ui}
.endif

.if ${BUILD_PACKAGES:M-mono}
MODULES+=		lang/mono
BUILD_DEPENDS+= 	${MODMONO_BUILD_DEPENDS} \
			x11/mono-gtk2
RUN_DEPENDS-mono=	${MODMONO_RUN_DEPENDS} \
			${BUILD_PKGPATH},-gtk \
			x11/mono-gtk2
LIB_DEPENDS-mono=	#empty
WANTLIB-mono +=		#empty
.else
CONFIGURE_ARGS+=	--disable-mono \
			--disable-monodoc
.endif

.if ${BUILD_PACKAGES:M-gui}
### common
MODULES+=		lang/python
BUILD_DEPENDS+=		devel/py-gobject3 \
			lang/python/${MODPY_VERSION},-gdbm \
			x11/dbus-python

### -gtk
LIB_DEPENDS-gtk=	x11/gtk+2 \
			${BUILD_PKGPATH}
RUN_DEPENDS-gtk=	${BUILD_PKGPATH},-ui
WANTLIB-gtk += X11 Xcomposite Xcursor Xdamage Xext Xfixes
WANTLIB-gtk += Xi Xinerama Xrandr Xrender atk-1.0 cairo dbus-1
WANTLIB-gtk += expat fontconfig freetype gdbm gdk-x11-2.0 gthread-2.0
WANTLIB-gtk += gdk_pixbuf-2.0 gio-2.0 glib-2.0 gmodule-2.0
WANTLIB-gtk += gobject-2.0 gtk-x11-2.0 m pango-1.0 pangocairo-1.0
WANTLIB-gtk += pangoft2-1.0 pcre pixman-1 png pthread pthread-stubs xcb z
WANTLIB-gtk += xcb-render avahi-client avahi-common xcb-shm
WANTLIB-gtk += avahi-glib ffi harfbuzz graphite2 iconv intl

### -gtk3
LIB_DEPENDS-gtk3=	x11/gtk+3 \
			${BUILD_PKGPATH}
RUN_DEPENDS-gtk3=	${BUILD_PKGPATH},-ui
WANTLIB-gtk3 += X11 Xcomposite Xcursor Xdamage Xext Xfixes
WANTLIB-gtk3 += Xi Xinerama Xrandr Xrender atk-1.0 avahi-client
WANTLIB-gtk3 += avahi-common avahi-glib cairo cairo-gobject
WANTLIB-gtk3 += dbus-1 expat fontconfig freetype gdbm gdk-3 gdk_pixbuf-2.0
WANTLIB-gtk3 += gio-2.0 glib-2.0 gmodule-2.0 gobject-2.0 gthread-2.0
WANTLIB-gtk3 += gtk-3 m pango-1.0 pangocairo-1.0 pangoft2-1.0
WANTLIB-gtk3 += pcre pixman-1 png pthread pthread-stubs xcb xcb-render
WANTLIB-gtk3 += xcb-shm z ffi iconv intl
WANTLIB-gtk3 += ICE SM atk-bridge-2.0 atspi harfbuzz
WANTLIB-gtk3 += graphite2 epoxy

### -gui
LIB_DEPENDS-gui=	${BUILD_PKGPATH},-gtk3
RUN_DEPENDS-gui=	${MODPY_RUN_DEPENDS} \
			${BUILD_PKGPATH},-python \
			x11/dbus-python \
			devel/py-twisted \
			devel/desktop-file-utils

# pygobject GTK2 introspection (not provided by indirect dependencies)
RUN_DEPENDS-gui +=	x11/gtk+2

WANTLIB-gui += X11 Xcomposite Xcursor Xdamage Xext Xfixes
WANTLIB-gui += Xi Xinerama Xrandr Xrender atk-1.0 avahi-client
WANTLIB-gui += avahi-common avahi-core avahi-glib avahi-ui-gtk3 c
WANTLIB-gui += cairo cairo-gobject dbus-1 expat fontconfig freetype
WANTLIB-gui += gdbm gdk-3 gdk_pixbuf-2.0 gio-2.0 glib-2.0 gmodule-2.0
WANTLIB-gui += gobject-2.0 gthread-2.0 gtk-3 m pango-1.0
WANTLIB-gui += pangocairo-1.0 pangoft2-1.0 pcre pixman-1 png pthread
WANTLIB-gui += pthread-stubs xcb xcb-render xcb-shm z ffi
WANTLIB-gui += ICE SM atk-bridge-2.0 atspi harfbuzz
WANTLIB-gui += graphite2 epoxy iconv intl

### -python
LIB_DEPENDS-python=	#empty
RUN_DEPENDS-python=	${BUILD_PKGPATH} \
			${MODPY_RUN_DEPENDS} \
			lang/python/${MODPY_VERSION},-gdbm
WANTLIB-python += 	#empty

### -ui
LIB_DEPENDS-ui= 	#empty
RUN_DEPENDS-ui= 	${BUILD_PKGPATH}
WANTLIB-ui +=		#empty
.else
CONFIGURE_ARGS+=	--disable-gtk \
			--disable-gtk3 \
			--disable-python \
			--disable-pygobject \
			--disable-python-dbus
.endif

USE_GMAKE=		Yes

MODPY_RUNDEP=		No
MODMONO_DEPS=		No

CFLAGS+=		-D_BSD_SOURCE

CONFIGURE_STYLE=	gnu
CONFIGURE_ENV=		CPPFLAGS="-I${LOCALBASE}/include -I${X11BASE}/include" \
			LDFLAGS="-L${LOCALBASE}/lib -L${X11BASE}/lib" \
			PTHREAD_CFLAGS="-pthread" \
			PTHREAD_LIBS="-pthread" \
			PYTHON="${MODPY_BIN}"
CONFIGURE_ARGS+=	--with-dbus-sys="${SYSCONFDIR}/dbus-1/" \
			--with-avahi-user=_avahi \
			--with-avahi-group=_avahi \
			--with-avahi-priv-access-group=wheel \
			--with-xml=expat \
			--with-distro=none \
			--enable-compat-howl \
			--enable-compat-libdns_sd \
			--enable-core-docs \
			--enable-tests \
			--enable-introspection \
			--disable-qt3 \
			--disable-qt4 \
			--disable-autoipd \
			--disable-doxygen-doc \
			--disable-doxygen-dot \
			--disable-doxygen-xml \
			--disable-doxygen-html

# don't link with libssp from the gcc4 port
# __guard and __stack_smash_handler are part of libc
CONFIGURE_ARGS +=	--disable-stack-protector

FAKE_FLAGS=		SYSCONFDIR=${SYSCONFDIR}

PC_FILES=		avahi-ui.pc avahi-client.pc avahi-compat-howl.pc \
			avahi-compat-libdns_sd.pc avahi-core.pc avahi-glib.pc \
			avahi-gobject.pc avahi-qt3.pc avahi-qt4.pc

PORTHOME=		${WRKBUILD}

AUTOCONF_VERSION=	2.69
AUTOMAKE_VERSION=	1.15
BUILD_DEPENDS +=	${MODGNU_AUTOCONF_DEPENDS} \
			${MODGNU_AUTOMAKE_DEPENDS} \
			devel/libtool

pre-configure:
	find ${WRKSRC} -name Makefile.in -exec \
		sed -i -e 's,LIBINTL,INTLLIBS,g;' \
			-e 's,LIBICONV,LTLIBICONV,g' {} \;
	find ${WRKSRC}/man -name '*.[1-9]*' | xargs \
		sed -i 's,/etc/avahi,${SYSCONFDIR}/avahi,g'
	for i in ${PC_FILES}; do \
		sed -i -e 's,Libs:,Libs: -pthread,;' \
			-e 's,Cflags:,Cflags: -pthread,' ${WRKSRC}/$${i}.in; done
	cd ${WRKSRC} && ${SETENV} \
		AUTOCONF_VERSION=${AUTOCONF_VERSION} \
		AUTOMAKE_VERSION=${AUTOMAKE_VERSION} \
		NOCONFIGURE=1 \
		/bin/sh ./autogen.sh

post-install:
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/avahi
	mv ${WRKINST}${SYSCONFDIR}/avahi ${PREFIX}/share/examples/
	mv ${WRKINST}${SYSCONFDIR}/dbus-1 ${PREFIX}/share/examples/avahi/
	${INSTALL_DATA_DIR} ${PREFIX}/share/dbus-1/system-services
	${INSTALL_DATA} ${WRKBUILD}/avahi-daemon/org.freedesktop.Avahi.service \
		${PREFIX}/share/dbus-1/system-services
	# XXX DLLMAP_FILES won't work here since the files are generated during the build process
	find ${PREFIX} -name avahi-sharp.dll.config -or -name avahi-ui-sharp.dll.config | \
		xargs -r sed -i 's,\.so(\.[0-9])+,\.so,g'

.include <bsd.port.mk>
@


1.123
log
@Silence a useless warning; we will never have NSS.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.122 2017/05/16 19:31:34 landry Exp $
d13 4
a16 3
V=			0.6.32
DISTNAME=		avahi-${V}
CATEGORIES=		net devel
d26 1
a26 2
REVISION-main=		1
REVISION-gui=		1
d30 9
a38 9
SHARED_LIBS +=  avahi-common         0.0      # 8.3
SHARED_LIBS +=  avahi-core           0.0      # 7.2
SHARED_LIBS +=  avahi-client         0.0      # 5.9
SHARED_LIBS +=  avahi-glib           0.0      # 1.2
SHARED_LIBS +=  avahi-gobject        0.0      # 0.4
SHARED_LIBS +=  dns_sd               0.0      # 1.0
SHARED_LIBS +=  howl                 0.0      # 0.0
SHARED_LIBS +=  avahi-ui             0.0      # 1.4
SHARED_LIBS +=  avahi-ui-gtk3        0.0      # 1.4
a44 2
MASTER_SITES=		https://github.com/lathiat/avahi/releases/download/v${V}/

d92 2
a93 2
BUILD_DEPENDS+=		lang/python/${MODPY_VERSION},-gdbm \
			x11/py-gtk2 \
a128 1
			x11/py-gtk2 \
d132 3
d161 1
a161 1
			--disable-pygtk \
d209 6
a220 6
	sed -i 's,dbus_connection_disconnect,dbus_connection_close,g' \
		${WRKSRC}/avahi-client/client.c \
		${WRKSRC}/avahi-daemon/dbus-protocol.c
	sed -i 's,-ldl,,g' ${WRKSRC}/configure \
		${WRKSRC}/avahi-client/Makefile.in \
		${WRKSRC}/avahi-daemon/Makefile.in
d224 5
d239 1
a239 1
		xargs perl -pi -e 's,\.so(\.[0-9])+,\.so,g'
@


1.122
log
@Fix pkgpaths pointing to devel/py-twisted, and bump REVISIONs.
From Pavel Korovin.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.121 2017/04/22 13:43:21 ajacoutot Exp $
d25 1
a25 1
REVISION-main=		0
@


1.121
log
@Stop patching for /var/lib/dbus -> /var/db/dbus; nowadays, most apps look
into /etc/machine-id *before* looking into /var/lib/dbus/machine-id and for
the few that don't patch them to look directly there.

Thanks sthen@@ for the source ports seach.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.120 2016/11/11 07:56:23 ajacoutot Exp $
d26 1
d132 1
a132 1
			devel/py-twisted/web \
@


1.120
log
@Update to avahi-0.6.32.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.119 2016/11/11 07:40:02 ajacoutot Exp $
d25 2
a219 3
	sed -i -e "s,/var/lib/dbus,/var/db/dbus,g;" \
		-e "s,/etc/machine-id,${SYSCONFDIR}/machine-id,g" \
		${WRKSRC}/avahi-daemon/main.c
@


1.119
log
@Remove the -qt3 and qt4 subpackages, nothing uses them in tree.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.118 2016/11/10 16:54:02 ajacoutot Exp $
d13 1
a13 1
V=			0.6.31
a24 8
REVISION-main=		27
REVISION-gtk=		7
REVISION-gtk3=		8
REVISION-gui=		11
REVISION-mono=		3
REVISION-ui=		4
REVISION-python=	1

d27 9
a35 7
SHARED_LIBS +=  avahi-common         0.0      # .8.0
SHARED_LIBS +=  avahi-core           0.0      # .5.5
SHARED_LIBS +=  avahi-client         0.0      # .5.4
SHARED_LIBS +=  avahi-glib           0.0      # .1.1
SHARED_LIBS +=  avahi-gobject        0.0      # .0.1
SHARED_LIBS +=  howl                 0.0      # .0.0
SHARED_LIBS +=  dns_sd               0.0      # .1.0
d42 1
a42 1
MASTER_SITES=		http://www.avahi.org/download/
a95 1
SHARED_LIBS +=  	avahi-ui             0.0      # .1.0
a108 1
SHARED_LIBS +=		avahi-ui-gtk3             0.0 # 1.4
@


1.118
log
@Drop the gettext MODULE.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.117 2016/09/12 15:28:30 jca Exp $
a10 2
COMMENT-qt3=		qt3 bindings for avahi
COMMENT-qt4=		qt4 bindings for avahi
a22 2
PKGNAME-qt3=		avahi-qt3-${V}
PKGNAME-qt4=		avahi-qt4-${V}
d25 1
a25 1
REVISION-main=		26
a29 2
REVISION-qt3=		6
REVISION-qt4=		7
d50 2
a51 2
PSEUDO_FLAVORS=		no_gui no_mono no_qt3 no_qt4 bootstrap
FLAVOR?=		no_gui no_mono no_qt3 no_qt4 bootstrap
d53 1
a53 1
MULTI_PACKAGES= 	-main -mono -qt3 -qt4 -gui -gtk -gtk3 -python -ui
a169 27
.if ${BUILD_PACKAGES:M-qt3}
SHARED_LIBS +=  	avahi-qt3            0.0      # .1.2
MODULES+=		x11/qt3
LIB_DEPENDS-qt3=	${MODQT3_LIB_DEPENDS} \
			${BUILD_PKGPATH}

WANTLIB-qt3 += GL ICE SM X11 Xcursor Xext Xfixes Xft Xi
WANTLIB-qt3 += Xinerama Xmu Xrandr Xrender Xt expat fontconfig
WANTLIB-qt3 += freetype jpeg lcms m mng png pthread xcb z
WANTLIB-qt3 += avahi-common stdc++ ${MODQT3_WANTLIB}
WANTLIB-qt3 += X11-xcb iconv intl glapi xcb-dri2 xcb-glx
WANTLIB-qt3 += Xdamage Xxf86vm drm pthread-stubs
.else
CONFIGURE_ARGS+=	--disable-qt3
.endif

.if ${BUILD_PACKAGES:M-qt4}
SHARED_LIBS +=		avahi-qt4            0.0      # .1.2
MODULES+=		x11/qt4
LIB_DEPENDS-qt4=	x11/qt4 \
			${BUILD_PKGPATH}
WANTLIB-qt4 += QtCore avahi-common m stdc++ pthread
WANTLIB-qt4 += glib-2.0 gthread-2.0 pcre z iconv intl
.else
CONFIGURE_ARGS+=	--disable-qt4
.endif

d194 2
@


1.117
log
@Set PORTHOME to avoid junk directories in /

from Solene Rapenne.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.116 2016/08/17 20:58:19 sthen Exp $
d29 4
a32 4
REVISION-main=		25
REVISION-gtk=		6
REVISION-gtk3=		7
REVISION-gui=		10
d34 2
a35 2
REVISION-qt3=		5
REVISION-qt4=		6
d61 1
a61 2
MODULES=		devel/gettext \
			textproc/intltool
d67 1
a67 2
WANTLIB-main += dbus-1 ffi
WANTLIB-main += ${MODGETTEXT_WANTLIB}
d74 1
a74 2
LIB_DEPENDS-main=	${MODGETTEXT_LIB_DEPENDS} \
			devel/glib2 \
d109 1
a109 2
LIB_DEPENDS-gtk=	${MODGETTEXT_LIB_DEPENDS} \
			x11/gtk+2 \
d111 1
a111 2
RUN_DEPENDS-gtk=	${MODGETTEXT_RUN_DEPENDS} \
			${BUILD_PKGPATH},-ui
d119 1
a119 2
WANTLIB-gtk += avahi-glib ffi harfbuzz graphite2
WANTLIB-gtk += ${MODGETTEXT_WANTLIB}
d123 1
a123 2
LIB_DEPENDS-gtk3=	${MODGETTEXT_LIB_DEPENDS} \
			x11/gtk+3 \
d125 1
a125 2
RUN_DEPENDS-gtk3=	${MODGETTEXT_RUN_DEPENDS} \
			${BUILD_PKGPATH},-ui
d133 1
a133 1
WANTLIB-gtk3 += xcb-shm z ffi ${MODGETTEXT_WANTLIB}
d138 2
a139 4
LIB_DEPENDS-gui=	${MODGETTEXT_LIB_DEPENDS} \
			${BUILD_PKGPATH},-gtk3
RUN_DEPENDS-gui=	${MODGETTEXT_RUN_DEPENDS} \
			${MODPY_RUN_DEPENDS} \
d155 1
a155 2
WANTLIB-gui += graphite2 epoxy
WANTLIB-gui += ${MODGETTEXT_WANTLIB}
d179 1
a179 2
LIB_DEPENDS-qt3=	${MODGETTEXT_LIB_DEPENDS} \
			${MODQT3_LIB_DEPENDS} \
d185 2
a186 2
WANTLIB-qt3 += avahi-common stdc++ ${MODQT3_WANTLIB} ${MODGETTEXT_WANTLIB}
WANTLIB-qt3 += X11-xcb Xau Xdmcp glapi xcb-dri2 xcb-glx
d195 1
a195 2
LIB_DEPENDS-qt4=	${MODGETTEXT_LIB_DEPENDS} \
			x11/qt4 \
d197 2
a198 1
WANTLIB-qt4 += QtCore avahi-common m stdc++ ${MODGETTEXT_WANTLIB} pthread glib-2.0 gthread-2.0 pcre z
@


1.116
log
@bump ports that might pick up IP_SENDSRCADDR
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.115 2016/04/04 22:57:45 naddy Exp $
d254 2
@


1.115
log
@g/c PFRAG.shared
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.114 2016/03/11 20:28:28 naddy Exp $
d29 1
a29 1
REVISION-main=		24
@


1.114
log
@garbage collect CONFIGURE_SHARED
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.113 2015/12/06 08:29:35 ajacoutot Exp $
d29 1
a29 1
REVISION-main=		23
d34 2
a35 2
REVISION-qt3=		4
REVISION-qt4=		5
@


1.113
log
@multicast_{host,router} -> multicast
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.112 2015/10/24 09:18:13 ajacoutot Exp $
d228 1
a228 2
CONFIGURE_ARGS+=	${CONFIGURE_SHARED} \
			--with-dbus-sys="${SYSCONFDIR}/dbus-1/" \
@


1.112
log
@Consistency: rcctl enable is the most used idiom within the ports tree.
Also since we can pass it several daemons now, simplify enabling:
- before
rcctl enable foo
rcctl enable bar
rcctl enable bla
- after
rcctl enable foo bar bla
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.111 2015/10/08 21:19:22 sthen Exp $
d29 1
a29 1
REVISION-main=		22
@


1.111
log
@Bump some ports which reference if_msghdr in their source, so that package
updates are triggered. This is following the struct if_data ABI change a few
days ago; if_msghdr has an embedded if_data.  Some may be unnecessary, but
some are definitely needed and bumps are cheaper than debugging.
Problem reported with wpa_supplicant by Mikolaj Kucharski.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.110 2015/09/18 19:35:04 jasper Exp $
d29 1
a29 1
REVISION-main=		21
@


1.110
log
@sed -i
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.108 2015/08/27 06:48:30 ajacoutot Exp $
d29 1
a29 1
REVISION-main=		20
@


1.109
log
@zap two trailing/leading tabs
@
text
@d258 1
a258 1
		perl -pi -e 's,LIBINTL,INTLLIBS,g;' \
d261 2
a262 2
		perl -pi -e 's,/etc/avahi,${SYSCONFDIR}/avahi,g'
	perl -pi -e 's,dbus_connection_disconnect,dbus_connection_close,g' \
d265 1
a265 1
	perl -pi -e 's,-ldl,,g' ${WRKSRC}/configure \
d268 1
a268 1
	perl -pi -e "s,/var/lib/dbus,/var/db/dbus,g;" \
d272 1
a272 1
		perl -pi -e 's,Libs:,Libs: -pthread,;' \
@


1.108
log
@Fix DBus @@sample files after recent dbus port update.
The dbus package does not install /etc/dbus-1/system.d/ anymore, so it
needs to be properly @@sample'd.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.107 2015/08/12 22:27:31 sthen Exp $
d193 1
a193 1
		
@


1.107
log
@sync WANTLIB
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.106 2015/07/28 14:46:13 ajacoutot Exp $
d29 1
a29 1
REVISION-main=		19
d276 1
a276 2
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples
	mv ${WRKINST}${SYSCONFDIR}/dbus-1 ${PREFIX}/share/examples/
d278 1
@


1.106
log
@tyop
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.105 2015/07/28 14:33:58 sthen Exp $
d31 2
a32 2
REVISION-gtk3=		6
REVISION-gui=		9
d35 1
a35 1
REVISION-qt4=		4
d143 1
a143 1
WANTLIB-gtk3 += graphite2
d165 1
a165 1
WANTLIB-gui += graphite2
d210 1
a210 1
WANTLIB-qt4 += QtCore avahi-common m stdc++ ${MODGETTEXT_WANTLIB} pthread
@


1.105
log
@Give examples for enabling D-BUS ("messagebus") at startup; the script name
is no longer "D-BUS" so the descriptive text doesn't give that much of a clue
as to what's needed.  ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.104 2015/04/04 09:30:30 ajacoutot Exp $
d29 1
a29 1
REVISION-main=		18
@


1.104
log
@These need to RUN_DEPENDS on x11/dbus,-suid now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.103 2015/04/04 09:21:02 ajacoutot Exp $
d29 1
a29 1
REVISION-main=		17
@


1.103
log
@Bump after the recent changes in packaging dbus and dconf.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.102 2015/01/24 16:56:39 ajacoutot Exp $
d29 1
a29 1
REVISION-main=		16
d70 5
@


1.102
log
@Tweak pf example.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.101 2014/12/31 11:53:54 jasper Exp $
d29 9
a37 9
REVISION-main=		15
REVISION-gtk=		5
REVISION-gtk3=		5
REVISION-gui=		8
REVISION-mono=		2
REVISION-qt3=		3
REVISION-qt4=		3
REVISION-ui=		3
REVISION-python=	0
@


1.101
log
@use 'mdns' instead of '5353' in the pf.conf snippet
NB: this needs -r1.93 of /etc/services

ok aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.100 2014/02/07 07:48:03 ajacoutot Exp $
d29 1
a29 1
REVISION-main=		14
@


1.100
log
@Add option "host-name-from-machine-id=" (from upstream).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.99 2013/11/28 10:53:28 ajacoutot Exp $
d29 1
a29 1
REVISION-main=		13
@


1.99
log
@Fix RUN_DEPENDS.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.98 2013/11/03 15:55:19 ajacoutot Exp $
d29 1
a29 1
REVISION-main=		12
d263 3
@


1.98
log
@Human readable.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.97 2013/11/02 21:47:56 ajacoutot Exp $
d32 1
a32 1
REVISION-gui=		7
d37 1
d146 1
d167 1
a167 2
			lang/python/${MODPY_VERSION},-gdbm \
			x11/dbus-python
@


1.97
log
@Add a -python subpackage (py-avahi) stripped of the -gui one. There is
no need to install the gtk+2 tools just to have the python bindings.
Hopefully -gtk can go away soon...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.96 2013/10/31 21:12:12 sthen Exp $
d5 32
a36 32
COMMENT-main=	framework for Multicast DNS Service Discovery
COMMENT-gtk=	gtk+2 avahi-ui libraries
COMMENT-gtk3=	gtk+3 avahi-ui libraries
COMMENT-gui=	GUI client utilities for avahi
COMMENT-mono=	mono (.NET) bindings for avahi
COMMENT-python=	python bindings for avahi
COMMENT-qt3=	qt3 bindings for avahi
COMMENT-qt4=	qt4 bindings for avahi
COMMENT-ui=	common avahi-ui header for gtk+2 and gtk+3

V=		0.6.31
DISTNAME=	avahi-${V}
CATEGORIES=	net devel

PKGNAME-main=	avahi-${V}
PKGNAME-gtk=	avahi-gtk-${V}
PKGNAME-gtk3=	avahi-gtk3-${V}
PKGNAME-gui=	avahi-gui-${V}
PKGNAME-mono=	mono-avahi-${V}
PKGNAME-python=	py-avahi-${V}
PKGNAME-qt3=	avahi-qt3-${V}
PKGNAME-qt4=	avahi-qt4-${V}
PKGNAME-ui=	avahi-ui-${V}

REVISION-main=	12
REVISION-gtk=	5
REVISION-gtk3=	5
REVISION-gui=	7
REVISION-mono=	2
REVISION-qt3=	3
REVISION-qt4=	3
REVISION-ui=	3
d38 1
a38 1
MAINTAINER=	Antoine Jacoutot <ajacoutot@@openbsd.org>
d48 1
a48 1
HOMEPAGE=	http://www.avahi.org/
d53 1
a53 1
MASTER_SITES=	${HOMEPAGE}/download/
d55 2
a56 2
PSEUDO_FLAVORS=	no_gui no_mono no_qt3 no_qt4 bootstrap
FLAVOR?=	no_gui no_mono no_qt3 no_qt4 bootstrap
d58 1
a58 1
MULTI_PACKAGES=	-main -mono -qt3 -qt4 -gui -gtk -gtk3 -python -ui
d60 15
a74 14
MODULES=	devel/gettext \
		textproc/intltool

BUILD_DEPENDS=	converters/xmltoman \
		devel/gobject-introspection \

WANTLIB-main=	c expat glib-2.0 gobject-2.0 pcre pthread \
		gdbm daemon dbus-1 ffi \
		${MODGETTEXT_WANTLIB}
LIB_DEPENDS-main= ${MODGETTEXT_LIB_DEPENDS} \
		devel/glib2 \
		databases/gdbm \
		devel/libdaemon \
		x11/dbus
d80 1
a80 1
BUILD_PACKAGES := ${BUILD_PACKAGES:N-mono:N-gtk:N-gtk3:N-python:N-ui}
d84 8
a91 8
MODULES+=	lang/mono
BUILD_DEPENDS+=	${MODMONO_BUILD_DEPENDS} \
		x11/mono-gtk2
RUN_DEPENDS-mono= ${MODMONO_RUN_DEPENDS} \
		${BUILD_PKGPATH},-gtk \
		x11/mono-gtk2
LIB_DEPENDS-mono= # empty
WANTLIB-mono=	# empty
d93 2
a94 2
CONFIGURE_ARGS+= --disable-mono \
		--disable-monodoc
d99 4
a102 4
MODULES+=	lang/python
BUILD_DEPENDS+=	lang/python/${MODPY_VERSION},-gdbm \
		x11/py-gtk2 \
		x11/dbus-python
d105 15
a119 15
SHARED_LIBS +=  avahi-ui             0.0      # .1.0
LIB_DEPENDS-gtk= ${MODGETTEXT_LIB_DEPENDS} \
		x11/gtk+2 \
		${BUILD_PKGPATH}
RUN_DEPENDS-gtk= ${MODGETTEXT_RUN_DEPENDS} \
		${BUILD_PKGPATH},-ui
WANTLIB-gtk=	X11 Xcomposite Xcursor Xdamage Xext Xfixes \
		Xi Xinerama Xrandr Xrender atk-1.0 cairo dbus-1 \
		expat fontconfig freetype gdbm gdk-x11-2.0 gthread-2.0 \
		gdk_pixbuf-2.0 gio-2.0 glib-2.0 gmodule-2.0 \
		gobject-2.0 gtk-x11-2.0 m pango-1.0 pangocairo-1.0 \
		pangoft2-1.0 pcre pixman-1 png pthread pthread-stubs xcb z \
		xcb-render avahi-client avahi-common xcb-shm \
		avahi-glib ffi harfbuzz graphite2 \
		${MODGETTEXT_WANTLIB}
d122 6
a127 6
SHARED_LIBS +=  avahi-ui-gtk3             0.0 # 1.4
LIB_DEPENDS-gtk3= ${MODGETTEXT_LIB_DEPENDS} \
		x11/gtk+3 \
		${BUILD_PKGPATH}
RUN_DEPENDS-gtk3= ${MODGETTEXT_RUN_DEPENDS} \
		${BUILD_PKGPATH},-ui
d140 9
a148 8
LIB_DEPENDS-gui= ${MODGETTEXT_LIB_DEPENDS} \
		${BUILD_PKGPATH},-gtk3
RUN_DEPENDS-gui= ${MODGETTEXT_RUN_DEPENDS} \
		${MODPY_RUN_DEPENDS} \
		${BUILD_PKGPATH},-python \
		x11/py-gtk2 \
		devel/py-twisted/web \
		devel/desktop-file-utils
d162 6
a167 6
LIB_DEPENDS-python= # empty
RUN_DEPENDS-python= ${BUILD_PKGPATH} \
		${MODPY_RUN_DEPENDS} \
		lang/python/${MODPY_VERSION},-gdbm \
		x11/dbus-python
WANTLIB-python= # empty
d170 3
a172 3
LIB_DEPENDS-ui= # empty
RUN_DEPENDS-ui= ${BUILD_PKGPATH}
WANTLIB-ui= # empty
d174 5
a178 6
CONFIGURE_ARGS+= --disable-gtk \
		--disable-gtk3 \
		--disable-python \
		--disable-pygtk \
		--disable-python-dbus

d182 5
a186 5
SHARED_LIBS +=  avahi-qt3            0.0      # .1.2
MODULES+=	x11/qt3
LIB_DEPENDS-qt3= ${MODGETTEXT_LIB_DEPENDS} \
		${MODQT3_LIB_DEPENDS} \
		${BUILD_PKGPATH}
d188 6
a193 6
WANTLIB-qt3=	GL ICE SM X11 Xcursor Xext Xfixes Xft Xi \
		Xinerama Xmu Xrandr Xrender Xt expat fontconfig \
		freetype jpeg lcms m mng png pthread xcb z \
		avahi-common stdc++ ${MODQT3_WANTLIB} ${MODGETTEXT_WANTLIB} \
		X11-xcb Xau Xdmcp glapi xcb-dri2 xcb-glx \
		Xdamage Xxf86vm drm pthread-stubs
d195 1
a195 1
CONFIGURE_ARGS+= --disable-qt3
d199 6
a204 7
SHARED_LIBS +=  avahi-qt4            0.0      # .1.2
MODULES+=	x11/qt4
LIB_DEPENDS-qt4= ${MODGETTEXT_LIB_DEPENDS} \
		x11/qt4 \
		${BUILD_PKGPATH}
WANTLIB-qt4=	QtCore avahi-common m stdc++ ${MODGETTEXT_WANTLIB} \
		pthread
d206 1
a206 1
CONFIGURE_ARGS+= --disable-qt4
d209 1
a209 1
USE_GMAKE=	Yes
d211 2
a212 2
MODPY_RUNDEP=	No
MODMONO_DEPS=	No
d214 1
a214 1
CFLAGS+=	-D_BSD_SOURCE
d216 23
a238 23
CONFIGURE_STYLE=gnu
CONFIGURE_ENV=	CPPFLAGS="-I${LOCALBASE}/include -I${X11BASE}/include" \
		LDFLAGS="-L${LOCALBASE}/lib -L${X11BASE}/lib" \
		PTHREAD_CFLAGS="-pthread" \
		PTHREAD_LIBS="-pthread" \
		PYTHON="${MODPY_BIN}"
CONFIGURE_ARGS+=${CONFIGURE_SHARED} \
		--with-dbus-sys="${SYSCONFDIR}/dbus-1/" \
		--with-avahi-user=_avahi \
		--with-avahi-group=_avahi \
		--with-avahi-priv-access-group=wheel \
		--with-xml=expat \
		--with-distro=none \
		--enable-compat-howl \
		--enable-compat-libdns_sd \
		--enable-core-docs \
		--enable-tests \
		--enable-introspection \
		--disable-autoipd \
		--disable-doxygen-doc \
		--disable-doxygen-dot \
		--disable-doxygen-xml \
		--disable-doxygen-html
d242 1
a242 1
CONFIGURE_ARGS+=--disable-stack-protector
d244 1
a244 1
FAKE_FLAGS=	SYSCONFDIR=${SYSCONFDIR}
d246 3
a248 3
PC_FILES=	avahi-ui.pc avahi-client.pc avahi-compat-howl.pc \
		avahi-compat-libdns_sd.pc avahi-core.pc avahi-glib.pc \
		avahi-gobject.pc avahi-qt3.pc avahi-qt4.pc
@


1.96
log
@bump REVISION for any ports using route messages. regen some distinfos and
remove unnecessary USE_GROFFs while there.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.95 2013/09/10 13:26:47 ajacoutot Exp $
d10 1
d24 1
d29 1
a29 1
REVISION-main=	11
d32 1
a32 1
REVISION-gui=	6
d34 1
a34 1
REVISION-qt3=	2
d58 1
a58 1
MULTI_PACKAGES=	-main -mono -qt3 -qt4 -gui -gtk -gtk3 -ui
d72 1
a72 1
		devel/libdaemon>=0.14 \
d79 1
a79 1
BUILD_PACKAGES := ${BUILD_PACKAGES:N-mono:N-gtk:N-gtk3:N-ui}
d143 1
a143 1
		lang/python/${MODPY_VERSION},-gdbm \
a144 1
		x11/dbus-python \
d159 8
d186 1
d191 1
a269 2
	# Install the dbus system-service, some applications needs it to
	# know that avahi-daemon is running.
@


1.95
log
@Bump after dbus-python got renamed to py-dbus.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.94 2013/05/31 21:12:02 ajacoutot Exp $
d27 1
a27 1
REVISION-main=	10
@


1.94
log
@Bump to unbreak and remove now uneeded chunck.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.93 2013/05/31 15:35:25 ajacoutot Exp $
d30 1
a30 1
REVISION-gui=	5
@


1.93
log
@Sync WANTLIB and bump after the recent harfbuzz update; icu libs are not
needed anymore. This is a mecanical commit, there might be dragons :-)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.92 2013/05/23 13:40:38 ajacoutot Exp $
d27 4
a30 4
REVISION-main=	9
REVISION-gtk=	4
REVISION-gtk3=	4
REVISION-gui=	4
@


1.92
log
@Implement avahi_exe_name.
Remove uneeded patch.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.91 2013/05/09 15:17:32 ajacoutot Exp $
d34 1
a34 1
REVISION-ui=	2
d115 1
a115 1
		avahi-glib ffi harfbuzz icudata icule icuuc graphite2 \
d133 2
a134 2
WANTLIB-gtk3 += ICE SM atk-bridge-2.0 atspi harfbuzz icudata icule
WANTLIB-gtk3 += icuuc graphite2
d154 2
a155 2
WANTLIB-gui += ICE SM atk-bridge-2.0 atspi harfbuzz icudata icule
WANTLIB-gui += icuuc graphite2
@


1.91
log
@Tweak patch.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.90 2013/04/28 08:18:55 ajacoutot Exp $
d27 1
a27 1
REVISION-main=	8
@


1.90
log
@No need for gtar.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.89 2013/03/21 08:46:33 ajacoutot Exp $
d27 1
a27 1
REVISION-main=	7
@


1.89
log
@USE_LIBTOOL=Yes is the default now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.88 2013/03/11 11:35:45 espie Exp $
d27 8
a34 8
REVISION-main=	6
REVISION-gtk=	3
REVISION-gtk3=	3
REVISION-gui=	3
REVISION-mono=	1
REVISION-qt3=	1
REVISION-qt4=	2
REVISION-ui=	1
a63 4
# PaxHeaders
TAR=		${LOCALBASE}/bin/gtar
BUILD_DEPENDS += archivers/gtar

d65 1
a65 1
		gthread-2.0 gdbm daemon dbus-1 ffi \
d108 1
a108 1
WANTLIB-gtk=	X11 Xau Xcomposite Xcursor Xdamage Xdmcp Xext Xfixes \
d115 1
a115 1
		avahi-glib ffi harfbuzz icudata icule icuuc \
d125 1
a125 1
WANTLIB-gtk3 += X11 Xau Xcomposite Xcursor Xdamage Xdmcp Xext Xfixes
d134 1
a134 1
WANTLIB-gtk3 += icuuc
d146 1
a146 1
WANTLIB-gui += X11 Xau Xcomposite Xcursor Xdamage Xdmcp Xext Xfixes
d155 1
a155 1
WANTLIB-gui += icuuc
d181 1
a181 1
		Xdamage Xxf86vm drm
@


1.88
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.87 2013/01/26 10:25:31 ajacoutot Exp $
a202 1
USE_LIBTOOL=	Yes
@


1.87
log
@Don't leak host info by default (upstream).
Don't add 0pointer.de and zeroconf.org to default browse list (upstream).
regen WANTLIB.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.86 2013/01/20 15:19:00 ajacoutot Exp $
a49 3
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
@


1.86
log
@PF incoming.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.85 2013/01/20 14:19:43 ajacoutot Exp $
d27 4
a30 4
REVISION-main=	5
REVISION-gtk=	2
REVISION-gtk3=	2
REVISION-gui=	2
d121 1
a121 1
		xcb-render avahi-client avahi-common GL xcb-shm \
d132 1
a132 1
WANTLIB-gtk3 += GL X11 Xau Xcomposite Xcursor Xdamage Xdmcp Xext Xfixes
d153 1
a153 1
WANTLIB-gui += GL X11 Xau Xcomposite Xcursor Xdamage Xdmcp Xext Xfixes
@


1.85
log
@Tighten pf.conf example.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.84 2013/01/20 10:44:17 ajacoutot Exp $
d27 1
a27 1
REVISION-main=	4
@


1.84
log
@Remove unneeded patch and chunks.
Install org.freedesktop.Avahi.service.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.83 2013/01/13 19:49:37 ajacoutot Exp $
d27 1
a27 1
REVISION-main=	3
@


1.83
log
@Add a pf.conf(5) example rule.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.82 2012/12/21 12:13:36 sthen Exp $
d27 4
a30 4
REVISION-main=	2
REVISION-gtk=	1
REVISION-gtk3=	1
REVISION-gui=	1
d33 1
a33 1
REVISION-qt4=	1
d121 2
a122 2
		xcb-render avahi-client avahi-common GL Xxf86vm drm xcb-shm \
		avahi-glib ffi stdc++ harfbuzz icudata icule icuuc \
d133 1
a133 1
WANTLIB-gtk3 += Xi Xinerama Xrandr Xrender Xxf86vm atk-1.0 avahi-client
d135 1
a135 1
WANTLIB-gtk3 += dbus-1 drm expat fontconfig freetype gdbm gdk-3 gdk_pixbuf-2.0
d139 1
a139 1
WANTLIB-gtk3 += xcb-shm z ffi stdc++ ${MODGETTEXT_WANTLIB}
d154 1
a154 1
WANTLIB-gui += Xi Xinerama Xrandr Xrender Xxf86vm atk-1.0 avahi-client
d156 1
a156 1
WANTLIB-gui += cairo cairo-gobject dbus-1 drm expat fontconfig freetype
d160 1
a160 1
WANTLIB-gui += pthread-stubs xcb xcb-render xcb-shm z ffi stdc++
d200 1
a200 1
		z pthread
d267 6
a272 1
# XXX DLLMAP_FILES won't work here since the files are generated during the build process
@


1.82
log
@sync wantlib
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.81 2012/09/01 14:36:58 ajacoutot Exp $
d27 8
a34 1
REVISION=	1
@


1.81
log
@register-plist did not catch the devel/glib2 -main -> empty change.
espie asked me in such a nice way to fix this that I'm bumping all ports
that have a direct dependency on glib2.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.80 2012/04/28 13:44:56 espie Exp $
d27 1
a27 1
REVISION=	0
d115 2
a116 1
		avahi-glib ffi stdc++ ${MODGETTEXT_WANTLIB}
d133 2
d154 2
d177 1
a177 1
WANTLIB-qt3=	GL ICE SM X11 Xau Xcursor Xdmcp Xext Xfixes Xft Xi \
d179 1
a179 1
		freetype jpeg lcms m mng png pthread-stubs xcb z \
d181 1
a181 1
		Xdamage Xxf86vm drm ffi kvm
d193 1
a193 1
		glib-2.0 gthread-2.0 pcre z
@


1.80
log
@mono builds with rthreads
discussed with aja@@, passed a bulk on my box.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.79 2012/04/28 10:52:08 ajacoutot Exp $
d27 1
@


1.79
log
@--localstatedir=/var is the default now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.78 2012/03/02 07:11:23 ajacoutot Exp $
a26 1
IGNORE-mono = rthreads stuck on mono
@


1.78
log
@Remove NO_SYSTRACE, systrace(2) is going to be fixed soonish.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.77 2012/02/29 15:43:16 ajacoutot Exp $
a207 1
		--localstatedir="/var" \
@


1.77
log
@Add NO_SYSTRACE for now, otherwise gtar fails in mysterious way because
systrace(1) will prevent native-linkat.
Reported by Juan Francisco Cantero Hurtado.
@
text
@d1 1
a1 8
# $OpenBSD: Makefile,v 1.76 2012/02/22 10:27:03 ajacoutot Exp $

# XXX
# systrace: deny user: ajacoutot, prog: /usr/local/bin/gtar, pid: 1366(0)[14636],
#     policy: /usr/bin/make, filters: 241, syscall: native-linkat(317)
# /usr/local/bin/gtar: avahi-0.6.31/po/en_GB.po: Cannot hard link to
#     `avahi-0.6.31/po/en_NZ.po': Operation not permitted
NO_SYSTRACE=	Yes
@


1.76
log
@Minor update to avahi-0.6.31.
@
text
@d1 8
a8 1
# $OpenBSD: Makefile,v 1.75 2012/02/20 18:01:19 espie Exp $
a63 2
TAR=		${LOCALBASE}/bin/gtar

d66 4
a69 1
		archivers/gtar
@


1.75
log
@mark -mono as IGNORED until mono builds with rthreads.
okay aja, sthen
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.74 2011/12/17 22:01:13 sthen Exp $
d14 1
a14 1
V=		0.6.30
a26 9
REVISION-main=	6
REVISION-gtk=	4
REVISION-gtk3=	2
REVISION-gui=	2
REVISION-mono=	3
REVISION-qt3=	3
REVISION-qt4=	3
REVISION-ui=	1

d114 1
a114 1
		avahi-glib ffi ${MODGETTEXT_WANTLIB}
d130 1
a130 1
WANTLIB-gtk3 += xcb-shm z ffi ${MODGETTEXT_WANTLIB}
d149 1
a149 1
WANTLIB-gui += pthread-stubs xcb xcb-render xcb-shm z ffi
@


1.74
log
@Where a program with an rc script _requires_ a certain command line
parameter to daemonize, move the parameter from daemon to daemon_flags,
so that the user cannot inadvertently prevent it from daemonizing by
adjusting the flags.

Discussed with ajacoutot and schwarze, this method was suggested
by schwarze@@ as a simpler alternative to my diff. ok aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.73 2011/11/11 11:39:52 espie Exp $
d35 2
@


1.73
log
@okay, net/avahi,no_gui,no_mono,no_qt3,no_qt4,bootstrap
is required for bootstrap
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.72 2011/10/17 10:03:51 espie Exp $
d27 1
a27 1
REVISION-main=	5
@


1.72
log
@use bsd.port.arch.mk
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.71 2011/10/17 06:41:43 ajacoutot Exp $
d56 2
a57 2
PSEUDO_FLAVORS=	no_gui no_mono no_qt3 no_qt4
FLAVOR?=	no_gui no_mono no_qt3 no_qt4
@


1.71
log
@WANTLIB.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.70 2011/10/11 16:03:45 espie Exp $
d3 1
a3 1
ONLY_FOR_ARCHS-mono=	i386 amd64
d59 1
a59 1
MULTI_PACKAGES=	-main
d79 5
a83 8
BUILD_MONO = No
.if !${FLAVOR:L:Mno_mono}
MULTI_PACKAGES+= -mono
.  for _a in ${MACHINE_ARCH} ${ARCH}
.    if ${ONLY_FOR_ARCHS-mono:M${_a}}
BUILD_MONO = Yes
.    endif
.  endfor
d86 1
a86 1
.if ${BUILD_MONO:L} == "yes"
d91 1
a91 1
		net/avahi,-gtk,no_qt3,no_qt4 \
d100 1
a100 1
.if !${FLAVOR:L:Mno_gui} || ${BUILD_MONO:L} == "yes"
a108 1
MULTI_PACKAGES+= -gtk
d111 1
a111 1
		net/avahi
d113 1
a113 1
		net/avahi,-ui,no_mono,no_qt3,no_qt4
a124 1
MULTI_PACKAGES+= -gtk3
d127 1
a127 1
		net/avahi
d129 1
a129 1
		net/avahi,-ui,no_mono,no_qt3,no_qt4
a139 1
MULTI_PACKAGES+= -gui
d141 1
a141 1
		net/avahi,-gtk3,no_mono,no_qt3,no_qt4
a159 1
MULTI_PACKAGES+= -ui
d161 1
a161 1
RUN_DEPENDS-ui= net/avahi
d169 1
d172 1
a172 1
.if !${FLAVOR:L:Mno_qt3}
a173 1
MULTI_PACKAGES+= -qt3
d177 1
a177 1
		net/avahi
d187 1
a187 1
.if !${FLAVOR:L:Mno_qt4}
a188 1
MULTI_PACKAGES+= -qt4
d192 1
a192 1
		net/avahi
@


1.70
log
@won't work without bsd.port.arch.mk, so later
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.69 2011/10/02 15:27:31 ajacoutot Exp $
d29 2
a30 2
REVISION-gtk3=	1
REVISION-gui=	1
d142 1
a142 1
WANTLIB-gtk3 += xcb-shm z ffi kvm ${MODGETTEXT_WANTLIB}
d162 1
a162 1
WANTLIB-gui += pthread-stubs xcb xcb-render xcb-shm z ffi kvm
@


1.69
log
@Use MONO_ARCHS.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.68 2011/09/30 12:29:54 ajacoutot Exp $
d3 1
a3 1
ONLY_FOR_ARCHS-mono=	${MONO_ARCHS}
@


1.68
log
@Just use gtar to extract instead of doing the post-extract danse.
Regen WANTLIB while here.
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.67 2011/09/16 11:13:37 espie Exp $
a77 3

# keep in sync with lang/mono/mono.port.mk
ONLY_FOR_ARCHS-mono = i386 amd64
@


1.67
log
@normalize pkgpath
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.66 2011/07/20 08:45:00 ajacoutot Exp $
d25 8
a32 8
REVISION-main=	4
REVISION-gtk=	3
REVISION-gtk3=	0
REVISION-gui=	0
REVISION-mono=	2
REVISION-qt3=	2
REVISION-qt4=	2
REVISION-ui=	0
d62 2
d65 2
a66 1
		devel/gobject-introspection
d69 1
a69 1
		gthread-2.0 gdbm daemon dbus-1 \
d126 1
a126 1
		avahi-glib ${MODGETTEXT_WANTLIB}
d143 1
a143 1
WANTLIB-gtk3 += xcb-shm z ${MODGETTEXT_WANTLIB}
d163 1
a163 1
WANTLIB-gui += pthread-stubs xcb xcb-render xcb-shm z
d190 1
a190 1
		Xdamage Xxf86vm drm
a249 4

post-extract:
	find ${WRKDIR} -type d -name PaxHeaders.\* | \
		xargs rm -r
@


1.66
log
@MESSAGE -> README
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.65 2011/07/14 18:48:15 ajacoutot Exp $
d25 8
a32 5
REVISION-main=	3
REVISION-gtk=	2
REVISION-mono=	1
REVISION-qt3=	1
REVISION-qt4=	1
@


1.65
log
@Rework this port so that -gtk and -gtk3 does not need to depend on the
entire universe (yes gtk3 support has been added).
There are dragons in this port, I'm that close to remove the shit from
the tree...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.64 2011/06/22 15:27:55 shadchin Exp $
d25 1
a25 1
REVISION-main=	2
@


1.64
log
@fix build. don't touch man/Makefile.*

ok ajacoutot@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.63 2011/06/17 08:43:06 landry Exp $
d4 3
a6 1
COMMENT-gtk=	GUI client utilities for avahi
d10 1
d18 2
d23 1
d25 5
a29 5
REVISION-main=	1
REVISION-gtk=	1
REVISION-mono=	0
REVISION-qt3=	0
REVISION-qt4=	0
d51 2
a52 2
PSEUDO_FLAVORS=	no_gtk no_mono no_qt3 no_qt4
FLAVOR?=	no_gtk no_mono no_qt3 no_qt4
a58 2
USE_GROFF =	Yes

d98 2
a99 3
.if !${FLAVOR:L:Mno_gtk} || ${BUILD_MONO:L} == "yes"
SHARED_LIBS +=  avahi-ui             0.0      # .1.0
MULTI_PACKAGES+= -gtk
d104 4
d109 1
d111 2
a112 6
RUN_DEPENDS-gtk= ${MODPY_RUN_DEPENDS} \
		lang/python/${MODPY_VERSION},-gdbm \
		x11/py-gtk2 \
		x11/dbus-python \
		devel/py-twisted/web \
		devel/desktop-file-utils
d114 1
a114 1
		Xi Xinerama Xrandr Xrender atk-1.0 c cairo dbus-1 \
d120 45
a164 1
		avahi-core avahi-glib ${MODGETTEXT_WANTLIB}
d166 2
a167 1
CONFIGURE_ARGS+= -disable-gtk \
d233 1
a233 2
		--disable-doxygen-html \
		--disable-gtk3
@


1.63
log
@s/REVISI0N/REVISION/.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62 2011/06/13 07:11:30 ajacoutot Exp $
d205 1
a205 1
	find ${WRKSRC}/man -type f | xargs \
@


1.62
log
@Reorder PLIST+bump.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.61 2011/06/13 07:04:11 ajacoutot Exp $
d19 1
a19 1
REVISI0N-main=	1
@


1.61
log
@Simplify this port, remove useless patches.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.60 2011/06/08 18:00:49 jasper Exp $
d19 2
a20 2
REVISI0N-main=	0
REVISION-gtk=	0
@


1.60
log
@bump after default python version switch
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59 2011/06/02 17:09:32 kili Exp $
a28 2
SHARED_LIBS +=  avahi-qt3            0.0      # .1.2
SHARED_LIBS +=  avahi-qt4            0.0      # .1.2
a32 1
SHARED_LIBS +=  avahi-ui             0.0      # .1.0
d95 1
d125 1
d141 1
d159 1
a159 1
AUTOCONF_VERSION= 2.68
d161 1
a161 1
CONFIGURE_STYLE=autoconf no-autoheader
a172 2
		--with-autoipd-user=_avahi-autoipd \
		--with-autoipd-group=_avahi-autoipd \
d174 1
a174 1
		--with-distro=openbsd \
d180 1
a189 3

# XXX
CONFIGURE_ARGS+=--disable-autoipd
@


1.59
log
@--disable-silent-rules is now added to CONFIGURE_ARGS per default,
if CONFIGURE_STYLE = gnu.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2011/05/12 05:54:16 ajacoutot Exp $
d18 6
@


1.58
log
@Use proper AUTOCONF_VERSION, from Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.57 2011/05/01 17:56:46 ajacoutot Exp $
a175 1
		--disable-silent-rules \
@


1.57
log
@Add proper AUTOCONF_VERSION, from Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2011/04/25 10:02:43 ajacoutot Exp $
d153 1
a153 2
# Should be 2.68
AUTOCONF_VERSION= 2.67
@


1.56
log
@Update to avahi-0.6.30.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55 2011/04/08 07:11:08 jasper Exp $
d153 2
a154 1
AUTOCONF_VERSION= 2.63
@


1.55
log
@missed bump in previous, spotted by landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.54 2011/04/07 08:25:35 ajacoutot Exp $
d9 1
a9 1
V=		0.6.28
a17 3

REVISION-main=	5
REVISION-mono=	0
@


1.54
log
@Add introspection support (needed for on-going GNOME 3 work).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2011/03/17 16:49:27 ajacoutot Exp $
d19 1
a19 1
REVISION-main=	4
@


1.53
log
@Remove all redirections -- rc.subr(8) now takes care of it.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.52 2011/03/03 10:18:53 jasper Exp $
d55 2
a56 1
BUILD_DEPENDS=	converters/xmltoman
d178 1
a183 1
		--disable-introspection \
@


1.52
log
@Security fix for CVE-2011-0634, CVE-2011-1002.
Avahi Empty UDP Packet Denial of Service Vulnerability.

From upstream git.

ok aja@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 2011/03/02 06:34:40 ajacoutot Exp $
d19 1
a19 1
REVISION-main=	3
@


1.51
log
@Mention that avahi needs a system-wide D-BUS daemon running.

Prodded by Markus Bergkvist.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2011/01/17 13:18:13 landry Exp $
d19 1
a19 1
REVISION-main=	2
@


1.50
log
@Switch back to autoconf 2.63, 2.65 is known for generating junk in
config.h like #define HAVE_ZOMG_ 1. Fixes build/packaging on hppa.
ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2011/01/16 16:44:27 ajacoutot Exp $
d19 1
a19 1
REVISION-main=	1
@


1.50.2.1
log
@Security fix for CVE-2011-0634, CVE-2011-1002.
Avahi Empty UDP Packet Denial of Service Vulnerability.

From upstream git.

ok aja@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2011/01/17 13:18:13 landry Exp $
d19 1
a19 1
REVISION-main=	2
@


1.49
log
@Better regex, with robert@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2011/01/16 15:39:04 ajacoutot Exp $
d155 1
a155 1
AUTOCONF_VERSION= 2.65
@


1.48
log
@Fix dll mappings.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2010/12/27 14:50:23 ajacoutot Exp $
d224 1
a224 1
		xargs perl -pi -e 's,\.so\.[0-9].[0-9],\.so,g;' -e 's,\.so\.[0-9],\.so,g'
@


1.47
log
@Simplify after recent rc.subr change.
The framework is now stable and we will start documenting it (at last).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2010/12/24 10:40:05 ajacoutot Exp $
d20 1
d222 1
a222 1
# DLLMAP_FILES won't work here since the files are generated during the build process
d224 1
a224 1
		xargs perl -pi -e 's,\.so\.[0-9]+,\.so,g'
@


1.46
log
@Cope with recent rc.subr changes.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2010/12/14 14:55:02 ajacoutot Exp $
d19 1
a19 1
REVISION-main=	0
@


1.45
log
@Bugfix update to avahi-0.6.28.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2010/11/30 16:37:21 ajacoutot Exp $
d18 2
@


1.44
log
@Quiet up reload/stop.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2010/11/19 22:31:32 espie Exp $
d9 1
a9 1
V=		0.6.27
a18 5
REVISION-main=	6
REVISION-gtk=	1
REVISION-qt3=	0
REVISION-qt4=	0

d55 1
a55 1
		gthread-2.0 gdbm  daemon dbus-1 \
d60 1
a60 1
		devel/libdaemon \
d110 1
a110 1
		xcb-render xcb-render-util avahi-client avahi-common \
d128 2
a129 1
		avahi-common stdc++ ${MODQT3_WANTLIB} ${MODGETTEXT_WANTLIB}
d140 2
a141 1
WANTLIB-qt4=	QtCore avahi-common m stdc++ ${MODGETTEXT_WANTLIB}
@


1.43
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2010/11/06 19:05:28 ajacoutot Exp $
d19 1
a19 1
REVISION-main=	5
@


1.42
log
@Remove duplicate WANTLIB.

from Charles Smith
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2010/11/06 16:07:00 espie Exp $
d57 1
a57 1
BUILD_DEPENDS=	::converters/xmltoman
d63 4
a66 4
		::devel/glib2 \
		::databases/gdbm \
		::devel/libdaemon \
		::x11/dbus
d84 1
a84 1
		::x11/mono-gtk2
d86 2
a87 2
		::net/avahi,-gtk,no_qt3,no_qt4 \
		::x11/mono-gtk2
d98 3
a100 3
BUILD_DEPENDS+=	:python-gdbm-*:lang/python/${MODPY_VERSION},-gdbm \
		::x11/py-gtk2 \
		::x11/dbus-python
d102 1
a102 1
		::net/avahi
d104 5
a108 5
		:python-gdbm-*:lang/python/${MODPY_VERSION},-gdbm \
		::x11/py-gtk2 \
		::x11/dbus-python \
		::devel/py-twisted/web \
		::devel/desktop-file-utils
d129 1
a129 1
		::net/avahi
d142 2
a143 2
		::x11/qt4 \
		::net/avahi
@


1.41
log
@move gettext to new WANTLIB
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2010/11/05 10:06:44 espie Exp $
d19 1
a19 1
REVISION-main=	4
d60 2
a61 2
		glib-2.0 gobject-2.0 gthread-2.0 gdbm \
		daemon dbus-1 ${MODGETTEXT_WANTLIB}
@


1.40
log
@convert qt3 to new style
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2010/10/29 12:54:43 ajacoutot Exp $
d61 1
a61 1
		daemon dbus-1
d115 2
a116 2
		xcb-render xcb-render-util avahi-client avahi-common avahi-core \
		avahi-glib
d133 1
a133 1
		avahi-common stdc++ ${MODQT3_WANTLIB}
d144 1
a144 1
WANTLIB-qt4=	QtCore avahi-common m stdc++
@


1.39
log
@Add RCS IDs to rc scripts.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2010/10/28 20:43:49 ajacoutot Exp $
a55 1
WANTLIB=	c expat glib-2.0 gobject-2.0 pcre pthread
d59 2
a60 1
WANTLIB-main=	${WANTLIB} glib-2.0 gobject-2.0 gthread-2.0 gdbm \
d133 1
a133 1
		avahi-common stdc++
@


1.38
log
@After discussion with robert and ingo, we are renaming the rc scripts from
dash to underscore so that we are consitent with the foo_bar_flags
variable.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2010/10/28 11:39:47 ajacoutot Exp $
d19 1
a19 1
REVISION-main=	3
@


1.37
log
@Add rc scripts for avahi-dnsconfd and avahi-daemon.

ok robert@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2010/10/24 21:30:01 ajacoutot Exp $
d19 1
a19 1
REVISION-main=	2
@


1.36
log
@Remove USE_X11.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2010/10/18 18:36:45 espie Exp $
d19 1
a19 1
REVISION-main=	1
@


1.35
log
@USE_GROFF=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2010/10/11 08:16:51 jasper Exp $
a149 1
USE_X11=	Yes
@


1.34
log
@- fix WANTLIB after cairo update.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2010/09/16 18:53:29 ajacoutot Exp $
d55 1
@


1.33
log
@Remove powerpc from mono supported arches.
It builds but there is no support for sigcontext and mono crashes right on
startup. No need to loose time building this...

input and ok robert@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2010/08/30 21:14:35 sthen Exp $
d20 1
a20 1
REVISION-gtk=	0
d111 1
a111 1
		gdk_pixbuf-2.0 gio-2.0 glib-2.0 glitz gmodule-2.0 \
@


1.32
log
@bumps for python
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2010/08/21 19:41:10 ajacoutot Exp $
d67 2
a68 1
ONLY_FOR_ARCHS-mono = i386 amd64 powerpc
@


1.31
log
@Add a patch from Debian bug #590760:
Let the client check if the daemon is already running instead of just
trying to start it, which doesn't work if there is no service file (the
service file is just meant for systems using system.d).

This fixes avahi-browse as well as "bonjour/zeroconf" support in several
applications.

Issue also pointed by Greg Jones.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2010/07/31 14:33:20 ajacoutot Exp $
d19 4
a22 1
REVISION-main=	0
@


1.30
log
@SECURITY update to avahi-0.6.27.
This is a bugfix release and fixes a minor security issue.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2010/07/17 14:12:38 ajacoutot Exp $
d18 2
@


1.30.2.1
log
@MFC:

- - -
date: 2010/08/21 19:41:10;  author: ajacoutot;  state: Exp;  lines: +3 -1
Add a patch from Debian bug #590760:
Let the client check if the daemon is already running instead of just
trying to start it, which doesn't work if there is no service file (the
service file is just meant for systems using system.d).

This fixes avahi-browse as well as "bonjour/zeroconf" support in several
applications.

Issue also pointed by Greg Jones.
- - -

ok ajacoutot
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2010/07/31 14:33:20 ajacoutot Exp $
d13 1
a13 1
PKGNAME-main=	avahi-${V}p0
@


1.29
log
@Update to avahi-0.6.26.
Lots of bugfixes. Refer to HOMEPAGE for detail information.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2010/07/12 22:07:37 sthen Exp $
d9 1
a9 1
V=		0.6.26
d179 2
a180 2
# don't link with libssp from gcc4; __guard and __stack_smash_handler
# are part of libc (see LIBS in CONFIGURE_ENV)
d193 1
a193 1
	find ${WRKSRC} -type d -name PaxHeaders.24570 | \
a194 1
	rm ${WRKSRC}/configure
@


1.28
log
@use REVISION, checked with before/after make show=PKGNAMES (plus some
extra-careful checking where there are complicated PSEUDO_FLAVORS).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2010/07/07 18:57:38 ajacoutot Exp $
d9 1
a9 6
V=		0.6.25
REVISION-main=	10
REVISION-gtk=	6
REVISION-mono=	5
REVISION-qt3=	3
REVISION-qt4=	2
d54 2
d57 4
a60 4
		glib-2.0.>=1800,gobject-2.0,gthread-2.0::devel/glib2 \
		gdbm::databases/gdbm \
		daemon::devel/libdaemon \
		dbus-1::x11/dbus
d95 1
a95 2
		avahi-client,avahi-common,avahi-core,avahi-glib::net/avahi \
		glade-2.0.>=1::devel/libglade2
d104 1
a104 1
		expat fontconfig freetype gdbm gdk-x11-2.0 \
d107 3
a109 2
		pangoft2-1.0 pcre pixman-1 png pthread pthread-stubs xcb xml2 z \
		xcb-render xcb-render-util
d122 1
a122 1
		avahi-common::net/avahi
d125 2
a126 1
		freetype jpeg lcms m mng png pthread-stubs xcb z
d135 3
a137 3
		QtCore.>=7::x11/qt4 \
		avahi-common::net/avahi
WANTLIB-qt4=
d149 1
a149 1
AUTOCONF_VERSION= 2.63
d151 1
a151 1
CONFIGURE_STYLE=autoconf
d171 1
d175 3
a177 1
		--disable-doxygen-html
d192 5
d201 2
a202 2
	perl -pi -e 's,/etc/avahi,${SYSCONFDIR}/avahi,g' \
		${WRKSRC}/man/*.*
@


1.27
log
@SECURITY.
Fix for CVE-2010-2244:
    zero size is reported for corrupt packets. recvmsg() later could
    nevertheless get data from a good packet that followed the bad one.
    So get out early to avoid hitting an assertion.

Thanks to pea@@ for the heads up.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2010/07/06 13:02:14 espie Exp $
d10 5
d18 5
a22 5
PKGNAME-main=	avahi-${V}p10
PKGNAME-gtk=	avahi-gtk-${V}p6
PKGNAME-mono=	mono-avahi-${V}p5
PKGNAME-qt3=	avahi-qt3-${V}p3
PKGNAME-qt4=	avahi-qt4-${V}p2
@


1.26
log
@use new subpackage-dependent ONLY_FOR_ARCHS
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2010/07/05 08:25:08 espie Exp $
d13 1
a13 1
PKGNAME-main=	avahi-${V}p9
@


1.25
log
@don't let packages vanish depending on arches. If they don't build, they
don't.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2010/07/05 06:15:23 ajacoutot Exp $
d60 3
d65 8
d86 1
a86 1
.if !${FLAVOR:L:Mno_gtk} || !${FLAVOR:L:Mno_mono}
@


1.24
log
@Tweak a comment.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2010/06/28 19:50:10 ajacoutot Exp $
d60 1
a60 5
# only enable the mono subpackage on supported mono arches
# see ONLY_FOR_ARCHS in lang/mono/mono.port.mk
.if ${MACHINE_ARCH} == "amd64" ||${MACHINE_ARCH} == "i386" \
 || ${MACHINE} == "powerpc"
. if !${FLAVOR:L:Mno_mono}
a69 4
. else
CONFIGURE_ARGS+= --disable-mono \
		--disable-monodoc
. endif
@


1.23
log
@Fix -mono dependency.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2010/06/28 19:30:13 ajacoutot Exp $
d61 1
a61 1
# see ONLY_FOR_ARCHS in lang/mono
@


1.22
log
@Fix the mono FLAVOR, it requires gtk.
While here, regen WANTLIB and file dllmap files.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2010/06/28 18:52:31 robert Exp $
d15 1
a15 1
PKGNAME-mono=	mono-avahi-${V}p4
d70 1
a70 1
		::net/avahi,-main \
@


1.21
log
@revert previous commit
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2010/04/08 18:53:40 ajacoutot Exp $
d13 3
a15 3
PKGNAME-main=	avahi-${V}p8
PKGNAME-gtk=	avahi-gtk-${V}p5
PKGNAME-mono=	mono-avahi-${V}p3
d55 1
a55 1
		glib-2.0.>=1800,gobject-2.0::devel/glib2 \
d83 1
a83 1
.if !${FLAVOR:L:Mno_gtk}
d103 2
a104 1
		pangoft2-1.0 pcre pixman-1 png pthread pthread-stubs xcb xml2 z
d203 3
@


1.20
log
@bump pkgname
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2010/06/28 18:33:41 robert Exp $
d13 1
a13 1
PKGNAME-main=	avahi-${V}p9
d15 1
a15 1
PKGNAME-mono=	mono-avahi-${V}p4
@


1.19
log
@update mono-avahi
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2010/04/08 18:53:40 ajacoutot Exp $
d13 1
a13 1
PKGNAME-main=	avahi-${V}p8
@


1.18
log
@main is a SUBPACKAGE not a FLAVOR.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2010/04/08 14:21:24 ajacoutot Exp $
d15 1
a15 1
PKGNAME-mono=	mono-avahi-${V}p3
@


1.17
log
@Unfuck dependencies after recent mono MODULE changes and default no_* for
build. Before this change python and mono could end up being registered as
run_depends when they shouldn't.

with an input from naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2010/04/05 10:59:29 robert Exp $
d15 1
a15 1
PKGNAME-mono=	mono-avahi-${V}p2
d70 1
a70 1
		::net/avahi,main \
@


1.16
log
@bump pkgname of -mono subpackge because dep changes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2010/03/29 07:52:26 ajacoutot Exp $
d13 5
a17 5
PKGNAME-main=	avahi-${V}p7
PKGNAME-gtk=	avahi-gtk-${V}p4
PKGNAME-mono=	mono-avahi-${V}p1
PKGNAME-qt3=	avahi-qt3-${V}p2
PKGNAME-qt4=	avahi-qt4-${V}p1
d67 5
a71 2
BUILD_DEPENDS+=	::x11/mono-gtk2
RUN_DEPENDS-mono= ::x11/mono-gtk2
d92 2
a93 1
RUN_DEPENDS-gtk= :python-gdbm-*:lang/python/${MODPY_VERSION},-gdbm \
d138 3
@


1.15
log
@No need to specify the no_* FLAVOR for avahi, this is the default now.
naddy thinks there may be some gratuitous bumps but let's be safe.

reads good to sthen@@, ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2010/03/20 17:02:13 ajacoutot Exp $
d15 1
a15 1
PKGNAME-mono=	mono-avahi-${V}p0
@


1.14
log
@Tweak MESSAGE. Inspired by a question from giovanni@@

ok giovanni@@ jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2009/12/22 00:31:22 sthen Exp $
d13 1
a13 1
PKGNAME-main=	avahi-${V}p6
d43 1
a43 1
FLAVOR?=
d135 1
a135 1
AUTOCONF_VERSION= 2.62
@


1.13
log
@Use @@unexec-delete instead of @@unexec for the *-update-* goos.
prodded by espie@@
discussed with espie@@ ajacoutot@@ landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2009/10/13 21:15:57 jasper Exp $
d13 1
a13 1
PKGNAME-main=	avahi-${V}p5
@


1.13.2.1
log
@MFC:

SECURITY FIX only

Resolves CVE-2010-2244

ok ajacoutot
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2009/12/22 00:31:22 sthen Exp $
d13 1
a13 1
PKGNAME-main=	avahi-${V}p10
@


1.12
log
@fix build when mono-gtk2 isn't installed

ok aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2009/10/09 18:17:25 ajacoutot Exp $
d14 1
a14 1
PKGNAME-gtk=	avahi-gtk-${V}p3
@


1.11
log
@Only enable avahi,-mono on supported mono arches.
Pointed out by my personnal sword of damocles... aka sturm@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2009/10/09 17:36:20 ajacoutot Exp $
d15 1
a15 1
PKGNAME-mono=	mono-avahi-${V}
d67 2
a68 2
BUILD_DEPENDS+=	::lang/mono
RUN_DEPENDS-mono= ::lang/mono
@


1.10
log
@Add a mono bindings subpackage.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2009/10/04 07:48:37 ajacoutot Exp $
d60 20
a104 12
.endif

.if !${FLAVOR:L:Mno_mono}
MULTI_PACKAGES+= -mono
MODULES+=	lang/mono
BUILD_DEPENDS+=	::lang/mono
RUN_DEPENDS-mono= ::lang/mono
LIB_DEPENDS-mono= # empty
WANTLIB-mono=	# empty
.else
CONFIGURE_ARGS+= --disable-mono \
		--disable-monodoc
@


1.9
log
@Fix RUN_DEPENDS-gtk, it needs python-gdbm.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2009/08/10 06:33:43 kili Exp $
d5 1
d15 1
d42 1
a42 1
PSEUDO_FLAVORS=	no_gtk no_qt3 no_qt4
d87 12
a148 2
		--disable-mono \
		--disable-monodoc \
d163 4
d179 1
a179 1
	find ${WRKSRC} -name \*.pc.in -exec \
d181 1
a181 1
			-e 's,Cflags:,Cflags: -pthread,' {} \;
@


1.8
log
@WANTLIB changes after xcb addition and bump.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2009/06/26 22:12:20 ajacoutot Exp $
d13 1
a13 1
PKGNAME-gtk=	avahi-gtk-${V}p2
d67 3
a69 1
RUN_DEPENDS-gtk= ::devel/desktop-file-utils \
d71 1
a71 2
		::x11/py-gtk2 \
		::x11/dbus-python
@


1.7
log
@Several cleanups and fixes:
* add a couple of fixes from avahi trac
* advise users to enable multicast
* kill RTM_VERSION warning as advised by claudio@@
* disallow other stacks by default

ok naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2009/06/16 21:50:01 jasper Exp $
d13 2
a14 2
PKGNAME-gtk=	avahi-gtk-${V}p1
PKGNAME-qt3=	avahi-qt3-${V}p1
d76 1
a76 1
		pangoft2-1.0 pcre pixman-1 png pthread xml2 z
d92 1
a92 1
		freetype jpeg lcms m mng png z
@


1.6
log
@- fix potential 64-bit issue due to missing header

ok ajacoutot@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2009/06/06 18:36:43 ajacoutot Exp $
d12 4
a15 4
PKGNAME-main=	avahi-${V}p4
PKGNAME-gtk=	avahi-gtk-${V}p0
PKGNAME-qt3=	avahi-qt3-${V}p0
PKGNAME-qt4=	avahi-qt4-${V}p0
@


1.5
log
@- better patch; from pkgsrc
- allow other stacks by default
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2009/06/06 08:02:08 ajacoutot Exp $
d12 1
a12 1
PKGNAME-main=	avahi-${V}p3
@


1.4
log
@- don't force AF_INET if family is AF_UNSPEC
Should fix some discoveries / connection issues.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2009/06/04 21:42:40 ajacoutot Exp $
d12 1
a12 1
PKGNAME-main=	avahi-${V}p2
@


1.3
log
@- make this package use PSEUDO_FLAVORS so that one does not need to
build half of the ports tree just to build the main subpackage; this
change will also allow to fix the cyclic with gtk2-cups and qt-3+4
- move some files from -main to -gtk where they belong
- as a side note, only the -gtk subpackage is SHARED_ONLY now
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2009/06/03 19:42:55 ajacoutot Exp $
d12 1
a12 1
PKGNAME-main=	avahi-${V}p1
@


1.2
log
@- stop polluting syslog with useless messages we don't care nor can do
anything about
@
text
@d1 1
a1 4
# $OpenBSD: Makefile,v 1.1.1.1 2009/06/03 16:27:12 ajacoutot Exp $

# python MODULE
SHARED_ONLY=	Yes
d12 4
a15 4
PKGNAME-main=	avahi-${V}p0
PKGNAME-gtk=	avahi-gtk-${V}
PKGNAME-qt3=	avahi-qt3-${V}
PKGNAME-qt4=	avahi-qt4-${V}
d40 4
a43 1
MULTI_PACKAGES=	-main -gtk -qt3 -qt4
d46 1
a46 4
		lang/python \
		textproc/intltool \
		x11/qt3 \
		x11/qt4
d50 2
d58 4
a61 2
BUILD_DEPENDS=	::converters/xmltoman \
		:python-gdbm-*:lang/python/${MODPY_VERSION},-gdbm \
d64 3
a66 1

a70 5

LIB_DEPENDS-gtk= ${MODGETTEXT_LIB_DEPENDS} \
		avahi-client,avahi-common,avahi-core,avahi-glib::net/avahi \
		glade-2.0.>=1::devel/libglade2

d77 10
a86 1

d93 7
a99 1

d104 3
d120 1
a120 1
CONFIGURE_ARGS=	${CONFIGURE_SHARED} \
a133 2
		--enable-qt3 \
		--enable-qt4 \
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d15 1
a15 1
PKGNAME-main=	avahi-${V}
@


1.1.1.1
log
@Import avahi-0.6.25

Avahi is a free, standards-compliant implementation of the Zeroconf
protocols Multicast DNS and DNS-SD.
It is a system which facilitates service discovery on a local network.
This means that you can plug your laptop or computer into a network and
instantly be able to view other people who you can chat with, find
printers to print to or find files being shared.  This kind of
technology is already found in Apple MacOS X (branded Rendezvous,
Bonjour and sometimes Zeroconf) and is very convenient.

Completely reworked from an old submission from jasper@@
Based on FreeBSD and pkgsrc.

Some successful test from marco@@, thanks ;-)

It will probably need a bit more love in the next few days.
ok landry@@ jasper@@
@
text
@@
