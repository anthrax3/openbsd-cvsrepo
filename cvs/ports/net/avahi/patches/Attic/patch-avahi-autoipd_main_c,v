head	1.3;
access;
symbols
	OPENBSD_4_9:1.2.0.4
	OPENBSD_4_9_BASE:1.2
	OPENBSD_4_8:1.2.0.2
	OPENBSD_4_8_BASE:1.2
	OPENBSD_4_7:1.1.1.1.0.4
	OPENBSD_4_7_BASE:1.1.1.1
	OPENBSD_4_6:1.1.1.1.0.2
	OPENBSD_4_6_BASE:1.1.1.1
	ajacoutot_20090603:1.1.1.1
	ajacoutot:1.1.1;
locks; strict;
comment	@# @;


1.3
date	2011.06.13.07.04.11;	author ajacoutot;	state dead;
branches;
next	1.2;

1.2
date	2010.07.17.14.12.38;	author ajacoutot;	state Exp;
branches;
next	1.1;

1.1
date	2009.06.03.16.27.12;	author ajacoutot;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2009.06.03.16.27.12;	author ajacoutot;	state Exp;
branches;
next	;


desc
@@


1.3
log
@Simplify this port, remove useless patches.
@
text
@$OpenBSD: patch-avahi-autoipd_main_c,v 1.2 2010/07/17 14:12:38 ajacoutot Exp $
--- avahi-autoipd/main.c.orig	Fri Jun 25 21:12:15 2010
+++ avahi-autoipd/main.c	Mon Jul  5 12:02:37 2010
@@@@ -27,19 +27,26 @@@@
 #include <sys/ioctl.h>
 #include <sys/socket.h>
 #include <sys/wait.h>
-#ifdef __FreeBSD__
+#if defined(__FreeBSD__) || defined(__OpenBSD__)
 #include <sys/sysctl.h>
-#endif
+#endif /* __FreeBSD__ || __OpenBSD__ */
 
+#include <net/if.h>
+
 #ifdef __linux__
 #include <netpacket/packet.h>
-#endif
+#endif /* __linux__ */
+#if defined(__OpenBSD__)
+#include <netinet/in.h>
+#include <netinet/if_ether.h>
+#include <net/if_arp.h>
+#else
 #include <net/ethernet.h>
-#include <net/if.h>
-#ifdef __FreeBSD__
+#endif /* __OpenBSD__ */
+#if defined(__FreeBSD__) || defined(__OpenBSD__)
 #include <net/if_dl.h>
 #include <net/route.h>
-#endif
+#endif /* __FreeBSD__ || __OpenBSD__ */
 #include <arpa/inet.h>
 
 #include <assert.h>
@@@@ -62,7 +69,7 @@@@
 #include <pcap.h>
 
 /* Old versions of PCAP defined it as D_IN */
-#ifndef PCAP_D_IN
+#ifdef PCAP_D_IN
 #define PCAP_D_IN D_IN
 #endif
 
@


1.2
log
@Update to avahi-0.6.26.
Lots of bugfixes. Refer to HOMEPAGE for detail information.
@
text
@d1 1
a1 1
$OpenBSD: patch-avahi-autoipd_main_c,v 1.1.1.1 2009/06/03 16:27:12 ajacoutot Exp $
@


1.1
log
@Initial revision
@
text
@d1 4
a4 4
$OpenBSD$
--- avahi-autoipd/main.c.orig	Wed Jun 18 01:13:44 2008
+++ avahi-autoipd/main.c	Wed Jul  9 18:10:51 2008
@@@@ -29,19 +29,26 @@@@
d37 1
a37 1
@@@@ -64,7 +71,7 @@@@
a45 27
@@@@ -729,7 +736,7 @@@@ open_socket(int iface, uint8_t *hw_address)
 }
 
 static void
-close_socket(int fd __unused)
+close_socket(int fd)
 {
 
     assert(__pp != NULL);
@@@@ -742,7 +749,7 @@@@ close_socket(int fd __unused)
  * and prepend the required ethernet header information before sending.
  */
 static int
-send_packet(int fd __unused, int iface __unused, ArpPacket *packet,
+send_packet(int fd, int iface, ArpPacket *packet,
             size_t packet_len)
 {
     struct ether_header *eh;
@@@@ -759,7 +766,7 @@@@ send_packet(int fd __unused, int iface __unused, ArpPa
 }
 
 static int
-recv_packet(int fd __unused, ArpPacket **packet, size_t *packet_len)
+recv_packet(int fd, ArpPacket **packet, size_t *packet_len)
 {
     struct pcap_pkthdr      *ph;
     u_char                  *pd;
@


1.1.1.1
log
@Import avahi-0.6.25

Avahi is a free, standards-compliant implementation of the Zeroconf
protocols Multicast DNS and DNS-SD.
It is a system which facilitates service discovery on a local network.
This means that you can plug your laptop or computer into a network and
instantly be able to view other people who you can chat with, find
printers to print to or find files being shared.  This kind of
technology is already found in Apple MacOS X (branded Rendezvous,
Bonjour and sometimes Zeroconf) and is very convenient.

Completely reworked from an old submission from jasper@@
Based on FreeBSD and pkgsrc.

Some successful test from marco@@, thanks ;-)

It will probably need a bit more love in the next few days.
ok landry@@ jasper@@
@
text
@@
