head	1.1;
access;
symbols
	OPENBSD_4_6:1.1.0.4
	OPENBSD_4_5:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2009.10.16.03.26.45;	author william;	state dead;
branches
	1.1.2.1
	1.1.4.1;
next	;

1.1.2.1
date	2009.10.16.03.26.45;	author william;	state Exp;
branches;
next	;

1.1.4.1
date	2009.11.02.02.16.36;	author william;	state Exp;
branches;
next	;


desc
@@


1.1
log
@file patch-lib_silcclient_client_entry_c was initially added on branch OPENBSD_4_5.
@
text
@@


1.1.4.1
log
@SECURITY FIX

Format string fixes from 1.1.8 as well as the post-1.1.8 fixes added by
sthen@@ to -current.
@
text
@a0 43
Security fix:

Resolves string format vulnerability in client entry handling.


$OpenBSD$
--- lib/silcclient/client_entry.c.orig	Sat Dec 13 15:30:25 2008
+++ lib/silcclient/client_entry.c	Thu Oct 15 00:02:10 2009
@@@@ -801,10 +801,10 @@@@ SilcClientEntry silc_client_add_client(SilcClient clie
 		      client_entry->server, sizeof(client_entry->server));
   if (nickname && client->internal->params->full_nicknames)
     silc_snprintf(client_entry->nickname, sizeof(client_entry->nickname),
-		  nickname);
+		  "%s", nickname);
   else if (nickname)
     silc_snprintf(client_entry->nickname, sizeof(client_entry->nickname),
-		  parsed);
+		  "%s", parsed);
 
   silc_parse_userfqdn(username, client_entry->username,
 		      sizeof(client_entry->username),
@@@@ -900,10 +900,10 @@@@ void silc_client_update_client(SilcClient client,
 			client_entry->server, sizeof(client_entry->server));
     if (client->internal->params->full_nicknames)
       silc_snprintf(client_entry->nickname, sizeof(client_entry->nickname),
-		    nickname);
+		    "%s", nickname);
     else
       silc_snprintf(client_entry->nickname, sizeof(client_entry->nickname),
-		    parsed);
+		    "%s", parsed);
 
     /* Normalize nickname */
     nick = silc_identifier_check(parsed, strlen(parsed),
@@@@ -1206,7 +1206,7 @@@@ SilcClientEntry silc_client_nickname_format(SilcClient
         return NULL;
 
       silc_snprintf(client_entry->nickname, sizeof(client_entry->nickname),
-		    cp);
+		    "%s", cp);
       silc_free(cp);
     }
 
@


1.1.2.1
log
@SECURITY FIX

Format string fixes from 1.1.8 as well as the post-1.1.8 fixes added by
sthen@@ to -current.

ok Brad
@
text
@a0 43
Security fix:

Resolves string format vulnerability in client entry handling.


$OpenBSD$
--- lib/silcclient/client_entry.c.orig	Sat Dec 13 15:30:25 2008
+++ lib/silcclient/client_entry.c	Thu Oct 15 00:02:10 2009
@@@@ -801,10 +801,10 @@@@ SilcClientEntry silc_client_add_client(SilcClient clie
 		      client_entry->server, sizeof(client_entry->server));
   if (nickname && client->internal->params->full_nicknames)
     silc_snprintf(client_entry->nickname, sizeof(client_entry->nickname),
-		  nickname);
+		  "%s", nickname);
   else if (nickname)
     silc_snprintf(client_entry->nickname, sizeof(client_entry->nickname),
-		  parsed);
+		  "%s", parsed);
 
   silc_parse_userfqdn(username, client_entry->username,
 		      sizeof(client_entry->username),
@@@@ -900,10 +900,10 @@@@ void silc_client_update_client(SilcClient client,
 			client_entry->server, sizeof(client_entry->server));
     if (client->internal->params->full_nicknames)
       silc_snprintf(client_entry->nickname, sizeof(client_entry->nickname),
-		    nickname);
+		    "%s", nickname);
     else
       silc_snprintf(client_entry->nickname, sizeof(client_entry->nickname),
-		    parsed);
+		    "%s", parsed);
 
     /* Normalize nickname */
     nick = silc_identifier_check(parsed, strlen(parsed),
@@@@ -1206,7 +1206,7 @@@@ SilcClientEntry silc_client_nickname_format(SilcClient
         return NULL;
 
       silc_snprintf(client_entry->nickname, sizeof(client_entry->nickname),
-		    cp);
+		    "%s", cp);
       silc_free(cp);
     }
 
@

