head	1.1;
branch	1.1.1;
access;
symbols
	OPENBSD_6_1:1.1.1.1.0.14
	OPENBSD_6_1_BASE:1.1.1.1
	OPENBSD_6_0:1.1.1.1.0.12
	OPENBSD_6_0_BASE:1.1.1.1
	OPENBSD_5_9:1.1.1.1.0.8
	OPENBSD_5_9_BASE:1.1.1.1
	OPENBSD_5_8:1.1.1.1.0.10
	OPENBSD_5_8_BASE:1.1.1.1
	OPENBSD_5_7:1.1.1.1.0.6
	OPENBSD_5_7_BASE:1.1.1.1
	OPENBSD_5_6:1.1.1.1.0.4
	OPENBSD_5_6_BASE:1.1.1.1
	OPENBSD_5_5:1.1.1.1.0.2
	OPENBSD_5_5_BASE:1.1.1.1
	stsp_15082013:1.1.1.1
	stsp:1.1.1;
locks; strict;
comment	@# @;


1.1
date	2013.08.15.21.55.20;	author stsp;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2013.08.15.21.55.20;	author stsp;	state Exp;
branches;
next	;


desc
@@



1.1
log
@Initial revision
@
text
@$OpenBSD$
--- src/libretroshare/src/util/rsthreads.h.orig	Fri Mar 22 18:28:57 2013
+++ src/libretroshare/src/util/rsthreads.h	Mon Aug 12 23:04:14 2013
@@@@ -42,10 +42,15 @@@@ class RsMutex
 
 	RsMutex(const std::string& name)
 	{
+		pthread_mutexattr_t attr;
+
 		/* remove unused parameter warnings */
 		(void) name;
 
-		pthread_mutex_init(&realMutex, NULL);
+		pthread_mutexattr_init(&attr);
+		pthread_mutexattr_settype(&attr, PTHREAD_MUTEX_RECURSIVE);
+		pthread_mutex_init(&realMutex, &attr);
+		pthread_mutexattr_destroy(&attr);
 #ifdef RSTHREAD_SELF_LOCKING_GUARD
 		_thread_id = 0 ;
 #endif
@


1.1.1.1
log
@Import RetroShare.

  RetroShare is an Open Source, cross-platform, Friend-2-Friend, and
  secure decentralised communication platform. It lets you securely chat
  and share files with your friends and family, using a web-of-trust to
  authenticate peers and OpenSSL to encrypt all communication.  RetroShare
  provides filesharing, chat, messages, forums and channels.

For those among us who trust huge C++ behemoths with their privacy,
or have friends and family who need GUIs to contact us.

ok ajacoutot, librthread crash fix ack'd by guenther
@
text
@@
