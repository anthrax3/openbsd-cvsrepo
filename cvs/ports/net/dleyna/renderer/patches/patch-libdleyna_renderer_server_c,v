head	1.1;
branch	1.1.1;
access;
symbols
	OPENBSD_6_2:1.1.1.1.0.10
	OPENBSD_6_2_BASE:1.1.1.1
	OPENBSD_6_1:1.1.1.1.0.8
	OPENBSD_6_1_BASE:1.1.1.1
	OPENBSD_6_0:1.1.1.1.0.6
	OPENBSD_6_0_BASE:1.1.1.1
	OPENBSD_5_9:1.1.1.1.0.2
	OPENBSD_5_9_BASE:1.1.1.1
	OPENBSD_5_8:1.1.1.1.0.4
	OPENBSD_5_8_BASE:1.1.1.1
	ajacoutot_20150417:1.1.1.1
	ajacoutot:1.1.1;
locks; strict;
comment	@# @;


1.1
date	2015.04.17.18.39.00;	author ajacoutot;	state Exp;
branches
	1.1.1.1;
next	;
commitid	rBErTOavbpe1rMfc;

1.1.1.1
date	2015.04.17.18.39.00;	author ajacoutot;	state Exp;
branches;
next	;
commitid	rBErTOavbpe1rMfc;


desc
@@



1.1
log
@Initial revision
@
text
@$OpenBSD$

From 2f9fdf97082b63fcd0809905d29d0f8a49bb5c43 Mon Sep 17 00:00:00 2001
From: Debarshi Ray <debarshir@@freedesktop.org>
Date: Tue, 20 Jan 2015 11:20:07 +0100
Subject: [PATCH] [Server] Ensure that g_context.watchers has a valid value

--- libdleyna/renderer/server.c.orig	Sat Dec  6 12:52:28 2014
+++ libdleyna/renderer/server.c	Fri Apr 17 14:34:54 2015
@@@@ -688,7 +688,9 @@@@ static void prv_remove_client(const gchar *name)
 
 	dlr_upnp_lost_client(g_context.upnp, name);
 
-	g_context.watchers--;
+	if (g_context.watchers > 0)
+		g_context.watchers--;
+
 	if (g_context.watchers == 0)
 		if (!dleyna_settings_is_never_quit(g_context.settings))
 			dleyna_task_processor_set_quitting(g_context.processor);
@


1.1.1.1
log
@Import dleyna-core-0.5.0, dleyna-connector-dbus-0.2.0, dleyna-renderer-0.5.0,
       dleyna-server-0.5.0

dLeyna-core is a library of utility functions that are used by the
higher level dLeyna libraries that communicate with DLNA devices, e.g.,
dleyna-server.
<...>

ok jasper@@
@
text
@@
