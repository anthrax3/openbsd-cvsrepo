head	1.2;
access;
symbols;
locks; strict;
comment	@# @;


1.2
date	2008.02.16.10.56.41;	author rui;	state dead;
branches;
next	1.1;

1.1
date	2007.12.13.21.47.32;	author rui;	state Exp;
branches;
next	;


desc
@@


1.2
log
@- maintenance update to 0.2.2.
@
text
@$OpenBSD: patch-modules_download-ftp_CTRLDialogue_cpp,v 1.1 2007/12/13 21:47:32 rui Exp $
--- modules/download-ftp/CTRLDialogue.cpp.orig	Sat Dec  8 19:52:46 2007
+++ modules/download-ftp/CTRLDialogue.cpp	Sat Dec  8 19:57:35 2007
@@@@ -28,6 +28,7 @@@@
  /* $Id: patch-modules_download-ftp_CTRLDialogue_cpp,v 1.1 2007/12/13 21:47:32 rui Exp $ */
  
 #include <sys/types.h>
+#include <sys/param.h>
 #include <sys/socket.h>
 #include <netinet/in.h>
 #include <arpa/inet.h>
@@@@ -455,10 +456,17 @@@@ void CTRLDialogue::sendPort()
 	
 
 	asprintf(&nmsg,"PORT %d,%d,%d,%d,%d,%d\r\n",
+#if BYTE_ORDER == BIG_ENDIAN
+			(int32_t)(ip >> 24) & 0xff,
+			(int32_t)(ip >> 16) & 0xff,
+			(int32_t)(ip >> 8) & 0xff,
 			(int32_t)ip & 0xff,
+#else
+			(int32_t)ip & 0xff,
 			(int32_t)(ip >> 8) & 0xff,
 			(int32_t)(ip >> 16) & 0xff,
 			(int32_t)(ip >> 24) & 0xff,
+#endif
 			(int32_t)(port >> 8) & 0xff,
 			(int32_t)port & 0xff);
 	logDebug("FTPSEND: '%s'\n",nmsg);
@


1.1
log
@fix another endianness issue, found by Markus Lude
@
text
@d1 1
a1 1
$OpenBSD$
d5 1
a5 1
  /* $Id: CTRLDialogue.cpp 590 2006-07-09 18:35:30Z common $ */
@

