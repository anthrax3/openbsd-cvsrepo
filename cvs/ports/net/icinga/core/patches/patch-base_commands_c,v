head	1.2;
access;
symbols
	OPENBSD_6_0:1.2.0.6
	OPENBSD_6_0_BASE:1.2
	OPENBSD_5_9:1.2.0.2
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.2.0.4
	OPENBSD_5_8_BASE:1.2
	OPENBSD_5_7:1.1.0.2
	OPENBSD_5_7_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2015.03.30.22.43.42;	author sthen;	state Exp;
branches;
next	1.1;
commitid	2u23FDgXtDV7KYOv;

1.1
date	2015.01.16.18.07.53;	author sthen;	state Exp;
branches;
next	;
commitid	q2NJvo81Vp2JBe8l;


desc
@@


1.2
log
@update to icinga-1.13.0
@
text
@$OpenBSD: patch-base_commands_c,v 1.1 2015/01/16 18:07:53 sthen Exp $
--- base/commands.c.orig	Mon Mar 30 09:38:53 2015
+++ base/commands.c	Mon Mar 30 23:28:35 2015
@@@@ -3979,7 +3979,7 @@@@ void disable_all_notifications_expire_time(int cmd, ch
 	/* log that we will expire disabled notifications */
 	tm = localtime_r(&disable_notifications_expire_time, &tm_s);
 	strftime(temp_time, 80, "%c", tm);
-	logit(NSLOG_INFO_MESSAGE, TRUE, "Disabled Notifications will expire on %s (%lu).\n", temp_time, disable_notifications_expire_time);
+	logit(NSLOG_INFO_MESSAGE, TRUE, "Disabled Notifications will expire on %s (%lld).\n", temp_time, (long long)disable_notifications_expire_time);
 }
 
 /* enables notifications for a service */
@@@@ -5567,8 +5567,8 @@@@ void process_passive_checks(void) {
 			fprintf(checkresult_file_fp, "scheduled_check=0\n");
 			fprintf(checkresult_file_fp, "reschedule_check=0\n");
 			fprintf(checkresult_file_fp, "latency=%f\n", temp_pcr->latency);
-			fprintf(checkresult_file_fp, "start_time=%lu.%lu\n", temp_pcr->check_time, 0L);
-			fprintf(checkresult_file_fp, "finish_time=%lu.%lu\n", temp_pcr->check_time, 0L);
+			fprintf(checkresult_file_fp, "start_time=%lld.%lu\n", (long long)temp_pcr->check_time, 0L);
+			fprintf(checkresult_file_fp, "finish_time=%lld.%lu\n", (long long)temp_pcr->check_time, 0L);
 			fprintf(checkresult_file_fp, "return_code=%d\n", temp_pcr->return_code);
 			/* newlines in output are already escaped */
 			fprintf(checkresult_file_fp, "output=%s\n", (temp_pcr->output == NULL) ? "" : temp_pcr->output);
@


1.1
log
@Patch some of the format problems in icinga 1 due to 64-bit time_t,
as reported by otto@@. Build with -wformat to make the other two hundred
and ten of them more obvious.

(icinga2 doesn't have these problems, but we are stuck with an older
version of icinga2 as current versions fail at runtime on OpenBSD,
and a number of these problems affect the icinga1 cgis which are still
useful with 2).
@
text
@d1 4
a4 4
$OpenBSD$
--- base/commands.c.orig	Fri Jan 16 17:56:09 2015
+++ base/commands.c	Fri Jan 16 17:57:05 2015
@@@@ -3963,7 +3963,7 @@@@ void disable_all_notifications_expire_time(int cmd, ch
d13 1
a13 1
@@@@ -5551,8 +5551,8 @@@@ void process_passive_checks(void) {
@

