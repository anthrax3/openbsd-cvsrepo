head	1.94;
access;
symbols
	OPENBSD_6_2:1.94.0.4
	OPENBSD_6_2_BASE:1.94
	OPENBSD_6_1:1.94.0.2
	OPENBSD_6_1_BASE:1.94
	OPENBSD_6_0:1.92.0.2
	OPENBSD_6_0_BASE:1.92
	OPENBSD_5_9:1.91.0.2
	OPENBSD_5_9_BASE:1.91
	OPENBSD_5_8:1.89.0.4
	OPENBSD_5_8_BASE:1.89
	OPENBSD_5_7:1.84.0.2
	OPENBSD_5_7_BASE:1.84
	OPENBSD_5_6:1.77.0.2
	OPENBSD_5_6_BASE:1.77
	OPENBSD_5_5:1.55.0.2
	OPENBSD_5_5_BASE:1.55
	OPENBSD_5_4:1.50.0.2
	OPENBSD_5_4_BASE:1.50
	OPENBSD_5_3:1.40.0.2
	OPENBSD_5_3_BASE:1.40
	OPENBSD_5_2:1.30.0.2
	OPENBSD_5_2_BASE:1.30
	OPENBSD_5_1_BASE:1.19
	OPENBSD_5_1:1.19.0.2
	OPENBSD_5_0:1.13.0.2
	OPENBSD_5_0_BASE:1.13
	sthen20110328:1.1.1.1
	sthen:1.1.1;
locks; strict;
comment	@# @;


1.94
date	2017.02.07.21.40.06;	author sthen;	state Exp;
branches;
next	1.93;
commitid	iQN16kzb5VyI2vSI;

1.93
date	2017.02.07.21.20.38;	author sthen;	state Exp;
branches;
next	1.92;
commitid	FbaIRh1OtT1lWOa3;

1.92
date	2016.04.29.09.39.53;	author sthen;	state Exp;
branches
	1.92.2.1;
next	1.91;
commitid	o3vVqIkKP0pubivA;

1.91
date	2015.10.06.21.53.05;	author sthen;	state Exp;
branches;
next	1.90;
commitid	a3PXVqpR0xJ11x7Y;

1.90
date	2015.10.04.16.59.25;	author kirby;	state Exp;
branches;
next	1.89;
commitid	jyXg5IYIRIVMDB3z;

1.89
date	2015.07.15.20.10.58;	author sthen;	state Exp;
branches;
next	1.88;
commitid	hO5LZV7HnUgk3UjN;

1.88
date	2015.07.07.14.44.59;	author sthen;	state Exp;
branches;
next	1.87;
commitid	3ip2eKfpCQusYvJT;

1.87
date	2015.07.06.11.25.36;	author sthen;	state Exp;
branches;
next	1.86;
commitid	fXrDP8itzF5x6yPc;

1.86
date	2015.04.03.15.12.28;	author pascal;	state Exp;
branches;
next	1.85;
commitid	JXSUrm36AVfqKW5N;

1.85
date	2015.03.30.22.43.42;	author sthen;	state Exp;
branches;
next	1.84;
commitid	2u23FDgXtDV7KYOv;

1.84
date	2015.02.07.22.39.04;	author rpe;	state Exp;
branches;
next	1.83;
commitid	Q7FW75v8lSw6fW4k;

1.83
date	2015.02.04.21.19.23;	author sthen;	state Exp;
branches;
next	1.82;
commitid	0B2yafmlBXA1OhAt;

1.82
date	2015.01.19.16.59.42;	author sthen;	state Exp;
branches;
next	1.81;
commitid	hnaw0R5DdhiE0qFb;

1.81
date	2015.01.16.18.07.53;	author sthen;	state Exp;
branches;
next	1.80;
commitid	q2NJvo81Vp2JBe8l;

1.80
date	2014.11.21.14.06.26;	author sthen;	state Exp;
branches;
next	1.79;
commitid	cJpmfUCIvft4GGSI;

1.79
date	2014.09.03.11.55.55;	author sthen;	state Exp;
branches;
next	1.78;
commitid	ESkZ2uyXfUEkbxTK;

1.78
date	2014.08.11.18.34.59;	author sthen;	state Exp;
branches;
next	1.77;
commitid	FlyBWcy2A3bji8Gx;

1.77
date	2014.07.22.10.55.40;	author ajacoutot;	state Exp;
branches;
next	1.76;
commitid	3LzguPEQl5LkjlcD;

1.76
date	2014.07.19.22.36.13;	author ajacoutot;	state Exp;
branches;
next	1.75;
commitid	MSFt4PoL3vJ8bL97;

1.75
date	2014.07.12.11.22.10;	author sthen;	state Exp;
branches;
next	1.74;
commitid	gODVE8HvhOXSelog;

1.74
date	2014.07.10.12.58.31;	author ajacoutot;	state Exp;
branches;
next	1.73;
commitid	rOPyKbvHOk8hvFGm;

1.73
date	2014.06.20.13.13.54;	author sthen;	state Exp;
branches;
next	1.72;
commitid	ikEfXP8ihzznTrcQ;

1.72
date	2014.06.19.23.33.31;	author sthen;	state Exp;
branches;
next	1.71;
commitid	8Hk4nGNxJiBmD2Wz;

1.71
date	2014.06.10.21.54.03;	author sthen;	state Exp;
branches;
next	1.70;
commitid	f84IaYtGFKD2wF51;

1.70
date	2014.06.10.21.24.26;	author sthen;	state Exp;
branches;
next	1.69;
commitid	YKgYm26bYwDp4hrz;

1.69
date	2014.05.30.13.20.13;	author sthen;	state Exp;
branches;
next	1.68;

1.68
date	2014.05.29.00.19.54;	author sthen;	state Exp;
branches;
next	1.67;

1.67
date	2014.05.29.00.09.04;	author sthen;	state Exp;
branches;
next	1.66;

1.66
date	2014.05.29.00.05.48;	author sthen;	state Exp;
branches;
next	1.65;

1.65
date	2014.05.23.21.12.26;	author sthen;	state Exp;
branches;
next	1.64;

1.64
date	2014.05.21.23.37.55;	author sthen;	state Exp;
branches;
next	1.63;

1.63
date	2014.05.14.10.32.20;	author sthen;	state Exp;
branches;
next	1.62;

1.62
date	2014.05.10.22.15.38;	author sthen;	state Exp;
branches;
next	1.61;

1.61
date	2014.04.25.11.52.09;	author sthen;	state Exp;
branches;
next	1.60;

1.60
date	2014.04.07.12.32.23;	author sthen;	state Exp;
branches;
next	1.59;

1.59
date	2014.03.29.12.07.01;	author sthen;	state Exp;
branches;
next	1.58;

1.58
date	2014.03.26.12.09.28;	author sthen;	state Exp;
branches;
next	1.57;

1.57
date	2014.03.25.01.26.33;	author sthen;	state Exp;
branches;
next	1.56;

1.56
date	2014.03.20.16.25.21;	author sthen;	state Exp;
branches;
next	1.55;

1.55
date	2014.01.24.23.00.16;	author sthen;	state Exp;
branches
	1.55.2.1;
next	1.54;

1.54
date	2014.01.24.19.10.22;	author zhuk;	state Exp;
branches;
next	1.53;

1.53
date	2013.12.17.08.46.45;	author sthen;	state Exp;
branches;
next	1.52;

1.52
date	2013.11.07.11.23.00;	author sthen;	state Exp;
branches;
next	1.51;

1.51
date	2013.10.25.16.16.23;	author sthen;	state Exp;
branches;
next	1.50;

1.50
date	2013.07.12.16.07.08;	author sthen;	state Exp;
branches
	1.50.2.1;
next	1.49;

1.49
date	2013.07.05.07.44.59;	author jasper;	state Exp;
branches;
next	1.48;

1.48
date	2013.07.03.09.30.46;	author sthen;	state Exp;
branches;
next	1.47;

1.47
date	2013.05.22.21.17.13;	author sthen;	state Exp;
branches;
next	1.46;

1.46
date	2013.05.13.20.57.38;	author sthen;	state Exp;
branches;
next	1.45;

1.45
date	2013.05.07.15.34.47;	author sthen;	state Exp;
branches;
next	1.44;

1.44
date	2013.03.29.16.39.34;	author rpe;	state Exp;
branches;
next	1.43;

1.43
date	2013.03.11.11.35.47;	author espie;	state Exp;
branches;
next	1.42;

1.42
date	2013.03.06.18.34.58;	author zhuk;	state Exp;
branches;
next	1.41;

1.41
date	2013.03.02.12.42.33;	author sthen;	state Exp;
branches;
next	1.40;

1.40
date	2013.01.14.02.39.15;	author sthen;	state Exp;
branches;
next	1.39;

1.39
date	2012.12.27.14.51.54;	author rpe;	state Exp;
branches;
next	1.38;

1.38
date	2012.11.29.22.34.16;	author sthen;	state Exp;
branches;
next	1.37;

1.37
date	2012.10.25.18.42.32;	author sthen;	state Exp;
branches;
next	1.36;

1.36
date	2012.10.18.20.04.58;	author sthen;	state Exp;
branches;
next	1.35;

1.35
date	2012.10.17.09.33.06;	author sthen;	state Exp;
branches;
next	1.34;

1.34
date	2012.10.17.09.18.29;	author sthen;	state Exp;
branches;
next	1.33;

1.33
date	2012.10.12.17.59.25;	author rpe;	state Exp;
branches;
next	1.32;

1.32
date	2012.10.01.23.05.01;	author sthen;	state Exp;
branches;
next	1.31;

1.31
date	2012.09.02.11.55.11;	author sthen;	state Exp;
branches;
next	1.30;

1.30
date	2012.06.19.10.01.52;	author sthen;	state Exp;
branches
	1.30.2.1;
next	1.29;

1.29
date	2012.06.07.10.22.28;	author sthen;	state Exp;
branches;
next	1.28;

1.28
date	2012.05.27.19.42.42;	author sthen;	state Exp;
branches;
next	1.27;

1.27
date	2012.05.27.19.39.28;	author sthen;	state Exp;
branches;
next	1.26;

1.26
date	2012.05.27.09.49.49;	author sthen;	state Exp;
branches;
next	1.25;

1.25
date	2012.05.26.22.19.15;	author sthen;	state Exp;
branches;
next	1.24;

1.24
date	2012.05.19.10.47.10;	author sthen;	state Exp;
branches;
next	1.23;

1.23
date	2012.05.17.11.21.30;	author sthen;	state Exp;
branches;
next	1.22;

1.22
date	2012.05.17.11.05.40;	author sthen;	state Exp;
branches;
next	1.21;

1.21
date	2012.04.28.10.51.44;	author ajacoutot;	state Exp;
branches;
next	1.20;

1.20
date	2012.03.16.12.39.55;	author sthen;	state Exp;
branches;
next	1.19;

1.19
date	2011.12.17.22.01.13;	author sthen;	state Exp;
branches;
next	1.18;

1.18
date	2011.12.03.15.01.38;	author sthen;	state Exp;
branches;
next	1.17;

1.17
date	2011.11.16.15.56.37;	author robert;	state Exp;
branches;
next	1.16;

1.16
date	2011.09.22.15.25.28;	author sthen;	state Exp;
branches;
next	1.15;

1.15
date	2011.09.16.11.13.38;	author espie;	state Exp;
branches;
next	1.14;

1.14
date	2011.08.16.09.45.45;	author sthen;	state Exp;
branches;
next	1.13;

1.13
date	2011.07.08.22.31.59;	author robert;	state Exp;
branches;
next	1.12;

1.12
date	2011.07.08.02.14.59;	author ajacoutot;	state Exp;
branches;
next	1.11;

1.11
date	2011.07.01.16.57.41;	author sthen;	state Exp;
branches;
next	1.10;

1.10
date	2011.06.28.06.34.33;	author sthen;	state Exp;
branches;
next	1.9;

1.9
date	2011.06.08.16.18.57;	author sthen;	state Exp;
branches;
next	1.8;

1.8
date	2011.06.08.14.24.50;	author sthen;	state Exp;
branches;
next	1.7;

1.7
date	2011.06.02.19.48.17;	author sthen;	state Exp;
branches;
next	1.6;

1.6
date	2011.06.02.13.41.39;	author ajacoutot;	state Exp;
branches;
next	1.5;

1.5
date	2011.05.11.13.57.41;	author sthen;	state Exp;
branches;
next	1.4;

1.4
date	2011.05.11.12.03.19;	author jasper;	state Exp;
branches;
next	1.3;

1.3
date	2011.03.31.10.25.25;	author sthen;	state Exp;
branches;
next	1.2;

1.2
date	2011.03.28.19.51.59;	author sthen;	state Exp;
branches;
next	1.1;

1.1
date	2011.03.28.14.06.08;	author sthen;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2011.03.28.14.06.08;	author sthen;	state Exp;
branches;
next	;

1.30.2.1
date	2012.11.05.23.37.49;	author sthen;	state Exp;
branches;
next	1.30.2.2;

1.30.2.2
date	2013.01.14.12.25.23;	author sthen;	state Exp;
branches;
next	;

1.50.2.1
date	2013.12.20.19.29.04;	author jasper;	state Exp;
branches;
next	1.50.2.2;

1.50.2.2
date	2014.03.29.12.51.18;	author sthen;	state Exp;
branches;
next	;

1.55.2.1
date	2014.03.29.12.35.05;	author sthen;	state Exp;
branches;
next	1.55.2.2;

1.55.2.2
date	2014.05.28.22.56.31;	author sthen;	state Exp;
branches;
next	;

1.92.2.1
date	2017.02.07.21.40.55;	author sthen;	state Exp;
branches;
next	;
commitid	r8TFQ9HiWpm0NKrT;


desc
@@


1.94
log
@update to icinga 1.14.0

security fixes (also affecting nagios; icinga 1.x is the old nagios-derived
branch, whereas 2.x is all new) -

* Bug #13709: CVE-2016-9566: Root priviledge escalation during log file opening
* Bug #10453: Icinga Classic-UI 1.13.3 and older are vulnerable to XSS - CVE-2015-8010

notable changes -

* Classic UI: Remove attribute based authorization (cgiauth.cfg is not parsed
any more)
* IDO: Remove deprecated config options
@
text
@# $OpenBSD: Makefile,v 1.93 2017/02/07 21:20:38 sthen Exp $

COMMENT-main =		network monitoring system (improved fork of Nagios)
COMMENT-cgi =		cgi scripts for Icinga (classic Nagios-style UI)
COMMENT-ido =		store Icinga configuration and events in a database

GH_ACCOUNT =		Icinga
GH_PROJECT=		icinga-core
GH_TAGNAME =		v1.14.0
PKGNAME-main =		icinga-${GH_TAGNAME:S/v//}
PKGNAME-cgi =		icinga-cgi-${GH_TAGNAME:S/v//}
PKGNAME-ido =		icinga-idoutils-${GH_TAGNAME:S/v//}

WANTLIB =		c crypto m pthread ssl z

MULTI_PACKAGES =	-main -cgi -ido
PREFIX-cgi =		${VARBASE}/www
SUBST_VARS +=		PREFIX-cgi BASESYSCONFDIR

RUN_DEPENDS =		${BASE_PKGPATH},-main

WANTLIB-main =		${WANTLIB} ltdl>=4 perl
RUN_DEPENDS-main =	net/monitoring-plugins
LIB_DEPENDS-main =	devel/libtool,-ltdl

WANTLIB-ido =		${WANTLIB} dbi
LIB_DEPENDS-ido =	databases/libdbi
RUN_DEPENDS-ido =	${BASE_PKGPATH},-main \
			libdbi-drivers-mysql-*|libdbi-drivers-pgsql-*:databases/libdbi-drivers,-main

MODULES =		lang/php
USE_GMAKE =		Yes

# the cgi binaries are linked -static to simplify use in chroot,
# but listed as dependency anyway to help pkg_add -u find updates.
# these will show as "extra".
WANTLIB-cgi =		c m gd jpeg png z
LIB_DEPENDS-cgi =	graphics/gd
RUN_DEPENDS-cgi =

FAKE_FLAGS =		CFGDIR=${TRUEPREFIX}/share/examples/icinga

LOCALSTATEDIR =		${BASELOCALSTATEDIR}/icinga
SYSCONFDIR =		${BASESYSCONFDIR}/icinga

CONFIGURE_STYLE =	gnu
CONFIGURE_ARGS += \
	--datarootdir=${PREFIX-cgi}/icinga-cgi \
	--libexecdir=${PREFIX}/libexec/nagios \
	--sbindir=${PREFIX-cgi}/cgi-bin/icinga \
	--with-command-group=www \
	--with-cgiurl=/cgi-bin/icinga \
	--with-checkresult-dir=/var/spool/icinga \
	--with-htmurl=/icinga \
	--with-httpd-conf=${PREFIX-cgi}/conf/modules.sample \
	--with-httpd-conf-file=${PREFIX-cgi}/conf/modules.sample/icinga-cgi.conf.dist \
	--with-icinga-group=_icinga \
	--with-icinga-user=_icinga \
	--with-lockfile=/var/run/icinga/icinga.pid \
	--with-log-dir=/var/log/icinga \
	--with-p1-file-dir=${PREFIX}/bin \
	--enable-embedded-perl \
	--enable-ssl

CFLAGS +=	-Wformat -fPIC -I${LOCALBASE}/include \
		-L${X11BASE}/lib -L${LOCALBASE}/lib

INSTALL_TARGET = install-unstripped install-idoutils install-config \
		 install-webconf

# perl tests work; C tests fail if embedded-perl is enabled
TEST_TARGET = test
TEST_DEPENDS =	devel/p5-IPC-Run3 \
		devel/p5-Test-Most \
		www/p5-HTML-Lint

post-install:
	${INSTALL_DATA_DIR} ${WRKINST}${PREFIX-cgi}/conf/modules.sample
	cd ${PREFIX}/share; ${INSTALL_DATA_DIR} \
	    examples/icinga/db/{mysql,pgsql,queries,scripts} \
	    examples/icinga/updates doc/icinga
	cd ${WRKSRC}; ${INSTALL_DATA} README LICENSE UPGRADING \
	    Changelog Changelog_json ${PREFIX}/share/doc/icinga/
	${INSTALL_DATA} ${WRKSRC}/sample-config/updates/* \
	    ${WRKSRC}/module/idoutils/config/updates/* \
	    ${PREFIX}/share/examples/icinga/updates/
	cd ${WRKINST}${PREFIX-cgi}; \
	    chown -R ${SHAREOWN}:${SHAREGRP} icinga-cgi conf
	cd ${WRKSRC}/module/idoutils; \
	    pax -rw db ${PREFIX}/share/examples/icinga/
	chmod ${SHAREMODE} ${PREFIX}/share/examples/icinga/resource.cfg

.include <bsd.port.mk>
@


1.93
log
@Switch icinga/core to github-generated tarballs, the proper uploaded ones
have been removed. Based on a diff from kirby@@.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.92 2016/04/29 09:39:53 sthen Exp $
a6 1
V =			1.13.3
d9 1
a9 1
GH_TAGNAME =		v1.13.3
a12 1
REVISION-main =		2
d22 1
a22 1
WANTLIB-main =		${WANTLIB} ltdl>=4 perl util
@


1.92
log
@adjust icinga-web notes following apache1 removal
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.91 2015/10/06 21:53:05 sthen Exp $
d8 6
a13 4
DISTNAME =		icinga-$V
PKGNAME-main =		icinga-$V
PKGNAME-cgi =		icinga-cgi-$V
PKGNAME-ido =		icinga-idoutils-$V
a14 2

MASTER_SITES =	https://github.com/Icinga/icinga-core/releases/download/v$V/
@


1.92.2.1
log
@update to icinga 1.14.0

security fixes (also affecting nagios; icinga 1.x is the old nagios-derived
branch, whereas 2.x is all new) -

* Bug #13709: CVE-2016-9566: Root priviledge escalation during log file opening
* Bug #10453: Icinga Classic-UI 1.13.3 and older are vulnerable to XSS - CVE-2015-8010

notable changes -

* Classic UI: Remove attribute based authorization (cgiauth.cfg is not parsed
any more)
* IDO: Remove deprecated config options
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.94 2017/02/07 21:40:06 sthen Exp $
d7 8
a14 6
GH_ACCOUNT =		Icinga
GH_PROJECT=		icinga-core
GH_TAGNAME =		v1.14.0
PKGNAME-main =		icinga-${GH_TAGNAME:S/v//}
PKGNAME-cgi =		icinga-cgi-${GH_TAGNAME:S/v//}
PKGNAME-ido =		icinga-idoutils-${GH_TAGNAME:S/v//}
d24 1
a24 1
WANTLIB-main =		${WANTLIB} ltdl>=4 perl
@


1.91
log
@tweak README
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.90 2015/10/04 16:59:25 kirby Exp $
d12 1
a12 1
REVISION-main =		1
@


1.90
log
@fix rcctl syntax
ok sthen@@, maintainer
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.89 2015/07/15 20:10:58 sthen Exp $
d12 1
a12 1
REVISION-main =		0
@


1.89
log
@update to icinga 1.13.3
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.88 2015/07/07 14:44:59 sthen Exp $
d12 1
@


1.88
log
@use su -m instead of -s /bin/sh, suggested by millert
add some missing -c
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.87 2015/07/06 11:25:36 sthen Exp $
d7 1
a7 1
V =			1.13.0
a11 2
REVISION-cgi =		0
REVISION-main =		1
@


1.87
log
@Remove use of sudo from pkg READMEs in a few ports as packages and their
instructions are meant to work on a fresh install.

- easy cases: replace some '$ sudo somecommand' with '# somecommand'
(while there I've swapped some "${RCDIR}/foo start" with "rcctl foo start").

- replace some 'sudo -u user somecommand foo bar' with
'su -s /bin/sh user "/path/to/somecommand foo bar"' and similar.
Not pretty with the -s, but many of the uids that need to run
these commands have /sbin/nologin as their usual shell.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.86 2015/04/03 15:12:28 pascal Exp $
d13 1
a13 1
REVISION-main =		0
@


1.86
log
@Bumps for static PIE changes.

"just commit" naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.85 2015/03/30 22:43:42 sthen Exp $
d13 1
@


1.85
log
@update to icinga-1.13.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.84 2015/02/07 22:39:04 rpe Exp $
d12 1
@


1.84
log
@- Use rcctl(8) in commandline examples.
- Add a section how to setup icinga-cgi with httpd(8) and slowcgi(8).

OK sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.83 2015/02/04 21:19:23 sthen Exp $
d7 1
a7 1
V =			1.12.0
a11 1
REVISION =		2
@


1.83
log
@fix the remaining 63 time_t problems in Icinga idomod.c, and a typo in patch-cgi_cgiutils_c
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.82 2015/01/19 16:59:42 sthen Exp $
d12 1
a12 1
REVISION =		1
@


1.82
log
@more printf format string fixes for icinga (time_t issues on 32-bit arches)
the remaining 61 are all in idomod.c

presumably most/all of these also apply to nagios
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.81 2015/01/16 18:07:53 sthen Exp $
d12 1
a12 1
REVISION =		0
@


1.81
log
@Patch some of the format problems in icinga 1 due to 64-bit time_t,
as reported by otto@@. Build with -wformat to make the other two hundred
and ten of them more obvious.

(icinga2 doesn't have these problems, but we are stuck with an older
version of icinga2 as current versions fail at runtime on OpenBSD,
and a number of these problems affect the icinga1 cgis which are still
useful with 2).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.80 2014/11/21 14:06:26 sthen Exp $
d12 1
@


1.80
log
@update to icinga 1.12.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.79 2014/09/03 11:55:55 sthen Exp $
d66 1
a66 2
CFLAGS +=	-fPIC \
		-I${LOCALBASE}/include \
@


1.79
log
@update to icinga 1.11.7
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.78 2014/08/11 18:34:59 sthen Exp $
d7 1
a7 1
V =			1.11.7
@


1.78
log
@use the correct format string for time_t on i386, unbreaking logging there.
patch bodged into patch-configure for now, to be split out after full unlock.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.77 2014/07/22 10:55:40 ajacoutot Exp $
d7 1
a7 2
V =			1.11.5
REVISION =		4
@


1.77
log
@Tweak documentation according to recent rc changes.

ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.76 2014/07/19 22:36:13 ajacoutot Exp $
d8 1
a8 1
REVISION-main =		3
@


1.76
log
@/etc/rc.d -> ${RCDIR}
(as pedantic and useless as /usr/local vs LOCALBASE|PREFIX but well...)

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.75 2014/07/12 11:22:10 sthen Exp $
d8 1
a8 1
REVISION-main =		2
@


1.75
log
@don't use "echo 'pkg_scripts="${pkg_scripts} icinga' >> /etc/rc.conf.local"
examples

chase monitoring-plugins change (missed commit yesterday)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.74 2014/07/10 12:58:31 ajacoutot Exp $
d8 1
a8 1
REVISION-main =		1
@


1.74
log
@rc.conf.local is always under /etc.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.73 2014/06/20 13:13:54 sthen Exp $
d8 1
a13 2
REVISION-main=		0

d25 1
a25 1
RUN_DEPENDS-main =	net/nagios/plugins
@


1.73
log
@update to icinga 1.11.5

* classic-ui: fix status.cgi gets stuck in loop when sorting on "All Unhandled Problems" #5886 - RB
* classic ui: Only show command expander if backend is Icinga 1.x (incompatible with Icinga 2) #6408 - MF
* classic ui: Fix CSRF protection in cmd.cgi matches only compiled in URL #6459 - MF
* classic-ui: config.cgi missing new option #6502 - RB
* cgi.cfg: Add url_cgi_path allowing to override the default '$htmurl/cgi-bin' required for CSRF checks #6459
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.72 2014/06/19 23:33:31 sthen Exp $
d12 2
@


1.72
log
@reorder slightly, no pkg change
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.71 2014/06/10 21:54:03 sthen Exp $
d7 1
a7 4
V =			1.11.4
REVISION-main =		2
REVISION-ido =		0
REVISION-cgi =		1
@


1.71
log
@really bump REVISION-cgi
@
text
@d1 5
a5 1
# $OpenBSD: Makefile,v 1.70 2014/06/10 21:24:26 sthen Exp $
a10 5

COMMENT-main =		network monitoring system (improved fork of Nagios)
COMMENT-cgi =		cgi scripts for Icinga (classic Nagios-style UI)
COMMENT-ido =		store Icinga configuration and events in a database

@


1.70
log
@fix jquery-based options in the icinga-cgi package, found by florian@@;
missing file from PLIST-cgi since they now ship a minified version
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.69 2014/05/30 13:20:13 sthen Exp $
d5 2
a6 1
REVISION-cgi =		0
a15 2
REVISION-ido =		0
REVISION-cgi =		0
@


1.69
log
@bump ports which may have been installed when /var/www/modules.sample didn't
exist, to force an update to make sure that their config samples get installed
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.68 2014/05/29 00:19:54 sthen Exp $
d5 1
@


1.68
log
@handle /etc/localtime in chroot; pointed out by florian@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.67 2014/05/29 00:09:04 sthen Exp $
d4 1
a4 1
REVISION-main =		1
d14 2
@


1.67
log
@tweak README to point out that icinga-cgi and -web are in separate packages
and that one or both should be installed.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.66 2014/05/29 00:05:48 sthen Exp $
d4 1
a4 1
REVISION-main =		0
@


1.66
log
@update to icinga 1.11.4, and tweak README slightly relating to chroot for
icinga-web based on part of some comments from florian@@ and benno@@.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.65 2014/05/23 21:12:26 sthen Exp $
d4 1
@


1.65
log
@better permissions for resource.cfg
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.64 2014/05/21 23:37:55 sthen Exp $
d3 1
a3 3
V =			1.11.3
REVISION-main =		1
REVISION-ido =		0
@


1.64
log
@upstream packages were re-rolled (under the same filename :() to remove a
couple of bogus sql update files.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.63 2014/05/14 10:32:20 sthen Exp $
d4 2
a12 1
REVISION-main =		0
a14 1
REVISION-ido =		0
@


1.63
log
@fix another SYSCONFDIR/BASESYSCONFDIR problems in the README, reported by otto@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62 2014/05/10 22:15:38 sthen Exp $
d14 1
@


1.62
log
@update to icinga-1.11.3
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.61 2014/04/25 11:52:09 sthen Exp $
d11 1
@


1.61
log
@update to icinga-core 1.11.2, minor fixes

while there, fix linking some tests which need -lpthread on OpenBSD
(some others fail when --enable-embedded-perl is used)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.60 2014/04/07 12:32:23 sthen Exp $
d3 1
a3 1
V =			1.11.2
@


1.60
log
@bump; nagios-plugins -> monitoring-plugins
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59 2014/03/29 12:07:01 sthen Exp $
d3 1
a3 2
V =			1.11.1
REVISION-main =		0
d74 1
a74 2
# perl tests work; C tests require --enable-libtap in configure and
# fixing up WRKSRC/tap/configure
d76 3
a78 2
TEST_DEPENDS = devel/p5-IPC-Run3
# devel/p5-Test-Most
@


1.59
log
@update to Icinga 1.11.1, fixing CVE-2014-2386 in icinga-cgi (small buffer
overflows when checking strlen against MAX_INPUT_BUFFER) and a couple of
other minor issues
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2014/03/26 12:09:28 sthen Exp $
d4 1
@


1.58
log
@Add extra note in readme; new csrf protection needs disabling if using
external programs to access cmd.cgi (e.g. aNag - basic operation is still
OK but acknowledging alerts is blocked).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.57 2014/03/25 01:26:33 sthen Exp $
d3 1
a3 2
V =			1.11.0
REVISION-main =		0
@


1.57
log
@update to Icinga 1.11.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2014/03/20 16:25:21 sthen Exp $
d4 1
@


1.56
log
@nginx configuration instructions for icinga-cgi.
icinga-web is not yet covered.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55 2014/01/24 23:00:16 sthen Exp $
d3 1
a3 2
V =			1.10.2
REVISION-main =		1
d14 3
a16 1
WANTLIB =		c crypto m pthread ssl
@


1.55
log
@tweak previous: reorder REVISION, zap unnecessary comment.

this port has an active maintainer, how about sending diffs rather
than just committing?
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.54 2014/01/24 19:10:22 zhuk Exp $
d4 1
a4 1
REVISION-main =		0
@


1.55.2.1
log
@update Icinga in -stable to 1.10.4, fixing CVE-2014-2386 in icinga-cgi
(small buffer overflows when checking strlen against MAX_INPUT_BUFFER),
also some other hardening in icinga-cgi and other minor issues including
some problems with passive host checks and zombie avoidance for idoutils
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55 2014/01/24 23:00:16 sthen Exp $
d3 2
a4 1
V =			1.10.4
a13 2

MASTER_SITES =	https://github.com/Icinga/icinga-core/releases/download/v$V/
@


1.55.2.2
log
@MFC permission fix for resource.cfg; the commit "Fix packaging with too
paranoid sample config file mode" (PLIST-main 1.16) which was done to this
port shortly before release quietly stops the daemon running after a reload
(found the hard way by me) and testing config files (found by benno@@/florian@@).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55.2.1 2014/03/29 12:35:05 sthen Exp $
a3 1
REVISION-main =		0
@


1.54
log
@Fix packaging with too paranoid sample config file mode.

Pro-actively fixes the port before espie@@ commits his picky pkg_add patch.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2013/12/17 08:46:45 sthen Exp $
d4 1
a13 1
REVISION-main =		0
a92 1
	# no need to be paranoid for sample config
@


1.53
log
@SECURITY update to icinga 1.10.2;  (note for -stable, 1.9.4 fixes same issues)

CVE-2013-7106, CVE-2013-7107  https://dev.icinga.org/issues/5250
The icinga web gui is susceptible to several buffer overflow flaws,
which can be triggered as a logged on user. A remote attacker may
utilize a CSRF (cross site request forgery) attack vector against a
logged in user to exploit this flaw remotely.

CVE-2013-7108  https://dev.icinga.org/issues/5251
The icinga web gui are susceptible to an "off-by-one read" error
resulting from an improper assumption in the handling of user submitted
CGI parameters. [..] by sending a specially crafted cgi parameter,
the check routine can be forced to skip the terminating null pointer
and read the heap address right after the end of the parameter list.
Depending on the memory layout, this may result in a memory corruption
condition/crash or reading of sensitive memory locations.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.52 2013/11/07 11:23:00 sthen Exp $
d13 1
d93 2
@


1.52
log
@update to icinga 1.10.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 2013/10/25 16:16:23 sthen Exp $
d3 1
a3 1
V =			1.10.1
@


1.51
log
@update to icinga 1.10, for more information see
https://www.icinga.org/2013/10/24/icinga-1-10-released/

as mentioned in a new addition to the readme, icinga-web users may need to
clear their cache with /var/www/icinga-web/bin/clearcache.sh
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2013/07/12 16:07:08 sthen Exp $
d3 1
a3 1
V =			1.10.0
@


1.50
log
@icinga 1.9.3, fixes a regression in 1.9.2 with postgresql
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2013/07/05 07:44:59 jasper Exp $
d3 1
a3 1
V =			1.9.3
d32 1
@


1.50.2.1
log
@Security update of icinga to 1.9.4 which addresses CVE-2013-710{6,7,8}
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2013/07/12 16:07:08 sthen Exp $
d3 1
a3 1
V =			1.9.4
@


1.50.2.2
log
@update 5.4-stable to Icinga 1.9.6, fixing CVE-2014-2386 in icinga-cgi
(small buffer overflows when checking strlen against MAX_INPUT_BUFFER),
also some other hardening in icinga-cgi and other minor issues including
some problems with passive host checks
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50.2.1 2013/12/20 19:29:04 jasper Exp $
d3 1
a3 1
V =			1.9.6
a12 2

MASTER_SITES =	https://github.com/Icinga/icinga-core/releases/download/v$V/
@


1.49
log
@use ${VARBASE} instead of hardcoding /var
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2013/07/03 09:30:46 sthen Exp $
d3 1
a3 1
V =			1.9.2
@


1.48
log
@icinga 1.9.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2013/05/22 21:17:13 sthen Exp $
d17 1
a17 1
PREFIX-cgi =		/var/www
@


1.47
log
@bugfix update to Icinga 1.9.1; regression in 1.9.0 resulted in objects.cache
not being updated on core restart, also fixes JSON unicode character export in
the classic ui, and failure on core reload with multiple idomod neb modules.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2013/05/13 20:57:38 sthen Exp $
d3 1
a3 1
V =			1.9.1
@


1.46
log
@tweak CATEGORIES
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2013/05/07 15:34:47 sthen Exp $
d3 1
a3 2
V =			1.9.0
REVISION =		0
@


1.45
log
@Update to Icinga 1.9, thanks to rpe@@ for feedback and testing the beta.
Also thanks to Michael Friedrich (upstream) for sending out helpful notes
to package maintainers about changes in the release which may affect them,
we like projects who do that :)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2013/03/29 16:39:34 rpe Exp $
d4 1
@


1.44
log
@fix example to restart httpd in README

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2013/03/11 11:35:47 espie Exp $
d3 1
a3 1
V =			1.8.4
a10 1
REVISION-main =		1
a11 1
REVISION-cgi =		0
d55 1
a61 1
	--enable-idoutils \
d68 2
a69 2
INSTALL_TARGET = install-unstripped install-idoutils \
		install-config install-webconf
d88 1
a88 3
	mv conf/modules.sample/icinga.conf \
	    conf/modules.sample/icinga-cgi.conf.dist; \
	chown -R ${SHAREOWN}:${SHAREGRP} icinga-cgi conf
@


1.43
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2013/03/06 18:34:58 zhuk Exp $
d11 1
a11 1
REVISION-main =		0
@


1.42
log
@Change @@sample for archives directory as its place was changed somewhere
around 1.5.0.

okay sthen@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2013/03/02 12:42:33 sthen Exp $
d75 2
a76 2
REGRESS_TARGET = test
REGRESS_DEPENDS = devel/p5-IPC-Run3
@


1.41
log
@zap -no-pie stuff no longer needed for static bins.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2013/01/14 02:39:15 sthen Exp $
d11 1
@


1.40
log
@bugfix update to icinga 1.8.4; including SECURITY stack-based buffer
overflow in history.cgi from the classic cgi programs (CVE-2012-6096)
and some other minor fixes.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2012/12/27 14:51:54 rpe Exp $
d12 1
@


1.39
log
@- update icinga-core to 1.8.3
- update icinga-web to 1.8.1
- now, as the versions of icinga-core and icinga-web seem to diverge,
  move version information to the individual Makefiles in core/ and
  web/

ok sthen@@ (MAINTAINER)

Changes for icinga-core 1.8.3:
Bugs
* idoutils: fix unknown column contactaddress_id (thx fmbiete) #3483 - MF

Changes for icinga-web 1.8.1:
Bugs
    * Removed duplicate insert in sql upgrade scripts #3328
    * IE7 window fix for cronk save dialog
    * Disabled grouping of of unhandled problems grid #3320
    * Re-added missing command restriction class #3457
    * Removed ghost column after changing to new grid events #3458
    * Fixes PNP extension #3427
    * Removed flash for packaging and flash security fixes
    * Various custom cronk dialog fixes

Features
    * Allow xtypes in grid events to customize menues
    * Clearcache enhancements
    * Make ApiComboBox default for filters (Pagination)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2012/11/29 22:34:16 sthen Exp $
d3 1
a3 1
V =			1.8.3
@


1.38
log
@Bugfix update to Icinga 1.8.2, including
- fix bug in classic UI for ack's and notifications
- fix performance problem and some memory leaks with IDOUtils

https://wiki.icinga.org/display/Dev/Icinga+Core+Changelog#IcingaCoreChangelog-182-28112012

Also fix static cgi binaries on PIE architectures.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2012/10/25 18:42:32 sthen Exp $
d3 1
a3 1
V = 1.8.2
@


1.37
log
@bugfix update to Icinga 1.8.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2012/10/18 20:04:58 sthen Exp $
d3 1
a3 1
V = 1.8.1
@


1.36
log
@update Icinga to 1.8.0, testing (including icinga-web) and ok rpe@@

- slight tweaks to upgrade documentation while there; you should still
check the proper upgrade notes from upstream, but the README now points
idodb users at the actual location of the schema update files to save
a bit of hunting.
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.35 2012/10/17 09:33:06 sthen Exp $
@


1.35
log
@fix pgsql init scripts, pointed out by viq
@
text
@d1 1
a1 5
# $OpenBSD: Makefile,v 1.34 2012/10/17 09:18:29 sthen Exp $

REVISION-main =		3
REVISION-cgi =		0
REVISION-ido =		1
d77 8
a84 2
	${INSTALL_DATA_DIR} \
	    ${PREFIX}/share/examples/icinga/db/{mysql,pgsql,queries,scripts}
d90 1
a90 1
	pax -rw db ${PREFIX}/share/examples/icinga/
@


1.34
log
@Fix up some SYSCONFDIR/BASESYSCONFDIR problems. Pointed out by viq, thanks.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2012/10/12 17:59:25 rpe Exp $
d5 1
a5 1
REVISION-ido =		0
@


1.33
log
@icinga:
- attach icinga-web to build

icinga-core:
- bump REVISION for -main, -cgi and -ido
- remove CFGDIR, MAKE_FLAGS from Makefile which are relics
- replace /var/www with ${PREFIX-cgi}
- add instructions for icinga-web to README
- choose mysql by default

icinga-web:
- bump REVISION
- remove README, all instructions are in the icinga-core README
- remove comments about w.i.p
- choose mysql by default
- tell configure where to find icinga binary, icinga.cfg and the
  icinga objects dir
- add icinga, icinga-idoutils and bash to RUN_DEPENDS
- patch shells scripts to use the correct path for bash
- patch databases.xml.in to have both DBs enabled by default

with help and ok from sthen aja
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2012/10/01 23:05:01 sthen Exp $
d3 1
a3 1
REVISION-main =		2
d20 1
a20 1
SUBST_VARS +=		PREFIX-cgi
@


1.32
log
@typo in README; from viq
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2012/09/02 11:55:11 sthen Exp $
d3 3
a5 1
REVISION-main =		1
d31 1
a31 1
			libdbi-drivers-mysql-*|libdbi-drivers-pgsql-*:databases/libdbi-drivers,-pgsql
d49 1
a49 1
	--datarootdir=/var/www/icinga-cgi \
d51 1
a51 1
	--sbindir=/var/www/cgi-bin/icinga \
d56 1
a56 1
	--with-httpd-conf=/var/www/conf/modules.sample \
a69 2
CFGDIR =	${SYSCONFDIR}/icinga
MAKE_FLAGS =	CFGDIR=${CFGDIR} SYSCONFDIR=${CFGDIR}
@


1.31
log
@fix epn-related bug in icinga, patch from upstream
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2012/06/19 10:01:52 sthen Exp $
d3 1
a3 1
REVISION-main =		0
@


1.30
log
@update to Icinga 1.7.1; various minor fixes
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.29 2012/06/07 10:22:28 sthen Exp $
@


1.30.2.1
log
@update icinga in -stable to 1.7.2, fixes some scheduler bugs in 1.7.0/1.7.1.
@
text
@d1 1
a1 3
# $OpenBSD: Makefile,v 1.30 2012/06/19 10:01:52 sthen Exp $

REVISION-main =		0
@


1.30.2.2
log
@update icinga in -stable to 1.7.4; CVE-2012-6096 stack-based buffer overflow
in history.cgi
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.30.2.1 2012/11/05 23:37:49 sthen Exp $
@


1.29
log
@fix DESCR, icinga-web is not packaged yet. pointed out by henning@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2012/05/27 19:42:42 sthen Exp $
a8 2
REVISION =		4
REVISION-cgi =		5
@


1.28
log
@...and fix SYSCONFDIR in README, also from robert at peichaer / org..

so tempting to just put this back to the 'gnu old' way...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2012/05/27 19:39:28 sthen Exp $
d10 1
@


1.27
log
@fix rc scripts since SYSCONFDIR change; robert at peichaer / org
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2012/05/27 09:49:49 sthen Exp $
d9 1
a9 1
REVISION =		3
@


1.26
log
@Unbreak default configs following the localstatedir changes, problem
reported by robert at. peichaer org
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2012/05/26 22:19:15 sthen Exp $
d9 1
a9 1
REVISION =		2
@


1.25
log
@Put PLIST back into the correct order so /var/icinga is created with the
correct ownership. From robert at. peichaer dot. org
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2012/05/19 10:47:10 sthen Exp $
d9 1
a9 1
REVISION-main =		1
d42 1
a44 1
CONFIGURE_STYLE +=	old # don't override sysconfdir
a45 1
	--sysconfdir=${SYSCONFDIR}/icinga \
@


1.24
log
@use a homedir for _icinga's @@newuser line which actually exists.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2012/05/17 11:21:30 sthen Exp $
d9 1
a9 1
REVISION-main =		0
@


1.23
log
@remove not-yet-ported REGRESS_DEPENDS
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2012/04/28 10:51:44 ajacoutot Exp $
d9 1
@


1.22
log
@update to icinga 1.7.0 - IDO users note, as well as the usual DB upgrade
steps, edit icinga.cfg and change broker_module=/usr/local/bin/idomod.o
to broker_module=/usr/local/lib/idomod.so, this is also mentioned in the
README.

Notable fixes:
- flexible downtimes now last the duration specified once triggered
- avoid insane looping through event list when rescheduling checks
@
text
@d75 2
a76 2
REGRESS_DEPENDS = devel/p5-IPC-Run3 \
		devel/p5-Test-Most
@


1.21
log
@Use LOCALSTATEDIR.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2012/03/16 12:39:55 sthen Exp $
a8 1
REVISION-main =		1
d75 2
@


1.20
log
@Add a section to the README pointing to the upgrade documentation.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2011/12/17 22:01:13 sthen Exp $
d41 2
a48 1
	--localstatedir=/var/icinga \
@


1.19
log
@Where a program with an rc script _requires_ a certain command line
parameter to daemonize, move the parameter from daemon to daemon_flags,
so that the user cannot inadvertently prevent it from daemonizing by
adjusting the flags.

Discussed with ajacoutot and schwarze, this method was suggested
by schwarze@@ as a simpler alternative to my diff. ok aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2011/12/03 15:01:38 sthen Exp $
d9 1
a9 1
REVISION-main =		0
d13 2
d17 1
a18 1
WANTLIB =		c crypto m pthread ssl
@


1.18
log
@update to Icinga 1.6.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2011/11/16 15:56:37 robert Exp $
d9 1
@


1.17
log
@switch php to version 5.3 by default
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2011/09/22 15:25:28 sthen Exp $
a5 1
COMMENT-api =		database-backed API for icinga
a10 1
PKGNAME-api =		icinga-api-$V
d12 1
a12 3
REVISION =		0

MULTI_PACKAGES =	-main -cgi -api -ido
a13 1
PREFIX-api =		/var/www
a28 2
RUN_DEPENDS-api =	${MODPHP_RUN_DEPENDS}

d67 1
a67 1
		install-config install-webconf install-api
a77 1
	mv ${WRKINST}${PREFIX-cgi}/icinga-cgi/icinga-api .; \
d80 1
a80 1
	chown -R ${SHAREOWN}:${SHAREGRP} icinga-api icinga-cgi conf
@


1.16
log
@update to icinga 1.5.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2011/08/16 09:45:45 sthen Exp $
d13 2
@


1.15
log
@normalize pkgpath
@
text
@a13 5
REVISION-main =		3
REVISION-cgi =		1
REVISION-api =		2
REVISION-ido =		2

d59 2
@


1.14
log
@- fix typo in COMMENT-ido
- switch from apachectl stop && apachectl start to /etc/rc.d/httpd restart
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2011/07/08 22:31:59 robert Exp $
d14 3
a16 1
REVISION =		1
a17 1
REVISION-main =		2
@


1.13
log
@switch to lang/php
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2011/07/08 02:14:59 ajacoutot Exp $
d5 1
a5 1
COMMENT-ido =		sotre Icinga configuration and events in a database
d15 2
@


1.12
log
@rc_scripts -> pkg_scripts
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2011/07/01 16:57:41 sthen Exp $
d14 1
a14 1
REVISION-main = 	0
d29 1
a29 1
RUN_DEPENDS-ido =	${RUN_DEPENDS} \
d32 3
a34 2
WANTLIB-api =		# empty
RUN_DEPENDS-api =	www/php5/core
d41 1
@


1.11
log
@bugfix update to icinga 1.4.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2011/06/28 06:34:33 sthen Exp $
d13 2
@


1.10
log
@In the cgi, only permit a user to execute commands on an entire
hostgroup/servicegroup if authorized for every member of the group.
From upstream repo.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2011/06/08 16:18:57 sthen Exp $
a9 2
REVISION-main =		0
REVISION-cgi =		0
@


1.9
log
@fix sample directory ownerships, broken in last commit
spotted by pea@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2011/06/08 14:24:50 sthen Exp $
d11 1
@


1.8
log
@update to Icinga 1.4.1; bugfixes and minor improvements, rolls in XSS fix
we already had in a patch.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2011/06/02 19:48:17 sthen Exp $
d10 1
@


1.7
log
@Escape user-supplied URL parameter to avoid a cross-site scripting problem.
From upstream repo.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2011/06/02 13:41:39 ajacoutot Exp $
a9 1
REVISION-main = 	0
a10 1
REVISION-cgi =		1
@


1.6
log
@Add a consistent header that substitutes FULLPKGNAME for the READMEs.

ok jasper@@ sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2011/05/11 13:57:41 sthen Exp $
d10 1
d12 1
a14 2

REVISION-main = 	0
@


1.5
log
@- update Icinga to 1.4.0
- tweak @@extraunexec's
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2011/05/11 12:03:19 jasper Exp $
d13 2
@


1.4
log
@Sanitize some @@unexec/@@extraunexec calls to rm: move them up in the
PLIST and delete everything under the @@sample'd directory instead of the
directory itself to prevent a warning from pkg_delete(1) trying to
remove a non existing directory and to help preventing left-over files
and directories.

ok aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2011/03/31 10:25:25 sthen Exp $
a13 2
REVISION-main = 	0

d83 2
a84 8
	cd ${WRKSRC}/module/idoutils/db; \
	${INSTALL_DATA} README ${PREFIX}/share/examples/icinga/db
.for i in mysql pgsql queries
	${INSTALL_DATA} ${WRKSRC}/module/idoutils/db/$i/* \
	    ${PREFIX}/share/examples/icinga/db/$i
.endfor
	${INSTALL_SCRIPT} ${WRKSRC}/module/idoutils/db/scripts/* \
	    ${PREFIX}/share/examples/icinga/db/scripts; \
@


1.3
log
@maintenance update of icinga to 1.3.1, with a few small tweaks to the
port:

- fix icinga-api RUN_DEPENDS (idoutils need not be on the same
machine but it does need php).

- better log_archive_path

- we're building with embedded perl to make it easy to use if
wanted, but it's not suitable with all scripts, so in the default
configuration set use_embedded_perl_implicitly=0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2011/03/28 19:51:59 sthen Exp $
d13 2
@


1.2
log
@make the idoutils package more useful; tested with PostgreSQL.

- have idoutils depend on libdbi-drivers-mysql-*|libdbi-drivers-pgsql-*
with a default of pgsql if neither are installed

- install db build/upgrade scripts

- add an rc script for ido2db
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2011/03/28 14:06:08 sthen Exp $
a12 1
REVISION-ido =		0
d31 1
a31 2
RUN_DEPENDS-api =	${RUN_DEPENDS} \
			${BASE_PKGPATH},-ido
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.template,v 1.54 2008/01/13 16:43:57 espie Exp $
d13 1
d28 2
d78 2
a79 2
	mv ${WRKINST}${PREFIX-cgi}/icinga-cgi/icinga-api \
	    ${WRKINST}${PREFIX-cgi}/icinga-api
d81 1
d85 8
@


1.1.1.1
log
@Import ports/net/icinga (with -I !, so the 'core' directory doesn't
become cvs-food). See the README file for information about migrating
from Nagios with minimal config changes.

The icinga-web API-backed user interface is a work in progress
and not yet linked to the build; the core program and classic web
interface are perfectly usable.

Comments/ok from pea@@, thanks for testing!

-- -- --
Icinga monitors network resources such as servers, routers, switches,
applications and services and notifies administrators or responsible
persons. It's a fork of Nagios and supports its extensive pool of
monitoring plug-ins. Current status information, historical logs
and reports can all be accessed via a web browser.
-- -- --
@
text
@@
