head	1.31;
access;
symbols
	OPENBSD_6_2:1.31.0.6
	OPENBSD_6_2_BASE:1.31
	OPENBSD_6_1:1.31.0.4
	OPENBSD_6_1_BASE:1.31
	OPENBSD_6_0:1.31.0.2
	OPENBSD_6_0_BASE:1.31
	OPENBSD_5_9:1.30.0.2
	OPENBSD_5_9_BASE:1.30
	OPENBSD_5_8:1.28.0.4
	OPENBSD_5_8_BASE:1.28
	OPENBSD_5_7:1.26.0.2
	OPENBSD_5_7_BASE:1.26
	OPENBSD_5_6:1.25.0.2
	OPENBSD_5_6_BASE:1.25
	OPENBSD_5_5:1.14.0.2
	OPENBSD_5_5_BASE:1.14
	OPENBSD_5_4:1.13.0.2
	OPENBSD_5_4_BASE:1.13
	OPENBSD_5_3:1.11.0.2
	OPENBSD_5_3_BASE:1.11
	OPENBSD_5_2:1.7.0.2
	OPENBSD_5_2_BASE:1.7
	OPENBSD_5_1_BASE:1.4
	OPENBSD_5_1:1.4.0.2
	OPENBSD_5_0:1.3.0.2
	OPENBSD_5_0_BASE:1.3
	sthen20110328:1.1.1.1
	sthen:1.1.1;
locks; strict;
comment	@# @;


1.31
date	2016.04.29.09.39.54;	author sthen;	state Exp;
branches;
next	1.30;
commitid	o3vVqIkKP0pubivA;

1.30
date	2015.10.06.21.53.05;	author sthen;	state Exp;
branches;
next	1.29;
commitid	a3PXVqpR0xJ11x7Y;

1.29
date	2015.10.04.16.59.25;	author kirby;	state Exp;
branches;
next	1.28;
commitid	jyXg5IYIRIVMDB3z;

1.28
date	2015.07.07.14.44.59;	author sthen;	state Exp;
branches;
next	1.27;
commitid	3ip2eKfpCQusYvJT;

1.27
date	2015.07.06.11.25.36;	author sthen;	state Exp;
branches;
next	1.26;
commitid	fXrDP8itzF5x6yPc;

1.26
date	2015.02.07.22.39.04;	author rpe;	state Exp;
branches;
next	1.25;
commitid	Q7FW75v8lSw6fW4k;

1.25
date	2014.07.22.10.55.40;	author ajacoutot;	state Exp;
branches;
next	1.24;
commitid	3LzguPEQl5LkjlcD;

1.24
date	2014.07.19.22.36.13;	author ajacoutot;	state Exp;
branches;
next	1.23;
commitid	MSFt4PoL3vJ8bL97;

1.23
date	2014.07.12.11.22.10;	author sthen;	state Exp;
branches;
next	1.22;
commitid	gODVE8HvhOXSelog;

1.22
date	2014.07.10.12.58.31;	author ajacoutot;	state Exp;
branches;
next	1.21;
commitid	rOPyKbvHOk8hvFGm;

1.21
date	2014.05.29.00.19.54;	author sthen;	state Exp;
branches;
next	1.20;

1.20
date	2014.05.29.00.09.04;	author sthen;	state Exp;
branches;
next	1.19;

1.19
date	2014.05.29.00.05.48;	author sthen;	state Exp;
branches;
next	1.18;

1.18
date	2014.05.14.10.32.21;	author sthen;	state Exp;
branches;
next	1.17;

1.17
date	2014.03.29.12.07.01;	author sthen;	state Exp;
branches;
next	1.16;

1.16
date	2014.03.26.12.09.28;	author sthen;	state Exp;
branches;
next	1.15;

1.15
date	2014.03.20.16.25.21;	author sthen;	state Exp;
branches;
next	1.14;

1.14
date	2013.10.25.16.16.23;	author sthen;	state Exp;
branches;
next	1.13;

1.13
date	2013.05.07.15.34.47;	author sthen;	state Exp;
branches;
next	1.12;

1.12
date	2013.03.29.16.39.34;	author rpe;	state Exp;
branches;
next	1.11;

1.11
date	2012.10.18.20.04.58;	author sthen;	state Exp;
branches;
next	1.10;

1.10
date	2012.10.17.09.18.29;	author sthen;	state Exp;
branches;
next	1.9;

1.9
date	2012.10.12.17.59.25;	author rpe;	state Exp;
branches;
next	1.8;

1.8
date	2012.10.01.23.05.01;	author sthen;	state Exp;
branches;
next	1.7;

1.7
date	2012.05.27.19.42.42;	author sthen;	state Exp;
branches;
next	1.6;

1.6
date	2012.05.17.11.05.40;	author sthen;	state Exp;
branches;
next	1.5;

1.5
date	2012.03.16.12.39.56;	author sthen;	state Exp;
branches;
next	1.4;

1.4
date	2011.08.16.09.45.45;	author sthen;	state Exp;
branches;
next	1.3;

1.3
date	2011.07.08.02.14.59;	author ajacoutot;	state Exp;
branches;
next	1.2;

1.2
date	2011.06.02.13.41.39;	author ajacoutot;	state Exp;
branches;
next	1.1;

1.1
date	2011.03.28.14.06.08;	author sthen;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2011.03.28.14.06.08;	author sthen;	state Exp;
branches;
next	;


desc
@@


1.31
log
@adjust icinga-web notes following apache1 removal
@
text
@$OpenBSD: README-main,v 1.30 2015/10/06 21:53:05 sthen Exp $

+-----------------------------------------------------------------------
| Running ${FULLPKGNAME} on OpenBSD
+-----------------------------------------------------------------------

Getting Started
===============

The main documentation for Icinga is provided in HTML format as part of
the icinga-cgi package, see /var/www/icinga-cgi/docs/en/index.html
or at http://docs.icinga.org/latest/en/.

The included sample configuration carries out some simple checks
on the local machine; these should work as-is.

You may check your configuration file format before starting Icinga:

   # su -m _icinga -c "${TRUEPREFIX}/bin/icinga -v ${SYSCONFDIR}/icinga.cfg"

This will parse all configuration files and warn about any problems
which have been identified.

Use the rcctl command to enable automatic startup on boot for icinga

   # rcctl enable icinga

To start icinga, reboot or start it manually:

   # rcctl start icinga


Upgrading from a previous version
=================================

If you are using IDODB, you will need to update the database schema.
Typically you will just need to apply updates from
${TRUEPREFIX}/share/examples/icinga/db/<yourrdbms>/upgrade/, but
see ${PREFIX-cgi}/icinga-cgi/docs/en/upgrading_idoutils.html or
http://docs.icinga.org/latest/en/upgrading_idoutils.html for more
information.

If upgrading from IDODB 1.6.1 or earlier, update your broker_module
setting in ${SYSCONFDIR}/icinga.cfg; the plugin was renamed from
${TRUEPREFIX}/bin/idomod.o to ${TRUEPREFIX}/lib/idomod.so in 1.7.0.

If upgrading from an earlier version of icinga-web (the PHP API-based
web interface), you will need to apply updates to the icinga_web database
schema from /var/www/icinga-web/etc/schema/updates. You should also clear
the cache by running "/var/www/icinga-web/bin/clearcache.sh".

The 1.11.0 update enables CSRF protection for cmd.cgi by default;
if using external programs (like Nagstamon or aNag) to access the classic
UI, you may need to set disable_cmd_cgi_csrf_protection=1 in cgi.cfg.


Chroot Considerations
=====================

If you're using OpenBSD's default chroot environment for httpd or nginx
with the icinga-cgi package, some files will need to be moved inside the
jail and symbolic links created.

   mkdir -p ${PREFIX-cgi}/etc ${PREFIX-cgi}/var/log
   mv ${SYSCONFDIR} ${PREFIX-cgi}/etc/
   ln -s ${PREFIX-cgi}/etc/icinga ${BASESYSCONFDIR}
   mv /var/icinga ${PREFIX-cgi}/var/
   ln -s ${PREFIX-cgi}/var/icinga /var
   mv /var/log/icinga ${PREFIX-cgi}/var/log/
   ln -s ${PREFIX-cgi}/var/log/icinga /var/log

To display times in your local timezone, you will also need to provide
a suitable /var/www/etc/localtime; due to the chroot, a symbolic link cannot
be used here, instead the file can be copied:

   cp /usr/share/zoneinfo/Antarctica/South_Pole ${PREFIX-cgi}/etc/localtime

Web User-Interfaces
===================

Two web-based user interfaces are available for Icinga. They are provided
in their own packages; one or both must be installed separately ("pkg_add
icinga-cgi" or "pkg_add icinga-web").

1) icinga-cgi: the classic (but improved) Nagios-style interface

   httpd and nginx don't support CGI scripts directly; instead the slowcgi(8)
   wrapper must be used. Use the rcctl command to enable it at startup and
   reboot or start it manually:

      # rcctl enable slowcgi
      # rcctl start slowcgi

   For nginx, add a configuration section like this to /etc/nginx/nginx.conf:

   location /icinga/ {
	alias		/icinga-cgi/;
	satisfy		any;
	allow		127.0.0.1/32;
	allow		::1/128;
	auth_basic	"Icinga Access";
	auth_basic_user_file /etc/icinga/htpasswd.users;
   }
   location /cgi-bin/icinga/ {
	satisfy		any;
	allow		127.0.0.1/32;
	allow		::1/128;
	root		/;
	auth_basic	"Icinga Access";
	auth_basic_user_file /etc/icinga/htpasswd.users;
	try_files	$uri =404;
	fastcgi_pass	unix:run/slowcgi.sock;
	fastcgi_param	REMOTE_USER $remote_user;
	include		fastcgi_params;
   }

   The example above permits access from the local machine without password,
   and requires HTTP basic authentication from other locations.

   For httpd, add a configuration section like this to /etc/httpd.conf:

      location "/cgi-bin/icinga/*cgi" {
              fastcgi
              root "/"
              authenticate with "/etc/icinga/htpasswd.users"
      }

   And create a symbolic link in the htdocs directory:

      # ln -s ../icinga-cgi icinga

   The examples above require HTTP basic authentication. The password file can
   be created as follows:

      # htpasswd ${SYSCONFDIR}/htpasswd.users <username>

   When done, reload the web server:

      # rcctl reload nginx

      or

      # rcctl reload httpd

   You should then be able to access the web interface at
   http://localhost/icinga/


2) icinga-web: new API-based interface

   2.1) Setup the icinga database. For details see:
   ${TRUEPREFIX}/share/examples/icinga/db/README

   2.2) Enable the ido2db daemon. Add "ido2db" to the pkg_scripts line
   in /etc/rc.conf.local _before_ icinga.

   Afterwards, you can start it by rebooting, or manually:

      # rcctl start ido2db

   2.3) Enable the "broker_module=${TRUEPREFIX}/lib/idomod.so ..." line in
   ${SYSCONFDIR}/icinga.cfg and restart icinga:

      # rcctl restart icinga

   Now you should see in the icinga logfile, that icinga is storing
   information in the db.

   2.4) Setup the icinga_web database (change the password!):

      mysql -u root -p <<EOF
      CREATE DATABASE icinga_web;
      GRANT USAGE ON *.* TO 'icinga_web'@@'localhost'
         IDENTIFIED BY 'icinga_web_password';
      GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, ALTER, INDEX
         ON icinga_web.* TO 'icinga_web'@@'localhost';
      FLUSH PRIVILEGES;
      \u icinga_web
      \. /var/www/icinga-web/etc/schema/mysql.sql
      EOF

   2.5) Change the db settings accordingly for both icinga and for
   icinga_web in /var/www/icinga-web/etc/conf.d/databases.xml.

   2.6) Enable icinga-web for your web server. If using Apache, an
   httpd.conf snippet is provided and can be enabled as follows:

      # ln -s ../modules.sample/icinga-web.conf /var/www/conf/modules

   2.7) Currently, icinga-web is not tested to work in a web server chroot
   environment. You may have success by symlinking /var/www/var/www to
   /var/www (mkdir -p /var/www/var && ln -s ../.. /var/www/var/www).
   This topic will be revisited in a future version of this package.

   You should then be able to access the web interface at

      http://localhost/icinga-web/

   using user 'root' and 'password' as password. Change the default
   password in the preferences as soon as possible!.

   If you want to use the classic interface from within icinga-web
   you have to install the icinga-cgi package. The reporting component
   of icinga-web depends on external software which is not installed
   by default.


Moving from Nagios
==================

The configuration format is compatible with Nagios.  If you'd like
to move across with minimal changes, you can point Icinga at your existing
configuration files by adding the following to /etc/rc.conf.local:

	icinga_flags=-d ${BASESYSCONFDIR}/nagios/nagios.cfg

You will need to merge the settings between Nagios' and Icinga's cgi.cfg
files. sdiff(1) can help with this. main_config_file and some other settings
(admin usernames etc) should be taken from the Nagios file, whereas the
various web-related settings (url_html_path, physical_html_path, etc)
need to point to the Icinga files.
@


1.30
log
@tweak README
@
text
@d1 1
a1 1
$OpenBSD: README-main,v 1.29 2015/10/04 16:59:25 kirby Exp $
a150 5
** N.B. These icinga-web instructions have not yet been updated for use with
** with nginx; 2.6 and 2.7 below relate to use with the apache-httpd-openbsd
** package. Please contact the port maintainer if you can provide suitable
** configuration sections to use icinga-web with nginx.

d185 2
a186 1
   2.6) To enable icinga-web, link the provided httpd.conf snippet:
@


1.29
log
@fix rcctl syntax
ok sthen@@, maintainer
@
text
@d1 1
a1 1
$OpenBSD: README-main,v 1.28 2015/07/07 14:44:59 sthen Exp $
d222 4
a225 4
files. sdiff(1), as used by sysmerge(8), can help with this. main_config_file
and some other settings (admin usernames etc) should be taken from the
Nagios file, whereas the various web-related settings (url_html_path,
physical_html_path, etc) need to point to the Icinga files.
@


1.28
log
@use su -m instead of -s /bin/sh, suggested by millert
add some missing -c
@
text
@d1 1
a1 1
$OpenBSD: README-main,v 1.27 2015/07/06 11:25:36 sthen Exp $
d164 1
a164 1
      # rcctl ido2db start
d169 1
a169 1
      # rcctl icinga restart
@


1.27
log
@Remove use of sudo from pkg READMEs in a few ports as packages and their
instructions are meant to work on a fresh install.

- easy cases: replace some '$ sudo somecommand' with '# somecommand'
(while there I've swapped some "${RCDIR}/foo start" with "rcctl foo start").

- replace some 'sudo -u user somecommand foo bar' with
'su -s /bin/sh user "/path/to/somecommand foo bar"' and similar.
Not pretty with the -s, but many of the uids that need to run
these commands have /sbin/nologin as their usual shell.
@
text
@d1 1
a1 1
$OpenBSD: README-main,v 1.26 2015/02/07 22:39:04 rpe Exp $
d19 1
a19 1
   # su -s /bin/sh _icinga "${TRUEPREFIX}/bin/icinga -v ${SYSCONFDIR}/icinga.cfg"
@


1.26
log
@- Use rcctl(8) in commandline examples.
- Add a section how to setup icinga-cgi with httpd(8) and slowcgi(8).

OK sthen@@
@
text
@d1 1
a1 1
$OpenBSD: README-main,v 1.25 2014/07/22 10:55:40 ajacoutot Exp $
d19 1
a19 1
   $ sudo -u _icinga ${TRUEPREFIX}/bin/icinga -v ${SYSCONFDIR}/icinga.cfg
d26 1
a26 1
   $ sudo rcctl enable icinga
d30 1
a30 1
   $ sudo rcctl start icinga
d164 1
a164 1
      $ sudo ${RCDIR}/ido2db start
d169 1
a169 1
      $ sudo ${RCDIR}/icinga restart
d192 1
a192 1
      $ sudo ln -s ../modules.sample/icinga-web.conf /var/www/conf/modules
@


1.25
log
@Tweak documentation according to recent rc changes.

ok jasper@@
@
text
@d1 1
a1 1
$OpenBSD: README-main,v 1.24 2014/07/19 22:36:13 ajacoutot Exp $
d12 1
a12 1
or at http://docs.icinga.org/latest/en/. 
d24 3
a26 2
To enable automatic startup on boot for icinga, add it to the pkg_scripts
line in /etc/rc.conf.local.
d30 1
a30 1
   $ sudo ${RCDIR}/icinga start
d60 2
a61 2
If you're using OpenBSD's default chroot environment for nginx with
the icinga-cgi package, some files will need to be moved inside the
d87 3
a89 2
   nginx doesn't support CGI scripts directly; instead the slowcgi(8) wrapper
   must be used. Enable it at startup:
d91 2
a92 2
   # echo slowcgi_flags= >> /etc/rc.conf.local
   # /etc/rc.d/slowcgi start
d94 1
a94 1
   And add a configuration section like this to /etc/nginx/nginx.conf:
d118 16
a133 2
   and requires HTTP basic authentication from other locations. The password
   file can be created as follows:
d139 5
a143 1
      # /etc/rc.d/nginx reload
@


1.24
log
@/etc/rc.d -> ${RCDIR}
(as pedantic and useless as /usr/local vs LOCALBASE|PREFIX but well...)

ok sthen@@
@
text
@d1 1
a1 1
$OpenBSD: README-main,v 1.23 2014/07/12 11:22:10 sthen Exp $
d199 1
a199 1
	icinga_flags="-d ${BASESYSCONFDIR}/nagios/nagios.cfg"
@


1.23
log
@don't use "echo 'pkg_scripts="${pkg_scripts} icinga' >> /etc/rc.conf.local"
examples

chase monitoring-plugins change (missed commit yesterday)
@
text
@d1 1
a1 1
$OpenBSD: README-main,v 1.22 2014/07/10 12:58:31 ajacoutot Exp $
d29 1
a29 1
   $ sudo /etc/rc.d/icinga start
d144 1
a144 1
      $ sudo /etc/rc.d/ido2db start
d149 1
a149 1
      $ sudo /etc/rc.d/icinga restart
@


1.22
log
@rc.conf.local is always under /etc.
@
text
@d1 1
a1 1
$OpenBSD: README-main,v 1.21 2014/05/29 00:19:54 sthen Exp $
d24 2
a25 4
To enable automatic startup on boot for icinga, add it to pkg_scripts
in /etc/rc.conf.local, for example:

   pkg_scripts="${pkg_scripts} icinga"
d139 2
a140 4
   2.2) Enable the ido2db daemon. Add it to the pkg_scripts line
   in /etc/rc.conf.local before icinga, for example:

      pkg_scripts="${pkg_scripts} ido2db icinga"
d196 2
a197 2
to move across with minimal changes, you can point Icinga at your
existing configuration files:
d199 1
a199 2
	echo 'icinga_flags="-d ${BASESYSCONFDIR}/nagios/nagios.cfg"' >> /etc/rc.conf.local
	echo 'pkg_scripts="${pkg_scripts} icinga' >> /etc/rc.conf.local
@


1.21
log
@handle /etc/localtime in chroot; pointed out by florian@@
@
text
@d1 1
a1 1
$OpenBSD: README-main,v 1.20 2014/05/29 00:09:04 sthen Exp $
d25 1
a25 1
in ${BASESYSCONFDIR}/rc.conf.local, for example:
d142 1
a142 1
   in ${BASESYSCONFDIR}/rc.conf.local before icinga, for example:
@


1.20
log
@tweak README to point out that icinga-cgi and -web are in separate packages
and that one or both should be installed.
@
text
@d1 1
a1 1
$OpenBSD: README-main,v 1.19 2014/05/29 00:05:48 sthen Exp $
d73 5
@


1.19
log
@update to icinga 1.11.4, and tweak README slightly relating to chroot for
icinga-web based on part of some comments from florian@@ and benno@@.
@
text
@d1 1
a1 1
$OpenBSD: README-main,v 1.18 2014/05/14 10:32:21 sthen Exp $
d77 3
a79 1
Two web-based user interfaces are available for Icinga:
@


1.18
log
@fix another SYSCONFDIR/BASESYSCONFDIR problems in the README, reported by otto@@
@
text
@d1 1
a1 1
$OpenBSD: README-main,v 1.17 2014/03/29 12:07:01 sthen Exp $
d169 1
a169 2
      $ sudo ln -s /var/www/conf/modules.sample/icinga-web.conf \
         /var/www/conf/modules
d171 4
a174 5
   2.7) Currently, icinga-web is not tested to work with the httpd
   chroot environment. So before you start httpd, ensure that you've
   added "-u" to httpd_flags in /etc/rc.d/httpd.

      $ sudo /etc/rc.d/httpd start
@


1.17
log
@update to Icinga 1.11.1, fixing CVE-2014-2386 in icinga-cgi (small buffer
overflows when checking strlen against MAX_INPUT_BUFFER) and a couple of
other minor issues
@
text
@d1 1
a1 1
$OpenBSD: README-main,v 1.16 2014/03/26 12:09:28 sthen Exp $
d66 2
a67 2
   mv ${SYSCONFDIR}/icinga ${PREFIX-cgi}/etc/
   ln -s ${PREFIX-cgi}/etc/icinga ${SYSCONFDIR}
@


1.16
log
@Add extra note in readme; new csrf protection needs disabling if using
external programs to access cmd.cgi (e.g. aNag - basic operation is still
OK but acknowledging alerts is blocked).
@
text
@d1 1
a1 1
$OpenBSD: README-main,v 1.15 2014/03/20 16:25:21 sthen Exp $
d61 1
a61 1
If you're using OpenBSD's default chroot environment for httpd with
d201 5
a205 5
You will need to merge the settings between Nagios' and Icinga's
cgi.cfg files.  sdiff(1), as used by sysmerge(8), can help with this.
main_config_file and some other settings (admin usernames etc) should
be taken from the Nagios file, whereas the various web-related settings
(url_html_path, physical_html_path, etc) need to point to the Icinga files.
@


1.15
log
@nginx configuration instructions for icinga-cgi.
icinga-web is not yet covered.
@
text
@d1 1
a1 1
$OpenBSD: README-main,v 1.14 2013/10/25 16:16:23 sthen Exp $
d52 4
@


1.14
log
@update to icinga 1.10, for more information see
https://www.icinga.org/2013/10/24/icinga-1-10-released/

as mentioned in a new addition to the readme, icinga-web users may need to
clear their cache with /var/www/icinga-web/bin/clearcache.sh
@
text
@d1 1
a1 1
$OpenBSD: README-main,v 1.13 2013/05/07 15:34:47 sthen Exp $
d77 2
a78 1
   To enable icinga-cgi, link the provided httpd.conf snippet:
d80 2
a81 2
      $ sudo ln -s /var/www/conf/modules.sample/icinga-cgi.conf \
         /var/www/conf/modules
d83 1
a83 2
   You may wish to modify this file.  By default it uses HTTP basic
   authentication; you can create the password file as follows:
d85 24
a108 2
      $ sudo touch ${SYSCONFDIR}/htpasswd.users
      $ sudo htpasswd ${SYSCONFDIR}/htpasswd.users <username>
d110 1
a110 1
   When done, restart the web server:
d112 3
a114 1
      $ sudo /etc/rc.d/httpd restart
d121 5
@


1.13
log
@Update to Icinga 1.9, thanks to rpe@@ for feedback and testing the beta.
Also thanks to Michael Friedrich (upstream) for sending out helpful notes
to package maintainers about changes in the release which may affect them,
we like projects who do that :)
@
text
@d1 1
a1 1
$OpenBSD: README-main,v 1.12 2013/03/29 16:39:34 rpe Exp $
d50 2
a51 1
schema from /var/www/icinga-web/etc/schema/updates.
@


1.12
log
@fix example to restart httpd in README

ok sthen@@
@
text
@d1 1
a1 1
$OpenBSD: README-main,v 1.11 2012/10/18 20:04:58 sthen Exp $
d109 2
a110 2
   2.3) Enable the broker_module idomod.so in /etc/icinga/icinga.cfg
   and restart icinga:
@


1.11
log
@update Icinga to 1.8.0, testing (including icinga-web) and ok rpe@@

- slight tweaks to upgrade documentation while there; you should still
check the proper upgrade notes from upstream, but the README now points
idodb users at the actual location of the schema update files to save
a bit of hunting.
@
text
@d1 1
a1 1
$OpenBSD: README-main,v 1.10 2012/10/17 09:18:29 sthen Exp $
d89 1
a89 1
      $ sudo /rc.d/httpd restart
@


1.10
log
@Fix up some SYSCONFDIR/BASESYSCONFDIR problems. Pointed out by viq, thanks.
@
text
@d1 1
a1 1
$OpenBSD: README-main,v 1.9 2012/10/12 17:59:25 rpe Exp $
d33 1
d38 3
a40 1
See ${PREFIX-cgi}/icinga-cgi/docs/en/upgrading_idoutils.html or
d44 8
a51 3
In 1.7.0, the IDO plugin was renamed from ${TRUEPREFIX}/bin/idomod.o to
${TRUEPREFIX}/lib/idomod.so - change your broker_module setting in
${SYSCONFDIR}/icinga.cfg.
d67 1
@


1.9
log
@icinga:
- attach icinga-web to build

icinga-core:
- bump REVISION for -main, -cgi and -ido
- remove CFGDIR, MAKE_FLAGS from Makefile which are relics
- replace /var/www with ${PREFIX-cgi}
- add instructions for icinga-web to README
- choose mysql by default

icinga-web:
- bump REVISION
- remove README, all instructions are in the icinga-core README
- remove comments about w.i.p
- choose mysql by default
- tell configure where to find icinga binary, icinga.cfg and the
  icinga objects dir
- add icinga, icinga-idoutils and bash to RUN_DEPENDS
- patch shells scripts to use the correct path for bash
- patch databases.xml.in to have both DBs enabled by default

with help and ok from sthen aja
@
text
@d1 1
a1 1
$OpenBSD: README-main,v 1.8 2012/10/01 23:05:01 sthen Exp $
d25 1
a25 1
in ${SYSCONFDIR}/rc.conf.local, for example:
d43 1
a43 1
${SYSCONFDIR}/icinga/icinga.cfg.
d75 2
a76 2
      $ sudo touch ${SYSCONFDIR}/icinga/htpasswd.users
      $ sudo htpasswd ${SYSCONFDIR}/icinga/htpasswd.users <username>
d92 1
a92 1
   in ${SYSCONFDIR}/rc.conf.local before icinga, for example:
d155 1
a155 1
	echo 'icinga_flags="-d ${SYSCONFDIR}/nagios/nagios.cfg"' >> /etc/rc.conf.local
@


1.8
log
@typo in README; from viq
@
text
@d1 1
a1 1
$OpenBSD: README-main,v 1.7 2012/05/27 19:42:42 sthen Exp $
d12 1
d19 1
a19 1
	/usr/local/bin/icinga -v ${SYSCONFDIR}/icinga.cfg
d24 9
d48 11
a58 10
If using OpenBSD's default chroot environment for httpd, some files
will need to be moved inside the jail and symbolic links created:

	mkdir -p /var/www/etc /var/www/var/log
	mv ${SYSCONFDIR}/icinga /var/www/etc/
	ln -s /var/www/etc/icinga ${SYSCONFDIR}
	mv /var/icinga /var/www/var/
	ln -s /var/www/var/icinga /var
	mv /var/log/icinga /var/www/var/log/
	ln -s /var/www/var/log/icinga /var/log
d65 63
a127 2
- icinga-cgi: the classic (but improved) Nagios-style interface
- icinga-web: new API-based interface
d129 3
a131 3
At the time of writing, porting and packaging of icinga-web is
a work-in-progress.  To enable icinga-cgi, link the provided httpd.conf
snippet:
d133 1
a133 1
	ln -s ../modules.sample/icinga-cgi.conf /var/www/conf/modules
d135 1
a135 2
You may wish to modify this file.  By default it uses HTTP basic
authentication; you can create the password file as follows:
d137 1
a137 2
	touch ${SYSCONFDIR}/icinga/htpasswd.users
	htpasswd ${SYSCONFDIR}/icinga/htpasswd.users <username>
d139 2
a140 1
When done, restart the web server:
d142 4
a145 1
	/etc/rc.d/httpd restart
a146 2
You should then be able to access the web interface at
http://localhost/icinga/
@


1.7
log
@...and fix SYSCONFDIR in README, also from robert at peichaer / org..

so tempting to just put this back to the 'gnu old' way...
@
text
@d1 1
a1 1
$OpenBSD: README-main,v 1.6 2012/05/17 11:05:40 sthen Exp $
d54 1
a54 1
- icinga-cga: the classic (but improved) Nagios-style interface
@


1.6
log
@update to icinga 1.7.0 - IDO users note, as well as the usual DB upgrade
steps, edit icinga.cfg and change broker_module=/usr/local/bin/idomod.o
to broker_module=/usr/local/lib/idomod.so, this is also mentioned in the
README.

Notable fixes:
- flexible downtimes now last the duration specified once triggered
- avoid insane looping through event list when rescheduling checks
@
text
@d1 1
a1 1
$OpenBSD: README-main,v 1.5 2012/03/16 12:39:56 sthen Exp $
d18 1
a18 1
	/usr/local/bin/icinga -v ${SYSCONFDIR}/icinga/icinga.cfg
@


1.5
log
@Add a section to the README pointing to the upgrade documentation.
@
text
@d1 1
a1 1
$OpenBSD: README-main,v 1.4 2011/08/16 09:45:45 sthen Exp $
d30 4
@


1.4
log
@- fix typo in COMMENT-ido
- switch from apachectl stop && apachectl start to /etc/rc.d/httpd restart
@
text
@d1 1
a1 1
$OpenBSD: README-main,v 1.3 2011/07/08 02:14:59 ajacoutot Exp $
d22 8
@


1.3
log
@rc_scripts -> pkg_scripts
@
text
@d1 1
a1 1
$OpenBSD: README-main,v 1.2 2011/06/02 13:41:39 ajacoutot Exp $
d59 1
a59 2
	apachectl stop
	apachectl start
@


1.2
log
@Add a consistent header that substitutes FULLPKGNAME for the READMEs.

ok jasper@@ sthen@@
@
text
@d1 1
a1 1
$OpenBSD: README-main,v 1.1.1.1 2011/03/28 14:06:08 sthen Exp $
d73 1
a73 1
	echo 'rc_scripts="${rc_scripts} icinga' >> /etc/rc.conf.local
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
$OpenBSD$
d3 3
a5 2
Running ICINGA on OpenBSD
=========================
d8 1
a8 1
---------------
d24 1
a24 1
---------------------
d38 1
a38 1
-------------------
d66 1
a66 1
------------------
@


1.1.1.1
log
@Import ports/net/icinga (with -I !, so the 'core' directory doesn't
become cvs-food). See the README file for information about migrating
from Nagios with minimal config changes.

The icinga-web API-backed user interface is a work in progress
and not yet linked to the build; the core program and classic web
interface are perfectly usable.

Comments/ok from pea@@, thanks for testing!

-- -- --
Icinga monitors network resources such as servers, routers, switches,
applications and services and notifies administrators or responsible
persons. It's a fork of Nagios and supports its extensive pool of
monitoring plug-ins. Current status information, historical logs
and reports can all be accessed via a web browser.
-- -- --
@
text
@@
