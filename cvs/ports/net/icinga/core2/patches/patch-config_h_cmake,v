head	1.6;
access;
symbols
	OPENBSD_6_1:1.6.0.2
	OPENBSD_6_1_BASE:1.6
	OPENBSD_6_0:1.5.0.4
	OPENBSD_6_0_BASE:1.5
	OPENBSD_5_9:1.5.0.2
	OPENBSD_5_9_BASE:1.5
	OPENBSD_5_8:1.4.0.4
	OPENBSD_5_8_BASE:1.4
	OPENBSD_5_7:1.3.0.2
	OPENBSD_5_7_BASE:1.3
	OPENBSD_5_6:1.2.0.2
	OPENBSD_5_6_BASE:1.2;
locks; strict;
comment	@# @;


1.6
date	2017.02.02.21.36.18;	author sthen;	state Exp;
branches;
next	1.5;
commitid	KBZfhQxu073nU4eN;

1.5
date	2015.11.16.20.29.55;	author sthen;	state Exp;
branches;
next	1.4;
commitid	qYlDtork3dGtChXG;

1.4
date	2015.05.12.09.37.03;	author sthen;	state Exp;
branches;
next	1.3;
commitid	HpfUcqYDCTjXHiXR;

1.3
date	2014.11.22.00.13.03;	author sthen;	state Exp;
branches;
next	1.2;
commitid	nmet3xtaN5ESeGNI;

1.2
date	2014.06.25.11.14.50;	author sthen;	state Exp;
branches;
next	1.1;
commitid	jULsDe1DSTNLSLaL;

1.1
date	2014.06.24.16.51.35;	author sthen;	state Exp;
branches;
next	;
commitid	V36HVttV3iupUWj9;


desc
@@


1.6
log
@update to icinga2-2.6.1
@
text
@$OpenBSD: patch-config_h_cmake,v 1.5 2015/11/16 20:29:55 sthen Exp $

- use cmake's "find_package(Backtrace)" from FindBacktrace.cmake.
this covers the case of BSDs where the symbols are in libexecinfo.so
not in libc.

- compiled-in ICINGA_SYSCONFDIR needs to be the standard one (/etc),
but cmake should install files to an examples directory in our staging
dir (${PREFIX}/share/examples/icinga2), package tools copy them under
/etc at install time.

--- config.h.cmake.orig	Tue Jan 31 10:18:20 2017
+++ config.h.cmake	Thu Feb  2 14:06:02 2017
@@@@ -1,11 +1,10 @@@@
 #ifndef CONFIG_H
 #define CONFIG_H
 
-#cmakedefine HAVE_BACKTRACE_SYMBOLS
+#cmakedefine01 Backtrace_FOUND
 #cmakedefine HAVE_PIPE2
 #cmakedefine HAVE_VFORK
 #cmakedefine HAVE_DLADDR
-#cmakedefine HAVE_LIBEXECINFO
 #cmakedefine HAVE_CXXABI_H
 #cmakedefine HAVE_NICE
 #cmakedefine HAVE_EDITLINE
@@@@ -13,7 +12,7 @@@@
 #cmakedefine ICINGA2_UNITY_BUILD
 
 #define ICINGA_PREFIX "${CMAKE_INSTALL_PREFIX}"
-#define ICINGA_SYSCONFDIR "${CMAKE_INSTALL_FULL_SYSCONFDIR}"
+#define ICINGA_SYSCONFDIR "%SYSCONFDIR%"
 #define ICINGA_RUNDIR "${ICINGA2_RUNDIR}"
 #define ICINGA_LOCALSTATEDIR "${CMAKE_INSTALL_FULL_LOCALSTATEDIR}"
 #define ICINGA_PKGDATADIR "${CMAKE_INSTALL_FULL_DATADIR}/icinga2"
@


1.5
log
@update to Icinga 2 v2.4.0, featuring a new RESTful API using basic auth
or client certificates for:

- filters, types, permissions
- query/create/modify/delete config objects at runtime
- status queries for global stats
- actions (e.g. acknowledge all service problems)
- event streams
@
text
@d1 1
a1 1
$OpenBSD: patch-config_h_cmake,v 1.4 2015/05/12 09:37:03 sthen Exp $
d12 3
a14 3
--- config.h.cmake.orig	Mon Nov 16 09:57:03 2015
+++ config.h.cmake	Mon Nov 16 17:04:21 2015
@@@@ -1,12 +1,11 @@@@
d18 1
a19 2
 #cmakedefine HAVE_COUNTER_MACRO
-#cmakedefine HAVE_BACKTRACE_SYMBOLS
d27 1
a27 1
@@@@ -14,7 +13,7 @@@@
@


1.4
log
@update to icinga2 2.3.4. mark BROKEN until I can get some handle on what's
going on with daemonization (not backgrounding when expected) and hangs seen
in some cases.
@
text
@d1 15
a15 4
$OpenBSD: patch-config_h_cmake,v 1.3 2014/11/22 00:13:03 sthen Exp $
--- config.h.cmake.orig	Mon Apr 20 10:44:20 2015
+++ config.h.cmake	Mon Apr 20 16:11:52 2015
@@@@ -2,18 +2,17 @@@@
d18 1
d27 2
a28 2
+#cmakedefine01 Backtrace_FOUND
 
@


1.3
log
@update to icinga2 2.2.0
@
text
@d1 4
a4 4
$OpenBSD: patch-config_h_cmake,v 1.2 2014/06/25 11:14:50 sthen Exp $
--- config.h.cmake.orig	Mon Nov 17 09:52:21 2014
+++ config.h.cmake	Thu Nov 20 20:05:22 2014
@@@@ -2,13 +2,12 @@@@
d19 6
@


1.2
log
@s/BACKTRACE_/Backtrace_/ now the local file in cmake has been synced with the
cmake 3 version
@
text
@d1 4
a4 5
$OpenBSD: patch-config_h_cmake,v 1.1 2014/06/24 16:51:35 sthen Exp $
--- config.h.cmake.orig	Tue Jun 24 15:33:20 2014
+++ config.h.cmake	Tue Jun 24 16:42:24 2014
@@@@ -1,11 +1,10 @@@@
 #ifndef CONFIG_H
d7 1
d13 2
d17 2
a18 2
 #define ICINGA_PREFIX "${CMAKE_INSTALL_PREFIX}"
 #define ICINGA_SYSCONFDIR "${CMAKE_INSTALL_FULL_SYSCONFDIR}"
@


1.1
log
@pick up backtrace() functions from libexecinfo by using FindBacktrace.cmake

XXX comments because ports version of FindBacktrace uses BACKTRACE_ rather
than Backtrace_ as used in the version committed to cmake 3
@
text
@d1 1
a1 6
$OpenBSD$

XXX version in cmake 3 uses Backtrace_* in variable names, but version
in ports uses BACKTRACE_*. s/BACKTRACE_/Backtrace_/ when moving to the
committed version.

d13 1
a13 1
+#cmakedefine01 BACKTRACE_FOUND
@

