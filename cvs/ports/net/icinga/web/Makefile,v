head	1.35;
access;
symbols
	OPENBSD_6_0:1.34.0.2
	OPENBSD_6_0_BASE:1.34
	OPENBSD_5_9:1.33.0.2
	OPENBSD_5_9_BASE:1.33
	OPENBSD_5_8:1.31.0.4
	OPENBSD_5_8_BASE:1.31
	OPENBSD_5_7:1.29.0.2
	OPENBSD_5_7_BASE:1.29
	OPENBSD_5_6:1.26.0.2
	OPENBSD_5_6_BASE:1.26
	OPENBSD_5_5:1.24.0.2
	OPENBSD_5_5_BASE:1.24
	OPENBSD_5_4:1.20.0.2
	OPENBSD_5_4_BASE:1.20
	OPENBSD_5_3:1.14.0.2
	OPENBSD_5_3_BASE:1.14
	OPENBSD_5_2:1.11.0.2
	OPENBSD_5_2_BASE:1.11
	OPENBSD_5_1_BASE:1.9
	OPENBSD_5_1:1.9.0.2
	OPENBSD_5_0:1.7.0.2
	OPENBSD_5_0_BASE:1.7
	sthen20110328:1.1.1.1
	sthen:1.1.1;
locks; strict;
comment	@# @;


1.35
date	2017.02.07.21.34.43;	author sthen;	state Exp;
branches;
next	1.34;
commitid	14ywkTctmjWR3HuV;

1.34
date	2016.02.28.12.02.16;	author kirby;	state Exp;
branches;
next	1.33;
commitid	esErkrMDvbXiuqqB;

1.33
date	2015.12.30.10.01.25;	author ajacoutot;	state Exp;
branches;
next	1.32;
commitid	70nO8w9Ckt7hbcu6;

1.32
date	2015.11.03.09.49.38;	author kirby;	state Exp;
branches;
next	1.31;
commitid	C2tkFTtxYsGJMZqY;

1.31
date	2015.06.05.06.00.21;	author robert;	state Exp;
branches;
next	1.30;
commitid	PS9YXjRm9KQkIZjT;

1.30
date	2015.04.05.12.15.08;	author rpe;	state Exp;
branches;
next	1.29;
commitid	Ah7VtzveC43sxQDl;

1.29
date	2014.11.06.17.13.39;	author sthen;	state Exp;
branches;
next	1.28;
commitid	ig1O4RkSPXzTZYwZ;

1.28
date	2014.10.02.21.05.02;	author sthen;	state Exp;
branches;
next	1.27;
commitid	AIp9ewSobQSliEv4;

1.27
date	2014.08.10.11.12.26;	author jasper;	state Exp;
branches;
next	1.26;
commitid	UfW9u7o8QL6HX3fr;

1.26
date	2014.05.30.13.20.13;	author sthen;	state Exp;
branches;
next	1.25;

1.25
date	2014.03.25.01.26.33;	author sthen;	state Exp;
branches;
next	1.24;

1.24
date	2013.10.25.16.16.23;	author sthen;	state Exp;
branches;
next	1.23;

1.23
date	2013.10.18.11.52.18;	author sthen;	state Exp;
branches;
next	1.22;

1.22
date	2013.09.12.22.31.27;	author sthen;	state Exp;
branches;
next	1.21;

1.21
date	2013.08.12.04.11.20;	author robert;	state Exp;
branches;
next	1.20;

1.20
date	2013.07.05.07.44.59;	author jasper;	state Exp;
branches;
next	1.19;

1.19
date	2013.05.13.20.57.38;	author sthen;	state Exp;
branches;
next	1.18;

1.18
date	2013.05.07.15.34.47;	author sthen;	state Exp;
branches;
next	1.17;

1.17
date	2013.03.28.12.43.14;	author sthen;	state Exp;
branches;
next	1.16;

1.16
date	2013.03.11.11.35.47;	author espie;	state Exp;
branches;
next	1.15;

1.15
date	2013.03.02.12.41.55;	author sthen;	state Exp;
branches;
next	1.14;

1.14
date	2012.12.27.14.51.54;	author rpe;	state Exp;
branches;
next	1.13;

1.13
date	2012.10.18.20.04.58;	author sthen;	state Exp;
branches;
next	1.12;

1.12
date	2012.10.12.17.59.25;	author rpe;	state Exp;
branches;
next	1.11;

1.11
date	2012.05.17.11.06.33;	author sthen;	state Exp;
branches
	1.11.2.1;
next	1.10;

1.10
date	2012.04.28.10.51.44;	author ajacoutot;	state Exp;
branches;
next	1.9;

1.9
date	2011.12.03.15.01.38;	author sthen;	state Exp;
branches;
next	1.8;

1.8
date	2011.11.16.15.56.37;	author robert;	state Exp;
branches;
next	1.7;

1.7
date	2011.07.09.00.46.19;	author robert;	state Exp;
branches;
next	1.6;

1.6
date	2011.07.01.16.57.41;	author sthen;	state Exp;
branches;
next	1.5;

1.5
date	2011.06.08.14.24.50;	author sthen;	state Exp;
branches;
next	1.4;

1.4
date	2011.06.02.13.41.39;	author ajacoutot;	state Exp;
branches;
next	1.3;

1.3
date	2011.03.31.10.25.25;	author sthen;	state Exp;
branches;
next	1.2;

1.2
date	2011.03.31.09.42.21;	author sthen;	state Exp;
branches;
next	1.1;

1.1
date	2011.03.28.14.06.06;	author sthen;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2011.03.28.14.06.06;	author sthen;	state Exp;
branches;
next	;

1.11.2.1
date	2013.01.14.12.25.23;	author sthen;	state Exp;
branches;
next	;


desc
@@


1.35
log
@update to icinga-web 1.14.0
@
text
@# $OpenBSD: Makefile,v 1.34 2016/02/28 12:02:16 kirby Exp $

COMMENT =	web UI for icinga

GH_ACCOUNT =	Icinga
GH_PROJECT =	icinga-web
GH_TAGNAME =	v1.14.0

MODULES=	lang/php

COMMON =	www/pear \
		shells/bash

RUN_DEPENDS =	${COMMON_DEPENDS} \
		lang/php/${MODPHP_VERSION},-gd \
		lang/php/${MODPHP_VERSION},-xsl \
		php-pdo_mysql-${MODPHP_VSPEC}|php-pdo_pgsql-${MODPHP_VSPEC}:lang/php/${MODPHP_VERSION},-pdo_mysql \
		net/icinga/core \
		net/icinga/core,-ido>=1.11
# Optional php extensions: ldap soap xmlrpc memcache

BUILD_DEPENDS=	${COMMON_DEPENDS}

LOCALSTATEDIR =	${BASELOCALSTATEDIR}/icinga

CONFIGURE_STYLE = gnu
CONFIGURE_ENV +=  PHP="${MODPHP_BIN}"
CONFIGURE_ARGS += \
	--datarootdir=${PREFIX} \
	--sbindir=/var/www/cgi-bin/icinga \
	--with-web-apache-path=${PREFIX}/etc \
	--with-api-cmd-file=/var/icinga/rw/icinga.cmd \
	--with-web-user=www \
	--with-web-group=www \
	--with-bin-user=${SHAREOWN} \
	--with-bin-group=${SHAREGRP} \
	--with-db-socket=/var/run/mysql/mysql.sock \
	--with-icinga-bin=${LOCALBASE}/bin/icinga \
	--with-icinga-cfg=${BASESYSCONFDIR}/icinga/icinga.cfg \
	--with-icinga-objects-dir=${BASESYSCONFDIR}/icinga/objects
# override default ("localhost") to allow tcp connections; makes mysql easier
CONFIGURE_ARGS += \
	--with-api-host=127.0.0.1 \
	--with-db-host=127.0.0.1

NO_TEST =	Yes
NO_BUILD =	Yes

INSTALL_TARGET = install install-apache-config

PREFIX =	${VARBASE}/www/icinga-web

pre-configure:
	ln -s ${MODPHP_BIN} ${WRKDIR}/bin/php

post-configure:
	find ${WRKSRC}/bin -name '*.sh' -print0 | xargs -0r \
		perl -pi -e 's,^#!/bin/bash,#!${LOCALBASE}/bin/bash,g'
	${SUBST_CMD} ${WRKSRC}/etc/apache2/icinga-web.conf

pre-install:
	${INSTALL_DATA_DIR} ${WRKINST}${VARBASE}/www/conf/modules.sample

post-install:
	find ${WRKINST} -name '*.orig' -print0 | xargs -0r rm
	cd ${WRKSRC}/etc/schema; pax -rw ./ ${PREFIX}/etc/schema/
	for i in ${PREFIX}/etc/conf.d/*xml; do mv $$i $$i.dist; done
	for i in pnp-host-extension.xml pnp-service-extension.xml; do \
	${INSTALL_DATA} ${WRKSRC}/contrib/PNP_Integration/templateExtensions/$$i \
	${PREFIX}/app/modules/Cronks/data/xml/extensions/$$i.dist; done

.include <bsd.port.mk>
@


1.34
log
@ - add extensions for upcoming pnp4nagios port
 - add some @@extraunexec markers
input and ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2015/12/30 10:01:25 ajacoutot Exp $
d5 3
a7 5
V =		1.13.1
DISTNAME =	icinga-web-$V
REVISION =	1

MASTER_SITES =	https://github.com/Icinga/icinga-web/releases/download/v$V/
@


1.33
log
@@@sample /var/www/conf/modules.sample/

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2015/11/03 09:49:38 kirby Exp $
d7 1
a7 1
REVISION =	0
d70 3
@


1.32
log
@update to icinga-web-1.13.1
OK sthen@@, maintainer
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2015/06/05 06:00:21 robert Exp $
d7 1
@


1.31
log
@bump revision due to the change of the default php version to 5.6
ok aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2015/04/05 12:15:08 rpe Exp $
d5 1
a5 1
V =		1.12.0
a6 1
REVISION =	0
@


1.30
log
@Update net/icinga/web to version 1.12.0

OK sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2014/11/06 17:13:39 sthen Exp $
d7 1
@


1.29
log
@bump REVISION for php version switch
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2014/10/02 21:05:02 sthen Exp $
d5 1
a5 1
V =		1.11.2
a6 1
REVISION =	0
d60 1
a60 1
	${SUBST_CMD} ${WRKSRC}/etc/apache2/icinga-web.conf.in
@


1.28
log
@update to icinga-web 1.11.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2014/08/10 11:12:26 jasper Exp $
d7 1
@


1.27
log
@don't hardcode path to mod_rewrite.so so that the default config
works with openbsd-httd-openbsd again.

ok sthen@@ rpe@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2014/05/30 13:20:13 sthen Exp $
d5 1
a5 2
V =		1.11.0
REVISION =	1
@


1.26
log
@bump ports which may have been installed when /var/www/modules.sample didn't
exist, to force an update to make sure that their config samples get installed
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2014/03/25 01:26:33 sthen Exp $
d6 1
a6 1
REVISION =	0
d61 1
@


1.25
log
@update to Icinga 1.11.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2013/10/25 16:16:23 sthen Exp $
d6 1
@


1.24
log
@update to icinga 1.10, for more information see
https://www.icinga.org/2013/10/24/icinga-1-10-released/

as mentioned in a new addition to the readme, icinga-web users may need to
clear their cache with /var/www/icinga-web/bin/clearcache.sh
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2013/10/18 11:52:18 sthen Exp $
d4 5
a8 1
DISTNAME =	icinga-web-1.10.0
d20 1
a20 1
		net/icinga/core,-ido>=1.10
@


1.23
log
@update to icinga-web 1.9.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2013/09/12 22:31:27 sthen Exp $
d4 1
a4 1
DISTNAME =	icinga-web-1.9.2
d16 1
a16 1
		net/icinga/core,-ido
@


1.22
log
@update to icinga-web 1.9.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2013/08/12 04:11:20 robert Exp $
d4 1
a4 1
DISTNAME =	icinga-web-1.9.1
@


1.21
log
@bump REVISION due to the php update
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2013/07/05 07:44:59 jasper Exp $
d4 1
a4 2
DISTNAME =	icinga-web-1.9.0
REVISION =	1
@


1.20
log
@use ${VARBASE} instead of hardcoding /var
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2013/05/13 20:57:38 sthen Exp $
d5 1
a5 1
REVISION =	0
@


1.19
log
@tweak CATEGORIES
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2013/05/07 15:34:47 sthen Exp $
d49 1
a49 1
PREFIX =	/var/www/icinga-web
d59 1
a59 1
	${INSTALL_DATA_DIR} ${WRKINST}/var/www/conf/modules.sample
@


1.18
log
@Update to Icinga 1.9, thanks to rpe@@ for feedback and testing the beta.
Also thanks to Michael Friedrich (upstream) for sending out helpful notes
to package maintainers about changes in the release which may affect them,
we like projects who do that :)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2013/03/28 12:43:14 sthen Exp $
d5 1
@


1.17
log
@update to icinga-web 1.8.3, from rpe@@ with very minor tweak from me
- remember to update schema, as mentioned in the README
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2013/03/11 11:35:47 espie Exp $
d4 1
a4 1
DISTNAME =	icinga-web-1.8.3
@


1.16
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2013/03/02 12:41:55 sthen Exp $
d4 1
a4 1
DISTNAME =	icinga-web-1.8.2
d51 1
a51 1
	@@ln -s ${MODPHP_BIN} ${WRKDIR}/bin/php
d54 1
a54 1
	@@find ${WRKSRC}/bin -name '*.sh' -print0 | xargs -0r \
@


1.15
log
@icinga-web 1.8.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2012/12/27 14:51:54 rpe Exp $
d43 1
a43 1
NO_REGRESS =	Yes
@


1.14
log
@- update icinga-core to 1.8.3
- update icinga-web to 1.8.1
- now, as the versions of icinga-core and icinga-web seem to diverge,
  move version information to the individual Makefiles in core/ and
  web/

ok sthen@@ (MAINTAINER)

Changes for icinga-core 1.8.3:
Bugs
* idoutils: fix unknown column contactaddress_id (thx fmbiete) #3483 - MF

Changes for icinga-web 1.8.1:
Bugs
    * Removed duplicate insert in sql upgrade scripts #3328
    * IE7 window fix for cronk save dialog
    * Disabled grouping of of unhandled problems grid #3320
    * Re-added missing command restriction class #3457
    * Removed ghost column after changing to new grid events #3458
    * Fixes PNP extension #3427
    * Removed flash for packaging and flash security fixes
    * Various custom cronk dialog fixes

Features
    * Allow xtypes in grid events to customize menues
    * Clearcache enhancements
    * Make ApiComboBox default for filters (Pagination)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2012/10/18 20:04:58 sthen Exp $
d4 1
a4 1
DISTNAME =	icinga-web-1.8.1
d8 4
a11 1
RUN_DEPENDS =	www/pear \
a12 1
		lang/php/${MODPHP_VERSION},-ldap \
d16 2
a17 3
		net/icinga/core,-ido \
		shells/bash
# Optional php extensions: soap xmlrpc memcache
d19 1
a19 1
BUILD_DEPENDS=	${RUN_DEPENDS}
@


1.13
log
@update Icinga to 1.8.0, testing (including icinga-web) and ok rpe@@

- slight tweaks to upgrade documentation while there; you should still
check the proper upgrade notes from upstream, but the README now points
idodb users at the actual location of the schema update files to save
a bit of hunting.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2012/05/17 11:06:33 sthen Exp $
d4 1
a4 1
DISTNAME =	icinga-web-$V
@


1.12
log
@icinga:
- attach icinga-web to build

icinga-core:
- bump REVISION for -main, -cgi and -ido
- remove CFGDIR, MAKE_FLAGS from Makefile which are relics
- replace /var/www with ${PREFIX-cgi}
- add instructions for icinga-web to README
- choose mysql by default

icinga-web:
- bump REVISION
- remove README, all instructions are in the icinga-core README
- remove comments about w.i.p
- choose mysql by default
- tell configure where to find icinga binary, icinga.cfg and the
  icinga objects dir
- add icinga, icinga-idoutils and bash to RUN_DEPENDS
- patch shells scripts to use the correct path for bash
- patch databases.xml.in to have both DBs enabled by default

with help and ok from sthen aja
@
text
@a4 1
REVISION =	0
d9 1
d16 3
a18 2
# Optional php extensions: gd soap xmlrpc
# memcache
d49 3
d61 1
a61 5
	cd ${PREFIX}; \
	${INSTALL_DATA_DIR} ${PREFIX}/etc/schema/updates
	cd ${WRKSRC}/etc/schema; \
	${INSTALL_DATA} *sql ${PREFIX}/etc/schema; \
	${INSTALL_DATA} updates/*sql ${PREFIX}/etc/schema/updates
@


1.11
log
@sync, still not enabled by default though
@
text
@d1 1
a1 3
# $OpenBSD: Makefile,v 1.10 2012/04/28 10:51:44 ajacoutot Exp $

# Work in progress. Not yet linked to the build.
d5 1
d12 4
a15 1
		php-pdo_mysql-${MODPHP_VSPEC}|php-pdo_pgsql-${MODPHP_VSPEC}:lang/php/${MODPHP_VERSION},-pdo_mysql
d24 1
a24 1
	--datarootdir=/var/www \
d32 4
a35 1
	--with-db-socket=/var/run/mysql/mysql.sock
d48 4
a57 2
	find ${PREFIX} -name '*.site.xml' -exec mv {} {}.dist \;
	mv ${PREFIX}/app/config/databases.xml{,.dist}
@


1.11.2.1
log
@update icinga in -stable to 1.7.4; CVE-2012-6096 stack-based buffer overflow
in history.cgi
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2012/05/17 11:06:33 sthen Exp $
a5 1
V =		1.7.2
@


1.10
log
@Use LOCALSTATEDIR.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2011/12/03 15:01:38 sthen Exp $
a4 1
V =		1.6.0
d12 2
a13 2
		lang/php/${MODPHP_VERSION},-pdo_mysql \
		lang/php/${MODPHP_VERSION},-xsl
d15 1
a15 4
# Does this work with pgo_pgsql? So far haven't worked out how.

MAKE_FLAGS =	PREFIX=/var/www/icinga-web
FAKE_FLAGS =	CFGDIR=${TRUEPREFIX}/share/examples/icinga
d24 1
a24 1
	--with-web-apache-path=/var/www/conf/modules.sample \
d31 4
a34 6

#		--with-db-type=DBTYPE   Type of dbms (default mysql)
#		--with-db-host=HOST     Host of dbms (default localhost)
#		--with-db-port=PORT     Port of the dbms (default 3306)
#		--with-api-type=APICON  API type (default CONNECTION_IDO)
#		--with-api-subtype=TYPE DB driver or network connection
d41 1
a41 1
PREFIX =	/var/www
d44 1
a44 5
	cd ${WRKINST}; ${INSTALL_DATA_DIR} \
	    ${WRKINST}/var/www/etc/schema/model \
	    ${WRKINST}/var/www/etc/schema/updates \
	    ${WRKINST}/var/www/icinga-web \
	    ${WRKINST}/var/www/conf/modules.sample
d48 1
a48 3
	cd ${PREFIX}; mv app bin doc etc lib pub icinga-web/ ; \
	mv conf/modules.sample/icinga-web.conf \
	    conf/modules.sample/icinga-web.conf.dist
d50 2
a51 1
	${INSTALL_DATA_DIR} ${WRKINST}/var/www/icinga-web/etc/schema/updates
d53 3
a55 3
	${INSTALL_DATA} *sql ${WRKINST}/var/www/icinga-web/etc/schema; \
	${INSTALL_DATA} updates/*sql \
	    ${WRKINST}/var/www/icinga-web/etc/schema/updates
@


1.9
log
@update to Icinga 1.6.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2011/11/16 15:56:37 robert Exp $
d21 2
a26 1
	--localstatedir=/var/icinga \
@


1.8
log
@switch php to version 5.3 by default
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2011/07/09 00:46:19 robert Exp $
d5 1
a6 2
V =		1.4.1
REVISION =	1
a10 1
BUILD_DEPENDS =	icinga-api-$V:net/icinga/core,-api
d14 1
a14 2
		lang/php/${MODPHP_VERSION},-xsl \
		icinga-api-$V:net/icinga/core,-api
d22 1
a24 1
	--with-icinga-api=/var/www/icinga-api \
@


1.7
log
@fix deps
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2011/07/01 16:57:41 sthen Exp $
d7 1
a7 1
REVISION =	0
@


1.6
log
@bugfix update to icinga 1.4.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2011/06/08 14:24:50 sthen Exp $
d7 1
d10 2
d14 3
a16 4
		www/php5/core \
		www/php5/extensions,-ldap \
		www/php5/extensions,-pdo_mysql \
		www/php5/extensions,-xsl \
@


1.5
log
@update to Icinga 1.4.1; bugfixes and minor improvements, rolls in XSS fix
we already had in a patch.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2011/06/02 13:41:39 ajacoutot Exp $
d6 1
@


1.4
log
@Add a consistent header that substitutes FULLPKGNAME for the READMEs.

ok jasper@@ sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2011/03/31 10:25:25 sthen Exp $
a6 1
REVISION =	0
d49 5
a53 2
	${INSTALL_DATA_DIR} ${WRKINST}/var/www/icinga-web
	${INSTALL_DATA_DIR} ${WRKINST}/var/www/conf/modules.sample
@


1.3
log
@maintenance update of icinga to 1.3.1, with a few small tweaks to the
port:

- fix icinga-api RUN_DEPENDS (idoutils need not be on the same
machine but it does need php).

- better log_archive_path

- we're building with embedded perl to make it easy to use if
wanted, but it's not suitable with all scripts, so in the default
configuration set use_embedded_perl_implicitly=0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2011/03/31 09:42:21 sthen Exp $
d7 1
@


1.2
log
@tidy up icinga-web Makefile a bit, adjust DESCR.
not yet ready for consumption.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2011/03/28 14:06:06 sthen Exp $
a6 1
REVISION =	0
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.template,v 1.54 2008/01/13 16:43:57 espie Exp $
d3 1
a3 2
COMMENT=	web UI for icinga
DISTNAME=	icinga-web-$V
d5 6
a10 2
BUILD_DEPENDS=	net/icinga/core,-api
RUN_DEPENDS=	www/pear \
d15 20
a34 36
		net/icinga/core,-api
# is icinga-api RUN_DEPENDS or not?
# pdo_mysql  | pdo_pgsql

#Optional php extension
#        16/23 Test php5-soap ... (Extension soap does not exist) FAIL
#        17/23 Test php5-xmlrpc ... (Extension xmlrpc does not exist) FAIL
#        18/23 Test php5-iconv ... (iconv found) OK
#        19/23 Test php5-gd ... (Extension gd does not exist) FAIL
#        20/23 Test php5-ctype ... (ctype found) OK
#        21/23 Test php5-json ... (json found v1.2.1) OK
#        22/23 Test php5-hash ... (hash found v1.0) OK
#        23/23 Test php.ini memory_limit ... (memory_limit='134217728') OK



#MODULES=	devel/gettext

MAKE_FLAGS=	PREFIX=/var/www/icinga-web
FAKE_FLAGS=	CFGDIR=${TRUEPREFIX}/share/examples/icinga

USE_X11=	Yes
CONFIGURE_STYLE=gnu
# XXX some of this is probably crap copied from nagios or icinga/core
CONFIGURE_ARGS+=--datarootdir=/var/www \
		--with-icinga-api=/var/www/icinga-api \
		--localstatedir=/var/icinga \
		--sbindir=/var/www/cgi-bin/icinga \
		--with-web-apache-path=/var/www/conf/modules.sample \
		--with-api-cmd-file=/var/icinga/rw/icinga.cmd \
		--with-web-user=www \
		--with-web-group=www \
		--with-bin-user=${SHAREOWN} \
		--with-bin-group=${SHAREGRP}

#		--with-web-absolute-path=/var/www/icinga-web 
a38 4
#		--with-db-name=DBNAME   DB name for icinga (default icinga_web)
#		--with-db-user=USER     DB user for icinga (default icinga_web)
#		--with-db-pass=PASS     DB pass for icinga (default icinga_web)
##		--with-db-socket=SOCKET DB path to unix socket (default /tmp/mysql.sock)
a40 10
#		--with-api-cmd-file=PATH Icinga command file (default /usr/local/icinga/var/rw/icinga.cmd)


NO_REGRESS=	Yes
NO_BUILD=	Yes

CFLAGS+=	-fPIC \
		-I${LOCALBASE}/include \
		-L${X11BASE}/lib -L${LOCALBASE}/lib
#LDFLAGS=		
d42 2
a43 3
#ALL_TARGET=		
INSTALL_TARGET=	install install-apache-config
# or install-javascript instead of install-apache-config?
d45 1
a45 2
PREFIX=		/var/www
#REGRESS_TARGET=	
d47 1
a47 3
#pre-configure:
#	@@perl -pi -e 's, /etc/, ${SYSCONFDIR}/,' \
#	    ${WRKSRC}/sample-config/httpd.conf
@


1.1.1.1
log
@Import ports/net/icinga (with -I !, so the 'core' directory doesn't
become cvs-food). See the README file for information about migrating
from Nagios with minimal config changes.

The icinga-web API-backed user interface is a work in progress
and not yet linked to the build; the core program and classic web
interface are perfectly usable.

Comments/ok from pea@@, thanks for testing!

-- -- --
Icinga monitors network resources such as servers, routers, switches,
applications and services and notifies administrators or responsible
persons. It's a fork of Nagios and supports its extensive pool of
monitoring plug-ins. Current status information, historical logs
and reports can all be accessed via a web browser.
-- -- --
@
text
@@
