head	1.7;
access;
symbols
	OPENBSD_6_1:1.7.0.10
	OPENBSD_6_1_BASE:1.7
	OPENBSD_6_0:1.7.0.8
	OPENBSD_6_0_BASE:1.7
	OPENBSD_5_9:1.7.0.4
	OPENBSD_5_9_BASE:1.7
	OPENBSD_5_8:1.7.0.6
	OPENBSD_5_8_BASE:1.7
	OPENBSD_5_7:1.7.0.2
	OPENBSD_5_7_BASE:1.7
	OPENBSD_5_6:1.6.0.4
	OPENBSD_5_6_BASE:1.6
	OPENBSD_5_5:1.6.0.2
	OPENBSD_5_5_BASE:1.6
	OPENBSD_5_4:1.5.0.4
	OPENBSD_5_4_BASE:1.5
	OPENBSD_5_3:1.5.0.2
	OPENBSD_5_3_BASE:1.5
	OPENBSD_5_2:1.3.0.10
	OPENBSD_5_2_BASE:1.3
	OPENBSD_5_1_BASE:1.3
	OPENBSD_5_1:1.3.0.8
	OPENBSD_5_0:1.3.0.6
	OPENBSD_5_0_BASE:1.3
	OPENBSD_4_9:1.3.0.4
	OPENBSD_4_9_BASE:1.3
	OPENBSD_4_8:1.3.0.2
	OPENBSD_4_8_BASE:1.3
	OPENBSD_4_7:1.2.0.6
	OPENBSD_4_7_BASE:1.2
	OPENBSD_4_6:1.2.0.4
	OPENBSD_4_6_BASE:1.2
	OPENBSD_4_5:1.2.0.2
	OPENBSD_4_5_BASE:1.2
	OPENBSD_4_4:1.1.0.4
	OPENBSD_4_4_BASE:1.1
	OPENBSD_4_3:1.1.0.2
	OPENBSD_4_3_BASE:1.1;
locks; strict;
comment	@# @;


1.7
date	2015.01.24.03.52.53;	author lteo;	state Exp;
branches;
next	1.6;
commitid	mdqzmhFDvmYDNKCz;

1.6
date	2014.01.30.03.23.48;	author lteo;	state Exp;
branches;
next	1.5;

1.5
date	2013.01.16.04.52.53;	author lteo;	state Exp;
branches;
next	1.4;

1.4
date	2012.09.26.02.11.05;	author lteo;	state Exp;
branches;
next	1.3;

1.3
date	2010.07.12.19.38.40;	author sthen;	state Exp;
branches;
next	1.2;

1.2
date	2009.02.12.22.12.08;	author rui;	state Exp;
branches;
next	1.1;

1.1
date	2008.02.12.14.13.32;	author rui;	state Exp;
branches;
next	;


desc
@@


1.7
log
@Update to Snort 2.9.7.0.

Tested by maintainer on i386, and by myself on amd64.

joint work with maintainer Markus Lude
nudged by sthen@@
@
text
@$OpenBSD: patch-src_log_c,v 1.6 2014/01/30 03:23:48 lteo Exp $
--- src/log.c.orig	Sat Feb 22 03:45:22 2014
+++ src/log.c	Sat Oct 25 16:32:17 2014
@@@@ -457,7 +457,7 @@@@ void PrintIPPkt(FILE * fp, int type, Packet * p)
     DEBUG_WRAP(DebugMessage(DEBUG_LOG, "PrintIPPkt type = %d\n", type););
 
     memset((char *) timestamp, 0, TIMEBUF_SIZE);
-    ts_print((struct timeval *) & p->pkth->ts, timestamp);
+    ts_print((struct sf_timeval32 *) & p->pkth->ts, timestamp);
 
     /* dump the timestamp */
     fwrite(timestamp, strlen(timestamp), 1, fp);
@@@@ -1955,7 +1955,7 @@@@ void PrintEapolPkt(FILE * fp, Packet * p)
 
 
     memset((char *) timestamp, 0, TIMEBUF_SIZE);
-    ts_print((struct timeval *) & p->pkth->ts, timestamp);
+    ts_print((struct sf_timeval32 *) & p->pkth->ts, timestamp);
 
     /* dump the timestamp */
     fwrite(timestamp, strlen(timestamp), 1, fp);
@@@@ -2129,7 +2129,7 @@@@ void PrintWifiPkt(FILE * fp, Packet * p)
 
 
     memset((char *) timestamp, 0, TIMEBUF_SIZE);
-    ts_print((struct timeval *) & p->pkth->ts, timestamp);
+    ts_print((struct sf_timeval32 *) & p->pkth->ts, timestamp);
 
     /* dump the timestamp */
     fwrite(timestamp, strlen(timestamp), 1, fp);
@


1.6
log
@Update to Snort 2.9.6.0, from maintainer Markus Lude.

Tested on sparc64 by Markus; tested on amd64 and macppc by myself.
@
text
@d1 3
a3 3
$OpenBSD: patch-src_log_c,v 1.5 2013/01/16 04:52:53 lteo Exp $
--- src/log.c.orig	Tue Dec 31 17:07:53 2013
+++ src/log.c	Thu Jan 23 23:07:23 2014
d13 1
a13 1
@@@@ -1944,7 +1944,7 @@@@ void PrintEapolPkt(FILE * fp, Packet * p)
d22 1
a22 1
@@@@ -2118,7 +2118,7 @@@@ void PrintWifiPkt(FILE * fp, Packet * p)
@


1.5
log
@Update to Snort 2.9.4.0, from Markus Lude (maintainer).

Notable changes:

* Consolidation of IPv6 -- now only a single build supports both
  IPv4 & IPv6, and removal of the IPv4 "only" code paths.
* File API and improvements to file processing for HTTP downloads
  and email attachments via SMTP, POP, and IMAP to facilitate
  broader file support
* Use of address space ID for tracking Frag & Stream connections
  when it is available with the DAQ
* Logging of packet data that triggers PPM for post-analysis via
  Snort event
* Decoding of IPv6 with PPPoE

This commit also includes a patch to snort.conf that was done by myself
with feedback from Markus.  The snort.conf patch ensures that Snort will
load the latest Snort ruleset since the rule files have been reorganized
by upstream.  It also excludes local.rules by default, since rule
managers like Oinkmaster skip that file when downloading rules.

Tested by Markus on i386 and sparc64, Rodolfo Gouveia on 5.2/amd64 with
his own snort.conf, and myself on amd64 and i386.

OK sthen@@
@
text
@d1 4
a4 4
$OpenBSD: patch-src_log_c,v 1.4 2012/09/26 02:11:05 lteo Exp $
--- src/log.c.orig	Fri Sep 21 02:09:13 2012
+++ src/log.c	Tue Oct  9 22:24:01 2012
@@@@ -456,7 +456,7 @@@@ void PrintIPPkt(FILE * fp, int type, Packet * p)
d7 1
a7 1
     bzero((char *) timestamp, TIMEBUF_SIZE);
d13 1
a13 1
@@@@ -1943,7 +1943,7 @@@@ void PrintEapolPkt(FILE * fp, Packet * p)
d16 1
a16 1
     bzero((char *) timestamp, TIMEBUF_SIZE);
d22 1
a22 1
@@@@ -2117,7 +2117,7 @@@@ void PrintWifiPkt(FILE * fp, Packet * p)
d25 1
a25 1
     bzero((char *) timestamp, TIMEBUF_SIZE);
@


1.4
log
@Update Snort to 2.9.3.1.

Thank you to all who tested: Markus Lude (sparc64), abieber@@ (macppc),
and Adam Jeanguenat (i386); I also tested on amd64 and i386.  Thank you
to Rodolfo Gouveia for help/tests on earlier versions, and brad@@ for
comments on an earlier version.

From Markus Lude (maintainer), and includes changes done based on
feedback from sthen@@ and myself.

OK abieber@@ sthen@@
@
text
@d1 4
a4 4
$OpenBSD: patch-src_log_c,v 1.3 2010/07/12 19:38:40 sthen Exp $
--- src/log.c.orig	Thu Jan 12 23:11:40 2012
+++ src/log.c	Sat May 26 15:10:20 2012
@@@@ -461,7 +461,7 @@@@ void PrintIPPkt(FILE * fp, int type, Packet * p)
d13 1
a13 10
@@@@ -1017,7 +1017,7 @@@@ void PrintArpHeader(FILE * fp, Packet * p)
 
     bzero((struct in_addr *) &ip_addr, sizeof(struct in_addr));
     bzero((char *) timestamp, TIMEBUF_SIZE);
-    ts_print((struct timeval *) & p->pkth->ts, timestamp);
+    ts_print((struct sf_timeval32 *) & p->pkth->ts, timestamp);
 
     /* determine what to use as MAC src and dst */
     if (p->eh != NULL)
@@@@ -2108,7 +2108,7 @@@@ void PrintEapolPkt(FILE * fp, Packet * p)
d22 1
a22 1
@@@@ -2282,7 +2282,7 @@@@ void PrintWifiPkt(FILE * fp, Packet * p)
@


1.3
log
@update to 2.8.6, from maintainer Markus Lude
@
text
@d1 4
a4 4
$OpenBSD: patch-src_log_c,v 1.2 2009/02/12 22:12:08 rui Exp $
--- src/log.c.orig	Tue Jan 26 19:10:51 2010
+++ src/log.c	Thu Apr 22 07:53:46 2010
@@@@ -407,7 +407,7 @@@@ void PrintIPPkt(FILE * fp, int type, Packet * p)
d13 1
a13 1
@@@@ -918,7 +918,7 @@@@ void PrintArpHeader(FILE * fp, Packet * p)
d21 3
a23 3
     if (p->eh != NULL) 
@@@@ -1959,7 +1959,7 @@@@ void PrintEapolPkt(FILE * fp, Packet * p)
   
d31 1
a31 1
@@@@ -2133,7 +2133,7 @@@@ void PrintWifiPkt(FILE * fp, Packet * p)
@


1.2
log
@update snort to 2.8.3.2, from Markus Lude.
@
text
@d1 4
a4 4
$OpenBSD: patch-src_log_c,v 1.1 2008/02/12 14:13:32 rui Exp $
--- src/log.c.orig	Mon Jun 16 20:33:54 2008
+++ src/log.c	Fri Sep  5 22:54:34 2008
@@@@ -358,7 +358,7 @@@@ void PrintIPPkt(FILE * fp, int type, Packet * p)
d9 1
a9 1
+    ts_print((struct timeval32 *) & p->pkth->ts, timestamp);
d13 1
a13 1
@@@@ -851,7 +851,7 @@@@ void PrintArpHeader(FILE * fp, Packet * p)
d18 1
a18 1
+    ts_print((struct timeval32 *) & p->pkth->ts, timestamp);
d22 1
a22 1
@@@@ -1929,7 +1929,7 @@@@ void PrintEapolPkt(FILE * fp, Packet * p)
d27 1
a27 1
+    ts_print((struct timeval32 *) & p->pkth->ts, timestamp);
d31 1
a31 1
@@@@ -2103,7 +2103,7 @@@@ void PrintWifiPkt(FILE * fp, Packet * p)
d36 1
a36 1
+    ts_print((struct timeval32 *) & p->pkth->ts, timestamp);
@


1.1
log
@- update to snort 2.8.0.1.

from Markus Lude with a few changes, tested by many including reyk@@, jdixon@@. Thanks.

ok landry@@
@
text
@d1 4
a4 4
$OpenBSD$
--- src/log.c.orig	Mon Aug 20 19:40:24 2007
+++ src/log.c	Mon Nov 19 22:32:12 2007
@@@@ -355,7 +355,7 @@@@ void PrintIPPkt(FILE * fp, int type, Packet * p)
d13 1
a13 1
@@@@ -800,7 +800,7 @@@@ void PrintArpHeader(FILE * fp, Packet * p)
d22 1
a22 1
@@@@ -1874,7 +1874,7 @@@@ void PrintEapolPkt(FILE * fp, Packet * p)
d31 1
a31 1
@@@@ -2048,7 +2048,7 @@@@ void PrintWifiPkt(FILE * fp, Packet * p)
@

