head	1.3;
access;
symbols;
locks; strict;
comment	@# @;


1.3
date	2006.02.04.17.48.20;	author david;	state dead;
branches;
next	1.2;

1.2
date	2006.02.04.13.15.42;	author david;	state Exp;
branches;
next	1.1;

1.1
date	2006.01.04.04.15.19;	author david;	state Exp;
branches;
next	;


desc
@@


1.3
log
@zap 0 byte file
@
text
@@


1.2
log
@update to snort-2.4.3; ok sturm@@
@
text
@@


1.1
log
@Fixed issue with MySQL 5.0 and the schema keyword; from snort CVS
bump PKGNAME
@
text
@a0 28
$OpenBSD$
--- src/output-plugins/spo_database.c.orig	Mon Sep 13 12:44:49 2004
+++ src/output-plugins/spo_database.c	Tue Jan  3 16:26:09 2006
@@@@ -1910,9 +1910,23 @@@@ int CheckDBVersion(DatabaseData * data)
    else
 #endif
    {
-      snprintf(select0, MAX_QUERY_LENGTH,
+#if defined(ENABLE_MYSQL)
+      if (data->shared->dbtype_id == DB_MYSQL)
+      {
+         /* "schema" is a keyword in MYSQL, so use `schema`
+          *  to indicate that we are referring to the table
+          */
+         snprintf(select0, MAX_QUERY_LENGTH,
                "SELECT vseq "
+               "FROM `schema`");
+      }
+      else
+#endif
+      {
+         snprintf(select0, MAX_QUERY_LENGTH,
+               "SELECT vseq "
                "FROM schema");
+      }
    }
 
    schema_version = Select(select0,data);
@

