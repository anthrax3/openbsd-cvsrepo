head	1.2;
access;
symbols
	OPENBSD_3_0:1.1.0.6
	OPENBSD_3_0_BASE:1.1
	OPENBSD_2_9_TRACKING_SWITCH:1.1
	OPENBSD_2_9:1.1.0.4
	OPENBSD_2_9_BASE:1.1
	OPENBSD_2_8:1.1.0.2;
locks; strict;
comment	@ * @;


1.2
date	2002.03.01.00.18.11;	author brad;	state dead;
branches;
next	1.1;

1.1
date	2000.12.13.14.37.08;	author brad;	state Exp;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2000.12.13.14.42.28;	author brad;	state Exp;
branches;
next	;


desc
@@


1.2
log
@upgrade to BitchX 1.0c18
--
Based on patches from & the new maintainer:
Vincent Derrien <vincent.derrien@@free.fr>
@
text
@--- source/misc.c.orig	Tue Dec 12 17:05:45 2000
+++ source/misc.c	Tue Dec 12 17:07:24 2000
@@@@ -2641,6 +2641,11 @@@@
 		switch(type)
 		{
 		case T_A :
+			if (dlen != sizeof(struct in_addr))
+			{
+				cp += dlen;
+				break;
+			}
 			rptr->re_he.h_length = dlen;
 			if (ans == 1)
 				rptr->re_he.h_addrtype=(class == C_IN) ?
@@@@ -2687,6 +2692,7 @@@@
 			*alias = NULL;
 			break;
 		default :
+			cp += dlen;
 			break;
 		}
 	}
@


1.1
log
@Fix a buffer overflow in the DNS resolution code. A buffer overflow
within the resolver code makes it possible to overwrite stack
variables by generating a malformed DNS packet. This problem makes
it possible to create a situation where a malicious user may be
able to execute code remotely with the UID and GID of the BitchX
client. It is necessary for an attacker to control their own DNS
to exploit this bug.
@
text
@@


1.1.2.1
log
@MFC:
Fix a buffer overflow in the DNS resolution code. A buffer overflow
within the resolver code makes it possible to overwrite stack
variables by generating a malformed DNS packet. This problem makes
it possible to create a situation where a malicious user may be
able to execute code remotely with the UID and GID of the BitchX
client. It is necessary for an attacker to control their own DNS
to exploit this bug.
@
text
@@

