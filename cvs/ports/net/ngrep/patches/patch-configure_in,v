head	1.4;
access;
symbols
	OPENBSD_6_2:1.4.0.26
	OPENBSD_6_2_BASE:1.4
	OPENBSD_6_1:1.4.0.24
	OPENBSD_6_1_BASE:1.4
	OPENBSD_6_0:1.4.0.22
	OPENBSD_6_0_BASE:1.4
	OPENBSD_5_9:1.4.0.18
	OPENBSD_5_9_BASE:1.4
	OPENBSD_5_8:1.4.0.20
	OPENBSD_5_8_BASE:1.4
	OPENBSD_5_7:1.4.0.16
	OPENBSD_5_7_BASE:1.4
	OPENBSD_5_6:1.4.0.14
	OPENBSD_5_6_BASE:1.4
	OPENBSD_5_5:1.4.0.12
	OPENBSD_5_5_BASE:1.4
	OPENBSD_5_4:1.4.0.10
	OPENBSD_5_4_BASE:1.4
	OPENBSD_5_3:1.4.0.8
	OPENBSD_5_3_BASE:1.4
	OPENBSD_5_2:1.4.0.6
	OPENBSD_5_2_BASE:1.4
	OPENBSD_5_1_BASE:1.4
	OPENBSD_5_1:1.4.0.4
	OPENBSD_5_0:1.4.0.2
	OPENBSD_5_0_BASE:1.4
	OPENBSD_4_9:1.3.0.8
	OPENBSD_4_9_BASE:1.3
	OPENBSD_4_8:1.3.0.6
	OPENBSD_4_8_BASE:1.3
	OPENBSD_4_7:1.3.0.4
	OPENBSD_4_7_BASE:1.3
	OPENBSD_4_6:1.3.0.2
	OPENBSD_4_6_BASE:1.3
	OPENBSD_4_5:1.2.0.16
	OPENBSD_4_5_BASE:1.2
	OPENBSD_4_4:1.2.0.14
	OPENBSD_4_4_BASE:1.2
	OPENBSD_4_3:1.2.0.12
	OPENBSD_4_3_BASE:1.2
	OPENBSD_4_2:1.2.0.10
	OPENBSD_4_2_BASE:1.2
	OPENBSD_4_1:1.2.0.8
	OPENBSD_4_1_BASE:1.2
	OPENBSD_4_0:1.2.0.6
	OPENBSD_4_0_BASE:1.2
	OPENBSD_3_9:1.2.0.4
	OPENBSD_3_9_BASE:1.2
	OPENBSD_3_8:1.2.0.2
	OPENBSD_3_8_BASE:1.2
	OPENBSD_3_7:1.1.0.4
	OPENBSD_3_7_BASE:1.1
	OPENBSD_3_6:1.1.0.2
	OPENBSD_3_6_BASE:1.1;
locks; strict;
comment	@# @;


1.4
date	2011.06.16.21.21.43;	author sthen;	state Exp;
branches;
next	1.3;

1.3
date	2009.03.30.21.19.02;	author sthen;	state Exp;
branches;
next	1.2;

1.2
date	2005.07.23.19.41.21;	author brad;	state Exp;
branches;
next	1.1;

1.1
date	2004.04.09.10.11.36;	author sturm;	state Exp;
branches;
next	;


desc
@@


1.4
log
@sync ngrep with version from upstream repo (mostly). there's been no release
(or much activity) in years and it has various fixes, including:
- unbreak IPv6
- support pflog capture files and pppoe
- chroot to /var/empty when dropping privs
@
text
@--- configure.in.orig	Wed Nov 15 03:43:56 2006
+++ configure.in	Thu Jun 16 16:09:24 2011
@@@@ -111,47 +111,12 @@@@ else
 fi
 
 
-dnl
-dnl Configure the regular expression library.
-dnl
+AC_CHECK_LIB(pcre, pcre_compile,,echo need pcre lib; exit)
+REGEX_OBJS=''
+USE_PCRE="1"
 
-AC_ARG_ENABLE(pcre,
-[  --enable-pcre           use PCRE instead of GNU regex],
-[ 
-  use_pcre="$enableval"
-],
-[ 
-  use_pcre="no"
-])
-
-if test $use_pcre = yes; then
-
-  echo 
-  echo 'Configuring Perl-Compatible Regular Expression (PCRE) library ...' 
-  echo 
-
-  REGEX_DIR='pcre-5.0'
-  REGEX_OBJS="$REGEX_DIR/pcre.o $REGEX_DIR/study.o"
-  USE_PCRE="1"
-
-else
-
-  echo
-  echo 'Configuring GNU Regular Expression library ...'
-  echo
-
-  REGEX_DIR='regex-0.12'
-  REGEX_OBJS="$REGEX_DIR/regex.o"
-  USE_PCRE="0"
-
-fi
-
-( cd $REGEX_DIR && ./configure )
-
-AC_SUBST(REGEX_DIR)
 AC_SUBST(REGEX_OBJS)
 
-
 echo
 echo 'Configuring Network Grep (ngrep) ...'
 echo 
@@@@ -194,18 +159,6 @@@@ unsigned short bar = foo.source;
 *bsd*)
 	AC_SUBST(OS, BSD)
 
-	if test "$USE_PCAP_RESTART" = "0"; then 
-
-        AC_MSG_WARN(
-Your OS ($target_os) may have an old libpcap installation.
-If the resulting ngrep binary segfaults when a BPF filter is specified 
-without an ngrep match string then you should reconfigure ngrep with 
-the option ``--disable-pcap-restart''.
-)
-	sleep 3
-
-	fi
-
         ;;
 
 *solaris*)
@@@@ -381,6 +334,18 @@@@ yes
 [HAVE_DLT_RAW="1" && echo yes], [HAVE_DLT_RAW="0" && echo no])
 
 
+present=""
+AC_MSG_CHECKING(for DLT_PFLOG in bpf.h)
+AC_EGREP_CPP(yes,
+[
+#include <$BPF>
+#ifdef DLT_PFLOG
+yes
+#endif
+],
+[HAVE_DLT_PFLOG="1" && echo yes], [HAVE_DLT_PFLOG="0" && echo no])
+
+
 dnl
 dnl Now that we're past the OS-specific stuff, which could have
 dnl modified our USE_* and other defines, define them all now.
@@@@ -397,6 +362,7 @@@@ AC_DEFINE_UNQUOTED(DROPPRIVS_USER,           "$DROPPRI
 AC_DEFINE_UNQUOTED(HAVE_DUMB_UDPHDR,          $HAVE_DUMB_UDPHDR,          [whether to accommodate broken redhat-glibc udphdr declaration (default no)])
 
 AC_DEFINE_UNQUOTED(HAVE_DLT_RAW,              $HAVE_DLT_RAW,              [presence of DLT_RAW in bpf.h]) 
+AC_DEFINE_UNQUOTED(HAVE_DLT_PFLOG,            $HAVE_DLT_PFLOG,            [presence of DLT_PFLOG in bpf.h]) 
 AC_DEFINE_UNQUOTED(HAVE_DLT_IEEE802_11,       $HAVE_DLT_IEEE802_11,       [presence of DLT_IEEE802_11 in bpf.h]) 
 AC_DEFINE_UNQUOTED(HAVE_DLT_IEEE802_11_RADIO, $HAVE_DLT_IEEE802_11_RADIO, [presence of DLT_IEEE802_11_RADIO in bpf.h]) 
 AC_DEFINE_UNQUOTED(HAVE_DLT_LOOP,             $HAVE_DLT_LOOP,             [presence of DLT_LOOP in bpf.h]) 
@


1.3
log
@- drop privs to a new _ngrep user rather than nobody,
- chroot to /var/empty,
- support pppoe,
- autoconf surgery (functional rather than pretty) to use a version
of pcre from the century of the fruitbat,
- fix license marker, regen plist

reads good to jasper@@
@
text
@d2 1
a2 1
+++ configure.in	Thu Mar 26 22:07:10 2009
d54 1
a54 2
@@@@ -193,18 +158,6 @@@@ unsigned short bar = foo.source;
 
d57 1
a57 1
-
d69 1
a69 1
 
d72 28
@


1.2
log
@upgrade to ngrep 1.44

Adds IPv6 support and a number of bug fixes.
@
text
@d1 55
a55 3
--- configure.in.orig	Thu Jun 30 13:22:15 2005
+++ configure.in	Fri Jul 22 20:01:45 2005
@@@@ -196,18 +196,6 @@@@ unsigned short bar = foo.source;
d58 1
a58 1
 
d70 1
a70 1
-
a72 1
 *solaris*)
@


1.1
log
@update to ngrep 1.42

from thuglife at bsd.hu (Robert Nagy)
@
text
@d1 3
a3 4
--- configure.in.orig	Fri Apr  9 08:33:58 2004
+++ configure.in	Fri Apr  9 08:34:16 2004
@@@@ -250,16 +250,6 @@@@
 
d6 2
a8 1
-	echo 
d16 2
@

