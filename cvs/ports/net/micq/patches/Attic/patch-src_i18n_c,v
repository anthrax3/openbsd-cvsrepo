head	1.5;
access;
symbols;
locks; strict;
comment	@# @;


1.5
date	2005.06.07.06.48.13;	author mbalmer;	state dead;
branches;
next	1.4;

1.4
date	2005.05.01.22.47.28;	author david;	state Exp;
branches;
next	1.3;

1.3
date	2005.05.01.17.25.26;	author david;	state Exp;
branches;
next	1.2;

1.2
date	2001.07.25.16.13.04;	author kevlo;	state dead;
branches;
next	1.1;

1.1
date	2001.05.26.05.13.47;	author form;	state Exp;
branches;
next	;


desc
@@


1.5
log
@Update to micq-0.5.0.4

From Bernd Ahlers, b.ahlers@@ba-net.org.
@
text
@$OpenBSD: patch-src_i18n_c,v 1.4 2005/05/01 22:47:28 david Exp $
--- src/i18n.c.orig	Wed Apr 27 14:57:14 2005
+++ src/i18n.c	Sun May  1 12:18:07 2005
@@@@ -110,12 +110,12 @@@@ void i18nInit (const char *arg)
             earg = getenv ("LC_MESSAGES");
         if (!earg)
             earg = getenv ("LANG");
+        if (!earg)
+            earg = "C";
         if (earg && !prG->locale_orig)
             s_repl (&prG->locale_orig, earg);
         if (earg && !prG->locale_full)
             s_repl (&prG->locale_full, earg);
-        if (!earg)
-            earg = "C";
         if (strchr (earg, '.') && arg && !strchr (arg, '.'))
         {
             arg = earg;
@@@@ -155,7 +155,7 @@@@ int i18nOpen (const char *ploc)
     
     loc = ploc ? ploc : prG->locale_full;
 
-    if (!strcmp (loc, "en_US.US-ASCII") || !strcmp (loc, "C") || !strcmp (loc, "C"))
+    if (!loc || !strcmp (loc, "en_US.US-ASCII") || !strcmp (loc, "C"))
     {
         i18nClose ();
         if (ploc)
@


1.4
log
@remove $Id$ that cvs expanded and caused the patch to not apply
@
text
@d1 1
a1 1
$OpenBSD: patch-src_i18n_c,v 1.3 2005/05/01 17:25:26 david Exp $
@


1.3
log
@forgot to commit this fix from upstream for segfault on initialization
reminded by Bernd Ahlers
@
text
@d1 1
a1 1
$OpenBSD$
a3 9
@@@@ -26,7 +26,7 @@@@
  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
  * 02111-1307, USA.
  *
- * $Id: i18n.c,v 1.71 2005/04/27 19:57:14 kuhlmann Exp $
+ * $Id: i18n.c,v 1.72 2005/05/01 10:59:17 kuhlmann Exp $
  */
 
 #include "micq.h"
@


1.2
log
@upgrade to version 0.4.7
--
No response from maintainer
@
text
@d1 10
a10 9
$OpenBSD: patch-src_i18n_c,v 1.1 2001/05/26 05:13:47 form Exp $
--- src/i18n.c.orig	Sat May 26 11:41:53 2001
+++ src/i18n.c	Sat May 26 11:44:24 2001
@@@@ -42,7 +42,7 @@@@ int i18nOpen (const char *loc)
     if (i18nf == -1 && strchr (loc, '_'))
         i18nf = M_fdopen ("%s/.micq/%.*s.i18n", getenv ("HOME") ? getenv ("HOME") : "", strchr (loc, '_') - loc, loc);
     if (i18nf == -1)
-        return 0;
+        return -1;
d12 25
a36 2
     for (i = 0; i < i18nSLOTS; i++)
         i18nStrings[i] = NULL;
@


1.1
log
@upgrade to 0.4.6p4
@
text
@d1 1
a1 1
$OpenBSD$
@

