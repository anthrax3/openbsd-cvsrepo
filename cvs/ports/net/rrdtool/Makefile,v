head	1.101;
access;
symbols
	OPENBSD_6_0:1.97.0.2
	OPENBSD_6_0_BASE:1.97
	OPENBSD_5_9:1.93.0.2
	OPENBSD_5_9_BASE:1.93
	OPENBSD_5_8:1.90.0.4
	OPENBSD_5_8_BASE:1.90
	OPENBSD_5_7:1.87.0.2
	OPENBSD_5_7_BASE:1.87
	OPENBSD_5_6:1.82.0.2
	OPENBSD_5_6_BASE:1.82
	OPENBSD_5_5:1.77.0.2
	OPENBSD_5_5_BASE:1.77
	OPENBSD_5_4:1.71.0.2
	OPENBSD_5_4_BASE:1.71
	OPENBSD_5_3:1.67.0.2
	OPENBSD_5_3_BASE:1.67
	OPENBSD_5_2:1.65.0.4
	OPENBSD_5_2_BASE:1.65
	OPENBSD_5_1_BASE:1.65
	OPENBSD_5_1:1.65.0.2
	OPENBSD_5_0:1.64.0.2
	OPENBSD_5_0_BASE:1.64
	OPENBSD_4_9:1.60.0.2
	OPENBSD_4_9_BASE:1.60
	OPENBSD_4_8:1.50.0.2
	OPENBSD_4_8_BASE:1.50
	OPENBSD_4_7:1.47.0.4
	OPENBSD_4_7_BASE:1.47
	OPENBSD_4_6:1.47.0.2
	OPENBSD_4_6_BASE:1.47
	OPENBSD_4_5:1.44.0.2
	OPENBSD_4_5_BASE:1.44
	OPENBSD_4_4:1.42.0.2
	OPENBSD_4_4_BASE:1.42
	OPENBSD_4_3:1.41.0.2
	OPENBSD_4_3_BASE:1.41
	OPENBSD_4_2:1.37.0.2
	OPENBSD_4_2_BASE:1.37
	OPENBSD_4_1:1.36.0.4
	OPENBSD_4_1_BASE:1.36
	OPENBSD_4_0:1.36.0.2
	OPENBSD_4_0_BASE:1.36
	OPENBSD_3_9:1.35.0.2
	OPENBSD_3_9_BASE:1.35
	OPENBSD_3_8:1.30.0.4
	OPENBSD_3_8_BASE:1.30
	OPENBSD_3_7:1.30.0.2
	OPENBSD_3_7_BASE:1.30
	OPENBSD_3_6:1.27.0.2
	OPENBSD_3_6_BASE:1.27
	OPENBSD_3_5:1.24.0.2
	OPENBSD_3_5_BASE:1.24
	OPENBSD_3_4:1.20.0.4
	OPENBSD_3_4_BASE:1.20
	OPENBSD_3_3:1.20.0.2
	OPENBSD_3_3_BASE:1.20
	OPENBSD_3_2:1.19.0.2
	OPENBSD_3_2_BASE:1.19
	OPENBSD_3_1:1.18.0.2
	OPENBSD_3_1_BASE:1.18
	OPENBSD_3_0:1.17.0.2
	OPENBSD_3_0_BASE:1.17
	OPENBSD_2_9_TRACKING_SWITCH:1.14
	OPENBSD_2_9:1.14.0.2
	OPENBSD_2_9_BASE:1.14
	OPENBSD_2_8:1.8.0.2
	OPENBSD_2_8_BASE:1.8
	OPENBSD_2_7:1.6.0.2
	jakob_2000-06-14:1.1.1.1
	jakob:1.1.1;
locks; strict;
comment	@# @;


1.101
date	2017.03.18.23.06.58;	author sthen;	state Exp;
branches;
next	1.100;
commitid	DkwJki6zuZ9B8gAF;

1.100
date	2016.11.29.10.21.59;	author jca;	state Exp;
branches;
next	1.99;
commitid	R3R3jG80rVwl9pmA;

1.99
date	2016.11.29.10.21.23;	author jca;	state Exp;
branches;
next	1.98;
commitid	SqrfErSWJJ23FSSN;

1.98
date	2016.09.06.15.37.53;	author jeremy;	state Exp;
branches;
next	1.97;
commitid	f4e36rZiISVWq78c;

1.97
date	2016.04.26.15.57.28;	author sthen;	state Exp;
branches;
next	1.96;
commitid	cssCtM5fm3usUvDT;

1.96
date	2016.04.21.23.46.47;	author sthen;	state Exp;
branches;
next	1.95;
commitid	rfC2EeCn4kryJNMb;

1.95
date	2016.03.20.16.12.25;	author naddy;	state Exp;
branches;
next	1.94;
commitid	guiZq8cnNbVyyHzx;

1.94
date	2016.03.11.20.28.29;	author naddy;	state Exp;
branches;
next	1.93;
commitid	UYLP8TE6V7RS2GhJ;

1.93
date	2015.12.14.18.01.41;	author sthen;	state Exp;
branches;
next	1.92;
commitid	GyjKNPTWxSULXfcZ;

1.92
date	2015.11.23.11.41.02;	author sthen;	state Exp;
branches;
next	1.91;
commitid	rcbtmmzYFIaqlCjL;

1.91
date	2015.08.25.14.17.45;	author sthen;	state Exp;
branches;
next	1.90;
commitid	k0DyHHi71qeTKvKn;

1.90
date	2015.07.16.17.27.09;	author jeremy;	state Exp;
branches;
next	1.89;
commitid	wGOk1Dw0Jh0UvwX9;

1.89
date	2015.06.10.21.42.26;	author sthen;	state Exp;
branches;
next	1.88;
commitid	KAX1WKnTNUH3EZBA;

1.88
date	2015.05.15.13.43.40;	author sthen;	state Exp;
branches;
next	1.87;
commitid	6xKbSVFN3ZZElARU;

1.87
date	2014.10.02.13.27.33;	author sthen;	state Exp;
branches;
next	1.86;
commitid	9A0afzkGkYFmMc3Y;

1.86
date	2014.09.24.16.16.29;	author jeremy;	state Exp;
branches;
next	1.85;
commitid	CmcOfuRovtGilHQC;

1.85
date	2014.09.24.15.21.59;	author jeremy;	state Exp;
branches;
next	1.84;
commitid	nRFXbfJTzKmLZJm2;

1.84
date	2014.09.24.10.21.27;	author espie;	state Exp;
branches;
next	1.83;
commitid	5kMTjZbH0RyXfN1s;

1.83
date	2014.08.10.09.58.06;	author espie;	state Exp;
branches;
next	1.82;
commitid	jyyOLTDxRdjpw44n;

1.82
date	2014.06.14.10.34.45;	author sthen;	state Exp;
branches;
next	1.81;
commitid	HiKZ10xJk2o55vyF;

1.81
date	2014.05.07.18.13.09;	author sthen;	state Exp;
branches;
next	1.80;

1.80
date	2014.04.26.20.57.58;	author sthen;	state Exp;
branches;
next	1.79;

1.79
date	2014.04.06.17.01.34;	author sthen;	state Exp;
branches;
next	1.78;

1.78
date	2014.03.28.10.06.11;	author ajacoutot;	state Exp;
branches;
next	1.77;

1.77
date	2013.11.07.01.02.12;	author sthen;	state Exp;
branches;
next	1.76;

1.76
date	2013.11.06.22.32.56;	author sthen;	state Exp;
branches;
next	1.75;

1.75
date	2013.11.06.21.04.13;	author sthen;	state Exp;
branches;
next	1.74;

1.74
date	2013.11.06.20.25.33;	author sthen;	state Exp;
branches;
next	1.73;

1.73
date	2013.11.05.17.56.30;	author sthen;	state Exp;
branches;
next	1.72;

1.72
date	2013.11.05.17.49.01;	author sthen;	state Exp;
branches;
next	1.71;

1.71
date	2013.06.04.18.41.54;	author naddy;	state Exp;
branches;
next	1.70;

1.70
date	2013.03.21.08.46.35;	author ajacoutot;	state Exp;
branches;
next	1.69;

1.69
date	2013.03.20.19.13.50;	author jeremy;	state Exp;
branches;
next	1.68;

1.68
date	2013.03.11.11.35.56;	author espie;	state Exp;
branches;
next	1.67;

1.67
date	2012.10.15.15.18.33;	author sthen;	state Exp;
branches;
next	1.66;

1.66
date	2012.08.23.15.50.06;	author sthen;	state Exp;
branches;
next	1.65;

1.65
date	2011.09.16.11.13.40;	author espie;	state Exp;
branches;
next	1.64;

1.64
date	2011.07.19.18.00.16;	author jeremy;	state Exp;
branches;
next	1.63;

1.63
date	2011.07.18.19.06.37;	author naddy;	state Exp;
branches;
next	1.62;

1.62
date	2011.06.08.18.00.50;	author jasper;	state Exp;
branches;
next	1.61;

1.61
date	2011.03.16.12.58.42;	author sthen;	state Exp;
branches;
next	1.60;

1.60
date	2011.01.15.01.09.43;	author naddy;	state Exp;
branches;
next	1.59;

1.59
date	2010.11.24.21.35.15;	author jeremy;	state Exp;
branches;
next	1.58;

1.58
date	2010.11.19.22.31.37;	author espie;	state Exp;
branches;
next	1.57;

1.57
date	2010.11.11.17.20.27;	author espie;	state Exp;
branches;
next	1.56;

1.56
date	2010.10.29.12.45.45;	author sthen;	state Exp;
branches;
next	1.55;

1.55
date	2010.10.28.13.39.35;	author jeremy;	state Exp;
branches;
next	1.54;

1.54
date	2010.10.24.21.30.01;	author ajacoutot;	state Exp;
branches;
next	1.53;

1.53
date	2010.10.18.18.36.57;	author espie;	state Exp;
branches;
next	1.52;

1.52
date	2010.09.23.22.13.26;	author jeremy;	state Exp;
branches;
next	1.51;

1.51
date	2010.08.30.21.21.54;	author sthen;	state Exp;
branches;
next	1.50;

1.50
date	2010.07.24.23.05.08;	author naddy;	state Exp;
branches;
next	1.49;

1.49
date	2010.07.12.22.07.41;	author sthen;	state Exp;
branches;
next	1.48;

1.48
date	2010.07.01.15.49.24;	author landry;	state Exp;
branches;
next	1.47;

1.47
date	2009.06.08.10.00.37;	author sthen;	state Exp;
branches;
next	1.46;

1.46
date	2009.04.26.11.01.04;	author ajacoutot;	state Exp;
branches;
next	1.45;

1.45
date	2009.03.11.21.29.43;	author bernd;	state Exp;
branches;
next	1.44;

1.44
date	2009.01.26.21.26.32;	author sthen;	state Exp;
branches;
next	1.43;

1.43
date	2008.10.07.14.27.22;	author sthen;	state Exp;
branches;
next	1.42;

1.42
date	2008.07.28.23.41.54;	author sthen;	state Exp;
branches;
next	1.41;

1.41
date	2007.10.18.08.59.15;	author sthen;	state Exp;
branches;
next	1.40;

1.40
date	2007.10.08.08.22.42;	author steven;	state Exp;
branches;
next	1.39;

1.39
date	2007.09.28.12.07.54;	author steven;	state Exp;
branches;
next	1.38;

1.38
date	2007.09.12.14.34.36;	author msf;	state Exp;
branches;
next	1.37;

1.37
date	2007.04.03.14.54.26;	author ajacoutot;	state Exp;
branches;
next	1.36;

1.36
date	2006.08.03.23.15.58;	author espie;	state Exp;
branches;
next	1.35;

1.35
date	2006.01.08.10.23.03;	author steven;	state Exp;
branches;
next	1.34;

1.34
date	2006.01.03.15.15.43;	author steven;	state Exp;
branches;
next	1.33;

1.33
date	2005.10.24.05.11.01;	author fgsch;	state Exp;
branches;
next	1.32;

1.32
date	2005.10.22.17.18.53;	author bernd;	state Exp;
branches;
next	1.31;

1.31
date	2005.10.12.05.40.00;	author fgsch;	state Exp;
branches;
next	1.30;

1.30
date	2004.12.30.12.12.19;	author espie;	state Exp;
branches;
next	1.29;

1.29
date	2004.12.16.00.31.25;	author alek;	state Exp;
branches;
next	1.28;

1.28
date	2004.10.13.13.43.26;	author danh;	state Exp;
branches;
next	1.27;

1.27
date	2004.08.03.18.24.40;	author naddy;	state Exp;
branches;
next	1.26;

1.26
date	2004.06.22.22.00.03;	author sturm;	state Exp;
branches;
next	1.25;

1.25
date	2004.06.08.20.21.24;	author danh;	state Exp;
branches;
next	1.24;

1.24
date	2004.02.15.20.59.58;	author sturm;	state Exp;
branches;
next	1.23;

1.23
date	2004.02.09.17.30.05;	author sturm;	state Exp;
branches;
next	1.22;

1.22
date	2004.01.17.15.58.09;	author naddy;	state Exp;
branches;
next	1.21;

1.21
date	2003.12.27.23.32.06;	author jose;	state Exp;
branches;
next	1.20;

1.20
date	2002.12.27.15.26.07;	author danh;	state Exp;
branches;
next	1.19;

1.19
date	2002.05.17.15.41.30;	author danh;	state Exp;
branches;
next	1.18;

1.18
date	2001.11.21.13.57.38;	author danh;	state Exp;
branches;
next	1.17;

1.17
date	2001.10.08.16.36.57;	author danh;	state Exp;
branches;
next	1.16;

1.16
date	2001.10.04.18.10.09;	author danh;	state Exp;
branches;
next	1.15;

1.15
date	2001.09.28.06.02.14;	author pvalchev;	state Exp;
branches;
next	1.14;

1.14
date	2001.04.06.15.04.13;	author danh;	state Exp;
branches;
next	1.13;

1.13
date	2001.03.28.19.35.32;	author danh;	state Exp;
branches;
next	1.12;

1.12
date	2001.03.19.03.53.25;	author danh;	state Exp;
branches;
next	1.11;

1.11
date	2001.03.04.17.06.41;	author danh;	state Exp;
branches;
next	1.10;

1.10
date	2000.12.07.17.25.09;	author brad;	state Exp;
branches;
next	1.9;

1.9
date	2000.11.20.01.12.41;	author danh;	state Exp;
branches;
next	1.8;

1.8
date	2000.09.23.19.59.54;	author danh;	state Exp;
branches;
next	1.7;

1.7
date	2000.09.06.19.19.10;	author danh;	state Exp;
branches;
next	1.6;

1.6
date	2000.07.10.20.28.02;	author danh;	state Exp;
branches;
next	1.5;

1.5
date	2000.07.04.00.37.14;	author krw;	state Exp;
branches;
next	1.4;

1.4
date	2000.06.29.21.12.23;	author jakob;	state Exp;
branches;
next	1.3;

1.3
date	2000.06.19.09.11.27;	author camield;	state Exp;
branches;
next	1.2;

1.2
date	2000.06.15.10.39.42;	author camield;	state Exp;
branches;
next	1.1;

1.1
date	2000.06.14.05.57.49;	author jakob;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2000.06.14.05.57.49;	author jakob;	state Exp;
branches;
next	;


desc
@@


1.101
log
@Add an rrdtool patch based on one from Soner Tari, newgraph() in rrdcgi was
not allocating enough array members for two pointers (for imginfo and IMG)
causing writes beyond allocated memory in some cases.
@
text
@# $OpenBSD: Makefile,v 1.100 2016/11/29 10:21:59 jca Exp $

COMMENT-main=	system to store and display time-series data
COMMENT-update=	lightweight update-only tool for rrdtool
COMMENT-python= python interface to librrd
COMMENT-ruby=	ruby interface to librrd

MODPY_EGG_VERSION= 0.2.2
VERSION=	1.6.0
REVISION-main=	2
REVISION-ruby=	0
DISTNAME=	rrdtool-${VERSION}
PKGNAME-main=	${DISTNAME}
PKGNAME-update=	rrdupdate-${VERSION}
PKGNAME-python= py-rrd-${VERSION}
PKGNAME-ruby=	ruby-rrd-${VERSION}

SHARED_LIBS +=	rrd                  5.1      # 8.0

CATEGORIES=	net databases

MAINTAINER=	Stuart Henderson <sthen@@openbsd.org>

HOMEPAGE=	http://oss.oetiker.ch/rrdtool/
MASTER_SITES=	http://oss.oetiker.ch/rrdtool/pub/

# GPLv2+, with exemptions for use of the library with certain
# named open-source licenses; see COPYRIGHT
PERMIT_PACKAGE_CDROM=	 Yes

USE_GMAKE=	Yes

PSEUDO_FLAVORS=	no_ruby no_python
MULTI_PACKAGES= -main -python -ruby -update

MODULES=	devel/gettext lang/python lang/ruby
MODPY_SETUPTOOLS= Yes

CONFIGURE_STYLE= gnu
CPPFLAGS+=	-I${X11BASE}/include/ \
		-I${X11BASE}/include/freetype2
LDFLAGS+=	-L${LOCALBASE}/lib -L${X11BASE}/lib

CONFIGURE_ARGS+= --disable-libdbi \
		--disable-lua \
		--disable-tcl \
		--enable-perl-site-install

.include <bsd.port.arch.mk>

.if ${BUILD_PACKAGES:M-ruby}
CONFIGURE_ARGS+= --enable-ruby-site-install
CONFIGURE_ENV+=	RUBY="${RUBY}"
.else
CONFIGURE_ARGS+= --disable-ruby
MODRUBY_BUILDDEP= No
MODRUBY_RUNDEP=   No
.endif

.if ${BUILD_PACKAGES:M-python}
CONFIGURE_ARGS+= --enable-python
.else
CONFIGURE_ARGS+= --disable-python
MODPY_BUILDDEP= No
MODPY_RUNDEP=   No
.endif

# needs checking before enabling mmap; is it safe without UBC?
CONFIGURE_ARGS+= --disable-mmap

CONFIGURE_ENV+=	CPPFLAGS="${CPPFLAGS}" \
		LDFLAGS="${LDFLAGS}"
# autoconf insists on these, but the docs are pre-formatted in the distfile,
# so they aren't needed.
CONFIGURE_ENV+=	NROFF="/usr/bin/true" \
		TROFF="/usr/bin/true"

cWANTLIB=	pthread
WANTLIB-update=	${cWANTLIB} ${MODGETTEXT_WANTLIB} c glib-2.0 m pcre
WANTLIB-python=	${cWANTLIB} ${MODPY_WANTLIB} rrd
WANTLIB-ruby=	${cWANTLIB} ${MODRUBY_WANTLIB} c gmp m rrd
# depends on Perl ABI
WANTLIB-main=	${cWANTLIB} ${MODGETTEXT_WANTLIB} perl
WANTLIB-main += X11 Xext Xrender c cairo expat ffi fontconfig freetype
WANTLIB-main += glib-2.0 gmodule-2.0 gobject-2.0 graphite2 gthread-2.0
WANTLIB-main += harfbuzz lzma m pango-1.0 pangocairo-1.0
WANTLIB-main += pangoft2-1.0 pcre pixman-1 png pthread-stubs xcb
WANTLIB-main += xcb-render xcb-shm xml2 z

LIB_DEPENDS-main=	devel/glib2 \
			devel/pango \
			graphics/png \
			textproc/libxml
RUN_DEPENDS-main=	rrdupdate-${VERSION}:net/rrdtool,-update

LIB_DEPENDS-update=	${MODGETTEXT_LIB_DEPENDS} \
			devel/glib2 \
			devel/pcre
RUN_DEPENDS-update=

LIB_DEPENDS-python=	rrdtool-${VERSION}:net/rrdtool
RUN_DEPENDS-python=	${MODPY_RUN_DEPENDS}

LIB_DEPENDS-ruby=	rrdtool-${VERSION}:net/rrdtool \
			${MODRUBY_LIB_DEPENDS}
RUN_DEPENDS-ruby=	${MODRUBY_RUN_DEPENDS}

# Overriden by python.port.mk
TEST_TARGET=		check
TEST_DEPENDS=		shells/bash \
			sysutils/coreutils

pre-test:
	find ${WRKSRC}/tests -type f -perm -0111 \
	    -exec sed -i '1s,#!.*bash,#!${LOCALBASE}/bin/bash,' {} +
	ln -s ${LOCALBASE}/bin/gseq ${WRKDIR}/bin/seq

post-install:
	cd ${WRKSRC}; ${INSTALL_DATA} CHANGES COPYRIGHT \
	    NEWS ${PREFIX}/share/doc/rrdtool
	rm -r ${PREFIX}/share/doc/rrdtool/txt
	${SUBST_PROGRAM} ${FILESDIR}/rrdtool-chroot.sh \
	    ${PREFIX}/share/examples/rrdtool/rrdtool-chroot
	rm -rf ${PREFIX}/share/doc/rrdtool/html

.include <bsd.port.mk>
@


1.100
log
@Fix some time_t warnings, potentially harmful on 32 bits archs.

ok sthen@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.98 2016/09/06 15:37:53 jeremy Exp $
d10 1
a10 1
REVISION-main=	1
@


1.99
log
@Enable tests

Two tests are currently failing (reason unknown).

ok sthen@@ (maintainer)
@
text
@d10 1
a10 1
REVISION-main=	0
@


1.98
log
@Bump ruby dependent ports after default ruby version switch from ruby
2.2 to ruby 2.3.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.97 2016/04/26 15:57:28 sthen Exp $
d107 10
@


1.97
log
@fix rrdtool-chroot.sh script, problem reported by Predrag Punosevac,
he didn't get chance to test yet but it works for my use case anyway.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.96 2016/04/21 23:46:47 sthen Exp $
d11 1
@


1.96
log
@update to rrdtool-1.6.0, librrd_th is removed,
the main library is now meant to be thread-safe
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.95 2016/03/20 16:12:25 naddy Exp $
d10 1
@


1.95
log
@drop SHARED_ONLY from python and ruby ports
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.94 2016/03/11 20:28:29 naddy Exp $
d9 1
a9 2
VERSION=	1.5.5
REVISION=	0
d16 1
a16 2
SHARED_LIBS +=	rrd                  5.0      # 7.0
SHARED_LIBS +=	rrd_th               5.0      # 7.0
@


1.94
log
@garbage collect CONFIGURE_SHARED
@
text
@d1 1
a1 3
# $OpenBSD: Makefile,v 1.93 2015/12/14 18:01:41 sthen Exp $

SHARED_ONLY=	Yes
@


1.93
log
@oops, -DDEBUG crept in with the last update, remove it again
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.92 2015/11/23 11:41:02 sthen Exp $
d46 1
a46 2
CONFIGURE_ARGS+= ${CONFIGURE_SHARED} \
		--disable-libdbi \
@


1.92
log
@update to rrdtool-1.5.5
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.87 2014/10/02 13:27:33 sthen Exp $
d12 1
d74 1
a74 1
CONFIGURE_ENV+=	CPPFLAGS="${CPPFLAGS} -DDEBUG" \
@


1.91
log
@wantlib
@
text
@d1 1
a1 3
# $OpenBSD: Makefile,v 1.90 2015/07/16 17:27:09 jeremy Exp $

PORTROACH_COMMENT= rrdcached crashes at startup in 1.5.0 to at least 1.5.3
d11 1
a11 2
VERSION=	1.4.9
REVISION-main=	0
a16 1
REVISION-ruby=	1
d18 2
a19 2
SHARED_LIBS +=	rrd                  4.0      # 6.1
SHARED_LIBS +=	rrd_th               4.0      # 6.1
d28 1
a28 1
# GPLv2+, with exceptions for use of the library with certain
d38 1
d73 1
a73 1
CONFIGURE_ENV+=	CPPFLAGS="${CPPFLAGS}" \
d81 1
a81 1
WANTLIB-update=	${cWANTLIB} c m
d92 1
a92 1
LIB_DEPENDS-main=	graphics/png \
d94 1
d98 3
a100 1
LIB_DEPENDS-update=
d111 2
a112 2
	cd ${WRKSRC}; ${INSTALL_DATA} CHANGES CONTRIBUTORS COPYRIGHT \
	    NEWS README ${PREFIX}/share/doc/rrdtool
@


1.90
log
@Switch the default ruby version from ruby 2.1 to 2.2, and bump affected
ports.

OK jcs@@ ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.89 2015/06/10 21:42:26 sthen Exp $
d20 1
a20 1
REVISION-ruby=	0
d86 1
a86 1
WANTLIB-ruby=	${cWANTLIB} ${MODRUBY_WANTLIB} c m rrd
@


1.89
log
@sync wantlib, mostly lzma (from xml2)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.88 2015/05/15 13:43:40 sthen Exp $
d20 1
@


1.88
log
@sprinkle some PORTROACH_COMMENTs
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.87 2014/10/02 13:27:33 sthen Exp $
d14 1
d90 1
a90 1
WANTLIB-main += harfbuzz m pango-1.0 pangocairo-1.0
@


1.87
log
@update to rrdtool 1.4.9
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.86 2014/09/24 16:16:29 jeremy Exp $
@


1.86
log
@Remove setting of MODRUBY_REV explicitly, just use the default ruby

discussed with aja@@ and espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.85 2014/09/24 15:21:59 jeremy Exp $
d11 1
a11 5
VERSION=	1.4.8
REVISION-main=	6
REVISION-ruby=	4
REVISION-python=0
REVISION-update=0
@


1.85
log
@Set MODRUBY_REV explicitly, instead of relying on default ruby version
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.84 2014/09/24 10:21:27 espie Exp $
a41 1
MODRUBY_REV=	2.1
@


1.84
log
@missed ruby bump
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.83 2014/08/10 09:58:06 espie Exp $
d42 1
@


1.83
log
@use more specific version of SUBST_* where appropriate
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.82 2014/06/14 10:34:45 sthen Exp $
d13 1
a13 1
REVISION-ruby=	3
@


1.82
log
@@@comment zero-byte perl .bs files in all packages which don't have p5-* PKGNAMEs
and bump
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.81 2014/05/07 18:13:09 sthen Exp $
d114 1
a114 2
	${SUBST_CMD} -c -o ${BINOWN} -g ${BINGRP} -m ${BINMODE} \
	    ${FILESDIR}/rrdtool-chroot.sh \
@


1.81
log
@tweak README, just talk about "a chrooted web server" rather than being
specific.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.80 2014/04/26 20:57:58 sthen Exp $
d12 1
a12 1
REVISION-main=	5
@


1.80
log
@set rrdcache control socket permissions to mode 770 by default in the rc script
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.79 2014/04/06 17:01:34 sthen Exp $
d12 1
a12 1
REVISION-main=	4
@


1.79
log
@Remove MODRUBY_REV and switch to the default Ruby version now that packages
are available on a wider range of arches. Adjust comments in rrdtool-chroot
script (talk about "web server" rather than Apache).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.78 2014/03/28 10:06:11 ajacoutot Exp $
d12 1
a12 1
REVISION-main=	3
@


1.78
log
@Tweak wantlib and add devel/gettext MODULE.
Make sure -ruby does not depends on python.

ok sthen@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.77 2013/11/07 01:02:12 sthen Exp $
d12 2
a13 2
REVISION-main=	2
REVISION-ruby=	2
a41 1
MODRUBY_REV=	1.8# XXX ruby 1.9/2.0 work too, but don't build on sparc64 et al
@


1.77
log
@the "rrdtool-chroot" script takes an enable/disable flag, include "enable"
in the example in README.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.76 2013/11/06 22:32:56 sthen Exp $
d12 4
a15 2
REVISION-main=	1
REVISION-ruby=	1
d41 1
a41 1
MODULES=	lang/python lang/ruby
d84 4
a87 4
WANTLIB=	pthread
WANTLIB-update=	${WANTLIB} c m
WANTLIB-python=	${WANTLIB} ${MODPY_WANTLIB} rrd
WANTLIB-ruby=	${WANTLIB} ${MODRUBY_WANTLIB} c m rrd
d89 1
a89 1
WANTLIB-main=	${WANTLIB} perl
d92 1
a92 1
WANTLIB-main += harfbuzz iconv intl m pango-1.0 pangocairo-1.0
d101 1
d109 1
@


1.76
log
@blech, unbreak
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.75 2013/11/06 21:04:13 sthen Exp $
d12 1
a12 1
REVISION-main=	0
@


1.75
log
@..and drop to 1.8; Markus points out that actually ruby 1.9 is broken on
sparc64 too :( cleanup BUILD_PACKAGES bits while there.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.74 2013/11/06 20:25:33 sthen Exp $
d57 1
a59 1
CONFIGURE_ENV+=	RUBY="${RUBY}"
@


1.74
log
@Switch to MODRUBY_REV=1.9, because 2.0 builds fails on sparc64, requested by
Markus Lude. Also add BUILD_PACKAGES scaffolding to permit users to build
this without pulling in dependencies for possibly-unwanted py/ruby bindings.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.73 2013/11/05 17:56:30 sthen Exp $
d13 1
a13 1
REVISION-ruby=	0
d40 1
a40 1
MODRUBY_REV=	1.9# XXX ruby 2.0 works too, but doesn't build on sparc64 et al
d59 3
d68 2
d76 1
a76 2
		LDFLAGS="${LDFLAGS}" \
		RUBY="${RUBY}"
@


1.73
log
@roll uid to 726 (conflicted with opengroupware)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.72 2013/11/05 17:49:01 sthen Exp $
d13 1
d36 1
d40 1
d51 16
a66 3
		--enable-perl-site-install \
		--enable-python \
		--enable-ruby-site-install
@


1.72
log
@Update to rrdtool 1.4.8. Merge p5-RRD into the main package.

Note that this now uses cairo for graphics generation and pango/fontconfig
for text rendering; if you are using this in a chroot jail (for cgi/php
scripts, etc) you will need to take additional steps to install the relevant
files. A script is provided to copy the relevant libraries and support files;
see /usr/local/share/doc/pkg-readmes/rrdtool-1.4.8 for more details.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62 2011/06/08 18:00:50 jasper Exp $
d12 1
@


1.71
log
@the png headers are now directly under include/
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.70 2013/03/21 08:46:35 ajacoutot Exp $
d6 2
a7 2
COMMENT-perl=	perl interface to librrd
COMMENT-python=	python interface to librrd
d10 2
a11 1
VERSION=	1.2.30
d13 2
a14 2
PKGNAME-main=	rrdtool-${VERSION}
PKGNAME-perl=	p5-RRD-${VERSION}
a16 4
REVISION-main=	3
REVISION-perl=	3
REVISION-python=5
REVISION-ruby=	10
d18 2
a19 2
SHARED_LIBS+=	rrd 3.0
SHARED_LIBS+=	rrd_th 3.0
d24 1
d26 1
d28 3
a30 4
# GPLv2+
PERMIT_PACKAGE_CDROM=	Yes

MASTER_SITES=	${HOMEPAGE}pub/
a32 1
USE_GROFF =	Yes
d34 1
a34 1
MULTI_PACKAGES=	-main -perl -python -ruby
d39 4
d44 3
d49 4
a52 6
		--enable-ruby-site-install \
		--disable-tcl
CPPFLAGS+=	-I${LOCALBASE}/include/libart-2.0 \
		-I${X11BASE}/include/ \
		-I${X11BASE}/include/freetype2
LDFLAGS+=	-L${LOCALBASE}/lib -L${X11BASE}/lib
d56 16
a72 1
WANTLIB-main=		c m z freetype png art_lgpl_2
d74 3
a76 2
			graphics/libart
RUN_DEPENDS-main=
d78 1
a78 3
WANTLIB-perl=		c m z rrd
LIB_DEPENDS-perl=	rrdtool-${VERSION}:net/rrdtool
RUN_DEPENDS-perl=
a79 1
WANTLIB-python =	c pthread rrd ${MODPY_WANTLIB}
a81 1
MODPY_EGG_VERSION=	0.2.1
a82 1
MODRUBY_REV=		1.8
d85 9
a93 1
WANTLIB-ruby=		c m rrd ${MODRUBY_WANTLIB}
@


1.70
log
@USE_LIBTOOL=Yes is the default now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.69 2013/03/20 19:13:50 jeremy Exp $
a47 1
		-I${LOCALBASE}/include/libpng \
@


1.69
log
@Make ruby 1.9 the default ruby for non-gem/extconf ports,
for consistency with the gem/extconf ports.

Update non-gem/extconf ports that relied on the previous
default of ruby 1.8 to explicitly specify it.

OK ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.68 2013/03/11 11:35:56 espie Exp $
a34 1
USE_LIBTOOL=	Yes
@


1.68
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.67 2012/10/15 15:18:33 sthen Exp $
d71 1
@


1.67
log
@zap trailing whitespace in files where it's present on PERMIT_* lines
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.66 2012/08/23 15:50:06 sthen Exp $
a30 3
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
@


1.66
log
@sync wantlib
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.65 2011/09/16 11:13:40 espie Exp $
d3 1
a3 1
SHARED_ONLY=	Yes 
d30 4
a33 4
PERMIT_PACKAGE_CDROM=	Yes 
PERMIT_PACKAGE_FTP=	Yes 
PERMIT_DISTFILES_CDROM=	Yes 
PERMIT_DISTFILES_FTP=	Yes 
d63 1
a63 1
RUN_DEPENDS-main=	
d67 1
a67 1
RUN_DEPENDS-perl=	
@


1.65
log
@normalize pkgpath
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.64 2011/07/19 18:00:16 jeremy Exp $
d17 2
a18 2
REVISION-perl=	2
REVISION-python=4
d65 1
a65 1
WANTLIB-perl=		m z rrd
d69 1
a69 1
WANTLIB-python =	rrd
@


1.64
log
@Bump after change to remove OpenBSD version from ruby SITEARCHDIR,
and use new MODRUBY_SITEDIR and MODRUBY_SITEARCHDIR variables in
PLIST.

OK landry@@, jcs@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.63 2011/07/18 19:06:37 naddy Exp $
d17 3
a19 3
REVISION-perl=	1
REVISION-python=3
REVISION-ruby=	9
@


1.63
log
@bump revision for plist changes 4.9 -> 5.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62 2011/06/08 18:00:50 jasper Exp $
d19 1
a19 1
REVISION-ruby=	8
@


1.62
log
@bump after default python version switch
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.61 2011/03/16 12:58:42 sthen Exp $
d19 1
a19 1
REVISION-ruby=	7
@


1.61
log
@take MAINTAINER; ok msf@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.60 2011/01/15 01:09:43 naddy Exp $
d16 4
a19 4
REVISION-main=	2
REVISION-perl=	0
REVISION-python=2
REVISION-ruby=	6
@


1.60
log
@bump revision for plist changes 4.8 -> 4.9
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59 2010/11/24 21:35:15 jeremy Exp $
d16 4
a19 3
REVISION-main=	1
REVISION-python=1
REVISION-ruby=	5
d26 1
a26 1
MAINTAINER=	Mathieu Sauve-Frankel <msf@@openbsd.org>
@


1.59
log
@REVISION bump all ruby ports due to a change in the pkgspec.
Previously, we were using ruby->=1.8,<=1.9, instead of
ruby->=1.8,<1.9.  While this wouldn't cause an issue, since
our ruby-1.9.2 package isn't included in ruby->=1.8,<=1.9,
it's still wrong and should be fixed.  This also fixes the
following minor issues:

Switch from using FLAVOR to MODRUBY_FLAVOR for *_DEPENDS.
Currently we don't have a ruby port that uses FLAVORs that
would differ from MODRUBY_FLAVOR, but it's possible we will
in the future.

Switch from BASE_PKGPATH to BUILD_PKGPATH in a few cases in
REGRESS_DEPENDS.  This probably is not strictly necessary, but
BUILD_PKGPATH is used in more cases, so it is good for
consistency.

Switch to new style *_DEPENDS, with the version specification
at the end.  The remaining cases where this is not done is
because a specific version is used.

Some FULLPKGNAME added to REGRESS_DEPENDS, to make sure that if
the old version is installed when you run a regress test, it
will install the new version first.

Some conversion of spaces to tabs for consistency.

OK landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2010/11/19 22:31:37 espie Exp $
d18 1
a18 1
REVISION-ruby=	4
@


1.58
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.57 2010/11/11 17:20:27 espie Exp $
d18 1
a18 1
REVISION-ruby=	3
@


1.57
log
@finish net WANTLIB
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2010/10/29 12:45:45 sthen Exp $
d60 2
a61 2
LIB_DEPENDS-main=	::graphics/png \
			::graphics/libart
d65 1
a65 1
LIB_DEPENDS-perl=	:rrdtool-${VERSION}:net/rrdtool
d69 1
a69 1
LIB_DEPENDS-python=	:rrdtool-${VERSION}:net/rrdtool
d73 1
a73 1
LIB_DEPENDS-ruby=	:rrdtool-${VERSION}:net/rrdtool \
@


1.56
log
@set RUBY=${RUBY} in the environment rather than patching configure.
ok jeremy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55 2010/10/28 13:39:35 jeremy Exp $
d59 3
a61 3
WANTLIB-main=		c m z freetype
LIB_DEPENDS-main=	png::graphics/png \
			art_lgpl_2::graphics/libart
d64 2
a65 2
WANTLIB-perl=		m z
LIB_DEPENDS-perl=	rrd:rrdtool-${VERSION}:net/rrdtool
d68 2
a69 1
LIB_DEPENDS-python=	rrd:rrdtool-${VERSION}:net/rrdtool
@


1.55
log
@Add ruby18 WANTLIB back to -ruby subpackage.  This should have been
committed with the other ports during the MODRUBY_WANTLIB /
MODRUBY_LIB_DEPENDS split.  Since it's possible someone could have
build the port since the split, bump for safety.

OK landry, sthen
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.54 2010/10/24 21:30:01 ajacoutot Exp $
d55 3
a57 1
CONFIGURE_ENV+=	CPPFLAGS="${CPPFLAGS}" LDFLAGS="${LDFLAGS}"
@


1.54
log
@Remove USE_X11.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2010/10/18 18:36:57 espie Exp $
d18 1
a18 1
REVISION-ruby=	2
d70 1
a70 1
LIB_DEPENDS-ruby=	rrd:rrdtool-${VERSION}:net/rrdtool \
d72 1
a72 1
WANTLIB-ruby=		c m
@


1.53
log
@USE_GROFF=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.52 2010/09/23 22:13:26 jeremy Exp $
a36 1
USE_X11=	Yes
@


1.52
log
@Handle changes caused by splitting the ruby port and bump

OK jcs@@, landry@@, jasper@@, sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 2010/08/30 21:21:54 sthen Exp $
d39 1
@


1.51
log
@bumps for new python
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2010/07/24 23:05:08 naddy Exp $
d18 1
a18 1
REVISION-ruby=	1
@


1.50
log
@bump PKGNAME for PLIST changes 4.7 -> 4.8
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2010/07/12 22:07:41 sthen Exp $
d16 3
a18 3
REVISION-main=	0
REVISION-python=0
REVISION-ruby=	0
@


1.49
log
@use REVISION, checked with before/after make show=PKGNAMES (plus some
extra-careful checking where there are complicated PSEUDO_FLAVORS).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2010/07/01 15:49:24 landry Exp $
d18 1
@


1.48
log
@Add a -ruby subpackage providing rrdruby (aka RRD.so ruby module), not the
same interface as ruby-rrdtool.
General mumbling of agreement from msf@@ bernd@@ sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2009/06/08 10:00:37 sthen Exp $
d12 1
a12 1
PKGNAME-main=	rrdtool-${VERSION}p0
d14 1
a14 1
PKGNAME-python= py-rrd-${VERSION}p0
d16 2
@


1.47
log
@CATEGORIES+=databases; ok msf@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2009/04/26 11:01:04 ajacoutot Exp $
d7 2
a8 1
COMMENT-python= python interface to librrd
d12 1
a12 1
PKGNAME-main=	rrdtool-${VERSION}
d15 1
d37 1
a37 1
MULTI_PACKAGES=	-main -perl -python
d39 1
a39 1
MODULES=	lang/python
d45 1
a45 1
		--disable-ruby \
d66 4
@


1.46
log
@CONFIGURE_ENV += PYTHON="${MODPY_BIN}" is inherited from the python module
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2009/03/11 21:29:43 bernd Exp $
d18 1
a18 1
CATEGORIES=	net
@


1.45
log
@bump because of python dep change
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2009/01/26 21:26:32 sthen Exp $
d50 1
a50 2
CONFIGURE_ENV+=	CPPFLAGS="${CPPFLAGS}" LDFLAGS="${LDFLAGS}" \
		PYTHON=${MODPY_BIN}
@


1.44
log
@update to newest 1.2 release (1.2.30), maintainer doesn't necessarily
agree with staying with 1.2.x but doesn't mind too much either way
and 1.3 adds heavy dependencies.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2008/10/07 14:27:22 sthen Exp $
d13 1
a13 1
PKGNAME-python= py-rrd-${VERSION}
@


1.43
log
@I missed this package bump needed for the Perl update.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2008/07/28 23:41:54 sthen Exp $
d9 1
a9 1
VERSION=	1.2.23
d11 3
a13 3
PKGNAME-main=	${DISTNAME}p0
PKGNAME-perl=	p5-RRD-${VERSION}p1
PKGNAME-python= py-rrd-${VERSION}p1
d23 1
a23 1
# GPL
d58 1
a58 1
WANTLIB-perl=		m
d64 1
@


1.42
log
@SHARED_LIBS and PKGNAME bumps for libm.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2007/10/18 08:59:15 sthen Exp $
d12 1
a12 1
PKGNAME-perl=	p5-RRD-${VERSION}p0
@


1.41
log
@adjust subpackage LIB_DEPENDS to depend on the current version of rrdtool;
fixes some upgrade situations. bump relevant subpackages.

ok msf (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2007/10/08 08:22:42 steven Exp $
d11 1
a11 1
PKGNAME-main=	${DISTNAME}
d15 2
a16 2
SHARED_LIBS+=	rrd 2.10
SHARED_LIBS+=	rrd_th 2.8
@


1.40
log
@bump PKGNAME after python version switch
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2007/09/28 12:07:54 steven Exp $
d12 2
a13 2
PKGNAME-perl=	p5-RRD-${VERSION}
PKGNAME-python= py-rrd-${VERSION}p0
d59 1
a59 1
LIB_DEPENDS-perl=	rrd::net/rrdtool
d62 1
a62 1
LIB_DEPENDS-python=	rrd::net/rrdtool
@


1.39
log
@use default version of python
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2007/09/12 14:34:36 msf Exp $
d13 1
a13 1
PKGNAME-python= py-rrd-${VERSION}
@


1.38
log
@long overdue update to 1.2.23

remove TCL FLAVOUR
split perl bindings into a subpackage
provide python bindings as a subpackage
take maintainer

ok and 64 bit fixes sthen@@, ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2007/04/03 14:54:26 ajacoutot Exp $
d50 2
a51 1
CONFIGURE_ENV+=	CPPFLAGS="${CPPFLAGS}" LDFLAGS="${LDFLAGS}"
@


1.37
log
@- HOMEPAGE has changed
from Markus Lude <markus-openbsd at anthill dot de>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2006/08/03 23:15:58 espie Exp $
d3 1
a3 1
NOT_FOR_ARCHS=	${NO_SHARED_ARCHS}
d5 12
a16 1
COMMENT=	"system to store and display time-series data"
a17 4
RRDVERSION=	1.0.49
DISTNAME=	rrdtool-${RRDVERSION}
PKGNAME=	${DISTNAME}p4
SHARED_LIBS=	rrd	0.0
a18 2
MASTER_SITES=	${HOMEPAGE}pub/rrdtool-1.0.x/ \
		http://ftp.sunet.se/pub/network/monitoring/rrdtool/rrdtool-1.0.x/
d20 1
a22 2
MAINTAINER=	Dan Harnett <danh@@openbsd.org>

d29 1
a29 1
WANTLIB=		c freetype fontconfig jpeg m png z 
d31 3
a33 1
MODULES=	converters/libiconv
d35 1
a35 1
SUBST_VARS=	RRDVERSION
d37 1
a37 2
FLAVORS=	tcl
FLAVOR?=
a38 4
LIB_DEPENDS=	gd.>=18::graphics/gd

USE_X11=	Yes
USE_LIBTOOL=	Yes
d40 20
a59 15
CONFIGURE_ARGS+= ${CONFIGURE_SHARED} --enable-static \
		--enable-local-libpng \
		--enable-local-zlib
MODGNU_CONFIG_GUESS_DIRS=${WRKSRC}/config ${WRKSRC}/contrib/php4

.if ${FLAVOR:L:Mtcl}
LIB_DEPENDS+=	tcl84:tcl-8.4.*:lang/tcl/8.4
USE_GMAKE=	Yes
CONFIGURE_ARGS+= --with-tcllib="${LOCALBASE}/lib/tcl8.4"
CFLAGS+=	-I${LOCALBASE}/include/tcl8.4
INSTALL_TARGET=	install site-tcl-install
FAKE_FLAGS+=	MACHINE_ARCH="${MACHINE_ARCH}"
.else
CONFIGURE_ARGS+= --without-tcllib
.endif
d61 2
a62 1
CFLAGS+=	-I${LOCALBASE}/include/libpng
@


1.36
log
@new style specs
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2006/01/08 10:23:03 steven Exp $
d9 1
a9 1
PKGNAME=	${DISTNAME}p3
d15 1
a15 1
HOMEPAGE=	http://people.ee.ethz.ch/~oetiker/webtools/rrdtool/
@


1.35
log
@remove MODGNU_SHARED_LIBS
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2006/01/03 15:15:43 steven Exp $
d34 1
a34 1
LIB_DEPENDS=	gd.18::graphics/gd
@


1.34
log
@SHARED_LIBS and USE_LIBTOOL
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2005/10/24 05:11:01 fgsch Exp $
d10 1
a10 2
SHARED_LIBS=		rrd	0.0
MODGNU_SHARED_LIBS=	rrd	''
@


1.33
log
@fix more breakage due to my recent gd update. sturm@@ ok.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2005/10/22 17:18:53 bernd Exp $
d9 3
a11 1
PKGNAME=	${DISTNAME}p2
d38 1
a38 1

@


1.32
log
@update MASTER_SITES

ok fgsch@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2005/10/12 05:40:00 fgsch Exp $
d9 1
a9 1
PKGNAME=	${DISTNAME}p1
d23 2
a24 1
WANTLIB=		X11 Xpm c freetype fontconfig jpeg m png ttf z 
d34 2
@


1.31
log
@more gd sync.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2004/12/30 12:12:19 espie Exp $
d11 2
a12 3
MASTER_SITES=	http://people.ee.ethz.ch/~oetiker/webtools/rrdtool/pub/ \
		ftp://ftp.sunet.se/pub/network/monitoring/rrdtool/ \
		http://ftp.sunet.se/pub/network/monitoring/rrdtool/
@


1.30
log
@fix tcl depend
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2004/12/16 00:31:25 alek Exp $
d9 2
a10 1
CATEGORIES=     net
d24 3
a26 1
WANTLIB=		c jpeg m ttf z 
d33 1
a33 2
LIB_DEPENDS=	png.4::graphics/png \
		gd.18::graphics/gd
a47 1
PKGNAME=	${DISTNAME}p0
@


1.29
log
@Add WANTLIB markers
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2004/10/13 13:43:26 danh Exp $
d40 1
a40 1
LIB_DEPENDS+=	tcl84::lang/tcl/8.4
d46 1
@


1.28
log
@update to rrdtool 1.0.49
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2004/08/03 18:24:40 naddy Exp $
d23 1
@


1.27
log
@fix up MODGNU_CONFIG_GUESS_DIRS
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2004/06/22 22:00:03 sturm Exp $
d7 1
a7 1
RRDVERSION=	1.0.48
@


1.26
log
@fix tcl FLAVOR, which was obviously NOT tested before commit
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2004/06/08 20:21:24 danh Exp $
d36 1
a36 1
MODGNU_CONFIG_GUESS_DIRS= ${WRKSRC} ${WRKSRC}/config ${WRKSRC}/contrib/php4
@


1.25
log
@update to rrdtool 1.0.48
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2004/02/15 20:59:58 sturm Exp $
d43 2
a49 5

.if ${FLAVOR:L:Mtcl}
post-install:
	cd ${WRKSRC} && ${MAKE} site-tcl-install
.endif
@


1.24
log
@fix build of tcl flavor
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2004/02/09 17:30:05 sturm Exp $
d7 2
a8 2
VERSION=	1.0.46
DISTNAME=	rrdtool-${VERSION}
d24 1
a24 1
SUBST_VARS=	VERSION
d29 2
a30 1
LIB_DEPENDS=	png.4::graphics/png
@


1.23
log
@update to rrdtool 1.0.46
- use system libpng/libz
- fix 64bit bug preventing usage
- fix sparc/sparc64 crashes (reported by henning@@)

ok maintainer danh@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2004/01/17 15:58:09 naddy Exp $
d41 1
a41 1
CONFIGURE_ENV+=	CFLAGS="${CFLAGS} -I${LOCALBASE}/include/tcl8.4"
d46 1
a46 1
MAKE_FLAGS=	CFLAGS="-I${LOCALBASE}/include/libpng"
@


1.22
log
@Don't attempt to build perl ports that load dynamic modules
on architectures that support static linking only.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2003/12/27 23:32:06 jose Exp $
d7 1
a7 1
VERSION=	1.0.40
d18 1
d29 2
d32 3
a34 1
CONFIGURE_ARGS+= ${CONFIGURE_SHARED} --enable-static
d46 2
a51 7

post-patch:
	@@cd ${WRKSRC}/config; \
	${PATCH} --forward --quiet -E < \
		${PORTSDIR}/infrastructure/patches/patch-lt1.3.4-ltconfig && \
	${PATCH} --forward --quiet -E < \
		${PORTSDIR}/infrastructure/patches/patch-lt1.3.4-ltmain_sh
@


1.21
log
@
update to tcl/tk 8.4, ok brad@@ naddy@@
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.20 2002/12/27 15:26:07 danh Exp $
@


1.20
log
@update to rrdtool 1.0.40
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2002/05/17 15:41:30 danh Exp $
d31 1
a31 1
LIB_DEPENDS+=	tcl83::lang/tcl/8.3
d33 2
a34 2
CONFIGURE_ARGS+= --with-tcllib="${LOCALBASE}/lib/tcl8.3"
CONFIGURE_ENV+=	CFLAGS="${CFLAGS} -I${LOCALBASE}/include/tcl8.3"
@


1.19
log
@update to rrdtool 1.0.37
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2001/11/21 13:57:38 danh Exp $
d5 1
a5 1
VERSION=	1.0.37
a7 1
NEED_VERSION=	1.468
@


1.18
log
@- MASTER_SITES and HOMEPAGE update from jakob@@
- change checksums file
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2001/10/08 16:36:57 danh Exp $
d5 1
a5 1
VERSION=	1.0.33
@


1.17
log
@use in tree libtool patches
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2001/10/04 18:10:09 danh Exp $
d9 1
a9 1
MASTER_SITES=	http://ee-staff.ethz.ch/~oetiker/webtools/rrdtool/pub/ \
d13 1
a13 1
HOMEPAGE=	http://ee-staff.ethz.ch/~oetiker/webtools/rrdtool/
@


1.16
log
@bump NEED_VERSION; sync libtool patches
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2001/09/28 06:02:14 pvalchev Exp $
d44 7
@


1.15
log
@CONFIGURE_STYLE=gnu w/ proper MODGNU_CONFIG_GUESS_DIRS
needed for the powerpc -> macppc name change
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2001/04/06 15:04:13 danh Exp $
d8 1
a8 1
NEED_VERSION=	1.364
a27 1
MODGNU_CONFIG_GUESS_DIRS=	${WRKSRC} ${WRKSRC}/config ${WRKSRC}/contrib/php4
d29 1
@


1.14
log
@no longer use internal zlib
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2001/03/28 19:35:32 danh Exp $
d28 1
@


1.13
log
@bump NEED_VERSION and integrate COMMENT
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2001/03/19 03:53:25 danh Exp $
a26 5
.if ${FLAVOR:L:Mtcl}
LIB_DEPENDS+=	tcl83::lang/tcl/8.3
USE_GMAKE=	Yes
.endif

d31 2
@


1.12
log
@respect CFLAGS
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.11 2001/03/04 17:06:41 danh Exp $
d8 1
a8 1
NEED_VERSION=	1.358
@


1.11
log
@- update to rrdtool 1.0.33
- use bundled libraries again for now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2000/12/07 17:25:09 brad Exp $
a31 2
CONFIGURE_ENV=	LDFLAGS="-L${LOCALBASE}/lib" \
		CPPFLAGS="-I${LOCALBASE}/include"
d35 1
a35 1
CONFIGURE_ENV+=	CFLAGS="-I${LOCALBASE}/include/tcl8.3"
@


1.10
log
@remove the need for a separate copy of libtool.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2000/11/20 01:12:41 danh Exp $
d3 1
a3 1
VERSION=	1.0.28
d6 1
a6 1
NEED_VERSION=	1.340
a24 1
LIB_DEPENDS+=	gd.18::graphics/gd
a26 3
.endif

.if ${FLAVOR:L:Mtcl}
d31 1
a31 2
CONFIGURE_ARGS+= ${CONFIGURE_SHARED}
CONFIGURE_ARGS+= --enable-static
@


1.9
log
@update to 1.0.28
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2000/09/23 19:59:54 danh Exp $
a29 1
USE_LIBTOOL=	Yes
d35 4
a38 3
CONFIGURE_ARGS=	${CONFIGURE_SHARED}
CONFIGURE_ENV=	LDFLAGS='-L${LOCALBASE}/lib' \
		CPPFLAGS='-I${LOCALBASE}/include'
d41 2
a42 2
CONFIGURE_ARGS+= --with-tcllib='${LOCALBASE}/lib/tcl8.3'
CONFIGURE_ENV+=	CFLAGS='-I${LOCALBASE}/include/tcl8.3'
@


1.8
log
@added real name to MAINTAINER
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2000/09/06 19:19:10 danh Exp $
d3 1
a3 1
VERSION=	1.0.25
d6 1
a6 1
NEED_VERSION=	1.334
@


1.7
log
@- upgraded to rrdtool 1.0.25
- added dependencies on devel/libtool, graphics/gd
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2000/07/10 20:28:02 danh Exp $
d6 1
a6 1
NEED_VERSION=	1.319
d13 1
a13 1
MAINTAINER=	danh@@openbsd.org
@


1.6
log
@updated MAINTAINER
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2000/07/04 00:37:14 krw Exp $
d3 7
a9 4
DISTNAME=		rrdtool-1.0.24
CATEGORIES=     	net
NEED_VERSION=		1.310
HOMEPAGE=		http://ee-staff.ethz.ch/~oetiker/webtools/rrdtool/
d11 3
a13 1
MAINTAINER=		danh@@openbsd.org
d20 1
a20 3
MASTER_SITES=		${HOMEPAGE}/pub/ \
			ftp://ftp.sunet.se/pub/network/monitoring/rrdtool/ \
			http://ftp.sunet.se/pub/network/monitoring/rrdtool/
d22 1
a22 1
FLAVORS=		tcl
d25 8
a32 2
.if defined(WITH_TCL)
FLAVOR+=		tcl
d35 4
a38 2
CONFIGURE_STYLE=	gnu
CONFIGURE_ARGS+=	${CONFIGURE_SHARED}
d41 5
a45 5
# Makefile in tcl subdir does not work with our make
USE_GMAKE=		Yes
LIB_DEPENDS=		tcl83::lang/tcl/8.3
MAKE_FLAGS+=		CFLAGS+=-I${LOCALBASE}/include/tcl8.3
CONFIGURE_ARGS+=	--with-tcllib='${LOCALBASE}/lib/tcl8.3'
d47 1
d49 1
a49 4
	cd ${WRKSRC};  ${MAKE} site-tcl-install

.else
CONFIGURE_ARGS+=	--without-tcllib
@


1.5
log
@Change PFRAG.shared ldconfig invocation(s) to
DYNLIBDIR() invocations.

Bump NEED_VERSION to 1.310 so DYNLIBDIR() works.

As requested by espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2000/06/29 21:12:23 jakob Exp $
d8 1
a8 1
MAINTAINER=		danh@@nfol.com
@


1.4
log
@- update to v1.0.24
- PLIST-handling fixed
(from maintainer; Dan Harnett <danh@@nfol.com>)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2000/06/19 09:11:27 camield Exp $
d5 1
a5 1
NEED_VERSION=		1.309
@


1.3
log
@TCL flavor now compiles and installs. It needs testing by someone
who actually uses it.
From maintainer.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2000/06/15 10:39:42 camield Exp $
d3 1
a3 1
DISTNAME=		rrdtool-1.0.23
d5 1
a5 1
NEED_VERSION=		1.302
@


1.2
log
@- perl modules now install in site_perl
- initial work towards TCL flavor
From maintainer danh@@nfol.com
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2000/06/14 05:57:49 jakob Exp $
a29 1
BROKEN=			"currently doesn't work"
d33 6
a38 3
# tclConfig.sh seems to be a bit confused about installation paths...
# (so this does not work)
CONFIGURE_ARGS+=	--with-tcllib=/usr/local/lib/tcl8.3
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d19 7
d28 12
@


1.1.1.1
log
@rrdtool port; Dan Harnett <danh@@nfol.com>
@
text
@@
