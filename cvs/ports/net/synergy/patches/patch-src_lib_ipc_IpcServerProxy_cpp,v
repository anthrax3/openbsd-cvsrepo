head	1.2;
access;
symbols
	OPENBSD_6_0:1.2.0.8
	OPENBSD_6_0_BASE:1.2
	OPENBSD_5_9:1.2.0.4
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.2.0.6
	OPENBSD_5_8_BASE:1.2
	OPENBSD_5_7:1.2.0.2
	OPENBSD_5_7_BASE:1.2;
locks; strict;
comment	@# @;


1.2
date	2015.01.03.04.59.27;	author bcallah;	state Exp;
branches;
next	1.1;
commitid	dBfSZpK8RQZb00Bh;

1.1
date	2014.08.20.07.20.10;	author landry;	state Exp;
branches;
next	;
commitid	S5K5T9WTdeSqlMfR;


desc
@@


1.2
log
@Update to 1.6.2 - tarballs moved to GitHub
@
text
@$OpenBSD: patch-src_lib_ipc_IpcServerProxy_cpp,v 1.1 2014/08/20 07:20:10 landry Exp $

On loongson/sparc64/hppa:
CIpcServerProxy.cpp: In member function 'void CIpcServerProxy::send(const CIpcMessage&)':
CIpcServerProxy.cpp:93: ISO C++ says that these are ambiguous, even though the worst conversion for the first is better than the worst conversion for the second:
../synergy/CProtocolUtil.h:81: note: candidate 1: static void CProtocolUtil::writef(void*, const char*, void*)
../synergy/CProtocolUtil.h:53: note: candidate 2: static void CProtocolUtil::writef(synergy::IStream*, const char*, ...)
../synergy/CProtocolUtil.h:81: error: 'static void CProtocolUtil::writef(void*, const char*, void*)' is private
CIpcServerProxy.cpp:93: error: within this context

gcc bug fixed in 4.3.3

--- src/lib/ipc/IpcServerProxy.cpp.orig	Mon Dec 22 16:16:07 2014
+++ src/lib/ipc/IpcServerProxy.cpp	Mon Dec 22 16:17:43 2014
@@@@ -95,7 +95,11 @@@@ IpcServerProxy::send(const IpcMessage& message)
 	case kIpcCommand: {
 		const IpcCommandMessage& cm = static_cast<const IpcCommandMessage&>(message);
 		String command = cm.command();
+#if defined(__mips64__) || defined(__sparc64__) || defined(__hppa__)
+		ProtocolUtil::writef(static_cast<void*>(&m_stream), static_cast<const char*>(kIpcMsgCommand), &command);
+#else
 		ProtocolUtil::writef(&m_stream, kIpcMsgCommand, &command);
+#endif
 		break;
 	}
 
@


1.1
log
@Readd some patches to let this build on sparc64, and probably mips64*/hppa.
Fix is probably still wrong, but at least it builds..
@
text
@d1 1
a1 1
$OpenBSD: patch-src_lib_ipc_CIpcServerProxy_cpp,v 1.5 2013/11/18 23:56:35 bcallah Exp $
d13 3
a15 3
--- src/lib/ipc/IpcServerProxy.cpp.orig	Fri Feb 28 05:36:45 2014
+++ src/lib/ipc/IpcServerProxy.cpp	Wed Aug 20 01:09:24 2014
@@@@ -95,7 +95,11 @@@@ CIpcServerProxy::send(const CIpcMessage& message)
d17 2
a18 2
 		const CIpcCommandMessage& cm = static_cast<const CIpcCommandMessage&>(message);
 		CString command = cm.command();
d20 1
a20 1
+		CProtocolUtil::writef(static_cast<void*>(&m_stream), static_cast<const char*>(kIpcMsgCommand), &command);
d22 1
a22 1
 		CProtocolUtil::writef(&m_stream, kIpcMsgCommand, &command);
@

