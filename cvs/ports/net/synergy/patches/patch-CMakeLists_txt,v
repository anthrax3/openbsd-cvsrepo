head	1.8;
access;
symbols
	OPENBSD_6_2:1.8.0.8
	OPENBSD_6_2_BASE:1.8
	OPENBSD_6_1:1.8.0.6
	OPENBSD_6_1_BASE:1.8
	OPENBSD_6_0:1.8.0.4
	OPENBSD_6_0_BASE:1.8
	OPENBSD_5_9:1.8.0.2
	OPENBSD_5_9_BASE:1.8
	OPENBSD_5_8:1.7.0.6
	OPENBSD_5_8_BASE:1.7
	OPENBSD_5_7:1.7.0.2
	OPENBSD_5_7_BASE:1.7
	OPENBSD_5_6:1.6.0.2
	OPENBSD_5_6_BASE:1.6
	OPENBSD_5_5:1.4.0.2
	OPENBSD_5_5_BASE:1.4
	OPENBSD_5_4:1.3.0.2
	OPENBSD_5_4_BASE:1.3
	OPENBSD_5_3:1.1.0.2
	OPENBSD_5_3_BASE:1.1;
locks; strict;
comment	@# @;


1.8
date	2015.10.21.19.51.28;	author jturner;	state Exp;
branches;
next	1.7;
commitid	jBFEx2tKNxRRHmto;

1.7
date	2015.01.03.04.59.27;	author bcallah;	state Exp;
branches;
next	1.6;
commitid	dBfSZpK8RQZb00Bh;

1.6
date	2014.06.03.13.45.41;	author bcallah;	state Exp;
branches;
next	1.5;
commitid	vkegwsAuC102feEg;

1.5
date	2014.05.01.14.46.53;	author bcallah;	state Exp;
branches;
next	1.4;

1.4
date	2013.11.18.23.56.35;	author bcallah;	state Exp;
branches;
next	1.3;

1.3
date	2013.05.17.18.53.24;	author dcoppa;	state Exp;
branches;
next	1.2;

1.2
date	2013.05.12.16.09.04;	author bcallah;	state Exp;
branches;
next	1.1;

1.1
date	2013.01.08.20.35.36;	author bcallah;	state Exp;
branches;
next	;


desc
@@


1.8
log
@Update synergy to 1.7.4.

Tested by Michael Lesniewski <lesniewskister at gmail dot com>. ok abieber@@
@
text
@$OpenBSD: patch-CMakeLists_txt,v 1.7 2015/01/03 04:59:27 bcallah Exp $
--- CMakeLists.txt.orig	Fri Aug  7 18:56:23 2015
+++ CMakeLists.txt	Thu Oct 15 17:57:00 2015
@@@@ -77,7 +77,7 @@@@ if (UNIX)
 
 	# warnings as errors:
 	# we have a problem with people checking in code with warnings.
-	set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -Werror")
+	set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS}")
 
 	if (NOT APPLE)
 		set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -fPIC")
@@@@ -103,7 +103,7 @@@@ if (UNIX)
 	check_include_files(strings.h HAVE_STRINGS_H)
 	check_include_files(string.h HAVE_STRING_H)
 	check_include_files(sys/select.h HAVE_SYS_SELECT_H)
-	check_include_files(sys/socket.h HAVE_SYS_SOCKET_H)
+	check_include_files("sys/types.h;sys/socket.h" HAVE_SYS_SOCKET_H)
 	check_include_files(sys/stat.h HAVE_SYS_STAT_H)
 	check_include_files(sys/time.h HAVE_SYS_TIME_H)
 	check_include_files(sys/utsname.h HAVE_SYS_UTSNAME_H)
@@@@ -114,7 +114,6 @@@@ if (UNIX)
 	check_function_exists(gmtime_r HAVE_GMTIME_R)
 	check_function_exists(nanosleep HAVE_NANOSLEEP)
 	check_function_exists(poll HAVE_POLL)
-	check_function_exists(sigwait HAVE_POSIX_SIGWAIT)
 	check_function_exists(strftime HAVE_STRFTIME)
 	check_function_exists(vsnprintf HAVE_VSNPRINTF)
 	check_function_exists(inet_aton HAVE_INET_ATON)
@@@@ -157,6 +156,8 @@@@ if (UNIX)
 		message(FATAL_ERROR "Missing library: pthread")
 	endif()
 
+	check_library_exists("pthread" sigwait "" HAVE_POSIX_SIGWAIT)
+
 	# curl is used on both Linux and Mac
 	find_package(CURL)
 	if (CURL_FOUND)
@@@@ -201,77 +202,59 @@@@ if (UNIX)
 
 	else() # not-apple
 
-		# add include dir for bsd (posix uses /usr/include/)
-		set(CMAKE_INCLUDE_PATH "${CMAKE_INCLUDE_PATH}:/usr/local/include")
+		find_package(X11 REQUIRED)
 
-		set(XKBlib "X11/Xlib.h;X11/XKBlib.h")
-		check_symbol_exists("XRRNotifyEvent" "${XKBlib};X11/extensions/Xrandr.h" HAVE_X11_EXTENSIONS_XRANDR_H)
+		include_directories(${X11_X11_INCLUDE_PATH})
+		list(APPEND libs ${X11_X11_LIB})
 
-		check_include_files("${XKBlib};X11/extensions/dpms.h" HAVE_X11_EXTENSIONS_DPMS_H)
-		check_include_files("X11/extensions/Xinerama.h" HAVE_X11_EXTENSIONS_XINERAMA_H)
-		check_include_files("${XKBlib};X11/extensions/XKBstr.h" HAVE_X11_EXTENSIONS_XKBSTR_H)
-		check_include_files("X11/extensions/XKB.h" HAVE_XKB_EXTENSION)
-		check_include_files("X11/extensions/XTest.h" HAVE_X11_EXTENSIONS_XTEST_H)
-		check_include_files("${XKBlib}" HAVE_X11_XKBLIB_H)
-		check_include_files("X11/extensions/XInput2.h" HAVE_XI2)
-
-		if (HAVE_X11_EXTENSIONS_DPMS_H)
-			# Assume that function prototypes declared, when include exists.
-			set(HAVE_DPMS_PROTOTYPES 1)
+		if(X11_Xkb_FOUND)
+			set(HAVE_X11_EXTENSIONS_XKBSTR_H 1)
+			set(HAVE_XKB_EXTENSION 1)
+			set(HAVE_X11_XKBLIB_H 1)
+		else()
+			message(FATAL_ERROR "Xkb is needed")
 		endif()
 
-		if (NOT HAVE_X11_XKBLIB_H)
-			message(FATAL_ERROR "Missing header: " ${XKBlib})
+		if(X11_XTest_FOUND)
+			set(HAVE_X11_EXTENSIONS_XTEST_H 1)
+			list(APPEND libs ${X11_XTest_LIB})
+		else()
+			message(FATAL_ERROR "XTest is needed")
 		endif()
 
-		check_library_exists("SM;ICE" IceConnectionNumber "" HAVE_ICE)
-		check_library_exists("Xext;X11" DPMSQueryExtension "" HAVE_Xext)
-		check_library_exists("Xtst;Xext;X11" XTestQueryExtension "" HAVE_Xtst)
-		check_library_exists("Xinerama" XineramaQueryExtension "" HAVE_Xinerama)
-		check_library_exists("Xi" XISelectEvents "" HAVE_Xi)
-		check_library_exists("Xrandr" XRRQueryExtension "" HAVE_Xrandr)
-
-		if (HAVE_ICE)
-
-			# Assume we have SM if we have ICE.
-			set(HAVE_SM 1)
-			list(APPEND libs SM ICE)
-
+		if(X11_ICE_FOUND)
+			list(APPEND libs ${X11_SM_LIB})
+			list(APPEND libs ${X11_ICE_LIB})
 		endif()
 
-		if (HAVE_Xtst)
-
-			# Xtxt depends on X11.
-			set(HAVE_X11)
-			list(APPEND libs Xtst X11)
-
-		else()
-
-			message(FATAL_ERROR "Missing library: Xtst")
-
+		if(X11_dpms_FOUND)
+			set(HAVE_X11_EXTENSIONS_DPMS_H 1)
+			set(HAVE_DPMS_PROTOTYPES 1)
+			list(APPEND libs ${X11_Xext_LIB})
 		endif()
 
 		if (HAVE_Xext)
 			list(APPEND libs Xext)
 		endif()
 
-		if (HAVE_Xinerama)
-			list(APPEND libs Xinerama)
-		else (HAVE_Xinerama)
-			if (HAVE_X11_EXTENSIONS_XINERAMA_H)
-				set(HAVE_X11_EXTENSIONS_XINERAMA_H 0)
-				message(WARNING "Old Xinerama implementation detected, disabled")
-			endif()
+		if(X11_Xinerama_FOUND)
+			set(HAVE_X11_EXTENSIONS_XINERAMA_H 1)
+			list(APPEND libs ${X11_Xinerama_LIB})
 		endif()
 
-		if (HAVE_Xrandr)
-			list(APPEND libs Xrandr)
+		if(X11_Xinput_FOUND)
+			set(HAVE_XI2 1)
+			list(APPEND libs ${X11_Xinput_LIB})
 		endif()
-		
-		# this was outside of the linux scope,
-		# not sure why, moving it back inside.
-		if(HAVE_Xi)
-			list(APPEND libs Xi)
+
+		if(X11_Xrandr_FOUND)
+			set(HAVE_X11_EXTENSIONS_XRANDR_H 1)
+			list(APPEND libs ${X11_Xrandr_LIB})
+		endif()
+	
+		if (CMAKE_SYSTEM_NAME MATCHES "OpenBSD")
+			include_directories(${OPENBSD_LOCALBASE}/include)
+			link_directories(${OPENBSD_LOCALBASE}/lib)
 		endif()
 
 	endif()
@


1.7
log
@Update to 1.6.2 - tarballs moved to GitHub
@
text
@d1 4
a4 4
$OpenBSD: patch-CMakeLists_txt,v 1.6 2014/06/03 13:45:41 bcallah Exp $
--- CMakeLists.txt.orig	Thu Nov  6 13:09:27 2014
+++ CMakeLists.txt	Thu Nov  6 19:59:59 2014
@@@@ -76,7 +76,7 @@@@ if (UNIX)
d11 3
a13 3
 	# For config.h, detect the libraries, functions, etc.
 	include(CheckIncludeFiles)
@@@@ -98,7 +98,7 @@@@ if (UNIX)
d22 1
a22 1
@@@@ -109,7 +109,6 @@@@ if (UNIX)
d30 1
a30 1
@@@@ -152,6 +151,8 @@@@ if (UNIX)
d39 1
a39 1
@@@@ -196,78 +197,60 @@@@ if (UNIX)
d145 1
a145 1
 		endif()
d150 1
a150 1
+		endif()
a152 9
 
@@@@ -319,7 +302,6 @@@@ else() # not-unix
 endif()
 
 add_subdirectory(src)
-add_subdirectory(ext)
 
 if (WIN32)
 	# TODO:	consider using /analyze to uncover potential bugs in the source code.
@


1.6
log
@Update to 1.5.0.
ok abieber@@
@
text
@d1 3
a3 3
$OpenBSD: patch-CMakeLists_txt,v 1.5 2014/05/01 14:46:53 bcallah Exp $
--- CMakeLists.txt.orig	Fri May 23 11:43:58 2014
+++ CMakeLists.txt	Fri May 23 14:42:41 2014
d39 1
a39 1
@@@@ -193,78 +194,60 @@@@ if (UNIX)
d154 1
a154 1
@@@@ -316,7 +299,6 @@@@ else() # not-unix
@


1.5
log
@Update Synergy to 1.4.17
ok abieber@@
@
text
@d1 4
a4 4
$OpenBSD: patch-CMakeLists_txt,v 1.4 2013/11/18 23:56:35 bcallah Exp $
--- CMakeLists.txt.orig	Fri Mar 14 16:34:19 2014
+++ CMakeLists.txt	Tue Apr 15 22:35:21 2014
@@@@ -77,7 +77,7 @@@@ if (UNIX)
d13 1
a13 1
@@@@ -99,7 +99,7 @@@@ if (UNIX)
d22 1
a22 1
@@@@ -110,7 +110,6 @@@@ if (UNIX)
d30 1
a30 1
@@@@ -153,6 +152,8 @@@@ if (UNIX)
d39 1
a39 1
@@@@ -194,78 +195,60 @@@@ if (UNIX)
d154 1
a154 1
@@@@ -317,7 +300,6 @@@@ else() # not-unix
@


1.4
log
@Update synergy to 1.4.15
testing and ok okan@@
@
text
@d1 13
a13 4
$OpenBSD: patch-CMakeLists_txt,v 1.3 2013/05/17 18:53:24 dcoppa Exp $
--- CMakeLists.txt.orig	Sun Nov 17 15:00:17 2013
+++ CMakeLists.txt	Sun Nov 17 15:00:17 2013
@@@@ -87,7 +87,7 @@@@ if (UNIX)
d22 1
a22 1
@@@@ -98,7 +98,6 @@@@ if (UNIX)
d30 1
a30 2
@@@@ -140,6 +139,8 @@@@ if (UNIX)
 	else (HAVE_PTHREAD)
d33 2
d36 4
a39 5
+	check_library_exists("pthread" sigwait "" HAVE_POSIX_SIGWAIT)
 	
 	if (APPLE)
 		exec_program(uname ARGS -v OUTPUT_VARIABLE DARWIN_VERSION)
@@@@ -174,78 +175,58 @@@@ if (UNIX)
d41 1
a41 1
 	else()
d77 1
a77 1
+			message(FATAL_ERROR "Xtst is needed")
d114 2
a115 5
-		if (HAVE_Xext)
-			list(APPEND libs Xext)
+		if(X11_Xinerama_FOUND)
+			set(HAVE_X11_EXTENSIONS_XINERAMA_H 1)
+			list(APPEND libs ${X11_Xinerama_LIB})
d125 7
d136 6
a141 3
 
-		if (HAVE_Xrandr)
-			list(APPEND libs Xrandr)
d146 5
d154 1
a154 11
-        IF(HAVE_Xi)
-                LIST(APPEND libs Xi)
-        ENDIF()
+	if (CMAKE_SYSTEM_NAME MATCHES "OpenBSD")
+		include_directories(${OPENBSD_LOCALBASE}/include)
+		link_directories(${OPENBSD_LOCALBASE}/lib)
+	endif()
 
 	# For config.h, set some static values; it may be a good idea to make
 	# these values dynamic for non-standard UNIX compilers.
@@@@ -295,7 +276,6 @@@@ else (UNIX)
d158 1
a158 1
-add_subdirectory(tools)
d161 1
a161 1
 	# add /analyze in order to unconver potential bugs in the source code
@


1.3
log
@Link synergy with the libcryptopp shared library from devel/cryptopp
instead of linking statically against a local copy. This also
unbreaks the build on i386.

ok bcallah@@ (maintainer)
@
text
@d1 3
a3 3
$OpenBSD: patch-CMakeLists_txt,v 1.2 2013/05/12 16:09:04 bcallah Exp $
--- CMakeLists.txt.orig	Fri May 17 20:20:00 2013
+++ CMakeLists.txt	Fri May 17 20:38:46 2013
d143 1
a143 1
@@@@ -303,7 +284,6 @@@@ if (VNC_SUPPORT)
@


1.2
log
@Update net/synergy to 1.4.12
ok abieber@@
@
text
@d1 3
a3 3
$OpenBSD: patch-CMakeLists_txt,v 1.1 2013/01/08 20:35:36 bcallah Exp $
--- CMakeLists.txt.orig	Thu Apr 18 10:50:31 2013
+++ CMakeLists.txt	Thu Apr 18 10:50:31 2013
d30 1
a30 1
@@@@ -174,78 +175,53 @@@@ if (UNIX)
d132 1
a132 1
-
d136 4
d143 8
@


1.1
log
@Update to synergy 1.4.10 and take MAINTAINERSHIP.
CMakeLists.txt patch done by dcoppa@@
ok landry@@
@
text
@d1 4
a4 4
$OpenBSD$
--- CMakeLists.txt.orig	Tue Jan  8 13:23:44 2013
+++ CMakeLists.txt	Tue Jan  8 13:24:40 2013
@@@@ -86,7 +86,7 @@@@ if (UNIX)
d13 1
a13 1
@@@@ -97,7 +97,6 @@@@ if (UNIX)
d21 1
a21 1
@@@@ -139,6 +138,8 @@@@ if (UNIX)
d30 1
a30 1
@@@@ -173,78 +174,53 @@@@ if (UNIX)
@

