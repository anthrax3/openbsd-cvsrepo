head	1.17;
access;
symbols
	OPENBSD_6_2:1.17.0.2
	OPENBSD_6_2_BASE:1.17
	OPENBSD_6_1:1.16.0.2
	OPENBSD_6_1_BASE:1.16
	OPENBSD_6_0:1.12.0.2
	OPENBSD_6_0_BASE:1.12
	OPENBSD_5_9:1.10.0.2
	OPENBSD_5_9_BASE:1.10
	OPENBSD_5_8:1.4.0.4
	OPENBSD_5_8_BASE:1.4
	sthen_20150326:1.1.1.1
	sthen:1.1.1;
locks; strict;
comment	@# @;


1.17
date	2017.05.03.07.39.55;	author sthen;	state Exp;
branches;
next	1.16;
commitid	GIPOpZzQ2KcC2uTs;

1.16
date	2017.02.14.23.02.19;	author sthen;	state Exp;
branches;
next	1.15;
commitid	zCLpqtwUmWhVxU57;

1.15
date	2016.11.19.15.35.09;	author sthen;	state Exp;
branches;
next	1.14;
commitid	51mJySZaaYyF1cEr;

1.14
date	2016.09.23.09.00.11;	author sthen;	state Exp;
branches;
next	1.13;
commitid	InnfcaJ6qQjVYnus;

1.13
date	2016.08.12.13.39.30;	author sthen;	state Exp;
branches;
next	1.12;
commitid	DwdxEl2fl8R0iy8P;

1.12
date	2016.04.26.12.11.08;	author sthen;	state Exp;
branches;
next	1.11;
commitid	kl8JjVD3B0TgmGHz;

1.11
date	2016.03.19.20.03.46;	author sthen;	state Exp;
branches;
next	1.10;
commitid	XcOsRdTLzmOZM0Hl;

1.10
date	2016.01.09.16.01.42;	author sthen;	state Exp;
branches;
next	1.9;
commitid	diOndbEE4jakzpYw;

1.9
date	2015.11.30.11.58.57;	author sthen;	state Exp;
branches;
next	1.8;
commitid	3QuISeJ6hOB2VxlS;

1.8
date	2015.11.23.15.10.57;	author sthen;	state Exp;
branches;
next	1.7;
commitid	RnjbJ8TPbdFfpffH;

1.7
date	2015.10.09.14.47.40;	author sthen;	state Exp;
branches;
next	1.6;
commitid	48Ub0LGBiX0TyyK9;

1.6
date	2015.09.04.21.05.55;	author sthen;	state Exp;
branches;
next	1.5;
commitid	VJPwTS9MDHVsEQUf;

1.5
date	2015.08.14.11.20.07;	author sthen;	state Exp;
branches;
next	1.4;
commitid	WHdIEwtpFDhOWWSi;

1.4
date	2015.07.02.20.50.21;	author sthen;	state Exp;
branches;
next	1.3;
commitid	SnrRKdNvVNv5If2c;

1.3
date	2015.05.25.20.57.11;	author sthen;	state Exp;
branches;
next	1.2;
commitid	vMYRvuaLowr2nLlN;

1.2
date	2015.03.29.20.02.41;	author sthen;	state Exp;
branches;
next	1.1;
commitid	RhSdL55jdlIWIegZ;

1.1
date	2015.03.26.02.07.59;	author sthen;	state Exp;
branches
	1.1.1.1;
next	;
commitid	0Ou9W6hND0FZCvke;

1.1.1.1
date	2015.03.26.02.07.59;	author sthen;	state Exp;
branches;
next	;
commitid	0Ou9W6hND0FZCvke;


desc
@@


1.17
log
@update to ocserv-0.11.8
@
text
@$OpenBSD: patch-doc_sample_config,v 1.16 2017/02/14 23:02:19 sthen Exp $

no seccomp, gssapi

Index: doc/sample.config
--- doc/sample.config.orig
+++ doc/sample.config
@@@@ -1,7 +1,7 @@@@
 # User authentication method. Could be set multiple times and in 
 # that case all should succeed. To enable multiple methods use
 # multiple auth directives. Available options: certificate, 
-# plain, pam, radius, gssapi.
+# plain, pam, radius.
 #
 # Note that authentication methods cannot be changed with reload.
 
@@@@ -32,15 +32,6 @@@@
 # Acct-Interim-Interval, and Session-Timeout values.
 #
 # See doc/README-radius.md for the supported radius configuration atributes.
-#
-# gssapi[keytab=/etc/key.tab,require-local-user-map=true,tgt-freshness-time=900]
-#  The gssapi option allows one to use authentication methods supported by GSSAPI,
-# such as Kerberos tickets with ocserv. It should be best used as an alternative
-# to PAM (i.e., have pam in auth and gssapi in enable-auth), to allow users with
-# tickets and without tickets to login. The default value for require-local-user-map
-# is true. The 'tgt-freshness-time' if set, it would require the TGT tickets presented
-# to have been issued within the provided number of seconds. That option is used to
-# restrict logins even if the KDC provides long time TGT tickets.
 
 #auth = "pam"
 #auth = "pam[gid-min=1000]"
@@@@ -53,8 +44,6 @@@@ auth = "plain[passwd=./sample.passwd]"
 # for authentication. That is, if set, any of the methods enabled
 # will be sufficient to login.
 #enable-auth = "certificate"
-#enable-auth = "gssapi"
-#enable-auth = "gssapi[keytab=/etc/key.tab,require-local-user-map=true,tgt-freshness-time=900]"
 
 # Accounting methods available:
 # radius: can be combined with any authentication method, it provides
@@@@ -97,8 +86,8 @@@@ udp-port = 443
 
 # The user the worker processes will be run as. It should be
 # unique (no other services run as this user).
-run-as-user = nobody
-run-as-group = daemon
+run-as-user = _ocserv
+run-as-group = _ocserv
 
 # socket file used for IPC with occtl. You only need to set that,
 # if you use more than a single servers.
@@@@ -107,7 +96,7 @@@@ run-as-group = daemon
 # socket file used for server IPC (worker-main), will be appended with .PID
 # It must be accessible within the chroot environment (if any), so it is best
 # specified relatively to the chroot directory.
-socket-file = /var/run/ocserv-socket
+socket-file = ${LOCALSTATEDIR}/run/ocserv-socket
 
 # The default server directory. Does not require any devices present.
 #chroot-dir = /path/to/chroot
@@@@ -161,16 +150,6 @@@@ ca-cert = ../tests/certs/ca.pem
 ### failures during the reloading time.
 
 
-# Whether to enable seccomp/Linux namespaces worker isolation. That restricts the number of 
-# system calls allowed to a worker process, in order to reduce damage from a
-# bug in the worker process. It is available on Linux systems at a performance cost.
-# The performance cost is roughly 2% overhead at transfer time (tested on a Linux 3.17.8).
-# Note however, that process isolation is restricted to the specific libc versions
-# the isolation was tested at. If you get random failures on worker processes, try
-# disabling that option and report the failures you, along with system and debugging
-# information at: https://gitlab.com/ocserv/ocserv/issues
-isolate-workers = true
-
 # A banner to be displayed on clients
 #banner = "Welcome"
 
@@@@ -320,9 +299,8 @@@@ min-reauth-time = 300
 # Banning clients in ocserv works with a point system. IP addresses
 # that get a score over that configured number are banned for
 # min-reauth-time seconds. By default a wrong password attempt is 10 points,
-# a KKDCP POST is 1 point, and a connection is 1 point. Note that
-# due to difference processes being involved the count of points
-# will not be real-time precise.
+# and a connection is 1 point. Note that due to different processes
+# being involved the count of points will not be real-time precise.
 #
 # Score banning cannot be reliably used when receiving proxied connections
 # locally from an HTTP server (i.e., when listen-clear-file is used).
@@@@ -336,7 +314,6 @@@@ ban-reset-time = 1200
 # In case you'd like to change the default points.
 #ban-points-wrong-password = 10
 #ban-points-connection = 1
-#ban-points-kkdcp = 1
 
 # Cookie timeout (in seconds)
 # Once a client is authenticated he's provided a cookie with
@@@@ -403,7 +380,7 @@@@ rekey-method = ssl
 use-occtl = true
 
 # PID file. It can be overridden in the command line.
-pid-file = /var/run/ocserv.pid
+pid-file = ${LOCALSTATEDIR}/run/ocserv.pid
 
 # Set the protocol-defined priority (SO_PRIORITY) for packets to
 # be sent. That is a number from 0 to 6 with 0 being the lowest
@@@@ -518,6 +495,11 @@@@ no-route = 192.168.5.0/255.255.255.0
 # any other routes. In case of defaultroute, the no-routes are restricted.
 # All the routes applied by ocserv can be reverted using /etc/ocserv/ocserv-fw
 # --removeall. This option can be set globally or in the per-user configuration.
+#
+# OpenBSD package notes:
+# to use this with PF, you will need to supply your own ocserv-fw script,
+# probably the best approach would be to add via a table or an anchor.
+#
 #restrict-user-to-routes = true
 
 # This option implies restrict-user-to-routes set to true. If set, the
@@@@ -590,23 +572,6 @@@@ no-route = 192.168.5.0/255.255.255.0
 # and '%{G}', if present will be replaced by the username and group name.
 #proxy-url = http://example.com/
 #proxy-url = http://example.com/%{U}/
-
-# This option allows you to specify a URL location where a client can
-# post using MS-KKDCP, and the message will be forwarded to the provided
-# KDC server. That is a translation URL between HTTP and Kerberos.
-# In MIT kerberos you'll need to add in realms:
-#   EXAMPLE.COM = {
-#     kdc = https://ocserv.example.com/KdcProxy
-#     http_anchors = FILE:/etc/ocserv-ca.pem
-#   }
-# In some distributions the krb5-k5tls plugin of kinit is required.
-#
-# The following option is available in ocserv, when compiled with GSSAPI support. 
-
-#kkdcp = "SERVER-PATH KERBEROS-REALM PROTOCOL@@SERVER:PORT"
-#kkdcp = "/KdcProxy KERBEROS.REALM udp@@127.0.0.1:88"
-#kkdcp = "/KdcProxy KERBEROS.REALM tcp@@127.0.0.1:88"
-#kkdcp = "/KdcProxy KERBEROS.REALM tcp@@[::1]:88"
 
 # Client profile xml. This can be used to advertise alternative servers
 # to the client. A minimal file can be:
@


1.16
log
@update to ocserv-0.11.7, from Björn Ketelaars
@
text
@d1 1
a1 1
$OpenBSD: patch-doc_sample_config,v 1.15 2016/11/19 15:35:09 sthen Exp $
d5 3
a7 2
--- doc/sample.config.orig	Sun Feb 12 13:51:27 2017
+++ doc/sample.config	Sun Feb 12 13:53:12 2017
d42 1
a42 1
@@@@ -89,8 +78,8 @@@@ udp-port = 443
d53 1
a53 1
@@@@ -99,7 +88,7 @@@@ run-as-group = daemon
d62 1
a62 1
@@@@ -153,16 +142,6 @@@@ ca-cert = ../tests/certs/ca.pem
d79 1
a79 1
@@@@ -304,9 +283,8 @@@@ min-reauth-time = 300
d91 1
a91 1
@@@@ -320,7 +298,6 @@@@ ban-reset-time = 300
d99 1
a99 1
@@@@ -387,7 +364,7 @@@@ rekey-method = ssl
d108 1
a108 1
@@@@ -502,6 +479,11 @@@@ no-route = 192.168.5.0/255.255.255.0
d120 1
a120 1
@@@@ -574,23 +556,6 @@@@ no-route = 192.168.5.0/255.255.255.0
@


1.15
log
@update to ocserv-0.11.6 plus patch for autogen problem in the release
from Björn Ketelaars (I added a comment to recheck autogen because it changed
again since that patch)
@
text
@d1 1
a1 1
$OpenBSD: patch-doc_sample_config,v 1.14 2016/09/23 09:00:11 sthen Exp $
d5 2
a6 2
--- doc/sample.config.orig	Tue Nov 15 06:44:28 2016
+++ doc/sample.config	Tue Nov 15 06:47:49 2016
d16 2
a17 1
@@@@ -29,14 +29,6 @@@@
d20 1
a20 1
 #
d22 1
a22 1
-#  The gssapi option allows to use authentication methods supported by GSSAPI,
d32 1
a32 1
@@@@ -49,8 +41,6 @@@@ auth = "plain[passwd=./sample.passwd]"
d41 1
a41 1
@@@@ -85,8 +75,8 @@@@ udp-port = 443
d52 1
a52 1
@@@@ -95,7 +85,7 @@@@ run-as-group = daemon
d61 1
a61 1
@@@@ -149,16 +139,6 @@@@ ca-cert = ../tests/certs/ca.pem
d78 1
a78 1
@@@@ -292,9 +272,8 @@@@ min-reauth-time = 300
d90 1
a90 1
@@@@ -308,7 +287,6 @@@@ ban-reset-time = 300
d98 1
a98 1
@@@@ -375,7 +353,7 @@@@ rekey-method = ssl
d101 1
a101 1
 # PID file. It can be overriden in the command line.
d107 1
a107 1
@@@@ -490,6 +468,11 @@@@ no-route = 192.168.5.0/255.255.255.0
d119 1
a119 1
@@@@ -562,23 +545,6 @@@@ no-route = 192.168.5.0/255.255.255.0
d141 2
a142 2
 #
 # The following options are for (experimental) AnyConnect client 
@


1.14
log
@update to ocserv-0.11.5
@
text
@d1 1
a1 1
$OpenBSD: patch-doc_sample_config,v 1.13 2016/08/12 13:39:30 sthen Exp $
d5 2
a6 2
--- doc/sample.config.orig	Fri Sep 23 09:58:11 2016
+++ doc/sample.config	Fri Sep 23 09:58:11 2016
d16 4
a19 5
@@@@ -26,15 +26,6 @@@@
 # file. If the groupconfig option is set, then config-per-user/group will be overriden,
 # and all configuration will be read from radius. The 'override-interim-updates' if set to
 # true will ignore Acct-Interim-Interval from the server and 'stats-report-time' will be considered.
-#
d31 1
a31 1
@@@@ -47,8 +38,6 @@@@ auth = "plain[passwd=./sample.passwd]"
d40 1
a40 1
@@@@ -83,8 +72,8 @@@@ udp-port = 443
d51 1
a51 1
@@@@ -93,7 +82,7 @@@@ run-as-group = daemon
d60 1
a60 1
@@@@ -147,16 +136,6 @@@@ ca-cert = ../tests/certs/ca.pem
d77 1
a77 1
@@@@ -290,9 +269,8 @@@@ min-reauth-time = 300
d89 1
a89 1
@@@@ -306,7 +284,6 @@@@ ban-reset-time = 300
d97 1
a97 1
@@@@ -373,7 +350,7 @@@@ rekey-method = ssl
d106 1
a106 1
@@@@ -488,6 +465,11 @@@@ no-route = 192.168.5.0/255.255.255.0
d118 24
@


1.13
log
@update to ocserv-0.11.4
@
text
@d1 1
a1 1
$OpenBSD: patch-doc_sample_config,v 1.12 2016/04/26 12:11:08 sthen Exp $
d5 2
a6 2
--- doc/sample.config.orig	Fri Aug 12 14:30:00 2016
+++ doc/sample.config	Fri Aug 12 14:30:00 2016
d78 1
a78 1
@@@@ -282,9 +261,8 @@@@ min-reauth-time = 300
d90 1
a90 1
@@@@ -298,7 +276,6 @@@@ ban-reset-time = 300
d98 1
a98 1
@@@@ -365,7 +342,7 @@@@ rekey-method = ssl
d107 1
a107 1
@@@@ -480,6 +457,11 @@@@ no-route = 192.168.5.0/255.255.255.0
@


1.12
log
@update to ocserv-0.11.2
@
text
@d1 1
a1 1
$OpenBSD: patch-doc_sample_config,v 1.11 2016/03/19 20:03:46 sthen Exp $
d5 2
a6 2
--- doc/sample.config.orig	Tue Apr 26 12:56:25 2016
+++ doc/sample.config	Tue Apr 26 12:56:25 2016
d61 1
a61 21
@@@@ -108,8 +97,8 @@@@ socket-file = /var/run/ocserv-socket
 #
 # There may be multiple server-cert and server-key directives,
 # but each key should correspond to the preceding certificate.
-server-cert = ../tests/server-cert.pem
-server-key = ../tests/server-key.pem
+server-cert = ${SYSCONFDIR}/ocserv/server-cert.pem
+server-key = ${SYSCONFDIR}/ocserv/server-key.pem
 
 # Diffie-Hellman parameters. Only needed if you require support
 # for the DHE ciphersuites (by default this server supports ECDHE).
@@@@ -135,7 +124,7 @@@@ server-key = ../tests/server-key.pem
 # The Certificate Authority that will be used to verify
 # client certificates (public keys) if certificate authentication
 # is set.
-ca-cert = ../tests/ca.pem
+ca-cert = ${SYSCONFDIR}/ocserv/ca.pem
 
 
 ### All configuration options below this line are reloaded on a SIGHUP.
@@@@ -147,16 +136,6 @@@@ ca-cert = ../tests/ca.pem
d78 1
a78 1
@@@@ -281,9 +260,8 @@@@ min-reauth-time = 300
d90 1
a90 1
@@@@ -297,7 +275,6 @@@@ ban-reset-time = 300
d98 1
a98 1
@@@@ -364,7 +341,7 @@@@ rekey-method = ssl
d107 1
a107 1
@@@@ -477,6 +454,11 @@@@ no-route = 192.168.5.0/255.255.255.0
a118 22
@@@@ -549,21 +531,6 @@@@ no-route = 192.168.5.0/255.255.255.0
 # and '%{G}', if present will be replaced by the username and group name.
 #proxy-url = http://example.com/
 #proxy-url = http://example.com/%{U}/
-
-# This option allows you to specify a URL location where a client can
-# post using MS-KKDCP, and the message will be forwarded to the provided
-# KDC server. That is a translation URL between HTTP and Kerberos.
-# In MIT kerberos you'll need to add in realms:
-#   EXAMPLE.COM = {
-#     kdc = https://ocserv.example.com/KdcProxy
-#     http_anchors = FILE:/etc/ocserv-ca.pem
-#   }
-# This option is available if ocserv is compiled with GSSAPI support. 
-
-#kkdcp = "SERVER-PATH KERBEROS-REALM PROTOCOL@@SERVER:PORT"
-#kkdcp = "/KdcProxy KERBEROS.REALM udp@@127.0.0.1:88"
-#kkdcp = "/KdcProxy KERBEROS.REALM tcp@@127.0.0.1:88"
-#kkdcp = "/KdcProxy KERBEROS.REALM tcp@@[::1]:88"
 
 #
 # The following options are for (experimental) AnyConnect client 
@


1.11
log
@update to ocserv-0.11.1, mostly similar to part of a diff from Bjorn Ketelaars
@
text
@d1 1
a1 1
$OpenBSD$
d5 2
a6 2
--- doc/sample.config.orig	Sat Mar 19 14:25:48 2016
+++ doc/sample.config	Sat Mar 19 14:26:51 2016
d17 1
a17 1
 # file. If the groupconfig option is set, then config-per-user will be overriden,
@


1.10
log
@update to ocserv-0.10.11, similar diff from Björn Ketelaars
@
text
@d1 1
a1 1
$OpenBSD: patch-doc_sample_config,v 1.9 2015/11/30 11:58:57 sthen Exp $
d5 2
a6 2
--- doc/sample.config.orig	Fri Jan  8 15:37:21 2016
+++ doc/sample.config	Fri Jan  8 15:38:54 2016
d72 1
a72 1
@@@@ -135,18 +124,12 @@@@ server-key = ../tests/server-key.pem
d81 3
a83 1
 ### The options above, will remain unchanged.
d89 4
d98 1
a98 1
@@@@ -271,9 +254,8 @@@@ min-reauth-time = 300
d110 1
a110 1
@@@@ -287,7 +269,6 @@@@ ban-reset-time = 300
d118 1
a118 1
@@@@ -362,7 +343,7 @@@@ rekey-method = ssl
d127 1
a127 1
@@@@ -471,6 +452,11 @@@@ no-route = 192.168.5.0/255.255.255.0
d138 2
a139 2
 # When set to true, all client's iroutes are made visible to all
@@@@ -532,20 +518,6 @@@@ no-route = 192.168.5.0/255.255.255.0
d154 4
a157 3
-#kkdcp = SERVER-PATH KERBEROS-REALM PROTOCOL@@SERVER:PORT
-#kkdcp = /KdcProxy EXAMPLE.COM udp@@127.0.0.1:88
-#kkdcp = /KdcProxy EXAMPLE.COM tcp@@127.0.0.1:88
@


1.9
log
@update to ocserv-0.10.10
@
text
@d1 1
a1 1
$OpenBSD: patch-doc_sample_config,v 1.8 2015/11/23 15:10:57 sthen Exp $
d5 2
a6 2
--- doc/sample.config.orig	Mon Nov 30 11:45:14 2015
+++ doc/sample.config	Mon Nov 30 11:48:13 2015
d121 9
a129 5
@@@@ -471,6 +452,7 @@@@ no-route = 192.168.5.0/255.255.255.0
 # any other routes. All the routes applied by ocserv can be reverted
 # using /etc/ocserv/ocserv-fw --removeall. This option can be set globally
 # or in the per-user configuration.
+# To use this with PF, you will need to supply your own ocserv-fw script.
d133 1
a133 1
@@@@ -532,20 +514,6 @@@@ no-route = 192.168.5.0/255.255.255.0
@


1.8
log
@enable radius support in ocserv
@
text
@d1 1
a1 1
$OpenBSD: patch-doc_sample_config,v 1.7 2015/10/09 14:47:40 sthen Exp $
d5 2
a6 2
--- doc/sample.config.orig	Sun Sep 27 07:32:39 2015
+++ doc/sample.config	Sat Nov 21 00:36:18 2015
d92 1
a92 1
@@@@ -276,9 +259,8 @@@@ min-reauth-time = 300
d104 1
a104 1
@@@@ -292,7 +274,6 @@@@ ban-reset-time = 300
d112 1
a112 1
@@@@ -354,7 +335,7 @@@@ rekey-method = ssl
d121 9
a129 1
@@@@ -498,20 +479,6 @@@@ no-route = 192.168.5.0/255.255.255.0
@


1.7
log
@update to ocserv-0.10.9
@
text
@d1 1
a1 1
$OpenBSD: patch-doc_sample_config,v 1.6 2015/09/04 21:05:55 sthen Exp $
a2 1
no freeradius-client in ports yet (also disabled in autoconf)
d6 1
a6 1
+++ doc/sample.config	Fri Oct  9 15:45:23 2015
d12 1
a12 1
+# plain, pam.
d16 4
a19 10
@@@@ -20,47 +20,26 @@@@
 # to generate password entries. The 'otp' suboption allows to specify
 # an oath password file to be used for one time passwords; the format of
 # the file is described in https://code.google.com/p/mod-authn-otp/wiki/UsersFile
-#
-# radius[config=/etc/radiusclient/radiusclient.conf,groupconfig=true,nas-identifier=name,override-interim-updates=false]:
-#  The radius option requires specifying freeradius-client configuration
-# file. If the groupconfig option is set, then config-per-user will be overriden,
-# and all configuration will be read from radius. The 'override-interim-updates' if set to
-# true will ignore Acct-Interim-Interval from the server and 'stats-report-time' will be considered.
d32 1
a32 6
 #auth = "plain[passwd=./sample.passwd,otp=./sample.otp]"
 auth = "plain[passwd=./sample.passwd]"
 #auth = "certificate"
-#auth = "radius[config=/etc/radiusclient/radiusclient.conf,groupconfig=true]"
 
 # Specify alternative authentication methods that are sufficient
d40 2
a41 15
-# radius: can be combined with any authentication method, it provides
-#      radius accounting to available users (see also stats-report-time).
-#
 # pam: can be combined with any authentication method, it provides
 #      a validation of the connecting user's name using PAM. It is
 #      superfluous to use this method when authentication is already
 #      PAM.
 #
 # Only one accounting method can be specified.
-#acct = "radius[config=/etc/radiusclient/radiusclient.conf]"
+#acct = "pam"
 
 # Use listen-host to limit to specific IPs or to the IPs of a provided 
 # hostname.
@@@@ -83,8 +62,8 @@@@ udp-port = 443
d52 1
a52 1
@@@@ -93,7 +72,7 @@@@ run-as-group = daemon
d61 1
a61 1
@@@@ -108,8 +87,8 @@@@ socket-file = /var/run/ocserv-socket
d72 1
a72 1
@@@@ -135,18 +114,12 @@@@ server-key = ../tests/server-key.pem
d92 1
a92 11
@@@@ -175,8 +148,7 @@@@ max-same-clients = 2
 
 # Stats report time. The number of seconds after which each
 # worker process will report its usage statistics (number of
-# bytes transferred etc). This is useful when accounting like
-# radius is in use.
+# bytes transferred etc).
 #stats-report-time = 360
 
 # Keepalive in seconds
@@@@ -276,9 +248,8 @@@@ min-reauth-time = 300
d99 1
a99 1
+# and a connection is 1 point. Note that due to difference processes
d104 1
a104 1
@@@@ -292,7 +263,6 @@@@ ban-reset-time = 300
d112 1
a112 1
@@@@ -354,7 +324,7 @@@@ rekey-method = ssl
d121 1
a121 10
@@@@ -382,7 +352,7 @@@@ predictable-ips = true
 default-domain = example.com
 
 # The pool of addresses that leases will be given from. If the leases
-# are given via Radius, or via the explicit-ip? per-user config option then 
+# are given via the explicit-ip? per-user config option then 
 # these network values should contain a network with at least a single
 # address that will remain under the full control of ocserv (that is
 # to be able to assign the local part of the tun device address).
@@@@ -498,20 +468,6 @@@@ no-route = 192.168.5.0/255.255.255.0
@


1.6
log
@update to ocserv-0.10.8
@
text
@d1 1
a1 1
$OpenBSD: patch-doc_sample_config,v 1.5 2015/08/14 11:20:07 sthen Exp $
d6 2
a7 2
--- doc/sample.config.orig	Mon Aug 31 20:19:45 2015
+++ doc/sample.config	Fri Sep  4 22:01:20 2015
d17 5
a21 4
@@@@ -19,42 +19,17 @@@@
 # One entry must be listed per line, and 'ocpasswd' should be used
 # to generate password entries.
 #
d39 1
d51 1
a51 1
-# Accounting methods available:
d55 6
a60 2
-# Only one accounting method can be specified.
-#acct = "pam"
d62 2
a63 1
-
d66 1
a66 2
 #listen-host = [IP|HOSTNAME]
@@@@ -76,8 +51,8 @@@@ udp-port = 443
d77 1
a77 1
@@@@ -86,7 +61,7 @@@@ run-as-group = daemon
d86 1
a86 1
@@@@ -101,8 +76,8 @@@@ socket-file = /var/run/ocserv-socket
d97 1
a97 1
@@@@ -128,18 +103,12 @@@@ server-key = ../tests/server-key.pem
d117 1
a117 1
@@@@ -168,8 +137,7 @@@@ max-same-clients = 2
d127 1
a127 1
@@@@ -267,9 +235,8 @@@@ min-reauth-time = 300
d139 1
a139 1
@@@@ -283,7 +250,6 @@@@ ban-reset-time = 300
d147 1
a147 1
@@@@ -345,7 +311,7 @@@@ rekey-method = ssl
d156 1
a156 1
@@@@ -373,7 +339,7 @@@@ predictable-ips = true
d165 1
a165 1
@@@@ -486,20 +452,6 @@@@ no-route = 192.168.5.0/255.255.255.0
@


1.5
log
@update to ocserv-0.10.7, Björn Ketelaars had the same diff
@
text
@d1 1
a1 1
$OpenBSD: patch-doc_sample_config,v 1.4 2015/07/02 20:50:21 sthen Exp $
d6 2
a7 2
--- doc/sample.config.orig	Wed Jul 15 18:17:22 2015
+++ doc/sample.config	Thu Aug  6 18:29:29 2015
d17 1
a17 2
@@@@ -18,45 +18,23 @@@@
 # "username:groupname1,groupname2:encoded-password"
d20 1
a20 1
-#
d49 1
a49 4
 # Accounting methods available:
 # pam: can only be combined with PAM authentication method, it provides
 #      a session opened using PAM.
 #
d53 2
a54 2
 # Only one accounting method can be specified.
 #acct = "pam"
d56 1
a56 1
 
d59 2
a60 1
@@@@ -79,8 +57,8 @@@@ udp-port = 443
d71 1
a71 1
@@@@ -89,7 +67,7 @@@@ run-as-group = daemon
d80 1
a80 1
@@@@ -104,8 +82,8 @@@@ socket-file = /var/run/ocserv-socket
d91 1
a91 1
@@@@ -131,18 +109,12 @@@@ server-key = ../tests/server-key.pem
d111 1
a111 1
@@@@ -171,8 +143,7 @@@@ max-same-clients = 2
d121 1
a121 1
@@@@ -270,9 +241,8 @@@@ min-reauth-time = 300
d133 1
a133 1
@@@@ -286,7 +256,6 @@@@ ban-reset-time = 300
d141 1
a141 1
@@@@ -348,7 +317,7 @@@@ rekey-method = ssl
d150 1
a150 1
@@@@ -376,7 +345,7 @@@@ predictable-ips = true
d159 1
a159 1
@@@@ -489,20 +458,6 @@@@ no-route = 192.168.5.0/255.255.255.0
@


1.4
log
@update to ocserv 0.10.6, from Bjorn Ketelaars
@
text
@d1 1
a1 1
$OpenBSD: patch-doc_sample_config,v 1.3 2015/05/25 20:57:11 sthen Exp $
d6 2
a7 2
--- doc/sample.config.orig	Wed Jul  1 20:41:01 2015
+++ doc/sample.config	Thu Jul  2 06:51:29 2015
d114 1
a114 1
@@@@ -165,8 +137,7 @@@@ max-same-clients = 2
d124 1
a124 1
@@@@ -264,9 +235,8 @@@@ min-reauth-time = 300
d136 1
a136 1
@@@@ -280,7 +250,6 @@@@ ban-reset-time = 300
d144 1
a144 1
@@@@ -342,7 +311,7 @@@@ rekey-method = ssl
d153 1
a153 1
@@@@ -370,7 +339,7 @@@@ predictable-ips = true
d162 1
a162 1
@@@@ -483,20 +452,6 @@@@ no-route = 192.168.5.0/255.255.255.0
@


1.3
log
@update to ocserv-0.10.5, mostly from Björn Ketelaars with additional
patches (pcl.c, occtl-time.c) from me.
@
text
@d1 1
a1 1
$OpenBSD: patch-doc_sample_config,v 1.2 2015/03/29 20:02:41 sthen Exp $
d6 2
a7 2
--- doc/sample.config.orig	Sat May 23 11:15:59 2015
+++ doc/sample.config	Sun May 24 14:18:16 2015
d17 2
a18 1
@@@@ -19,44 +19,23 @@@@
d21 1
a21 1
 #
d46 2
a47 2
 #enable-auth = certificate
-#enable-auth = gssapi
d63 1
a63 1
@@@@ -79,8 +58,8 @@@@ udp-port = 443
d74 6
a79 2
@@@@ -92,18 +71,12 @@@@ run-as-group = daemon
 socket-file = /var/run/ocserv-socket
d82 18
a99 2
-#chroot-dir = /path/to/chroot
+chroot-dir = /var/run/ocserv
d114 1
a114 1
@@@@ -126,8 +99,7 @@@@ max-same-clients = 2
d124 1
a124 12
@@@@ -160,8 +132,8 @@@@ try-mtu-discovery = false
 #
 # There may be multiple server-cert and server-key directives,
 # but each key should correspond to the preceding certificate.
-server-cert = ../tests/server-cert.pem
-server-key = ../tests/server-key.pem
+server-cert = ${SYSCONFDIR}/ocserv/server-cert.pem
+server-key = ${SYSCONFDIR}/ocserv/server-key.pem
 
 # Diffie-Hellman parameters. Only needed if you require support
 # for the DHE ciphersuites (by default this server supports ECDHE).
@@@@ -255,9 +227,8 @@@@ min-reauth-time = 300
d136 1
a136 1
@@@@ -271,7 +242,6 @@@@ ban-reset-time = 300
d144 10
a153 1
@@@@ -361,7 +331,7 @@@@ predictable-ips = true
d162 1
a162 1
@@@@ -474,20 +444,6 @@@@ no-route = 192.168.5.0/255.255.255.0
@


1.2
log
@update to ocserv 0.10.2
@
text
@d1 1
a1 1
$OpenBSD: patch-doc_sample_config,v 1.1.1.1 2015/03/26 02:07:59 sthen Exp $
d6 2
a7 2
--- doc/sample.config.orig	Sat Mar 14 17:58:07 2015
+++ doc/sample.config	Sun Mar 29 20:57:46 2015
d17 1
a17 2
@@@@ -18,45 +18,23 @@@@
 # "username:groupname1,groupname2:encoded-password"
d20 2
a21 2
-#
-# radius[config=/etc/radiusclient/radiusclient.conf,groupconfig=true,nas-identifier=name]:
d24 2
a25 4
-# and all configuration will be read from radius. The supported atributes for
-# radius configuration are:
-# Group-Name, Framed-IPv6-Address, Framed-IPv6-Prefix, DNS-Server-IPv6-Address,
-# Framed-IP-Address, Framed-IP-Netmask, MS-Primary-DNS-Server, MS-Secondary-DNS-Server
d27 1
a27 1
-# gssapi[keytab=/etc/key.tab,require-local-user-map=false]
d32 3
a34 1
-# is true.
d47 1
a47 1
-#enable-auth = "gssapi[keytab=/etc/key.tab,require-local-user-map=true]"
d62 1
a62 1
@@@@ -79,8 +57,8 @@@@ udp-port = 443
d73 1
a73 1
@@@@ -92,18 +70,12 @@@@ run-as-group = daemon
d93 2
a94 1
@@@@ -127,7 +99,8 @@@@ max-same-clients = 2
d97 1
a97 1
 # bytes transferred etc). This is useful when accounting like
d99 1
a99 2
+# radius is in use. (Radius is not currently available in the
+# OpenBSD package).
d103 1
a103 1
@@@@ -160,8 +133,8 @@@@ try-mtu-discovery = false
d114 50
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
$OpenBSD$
d4 1
a4 1
no seccomp
d6 2
a7 2
--- doc/sample.config.orig	Sat Feb 14 10:14:07 2015
+++ doc/sample.config	Sun Feb 15 10:56:02 2015
d11 2
a12 2
 # multiple auth directives. Available options: certificate,
-# plain, pam, radius[configfile,groupconfig]. 
d14 2
d17 2
a18 3
 # certificate:
 #  This indicates that all connecting users must present a certificate.
@@@@ -17,26 +17,11 @@@@
d21 2
a22 2
 #
-# radius[/etc/radiusclient/radiusclient.conf,groupconfig]:
d29 8
a36 2
-
 #auth = "certificate"
d39 45
a83 2
 auth = "plain[./sample.passwd]"
-#auth = "radius[/etc/radiusclient/radiusclient.conf,groupconfig]"
d94 11
a104 1
@@@@ -107,8 +92,8 @@@@ try-mtu-discovery = false
a114 21
@@@@ -250,16 +235,16 @@@@ use-occtl = true
 pid-file = /var/run/ocserv.pid
 
 # The default server directory. Does not require any devices present.
-#chroot-dir = /path/to/chroot
+chroot-dir = /var/run/ocserv
 
 # socket file used for server IPC (worker-main), will be appended with .PID
 # It must be accessible within the chroot environment (if any)
-socket-file = /var/run/ocserv-socket
+socket-file = ocserv-socket
 
 # The user the worker processes will be run as. It should be
 # unique (no other services run as this user).
-run-as-user = nobody
-run-as-group = daemon
+run-as-user = _ocserv
+run-as-group = _ocserv
 
 # Set the protocol-defined priority (SO_PRIORITY) for packets to
 # be sent. That is a number from 0 to 6 with 0 being the lowest
@


1.1.1.1
log
@import ports/net/ocserv, ok/feedback jasper@@

OpenConnect VPN server (or ocserv) implements the AnyConnect SSL VPN
protocol and is compatible with the OpenConnect VPN client. Its purpose
is to be a small, secure and configurable VPN server that depends on
standard protocols like TLS 1.2, and Datagram TLS. The AnyConnect
SSL VPN protocol was the closest protocol to match this requirement.

The VPN users can be authenticated using password, certificate
authentication or both methods. Authenticated users are assigned their
own unprivileged worker process and obtain a networking (tun) device
and IP from a configurable pool of addresses.
@
text
@@
