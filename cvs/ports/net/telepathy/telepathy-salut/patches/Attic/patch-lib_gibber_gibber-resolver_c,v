head	1.4;
access;
symbols
	OPENBSD_4_8:1.1.0.6
	OPENBSD_4_8_BASE:1.1
	OPENBSD_4_7:1.1.0.4
	OPENBSD_4_7_BASE:1.1
	OPENBSD_4_6:1.1.0.2
	OPENBSD_4_6_BASE:1.1;
locks; strict;
comment	@# @;


1.4
date	2011.01.17.17.20.21;	author jasper;	state dead;
branches;
next	1.3;

1.3
date	2010.09.23.14.37.06;	author jasper;	state Exp;
branches;
next	1.2;

1.2
date	2010.09.23.13.47.35;	author jasper;	state Exp;
branches;
next	1.1;

1.1
date	2009.06.03.16.40.06;	author ajacoutot;	state Exp;
branches;
next	;


desc
@@


1.4
log
@- update telepathy-salut to 0.4.0

ok aja@@
@
text
@$OpenBSD: patch-lib_gibber_gibber-resolver_c,v 1.3 2010/09/23 14:37:06 jasper Exp $

Use GETSHORT instead of NS_GET16 which comes with libresolv.

--- lib/gibber/gibber-resolver.c.orig	Wed Aug 18 09:52:58 2010
+++ lib/gibber/gibber-resolver.c	Thu Sep 23 16:33:03 2010
@@@@ -34,6 +34,10 @@@@
   #include "gibber-resolver-asyncns.h"
 #endif
 
+#ifndef NS_GET16
+#  define NS_GET16 GETSHORT
+#endif
+
 static GibberResolver *resolver_singleton = NULL;
 static GType resolver_singleton_type = 0;
 
@


1.3
log
@- better patch
@
text
@d1 1
a1 1
$OpenBSD: patch-lib_gibber_gibber-resolver_c,v 1.2 2010/09/23 13:47:35 jasper Exp $
@


1.2
log
@- update telepathy-salut to 0.3.13
@
text
@d1 1
a1 1
$OpenBSD: patch-lib_gibber_gibber-resolver_c,v 1.1 2009/06/03 16:40:06 ajacoutot Exp $
d5 5
a9 3
--- lib/gibber/gibber-resolver.c.orig	Tue Sep 21 20:10:57 2010
+++ lib/gibber/gibber-resolver.c	Tue Sep 21 20:12:26 2010
@@@@ -683,8 +683,8 @@@@ gibber_resolver_res_query_to_list (guchar *answer, int
d11 6
a16 6
        /* Ignore the initial string, which has the query in it */
        pos += len;
-       NS_GET16 (type, pos);
-       NS_GET16 (class, pos);
+       GETSHORT (type, pos);
+       GETSHORT (class, pos);
a17 15
        if (type != T_SRV || class != C_IN)
          goto failed;
@@@@ -692,9 +692,9 @@@@ gibber_resolver_res_query_to_list (guchar *answer, int
        /* skip ttl and dlen */
        pos += 6;
 
-       NS_GET16 (pref, pos);
-       NS_GET16 (weight, pos);
-       NS_GET16 (port, pos);
+       GETSHORT (pref, pos);
+       GETSHORT (weight, pos);
+       GETSHORT (port, pos);
        len = dn_expand (answer, end, pos, name, 255);
 
        list = g_list_prepend (list,
@


1.1
log
@- we have avahi now, so unbreak
- update to the latest stable release
@
text
@d1 1
a1 1
$OpenBSD$
d5 3
a7 11
--- lib/gibber/gibber-resolver.c.orig	Thu Apr  2 12:12:20 2009
+++ lib/gibber/gibber-resolver.c	Tue Jun  2 08:38:27 2009
@@@@ -27,6 +27,7 @@@@
 #include <resolv.h>
 #include <sys/types.h>
 #include <netdb.h>
+#include <netinet/in.h>
 
 #include <errno.h>
 
@@@@ -686,8 +687,8 @@@@ gibber_resolver_res_query_to_list (guchar *answer, int
d18 1
a18 1
@@@@ -695,9 +696,9 @@@@ gibber_resolver_res_query_to_list (guchar *answer, int
@

