head	1.1;
access;
symbols;
locks; strict;
comment	@# @;


1.1
date	2017.06.02.14.30.27;	author sthen;	state Exp;
branches;
next	;
commitid	Rk4qhQWEfdvDkBeC;


desc
@@


1.1
log
@update to mtr-0.92, features include:

- shiny new DNS code that gets rid of the horrible libbind hack.

- the privileged packet sending code has been split out into a separate
"mtr-packet" process with a clear separation between init/main code, which
communicates with the main mtr process over a pipe.

Patch to add a pledge to mtr-packet, currently disabled; it works for
ICMP but requires additional sockopts to work with UDP.
@
text
@$OpenBSD$

Not yet enabled, requires additional sockopts:

SOL_SOCKET:	SO_REUSEADDR, SO_REUSEPORT
IPPROTO_IPV6:	IPV6_CHECKSUM

Index: packet/packet.c
--- packet/packet.c.orig
+++ packet/packet.c
@@@@ -65,6 +65,12 @@@@ int drop_elevated_permissions(
     }
 #endif
 
+#ifdef __OpenBSD__
+    if (0 && pledge("stdio inet", NULL) == -1) {
+        return -1;
+    }
+#endif
+
     return 0;
 }
 
@
