head	1.50;
access;
symbols
	OPENBSD_6_0:1.39.0.2
	OPENBSD_6_0_BASE:1.39
	OPENBSD_5_9:1.32.0.2
	OPENBSD_5_9_BASE:1.32
	OPENBSD_5_8:1.20.0.4
	OPENBSD_5_8_BASE:1.20
	OPENBSD_5_7:1.16.0.2
	OPENBSD_5_7_BASE:1.16
	OPENBSD_5_6:1.6.0.2
	OPENBSD_5_6_BASE:1.6
	landry_20140714:1.1.1.1
	nigel:1.1.1;
locks; strict;
comment	@# @;


1.50
date	2017.03.04.10.46.46;	author sthen;	state Exp;
branches;
next	1.49;
commitid	5kkDUd5aRtTYKQwT;

1.49
date	2017.01.24.14.20.27;	author sthen;	state Exp;
branches;
next	1.48;
commitid	Dh2iIdW0CCNwlsAu;

1.48
date	2017.01.04.19.51.40;	author sthen;	state Exp;
branches;
next	1.47;
commitid	ZGCFer1PrJMvrUEk;

1.47
date	2016.12.25.14.34.39;	author zhuk;	state Exp;
branches;
next	1.46;
commitid	l6KSNN1DfB6ABkhu;

1.46
date	2016.12.15.10.00.15;	author sthen;	state Exp;
branches;
next	1.45;
commitid	CRVP7gTLMj5VIxPA;

1.45
date	2016.11.17.13.46.59;	author sthen;	state Exp;
branches;
next	1.44;
commitid	jmuwWupqcvfTtgsa;

1.44
date	2016.11.12.16.15.31;	author sthen;	state Exp;
branches;
next	1.43;
commitid	tGzlLXSgL535SS0D;

1.43
date	2016.10.14.11.00.21;	author sthen;	state Exp;
branches;
next	1.42;
commitid	93Y9IZOrkkFlT9ZV;

1.42
date	2016.10.12.11.17.29;	author sthen;	state Exp;
branches;
next	1.41;
commitid	ui3oyQG40EX8IEb4;

1.41
date	2016.09.13.12.27.15;	author sthen;	state Exp;
branches;
next	1.40;
commitid	GidbjaKzATWgAeSe;

1.40
date	2016.07.30.20.53.11;	author sthen;	state Exp;
branches;
next	1.39;
commitid	kEwpIxYdG5cW8swi;

1.39
date	2016.06.07.21.39.11;	author sthen;	state Exp;
branches
	1.39.2.1;
next	1.38;
commitid	bLSyczWANk6VxiCj;

1.38
date	2016.04.23.22.14.00;	author sthen;	state Exp;
branches;
next	1.37;
commitid	tLHQRO3IKtC0vu0u;

1.37
date	2016.03.20.16.12.25;	author naddy;	state Exp;
branches;
next	1.36;
commitid	guiZq8cnNbVyyHzx;

1.36
date	2016.03.05.16.26.40;	author kirby;	state Exp;
branches;
next	1.35;
commitid	zYCSJprsGCr5LKoS;

1.35
date	2016.03.04.10.11.22;	author kirby;	state Exp;
branches;
next	1.34;
commitid	fuk4WSoYbEI5JByn;

1.34
date	2016.03.01.00.07.17;	author sthen;	state Exp;
branches;
next	1.33;
commitid	QBhOYg1ODJRuhu7C;

1.33
date	2016.02.27.18.01.42;	author sthen;	state Exp;
branches;
next	1.32;
commitid	Qrq4UgH6YXp0jska;

1.32
date	2016.01.03.14.59.33;	author sthen;	state Exp;
branches
	1.32.2.1;
next	1.31;
commitid	FR04hDcFBmKpdB6V;

1.31
date	2015.12.30.15.42.24;	author sthen;	state Exp;
branches;
next	1.30;
commitid	ckrbHlHEXgp5m3FM;

1.30
date	2015.11.24.09.53.27;	author sthen;	state Exp;
branches;
next	1.29;
commitid	iV9zx137bJ33ZRwp;

1.29
date	2015.11.21.10.38.05;	author sthen;	state Exp;
branches;
next	1.28;
commitid	Ip025phBu1ZyjuMe;

1.28
date	2015.11.21.02.04.48;	author sthen;	state Exp;
branches;
next	1.27;
commitid	6jE9CvpN4bifpNcw;

1.27
date	2015.11.20.19.58.50;	author sthen;	state Exp;
branches;
next	1.26;
commitid	xBjv4JSdRPpDSH25;

1.26
date	2015.11.19.21.33.36;	author sthen;	state Exp;
branches;
next	1.25;
commitid	Gzhsw2lwQs2UACtY;

1.25
date	2015.10.14.20.21.15;	author sthen;	state Exp;
branches;
next	1.24;
commitid	CjOapncWyQe6ABZY;

1.24
date	2015.09.12.18.27.27;	author sthen;	state Exp;
branches;
next	1.23;
commitid	CyJChHREOu1hcxKx;

1.23
date	2015.09.12.16.00.35;	author tobiasu;	state Exp;
branches;
next	1.22;
commitid	U6cEf2mncd1xWitC;

1.22
date	2015.08.21.19.17.10;	author sthen;	state Exp;
branches;
next	1.21;
commitid	8EJcWdVX4S7jN0H9;

1.21
date	2015.08.12.20.59.53;	author sthen;	state Exp;
branches;
next	1.20;
commitid	oIhvxtA2cr63PMLs;

1.20
date	2015.06.22.20.33.11;	author sthen;	state Exp;
branches
	1.20.4.1;
next	1.19;
commitid	qgVATJoTEtAkHs0g;

1.19
date	2015.05.13.08.36.36;	author sthen;	state Exp;
branches;
next	1.18;
commitid	mVMiGJUSNZ7nmoJv;

1.18
date	2015.03.27.08.13.04;	author ajacoutot;	state Exp;
branches;
next	1.17;
commitid	qkrQPO6KjSKIuf3s;

1.17
date	2015.03.14.21.46.46;	author sthen;	state Exp;
branches;
next	1.16;
commitid	1J6L6FiM14MbI3Lb;

1.16
date	2015.02.14.00.14.31;	author sthen;	state Exp;
branches
	1.16.2.1;
next	1.15;
commitid	M5BXGeDD2VVaRoOP;

1.15
date	2015.02.13.22.29.09;	author sthen;	state Exp;
branches;
next	1.14;
commitid	3FmdcU8tOsDSs0uv;

1.14
date	2014.12.29.10.38.57;	author sthen;	state Exp;
branches;
next	1.13;
commitid	1FsyyB9bWiwbcZfW;

1.13
date	2014.10.17.23.29.46;	author sthen;	state Exp;
branches;
next	1.12;
commitid	hwiUlloYdTkNo8pf;

1.12
date	2014.10.17.22.42.23;	author sthen;	state Exp;
branches;
next	1.11;
commitid	KFfw6VH3zoj7rXiT;

1.11
date	2014.09.17.21.57.08;	author sthen;	state Exp;
branches;
next	1.10;
commitid	RnHfHHI5Bnh1aEKl;

1.10
date	2014.09.01.16.36.04;	author pascal;	state Exp;
branches;
next	1.9;
commitid	kWKO7tRALbmS6v54;

1.9
date	2014.09.01.09.28.41;	author landry;	state Exp;
branches;
next	1.8;
commitid	R90qPLLqk1m7NJyL;

1.8
date	2014.08.19.05.35.58;	author landry;	state Exp;
branches;
next	1.7;
commitid	bePURuVLYVxIZZFV;

1.7
date	2014.08.10.19.23.00;	author sthen;	state Exp;
branches;
next	1.6;
commitid	uZYyYeeRqnPcwezP;

1.6
date	2014.07.21.22.19.06;	author sthen;	state Exp;
branches
	1.6.2.1;
next	1.5;
commitid	ln6KEylrHOVcFMLi;

1.5
date	2014.07.18.21.31.53;	author sthen;	state Exp;
branches;
next	1.4;
commitid	zqjbINboceFn4dY2;

1.4
date	2014.07.18.20.21.07;	author ajacoutot;	state Exp;
branches;
next	1.3;
commitid	SUMSL6SwJSNfKKGf;

1.3
date	2014.07.18.19.56.53;	author sthen;	state Exp;
branches;
next	1.2;
commitid	gTanHeYBiC4Kv4J5;

1.2
date	2014.07.14.08.54.29;	author landry;	state Exp;
branches;
next	1.1;
commitid	hfbstvmJFp1KbNyA;

1.1
date	2014.07.14.08.44.51;	author landry;	state Exp;
branches
	1.1.1.1;
next	;
commitid	NIXbEl5IMDizAMxx;

1.1.1.1
date	2014.07.14.08.44.51;	author landry;	state Exp;
branches;
next	;
commitid	NIXbEl5IMDizAMxx;

1.6.2.1
date	2014.10.17.22.44.24;	author sthen;	state Exp;
branches;
next	;
commitid	svci5vlVhZ0HlIrh;

1.16.2.1
date	2015.05.13.08.37.30;	author sthen;	state Exp;
branches;
next	1.16.2.2;
commitid	hqKnUhH4dfu29CmN;

1.16.2.2
date	2015.05.13.17.00.09;	author jasper;	state Exp;
branches;
next	1.16.2.3;
commitid	UoYXW93WmhCwN3Xt;

1.16.2.3
date	2015.08.12.21.03.19;	author sthen;	state Exp;
branches;
next	;
commitid	mrqcFbRv9EyQ3hj3;

1.20.4.1
date	2015.08.24.09.37.40;	author sthen;	state Exp;
branches;
next	;
commitid	p0piYQcL6ySwrbQp;

1.32.2.1
date	2016.05.06.19.47.52;	author sthen;	state Exp;
branches;
next	1.32.2.2;
commitid	MKMz7xu0r9zTXGQb;

1.32.2.2
date	2016.06.07.21.40.09;	author sthen;	state Exp;
branches;
next	1.32.2.3;
commitid	yaNQYUA2kuhg22SZ;

1.32.2.3
date	2016.07.30.20.54.39;	author sthen;	state Exp;
branches;
next	;
commitid	7kecyMbu0ajOStL9;

1.39.2.1
date	2016.07.30.20.53.55;	author sthen;	state Exp;
branches;
next	1.39.2.2;
commitid	BBycdMMWn5LC7yNT;

1.39.2.2
date	2016.11.17.14.18.55;	author sthen;	state Exp;
branches;
next	1.39.2.3;
commitid	A9JmHlVW6EoDIexW;

1.39.2.3
date	2017.01.24.15.38.38;	author sthen;	state Exp;
branches;
next	1.39.2.4;
commitid	HR37RWqKatHu3HIY;

1.39.2.4
date	2017.03.04.11.35.06;	author sthen;	state Exp;
branches;
next	;
commitid	KvELSBFhGPmZ1bId;


desc
@@


1.50
log
@update to wireshark-2.2.5
dissector crashes and infinite loops, file parser crashes and some other fixes
@
text
@# $OpenBSD: Makefile,v 1.49 2017/01/24 14:20:27 sthen Exp $

# XXX should add pledge to dumpcap.

BROKEN-alpha =	.got subsegment exceeds 64K (size 101480)
BROKEN-sparc64 = cc: Internal error: Illegal instruction (program cc1)

COMMENT-main =	graphical network protocol analyzer, Qt user-interface
COMMENT-gtk =	graphical network protocol analyzer, Gtk+3 user-interface
COMMENT-text =	network protocol analyzer

WVER =		2.2.5
PORTROACH =	limitw:1,even
DISTNAME =	wireshark-${WVER}
PKGNAME-main =	wireshark-${WVER}
PKGNAME-gtk =	wireshark-gtk-${WVER}
PKGNAME-text =	tshark-${WVER}

SHARED_LIBS +=	wscodecs             0.0      # 0.0
SHARED_LIBS +=	wsutil               3.0      # 5.0
SHARED_LIBS +=	wiretap              3.0      # 4.5
SHARED_LIBS +=	wireshark            3.0      # 5.5

CATEGORIES =	net security x11

HOMEPAGE =	http://www.wireshark.org/

EXTRACT_SUFX =	.tar.bz2

USE_GMAKE =	Yes

# Mostly GPLv2 or later. Some files are less restrictive.
# tools/pidl is GPLv3 or later. See COPYING.
PERMIT_PACKAGE_CDROM =	Yes

cWANTLIB +=	c glib-2.0 m pcap z

MAINTAINER =	Stuart Henderson <sthen@@openbsd.org>

MULTI_PACKAGES = -text -main -gtk

MODLUA_VERSION = 5.2
MODULES =	lang/lua \
		lang/python \
		x11/qt5
MODLUA_SA =	Yes
MODLUA_RUNDEP =	No
MODPY_RUNDEP =	No

WANTLIB-text =	${cWANTLIB} ${MODLUA_WANTLIB}
WANTLIB-text +=	GeoIP cares gcrypt gmodule-2.0 gnutls gpg-error smi ssh

WANTLIB-main =	${cWANTLIB} ${WANTLIB}
WANTLIB-main +=	pthread wireshark wiretap wscodecs wsutil
WANTLIB-main +=	Qt5Core Qt5Gui Qt5Multimedia Qt5PrintSupport Qt5Widgets

WANTLIB-gtk =	${cWANTLIB} wireshark wiretap wscodecs wsutil
WANTLIB-gtk +=	cairo gdk_pixbuf-2.0 gdk-3 gio-2.0 gobject-2.0 gtk-3
WANTLIB-gtk +=	pango-1.0 pangocairo-1.0 portaudio 

MASTER_SITES =		http://www.wireshark.org/download/src/all-versions/ \
			http://www.wireshark.org/download/automated/src/

SUBST_VARS =		WVER

BUILD_DEPENDS +=	devel/bison \
			devel/desktop-file-utils \
			textproc/libxml \
			textproc/libxslt \
			devel/xdg-utils \
			textproc/asciidoc
RUN_DEPENDS-main =	${RUN_DEPENDS} \
			devel/desktop-file-utils \
			devel/xdg-utils \
			misc/shared-mime-info \
			x11/gtk+3,-guic

LIB_DEPENDS-text =	${MODLUA_LIB_DEPENDS} \
			devel/glib2 \
			net/libcares \
			net/libsmi \
			net/GeoIP  \
			security/gnutls \
			security/libgcrypt \
			security/libssh

LIB_DEPENDS-main +=	${LIB_DEPENDS} \
			tshark-${WVER}:${BUILD_PKGPATH:S/,$//},-text \
			x11/qt5/qtmultimedia \
			x11/qt5/qtsvg
# will probably be "extra" - this library dep doesn't seem to actually show
# up in the package, possibly due to as-needed, but it does link the final
# binary with -lQt5Svg if it was found during configure. I'd rather have
# an "Extra" (that may later change to a real WANTLIB) than failing builds.
WANTLIB-main +=		Qt5Svg

LIB_DEPENDS-gtk +=	tshark-${WVER}:${BUILD_PKGPATH:S/,$//},-text \
			x11/gtk+3 \
			audio/portaudio-svn

MODULES +=		devel/cmake
CONFIGURE_STYLE =	cmake
CONFIGURE_ARGS =	-DDUMPCAP_INST_VALS=suid \
			-DCMAKE_INSTALL_MANDIR=${TRUEPREFIX}/man \
			-DCOMPILER_CAN_HANDLE_SSE4_2=false \
			-DSH_EXECUTABLE=/bin/ksh

NO_TEST =	Yes

.if ${MACHINE_ARCH:Mpowerpc}
CONFIGURE_ENV += LDFLAGS="-Wl,--relax"
.endif

post-install:
	${INSTALL_DATA_DIR} ${PREFIX}/share/applications
	${INSTALL_DATA} ${WRKSRC}/wireshark.desktop ${PREFIX}/share/applications/
.for _s in 16 24 32 48 64 128 256
	${INSTALL_DATA_DIR} ${PREFIX}/share/icons/hicolor/${_s}x${_s}/{apps,mimetypes}
	${INSTALL_DATA} ${WRKSRC}/image/wsicon${_s}.png ${PREFIX}/share/icons/hicolor/${_s}x${_s}/apps/wireshark.png
	${INSTALL_DATA} ${WRKSRC}/image/WiresharkDoc-${_s}.png ${PREFIX}/share/icons/hicolor/${_s}x${_s}/mimetypes/application-wireshark-doc.png
.endfor
	${INSTALL_DATA_DIR} ${PREFIX}/share/icons/hicolor/scalable/apps
	${INSTALL_DATA} ${WRKSRC}/image/wsicon.svg ${PREFIX}/share/icons/hicolor/scalable/apps/wireshark.svg

.include <bsd.port.mk>
@


1.49
log
@update to wireshark-2.2.4
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2017/01/04 19:51:40 sthen Exp $
d12 1
a12 1
WVER =		2.2.4
@


1.48
log
@Wireshark's cmake file picks up Qt5Svg causing build to break
intermittently following the big qt5 reorganisation. List it as a hard
dep; even though it doesn't actually show in objdump -p for the binary
(perhaps that is because of as-needed linking).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2016/12/25 14:34:39 zhuk Exp $
d12 1
a12 1
WVER =		2.2.3
a17 1
REVISION-main =	1
@


1.47
log
@Adapt to new x11/qt5 layout, mostly REVISION bumps due to changed deps.

The devel/kf5 to be handled separately, please wait.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2016/12/15 10:00:15 sthen Exp $
d18 1
a18 1
REVISION-main =	0
d90 7
a96 1
			x11/qt5/qtmultimedia
@


1.46
log
@update to wireshark-2.2.3
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2016/11/17 13:46:59 sthen Exp $
d18 1
d89 2
a90 1
			tshark-${WVER}:${BUILD_PKGPATH:S/,$//},-text
@


1.45
log
@update to wireshark-2.2.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2016/11/12 16:15:31 sthen Exp $
d12 1
a12 1
WVER =		2.2.2
@


1.44
log
@Add hidden dep (security/libssh) to Wireshark, noticed by naddy.
This enables building sshdump and ciscodump providing an interface
to run remote captures.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2016/10/14 11:00:21 sthen Exp $
d12 1
a12 1
WVER =		2.2.1
a17 1
REVISION-text =	0
@


1.43
log
@update to wireshark-2.2.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2016/10/12 11:17:29 sthen Exp $
d18 1
d52 1
a52 1
WANTLIB-text +=	GeoIP cares gcrypt gmodule-2.0 gnutls gpg-error smi
d85 2
a86 1
			security/libgcrypt
@


1.42
log
@update to wireshark-2.0.7
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2016/09/13 12:27:15 sthen Exp $
d12 1
a12 1
WVER =		2.0.7
d19 4
a22 3
SHARED_LIBS +=	wsutil               2.0      # 5.0
SHARED_LIBS +=	wiretap              2.0      # 4.5
SHARED_LIBS +=	wireshark            2.0      # 5.5
d54 1
a54 1
WANTLIB-main +=	gmodule-2.0 pthread wireshark wiretap wsutil
d57 2
a58 2
WANTLIB-gtk =	${cWANTLIB} wireshark wiretap wsutil
WANTLIB-gtk +=	cairo gdk_pixbuf-2.0 gdk-3 gmodule-2.0 gobject-2.0 gtk-3
@


1.41
log
@update to wireshark-2.0.6, fixing the following reported as security
bugs, plus various others including protocol dissection errors and crashes

wnpa-sec-2016-50: QNX6 QNET dissector crash.
wnpa-sec-2016-51: H.225 dissector crash.
wnpa-sec-2016-52: Catapult DCT2000 dissector crash.
wnpa-sec-2016-53: UMTS FP dissector crash.
wnpa-sec-2016-54: Catapult DCT2000 dissector crash.
wnpa-sec-2016-55: IPMI trace dissector crash.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2016/07/30 20:53:11 sthen Exp $
d12 1
a12 1
WVER =		2.0.6
@


1.40
log
@update to wireshark-2.0.5: usual dissector crashes, infinite loops, etc.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2016/06/07 21:39:11 sthen Exp $
d12 1
a12 1
WVER =		2.0.5
d35 1
a35 1
cWANTLIB +=	c glib-2.0 m pcap pthread z
d53 1
a53 1
WANTLIB-main +=	wireshark wiretap wsutil gmodule-2.0
@


1.39
log
@update to wireshark-2.0.4.

infinite loop and lots of crash fixes in dissectors, plus various other
issues.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2016/04/23 22:14:00 sthen Exp $
d12 1
a12 1
WVER =		2.0.4
@


1.39.2.1
log
@MFC: update to wireshark-2.0.5: usual dissector crashes, infinite loops, etc.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2016/07/30 20:53:11 sthen Exp $
d12 1
a12 1
WVER =		2.0.5
@


1.39.2.2
log
@update wireshark in -stable to 2.0.8
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39.2.1 2016/07/30 20:53:55 sthen Exp $
d12 1
a12 1
WVER =		2.0.8
@


1.39.2.3
log
@update wireshark in -stable to 2.0.10
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39.2.2 2016/11/17 14:18:55 sthen Exp $
d12 1
a12 1
WVER =		2.0.10
@


1.39.2.4
log
@update -stable to wireshark-2.0.11
dissector crashes and infinite loops, file parser crashes and some other fixes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39.2.3 2017/01/24 15:38:38 sthen Exp $
d12 1
a12 1
WVER =		2.0.11
@


1.38
log
@update to wireshark-2.0.3, many fixes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2016/03/20 16:12:25 naddy Exp $
d12 1
a12 1
WVER =		2.0.3
@


1.37
log
@drop SHARED_ONLY from python and ruby ports
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2016/03/05 16:26:40 kirby Exp $
d12 1
a12 2
WVER =		2.0.2
REVISION-text =	0
@


1.36
log
@revert previous.
python.module.mk could override do-build target if CONFIGURE_STYLE is empty.
discussed with sthen@@ and ajacoutot
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2016/03/01 00:07:17 sthen Exp $
a18 1
SHARED_ONLY =	Yes
@


1.35
log
@Remove explicitely set CONFIGURE_STYLE=cmake. It is already done via
MODULES=devel/cmake
OK dcoppa@@, czarkoff@@
@
text
@d95 1
@


1.34
log
@bump (GeoIP pkgpath change)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2016/02/27 18:01:42 sthen Exp $
a94 1
CONFIGURE_STYLE =	cmake
@


1.33
log
@update to wireshark-2.0.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2016/01/03 14:59:33 sthen Exp $
d13 1
@


1.32
log
@reinstate pkg-readme file
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2015/12/30 15:42:24 sthen Exp $
d7 1
d12 1
a12 2
WVER =		2.0.1
REVISION-main =	0
@


1.32.2.1
log
@MFC update to wireshark-2.0.3, dissector crashes etc as usual
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2016/04/23 22:14:00 sthen Exp $
a6 1

d11 2
a12 1
WVER =		2.0.3
d18 1
@


1.32.2.2
log
@MFC update to wireshark-2.0.4.

infinite loop and lots of crash fixes in dissectors, plus various other
issues.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2016/06/07 21:39:11 sthen Exp $
d12 1
a12 1
WVER =		2.0.4
@


1.32.2.3
log
@MFC: update to wireshark-2.0.5: usual dissector crashes, infinite loops, etc.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2016/07/30 20:53:11 sthen Exp $
d12 1
a12 1
WVER =		2.0.5
@


1.31
log
@update to Wireshark 2.0.1

the Qt5 UI is now fixed, and is upstream's current default, so install
this to /usr/local/bin/wireshark and subpackage the Gtk+3 version.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2015/11/24 09:53:27 sthen Exp $
d12 1
@


1.30
log
@= -> += in bdep.

sorry bulk builders :)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2015/11/21 10:38:05 sthen Exp $
a3 1
# XXX the Qt UI (upstream default) is broken here; segfault at startup.
d7 2
a8 1
COMMENT-main =	graphical network protocol analyzer
d11 1
a11 1
WVER =		2.0.0
d15 1
d39 1
a39 1
MULTI_PACKAGES =	-text -main
d49 1
a49 1
WANTLIB-text +=	${cWANTLIB} ${MODLUA_WANTLIB}
d52 7
a58 11
# when the qt version is repaired, it should go into -main
#LIB_DEPENDS-main += ${LIB_DEPENDS}
#WANTLIB-main +=	${cWANTLIB} ${WANTLIB}
#WANTLIB-main +=	wireshark wiretap wsutil gmodule-2.0 stdc++
#WANTLIB-main +=	Qt5Core Qt5Gui Qt5Multimedia Qt5PrintSupport Qt5Widgets
# ...just use a bdep for now, to avoid dpb failures
BUILD_DEPENDS +=	x11/qt5

WANTLIB-main +=	${cWANTLIB} wireshark wiretap wsutil
WANTLIB-main +=	cairo gdk_pixbuf-2.0 gdk-3 gmodule-2.0 gobject-2.0 gtk-3
WANTLIB-main +=	pango-1.0 pangocairo-1.0 portaudio 
d85 4
a88 1
LIB_DEPENDS-main =	tshark-${WVER}:${BUILD_PKGPATH:S/,$//},-text \
a114 2
	mv ${PREFIX}/bin/wireshark ${PREFIX}/bin/wireshark-qt
	ln -s wireshark-gtk ${PREFIX}/bin/wireshark
@


1.29
log
@ah, I found the source of the failure aja@@ ran into. bdep on qt5 for now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2015/11/21 02:04:48 sthen Exp $
d57 1
a57 1
BUILD_DEPENDS =	x11/qt5
d68 1
a68 1
BUILD_DEPENDS =		devel/bison \
@


1.28
log
@unbreak bdep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2015/11/20 19:58:50 sthen Exp $
d51 2
d56 3
@


1.27
log
@Add more BUILD_DEPENDS to Wireshark, and force using ksh. Should fix some
of the problems seen by aja@@ during build on exopi but one of them is a bit
odd and confusing, so might not fix everything.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2015/11/19 21:33:36 sthen Exp $
d65 2
a66 2
			devel/libxml \
			devel/libxslt \
@


1.26
log
@update to Wireshark 2.0.0

The new Qt user interface segfaults at startup on OpenBSD, so currently
only the Gtk+ user interface is packaged.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2015/09/12 18:27:27 sthen Exp $
d38 2
d41 3
a43 1
MODULES =	lang/lua lang/python x11/qt5
a47 2
MULTI_PACKAGES =	-text -main

d63 6
a68 2
BUILD_DEPENDS =		devel/xdg-utils \
			devel/desktop-file-utils
d92 1
a92 1
			-DSSE4_2_FLAG=""
@


1.25
log
@update to wireshark-1.12.8
@
text
@d3 3
d11 1
a11 1
WVER =		1.12.8
d18 3
a20 4
SHARED_LIBS +=	wsutil               1.1      # 5.0
SHARED_LIBS +=	wiretap              1.0      # 4.5
SHARED_LIBS +=	filetap              0.0      # 0.5
SHARED_LIBS +=	wireshark            1.2      # 5.5
d34 2
d39 1
a39 1
MODULES =	lang/lua lang/python
d44 1
a44 1
WANTLIB +=	c glib-2.0 m pcap pthread z
d46 2
a47 2
WANTLIB-text +=	${WANTLIB} ${MODLUA_WANTLIB} GeoIP cares gcrypt gmodule-2.0
WANTLIB-text +=	gnutls gpg-error smi
d49 6
a54 6
WANTLIB-main +=	${WANTLIB} wireshark wiretap wsutil
WANTLIB-main +=	cairo gdk_pixbuf-2.0 gmodule-2.0 gobject-2.0
WANTLIB-main +=	pango-1.0 pangocairo-1.0 portaudio
WANTLIB-main +=	gdk-3 gtk-3

MULTI_PACKAGES =	-text -main
d69 1
a69 2
LIB_DEPENDS-text =	${LIB_DEPENDS} \
			${MODLUA_LIB_DEPENDS} \
d77 1
a77 2
LIB_DEPENDS-main =	${LIB_DEPENDS} \
			tshark-${WVER}:${BUILD_PKGPATH:S/,$//},-text \
d81 6
a86 1
LIBTOOL_FLAGS +=	--tag=disable-static
d88 1
a88 10
CONFIGURE_STYLE =	gnu
SEPARATE_BUILD =	Yes

CONFIGURE_ARGS =	${CONFIGURE_SHARED} \
			--with-dumpcap-group=_wireshark \
			--enable-setuid-install \
			--with-gtk3=yes \
			--with-ssl

CONFIGURE_ENV =	CPPFLAGS="-DGDK_VERSION_MIN_REQUIRED=GDK_VERSION_3_0 -I${LOCALBASE}/include/lua-${MODLUA_VERSION}"
a93 4
NO_TEST =	Yes

INSTALL_TARGET = install install_desktop_files

d95 11
a105 2
	@@find ${PREFIX}/lib/wireshark -name '*.la' -print0 | xargs -r0 rm
	-mv ${WRKINST}/usr/share/{applications,icons,mime} ${PREFIX}/share/
@


1.24
log
@mark as broken on sparc64, fails with
cc: Internal error: Illegal instruction (program cc1)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2015/09/12 16:00:35 tobiasu Exp $
d8 1
a8 1
WVER =		1.12.7
a34 1
REVISION =	1
d40 1
a40 1
WANTLIB +=	c glib-2.0 m pcap pthread z ${MODLUA_WANTLIB}
d42 1
a42 1
WANTLIB-text +=	${WANTLIB} GeoIP cares gcrypt gmodule-2.0
@


1.23
log
@Fix GDK related segfault on startup.

See also https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=195980#c45

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2015/08/21 19:17:10 sthen Exp $
d4 1
a4 1

@


1.22
log
@sync WANTLIB
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2015/08/12 20:59:53 sthen Exp $
d35 1
a35 1
REVISION =	0
@


1.21
log
@security update to wireshark-1.12.7, fixes some crashes and infinite loops
in dissectors
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2015/06/22 20:33:11 sthen Exp $
d35 1
d41 1
a41 1
WANTLIB +=	c glib-2.0 m pcap pthread z
d43 1
a43 1
WANTLIB-text +=	${WANTLIB} ${MODLUA_WANTLIB} GeoIP cares gcrypt gmodule-2.0
@


1.20
log
@update to wireshark-1.12.6, various fixes including a few crashes
https://www.wireshark.org/docs/relnotes/wireshark-1.12.6.html#_what_8217_s_new
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2015/05/13 08:36:36 sthen Exp $
d8 1
a8 1
WVER =		1.12.6
@


1.20.4.1
log
@MFC security update to wireshark-1.12.7, fixes some crashes and infinite loops
in dissectors
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2015/08/21 19:17:10 sthen Exp $
d8 1
a8 1
WVER =		1.12.7
a34 1
REVISION =	0
d40 1
a40 1
WANTLIB +=	c glib-2.0 m pcap pthread z ${MODLUA_WANTLIB}
d42 1
a42 1
WANTLIB-text +=	${WANTLIB} GeoIP cares gcrypt gmodule-2.0
@


1.19
log
@update to wireshark-1.12.5, various crash/infinite loop/memleak fixes
https://www.wireshark.org/docs/relnotes/wireshark-1.12.5.html
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2015/03/27 08:13:04 ajacoutot Exp $
d8 1
a8 1
WVER =		1.12.5
@


1.18
log
@x11/gtk+2,-guic -> x11/gtk+3,-guic && bump
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.17 2015/03/14 21:46:46 sthen Exp $
a6 1
BROKEN-alpha =	.got subsegment exceeds 64K (size 101480)
d8 1
a8 1
WVER =		1.12.4
a13 2
REVISION-main =	0
REVISION-text =	0
d15 4
a18 4
SHARED_LIBS +=	wsutil               1.0      # 5.0
SHARED_LIBS +=	wiretap              1.0      # 4.4
SHARED_LIBS +=	filetap              0.0      # 0.4
SHARED_LIBS +=	wireshark            1.1      # 5.4
@


1.17
log
@update to wireshark-1.12.4

Various fixes and improvements, including possible crashes/infinite loops
in the following dissectors: ATN-CPDLC (crash), WCP (crash), LLDP (crash),
TNEF (loop), SCSI OSD (loop), and a possible crash in pcapng file parsing.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2015/02/14 00:14:31 sthen Exp $
d13 2
d64 1
a64 1
			x11/gtk+2,-guic
@


1.16
log
@Add a missing net/bpf.h inclusion, activating code that handles the conflicting
DLT_* values on various OS. Specifically, fixes things so DLT_LOOP packets are
handled by the correct dissector and displayed as IP rather than raw packets.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2015/02/13 22:29:09 sthen Exp $
d7 1
a7 2
WVER =		1.12.3
REVISION-text =	0
d14 4
a17 4
SHARED_LIBS +=	wsutil               1.0      # 4.0
SHARED_LIBS +=	wiretap              1.0      # 4.1
SHARED_LIBS +=	filetap              0.0      # 0.1
SHARED_LIBS +=	wireshark            1.0      # 5.1
@


1.16.2.1
log
@MFC update to wireshark-1.12.5, various crash/infinite loop/memleak fixes
https://www.wireshark.org/docs/relnotes/wireshark-1.12.5.html
@
text
@d1 1
a1 3
# $OpenBSD: Makefile,v 1.19 2015/05/13 08:36:36 sthen Exp $

BROKEN-alpha =	.got subsegment exceeds 64K (size 101480)
d5 1
d7 2
a8 1
WVER =		1.12.5
d15 4
a18 4
SHARED_LIBS +=	wsutil               1.1      # 5.0
SHARED_LIBS +=	wiretap              1.0      # 4.5
SHARED_LIBS +=	filetap              0.0      # 0.5
SHARED_LIBS +=	wireshark            1.2      # 5.5
d63 1
a63 1
			x11/gtk+3,-guic
@


1.16.2.2
log
@unbreak; there's no gtk+3,-guic on 5.7
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16.2.1 2015/05/13 08:37:30 sthen Exp $
d63 1
a63 1
			x11/gtk+2,-guic
@


1.16.2.3
log
@MFC security update to wireshark-1.12.7, fixes some crashes and infinite loops
in dissectors
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2015/08/12 20:59:53 sthen Exp $
d8 1
a8 1
WVER =		1.12.7
@


1.15
log
@update to wireshark 1.12.3
take maintainer so i notice updates in portscout
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2014/12/29 10:38:57 sthen Exp $
d8 1
@


1.14
log
@somewhere along the line, the pkg-readme telling people how to run wireshark
got eaten by update-plist.. readd it.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2014/10/17 23:29:46 sthen Exp $
d7 1
a7 2
WVER =		1.12.1
REVISION-main =	0
d31 2
d101 1
a101 1
	mv ${WRKINST}/usr/share/{applications,icons,mime} ${PREFIX}/share
@


1.13
log
@major version update to wireshark-1.12.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2014/10/17 22:42:23 sthen Exp $
d8 1
@


1.12
log
@security update to wireshark-1.10.10
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2014/09/17 21:57:08 sthen Exp $
d7 1
a7 1
WVER =		1.10.10
d14 4
a17 3
SHARED_LIBS +=  wsutil               0.0      # 1.0
SHARED_LIBS +=  wiretap              0.0      # 1.0
SHARED_LIBS +=  wireshark            0.0      # 1.0
d32 1
a32 1
MODULES =	lang/lua
d35 1
@


1.11
log
@set PORTROACH to exclude devel versions, currently a noop as there's a newer stable
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2014/09/01 16:36:04 pascal Exp $
d7 1
a7 1
WVER =		1.10.9
@


1.10
log
@Use -Wl,--relax to unbreak on powerpc.

ok landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2014/09/01 09:28:41 landry Exp $
d8 1
@


1.9
log
@BROKEN-powerpc for relocation overflows
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2014/08/19 05:35:58 landry Exp $
a4 1
BROKEN-powerpc =	relocation overflows
d85 4
@


1.8
log
@BROKEN-alpha = .got subsegment exceeds 64K (size 101480)

while here, remove comment about patch that got removed..
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2014/08/10 19:23:00 sthen Exp $
d5 1
@


1.7
log
@SECURITY update to wireshark 1.10.9: dissector crashes, buffer underruns.

patch-Makefile_in is now empty but cannot be removed until trees are
fully unlocked. Noted in an XXX comment in Makefile.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2014/07/21 22:19:06 sthen Exp $
d5 1
a5 2

# XXX "cvs rm -f patches/patch-Makefile_in" when trees are fully unlocked
@


1.6
log
@bdep on desktop-file-utils, ok landry
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2014/07/18 21:31:53 sthen Exp $
d6 3
a8 2
WVER =		1.10.8
REVISION =	2
@


1.6.2.1
log
@MFC security update to wireshark 1.10.10
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2014/10/17 22:42:23 sthen Exp $
a4 1
BROKEN-alpha =	.got subsegment exceeds 64K (size 101480)
d6 2
a7 2
WVER =		1.10.10
PORTROACH =	limitw:1,even
a84 4

.if ${MACHINE_ARCH:Mpowerpc}
CONFIGURE_ENV += LDFLAGS="-Wl,--relax"
.endif
@


1.5
log
@xdg-open only needed for the gui
line up some tabs
lua is a lib dep not a run dep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2014/07/18 20:21:07 ajacoutot Exp $
d51 2
a52 1
BUILD_DEPENDS =		devel/xdg-utils
@


1.4
log
@Unfuck RUN_DEPENDS-main.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2014/07/18 19:56:53 sthen Exp $
d7 1
a7 1
REVISION-main =	1
d29 1
a29 1
MODLUA_VERSION =	5.2
d32 1
d46 2
a47 2
MASTER_SITES =	http://www.wireshark.org/download/src/all-versions/ \
		http://www.wireshark.org/download/automated/src/
d49 1
a49 1
SUBST_VARS =	WVER
a51 2
RUN_DEPENDS =		devel/xdg-utils

d54 1
d59 7
a65 7
		${MODLUA_LIB_DEPENDS} \
		devel/glib2 \
		net/libcares \
		net/libsmi \
		net/GeoIP  \
		security/gnutls \
		security/libgcrypt
d68 3
a70 3
		tshark-${WVER}:${BUILD_PKGPATH:S/,$//},-text \
		x11/gtk+3 \
		audio/portaudio-svn
d78 4
a81 4
		--with-dumpcap-group=_wireshark \
		--enable-setuid-install \
		--with-gtk3=yes \
		--with-ssl
d87 1
a87 1
INSTALL_TARGET =	install install_desktop_files
@


1.3
log
@install wireshark desktop/icon files, from Fabian Raetz (patch fed upstream)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2014/07/14 08:54:29 landry Exp $
d7 1
a7 1
REVISION-main =	0
d50 5
a54 3
BUILD_DEPENDS +=	devel/xdg-utils
RUN_DEPENDS +=		devel/xdg-utils
RUN_DEPENDS-main +=	devel/desktop-file-utils \
a56 1
LIB_DEPENDS =
@


1.2
log
@add devel/xdg-utils to BDEP/RDEP so that wireshark defaults to xdg-open
to open web pages instead of 'mozilla'. Just imported so no bump.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2014/07/14 08:44:51 landry Exp $
d7 1
d52 3
d86 2
d90 1
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d49 2
@


1.1.1.1
log
@Import wireshark 1.10.8, mostly from nigel@@
Has been in -wip for years, tested by lots of ppl there.

Wireshark is a network capture tool and protocol analyzer, including
decoders for very many common and less-common protocols.

Packet dissectors (here in Wireshark, and in other programs such as tcpdump)
have a long history of security problems (but so do other programs in the
portstree..). In wireshark, these are isolated from the packet capture
code (which must have root privileges) by using a separate program,
dumpcap, to run the capture. It is installed setuid root, with
read/execute access granted only to users in the _wireshark group.

Wireshark itself doesn't need privileges if you only plan to analyse
traces produced by tcpdump.

DO NOT RUN WIRESHARK AS ROOT.

ok zhuk@@, README/tweaks from sthen@@
@
text
@@
