head	1.2;
access;
symbols
	OPENBSD_6_2:1.2.0.2
	OPENBSD_6_2_BASE:1.2;
locks; strict;
comment	@# @;


1.2
date	2017.08.30.12.42.34;	author sthen;	state Exp;
branches;
next	1.1;
commitid	K6jhnW3Ft5BDcEsv;

1.1
date	2017.08.22.22.39.38;	author sthen;	state Exp;
branches;
next	;
commitid	O3FaAB16qFweEWxH;


desc
@@


1.2
log
@update wireshark to 2.4.1, getting -current onto the new branch before 6.2
to simplify future updates. follow upstream's default of not building -gtk.
@
text
@$OpenBSD: patch-CMakeLists_txt,v 1.1 2017/08/22 22:39:38 sthen Exp $

Avoid the broken libwsutil.so that gets generated with -pie -shared
(probably following tools/clang/lib/Driver/Tools.cpp r1.13 "push back
-pie to the linker if -pie is specified").

Index: CMakeLists.txt
--- CMakeLists.txt.orig
+++ CMakeLists.txt
@@@@ -706,11 +706,11 @@@@ set(WIRESHARK_LD_FLAGS
 # XXX - are there other compilers that don't support -pie?  It's
 # not as if the only platforms we support are Windows and Linux....
 #
-if(NOT CMAKE_VERSION VERSION_LESS "2.8.9")
-	set(WIRESHARK_LD_FLAGS ${WIRESHARK_LD_FLAGS}
-		-pie
-	)
-endif()
+#if(NOT CMAKE_VERSION VERSION_LESS "2.8.9")
+#	set(WIRESHARK_LD_FLAGS ${WIRESHARK_LD_FLAGS}
+#		-pie
+#	)
+#endif()
 
 include(CheckCLinkerFlag)
 set(_C 0)
@


1.1
log
@Patch CMakeLists to avoid using -pie in the build; it's now pushed back
to the linker on LLVM arches (tools/clang/lib/Driver/Tools.cpp r1.13),
and the combination of -pie -shared there was resulting in libwsutil.so
being mis-linked causing build to fail later.

Drop useless USE_GMAKE while there.
@
text
@d1 1
a1 1
$OpenBSD$
d10 1
a10 1
@@@@ -612,11 +612,11 @@@@ set(WIRESHARK_LD_FLAGS
@

