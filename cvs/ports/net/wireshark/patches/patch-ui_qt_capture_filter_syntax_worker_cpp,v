head	1.2;
access;
symbols
	OPENBSD_6_0:1.2.0.2
	OPENBSD_6_0_BASE:1.2
	OPENBSD_5_9:1.1.0.2
	OPENBSD_5_9_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2016.02.27.18.01.42;	author sthen;	state Exp;
branches;
next	1.1;
commitid	Qrq4UgH6YXp0jska;

1.1
date	2015.11.19.21.33.36;	author sthen;	state Exp;
branches
	1.1.2.1;
next	;
commitid	Gzhsw2lwQs2UACtY;

1.1.2.1
date	2016.05.06.19.47.52;	author sthen;	state Exp;
branches;
next	1.1.2.2;
commitid	MKMz7xu0r9zTXGQb;

1.1.2.2
date	2016.06.07.21.40.09;	author sthen;	state Exp;
branches;
next	;
commitid	yaNQYUA2kuhg22SZ;


desc
@@


1.2
log
@update to wireshark-2.0.2
@
text
@$OpenBSD: patch-ui_qt_capture_filter_syntax_worker_cpp,v 1.1 2015/11/19 21:33:36 sthen Exp $

cope with old libpcap

--- ui/qt/capture_filter_syntax_worker.cpp.orig	Fri Feb 26 19:58:22 2016
+++ ui/qt/capture_filter_syntax_worker.cpp	Sat Feb 27 17:29:02 2016
@@@@ -85,11 +85,14 @@@@ void CaptureFilterSyntaxWorker::start() {
 
             device = g_array_index(global_capture_opts.all_ifaces, interface_t, if_idx);
             if (!device.locked && device.selected) {
+#ifdef DLT_USER0
                 if (device.active_dlt >= DLT_USER0 && device.active_dlt <= DLT_USER15) {
                     // Capture filter for DLT_USER is unknown
                     state = SyntaxLineEdit::Deprecated;
                     err_str = "Unable to check capture filter";
-                } else {
+                } else
+#endif
+		{
                     active_dlts.insert(device.active_dlt);
                 }
             }
@@@@ -101,7 +104,7 @@@@ void CaptureFilterSyntaxWorker::start() {
 #ifdef PCAP_NETMASK_UNKNOWN
             pc_err = pcap_compile(pd, &fcode, filter.toUtf8().constData(), 1 /* Do optimize */, PCAP_NETMASK_UNKNOWN);
 #else
-            pc_err = pcap_compile(pd, &fcode, filter.toUtf8().constData(), 1 /* Do optimize */, 0);
+            pc_err = pcap_compile(pd, &fcode, (char *)filter.toUtf8().constData(), 1 /* Do optimize */, 0);
 #endif
 
 #if DEBUG_SLEEP_TIME > 0
@


1.1
log
@update to Wireshark 2.0.0

The new Qt user interface segfaults at startup on OpenBSD, so currently
only the Gtk+ user interface is packaged.
@
text
@d1 1
a1 1
$OpenBSD$
d5 19
a23 3
--- ui/qt/capture_filter_syntax_worker.cpp.orig	Wed Oct 14 16:40:08 2015
+++ ui/qt/capture_filter_syntax_worker.cpp	Wed Oct 14 16:41:47 2015
@@@@ -92,7 +92,7 @@@@ void CaptureFilterSyntaxWorker::start() {
d31 1
a31 1
             if (pc_err) {
@


1.1.2.1
log
@MFC update to wireshark-2.0.3, dissector crashes etc as usual
@
text
@d1 1
a1 1
$OpenBSD: patch-ui_qt_capture_filter_syntax_worker_cpp,v 1.2 2016/02/27 18:01:42 sthen Exp $
d5 3
a7 19
--- ui/qt/capture_filter_syntax_worker.cpp.orig	Fri Feb 26 19:58:22 2016
+++ ui/qt/capture_filter_syntax_worker.cpp	Sat Feb 27 17:29:02 2016
@@@@ -85,11 +85,14 @@@@ void CaptureFilterSyntaxWorker::start() {
 
             device = g_array_index(global_capture_opts.all_ifaces, interface_t, if_idx);
             if (!device.locked && device.selected) {
+#ifdef DLT_USER0
                 if (device.active_dlt >= DLT_USER0 && device.active_dlt <= DLT_USER15) {
                     // Capture filter for DLT_USER is unknown
                     state = SyntaxLineEdit::Deprecated;
                     err_str = "Unable to check capture filter";
-                } else {
+                } else
+#endif
+		{
                     active_dlts.insert(device.active_dlt);
                 }
             }
@@@@ -101,7 +104,7 @@@@ void CaptureFilterSyntaxWorker::start() {
d15 1
a15 1
 #if DEBUG_SLEEP_TIME > 0
@


1.1.2.2
log
@MFC update to wireshark-2.0.4.

infinite loop and lots of crash fixes in dissectors, plus various other
issues.
@
text
@@


