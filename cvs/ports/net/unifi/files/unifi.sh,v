head	1.3;
access;
symbols
	OPENBSD_6_2:1.3.0.12
	OPENBSD_6_2_BASE:1.3
	OPENBSD_6_1:1.3.0.10
	OPENBSD_6_1_BASE:1.3
	OPENBSD_6_0:1.3.0.8
	OPENBSD_6_0_BASE:1.3
	OPENBSD_5_9:1.3.0.4
	OPENBSD_5_9_BASE:1.3
	OPENBSD_5_8:1.3.0.6
	OPENBSD_5_8_BASE:1.3
	OPENBSD_5_7:1.3.0.2
	OPENBSD_5_7_BASE:1.3;
locks; strict;
comment	@# @;


1.3
date	2014.11.29.01.42.02;	author sthen;	state Exp;
branches;
next	1.2;
commitid	3NRXUmF77fiq1pVE;

1.2
date	2014.11.29.01.07.32;	author sthen;	state Exp;
branches;
next	1.1;
commitid	wgo1K7VEMCMKeJhL;

1.1
date	2014.11.29.00.26.58;	author sthen;	state Exp;
branches;
next	;
commitid	sGD5GxNd829U9vII;


desc
@@


1.3
log
@update to unifi-3.2.7 and tweak the wrapper script
@
text
@#!/bin/sh
# $OpenBSD: unifi.sh,v 1.2 2014/11/29 01:07:32 sthen Exp $

# Optionally symlink to things like unifi-discover
cmd=${0##*unifi-}
[ "$cmd" = "$0" ] && cmd=
name=${0##*/}

if [ "$cmd" = "" -o "$cmd" = "discover" -o "$cmd" = "info" ]; then
	defines="$defines -Dlog4j.configuration=/dev/null"
fi 
 
daemon="${TRUEPREFIX}/share/unifi/lib/ace.jar"
java="$(${LOCALBASE}/bin/javaPathHelper -c unifi)"
 
# with some filehandle trickery to do substition on stderr
# 3>&1 - fh3 -> fh1 (stdout)
# 1>&2 - fh1 -> fh2 (stderr)
# 2>&3 - fh2 -> fh3 (stdout)
# 3>&- - fh3 -> close
(${java} ${defines} -jar ${daemon} $cmd "$@@" 3>&1 1>&2 2>&3 |
	sed -e "s,java -jar lib/ace.jar,$name,") 3>&1 1>&2 2>&3 3>&-
@


1.2
log
@add a little shell trickery from afresh1 to fixup the command name displayed
in usage text
@
text
@d2 1
a2 1
# $OpenBSD$
d8 4
d21 1
a21 1
(${java} -jar ${daemon} $cmd "$@@" 3>&1 1>&2 2>&3 |
@


1.1
log
@add a wrapper script (from afresh1@@) to unifi to allow easy running of
cli commands and the unifi-discover tool
@
text
@d7 1
d12 7
a18 1
${java} -jar ${daemon} $cmd "$@@" 
@

