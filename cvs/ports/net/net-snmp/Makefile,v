head	1.95;
access;
symbols
	OPENBSD_6_1:1.94.0.2
	OPENBSD_6_1_BASE:1.94
	OPENBSD_6_0:1.91.0.2
	OPENBSD_6_0_BASE:1.91
	OPENBSD_5_9:1.86.0.2
	OPENBSD_5_9_BASE:1.86
	OPENBSD_5_8:1.80.0.4
	OPENBSD_5_8_BASE:1.80
	OPENBSD_5_7:1.79.0.2
	OPENBSD_5_7_BASE:1.79
	OPENBSD_5_6:1.78.0.2
	OPENBSD_5_6_BASE:1.78
	OPENBSD_5_5:1.74.0.4
	OPENBSD_5_5_BASE:1.74
	OPENBSD_5_4:1.74.0.2
	OPENBSD_5_4_BASE:1.74
	OPENBSD_5_3:1.69.0.2
	OPENBSD_5_3_BASE:1.69
	OPENBSD_5_2:1.66.0.2
	OPENBSD_5_2_BASE:1.66
	OPENBSD_5_1_BASE:1.62
	OPENBSD_5_1:1.62.0.2
	OPENBSD_5_0:1.58.0.2
	OPENBSD_5_0_BASE:1.58
	OPENBSD_4_9:1.51.0.2
	OPENBSD_4_9_BASE:1.51
	OPENBSD_4_8:1.45.0.2
	OPENBSD_4_8_BASE:1.45
	OPENBSD_4_7:1.42.0.2
	OPENBSD_4_7_BASE:1.42
	OPENBSD_4_6:1.38.0.4
	OPENBSD_4_6_BASE:1.38
	OPENBSD_4_5:1.38.0.2
	OPENBSD_4_5_BASE:1.38
	OPENBSD_4_4:1.30.0.2
	OPENBSD_4_4_BASE:1.30
	OPENBSD_4_3:1.25.0.2
	OPENBSD_4_3_BASE:1.25
	OPENBSD_4_2:1.22.0.2
	OPENBSD_4_2_BASE:1.22
	OPENBSD_4_1:1.19.0.2
	OPENBSD_4_1_BASE:1.19
	OPENBSD_4_0:1.17.0.2
	OPENBSD_4_0_BASE:1.17
	OPENBSD_3_9:1.15.0.2
	OPENBSD_3_9_BASE:1.15
	OPENBSD_3_8:1.10.0.2
	OPENBSD_3_8_BASE:1.10
	OPENBSD_3_7:1.7.0.2
	OPENBSD_3_7_BASE:1.7
	OPENBSD_3_6:1.3.0.2
	OPENBSD_3_6_BASE:1.3
	danh_2004-Aug-03:1.1.1.1
	danh:1.1.1;
locks; strict;
comment	@# @;


1.95
date	2017.09.29.22.49.41;	author sthen;	state Exp;
branches;
next	1.94;
commitid	zYvPR0giDBl7QbDc;

1.94
date	2016.10.12.10.50.33;	author sthen;	state Exp;
branches;
next	1.93;
commitid	osjP0qv650QwrNjz;

1.93
date	2016.10.11.20.47.43;	author sthen;	state Exp;
branches;
next	1.92;
commitid	gx6WQ2YqoodDayvF;

1.92
date	2016.08.17.20.58.19;	author sthen;	state Exp;
branches;
next	1.91;
commitid	3YTVpXXidJQjfavt;

1.91
date	2016.07.09.08.25.14;	author sthen;	state Exp;
branches;
next	1.90;
commitid	Dfg858TMuZkZ1FcS;

1.90
date	2016.07.08.16.48.21;	author sthen;	state Exp;
branches;
next	1.89;
commitid	nub6DuMueL8Y4KAR;

1.89
date	2016.05.12.22.00.14;	author sthen;	state Exp;
branches;
next	1.88;
commitid	DZ7XaOcwpmml4UK3;

1.88
date	2016.03.16.21.19.38;	author naddy;	state Exp;
branches;
next	1.87;
commitid	eS3Ayl3CL8hkKETd;

1.87
date	2016.03.11.20.28.29;	author naddy;	state Exp;
branches;
next	1.86;
commitid	UYLP8TE6V7RS2GhJ;

1.86
date	2016.01.07.12.35.53;	author sthen;	state Exp;
branches;
next	1.85;
commitid	lrGFBs6UFK8JCpsO;

1.85
date	2015.12.08.16.50.40;	author jca;	state Exp;
branches;
next	1.84;
commitid	7RkZiEW2Nhw68uSR;

1.84
date	2015.11.05.23.43.46;	author sthen;	state Exp;
branches;
next	1.83;
commitid	ioaCbmn8pvAuCVAx;

1.83
date	2015.11.05.21.44.04;	author sthen;	state Exp;
branches;
next	1.82;
commitid	4961SEW5XIrlCmNo;

1.82
date	2015.10.08.21.19.22;	author sthen;	state Exp;
branches;
next	1.81;
commitid	pVDZUjJm7yyuQSI1;

1.81
date	2015.09.11.16.33.05;	author sthen;	state Exp;
branches;
next	1.80;
commitid	43hmudVwSIu7gsxU;

1.80
date	2015.04.13.08.41.36;	author sthen;	state Exp;
branches
	1.80.4.1;
next	1.79;
commitid	5KreV1qYf3qZTBPL;

1.79
date	2014.12.09.15.20.06;	author sthen;	state Exp;
branches
	1.79.2.1;
next	1.78;
commitid	GeM80Hk0rAfPyGK0;

1.78
date	2014.06.14.10.34.45;	author sthen;	state Exp;
branches
	1.78.2.1;
next	1.77;
commitid	HiKZ10xJk2o55vyF;

1.77
date	2014.03.23.22.04.23;	author sthen;	state Exp;
branches;
next	1.76;

1.76
date	2014.03.20.12.46.15;	author sthen;	state Exp;
branches;
next	1.75;

1.75
date	2014.03.12.23.52.14;	author sthen;	state Exp;
branches;
next	1.74;

1.74
date	2013.07.03.04.15.42;	author espie;	state Exp;
branches;
next	1.73;

1.73
date	2013.06.28.22.33.19;	author sthen;	state Exp;
branches;
next	1.72;

1.72
date	2013.05.17.22.42.24;	author sthen;	state Exp;
branches;
next	1.71;

1.71
date	2013.03.21.08.46.34;	author ajacoutot;	state Exp;
branches;
next	1.70;

1.70
date	2013.03.11.11.35.49;	author espie;	state Exp;
branches;
next	1.69;

1.69
date	2012.12.11.15.30.56;	author sthen;	state Exp;
branches;
next	1.68;

1.68
date	2012.10.18.14.01.45;	author sthen;	state Exp;
branches;
next	1.67;

1.67
date	2012.08.23.15.50.05;	author sthen;	state Exp;
branches;
next	1.66;

1.66
date	2012.05.11.13.14.43;	author sthen;	state Exp;
branches
	1.66.2.1;
next	1.65;

1.65
date	2012.05.03.20.06.51;	author jasper;	state Exp;
branches;
next	1.64;

1.64
date	2012.04.11.16.31.14;	author sthen;	state Exp;
branches;
next	1.63;

1.63
date	2012.02.21.22.10.20;	author sthen;	state Exp;
branches;
next	1.62;

1.62
date	2011.11.28.22.40.25;	author sthen;	state Exp;
branches
	1.62.2.1;
next	1.61;

1.61
date	2011.11.18.12.39.06;	author sthen;	state Exp;
branches;
next	1.60;

1.60
date	2011.11.16.00.11.35;	author sthen;	state Exp;
branches;
next	1.59;

1.59
date	2011.09.16.11.13.39;	author espie;	state Exp;
branches;
next	1.58;

1.58
date	2011.07.19.21.32.38;	author sthen;	state Exp;
branches
	1.58.2.1;
next	1.57;

1.57
date	2011.07.08.11.53.28;	author sthen;	state Exp;
branches;
next	1.56;

1.56
date	2011.07.07.20.02.02;	author sthen;	state Exp;
branches;
next	1.55;

1.55
date	2011.07.06.22.02.25;	author sthen;	state Exp;
branches;
next	1.54;

1.54
date	2011.07.06.21.32.57;	author sthen;	state Exp;
branches;
next	1.53;

1.53
date	2011.05.11.12.03.19;	author jasper;	state Exp;
branches;
next	1.52;

1.52
date	2011.03.16.22.45.20;	author sthen;	state Exp;
branches;
next	1.51;

1.51
date	2011.01.15.09.38.31;	author sthen;	state Exp;
branches;
next	1.50;

1.50
date	2010.11.19.22.31.35;	author espie;	state Exp;
branches;
next	1.49;

1.49
date	2010.10.26.00.42.21;	author sthen;	state Exp;
branches;
next	1.48;

1.48
date	2010.10.25.22.59.12;	author sthen;	state Exp;
branches;
next	1.47;

1.47
date	2010.10.18.18.36.50;	author espie;	state Exp;
branches;
next	1.46;

1.46
date	2010.09.21.10.43.04;	author sthen;	state Exp;
branches;
next	1.45;

1.45
date	2010.07.12.22.07.39;	author sthen;	state Exp;
branches;
next	1.44;

1.44
date	2010.05.22.09.50.06;	author jasper;	state Exp;
branches;
next	1.43;

1.43
date	2010.05.19.15.50.00;	author sthen;	state Exp;
branches;
next	1.42;

1.42
date	2010.02.09.12.23.59;	author jasper;	state Exp;
branches;
next	1.41;

1.41
date	2009.11.22.15.36.33;	author jasper;	state Exp;
branches;
next	1.40;

1.40
date	2009.08.17.14.58.45;	author giovanni;	state Exp;
branches;
next	1.39;

1.39
date	2009.08.16.13.35.25;	author rui;	state Exp;
branches;
next	1.38;

1.38
date	2009.02.13.09.39.38;	author jasper;	state Exp;
branches;
next	1.37;

1.37
date	2008.12.22.10.43.59;	author sthen;	state Exp;
branches;
next	1.36;

1.36
date	2008.11.07.13.56.56;	author bernd;	state Exp;
branches;
next	1.35;

1.35
date	2008.11.07.09.48.40;	author sthen;	state Exp;
branches;
next	1.34;

1.34
date	2008.10.12.08.21.21;	author brad;	state Exp;
branches;
next	1.33;

1.33
date	2008.10.07.14.57.21;	author sthen;	state Exp;
branches;
next	1.32;

1.32
date	2008.09.22.18.46.36;	author sthen;	state Exp;
branches;
next	1.31;

1.31
date	2008.09.20.22.15.51;	author rui;	state Exp;
branches;
next	1.30;

1.30
date	2008.07.03.08.07.56;	author sthen;	state Exp;
branches;
next	1.29;

1.29
date	2008.06.14.07.48.23;	author sthen;	state Exp;
branches;
next	1.28;

1.28
date	2008.06.10.18.00.35;	author sthen;	state Exp;
branches;
next	1.27;

1.27
date	2008.06.09.21.28.56;	author sturm;	state Exp;
branches;
next	1.26;

1.26
date	2008.06.05.15.52.21;	author okan;	state Exp;
branches;
next	1.25;

1.25
date	2008.02.28.18.26.28;	author okan;	state Exp;
branches;
next	1.24;

1.24
date	2007.09.26.20.03.42;	author rui;	state Exp;
branches;
next	1.23;

1.23
date	2007.09.15.22.36.56;	author merdely;	state Exp;
branches;
next	1.22;

1.22
date	2007.06.14.18.19.24;	author ajacoutot;	state Exp;
branches;
next	1.21;

1.21
date	2007.06.13.15.15.01;	author ajacoutot;	state Exp;
branches;
next	1.20;

1.20
date	2007.05.19.10.52.06;	author rui;	state Exp;
branches;
next	1.19;

1.19
date	2006.11.24.21.14.29;	author steven;	state Exp;
branches;
next	1.18;

1.18
date	2006.09.30.22.03.56;	author steven;	state Exp;
branches;
next	1.17;

1.17
date	2006.07.28.20.17.52;	author sturm;	state Exp;
branches
	1.17.2.1;
next	1.16;

1.16
date	2006.06.18.12.00.03;	author steven;	state Exp;
branches;
next	1.15;

1.15
date	2006.02.15.05.14.29;	author david;	state Exp;
branches;
next	1.14;

1.14
date	2006.01.03.17.37.18;	author steven;	state Exp;
branches;
next	1.13;

1.13
date	2005.11.12.00.30.48;	author bernd;	state Exp;
branches;
next	1.12;

1.12
date	2005.11.05.19.09.38;	author bernd;	state Exp;
branches;
next	1.11;

1.11
date	2005.09.09.19.07.46;	author marcm;	state Exp;
branches;
next	1.10;

1.10
date	2005.06.13.22.42.00;	author naddy;	state Exp;
branches
	1.10.2.1;
next	1.9;

1.9
date	2005.05.26.03.34.21;	author robert;	state Exp;
branches;
next	1.8;

1.8
date	2005.04.09.23.31.28;	author espie;	state Exp;
branches;
next	1.7;

1.7
date	2004.12.26.12.33.16;	author sturm;	state Exp;
branches
	1.7.2.1;
next	1.6;

1.6
date	2004.12.16.00.31.23;	author alek;	state Exp;
branches;
next	1.5;

1.5
date	2004.10.08.18.41.39;	author danh;	state Exp;
branches;
next	1.4;

1.4
date	2004.10.08.16.30.52;	author danh;	state Exp;
branches;
next	1.3;

1.3
date	2004.08.10.13.36.08;	author danh;	state Exp;
branches
	1.3.2.1;
next	1.2;

1.2
date	2004.08.09.15.04.17;	author danh;	state Exp;
branches;
next	1.1;

1.1
date	2004.08.03.17.47.12;	author danh;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2004.08.03.17.47.12;	author danh;	state Exp;
branches;
next	;

1.3.2.1
date	2005.05.26.04.03.08;	author robert;	state Exp;
branches;
next	;

1.7.2.1
date	2005.05.26.04.01.56;	author robert;	state Exp;
branches;
next	1.7.2.2;

1.7.2.2
date	2005.11.07.21.09.03;	author sturm;	state Exp;
branches;
next	1.7.2.3;

1.7.2.3
date	2005.11.12.11.32.01;	author sturm;	state Exp;
branches;
next	;

1.10.2.1
date	2005.11.07.21.15.27;	author sturm;	state Exp;
branches;
next	1.10.2.2;

1.10.2.2
date	2005.11.12.11.31.00;	author sturm;	state Exp;
branches;
next	;

1.17.2.1
date	2006.11.05.19.47.37;	author sturm;	state Exp;
branches;
next	;

1.58.2.1
date	2011.11.29.08.57.07;	author sthen;	state Exp;
branches;
next	;

1.62.2.1
date	2012.04.11.15.15.04;	author sthen;	state Exp;
branches;
next	1.62.2.2;

1.62.2.2
date	2012.05.03.20.08.44;	author jasper;	state Exp;
branches;
next	;

1.66.2.1
date	2012.12.11.15.33.55;	author sthen;	state Exp;
branches;
next	;

1.78.2.1
date	2015.04.13.08.43.51;	author sthen;	state Exp;
branches;
next	1.78.2.2;
commitid	HyPd4EIcqbyww9v8;

1.78.2.2
date	2015.04.13.08.49.54;	author sthen;	state Exp;
branches;
next	;
commitid	BDlW8eHElUpjWjDD;

1.79.2.1
date	2015.04.13.08.42.37;	author sthen;	state Exp;
branches;
next	;
commitid	Bqb6k8iyo1B29p8x;

1.80.4.1
date	2015.11.05.21.44.56;	author sthen;	state Exp;
branches;
next	;
commitid	VwB3MWdlkYeEJNOr;


desc
@@


1.95
log
@Fix a crash in libnetsnmp client, occurring in some circumstances where
a local IP address is set. Cause is a use-after-free, OpenBSD's malloc
helpfully often picks these up early (with relatively low impact on
performance), often turning what would be a hidden bug into a likely
crash.

Reported and analysis from Andrea Biscuola of Zabbix,
https://support.zabbix.com/browse/ZBX-12726
https://sourceforge.net/p/net-snmp/bugs/2803/

Diff from me. I was going to wait for confirmation from Andrea that it
fixes the issue, but having read more of the code I'm confident that this
change or something like it is needed, so committing now to make it pre 6.2.
ok naddy
@
text
@# $OpenBSD: Makefile,v 1.94 2016/10/12 10:50:33 sthen Exp $

COMMENT-main=	extendable SNMP implementation
COMMENT-tkmib=	graphical SNMP MIB browser

V=		5.7.3
REVISION-main=	12

DISTNAME=	net-snmp-$V
MULTI_PACKAGES=	-main -tkmib
PKGNAME-main=	net-snmp-$V
PKGNAME-tkmib=	net-snmp-tkmib-$V

LIBV=		14.0
.for i in netsnmp netsnmpagent netsnmphelpers netsnmpmibs netsnmptrapd
SHARED_LIBS +=	$i ${LIBV}
.endfor

CATEGORIES=	net perl5
MASTER_SITES=	${MASTER_SITE_SOURCEFORGE:=net-snmp/}

HOMEPAGE=	http://www.net-snmp.org/

MAINTAINER=	Stuart Henderson <sthen@@openbsd.org>

# BSD
PERMIT_PACKAGE_CDROM=	Yes

WANTLIB-main=		c crypto kvm m perl pthread

RUN_DEPENDS-tkmib=	net/net-snmp \
			x11/p5-Tk

NET_SNMP_MIB_LIST=	smux mibII/mta_sendmail

# set the default mib search list:
# - net-snmp default mibs (include/net-snmp/net-snmp-config.h.in)
# - this is checked in pre-configure as we don't want it to get out of sync
DEFAULT_MIBS=		IP-MIB:IF-MIB:TCP-MIB:UDP-MIB:SNMPv2-MIB:RFC1213-MIB
# - base OpenBSD mibs (/usr/share/snmp/mibs), SNMPD-CONF pulls in the rest
OPENBSD_MIBS=		OPENBSD-SNMPD-CONF


CONFIGURE_STYLE=  autoconf
AUTOCONF_VERSION= 2.68
CONFIGURE_ARGS=   --enable-ipv6 \
	--enable-mfd-rewrites \
	--with-copy-persistent-files="no" \
	--with-mib-modules="${NET_SNMP_MIB_LIST}" \
	--with-mibs="${DEFAULT_MIBS}:${OPENBSD_MIBS}" \
	--with-mibdirs="\$$HOME/.snmp/mibs:/usr/share/snmp/mibs:${TRUEPREFIX}/share/snmp/mibs" \
	--with-default-snmp-version="3" \
	--with-sys-contact="nobody@@nowhere.invalid" \
	--with-sys-location="somewhere" \
	--with-temp-file-pattern=/tmp/snmpdXXXXXXXXXXXX \
	--with-logfile="/var/log/snmpd" \
	--with-persistent-directory="/var/net-snmp"
CONFIGURE_ENV=	ac_cv_IFNET_NEEDS_KERNEL=no
TEST_TARGET=	test

pre-configure:
	@@if ! grep '^#define NETSNMP_DEFAULT_MIBS "${DEFAULT_MIBS}"$$' \
	    ${WRKSRC}/include/net-snmp/net-snmp-config.h.in > /dev/null; then \
	    echo 'DEFAULT_MIBS in the port Makefile is out of sync'; exit 1; fi
	@@perl -pi -e 's,(snmpd\(8\)|snmpd\.conf\(5\)),netsnmp-\1,' ${WRKSRC}/man/*
	rm ${WRKSRC}/include/net-snmp/system/openbsd[0-9].h

post-install:
	@@perl -pi -e 's,^(#define[ ]PACKAGE_.*)$$,/* $$1 */,' \
	    ${PREFIX}/include/net-snmp/net-snmp-config.h
	@@touch ${PREFIX}/share/snmp/mibs/.index
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/net-snmp
	${INSTALL_DATA} ${WRKSRC}/README ${PREFIX}/share/doc/net-snmp
	${INSTALL_DATA} ${WRKSRC}/README.snmpv3 ${PREFIX}/share/doc/net-snmp
	${INSTALL_DATA} ${WRKSRC}/FAQ ${PREFIX}/share/doc/net-snmp
	${INSTALL_DATA} ${WRKSRC}/AGENT.txt ${PREFIX}/share/doc/net-snmp
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/net-snmp
	${INSTALL_DATA} ${WRKBUILD}/EXAMPLE.conf \
	    ${PREFIX}/share/examples/net-snmp
.for i j in man5 snmpd.conf.5 man8 snmpd.8
	mv ${PREFIX}/man/$i/$j ${PREFIX}/man/$i/netsnmp-$j
.endfor

.include <bsd.port.mk>
@


1.94
log
@add patches to net-snmp, from upstream via afresh1, that will be needed for perl 5.24+
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.93 2016/10/11 20:47:43 sthen Exp $
d7 1
a7 1
REVISION-main=	11
@


1.93
log
@Use the -r flag in net-snmp's rc.d script, as figured out by
Theodore Wynnychenko. This tells it not to exit when it can't open
/dev/kmem etc. Fixes startup now that this access is disabled by
default in OpenBSD.

Some MIBs won't work, but in general these should be rewritten
to use sysctl interfaces.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.92 2016/08/17 20:58:19 sthen Exp $
d7 1
a7 1
REVISION-main=	10
@


1.92
log
@bump ports that might pick up IP_SENDSRCADDR
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.91 2016/07/09 08:25:14 sthen Exp $
d7 1
a7 1
REVISION-main=	9
@


1.91
log
@missed bump, spotted by naddy
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.90 2016/07/08 16:48:21 sthen Exp $
d7 1
a7 1
REVISION-main=	8
@


1.90
log
@sync WANTLIB
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.89 2016/05/12 22:00:14 sthen Exp $
d7 1
a7 1
REVISION-main=	7
@


1.89
log
@untangle net-snmp to stop using openbsd{4,5}.h etc.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.88 2016/03/16 21:19:38 naddy Exp $
d29 1
a29 1
WANTLIB-main=		c crypto kvm m perl util
@


1.88
log
@remove SHARED_ONLY from ports that use only the gnu module
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.87 2016/03/11 20:28:29 naddy Exp $
d7 1
a7 1
REVISION-main=	6
d66 1
@


1.87
log
@garbage collect CONFIGURE_SHARED
@
text
@d1 1
a1 3
# $OpenBSD: Makefile,v 1.86 2016/01/07 12:35:53 sthen Exp $

SHARED_ONLY=	Yes
@


1.86
log
@Set pexp="${daemon}.*" for net-snmp; avoids a long delay at boot if the
user has set a command-line arguments containing '+' (not totally uncommon).
Otherwise rc_check() now waits for pexp to match, which fails due to
the + being handled as part of a regular expression.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.85 2015/12/08 16:50:40 jca Exp $
d48 1
a48 2
CONFIGURE_ARGS=   ${CONFIGURE_SHARED} \
	--enable-ipv6 \
@


1.85
log
@Unbreak: stop using if_var.h/struct ifnet to retrieve ipv6 data.

"looks fine to me" jasper@@, ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.84 2015/11/05 23:43:46 sthen Exp $
d9 1
a9 1
REVISION-main=	5
@


1.84
log
@Run net-snmp as _netsnmp instead of root, doing this currently requires
disabling the ipv6 mib - this is done in the rc script so it can be
overridden with netsnmpd_flags if required (but just run snmpd from base,
really ....)

Reported by Pierre Kim.

Drop unnecessary patch while there, the problem it was meant to fix was
already fixed in 5.7.3.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.83 2015/11/05 21:44:04 sthen Exp $
d9 1
a9 1
REVISION-main=	4
d61 1
@


1.83
log
@install net-snmp's sample snmpd.conf with mode 600, it may contain secrets.
reported by Pierre Kim.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.82 2015/10/08 21:19:22 sthen Exp $
d9 1
a9 1
REVISION-main=	3
@


1.82
log
@Bump some ports which reference if_msghdr in their source, so that package
updates are triggered. This is following the struct if_data ABI change a few
days ago; if_msghdr has an embedded if_data.  Some may be unnecessary, but
some are definitely needed and bumps are cheaper than debugging.
Problem reported with wpa_supplicant by Mikolaj Kucharski.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.81 2015/09/11 16:33:05 sthen Exp $
d9 1
a9 1
REVISION-main=	2
@


1.81
log
@handle ifmedia64

interface_openbsd.c seems unused but patch there as well anyway in case
anything else uses it later..
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.80 2015/04/13 08:41:36 sthen Exp $
d9 1
a9 1
REVISION-main=	1
@


1.80
log
@SECURITY fix, use calloc instead of malloc to zero the netsnmp_variable_list
struct, to avoid issues when processing malicious PDUs.

Reported by Qinghao Tang on oss-sec.
http://www.openwall.com/lists/oss-security/2015/04/13/1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.79 2014/12/09 15:20:06 sthen Exp $
d9 1
a9 1
REVISION-main=	0
@


1.80.4.1
log
@install net-snmp's sample snmpd.conf with mode 600, it may contain secrets.
reported by Pierre Kim.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.80 2015/04/13 08:41:36 sthen Exp $
d9 1
a9 1
REVISION-main=	1
@


1.79
log
@update to Net-SNMP 5.7.3

- roll -perl subpackage into -main, this greatly simplifies PLIST handling
for package updates. bumps to dependent ports to follow after this commit.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.78 2014/06/14 10:34:45 sthen Exp $
d9 1
@


1.79.2.1
log
@SECURITY fix, use calloc instead of malloc to zero the netsnmp_variable_list
struct, to avoid issues when processing malicious PDUs.

Reported by Qinghao Tang on oss-sec.
http://www.openwall.com/lists/oss-security/2015/04/13/1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.80 2015/04/13 08:41:36 sthen Exp $
a8 1
REVISION-main=	0
@


1.78
log
@@@comment zero-byte perl .bs files in all packages which don't have p5-* PKGNAMEs
and bump
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.77 2014/03/23 22:04:23 sthen Exp $
a5 1
COMMENT-perl=	SNMP modules for Perl
d8 1
a8 2
V=		5.7.2.1
REVISION=	2
d10 2
a11 2
DISTNAME=	net-snmp-${V:S/pre/.pre/:S/rc/.rc/}
MULTI_PACKAGES=	-main -perl -tkmib
a12 1
PKGNAME-perl=	p5-SNMP-$V
a13 2
NOT_FOR_ARCHS-perl = ${NO_SHARED_ARCHS}
NOT_FOR_ARCHS-tkmib = ${NO_SHARED_ARCHS}
d15 1
a15 1
LIBV=		13.0
a30 3
WANTLIB-perl=		crypto m netsnmp netsnmpagent netsnmptrapd \
			netsnmpmibs perl
# depends on libperl's ABI (XS module)
d32 1
a32 2
LIB_DEPENDS-perl=	net/net-snmp,-main
RUN_DEPENDS-tkmib=	net/net-snmp,-perl \
d63 1
a63 1
	@@if ! fgrep '#define NETSNMP_DEFAULT_MIBS "${DEFAULT_MIBS}"' \
@


1.78.2.1
log
@SECURITY fix, use calloc instead of malloc to zero the netsnmp_variable_list
struct, to avoid issues when processing malicious PDUs.

Reported by Qinghao Tang on oss-sec.
http://www.openwall.com/lists/oss-security/2015/04/13/1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.78 2014/06/14 10:34:45 sthen Exp $
a7 1
REVISION-main=	3
@


1.78.2.2
log
@SECURITY fix, use calloc instead of malloc to zero the netsnmp_variable_list
struct, to avoid issues when processing malicious PDUs.

Reported by Qinghao Tang on oss-sec.
http://www.openwall.com/lists/oss-security/2015/04/13/1

Attempt #2 - I forgot 'cvs add' before, spotted by Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.78.2.1 2015/04/13 08:43:51 sthen Exp $
d8 1
a8 1
REVISION-main=	4
@


1.77
log
@disable tcp wrappers
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.76 2014/03/20 12:46:15 sthen Exp $
d8 1
a8 1
REVISION=	1
@


1.76
log
@fix pod errors
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.75 2014/03/12 23:52:14 sthen Exp $
d8 1
a8 1
REVISION-perl=	0
d33 1
a33 1
WANTLIB-main=		c crypto kvm m perl util wrap
a56 1
	--with-libwrap \
@


1.75
log
@Update to Net-SNMP 5.7.2.1 and merge PLISTs (perl is shared arch only,
so no need to split to PFRAG.shared-perl.

5.7.2.1 fixes a security issue on Linux (in ICMP-MIB), but is basically
a noop update for us.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.74 2013/07/03 04:15:42 espie Exp $
d8 1
@


1.74
log
@net-snmp now builds on vax! but the perl packages do not build at all,
not surprisingly
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.73 2013/06/28 22:33:19 sthen Exp $
d7 1
a7 3
V=		5.7.2
REVISION-main=	1
REVISION-perl=	0
@


1.73
log
@Add WANTLIB-perl+=perl to ensure this gets updated if Perl's ABI changes.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.72 2013/05/17 22:42:24 sthen Exp $
d16 2
@


1.72
log
@handle removal of swapins/swapouts from struct uvmexp in uvm_extern.h 1.105
similar to a diff from Pavel Korovin, also reported by Mark Patruck
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.71 2013/03/21 08:46:34 ajacoutot Exp $
d9 1
d33 3
a35 1
WANTLIB-perl=		crypto m netsnmp netsnmpagent netsnmptrapd netsnmpmibs
@


1.71
log
@USE_LIBTOOL=Yes is the default now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.70 2013/03/11 11:35:49 espie Exp $
d8 1
a8 1
REVISION-main=	0
@


1.70
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.69 2012/12/11 15:30:56 sthen Exp $
a46 1
USE_LIBTOOL=	Yes
@


1.69
log
@disable notification-log-mib for now; causes an 8KB/trap leak in snmptrapd
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.68 2012/10/18 14:01:45 sthen Exp $
a29 3
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
d65 1
a65 1
REGRESS_TARGET=	test
@


1.68
log
@update to Net-SNMP 5.7.2; lots of fixes and improvements

- many of our local patches are now committed upstream
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.67 2012/08/23 15:50:05 sthen Exp $
d8 1
@


1.67
log
@sync wantlib
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.66 2012/05/11 13:14:43 sthen Exp $
d7 1
a7 1
V=		5.7.1
d9 1
a9 1
DISTNAME=	net-snmp-$V
d11 1
a11 4
REVISION-main=	5
REVISION-perl=	2
REVISION-tkmib=	0
PKGNAME-main=	${DISTNAME}
d15 1
a15 1
LIBV=		12.1
d34 1
a34 1
WANTLIB-perl=		c crypto m netsnmp netsnmpagent netsnmptrapd netsnmpmibs
d64 1
@


1.66
log
@Rename snmpd(8) and snmpd.conf(5) manpages to have a netsnmp- prefix,
to avoid conflicting with manpages for base snmpd. Suggested by blambert@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.65 2012/05/03 20:06:51 jasper Exp $
d12 1
a12 1
REVISION-perl=	1
d37 1
a37 1
WANTLIB-perl=		crypto m netsnmp netsnmpagent netsnmptrapd netsnmpmibs
@


1.66.2.1
log
@MFC: disable notification-log-mib for now; causes an 8KB/trap leak in snmptrapd
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.66 2012/05/11 13:14:43 sthen Exp $
d11 1
a11 1
REVISION-main=	6
@


1.65
log
@Security fix for Security fix for CVE-2012-2141 net-snmp: Array index error,
leading to out-of heap-based buffer read (snmpd crash)

ok sthen@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.64 2012/04/11 16:31:14 sthen Exp $
d8 1
a9 1

d11 3
a14 2
REVISION-main=	4
REVISION-perl=	0
a51 1
USE_GROFF=	Yes
d75 1
d89 3
@


1.64
log
@Remove net-snmp workaround now that OPENBSD-PF-MIB is installed in the OS.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.63 2012/02/21 22:10:20 sthen Exp $
d12 1
a12 1
REVISION-main=	3
@


1.63
log
@Install OPENBSD-PF-MIB.txt in share/snmp/mibs to work around a bug with
system mibs reported by krw@@ and dhill@@ (this should be fixed in base soon
when PF-MIB support is added to snmpd).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62 2011/11/28 22:40:25 sthen Exp $
d12 1
a12 1
REVISION-main=	2
d48 2
a49 2
# - base OpenBSD mibs (/usr/share/snmp/mibs)
OPENBSD_MIBS=		OPENBSD-BASE-MIB:OPENBSD-CARP-MIB:OPENBSD-MEM-MIB:OPENBSD-SENSORS-MIB:OPENBSD-SNMPD-CONF
a87 1
	${INSTALL_DATA} ${FILESDIR}/OPENBSD-PF-MIB.txt ${PREFIX}/share/snmp/mibs
@


1.62
log
@various fixes to Net-SNMP, mostly from upstream repo, one chunk suggested
by Joel Knight to avoid a segfault
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.61 2011/11/18 12:39:06 sthen Exp $
d12 1
a12 1
REVISION-main=	0
d49 1
a49 1
OPENBSD_MIBS=		OPENBSD-BASE-MIB:OPENBSD-MEM-MIB:OPENBSD-SENSORS-MIB:OPENBSD-SNMPD-CONF
d88 1
@


1.62.2.1
log
@MFC net-snmp workaround for not having OPENBSD-PF-MIB.txt in 5.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.63 2012/02/21 22:10:20 sthen Exp $
d12 1
a12 1
REVISION-main=	2
d49 1
a49 1
OPENBSD_MIBS=		OPENBSD-BASE-MIB:OPENBSD-CARP-MIB:OPENBSD-MEM-MIB:OPENBSD-SENSORS-MIB:OPENBSD-SNMPD-CONF
a87 1
	${INSTALL_DATA} ${FILESDIR}/OPENBSD-PF-MIB.txt ${PREFIX}/share/snmp/mibs
@


1.62.2.2
log
@Security fix for Security fix for CVE-2012-2141 net-snmp: Array index error,
leading to out-of heap-based buffer read (snmpd crash)

ok sthen@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62.2.1 2012/04/11 15:15:04 sthen Exp $
d12 1
a12 1
REVISION-main=	3
@


1.61
log
@update net-snmp to 5.7.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.60 2011/11/16 00:11:35 sthen Exp $
d12 2
@


1.60
log
@bump, if.h
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59 2011/09/16 11:13:39 espie Exp $
d7 1
a7 1
V=		5.7
a8 3
REVISION-main=	2
REVISION-perl=	2
REVISION-tkmib=	1
d15 1
a15 1
LIBV=		12.0
@


1.59
log
@normalize pkgpath
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2011/07/19 21:32:38 sthen Exp $
d9 2
a10 2
REVISION-main=	1
REVISION-perl=	1
@


1.58
log
@- remove an unnecessary hackish #define now we have 5.x in version strings
- better fix for the mib parser error-message spam
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.57 2011/07/08 11:53:28 sthen Exp $
d11 1
a11 1
REVISION-tkmib=	0
@


1.58.2.1
log
@Update to net-snmp in -stable to 5.7.1 + patches from -current; the older
version was returning incorrect data for hrStorageUsed and sometimes
encountering segfaults when querying hrStorageTable. Problems reported
and fix tested by Joel Knight.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62 2011/11/28 22:40:25 sthen Exp $
d7 1
a7 1
V=		5.7.1
d9 3
a14 2
REVISION-main=	0
REVISION-perl=	0
d18 1
a18 1
LIBV=		12.1
@


1.57
log
@better DESCRs
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2011/07/07 20:02:02 sthen Exp $
d9 2
a10 2
REVISION-main=	0
REVISION-perl=	0
@


1.56
log
@update to Net-SNMP 5.7 and clean up the patches a lot.

- rc scripts added (names suggested by Nigel Taylor, I was having
a hard time coming up with something nice that avoid a conflict with
base snmpd now the rc.d namespace is shared).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55 2011/07/06 22:02:25 sthen Exp $
d9 3
@


1.55
log
@update net-snmp to 5.6.1.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.54 2011/07/06 21:32:57 sthen Exp $
d7 1
a7 1
V=		5.6.1.1
d9 2
d14 6
a19 5
SHARED_LIBS=	netsnmp		11.0	\
		netsnmpagent	11.0	\
		netsnmphelpers	11.0	\
		netsnmpmibs	11.0	\
		netsnmptrapd	11.0
d25 2
d33 2
a34 1
WANTLIB-main=		c crypto kvm m perl pthread util wrap
a35 3
MULTI_PACKAGES=		-main -perl -tkmib

WANTLIB-perl=		crypto netsnmp netsnmpagent netsnmptrapd netsnmpmibs
a36 1

d40 1
a40 1
NET_SNMP_MIB_LIST=	host disman/event-mib smux mibII/mta_sendmail
d53 1
a53 1
AUTOCONF_VERSION= 2.63
a66 1

d84 1
a84 1
	${INSTALL_DATA} ${WRKSRC}/EXAMPLE.conf \
@


1.54
log
@- convert kinfo_proc2 -> kinfo_procs

- don't use "#if defined(openbsd3) || defined(openbsd4)" all over the place,
this is definitely not web scale

- zap some pointless ifdefs
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2011/05/11 12:03:19 jasper Exp $
d7 1
a7 1
V=		5.6.1
a9 1
REVISION-main=	2
d12 5
a16 5
SHARED_LIBS=	netsnmp		10.0	\
		netsnmpagent	10.0	\
		netsnmphelpers	10.0	\
		netsnmpmibs	10.0	\
		netsnmptrapd	10.0
@


1.53
log
@Sanitize some @@unexec/@@extraunexec calls to rm: move them up in the
PLIST and delete everything under the @@sample'd directory instead of the
directory itself to prevent a warning from pkg_delete(1) trying to
remove a non existing directory and to help preventing left-over files
and directories.

ok aja@@
@
text
@d1 1
a1 4
# $OpenBSD: Makefile,v 1.52 2011/03/16 22:45:20 sthen Exp $

# XXX note there are various "openbsd[234]" ifdefs which will need
# adjusting when OpenBSD goes to 5.x
d10 1
a10 1
REVISION-main=	1
@


1.52
log
@- remove a patch which is a noop
- remove a CONFIGURE_ARGS which is a noop
- bump REVISION; gratuitous really, but there's no point in not doing so
at this time.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 2011/01/15 09:38:31 sthen Exp $
d13 1
a13 1
REVISION-main=	0
@


1.51
log
@update to 5.6.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2010/11/19 22:31:35 espie Exp $
d13 1
a59 1
	--with-perl-modules \
@


1.50
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2010/10/26 00:42:21 sthen Exp $
d3 2
a4 2
# XXX note there are various "openbsd[234]" ifdefs which will need adjusting when
# OpenBSD goes to 5.x
d10 1
a10 1
V=		5.6
a12 1
REVISION-main=	0
d15 5
a19 5
SHARED_LIBS=	netsnmp		9.0	\
		netsnmpagent	9.0	\
		netsnmphelpers	9.0	\
		netsnmpmibs	9.0	\
		netsnmptrapd	9.0
@


1.49
log
@feed the right size to kvm_getproc2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2010/10/25 22:59:12 sthen Exp $
d37 1
a37 1
LIB_DEPENDS-perl=	::net/net-snmp,-main
d39 2
a40 2
RUN_DEPENDS-tkmib=	::net/net-snmp,-perl \
			::x11/p5-Tk
@


1.48
log
@update Net-SNMP to 5.6 and switch to kvm_getproc2, thanks landry for testing
"commit it!" landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2010/10/18 18:36:50 espie Exp $
d13 1
@


1.47
log
@USE_GROFF=Yes
@
text
@d1 4
a4 1
# $OpenBSD: Makefile,v 1.46 2010/09/21 10:43:04 sthen Exp $
d10 2
a11 2
V=		5.4.3
DISTNAME=	net-snmp-${V}
d13 7
a19 7
PKGNAME-perl=	p5-SNMP-${V}
PKGNAME-tkmib=	net-snmp-tkmib-${V}
SHARED_LIBS=	netsnmp		8.0	\
		netsnmpagent	8.1	\
		netsnmphelpers	8.0	\
		netsnmpmibs	8.0	\
		netsnmptrapd	8.0
d31 1
a31 1
WANTLIB-main=		c crypto kvm m perl util wrap
d35 1
a35 2
WANTLIB-perl=		netsnmp netsnmpagent netsnmphelpers netsnmptrapd
WANTLIB-perl+=		netsnmpmibs
d37 1
d50 1
d52 4
a55 3
USE_GROFF =	Yes
CONFIGURE_STYLE= gnu
CONFIGURE_ARGS=	${CONFIGURE_SHARED} \
@


1.46
log
@update Net-SNMP to 5.4.3 and pick up OpenBSD mibs from /usr/share/snmp/mibs
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2010/07/12 22:07:39 sthen Exp $
d48 1
@


1.45
log
@use REVISION, checked with before/after make show=PKGNAMES (plus some
extra-careful checking where there are complicated PSEUDO_FLAVORS).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2010/05/22 09:50:06 jasper Exp $
d7 1
a7 1
V=		5.4.2.1
a8 2
REVISION-main=	5
REVISION-perl=	1
d20 1
a20 1
HOMEPAGE=	http://www.net-snmp.org
d27 1
d30 1
a30 1
MULTI_PACKAGES=	-main -perl -tkmib
d32 3
a34 1
LIB_DEPENDS-perl=	netsnmptrapd,netsnmpmibs,netsnmphelpers,netsnmpagent,netsnmp::net/net-snmp,-main
d38 8
a45 1
NET_SNMP_MIB_LIST= host disman/event-mib smux mibII/mta_sendmail
d56 2
d65 5
@


1.44
log
@
- remove now unneeded workaround for mips64
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2010/05/19 15:50:00 sthen Exp $
d9 4
a12 2
PKGNAME-main=	${DISTNAME}p5
PKGNAME-perl=	p5-SNMP-${V}p1
@


1.43
log
@Build with --enable-mfd-rewrites to allow 64-bit counters to work.
Requested/tested by Johan Karlsson.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2010/02/09 12:23:59 jasper Exp $
d9 1
a9 1
PKGNAME-main=	${DISTNAME}p4
a50 5

# gcc 3.3.5 internal compiler error
.if ${MACHINE_ARCH:Mmips64*}
CFLAGS+=  -O0
.endif
@


1.42
log
@- extend archtecture tests for mips64el

ok naddy@@ phessler@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2009/11/22 15:36:33 jasper Exp $
d9 1
a9 1
PKGNAME-main=	${DISTNAME}p3
d41 1
@


1.41
log
@unbreak net-snmp on mips64, allowing another 30 or so ports to build
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2009/08/17 14:58:45 giovanni Exp $
d52 1
a52 1
.if ${MACHINE_ARCH} == "mips64"
@


1.40
log
@
Add a -tkmib package
ok ajacoutot@@ with a similar diff
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2009/08/16 13:35:25 rui Exp $
d50 5
@


1.39
log
@Drop maintainership and bump. I don't actively use net-snmp anymore.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2009/02/13 09:39:38 jasper Exp $
d5 1
d9 1
a9 1
PKGNAME-main=	${DISTNAME}p2
d11 1
d29 1
a29 1
MULTI_PACKAGES=	-main -perl
d32 2
@


1.38
log
@- roll in a security fix for SA33884, which could disclose sensitive information
* patch taken from upstream svn

"<sthen_p> makes sense if you can get it in before lock" on rui's diff
ok rui@@ (MAINTAINER) who came up with the same diff
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2008/12/22 10:43:59 sthen Exp $
d8 2
a9 2
PKGNAME-main=	${DISTNAME}p1
PKGNAME-perl=	p5-SNMP-${V}p0
a18 2

MAINTAINER=	Rui Reis <rui@@openbsd.org>
@


1.37
log
@teach net-snmp how to skip routing messages with the wrong version;
fixes route display in IP-MIB. from joel@@.

"if it works for you go ahead" rui@@ (maintainer).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2008/11/07 13:56:56 bernd Exp $
d8 1
a8 1
PKGNAME-main=	${DISTNAME}p0
@


1.36
log
@PKGNAME-main got removed with the last commit. Put it back so we don't end up
with net-snmp-5.4.2.1-main.

No cookie.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2008/11/07 09:48:40 sthen Exp $
d8 2
a9 2
PKGNAME-main=	${DISTNAME}
PKGNAME-perl=	p5-SNMP-${V}
@


1.35
log
@SECURITY fix, update to 5.4.2.1, CVE-2008-4309:

A bug in the getbulk handling code could let anyone with even minimal
access crash the agent.

(straight out of malloc(3) "be careful to avoid...")

ok rui@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2008/10/12 08:21:21 brad Exp $
d8 1
@


1.34
log
@Enable the IPv6 support.

ok maintainer
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2008/10/07 14:57:21 sthen Exp $
d6 1
a6 1
V=		5.4.2
d8 1
a8 2
PKGNAME-main=	${DISTNAME}p1
PKGNAME-perl=	p5-SNMP-${V}p2
@


1.33
log
@bump package versions, for perl 5.10.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2008/09/22 18:46:36 sthen Exp $
d8 2
a9 2
PKGNAME-main=	${DISTNAME}p0
PKGNAME-perl=	p5-SNMP-${V}p1
d11 1
a11 1
		netsnmpagent	8.0	\
d37 4
a40 1
CONFIGURE_ARGS=	${CONFIGURE_SHARED} --with-libwrap --with-perl-modules \
d48 1
@


1.32
log
@- re-enable kmem support, with 5.4.2 there don't seem to be
any problems on tested arch (including the ones that used to
have trouble).

- repair sysctl() use in cpu_sysctl.c, it was using the wrong
type and at least on some arch the system call was failing, so
because the code isn't careful about checking return codes and
thus used uninitialized space, it tried to allocate memory for
info structures for 128 million CPUs on one of my systems...

"definitely ok" rui@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2008/09/20 22:15:51 rui Exp $
d9 1
a9 1
PKGNAME-perl=	p5-SNMP-${V}p0
@


1.31
log
@- maintenance update to net-snmp 5.4.2. Check the Changelog for more information.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2008/07/03 08:07:56 sthen Exp $
d8 2
a9 2
PKGNAME-main=	${DISTNAME}
PKGNAME-perl=	p5-SNMP-${V}
a43 2
	--without-kmem-usage \
	--with-out-mib-modules=host/hr_swrun \
@


1.30
log
@- disable kmem-related code, it is not 64-bit clean and causes
problems on i386.

- bump package

ok rui@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2008/06/14 07:48:23 sthen Exp $
d6 1
a6 1
V=		5.4.1.1
d8 7
a14 7
PKGNAME-main=	${DISTNAME}p1
PKGNAME-perl=	p5-SNMP-${V}p0
SHARED_LIBS=	netsnmp		7.0	\
		netsnmpagent	7.0	\
		netsnmphelpers	7.0	\
		netsnmpmibs	7.0	\
		netsnmptrapd	7.0
@


1.29
log
@Avoid a divide-by-zero which kills Net-SNMP's snmpd running
on sparc64 when you snmpwalk against it.

From http://marc.info/?l=openbsd-ports&m=119175114720453&w=2

ok rui
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2008/06/10 18:00:35 sthen Exp $
d6 4
a9 3
DISTNAME=	net-snmp-5.4.1.1
PKGNAME-main=	${DISTNAME}p0
PKGNAME-perl=	p5-SNMP-5.4.1.1
d44 2
@


1.28
log
@SECURITY update to fix CVE-2008-0960, http://secunia.com/advisories/30574/

A vulnerability has been reported in Net-SNMP, which can be exploited
by malicious people to spoof authenticated SNMPv3 packets.

The authentication code reads the length to be checked from sender
input, this allows the sender to supply single byte HMAC code and
have a 1 in 256 chance of matching the correct HMAC and authenticating,
as only the first byte will be checked. The sender would need to
know a valid username.

ok rui (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2008/06/09 21:28:56 sturm Exp $
d7 1
a7 1
PKGNAME-main=	${DISTNAME}
@


1.27
log
@missing PKGNAME-perl bump after MAINTAINER changed
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2008/06/05 15:52:21 okan Exp $
d6 3
a8 3
DISTNAME=	net-snmp-5.4.1
PKGNAME-main=	${DISTNAME}p1
PKGNAME-perl=	p5-SNMP-5.4.1p0
@


1.26
log
@- fix-up PLIST
- rui takes MAINTAINER

ok rui@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2008/02/28 18:26:28 okan Exp $
d8 1
a8 1
PKGNAME-perl=	p5-SNMP-5.4.1
@


1.25
log
@HW_(PHYS|USER)MEM64 fix

ok naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2007/09/26 20:03:42 rui Exp $
d7 1
a7 1
PKGNAME-main=	${DISTNAME}p0
d19 1
a19 1
MAINTAINER=	Tim Kornau <opti@@openbsd.de>
@


1.24
log
@update net-snmp to 5.4.1, also adds a patch from claudio@@ to allow 64bit network counters.
Changelog: http://net-snmp.sourceforge.net/about/ChangeLog.html

tested by Graeme Lee, ok mbalmer@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2007/09/15 22:36:56 merdely Exp $
d7 1
a7 1
PKGNAME-main=	${DISTNAME}
@


1.23
log
@Remove surrounding quotes in COMMENT*/PERMIT_*/BROKEN/ERRORS

Add $OpenBSD$ to p5-SNMP-Info/Makefile (ok kili@@, simon@@)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2007/06/14 18:19:24 ajacoutot Exp $
d6 3
a8 3
DISTNAME=	net-snmp-5.4
PKGNAME-main=	${DISTNAME}p1
PKGNAME-perl=	p5-SNMP-5.4
d26 1
a26 1
WANTLIB=		c crypto kvm m perl util wrap
d30 1
a30 2
LIB_DEPENDS-perl=	netsnmpmibs,netsnmphelpers,netsnmpagent,netsnmp::net/net-snmp,-main
WANTLIB-main=	${WANTLIB}
@


1.22
log
@- remove powerpc compile tweak now that drahn@@ fixed vmparam.h
- regen patches while here
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2007/06/13 15:15:01 ajacoutot Exp $
d3 2
a4 2
COMMENT-main=	"extendable SNMP implementation"
COMMENT-perl=	"SNMP modules for Perl"
@


1.21
log
@- fix compilation under powerpc

discussed with and ok rui@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2007/05/19 10:52:06 rui Exp $
d7 1
a7 1
PKGNAME-main=	${DISTNAME}p0
@


1.20
log
@update net-snmp to 5.4, maintainer timeout
- changelog: http://www.net-snmp.org/about/ChangeLog.html

ok steven@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2006/11/24 21:14:29 steven Exp $
d7 1
a7 1
PKGNAME-main=	${DISTNAME}
@


1.19
log
@new MULTI_PACKAGES
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2006/09/30 22:03:56 steven Exp $
d6 8
a13 8
DISTNAME=	net-snmp-5.1.3
PKGNAME-main=	${DISTNAME}p5
PKGNAME-perl=	p5-SNMP-5.1.3p3
SHARED_LIBS=	netsnmp		6.3	\
		netsnmpagent	6.3	\
		netsnmphelpers	6.3	\
		netsnmpmibs	6.3	\
		netsnmptrapd	6.3
d26 1
a26 1
WANTLIB=		crypto kvm m wrap z
d31 1
a31 1
WANTLIB-main=	${WANTLIB} c
d36 1
a36 1
CONFIGURE_STYLE= gnu dest
@


1.18
log
@make access to various memory bits like the enterprises.ucdavis.memory tree
work again on OpenBSD 4.

from Jim Dew <jdew at yggdrasil.ca>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2006/07/28 20:17:52 sturm Exp $
d3 1
a3 1
COMMENT=	"extendable SNMP implementation"
d7 2
a8 2
PKGNAME=	${DISTNAME}p4
FULLPKGNAME-perl= p5-SNMP-5.1.3p2
d14 1
a14 1
CATEGORIES=	net
d28 1
a28 2
MULTI_PACKAGES=	-perl
SUBPACKAGE?=
d30 2
a31 8
.if ${SUBPACKAGE} == "-perl" 
CATEGORIES=	net perl5
.  if defined(PACKAGING)
LIB_DEPENDS+=	netsnmpmibs,netsnmphelpers,netsnmpagent,netsnmp::net/net-snmp
.  endif
.else
WANTLIB+=	c
.endif
@


1.17
log
@explicitly mention startup code, it's goint to be removed from rc.local
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2006/06/18 12:00:03 steven Exp $
d7 1
a7 1
PKGNAME=	${DISTNAME}p3
@


1.17.2.1
log
@MFC:
make access to various memory bits like the enterprises.ucdavis.memory tree
work again on OpenBSD 4
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2006/07/28 20:17:52 sturm Exp $
d7 1
a7 1
PKGNAME=	${DISTNAME}p4
@


1.16
log
@fix WANTLIB for p5-SNMP package, bump PKGNAME.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2006/02/15 05:14:29 david Exp $
d7 1
a7 1
PKGNAME=	${DISTNAME}p2
@


1.15
log
@replace /usr/local with PREFIX and bump PKGNAME
ok wilfried@@ sturm@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2006/01/03 17:37:18 steven Exp $
d8 1
a8 1
FULLPKGNAME-perl= p5-SNMP-5.1.3p1
d26 1
a26 1
WANTLIB=		c crypto kvm m wrap z
d36 2
@


1.14
log
@SHARED_LIBS and USE_LIBTOOL
ok bernd@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2005/11/12 00:30:48 bernd Exp $
d7 2
a8 2
PKGNAME=	${DISTNAME}p1
FULLPKGNAME-perl= p5-SNMP-5.1.3p0
@


1.13
log
@Don't include -lwrap in 'net-snmp-config --libs' output. This unbreaks
some ports which depend on net-snmp. Bump PKGNAMEs.

found by naddy@@

a lot of help & ok sturm@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2005/11/05 19:09:38 bernd Exp $
d7 1
a7 1
PKGNAME=	${DISTNAME}p0
d9 5
d40 1
@


1.12
log
@Security update to net-snmp-5.1.3.

- fix potential race condition in fixproc script
- fix DOS vulnerability on tcp connections

help & ok sturm@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2005/09/09 19:07:46 marcm Exp $
d7 2
a8 1
FULLPKGNAME-perl= p5-SNMP-5.1.3
@


1.11
log
@Enable support on static arches.

MAINTAINER ok
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2005/06/13 22:42:00 naddy Exp $
d6 2
a7 3
DISTNAME=	net-snmp-5.1.2
PKGNAME=	${DISTNAME}p3
FULLPKGNAME-perl= p5-SNMP-5.1.2p1
@


1.10
log
@Fix for route addition/deletion.
Originally from Darwin, found by Alexandre Anriot.
@
text
@d1 1
a1 3
# $OpenBSD: Makefile,v 1.9 2005/05/26 03:34:21 robert Exp $

SHARED_ONLY=	Yes
d7 2
a8 2
PKGNAME=	${DISTNAME}p2
FULLPKGNAME-perl= p5-SNMP-5.1.2p0
@


1.10.2.1
log
@MFC:
Security update to net-snmp-5.1.3.

- fix potential race condition in fixproc script
- fix DOS vulnerability on tcp connections
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2005/06/13 22:42:00 naddy Exp $
d8 3
a10 2
DISTNAME=	net-snmp-5.1.3
FULLPKGNAME-perl= p5-SNMP-5.1.3
@


1.10.2.2
log
@MFC:
Don't include -lwrap in 'net-snmp-config --libs' output. This unbreaks
some ports which depend on net-snmp. Bump PKGNAMEs.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10.2.1 2005/11/07 21:15:27 sturm Exp $
d9 1
a9 2
PKGNAME=	${DISTNAME}p0
FULLPKGNAME-perl= p5-SNMP-5.1.3p0
@


1.9
log
@SECURITY:
fix an insecure temporary file creation in fixproc; bump PKGNAME
http://www.vuxml.org/openbsd/75ecb34c-cc7d-11d9-8e94-00065bd5b0b6.html

ok naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2005/04/09 23:31:28 espie Exp $
d9 1
a9 1
PKGNAME=	${DISTNAME}p1
@


1.8
log
@fix inter-package dependencies
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2004/12/26 12:33:16 sturm Exp $
d9 1
a9 1
PKGNAME=	${DISTNAME}p0
@


1.7
log
@reorder PLIST slightly in order to silence pkg_delete warnings

no objections from maintainer
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2004/12/16 00:31:23 alek Exp $
d10 1
a10 1
FULLPKGNAME-perl= p5-SNMP-5.1.2
d28 1
a28 1
.if ${SUBPACKAGE} == "-perl"
d30 3
a32 1
RUN_DEPENDS=	::net/net-snmp
@


1.7.2.1
log
@SECURITY:
fix an insecure temporary file creation in fixproc; bump PKGNAME
http://www.vuxml.org/openbsd/75ecb34c-cc7d-11d9-8e94-00065bd5b0b6.html

ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2004/12/26 12:33:16 sturm Exp $
d9 1
a9 1
PKGNAME=	${DISTNAME}p1
@


1.7.2.2
log
@MFC:
Security update to net-snmp-5.1.3.

- fix potential race condition in fixproc script
- fix DOS vulnerability on tcp connections
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7.2.1 2005/05/26 04:01:56 robert Exp $
d8 3
a10 2
DISTNAME=	net-snmp-5.1.3
FULLPKGNAME-perl= p5-SNMP-5.1.3
@


1.7.2.3
log
@MFC:
Don't include -lwrap in 'net-snmp-config --libs' output. This unbreaks
some ports which depend on net-snmp. Bump PKGNAMEs.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7.2.2 2005/11/07 21:09:03 sturm Exp $
d9 1
a9 2
PKGNAME=	${DISTNAME}p0
FULLPKGNAME-perl= p5-SNMP-5.1.3p0
@


1.6
log
@Add WANTLIB markers
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2004/10/08 18:41:39 danh Exp $
d9 1
@


1.5
log
@replace @@exec/@@unexec
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2004/10/08 16:30:52 danh Exp $
d22 1
@


1.4
log
@comment out PACKAGE_* macros from final net-snmp-config.h
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2004/08/10 13:36:08 danh Exp $
d47 1
@


1.3
log
@update to net-snmp 5.1.2 ; ok maintainer
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2004/08/09 15:04:17 danh Exp $
d45 2
@


1.3.2.1
log
@SECURITY:
fix an insecure temporary file creation in fixproc; bump PKGNAME
http://www.vuxml.org/openbsd/75ecb34c-cc7d-11d9-8e94-00065bd5b0b6.html

ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2004/08/10 13:36:08 danh Exp $
a8 1
PKGNAME=	${DISTNAME}p0
@


1.2
log
@update PLIST and fix a manual page
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2004/08/03 17:47:12 danh Exp $
d8 2
a9 2
DISTNAME=	net-snmp-5.1.1
FULLPKGNAME-perl= p5-SNMP-5.1.1
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
a28 1
MODULES=	perl
@


1.1.1.1
log
@net-snmp 5.1.1 from Tim Kornau <opti@@openbsd.de>
@
text
@@
