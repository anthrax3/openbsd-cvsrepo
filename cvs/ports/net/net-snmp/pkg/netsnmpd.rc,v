head	1.4;
access;
symbols
	OPENBSD_6_1:1.4.0.2
	OPENBSD_6_1_BASE:1.4
	OPENBSD_6_0:1.3.0.4
	OPENBSD_6_0_BASE:1.3
	OPENBSD_5_9:1.3.0.2
	OPENBSD_5_9_BASE:1.3
	OPENBSD_5_8:1.1.0.20
	OPENBSD_5_8_BASE:1.1
	OPENBSD_5_7:1.1.0.16
	OPENBSD_5_7_BASE:1.1
	OPENBSD_5_6:1.1.0.14
	OPENBSD_5_6_BASE:1.1
	OPENBSD_5_5:1.1.0.12
	OPENBSD_5_5_BASE:1.1
	OPENBSD_5_4:1.1.0.10
	OPENBSD_5_4_BASE:1.1
	OPENBSD_5_3:1.1.0.8
	OPENBSD_5_3_BASE:1.1
	OPENBSD_5_2:1.1.0.6
	OPENBSD_5_2_BASE:1.1
	OPENBSD_5_1_BASE:1.1
	OPENBSD_5_1:1.1.0.4
	OPENBSD_5_0:1.1.0.2
	OPENBSD_5_0_BASE:1.1;
locks; strict;
comment	@ * @;


1.4
date	2016.10.11.20.47.43;	author sthen;	state Exp;
branches;
next	1.3;
commitid	gx6WQ2YqoodDayvF;

1.3
date	2016.01.07.12.35.53;	author sthen;	state Exp;
branches;
next	1.2;
commitid	lrGFBs6UFK8JCpsO;

1.2
date	2015.11.05.23.43.46;	author sthen;	state Exp;
branches;
next	1.1;
commitid	ioaCbmn8pvAuCVAx;

1.1
date	2011.07.07.20.02.02;	author sthen;	state Exp;
branches;
next	;


desc
@@


1.4
log
@Use the -r flag in net-snmp's rc.d script, as figured out by
Theodore Wynnychenko. This tells it not to exit when it can't open
/dev/kmem etc. Fixes startup now that this access is disabled by
default in OpenBSD.

Some MIBs won't work, but in general these should be rewritten
to use sysctl interfaces.
@
text
@#!/bin/sh
#
# $OpenBSD: netsnmpd.rc,v 1.3 2016/01/07 12:35:53 sthen Exp $

daemon="${TRUEPREFIX}/sbin/snmpd"

daemon_flags="-u _netsnmp -r"

. /etc/rc.d/rc.subr

pexp="${daemon}.*"

rc_cmd $1
@


1.3
log
@Set pexp="${daemon}.*" for net-snmp; avoids a long delay at boot if the
user has set a command-line arguments containing '+' (not totally uncommon).
Otherwise rc_check() now waits for pexp to match, which fails due to
the + being handled as part of a regular expression.
@
text
@d3 1
a3 1
# $OpenBSD: netsnmpd.rc,v 1.2 2015/11/05 23:43:46 sthen Exp $
d7 1
a7 3
# disable ipv6 mib which needs root; to override the default you may set
# this in rc.conf.local: netsnmpd_flags=" "
daemon_flags="-u _netsnmp -I -ipv6"
@


1.2
log
@Run net-snmp as _netsnmp instead of root, doing this currently requires
disabling the ipv6 mib - this is done in the rc script so it can be
overridden with netsnmpd_flags if required (but just run snmpd from base,
really ....)

Reported by Pierre Kim.

Drop unnecessary patch while there, the problem it was meant to fix was
already fixed in 5.7.3.
@
text
@d3 1
a3 1
# $OpenBSD: netsnmpd.rc,v 1.1 2011/07/07 20:02:02 sthen Exp $
d12 2
@


1.1
log
@update to Net-SNMP 5.7 and clean up the patches a lot.

- rc scripts added (names suggested by Nigel Taylor, I was having
a hard time coming up with something nice that avoid a conflict with
base snmpd now the rc.d namespace is shared).
@
text
@d3 1
a3 1
# $OpenBSD$
d6 4
@

