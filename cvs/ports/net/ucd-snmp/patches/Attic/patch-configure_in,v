head	1.6;
access;
symbols
	OPENBSD_2_9_TRACKING_SWITCH:1.5
	OPENBSD_2_9:1.5.0.2
	OPENBSD_2_9_BASE:1.5
	OPENBSD_2_8:1.4.0.2
	OPENBSD_2_8_BASE:1.4
	OPENBSD_2_7:1.1.0.2;
locks; strict;
comment	@# @;


1.6
date	2001.10.11.19.16.19;	author danh;	state dead;
branches;
next	1.5;

1.5
date	2001.01.05.09.19.46;	author danh;	state Exp;
branches;
next	1.4;

1.4
date	2000.10.26.01.55.22;	author danh;	state Exp;
branches;
next	1.3;

1.3
date	2000.10.25.20.48.22;	author brad;	state Exp;
branches;
next	1.2;

1.2
date	2000.08.29.17.49.10;	author danh;	state Exp;
branches;
next	1.1;

1.1
date	2000.08.05.09.39.21;	author danh;	state Exp;
branches;
next	;


desc
@@


1.6
log
@upgrade to ucd-snmp 4.2.2
@
text
@$OpenBSD: patch-configure_in,v 1.5 2001/01/05 09:19:46 danh Exp $
--- configure.in.orig	Fri Dec  1 10:56:07 2000
+++ configure.in	Sat Dec 23 14:21:54 2000
@@@@ -348,6 +348,7 @@@@ dnl get version number.
 AC_MSG_CHECKING(for ucd-snmp version number)
 VERSION=`cat $srcdir/version.h | sed 's/";//;s/.*"//;s/pre/0./;'`
 AC_SUBST(VERSION)
+AC_SUBST(VERSION_INFO)
 AC_MSG_RESULT($VERSION)
 
 dnl super type checking
@@@@ -461,22 +462,10 @@@@ if test "x$prefix" = "xNONE"; then
   prefix=/usr/local
 fi
 
-fch=`echo $prefix | sed 's/\(.\).*/\1/'`
-if test $fch != "/" ; then
-   prefix=`pwd`/$prefix
-   echo "adjusting prefix to $prefix"
-fi
-
 if test "x$exec_prefix" = "xNONE"; then
   exec_prefix=$prefix
 fi
 
-fch=`echo $exec_prefix | sed 's/\(.\).*/\1/'`
-if test $fch != "/" ; then
-   exec_prefix=`pwd`/$exec_prefix
-   echo "adjusting exec_prefix to $exec_prefix"
-fi
-
 dnl Set SNMPLIBPATH & SNMPSHAREPATH
 
 SNMPLIBPATH=""
@@@@ -932,10 +921,11 @@@@ AC_ARG_WITH(libwrap,
     AC_CHECK_HEADER(tcpd.h,
 	LIBS="$LIBS -lwrap"
 	AC_MSG_CHECKING(for TCP wrappers library -lwrap)
-	AC_TRY_LINK([#include <tcpd.h>
-  int allow_severity = 0;
-  int deny_severity  = 0;
-  ],[hosts_access((void *)0)],
+	AC_TRY_LINK([#include <sys/types.h>
+#include <tcpd.h>
+int allow_severity = 0;
+int deny_severity  = 0;
+],[hosts_access((void *)0)],
 	    AC_MSG_RESULT(yes)
 	    AC_DEFINE(USE_LIBWRAP)
 	    test "$with_libwrap" != no && WRAPLIBS="-L$with_libwrap/lib"
@@@@ -945,10 +935,11 @@@@ AC_ARG_WITH(libwrap,
 	    AC_CHECK_FUNC(yp_get_default_domain, ,
 		AC_CHECK_LIB(nsl, yp_get_default_domain))
 	    AC_MSG_CHECKING(for TCP wrappers library -lwrap linked with -lnsl)
-	    AC_TRY_LINK([#include <tcpd.h>
-  int allow_severity = 0;
-  int deny_severity  = 0;
-  ],[hosts_access((void *)0)],
+	    AC_TRY_LINK([#include <sys/types.h>
+#include <tcpd.h>
+int allow_severity = 0;
+int deny_severity  = 0;
+],[hosts_access((void *)0)],
 		AC_MSG_RESULT(yes)
 		test "$with_libwrap" != no && WRAPLIBS="-L$with_libwrap/lib"
 		WRAPLIBS="$WRAPLIBS -lwrap", AC_MSG_RESULT(no)),
@


1.5
log
@upgrade to ucd-snmp 4.2
@
text
@d1 1
a1 1
$OpenBSD: update-patches,v 1.3 2000/06/09 17:08:37 espie Exp $
@


1.4
log
@remove silly patch; blank SHLIB_LDCONFIG_CMD so ldconfig isn't run from any subdir's Makefile
@
text
@d2 11
a12 3
--- configure.in.orig	Fri May  5 12:46:26 2000
+++ configure.in	Wed Oct 25 21:46:25 2000
@@@@ -400,22 +400,10 @@@@ if test "x$prefix" = "xNONE"; then
d16 1
a16 1
-fch=`echo $prefix | cut -b1`
d26 1
a26 1
-fch=`echo $exec_prefix | cut -b1`
d35 32
a66 140
@@@@ -484,7 +472,7 @@@@ if test "x$with_shared" = "xyes"; then
 	fi
 	;;
 
-    netbsd*|openbsd*)
+    netbsd*)
 	AC_MSG_CHECKING(if this is ELF system)
 	AC_EGREP_CPP(yes, [dnl
 #ifdef __ELF__
@@@@ -502,6 +490,22 @@@@ yes
 	])
 	;;
 
+    openbsd2.[01234567])
+	SHLIB_CFLAGS="-fPIC"	
+	SHLIB_LD_CMD="ld -Bshareable -o"
+	CC_RUNTIME_ARG="-R$libdir"
+	SHLIB_LDCONFIG_CMD='PATH="$$PATH:/sbin" ldconfig -m $(libdir)'
+	SHLIB_VERSION=.41.2
+	;;
+
+    openbsd*)
+	SHLIB_CFLAGS="-fPIC"
+	SHLIB_LD_CMD='$(CC) -shared -o'
+	CC_RUNTIME_ARG="-Wl,-rpath,$libdir"
+	SHLIB_LDCONFIG_CMD=''
+	SHLIB_VERSION=.41.2
+	;;
+
     hpux*)
 	SHLIB_EXTENSION="sl"
         if test "x$GCC" != "xyes"; then
@@@@ -1256,29 +1260,17 @@@@ AC_CHECK_STRUCT_FOR([
 
 AC_CHECK_STRUCT_FOR([
 #include <sys/types.h>
-#define KERNEL
-#define _KERNEL
 #include <sys/socket.h>
-#undef KERNEL
-#undef _KERNEL
 ], sockaddr, sa_len, no)
 
 AC_CHECK_STRUCT_FOR([
 #include <sys/types.h>
-#define KERNEL
-#define _KERNEL
 #include <sys/socket.h>
-#undef KERNEL
-#undef _KERNEL
 ], sockaddr, sa_union.sa_generic.sa_family2, no)
 
 AC_CHECK_STRUCT_FOR([
 #include <sys/types.h>
-#define KERNEL
-#define _KERNEL
 #include <sys/socket.h>
-#undef KERNEL
-#undef _KERNEL
 #include <net/route.h>
 ], rtentry, rt_dst, no)
 
@@@@ -1289,11 +1281,7 @@@@ AC_CACHE_CHECK(type of rtentry structure
 dnl 4.4 compat
 AC_TRY_COMPILE([
 #include <sys/types.h>
-#define KERNEL
-#define _KERNEL
 #include <sys/socket.h>
-#undef KERNEL
-#undef _KERNEL
 #include <net/route.h>
 ],[
 
@@@@ -1310,11 +1298,7 @@@@ dnl 4.3 compat
 if test "x$ac_cv_RTENTRY_TYPE" = "x"; then
 AC_TRY_COMPILE([
 #include <sys/types.h>
-#define KERNEL
-#define _KERNEL
 #include <sys/socket.h>
-#undef KERNEL
-#undef _KERNEL
 #include <net/route.h>
 ],[
 struct rtentry rt; 
@@@@ -1364,11 +1348,7 @@@@ AC_CACHE_CHECK(for struct rtentry has a 
 [
 AC_TRY_COMPILE([
 #include <sys/types.h>
-#define KERNEL
-#define _KERNEL
 #include <sys/socket.h>
-#undef KERNEL
-#undef _KERNEL
 #include <net/route.h>
 ],[
 struct rtentry rt; 
@@@@ -1385,41 +1365,25 @@@@ fi
 dnl Check struct rtentry for various things.
 AC_CHECK_STRUCT_FOR([
 #include <sys/types.h>
-#define KERNEL
-#define _KERNEL
 #include <sys/socket.h>
-#undef KERNEL
-#undef _KERNEL
 #include <net/route.h>
 ], rtentry, rt_unit)
 
 AC_CHECK_STRUCT_FOR([
 #include <sys/types.h>
-#define KERNEL
-#define _KERNEL
 #include <sys/socket.h>
-#undef KERNEL
-#undef _KERNEL
 #include <net/route.h>
 ], rtentry, rt_refcnt)
 
 AC_CHECK_STRUCT_FOR([
 #include <sys/types.h>
-#define KERNEL
-#define _KERNEL
 #include <sys/socket.h>
-#undef KERNEL
-#undef _KERNEL
 #include <net/route.h>
 ], rtentry, rt_hash)
 
 AC_CHECK_STRUCT_FOR([
 #include <sys/types.h>
-#define KERNEL
-#define _KERNEL
 #include <sys/socket.h>
-#undef KERNEL
-#undef _KERNEL
 #include <net/route.h>
 ], rtentry, rt_use)
 
@


1.3
log
@use "cc -shared" to create shared libraries on 2.8 and up.
@
text
@d1 1
d3 2
a4 2
+++ configure.in	Wed Oct 25 16:35:10 2000
@@@@ -400,22 +400,10 @@@@
d27 1
a27 1
@@@@ -484,7 +472,7 @@@@
d36 1
a36 1
@@@@ -502,6 +490,22 @@@@
d52 1
a52 1
+	SHLIB_LDCONFIG_CMD='PATH="$$PATH:/sbin" ldconfig -m $(libdir)'
d59 1
a59 1
@@@@ -1256,29 +1260,17 @@@@
d89 1
a89 1
@@@@ -1289,11 +1281,7 @@@@
d101 1
a101 1
@@@@ -1310,11 +1298,7 @@@@
d113 1
a113 1
@@@@ -1364,11 +1348,7 @@@@
d125 1
a125 1
@@@@ -1385,41 +1365,25 @@@@
@


1.2
log
@- re-organized Makefile.
- added shared library support.
- updated PLIST, and added PFRAG.shared, PFRAG.no-shared for libraries.
@
text
@a0 1
$OpenBSD: patch-configure_in,v 1.1 2000/08/05 09:39:21 danh Exp $
d2 2
a3 2
+++ configure.in	Tue Aug 29 13:23:30 2000
@@@@ -400,22 +400,10 @@@@ if test "x$prefix" = "xNONE"; then
d26 10
a35 15
@@@@ -460,7 +448,7 @@@@ if test "x$with_shared" = "xyes"; then
       SHLIB_CFLAGS="-KPIC"
     fi
     SHLIB_EXTENSION="so"
-    SHLIB_VERSION=
+    SHLIB_VERSION=.41.2
     SHLIB_LD_CMD="ld -r -o"
     SHLIB_LDCONFIG_CMD=
     SHLIB_LD_LIBS=
@@@@ -498,7 +486,7 @@@@ yes
 		AC_MSG_RESULT([no])
 		SHLIB_LD_CMD="ld -Bshareable -o"
 		CC_RUNTIME_ARG="-R$libdir"
-		SHLIB_LDCONFIG_CMD='PATH="$$PATH:/sbin" ldconfig -m $(libdir)'
+		SHLIB_LDCONFIG_CMD=
d39 20
a58 1
@@@@ -1256,29 +1244,17 @@@@ AC_CHECK_STRUCT_FOR([
d88 1
a88 1
@@@@ -1289,11 +1265,7 @@@@ AC_CACHE_CHECK(type of rtentry structure
d100 1
a100 1
@@@@ -1310,11 +1282,7 @@@@ dnl 4.3 compat
d112 1
a112 1
@@@@ -1364,11 +1332,7 @@@@ AC_CACHE_CHECK(for struct rtentry has a 
d124 1
a124 1
@@@@ -1385,41 +1349,25 @@@@ fi
@


1.1
log
@fixed configure.in which was broken on sparc; now requires autoconf
@
text
@d1 1
a1 1
$OpenBSD: update-patches,v 1.3 2000/06/09 17:08:37 espie Exp $
d3 1
a3 1
+++ configure.in	Sat Aug  5 03:54:07 2000
d27 18
@

