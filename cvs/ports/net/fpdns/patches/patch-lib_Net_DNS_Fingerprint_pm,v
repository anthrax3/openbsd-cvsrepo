head	1.1;
access;
symbols
	OPENBSD_6_1:1.1.0.14
	OPENBSD_6_1_BASE:1.1
	OPENBSD_6_0:1.1.0.12
	OPENBSD_6_0_BASE:1.1
	OPENBSD_5_9:1.1.0.8
	OPENBSD_5_9_BASE:1.1
	OPENBSD_5_8:1.1.0.10
	OPENBSD_5_8_BASE:1.1
	OPENBSD_5_7:1.1.0.6
	OPENBSD_5_7_BASE:1.1
	OPENBSD_5_6:1.1.0.4
	OPENBSD_5_6_BASE:1.1
	OPENBSD_5_5:1.1.0.2
	OPENBSD_5_5_BASE:1.1;
locks; strict;
comment	@# @;


1.1
date	2013.11.28.15.43.55;	author giovanni;	state Exp;
branches;
next	;


desc
@@


1.1
log
@
Update to 0.10.0 and unbreak
hints and ok landry@@
@
text
@$OpenBSD$
--- lib/Net/DNS/Fingerprint.pm.orig	Wed Nov 27 13:30:40 2013
+++ lib/Net/DNS/Fingerprint.pm	Wed Nov 27 13:32:23 2013
@@@@ -52,7 +52,7 @@@@ my $ignore_recurse = 0;
 my @@qy = (
     "0,QUERY,0,0,0,0,0,0,NOERROR,0,0,0,0",          #qy0
     "0,QUERY,0,0,0,1,0,1,NOERROR,0,0,0,0",          #qy1
-    "0,NS_NOTIFY_OP,0,1,1,0,1,1,NOTIMP,0,0,0,0",    #qy2
+    "0,NOTIFY,0,1,1,0,1,1,NOTIMP,0,0,0,0",    #qy2
     "0,IQUERY,0,0,0,1,1,1,NOERROR,0,0,0,0",         #qy3
     "0,QUERY,0,0,1,0,0,0,NOERROR,0,0,0,0",          #qy4
     "0,QUERY,0,0,1,0,0,0,NOERROR,0,0,0,0",          #qy5
@@@@ -85,15 +85,15 @@@@ my @@iq = (
     "1,QUERY,0,0,0,0,0,0,NXDOMAIN,1,0,0,0",           #iq1
     "1,QUERY,0,0,0,0,0,0,NOERROR,1,0,0,0",            #iq2
     "1,QUERY,0,0,0,1,0,0,NOERROR,.+,.+,.+,.+",        #iq3
-    "1,NS_NOTIFY_OP,0,0,1,1,0,1,FORMERR,1,0,0,0",     #iq4
-    "1,NS_NOTIFY_OP,0,0,1,1,0,0,FORMERR,1,0,0,0",     #iq5
-    "1,NS_NOTIFY_OP,0,0,1,1,0,0,REFUSED,1,0,0,0",     #iq6
-    "0,NS_NOTIFY_OP,0,1,1,0,1,1,NOTIMP,1,0,0,0",      #iq7
+    "1,NOTIFY,0,0,1,1,0,1,FORMERR,1,0,0,0",     #iq4
+    "1,NOTIFY,0,0,1,1,0,0,FORMERR,1,0,0,0",     #iq5
+    "1,NOTIFY,0,0,1,1,0,0,REFUSED,1,0,0,0",     #iq6
+    "0,NOTIFY,0,1,1,0,1,1,NOTIMP,1,0,0,0",      #iq7
     "1,IQUERY,0,0,0,1,0,0,NOTIMP,1,0,0,0",            #iq8
     "0,IQUERY,0,0,0,1,1,1,NOERROR,1,0,0,0",           #iq9
     "1,QUERY,0,0,1,0,0,0,NOTIMP,1,0,0,0",             #iq10
     "0,QUERY,0,0,1,0,0,0,NOERROR,1,0,0,0",            #iq11
-    "1,NS_NOTIFY_OP,0,0,1,1,0,0,SERVFAIL,1,0,0,0",    #iq12
+    "1,NOTIFY,0,0,1,1,0,0,SERVFAIL,1,0,0,0",    #iq12
     "1,IQUERY,0,0,1,1,0,0,SERVFAIL,1,0,0,0",          #iq13
     "1,IQUERY,0,0,1,1,0,0,NOTIMP,0,0,0,0",            #iq14
     "1,QUERY,0,0,0,1,0,0,NOTIMP,.+,.+,.+,.+",         #iq15
@@@@ -406,7 +406,7 @@@@ my @@ruleset = (
 
 my @@qy_old = (
     "0,IQUERY,0,0,1,0,0,0,NOERROR,0,0,0,0",
-    "0,NS_NOTIFY_OP,0,0,0,0,0,0,NOERROR,0,0,0,0",
+    "0,NOTIFY,0,0,0,0,0,0,NOERROR,0,0,0,0",
     "0,QUERY,0,0,0,0,0,0,NOERROR,0,0,0,0",
     "0,IQUERY,0,0,0,0,1,1,NOERROR,0,0,0,0",
     "0,QUERY,0,0,0,0,0,0,NOTIMP,0,0,0,0",
@@@@ -430,20 +430,20 @@@@ my @@iq_old = (
     "1,QUERY,1,0,1,0,0,0,NOTIMP,1,0,0,0",
     "1,QUERY,0,0,0,0,0,0,NOTIMP,0,0,0,0",
     "1,IQUERY,0,0,1,1,0,0,FORMERR,1,0,0,0",    # iq_old10
-    "1,NS_NOTIFY_OP,0,0,0,0,0,0,FORMERR,1,0,0,0",
-    "1,NS_NOTIFY_OP,0,0,0,0,0,0,NOTIMP,0,0,0,0",
-    "1,NS_NOTIFY_OP,0,0,0,0,0,0,NOTIMP,1,0,0,0",
-    "1,NS_NOTIFY_OP,0,0,0,0,0,0,NXDOMAIN,1,0,0,0",
-    "1,NS_NOTIFY_OP,0,0,0,0,0,0,REFUSED,1,0,0,0",
-    "1,NS_NOTIFY_OP,0,0,0,0,0,0,SERVFAIL,1,0,0,0",
-    "1,NS_NOTIFY_OP,0,0,0,1,0,0,FORMERR,1,0,0,0",
-    "1,NS_NOTIFY_OP,0,0,0,1,0,0,NOTIMP,0,0,0,0",
-    "1,NS_NOTIFY_OP,0,0,0,1,0,0,NOTIMP,1,0,0,0",
-    "1,NS_NOTIFY_OP,0,0,0,1,0,0,REFUSED,1,0,0,0",    # iq_old20
-    "1,NS_NOTIFY_OP,0,0,0,1,0,0,SERVFAIL,1,0,0,0",
-    "1,NS_NOTIFY_OP,1,0,0,0,0,0,NOTIMP,1,0,0,0",
+    "1,NOTIFY,0,0,0,0,0,0,FORMERR,1,0,0,0",
+    "1,NOTIFY,0,0,0,0,0,0,NOTIMP,0,0,0,0",
+    "1,NOTIFY,0,0,0,0,0,0,NOTIMP,1,0,0,0",
+    "1,NOTIFY,0,0,0,0,0,0,NXDOMAIN,1,0,0,0",
+    "1,NOTIFY,0,0,0,0,0,0,REFUSED,1,0,0,0",
+    "1,NOTIFY,0,0,0,0,0,0,SERVFAIL,1,0,0,0",
+    "1,NOTIFY,0,0,0,1,0,0,FORMERR,1,0,0,0",
+    "1,NOTIFY,0,0,0,1,0,0,NOTIMP,0,0,0,0",
+    "1,NOTIFY,0,0,0,1,0,0,NOTIMP,1,0,0,0",
+    "1,NOTIFY,0,0,0,1,0,0,REFUSED,1,0,0,0",    # iq_old20
+    "1,NOTIFY,0,0,0,1,0,0,SERVFAIL,1,0,0,0",
+    "1,NOTIFY,1,0,0,0,0,0,NOTIMP,1,0,0,0",
     "1,QUERY,1,0,0,0,0,0,NOTIMP,1,0,0,0",
-    "1,NS_NOTIFY_OP,1,0,0,0,0,0,SERVFAIL,1,0,0,0",
+    "1,NOTIFY,1,0,0,0,0,0,SERVFAIL,1,0,0,0",
     "1,IQUERY,0,0,0,0,1,1,NOTIMP,0,0,0,0",
     "1,IQUERY,0,0,0,0,0,0,NOTIMP,0,0,0,0",
     "1,IQUERY,0,0,1,1,1,1,FORMERR,0,0,0,0",
@@@@ -2171,10 +2171,6 @@@@ sub fp2header {
     $header->ad(shift @@list);
     $header->cd(shift @@list);
     $header->rcode(shift @@list);
-    $header->qdcount(shift @@list);
-    $header->ancount(shift @@list);
-    $header->nscount(shift @@list);
-    $header->arcount(shift @@list);
 }
 
 sub probe {
@
