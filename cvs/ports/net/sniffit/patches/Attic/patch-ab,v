head	1.3;
access;
symbols
	OPENBSD_2_7:1.2.0.4
	OPENBSD_2_7_BASE:1.2
	OPENBSD_2_6:1.2.0.2
	OPENBSD_2_6_BASE:1.2
	OPENBSD_2_5:1.1.1.1.0.4
	OPENBSD_2_5_BASE:1.1.1.1
	OPENBSD_2_4:1.1.1.1.0.2
	OPENBSD_2_4_BASE:1.1.1.1
	form_980507:1.1.1.1
	form:1.1.1;
locks; strict;
comment	@# @;


1.3
date	2000.08.30.23.50.30;	author brad;	state dead;
branches;
next	1.2;

1.2
date	99.05.26.14.49.01;	author brad;	state Exp;
branches;
next	1.1;

1.1
date	98.05.07.08.31.50;	author form;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	98.05.07.08.31.50;	author form;	state Exp;
branches;
next	;


desc
@@


1.3
log
@upgrade to sniffit 0.3.7beta + Debian patches
@
text
@--- sniffit.0.3.5.c.orig	Fri Apr 18 05:33:58 1997
+++ sniffit.0.3.5.c	Wed May 26 09:42:33 1999
@@@@ -93,7 +93,9 @@@@
 exit(0); 
 }
 
-void my_exit (void)	{	exit(0);};
+void my_exit (void)	{
+	if(LOGGING=1) stop_logging();
+	exit(0);};
 
 /* DEBUGGING INFO */
 #ifdef DEBUG
@@@@ -411,11 +413,22 @@@@
 	proto=unwrap_packet(sp, info); 
 	if(proto == NO_IP)	return DONT_EXAMINE; /* no use in trying */
 	if(proto == NO_IP_4)	return DONT_EXAMINE; /* no use in trying */
+	if(proto == CORRUPT_IP)
+	  {
+		printf("Suspicious Packet detected... (Split header)\n");
+		return DONT_EXAMINE;
+	  }
 
         memcpy(&iphead,(sp+PROTO_HEAD),sizeof(struct IP_header));
 	so=(unsigned char *)&(iphead.source);
        	dest=(unsigned char *)&(iphead.destination);
 
+	if(info->FRAG_nf!=0)
+	  {
+		printf("Fragment Skipped...\n"); 
+		return DONT_EXAMINE;
+	  }
+
 	if((proto==TCP)&&(PROTOCOLS&F_TCP)) 
 		{
 #ifdef DEBUG_ONSCREEN
@@@@ -1220,6 +1233,9 @@@@
 	proto=unwrap_packet(sp, info);
 	if(proto == NO_IP)	return DONT_EXAMINE; /* no use in trying */
 	if(proto == NO_IP_4)	return DONT_EXAMINE; /* no use in trying */
+	if(proto == CORRUPT_IP) return DONT_EXAMINE; /* no use in trying */
+
+	if(info->FRAG_nf!=0)	return DONT_EXAMINE;
 
 	(*IP_nr_of_packets)++;
 	if(proto==ICMP)  
@


1.2
log
@patch from CyberPsychotic <mlists@@gizmo.kyrnet.kg>
@
text
@@


1.1
log
@Initial revision
@
text
@d1 46
a46 39
*** sniffit.0.3.5.c.orig	Fri Apr 18 16:33:58 1997
--- sniffit.0.3.5.c	Thu May  7 15:02:13 1998
***************
*** 411,421 ****
--- 411,432 ----
  	proto=unwrap_packet(sp, info); 
  	if(proto == NO_IP)	return DONT_EXAMINE; /* no use in trying */
  	if(proto == NO_IP_4)	return DONT_EXAMINE; /* no use in trying */
+ 	if(proto == CORRUPT_IP)
+ 	  {
+ 		printf("Suspicious Packet detected... (Split header)\n");
+ 		return DONT_EXAMINE;
+ 	  }
  
          memcpy(&iphead,(sp+PROTO_HEAD),sizeof(struct IP_header));
  	so=(unsigned char *)&(iphead.source);
         	dest=(unsigned char *)&(iphead.destination);
  
+ 	if(info->FRAG_nf!=0)
+ 	  {
+ 		printf("Fragment Skipped...\n"); 
+ 		return DONT_EXAMINE;
+ 	  }
+ 
  	if((proto==TCP)&&(PROTOCOLS&F_TCP)) 
  		{
  #ifdef DEBUG_ONSCREEN
***************
*** 1220,1225 ****
--- 1231,1239 ----
  	proto=unwrap_packet(sp, info);
  	if(proto == NO_IP)	return DONT_EXAMINE; /* no use in trying */
  	if(proto == NO_IP_4)	return DONT_EXAMINE; /* no use in trying */
+ 	if(proto == CORRUPT_IP) return DONT_EXAMINE; /* no use in trying */
+ 
+ 	if(info->FRAG_nf!=0)	return DONT_EXAMINE;
  
  	(*IP_nr_of_packets)++;
  	if(proto==ICMP)  
@


1.1.1.1
log
@sniffit 0.3.5, TCP/UDP/ICMP packets sniffer
@
text
@@
