head	1.1;
access;
symbols;
locks; strict;
comment	@# @;


1.1
date	2017.05.13.22.27.20;	author stsp;	state Exp;
branches;
next	;
commitid	jtiLTyQuAjkxnjrR;


desc
@@


1.1
log
@Update our very much outdated net/olsrd port to current release 0.9.0.3.
Add patches for rdomain support and a few bug fixes.
Roll the -plugins subpackage into -main, and add an rc.d script.

Lightly tested in Berlin's Freifunk OLSR mesh over ral(4) in IBSS mode.

martin@@ has rescinded maintainership which I am taking over.
ok sthen@@
@
text
@$OpenBSD$

Index: src/olsr_random.h
--- src/olsr_random.h.orig
+++ src/olsr_random.h
@@@@ -9,7 +9,14 @@@@
 
 #define OLSR_RANDOM_MAX INT32_MAX
 
+#if defined(__OpenBSD__)
 static inline long int olsr_random(void) {
+  long int r;
+  arc4random_buf(&r, sizeof(r));
+  return r;
+}
+#else
+static inline long int olsr_random(void) {
   int32_t value;
   int randomFile;
 
@@@@ -32,9 +39,10 @@@@ static inline long int olsr_random(void) {
 
   return abs(value);
 }
+#endif
 
 static inline void olsr_init_random(void) {
-  srandom(time(NULL));
+  srandom(arc4random());
 }
 
 #endif /* _OLSR_RANDOM_H */
@
