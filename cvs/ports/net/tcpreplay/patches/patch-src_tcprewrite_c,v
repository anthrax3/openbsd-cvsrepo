head	1.1;
access;
symbols
	OPENBSD_6_0:1.1.0.4
	OPENBSD_6_0_BASE:1.1
	OPENBSD_5_9:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2016.07.06.10.29.51;	author jasper;	state Exp;
branches
	1.1.2.1;
next	;
commitid	3NlKmS80malHaTNj;

1.1.2.1
date	2016.07.06.10.31.30;	author jasper;	state Exp;
branches;
next	;
commitid	eRl33XrKgbGs7uJ3;


desc
@@


1.1
log
@Fix for CVE-2016-6160; patch from debian

ok nigel@@ (MAINTAINER)
@
text
@$OpenBSD$

CVE-2016-6160
https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=829350

--- src/tcprewrite.c.orig	Fri May  9 19:28:13 2014
+++ src/tcprewrite.c	Wed Jul  6 10:54:06 2016
@@@@ -250,6 +250,8 @@@@ rewrite_packets(tcpedit_t *tcpedit, pcap_t *pin, pcap_
         packetnum++;
         dbgx(2, "packet " COUNTER_SPEC " caplen %d", packetnum, pkthdr.caplen);
 
+        if (pkthdr.caplen > MAXPACKET)
+            errx(-1, "Frame too big, caplen %d exceeds %d", pkthdr.caplen, MAXPACKET);
         /* 
          * copy over the packet so we can pad it out if necessary and
          * because pcap_next() returns a const ptr
@


1.1.2.1
log
@Fix for CVE-2016-6160; patch from debian
@
text
@d1 1
a1 1
$OpenBSD: patch-src_tcprewrite_c,v 1.1 2016/07/06 10:29:51 jasper Exp $
@

