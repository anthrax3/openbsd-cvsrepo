head	1.1;
access;
symbols
	OPENBSD_6_0:1.1.0.28
	OPENBSD_6_0_BASE:1.1
	OPENBSD_5_9:1.1.0.24
	OPENBSD_5_9_BASE:1.1
	OPENBSD_5_8:1.1.0.26
	OPENBSD_5_8_BASE:1.1
	OPENBSD_5_7:1.1.0.22
	OPENBSD_5_7_BASE:1.1
	OPENBSD_5_6:1.1.0.20
	OPENBSD_5_6_BASE:1.1
	OPENBSD_5_5:1.1.0.18
	OPENBSD_5_5_BASE:1.1
	OPENBSD_5_4:1.1.0.16
	OPENBSD_5_4_BASE:1.1
	OPENBSD_5_3:1.1.0.14
	OPENBSD_5_3_BASE:1.1
	OPENBSD_5_2:1.1.0.12
	OPENBSD_5_2_BASE:1.1
	OPENBSD_5_1_BASE:1.1
	OPENBSD_5_1:1.1.0.10
	OPENBSD_5_0:1.1.0.8
	OPENBSD_5_0_BASE:1.1
	OPENBSD_4_9:1.1.0.6
	OPENBSD_4_9_BASE:1.1
	OPENBSD_4_8:1.1.0.4
	OPENBSD_4_8_BASE:1.1
	OPENBSD_4_7:1.1.0.2
	OPENBSD_4_7_BASE:1.1;
locks; strict;
comment	@# @;


1.1
date	2009.08.29.22.14.43;	author kurt;	state Exp;
branches;
next	;


desc
@@


1.1
log
@Various bug fixes:
- copy and paste into msg windows caused html to be passed on to the
icb-server.
- implemented keepalive so that my connection doesn't drop when behind
crapy firewalls that timeout idle tcp connections quickly.
- fixed a crash in the auto reconnect code path where "group" is not in the
hash table in icb_join_chat().
- implemented a defensive programming check in icb_send() to prevent other
NULL fields from crashing pidgin.
- fixed some amd64 warnings.

Maintainer timeout
@
text
@--- icb.h.orig	2007-05-05 12:39:23.000000000 -0400
+++ icb.h	2009-08-12 11:28:39.000000000 -0400
@@@@ -64,8 +64,9 @@@@
 #define ICB_CMD_COMMAND       'h'
 #define ICB_CMD_COMMAND_RESP  'i'
 #define ICB_CMD_PROTO_VERSION 'j'
-#define ICB_CMD_MSG           'm'
+#define ICB_CMD_PONG          'm'
 #define ICB_CMD_WHO           'w'
+#define ICB_CMD_PING          'l'
 
 #define ICB_SERVICES_NAME	"server"
 
@@@@ -117,6 +118,7 @@@@ typedef struct {
 	int          chat_id;
 	enum wl_mode wl;		/* What to do with wl response */
 	char         wl_nick[256];	/* What to do with wl response */
+	time_t	     sr_time;		/* time of last send/receive */
 #if 0
 	GString     *motd;		/* MOTD.  First bunch of "co"s sent by server right after
 					 * user logs in.
@
