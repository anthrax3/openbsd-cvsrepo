head	1.3;
access;
symbols
	OPENBSD_6_0:1.2.0.2
	OPENBSD_6_0_BASE:1.2;
locks; strict;
comment	@# @;


1.3
date	2016.10.14.12.48.55;	author sthen;	state Exp;
branches;
next	1.2;
commitid	pXrhZsM4ju8rWl8K;

1.2
date	2016.04.18.09.36.03;	author sthen;	state Exp;
branches;
next	1.1;
commitid	1Dw0xr1DI7rlNsEV;

1.1
date	2016.04.05.13.39.49;	author sthen;	state Exp;
branches;
next	;
commitid	Ff2kg7om6YvV5Zqi;


desc
@@


1.3
log
@update to librenms-201609
@
text
@$OpenBSD: patch-includes_polling_core_inc_php,v 1.2 2016/04/18 09:36:03 sthen Exp $

OpenBSD snmpd(8)'s snmpEngineTime.0 is bogus

--- includes/polling/core.inc.php.orig	Fri Oct 14 13:25:22 2016
+++ includes/polling/core.inc.php	Fri Oct 14 13:27:33 2016
@@@@ -44,7 +44,7 @@@@ if (empty($uptime)) {
 }//end if
 
 if ($device["os"] != "edgeswitch") {
-    if ($snmp_uptime > $uptime && is_numeric($snmp_uptime)) {
+    if ($snmp_uptime > $uptime && is_numeric($snmp_uptime) && $snmp_uptime < 1000000000) {
         $uptime = $snmp_uptime;
         d_echo('hrSystemUptime or sysUpTime looks like to have rolled, using snmpEngineTime instead');
     }
@


1.2
log
@update to librenms-201604
@
text
@d1 1
a1 1
$OpenBSD: patch-includes_polling_core_inc_php,v 1.1 2016/04/05 13:39:49 sthen Exp $
d5 2
a6 2
--- includes/polling/core.inc.php.orig	Mon Apr 18 10:20:49 2016
+++ includes/polling/core.inc.php	Mon Apr 18 10:20:56 2016
a7 1
     }//end if
d10 6
a15 5
-if ($snmp_uptime > $uptime && is_numeric($snmp_uptime)) {
+if ($snmp_uptime > $uptime && is_numeric($snmp_uptime) && $snmp_uptime < 1000000000) {
     $uptime = $snmp_uptime;
     d_echo('hrSystemUptime or sysUpTime looks like to have rolled, using snmpEngineTime instead');
 }
@


1.1
log
@fix doubled word and talk about newsyslog.conf in README
workaround openbsd snmpd(8)'s broken snmpEngineTime.0 implementation
@
text
@d1 1
a1 1
$OpenBSD$
d5 3
a7 3
--- includes/polling/core.inc.php.orig	Tue Apr  5 14:33:28 2016
+++ includes/polling/core.inc.php	Tue Apr  5 14:36:03 2016
@@@@ -42,7 +42,7 @@@@ if (empty($uptime)) {
@

