head	1.2;
access;
symbols
	OPENBSD_6_2:1.2.0.2
	OPENBSD_6_2_BASE:1.2;
locks; strict;
comment	@# @;


1.2
date	2017.07.30.17.05.54;	author sthen;	state Exp;
branches;
next	1.1;
commitid	UjZBQycSePTTk9Ux;

1.1
date	2017.06.25.22.34.36;	author sthen;	state Exp;
branches;
next	;
commitid	VTTaLkaKv1p265Re;


desc
@@


1.2
log
@update to LibreNMS 1.30, including fdb table searches on many switches,
yaml-based sensor definitions, suport for many additional sensor types,
and more.  https://github.com/librenms/librenms/releases
@
text
@$OpenBSD: patch-includes_process_config_inc_php,v 1.1 2017/06/25 22:34:36 sthen Exp $

sql-schema/079.sql which will have been added on some systems had a bad
path for rrdtool until patched. In older librenms versions, rrdtool path from
the config/php files took priority, which is more suitable for a packages-based
install, but in newer ones (without patching) it comes from the db.

Index: includes/process_config.inc.php
--- includes/process_config.inc.php.orig
+++ includes/process_config.inc.php
@@@@ -27,13 +27,9 @@@@ if (empty($config['email_from'])) {
     $config['email_from'] = '"' . $config['project_name'] . '" <' . $config['email_user'] . '@@' . php_uname('n') . '>';
 }
 
-// We need rrdtool so ensure it's set
-if (empty($config['rrdtool'])) {
-    $config['rrdtool'] = '/usr/bin/rrdtool';
-}
-if (empty($config['rrdtool_version'])) {
-    $config['rrdtool_version'] = 1.4;
-}
+// Force rrdtool config; it's under packages control.
+$config['rrdtool'] = '/usr/local/bin/rrdtool';
+$config['rrdtool_version'] = 1.6;
 
 if ($config['secure_cookies']) {
     ini_set('session.cookie_secure', 1);
@


1.1
log
@update to librenms-1.29
@
text
@d1 6
a6 1
$OpenBSD$
d11 3
a13 1
@@@@ -29,8 +29,8 @@@@ if (empty($config['email_from'])) {
d15 2
a16 2
 // We need rrdtool so ensure it's set
 if (empty($config['rrdtool'])) {
d18 2
a19 3
+    $config['rrdtool'] = '/usr/local/bin/rrdtool';
 }
 if (empty($config['rrdtool_version'])) {
d21 7
a27 2
+    $config['rrdtool_version'] = 1.6;
 }
@

