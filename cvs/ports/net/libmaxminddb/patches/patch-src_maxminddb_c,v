head	1.1;
access;
symbols;
locks; strict;
comment	@# @;


1.1
date	2017.06.04.10.57.59;	author espie;	state Exp;
branches;
next	;
commitid	ctwRHAtksTEf04Qf;


desc
@@


1.1
log
@remove the problematic shit that doesn't compile with our old gcc
because the combo of -fms-extensions -std=c99

okay fcambus@@
@
text
@$OpenBSD$

Index: src/maxminddb.c
--- src/maxminddb.c.orig
+++ src/maxminddb.c
@@@@ -1582,7 +1582,7 @@@@ LOCAL int decode_one(MMDB_s *mmdb, uint32_t offset,
         free(string);
 #endif
     } else if (type == MMDB_DATA_TYPE_BYTES) {
-        entry_data->bytes = &mem[offset];
+        entry_data->u.bytes = &mem[offset];
         entry_data->data_size = size;
     }
 
@@@@ -2025,7 +2025,7 @@@@ LOCAL MMDB_entry_data_list_s *dump_entry_data_list(
     case MMDB_DATA_TYPE_BYTES:
         {
             char *hex_string =
-                bytes_to_hex((uint8_t *)entry_data_list->entry_data.bytes,
+                bytes_to_hex((uint8_t *)entry_data_list->entry_data.u.bytes,
                              entry_data_list->entry_data.data_size);
             if (NULL == hex_string) {
                 *status = MMDB_OUT_OF_MEMORY_ERROR;
@
