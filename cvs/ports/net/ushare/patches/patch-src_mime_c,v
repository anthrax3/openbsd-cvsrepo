head	1.3;
access;
symbols
	OPENBSD_6_0:1.3.0.16
	OPENBSD_6_0_BASE:1.3
	OPENBSD_5_9:1.3.0.12
	OPENBSD_5_9_BASE:1.3
	OPENBSD_5_8:1.3.0.14
	OPENBSD_5_8_BASE:1.3
	OPENBSD_5_7:1.3.0.10
	OPENBSD_5_7_BASE:1.3
	OPENBSD_5_6:1.3.0.8
	OPENBSD_5_6_BASE:1.3
	OPENBSD_5_5:1.3.0.6
	OPENBSD_5_5_BASE:1.3
	OPENBSD_5_4:1.3.0.4
	OPENBSD_5_4_BASE:1.3
	OPENBSD_5_3:1.3.0.2
	OPENBSD_5_3_BASE:1.3
	OPENBSD_5_2:1.1.1.1.0.10
	OPENBSD_5_2_BASE:1.1.1.1
	OPENBSD_5_1_BASE:1.1.1.1
	OPENBSD_5_1:1.1.1.1.0.8
	OPENBSD_5_0:1.1.1.1.0.6
	OPENBSD_5_0_BASE:1.1.1.1
	OPENBSD_4_9:1.1.1.1.0.4
	OPENBSD_4_9_BASE:1.1.1.1
	OPENBSD_4_8:1.1.1.1.0.2
	OPENBSD_4_8_BASE:1.1.1.1
	ajacoutot_20100322:1.1.1.1
	ajacoutot:1.1.1;
locks; strict;
comment	@# @;


1.3
date	2012.11.07.14.53.59;	author dcoppa;	state Exp;
branches;
next	1.2;

1.2
date	2012.11.06.11.50.04;	author dcoppa;	state Exp;
branches;
next	1.1;

1.1
date	2010.03.22.22.26.59;	author ajacoutot;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2010.03.22.22.26.59;	author ajacoutot;	state Exp;
branches;
next	;


desc
@@


1.3
log
@Additional bugfixes and add comments to patches
@
text
@$OpenBSD: patch-src_mime_c,v 1.2 2012/11/06 11:50:04 dcoppa Exp $
--- src/mime.c.orig	Sun Dec  9 14:03:36 2007
+++ src/mime.c	Wed Nov  7 14:33:56 2012
@@@@ -19,6 +19,7 @@@@
  * Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.
  */
 
+#include <stdio.h>
 #include <stdlib.h>
 #include <string.h>
 
@@@@ -53,10 +54,11 @@@@ const struct mime_type_t MIME_Type_List[] = {
   { "mpeg2", UPNP_VIDEO, "http-get:*:video/mpeg2:"},
   { "m4v",   UPNP_VIDEO, "http-get:*:video/mp4:"},
   { "m4p",   UPNP_VIDEO, "http-get:*:video/mp4:"},
+  { "mp4",   UPNP_VIDEO, "http-get:*:video/mp4:"},
   { "mp4ps", UPNP_VIDEO, "http-get:*:video/x-nerodigital-ps:"},
   { "ts",    UPNP_VIDEO, "http-get:*:video/mpeg2:"},
   { "ogm",   UPNP_VIDEO, "http-get:*:video/mpeg:"},
-  { "mkv",   UPNP_VIDEO, "http-get:*:video/mpeg:"},
+  { "mkv",   UPNP_VIDEO, "http-get:*:video/x-matroska:"},
   { "rmvb",  UPNP_VIDEO, "http-get:*:video/mpeg:"},
   { "mov",   UPNP_VIDEO, "http-get:*:video/quicktime:"},
   { "hdmov", UPNP_VIDEO, "http-get:*:video/quicktime:"},
@@@@ -79,7 +81,6 @@@@ const struct mime_type_t MIME_Type_List[] = {
   { "mp1",  UPNP_AUDIO, "http-get:*:audio/mp1:"},
   { "mp2",  UPNP_AUDIO, "http-get:*:audio/mp2:"},
   { "mp3",  UPNP_AUDIO, "http-get:*:audio/mpeg:"},
-  { "mp4",  UPNP_AUDIO, "http-get:*:audio/mp4:"},
   { "m4a",  UPNP_AUDIO, "http-get:*:audio/mp4:"},
   { "ogg",  UPNP_AUDIO, "http-get:*:audio/x-ogg:"},
   { "wav",  UPNP_AUDIO, "http-get:*:audio/wav:"},
@@@@ -144,7 +145,7 @@@@ char *mime_get_protocol (struct mime_type_t *mime)
   if (!mime)
     return NULL;
 
-  sprintf (protocol, mime->mime_protocol);
+  sprintf (protocol, "%s", mime->mime_protocol);
   strcat (protocol, "*");
   return strdup (protocol);
 }
@


1.2
log
@Unbreak with newer libupnp; patch stolen from Arch Linux

"if it works, go ahead" ajacoutot@@
@
text
@d1 1
a1 1
$OpenBSD: patch-src_mime_c,v 1.1.1.1 2010/03/22 22:26:59 ajacoutot Exp $
d3 4
a6 2
+++ src/mime.c	Fri Nov  2 16:10:37 2012
@@@@ -21,6 +21,7 @@@@
d8 1
a10 1
+#include <stdio.h>
d12 5
a16 3
 #include "mime.h"
 #include "ushare.h"
@@@@ -56,7 +57,7 @@@@ const struct mime_type_t MIME_Type_List[] = {
d25 17
@


1.1
log
@Initial revision
@
text
@d1 12
a12 4
$OpenBSD$
--- src/mime.c.orig	Tue Feb  9 16:55:15 2010
+++ src/mime.c	Tue Feb  9 16:55:33 2010
@@@@ -56,7 +56,7 @@@@ const struct mime_type_t MIME_Type_List[] = {
@


1.1.1.1
log
@Import ushare-1.1a

uShare is a UPnP (TM) A/V & DLNA Media Server. It implements the server
component that provides UPnP media devices with information on available
multimedia files. uShare uses the built-in http server of libupnp to
stream the files to clients.

GeeXboX uShare is able to provide access to both images, videos, music
or playlists files (see below for a complete file format support list
It does not act as an UPnP Media Adaptor and thus, can't transcode
streams to fit the client requirements.

Note that DLNA support is not enabled on OpenBSD.
@
text
@@
