head	1.31;
access;
symbols
	OPENBSD_6_1:1.31.0.6
	OPENBSD_6_1_BASE:1.31
	OPENBSD_6_0:1.31.0.4
	OPENBSD_6_0_BASE:1.31
	OPENBSD_5_9:1.31.0.2
	OPENBSD_5_9_BASE:1.31
	OPENBSD_5_8:1.29.0.4
	OPENBSD_5_8_BASE:1.29
	OPENBSD_5_7:1.27.0.6
	OPENBSD_5_7_BASE:1.27
	OPENBSD_5_6:1.27.0.4
	OPENBSD_5_6_BASE:1.27
	OPENBSD_5_5:1.27.0.2
	OPENBSD_5_5_BASE:1.27
	OPENBSD_5_4:1.24.0.2
	OPENBSD_5_4_BASE:1.24
	OPENBSD_5_3:1.22.0.6
	OPENBSD_5_3_BASE:1.22
	OPENBSD_5_2:1.22.0.4
	OPENBSD_5_2_BASE:1.22
	OPENBSD_5_1_BASE:1.22
	OPENBSD_5_1:1.22.0.2
	OPENBSD_5_0:1.20.0.2
	OPENBSD_5_0_BASE:1.20
	OPENBSD_4_9:1.18.0.2
	OPENBSD_4_9_BASE:1.18
	OPENBSD_4_8:1.16.0.2
	OPENBSD_4_8_BASE:1.16
	OPENBSD_4_7:1.10.0.2
	OPENBSD_4_7_BASE:1.10
	OPENBSD_4_6:1.7.0.2
	OPENBSD_4_6_BASE:1.7
	sthen_20090417:1.1.1.1
	sthen:1.1.1;
locks; strict;
comment	@# @;


1.31
date	2015.12.30.14.10.50;	author sthen;	state Exp;
branches;
next	1.30;
commitid	xoPjzt4PZcDzJ3ZU;

1.30
date	2015.12.03.21.24.31;	author sthen;	state Exp;
branches;
next	1.29;
commitid	qh8BBe4z9PLvLPKf;

1.29
date	2015.07.06.14.09.46;	author sthen;	state Exp;
branches
	1.29.4.1;
next	1.28;
commitid	4RuWmYYR9c2isfra;

1.28
date	2015.05.22.11.31.17;	author ajacoutot;	state Exp;
branches;
next	1.27;
commitid	2khjHXfpTaOuNVcx;

1.27
date	2014.01.14.00.18.35;	author jca;	state Exp;
branches;
next	1.26;

1.26
date	2014.01.13.23.52.34;	author sthen;	state Exp;
branches;
next	1.25;

1.25
date	2014.01.01.20.46.28;	author naddy;	state Exp;
branches;
next	1.24;

1.24
date	2013.04.24.09.33.41;	author sthen;	state Exp;
branches;
next	1.23;

1.23
date	2013.03.11.11.35.56;	author espie;	state Exp;
branches;
next	1.22;

1.22
date	2012.01.16.22.33.54;	author sthen;	state Exp;
branches;
next	1.21;

1.21
date	2011.09.05.17.13.56;	author sthen;	state Exp;
branches;
next	1.20;

1.20
date	2011.07.17.09.56.04;	author sthen;	state Exp;
branches;
next	1.19;

1.19
date	2011.03.21.09.46.31;	author sthen;	state Exp;
branches;
next	1.18;

1.18
date	2010.11.19.22.31.38;	author espie;	state Exp;
branches;
next	1.17;

1.17
date	2010.10.18.18.36.57;	author espie;	state Exp;
branches;
next	1.16;

1.16
date	2010.07.18.10.37.45;	author sthen;	state Exp;
branches;
next	1.15;

1.15
date	2010.05.29.20.20.17;	author sthen;	state Exp;
branches;
next	1.14;

1.14
date	2010.05.01.21.17.38;	author sthen;	state Exp;
branches;
next	1.13;

1.13
date	2010.04.18.21.34.16;	author sthen;	state Exp;
branches;
next	1.12;

1.12
date	2010.04.03.23.41.08;	author sthen;	state Exp;
branches;
next	1.11;

1.11
date	2010.03.21.09.36.19;	author sthen;	state Exp;
branches;
next	1.10;

1.10
date	2010.02.26.18.46.26;	author sthen;	state Exp;
branches;
next	1.9;

1.9
date	2009.12.26.08.49.08;	author benoit;	state Exp;
branches;
next	1.8;

1.8
date	2009.11.19.01.06.07;	author sthen;	state Exp;
branches;
next	1.7;

1.7
date	2009.05.26.14.13.22;	author sthen;	state Exp;
branches;
next	1.6;

1.6
date	2009.05.22.23.51.33;	author sthen;	state Exp;
branches;
next	1.5;

1.5
date	2009.05.22.23.43.58;	author sthen;	state Exp;
branches;
next	1.4;

1.4
date	2009.05.22.23.42.32;	author sthen;	state Exp;
branches;
next	1.3;

1.3
date	2009.04.29.01.39.15;	author sthen;	state Exp;
branches;
next	1.2;

1.2
date	2009.04.29.00.51.23;	author sthen;	state Exp;
branches;
next	1.1;

1.1
date	2009.04.17.17.56.50;	author sthen;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2009.04.17.17.56.50;	author sthen;	state Exp;
branches;
next	;

1.29.4.1
date	2015.12.30.14.11.26;	author sthen;	state Exp;
branches;
next	;
commitid	4e5Iw2p6cnu2NDha;


desc
@@


1.31
log
@update to newer RTMPDump snapshot and K-S-V patch, fixes some vulnerabilities

AMFProp_GetObject must make sure the prop is actually an object
Obsolete RTMPPacket_Free() call left over from original C++ to C rewrite
Potential integer overflow in RTMPPacket_Alloc()
Ignore zero-length packets
Additional decode input size checks
@
text
@# $OpenBSD: Makefile,v 1.30 2015/12/03 21:24:31 sthen Exp $

SHARED_LIBS =		rtmp 1.1

COMMENT =		dump RTMP media streams

# also see VERSION in MAKE_FLAGS below
DISTNAME =		rtmpdump-2.4.20151223
PATCHFILES =		rtmpdump-KSV-20151215.patch.gz

CATEGORIES =		net

HOMEPAGE =		http://rtmpdump.mplayerhq.hu/

# tools GPLv2+, librtmp LGPLv2.1+
PERMIT_PACKAGE_CDROM =	No
PERMIT_PACKAGE_FTP =	Yes

WANTLIB =		c crypto m pthread ssl z

# packaged from git://git.ffmpeg.org/rtmpdump : fa8646da
# and patch from https://github.com/K-S-V/Scripts/releases/, see
# http://stream-recorder.com/forum/customized-rtmpdump-binaries-patch-file-t16103.html
MASTER_SITES =		https://spacehopper.org/mirrors/

MAKE_FLAGS =		CC="${CC}" XCFLAGS="${CFLAGS}" OPT= \
			THREADLIB=-pthread SO_VERSION=${LIBrtmp_VERSION} \
			VERSION="v2.4-git-fa8646da\ KSV-2015-12-15"

NO_TEST =		Yes

post-install:
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/rtmpdump
	cd ${WRKBUILD}; \
	  ${INSTALL_DATA} README COPYING ChangeLog ${PREFIX}/share/doc/rtmpdump

.include <bsd.port.mk>
@


1.30
log
@switch my distfiles mirror to https
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2015/07/06 14:09:46 sthen Exp $
d3 1
a3 1
SHARED_LIBS =		rtmp 1.0
d7 3
a9 3
DISTNAME =		rtmpdump-2.4pl8
PATCHFILES =		rtmpdump-KSV-20150505.patch.gz
WRKDIST =		${WRKDIR}/rtmpdump
d21 1
a21 1
# packaged from git://git.ffmpeg.org/rtmpdump : a107cef9
d28 1
a28 1
			VERSION="v2.4-git-a107cef9\ KSV-2015-05-05"
@


1.29
log
@update to newer rtmpdump checkout, and add KSV patchset (better resume,
support >4GB, etc).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2015/05/22 11:31:17 ajacoutot Exp $
d24 1
a24 1
MASTER_SITES =		http://spacehopper.org/mirrors/
@


1.29.4.1
log
@MFC: update to newer RTMPDump snapshot and K-S-V patch, fixes some vulnerabilities

AMFProp_GetObject must make sure the prop is actually an object
Obsolete RTMPPacket_Free() call left over from original C++ to C rewrite
Potential integer overflow in RTMPPacket_Alloc()
Ignore zero-length packets
Additional decode input size checks
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2015/12/30 14:10:50 sthen Exp $
d3 1
a3 1
SHARED_LIBS =		rtmp 1.1
d7 3
a9 3
# also see VERSION in MAKE_FLAGS below
DISTNAME =		rtmpdump-2.4.20151223
PATCHFILES =		rtmpdump-KSV-20151215.patch.gz
d21 1
a21 1
# packaged from git://git.ffmpeg.org/rtmpdump : fa8646da
d24 1
a24 1
MASTER_SITES =		https://spacehopper.org/mirrors/
d28 1
a28 1
			VERSION="v2.4-git-fa8646da\ KSV-2015-12-15"
@


1.28
log
@"/usr/local/lib/pkgconfig/" is part of mtree(8).
Packages should not own this dir to prevent its deletion or a warning that it
cannot be removed because it's not empty at pkg_delete(1) time.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2014/01/14 00:18:35 jca Exp $
d7 2
a8 2
DISTNAME =		rtmpdump-2.4pl7
REVISION =		1
d19 1
a19 1
WANTLIB =		c crypto pthread ssl z
d21 3
a23 1
# packaged from git://git.ffmpeg.org/rtmpdump : dc76f0a846
d27 2
a28 1
			THREADLIB=-pthread SO_VERSION=${LIBrtmp_VERSION}
@


1.27
log
@Kill librtmp's soname and prevent lib symlink creation.  ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2014/01/13 23:52:34 sthen Exp $
d8 1
a8 1
REVISION =		0
@


1.26
log
@update to a newer rtmpdump snapshot
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2014/01/01 20:46:28 naddy Exp $
d8 1
@


1.25
log
@Drop USE_GROFF since groff and mandoc produce identical output.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2013/04/24 09:33:41 sthen Exp $
d3 1
a3 1
SHARED_LIBS =		rtmp 0.0
d7 1
a7 1
DISTNAME =		rtmpdump-2.4pl5
d20 1
a20 1
# packaged from git://git.ffmpeg.org/rtmpdump : 3a1e20c08
@


1.24
log
@update to a newer snapshot
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2013/03/11 11:35:56 espie Exp $
a25 1
USE_GROFF =		Yes
@


1.23
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2012/01/16 22:33:54 sthen Exp $
d7 2
a8 1
DISTNAME =		rtmpdump-2.4pl2
d20 1
a20 1
# packaged from git://git.ffmpeg.org/rtmpdump
@


1.22
log
@update to a newer snapshot of rtmpdump
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2011/09/05 17:13:56 sthen Exp $
a15 2
PERMIT_DISTFILES_CDROM =No
PERMIT_DISTFILES_FTP =	Yes
d26 1
a26 1
NO_REGRESS =		Yes
@


1.21
log
@update to a newer git checkout of rtmpdump

- fixes include a casting issue resulting in invalid bw response,
a potential memleak, and a double free in RTMP_Close()
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2011/07/17 09:56:04 sthen Exp $
d7 1
a7 2
DISTNAME =		rtmpdump-2.4pl1
EXTRACT_SUFX =		.tgz
@


1.20
log
@Update to rtmpdump 2.4, packaged from git. From Nigel Taylor.
Supports RTMPE type 9 handshakes, used by some youtube streams (e.g. UK 4od)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2011/03/21 09:46:31 sthen Exp $
d7 1
a7 1
DISTNAME =		rtmpdump-2.4
d22 1
a22 1
#MASTER_SITES =		${HOMEPAGE}download/
d25 2
a26 1
MAKE_FLAGS =		CC="${CC}" XCFLAGS="${CFLAGS}" OPT= THREADLIB=-pthread SO_VERSION=${LIBrtmp_VERSION}
@


1.19
log
@- handle newer rtmp servers; from upstream SVN via Nigel Taylor
- fix the inclusion order of network headers (netinet/in.h before arpa/inet.h)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2010/11/19 22:31:38 espie Exp $
d7 1
a7 2
DISTNAME =		rtmpdump-2.3
REVISION =		0
d22 2
a23 1
MASTER_SITES =		${HOMEPAGE}download/
d25 1
a25 1
MAKE_FLAGS =		CC="${CC}" XCFLAGS="${CFLAGS}" OPT= THREADLIB=-pthread
a28 4

do-configure:
	perl -pi -e 's,so\.0,so.${LIBrtmp_VERSION},g' \
	    ${WRKSRC}/librtmp/Makefile
@


1.18
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2010/10/18 18:36:57 espie Exp $
d8 1
@


1.17
log
@USE_GROFF=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2010/07/18 10:37:45 sthen Exp $
d26 1
a26 1
USE_GROFF =	Yes
@


1.16
log
@Update to 2.3 (notably adding ping/pong support and building a library).
Update DESCR while there.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2010/05/29 20:20:17 sthen Exp $
d26 1
@


1.15
log
@update to 2.2e
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.14 2010/05/01 21:17:38 sthen Exp $
d7 2
a8 2
DISTNAME =		rtmpdump-2.2e
#EXTRACT_SUFX =		.tgz
d28 5
a32 1
do-install:
a34 3
	  ${INSTALL_PROGRAM} rtmpdump rtmpsrv rtmpsuck rtmpgw ${PREFIX}/bin; \
	  ${INSTALL_MAN} rtmpdump.1 ${PREFIX}/man/man1; \
	  ${INSTALL_MAN} rtmpgw.8 ${PREFIX}/man/man8; \
@


1.14
log
@update to 2.2d
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2010/04/18 21:34:16 sthen Exp $
d5 2
a6 2
DISTNAME =		rtmpdump-2.2d
EXTRACT_SUFX =		.tgz
a22 1
ALL_TARGET =		posix
@


1.13
log
@update to 2.2c
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2010/04/03 23:41:08 sthen Exp $
d5 2
a6 1
DISTNAME =		rtmpdump-2.2c
@


1.12
log
@update to 2.2b
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2010/03/21 09:36:19 sthen Exp $
d5 1
a5 1
DISTNAME =		rtmpdump-2.2b
@


1.11
log
@update to 2.2a and remove most of the patches in favour of MAKE_FLAGS.
with J.C. Roberts
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2010/02/26 18:46:26 sthen Exp $
d5 1
a5 1
DISTNAME =		rtmpdump-2.2a
@


1.10
log
@- update to 2.1d, fixes a corruption problem with resume
- sync port Makefile with flvstreamer

ok jasper@@, earlier version ok benoit@@
(reminder, ports is not fully open, do not commit without specific permission)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2009/12/26 08:49:08 benoit Exp $
d5 1
a5 1
DISTNAME =		rtmpdump-2.1d
d11 1
a11 1
# GPLv2+
d17 1
a17 1
WANTLIB =		c crypto pthread z
d19 1
a19 1
MASTER_SITES =		${HOMEPAGE}/download/
d21 2
a22 2
MAKE_FLAGS =		CC="${CC}" XCFLAGS="${CFLAGS}"
ALL_TARGET =		linux
d29 3
a31 1
	  ${INSTALL_PROGRAM} rtmpdump rtmpsrv rtmpsuck streams ${PREFIX}/bin; \
@


1.9
log
@- update rtmpdump to 2.0
- update patches
- update WANTLIB and MASTER_SITES

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2009/11/19 01:06:07 sthen Exp $
d5 2
a6 2
DISTNAME =		rtmpdump-2.0
PKGNAME =		${DISTNAME:S/-v/-/}
d17 1
a17 1
WANTLIB =		c crypto
d21 1
a21 1
MAKE_FLAGS =		CC="${CC}" CFLAGS="${CFLAGS}"
d27 4
a30 1
	${INSTALL_PROGRAM} ${WRKBUILD}/rtmpdump ${PREFIX}/bin
@


1.8
log
@update to 1.9, homepage is now rtmpdump.mplayerhq.hu
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2009/05/26 14:13:22 sthen Exp $
d5 1
a5 2
DISTNAME =		rtmpdump-1.9
EXTRACT_SUFX =		.tgz
d7 1
d9 1
a9 1
CATEGORIES =		net
d17 1
a17 1
WANTLIB =		c m stdc++ crypto
d19 1
a19 2
HOMEPAGE =		http://rtmpdump.mplayerhq.hu/
MASTER_SITES =		${HOMEPAGE}
d21 1
a21 1
MAKE_FLAGS +=		CXX="${CXX}" CXXFLAGS="${CXXFLAGS}"
@


1.7
log
@update to 1.6 (rolling in several patches), and new MASTER_SITES.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2009/05/22 23:51:33 sthen Exp $
d5 2
a6 1
DISTNAME =		rtmpdump-v1.6
d17 1
a17 1
WANTLIB =		c m stdc++ crypto ssl
d19 2
a20 4
MASTER_SITES =		http://lkcl.net/rtmp/ \
			http://downloads.sehe.nl/lkcl.net/rtmp/

WRKDIST =		${WRKDIR}/rtmpdump
d23 1
@


1.6
log
@PERMIT_*_CDROM=no probably makes sense too.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2009/05/22 23:43:58 sthen Exp $
d5 2
a6 2
DISTNAME =		rtmpdump-v1.5
PKGNAME =		${DISTNAME:S/-v/-/}p1
d18 2
a19 2
MASTER_SITES =		http://spacehopper.org/mirrors/ \
			${MASTER_SITE_SOURCEFORGE:=rtmpdump/}
@


1.5
log
@..and remove HOMEPAGE, so bump PKGNAME. pointed out by Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2009/05/22 23:42:32 sthen Exp $
d11 1
a11 1
PERMIT_PACKAGE_CDROM =	Yes
d13 1
a13 1
PERMIT_DISTFILES_CDROM =Yes
@


1.4
log
@mirror.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2009/04/29 01:39:15 sthen Exp $
d6 1
a6 1
PKGNAME =		${DISTNAME:S/-v/-/}p0
a8 2

HOMEPAGE =		http://sourceforge.net/projects/rtmpdump/
@


1.3
log
@a chunk of diff can go, upstream took a slightly different version
of this big-endian fix that also works. bump package.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2009/04/29 00:51:23 sthen Exp $
d20 3
a22 1
MASTER_SITES =		${MASTER_SITE_SOURCEFORGE:=rtmpdump/}
@


1.2
log
@update to 1.5, based on a diff from David Cathcart, adds live stream
dumping and rtmpe.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2009/04/17 17:56:50 sthen Exp $
d6 1
a6 1
PKGNAME =		${DISTNAME:S/-v/-/}
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.template,v 1.55 2008/08/23 15:28:00 ajacoutot Exp $
d5 1
a5 1
DISTNAME =		rtmpdump-v1.4
d18 1
a18 1
WANTLIB =		c m stdc++
@


1.1.1.1
log
@import rtmpdump, based on a ports@@ post from David Cathcart, with BE fixes
and tweaks by myself.

A small dumper for media content streamed over the RTMP protocol.
Supplying an rtmp url will result in a dumped flv file, which can be
played/transcoded using ffmpeg/mplayer, etc.
@
text
@@
