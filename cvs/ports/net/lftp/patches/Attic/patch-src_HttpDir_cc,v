head	1.1;
access;
symbols
	OPENBSD_3_3:1.1.0.4
	OPENBSD_3_4:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2003.12.16.04.07.05;	author margarida;	state dead;
branches
	1.1.2.1
	1.1.4.1;
next	;

1.1.2.1
date	2003.12.16.04.07.05;	author margarida;	state Exp;
branches;
next	;

1.1.4.1
date	2003.12.16.04.08.37;	author margarida;	state Exp;
branches;
next	;


desc
@@


1.1
log
@file patch-src_HttpDir_cc was initially added on branch OPENBSD_3_4.
@
text
@@


1.1.4.1
log
@Security fix:
lftp has been reported prone to an undisclosed HTML parsing vulnerability.
Although unconfirmed it has been conjectured that this issue is likely
exploitable, so that when malicious HTML is handled by the affected client,
arbitrary code execution may occur in the context of the user running lftp.
@
text
@a0 21
$OpenBSD$
--- src/HttpDir.cc.orig	Thu Dec 20 14:59:49 2001
+++ src/HttpDir.cc	Mon Dec 15 22:51:13 2003
@@@@ -349,7 +349,7 @@@@ static bool try_netscape_proxy(file_info
       debug("Netscape-Proxy 2.53 listing matched");
       return true;
    }
-   n=sscanf(str,"%3s %3s %d %2d:%2d:%2d %4d %s",
+   n=sscanf(str,"%3s %3s %d %2d:%2d:%2d %4d %30s",
 	    week_day,info.month_name,&info.day,
 	    &info.hour,&info.minute,&info.second,&info.year,info.size_str);
    if(n==7 || (n==8 && !is_ascii_digit(info.size_str[0])))
@@@@ -367,7 +367,7 @@@@ static bool try_squid_eplf(file_info &in
    info.clear();
 
    char week_day[4];
-   int n=sscanf(str,"%3s %3s %d %2d:%2d:%2d %4d %s",
+   int n=sscanf(str,"%3s %3s %d %2d:%2d:%2d %4d %30s",
 	    week_day,info.month_name,&info.day,
 	    &info.hour,&info.minute,&info.second,&info.year,info.size_str);
    if(n==8) // maybe squid's EPLF listing.
@


1.1.2.1
log
@Security fix:
lftp has been reported prone to an undisclosed HTML parsing vulnerability.
Although unconfirmed it has been conjectured that this issue is likely
exploitable, so that when malicious HTML is handled by the affected client,
arbitrary code execution may occur in the context of the user running lftp.
@
text
@a0 21
$OpenBSD$
--- src/HttpDir.cc.orig	2003-04-15 07:26:32.000000000 -0400
+++ src/HttpDir.cc	2003-12-15 18:13:38.000000000 -0500
@@@@ -354,7 +354,7 @@@@ static bool try_netscape_proxy(file_info
       debug("Netscape-Proxy 2.53 listing matched");
       return true;
    }
-   n=sscanf(str,"%3s %3s %d %2d:%2d:%2d %4d %s",
+   n=sscanf(str,"%3s %3s %d %2d:%2d:%2d %4d %30s",
 	    week_day,info.month_name,&info.day,
 	    &info.hour,&info.minute,&info.second,&info.year,info.size_str);
    if(n==7 || (n==8 && !is_ascii_digit(info.size_str[0])))
@@@@ -372,7 +372,7 @@@@ static bool try_squid_eplf(file_info &in
    info.clear();
 
    char week_day[4];
-   int n=sscanf(str,"%3s %3s %d %2d:%2d:%2d %4d %s",
+   int n=sscanf(str,"%3s %3s %d %2d:%2d:%2d %4d %30s",
 	    week_day,info.month_name,&info.day,
 	    &info.hour,&info.minute,&info.second,&info.year,info.size_str);
    if(n==8) // maybe squid's EPLF listing.
@

