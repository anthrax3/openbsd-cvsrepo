head	1.67;
access;
symbols
	OPENBSD_6_1:1.65.0.2
	OPENBSD_6_1_BASE:1.65
	OPENBSD_6_0:1.60.0.2
	OPENBSD_6_0_BASE:1.60
	OPENBSD_5_9:1.55.0.2
	OPENBSD_5_9_BASE:1.55
	OPENBSD_5_8:1.50.0.4
	OPENBSD_5_8_BASE:1.50
	OPENBSD_5_7:1.48.0.2
	OPENBSD_5_7_BASE:1.48
	OPENBSD_5_6:1.44.0.2
	OPENBSD_5_6_BASE:1.44
	OPENBSD_5_5:1.37.0.2
	OPENBSD_5_5_BASE:1.37
	OPENBSD_5_4:1.31.0.2
	OPENBSD_5_4_BASE:1.31
	OPENBSD_5_3:1.26.0.2
	OPENBSD_5_3_BASE:1.26
	OPENBSD_5_2:1.23.0.2
	OPENBSD_5_2_BASE:1.23
	OPENBSD_5_1_BASE:1.21
	OPENBSD_5_1:1.21.0.2
	OPENBSD_5_0:1.17.0.2
	OPENBSD_5_0_BASE:1.17
	OPENBSD_4_9:1.16.0.2
	OPENBSD_4_9_BASE:1.16
	OPENBSD_4_8:1.13.0.2
	OPENBSD_4_8_BASE:1.13
	OPENBSD_4_7:1.10.0.6
	OPENBSD_4_7_BASE:1.10
	OPENBSD_4_6:1.10.0.4
	OPENBSD_4_6_BASE:1.10
	OPENBSD_4_5:1.10.0.2
	OPENBSD_4_5_BASE:1.10
	OPENBSD_4_4:1.8.0.2
	OPENBSD_4_4_BASE:1.8
	OPENBSD_4_3:1.4.0.2
	OPENBSD_4_3_BASE:1.4
	OPENBSD_4_2:1.3.0.2
	OPENBSD_4_2_BASE:1.3
	ajacoutot_20070427:1.1.1.1
	ajacoutot:1.1.1;
locks; strict;
comment	@# @;


1.67
date	2017.05.19.22.55.35;	author espie;	state Exp;
branches;
next	1.66;
commitid	durDEYmBtds8hNCx;

1.66
date	2017.04.10.11.46.23;	author sthen;	state Exp;
branches;
next	1.65;
commitid	BLsh88fJB8thZTwY;

1.65
date	2016.12.31.10.19.05;	author ajacoutot;	state Exp;
branches;
next	1.64;
commitid	7NK7QhpDia7vQgkJ;

1.64
date	2016.12.05.10.01.13;	author ajacoutot;	state Exp;
branches;
next	1.63;
commitid	rG1Oy2oMkFHXS4Hx;

1.63
date	2016.11.02.09.27.15;	author ajacoutot;	state Exp;
branches;
next	1.62;
commitid	BrZefN4AGfrfgOWw;

1.62
date	2016.08.17.20.58.19;	author sthen;	state Exp;
branches;
next	1.61;
commitid	3YTVpXXidJQjfavt;

1.61
date	2016.08.03.08.44.51;	author ajacoutot;	state Exp;
branches;
next	1.60;
commitid	YjU7MH6GmCSDZFaZ;

1.60
date	2016.06.16.06.28.03;	author ajacoutot;	state Exp;
branches;
next	1.59;
commitid	qGKa5FLALcMNSsrx;

1.59
date	2016.06.01.11.41.30;	author ajacoutot;	state Exp;
branches;
next	1.58;
commitid	82eFTv6BUImtNzCP;

1.58
date	2016.03.18.20.49.28;	author naddy;	state Exp;
branches;
next	1.57;
commitid	8GBp5gQa5BLeR7Ti;

1.57
date	2016.03.01.00.07.17;	author sthen;	state Exp;
branches;
next	1.56;
commitid	QBhOYg1ODJRuhu7C;

1.56
date	2016.02.27.12.02.04;	author ajacoutot;	state Exp;
branches;
next	1.55;
commitid	XlO58fFzhgPzxUwd;

1.55
date	2015.12.25.08.39.45;	author ajacoutot;	state Exp;
branches;
next	1.54;
commitid	lWzNW4D9TtO7X1J3;

1.54
date	2015.12.19.07.58.47;	author ajacoutot;	state Exp;
branches;
next	1.53;
commitid	jVY1sgHUAtkSi5aO;

1.53
date	2015.12.19.07.57.24;	author ajacoutot;	state Exp;
branches;
next	1.52;
commitid	tKxngnZJIqvMNNOI;

1.52
date	2015.12.03.07.59.13;	author ajacoutot;	state Exp;
branches;
next	1.51;
commitid	qycv4i4ZXQy8ccqi;

1.51
date	2015.08.23.08.46.52;	author jasper;	state Exp;
branches;
next	1.50;
commitid	DZHbJLDzvWM1iZOJ;

1.50
date	2015.07.11.08.00.39;	author ajacoutot;	state Exp;
branches;
next	1.49;
commitid	72zSPze54JjoCXq5;

1.49
date	2015.05.22.15.16.47;	author ajacoutot;	state Exp;
branches;
next	1.48;
commitid	53Gx5mXetphd9uj4;

1.48
date	2015.01.03.05.50.40;	author ajacoutot;	state Exp;
branches;
next	1.47;
commitid	kFxQ7RYboUwWmRhU;

1.47
date	2014.12.31.08.42.26;	author landry;	state Exp;
branches;
next	1.46;
commitid	vf8MnqY339W3vwfX;

1.46
date	2014.09.13.18.09.21;	author brad;	state Exp;
branches;
next	1.45;
commitid	PpbRjVZdAmlrmi8q;

1.45
date	2014.09.04.14.24.20;	author ajacoutot;	state Exp;
branches;
next	1.44;
commitid	KbvCFH8v0xTz4ZLh;

1.44
date	2014.05.08.04.15.21;	author ajacoutot;	state Exp;
branches;
next	1.43;

1.43
date	2014.04.27.09.46.52;	author ajacoutot;	state Exp;
branches;
next	1.42;

1.42
date	2014.04.27.08.47.46;	author ajacoutot;	state Exp;
branches;
next	1.41;

1.41
date	2014.04.25.11.18.46;	author ajacoutot;	state Exp;
branches;
next	1.40;

1.40
date	2014.03.23.22.05.00;	author sthen;	state Exp;
branches;
next	1.39;

1.39
date	2014.03.23.18.17.35;	author kili;	state Exp;
branches;
next	1.38;

1.38
date	2014.03.18.09.01.07;	author ajacoutot;	state Exp;
branches;
next	1.37;

1.37
date	2014.01.03.06.21.04;	author ajacoutot;	state Exp;
branches;
next	1.36;

1.36
date	2013.10.02.10.47.06;	author ajacoutot;	state Exp;
branches;
next	1.35;

1.35
date	2013.09.24.08.25.17;	author bentley;	state Exp;
branches;
next	1.34;

1.34
date	2013.09.22.18.50.23;	author ajacoutot;	state Exp;
branches;
next	1.33;

1.33
date	2013.09.20.11.53.47;	author ajacoutot;	state Exp;
branches;
next	1.32;

1.32
date	2013.09.20.07.05.12;	author ajacoutot;	state Exp;
branches;
next	1.31;

1.31
date	2013.06.12.20.36.34;	author brad;	state Exp;
branches;
next	1.30;

1.30
date	2013.05.25.00.33.10;	author brad;	state Exp;
branches;
next	1.29;

1.29
date	2013.05.14.15.01.57;	author ajacoutot;	state Exp;
branches;
next	1.28;

1.28
date	2013.04.28.08.04.27;	author ajacoutot;	state Exp;
branches;
next	1.27;

1.27
date	2013.03.11.11.35.47;	author espie;	state Exp;
branches;
next	1.26;

1.26
date	2013.01.16.14.18.53;	author ajacoutot;	state Exp;
branches;
next	1.25;

1.25
date	2012.11.27.08.14.24;	author ajacoutot;	state Exp;
branches;
next	1.24;

1.24
date	2012.08.25.13.19.37;	author ajacoutot;	state Exp;
branches;
next	1.23;

1.23
date	2012.05.05.06.12.13;	author ajacoutot;	state Exp;
branches;
next	1.22;

1.22
date	2012.04.23.17.15.18;	author espie;	state Exp;
branches;
next	1.21;

1.21
date	2012.01.29.10.37.37;	author ajacoutot;	state Exp;
branches;
next	1.20;

1.20
date	2012.01.05.08.44.35;	author ajacoutot;	state Exp;
branches;
next	1.19;

1.19
date	2011.10.26.17.00.06;	author ajacoutot;	state Exp;
branches;
next	1.18;

1.18
date	2011.09.16.11.13.38;	author espie;	state Exp;
branches;
next	1.17;

1.17
date	2011.05.11.09.01.26;	author ajacoutot;	state Exp;
branches;
next	1.16;

1.16
date	2010.11.19.22.31.33;	author espie;	state Exp;
branches;
next	1.15;

1.15
date	2010.11.11.14.00.45;	author espie;	state Exp;
branches;
next	1.14;

1.14
date	2010.10.18.18.36.47;	author espie;	state Exp;
branches;
next	1.13;

1.13
date	2010.05.26.14.33.01;	author ajacoutot;	state Exp;
branches;
next	1.12;

1.12
date	2010.05.03.19.32.14;	author ajacoutot;	state Exp;
branches;
next	1.11;

1.11
date	2010.03.23.21.14.45;	author ajacoutot;	state Exp;
branches;
next	1.10;

1.10
date	2009.01.17.14.14.14;	author ajacoutot;	state Exp;
branches;
next	1.9;

1.9
date	2009.01.17.11.42.03;	author ajacoutot;	state Exp;
branches;
next	1.8;

1.8
date	2008.06.17.14.45.40;	author ajacoutot;	state Exp;
branches;
next	1.7;

1.7
date	2008.05.22.19.30.19;	author ajacoutot;	state Exp;
branches;
next	1.6;

1.6
date	2008.04.03.07.18.08;	author ajacoutot;	state Exp;
branches;
next	1.5;

1.5
date	2008.03.15.17.40.06;	author ajacoutot;	state Exp;
branches;
next	1.4;

1.4
date	2007.08.30.15.14.16;	author ajacoutot;	state Exp;
branches;
next	1.3;

1.3
date	2007.08.02.14.39.36;	author ajacoutot;	state Exp;
branches;
next	1.2;

1.2
date	2007.06.20.14.40.34;	author ajacoutot;	state Exp;
branches;
next	1.1;

1.1
date	2007.04.27.21.10.42;	author ajacoutot;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2007.04.27.21.10.42;	author ajacoutot;	state Exp;
branches;
next	;


desc
@@


1.67
log
@use .beforesubst so that patch regen doesn't fuck up
missing headers for clang
@
text
@# $OpenBSD: Makefile,v 1.66 2017/04/10 11:46:23 sthen Exp $

BROKEN-hppa=	libpt.so.7.0: undefined reference to __sync_fetch_and_or_4

COMMENT=	H.323 gatekeeper

DISTNAME=	gnugk-4.2-2
PKGNAME=	gnugk-4.2.2
REVISION=	1
WRKDIST=	${WRKDIR}/gnugk-4.2

CATEGORIES=	net telephony

HOMEPAGE=	http://www.gnugk.org/

MAINTAINER=	Antoine Jacoutot <ajacoutot@@openbsd.org>

# GPLv2
PERMIT_PACKAGE_CDROM=	Yes

WANTLIB += GeoIP SDL c crypto expat h323 kvm lber ldap ldap_r
WANTLIB += lua${MODLUA_VERSION} m netsnmp netsnmpagent netsnmpmibs pt pthread
WANTLIB += sasl2 ssh ssl ${LIBCXX} z

MODULES=	lang/lua

# uses luaL_newlib, lua_setglobal
MODLUA_VERSION=	5.2

MASTER_SITES=	${MASTER_SITE_SOURCEFORGE:=openh323gk/}

BUILD_DEPENDS=	databases/mariadb \
		databases/postgresql

LIB_DEPENDS=	net/GeoIP \
		net/h323plus \
		net/net-snmp \
		security/libssh

ALL_TARGET=	optshared
USE_GMAKE=	Yes
NO_TEST=	Yes

CONFIGURE_STYLE=gnu

CONFIGURE_ENV=	CPPFLAGS="-I${LOCALBASE}/include" \
		LDFLAGS="-L${LOCALBASE}/lib" \
		OPENH323DIR=${LOCALBASE}/include/openh323 \
		OPENH323MAKEDIR=${LOCALBASE}/share/openh323 \
		PTLIBDIR=${LOCALBASE}/share/ptlib

CONFIGURE_ARGS=	--disable-sqlite \
		--disable-unixodbc \
		--with-pgsql-include-dir=${LOCALBASE}/include/postgresql \
		--with-lua-include-dir=${MODLUA_INCL_DIR} \
		--with-lua-lib-dir=${LOCALBASE}/lib

# sync with net/h323plus
CONFIGURE_ARGS +=--disable-h46018
CONFIGURE_ARGS +=--disable-h46023

MAKE_ENV=	VERBOSE=1
MAKE_FLAGS=	PTLIB_LIBDIR=$$(pkg-config --variable libdir ptlib) \
		OH323_LIBDIR=${LOCALBASE}/lib \
		OBJDIR=.

pre-configure:
	sed -i.beforesubst 's,-llua,-llua${MODLUA_VERSION} -lm,g' ${WRKSRC}/configure

post-build:
	cd ${WRKSRC}/addpasswd && \
		${MAKE_ENV} PTLIBDIR=${LOCALBASE}/share/ptlib ${MAKE_PROGRAM} ${MAKE_FLAGS}

# gmake: *** No rule to make target 'install'.  Stop.
do-install:
	${INSTALL_PROGRAM} ${WRKBUILD}/gnugk \
		${PREFIX}/bin

post-install:
	${INSTALL_MAN_DIR} ${PREFIX}/man/man1/
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/gnugk/
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/gnugk/
	${INSTALL_MAN} ${WRKSRC}/docs/gnugk.1 ${PREFIX}/man/man1/
	${INSTALL_DATA} ${WRKSRC}/docs/*.txt ${PREFIX}/share/doc/gnugk/
	cp ${WRKSRC}/etc/*.* ${PREFIX}/share/examples/gnugk/
	${INSTALL_PROGRAM} ${WRKSRC}/addpasswd/addpasswd \
		${PREFIX}/bin/addpasswd

.include <bsd.port.mk>
@


1.66
log
@use LIBCXX
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.65 2016/12/31 10:19:05 ajacoutot Exp $
d68 1
a68 1
	sed -i 's,-llua,-llua${MODLUA_VERSION} -lm,g' ${WRKSRC}/configure
@


1.65
log
@--disable-sqlite so it's not picked up.

reported by landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.64 2016/12/05 10:01:13 ajacoutot Exp $
d23 1
a23 1
WANTLIB += sasl2 ssh ssl stdc++ z
@


1.64
log
@Fix UDP sending (from upstream).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.63 2016/11/02 09:27:15 ajacoutot Exp $
d52 2
a53 1
CONFIGURE_ARGS=	--disable-unixodbc \
@


1.63
log
@Drop PORTROACH marker.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62 2016/08/17 20:58:19 sthen Exp $
d9 1
a9 1
REVISION=	0
@


1.62
log
@bump ports that might pick up IP_SENDSRCADDR
@
text
@d1 1
a1 3
# $OpenBSD: Makefile,v 1.61 2016/08/03 08:44:51 ajacoutot Exp $

PORTROACH=	skipv:4.2-2
@


1.61
log
@Skip bogus version spec.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.60 2016/06/16 06:28:03 ajacoutot Exp $
d11 1
@


1.60
log
@Update to gnugk-4.2.2.
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.59 2016/06/01 11:41:30 ajacoutot Exp $
@


1.59
log
@Update to gnugk-4.2.:
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2016/03/18 20:49:28 naddy Exp $
d7 3
a9 1
DISTNAME=	gnugk-4.2
@


1.58
log
@remove SHARED_ONLY from simple lua ports
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.57 2016/03/01 00:07:17 sthen Exp $
d7 1
a7 2
DISTNAME=	gnugk-4.1
REVISION=	0
@


1.57
log
@bump (GeoIP pkgpath change)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2016/02/27 12:02:04 ajacoutot Exp $
a3 2

SHARED_ONLY=	Yes
@


1.56
log
@Update to gnugk-4.1.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55 2015/12/25 08:39:45 ajacoutot Exp $
d10 1
@


1.55
log
@Remove some BROKEN markers for ports that should build now with the new libgcc
assisted built-in atomic ops for mips64.

from Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.54 2015/12/19 07:58:47 ajacoutot Exp $
d9 1
a9 3
DISTNAME=	gnugk-4.0.1
# XXX
WRKDIST=	${WRKDIR}/gnugk-4.0
d26 3
d66 1
a66 1
	sed -i 's,-llua,-llua${MODLUA_DEFAULT_VERSION} -lm,g' ${WRKSRC}/configure
@


1.54
log
@Use MODLUA_VERSION.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2015/12/19 07:57:24 ajacoutot Exp $
a3 1
BROKEN-mips64=	libpt.so.7.0: undefined reference to __sync_fetch_and_or_4
@


1.53
log
@Update to gnugk-4.0.1.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.52 2015/12/03 07:59:13 ajacoutot Exp $
d24 1
a24 1
WANTLIB += lua5.1 m netsnmp netsnmpagent netsnmpmibs pt pthread
@


1.52
log
@Update to gnugk-4.0.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 2015/08/23 08:46:52 jasper Exp $
d10 3
a12 1
DISTNAME=	gnugk-4.0
d66 1
a66 1
	perl -pi -e 's,-llua,-llua${MODLUA_DEFAULT_VERSION} -lm,g' ${WRKSRC}/configure
@


1.51
log
@broken on mips64 (atomic ops)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2015/07/11 08:00:39 ajacoutot Exp $
d10 1
a10 1
DISTNAME=	gnugk-3.9
@


1.50
log
@Update to gnugk-3.9.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2015/05/22 15:16:47 ajacoutot Exp $
d4 1
@


1.49
log
@Bump after recent ptlib changes.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2015/01/03 05:50:40 ajacoutot Exp $
d9 1
a9 2
DISTNAME=	gnugk-3.8
REVISION=	0
d20 3
a22 3
WANTLIB += SDL c crypto expat h323 kvm lber ldap ldap_r lua5.1
WANTLIB += m netsnmp netsnmpagent netsnmpmibs pt pthread sasl2
WANTLIB += ssh ssl stdc++ z
d31 2
a32 1
LIB_DEPENDS=	net/h323plus \
d44 3
a46 2
		PTLIBDIR=${LOCALBASE}/share/ptlib \
		OPENH323DIR=${LOCALBASE}/share/openh323
a62 1
	${SUBST_CMD} ${WRKSRC}/docs/gnugk.1 ${WRKSRC}/configure
@


1.48
log
@Update to gnugk-3.8.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2014/12/31 08:42:26 landry Exp $
d10 1
@


1.47
log
@Yet another bunch of ports that reliably fail to build on hppa.

BROKEN-hppa =	SIGILL when running lilypond
BROKEN-hppa =	libjson-c.so.0.0: undefined reference to __sync_val_compare_and_swap_4
BROKEN-hppa=	missing atomic ops
BROKEN-hppa=	./iodev/hdimage/hdimage.cc:807: error: 'bx_bswap32' was not declared in this scope
BROKEN-hppa =	cc1plus: error: unrecognized command line option '-std=c++11'
BROKEN-hppa =	src/bin/jp2/convert.c:192: error: expected identifier or '(' before '__extension__'
BROKEN-hppa=	libpt.so.7.0: undefined reference to __sync_fetch_and_or_4
BROKEN-hppa=	ykpers-json.c:42: error: redefinition of typedef 'json_bool'
BROKEN-hppa=	OOM on src/lxml/lxml.etree.c
BROKEN-hppa =	undefined reference to `__sync_val_compare_and_swap_4' in libjson-c
BROKEN-hppa =	rake fails when linking PassengerHelperAgent
BROKEN-hppa =	kstars/kstars/tools/scriptbuilder.cpp:103: internal compiler error: Segmentation fault
BROKEN-hppa=	build stuck on virt-viewer-window.c

See http://build-failures.rhaalovely.net/hppa/
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.46 2014/09/13 18:09:21 brad Exp $
a7 1
BROKEN-hppa=	libpt.so.7.0: undefined reference to __sync_fetch_and_or_4
d9 1
a9 1
DISTNAME=	gnugk-3.7
@


1.46
log
@Switch from using MySQL to using MariaDB attempt #2. MariaDB is a drop-in replacement.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2014/09/04 14:24:20 ajacoutot Exp $
d6 1
@


1.45
log
@Update to gnugk-3.7.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2014/05/08 04:15:21 ajacoutot Exp $
d26 1
a26 1
BUILD_DEPENDS=	databases/mysql \
@


1.44
log
@Update to gnugk-3.6.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2014/04/27 09:46:52 ajacoutot Exp $
d7 1
a7 1
DISTNAME=	gnugk-3.6
@


1.43
log
@Builds fine now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2014/04/27 08:47:46 ajacoutot Exp $
d7 1
a7 3
# CVS checkout of branch v3_5_STABLE
# Mon Apr 21 20:51:31 CEST 2014
DISTNAME=	gnugk-3.5.0.1
d20 1
a20 1
WANTLIB += ssh ssl stdc++
d24 1
a24 2
MASTER_SITES=	https://distfiles.bsdfrog.org/
#MASTER_SITES=	${MASTER_SITE_SOURCEFORGE:=openh323gk/}
@


1.42
log
@Temporarily mark BROKEN -- I was not building in a clean environment.

spotted by landry@@
@
text
@d1 1
a1 3
# $OpenBSD: Makefile,v 1.41 2014/04/25 11:18:46 ajacoutot Exp $

BROKEN=		XXX see aja@@
@


1.41
log
@Update to a snapshot of branch v3_5_STABLE to cope with recent ptlib and
h323plus updates.
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.40 2014/03/23 22:05:00 sthen Exp $
@


1.40
log
@sync WANTLIB following removal of tcp wrappers from net-snmp
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2014/03/23 18:17:35 kili Exp $
d7 3
a9 5
V=		3.5
DISTNAME=	gnugk-${V}
REVISION=	2

WRKDIST=	${WRKDIR}/gnugk-${V}
d26 2
a27 1
MASTER_SITES=	${MASTER_SITE_SOURCEFORGE:=openh323gk/}
d36 1
a36 1
ALL_TARGET=	optshared #XXX gkdefault
d44 2
a45 1
		PTLIBDIR=`ptlib-config --ptlibdir`
d47 1
a47 2
CONFIGURE_ARGS=	--disable-firebird \
		--disable-unixodbc \
d52 8
a59 7
# patented
CONFIGURE_ARGS += --disable-h46018

MAKE_ENV=	VERBOSE=1 \
		STDCCFLAGS="${STDCCFLAGS} -I${LOCALBASE}/include/openh323"

FAKE_FLAGS=	INSTALLBIN_DIR=${WRKINST}${TRUEPREFIX}/bin
d67 6
a72 3
		OBJDIR=. \
		SYSLIBDIR=`ptlib-config --libdir` \
		PTLIBDIR=`ptlib-config --ptlibdir` ${MAKE_ENV} ${MAKE_PROGRAM}
d80 1
a80 1
	cp ${WRKSRC}/etc/* ${PREFIX}/share/examples/gnugk/
@


1.39
log
@Revert librt changes.

Prodded by espie@@.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2014/03/18 09:01:07 ajacoutot Exp $
d9 1
a9 1
REVISION=	1
d24 1
a24 1
WANTLIB += ssh ssl stdc++ wrap
@


1.38
log
@Remove the librt chunk, it's not needed anymore.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2014/01/03 06:21:04 ajacoutot Exp $
d9 1
a9 1
REVISION=	0
@


1.37
log
@Update to gnugk-3.5.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2013/10/02 10:47:06 ajacoutot Exp $
d9 1
@


1.36
log
@Regen WANTLIB after ptlib upgrade.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2013/09/24 08:25:17 bentley Exp $
d7 1
a7 1
V=		3.4
a8 1
REVISION=	3
@


1.35
log
@Pull in upstream's manpage fixes, and remove USE_GROFF.

ok ajacoutot@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2013/09/22 18:50:23 ajacoutot Exp $
d9 1
a9 1
REVISION=	2
d23 2
a24 2
WANTLIB += m netsnmp netsnmpagent netsnmpmibs pt pthread ssh ssl
WANTLIB += stdc++ wrap
d33 1
a33 1
LIB_DEPENDS=	net/h323plus>=1.24.99 \
d37 1
a38 1
ALL_TARGET=	optshared # XXX gkdefault
d42 1
d46 1
d56 4
a59 3
MAKE_ENV=	CC=${CC} CPLUS=${CXX} \
		STDCCFLAGS="${STDCCFLAGS} -I${LOCALBASE}/include/openh323" \
		INSTALLBIN_DIR=${WRKINST}${TRUEPREFIX}/bin
d69 1
a69 1
		PTLIBDIR=`ptlib-config --ptlibdir` ${MAKE_PROGRAM}
@


1.34
log
@Needs USE_GROFF.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2013/09/20 11:53:47 ajacoutot Exp $
d9 1
a9 1
REVISION=	1
a35 3

# gnugk.1:34:1: FATAL: child violates parent syntax
USE_GROFF=	Yes
@


1.33
log
@Skip exit handlers on OpenBSD since they hang; fom upstream.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2013/09/20 07:05:12 ajacoutot Exp $
d9 1
a9 1
REVISION=	0
d36 3
@


1.32
log
@Update to gnugk-3.4.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2013/06/12 20:36:34 brad Exp $
d9 1
@


1.31
log
@Revert back to using MySQL 5.1 for the time being. MariaDB 5.5 introduces
a new libmysqlclient non-blocking API which utilizes co-routines. The X86
specific GCC ASM co-routine support hid the fact that there was an issue.
The only fallback code so far is POSIX user contexts which OpenBSD does not
support.

Input from and Ok sthen@@ jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2013/05/25 00:33:10 brad Exp $
d7 2
a8 4
V=		3.3
DISTNAME=	gnugk-${V}-2
PKGNAME=	gnugk-${V}
REVISION=	0
@


1.30
log
@Switch from using MySQL to using MariaDB. MariaDB is a drop-in replacement.


ok sthen aja
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2013/05/14 15:01:57 ajacoutot Exp $
d31 1
a31 1
BUILD_DEPENDS=	databases/mariadb \
@


1.29
log
@Update to gnugk-3.3.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2013/04/28 08:04:27 ajacoutot Exp $
d10 2
d31 1
a31 1
BUILD_DEPENDS=	databases/mysql \
@


1.28
log
@No need for gtar anymore.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2013/03/11 11:35:47 espie Exp $
d7 1
a7 1
V=		3.2
@


1.27
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2013/01/16 14:18:53 ajacoutot Exp $
a30 4

# XXX PaxHeaders
TAR=		${LOCALBASE}/bin/gtar
BUILD_DEPENDS +=archivers/gtar
@


1.26
log
@Update to gnugk-3.2.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2012/11/27 08:14:24 ajacoutot Exp $
a19 3
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM= Yes
PERMIT_DISTFILES_FTP=	Yes
d42 1
a42 1
NO_REGRESS=	Yes
@


1.25
log
@Bump after recent ptlib update.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2012/08/25 13:19:37 ajacoutot Exp $
d7 4
a10 2
DISTNAME=	gnugk-3.1
REVISION=	0
d24 5
a28 3
WANTLIB += SDL c crypto expat h323 kvm lber ldap ldap_r m netsnmp
WANTLIB += netsnmpagent netsnmpmibs pt pthread sasl2 ssh ssl stdc++
WANTLIB += wrap
d35 5
a39 1
LIB_DEPENDS=	net/h323plus \
d53 3
a55 1
		--with-pgsql-include-dir=${LOCALBASE}/include/postgresql
d66 1
@


1.24
log
@Update to gnugk-3.1.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2012/05/05 06:12:13 ajacoutot Exp $
d8 1
d31 1
a31 1
LIB_DEPENDS=	net/h323plus>=1.24.0p0 \
@


1.23
log
@Bugfix update to gnugk-3.0.2.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2012/04/23 17:15:18 espie Exp $
d7 1
a7 1
DISTNAME=	gnugk-3.0.2
d21 3
a23 2
WANTLIB += SDL avutil c crypto expat h323 lber ldap ldap_r m pt
WANTLIB += pthread sasl2 ssh ssl stdc++
d30 2
a31 1
LIB_DEPENDS=	net/h323plus \
d42 1
a42 6
CONFIGURE_ARGS=	--enable-radius \
		--enable-sqlite \
		--enable-mysql \
		--enable-pgsql \
		--enable-h46023 \
		--disable-firebird \
d54 1
a54 2
	${SUBST_CMD} ${WRKSRC}/docs/gnugk.1
	perl -pi -e "s,!!LOCALBASE!!,${LOCALBASE},g" ${WRKSRC}/configure
@


1.22
log
@first pass at handling sqlite3 move
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2012/01/29 10:37:37 ajacoutot Exp $
d7 1
a7 1
DISTNAME=	gnugk-3.0.1
d38 2
a39 1
		LDFLAGS="-L${LOCALBASE}/lib"
@


1.21
log
@"safe" bugfix update to gnugk-3.0.1.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2012/01/05 08:44:35 ajacoutot Exp $
d27 1
a27 2
		databases/postgresql \
		databases/sqlite3
@


1.20
log
@Major update to gnugk-3.0.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2011/10/26 17:00:06 ajacoutot Exp $
d7 1
a7 1
DISTNAME=	gnugk-3.0
@


1.19
log
@Major update to gnugk-2.3.5.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2011/09/16 11:13:38 espie Exp $
d7 1
a7 1
DISTNAME=	gnugk-2.3.5
@


1.18
log
@normalize pkgpath
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2011/05/11 09:01:26 ajacoutot Exp $
d7 1
a7 2
DISTNAME=	gnugk-2.3.2
REVISION=	1
d21 3
d26 3
a28 2
WANTLIB=	SDL avutil c crypto expat lber ldap ldap_r m \
		pt pthread sasl2 ssl stdc++ h323>=3 sqlite3>=12
d31 1
a31 1
		databases/sqlite3
d34 1
a34 2
USE_GROFF=	Yes
ALL_TARGET=	optshared addpasswd
d38 2
d42 2
a44 1
		--disable-h46018 \
d46 5
a50 1
		--disable-unixodbc
d52 1
a52 1
MAKE_ENV+=	CC=${CC} CPLUS=${CXX} \
d54 1
a54 22
		SYSLIBDIR=`ptlib-config --libdir`

FLAVORS=	mysql pgsql
FLAVOR?=

.if ${FLAVOR:L:Mmysql}
WANTLIB+=	z mysqlclient>=18
LIB_DEPENDS+=	databases/mysql
CONFIGURE_ARGS+=--enable-mysql
.else
CONFIGURE_ARGS+=--disable-mysql
.endif

.if ${FLAVOR:L:Mpgsql}
WANTLIB +=	pq>=5
LIB_DEPENDS+=	databases/postgresql
CONFIGURE_ARGS+=--enable-pgsql \
		--with-pgsql-lib-dir=${LOCALBASE}/lib \
		--with-pgsql-include-dir=${LOCALBASE}/include/postgresql
.else
CONFIGURE_ARGS+=--disable-pgsql
.endif
d60 6
d73 2
@


1.17
log
@Add rc script, from Vadim Zhukov with some tweaks.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2010/11/19 22:31:33 espie Exp $
d8 1
a8 1
REVISION=	0
@


1.16
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2010/11/11 14:00:45 espie Exp $
d8 1
d31 1
a31 1
USE_GROFF =	Yes
@


1.15
log
@more WANTLIB
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2010/10/18 18:36:47 espie Exp $
d24 1
a24 1
		pt pthread sasl2 ssl stdc++ h323.>=3 sqlite3.>=12
d26 2
a27 2
LIB_DEPENDS=	::net/h323plus \
		::databases/sqlite3
d50 2
a51 2
WANTLIB+=	z mysqlclient.>=18
LIB_DEPENDS+=	::databases/mysql
d58 2
a59 2
WANTLIB +=	pq.>=5
LIB_DEPENDS+=	::databases/postgresql
@


1.14
log
@USE_GROFF=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2010/05/26 14:33:01 ajacoutot Exp $
d24 1
a24 1
		pt pthread sasl2 ssl stdc++
d26 2
a27 2
LIB_DEPENDS=	h323.>=3::net/h323plus \
		sqlite3.>=12::databases/sqlite3
d50 2
a51 2
WANTLIB+=	z
LIB_DEPENDS+=	mysqlclient.>=18::databases/mysql
d58 2
a59 1
LIB_DEPENDS+=	pq.>=5::databases/postgresql
@


1.13
log
@Bugfix update to gnugk-2.3.2.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2010/05/03 19:32:14 ajacoutot Exp $
d30 1
@


1.12
log
@Fix postresql support.

breakage spotted by Andrew Grillet, thanks.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2010/03/23 21:14:45 ajacoutot Exp $
d7 1
a7 2
DISTNAME=	gnugk-2.3.1
PKGNAME=	${DISTNAME}p0
@


1.11
log
@Major update to gnugk-2.3.1.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2009/01/17 14:14:14 ajacoutot Exp $
d8 2
@


1.10
log
@- sync WANTLIB+PLIST after latest pwlib changes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2009/01/17 11:42:03 ajacoutot Exp $
d7 1
a7 2
DISTNAME=	gnugk-2.2.8
PKGNAME=	${DISTNAME}p0
d25 1
a25 1
LIB_DEPENDS=	h323.>=2::net/openh323 \
d35 2
d66 1
@


1.9
log
@- update to gnugk-2.2.8
Some of the changes:
* auto-reconnect feature for all database drivers
* support for using stored procedures when using MySQL
* the extended 'sql' routing policy now supports setting multiple
failover routes
- use SUBST_CMD
- remove GNUGK_ID variable... not useful
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2008/06/17 14:45:40 ajacoutot Exp $
d8 1
d23 1
a23 1
WANTLIB=	SDL avutil c crypto expat lber ldap ldap_r m ossaudio \
@


1.8
log
@- bugfix update to gnugk-2.2.7-3
* 2 missing NULL pointer checks
* fixes a cause code translation when no Q.931 code is set
* fixes possible memory leak in virtual queues on unregistered calls
* checks for the new config file on a reload
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2008/05/22 19:30:19 ajacoutot Exp $
d7 1
a7 1
DISTNAME=	gnugk-2.2.7-3
d25 2
a26 4
LIB_DEPENDS=	h323.>=2::net/openh323

GNUGK_ID=	_gnugk
SUBST_VARS=	GNUGK_ID
d34 3
a36 1
		--disable-firebird
d63 1
a63 2
	@@perl -pi -e 's,!!SYSCONFDIR!!,${SYSCONFDIR},g' \
		${WRKSRC}/docs/gnugk.1
@


1.7
log
@- fix WANTLIB after pwlib FLAVORs merge
- bump
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2008/04/03 07:18:08 ajacoutot Exp $
d7 1
a7 2
DISTNAME=	gnugk-2.2.7
PKGNAME=	${DISTNAME}p0
@


1.6
log
@- update to gnugk-2.2.7

* extends virtual queues to work on unregistered calls,
* adds per prefix capacity limits and Q.931 cause code translation per
gateway
* adds H.460.9 realtime, QoS monitoring, H.460.interop support and H.350
authentication
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2008/03/15 17:40:06 ajacoutot Exp $
d8 1
d23 2
a24 1
WANTLIB=	avutil c crypto expat m ossaudio pt pthread ssl stdc++
@


1.5
log
@- make it compile with new pwlib
- merge a patch from upstream SVN so that the _gnugk user does not need
read access to current directory when starting gnugk
- remove useless parts from patches now that pwlib and openh323 version
got sanitised
- rename default configuration file from gnugk.ini to getekeeper.ini
(as per documentation suggests it)
- replace etc with ${SYSCONFDIR} in MESSAGE and remove fixed warning
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2007/08/30 15:14:16 ajacoutot Exp $
d7 1
a7 2
DISTNAME=	gnugk-2.2.6
PKGNAME=	${DISTNAME}p2
d55 1
@


1.4
log
@- add a small warning in MESSAGE and tweak the starting command ;
if gnugk is ran as an unpriviledged user, the current directory has to
be accessible by it
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2007/08/02 14:39:36 ajacoutot Exp $
d8 1
a8 1
PKGNAME=	${DISTNAME}p1
d25 1
a25 1
LIB_DEPENDS=	h323.>=1::net/openh323
d40 1
a40 2
		SYSLIBDIR=`ptlib-config --libdir` \
		PTLIB_FILE=libpt.`ptlib-config --sharedlibext`.`ptlib-config --version`
@


1.3
log
@- zap unneeded variable
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2007/06/20 14:40:34 ajacoutot Exp $
d8 1
a8 1
PKGNAME=	${DISTNAME}p0
@


1.2
log
@- remove /var/run/gnugk from @@sample (the content of /var/run is wiped
out on boot so there's really no point in keeping this)
- instruct users to create /var/run/gnugk before starting gnugk instead

pointed by todd@@ in a mail to ports@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2007/04/27 21:10:42 ajacoutot Exp $
a39 1
		OH323_LIBDIR=${LOCALBASE}/lib \
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d5 1
a5 1
COMMENT=	"H.323 gatekeeper"
d8 1
@


1.1.1.1
log
@Import gnugk-2.2.6

The GNU Gatekeeper is an open-source project that implements an H.323
gatekeeper. A gatekeeper provides call control services to the H.323
endpoints. It is an integral part of most useful internet telephony
installations that are based on the H.323 standard.
According to the recommendations from H.323, GnuGK provides most of the
following functions based on the OpenH323 protocol stack:
 * Address Translation
 * Admissions Control
 * Bandwidth Control
 * Zone Management
 * Call Control Signaling
 * Call Authorization
 * Bandwidth Management
 * Call Management

ok kili@@
@
text
@@
