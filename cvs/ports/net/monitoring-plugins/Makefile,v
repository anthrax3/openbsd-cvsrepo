head	1.16;
access;
symbols
	OPENBSD_6_1:1.11.0.2
	OPENBSD_6_1_BASE:1.11
	OPENBSD_6_0:1.7.0.4
	OPENBSD_6_0_BASE:1.7
	OPENBSD_5_9:1.7.0.2
	OPENBSD_5_9_BASE:1.7
	OPENBSD_5_8:1.5.0.6
	OPENBSD_5_8_BASE:1.5
	OPENBSD_5_7:1.5.0.2
	OPENBSD_5_7_BASE:1.5
	OPENBSD_5_6:1.1.0.2
	OPENBSD_5_6_BASE:1.1;
locks; strict;
comment	@# @;


1.16
date	2017.07.26.22.45.28;	author sthen;	state Exp;
branches;
next	1.15;
commitid	tD4MFrpYYDDL2UFT;

1.15
date	2017.07.19.12.14.29;	author zhuk;	state Exp;
branches;
next	1.14;
commitid	1v5i8aIWfUfXIr4k;

1.14
date	2017.07.19.11.50.16;	author sthen;	state Exp;
branches;
next	1.13;
commitid	Pzdy3TQQchXc0z2h;

1.13
date	2017.07.16.19.18.58;	author espie;	state Exp;
branches;
next	1.12;
commitid	tt0GhWK5c4uf9ILG;

1.12
date	2017.04.10.11.46.32;	author sthen;	state Exp;
branches;
next	1.11;
commitid	HY6VNZxjJWzKQFDV;

1.11
date	2017.02.18.17.33.51;	author ajacoutot;	state Exp;
branches
	1.11.2.1;
next	1.10;
commitid	kjw4RQ4AAUYktD89;

1.10
date	2017.02.18.17.32.37;	author ajacoutot;	state Exp;
branches;
next	1.9;
commitid	bw6Y0vDo3oixdVWL;

1.9
date	2017.01.27.10.20.17;	author sthen;	state Exp;
branches;
next	1.8;
commitid	jG7cRaf2I5gMKlKp;

1.8
date	2016.11.30.20.46.42;	author sthen;	state Exp;
branches;
next	1.7;
commitid	8sOdGVGTclMHFn9L;

1.7
date	2015.10.18.10.42.56;	author sthen;	state Exp;
branches;
next	1.6;
commitid	c7zXyaesn253qnLp;

1.6
date	2015.10.08.21.23.32;	author sthen;	state Exp;
branches;
next	1.5;
commitid	71eXcpX4Hp7RemDb;

1.5
date	2014.12.04.01.08.04;	author sthen;	state Exp;
branches;
next	1.4;
commitid	WrLN1Oq60mQISUSe;

1.4
date	2014.10.16.15.23.42;	author sthen;	state Exp;
branches;
next	1.3;
commitid	oIByt9sEtv0QAZGd;

1.3
date	2014.09.13.18.09.21;	author brad;	state Exp;
branches;
next	1.2;
commitid	PpbRjVZdAmlrmi8q;

1.2
date	2014.08.14.15.49.38;	author sthen;	state Exp;
branches;
next	1.1;
commitid	c3jZvNQhbJRRHEKs;

1.1
date	2014.07.11.20.08.04;	author sthen;	state Exp;
branches;
next	;
commitid	BLR9Q6pquFG0Vj7f;

1.11.2.1
date	2017.07.29.16.11.18;	author zhuk;	state Exp;
branches;
next	;
commitid	apBwKZ58ZLuyV1jk;


desc
@@


1.16
log
@bump LIBCXX/LIBECXX/COMPILER_LIBCXX ports.
@
text
@# $OpenBSD: Makefile,v 1.15 2017/07/19 12:14:29 zhuk Exp $

COMMENT-main=	monitoring plugins (for Nagios, Icinga, etc)
COMMENT-dbi=	dbi monitoring plugin
COMMENT-fping=	fping monitoring plugin
COMMENT-game=	gameserver monitoring plugin
COMMENT-ldap=	ldap monitoring plugin
COMMENT-mysql=	mysql monitoring plugin
COMMENT-pgsql=	postgresql monitoring plugin
COMMENT-samba=	samba monitoring plugin
COMMENT-snmp=	monitoring plugins using snmp
COMMENT-radius=	RADIUS monitoring plugin

V=		2.2
REVISION-main=	3
DISTNAME=	monitoring-plugins-$V
PKGNAME-main=	monitoring-plugins-$V
PKGNAME-dbi=	monitoring-plugins-dbi-$V
PKGNAME-fping=	monitoring-plugins-fping-$V
PKGNAME-game=	monitoring-plugins-game-$V
PKGNAME-ldap=	monitoring-plugins-ldap-$V
PKGNAME-mysql=	monitoring-plugins-mysql-$V
PKGNAME-pgsql=	monitoring-plugins-pgsql-$V
PKGNAME-samba=	monitoring-plugins-samba-$V
PKGNAME-snmp=	monitoring-plugins-snmp-$V
PKGNAME-radius=	monitoring-plugins-radius-$V
CATEGORIES=	net
REVISION-dbi=	1
REVISION-fping=	1
REVISION-game=	1
REVISION-ldap=	1
REVISION-mysql=	1
REVISION-pgsql=	1
REVISION-radius=1
REVISION-samba=	1
REVISION-snmp=	1

HOMEPAGE=	https://www.monitoring-plugins.org/

MAINTAINER=	Stuart Henderson <sthen@@openbsd.org>

# GPLv2
PERMIT_PACKAGE_CDROM=	Yes

WANTLIB=	c pthread
WANTLIB-main=	${WANTLIB} crypto m ssl
MODULES=	devel/gettext

MASTER_SITES=	https://www.monitoring-plugins.org/download/

FAKE_FLAGS=	setuid_root_mode=0555

CONFIGURE_STYLE= autoconf
AUTOCONF_VERSION= 2.69
CONFIGURE_ENV+= LDFLAGS="-L${LOCALBASE}/lib"
# cgiurl is only used to produce an href to traceroute.cgi in check_ping output
CONFIGURE_ARGS+= --libexecdir=${PREFIX}/libexec/nagios \
		--with-cgiurl=/cgi-bin/nagios \
		--with-openssl=/usr \
		--without-gnutls
# can autodetect command paths, but hard-coding avoids build dependencies
CONFIGURE_ARGS+= --with-fping-command=${LOCALBASE}/sbin/fping \
		--with-fping6-command=${LOCALBASE}/sbin/fping6 \
		--with-smbclient-command=${LOCALBASE}/bin/smbclient \
		--with-snmpget-command=${LOCALBASE}/bin/snmpget \
		--with-snmpgetnext-command=${LOCALBASE}/bin/snmpgetnext \
		--with-qstat-command=${LOCALBASE}/bin/qstat
# listed here to make it easier to move BIND to ports
CONFIGURE_ARGS+= --with-dig-command=/usr/sbin/dig \
		--with-nslookup-command=/usr/sbin/nslookup

CFLAGS+=	-DLDAP_DEPRECATED

PSEUDO_FLAVORS=	no_db
FLAVOR?=

MULTI_PACKAGES= -main -fping -game -samba -snmp -dbi -ldap -mysql -pgsql -radius

# many broken tests, but...
TEST_IS_INTERACTIVE=Yes

.include <bsd.port.arch.mk>

.if ${FLAVOR:Mno_db}
BUILD_PACKAGES := ${BUILD_PACKAGES:N-dbi:N-ldap:N-mysql:N-pgsql}
.endif

# don't bother with no_XX for those with no build dependencies, or
# lightweight/common build dependencies
BUILD_DEPENDS+=		net/p5-Net-SNMP

RUN_DEPENDS-fping=	${RUN_DEPENDS} net/fping
RUN_DEPENDS-game=	${RUN_DEPENDS} games/qstat

LIB_DEPENDS-samba=
WANTLIB-samba=
RUN_DEPENDS-samba=	net/samba

RUN_DEPENDS-snmp=	${RUN_DEPENDS} \
			net/net-snmp \
			net/p5-Net-SNMP

LIB_DEPENDS-radius=	net/radcli
WANTLIB-radius+=	${WANTLIB} ffi gmp gnutls hogweed idn2 nettle
WANTLIB-radius+=	p11-kit radcli tasn1 z

# MYSQL
.if !${BUILD_PACKAGES:M-mysql}
CONFIGURE_ARGS += --without-mysql
.else
CONFIGURE_ARGS += --with-mysql=${LOCALBASE}
.endif
LIB_DEPENDS-mysql = ${LIB_DEPENDS} databases/mariadb
WANTLIB-mysql = ${WANTLIB} crypto m mysqlclient ssl ${COMPILER_LIBCXX} z

# PGSQL
.if !${BUILD_PACKAGES:M-pgsql}
CONFIGURE_ARGS += --without-pgsql
.else
CONFIGURE_ARGS += --with-pgsql=${LOCALBASE}
.endif
LIB_DEPENDS-pgsql = ${LIB_DEPENDS} databases/postgresql
WANTLIB-pgsql += ${WANTLIB} crypto pq ssl

# DBI
.if !${BUILD_PACKAGES:M-dbi}
CONFIGURE_ARGS += --without-dbi
.endif
LIB_DEPENDS-dbi = ${LIB_DEPENDS} databases/libdbi
WANTLIB-dbi = ${WANTLIB} dbi m

# LDAP
LIB_DEPENDS-ldap = ${LIB_DEPENDS} databases/openldap
WANTLIB-ldap += ${WANTLIB} crypto lber-2.4 ldap-2.4 sasl2 ssl

.include <bsd.port.mk>
@


1.15
log
@Fix stack smashing in check_dhcp.

Upstream merge request:
https://github.com/monitoring-plugins/monitoring-plugins/pull/1500

okay sthen@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2017/07/19 11:50:16 sthen Exp $
d15 1
a15 1
REVISION-main=	2
d28 9
a36 9
REVISION-dbi=	0
REVISION-fping=	0
REVISION-game=	0
REVISION-ldap=	0
REVISION-mysql=	0
REVISION-pgsql=	0
REVISION-radius=0
REVISION-samba=	0
REVISION-snmp=	0
@


1.14
log
@set LDFLAGS so autoconf can find radius client libs in a no_db build.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2017/07/16 19:18:58 espie Exp $
d15 1
a15 1
REVISION-main=	1
@


1.13
log
@use COMPILER_LIBCXX where applicable
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2017/04/10 11:46:32 sthen Exp $
d55 1
@


1.12
log
@use LIBCXX
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2017/02/18 17:33:51 ajacoutot Exp $
d113 1
a113 1
WANTLIB-mysql = ${WANTLIB} crypto m mysqlclient ssl ${LIBCXX} z
@


1.11
log
@Missed bump.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2017/02/18 17:32:37 ajacoutot Exp $
d113 1
a113 1
WANTLIB-mysql = ${WANTLIB} crypto m mysqlclient ssl stdc++ z
@


1.11.2.1
log
@Fix stack smashing in check_dhcp.

Upstream merge request:
https://github.com/monitoring-plugins/monitoring-plugins/pull/1500

okay sthen@@ (MAINTAINER), jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2017/02/18 17:33:51 ajacoutot Exp $
d15 1
a15 1
REVISION-main=	2
@


1.10
log
@idn -> idn2 after gnutls WANTLIB change.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2017/01/27 10:20:17 sthen Exp $
d15 1
a15 1
REVISION-main=	0
d28 9
@


1.9
log
@Replace handrolled pack with pack_sockaddr_in to fix check_ircd on systems
where sockaddr_storage includes a length. Diff from Alf Schlichting with one
minor tweak by me.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2016/11/30 20:46:42 sthen Exp $
d94 1
a94 1
WANTLIB-radius+=	${WANTLIB} ffi gmp gnutls hogweed idn nettle
@


1.8
log
@update to monitoring-plugins-2.2
enable radius plugin (using radcli library) while there
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2015/10/18 10:42:56 sthen Exp $
d15 1
@


1.7
log
@update to monitoring-plugins-2.1.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2014/12/04 01:08:04 sthen Exp $
d12 1
d14 1
a14 1
V=		2.1.2
d25 1
a59 1
# missing: radius
d66 1
a66 1
MULTI_PACKAGES= -main -fping -game -samba -snmp -dbi -ldap -mysql -pgsql
d77 2
a78 1
# no build dependencies, or lightweight build dependencies
d80 1
d83 1
d87 8
a94 1
RUN_DEPENDS-snmp=	${RUN_DEPENDS} net/net-snmp net/p5-Net-SNMP
@


1.6
log
@Bump some ports which reference if_msghdr in their source, so that package
updates are triggered. This is following the struct if_data ABI change a few
days ago; if_msghdr has an embedded if_data.  Some may be unnecessary, but
some are definitely needed and bumps are cheaper than debugging.
Problem reported with wpa_supplicant by Mikolaj Kucharski.
@
text
@d13 1
a13 2
V=		2.1.1
REVISION-main=	0
d43 1
@


1.5
log
@update to monitoring-plugins-pgsql-2.1.1
- Fix check_ntp's jitter checking
- Fix check_ntp's handling of invalid server responses
- Fix check_apt's handling of invalid regular expressions
- Fix check_real's server response processing
- Fix backslash escaping in check_tcp's --help output
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2014/10/16 15:23:42 sthen Exp $
d14 1
@


1.4
log
@update to monitoring-plugins-2.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2014/09/13 18:09:21 brad Exp $
d13 1
a13 1
V=		2.1
@


1.3
log
@Switch from using MySQL to using MariaDB attempt #2. MariaDB is a drop-in replacement.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2014/08/14 15:49:38 sthen Exp $
d13 1
a13 1
V=		2.0
a23 2
REVISION=	0
REVISION-mysql=	1
d91 1
a91 1
WANTLIB-mysql = ${WANTLIB} crypto m mysqlclient ssl z
@


1.2
log
@add some missing @@conflicts
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1 2014/07/11 20:08:04 sthen Exp $
a13 1
REVISION=	0
d24 2
d92 1
a92 1
LIB_DEPENDS-mysql = ${LIB_DEPENDS} databases/mysql
@


1.1
log
@update to monitoring-plugins 2.0 and shuffle directory to match the package
name (this was renamed from nagios-plugins a while ago, it is now separate
from nagios-plugins development which is proceeding separately)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2014/04/21 16:19:05 sthen Exp $
d14 1
@

