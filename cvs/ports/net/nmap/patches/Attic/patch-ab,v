head	1.6;
access;
symbols
	OPENBSD_2_7:1.5.0.2
	OPENBSD_2_7_BASE:1.5
	OPENBSD_2_6:1.2.0.2
	OPENBSD_2_6_BASE:1.2;
locks; strict;
comment	@# @;


1.6
date	2000.05.29.21.39.27;	author angelos;	state dead;
branches;
next	1.5;

1.5
date	2000.04.02.05.55.57;	author brad;	state Exp;
branches
	1.5.2.1;
next	1.4;

1.4
date	2000.01.30.06.23.43;	author brad;	state Exp;
branches;
next	1.3;

1.3
date	99.12.07.05.32.00;	author brad;	state Exp;
branches;
next	1.2;

1.2
date	99.09.01.18.19.04;	author brad;	state Exp;
branches;
next	1.1;

1.1
date	99.07.27.04.05.49;	author brad;	state Exp;
branches;
next	;

1.5.2.1
date	2000.09.15.05.09.58;	author marc;	state dead;
branches;
next	;


desc
@@


1.6
log
@Update to v2.53 (from halogen@@nol.net)
@
text
@--- tcpip.c.orig	Sun Mar 26 04:59:38 2000
+++ tcpip.c	Sat Apr  1 21:03:24 2000
@@@@ -977,6 +977,7 @@@@
  switch(datalink) {
  case DLT_EN10MB: offset = 14; break;
  case DLT_IEEE802: offset = 22; break;
+ case DLT_LOOP:
  case DLT_NULL: offset = 4; break;
  case DLT_SLIP:
 #ifdef DLT_SLIP_BSDOS
@@@@ -1004,6 +1005,7 @@@@
    break;
  case DLT_RAW: offset = 0; break;
  case DLT_FDDI: offset = 21; break;
+ case DLT_ENC: offset = 12; break;
  default: fatal("Unknown datalink type (%d)", datalink);
  }
 
@


1.5
log
@upgrade to nmap 2.3b17
@
text
@@


1.5.2.1
log
@bring net as of cut-over date into 2.7 branch
@
text
@@


1.4
log
@upgrade to nmap 2.3b14
@
text
@d1 3
a3 3
--- tcpip.c.orig	Thu Jan 27 04:52:19 2000
+++ tcpip.c	Sun Jan 30 01:06:43 2000
@@@@ -963,6 +963,7 @@@@
d11 1
a11 1
@@@@ -990,6 +991,7 @@@@
@


1.3
log
@upgrade to nmap 2.3b8
@
text
@d1 3
a3 3
--- tcpip.c.orig	Mon Nov  8 03:10:35 1999
+++ tcpip.c	Sun Nov 21 18:34:54 1999
@@@@ -773,6 +773,7 @@@@
d11 1
a11 1
@@@@ -800,6 +801,7 @@@@
@


1.2
log
@upgrade to nmap 2.3b4
@
text
@d1 2
a2 2
--- tcpip.c.orig	Tue Aug  3 00:29:31 1999
+++ tcpip.c	Wed Sep  1 12:12:30 1999
d11 1
a11 2
@@@@ -799,6 +800,7 @@@@
 #endif /* if freebsd || openbsd || netbsd || bsdi */
d14 1
@


1.1
log
@- strip nmap binary on installation
- make nmap use the systems libpcap
- make nmap work with datalink types of DLT_LOOP and DLT_ENC
@
text
@d1 11
a11 11
--- tcpip.c.orig	Mon Jul 26 23:42:08 1999
+++ tcpip.c	Mon Jul 26 23:44:55 1999
@@@@ -774,6 +774,7 @@@@
   switch(datalink) {
   case DLT_EN10MB: offset = 14; break;
   case DLT_IEEE802: offset = 22; break;
+  case DLT_LOOP:
   case DLT_NULL: offset = 4; break;
   case DLT_SLIP:
 #if (FREEBSD || OPENBSD || NETBSD || BSDI)
@@@@ -794,6 +795,7 @@@@
d13 6
a18 6
     break;
   case DLT_RAW: offset = 0; break;
+  case DLT_ENC: offset = 12; break;
   default: fatal("Unknown datalink type (%d)", datalink);
   }
 }
@

