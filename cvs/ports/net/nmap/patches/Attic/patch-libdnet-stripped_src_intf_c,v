head	1.4;
access;
symbols
	OPENBSD_5_4:1.3.0.2
	OPENBSD_5_4_BASE:1.3
	OPENBSD_5_3:1.2.0.2
	OPENBSD_5_3_BASE:1.2;
locks; strict;
comment	@# @;


1.4
date	2014.02.10.17.43.15;	author sthen;	state dead;
branches;
next	1.3;

1.3
date	2013.05.10.12.27.45;	author giovanni;	state Exp;
branches;
next	1.2;

1.2
date	2012.12.19.17.12.11;	author giovanni;	state Exp;
branches;
next	1.1;

1.1
date	2012.11.16.17.05.13;	author sthen;	state Exp;
branches;
next	;


desc
@@


1.4
log
@Update nmap to 6.40, and build with their bundled libpcap for now, bpf_timeval
patches are questionable and there's a timing-related problem to track down.
From giovanni@@ (maintainer) a while ago. Add a fix from jca@@ to fix a floating-
point related assertion failure seen on i386, reminded by zhuk@@. Committing the
update rather than the minimal assertion-fix diff as it has been more
extensively tested in the past (then slipped through the cracks), jasper@@
agrees. OK jasper@@ giovanni@@
@
text
@$OpenBSD: patch-libdnet-stripped_src_intf_c,v 1.3 2013/05/10 12:27:45 giovanni Exp $
--- libdnet-stripped/src/intf.c.orig	Mon Sep 10 03:17:28 2012
+++ libdnet-stripped/src/intf.c	Fri May 10 09:54:54 2013
@@@@ -77,7 +77,13 @@@@
 /* XXX - superset of ifreq, for portable SIOC{A,D}IFADDR */
 struct dnet_ifaliasreq {
 	char		ifra_name[IFNAMSIZ];
-	struct sockaddr ifra_addr;
+	union {
+		struct sockaddr ifrau_addr;
+		int		ifrau_align;
+	} ifra_ifrau;
+#ifndef ifra_addr
+#define ifra_addr	ifra_ifrau.ifrau_addr
+#endif
 	struct sockaddr ifra_brdaddr;
 	struct sockaddr ifra_mask;
 	int		ifra_cookie;	/* XXX - IRIX!@@#$ */
@@@@ -308,7 +314,7 @@@@ intf_set(intf_t *intf, const struct intf_entry *entry)
 	}
 	/* Set interface address. */
 	if (entry->intf_addr.addr_type == ADDR_TYPE_IP) {
-#ifdef BSD
+#if defined(BSD) && !defined(__OpenBSD__)
 		/* XXX - why must this happen before SIOCSIFADDR? */
 		if (addr_btos(entry->intf_addr.addr_bits,
 		    &ifr.ifr_addr) == 0) {
@


1.3
log
@
Do not issue SIOCSIFNETMASK before SIOCSIFADDR in libdnet-stripped code, it is not needed and will
fail after upcoming change.
This code is not used by nmap but is better to keep it in sync with net/libdnet
ok sthen@@ mpi@@
@
text
@d1 1
a1 1
$OpenBSD: patch-libdnet-stripped_src_intf_c,v 1.2 2012/12/19 17:12:11 giovanni Exp $
@


1.2
log
@
Update to 6.25
lot of improvements in nse scripting engine and in ipv6 support
Full changelog: http://nmap.org/changelog.html
Help and ok sthen@@ and dcoppa@@
@
text
@d1 1
a1 1
$OpenBSD: patch-libdnet-stripped_src_intf_c,v 1.1 2012/11/16 17:05:13 sthen Exp $
d3 1
a3 1
+++ libdnet-stripped/src/intf.c	Fri Nov 30 12:41:47 2012
d19 9
@


1.1
log
@cope with net/if.h struct changes.
@
text
@d1 4
a4 4
$OpenBSD$
--- libdnet-stripped/src/intf.c.orig	Wed Nov 14 04:18:29 2012
+++ libdnet-stripped/src/intf.c	Wed Nov 14 04:19:10 2012
@@@@ -76,7 +76,13 @@@@
@

