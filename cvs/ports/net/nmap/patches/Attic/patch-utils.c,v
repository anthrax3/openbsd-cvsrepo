head	1.3;
access;
symbols
	OPENBSD_3_4:1.2.0.12
	OPENBSD_3_4_BASE:1.2
	OPENBSD_3_3:1.2.0.10
	OPENBSD_3_3_BASE:1.2
	OPENBSD_3_2:1.2.0.8
	OPENBSD_3_2_BASE:1.2
	OPENBSD_3_1:1.2.0.6
	OPENBSD_3_1_BASE:1.2
	OPENBSD_3_0:1.2.0.4
	OPENBSD_3_0_BASE:1.2
	OPENBSD_2_9_TRACKING_SWITCH:1.2
	OPENBSD_2_9:1.2.0.2
	OPENBSD_2_9_BASE:1.2;
locks; strict;
comment	@ * @;


1.3
date	2003.12.09.18.42.37;	author brad;	state dead;
branches;
next	1.2;

1.2
date	2001.01.09.16.10.17;	author naddy;	state Exp;
branches;
next	1.1;

1.1
date	2000.11.19.12.45.59;	author dugsong;	state Exp;
branches;
next	;


desc
@@


1.3
log
@upgrade to nmap 3.48
--
From: MAINTAINER
New MAINTAINER: Dan Weeks <danimal at danimal dot org>
@
text
@$OpenBSD: patch-utils.c,v 1.2 2001/01/09 16:10:17 naddy Exp $
--- utils.c.orig	Thu Oct  5 05:46:19 2000
+++ utils.c	Mon Jan  8 02:29:18 2001
@@@@ -184,6 +184,23 @@@@ get_random_bytes(&s, sizeof(unsigned sho
 return s;
 }
 
+#ifdef __OpenBSD__
+int get_random_bytes(void *buf, int numbytes)
+{
+	u_int32_t i;
+	
+	while (numbytes > 4) {
+		*(u_int32_t *)buf = arc4random();
+		buf += 4;
+		numbytes -= 4;
+	}
+	if (numbytes > 0) {
+		i = arc4random();
+		memcpy(buf, &i, numbytes);
+	}
+	return 0;
+}
+#else
 int get_random_bytes(void *buf, int numbytes) {
 static char bytebuf[2048];
 static char badrandomwarning = 0;
@@@@ -239,6 +256,7 @@@@ tmp = bytesleft;
 bytesleft = 0;
 return get_random_bytes((char *)buf + tmp, numbytes - tmp);
 }
+#endif /* OpenBSD */
 
 /* Scramble the contents of an array*/
 void genfry(unsigned char *arr, int elem_sz, int num_elem) {
@


1.2
log
@- new maintainer: Brian Caswell <bmc@@mitre.org>; ok angelos@@
- update to nmap-2.54BETA7 and include nmapfe; from bmc@@mitre.org
- clean up port
@
text
@d1 1
a1 1
$OpenBSD$
@


1.1
log
@don't exhaust kernel entropy pool
@
text
@d1 4
a4 3
--- utils.c.orig	Thu Oct  5 01:46:19 2000
+++ utils.c	Sat Nov 18 00:55:54 2000
@@@@ -184,6 +184,23 @@@@
d28 1
a28 1
@@@@ -239,6 +256,7 @@@@
@

