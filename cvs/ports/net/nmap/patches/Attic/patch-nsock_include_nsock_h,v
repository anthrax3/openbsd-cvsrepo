head	1.9;
access;
symbols
	OPENBSD_5_4:1.8.0.4
	OPENBSD_5_4_BASE:1.8
	OPENBSD_5_3:1.8.0.2
	OPENBSD_5_3_BASE:1.8
	OPENBSD_5_2:1.7.0.2
	OPENBSD_5_2_BASE:1.7
	OPENBSD_5_1_BASE:1.6
	OPENBSD_5_1:1.6.0.4
	OPENBSD_5_0:1.6.0.2
	OPENBSD_5_0_BASE:1.6
	OPENBSD_4_9:1.5.0.4
	OPENBSD_4_9_BASE:1.5
	OPENBSD_4_8:1.5.0.2
	OPENBSD_4_8_BASE:1.5
	OPENBSD_4_7:1.4.0.2
	OPENBSD_4_7_BASE:1.4
	OPENBSD_4_6:1.3.0.4
	OPENBSD_4_6_BASE:1.3
	OPENBSD_4_5:1.3.0.2
	OPENBSD_4_5_BASE:1.3
	OPENBSD_4_4:1.2.0.2
	OPENBSD_4_4_BASE:1.2
	OPENBSD_4_3:1.1.0.2
	OPENBSD_4_3_BASE:1.1;
locks; strict;
comment	@# @;


1.9
date	2014.02.10.17.43.15;	author sthen;	state dead;
branches;
next	1.8;

1.8
date	2012.12.19.17.12.11;	author giovanni;	state Exp;
branches;
next	1.7;

1.7
date	2012.07.16.07.39.31;	author giovanni;	state Exp;
branches;
next	1.6;

1.6
date	2011.03.28.09.01.24;	author giovanni;	state Exp;
branches;
next	1.5;

1.5
date	2010.04.21.07.08.23;	author giovanni;	state Exp;
branches;
next	1.4;

1.4
date	2009.10.22.10.00.57;	author giovanni;	state Exp;
branches;
next	1.3;

1.3
date	2008.09.17.18.09.54;	author kili;	state Exp;
branches;
next	1.2;

1.2
date	2008.06.17.21.18.03;	author steven;	state Exp;
branches;
next	1.1;

1.1
date	2008.01.25.01.21.17;	author okan;	state Exp;
branches;
next	;


desc
@@


1.9
log
@Update nmap to 6.40, and build with their bundled libpcap for now, bpf_timeval
patches are questionable and there's a timing-related problem to track down.
From giovanni@@ (maintainer) a while ago. Add a fix from jca@@ to fix a floating-
point related assertion failure seen on i386, reminded by zhuk@@. Committing the
update rather than the minimal assertion-fix diff as it has been more
extensively tested in the past (then slipped through the cracks), jasper@@
agrees. OK jasper@@ giovanni@@
@
text
@$OpenBSD: patch-nsock_include_nsock_h,v 1.8 2012/12/19 17:12:11 giovanni Exp $
--- nsock/include/nsock.h.orig	Mon Nov 12 21:44:37 2012
+++ nsock/include/nsock.h	Fri Nov 30 12:41:48 2012
@@@@ -90,6 +90,8 @@@@
 extern "C" {
 #endif
 
+#include <pcap.h>
+
 /* The read calls will generally return after reading at least this
  * much data so that the caller can process it and so that the
  * connection spewing data doesn't monopolize resources.  The caller
@@@@ -186,7 +188,7 @@@@ void *nsp_getud(nsock_pool nsp);
  * everything.  The basetime can be NULL to print trace lines with the current
  * time, otherwise the difference between the current time and basetime will be
  * used (the time program execution starts would be a good candidate) */
-void nsp_settrace(nsock_pool nsp, FILE *file, int level, const struct timeval *basetime);
+void nsp_settrace(nsock_pool nsp, FILE *file, int level, const struct bpf_timeval *basetime);
 
 /* Turns on or off broadcast support on new sockets. Default is off (0, false)
  * set in nsp_new(). Any non-zero (true) value sets SO_BROADCAST on all new
@@@@ -550,7 +552,7 @@@@ int nsock_event_cancel(nsock_pool ms_pool, nsock_event
  * avoid a system call, but in many circumstances it is better to use nsock's
  * time rather than the system time.  If nsock has never obtained the time when
  * you call it, it will do so before returning */
-const struct timeval *nsock_gettimeofday();
+const struct bpf_timeval *nsock_gettimeofday();
 
 
 #ifdef HAVE_PCAP
@@@@ -581,7 +583,7 @@@@ nsock_event_id nsock_pcap_read_packet(nsock_pool nsp, 
  * think that host is a bit further.
  * */
 void nse_readpcap(nsock_event nsee, const unsigned char **l2_data, size_t *l2_len, const unsigned char **l3_data, size_t *l3_len,
-                  size_t *packet_len, struct timeval *ts);
+                  size_t *packet_len, struct bpf_timeval *ts);
 
 /* Well. Just pcap-style datalink. Like DLT_EN10MB or DLT_SLIP. Check in pcap(3) manpage. */
 int nsi_pcap_linktype(nsock_iod nsiod);
@


1.8
log
@
Update to 6.25
lot of improvements in nse scripting engine and in ipv6 support
Full changelog: http://nmap.org/changelog.html
Help and ok sthen@@ and dcoppa@@
@
text
@d1 1
a1 1
$OpenBSD: patch-nsock_include_nsock_h,v 1.7 2012/07/16 07:39:31 giovanni Exp $
@


1.7
log
@
Major update to 6.01
tests & ok benoit@@, thanks
@
text
@d1 4
a4 4
$OpenBSD: patch-nsock_include_nsock_h,v 1.6 2011/03/28 09:01:24 giovanni Exp $
--- nsock/include/nsock.h.orig	Thu Mar  1 10:05:02 2012
+++ nsock/include/nsock.h	Fri May 25 09:37:23 2012
@@@@ -80,6 +80,8 @@@@
d13 1
a13 1
@@@@ -176,7 +178,7 @@@@ void *nsp_getud(nsock_pool nsp);
d22 1
a22 1
@@@@ -514,7 +516,7 @@@@ int nsock_event_cancel(nsock_pool ms_pool, nsock_event
d31 1
a31 1
@@@@ -545,7 +547,7 @@@@ nsock_event_id nsock_pcap_read_packet(nsock_pool nsp, 
@


1.6
log
@
Update to version 5.51, lot of improvements since latest version,
full changelog available at http://nmap.org/changelog.html
Nping needs a very current libpcap to work as root
@
text
@d1 4
a4 4
$OpenBSD: patch-nsock_include_nsock_h,v 1.5 2010/04/21 07:08:23 giovanni Exp $
--- nsock/include/nsock.h.orig	Fri Jan 21 01:04:51 2011
+++ nsock/include/nsock.h	Wed Feb  2 13:12:14 2011
@@@@ -86,6 +86,8 @@@@
d13 24
a36 6
@@@@ -588,7 +590,7 @@@@ nsock_event_id nsock_pcap_read_packet(nsock_pool nsp, 
 void nse_readpcap(nsock_event nsee,
 	const unsigned char **l2_data, size_t *l2_len,
 	const unsigned char **l3_data, size_t *l3_len,
-	size_t *packet_len, struct timeval *ts); 
+	size_t *packet_len, struct bpf_timeval *ts); 
@


1.5
log
@
Update to nmap 5.21
@
text
@d1 4
a4 4
$OpenBSD: patch-nsock_include_nsock_h,v 1.4 2009/10/22 10:00:57 giovanni Exp $
--- nsock/include/nsock.h.orig	Thu Aug 20 23:36:58 2009
+++ nsock/include/nsock.h	Wed Jan 20 19:54:57 2010
@@@@ -79,6 +79,8 @@@@
d13 1
a13 1
@@@@ -563,7 +565,7 @@@@ nsock_event_id nsock_pcap_read_packet(nsock_pool nsp, 
@


1.4
log
@
Update to nmap-5.00
diff made by Pawlowski Marcin Piotr with tweaks by me and others
"you have my okay" landry@@ on a similar diff
full changelog available at http://nmap.org/changelog.html
@
text
@d1 3
a3 3
$OpenBSD: patch-nsock_include_nsock_h,v 1.3 2008/09/17 18:09:54 kili Exp $
--- nsock/include/nsock.h.orig	Sat May 30 01:19:07 2009
+++ nsock/include/nsock.h	Tue Jul 21 19:57:38 2009
d13 1
a13 1
@@@@ -542,7 +544,7 @@@@ nsock_event_id nsock_pcap_read_packet(nsock_pool nsp, 
@


1.3
log
@
Update to 4.76. From maintainer Giovanni Bechis <g.bechis@@snb.it>.

ok landry@@
@
text
@d1 3
a3 3
$OpenBSD: patch-nsock_include_nsock_h,v 1.2 2008/06/17 21:18:03 steven Exp $
--- nsock/include/nsock.h.orig	Mon Jul 14 21:37:26 2008
+++ nsock/include/nsock.h	Thu Sep 11 15:32:16 2008
d13 1
a13 1
@@@@ -523,7 +525,7 @@@@ nsock_event_id nsock_pcap_read_packet(nsock_pool nsp, 
@


1.2
log
@update to nmap 4.65

from maintainer Giovanni Bechis
@
text
@d1 3
a3 3
$OpenBSD: patch-nsock_include_nsock_h,v 1.1 2008/01/25 01:21:17 okan Exp $
--- nsock/include/nsock.h.orig	Thu May 22 20:14:15 2008
+++ nsock/include/nsock.h	Sat Jun 14 14:52:55 2008
d13 1
a13 1
@@@@ -514,7 +516,7 @@@@ nsock_event_id nsock_pcap_read_packet(nsock_pool nsp, 
@


1.1
log
@- update to 4.53 from Giovanni Bechis (MAINTAINER)
- re-work port from FLAVORS to MULTI_PACKAGES (-main, -zenmap)

lots of feedback and help from kili@@, merdely@@ and Giovanni

ok merdely@@ kili@@
@
text
@d1 4
a4 4
$OpenBSD$
--- nsock/include/nsock.h.orig	Sat Dec 22 07:32:18 2007
+++ nsock/include/nsock.h	Mon Jan 14 17:14:56 2008
@@@@ -78,6 +78,8 @@@@
d13 1
a13 1
@@@@ -513,7 +515,7 @@@@ nsock_event_id nsock_pcap_read_packet(nsock_pool nsp, 
@

