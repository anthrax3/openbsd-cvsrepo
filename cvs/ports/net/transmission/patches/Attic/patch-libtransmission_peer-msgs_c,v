head	1.2;
access;
symbols
	OPENBSD_5_5:1.2.0.2
	OPENBSD_5_1_BASE:1.1
	OPENBSD_5_1:1.1.0.2;
locks; strict;
comment	@# @;


1.2
date	2012.04.07.10.55.04;	author naddy;	state dead;
branches
	1.2.2.1;
next	1.1;

1.1
date	2011.09.23.09.12.32;	author naddy;	state Exp;
branches;
next	;

1.2.2.1
date	2014.07.22.07.28.24;	author jasper;	state Exp;
branches;
next	;
commitid	E4USU0DGNkyKjxYe;


desc
@@


1.2
log
@Update to 2.50.  Most notable changes in this version:
* overhauled web client
* various bug fixes

Switch to external miniupnp libs.
@
text
@$OpenBSD: patch-libtransmission_peer-msgs_c,v 1.1 2011/09/23 09:12:32 naddy Exp $
--- libtransmission/peer-msgs.c.orig	Thu Jul 21 01:38:56 2011
+++ libtransmission/peer-msgs.c	Mon Sep 19 15:32:25 2011
@@@@ -16,8 +16,6 @@@@
 #include <stdlib.h>
 #include <string.h>
 
-#include <alloca.h>
-
 #include <event2/buffer.h>
 #include <event2/bufferevent.h>
 #include <event2/event.h>
@


1.2.2.1
log
@Security fix for CVE-2014-4909,
transmission peer communication vulnerability
@
text
@d1 6
a6 30
$OpenBSD$

Security fix for CVE-2014-4909,
transmission peer communication vulnerability

https://trac.transmissionbt.com/changeset/14303

--- libtransmission/peer-msgs.c.orig	Fri Aug  9 04:45:40 2013
+++ libtransmission/peer-msgs.c	Tue Jul 22 09:19:23 2014
@@@@ -32,6 +32,10 @@@@
 #include "torrent.h"
 #include "torrent-magnet.h"
 #include "tr-dht.h"
+
+#ifndef EBADMSG
+ #define EBADMSG EINVAL
+#endif
 #include "utils.h"
 #include "variant.h"
 #include "version.h"
@@@@ -1692,6 +1696,12 @@@@ clientGotBlock (tr_peerMsgs                * msgs,
     int err;
     tr_torrent * tor = msgs->torrent;
     const tr_block_index_t block = _tr_block (tor, req->index, req->offset);
+
+    if (!requestIsValid (msgs, req)) {
+        dbgmsg (msgs, "dropping invalid block %u:%u->%u",
+                req->index, req->offset, req->length);
+        return EBADMSG;
+    }
d8 5
a12 2
     assert (msgs);
     assert (req);
@


1.1
log
@Update to 2.33 for various bug fixes and improvements.

Support for the uTP protocol is disabled because of pervasive unaligned
accesses in the corresponding code.
@
text
@d1 1
a1 1
$OpenBSD$
@

