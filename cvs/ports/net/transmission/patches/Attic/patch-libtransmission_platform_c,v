head	1.2;
access;
symbols
	OPENBSD_5_4:1.1.0.2
	OPENBSD_5_4_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2013.08.09.19.13.08;	author naddy;	state dead;
branches;
next	1.1;

1.1
date	2013.07.12.17.03.59;	author naddy;	state Exp;
branches;
next	;


desc
@@


1.2
log
@update to 2.81 for some bug fixes; ok brad@@
@
text
@$OpenBSD: patch-libtransmission_platform_c,v 1.1 2013/07/12 17:03:59 naddy Exp $
--- libtransmission/platform.c.orig	Wed Jun 26 04:35:25 2013
+++ libtransmission/platform.c	Sat Jul  6 21:57:56 2013
@@@@ -12,7 +12,7 @@@@
 
 #ifndef WIN32
  #include <sys/types.h> /* types needed by quota.h */
- #ifdef __FreeBSD__
+ #if defined(__FreeBSD__) || defined(__OpenBSD__)
   #include <ufs/ufs/quota.h> /* quotactl() */
  #elif defined (__sun)
   #include <sys/fs/ufs_quota.h> /* quotactl */
@@@@ -751,7 +751,7 @@@@ getquota (const char * device)
   int64_t freespace;
   int64_t spaceused;
 
-#if defined(__FreeBSD__) || defined(SYS_DARWIN)
+#if defined(__FreeBSD__) || defined(__OpenBSD__) || defined(SYS_DARWIN)
   if (quotactl(device, QCMD(Q_GETQUOTA, USRQUOTA), getuid(), (caddr_t) &dq) == 0)
     {
 #elif defined(__sun)
@@@@ -783,7 +783,7 @@@@ getquota (const char * device)
           /* No quota enabled for this user */
           return -1;
         }
-#if defined(__FreeBSD__)
+#if defined(__FreeBSD__) || defined(__OpenBSD__)
       spaceused = (int64_t) dq.dqb_curblocks >> 1;
 #elif defined(SYS_DARWIN)
       spaceused = (int64_t) dq.dqb_curbytes;
@


1.1
log
@update to 2.80 for miscellaneous small improvements
https://trac.transmissionbt.com/wiki/Changes#version-2.80
@
text
@d1 1
a1 1
$OpenBSD$
@

