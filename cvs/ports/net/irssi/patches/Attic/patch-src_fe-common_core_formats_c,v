head	1.1;
access;
symbols
	OPENBSD_6_0:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2016.09.22.17.54.36;	author danj;	state dead;
branches
	1.1.2.1;
next	;
commitid	hvISF6YnDIcm5PS6;

1.1.2.1
date	2016.09.22.17.54.36;	author danj;	state Exp;
branches;
next	1.1.2.2;
commitid	hvISF6YnDIcm5PS6;

1.1.2.2
date	2017.01.09.16.28.59;	author robert;	state dead;
branches;
next	;
commitid	O4YlBERwScNgCE6q;


desc
@@


1.1
log
@file patch-src_fe-common_core_formats_c was initially added on branch OPENBSD_6_0.
@
text
@@


1.1.2.1
log
@backport the diff to fix CVE-2016-7044 and CVE-2016-7045

ok sthen@@ tj@@
@
text
@a0 22
$OpenBSD$
--- src/fe-common/core/formats.c.orig	Sun Mar 20 22:18:46 2016
+++ src/fe-common/core/formats.c	Wed Sep 21 21:54:48 2016
@@@@ -131,6 +131,8 @@@@ void unformat_24bit_color(char **ptr, int off, int *fg
 	unsigned char rgbx[4];
 	unsigned int i;
 	for (i = 0; i < 4; ++i) {
+		if ((*ptr)[i + off] == '\0')
+			return;
 		rgbx[i] = (*ptr)[i + off];
 	}
 	rgbx[3] -= 0x20;
@@@@ -1357,6 +1359,9 @@@@ void format_send_to_gui(TEXT_DEST_REC *dest, const cha
 					bgcolor = *ptr==(char)0xff ? -1 : *ptr-'0';
 				}
 			}
+			if (*ptr == '\0')
+				break;
+
 			ptr++;
 			break;
 		case 6:
@


1.1.2.2
log
@backport the security update to 0.8.21 (minimal patches to fix security issues
only)

(a) A NULL pointer dereference in the nickcmp function found by Joseph
    Bisch. (CWE-690)

(b) Use after free when receiving invalid nick message (Issue #466, CWE-146)

(c) Out of bounds read in certain incomplete control codes found by
    Joseph Bisch. (CWE-126)

(d) Out of bounds read in certain incomplete character sequences found
    by Hanno BÃ¶ck and independently by J. Bisch. (CWE-126)
@
text
@d1 1
a1 1
$OpenBSD: patch-src_fe-common_core_formats_c,v 1.1.2.1 2016/09/22 17:54:36 danj Exp $
@


