head	1.1;
access;
symbols
	OPENBSD_6_1:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2017.06.07.17.08.34;	author danj;	state dead;
branches
	1.1.2.1;
next	;
commitid	v0qf6CpOeyNsKBg2;

1.1.2.1
date	2017.06.07.17.08.34;	author danj;	state Exp;
branches;
next	;
commitid	v0qf6CpOeyNsKBg2;


desc
@@


1.1
log
@file patch-src_irc_dcc_dcc-resume_c was initially added on branch OPENBSD_6_1.
@
text
@@


1.1.2.1
log
@backport patches for CVE-2017-9468 and CVE-2017-9469

ok awolk@@, Wiktor Izdebski (maintainer)
@
text
@a0 12
$OpenBSD$
--- src/irc/dcc/dcc-resume.c.orig	Tue Jun  6 18:03:50 2017
+++ src/irc/dcc/dcc-resume.c	Tue Jun  6 18:03:00 2017
@@@@ -62,6 +62,8 @@@@ int get_file_params_count_resume(char **params, int pa
 	if (*params[0] == '"') {
 		/* quoted file name? */
 		for (pos = 0; pos < paramcount-2; pos++) {
+			if (strlen(params[pos]) == 0)
+				continue;
 			if (params[pos][strlen(params[pos])-1] == '"' &&
 			    get_params_match_resume(params, pos+1))
 				return pos+1;
@

