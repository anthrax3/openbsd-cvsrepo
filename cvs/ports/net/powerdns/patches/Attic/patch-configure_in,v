head	1.3;
access;
symbols
	OPENBSD_5_7:1.2.0.14
	OPENBSD_5_7_BASE:1.2
	OPENBSD_5_6:1.2.0.12
	OPENBSD_5_6_BASE:1.2
	OPENBSD_5_5:1.2.0.10
	OPENBSD_5_5_BASE:1.2
	OPENBSD_5_4:1.2.0.8
	OPENBSD_5_4_BASE:1.2
	OPENBSD_5_3:1.2.0.6
	OPENBSD_5_3_BASE:1.2
	OPENBSD_5_2:1.2.0.4
	OPENBSD_5_2_BASE:1.2
	OPENBSD_5_1_BASE:1.2
	OPENBSD_5_1:1.2.0.2
	OPENBSD_5_0:1.1.0.10
	OPENBSD_5_0_BASE:1.1
	OPENBSD_4_9:1.1.0.8
	OPENBSD_4_9_BASE:1.1
	OPENBSD_4_8:1.1.0.6
	OPENBSD_4_8_BASE:1.1
	OPENBSD_4_7:1.1.0.4
	OPENBSD_4_7_BASE:1.1
	OPENBSD_4_6:1.1.0.2
	OPENBSD_4_6_BASE:1.1;
locks; strict;
comment	@# @;


1.3
date	2015.04.14.18.10.27;	author florian;	state dead;
branches;
next	1.2;
commitid	Lg7dNBY14HoseEFJ;

1.2
date	2011.10.24.19.47.55;	author sthen;	state Exp;
branches;
next	1.1;

1.1
date	2009.06.23.22.59.57;	author sthen;	state Exp;
branches
	1.1.10.1;
next	;

1.1.10.1
date	2012.01.11.02.01.18;	author sthen;	state Exp;
branches;
next	1.1.10.2;

1.1.10.2
date	2012.04.05.09.15.38;	author sthen;	state Exp;
branches;
next	;


desc
@@


1.3
log
@Update to 3.4.3.
This is a major upgrade from the old 2.9.x version, refer to
https://doc.powerdns.com/md/authoritative/upgrading/ for upgrading
instructions.
testing by me and weerd@@
Input, tweaks and OK sthen@@
@
text
@$OpenBSD: patch-configure_in,v 1.2 2011/10/24 19:47:55 sthen Exp $
--- configure.in.orig	Sun Jan 25 12:25:37 2009
+++ configure.in	Fri Oct 21 08:16:12 2011
@@@@ -87,12 +87,6 @@@@ linux*)
 	THREADFLAGS="-pthread"
 	CXXFLAGS="-D_GNU_SOURCE $CXXFLAGS"
 	;;
-openbsd*)
-	AC_DEFINE(HAVE_IPV6,1,[If the host operating system understands IPv6])
-	DYNLINKFLAGS="-rdynamic"
-	LDFLAGS="-lc_r $LDFLAGS"
-	CXXFLAGS="-pthread $CXXFLAGS"
-	;;
 *)
 	AC_DEFINE(HAVE_IPV6,1,[If the host operating system understands IPv6])
 	DYNLINKFLAGS="-rdynamic"
@


1.2
log
@From Brad:

- Update the autoconf script now that our gcc properly obeys -rdynamic
- Improve patch for dns.hh header

From me:

- Add an rc script
@
text
@d1 1
a1 1
$OpenBSD: patch-configure_in,v 1.1 2009/06/23 22:59:57 sthen Exp $
@


1.1
log
@- update to 2.9.22, enable ldap.

- unbreak modules; when any module was enabled pdns_server was failing
to start up(!). Brad traced this to a LINK_SPEC problem and came up
with the workaround in patch-configure_in, thanks very much!

- set SHARED_ONLY and merge PFRAG.shared into PLISTs; PowerDNS itself
can work static-only, but you need to compile-in the relevant modules,
which doesn't mix well with MULTI_PACKAGES.

mysql backend is tested; other backends not yet, but this is a big
improvement on what's there at the moment.
@
text
@d1 6
a6 7
$OpenBSD$

workaround OpenBSD gcc LINK_SPEC problem (not obeying -rdynamic)

--- configure.in.orig	Tue Jun 23 05:50:24 2009
+++ configure.in	Tue Jun 23 05:52:40 2009
@@@@ -89,8 +89,8 @@@@ linux*)
d8 2
a9 2
 openbsd*)
 	AC_DEFINE(HAVE_IPV6,1,[If the host operating system understands IPv6])
d12 2
a13 4
+	DYNLINKFLAGS="-Wl,-export-dynamic"
+	LDFLAGS="-pthread $LDFLAGS"
 	CXXFLAGS="-pthread $CXXFLAGS"
 	;;
d15 2
@


1.1.10.1
log
@MFC: update to PowerDNS 2.9.22.5; CVE-2012-0206; can be caused to loop packets
http://doc.powerdns.com/powerdns-advisory-2012-01.html - From Brad

With a slight tweak as BASESYSCONFDIR was not supported in 5.0
@
text
@d1 7
a7 6
$OpenBSD: patch-configure_in,v 1.2 2011/10/24 19:47:55 sthen Exp $
--- configure.in.orig	Sun Jan 25 12:25:37 2009
+++ configure.in	Fri Oct 21 08:16:12 2011
@@@@ -87,12 +87,6 @@@@ linux*)
 	THREADFLAGS="-pthread"
 	CXXFLAGS="-D_GNU_SOURCE $CXXFLAGS"
d9 2
a10 2
-openbsd*)
-	AC_DEFINE(HAVE_IPV6,1,[If the host operating system understands IPv6])
d13 4
a16 2
-	CXXFLAGS="-pthread $CXXFLAGS"
-	;;
a17 2
 	AC_DEFINE(HAVE_IPV6,1,[If the host operating system understands IPv6])
 	DYNLINKFLAGS="-rdynamic"
@


1.1.10.2
log
@Restore -rdynamic -> -Wl,-export-dynamic patch for PowerDNS in 5.0-stable,
this is still needed until post-5.0.

Problem reported by mailinglist@@modernbiztonsag.org, cause identified by
Brad, diff from me, no response to testing request but it should be correct.
@
text
@d1 6
a6 8
$OpenBSD: patch-configure_in,v 1.1.10.1 2012/01/11 02:01:18 sthen Exp $

workaround OpenBSD gcc LINK_SPEC problem (not obeying -rdynamic)
fixed in 5.1

--- configure.in.orig	Mon Jan 16 08:30:30 2012
+++ configure.in	Fri Mar 30 01:43:30 2012
@@@@ -89,8 +89,8 @@@@ linux*)
d8 2
a9 2
 openbsd*)
 	AC_DEFINE(HAVE_IPV6,1,[If the host operating system understands IPv6])
d12 2
a13 4
+	DYNLINKFLAGS="-Wl,-export-dynamic"
+	LDFLAGS="-pthread $LDFLAGS"
 	CXXFLAGS="-pthread $CXXFLAGS"
 	;;
d15 2
@


