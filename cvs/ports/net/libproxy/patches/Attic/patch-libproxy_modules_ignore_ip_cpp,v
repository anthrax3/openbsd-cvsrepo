head	1.2;
access;
symbols
	OPENBSD_6_0:1.1.0.2
	OPENBSD_6_0_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2016.08.27.13.37.40;	author ajacoutot;	state dead;
branches;
next	1.1;
commitid	C2g7CiwsCJHgUUla;

1.1
date	2016.04.18.17.44.40;	author awolk;	state Exp;
branches;
next	;
commitid	APIuRmwpw7hUcd17;


desc
@@


1.2
log
@Update to libproxy-0.4.13.
- drop gettext module
- take maintainer
@
text
@$OpenBSD: patch-libproxy_modules_ignore_ip_cpp,v 1.1 2016/04/18 17:44:40 awolk Exp $
https://github.com/libproxy/libproxy/issues/24
--- libproxy/modules/ignore_ip.cpp.orig	Mon Apr 18 18:14:53 2016
+++ libproxy/modules/ignore_ip.cpp	Mon Apr 18 18:15:26 2016
@@@@ -147,7 +147,7 @@@@ class ip_ignore_extension : public ignore_extension { 
 			else
 			{
 				/* If CIDR notation was used, get the netmask */
-				if (sscanf(mask.c_str(), "%d", &cidr) == 1)
+				if (ign_ip && sscanf(mask.c_str(), "%d", &cidr) == 1)
 					net_ip = sockaddr_from_cidr(ign_ip->sa_family, cidr);
 			}
 
@


1.1
log
@Add a patch to prevent a null pointer dereference in net/libproxy under Gnome

Qt5 started to use libproxy and this exposed a crashing bug on OpenBSD
when using Qt5 applications on Gnome 3.

Here's a sample backtrace:
https://gist.github.com/mulander/c03997ae7e3fe4e30af0d4f2ce2965f0

The issue is caused by an unguarded dereference of ign_ip.

Other parts of the code properly expect that sockaddr_from_string
might return null and guard against it.

Adding a proper guard prevents a segfault both in OpenBSD
www/otter-browser and devel/zeal.

Issue reported upstream in:
 https://github.com/libproxy/libproxy/issues/24

OK zhuk@@ aja@@
@
text
@d1 1
a1 1
$OpenBSD$
@

