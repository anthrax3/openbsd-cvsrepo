head	1.1;
access;
symbols
	OPENBSD_5_5:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2014.07.24.12.20.06;	author robert;	state dead;
branches
	1.1.2.1;
next	;
commitid	cOs8lzcTgZD5Ekhb;

1.1.2.1
date	2014.07.24.12.20.06;	author robert;	state Exp;
branches;
next	;
commitid	cOs8lzcTgZD5Ekhb;


desc
@@


1.1
log
@file patch-frontends_php_include_classes_import_CXmlImport18_php was initially added on branch OPENBSD_5_5.
@
text
@@


1.1.2.1
log
@backport security fix for a Local File Inclusion via XXE Attack vulnerability
https://support.zabbix.com/browse/ZBX-8151

ok jasper@@
@
text
@a0 19
$OpenBSD$
--- frontends/php/include/classes/import/CXmlImport18.php.orig	Mon Dec  9 10:15:15 2013
+++ frontends/php/include/classes/import/CXmlImport18.php	Thu Jul 24 14:18:50 2014
@@@@ -392,12 +392,13 @@@@ class CXmlImport18 {
 		return $array;
 	}
 
-	public static function import($file) {
+	public static function import($source) {
 
 		libxml_use_internal_errors(true);
+		libxml_disable_entity_loader(true);
 
 		$xml = new DOMDocument();
-		if (!$xml->loadXML($file)) {
+		if (!$xml->loadXML($source, LIBXML_IMPORT_FLAGS)) {
 			$text = '';
 			foreach (libxml_get_errors() as $error) {
 				switch ($error->level) {
@

