head	1.11;
access;
symbols
	OPENBSD_6_2:1.11.0.10
	OPENBSD_6_2_BASE:1.11
	OPENBSD_6_1:1.11.0.8
	OPENBSD_6_1_BASE:1.11
	OPENBSD_6_0:1.11.0.6
	OPENBSD_6_0_BASE:1.11
	OPENBSD_5_9:1.11.0.2
	OPENBSD_5_9_BASE:1.11
	OPENBSD_5_8:1.11.0.4
	OPENBSD_5_8_BASE:1.11
	OPENBSD_5_7:1.10.0.2
	OPENBSD_5_7_BASE:1.10
	OPENBSD_5_6:1.9.0.6
	OPENBSD_5_6_BASE:1.9
	OPENBSD_5_5:1.9.0.4
	OPENBSD_5_5_BASE:1.9
	OPENBSD_5_4:1.9.0.2
	OPENBSD_5_4_BASE:1.9
	OPENBSD_5_3:1.6.0.2
	OPENBSD_5_3_BASE:1.6
	OPENBSD_5_2:1.5.0.4
	OPENBSD_5_2_BASE:1.5
	OPENBSD_5_1_BASE:1.5
	OPENBSD_5_1:1.5.0.2
	OPENBSD_5_0:1.4.0.2
	OPENBSD_5_0_BASE:1.4
	OPENBSD_4_9:1.3.0.2
	OPENBSD_4_9_BASE:1.3;
locks; strict;
comment	@# @;


1.11
date	2015.07.17.20.38.43;	author ajacoutot;	state Exp;
branches;
next	1.10;
commitid	SollY0D7VhKVIO4J;

1.10
date	2014.09.14.05.58.07;	author ajacoutot;	state Exp;
branches;
next	1.9;
commitid	Wm0mDRCXhQhfZWj1;

1.9
date	2013.06.06.13.57.48;	author ajacoutot;	state Exp;
branches;
next	1.8;

1.8
date	2013.06.05.14.38.08;	author ajacoutot;	state Exp;
branches;
next	1.7;

1.7
date	2013.03.17.07.21.17;	author ajacoutot;	state Exp;
branches;
next	1.6;

1.6
date	2012.10.10.22.04.57;	author robert;	state Exp;
branches;
next	1.5;

1.5
date	2011.08.21.09.21.02;	author ajacoutot;	state Exp;
branches;
next	1.4;

1.4
date	2011.06.02.13.41.40;	author ajacoutot;	state Exp;
branches;
next	1.3;

1.3
date	2011.01.04.16.03.00;	author ajacoutot;	state Exp;
branches;
next	1.2;

1.2
date	2010.12.06.19.06.59;	author ajacoutot;	state Exp;
branches;
next	1.1;

1.1
date	2010.11.22.15.39.21;	author ajacoutot;	state Exp;
branches;
next	;


desc
@@


1.11
log
@Change the instructions to use su(1) instead of sudo(1).
@
text
@$OpenBSD: README-server,v 1.10 2014/09/14 05:58:07 ajacoutot Exp $

+-----------------------------------------------------------------------
| Running ${FULLPKGNAME} on OpenBSD
+-----------------------------------------------------------------------

NOTE for users updating from version <1.8.6 using a node-based
distributed setup, see
    http://www.zabbix.com/rn1.8.6.php
for improving performance of configuration syncing.

The original documentation is available as a PDF file at
    ${HOMEPAGE}

A manual is available at:
    http://www.zabbix.com/documentation/${MAJV}/complete

On OpenBSD, Zabbix is packaged in three parts:

- the agent (in the zabbix-agent package) for installing onto a
monitored machine. To simplify installation from ports on client
machines, only this part is built by default.

- the server and proxy (in the database-dependent zabbix-server
package); this has heavier dependencies and is built by selecting
the FLAVOR for the database you use (currently mysql, pgsql or sqlite3).

- the web interface to run with the server (in the zabbix-web package).

Before doing anything, you have to adapt the configuration files under
    ${SYSCONFDIR}/zabbix/
(make sure your webserver can resolve hostnames; otherwise use IP
addresses in the configuration files).

On OpenBSD, the default shared memory value is too low for the Zabbix
Server and Proxy to work properly. You should set kern.shminfo.shmall
according to your needs ("32768" is a good value for starter) -- see
sysctl(8) and sysctl.conf(5).

On a busy server, it may be advisable to put the zabbix processes into
their own login(1) class with tuned resources, such as more open file
descriptors etc.
e.g. add the following lines to login.conf(5):

zabbix_server:\
	:openfiles-cur=1024:\
	:openfiles-max=2048:\
	:tc=daemon

Next you must create the database following the relevant set of
instructions below. When this is done you can proceed to configure
through the web interface at http://<hostname>/zabbix/setup.php.
(default user is 'Admin' with password 'zabbix')

MariaDB (InnoDB)
================

Connect to MariaDB, and create a user and database for Zabbix;

    $ mysql -u root -p
    MariaDB [(none)]> create user zabbix@@localhost identified by 'password';
    MariaDB [(none)]> create database zabbix character set utf8;
    MariaDB [(none)]> grant all privileges on zabbix.* to zabbix@@localhost;
    MariaDB [(none)]> quit

Then initialize the database from the files installed in
${TRUEPREFIX}/share/examples/zabbix:

    $ cd ${TRUEPREFIX}/share/zabbix/schema/mysql
    $ mysql -uzabbix -p[password] zabbix < schema.sql
The following steps are not required for setting up a Zabbix Proxy.
    $ mysql -uzabbix -p[password] zabbix < images.sql
    $ mysql -uzabbix -p[password] zabbix < data.sql

PostgreSQL
==========

Assuming you have an administrative account named `postgres',
you can create the 'zabbix' user and database like this:

    createuser -U postgres --pwprompt --no-superuser \
      --createdb --no-createrole zabbix
    createdb -U zabbix zabbix

And initialize the database:

    $ cd ${TRUEPREFIX}/share/zabbix/schema/postgresql
    $ cat schema.sql | psql -U zabbix zabbix
The following steps are not required for setting up a Zabbix Proxy.
    $ cat images.sql | psql -U zabbix zabbix
    $ cat data.sql | psql -U zabbix zabbix

SQLite3
=======

The following steps are optional on a Zabbix Proxy, the database will be
automatically created and initialized if it does not exist. Note that
for obvious performance reasons, it is NOT encouraged to use the SQLite
backend for a server.

    # cd /usr/local/share/zabbix/schema/sqlite3
    # su -m _zabbix -c "sqlite3 /var/db/zabbix/zabbix.db < schema.sql"
The following steps are not required for setting up a Zabbix Proxy.
    # su -m _zabbix -c "sqlite3 /var/db/zabbix/zabbix.db < images.sql"
    # su -m _zabbix -c "sqlite3 /var/db/zabbix/zabbix.db < data.sql"
@


1.10
log
@MySQL -> MariaDB in READMEs.
@
text
@d1 1
a1 1
$OpenBSD: README-server,v 1.9 2013/06/06 13:57:48 ajacoutot Exp $
d101 2
a102 2
    $ cd ${TRUEPREFIX}/share/zabbix/schema/sqlite3
    $ sudo -u _zabbix sqlite3 /var/db/zabbix/zabbix.db < schema.sql
d104 2
a105 2
    $ sudo -u _zabbix sqlite3 /var/db/zabbix/zabbix.db < images.sql
    $ sudo -u _zabbix sqlite3 /var/db/zabbix/zabbix.db < data.sql
@


1.9
log
@Revert the mysql->MariaDB blurb in the READMEs.
It seems the MariaDB move will be reverted.
@
text
@d1 1
a1 1
$OpenBSD: README-server,v 1.8 2013/06/05 14:38:08 ajacoutot Exp $
d55 2
a56 2
MySQL (InnoDB)
==============
d58 1
a58 1
Connect to MySQL, and create a user and database for Zabbix;
d61 4
a64 4
    mysql> create user zabbix@@localhost identified by 'password';
    mysql> create database zabbix character set utf8;
    mysql> grant all privileges on zabbix.* to zabbix@@localhost;
    mysql> quit
@


1.8
log
@mysql -> MariaDB
@
text
@d1 1
a1 1
$OpenBSD: README-server,v 1.7 2013/03/17 07:21:17 ajacoutot Exp $
d61 4
a64 4
    MariaDB [(none)]> create user zabbix@@localhost identified by 'password';
    MariaDB [(none)]> create database zabbix character set utf8;
    MariaDB [(none)]> grant all privileges on zabbix.* to zabbix@@localhost;
    MariaDB [(none)]> quit
@


1.7
log
@Remove duplicate information that is to be moved to the mysql README.

ok brad@@ sthen@@ jasper@@
@
text
@d1 1
a1 1
$OpenBSD: README-server,v 1.6 2012/10/10 22:04:57 robert Exp $
d61 4
a64 4
    mysql> create user zabbix@@localhost identified by 'password';
    mysql> create database zabbix character set utf8;
    mysql> grant all privileges on zabbix.* to zabbix@@localhost;
    mysql> quit
@


1.6
log
@update to zabbix version 2.0.2
@
text
@d1 1
a1 1
$OpenBSD: README-server,v 1.5 2011/08/21 09:21:02 ajacoutot Exp $
a56 17

MySQL users running with chroot'ed httpd might like to take the
following steps to place the mysql socket inside the chroot:

Create a directory for the mysql socket.

    mkdir -p /var/www/var/run/mysql

Adjust ${SYSCONFDIR}/my.cnf to put the mysql socket into the chroot,

    [client]
    socket = /var/www/var/run/mysql/mysql.sock

    [mysqld]
    socket = /var/www/var/run/mysql/mysql.sock

and set DBSocket in the Zabbix configuration appropriately.
@


1.5
log
@Update to Zabbix 1.8.6.
For details, see:
http://www.zabbix.com/documentation/1.8/manual/about/what_s_new_1.8.6
@
text
@d1 1
a1 1
$OpenBSD: README-server,v 1.4 2011/06/02 13:41:40 ajacoutot Exp $
d86 2
a87 2
    $ cd ${TRUEPREFIX}/share/zabbix/schema
    $ mysql -uzabbix -p[password] zabbix < mysql.sql
d89 1
a89 1
    $ cd ../data
a90 1
    $ mysql -uzabbix -p[password] zabbix < images_mysql.sql
d104 2
a105 2
    $ cd ${TRUEPREFIX}/share/zabbix/schema
    $ cat postgresql.sql | psql -U zabbix zabbix
d107 1
a107 1
    $ cd ../data
a108 1
    $ cat images_pgsql.sql | psql -U zabbix zabbix
d118 2
a119 2
    $ cd ${TRUEPREFIX}/share/zabbix/schema
    $ cat sqlite.sql | sudo -u _zabbix sqlite3 /var/db/zabbix/zabbix.db
d121 2
a122 3
    $ cd ../data
    $ cat data.sql | sudo -u _zabbix sqlite3 /var/db/zabbix/zabbix.db
    $ cat images_sqlite3.sql | sudo -u _zabbix sqlite3 /var/db/zabbix/zabbix.db
@


1.4
log
@Add a consistent header that substitutes FULLPKGNAME for the READMEs.

ok jasper@@ sthen@@
@
text
@d1 1
a1 1
$OpenBSD: README-server,v 1.3 2011/01/04 16:03:00 ajacoutot Exp $
d6 5
@


1.3
log
@Cope with recent class handling in rc.subr.
@
text
@d1 1
a1 1
$OpenBSD: README-server,v 1.2 2010/12/06 19:06:59 ajacoutot Exp $
d3 3
a5 2
Using Zabbix on OpenBSD
=======================
d51 1
a51 1
--------------
d89 1
a89 1
----------
d108 1
a108 1
-------
@


1.2
log
@Extend the README and create mysql db with character set utf8.
@
text
@d1 1
a1 1
$OpenBSD: README-server,v 1.1 2010/11/22 15:39:21 ajacoutot Exp $
d34 3
a36 3
On a busy server, it may be advisable to put the _zabbix user and
processes into their own login(1) class with tuned resources, such as
more open file descriptors etc.
d39 1
a39 1
zabbix:\
@


1.1
log
@Rewrite / fix several portions of the READMEs.
Move README-main to README-server.
Create a default /var/db/zabbix/ directory for sqlite3 usage.
Add rc scripts for zabbix_agentd, zabbix_proxy and zabbix_server.
@
text
@d1 1
a1 1
$OpenBSD: README-main,v 1.1 2010/11/06 09:01:07 ajacoutot Exp $
d49 2
a50 2
MySQL
-----
d73 2
a74 2
    mysql> create database zabbix;
    mysql> grant all on zabbix.* to zabbix@@localhost;
d84 1
a84 1
    $ mysql -uzabbix -p[password] zabbix < data.sql	     ## N.B. slow!!
d110 3
a112 1
automatically created and initialized if it does not exist.
@

