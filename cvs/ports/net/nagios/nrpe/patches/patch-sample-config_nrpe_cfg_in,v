head	1.2;
access;
symbols
	OPENBSD_6_0:1.2.0.14
	OPENBSD_6_0_BASE:1.2
	OPENBSD_5_9:1.2.0.10
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.2.0.12
	OPENBSD_5_8_BASE:1.2
	OPENBSD_5_7:1.2.0.8
	OPENBSD_5_7_BASE:1.2
	OPENBSD_5_6:1.2.0.6
	OPENBSD_5_6_BASE:1.2
	OPENBSD_5_5:1.2.0.4
	OPENBSD_5_5_BASE:1.2
	OPENBSD_5_4:1.2.0.2
	OPENBSD_5_4_BASE:1.2
	OPENBSD_5_3:1.1.0.2
	OPENBSD_5_3_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2013.04.17.15.15.16;	author sthen;	state Exp;
branches;
next	1.1;

1.1
date	2012.09.05.19.57.42;	author sthen;	state Exp;
branches;
next	;


desc
@@


1.2
log
@switch back to the nagios version of NRPE and update to 2.14, including
fix for metacharacter filtering (CVE-2013-1362) which was letting $(...)
through, reported by a couple of people.

this loses the v6 support but the fork which added this is currently dead.
@
text
@$OpenBSD: patch-sample-config_nrpe_cfg_in,v 1.1 2012/09/05 19:57:42 sthen Exp $

- provide a standard check_disk that checks all volumes, apart from hda1
not existing, it's stupid to check individual FS when they're split up
as usual with OpenBSD.

--- sample-config/nrpe.cfg.in.orig	Mon Dec 17 13:44:46 2012
+++ sample-config/nrpe.cfg.in	Wed Apr 17 15:35:57 2013
@@@@ -23,7 +23,7 @@@@ log_facility=@@log_facility@@
 # number.  The file is only written if the NRPE daemon is started by the root
 # user and is running in standalone mode.
 
-pid_file=/var/run/nrpe.pid
+pid_file=/var/run/nrpe/nrpe.pid
 
 
 
@@@@ -218,7 +218,7 @@@@ connection_timeout=300
 
 command[check_users]=@@libexecdir@@/check_users -w 5 -c 10
 command[check_load]=@@libexecdir@@/check_load -w 15,10,5 -c 30,25,20
-command[check_hda1]=@@libexecdir@@/check_disk -w 20% -c 10% -p /dev/hda1
+command[check_disk]=@@libexecdir@@/check_disk -w 20% -c 10%
 command[check_zombie_procs]=@@libexecdir@@/check_procs -w 5 -c 10 -s Z
 command[check_total_procs]=@@libexecdir@@/check_procs -w 150 -c 200 
 
@


1.1
log
@cvs add. I could've sworn this was already there...
@
text
@d1 1
a1 4
$OpenBSD$

- better default loads to warn at (these machines are meant to be doing
actual work, right?!)
d7 2
a8 2
--- sample-config/nrpe.cfg.in.orig	Tue Sep 14 16:51:48 2010
+++ sample-config/nrpe.cfg.in	Wed Sep  5 20:49:28 2012
d18 1
a18 2
@@@@ -197,8 +197,8 @@@@ connection_timeout=300
 # The following examples use hardcoded command arguments...
d21 1
a21 1
-command[check_load]=@@libexecdir@@/check_load -w 1.5,1.1,0.9 -c 3.0,2.2,1.9
d23 1
a23 2
+command[check_load]=@@libexecdir@@/check_load -w 12,8,5 -c 16,12,10
+command[check_disk]=@@libexecdir@@/check_disk -w 18% -c 10%
@

