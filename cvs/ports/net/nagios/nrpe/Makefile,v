head	1.30;
access;
symbols
	OPENBSD_6_2:1.30.0.2
	OPENBSD_6_2_BASE:1.30
	OPENBSD_6_1:1.29.0.8
	OPENBSD_6_1_BASE:1.29
	OPENBSD_6_0:1.29.0.6
	OPENBSD_6_0_BASE:1.29
	OPENBSD_5_9:1.29.0.2
	OPENBSD_5_9_BASE:1.29
	OPENBSD_5_8:1.29.0.4
	OPENBSD_5_8_BASE:1.29
	OPENBSD_5_7:1.28.0.4
	OPENBSD_5_7_BASE:1.28
	OPENBSD_5_6:1.28.0.2
	OPENBSD_5_6_BASE:1.28
	OPENBSD_5_5:1.22.0.2
	OPENBSD_5_5_BASE:1.22
	OPENBSD_5_4:1.21.0.2
	OPENBSD_5_4_BASE:1.21
	OPENBSD_5_3:1.18.0.2
	OPENBSD_5_3_BASE:1.18
	OPENBSD_5_2:1.16.0.4
	OPENBSD_5_2_BASE:1.16
	OPENBSD_5_1_BASE:1.16
	OPENBSD_5_1:1.16.0.2
	OPENBSD_5_0:1.14.0.2
	OPENBSD_5_0_BASE:1.14
	OPENBSD_4_9:1.13.0.2
	OPENBSD_4_9_BASE:1.13
	OPENBSD_4_8:1.11.0.2
	OPENBSD_4_8_BASE:1.11
	OPENBSD_4_7:1.10.0.6
	OPENBSD_4_7_BASE:1.10
	OPENBSD_4_6:1.10.0.4
	OPENBSD_4_6_BASE:1.10
	OPENBSD_4_5:1.10.0.2
	OPENBSD_4_5_BASE:1.10
	OPENBSD_4_4:1.7.0.4
	OPENBSD_4_4_BASE:1.7
	OPENBSD_4_3:1.7.0.2
	OPENBSD_4_3_BASE:1.7
	OPENBSD_4_2:1.5.0.4
	OPENBSD_4_2_BASE:1.5
	OPENBSD_4_1:1.5.0.2
	OPENBSD_4_1_BASE:1.5
	OPENBSD_4_0:1.4.0.2
	OPENBSD_4_0_BASE:1.4
	OPENBSD_3_9:1.1.1.1.0.2
	OPENBSD_3_9_BASE:1.1.1.1
	david_20060202:1.1.1.1
	david:1.1.1;
locks; strict;
comment	@# @;


1.30
date	2017.08.22.10.25.47;	author sthen;	state Exp;
branches;
next	1.29;
commitid	VagYRAFDyUVedUVc;

1.29
date	2015.03.23.09.16.55;	author sthen;	state Exp;
branches;
next	1.28;
commitid	CEDcRIMEMRiSENpV;

1.28
date	2014.07.22.08.55.45;	author jca;	state Exp;
branches
	1.28.2.1
	1.28.4.1;
next	1.27;
commitid	ybCYR5wemkk7D2iS;

1.27
date	2014.07.11.20.08.23;	author sthen;	state Exp;
branches;
next	1.26;
commitid	gyiYcOzEDpFkolOW;

1.26
date	2014.04.21.10.28.31;	author sthen;	state Exp;
branches;
next	1.25;

1.25
date	2014.04.18.11.33.41;	author sthen;	state Exp;
branches;
next	1.24;

1.24
date	2014.04.07.12.32.23;	author sthen;	state Exp;
branches;
next	1.23;

1.23
date	2014.03.23.21.07.10;	author sthen;	state Exp;
branches;
next	1.22;

1.22
date	2013.09.17.21.22.26;	author sthen;	state Exp;
branches
	1.22.2.1;
next	1.21;

1.21
date	2013.06.17.19.28.36;	author ajacoutot;	state Exp;
branches
	1.21.2.1;
next	1.20;

1.20
date	2013.04.17.15.15.16;	author sthen;	state Exp;
branches;
next	1.19;

1.19
date	2013.03.11.11.35.49;	author espie;	state Exp;
branches;
next	1.18;

1.18
date	2012.09.05.19.57.42;	author sthen;	state Exp;
branches;
next	1.17;

1.17
date	2012.09.05.19.55.57;	author sthen;	state Exp;
branches;
next	1.16;

1.16
date	2011.12.17.22.01.13;	author sthen;	state Exp;
branches;
next	1.15;

1.15
date	2011.09.16.11.13.38;	author espie;	state Exp;
branches;
next	1.14;

1.14
date	2011.04.21.11.23.38;	author sthen;	state Exp;
branches;
next	1.13;

1.13
date	2011.01.20.14.04.42;	author sthen;	state Exp;
branches;
next	1.12;

1.12
date	2010.11.19.22.31.35;	author espie;	state Exp;
branches;
next	1.11;

1.11
date	2010.07.13.21.08.01;	author sthen;	state Exp;
branches;
next	1.10;

1.10
date	2009.01.10.16.56.42;	author sturm;	state Exp;
branches;
next	1.9;

1.9
date	2009.01.09.18.40.14;	author sturm;	state Exp;
branches;
next	1.8;

1.8
date	2008.11.13.08.33.16;	author sthen;	state Exp;
branches;
next	1.7;

1.7
date	2007.09.15.22.36.55;	author merdely;	state Exp;
branches;
next	1.6;

1.6
date	2007.09.06.19.09.10;	author sturm;	state Exp;
branches;
next	1.5;

1.5
date	2006.11.20.13.07.20;	author espie;	state Exp;
branches;
next	1.4;

1.4
date	2006.07.20.05.00.24;	author david;	state Exp;
branches;
next	1.3;

1.3
date	2006.05.21.19.16.34;	author aanriot;	state Exp;
branches;
next	1.2;

1.2
date	2006.04.12.21.06.10;	author david;	state Exp;
branches;
next	1.1;

1.1
date	2006.02.04.13.16.08;	author david;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2006.02.04.13.16.08;	author david;	state Exp;
branches;
next	;

1.21.2.1
date	2014.04.20.22.20.57;	author sthen;	state Exp;
branches;
next	;

1.22.2.1
date	2014.04.20.22.17.23;	author sthen;	state Exp;
branches;
next	;

1.28.2.1
date	2015.03.23.09.18.42;	author sthen;	state Exp;
branches;
next	;
commitid	lgP5dsgV9cYY2dSE;

1.28.4.1
date	2015.03.23.09.18.02;	author sthen;	state Exp;
branches;
next	;
commitid	3faXHmZGkPyRAH9L;


desc
@@


1.30
log
@drop maintainer
@
text
@# $OpenBSD: Makefile,v 1.29 2015/03/23 09:16:55 sthen Exp $

COMMENT=	Nagios Remote Plugin Executor

DISTNAME=	nrpe-2.15
REVISION=	7
CATEGORIES=	net

HOMEPAGE=	http://www.nagios.org/

# GPL
PERMIT_PACKAGE_CDROM=	Yes

WANTLIB=	c

FLAVOR?=
FLAVORS=	no_ssl

MASTER_SITES=	${MASTER_SITE_SOURCEFORGE:=nagios/}

RUN_DEPENDS=	net/monitoring-plugins

CONFIGURE_STYLE= gnu
CONFIGURE_ARGS+= --libexecdir=${LOCALBASE}/libexec/nagios \
		--with-nrpe-user=_nrpe \
		--with-nrpe-group=_nrpe

.if ${FLAVOR:Mno_ssl}
CONFIGURE_ARGS+= --disable-ssl
.else
WANTLIB+=	lib/eopenssl/crypto lib/eopenssl/ssl
LIB_DEPENDS=	security/openssl
CONFIGURE_ENV=	CFLAGS="${CFLAGS} -nostdinc -I${LOCALBASE}/include/eopenssl -I/usr/include" \
		LDFLAGS="-L${LOCALBASE}/lib/eopenssl -Wl,-rpath,${LOCALBASE}/lib/eopenssl"
.endif

pre-configure:
	@@${SUBST_CMD} ${WRKSRC}/src/nrpe.c

do-install:
	${INSTALL_DATA_DIR} ${PREFIX}/libexec/nagios
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/nrpe
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/nrpe
	${INSTALL_DATA} ${WRKSRC}/README ${PREFIX}/share/doc/nrpe
	${INSTALL_DATA} ${WRKSRC}/SECURITY ${PREFIX}/share/doc/nrpe
	${INSTALL_DATA} ${WRKSRC}/sample-config/nrpe.cfg ${PREFIX}/share/examples/nrpe
	${INSTALL_PROGRAM} ${WRKSRC}/src/check_nrpe ${PREFIX}/libexec/nagios
	${INSTALL_PROGRAM} ${WRKSRC}/src/nrpe ${PREFIX}/sbin

NO_TEST=	Yes

.include <bsd.port.mk>
@


1.29
log
@Switch NRPE to openssl; libressl no longer supports 512 bit DH keys.
Add a no_ssl flavour to allow a non-SSL build (SSL doesn't really add
much in the case of NRPE as no authentication is done anyway).

guenther@@ provided a diff to stay with libressl and use auto dh support
instead, but backwards compatibility is a problem there.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2014/07/22 08:55:45 jca Exp $
d6 1
a6 1
REVISION=	6
a7 2

MAINTAINER=	Stuart Henderson <sthen@@openbsd.org>
@


1.28
log
@Prevent the nrpe children from cleaning up the pidfile on
accept(2)/getpeername(2) errors, from Ubuntu.  ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2014/07/11 20:08:23 sthen Exp $
d6 1
a6 1
REVISION=	5
d16 4
a19 1
WANTLIB=		c crypto ssl
d29 9
@


1.28.2.1
log
@MFC: Switch NRPE to openssl; libressl no longer supports 512 bit DH keys.
Add a no_ssl flavour to allow a non-SSL build (SSL doesn't really add
much in the case of NRPE as no authentication is done anyway).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2015/03/23 09:16:55 sthen Exp $
d6 1
a6 1
REVISION=	6
d16 1
a16 4
WANTLIB=	c

FLAVOR?=
FLAVORS=	no_ssl
a25 9

.if ${FLAVOR:Mno_ssl}
CONFIGURE_ARGS+= --disable-ssl
.else
WANTLIB+=	lib/eopenssl/crypto lib/eopenssl/ssl
LIB_DEPENDS=	security/openssl
CONFIGURE_ENV=	CFLAGS="${CFLAGS} -nostdinc -I${LOCALBASE}/include/eopenssl -I/usr/include" \
		LDFLAGS="-L${LOCALBASE}/lib/eopenssl -Wl,-rpath,${LOCALBASE}/lib/eopenssl"
.endif
@


1.28.4.1
log
@MFC: Switch NRPE to openssl; libressl no longer supports 512 bit DH keys.
Add a no_ssl flavour to allow a non-SSL build (SSL doesn't really add
much in the case of NRPE as no authentication is done anyway).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2015/03/23 09:16:55 sthen Exp $
d6 1
a6 1
REVISION=	6
d16 1
a16 4
WANTLIB=	c

FLAVOR?=
FLAVORS=	no_ssl
a25 9

.if ${FLAVOR:Mno_ssl}
CONFIGURE_ARGS+= --disable-ssl
.else
WANTLIB+=	lib/eopenssl/crypto lib/eopenssl/ssl
LIB_DEPENDS=	security/openssl
CONFIGURE_ENV=	CFLAGS="${CFLAGS} -nostdinc -I${LOCALBASE}/include/eopenssl -I/usr/include" \
		LDFLAGS="-L${LOCALBASE}/lib/eopenssl -Wl,-rpath,${LOCALBASE}/lib/eopenssl"
.endif
@


1.27
log
@handle monitoring-plugins shuffling
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2014/04/21 10:28:31 sthen Exp $
d6 1
a6 1
REVISION=	4
@


1.26
log
@Remove the config option that allows the setting command arguments over
the network. If somebody can't change their config to do what they need
without allowing them to be specified, they can rebuild it themselves
and take responsibility for their own actions.

One specific case this is often used is to check disk space. Note that
you don't need to set a specific partition for check_disk, running it without
a -p flag will check all the filesystems.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2014/04/18 11:33:41 sthen Exp $
d6 1
a6 1
REVISION=	3
d20 1
a20 1
RUN_DEPENDS=	net/nagios/plugins
@


1.25
log
@Filter more unsafe chars for popen() (only affects installations where
"dont_blame_nrpe" has been set, which you should not do).

From http://seclists.org/fulldisclosure/2014/Apr/240 / oss-sec
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2014/04/07 12:32:23 sthen Exp $
d6 1
a6 1
REVISION=	2
d23 1
a23 2
CONFIGURE_ARGS+= --enable-command-args \
		--libexecdir=${LOCALBASE}/libexec/nagios \
@


1.24
log
@bump; nagios-plugins -> monitoring-plugins
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2014/03/23 21:07:10 sthen Exp $
d6 1
a6 1
REVISION=	1
@


1.23
log
@disable tcp wrappers
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2013/09/17 21:22:26 sthen Exp $
d6 1
a6 1
REVISION=	0
@


1.22
log
@update to nrpe 2.15, adding IPv6 support (and yes, it still listens on v4. ;)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2013/06/17 19:28:36 ajacoutot Exp $
d6 1
d10 1
d16 1
a16 1
WANTLIB=		c crypto ssl wrap
d26 1
a26 2
		--with-nrpe-group=_nrpe \
		ac_cv_lib_wrap_main=yes
@


1.22.2.1
log
@Pull the nagios nrpe security fix across to -stable
http://seclists.org/fulldisclosure/2014/Apr/240

Note, this one is being actively scanned for/attacked. You should absolutely
not have this open to the world but it seems some people do...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2013/09/17 21:22:26 sthen Exp $
a5 1
REVISION=	0
@


1.21
log
@Some trivial WANTLIB and tweaks to unbreak after the Heimdal update.
Stop hardcoding the Kerberos libs and use krb5-config(1).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2013/04/17 15:15:16 sthen Exp $
d5 1
a5 1
DISTNAME=	nrpe-2.14
@


1.21.2.1
log
@Pull the nagios nrpe security fix across to 5.4-stable
http://seclists.org/fulldisclosure/2014/Apr/240

Note, this one is being actively scanned for/attacked. You should absolutely
not have this open to the world but it seems some people do...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2013/06/17 19:28:36 ajacoutot Exp $
a5 1
REVISION=	0
@


1.20
log
@switch back to the nagios version of NRPE and update to 2.14, including
fix for metacharacter filtering (CVE-2013-1362) which was letting $(...)
through, reported by a couple of people.

this loses the v6 support but the fork which added this is currently dead.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2013/03/11 11:35:49 espie Exp $
a24 1
		--with-kerberos-inc=/usr/include/kerberosV/ \
@


1.19
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2012/09/05 19:57:42 sthen Exp $
d5 1
a5 5
# packaged from Icinga git repo.
DISTNAME=	icinga-nrpe-2.12.20100914
REVISION=	4
PKGNAME=	${DISTNAME:S/icinga-//}
WRKDIST=	${WRKDIR}/icinga-nrpe
d16 1
a16 1
MASTER_SITES=	http://spacehopper.org/mirrors/
d21 1
a21 1
CONFIGURE_ARGS+=--enable-command-args \
@


1.18
log
@cvs add. I could've sworn this was already there...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2012/09/05 19:55:57 sthen Exp $
a16 3
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
d45 1
a45 1
NO_REGRESS=	Yes
@


1.17
log
@use a subdir for the pid file to avoid log spam; pointed out by Julien Dhaille
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2011/12/17 22:01:13 sthen Exp $
d7 1
a7 1
REVISION=	3
@


1.16
log
@Where a program with an rc script _requires_ a certain command line
parameter to daemonize, move the parameter from daemon to daemon_flags,
so that the user cannot inadvertently prevent it from daemonizing by
adjusting the flags.

Discussed with ajacoutot and schwarze, this method was suggested
by schwarze@@ as a simpler alternative to my diff. ok aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2011/09/16 11:13:38 espie Exp $
d7 1
a7 1
REVISION=	1
@


1.15
log
@normalize pkgpath
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2011/04/21 11:23:38 sthen Exp $
d7 1
a7 1
REVISION=		0
@


1.14
log
@- switch to Icinga's fork of nrpe (it hasn't changed much; mostly auto*
changes and v6 support)

- remove unnecessary /dev/*random patch

- force libwrap detection via autoconf variables, it's less intrusive
than patching configure
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2011/01/20 14:04:42 sthen Exp $
d7 1
@


1.13
log
@add an rc script for nrpe; ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2010/11/19 22:31:35 espie Exp $
d5 4
a8 2
DISTNAME=	nrpe-2.12
REVISION=	2
d19 1
d22 1
a22 1
MASTER_SITES=	${MASTER_SITE_SOURCEFORGE:=nagios/}
d27 6
a32 5
CONFIGURE_ARGS+=--enable-command-args
CONFIGURE_ARGS+=--libexecdir=${LOCALBASE}/libexec/nagios
CONFIGURE_ARGS+=--with-nrpe-user=_nrpe
CONFIGURE_ARGS+=--with-nrpe-group=_nrpe
CONFIGURE_ARGS+=--with-kerberos-inc=/usr/include/kerberosV/
@


1.12
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2010/07/13 21:08:01 sthen Exp $
d6 1
a6 1
REVISION=	1
@


1.11
log
@use REVISION.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2009/01/10 16:56:42 sturm Exp $
d21 1
a21 1
RUN_DEPENDS=	::net/nagios/plugins
@


1.10
log
@follow henning on nagios:
need to set pfd.events, not revents... d'oh. Tamas TEVESZ <ice@@extreme.hu>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2009/01/09 18:40:14 sturm Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p1
@


1.9
log
@adapt henning's nagios diff, to fix reading of nonblocking sockets

ok sthen
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2008/11/13 08:33:16 sthen Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p0
@


1.8
log
@update to 2.12 and take MAINTAINER.
ok david@@ (previous maintainer).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2007/09/15 22:36:55 merdely Exp $
d6 1
@


1.7
log
@Remove surrounding quotes in COMMENT*/PERMIT_*/BROKEN/ERRORS

Add $OpenBSD$ to p5-SNMP-Info/Makefile (ok kili@@, simon@@)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2007/09/06 19:09:10 sturm Exp $
d5 1
a5 1
DISTNAME=	nrpe-2.7.1
d8 1
a8 1
MAINTAINER=	David Krause <david@@openbsd.org>
d30 1
a30 1
	@@perl -pi -e "s,%%SYSCONFDIR%%,${SYSCONFDIR}," ${WRKSRC}/src/nrpe.c
@


1.6
log
@update to nrpe 2.7.1

ok david@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2006/11/20 13:07:20 espie Exp $
d3 1
a3 1
COMMENT=	"Nagios Remote Plugin Executor"
@


1.5
log
@fix a few obviously wrong dependencies, and remove extra shells in ghc.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2006/07/20 05:00:24 david Exp $
d5 1
a5 1
DISTNAME=	nrpe-2.5.2
@


1.4
log
@update to nrpe-2.5.2; ok aanriot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2006/05/21 19:16:34 aanriot Exp $
d20 1
a20 1
RUN_DEPENDS=	nagios-plugins::net/nagios/plugins
@


1.3
log
@maintenance update to 2.5.1 .

ok david@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2006/04/12 21:06:10 david Exp $
d5 1
a5 1
DISTNAME=	nrpe-2.5.1
@


1.2
log
@update to nrpe-2.5
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2006/02/04 13:16:08 david Exp $
d5 1
a5 1
DISTNAME=	nrpe-2.5
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d5 1
a5 1
DISTNAME=	nrpe-2.3
@


1.1.1.1
log
@initial import of nrpe-2.3 (Nagios Remote Plugin Executor)

NRPE is an addon for Nagios that allows you to execute "local" plugins
(like check_disk, check_procs, etc.) on remote hosts. The check_nrpe
plugin is called from Nagios and makes plugin execution requests to the
NRPE daemon running on the remote host (either as a standalone daemon
or as a service under inetd). Supports passing command arguments to
server, as well as native SSL/TLS encryption (anonymous DH mode).

help/ok sturm@@ bernd@@
@
text
@@
