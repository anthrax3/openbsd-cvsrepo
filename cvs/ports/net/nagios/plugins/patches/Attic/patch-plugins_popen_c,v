head	1.2;
access;
symbols;
locks; strict;
comment	@# @;


1.2
date	2006.04.19.20.35.28;	author sturm;	state dead;
branches;
next	1.1;

1.1
date	2006.04.16.17.26.42;	author sturm;	state Exp;
branches;
next	;


desc
@@


1.2
log
@update to nagios-plugins 1.4.3
a few bugfixes and USE_LIBTOOL
@
text
@$OpenBSD: patch-plugins_popen_c,v 1.1 2006/04/16 17:26:42 sturm Exp $
--- plugins/popen.c.orig	Wed Apr 12 20:42:46 2006
+++ plugins/popen.c	Wed Apr 12 20:42:48 2006
@@@@ -268,9 +268,10 @@@@ popen_sigchld_handler (int signo)
 RETSIGTYPE
 popen_timeout_alarm_handler (int signo)
 {
-	int fh;
+	int fh = -1;
 	if (signo == SIGALRM) {
-		fh=fileno (child_process);
+		if (child_process)
+			fh=fileno (child_process);
 		if(fh >= 0){
 			kill (childpid[fh], SIGKILL);
 		}
@


1.1
log
@besides this alarm handler being completely wrong, do not segfault in
case child_process is not yet initialized
@
text
@d1 1
a1 1
$OpenBSD$
@

