head	1.5;
access;
symbols
	OPENBSD_4_4:1.3.0.2
	OPENBSD_4_4_BASE:1.3;
locks; strict;
comment	@# @;


1.5
date	2008.11.09.10.18.56;	author sturm;	state dead;
branches;
next	1.4;

1.4
date	2008.10.26.15.03.11;	author sthen;	state Exp;
branches;
next	1.3;

1.3
date	2008.04.18.11.08.47;	author sturm;	state Exp;
branches;
next	1.2;

1.2
date	2008.03.19.17.15.53;	author sturm;	state Exp;
branches;
next	1.1;

1.1
date	2008.03.18.20.25.11;	author sturm;	state Exp;
branches;
next	;


desc
@@


1.5
log
@update to nagios 3.0.5
@
text
@$OpenBSD: patch-cgi_cgiutils_c,v 1.4 2008/10/26 15:03:11 sthen Exp $
--- cgi/cgiutils.c.orig	Wed Oct 15 22:40:07 2008
+++ cgi/cgiutils.c	Wed Oct 22 20:03:01 2008
@@@@ -1289,7 +1289,7 @@@@ char *mmap_fgets_multiline(mmapfile *temp_mmapfile){
 			}
 
 		/* one backslash found, so we should continue reading the next line */
-		else if(buf[end]=='\\')
+		else if(end>=0 && buf[end]=='\\')
 			buf[end]='\x0';
 
 		/* else no continuation marker was found, so break */
@


1.4
log
@bugfix update to 3.0.4
ok sturm (MAINTAINER).
@
text
@d1 1
a1 1
$OpenBSD: patch-cgi_cgiutils_c,v 1.3 2008/04/18 11:08:47 sturm Exp $
@


1.3
log
@update to nagios 3.0.1
fix build of shared object
ok ian, merdely
@
text
@d1 4
a4 4
$OpenBSD: patch-cgi_cgiutils_c,v 1.2 2008/03/19 17:15:53 sturm Exp $
--- cgi/cgiutils.c.orig	Mon Mar 31 21:09:34 2008
+++ cgi/cgiutils.c	Thu Apr 17 11:09:07 2008
@@@@ -1285,7 +1285,7 @@@@ char *mmap_fgets_multiline(mmapfile *temp_mmapfile){
@


1.2
log
@fix another occurence of negative array index access and in a better way
bump PKGNAMEs
@
text
@d1 4
a4 4
$OpenBSD: patch-cgi_cgiutils_c,v 1.1 2008/03/18 20:25:11 sturm Exp $
--- cgi/cgiutils.c.orig	Tue Feb 26 16:58:32 2008
+++ cgi/cgiutils.c	Wed Mar 19 18:05:15 2008
@@@@ -1354,7 +1354,7 @@@@ char *mmap_fgets_multiline(mmapfile *temp_mmapfile){
@


1.1
log
@update to nagios 3.0
@
text
@d1 5
a5 6
$OpenBSD$
--- cgi/cgiutils.c.orig	Sun Mar 16 15:17:27 2008
+++ cgi/cgiutils.c	Sun Mar 16 15:17:31 2008
@@@@ -1346,6 +1346,10 @@@@ char *mmap_fgets_multiline(mmapfile *temp_mmapfile){
 		else
 			end=len-1;
d7 6
a12 7
+		/* array indices may not be negative */
+		if(end<0)
+			end=0;
+
 		/* two backslashes found, so unescape first backslash first and break */
 		if(end>=1 && buf[end-1]=='\\' && buf[end]=='\\'){
 			buf[end]='\n';
@

