head	1.3;
access;
symbols
	OPENBSD_6_1:1.3.0.10
	OPENBSD_6_1_BASE:1.3
	OPENBSD_6_0:1.3.0.8
	OPENBSD_6_0_BASE:1.3
	OPENBSD_5_9:1.3.0.4
	OPENBSD_5_9_BASE:1.3
	OPENBSD_5_8:1.3.0.6
	OPENBSD_5_8_BASE:1.3
	OPENBSD_5_7:1.3.0.2
	OPENBSD_5_7_BASE:1.3
	OPENBSD_5_6:1.2.0.8
	OPENBSD_5_6_BASE:1.2
	OPENBSD_5_5:1.2.0.6
	OPENBSD_5_5_BASE:1.2
	OPENBSD_5_4:1.2.0.4
	OPENBSD_5_4_BASE:1.2
	OPENBSD_5_3:1.2.0.2
	OPENBSD_5_3_BASE:1.2
	OPENBSD_5_2:1.1.0.16
	OPENBSD_5_2_BASE:1.1
	OPENBSD_5_1_BASE:1.1
	OPENBSD_5_1:1.1.0.14
	OPENBSD_5_0:1.1.0.12
	OPENBSD_5_0_BASE:1.1
	OPENBSD_4_9:1.1.0.10
	OPENBSD_4_9_BASE:1.1
	OPENBSD_4_8:1.1.0.8
	OPENBSD_4_8_BASE:1.1
	OPENBSD_4_7:1.1.0.6
	OPENBSD_4_7_BASE:1.1
	OPENBSD_4_6:1.1.0.4
	OPENBSD_4_6_BASE:1.1
	OPENBSD_4_5:1.1.0.2
	OPENBSD_4_5_BASE:1.1;
locks; strict;
comment	@# @;


1.3
date	2015.01.19.09.14.32;	author dcoppa;	state Exp;
branches;
next	1.2;
commitid	cZ4Axwmpwxw8FgmR;

1.2
date	2012.09.01.17.35.54;	author gonzalo;	state Exp;
branches;
next	1.1;

1.1
date	2008.11.18.21.22.02;	author pea;	state Exp;
branches;
next	;


desc
@@


1.3
log
@
Update to icecast-2.4.1

From (new) maintainer Eric Lalonde, tweaked by me
@
text
@$OpenBSD: patch-conf_icecast_minimal_xml_in,v 1.2 2012/09/01 17:35:54 gonzalo Exp $
--- conf/icecast_minimal.xml.in.orig	Mon Nov 10 00:17:57 2014
+++ conf/icecast_minimal.xml.in	Sun Jan  4 17:06:40 2015
@@@@ -23,9 +23,10 @@@@
     </listen-socket>
     <fileserve>1</fileserve>
     <paths>
-        <logdir>@@localstatedir@@/log/@@PACKAGE@@</logdir>
-        <webroot>@@pkgdatadir@@/web</webroot>
-        <adminroot>@@pkgdatadir@@/admin</adminroot>
+        <basedir>/var/icecast</basedir>
+        <logdir>/log</logdir>
+        <webroot>/web</webroot>
+        <adminroot>/admin</adminroot>
         <alias source="/" destination="/status.xsl"/>
     </paths>
     <logging>
@@@@ -33,6 +34,13 @@@@
         <errorlog>error.log</errorlog>
         <loglevel>3</loglevel> <!-- 4 Debug, 3 Info, 2 Warn, 1 Error -->
     </logging>
+    <security>
+        <chroot>1</chroot>  
+        <changeowner>
+            <user>_icecast</user>
+            <group>_icecast</group>
+        </changeowner>
+    </security>
     <http-headers>
         <header name="Access-Control-Allow-Origin" value="*" />
     </http-headers>
@


1.2
log
@Update for Icecast to 2.3.3:

* Improved HTTPS cipher handling and added support for chained certificates.
* Allow the source password to be undefined. There was a corner case,
  where a default password would have taken effect. It would require the
  admin to remove the 'source-password' from the icecast config to take
  effect. Default configs ship with the password set, so this
  vulnerability doesn't trigger there.
* Prevent error log injection of control characters by substituting
  non-alphanumeric characters with a '.' (CVE-2011-4612). Injection
  attempts can be identified via access.log, as that stores URL encoded
  requests. Investigation if further logging code needs to have
  sanitized output is ongoing.

Tested on amd64.

Reads fine aja@@
@
text
@d1 4
a4 4
$OpenBSD: patch-conf_icecast_minimal_xml_in,v 1.1 2008/11/18 21:22:02 pea Exp $
--- conf/icecast_minimal.xml.in.orig	Mon Jun 11 13:45:19 2012
+++ conf/icecast_minimal.xml.in	Fri Aug 31 11:26:58 2012
@@@@ -22,9 +22,10 @@@@
d18 1
a18 1
@@@@ -32,4 +33,11 @@@@
d20 1
a20 1
       	<loglevel>3</loglevel> <!-- 4 Debug, 3 Info, 2 Warn, 1 Error -->
d29 3
a31 1
 </icecast>
@


1.1
log
@Update to 2.3.2 and add the following modifications:

+ add user _icecast (home directory in /var/icecast)
+ enable chroot by default
+ populate chroot with all the necessary files

ok okan@@ sthen@@ ajacoutot@@
@
text
@d1 3
a3 3
$OpenBSD$
--- conf/icecast_minimal.xml.in.orig	Mon Jul  4 00:11:52 2005
+++ conf/icecast_minimal.xml.in	Fri Nov  7 13:38:36 2008
d11 1
a11 1
+	<basedir>/var/icecast</basedir>
d15 1
a15 1
         <alias source="/" dest="/status.xsl"/>
@

