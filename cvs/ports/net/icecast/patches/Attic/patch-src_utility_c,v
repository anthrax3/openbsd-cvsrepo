head	1.3;
access;
symbols
	OPENBSD_3_4:1.2.0.2
	OPENBSD_3_4_BASE:1.2
	OPENBSD_3_3:1.1.0.12
	OPENBSD_3_3_BASE:1.1
	OPENBSD_3_2:1.1.0.10
	OPENBSD_3_2_BASE:1.1
	OPENBSD_3_1:1.1.0.8
	OPENBSD_3_1_BASE:1.1
	OPENBSD_3_0:1.1.0.6
	OPENBSD_3_0_BASE:1.1
	OPENBSD_2_9_TRACKING_SWITCH:1.1
	OPENBSD_2_9:1.1.0.4
	OPENBSD_2_9_BASE:1.1
	OPENBSD_2_8:1.1.0.2;
locks; strict;
comment	@# @;


1.3
date	2004.02.02.19.32.37;	author fgsch;	state dead;
branches;
next	1.2;

1.2
date	2003.04.15.18.49.56;	author avsm;	state Exp;
branches;
next	1.1;

1.1
date	2001.03.06.06.52.42;	author fgsch;	state Exp;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2001.03.22.15.24.31;	author naddy;	state Exp;
branches;
next	;


desc
@@


1.3
log
@update to icecast 2.0 now that is considered stable.
done by and new maintainer Moritz Grimm <gtgbr at gmx dot net>.
@
text
@$OpenBSD: patch-src_utility_c,v 1.2 2003/04/15 18:49:56 avsm Exp $
--- src/utility.c.orig	Wed Apr 10 23:37:34 2002
+++ src/utility.c	Tue Apr 15 19:34:51 2003
@@@@ -102,7 +102,6 @@@@ int password_match(const char *crypted, 
 
 	return 0;
 #else
-	char salt[3];
 	char *test_crypted;
 	extern char *crypt(const char *, const char *);
 
@@@@ -111,18 +110,8 @@@@ int password_match(const char *crypted, 
 		return 0;
 	}
 
-	if (ice_strncmp(crypted, "$1$", 3)) {
-		salt[0] = crypted[0];
-		salt[1] = crypted[1];
-	} else {
-		salt[0] = crypted[3];
-		salt[1] = crypted[4];
-	}
-
-	salt[2] = '\0';
-
 	thread_mutex_lock(&info.misc_mutex);
-	test_crypted = crypt(uncrypted, salt);
+	test_crypted = crypt(uncrypted, crypted);
 	if (test_crypted == NULL) {
 		write_log(LOG_DEFAULT, "WARNING - crypt() failed, refusing access");
 		thread_mutex_unlock(&info.misc_mutex);
@@@@ -1509,7 +1498,7 @@@@ next_mount_point ()
 			count++;
 	}
 	
-	snprintf (apan, BUFSIZE, "icy_%d", count);
+	snprintf (apan, sizeof apan, "icy_%d", count);
 	
 	return &apan[0];
 }
@


1.2
log
@incorrect buffer bound in snprintf, not submitted as the current version
in ports is unsupported by the icecast folks
@
text
@d1 1
a1 1
$OpenBSD: patch-src_utility_c,v 1.1 2001/03/06 06:52:42 fgsch Exp $
@


1.1
log
@Remove icepass; use encrypt(1) instead.
Regen patches and bump version.
@
text
@d1 3
a3 3
$OpenBSD: update-patches,v 1.3 2000/06/09 17:08:37 espie Exp $
--- src/utility.c.orig	Wed Jul  5 16:52:40 2000
+++ src/utility.c	Tue Mar  6 03:23:41 2001
d32 9
@


1.1.2.1
log
@MFC:
Security update to 1.3.10; fixes several problems reported
to BugTraq recently, plus some other issues.
@
text
@d1 1
a1 1
$OpenBSD$
@

