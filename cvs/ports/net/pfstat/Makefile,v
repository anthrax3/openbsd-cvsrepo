head	1.37;
access;
symbols
	OPENBSD_6_1:1.37.0.2
	OPENBSD_6_1_BASE:1.37
	OPENBSD_6_0:1.36.0.6
	OPENBSD_6_0_BASE:1.36
	OPENBSD_5_9:1.36.0.2
	OPENBSD_5_9_BASE:1.36
	OPENBSD_5_8:1.36.0.4
	OPENBSD_5_8_BASE:1.36
	OPENBSD_5_7:1.34.0.2
	OPENBSD_5_7_BASE:1.34
	OPENBSD_5_6:1.32.0.2
	OPENBSD_5_6_BASE:1.32
	OPENBSD_5_5:1.30.0.2
	OPENBSD_5_5_BASE:1.30
	OPENBSD_5_4:1.29.0.2
	OPENBSD_5_4_BASE:1.29
	OPENBSD_5_3:1.27.0.8
	OPENBSD_5_3_BASE:1.27
	OPENBSD_5_2:1.27.0.6
	OPENBSD_5_2_BASE:1.27
	OPENBSD_5_1_BASE:1.27
	OPENBSD_5_1:1.27.0.4
	OPENBSD_5_0:1.27.0.2
	OPENBSD_5_0_BASE:1.27
	OPENBSD_4_9:1.25.0.2
	OPENBSD_4_9_BASE:1.25
	OPENBSD_4_8:1.21.0.2
	OPENBSD_4_8_BASE:1.21
	OPENBSD_4_7:1.19.0.4
	OPENBSD_4_7_BASE:1.19
	OPENBSD_4_6:1.19.0.2
	OPENBSD_4_6_BASE:1.19
	OPENBSD_4_5:1.16.0.6
	OPENBSD_4_5_BASE:1.16
	OPENBSD_4_4:1.16.0.4
	OPENBSD_4_4_BASE:1.16
	OPENBSD_4_3:1.16.0.2
	OPENBSD_4_3_BASE:1.16
	OPENBSD_4_2:1.14.0.4
	OPENBSD_4_2_BASE:1.14
	OPENBSD_4_1:1.14.0.2
	OPENBSD_4_1_BASE:1.14
	OPENBSD_4_0:1.13.0.2
	OPENBSD_4_0_BASE:1.13
	OPENBSD_3_9:1.11.0.2
	OPENBSD_3_9_BASE:1.11
	OPENBSD_3_8:1.9.0.4
	OPENBSD_3_8_BASE:1.9
	OPENBSD_3_7:1.9.0.2
	OPENBSD_3_7_BASE:1.9
	OPENBSD_3_6:1.8.0.4
	OPENBSD_3_6_BASE:1.8
	OPENBSD_3_5:1.8.0.2
	OPENBSD_3_5_BASE:1.8
	OPENBSD_3_4:1.7.0.2
	OPENBSD_3_4_BASE:1.7
	OPENBSD_3_3:1.4.0.2
	OPENBSD_3_3_BASE:1.4
	OPENBSD_3_2:1.2.0.2
	OPENBSD_3_2_BASE:1.2;
locks; strict;
comment	@# @;


1.37
date	2016.09.12.11.45.57;	author naddy;	state Exp;
branches;
next	1.36;
commitid	Cnalk1Ujct5ZDcli;

1.36
date	2015.06.10.10.43.29;	author sthen;	state Exp;
branches;
next	1.35;
commitid	ooMDYDVOJETzXFwR;

1.35
date	2015.04.03.10.11.24;	author jasper;	state Exp;
branches;
next	1.34;
commitid	V7INCh7n2AxOpnT2;

1.34
date	2015.01.13.11.26.10;	author sthen;	state Exp;
branches;
next	1.33;
commitid	aSPiASI7P4zDvMAs;

1.33
date	2015.01.04.19.08.27;	author jasper;	state Exp;
branches;
next	1.32;
commitid	RN7HZPr01z49M30u;

1.32
date	2014.04.22.10.56.37;	author jca;	state Exp;
branches;
next	1.31;

1.31
date	2014.03.17.23.22.02;	author sthen;	state Exp;
branches;
next	1.30;

1.30
date	2013.10.12.13.11.34;	author sthen;	state Exp;
branches;
next	1.29;

1.29
date	2013.03.11.19.50.04;	author sthen;	state Exp;
branches;
next	1.28;

1.28
date	2013.03.11.11.35.54;	author espie;	state Exp;
branches;
next	1.27;

1.27
date	2011.06.23.22.50.28;	author naddy;	state Exp;
branches;
next	1.26;

1.26
date	2011.06.07.22.15.38;	author sthen;	state Exp;
branches;
next	1.25;

1.25
date	2010.11.19.22.31.37;	author espie;	state Exp;
branches;
next	1.24;

1.24
date	2010.11.06.10.18.38;	author espie;	state Exp;
branches;
next	1.23;

1.23
date	2010.10.19.21.04.52;	author naddy;	state Exp;
branches;
next	1.22;

1.22
date	2010.10.18.18.36.56;	author espie;	state Exp;
branches;
next	1.21;

1.21
date	2010.07.12.22.07.40;	author sthen;	state Exp;
branches;
next	1.20;

1.20
date	2010.04.08.19.31.31;	author naddy;	state Exp;
branches;
next	1.19;

1.19
date	2009.04.09.22.08.47;	author sthen;	state Exp;
branches;
next	1.18;

1.18
date	2009.03.28.17.01.59;	author naddy;	state Exp;
branches;
next	1.17;

1.17
date	2009.03.09.17.03.32;	author sthen;	state Exp;
branches;
next	1.16;

1.16
date	2007.09.15.22.36.58;	author merdely;	state Exp;
branches;
next	1.15;

1.15
date	2007.08.27.08.06.55;	author dhartmei;	state Exp;
branches;
next	1.14;

1.14
date	2006.11.24.21.46.18;	author steven;	state Exp;
branches;
next	1.13;

1.13
date	2006.08.03.23.15.58;	author espie;	state Exp;
branches;
next	1.12;

1.12
date	2006.05.24.15.15.41;	author dhartmei;	state Exp;
branches;
next	1.11;

1.11
date	2005.10.24.05.09.59;	author fgsch;	state Exp;
branches;
next	1.10;

1.10
date	2005.10.12.05.39.32;	author fgsch;	state Exp;
branches;
next	1.9;

1.9
date	2004.12.16.00.31.24;	author alek;	state Exp;
branches;
next	1.8;

1.8
date	2003.10.06.09.27.59;	author dhartmei;	state Exp;
branches;
next	1.7;

1.7
date	2003.06.27.08.03.55;	author dhartmei;	state Exp;
branches;
next	1.6;

1.6
date	2003.06.07.23.52.40;	author dhartmei;	state Exp;
branches;
next	1.5;

1.5
date	2003.04.15.01.38.34;	author dhartmei;	state Exp;
branches;
next	1.4;

1.4
date	2003.01.24.20.15.41;	author dhartmei;	state Exp;
branches;
next	1.3;

1.3
date	2003.01.24.17.59.45;	author dhartmei;	state Exp;
branches;
next	1.2;

1.2
date	2002.08.12.11.37.03;	author dhartmei;	state Exp;
branches;
next	1.1;

1.1
date	2002.07.26.07.25.35;	author dhartmei;	state Exp;
branches;
next	;


desc
@@


1.37
log
@replace libiconv module
@
text
@# $OpenBSD: Makefile,v 1.36 2015/06/10 10:43:29 sthen Exp $

COMMENT-main=	packet filter statistics visualization
COMMENT-daemon=	pfstat daemon

DISTNAME=	pfstat-2.5

PKGNAME-main=	${DISTNAME}
PKGNAME-daemon=	${DISTNAME:S/-/d-/}
CATEGORIES=	net
MASTER_SITES=	http://www.benzedrine.ch/
REVISION-daemon=1
REVISION-main=	1

HOMEPAGE=	http://www.benzedrine.ch/pfstat.html

MAINTAINER=	Jasper Lievisse Adriaanse <jasper@@openbsd.org>

# BSD
PERMIT_PACKAGE_CDROM=	Yes

BUILD_DEPENDS=		graphics/gd

MULTI_PACKAGES=		-main -daemon

WANTLIB-main=		c iconv m z jpeg png pthread gd>=20
LIB_DEPENDS-main=	converters/libiconv graphics/gd
WANTLIB-daemon=		c
LIB_DEPENDS-daemon=
RUN_DEPENDS-daemon=

NO_TEST=		Yes

pre-configure:
	@@perl -pi -e "s,/etc,${SYSCONFDIR}," ${WRKSRC}/pfstat.c \
		${WRKSRC}/pfstat.8

do-install:
	${INSTALL_PROGRAM} ${WRKSRC}/pfstat ${PREFIX}/bin
	${INSTALL_MAN} ${WRKSRC}/pfstat.8 ${PREFIX}/man/man8
	${INSTALL_PROGRAM} ${WRKSRC}/pfstatd/pfstatd ${PREFIX}/bin
	${INSTALL_MAN} ${WRKSRC}/pfstatd/pfstatd.8 ${PREFIX}/man/man8
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/pfstat
	${INSTALL_DATA} ${WRKSRC}/pfstat.conf.example	\
			${PREFIX}/share/examples/pfstat/pfstat.conf

.include <bsd.port.mk>
@


1.36
log
@bump REVISIONs following DIOCGETSTATUS ABI change
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2015/04/03 10:11:24 jasper Exp $
a23 2
MODULES=		converters/libiconv

d26 2
a27 2
WANTLIB-main=		${MODLIBICONV_WANTLIB} c m z jpeg png pthread gd>=20
LIB_DEPENDS-main=	${MODLIBICONV_LIB_DEPENDS} graphics/gd
@


1.35
log
@create graphs with best jpeg quality, the image size increase is minimal,
and so is the quality actually, but it's better anyway.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2015/01/13 11:26:10 sthen Exp $
d12 1
a12 1
REVISION-daemon=0
@


1.34
log
@benzedrine.cx -> .ch, req by Daniel Hartmeier
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2015/01/04 19:08:27 jasper Exp $
d13 1
a13 1
REVISION-main=	0
@


1.33
log
@- update to pfstat-2.5
- set NO_TEST
- take maintainership

ok dhartmei
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2014/04/22 10:56:37 jca Exp $
d11 3
a13 1
MASTER_SITES=	http://www.benzedrine.cx/
d15 1
a15 1
HOMEPAGE=	http://www.benzedrine.cx/pfstat.html
@


1.32
log
@Fix build after ALTQ removal, and add a comment about the new queueing
system, as suggested by sthen@@.  ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2014/03/17 23:22:02 sthen Exp $
d6 1
a6 1
DISTNAME=	pfstat-2.3
a9 1
REVISION=	7
d15 1
a15 1
MAINTAINER=	Daniel Hartmeier <dhartmei@@openbsd.org>
d31 2
@


1.31
log
@sync follow graphics/gd update
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2013/10/12 13:11:34 sthen Exp $
d10 1
a10 1
REVISION=	6
@


1.30
log
@initial fix for queues; s/pfioc_qstats/pfioc_altqstats
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2013/03/11 19:50:04 sthen Exp $
d10 1
a10 1
REVISION=	5
d27 1
a27 1
WANTLIB-main=		${MODLIBICONV_WANTLIB} c m z jpeg png gd>=20
@


1.29
log
@Report new PF "translation" counter, indicating that address translation
has failed due to no free ports in the configured range. From Martin Pelikan.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2013/03/11 11:35:54 espie Exp $
d10 1
a10 2
REVISION-main=	2
REVISION-daemon=4
@


1.28
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2011/06/23 22:50:28 naddy Exp $
d10 2
a11 2
REVISION-main=	1
REVISION-daemon=3
@


1.27
log
@Cope with bsd.man.mk changes and install source man pages.
While here, also update some PLISTs, fix PREFIX use, etc.
ok landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2011/06/07 22:15:38 sthen Exp $
a20 3
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
@


1.26
log
@add an rc script; from Mattieu Baptiste, thank you.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2010/11/19 22:31:37 espie Exp $
d43 1
a43 1
	${INSTALL_MAN} ${WRKSRC}/pfstat.cat8 ${PREFIX}/man/cat8/pfstat.0
d45 1
a45 2
	${INSTALL_MAN} ${WRKSRC}/pfstatd/pfstatd.cat8 \
		       ${PREFIX}/man/cat8/pfstatd.0
@


1.25
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2010/11/06 10:18:38 espie Exp $
d11 1
a11 1
REVISION-daemon=2
@


1.24
log
@convert libiconv to new wantlib
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2010/10/19 21:04:52 naddy Exp $
d25 1
a25 1
BUILD_DEPENDS=		::graphics/gd
d31 2
a32 2
WANTLIB-main=		${MODLIBICONV_WANTLIB} c m z jpeg png gd.>=20
LIB_DEPENDS-main=	${MODLIBICONV_LIB_DEPENDS} ::graphics/gd
@


1.23
log
@ports that preformat man pages with mandoc via bsd.man.mk don't need groff
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2010/10/18 18:36:56 espie Exp $
d31 2
a32 3
WANTLIB-main=		c m z jpeg png
LIB_DEPENDS-main=	gd.>=20::graphics/gd \
			${MODLIBICONV_LIB_DEPENDS}
@


1.22
log
@USE_GROFF=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2010/07/12 22:07:40 sthen Exp $
a27 1
USE_GROFF =	Yes
@


1.21
log
@use REVISION, checked with before/after make show=PKGNAMES (plus some
extra-careful checking where there are complicated PSEUDO_FLAVORS).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2010/04/08 19:31:31 naddy Exp $
d28 1
@


1.20
log
@mdox fixes; install cat pages
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2009/04/09 22:08:47 sthen Exp $
d8 4
a11 2
PKGNAME-main=	${DISTNAME}p1
PKGNAME-daemon=	${DISTNAME:S/-/d-/}p2
@


1.19
log
@bump following PF changes; from kili@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2009/03/28 17:01:59 naddy Exp $
d9 1
a9 1
PKGNAME-daemon=	${DISTNAME:S/-/d-/}p1
d42 1
a42 1
	${INSTALL_MAN} ${WRKSRC}/pfstat.8 ${PREFIX}/man/man8
d44 2
a45 1
	${INSTALL_MAN} ${WRKSRC}/pfstatd/pfstatd.8 ${PREFIX}/man/man8
d47 1
a47 1
	$(INSTALL_DATA) ${WRKSRC}/pfstat.conf.example	\
@


1.18
log
@missing bump when PLIST was regenerated
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2009/03/09 17:03:32 sthen Exp $
d9 1
a9 1
PKGNAME-daemon=	${DISTNAME:S/-/d-/}p0
@


1.17
log
@bump for pfvar.h changes (struct pfi_kif). regen PLIST while there.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2007/09/15 22:36:58 merdely Exp $
d9 1
a9 1
PKGNAME-daemon=	${DISTNAME:S/-/d-/}
@


1.16
log
@Remove surrounding quotes in COMMENT*/PERMIT_*/BROKEN/ERRORS

Add $OpenBSD$ to p5-SNMP-Info/Makefile (ok kili@@, simon@@)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2007/08/27 08:06:55 dhartmei Exp $
d8 1
a8 1
PKGNAME-main=	${DISTNAME}p0
@


1.15
log
@update to 2.3, don't use R_CURSOR with db->del(), it's slower with large
databases (actually crawls after reaching some size).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2006/08/03 23:15:58 espie Exp $
d3 2
a4 2
COMMENT-main=	"packet filter statistics visualization"
COMMENT-daemon=	"pfstat daemon"
@


1.14
log
@new MULTI_PACKAGES
@
text
@d6 1
a6 1
DISTNAME=	pfstat-2.2
@


1.13
log
@new style specs
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2006/05/24 15:15:41 dhartmei Exp $
d3 1
a3 1
COMMENT=	"packet filter statistics visualization"
d8 2
a9 1
PKGNAME-daemon=	${PKGNAME:S/-/d-/}
a22 5
MULTI_PACKAGES=		-daemon
SUBPACKAGE?=

WANTLIB=		c

d25 1
a25 3
.if defined(PACKAGING)
. if ${SUBPACKAGE} != "-daemon"
WANTLIB+=		jpeg m png z
d27 1
a27 1
MODULES=		converters/libiconv
d29 6
a34 3
LIB_DEPENDS=		gd.>=20::graphics/gd
. endif
.endif
@


1.12
log
@update to 2.2, ok sturm@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2005/10/24 05:09:59 fgsch Exp $
d35 1
a35 1
LIB_DEPENDS=		gd.20::graphics/gd
@


1.11
log
@sync with gd update. sturm@@ ok.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2005/10/12 05:39:32 fgsch Exp $
d4 1
d6 3
a8 2
DISTNAME=	pfstat-1.7
PKGNAME=	${DISTNAME}p1
d16 1
a20 1
WANTLIB=		c jpeg m png z 
d22 16
a37 1
MODULES=	converters/libiconv
d39 3
a41 1
LIB_DEPENDS=	gd.18::graphics/gd
d46 5
@


1.10
log
@sync with gd update; feedback from several ppl.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2004/12/16 00:31:24 alek Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p0
d18 1
a18 1
WANTLIB=		c jpeg m png ttf z 
@


1.9
log
@Add WANTLIB markers
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2003/10/06 09:27:59 dhartmei Exp $
d6 1
d19 2
@


1.8
log
@update to 1.7, fixes parsing and rendering of moths (30 days) and
years (365 days).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2003/06/27 08:03:55 dhartmei Exp $
d17 1
@


1.7
log
@Small update to 1.6:
- fix a division-by-zero in case all values being scaled are zero,
found by Stefan Siebe.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2003/06/07 23:52:40 dhartmei Exp $
d5 1
a5 1
DISTNAME=	pfstat-1.6
@


1.6
log
@Update to 1.5, adds 'type jpeg|png' option to create .jpg|.png.
Patch from Adam Thomason.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2003/04/15 01:38:34 dhartmei Exp $
d5 1
a5 1
DISTNAME=	pfstat-1.5
d9 1
a9 1
HOMEPAGE=	http://www.benzedrine.cx/pf.html
@


1.5
log
@allow absolute time values (seconds since Epoch), useful for files with
fixed start/end times.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2003/01/24 20:15:41 dhartmei Exp $
d5 1
a5 1
DISTNAME=	pfstat-1.4
@


1.4
log
@Fix breakage from recent pf changes, macros PF_IN/PF_OUT changed, and they
were (ab)used as indices for the statistics counter arrays. Use literal
indices instead.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2003/01/24 17:59:45 dhartmei Exp $
d5 1
a5 1
DISTNAME=	pfstat-1.3
@


1.3
log
@Small update to 1.2, deal with reset counters, which caused negative
difference for cumulative values, which wrapped and caused huge spikes
in the graphs. Just ignore the first sample after the reset.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2002/08/12 11:37:03 dhartmei Exp $
d5 1
a5 1
DISTNAME=	pfstat-1.2
@


1.2
log
@Update to 1.1
- get rid of X11/Xpm dependencies (not needed with -current gd)
- add graph generation example to man page (-c -d at the same time)
- open /dev/pf read-write, which is neccessary in 3.0
- change a counter to u_int64_t so it doesn't overflow
Thanks to wilfried@@, Philipp Morger, Jolan Luff, Rodolphe Ortalo
for feedback.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1 2002/07/26 07:25:35 dhartmei Exp $
d5 1
a5 1
DISTNAME=	pfstat-1.1
@


1.1
log
@pfstat is a small utility that collects packet filter statistics and
produces graphs.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.0 2002/07/25 12:21:00 dhartmei Exp $
d5 1
a5 1
DISTNAME=	pfstat-1.0
@

