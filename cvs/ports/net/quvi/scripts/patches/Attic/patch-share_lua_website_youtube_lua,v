head	1.2;
access;
symbols;
locks; strict;
comment	@# @;


1.2
date	2012.12.23.03.27.22;	author bentley;	state dead;
branches;
next	1.1;

1.1
date	2012.09.27.23.46.16;	author sthen;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Update libquvi to 0.4.1 and libquvi-scripts to 0.4.10.

ok sthen@@
@
text
@$OpenBSD: patch-share_lua_website_youtube_lua,v 1.1 2012/09/27 23:46:16 sthen Exp $

http://sourceforge.net/mailarchive/message.php?msg_id=29892252

--- share/lua/website/youtube.lua.orig	Fri Sep 28 00:43:26 2012
+++ share/lua/website/youtube.lua	Fri Sep 28 00:43:59 2012
@@@@ -125,7 +125,11 @@@@ function YouTube.iter_formats(config, U)
     for f in fmt_stream_map:gfind('([^,]*),') do
         local d = U.decode(f)
         if d['itag'] and d['url'] then
-            urls[U.unescape(d['itag'])] = U.unescape(d['url'])
+            local uurl = U.unescape(d['url'])
+            if d['sig'] then
+                uurl = uurl .. "&signature=" .. U.unescape(d['sig'])
+            end
+            urls[U.unescape(d['itag'])] = uurl
         end
     end
 
@


1.1
log
@adapt youtube parser; fixes cclive
@
text
@d1 1
a1 1
$OpenBSD$
@

