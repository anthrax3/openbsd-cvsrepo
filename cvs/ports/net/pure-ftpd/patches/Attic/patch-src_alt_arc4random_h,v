head	1.3;
access;
symbols
	OPENBSD_5_8:1.2.0.10
	OPENBSD_5_8_BASE:1.2
	OPENBSD_5_7:1.2.0.6
	OPENBSD_5_7_BASE:1.2
	OPENBSD_5_6:1.2.0.4
	OPENBSD_5_6_BASE:1.2
	OPENBSD_5_5:1.2.0.2
	OPENBSD_5_5_BASE:1.2;
locks; strict;
comment	@# @;


1.3
date	2015.10.14.10.01.55;	author sthen;	state dead;
branches;
next	1.2;
commitid	yAWs6xQUKKNMrFKk;

1.2
date	2013.10.25.23.45.55;	author sthen;	state Exp;
branches;
next	1.1;

1.1
date	2013.10.22.19.53.35;	author jca;	state Exp;
branches;
next	;


desc
@@


1.3
log
@update to pure-ftpd 1.0.42, from Brad
@
text
@$OpenBSD: patch-src_alt_arc4random_h,v 1.2 2013/10/25 23:45:55 sthen Exp $

From 6e9ec67ae461938caa2c641f7ca617298d5cca08 Mon Sep 17 00:00:00 2001
From: Frank Denis <github@@pureftpd.org>
Date: Tue, 22 Oct 2013 13:10:31 -0700
Subject: [PATCH] Check for arc4random_stir and arc4random_addrandom presence

--- src/alt_arc4random.h.orig	Fri Mar 16 01:01:37 2012
+++ src/alt_arc4random.h	Wed Oct 23 14:37:49 2013
@@@@ -7,8 +7,16 @@@@
 #ifdef __OpenBSD__
 
 #define alt_arc4random() arc4random()
-#define alt_arc4random_stir() arc4random_stir()
-#define alt_arc4random_addrandom(A, B) arc4random_addrandom(A, B)
+#ifdef HAVE_ARC4RANDOM_STIR
+# define alt_arc4random_stir() arc4random_stir()
+#else
+# define alt_arc4random_stir() (void) 0
+#endif
+#ifdef HAVE_ARC4RANDOM_ADDRANDOM
+# define alt_arc4random_addrandom(A, B) arc4random_addrandom(A, B)
+#else
+# define alt_arc4random_addrandom(A, B) (void) 0
+#endif
 #define alt_arc4random_uniform(A) arc4random_uniform(A)
 #define alt_arc4random_buf(A, B) arc4random_buf(A, B)
 
@


1.2
log
@switch to upstream's patch for arc4random changes; ok brad@@
@
text
@d1 1
a1 1
$OpenBSD$
@


1.1
log
@Fixup after arc4random_addrandom/arc4random_stir removal.
(__OpenBSD__ #ifdef'ed code).  ok naddy@@
@
text
@d2 9
a10 3
--- src/alt_arc4random.h.orig	Tue Oct 22 17:42:57 2013
+++ src/alt_arc4random.h	Tue Oct 22 17:44:51 2013
@@@@ -7,8 +7,8 @@@@
d16 10
a25 2
+#define alt_arc4random_stir()
+#define alt_arc4random_addrandom(A, B)
@

