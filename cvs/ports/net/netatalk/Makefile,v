head	1.61;
access;
symbols
	OPENBSD_6_0:1.61.0.2
	OPENBSD_6_0_BASE:1.61
	OPENBSD_5_9:1.59.0.2
	OPENBSD_5_9_BASE:1.59
	OPENBSD_5_8:1.59.0.4
	OPENBSD_5_8_BASE:1.59
	OPENBSD_5_7:1.57.0.2
	OPENBSD_5_7_BASE:1.57
	OPENBSD_5_6:1.55.0.2
	OPENBSD_5_6_BASE:1.55
	OPENBSD_5_5:1.52.0.2
	OPENBSD_5_5_BASE:1.52
	OPENBSD_5_4:1.50.0.2
	OPENBSD_5_4_BASE:1.50
	OPENBSD_5_3:1.46.0.2
	OPENBSD_5_3_BASE:1.46
	OPENBSD_5_2:1.41.0.2
	OPENBSD_5_2_BASE:1.41
	OPENBSD_5_1_BASE:1.37
	OPENBSD_5_1:1.37.0.2
	OPENBSD_5_0:1.32.0.2
	OPENBSD_5_0_BASE:1.32
	OPENBSD_4_9:1.31.0.2
	OPENBSD_4_9_BASE:1.31
	OPENBSD_4_8:1.27.0.2
	OPENBSD_4_8_BASE:1.27
	OPENBSD_4_7:1.26.0.2
	OPENBSD_4_7_BASE:1.26
	OPENBSD_4_6:1.24.0.2
	OPENBSD_4_6_BASE:1.24
	OPENBSD_4_5:1.23.0.6
	OPENBSD_4_5_BASE:1.23
	OPENBSD_4_4:1.23.0.4
	OPENBSD_4_4_BASE:1.23
	OPENBSD_4_3:1.23.0.2
	OPENBSD_4_3_BASE:1.23
	OPENBSD_4_2:1.21.0.4
	OPENBSD_4_2_BASE:1.21
	OPENBSD_4_1:1.21.0.2
	OPENBSD_4_1_BASE:1.21
	OPENBSD_4_0:1.18.0.14
	OPENBSD_4_0_BASE:1.18
	OPENBSD_3_9:1.18.0.12
	OPENBSD_3_9_BASE:1.18
	OPENBSD_3_8:1.18.0.10
	OPENBSD_3_8_BASE:1.18
	OPENBSD_3_7:1.18.0.8
	OPENBSD_3_7_BASE:1.18
	OPENBSD_3_6:1.18.0.6
	OPENBSD_3_6_BASE:1.18
	OPENBSD_3_5:1.18.0.4
	OPENBSD_3_5_BASE:1.18
	OPENBSD_3_4:1.18.0.2
	OPENBSD_3_4_BASE:1.18
	OPENBSD_3_3:1.17.0.4
	OPENBSD_3_3_BASE:1.17
	OPENBSD_3_2:1.17.0.2
	OPENBSD_3_2_BASE:1.17
	OPENBSD_3_1:1.16.0.2
	OPENBSD_3_1_BASE:1.16
	OPENBSD_3_0:1.15.0.2
	OPENBSD_3_0_BASE:1.15
	OPENBSD_2_9_TRACKING_SWITCH:1.15
	OPENBSD_2_9:1.14.0.2
	OPENBSD_2_9_BASE:1.14
	OPENBSD_2_8:1.13.0.2
	OPENBSD_2_8_BASE:1.13
	OPENBSD_2_7:1.11.0.2
	OPENBSD_2_7_BASE:1.11
	OPENBSD_2_6:1.7.0.2
	OPENBSD_2_6_BASE:1.7
	OPENBSD_2_5:1.2.0.2
	OPENBSD_2_5_BASE:1.2
	marc_1999-Jan-18:1.1.1.1
	marc:1.1.1;
locks; strict;
comment	@# @;


1.61
date	2016.06.29.16.14.44;	author espie;	state Exp;
branches;
next	1.60;
commitid	c1yQMbJbfo0CFBcL;

1.60
date	2016.03.18.21.38.25;	author naddy;	state Exp;
branches;
next	1.59;
commitid	BVkebQSTXSZokeRG;

1.59
date	2015.07.01.08.19.39;	author ajacoutot;	state Exp;
branches;
next	1.58;
commitid	UbhU6fIcnbbqJ7qr;

1.58
date	2015.04.04.09.21.03;	author ajacoutot;	state Exp;
branches;
next	1.57;
commitid	kS3kwKZogsvzYmEY;

1.57
date	2015.02.17.22.08.36;	author sthen;	state Exp;
branches;
next	1.56;
commitid	xaIHtCntkggL7CxN;

1.56
date	2014.12.08.10.57.09;	author ajacoutot;	state Exp;
branches;
next	1.55;
commitid	pz71RdO0gxd0iylf;

1.55
date	2014.04.23.05.53.36;	author ajacoutot;	state Exp;
branches;
next	1.54;

1.54
date	2014.04.21.15.21.22;	author ajacoutot;	state Exp;
branches;
next	1.53;

1.53
date	2014.03.23.21.05.25;	author brad;	state Exp;
branches;
next	1.52;

1.52
date	2013.10.31.21.12.13;	author sthen;	state Exp;
branches;
next	1.51;

1.51
date	2013.10.06.21.49.32;	author brad;	state Exp;
branches;
next	1.50;

1.50
date	2013.06.20.06.54.37;	author ajacoutot;	state Exp;
branches;
next	1.49;

1.49
date	2013.06.17.19.30.53;	author ajacoutot;	state Exp;
branches;
next	1.48;

1.48
date	2013.03.21.08.46.34;	author ajacoutot;	state Exp;
branches;
next	1.47;

1.47
date	2013.03.11.11.35.49;	author espie;	state Exp;
branches;
next	1.46;

1.46
date	2013.02.09.14.49.52;	author sthen;	state Exp;
branches;
next	1.45;

1.45
date	2013.01.09.23.06.24;	author sthen;	state Exp;
branches;
next	1.44;

1.44
date	2012.10.10.08.11.09;	author jasper;	state Exp;
branches;
next	1.43;

1.43
date	2012.08.27.06.19.48;	author ajacoutot;	state Exp;
branches;
next	1.42;

1.42
date	2012.08.25.10.15.47;	author ajacoutot;	state Exp;
branches;
next	1.41;

1.41
date	2012.07.04.13.00.46;	author ajacoutot;	state Exp;
branches;
next	1.40;

1.40
date	2012.06.15.10.34.46;	author ajacoutot;	state Exp;
branches;
next	1.39;

1.39
date	2012.04.22.13.44.09;	author ajacoutot;	state Exp;
branches;
next	1.38;

1.38
date	2012.04.11.18.39.13;	author sthen;	state Exp;
branches;
next	1.37;

1.37
date	2012.01.25.20.21.31;	author sthen;	state Exp;
branches;
next	1.36;

1.36
date	2011.11.16.00.20.08;	author sthen;	state Exp;
branches;
next	1.35;

1.35
date	2011.10.31.19.51.19;	author naddy;	state Exp;
branches;
next	1.34;

1.34
date	2011.09.16.11.13.39;	author espie;	state Exp;
branches;
next	1.33;

1.33
date	2011.09.12.18.02.35;	author naddy;	state Exp;
branches;
next	1.32;

1.32
date	2011.03.14.09.17.01;	author sthen;	state Exp;
branches;
next	1.31;

1.31
date	2010.11.26.14.50.10;	author espie;	state Exp;
branches;
next	1.30;

1.30
date	2010.11.19.22.31.35;	author espie;	state Exp;
branches;
next	1.29;

1.29
date	2010.11.11.16.27.54;	author espie;	state Exp;
branches;
next	1.28;

1.28
date	2010.10.18.18.36.50;	author espie;	state Exp;
branches;
next	1.27;

1.27
date	2010.07.12.22.07.39;	author sthen;	state Exp;
branches;
next	1.26;

1.26
date	2010.03.01.13.41.31;	author espie;	state Exp;
branches;
next	1.25;

1.25
date	2009.08.14.19.09.22;	author naddy;	state Exp;
branches;
next	1.24;

1.24
date	2009.03.16.11.05.54;	author sthen;	state Exp;
branches
	1.24.2.1;
next	1.23;

1.23
date	2007.10.26.14.27.23;	author steven;	state Exp;
branches
	1.23.6.1;
next	1.22;

1.22
date	2007.09.15.22.36.56;	author merdely;	state Exp;
branches;
next	1.21;

1.21
date	2006.11.17.22.05.02;	author aanriot;	state Exp;
branches;
next	1.20;

1.20
date	2006.10.12.06.46.42;	author sturm;	state Exp;
branches;
next	1.19;

1.19
date	2006.09.22.05.54.33;	author pvalchev;	state Exp;
branches;
next	1.18;

1.18
date	2003.08.11.00.14.43;	author naddy;	state Exp;
branches;
next	1.17;

1.17
date	2002.07.23.11.54.37;	author naddy;	state Exp;
branches;
next	1.16;

1.16
date	2002.02.21.12.34.57;	author naddy;	state Exp;
branches;
next	1.15;

1.15
date	2001.08.16.03.23.21;	author brad;	state Exp;
branches;
next	1.14;

1.14
date	2001.04.18.13.00.26;	author brad;	state Exp;
branches;
next	1.13;

1.13
date	2000.10.23.16.08.13;	author espie;	state Exp;
branches;
next	1.12;

1.12
date	2000.08.10.17.53.31;	author brad;	state Exp;
branches;
next	1.11;

1.11
date	2000.04.18.10.34.09;	author turan;	state Exp;
branches
	1.11.2.1;
next	1.10;

1.10
date	2000.04.09.17.37.29;	author espie;	state Exp;
branches;
next	1.9;

1.9
date	99.12.15.03.29.29;	author brad;	state Exp;
branches;
next	1.8;

1.8
date	99.12.15.02.54.39;	author kevlo;	state Exp;
branches;
next	1.7;

1.7
date	99.08.28.10.27.10;	author maja;	state Exp;
branches;
next	1.6;

1.6
date	99.05.25.14.39.42;	author brad;	state Exp;
branches;
next	1.5;

1.5
date	99.05.25.05.23.12;	author brad;	state Exp;
branches;
next	1.4;

1.4
date	99.05.25.03.00.45;	author brad;	state Exp;
branches;
next	1.3;

1.3
date	99.05.24.02.33.58;	author brad;	state Exp;
branches;
next	1.2;

1.2
date	99.03.31.22.51.00;	author marc;	state Exp;
branches;
next	1.1;

1.1
date	99.01.19.04.40.13;	author marc;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	99.01.19.04.40.13;	author marc;	state Exp;
branches;
next	;

1.11.2.1
date	2000.09.15.05.09.48;	author marc;	state Exp;
branches;
next	;

1.23.6.1
date	2009.08.13.02.55.14;	author william;	state Exp;
branches;
next	;

1.24.2.1
date	2009.10.31.04.07.54;	author william;	state Exp;
branches;
next	;


desc
@@


1.61
log
@add is-branch to all trivial ports that exist as multiple branches.
@
text
@# $OpenBSD: Makefile,v 1.60 2016/03/18 21:38:25 naddy Exp $

PORTROACH=	limit:^2

COMMENT=	AFP file and print services for IP networks

DISTNAME=	netatalk-2.2.5
REVISION=	7
CATEGORIES=	net
MASTER_SITES=	${MASTER_SITE_SOURCEFORGE:=netatalk/}
EXTRACT_SUFX=	.tar.bz2

HOMEPAGE=	http://netatalk.sourceforge.net/

# GPLv2+ and BSD or similar
PERMIT_PACKAGE_CDROM=	Yes

WANTLIB += c crypto db gcrypt gpg-error pthread rpcsvc

MODULES=	devel/gettext
LIB_DEPENDS=	databases/db/v4 \
		security/libgcrypt 

USE_GROFF=	Yes
CONFIGURE_STYLE= gnu
CONFIGURE_ARGS=	--disable-cups \
		--disable-overwrite \
		--disable-tcp-wrappers \
		--with-ssl-dir=/usr \
		--with-uams-path=${PREFIX}/lib/netatalk/uams \
		--without-ldap \
		--without-pam
CONFIGURE_ENV=	CPPFLAGS="-I${LOCALBASE}/include" \
		LDFLAGS="-L${LOCALBASE}/lib"

FLAVORS=	avahi
FLAVOR?=

.if ${FLAVOR:Mavahi}
WANTLIB+=	avahi-client avahi-common dbus-1
LIB_DEPENDS+=	net/avahi
.else
CONFIGURE_ARGS+= --disable-zeroconf
.endif

NO_TEST=	Yes

post-build:
	@@cd ${WRKSRC}/config; make afpd.conf AppleVolumes.default

post-install:
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/netatalk
	${INSTALL_DATA} ${WRKSRC}/doc/README.AppleTalk \
	    ${PREFIX}/share/doc/netatalk
	mv ${WRKINST}/etc/netatalk ${PREFIX}/share/examples/
	@@find ${PREFIX}/lib/netatalk/uams -name '*.a' -print | xargs rm
	@@find ${PREFIX}/lib/netatalk/uams -name '*.la' -print | xargs rm

.include <bsd.port.mk>
@


1.60
log
@remove SHARED_ONLY from simple ports that use the gettext or libiconv module
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59 2015/07/01 08:19:39 ajacoutot Exp $
d8 1
a8 1
REVISION=	6
@


1.59
log
@Add PORTROACH.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2015/04/04 09:21:03 ajacoutot Exp $
a3 2

SHARED_ONLY=	Yes
@


1.58
log
@Bump after the recent changes in packaging dbus and dconf.
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.57 2015/02/17 22:08:36 sthen Exp $
@


1.57
log
@Adjust the "meta" rc-scripts (these are used in ports with multiple daemons
which should all be started/stopped together), previously "restart" would
restart each sub-daemon in turn, but actually it should stop all daemons
and only then start them again. Additionally, as suggested by ajacoutot,
stop the procedure and return an error if stopping one of the rc scripts
failed.  ok ajacoutot@@ rpe@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2014/12/08 10:57:09 ajacoutot Exp $
d8 1
a8 1
REVISION=	5
@


1.56
log
@Make all meta rc.d scripts consistent.
While here, unbreak when options are passed (e.g. /etc/rc.d/foobar -df start)

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55 2014/04/23 05:53:36 ajacoutot Exp $
d8 1
a8 1
REVISION=	4
@


1.55
log
@Drop uneeded patch.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.54 2014/04/21 15:21:22 ajacoutot Exp $
d8 1
a8 1
REVISION=	3
@


1.54
log
@Drop kerberos support.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2014/03/23 21:05:25 brad Exp $
d8 1
a8 1
REVISION=	2
@


1.53
log
@Disable TCP wrappers support.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.52 2013/10/31 21:12:13 sthen Exp $
d8 1
a8 1
REVISION=	1
d18 1
a18 2
WANTLIB += asn1 c com_err crypto db gcrypt gpg-error gssapi heimbase
WANTLIB += krb5 pthread roken rpcsvc wind
a28 1
		--enable-krbV-uam \
@


1.52
log
@bump REVISION for any ports using route messages. regen some distinfos and
remove unnecessary USE_GROFFs while there.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 2013/10/06 21:49:32 brad Exp $
d8 1
a8 1
REVISION=	0
d19 1
a19 1
WANTLIB += krb5 pthread roken rpcsvc wind wrap
d29 1
@


1.51
log
@Update to netatalk 2.2.5.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2013/06/20 06:54:37 ajacoutot Exp $
d8 1
@


1.50
log
@Unbreak after hx509 and ntlm removal from Kerberos.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2013/06/17 19:30:53 ajacoutot Exp $
d7 1
a7 2
DISTNAME=	netatalk-2.2.3
REVISION=	5
a30 1
		--without-acls \
@


1.49
log
@Unbreak with new Heimdal; get rid of self-cooked krb5-config since we
have it in base now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2013/03/21 08:46:34 ajacoutot Exp $
d8 1
a8 1
REVISION=	4
d19 1
a19 1
WANTLIB += heimntlm hx509 krb5 pthread roken rpcsvc wind wrap
@


1.48
log
@USE_LIBTOOL=Yes is the default now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2013/03/11 11:35:49 espie Exp $
d8 1
a8 1
REVISION=	3
d18 2
a19 2
WANTLIB=	asn1 c crypto db>=4 gcrypt gpg-error gssapi krb5 pthread \
		rpcsvc wrap
a48 3

post-extract:
	@@${INSTALL} -m 555 ${FILESDIR}/krb5-config ${WRKDIR}/bin
@


1.47
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2013/02/09 14:49:52 sthen Exp $
a25 1
USE_LIBTOOL=	Yes
@


1.46
log
@Don't use ${FLAVOR:L}, we only support lower-case flavours now.
OK ajacoutot@@ espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2013/01/09 23:06:24 sthen Exp $
a16 3
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
d49 1
a49 1
NO_REGRESS=	Yes
@


1.45
log
@mark conflict: astro/jday, net/netatalk
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2012/10/10 08:11:09 jasper Exp $
d45 1
a45 1
.if ${FLAVOR:L:Mavahi}
@


1.44
log
@- disable PAM support to make sure it doesn't get picked up when PAM is around.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2012/08/27 06:19:48 ajacoutot Exp $
d8 1
a8 1
REVISION=	2
@


1.43
log
@Remove -pthread patching.

from Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2012/08/25 10:15:47 ajacoutot Exp $
d37 2
a38 1
		--without-ldap
@


1.42
log
@Simplify how the order of the _pkg_scripts entries get reversed on stop.

from rpe, ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2012/07/04 13:00:46 ajacoutot Exp $
d8 1
a8 1
REVISION=	1
@


1.41
log
@Add comment that daemon_flags, daemon_user and daemon_class are not passed
to the child scripts.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2012/06/15 10:34:46 ajacoutot Exp $
d8 1
a8 1
REVISION=	0
@


1.40
log
@Update to netatalk 2.2.3.

from Brad with a tweak
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2012/04/22 13:44:09 ajacoutot Exp $
d8 1
@


1.39
log
@/etc/rc.d -> RCDIR
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2012/04/11 18:39:13 sthen Exp $
d7 1
a7 2
DISTNAME=	netatalk-2.2.2
REVISION=	0
a51 3
EXAMPLES=	AppleVolumes.default AppleVolumes.system netatalk.conf \
		afpd.conf

a59 1
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/netatalk
d62 1
a62 3
.for i in ${EXAMPLES}
	${INSTALL_DATA} ${WRKSRC}/config/$i ${PREFIX}/share/examples/netatalk
.endfor
@


1.38
log
@update to netatalk 2.2.2, from Brad, tested by william@@ and Ian McWilliam
- support for MacOS X Lion and TimeMachine
- add rc scripts
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2012/01/25 20:21:31 sthen Exp $
d8 1
@


1.37
log
@Drop Arnaud Bergeron as MAINTAINER, diff from Brad, ok with Arnaud.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2011/11/16 00:20:08 sthen Exp $
d3 1
a3 1
COMMENT=	AFP file and print services for AppleTalk/IP networks
d5 3
a7 2
DISTNAME=	netatalk-2.0.3
REVISION=	10
d9 3
d14 35
a48 5
# Mainly GPL, some parts BSD or similar
PERMIT_PACKAGE_CDROM=		Yes
PERMIT_PACKAGE_FTP=		Yes
PERMIT_DISTFILES_CDROM=		Yes
PERMIT_DISTFILES_FTP=		Yes
d50 1
d52 2
a53 15
MASTER_SITES=	${MASTER_SITE_SOURCEFORGE:=netatalk/}

CONFIGURE_STYLE=	gnu
USE_LIBTOOL=		Yes
USE_GROFF =	Yes

WANTLIB=	c crypto rpcsvc db>=4
LIB_DEPENDS=	databases/db/v4

CONFIGURE_ARGS+=	--with-db4=${LOCALBASE}
CONFIGURE_ARGS+=	${CONFIGURE_SHARED} 
CONFIGURE_ARGS+=	--with-ssl=/usr
CONFIGURE_ARGS+=	--with-uams-path=${PREFIX}/lib/netatalk/uams
CONFIGURE_ARGS+=	--disable-overwrite
CONFIGURE_ARGS+=	--disable-cups
d55 2
a56 1
CONFIGURE_ENV+=		netatalk_cv_install_pam=no
d59 1
a59 2
	@@cd ${WRKSRC}/distrib/initscripts; make rc.atalk.bsd
	@@cd ${WRKSRC}/config; make afpd.conf
d62 1
d64 4
a67 6
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/netatalk

.for i in AppleVolumes.default AppleVolumes.system \
	atalkd.conf papd.conf netatalk.conf afpd.conf
	${INSTALL_DATA} ${WRKSRC}/config/$i \
		${PREFIX}/share/examples/netatalk
d69 2
a71 11
	${INSTALL_DATA} ${WRKSRC}/distrib/initscripts/rc.atalk.bsd \
		${PREFIX}/share/examples/netatalk

	${INSTALL_DATA} ${WRKSRC}/COPYRIGHT ${WRKSRC}/COPYING\
		${PREFIX}/share/doc/netatalk

.for i in FAQ README.hidden-items README.platforms README.logger \
	README.ids Netatalk-Manual.txt Netatalk-Manual.pdf
	${INSTALL_DATA} ${WRKSRC}/doc/$i ${PREFIX}/share/doc/netatalk
.endfor
 
@


1.36
log
@bumps; net/if.h
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2011/10/31 19:51:19 naddy Exp $
d6 1
a6 1
REVISION=	9
a8 2

MAINTAINER=	Arnaud Bergeron <abergeron@@gmail.com>
@


1.35
log
@don't try to copy nonexistent and unused /usr/include/netatalk files
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2011/09/16 11:13:39 espie Exp $
d6 1
a6 1
REVISION=	8
@


1.34
log
@normalize pkgpath
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2011/09/12 18:02:35 naddy Exp $
a36 3
post-patch:
	@@cp /usr/include/netatalk/*.h ${WRKSRC}/sys/netatalk

d38 2
a39 2
	@@(cd ${WRKSRC}/distrib/initscripts; make rc.atalk.bsd)
	@@(cd ${WRKSRC}/config; make afpd.conf)
@


1.33
log
@bump all (sub)packages that depend on db/v4; requested by and help from espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2011/03/14 09:17:01 sthen Exp $
d6 1
a6 1
REVISION=	7
@


1.32
log
@fix various typos, from Anthony J. Bentley with a few tweaks by myself
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2010/11/26 14:50:10 espie Exp $
d6 1
a6 1
REVISION=	6
@


1.31
log
@since db/v4 has db->=4,<5 as default, no need to specify it explicitly
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2010/11/19 22:31:35 espie Exp $
d6 1
a6 1
REVISION=	5
@


1.30
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2010/11/11 16:27:54 espie Exp $
d26 1
a26 1
LIB_DEPENDS=	db->=4,<5:databases/db/v4
@


1.29
log
@new WANTLIB
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2010/10/18 18:36:50 espie Exp $
d25 2
a26 2
WANTLIB=	c crypto rpcsvc db.>=4
LIB_DEPENDS=	:db->=4,<5:databases/db/v4
@


1.28
log
@USE_GROFF=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2010/07/12 22:07:39 sthen Exp $
a17 1
WANTLIB=			c crypto rpcsvc
d25 2
a26 1
LIB_DEPENDS=	db.>=4:db->=4,<5:databases/db/v4
@


1.27
log
@use REVISION, checked with before/after make show=PKGNAMES (plus some
extra-careful checking where there are complicated PSEUDO_FLAVORS).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2010/03/01 13:41:31 espie Exp $
d24 1
@


1.26
log
@fix up cleanup. while there, regen plist for @@bin markers.
pam is so wrong, and autconf is so wrong, that people using both even
manage to fuck up configure tests.

so it compiles on linux, it must be right ?

pathetic...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2009/08/14 19:09:22 naddy Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p5
@


1.25
log
@SECURITY FIX
Resolves CVE-2008-5718, diff from upstream

reminded by Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2009/03/16 11:05:54 sthen Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p4
d34 1
@


1.24
log
@fix pkgspec
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2007/10/26 14:27:23 steven Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p3
@


1.24.2.1
log
@SECURITY FIX

Resolves CVE-2008-5718, diff from upstream
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2009/08/14 19:09:22 naddy Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p4
@


1.23
log
@let this build with newer db4
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2007/09/15 22:36:56 merdely Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p2
d25 1
a25 1
LIB_DEPENDS=	db.>=4:db-4.*:databases/db/v4
@


1.23.6.1
log
@SECURITY FIX

Resolves CVE-2008-5718, diff from upstream

ok robert@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2007/10/26 14:27:23 steven Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p3
@


1.22
log
@Remove surrounding quotes in COMMENT*/PERMIT_*/BROKEN/ERRORS

Add $OpenBSD$ to p5-SNMP-Info/Makefile (ok kili@@, simon@@)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2006/11/17 22:05:02 aanriot Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p1
d25 1
a25 1
LIB_DEPENDS=	db.=4:db-4.*:databases/db/v4
@


1.21
log
@- use ${SYSCONFDIR} in PLIST.
- remove two deprecated CONFIGURE_ARGS (spotted by steven).
- bin/afppasswd is SUID root.

maintainer is too busy;
ok steven@@, "looks ok" pvalchev@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2006/10/12 06:46:42 sturm Exp $
d3 1
a3 1
COMMENT=	"AFP file and print services for AppleTalk/IP networks"
@


1.20
log
@fix LIB_DEPENDS
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2006/09/22 05:54:33 pvalchev Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p0
a29 2
CONFIGURE_ARGS+=	--with-config-dir=${CONFDIR}
CONFIGURE_ARGS+=	--with-pkgconfdir=${CONFDIR}
@


1.19
log
@Update to netatalk-2.0.3 and get rid of old directory structure.
A long due update with important features such as long filenames,
unicode, etc.
From new maintainer "Arnaud Bergeron" <abergeron@@gmail.com>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2004/12/16 00:31:23 alek Exp $
d6 1
d25 1
a25 1
LIB_DEPENDS=	db.4::databases/db/v4
@


1.18
log
@Remove old netatalk reference port.  Obsolete, broken, no longer useful.
Suggested by Ian McWilliam <ianm@@cit.uws.edu.au>, who was the last person
interested in this.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2002/07/23 11:54:37 naddy Exp $
d3 1
a3 1
     SUBDIR+= stable
d5 60
a64 1
.include <bsd.port.subdir.mk>
@


1.17
log
@Finish netatalk reorganization and update.
Submitted by maintainer Ian McWilliam <i.mcwilliam@@uws.edu.au>.
@
text
@d1 1
a1 1
# $OpenBSD$
a2 1
     SUBDIR+= reference
@


1.16
log
@Not for archs that have unsigned chars by default.
From maintainer Ian McWilliam <ianm@@cit.uws.edu.au>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2001/08/16 03:23:21 brad Exp $
d3 2
a4 1
NOT_FOR_ARCHS=	powerpc		# char is unsigned
d6 1
a6 49
COMMENT=	"File and Print Services for AppleTalk Networks"

DISTNAME=       netatalk-990130
CATEGORIES=	net
NEED_VERSION=	1.435
MASTER_SITES=	ftp://terminator.rs.itd.umich.edu/unix/netatalk/ \
		ftp://ftp.hanse.de/sites/transit/mirror/terminator.rs.itd.umich.edu/unix/netatalk/

HOMEPAGE=	http://www.umich.edu/~rsug/netatalk/

MAINTAINER=	Ian McWilliam <i.mcwilliam@@uws.edu.au>

PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes

MAKE_FLAGS=	CC="${CC}" OPTOPTS="${CFLAGS} -Wall" \
		PREFIX="${PREFIX}" SYSCONFDIR="${SYSCONFDIR}"
FAKE_FLAGS=	${MAKE_FLAGS} DESTDIR="${WRKINST}"

SYSCONFDIR=	/etc/netatalk

# NOTES:
# Will compile with kerberos support in apfd and papd.
# Haven't tested kerberos support as there is no MacOS
# support for kerberos outside the US, so your on your
# own. Still need to add support for AFS. Will update
# the Port shortly.

post-extract:
	@@cp -f ${FILESDIR}/cvolume_iconres.h ${WRKSRC}/etc/afpd

post-patch:
	@@rm -rf ${WRKSRC}/include/netatalk
	@@ln -sf /usr/include/netatalk ${WRKSRC}/include/netatalk
	@@rm -f ${WRKSRC}/sys/netatalk/*.h

post-install:
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/netatalk
	${INSTALL_DATA} ${WRKSRC}/config/AppleVolumes.system \
		${PREFIX}/share/examples/netatalk
	${INSTALL_DATA} ${WRKSRC}/config/AppleVolumes.default \
		${PREFIX}/share/examples/netatalk
	${INSTALL_DATA} ${WRKSRC}/README ${PREFIX}/share/doc/netatalk
	${INSTALL_DATA} ${WRKSRC}/INSTALL/README.OPENBSD \
		${PREFIX}/share/doc/netatalk

.include <bsd.port.mk>
@


1.15
log
@copy file from files/ dir instead of patching it into existence
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.14 2001/04/18 13:00:26 brad Exp $
@


1.14
log
@- integrate COMMENT
- bump NEED_VERSION
- hardcoded /etc/netatalk -> ${SYSCONFDIR}
--
Ok'd by: maintainer
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2000/10/23 16:08:13 espie Exp $
d7 1
a7 1
NEED_VERSION=	1.384
d32 3
@


1.13
log
@MAINTAINER
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.12 2000/08/10 17:53:31 brad Exp $
d7 2
a8 2
NEED_VERSION=	1.310
MASTER_SITES=   ftp://terminator.rs.itd.umich.edu/unix/netatalk/ \
d20 5
a24 2
MAKE_FLAGS=	CC="${CC}" OPTOPTS="${CFLAGS} -Wall"
FAKE_FLAGS=	${MAKE_FLAGS} PREFIX="${PREFIX}" DESTDIR="${WRKINST}"
@


1.12
log
@- Fake
- add HOMEPAGE, another distsite, NEED_VERSION and some more docs
- respect CC and CFLAGS
- move RESDIR from share to share/netatalk
- move examples from lib/netatalk to share/examples/netatalk
- remove the need for having the source tree installed, just use the
headers in /usr/include/netatalk
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2000/04/18 10:34:09 turan Exp $
d11 1
a11 1
MAINTAINER=	ianm@@cit.nepean.uws.edu.au	
@


1.11
log
@more missing licenses
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2000/04/09 17:37:29 espie Exp $
d5 5
a9 2
FAKE=No
MASTER_SITES=   ftp://terminator.rs.itd.umich.edu/unix/netatalk/
d18 3
d28 1
a28 10
pre-fetch:
.if !defined(NO_WARNINGS)
	@@if [ ! -f /usr/src/sys/netatalk/at_extern.h ]; then \
	 echo "This port requires the kernel source code to compile properly,"; \
	 echo "specifically the source code in /usr/src/sys/netatalk"; \
	 false ; \
	fi
.endif

pre-configure:
d30 1
a30 1
	@@ln -sf /usr/src/sys/netatalk ${WRKSRC}/include/netatalk
d34 8
a41 3
	@@cp ${WRKSRC}/config/AppleVolumes.system ${PREFIX}/lib/netatalk
	@@cp ${WRKSRC}/config/AppleVolumes.default ${PREFIX}/lib/netatalk
	@@PKG_PREFIX="${PREFIX}" sh ${PKGDIR}/INSTALL ${DISTNAME} POST-INSTALL
@


1.11.2.1
log
@bring net as of cut-over date into 2.7 branch
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2000/08/10 17:53:31 brad Exp $
d5 2
a6 5
NEED_VERSION=	1.310
MASTER_SITES=   ftp://terminator.rs.itd.umich.edu/unix/netatalk/ \
		ftp://ftp.hanse.de/sites/transit/mirror/terminator.rs.itd.umich.edu/unix/netatalk/

HOMEPAGE=	http://www.umich.edu/~rsug/netatalk/
a14 3
MAKE_FLAGS=	CC="${CC}" OPTOPTS="${CFLAGS} -Wall"
FAKE_FLAGS=	${MAKE_FLAGS} PREFIX="${PREFIX}" DESTDIR="${WRKINST}"

d22 10
a31 1
post-patch:
d33 1
a33 1
	@@ln -sf /usr/include/netatalk ${WRKSRC}/include/netatalk
d37 3
a39 8
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/netatalk
	${INSTALL_DATA} ${WRKSRC}/config/AppleVolumes.system \
		${PREFIX}/share/examples/netatalk
	${INSTALL_DATA} ${WRKSRC}/config/AppleVolumes.default \
		${PREFIX}/share/examples/netatalk
	${INSTALL_DATA} ${WRKSRC}/README ${PREFIX}/share/doc/netatalk
	${INSTALL_DATA} ${WRKSRC}/INSTALL/README.OPENBSD \
		${PREFIX}/share/doc/netatalk
@


1.10
log
@explicit FAKE=No, so that we can turn FAKE on by default.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 1999/12/15 03:29:29 brad Exp $
d9 5
@


1.9
log
@remove deprecated variables
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 1999/12/15 02:54:39 kevlo Exp $
d5 1
@


1.8
log
@95% of the warnings are fixed. Port no longer destroys /etc/netatalk/rc.atalk
if it exists.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 1999/08/28 10:27:10 maja Exp $
d19 3
a21 3
	 ${ECHO} This port requires the kernel source code to compile properly,; \
	 ${ECHO} specifically the source code in /usr/src/sys/netatalk; \
	 ${FALSE}; \
a24 1

d26 3
a28 3
	@@${RM} -rf ${WRKSRC}/include/netatalk
	@@${LN} -sf /usr/src/sys/netatalk ${WRKSRC}/include/netatalk
	@@${RM} -f ${WRKSRC}/sys/netatalk/*.h
d31 3
a33 3
	@@${CP} ${WRKSRC}/config/AppleVolumes.system ${PREFIX}/lib/netatalk
	@@${CP} ${WRKSRC}/config/AppleVolumes.default ${PREFIX}/lib/netatalk
	@@PKG_PREFIX="${PREFIX}" ${SH} ${PKGDIR}/INSTALL ${DISTNAME} POST-INSTALL
@


1.7
log
@don't check for netatalk kernel source when doing a make mirror-distfiles. -moj
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 1999/05/25 14:39:42 brad Exp $
d3 1
a3 1
DISTNAME=       netatalk-1.4b2
a26 2
	@@${MKDIR} ${WRKSRC}/sys/openbsd
	@@${CP} ${FILESDIR}/sys-OpenBSD-Makefile ${WRKSRC}/sys/openbsd/Makefile
@


1.6
log
@make the port install and de-install properly in a package situation.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 1999/05/25 05:23:12 brad Exp $
d17 1
d23 2
@


1.5
log
@- back out previous commit.
- add in a check and message stating the requirement of the kernel source
code, if the kernel source code is not found to be installed.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 1999/05/25 03:00:45 brad Exp $
d31 3
a33 7
	@@if [ ! -a X"/etc/netatalk/AppleVolumes.system" ]; then	\
	 @@${CP} ${WRKSRC}/config/AppleVolumes.system /etc/netatalk; \
	fi
	@@if [ ! -a X"/etc/netatalk/AppleVolumes.default" ]; then \
	 @@${CP} ${WRKSRC}/config/AppleVolumes.default /etc/netatalk; \
	fi
	@@chmod 750 /etc/netatalk
@


1.4
log
@netatalk compiles "out of the box" with its own header files and does NOT
require the netatalk headers in openbsd source.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 1999/05/24 02:33:58 brad Exp $
d16 7
d24 5
a28 2
	@@mkdir -p ${WRKSRC}/sys/openbsd
	@@cp ${FILESDIR}/sys-OpenBSD-Makefile ${WRKSRC}/sys/openbsd/Makefile
d31 6
a36 6
@@if [ ! -a X"/etc/netatalk/AppleVolumes.system" ]; then		\
	@@cp ${WRKSRC}/config/AppleVolumes.system /etc/netatalk; \
fi
@@if [ ! -a X"/etc/netatalk/Applevolumes.default" ]; then	\
	@@cp ${WRKSRC}/config/AppleVolumes.default /etc/netatalk;\
fi
@


1.3
log
@- remove unnessary EXTRACT_SUFX
- respect CC and CFLAGS
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 1999/03/31 22:51:00 marc Exp $
d14 1
a14 1
# the Port shortly. 1999/01/08. ianm@@cit.nepean.uws.edu.au
a19 8
# This may cause problems if you don't have source installed. I'm
# just lazy and didn't want to patch most of netatalk's makefiles, .c
# and .h files. There's heaps that need fixing Maybe I will in the future.

	@@rm -rf ${WRKSRC}/include/netatalk
	@@ln -s /sys/netatalk ${WRKSRC}/include/netatalk
	@@rm -f ${WRKSRC}/sys/netatalk/*.h

a20 1

@


1.2
log
@netatalk update from ianm@@cit.nepean.uws.edu.au; Ian says:
This update implements changes to afpd (appletalk filing protocol daemon)
so that it handles users groups correctly for acess and handles the
effictive user and group of the parent process correctly under OpenBSD
2.5-beta. Previous fix didn't work quite as expected.
@
text
@d1 1
a1 6
# New OpenBSD Ports collection makefile for:    netatalk
#
# Version required:                     1.4b2
# Date created:                         8th January 1999
#
# $OpenBSD: Makefile,v 1.1.1.1 1999/01/19 04:40:13 marc Exp $
d4 1
a4 1
CATEGORIES=	net print
a5 1
EXTRACT_SUFX=	.tar.gz
@


1.1
log
@Initial revision
@
text
@d6 1
a6 1
# $OpenBSD$
d35 7
a41 2
	@@cp ${WRKSRC}/config/AppleVolumes.system /etc/netatalk
	@@cp ${WRKSRC}/config/AppleVolumes.default /etc/netatalk
@


1.1.1.1
log
@netatalk 1.4b2 port; ianm@@cit.nepean.uws.edu.au
@
text
@@
