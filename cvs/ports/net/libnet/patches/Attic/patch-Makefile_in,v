head	1.5;
access;
symbols
	OPENBSD_2_9:1.4.0.2
	OPENBSD_2_9_BASE:1.4
	OPENBSD_2_8:1.1.0.4
	OPENBSD_2_8_BASE:1.1
	OPENBSD_2_7:1.1.0.2;
locks; strict;
comment	@# @;


1.5
date	2001.06.04.05.50.52;	author dugsong;	state dead;
branches;
next	1.4;

1.4
date	2001.02.26.02.55.35;	author brad;	state Exp;
branches;
next	1.3;

1.3
date	2001.02.22.07.50.23;	author obecian;	state Exp;
branches;
next	1.2;

1.2
date	2001.01.10.01.00.36;	author naddy;	state Exp;
branches;
next	1.1;

1.1
date	2000.06.25.00.32.59;	author brad;	state Exp;
branches;
next	;


desc
@@


1.5
log
@fix configure.in so that libnet-config is actually useful, as requested by Matt Behrens <matt@@zigg.com>.
@
text
@--- Makefile.in.orig	Mon Feb  5 12:51:41 2001
+++ Makefile.in	Sun Feb 25 05:21:28 2001
@@@@ -36,7 +36,7 @@@@
 LN          =   @@LN@@
 CC          =   @@CC@@
 ENSUREDIR   =   $(srcdir)/ensure-dir.sh
-INSTALL_DATA=   $(srcdir)/install-sh
+INSTALL_DATA=   @@INSTALL@@
 CFLAGS      =   @@CFLAGS@@
 CPPFLAGS    =   @@CPPFLAGS@@
 OBJECTS     =   src/libnet_resolve.o\
@@@@ -66,17 +66,28 @@@@
 		src/libnet_hex_dump.o\
 		src/libnet_if_addr.o\
 		src/libnet_port_list.o 
+SHOBJECTS=	$(OBJECTS:S/.o/.so/)
+
+PICFLAG= -fpic
+SHLIB= $(LIBNET).so.0.0
+
+.SUFFIXES: .o .so
 
 .c.o:
 	$(CC) $(CFLAGS) $(CPPFLAGS) $(DEFINES) -c $< -o $@@
 
-all: libnet
+.c.so:
+	$(CC) $(CFLAGS) $(CPPFLAGS) $(DEFINES) $(PICFLAG) -DPIC -c $< -o $@@
+
 supp: test example
 
 libnet: version.h $(OBJECTS)
 	$(AR) -cr $(LIB) $(OBJECTS)
 	$(RANLIB) $(LIB)
 
+$(SHLIB): version.h $(SHOBJECTS)
+	$(CC) -shared $(PICFLAG) -o $(SHLIB) $(SHOBJECTS)
+
 version.o: version.h
 version.h: ./VERSION
 	@@rm -f $@@
@@@@ -91,25 +102,34 @@@@
 example: libnet install
 	cd example; make
 
+.if defined(NO_SHARED_LIBS) && ${NO_SHARED_LIBS:L} == "yes"
+all: libnet
 install: libnet
+.else
+all: libnet $(SHLIB)
+install: libnet $(SHLIB)
+.endif
 	$(ENSUREDIR) $(DESTDIR)$(prefix) 755
 	$(ENSUREDIR) $(DESTDIR)$(LIB_PREFIX) 755
 	$(ENSUREDIR) $(DESTDIR)$(INC_PREFIX)$(LIBNET) 755
 	$(ENSUREDIR) $(DESTDIR)$(INC_PREFIX) 755
 	$(ENSUREDIR) $(DESTDIR)$(MAN_PREFIX) 755
 	$(ENSUREDIR) $(DESTDIR)$(BIN_PREFIX) 755
-	$(INSTALL_DATA) $(LIB) $(DESTDIR)$(LIB_PREFIX)
+	$(INSTALL_DATA) -m 0644 $(LIB) $(DESTDIR)$(LIB_PREFIX)
 	rm -f $(DESTDIR)$(LIB_PREFIX)$(LIBPWRITE).a
 	cd $(DESTDIR)$(LIB_PREFIX); $(LN) -f -s $(LIBNET).a $(LIBPWRITE).a
-	$(INSTALL_DATA) $(INCLUDE) $(DESTDIR)$(INC_PREFIX)
-	$(INSTALL_DATA) $(INCLUDE-H) $(DESTDIR)$(INC_PREFIX)$(LIBNET)
-	$(INSTALL_DATA) $(INCLUDE-F) $(DESTDIR)$(INC_PREFIX)$(LIBNET)
-	$(INSTALL_DATA) $(INCLUDE-S) $(DESTDIR)$(INC_PREFIX)$(LIBNET)
-	$(INSTALL_DATA) $(INCLUDE-M) $(DESTDIR)$(INC_PREFIX)$(LIBNET)
-	$(INSTALL_DATA) $(INCLUDE-A) $(DESTDIR)$(INC_PREFIX)$(LIBNET)
-	$(INSTALL_DATA) $(INCLUDE-O) $(DESTDIR)$(INC_PREFIX)$(LIBNET)
-	$(INSTALL_DATA) $(MAN) $(DESTDIR)$(MAN_PREFIX)
-	$(INSTALL_DATA) $(CONFIG) $(DESTDIR)$(BIN_PREFIX)
+	@@if [ -f $(SHLIB) ]; then \
+	   $(INSTALL_DATA) -m 0644 $(SHLIB) $(DESTDIR)$(LIB_PREFIX) ;\
+	fi
+	$(INSTALL_DATA) -m 0644 $(INCLUDE) $(DESTDIR)$(INC_PREFIX)
+	$(INSTALL_DATA) -m 0644 $(INCLUDE-H) $(DESTDIR)$(INC_PREFIX)$(LIBNET)
+	$(INSTALL_DATA) -m 0644 $(INCLUDE-F) $(DESTDIR)$(INC_PREFIX)$(LIBNET)
+	$(INSTALL_DATA) -m 0644 $(INCLUDE-S) $(DESTDIR)$(INC_PREFIX)$(LIBNET)
+	$(INSTALL_DATA) -m 0644 $(INCLUDE-M) $(DESTDIR)$(INC_PREFIX)$(LIBNET)
+	$(INSTALL_DATA) -m 0644 $(INCLUDE-A) $(DESTDIR)$(INC_PREFIX)$(LIBNET)
+	$(INSTALL_DATA) -m 0644 $(INCLUDE-O) $(DESTDIR)$(INC_PREFIX)$(LIBNET)
+	$(INSTALL_DATA) -m 0644 $(MAN) $(DESTDIR)$(MAN_PREFIX)
+	$(INSTALL_DATA) -m 0755 $(CONFIG) $(DESTDIR)$(BIN_PREFIX)
 
 
 
@


1.4
log
@create a shared library for libnet
@
text
@@


1.3
log
@libnet 1.0.2a update
@
text
@d1 3
a3 3
--- Makefile.in.orig	Mon Feb 19 00:50:09 2001
+++ Makefile.in	Mon Feb 19 00:52:07 2001
@@@@ -36,7 +36,7 @@@@ AR          =   @@AR@@
d12 44
a55 1
@@@@ -98,18 +98,18 @@@@ install: libnet
d72 3
@


1.2
log
@honor CFLAGS, add RCS Ids; ok dugsong@@
@
text
@d1 2
a2 3
$OpenBSD$
--- Makefile.in.orig	Fri Mar 10 06:21:52 2000
+++ Makefile.in	Wed Jan 10 00:13:25 2001
d7 2
a8 2
-INSTALL     =   $(srcdir)/install-sh
+INSTALL     =   @@INSTALL@@
d12 1
a12 1
@@@@ -97,18 +97,18 @@@@ install: libnet
d16 24
a39 22
-	$(INSTALL) -c -m 0644 $(LIB) $(DESTDIR)$(LIB_PREFIX)
+	$(INSTALL) -m 0644 $(LIB) $(DESTDIR)$(LIB_PREFIX)
 	rm -f $(DESTDIR)$(LIB_PREFIX)$(LIBPWRITE)
 	$(LN) -f -s $(DESTDIR)$(LIB_PREFIX)$(LIBNET).a $(DESTDIR)$(LIB_PREFIX)$(LIBPWRITE)
-	$(INSTALL) -c -m 0644 $(INCLUDE) $(DESTDIR)$(INC_PREFIX)
-	$(INSTALL) -c -m 0644 $(INCLUDE-H) $(DESTDIR)$(INC_PREFIX)$(LIBNET)
-	$(INSTALL) -c -m 0644 $(INCLUDE-F) $(DESTDIR)$(INC_PREFIX)$(LIBNET)
-	$(INSTALL) -c -m 0644 $(INCLUDE-S) $(DESTDIR)$(INC_PREFIX)$(LIBNET)
-	$(INSTALL) -c -m 0644 $(INCLUDE-M) $(DESTDIR)$(INC_PREFIX)$(LIBNET)
-	$(INSTALL) -c -m 0644 $(INCLUDE-A) $(DESTDIR)$(INC_PREFIX)$(LIBNET)
-	$(INSTALL) -c -m 0644 $(INCLUDE-O) $(DESTDIR)$(INC_PREFIX)$(LIBNET)
-	$(INSTALL) -c -m 0644 $(MAN) $(DESTDIR)$(MAN_PREFIX)
-	$(INSTALL) -c -m 0755 $(CONFIG) $(DESTDIR)$(BIN_PREFIX)
+	$(INSTALL) -m 0644 $(INCLUDE) $(DESTDIR)$(INC_PREFIX)
+	$(INSTALL) -m 0644 $(INCLUDE-H) $(DESTDIR)$(INC_PREFIX)$(LIBNET)
+	$(INSTALL) -m 0644 $(INCLUDE-F) $(DESTDIR)$(INC_PREFIX)$(LIBNET)
+	$(INSTALL) -m 0644 $(INCLUDE-S) $(DESTDIR)$(INC_PREFIX)$(LIBNET)
+	$(INSTALL) -m 0644 $(INCLUDE-M) $(DESTDIR)$(INC_PREFIX)$(LIBNET)
+	$(INSTALL) -m 0644 $(INCLUDE-A) $(DESTDIR)$(INC_PREFIX)$(LIBNET)
+	$(INSTALL) -m 0644 $(INCLUDE-O) $(DESTDIR)$(INC_PREFIX)$(LIBNET)
+	$(INSTALL) -m 0644 $(MAN) $(DESTDIR)$(MAN_PREFIX)
+	$(INSTALL) -m 0755 $(CONFIG) $(DESTDIR)$(BIN_PREFIX)
a40 2
 clean:
 	if test -f test/Makefile; then \
@


1.1
log
@upgrade to libnet 1.0.1b
@
text
@d1 4
a4 3
--- Makefile.in.orig	Fri Mar 10 00:21:52 2000
+++ Makefile.in	Sat Jun 24 20:09:13 2000
@@@@ -36,7 +36,7 @@@@
d13 1
a13 1
@@@@ -97,18 +97,18 @@@@
@

