head	1.2;
access;
symbols
	OPENBSD_3_7:1.1.0.2
	OPENBSD_3_7_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2005.05.23.23.50.40;	author msf;	state dead;
branches;
next	1.1;

1.1
date	2005.03.14.14.04.18;	author espie;	state Exp;
branches;
next	;


desc
@@


1.2
log
@- split libnet port into two versions
- worked on by myself, pvalchev and mjc

"put it in" pvalchev@@
@
text
@$OpenBSD: patch-src_libnet_port_list_c,v 1.1 2005/03/14 14:04:18 espie Exp $
--- src/libnet_port_list.c.orig	Mon Mar 14 11:26:27 2005
+++ src/libnet_port_list.c	Mon Mar 14 11:28:58 2005
@@@@ -256,16 +256,18 @@@@ libnet_plist_chain_dump_string(struct li
     {
         if (p->bport == p->eport)
         {
-            i = sprintf(&buf[j], "%d", p->bport);
+            i = snprintf(&buf[j], BUFSIZ-j, "%d", p->bport);
         }
         else
         {
-            i = sprintf(&buf[j], "%d-%d", p->bport, p->eport);
+            i = snprintf(&buf[j], BUFSIZ-j, "%d-%d", p->bport, p->eport);
         }
         j += i;
+	if (j >= BUFSIZ)
+		break;
         if (p->next)
         {
-            sprintf(&buf[j++], ",");
+            snprintf(&buf[j++], BUFSIZ-j, ",");
         }
     }
     return (strdup(buf));       /* XXX - reentrancy == no */
@


1.1
log
@bye, bye, sprintf.
okay naddy@@
@
text
@d1 1
a1 1
$OpenBSD$
@

