head	1.2;
access;
symbols
	OPENBSD_6_0:1.2.0.32
	OPENBSD_6_0_BASE:1.2
	OPENBSD_5_9:1.2.0.28
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.2.0.30
	OPENBSD_5_8_BASE:1.2
	OPENBSD_5_7:1.2.0.26
	OPENBSD_5_7_BASE:1.2
	OPENBSD_5_6:1.2.0.24
	OPENBSD_5_6_BASE:1.2
	OPENBSD_5_5:1.2.0.22
	OPENBSD_5_5_BASE:1.2
	OPENBSD_5_4:1.2.0.20
	OPENBSD_5_4_BASE:1.2
	OPENBSD_5_3:1.2.0.18
	OPENBSD_5_3_BASE:1.2
	OPENBSD_5_2:1.2.0.16
	OPENBSD_5_2_BASE:1.2
	OPENBSD_5_1_BASE:1.2
	OPENBSD_5_1:1.2.0.14
	OPENBSD_5_0:1.2.0.12
	OPENBSD_5_0_BASE:1.2
	OPENBSD_4_9:1.2.0.10
	OPENBSD_4_9_BASE:1.2
	OPENBSD_4_8:1.2.0.8
	OPENBSD_4_8_BASE:1.2
	OPENBSD_4_7:1.2.0.6
	OPENBSD_4_7_BASE:1.2
	OPENBSD_4_6:1.2.0.4
	OPENBSD_4_6_BASE:1.2
	OPENBSD_4_5:1.2.0.2
	OPENBSD_4_5_BASE:1.2
	OPENBSD_4_4:1.1.0.14
	OPENBSD_4_4_BASE:1.1
	OPENBSD_4_3:1.1.0.12
	OPENBSD_4_3_BASE:1.1
	OPENBSD_4_2:1.1.0.10
	OPENBSD_4_2_BASE:1.1
	OPENBSD_4_1:1.1.0.8
	OPENBSD_4_1_BASE:1.1
	OPENBSD_4_0:1.1.0.6
	OPENBSD_4_0_BASE:1.1
	OPENBSD_3_9:1.1.0.4
	OPENBSD_3_9_BASE:1.1
	OPENBSD_3_8:1.1.0.2
	OPENBSD_3_8_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2008.11.08.22.09.40;	author sthen;	state Exp;
branches;
next	1.1;

1.1
date	2005.05.23.23.50.40;	author msf;	state Exp;
branches;
next	;


desc
@@


1.2
log
@regenerate patches in order that the next commit is more
readable; no package change.
@
text
@$OpenBSD: patch-src_libnet_if_addr_c,v 1.1 2005/05/23 23:50:40 msf Exp $
--- src/libnet_if_addr.c.orig	Sun Jan  7 18:55:16 2001
+++ src/libnet_if_addr.c	Sat Nov  8 22:07:54 2008
@@@@ -64,7 +64,7 @@@@ libnet_ifaddrlist(register struct libnet_ifaddr_list *
     fd = socket(AF_INET, SOCK_DGRAM, 0);
     if (fd < 0)
     {
-        sprintf(errbuf, "socket: %s", strerror(errno));
+        snprintf(errbuf, LIBNET_ERRBUF_SIZE, "socket: %s", strerror(errno));
         return (-1);
     }
     ifc.ifc_len = sizeof(ibuf);
@@@@ -74,7 +74,7 @@@@ libnet_ifaddrlist(register struct libnet_ifaddr_list *
             SIOCGIFCONF,
             (char *)&ifc) < 0 || ifc.ifc_len < sizeof(struct ifreq))
     {
-        sprintf(errbuf, "SIOCGIFCONF: %s", strerror(errno));
+        snprintf(errbuf, LIBNET_ERRBUF_SIZE, "SIOCGIFCONF: %s", strerror(errno));
         close(fd);
         return (-1);
     }
@@@@ -110,7 +110,7 @@@@ libnet_ifaddrlist(register struct libnet_ifaddr_list *
         if (ioctl(fd, SIOCGIFFLAGS, (char *)&ifr) < 0)
         {
             if (errno == ENXIO) continue;
-            sprintf(errbuf,
+            snprintf(errbuf, LIBNET_ERRBUF_SIZE,
                     "SIOCGIFFLAGS: %.*s: %s",
                     (int)sizeof(ifr.ifr_name),
                      ifr.ifr_name,
@@@@ -129,7 +129,7 @@@@ libnet_ifaddrlist(register struct libnet_ifaddr_list *
         device[sizeof(device) - 1] = '\0';
         if (ioctl(fd, SIOCGIFADDR, (char *)&ifr) < 0)
         {
-            sprintf(errbuf, "SIOCGIFADDR: %s: %s", device, strerror(errno));
+            snprintf(errbuf, LIBNET_ERRBUF_SIZE, "SIOCGIFADDR: %s: %s", device, strerror(errno));
             close(fd);
             return (-1);
         }
@@@@ -170,12 +170,12 @@@@ libnet_select_device(struct sockaddr_in *sin, char **d
     c = libnet_ifaddrlist(&address_list, err_buf);
     if (c < 0)
     {
-        sprintf(errbuf, "ifaddrlist : %s\n", err_buf);
+        snprintf(errbuf, LIBNET_ERRBUF_SIZE, "ifaddrlist : %s\n", err_buf);
         return (-1);
     }
     else if (c == 0)
     {
-        sprintf(errbuf, "No network interfaces found.\n");
+        snprintf(errbuf, LIBNET_ERRBUF_SIZE, "No network interfaces found.\n");
         return (-1);
     }
     if (*device)
@@@@ -189,7 +189,7 @@@@ libnet_select_device(struct sockaddr_in *sin, char **d
         }
         if (i <= 0)
         {
-            sprintf(errbuf, "Can't find interface %s\n", *device);
+            snprintf(errbuf, LIBNET_ERRBUF_SIZE, "Can't find interface %s\n", *device);
             return (-1);
         }
     }
@


1.1
log
@- split libnet port into two versions
- worked on by myself, pvalchev and mjc

"put it in" pvalchev@@
@
text
@d1 4
a4 4
$OpenBSD: patch-src_libnet_if_addr_c,v 1.1 2005/03/14 14:04:18 espie Exp $
--- src/libnet_if_addr.c.orig	Mon Mar 14 11:25:21 2005
+++ src/libnet_if_addr.c	Mon Mar 14 11:37:14 2005
@@@@ -64,7 +64,7 @@@@ libnet_ifaddrlist(register struct libnet
d13 1
a13 1
@@@@ -74,7 +74,7 @@@@ libnet_ifaddrlist(register struct libnet
d22 1
a22 1
@@@@ -110,7 +110,7 @@@@ libnet_ifaddrlist(register struct libnet
d31 1
a31 1
@@@@ -129,7 +129,7 @@@@ libnet_ifaddrlist(register struct libnet
d40 1
a40 1
@@@@ -170,12 +170,12 @@@@ libnet_select_device(struct sockaddr_in 
d55 1
a55 1
@@@@ -189,7 +189,7 @@@@ libnet_select_device(struct sockaddr_in 
@

