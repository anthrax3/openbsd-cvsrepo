head	1.3;
access;
symbols
	OPENBSD_6_1:1.3.0.14
	OPENBSD_6_1_BASE:1.3
	OPENBSD_6_0:1.3.0.12
	OPENBSD_6_0_BASE:1.3
	OPENBSD_5_9:1.3.0.8
	OPENBSD_5_9_BASE:1.3
	OPENBSD_5_8:1.3.0.10
	OPENBSD_5_8_BASE:1.3
	OPENBSD_5_7:1.3.0.6
	OPENBSD_5_7_BASE:1.3
	OPENBSD_5_6:1.3.0.4
	OPENBSD_5_6_BASE:1.3
	OPENBSD_5_5:1.3.0.2
	OPENBSD_5_5_BASE:1.3
	OPENBSD_5_4:1.2.0.10
	OPENBSD_5_4_BASE:1.2
	OPENBSD_5_3:1.2.0.8
	OPENBSD_5_3_BASE:1.2
	OPENBSD_5_2:1.2.0.6
	OPENBSD_5_2_BASE:1.2
	OPENBSD_5_1_BASE:1.2
	OPENBSD_5_1:1.2.0.4
	OPENBSD_5_0:1.2.0.2
	OPENBSD_5_0_BASE:1.2
	OPENBSD_4_9:1.1.0.8
	OPENBSD_4_9_BASE:1.1
	OPENBSD_4_8:1.1.0.6
	OPENBSD_4_8_BASE:1.1
	OPENBSD_4_7:1.1.0.4
	OPENBSD_4_7_BASE:1.1
	OPENBSD_4_6:1.1.0.2
	OPENBSD_4_6_BASE:1.1;
locks; strict;
comment	@# @;


1.3
date	2013.08.15.20.28.55;	author gsoares;	state Exp;
branches;
next	1.2;

1.2
date	2011.03.03.09.47.51;	author sthen;	state Exp;
branches;
next	1.1;

1.1
date	2009.06.26.09.20.41;	author sthen;	state Exp;
branches;
next	;


desc
@@


1.3
log
@update to 1.9; OK sthen@@ (MAINTAINER)
@
text
@$OpenBSD: patch-link-bpf_c,v 1.2 2011/03/03 09:47:51 sthen Exp $
--- link-bpf.c.orig	Sat Apr 27 05:39:08 2013
+++ link-bpf.c	Sun Aug 11 12:25:39 2013
@@@@ -96,6 +96,10 @@@@ get_hardware_address(const char *if_name, unsigned cha
  */
    for (p = buf; p < buf + len; p += ifm->ifm_msglen) {
       ifm = (struct if_msghdr *)p;
+
+      if (ifm->ifm_version != RTM_VERSION)
+         continue;
+
       sdl = (struct sockaddr_dl *)(ifm + 1);
 
       if (ifm->ifm_type != RTM_IFINFO || (ifm->ifm_addrs & RTA_IFP) == 0)
@


1.2
log
@- update arp-scan to 1.8, from Gleydson Soares
(license has changed to GPLv3-or-higher)

- use "@@comment no checksum" for vendor lists which the
supplied tools can update

- use @@sample for mac-vendor.txt, it's user-editable

ok jasper@@
@
text
@d1 4
a4 4
$OpenBSD: patch-link-bpf_c,v 1.1 2009/06/26 09:20:41 sthen Exp $
--- link-bpf.c.orig	Sun Jan  9 10:37:09 2011
+++ link-bpf.c	Thu Mar  3 08:58:57 2011
@@@@ -254,6 +254,10 @@@@ get_hardware_address(link_t *handle, unsigned char hw_
@


1.1
log
@check routing socket messages for RTM_VERSION
@
text
@d1 4
a4 4
$OpenBSD$
--- link-bpf.c.orig	Thu Jul 17 13:01:14 2008
+++ link-bpf.c	Fri Jun 26 10:16:27 2009
@@@@ -253,6 +253,10 @@@@ get_hardware_address(link_t *handle, unsigned char hw_
@

