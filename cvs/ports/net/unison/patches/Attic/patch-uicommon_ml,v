head	1.2;
access;
symbols;
locks; strict;
comment	@# @;


1.2
date	2015.01.09.10.10.43;	author giovanni;	state dead;
branches;
next	1.1;
commitid	DRAqcODwFPH1A9HK;

1.1
date	2014.10.17.06.22.08;	author chrisz;	state Exp;
branches;
next	;
commitid	D8dfuMu3oukLmUuk;


desc
@@


1.2
log
@Update to 2.48.3
Same diff from Björn Ketelaars, thanks
@
text
@$OpenBSD: patch-uicommon_ml,v 1.1 2014/10/17 06:22:08 chrisz Exp $

Don't discard backtraces for uncaught exceptions.

--- uicommon.ml.orig	Tue Sep 23 11:23:39 2014
+++ uicommon.ml	Tue Sep 23 11:37:20 2014
@@@@ -309,7 +309,8 @@@@ let reconItem2string oldPath theRI status =
   let (r1, action, r2, path) = reconItem2stringList oldPath theRI in
   Format.sprintf "%s %s %s %s %s" r1 (action2niceString action) r2 status path
 
-let exn2string = function
+let exn2string exn = 
+  let s = match exn with
     Sys.Break      -> "Terminated!"
   | Util.Fatal(s)  -> Printf.sprintf "Fatal error: %s" s
   | Util.Transient(s) -> Printf.sprintf "Error: %s" s
@@@@ -323,6 +324,9 @@@@ let exn2string = function
          | _                  -> "")
   | Invalid_argument s -> Printf.sprintf "Invalid argument: %s" s
   | other -> Printf.sprintf "Uncaught exception %s" (Printexc.to_string other)
+  in
+  s ^
+  if Printexc.backtrace_status () then "\n" ^ Printexc.get_backtrace () else ""
 
 (* precondition: uc = File (Updates(_, ..) on both sides *)
 let showDiffs ri printer errprinter id =
@


1.1
log
@Somehow I missed to cvs add the pkg and patches directories.
Thanks to Björn Ketelaars for telling me.
@
text
@d1 1
a1 1
$OpenBSD$
@

