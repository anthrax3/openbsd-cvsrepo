head	1.3;
access;
symbols
	OPENBSD_4_9:1.1.0.2
	OPENBSD_4_9_BASE:1.1;
locks; strict;
comment	@# @;


1.3
date	2011.05.05.08.51.35;	author sebastia;	state dead;
branches;
next	1.2;

1.2
date	2011.05.05.08.50.05;	author sebastia;	state Exp;
branches;
next	1.1;

1.1
date	2011.01.10.18.34.31;	author sebastia;	state Exp;
branches;
next	;


desc
@@


1.3
log
@REMOVE empty patch file.
@
text
@@


1.2
log
@Update spectrum to 1.4.7, minor bugfixes and little enhancements.

OK landry@@, reads fine jasper@@
@
text
@@


1.1
log
@Update to latest stable release.
While there, add a rcscript, and fix cpu hogging in case the password for the transport is wrong.

OK jasper@@
@
text
@a0 17
$OpenBSD$

fix for bug: http://spectrum.im/issues/131

--- src/main.cpp.orig	Tue Dec 28 17:58:40 2010
+++ src/main.cpp	Fri Jan  7 23:45:26 2011
@@@@ -1866,6 +1866,10 @@@@ void GlooxMessageHandler::onDisconnect(ConnectionError
 		m_userManager->removeAllUsers();
 
 	Log("gloox", "trying to reconnect after 1 second");
+	if (m_socketId > 0) {
+		purple_input_remove(m_socketId);
+		m_socketId = 0;
+	}
 	purple_timeout_add_seconds(1, &transportReconnect, NULL);
 
 // 	if (connectIO) {
@

