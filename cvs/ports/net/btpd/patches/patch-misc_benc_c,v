head	1.1;
access;
symbols
	OPENBSD_6_2:1.1.0.10
	OPENBSD_6_2_BASE:1.1
	OPENBSD_6_1:1.1.0.8
	OPENBSD_6_1_BASE:1.1
	OPENBSD_6_0:1.1.0.6
	OPENBSD_6_0_BASE:1.1
	OPENBSD_5_9:1.1.0.2
	OPENBSD_5_9_BASE:1.1
	OPENBSD_5_8:1.1.0.4
	OPENBSD_5_8_BASE:1.1;
locks; strict;
comment	@# @;


1.1
date	2015.05.15.08.59.09;	author bentley;	state Exp;
branches;
next	;
commitid	k9JF0NfwBBQ7Zbut;


desc
@@


1.1
log
@Backport a bugfix from upstream. Take maintainership.

ok nicm@@ (previous maintainer)
@
text
@$OpenBSD$
Be more lenient when parsing invalid .torrent files.

From upstream commit 382ccb74857c8de10d3319486a4a1137763badf7.
--- misc/benc.c.orig	Wed Jul 14 20:51:43 2010
+++ misc/benc.c	Fri May 15 01:23:42 2015
@@@@ -233,10 +233,8 @@@@ benc_dget_any(const char *p, const char *key)
         cmp = strncmp(bstr, key, blen);
         if (cmp == 0 && len == blen)
             return p;
-        else if (cmp <= 0)
-            p = benc_next(p);
         else
-            return NULL;
+            p = benc_next(p);
     }
     return NULL;
 }
@
