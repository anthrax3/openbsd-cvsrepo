head	1.3;
access;
symbols
	OPENBSD_6_0:1.3.0.16
	OPENBSD_6_0_BASE:1.3
	OPENBSD_5_9:1.3.0.12
	OPENBSD_5_9_BASE:1.3
	OPENBSD_5_8:1.3.0.14
	OPENBSD_5_8_BASE:1.3
	OPENBSD_5_7:1.3.0.10
	OPENBSD_5_7_BASE:1.3
	OPENBSD_5_6:1.3.0.8
	OPENBSD_5_6_BASE:1.3
	OPENBSD_5_5:1.3.0.6
	OPENBSD_5_5_BASE:1.3
	OPENBSD_5_4:1.3.0.4
	OPENBSD_5_4_BASE:1.3
	OPENBSD_5_3:1.3.0.2
	OPENBSD_5_3_BASE:1.3
	OPENBSD_5_2:1.2.0.22
	OPENBSD_5_2_BASE:1.2
	OPENBSD_5_1_BASE:1.2
	OPENBSD_5_1:1.2.0.20
	OPENBSD_5_0:1.2.0.18
	OPENBSD_5_0_BASE:1.2
	OPENBSD_4_9:1.2.0.16
	OPENBSD_4_9_BASE:1.2
	OPENBSD_4_8:1.2.0.14
	OPENBSD_4_8_BASE:1.2
	OPENBSD_4_7:1.2.0.12
	OPENBSD_4_7_BASE:1.2
	OPENBSD_4_6:1.2.0.10
	OPENBSD_4_6_BASE:1.2
	OPENBSD_4_5:1.2.0.8
	OPENBSD_4_5_BASE:1.2
	OPENBSD_4_4:1.2.0.6
	OPENBSD_4_4_BASE:1.2
	OPENBSD_4_3:1.2.0.4
	OPENBSD_4_3_BASE:1.2
	OPENBSD_4_2:1.2.0.2
	OPENBSD_4_2_BASE:1.2
	OPENBSD_4_1:1.1.0.30
	OPENBSD_4_1_BASE:1.1
	OPENBSD_4_0:1.1.0.28
	OPENBSD_4_0_BASE:1.1
	OPENBSD_3_9:1.1.0.26
	OPENBSD_3_9_BASE:1.1
	OPENBSD_3_8:1.1.0.24
	OPENBSD_3_8_BASE:1.1
	OPENBSD_3_7:1.1.0.22
	OPENBSD_3_7_BASE:1.1
	OPENBSD_3_6:1.1.0.20
	OPENBSD_3_6_BASE:1.1
	OPENBSD_3_5:1.1.0.18
	OPENBSD_3_5_BASE:1.1
	OPENBSD_3_4:1.1.0.16
	OPENBSD_3_4_BASE:1.1
	OPENBSD_3_3:1.1.0.14
	OPENBSD_3_3_BASE:1.1
	OPENBSD_3_2:1.1.0.12
	OPENBSD_3_2_BASE:1.1
	OPENBSD_3_1:1.1.0.10
	OPENBSD_3_1_BASE:1.1
	OPENBSD_3_0:1.1.0.8
	OPENBSD_3_0_BASE:1.1
	OPENBSD_2_9_TRACKING_SWITCH:1.1
	OPENBSD_2_9:1.1.0.6
	OPENBSD_2_9_BASE:1.1
	OPENBSD_2_8:1.1.0.4
	OPENBSD_2_8_BASE:1.1
	OPENBSD_2_7:1.1.0.2;
locks; strict;
comment	@# @;


1.3
date	2012.08.19.22.30.37;	author ajacoutot;	state Exp;
branches;
next	1.2;

1.2
date	2007.03.20.00.35.52;	author pvalchev;	state Exp;
branches;
next	1.1;

1.1
date	2000.05.19.04.56.48;	author form;	state Exp;
branches;
next	;


desc
@@


1.3
log
@RCS id cleanup; also add OpenBSD RCS Id where missing...
@
text
@$OpenBSD: patch-lchat-pl,v 1.2 2007/03/20 00:35:52 pvalchev Exp $
--- lchat.pl.orig	Fri May 29 13:05:46 1998
+++ lchat.pl	Mon Mar 19 18:31:12 2007
@@@@ -117,7 +117,7 @@@@ sub open_port { ## public
 
 	# We may be multi-homed, start with 0, fixup once connexion is made
 	$thisaddr = "\0\0\0\0" ;
-	$thisproc = pack($sockaddr, 2, 0, $thisaddr);
+	$thisproc = pack_sockaddr_in(0, $thisaddr);
 
 	if ($server =~ /^(\d+)+\.(\d+)\.(\d+)\.(\d+)$/) {
 		$serveraddr = pack('C4', $1, $2, $3, $4);
@@@@ -128,7 +128,7 @@@@ sub open_port { ## public
 		}
 		$serveraddr = $x[4];
 	}
-	$serverproc = pack($sockaddr, 2, $port, $serveraddr);
+	$serverproc = pack_sockaddr_in($port, $serveraddr);
 	unless (socket(S, $main'pf_inet, $main'sock_stream, $main'tcp_proto)) {
 		($!) = ($!, close(S)); # close S while saving $!
 		return undef;
@@@@ -137,12 +137,12 @@@@ sub open_port { ## public
 	# The SOCKS documentation claims that this bind before the connet
 	# is unnecessary.  Not just, that, but when used with SOCKS,
 	# a connect() must not follow a bind(). -Erez Zadok.
-	unless( $using_socks ){
-		unless (bind(S, $thisproc)) {
-			($!) = ($!, close(S)); # close S while saving $!
-			return undef;
-		}
-	}
+#	unless( $using_socks ){
+#		unless (bind(S, $thisproc)) {
+#			($!) = ($!, close(S)); # close S while saving $!
+#			return undef;
+#		}
+#	}
 	unless (connect(S, $serverproc)) {
 		($!) = ($!, close(S)); # close S while saving $!
 		return undef;
@@@@ -152,7 +152,7 @@@@ sub open_port { ## public
 # multi-homed, with IP forwarding off, so fix-up.
 	local($fam,$lport);
 	($fam,$lport,$thisaddr) = unpack($sockaddr, getsockname(S));
-	$thisproc = pack($sockaddr, 2, 0, $thisaddr);
+	$thisproc = pack_sockaddr_in(0, $thisaddr);
 # end of post-connect fixup
 	select((select(S), $| = 1)[0]);
 	return 1;
@@@@ -167,7 +167,7 @@@@ sub open_newport { ## public
 
 	# We may be multi-homed, start with 0, fixup once connexion is made
 	$thisaddr = "\0\0\0\0" ;
-	$thisproc = pack($sockaddr, 2, 0, $thisaddr);
+	$thisproc = pack_sockaddr_in(0, $thisaddr);
 
 	if ($server =~ /^(\d+)+\.(\d+)\.(\d+)\.(\d+)$/) {
 		$serveraddr = pack('C4', $1, $2, $3, $4);
@@@@ -189,7 +189,7 @@@@ sub open_newport { ## public
 # multi-homed, with IP forwarding off, so fix-up.
 	local($fam,$lport);
 	($fam,$lport,$thisaddr) = unpack($sockaddr, getsockname($newsock));
-	$thisproc = pack($sockaddr, 2, 0, $thisaddr);
+	$thisproc = pack_sockaddr_in(0, $thisaddr);
 # end of post-connect fixup
 	select((select($newsock), $| = 1)[0]);
 	return 1;
@


1.2
log
@regenerate patches
@
text
@d1 1
a1 3
# $NetBSD: patch-ad,v 1.5 1999/12/28 18:15:43 itojun Exp $
# $OpenBSD: patch-lchat-pl,v 1.1 2000/05/19 04:56:48 form Exp $

@


1.1
log
@/usr/local -> PREFIX
fix network functions
remove scripts/configure
@
text
@d2 1
a2 1
# $OpenBSD$
d4 3
a6 3
--- lchat.pl.orig	Wed Jun  7 22:19:22 1995
+++ lchat.pl	Wed May 12 18:10:54 1999
@@@@ -79,7 +79,7 @@@@
d15 1
a15 1
@@@@ -90,7 +90,7 @@@@
d24 1
a24 1
@@@@ -99,12 +99,12 @@@@
d43 1
a43 1
@@@@ -114,7 +114,7 @@@@
d52 1
a52 1
@@@@ -129,7 +129,7 @@@@
d61 1
a61 1
@@@@ -151,7 +151,7 @@@@
@

