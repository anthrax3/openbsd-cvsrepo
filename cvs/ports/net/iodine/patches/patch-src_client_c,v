head	1.1;
access;
symbols
	OPENBSD_6_1:1.1.0.14
	OPENBSD_6_1_BASE:1.1
	OPENBSD_6_0:1.1.0.12
	OPENBSD_6_0_BASE:1.1
	OPENBSD_5_9:1.1.0.8
	OPENBSD_5_9_BASE:1.1
	OPENBSD_5_8:1.1.0.10
	OPENBSD_5_8_BASE:1.1
	OPENBSD_5_7:1.1.0.6
	OPENBSD_5_7_BASE:1.1
	OPENBSD_5_6:1.1.0.4
	OPENBSD_5_6_BASE:1.1
	OPENBSD_5_5:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2014.06.19.22.45.56;	author chris;	state Exp;
branches
	1.1.2.1;
next	;
commitid	KR0YITWX5VPsW0FS;

1.1.2.1
date	2014.06.19.22.58.10;	author sthen;	state Exp;
branches;
next	;
commitid	MCH9dN2XKq3JwmPa;


desc
@@


1.1
log
@Update iodine DNS tunnel to 0.7.0

ok sthen@@
@
text
@$OpenBSD$
--- src/client.c.orig	Mon Jun 16 13:28:43 2014
+++ src/client.c	Thu Jun 19 15:16:45 2014
@@@@ -121,11 +121,11 @@@@ client_init()
 	b64u = get_base64u_encoder();
 	b128 = get_base128_encoder();
 	dataenc = get_base32_encoder();
-	rand_seed = ((unsigned int) rand()) & 0xFFFF;
+	rand_seed = ((unsigned int) arc4random()) & 0xFFFF;
 	send_ping_soon = 1;	/* send ping immediately after startup */
 	conn = CONN_DNS_NULL;
 
-	chunkid = ((unsigned int) rand()) & 0xFFFF;
+	chunkid = ((unsigned int) arc4random()) & 0xFFFF;
 	chunkid_prev = 0;
 	chunkid_prev2 = 0;
 
@


1.1.2.1
log
@MFC Update iodine DNS tunnel to 0.7.0 - CVE-2014-4168 - authentication bypass

"The client could bypass the password check by continuing after getting error
from the server and guessing the network parameters. The server would still
accept the rest of the setup and also network traffic."
@
text
@d1 1
a1 1
$OpenBSD: patch-src_client_c,v 1.1 2014/06/19 22:45:56 chris Exp $
@

