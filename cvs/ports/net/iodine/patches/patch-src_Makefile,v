head	1.3;
access;
symbols
	OPENBSD_6_0:1.3.0.10
	OPENBSD_6_0_BASE:1.3
	OPENBSD_5_9:1.3.0.6
	OPENBSD_5_9_BASE:1.3
	OPENBSD_5_8:1.3.0.8
	OPENBSD_5_8_BASE:1.3
	OPENBSD_5_7:1.3.0.4
	OPENBSD_5_7_BASE:1.3
	OPENBSD_5_6:1.3.0.2
	OPENBSD_5_6_BASE:1.3
	OPENBSD_5_5:1.2.0.20
	OPENBSD_5_5_BASE:1.2
	OPENBSD_5_4:1.2.0.18
	OPENBSD_5_4_BASE:1.2
	OPENBSD_5_3:1.2.0.16
	OPENBSD_5_3_BASE:1.2
	OPENBSD_5_2:1.2.0.14
	OPENBSD_5_2_BASE:1.2
	OPENBSD_5_1_BASE:1.2
	OPENBSD_5_1:1.2.0.12
	OPENBSD_5_0:1.2.0.10
	OPENBSD_5_0_BASE:1.2
	OPENBSD_4_9:1.2.0.8
	OPENBSD_4_9_BASE:1.2
	OPENBSD_4_8:1.2.0.6
	OPENBSD_4_8_BASE:1.2
	OPENBSD_4_7:1.2.0.4
	OPENBSD_4_7_BASE:1.2
	OPENBSD_4_6:1.2.0.2
	OPENBSD_4_6_BASE:1.2
	OPENBSD_4_5:1.1.0.6
	OPENBSD_4_5_BASE:1.1
	OPENBSD_4_4:1.1.0.4
	OPENBSD_4_4_BASE:1.1
	OPENBSD_4_3:1.1.0.2
	OPENBSD_4_3_BASE:1.1;
locks; strict;
comment	@# @;


1.3
date	2014.06.19.22.45.56;	author chris;	state Exp;
branches;
next	1.2;
commitid	KR0YITWX5VPsW0FS;

1.2
date	2009.03.30.09.17.45;	author sthen;	state Exp;
branches
	1.2.20.1;
next	1.1;

1.1
date	2008.02.07.12.42.11;	author sthen;	state Exp;
branches;
next	;

1.2.20.1
date	2014.06.19.22.58.10;	author sthen;	state Exp;
branches;
next	;
commitid	MCH9dN2XKq3JwmPa;


desc
@@


1.3
log
@Update iodine DNS tunnel to 0.7.0

ok sthen@@
@
text
@$OpenBSD$
--- src/Makefile.orig	Mon Jun 16 13:28:43 2014
+++ src/Makefile	Thu Jun 19 15:16:45 2014
@@@@ -9,7 +9,8 @@@@ ARCH = `uname -m`
 
 LIBPATH = -L.
 LDFLAGS +=  -lz `sh osflags $(TARGETOS) link` $(LIBPATH)
-CFLAGS += -std=c99 -c -g -Wall -D$(OS) -pedantic `sh osflags $(TARGETOS) cflags`
+CFLAGS ?= -g
+CFLAGS += -std=c99 -c -Wall -D$(OS) -pedantic `sh osflags $(TARGETOS) cflags`
 
 all: stateos $(CLIENT) $(SERVER)
 
@@@@ -17,18 +18,15 @@@@ stateos:
 	@@echo OS is $(OS), arch is $(ARCH)
 
 $(CLIENT): $(COMMONOBJS) $(CLIENTOBJS)
-	@@echo LD $@@
 	@@mkdir -p ../bin
-	@@$(CC) $(COMMONOBJS) $(CLIENTOBJS) -o $(CLIENT) $(LDFLAGS)
+	$(CC) $(COMMONOBJS) $(CLIENTOBJS) -o $(CLIENT) $(LDFLAGS)
 
 $(SERVER): $(COMMONOBJS) $(SERVEROBJS)
-	@@echo LD $@@
 	@@mkdir -p ../bin
-	@@$(CC) $(COMMONOBJS) $(SERVEROBJS) -o $(SERVER) $(LDFLAGS)
+	$(CC) $(COMMONOBJS) $(SERVEROBJS) -o $(SERVER) $(LDFLAGS)
 
 .c.o:
-	@@echo CC $<
-	@@$(CC) $(CFLAGS) $< -o $@@
+	$(CC) $(CFLAGS) $< -o $@@
 
 base64u.o client.o iodined.o: base64u.h
 base64u.c: base64.c
@


1.2
log
@- update to 0.5.1, from Simon Kuhnle.
- don't hide command lines in build output
- honour CC in the environment not just mk.conf
@
text
@d1 4
a4 10
$OpenBSD: patch-src_Makefile,v 1.1 2008/02/07 12:42:11 sthen Exp $
--- src/Makefile.orig	Sat Mar 21 13:07:49 2009
+++ src/Makefile	Mon Mar 30 10:09:57 2009
@@@@ -1,4 +1,4 @@@@
-CC = gcc
+CC ?= gcc
 COMMONOBJS = tun.o dns.o read.o encoding.o login.o base32.o base64.o md5.o common.o
 CLIENTOBJS = iodine.o
 CLIENT = ../bin/iodine
@@@@ -10,7 +10,8 @@@@ ARCH = `uname -m`
d7 2
a8 2
 LDFLAGS =  -lz `sh osflags $(TARGETOS) link` $(LIBPATH)
-CFLAGS = -c -g -Wall -D$(OS) -pedantic `sh osflags $(TARGETOS) cflags`
d10 1
a10 1
+CFLAGS += -c -Wall -D$(OS) -pedantic `sh osflags $(TARGETOS) cflags`
d14 1
a14 1
@@@@ -18,18 +19,15 @@@@ stateos:
d29 1
a29 1
 .c.o: 
d34 2
a35 2
 clean:
 	@@echo "Cleaning src/"
@


1.2.20.1
log
@MFC Update iodine DNS tunnel to 0.7.0 - CVE-2014-4168 - authentication bypass

"The client could bypass the password check by continuing after getting error
from the server and guessing the network parameters. The server would still
accept the rest of the setup and also network traffic."
@
text
@d1 10
a10 4
$OpenBSD: patch-src_Makefile,v 1.3 2014/06/19 22:45:56 chris Exp $
--- src/Makefile.orig	Mon Jun 16 13:28:43 2014
+++ src/Makefile	Thu Jun 19 15:16:45 2014
@@@@ -9,7 +9,8 @@@@ ARCH = `uname -m`
d13 2
a14 2
 LDFLAGS +=  -lz `sh osflags $(TARGETOS) link` $(LIBPATH)
-CFLAGS += -std=c99 -c -g -Wall -D$(OS) -pedantic `sh osflags $(TARGETOS) cflags`
d16 1
a16 1
+CFLAGS += -std=c99 -c -Wall -D$(OS) -pedantic `sh osflags $(TARGETOS) cflags`
d20 1
a20 1
@@@@ -17,18 +18,15 @@@@ stateos:
d35 1
a35 1
 .c.o:
d40 2
a41 2
 base64u.o client.o iodined.o: base64u.h
 base64u.c: base64.c
@


1.1
log
@honour CC and CFLAGS, install manpages in a better place.
ok bernd
@
text
@d1 3
a3 3
$OpenBSD$
--- src/Makefile.orig	Fri Nov 30 22:11:30 2007
+++ src/Makefile	Thu Feb  7 11:48:20 2008
d10 1
a10 2
@@@@ -9,7 +9,8 @@@@ OS = `uname | tr "a-z" "A-Z"`
 ARCH = `uname -m`
d12 3
a14 2
 LDFLAGS =  -lz
-CFLAGS = -c -g -Wall -D$(OS) -pedantic
d16 1
a16 1
+CFLAGS += -c -Wall -D$(OS) -pedantic
d18 1
a18 1
 all: stateos $(CLIENT) $(SERVER) $(TESTSUITE) 
d20 22
@

