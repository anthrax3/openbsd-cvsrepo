head	1.61;
access;
symbols
	OPENBSD_6_1:1.58.0.2
	OPENBSD_6_1_BASE:1.58
	OPENBSD_6_0:1.52.0.2
	OPENBSD_6_0_BASE:1.52
	OPENBSD_5_9:1.51.0.2
	OPENBSD_5_9_BASE:1.51
	OPENBSD_5_8:1.50.0.4
	OPENBSD_5_8_BASE:1.50
	OPENBSD_5_7:1.47.0.2
	OPENBSD_5_7_BASE:1.47
	OPENBSD_5_6:1.40.0.2
	OPENBSD_5_6_BASE:1.40
	OPENBSD_5_5:1.37.0.2
	OPENBSD_5_5_BASE:1.37
	OPENBSD_5_4:1.32.0.2
	OPENBSD_5_4_BASE:1.32
	OPENBSD_5_3:1.29.0.2
	OPENBSD_5_3_BASE:1.29
	OPENBSD_5_2:1.25.0.2
	OPENBSD_5_2_BASE:1.25
	OPENBSD_5_1_BASE:1.21
	OPENBSD_5_1:1.21.0.2
	OPENBSD_5_0:1.20.0.2
	OPENBSD_5_0_BASE:1.20
	OPENBSD_4_9:1.18.0.2
	OPENBSD_4_9_BASE:1.18
	OPENBSD_4_8:1.7.0.2
	OPENBSD_4_8_BASE:1.7
	OPENBSD_4_7:1.5.0.2
	OPENBSD_4_7_BASE:1.5
	sthen_20091117:1.1.1.1
	sthen:1.1.1;
locks; strict;
comment	@# @;


1.61
date	2017.05.27.13.55.58;	author ajacoutot;	state Exp;
branches;
next	1.60;
commitid	SykG6k6P85X3Gc2i;

1.60
date	2017.05.16.08.48.56;	author ajacoutot;	state Exp;
branches;
next	1.59;
commitid	mlroNQAo9dQIzkwn;

1.59
date	2017.05.16.08.47.22;	author ajacoutot;	state Exp;
branches;
next	1.58;
commitid	ygXKSYPTaPxh1NUa;

1.58
date	2017.03.06.07.33.29;	author kirby;	state Exp;
branches;
next	1.57;
commitid	eLVUCjeBrDQWrnNL;

1.57
date	2017.01.20.09.17.59;	author kirby;	state Exp;
branches;
next	1.56;
commitid	xH7xvp6We5d4vEoJ;

1.56
date	2017.01.06.11.57.19;	author kirby;	state Exp;
branches;
next	1.55;
commitid	MnKLAbsNfq8wdqPT;

1.55
date	2016.12.07.08.38.53;	author kirby;	state Exp;
branches;
next	1.54;
commitid	ftZ0tKmlLbkNdoaS;

1.54
date	2016.11.04.08.08.07;	author kirby;	state Exp;
branches;
next	1.53;
commitid	e9dRUclrx0aVX8uI;

1.53
date	2016.11.03.07.45.29;	author kirby;	state Exp;
branches;
next	1.52;
commitid	N3MsP0AqHBAvq7Oa;

1.52
date	2016.03.12.12.13.35;	author sthen;	state Exp;
branches;
next	1.51;
commitid	OAPx9NEDpk7ir8Z1;

1.51
date	2015.11.02.11.56.55;	author espie;	state Exp;
branches;
next	1.50;
commitid	ox8NBCUwS6UB4UwE;

1.50
date	2015.07.16.01.25.48;	author ajacoutot;	state Exp;
branches;
next	1.49;
commitid	su2ACfjmbAFqUtuk;

1.49
date	2015.07.15.19.40.58;	author ajacoutot;	state Exp;
branches;
next	1.48;
commitid	nBBrLa8BoUweUEfw;

1.48
date	2015.07.06.12.13.54;	author kirby;	state Exp;
branches;
next	1.47;
commitid	CrzCiUuO41lPfn74;

1.47
date	2014.11.28.08.39.41;	author kirby;	state Exp;
branches;
next	1.46;
commitid	dI2myyaXr1nsTSWb;

1.46
date	2014.11.08.20.08.20;	author kirby;	state Exp;
branches;
next	1.45;
commitid	8IngpABs0Y3LGxHH;

1.45
date	2014.10.30.08.48.14;	author kirby;	state Exp;
branches;
next	1.44;
commitid	5Znei19dH3c4HkmY;

1.44
date	2014.10.23.13.24.26;	author kirby;	state Exp;
branches;
next	1.43;
commitid	0dSuvtm1Nwx5sCRO;

1.43
date	2014.10.22.08.01.52;	author kirby;	state Exp;
branches;
next	1.42;
commitid	paJaqhbTRixIsHJR;

1.42
date	2014.09.27.17.04.02;	author jeremy;	state Exp;
branches;
next	1.41;
commitid	ztJH59w3NdKQrdb9;

1.41
date	2014.08.12.13.58.41;	author kirby;	state Exp;
branches;
next	1.40;
commitid	GvAXdWihWOwMiH0k;

1.40
date	2014.07.22.10.55.40;	author ajacoutot;	state Exp;
branches;
next	1.39;
commitid	3LzguPEQl5LkjlcD;

1.39
date	2014.05.30.10.28.17;	author kirby;	state Exp;
branches;
next	1.38;

1.38
date	2014.03.25.08.42.25;	author kirby;	state Exp;
branches;
next	1.37;

1.37
date	2014.01.15.08.24.25;	author sthen;	state Exp;
branches;
next	1.36;

1.36
date	2013.12.18.14.17.32;	author kirby;	state Exp;
branches;
next	1.35;

1.35
date	2013.12.03.10.21.01;	author kirby;	state Exp;
branches;
next	1.34;

1.34
date	2013.12.02.13.37.47;	author kirby;	state Exp;
branches;
next	1.33;

1.33
date	2013.11.05.17.49.33;	author sthen;	state Exp;
branches;
next	1.32;

1.32
date	2013.06.03.19.45.31;	author kirby;	state Exp;
branches
	1.32.2.1;
next	1.31;

1.31
date	2013.03.22.15.00.29;	author kirby;	state Exp;
branches;
next	1.30;

1.30
date	2013.03.11.11.35.49;	author espie;	state Exp;
branches;
next	1.29;

1.29
date	2013.01.18.12.23.24;	author gonzalo;	state Exp;
branches;
next	1.28;

1.28
date	2013.01.08.11.14.02;	author kirby;	state Exp;
branches;
next	1.27;

1.27
date	2012.10.12.09.46.46;	author kirby;	state Exp;
branches;
next	1.26;

1.26
date	2012.09.03.18.00.32;	author jeremy;	state Exp;
branches;
next	1.25;

1.25
date	2012.07.11.03.46.42;	author william;	state Exp;
branches;
next	1.24;

1.24
date	2012.05.08.09.25.20;	author sthen;	state Exp;
branches;
next	1.23;

1.23
date	2012.03.15.13.55.45;	author sthen;	state Exp;
branches;
next	1.22;

1.22
date	2012.02.27.15.44.58;	author sthen;	state Exp;
branches;
next	1.21;

1.21
date	2012.01.26.08.03.57;	author ajacoutot;	state Exp;
branches;
next	1.20;

1.20
date	2011.05.11.12.03.19;	author jasper;	state Exp;
branches;
next	1.19;

1.19
date	2011.04.14.15.55.19;	author jasper;	state Exp;
branches;
next	1.18;

1.18
date	2010.12.30.08.19.31;	author jasper;	state Exp;
branches;
next	1.17;

1.17
date	2010.12.27.14.50.22;	author ajacoutot;	state Exp;
branches;
next	1.16;

1.16
date	2010.12.24.10.40.05;	author ajacoutot;	state Exp;
branches;
next	1.15;

1.15
date	2010.11.19.22.31.34;	author espie;	state Exp;
branches;
next	1.14;

1.14
date	2010.10.29.12.54.43;	author ajacoutot;	state Exp;
branches;
next	1.13;

1.13
date	2010.10.28.20.59.05;	author jasper;	state Exp;
branches;
next	1.12;

1.12
date	2010.10.28.11.01.47;	author jasper;	state Exp;
branches;
next	1.11;

1.11
date	2010.10.23.15.52.22;	author sthen;	state Exp;
branches;
next	1.10;

1.10
date	2010.10.18.18.36.50;	author espie;	state Exp;
branches;
next	1.9;

1.9
date	2010.10.07.11.01.06;	author jasper;	state Exp;
branches;
next	1.8;

1.8
date	2010.08.30.21.14.35;	author sthen;	state Exp;
branches;
next	1.7;

1.7
date	2010.07.12.22.07.39;	author sthen;	state Exp;
branches;
next	1.6;

1.6
date	2010.06.24.16.20.49;	author sthen;	state Exp;
branches;
next	1.5;

1.5
date	2010.02.25.17.07.17;	author sthen;	state Exp;
branches;
next	1.4;

1.4
date	2010.01.21.20.59.30;	author sthen;	state Exp;
branches;
next	1.3;

1.3
date	2009.11.17.11.47.06;	author sthen;	state Exp;
branches;
next	1.2;

1.2
date	2009.11.17.11.20.47;	author sthen;	state Exp;
branches;
next	1.1;

1.1
date	2009.11.17.11.11.20;	author sthen;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2009.11.17.11.11.20;	author sthen;	state Exp;
branches;
next	;

1.32.2.1
date	2013.12.05.12.57.40;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.61
log
@I forgot the bump commit...
@
text
@# $OpenBSD: Makefile,v 1.60 2017/05/16 08:48:56 ajacoutot Exp $

PORTROACH = 	limitw:1,even

COMMENT-main =	flexible network host monitoring, client
COMMENT-server =flexible network host monitoring, server

V =		2.0.33
DISTNAME =	munin-$V
PKGNAME-main =	munin-node-$V
PKGNAME-server =munin-server-$V
CATEGORIES =	net

REVISION-main =	2
REVISION-server =	2

HOMEPAGE =	http://munin-monitoring.org/
MASTER_SITES =	http://downloads.munin-monitoring.org/munin/stable/$V/

# Mostly GPLv2.
# DejaVuSans.ttf and DejaVuSansMono.ttf has a non-restrictive license.
PERMIT_PACKAGE_CDROM =	Yes

MAINTAINER =		Kirill Bychkov <kirby@@openbsd.org>

MULTI_PACKAGES =	-main -server

# Used for file locations and MODPY_BIN, RUBY, MODRUBY_ADJ_FILES.
# Only very minor optional munin plugins use these languages so they
# aren't forced as dependencies (same for bash).
MODULES =		lang/python lang/ruby
# No need for MODx_RUNDEP as we already override RUN_DEPENDS-{main,server}
MODPY_BUILDDEP =	No
MODRUBY_BUILDDEP =	No

# called from the build script; doesn't use standard CONFIGURE_STYLE=modbuild
BUILD_DEPENDS +=	devel/p5-Module-Build

RUN_DEPENDS-main =	logtail-*|logsentry-*:sysutils/logtail \
			devel/p5-Log-Log4perl \
			devel/p5-Net-Server \
			net/p5-Net-CIDR
RUN_DEPENDS-server +=	converters/p5-DateManip \
			devel/p5-File-Copy-Recursive \
			net/p5-IO-Socket-INET6 \
			net/rrdtool \
			www/fcgi \
			www/p5-HTML-Template \
			www/p5-URI \
			net/munin,-main

USE_GMAKE =		Yes
ALL_TARGET =		default build-doc build-man
WRKDIST =		${WRKDIR}/${DISTNAME:S/_/-/}
PKG_ARCH =		*

CONFIGURE_STYLE =	none # hack, otherwise python.port.mk overrides target

MAKE_ENV +=		CONFDIR=${SYSCONFDIR}/munin \
			OSTYPE=openbsd \
			PREFIX=${PREFIX} \
			PYTHON=${MODPY_BIN}
MAKE_FLAGS +=		BASH=${LOCALBASE}/bin/bash \
			PLUGINUSER=_munin-plugin

FAKE_FLAGS +=		HTMLDIR=${WRKINST}/${PREFIX}/share/examples/munin/www \
			CGIDIR=${WRKINST}/${PREFIX}/share/examples/munin/www \
			DOCDIR=${WRKINST}/${PREFIX}/share/doc/munin \
			CONFDIR=${WRKINST}/${PREFIX}/share/examples/munin

MUNIN_PLUGINS =		bgpd if_pps_ intr pf_changes pf_searches pf_states \
			sensors_ vmstat

.for i in ${MUNIN_PLUGINS}
SUBST_LIST += ${FILESDIR}/$i ${WRKSRC}/plugins/node.d.openbsd/$i.in
.endfor

post-extract:
	cp -Rp ${WRKSRC}/plugins/node.d.freebsd ${WRKSRC}/plugins/node.d.openbsd
	cp -p ${WRKSRC}/plugins/node.d.netbsd/uptime.in ${WRKSRC}/plugins/node.d.openbsd
	cp -p ${WRKSRC}/plugins/node.d.netbsd/memory.in ${WRKSRC}/plugins/node.d.openbsd
	${SUBST_CMD} -m 444 -c ${SUBST_LIST}
	chmod -R +x ${WRKSRC}/plugins/node.d.openbsd
	rm ${WRKSRC}/plugins/node.d.openbsd/iostat.in # not yet ported
	rm ${WRKSRC}/plugins/node.d.openbsd/swap.in # we have no in/out fields

# Fixup hardcoded paths in plugins to use TRUEPREFIX/LOCALBASE as appropriate,
# there are far too many to handle this via patches/SUBST_CMD, and this method
# plays nicer with update-patches.
pre-configure:
	cd ${WRKSRC}/node/sbin; \
	${SUBST_CMD} munin-node munin-node-configure munin-run; \
	rm munin-{node,node-configure,run}.{beforesubst,orig}; \
	perl -pi -e 's,/etc/munin/plugins,${SYSCONFDIR}/munin/plugins,g;' \
	    -e 's,/etc/munin/node.d,${SYSCONFDIR}/munin/plugins,g;' \
	    -e 's,/usr/local/libexec/munin,${TRUEPREFIX}/libexec/munin,g;' \
	    -e 's,/usr/local,${LOCALBASE},g;' \
	    -e 's,/usr/share/munin/node/plugins-auto,${TRUEPREFIX}/libexec/munin/plugins,g;' \
	    ${WRKSRC}/plugins/node.d/* ${WRKSRC}/plugins/node.d.openbsd/*

post-install:
	${MODRUBY_RUBY_ADJ} ${PREFIX}/libexec/munin/plugins/tomcat_
	${INSTALL_DATA} ${FILESDIR}/openbsd-packages \
	    ${PREFIX}/share/examples/munin/plugin-conf.d
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/munin/
	${INSTALL_DATA} ${WRKSRC}/UPGRADING ${PREFIX}/share/doc/munin/
	@@touch ${PREFIX}/share/examples/munin/munin-cgi-graph.log
	@@touch ${PREFIX}/share/examples/munin/munin-cgi-html.log
	@@rm ${PREFIX}/man/man8/munin-graph.8 # no data in it

.include <bsd.port.mk>
@


1.60
log
@Same for share/examples/munin/ which I missed in previous.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59 2017/05/16 08:47:22 ajacoutot Exp $
d14 2
a15 2
REVISION-main =	1
REVISION-server =	1
@


1.59
log
@/usr/local/libexec/munin/ should be owned by -main, not -server so that it
is properly removed at pkg_delete time.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2017/03/06 07:33:29 kirby Exp $
d14 2
a15 2
REVISION-main =	0
REVISION-server =	0
@


1.58
log
@Bugfix update to munin-2.0.33
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.57 2017/01/20 09:17:59 kirby Exp $
d13 3
@


1.57
log
@bug fix update to munin-2.0.30
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2017/01/06 11:57:19 kirby Exp $
d8 1
a8 1
V =		2.0.30
@


1.56
log
@Bugfix update to munin-2.0.29
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55 2016/12/07 08:38:53 kirby Exp $
d8 1
a8 1
V =		2.0.29
@


1.55
log
@bugfix update to munin-2.0.28
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.54 2016/11/04 08:08:07 kirby Exp $
d8 1
a8 1
V =		2.0.28
@


1.54
log
@bugfix update to munin-2.0.27
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2016/11/03 07:45:29 kirby Exp $
d8 1
a8 1
V =		2.0.27
@


1.53
log
@bugfix update to munin-2.0.26
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.52 2016/03/12 12:13:35 sthen Exp $
d8 1
a8 1
V =		2.0.26
@


1.52
log
@BDEP on p5-Module-Build, it's used in the build script.
Reminded by nigel@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 2015/11/02 11:56:55 espie Exp $
d8 1
a8 1
V =		2.0.25
a11 2
REVISION-main=	1
REVISION-server=1
d15 1
a15 1
MASTER_SITES =	${MASTER_SITE_SOURCEFORGE:=munin/}
@


1.51
log
@a few minor pkg_subst fixes, for the coming patch (disallow -c without -m
outside of WRKDIR)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2015/07/16 01:25:48 ajacoutot Exp $
d34 3
@


1.50
log
@No need to sample /var/run/munin/
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2015/07/15 19:40:58 ajacoutot Exp $
d78 1
a78 1
	${SUBST_CMD} -c ${SUBST_LIST}
@


1.49
log
@Fix pexp.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2015/07/06 12:13:54 kirby Exp $
d12 1
a12 1
REVISION-main=	0
@


1.48
log
@`sudo` is not in base anymore. show how to use `su` in README
ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2014/11/28 08:39:41 kirby Exp $
d12 2
a13 1
REVISION-server=0
@


1.47
log
@bugfix update to munin-2.0.25
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2014/11/08 20:08:20 kirby Exp $
d12 1
@


1.46
log
@fix pf_changes plugin autoconfigure
patch from Dimitri Sokolyuk, thanks!
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2014/10/30 08:48:14 kirby Exp $
d8 1
a8 1
V =		2.0.24
a10 1
REVISION-main = 0
@


1.45
log
@bugfix update to munin-2.0.24
while here tweak sensors_ plugin to show human readable values for fans.
sensors_ patch from jasper@@, thanks!
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2014/10/23 13:24:26 kirby Exp $
d11 1
@


1.44
log
@bugfix update to munin-2.0.23
upstream didn't update news on homepage, so it was found with portroach
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2014/10/22 08:01:52 kirby Exp $
d8 1
a8 1
V =		2.0.23
@


1.43
log
@add PORTROACH annotation to restrict to stable 2.0.X branch.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2014/09/27 17:04:02 jeremy Exp $
d8 1
a8 1
V =		2.0.21
a12 3

REVISION-main = 	1
REVISION-server=	0
@


1.42
log
@Don't set MODRUBY_REV explicitly, use default ruby version.

OK sthen@@
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.41 2014/08/12 13:58:41 kirby Exp $
@


1.41
log
@switch sensors_ plugin graph category from system to sensors
request and ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2014/07/22 10:55:40 ajacoutot Exp $
d12 1
a12 1
REVISION-main = 	0
a32 1
MODRUBY_REV =		1.9
@


1.40
log
@Tweak documentation according to recent rc changes.

ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2014/05/30 10:28:17 kirby Exp $
d12 1
@


1.39
log
@ - bugfix update to munin-2.0.21
 - move async and asyncd to -main package
 - add asyncd rc script
 - move @@sample /var/db/munin/ to PLIST-main (requested by sthen@@)

with input from ajacoutot@@
OK sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2014/03/25 08:42:25 kirby Exp $
d11 2
@


1.38
log
@update munin to 2.0.19 and add some improvements:
 - unbreak munin-check script and make it useful
 - move a note of newsyslog.conf fragment for munin-node.log to README-main
 - add missing { in README-server
 - instructions about reducing disk I/O with rrdcached.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2014/01/15 08:24:25 sthen Exp $
d6 1
a6 1
V =		2.0.19
@


1.37
log
@tell people to trim munin's logs, with a newsyslog.conf fragment.
found the hard way by me
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2013/12/18 14:17:32 kirby Exp $
d6 1
a6 2
V =		2.0.18
REVISION =	0
d56 2
a57 1
MAKE_FLAGS +=		BASH=${LOCALBASE}/bin/bash
@


1.36
log
@unbreak some manuals and scripts by using perl instead of gnused for
substitutuion.
OK sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2013/12/03 10:21:01 kirby Exp $
d7 1
a9 1
REVISION-main = 0
@


1.35
log
@security and bugfix update to munin-2.0.18
* Avoid a node DoS on bad plugin (CVE-2013-6359)
* Avoid an OOM in HTML generation on bad multigraph data (CVE-2013-6048)
OK sthen@@ with the reminder to fix substitue-confvar-inline target
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2013/12/02 13:37:47 kirby Exp $
d9 1
@


1.34
log
@Bugfix update to munin-2.0.17
ok sthen
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2013/11/05 17:49:33 sthen Exp $
d6 1
a6 1
V =		2.0.17
@


1.33
log
@handle rrdtool update
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2013/06/03 19:45:31 kirby Exp $
d6 1
a6 2
V =		2.0.14
REVISION-server = 0
@


1.32
log
@Update to 2.0.14:
 - remove swap plugin as we don't have swapin/swapout anymore;
 - regen patches while here (some hints from rpe@@);
 - fix typo in README (from rpe@@).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2013/03/22 15:00:29 kirby Exp $
d7 1
d40 1
a40 1
			net/rrdtool,-perl \
@


1.32.2.1
log
@Update munin to 2.0.18 which contains various bugfixes as well as fixes for
CVE-2013-6048/CVE-2013-6359

ok kirby@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2013/06/03 19:45:31 kirby Exp $
d6 1
a6 1
V =		2.0.18
@


1.31
log
@ - bugfix update to 2.0.21
 - move MESSAGE-* to README-*
 - enable memory plugin from NetBSD
 - disable FreeBSD's iostat plugin

With input from rpe@@ and tweaks from sthen@@. Thanks!
OK sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2013/03/11 11:35:49 espie Exp $
d6 1
a6 1
V =		2.0.12
d77 1
@


1.30
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2013/01/18 12:23:24 gonzalo Exp $
d6 1
a6 1
V =		2.0.10
d73 1
d76 1
a76 1
	rm ${WRKSRC}/plugins/node.d.openbsd/memory.in # not yet ported
@


1.29
log
@Update for munin to 2.0.10 with bugfix and installs perl-related manuals to
man3p category from kirby@@ (maintainer)

ok kirby@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2013/01/08 11:14:02 kirby Exp $
a17 3
PERMIT_PACKAGE_FTP =	Yes
PERMIT_DISTFILES_CDROM =Yes
PERMIT_DISTFILES_FTP =	Yes
@


1.28
log
@- update to 2.0.9
  http://munin-monitoring.org/browser/munin/ChangeLog?rev=2.0.9
- take maintainership (suggested by sthen@@, previous maintainer)
- fix font license notice
- install netbsd uptime plugin

OK sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2012/10/12 09:46:46 kirby Exp $
d6 1
a6 1
V =		2.0.9
@


1.27
log
@Major update to munin-2.0.7
Full changelog is here:
https://github.com/munin-monitoring/munin/blob/2.0.7/ChangeLog

Lots of input and help from sthen@@ (maintainer)
ok sthen@@

P.S. Your config may need some manual interference.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2012/09/03 18:00:32 jeremy Exp $
d6 1
a6 1
V =		2.0.7
d15 2
a16 2
# Mostly GPLv2. VeraMono.ttf has a non-restrictive license (copyright notice
# embedded in the font or xenocara/font/bitstream-vera-ttf/COPYRIGHT.TXT).
d22 1
a22 1
MAINTAINER =		Stuart Henderson <sthen@@openbsd.org>
d75 1
a78 1
	rm ${WRKSRC}/plugins/node.d.openbsd/uptime.in # OpenBSD incompatible
@


1.26
log
@Make the _tomcat script use ruby19 instead of ruby18.  Since ruby isn't
an actual dependency, users of this script need to manually upgrade to
ruby 1.9.

While here, remove now incorrect comment.

OK sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2012/07/11 03:46:42 william Exp $
d6 1
a6 1
V =		1.4.7
a9 1
REVISION-main =	1
d39 5
a43 1
RUN_DEPENDS-server +=	net/rrdtool,-perl \
d45 1
d78 1
d100 3
@


1.25
log
@Add dependency on logtail and enable the amavis, courier, mailscanner,
and perdition plugins.  The dependency can be satisfied by either the
logtail or logsentry ports (thanks to sthen for realizing this!)

ok sthen
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2012/05/08 09:25:20 sthen Exp $
d10 1
a10 1
REVISION-main =	0
d33 2
a34 1
MODRUBY_BUILDDEP =	No # not supported yet, but won't need a bump when it is
@


1.24
log
@add a comment to munin's Makefile explaining how+why /usr/local
subst'ing is done the way it is.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2012/03/15 13:55:45 sthen Exp $
d10 1
d35 2
a36 1
RUN_DEPENDS-main =	devel/p5-Log-Log4perl \
a91 5
# Remove some plugins which require logtail
	rm ${PREFIX}/libexec/munin/plugins/amavis \
	    ${PREFIX}/libexec/munin/plugins/courier_ \
	    ${PREFIX}/libexec/munin/plugins/mailscanner \
	    ${PREFIX}/libexec/munin/plugins/perdition
@


1.23
log
@update to munin 1.4.7, from "Gonzalo L. R."
- also fix MODRUBY_RUBY_ADJ invocation for tomcat_ plugin
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2012/02/27 15:44:58 sthen Exp $
d72 3
@


1.22
log
@update to munin 1.4.6, from Kirill Bychkov
- many fixes and improvements
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2012/01/26 08:03:57 ajacoutot Exp $
d6 1
a6 1
V =		1.4.6
d81 1
a81 2
	    ${WRKSRC}/plugins/node.d/* ${WRKSRC}/plugins/node.d.openbsd/*; \
	${MODRUBY_RUBY_ADJ} plugins/node.d/tomcat_.in
d84 1
@


1.21
log
@Put these users in the daemon class to be consistent with all the other
ones in ports.

discussed with and ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2011/05/11 12:03:19 jasper Exp $
d6 1
a6 1
V =		1.4.5
a9 2
REVISION-main = 7
REVISION-server = 2
@


1.20
log
@Sanitize some @@unexec/@@extraunexec calls to rm: move them up in the
PLIST and delete everything under the @@sample'd directory instead of the
directory itself to prevent a warning from pkg_delete(1) trying to
remove a non existing directory and to help preventing left-over files
and directories.

ok aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2011/04/14 15:55:19 jasper Exp $
d10 1
a10 1
REVISION-main = 6
@


1.19
log
@don't use ``rm -f'' for remove unneeded files.
this will remember us, when not needed anymore this treatment.

from gleydson soares
ok aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2010/12/30 08:19:31 jasper Exp $
d10 2
a11 2
REVISION-main = 5
REVISION-server = 1
@


1.18
log
@- add missing dependency on p5-Log-Log4perl

ok sthen@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2010/12/27 14:50:22 ajacoutot Exp $
d77 1
a77 1
	rm -f munin-{node,node-configure,run}.{beforesubst,orig}; \
@


1.17
log
@Simplify after recent rc.subr change.
The framework is now stable and we will start documenting it (at last).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2010/12/24 10:40:05 ajacoutot Exp $
d10 2
a11 2
REVISION-main = 4
REVISION-server = 0
d36 2
a37 1
RUN_DEPENDS-main =	devel/p5-Net-Server \
@


1.16
log
@Cope with recent rc.subr changes.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2010/11/19 22:31:34 espie Exp $
d10 1
a10 1
REVISION-main = 3
@


1.15
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2010/10/29 12:54:43 ajacoutot Exp $
d10 2
a11 1
REVISION-main = 2
@


1.14
log
@Add RCS IDs to rc scripts.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2010/10/28 20:59:05 jasper Exp $
d35 5
a39 5
RUN_DEPENDS-main =	::devel/p5-Net-Server \
			::net/p5-Net-CIDR
RUN_DEPENDS-server +=	:p5-RRD-*:net/rrdtool,-perl \
			::www/p5-HTML-Template \
			:munin-node-*:net/munin,-main
@


1.13
log
@After discussion with robert and ingo, we are renaming the rc scripts from
dash to underscore so that we are consitent with the foo_bar_flags
variable.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2010/10/28 11:01:47 jasper Exp $
d10 1
a10 1
REVISION-main = 1
@


1.12
log
@- add the munin-node rc script

ok sthen@@ (MAINTAINER) robert@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2010/10/23 15:52:22 sthen Exp $
d10 1
a10 1
REVISION-main = 0
@


1.11
log
@update Munin to 1.45, joint work with & ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2010/10/18 18:36:50 espie Exp $
d10 1
@


1.10
log
@USE_GROFF=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2010/10/07 11:01:06 jasper Exp $
d6 2
a7 3
V =		1.2.6
DISTNAME =	munin_$V
REVISION-main =	5
d12 1
a12 1
HOMEPAGE =	http://munin.projects.linpro.no/
d26 10
a35 1
RUN_DEPENDS-main =	::devel/p5-Net-Server
a39 3
BUILD_DEPENDS =		::print/htmldoc \
			::converters/html2text

a40 1
USE_GROFF =	Yes
a44 3
# only used for MODPY_BIN
MODULES =		lang/python
MODPY_RUNDEP =		No
d51 1
a60 2
post-extract:
	cp -Rp ${WRKSRC}/node/node.d.freebsd ${WRKSRC}/node/node.d.openbsd
d62 1
a62 2
	${SUBST_CMD} -c \
	    ${FILESDIR}/$i ${WRKSRC}/node/node.d.openbsd/$i.in
d64 6
a69 2
	chmod -R +x ${WRKSRC}/node/node.d.openbsd
	rm ${WRKSRC}/node/node.d.openbsd/memory.in # not yet ported
d72 3
a74 1
	cd ${WRKSRC}/node; ${SUBST_CMD} munin-node.in munin-node-configure.in
d77 2
a78 1
	    -e 's,/usr/local/libexec/munin/plugins,${TRUEPREFIX}/libexec/munin/plugins,g;' \
d80 2
a81 1
	    ${WRKSRC}/node/node.d/* ${WRKSRC}/node/node.d.openbsd/*
d86 1
a86 1
# remove some plugins which require logtail
d91 2
@


1.9
log
@- add support for reading humidity sensors

ok sthen@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2010/08/30 21:14:35 sthen Exp $
d36 1
@


1.8
log
@bumps for python
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2010/07/12 22:07:39 sthen Exp $
d8 1
a8 1
REVISION-main =	4
@


1.7
log
@use REVISION, checked with before/after make show=PKGNAMES (plus some
extra-careful checking where there are complicated PSEUDO_FLAVORS).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2010/06/24 16:20:49 sthen Exp $
d8 1
a8 1
REVISION-main =	3
@


1.6
log
@fix PLIST-main to include the pf plugins and bump;
problem pointed out by Yun Zheng Hu, thanks!
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2010/02/25 17:07:17 sthen Exp $
d8 2
a9 1
PKGNAME-main =	munin-node-$Vp3
@


1.5
log
@- update/add OpenBSD-specific plugins (interrupt and pf monitoring), from mk@@

- redo MESSAGE-main, making it a little more obvious how to get started,
following discussions with stephan@@ and jasper@@

ok jasper@@
(reminder, ports is not fully open, do not commit without specific permission)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2010/01/21 20:59:30 sthen Exp $
d8 1
a8 1
PKGNAME-main =	munin-node-$Vp2
@


1.4
log
@Comment-out sample config entries, to fix some things for people
who don't have Postfix installed. Reported by stephan@@, ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2009/11/17 11:47:06 sthen Exp $
d8 1
a8 1
PKGNAME-main =	munin-node-$Vp1
d22 1
a22 1
MAINTAINER=	Stuart Henderson <sthen@@openbsd.org>
d24 1
a24 1
MULTI_PACKAGES=		-main -server
d54 3
d59 1
d61 2
a62 4
	    ${FILESDIR}/if_pps_ ${WRKSRC}/node/node.d.openbsd/if_pps_.in \
	    ${FILESDIR}/bgpd ${WRKSRC}/node/node.d.openbsd/bgpd.in \
	    ${FILESDIR}/sensors_ ${WRKSRC}/node/node.d.openbsd/sensors_.in \
	    ${FILESDIR}/vmstat ${WRKSRC}/node/node.d.openbsd/vmstat.in
d67 5
a71 8
	${SUBST_CMD} ${WRKSRC}/node/node.d.openbsd/if_.in \
	    ${WRKSRC}/node/node.d.openbsd/if_errcoll_.in \
	    ${WRKSRC}/node/node.d.openbsd/if_pps_.in \
	    ${WRKSRC}/node/node.d/ps_.in \
	    ${WRKSRC}/node/munin-node.in \
	    ${WRKSRC}/node/munin-node-configure.in
	perl -pi -e 's,/etc/munin/node.d/,${SYSCONFDIR}/munin/plugins/,g;' \
	    -e 's,/usr/share/munin/node/plugins-auto,${TRUEPREFIX}/libexec/munin/plugins/,g;' \
@


1.3
log
@switch from COUNTER to DERIVE for the interface bandwidth graphs,
suggested by mk@@. bump PKGNAME-main.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2009/11/17 11:20:47 sthen Exp $
d8 1
a8 1
PKGNAME-main =	munin-node-$Vp0
@


1.2
log
@take MAINTAINER, suggested by mk.
yay, I can has two ravens.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2009/11/17 11:11:20 sthen Exp $
d8 1
a8 1
PKGNAME-main =	munin-node-$V
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d21 2
@


1.1.1.1
log
@import ports/net/munin, this was joint work with mk@@ and includes
a couple of his OpenBSD-specific plugins.

Munin the monitoring tool surveys all your computers and
remembers what it saw. It presents all the information in graphs
through a web interface. Its emphasis is on plug and play
capabilities. After completing an installation a high number
of monitoring plugins will be playing with no more effort.

Using Munin you can easily monitor the performance of your
computers, networks, SANs, applications, weather measurements
and whatever comes to mind. It makes it easy to determine
"what's different today" when a performance problem crops up. It
makes it easy to see how you're doing capacity-wise on any
resources.
@
text
@@
