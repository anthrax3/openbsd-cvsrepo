head	1.8;
access;
symbols
	OPENBSD_6_0:1.8.0.10
	OPENBSD_6_0_BASE:1.8
	OPENBSD_5_9:1.8.0.6
	OPENBSD_5_9_BASE:1.8
	OPENBSD_5_8:1.8.0.8
	OPENBSD_5_8_BASE:1.8
	OPENBSD_5_7:1.8.0.4
	OPENBSD_5_7_BASE:1.8
	OPENBSD_5_6:1.8.0.2
	OPENBSD_5_6_BASE:1.8
	OPENBSD_5_5:1.7.0.2
	OPENBSD_5_5_BASE:1.7
	OPENBSD_5_4:1.5.0.2
	OPENBSD_5_4_BASE:1.5
	OPENBSD_5_3:1.4.0.2
	OPENBSD_5_3_BASE:1.4
	OPENBSD_5_2:1.2.0.8
	OPENBSD_5_2_BASE:1.2
	OPENBSD_5_1_BASE:1.2
	OPENBSD_5_1:1.2.0.6
	OPENBSD_5_0:1.2.0.4
	OPENBSD_5_0_BASE:1.2
	OPENBSD_4_9:1.2.0.2
	OPENBSD_4_9_BASE:1.2
	OPENBSD_4_8:1.1.1.1.0.4
	OPENBSD_4_8_BASE:1.1.1.1
	OPENBSD_4_7:1.1.1.1.0.2
	OPENBSD_4_7_BASE:1.1.1.1
	sthen_20091117:1.1.1.1
	sthen:1.1.1;
locks; strict;
comment	@# @;


1.8
date	2014.05.30.10.28.17;	author kirby;	state Exp;
branches;
next	1.7;

1.7
date	2013.12.18.14.17.32;	author kirby;	state Exp;
branches;
next	1.6;

1.6
date	2013.12.03.10.21.01;	author kirby;	state Exp;
branches;
next	1.5;

1.5
date	2013.06.03.19.45.32;	author kirby;	state Exp;
branches
	1.5.2.1;
next	1.4;

1.4
date	2013.01.18.12.23.24;	author gonzalo;	state Exp;
branches;
next	1.3;

1.3
date	2012.10.12.09.46.46;	author kirby;	state Exp;
branches;
next	1.2;

1.2
date	2010.10.23.15.52.22;	author sthen;	state Exp;
branches;
next	1.1;

1.1
date	2009.11.17.11.11.21;	author sthen;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2009.11.17.11.11.21;	author sthen;	state Exp;
branches;
next	;

1.5.2.1
date	2013.12.05.12.57.40;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.8
log
@ - bugfix update to munin-2.0.21
 - move async and asyncd to -main package
 - add asyncd rc script
 - move @@sample /var/db/munin/ to PLIST-main (requested by sthen@@)

with input from ajacoutot@@
OK sthen@@
@
text
@$OpenBSD: patch-Makefile,v 1.7 2013/12/18 14:17:32 kirby Exp $
--- Makefile.orig	Sat Mar 29 01:25:57 2014
+++ Makefile	Wed Apr  2 15:53:34 2014
@@@@ -72,7 +72,6 @@@@ install-pre: Makefile Makefile.config
 	mkdir -p $(STATEDIR)
 	mkdir -p $(SPOOLDIR)
 	mkdir -p $(CONFDIR)
-	$(CHOWN) $(USER) $(LOGDIR) $(STATEDIR) $(SPOOLDIR)
 
 install-master-prime: $(INFILES_MASTER) install-pre install-master
 	mkdir -p $(CONFDIR)/templates
@@@@ -84,15 +83,15 @@@@ install-master-prime: $(INFILES_MASTER) install-pre in
 	mkdir -p $(PERLLIB)
 	mkdir -p $(PERLLIB)/Munin/Master
 	mkdir -p $(HTMLDIR)
-	mkdir -p $(DBDIR)
-	mkdir -p $(DBDIR)/cgi-tmp
+#	mkdir -p $(DBDIR)
+#	mkdir -p $(DBDIR)/cgi-tmp
 	mkdir -p $(CGIDIR)
 
-	$(CHOWN) $(USER) $(HTMLDIR) $(DBDIR)
-	$(CHMOD) 0755 $(DBDIR)
+#	$(CHOWN) $(USER) $(HTMLDIR) $(DBDIR)
+#	$(CHMOD) 0755 $(DBDIR)
 
-	$(CHOWN) $(CGIUSER) $(DBDIR)/cgi-tmp
-	$(CHMOD) 0755 $(DBDIR)/cgi-tmp
+#	$(CHOWN) $(CGIUSER) $(DBDIR)/cgi-tmp
+#	$(CHMOD) 0755 $(DBDIR)/cgi-tmp
 
 	for p in master/www/*.tmpl ;  do \
 		$(INSTALL) -m 0644 "$$p" $(CONFDIR)/templates/ ; \
@@@@ -142,10 +141,10 @@@@ install-plugins-prime: install-plugins build $(PLUGINS
 	mkdir -p $(CONFDIR)/plugins
 	mkdir -p $(CONFDIR)/plugin-conf.d
 	mkdir -p $(LIBDIR)/plugins
-	mkdir -p $(PLUGSTATE)
+#	mkdir -p $(PLUGSTATE)
 
-	$(CHOWN) root:root $(PLUGSTATE)
-	$(CHMOD) 0755 $(PLUGSTATE)
+#	$(CHOWN) root:root $(PLUGSTATE)
+#	$(CHMOD) 0755 $(PLUGSTATE)
 	$(CHMOD) 0755 $(CONFDIR)/plugin-conf.d
 
 	for p in build/plugins/node.d/* build/plugins/node.d.$(OSTYPE)/* ; do \
@@@@ -465,7 +464,7 @@@@ install-%: %/Build
             --install_path script=$(BINDIR)		\
             --install_path sbin=$(SBINDIR)		\
             --install_path bindoc=$(MANDIR)/man1	\
-            --install_path libdoc=$(MANDIR)/man3	\
+            --install_path libdoc=$(MANDIR)/man3p	\
 
 test-%: %/Build
 	cd $* && $(PERL) Build test --verbose=0 || true
@


1.7
log
@unbreak some manuals and scripts by using perl instead of gnused for
substitutuion.
OK sthen@@
@
text
@d1 3
a3 3
$OpenBSD: patch-Makefile,v 1.6 2013/12/03 10:21:01 kirby Exp $
--- Makefile.orig	Wed Nov 13 00:13:23 2013
+++ Makefile	Tue Dec  3 15:15:23 2013
d48 1
a48 71
@@@@ -254,38 +253,37 @@@@ build/%: %.in
 build-common-prime: build-common-pre common/blib/lib/Munin/Common/Defaults.pm build-common
 
 substitue-confvar-inline:
-	@@sed -e 's|@@@@PREFIX@@@@|$(PREFIX)|g'                      \
-             -e 's|@@@@CONFDIR@@@@|$(CONFDIR)|g'                    \
-             -e 's|@@@@BINDIR@@@@|$(BINDIR)|g'                      \
-             -e 's|@@@@SBINDIR@@@@|$(SBINDIR)|g'                    \
-             -e 's|@@@@DOCDIR@@@@|$(DOCDIR)|g'                      \
-             -e 's|@@@@LIBDIR@@@@|$(LIBDIR)|g'                      \
-             -e 's|@@@@MANDIR@@@@|$(MANDIR)|g'                      \
-             -e 's|@@@@LOGDIR@@@@|$(LOGDIR)|g'                      \
-             -e 's|@@@@HTMLDIR@@@@|$(HTMLDIR)|g'                    \
-             -e 's|@@@@DBDIR@@@@|$(DBDIR)|g'                        \
-             -e 's|@@@@STATEDIR@@@@|$(STATEDIR)|g'                  \
-             -e 's|@@@@SPOOLDIR@@@@|$(SPOOLDIR)|g'                  \
-             -e 's|@@@@PERL@@@@|$(PERL)|g'                          \
-             -e 's|@@@@PERLLIB@@@@|$(PERLLIB)|g'                    \
-             -e 's|@@@@PYTHON@@@@|$(PYTHON)|g'                      \
-             -e 's|@@@@RUBY@@@@|$(RUBY)|g'                          \
-             -e 's|@@@@JAVARUN@@@@|$(JAVARUN)|g'                    \
-             -e 's|@@@@JAVALIBDIR@@@@|$(JAVALIBDIR)|g'              \
-             -e 's|@@@@OSTYPE@@@@|$(OSTYPE)|g'                      \
-             -e 's|@@@@HOSTNAME@@@@|$(HOSTNAME)|g'                  \
-             -e 's|@@@@MKTEMP@@@@|$(MKTEMP)|g'                      \
-             -e 's|@@@@VERSION@@@@|$(VERSION)|g'                    \
-             -e 's|@@@@PLUGSTATE@@@@|$(PLUGSTATE)|g'                \
-             -e 's|@@@@CGIDIR@@@@|$(CGIDIR)|g'                      \
-             -e 's|@@@@USER@@@@|$(USER)|g'                          \
-             -e 's|@@@@GROUP@@@@|$(GROUP)|g'                        \
-             -e 's|@@@@PLUGINUSER@@@@|$(PLUGINUSER)|g'              \
-             -e 's|@@@@GOODSH@@@@|$(GOODSH)|g'                      \
-             -e 's|@@@@BASH@@@@|$(BASH)|g'                          \
-             -e 's|@@@@HASSETR@@@@|$(HASSETR)|g'                    \
-             --in-place                                         \
-             ./master/blib/libdoc/Munin::Master::HTMLOld.3pm    \
+	@@perl -pi -e "s'@@@@PREFIX@@@@'$(PREFIX)'g;"                      \
+             -e "s'@@@@CONFDIR@@@@'$(CONFDIR)'g;"                    \
+             -e "s'@@@@BINDIR@@@@'$(BINDIR)'g;"                      \
+             -e "s'@@@@SBINDIR@@@@'$(SBINDIR)'g;"                    \
+             -e "s'@@@@DOCDIR@@@@'$(DOCDIR)'g;"                      \
+             -e "s'@@@@LIBDIR@@@@'$(LIBDIR)'g;"                      \
+             -e "s'@@@@MANDIR@@@@'$(MANDIR)'g;"                      \
+             -e "s'@@@@LOGDIR@@@@'$(LOGDIR)'g;"                      \
+             -e "s'@@@@HTMLDIR@@@@'$(HTMLDIR)'g;"                    \
+             -e "s'@@@@DBDIR@@@@'$(DBDIR)'g;"                        \
+             -e "s'@@@@STATEDIR@@@@'$(STATEDIR)'g;"                  \
+             -e "s'@@@@SPOOLDIR@@@@'$(SPOOLDIR)'g;"                  \
+             -e "s'@@@@PERL@@@@'$(PERL)'g;"                          \
+             -e "s'@@@@PERLLIB@@@@'$(PERLLIB)'g;"                    \
+             -e "s'@@@@PYTHON@@@@'$(PYTHON)'g;"                      \
+             -e "s'@@@@RUBY@@@@'$(RUBY)'g;"                          \
+             -e "s'@@@@JAVARUN@@@@'$(JAVARUN)'g;"                    \
+             -e "s'@@@@JAVALIBDIR@@@@'$(JAVALIBDIR)'g;"              \
+             -e "s'@@@@OSTYPE@@@@'$(OSTYPE)'g;"                      \
+             -e "s'@@@@HOSTNAME@@@@'$(HOSTNAME)'g;"                  \
+             -e "s'@@@@MKTEMP@@@@'$(MKTEMP)'g;"                      \
+             -e "s'@@@@VERSION@@@@'$(VERSION)'g;"                    \
+             -e "s'@@@@PLUGSTATE@@@@'$(PLUGSTATE)'g;"                \
+             -e "s'@@@@CGIDIR@@@@'$(CGIDIR)'g;"                      \
+             -e "s'@@@@USER@@@@'$(USER)'g;"                          \
+             -e "s'@@@@GROUP@@@@'$(GROUP)'g;"                        \
+             -e "s'@@@@PLUGINUSER@@@@'$(PLUGINUSER)'g;"              \
+             -e "s'@@@@GOODSH@@@@'$(GOODSH)'g;"                      \
+             -e "s'@@@@BASH@@@@'$(BASH)'g;"                          \
+             -e "s'@@@@HASSETR@@@@'$(HASSETR)'g;"                    \
+             ./master/blib/libdoc/Munin::Master::HTMLOld.3p    \
              ./master/blib/lib/Munin/Master/HTMLOld.pm          \
              ./node/blib/sbin/munin-node-configure              \
              ./node/blib/sbin/munin-node                        \
@@@@ -466,7 +464,7 @@@@ install-%: %/Build
@


1.6
log
@security and bugfix update to munin-2.0.18
* Avoid a node DoS on bad plugin (CVE-2013-6359)
* Avoid an OOM in HTML generation on bad multigraph data (CVE-2013-6048)
OK sthen@@ with the reminder to fix substitue-confvar-inline target
@
text
@d1 1
a1 1
$OpenBSD: patch-Makefile,v 1.5 2013/06/03 19:45:32 kirby Exp $
d3 1
a3 1
+++ Makefile	Mon Dec  2 19:27:58 2013
d48 71
a118 10
@@@@ -213,7 +212,7 @@@@ install-doc: build-doc
 # Dummy rule to enable parallel building
 infiles: $(INFILES)
 
-build: infiles build-master build-common-prime build-node build-plugins $(JAVA_BUILD) build-man substitue-confvar-inline
+build: infiles build-master build-common-prime build-node build-plugins $(JAVA_BUILD) build-man #substitue-confvar-inline
 
 build/%: %.in
 	@@echo "$< -> $@@"
@@@@ -466,7 +465,7 @@@@ install-%: %/Build
@


1.5
log
@Update to 2.0.14:
 - remove swap plugin as we don't have swapin/swapout anymore;
 - regen patches while here (some hints from rpe@@);
 - fix typo in README (from rpe@@).
@
text
@d1 3
a3 3
$OpenBSD: patch-Makefile,v 1.4 2013/01/18 12:23:24 gonzalo Exp $
--- Makefile.orig	Fri May 10 22:59:50 2013
+++ Makefile	Sun May 26 22:02:43 2013
d48 10
a57 1
@@@@ -423,7 +422,7 @@@@ install-%: %/Build
@


1.5.2.1
log
@Update munin to 2.0.18 which contains various bugfixes as well as fixes for
CVE-2013-6048/CVE-2013-6359

ok kirby@@ (MAINTAINER)
@
text
@d1 3
a3 3
$OpenBSD: patch-Makefile,v 1.6 2013/12/03 10:21:01 kirby Exp $
--- Makefile.orig	Wed Nov 13 00:13:23 2013
+++ Makefile	Mon Dec  2 19:27:58 2013
d48 1
a48 10
@@@@ -213,7 +212,7 @@@@ install-doc: build-doc
 # Dummy rule to enable parallel building
 infiles: $(INFILES)
 
-build: infiles build-master build-common-prime build-node build-plugins $(JAVA_BUILD) build-man substitue-confvar-inline
+build: infiles build-master build-common-prime build-node build-plugins $(JAVA_BUILD) build-man #substitue-confvar-inline
 
 build/%: %.in
 	@@echo "$< -> $@@"
@@@@ -466,7 +465,7 @@@@ install-%: %/Build
@


1.4
log
@Update for munin to 2.0.10 with bugfix and installs perl-related manuals to
man3p category from kirby@@ (maintainer)

ok kirby@@ (maintainer)
@
text
@d1 3
a3 3
$OpenBSD: patch-Makefile,v 1.3 2012/10/12 09:46:46 kirby Exp $
--- Makefile.orig	Wed Jan  9 19:46:54 2013
+++ Makefile	Fri Jan 11 01:11:03 2013
d54 1
a54 1

@


1.3
log
@Major update to munin-2.0.7
Full changelog is here:
https://github.com/munin-monitoring/munin/blob/2.0.7/ChangeLog

Lots of input and help from sthen@@ (maintainer)
ok sthen@@

P.S. Your config may need some manual interference.
@
text
@d1 3
a3 3
$OpenBSD: patch-Makefile,v 1.2 2010/10/23 15:52:22 sthen Exp $
--- Makefile.orig	Fri Aug 31 19:22:50 2012
+++ Makefile	Sun Sep 30 23:14:10 2012
d48 9
@


1.2
log
@update Munin to 1.45, joint work with & ok jasper@@
@
text
@d1 4
a4 5
$OpenBSD: patch-Makefile,v 1.1.1.1 2009/11/17 11:11:21 sthen Exp $
--- Makefile.orig	Tue Dec 29 17:03:49 2009
+++ Makefile	Fri Oct 15 16:08:00 2010
@@@@ -69,7 +69,6 @@@@ install-pre: Makefile Makefile.config
 	mkdir -p $(LOGDIR)
d6 1
d8 1
a8 1
-	$(CHOWN) $(USER) $(LOGDIR) $(STATEDIR)
d12 1
a12 1
@@@@ -80,11 +79,11 @@@@ install-master-prime: $(INFILES_MASTER) install-pre in
d17 1
d19 1
d22 1
a22 1
-	$(CHOWN) $(USER) $(HTMLDIR) $(DBDIR) 
d24 1
a24 1
+#	$(CHOWN) $(USER) $(HTMLDIR) $(DBDIR) 
d27 6
a32 1
 	for p in master/www/*.tmpl master/www/*.png master/www/*.css resources/favicon.ico; do \
d34 1
a34 1
@@@@ -125,10 +124,10 @@@@ install-plugins-prime: install-plugins build $(PLUGINS
d41 4
a44 4
-	$(CHOWN) $(PLUGINUSER):$(GROUP) $(PLUGSTATE)
-	$(CHMOD) 0775 $(PLUGSTATE)
+#	$(CHOWN) $(PLUGINUSER):$(GROUP) $(PLUGSTATE)
+#	$(CHMOD) 0775 $(PLUGSTATE)
@


1.1
log
@Initial revision
@
text
@d1 4
a4 4
$OpenBSD$
--- Makefile.orig	Sat May 24 23:27:56 2008
+++ Makefile	Wed Nov 11 22:01:54 2009
@@@@ -25,10 +25,10 @@@@ install-main: build
d7 8
d17 1
a17 1
+	#mkdir -p $(DBDIR)
d20 4
a23 2
-	$(CHOWN) $(USER) $(LOGDIR) $(STATEDIR) $(RUNDIR) $(HTMLDIR) $(DBDIR)
+	#$(CHOWN) $(USER) $(LOGDIR) $(STATEDIR) $(RUNDIR) $(HTMLDIR) $(DBDIR)
d25 1
a25 1
 	for p in build/server/*.tmpl; do    		              \
d27 6
a32 3
@@@@ -72,7 +72,7 @@@@ install-node-non-snmp: build
 	mkdir -p $(STATEDIR)
 	mkdir -p $(PLUGSTATE)
d35 4
a38 3
+	#$(CHOWN) $(PLUGINUSER):$(GROUP) $(PLUGSTATE)
 	$(CHMOD) 775 $(PLUGSTATE)
 	$(CHMOD) 755 $(CONFDIR)/plugin-conf.d
d40 1
@


1.1.1.1
log
@import ports/net/munin, this was joint work with mk@@ and includes
a couple of his OpenBSD-specific plugins.

Munin the monitoring tool surveys all your computers and
remembers what it saw. It presents all the information in graphs
through a web interface. Its emphasis is on plug and play
capabilities. After completing an installation a high number
of monitoring plugins will be playing with no more effort.

Using Munin you can easily monitor the performance of your
computers, networks, SANs, applications, weather measurements
and whatever comes to mind. It makes it easy to determine
"what's different today" when a performance problem crops up. It
makes it easy to see how you're doing capacity-wise on any
resources.
@
text
@@
