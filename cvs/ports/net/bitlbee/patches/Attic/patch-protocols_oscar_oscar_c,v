head	1.6;
access;
symbols
	OPENBSD_4_3:1.5.0.2
	OPENBSD_4_3_BASE:1.5
	OPENBSD_4_2:1.4.0.4
	OPENBSD_4_2_BASE:1.4
	OPENBSD_4_1:1.4.0.2
	OPENBSD_4_1_BASE:1.4
	OPENBSD_4_0:1.3.0.2
	OPENBSD_4_0_BASE:1.3
	OPENBSD_3_9:1.2.0.6
	OPENBSD_3_9_BASE:1.2
	OPENBSD_3_8:1.2.0.4
	OPENBSD_3_8_BASE:1.2
	OPENBSD_3_7:1.2.0.2
	OPENBSD_3_7_BASE:1.2
	OPENBSD_3_6:1.1.0.2
	OPENBSD_3_6_BASE:1.1;
locks; strict;
comment	@# @;


1.6
date	2008.04.09.22.13.12;	author merdely;	state dead;
branches;
next	1.5;

1.5
date	2007.11.19.11.44.33;	author martynas;	state Exp;
branches;
next	1.4;

1.4
date	2007.01.14.21.53.01;	author simon;	state Exp;
branches;
next	1.3;

1.3
date	2006.04.11.15.11.33;	author naddy;	state Exp;
branches;
next	1.2;

1.2
date	2004.10.21.14.48.51;	author naddy;	state Exp;
branches;
next	1.1;

1.1
date	2004.06.20.16.27.49;	author naddy;	state Exp;
branches;
next	;


desc
@@


1.6
log
@Update to 1.2.
V1.2 adds nice "account set #" feature to manage accounts.
Remove a lot of string handling patches.
Remove patches to rename bitlbee "root" user to "bitlbee".

tested by Andrew Dalgleish (MAINTAINER), James Turner and Wiktor Izdebski
ok martynas@@, simon@@, okan@@, wcmaier@@
@
text
@$OpenBSD: patch-protocols_oscar_oscar_c,v 1.5 2007/11/19 11:44:33 martynas Exp $
--- protocols/oscar/oscar.c.orig	Mon Aug 20 16:27:15 2007
+++ protocols/oscar/oscar.c	Mon Nov 19 13:39:01 2007
@@@@ -146,7 +146,7 @@@@ static char *extract_name(const char *name) {
 			tmp[j++] = x[i];
 			continue;
 		}
-		strncpy(hex, x + ++i, 2); hex[2] = 0;
+		strlcpy(hex, x + ++i, sizeof(hex));
 		i++;
 		tmp[j++] = (char)strtol(hex, NULL, 16);
 	}
@@@@ -291,7 +291,7 @@@@ static void oscar_callback(gpointer data, gint source,
 				c->inpa = 0;
 				c->fd = -1;
 				aim_conn_kill(odata->sess, &conn);
-				sprintf(buf, _("You have been disconnected from chat room %s."), c->name);
+				g_snprintf(buf, sizeof(buf), _("You have been disconnected from chat room %s."), c->name);
 				do_error_dialog(sess->aux_data, buf, _("Chat Error!"));
 			} else if (conn->type == AIM_CONN_TYPE_CHATNAV) {
 				if (odata->cnpa > 0)
@@@@ -1362,7 +1362,7 @@@@ static int gaim_parse_msgerr(aim_session_t *sess, aim_
 	destn = va_arg(ap, char *);
 	va_end(ap);
 
-	sprintf(buf, _("Your message to %s did not get sent: %s"), destn,
+	g_snprintf(buf, sizeof(buf), _("Your message to %s did not get sent: %s"), destn,
 			(reason < msgerrreasonlen) ? msgerrreason[reason] : _("Reason unknown"));
 	do_error_dialog(sess->aux_data, buf, _("Gaim - Error"));
 
@@@@ -1380,7 +1380,7 @@@@ static int gaim_parse_locerr(aim_session_t *sess, aim_
 	destn = va_arg(ap, char *);
 	va_end(ap);
 
-	sprintf(buf, _("User information for %s unavailable: %s"), destn,
+	g_snprintf(buf, sizeof(buf), _("User information for %s unavailable: %s"), destn,
 			(reason < msgerrreasonlen) ? msgerrreason[reason] : _("Reason unknown"));
 	do_error_dialog(sess->aux_data, buf, _("Gaim - Error"));
 
@@@@ -2384,7 +2384,7 @@@@ static char *oscar_encoding_to_utf8(char *encoding, ch
 	 * that was specified.  So we assume it's UTF-8 and hope for the best.
 	 */
 	if (*utf8 == 0) {
-	    strncpy(utf8, text, textlen);
+	    strlcpy(utf8, text, 8192);
 	}
 
 	return utf8;
@


1.5
log
@update to bitlbee-1.0.4
ok simon@@ and maintainer Andrew Dalgleish;  tested by Wiktor Izdebski
@
text
@d1 1
a1 1
$OpenBSD: patch-protocols_oscar_oscar_c,v 1.4 2007/01/14 21:53:01 simon Exp $
@


1.4
log
@update to version 1.0.3

from Martynas Venckus <martynas at altroot dot org>
@
text
@d1 4
a4 4
$OpenBSD: patch-protocols_oscar_oscar_c,v 1.3 2006/04/11 15:11:33 naddy Exp $
--- protocols/oscar/oscar.c.orig	Sat Jun 24 17:00:44 2006
+++ protocols/oscar/oscar.c	Fri Dec 15 21:20:08 2006
@@@@ -146,7 +146,7 @@@@ static char *extract_name(const char *na
d13 1
a13 1
@@@@ -291,7 +291,7 @@@@ static void oscar_callback(gpointer data
d22 1
a22 1
@@@@ -1362,7 +1362,7 @@@@ static int gaim_parse_msgerr(aim_session
d31 1
a31 1
@@@@ -1380,7 +1380,7 @@@@ static int gaim_parse_locerr(aim_session
d40 1
a40 1
@@@@ -2383,7 +2383,7 @@@@ static char *oscar_encoding_to_utf8(char
@


1.3
log
@update to 1.0.2; from maintainer Andrew Dalgleish
@
text
@d1 3
a3 3
$OpenBSD: patch-protocols_oscar_oscar_c,v 1.2 2004/10/21 14:48:51 naddy Exp $
--- protocols/oscar/oscar.c.orig	Sun Apr  2 04:53:40 2006
+++ protocols/oscar/oscar.c	Thu Apr  6 23:39:32 2006
d22 1
a22 1
@@@@ -1361,7 +1361,7 @@@@ static int gaim_parse_msgerr(aim_session
d31 1
a31 1
@@@@ -1379,7 +1379,7 @@@@ static int gaim_parse_locerr(aim_session
d40 1
a40 1
@@@@ -2382,7 +2382,7 @@@@ static char *oscar_encoding_to_utf8(char
@


1.2
log
@Updated to 0.91; from Andrew Dalgleish <openbsd@@ajd.net.au>.
@
text
@d1 22
a22 13
$OpenBSD: patch-protocols_oscar_oscar_c,v 1.1 2004/06/20 16:27:49 naddy Exp $
--- protocols/oscar/oscar.c.orig	Sat Sep 25 21:30:31 2004
+++ protocols/oscar/oscar.c	Fri Oct 15 14:34:08 2004
@@@@ -297,7 +297,7 @@@@ static void oscar_callback(gpointer data
 					c->inpa = 0;
 					c->fd = -1;
 					aim_conn_kill(odata->sess, &conn);
-					sprintf(buf, _("You have been disconnected from chat room %s."), c->name);
+					g_snprintf(buf, sizeof(buf), _("You have been disconnected from chat room %s."), c->name);
 					do_error_dialog(sess->aux_data, buf, _("Chat Error!"));
 				} else if (conn->type == AIM_CONN_TYPE_CHATNAV) {
 					if (odata->cnpa > 0)
@@@@ -1353,7 +1353,7 @@@@ static int gaim_parse_msgerr(aim_session
d31 1
a31 1
@@@@ -1371,7 +1371,7 @@@@ static int gaim_parse_locerr(aim_session
d40 9
@


1.1
log
@Update to 0.90.
Partial audit for string handling.

From: Andrew Dalgleish <openbsd@@ajd.net.au>
@
text
@d1 4
a4 4
$OpenBSD$
--- protocols/oscar/oscar.c.orig	2004-05-19 05:30:36.000000000 +1000
+++ protocols/oscar/oscar.c	2004-06-09 21:19:12.000000000 +1000
@@@@ -304,7 +304,7 @@@@ static void oscar_callback(gpointer data
d10 1
a10 1
 					do_error_dialog(buf, _("Chat Error!"));
d13 1
a13 1
@@@@ -1428,7 +1428,7 @@@@ static int gaim_parse_msgerr(aim_session
d20 1
a20 1
 	do_error_dialog(buf, _("Gaim - Error"));
d22 1
a22 1
@@@@ -1446,7 +1446,7 @@@@ static int gaim_parse_locerr(aim_session
d29 1
a29 1
 	do_error_dialog(buf, _("Gaim - Error"));
@

