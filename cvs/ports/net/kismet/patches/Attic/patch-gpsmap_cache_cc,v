head	1.2;
access;
symbols
	OPENBSD_4_1:1.1.0.2
	OPENBSD_4_1_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2007.04.09.20.50.58;	author kili;	state dead;
branches;
next	1.1;

1.1
date	2006.11.01.21.13.19;	author kili;	state Exp;
branches;
next	;


desc
@@


1.2
log
@
Update to 2007-01-R1b. Tested by many.

ok, robert@@
@
text
@$OpenBSD: patch-gpsmap_cache_cc,v 1.1 2006/11/01 21:13:19 kili Exp $

# From upstream SVN.

--- gpsmap_cache.cc.orig	Thu Mar 10 17:49:34 2005
+++ gpsmap_cache.cc	Fri Oct 20 15:38:06 2006
@@@@ -174,6 +174,8 @@@@ int ReadGpsCacheFile(const char *in_gpsf
 
         strncpy(pt->bssid, cpt.bssid, MAC_STR_LEN);
         strncpy(pt->source, cpt.source, MAC_STR_LEN);
+	pt->bssid[MAC_STR_LEN-1]  = '\0';
+	pt->source[MAC_STR_LEN-1] = '\0';
         pt->tv_sec = cpt.tv_sec;
         pt->tv_usec = cpt.tv_usec;
         pt->lat = cpt.lat;
@@@@ -345,8 +347,9 @@@@ int WriteGpsCacheFile(const char *in_gps
         gpscache_point cpt;
         gps_point *pt = (*in_points)[nsam];
    
-        strncpy(cpt.bssid, pt->bssid, MAC_STR_LEN);
-        strncpy(cpt.source, pt->source, MAC_STR_LEN);
+	memset(&cpt, 0, sizeof cpt);
+        strncpy(cpt.bssid, pt->bssid, sizeof(cpt.bssid)-1);
+        strncpy(cpt.source, pt->source, sizeof(cpt.source)-1);
         cpt.tv_sec = pt->tv_sec;
         cpt.tv_usec = pt->tv_usec;
         cpt.lat = pt->lat;
@


1.1
log
@
Update to 2006-04-R1, with some patches from the upstream kismet SVN.

While here, update my mail address and comment most of
the patch files.

Some WANTLIB spanking and ok, sturm@@
@
text
@d1 1
a1 1
$OpenBSD$
@

