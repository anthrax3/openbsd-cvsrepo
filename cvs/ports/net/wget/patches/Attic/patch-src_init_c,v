head	1.4;
access;
symbols
	OPENBSD_5_5:1.3.0.4
	OPENBSD_5_6:1.3.0.2
	OPENBSD_5_0:1.1.0.8
	OPENBSD_5_0_BASE:1.1
	OPENBSD_4_9:1.1.0.6
	OPENBSD_4_9_BASE:1.1
	OPENBSD_4_8:1.1.0.4
	OPENBSD_4_7:1.1.0.2;
locks; strict;
comment	@# @;


1.4
date	2014.11.05.22.11.40;	author naddy;	state dead;
branches;
next	1.3;
commitid	2yIzn7ff6aDuB8Yc;

1.3
date	2014.10.27.15.28.39;	author jasper;	state Exp;
branches
	1.3.2.1
	1.3.4.1;
next	1.2;
commitid	y6XgB4w3PBnbbzjx;

1.2
date	2011.10.12.10.14.30;	author dcoppa;	state dead;
branches;
next	1.1;

1.1
date	2010.09.13.16.48.11;	author jasper;	state Exp;
branches
	1.1.2.1
	1.1.4.1;
next	;

1.1.2.1
date	2010.09.21.02.57.07;	author william;	state Exp;
branches;
next	;

1.1.4.1
date	2010.09.21.02.58.25;	author william;	state Exp;
branches;
next	;

1.3.2.1
date	2014.10.27.15.31.18;	author jasper;	state Exp;
branches;
next	;
commitid	w7fVgYBxpaoffnlO;

1.3.4.1
date	2014.10.27.15.31.25;	author jasper;	state Exp;
branches;
next	;
commitid	V4IoY3DHPNP8QU27;


desc
@@


1.4
log
@update to 1.16 and add dependencies to run all regression tests
hints from ajacoutot@@; ok giovanni@@, sthen@@
@
text
@$OpenBSD: patch-src_init_c,v 1.3 2014/10/27 15:28:39 jasper Exp $

Security fix for CVE-2014-4877, Arbitrary Symlink Access
http://git.savannah.gnu.org/cgit/wget.git/commit/?id=18b0979357ed7dc4e11d4f2b1d7e0f5932d82aa7

--- src/init.c.orig	Mon Oct 27 16:13:23 2014
+++ src/init.c	Mon Oct 27 16:15:38 2014
@@@@ -364,6 +364,22 @@@@ defaults (void)
 
   opt.dns_cache = true;
   opt.ftp_pasv = true;
+  /* 2014-09-07  Darshit Shah  <darnir@@gmail.com>
+   * opt.retr_symlinks is set to true by default. Creating symbolic links on the
+   * local filesystem pose a security threat by malicious FTP Servers that
+   * server a specially crafted .listing file akin to this:
+   *
+   * lrwxrwxrwx   1 root     root           33 Dec 25  2012 JoCxl6d8rFU -> /
+   * drwxrwxr-x  15 1024     106          4096 Aug 28 02:02 JoCxl6d8rFU
+   *
+   * A .listing file in this fashion makes Wget susceptiple to a symlink attack
+   * wherein the attacker is able to create arbitrary files, directories and
+   * symbolic links on the target system and even set permissions.
+   *
+   * Hence, by default Wget attempts to retrieve the pointed-to files and does
+   * not create the symbolic links locally.
+   */
+    opt.retr_symlinks = true;
 
 #ifdef HAVE_SSL
   opt.check_cert = true;
@


1.3
log
@Security fix for CVE-2014-4877, Arbitrary Symlink Access
@
text
@d1 1
a1 1
$OpenBSD$
@


1.3.4.1
log
@Security fix for CVE-2014-4877, Arbitrary Symlink Access
@
text
@d1 1
a1 1
$OpenBSD: patch-src_init_c,v 1.3 2014/10/27 15:28:39 jasper Exp $
@


1.3.2.1
log
@Security fix for CVE-2014-4877, Arbitrary Symlink Access
@
text
@d1 1
a1 1
$OpenBSD: patch-src_init_c,v 1.3 2014/10/27 15:28:39 jasper Exp $
@


1.2
log
@Update to wget-1.13.4.
Tested on i386, amd64 and sparc64.

Note: untested on gcc2 architectures, but it's broken anyway since
gperf fails to build there due to an internal compiler error (as
found by sebastia@@ on his vax).

OK sthen@@
@
text
@d1 1
a1 1
$OpenBSD: patch-src_init_c,v 1.1 2010/09/13 16:48:11 jasper Exp $
d3 2
a4 3
By default, on server redirects, use the original URL to get the
local file name. Fixes CVE-2010-2252.
Diff from upstream.
d6 25
a30 10
--- src/init.c.orig	Tue Sep 22 05:02:41 2009
+++ src/init.c	Mon Sep 13 10:13:32 2010
@@@@ -243,6 +243,7 @@@@ static const struct {
   { "timeout",          NULL,                   cmd_spec_timeout },
   { "timestamping",     &opt.timestamping,      cmd_boolean },
   { "tries",            &opt.ntry,              cmd_number_inf },
+  { "trustservernames", &opt.trustservernames,  cmd_boolean },
   { "useproxy",         &opt.use_proxy,         cmd_boolean },
   { "user",             &opt.user,              cmd_string },
   { "useragent",        NULL,                   cmd_spec_useragent },
@


1.1
log
@SECURITY FIX for CVE-2010-2252

By default, on server redirects, use the original URL to get the
local file name.

ok naddy@@
additional testing by kevlo@@, thanks.
@
text
@d1 1
a1 1
$OpenBSD$
@


1.1.4.1
log
@MFC:

SECURITY FIX

Resolves CVE-2010-2252
@
text
@d1 1
a1 1
$OpenBSD: patch-src_init_c,v 1.1 2010/09/13 16:48:11 jasper Exp $
@


1.1.2.1
log
@MFC:

SECURITY FIX

Resolves CVE-2010-2252
@
text
@d1 1
a1 1
$OpenBSD: patch-src_init_c,v 1.1 2010/09/13 16:48:11 jasper Exp $
@

