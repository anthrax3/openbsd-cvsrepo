head	1.2;
access;
symbols
	OPENBSD_3_3:1.1.0.6
	OPENBSD_3_3_BASE:1.1
	OPENBSD_3_1:1.1.0.4
	OPENBSD_3_2:1.1.0.2;
locks; strict;
comment	@# @;


1.2
date	2003.05.14.15.03.51;	author brad;	state dead;
branches;
next	1.1;

1.1
date	2002.12.10.18.37.24;	author brad;	state Exp;
branches
	1.1.2.1
	1.1.4.1;
next	;

1.1.2.1
date	2002.12.10.18.43.35;	author brad;	state Exp;
branches;
next	;

1.1.4.1
date	2002.12.10.18.49.59;	author brad;	state Exp;
branches;
next	;


desc
@@


1.2
log
@upgrade to wget 1.8.2
--
From: David Gwynne <loki at niteshade dot net> with a number of changes from me
@
text
@$OpenBSD: patch-src_fnmatch_c,v 1.1 2002/12/10 18:37:24 brad Exp $
--- src/fnmatch.c.orig	Tue Dec 10 13:06:09 2002
+++ src/fnmatch.c	Tue Dec 10 13:07:23 2002
@@@@ -188,6 +188,17 @@@@ fnmatch (const char *pattern, const char
   return (FNM_NOMATCH);
 }
 
+/* Return non-zero if S has a leading '/'  or contains '../' */
+int
+has_invalid_name (const char *s)
+{
+	if (*s == '/')
+		return 1;
+	if (strstr(s, "../") != 0)
+		return 1;
+	return 0;
+}
+
 /* Return non-zero if S contains globbing wildcards (`*', `?', `[' or
    `]').  */
 int
@


1.1
log
@Fix directory traversal bug in FTP mode with wget which can potentially
allow files to be written outside the download directory.

http://marc.theaimsgroup.com/?l=bugtraq&m=87602746719482
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2002-1344
@
text
@d1 1
a1 1
$OpenBSD$
@


1.1.4.1
log
@Fix directory traversal bug in FTP mode with wget which can potentially
allow files to be written outside the download directory.

http://marc.theaimsgroup.com/?l=bugtraq&m=87602746719482
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2002-1344
@
text
@@


1.1.2.1
log
@Fix directory traversal bug in FTP mode with wget which can potentially
allow files to be written outside the download directory.

http://marc.theaimsgroup.com/?l=bugtraq&m=87602746719482
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2002-1344
@
text
@@

