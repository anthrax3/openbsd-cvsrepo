head	1.3;
access;
symbols
	OPENBSD_3_3:1.2.0.2
	OPENBSD_3_3_BASE:1.2
	OPENBSD_3_2:1.1.0.12
	OPENBSD_3_2_BASE:1.1
	OPENBSD_3_1:1.1.0.10
	OPENBSD_3_1_BASE:1.1
	OPENBSD_3_0:1.1.0.8
	OPENBSD_3_0_BASE:1.1
	OPENBSD_2_9_TRACKING_SWITCH:1.1
	OPENBSD_2_9:1.1.0.6
	OPENBSD_2_9_BASE:1.1
	OPENBSD_2_8:1.1.0.4
	OPENBSD_2_8_BASE:1.1
	OPENBSD_2_7:1.1.0.2;
locks; strict;
comment	@ * @;


1.3
date	2003.05.14.00.24.48;	author jakob;	state dead;
branches;
next	1.2;

1.2
date	2002.11.19.07.56.50;	author pvalchev;	state Exp;
branches;
next	1.1;

1.1
date	2000.08.07.12.16.44;	author jakob;	state Exp;
branches;
next	;


desc
@@


1.3
log
@remove gated. discussed with itojun@@ and others.
@
text
@--- src/gated/if.c.orig	Fri Mar 17 00:54:51 2000
+++ src/gated/if.c	Sun Nov 17 13:35:50 2002
@@@@ -2863,9 +2863,10 @@@@ if_rtup(if_addr *ifap)
 	    case IFS_LOOPBACK:
 	        /* Add a host route to the loopback interface */
 
-	        BIT_SET(int_rtparms.rtp_state, RTS_NOADVISE);
 	        int_rtparms.rtp_dest = ifap->ifa_addr_local;
 	        int_rtparms.rtp_dest_mask = sockhostmask(ifap->ifa_addr_local);
+		if (sock2ip(ifap->ifa_addr_local) == htonl(INADDR_LOOPBACK))
+		    BIT_SET(int_rtparms.rtp_state, RTS_NOADVISE);
 
 	    	ifap->ifa_rt = rt_add(&int_rtparms);
 	    	break;
@


1.2
log
@sync with update-patches
@
text
@@


1.1
log
@add missing patch
@
text
@d1 3
a3 3
--- src/gated/if.c.orig	Fri Mar 17 08:54:51 2000
+++ src/gated/if.c	Sun Jul 30 19:03:25 2000
@@@@ -2863,9 +2863,10 @@@@
@

