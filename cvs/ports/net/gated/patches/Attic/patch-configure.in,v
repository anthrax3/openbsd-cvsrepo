head	1.3;
access;
symbols
	OPENBSD_3_3:1.2.0.2
	OPENBSD_3_3_BASE:1.2
	OPENBSD_3_2:1.1.0.10
	OPENBSD_3_2_BASE:1.1
	OPENBSD_3_1:1.1.0.8
	OPENBSD_3_1_BASE:1.1
	OPENBSD_3_0:1.1.0.6
	OPENBSD_3_0_BASE:1.1
	OPENBSD_2_9_TRACKING_SWITCH:1.1
	OPENBSD_2_9:1.1.0.4
	OPENBSD_2_9_BASE:1.1
	OPENBSD_2_8:1.1.0.2
	OPENBSD_2_8_BASE:1.1;
locks; strict;
comment	@# @;


1.3
date	2003.05.14.00.24.48;	author jakob;	state dead;
branches;
next	1.2;

1.2
date	2002.11.19.07.56.50;	author pvalchev;	state Exp;
branches;
next	1.1;

1.1
date	2000.08.15.17.12.36;	author jakob;	state Exp;
branches;
next	;


desc
@@


1.3
log
@remove gated. discussed with itojun@@ and others.
@
text
@        $OpenBSD: patch-configure.in,v 1.2 2002/11/19 07:56:50 pvalchev Exp $
1. Make configure detect mkdep properly.
2. Avoid compiler warnings "CMSG_XXX previosly defined at sys/socket.h"
   CMSG_SPACE is macros so we must use AC_EGREP_CPP to properly detect it's
   presence. 
--- configure.in.orig	Tue Mar 28 12:56:08 2000
+++ configure.in	Sun Nov 17 13:35:50 2002
@@@@ -413,35 +413,33 @@@@ dnl
 dnl Check for a way to calculate dependencies.
 dnl
 MKDEP_FILE="$srcdir/util/make-depend"
-AC_MSG_CHECKING(how to calculate deps)
-if test $ac_cv_prog_CC = gcc; then
-	dnl
-	dnl use gcc if it's there
-	dnl
-	MKDEP="\$(top_srcdir)/util/mkdep"
-elif $CC -V 2>&1 | grep WorkShop > /dev/null; then
-	dnl 
-	dnl checking for sunworkshop
-	dnl
-	MKDEP="\$(top_srcdir)/util/mkdep -flag -xM"
-else
-	dnl
-	dnl use makedepend, mkdep, or canned
-	dnl
-	AC_CHECK_FILE(makedepend,has_makedepend=yes,has_makedepend=no)
-	if test $has_makedepend = yes; then
-		MKDEP="makedepend"
+AC_CHECK_PROG(MKDEP, mkdep, mkdep, notfound)
+if test $MKDEP = notfound; then 
+	AC_CHECK_PROG(have_makedepend, makedepend, yes, no)
+	AC_MSG_CHECKING(how to calculate deps)
+	if test $ac_cv_prog_gcc = yes; then
+		dnl
+		dnl use gcc if it's there
+		dnl
+		MKDEP="\$(top_srcdir)/util/mkdep"
+	elif $CC -V 2>&1 | grep WorkShop > /dev/null; then
+		dnl 
+		dnl checking for sunworkshop
+		dnl
+		MKDEP="\$(top_srcdir)/util/mkdep -flag -xM"
 	else
-		AC_CHECK_FILE(mkdep, has_mkdep=yes,has_mkdep=no)
-		if test $has_mkdep = yes; then
-			MKDEP="mkdep"
+		dnl
+		dnl use makedepend, mkdep, or canned
+		dnl
+		if test $have_makedepend = yes; then
+			MKDEP="makedepend"
 		else
 			MKDEP=""
 			MKDEP_FILE="/dev/null"
 		fi
 	fi
+	AC_MSG_RESULT($MKDEP)
 fi
-AC_MSG_RESULT($MKDEP)
 AC_SUBST(MKDEP)
 AC_SUBST_FILE(MKDEP_FILE)
 
@@@@ -651,7 +649,12 @@@@ AC_EGREP_HEADER(setlinebuf, stdio.h, AC_
 AC_EGREP_HEADER(if_multiaddrs, net/if_var.h, AC_DEFINE(MULTIADDRS_ON_IFNET))
 AC_EGREP_HEADER(ia_subnetmask, netinet/in_var.h, AC_DEFINE(USE_IA_SUBNETMASK))
 AC_EGREP_HEADER(icmp6_mld, netinet/icmp6.h, AC_DEFINE(HAVE_ICMP6_MLD))
-AC_EGREP_HEADER(CMSG_SPACE, sys/socket.h, AC_DEFINE(HAVE_CMSG_SPACE))
+AC_EGREP_CPP(yes,
+[#include <sys/socket.h>
+#ifdef CMSG_SPACE
+yes
+#endif
+], AC_DEFINE(HAVE_CMSG_SPACE))
 AC_EGREP_HEADER(ICMPV6_PACKET_TOOBIG, netinet/icmp6.h, AC_DEFINE(HAVE_ICMPV6_DEST_UNREACH))
 AC_EGREP_HEADER(redirect_destination, netinet/icmp6.h, AC_DEFINE(HAVE_REDIRECT_DESTINATION))
 AC_EGREP_HEADER(ifm_data, net/if.h, AC_DEFINE(HAVE_IFM_DATA))
@


1.2
log
@sync with update-patches
@
text
@d1 1
a1 1
        $OpenBSD: patch-configure.in,v 1.1 2000/08/15 17:12:36 jakob Exp $
@


1.1
log
@- support mkdep and run 'make depend' and configure
- remove some compiler warnings
- add snmp & gii flavour, disable snmp/smux and gii by default
- add INSTALL/DEINSTALL script
- add MESSAGE

work by Grigoriy Orlov <gluk@@ptci.ru>
@
text
@d1 1
a1 1
        $OpenBSD$
d6 3
a8 3
--- configure.in.orig	Tue Mar 28 23:56:08 2000
+++ configure.in	Wed Aug  9 20:12:27 2000
@@@@ -413,35 +413,33 @@@@
d64 1
a64 1
@@@@ -651,7 +649,12 @@@@
@

