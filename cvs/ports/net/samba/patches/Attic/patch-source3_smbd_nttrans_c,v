head	1.2;
access;
symbols
	OPENBSD_5_8:1.1.0.14
	OPENBSD_5_8_BASE:1.1
	OPENBSD_5_7:1.1.0.10
	OPENBSD_5_7_BASE:1.1
	OPENBSD_5_6:1.1.0.8
	OPENBSD_5_6_BASE:1.1
	OPENBSD_5_5:1.1.0.6
	OPENBSD_5_5_BASE:1.1
	OPENBSD_5_4:1.1.0.4
	OPENBSD_5_3:1.1.0.2;
locks; strict;
comment	@# @;


1.2
date	2015.08.25.11.04.39;	author jca;	state dead;
branches;
next	1.1;
commitid	jWHBCzKs5xKamlhw;

1.1
date	2013.10.06.22.00.48;	author brad;	state Exp;
branches
	1.1.2.1
	1.1.4.1;
next	;

1.1.2.1
date	2013.10.28.14.50.32;	author jasper;	state Exp;
branches;
next	;

1.1.4.1
date	2013.10.30.12.54.47;	author jasper;	state Exp;
branches;
next	1.1.4.2;

1.1.4.2
date	2014.02.06.08.35.13;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Move samba4 to samba, and tweak the ports tree to use it.

ok ajacoutot@@

Upcoming commits will add additional tweaks.

Many thanks to Vadim Zhukov (who did most of the work), Ian McWilliam
(co-maintainer), Stuart Henderson who provided lots of support and
feedback, Antoine Jacoutot who patiently dealt with my broken diffs,
and more generally all the people involved.  Most of the recent work was
done during p2k15 and c2k15.
@
text
@$OpenBSD: patch-source3_smbd_nttrans_c,v 1.1 2013/10/06 22:00:48 brad Exp $

Missing integer wrap protection in EA list reading can cause server to loop with
DoS. CVE-2013-4124

--- source3/smbd/nttrans.c.orig	Wed May  8 04:16:26 2013
+++ source3/smbd/nttrans.c	Thu Sep 26 21:53:10 2013
@@@@ -989,7 +989,19 @@@@ struct ea_list *read_nttrans_ea_list(TALLOC_CTX *ctx, 
 		if (next_offset == 0) {
 			break;
 		}
+
+		/* Integer wrap protection for the increment. */
+		if (offset + next_offset < offset) {
+			break;
+		}
+
 		offset += next_offset;
+
+		/* Integer wrap protection for while loop. */
+		if (offset + 4 < offset) {
+			break;
+		}
+
 	}
 
 	return ea_list_head;
@


1.1
log
@Add a DoS fix.. Missing integer wrap protection in EA list reading can cause
server to loop with DoS. CVE-2013-4124

ok sthen@@
@
text
@d1 1
a1 1
$OpenBSD$
@


1.1.4.1
log
@Security fix for CVE-2013-4124
@
text
@d1 1
a1 1
$OpenBSD: patch-source3_smbd_nttrans_c,v 1.1 2013/10/06 22:00:48 brad Exp $
@


1.1.4.2
log
@apply security updates for CVE-2013-4408 and CVE-2013-4475
@
text
@@


1.1.2.1
log
@Security fix for CVE-2013-4124;
missing integer wrap protection in EA list reading can cause server to loop with DoS.
@
text
@d1 1
a1 1
$OpenBSD: patch-source3_smbd_nttrans_c,v 1.1 2013/10/06 22:00:48 brad Exp $
@

