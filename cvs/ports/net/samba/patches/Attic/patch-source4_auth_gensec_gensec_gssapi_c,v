head	1.1;
access;
symbols
	OPENBSD_6_0:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2016.12.23.22.35.36;	author jca;	state dead;
branches
	1.1.2.1;
next	;
commitid	ROr0Ptf5whU2K9J8;

1.1.2.1
date	2016.12.23.22.35.36;	author jca;	state Exp;
branches;
next	;
commitid	ROr0Ptf5whU2K9J8;


desc
@@


1.1
log
@file patch-source4_auth_gensec_gensec_gssapi_c was initially added on branch OPENBSD_6_0.
@
text
@@


1.1.2.1
log
@SECURITY update for 4.4.8 CVEs

CVE-2016-2123: Fix DNS vuln ZDI-CAN-3995.
CVE-2016-2125: Don't send delegated credentials to all servers.
CVE-2016-2126: auth/kerberos: Only allow known checksum types in check_pac_checksum().

Test by Ian MacWilliam
@
text
@a0 29
$OpenBSD$

commit 58586ceae7fe628453e6bffdc463d4309ced15fb
Author: Stefan Metzmacher <metze@@samba.org>
Date:   Wed Nov 23 11:44:22 2016 +0100

    CVE-2016-2125: s4:gensec_gssapi: don't use GSS_C_DELEG_FLAG by default

    This disabled the usage of GSS_C_DELEG_FLAG by default, as
    GSS_C_DELEG_POLICY_FLAG is still used by default we let the
    KDC decide if we should send delegated credentials to a remote server.

    BUG: https://bugzilla.samba.org/show_bug.cgi?id=12445

    Signed-off-by: Stefan Metzmacher <metze@@samba.org>
    Reviewed-by: Alexander Bokovoy <ab@@samba.org>
    Reviewed-by: Simo Sorce <idra@@samba.org>

--- source4/auth/gensec/gensec_gssapi.c.orig	Wed Dec 21 12:14:45 2016
+++ source4/auth/gensec/gensec_gssapi.c	Wed Dec 21 14:20:55 2016
@@@@ -115,7 +115,7 @@@@ static NTSTATUS gensec_gssapi_start(struct gensec_secu
 	if (gensec_setting_bool(gensec_security->settings, "gensec_gssapi", "mutual", true)) {
 		gensec_gssapi_state->gss_want_flags |= GSS_C_MUTUAL_FLAG;
 	}
-	if (gensec_setting_bool(gensec_security->settings, "gensec_gssapi", "delegation", true)) {
+	if (gensec_setting_bool(gensec_security->settings, "gensec_gssapi", "delegation", false)) {
 		gensec_gssapi_state->gss_want_flags |= GSS_C_DELEG_FLAG;
 	}
 	if (gensec_setting_bool(gensec_security->settings, "gensec_gssapi", "replay", true)) {
@

