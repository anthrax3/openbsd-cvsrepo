head	1.1;
access;
symbols
	OPENBSD_6_0:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2016.12.23.22.35.36;	author jca;	state dead;
branches
	1.1.2.1;
next	;
commitid	ROr0Ptf5whU2K9J8;

1.1.2.1
date	2016.12.23.22.35.36;	author jca;	state Exp;
branches;
next	;
commitid	ROr0Ptf5whU2K9J8;


desc
@@


1.1
log
@file patch-source3_librpc_crypto_gse_c was initially added on branch OPENBSD_6_0.
@
text
@@


1.1.2.1
log
@SECURITY update for 4.4.8 CVEs

CVE-2016-2123: Fix DNS vuln ZDI-CAN-3995.
CVE-2016-2125: Don't send delegated credentials to all servers.
CVE-2016-2126: auth/kerberos: Only allow known checksum types in check_pac_checksum().

Test by Ian MacWilliam
@
text
@a0 28
$OpenBSD$

commit 07ef0f6ce0fb9d9735710ab79c2ee91d7a72a974
Author: Stefan Metzmacher <metze@@samba.org>
Date:   Wed Nov 23 11:42:59 2016 +0100

    CVE-2016-2125: s3:gse: avoid using GSS_C_DELEG_FLAG

    We should only use GSS_C_DELEG_POLICY_FLAG in order to let
    the KDC decide if we should send delegated credentials to
    a remote server.

    BUG: https://bugzilla.samba.org/show_bug.cgi?id=12445

    Signed-off-by: Stefan Metzmacher <metze@@samba.org>
    Reviewed-by: Alexander Bokovoy <ab@@samba.org>
    Reviewed-by: Simo Sorce <idra@@samba.org>

--- source3/librpc/crypto/gse.c.orig	Wed Dec 21 12:14:43 2016
+++ source3/librpc/crypto/gse.c	Wed Dec 21 14:20:55 2016
@@@@ -142,7 +142,6 @@@@ static NTSTATUS gse_context_init(TALLOC_CTX *mem_ctx,
 	memcpy(&gse_ctx->gss_mech, gss_mech_krb5, sizeof(gss_OID_desc));
 
 	gse_ctx->gss_want_flags = GSS_C_MUTUAL_FLAG |
-				GSS_C_DELEG_FLAG |
 				GSS_C_DELEG_POLICY_FLAG |
 				GSS_C_REPLAY_FLAG |
 				GSS_C_SEQUENCE_FLAG;
@

