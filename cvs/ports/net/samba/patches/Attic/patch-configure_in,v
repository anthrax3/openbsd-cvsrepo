head	1.23;
access;
symbols
	OPENBSD_5_1_BASE:1.22
	OPENBSD_5_1:1.22.0.2
	OPENBSD_5_0:1.19.0.2
	OPENBSD_5_0_BASE:1.19
	OPENBSD_4_9:1.17.0.2
	OPENBSD_4_9_BASE:1.17
	OPENBSD_4_8:1.16.0.2
	OPENBSD_4_8_BASE:1.16
	OPENBSD_4_1:1.10.0.2
	OPENBSD_4_1_BASE:1.10
	OPENBSD_4_0:1.9.0.4
	OPENBSD_4_0_BASE:1.9
	OPENBSD_3_9:1.9.0.2
	OPENBSD_3_9_BASE:1.9
	OPENBSD_3_0:1.4.0.2
	OPENBSD_3_0_BASE:1.4
	OPENBSD_2_9_TRACKING_SWITCH:1.2
	OPENBSD_2_9:1.1.0.2
	OPENBSD_2_9_BASE:1.1;
locks; strict;
comment	@# @;


1.23
date	2012.04.10.22.01.20;	author sthen;	state dead;
branches;
next	1.22;

1.22
date	2011.10.21.20.10.51;	author sthen;	state Exp;
branches;
next	1.21;

1.21
date	2011.09.26.09.32.12;	author sthen;	state Exp;
branches;
next	1.20;

1.20
date	2011.08.22.10.03.25;	author giovanni;	state Exp;
branches;
next	1.19;

1.19
date	2011.06.15.19.34.45;	author sthen;	state Exp;
branches;
next	1.18;

1.18
date	2011.03.15.13.49.44;	author sthen;	state Exp;
branches;
next	1.17;

1.17
date	2010.10.18.19.07.19;	author sthen;	state Exp;
branches
	1.17.2.1;
next	1.16;

1.16
date	2010.07.14.07.20.18;	author sthen;	state Exp;
branches;
next	1.15;

1.15
date	2010.06.25.17.39.12;	author sthen;	state Exp;
branches;
next	1.14;

1.14
date	2010.05.20.18.16.39;	author sthen;	state Exp;
branches;
next	1.13;

1.13
date	2010.04.26.17.31.57;	author sthen;	state Exp;
branches;
next	1.12;

1.12
date	2007.05.28.20.03.01;	author mbalmer;	state dead;
branches;
next	1.11;

1.11
date	2007.04.06.14.20.35;	author ajacoutot;	state Exp;
branches;
next	1.10;

1.10
date	2006.10.03.14.07.10;	author mbalmer;	state Exp;
branches;
next	1.9;

1.9
date	2006.02.02.09.40.43;	author mbalmer;	state Exp;
branches;
next	1.8;

1.8
date	2005.11.03.15.10.20;	author mbalmer;	state Exp;
branches;
next	1.7;

1.7
date	2001.12.26.19.15.09;	author brad;	state dead;
branches;
next	1.6;

1.6
date	2001.11.02.22.31.01;	author dhartmei;	state Exp;
branches;
next	1.5;

1.5
date	2001.10.24.15.36.01;	author dhartmei;	state dead;
branches;
next	1.4;

1.4
date	2001.08.29.13.26.15;	author dhartmei;	state Exp;
branches;
next	1.3;

1.3
date	2001.08.23.09.12.13;	author dhartmei;	state Exp;
branches;
next	1.2;

1.2
date	2001.05.16.00.59.48;	author matt;	state Exp;
branches;
next	1.1;

1.1
date	2001.04.10.11.36.15;	author brad;	state Exp;
branches;
next	;

1.17.2.1
date	2011.04.10.02.19.49;	author william;	state Exp;
branches;
next	;


desc
@@


1.23
log
@fix WRKSRC/WRKDIST insanity
@
text
@$OpenBSD: patch-configure_in,v 1.22 2011/10/21 20:10:51 sthen Exp $
--- configure.in.orig	Tue Oct 18 19:48:48 2011
+++ configure.in	Fri Oct 21 13:04:40 2011
@@@@ -1640,8 +1640,7 @@@@ DSO_EXPORTS=""
 			;;
 		*openbsd*)  BLDSHARED="true"
 			LDSHFLAGS="-shared"
-			DYNEXP="-Wl,-Bdynamic"
-			SONAMEFLAG="-Wl,-soname,"
+			DYNEXP="-Wl,--export-dynamic"
 			PICFLAG="-fPIC"
 			AC_DEFINE(STAT_ST_BLOCKSIZE,512,[The size of a block])
 			AC_DEFINE(BROKEN_GETGRNAM,1,[Does getgrnam work correctly])
@


1.22
log
@update to samba 3.6.1; lots of bugfixes.
similar diff / ok Ian McWilliam (maintainer).
also tested by dhill, thanks!
@
text
@d1 1
a1 1
$OpenBSD: patch-configure_in,v 1.21 2011/09/26 09:32:12 sthen Exp $
@


1.21
log
@update to samba 3.6.0, from Ian McWilliam / Stefan Rinkes
tweaks/testing from me and nigel@@
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.20 2011/08/22 10:03:25 giovanni Exp $
--- configure.in.orig	Tue Aug  9 13:17:47 2011
+++ configure.in	Mon Sep 12 17:40:48 2011
@@@@ -1638,8 +1638,7 @@@@ DSO_EXPORTS=""
@


1.20
log
@
Bugfix update to 3.5.11, from maintainer Ian McWilliam
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.19 2011/06/15 19:34:45 sthen Exp $
--- configure.in.orig	Thu Aug  4 04:24:05 2011
+++ configure.in	Sun Aug 14 10:44:16 2011
@@@@ -1582,8 +1582,7 @@@@ DSO_EXPORTS=""
a13 39
@@@@ -1729,38 +1728,6 @@@@ if test x"$BLDSHARED" = x"true" ; then
 fi
 
 AC_MSG_RESULT($BLDSHARED)
-
-saved_before_as_needed_ldflags="$LDFLAGS"
-for flags in "-Wl,--as-needed" "-Wl,-z,ignore" "-z ignore" ; do
-	saved_ldflags="$LDFLAGS"
-	AC_MSG_CHECKING([if $flags works])
-	LDFLAGS="$flags $saved_ldflags"
-	AC_TRY_LINK([],[],
-		[AC_MSG_RESULT([yes])
-		LD_AS_NEEDED_FLAG=$flags
-		ld_as_needed_flag_found=yes],
-		AC_MSG_RESULT([no]))
-	LDFLAGS="$LD_AS_NEEDED_FLAG $saved_ldflags"
-	test x"$ld_as_needed_flag_found" = xyes && break
-done
-
-# check if we have to disable LD_AS_NEEDED_FLAG:
-# On some systems for a veriety of reasons linking with
-# -Wl,--as-needed -lreadline -lncurses fails
-# we have to retest, if these combination is detected before.
-# Bugzilla #7209
-
-if test x$ac_cv_lib_readline_rl_callback_handler_install = xyes ; then
-	if test x$ld_as_needed_flag_found = xyes ; then
-		AC_MSG_CHECKING([if $LD_AS_NEEDED_FLAG works with readline])
-		# try if check no fails
-		save_LIBS=$LIBS
-		LIBS="$LIBS $TERMLIBS"
-		AC_TRY_LINK([], [rl_callback_handler_install();], [AC_MSG_RESULT([yes])],[ AC_MSG_RESULT([no]); LDFLAGS="$saved_before_as_needed_ldflags"])
-		LIBS="$save_LIBS"
-        fi
-fi
-
 
 
 # for historical reasons almost all linkers don't complain about unresolved
@


1.19
log
@update to samba 3.5.9, from maintainer Ian McWilliam
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.18 2011/03/15 13:49:44 sthen Exp $
--- configure.in.orig	Tue Jun 14 21:17:28 2011
+++ configure.in	Wed Jun 15 19:57:56 2011
@@@@ -1566,8 +1566,7 @@@@ DSO_EXPORTS=""
d14 1
a14 1
@@@@ -1713,38 +1712,6 @@@@ if test x"$BLDSHARED" = x"true" ; then
@


1.18
log
@update to 3.5.8, ok aja@@ giovanni@@ Ian McWilliam (maintainer)
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.17 2010/10/18 19:07:19 sthen Exp $
--- configure.in.orig	Sun Mar  6 18:48:05 2011
+++ configure.in	Tue Mar  8 16:00:11 2011
@@@@ -1565,8 +1565,7 @@@@ DSO_EXPORTS=""
d14 1
a14 1
@@@@ -1712,38 +1711,6 @@@@ if test x"$BLDSHARED" = x"true" ; then
@


1.17
log
@update Samba to 3.5.6; various bugfixes. From maintainer Ian McWilliam.
@
text
@d1 3
a3 3
$OpenBSD: patch-configure_in,v 1.16 2010/07/14 07:20:18 sthen Exp $
--- configure.in.orig	Fri Oct  8 03:41:16 2010
+++ configure.in	Mon Oct 18 21:55:53 2010
d14 1
a14 1
@@@@ -1710,38 +1709,6 @@@@ if test x"$BLDSHARED" = x"true" ; then
@


1.17.2.1
log
@SECURITY UPDATE to samba-3.5.8

Resolves CVE-2011-0719 FD_SET overflow and has bugfixes

ok ajacoutot jasper
@
text
@d1 3
a3 3
$OpenBSD: patch-configure_in,v 1.17 2010/10/18 19:07:19 sthen Exp $
--- configure.in.orig	Sun Mar  6 18:48:05 2011
+++ configure.in	Tue Mar  8 16:00:11 2011
d14 1
a14 1
@@@@ -1712,38 +1711,6 @@@@ if test x"$BLDSHARED" = x"true" ; then
@


1.16
log
@Rather than use Makefile workarounds for the broken shared lib handling,
fix it in configure.in so it can be sent upstream. From Brad, looks ok to
Ian McWilliam (maintainer).
@
text
@d1 4
a4 13
$OpenBSD: patch-configure_in,v 1.15 2010/06/25 17:39:12 sthen Exp $
--- configure.in.orig	Fri Jun 18 08:01:04 2010
+++ configure.in	Wed Jul  7 22:31:10 2010
@@@@ -761,7 +761,7 @@@@ if test x$enable_cups != xno; then
 		ac_save_PRINT_LIBS=$PRINT_LIBS
 		CFLAGS="$CFLAGS `$CUPS_CONFIG --cflags`"
 		LDFLAGS="$LDFLAGS `$CUPS_CONFIG --ldflags`"
-		PRINT_LIBS="$PRINT_LIBS -lcups"
+		PRINT_LIBS="$PRINT_LIBS `$CUPS_CONFIG --libs`"
 		AC_CHECK_HEADERS(cups/cups.h cups/language.h)
 		if test x"$ac_cv_header_cups_cups_h" = xyes -a \
 		        x"$ac_cv_header_cups_language_h" = xyes; then
@@@@ -1559,8 +1559,7 @@@@ DSO_EXPORTS=""
d14 1
a14 1
@@@@ -1704,38 +1703,6 @@@@ if test x"$BLDSHARED" = x"true" ; then
@


1.15
log
@update to 3.5.4, from new maintainer, Ian McWilliam.
@
text
@d1 3
a3 3
$OpenBSD: patch-configure_in,v 1.14 2010/05/20 18:16:39 sthen Exp $
--- configure.in.orig	Fri Jun 18 22:01:04 2010
+++ configure.in	Thu Jun 24 00:11:56 2010
d13 49
@


1.14
log
@Update to 3.5.3, from Ian McWilliam
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.13 2010/04/26 17:31:57 sthen Exp $
--- configure.in.orig	Mon May 17 21:51:23 2010
+++ configure.in	Wed May 19 23:42:29 2010
@@@@ -749,7 +749,7 @@@@ if test x$enable_cups != xno; then
@


1.13
log
@update Samba to 3.5.2, most of the work done by Ian McWilliam

Note that the default passdb backend has been changed to 'tdbsam'.
See /usr/local/share/doc/samba/README.OpenBSD (or files/README.OpenBSD)
for more information and instructions for people who wish to convert an
existing smbpasswd-based installation.
@
text
@d1 4
a4 4
$OpenBSD$
--- configure.in.orig	Sat Mar 13 11:29:45 2010
+++ configure.in	Sat Mar 13 11:30:19 2010
@@@@ -750,7 +750,7 @@@@ if test x$enable_cups != xno; then
@


1.12
log
@Update to Samba 3.0.25a.

See http://www.samba.org/samba/history/samba-3.0.25a.html for full details.

SECURITY:

This update fixes the following vulnerabilites:
CVE-2007-2444, CVE-2007-2446, CVE-2007-2447.
@
text
@d1 12
a12 11
$OpenBSD: patch-configure_in,v 1.11 2007/04/06 14:20:35 ajacoutot Exp $
--- configure.in.orig	Sun Feb  4 19:59:28 2007
+++ configure.in	Fri Apr  6 14:47:46 2007
@@@@ -1706,6 +1706,7 @@@@ if test "$enable_shared" = "yes"; then
 			DYNEXP="-Wl,-Bdynamic"
 			SONAMEFLAG="-Wl,-soname,"
 			PICFLAGS="-fPIC"
+			SHLIBEXT="so"
 			AC_DEFINE(STAT_ST_BLOCKSIZE,512,[The size of a block])
 			AC_DEFINE(BROKEN_GETGRNAM,1,[Does getgrnam work correctly])
 			;;
@


1.11
log
@- don't use hardcoded paths in swat man page
- regen patches while here

"if it works for you" mbalmer@@
@
text
@d1 1
a1 1
$OpenBSD: patch-configure_in,v 1.10 2006/10/03 14:07:10 mbalmer Exp $
@


1.10
log
@Update to Samba-3.0.23c.  Tested on various platforms and also with local
KDE clients (Konqueror).

ok brad
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.9 2006/02/02 09:40:43 mbalmer Exp $
--- configure.in.orig	Fri Jul 21 18:22:57 2006
+++ configure.in	Mon Oct  2 18:38:41 2006
@@@@ -1710,6 +1710,7 @@@@ if test "$enable_shared" = "yes"; then
@


1.9
log
@Update to Samba 3.0.21b.

requested by and ok brad@@
@
text
@d1 4
a4 4
$OpenBSD$
--- configure.in.orig	Mon Jan 30 15:45:07 2006
+++ configure.in	Tue Jan 31 10:01:18 2006
@@@@ -1449,6 +1449,7 @@@@ if test "$enable_shared" = "yes"; then
@


1.8
log
@Correct filename extensions for shared libraries.

requested by espie@@
@
text
@d2 3
a4 3
--- configure.in.orig	Tue Nov  1 22:37:43 2005
+++ configure.in	Tue Nov  1 22:40:03 2005
@@@@ -1422,6 +1422,7 @@@@ if test "$enable_shared" = "yes"; then
@


1.7
log
@Move Samba 2.2.x into the stable dir. Make room for an eventual port of
the developement branch (3.0).
@
text
@d1 11
a11 11
--- configure.in.orig	Fri Nov  2 22:56:11 2001
+++ configure.in	Fri Nov  2 22:56:36 2001
@@@@ -19,7 +19,7 @@@@
     codepagedir="\$(LIBDIR)/codepages"
     configdir="\$(LIBDIR)"
     lockdir="\$(VARDIR)/locks"
-    logfilebase="\$(VARDIR)"
+    logfilebase="\$(VARDIR)/log"
     privatedir="\${prefix}/private"
     swatdir="\${prefix}/swat")
 
@


1.6
log
@Still need a patch to adjust logfilebase. Found by mpech@@.
@
text
@@


1.5
log
@No more patches required.
@
text
@d1 3
a3 3
--- configure.in.orig	Tue Aug 28 14:20:33 2001
+++ configure.in	Tue Aug 28 14:31:55 2001
@@@@ -18,7 +18,7 @@@@
a11 68
@@@@ -1771,45 +1771,47 @@@@
 AC_ARG_WITH(ssl,
 [  --with-ssl     Include SSL support
   --without-ssl  Don't include SSL support (default)
-  --with-sslinc=DIR Where the SSL includes are (defaults to /usr/local/ssl)],
+  --with-sslinc=DIR Where the SSL headers are (defaults to /usr/local/ssl/include)
+  --with-ssllib=DIR Where the SSL libraries are (defaults to /usr/local/ssl/lib)],
 [ case "$withval" in
   yes)
     AC_MSG_RESULT(yes)
     AC_DEFINE(WITH_SSL)
-    withval="/usr/local/ssl"     # default
+    sslinc="/usr/local/ssl/include" #default
+    ssllib="/usr/local/ssl/lib"     #default
 
     if test "${with_sslinc+set}" = set; then
-
 	withval="$with_sslinc"
 	case "$withval" in
 	yes|no)
-	  echo "configure: warning: --with-sslinc called without argument - will use default" 1>&w
-	  CFLAGS="-I/usr/local/ssl/include $CFLAGS"
-	  LIBS="-lssl -lcrypto $LIBS"
-	  LDFLAGS="=L/usr/local/ssl/lib $LDFLAGS"
+          AC_MSG_WARN(--with-sslinc called without argument - will use default)
 	;;
         * )
-          CFLAGS="-I${withval} $CFLAGS"
-	  LIBS="-lssl -lcrypto $LIBS"
-  	  LDFLAGS="-L${withval}/lib $LDFLAGS"
+          sslinc="${withval}"
 	;;
 	esac
+    fi
 
-    else
-
-	CFLAGS="-I/usr/local/ssl/include $CFLAGS"   
-	LIBS="-lssl -lcrypto $LIBS"
-	LDFLAGS="-L/usr/local/ssl/lib $LDFLAGS"
-
+    if test "${with_ssllib+set}" = set; then
+       withval="$with_ssllib"
+       case "$withval" in
+       yes|no)
+         AC_MSG_WARN(--with-ssllib called without argument - will use default)
+       ;;
+       * )
+         ssllib="${withval}"
+       ;;
+       esac
     fi
 
-    if test ! -d ${withval}; then
-      echo "configure: error: called with --with-ssl, but ssl base directory ${withval} does not exist or is not a directory. Aborting config" 1>&2
-      exit 1
-    fi 
+    CFLAGS="-I${sslinc} $CFLAGS"
+    LIBS="-lssl -lcrypto $LIBS"
+    LDFLAGS="-L${ssllib} $LDFLAGS"
 
     CFLAGS="-DHAVE_CRYPT_DECL $CFLAGS"  # Damn, SSLeay defines its own
 
+    echo "OpenSSL headers path: ${sslinc}"
+    echo "OpenSSL libraries path: ${ssllib}"
     ;;
   *)
     AC_MSG_RESULT(no)
@


1.4
log
@Update to 2.2.1a. Remove one patch (part of the originial distribution now),
ignore obsolete textdocs.
@
text
@@


1.3
log
@Fix log directory. From mpech@@ and form@@. Update to 2.2.1a is coming soon
(tired slacker just got home).
@
text
@d1 3
a3 4
$OpenBSD: patch-configure_in,v 1.2 2001/05/16 00:59:48 matt Exp $
--- configure.in.orig	Tue Apr 17 08:44:30 2001
+++ configure.in	Mon Aug 13 10:49:39 2001
@@@@ -18,7 +18,7 @@@@ AC_ARG_WITH(fhs, [  --with-fhs          
d12 1
a12 11
@@@@ -123,9 +123,6 @@@@ AC_SUBST(WRAP32)
 AC_SUBST(PICFLAG)
 AC_SUBST(SHLIBEXT)
 
-# compile with optimization and without debugging by default
-CFLAGS="-O ${CFLAGS}"
-
 AC_ARG_ENABLE(debug, [  --enable-debug        turn on debugging [default=no]],
     [if eval "test x$enable_debug = xyes"; then
 	CFLAGS="${CFLAGS} -g"
@@@@ -1707,45 +1704,47 @@@@ AC_MSG_CHECKING(whether to use SSL)
d24 2
a25 2
+    sslinc="/usr/local/ssl/include"	#default
+    ssllib="/usr/local/ssl/lib"		#default
d36 1
a36 1
+	  AC_MSG_WARN(--with-sslinc called without argument - will use default)
d39 1
a39 1
-          CFLAGS="-I${withval}/include $CFLAGS"
d42 1
a42 1
+	  sslinc="${withval}"
d54 9
a62 9
+	withval="$with_ssllib"
+	case "$withval" in
+	yes|no)
+	  AC_MSG_WARN(--with-ssllib called without argument - will use default)
+	;;
+	* )
+	  ssllib="${withval}"
+	;;
+	esac
@


1.2
log
@- update to 2.2.0 (tdb.c patch is from samba CVS to fix a bug), new MAINTAINER (daniel@@benzedrine.cx)
- put daemons in ${PREFIX}/libexec, respect CFLAGS (me)
@
text
@d1 12
a12 3
$OpenBSD: patch-configure_in,v 1.1 2001/04/18 20:50:00 dhartmei Exp $
--- configure.in.orig	Tue Apr 17 01:44:30 2001
+++ configure.in	Wed May  9 12:32:40 2001
@


1.1
log
@Add patch that fixes the brain-damaged behavior of the Samba ports
autoconf script with regard to the SSL support. Now we can atleast compile
in SSL support.
@
text
@d1 14
a14 4
$OpenBSD: update-patches,v 1.4 2001/03/31 22:54:41 espie Exp $
--- configure.in.orig	Tue Apr 25 19:06:39 2000
+++ configure.in	Mon Apr  9 21:49:11 2001
@@@@ -1363,45 +1363,47 @@@@ AC_MSG_CHECKING(whether to use SSL)
d26 2
a27 2
+    sslinc="/usr/local/ssl/include"	# default
+    ssllib="/usr/local/ssl/lib"		# default
d38 1
a38 1
+	   AC_MSG_WARN(--with-sslinc called without argument - will use default)
@

