head	1.2;
access;
symbols
	OPENBSD_5_1_BASE:1.1
	OPENBSD_5_1:1.1.0.2;
locks; strict;
comment	@# @;


1.2
date	2012.02.16.21.36.08;	author sthen;	state dead;
branches;
next	1.1;

1.1
date	2012.01.31.09.12.59;	author sthen;	state Exp;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2012.04.11.14.14.29;	author sthen;	state dead;
branches;
next	;


desc
@@


1.2
log
@Update to samba 3.6.3; various bugfixes. From maintainer Ian McWilliam,
also tested by nigel@@.

This rolls in the DoS fix which we previously handled via a patch.
@
text
@$OpenBSD: patch-smbd_server_c,v 1.1 2012/01/31 09:12:59 sthen Exp $

http://ftp.samba.org/pub/samba/patches/security/samba-3.6.2-CVE-2012-0817.patch

--- smbd/server.c.orig	Tue Oct 18 19:48:48 2011
+++ smbd/server.c	Tue Jan 31 08:45:43 2012
@@@@ -64,6 +64,12 @@@@ static void smbd_set_server_fd(int fd)
 	 * name, default to its address.
 	 */
 
+	if (sconn->client_id.name != NULL &&
+	    sconn->client_id.name != sconn->client_id.addr) {
+		talloc_free(discard_const_p(char, sconn->client_id.name));
+		sconn->client_id.name = NULL;
+	}
+
 	client_addr(fd, sconn->client_id.addr, sizeof(sconn->client_id.addr));
 
 	name = client_name(sconn->sock);
@


1.1
log
@SECURITY fix for CVE-2012-0817, memory leak affecting samba 3.6.0 to 3.6.2
can cause DoS. Pointed out by maintainer.

http://ftp.samba.org/pub/samba/patches/security/samba-3.6.2-CVE-2012-0817.patch

ok ajacoutot@@
@
text
@d1 1
a1 1
$OpenBSD$
@


1.1.2.1
log
@MFC samba update to 5.1-stable. From Ian McWilliam.

*NASTY* security update to samba 3.6.4: remote code execution as root by
anonymous user.  https://www.samba.org/samba/security/CVE-2012-1182
@
text
@d1 1
a1 1
$OpenBSD: patch-smbd_server_c,v 1.1 2012/01/31 09:12:59 sthen Exp $
@


