head	1.5;
access;
symbols
	OPENBSD_6_1:1.5.0.4
	OPENBSD_6_1_BASE:1.5
	OPENBSD_6_0:1.5.0.2
	OPENBSD_6_0_BASE:1.5
	OPENBSD_5_9:1.3.0.2
	OPENBSD_5_9_BASE:1.3;
locks; strict;
comment	@# @;


1.5
date	2016.04.22.11.48.36;	author jca;	state Exp;
branches;
next	1.4;
commitid	i7xEeasW0hmVMIQY;

1.4
date	2016.04.12.17.42.09;	author jca;	state Exp;
branches;
next	1.3;
commitid	UGRk8kk9vV3gDO72;

1.3
date	2015.12.23.12.37.21;	author jca;	state Exp;
branches
	1.3.2.1;
next	1.2;
commitid	pugbUhllVsLWHDDm;

1.2
date	2015.09.30.18.14.07;	author jca;	state Exp;
branches;
next	1.1;
commitid	h7lAcXhlCTBN03Tg;

1.1
date	2015.08.25.11.04.39;	author jca;	state Exp;
branches;
next	;
commitid	jWHBCzKs5xKamlhw;

1.3.2.1
date	2016.04.17.17.08.29;	author jca;	state Exp;
branches;
next	;
commitid	ZMnLkV4M50X9F3yT;


desc
@@


1.5
log
@Update to samba-4.4.2

Tests by Vijay Sankar and Ian, ok Ian

This release contains the security fixes introduced by 4.4.2, plus the
new features and improvements from 4.4.0:

  https://www.samba.org/samba/history/samba-4.4.0.html
@
text
@$OpenBSD: patch-lib_ldb_wscript,v 1.4 2016/04/12 17:42:09 jca Exp $

1. Force building standalone library (e.g., put headers in appropriate place).

2. Use -Wl,no-undefined as on other platforms.

--- lib/ldb/wscript.orig	Wed Apr 13 17:18:37 2016
+++ lib/ldb/wscript	Wed Apr 13 17:18:37 2016
@@@@ -53,6 +53,7 @@@@ def configure(conf):
     conf.CONFIG_PATH('LDB_MODULESDIR', conf.SUBST_ENV_VAR('MODULESDIR') + '/ldb')
 
     conf.env.standalone_ldb = conf.IN_LAUNCH_DIR()
+    conf.env.standalone_ldb = True
 
     if not conf.env.standalone_ldb:
         if conf.CHECK_BUNDLED_SYSTEM_PKG('pyldb-util', minversion=VERSION,
@@@@ -73,8 +74,7 @@@@ def configure(conf):
 
         # we don't want any libraries or modules to rely on runtime
         # resolution of symbols
-        if not sys.platform.startswith("openbsd"):
-            conf.ADD_LDFLAGS('-Wl,-no-undefined', testflags=True)
+        conf.ADD_LDFLAGS('-Wl,-no-undefined', testflags=True)
 
     conf.DEFINE('HAVE_CONFIG_H', 1, add_to_cflags=True)
 
@


1.4
log
@Update to samba-4.3.6

i386 build by danj@@, ok sthen@@

The changelog between 4.1.23 and 4.3.6 is too big to be described here.
The point of updating now is that 4.1.x won't receive updates for the
freshly published security advisories.  samba-4.3.8 will follow.
@
text
@d1 1
a1 1
$OpenBSD: patch-lib_ldb_wscript,v 1.3 2015/12/23 12:37:21 jca Exp $
d7 3
a9 3
--- lib/ldb/wscript.orig	Thu Dec 10 10:23:28 2015
+++ lib/ldb/wscript	Sun Apr 10 19:38:17 2016
@@@@ -54,6 +54,7 @@@@ def configure(conf):
d16 2
a17 2
         if conf.CHECK_BUNDLED_SYSTEM_PKG('pyldb-util', minversion=SYSTEM_VERSION,
@@@@ -74,8 +75,7 @@@@ def configure(conf):
@


1.3
log
@SECURITY update to samba-4.1.22; ok Ian McWilliam

ChangeLog and descriptions of the relevant CVE's:

  https://www.samba.org/samba/history/samba-4.1.22.html

This update changed the signature of a few functions in libsamba-util,
so bump the shlib major.  Also update Ian's email adress while here.
@
text
@d1 1
a1 1
$OpenBSD: patch-lib_ldb_wscript,v 1.2 2015/09/30 18:14:07 jca Exp $
d7 3
a9 3
--- lib/ldb/wscript.orig	Fri Dec 18 19:20:42 2015
+++ lib/ldb/wscript	Mon Dec 21 09:09:46 2015
@@@@ -45,6 +45,7 @@@@ def configure(conf):
d16 2
a17 2
         if conf.CHECK_BUNDLED_SYSTEM_PKG('ldb', minversion=SYSTEM_VERSION,
@@@@ -65,8 +66,7 @@@@ def configure(conf):
@


1.3.2.1
log
@Backport SECURITY update to samba-4.3.8

ok sthen@@

Fixes for:

CVE-2015-7560 (Incorrect ACL get/set allowed on symlink path)
CVE-2016-0771 (Out-of-bounds read in internal DNS server)

CVE-2015-5370 (Multiple errors in DCE-RPC code)
CVE-2016-2110 (Man in the middle attacks possible with NTLMSSP)
CVE-2016-2111 (NETLOGON Spoofing Vulnerability)
CVE-2016-2112 (LDAP client and server don't enforce integrity)
CVE-2016-2113 (Missing TLS certificate validation)
CVE-2016-2114 ("server signing = mandatory" not enforced)
CVE-2016-2115 (SMB IPC traffic is not integrity protected)
CVE-2016-2118 (SAMR and LSA man in the middle attacks possible)

CVE-2016-2118 is http://badlock.org/
@
text
@d1 1
a1 1
$OpenBSD: patch-lib_ldb_wscript,v 1.4 2016/04/12 17:42:09 jca Exp $
d7 3
a9 3
--- lib/ldb/wscript.orig	Thu Dec 10 10:23:28 2015
+++ lib/ldb/wscript	Sun Apr 10 19:38:17 2016
@@@@ -54,6 +54,7 @@@@ def configure(conf):
d16 2
a17 2
         if conf.CHECK_BUNDLED_SYSTEM_PKG('pyldb-util', minversion=SYSTEM_VERSION,
@@@@ -74,8 +75,7 @@@@ def configure(conf):
@


1.2
log
@Use -Wl,--no-undefined just like other platforms, -Wl,--as-needed works fine now.

Tested earlier on powerpc (sthen@@), and on i386/amd64.  ok Ian McWilliam.
@
text
@d1 1
a1 1
$OpenBSD: patch-lib_ldb_wscript,v 1.1 2015/08/25 11:04:39 jca Exp $
d7 3
a9 3
--- lib/ldb/wscript.orig	Tue Sep 29 23:55:21 2015
+++ lib/ldb/wscript	Tue Sep 29 23:55:56 2015
@@@@ -44,6 +44,7 @@@@ def configure(conf):
d16 2
a17 2
         if conf.CHECK_BUNDLED_SYSTEM_PKG('ldb', minversion=VERSION,
@@@@ -64,8 +65,7 @@@@ def configure(conf):
@


1.1
log
@Move samba4 to samba, and tweak the ports tree to use it.

ok ajacoutot@@

Upcoming commits will add additional tweaks.

Many thanks to Vadim Zhukov (who did most of the work), Ian McWilliam
(co-maintainer), Stuart Henderson who provided lots of support and
feedback, Antoine Jacoutot who patiently dealt with my broken diffs,
and more generally all the people involved.  Most of the recent work was
done during p2k15 and c2k15.
@
text
@d1 8
a8 4
$OpenBSD: patch-lib_ldb_wscript,v 1.1.1.1 2014/05/04 16:08:29 zhuk Exp $
Force building standalone library (e.g., put headers in apporiate place).
--- lib/ldb/wscript.orig	Mon May 27 16:42:26 2013
+++ lib/ldb/wscript	Mon May 27 20:45:07 2013
d17 10
@

