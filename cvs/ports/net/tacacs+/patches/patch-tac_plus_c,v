head	1.4;
access;
symbols
	OPENBSD_6_0:1.4.0.16
	OPENBSD_6_0_BASE:1.4
	OPENBSD_5_9:1.4.0.12
	OPENBSD_5_9_BASE:1.4
	OPENBSD_5_8:1.4.0.14
	OPENBSD_5_8_BASE:1.4
	OPENBSD_5_7:1.4.0.10
	OPENBSD_5_7_BASE:1.4
	OPENBSD_5_6:1.4.0.8
	OPENBSD_5_6_BASE:1.4
	OPENBSD_5_5:1.4.0.6
	OPENBSD_5_5_BASE:1.4
	OPENBSD_5_4:1.4.0.4
	OPENBSD_5_4_BASE:1.4
	OPENBSD_5_3:1.4.0.2
	OPENBSD_5_3_BASE:1.4
	OPENBSD_5_2:1.2.0.38
	OPENBSD_5_2_BASE:1.2
	OPENBSD_5_1_BASE:1.2
	OPENBSD_5_1:1.2.0.36
	OPENBSD_5_0:1.2.0.34
	OPENBSD_5_0_BASE:1.2
	OPENBSD_4_9:1.2.0.32
	OPENBSD_4_9_BASE:1.2
	OPENBSD_4_8:1.2.0.30
	OPENBSD_4_8_BASE:1.2
	OPENBSD_4_7:1.2.0.28
	OPENBSD_4_7_BASE:1.2
	OPENBSD_4_6:1.2.0.26
	OPENBSD_4_6_BASE:1.2
	OPENBSD_4_5:1.2.0.24
	OPENBSD_4_5_BASE:1.2
	OPENBSD_4_4:1.2.0.22
	OPENBSD_4_4_BASE:1.2
	OPENBSD_4_3:1.2.0.20
	OPENBSD_4_3_BASE:1.2
	OPENBSD_4_2:1.2.0.18
	OPENBSD_4_2_BASE:1.2
	OPENBSD_4_1:1.2.0.16
	OPENBSD_4_1_BASE:1.2
	OPENBSD_4_0:1.2.0.14
	OPENBSD_4_0_BASE:1.2
	OPENBSD_3_9:1.2.0.12
	OPENBSD_3_9_BASE:1.2
	OPENBSD_3_8:1.2.0.10
	OPENBSD_3_8_BASE:1.2
	OPENBSD_3_7:1.2.0.8
	OPENBSD_3_7_BASE:1.2
	OPENBSD_3_6:1.2.0.6
	OPENBSD_3_6_BASE:1.2
	OPENBSD_3_5:1.2.0.4
	OPENBSD_3_5_BASE:1.2
	OPENBSD_3_4:1.2.0.2
	OPENBSD_3_4_BASE:1.2
	OPENBSD_3_3:1.1.1.1.0.8
	OPENBSD_3_3_BASE:1.1.1.1
	OPENBSD_3_2:1.1.1.1.0.6
	OPENBSD_3_2_BASE:1.1.1.1
	OPENBSD_3_1:1.1.1.1.0.4
	OPENBSD_3_1_BASE:1.1.1.1
	OPENBSD_3_0:1.1.1.1.0.2
	OPENBSD_3_0_BASE:1.1.1.1
	OPENBSD_2_9_TRACKING_SWITCH:1.1.1.1
	jeff-bachtel_2001-Jul-29:1.1.1.1
	jsyn:1.1.1;
locks; strict;
comment	@# @;


1.4
date	2012.09.11.12.45.44;	author sthen;	state Exp;
branches;
next	1.3;

1.3
date	2012.09.11.12.29.56;	author sthen;	state Exp;
branches;
next	1.2;

1.2
date	2003.06.09.07.19.30;	author sturm;	state Exp;
branches;
next	1.1;

1.1
date	2001.07.30.05.18.07;	author jsyn;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2001.07.30.05.18.07;	author jsyn;	state Exp;
branches;
next	;


desc
@@


1.4
log
@lp64 header fixes for tacacs+, pointed out by Sascha Retzki on ports@@
@
text
@$OpenBSD: patch-tac_plus_c,v 1.3 2012/09/11 12:29:56 sthen Exp $
--- tac_plus.c.orig	Sun Jun 18 18:26:53 2000
+++ tac_plus.c	Tue Sep 11 13:36:10 2012
@@@@ -24,6 +24,9 @@@@
  * FITNESS FOR A PARTICULAR PURPOSE.
 */
 
+#include <arpa/inet.h>
+#include <grp.h>
+
 #include "tac_plus.h"
 #include "sys/wait.h"
 #include "signal.h"
@@@@ -194,6 +197,8 @@@@ main(argc, argv)
 int argc;
 char **argv;
 {
+    struct passwd *pw;
+    struct group *gr;
     extern char *optarg;
     int childpid;
     int c;
@@@@ -426,16 +431,22 @@@@ char **argv;
 	report(LOG_ERR, "Cannot write pid to %s %s", 
 	       pidfilebuf, sys_errlist[errno]);
 
-#ifdef TAC_PLUS_GROUPID
-    if (setgid(TAC_PLUS_GROUPID))
-	report(LOG_ERR, "Cannot set group id to %d %s", 
-	       TAC_PLUS_GROUPID, sys_errlist[errno]);
+#ifdef TAC_PLUS_GROUP
+    gr = getgrnam(TAC_PLUS_GROUP);
+    if (gr == NULL)
+        report(LOG_ERR, "Cannot find group %s", TAC_PLUS_GROUP);
+    if (setgid(gr->gr_gid))
+	report(LOG_ERR, "Cannot set group to %d %s", 
+	       TAC_PLUS_GROUP, sys_errlist[errno]);
 #endif
 
-#ifdef TAC_PLUS_USERID
-    if (setuid(TAC_PLUS_USERID)) 
-	report(LOG_ERR, "Cannot set user id to %d %s", 
-	       TAC_PLUS_USERID, sys_errlist[errno]);
+#ifdef TAC_PLUS_USER
+    pw = getpwnam(TAC_PLUS_USER);
+    if (pw == NULL)
+        report(LOG_ERR, "Cannot find user %s", TAC_PLUS_USER);
+    if (setuid(pw->pw_uid)) 
+	report(LOG_ERR, "Cannot set user to %d %s", 
+	       TAC_PLUS_USER, sys_errlist[errno]);
 #endif
 
 #ifdef MAXSESS
@@@@ -662,6 +673,9 @@@@ version()
 #ifdef NO_PWAGE
     fprintf(stdout,"NO_PWAGE\n");
 #endif
+#ifdef OPENBSD
+    fprintf(stdout,"OPENBSD\n");
+#endif
 #ifdef REAPCHILD
     fprintf(stdout,"REAPCHILD\n");
 #endif
@@@@ -701,14 +715,14 @@@@ version()
 #ifdef SYSV
     fprintf(stdout,"SYSV\n");
 #endif
-#ifdef TAC_PLUS_GROUPID
-    fprintf(stdout,"TAC_PLUS_GROUPID\n");
+#ifdef TAC_PLUS_GROUP
+    fprintf(stdout,"TAC_PLUS_GROUP\n");
 #endif
 #ifdef TAC_PLUS_PORT
     fprintf(stdout,"TAC_PLUS_PORT\n");
 #endif
-#ifdef TAC_PLUS_USERID
-    fprintf(stdout,"TAC_PLUS_USERID\n");
+#ifdef TAC_PLUS_USER
+    fprintf(stdout,"TAC_PLUS_USER\n");
 #endif
 #ifdef TRACE
     fprintf(stdout,"TRACE\n");
@


1.3
log
@regen patch
@
text
@d1 1
a1 1
$OpenBSD: patch-tac_plus_c,v 1.2 2003/06/09 07:19:30 sturm Exp $
d3 1
a3 1
+++ tac_plus.c	Tue Sep 11 13:28:23 2012
d8 1
a8 1
+#include <sys/types.h>
@


1.2
log
@- taken over by Srebrenko Sehic <haver@@insecure.dk>, OK former MAINTAINER
- use SKEY
- after startup, drop privs to user "tacacs"
- set PERMIT_* according to license
@
text
@d1 3
a3 3
$OpenBSD: patch-tac_plus_c,v 1.1.1.1 2001/07/30 05:18:07 jsyn Exp $
--- tac_plus.c.orig	Sun Jun 18 19:26:31 2000
+++ tac_plus.c	Sat Jun  7 16:47:21 2003
a30 6
-#endif
-
-#ifdef TAC_PLUS_USERID
-    if (setuid(TAC_PLUS_USERID)) 
-	report(LOG_ERR, "Cannot set user id to %d %s", 
-	       TAC_PLUS_USERID, sys_errlist[errno]);
d38 6
a43 2
+#endif
+
@


1.1
log
@Initial revision
@
text
@d1 56
a56 4
$OpenBSD$
--- tac_plus.c.orig	Thu Jul 26 01:06:43 2001
+++ tac_plus.c	Thu Jul 26 01:08:12 2001
@@@@ -662,6 +662,9 @@@@ version()
d66 19
@


1.1.1.1
log
@Import of tacacs+-4.0.4a:
--
Cisco's TACACS+ Server

TACACS+ is used for authentication, authorization, and accounting
on Cisco routers. This daemon provides a server for TACACS+ routers.

WWW: http://www.gazi.edu.tr/tacacs/

MAINTAINER= Jeff Bachtel <jeff@@cepheid.org>

+ lots of additional mods
+ pvalchev@@ helped
+ lebel@@ reviewed
@
text
@@
