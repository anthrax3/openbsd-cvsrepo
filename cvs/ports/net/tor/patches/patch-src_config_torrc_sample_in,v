head	1.17;
access;
symbols
	OPENBSD_6_1:1.17.0.2
	OPENBSD_6_1_BASE:1.17
	OPENBSD_6_0:1.16.0.2
	OPENBSD_6_0_BASE:1.16
	OPENBSD_5_9:1.15.0.2
	OPENBSD_5_9_BASE:1.15
	OPENBSD_5_8:1.14.0.4
	OPENBSD_5_8_BASE:1.14
	OPENBSD_5_7:1.13.0.2
	OPENBSD_5_7_BASE:1.13
	OPENBSD_5_6:1.12.0.8
	OPENBSD_5_6_BASE:1.12
	OPENBSD_5_5:1.12.0.6
	OPENBSD_5_5_BASE:1.12
	OPENBSD_5_4:1.12.0.4
	OPENBSD_5_4_BASE:1.12
	OPENBSD_5_3:1.12.0.2
	OPENBSD_5_3_BASE:1.12
	OPENBSD_5_2:1.11.0.4
	OPENBSD_5_2_BASE:1.11
	OPENBSD_5_1_BASE:1.11
	OPENBSD_5_1:1.11.0.2
	OPENBSD_5_0:1.10.0.2
	OPENBSD_5_0_BASE:1.10
	OPENBSD_4_9:1.9.0.4
	OPENBSD_4_9_BASE:1.9
	OPENBSD_4_8:1.9.0.2
	OPENBSD_4_8_BASE:1.9
	OPENBSD_4_7:1.8.0.2
	OPENBSD_4_7_BASE:1.8
	OPENBSD_4_6:1.7.0.4
	OPENBSD_4_6_BASE:1.7
	OPENBSD_4_5:1.7.0.2
	OPENBSD_4_5_BASE:1.7
	OPENBSD_4_4:1.6.0.4
	OPENBSD_4_4_BASE:1.6
	OPENBSD_4_3:1.6.0.2
	OPENBSD_4_3_BASE:1.6
	OPENBSD_4_2:1.5.0.2
	OPENBSD_4_2_BASE:1.5
	OPENBSD_4_1:1.2.0.2
	OPENBSD_4_1_BASE:1.2
	OPENBSD_4_0:1.1.0.2
	OPENBSD_4_0_BASE:1.1;
locks; strict;
comment	@# @;


1.17
date	2016.12.20.22.06.05;	author pascal;	state Exp;
branches;
next	1.16;
commitid	8lb1fvyH03rbSo9t;

1.16
date	2016.05.18.10.14.07;	author pascal;	state Exp;
branches;
next	1.15;
commitid	y8yBPLPMhULszjhi;

1.15
date	2015.11.25.21.04.07;	author pascal;	state Exp;
branches;
next	1.14;
commitid	s4WM9WmwAJhQkvfp;

1.14
date	2015.03.26.21.32.30;	author pascal;	state Exp;
branches;
next	1.13;
commitid	XdVEZShxmsd03Pp4;

1.13
date	2014.10.24.20.14.48;	author pascal;	state Exp;
branches;
next	1.12;
commitid	H8Pv7dNL7DUwDRzV;

1.12
date	2012.11.22.18.37.32;	author pascal;	state Exp;
branches;
next	1.11;

1.11
date	2011.09.07.07.55.41;	author jasper;	state Exp;
branches;
next	1.10;

1.10
date	2011.03.11.06.49.55;	author ajacoutot;	state Exp;
branches
	1.10.2.1;
next	1.9;

1.9
date	2010.03.25.05.35.38;	author benoit;	state Exp;
branches;
next	1.8;

1.8
date	2009.08.10.21.14.44;	author benoit;	state Exp;
branches;
next	1.7;

1.7
date	2008.09.19.21.51.00;	author rui;	state Exp;
branches;
next	1.6;

1.6
date	2007.11.04.08.39.20;	author rui;	state Exp;
branches;
next	1.5;

1.5
date	2007.07.23.16.34.22;	author rui;	state Exp;
branches;
next	1.4;

1.4
date	2007.05.26.17.09.05;	author rui;	state Exp;
branches;
next	1.3;

1.3
date	2007.05.02.18.20.44;	author rui;	state Exp;
branches;
next	1.2;

1.2
date	2006.09.20.22.06.36;	author ray;	state Exp;
branches
	1.2.2.1;
next	1.1;

1.1
date	2006.07.17.19.23.03;	author jcs;	state Exp;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2007.08.15.08.02.56;	author sturm;	state Exp;
branches;
next	;

1.2.2.1
date	2007.08.08.16.16.19;	author ajacoutot;	state Exp;
branches;
next	;

1.10.2.1
date	2011.10.29.16.26.49;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.17
log
@Update to tor 0.2.9.8.  Also fixes CVE-2016-1254.
@
text
@$OpenBSD: patch-src_config_torrc_sample_in,v 1.16 2016/05/18 10:14:07 pascal Exp $
--- src/config/torrc.sample.in.orig	Wed Nov  9 01:25:39 2016
+++ src/config/torrc.sample.in	Mon Dec 19 22:02:13 2016
@@@@ -39,18 +39,18 @@@@
 ## Send every possible message to @@LOCALSTATEDIR@@/log/tor/debug.log
 #Log debug file @@LOCALSTATEDIR@@/log/tor/debug.log
 ## Use the system log instead of Tor's logfiles
-#Log notice syslog
+Log notice syslog
 ## To send all messages to stderr:
 #Log debug stderr
 
 ## Uncomment this to start the process in the background... or use
 ## --runasdaemon 1 on the command line. This is ignored on Windows;
 ## see the FAQ entry if you want Tor to run as an NT service.
-#RunAsDaemon 1
+RunAsDaemon 1
 
 ## The directory for keeping all the keys/etc. By default, we store
 ## things in $HOME/.tor on Unix, and in Application Data\tor on Windows.
-#DataDirectory @@LOCALSTATEDIR@@/lib/tor
+DataDirectory /var/tor
 
 ## The port on which Tor will listen for local connections from Tor
 ## controller applications, as documented in control-spec.txt.
@@@@ -69,10 +69,10 @@@@
 ## HiddenServicePort x y:z says to redirect requests on port x to the
 ## address y:z.
 
-#HiddenServiceDir @@LOCALSTATEDIR@@/lib/tor/hidden_service/
+#HiddenServiceDir @@LOCALSTATEDIR@@/tor/hidden_service/
 #HiddenServicePort 80 127.0.0.1:80
 
-#HiddenServiceDir @@LOCALSTATEDIR@@/lib/tor/other_hidden_service/
+#HiddenServiceDir @@LOCALSTATEDIR@@/tor/other_hidden_service/
 #HiddenServicePort 80 127.0.0.1:80
 #HiddenServicePort 22 127.0.0.1:22
 
@@@@ -184,6 +184,8 @@@@
 ## and any public IPv4 and IPv6 addresses on any interface on the relay.
 ## See the man page entry for ExitPolicyRejectPrivate if you want to allow
 ## "exit enclaving".
+## Revoke privileges
+User _tor
 ##
 #ExitPolicy accept *:6660-6667,reject *:* # allow irc ports on IPv4 and IPv6 but no more
 #ExitPolicy accept *:119 # accept nntp ports on IPv4 and IPv6 as well as default exit policy
@


1.16
log
@Adjust commented-out HiddenServiceDir directives in sample torrc.

from Michael McConville
@
text
@d1 3
a3 3
$OpenBSD: patch-src_config_torrc_sample_in,v 1.15 2015/11/25 21:04:07 pascal Exp $
--- src/config/torrc.sample.in.orig	Fri Nov 13 14:41:38 2015
+++ src/config/torrc.sample.in	Wed May 18 12:06:59 2016
d39 1
a39 1
@@@@ -182,6 +182,8 @@@@
@


1.15
log
@Update to tor 0.2.7.5.  Switch to libevent2 by default, as recommended by
upstream.

Based on diffs from Daniel Jakots.
@
text
@d1 1
a1 1
$OpenBSD: patch-src_config_torrc_sample_in,v 1.14 2015/03/26 21:32:30 pascal Exp $
d3 1
a3 1
+++ src/config/torrc.sample.in	Fri Nov 20 19:45:16 2015
d26 13
@


1.14
log
@Update to next major release 0.2.6.6.

Changes in version 0.2.6.6 - 2015-03-24
  Tor 0.2.6.6 is the first stable release in the 0.2.6 series.

  It adds numerous safety, security, correctness, and performance
  improvements. Client programs can be configured to use more kinds of
  sockets, AutomapHosts works better, the multithreading backend is
  improved, cell transmission is refactored, test coverage is much
  higher, more denial-of-service attacks are handled, guard selection is
  improved to handle long-term guards better, pluggable transports
  should work a bit better, and some annoying hidden service performance
  bugs should be addressed.
@
text
@d1 4
a4 4
$OpenBSD: patch-src_config_torrc_sample_in,v 1.13 2014/10/24 20:14:48 pascal Exp $
--- src/config/torrc.sample.in.orig	Tue Feb 24 16:33:30 2015
+++ src/config/torrc.sample.in	Wed Mar 25 11:33:26 2015
@@@@ -38,18 +38,18 @@@@
d26 4
a29 4
@@@@ -173,6 +173,8 @@@@
 ## For security, by default Tor rejects connections to private (local)
 ## networks, including to your public IP address. See the man page entry
 ## for ExitPolicyRejectPrivate if you want to allow "exit enclaving".
d33 2
a34 2
 #ExitPolicy accept *:6660-6667,reject *:* # allow irc ports but no more
 #ExitPolicy accept *:119 # accept nntp as well as default exit policy
@


1.13
log
@Update to tor 0.2.5.10.
@
text
@d1 3
a3 3
$OpenBSD: patch-src_config_torrc_sample_in,v 1.12 2012/11/22 18:37:32 pascal Exp $
--- src/config/torrc.sample.in.orig	Fri Oct 10 15:06:24 2014
+++ src/config/torrc.sample.in	Fri Oct 24 16:54:52 2014
d26 1
a26 1
@@@@ -172,6 +172,8 @@@@
@


1.12
log
@Update to new major release, Tor 0.2.3.25.

Tor 0.2.3.25, the first stable release in the 0.2.3 branch, features
significantly reduced directory overhead (via microdescriptors),
enormous crypto performance improvements for fast relays on new
enough hardware, a new v3 TLS handshake protocol that can better
resist fingerprinting, support for protocol obfuscation plugins (aka
pluggable transports), better scalability for hidden services, IPv6
support for bridges, performance improvements like allowing clients
to skip the first round-trip on the circuit ("optimistic data") and
refilling token buckets more often, a new "stream isolation" design
to isolate different applications on different circuits, and many
stability, security, and privacy fixes.

Also kill unneeded pthread patch.

Tested by dhill & dcoppa@@.

ok dcoppa@@
@
text
@d1 3
a3 3
$OpenBSD: patch-src_config_torrc_sample_in,v 1.11 2011/09/07 07:55:41 jasper Exp $
--- src/config/torrc.sample.in.orig	Mon Nov 19 22:24:38 2012
+++ src/config/torrc.sample.in	Tue Nov 20 12:58:58 2012
d26 1
a26 1
@@@@ -169,6 +169,8 @@@@
@


1.11
log
@- update to 0.2.2.32

from new maintainer pascal stumpf (rui@@ timed-out too many times)
additional testing from roberth

ok sthen@@
@
text
@d1 4
a4 4
$OpenBSD: patch-src_config_torrc_sample_in,v 1.10 2011/03/11 06:49:55 ajacoutot Exp $
--- src/config/torrc.sample.in.orig	Sat Aug 27 01:10:59 2011
+++ src/config/torrc.sample.in	Wed Sep  7 09:52:35 2011
@@@@ -37,18 +37,18 @@@@ SocksListenAddress 127.0.0.1 # accept connections only
d26 4
a29 4
@@@@ -168,3 +168,5 @@@@ SocksListenAddress 127.0.0.1 # accept connections only
 #BridgeRelay 1
 #ExitPolicy reject *:*
 
d32 3
@


1.10
log
@Bugfix update to tor-0.2.1.30.
* amongst other things, add a tweak to Tor's TLS handshake that makes
relays and bridges that run this new version reachable from Iran.

Add an rc script.

from Pascal Stumpf.
MAINTAINER timeout.
@
text
@d1 3
a3 3
$OpenBSD: patch-src_config_torrc_sample_in,v 1.9 2010/03/25 05:35:38 benoit Exp $
--- src/config/torrc.sample.in.orig	Wed Feb 23 09:25:40 2011
+++ src/config/torrc.sample.in	Mon Mar  7 16:21:17 2011
d26 1
a26 1
@@@@ -154,3 +154,5 @@@@ SocksListenAddress 127.0.0.1 # accept connections only
@


1.10.2.1
log
@sync with 0.2.2.34 from -current, which has some important fixes
@
text
@d1 3
a3 3
$OpenBSD: patch-src_config_torrc_sample_in,v 1.11 2011/09/07 07:55:41 jasper Exp $
--- src/config/torrc.sample.in.orig	Sat Aug 27 01:10:59 2011
+++ src/config/torrc.sample.in	Wed Sep  7 09:52:35 2011
d26 1
a26 1
@@@@ -168,3 +168,5 @@@@ SocksListenAddress 127.0.0.1 # accept connections only
@


1.9
log
@- update tor to 0.2.1.25
- update patches

ok rui@@
@
text
@d1 3
a3 3
$OpenBSD$
--- src/config/torrc.sample.in.orig	Mon May 25 19:38:04 2009
+++ src/config/torrc.sample.in	Mon Aug 10 23:02:40 2009
d26 1
a26 1
@@@@ -154,3 +154,6 @@@@ SocksListenAddress 127.0.0.1 # accept connections only
a31 1
+Group _tor
@


1.8
log
@- update tor to 0.2.1.19
- update patch

ok rui@@, ajacoutot@@
@
text
@d1 1
@


1.7
log
@- update tor to 0.2.0.31.
- addresses two potential anonymity issues.
- starts to fix a bug where in rare cases traffic from one Tor stream gets mixed into another stream.
- fixes a variety of smaller issues.

ok fgsch@@
@
text
@d1 2
a2 3
$OpenBSD: patch-src_config_torrc_sample_in,v 1.6 2007/11/04 08:39:20 rui Exp $
--- src/config/torrc.sample.in.orig	Tue Feb 26 19:56:28 2008
+++ src/config/torrc.sample.in	Tue Aug  5 10:41:00 2008
d25 4
a28 4
@@@@ -134,6 +134,9 @@@@ SocksListenAddress 127.0.0.1 # accept connections only
 #ExitPolicy accept *:119 # accept nntp as well as default exit policy
 #ExitPolicy reject *:* # no exits allowed
 #
a31 3
 ################ This section is just for bridge relays ##############
 #
 ## Bridge relays (or "bridges" ) are Tor relays that aren't listed in the
@


1.6
log
@update tor to 0.1.2.18. Changelog:
http://archives.seul.org/or/announce/Oct-2007/msg00000.html

ok merdely@@
@
text
@d1 4
a4 4
$OpenBSD$
--- src/config/torrc.sample.in.orig	Fri May 25 01:51:41 2007
+++ src/config/torrc.sample.in	Thu Nov  1 13:44:09 2007
@@@@ -43,18 +43,18 @@@@ SocksListenAddress 127.0.0.1 # accept connections only
d26 1
a26 1
@@@@ -142,3 +142,6 @@@@ SocksListenAddress 127.0.0.1 # accept connections only
d29 1
a29 1
 
d33 3
@


1.5
log
@update tor to 0.1.2.15

- fixes several crash bugs
- fixes some anonymity-related problems
- fixes compilation on BSD
- fixes a variety of other bugs

ok jcs@@
@
text
@d3 1
a3 1
+++ src/config/torrc.sample.in	Mon Jul 23 11:10:44 2007
@


1.4
log
@update tor to 0.1.2.14

ok jcs@@
@
text
@d3 1
a3 1
+++ src/config/torrc.sample.in	Sat May 26 17:03:09 2007
@


1.3
log
@update to tor 0.1.2.13, regen patches while here
ok robert@@
@
text
@d2 2
a3 2
--- src/config/torrc.sample.in.orig	Tue May  1 14:17:58 2007
+++ src/config/torrc.sample.in	Tue May  1 14:19:23 2007
@


1.2
log
@Create data directory for tor.  Also daemonize and log to syslog by
default.

OK maintainer Rui Reis <rui at rui dot cx>
@
text
@d1 4
a4 4
$OpenBSD: patch-src_config_torrc_sample_in,v 1.1 2006/07/17 19:23:03 jcs Exp $
--- src/config/torrc.sample.in.orig	Sat Feb 11 20:12:29 2006
+++ src/config/torrc.sample.in	Wed Sep 20 02:39:38 2006
@@@@ -43,18 +43,18 @@@@ SocksListenAddress 127.0.0.1 # accept co
d26 1
a26 1
@@@@ -137,3 +137,6 @@@@ SocksListenAddress 127.0.0.1 # accept co
d28 1
a28 1
 #ExitPolicy reject *:* # middleman only -- no exits allowed
@


1.2.2.1
log
@MFC (original commit rui@@):
- security update to version 0.1.2.16

ok sturm@@
@
text
@d1 3
a3 3
$OpenBSD: patch-src_config_torrc_sample_in,v 1.2 2006/09/20 22:06:36 ray Exp $
--- src/config/torrc.sample.in.orig	Fri May 25 02:51:41 2007
+++ src/config/torrc.sample.in	Wed Aug  8 17:48:23 2007
d26 1
a26 1
@@@@ -142,3 +142,6 @@@@ SocksListenAddress 127.0.0.1 # accept co
d28 1
a28 1
 #ExitPolicy reject *:* # no exits allowed
@


1.1
log
@update to tor-0.1.1.22, from maintainer

make default config drop privs to _tor user and group
@
text
@d1 25
a25 3
$OpenBSD$
--- src/config/torrc.sample.in.orig	Sat Jul  8 04:36:45 2006
+++ src/config/torrc.sample.in	Sat Jul  8 04:36:46 2006
@


1.1.2.1
log
@MFC (original commit rui@@):
- security update to version 0.1.2.16
@
text
@d1 4
a4 26
$OpenBSD: patch-src_config_torrc_sample_in,v 1.5 2007/07/23 16:34:22 rui Exp $
--- src/config/torrc.sample.in.orig	Fri May 25 02:51:41 2007
+++ src/config/torrc.sample.in	Sun Aug 12 13:27:45 2007
@@@@ -43,18 +43,18 @@@@ SocksListenAddress 127.0.0.1 # accept co
 ## Send every possible message to @@LOCALSTATEDIR@@/log/tor/debug.log
 #Log debug file @@LOCALSTATEDIR@@/log/tor/debug.log
 ## Use the system log instead of Tor's logfiles
-#Log notice syslog
+Log notice syslog
 ## To send all messages to stderr:
 #Log debug stderr
 
 ## Uncomment this to start the process in the background... or use
 ## --runasdaemon 1 on the command line. This is ignored on Windows;
 ## see the FAQ entry if you want Tor to run as an NT service.
-#RunAsDaemon 1
+RunAsDaemon 1
 
 ## The directory for keeping all the keys/etc. By default, we store
 ## things in $HOME/.tor on Unix, and in Application Data\tor on Windows.
-#DataDirectory @@LOCALSTATEDIR@@/lib/tor
+DataDirectory /var/tor
 
 ## The port on which Tor will listen for local connections from Tor
 ## controller applications, as documented in control-spec.txt.
@@@@ -142,3 +142,6 @@@@ SocksListenAddress 127.0.0.1 # accept co
d6 1
a6 1
 #ExitPolicy reject *:* # no exits allowed
@


