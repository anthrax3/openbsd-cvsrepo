head	1.17;
access;
symbols
	OPENBSD_5_2:1.16.0.2
	OPENBSD_5_2_BASE:1.16
	OPENBSD_5_1_BASE:1.15
	OPENBSD_5_1:1.15.0.2
	OPENBSD_5_0:1.12.0.6
	OPENBSD_5_0_BASE:1.12
	OPENBSD_4_9:1.12.0.4
	OPENBSD_4_9_BASE:1.12
	OPENBSD_4_8:1.12.0.2
	OPENBSD_4_8_BASE:1.12
	OPENBSD_4_7:1.11.0.2
	OPENBSD_4_7_BASE:1.11
	OPENBSD_4_6:1.10.0.4
	OPENBSD_4_6_BASE:1.10
	OPENBSD_4_5:1.10.0.2
	OPENBSD_4_5_BASE:1.10
	OPENBSD_4_4:1.7.0.4
	OPENBSD_4_4_BASE:1.7
	OPENBSD_4_3:1.7.0.2
	OPENBSD_4_3_BASE:1.7
	OPENBSD_4_2:1.6.0.2
	OPENBSD_4_2_BASE:1.6
	OPENBSD_4_1:1.3.0.4
	OPENBSD_4_1_BASE:1.3
	OPENBSD_4_0:1.3.0.2
	OPENBSD_4_0_BASE:1.3
	OPENBSD_3_9:1.2.0.6
	OPENBSD_3_9_BASE:1.2
	OPENBSD_3_8:1.2.0.4
	OPENBSD_3_8_BASE:1.2
	OPENBSD_3_7:1.2.0.2
	OPENBSD_3_7_BASE:1.2;
locks; strict;
comment	@# @;


1.17
date	2012.11.22.18.37.32;	author pascal;	state dead;
branches;
next	1.16;

1.16
date	2012.05.26.11.08.44;	author pascal;	state Exp;
branches;
next	1.15;

1.15
date	2011.12.16.20.08.50;	author sthen;	state Exp;
branches
	1.15.2.1;
next	1.14;

1.14
date	2011.09.17.10.39.26;	author sthen;	state Exp;
branches;
next	1.13;

1.13
date	2011.09.08.06.59.15;	author jasper;	state dead;
branches;
next	1.12;

1.12
date	2010.03.25.05.35.38;	author benoit;	state Exp;
branches
	1.12.6.1;
next	1.11;

1.11
date	2009.08.10.21.14.44;	author benoit;	state Exp;
branches;
next	1.10;

1.10
date	2009.01.24.14.53.57;	author rui;	state Exp;
branches;
next	1.9;

1.9
date	2008.12.16.21.04.06;	author rui;	state Exp;
branches;
next	1.8;

1.8
date	2008.09.19.21.51.00;	author rui;	state Exp;
branches;
next	1.7;

1.7
date	2007.11.04.08.39.20;	author rui;	state Exp;
branches;
next	1.6;

1.6
date	2007.07.23.16.34.22;	author rui;	state Exp;
branches;
next	1.5;

1.5
date	2007.05.26.17.09.05;	author rui;	state Exp;
branches;
next	1.4;

1.4
date	2007.05.02.18.20.44;	author rui;	state Exp;
branches;
next	1.3;

1.3
date	2006.06.10.08.33.36;	author steven;	state Exp;
branches
	1.3.2.1
	1.3.4.1;
next	1.2;

1.2
date	2005.01.30.20.20.18;	author naddy;	state Exp;
branches
	1.2.4.1
	1.2.6.1;
next	1.1;

1.1
date	2005.01.03.22.03.00;	author sturm;	state Exp;
branches;
next	;

1.2.4.1
date	2006.06.11.08.23.24;	author sturm;	state Exp;
branches;
next	;

1.2.6.1
date	2006.06.11.08.23.55;	author sturm;	state Exp;
branches;
next	;

1.3.2.1
date	2007.08.15.08.02.56;	author sturm;	state Exp;
branches;
next	;

1.3.4.1
date	2007.08.08.16.16.19;	author ajacoutot;	state Exp;
branches;
next	;

1.12.6.1
date	2011.10.29.16.26.48;	author jasper;	state Exp;
branches;
next	1.12.6.2;

1.12.6.2
date	2011.12.16.20.13.43;	author pascal;	state Exp;
branches;
next	;

1.15.2.1
date	2012.05.26.11.10.27;	author pascal;	state Exp;
branches;
next	;


desc
@@


1.17
log
@Update to new major release, Tor 0.2.3.25.

Tor 0.2.3.25, the first stable release in the 0.2.3 branch, features
significantly reduced directory overhead (via microdescriptors),
enormous crypto performance improvements for fast relays on new
enough hardware, a new v3 TLS handshake protocol that can better
resist fingerprinting, support for protocol obfuscation plugins (aka
pluggable transports), better scalability for hidden services, IPv6
support for bridges, performance improvements like allowing clients
to skip the first round-trip on the circuit ("optimistic data") and
refilling token buckets more often, a new "stream isolation" design
to isolate different applications on different circuits, and many
stability, security, and privacy fixes.

Also kill unneeded pthread patch.

Tested by dhill & dcoppa@@.

ok dcoppa@@
@
text
@$OpenBSD: patch-configure,v 1.16 2012/05/26 11:08:44 pascal Exp $
--- configure.orig	Thu May 24 09:34:53 2012
+++ configure	Sat May 26 12:20:11 2012
@@@@ -5557,8 +5557,8 @@@@ for ac_lib in '' nsl; do
   if test -z "$ac_lib"; then
     ac_res="none required"
   else
-    ac_res=-l$ac_lib
-    LIBS="-l$ac_lib  $ac_func_search_save_LIBS"
+    ac_res=-$ac_lib
+    LIBS="-$ac_lib  $ac_func_search_save_LIBS"
   fi
   if ac_fn_c_try_link "$LINENO"; then :
   ac_cv_search_gethostbyname=$ac_res
@@@@ -5613,8 +5613,8 @@@@ for ac_lib in '' dl; do
   if test -z "$ac_lib"; then
     ac_res="none required"
   else
-    ac_res=-l$ac_lib
-    LIBS="-l$ac_lib  $ac_func_search_save_LIBS"
+    ac_res=-$ac_lib
+    LIBS="-$ac_lib  $ac_func_search_save_LIBS"
   fi
   if ac_fn_c_try_link "$LINENO"; then :
   ac_cv_search_dlopen=$ac_res
@


1.16
log
@Update to tor 0.2.2.36, including SECURITY fixes and various other bugfixes.

- Never use a bridge or a controller-supplied node as an exit, even
  if its exit policy allows it.
- Only build circuits if we have a sufficient threshold of the total
  descriptors that are marked in the consensus with the "Exit"
  flag.
- Provide controllers with a safer way to implement the cookie
  authentication mechanism. With the old method, if another locally
  running program could convince a controller that it was the Tor
  process, then that program could trick the contoller into telling
  it the contents of an arbitrary 32-byte file. The new "SAFECOOKIE"
  authentication method uses a challenge-response approach to prevent
  this attack.

We are not affected by the openssl vulnerability.

Full release notes:
https://gitweb.torproject.org/tor.git/blob/release-0.2.2:/ReleaseNotes

ok sthen@@ jasper@@
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.15 2011/12/16 20:08:50 sthen Exp $
@


1.15
log
@SECURITY update to tor 0.2.2.35

  "Tor 0.2.2.35 fixes a critical heap-overflow security issue in Tor's
  buffers code. Absolutely everybody should upgrade."

More info https://gitweb.torproject.org/tor.git/blob/release-0.2.2:/ReleaseNotes
OK pascal@@ (maintainer)
@
text
@d1 4
a4 4
$OpenBSD: patch-configure,v 1.14 2011/09/17 10:39:26 sthen Exp $
--- configure.orig	Thu Dec 15 17:01:54 2011
+++ configure	Fri Dec 16 19:49:38 2011
@@@@ -5532,8 +5532,8 @@@@ for ac_lib in '' nsl; do
d15 1
a15 1
@@@@ -5588,8 +5588,8 @@@@ for ac_lib in '' dl; do
@


1.15.2.1
log
@MFC:

Update to tor 0.2.2.36, including SECURITY fixes and various other bugfixes.

- Never use a bridge or a controller-supplied node as an exit, even
  if its exit policy allows it.
- Only build circuits if we have a sufficient threshold of the total
  descriptors that are marked in the consensus with the "Exit"
  flag.
- Provide controllers with a safer way to implement the cookie
  authentication mechanism. With the old method, if another locally
  running program could convince a controller that it was the Tor
  process, then that program could trick the contoller into telling
  it the contents of an arbitrary 32-byte file. The new "SAFECOOKIE"
  authentication method uses a challenge-response approach to prevent
  this attack.

We are not affected by the openssl vulnerability.

Full release notes:
https://gitweb.torproject.org/tor.git/blob/release-0.2.2:/ReleaseNotes

ok sthen@@ jasper@@
@
text
@d1 4
a4 4
$OpenBSD: patch-configure,v 1.15 2011/12/16 20:08:50 sthen Exp $
--- configure.orig	Thu May 24 09:34:53 2012
+++ configure	Sat May 26 12:20:11 2012
@@@@ -5557,8 +5557,8 @@@@ for ac_lib in '' nsl; do
d15 1
a15 1
@@@@ -5613,8 +5613,8 @@@@ for ac_lib in '' dl; do
@


1.14
log
@update to tor 0.2.2.33 from maintainer Pascal Stumpf
- fixes several bugs, and includes a slight tweak to Tor's TLS handshake that
  makes relays and bridges that run this new version reachable from Iran again.
@
text
@d1 4
a4 4
$OpenBSD$
--- configure.orig	Sat Sep 17 00:55:21 2011
+++ configure	Sat Sep 17 00:56:22 2011
@@@@ -5511,8 +5511,8 @@@@ for ac_lib in '' pthread; do
d13 3
a15 3
   rm -f conftest.$ac_objext conftest$ac_exeext
 if { (ac_try="$ac_link"
@@@@ -5594,8 +5594,8 @@@@ for ac_lib in '' pthread; do
d24 2
a25 2
   rm -f conftest.$ac_objext conftest$ac_exeext
 if { (ac_try="$ac_link"
@


1.13
log
@zap zap zap

spotted by nigel@@
@
text
@d1 25
a25 12
$OpenBSD: patch-configure,v 1.12 2010/03/25 05:35:38 benoit Exp $
--- configure.orig	Mon Mar 15 23:12:52 2010
+++ configure	Thu Mar 25 06:19:11 2010
@@@@ -19765,7 +19765,7 @@@@ LOCALSTATEDIR=`eval echo $localstatedir`
 # Set CFLAGS _after_ all the above checks, since our warnings are stricter
 # than autoconf's macros like.
 if test "$GCC" = yes; then
-  CFLAGS="$CFLAGS -Wall -g -O2"
+  CFLAGS="$CFLAGS -Wall -g"
   # Disable GCC's strict aliasing checks.  They are an hours-to-debug
   # accident waiting to happen.
   CFLAGS="$CFLAGS -fno-strict-aliasing"
@


1.12
log
@- update tor to 0.2.1.25
- update patches

ok rui@@
@
text
@d1 1
a1 1
$OpenBSD$
@


1.12.6.1
log
@sync with 0.2.2.34 from -current, which has some important fixes
@
text
@d1 12
a12 25
$OpenBSD: patch-configure,v 1.14 2011/09/17 10:39:26 sthen Exp $
--- configure.orig	Sat Sep 17 00:55:21 2011
+++ configure	Sat Sep 17 00:56:22 2011
@@@@ -5511,8 +5511,8 @@@@ for ac_lib in '' pthread; do
   if test -z "$ac_lib"; then
     ac_res="none required"
   else
-    ac_res=-l$ac_lib
-    LIBS="-l$ac_lib  $ac_func_search_save_LIBS"
+    ac_res=-$ac_lib
+    LIBS="-$ac_lib  $ac_func_search_save_LIBS"
   fi
   rm -f conftest.$ac_objext conftest$ac_exeext
 if { (ac_try="$ac_link"
@@@@ -5594,8 +5594,8 @@@@ for ac_lib in '' pthread; do
   if test -z "$ac_lib"; then
     ac_res="none required"
   else
-    ac_res=-l$ac_lib
-    LIBS="-l$ac_lib  $ac_func_search_save_LIBS"
+    ac_res=-$ac_lib
+    LIBS="-$ac_lib  $ac_func_search_save_LIBS"
   fi
   rm -f conftest.$ac_objext conftest$ac_exeext
 if { (ac_try="$ac_link"
@


1.12.6.2
log
@MFC SECURITY update to tor 0.2.2.35, fixing a heap overflow.

ok sthen@@
@
text
@d1 4
a4 4
$OpenBSD: patch-configure,v 1.12.6.1 2011/10/29 16:26:48 jasper Exp $
--- configure.orig	Thu Dec 15 17:01:54 2011
+++ configure	Fri Dec 16 19:49:38 2011
@@@@ -5532,8 +5532,8 @@@@ for ac_lib in '' nsl; do
d13 3
a15 3
   if ac_fn_c_try_link "$LINENO"; then :
   ac_cv_search_gethostbyname=$ac_res
@@@@ -5588,8 +5588,8 @@@@ for ac_lib in '' dl; do
d24 2
a25 2
   if ac_fn_c_try_link "$LINENO"; then :
   ac_cv_search_dlopen=$ac_res
@


1.11
log
@- update tor to 0.2.1.19
- update patch

ok rui@@, ajacoutot@@
@
text
@d1 4
a4 3
--- configure.orig	Tue Jul 28 23:44:16 2009
+++ configure	Mon Aug 10 23:02:40 2009
@@@@ -19708,7 +19708,7 @@@@ LOCALSTATEDIR=`eval echo $localstatedir`
@


1.10
log
@Security: update tor to 0.2.0.33 which fixes an important security-related bug.
Reference: http://secunia.com/Advisories/33635

I got almost the same diff from merdely@@ and robert at openbsd dot pap dot st

ok merdely@@
@
text
@d1 3
a3 4
$OpenBSD: patch-configure,v 1.9 2008/12/16 21:04:06 rui Exp $
--- configure.orig	Wed Jan 21 17:38:09 2009
+++ configure	Sat Jan 24 14:28:28 2009
@@@@ -19472,7 +19472,7 @@@@ LOCALSTATEDIR=`eval echo $localstatedir`
d6 1
a6 1
 if test "$ac_cv_c_compiler_gnu" = yes; then
d8 4
a11 4
+  CFLAGS="$CFLAGS -Wall"
 else
   CFLAGS="$CFLAGS -g -O"
   enable_gcc_warnings=no
@


1.9
log
@SECURITY: update tor to 0.2.0.32 which fixes a major security problem
Reference: http://secunia.com/advisories/33025/

ok jasper@@
@
text
@d1 4
a4 4
$OpenBSD: patch-configure,v 1.8 2008/09/19 21:51:00 rui Exp $
--- configure.orig	Thu Nov 20 22:34:53 2008
+++ configure	Sun Dec 14 14:52:42 2008
@@@@ -19473,7 +19473,7 @@@@ LOCALSTATEDIR=`eval echo $localstatedir`
@


1.8
log
@- update tor to 0.2.0.31.
- addresses two potential anonymity issues.
- starts to fix a bug where in rare cases traffic from one Tor stream gets mixed into another stream.
- fixes a variety of smaller issues.

ok fgsch@@
@
text
@d1 4
a4 4
$OpenBSD$
--- configure.orig	Tue Aug  5 10:42:21 2008
+++ configure	Tue Aug  5 10:42:57 2008
@@@@ -19341,7 +19341,7 @@@@ LOCALSTATEDIR=`eval echo $localstatedir`
@


1.7
log
@update tor to 0.1.2.18. Changelog:
http://archives.seul.org/or/announce/Oct-2007/msg00000.html

ok merdely@@
@
text
@d2 3
a4 3
--- configure.orig	Sun Oct 28 11:18:29 2007
+++ configure	Thu Nov  1 13:44:09 2007
@@@@ -17576,7 +17576,7 @@@@ _ACEOF
d7 1
a7 1
 if test $ac_cv_c_compiler_gnu = yes; then
@


1.6
log
@update tor to 0.1.2.15

- fixes several crash bugs
- fixes some anonymity-related problems
- fixes compilation on BSD
- fixes a variety of other bugs

ok jcs@@
@
text
@d2 2
a3 2
--- configure.orig	Tue Jul 17 21:46:59 2007
+++ configure	Mon Jul 23 11:10:44 2007
@


1.5
log
@update tor to 0.1.2.14

ok jcs@@
@
text
@d2 3
a4 3
--- configure.orig	Fri May 25 01:52:00 2007
+++ configure	Sat May 26 17:03:09 2007
@@@@ -17565,7 +17565,7 @@@@ _ACEOF
@


1.4
log
@update to tor 0.1.2.13, regen patches while here
ok robert@@
@
text
@d2 3
a4 3
--- configure.orig	Tue May  1 14:16:09 2007
+++ configure	Tue May  1 14:17:02 2007
@@@@ -16998,7 +16998,7 @@@@ _ACEOF
@


1.3
log
@SECURITY update to tor 0.1.1.20

fixes CVE-2006-0414

for details, see http://secunia.com/advisories/18576/
@
text
@d1 4
a4 4
$OpenBSD: patch-configure,v 1.2 2005/01/30 20:20:18 naddy Exp $
--- configure.orig	Thu Jun  8 18:56:35 2006
+++ configure	Thu Jun  8 18:58:11 2006
@@@@ -15199,7 +15199,7 @@@@ _ACEOF
d12 1
a12 1
 fi
@


1.3.2.1
log
@MFC (original commit rui@@):
- security update to version 0.1.2.16
@
text
@d1 4
a4 4
$OpenBSD: patch-configure,v 1.3 2006/06/10 08:33:36 steven Exp $
--- configure.orig	Thu Aug  2 06:39:43 2007
+++ configure	Sun Aug 12 13:26:03 2007
@@@@ -17576,7 +17576,7 @@@@ _ACEOF
d12 1
a12 1
   enable_gcc_warnings=no
@


1.3.4.1
log
@MFC (original commit rui@@):
- security update to version 0.1.2.16

ok sturm@@
@
text
@d1 4
a4 4
$OpenBSD: patch-configure,v 1.3 2006/06/10 08:33:36 steven Exp $
--- configure.orig	Thu Aug  2 06:39:43 2007
+++ configure	Wed Aug  8 14:21:17 2007
@@@@ -17576,7 +17576,7 @@@@ _ACEOF
d12 1
a12 1
   enable_gcc_warnings=no
@


1.2
log
@update to 0.0.9.3; based on submission from Jon Trembley <jon@@brain-box.net>
@
text
@d1 4
a4 5
$OpenBSD$
--- configure.orig	Sun Jan 30 21:05:20 2005
+++ configure	Sun Jan 30 21:06:03 2005
@@@@ -10713,7 +10713,7 @@@@ LOCALSTATEDIR=`eval echo $localstatedir`
 
d7 6
a12 5
-CFLAGS="$CFLAGS -Wall -g -O2"
+#CFLAGS="$CFLAGS -Wall -g -O2"
 # Add some more warnings which we use in the cvs version but not in the
 # released versions.  (Some relevant gcc versions can't handle these.)
 #CFLAGS="$CFLAGS -W -Wno-unused-parameter -Wfloat-equal -Wundef -Wpointer-arith -Wstrict-prototypes -Wmissing-prototypes -Wwrite-strings -Wredundant-decls"
@


1.2.6.1
log
@MFC:
SECURITY update to tor 0.1.1.20

fixes CVE-2006-0414

for details, see http://secunia.com/advisories/18576/
@
text
@d1 5
a5 4
$OpenBSD: patch-configure,v 1.3 2006/06/10 08:33:36 steven Exp $
--- configure.orig	Thu Jun  8 18:56:35 2006
+++ configure	Thu Jun  8 18:58:11 2006
@@@@ -15199,7 +15199,7 @@@@ _ACEOF
d8 5
a12 6
 if test $ac_cv_c_compiler_gnu = yes; then
-  CFLAGS="$CFLAGS -Wall -g -O2"
+  CFLAGS="$CFLAGS -Wall"
 else
   CFLAGS="$CFLAGS -g -O"
 fi
@


1.2.4.1
log
@MFC:
SECURITY update to tor 0.1.1.20

fixes CVE-2006-0414

for details, see http://secunia.com/advisories/18576/
@
text
@d1 5
a5 4
$OpenBSD: patch-configure,v 1.3 2006/06/10 08:33:36 steven Exp $
--- configure.orig	Thu Jun  8 18:56:35 2006
+++ configure	Thu Jun  8 18:58:11 2006
@@@@ -15199,7 +15199,7 @@@@ _ACEOF
d8 5
a12 6
 if test $ac_cv_c_compiler_gnu = yes; then
-  CFLAGS="$CFLAGS -Wall -g -O2"
+  CFLAGS="$CFLAGS -Wall"
 else
   CFLAGS="$CFLAGS -g -O"
 fi
@


1.1
log
@update to tor 0.0.9.1

mostly from Jon Trembley <jon at brain-box.net>
@
text
@d1 3
a3 19
--- configure.orig	Wed Dec 15 20:45:59 2004
+++ configure	Mon Jan  3 20:57:38 2005
@@@@ -2270,13 +2270,13 @@@@ if test "$ac_test_CFLAGS" = set; then
   CFLAGS=$ac_save_CFLAGS
 elif test $ac_cv_prog_cc_g = yes; then
   if test "$GCC" = yes; then
-    CFLAGS="-g -O2"
+    CFLAGS=""
   else
-    CFLAGS="-g"
+    CFLAGS=""
   fi
 else
   if test "$GCC" = yes; then
-    CFLAGS="-O2"
+    CFLAGS=""
   else
     CFLAGS=
   fi
d9 1
a9 1
+CFLAGS="$CFLAGS -Wall"
@

