head	1.8;
access;
symbols
	OPENBSD_6_1:1.7.0.12
	OPENBSD_6_1_BASE:1.7
	OPENBSD_6_0:1.7.0.10
	OPENBSD_6_0_BASE:1.7
	OPENBSD_5_9:1.7.0.6
	OPENBSD_5_9_BASE:1.7
	OPENBSD_5_8:1.7.0.8
	OPENBSD_5_8_BASE:1.7
	OPENBSD_5_7:1.7.0.4
	OPENBSD_5_7_BASE:1.7
	OPENBSD_5_6:1.7.0.2
	OPENBSD_5_6_BASE:1.7
	OPENBSD_5_5:1.6.0.2
	OPENBSD_5_5_BASE:1.6
	OPENBSD_5_4:1.5.0.16
	OPENBSD_5_4_BASE:1.5
	OPENBSD_5_3:1.5.0.14
	OPENBSD_5_3_BASE:1.5
	OPENBSD_5_2:1.5.0.12
	OPENBSD_5_2_BASE:1.5
	OPENBSD_5_1_BASE:1.5
	OPENBSD_5_1:1.5.0.10
	OPENBSD_5_0:1.5.0.8
	OPENBSD_5_0_BASE:1.5
	OPENBSD_4_9:1.5.0.6
	OPENBSD_4_9_BASE:1.5
	OPENBSD_4_8:1.5.0.4
	OPENBSD_4_8_BASE:1.5
	OPENBSD_4_7:1.5.0.2
	OPENBSD_4_7_BASE:1.5
	OPENBSD_4_6:1.4.0.6
	OPENBSD_4_6_BASE:1.4
	OPENBSD_4_5:1.4.0.4
	OPENBSD_4_5_BASE:1.4
	OPENBSD_4_4:1.4.0.2
	OPENBSD_4_4_BASE:1.4
	OPENBSD_4_3:1.3.0.4
	OPENBSD_4_3_BASE:1.3
	OPENBSD_4_2:1.3.0.2
	OPENBSD_4_2_BASE:1.3
	OPENBSD_4_1:1.2.0.8
	OPENBSD_4_1_BASE:1.2
	OPENBSD_4_0:1.2.0.6
	OPENBSD_4_0_BASE:1.2
	OPENBSD_3_9:1.2.0.4
	OPENBSD_3_9_BASE:1.2
	OPENBSD_3_8:1.2.0.2
	OPENBSD_3_8_BASE:1.2;
locks; strict;
comment	@# @;


1.8
date	2017.04.16.10.38.10;	author sthen;	state Exp;
branches;
next	1.7;
commitid	1f2MtxuPFLs5xG7w;

1.7
date	2014.07.16.21.17.04;	author brad;	state Exp;
branches;
next	1.6;
commitid	bLSrylMZOaYW0Wco;

1.6
date	2013.11.04.21.50.09;	author brad;	state Exp;
branches;
next	1.5;

1.5
date	2009.08.01.09.21.55;	author sthen;	state Exp;
branches;
next	1.4;

1.4
date	2008.03.22.23.06.50;	author sthen;	state Exp;
branches;
next	1.3;

1.3
date	2007.04.01.20.43.59;	author steven;	state Exp;
branches
	1.3.4.1;
next	1.2;

1.2
date	2005.08.11.16.25.13;	author brad;	state Exp;
branches;
next	1.1;

1.1
date	2005.07.24.00.28.33;	author brad;	state Exp;
branches;
next	;

1.3.4.1
date	2008.06.10.04.14.11;	author robert;	state Exp;
branches;
next	;


desc
@@


1.8
log
@Remove the use of -fno-regmove to appease Clang.  From Brad.
@
text
@$OpenBSD: patch-configure_ac,v 1.7 2014/07/16 21:17:04 brad Exp $
--- configure.ac.orig	Tue May  6 06:28:33 2014
+++ configure.ac	Sat Apr 15 17:43:24 2017
@@@@ -100,9 +100,6 @@@@ AM_CONDITIONAL(SILC_X86_64, test x$cpu_x86_64 = xtrue)
 AM_CONDITIONAL(SILC_POWERPC, test x$cpu_ppc = xtrue)
 AM_CONDITIONAL(SILC_IA64, test x$cpu_ia64 = xtrue)
 
-# Control compiler optimizations
-CFLAGS=`echo $CFLAGS | sed 's/-O[ 0123456789s]*//g'`
-
 AC_PROG_CC
 AC_C_INLINE
 AC_C_CONST
@@@@ -485,59 +482,9 @@@@ fi
 ## Compiler and compiler flag checks
 ##
 
-if test "$GCC"; then
-  # GCC specific options
-  if test "x$summary_debug" = "xyes"; then
-    SILC_ADD_CFLAGS(-g)
-  else
-    SILC_ADD_CFLAGS(-g)
-  fi
-  SILC_ADD_CFLAGS(-Wall -finline-functions)
-  SILC_ADD_CFLAGS(-Wno-pointer-sign)
-else
-  # Other compilers
-  case "$target" in
-    alpha*-dec-osf*)
-      SILC_ADD_CFLAGS(-g3)
-      ;;
-    mips*-sgi-irix*)
-      SILC_ADD_CFLAGS(-g3)
-      ;;
-    *)
-      SILC_ADD_CFLAGS(-g)
-      ;;
-  esac
+SILC_ADD_CFLAGS(-Wall -finline-functions)
+SILC_ADD_CFLAGS(-Wno-pointer-sign)
 
-  # Intel C++ Compiler needs -restrict
-  if test "x$CC" = "xicc"; then
-    SILC_ADD_CFLAGS(-restrict)
-  fi
-fi
-
-if test x$want_cc_optimizations = xtrue; then
-  if test "$GCC"; then
-    # GCC specific options
-    if test "x$summary_debug" = "xyes"; then
-      SILC_ADD_CFLAGS(-O)
-    else
-      SILC_ADD_CFLAGS(-O2)
-    fi
-  else
-    # Other compilers
-    case "$target" in
-      alpha*-dec-osf*)
-        SILC_ADD_CFLAGS(-O2, SILC_ADD_CFLAGS(-O))
-        ;;
-      mips*-sgi-irix*)
-        SILC_ADD_CFLAGS(-O2, SILC_ADD_CFLAGS(-O))
-        ;;
-      *)
-        SILC_ADD_CFLAGS(-O2, SILC_ADD_CFLAGS(-O))
-        ;;
-    esac
-  fi
-fi
-
 #
 # Workaround a bug in GCC 2.x which causes memory exhaustion
 # when compiling sha1 with optimizations on UltraSPARC.
@@@@ -593,55 +540,6 @@@@ AC_DEFINE_UNQUOTED([SILC_DOCDIR], "$DOCDIR", [SILC_DOC
 compile_libs=true
 LIBSUBDIR=lib
 
-AC_ARG_WITH(silc-includes,
-  [  --with-silc-includes=DIR SILC Toolkit includes [search in DIR]],
-  [ac_silc_includes="$withval"], [ac_silc_includes="no"])
-AC_ARG_WITH(silc-libs,
-  [  --with-silc-libs=DIR     SILC Toolkit libraries [search in DIR]],
-  [ac_silc_libs="$withval"], [ac_silc_libs="no"])
-
-if test -n "$with_silc_includes" || test -n "$with_silc_libs"; then
-
-  # Manually provided libs
-  if test "$ac_silc_includes" != "no"; then
-    compile_libs=false
-    SILC_LIB_INCLUDES="-I$ac_silc_includes"
-    LIBSUBDIR=
-  fi
-  if test "$ac_silc_libs" != "no"; then
-    compile_libs=false
-    LIBSUBDIR=
-    LDFLAGS="-L$ac_silc_libs $LDFLAGS"
-  else
-    LDFLAGS="-L\$(silc_top_srcdir)/lib $LDFLAGS"
-  fi
-
-  # Check libs to link against
-  f=`$EGREP __SILC_HAVE_PTHREAD $ac_silc_includes/silc.h`
-  if test -n "$f"; then
-    LIBS="$LIBS -lpthread"
-    check_threads=false
-    has_threads=true
-  fi
-  f=`$EGREP __SILC_HAVE_SIM $ac_silc_includes/silc.h`
-  if test -n "$f"; then
-    LIBS="$LIBS -ldl"
-  fi
-
-else
-  # pkg-config check
-  PKG_CHECK_MODULES(SILC, [silc >= 1.1], compile_libs=false, compile_libs=true)
-
-  if test x$compile_libs = xfalse; then
-    LIBSUBDIR=
-    LIBS="$SILC_LIBS $LIBS"
-    CFLAGS="$CFLAGS $SILC_CFLAGS"
-  else
-    LDFLAGS="-L\$(silc_top_srcdir)/lib $LDFLAGS"
-  fi
-fi
-
-
 # SOCKS4 support checking
 #
 SAVE_LIBS="$LIBS"
@@@@ -1309,9 +1207,8 @@@@ case "$host_cpu" in
 esac
 fi
 
-SILC_ADD_CC_FLAGS(SILC_CRYPTO, -fno-regmove)
 if test x$summary_debug = xno -a x$want_cc_optimizations = xtrue; then
-  SILC_ADD_CC_FLAGS(SILC_CRYPTO, -fomit-frame-pointer -O3)
+  SILC_ADD_CC_FLAGS(SILC_CRYPTO, -fomit-frame-pointer)
 fi
 
 AC_SUBST(SILC_CRYPTO_CFLAGS)
@@@@ -1347,7 +1244,6 @@@@ if test x$compile_libs = xtrue; then
 AC_MSG_NOTICE([configuring math library])
 
 if test x$want_cc_optimizations = xtrue; then
-  SILC_ADD_CC_FLAGS(MATH, -O3, SILC_ADD_CC_FLAGS(MATH, -O2))
   SILC_ADD_CC_FLAGS(MATH, -funroll-all-loops)
 fi
 if test x$enable_stack_trace != xyes; then
@


1.7
log
@Update to silc-server 1.1.19.

ok sthen@@
@
text
@d1 1
a1 1
$OpenBSD: patch-configure_ac,v 1.6 2013/11/04 21:50:09 brad Exp $
d3 1
a3 1
+++ configure.ac	Wed Jul 16 12:21:01 2014
d132 3
a134 1
@@@@ -1311,7 +1209,7 @@@@ fi
d136 1
a136 1
 SILC_ADD_CC_FLAGS(SILC_CRYPTO, -fno-regmove)
d143 1
a143 1
@@@@ -1347,7 +1245,6 @@@@ if test x$compile_libs = xtrue; then
@


1.6
log
@Respect CFLAGS throughout the whole build.

ok sthen@@
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_ac,v 1.5 2009/08/01 09:21:55 sthen Exp $
--- configure.ac.orig	Sat Sep 26 16:34:14 2009
+++ configure.ac	Sun Aug 21 01:54:37 2011
@@@@ -97,9 +97,6 @@@@ AM_CONDITIONAL(SILC_X86_64, test x$cpu_x86_64 = xtrue)
d14 1
a14 1
@@@@ -471,59 +468,9 @@@@ fi
d76 1
a76 1
@@@@ -579,55 +526,6 @@@@ AC_DEFINE_UNQUOTED([SILC_DOCDIR], "$DOCDIR", [SILC_DOC
d132 1
a132 1
@@@@ -1291,7 +1189,7 @@@@ fi
d141 1
a141 1
@@@@ -1327,7 +1225,6 @@@@ if test x$compile_libs = xtrue; then
@


1.5
log
@update silc-server to 1.1.17; fixes crashes, upgrading is strongly
recommended. ok Brad (maintainer).
@
text
@d1 3
a3 3
$OpenBSD$
--- configure.ac.orig	Sat Aug  1 10:15:08 2009
+++ configure.ac	Sat Aug  1 10:15:08 2009
d76 1
a76 2
@@@@ -578,55 +525,6 @@@@ AC_DEFINE_UNQUOTED([SILC_DOCDIR], "$DOCDIR", [SILC_DOC
 # SILC library checking
d79 1
a79 1
-
d128 1
a128 1
 
d131 18
@


1.4
log
@SECURITY update: fixes possible buffer overflow in PKCS#1 message decoding.
Version update 1.0 -> 1.1 as tested by several people.
@
text
@d1 4
a4 14
$OpenBSD: patch-configure_ac,v 1.3 2007/04/01 20:43:59 steven Exp $
--- configure.ac.orig	Sun Nov 18 07:37:58 2007
+++ configure.ac	Sat Mar  1 00:11:02 2008
@@@@ -50,6 +50,9 @@@@ case "$target" in
   *-*-netbsd*)
     check_threads=true
     ;;
+  *-*-openbsd*)
+    check_threads=true
+    ;;
   *-*-*bsd*)
     check_threads=false
     ;;
@@@@ -94,9 +97,6 @@@@ AM_CONDITIONAL(SILC_X86_64, test x$cpu_x86_64 = xtrue)
d14 1
a14 1
@@@@ -468,59 +468,9 @@@@ fi
d76 1
a76 1
@@@@ -575,55 +525,6 @@@@ AC_DEFINE_UNQUOTED([SILC_DOCDIR], "$DOCDIR", [SILC_DOC
@


1.3
log
@USE_LIBTOOL, disable-shared, regen patches
@
text
@d1 6
a6 4
$OpenBSD: patch-configure_ac,v 1.2 2005/08/11 16:25:13 brad Exp $
--- configure.ac.orig	Tue Mar  6 22:54:40 2007
+++ configure.ac	Sun Apr  1 22:42:31 2007
@@@@ -51,9 +51,6 @@@@ case "$target" in
d8 9
a16 1
 esac
d24 3
a26 3
@@@@ -305,36 +302,9 @@@@ AC_DEFUN([SILC_ADD_CC_FLAGS],
   unset tmp_CFLAGS
 ])
d31 1
a31 1
-    SILC_ADD_CFLAGS(-g -O)
d33 1
a33 1
-    SILC_ADD_CFLAGS(-g -O2)
d41 1
a41 1
-      SILC_ADD_CFLAGS(-g3 -O2, SILC_ADD_CFLAGS(-g3 -O, SILC_ADD_CFLAGS(-O)))
d44 1
a44 1
-      SILC_ADD_CFLAGS(-g3 -O2, SILC_ADD_CFLAGS(-g3 -O, SILC_ADD_CFLAGS(-O)))
a47 1
-      SILC_ADD_CFLAGS(-O2, SILC_ADD_CFLAGS(-O))
d59 24
d86 1
a86 1
@@@@ -419,51 +389,6 @@@@ AC_DEFINE_UNQUOTED([SILC_DOCDIR], "$DOCDIR", [SILC_DOC
d109 3
a111 1
-    LIBS="$LIBS -L$ac_silc_libs"
d115 1
a115 1
-  f=`$EGREP __SILC_HAVE_PTHREAD $ac_silc_includes/silcincludes.h`
d121 1
a121 1
-  f=`$EGREP __SILC_HAVE_SIM $ac_silc_includes/silcincludes.h`
d128 1
a128 1
-  PKG_CHECK_MODULES(SILC, silc, compile_libs=false, compile_libs=true)
d132 1
a132 1
-    LIBS="$LIBS $SILC_LIBS"
d134 2
a138 1
 AC_SUBST(LIBSUBDIR)
d141 1
@


1.3.4.1
log
@update to 1.1.5;

- fixes portability bugs including a
  remote user-triggerable DoS on strict alignment arch.
- a crash fix from GIT

from William Yodlowsky
@
text
@d1 4
a4 6
$OpenBSD: patch-configure_ac,v 1.4 2008/03/22 23:06:50 sthen Exp $
--- configure.ac.orig	Sun Nov 18 07:37:58 2007
+++ configure.ac	Sat Mar  1 00:11:02 2008
@@@@ -50,6 +50,9 @@@@ case "$target" in
   *-*-netbsd*)
     check_threads=true
d6 1
a6 9
+  *-*-openbsd*)
+    check_threads=true
+    ;;
   *-*-*bsd*)
     check_threads=false
     ;;
@@@@ -94,9 +97,6 @@@@ AM_CONDITIONAL(SILC_X86_64, test x$cpu_x86_64 = xtrue)
 AM_CONDITIONAL(SILC_POWERPC, test x$cpu_ppc = xtrue)
 AM_CONDITIONAL(SILC_IA64, test x$cpu_ia64 = xtrue)
d14 3
a16 3
@@@@ -468,59 +468,9 @@@@ fi
 ## Compiler and compiler flag checks
 ##
d21 1
a21 1
-    SILC_ADD_CFLAGS(-g)
d23 1
a23 1
-    SILC_ADD_CFLAGS(-g)
d31 1
a31 1
-      SILC_ADD_CFLAGS(-g3)
d34 1
a34 1
-      SILC_ADD_CFLAGS(-g3)
d38 1
a49 24
-if test x$want_cc_optimizations = xtrue; then
-  if test "$GCC"; then
-    # GCC specific options
-    if test "x$summary_debug" = "xyes"; then
-      SILC_ADD_CFLAGS(-O)
-    else
-      SILC_ADD_CFLAGS(-O2)
-    fi
-  else
-    # Other compilers
-    case "$target" in
-      alpha*-dec-osf*)
-        SILC_ADD_CFLAGS(-O2, SILC_ADD_CFLAGS(-O))
-        ;;
-      mips*-sgi-irix*)
-        SILC_ADD_CFLAGS(-O2, SILC_ADD_CFLAGS(-O))
-        ;;
-      *)
-        SILC_ADD_CFLAGS(-O2, SILC_ADD_CFLAGS(-O))
-        ;;
-    esac
-  fi
-fi
-
d53 1
a53 1
@@@@ -575,55 +525,6 @@@@ AC_DEFINE_UNQUOTED([SILC_DOCDIR], "$DOCDIR", [SILC_DOC
d76 1
a76 3
-    LDFLAGS="-L$ac_silc_libs $LDFLAGS"
-  else
-    LDFLAGS="-L\$(silc_top_srcdir)/lib $LDFLAGS"
d80 1
a80 1
-  f=`$EGREP __SILC_HAVE_PTHREAD $ac_silc_includes/silc.h`
d86 1
a86 1
-  f=`$EGREP __SILC_HAVE_SIM $ac_silc_includes/silc.h`
d93 1
a93 1
-  PKG_CHECK_MODULES(SILC, [silc >= 1.1], compile_libs=false, compile_libs=true)
d97 1
a97 1
-    LIBS="$SILC_LIBS $LIBS"
a98 2
-  else
-    LDFLAGS="-L\$(silc_top_srcdir)/lib $LDFLAGS"
d102 1
a104 1
 #
@


1.2
log
@fix build if silc-toolkit is already installed and add USE_LIBTOOL

problem noticed by naddy@@
@
text
@d1 3
a3 3
$OpenBSD: patch-configure_ac,v 1.1 2005/07/24 00:28:33 brad Exp $
--- configure.ac.orig	Tue May 10 12:59:04 2005
+++ configure.ac	Thu Aug 11 11:51:29 2005
d53 1
a53 1
@@@@ -419,51 +389,6 @@@@ AC_DEFINE_UNQUOTED([SILC_DOCDIR], "$DOCD
@


1.1
log
@upgrade to silc-server 1.0
@
text
@d1 3
a3 3
$OpenBSD$
--- configure.ac.orig	Mon Jul  4 22:52:15 2005
+++ configure.ac	Mon Jul  4 22:53:28 2005
d14 1
a14 1
@@@@ -305,35 +302,8 @@@@ AC_DEFUN([SILC_ADD_CC_FLAGS],
d41 3
a43 1
-
d49 1
a49 3
+SILC_ADD_CFLAGS(-Wall -finline-functions)
+SILC_ADD_CFLAGS(-Wno-pointer-sign)
 
d52 53
@

