head	1.1;
access;
symbols
	OPENBSD_6_0:1.1.0.4
	OPENBSD_6_0_BASE:1.1
	OPENBSD_5_9:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2016.07.19.14.45.18;	author semarie;	state Exp;
branches
	1.1.2.1;
next	;
commitid	50N8u82v5FEbrLK0;

1.1.2.1
date	2016.07.20.11.12.15;	author jasper;	state Exp;
branches;
next	;
commitid	ZoY0YmBkjB0TCJCQ;


desc
@@


1.1
log
@patch libupnp to not allowing unhandled POSTs to write to the filesystem.
http://www.openwall.com/lists/oss-security/2016/07/18/13

ok naddy@@ sthen@@
@
text
@$OpenBSD$
Don't allow unhandled POSTs to write to the filesystem.
http://www.openwall.com/lists/oss-security/2016/07/18/13
--- upnp/src/genlib/net/http/webserver.c.orig	Tue Jul 19 06:47:12 2016
+++ upnp/src/genlib/net/http/webserver.c	Tue Jul 19 06:47:22 2016
@@@@ -1368,9 +1368,7 @@@@ static int http_RecvPostMessage(
 		if (Fp == NULL)
 			return HTTP_INTERNAL_SERVER_ERROR;
 	} else {
-		Fp = fopen(filename, "wb");
-		if (Fp == NULL)
-			return HTTP_UNAUTHORIZED;
+		return HTTP_NOT_FOUND;
 	}
 	parser->position = POS_ENTITY;
 	do {
@


1.1.2.1
log
@patch libupnp to not allowing unhandled POSTs to write to the filesystem.
http://www.openwall.com/lists/oss-security/2016/07/18/13

original commit by semarie@@
ok sthen@@
@
text
@d1 1
a1 1
$OpenBSD: patch-upnp_src_genlib_net_http_webserver_c,v 1.1 2016/07/19 14:45:18 semarie Exp $
@

