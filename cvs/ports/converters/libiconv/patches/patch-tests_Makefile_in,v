head	1.2;
access;
symbols
	OPENBSD_6_1:1.2.0.22
	OPENBSD_6_1_BASE:1.2
	OPENBSD_6_0:1.2.0.20
	OPENBSD_6_0_BASE:1.2
	OPENBSD_5_9:1.2.0.16
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.2.0.18
	OPENBSD_5_8_BASE:1.2
	OPENBSD_5_7:1.2.0.14
	OPENBSD_5_7_BASE:1.2
	OPENBSD_5_6:1.2.0.12
	OPENBSD_5_6_BASE:1.2
	OPENBSD_5_5:1.2.0.10
	OPENBSD_5_5_BASE:1.2
	OPENBSD_5_4:1.2.0.8
	OPENBSD_5_4_BASE:1.2
	OPENBSD_5_3:1.2.0.6
	OPENBSD_5_3_BASE:1.2
	OPENBSD_5_2:1.2.0.4
	OPENBSD_5_2_BASE:1.2
	OPENBSD_5_1_BASE:1.2
	OPENBSD_5_1:1.2.0.2;
locks; strict;
comment	@# @;


1.2
date	2011.09.03.10.57.07;	author naddy;	state Exp;
branches;
next	1.1;

1.1
date	2011.09.02.15.44.47;	author naddy;	state Exp;
branches;
next	;


desc
@@


1.2
log
@use upstream fix for regression test
@
text
@$OpenBSD: patch-tests_Makefile_in,v 1.1 2011/09/02 15:44:47 naddy Exp $

If SEPARATE_BUILD is enabled,
  check-stateless . FOO
will check for a nonexistent ./FOO.IRREVERSIBLE.TXT and fail to take
$(srcdir)/FOO.IRREVERSIBLE.TXT into consideration.

--- tests/Makefile.in.orig	Wed Nov 24 03:24:03 2010
+++ tests/Makefile.in	Fri Sep  2 22:24:26 2011
@@@@ -128,7 +128,9 @@@@ check : all table-from table-to ../src/iconv_no_i18n t
 	$(srcdir)/check-stateless $(srcdir) CP936
 	$(CC) $(LDFLAGS) $(INCLUDES) $(CFLAGS) $(CPPFLAGS) $(srcdir)/gengb18030z.c ../srclib/libicrt.a -o gengb18030z && \
 	{ cat $(srcdir)/GB18030-BMP.TXT ; ./gengb18030z ; } | sort > GB18030.TXT && \
+	{ test $(srcdir) = . || cp $(srcdir)/GB18030.IRREVERSIBLE.TXT GB18030.IRREVERSIBLE.TXT; } && \
 	$(srcdir)/check-stateless . GB18030 && \
+	{ test $(srcdir) = . || $(RM) GB18030.IRREVERSIBLE.TXT; } && \
 	$(RM) -r gengb18030z@@EXEEXT@@ gengb18030z.dSYM GB18030.TXT
 	$(srcdir)/check-stateful $(srcdir) ISO-2022-CN
 	$(srcdir)/check-stateful $(srcdir) ISO-2022-CN-EXT
@


1.1
log
@maintenance update to 1.14; ok Brad
@
text
@d1 1
a1 1
$OpenBSD$
d8 3
a10 5
--- tests/Makefile.in.orig	Thu Sep  1 21:38:16 2011
+++ tests/Makefile.in	Thu Sep  1 21:42:16 2011
@@@@ -126,7 +126,7 @@@@ check : all table-from table-to ../src/iconv_no_i18n t
 	$(srcdir)/check-stateless $(srcdir) EUC-CN
 	$(srcdir)/check-stateless $(srcdir) GBK
d12 1
a12 2
-	$(CC) $(LDFLAGS) $(INCLUDES) $(CFLAGS) $(CPPFLAGS) $(srcdir)/gengb18030z.c ../srclib/libicrt.a -o gengb18030z && \
+	test $(srcdir) != . && cp $(srcdir)/GB18030.IRREVERSIBLE.TXT . ; $(CC) $(LDFLAGS) $(INCLUDES) $(CFLAGS) $(CPPFLAGS) $(srcdir)/gengb18030z.c ../srclib/libicrt.a -o gengb18030z && \
d14 1
d16 1
d18 2
@

