head	1.5;
access;
symbols
	OPENBSD_6_1:1.5.0.22
	OPENBSD_6_1_BASE:1.5
	OPENBSD_6_0:1.5.0.20
	OPENBSD_6_0_BASE:1.5
	OPENBSD_5_9:1.5.0.16
	OPENBSD_5_9_BASE:1.5
	OPENBSD_5_8:1.5.0.18
	OPENBSD_5_8_BASE:1.5
	OPENBSD_5_7:1.5.0.14
	OPENBSD_5_7_BASE:1.5
	OPENBSD_5_6:1.5.0.12
	OPENBSD_5_6_BASE:1.5
	OPENBSD_5_5:1.5.0.10
	OPENBSD_5_5_BASE:1.5
	OPENBSD_5_4:1.5.0.8
	OPENBSD_5_4_BASE:1.5
	OPENBSD_5_3:1.5.0.6
	OPENBSD_5_3_BASE:1.5
	OPENBSD_5_2:1.5.0.4
	OPENBSD_5_2_BASE:1.5
	OPENBSD_5_1_BASE:1.5
	OPENBSD_5_1:1.5.0.2
	OPENBSD_5_0:1.4.0.6
	OPENBSD_5_0_BASE:1.4
	OPENBSD_4_9:1.4.0.4
	OPENBSD_4_9_BASE:1.4
	OPENBSD_4_8:1.4.0.2
	OPENBSD_4_8_BASE:1.4
	OPENBSD_4_7:1.3.0.4
	OPENBSD_4_7_BASE:1.3
	OPENBSD_4_6:1.3.0.2
	OPENBSD_4_6_BASE:1.3
	OPENBSD_4_5:1.2.0.4
	OPENBSD_4_5_BASE:1.2
	OPENBSD_4_4:1.2.0.2
	OPENBSD_4_4_BASE:1.2
	OPENBSD_4_3:1.1.0.2
	OPENBSD_4_3_BASE:1.1;
locks; strict;
comment	@# @;


1.5
date	2011.09.02.15.44.46;	author naddy;	state Exp;
branches;
next	1.4;

1.4
date	2010.05.28.09.20.40;	author espie;	state Exp;
branches;
next	1.3;

1.3
date	2009.04.24.18.56.49;	author naddy;	state Exp;
branches;
next	1.2;

1.2
date	2008.05.28.20.03.13;	author naddy;	state Exp;
branches;
next	1.1;

1.1
date	2007.08.25.13.51.08;	author naddy;	state Exp;
branches;
next	;


desc
@@


1.5
log
@maintenance update to 1.14; ok Brad
@
text
@$OpenBSD: patch-libcharset_lib_localcharset_c,v 1.4 2010/05/28 09:20:40 espie Exp $
--- libcharset/lib/localcharset.c.orig	Thu Sep  1 18:15:01 2011
+++ libcharset/lib/localcharset.c	Thu Sep  1 18:17:12 2011
@@@@ -232,8 +232,9 @@@@ get_charset_aliases (void)
                           free (old_res_ptr);
                           break;
                         }
-                      strcpy (res_ptr + res_size - (l2 + 1) - (l1 + 1), buf1);
-                      strcpy (res_ptr + res_size - (l2 + 1), buf2);
+                      strlcpy (res_ptr + res_size - (l2 + 1) - (l1 + 1), buf1,
+                        l1 + 1 + l2 + 1 + 1);
+                      strlcpy (res_ptr + res_size - (l2 + 1), buf2, l2 + 1 + 1);
                     }
                   fclose (fp);
                   if (res_size == 0)
@@@@ -352,6 +353,8 @@@@ get_charset_aliases (void)
    If the canonical name cannot be determined, the result is a non-canonical
    name.  */
 
+const char *
+locale_charset (void) __attribute__((visibility ("default")));
 #ifdef STATIC
 STATIC
 #endif
@


1.4
log
@fix mkvtoolnix
@
text
@d1 16
a16 16
$OpenBSD: patch-libcharset_lib_localcharset_c,v 1.3 2009/04/24 18:56:49 naddy Exp $
--- libcharset/lib/localcharset.c.orig	Sun Jan 25 20:04:42 2009
+++ libcharset/lib/localcharset.c	Wed May 12 15:32:44 2010
@@@@ -200,8 +200,9 @@@@ get_charset_aliases (void)
 		    free (old_res_ptr);
 		  break;
 		}
-	      strcpy (res_ptr + res_size - (l2 + 1) - (l1 + 1), buf1);
-	      strcpy (res_ptr + res_size - (l2 + 1), buf2);
+	      strlcpy (res_ptr + res_size - (l2 + 1) - (l1 + 1), buf1,
+		l1 + 1 + l2 + 1 + 1);
+	      strlcpy (res_ptr + res_size - (l2 + 1), buf2, l2 + 1 + 1);
 	    }
 	  fclose (fp);
 	  if (res_size == 0)
@@@@ -319,6 +320,8 @@@@ get_charset_aliases (void)
@


1.3
log
@update to 1.13; from Brad
@
text
@d1 3
a3 3
$OpenBSD: patch-libcharset_lib_localcharset_c,v 1.2 2008/05/28 20:03:13 naddy Exp $
--- libcharset/lib/localcharset.c.orig	Sun Jan 25 14:04:42 2009
+++ libcharset/lib/localcharset.c	Sun Apr 19 23:47:28 2009
d16 9
@


1.2
log
@overdue maintenance update to 1.12; ok brad@@
@
text
@d1 4
a4 4
$OpenBSD: patch-libcharset_lib_localcharset_c,v 1.1 2007/08/25 13:51:08 naddy Exp $
--- libcharset/lib/localcharset.c.orig	Wed Oct 18 13:55:49 2006
+++ libcharset/lib/localcharset.c	Wed May 21 17:55:51 2008
@@@@ -194,8 +194,9 @@@@ get_charset_aliases (void)
@


1.1
log
@strl* fixes corresponding to those in devel/gettext; ok brad
@
text
@d1 5
a5 5
$OpenBSD$
--- libcharset/lib/localcharset.c.orig	Fri Jun 27 14:08:47 2003
+++ libcharset/lib/localcharset.c	Wed Aug  1 19:32:53 2007
@@@@ -186,8 +186,9 @@@@ get_charset_aliases ()
 		  res_size = 0;
@

