head	1.3;
access;
symbols
	OPENBSD_4_2:1.2.0.32
	OPENBSD_4_2_BASE:1.2
	OPENBSD_4_1:1.2.0.30
	OPENBSD_4_1_BASE:1.2
	OPENBSD_4_0:1.2.0.28
	OPENBSD_4_0_BASE:1.2
	OPENBSD_3_9:1.2.0.26
	OPENBSD_3_9_BASE:1.2
	OPENBSD_3_8:1.2.0.24
	OPENBSD_3_8_BASE:1.2
	OPENBSD_3_7:1.2.0.22
	OPENBSD_3_7_BASE:1.2
	OPENBSD_3_6:1.2.0.20
	OPENBSD_3_6_BASE:1.2
	OPENBSD_3_5:1.2.0.18
	OPENBSD_3_5_BASE:1.2
	OPENBSD_3_4:1.2.0.16
	OPENBSD_3_4_BASE:1.2
	OPENBSD_3_3:1.2.0.14
	OPENBSD_3_3_BASE:1.2
	OPENBSD_3_2:1.2.0.12
	OPENBSD_3_2_BASE:1.2
	OPENBSD_3_1:1.2.0.10
	OPENBSD_3_1_BASE:1.2
	OPENBSD_3_0:1.2.0.8
	OPENBSD_3_0_BASE:1.2
	OPENBSD_2_9_TRACKING_SWITCH:1.2
	OPENBSD_2_9:1.2.0.6
	OPENBSD_2_9_BASE:1.2
	OPENBSD_2_8:1.2.0.4
	OPENBSD_2_8_BASE:1.2
	OPENBSD_2_7:1.2.0.2
	OPENBSD_2_7_BASE:1.2
	form_2000-Jan26:1.1.1.1
	form:1.1.1;
locks; strict;
comment	@# @;


1.3
date	2007.10.26.21.41.28;	author jasper;	state dead;
branches;
next	1.2;

1.2
date	2000.02.06.10.41.13;	author form;	state Exp;
branches;
next	1.1;

1.1
date	2000.01.26.11.13.05;	author form;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2000.01.26.11.13.05;	author form;	state Exp;
branches;
next	;


desc
@@


1.3
log
@- use our naming scheme for patches
@
text
@# $OpenBSD: patch-ab,v 1.2 2000/02/06 10:41:13 form Exp $

--- todos.c.orig	Tue Dec 22 05:50:00 1998
+++ todos.c	Sun Feb  6 16:39:32 2000
@@@@ -33,6 +33,7 @@@@
 #include <stdio.h>
 #include <string.h>
 #include <ctype.h>
+#include <unistd.h>
 #include <sys/types.h>
 #include <sys/stat.h>
 #if defined(__MSDOS__) || defined(__OS2__)
@@@@ -55,7 +56,6 @@@@
 char outbuf[NEEDSIZ];
 #endif
 
-extern char *mktemp();
 int RENAME(), decode();
 
 #include "alt2koi8.h"
@@@@ -63,6 +63,9 @@@@
 #include "win2koi8.h"
 #include "koi82win.h"
 
+#ifdef HAVE_MKSTEMP
+int tmpfd;
+#endif
 char tmp_pat[] = "$1489_XXXXXX";
 char tmp_name[256], out_name[256];
 char **table;
@@@@ -251,10 +254,21 @@@@
 	}
 
 	sprintf(tmp_name, "%s%s%s", outdir, *outdir ? "/" : "", tmp_pat);
+#ifdef HAVE_MKSTEMP
+	if ((tmpfd = mkstemp(tmp_name)) < 0) {
+		perror(tmp_name);
+		return 1;
+	}
+	if ((fout = fdopen(tmpfd, WB)) == NULL) {
+		perror(tmp_name);
+		return 1;
+	}
+#else
 	if ((tmpn = mktemp(tmp_name)) == NULL) {
 		perror(tmp_name);
 		return 1;
 	}
+#endif
 
 	while (ac-- > 1) {
 		srcn = av[1];
@@@@ -267,10 +281,12 @@@@
 			perror(srcn);
 			goto usage;
 		}
+#ifndef HAVE_MKSTEMP
 		if ((fout = fopen(tmpn, WB)) == NULL) {
 			perror(tmpn);
 			return 1;
 		}
+#endif
 		if (*outdir) {
 			sprintf(out_name, "%s/%s", outdir, basename(srcn));
 			if (verbose)
@


1.2
log
@fix
@
text
@d1 1
a1 1
# $OpenBSD: $
@


1.1
log
@Initial revision
@
text
@d1 4
a4 2
--- todos.c.orig	Wed Jan 26 16:45:50 2000
+++ todos.c	Wed Jan 26 16:58:07 2000
d41 1
a41 1
+		perror(tmpn);
@


1.1.1.1
log
@Cp866<->koi8-r and cp1251<->koi8-r decoders and font converter acc. to RFC1489
@
text
@@
