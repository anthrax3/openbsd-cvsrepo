head	1.38;
access;
symbols
	OPENBSD_6_1:1.37.0.4
	OPENBSD_6_1_BASE:1.37
	OPENBSD_6_0:1.37.0.2
	OPENBSD_6_0_BASE:1.37
	OPENBSD_5_9:1.36.0.2
	OPENBSD_5_9_BASE:1.36
	OPENBSD_5_8:1.35.0.4
	OPENBSD_5_8_BASE:1.35
	OPENBSD_5_7:1.34.0.2
	OPENBSD_5_7_BASE:1.34
	OPENBSD_5_6:1.32.0.6
	OPENBSD_5_6_BASE:1.32
	OPENBSD_5_5:1.32.0.4
	OPENBSD_5_5_BASE:1.32
	OPENBSD_5_4:1.32.0.2
	OPENBSD_5_4_BASE:1.32
	OPENBSD_5_3:1.28.0.2
	OPENBSD_5_3_BASE:1.28
	OPENBSD_5_2:1.26.0.2
	OPENBSD_5_2_BASE:1.26
	OPENBSD_5_1_BASE:1.25
	OPENBSD_5_1:1.25.0.2
	OPENBSD_5_0:1.23.0.2
	OPENBSD_5_0_BASE:1.23
	OPENBSD_4_9:1.19.0.2
	OPENBSD_4_9_BASE:1.19
	OPENBSD_4_8:1.14.0.2
	OPENBSD_4_8_BASE:1.14
	OPENBSD_4_7:1.13.0.2
	OPENBSD_4_7_BASE:1.13
	OPENBSD_4_6:1.11.0.2
	OPENBSD_4_6_BASE:1.11
	OPENBSD_4_5:1.8.0.2
	OPENBSD_4_5_BASE:1.8
	OPENBSD_4_4:1.7.0.2
	OPENBSD_4_4_BASE:1.7
	OPENBSD_4_3:1.5.0.2
	OPENBSD_4_3_BASE:1.5
	OPENBSD_4_2:1.3.0.2
	OPENBSD_4_2_BASE:1.3
	OPENBSD_4_1:1.2.0.2
	OPENBSD_4_1_BASE:1.2
	jasper_20070111:1.1.1.1
	jasper:1.1.1;
locks; strict;
comment	@# @;


1.38
date	2017.09.14.19.15.23;	author jasper;	state dead;
branches;
next	1.37;
commitid	0GqQf6mDCDWTXZ8M;

1.37
date	2016.03.20.16.12.26;	author naddy;	state Exp;
branches;
next	1.36;
commitid	guiZq8cnNbVyyHzx;

1.36
date	2015.08.27.07.04.35;	author ajacoutot;	state Exp;
branches;
next	1.35;
commitid	Qe4hZDnQIpu92Ebk;

1.35
date	2015.07.18.21.07.40;	author jeremy;	state Exp;
branches;
next	1.34;
commitid	ff3MILYVohdMupuL;

1.34
date	2014.09.08.17.04.51;	author jasper;	state Exp;
branches;
next	1.33;
commitid	NxHFvSOrA2CSWHJM;

1.33
date	2014.08.22.22.21.53;	author kili;	state Exp;
branches;
next	1.32;
commitid	V82zoWOaRELJa7mF;

1.32
date	2013.03.26.18.52.54;	author jeremy;	state Exp;
branches;
next	1.31;

1.31
date	2013.03.20.19.13.50;	author jeremy;	state Exp;
branches;
next	1.30;

1.30
date	2013.03.13.22.50.26;	author ajacoutot;	state Exp;
branches;
next	1.29;

1.29
date	2013.03.11.11.42.41;	author espie;	state Exp;
branches;
next	1.28;

1.28
date	2012.11.30.19.38.09;	author chrisz;	state Exp;
branches;
next	1.27;

1.27
date	2012.09.23.17.09.54;	author jeremy;	state Exp;
branches;
next	1.26;

1.26
date	2012.04.28.10.52.08;	author ajacoutot;	state Exp;
branches;
next	1.25;

1.25
date	2011.09.16.11.41.40;	author espie;	state Exp;
branches;
next	1.24;

1.24
date	2011.09.12.18.02.35;	author naddy;	state Exp;
branches;
next	1.23;

1.23
date	2011.07.19.18.00.16;	author jeremy;	state Exp;
branches;
next	1.22;

1.22
date	2011.07.18.19.06.37;	author naddy;	state Exp;
branches;
next	1.21;

1.21
date	2011.04.08.08.14.16;	author jasper;	state Exp;
branches;
next	1.20;

1.20
date	2011.04.08.06.22.51;	author jasper;	state Exp;
branches;
next	1.19;

1.19
date	2011.01.15.01.09.43;	author naddy;	state Exp;
branches;
next	1.18;

1.18
date	2010.11.26.14.44.27;	author espie;	state Exp;
branches;
next	1.17;

1.17
date	2010.11.24.21.35.15;	author jeremy;	state Exp;
branches;
next	1.16;

1.16
date	2010.11.20.19.56.48;	author espie;	state Exp;
branches;
next	1.15;

1.15
date	2010.09.23.22.14.53;	author jeremy;	state Exp;
branches;
next	1.14;

1.14
date	2010.07.24.23.05.08;	author naddy;	state Exp;
branches;
next	1.13;

1.13
date	2010.02.09.12.18.46;	author jasper;	state Exp;
branches;
next	1.12;

1.12
date	2010.01.27.21.43.28;	author naddy;	state Exp;
branches;
next	1.11;

1.11
date	2009.06.22.17.00.24;	author naddy;	state Exp;
branches;
next	1.10;

1.10
date	2009.06.20.22.05.11;	author avsm;	state Exp;
branches;
next	1.9;

1.9
date	2009.04.03.21.30.50;	author sturm;	state Exp;
branches;
next	1.8;

1.8
date	2009.02.09.20.48.23;	author naddy;	state Exp;
branches;
next	1.7;

1.7
date	2008.07.04.19.57.06;	author naddy;	state Exp;
branches;
next	1.6;

1.6
date	2008.06.14.23.57.19;	author landry;	state Exp;
branches;
next	1.5;

1.5
date	2008.02.22.19.16.49;	author naddy;	state Exp;
branches;
next	1.4;

1.4
date	2007.09.15.20.59.38;	author merdely;	state Exp;
branches;
next	1.3;

1.3
date	2007.07.27.19.17.11;	author naddy;	state Exp;
branches;
next	1.2;

1.2
date	2007.02.14.16.55.28;	author steven;	state Exp;
branches;
next	1.1;

1.1
date	2007.01.11.15.18.43;	author jasper;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2007.01.11.15.18.43;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.38
log
@remove relic from times past; for code searching/indexing tools such
as the silver searcher are a much better alternative these days and don't
require ruby 1.8

prompted by jeremy@@
ok jca@@
@
text
@# $OpenBSD: Makefile,v 1.37 2016/03/20 16:12:26 naddy Exp $

# This architecture lacks fast mutexes...
NOT_FOR_ARCHS=		mips64 mips64el

COMMENT=		source code search engine
DISTNAME=		gonzui-1.2
REVISION=		26
CATEGORIES=		textproc www

HOMEPAGE=		http://gonzui.sourceforge.net/

# GPL
PERMIT_PACKAGE_CDROM=	Yes
WANTLIB=		m

MODULES=		lang/ruby lang/ocaml
MODRUBY_REV=		1.8

MASTER_SITES=		${MASTER_SITE_SOURCEFORGE:=gonzui/}

BUILD_DEPENDS=		databases/db/v4 \
			databases/ruby-bdb,${MODRUBY_FLAVOR} \
			lang/ruby/1.8,-iconv
RUN_DEPENDS=		archivers/bzip2 \
			archivers/unzip \
			archivers/xz \
			databases/db/v4 \
			databases/ruby-bdb,${MODRUBY_FLAVOR} \
			lang/ruby/1.8,-iconv \
			textproc/p5-PPI

MODRUBY_ADJ_FILES=	gonzui-db \
			gonzui-import \
			gonzui-remove \
			gonzui-search \
			gonzui-server \
			gonzui-update

CONFIGURE_STYLE=	gnu
CONFIGURE_ARGS=		--with-user="_gonzui" \
			--with-group="_gonzui" \
			--with-rundir="/var/run/gonzui" \
			--with-logdir="/var/log"

# Tests want to do cvs checkouts, apt-get, etc.
NO_TEST=		Yes

# XXX: Bad, but saves a metric buttload of patches.
pre-configure:
	ln -sf ${RUBY} ${WRKDIR}/bin/ruby

post-install:
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/gonzui/
	${INSTALL_DATA} ${WRKSRC}/gonzuirc.sample \
		${PREFIX}/share/examples/gonzui/

.include <bsd.port.mk>
@


1.37
log
@drop SHARED_ONLY from python and ruby ports
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2015/08/27 07:04:35 ajacoutot Exp $
@


1.36
log
@No point in sampling /var/run/gonzui/; it gets removed at boot.
@
text
@d1 1
a1 3
# $OpenBSD: Makefile,v 1.35 2015/07/18 21:07:40 jeremy Exp $

SHARED_ONLY=		Yes
@


1.35
log
@Remove MODRUBY_ICONV_DEPENDS.  ruby 1.8 specific ports can hard code
the dependency, more modern ports don't need it.

OK ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2014/09/08 17:04:51 jasper Exp $
d10 1
a10 1
REVISION=		25
@


1.34
log
@drop maintainership of ports i haven't used in a long time and have no use for anymore
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2014/08/22 22:21:53 kili Exp $
d26 1
a26 1
			${MODRUBY_ICONV_DEPENDS}
d32 1
a32 1
			${MODRUBY_ICONV_DEPENDS} \
@


1.33
log
@Bump after lang/ocaml pkgname change (first round, more bumps will follow).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2013/03/26 18:52:54 jeremy Exp $
d10 1
a10 1
REVISION=		24
a13 2

MAINTAINER=		Jasper Lievisse Adriaanse <jasper@@openbsd.org>
@


1.32
log
@Bump REVISION as recent ruby.port.mk change modified shebang lines.

OK sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2013/03/20 19:13:50 jeremy Exp $
d10 1
a10 1
REVISION=		23
@


1.31
log
@Make ruby 1.9 the default ruby for non-gem/extconf ports,
for consistency with the gem/extconf ports.

Update non-gem/extconf ports that relied on the previous
default of ruby 1.8 to explicitly specify it.

OK ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2013/03/13 22:50:26 ajacoutot Exp $
d10 1
a10 1
REVISION=		22
@


1.30
log
@No need for MODRUBY_ADJ_REPLACE anymore; MODRUBY_pre-configure take care of
it.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2013/03/11 11:42:41 espie Exp $
d22 1
@


1.29
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2012/11/30 19:38:09 chrisz Exp $
a54 1
	${MODRUBY_ADJ_REPLACE}
@


1.28
log
@update lang/ocaml to 4.00.1.
Let all ocaml ports RUN_DEPEND on the version of ocaml they were built with.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2012/09/23 17:09:54 jeremy Exp $
a18 3
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
d50 1
a50 1
NO_REGRESS=		Yes
@


1.27
log
@Have gonzui depend on the correct FLAVOR of the ruby-bdb dependency.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2012/04/28 10:52:08 ajacoutot Exp $
d10 1
a10 1
REVISION=		21
@


1.26
log
@--localstatedir=/var is the default now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2011/09/16 11:41:40 espie Exp $
d10 1
a10 1
REVISION=		20
d29 1
a29 1
			databases/ruby-bdb \
d35 1
a35 1
			databases/ruby-bdb \
@


1.25
log
@normalize pkgpath
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2011/09/12 18:02:35 naddy Exp $
d50 1
a50 2
			--with-logdir="/var/log" \
			--localstatedir="/var"
@


1.24
log
@bump all (sub)packages that depend on db/v4; requested by and help from espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2011/07/19 18:00:16 jeremy Exp $
d10 1
a10 1
REVISION=		19
@


1.23
log
@Bump after change to remove OpenBSD version from ruby SITEARCHDIR,
and use new MODRUBY_SITEDIR and MODRUBY_SITEARCHDIR variables in
PLIST.

OK landry@@, jcs@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2011/07/18 19:06:37 naddy Exp $
d10 1
a10 1
REVISION=		18
@


1.22
log
@bump revision for plist changes 4.9 -> 5.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2011/04/08 08:14:16 jasper Exp $
d10 1
a10 1
REVISION=		17
@


1.21
log
@- allow gonzui to index (.tar).xz archives too
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2011/04/08 06:22:51 jasper Exp $
d10 1
a10 1
REVISION=		16
@


1.20
log
@- various improvments and cleanups to get this working again:
* add missing run dependencies
* set the correct path to ruby in the gonzui-* scripts
* remove the patches and cheat with pre-configure
* add patches to fix an error with more recent ruby-bdb
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2011/01/15 01:09:43 naddy Exp $
d10 1
a10 1
REVISION=		15
d33 1
@


1.19
log
@bump revision for plist changes 4.8 -> 4.9
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2010/11/26 14:44:27 espie Exp $
d10 1
a10 1
REVISION=		14
d33 3
d38 7
d54 5
@


1.18
log
@default db-* for db/v4 is incorrect, set PKGSPEC=db->=4,<5, bump packages
with erroneous depends.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2010/11/24 21:35:15 jeremy Exp $
d10 1
a10 1
REVISION=		13
@


1.17
log
@REVISION bump all ruby ports due to a change in the pkgspec.
Previously, we were using ruby->=1.8,<=1.9, instead of
ruby->=1.8,<1.9.  While this wouldn't cause an issue, since
our ruby-1.9.2 package isn't included in ruby->=1.8,<=1.9,
it's still wrong and should be fixed.  This also fixes the
following minor issues:

Switch from using FLAVOR to MODRUBY_FLAVOR for *_DEPENDS.
Currently we don't have a ruby port that uses FLAVORs that
would differ from MODRUBY_FLAVOR, but it's possible we will
in the future.

Switch from BASE_PKGPATH to BUILD_PKGPATH in a few cases in
REGRESS_DEPENDS.  This probably is not strictly necessary, but
BUILD_PKGPATH is used in more cases, so it is good for
consistency.

Switch to new style *_DEPENDS, with the version specification
at the end.  The remaining cases where this is not done is
because a specific version is used.

Some FULLPKGNAME added to REGRESS_DEPENDS, to make sure that if
the old version is installed when you run a regress test, it
will install the new version first.

Some conversion of spaces to tabs for consistency.

OK landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2010/11/20 19:56:48 espie Exp $
d10 1
a10 1
REVISION=		12
@


1.16
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2010/09/23 22:14:53 jeremy Exp $
d10 1
a10 1
REVISION=		11
@


1.15
log
@Handle changes caused by splitting the ruby port and bump

OK jcs@@, landry@@, jasper@@, sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2010/07/24 23:05:08 naddy Exp $
d28 2
a29 2
BUILD_DEPENDS=		::databases/db/v4 \
			::databases/ruby-bdb \
d31 3
a33 3
RUN_DEPENDS=		::archivers/bzip2 \
			::archivers/unzip \
			::textproc/p5-PPI
@


1.14
log
@bump PKGNAME for PLIST changes 4.7 -> 4.8
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2010/02/09 12:18:46 jasper Exp $
d10 1
a10 1
REVISION=		10
d30 1
a30 1
			:ruby-iconv->=1.8.4:lang/ruby,-iconv
@


1.13
log
@- extend archtecture tests for mips64el

ok naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2010/01/27 21:43:28 naddy Exp $
d10 1
a10 1
PKGNAME=		${DISTNAME}p9
@


1.12
log
@bump PKGNAME for PLIST changes 4.6 -> 4.7
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2009/06/22 17:00:24 naddy Exp $
d6 1
a6 1
NOT_FOR_ARCHS=		mips64
@


1.11
log
@bump PKGNAME for PLIST changes 4.5 -> 4.6
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2009/06/20 22:05:11 avsm Exp $
d10 1
a10 1
PKGNAME=		${DISTNAME}p8
@


1.10
log
@update to ocaml-3.11.1 and bump dependent package PKGNAMEs
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2009/04/03 21:30:50 sturm Exp $
d10 1
a10 1
PKGNAME=		${DISTNAME}p7
@


1.9
log
@bump after ocaml update
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2009/02/09 20:48:23 naddy Exp $
d10 1
a10 1
PKGNAME=		${DISTNAME}p6
@


1.8
log
@bump PKGNAME for PLIST changes 4.4 -> 4.5
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2008/07/04 19:57:06 naddy Exp $
d10 1
a10 1
PKGNAME=		${DISTNAME}p5
@


1.7
log
@bump PKGNAME for PLIST changes 4.3 -> 4.4
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2008/06/14 23:57:19 landry Exp $
d10 1
a10 1
PKGNAME=		${DISTNAME}p4
@


1.6
log
@bump PKGNAMEs after lang/ruby module change.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2008/02/22 19:16:49 naddy Exp $
d10 1
a10 1
PKGNAME=		${DISTNAME}p3
@


1.5
log
@bump PKGNAME for PLIST changes 4.2 -> 4.3
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2007/09/15 20:59:38 merdely Exp $
d10 1
a10 1
PKGNAME=		${DISTNAME}p2
@


1.4
log
@Remove surrounding quotes in COMMENT-*/PERMIT_*
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2007/07/27 19:17:11 naddy Exp $
d10 1
a10 1
PKGNAME=		${DISTNAME}p1
@


1.3
log
@bump package name to accommodate OpenBSD 4.1 -> 4.2 change in MODRUBY_ARCH
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2007/02/14 16:55:28 steven Exp $
d8 1
a8 1
COMMENT=		"source code search engine"
@


1.2
log
@bump PKGNAME due to PLIST changes after 4.0 -> 4.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2007/01/11 15:18:43 jasper Exp $
d10 1
a10 1
PKGNAME=		${DISTNAME}p0
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d10 1
@


1.1.1.1
log
@import gonzui 1.2

gonzui is a source code search engine. The goal is to help programmers
develop programs effectively by creating a source code search engine,
accessible via the commandline or via a web interface.

lots of help and ok bernd@@
@
text
@@
