head	1.6;
access;
symbols
	OPENBSD_3_8:1.5.0.2
	OPENBSD_3_8_BASE:1.5
	OPENBSD_3_7:1.4.0.6
	OPENBSD_3_7_BASE:1.4
	OPENBSD_3_5:1.4.0.4
	OPENBSD_3_6:1.4.0.2
	OPENBSD_3_3:1.2.0.2
	OPENBSD_3_3_BASE:1.2
	OPENBSD_3_1:1.1.0.4
	OPENBSD_3_2:1.1.0.2;
locks; strict;
comment	@# @;


1.6
date	2005.09.09.17.34.53;	author brad;	state dead;
branches;
next	1.5;

1.5
date	2005.08.10.20.27.25;	author naddy;	state Exp;
branches;
next	1.4;

1.4
date	2004.12.22.17.36.24;	author robert;	state Exp;
branches
	1.4.2.1
	1.4.4.1;
next	1.3;

1.3
date	2003.05.20.00.37.10;	author brad;	state dead;
branches;
next	1.2;

1.2
date	2003.02.12.08.28.20;	author sturm;	state Exp;
branches
	1.2.2.1;
next	1.1;

1.1
date	2002.12.29.23.45.20;	author brad;	state Exp;
branches
	1.1.2.1
	1.1.4.1;
next	;

1.1.2.1
date	2002.12.29.23.57.04;	author brad;	state Exp;
branches;
next	;

1.1.4.1
date	2002.12.30.00.09.30;	author brad;	state Exp;
branches;
next	;

1.2.2.1
date	2003.06.20.00.51.08;	author brad;	state dead;
branches;
next	;

1.4.2.1
date	2004.12.27.12.19.00;	author robert;	state Exp;
branches;
next	;

1.4.4.1
date	2004.12.27.12.21.44;	author robert;	state Exp;
branches;
next	;


desc
@@


1.6
log
@upgrade to xpdf 3.01

Most of the update is from Bernd Ahlers <bernd at ba-net dot org>
@
text
@$OpenBSD: patch-xpdf_GfxState_cc,v 1.5 2005/08/10 20:27:25 naddy Exp $
--- xpdf/GfxState.cc.orig	Thu Jan 22 02:26:45 2004
+++ xpdf/GfxState.cc	Wed Aug 10 22:27:55 2005
@@@@ -708,6 +708,11 @@@@ GfxColorSpace *GfxICCBasedColorSpace::pa
   }
   nCompsA = obj2.getInt();
   obj2.free();
+  if (nCompsA > gfxColorMaxComps) {
+    error(-1, "ICCBased color space with too many (%d > %d) components",
+	  nCompsA, gfxColorMaxComps);
+    nCompsA = gfxColorMaxComps;
+  }
   if (dict->lookup("Alternate", &obj2)->isNull() ||
       !(altA = GfxColorSpace::parse(&obj2))) {
     switch (nCompsA) {
@@@@ -1054,7 +1059,7 @@@@ GfxColorSpace *GfxDeviceNColorSpace::par
   }
   nCompsA = obj1.arrayGetLength();
   if (nCompsA > gfxColorMaxComps) {
-    error(-1, "DeviceN color space with more than %d > %d components",
+    error(-1, "DeviceN color space with too many (%d > %d) components",
 	  nCompsA, gfxColorMaxComps);
     nCompsA = gfxColorMaxComps;
   }
@


1.5
log
@sync patches
@
text
@d1 1
a1 1
$OpenBSD: patch-xpdf_GfxState_cc,v 1.4 2004/12/22 17:36:24 robert Exp $
@


1.4
log
@SECURITY:
fix a buffer overflow vulnerability; bump PKGNAME; use autoconf-2.59

ok MAINTAINER (brad@@)
@
text
@d1 1
a1 1
$OpenBSD$
d3 2
a4 2
+++ xpdf/GfxState.cc	Wed Dec 22 12:59:33 2004
@@@@ -708,6 +708,11 @@@@
d16 1
a16 1
@@@@ -1054,7 +1059,7 @@@@
@


1.4.4.1
log
@SECURITY:
fixed integer overflows:
http://www.vuxml.org/openbsd/d79a032a-2763-11d9-a0f4-00065bd5b0b6.html

fixed buffer overflow vulnerability:
http://www.vuxml.org/openbsd/9317ac06-5441-11d9-8ad2-00065bd5b0b6.html

ok brad@@
@
text
@@


1.4.2.1
log
@SECURITY:
fixed integer overflows:
http://www.vuxml.org/openbsd/d79a032a-2763-11d9-a0f4-00065bd5b0b6.html

fixed buffer overflow vulnerability:
http://www.vuxml.org/openbsd/9317ac06-5441-11d9-8ad2-00065bd5b0b6.html

ok brad@@
@
text
@@


1.3
log
@upgrade to xpdf 2.02
--
From: naddy@@
@
text
@d1 4
a4 9
$OpenBSD: patch-xpdf_GfxState_cc,v 1.2 2003/02/12 08:28:20 sturm Exp $
--- xpdf/GfxState.cc.orig	Fri Dec  6 00:44:32 2002
+++ xpdf/GfxState.cc	Tue Feb 11 16:53:52 2003
@@@@ -815,9 +815,19 @@@@ GfxColorSpace *GfxIndexedColorSpace::par
   obj1.free();
   if (!arr->get(2, &obj1)->isInt()) {
     error(-1, "Bad Indexed color space (hival)");
+    delete baseA;
     goto err2;
d6 6
a11 9
   indexHighA = obj1.getInt();
+  if (indexHighA < 0 || indexHighA > 255) {
+    // the PDF spec requires indexHigh to be in [0,255] -- allowing
+    // values larger than 255 creates a security hole: if nComps *
+    // indexHigh is greater than 2^31, the loop below may overwrite
+    // past the end of the array
+    error(-1, "Bad Indexed color space (invalid indexHigh value)");
+    delete baseA;
+    goto err2;
d13 12
a24 3
   obj1.free();
   cs = new GfxIndexedColorSpace(baseA, indexHighA);
   arr->get(3, &obj1);
@


1.2
log
@update to xpdf 2.01

- switch to motif toolkit
- support for multiple open documents
- lots of minor tweaks, bugfixes and additions, see
  http://www.foolabs.com/xpdf/CHANGES for details

MAINTAINER ok
@
text
@d1 1
a1 1
$OpenBSD: patch-xpdf_GfxState_cc,v 1.1 2002/12/29 23:45:20 brad Exp $
@


1.2.2.1
log
@MFC:
upgrade to xpdf 2.02pl1

fixes a flaw where an attacker can embed malicious hyperlinks that if
activated can execute arbitrary shell commands.

http://marc.theaimsgroup.com/?l=full-disclosure&m=105555332025253&w=2
@
text
@d1 1
a1 1
$OpenBSD: patch-xpdf_GfxState_cc,v 1.2 2003/02/12 08:28:20 sturm Exp $
@


1.1
log
@The pdftops filter in xpdf contains an integer overflow that can
be exploited to gain the privileges of the target user.

http://www.idefense.com/advisory/12.23.02.txt
@
text
@d1 4
a4 4
$OpenBSD$
--- xpdf/GfxState.cc.orig	Thu Dec 26 23:05:20 2002
+++ xpdf/GfxState.cc	Thu Dec 26 23:22:59 2002
@@@@ -788,9 +788,19 @@@@ GfxColorSpace *GfxIndexedColorSpace::par
@


1.1.4.1
log
@MFC:
The pdftops filter in xpdf contains an integer overflow that can
be exploited to gain the privileges of the target user.

http://www.idefense.com/advisory/12.23.02.txt
@
text
@d1 4
a4 4
$OpenBSD: patch-xpdf_GfxState_cc,v 1.1 2002/12/29 23:45:20 brad Exp $
--- xpdf/GfxState.cc.orig	Fri Oct 26 13:52:41 2001
+++ xpdf/GfxState.cc	Sun Dec 29 19:01:29 2002
@@@@ -774,9 +774,19 @@@@ GfxColorSpace *GfxIndexedColorSpace::par
@


1.1.2.1
log
@MFC:
The pdftops filter in xpdf contains an integer overflow that can
be exploited to gain the privileges of the target user.

http://www.idefense.com/advisory/12.23.02.txt
@
text
@d1 1
a1 1
$OpenBSD: patch-xpdf_GfxState_cc,v 1.1 2002/12/29 23:45:20 brad Exp $
@

