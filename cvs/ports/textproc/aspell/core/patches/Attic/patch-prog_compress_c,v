head	1.3;
access;
symbols
	OPENBSD_4_4:1.2.0.12
	OPENBSD_4_4_BASE:1.2
	OPENBSD_4_3:1.2.0.10
	OPENBSD_4_3_BASE:1.2
	OPENBSD_4_2:1.2.0.8
	OPENBSD_4_2_BASE:1.2
	OPENBSD_4_1:1.2.0.6
	OPENBSD_4_1_BASE:1.2
	OPENBSD_4_0:1.2.0.4
	OPENBSD_4_0_BASE:1.2
	OPENBSD_3_9:1.2.0.2
	OPENBSD_3_9_BASE:1.2
	OPENBSD_3_8:1.1.0.8
	OPENBSD_3_8_BASE:1.1
	OPENBSD_3_7:1.1.0.6
	OPENBSD_3_7_BASE:1.1
	OPENBSD_3_6:1.1.0.4
	OPENBSD_3_6_BASE:1.1
	OPENBSD_3_5:1.1.0.2;
locks; strict;
comment	@# @;


1.3
date	2008.10.28.16.51.17;	author jasper;	state dead;
branches;
next	1.2;

1.2
date	2005.12.25.11.49.21;	author steven;	state Exp;
branches;
next	1.1;

1.1
date	2004.06.19.16.40.12;	author robert;	state Exp;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2004.06.19.22.56.25;	author robert;	state Exp;
branches;
next	;


desc
@@


1.3
log
@- update aspell to 0.60.6
- bumped major to be on the safe side
- update homepage
- be more precise about license version
- tweak DESCR

joint work with and ok ajacoutot@@, thanks!
@
text
@$OpenBSD: patch-prog_compress_c,v 1.2 2005/12/25 11:49:21 steven Exp $
--- prog/compress.c.orig	Sat Aug 31 20:51:11 2002
+++ prog/compress.c	Sun Dec 25 11:45:04 2005
@@@@ -28,6 +28,11 @@@@
 
 #endif
 
+#define WORD_BUFF_SIZE 256
+
+int count = 0;
+
+
 void usage () 
 {
   fputs("Compresses or uncompresses sorted word lists.\n"     , stderr);
@@@@ -45,8 +50,9 @@@@ static int get_word(FILE * in, char * w)
   if (c == EOF) return 0;
   do {
     *w++ = (char)(c);
-  } while (c = getc(in), c != EOF && c > 32);
+  } while (c = getc(in), c != EOF && c > 32 && count < (WORD_BUFF_SIZE - 1));
   *w = '\0';
+  count++;
   ungetc(c, in);
   if (c == EOF) return 0;
   else return 1;
@@@@ -61,14 +67,15 @@@@ int main (int argc, const char *argv[]) 
     
   } else if (argv[1][0] == 'c') {
 
-    char s1[256];
-    char s2[256];
+    char s1[WORD_BUFF_SIZE];
+    char s2[WORD_BUFF_SIZE];
     char * prev = s2;
     char * cur = s1;
     *prev = '\0';
 
     SETBIN (stdout);
 
+	while (count < WORD_BUFF_SIZE) {
     while (get_word(stdin, cur)) {
       int i = 0;
       /* get the length of the prefix */
@@@@ -85,11 +92,12 @@@@ int main (int argc, const char *argv[]) 
 	prev = s2; cur = s1;
       }
     }
+	}
     return 0;
 
   } else if (argv[1][0] == 'd') {
     
-    char cur[256];
+    char cur[WORD_BUFF_SIZE];
     int i;
     int c;
 
@@@@ -100,8 +108,11 @@@@ int main (int argc, const char *argv[]) 
       if (i == 0)
 	i = getc(stdin);
       --i;  
-      while ((c = getc(stdin)) > 32)
+      while ((c = getc(stdin)) > 32 && i < (WORD_BUFF_SIZE -1)) {
 	cur[i++] = (char)c;
+	count++;
+	}
+
       cur[i] = '\0';
       fputs(cur, stdout);
       putc('\n', stdout);
@


1.2
log
@SHARED_LIBS and USE_LIBTOOL, sync with update-patches
ok sturm@@
@
text
@d1 1
a1 1
$OpenBSD: patch-prog_compress_c,v 1.1 2004/06/19 16:40:12 robert Exp $
@


1.1
log
@This patch fixes a buffer overflow in word-list-compress;

http://marc.theaimsgroup.com/?l=bugtraq&m=108761564006503&w=2

ok jolan@@
@
text
@d1 1
a1 1
$OpenBSD$
d3 1
a3 1
+++ prog/compress.c	Sat Jun 19 16:10:04 2004
d16 1
a16 1
@@@@ -45,8 +50,9 @@@@
d27 1
a27 1
@@@@ -61,8 +67,8 @@@@
a37 1
@@@@ -69,6 +75,7 @@@@
d45 1
a45 1
@@@@ -85,11 +92,12 @@@@
d59 1
a59 1
@@@@ -100,8 +108,11 @@@@
@


1.1.2.1
log
@This patch fixes a buffer overflow in word-list-compress;
bump PKGNAME;
http://marc.theaimsgroup.com/?l=bugtraq&m=108761564006503&w=2

ok brad@@
@
text
@@

