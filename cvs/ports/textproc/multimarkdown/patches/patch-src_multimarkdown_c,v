head	1.1;
access;
symbols;
locks; strict;
comment	@# @;


1.1
date	2017.04.12.18.42.34;	author landry;	state Exp;
branches;
next	;
commitid	MqyTAJYTnoaHrr0Y;


desc
@@


1.1
log
@Update to multimarkdown 5.4.0, from Sean Levy, who's been pinging about
this patch for more than a year (!)

- uses pledge()
- switch to cmake
- enabel tests

Various versions of this patch tested by Micah Muer and Michael McConville
@
text
@$OpenBSD$

Use pledge(2) on OpenBSD.
--- src/multimarkdown.c.orig	Fri Aug  5 09:08:36 2016
+++ src/multimarkdown.c	Thu Sep 15 17:28:27 2016
@@@@ -58,6 +58,7 @@@@
 */
 
 
+#include <errno.h>
 #include <getopt.h>
 #include <libgen.h>
 #include "parser.h"
@@@@ -262,6 +263,11 @@@@ int main(int argc, char **argv)
 			abort();
 		}
 	}	
+	
+	if (pledge("stdio rpath wpath cpath", NULL) == -1) {
+		fprintf(stderr,"pledge: error #%d\n", errno);
+		exit(EXIT_FAILURE);
+	}
 	
 	/* Compatibility mode emulates the behavior of Markdown.pl */
 	if (compatibility_flag) {
@
