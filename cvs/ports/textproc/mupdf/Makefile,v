head	1.74;
access;
symbols
	OPENBSD_6_1:1.72.0.2
	OPENBSD_6_1_BASE:1.72
	OPENBSD_6_0:1.64.0.2
	OPENBSD_6_0_BASE:1.64
	OPENBSD_5_9:1.62.0.2
	OPENBSD_5_9_BASE:1.62
	OPENBSD_5_8:1.57.0.4
	OPENBSD_5_8_BASE:1.57
	OPENBSD_5_7:1.54.0.2
	OPENBSD_5_7_BASE:1.54
	OPENBSD_5_6:1.50.0.2
	OPENBSD_5_6_BASE:1.50
	OPENBSD_5_5:1.45.0.2
	OPENBSD_5_5_BASE:1.45
	OPENBSD_5_4:1.42.0.2
	OPENBSD_5_4_BASE:1.42
	OPENBSD_5_3:1.36.0.2
	OPENBSD_5_3_BASE:1.36
	OPENBSD_5_2:1.31.0.2
	OPENBSD_5_2_BASE:1.31
	OPENBSD_5_1_BASE:1.28
	OPENBSD_5_1:1.28.0.2
	OPENBSD_5_0:1.26.0.2
	OPENBSD_5_0_BASE:1.26
	OPENBSD_4_9:1.23.0.2
	OPENBSD_4_9_BASE:1.23
	OPENBSD_4_8:1.17.0.2
	OPENBSD_4_8_BASE:1.17
	OPENBSD_4_7:1.13.0.2
	OPENBSD_4_7_BASE:1.13
	OPENBSD_4_6:1.4.0.2
	OPENBSD_4_6_BASE:1.4
	sthen_20090602:1.1.1.1
	sthen:1.1.1;
locks; strict;
comment	@# @;


1.74
date	2017.05.05.14.02.51;	author sthen;	state Exp;
branches;
next	1.73;
commitid	rbSi3GSdwEnYAEAS;

1.73
date	2017.05.01.14.04.09;	author sthen;	state Exp;
branches;
next	1.72;
commitid	hrRawHVuzRPdwWNr;

1.72
date	2017.02.10.14.51.13;	author sthen;	state Exp;
branches;
next	1.71;
commitid	rXZnTy9WHwlnzRYo;

1.71
date	2016.12.12.10.54.39;	author sthen;	state Exp;
branches;
next	1.70;
commitid	Enu3DDXVVc0luyIA;

1.70
date	2016.11.08.12.05.04;	author sthen;	state Exp;
branches;
next	1.69;
commitid	ohvVvRt8qkdc4bD2;

1.69
date	2016.11.04.15.49.38;	author sthen;	state Exp;
branches;
next	1.68;
commitid	skr4ocH5qsBj5z5i;

1.68
date	2016.11.04.11.35.20;	author sthen;	state Exp;
branches;
next	1.67;
commitid	Gg5LRcnQlqj5M3F7;

1.67
date	2016.10.18.09.24.20;	author sthen;	state Exp;
branches;
next	1.66;
commitid	tVUMQH14btHr8Nk0;

1.66
date	2016.10.16.09.16.52;	author sthen;	state Exp;
branches;
next	1.65;
commitid	dEwglaqKyYstWUzR;

1.65
date	2016.08.27.20.58.48;	author jca;	state Exp;
branches;
next	1.64;
commitid	7TTHy8bFvHVkME08;

1.64
date	2016.05.05.09.02.45;	author sthen;	state Exp;
branches
	1.64.2.1;
next	1.63;
commitid	z3NGBSudLLHGF6pa;

1.63
date	2016.03.16.16.46.33;	author naddy;	state Exp;
branches;
next	1.62;
commitid	4Ekn8nPgVVHWLTwe;

1.62
date	2016.01.28.01.42.20;	author tobiasu;	state Exp;
branches
	1.62.2.1;
next	1.61;
commitid	MFV8dxeU5zYhIvpd;

1.61
date	2016.01.26.14.43.07;	author tb;	state Exp;
branches;
next	1.60;
commitid	XjBOC4tQbgu6o42c;

1.60
date	2016.01.19.05.20.51;	author semarie;	state Exp;
branches;
next	1.59;
commitid	f0gz0HSpqrDVpzkY;

1.59
date	2015.11.12.17.26.54;	author sthen;	state Exp;
branches;
next	1.58;
commitid	ZwdvGV2CJzqynQxI;

1.58
date	2015.10.30.12.59.17;	author sthen;	state Exp;
branches;
next	1.57;
commitid	vVZOehVa6DiEPxJL;

1.57
date	2015.05.20.16.34.14;	author jca;	state Exp;
branches;
next	1.56;
commitid	s9uuIxnFa97kAm1l;

1.56
date	2015.05.07.19.25.44;	author sthen;	state Exp;
branches;
next	1.55;
commitid	WFX3zUT7OM3mSGZi;

1.55
date	2015.04.25.23.04.53;	author sthen;	state Exp;
branches;
next	1.54;
commitid	KNPcQzzt7HisFxrA;

1.54
date	2014.11.29.13.25.23;	author sthen;	state Exp;
branches;
next	1.53;
commitid	0EGi5kbx6FoyncLb;

1.53
date	2014.10.20.15.10.00;	author kirby;	state Exp;
branches;
next	1.52;
commitid	BWpxQVxuZBwVEG1Q;

1.52
date	2014.10.18.08.36.39;	author espie;	state Exp;
branches;
next	1.51;
commitid	Hta6PN0bEdZohJOZ;

1.51
date	2014.10.03.17.39.15;	author sthen;	state Exp;
branches;
next	1.50;
commitid	GEEmX3A6l91GgiLp;

1.50
date	2014.06.12.14.07.19;	author sthen;	state Exp;
branches;
next	1.49;
commitid	C2eaivHbBza8zYGB;

1.49
date	2014.05.07.09.10.14;	author sthen;	state Exp;
branches;
next	1.48;

1.48
date	2014.04.17.20.30.57;	author sthen;	state Exp;
branches;
next	1.47;

1.47
date	2014.03.23.18.17.35;	author kili;	state Exp;
branches;
next	1.46;

1.46
date	2014.03.18.12.26.08;	author ajacoutot;	state Exp;
branches;
next	1.45;

1.45
date	2014.02.15.22.42.07;	author sthen;	state Exp;
branches;
next	1.44;

1.44
date	2013.12.31.16.58.44;	author bentley;	state Exp;
branches;
next	1.43;

1.43
date	2013.10.29.22.08.59;	author sthen;	state Exp;
branches;
next	1.42;

1.42
date	2013.04.29.12.54.00;	author sthen;	state Exp;
branches
	1.42.2.1;
next	1.41;

1.41
date	2013.04.07.11.38.06;	author sthen;	state Exp;
branches;
next	1.40;

1.40
date	2013.04.07.11.35.16;	author sthen;	state Exp;
branches;
next	1.39;

1.39
date	2013.04.07.09.54.31;	author espie;	state Exp;
branches;
next	1.38;

1.38
date	2013.03.21.01.26.03;	author sthen;	state Exp;
branches;
next	1.37;

1.37
date	2013.03.11.11.42.42;	author espie;	state Exp;
branches;
next	1.36;

1.36
date	2012.11.24.09.55.54;	author sthen;	state Exp;
branches;
next	1.35;

1.35
date	2012.09.30.10.22.54;	author landry;	state Exp;
branches;
next	1.34;

1.34
date	2012.09.12.21.32.19;	author sthen;	state Exp;
branches;
next	1.33;

1.33
date	2012.08.23.01.21.04;	author lteo;	state Exp;
branches;
next	1.32;

1.32
date	2012.08.17.13.30.16;	author sthen;	state Exp;
branches;
next	1.31;

1.31
date	2012.05.08.22.49.46;	author sthen;	state Exp;
branches;
next	1.30;

1.30
date	2012.04.25.13.55.11;	author sthen;	state Exp;
branches;
next	1.29;

1.29
date	2012.04.12.13.31.01;	author sthen;	state Exp;
branches;
next	1.28;

1.28
date	2011.09.05.13.24.39;	author sthen;	state Exp;
branches;
next	1.27;

1.27
date	2011.08.23.19.05.45;	author jasper;	state Exp;
branches;
next	1.26;

1.26
date	2011.07.13.21.48.48;	author sthen;	state Exp;
branches;
next	1.25;

1.25
date	2011.03.25.21.13.16;	author sthen;	state Exp;
branches;
next	1.24;

1.24
date	2011.03.22.23.40.46;	author sthen;	state Exp;
branches;
next	1.23;

1.23
date	2011.02.10.13.01.12;	author jasper;	state Exp;
branches;
next	1.22;

1.22
date	2010.11.20.19.56.49;	author espie;	state Exp;
branches;
next	1.21;

1.21
date	2010.10.24.21.38.06;	author ajacoutot;	state Exp;
branches;
next	1.20;

1.20
date	2010.10.19.07.54.22;	author espie;	state Exp;
branches;
next	1.19;

1.19
date	2010.09.03.12.38.19;	author sthen;	state Exp;
branches;
next	1.18;

1.18
date	2010.08.29.10.08.05;	author matthieu;	state Exp;
branches;
next	1.17;

1.17
date	2010.07.10.14.02.08;	author naddy;	state Exp;
branches
	1.17.2.1;
next	1.16;

1.16
date	2010.06.03.19.38.34;	author sthen;	state Exp;
branches;
next	1.15;

1.15
date	2010.03.31.13.06.47;	author sthen;	state Exp;
branches;
next	1.14;

1.14
date	2010.03.21.00.05.33;	author sthen;	state Exp;
branches;
next	1.13;

1.13
date	2010.01.07.08.39.00;	author sthen;	state Exp;
branches;
next	1.12;

1.12
date	2010.01.07.01.20.09;	author sthen;	state Exp;
branches;
next	1.11;

1.11
date	2009.10.11.10.33.41;	author sthen;	state Exp;
branches;
next	1.10;

1.10
date	2009.09.29.23.59.40;	author sthen;	state Exp;
branches;
next	1.9;

1.9
date	2009.09.20.10.22.03;	author sthen;	state Exp;
branches;
next	1.8;

1.8
date	2009.08.10.06.34.56;	author kili;	state Exp;
branches;
next	1.7;

1.7
date	2009.07.14.19.20.41;	author sthen;	state Exp;
branches;
next	1.6;

1.6
date	2009.07.14.15.38.46;	author sthen;	state Exp;
branches;
next	1.5;

1.5
date	2009.07.12.19.40.11;	author sthen;	state Exp;
branches;
next	1.4;

1.4
date	2009.06.22.11.56.15;	author sthen;	state Exp;
branches;
next	1.3;

1.3
date	2009.06.19.13.42.29;	author sthen;	state Exp;
branches;
next	1.2;

1.2
date	2009.06.19.00.51.49;	author sthen;	state Exp;
branches;
next	1.1;

1.1
date	2009.06.02.22.15.08;	author sthen;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2009.06.02.22.15.08;	author sthen;	state Exp;
branches;
next	;

1.17.2.1
date	2010.10.09.00.05.43;	author william;	state Exp;
branches;
next	;

1.42.2.1
date	2014.02.17.15.45.24;	author jasper;	state Exp;
branches;
next	;

1.62.2.1
date	2016.08.28.08.44.27;	author jca;	state Exp;
branches;
next	;
commitid	GLsEMkt5bjI2w92l;

1.64.2.1
date	2016.08.28.08.29.52;	author jca;	state Exp;
branches;
next	1.64.2.2;
commitid	UZ2weo3fxxKMyZsI;

1.64.2.2
date	2016.08.28.08.48.51;	author jca;	state Exp;
branches;
next	;
commitid	9lONBNUglSNwbwFH;


desc
@@


1.74
log
@after doing battle with the build infra, belatedly update to MuPDF 1.11
@
text
@# $OpenBSD: Makefile,v 1.73 2017/05/01 14:04:09 sthen Exp $

SHARED_LIBS +=	mupdf		6.0

COMMENT =	graphic library, pdf parser, viewer and utilities

V =		1.11
DISTNAME =	mupdf-$V-source
PKGNAME =	mupdf-$V

CATEGORIES =	textproc x11

HOMEPAGE =	http://mupdf.com/

MAINTAINER =	Stuart Henderson <sthen@@openbsd.org>

# code: Affero v3 (UGH!)
# font maps: Adobe (redist ok, see headers).
# droid font: Apache.
PERMIT_PACKAGE_CDROM =	Yes

# uses pledge(2)
WANTLIB += GL X11 Xext c crypto curl freetype glfw harfbuzz jbig2dec
WANTLIB += jpeg m openjp2 pthread ssl z

FLAVORS=	js
FLAVOR?=

MODULES =	lang/clang
MODCLANG_ARCHS = ${GCC3_ARCHS} ${GCC4_ARCHS}

# http://git.ghostscript.com/?p=mupdf.git;a=summary
MASTER_SITES =	http://mupdf.com/downloads/ \
		http://mupdf.com/downloads/archive/

RUN_DEPENDS =	devel/desktop-file-utils \
		devel/xdg-utils
LIB_DEPENDS =	devel/harfbuzz \
		graphics/glfw \
		graphics/jbig2dec \
		graphics/jpeg \
		graphics/openjp2>=2.0.1 \
		net/curl

USE_GMAKE =	Yes
NO_TEST =	Yes

MAKE_FLAGS =	CC="${CC}" CXX="${CXX}" \
		XCFLAGS="${CFLAGS} -fPIC -I$(WRKSRC)/fitz -I$(WRKSRC)/pdf -I$(WRKSRC)/xps" \
		HAVE_CURL=yes \
		HAVE_GLFW=yes \
		SYS_GLFW_CFLAGS="-I${X11BASE}/include" \
		SYS_GLFW_LIBS="-L${LOCALBASE}/lib -L${X11BASE}/lib -lglfw -lGL" \
		SYS_OPENSSL_LIBS="-lssl -lcrypto" \
		LDFLAGS="${LDFLAGS}" \
		LIBmupdf_VERSION="${LIBmupdf_VERSION}" \
		build=release verbose=yes

FAKE_FLAGS =	NOCURL= prefix=${PREFIX} mandir=${PREFIX}/man

pre-configure:
	cd ${WRKSRC}; sed -i 's,/usr/X11R6/include,${X11BASE}/include,g' Makerules Makethird
	rm -rf ${WRKSRC}/thirdparty/{curl,freetype,harfbuzz,jbig2dec,libjpeg,openjpeg,zlib,glfw} # use from ports
.if !${FLAVOR:Mjs}
	rm -rf ${WRKSRC}/thirdparty/mujs # not building with javascript support
.else
CFLAGS +=	-DWITH_JS
.endif

post-install:
	${INSTALL_DATA_DIR} ${PREFIX}/share/{applications,pixmaps}
	${INSTALL_DATA} ${FILESDIR}/mupdf.xpm ${PREFIX}/share/pixmaps/
	${INSTALL_DATA} ${FILESDIR}/mupdf.desktop ${PREFIX}/share/applications/
	cd ${PREFIX}/bin; ln -s mupdf-x11 mupdf

.include <bsd.port.mk>
@


1.73
log
@change mupdf's MODGCC4_ARCHS to ${GCC3_ARCHS} ${GCC4_ARCHS}; this is just
C99 not C++ so no mucking about with WANTLIB required.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.72 2017/02/10 14:51:13 sthen Exp $
d3 1
a3 2
SHARED_LIBS +=	mupdf		5.0
SHARED_LIBS +=	mupdfthird	0.0
d7 1
a7 2
V =		1.10a
REVISION =	0
d23 2
a24 2
WANTLIB += GL X11 Xcursor Xext Xinerama Xrandr c crypto curl freetype
WANTLIB += harfbuzz jbig2dec jpeg m nghttp2 openjp2 pthread ssl z
d29 2
a30 2
MODULES =	gcc4
MODGCC4_ARCHS =	${GCC3_ARCHS} ${GCC4_ARCHS}
d39 1
a47 9
.if ${MACHINE_ARCH} == "hppa"
CFLAGS +=	-ffunction-sections
.endif

CFLAGS +=	-fPIC

# -I flags prepend mupdf's own, to allow building with previous ver installed
MAKE_ENV += CFLAGS="${CFLAGS} -I$(WRKSRC)/fitz -I$(WRKSRC)/pdf -I$(WRKSRC)/xps"

d49 1
d51 3
a53 2
		CURL_LIB="-lcurl" \
		CURL_LIBS="-lpthread -lssl -lcrypto -lnghttp2 -lcurl" \
d57 1
a57 2
		LIBmupdfthird_VERSION="${LIBmupdfthird_VERSION}" \
		build= verbose=yes
d63 1
a63 2
	rm -rf ${WRKSRC}/thirdparty/{curl,freetype,harfbuzz,jbig2dec,jpeg,openjpeg,zlib} # use from ports
	#rm -rf ${WRKSRC}/thirdparty/glfw # not yet in ports, doesn't build here
a66 1

@


1.72
log
@mupdf: backport fix for use-after-free and heap-based buffer overflow
in fz_subsample_pixmap(), https://bugs.ghostscript.com/show_bug.cgi?id=697515
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.71 2016/12/12 10:54:39 sthen Exp $
d32 1
a32 1
MODGCC4_ARCHS =	*
d61 1
a61 1
		CURL_LIBS="-lpthread -lssl -lcurl" \
@


1.71
log
@update to mupdf-1.10a
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.70 2016/11/08 12:05:04 sthen Exp $
d9 1
@


1.70
log
@add an upstream patch to mupdf's javascript code for a heap buffer
overflow write and oob read. (js is disabled in the default flavour in
OpenBSD ports/packages, it's only in the mupdf-XX-js package).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.69 2016/11/04 15:49:38 sthen Exp $
d3 1
a3 1
SHARED_LIBS +=	mupdf		4.0
d8 1
a8 1
V =		1.9a
a10 1
REVISION =	2
@


1.69
log
@remove hardcoded -lidn (curl libs)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.68 2016/11/04 11:35:20 sthen Exp $
d11 1
a11 1
REVISION =	1
@


1.68
log
@sync WANTLIB (and in one case, add gettext to LIB_DEPENDS) in dependent ports
now that internationalised domain name support has been removed from net/curl
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.67 2016/10/18 09:24:20 sthen Exp $
d11 1
a11 1
REVISION =	0
d61 1
a61 1
		CURL_LIBS="-lpthread -lidn -lssl -lcurl" \
@


1.67
log
@- patch mupdf to cope with openjp2 update
- use sed -i instead of SUBST_CMD for easier update-patches management
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.66 2016/10/16 09:16:52 sthen Exp $
d11 1
d24 4
a29 4

# uses pledge(2)
WANTLIB += GL X11 Xcursor Xext Xinerama Xrandr c crypto curl freetype
WANTLIB += harfbuzz idn jbig2dec jpeg m nghttp2 openjp2 pthread ssl z
@


1.66
log
@update to mupdf-1.9a
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.65 2016/08/27 20:58:48 jca Exp $
d70 1
a70 1
	cd ${WRKSRC}/; ${SUBST_CMD} Makerules Makethird
@


1.65
log
@SECURITY fixes for CVE-2016-6525 & CVE-2016-6265

CVE-2016-6525 heap overflow in pdf_load_mesh_params()
CVE-2016-6265 use-after-free

Reported by & looks good to stsp@@, ok sthen@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.64 2016/05/05 09:02:45 sthen Exp $
d3 2
a4 1
SHARED_LIBS +=	mupdf 3.0
d8 1
a8 1
V =		1.8
a10 1
REVISION =	4
d28 4
a31 1
WANTLIB += idn jbig2dec jpeg m nghttp2 openjp2 pthread ssl z
d39 2
a40 1
LIB_DEPENDS =	graphics/jbig2dec \
d64 1
d71 1
a71 1
	rm -rf ${WRKSRC}/thirdparty/{curl,freetype,jbig2dec,jpeg,openjpeg,zlib} # use from ports
d75 3
@


1.64
log
@support https URLs with mupdf-x11-curl, from jirib at devio.us
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.63 2016/03/16 16:46:33 naddy Exp $
d10 1
a10 1
REVISION =	3
@


1.64.2.1
log
@SECURITY fixes for CVE-2016-6525 & CVE-2016-6265

CVE-2016-6525 heap overflow in pdf_load_mesh_params()
CVE-2016-6265 use-after-free

Reported by & looks good to stsp@@, ok sthen@@ (maintainer)
Tests on 6.0 by kili@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.64 2016/05/05 09:02:45 sthen Exp $
d10 1
a10 1
REVISION =	4
@


1.64.2.2
log
@SECURITY fixes for CVE-2016-6525 & CVE-2016-6265

CVE-2016-6525 heap overflow in pdf_load_mesh_params()
CVE-2016-6265 use-after-free

Reported by & looks good to stsp@@, ok sthen@@ (maintainer)
Tests on 6.0 by kili@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.64.2.1 2016/08/28 08:29:52 jca Exp $
d10 1
a10 1
REVISION =	5
@


1.63
log
@remove SHARED_ONLY from ports that don't use any MODULES
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62 2016/01/28 01:42:20 tobiasu Exp $
d10 1
a10 1
REVISION =	2
@


1.62
log
@Fix alignment fault crash on alpha, mips64 and sparc64 by padding the
node data structure to 8 bytes. Exclude amd64 since this is hack with
unknown side-effects.

ok sthen@@ for a previous rev
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.61 2016/01/26 14:43:07 tb Exp $
a2 1
SHARED_ONLY =	Yes
@


1.62.2.1
log
@Missing bump in previous commit on OPENBSD_5_9.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62 2016/01/28 01:42:20 tobiasu Exp $
d11 1
a11 1
REVISION =	3
@


1.61
log
@Short-circuit the search function if the search string is empty. This
avoids blocking the viewer and eating a lot of cpu for a number of
seconds when 'n' is pressed before an actual search was performed.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.60 2016/01/19 05:20:51 semarie Exp $
d11 1
a11 1
REVISION =	1
@


1.60
log
@add pledge(2) to textproc/mupdf

OK sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59 2015/11/12 17:26:54 sthen Exp $
d11 1
a11 1
REVISION =	0
@


1.59
log
@update to MuPDF-1.8
- many fixes and improvements to EPUB support
- mudraw moves to the multi-purpose mutool binary
- add new OpenGL-based viewer, mupdf-gl
- add an optional flavour to enable the javascript support (wasn't
on by default before in our package, and still isn't)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2015/10/30 12:59:17 sthen Exp $
d11 1
d27 1
@


1.58
log
@sync WANTLIB (curl+nghttp2)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.57 2015/05/20 16:34:14 jca Exp $
d8 1
a8 1
V =		1.7a
a10 1
REVISION =	1
d23 5
a27 2
WANTLIB += X11 Xext c crypto curl freetype idn jbig2dec jpeg m
WANTLIB += nghttp2 openjp2 pthread ssl z
d64 6
a69 2
	cd ${WRKSRC}/; ${SUBST_CMD} Makerules
	rm -rf ${WRKSRC}/thirdparty
@


1.57
log
@Build with -fPIC, fixes binutils-2.17@@amd64

ok kettenis@@ sthen@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2015/05/07 19:25:44 sthen Exp $
d11 1
a11 1
REVISION =	0
d25 1
a25 1
WANTLIB += openjp2 pthread ssl z
@


1.56
log
@update to MuPDF 1.7a
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55 2015/04/25 23:04:53 sthen Exp $
d11 1
d44 2
@


1.55
log
@update to MuPDF 1.7
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.54 2014/11/29 13:25:23 sthen Exp $
d4 1
a4 1
SHARED_LIBS +=	mupdf 2.0
d8 1
a8 1
V =		1.7
@


1.54
log
@handle api change in openjp2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2014/10/20 15:10:00 kirby Exp $
d4 1
a4 1
SHARED_LIBS +=	mupdf 1.1
d8 1
a8 1
V =		1.6
a10 1
REVISION =	1
@


1.53
log
@add another MASTER_SITE for old versions.
OK sthen@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.52 2014/10/18 08:36:39 espie Exp $
d11 1
a11 1
REVISION =	0
@


1.52
log
@add support for fine-grained zoom, for those pesky pdf where contents would
just fit on your screen but for one pesky dpi.

idea (and code) okay'd maintainer
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 2014/10/03 17:39:15 sthen Exp $
d28 2
a29 1
MASTER_SITES =	http://mupdf.com/downloads/
@


1.51
log
@update to mupdf 1.6
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2014/06/12 14:07:19 sthen Exp $
d11 1
@


1.50
log
@update to mupdf 1.5
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2014/05/07 09:10:14 sthen Exp $
d4 1
a4 1
SHARED_LIBS +=	mupdf 1.0
d8 1
a8 1
V =		1.5
@


1.49
log
@Switch mupdf to a shared libary (not bothering with a static library for now;
this port didn't build on static-only arch anyway). Unsupported upstream
(http://bugs.ghostscript.com/show_bug.cgi?id=691887#c1) but the patch is
easy to maintain, and there's a clear benefit:

$ stat -f "%Z %N" mupdf*
25262988 mupdf-1.4.tgz
4619258 mupdf-1.4p0.tgz
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2014/04/17 20:30:57 sthen Exp $
d4 1
a4 1
SHARED_LIBS +=	mupdf 0.0
d8 1
a8 2
V =		1.4
REVISION =	0
d33 1
a33 1
		graphics/openjp2 \
d58 1
a58 1
	cd ${WRKSRC}/; ${SUBST_CMD} Makerules platform/debian/mupdf.pc
d62 3
a64 9
	${INSTALL_DATA_DIR} ${PREFIX}/share/applications/ \
	    ${PREFIX}/share/application-registry/ ${PREFIX}/share/pixmaps \
	    ${PREFIX}/lib/pkgconfig/
.for a b in mupdf.xpm share/pixmaps \
  mupdf.applications share/application-registry \
  mupdf.desktop share/applications \
  mupdf.pc lib/pkgconfig
	${INSTALL_DATA} ${WRKSRC}/platform/debian/$a ${PREFIX}/$b
.endfor
@


1.48
log
@update to MuPDF 1.4
@
text
@d1 4
a4 1
# $OpenBSD: Makefile,v 1.47 2014/03/23 18:17:35 kili Exp $
d9 1
d53 1
@


1.47
log
@Revert librt changes.

Prodded by espie@@.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2014/03/18 12:26:08 ajacoutot Exp $
d5 1
a5 1
V =		1.3
d7 1
a7 2
PKGNAME =	mupdf-${V:S/-rc/rc/}
REVISION =	3
d24 1
a24 1
MASTER_SITES =	http://mupdf.googlecode.com/files/
d43 2
a44 2
MAKE_FLAGS =	NOCURL= \
		CC="${CC}" CXX="${CXX}" \
d49 1
a49 1
		build= verbose=1
@


1.46
log
@Drop librt chunk.

ok sthen@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2014/02/15 22:42:07 sthen Exp $
d8 1
a8 1
REVISION =	2
@


1.45
log
@SECURITY fix for a stack-based buffer overflow in MuPDF's xps_parse_color()
function, info at http://www.hdwsec.fr/blog/mupdf.html. ok espie@@ aja@@ naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2013/12/31 16:58:44 bentley Exp $
d8 1
a8 1
REVISION =	1
@


1.44
log
@Clicking URLs requires xdg-open, so add it as a RDEP.

ok sthen@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2013/10/29 22:08:59 sthen Exp $
d8 1
a8 1
REVISION =	0
@


1.43
log
@Update to MuPDF 1.3, and enable cURL support (separate binary, not subpackaged
here as cURL is a fairly common package).

Earlier version without cURL support ok rpe@@, additional tests on various
arch from brett@@, Florian Stinglmayr and Donovan Watteau (who also reminded
me about a change of name for mubusy needed in DESCR).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2013/04/29 12:54:00 sthen Exp $
d8 1
d27 2
a28 1
RUN_DEPENDS =	devel/desktop-file-utils
@


1.42
log
@better fix for slow scrolling, from upstream repo
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2013/04/07 11:38:06 sthen Exp $
d5 1
a5 1
V =		1.2
a6 1
EXTRACT_SUFX =	.zip
a7 1
REVISION =	2
d20 2
a21 1
WANTLIB =	X11 Xext c freetype jbig2dec jpeg>=62 m openjpeg z
d24 1
a24 2
MASTER_SITES =	${HOMEPAGE}download/ \
		${HOMEPAGE}download/archive/
d29 2
a30 1
		graphics/openjpeg>=1.5.0
d40 1
a40 2
MAKE_ENV +=	CFLAGS="${CFLAGS} -I$(WRKSRC)/fitz -I$(WRKSRC)/pdf -I$(WRKSRC)/xps" \
		LDFLAGS="${LDFLAGS}" CC=${CC} CXX=${CXX} build= verbose=1
d42 9
a50 1
FAKE_FLAGS =	prefix=${PREFIX} mandir=${PREFIX}/man
d53 1
a53 1
	${SUBST_CMD} ${WRKSRC}/debian/mupdf.pc
d60 7
a66 7
	${INSTALL_DATA} ${WRKSRC}/debian/mupdf.xpm ${PREFIX}/share/pixmaps/
	${INSTALL_DATA} ${WRKSRC}/debian/mupdf.applications \
	    ${PREFIX}/share/application-registry/
	${INSTALL_DATA} ${WRKSRC}/debian/mupdf.desktop \
	    ${PREFIX}/share/applications/
	${INSTALL_DATA} ${WRKSRC}/debian/mupdf.pc \
	    ${PREFIX}/lib/pkgconfig/mupdf.pc
@


1.42.2.1
log
@security fix for stack-based buffer overflow

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2013/04/29 12:54:00 sthen Exp $
d9 1
a9 1
REVISION =	3
@


1.41
log
@add patch from http://bugs.ghostscript.com/show_bug.cgi?id=693679 fixing
painfully slow scrolling at higher dpi
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2013/04/07 11:35:16 sthen Exp $
d9 1
a9 1
REVISION =	1
@


1.40
log
@update license marker comment, this is now affero license (bleurgh)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2013/04/07 09:54:31 espie Exp $
d9 1
a9 1
REVISION =	0
@


1.39
log
@re-add the processing tool, lost upstream...
okay sthen@@
mubusy -> mutool
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2013/03/21 01:26:03 sthen Exp $
d17 3
a19 1
# code: GPLv3. font maps: Adobe (redist ok, see headers). droid font: Apache.
@


1.38
log
@update to MuPDF 1.2 (just the base for now, I may add a flavour for the
form support later; that needs v8 so won't be in the standard package)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2013/03/11 11:42:42 espie Exp $
d9 1
@


1.37
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2012/11/24 09:55:54 sthen Exp $
d5 1
a5 2
V =		1.1
REVISION =	2
d7 1
d39 1
a39 2
		LDFLAGS="${LDFLAGS}" CC=${CC} CXX=${CXX} \
		MANDIR="${WRKINST}${PREFIX}/man/man1" build= verbose=1
d41 1
a41 1
FAKE_FLAGS =	prefix=${WRKINST}${PREFIX} mandir=${WRKINST}${PREFIX}/man
d45 1
@


1.36
log
@don't segfault if run with DISPLAY unset, reported by bentley@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2012/09/30 10:22:54 landry Exp $
a17 3
PERMIT_PACKAGE_FTP =	Yes
PERMIT_DISTFILES_CDROM =Yes
PERMIT_DISTFILES_FTP =	Yes
d31 1
a31 1
NO_REGRESS =	Yes
@


1.35
log
@add -ffunction-sections to CFLAGS on hppa, fixes the build there.
ok sthen@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2012/09/12 21:32:19 sthen Exp $
d6 1
a6 1
REVISION =	1
@


1.34
log
@fix manpage links in mupdf now that various tools have been replaced
with mubusy; from Jan Stary
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2012/08/23 01:21:04 lteo Exp $
d35 4
@


1.33
log
@MuPDF has combined several of their command line tools into a single
tool called mubusy, so update pkg/DESCR accordingly.  mudraw remains a
separate binary.

OK sthen@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2012/08/17 13:30:16 sthen Exp $
d6 1
a6 1
REVISION =	0
@


1.32
log
@update to MuPDF 1.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2012/05/08 22:49:46 sthen Exp $
d6 1
@


1.31
log
@minor fixes for app names in mupdf usage lines in the programs which were
renamed recently. pointed out by espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2012/04/25 13:55:11 sthen Exp $
d5 1
a5 2
V =		1.0
REVISION =	0
d7 1
a7 1
PKGNAME =	mupdf-$V
@


1.30
log
@update to MuPDF 1.0
- thanks to krw@@, brett@@ and "Dawe" for testing the release candidate
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2012/04/12 13:31:01 sthen Exp $
d6 1
@


1.29
log
@MuPDF has two ways to embed fonts; a stonking great static array which
GCC hates and uses 800MB+ to compile, and embedding with .incbin.
Switch the port to using .incbin. Fixes out of memory on alpha reported
and tested by naddy@@, greatly improves build time on arm.
The VMEM_WARNING can now be removed.

- while there, don't use groff.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2011/09/05 13:24:39 sthen Exp $
d5 1
a5 2
V =		0.9
REVISION =	0
a7 1
WRKDIST =	${WRKDIR}/mupdf-$V
d30 1
a30 1
		graphics/openjpeg
d35 3
a37 1
MAKE_ENV +=     CFLAGS="${CFLAGS}" LDFLAGS="${LDFLAGS}" CC=${CC} CXX=${CXX} \
a45 2
	# don't conflict with xpdf's pdfinfo
	mv ${PREFIX}/bin/pdfinfo ${PREFIX}/bin/pdfinfo_mupdf
@


1.28
log
@bugfix update to MuPDF 0.9
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2011/08/23 19:05:45 jasper Exp $
d6 1
a34 4
USE_GROFF =	Yes

VMEM_WARNING =	Yes

@


1.27
log
@- add VMEM_WARNING

ok sthen@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2011/07/13 21:48:48 sthen Exp $
d5 1
a5 1
V =		0.8.165
@


1.26
log
@update to MuPDF 0.8.165, now also supporting XPS documents.

- drop fontres.c and switch to upstream's standard method of embedding fonts;
with gcc4 this is now able to build on arm without running out of RAM (this is
fortunate because it avoids reworking fontres for changes to MuPDF).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2011/03/25 21:13:16 sthen Exp $
d35 2
@


1.25
log
@handle jbig2dec update (BUILD_DEPENDS->LIB_DEPENDS), fix out-of-date name in DESCR
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2011/03/22 23:40:46 sthen Exp $
d5 1
a5 2
V =		0.8.15
REVISION =	0
d24 1
d41 2
a42 7
CFLAGS +=	-Ifitz -Imupdf -I${LOCALBASE}/include
LDFLAGS +=	-L${LOCALBASE}/lib
FAKE_FLAGS =	prefix=${WRKINST}${PREFIX}

# the normal build embeds fonts into c files which take gobs of ram to
# compile (too much for some arch, even with -O0). fontres pulls them in
# via the assember instead.
a43 1
	cp ${FILESDIR}/fontres.c ${WRKSRC}/mupdf/
d47 1
a47 1
	# don't want to conflict with xpdf's pdfinfo
@


1.24
log
@update mupdf (a nice fast lightweight pdf viewer with its own codebase
rather than yet-another-xpdf-derivative) to 0.8.15.

various improvements and fixes, notably now supports AESv3 encrypted
PDFs and, very welcome, search now operates over all pages and is thus
actually useful.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2011/02/10 13:01:12 jasper Exp $
d6 1
d17 1
a17 1
# code: GPLv3. font maps: Adobe (redist ok, see headers). droid: Apache.
d23 1
a23 1
WANTLIB =	X11 Xext c freetype jpeg>=62 m openjpeg z
d29 2
a30 2
BUILD_DEPENDS =	graphics/jbig2dec
LIB_DEPENDS =	graphics/jpeg \
@


1.23
log
@Security fix for SA43020:
MuPDF "closedctd()" Memory Corruption Vulnerability.

ok sthen@@ (MAINTAINER) aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2010/11/20 19:56:49 espie Exp $
d5 4
a8 2
DISTNAME =	mupdf-0.7
REVISION =	0
d37 2
a38 2
MAKE_ENV +=     CFLAGS="${CFLAGS}" LDFLAGS="${LDFLAGS}" CC=${CC} \
		CXX=${CXX} build= verbose=1
a51 4
	${INSTALL_MAN} ${WRKSRC}/debian/mupdf.1 ${PREFIX}/man/man1
.for x in pdfclean pdfdraw pdfshow
	${INSTALL_MAN} ${WRKSRC}/debian/$x.1 ${PREFIX}/man/man1/$x.1
.endfor
@


1.22
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2010/10/24 21:38:06 ajacoutot Exp $
d6 1
@


1.21
log
@Remove USE_X11.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2010/10/19 07:54:22 espie Exp $
d19 1
a19 1
WANTLIB =	X11 Xext c freetype jpeg.>=62 m openjpeg z
d24 4
a27 4
RUN_DEPENDS =	::devel/desktop-file-utils
BUILD_DEPENDS =	::graphics/jbig2dec
LIB_DEPENDS =	::graphics/jpeg \
		::graphics/openjpeg
@


1.20
log
@USE_GROFF=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2010/09/03 12:38:19 sthen Exp $
a28 1
USE_X11 =	Yes
@


1.19
log
@update mupdf to 0.7

Note: key bindings changed slightly; notably /=search (currently
only within a page), n=next search hit, N=last search hit.
A few others were removed to make room and consistency. See
manpage for more (or hit ? while running and look at stdout).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2010/08/29 10:08:05 matthieu Exp $
d31 1
@


1.18
log
@distfile moved and got renamed, but didn't change.
ok sthen@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2010/07/10 14:02:08 naddy Exp $
d5 1
a5 3
DISTNAME =	mupdf-0.6
REVISION =	1
WRKDIST =	${WRKDIR}/mupdf
d21 2
a22 1
MASTER_SITES =	${HOMEPAGE}download/archive/
d35 1
a35 1
		CXX=${CXX} build=
d37 1
a37 1
CFLAGS +=	-I${LOCALBASE}/include
@


1.17
log
@fix dependencies
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2010/06/03 19:38:34 sthen Exp $
d5 2
a6 3
DISTNAME =	mupdf-0.6-source
PKGNAME =	${DISTNAME:S/-source//}
REVISION =	0
d23 1
a23 1
MASTER_SITES =	${HOMEPAGE}download/source/
@


1.17.2.1
log
@MFC:

- - -
revision 1.18
date: 2010/08/29 10:08:05;  author: matthieu;  state: Exp;  lines: +4 -5
distfile moved and got renamed, but didn't change.
ok sthen@@ (maintainer)
- - -
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2010/07/10 14:02:08 naddy Exp $
d5 3
a7 2
DISTNAME =	mupdf-0.6
REVISION =	1
d24 1
a24 1
MASTER_SITES =	${HOMEPAGE}download/archive/
@


1.16
log
@- update MuPDF to 0.6. (various improvements including copying text
from PDFs with the ight mouse button. no search yet though).
note that the command-line options have changed slightly and there
are new keybindings - see mupdf(1).

- only pdfinfo conflicts with other packages, so switch to the
standard names for the other tools

- install the new manpages from upstream (replacing our mupdf manpage),
library, headers, .pc and desktop integration files

thanks ajacoutot@@ for checking and improvements for the desktop
integration files, and Roberto Fernandez for looking over the
fontres parts.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2010/03/31 13:06:47 sthen Exp $
d7 1
d22 1
a22 1
WANTLIB =	X11 Xext c freetype m z
d27 3
a29 3
LIB_DEPENDS =	jbig2dec::graphics/jbig2dec \
		jpeg.>=62::graphics/jpeg \
		openjpeg::graphics/openjpeg
@


1.15
log
@update to 0.5
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2010/03/21 00:05:33 sthen Exp $
d5 3
a7 1
DISTNAME =	mupdf-0.5
d21 1
a21 1
WANTLIB =	X11 Xext c freetype m pthread z
d23 1
a23 3
MASTER_SITES =	${HOMEPAGE}download/

BUILD_DEPENDS =	::devel/jam
d25 1
d30 2
a31 1
USE_X11 =		Yes
d33 1
a33 1
NO_REGRESS =		Yes
d35 2
a36 20
JAMDEBUG =	-d x	# display command-lines
JAMDEBUG +=	-q	# die quickly on build failure
MAKE_ENV +=	CC=${CC} CXX=${CXX}

JAMFLAGS = \
	-sALL_LOCATE_TARGET=${WRKBUILD} \
	-sBUILD= \
	-sHAVE_OPENJPEG=yes \
	-sHAVE_JBIG2DEC=yes \
	-sOPTIM="${CFLAGS}" \
	-sOS=LINUX \
	-sCXXFLAGS="${CXXFLAGS} `freetype-config --cflags` -I${LOCALBASE}/include -I${X11BASE}/include" \
	-sLDFLAGS="${LDFLAGS} `freetype-config --libs` -L${LOCALBASE}/lib"

FLAVORS +=	no_cjk
FLAVOR ?=

.if ${FLAVOR:L:Mno_cjk}
JAMFLAGS +=    -sDEFINES=NOCJK
.endif
d38 3
a40 1
SEPARATE_BUILD =	concurrent
d42 3
d46 2
a47 5
	cp ${FILESDIR}/fontres.c ${WRKSRC}/
	${SUBST_CMD} ${WRKSRC}/Jamrules

do-build:
	cd ${WRKSRC} && ${SETENV} ${MAKE_ENV} jam ${JAMDEBUG} ${JAMFLAGS}
d49 4
a52 5
do-install:
	${INSTALL_MAN} ${FILESDIR}/mupdf.1 ${PREFIX}/man/man1
	${INSTALL_PROGRAM} ${WRKBUILD}/mupdf ${PREFIX}/bin
.for x in pdfclean pdfdraw pdfextract pdfinfo pdfshow
	${INSTALL_PROGRAM} ${WRKBUILD}/$x ${PREFIX}/bin/mu_$x
d54 12
@


1.14
log
@add missing command to the manual
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2010/01/07 08:39:00 sthen Exp $
d5 1
a5 3
PKGNAME =	mupdf-0.4.920p1
DISTNAME =	mupdf-r920
WRKDIST =	${WRKDIR}/mupdf
d9 1
a9 1
HOMEPAGE =	http://ccxvii.net/mupdf/
d21 1
a21 1
MASTER_SITES =	http://ccxvii.net/mupdf/download/
@


1.13
log
@- update homepage, from Bryan Linton
- bump PKGNAME
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2010/01/07 01:20:09 sthen Exp $
d5 1
a5 1
PKGNAME =	mupdf-0.4.920p0
@


1.12
log
@Update mupdf to r920 snapshot.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2009/10/11 10:33:41 sthen Exp $
d5 1
a5 1
PKGNAME =	mupdf-0.4.920
d11 1
a11 1
HOMEPAGE =	http://ccxvii.net/fitz/
@


1.11
log
@Use jbig2dec, bump PKGNAME.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2009/09/29 23:59:40 sthen Exp $
d5 3
a7 2
PKGNAME =	mupdf-0.4p6
DISTNAME =	mupdf-2009-09-01-source
d23 1
a23 2
#MASTER_SITES =	http://ccxvii.net/mupdf/download/
MASTER_SITES =	http://spacehopper.org/mirrors/
@


1.10
log
@Fix manpage following suggestions/diff from Bryan Linton, thanks!
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2009/09/20 10:22:03 sthen Exp $
d5 1
a5 1
PKGNAME =	mupdf-0.4p5
d27 3
a29 2
LIB_DEPENDS =	openjpeg::graphics/openjpeg \
		jpeg.>=62::graphics/jpeg
d43 1
@


1.9
log
@Update to a newer snapshot.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2009/08/10 06:34:56 kili Exp $
d5 1
a5 1
PKGNAME =	mupdf-0.4p4
@


1.8
log
@WANTLIB changes after xcb addition and bump.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2009/07/14 19:20:41 sthen Exp $
d5 2
a6 2
PKGNAME =	mupdf-0.4p3
DISTNAME =	mupdf-2009-07-07-source
d20 1
a20 1
WANTLIB =	X11 Xext c freetype m pthread pthread-stubs xcb z
d22 2
a23 1
MASTER_SITES =	http://ccxvii.net/mupdf/download/
@


1.7
log
@Trap SHM errors from X, and fall back to !SHM. this lets mupdf work
with a remote DISPLAY (diff also sent upstream). Clues from oga@@ and
reading the VLC source code. Thanks naddy@@ for testing.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2009/07/14 15:38:46 sthen Exp $
d5 1
a5 1
PKGNAME =	mupdf-0.4p2
d20 1
a20 1
WANTLIB =	X11 Xext c freetype m pthread z
@


1.6
log
@- update to newer snapshot, using the source code tarballs now
available from upstream.

- switch from jasper to openjpeg, fixes JPEG2000 image display
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2009/07/12 19:40:11 sthen Exp $
d5 1
a5 1
PKGNAME =	mupdf-0.4p1
@


1.5
log
@add no_cjk FLAVOR giving a smaller binary for systems where disk space
is at a premium. (memory use of the two is pretty similar).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2009/06/22 11:56:15 sthen Exp $
d5 2
a6 2
DISTNAME =	fitz-0.4
PKGNAME =	${DISTNAME:S/fitz/mupdf/}p0
d20 1
a20 1
WANTLIB =	X11 Xext c freetype m z
d22 1
a22 2
# from darcs checkout
MASTER_SITES =	http://spacehopper.org/mirrors/
d26 1
a26 1
LIB_DEPENDS =	jasper::graphics/jasper \
d35 1
a35 1
MAKE_ENV +=		CC=${CC} CXX=${CXX}
d40 1
a40 1
	-sHAVE_JASPER=yes \
d43 2
a44 2
	-sTHIRDPARTYINC="`freetype-config --cflags` -I${LOCALBASE}/include" \
	-sTHIRDPARTYLIB="`freetype-config --libs` -L${LOCALBASE}/lib"
d57 1
@


1.4
log
@update to 0.4; thanks very much to Tor Andersson (upstream author) who
has clarified the license, so packages are now enabled.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2009/06/19 13:42:29 sthen Exp $
d6 1
a6 1
PKGNAME =	${DISTNAME:S/fitz/mupdf/}
d46 7
@


1.3
log
@- add a new generator supplied by Roberto Fernandez which
greatly reduces memory use building font tables. tested arm,
sparc64, amd64, i386.

- enable CJK fonts on small mem arch, remove VMEM_WARNING.

- bump.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2009/06/19 00:51:49 sthen Exp $
d5 2
a6 2
DISTNAME =	fitz-0.0.20090616
PKGNAME =	mupdf-0.0.20090616p0
d14 5
a18 7
# Code: GPLv3 but needs some copyright notices adding.
# cmaps: Adobe (redist ok, see headers in files)
# droid font: Apache license
PERMIT_PACKAGE_CDROM =	not yet
PERMIT_PACKAGE_FTP =	not yet
PERMIT_DISTFILES_CDROM =not yet
PERMIT_DISTFILES_FTP =	not yet
@


1.2
log
@update to a newer snapshot (much smaller tar.gz thanks to a suggestion
from Roberto Fernandez).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2009/06/02 22:15:08 sthen Exp $
d6 1
a6 1
PKGNAME =	mupdf-0.0.20090616
d49 1
a49 8
# built-in CJK fonts and data files use way too much compiler
# memory, even with -O0.
.if (${MACHINE_ARCH} != "i386" && ${MACHINE_ARCH} != "sparc64" && \
    ${MACHINE_ARCH} != "amd64" && ${MACHINE_ARCH} != "hppa")
JAMFLAGS +=	-sDEFINES=NOCJK
.else
VMEM_WARNING =	Yes
.endif
d51 2
a52 1
SEPARATE_BUILD =	concurrent
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2009/04/05 11:58:38 sthen Exp $
d5 2
a6 2
DISTNAME =	fitz-0.0.20090601
PKGNAME =	mupdf-0.0.20090601
d14 3
a16 2
# Code: GPLv2 but XXX missing copyright information and license headers
# Fonts: Adobe/Apache license
d66 1
a66 1
.for x in cmapdump fontdump pdfclean pdfdraw pdfextract pdfinfo pdfshow
@


1.1.1.1
log
@import Fitz/MuPDF. incomplete copyright notices so PERMIT_* are
disabled for now. "i'm stunned by the quality and that it doesn't
choke on a recent document[0] where xpdf had issues with" simon@@
(who also helped tracking down the key bindings, thanks!).


Fitz is a project to create a new and modern graphics library.
At the core of Fitz is the display tree: a scene graph of vector
graphics, images and text making up the contents of a page.

The standard components of Fitz are:

    * Base runtime (thin memory and error handling layer)
    * Streams and filters (standard postscript, pdf and tiff filters)
    * World model (display trees and resources)
    * Drawing (draw the tree to a bitmap raster) 

MuPDF is a PDF parser that reads PDF files and creates Fitz trees.

MuPDF also has an API to modify internal objects in the PDF files
and write PDF files. For instance, it is possible to use the MuPDF
library to encrypt existing PDF files, or to rearrange the pages.

pdftool is a commandline demo of this functionality; it is a portable
pdf swiss army knife for fixing broken pdf files, changing permissions,
merging and extracting pages, and examining the internal object
structure of a PDF file.

The mupdf binary (aka pdfview) is a bare bones PDF viewer. 
@
text
@@
