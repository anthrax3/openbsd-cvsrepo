head	1.2;
access;
symbols
	OPENBSD_5_4:1.1.0.2
	OPENBSD_5_4_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2013.10.29.22.08.59;	author sthen;	state dead;
branches;
next	1.1;

1.1
date	2013.04.29.12.54.00;	author sthen;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Update to MuPDF 1.3, and enable cURL support (separate binary, not subpackaged
here as cURL is a fairly common package).

Earlier version without cURL support ok rpe@@, additional tests on various
arch from brett@@, Florian Stinglmayr and Donovan Watteau (who also reminded
me about a change of name for mubusy needed in DESCR).
@
text
@$OpenBSD: patch-apps_pdfapp_c,v 1.1 2013/04/29 12:54:00 sthen Exp $

From a20d6a58ebc6c60ff44f0f385cf399ee6fca55bf Mon Sep 17 00:00:00 2001
From: Robin Watts <Robin.Watts@@artifex.com>
Date: Fri, 26 Apr 2013 12:21:17 +0100
Subject: [PATCH] Fix dirty flag handling bug in X11 event loop.

--- apps/pdfapp.c.orig	Mon Apr 29 13:47:16 2013
+++ apps/pdfapp.c	Mon Apr 29 13:47:53 2013
@@@@ -1688,7 +1688,6 @@@@ void pdfapp_postblit(pdfapp_t *app)
 	if (llama >= 256)
 	{
 		/* Completed. */
-		app->in_transit = 0;
 		fz_drop_pixmap(app->ctx, app->image);
 		app->image = app->new_image;
 		app->new_image = NULL;
@@@@ -1700,4 +1699,9 @@@@ void pdfapp_postblit(pdfapp_t *app)
 	else
 		fz_generate_transition(app->image, app->old_image, app->new_image, llama, &app->transition);
 	winrepaint(app);
+	if (llama >= 256)
+	{
+		/* Completed. */
+		app->in_transit = 0;
+	}
 }
@


1.1
log
@better fix for slow scrolling, from upstream repo
@
text
@d1 1
a1 1
$OpenBSD$
@

