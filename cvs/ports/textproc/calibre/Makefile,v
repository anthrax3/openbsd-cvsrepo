head	1.61;
access;
symbols
	OPENBSD_6_1:1.58.0.2
	OPENBSD_6_1_BASE:1.58
	OPENBSD_6_0:1.54.0.2
	OPENBSD_6_0_BASE:1.54
	OPENBSD_5_9:1.49.0.2
	OPENBSD_5_9_BASE:1.49
	OPENBSD_5_8:1.41.0.4
	OPENBSD_5_8_BASE:1.41
	OPENBSD_5_7:1.39.0.2
	OPENBSD_5_7_BASE:1.39
	OPENBSD_5_6:1.35.0.2
	OPENBSD_5_6_BASE:1.35
	OPENBSD_5_5:1.26.0.2
	OPENBSD_5_5_BASE:1.26
	OPENBSD_5_4:1.21.0.2
	OPENBSD_5_4_BASE:1.21
	OPENBSD_5_3:1.16.0.2
	OPENBSD_5_3_BASE:1.16
	OPENBSD_5_2:1.14.0.2
	OPENBSD_5_2_BASE:1.14
	OPENBSD_5_1_BASE:1.11
	OPENBSD_5_1:1.11.0.2
	OPENBSD_5_0:1.4.0.2
	OPENBSD_5_0_BASE:1.4
	phessler_20110417:1.1.1.1
	phessler:1.1.1;
locks; strict;
comment	@# @;


1.61
date	2017.05.15.14.37.41;	author sthen;	state Exp;
branches;
next	1.60;
commitid	1H15IvrQJzOaojjH;

1.60
date	2017.05.13.18.26.03;	author espie;	state Exp;
branches;
next	1.59;
commitid	jRJgIAvJ6a44qp8p;

1.59
date	2017.04.21.11.51.24;	author sthen;	state Exp;
branches;
next	1.58;
commitid	2lCoaItPAAK0OKOx;

1.58
date	2017.03.28.10.57.51;	author sthen;	state Exp;
branches;
next	1.57;
commitid	WgXV3gij4CKPglnh;

1.57
date	2017.02.06.22.39.05;	author sthen;	state Exp;
branches;
next	1.56;
commitid	xEraAPnHyqawl4H4;

1.56
date	2017.01.12.23.39.53;	author sthen;	state Exp;
branches;
next	1.55;
commitid	AAriHPkAcJr5uEmM;

1.55
date	2016.12.25.14.34.40;	author zhuk;	state Exp;
branches;
next	1.54;
commitid	l6KSNN1DfB6ABkhu;

1.54
date	2016.06.27.23.05.11;	author sthen;	state Exp;
branches;
next	1.53;
commitid	GDaj1IvrlBxz10sU;

1.53
date	2016.06.16.22.59.23;	author sthen;	state Exp;
branches;
next	1.52;
commitid	ia8KhM0NAGDnRe8L;

1.52
date	2016.05.06.21.52.11;	author sthen;	state Exp;
branches;
next	1.51;
commitid	KJVRRWQt7StfvJ5q;

1.51
date	2016.03.29.16.21.03;	author sthen;	state Exp;
branches;
next	1.50;
commitid	BlViLehbmo3oBV98;

1.50
date	2016.02.28.22.26.53;	author sthen;	state Exp;
branches;
next	1.49;
commitid	aXX0y9qMMQfXYerF;

1.49
date	2016.01.31.20.27.45;	author sthen;	state Exp;
branches
	1.49.2.1;
next	1.48;
commitid	47LrenNXzSyVjlfi;

1.48
date	2016.01.21.09.12.11;	author sthen;	state Exp;
branches;
next	1.47;
commitid	a5pGfiSXRrfWpnHG;

1.47
date	2016.01.20.23.08.21;	author sthen;	state Exp;
branches;
next	1.46;
commitid	URYLrWLxWaMAirN7;

1.46
date	2016.01.20.17.17.19;	author sthen;	state Exp;
branches;
next	1.45;
commitid	VfCGAVWYooK8Ht3t;

1.45
date	2015.12.15.22.03.58;	author sthen;	state Exp;
branches;
next	1.44;
commitid	YVifzObgrxC3tP3Z;

1.44
date	2015.11.06.20.37.35;	author sthen;	state Exp;
branches;
next	1.43;
commitid	PjPpZyw8X2OGSgMF;

1.43
date	2015.09.29.10.52.35;	author sthen;	state Exp;
branches;
next	1.42;
commitid	kK00TsVxnVFlTJwI;

1.42
date	2015.08.20.09.44.13;	author jasper;	state Exp;
branches;
next	1.41;
commitid	ksMDXweCLp7T5p54;

1.41
date	2015.03.27.08.14.15;	author ajacoutot;	state Exp;
branches
	1.41.4.1;
next	1.40;
commitid	ERm8DOTUF1j7394B;

1.40
date	2015.03.26.12.14.15;	author sthen;	state Exp;
branches;
next	1.39;
commitid	qYDTmzXxLoW0kaEv;

1.39
date	2014.10.06.19.52.36;	author sthen;	state Exp;
branches;
next	1.38;
commitid	XvCv4y1USW8uBZkN;

1.38
date	2014.09.21.16.50.24;	author sthen;	state Exp;
branches;
next	1.37;
commitid	YoA3rbTSQBo4u4vg;

1.37
date	2014.08.14.07.06.00;	author ajacoutot;	state Exp;
branches;
next	1.36;
commitid	Ox5isqCVDwHCpoCU;

1.36
date	2014.08.10.19.50.37;	author sthen;	state Exp;
branches;
next	1.35;
commitid	GwLEv8A5CXHwEolj;

1.35
date	2014.07.15.23.33.48;	author sthen;	state Exp;
branches;
next	1.34;
commitid	1DVGqIbJU1ebUv5d;

1.34
date	2014.07.08.09.55.16;	author sthen;	state Exp;
branches;
next	1.33;
commitid	c4ZiHZYgUjMrIfwC;

1.33
date	2014.05.15.10.10.01;	author sthen;	state Exp;
branches;
next	1.32;

1.32
date	2014.04.27.21.10.17;	author sthen;	state Exp;
branches;
next	1.31;

1.31
date	2014.04.07.00.21.28;	author sthen;	state Exp;
branches;
next	1.30;

1.30
date	2014.04.06.21.10.30;	author sthen;	state Exp;
branches;
next	1.29;

1.29
date	2014.04.06.11.32.04;	author sthen;	state Exp;
branches;
next	1.28;

1.28
date	2014.03.31.23.54.35;	author sthen;	state Exp;
branches;
next	1.27;

1.27
date	2014.03.19.02.15.46;	author sthen;	state Exp;
branches;
next	1.26;

1.26
date	2014.01.16.21.40.17;	author sthen;	state Exp;
branches;
next	1.25;

1.25
date	2014.01.16.09.16.31;	author sthen;	state Exp;
branches;
next	1.24;

1.24
date	2013.11.09.15.02.14;	author sthen;	state Exp;
branches;
next	1.23;

1.23
date	2013.11.08.22.41.29;	author sthen;	state Exp;
branches;
next	1.22;

1.22
date	2013.08.15.18.42.03;	author kili;	state Exp;
branches;
next	1.21;

1.21
date	2013.05.13.19.12.36;	author fgsch;	state Exp;
branches;
next	1.20;

1.20
date	2013.05.12.23.00.57;	author sthen;	state Exp;
branches;
next	1.19;

1.19
date	2013.04.03.07.51.31;	author ajacoutot;	state Exp;
branches;
next	1.18;

1.18
date	2013.03.11.23.06.12;	author fgsch;	state Exp;
branches;
next	1.17;

1.17
date	2013.03.11.11.42.40;	author espie;	state Exp;
branches;
next	1.16;

1.16
date	2012.12.23.12.25.30;	author sthen;	state Exp;
branches;
next	1.15;

1.15
date	2012.08.28.19.13.12;	author espie;	state Exp;
branches;
next	1.14;

1.14
date	2012.07.10.18.33.18;	author kili;	state Exp;
branches;
next	1.13;

1.13
date	2012.06.15.08.32.17;	author ajacoutot;	state Exp;
branches;
next	1.12;

1.12
date	2012.06.03.20.17.24;	author landry;	state Exp;
branches;
next	1.11;

1.11
date	2011.12.20.11.25.44;	author sthen;	state Exp;
branches;
next	1.10;

1.10
date	2011.12.03.23.04.37;	author ajacoutot;	state Exp;
branches;
next	1.9;

1.9
date	2011.10.21.16.23.45;	author espie;	state Exp;
branches;
next	1.8;

1.8
date	2011.09.29.17.33.31;	author jasper;	state Exp;
branches;
next	1.7;

1.7
date	2011.09.16.11.41.40;	author espie;	state Exp;
branches;
next	1.6;

1.6
date	2011.09.13.07.00.48;	author jasper;	state Exp;
branches;
next	1.5;

1.5
date	2011.09.05.12.38.36;	author jasper;	state Exp;
branches;
next	1.4;

1.4
date	2011.06.08.18.09.58;	author jasper;	state Exp;
branches;
next	1.3;

1.3
date	2011.06.07.19.45.16;	author landry;	state Exp;
branches;
next	1.2;

1.2
date	2011.05.23.06.10.43;	author weerd;	state Exp;
branches;
next	1.1;

1.1
date	2011.04.17.18.39.21;	author phessler;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2011.04.17.18.39.21;	author phessler;	state Exp;
branches;
next	;

1.41.4.1
date	2015.08.24.09.38.54;	author sthen;	state Exp;
branches;
next	;
commitid	zQaEdWemMaN1LByC;

1.49.2.1
date	2016.05.06.21.35.59;	author sthen;	state Exp;
branches;
next	;
commitid	vDjdgur9VOwg5QQm;


desc
@@


1.61
log
@update to calibre-2.85.1
@
text
@# $OpenBSD: Makefile,v 1.60 2017/05/13 18:26:03 espie Exp $

COMMENT =		ebook management application

V =			2.85.1
DISTNAME =		calibre-$V
CATEGORIES =		textproc
EXTRACT_SUFX =		.tar.xz

HOMEPAGE =		http://calibre-ebook.com/

MAINTAINER =		Stuart Henderson <sthen@@openbsd.org>

# GPLv3
PERMIT_PACKAGE_CDROM =	Yes

WANTLIB += EGL GL Qt5Core Qt5DBus Qt5Gui Qt5Widgets X11 Xext Xrender
WANTLIB += chm crypto fontconfig freetype glib-2.0 gthread-2.0
WANTLIB += icudata icui18n icuio icuuc intl m podofo pthread
WANTLIB += z ${MODPY_WANTLIB}

MASTER_SITES =	https://github.com/kovidgoyal/calibre/releases/download/v$V/

MODULES =		lang/python \
			x11/qt5

LIB_DEPENDS=		devel/chmlib \
			devel/gettext \
			textproc/icu4c \
			textproc/podofo

COMMON_DEPENDS =	databases/py-apsw \
			devel/py-dateutil \
			devel/xdg-utils \
			graphics/libwmf \
			graphics/py-Pillow \
			net/py-dnspython \
			graphics/png \
			print/poppler, \
			print/poppler,,-qt5 \
			textproc/py-cssselect \
			textproc/py-cssutils>=0.9.9 \
			textproc/py-lxml>=2.2.8 \
			textproc/py-xml \
			www/py-beautifulsoup \
			www/py-CherryPy \
			www/py-mechanize \
			x11/py-qt5 \
			www/py-mechanize

BUILD_DEPENDS =		${COMMON_DEPENDS}

SUBST_VARS =		WRKDIR

RUN_DEPENDS =		${COMMON_DEPENDS} \
			devel/desktop-file-utils \
			misc/shared-mime-info \
			net/py-netifaces \
			print/poppler,-utils \
			x11/gtk+3,-guic

LDFLAGS +=		-L${LOCALBASE}/lib
MAKE_ENV +=		QMAKE="${LOCALBASE}/bin/qmake-qt5"
MAKE_ENV +=		LDFLAGS="${LDFLAGS}"
MAKE_ENV +=		FT_LIB_DIR="${X11BASE}/lib"
MAKE_ENV +=		XDG_DATA_DIRS="${PREFIX}/share"
MAKE_ENV +=		PODOFO_INC_DIR="${LOCALBASE}/include/podofo"
MAKE_ENV +=		PODOFO_LIB_DIR="${LOCALBASE}/lib"

PORTHOME =		${WRKDIR}
NO_TEST =		Yes
MODPY_SETUPTOOLS =	Yes

## setup.py doesn't like the options in our python module
MODPY_DISTUTILS_BUILD =		build
MODPY_DISTUTILS_INSTALL =	install --prefix=${LOCALBASE} \
				--root=${PREFIX}

# There are ERANGE files that hard-code the python bin name
# Remove bundled cherrypy so it uses the system version
pre-configure:
	cd ${WRKSRC} && (rm -rf src/cherrypy ; \
		find . -name '*.py' -print0 | xargs -0 perl -pi.beforesubst -e \
		's,#!/usr/bin/env python(2)?,#!${MODPY_BIN},' )
	cd ${WRKSRC}/setup && ${SUBST_CMD} build.py build_environment.py
	cp ${FILESDIR}/fake-xdg ${WRKDIR}/bin; chmod +x ${WRKDIR}/bin/fake-xdg
.for i in xdg-icon-resource xdg-desktop-menu xdg-mime
	ln -s fake-xdg ${WRKDIR}/bin/$i
.endfor

do-install:
	${MODPY_CMD} ${MODPY_DISTUTILS_INSTALL} ${MODPY_DISTUTILS_INSTALLARGS}
	rm -rf ${WRKDIR}/.config # to unbreak 'make clean'; created as root
	${INSTALL_DATA_DIR} ${PREFIX}/share/calibre/recipes
	cd ${WRKSRC}/recipes && find . -type f -exec \
	    ${INSTALL_DATA} {} ${PREFIX}/share/calibre/recipes/ \;

post-install:
	${MODPY_BIN} ${MODPY_LIBDIR}/compileall.py ${PREFIX}/lib/calibre
	${MODPY_BIN} ${MODPY_LIBDIR}/compileall.py ${PREFIX}/share/calibre

.include <bsd.port.mk>
@


1.60
log
@make sure to have correct access to /usr/local, fixes build with clang
also use .beforesubst so regenerating patches is less of a pain
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59 2017/04/21 11:51:24 sthen Exp $
d5 1
a5 1
V =			2.83.0
@


1.59
log
@update to calibre-2.83.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2017/03/28 10:57:51 sthen Exp $
d83 1
a83 1
		find . -name '*.py' -print0 | xargs -0 perl -pi -e \
@


1.58
log
@update to calibre-2.82.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.57 2017/02/06 22:39:05 sthen Exp $
d5 1
a5 1
V =			2.82.0
@


1.57
log
@update to calibre-2.78.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2017/01/12 23:39:53 sthen Exp $
d5 1
a5 1
V =			2.78.0
@


1.56
log
@update to calibre-2.76.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55 2016/12/25 14:34:40 zhuk Exp $
d5 1
a5 1
V =			2.76.0
@


1.55
log
@Adapt to new x11/qt5 layout, mostly REVISION bumps due to changed deps.

The devel/kf5 to be handled separately, please wait.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.54 2016/06/27 23:05:11 sthen Exp $
d5 1
a5 1
V =			2.60.0
a8 1
REVISION =		0
d19 2
a20 2
WANTLIB += icudata icui18n icuio icuuc intl m mtp podofo pthread
WANTLIB += usb-1.0 z ${MODPY_WANTLIB}
a28 2
			devel/libmtp \
			devel/libusb1 \
d85 1
a85 1
	cd ${WRKSRC}/setup && ${SUBST_CMD} extensions.py build_environment.py
@


1.54
log
@update to calibre-2.60.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2016/06/16 22:59:23 sthen Exp $
d9 1
@


1.53
log
@update to calibre-2.58.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.52 2016/05/06 21:52:11 sthen Exp $
d5 1
a5 1
V =			2.58.0
@


1.52
log
@update to calibre-2.56.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 2016/03/29 16:21:03 sthen Exp $
d5 1
a5 1
V =			2.56.0
d17 4
a20 5
WANTLIB += ${MODPY_WANTLIB}
WANTLIB += EGL GL MagickCore-6.Q16 MagickWand-6.Q16 Qt5Core Qt5DBus
WANTLIB += Qt5Gui Qt5Widgets X11 Xext Xrender chm crypto fontconfig
WANTLIB += freetype glib-2.0 gthread-2.0 iconv icudata icui18n icuio
WANTLIB += icuuc intl m mtp podofo pthread usb-1.0 z
a30 1
			graphics/ImageMagick \
@


1.51
log
@update to calibre-2.53.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2016/02/28 22:26:53 sthen Exp $
d5 1
a5 1
V =			2.53.0
d20 2
a21 2
WANTLIB += freetype glib-2.0 gthread-2.0 icudata icui18n icuio
WANTLIB += icuuc m mtp podofo pthread usb-1.0 z
d25 1
a25 2
MODULES =		devel/gettext \
			lang/python \
d29 1
@


1.50
log
@update to calibre-2.52.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2016/01/31 20:27:45 sthen Exp $
d5 1
a5 1
V =			2.52.0
@


1.49
log
@update to calibre-2.50.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2016/01/21 09:12:11 sthen Exp $
d5 1
a5 1
V =			2.50.1
@


1.49.2.1
log
@bump users of MagickWand-6.Q16 and Magick++-6.Q16 in -stable due to
shlib major bump in ImageMagick update; thanks jasper for the list
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2016/01/31 20:27:45 sthen Exp $
a5 1
REVISION =		0
@


1.48
log
@Add a run dep on net/py-netifaces to Calibre
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2016/01/20 23:08:21 sthen Exp $
d5 1
a5 2
V =			2.49.0
REVISION =		1
@


1.47
log
@Disable some annoying warnings at Calibre startup time.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2016/01/20 17:17:19 sthen Exp $
d6 1
a6 1
REVISION =		0
d63 1
@


1.46
log
@update to Calibre 2.49.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2015/12/15 22:03:58 sthen Exp $
d6 1
a57 3
# aaaargh
#BUILD_DEPENDS +=	x11/qt5:patch

a72 3

# Requires /sys filesystem for HW detection
MAKE_ENV +=		WITH_USB=no
@


1.45
log
@major update to calibre-2.46.0 (now that we have poppler-qt5 / py-qt5)

- working for my use case and some other things I've thought of checking,
but please test and let me know if you run into problems.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2015/11/06 20:37:35 sthen Exp $
d5 1
a5 1
V =			2.46.0
d23 1
a23 1
MASTER_SITES =		https://github.com/kovidgoyal/calibre/releases/download/v$V/
@


1.44
log
@fix following ImageMagick update
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2015/09/29 10:52:35 sthen Exp $
d5 2
a6 2
# 2.x versions use qt5
DISTNAME =		calibre-1.48.0
a7 1
MASTER_SITES =		${MASTER_SITE_SOURCEFORGE:=calibre/}
a8 1
REVISION =		7
a16 3
MODULES =		lang/python \
			x11/qt4

d18 10
a27 4
WANTLIB += ICE MagickCore-6.Q16 MagickWand-6.Q16 lib/qt4/QtDBus lib/qt4/QtGui
WANTLIB += lib/qt4/QtSvg lib/qt4/QtXml SM X11 Xext Xi Xinerama Xrender
WANTLIB += chm fontconfig freetype icudata icui18n icuio icuuc m mtp
WANTLIB += podofo pthread stdc++ usb-1.0 z
d44 1
a44 1
			print/poppler,,-qt4 \
d52 1
a52 1
			x11/py-qt4>=4.8.2p1 \
d57 2
a58 6
# This is a disgusting workaround for calibre depending on private Qt4
# interfaces that are not intended for external use. Upstream is fairly
# hostile towards packagers and would prefer people directly run a file
# from his website as root without any verification.
BUILD_DEPENDS +=	x11/qt4:patch
UPSTREAM_CLUE_LEVEL =	0 # https://bugs.launchpad.net/calibre/+bug/1094719
d69 1
a69 1
MAKE_ENV +=		QMAKE="${LOCALBASE}/bin/qmake4"
a78 1
WRKDIST =		${WRKDIR}/calibre
d88 1
a88 1
# There are 901 files that hard-code the python bin name
a93 1
	cd ${WRKDIR}; ln -fs x11/qt4/qt-everywhere-opensource-src-*/include
@


1.43
log
@bump REVISION for setuptools dep change.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2015/08/20 09:44:13 jasper Exp $
d10 1
a10 1
REVISION =		6
d23 1
a23 1
WANTLIB += ICE MagickCore MagickWand lib/qt4/QtDBus lib/qt4/QtGui
a37 1
			graphics/ImageMagick \
@


1.42
log
@unbreak convert dialog, from upstream

spotted by deraadt@@, ok sthen@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2015/03/27 08:14:15 ajacoutot Exp $
d10 1
a10 1
REVISION =		5
@


1.41
log
@x11/gtk+2,-guic -> x11/gtk+3,-guic && bump
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2015/03/26 12:14:15 sthen Exp $
d10 1
a10 1
REVISION =		4
@


1.41.4.1
log
@MFC fix to cope with the py-qt4 update that broke calibre
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2015/03/27 08:14:15 ajacoutot Exp $
d10 1
a10 1
REVISION =		5
@


1.40
log
@REVISION bumps for py-Pillow RDEP change
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2014/10/06 19:52:36 sthen Exp $
d10 1
a10 1
REVISION =		3
d70 1
a70 1
			x11/gtk+2,-guic
@


1.39
log
@take maintainer
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2014/09/21 16:50:24 sthen Exp $
d10 1
a10 1
REVISION =		2
@


1.38
log
@add b/rdep on py-xml, seems to be needed - failure to install bash-completions
file with an "ImportError: No module named saxlib" in the backtrace via
src/calibre/ebooks/lrf/pylrs/pylrs.py.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2014/08/14 07:06:00 ajacoutot Exp $
d10 1
a10 1
REVISION =		1
d13 2
@


1.37
log
@Bump after py-Pillow sub-packaging.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2014/08/10 19:50:37 sthen Exp $
d5 1
d10 1
a10 1
REVISION =		0
d46 1
@


1.36
log
@update to Calibre 1.48.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2014/07/15 23:33:48 sthen Exp $
d9 1
@


1.35
log
@update to calibre 1.44.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2014/07/08 09:55:16 sthen Exp $
d5 1
a5 1
DISTNAME =		calibre-1.44.0
@


1.34
log
@update to calibre 1.43.0 and add a patch from Fabian Raetz enabling
--detach (used by some desktop files).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2014/05/15 10:10:01 sthen Exp $
d5 1
a5 1
DISTNAME =		calibre-1.43.0
@


1.33
log
@update to calibre 1.36.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2014/04/27 21:10:17 sthen Exp $
d5 1
a5 1
DISTNAME =		calibre-1.36.0
@


1.32
log
@update to calibre 1.34
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2014/04/07 00:21:28 sthen Exp $
d5 1
a5 1
DISTNAME =		calibre-1.34.0
@


1.31
log
@update to calibre 1.31.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2014/04/06 21:10:30 sthen Exp $
d5 1
a5 1
DISTNAME =		calibre-1.31.0
@


1.30
log
@switch py-Imaging to py-Pillow, plus some "s/import Image/from PIL import Image/" patches where necessary
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2014/04/06 11:32:04 sthen Exp $
d5 1
a5 2
DISTNAME =		calibre-1.30.0
REVISION =		1
@


1.29
log
@remove the hack that permitted building without podofo
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2014/03/31 23:54:35 sthen Exp $
d6 1
a6 1
REVISION =		0
d37 1
a37 1
			graphics/py-Imaging \
@


1.28
log
@update to calibre 1.30.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2014/03/19 02:15:46 sthen Exp $
d6 1
d23 1
a23 1
WANTLIB += pthread stdc++ usb-1.0 z
d29 2
a30 1
			textproc/icu4c
a31 2
# XXX PoDoFo should be ported and added here; then remove hack
# XXX from patch-setup_extensions_py that makes it optional
d73 2
a74 2
#MAKE_ENV +=		PODOFO_INC_DIR="${LOCALBASE}/include/podofo"
#MAKE_ENV +=		PODOFO_LIB_DIR="${LOCALBASE}/lib"
@


1.27
log
@update to calibre 1.28.0 and replace a nasty block of patching with a helper
script that mimics various xdg-* utils to install under the fake dir.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2014/01/16 21:40:17 sthen Exp $
d5 1
a5 1
DISTNAME =		calibre-1.28.0
d73 2
@


1.26
log
@py-apsw is now a build dependency too, found by nigel@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2014/01/16 09:16:31 sthen Exp $
d5 1
a5 1
DISTNAME =		calibre-1.19.0
d19 4
a22 3
WANTLIB += ICE MagickCore MagickWand QtDBus QtGui QtSvg QtXml
WANTLIB += SM X11 Xext Xi Xinerama Xrender chm fontconfig freetype
WANTLIB += icudata icui18n icuio icuuc m mtp pthread stdc++ usb-1.0 z
d30 2
a44 1
			textproc/py-pdf \
d65 2
a66 1
			print/poppler,-utils
a67 1
#CFLAGS +=		-I${X11BASE}/include -I${LOCALBASE}/include
d72 1
d88 1
a88 1
# Remove bundled cherrypy and pyPdf so it uses the system versions
d90 1
a90 1
	cd ${WRKSRC} && (rm -rf src/cherrypy src/pyPdf ; \
d93 1
a93 1
	cd ${WRKDIR}; ln -s x11/qt4/qt-everywhere-opensource-src-*/include
d95 4
d108 2
a109 4
	${MODPY_BIN} ${MODPY_LIBDIR}/compileall.py \
		${PREFIX}/lib/calibre
	${MODPY_BIN} ${MODPY_LIBDIR}/compileall.py \
		${PREFIX}/share/calibre
@


1.25
log
@update to calibre-1.19.0, ok dcoppa@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2013/11/09 15:02:14 sthen Exp $
d29 2
a30 1
COMMON_DEPENDS =	devel/py-dateutil \
a60 1
			databases/py-apsw \
@


1.24
log
@Update calibre to 1.10.0, unbreaking the port. This removes various
diffs to fix with newer poppler/png.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2013/11/08 22:41:29 sthen Exp $
d5 1
a5 1
DISTNAME =		calibre-1.10.0
@


1.23
log
@temporarily mark broken; diff to follow on ports@@.
thus ends the breakage.
@
text
@d1 1
a1 3
# $OpenBSD: Makefile,v 1.22 2013/08/15 18:42:03 kili Exp $

BROKEN = temporarily broken, py-qt4 update
d5 1
a5 1
DISTNAME =		calibre-0.8.20
d8 1
a8 1
REVISION =		8
d18 4
a21 5
WANTLIB +=		ICE MagickCore MagickWand QtGui SM X11 Xext
WANTLIB +=		Xi Xinerama Xrender c chm fontconfig freetype
WANTLIB +=		icudata icui18n icuio icuuc m png poppler
WANTLIB +=		stdc++ pthread
WANTLIB +=		${MODPY_WANTLIB}
d24 2
a26 2
			graphics/png \
			print/poppler, \
d35 2
d38 2
a39 1
			textproc/py-cssutils>=0.9.7 \
d50 9
d60 1
d65 5
a69 8
CFLAGS +=		"-I${LOCALBASE}/include"
LDFLAGS +=		"-L${LOCALBASE}/lib"
MAKE_ENV +=		QMAKE="${LOCALBASE}/bin/qmake4" \
			LDFLAGS="${LDFLAGS}" \
			FC_INC_DIR="${X11BASE}/include" \
			FC_LIB_DIR="${X11BASE}/lib" \
			PNG_INC_DIR="`pkg-config --cflags libpng`" \
			PNG_LIB_DIR="`pkg-config --libs libpng`"
d90 2
d95 1
a95 1
	chmod 755 ${PREFIX}/bin/calibre-mount-helper
a104 1

@


1.22
log
@Fix build with poppler-0.24.

ok ajacoutot@@
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.21 2013/05/13 19:12:36 fgsch Exp $
@


1.21
log
@_MODPY_CMD -> MODPY_CMD
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2013/05/12 23:00:57 sthen Exp $
d8 1
a8 1
REVISION =		7
@


1.20
log
@add a missing run dep on poppler-utils (for pdftohtml)
(this could use an update too, really..)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2013/04/03 07:51:31 ajacoutot Exp $
d83 1
a83 1
	${_MODPY_CMD} ${MODPY_DISTUTILS_INSTALL} ${MODPY_DISTUTILS_INSTALLARGS}
@


1.19
log
@Missing RUN_DEPENDS.
Remove uneeded goo.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2013/03/11 23:06:12 fgsch Exp $
d8 1
a8 1
REVISION =		6
d50 2
a51 1
			misc/shared-mime-info
d67 1
a67 1
NO_TEST = 		Yes
d71 1
a71 1
MODPY_DISTUTILS_BUILD = 	build
@


1.18
log
@and last bump after py-Imaging change.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2013/03/11 11:42:40 espie Exp $
d8 1
a8 1
REVISION =		5
d29 2
a30 1
RUN_DEPENDS =		devel/py-dateutil \
d44 7
a50 3
			www/py-mechanize \
			x11/gtk+2,-guic
BUILD_DEPENDS =		${RUN_DEPENDS}
@


1.17
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2012/12/23 12:25:30 sthen Exp $
d8 1
a8 1
REVISION =		4
@


1.16
log
@sync wantlib
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2012/08/28 19:13:12 espie Exp $
a13 3
PERMIT_PACKAGE_FTP =	Yes
PERMIT_DISTFILES_CDROM =Yes
PERMIT_DISTFILES_FTP =	Yes
d61 1
a61 1
NO_REGRESS = 		Yes
@


1.15
log
@switch default poppler flavor to no_qt,no_qt4,boostrap, as naddy@@ now
sees bulk builds with a critical path sequentially building qt4, poppler,
libreoffice...

passes a full bulk

agreed with kili@@, aja@@, naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2012/07/10 18:33:18 kili Exp $
d8 1
a8 1
REVISION =		3
d24 1
a24 1
WANTLIB +=		stdc++
@


1.14
log
@Re-enable calibre; adjust dependencies and wantlib.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2012/06/15 08:32:17 ajacoutot Exp $
d30 1
a30 1
			print/poppler \
d38 1
a38 1
			print/poppler,-qt4 \
@


1.13
log
@gtk-update-icon-cache:
Don't redirect errors to /dev/null and don't return true(1)
unconditionally. Instead, don't check for the existence of index.theme.
This will allow us to catch errors that may be happening because of a
missing dependency in the chain.

Some hidden issues may appear, in which case please contact me.

discussed with and ok blind jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2012/06/03 20:17:24 landry Exp $
a3 1
BROKEN =		fake step gets stuck
d8 1
a8 1
REVISION =		2
d21 4
a24 2
WANTLIB +=		MagickCore MagickWand QtGui X11 Xext c fontconfig m
WANTLIB +=		stdc++ chm icudata icui18n icuio icuuc poppler png
a28 1
			graphics/libwmf \
a29 1
			print/poppler,-qt4 \
d35 1
d38 1
@


1.12
log
@Mark as BROKEN, it doesnt package as make fake gets stuck on 'Running
gui', that disturbs bulk builds and noone of the people using it got
enough incentive to look into it :)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2011/12/20 11:25:44 sthen Exp $
d9 1
a9 1
REVISION =		1
@


1.11
log
@fix; py-Imaging is now flavourless
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2011/12/03 23:04:37 ajacoutot Exp $
d4 1
@


1.10
log
@Add a dependency on x11/gtk+2,-guic.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2011/10/21 16:23:45 espie Exp $
d8 1
a8 1
REVISION =		0
d35 1
a35 1
			py-Imaging-*-python${MODPY_VERSION}:graphics/py-Imaging,python${MODPY_VERSION} \
@


1.9
log
@CHMOD and CHOWN serve no useful purpose, they're just chown/chmod
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2011/09/29 17:33:31 jasper Exp $
d8 1
d44 2
a45 1
			www/py-mechanize
@


1.8
log
@- update to 0.8.20

from viq
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2011/09/16 11:41:40 espie Exp $
d77 1
a77 1
	${CHMOD} 755 ${PREFIX}/bin/calibre-mount-helper
@


1.7
log
@normalize pkgpath
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2011/09/13 07:00:48 jasper Exp $
d5 1
a5 2
DISTNAME =		calibre-0.8.18
REVISION=	0
@


1.6
log
@- update to 0.8.18
- remove outdated comment

from viq
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2011/09/05 12:38:36 jasper Exp $
d6 1
@


1.5
log
@major update to 0.8.17

from viq
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2011/06/08 18:09:58 jasper Exp $
d5 1
a5 2
# 0.7.46 and higher have problems repainting their windows..
DISTNAME =		calibre-0.8.17
@


1.4
log
@bump after default python version switch
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2011/06/07 19:45:16 landry Exp $
d6 1
a6 2
DISTNAME =		calibre-0.7.45
REVISION =		2
d21 4
d28 1
d30 1
d41 1
a41 1
			www/py-cherrypy2 \
d73 2
a74 2
	    find . -name '*.py' -exec \
	    perl -pi -e 's,#!/usr/bin/env python,#!${MODPY_BIN},' {} \; )
d79 10
@


1.3
log
@Depend on the correct flavor of py-Imaging, in preparation for the
python 2.7 switch.
ok naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2011/05/23 06:10:43 weerd Exp $
d7 1
a7 1
REVISION =		1
@


1.2
log
@Add missing run dependency on ImageMagick.  Set HOMEPAGE while here.

OK phessler@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2011/04/17 18:39:21 phessler Exp $
d7 1
a7 1
REVISION =		0
d30 1
a30 1
			graphics/py-Imaging \
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d7 1
d11 2
d29 1
@


1.1.1.1
log
@calibre is a free and open source e-book library management application
developed by users of e-books for users of e-books. It has a cornucopia
of features divided into the following main categories:
 * Library Management
 * E-book conversion
 * Syncing to e-book reader devices
 * Downloading news from the web and converting it into e-book form
 * Comprehensive e-book viewer
 * Content server for online access to your book collection

OK laurent@@, jasper@@
@
text
@@
