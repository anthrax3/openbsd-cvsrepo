head	1.4;
access;
symbols
	OPENBSD_3_3:1.3.0.2
	OPENBSD_3_3_BASE:1.3
	OPENBSD_3_2:1.2.0.6
	OPENBSD_3_2_BASE:1.2
	OPENBSD_3_1:1.2.0.4
	OPENBSD_3_1_BASE:1.2
	OPENBSD_3_0:1.2.0.2
	OPENBSD_3_0_BASE:1.2
	OPENBSD_2_9_TRACKING_SWITCH:1.2;
locks; strict;
comment	@# @;


1.4
date	2003.08.12.04.42.49;	author jolan;	state dead;
branches;
next	1.3;

1.3
date	2003.02.24.04.06.30;	author brad;	state Exp;
branches;
next	1.2;

1.2
date	2001.08.07.13.53.12;	author lebel;	state Exp;
branches;
next	1.1;

1.1
date	2001.07.16.14.48.46;	author lebel;	state Exp;
branches;
next	;


desc
@@


1.4
log
@textproc/pspell is now part of textproc/aspell
@
text
@$OpenBSD: patch-ltcf-c_sh,v 1.3 2003/02/24 04:06:30 brad Exp $
--- ltcf-c.sh.orig	Tue May  1 19:58:17 2001
+++ ltcf-c.sh	Sun Feb 23 21:18:00 2003
@@@@ -47,7 +47,9 @@@@ cygwin* | mingw*)
     with_gnu_ld=no
   fi
   ;;
-
+openbsd*)
+  with_gnu_ld=no
+  ;;
 esac
 
 ld_shlibs=yes
@@@@ -454,10 +456,22 @@@@ else
     ;;
 
   openbsd*)
-    archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'
-    hardcode_libdir_flag_spec='-R$libdir'
     hardcode_direct=yes
     hardcode_shlibpath_var=no
+    case "$host_os" in
+      openbsd[01].* | openbsd2.[0-7] | openbsd2.[0-7].*)
+	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'
+	hardcode_libdir_flag_spec='-R$libdir'
+      ;;
+      *)
+	archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
+	hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
+	if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	  export_dynamic_flag_spec='${wl}-E'
+	fi
+     ;;
+    esac
+  
     ;;
 
   os2*)
@


1.3
log
@some libtool improvements including how to make C++ shared libraries
@
text
@d1 1
a1 1
$OpenBSD: patch-ltcf-c_sh,v 1.2 2001/08/07 13:53:12 lebel Exp $
@


1.2
log
@sync libtool patches
@
text
@d1 15
a15 4
$OpenBSD: patch-ltcf-c_sh,v 1.1 2001/07/16 14:48:46 lebel Exp $
--- ltcf-c.sh.orig	Tue Aug  7 09:46:42 2001
+++ ltcf-c.sh	Tue Aug  7 09:50:02 2001
@@@@ -454,10 +454,22 @@@@ else
d25 1
a25 1
+	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linkopts'
d29 1
a29 1
+	archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $linkopts'
d31 1
a31 1
+	if test "`echo __ELF__ | $CC -E - | grep __ELF__`" = "" -o "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
@


1.1
log
@- make sure it doesn't try to link with libtool by using --disable-ltdl
- add the libtool patches to properly build shared libs on some arch.
@
text
@d1 4
a4 4
$OpenBSD$
--- ltcf-c.sh.orig	Tue May  1 19:57:55 2001
+++ ltcf-c.sh	Mon Jul 16 10:29:38 2001
@@@@ -454,10 +454,14 @@@@ else
a9 4
+    archive_cmds='$CC $pic_flag -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $lib'
+    archive_expsym_cmds='$CC $pic_flag -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $lib'
+    old_archive_cmds="$old_archive_cmds~"'$RANLIB $oldlib'
+    hardcode_libdir_flag_spec='${wl}-R$libdir'
d12 14
a25 2
+    remove_lgcc=yes
+    output_verbose_link_cmds='$CC $ac_cv_prog_cc_pic -shared $CFLAGS -v conftest.$objext 2>&1 | egrep "\-L"'
@

