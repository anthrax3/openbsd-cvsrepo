head	1.6;
access;
symbols
	OPENBSD_6_2:1.6.0.2
	OPENBSD_6_2_BASE:1.6
	OPENBSD_6_1:1.5.0.10
	OPENBSD_6_1_BASE:1.5
	OPENBSD_6_0:1.5.0.8
	OPENBSD_6_0_BASE:1.5
	OPENBSD_5_9:1.5.0.4
	OPENBSD_5_9_BASE:1.5
	OPENBSD_5_8:1.5.0.6
	OPENBSD_5_8_BASE:1.5
	OPENBSD_5_7:1.5.0.2
	OPENBSD_5_7_BASE:1.5
	OPENBSD_5_6:1.4.0.4
	OPENBSD_5_6_BASE:1.4
	OPENBSD_5_5:1.4.0.2
	OPENBSD_5_5_BASE:1.4
	OPENBSD_5_4:1.3.0.2
	OPENBSD_5_4_BASE:1.3
	OPENBSD_5_3:1.1.0.6
	OPENBSD_5_3_BASE:1.1
	OPENBSD_5_2:1.1.0.4
	OPENBSD_5_2_BASE:1.1
	OPENBSD_5_1_BASE:1.1
	OPENBSD_5_1:1.1.0.2;
locks; strict;
comment	@# @;


1.6
date	2017.07.04.17.44.13;	author schwarze;	state Exp;
branches;
next	1.5;
commitid	GhwB1K4KLe4UXs2n;

1.5
date	2014.11.06.22.15.22;	author schwarze;	state Exp;
branches;
next	1.4;
commitid	D3bBI1MjSqXufVLW;

1.4
date	2013.12.15.15.19.50;	author schwarze;	state Exp;
branches;
next	1.3;

1.3
date	2013.07.13.07.39.00;	author schwarze;	state Exp;
branches;
next	1.2;

1.2
date	2013.03.30.23.10.05;	author schwarze;	state Exp;
branches;
next	1.1;

1.1
date	2011.12.04.15.41.26;	author schwarze;	state Exp;
branches;
next	;


desc
@@


1.6
log
@Set the default operating system name for manual pages
to just "OpenBSD": that's the obvious thing to do, no idea why i
didn't do it long ago.  So far, man(7) had no default at all, and
the "OpenBSD ports" used by mdoc(7) no longer makes sense because
only about 25 ports use groff nowadays, and none of those use mdoc(7).
This change is also simplifies groff-mandoc comparisons.
@
text
@$OpenBSD: patch-tmac_an-old_tmac,v 1.5 2014/11/06 22:15:22 schwarze Exp $
Set default operating system name (local change).
Tweak page headers (local change).
Index: tmac/an-old.tmac
--- tmac/an-old.tmac.orig
+++ tmac/an-old.tmac
@@@@ -147,14 +147,14 @@@@
 .    ds an-section "\\$2\"
 .    ds an-extra1 "\\$3\"
 .    ie (\\n[.$] > 3)    .ds an-extra2 "\\$4\"
-.    el                  .ds an-extra2 \"Sun Release 4.0
+.    el                  .ds an-extra2 OpenBSD
 .
 .    ie (\\n[.$] > 4)    .ds an-extra3 "\\$5\"
 .    el \{ .ie '\\$2'1'  .ds an-extra3 General Commands Manual
 .    el \{ .ie '\\$2'2'  .ds an-extra3 System Calls Manual
 .    el \{ .ie '\\$2'3'  .ds an-extra3 Library Functions Manual
-.    el \{ .ie '\\$2'3p' .ds an-extra3 Perl Programmers Reference Guide
-.    el \{ .ie '\\$2'4'  .ds an-extra3 Kernel Interfaces Manual
+.    el \{ .ie '\\$2'3p' .ds an-extra3 Perl Library Manual
+.    el \{ .ie '\\$2'4'  .ds an-extra3 Device Drivers Manual
 .    el \{ .ie '\\$2'5'  .ds an-extra3 File Formats Manual
 .    el \{ .ie '\\$2'6'  .ds an-extra3 Games Manual
 .    el \{ .ie '\\$2'7'  .ds an-extra3 Miscellaneous Information Manual
@


1.5
log
@update to groff-1.22.3

new features:
* glilypond(1) - new preprocessor for music typesetting
* gperl(1) - new preprocessor for embedding Perl code in roff documents
* gpinyin(1) - new preprocessor to pretty-print Pinyin syllables
* groff_mom(7) now has full eqn(7), pic(7), and tbl(7) support
* mdoc(7) now supports the %C macro (already available in mandoc)

* various bugfixes
* many of our patches have been integrated upstream
* changing the bullet is no longer needed, mandoc can now handle it

ok sthen@@ naddy@@
@
text
@d1 2
a2 1
$OpenBSD: patch-tmac_an-old_tmac,v 1.4 2013/12/15 15:19:50 schwarze Exp $
d4 11
a14 3
--- tmac/an-old.tmac.orig	Sun Oct 12 23:00:09 2014
+++ tmac/an-old.tmac	Sun Oct 12 23:27:06 2014
@@@@ -153,8 +153,8 @@@@
@


1.4
log
@Two bug fixes, one bump.

1) For man(7), initialize internal numerical registers correctly
such that a stray .RE without a preceding .RS doesn't set the left
margin to column 0.  Reported by bentley@@ on discuss at mdocml.
Patch technically approved by Werner Lemberg (upstream).
The only reason it isn't committed upstream yet is that FSF
pesters me to sign a Copyright Assignment contract under
Massachusetts legislature, talking about Warranties and whatnot,
which i resist.

2) Restore correct syntax to the .ie cascade governing section titles
that i broke, trying to be too clever.  Problem reported by
David Levine via pascal@@ after the nmh(1) folks added an OpenBSD
machine to their buildbot cluster.

ok pascal@@
@
text
@d1 8
a8 25
$OpenBSD: patch-tmac_an-old_tmac,v 1.3 2013/07/13 07:39:00 schwarze Exp $
chunks 1,3-5: Fix indentation after RE without RS (approved upstream).
chunk 2: Keep traditional OpenBSD page headers (local change).
chunk 6: Correct right margin after double .TP (accepted & committed upstream).
--- tmac/an-old.tmac.orig	Thu Feb  7 13:06:08 2013
+++ tmac/an-old.tmac	Sat Dec 14 21:24:58 2013
@@@@ -122,7 +122,11 @@@@
 .\}
 .
 .de set-an-margin
+.  nr an-level 1
 .  nr an-margin \\n[IN]
+.  nr an-saved-margin1 \\n[IN]
+.  nr an-prevailing-indent \\n[IN]
+.  nr an-saved-prevailing-indent1 \\n[IN]
 ..
 .
 .ds an-extra1
@@@@ -145,16 +149,16 @@@@
 .    el                  .ds an-extra2 \"Sun Release 4.0
 .
 .    ie (\\n[.$] > 4)    .ds an-extra3 "\\$5\"
-.    el \{ .ie '\\$2'1'  .ds an-extra3 General Commands Manual
-.    el \{ .ie '\\$2'2'  .ds an-extra3 System Calls Manual
-.    el \{ .ie '\\$2'3'  .ds an-extra3 Library Functions Manual
d11 5
a15 61
-.    el \{ .ie '\\$2'5'  .ds an-extra3 File Formats Manual
-.    el \{ .ie '\\$2'6'  .ds an-extra3 Games Manual
-.    el \{ .ie '\\$2'7'  .ds an-extra3 Miscellaneous Information Manual
-.    el \{ .ie '\\$2'8'  .ds an-extra3 System Manager's Manual
-.    el \{ .ie '\\$2'9'  .ds an-extra3 Kernel Developer's Manual
+.    el \{ .ie '\\$2'1'  .ds an-extra3 OpenBSD Reference Manual
+.    el \{ .ie '\\$2'2'  .ds an-extra3 OpenBSD Programmer's Manual
+.    el \{ .ie '\\$2'3'  .ds an-extra3 OpenBSD Programmer's Manual
+.    el \{ .ie '\\$2'3p' .ds an-extra3 Perl Programmers Reference Guide
+.    el \{ .ie '\\$2'4'  .ds an-extra3 OpenBSD Programmer's Manual
+.    el \{ .ie '\\$2'5'  .ds an-extra3 OpenBSD Programmer's Manual
+.    el \{ .ie '\\$2'6'  .ds an-extra3 OpenBSD Reference Manual
+.    el \{ .ie '\\$2'7'  .ds an-extra3 OpenBSD Reference Manual
+.    el \{ .ie '\\$2'8'  .ds an-extra3 OpenBSD System Manager's Manual
+.    el \{ .ie '\\$2'9'  .ds an-extra3 OpenBSD Kernel Manual
 .    el                  .ds an-extra3
 .    \}\}\}\}\}\}\}\}\}\}
 .    ds an-init
@@@@ -198,9 +202,7 @@@@
 .  PD
 .  if !r SN \
 .    nr SN 3n \" the indentation of sub-sub-headings relative to sub-headings
-.  nr an-level 1
 .  set-an-margin
-.  nr an-prevailing-indent \\n[IN]
 .  nr an-tag-sep 1n
 .
 .  nr an-no-space-flag 0
@@@@ -342,9 +344,7 @@@@
 .
 .de1 SH
 .  sp \\n[PD]u
-.  nr an-level 1
 .  set-an-margin
-.  nr an-prevailing-indent \\n[IN]
 .  fi
 .  in \\n[an-margin]u
 .  ti 0
@@@@ -361,9 +361,7 @@@@
 .
 .de1 SS
 .  sp \\n[PD]u
-.  nr an-level 1
 .  set-an-margin
-.  nr an-prevailing-indent \\n[IN]
 .  fi
 .  in \\n[IN]u
 .  ti \\n[SN]u
@@@@ -406,8 +404,10 @@@@
 .  if \\n[.$] .nr an-prevailing-indent (n;\\$1)
 .  it 1 an-trap
 .  in 0
-.  ll -\\n[an-margin]u
-.  if !\\n[an-div?] .di an-div
+.  if !\\n[an-div?] \{\
+.    ll -\\n[an-margin]u
+.    di an-div
+.  \}
 .  nr an-div? 1
 ..
 .
@


1.3
log
@Add a patch to avoid permanent damage to the right margin
when a man(7) input file contains two consecutive .TP lines.
This bugfix improves the formatting of unzip(1), for example.

While here, recognize 5.4 as an OpenBSD version in mdoc(7) files.

ok sthen@@ dcoppa@@ espie@@
@
text
@d1 4
a4 3
$OpenBSD: patch-tmac_an-old_tmac,v 1.2 2013/03/30 23:10:05 schwarze Exp $
chunk 1: Keep traditional OpenBSD page headers (local change).
chunk 2: Correct right margin after double .TP (submitted upstream).
d6 14
a19 2
+++ tmac/an-old.tmac	Mon Jul  8 07:42:25 2013
@@@@ -145,18 +145,17 @@@@
d33 10
a42 10
+.    el .ie '\\$2'1'     .ds an-extra3 OpenBSD Reference Manual
+.    el .ie '\\$2'2'     .ds an-extra3 OpenBSD Programmer's Manual
+.    el .ie '\\$2'3'     .ds an-extra3 OpenBSD Programmer's Manual
+.    el .ie '\\$2'3p'    .ds an-extra3 Perl Programmers Reference Guide
+.    el .ie '\\$2'4'     .ds an-extra3 OpenBSD Programmer's Manual
+.    el .ie '\\$2'5'     .ds an-extra3 OpenBSD Programmer's Manual
+.    el .ie '\\$2'6'     .ds an-extra3 OpenBSD Reference Manual
+.    el .ie '\\$2'7'     .ds an-extra3 OpenBSD Reference Manual
+.    el .ie '\\$2'8'     .ds an-extra3 OpenBSD System Manager's Manual
+.    el .ie '\\$2'9'     .ds an-extra3 OpenBSD Kernel Manual
d44 1
a44 1
-.    \}\}\}\}\}\}\}\}\}\}
d46 21
a66 1
 \\..
d68 9
a76 1
@@@@ -406,8 +405,10 @@@@
@


1.2
log
@Maintenance update to groff-1.22.2.
* New features: gropdf(1), pdfmom(1)
* Lots of our patches were accepted upstream, lots of upstream bug fixes.
Tested by landry@@ and pascal@@, ok landry@@ and sthen@@.
@
text
@d1 5
a5 4
$OpenBSD: patch-tmac_an-old_tmac,v 1.1 2011/12/04 15:41:26 schwarze Exp $
Keep traditional OpenBSD page headers (local change).
--- tmac/an-old.tmac.orig	Sun Dec 30 08:40:29 2012
+++ tmac/an-old.tmac	Tue Jan  1 15:29:42 2013
d34 13
@


1.1
log
@General cleanup:
* Unbreak groff manuals by using tbl(1); reported by pascal@@.
* Deal with our Mdocdate cvs keyword; as designed by jmc@@ in 2007.
* Use troffrc for OpenBSD config changes; suggested by Werner Lemberg.
* Unbreak the hdtbl examples; from upstream.
* Volume names in man(7) page headers; suggested by Yuri Pankov.
* Update various string tables; coordinated with upstream.
* Add a README explaining local changes; using feedback from pascal@@.
* Better description and bump.
ok pascal@@, and tested in an i386 bulk build by naddy@@, thanks!
@
text
@d1 30
a30 22
$OpenBSD$
In man(7), show default volume headers like in mdoc(7).
Inspired by IllumOS, suggested by Yuri Pankov.
Similar patch accepted upstream into groff by Werner Lemberg.
--- tmac/an-old.tmac.orig	Fri Dec 31 08:33:09 2010
+++ tmac/an-old.tmac	Sun Oct 30 22:37:29 2011
@@@@ -145,7 +145,17 @@@@
 .    ie (\\n[.$] > 3) .ds an-extra2 "\\$4\"
 .    el               .ds an-extra2 \"Sun Release 4.0
 .    ie (\\n[.$] > 4) .ds an-extra3 "\\$5\"
-.    el               .ds an-extra3 \"System Programmer's Manual
+.    el .ie '\\$2'1'  .ds an-extra3 OpenBSD Reference Manual
+.    el .ie '\\$2'2'  .ds an-extra3 OpenBSD Programmer's Manual
+.    el .ie '\\$2'3'  .ds an-extra3 OpenBSD Programmer's Manual
+.    el .ie '\\$2'3p' .ds an-extra3 Perl Programmers Reference Guide
+.    el .ie '\\$2'4'  .ds an-extra3 OpenBSD Programmer's Manual
+.    el .ie '\\$2'5'  .ds an-extra3 OpenBSD Programmer's Manual
+.    el .ie '\\$2'6'  .ds an-extra3 OpenBSD Reference Manual
+.    el .ie '\\$2'7'  .ds an-extra3 OpenBSD Reference Manual
+.    el .ie '\\$2'8'  .ds an-extra3 OpenBSD System Manager's Manual
+.    el .ie '\\$2'9'  .ds an-extra3 OpenBSD Kernel Manual
+.    el               .ds an-extra3
@

