head	1.78;
access;
symbols
	OPENBSD_6_1:1.78.0.4
	OPENBSD_6_1_BASE:1.78
	OPENBSD_6_0:1.78.0.2
	OPENBSD_6_0_BASE:1.78
	OPENBSD_5_9:1.77.0.2
	OPENBSD_5_9_BASE:1.77
	OPENBSD_5_8:1.77.0.4
	OPENBSD_5_8_BASE:1.77
	OPENBSD_5_7:1.73.0.2
	OPENBSD_5_7_BASE:1.73
	OPENBSD_5_6:1.72.0.2
	OPENBSD_5_6_BASE:1.72
	OPENBSD_5_5:1.71.0.2
	OPENBSD_5_5_BASE:1.71
	OPENBSD_5_4:1.68.0.2
	OPENBSD_5_4_BASE:1.68
	OPENBSD_5_3:1.66.0.2
	OPENBSD_5_3_BASE:1.66
	OPENBSD_5_2:1.64.0.4
	OPENBSD_5_2_BASE:1.64
	OPENBSD_5_1_BASE:1.64
	OPENBSD_5_1:1.64.0.2
	OPENBSD_5_0:1.61.0.2
	OPENBSD_5_0_BASE:1.61
	OPENBSD_4_9:1.60.0.2
	OPENBSD_4_9_BASE:1.60
	OPENBSD_4_8:1.57.0.2
	OPENBSD_4_8_BASE:1.57
	OPENBSD_4_7:1.56.0.2
	OPENBSD_4_7_BASE:1.56
	OPENBSD_4_6:1.55.0.4
	OPENBSD_4_6_BASE:1.55
	OPENBSD_4_5:1.55.0.2
	OPENBSD_4_5_BASE:1.55
	OPENBSD_4_4:1.53.0.4
	OPENBSD_4_4_BASE:1.53
	OPENBSD_4_3:1.53.0.2
	OPENBSD_4_3_BASE:1.53
	OPENBSD_4_2:1.51.0.4
	OPENBSD_4_2_BASE:1.51
	OPENBSD_4_1:1.51.0.2
	OPENBSD_4_1_BASE:1.51
	OPENBSD_4_0:1.50.0.2
	OPENBSD_4_0_BASE:1.50
	OPENBSD_3_9:1.49.0.6
	OPENBSD_3_9_BASE:1.49
	OPENBSD_3_8:1.49.0.4
	OPENBSD_3_8_BASE:1.49
	OPENBSD_3_7:1.49.0.2
	OPENBSD_3_7_BASE:1.49
	OPENBSD_3_6:1.46.0.4
	OPENBSD_3_6_BASE:1.46
	OPENBSD_3_5:1.46.0.2
	OPENBSD_3_5_BASE:1.46
	OPENBSD_3_4:1.45.0.2
	OPENBSD_3_4_BASE:1.45
	OPENBSD_3_3:1.42.0.2
	OPENBSD_3_3_BASE:1.42
	OPENBSD_3_2:1.41.0.2
	OPENBSD_3_2_BASE:1.41
	OPENBSD_3_1:1.40.0.2
	OPENBSD_3_1_BASE:1.40
	OPENBSD_3_0:1.39.0.2
	OPENBSD_3_0_BASE:1.39
	OPENBSD_2_9_TRACKING_SWITCH:1.37
	OPENBSD_2_9:1.37.0.2
	OPENBSD_2_9_BASE:1.37
	OPENBSD_2_8:1.30.0.2
	OPENBSD_2_8_BASE:1.30
	OPENBSD_2_7:1.28.0.2
	OPENBSD_2_7_BASE:1.28
	OPENBSD_2_6:1.2.0.2
	OPENBSD_2_6_BASE:1.2
	OPENBSD_2_5:1.1.0.4
	OPENBSD_2_5_BASE:1.1
	OPENBSD_2_4:1.1.0.2
	OPENBSD_2_4_BASE:1.1;
locks; strict;
comment	@# @;


1.78
date	2016.03.11.16.06.01;	author naddy;	state Exp;
branches;
next	1.77;
commitid	pyq9FPbg8GbwmC9v;

1.77
date	2015.07.25.16.47.12;	author espie;	state Exp;
branches;
next	1.76;
commitid	lfUoLFpbeIFyf3Ry;

1.76
date	2015.07.23.10.02.08;	author espie;	state Exp;
branches;
next	1.75;
commitid	mZYNL78QqtSxhppP;

1.75
date	2015.07.21.17.43.32;	author sthen;	state Exp;
branches;
next	1.74;
commitid	YgC43YSPw4b1yzVx;

1.74
date	2015.04.09.13.51.38;	author espie;	state Exp;
branches;
next	1.73;
commitid	6WcJP0UKuv56oMi9;

1.73
date	2014.11.21.21.25.16;	author nigel;	state Exp;
branches;
next	1.72;
commitid	TMOEAy0VgmygWasF;

1.72
date	2014.03.23.17.22.45;	author espie;	state Exp;
branches;
next	1.71;

1.71
date	2013.12.08.16.42.24;	author espie;	state Exp;
branches;
next	1.70;

1.70
date	2013.11.10.10.45.26;	author espie;	state Exp;
branches;
next	1.69;

1.69
date	2013.11.03.15.11.22;	author ajacoutot;	state Exp;
branches;
next	1.68;

1.68
date	2013.07.06.10.46.29;	author espie;	state Exp;
branches;
next	1.67;

1.67
date	2013.03.11.11.12.33;	author espie;	state Exp;
branches;
next	1.66;

1.66
date	2012.09.23.08.07.04;	author matthieu;	state Exp;
branches;
next	1.65;

1.65
date	2012.08.18.12.41.38;	author ajacoutot;	state Exp;
branches;
next	1.64;

1.64
date	2012.01.26.08.03.57;	author ajacoutot;	state Exp;
branches;
next	1.63;

1.63
date	2011.11.13.13.24.14;	author naddy;	state Exp;
branches;
next	1.62;

1.62
date	2011.11.01.16.27.06;	author jasper;	state Exp;
branches;
next	1.61;

1.61
date	2011.04.14.21.07.45;	author naddy;	state Exp;
branches;
next	1.60;

1.60
date	2010.11.17.08.05.17;	author espie;	state Exp;
branches;
next	1.59;

1.59
date	2010.10.24.21.22.23;	author ajacoutot;	state Exp;
branches;
next	1.58;

1.58
date	2010.10.18.18.13.15;	author espie;	state Exp;
branches;
next	1.57;

1.57
date	2010.07.25.05.58.31;	author ajacoutot;	state Exp;
branches;
next	1.56;

1.56
date	2009.08.10.06.32.05;	author kili;	state Exp;
branches;
next	1.55;

1.55
date	2008.08.30.11.16.59;	author espie;	state Exp;
branches;
next	1.54;

1.54
date	2008.08.30.11.08.12;	author espie;	state Exp;
branches;
next	1.53;

1.53
date	2008.01.04.17.48.35;	author espie;	state Exp;
branches;
next	1.52;

1.52
date	2007.09.16.00.33.56;	author merdely;	state Exp;
branches;
next	1.51;

1.51
date	2006.11.20.13.50.58;	author espie;	state Exp;
branches;
next	1.50;

1.50
date	2006.08.04.19.57.32;	author sturm;	state Exp;
branches;
next	1.49;

1.49
date	2005.02.08.21.47.00;	author alek;	state Exp;
branches;
next	1.48;

1.48
date	2004.12.26.11.34.58;	author sturm;	state Exp;
branches;
next	1.47;

1.47
date	2004.09.15.00.53.48;	author espie;	state Exp;
branches;
next	1.46;

1.46
date	2004.01.02.22.03.36;	author espie;	state Exp;
branches;
next	1.45;

1.45
date	2003.06.23.19.11.10;	author sturm;	state Exp;
branches;
next	1.44;

1.44
date	2003.04.14.15.02.09;	author wilfried;	state Exp;
branches;
next	1.43;

1.43
date	2003.03.31.13.44.03;	author sturm;	state Exp;
branches;
next	1.42;

1.42
date	2002.10.27.00.52.43;	author naddy;	state Exp;
branches;
next	1.41;

1.41
date	2002.06.09.05.36.46;	author wilfried;	state Exp;
branches;
next	1.40;

1.40
date	2002.03.21.20.57.09;	author espie;	state Exp;
branches;
next	1.39;

1.39
date	2001.09.19.16.03.10;	author espie;	state Exp;
branches;
next	1.38;

1.38
date	2001.08.18.13.25.42;	author espie;	state Exp;
branches;
next	1.37;

1.37
date	2001.04.23.23.19.02;	author espie;	state Exp;
branches;
next	1.36;

1.36
date	2001.04.20.15.12.03;	author espie;	state Exp;
branches;
next	1.35;

1.35
date	2001.04.02.10.33.45;	author espie;	state Exp;
branches;
next	1.34;

1.34
date	2001.03.28.15.38.35;	author espie;	state Exp;
branches;
next	1.33;

1.33
date	2001.03.28.15.13.03;	author espie;	state Exp;
branches;
next	1.32;

1.32
date	2001.03.28.09.22.57;	author espie;	state Exp;
branches;
next	1.31;

1.31
date	2001.03.16.15.42.49;	author espie;	state Exp;
branches;
next	1.30;

1.30
date	2000.10.10.00.40.35;	author espie;	state Exp;
branches;
next	1.29;

1.29
date	2000.06.11.01.53.45;	author espie;	state Exp;
branches;
next	1.28;

1.28
date	2000.04.28.22.12.23;	author espie;	state Exp;
branches
	1.28.2.1;
next	1.27;

1.27
date	2000.04.24.20.32.02;	author espie;	state Exp;
branches;
next	1.26;

1.26
date	2000.04.22.12.05.57;	author espie;	state Exp;
branches;
next	1.25;

1.25
date	2000.04.21.15.09.51;	author espie;	state Exp;
branches;
next	1.24;

1.24
date	2000.04.21.02.10.53;	author espie;	state Exp;
branches;
next	1.23;

1.23
date	2000.04.21.02.01.51;	author espie;	state Exp;
branches;
next	1.22;

1.22
date	2000.04.21.01.01.32;	author espie;	state Exp;
branches;
next	1.21;

1.21
date	2000.04.21.00.36.06;	author espie;	state Exp;
branches;
next	1.20;

1.20
date	2000.04.21.00.25.25;	author espie;	state Exp;
branches;
next	1.19;

1.19
date	2000.04.20.23.58.24;	author espie;	state Exp;
branches;
next	1.18;

1.18
date	2000.04.20.23.32.22;	author espie;	state Exp;
branches;
next	1.17;

1.17
date	2000.04.16.21.53.26;	author espie;	state Exp;
branches;
next	1.16;

1.16
date	2000.04.05.17.13.55;	author espie;	state Exp;
branches;
next	1.15;

1.15
date	2000.03.25.00.48.09;	author turan;	state Exp;
branches;
next	1.14;

1.14
date	2000.03.24.22.11.46;	author espie;	state Exp;
branches;
next	1.13;

1.13
date	2000.03.03.12.41.00;	author turan;	state Exp;
branches;
next	1.12;

1.12
date	2000.03.03.12.03.02;	author turan;	state Exp;
branches;
next	1.11;

1.11
date	2000.02.22.17.08.40;	author espie;	state Exp;
branches;
next	1.10;

1.10
date	2000.02.15.05.04.35;	author turan;	state Exp;
branches;
next	1.9;

1.9
date	2000.02.12.06.29.56;	author turan;	state Exp;
branches;
next	1.8;

1.8
date	2000.02.12.00.43.59;	author espie;	state Exp;
branches;
next	1.7;

1.7
date	2000.02.11.01.10.04;	author espie;	state Exp;
branches;
next	1.6;

1.6
date	2000.02.11.00.37.26;	author espie;	state Exp;
branches;
next	1.5;

1.5
date	99.11.03.01.06.42;	author turan;	state Exp;
branches;
next	1.4;

1.4
date	99.10.30.21.24.53;	author turan;	state Exp;
branches;
next	1.3;

1.3
date	99.10.29.10.19.37;	author turan;	state Exp;
branches;
next	1.2;

1.2
date	99.09.22.10.34.03;	author espie;	state Exp;
branches;
next	1.1;

1.1
date	98.07.29.01.31.20;	author espie;	state Exp;
branches;
next	;

1.28.2.1
date	2000.09.15.04.54.23;	author marc;	state Exp;
branches;
next	;


desc
@@


1.78
log
@remove no_shared check and fix errno definition
@
text
@# $OpenBSD: Makefile,v 1.77 2015/07/25 16:47:12 espie Exp $

COMMENT-main = 		Japanese input method
COMMENT-dict =		dictionaries for Japanese Wnn
COMMENT-ko = 		Korean input method
COMMENT-kodict =	dictionaries for Korean Wnn
COMMENT-zh =		Chinese input method
COMMENT-zhdict =	dictionaries for Chinese Wnn
COMMENT-data = 		common files to all languages of Wnn
COMMENT-xwnmo =		X11 input method for Wnn

DISTNAME =	Wnn4.2

CATEGORIES =	japanese

MULTI_PACKAGES =	-main -dict -zh -zhdict -ko -kodict -xwnmo -data

PKGNAME-main =		ja-Wnn-4.2
REVISION-main =		13
PKGNAME-dict =		ja-Wnndict-4.2
REVISION-dict =		0
PKGNAME-zh =		zh-Wnn-4.2
REVISION-zh =		7
PKGNAME-zhdict =	zh-Wnndict-4.2
REVISION-zhdict =	0
PKGNAME-ko =		ko-Wnn-4.2
REVISION-ko =		7
PKGNAME-kodict =	ko-Wnndict-4.2
REVISION-kodict =	0
PKGNAME-xwnmo =		Wnn-xwnmo-4.2
REVISION-xwnmo =	8
PKGNAME-data =		Wnn-data-4.2

WNNDICBASE =	/var
WNNDICDIR =	${WNNDICBASE}/dict/Wnn
WNNBASE =	${LOCALBASE}
SUBST_VARS =	WNNBASE

CATEGORIES-zh =		chinese
CATEGORIES-zhdict =	chinese
CATEGORIES-ko =		korean
CATEGORIES-kodict =	korean
CATEGORIES-data =	japanese chinese korean
CATEGORIES-wnmo =	japanese chinese korean

PREFIX-dict =		${WNNDICBASE}
PREFIX-zhdict =		${WNNDICBASE}
PREFIX-kodict =		${WNNDICBASE}

WANTLIB-main =		c curses
WANTLIB-zh =		c curses
WANTLIB-ko =		c curses
WANTLIB-xwnmo =		ICE SM X11 Xext Xmu Xt c 

RUN_DEPENDS =		japanese/Wnn,-data
RUN_DEPENDS-data =	

MASTER_SITES =	ftp://ftp.u-tokyo.ac.jp/pub/Japanese/Wnn/ \
		ftp://ports.jp.FreeBSD.org/pub/incoming/distfiles/
DISTFILES =	Wnn4.2.tar.gz Wnn4.2.patch.tar.gz

MAINTAINER =	Marc Espie <espie@@openbsd.org>

#		BSD
PERMIT_PACKAGE_CDROM =		Yes

EXTRACT_ONLY =	Wnn4.2.tar.gz
WRKDIST =	${WRKDIR}/Xsi
# `User' configuration file
CONFIG_FILE =	${WRKDIST}/config/config.h

PORT_JDOCDIR =	${PREFIX}/share/doc/ja-Wnn
JDOC_FROM =	${WRKSRC}/Wnn

PORT_CDOCDIR =	${PREFIX}/share/doc/zh-cWnn
CDOC_FROM =	${WRKSRC}/cWnn

# Will turn into a RUN_DEPENDS when we install non-formatted manpages
BUILD_DEPENDS =	devel/imake \
		japanese/groff
# Run depends ensure this does not turn into infinite recursion, since
# this is not needed before package build time.

USE_GROFF =	Yes

do-distpatch:
	cd ${WRKDIR} && tar zxf ${FULLDISTDIR}/Wnn4.2.patch.tar.gz
	cd ${WRKSRC} && patch ${PATCH_DIST_ARGS} < ${WRKDIR}/Wnn4.2.patch

SRCDOCDIRS =	Wnn/man Wnn/manual Wnn/manual.en cWnn/man cWnn/manual \
		cWnn/manual.en

# do those as post-patch, because of the $Id
post-patch:
	@@cd ${WRKDIST}; \
	for file in Wnn/jd/jserverrc cWnn/cd/cserverrc kWnn/kd/kserverrc; do\
	perl -pi.bak -e 's,\@@LIBDIR/\@@LANG/dic,${WNNDICDIR}/\@@LANG,;' $$file; done
# Commands are installed directly under /usr/local/bin and dictionaries in /var/dict
	@@{ for dir in ${SRCDOCDIRS}; do \
	find ${WRKSRC}/$$dir -type f; done; } \
		| xargs perl -pi.bok -e \
		's,/usr/local/bin/Wnn4/,${PREFIX}/bin/,g; s,/usr/local/lib/wnn/dic,${WNNDICDIR},g;'
	@@{ for dir in ${SRCDOCDIRS}; do \
	find ${WRKSRC}/$$dir -type f -name \*.bok; done; } | xargs rm

do-configure:
	@@echo "   WNNDICDIR = ${WNNDICDIR}"   >${CONFIG_FILE}
	@@echo "  WNNBASEDIR = ${PREFIX}"     >>${CONFIG_FILE}
	#	echo " CDEBUGFLAGS = -g	"		>>${CONFIG_FILE}
	@@echo "#define BuildWnn		YES" >>${CONFIG_FILE}
	@@echo "#define BuildJlibV3	YES" >>${CONFIG_FILE}
	@@echo "#define BuildCWnn	YES" >>${CONFIG_FILE}
	@@echo "#define BuildKWnn	YES" >>${CONFIG_FILE}
	@@echo "#define BuildXwnmo	YES" >>${CONFIG_FILE}
	@@cd ${WRKSRC}/config && ln -sf Project.tmpl X11.tmpl


# Xfree4 believes it can build html documentation, fat chance...
#MAKE_FLAGS=IMAKE='imake -DBuildHtmlManPages=0 -DPorts' WNNOWNER_INDIRECT=_wnn
MAKE_FLAGS =	IMAKE='imake -DPorts' WNNOWNER_INDIRECT=_wnn COPTS="${COPTS}"  CONFIGSRC=${LOCALBASE}/lib/X11/config 
FAKE_FLAGS =	WNNOWNER_INDIRECT=bin

MAKE_ENV =	IMAKEINCLUDE=-I${WRKSRC}/config

# These are necessary because this package uses a different Makefile for
#  building and installing etc.

do-build:
	@@cd ${WRKBUILD} && ${SETENV} ${MAKE_ENV} make ${MAKE_FLAGS} -f Makefile.inst ${ALL_TARGET}

ALL_TARGET =		World
INSTALL_TARGET =	install install.man
NO_TEST =		Yes

post-install:
	${INSTALL_DATA_DIR} ${PORT_JDOCDIR}
	@@(cd ${JDOC_FROM}; tar cf - manual manual.en | \
		(cd ${PORT_JDOCDIR}; tar xf -))
	@@chown -R ${SHAREOWN}:${SHAREGRP} ${PORT_JDOCDIR}
.if ${MULTI_PACKAGES:M-zh}
	${INSTALL_DATA_DIR} ${PORT_CDOCDIR}
	@@(cd ${CDOC_FROM}; tar cf - manual manual.en | \
		(cd ${PORT_CDOCDIR}; tar xf -))
	@@chown -R ${SHAREOWN}:${SHAREGRP} ${PORT_CDOCDIR}
.endif
	${INSTALL_DATA_DIR} ${PREFIX}/lib/wnn
	${INSTALL_DATA} ${WRKDIST}/Wnn/jd/sysV/cvt_key* ${PREFIX}/lib/wnn
	${INSTALL_DATA} ${WRKDIST}/Wnn/jd/serverdefs ${PREFIX}/lib/wnn
	${INSTALL_SCRIPT} ${FILESDIR}/install-script ${PREFIX}/lib/wnn
	chmod u-s ${PREFIX}/bin/*server

.include <bsd.port.mk>
@


1.77
log
@move to new auth checks. Add "a few" includes to placate a lot of warnings.
(and bump affected packages of course)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.76 2015/07/23 10:02:08 espie Exp $
d19 1
a19 1
REVISION-main =		12
d23 1
a23 1
REVISION-zh =		6
d27 1
a27 1
REVISION-ko =		6
d31 1
a31 1
REVISION-xwnmo =	7
a152 4

.if ${PROPERTIES:Mno_shared}
MAKE_FLAGS += XONLYLIB='-lX11 -lxcb -lXau -lXdmcp'
.endif
@


1.76
log
@fix tedu's breakage, again
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.75 2015/07/21 17:43:32 sthen Exp $
d19 1
a19 1
REVISION-main =		11
d23 1
a23 1
REVISION-zh =		5
d27 1
a27 1
REVISION-ko =		5
d31 1
a31 1
REVISION-xwnmo =	6
@


1.75
log
@mark Wnn BROKEN, it doesn't build any more
@
text
@d1 1
a1 3
# $OpenBSD: Makefile,v 1.74 2015/04/09 13:51:38 espie Exp $

BROKEN= persistent segfault during build 
d19 1
a19 1
REVISION-main =		10
d23 1
a23 1
REVISION-zh =		4
d27 1
a27 1
REVISION-ko =		4
d31 1
a31 1
REVISION-xwnmo =	5
d109 1
@


1.74
log
@fix build post-tedu
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.73 2014/11/21 21:25:16 nigel Exp $
@


1.73
log
@fix build failure, add missing include, and bump revision

Ok naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.72 2014/03/23 17:22:45 espie Exp $
d19 1
a19 1
REVISION-main =		9
d23 1
a23 1
REVISION-zh =		3
d27 1
a27 1
REVISION-ko =		3
d31 1
a31 1
REVISION-xwnmo =	4
@


1.72
log
@zap gets usage. very straightforward, since all those are to fixed sized
buffers (also synch the documentation, which contains cut&paste from
the original code).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.71 2013/12/08 16:42:24 espie Exp $
d19 1
a19 1
REVISION-main =		8
d23 1
a23 1
REVISION-zh =		2
d27 1
a27 1
REVISION-ko =		2
@


1.71
log
@messy removal of sgtty.h
probably better to update, hopefully soon.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.70 2013/11/10 10:45:26 espie Exp $
d19 1
a19 1
REVISION-main =		7
d23 1
a23 1
REVISION-zh =		1
d27 1
a27 1
REVISION-ko =		1
d31 1
a31 1
REVISION-xwnmo =	3
@


1.70
log
@zap old misleading comment
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.69 2013/11/03 15:11:22 ajacoutot Exp $
d19 1
a19 1
REVISION-main =		6
d23 1
a23 1
REVISION-zh =		0
d27 1
a27 1
REVISION-ko =		0
d31 1
a31 1
REVISION-xwnmo =	2
@


1.69
log
@Ports are not safe, we know that.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.68 2013/07/06 10:46:29 espie Exp $
a14 3

# If you are building this manually, you can override MULTI_PACKAGES
# on the command line, and thus avoid building all three languages
@


1.68
log
@enforce extra x11 libs on vax
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.67 2013/03/11 11:12:33 espie Exp $
d22 1
a22 1
REVISION-main =		5
@


1.67
log
@PERMIT_* / REGRESS -> TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.66 2012/09/23 08:07:04 matthieu Exp $
d122 1
a122 1
MAKE_FLAGS =	IMAKE='imake -DPorts' WNNOWNER_INDIRECT=_wnn COPTS="${COPTS}"  CONFIGSRC=${LOCALBASE}/lib/X11/config
d155 4
@


1.66
log
@add BUILD_DEPENDS devel/imake and point Makefile to the imake config
files in ${LOCALBASE}. ok landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.65 2012/08/18 12:41:38 ajacoutot Exp $
a68 3
PERMIT_PACKAGE_FTP =		Yes
PERMIT_DISTFILES_CDROM =	Yes
PERMIT_DISTFILES_FTP =		Yes
d135 1
a135 1
NO_REGRESS =		Yes
@


1.65
log
@Remove irrelevant $FreeBSD RCS ids.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.64 2012/01/26 08:03:57 ajacoutot Exp $
d85 2
a86 1
BUILD_DEPENDS =	japanese/groff
d125 1
a125 1
MAKE_FLAGS =	IMAKE='imake -DPorts' WNNOWNER_INDIRECT=_wnn COPTS="${COPTS}"
@


1.64
log
@Put these users in the daemon class to be consistent with all the other
ones in ports.

discussed with and ok sthen@@
@
text
@d1 1
a1 4
# From FreeBSD:		Satoshi Taoka <taoka@@infonets.hiroshima-u.ac.jp>
#
# $FreeBSD: Makefile,v 1.19 1997/09/23 02:17:58 max Exp $
# $OpenBSD: Makefile,v 1.63 2011/11/13 13:24:14 naddy Exp $
@


1.63
log
@don't use union wait
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.62 2011/11/01 16:27:06 jasper Exp $
d25 1
a25 1
REVISION-main =		4
@


1.62
log
@- fix WANTLIB
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.61 2011/04/14 21:07:45 naddy Exp $
d25 1
a25 1
REVISION-main =		3
d37 1
a37 1
REVISION-xwnmo =	1
@


1.61
log
@restore missing REVISIONs for subpackages that were lost during the original
switch to REVISION
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.60 2010/11/17 08:05:17 espie Exp $
d37 1
a37 1
REVISION-xwnmo =	0
d59 1
a59 1
WANTLIB-xwnmo =		ICE SM X11 Xext Xmu Xt c pthread-stubs xcb
@


1.60
log
@new depends
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.59 2010/10/24 21:22:23 ajacoutot Exp $
d25 1
d29 1
@


1.59
log
@Remove USE_X11.
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.58 2010/10/18 18:13:15 espie Exp $
d59 1
a59 1
RUN_DEPENDS =		::japanese/Wnn,-data
d86 1
a86 1
BUILD_DEPENDS =	:ja-groff-*:japanese/groff
@


1.58
log
@USE_GROFF=Yes
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.57 2010/07/25 05:58:31 ajacoutot Exp $
a89 1
USE_X11 =	Yes
@


1.57
log
@Move to new DEPENDS/WANTLIB/REVISION.
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.56 2009/08/10 06:32:05 kili Exp $
d91 1
@


1.56
log
@WANTLIB changes after xcb addition and bump.
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.55 2008/08/30 11:16:59 espie Exp $
d24 12
a35 7
PKGNAME-main =		ja-Wnn-4.2p3
PKGNAME-dict =		ja-Wnndict-4.2p0
PKGNAME-zh =		zh-Wnn-4.2p0
PKGNAME-zhdict =	zh-Wnndict-4.2p0
PKGNAME-ko =		ko-Wnn-4.2p0
PKGNAME-kodict =	ko-Wnndict-4.2p0
PKGNAME-xwnmo =		Wnn-xwnmo-4.2p0
@


1.55
log
@restyle and regen patches, wow old stuff
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.54 2008/08/30 11:08:12 espie Exp $
d30 1
a30 1
PKGNAME-xwnmo =		Wnn-xwnmo-4.2
d52 1
a52 1
WANTLIB-xwnmo =		c Xt SM Xmu X11 Xext ICE
@


1.54
log
@heed COPTS
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.53 2008/01/04 17:48:35 espie Exp $
d6 8
a13 8
COMMENT-main= 	Japanese input method
COMMENT-dict=	dictionaries for Japanese Wnn
COMMENT-ko= 	Korean input method
COMMENT-kodict= dictionaries for Korean Wnn
COMMENT-zh=	Chinese input method
COMMENT-zhdict= dictionaries for Chinese Wnn
COMMENT-data= 	common files to all languages of Wnn
COMMENT-xwnmo=	X11 input method for Wnn
d15 1
a15 1
DISTNAME=	Wnn4.2
d17 1
a17 1
CATEGORIES=	japanese
d22 1
a22 1
MULTI_PACKAGES=-main -dict -zh -zhdict -ko -kodict -xwnmo -data
d24 29
a52 29
PKGNAME-main=	ja-Wnn-4.2p3
PKGNAME-dict=	ja-Wnndict-4.2p0
PKGNAME-zh=	zh-Wnn-4.2p0
PKGNAME-zhdict=	zh-Wnndict-4.2p0
PKGNAME-ko=	ko-Wnn-4.2p0
PKGNAME-kodict=	ko-Wnndict-4.2p0
PKGNAME-xwnmo=	Wnn-xwnmo-4.2
PKGNAME-data=	Wnn-data-4.2

WNNDICBASE=/var
WNNDICDIR=${WNNDICBASE}/dict/Wnn
WNNBASE=${LOCALBASE}
SUBST_VARS=WNNBASE

CATEGORIES-zh=		chinese
CATEGORIES-zhdict=	chinese
CATEGORIES-ko=		korean
CATEGORIES-kodict=	korean
CATEGORIES-data=	japanese chinese korean
CATEGORIES-wnmo=	japanese chinese korean

PREFIX-dict=		${WNNDICBASE}
PREFIX-zhdict=		${WNNDICBASE}
PREFIX-kodict=		${WNNDICBASE}

WANTLIB-main=		c curses
WANTLIB-zh=		c curses
WANTLIB-ko=		c curses
WANTLIB-xwnmo=		c Xt SM Xmu X11 Xext ICE
d54 2
a55 2
RUN_DEPENDS=		::japanese/Wnn,-data
RUN_DEPENDS-data=	
d57 1
a57 1
MASTER_SITES=	ftp://ftp.u-tokyo.ac.jp/pub/Japanese/Wnn/ \
d59 1
a59 1
DISTFILES=	Wnn4.2.tar.gz Wnn4.2.patch.tar.gz
d61 1
a61 1
MAINTAINER=	Marc Espie <espie@@openbsd.org>
d64 4
a67 4
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
d69 2
a70 2
EXTRACT_ONLY=	Wnn4.2.tar.gz
WRKDIST=	${WRKDIR}/Xsi
d72 1
a72 1
CONFIG_FILE=	${WRKDIST}/config/config.h
d74 2
a75 2
PORT_JDOCDIR=	${PREFIX}/share/doc/ja-Wnn
JDOC_FROM=	${WRKSRC}/Wnn
d77 2
a78 2
PORT_CDOCDIR=	${PREFIX}/share/doc/zh-cWnn
CDOC_FROM=	${WRKSRC}/cWnn
d81 1
a81 1
BUILD_DEPENDS=	:ja-groff-*:japanese/groff
d85 1
a85 1
USE_X11=	Yes
d91 2
a92 1
SRCDOCDIRS=Wnn/man Wnn/manual Wnn/manual.en cWnn/man cWnn/manual cWnn/manual.en
d120 4
a123 2
MAKE_FLAGS=IMAKE='imake -DPorts' WNNOWNER_INDIRECT=_wnn COPTS="${COPTS}"
FAKE_FLAGS=WNNOWNER_INDIRECT=bin
a124 1
MAKE_ENV=IMAKEINCLUDE=-I${WRKSRC}/config
d130 4
a133 3
ALL_TARGET=World
INSTALL_TARGET=install install.man
NO_REGRESS=Yes
@


1.53
log
@tweak FAKE_FLAGS semantics to saner defaults.
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.52 2007/09/16 00:33:56 merdely Exp $
d119 1
a119 1
MAKE_FLAGS=IMAKE='imake -DPorts' WNNOWNER_INDIRECT=_wnn
@


1.52
log
@Remove surrounding quotes in COMMENT*/PERMIT_*
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.51 2006/11/20 13:50:58 espie Exp $
d120 1
a120 1
FAKE_FLAGS=DESTDIR=${WRKINST} WNNOWNER_INDIRECT=bin
@


1.51
log
@new MULTI_PACKAGES
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.50 2006/08/04 19:57:32 sturm Exp $
d6 8
a13 8
COMMENT-main= 	"Japanese input method"
COMMENT-dict=	"dictionaries for Japanese Wnn"
COMMENT-ko= 	"Korean input method"
COMMENT-kodict= "dictionaries for Korean Wnn"
COMMENT-zh=	"Chinese input method"
COMMENT-zhdict= "dictionaries for Chinese Wnn"
COMMENT-data= 	"common files to all languages of Wnn"
COMMENT-xwnmo=	"X11 input method for Wnn"
@


1.50
log
@create _wnn in PLIST to make this package non-interactive
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.49 2005/02/08 21:47:00 alek Exp $
d6 1
a6 1
COMMENT= 	"Japanese input method"
d17 2
d22 1
a22 1
MULTI_PACKAGES=-dict -zh -zhdict -ko -kodict -xwnmo -data
d24 1
a24 1
PKGNAME=	ja-Wnn-4.2p2
d38 18
a55 32
.if defined(PACKAGING)
SUBPACKAGE?=
.  if ${SUBPACKAGE} == "-dict"
CATEGORIES=	japanese
PREFIX=${WNNDICBASE}
.  elif ${SUBPACKAGE} == "-zh"
CATEGORIES=	chinese
WANTLIB=	c curses
.  elif ${SUBPACKAGE} == "-zhdict"
CATEGORIES=	chinese
PREFIX=${WNNDICBASE}
.  elif ${SUBPACKAGE} == "-ko"
CATEGORIES=	korean
WANTLIB=	c curses
.  elif ${SUBPACKAGE} == "-kodict"
CATEGORIES=	korean
PREFIX=${WNNDICBASE}
.  elif ${SUBPACKAGE} == "-xwnmo"
CATEGORIES=	japanese chinese korean
WANTLIB=	c Xt SM Xmu X11 Xext ICE
.  elif ${SUBPACKAGE} == "-data"
CATEGORIES=	japanese chinese korean
.  else
WANTLIB=	c curses
CATEGORIES=	japanese
.  endif
.  if ${SUBPACKAGE} != "-data"
RUN_DEPENDS=	::japanese/Wnn,-data
.  endif
.else
CATEGORIES=	japanese
.endif
a110 1
.if ${MULTI_PACKAGES:M-zh}
a111 4
.else
	@@echo "#define BuildCWnn	NO"  >>${CONFIG_FILE}
.endif
.if ${MULTI_PACKAGES:M-ko}
a112 4
.else
	@@echo "#define BuildKWnn	NO"  >>${CONFIG_FILE}
.endif
.if ${MULTI_PACKAGES:M-xwnmo}
a113 3
.else
	@@echo "#define BuildXwnmo	NO"  >>${CONFIG_FILE}
.endif
d147 1
@


1.49
log
@Add WANTLIB markers
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.48 2004/12/26 11:34:58 sturm Exp $
d22 1
a22 1
PKGNAME=	ja-Wnn-4.2p1
@


1.48
log
@makewhatis complained about these
bump PKGNAME
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.47 2004/09/15 00:53:48 espie Exp $
d43 1
d49 1
d55 1
d59 1
@


1.47
log
@new-style PLISTs.
move base directory so that common directories get removed correctly.
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.46 2004/01/02 22:03:36 espie Exp $
d22 1
a22 1
PKGNAME=	ja-Wnn-4.2p0
@


1.46
log
@fix for gcc3.
naddy@@ says this still builds with 2.95.
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.45 2003/06/23 19:11:10 sturm Exp $
d31 2
a32 1
WNNDICDIR=/var/dict/Wnn
d40 1
a40 1
PREFIX=${WNNDICDIR}
d45 1
a45 1
PREFIX=${WNNDICDIR}
d50 1
a50 1
PREFIX=${WNNDICDIR}
@


1.45
log
@new user naming schema

bump PKGNAME where necessary

rohee@@ ok leafnode
"you don't have to wait for oks" pval@@
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.44 2003/04/14 15:02:09 wilfried Exp $
d137 2
a138 1
MAKE_FLAGS=IMAKE='imake -DBuildHtmlManPages=0 -DPorts' WNNOWNER_INDIRECT=_wnn
@


1.44
log
@POSIX chown, ok espie@@
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.43 2003/03/31 13:44:03 sturm Exp $
d22 6
a27 6
PKGNAME=	ja-Wnn-4.2
PKGNAME-dict=	ja-Wnndict-4.2
PKGNAME-zh=	zh-Wnn-4.2
PKGNAME-zhdict=	zh-Wnndict-4.2
PKGNAME-ko=	ko-Wnn-4.2
PKGNAME-kodict=	ko-Wnndict-4.2
d137 1
a137 1
MAKE_FLAGS=IMAKE='imake -DBuildHtmlManPages=0 -DPorts' WNNOWNER_INDIRECT=wnn
@


1.43
log
@USE_X11=yes
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.42 2002/10/27 00:52:43 naddy Exp $
d154 1
a154 1
	@@chown -R ${SHAREOWN}.${SHAREGRP} ${PORT_JDOCDIR}
d159 1
a159 1
	@@chown -R ${SHAREOWN}.${SHAREGRP} ${PORT_CDOCDIR}
@


1.42
log
@No regression tests available.
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.41 2002/06/09 05:36:46 wilfried Exp $
d91 2
@


1.41
log
@add specifier to RUN_DEPENDS and BUILD_DEPENDS
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.40 2002/03/21 20:57:09 espie Exp $
d21 1
a21 1
NEED_VERSION=	1.515
d146 1
@


1.40
log
@Bump NEED_VERSION
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.39 2001/09/19 16:03:10 espie Exp $
d88 1
a88 1
BUILD_DEPENDS=	::japanese/groff
@


1.39
log
@Update dependencies (kill first part when needed).

Update japanese/README... 2.4 is looong past.
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.38 2001/08/18 13:25:42 espie Exp $
d21 1
a21 1
NEED_VERSION=	1.458
@


1.38
log
@Use WNNBASE in PLISTs.
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.37 2001/04/23 23:19:02 espie Exp $
d21 1
a21 1
NEED_VERSION=	1.404
d58 1
a58 1
RUN_DEPENDS=	${LOCALBASE}/lib/wnn/install-script::japanese/Wnn,-data
d88 1
a88 1
BUILD_DEPENDS=	jgroff::japanese/groff
@


1.37
log
@Dependency computation may not define SUBPACKAGE and undefine PACKAGING.
This repairs onew...
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.36 2001/04/20 15:12:03 espie Exp $
d32 2
a33 1
WNNBASE=${PREFIX}
@


1.36
log
@Solve subpackaging
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.35 2001/04/02 10:33:45 espie Exp $
d35 1
@


1.35
log
@Typo
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.34 2001/03/28 15:38:35 espie Exp $
d21 1
a21 2
NEED_VERSION=	1.377
NEED_VERSION=	1.361
a30 2
SUBPACKAGE?=

d34 2
a35 1
.if ${SUBPACKAGE} == "-dict"
d38 1
a38 1
.elif ${SUBPACKAGE} == "-zh"
d40 1
a40 1
.elif ${SUBPACKAGE} == "-zhdict"
d43 1
a43 1
.elif ${SUBPACKAGE} == "-ko"
d45 1
a45 1
.elif ${SUBPACKAGE} == "-kodict"
d48 1
a48 1
.elif ${SUBPACKAGE} == "-xwnmo"
d50 1
a50 1
.elif ${SUBPACKAGE} == "-data"
d52 6
a88 4

.if ${SUBPACKAGE} != "-data"
RUN_DEPENDS=	${LOCALBASE}/lib/wnn/install-script::japanese/Wnn,-data
.endif
@


1.34
log
@cvs does not cope well with multiple working copies... merging of
Makefiles being atrocious, I lost that line...
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.33 2001/03/28 15:13:03 espie Exp $
d13 1
a13 1
COMMENT-xnwmo=	"X11 input method for Wnn"
@


1.33
log
@The only reason for Wnn-data was the inability to do subpackage
dependencies. This no longer holds.
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.32 2001/03/28 09:22:57 espie Exp $
d13 1
@


1.32
log
@Let Wnn build with XFree4 as well
@
text
@d4 9
a12 1
# $OpenBSD: Makefile,v 1.31 2001/03/16 15:42:49 espie Exp $
a13 7
COMMENT= 	Japanese input method
COMMENT-dict=	dictionaries for Japanese Wnn
COMMENT-ko= 	Korean input method
COMMENT-kodict=	dictionaries for Korean Wnn
COMMENT-xwnmo=	X11 input method for Wnn
COMMENT-zh=	Chinese input method
COMMENT-zhdict=	dictionaries for Chinese Wnn
d16 5
a20 1
MULTI_PACKAGES=-dict -zh -zhdict -ko -kodict -xwnmo
d29 1
d51 2
d84 4
a87 2
# I'm grateful to having `real' cookies, which means this is possible.
RUN_DEPENDS=	${LOCALBASE}/lib/wnn/install-script::japanese/Wnn-data
d130 1
d155 4
@


1.31
log
@Simplify
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.30 2000/10/10 00:40:35 espie Exp $
d120 2
a121 1
MAKE_FLAGS=IMAKE='imake -DPorts' WNNOWNER_INDIRECT=wnn
@


1.30
log
@Fix my address. Dust off details.
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.29 2000/06/11 01:53:45 espie Exp $
d6 7
d16 9
a24 1
NEED_VERSION=	1.270
a32 1
PKGNAME=	ja-Wnndict-4.2
a34 1
PKGNAME=	zh-Wnn-4.2
a37 1
PKGNAME=	zh-Wnndict-4.2
a39 1
PKGNAME=	ko-Wnn-4.2
a42 1
PKGNAME=	ko-Wnndict-4.2
a44 1
PKGNAME=	Wnn-xwnmo-4.2
a46 1
PKGNAME=	ja-Wnn-4.2
@


1.29
log
@Convert to new style bsd.port.mk
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.28 2000/04/28 22:12:23 espie Exp $
d45 1
a45 1
MAINTAINER=	espie@@openbsd.org
d47 1
a47 1
LICENSE_TYPE=		BSD
@


1.28
log
@Wnn-dict -> Wnndict (otherwise, we get conflicts).
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.27 2000/04/24 20:32:02 espie Exp $
a122 1
FAKE=Yes
@


1.28.2.1
log
@bring japanese as of cut-over date into 2.7 branch
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.29 2000/06/11 01:53:45 espie Exp $
d123 1
@


1.27
log
@Typo
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.26 2000/04/22 12:05:57 espie Exp $
d18 1
a18 1
PKGNAME=	ja-Wnn-dict-4.2
d25 1
a25 1
PKGNAME=	zh-Wnn-dict-4.2
d32 1
a32 1
PKGNAME=	ko-Wnn-dict-4.2
@


1.26
log
@Activate xwnmo as well.
create lang subdirs in Wnn-data package, as it's impossible
to know when to dirrm them otherwise (main package or dict ?)
Remove chinese docs from the korean package.
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.25 2000/04/21 15:09:51 espie Exp $
d33 1
a33 1
.elif ${SUBPACKAGE} == "-wnmo"
@


1.25
log
@Put dictionaries in /var/dict/Wnn to avoid confusion with Canna.
Let that be somewhat configurable.
Fix all documentation to refer to the right location for dictionaries.
Fix the install-script so that it can take care of all three languages at
once.
Let un-installation instructions be more helpful, explaining about usr
data.
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.24 2000/04/21 02:10:53 espie Exp $
d8 1
a8 1
MULTI_PACKAGES=-dict -zh -zhdict -ko -kodict
d33 3
d94 1
d105 3
d109 1
a109 1
	@@echo "#define BuildJlibV3	YES" >>${CONFIG_FILE}
@


1.24
log
@Activate other languages, after I fixed a stupid typo...
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.23 2000/04/21 02:01:51 espie Exp $
d7 1
d12 3
d17 1
a17 1
PREFIX=/var/dict
d24 1
a24 1
PREFIX=/var/dict
d31 1
a31 1
PREFIX=/var/dict
d72 3
a74 1
# do those as post-patch, because of the $Id: Makefile,v 1.23 2000/04/21 02:01:51 espie Exp $
d78 8
a85 1
	perl -pi.bak -e 's,\@@LIBDIR/\@@LANG/dic,/var/dict/\@@LANG,' $$file; done
d88 3
a90 1
	@@echo "#define BuildWnn		YES" >${CONFIG_FILE}
@


1.23
log
@Fix a few typos.
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.22 2000/04/21 01:01:32 espie Exp $
d7 1
a7 1
MULTI_PACKAGES=-dict
d68 1
a68 1
# do those as post-patch, because of the $Id: Makefile,v 1.22 2000/04/21 01:01:32 espie Exp $
@


1.22
log
@Spelling
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.21 2000/04/21 00:36:06 espie Exp $
d20 1
d27 1
d68 1
a68 1
# do those as post-patch, because of the $Id: Makefile,v 1.21 2000/04/21 00:36:06 espie Exp $
d87 1
a87 1
	@@echo "#define BuildJlibV3	NO"  >>${CONFIG_FILE}
d108 5
a112 5
.if ${MULTI_PACKAGES:M-zo}
	${INSTALL_DATA_DIR} ${PORT_JDOCDIR}
	@@(cd ${JDOC_FROM}; tar cf - manual manual.en | \
		(cd ${PORT_JDOCDIR}; tar xf -))
	@@chown -R ${SHAREOWN}.${SHAREGRP} ${PORT_JDOCDIR}
@


1.21
log
@Prepare to add chinese and korean to multi-package framework
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.20 2000/04/21 00:25:25 espie Exp $
d66 1
a66 1
# do those as post-patch, because of the $Id: Makefile,v 1.20 2000/04/21 00:25:25 espie Exp $
d84 1
a84 1
	@@echo "#define BuildXnmo	NO"  >>${CONFIG_FILE}
@


1.20
log
@Handle japanese/chinese/korean as a generated config.h file.

Remove *serverrc patches because of $Id$, perform as post-patch instead.
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.19 2000/04/20 23:58:24 espie Exp $
d8 1
d10 1
d12 1
d15 12
d28 1
a31 2
CATEGORIES=	japanese
NEED_VERSION=	1.210
d49 5
a53 2
PORT_DOCDIR=	${PREFIX}/share/doc/ja-Wnn
DOC_FROM=	${WRKSRC}/Wnn
d66 1
a66 1
# do those as post-patch, because of the $Id$
d72 1
a72 1
pre-configure:
d74 3
d78 4
d83 1
d86 1
a86 3

do-configure:
	cd ${WRKSRC}/config && ln -sf Project.tmpl X11.tmpl
d102 10
a111 5
	${INSTALL_DATA_DIR} ${PORT_DOCDIR}
	@@(cd ${DOC_FROM}; tar cf - manual manual.en | \
		(cd ${PORT_DOCDIR}; tar xf -))
	@@chown -R ${SHAREOWN}.${SHAREGRP} ${PORT_DOCDIR}
	@@${INSTALL_SCRIPT} ${FILESDIR}/install-script ${PREFIX}/lib/wnn
@


1.19
log
@Fix paths. Install script as script.
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.18 2000/04/20 23:32:22 espie Exp $
d32 2
d48 13
@


1.18
log
@Split dictionary into a separate package, using MULTI_PACKAGES.
(so that dictionaries install into /var/dict).

Note that ja-Wnn and ja-Wnn-dict do not depend on each other.
The installation `polish' script in Wnn-data should know how to take
care of that.
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.17 2000/04/16 21:53:26 espie Exp $
d41 1
a41 1
RUN_DEPENDS=	${LOCALBASE}/lib/wnn/install-script::japanese-keep/Wnn-data
@


1.17
log
@Loads of changes, not quite finished yet.

- format man pages using new jgroff, so that we can install a full set
of documentation.
- move INSTALL script into a separate script, so that adding a new user
need not be done at the time of INSTALL.
- add a few strlcpy to fix a few holes. This stuff is rather bad, though.
- use terminfo instead of termcap, for better keycap names, fixing quite
a few bugs that made it impossible to build that version along the way...
- move scripts into /usr/local/bin instead of /usr/local/bin/Wnn4.

- use @@comment no checksum
in packing list, even though pkg_add does not support that yet.
Not quite completely ready, but getting there...
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.16 2000/04/05 17:13:55 espie Exp $
d7 6
d14 3
a16 1
CATEGORIES?=	japanese
d38 4
@


1.16
log
@Fix most Wnn issues.
Cleaner build, a few bug-fixes. Fake.
Almost complete PLIST, does not need wnn account
before pkg_add.
@
text
@d4 1
a4 1
# $OpenBSD: Makefile,v 1.15 2000/03/25 00:48:09 turan Exp $
d28 3
a37 9
# for PREFIX
pre-build:
	for file in ${WRKSRC}/config/Project.tmpl \
		${WRKSRC}/Contrib/dic/gerodic/Makefile; do \
	  mv $$file $$file.orig2; \
	  sed 's!^\([ ]*PREFIX = \).*$$!\1${PREFIX}!' \
		$$file.orig2 > $$file; \
	done

d56 1
@


1.15
log
@wnn ports and depends broken.
@
text
@d1 1
a1 5
# Imported from FreeBSD on jul 28 98
# New ports collection makefile for:	Wnn for Japanese
# Version required:	4.2
# Date created:		20 July 1997
# Whom:			Satoshi Taoka <taoka@@infonets.hiroshima-u.ac.jp>
d4 1
a4 3
# $OpenBSD: Makefile,v 1.14 2000/03/24 22:11:46 espie Exp $

BROKEN=		compile problems.  bombs while trying to create accounts.
d7 1
a7 1
PKGNAME?=	ja-Wnn-4.2
d17 4
a20 4
PERMIT_PACKAGE_CDROM=	YES
PERMIT_PACKAGE_FTP=	YES
PERMIT_DISTFILES_CDROM=	YES
PERMIT_DISTFILES_FTP=	YES
d23 1
a23 6
PATCHDIR=	${.CURDIR}/../../japanese/Wnn/patches
FILESDIR=	${.CURDIR}/../../japanese/Wnn/files
PKGDIR=		${.CURDIR}/../../japanese/Wnn/pkg
WRKDIST=		${WRKDIR}/Xsi

NO_PACKAGE=	interactive port
a24 1
.if (${PKGNAME} == ja-Wnn-4.2)
d27 7
a33 25
.elif (${PKGNAME} == zh-Wnn-4.2)
PORT_DOCDIR=	${PREFIX}/share/doc/zh-Wnn
DOC_FROM=	${WRKSRC}/cWnn
.endif  # kWnn has no manual.

post-extract:
	(cd ${WRKSRC} && ${EXTRACT_CMD} ${EXTRACT_BEFORE_ARGS} \
	${FULLDISTDIR}/Wnn4.2.patch.tar.gz ${EXTRACT_AFTER_ARGS})
	/bin/ln -sf Project.tmpl ${WRKSRC}/config/X11.tmpl

pre-patch:
	cd ${WRKSRC}; ${PATCH} ${PATCH_DIST_ARGS} < ${WRKSRC}/Wnn4.2.patch

# Applying a patch for depending on language
post-patch:
	case ${PKGNAME} in \
	  ja-Wnn-4.2) \
		LANG_PATCH=${FILESDIR}/patch-for-japanese;; \
	  zh-Wnn-4.2) \
		LANG_PATCH=${FILESDIR}/patch-for-chinese;; \
	  ko-Wnn-4.2) \
		LANG_PATCH=${FILESDIR}/patch-for-korean;; \
	esac; \
	(cd ${FULLDISTDIR}; \
		${PATCH} ${PATCH_DIST_ARGS} < $${LANG_PATCH})
d44 5
a48 1
# These are necesary because this package uses a different Makefile for
d50 1
d52 4
a55 4
	@@(cd ${WRKSRC}; ${SETENV} ${MAKE_ENV} ${MAKE} ${MAKE_FLAGS} -f Makefile.inst World)

pre-install:
	@@${SH} ${PKGDIR}/INSTALL ${PKGNAME} PRE-INSTALL
d58 2
a59 9
# This package uses imake's "install.man" target to install man pages but
#  I can't define USE_IMAKE because it doesn't involve xmkmf
	@@(cd ${WRKSRC}; ${MAKE} ${MAKE_FLAGS} -f Makefile install.man)
	@@${SETENV} PKG_PREFIX=${PREFIX} \
		${SH} ${PKGDIR}/INSTALL ${PKGNAME} POST-INSTALL
.if !defined(NOPORTDOCS)
.if defined(PORT_DOCDIR)
	mkdir -p ${PORT_DOCDIR}
	@@(cd ${DOC_FROM}; tar cvf - manual manual.en | \
d61 1
a61 3
	@@chown -R bin.bin ${PORT_DOCDIR}
.endif
.endif
@


1.14
log
@Move all NEED_VERSION right after CATEGORY
@
text
@d8 3
a10 1
# $OpenBSD: Makefile,v 1.13 2000/03/03 12:41:00 turan Exp $
@


1.13
log
@missed this one
@
text
@d8 1
a8 1
# $OpenBSD: Makefile,v 1.12 2000/03/03 12:03:02 turan Exp $
a9 1
NEED_VERSION=	1.210
d13 1
@


1.12
log
@broken, installs files automatically in /etc
@
text
@d8 1
a8 3
# $OpenBSD: Makefile,v 1.11 2000/02/22 17:08:40 espie Exp $

BROKEN=		installs files automatically in /etc
@


1.11
log
@MAKEFILE-> MAKE_FILE
@
text
@d8 3
a10 1
# $OpenBSD: Makefile,v 1.10 2000/02/15 05:04:35 turan Exp $
@


1.10
log
@espie will not shut up about this, DISTF -> DISTFILES, PKG -> PACKAGE
@
text
@d8 1
a8 1
# $OpenBSD: Makefile,v 1.9 2000/02/12 06:29:56 turan Exp $
d10 1
a10 1
NEED_VERSION=	1.195
d83 1
a83 1
	@@(cd ${WRKSRC}; ${MAKE} ${MAKE_FLAGS} -f ${MAKEFILE} install.man)
@


1.9
log
@bsd licenses
@
text
@d8 1
a8 1
# $OpenBSD: Makefile,v 1.8 2000/02/12 00:43:59 espie Exp $
d21 4
a24 4
PERMIT_PKG_CDROM=	YES
PERMIT_PKG_FTP=		YES
PERMIT_DISTF_CDROM=	YES
PERMIT_DISTF_FTP=	YES
@


1.8
log
@Change MAKE_FLAGS to remove the -f.

Actually reading the Makefiles proved that about one third of them was
confused about this already...
@
text
@d8 1
a8 1
# $OpenBSD: Makefile,v 1.7 2000/02/11 01:10:04 espie Exp $
d19 6
@


1.7
log
@Kill a large set of deprecated variables.
Thoroughly unsubtle, most mkdir -p should probably be INSTALL* at
*install stage, and echo/ECHO_MSG is somewhat unsorted.

It's quite possible I missed a few automated changes...
@
text
@d8 1
a8 1
# $OpenBSD: Makefile,v 1.6 2000/02/11 00:37:26 espie Exp $
d10 1
a10 1
NEED_VERSION=	1.116
a16 1
NEED_VERSION=	1.191
d69 1
a69 1
	@@(cd ${WRKSRC}; ${SETENV} ${MAKE_ENV} ${MAKE} ${MAKE_FLAGS} Makefile.inst World)
d77 1
a77 1
	@@(cd ${WRKSRC}; ${MAKE} ${MAKE_FLAGS} ${MAKEFILE} install.man)
@


1.6
log
@Use WRKDIST where appropriate.
@
text
@d8 1
a8 1
# $OpenBSD: Makefile,v 1.5 1999/11/03 01:06:42 turan Exp $
d62 2
a63 2
	  ${MV} $$file $$file.orig2; \
	  ${SED} 's!^\([ ]*PREFIX = \).*$$!\1${PREFIX}!' \
d83 1
a83 1
	${MKDIR} ${PORT_DOCDIR}
@


1.5
log
@mark NO_PACKAGE.  interactive install
@
text
@d8 1
a8 1
# $OpenBSD: Makefile,v 1.4 1999/10/30 21:24:53 turan Exp $
d17 1
d25 1
a25 1
WRKSRC=		${WRKDIR}/Xsi
@


1.4
log
@fix extraction problem.  mark unbroken.  I still see compilier warnings
but not enough to concern me.
@
text
@d8 1
a8 1
# $OpenBSD: Makefile,v 1.3 1999/10/29 10:19:37 turan Exp $
d25 2
@


1.3
log
@broken, illegal use of gzip
@
text
@d8 1
a8 3
# $OpenBSD: Makefile,v 1.2 1999/09/22 10:34:03 espie Exp $

BROKEN=		illegal use of gzip
d35 2
a36 2
	${EXTRACT_CMD} -C ${WRKSRC} ${EXTRACT_BEFORE_ARGS} \
		${FULLDISTDIR}/Wnn4.2.patch.tar.gz
@


1.2
log
@_DISTDIR => FULLDISTDIR
@
text
@d8 3
a10 1
# $OpenBSD: Makefile,v 1.1 1998/07/29 01:31:20 espie Exp $
@


1.1
log
@
First cut at a japanese environment
@
text
@d8 1
a8 1
# $OpenBSD$
d10 1
d36 1
a36 1
		${_DISTDIR}/Wnn4.2.patch.tar.gz
d52 1
a52 1
	(cd ${_DISTDIR}; \
@

