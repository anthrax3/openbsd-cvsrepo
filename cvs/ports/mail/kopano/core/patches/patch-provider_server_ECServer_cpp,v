head	1.1;
branch	1.1.1;
access;
symbols
	OPENBSD_6_2:1.1.1.1.0.2
	OPENBSD_6_2_BASE:1.1.1.1
	robert_20170913:1.1.1.1
	robert:1.1.1;
locks; strict;
comment	@# @;


1.1
date	2017.09.13.10.38.42;	author robert;	state Exp;
branches
	1.1.1.1;
next	;
commitid	EUPcYe0im3Fq9qvW;

1.1.1.1
date	2017.09.13.10.38.42;	author robert;	state Exp;
branches;
next	;
commitid	EUPcYe0im3Fq9qvW;


desc
@@



1.1
log
@Initial revision
@
text
@$OpenBSD$

Index: provider/server/ECServer.cpp
--- provider/server/ECServer.cpp.orig
+++ provider/server/ECServer.cpp
@@@@ -57,6 +57,10 @@@@
 #include "ECICS.h"
 #include <openssl/ssl.h>
 
+#ifdef __OpenBSD__
+#include <sys/resource.h>
+#endif
+
 using namespace std;
 
 // The following value is based on:
@@@@ -789,10 +793,10 @@@@ static int running_server(char *szName, const char *sz
 		{"thread_stacksize", "512", CONFIGSETTING_UNUSED},
 		{ "allow_local_users",			"yes", CONFIGSETTING_RELOADABLE },			// allow any user connect through the Unix socket
 		{ "local_admin_users",			"root", CONFIGSETTING_RELOADABLE },			// this local user is admin
-		{ "run_as_user",			"kopano" }, // drop root privileges, and run as this user/group
-		{ "run_as_group",			"kopano" },
+		{ "run_as_user",			"_kopano" }, // drop root privileges, and run as this user/group
+		{ "run_as_group",			"_kopano" },
 		{ "pid_file",					"/var/run/kopano/server.pid" },
-		{ "running_path",			"/var/lib/kopano" },
+		{ "running_path",			"/var/empty" },
 		{"allocator_library", "libtcmalloc_minimal.so.4"},
 		{ "coredump_enabled",			"yes" },
 
@@@@ -833,7 +837,7 @@@@ static int running_server(char *szName, const char *sz
 		{"attachment_s3_bucketname", ""},
 		{"attachment_s3_region", ""},
 #endif
-		{"attachment_path", "/var/lib/kopano/attachments"},
+		{"attachment_path", "/var/db/kopano/attachments"},
 		{ "attachment_compression",		"6" },
 
 		// Log options
@@@@ -907,7 +911,7 @@@@ static int running_server(char *szName, const char *sz
 
 		{"client_update_enabled", "no", CONFIGSETTING_UNUSED},
 		{"client_update_log_level", "1", CONFIGSETTING_UNUSED | CONFIGSETTING_RELOADABLE},
-		{"client_update_path", "/var/lib/kopano/client", CONFIGSETTING_UNUSED | CONFIGSETTING_RELOADABLE},
+		{"client_update_path", "/var/db/kopano/client", CONFIGSETTING_UNUSED | CONFIGSETTING_RELOADABLE},
 		{"client_update_log_path", "/var/log/kopano/autoupdate", CONFIGSETTING_UNUSED | CONFIGSETTING_RELOADABLE},
 		{ "index_services_enabled", "", CONFIGSETTING_UNUSED },
 		{ "index_services_path",    "", CONFIGSETTING_UNUSED },
@


1.1.1.1
log
@import of kopano-{core,mapi,webapp}-8.3.5.1335

Kopano is a replacement of the deprecated Zarafa (ZCP) suite.

Joint work with pirofti@@

For upgrading please refer to the README.

ok ajacoutot@@
@
text
@@
