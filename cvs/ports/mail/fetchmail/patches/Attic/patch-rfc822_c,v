head	1.2;
access;
symbols;
locks; strict;
comment	@# @;


1.2
date	2003.10.15.23.08.49;	author fgsch;	state dead;
branches;
next	1.1;

1.1
date	2003.09.23.20.37.51;	author markus;	state Exp;
branches;
next	;


desc
@@


1.2
log
@update to 6.2.5.
@
text
@$OpenBSD: patch-rfc822_c,v 1.1 2003/09/23 20:37:51 markus Exp $
--- rfc822.c.orig	Thu Jul 17 03:03:20 2003
+++ rfc822.c	Tue Sep 23 11:23:05 2003
@@@@ -176,7 +176,7 @@@@
 	    case 3:	/* we're in a <>-enclosed address */
 		if (*from == '@@' || *from == '!')
 		    has_host_part = TRUE;
-		else if (*from == '>' && from[-1] != '<')
+		else if (*from == '>' && (from > buf && from[-1] != '<'))
 		{
 		    state = 1;
 		    if (!has_host_part)
@@@@ -198,7 +198,7 @@@@
 	/*
 	 * If we passed a comma, reset everything.
 	 */
-	if (from[-1] == ',' && !parendepth) {
+	if ((from > buf && from[-1] == ',') && !parendepth) {
 	  has_host_part = has_bare_name_part = FALSE;
 	  parens_from = NULL;
 	}
@


1.1
log
@out of bounds access; detected by malloc guard; ok fgsch@@
@
text
@d1 1
a1 1
$OpenBSD: $
@

