head	1.5;
access;
symbols
	OPENBSD_4_2:1.4.0.10
	OPENBSD_4_2_BASE:1.4
	OPENBSD_4_1:1.4.0.8
	OPENBSD_4_1_BASE:1.4
	OPENBSD_4_0:1.4.0.6
	OPENBSD_4_0_BASE:1.4
	OPENBSD_3_9:1.4.0.4
	OPENBSD_3_9_BASE:1.4
	OPENBSD_3_8:1.4.0.2
	OPENBSD_3_8_BASE:1.4
	OPENBSD_3_7:1.3.0.6
	OPENBSD_3_7_BASE:1.3
	OPENBSD_3_6:1.3.0.4
	OPENBSD_3_6_BASE:1.3
	OPENBSD_3_5:1.3.0.2
	OPENBSD_3_5_BASE:1.3
	OPENBSD_3_4:1.2.0.2
	OPENBSD_3_4_BASE:1.2
	OPENBSD_3_3:1.1.0.2
	OPENBSD_3_3_BASE:1.1;
locks; strict;
comment	@# @;


1.5
date	2007.11.22.13.52.17;	author ajacoutot;	state dead;
branches;
next	1.4;

1.4
date	2005.04.29.19.51.35;	author jakob;	state Exp;
branches;
next	1.3;

1.3
date	2003.10.05.21.42.29;	author jakob;	state Exp;
branches;
next	1.2;

1.2
date	2003.05.30.20.44.34;	author brad;	state Exp;
branches;
next	1.1;

1.1
date	2002.12.01.20.57.10;	author jakob;	state Exp;
branches;
next	;


desc
@@


1.5
log
@- remove pine; it has been replaced by alpine
@
text
@$OpenBSD: patch-pine_mailcap_c,v 1.4 2005/04/29 19:51:35 jakob Exp $
--- pine/mailcap.c.orig	Wed Nov  3 21:11:17 2004
+++ pine/mailcap.c	Fri Apr 29 19:49:47 2005
@@@@ -993,14 +993,18 @@@@ mc_cmd_bldr(controlstring, type, subtype
 		     * have to put those outside of the single quotes.
 		     * (The parm+1000 nonsense is to protect against
 		     * malicious mail trying to overlow our buffer.)
+		     *
+		     * TCH - Change 2/8/1999
+		     * Also quote the ` slash to prevent execution of arbitrary code
 		     */
 		    for(p = parm; *p && p < parm+1000; p++){
-			if(*p == '\''){
+			if((*p == '\'') || (*p=='`')) {
 			    *to++ = '\'';  /* closing quote */
 			    *to++ = '\\';
-			    *to++ = '\'';  /* below will be opening quote */
-			}
-			*to++ = *p;
+			    *to++ = *p;		/* quoted character */
+			    *to++ = '\'';	/* opening quote */
+			} else
+			    *to++ = *p;
 		    }
 
 		    fs_give((void **) &parm);
@


1.4
log
@pine v4.63
@
text
@d1 1
a1 1
$OpenBSD: patch-pine_mailcap_c,v 1.3 2003/10/05 21:42:29 jakob Exp $
@


1.3
log
@update to pine 4.58, stability and security fixes
@
text
@d1 4
a4 4
$OpenBSD: patch-pine_mailcap_c,v 1.2 2003/05/30 20:44:34 brad Exp $
--- pine/mailcap.c.orig	Tue Sep  2 19:57:34 2003
+++ pine/mailcap.c	Sat Sep 20 00:08:13 2003
@@@@ -933,14 +933,18 @@@@ mc_cmd_bldr(controlstring, type, subtype
@


1.2
log
@sync with update-patches
@
text
@d1 4
a4 4
$OpenBSD: patch-pine_mailcap_c,v 1.1 2002/12/01 20:57:10 jakob Exp $
--- pine/mailcap.c.orig	Mon Apr 28 21:10:42 2003
+++ pine/mailcap.c	Fri May 30 16:41:24 2003
@@@@ -919,14 +919,18 @@@@ mc_cmd_bldr(controlstring, type, subtype
@


1.1
log
@- update to pine v4.50
- split out pilot into separate package
- remove combined pine+pico package
- clean up patches
- remote c-client dependency, link statically
@
text
@d1 4
a4 4
$OpenBSD$
--- pine/mailcap.c.orig	Mon Nov 18 22:47:22 2002
+++ pine/mailcap.c	Sun Dec  1 15:17:46 2002
@@@@ -921,14 +921,18 @@@@ mc_cmd_bldr(controlstring, type, subtype
@

