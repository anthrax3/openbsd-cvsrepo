head	1.4;
access;
symbols
	OPENBSD_6_2:1.4.0.16
	OPENBSD_6_2_BASE:1.4
	OPENBSD_6_1:1.4.0.14
	OPENBSD_6_1_BASE:1.4
	OPENBSD_6_0:1.4.0.12
	OPENBSD_6_0_BASE:1.4
	OPENBSD_5_9:1.4.0.8
	OPENBSD_5_9_BASE:1.4
	OPENBSD_5_8:1.4.0.10
	OPENBSD_5_8_BASE:1.4
	OPENBSD_5_7:1.4.0.6
	OPENBSD_5_7_BASE:1.4
	OPENBSD_5_6:1.4.0.4
	OPENBSD_5_6_BASE:1.4
	OPENBSD_5_5:1.4.0.2
	OPENBSD_5_5_BASE:1.4
	OPENBSD_3_9:1.1.0.2
	OPENBSD_3_9_BASE:1.1;
locks; strict;
comment	@# @;


1.4
date	2013.09.14.17.12.11;	author landry;	state Exp;
branches;
next	1.3;

1.3
date	2006.05.20.17.31.46;	author steven;	state dead;
branches;
next	1.2;

1.2
date	2006.05.15.12.01.25;	author todd;	state Exp;
branches;
next	1.1;

1.1
date	2005.12.26.13.17.35;	author steven;	state Exp;
branches;
next	;


desc
@@


1.4
log
@Update to dspam 3.10.2.

- remove 6 out of the 10 flavors maze, only keep the ones that make
  sense (ie clamav, ldap, domainscale & largescale)
- build pgsql & mysql drivers as subpackages, as $DEITY intended
- @@pkgpath & PFRAG.[flavor]-main tweaks from sthen@@ (thanks!)
- remove init_pwent_cache() patch until i can make some sense of it
- remove painful strlcpy patches
- add patches to fix pgsql support with PSQL > 9.1 from
  http://sourceforge.net/p/dspam/bug-tracker/112/ &
http://sourceforge.net/p/dspam/bug-tracker/141
- add an rc script running dspam --daemon as _dspam
- patch default dspam.conf to trust user _dspam (pointed out by jca@@;
  thanks!) and to use port 2424 by default. Taken from debian.

Discussed at length with todd@@ (MAINTAINER), been running on amd64 with
pgsql &| sqlite backend since a while, also tested on sqlite/ppc.

Some tweaks might still be needed (a README ? Fix some weird crashers ?),
but at least it's better than what we had for the past years.
@
text
@$OpenBSD$
Remove version-info from drivers
dont install-exec-hook for var/dspam/{,log} & etc/dspam.conf
--- src/Makefile.in.orig	Mon Apr 23 19:53:45 2012
+++ src/Makefile.in	Tue Jan  8 22:21:26 2013
@@@@ -470,8 +470,7 @@@@ libdspam_la_LDFLAGS = -rpath '$(libdir)' -version-info
 @@DYNAMIC_DRIVER_TRUE@@libmysql_drv_la_CPPFLAGS = $(libmysql_drv_cppflags)
 @@DYNAMIC_DRIVER_TRUE@@libmysql_drv_la_LDFLAGS =  \
 @@DYNAMIC_DRIVER_TRUE@@	$(libmysql_drv_ldflags) -rpath \
-@@DYNAMIC_DRIVER_TRUE@@	'$(pkglibdir)' -version-info \
-@@DYNAMIC_DRIVER_TRUE@@	$(libversion)
+@@DYNAMIC_DRIVER_TRUE@@	'$(pkglibdir)' -avoid-version
 @@DYNAMIC_DRIVER_TRUE@@libmysql_drv_la_DEPENDENCIES = libdspam.la
 @@DYNAMIC_DRIVER_TRUE@@libpgsql_drv_la_SOURCES = \
 @@DYNAMIC_DRIVER_TRUE@@	pgsql_drv.c pgsql_drv.h 
@@@@ -480,8 +479,7 @@@@ libdspam_la_LDFLAGS = -rpath '$(libdir)' -version-info
 @@DYNAMIC_DRIVER_TRUE@@libpgsql_drv_la_CPPFLAGS = $(libpgsql_drv_cppflags)
 @@DYNAMIC_DRIVER_TRUE@@libpgsql_drv_la_LDFLAGS =  \
 @@DYNAMIC_DRIVER_TRUE@@	$(libpgsql_drv_ldflags) -rpath \
-@@DYNAMIC_DRIVER_TRUE@@	'$(pkglibdir)' -version-info \
-@@DYNAMIC_DRIVER_TRUE@@	$(libversion)
+@@DYNAMIC_DRIVER_TRUE@@	'$(pkglibdir)' -avoid-version
 @@DYNAMIC_DRIVER_TRUE@@libpgsql_drv_la_DEPENDENCIES = libdspam.la
 @@DYNAMIC_DRIVER_TRUE@@libsqlite_drv_la_SOURCES = \
 @@DYNAMIC_DRIVER_TRUE@@	sqlite_drv.c sqlite_drv.h 
@@@@ -490,8 +488,7 @@@@ libdspam_la_LDFLAGS = -rpath '$(libdir)' -version-info
 @@DYNAMIC_DRIVER_TRUE@@libsqlite_drv_la_CPPFLAGS = $(libsqlite_drv_cppflags)
 @@DYNAMIC_DRIVER_TRUE@@libsqlite_drv_la_LDFLAGS =  \
 @@DYNAMIC_DRIVER_TRUE@@	$(libsqlite_drv_ldflags) -rpath \
-@@DYNAMIC_DRIVER_TRUE@@	'$(pkglibdir)' -version-info \
-@@DYNAMIC_DRIVER_TRUE@@	$(libversion)
+@@DYNAMIC_DRIVER_TRUE@@	'$(pkglibdir)' -avoid-version
 @@DYNAMIC_DRIVER_TRUE@@libsqlite_drv_la_DEPENDENCIES = libdspam.la
 @@DYNAMIC_DRIVER_TRUE@@libsqlite3_drv_la_SOURCES = \
 @@DYNAMIC_DRIVER_TRUE@@	sqlite3_drv.c sqlite3_drv.h 
@@@@ -500,8 +497,7 @@@@ libdspam_la_LDFLAGS = -rpath '$(libdir)' -version-info
 @@DYNAMIC_DRIVER_TRUE@@libsqlite3_drv_la_CPPFLAGS = $(libsqlite3_drv_cppflags)
 @@DYNAMIC_DRIVER_TRUE@@libsqlite3_drv_la_LDFLAGS =  \
 @@DYNAMIC_DRIVER_TRUE@@	$(libsqlite3_drv_ldflags) -rpath \
-@@DYNAMIC_DRIVER_TRUE@@	'$(pkglibdir)' -version-info \
-@@DYNAMIC_DRIVER_TRUE@@	$(libversion)
+@@DYNAMIC_DRIVER_TRUE@@	'$(pkglibdir)' -avoid-version
 @@DYNAMIC_DRIVER_TRUE@@libsqlite3_drv_la_DEPENDENCIES = libdspam.la
 @@DYNAMIC_DRIVER_TRUE@@libhash_drv_la_SOURCES = \
 @@DYNAMIC_DRIVER_TRUE@@	hash_drv.c hash_drv.h
@@@@ -509,8 +505,7 @@@@ libdspam_la_LDFLAGS = -rpath '$(libdir)' -version-info
 @@DYNAMIC_DRIVER_TRUE@@libhash_drv_la_LIBADD = $(libhash_drv_libs) -L. -ldspam
 @@DYNAMIC_DRIVER_TRUE@@libhash_drv_la_CPPFLAGS = $(libhash_drv_cppflags)
 @@DYNAMIC_DRIVER_TRUE@@libhash_drv_la_LDFLAGS = $(libhash_drv_ldflags) \
-@@DYNAMIC_DRIVER_TRUE@@	-rpath '$(pkglibdir)' -version-info \
-@@DYNAMIC_DRIVER_TRUE@@	$(libversion)
+@@DYNAMIC_DRIVER_TRUE@@	-rpath '$(pkglibdir)' -avoid-version
 @@DYNAMIC_DRIVER_TRUE@@libhash_drv_la_DEPENDENCIES = libdspam.la
 dspam_SOURCES = \
 	config.h libdspam.h language.h \
@@@@ -1163,7 +1158,6 @@@@ install-dvi-am:
 install-exec-am: install-binPROGRAMS install-libLTLIBRARIES \
 	install-pkglibLTLIBRARIES
 	@@$(NORMAL_INSTALL)
-	$(MAKE) $(AM_MAKEFLAGS) install-exec-hook
 install-html: install-html-recursive
 
 install-html-am:
@


1.3
log
@remove no longer needed shared libs patch
@
text
@d1 61
a61 11
$OpenBSD: patch-src_Makefile_in,v 1.2 2006/05/15 12:01:25 todd Exp $
--- src/Makefile.in.orig	Sun May 14 21:32:29 2006
+++ src/Makefile.in	Sun May 14 21:33:38 2006
@@@@ -412,7 +412,7 @@@@ libdspam_la_LIBADD = $(adapter_objects) 
 libdspam_la_DEPENDENCIES = $(adapter_objects) $(am__append_10)
 
 #   current:revision:age
-libdspam_la_LDFLAGS = -rpath '$(libdir)' -version-info $(libversion)
+libdspam_la_LDFLAGS = -rpath '$(libdir)' $(librealdspam_la_LDFLAGS)
 @@DYNAMIC_DRIVER_TRUE@@libmysql_drv_la_SOURCES = \
 @@DYNAMIC_DRIVER_TRUE@@	mysql_drv.c mysql_drv.h 
d63 1
@


1.2
log
@update to 3.6.6, provided by Frank Dennis

This is a maintenance release that fixes two critical bugs:
  BUGFIX: When using logfile, write errors result in segfault
  BUGFIX: MySQLUIDInSignature causes segfault on retrain
@
text
@d1 1
a1 1
$OpenBSD$
@


1.1
log
@SHARED_LIBS
ok sturm@@
@
text
@d2 4
a5 4
--- src/Makefile.in.orig	Sun Dec 25 19:58:07 2005
+++ src/Makefile.in	Sun Dec 25 19:59:15 2005
@@@@ -442,7 +442,7 @@@@ libdspam_la_LIBADD = $(adapter_objects) 
 libdspam_la_DEPENDENCIES = $(adapter_objects) $(am__append_12)
d10 2
a11 2
 @@DYNAMIC_DRIVER_TRUE@@libdb4_drv_la_SOURCES = \
 @@DYNAMIC_DRIVER_TRUE@@	libdb4_drv.c libdb4_drv.h 
@

