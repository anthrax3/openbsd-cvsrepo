head	1.2;
access;
symbols;
locks; strict;
comment	@# @;


1.2
date	2006.04.28.01.13.37;	author brad;	state dead;
branches;
next	1.1;

1.1
date	2006.03.23.17.17.40;	author todd;	state Exp;
branches;
next	;


desc
@@


1.2
log
@upgrade to dspam 3.6.5; from Frank Denis
@
text
@$OpenBSD: patch-src_tools_pgsql_drv_purge_sql,v 1.1 2006/03/23 17:17:40 todd Exp $
--- src/tools.pgsql_drv/purge.sql.orig	Sun Jan 22 17:02:03 2006
+++ src/tools.pgsql_drv/purge.sql	Sun Jan 22 17:02:06 2006
@@@@ -2,20 +2,20 @@@@
 
 DELETE FROM dspam_token_data
   WHERE (innocent_hits*2) + spam_hits < 5
-  AND CURRENT_DATE - last_hit > 60;
+  AND last_hit < CURRENT_DATE - 60;
 
 DELETE FROM dspam_token_data
   WHERE innocent_hits = 1 AND spam_hits = 0
-  AND CURRENT_DATE - last_hit > 15;
+  AND last_hit < CURRENT_DATE - 15;
 
 DELETE FROM dspam_token_data
   WHERE innocent_hits = 0 AND spam_hits = 1
-  AND CURRENT_DATE - last_hit > 15;
+  AND last_hit < CURRENT_DATE - 15;
 
 DELETE FROM dspam_token_data
-  WHERE CURRENT_DATE - last_hit > 90;
+  WHERE last_hit < CURRENT_DATE - 90;
 
 DELETE FROM dspam_signature_data
-  WHERE CURRENT_DATE - created_on > 14;
+  WHERE created_on < CURRENT_DATE - 14;
 
 VACUUM ANALYSE;
@


1.1
log
@take maintainership, ok jakob@@
update to 3.6.4
(see http://dspam.nuclearelephant.com/text/RELEASE-3.6.4.txt for details)
Additionally:
- fix a typo in a printf
- give postgresql a chance of decent performance
- timeout at 15min not 5min per message by default
@
text
@d1 1
a1 1
$OpenBSD$
@

