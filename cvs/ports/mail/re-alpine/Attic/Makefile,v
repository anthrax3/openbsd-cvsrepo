head	1.17;
access;
symbols
	OPENBSD_5_4:1.15.0.2
	OPENBSD_5_4_BASE:1.15
	OPENBSD_5_3:1.7.0.2
	OPENBSD_5_3_BASE:1.7
	ajacoutot_20120927:1.1.1.1
	ajacoutot:1.1.1;
locks; strict;
comment	@# @;


1.17
date	2013.10.17.09.12.18;	author ajacoutot;	state dead;
branches;
next	1.16;

1.16
date	2013.08.30.01.45.13;	author djm;	state Exp;
branches;
next	1.15;

1.15
date	2013.06.20.08.26.13;	author ajacoutot;	state Exp;
branches;
next	1.14;

1.14
date	2013.06.20.06.54.36;	author ajacoutot;	state Exp;
branches;
next	1.13;

1.13
date	2013.06.17.19.30.44;	author ajacoutot;	state Exp;
branches;
next	1.12;

1.12
date	2013.06.12.19.17.05;	author sthen;	state Exp;
branches;
next	1.11;

1.11
date	2013.06.11.14.59.59;	author sthen;	state Exp;
branches;
next	1.10;

1.10
date	2013.06.02.21.27.07;	author ajacoutot;	state Exp;
branches;
next	1.9;

1.9
date	2013.04.27.15.44.21;	author ajacoutot;	state Exp;
branches;
next	1.8;

1.8
date	2013.03.11.11.23.53;	author espie;	state Exp;
branches;
next	1.7;

1.7
date	2013.01.09.17.42.43;	author ajacoutot;	state Exp;
branches;
next	1.6;

1.6
date	2013.01.08.14.35.28;	author ajacoutot;	state Exp;
branches;
next	1.5;

1.5
date	2012.10.21.20.53.05;	author ajacoutot;	state Exp;
branches;
next	1.4;

1.4
date	2012.10.21.16.38.24;	author espie;	state Exp;
branches;
next	1.3;

1.3
date	2012.10.01.09.40.19;	author sthen;	state Exp;
branches;
next	1.2;

1.2
date	2012.09.30.09.28.11;	author sthen;	state Exp;
branches;
next	1.1;

1.1
date	2012.09.27.15.09.53;	author ajacoutot;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2012.09.27.15.09.53;	author ajacoutot;	state Exp;
branches;
next	;


desc
@@


1.17
log
@mail/re-alpine -> mail/alpine
@
text
@# $OpenBSD: Makefile,v 1.16 2013/08/30 01:45:13 djm Exp $

COMMENT-main=		UW e-mail client
COMMENT-c-client=	UW c-client mail access routines
COMMENT-imap=		UW IMAP4rev1/POP2/POP3 mail servers
COMMENT-mailutil=	UW IMAP4rev1/POP2/POP3 mail utility
COMMENT-pico=		UW text editor
COMMENT-pilot=		UW file system navigator

V=			2.03
DISTNAME=		re-alpine-${V}
EXTRACT_SUFX=		.tar.bz2

SHARED_LIBS=		c-client 5.1

# grep "PICO version" ${WRKSRC}/pico/pico.h
PICO_V=			5.05
# grep PILOT_VERSION ${WRKSRC}/pico/pilot.c
PILOT_V=		2.99

PKGNAME-main=		alpine-${V}
PKGNAME-c-client=	c-client-${V}
PKGNAME-imap=		imap-uw-${V}
PKGNAME-mailutil=	mailutil-uw-${V}
PKGNAME-pico=		pico-${PICO_V}
PKGNAME-pilot=		pilot-${PILOT_V}

EPOCH-c-client=		0
EPOCH-imap=		0
EPOCH-mailutil=		0

REVISION-main=		4
REVISION-c-client=	2
REVISION-imap=		5
REVISION-mailutil=	3
REVISION-pilot=		10
REVISION-pico=		4

CATEGORIES=		mail
CATEGORIES-main=	mail news
CATEGORIES-c-client=	devel mail
CATEGORIES-pico=	editors
CATEGORIES-pilot=	sysutils

HOMEPAGE=		http://www.washington.edu/alpine/

# Apache 2.0
PERMIT_PACKAGE_CDROM=	Yes

MASTER_SITES=		${MASTER_SITE_SOURCEFORGE:=re-alpine/}

MULTI_PACKAGES=		-main -c-client -imap -mailutil -pico -pilot

WANTLIB += asn1 c crypto gssapi krb5 ncurses ssl
WANTLIB += com_err heimbase roken wind

WANTLIB-main=		${WANTLIB} com_err crypto pthread ssl
WANTLIB-c-client=	# empty
WANTLIB-imap=		${WANTLIB} com_err crypto ssl
WANTLIB-mailutil=	${WANTLIB} com_err crypto ssl
WANTLIB-pico=		${WANTLIB} pthread
WANTLIB-pilot=		${WANTLIB} pthread

MODULES=		devel/gettext
BUILD_DEPENDS=		textproc/aspell/core
RUN_DEPENDS-main=	${RUN_DEPENDS} textproc/aspell/core
RUN_DEPENDS-pico=	${RUN_DEPENDS} textproc/aspell/core
RUN_DEPENDS-c-client=	#empty

# Link error: c-client not found!
USE_LIBTOOL=		gnu

SHLIB=			libc-client.so.${LIBc-client_VERSION}
MAKE_FLAGS=		EXTRACFLAGS="${CFLAGS}" \
			SHLIB="${SHLIB}" \
			SHLIBNAME=${SHLIB} \
			CC="${CC}" \
			EXTRAAUTHENTICATORS="gss" \
			GSSCFLAGS="-DHEIMDAL"

CONFIGURE_STYLE=	gnu
CONFIGURE_ENV=		CPPFLAGS="-I${LOCALBASE}/include $$(krb5-config --cflags)" \
			LDFLAGS="-L${LOCALBASE}/lib" \
			LIBS="$$(krb5-config gssapi --libs)" \
			ac_cv_search_regcomp=-lc
CONFIGURE_ARGS=		${CONFIGURE_SHARED} \
			--with-system-pinerc=${SYSCONFDIR}/pine.conf \
			--with-system-fixed-pinerc=${SYSCONFDIR}/pine.conf.fixed \
			--with-system-mail-directory=/var/mail \
			--with-ssl-certs-dir=/etc/ssl \
			--with-simple-spellcheck=aspell \
			--with-interactive-spellcheck=aspell \
			--with-c-client-target=bso \
			--with-debug-level=0 \
			--without-ldap \
			--without-tcl \
			--enable-quotas \
			--disable-debug

HEADERS=		c-client.h dummy.h env.h env_unix.h fdstring.h \
			flockcyg.h flocksim.h flstring.h fs.h ftl.h \
			imap4r1.h linkage.c linkage.h mail.h misc.h \
			netmsg.h newsrc.h nl.h nntp.h osdep.h pseudo.h \
			rfc822.h smtp.h sslio.h tcp.h tcp_unix.h unix.h \
			utf8.h utf8aux.h

post-install:
	# alpine, pico, pilot
	${INSTALL_DATA_DIR} ${PREFIX}/share/{doc,examples}/alpine
	${INSTALL_DATA} ${WRKSRC}/doc/tech-notes.txt \
		${WRKSRC}/doc/mailcap.unx \
		${WRKSRC}/doc/mime.types \
		${PREFIX}/share/doc/alpine
	${WRKBUILD}/alpine/alpine -conf > \
		${PREFIX}/share/examples/alpine/pine.conf
	# c-client
	${INSTALL_DATA_DIR} ${PREFIX}/include/c-client
	cd ${WRKSRC}/c-client; ${INSTALL_DATA} ${HEADERS} \
		${PREFIX}/include/c-client
	${INSTALL_DATA} ${WRKBUILD}/c-client/c-client.a \
		${PREFIX}/lib/libc-client.a
	@@if [ -f ${WRKBUILD}/imap/c-client/${SHLIB} ]; then \
		${INSTALL_DATA} ${WRKSRC}/c-client/${SHLIB} ${PREFIX}/lib; \
	fi
	# imap-uw
	${INSTALL_PROGRAM} ${WRKBUILD}/imap/imapd/imapd ${PREFIX}/libexec
	${INSTALL_PROGRAM} ${WRKBUILD}/imap/ipopd/ipop2d ${PREFIX}/libexec
	${INSTALL_PROGRAM} ${WRKBUILD}/imap/ipopd/ipop3d ${PREFIX}/libexec
	${INSTALL_PROGRAM} ${WRKBUILD}/imap/mlock/mlock ${PREFIX}/libexec
	${INSTALL_PROGRAM} ${WRKBUILD}/imap/dmail/dmail ${PREFIX}/bin
	${INSTALL_PROGRAM} ${WRKBUILD}/imap/tmail/tmail ${PREFIX}/bin
	${INSTALL_MAN} ${WRKSRC}/imap/src/{imapd,ipopd}/*.8 \
		${PREFIX}/man/man8
	${INSTALL_MAN} ${WRKSRC}/imap/src/{dmail,tmail}/*.1 \
		${PREFIX}/man/man1
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/imap-uw
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/imap-uw
	${INSTALL_DATA} ${FILESDIR}/c-client.cf \
		${PREFIX}/share/examples/imap-uw
	tar -C ${WRKSRC}/imap/docs -cf - . | \
		tar -C ${PREFIX}/share/doc/imap-uw -xf -
	# mailutil
	${INSTALL_PROGRAM} ${WRKBUILD}/imap/mailutil/mailutil ${PREFIX}/bin
	${INSTALL_MAN} ${WRKSRC}/imap/src/mailutil/mailutil.1 ${PREFIX}/man/man1

.include <bsd.port.mk>

.if defined(NO_SHARED_LIBS) && ${NO_SHARED_LIBS:L} == "yes"
MAKE_ENV +=		NO_SHARED_LIBS=Yes
.endif
@


1.16
log
@make home/end keys work in rxvt-derived terminals; ok sthen, ajacoutot
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2013/06/20 08:26:13 ajacoutot Exp $
@


1.15
log
@No need for pthread.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2013/06/20 06:54:36 ajacoutot Exp $
d32 1
a32 1
REVISION-main=		3
d36 2
a37 2
REVISION-pilot=		9
REVISION-pico=		3
@


1.14
log
@Unbreak after hx509 and ntlm removal from Kerberos.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2013/06/17 19:30:44 ajacoutot Exp $
d34 2
a35 2
REVISION-imap=		4
REVISION-mailutil=	2
d59 2
a60 2
WANTLIB-imap=		${WANTLIB} com_err crypto pthread ssl
WANTLIB-mailutil=	${WANTLIB} com_err crypto pthread ssl
@


1.13
log
@Unbreak with new Heimdal; get rid of self-cooked krb5-config since we
have it in base now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2013/06/12 19:17:05 sthen Exp $
d32 6
a37 6
REVISION-main=		2
REVISION-c-client=	1
REVISION-imap=		3
REVISION-mailutil=	1
REVISION-pilot=		8
REVISION-pico=		2
d55 1
a55 1
WANTLIB += com_err heimbase heimntlm hx509 roken wind
@


1.12
log
@oh *that*'s where the existing REVISION entries were hiding...actually bump
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2013/06/11 14:59:59 sthen Exp $
d32 6
a37 5
REVISION=		0
REVISION-main=		1
REVISION-imap=		2
REVISION-pilot=		7
REVISION-pico=		1
d54 4
a57 2
WANTLIB=		asn1 c crypto gssapi krb5 ncurses ssl
WANTLIB-main=		${WANTLIB} com_err crypto kafs pthread ssl
d59 2
a60 2
WANTLIB-imap=		${WANTLIB} com_err crypto kafs ssl
WANTLIB-mailutil=	${WANTLIB} com_err crypto kafs ssl
d68 1
a68 1
RUN_DEPENDS-c-client=	# empty
d74 6
a79 1
MAKE_FLAGS=		EXTRACFLAGS="${CFLAGS}" SHLIB="${SHLIB}" SHLIBNAME=${SHLIB} CC="${CC}" EXTRAAUTHENTICATORS="gss"
d82 1
a82 1
CONFIGURE_ENV=		CPPFLAGS="-I${LOCALBASE}/include" \
d84 1
a84 1
			LIBS="-lgssapi -lkrb5 -lasn1 -lcrypto" \
a86 1
			--with-krb5-include-dir=/usr/include/kerberosV \
@


1.11
log
@only RUN_DEPENDS on aspell where needed, ok/feedback aja
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2013/06/02 21:27:07 ajacoutot Exp $
a10 1
REVISION=		0
d32 5
a36 4
REVISION-main=		0
REVISION-imap=		1
REVISION-pilot=		6
REVISION-pico=		0
@


1.10
log
@etc -> SYSCONFDIR
Drop unused patch.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2013/04/27 15:44:21 ajacoutot Exp $
d11 1
d63 3
a65 1
RUN_DEPENDS=		textproc/aspell/core
@


1.9
log
@Tweak MESSAGEs/READMEs now that inetd(8) is off by default.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2013/03/11 11:23:53 espie Exp $
d32 2
a33 1
REVISION-imap=		0
@


1.8
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2013/01/09 17:42:43 ajacoutot Exp $
d32 1
@


1.7
log
@Re-introduce REVISION-pilot which was wrongly removed.
Add REVISION-pilot.

spotted by nigel@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2013/01/08 14:35:28 ajacoutot Exp $
a44 3
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM= Yes
PERMIT_DISTFILES_FTP=	Yes
@


1.6
log
@Update the re-alpine suite to version 2.03.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2012/10/21 20:53:05 ajacoutot Exp $
d31 3
@


1.5
log
@Tweak previous to make it parseable by human eyes.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2012/10/21 16:38:24 espie Exp $
d10 1
a10 1
V=			2.02
a30 2

REVISION-pilot=		5
@


1.4
log
@zap spaces
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2012/10/01 09:40:19 sthen Exp $
d16 4
a19 2
PICO_V=			5.05# grep "PICO version" ${WRKSRC}/pico/pico.h
PILOT_V=		2.99# grep PILOT_VERSION ${WRKSRC}/pico/pilot.c
@


1.3
log
@REVISION-pilot needs more bumps, the previous one was actually 2.99p4.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2012/09/30 09:28:11 sthen Exp $
d16 2
a17 2
PICO_V=			5.05 # grep "PICO version" ${WRKSRC}/pico/pico.h
PILOT_V=		2.99 # grep PILOT_VERSION ${WRKSRC}/pico/pilot.c
@


1.2
log
@REVISION-pilot needs a bump
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2012/09/27 15:09:53 ajacoutot Exp $
d30 1
a30 1
REVISION-pilot=		1
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d30 1
a30 1
REVISION-pilot=		0
@


1.1.1.1
log
@Import alpine-2.02.

This is the continuation of the Alpine email client from University of
Washington.
This port will be used to build the following packages:
- alpine
- c-client
- imap-uw
- mailutil-uw
- pico
- pilot

ok jasper@@
@
text
@@
