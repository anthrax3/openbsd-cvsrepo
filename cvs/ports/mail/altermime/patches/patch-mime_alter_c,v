head	1.1;
branch	1.1.1;
access;
symbols
	OPENBSD_6_1:1.1.1.1.0.20
	OPENBSD_6_1_BASE:1.1.1.1
	OPENBSD_6_0:1.1.1.1.0.18
	OPENBSD_6_0_BASE:1.1.1.1
	OPENBSD_5_9:1.1.1.1.0.14
	OPENBSD_5_9_BASE:1.1.1.1
	OPENBSD_5_8:1.1.1.1.0.16
	OPENBSD_5_8_BASE:1.1.1.1
	OPENBSD_5_7:1.1.1.1.0.12
	OPENBSD_5_7_BASE:1.1.1.1
	OPENBSD_5_6:1.1.1.1.0.10
	OPENBSD_5_6_BASE:1.1.1.1
	OPENBSD_5_5:1.1.1.1.0.8
	OPENBSD_5_5_BASE:1.1.1.1
	OPENBSD_5_4:1.1.1.1.0.6
	OPENBSD_5_4_BASE:1.1.1.1
	OPENBSD_5_3:1.1.1.1.0.4
	OPENBSD_5_3_BASE:1.1.1.1
	OPENBSD_5_2:1.1.1.1.0.2
	OPENBSD_5_2_BASE:1.1.1.1
	ajacoutot_20120530:1.1.1.1
	ajacoutot:1.1.1;
locks; strict;
comment	@# @;


1.1
date	2012.05.30.16.47.01;	author ajacoutot;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2012.05.30.16.47.01;	author ajacoutot;	state Exp;
branches;
next	;


desc
@@



1.1
log
@Initial revision
@
text
@$OpenBSD$

http://bugs.debian.org/625307

--- mime_alter.c.orig	Sun Nov 16 09:45:45 2008
+++ mime_alter.c	Wed May 30 15:44:10 2012
@@@@ -2432,7 +2432,6 @@@@ int AM_add_disclaimer( char *mpackname )
 	char mpackold[AM_1K_BUFFER_SIZE+1]="";
 	struct AM_disclaimer_details dd;
 	int result = 0;
-	int segment_read = 0;
 
 	/* create our temp filename */
 	snprintf(mpacktmp,AM_1K_BUFFER_SIZE, "%s.tmp",mpackname);
@@@@ -2623,7 +2622,6 @@@@ int AM_add_disclaimer( char *mpackname )
 				  */
 
 
-			segment_read = 0;
 			if (FFGET_feof(&f)) break;
 
 			// If we've found a boundary and a text content section...
@@@@ -3698,7 +3696,6 @@@@ Changes:
 int AM_attachment_replace_recurse( struct MIMEH_header_info *hinfo, FFGET_FILE *f, FILE *outputfile, regex_t *preg, char *new_attachment_name, int iteration )
 {
 	int result = 0;
-	int boundary_exists=0;
 	size_t bc;
 
 	if (AM_DNORMAL) LOGGER_log("%s:%d:AM_attachment_replace_recurse:DEBUG: Starting: iteration=%d",FL, iteration );
@@@@ -3776,7 +3773,6 @@@@ int AM_attachment_replace_recurse( struct MIMEH_header
 		{
 			if (AM_DNORMAL)LOGGER_log("%s:%d:AM_attachment_replace_recurse:DEBUG: pushing BS='%s'",FL, hinfo->boundary );
 			BS_push( hinfo->boundary );
-			boundary_exists = 1;
 		}
 
 		// Now, determine if this block/segment is the one which contains our file which we must 'nullify'
@


1.1.1.1
log
@Import altermime-0.3.10.

alterMIME is a small program which is used to alter your mime-encoded
mailpacks as typically received by e.g. amavisd-new.
It can:
    * Insert disclaimers
    * Insert arbitary X-headers
    * Modify existing headers
    * Remove attachments based on filename or content-type
    * Replace attachments based on filename

ok jasper@@
@
text
@@
