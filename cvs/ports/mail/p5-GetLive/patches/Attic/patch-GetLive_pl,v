head	1.9;
access;
symbols
	OPENBSD_5_5:1.8.0.2
	OPENBSD_5_5_BASE:1.8
	OPENBSD_5_4:1.7.0.10
	OPENBSD_5_4_BASE:1.7
	OPENBSD_5_3:1.7.0.8
	OPENBSD_5_3_BASE:1.7
	OPENBSD_5_2:1.7.0.6
	OPENBSD_5_2_BASE:1.7
	OPENBSD_5_1_BASE:1.7
	OPENBSD_5_1:1.7.0.4
	OPENBSD_5_0:1.7.0.2
	OPENBSD_5_0_BASE:1.7
	OPENBSD_4_9:1.6.0.4
	OPENBSD_4_9_BASE:1.6
	OPENBSD_4_8:1.6.0.2
	OPENBSD_4_8_BASE:1.6
	OPENBSD_4_7:1.5.0.4
	OPENBSD_4_7_BASE:1.5
	OPENBSD_4_6:1.5.0.2
	OPENBSD_4_6_BASE:1.5
	OPENBSD_4_5:1.4.0.2
	OPENBSD_4_5_BASE:1.4
	OPENBSD_4_4:1.2.0.2
	OPENBSD_4_4_BASE:1.2
	OPENBSD_4_3:1.1.1.1.0.2
	OPENBSD_4_3_BASE:1.1.1.1
	merdely_20071010:1.1.1.1
	merdely:1.1.1;
locks; strict;
comment	@# @;


1.9
date	2014.05.06.17.54.50;	author jasper;	state dead;
branches;
next	1.8;

1.8
date	2013.11.19.15.47.33;	author merdely;	state Exp;
branches;
next	1.7;

1.7
date	2011.05.05.13.37.04;	author gsoares;	state Exp;
branches;
next	1.6;

1.6
date	2010.07.21.02.21.52;	author merdely;	state Exp;
branches;
next	1.5;

1.5
date	2009.03.07.15.22.51;	author merdely;	state Exp;
branches;
next	1.4;

1.4
date	2008.11.11.22.03.59;	author merdely;	state Exp;
branches;
next	1.3;

1.3
date	2008.11.10.20.23.50;	author merdely;	state Exp;
branches;
next	1.2;

1.2
date	2008.07.10.14.37.31;	author merdely;	state Exp;
branches;
next	1.1;

1.1
date	2007.10.10.15.17.49;	author merdely;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2007.10.10.15.17.49;	author merdely;	state Exp;
branches;
next	;


desc
@@


1.9
log
@Remove p5-GetLive, it's been declared EOL upstream after playing catchup
with Hotmail/Live changes for years:
http://sourceforge.net/p/getlive/news/2014/05/the-end-of-getlive---stay-tuned/

committing on behalf of merdely@@ (MAINTAINER)
@
text
@Diff from GetLive CVS to incorporate Outlook.com site changes.

$OpenBSD: patch-GetLive_pl,v 1.8 2013/11/19 15:47:33 merdely Exp $
--- GetLive.pl.orig	Tue Apr  2 17:10:46 2013
+++ GetLive.pl	Sat Nov 16 22:27:39 2013
@@@@ -92,7 +92,7 @@@@ sub new {
   $Self->{'Login'}             = "";
   $Self->{'Domain'}            = "hotmail.com";
   $Self->{'Password'}          = "";
-  $Self->{'MailProcessor'}     = '/usr/bin/procmail'; # Any program taking mbox formatted at stdin will do.
+  $Self->{'MailProcessor'}     = '${LOCALBASE}/bin/procmail'; # Any program taking mbox formatted at stdin will do.
   $Self->{'DownloadedIdsFile'} = "";                  # Local file with Ids of already downloaded messages.
   $Self->{'MarkRead'}          = "No";                # No,Yes : But never when downloaded before !
   $Self->{'Delete'}            = "No";                # No,Yes : But never when downloaded before !
@@@@ -398,6 +398,8 @@@@ sub GetPage {
  
   $Self->Log("Response headers : \n" . $Response->headers_as_string(), MinVerbosity => 100);
 
+  $Self->Log("Response content : \n" . $Response->content(), MinVerbosity => 100);
+
   return ($Response->content(),uri_unescape($Response->request->uri));
 }
 
@@@@ -457,16 +459,15 @@@@ sub Login {
   my $Domain = $Self->{'Domain'};
   my ($LoginUrl) = $LoginPageAsString =~ m{'(https://login.live.com/ppsecure/post.srf.*?)'};
 
-  if ($LoginPageAsString !~ m/F:'(P.*?)'/s) {
-     $Self->Log("Page doesn't contain PPSX in the expected place.\n",stderr => 1);
-     return 0;
+  if ($LoginPageAsString !~ m/[F|AP]:'(P.*?)'/s) {
+    $PostData{"PPSX"} = "Pass";
+  } else {
+    $Self->Log("PPSX detected as '$1'.\n", MinVerbosity => 10 );
+    $PostData{"PPSX"} = $1;
   }
   
   # End of Michael Kelly patch.
 
-  $Self->Log("PPSX detected as '$1'.\n", MinVerbosity => 10 );
-  $PostData{"PPSX"} = $1;
-  
   # PPFT is a normal (ie non JS) hidden input type.
   if( $LoginPageAsString !~ m/<\s*input\s+.*name=\"PPFT\"(\s+id="\S+")?\s+value=\"(\S*)\"/ ) {
     Self->Log("Page doesn't contain input field PPFT as expected.\n",stderr => 1);
@


1.8
log
@Update to 3.0.  This commit also includes some of upstream's post-3.0 changes
that fix changes to outlook.com's login screen.

"update looks good to me" -sthen@@ (prior to s/hotmail\.com/outlook\.com/ change to COMMENT by me).
@
text
@d3 1
a3 1
$OpenBSD: patch-GetLive_pl,v 1.7 2011/05/05 13:37:04 gsoares Exp $
@


1.7
log
@- update p5-GetLive to 2.3.
- tweak license
- regen patches / plist
- add missing dependency

requested by MAINTAINER (merdely@@)
- switch MESSAGE to README

ok jasper@@ sthen@@ merdely@@(MAINTAINER)
@
text
@d1 1
a1 1
Diff from GetLive CVS to incorporate Hotmail site changes.
d3 4
a6 4
$OpenBSD: patch-GetLive_pl,v 1.6 2010/07/21 02:21:52 merdely Exp $
--- GetLive.pl.orig	Mon May  2 14:49:46 2011
+++ GetLive.pl	Mon May  2 15:02:56 2011
@@@@ -91,7 +91,7 @@@@ sub new {
d15 31
@


1.6
log
@Update GetLive to 0.59.
@
text
@d3 12
a14 12
$OpenBSD: patch-GetLive_pl,v 1.5 2009/03/07 15:22:51 merdely Exp $
--- GetLive.pl.orig	Tue Jul 20 22:08:31 2010
+++ GetLive.pl	Tue Jul 20 22:15:36 2010
@@@@ -65,7 +65,7 @@@@ my $Password                = "";
 my $Domain                  = 'hotmail.com';
 my $CurlCommand             = 'curl -k';
 my $Verbosity               = 1; 									  # 0:Silent; 1:Normal; 2:Verbose; 10:debug; 100:heavy debug 
-my $MailProcessor           = '/usr/bin/procmail';	# Any program taking mbox formatted at stdin will do.
+my $MailProcessor           = '${LOCALBASE}/bin/procmail';	# Any program taking mbox formatted at stdin will do.
 my $DownloadedIdsFile       = "";                   # Local file with Ids of already downloaded messages.
 my $RetryLimit              = 2;
 my $MarkRead                = "No";                 # No,Yes : But never when downloaded before !
@


1.5
log
@Apply diff from GetLive CVS to make GetLive work after updates to the
Hotmail website.

ok jasper
@
text
@d3 4
a6 4
$OpenBSD: patch-GetLive_pl,v 1.4 2008/11/11 22:03:59 merdely Exp $
--- GetLive.pl.orig	Sat Jul  5 16:27:36 2008
+++ GetLive.pl	Fri Mar  6 23:56:19 2009
@@@@ -65,11 +65,12 @@@@ my $Password                = "";
a14 287
 my $Delete                  = "No";                 # No,Yes : But never when downloaded before !
+my $SkipTrash               = "No";                 # No,Yes : Do not handle the Trash folder
 my $FetchOnlyUnread         = "No";                 # If Yes, only messages marked unread are downloaded.
                                                     # Unlike gotmail, this is completely orthogonal to the
                                                     # DownloadedIdsFile, i.e. it is the one or the other.
@@@@ -78,6 +79,8 @@@@ my $MoveToFolder            = "";                   # 
                                                     # contains the folder to move to. This is a hook for 
                                                     # autoclassifying the mail on the server, including spam filtering.
 
+my $Mode                    = "200809";
+
 # Quirk. MS generates unended <pre> tags. Hope this is a temporary weakness in their mind.
 # (Hope makes living, we say in Dutch ...)
 # If we want to allow it set this to one. Currently as of 8/9/2007 it must be accepted or the
@@@@ -275,7 +278,7 @@@@ sub ParseConfig {
     } elsif ($Option =~ m/^Password$/i) {
       $Password = $OptionValue;
     } elsif ($Option =~ m/^Mode$/i) {
-      warn "\n'Mode = ...' in the config file is ignored.\nThis version works only for 'Live' mailboxes !\n"; 
+      $Mode = $OptionValue;
     } elsif ($Option =~ m/^Domain$/i) {
       $Domain = $OptionValue;
     } elsif ($Option =~ m/^Proxy$/i) {
@@@@ -298,6 +301,8 @@@@ sub ParseConfig {
       $MarkRead = $OptionValue;
     } elsif ($Option =~ m/^Delete$/i) {
       $Delete = $OptionValue;
+    } elsif ($Option =~ m/^SkipTrash$/i) {
+      $SkipTrash = $OptionValue;
     } elsif ($Option =~ m/^MoveToFolder$/i) {
       $MoveToFolder = $OptionValue;
     } else {
@@@@ -332,6 +337,10 @@@@ sub ParseConfig {
     Display("MarkRead should take No or Yes as argument in the configuration file.\n",stderr=>1);
     DisplayUsageAndExit(); 
   }
+  if ($SkipTrash !~ m/^(No|Yes)$/i) {
+    Display("SkipTrash should take No or Yes as argument in the configuration file.\n",stderr=>1);
+    DisplayUsageAndExit(); 
+  }
   if ($Delete !~ m/^(No|Yes)$/i) {
     Display("Delete should take No or Yes as argument in the configuration file.\n",stderr=>1);
     DisplayUsageAndExit(); 
@@@@ -340,6 +349,10 @@@@ sub ParseConfig {
     Display("Delete must be 'No' when MoveToFolder is also specified in the configuration file.\n",stderr=>1);
     DisplayUsageAndExit(); 
   }
+  if ($Mode !~ m/^(200809|200810|200902)$/i) {
+    Display("Mode must be oneof 200809,200810,200902 as argument in the configuration file.\n",stderr=>1);
+    DisplayUsageAndExit(); 
+  }
 }
 
 ########################################################################################################################
@@@@ -535,7 +548,7 @@@@ sub Login() {
 
 	Display("Getting hotmail index loginpage.\n", MinVerbosity =>2);
 
-  my ($LoginPageAsString,$GetPageUrl) = GetPage(Url => "http://mail.live.com",FollowForward => 1);
+  my ($LoginPageAsString,$GetPageUrl) = GetPage(Url => "http://mail.live.com/",FollowForward => 1);
 
   # We expect here a number of functions now (aug 2007) to be hidden in a javascript
   # that is loaded separately. Let's load and append.
@@@@ -690,7 +703,9 @@@@ REENTRY_DARREN_QUIRK:
 
   Display("LoginUrl 2 : '$LoginUrl'.\n",MinVerbosity => 10);
   # Following the redirect : Third step of login.
-	Display("Following redirect.\n",MinVerbosity => 2);
+  Display("Following redirect.\n",MinVerbosity => 2);
+
+LABEL_20090214:
   ($LoginPageAsString,$GetPageUrl) = GetPage(Url => $LoginUrl,FollowForward => 1);
 
   $LoginUrl = $GetPageUrl;
@@@@ -716,6 +731,19 @@@@ REENTRY_DARREN_QUIRK:
   } elsif ($LoginPageAsString =~ m/MSNPlatform\/browsercompat.js/) {
     $LoggedIn = 1;
   }
+
+  # Since 14/2/2009 we are not logged in anymore now ...
+
+  my $Tried20090214 = 0;
+  if (!$LoggedIn && !$Tried20090214) {
+    if ($LoginPageAsString !~ m/src=\"([^\"]*)\"/) {
+      die "Could not log in. Maybe structure has changed or was not foreseen.";
+    }
+    $LoginUrl = HtmlUnescape($1);
+    Display("Following link '$LoginUrl'.\n",MinVerbosity=>2);
+    $Tried20090214 = 1;
+    goto LABEL_20090214
+  }
  
   die "Could not log in. Maybe structure has changes or was not foreseen." unless $LoggedIn;
     
@@@@ -960,7 +988,7 @@@@ sub GetMessagesFromFolder($) {
 	    		      "au=$AuthUser&".
                 "ptid=0";
       my $PostData = "";
-      if ($Page == 1) {
+      if ($Mode =~ m/200809/ && $Page == 1) {
         $PostData = "cn=Microsoft.Msn.Hotmail.Ui.Fpp.MailBox".
                     "&".
                     "mn=GetInboxData".
@@@@ -971,7 +999,7 @@@@ sub GetMessagesFromFolder($) {
                     "v=1".
                     "&".
                     "mt=$MT";
-      } else {
+      } elsif ($Mode =~ m/200809/) {
         $PostData = "cn=Microsoft.Msn.Hotmail.Ui.Fpp.MailBox".
                     "&".
                     "mn=GetInboxData".
@@@@ -979,11 +1007,37 @@@@ sub GetMessagesFromFolder($) {
                     "d=true,true,{".uri_escape("\"$FolderId\"").",25,NextPage,0,Date,false,".
                       uri_escape("\"$pnAm\"") . "," .
                       uri_escape("\"$pnAd\"") . "," .
-                      "$Page,2,false,null,false,$ReportedNrMessages},false,null".
+                    "$Page,2,false,null,false,$ReportedNrMessages},false,null".
                     "&".
                     "v=1".
                     "&".
                     "mt=$MT";
+      } elsif ($Mode =~ m/(200810|200902)/ && $Page == 1) {
+        $PostData = "cn=Microsoft.Msn.Hotmail.Ui.Fpp.MailBox".
+                    "&".
+                    "mn=GetInboxData".
+                    "&".
+                    "d=true,true,{".uri_escape("\"$FolderId\"").",0,0,Date,false,".
+                      uri_escape("\"$pnAm\"") . "," .
+                      uri_escape("\"$pnAd\"") . "," .
+                    "$Page,2,false,%22%22,0,-1,Off},false,null".
+                      "&".
+                      "v=1".
+                      "&".
+                    "mt=$MT";
+      } elsif ($Mode =~ m/(200810|200902)/) {
+        $PostData = "cn=Microsoft.Msn.Hotmail.Ui.Fpp.MailBox".
+                    "&".
+                    "mn=GetInboxData".
+                    "&".
+                    "d=true,true,{".uri_escape("\"$FolderId\"").",NextPage,0,Date,false,".
+                      uri_escape("\"$pnAm\"") . "," .
+                      uri_escape("\"$pnAd\"") . "," .
+                    "$Page,2,false,%22%22,$ReportedNrMessages,-1,Off},false,null".
+                      "&".
+                      "v=1".
+                      "&".
+                      "mt=$MT";
       }
 
 	    ($PageAsString,$GetPageUrl) = GetPage(Url => $Url,CurlDataArg => $PostData); 
@@@@ -1003,8 +1057,9 @@@@ sub GetMessagesFromFolder($) {
   
       # get the ID for the trash folder
       $TrashFolderId = $PageAsString;
-      $TrashFolderId =~ m/sysFldrs\s*?:\s*?{\s*?trashFid\s*?:\s*?\"(.*?)\".*?}/si;
+      $TrashFolderId =~ m/sysFldrs\s*?:\s*?{.*?trashFid\s*?:\s*?\"(.*?)\".*?}/si;
       $TrashFolderId = $1;
+      die "Could not find TrashFolderId." unless $TrashFolderId;
   
       # get the session variables as well as the request handler
       $PageAsString =~ m/fppCfg\s*?:\s*?{\s*?RequestHandler\s*?:\s*?\"(.*?)\".*?SessionId\s*?:\s*?\"(.*?)\".*?AuthUser\s*?:\s*?\"(.*?)\".*?}/si;
@@@@ -1016,9 +1071,12 @@@@ sub GetMessagesFromFolder($) {
 
     # To start with we limit us to a MessagesArea between
     # <table class="dItemListContentTable"..>  ... </table..>
-    if ($PageAsString !~ m/<table class=\"d?ItemListContentTable[^>]*>(.*?)<\/table/si) {
+    if ($Mode =~ m/200809/ && $PageAsString !~ m/<table class=\"d?ItemListContentTable[^>]*>(.*?)<\/table/si) {
       die "Could not correctly parse the messages table.";
     }
+    if ($Mode =~ m/(200810|200902)/ && $PageAsString !~ m/<table class=\"d?InboxTable[^>]*>(.*?)<\/table/si) {
+      die "Could not correctly parse the messages table.";
+    }
     my $MessagesArea = $1;
 
     # In this message area there's the body of the table containing messages.
@@@@ -1046,24 +1104,44 @@@@ sub GetMessagesFromFolder($) {
       my $MessageId = $1;
       my $MessageAd = $2;
       
-      # Goto 5th column.(to get the from)
+      # Goto column containing from info.(to get the from)
       my $TdLine = "";
-      for (my $Idx=0;$Idx<4;$Idx++) {
+      my $Column = 5;
+      if ($Mode =~ m/(200810|200902)/) { $Column = 4; }
+      for (my $Idx=0;$Idx<($Column-1);$Idx++) {
         $MessagesArea =~ m/<td(.*?)>(.*?)<\/td\s*>/i;
         $MessagesArea = $';
         $TdLine = $2;
       }
-      if ($TdLine !~ m/class=\"(truncate)?from\">(<[^>]+>)?(.*?)<[^>]+>/si) {
-        die "Parse error for 'from'.";
+      my $From = "";
+      if ($Mode =~ /200809/) {
+        if ($TdLine !~ m/class=\"(truncate)?from\">(<[^>]+>)?(.*?)<[^>]+>/si) {
+          die "Parse error for 'from'.";
+        }
+        $From = HtmlUnescape($3);
+      } elsif ($Mode =~ /(200810|200902)/ ) {
+        if ($TdLine !~ m/(<[^>]+>)?(.*?)<[^>]+>/si) {
+          die "Parse error for 'from'.";
+        }
+        $From = HtmlUnescape($2);
       } 
-      my $From = HtmlUnescape($3);
       Display("From '$From'.\n",MinVerbosity => 10);
       $MessagesFrom[$NrMessagesDetected] = $From;
 
       # Further to the subject column. There we pick up also the href of the message.
-      $MessagesArea =~ m/<td(.*?)>(.*?)<\/td\s*>/i;
-      $MessagesArea = $';
-      $TdLine = $2;
+      if ($Mode =~ /200809/) {
+        $MessagesArea =~ m/<td(.*?)>(.*?)<\/td\s*>/i;
+        $MessagesArea = $';
+        $TdLine = $2;
+      } elsif ($Mode =~ /200810/) {
+        $MessagesArea =~ m/<td class=\"SubjectCol\">(.*?)<\/td\s*>/i;
+        $MessagesArea = $';
+        $TdLine = $1;
+      } elsif ($Mode =~ /200902/) {
+        $MessagesArea =~ m/<td class=\"Sbj\">(.*?)<\/td\s*>/i;
+        $MessagesArea = $';
+        $TdLine = $1;
+      }
       if ($TdLine !~ m/<a href=\"(.*?)\"\s*>(.*?)<\/a>/si) {
         die "Parse error for 'subject'.";
       }
@@@@ -1091,11 +1169,19 @@@@ sub GetMessagesFromFolder($) {
       Display("Search for one more page.\n",MinVerbosity => 10);
       # Search for 'next page' href 
       my $NextPageAd = "";
-      if ($PageAsString =~ 
-          m/<li([^>]*)>\s*<a href=\"([^\"]+)\"[^>]*><img src=\"[^\"]*\" class=\"i_nextpage\".*?><\/a>/si) {
-        $NextPageAd = $1;
+      if ($Mode =~ m/200809/) {
+        if ($PageAsString =~ 
+            m/<li([^>]*)>\s*<a href=\"([^\"]+)\"[^>]*><img src=\"[^\"]*\" class=\"i_nextpage\".*?><\/a>/si) {
+          $NextPageAd = $1;
+        }
+        die "Could not find an expected next page href. Probably page structure changed." unless $NextPageAd;
+      } elsif ($Mode =~ m/(200810|200902)/) {
+        if ($PageAsString =~ 
+          m/<li([^>]*)>\s*<a href=\"([^\"]+)\"[^>]*><img class=\"PageNavigationNext\".*?><\/a>/si) {
+          $NextPageAd = $1;
+        }
+        die "Could not find an expected next page href. Probably page structure changed." unless $NextPageAd;
       }
-      die "Could not find an expected next page href. Probably page structure changed." unless $NextPageAd;
      
       if ($NextPageAd !~ m /pnAm=\"([^\"]*)/) {
         die "Could not find pnAm in '$NextPageAd'.";
@@@@ -1111,7 +1197,7 @@@@ sub GetMessagesFromFolder($) {
       Display("Next page Ad : '$pnAd'.\n",MinVerbosity => 10);
       Display("Next page Am : '$pnAm'.\n",MinVerbosity => 10);
     }
-	}
+  }
 }
 
 ########################################################################################################################
@@@@ -1221,10 +1307,10 @@@@ sub GetFolders() {
   # Scan the line for all folders, their href and title.
   # NrFolders on the fly;
   while ($FolderPageAsString =~ 
-         m/<td class=\"d?ManageFoldersFolderNameCol\"><a\s*href=\"([^\"]*)\"\s*>(.*?)<\/a>\s*<\/td>\s*<td class=\"d?ManageFoldersTotalCountCol[^\"]*\">(\d+)<\/td>/gc) { 
-    $FolderHrefs[$NrFolders]      = $1;
-    $FolderNames[$NrFolders]      = HtmlUnescape($2);
-    $FolderNrMessages[$NrFolders] = $3;
+         m/<td class=\"d?ManageFoldersFolderNameCol\"><a\s*(class=\"PrimaryTextColor\"\s*)?href=\"([^\"]*)\"\s*>(.*?)<\/a>\s*<\/td>\s*(<td\s*class=\"ManageFoldersBufferCol\">[^<]*<\/td>\s*)?<td class=\"d?ManageFoldersTotalCountCol[^\"]*\">(\d+)<\/td>/gc) { 
+    $FolderHrefs[$NrFolders]      = $2;
+    $FolderNames[$NrFolders]      = HtmlUnescape($3);
+    $FolderNrMessages[$NrFolders] = $5;
     if ( $FolderHrefs[$NrFolders] !~ m/FolderID=([^&]*)/ ) {
        die "Could not detect FolderId.";
     }
@@@@ -1257,6 +1343,9 @@@@ GetFolders();
 
 for (my $FolderIdx=0;$FolderIdx<$NrFolders;$FolderIdx++) {
   next if (scalar keys %FoldersToProcess && not exists $FoldersToProcess{lc $FolderNames[$FolderIdx]});
+  next if ( ($SkipTrash =~ m/^Yes$/i) && ($FolderIds[$FolderIdx] eq $TrashFolderId) );
+  # JDLA hack. Drafts folder does not work, also not in real. Assuming 000-...-4 is the draft folder.
+  next if ( ($Mode =~ m/(200810|200902)/) && ($FolderIds[$FolderIdx] =~ m/^(0|-)*4$/));
   Display("\nProcessing folder $FolderNames[$FolderIdx].\n",MinVerbosity => 1);
   GetMessagesFromFolder($FolderIdx);
   Display("$NrMessagesDetected/$NrMessagesUnread Messages/Unread.\n",MinVerbosity => 1);
@


1.4
log
@Remove chunk from the patch that contained an RCS tag and broke the
build.

No bump needed because it didn't build before (thanks, naddy)

Pointed out by and ok naddy@@
@
text
@d1 5
a5 3
$OpenBSD: patch-GetLive_pl,v 1.3 2008/11/10 20:23:50 merdely Exp $
--- GetLive.pl.orig	Mon Nov 10 14:39:12 2008
+++ GetLive.pl	Mon Nov 10 14:41:25 2008
d62 2
a63 2
+  if ($Mode !~ m/^(200809|200810)$/i) {
+    Display("Mode must be oneof 200809 or 200810 as argument in the configuration file.\n",stderr=>1);
d78 32
a109 1
@@@@ -960,7 +973,7 @@@@ sub GetMessagesFromFolder($) {
d118 1
a118 1
@@@@ -971,7 +984,7 @@@@ sub GetMessagesFromFolder($) {
d127 1
a127 1
@@@@ -979,11 +992,37 @@@@ sub GetMessagesFromFolder($) {
d137 1
a137 1
+      } elsif ($Mode =~ m/200810/ && $Page == 1) {
d150 1
a150 1
+      } elsif ($Mode =~ m/200810/) {
d166 1
a166 1
@@@@ -1003,8 +1042,9 @@@@ sub GetMessagesFromFolder($) {
d177 1
a177 1
@@@@ -1016,9 +1056,12 @@@@ sub GetMessagesFromFolder($) {
d185 1
a185 1
+    if ($Mode =~ m/200810/ && $PageAsString !~ m/<table class=\"d?InboxTable[^>]*>(.*?)<\/table/si) {
d191 1
a191 1
@@@@ -1046,24 +1089,40 @@@@ sub GetMessagesFromFolder($) {
d200 1
a200 1
+      if ($Mode =~ m/200810/) { $Column = 4; }
d214 1
a214 1
+      } elsif ($Mode =~ /200810/ ) {
d236 4
d244 1
a244 1
@@@@ -1091,11 +1150,19 @@@@ sub GetMessagesFromFolder($) {
d257 1
a257 1
+      } elsif ($Mode =~ m/200810/) {
d268 1
a268 1
@@@@ -1111,7 +1178,7 @@@@ sub GetMessagesFromFolder($) {
d277 1
a277 1
@@@@ -1221,10 +1288,10 @@@@ sub GetFolders() {
d285 1
a285 1
+         m/<td class=\"d?ManageFoldersFolderNameCol\"><a\s*(class=\"PrimaryTextColor\"\s*)?href=\"([^\"]*)\"\s*>(.*?)<\/a>\s*<\/td>\s*<td class=\"d?ManageFoldersTotalCountCol[^\"]*\">(\d+)<\/td>/gc) { 
d288 1
a288 1
+    $FolderNrMessages[$NrFolders] = $4;
d292 1
a292 1
@@@@ -1257,6 +1324,9 @@@@ GetFolders();
d298 1
a298 1
+  next if ( ($Mode =~ m/200810/) && ($FolderIds[$FolderIdx] =~ m/^(0|-)*4$/));
@


1.3
log
@Update to handle changes in Hotmail's interface from upstream's CVS.
Users will have to log into Hotmail through a browser and check the
box so it never shows the 'changed' page again.  Then, add
'Mode=200810' to your config file.  You may also have to turn off
'reading panes'.

ok okan@@
@
text
@d1 1
a1 1
$OpenBSD: patch-GetLive_pl,v 1.2 2008/07/10 14:37:31 merdely Exp $
a264 19
@@@@ -1270,6 +1340,18 @@@@ exit(0);
 ########################################################################################################################
 # 
 # $Log: GetLive.pl,v $
+# Revision 1.46  2008/10/31 12:22:31  jdla
+# *) Bug 2208443 : Additional changes based on user feedback.
+#    Mainly 'Delete' was made operational and a bug in processing
+#    folders leading to no processing at all.
+#
+# Revision 1.45  2008/10/29 23:03:38  jdla
+# *) Bug 2208443 : Hotmail changes in 10/2008 solved.
+#
+# Revision 1.44  2008/08/31 20:36:08  jdla
+# *) Bug 2017097 : Messages retrieved multiple times
+#    (SkipTrash option)
+#
 # Revision 1.43  2008/07/05 19:55:41  jdla
 # Bug 1962937 : Could not correctly parse the messages table
 #    (after MS started changing things again around 1/7/2008)
@


1.2
log
@Update to 0.57.  This allows GetLive to work again.
Use ${SUBST_CMD}.

"go ahead" @@jasper
@
text
@d1 4
a4 4
$OpenBSD: patch-GetLive_pl,v 1.1.1.1 2007/10/10 15:17:49 merdely Exp $
--- GetLive.pl.orig	Sat Sep  8 14:23:33 2007
+++ GetLive.pl	Wed Oct 10 07:59:06 2007
@@@@ -53,7 +53,7 @@@@ my $Password                = "";
d13 271
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
$OpenBSD$
d9 1
a9 1
+my $MailProcessor           = '!!LOCALBASE!!/bin/procmail';	# Any program taking mbox formatted at stdin will do.
@


1.1.1.1
log
@GetLive is a perl script that fetches mail from your Hotmail
Live account. The mail is then presented to any filter (typically 
procmail) for further processing or dropping in a local mailbox.

This port replaces mail/gotmail (which doesn't work with Hotmail Live)

"commit it if it works" steven@@
@
text
@@
