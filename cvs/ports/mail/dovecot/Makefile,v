head	1.260;
access;
symbols
	OPENBSD_6_2:1.260.0.2
	OPENBSD_6_2_BASE:1.260
	OPENBSD_6_1:1.251.0.2
	OPENBSD_6_1_BASE:1.251
	OPENBSD_6_0:1.241.0.2
	OPENBSD_6_0_BASE:1.241
	OPENBSD_5_9:1.235.0.2
	OPENBSD_5_9_BASE:1.235
	OPENBSD_5_8:1.231.0.4
	OPENBSD_5_8_BASE:1.231
	OPENBSD_5_7:1.228.0.2
	OPENBSD_5_7_BASE:1.228
	OPENBSD_5_6:1.224.0.2
	OPENBSD_5_6_BASE:1.224
	OPENBSD_5_5:1.218.0.2
	OPENBSD_5_5_BASE:1.218
	OPENBSD_5_4:1.209.0.2
	OPENBSD_5_4_BASE:1.209
	OPENBSD_5_3:1.201.0.2
	OPENBSD_5_3_BASE:1.201
	OPENBSD_5_2:1.191.0.2
	OPENBSD_5_2_BASE:1.191
	OPENBSD_5_1_BASE:1.181
	OPENBSD_5_1:1.181.0.2
	OPENBSD_5_0:1.171.0.2
	OPENBSD_5_0_BASE:1.171
	OPENBSD_4_9:1.159.0.2
	OPENBSD_4_9_BASE:1.159
	OPENBSD_4_8:1.146.0.2
	OPENBSD_4_8_BASE:1.146
	OPENBSD_4_7:1.130.0.2
	OPENBSD_4_7_BASE:1.130
	OPENBSD_4_6:1.121.0.2
	OPENBSD_4_6_BASE:1.121
	OPENBSD_4_5:1.115.0.2
	OPENBSD_4_5_BASE:1.115
	OPENBSD_4_4:1.101.0.2
	OPENBSD_4_4_BASE:1.101
	OPENBSD_4_3:1.90.0.2
	OPENBSD_4_3_BASE:1.90
	OPENBSD_4_2:1.81.0.2
	OPENBSD_4_2_BASE:1.81
	OPENBSD_4_1:1.72.0.2
	OPENBSD_4_1_BASE:1.72
	OPENBSD_4_0:1.53.0.2
	OPENBSD_4_0_BASE:1.53
	OPENBSD_3_9:1.33.0.2
	OPENBSD_3_9_BASE:1.33
	OPENBSD_3_8:1.19.0.2
	OPENBSD_3_8_BASE:1.19
	OPENBSD_3_7:1.16.0.2
	OPENBSD_3_7_BASE:1.16
	OPENBSD_3_6:1.11.0.2
	OPENBSD_3_6_BASE:1.11
	OPENBSD_3_5:1.4.0.2
	OPENBSD_3_5_BASE:1.4
	OPENBSD_3_4:1.2.0.2
	OPENBSD_3_4_BASE:1.2
	jolan_2003-jul-14:1.1.1.1
	jolan:1.1.1;
locks; strict;
comment	@# @;


1.260
date	2017.09.22.22.53.08;	author sthen;	state Exp;
branches;
next	1.259;
commitid	a3yrWg8XKNJP2lto;

1.259
date	2017.08.28.21.39.14;	author sthen;	state Exp;
branches;
next	1.258;
commitid	6DUPLBXwJ4boSsl4;

1.258
date	2017.07.26.22.45.25;	author sthen;	state Exp;
branches;
next	1.257;
commitid	tD4MFrpYYDDL2UFT;

1.257
date	2017.07.16.19.18.59;	author espie;	state Exp;
branches;
next	1.256;
commitid	tt0GhWK5c4uf9ILG;

1.256
date	2017.07.11.23.04.43;	author sthen;	state Exp;
branches;
next	1.255;
commitid	CiVcKonNun5NsgqU;

1.255
date	2017.06.05.15.26.32;	author sthen;	state Exp;
branches;
next	1.254;
commitid	bpV9damqrvj64OVg;

1.254
date	2017.04.15.21.56.13;	author sthen;	state Exp;
branches;
next	1.253;
commitid	TqEul9Bhkrm5Wk4u;

1.253
date	2017.04.11.21.02.09;	author sthen;	state Exp;
branches;
next	1.252;
commitid	bA1cFrGXsjlP7Gah;

1.252
date	2017.04.10.11.46.22;	author sthen;	state Exp;
branches;
next	1.251;
commitid	BLsh88fJB8thZTwY;

1.251
date	2017.03.02.11.25.01;	author sthen;	state Exp;
branches;
next	1.250;
commitid	hAP1scSTnv36opDu;

1.250
date	2017.02.28.00.33.29;	author sthen;	state Exp;
branches;
next	1.249;
commitid	u8qHdEPmA2Ag0xlX;

1.249
date	2017.02.27.11.39.56;	author sthen;	state Exp;
branches;
next	1.248;
commitid	rydjeaNe7XAraPgZ;

1.248
date	2016.12.04.21.36.02;	author sthen;	state Exp;
branches;
next	1.247;
commitid	FqgfcBTXv4bKkBtc;

1.247
date	2016.11.12.15.37.32;	author sthen;	state Exp;
branches;
next	1.246;
commitid	uziEYXv1ntXIWtLm;

1.246
date	2016.11.02.17.41.24;	author sthen;	state Exp;
branches;
next	1.245;
commitid	RhVgF0K4OgT7t8Km;

1.245
date	2016.11.01.14.12.04;	author sthen;	state Exp;
branches;
next	1.244;
commitid	Q9HW3Y4VS9JCHAXP;

1.244
date	2016.09.23.09.16.56;	author sthen;	state Exp;
branches;
next	1.243;
commitid	XLnI6AbHAmyVU5mO;

1.243
date	2016.09.12.11.45.57;	author naddy;	state Exp;
branches;
next	1.242;
commitid	Cnalk1Ujct5ZDcli;

1.242
date	2016.09.11.20.54.12;	author ajacoutot;	state Exp;
branches;
next	1.241;
commitid	9aCynzSLedE7m3mA;

1.241
date	2016.07.05.09.27.35;	author sthen;	state Exp;
branches;
next	1.240;
commitid	hyDstNLkJ6wgrort;

1.240
date	2016.07.04.12.12.14;	author sthen;	state Exp;
branches;
next	1.239;
commitid	MhREHe6BbAhxQWMG;

1.239
date	2016.04.26.21.09.43;	author sthen;	state Exp;
branches;
next	1.238;
commitid	ldlYh46QSRBvAssq;

1.238
date	2016.03.31.11.12.38;	author sthen;	state Exp;
branches;
next	1.237;
commitid	q1Q1APJHRPWxrcS9;

1.237
date	2016.03.18.21.38.24;	author naddy;	state Exp;
branches;
next	1.236;
commitid	BVkebQSTXSZokeRG;

1.236
date	2016.03.17.14.11.45;	author sthen;	state Exp;
branches;
next	1.235;
commitid	48lSuIeOvrNZ4oic;

1.235
date	2016.01.11.22.45.26;	author sthen;	state Exp;
branches;
next	1.234;
commitid	OfafytTedYjObq8C;

1.234
date	2015.12.12.16.43.09;	author sthen;	state Exp;
branches;
next	1.233;
commitid	9rbf6790uDB3Rsiy;

1.233
date	2015.11.10.10.30.04;	author sthen;	state Exp;
branches;
next	1.232;
commitid	vMg2JbWbEMdJ4zJy;

1.232
date	2015.10.05.10.20.29;	author sthen;	state Exp;
branches;
next	1.231;
commitid	yPqL72rsxTVqJopq;

1.231
date	2015.06.15.08.50.26;	author sthen;	state Exp;
branches;
next	1.230;
commitid	cjojc3yi06CqY6A5;

1.230
date	2015.05.15.20.59.08;	author sthen;	state Exp;
branches;
next	1.229;
commitid	qjWN02AROR7LnnuK;

1.229
date	2015.04.09.21.25.49;	author sthen;	state Exp;
branches;
next	1.228;
commitid	mqU683H2tEcS5a7l;

1.228
date	2014.10.28.09.19.54;	author sthen;	state Exp;
branches;
next	1.227;
commitid	RzYN6iyKY6nDyE4Z;

1.227
date	2014.10.25.22.06.40;	author brad;	state Exp;
branches;
next	1.226;
commitid	Ox73PpZ25WWGsm0r;

1.226
date	2014.10.16.18.01.57;	author brad;	state Exp;
branches;
next	1.225;
commitid	wjSnXn5F22Oxtkah;

1.225
date	2014.09.13.18.09.21;	author brad;	state Exp;
branches;
next	1.224;
commitid	PpbRjVZdAmlrmi8q;

1.224
date	2014.07.30.14.28.24;	author naddy;	state Exp;
branches;
next	1.223;
commitid	rFSmDmXMPjLyf9TK;

1.223
date	2014.05.12.09.20.52;	author brad;	state Exp;
branches;
next	1.222;

1.222
date	2014.04.21.22.32.59;	author brad;	state Exp;
branches;
next	1.221;

1.221
date	2014.04.21.22.19.25;	author ajacoutot;	state Exp;
branches;
next	1.220;

1.220
date	2014.04.21.16.39.24;	author sthen;	state Exp;
branches;
next	1.219;

1.219
date	2014.03.16.09.42.12;	author brad;	state Exp;
branches;
next	1.218;

1.218
date	2013.12.22.22.23.10;	author brad;	state Exp;
branches
	1.218.2.1;
next	1.217;

1.217
date	2013.11.27.22.02.18;	author brad;	state Exp;
branches;
next	1.216;

1.216
date	2013.11.10.11.59.44;	author espie;	state Exp;
branches;
next	1.215;

1.215
date	2013.11.04.06.24.09;	author brad;	state Exp;
branches;
next	1.214;

1.214
date	2013.10.20.21.01.20;	author sthen;	state Exp;
branches;
next	1.213;

1.213
date	2013.09.27.01.35.51;	author brad;	state Exp;
branches;
next	1.212;

1.212
date	2013.09.22.17.57.59;	author brad;	state Exp;
branches;
next	1.211;

1.211
date	2013.09.02.16.02.00;	author brad;	state Exp;
branches;
next	1.210;

1.210
date	2013.08.13.00.29.58;	author brad;	state Exp;
branches;
next	1.209;

1.209
date	2013.07.18.20.07.10;	author brad;	state Exp;
branches
	1.209.2.1;
next	1.208;

1.208
date	2013.06.20.08.26.13;	author ajacoutot;	state Exp;
branches;
next	1.207;

1.207
date	2013.06.20.06.54.36;	author ajacoutot;	state Exp;
branches;
next	1.206;

1.206
date	2013.06.17.19.30.43;	author ajacoutot;	state Exp;
branches;
next	1.205;

1.205
date	2013.06.12.20.36.33;	author brad;	state Exp;
branches;
next	1.204;

1.204
date	2013.05.25.00.33.09;	author brad;	state Exp;
branches;
next	1.203;

1.203
date	2013.04.08.18.53.54;	author brad;	state Exp;
branches;
next	1.202;

1.202
date	2013.03.11.11.23.50;	author espie;	state Exp;
branches;
next	1.201;

1.201
date	2013.02.09.14.49.51;	author sthen;	state Exp;
branches;
next	1.200;

1.200
date	2013.02.08.16.33.23;	author brad;	state Exp;
branches;
next	1.199;

1.199
date	2013.02.01.07.59.03;	author brad;	state Exp;
branches;
next	1.198;

1.198
date	2013.01.27.09.29.37;	author ajacoutot;	state Exp;
branches;
next	1.197;

1.197
date	2013.01.08.23.58.43;	author brad;	state Exp;
branches;
next	1.196;

1.196
date	2012.12.01.09.45.33;	author brad;	state Exp;
branches;
next	1.195;

1.195
date	2012.11.29.22.17.46;	author brad;	state Exp;
branches;
next	1.194;

1.194
date	2012.11.25.00.50.50;	author halex;	state Exp;
branches;
next	1.193;

1.193
date	2012.09.25.20.05.46;	author brad;	state Exp;
branches;
next	1.192;

1.192
date	2012.08.05.09.15.51;	author sthen;	state Exp;
branches;
next	1.191;

1.191
date	2012.07.08.23.15.11;	author sthen;	state Exp;
branches
	1.191.2.1;
next	1.190;

1.190
date	2012.07.01.10.26.34;	author sthen;	state Exp;
branches;
next	1.189;

1.189
date	2012.06.08.23.55.17;	author sthen;	state Exp;
branches;
next	1.188;

1.188
date	2012.06.08.22.04.10;	author sthen;	state Exp;
branches;
next	1.187;

1.187
date	2012.05.17.07.48.15;	author sthen;	state Exp;
branches;
next	1.186;

1.186
date	2012.04.28.10.52.08;	author ajacoutot;	state Exp;
branches;
next	1.185;

1.185
date	2012.04.23.17.15.18;	author espie;	state Exp;
branches;
next	1.184;

1.184
date	2012.04.10.22.39.08;	author sthen;	state Exp;
branches;
next	1.183;

1.183
date	2012.03.23.17.51.18;	author sthen;	state Exp;
branches;
next	1.182;

1.182
date	2012.02.17.22.10.34;	author sthen;	state Exp;
branches;
next	1.181;

1.181
date	2012.01.28.21.35.02;	author sthen;	state Exp;
branches
	1.181.2.1;
next	1.180;

1.180
date	2012.01.16.23.59.22;	author sthen;	state Exp;
branches;
next	1.179;

1.179
date	2012.01.16.16.34.17;	author sthen;	state Exp;
branches;
next	1.178;

1.178
date	2012.01.07.12.14.21;	author sthen;	state Exp;
branches;
next	1.177;

1.177
date	2011.11.18.13.20.08;	author espie;	state Exp;
branches;
next	1.176;

1.176
date	2011.11.17.10.39.00;	author sthen;	state Exp;
branches;
next	1.175;

1.175
date	2011.11.11.23.21.48;	author sthen;	state Exp;
branches;
next	1.174;

1.174
date	2011.09.17.08.26.09;	author sthen;	state Exp;
branches;
next	1.173;

1.173
date	2011.09.16.10.31.21;	author espie;	state Exp;
branches;
next	1.172;

1.172
date	2011.09.01.10.53.50;	author sthen;	state Exp;
branches;
next	1.171;

1.171
date	2011.07.22.20.15.47;	author sthen;	state Exp;
branches;
next	1.170;

1.170
date	2011.06.18.22.41.27;	author sthen;	state Exp;
branches;
next	1.169;

1.169
date	2011.06.04.11.38.43;	author sthen;	state Exp;
branches;
next	1.168;

1.168
date	2011.05.28.19.40.41;	author sthen;	state Exp;
branches;
next	1.167;

1.167
date	2011.05.24.09.40.24;	author sthen;	state Exp;
branches;
next	1.166;

1.166
date	2011.05.23.23.29.52;	author sthen;	state Exp;
branches;
next	1.165;

1.165
date	2011.05.23.23.15.05;	author sthen;	state Exp;
branches;
next	1.164;

1.164
date	2011.05.23.22.54.38;	author sthen;	state Exp;
branches;
next	1.163;

1.163
date	2011.05.11.12.57.47;	author jasper;	state Exp;
branches;
next	1.162;

1.162
date	2011.03.26.10.05.24;	author sthen;	state Exp;
branches;
next	1.161;

1.161
date	2011.03.05.20.41.19;	author sthen;	state Exp;
branches;
next	1.160;

1.160
date	2011.03.03.00.40.04;	author sthen;	state Exp;
branches;
next	1.159;

1.159
date	2011.01.15.10.56.51;	author jasper;	state Exp;
branches
	1.159.2.1;
next	1.158;

1.158
date	2011.01.04.13.59.17;	author pea;	state Exp;
branches;
next	1.157;

1.157
date	2010.11.26.14.44.27;	author espie;	state Exp;
branches;
next	1.156;

1.156
date	2010.11.19.07.23.06;	author espie;	state Exp;
branches;
next	1.155;

1.155
date	2010.11.13.21.28.09;	author sthen;	state Exp;
branches;
next	1.154;

1.154
date	2010.11.09.14.35.46;	author sthen;	state Exp;
branches;
next	1.153;

1.153
date	2010.11.06.10.18.38;	author espie;	state Exp;
branches;
next	1.152;

1.152
date	2010.10.18.19.59.15;	author espie;	state Exp;
branches;
next	1.151;

1.151
date	2010.10.15.15.32.17;	author sthen;	state Exp;
branches;
next	1.150;

1.150
date	2010.10.03.23.25.52;	author sthen;	state Exp;
branches;
next	1.149;

1.149
date	2010.09.17.22.00.18;	author sthen;	state Exp;
branches;
next	1.148;

1.148
date	2010.09.17.13.11.14;	author sthen;	state Exp;
branches;
next	1.147;

1.147
date	2010.08.27.08.27.15;	author sthen;	state Exp;
branches;
next	1.146;

1.146
date	2010.08.08.22.21.55;	author sthen;	state Exp;
branches;
next	1.145;

1.145
date	2010.07.30.21.55.16;	author sthen;	state Exp;
branches;
next	1.144;

1.144
date	2010.07.30.20.22.24;	author sthen;	state Exp;
branches;
next	1.143;

1.143
date	2010.07.24.09.51.12;	author sthen;	state Exp;
branches;
next	1.142;

1.142
date	2010.07.20.23.49.18;	author sthen;	state Exp;
branches;
next	1.141;

1.141
date	2010.07.05.21.54.28;	author sthen;	state Exp;
branches;
next	1.140;

1.140
date	2010.06.27.09.46.18;	author sthen;	state Exp;
branches;
next	1.139;

1.139
date	2010.06.20.13.53.56;	author sthen;	state Exp;
branches;
next	1.138;

1.138
date	2010.05.02.22.42.44;	author sthen;	state Exp;
branches;
next	1.137;

1.137
date	2010.04.30.14.40.58;	author pea;	state Exp;
branches;
next	1.136;

1.136
date	2010.04.14.08.28.54;	author sthen;	state Exp;
branches;
next	1.135;

1.135
date	2010.04.03.00.21.14;	author sthen;	state Exp;
branches;
next	1.134;

1.134
date	2010.03.31.23.46.21;	author sthen;	state Exp;
branches;
next	1.133;

1.133
date	2010.03.31.19.37.30;	author sthen;	state Exp;
branches;
next	1.132;

1.132
date	2010.03.23.21.55.38;	author sthen;	state Exp;
branches;
next	1.131;

1.131
date	2010.03.23.21.32.07;	author pea;	state Exp;
branches;
next	1.130;

1.130
date	2010.02.28.17.58.53;	author sthen;	state Exp;
branches;
next	1.129;

1.129
date	2010.02.14.20.01.00;	author naddy;	state Exp;
branches;
next	1.128;

1.128
date	2009.11.10.23.20.22;	author sthen;	state Exp;
branches;
next	1.127;

1.127
date	2009.11.06.17.08.50;	author sthen;	state Exp;
branches;
next	1.126;

1.126
date	2009.10.30.11.43.48;	author sthen;	state Exp;
branches;
next	1.125;

1.125
date	2009.09.15.22.56.16;	author sthen;	state Exp;
branches;
next	1.124;

1.124
date	2009.09.01.17.28.50;	author jasper;	state Exp;
branches;
next	1.123;

1.123
date	2009.07.27.23.32.17;	author sthen;	state Exp;
branches;
next	1.122;

1.122
date	2009.07.17.07.28.18;	author sthen;	state Exp;
branches;
next	1.121;

1.121
date	2009.06.01.12.57.16;	author sthen;	state Exp;
branches
	1.121.2.1;
next	1.120;

1.120
date	2009.05.19.08.10.56;	author sthen;	state Exp;
branches;
next	1.119;

1.119
date	2009.05.04.11.40.40;	author sthen;	state Exp;
branches;
next	1.118;

1.118
date	2009.04.17.14.06.40;	author sthen;	state Exp;
branches;
next	1.117;

1.117
date	2009.03.18.23.23.20;	author sthen;	state Exp;
branches;
next	1.116;

1.116
date	2009.03.17.09.09.10;	author sthen;	state Exp;
branches;
next	1.115;

1.115
date	2009.02.14.10.27.58;	author sthen;	state Exp;
branches
	1.115.2.1;
next	1.114;

1.114
date	2009.02.08.14.54.21;	author sthen;	state Exp;
branches;
next	1.113;

1.113
date	2009.02.04.21.29.48;	author sthen;	state Exp;
branches;
next	1.112;

1.112
date	2009.01.27.08.33.12;	author sthen;	state Exp;
branches;
next	1.111;

1.111
date	2009.01.26.14.47.02;	author sthen;	state Exp;
branches;
next	1.110;

1.110
date	2009.01.08.12.07.03;	author sthen;	state Exp;
branches;
next	1.109;

1.109
date	2008.11.25.00.44.58;	author brad;	state Exp;
branches;
next	1.108;

1.108
date	2008.10.29.23.16.56;	author brad;	state Exp;
branches;
next	1.107;

1.107
date	2008.10.23.18.37.49;	author brad;	state Exp;
branches;
next	1.106;

1.106
date	2008.10.08.23.03.55;	author brad;	state Exp;
branches;
next	1.105;

1.105
date	2008.09.23.13.31.50;	author bernd;	state Exp;
branches;
next	1.104;

1.104
date	2008.09.04.08.35.43;	author brad;	state Exp;
branches;
next	1.103;

1.103
date	2008.08.23.20.13.39;	author brad;	state Exp;
branches;
next	1.102;

1.102
date	2008.08.20.02.07.04;	author brad;	state Exp;
branches;
next	1.101;

1.101
date	2008.07.21.09.33.18;	author brad;	state Exp;
branches;
next	1.100;

1.100
date	2008.07.02.23.00.10;	author brad;	state Exp;
branches;
next	1.99;

1.99
date	2008.06.22.18.36.46;	author brad;	state Exp;
branches;
next	1.98;

1.98
date	2008.06.19.22.27.33;	author brad;	state Exp;
branches;
next	1.97;

1.97
date	2008.06.03.00.16.51;	author sthen;	state Exp;
branches;
next	1.96;

1.96
date	2008.05.30.23.25.09;	author sthen;	state Exp;
branches;
next	1.95;

1.95
date	2008.05.28.23.08.03;	author sthen;	state Exp;
branches;
next	1.94;

1.94
date	2008.05.22.07.55.08;	author sthen;	state Exp;
branches;
next	1.93;

1.93
date	2008.05.16.05.45.26;	author bernd;	state Exp;
branches;
next	1.92;

1.92
date	2008.04.28.09.46.07;	author bernd;	state Exp;
branches;
next	1.91;

1.91
date	2008.03.16.18.46.14;	author brad;	state Exp;
branches;
next	1.90;

1.90
date	2007.12.31.10.31.11;	author jakob;	state Exp;
branches;
next	1.89;

1.89
date	2007.12.12.06.06.43;	author jakob;	state Exp;
branches;
next	1.88;

1.88
date	2007.11.30.09.52.39;	author jakob;	state Exp;
branches;
next	1.87;

1.87
date	2007.10.29.22.07.54;	author jakob;	state Exp;
branches;
next	1.86;

1.86
date	2007.10.29.07.27.28;	author jakob;	state Exp;
branches;
next	1.85;

1.85
date	2007.09.09.07.23.12;	author jakob;	state Exp;
branches;
next	1.84;

1.84
date	2007.09.08.08.44.39;	author jakob;	state Exp;
branches;
next	1.83;

1.83
date	2007.09.01.20.11.21;	author kili;	state Exp;
branches;
next	1.82;

1.82
date	2007.08.27.07.48.55;	author jakob;	state Exp;
branches;
next	1.81;

1.81
date	2007.07.16.07.09.59;	author jakob;	state Exp;
branches;
next	1.80;

1.80
date	2007.06.19.19.18.49;	author jakob;	state Exp;
branches;
next	1.79;

1.79
date	2007.04.18.05.43.51;	author jakob;	state Exp;
branches;
next	1.78;

1.78
date	2007.04.13.15.38.29;	author jakob;	state Exp;
branches;
next	1.77;

1.77
date	2007.04.12.20.13.58;	author jakob;	state Exp;
branches;
next	1.76;

1.76
date	2007.04.11.20.28.15;	author jakob;	state Exp;
branches;
next	1.75;

1.75
date	2007.03.24.07.29.01;	author jakob;	state Exp;
branches;
next	1.74;

1.74
date	2007.03.22.06.59.13;	author jakob;	state Exp;
branches;
next	1.73;

1.73
date	2007.03.15.23.20.54;	author jakob;	state Exp;
branches;
next	1.72;

1.72
date	2007.02.06.21.56.26;	author jakob;	state Exp;
branches
	1.72.2.1;
next	1.71;

1.71
date	2007.02.03.08.19.18;	author jakob;	state Exp;
branches;
next	1.70;

1.70
date	2007.01.25.07.48.39;	author jakob;	state Exp;
branches;
next	1.69;

1.69
date	2007.01.15.08.12.40;	author jakob;	state Exp;
branches;
next	1.68;

1.68
date	2006.12.07.21.49.01;	author steven;	state Exp;
branches;
next	1.67;

1.67
date	2006.12.02.10.34.30;	author jakob;	state Exp;
branches;
next	1.66;

1.66
date	2006.12.01.23.57.28;	author espie;	state Exp;
branches;
next	1.65;

1.65
date	2006.12.01.23.30.49;	author jakob;	state Exp;
branches;
next	1.64;

1.64
date	2006.11.19.00.40.23;	author brad;	state Exp;
branches;
next	1.63;

1.63
date	2006.11.12.20.57.03;	author brad;	state Exp;
branches;
next	1.62;

1.62
date	2006.11.11.13.31.07;	author mbalmer;	state Exp;
branches;
next	1.61;

1.61
date	2006.11.11.06.25.40;	author brad;	state Exp;
branches;
next	1.60;

1.60
date	2006.11.05.16.07.30;	author brad;	state Exp;
branches;
next	1.59;

1.59
date	2006.11.05.05.02.38;	author brad;	state Exp;
branches;
next	1.58;

1.58
date	2006.10.23.18.23.12;	author brad;	state Exp;
branches;
next	1.57;

1.57
date	2006.10.14.01.41.19;	author brad;	state Exp;
branches;
next	1.56;

1.56
date	2006.10.09.19.26.53;	author brad;	state Exp;
branches;
next	1.55;

1.55
date	2006.09.22.15.46.28;	author brad;	state Exp;
branches;
next	1.54;

1.54
date	2006.09.18.05.04.28;	author brad;	state Exp;
branches;
next	1.53;

1.53
date	2006.08.06.19.57.08;	author sturm;	state Exp;
branches
	1.53.2.1;
next	1.52;

1.52
date	2006.08.06.19.48.36;	author brad;	state Exp;
branches;
next	1.51;

1.51
date	2006.08.03.13.09.09;	author espie;	state Exp;
branches;
next	1.50;

1.50
date	2006.07.29.00.28.48;	author brad;	state Exp;
branches;
next	1.49;

1.49
date	2006.07.18.20.27.13;	author alek;	state Exp;
branches;
next	1.48;

1.48
date	2006.07.16.19.01.12;	author brad;	state Exp;
branches;
next	1.47;

1.47
date	2006.07.16.02.43.08;	author brad;	state Exp;
branches;
next	1.46;

1.46
date	2006.06.19.11.49.07;	author bernd;	state Exp;
branches;
next	1.45;

1.45
date	2006.06.18.09.35.36;	author brad;	state Exp;
branches;
next	1.44;

1.44
date	2006.06.16.21.03.44;	author brad;	state Exp;
branches;
next	1.43;

1.43
date	2006.05.18.01.59.21;	author brad;	state Exp;
branches;
next	1.42;

1.42
date	2006.05.12.19.10.11;	author brad;	state Exp;
branches;
next	1.41;

1.41
date	2006.05.10.19.51.03;	author brad;	state Exp;
branches;
next	1.40;

1.40
date	2006.05.10.00.30.04;	author brad;	state Exp;
branches;
next	1.39;

1.39
date	2006.04.16.06.59.29;	author brad;	state Exp;
branches;
next	1.38;

1.38
date	2006.04.15.02.47.21;	author brad;	state Exp;
branches;
next	1.37;

1.37
date	2006.04.12.16.32.11;	author brad;	state Exp;
branches;
next	1.36;

1.36
date	2006.04.05.00.23.27;	author brad;	state Exp;
branches;
next	1.35;

1.35
date	2006.04.02.18.45.01;	author brad;	state Exp;
branches;
next	1.34;

1.34
date	2006.03.23.05.24.24;	author brad;	state Exp;
branches;
next	1.33;

1.33
date	2006.02.11.04.10.08;	author brad;	state Exp;
branches
	1.33.2.1;
next	1.32;

1.32
date	2006.02.09.05.17.14;	author brad;	state Exp;
branches;
next	1.31;

1.31
date	2006.01.23.20.33.40;	author brad;	state Exp;
branches;
next	1.30;

1.30
date	2006.01.22.15.35.43;	author brad;	state Exp;
branches;
next	1.29;

1.29
date	2006.01.20.02.04.19;	author brad;	state Exp;
branches;
next	1.28;

1.28
date	2006.01.19.22.35.57;	author brad;	state Exp;
branches;
next	1.27;

1.27
date	2006.01.16.21.32.59;	author brad;	state Exp;
branches;
next	1.26;

1.26
date	2005.11.11.14.53.27;	author bernd;	state Exp;
branches;
next	1.25;

1.25
date	2005.11.11.12.11.41;	author bernd;	state Exp;
branches;
next	1.24;

1.24
date	2005.10.20.18.28.48;	author brad;	state Exp;
branches;
next	1.23;

1.23
date	2005.10.06.17.03.21;	author brad;	state Exp;
branches;
next	1.22;

1.22
date	2005.09.23.14.44.05;	author brad;	state Exp;
branches;
next	1.21;

1.21
date	2005.09.11.20.57.04;	author brad;	state Exp;
branches;
next	1.20;

1.20
date	2005.09.04.18.22.30;	author brad;	state Exp;
branches;
next	1.19;

1.19
date	2005.07.23.20.41.30;	author brad;	state Exp;
branches;
next	1.18;

1.18
date	2005.07.23.20.38.17;	author brad;	state Exp;
branches;
next	1.17;

1.17
date	2005.07.23.19.34.22;	author brad;	state Exp;
branches;
next	1.16;

1.16
date	2005.02.13.18.42.46;	author brad;	state Exp;
branches;
next	1.15;

1.15
date	2005.02.13.18.37.32;	author alek;	state Exp;
branches;
next	1.14;

1.14
date	2005.02.12.12.17.07;	author brad;	state Exp;
branches;
next	1.13;

1.13
date	2005.01.02.12.56.04;	author alek;	state Exp;
branches;
next	1.12;

1.12
date	2004.11.24.21.10.53;	author alek;	state Exp;
branches;
next	1.11;

1.11
date	2004.08.10.09.14.47;	author xsa;	state Exp;
branches;
next	1.10;

1.10
date	2004.07.30.17.40.27;	author brad;	state Exp;
branches;
next	1.9;

1.9
date	2004.07.21.14.19.19;	author brad;	state Exp;
branches;
next	1.8;

1.8
date	2004.06.25.18.04.13;	author brad;	state Exp;
branches;
next	1.7;

1.7
date	2004.06.22.21.05.20;	author brad;	state Exp;
branches;
next	1.6;

1.6
date	2004.05.27.16.38.30;	author brad;	state Exp;
branches;
next	1.5;

1.5
date	2004.05.10.00.06.47;	author brad;	state Exp;
branches;
next	1.4;

1.4
date	2003.11.05.03.42.06;	author jolan;	state Exp;
branches
	1.4.2.1;
next	1.3;

1.3
date	2003.09.23.06.34.32;	author jolan;	state Exp;
branches;
next	1.2;

1.2
date	2003.07.23.06.03.00;	author jolan;	state Exp;
branches
	1.2.2.1;
next	1.1;

1.1
date	2003.07.14.23.44.28;	author jolan;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2003.07.14.23.44.28;	author jolan;	state Exp;
branches;
next	;

1.2.2.1
date	2004.05.28.21.23.21;	author brad;	state Exp;
branches;
next	;

1.4.2.1
date	2004.05.28.20.46.46;	author brad;	state Exp;
branches;
next	;

1.33.2.1
date	2006.06.09.05.51.01;	author sturm;	state Exp;
branches;
next	1.33.2.2;

1.33.2.2
date	2006.12.05.05.52.12;	author sturm;	state Exp;
branches;
next	1.33.2.3;

1.33.2.3
date	2006.12.05.22.52.23;	author sturm;	state Exp;
branches;
next	1.33.2.4;

1.33.2.4
date	2007.05.01.11.22.12;	author sturm;	state Exp;
branches;
next	;

1.53.2.1
date	2006.12.05.22.23.02;	author sturm;	state Exp;
branches;
next	1.53.2.2;

1.53.2.2
date	2007.05.01.11.49.49;	author sturm;	state Exp;
branches;
next	1.53.2.3;

1.53.2.3
date	2007.07.26.20.16.33;	author ajacoutot;	state Exp;
branches;
next	;

1.72.2.1
date	2007.05.01.17.50.58;	author sturm;	state Exp;
branches;
next	1.72.2.2;

1.72.2.2
date	2007.07.26.20.19.18;	author ajacoutot;	state Exp;
branches;
next	;

1.115.2.1
date	2009.09.23.03.37.03;	author william;	state Exp;
branches;
next	;

1.121.2.1
date	2009.10.31.03.16.57;	author william;	state Exp;
branches;
next	1.121.2.2;

1.121.2.2
date	2009.11.21.04.35.30;	author william;	state Exp;
branches;
next	;

1.159.2.1
date	2011.05.27.12.52.19;	author pea;	state Exp;
branches;
next	1.159.2.2;

1.159.2.2
date	2011.05.30.21.38.56;	author sthen;	state Exp;
branches;
next	;

1.181.2.1
date	2012.05.12.10.16.42;	author sthen;	state Exp;
branches;
next	;

1.191.2.1
date	2012.12.08.10.39.01;	author jasper;	state Exp;
branches;
next	;

1.209.2.1
date	2014.05.12.09.58.36;	author brad;	state Exp;
branches;
next	;

1.218.2.1
date	2014.05.12.09.40.19;	author brad;	state Exp;
branches;
next	;


desc
@@


1.260
log
@Build Dovecot's fts-solr plugin (solr itself is not currently in packages;
I've tested this against manually-installed solr 6.6.1 running with jdk 1.8
on OpenBSD).

ok Brad (maintainer).
@
text
@# $OpenBSD: Makefile,v 1.259 2017/08/28 21:39:14 sthen Exp $

COMMENT-server=	compact IMAP/POP3 server
COMMENT-ldap=	LDAP authentication / dictionary support for Dovecot
COMMENT-mysql=	MySQL authentication / dictionary support for Dovecot
COMMENT-postgresql= PostgreSQL authentication / dictionary support for Dovecot

V_MAJOR=	2.2
V_DOVECOT=	2.2.32
REVISION-server= 0

DISTNAME=	dovecot-${V_DOVECOT}
PKGNAME=	dovecot-${V_DOVECOT}
PKGNAME-server=	dovecot-${V_DOVECOT}
PKGSPEC-server=	dovecot-=${V_DOVECOT}
PKGNAME-ldap=	dovecot-ldap-${V_DOVECOT}
PKGNAME-mysql=	dovecot-mysql-${V_DOVECOT}
PKGNAME-postgresql= dovecot-postgresql-${V_DOVECOT}
CATEGORIES=	mail
MASTER_SITES=	${HOMEPAGE}releases/${V_MAJOR}/

SHARED_LIBS=	dovecot-compression 0.0 \
		dovecot-dsync	0.0 \
		dovecot-fts	0.0 \
		dovecot-lda	2.0 \
		dovecot-ldap    0.0 \
		dovecot-login	2.0 \
		dovecot-sql	2.0 \
		dovecot-storage	2.0 \
		dovecot		2.0

HOMEPAGE=	https://dovecot.org/

MAINTAINER=	Brad Smith <brad@@comstyle.com>

# LGPLv2.1 and MIT
PERMIT_PACKAGE_CDROM=	Yes

WANTLIB-server=	bz2 c crypto expat iconv lz4 lzma m pthread sqlite3 ssl z
WANTLIB-ldap=	crypto lber-2.4 ldap-2.4 sasl2 ssl lib/dovecot/dovecot
WANTLIB-mysql=	crypto m lib/mysql/mysqlclient pthread ssl ${COMPILER_LIBCXX} z
WANTLIB-postgresql= crypto pq>=4 ssl

LIB_DEPENDS+=	archivers/bzip2 \
		archivers/lz4 \
		archivers/xz \
		converters/libiconv \
		databases/sqlite3
LIB_DEPENDS-ldap= ${BASE_PKGPATH} \
		databases/openldap
LIB_DEPENDS-mysql= databases/mariadb
RUN_DEPENDS-mysql= ${BASE_PKGPATH}
LIB_DEPENDS-postgresql= databases/postgresql
RUN_DEPENDS-postgresql= ${BASE_PKGPATH}

CONFIGURE_STYLE= gnu
CONFIGURE_ARGS=	--with-rundir=/var/dovecot \
		--with-sql=plugin \
		--with-sqlite \
		--with-statedir=/var/dovecot \
		--without-icu \
		--without-nss \
		--without-pam \
		--without-shadow \
		--with-solr \
		--without-stemmer \
		--without-textcat \
		--without-vpopmail
CONFIGURE_ENV=	CPPFLAGS="-I${LOCALBASE}/include" \
		LDFLAGS="-L${LOCALBASE}/lib"

PSEUDO_FLAVORS=	no_db no_ldap no_mysql no_postgresql
FLAVOR?=
.if ${FLAVOR:Mno_db}
FLAVOR+=	no_ldap no_mysql no_postgresql
.endif

MULTI_PACKAGES= -server -ldap -mysql -postgresql
SUBPACKAGE?=	-server

.include <bsd.port.arch.mk>

.if ${BUILD_PACKAGES:M-ldap}
CONFIGURE_ARGS+=--with-ldap=plugin
.endif

.if ${BUILD_PACKAGES:M-mysql}
CONFIGURE_ARGS+=--with-mysql
.endif

.if ${BUILD_PACKAGES:M-postgresql}
CONFIGURE_ARGS+=--with-pgsql
.endif

pre-build:
	@@${SUBST_CMD} ${WRKSRC}/doc/example-config/conf.d/10-mail.conf

post-install:
	${INSTALL_DATA} ${WRKSRC}/doc/dovecot-openssl.cnf \
		${PREFIX}/share/examples/dovecot
	${INSTALL_SCRIPT} ${WRKSRC}/doc/mkcert.sh \
		${PREFIX}/sbin/dovecot-mkcert.sh
	@@rm ${PREFIX}/share/doc/dovecot/{dovecot-openssl.cnf,mkcert.sh}
	@@find ${PREFIX}/lib/dovecot -name '*.a' -print | xargs rm
	@@find ${PREFIX}/lib/dovecot -name '*.la' -print | xargs rm

.include <bsd.port.mk>
@


1.259
log
@update to Dovecot 2.2.32, from Brad (and same diff here). (Amongst other
things, fixes a fairly annoying bug with replication not being able to
recover from index problems in some versions).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.258 2017/07/26 22:45:25 sthen Exp $
d10 1
d39 1
a39 1
WANTLIB-server=	bz2 c crypto iconv lz4 lzma pthread sqlite3 ssl z
d65 1
@


1.258
log
@bump LIBCXX/LIBECXX/COMPILER_LIBCXX ports.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.257 2017/07/16 19:18:59 espie Exp $
d9 1
a9 1
V_DOVECOT=	2.2.31
a19 4
REVISION-ldap=	0
REVISION-mysql=	0
REVISION-postgresql=0
REVISION-server=0
@


1.257
log
@use COMPILER_LIBCXX where applicable
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.256 2017/07/11 23:04:43 sthen Exp $
d20 4
@


1.256
log
@update to dovecot-2.2.31, from Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.255 2017/06/05 15:26:32 sthen Exp $
d40 1
a40 1
WANTLIB-mysql=	crypto m lib/mysql/mysqlclient pthread ssl ${LIBCXX} z
@


1.255
log
@update to dovecot-2.2.30.1, from Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.254 2017/04/15 21:56:13 sthen Exp $
d9 1
a9 1
V_DOVECOT=	2.2.30.1
@


1.254
log
@bugfix update to Dovecot 2.2.29.1, from Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.253 2017/04/11 21:02:09 sthen Exp $
d9 1
a9 1
V_DOVECOT=	2.2.29.1
@


1.253
log
@update to Dovecot 2.2.29, from Brad.

 * passdb/userdb dict: Don't double-expand %variables in keys. If dict
   was used as the authentication passdb, using specially crafted
   %variables in the username could be used to cause DoS (CVE-2017-2669)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.252 2017/04/10 11:46:22 sthen Exp $
d9 1
a9 1
V_DOVECOT=	2.2.29
@


1.252
log
@use LIBCXX
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.251 2017/03/02 11:25:01 sthen Exp $
d9 1
a9 2
V_DOVECOT=	2.2.28
REVISION-server=0
@


1.251
log
@backport fix for dovecot's trash plugin, "Panic: file mail-namespace.c:
line 709 (mail_namespace_find): assertion failed: (ns != NULL)". ok brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.250 2017/02/28 00:33:29 sthen Exp $
d41 1
a41 1
WANTLIB-mysql=	crypto m lib/mysql/mysqlclient pthread ssl stdc++ z
@


1.250
log
@update to Dovecot 2.2.28, ok Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.248 2016/12/04 21:36:02 sthen Exp $
d10 1
@


1.249
log
@Full package spec isn't needed in LIB_DEPENDS-xx/RUN_DEPENDS-xx for subpkgs
depending on the main package, because PKGSPEC is set. Mainly done to simplify
testing RCs. OK Brad (maintainer).
@
text
@d9 1
a9 1
V_DOVECOT=	2.2.27
@


1.248
log
@update to dovecot-2.2.27, and use https HOMEPAGE. From Brad.

CVE-2016-8652 (the version in 6.0 isn't affected): "If auth-policy
component has been activated in Dovecot, then remote user can use
SASL authentication to crash auth component. Workaround is to disable
auth-policy component until fix is in place."
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.247 2016/11/12 15:37:32 sthen Exp $
d48 1
a48 1
LIB_DEPENDS-ldap= ${BASE_PKGPATH}=${V_DOVECOT} \
d51 1
a51 1
RUN_DEPENDS-mysql= ${BASE_PKGPATH}=${V_DOVECOT}
d53 1
a53 1
RUN_DEPENDS-postgresql= ${BASE_PKGPATH}=${V_DOVECOT}
@


1.247
log
@move include/dovecot/ldap-client.h to PLIST-ldap, reported by brad and dhill,
based on a diff from dhill
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.246 2016/11/02 17:41:24 sthen Exp $
d9 1
a9 4
V_DOVECOT=	2.2.26.0
REVISION=	0
REVISION-server= 1
REVISION-ldap=	1
d31 1
a31 1
HOMEPAGE=	http://www.dovecot.org/
@


1.246
log
@Patch Dovecot to handle openssl 1.1 api #ifdefs, e.g.

-+#elif OPENSSL_VERSION_NUMBER < 0x10100000L
++#elif OPENSSL_VERSION_NUMBER < 0x10100000L || defined(LIBRESSL_VERSION_NUMBER)

Looks good to jca.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.245 2016/11/01 14:12:04 sthen Exp $
d11 2
@


1.245
log
@update to Dovecot 2.2.26.0, ok brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.244 2016/09/23 09:16:56 sthen Exp $
d10 1
@


1.244
log
@Cope with moving sqlite3 back to ports.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.243 2016/09/12 11:45:57 naddy Exp $
d4 1
a4 1
COMMENT-ldap=	LDAP authentication support for Dovecot
d9 1
a9 2
V_DOVECOT=	2.2.24
REVISION=	2
d25 1
d39 1
a39 1
WANTLIB-ldap=	crypto lber-2.4 ldap-2.4 sasl2 ssl
d48 2
a49 2
LIB_DEPENDS-ldap= databases/openldap
RUN_DEPENDS-ldap= ${BASE_PKGPATH}=${V_DOVECOT}
@


1.243
log
@replace libiconv module
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.242 2016/09/11 20:54:12 ajacoutot Exp $
d10 1
a10 1
REVISION=	1
d46 2
a47 1
		converters/libiconv
@


1.242
log
@Second and last pass at pre-entively fixing ports that would break once
guenther's header pollution cleanup diff is in.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.241 2016/07/05 09:27:35 sthen Exp $
d38 1
a38 1
WANTLIB-server=	bz2 c crypto lz4 lzma pthread sqlite3 ssl z ${MODLIBICONV_WANTLIB}
a42 1
MODULES=	converters/libiconv
d45 2
a46 1
		archivers/xz
@


1.241
log
@oops, committed previous from wrong tree. noticed by nigel@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.240 2016/07/04 12:12:14 sthen Exp $
d10 1
a10 1
REVISION=	0
@


1.240
log
@drop -lpthread hack, no longer needed. ok brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.239 2016/04/26 21:09:43 sthen Exp $
d9 2
a10 1
V_DOVECOT=	2.2.25
@


1.239
log
@update to Dovecot 2.2.24, from Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.238 2016/03/31 11:12:38 sthen Exp $
d9 1
a9 1
V_DOVECOT=	2.2.24
@


1.238
log
@update to Dovecot 2.2.23, ok brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.237 2016/03/18 21:38:24 naddy Exp $
d9 1
a9 1
V_DOVECOT=	2.2.23
@


1.237
log
@remove SHARED_ONLY from simple ports that use the gettext or libiconv module
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.236 2016/03/17 14:11:45 sthen Exp $
d9 1
a9 1
V_DOVECOT=	2.2.22
@


1.236
log
@update to dovecot-2.2.22, from Brad
@
text
@d1 1
a1 3
# $OpenBSD: Makefile,v 1.235 2016/01/11 22:45:26 sthen Exp $

SHARED_ONLY=	Yes
@


1.235
log
@Add a patch to re-allow the CRYPT password scheme in Dovecot. This scheme
checks the password against the stored hash using the OS crypt() function
and supports whichever schemes are supported by the OS, but currently
Dovecot makes some assumptions about hash format (to work around a
segfault when used on OpenBSD following removal of DES from crypt).

'doveadm pw -s CRYPT' (tool to generate hashed passwords) will now produce
bcrypt passwords rather than not allowing the scheme at all. More info in
the patch itself.  OK Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.234 2015/12/12 16:43:09 sthen Exp $
d11 1
a11 2
V_DOVECOT=	2.2.21
REVISION-server=0
d25 1
@


1.234
log
@update to Dovecot 2.2.21, from Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.233 2015/11/10 10:30:04 sthen Exp $
d12 1
@


1.233
log
@Fix "doveadm pw" crashing when using the crypt scheme since OpenBSD's
crypt() doesn't support DES now. From Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.232 2015/10/05 10:20:29 sthen Exp $
d11 1
a11 1
V_DOVECOT=	2.2.19
a15 1
REVISION-server= 0
@


1.232
log
@update to Dovecot 2.2.19, from Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.231 2015/06/15 08:50:26 sthen Exp $
d16 1
@


1.231
log
@stop patching Dovecot's sample config files to enable client workarounds;
from Brad (maintainer).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.230 2015/05/15 20:59:08 sthen Exp $
d11 1
a11 1
V_DOVECOT=	2.2.18
a19 1
REVISION-server=	0
@


1.230
log
@update to dovecot 2.2.18, from brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.229 2015/04/09 21:25:49 sthen Exp $
d20 1
@


1.229
log
@Update to Dovecot 2.2.16, from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.228 2014/10/28 09:19:54 sthen Exp $
d11 1
a11 1
V_DOVECOT=	2.2.16
d59 2
d64 1
@


1.228
log
@link Dovecot's executables with -lpthread, allowing use of plugins which
use shared libraries that use threads (e.g. mysqlclient). ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.227 2014/10/25 22:06:40 brad Exp $
d11 1
a11 2
V_DOVECOT=	2.2.15
REVISION-server=0
@


1.227
log
@Update to Dovecot 2.2.15.

With some input from and ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.226 2014/10/16 18:01:57 brad Exp $
d12 1
d39 1
a39 1
WANTLIB-server=	bz2 c crypto lz4 lzma sqlite3 ssl z ${MODLIBICONV_WANTLIB}
@


1.226
log
@Update to Dovecot 2.2.14.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.225 2014/09/13 18:09:21 brad Exp $
a9 1
# Bump dovecot-pigeonhole every time you update to a new Dovecot version.
d11 1
a11 1
V_DOVECOT=	2.2.14
d16 1
d38 1
a38 1
WANTLIB-server=	bz2 c crypto lzma sqlite3 ssl z ${MODLIBICONV_WANTLIB}
d45 1
@


1.225
log
@Switch from using MySQL to using MariaDB attempt #2. MariaDB is a drop-in replacement.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.224 2014/07/30 14:28:24 naddy Exp $
d12 1
a12 1
V_DOVECOT=	2.2.10
a22 5
REVISION-server=	3
REVISION-ldap=		1
REVISION-mysql=		2
REVISION-postgresql=	1

d24 1
d40 1
a40 1
WANTLIB-mysql=	crypto m lib/mysql/mysqlclient ssl z
@


1.224
log
@fix build after SSL compression removal; from brad@@ et al.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.223 2014/05/12 09:20:52 brad Exp $
d25 1
a25 1
REVISION-mysql=		1
d44 1
a44 1
WANTLIB-mysql=	crypto m lib/mysql/mysqlclient>=10 ssl z
d52 1
a52 1
LIB_DEPENDS-mysql= databases/mysql
@


1.223
log
@Fix a DoS attack against imap/pop3-login processes. CVE-2014-3430

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.222 2014/04/21 22:32:59 brad Exp $
d23 1
a23 1
REVISION-server=	2
@


1.222
log
@Remove --without-gsspi, it is already disabled.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.221 2014/04/21 22:19:25 ajacoutot Exp $
d23 4
a26 1
REVISION= 1
@


1.221
log
@Drop --with-gssapi.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.220 2014/04/21 16:39:24 sthen Exp $
a58 1
		--without-gssapi \
@


1.220
log
@sync wantlib and disable gssapi
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.219 2014/03/16 09:42:12 brad Exp $
d55 1
a55 2
CONFIGURE_ARGS=	--with-gssapi \
		--with-rundir=/var/dovecot \
@


1.219
log
@Remove workaround that was added to workaround non POSIX compliant
getpwnam_r / getpwuid_r functions.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.218 2013/12/22 22:23:10 brad Exp $
d23 1
a23 1
REVISION-server= 0
d39 2
a40 4
WANTLIB-server=	asn1 bz2 c com_err crypto gssapi heimbase krb5 lzma roken \
		sqlite3 ssl wind z ${MODLIBICONV_WANTLIB}
WANTLIB-ldap=	asn1 com_err crypto gssapi heimbase krb5 lber-2.4 ldap-2.4 \
		roken sasl2 ssl wind
d42 1
a42 1
WANTLIB-postgresql= asn1 com_err crypto heimbase krb5 pq>=4 roken ssl wind
d60 1
@


1.218
log
@Update to Dovecot 2.2.10.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.217 2013/11/27 22:02:18 brad Exp $
d22 2
@


1.218.2.1
log
@Fix a DoS attack against imap/pop3-login processes. CVE-2014-3430

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.218 2013/12/22 22:23:10 brad Exp $
a21 2

REVISION-server= 0
@


1.217
log
@Update to Dovecot 2.2.9.

With input regarding xz and ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.216 2013/11/10 11:59:44 espie Exp $
d12 1
a12 1
V_DOVECOT=	2.2.9
@


1.216
log
@brad@@ snuck unneeded stuff back in thru sthen@@...
bsd.port.arch.mk *does* trim BUILD_PACKAGES for you!
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.215 2013/11/04 06:24:09 brad Exp $
d12 1
a12 1
V_DOVECOT=	2.2.7
d37 4
a40 4
WANTLIB-server=	asn1 bz2 c com_err crypto gssapi heimbase krb5 \
		roken sqlite3 ssl wind z ${MODLIBICONV_WANTLIB}
WANTLIB-ldap=	asn1 com_err crypto gssapi heimbase krb5 lber \
		ldap roken sasl2 ssl wind
d42 1
a42 1
WANTLIB-postgresql= pq>=4
d45 2
a46 1
LIB_DEPENDS+=	archivers/bzip2
@


1.215
log
@Update to Dovecot 2.2.7.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.214 2013/10/20 21:01:20 sthen Exp $
d72 1
a72 1
MULTI_PACKAGES= -server
a73 12

.if !${FLAVOR:Mno_ldap}
MULTI_PACKAGES+=-ldap
.endif

.if !${FLAVOR:Mno_mysql}
MULTI_PACKAGES+=-mysql
.endif

.if !${FLAVOR:Mno_postgresql}
MULTI_PACKAGES+=-postgresql
.endif
@


1.214
log
@Don't suggest that people "might" need to add the login.conf section for
Dovecot, it is definitely required as the default number of FDs is not enough.
ok matthieu@@ brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.213 2013/09/27 01:35:51 brad Exp $
d12 1
a12 1
V_DOVECOT=	2.2.6
a19 1
REVISION-server=0
@


1.213
log
@Update to Dovecot 2.2.6.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.212 2013/09/22 17:57:59 brad Exp $
d20 1
@


1.212
log
@Remove unnecessary patch that sets a value that is the default anyway.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.211 2013/09/02 16:02:00 brad Exp $
d12 1
a12 1
V_DOVECOT=	2.2.5
a21 2

REVISION-server=	1
@


1.211
log
@Revert http://hg.dovecot.org/dovecot-2.2/raw-rev/349d52c4ca51 which causes
local account auth to be broken.

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.210 2013/08/13 00:29:58 brad Exp $
d23 1
a23 1
REVISION-server=	0
@


1.210
log
@Update to Dovecot 2.2.5.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.209 2013/07/18 20:07:10 brad Exp $
d22 2
@


1.209
log
@Update to Dovecot 2.1.17.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.208 2013/06/20 08:26:13 ajacoutot Exp $
d11 2
a12 2
V_MAJOR=	2.1
V_DOVECOT=	2.1.17
a19 1
REVISION-postgresql=1
d23 6
a28 6
SHARED_LIBS=	dovecot-lda	1.0 \
		dovecot-login	1.0 \
		dovecot-sql	1.0 \
		dovecot-ssl	0.0 \
		dovecot-storage	1.0 \
		dovecot		1.0
a52 2
# Fails to find static library while linking as used for the Kerberos workaround
USE_LIBTOOL=	gnu
@


1.209.2.1
log
@Fix a DoS attack against imap/pop3-login processes. CVE-2014-3430

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.209 2013/07/18 20:07:10 brad Exp $
d20 1
a22 3

REVISION-server= 0
REVISION-postgresql=1
@


1.208
log
@No need for pthread.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.207 2013/06/20 06:54:36 ajacoutot Exp $
d12 1
a12 1
V_DOVECOT=	2.1.16
a16 1
REVISION-server=2
a17 1
REVISION-ldap=	2
a18 1
REVISION-mysql=	3
d38 4
a41 5
WANTLIB-server=	asn1 bz2 c crypto gssapi krb5 sqlite3 ssl z \
		com_err heimbase roken wind \
		${MODLIBICONV_WANTLIB}
WANTLIB-ldap=	asn1 com_err crypto gssapi krb5 lber ldap sasl2 ssl \
		com_err heimbase roken wind
@


1.207
log
@Unbreak after hx509 and ntlm removal from Kerberos.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.206 2013/06/17 19:30:43 ajacoutot Exp $
d17 1
a17 1
REVISION-server=1
d19 1
a19 1
REVISION-ldap=	1
d42 1
a42 1
		com_err heimbase pthread roken wind \
d45 1
a45 1
		com_err heimbase pthread roken wind
@


1.206
log
@Unbreak with new Heimdal; get rid of self-cooked krb5-config since we
have it in base now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.205 2013/06/12 20:36:33 brad Exp $
d17 1
a17 1
REVISION-server=0
d19 1
a19 1
REVISION-ldap=	0
d21 1
a21 1
REVISION-mysql=	2
d23 1
a23 1
REVISION-postgresql=0
d42 1
a42 1
		com_err heimbase heimntlm hx509 pthread roken wind \
d45 1
a45 1
		com_err heimbase heimntlm hx509 pthread roken wind
@


1.205
log
@Revert back to using MySQL 5.1 for the time being. MariaDB 5.5 introduces
a new libmysqlclient non-blocking API which utilizes co-routines. The X86
specific GCC ASM co-routine support hid the fact that there was an issue.
The only fallback code so far is POSIX user contexts which OpenBSD does not
support.

Input from and Ok sthen@@ jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.204 2013/05/25 00:33:09 brad Exp $
d17 1
d19 1
d21 1
a21 1
REVISION-mysql=	1
d23 1
d42 1
d44 2
a45 1
WANTLIB-ldap=	asn1 com_err crypto gssapi krb5 lber ldap sasl2 ssl
d47 1
a47 1
WANTLIB-postgresql= com_err crypto pq>=4 ssl
a106 3

post-extract:
	@@${INSTALL} -m 555 ${FILESDIR}/krb5-config ${WRKDIR}/bin
@


1.204
log
@Switch from using MySQL to using MariaDB. MariaDB is a drop-in replacement.


ok sthen aja
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.203 2013/04/08 18:53:54 brad Exp $
d19 1
a19 1
REVISION-mysql=	0
d48 1
a48 1
LIB_DEPENDS-mysql= databases/mariadb
@


1.203
log
@Update to Dovecot 2.1.16.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.202 2013/03/11 11:23:50 espie Exp $
d19 1
d48 1
a48 1
LIB_DEPENDS-mysql= databases/mysql
@


1.202
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.201 2013/02/09 14:49:51 sthen Exp $
d12 1
a12 1
V_DOVECOT=	2.1.15
@


1.201
log
@Don't use ${FLAVOR:L}, we only support lower-case flavours now.
OK ajacoutot@@ espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.200 2013/02/08 16:33:23 brad Exp $
a35 3
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
@


1.200
log
@Update to Dovecot 2.1.15.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.199 2013/02/01 07:59:03 brad Exp $
d79 1
a79 1
.if !${FLAVOR:L:Mno_ldap}
d83 1
a83 1
.if !${FLAVOR:L:Mno_mysql}
d87 1
a87 1
.if !${FLAVOR:L:Mno_postgresql}
@


1.199
log
@Update to Dovecot 2.1.14.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.198 2013/01/27 09:29:37 ajacoutot Exp $
d12 1
a12 1
V_DOVECOT=	2.1.14
@


1.198
log
@Start first_valid_uid at 1000 to match the low uid of regular Unix users
on OpenBSD.

ok sthen@@ brad@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.197 2013/01/08 23:58:43 brad Exp $
d12 1
a12 1
V_DOVECOT=	2.1.13
a21 1
REVISION-server=0
@


1.197
log
@Update to Dovecot 2.1.13.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.196 2012/12/01 09:45:33 brad Exp $
d22 1
@


1.196
log
@Update to Dovecot 2.1.12.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.195 2012/11/29 22:17:46 brad Exp $
d12 1
a12 1
V_DOVECOT=	2.1.12
@


1.195
log
@Update to Dovecot 2.1.11.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.194 2012/11/25 00:50:50 halex Exp $
d12 1
a12 1
V_DOVECOT=	2.1.11
@


1.194
log
@backport changeset 15393 from dovecot-2.2:
bsdauth: Use "auth-<service>" as the auth type.

assistance from and ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.193 2012/09/25 20:05:46 brad Exp $
d12 1
a12 3
V_DOVECOT=	2.1.10

REVISION-server= 0
@


1.193
log
@Update to Dovecot 2.1.10.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.192 2012/08/05 09:15:51 sthen Exp $
d13 2
@


1.192
log
@update to Dovecot 2.1.9, from Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.191 2012/07/08 23:15:11 sthen Exp $
d12 1
a12 1
V_DOVECOT=	2.1.9
@


1.191
log
@update to Dovecot 2.1.8 from Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.190 2012/07/01 10:26:34 sthen Exp $
d12 1
a12 1
V_DOVECOT=	2.1.8
d116 1
@


1.191.2.1
log
@Security fix for CVE-2012-5620
dovecot: DoS when handling a search for multiple keywords

ok brad@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.191 2012/07/08 23:15:11 sthen Exp $
a16 1
REVISION-server=0
@


1.190
log
@Suggest that users may need to increase login.conf limits for Dovecot.
From Brad, adjusted slightly to specifically mention full-text search
indexing which is likely to need a larger-than-default datasize.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.189 2012/06/08 23:55:17 sthen Exp $
d12 1
a12 1
V_DOVECOT=	2.1.7
a16 1
REVISION-server= 0
@


1.189
log
@Add a comment explaining why we're using GNU libtool. From Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.188 2012/06/08 22:04:10 sthen Exp $
d17 1
@


1.188
log
@Update to Dovecot 2.1.7, from Brad.

See the upgrade notes at http://wiki2.dovecot.org/Upgrading/2.1
- you will probably need to merge updates to 10-mail.conf.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.187 2012/05/17 07:48:15 sthen Exp $
d55 1
@


1.187
log
@Roll the SQLite support for Dovecot into the main package. From Brad,
I added a REVISION bump, and a @@conflict marker because this is moving from
a subpackage to a package rather than rolling a FLAVOR into another.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.186 2012/04/28 10:52:08 ajacoutot Exp $
a8 1
REVISION-server= 0
d11 2
a12 2
V_MAJOR=	2.0
V_DOVECOT=	2.0.20
d23 6
a28 5
SHARED_LIBS=	dovecot-lda	0.0 \
		dovecot-login	0.0 \
		dovecot-sql	0.0 \
		dovecot-storage	0.0 \
		dovecot		0.0
d42 1
a42 1
WANTLIB-ldap=	asn1 com_err crypto gssapi krb5 lber-2.4 ldap-2.4 sasl2 ssl
d55 1
a55 1
USE_LIBTOOL=	Yes
d64 1
@


1.186
log
@--localstatedir=/var is the default now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.185 2012/04/23 17:15:18 espie Exp $
d9 1
a9 2
COMMENT-sqlite=	SQLite authentication / dictionary support for Dovecot
REVISION-sqlite =	0
a20 1
PKGNAME-sqlite=	dovecot-sqlite-${V_DOVECOT}
d40 2
a41 1
WANTLIB-server=	asn1 bz2 c crypto gssapi krb5 ssl z ${MODLIBICONV_WANTLIB}
a44 1
WANTLIB-sqlite=	sqlite3 z
a53 1
RUN_DEPENDS-sqlite= ${BASE_PKGPATH}=${V_DOVECOT}
d60 1
d68 1
a68 1
PSEUDO_FLAVORS=	no_db no_ldap no_mysql no_postgresql no_sqlite
d71 1
a71 1
FLAVOR+=	no_ldap no_mysql no_postgresql no_sqlite
a88 4
.if !${FLAVOR:L:Mno_sqlite}
MULTI_PACKAGES+=-sqlite
.endif

a100 4
.endif

.if ${BUILD_PACKAGES:M-sqlite}
CONFIGURE_ARGS+=--with-sqlite
@


1.185
log
@first pass at handling sqlite3 move
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.184 2012/04/10 22:39:08 sthen Exp $
d60 1
a60 2
CONFIGURE_ARGS=	--localstatedir=/var \
		--with-gssapi \
@


1.184
log
@update to Dovecot 2.0.20, from Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.183 2012/03/23 17:51:18 sthen Exp $
d10 1
a55 1
LIB_DEPENDS-sqlite= databases/sqlite3
@


1.183
log
@update to Dovecot 2.0.19, from Brad

- IMAP: ENABLE CONDSTORE/QRESYNC + STATUS for a mailbox might not
  have seen latest external changes to it, like new mails.
- imap_id_* settings were ignored before login.
- doveadm altmove did too much work sometimes, retrying moves
  it had already done.
- mbox: Fixed accessing Dovecot v1.x mbox index files without errors.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.182 2012/02/17 22:10:34 sthen Exp $
d13 1
a13 1
V_DOVECOT=	2.0.19
@


1.182
log
@Update to Dovecot 2.0.18, from Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.181 2012/01/28 21:35:02 sthen Exp $
d13 1
a13 1
V_DOVECOT=	2.0.18
@


1.181
log
@libkrb5 exports base64_decode and base64_encode (which appear to only be
needed internally), these conflict with symbols in dovecot's internal shared
library, causing the wrong version of the functions to be used in some cases.

Since we are in userland ABI API lock we cannot clean libkrb5 at present
so make a nasty workaround by statically linking the affected binaries with
libdovecot so the correct symbols take priority.

Fixes crashes I hit in doveadm and potentially some auth mechanisms.

OK ajacoutot@@, Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.180 2012/01/16 23:59:22 sthen Exp $
d13 1
a13 1
V_DOVECOT=	2.0.17
a17 1
REVISION-server= 1
@


1.181.2.1
log
@MFC Dovecot update to 2.0.20, this includes various error handling fixes
for mdbox, some possible hangs with LMTP, problems accessing old Dovecot
1.x mbox index files and importing flags with 'doveadm import'.
Discussed with / reminded by Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.186 2012/04/28 10:52:08 ajacoutot Exp $
d13 1
a13 1
V_DOVECOT=	2.0.20
d18 1
@


1.180
log
@@@sample the remaining Dovecot config files into /etc/dovecot
(some of the already-installed files reference them in commented-out
include lines, so it's easier if they're present).  From Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.179 2012/01/16 16:34:17 sthen Exp $
d18 1
a18 1
REVISION-server= 0
@


1.179
log
@update to Dovecot 2.0.17, from Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.178 2012/01/07 12:14:21 sthen Exp $
d18 1
@


1.178
log
@- compile in the correct usernames (_dovecot/_dovenull) rather
than only changing them in sample config files. this means you can
migrate from 1.x by directly following the instructions on
http://wiki2.dovecot.org/Upgrading/2.0 without extra tweaks.
Brad (maintainer) OK.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.177 2011/11/18 13:20:08 espie Exp $
d13 1
a13 2
V_DOVECOT=	2.0.16
REVISION-server= 0
d40 6
a45 1
WANTLIB-server=	${MODLIBICONV_WANTLIB} asn1 bz2 c crypto gssapi krb5 ssl z
d49 8
a56 9

MULTI_PACKAGES=	-server -ldap -mysql -postgresql -sqlite
SUBPACKAGE?=	-server

PSEUDO_FLAVORS=	no_db no_ldap no_mysql no_postgresql no_sqlite
FLAVOR?=
.if ${FLAVOR:Mno_db}
FLAVOR += no_ldap no_mysql no_postgresql no_sqlite
.endif
d71 24
a97 3
LIB_DEPENDS-ldap= databases/openldap
RUN_DEPENDS-ldap= ${BASE_PKGPATH}=${V_DOVECOT}
WANTLIB-ldap=	asn1 com_err crypto gssapi krb5 lber-2.4 ldap-2.4 sasl2 ssl
a101 3
LIB_DEPENDS-mysql= databases/mysql
RUN_DEPENDS-mysql= ${BASE_PKGPATH}=${V_DOVECOT}
WANTLIB-mysql=	crypto m lib/mysql/mysqlclient>=10 ssl z
a105 3
LIB_DEPENDS-postgresql=	databases/postgresql
RUN_DEPENDS-postgresql= ${BASE_PKGPATH}=${V_DOVECOT}
WANTLIB-postgresql= com_err crypto pq>=4 ssl
a109 3
LIB_DEPENDS-sqlite= databases/sqlite3
RUN_DEPENDS-sqlite= ${BASE_PKGPATH}=${V_DOVECOT}
WANTLIB-sqlite=	sqlite3 z
@


1.177
log
@convert to new-style pseudo
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.176 2011/11/17 10:39:00 sthen Exp $
d14 1
@


1.176
log
@update to Dovecot 2.0.16, from Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.175 2011/11/11 23:21:48 sthen Exp $
d45 1
a45 1
MULTI_PACKAGES=	-server
d50 3
a66 2
PSEUDO_FLAVORS=	no_db no_ldap no_mysql no_postgresql no_sqlite
FLAVOR?=
d68 2
a69 3
.if !${FLAVOR:L:Mno_db} && !${FLAVOR:L:Mno_ldap}
MULTI_PACKAGES+= -ldap
CONFIGURE_ARGS+=--with-ldap=plugin
d73 2
a76 3
.if !${FLAVOR:L:Mno_db} &&!${FLAVOR:L:Mno_mysql}
MULTI_PACKAGES+= -mysql
CONFIGURE_ARGS+=--with-mysql
d80 2
a83 3
.if !${FLAVOR:L:Mno_db} && !${FLAVOR:L:Mno_postgresql}
MULTI_PACKAGES+= -postgresql
CONFIGURE_ARGS+=--with-pgsql
d87 2
a90 3
.if !${FLAVOR:L:Mno_db} && !${FLAVOR:L:Mno_sqlite}
MULTI_PACKAGES+= -sqlite
CONFIGURE_ARGS+=--with-sqlite
d94 2
@


1.175
log
@Comment-out the deliver(1) manpage. It's deprecated in dovecot (renamed to
dovecot-lda) and conficts with mail/avenger as spotted by Jasper. ok Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.174 2011/09/17 08:26:09 sthen Exp $
d13 1
a13 1
V_DOVECOT=	2.0.15
a17 1
REVISION-server=0
@


1.174
log
@update to Dovecot 2.0.15; fixes some crash and a problem in 2.0.14 where
index reading could have eaten a lot of memory in some situations.
ok Brad (maintainer).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.173 2011/09/16 10:31:21 espie Exp $
d18 1
@


1.173
log
@normalize pkgpath
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.172 2011/09/01 10:53:50 sthen Exp $
d13 1
a13 1
V_DOVECOT=	2.0.14
a21 4
REVISION-ldap =	0
REVISION-mysql =	0
REVISION-postgresql =	0
REVISION-sqlite =	0
@


1.172
log
@update to dovecot 2.0.14, various fixes and new features. From Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.171 2011/07/22 20:15:47 sthen Exp $
d22 4
@


1.171
log
@Fix rc script mode/group, and adjust an #ifdef in a patch to use a specific
OpenBSD version. From Brad (maintainer).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.170 2011/06/18 22:41:27 sthen Exp $
d13 1
a13 1
V_DOVECOT=	2.0.13
a17 1
REVISION-server= 5
@


1.170
log
@Add a krb5-config script to avoid patching the autoconf input files. From Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.169 2011/06/04 11:38:43 sthen Exp $
d18 1
a18 1
REVISION-server= 4
@


1.169
log
@use correct group ownership for @@sample'd /var/dovecot/login directory
ok Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.168 2011/05/28 19:40:41 sthen Exp $
d18 1
a18 1
REVISION-server= 3
d41 1
a41 1
WANTLIB-server=	${MODLIBICONV_WANTLIB} bz2 c crypto gssapi krb5 ssl z
d53 1
a53 2
AUTOCONF_VERSION= 2.67
CONFIGURE_STYLE= autoconf
d62 1
a62 1
CONFIGURE_ENV=	CPPFLAGS="-I/usr/include/kerberosV -I${LOCALBASE}/include" \
d99 3
@


1.168
log
@Switch Dovecot to using plugins for ldap/database support. From Brad,
with pkgpath/dependency marker tweaks from myself. Looks good to pea@@.

This means we are now using subpackages rather than flavours; if upgrading
from a flavoured version, you will need to add the relevant module yourself.
e.g.: dovecot-$VER-ldap will be upgraded to dovecot-$VER, you must
pkg_add dovecot-ldap.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.167 2011/05/24 09:40:24 sthen Exp $
d18 1
a18 1
REVISION-server= 2
@


1.167
log
@tweak CONFIGURE_ARGS, from Brad (it now accepts --without-foo which is
slightly clearer than --with-foo=no)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.166 2011/05/23 23:29:52 sthen Exp $
d5 5
a9 1
COMMENT= compact IMAP/POP3 server
d16 7
a22 1
REVISION=	1
d41 1
a41 1
WANTLIB=	${MODLIBICONV_WANTLIB} bz2 c crypto gssapi krb5 ssl z
d46 5
a50 1
CPPFLAGS=	-I/usr/include/kerberosV -I${LOCALBASE}/include
d58 1
d63 1
a63 1
CONFIGURE_ENV=	CPPFLAGS="${CPPFLAGS}" \
d66 1
a66 1
FLAVORS=	ldap mysql postgresql sqlite
d69 6
a74 4
.if ${FLAVOR:L:Mldap}
CONFIGURE_ARGS+=--with-ldap
LIB_DEPENDS+=	databases/openldap
WANTLIB+=	lber ldap sasl2 asn1 com_err
d77 2
a78 1
.if ${FLAVOR:L:Mmysql}
d80 3
a82 2
LIB_DEPENDS+=	databases/mysql
WANTLIB+=	m lib/mysql/mysqlclient>=10
d85 2
a86 1
.if ${FLAVOR:L:Mpostgresql}
d88 3
a90 2
LIB_DEPENDS+=	databases/postgresql
WANTLIB+=	pq>=4
d93 2
a94 1
.if ${FLAVOR:L:Msqlite}
d96 3
a98 2
LIB_DEPENDS+=	databases/sqlite3
WANTLIB+=	sqlite3
@


1.166
log
@bdb was in the DESCR too, pointed out by Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.165 2011/05/23 23:15:05 sthen Exp $
a42 3
		--with-pam=no \
		--with-shadow=no \
		--with-vpopmail=no \
d44 4
a47 1
		--with-statedir=/var/dovecot
@


1.165
log
@- tweak @@pkgpath markers

- use a shorter comment reminding to bump dovecot-pigeonhole for updates
(and place it next to the version variables)

- bdb support is no more, drop the flavour

ok Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.164 2011/05/23 22:54:38 sthen Exp $
d12 1
a12 1
REVISION=	0
@


1.164
log
@Update dovecot to 2.0.13, joint work between pea@@, Brad and myself, ok pea@@

This is a major update and configuration changes are required -
see http://wiki2.dovecot.org/Upgrading/2.0 for more
@
text
@d1 1
a1 8
# $OpenBSD: Makefile,v 1.163 2011/05/11 12:57:47 jasper Exp $

#
# Dont forget to bump the Sieve package when you
# update Dovecot !!
# When the Dovecot V_MAJOR will change, dont forget
# to report it in mail/dovecot-pigeonhole
#
d7 1
d12 1
d51 1
a51 1
FLAVORS=	bdb ldap mysql postgresql sqlite
a52 7

.if ${FLAVOR:L:Mbdb}
CONFIGURE_ARGS+=--with-db
LIB_DEPENDS+=	databases/db/v4
WANTLIB+=	db>=5
CPPFLAGS+=	-I${LOCALBASE}/include/db4
.endif
@


1.163
log
@Sanitize some @@unexec/@@extraunexec calls to rm: move them up in the
PLIST and delete everything under the @@sample'd directory instead of the
directory itself to prevent a warning from pkg_delete(1) trying to
remove a non existing directory and to help preventing left-over files
and directories.

ok aja@@
@
text
@d1 8
a8 1
# $OpenBSD: Makefile,v 1.162 2011/03/26 10:05:24 sthen Exp $
d12 1
a12 2
COMMENT-server= compact IMAP/POP3 server
COMMENT-sieve=	Sieve mail filtering for Dovecot
d14 2
a15 12
V_MAJOR=	1.2
V_DOVECOT=	1.2.16
V_SIEVE=	0.1.18
V_MANAGESIEVE=	0.11.12

PKGNAME=	dovecot-${V_DOVECOT}
PKGNAME-server=	dovecot-${V_DOVECOT}
REVISION-server=5
FULLPKGNAME-sieve= dovecot-sieve-${V_SIEVE}
REVISION-sieve=	0
EPOCH-sieve=	0
FULLPKGPATH-sieve= ${PKGPATH},-sieve
a19 6
MASTER_SITES0=	http://www.rename-it.nl/dovecot/${V_MAJOR}/

DISTFILES=	dovecot-${V_DOVECOT}.tar.gz \
		dovecot-${V_MAJOR}-sieve-${V_SIEVE}.tar.gz:0 \
		dovecot-${V_MAJOR}-managesieve-${V_MANAGESIEVE}.tar.gz:0 \
		${DIST_MANAGESIEVE}:0
d21 5
a25 1
DIST_MANAGESIEVE= dovecot-${V_DOVECOT}-managesieve-${V_MANAGESIEVE}.diff.gz
d31 1
a31 1
# MIT/LGPLv2.1
d36 1
a36 3

WANTLIB-server=		${MODLIBICONV_WANTLIB} bz2 c crypto gssapi krb5 ssl z
WANTLIB-sieve=		${MODLIBICONV_WANTLIB} c crypto ssl
d41 14
a54 2
MULTI_PACKAGES=	-server
SUBPACKAGE?=	-server
a55 1
PSEUDO_FLAVORS=	no_sieve
a58 32
CFLAGS+=	-I/usr/include/kerberosV -I${LOCALBASE}/include

USE_LIBTOOL=		Yes
AUTOCONF_VERSION=	2.65
CONFIGURE_STYLE=	autoconf
CONFIGURE_ARGS+=	--localstatedir=/var \
			--with-gssapi \
			--with-pam=no \
			--with-shadow=no \
			--with-vpopmail=no
CONFIGURE_ENV=		LDFLAGS="-L${LOCALBASE}/lib"

.if !${FLAVOR:L:Mno_sieve}
# XXX The produced dovecot-sieve package ends up linked to any
# other library (database/ldap) used in the build thus producing
# bad packages in bulk build. Temporarily work around this in a
# nasty way by knocking out the sieve subpackage if another
# flavor is used. This means you have to build without FLAVORS
# to get the -sieve subpackage.
.if ${FLAVOR} == ""
MULTI_PACKAGES+=	-sieve
.endif
SIEVE_DIR=		${WRKDIR}/dovecot-${V_MAJOR}-sieve-${V_SIEVE}
MANAGESIEVE_DIR=	${WRKDIR}/dovecot-${V_MAJOR}-managesieve-${V_MANAGESIEVE}
AUTOCONF_DIR+=		${WRKSRC} ${MANAGESIEVE_DIR}
RUN_DEPENDS-sieve=	${PKGPATH}
LIB_DEPENDS-sieve=	${MODLIBICONV_LIB_DEPENDS}
PATCH_LIST=		patch-* managesieve-patch-*
.else
PATCH_LIST=		patch-* nosieve-patch-*
.endif

d60 4
a63 4
CONFIGURE_ARGS+=	--with-db
LIB_DEPENDS+=		databases/db/v4
WANTLIB-server+=	db>=5
CFLAGS+=		-I${LOCALBASE}/include/db4
d67 3
a69 3
CONFIGURE_ARGS+=	--with-ldap
LIB_DEPENDS+=		databases/openldap
WANTLIB-server+=	lber ldap sasl2 asn1 com_err
d73 3
a75 3
CONFIGURE_ARGS+=	--with-mysql
LIB_DEPENDS+=		databases/mysql
WANTLIB-server+=	m lib/mysql/mysqlclient>=10
d79 3
a81 3
CONFIGURE_ARGS+=	--with-pgsql
LIB_DEPENDS+=		databases/postgresql
WANTLIB-server+=	pq>=4
d85 3
a87 19
CONFIGURE_ARGS+=	--with-sqlite
LIB_DEPENDS+=		databases/sqlite3
WANTLIB-server+=	sqlite3
.endif

.if !${FLAVOR:L:Mno_sieve}
pre-patch:
	@@cd ${WRKSRC} && \
	gunzip -c ${DISTDIR}/${DIST_MANAGESIEVE} | \
		patch -z.managesieve.orig -p1 2> /dev/null

post-configure:
	@@(cd ${WRKSRC}; ${MAKE_PROGRAM} dovecot-config)
	@@(cd ${SIEVE_DIR}; ${SETENV} ${CONFIGURE_ENV} \
		./configure --with-dovecot=${WRKSRC} \
		--mandir=${PREFIX}/man --docdir=${PREFIX}/share/doc/)
	@@(cd ${MANAGESIEVE_DIR}; ${SETENV} ${CONFIGURE_ENV} \
		./configure --with-dovecot=${WRKSRC} \
		--with-dovecot-sieve=${SIEVE_DIR})
d91 1
a91 7
	@@${SUBST_CMD} ${WRKSRC}/dovecot-example.conf

.if !${FLAVOR:L:Mno_sieve}
post-build:
	(cd ${SIEVE_DIR}; ${MAKE_PROGRAM} ${MAKE_FLAGS})
	(cd ${MANAGESIEVE_DIR}; ${MAKE_PROGRAM} ${MAKE_FLAGS})
.endif
a93 1
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/dovecot
a94 5
		${WRKSRC}/doc/dovecot-sql-example.conf \
		${WRKSRC}/doc/dovecot-ldap-example.conf \
		${WRKSRC}/doc/dovecot-db-example.conf \
		${WRKSRC}/dovecot-example.conf \
		${WRKSRC}/doc/dovecot-dict-sql-example.conf \
d98 2
a99 10
.if !${FLAVOR:L:Mno_sieve}
	cd ${SIEVE_DIR} &&  env -i ${MAKE_ENV} \
		PREFIX=${WRKINST}${PREFIX} ${DESTDIRNAME}=${WRKINST} \
		TRUEPREFIX=${PREFIX} \
		${MAKE_PROGRAM} ${ALL_FAKE_FLAGS} -f ${MAKE_FILE} ${FAKE_TARGET}
	cd ${MANAGESIEVE_DIR} && env -i ${MAKE_ENV} \
		PREFIX=${WRKINST}${PREFIX} ${DESTDIRNAME}=${WRKINST} \
		TRUEPREFIX=${PREFIX} \
		${MAKE_PROGRAM} ${ALL_FAKE_FLAGS} -f ${MAKE_FILE} ${FAKE_TARGET}
.endif
@


1.162
log
@Bump ports which should be using newer autoconf to 2.65;
config.h files checked.  From Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.161 2011/03/05 20:41:19 sthen Exp $
d15 1
a15 1
REVISION-server=4
@


1.161
log
@Drop the rc.local fragment from MESSAGE-server now we have an rc script.
Pointed out by Dorian Buettner, ok Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.160 2011/03/03 00:40:04 sthen Exp $
d59 1
a59 2
# Should be 2.65
AUTOCONF_VERSION=	2.64
@


1.160
log
@- add an rc script for Dovecot.

- adjust commented-out paths in sample config file so that sockets
used for certain optional features (e.g. the LDA) are placed in a
a directory which already exists.

ok+help from Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.159 2011/01/15 10:56:51 jasper Exp $
d15 1
a15 1
REVISION-server=3
@


1.159
log
@- remove USE_GROFF=Yes, manpages checked by brad.

from brad (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.158 2011/01/04 13:59:17 pea Exp $
d15 1
a15 1
REVISION-server=2
@


1.159.2.1
log
@Fix CVE-2011-1929

ok brad (maintainer), sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.159 2011/01/15 10:56:51 jasper Exp $
d15 1
a15 1
REVISION-server=3
@


1.159.2.2
log
@Update Dovecot in -stable to 1.2.17, rolling in previous backported patches
and fixing a few other bugs. From Brad, ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.159.2.1 2011/05/27 12:52:19 pea Exp $
d9 1
a9 1
V_DOVECOT=	1.2.17
d15 1
d17 1
a17 1
REVISION-sieve=	1
d31 1
a31 1
DIST_MANAGESIEVE= dovecot-1.2.16-managesieve-${V_MANAGESIEVE}.diff.gz
@


1.158
log
@Some fixes from upstream:

- imap: Fixed a memory leak in ESEARCH.
- imap/pop3-login: Don't crash if passdb returns proxy field without host.
- lib-index: Added a missing sanity check for expunge-guid record's uid.
  This fixes a non-self healing assert-crash.
- master: Delete also pipes from login_dir (left by v2.0).

From Brad (maintainer), ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.157 2010/11/26 14:44:27 espie Exp $
a58 1
USE_GROFF =	Yes
@


1.157
log
@default db-* for db/v4 is incorrect, set PKGSPEC=db->=4,<5, bump packages
with erroneous depends.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.156 2010/11/19 07:23:06 espie Exp $
d15 1
a15 1
REVISION-server=1
@


1.156
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.155 2010/11/13 21:28:09 sthen Exp $
d15 1
a15 1
REVISION-server=0
@


1.155
log
@update the managesieve plugin, from Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.154 2010/11/09 14:35:46 sthen Exp $
d47 1
a47 1
LIB_DEPENDS+=	::archivers/bzip2
d83 1
a83 1
RUN_DEPENDS-sieve=	::${PKGPATH}
d92 2
a93 2
LIB_DEPENDS+=		::databases/db/v4
WANTLIB-server+=	db.>=5
d99 1
a99 1
LIB_DEPENDS+=		::databases/openldap
d105 2
a106 2
LIB_DEPENDS+=		::databases/mysql
WANTLIB-server+=	m lib/mysql/mysqlclient.>=10
d111 2
a112 2
LIB_DEPENDS+=		::databases/postgresql
WANTLIB-server+=	pq.>=4
d117 1
a117 1
LIB_DEPENDS+=		::databases/sqlite3
@


1.154
log
@update Dovecot to 1.2.16, from Brad (maintainer).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.153 2010/11/06 10:18:38 espie Exp $
d15 1
d31 1
a31 1
DIST_MANAGESIEVE= dovecot-1.2.15-managesieve-${V_MANAGESIEVE}.diff.gz
@


1.153
log
@convert libiconv to new wantlib
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.152 2010/10/18 19:59:15 espie Exp $
d9 1
a9 1
V_DOVECOT=	1.2.15
a14 1
REVISION-server=0
d16 1
d30 1
a30 1
DIST_MANAGESIEVE= dovecot-${V_DOVECOT}-managesieve-${V_MANAGESIEVE}.diff.gz
@


1.152
log
@USE_GROFF=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.151 2010/10/15 15:32:17 sthen Exp $
d42 2
a43 2
WANTLIB-server=		bz2 c crypto gssapi krb5 ssl z
WANTLIB-sieve=		c crypto ssl
@


1.151
log
@update to newer sieve plugin, from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.150 2010/10/03 23:25:52 sthen Exp $
d58 1
@


1.150
log
@update to 1.2.15, from Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.149 2010/09/17 22:00:18 sthen Exp $
d10 2
a11 2
V_SIEVE=	0.1.17
V_MANAGESIEVE=	0.11.11
d15 1
a16 1
REVISION-sieve=	4
d30 1
a30 1
DIST_MANAGESIEVE= dovecot-1.2.14-managesieve-${V_MANAGESIEVE}.diff.gz
@


1.149
log
@Dovecot fixes from upstream via Brad.

- maildir: If uidlist isn't read, don't mark its UIDs as being known when
saving.
- maildir: Avoid unnecessary uidlist recreation during mail delivery.
- Removed "die after 3 EINTR write() failures to log".
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.148 2010/09/17 13:11:14 sthen Exp $
d9 1
a9 1
V_DOVECOT=	1.2.14
a14 1
REVISION-server=1
d16 1
a16 1
REVISION-sieve=	3
d30 1
a30 1
DIST_MANAGESIEVE= dovecot-${V_DOVECOT}-managesieve-${V_MANAGESIEVE}.diff.gz
@


1.148
log
@fixes from upstream via Brad;
- Fixed setgid() failure error message.
- imap: If selecting a mailbox fails, close the already selected mailbox.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.147 2010/08/27 08:27:15 sthen Exp $
d15 1
a15 1
REVISION-server=0
d17 1
a17 1
REVISION-sieve=	2
d31 1
a31 1
DIST_MANAGESIEVE= dovecot-1.2.13-managesieve-${V_MANAGESIEVE}.diff.gz
@


1.147
log
@update Dovecot to 1.2.14, from Brad.
several fixes and adds support for IDLE notifications with the
virtual storage plugin.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.146 2010/08/08 22:21:55 sthen Exp $
d15 1
@


1.146
log
@With the non-default-flavoured dovecot packages (ldap, etc), rather than
forcing the no_sieve flavour (and thus not using the managesieve patch),
instead just remove -sieve from the MULTI_PACKAGE list. Fixes managesieve
with various flavoured packages. Problem found and diff from Andrew Fresh
via Brad. ok (and dpb3 testing) naddy@@.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.145 2010/07/30 21:55:16 sthen Exp $
d9 1
a9 1
V_DOVECOT=	1.2.13
a14 1
REVISION-server= 0
d16 1
a16 1
REVISION-sieve=	1
d30 1
a30 1
DIST_MANAGESIEVE= dovecot-${V_DOVECOT}-managesieve-${V_MANAGESIEVE}.diff.gz
@


1.145
log
@switch to the 1.2.13 managesieve diff, now it's been updated. from Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.144 2010/07/30 20:22:24 sthen Exp $
a55 9
# XXX The produced dovecot-sieve package ends up linked to any
# other library (database/ldap) used in the build thus producing
# bad packages in bulk build. Temporarily work around this in a
# nasty way by knocking out the sieve subpackage if another
# flavor is used.
.if ! ${FLAVOR} == ""
FLAVOR+=	no_sieve
.endif

d70 7
d78 1
@


1.144
log
@- Add a bug fix from upstream via Brad:
mbox: Fields weren't being added to cache file during message saving.

- Knock out the sieve subpackage if building with another flavor.
The object code was ending up linked to db/ldap libraries and thus
producing bad packages in bulk builds. This is a nasty hack from me
to fix packages until we have time to fix the linking and has a
big fat XXX next to it. Ok Brad (maintainer).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.143 2010/07/24 09:51:12 sthen Exp $
d17 1
a17 1
REVISION-sieve=	0
d31 1
a31 1
DIST_MANAGESIEVE= dovecot-1.2.12-managesieve-${V_MANAGESIEVE}.diff.gz
@


1.143
log
@update to 1.2.13, from Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.142 2010/07/20 23:49:18 sthen Exp $
d15 1
d17 1
d55 9
@


1.142
log
@mbox: When generating envelope to From_-line, don't append a second
@@owndomain if username already has one.

from upstream via Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.141 2010/07/05 21:54:28 sthen Exp $
d9 1
a9 1
V_DOVECOT=	1.2.12
d15 2
a16 2
REVISION-server= 2
FULLPKGNAME-sieve= dovecot-sieve-${V_SIEVE}v0
d29 1
a29 1
DIST_MANAGESIEVE= dovecot-${V_DOVECOT}-managesieve-${V_MANAGESIEVE}.diff.gz
d41 1
a41 1
WANTLIB-server=		c crypto gssapi krb5 ssl z
d45 1
a45 1
LIB_DEPENDS+=	bz2::archivers/bzip2
d81 2
a82 1
LIB_DEPENDS+=		db.>=5::databases/db/v4
d88 2
a89 2
LIB_DEPENDS+=		lber,ldap::databases/openldap
WANTLIB-server+=	sasl2 asn1 com_err
d94 2
a95 2
LIB_DEPENDS+=		lib/mysql/mysqlclient.>=10::databases/mysql
WANTLIB-server+=	m
d100 2
a101 1
LIB_DEPENDS+=		pq.>=4::databases/postgresql
d106 2
a107 1
LIB_DEPENDS+=		sqlite3::databases/sqlite3
@


1.141
log
@Fix for mbox (Renaming mailbox under newly created dir didn't move
index directory). From upstream via Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.140 2010/06/27 09:46:18 sthen Exp $
d14 2
a15 1
PKGNAME-server=	dovecot-${V_DOVECOT}p1
@


1.140
log
@2 fixes from upstream via Brad

- lib-charset: Don't assert-crash when iconv() skips lots of invalid input.
- lib-storage: When getting decoded headers, don't fail when MIME encoded-words
expand to LFs.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.139 2010/06/20 13:53:56 sthen Exp $
d14 1
a14 1
PKGNAME-server=	dovecot-${V_DOVECOT}p0
@


1.139
log
@update to 0.2.12 from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.138 2010/05/02 22:42:44 sthen Exp $
d14 1
a14 1
PKGNAME-server=	dovecot-${V_DOVECOT}
@


1.138
log
@add a patch from upstream via Brad:
imap: If FETCH notices cached message size is wrong, mark cache corrupted
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.137 2010/04/30 14:40:58 pea Exp $
d9 2
a10 2
V_DOVECOT=	1.2.11
V_SIEVE=	0.1.16
d14 2
a15 2
PKGNAME-server=	dovecot-${V_DOVECOT}p4
FULLPKGNAME-sieve= dovecot-sieve-${V_SIEVE}p0v0
d108 1
a108 1
	cd ${WRKSRC} && \
d113 2
a114 2
	(cd ${WRKSRC}; ${MAKE_PROGRAM} dovecot-config)
	(cd ${SIEVE_DIR}; ${SETENV} ${CONFIGURE_ENV} \
d117 1
a117 1
	(cd ${MANAGESIEVE_DIR}; ${SETENV} ${CONFIGURE_ENV} \
@


1.137
log
@Update sieve to 0.1.16

ok brad (maintainer), sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.136 2010/04/14 08:28:54 sthen Exp $
d14 1
a14 1
PKGNAME-server=	dovecot-${V_DOVECOT}p3
@


1.136
log
@fix a crash in deliver, from upstream via Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.135 2010/04/03 00:21:14 sthen Exp $
d10 1
a10 1
V_SIEVE=	0.1.15
d116 1
a116 1
		--mandir=${PREFIX}/man)
@


1.135
log
@use newer autoconf, from Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.134 2010/03/31 23:46:21 sthen Exp $
d14 1
a14 1
PKGNAME-server=	dovecot-${V_DOVECOT}p2
@


1.134
log
@cherrypick another diff from upstream; from Brad:
pgsql: Don't leak memory if query returns multiple results.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.133 2010/03/31 19:37:30 sthen Exp $
d14 2
a15 2
PKGNAME-server=	dovecot-${V_DOVECOT}p1
FULLPKGNAME-sieve= dovecot-sieve-${V_SIEVE}v0
d57 1
a57 1
AUTOCONF_VERSION=	2.62
@


1.133
log
@add a bugfix patch from upstream; from Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.132 2010/03/23 21:55:38 sthen Exp $
d14 1
a14 1
PKGNAME-server=	dovecot-${V_DOVECOT}p0
@


1.132
log
@when adding the managesieve patches, use patch -z.managesieve.orig
so update-patches doesn't pick them all up. ok Brad. no bump needed.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.131 2010/03/23 21:32:07 pea Exp $
d14 1
a14 1
PKGNAME-server=	dovecot-${V_DOVECOT}
@


1.131
log
@MAJOR update to Dovecot 1.2.11
The old cmusieve is removed in favor of the new sieve implementation.
Be very careful when upgrading.
Small howto here: http://openbsd.raveland.org/ports/dovecot/UPGRADE_HOWTO

With tweaks from brad (maintainer) and sthen@@: thanks
Lot of tests from Robert (robert at openbsd.pap.st), thanks !


ok brad (maintainer), sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.130 2010/02/28 17:58:53 sthen Exp $
d109 2
a110 1
	gunzip -c ${DISTDIR}/${DIST_MANAGESIEVE} | patch -p1 2> /dev/null
@


1.130
log
@fix the path to /usr/sbin/sendmail. ok Brad (maintainer), pea@@, jasper@@
(ports is still not fully open)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.129 2010/02/14 20:01:00 naddy Exp $
d8 4
a11 3
V_MAJOR=	1.1
V_DOVECOT=	1.1.20
V_SIEVE=	1.1.7
d14 2
a15 2
PKGNAME-server=	dovecot-${V_DOVECOT}p0
FULLPKGNAME-sieve= dovecot-sieve-${V_SIEVE}p0
d21 1
a21 1
MASTER_SITES0=	${HOMEPAGE}releases/sieve/
d24 5
a28 1
		dovecot-sieve-${V_SIEVE}.tar.gz:0
d40 2
a41 2
WANTLIB-server=		c crypto gssapi krb5 rpcsvc ssl z
WANTLIB-sieve=		c
d56 1
a56 1
# Should be 2.63
d68 3
a70 2
SIEVE_DIR=		${WRKDIR}/dovecot-sieve-${V_SIEVE}
AUTOCONF_DIR+=		${WRKSRC} ${SIEVE_DIR}
d73 3
d107 4
d114 5
a118 1
		./configure --with-dovecot=${WRKSRC})
d127 1
d135 1
d137 1
d142 8
a149 5
	cd ${SIEVE_DIR}/src/libsieve && ${INSTALL_PROGRAM} {sievec,sieved} \
		${PREFIX}/libexec/dovecot
	${INSTALL_DATA} \
		${SIEVE_DIR}/src/.libs/lib90_cmusieve_plugin.{a,la,so} \
		${PREFIX}/lib/dovecot/lda
@


1.129
log
@make sure flavor-invariant packages really don't pick up any flavor
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.128 2009/11/10 23:20:22 sthen Exp $
d13 1
a13 1
PKGNAME-server=	dovecot-${V_DOVECOT}
@


1.128
log
@Update to 1.1.20, from Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.127 2009/11/06 17:08:50 sthen Exp $
d14 2
a15 1
FULLPKGNAME-sieve= dovecot-sieve-${V_SIEVE}
d65 1
a65 1
RUN_DEPENDS-sieve=	::${BUILD_PKGPATH}
@


1.127
log
@add two patches from upstream repo;

- maildir: Having a lot of keywords assert-crashed with "stack frame changed".
- master: When creating login processes, don't close any fds after dup2()s.

from Brad (maintainer).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.126 2009/10/30 11:43:48 sthen Exp $
d9 1
a9 1
V_DOVECOT=	1.1.19
d12 2
a13 2
PKGNAME=	dovecot-${V_DOVECOT}p1
PKGNAME-server=	dovecot-${V_DOVECOT}p1
d51 1
a51 1
AUTOCONF_VERSION=	2.61
@


1.126
log
@Add some patches from upstream. From Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.125 2009/09/15 22:56:16 sthen Exp $
d12 2
a13 2
PKGNAME=	dovecot-${V_DOVECOT}p0
PKGNAME-server=	dovecot-${V_DOVECOT}p0
@


1.125
log
@- SECURITY update of dovecot-sieve (based on the Cyrus sieve library)
- bugfix update of dovecot

From Brad (maintainer).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.124 2009/09/01 17:28:50 jasper Exp $
d12 2
a13 2
PKGNAME=	dovecot-${V_DOVECOT}
PKGNAME-server=	dovecot-${V_DOVECOT}
@


1.124
log
@- let GSSAPI work again.

from remco@@d-compu.dyndns.org.
ok brad (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.123 2009/07/27 23:32:17 sthen Exp $
d9 2
a10 2
V_DOVECOT=	1.1.18
V_SIEVE=	1.1.6
d13 2
a14 2
PKGNAME-server=	dovecot-${V_DOVECOT}p0
FULLPKGNAME-sieve= dovecot-sieve-${V_SIEVE}p9
d50 1
@


1.123
log
@bugfix update to 1.1.18; from Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.122 2009/07/17 07:28:18 sthen Exp $
d13 1
a13 1
PKGNAME-server=	dovecot-${V_DOVECOT}
@


1.122
log
@Bugfix update to 1.1.17; from Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.121 2009/06/01 12:57:16 sthen Exp $
d9 1
a9 1
V_DOVECOT=	1.1.17
d14 1
a14 1
FULLPKGNAME-sieve= dovecot-sieve-${V_SIEVE}p8
@


1.121
log
@1.1.16; bugfix update, from Brad. fixes a couple of crashes.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.120 2009/05/19 08:10:56 sthen Exp $
d9 1
a9 1
V_DOVECOT=	1.1.16
d14 1
a14 1
FULLPKGNAME-sieve= dovecot-sieve-${V_SIEVE}p7
@


1.121.2.1
log
@MFC:

- SECURITY update of dovecot-sieve (based on the Cyrus sieve library)
- bugfix update of dovecot

reminded by pea@@, agree sthen@@, ok Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.125 2009/09/15 22:56:16 sthen Exp $
d9 2
a10 2
V_DOVECOT=	1.1.19
V_SIEVE=	1.1.7
d14 1
a14 1
FULLPKGNAME-sieve= dovecot-sieve-${V_SIEVE}
a49 1
# Should be 2.63
@


1.121.2.2
log
@MFC:

stability/bugfix update to 1.1.20

ok Brad jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.121.2.1 2009/10/31 03:16:57 william Exp $
d9 1
a9 1
V_DOVECOT=	1.1.20
d51 1
a51 1
AUTOCONF_VERSION=	2.62
@


1.120
log
@maintenance update to 1.1.15, from Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.119 2009/05/04 11:40:40 sthen Exp $
d9 1
a9 1
V_DOVECOT=	1.1.15
d14 1
a14 1
FULLPKGNAME-sieve= dovecot-sieve-${V_SIEVE}p6
@


1.119
log
@use /dev/arandom; from Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.118 2009/04/17 14:06:40 sthen Exp $
d9 1
a9 1
V_DOVECOT=	1.1.14
d13 2
a14 2
PKGNAME-server=	dovecot-${V_DOVECOT}p0
FULLPKGNAME-sieve= dovecot-sieve-${V_SIEVE}p5
@


1.118
log
@maintenance update to 1.1.4, from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.117 2009/03/18 23:23:20 sthen Exp $
d13 1
a13 1
PKGNAME-server=	dovecot-${V_DOVECOT}
@


1.117
log
@maintenance update to 1.1.13, from Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.116 2009/03/17 09:09:10 sthen Exp $
d9 1
a9 1
V_DOVECOT=	1.1.13
d14 1
a14 1
FULLPKGNAME-sieve= dovecot-sieve-${V_SIEVE}p4
@


1.116
log
@maintenance update to Dovecot 1.1.12 plus a couple of post-release
patches from the upstream repo - from Brad (maintainer).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.115 2009/02/14 10:27:58 sthen Exp $
d9 1
a9 1
V_DOVECOT=	1.1.12
d14 1
a14 1
FULLPKGNAME-sieve= dovecot-sieve-${V_SIEVE}p3
@


1.115
log
@log the correct filename in an error message; from upstream repo via Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.114 2009/02/08 14:54:21 sthen Exp $
d9 1
a9 1
V_DOVECOT=	1.1.11
d13 2
a14 2
PKGNAME-server=	dovecot-${V_DOVECOT}p1
FULLPKGNAME-sieve= dovecot-sieve-${V_SIEVE}p2
@


1.115.2.1
log
@MFC:

- SECURITY update of dovecot-sieve (based on the Cyrus sieve library)
- bugfix update of dovecot

originally from brad@@, -stable diff partly from sthen@@, thanks!

ok brad@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.125 2009/09/15 22:56:16 sthen Exp $
d9 2
a10 2
V_DOVECOT=	1.1.19
V_SIEVE=	1.1.7
d13 2
a14 2
PKGNAME-server=	dovecot-${V_DOVECOT}
FULLPKGNAME-sieve= dovecot-sieve-${V_SIEVE}
a49 1
# Should be 2.63
@


1.114
log
@roll in fixes from upstream repo; from Brad.

- mail_index_lookup_first() didn't always find the result.
  This caused SELECT not to return UNSEEN number always.
- Maildir: Fix to earlier >26 keywords handling change.
- i_stream_read(): Added a few more asserts.
- istream-tee: Minor cleanups, assert and a potential fix.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.113 2009/02/04 21:29:48 sthen Exp $
d13 1
a13 1
PKGNAME-server=	dovecot-${V_DOVECOT}p0
@


1.113
log
@maintenance update to 1.1.11, from Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.112 2009/01/27 08:33:12 sthen Exp $
d13 1
a13 1
PKGNAME-server=	dovecot-${V_DOVECOT}
@


1.112
log
@Update to 1.1.10, from Brad - fixes some problems introduced by 1.1.9
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.111 2009/01/26 14:47:02 sthen Exp $
d9 1
a9 1
V_DOVECOT=	1.1.10
d14 1
a14 1
FULLPKGNAME-sieve= dovecot-sieve-${V_SIEVE}p1
@


1.111
log
@update to 1.1.9 and add a flavour add bdb dictionary support (allows
the expire plugin to work without a SQL database). From Brad (maintainer),
diff for bdb support from Michael Lechtermann.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.110 2009/01/08 12:07:03 sthen Exp $
d9 1
a9 1
V_DOVECOT=	1.1.9
d14 1
a14 1
FULLPKGNAME-sieve= dovecot-sieve-${V_SIEVE}p0
@


1.110
log
@bugfix updates to 1.1.8 (Dovecot) and 1.1.6 (dovecot-sieve), from
Brad (maintainer).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.109 2008/11/25 00:44:58 brad Exp $
d9 1
a9 1
V_DOVECOT=	1.1.8
d14 1
a14 1
FULLPKGNAME-sieve= dovecot-sieve-${V_SIEVE}
d28 1
a28 1
# MIT/LGPL
d44 1
a44 1
FLAVORS=	ldap mysql postgresql sqlite
d65 6
@


1.109
log
@Update to Dovecot 1.1.7; A bug fix release.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.108 2008/10/29 23:16:56 brad Exp $
d9 2
a10 2
V_DOVECOT=	1.1.7
V_SIEVE=	1.1.5
d14 1
a14 1
FULLPKGNAME-sieve= dovecot-sieve-${V_SIEVE}p4
@


1.108
log
@Update to Dovecot 1.1.6; an important bug fix update.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.107 2008/10/23 18:37:49 brad Exp $
d9 1
a9 1
V_DOVECOT=	1.1.6
d14 1
a14 1
FULLPKGNAME-sieve= dovecot-sieve-${V_SIEVE}p3
@


1.107
log
@Update to Dovecot 1.1.5.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.106 2008/10/08 23:03:55 brad Exp $
d9 1
a9 1
V_DOVECOT=	1.1.5
d14 1
a14 1
FULLPKGNAME-sieve= dovecot-sieve-${V_SIEVE}p2
@


1.106
log
@Update to Dovecot 1.1.4.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.105 2008/09/23 13:31:50 bernd Exp $
d9 1
a9 1
V_DOVECOT=	1.1.4
d14 1
a14 1
FULLPKGNAME-sieve= dovecot-sieve-${V_SIEVE}p1
@


1.105
log
@Missing PKGNAME-sieve bump after COMMENT-sieve change.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.104 2008/09/04 08:35:43 brad Exp $
d9 1
a9 1
V_DOVECOT=	1.1.3
d14 1
a14 1
FULLPKGNAME-sieve= dovecot-sieve-${V_SIEVE}p0
@


1.104
log
@Update to Dovecot 1.1.3.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.103 2008/08/23 20:13:39 brad Exp $
d14 1
a14 1
FULLPKGNAME-sieve= dovecot-sieve-${V_SIEVE}
@


1.103
log
@Add missing PREFIX marker to an example plugins path for LDA.

From Ingo Schwarze <schwarze at usta dot de>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.102 2008/08/20 02:07:04 brad Exp $
d6 1
a6 1
COMMENT-sieve=	sieve mail filtering for Dovecot
d9 1
a9 1
V_DOVECOT=	1.1.2
d12 2
a13 2
PKGNAME=	dovecot-${V_DOVECOT}p0
PKGNAME-server=	dovecot-${V_DOVECOT}p0
@


1.102
log
@Upgrade to Dovecot 1.1.2.

ok jakob@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.101 2008/07/21 09:33:18 brad Exp $
d12 2
a13 2
PKGNAME=	dovecot-${V_DOVECOT}
PKGNAME-server=	dovecot-${V_DOVECOT}
@


1.101
log
@Three fixes for Dovecot 1.0..

- Maildir: Group of the created shared directory wasn't set.
- Logging: Make sure we don't recurse infinitely when running out of memory.
- rfc822_parse_phrase(): Don't read outside data boundaries if input is empty.

From the Dovecot Mercurial repo.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.100 2008/07/02 23:00:10 brad Exp $
d8 3
a10 3
V_MAJOR=	1.0
V_DOVECOT=	1.0.15
V_SIEVE=	1.0.3
d13 2
a14 2
PKGNAME-server=	dovecot-${V_DOVECOT}p1
PKGNAME-sieve=	dovecot-sieve-${V_SIEVE}
d34 2
a35 2
WANTLIB-server=		c crypto gssapi krb5 ssl z
WANTLIB-sieve=
d38 1
d47 2
a52 3
			--with-ioloop=kqueue \
			--with-ssl=openssl \
			--with-ssldir=/etc/ssl \
d54 4
a57 5
			--without-pam \
			--without-shadow \
			--without-vpopmail
CONFIGURE_ENV=		CFLAGS="${CFLAGS} -I/usr/include/kerberosV -I${LOCALBASE}/include" \
			LDFLAGS="-L${LOCALBASE}/lib"
d97 1
a97 1
	@@perl -pi -e s#_PREFIX_#\${PREFIX}#g ${WRKSRC}/dovecot-example.conf
d114 2
d117 1
a117 1
		${SIEVE_DIR}/src/.libs/lib90_cmusieve_plugin.so \
@


1.100
log
@Maildir: If there are multiple :2,<flags> in filename, use the last one
both getting and setting the flags.

From the Dovecot Mercurial repo.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.99 2008/06/22 18:36:46 brad Exp $
d13 1
a13 1
PKGNAME-server=	dovecot-${V_DOVECOT}p0
@


1.99
log
@upgrade to Dovecot 1.0.15. bug fix update.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.98 2008/06/19 22:27:33 brad Exp $
d13 1
a13 1
PKGNAME-server=	dovecot-${V_DOVECOT}
@


1.98
log
@Two fixes for Dovecot 1.0..
- Recreate dovecot-uidlist if updating it would shrink the file more than 25%.
- imap_get_base_subject_cased(): Subject trailers weren't removed correctly.

From the Dovecot Mercurial repo.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.97 2008/06/03 00:16:51 sthen Exp $
d9 1
a9 1
V_DOVECOT=	1.0.14
d13 1
a13 1
PKGNAME-server=	dovecot-${V_DOVECOT}p0
@


1.97
log
@Maintenance update, recent patches are now rolled into the
distfile from upstream.  From Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.96 2008/05/30 23:25:09 sthen Exp $
d13 1
a13 1
PKGNAME-server=	dovecot-${V_DOVECOT}
@


1.96
log
@update dovecot-sieve to new version, from Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.95 2008/05/28 23:08:03 sthen Exp $
d9 1
a9 1
V_DOVECOT=	1.0.13
d13 1
a13 1
PKGNAME-server=	dovecot-${V_DOVECOT}p3
@


1.95
log
@Add fix from upstream repo, "mbox: If INBOX creation fails because
of EACCES, try with privileged group enabled."

http://hg.dovecot.org/dovecot-1.0/rev/932768a879c6
From Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.94 2008/05/22 07:55:08 sthen Exp $
d10 1
a10 1
V_SIEVE=	1.0.2
d14 1
a14 1
PKGNAME-sieve=	dovecot-sieve-${V_SIEVE}p8
@


1.94
log
@Add some bug-fix patches; at this point in the Dovecot release cycle
most work is on 1.1, so it makes sense to add them locally for now.

- If SSL function fails and there are no errors, return "Unknown error"
instead of "Success" as the reason.
- Fixed a memory leak in ACL plugin.
- Send the success reply in one write.
- If remote disconnects, log "Connection closed: reason" just like IMAP does.
- STORE: Ignore flag changes for read-only (especially EXAMINEd) mailboxes.
- random_fill(): If read(/dev/urandom) returned EINTR, it could have written
random data before the given buffer.
- BODY/BODYSTRUCTURE fetch: Don't crash if we already had message parts
parsed.

From Brad, tested on various arch production servers.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.93 2008/05/16 05:45:26 bernd Exp $
d13 1
a13 1
PKGNAME-server=	dovecot-${V_DOVECOT}p2
@


1.93
log
@"allow_nets didn't work correctly with big endian machines."

From upstream:
http://hg.dovecot.org/dovecot-1.0/rev/71c02fdf1b59

via brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.92 2008/04/28 09:46:07 bernd Exp $
d13 1
a13 1
PKGNAME-server=	dovecot-${V_DOVECOT}p1
@


1.92
log
@Enable kerberosV support.

ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.91 2008/03/16 18:46:14 brad Exp $
d13 1
a13 1
PKGNAME-server=	dovecot-${V_DOVECOT}p0
@


1.91
log
@upgrade to Dovecot 1.0.13. security and bug fix update.

looks good jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.90 2007/12/31 10:31:11 jakob Exp $
d13 1
a13 1
PKGNAME-server=	dovecot-${V_DOVECOT}
d34 1
a34 1
WANTLIB-server=		c crypto ssl z
d47 2
a48 1
CONFIGURE_STYLE=	gnu
d53 1
d57 1
a57 1
CONFIGURE_ENV=		CFLAGS="${CFLAGS} -I${LOCALBASE}/include" \
d63 1
a63 1
AUTOCONF_DIR+=		${SIEVE_DIR}
d71 1
a71 1
WANTLIB-server+=	sasl2 asn1 com_err gssapi krb5
@


1.90
log
@dovecot 1.0.10; from MAINTAINER
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.89 2007/12/12 06:06:43 jakob Exp $
d9 1
a9 1
V_DOVECOT=	1.0.10
d14 1
a14 1
PKGNAME-sieve=	dovecot-sieve-${V_SIEVE}p7
@


1.89
log
@dovecot 1.0.9; from MAINTAINER
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.88 2007/11/30 09:52:39 jakob Exp $
d9 1
a9 1
V_DOVECOT=	1.0.9
d14 1
a14 1
PKGNAME-sieve=	dovecot-sieve-${V_SIEVE}p6
@


1.88
log
@update to dovecot 1.0.8, from MAINTAINER
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.87 2007/10/29 22:07:54 jakob Exp $
d9 1
a9 1
V_DOVECOT=	1.0.8
d14 1
a14 1
PKGNAME-sieve=	dovecot-sieve-${V_SIEVE}p5
@


1.87
log
@Dovecot 1.0.7 (bugfix release); from MAINTAINER
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.86 2007/10/29 07:27:28 jakob Exp $
d9 1
a9 1
V_DOVECOT=	1.0.7
d14 1
a14 1
PKGNAME-sieve=	dovecot-sieve-${V_SIEVE}p4
@


1.86
log
@update to Dovecot 1.0.6 (bugfix release); from MAINTAINER
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.85 2007/09/09 07:23:12 jakob Exp $
d9 1
a9 1
V_DOVECOT=	1.0.6
d14 1
a14 1
PKGNAME-sieve=	dovecot-sieve-${V_SIEVE}p3
@


1.85
log
@update to v1.0.5 (bugfix release)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.84 2007/09/08 08:44:39 jakob Exp $
d9 1
a9 1
V_DOVECOT=	1.0.5
d14 1
a14 1
PKGNAME-sieve=	dovecot-sieve-${V_SIEVE}p2
@


1.84
log
@dovecot v1.0.4; from MAINTAINER
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.83 2007/09/01 20:11:21 kili Exp $
d9 1
a9 1
V_DOVECOT=	1.0.4
d14 1
a14 1
PKGNAME-sieve=	dovecot-sieve-${V_SIEVE}p1
@


1.83
log
@
Change Brads email address for now, so people can reach him instead of
getting bounces or 550s. Bump pkgnames. While here, remove quotes from
comments.

prompted by espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.82 2007/08/27 07:48:55 jakob Exp $
d9 1
a9 1
V_DOVECOT=	1.0.3
d12 3
a14 3
PKGNAME=	dovecot-${V_DOVECOT}p0
PKGNAME-server=	dovecot-${V_DOVECOT}p0
PKGNAME-sieve=	dovecot-sieve-${V_SIEVE}p0
d18 2
a19 1
MASTER_SITES=	${HOMEPAGE}releases/
d21 2
a22 2
DISTFILES=	${V_MAJOR}/dovecot-${V_DOVECOT}.tar.gz \
		sieve/dovecot-sieve-${V_SIEVE}.tar.gz
@


1.82
log
@dovecot 1.0.3; from maintainer
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.81 2007/07/16 07:09:59 jakob Exp $
d5 2
a6 2
COMMENT-server= "compact IMAP/POP3 server"
COMMENT-sieve=	"sieve mail filtering for Dovecot"
d12 3
a14 3
PKGNAME=	dovecot-${V_DOVECOT}
PKGNAME-server=	dovecot-${V_DOVECOT}
PKGNAME-sieve=	dovecot-sieve-${V_SIEVE}
d25 1
a25 1
MAINTAINER=	Brad Smith <brad@@openbsd.org>
@


1.81
log
@upgrade to v1.0.2, bugfix release; from brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.80 2007/06/19 19:18:49 jakob Exp $
d8 3
a10 2
V_DOVECOT=	1.0.2
V_SIEVE=	1.0.1
d14 1
a14 1
PKGNAME-sieve=	dovecot-sieve-${V_SIEVE}p2
d20 1
a20 1
DISTFILES=	dovecot-${V_DOVECOT}.tar.gz \
@


1.80
log
@update to Dovecot 1.0.1, a bug fix release. from brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.79 2007/04/18 05:43:51 jakob Exp $
d8 1
a8 1
V_DOVECOT=	1.0.1
d13 1
a13 1
PKGNAME-sieve=	dovecot-sieve-${V_SIEVE}p1
@


1.79
log
@update sieve plugin version
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.78 2007/04/13 15:38:29 jakob Exp $
d8 1
a8 2
V_DOVECOT=	1.0.0

d13 1
a13 1
PKGNAME-sieve=	dovecot-sieve-${V_SIEVE}
@


1.78
log
@Dovecot v1.0.0; from brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.77 2007/04/12 20:13:58 jakob Exp $
d10 1
a10 1
V_SIEVE=	1.0
d14 1
a14 1
PKGNAME-sieve=	dovecot-sieve-${V_SIEVE}p9
@


1.77
log
@another release candidate, mostly LDAP fixes; from brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.76 2007/04/11 20:28:15 jakob Exp $
d8 1
a8 1
V_DOVECOT=	1.0.rc32
d14 1
a14 1
PKGNAME-sieve=	dovecot-sieve-${V_SIEVE}p8
@


1.76
log
@dovecot 1.0rc31; from brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.75 2007/03/24 07:29:01 jakob Exp $
d8 1
a8 1
V_DOVECOT=	1.0.rc31
d14 1
a14 1
PKGNAME-sieve=	dovecot-sieve-${V_SIEVE}p7
@


1.75
log
@dovecot 1.0 rc 28; from brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.74 2007/03/22 06:59:13 jakob Exp $
d8 1
a8 1
V_DOVECOT=	1.0.rc28
d14 1
a14 1
PKGNAME-sieve=	dovecot-sieve-${V_SIEVE}p6
@


1.74
log
@add sqlite flavour; from brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.73 2007/03/15 23:20:54 jakob Exp $
d8 1
a8 1
V_DOVECOT=	1.0.rc27
d13 2
a14 2
PKGNAME-server=	dovecot-${V_DOVECOT}p0
PKGNAME-sieve=	dovecot-sieve-${V_SIEVE}p5
d105 2
a106 2
		${WRKSRC}/doc/dovecot-sql.conf \
		${WRKSRC}/doc/dovecot-ldap.conf \
@


1.73
log
@dovecot 1.0 rc 27; from brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.72 2007/02/06 21:56:26 jakob Exp $
d13 2
a14 2
PKGNAME-server=	dovecot-${V_DOVECOT}
PKGNAME-sieve=	dovecot-sieve-${V_SIEVE}p4
d42 1
a42 1
FLAVORS=	ldap mysql postgresql
d80 5
@


1.72
log
@version 1.0.rc22; from brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.71 2007/02/03 08:19:18 jakob Exp $
d8 2
a9 1
V_DOVECOT=	1.0.rc22
d14 1
a14 1
PKGNAME-sieve=	dovecot-sieve-${V_SIEVE}p3
@


1.72.2.1
log
@update to dovecot 1.0.0
many bug and some security fixes

from brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.72 2007/02/06 21:56:26 jakob Exp $
d8 1
a8 1
V_DOVECOT=	1.0.0
d13 1
a13 1
PKGNAME-sieve=	dovecot-sieve-${V_SIEVE}p4
d99 2
a100 2
		${WRKSRC}/doc/dovecot-sql-example.conf \
		${WRKSRC}/doc/dovecot-ldap-example.conf \
@


1.72.2.2
log
@MFC:
- upgrade dovecot-server to version 1.0.2 and dovecot-sieve to version 1.0.1 ;
fix several bugs

ok sturm@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.72.2.1 2007/05/01 17:50:58 sturm Exp $
d8 2
a9 2
V_DOVECOT=	1.0.2
V_SIEVE=	1.0.1
d13 1
a13 1
PKGNAME-sieve=	dovecot-sieve-${V_SIEVE}p2
@


1.71
log
@dovecot 1.0.rc21 (from brad@@)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.70 2007/01/25 07:48:39 jakob Exp $
d8 1
a8 1
V_DOVECOT=	1.0.rc21
d13 1
a13 1
PKGNAME-sieve=	dovecot-sieve-${V_SIEVE}p2
@


1.70
log
@update to 1.0.rc19; from maintainer (brad@@)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.69 2007/01/15 08:12:40 jakob Exp $
d8 1
a8 1
V_DOVECOT=	1.0.rc19
d13 1
a13 1
PKGNAME-sieve=	dovecot-sieve-${V_SIEVE}p1
@


1.69
log
@upgrade to dovecot 1.0.rc17; from brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.68 2006/12/07 21:49:01 steven Exp $
d8 1
a8 1
V_DOVECOT=	1.0.rc17
@


1.68
log
@- repair dependencies
- use BUILD_PKGPATH since this can be flavored
- add forgotten @@pkgpath annotation
- bump all PKGNAMEs
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.67 2006/12/02 10:34:30 jakob Exp $
d8 1
a8 1
V_DOVECOT=	1.0.rc15
d11 3
a13 3
PKGNAME=	dovecot-${V_DOVECOT}p0
PKGNAME-server=	dovecot-${V_DOVECOT}p0
PKGNAME-sieve=	dovecot-sieve-${V_SIEVE}p0
d45 1
a45 3
CONFIGURE_STYLE=	autoconf
AUTOCONF_VERSION=	2.59
AUTOCONF_DIR=	 	${WRKSRC} 
d108 1
a108 2
		${PREFIX}/lib/dovecot
	ln -s ../lib90_cmusieve_plugin.so ${PREFIX}/lib/dovecot/lda
@


1.67
log
@SHARED_ONLY; from brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.66 2006/12/01 23:57:28 espie Exp $
d11 3
a13 2
PKGNAME-server=	dovecot-${V_DOVECOT}
PKGNAME-sieve=	dovecot-sieve-${V_SIEVE}
d62 2
a63 1
RUN_DEPENDS-sieve+=	::mail/dovecot
d68 1
a68 1
LIB_DEPENDS-server+=	lber,ldap::databases/openldap
d74 1
a74 1
LIB_DEPENDS-server+=	lib/mysql/mysqlclient.>=10::databases/mysql
d80 1
a80 1
LIB_DEPENDS-server+=	pq.>=4::databases/postgresql
@


1.66
log
@default package
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.65 2006/12/01 23:30:49 jakob Exp $
@


1.65
log
@add package for the sieve mail filter plugin; ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.64 2006/11/19 00:40:23 brad Exp $
d35 1
a35 1
SUBPACKAGE?=
@


1.64
log
@upgrade to Dovecot 1.0rc15
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.63 2006/11/12 20:57:03 brad Exp $
d3 2
a4 1
COMMENT= 	"compact IMAP/POP3 server"
d6 7
a12 1
DISTNAME=	dovecot-1.0.rc15
d16 4
a19 1
HOMEPAGE=	http://dovecot.org/
d28 3
a30 1
WANTLIB=		c crypto ssl z
d34 5
a38 1
FLAVORS+=	ldap mysql postgresql
d41 21
d64 2
a65 2
LIB_DEPENDS+=		lber,ldap::databases/openldap
WANTLIB+=		sasl2 asn1 com_err gssapi krb5
d70 2
a71 2
LIB_DEPENDS+=		lib/mysql/mysqlclient.>=10::databases/mysql
WANTLIB+=		m
d76 1
a76 1
LIB_DEPENDS+=		pq.>=4::databases/postgresql
d79 6
a84 12
USE_LIBTOOL=	Yes
CONFIGURE_STYLE= autoconf
AUTOCONF_VERSION= 2.59
CONFIGURE_ARGS+=--localstatedir=/var \
		--with-ioloop=kqueue \
		--with-ssl=openssl \
		--with-ssldir=/etc/ssl \
		--without-pam \
		--without-shadow \
		--without-vpopmail
CONFIGURE_ENV=	CFLAGS="${CFLAGS} -I${LOCALBASE}/include" \
		LDFLAGS="-L${LOCALBASE}/lib"
d89 5
d103 6
@


1.63
log
@upgrade to Dovecot 1.0rc14
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62 2006/11/11 13:31:07 mbalmer Exp $
d5 1
a5 1
DISTNAME=	dovecot-1.0.rc14
@


1.62
log
@Fix WANTLIB after openldap changes.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.61 2006/11/11 06:25:40 brad Exp $
d5 1
a5 2
DISTNAME=	dovecot-1.0.rc13
PKGNAME=	${DISTNAME}p0
@


1.61
log
@upgrade to Dovecot 1.0rc13
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.60 2006/11/05 16:07:30 brad Exp $
d6 1
d29 1
a29 1
WANTLIB+=		sasl2
@


1.60
log
@upgrade to Dovecot 1.0rc12
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59 2006/11/05 05:02:38 brad Exp $
d5 1
a5 1
DISTNAME=	dovecot-1.0.rc12
@


1.59
log
@upgrade to Dovecot 1.0rc11
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2006/10/23 18:23:12 brad Exp $
d5 1
a5 1
DISTNAME=	dovecot-1.0.rc11
@


1.58
log
@upgrade to Dovecot 1.0rc10
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.57 2006/10/14 01:41:19 brad Exp $
d5 1
a5 1
DISTNAME=	dovecot-1.0.rc10
@


1.57
log
@upgrade to Dovecot 1.0rc9
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2006/10/09 19:26:53 brad Exp $
d5 1
a5 1
DISTNAME=	dovecot-1.0.rc9
@


1.56
log
@upgrade to Dovecot 1.0rc8
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55 2006/09/22 15:46:28 brad Exp $
d5 1
a5 1
DISTNAME=	dovecot-1.0.rc8
@


1.55
log
@fix a kqueue bug with the filesystem notification mechanism that could
potentially cause Dovecot to spin and chew up all of the available CPU
time.

From Dovecot CVS.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.54 2006/09/18 05:04:28 brad Exp $
d5 1
a5 2
DISTNAME=	dovecot-1.0.rc7
PKGNAME=	${DISTNAME}p1
@


1.54
log
@upgrade to Dovecot 1.0rc7

ok dlg@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2006/08/06 19:57:08 sturm Exp $
d6 1
@


1.53
log
@revert unapproved commit, the ports tree is locked
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 2006/08/03 13:09:09 espie Exp $
d5 1
a5 2
DISTNAME=	dovecot-1.0.rc2
PKGNAME=	${DISTNAME}p3
d46 1
@


1.53.2.1
log
@update to dovecot 1.0rc15

many bug fixes and at least one security fix
from brad
@
text
@d1 1
a1 3
# $OpenBSD: Makefile,v 1.53 2006/08/06 19:57:08 sturm Exp $

SHARED_ONLY=	Yes
d5 2
a6 1
DISTNAME=	dovecot-1.0.rc15
a46 1
		--with-ioloop=kqueue \
@


1.53.2.2
log
@update to dovecot 1.0.0
many bug and some security fixes

from brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53.2.1 2006/12/05 22:23:02 sturm Exp $
d7 1
a7 1
DISTNAME=	dovecot-1.0.0
d45 2
a46 1
CONFIGURE_STYLE= gnu
d63 2
a64 2
		${WRKSRC}/doc/dovecot-sql-example.conf \
		${WRKSRC}/doc/dovecot-ldap-example.conf \
@


1.53.2.3
log
@MFC:
- upgrade to version 1.0.2 ; fix several bugs

ok sturm@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53.2.2 2007/05/01 11:49:49 sturm Exp $
d7 1
a7 1
DISTNAME=	dovecot-1.0.2
@


1.52
log
@upgrade to Dovecot 1.0rc5

ok marco@@
@
text
@d5 2
a6 1
DISTNAME=	dovecot-1.0.rc5
@


1.51
log
@new lib specs
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2006/07/29 00:28:48 brad Exp $
d5 1
a5 2
DISTNAME=	dovecot-1.0.rc2
PKGNAME=	${DISTNAME}p3
@


1.50
log
@bump PKGNAME.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2006/07/18 20:27:13 alek Exp $
d34 1
a34 1
LIB_DEPENDS+=		lib/mysql/mysqlclient.10::databases/mysql
d40 1
a40 1
LIB_DEPENDS+=		pq.4::databases/postgresql
@


1.49
log
@Use /etc/ssl as SYSCONFDIR can be changed by end user.

go ahead brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2006/07/16 19:01:12 brad Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p2
@


1.48
log
@disable kqueue for the file system notification method. as has been noted
on the dovecot list, there is a bug in this code which causes processes to
stay around after a client has disconnected.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2006/07/16 02:43:08 brad Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p1
@


1.47
log
@upgrade to Dovecot 1.0rc2

"That works way better." ok marco@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2006/06/19 11:49:07 bernd Exp $
d6 1
a46 1
		--with-notify=kqueue \
@


1.46
log
@Back out change with no review.

ok espie@@, pvalchev@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2006/05/18 01:59:21 brad Exp $
d5 1
a5 2
DISTNAME=	dovecot-1.0.beta8
PKGNAME=	${DISTNAME}p1
@


1.45
log
@fix CONFIGURE_ARGS
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2006/06/16 21:03:44 brad Exp $
d5 1
a5 1
DISTNAME=	dovecot-1.0.beta9
@


1.44
log
@upgrade to Dovecot 1.0beta9
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2006/05/18 01:59:21 brad Exp $
d6 1
a46 1
#		--with-ioloop=kqueue \
@


1.43
log
@disable kqueue again.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2006/05/12 19:10:11 brad Exp $
d5 1
a5 2
DISTNAME=	dovecot-1.0.beta8
PKGNAME=	${DISTNAME}p1
@


1.42
log
@upgrade to Dovecot 1.0beta8
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2006/05/10 19:51:03 brad Exp $
d6 1
d47 1
a47 1
		--with-ioloop=kqueue \
@


1.41
log
@second revision of the kqueue diff that should resolve an issue with
Dovecot imap processes' spinning and taking up all the available CPU time.

From Vaclav Haisman on the Dovecot list.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2006/05/10 00:30:04 brad Exp $
d5 1
a5 2
DISTNAME=	dovecot-1.0.beta7
PKGNAME=	${DISTNAME}p4
@


1.40
log
@add a diff to fix the crashing issues exhibited when using kqueue() and
re-enable kqueue().

From Vaclav Haisman on the Dovecot list.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2006/04/16 06:59:29 brad Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p3
@


1.39
log
@comment out the library archive and libtool wrapper for the new plugin.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2006/04/15 02:47:21 brad Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p2
d47 2
a48 2
#		--with-ioloop=kqueue \
#		--with-notify=kqueue \
@


1.38
log
@disable kqueue for now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2006/04/12 16:32:11 brad Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p1
@


1.37
log
@upgrade to Dovecot 1.0beta7
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2006/04/05 00:23:27 brad Exp $
d6 1
d47 2
a48 2
		--with-ioloop=kqueue \
		--with-notify=kqueue \
@


1.36
log
@upgrade to Dovecot 1.0beta5
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2006/04/02 18:45:01 brad Exp $
d5 1
a5 1
DISTNAME=	dovecot-1.0.beta5
@


1.35
log
@upgrade to Dovecot 1.0beta4
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2006/03/23 05:24:24 brad Exp $
d5 1
a5 1
DISTNAME=	dovecot-1.0.beta4
@


1.34
log
@for some fairly rare unrecognized events print some additional info
when i_panic() is called to help with debugging.

From Vaclav Haisman on the Dovecot list.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2006/02/11 04:10:08 brad Exp $
d5 1
a5 2
DISTNAME=	dovecot-1.0.beta3
PKGNAME=	${DISTNAME}p1
@


1.33
log
@Dovecot has code that is MIT licensed as well.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2006/02/09 05:17:14 brad Exp $
d6 1
@


1.33.2.1
log
@update to dovecot 1.0.beta8

fixes a security hole with mboxes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2006/02/11 04:10:08 brad Exp $
d5 1
a5 1
DISTNAME=	dovecot-1.0.beta8
d46 1
a46 1
#		--with-ioloop=kqueue \
@


1.33.2.2
log
@SECURITY:
Fixed an off-by-one buffer overflow in cache file handling. The
code is executed only with mmap_disable=yes and only if index files
are used (ie. INDEX=MEMORY is safe).

noticed by bernd
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33.2.1 2006/06/09 05:51:01 sturm Exp $
a5 1
PKGNAME=	${DISTNAME}p0
@


1.33.2.3
log
@update to dovecot 1.0rc15

many bug fixes and at least one security fix
from brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33.2.2 2006/12/05 05:52:12 sturm Exp $
d5 2
a6 1
DISTNAME=	dovecot-1.0.rc15
d47 2
a48 1
		--with-ioloop=kqueue \
@


1.33.2.4
log
@update to dovecot 1.0.0
many bug and some security fixes

from brad
@
text
@d1 1
a1 3
# $OpenBSD: Makefile,v 1.33.2.3 2006/12/05 22:52:23 sturm Exp $

SHARED_ONLY=	Yes
d5 1
a5 1
DISTNAME=	dovecot-1.0.0
d43 2
a44 1
CONFIGURE_STYLE= gnu
d61 2
a62 2
		${WRKSRC}/doc/dovecot-sql-example.conf \
		${WRKSRC}/doc/dovecot-ldap-example.conf \
@


1.32
log
@upgrade to Dovecot 1.0beta3
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2006/01/23 20:33:40 brad Exp $
d13 1
a13 1
# LGPL
@


1.31
log
@upgrade to Dovecot 1.0beta2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2006/01/22 15:35:43 brad Exp $
d5 1
a5 1
DISTNAME=	dovecot-1.0.beta2
d18 1
a18 1
WANTLIB=		c crypto ssl
d34 1
a34 1
WANTLIB+=		m z
@


1.30
log
@patches for the kqueue code to fix a few issues.

From: <V dot Haisman at sh dot cvut dot cz>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2006/01/20 02:04:19 brad Exp $
d5 1
a5 2
DISTNAME=	dovecot-1.0.beta1
PKGNAME=	${DISTNAME}p3
@


1.29
log
@set pop3_uidl_format in the example config and enable various workarounds
for POP3/IMAP clients with issues such as OSX Mail/Outlook/Netscape/Thunderbird.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2006/01/19 22:35:57 brad Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p2
@


1.28
log
@fix a bug not allowing ssl_parameters_regenerate to be set on 64-bit archs.

From Dovecot CVS
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2006/01/16 21:32:59 brad Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p1
@


1.27
log
@upgrade to Dovecot 1.0beta1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2005/11/11 14:53:27 bernd Exp $
d6 1
@


1.26
log
@This is the real fix for the openldap problem. Sorry guys.

tested & ok alek@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2005/11/11 12:11:41 bernd Exp $
d5 1
a5 2
DISTNAME=	dovecot-1.0.alpha4
PKGNAME=	${DISTNAME}p1
d42 1
d46 2
@


1.25
log
@- Add sasl2 to LIB_DEPENDS in ldap FLAVOR. Caused by the last openldap update.
- Bump PKGNAME

"go ahead" espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2005/10/20 18:28:48 brad Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p0
d28 2
a29 2
LIB_DEPENDS+=		lber,ldap::databases/openldap \
			sasl2.2::security/cyrus-sasl2
@


1.24
log
@upgrade to Dovecot 1.0alpha4
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2005/10/06 17:03:21 brad Exp $
d6 1
d28 2
a29 1
LIB_DEPENDS+=		lber,ldap::databases/openldap
@


1.23
log
@add a LDAP FLAVOR.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2005/09/23 14:44:05 brad Exp $
d5 1
a5 2
DISTNAME=	dovecot-1.0.alpha3
PKGNAME=	${DISTNAME}p1
@


1.22
log
@upgrade to Dovecot 1.0alpha3
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2005/09/11 20:57:04 brad Exp $
d6 1
d23 1
a23 1
FLAVORS+=	mysql postgresql
d26 5
d60 1
@


1.21
log
@upgrade to Dovecot 1.0alpha2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2005/09/04 18:22:30 brad Exp $
d5 1
a5 1
DISTNAME=	dovecot-1.0.alpha2
@


1.20
log
@upgrade to Dovecot 1.0alpha1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2005/07/23 20:41:30 brad Exp $
d5 1
a5 1
DISTNAME=	dovecot-1.0.alpha1
@


1.19
log
@spaces to tab
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2005/07/23 20:38:17 brad Exp $
d5 1
a5 2
DISTNAME=	dovecot-0.99.14
PKGNAME=	${DISTNAME}p1
a28 1
CONF_FILE+=		dovecot-mysql.conf
a33 1
CONF_FILE+=		dovecot-pgsql.conf
d38 8
a45 4
CONFIGURE_ARGS+=--without-pam --without-shadow --without-vpopmail \
		--localstatedir=/var --with-ssldir=/etc/ssl --with-ssl=openssl
CONFIGURE_ENV=	LDFLAGS="-L${LOCALBASE}/lib" \
		CFLAGS="${CFLAGS} -I${LOCALBASE}/include"
d47 2
a48 2
post-configure:
	@@perl -pi -e 's|_PREFIX_|${PREFIX}|g' ${WRKSRC}/dovecot-example.conf
d53 2
a54 3
		${WRKSRC}/dovecot-example.conf ${PREFIX}/share/examples/dovecot
.if defined(CONF_FILE) && !empty(CONF_FILE)
	cd ${WRKSRC}/doc; ${INSTALL_DATA} ${CONF_FILE} \
a55 1
.endif
@


1.18
log
@add example config files.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2005/07/23 19:34:22 brad Exp $
d23 1
a23 1
FLAVORS+=      mysql postgresql
@


1.17
log
@add a postgresql FLAVOR.

Based on similar diffs from chris@@ and
Peter Galbavy <peter dot galbavy at knowtion dot net>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2005/02/13 18:42:46 brad Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p0
d30 1
d36 1
d53 4
@


1.16
log
@add a MySQL FLAVOR.

From: Johan Fredin <griffin at legonet dot org>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2005/02/13 18:37:32 alek Exp $
d23 1
a23 1
FLAVORS+=      mysql
d30 5
@


1.15
log
@- Fix libiconv detection
- Bump PKGNAME

ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2005/02/12 12:17:07 brad Exp $
d22 9
@


1.14
log
@upgrade to Dovecot 0.99.14
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2005/01/02 12:56:04 alek Exp $
d6 1
d27 2
@


1.13
log
@Add WANTLIB markers
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2004/11/24 21:10:53 alek Exp $
d5 1
a5 2
DISTNAME=	dovecot-0.99.10.8
PKGNAME=	${DISTNAME}p0
@


1.12
log
@- Move notice from INSTALL to MESSAGE
- Replace (DE)INSTALL with @@sample, @@new(group|user)
- Bump PKGNAME

ok naddy@@ brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2004/08/10 09:14:47 xsa Exp $
d19 1
@


1.11
log
@
new-style MODULES.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2004/07/30 17:40:27 brad Exp $
d6 1
@


1.10
log
@upgrade to Dovecot 0.99.10.8
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2004/07/21 14:19:19 brad Exp $
d19 1
a19 1
MODULES=	iconv
@


1.9
log
@upgrade to Dovecot 0.99.10.7
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2004/06/25 18:04:13 brad Exp $
d5 1
a5 1
DISTNAME=	dovecot-0.99.10.7
@


1.8
log
@add a patch to unbreak being able to use symlinks with Maildir, bug introduced
in 0.99.10.6.
--
From: Dovecot author via Kevin Cramer <kcramer at siscom dot net>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2004/06/22 21:05:20 brad Exp $
d5 1
a5 2
DISTNAME=	dovecot-0.99.10.6
PKGNAME=	${DISTNAME}p1
d7 1
a7 1
MASTER_SITES=	${HOMEPAGE}
@


1.7
log
@upgrade to Dovecot 0.99.10.6
- takeover as MAINTAINER
--
ok MAINTAINER
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2004/05/27 16:38:30 brad Exp $
d6 1
@


1.6
log
@upgrade to Dovecot 0.99.10.5
--
ok MAINTAINER
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2004/05/10 00:06:47 brad Exp $
d5 1
a5 1
DISTNAME=	dovecot-0.99.10.5
d11 1
a11 1
MAINTAINER=	Jolan Luff <jolan@@openbsd.org>
@


1.5
log
@upgrade to Dovecot 0.99.10.4
--
ok MAINTAINER
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2003/11/05 03:42:06 jolan Exp $
d4 2
a5 1
DISTNAME=	dovecot-0.99.10.4
d9 1
a9 1
HOMEPAGE=	http://dovecot.procontrol.fi/
d22 1
a22 1
AUTOCONF_VERSION= 2.58
@


1.4
log
@- initialize /var/dovecot/login via INSTALL to quell a warning about it
  not existing (and thus be created by dovecot itself)
- incorporate upstream patch which prevents some partial BODY[part]
  fetches from possibly returning data incorrectly
- bump PKGNAME
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2003/09/23 06:34:32 jolan Exp $
d4 1
a4 2
DISTNAME=	dovecot-0.99.10
PKGNAME=	${DISTNAME}p2
d20 2
a21 2
CONFIGURE_STYLE=autoconf
AUTOCONF_VERSION=2.13
@


1.4.2.1
log
@MFC:
upgrade to Dovecot 0.99.10.5

Dovecot 0.99.10.{4,5} fix some possible mail box corruption issues.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2004/05/27 16:38:30 brad Exp $
d4 2
a5 2

DISTNAME=	dovecot-0.99.10.5
d9 1
a9 1
HOMEPAGE=	http://dovecot.org/
d21 2
a22 2
CONFIGURE_STYLE= autoconf
AUTOCONF_VERSION= 2.59
@


1.3
log
@fix three crashing bugs, bump PKGNAME

- searching address fields can crash sometimes
- auth process crashes if user doesn't have home directory set
- sme BODY and BODYSTRUCTURE replies missed data for message/rfc822 MIME
  parts causing clients to break
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2003/07/23 06:03:00 jolan Exp $
d5 1
a5 1
PKGNAME=	${DISTNAME}p1
@


1.2
log
@incorporate megadiff from the author which allows mmaping of index data
on openbsd, related to pr/3291.  bump PKGNAME
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2003/07/14 23:44:28 jolan Exp $
d5 1
a5 1
PKGNAME=	${DISTNAME}p0
@


1.2.2.1
log
@MFC:
upgrade to Dovecot 0.99.10.5

Dovecot 0.99.10.{4,5} fix some possible mail box corruption issues.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2004/05/27 16:38:30 brad Exp $
d4 2
a5 2

DISTNAME=	dovecot-0.99.10.5
d9 1
a9 1
HOMEPAGE=	http://dovecot.org/
d21 2
a22 2
CONFIGURE_STYLE= autoconf
AUTOCONF_VERSION= 2.57
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d5 1
d21 2
a22 1
CONFIGURE_STYLE=gnu
@


1.1.1.1
log
@import of dovecot-0.99.10, an imap(s)/pop3(s) server.
@
text
@@
