head	1.2;
access;
symbols
	OPENBSD_5_6:1.1.0.6
	OPENBSD_5_6_BASE:1.1
	OPENBSD_5_4:1.1.0.4
	OPENBSD_5_5:1.1.0.2;
locks; strict;
comment	@# @;


1.2
date	2014.10.16.18.01.57;	author brad;	state dead;
branches;
next	1.1;
commitid	wjSnXn5F22Oxtkah;

1.1
date	2014.05.12.09.20.52;	author brad;	state Exp;
branches
	1.1.2.1
	1.1.4.1;
next	;

1.1.2.1
date	2014.05.12.09.40.19;	author brad;	state Exp;
branches;
next	;

1.1.4.1
date	2014.05.12.09.58.36;	author brad;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Update to Dovecot 2.2.14.

ok sthen@@
@
text
@$OpenBSD: patch-src_login-common_client-common_c,v 1.1 2014/05/12 09:20:52 brad Exp $

Fix a DoS attack against imap/pop3-login processes. CVE-2014-3430

--- src/login-common/client-common.c.orig	Mon May 12 04:53:00 2014
+++ src/login-common/client-common.c	Mon May 12 04:53:57 2014
@@@@ -171,6 +171,8 @@@@ void client_destroy(struct client *client, const char 
 		last_client = client->prev;
 	DLLIST_REMOVE(&clients, client);
 
+	if (!client->login_success && client->ssl_proxy != NULL)
+		ssl_proxy_destroy(client->ssl_proxy);
 	if (client->input != NULL)
 		i_stream_close(client->input);
 	if (client->output != NULL)
@


1.1
log
@Fix a DoS attack against imap/pop3-login processes. CVE-2014-3430

ok sthen@@
@
text
@d1 1
a1 1
$OpenBSD$
@


1.1.4.1
log
@Fix a DoS attack against imap/pop3-login processes. CVE-2014-3430

ok sthen@@
@
text
@d5 3
a7 3
--- src/login-common/client-common.c.orig	Tue Oct 30 13:57:35 2012
+++ src/login-common/client-common.c	Mon May 12 05:54:59 2014
@@@@ -142,6 +142,8 @@@@ void client_destroy(struct client *client, const char 
@


1.1.2.1
log
@Fix a DoS attack against imap/pop3-login processes. CVE-2014-3430

ok sthen@@
@
text
@@

