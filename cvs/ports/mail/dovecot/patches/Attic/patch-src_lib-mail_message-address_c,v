head	1.2;
access;
symbols
	OPENBSD_3_5:1.1.0.2
	OPENBSD_3_5_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2004.05.10.00.06.47;	author brad;	state dead;
branches;
next	1.1;

1.1
date	2003.09.23.06.34.32;	author jolan;	state Exp;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2004.05.28.20.46.46;	author brad;	state dead;
branches;
next	;


desc
@@


1.2
log
@upgrade to Dovecot 0.99.10.4
--
ok MAINTAINER
@
text
@$OpenBSD: patch-src_lib-mail_message-address_c,v 1.1 2003/09/23 06:34:32 jolan Exp $
--- src/lib-mail/message-address.c.orig	2003-03-20 09:46:34.000000000 -0600
+++ src/lib-mail/message-address.c	2003-09-23 00:45:01.000000000 -0500
@@@@ -252,14 +252,14 @@@@ void message_address_write(string_t *str
 		} else if ((addr->name == NULL || *addr->name == '\0') &&
 			   addr->route == NULL) {
 			i_assert(addr->mailbox != NULL);
-			i_assert(addr->domain != NULL);
 
 			str_append(str, addr->mailbox);
-			str_append_c(str, '@@');
-			str_append(str, addr->domain);
+			if (addr->domain != NULL) {
+				str_append_c(str, '@@');
+				str_append(str, addr->domain);
+			}
 		} else {
 			i_assert(addr->mailbox != NULL);
-			i_assert(addr->domain != NULL);
 
 			if (addr->name != NULL) {
 				str_append(str, addr->name);
@@@@ -272,8 +272,10 @@@@ void message_address_write(string_t *str
 				str_append_c(str, ':');
 			}
 			str_append(str, addr->mailbox);
-			str_append_c(str, '@@');
-			str_append(str, addr->domain);
+			if (addr->domain != NULL) {
+				str_append_c(str, '@@');
+				str_append(str, addr->domain);
+			}
 			str_append_c(str, '>');
 		}
 
@


1.1
log
@fix three crashing bugs, bump PKGNAME

- searching address fields can crash sometimes
- auth process crashes if user doesn't have home directory set
- sme BODY and BODYSTRUCTURE replies missed data for message/rfc822 MIME
  parts causing clients to break
@
text
@d1 1
a1 1
$OpenBSD$
@


1.1.2.1
log
@MFC:
upgrade to Dovecot 0.99.10.5

Dovecot 0.99.10.{4,5} fix some possible mail box corruption issues.
@
text
@d1 1
a1 1
$OpenBSD: patch-src_lib-mail_message-address_c,v 1.1 2003/09/23 06:34:32 jolan Exp $
@


