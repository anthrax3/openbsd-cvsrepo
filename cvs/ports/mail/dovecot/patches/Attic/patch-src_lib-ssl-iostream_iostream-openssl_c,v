head	1.2;
access;
symbols
	OPENBSD_5_6:1.1.0.2
	OPENBSD_5_6_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2014.10.16.18.01.57;	author brad;	state dead;
branches;
next	1.1;
commitid	wjSnXn5F22Oxtkah;

1.1
date	2014.07.30.14.28.24;	author naddy;	state Exp;
branches;
next	;
commitid	rFSmDmXMPjLyf9TK;


desc
@@


1.2
log
@Update to Dovecot 2.2.14.

ok sthen@@
@
text
@$OpenBSD: patch-src_lib-ssl-iostream_iostream-openssl_c,v 1.1 2014/07/30 14:28:24 naddy Exp $

Fixed compiling with SSL compression disabled.

--- src/lib-ssl-iostream/iostream-openssl.c.orig	Tue Jul 29 15:35:56 2014
+++ src/lib-ssl-iostream/iostream-openssl.c	Tue Jul 29 15:36:29 2014
@@@@ -675,7 +675,7 @@@@ static const char *
 openssl_iostream_get_security_string(struct ssl_iostream *ssl_io)
 {
 	const SSL_CIPHER *cipher;
-#ifdef HAVE_SSL_COMPRESSION
+#if defined(HAVE_SSL_COMPRESSION) && !defined(OPENSSL_NO_COMP)
 	const COMP_METHOD *comp;
 #endif
 	const char *comp_str;
@@@@ -686,7 +686,7 @@@@ openssl_iostream_get_security_string(struct ssl_iostre
 
 	cipher = SSL_get_current_cipher(ssl_io->ssl);
 	bits = SSL_CIPHER_get_bits(cipher, &alg_bits);
-#ifdef HAVE_SSL_COMPRESSION
+#if defined(HAVE_SSL_COMPRESSION) && !defined(OPENSSL_NO_COMP)
 	comp = SSL_get_current_compression(ssl_io->ssl);
 	comp_str = comp == NULL ? "" :
 		t_strconcat(" ", SSL_COMP_get_name(comp), NULL);
@


1.1
log
@fix build after SSL compression removal; from brad@@ et al.
@
text
@d1 1
a1 1
$OpenBSD$
@

