head	1.2;
access;
symbols;
locks; strict;
comment	@# @;


1.2
date	2013.01.26.14.36.16;	author sthen;	state dead;
branches;
next	1.1;

1.1
date	2013.01.03.20.05.15;	author sthen;	state Exp;
branches;
next	;


desc
@@


1.2
log
@bugfix update to Roundcube 0.8.5, rolling in previous patches
@
text
@$OpenBSD: patch-program_lib_washtml_php,v 1.1 2013/01/03 20:05:15 sthen Exp $

9019025222  XSS in vbscript and data:text links

--- program/lib/washtml.php.orig	Wed Nov 14 20:30:27 2012
+++ program/lib/washtml.php	Thu Jan  3 19:45:36 2013
@@@@ -214,7 +214,7 @@@@ class washtml
       $key = strtolower($key);
       $value = $node->getAttribute($key);
       if (isset($this->_html_attribs[$key]) ||
-         ($key == 'href' && !preg_match('!^javascript!i', $value)
+         ($key == 'href' && !preg_match('!^(javascript|vbscript|data:text)!i', $value)
            && preg_match('!^([a-z][a-z0-9.+-]+:|//|#).+!i', $value))
       ) {
         $t .= ' ' . $key . '="' . htmlspecialchars($value, ENT_QUOTES) . '"';
@


1.1
log
@add fixes from Roundcube upstream git:

- Workaround IE<=8 bug where Content-Disposition:inline was ignored
- Fix XSS vulnerability in vbscript: and data:text links handling
- Fix cache (in)validation after setting \Deleted flag
@
text
@d1 1
a1 1
$OpenBSD$
@

