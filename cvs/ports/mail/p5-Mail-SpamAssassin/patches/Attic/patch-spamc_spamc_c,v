head	1.2;
access;
symbols
	OPENBSD_5_5:1.1.0.8
	OPENBSD_5_5_BASE:1.1
	OPENBSD_5_4:1.1.0.6
	OPENBSD_5_4_BASE:1.1
	OPENBSD_5_3:1.1.0.4
	OPENBSD_5_3_BASE:1.1
	OPENBSD_5_2:1.1.0.2
	OPENBSD_5_2_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2014.03.16.12.39.22;	author sthen;	state dead;
branches;
next	1.1;

1.1
date	2012.06.25.22.12.30;	author sthen;	state Exp;
branches;
next	;


desc
@@


1.2
log
@update to SpamAssassin 3.4.0, with input from brad@@
@
text
@$OpenBSD: patch-spamc_spamc_c,v 1.1 2012/06/25 22:12:30 sthen Exp $

Remove the SSLv2 support.

--- spamc/spamc.c.orig	Mon Jun 25 07:57:51 2012
+++ spamc/spamc.c	Mon Jun 25 07:59:14 2012
@@@@ -359,17 +359,11 @@@@ read_args(int argc, char **argv,
             case 'S':
             {
                 flags |= SPAMC_USE_SSL;
-		if (!spamc_optarg || (strcmp(spamc_optarg,"sslv23") == 0)) {
-		  /* this is the default */
+		if (!spamc_optarg || (strcmp(spamc_optarg,"sslv3") == 0)) {
+		    flags |= SPAMC_SSLV3;
 		}
-	        else if (strcmp(spamc_optarg,"sslv2") == 0) {
-		  flags |= SPAMC_SSLV2;
-		}
-		else if (strcmp(spamc_optarg,"sslv3") == 0) {
-		  flags |= SPAMC_SSLV3;
-		}
 		else if (strcmp(spamc_optarg,"tlsv1") == 0) {
-		  flags |= (SPAMC_SSLV2 | SPAMC_SSLV3);
+		    flags |= SPAMC_TLSV1;
 		}
 		else {
 		    libspamc_log(flags, LOG_ERR, "Please specify a legal ssl version (%s)", spamc_optarg);
@


1.1
log
@let SpamAssassin work if sslv2 is disabled, from Brad
@
text
@d1 1
a1 1
$OpenBSD$
@

