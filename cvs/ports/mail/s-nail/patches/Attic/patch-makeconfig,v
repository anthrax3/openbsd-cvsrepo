head	1.2;
access;
symbols
	OPENBSD_5_4:1.1.0.2
	OPENBSD_5_4_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2013.11.07.03.34.58;	author william;	state dead;
branches;
next	1.1;

1.1
date	2013.06.17.19.30.44;	author ajacoutot;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Update to 14.4.4; bugfixes and requested by the author

Testing and ok jca@@
kerberos bits ok ajacoutot@@
@
text
@$OpenBSD: patch-makeconfig,v 1.1 2013/06/17 19:30:44 ajacoutot Exp $
--- makeconfig.orig	Wed May  1 16:31:18 2013
+++ makeconfig	Mon Jun 17 11:59:07 2013
@@@@ -5,6 +5,12 @@@@
 [ -z "${WANT_NOALLOCA}" ] && WANT_NOALLOCA=0
 [ -z "${WANT_NOGETOPT}" ] && WANT_NOGETOPT=0
 
+KRB5_CONFIG=`which krb5-config 2>/dev/null`
+if [ -x ${KRB5_CONFIG} ]; then
+	GSSAPI_LIBS=`/usr/bin/krb5-config --libs gssapi`
+	GSSAPI_INCS=`/usr/bin/krb5-config --cflags`
+fi
+
 if [ -z "${CONFIG}" ]; then
 	[ -f ./user.conf ] && . ./user.conf
 else
@@@@ -599,8 +605,8 @@@@ int main(void)
 			'for GSSAPI in libgssapi, OpenBSD-style' \
 			'#define USE_GSSAPI
 			#define	GSSAPI_REG_INCLUDE' \
-			'-lgssapi -lkrb5 -lcrypto' \
-			'-I/usr/include/kerberosV' || \
+			"${GSSAPI_LIBS}" \
+			"${GSSAPI_INCS}" || \
 		< ${tmp2}.c link_check gssapi 'for GSSAPI in libgss' \
 			'#define USE_GSSAPI' \
 			'-lgss' || \
@


1.1
log
@Unbreak with new Heimdal; get rid of self-cooked krb5-config since we
have it in base now.
@
text
@d1 1
a1 1
$OpenBSD$
@

