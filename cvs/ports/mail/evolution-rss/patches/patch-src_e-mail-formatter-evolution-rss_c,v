head	1.3;
access;
symbols
	OPENBSD_6_2:1.3.0.4
	OPENBSD_6_2_BASE:1.3
	OPENBSD_6_1:1.3.0.2
	OPENBSD_6_1_BASE:1.3
	OPENBSD_5_4:1.1.0.2
	OPENBSD_5_4_BASE:1.1;
locks; strict;
comment	@# @;


1.3
date	2016.10.31.12.34.30;	author ajacoutot;	state Exp;
branches;
next	1.2;
commitid	Oim47EmaZJp8Ob8Y;

1.2
date	2013.09.27.09.47.12;	author ajacoutot;	state dead;
branches;
next	1.1;

1.1
date	2013.04.16.07.34.15;	author ajacoutot;	state Exp;
branches;
next	;


desc
@@


1.3
log
@Adapt to changes in evolution 3.21.90 (upstream).
@
text
@$OpenBSD$

From 7741ef0cf3327cb5c719912358443b6aef3bdb59 Mon Sep 17 00:00:00 2001
From: Milan Crha <mcrha@@redhat.com>
Date: Wed, 17 Aug 2016 18:43:48 +0200
Subject: Adapt to changes in evolution 3.21.90

--- src/e-mail-formatter-evolution-rss.c.orig	Wed Apr  1 13:23:18 2015
+++ src/e-mail-formatter-evolution-rss.c	Mon Oct 31 13:19:55 2016
@@@@ -52,6 +52,7 @@@@ G_DEFINE_DYNAMIC_TYPE (
 
 static const gchar* rss_formatter_mime_types[] = { "x-evolution/evolution-rss-feed", NULL };
 
+#if EVOLUTION_VERSION < 32190
 static void
 set_view_cb (GtkWidget *button,
 		gpointer *data)
@@@@ -60,6 +61,8 @@@@ set_view_cb (GtkWidget *button,
 	rss_set_changed_view(1);
 	e_mail_display_reload (rss_get_display());
 }
+#endif
+
 #include "fetch.h"
 
 typedef struct _HD HD;
@@@@ -132,7 +135,11 @@@@ emfe_evolution_rss_format (EMailFormatterExtension *ex
 	if (!rss_init)
 			goto fail;
 
+#if EVOLUTION_VERSION >= 32190
+	h = e_web_view_get_content_html_sync (E_WEB_VIEW (rss_get_display()), NULL, NULL);
+#else
 	h = g_strdup(e_web_view_get_html (E_WEB_VIEW (rss_get_display())));
+#endif
 
 	website = (gchar *)camel_medium_get_header (
 			CAMEL_MEDIUM (message), "Website");
@@@@ -375,6 +382,7 @@@@ e_mail_formatter_evolution_rss_type_register (GTypeMod
 	e_mail_formatter_evolution_rss_register_type (type_module);
 }
 
+#if EVOLUTION_VERSION < 32190
 static GtkWidget *
 emfe_evolution_rss_get_widget (EMailFormatterExtension *extension,
 				EMailPartList *context,
@@@@ -399,13 +407,16 @@@@ emfe_evolution_rss_get_widget (EMailFormatterExtension
 	gtk_widget_show(box);
 	return box;
 }
+#endif
 
 static void
 e_mail_formatter_evolution_rss_class_init (EMailFormatterExtensionClass *class)
 {
 	class->mime_types = rss_formatter_mime_types;
 	class->format = emfe_evolution_rss_format;
+#if EVOLUTION_VERSION < 32190
 	class->get_widget = emfe_evolution_rss_get_widget;
+#endif
 	class->display_name = _("Evolution-RSS");
 	class->description = _("Displaying RSS feed articles");
 }
@


1.2
log
@Update to evolution-rss-0.3.94.
@
text
@d1 1
a1 1
$OpenBSD: patch-src_e-mail-formatter-evolution-rss_c,v 1.1 2013/04/16 07:34:15 ajacoutot Exp $
d3 4
a6 4
From d036394c4ab3b7f9e2c650f72acd5b6725b1bb45 Mon Sep 17 00:00:00 2001
From: Lucian Langa <lucilanga@@gnome.org>
Date: Thu, 28 Mar 2013 09:08:50 +0000
Subject: remove EShellSettings requirement
d8 3
a10 5
--- src/e-mail-formatter-evolution-rss.c.orig	Fri Jan  4 18:13:37 2013
+++ src/e-mail-formatter-evolution-rss.c	Tue Apr 16 09:24:20 2013
@@@@ -24,7 +24,6 @@@@
 #include <em-format/e-mail-part-utils.h>
 #include <e-util/e-util.h>
d12 1
a12 2
-#include <shell/e-shell-settings.h>
 #include <shell/e-shell.h>
d14 50
a63 1
 #include <libebackend/libebackend.h>
@


1.1
log
@Do not require EShellSettings (upstream).
@
text
@d1 1
a1 1
$OpenBSD$
@

