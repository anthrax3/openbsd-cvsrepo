head	1.3;
access;
symbols
	OPENBSD_3_7:1.2.0.2
	OPENBSD_3_8:1.1.0.2
	OPENBSD_3_8_BASE:1.1;
locks; strict;
comment	@# @;


1.3
date	2006.01.23.12.34.06;	author wilfried;	state dead;
branches;
next	1.2;

1.2
date	2005.10.14.04.00.38;	author kurt;	state Exp;
branches
	1.2.2.1;
next	1.1;

1.1
date	2005.04.09.08.11.19;	author wilfried;	state Exp;
branches;
next	;

1.2.2.1
date	2005.11.13.12.37.13;	author sturm;	state Exp;
branches;
next	;


desc
@@


1.3
log
@update thunderbird to 1.5
@
text
@$OpenBSD: patch-gfx_src_gtk_nsDeviceContextSpecG_cpp,v 1.2 2005/10/14 04:00:38 kurt Exp $
--- gfx/src/gtk/nsDeviceContextSpecG.cpp.orig	Thu Feb 17 16:24:34 2005
+++ gfx/src/gtk/nsDeviceContextSpecG.cpp	Mon Oct  3 14:49:14 2005
@@@@ -1133,7 +1133,7 @@@@ nsresult GlobalPrinters::InitializeGloba
       free(printerList);
     } else {
       /* Try to use CUPS */
-      PRLibrary *clib = PR_LoadLibrary("libcups.so.2");
+      PRLibrary *clib = PR_LoadLibrary("libcups.so");
       if (clib) {
         CupsGetDestsType  CupsGetDests;
         CupsGetDestType   CupsGetDest;
@


1.2
log
@remove 'don't close dlopened objects' type ld.so work-arounds
@
text
@d1 1
a1 1
$OpenBSD: patch-gfx_src_gtk_nsDeviceContextSpecG_cpp,v 1.1 2005/04/09 08:11:19 wilfried Exp $
@


1.2.2.1
log
@update to thunderbird 1.0.7, several bugfixes included
@
text
@d3 2
a4 11
+++ gfx/src/gtk/nsDeviceContextSpecG.cpp	Mon Apr  4 12:56:30 2005
@@@@ -68,6 +68,8 @@@@
 
 #include "prlink.h"
 
+static PRLibrary *clib = nsnull;
+
 typedef struct				/**** Printer Options ****/
 {
   char		*name;			/* Name of option */
@@@@ -1133,7 +1135,8 @@@@ nsresult GlobalPrinters::InitializeGloba
d9 1
a9 2
+      if (clib == nsnull)
+        clib = PR_LoadLibrary("libcups.so");
a12 8
@@@@ -1178,7 +1181,6 @@@@ nsresult GlobalPrinters::InitializeGloba
             (*CupsFreeDests)(num_dests, dests);
           }
         }
-        PR_UnloadLibrary(clib);
       }
     }
 
@


1.1
log
@- bump major shlib version
- fix CUPS printing: fix partial so version and don't dlclose lib.
- remove partial so version on freetype
- move INSTALL/DEINSTALL code to PLIST
@
text
@d1 1
a1 1
$OpenBSD$
d3 2
a4 11
+++ gfx/src/gtk/nsDeviceContextSpecG.cpp	Mon Apr  4 12:56:30 2005
@@@@ -68,6 +68,8 @@@@
 
 #include "prlink.h"
 
+static PRLibrary *clib = nsnull;
+
 typedef struct				/**** Printer Options ****/
 {
   char		*name;			/* Name of option */
@@@@ -1133,7 +1135,8 @@@@ nsresult GlobalPrinters::InitializeGloba
d9 1
a9 2
+      if (clib == nsnull)
+        clib = PR_LoadLibrary("libcups.so");
a12 8
@@@@ -1178,7 +1181,6 @@@@ nsresult GlobalPrinters::InitializeGloba
             (*CupsFreeDests)(num_dests, dests);
           }
         }
-        PR_UnloadLibrary(clib);
       }
     }
 
@

