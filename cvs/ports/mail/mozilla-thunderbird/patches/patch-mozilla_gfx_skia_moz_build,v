head	1.3;
access;
symbols
	OPENBSD_6_1:1.3.0.4
	OPENBSD_6_1_BASE:1.3
	OPENBSD_6_0:1.3.0.2
	OPENBSD_6_0_BASE:1.3
	OPENBSD_5_9:1.2.0.2
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.2.0.4
	OPENBSD_5_8_BASE:1.2
	OPENBSD_5_7:1.1.0.4
	OPENBSD_5_7_BASE:1.1
	OPENBSD_5_6:1.1.0.2
	OPENBSD_5_6_BASE:1.1;
locks; strict;
comment	@# @;


1.3
date	2016.04.27.14.18.52;	author landry;	state Exp;
branches;
next	1.2;
commitid	JA1268drc58te6De;

1.2
date	2015.07.05.20.18.06;	author landry;	state Exp;
branches;
next	1.1;
commitid	kn9BcWVt83FWb3H2;

1.1
date	2014.07.24.18.24.03;	author landry;	state Exp;
branches;
next	;
commitid	SSkn6cHOPriUcXVg;


desc
@@


1.3
log
@Major update to thunderbird 45.0 / lightning 4.7.

- See https://www.mozilla.org/en-US/thunderbird/45.0/releasenotes/
- Fixes MFSA 2016-16->20, 23, 24, 27, 34->37
- Disable gstreamer support as in other geckos
- ship gdata-provider as an xpi file
- Add back patches to fix the build on i386

Been using the betas in the past 6 months without issues.
@
text
@$OpenBSD: patch-mozilla_gfx_skia_moz_build,v 1.2 2015/07/05 20:18:06 landry Exp $
https://bugzilla.mozilla.org/show_bug.cgi?id=1028827
--- mozilla/gfx/skia/moz.build.orig	Tue Jan 12 15:36:26 2016
+++ mozilla/gfx/skia/moz.build	Mon Jan 25 20:13:11 2016
@@@@ -644,11 +644,13 @@@@ if CONFIG['_MSC_VER']:
 if CONFIG['INTEL_ARCHITECTURE'] and CONFIG['GNU_CC']:
     SOURCES['skia/src/opts/SkBitmapFilter_opts_SSE2.cpp'].flags += CONFIG['SSE2_FLAGS']
     SOURCES['skia/src/opts/SkBitmapProcState_opts_SSE2.cpp'].flags += CONFIG['SSE2_FLAGS']
-    SOURCES['skia/src/opts/SkBitmapProcState_opts_SSSE3.cpp'].flags += ['-mssse3']
+    if CONFIG['HAVE_TOOLCHAIN_SUPPORT_MSSSE3']:
+        SOURCES['skia/src/opts/SkBitmapProcState_opts_SSSE3.cpp'].flags += ['-mssse3']
     SOURCES['skia/src/opts/SkBlitRect_opts_SSE2.cpp'].flags += CONFIG['SSE2_FLAGS']
     SOURCES['skia/src/opts/SkBlitRow_opts_SSE2.cpp'].flags += CONFIG['SSE2_FLAGS']
     SOURCES['skia/src/opts/SkBlurImage_opts_SSE2.cpp'].flags += CONFIG['SSE2_FLAGS']
-    SOURCES['skia/src/opts/SkBlurImage_opts_SSE4.cpp'].flags += ['-msse4.1']
+    if CONFIG['HAVE_TOOLCHAIN_SUPPORT_MSSE4_1']:
+        SOURCES['skia/src/opts/SkBlurImage_opts_SSE4.cpp'].flags += ['-msse4.1']
     SOURCES['skia/src/opts/SkMorphology_opts_SSE2.cpp'].flags += CONFIG['SSE2_FLAGS']
     SOURCES['skia/src/opts/SkUtils_opts_SSE2.cpp'].flags += CONFIG['SSE2_FLAGS']
     SOURCES['skia/src/opts/SkXfermode_opts_SSE2.cpp'].flags += CONFIG['SSE2_FLAGS']
@


1.2
log
@Major update to thunderbird 38.0.1/lightning 4.0.

- See https://www.mozilla.org/en-US/thunderbird/38.0.1/releasenotes/
- Fixes MFSA 2015-59,63,66,67,70,71
- We keep lightning optional by moving it out of the distributions/ dir,
  this way we ensure updates are done from the port (no xpi are provided
upstream for openbsd anyway, so updates wouldnt work)
- Switch i386 to build with clang
- Remove libvpx hack & patches
- Remove useless patches

Been using the betas since a while without major issue, this will ensure
it gets proper testing/dogfooding - since my call for testing on ports@@
lead to .. not much feedback. Note that the first bugfix 38.1.0 release
is already around the corner.
@
text
@d1 1
a1 1
$OpenBSD: patch-mozilla_gfx_skia_moz_build,v 1.1 2014/07/24 18:24:03 landry Exp $
d3 3
a5 11
--- mozilla/gfx/skia/moz.build.orig	Wed Mar 11 08:56:24 2015
+++ mozilla/gfx/skia/moz.build	Thu Mar 19 21:04:03 2015
@@@@ -913,6 +913,7 @@@@ if CONFIG['MOZ_WIDGET_TOOLKIT'] in ('android', 'gtk2',
 
 if CONFIG['INTEL_ARCHITECTURE'] and CONFIG['HAVE_TOOLCHAIN_SUPPORT_MSSSE3']:
     DEFINES['SK_BUILD_SSSE3'] = 1
+    SOURCES['trunk/src/opts/SkBitmapProcState_opts_SSSE3.cpp'].flags += ['-mssse3']
 
 if CONFIG['MOZ_WIDGET_TOOLKIT'] in ('android', 'gonk'):
     DEFINES['SK_FONTHOST_CAIRO_STANDALONE'] = 0
@@@@ -943,7 +944,6 @@@@ if CONFIG['_MSC_VER']:
d7 14
a20 6
     SOURCES['trunk/src/opts/SkBitmapFilter_opts_SSE2.cpp'].flags += CONFIG['SSE2_FLAGS']
     SOURCES['trunk/src/opts/SkBitmapProcState_opts_SSE2.cpp'].flags += CONFIG['SSE2_FLAGS']
-    SOURCES['trunk/src/opts/SkBitmapProcState_opts_SSSE3.cpp'].flags += ['-mssse3']
     SOURCES['trunk/src/opts/SkBlitRect_opts_SSE2.cpp'].flags += CONFIG['SSE2_FLAGS']
     SOURCES['trunk/src/opts/SkBlitRow_opts_SSE2.cpp'].flags += CONFIG['SSE2_FLAGS']
     SOURCES['trunk/src/opts/SkBlurImage_opts_SSE2.cpp'].flags += CONFIG['SSE2_FLAGS']
@


1.1
log
@Update to thunderbird 31.0/lightning 3.3.

- See https://www.mozilla.org/en-US/thunderbird/31.0/releasenotes/
- Fixes MFSA 2014-56->66 (except 60)
- Move i386 to build with gcc to be in sync with other mozillas
- Remove patch-mozilla_content_media_gstreamer_GStreamerLoader_cpp,
  merged (#927898)
- Remove patch-mozilla_ipc_chromium_src_base_debug_util_posix_cc,
  merged(#927810)
- Remove patch-mozilla_ipc_chromium_src_base_dir_reader_bsd_h, merged
  (#909005)
- Remove patch-mozilla_js_src_ctypes_libffi_configure and
  patch-mozilla_js_src_ctypes_libffi_src_x86_freebsd_S, merged (#928381)
- Add patch-mozilla_media_libvpx_Makefile_in for libvpx hack on
  amd64/clang (#982693)
- Add patch-mozilla_gfx_skia_moz_build &
  patch-mozilla_gfx_skia_trunk_src_opts_SkBitmapProcState_opts_SSSE3_cpp
to fix build on i386 (#1028827)

Tested at least with 28.0b1, 30.0b1, 31.0b1 and 31.0b2 during this cycle..
and even starts on sparc64!

ok sthen@@ jasper@@ naddy@@
@
text
@d1 1
a1 1
$OpenBSD$
d3 3
a5 3
--- mozilla/gfx/skia/moz.build.orig	Fri Jul 18 02:05:20 2014
+++ mozilla/gfx/skia/moz.build	Thu Jul 24 20:20:51 2014
@@@@ -864,6 +864,7 @@@@ if CONFIG['MOZ_WIDGET_TOOLKIT'] in ('android', 'gtk2',
d13 1
a13 1
@@@@ -878,7 +879,6 @@@@ if CONFIG['MOZ_WIDGET_TOOLKIT'] == 'windows':
@

