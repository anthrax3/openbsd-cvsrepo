head	1.4;
access;
symbols
	OPENBSD_4_3:1.1.0.2
	OPENBSD_4_3_BASE:1.1;
locks; strict;
comment	@# @;


1.4
date	2015.12.23.23.12.23;	author sthen;	state dead;
branches;
next	1.3;
commitid	bWa56KPJXGvYiHF5;

1.3
date	2015.10.13.07.10.22;	author landry;	state Exp;
branches;
next	1.2;
commitid	s1jxRK1GR21leM6F;

1.2
date	2008.04.05.11.43.22;	author landry;	state dead;
branches;
next	1.1;

1.1
date	2008.02.25.17.14.18;	author landry;	state Exp;
branches;
next	;


desc
@@


1.4
log
@update to claws-mail 3.13.1, from maintainer Daniel Jakots.  CVE-2015-8614
@
text
@$OpenBSD: patch-src_common_utils_c,v 1.3 2015/10/13 07:10:22 landry Exp $

Commited upsteam
http://git.claws-mail.org/?p=claws.git;a=commit;h=9cd558c5357bc51acfaaa5e7227afc79c6e2bb8b
http://git.claws-mail.org/?p=claws.git;a=commit;h=7a36263d6ba50788c9ca47076f334a9101c50297

--- src/common/utils.c.orig	Sun Oct 11 10:19:33 2015
+++ src/common/utils.c	Mon Oct 12 20:13:57 2015
@@@@ -49,6 +49,7 @@@@
 #include <ctype.h>
 #include <errno.h>
 #include <sys/param.h>
+#include <sys/socket.h>
 
 #if (HAVE_WCTYPE_H && HAVE_WCHAR_H)
 #  include <wchar.h>
@@@@ -5106,7 +5107,7 @@@@ size_t fast_strftime(gchar *buf, gint buflen, const gc
 				*curpos++ = '0'+(lt->tm_min % 10);
 				break;
 			case 's':
-				snprintf(subbuf, 64, "%ld", mktime(lt));
+				snprintf(subbuf, 64, "%lld", (long long)mktime(lt));
 				len = strlen(subbuf); CHECK_SIZE();
 				strncpy2(curpos, subbuf, buflen - total_done);
 				break;
@


1.3
log
@Update to claws-mail 3.13.0, from maintainer Daniel Jakots.
@
text
@d1 1
a1 1
$OpenBSD$
@


1.2
log
@Update to claws-mail 3.3.1, from brad@@

ok MAINTAINER & pyr@@
@
text
@d1 25
a25 12
$OpenBSD: patch-src_common_utils_c,v 1.1 2008/02/25 17:14:18 landry Exp $
--- src/common/utils.c.orig	Mon Feb 25 13:02:36 2008
+++ src/common/utils.c	Mon Feb 25 13:03:20 2008
@@@@ -1522,6 +1522,8 @@@@ gint scan_mailto_url(const gchar *mailto, gchar **from
 	const gchar *forbidden_uris[] = { ".gnupg/",
 					  "/etc/passwd",
 					  "/etc/shadow",
+					  ".ssh/",
+					  "../",
 					  NULL };
 	gint num_attach = 0;
 	gchar **my_att = NULL;
@


1.1
log
@backport a security fix from claws-mail 3.3.1 to "Forbid attaching anything
containing "../" or ".ssh/" in mailto: URIs."
backporting (we're in freeze) adviced by sthen@@, update noticed by MAINTAINER
ok espie@@ naddy@@
@
text
@d1 1
a1 1
$OpenBSD$
@

