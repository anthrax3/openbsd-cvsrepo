head	1.4;
access;
symbols
	OPENBSD_6_0:1.4.0.4
	OPENBSD_6_0_BASE:1.4
	OPENBSD_5_9:1.4.0.2
	OPENBSD_5_9_BASE:1.4
	OPENBSD_5_8:1.1.0.26
	OPENBSD_5_8_BASE:1.1
	OPENBSD_5_7:1.1.0.22
	OPENBSD_5_7_BASE:1.1
	OPENBSD_5_6:1.1.0.20
	OPENBSD_5_6_BASE:1.1
	OPENBSD_5_5:1.1.0.18
	OPENBSD_5_5_BASE:1.1
	OPENBSD_5_4:1.1.0.16
	OPENBSD_5_4_BASE:1.1
	OPENBSD_5_3:1.1.0.14
	OPENBSD_5_3_BASE:1.1
	OPENBSD_5_2:1.1.0.12
	OPENBSD_5_2_BASE:1.1
	OPENBSD_5_1_BASE:1.1
	OPENBSD_5_1:1.1.0.10
	OPENBSD_5_0:1.1.0.8
	OPENBSD_5_0_BASE:1.1
	OPENBSD_4_9:1.1.0.6
	OPENBSD_4_9_BASE:1.1
	OPENBSD_4_8:1.1.0.4
	OPENBSD_4_8_BASE:1.1
	OPENBSD_4_7:1.1.0.2
	OPENBSD_4_7_BASE:1.1;
locks; strict;
comment	@# @;


1.4
date	2015.11.03.06.48.48;	author robert;	state Exp;
branches;
next	1.3;
commitid	1tf9dbtqKTF4XvxF;

1.3
date	2015.11.02.11.06.34;	author robert;	state Exp;
branches;
next	1.2;
commitid	19wAgXlT9RhqpZjX;

1.2
date	2015.09.22.07.06.08;	author jasper;	state Exp;
branches;
next	1.1;
commitid	57Cmmftja6OQznb8;

1.1
date	2009.09.27.13.57.30;	author ajacoutot;	state Exp;
branches
	1.1.22.1
	1.1.26.1;
next	;

1.1.22.1
date	2015.09.22.07.24.31;	author jasper;	state Exp;
branches;
next	;
commitid	VnwdPBTnWoQ0yiWl;

1.1.26.1
date	2015.09.22.07.06.54;	author jasper;	state Exp;
branches;
next	;
commitid	2wVieDmQx1PMV0Zl;


desc
@@


1.4
log
@fix bogous patches
@
text
@$OpenBSD$
--- installer/linux/zarafa-autorespond.orig	Tue Nov  3 07:47:57 2015
+++ installer/linux/zarafa-autorespond	Tue Nov  3 07:48:10 2015
@@@@ -1,4 +1,4 @@@@
-#! /usr/bin/env bash
+#!/bin/sh
 
 FROM=$1
 TO=$2
@


1.3
log
@update to 7.2.1
@
text
@d1 3
a3 3
$OpenBSD: patch-installer_linux_zarafa-autorespond,v 1.2 2015/09/22 07:06:08 jasper Exp $
--- installer/linux/zarafa-autorespond.orig	Thu Mar  5 16:52:42 2015
+++ installer/linux/zarafa-autorespond	Mon Sep 21 22:12:08 2015
d5 1
a5 1
-#!/usr/bin/env bash
a9 23
@@@@ -10,10 +10,20 @@@@ MSG=$5
 AUTORESPOND_CC=0
 AUTORESPOND_NORECIP=0
 TIMELIMIT=$[24*60*60]
-SENDDB=${TMP:-/tmp}/zarafa-vacation-$USER.db
-SENDDBTMP=${TMP:-/tmp}/zarafa-vacation-$USER-$$.tmp
+BASE_PATH=/var/db/zarafa/autorespond
+SENDDB=${BASE_PATH}/zarafa-vacation-$USER.db
+SENDDBTMP=${BASE_PATH}/zarafa-vacation-$USER-$$.tmp
 SENDMAILCMD=/usr/sbin/sendmail
 SENDMAILPARAMS="-t -f"
+
+if [ ! -d "$BASE_PATH" ] ; then
+	/usr/bin/logger -p mail.notice -t 'zarafa-autorespond' "Created directory $BASE_PATH"
+	mkdir -p "$BASE_PATH"
+	chmod 750 "$BASE_PATH"
+
+	/usr/bin/logger -p mail.notice -t 'zarafa-autorespond' "Moving existing vacation-files from /tmp to $BASE_PATH"
+	mv -fv /tmp/zarafa-vacation-* "$BASE_PATH/"
+fi
 
 if [ -r /etc/zarafa/autorespond ]; then
 	. /etc/zarafa/autorespond
@


1.2
log
@Security fix for CVE-2015-6566,
Potential local privilege escalation in zarafa-autorespond

ok robert@@ (MAINTAINER)
@
text
@d1 1
a1 6
$OpenBSD: patch-installer_linux_zarafa-autorespond,v 1.1 2009/09/27 13:57:30 ajacoutot Exp $

Security fix for CVE-2015-6566,
https://bugzilla.redhat.com/show_bug.cgi?id=1263006
https://download.zarafa.com/community/beta/7.2/changelog-7.2.txt

@


1.1
log
@Fix path to autoresponder.
Don't use bash for autoresponder script.
@
text
@d1 8
a8 3
$OpenBSD$
--- installer/linux/zarafa-autorespond.orig	Sun Sep 27 15:53:26 2009
+++ installer/linux/zarafa-autorespond	Sun Sep 27 15:53:45 2009
d15 23
@


1.1.22.1
log
@Security fix for CVE-2015-6566,
Potential local privilege escalation in zarafa-autorespond

ok robert@@ (MAINTAINER)
@
text
@d1 3
a3 3
$OpenBSD: patch-installer_linux_zarafa-autorespond,v 1.1 2009/09/27 13:57:30 ajacoutot Exp $
--- installer/linux/zarafa-autorespond.orig	Sun Aug 24 11:52:55 2014
+++ installer/linux/zarafa-autorespond	Tue Sep 22 09:19:49 2015
a9 23
@@@@ -10,10 +10,20 @@@@ MSG=$5
 AUTORESPOND_CC=0
 AUTORESPOND_NORECIP=0
 TIMELIMIT=$[24*60*60]
-SENDDB=${TMP:-/tmp}/zarafa-vacation-$USER.db
-SENDDBTMP=${TMP:-/tmp}/zarafa-vacation-$USER-$$.tmp
+BASE_PATH=/var/db/zarafa/autorespond
+SENDDB=${BASE_PATH}/zarafa-vacation-$USER.db
+SENDDBTMP=${BASE_PATH}/zarafa-vacation-$USER-$$.tmp
 SENDMAILCMD=/usr/sbin/sendmail
 SENDMAILPARAMS="-t -f"
+
+if [ ! -d "$BASE_PATH" ] ; then
+       /usr/bin/logger -p mail.notice -t 'zarafa-autorespond' "Created directory $BASE_PATH"
+       mkdir -p "$BASE_PATH"
+       chmod 750 "$BASE_PATH"
+
+       /usr/bin/logger -p mail.notice -t 'zarafa-autorespond' "Moving existing vacation-files from /tmp to $BASE_PATH"
+       mv -fv /tmp/zarafa-vacation-* "$BASE_PATH/"                                                                 
+fi
 
 if [ -r /etc/zarafa/autorespond ]; then
 	. /etc/zarafa/autorespond
@


1.1.26.1
log
@Security fix for CVE-2015-6566,
Potential local privilege escalation in zarafa-autorespond

ok robert@@ (MAINTAINER)
@
text
@d1 3
a3 8
$OpenBSD: patch-installer_linux_zarafa-autorespond,v 1.1 2009/09/27 13:57:30 ajacoutot Exp $

Security fix for CVE-2015-6566,
https://bugzilla.redhat.com/show_bug.cgi?id=1263006
https://download.zarafa.com/community/beta/7.2/changelog-7.2.txt

--- installer/linux/zarafa-autorespond.orig	Thu Mar  5 16:52:42 2015
+++ installer/linux/zarafa-autorespond	Mon Sep 21 22:12:08 2015
a9 23
@@@@ -10,10 +10,20 @@@@ MSG=$5
 AUTORESPOND_CC=0
 AUTORESPOND_NORECIP=0
 TIMELIMIT=$[24*60*60]
-SENDDB=${TMP:-/tmp}/zarafa-vacation-$USER.db
-SENDDBTMP=${TMP:-/tmp}/zarafa-vacation-$USER-$$.tmp
+BASE_PATH=/var/db/zarafa/autorespond
+SENDDB=${BASE_PATH}/zarafa-vacation-$USER.db
+SENDDBTMP=${BASE_PATH}/zarafa-vacation-$USER-$$.tmp
 SENDMAILCMD=/usr/sbin/sendmail
 SENDMAILPARAMS="-t -f"
+
+if [ ! -d "$BASE_PATH" ] ; then
+	/usr/bin/logger -p mail.notice -t 'zarafa-autorespond' "Created directory $BASE_PATH"
+	mkdir -p "$BASE_PATH"
+	chmod 750 "$BASE_PATH"
+
+	/usr/bin/logger -p mail.notice -t 'zarafa-autorespond' "Moving existing vacation-files from /tmp to $BASE_PATH"
+	mv -fv /tmp/zarafa-vacation-* "$BASE_PATH/"
+fi
 
 if [ -r /etc/zarafa/autorespond ]; then
 	. /etc/zarafa/autorespond
@


