head	1.5;
access;
symbols
	OPENBSD_5_2:1.4.0.6
	OPENBSD_5_2_BASE:1.4
	OPENBSD_5_1_BASE:1.4
	OPENBSD_5_1:1.4.0.4
	OPENBSD_5_0:1.4.0.2
	OPENBSD_5_0_BASE:1.4
	OPENBSD_4_9:1.1.0.4
	OPENBSD_4_9_BASE:1.1
	OPENBSD_4_8:1.1.0.2
	OPENBSD_4_8_BASE:1.1;
locks; strict;
comment	@# @;


1.5
date	2012.08.30.14.28.22;	author ajacoutot;	state dead;
branches;
next	1.4;

1.4
date	2011.06.02.12.46.37;	author ajacoutot;	state Exp;
branches;
next	1.3;

1.3
date	2011.03.11.08.44.44;	author ajacoutot;	state Exp;
branches;
next	1.2;

1.2
date	2011.03.03.13.16.05;	author ajacoutot;	state Exp;
branches;
next	1.1;

1.1
date	2010.06.30.02.46.48;	author ajacoutot;	state Exp;
branches;
next	;


desc
@@


1.5
log
@Major update to zarafa-7.1.0.
Complete ChangeLog available at:
http://download.zarafa.com/community/final/7.1/final-changelog-7.1.txt
@
text
@$OpenBSD: patch-provider_common_ECSearchClient_cpp,v 1.4 2011/06/02 12:46:37 ajacoutot Exp $

Needs newlocale(3).

--- provider/common/ECSearchClient.cpp.orig	Sun Feb 27 23:06:14 2011
+++ provider/common/ECSearchClient.cpp	Thu Mar 10 17:22:03 2011
@@@@ -124,7 +124,9 @@@@ ECRESULT ECSearchClient::Query(std::string &strQuery, 
 	ECRESULT er = erSuccess;
 	ECSearchResultArray *lpResults = NULL;
 	std::vector<std::string> lstResponse;
+#ifndef __OpenBSD__
 	locale_t loc = createlocale(LC_NUMERIC, "C");
+#endif
 
 	if (!lppsResults) {
 		er = ZARAFA_E_INVALID_PARAMETER;
@@@@ -172,7 +174,11 @@@@ ECRESULT ECSearchClient::Query(std::string &strQuery, 
 
 		memcpy(lpResults->__ptr[i].sEntryId.__ptr, strEntryId.c_str(), strEntryId.size());
 
+#ifndef __OpenBSD__
 		lpResults->__ptr[i].fScore = strtod_l(tmp[1].c_str(), NULL, loc);
+#else
+		lpResults->__ptr[i].fScore = strtod(tmp[1].c_str(), NULL);
+#endif
 		lpResults->__size++;
 	}
 
@@@@ -183,7 +189,9 @@@@ exit:
 	if ((er != erSuccess) && lpResults)
 		FreeSearchResults(lpResults);
 
+#ifndef __OpenBSD__
 	freelocale(loc);
+#endif
 
 	return er;
 }
@


1.4
log
@MAJOR update to zarafa-7.0.0 (RC1).
Committing now because this version performs _much_ better than what we
currently have in tree (see HOMEPAGE for details).

Quick&dirty upgrade steps (but you should follow the README):
------------------------------------------------------------------------
# /etc/rc.d/zarafa stop
===> Make sure _all_ zarafa processes are stopped and BACKUP YOUR DB!
# pkg_add -u zarafa zarafa-webaccess zarafa-libvmime
===> merge configuration (compare /usr/local/share/examples/zarara/*.cfg
with their counterparts under /etc/zarafa/.
# /usr/local/bin/zarafa-server
===> this will only do sanity checks but not start the server
# pkg_add py-mysql
# python2.6 /usr/local/share/doc/zarafa/zarafa7-upgrade
# /etc/rc.d/zarafa start
------------------------------------------------------------------------

tested by robert@@ and myself
ok robert@@
@
text
@d1 1
a1 1
$OpenBSD: patch-provider_common_ECSearchClient_cpp,v 1.3 2011/03/11 08:44:44 ajacoutot Exp $
@


1.3
log
@SECURITY update to zarafa-6.40.6.
As usual, changelog is available at:
http://download.zarafa.com/community/final/6.40/changelog-6.40.txt
@
text
@d1 4
a4 1
$OpenBSD: patch-provider_common_ECSearchClient_cpp,v 1.2 2011/03/03 13:16:05 ajacoutot Exp $
@


1.2
log
@Update to zarafa-6.40.5.
Complete changelog available at:
    http://download.zarafa.com/community/final/6.40/changelog-6.40.txt

Several documentation and configuration tweaks.
@
text
@d1 4
a4 4
$OpenBSD: patch-provider_common_ECSearchClient_cpp,v 1.1 2010/06/30 02:46:48 ajacoutot Exp $
--- provider/common/ECSearchClient.cpp.orig	Mon Jan 24 16:55:05 2011
+++ provider/common/ECSearchClient.cpp	Tue Jan 25 12:56:18 2011
@@@@ -130,7 +130,9 @@@@ ECRESULT ECSearchClient::Query(std::string &strQuery, 
d14 1
a14 1
@@@@ -178,7 +180,11 @@@@ ECRESULT ECSearchClient::Query(std::string &strQuery, 
d26 1
a26 1
@@@@ -189,7 +195,9 @@@@ exit:
@


1.1
log
@*MAJOR* version update to zarafa-6.40.0.
Read the complete changelog here:
http://download.zarafa.com/zarafa/release/docs/changelog.en.txt

Upgrade documentation is available at:
http://doc.zarafa.com/6.40/Administrator_Manual/en-US/html-single/index.html#_performing_the_upgrade

zarafa-libical has been removed, current version from ports works fine
for zarafa needs.

php5-mapi has been merged into zarafa-webaccess.
@
text
@d1 4
a4 4
$OpenBSD$
--- provider/common/ECSearchClient.cpp.orig	Tue Jun 29 00:34:25 2010
+++ provider/common/ECSearchClient.cpp	Tue Jun 29 00:35:13 2010
@@@@ -123,7 +123,9 @@@@ ECRESULT ECSearchClient::Query(std::string &strQuery, 
d14 1
a14 1
@@@@ -171,7 +173,11 @@@@ ECRESULT ECSearchClient::Query(std::string &strQuery, 
d26 1
a26 1
@@@@ -182,7 +188,9 @@@@ exit:
@

