head	1.18;
access;
symbols
	OPENBSD_2_9:1.16.0.2
	OPENBSD_2_9_BASE:1.16
	OPENBSD_2_8:1.13.0.2
	OPENBSD_2_8_BASE:1.13
	OPENBSD_2_7:1.10.0.2
	OPENBSD_2_7_BASE:1.10
	kevlo_2000-Jan-28:1.1.1.1
	kevlo:1.1.1;
locks; strict;
comment	@# @;


1.18
date	2001.08.14.20.26.33;	author camield;	state dead;
branches;
next	1.17;

1.17
date	2001.05.06.01.46.43;	author lebel;	state Exp;
branches;
next	1.16;

1.16
date	2001.04.22.12.04.45;	author camield;	state Exp;
branches;
next	1.15;

1.15
date	2001.03.22.22.06.39;	author brad;	state Exp;
branches;
next	1.14;

1.14
date	2001.02.08.20.06.23;	author espie;	state Exp;
branches;
next	1.13;

1.13
date	2000.09.25.07.40.11;	author camield;	state Exp;
branches;
next	1.12;

1.12
date	2000.08.16.08.56.40;	author camield;	state Exp;
branches;
next	1.11;

1.11
date	2000.06.16.23.06.08;	author espie;	state Exp;
branches;
next	1.10;

1.10
date	2000.04.27.06.14.15;	author camield;	state Exp;
branches
	1.10.2.1;
next	1.9;

1.9
date	2000.04.21.16.13.04;	author camield;	state Exp;
branches;
next	1.8;

1.8
date	2000.04.09.17.37.00;	author espie;	state Exp;
branches;
next	1.7;

1.7
date	2000.03.24.23.28.16;	author espie;	state Exp;
branches;
next	1.6;

1.6
date	2000.03.05.18.30.33;	author espie;	state Exp;
branches;
next	1.5;

1.5
date	2000.03.04.11.57.45;	author camield;	state Exp;
branches;
next	1.4;

1.4
date	2000.03.03.11.44.56;	author turan;	state Exp;
branches;
next	1.3;

1.3
date	2000.02.23.10.26.13;	author camield;	state Exp;
branches;
next	1.2;

1.2
date	2000.02.11.01.10.06;	author espie;	state Exp;
branches;
next	1.1;

1.1
date	2000.01.28.12.43.40;	author kevlo;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2000.01.28.12.43.40;	author kevlo;	state Exp;
branches;
next	;

1.10.2.1
date	2000.09.15.05.02.06;	author marc;	state Exp;
branches;
next	;


desc
@@


1.18
log
@you too
@
text
@# $OpenBSD: Makefile,v 1.17 2001/05/06 01:46:43 lebel Exp $

COMMENT=	"secure, reliable, efficient, simple MTA"

DISTNAME=	qmail-1.03
HOMEPAGE=	http://cr.yp.to/qmail.html
CATEGORIES=	mail
NEED_VERSION=	1.402
MAINTAINER=	Camiel Dobbelaar <cd@@sentia.nl>

MASTER_SITES=	ftp://ftp.net.ohio-state.edu/pub/networking/mail/qmail/ \
		ftp://ftp.ntnu.no/pub/unix/mail/qmail/ \
		ftp://ftp.mira.net.au/unix/mail/qmail/ \
		ftp://ftp.id.wustl.edu/pub/qmail/ \
		ftp://mirror.uk.uu.net/pub/qmail/ \
		ftp://ftp.jp.qmail.org/qmail/ \
		ftp://ftp.rifkin.technion.ac.il/pub/qmail/ \
		http://koobera.math.uic.edu/www/software/ \
		http://pobox.com/~djb/software/ 

PERMIT_PACKAGE_CDROM=	No
PERMIT_PACKAGE_FTP=	No
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes

# Override prefix here or on the 'make' commandline.
# Using the prefix option of pkg_add will not work, because
# the prefix is hardwired in the qmail installer.
PREFIX?=	/var/qmail
ALL_TARGET=	it man
INSTALL_TARGET=	setup check
IS_INTERACTIVE= "if qmail users/groups do not exist yet"

RUN_DEPENDS=    tcpserver::net/ucspi-tcp

SETUPBINARIES=	${WRKSRC}/dnsfq		${WRKSRC}/dnsip		\
		${WRKSRC}/dnsptr	${WRKSRC}/hostname	\
		${WRKSRC}/ipmeprint	${WRKSRC}/install
SETUPSCRIPTS=	${WRKSRC}/config	${WRKSRC}/config-fast

pre-build:
	@@echo ${CC} ${CFLAGS} > ${WRKSRC}/conf-cc
	@@echo ${PREFIX} > ${WRKSRC}/conf-qmail
	@@PREFIX=${PREFIX} ${SUDO} ${SH} ${PKGDIR}/INSTALL ${DISTNAME} PRE-INSTALL

pre-install:
	# preserve installer with correct prefix so it can be used by the
	# the package later (we create the queue directories with it)
	mv ${WRKSRC}/install ${WRKSRC}/install.nonfake
	# rebuild install utilities with fake prefix
	echo ${PREFIX} > ${WRKSRC}/conf-qmail
	# needed when using a different prefix 
	${INSTALL_DATA_DIR} ${PREFIX}

post-install:
	# restore original installer
	mv ${WRKSRC}/install.nonfake ${WRKSRC}/install
	${INSTALL_PROGRAM_DIR} ${PREFIX}/setup 
	${INSTALL_PROGRAM} ${SETUPBINARIES} ${PREFIX}/setup
	${INSTALL_SCRIPT} ${SETUPSCRIPTS} ${PREFIX}/setup

.include <bsd.port.mk>
@


1.17
log
@mail: integrate COMMENT, bump NEED_VERSION.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2001/04/22 12:04:45 camield Exp $
@


1.16
log
@PERMIT_PACKAGE_*: Yes -> No

No license, or license not clear
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.15 2001/03/22 22:06:39 brad Exp $
d8 1
a8 1
NEED_VERSION=	1.230
@


1.15
log
@- mkdir -> ${INSTALL_DATA_DIR}
- kill off FreeBSD-ism (NOPORTDOCS knob)
--
Patch from: Pete Fritchman <petef@@databits.net>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2001/02/08 20:06:23 espie Exp $
d19 2
a20 2
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes
@


1.14
log
@Add missing ${SUDO}. qmail still does not package as non-root, but it
goes further.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2000/09/25 07:40:11 camield Exp $
d51 1
a51 1
	mkdir -p ${PREFIX}
@


1.13
log
@add real name to MAINTAINER, plus a few nits
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2000/08/16 08:56:40 camield Exp $
d42 1
a42 1
	@@PREFIX=${PREFIX} ${SH} ${PKGDIR}/INSTALL ${DISTNAME} PRE-INSTALL
@


1.12
log
@allow PREFIX (default /var/qmail) to be overridden
(req. by Martin Portmann)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2000/06/16 23:06:08 espie Exp $
d4 1
d7 1
a7 1
MAINTAINER=	cd@@sentia.nl
@


1.11
log
@Remove NO_CONFIGURE/NO_PATCH/NO_EXTRACT/NO_MTREE

Kill corresponding FAKE=Yes and switch to CONFIGURE_STYLE while I'm at it.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2000/04/27 06:14:15 camield Exp $
d23 4
a26 1
PREFIX=		/var/qmail
d46 1
a46 1
	@@mv ${WRKSRC}/install ${WRKSRC}/install.nonfake
d48 3
a50 1
	@@echo ${PREFIX} > ${WRKSRC}/conf-qmail
d54 1
a54 1
	@@mv ${WRKSRC}/install.nonfake ${WRKSRC}/install
@


1.10
log
@commit again, cvs missed this one.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2000/04/21 16:13:04 camield Exp $
a23 2
NO_CONFIGURE=	Yes
NO_MTREE=	Yes
a26 2

FAKE=	Yes
@


1.10.2.1
log
@bring mail as of cut-over date into 2.7 branch
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2000/06/16 23:06:08 espie Exp $
d24 2
d29 2
@


1.9
log
@PERMIT_* = Yes

The port and package install _exactly_ the same as a manual qmail install,
except for the addition of a /var/qmail/setup directory where the setup
scripts are copied.
Therefore the following should apply: http://cr.yp.to/qmail/dist.html
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2000/04/09 17:37:00 espie Exp $
d5 1
a5 2
NEED_VERSION=	 1.230
FAKE=No
d7 1
d25 2
a26 1
ALL_TARGET=	default
d30 2
d44 7
d52 2
a56 1
	@@PREFIX=${PREFIX} ${SH} ${PKGDIR}/INSTALL ${DISTNAME} POST-INSTALL
@


1.8
log
@explicit FAKE=No, so that we can turn FAKE on by default.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2000/03/24 23:28:16 espie Exp $
d17 5
@


1.7
log
@Introduce :: in *_DEPENDS as a place holder for a package spec
Bump NEED_VERSION.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2000/03/05 18:30:33 espie Exp $
d6 1
@


1.6
log
@PORTSDIR no longer needed in *DEPENDS.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2000/03/04 11:57:45 camield Exp $
d5 1
a5 1
NEED_VERSION=	1.223
d23 1
a23 1
RUN_DEPENDS=    tcpserver:net/ucspi-tcp
@


1.5
log
@- mark unbroken, qmail now asks nicely before creating users or groups
- IS_INTERACTIVE= "if qmail users/groups do not exist yet"
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2000/03/03 11:44:56 turan Exp $
d5 1
a20 1
NO_MTREE=	Yes
d23 1
a23 1
RUN_DEPENDS=    tcpserver:${PORTSDIR}/net/ucspi-tcp
@


1.4
log
@broken, installs files automatically in /etc
@
text
@d1 1
a1 3
# $OpenBSD: Makefile,v 1.3 2000/02/23 10:26:13 camield Exp $

BROKEN=		installs files automatically in /etc
d17 1
a17 1
NO_CONFIGURE=	yes
d20 2
a21 1
NO_MTREE=	yes
@


1.3
log
@- mkdir, cp -> INSTALL_* macros
- clean-up pkg/INSTALL (qmail now builds as non-root, if qmail accounts exist)
  The mysql and postfix ports could also use the create_user and/or
  create_group shell functions, as they do a bit more error-checking.
- add obsd tags to INSTALL/DEINSTALL
- fix mastersite
- explicit warning that qmail does not automagically work after install
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.2 2000/02/11 01:10:06 espie Exp $
@


1.2
log
@Kill a large set of deprecated variables.
Thoroughly unsubtle, most mkdir -p should probably be INSTALL* at
*install stage, and echo/ECHO_MSG is somewhat unsorted.

It's quite possible I missed a few automated changes...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2000/01/28 12:43:40 kevlo Exp $
d12 1
a12 1
		http://ftp.rifkin.technion.ac.il/pub/qmail/ \
d24 1
a24 2
SETUPFILES=	${WRKSRC}/config	${WRKSRC}/config-fast	\
		${WRKSRC}/dnsfq		${WRKSRC}/dnsip		\
d27 1
d35 3
a37 2
	@@mkdir -p ${PREFIX}/setup
	@@cp ${SETUPFILES} ${PREFIX}/setup
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d30 2
a31 2
	@@${ECHO} ${CC} ${CFLAGS} > ${WRKSRC}/conf-cc
	@@${ECHO} ${PREFIX} > ${WRKSRC}/conf-qmail
d35 2
a36 2
	@@${MKDIR} ${PREFIX}/setup
	@@${CP} ${SETUPFILES} ${PREFIX}/setup
@


1.1.1.1
log
@qmail is a secure, reliable, efficient, simple message transfer agent.
It is meant as a replacement for the entire sendmail-binmail system on
typical Internet-connected UNIX hosts.

Submitted by:	Camiel Dobbelaar <cd@@sentia.nl>
@
text
@@
