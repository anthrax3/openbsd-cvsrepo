head	1.9;
access;
symbols
	OPENBSD_6_1:1.9.0.2
	OPENBSD_6_1_BASE:1.9
	OPENBSD_6_0:1.6.0.2
	OPENBSD_6_0_BASE:1.6
	OPENBSD_5_9:1.5.0.2
	OPENBSD_5_9_BASE:1.5
	sthen_20151009:1.1.1.1
	sthen:1.1.1;
locks; strict;
comment	@# @;


1.9
date	2017.03.08.17.02.13;	author sthen;	state Exp;
branches;
next	1.8;
commitid	A890MNPdF6wiuQcz;

1.8
date	2016.12.02.14.59.09;	author sthen;	state Exp;
branches;
next	1.7;
commitid	L2nb5nxOsjF5KTHZ;

1.7
date	2016.09.12.09.48.37;	author edd;	state Exp;
branches;
next	1.6;
commitid	E7di75op8BYcIz2l;

1.6
date	2016.05.27.09.18.14;	author sthen;	state Exp;
branches;
next	1.5;
commitid	GheqJMbHWIwZIxgU;

1.5
date	2016.01.19.01.14.51;	author sthen;	state Exp;
branches;
next	1.4;
commitid	iEGWVeykwJ99QWIT;

1.4
date	2015.12.29.20.50.30;	author sthen;	state Exp;
branches;
next	1.3;
commitid	KI9Qys64lMMOywpw;

1.3
date	2015.10.28.09.57.35;	author sthen;	state Exp;
branches;
next	1.2;
commitid	5SsvBRr3GPXSKrf8;

1.2
date	2015.10.17.19.35.51;	author sthen;	state Exp;
branches;
next	1.1;
commitid	BzkT4JHRdYvAHlS5;

1.1
date	2015.10.09.16.09.17;	author sthen;	state Exp;
branches
	1.1.1.1;
next	;
commitid	fTxmpHhud3V1d0SA;

1.1.1.1
date	2015.10.09.16.09.17;	author sthen;	state Exp;
branches;
next	;
commitid	fTxmpHhud3V1d0SA;


desc
@@


1.9
log
@update to rspamd-1.5.2, from Brad
@
text
@$OpenBSD: patch-CMakeLists_txt,v 1.8 2016/12/02 14:59:09 sthen Exp $

don't pick up libevent2 from ports, otherwise rspamd links against
both libevent from base *and* libevent2

--- CMakeLists.txt.orig	Thu Mar  2 11:58:42 2017
+++ CMakeLists.txt	Sun Mar  5 15:23:13 2017
@@@@ -526,14 +526,14 @@@@ SET(POE_LOOP "Loop::IO_Poll")
 SET(TAR "tar")
 
 # Platform specific configuration
-IF(CMAKE_SYSTEM_NAME MATCHES "^.*BSD$|DragonFly")
+IF(CMAKE_SYSTEM_NAME MATCHES "FreeBSD|DragonFly")
 	ADD_DEFINITIONS(-DFREEBSD -D_BSD_SOURCE)
 	CONFIGURE_FILE(freebsd/rspamd.sh.in freebsd/rspamd @@ONLY)
 
 	IF(ENABLE_REDIRECTOR MATCHES "ON")
 		CONFIGURE_FILE(freebsd/redirector.sh.in freebsd/redirector @@ONLY)
 	ENDIF(ENABLE_REDIRECTOR MATCHES "ON")
-	MESSAGE(STATUS "Configuring for BSD system")
+	MESSAGE(STATUS "Configuring for FreeBSD/DragonFly system")
 	# Find util library
 	ProcessPackage(LIBUTIL LIBRARY util INCLUDE libutil.h
 		ROOT ${LIBUTIL_ROOT_DIR} OPTIONAL)
@@@@ -546,8 +546,14 @@@@ IF(CMAKE_SYSTEM_NAME MATCHES "^.*BSD$|DragonFly")
 	ENDIF()
 	SET(POE_LOOP "Loop::Kqueue")
 	SET(TAR "gtar")
-ENDIF()
+ENDIF(CMAKE_SYSTEM_NAME MATCHES "FreeBSD|DragonFly")
 
+IF(CMAKE_SYSTEM_NAME MATCHES "NetBSD|OpenBSD")
+	MESSAGE(STATUS "Configuring for NetBSD/OpenBSD")
+	SET(POE_LOOP "Loop::Kqueue")
+	SET(TAR "gtar")
+ENDIF(CMAKE_SYSTEM_NAME MATCHES "NetBSD|OpenBSD")
+
 IF(CMAKE_SYSTEM_NAME STREQUAL "Darwin")
 	SET(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -D_BSD_SOURCE -DDARWIN")
 	SET(CMAKE_SHARED_LIBRARY_CREATE_C_FLAGS "${CMAKE_SHARED_LIBRARY_CREATE_C_FLAGS} -undefined dynamic_lookup")
@@@@ -679,7 +685,7 @@@@ ELSE()
 ENDIF()
 
 ProcessPackage(LIBEVENT LIBRARY event INCLUDE event.h INCLUDE_SUFFIXES include/event
-	ROOT ${LIBEVENT_ROOT_DIR} MODULES event libevent)
+	ROOT ${LIBEVENT_ROOT_DIR} MODULES event)
 ProcessPackage(SQLITE3 LIBRARY sqlite3 INCLUDE sqlite3.h INCLUDE_SUFFIXES include/sqlite3 include/sqlite
 	ROOT ${SQLITE3_ROOT_DIR} MODULES sqlite3 sqlite)
 ProcessPackage(ICUDATA LIBRARY icudata INCLUDE ucnv.h INCLUDE_SUFFIXES include/unicode
@


1.8
log
@update to rspamd-1.4.1
@
text
@d1 1
a1 1
$OpenBSD: patch-CMakeLists_txt,v 1.7 2016/09/12 09:48:37 edd Exp $
d6 3
a8 3
--- CMakeLists.txt.orig	Tue Nov 29 11:13:23 2016
+++ CMakeLists.txt	Thu Dec  1 15:03:14 2016
@@@@ -524,14 +524,14 @@@@ SET(POE_LOOP "Loop::IO_Poll")
d25 1
a25 1
@@@@ -544,8 +544,14 @@@@ IF(CMAKE_SYSTEM_NAME MATCHES "^.*BSD$|DragonFly")
d41 1
a41 1
@@@@ -694,7 +700,7 @@@@ ELSE()
d49 1
a49 1
 ProcessPackage(ICONV LIBRARY iconv libiconv libiconv-2 c INCLUDE iconv.h INCLUDE_SUFFIXES include/libiconv
@


1.7
log
@Update to rspamd-1.3.5.

Also use the robot test suite, now that all of the dependencies are ported.

Thanks to upstream for working with us to get this working smoothly on OpenBSD.

Input from sthen@@ and giovanni@@, tested by giovanni@@ and gilles@@.

OK giovanni@@, thanks.
@
text
@d1 1
a1 1
$OpenBSD: patch-CMakeLists_txt,v 1.6 2016/05/27 09:18:14 sthen Exp $
d6 3
a8 3
--- CMakeLists.txt.orig	Tue Aug 23 13:19:29 2016
+++ CMakeLists.txt	Tue Aug 30 18:07:13 2016
@@@@ -520,14 +520,14 @@@@ SET(POE_LOOP "Loop::IO_Poll")
d25 1
a25 1
@@@@ -540,8 +540,14 @@@@ IF(CMAKE_SYSTEM_NAME MATCHES "^.*BSD$|DragonFly")
d41 3
a43 3
@@@@ -668,7 +674,7 @@@@ ENDIF()
 ProcessPackage(GMIME LIBRARY gmime-2.6 gmime-2.4 gmime-2.2 gmime-2 INCLUDE gmime.h INCLUDE_SUFFIXES include/gmime
 	ROOT ${GMIME_ROOT_DIR} MODULES gmime-2.6 gmime-2.4 gmime-2.0)
@


1.6
log
@update to rspamd-1.2.7, from Brad
@
text
@d1 1
a1 1
$OpenBSD: patch-CMakeLists_txt,v 1.5 2016/01/19 01:14:51 sthen Exp $
d6 3
a8 3
--- CMakeLists.txt.orig	Fri Apr 22 09:37:43 2016
+++ CMakeLists.txt	Tue Apr 26 01:06:31 2016
@@@@ -509,14 +509,14 @@@@ SET(POE_LOOP "Loop::IO_Poll")
d25 1
a25 1
@@@@ -529,8 +529,14 @@@@ IF(CMAKE_SYSTEM_NAME MATCHES "^.*BSD$|DragonFly")
d41 1
a41 1
@@@@ -662,7 +668,7 @@@@ ENDIF()
@


1.5
log
@update to rspamd 1.1.0, from Brad.
@
text
@d1 1
a1 1
$OpenBSD: patch-CMakeLists_txt,v 1.4 2015/12/29 20:50:30 sthen Exp $
d6 3
a8 3
--- CMakeLists.txt.orig	Sat Jan 16 16:06:38 2016
+++ CMakeLists.txt	Mon Jan 18 17:21:42 2016
@@@@ -490,14 +490,14 @@@@ SET(POE_LOOP "Loop::IO_Poll")
d12 2
a13 2
-IF(CMAKE_SYSTEM_NAME MATCHES "^.*BSD$")
+IF(CMAKE_SYSTEM_NAME STREQUAL "FreeBSD")
d21 1
a21 1
+	MESSAGE(STATUS "Configuring for FreeBSD system")
d25 1
a25 1
@@@@ -510,8 +510,14 @@@@ IF(CMAKE_SYSTEM_NAME MATCHES "^.*BSD$")
d30 1
a30 1
+ENDIF(CMAKE_SYSTEM_NAME STREQUAL "FreeBSD")
d32 2
a33 2
+IF(CMAKE_SYSTEM_NAME STREQUAL "OpenBSD")
+	MESSAGE(STATUS "Configuring for OpenBSD")
d36 1
a36 1
+ENDIF(CMAKE_SYSTEM_NAME STREQUAL "OpenBSD")
d41 1
a41 1
@@@@ -628,7 +634,7 @@@@ ProcessPackage(PCRE LIBRARY pcre INCLUDE pcre.h INCLUD
@


1.4
log
@update to rspamd-1.0.11, from Brad
@
text
@d1 1
a1 1
$OpenBSD: patch-CMakeLists_txt,v 1.3 2015/10/28 09:57:35 sthen Exp $
d6 22
a27 3
--- CMakeLists.txt.orig	Mon Dec 21 13:21:40 2015
+++ CMakeLists.txt	Wed Dec 23 19:16:19 2015
@@@@ -492,6 +492,11 @@@@ IF(CMAKE_SYSTEM_NAME STREQUAL "FreeBSD")
d29 2
a30 1
 ENDIF(CMAKE_SYSTEM_NAME STREQUAL "FreeBSD")
d35 1
d41 2
a42 2
@@@@ -607,7 +612,7 @@@@ ProcessPackage(PCRE LIBRARY pcre INCLUDE pcre.h INCLUD
 ProcessPackage(GMIME LIBRARY gmime-2.6 gmime-2.4 gmime-2.2 gmime-2 INCLUDE gmime.h INCLUDE_SUFFIXES include/gmime 
d44 1
a44 1
 ProcessPackage(LIBEVENT LIBRARY event INCLUDE event.h INCLUDE_SUFFIXES include/event 
d47 1
a47 1
 ProcessPackage(SQLITE3 LIBRARY sqlite3 INCLUDE sqlite3.h INCLUDE_SUFFIXES include/sqlite3 include/sqlite 
@


1.3
log
@update to rspamd-1.0.9
@
text
@d1 1
a1 1
$OpenBSD: patch-CMakeLists_txt,v 1.2 2015/10/17 19:35:51 sthen Exp $
d6 2
a7 2
--- CMakeLists.txt.orig	Tue Oct 27 07:19:47 2015
+++ CMakeLists.txt	Wed Oct 28 01:43:41 2015
a28 7
@@@@ -1121,4 +1126,4 @@@@ ADD_CUSTOM_TARGET(dist ${CMAKE_SOURCE_DIR}/dist.sh
 IF(NOT DEBIAN_BUILD)
 	ADD_CUSTOM_TARGET(check DEPENDS rspamd-test)
 	ADD_CUSTOM_TARGET(run-test DEPENDS check COMMAND test/rspamd-test)
-ENDIF(NOT DEBIAN_BUILD)
\ No newline at end of file
+ENDIF(NOT DEBIAN_BUILD)
@


1.2
log
@update to rspamd-1.0.6, from Brad
@
text
@d1 1
a1 1
$OpenBSD: patch-CMakeLists_txt,v 1.1.1.1 2015/10/09 16:09:17 sthen Exp $
d6 3
a8 3
--- CMakeLists.txt.orig	Thu Oct  8 13:36:31 2015
+++ CMakeLists.txt	Thu Oct 15 21:29:49 2015
@@@@ -468,6 +468,11 @@@@ IF(CMAKE_SYSTEM_NAME STREQUAL "FreeBSD")
d20 1
a20 1
@@@@ -583,7 +588,7 @@@@ ProcessPackage(PCRE LIBRARY pcre INCLUDE pcre.h INCLUD
d29 1
a29 1
@@@@ -1119,4 +1124,4 @@@@ ADD_CUSTOM_TARGET(dist ${CMAKE_SOURCE_DIR}/dist.sh
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
$OpenBSD$
d6 2
a7 2
--- CMakeLists.txt.orig	Sat Oct  3 11:08:21 2015
+++ CMakeLists.txt	Tue Oct  6 14:07:11 2015
d29 1
a29 1
@@@@ -1114,4 +1119,4 @@@@ ADD_CUSTOM_TARGET(dist ${CMAKE_SOURCE_DIR}/dist.sh
@


1.1.1.1
log
@import ports/mail/rspamd, joint work with brad - not yet perfect, but in
good enough shape to continue in tree.  tweak/ok giovanni@@.

Rspamd is an advanced spam filtering system that allows evaluation of messages
by a number of rules including regular expressions, statistical analysis and
custom services such as URL black lists. Each message is analysed by rspamd and
given a spam score.

According to this spam score and the user's settings rspamd recommends an action
for the MTA to apply to the message- for example to pass, reject or add a
header. Rspamd is designed to process hundreds of messages per second
simultaneously and has a number of features available.
@
text
@@
