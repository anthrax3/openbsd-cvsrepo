head	1.2;
access;
symbols
	OPENBSD_5_4:1.1.0.12
	OPENBSD_5_4_BASE:1.1
	OPENBSD_5_3:1.1.0.10
	OPENBSD_5_3_BASE:1.1
	OPENBSD_5_2:1.1.0.8
	OPENBSD_5_2_BASE:1.1
	OPENBSD_5_1_BASE:1.1
	OPENBSD_5_1:1.1.0.6
	OPENBSD_5_0:1.1.0.4
	OPENBSD_5_0_BASE:1.1
	OPENBSD_4_9:1.1.0.2;
locks; strict;
comment	@# @;


1.2
date	2013.11.06.17.26.08;	author okan;	state dead;
branches;
next	1.1;

1.1
date	2011.03.03.09.50.11;	author jasper;	state Exp;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2011.03.09.09.53.45;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.2
log
@update to 2.1.16

port-wise ok zhuk@@
@
text
@$OpenBSD: patch-Mailman_Cgi_confirm_py,v 1.1 2011/03/03 09:50:11 jasper Exp $

Security fix for CVE-2011-0707.
Mailman "Full Name" Script Insertion Vulnerabilities.

Patch from upstream announcement:
http://mail.python.org/pipermail/mailman-announce/2011-February/000158.html

--- Mailman/Cgi/confirm.py.orig	Mon Sep 20 20:18:27 2010
+++ Mailman/Cgi/confirm.py	Thu Mar  3 10:47:51 2011
@@@@ -471,7 +471,7 @@@@ def unsubscription_prompt(mlist, doc, cookie, addr):
     if fullname is None:
         fullname = _('<em>Not available</em>')
     else:
-        fullname = Utils.uncanonstr(fullname, lang)
+        fullname = Utils.websafe(Utils.uncanonstr(fullname, lang))
     table.AddRow([_("""Your confirmation is required in order to complete the
     unsubscription request from the mailing list <em>%(listname)s</em>.  You
     are currently subscribed with
@@@@ -573,7 +573,7 @@@@ def addrchange_prompt(mlist, doc, cookie, oldaddr, new
     if fullname is None:
         fullname = _('<em>Not available</em>')
     else:
-        fullname = Utils.uncanonstr(fullname, lang)
+        fullname = Utils.websafe(Utils.uncanonstr(fullname, lang))
     if globally:
         globallys = _('globally')
     else:
@@@@ -814,7 +814,7 @@@@ def reenable_prompt(mlist, doc, cookie, list, member):
     if username is None:
         username = _('<em>not available</em>')
     else:
-        username = Utils.uncanonstr(username, lang)
+        username = Utils.websafe(Utils.uncanonstr(username, lang))
 
     table.AddRow([_("""Your membership in the %(realname)s mailing list is
     currently disabled due to excessive bounces.  Your confirmation is
@


1.1
log
@Security fix for CVE-2011-0707.
Mailman "Full Name" Script Insertion Vulnerabilities.

Patch from upstream ML.
@
text
@d1 1
a1 1
$OpenBSD$
@


1.1.2.1
log
@Security fix for CVE-2011-0707.
Mailman "Full Name" Script Insertion Vulnerabilities.

Patch from upstream ML.
@
text
@d1 1
a1 1
$OpenBSD: patch-Mailman_Cgi_confirm_py,v 1.1 2011/03/03 09:50:11 jasper Exp $
@

