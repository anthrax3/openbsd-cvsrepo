head	1.12;
access;
symbols
	OPENBSD_5_9:1.11.0.2
	OPENBSD_5_9_BASE:1.11
	OPENBSD_5_8:1.11.0.4
	OPENBSD_5_8_BASE:1.11
	OPENBSD_5_7:1.10.0.18
	OPENBSD_5_7_BASE:1.10
	OPENBSD_5_6:1.10.0.16
	OPENBSD_5_6_BASE:1.10
	OPENBSD_5_5:1.10.0.14
	OPENBSD_5_5_BASE:1.10
	OPENBSD_5_4:1.10.0.12
	OPENBSD_5_4_BASE:1.10
	OPENBSD_5_3:1.10.0.10
	OPENBSD_5_3_BASE:1.10
	OPENBSD_5_2:1.10.0.8
	OPENBSD_5_2_BASE:1.10
	OPENBSD_5_1_BASE:1.10
	OPENBSD_5_1:1.10.0.6
	OPENBSD_5_0:1.10.0.4
	OPENBSD_5_0_BASE:1.10
	OPENBSD_4_9:1.10.0.2
	OPENBSD_4_9_BASE:1.10
	OPENBSD_4_8:1.9.0.4
	OPENBSD_4_8_BASE:1.9
	OPENBSD_4_7:1.9.0.2
	OPENBSD_4_7_BASE:1.9
	OPENBSD_4_6:1.8.0.2
	OPENBSD_4_6_BASE:1.8
	OPENBSD_4_5:1.7.0.14
	OPENBSD_4_5_BASE:1.7
	OPENBSD_4_4:1.7.0.12
	OPENBSD_4_4_BASE:1.7
	OPENBSD_4_3:1.7.0.10
	OPENBSD_4_3_BASE:1.7
	OPENBSD_4_2:1.7.0.8
	OPENBSD_4_2_BASE:1.7
	OPENBSD_4_1:1.7.0.6
	OPENBSD_4_1_BASE:1.7
	OPENBSD_4_0:1.7.0.4
	OPENBSD_4_0_BASE:1.7
	OPENBSD_3_9:1.7.0.2
	OPENBSD_3_9_BASE:1.7
	OPENBSD_3_8:1.6.0.2
	OPENBSD_3_8_BASE:1.6
	OPENBSD_3_7:1.5.0.6
	OPENBSD_3_7_BASE:1.5
	OPENBSD_3_6:1.5.0.4
	OPENBSD_3_6_BASE:1.5
	OPENBSD_3_5:1.5.0.2
	OPENBSD_3_5_BASE:1.5
	OPENBSD_3_4:1.4.0.2
	OPENBSD_3_4_BASE:1.4
	OPENBSD_3_3:1.2.0.2
	OPENBSD_3_3_BASE:1.2
	OPENBSD_3_2:1.1.1.1.0.6
	OPENBSD_3_2_BASE:1.1.1.1
	OPENBSD_3_1:1.1.1.1.0.4
	OPENBSD_3_1_BASE:1.1.1.1
	OPENBSD_3_0:1.1.1.1.0.2
	OPENBSD_3_0_BASE:1.1.1.1
	shell_2001-Aug-29:1.1.1.1
	shell:1.1.1;
locks; strict;
comment	@# @;


1.12
date	2016.04.22.16.42.14;	author okan;	state dead;
branches;
next	1.11;
commitid	kaceXXQSjpLKbHAT;

1.11
date	2015.04.09.15.37.08;	author okan;	state Exp;
branches;
next	1.10;
commitid	GSGfKXzFwFEulTbB;

1.10
date	2010.09.21.07.21.00;	author jasper;	state Exp;
branches;
next	1.9;

1.9
date	2010.01.12.19.06.06;	author okan;	state Exp;
branches;
next	1.8;

1.8
date	2009.05.02.09.56.44;	author djm;	state Exp;
branches;
next	1.7;

1.7
date	2005.11.11.20.33.26;	author sturm;	state Exp;
branches;
next	1.6;

1.6
date	2005.06.23.07.34.56;	author djm;	state Exp;
branches
	1.6.2.1;
next	1.5;

1.5
date	2003.10.09.15.39.33;	author sturm;	state Exp;
branches;
next	1.4;

1.4
date	2003.06.22.10.05.29;	author sturm;	state Exp;
branches
	1.4.2.1;
next	1.3;

1.3
date	2003.05.01.16.11.53;	author sturm;	state Exp;
branches;
next	1.2;

1.2
date	2003.01.18.16.52.17;	author sturm;	state Exp;
branches;
next	1.1;

1.1
date	2001.08.29.02.13.04;	author shell;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2001.08.29.02.13.04;	author shell;	state Exp;
branches;
next	;

1.4.2.1
date	2004.06.30.21.29.32;	author brad;	state Exp;
branches;
next	;

1.6.2.1
date	2005.11.12.11.26.56;	author sturm;	state Exp;
branches;
next	;


desc
@@


1.12
log
@- Update to 2.1.21.
- gc configure patch since it hasn't been required since introducing
  --without-permcheck in configure, despite the comment in Makefile.
- Some of Defaults.py are now upstream defaults.

Remove FLAVORs:
- Rewrite src/common.c:check_caller() for the cgi/mail wrapper to now
  look at the defined group membership instead, _mailmanq (a new group).
  This allows the administrator to switch mail servers and web servers
  without requiring a FLAVOR for each combination; but rather, by simply
  adding the cgi/mail user to the _mailmanq group. This is a diversion
  from upstream, but will be proposed. At least sthen@@ and dlg@@ agree to
  go in this general direction.
@
text
@$OpenBSD: patch-configure,v 1.11 2015/04/09 15:37:08 okan Exp $
--- configure.orig	Tue May  6 12:43:56 2014
+++ configure	Sun Jan 11 10:37:11 2015
@@@@ -3543,54 +3543,8 @@@@ USERNAME=$with_username
 { $as_echo "$as_me:${as_lineno-$LINENO}: result: $USERNAME" >&5
 $as_echo "$USERNAME" >&6; }
 
-# User `mailman' must exist
+MAILMAN_USER=$with_username
 
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for user name \"$USERNAME\"" >&5
-$as_echo_n "checking for user name \"$USERNAME\"... " >&6; }
-
-# MAILMAN_USER == variable name
-# $USERNAME == user id to check for
-
-
-if test -z "$MAILMAN_USER"
-then
-    cat > conftest.py <<EOF
-import pwd
-uid = ''
-for user in "$USERNAME".split():
-    try:
-        try:
-            uname = pwd.getpwuid(int(user))[0]
-            break
-        except ValueError:
-            uname = pwd.getpwnam(user)[0]
-            break
-    except KeyError:
-        uname = ''
-fp = open("conftest.out", "w")
-fp.write("%s\n" % uname)
-fp.close()
-EOF
-    $PYTHON conftest.py
-    MAILMAN_USER=`cat conftest.out`
-fi
-
-rm -f conftest.out conftest.py
-if test -z "$MAILMAN_USER"
-then
-  if test "$with_permcheck" = "yes"
-  then
-    as_fn_error $? "
-***** No \"$USERNAME\" user found!
-***** Your system must have a \"$USERNAME\" user defined
-***** (usually in your /etc/passwd file).  Please see the INSTALL
-***** file for details." "$LINENO" 5
-  fi
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: okay" >&5
-$as_echo "okay" >&6; }
-
-
 # Check for some other gid to use than `mailman'
 { $as_echo "$as_me:${as_lineno-$LINENO}: checking for --with-groupname" >&5
 $as_echo_n "checking for --with-groupname... " >&6; }
@@@@ -3609,54 +3563,7 @@@@ GROUPNAME=$with_groupname
 { $as_echo "$as_me:${as_lineno-$LINENO}: result: $GROUPNAME" >&5
 $as_echo "$GROUPNAME" >&6; }
 
-
-# Target group must exist
-
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for group name \"$GROUPNAME\"" >&5
-$as_echo_n "checking for group name \"$GROUPNAME\"... " >&6; }
-
-# MAILMAN_GROUP == variable name
-# $GROUPNAME == user id to check for
-
-
-if test -z "$MAILMAN_GROUP"
-then
-    cat > conftest.py <<EOF
-import grp
-gid = ''
-for group in "$GROUPNAME".split():
-    try:
-        try:
-            gname = grp.getgrgid(int(group))[0]
-            break
-        except ValueError:
-            gname = grp.getgrnam(group)[0]
-            break
-    except KeyError:
-        gname = ''
-fp = open("conftest.out", "w")
-fp.write("%s\n" % gname)
-fp.close()
-EOF
-    $PYTHON conftest.py
-    MAILMAN_GROUP=`cat conftest.out`
-fi
-
-rm -f conftest.out conftest.py
-if test -z "$MAILMAN_GROUP"
-then
-  if test "$with_permcheck" = "yes"
-  then
-    as_fn_error $? "
-***** No \"$GROUPNAME\" group found!
-***** Your system must have a \"$GROUPNAME\" group defined
-***** (usually in your /etc/group file).  Please see the INSTALL
-***** file for details." "$LINENO" 5
-  fi
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: okay" >&5
-$as_echo "okay" >&6; }
-
+MAILMAN_GROUP=$with_groupname
 
 { $as_echo "$as_me:${as_lineno-$LINENO}: checking permissions on $prefixcheck" >&5
 $as_echo_n "checking permissions on $prefixcheck... " >&6; }
@


1.11
log
@update to 2.1.20; includes fix for CVE-2015-2775.

feeback ajacoutot; feedback and ok jca
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.10 2010/09/21 07:21:00 jasper Exp $
@


1.10
log
@- SECURITY UPDATE of mailman to 2.1.14
Fixes CVE-2010-3089: Mailman List Description Two Script Insertion Vulnerabilities

ok sthen@@
@
text
@d1 5
a5 6
$OpenBSD: patch-configure,v 1.9 2010/01/12 19:06:06 okan Exp $
--- configure.orig	Mon Sep 20 23:33:13 2010
+++ configure	Mon Sep 20 23:34:51 2010
@@@@ -3372,61 +3372,8 @@@@ fi
 USERNAME=$with_username
 { $as_echo "$as_me:$LINENO: result: $USERNAME" >&5
d7 2
d11 1
a11 3
-# User `mailman' must exist
-
-{ $as_echo "$as_me:$LINENO: checking for user name \"$USERNAME\"" >&5
d46 1
a46 6
-    { { $as_echo "$as_me:$LINENO: error:
-***** No \"$USERNAME\" user found!
-***** Your system must have a \"$USERNAME\" user defined
-***** (usually in your /etc/passwd file).  Please see the INSTALL
-***** file for details." >&5
-$as_echo "$as_me: error:
d50 1
a50 2
-***** file for details." >&2;}
-   { (exit 1); exit 1; }; }
d53 1
a53 1
-{ $as_echo "$as_me:$LINENO: result: okay" >&5
d58 1
a58 1
 { $as_echo "$as_me:$LINENO: checking for --with-groupname" >&5
d60 2
a61 1
@@@@ -3446,58 +3393,7 @@@@ GROUPNAME=$with_groupname
d64 1
a64 1
 
d67 1
a67 1
-{ $as_echo "$as_me:$LINENO: checking for group name \"$GROUPNAME\"" >&5
d102 1
a102 1
-    { { $as_echo "$as_me:$LINENO: error:
d106 1
a106 7
-***** file for details." >&5
-$as_echo "$as_me: error:
-***** No \"$GROUPNAME\" group found!
-***** Your system must have a \"$GROUPNAME\" group defined
-***** (usually in your /etc/group file).  Please see the INSTALL
-***** file for details." >&2;}
-   { (exit 1); exit 1; }; }
d109 1
a109 1
-{ $as_echo "$as_me:$LINENO: result: okay" >&5
d111 1
d114 2
a115 2
 
 { $as_echo "$as_me:$LINENO: checking permissions on $prefixcheck" >&5
@


1.9
log
@remove the group check completely, mirroring what was done for
MAILMAN_USER - allows for a build and package without having
_mailman:_mailman user and group

ok stephan@@
@
text
@d1 4
a4 4
$OpenBSD: patch-configure,v 1.8 2009/05/02 09:56:44 djm Exp $
--- configure.orig	Mon Feb 23 16:23:35 2009
+++ configure	Mon Jan  4 12:01:38 2010
@@@@ -3178,61 +3178,8 @@@@ fi
d6 2
a7 2
 { echo "$as_me:$LINENO: result: $USERNAME" >&5
 echo "${ECHO_T}$USERNAME" >&6; }
d12 2
a13 2
-{ echo "$as_me:$LINENO: checking for user name \"$USERNAME\"" >&5
-echo $ECHO_N "checking for user name \"$USERNAME\"... $ECHO_C" >&6; }
d47 1
a47 1
-    { { echo "$as_me:$LINENO: error:
d52 1
a52 1
-echo "$as_me: error:
d60 2
a61 2
-{ echo "$as_me:$LINENO: result: okay" >&5
-echo "${ECHO_T}okay" >&6; }
d65 6
a70 8
 { echo "$as_me:$LINENO: checking for --with-groupname" >&5
 echo $ECHO_N "checking for --with-groupname... $ECHO_C" >&6; }
@@@@ -3250,61 +3197,7 @@@@ fi
 GROUPNAME=$with_groupname
 { echo "$as_me:$LINENO: result: $GROUPNAME" >&5
 echo "${ECHO_T}$GROUPNAME" >&6; }
-
-
d73 2
a74 2
-{ echo "$as_me:$LINENO: checking for group name \"$GROUPNAME\"" >&5
-echo $ECHO_N "checking for group name \"$GROUPNAME\"... $ECHO_C" >&6; }
d108 1
a108 1
-    { { echo "$as_me:$LINENO: error:
d113 1
a113 1
-echo "$as_me: error:
d121 2
a122 3
-{ echo "$as_me:$LINENO: result: okay" >&5
-echo "${ECHO_T}okay" >&6; }
-
d125 2
a126 2
 { echo "$as_me:$LINENO: checking permissions on $prefixcheck" >&5
 echo $ECHO_N "checking permissions on $prefixcheck... $ECHO_C" >&6; }
@


1.8
log
@mailman-2.1.12; ok MAINTAINER mbalmer@@
@
text
@d1 4
a4 4
$OpenBSD: patch-configure,v 1.7 2005/11/11 20:33:26 sturm Exp $
--- configure.orig	Tue Feb 24 08:23:35 2009
+++ configure	Sat Apr 25 12:02:36 2009
@@@@ -3178,60 +3178,7 @@@@ fi
d8 2
a9 1
-
d63 1
a63 2
+MAILMAN_USER=$with_username
 
d66 64
@


1.7
log
@do not check for the existence of _mailman:_mailman at configure time,
that user/group might not exist yet

noticed by Chris Mika <cmika at seenothing.org>
maintainer timeout
@
text
@d1 4
a4 5
$OpenBSD: patch-configure,v 1.6 2005/06/23 07:34:56 djm Exp $
--- configure.orig	Fri Dec 31 00:41:08 2004
+++ configure	Fri Nov 11 21:27:15 2005
@@@@ -1205,54 +1205,8 @@@@ then
 fi
d6 3
a8 3
 echo "$ac_t""$USERNAME" 1>&6
+MAILMAN_USER=$with_username
 
d11 2
a12 2
-echo $ac_n "checking for user name \"$USERNAME\"""... $ac_c" 1>&6
-echo "configure:1213: checking for user name \"$USERNAME\"" >&5
d46 6
a51 1
-    { echo "configure: error: 
d55 2
a56 1
-***** file for details." 1>&2; exit 1; }
d59 2
a60 2
-echo "$ac_t""okay" 1>&6
-
d62 2
d65 1
a65 68
 echo $ac_n "checking for --with-groupname""... $ac_c" 1>&6
 echo "configure:1259: checking for --with-groupname" >&5
@@@@ -1269,55 +1223,10 @@@@ then
 fi
 GROUPNAME=$with_groupname
 echo "$ac_t""$GROUPNAME" 1>&6
+MAILMAN_GROUP=$with_groupname
 
 
-# Target group must exist
 
-echo $ac_n "checking for group name \"$GROUPNAME\"""... $ac_c" 1>&6
-echo "configure:1278: checking for group name \"$GROUPNAME\"" >&5
-
-# MAILMAN_GROUP == variable name
-# $GROUPNAME == user id to check for
-
-
-if test -z "$MAILMAN_GROUP"
-then
-    cat > conftest.py <<EOF
-import grp
-gid = ''
-for group in "$GROUPNAME".split():
-    try:
-        try:
-            gname = grp.getgrgid(int(group))[0]
-            break
-        except ValueError:
-            gname = grp.getgrnam(group)[0]
-            break
-    except KeyError:
-        gname = ''
-fp = open("conftest.out", "w")
-fp.write("%s\n" % gname)
-fp.close()
-EOF
-    $PYTHON conftest.py
-    MAILMAN_GROUP=`cat conftest.out`
-fi
-
-rm -f conftest.out conftest.py
-if test -z "$MAILMAN_GROUP"
-then
-  if test "$with_permcheck" = "yes"
-  then
-    { echo "configure: error: 
-***** No \"$GROUPNAME\" group found!
-***** Your system must have a \"$GROUPNAME\" group defined
-***** (usually in your /etc/group file).  Please see the INSTALL
-***** file for details." 1>&2; exit 1; }
-  fi
-fi
-echo "$ac_t""okay" 1>&6
-
-
 echo $ac_n "checking permissions on $prefixcheck""... $ac_c" 1>&6
 echo "configure:1323: checking permissions on $prefixcheck" >&5
 
@@@@ -1579,7 +1488,7 @@@@ echo "$ac_t""$URLHOST" 1>&6
 rm -f conftest.out conftest.py
 
 # Checks for libraries.
-for ac_func in strerror setregid syslog
+for ac_func in strerror syslog
 do
 echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
 echo "configure:1586: checking for $ac_func" >&5
@


1.6
log
@mailman-2.16; ok jakob@@
@
text
@d1 117
a117 4
$OpenBSD: patch-configure,v 1.5 2003/10/09 15:39:33 sturm Exp $
--- configure.orig	Fri Dec 31 10:41:08 2004
+++ configure	Fri Jun 10 08:04:20 2005
@@@@ -1579,7 +1579,7 @@@@ echo "$ac_t""$URLHOST" 1>&6
@


1.6.2.1
log
@MFC:
do not check for the existence of _mailman:_mailman at configure time,
that user/group might not exist yet
@
text
@d1 4
a4 117
$OpenBSD: patch-configure,v 1.7 2005/11/11 20:33:26 sturm Exp $
--- configure.orig	Fri Dec 31 00:41:08 2004
+++ configure	Fri Nov 11 21:27:15 2005
@@@@ -1205,54 +1205,8 @@@@ then
 fi
 USERNAME=$with_username
 echo "$ac_t""$USERNAME" 1>&6
+MAILMAN_USER=$with_username
 
-# User `mailman' must exist
-
-echo $ac_n "checking for user name \"$USERNAME\"""... $ac_c" 1>&6
-echo "configure:1213: checking for user name \"$USERNAME\"" >&5
-
-# MAILMAN_USER == variable name
-# $USERNAME == user id to check for
-
-
-if test -z "$MAILMAN_USER"
-then
-    cat > conftest.py <<EOF
-import pwd
-uid = ''
-for user in "$USERNAME".split():
-    try:
-        try:
-            uname = pwd.getpwuid(int(user))[0]
-            break
-        except ValueError:
-            uname = pwd.getpwnam(user)[0]
-            break
-    except KeyError:
-        uname = ''
-fp = open("conftest.out", "w")
-fp.write("%s\n" % uname)
-fp.close()
-EOF
-    $PYTHON conftest.py
-    MAILMAN_USER=`cat conftest.out`
-fi
-
-rm -f conftest.out conftest.py
-if test -z "$MAILMAN_USER"
-then
-  if test "$with_permcheck" = "yes"
-  then
-    { echo "configure: error: 
-***** No \"$USERNAME\" user found!
-***** Your system must have a \"$USERNAME\" user defined
-***** (usually in your /etc/passwd file).  Please see the INSTALL
-***** file for details." 1>&2; exit 1; }
-  fi
-fi
-echo "$ac_t""okay" 1>&6
-
-
 # Check for some other gid to use than `mailman'
 echo $ac_n "checking for --with-groupname""... $ac_c" 1>&6
 echo "configure:1259: checking for --with-groupname" >&5
@@@@ -1269,55 +1223,10 @@@@ then
 fi
 GROUPNAME=$with_groupname
 echo "$ac_t""$GROUPNAME" 1>&6
+MAILMAN_GROUP=$with_groupname
 
 
-# Target group must exist
 
-echo $ac_n "checking for group name \"$GROUPNAME\"""... $ac_c" 1>&6
-echo "configure:1278: checking for group name \"$GROUPNAME\"" >&5
-
-# MAILMAN_GROUP == variable name
-# $GROUPNAME == user id to check for
-
-
-if test -z "$MAILMAN_GROUP"
-then
-    cat > conftest.py <<EOF
-import grp
-gid = ''
-for group in "$GROUPNAME".split():
-    try:
-        try:
-            gname = grp.getgrgid(int(group))[0]
-            break
-        except ValueError:
-            gname = grp.getgrnam(group)[0]
-            break
-    except KeyError:
-        gname = ''
-fp = open("conftest.out", "w")
-fp.write("%s\n" % gname)
-fp.close()
-EOF
-    $PYTHON conftest.py
-    MAILMAN_GROUP=`cat conftest.out`
-fi
-
-rm -f conftest.out conftest.py
-if test -z "$MAILMAN_GROUP"
-then
-  if test "$with_permcheck" = "yes"
-  then
-    { echo "configure: error: 
-***** No \"$GROUPNAME\" group found!
-***** Your system must have a \"$GROUPNAME\" group defined
-***** (usually in your /etc/group file).  Please see the INSTALL
-***** file for details." 1>&2; exit 1; }
-  fi
-fi
-echo "$ac_t""okay" 1>&6
-
-
 echo $ac_n "checking permissions on $prefixcheck""... $ac_c" 1>&6
 echo "configure:1323: checking permissions on $prefixcheck" >&5
 
@@@@ -1579,7 +1488,7 @@@@ echo "$ac_t""$URLHOST" 1>&6
@


1.5
log
@- update to mailman 2.1.3
- drop maintainership
- use @@extra
- get rid of WWW while here
@
text
@d1 5
a5 143
$OpenBSD: patch-configure,v 1.4 2003/06/22 10:05:29 sturm Exp $
--- configure.orig	2003-09-22 04:54:04.000000000 +0200
+++ configure	2003-09-30 22:23:40.000000000 +0200
@@@@ -2631,65 +2631,13 @@@@ fi;
 
 if test -z "$with_username"
 then
-        with_username="mailman"
+        with_username="_mailman"
 fi
 USERNAME=$with_username
 echo "$as_me:$LINENO: result: $USERNAME" >&5
 echo "${ECHO_T}$USERNAME" >&6
 
-# User `mailman' must exist
-
-echo "$as_me:$LINENO: checking for user name \"$USERNAME\"" >&5
-echo $ECHO_N "checking for user name \"$USERNAME\"... $ECHO_C" >&6
-
-# MAILMAN_USER == variable name
-# $USERNAME == user id to check for
-
-
-if test -z "$MAILMAN_USER"
-then
-    cat > conftest.py <<EOF
-import pwd
-uid = ''
-for user in "$USERNAME".split():
-    try:
-        try:
-            uname = pwd.getpwuid(int(user))[0]
-            break
-        except ValueError:
-            uname = pwd.getpwnam(user)[0]
-            break
-    except KeyError:
-        uname = ''
-fp = open("conftest.out", "w")
-fp.write("%s\n" % uname)
-fp.close()
-EOF
-    $PYTHON conftest.py
-    MAILMAN_USER=`cat conftest.out`
-fi
-
-rm -f conftest.out conftest.py
-if test -z "$MAILMAN_USER"
-then
-  if test "$with_permcheck" = "yes"
-  then
-    { { echo "$as_me:$LINENO: error:
-***** No \"$USERNAME\" user found!
-***** Your system must have a \"$USERNAME\" user defined
-***** (usually in your /etc/passwd file).  Please see the INSTALL
-***** file for details." >&5
-echo "$as_me: error:
-***** No \"$USERNAME\" user found!
-***** Your system must have a \"$USERNAME\" user defined
-***** (usually in your /etc/passwd file).  Please see the INSTALL
-***** file for details." >&2;}
-   { (exit 1); exit 1; }; }
-  fi
-fi
-echo "$as_me:$LINENO: result: okay" >&5
-echo "${ECHO_T}okay" >&6
-
+MAILMAN_USER=_mailman
 
 # Check for some other gid to use than `mailman'
 echo "$as_me:$LINENO: checking for --with-groupname" >&5
@@@@ -2703,66 +2651,13 @@@@ fi;
 
 if test -z "$with_groupname"
 then
-        with_groupname="mailman"
+        with_groupname="_mailman"
 fi
 GROUPNAME=$with_groupname
 echo "$as_me:$LINENO: result: $GROUPNAME" >&5
 echo "${ECHO_T}$GROUPNAME" >&6
 
-
-# Target group must exist
-
-echo "$as_me:$LINENO: checking for group name \"$GROUPNAME\"" >&5
-echo $ECHO_N "checking for group name \"$GROUPNAME\"... $ECHO_C" >&6
-
-# MAILMAN_GROUP == variable name
-# $GROUPNAME == user id to check for
-
-
-if test -z "$MAILMAN_GROUP"
-then
-    cat > conftest.py <<EOF
-import grp
-gid = ''
-for group in "$GROUPNAME".split():
-    try:
-        try:
-            gname = grp.getgrgid(int(group))[0]
-            break
-        except ValueError:
-            gname = grp.getgrnam(group)[0]
-            break
-    except KeyError:
-        gname = ''
-fp = open("conftest.out", "w")
-fp.write("%s\n" % gname)
-fp.close()
-EOF
-    $PYTHON conftest.py
-    MAILMAN_GROUP=`cat conftest.out`
-fi
-
-rm -f conftest.out conftest.py
-if test -z "$MAILMAN_GROUP"
-then
-  if test "$with_permcheck" = "yes"
-  then
-    { { echo "$as_me:$LINENO: error:
-***** No \"$GROUPNAME\" group found!
-***** Your system must have a \"$GROUPNAME\" group defined
-***** (usually in your /etc/group file).  Please see the INSTALL
-***** file for details." >&5
-echo "$as_me: error:
-***** No \"$GROUPNAME\" group found!
-***** Your system must have a \"$GROUPNAME\" group defined
-***** (usually in your /etc/group file).  Please see the INSTALL
-***** file for details." >&2;}
-   { (exit 1); exit 1; }; }
-  fi
-fi
-echo "$as_me:$LINENO: result: okay" >&5
-echo "${ECHO_T}okay" >&6
-
+MAILMAN_GROUP=_mailman
 
 echo "$as_me:$LINENO: checking permissions on $prefixcheck" >&5
 echo $ECHO_N "checking permissions on $prefixcheck... $ECHO_C" >&6
@@@@ -3057,7 +2952,7 @@@@ rm -f conftest.out conftest.py
 
 
d7 1
d11 2
a12 2
 as_ac_var=`echo "ac_cv_func_$ac_func" | $as_tr_sh`
 echo "$as_me:$LINENO: checking for $ac_func" >&5
@


1.4
log
@new user/group naming schema

bumped PKGNAME except for xcept
@
text
@d1 10
a10 4
$OpenBSD: patch-configure,v 1.3 2003/05/01 16:11:53 sturm Exp $
--- configure.orig	Tue Apr 22 05:34:49 2003
+++ configure	Thu May  1 12:23:55 2003
@@@@ -1206,52 +1206,7 @@@@ fi
d12 2
a13 1
 echo "$ac_t""$USERNAME" 1>&6
d17 2
a18 2
-echo $ac_n "checking for user name \"$USERNAME\"""... $ac_c" 1>&6
-echo "configure:1213: checking for user name \"$USERNAME\"" >&5
d52 1
a52 1
-    { echo "configure: error: 
d56 7
a62 1
-***** file for details." 1>&2; exit 1; }
d65 2
a66 1
-echo "$ac_t""okay" 1>&6
d71 8
a78 2
 echo $ac_n "checking for --with-groupname""... $ac_c" 1>&6
@@@@ -1270,107 +1225,7 @@@@ fi
d80 2
a81 1
 echo "$ac_t""$GROUPNAME" 1>&6
d86 2
a87 2
-echo $ac_n "checking for group name \"$GROUPNAME\"""... $ac_c" 1>&6
-echo "configure:1278: checking for group name \"$GROUPNAME\"" >&5
d121 1
a121 1
-    { echo "configure: error: 
d125 7
a131 1
-***** file for details." 1>&2; exit 1; }
d134 2
a135 55
-echo "$ac_t""okay" 1>&6
-
-
-echo $ac_n "checking permissions on $prefixcheck""... $ac_c" 1>&6
-echo "configure:1323: checking permissions on $prefixcheck" >&5
-
-cat > conftest.py <<EOF
-import os, grp
-from stat import *
-prefix = "$prefixcheck"
-groupname = "$GROUPNAME"
-mailmangroup = "$MAILMAN_GROUP"
-try:
-    mailmangid = grp.getgrnam(mailmangroup)[2]
-except KeyError:
-    mailmangid = -1
-problems = []
-try: statdata = os.stat(prefix)
-except OSError:
-    problems.append("Directory doesn't exist: " + prefix)
-else:
-    mode = statdata[ST_MODE]
-    gid = statdata[ST_GID]
-    if mailmangid <> gid:
-        problems.append("Directory must be owned by group " +
-                        groupname + ": " + prefix)
-    if (mode & S_ISGID) <> S_ISGID:
-        problems.append("Set-gid bit must be set for directory: " + prefix)
-    perms = S_IRWXU | S_IRWXG | S_IROTH | S_IXOTH
-    if (mode & perms) <> perms:
-        problems.append("Permissions should be at least 02775: " + prefix)
-if not problems:
-    msg = "okay\n"
-else:
-    msg = '***** ' + '\n***** '.join(problems) + '\n'
-fp = open("conftest.out", "w")
-fp.write(msg)
-fp.close()
-EOF
-
-$PYTHON conftest.py
-status=`cat conftest.out`
-rm -f conftest.out conftest.py
-if test "$with_permcheck" = "yes"
-then
-    if test "$status" != "okay"
-    then
-        { echo "configure: error: 
-***** Installation directory $prefixcheck is not configured properly!
-$status" 1>&2; exit 1; }
-    fi
-else
-    status="skipped"
-fi
-echo "$ac_t""$status" 1>&6
d139 5
a143 4
 # Now find the UIDs and GIDs
 # Support --with-mail-gid and --with-cgi-gid
@@@@ -1579,7 +1434,7 @@@@ echo "$ac_t""$URLHOST" 1>&6
 rm -f conftest.out conftest.py
a144 1
 # Checks for libraries.
d148 2
a149 2
 echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
 echo "configure:1586: checking for $ac_func" >&5
@


1.4.2.1
log
@MFC:
update to mailman v2.1.5
@
text
@d1 4
a4 10
$OpenBSD: patch-configure,v 1.5 2003/10/09 15:39:33 sturm Exp $
--- configure.orig	2003-09-22 04:54:04.000000000 +0200
+++ configure	2003-09-30 22:23:40.000000000 +0200
@@@@ -2631,65 +2631,13 @@@@ fi;
 
 if test -z "$with_username"
 then
-        with_username="mailman"
+        with_username="_mailman"
 fi
d6 1
a6 2
 echo "$as_me:$LINENO: result: $USERNAME" >&5
 echo "${ECHO_T}$USERNAME" >&6
d10 2
a11 2
-echo "$as_me:$LINENO: checking for user name \"$USERNAME\"" >&5
-echo $ECHO_N "checking for user name \"$USERNAME\"... $ECHO_C" >&6
d45 1
a45 1
-    { { echo "$as_me:$LINENO: error:
d49 1
a49 7
-***** file for details." >&5
-echo "$as_me: error:
-***** No \"$USERNAME\" user found!
-***** Your system must have a \"$USERNAME\" user defined
-***** (usually in your /etc/passwd file).  Please see the INSTALL
-***** file for details." >&2;}
-   { (exit 1); exit 1; }; }
d52 1
a52 2
-echo "$as_me:$LINENO: result: okay" >&5
-echo "${ECHO_T}okay" >&6
d57 2
a58 8
 echo "$as_me:$LINENO: checking for --with-groupname" >&5
@@@@ -2703,66 +2651,13 @@@@ fi;
 
 if test -z "$with_groupname"
 then
-        with_groupname="mailman"
+        with_groupname="_mailman"
 fi
d60 1
a60 2
 echo "$as_me:$LINENO: result: $GROUPNAME" >&5
 echo "${ECHO_T}$GROUPNAME" >&6
d65 2
a66 2
-echo "$as_me:$LINENO: checking for group name \"$GROUPNAME\"" >&5
-echo $ECHO_N "checking for group name \"$GROUPNAME\"... $ECHO_C" >&6
d100 1
a100 1
-    { { echo "$as_me:$LINENO: error:
d104 1
a104 7
-***** file for details." >&5
-echo "$as_me: error:
-***** No \"$GROUPNAME\" group found!
-***** Your system must have a \"$GROUPNAME\" group defined
-***** (usually in your /etc/group file).  Please see the INSTALL
-***** file for details." >&2;}
-   { (exit 1); exit 1; }; }
d107 55
a161 2
-echo "$as_me:$LINENO: result: okay" >&5
-echo "${ECHO_T}okay" >&6
d165 4
a168 5
 echo "$as_me:$LINENO: checking permissions on $prefixcheck" >&5
 echo $ECHO_N "checking permissions on $prefixcheck... $ECHO_C" >&6
@@@@ -3057,7 +2952,7 @@@@ rm -f conftest.out conftest.py
 
 
d170 1
d174 2
a175 2
 as_ac_var=`echo "ac_cv_func_$ac_func" | $as_tr_sh`
 echo "$as_me:$LINENO: checking for $ac_func" >&5
@


1.3
log
@update to mailman 2.1.2

- lots of bugfixes
- support for portuguese and polish

heads up and some testing by jakob
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.2 2003/01/18 16:52:17 sturm Exp $
d54 1
a54 1
+MAILMAN_USER=mailman
d163 1
a163 1
+MAILMAN_GROUP=mailman
@


1.2
log
@update to mailman 2.1

- multi-lingual support
- list creation/removal through web interface
- MIME base content filtering (demime et.al.)
- new architecture of mail delivery subsystem
- better, faster, cheaper, ... ;-)

naddy@@ OK
@
text
@d1 3
a3 3
$OpenBSD$
--- configure.orig	Thu Jan  2 18:30:06 2003
+++ configure	Thu Jan  2 18:32:42 2003
d58 1
a58 1
@@@@ -1270,104 +1225,7 @@@@ fi
d119 4
a122 1
-mailmangid = grp.getgrnam(mailmangroup)[2]
d167 1
a167 1
@@@@ -1576,7 +1434,7 @@@@ echo "$ac_t""$URLHOST" 1>&6
d175 1
a175 1
 echo "configure:1583: checking for $ac_func" >&5
@


1.1
log
@Initial revision
@
text
@d2 3
a4 4
--- configure.orig	Fri Sep 22 18:56:44 2000
+++ configure	Tue Aug 21 19:08:08 2001
@@@@ -1137,50 +1137,7 @@@@ then
 fi
d7 1
a7 1
-
d10 2
a11 2
-echo $ac_n "checking for $USERNAME UID""... $ac_c" 1>&6
-echo "configure:1145: checking for $USERNAME UID" >&5
d13 1
a13 1
-# MAILMAN_UID == variable name
d17 1
a17 1
-if test -z "$MAILMAN_UID"
d20 1
a20 1
-import pwd, string
d22 1
a22 1
-for user in string.split("$USERNAME"):
d25 5
a29 5
-	    uid = pwd.getpwuid(int(user))[2]
-	    break
-	except ValueError:
-	    uid = pwd.getpwnam(user)[2]
-	    break
d31 1
a31 1
-        uid = ''
d33 1
a33 1
-fp.write("%s\n" % uid)
d37 1
a37 1
-    MAILMAN_UID=`cat conftest.out`
a39 1
-echo "$ac_t""$MAILMAN_UID" 1>&6
d41 1
a41 1
-if test -z "$MAILMAN_UID"
d43 2
d50 1
d52 1
d54 1
a54 1
+MAILMAN_UID=-1
d58 1
a58 2
@@@@ -1198,106 +1155,7 @@@@ then
 fi
d61 1
d63 1
d65 2
a66 1
-# Group `mailman' must exist
d68 1
a68 4
-echo $ac_n "checking for $GROUPNAME GID""... $ac_c" 1>&6
-echo "configure:1207: checking for $GROUPNAME GID" >&5
-
-# MAILMAN_GID == variable name
d72 1
a72 1
-if test -z "$MAILMAN_GID"
d75 1
a75 1
-import grp, string
d77 1
a77 1
-for group in string.split("$GROUPNAME"):
d80 5
a84 5
-	    gid = grp.getgrgid(int(group))[2]
-	    break
-	except ValueError:
-	    gid = grp.getgrnam(group)[2]
-	    break
d86 1
a86 1
-        gid = ''
d88 1
a88 1
-fp.write("%s\n" % gid)
d92 1
a92 1
-    MAILMAN_GID=`cat conftest.out`
a94 1
-echo "$ac_t""$MAILMAN_GID" 1>&6
d96 1
a96 1
-if test -z "$MAILMAN_GID"
d98 2
d105 1
d107 1
a109 11
-# Now make sure that $prefix is set up correctly.  It must be group
-# owned by `mailman', it must have the group sticky bit set, and it
-# must be a+rx
-if test "$VAR_PREFIX" = "NONE"
-then
-    VAR_PREFIX=$ac_default_prefix
-    prefixcheck=$ac_default_prefix
-else
-    prefixcheck=$VAR_PREFIX
-fi
-
d111 1
a111 1
-echo "configure:1260: checking permissions on $prefixcheck" >&5
d114 1
a114 1
-import os, grp, string
d117 3
a119 1
-mailmangid = $MAILMAN_GID
d122 1
a122 1
-except os.error:
d124 1
a124 1
-else:    
d128 2
a129 1
-	problems.append("Directory must be owned by group mailman: " + prefix)
d131 1
a131 1
-	problems.append("Set-gid bit must be set for directory: " +prefix)
d134 1
a134 1
-	problems.append("Permissions should be at least 02775: " + prefix)
d138 1
a138 1
-    msg = '***** ' + string.join(problems, '\n***** ') + '\n'
d147 1
a147 1
-if test "$status" != "okay"
d149 3
a151 1
-    { echo "configure: error: 
d154 3
d158 1
d160 1
a160 3
-echo "$ac_t""okay" 1>&6
-
+MAILMAN_GID=-1
d164 1
a164 1
@@@@ -1496,7 +1354,7 @@@@ echo "$ac_t""$URL" 1>&6
d172 1
a172 1
 echo "configure:1503: checking for $ac_func" >&5
@


1.1.1.1
log
@Initial import of mailman

Submitted by Nikolay Sturm <nikolay.sturm@@desy.de>
---

This is GNU Mailman, a mailing list management system distributed
under the GNU Public License (GPL).

Mailman has most of the standard features you'd expect in a
mailing list manager, and more.

@
text
@@
