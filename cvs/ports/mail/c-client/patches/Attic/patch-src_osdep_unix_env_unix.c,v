head	1.7;
access;
symbols
	OPENBSD_3_5:1.6.0.6
	OPENBSD_3_5_BASE:1.6
	OPENBSD_3_4:1.6.0.4
	OPENBSD_3_4_BASE:1.6
	OPENBSD_3_3:1.6.0.2
	OPENBSD_3_3_BASE:1.6
	OPENBSD_3_2:1.5.0.2
	OPENBSD_3_2_BASE:1.5
	OPENBSD_3_1:1.4.0.2
	OPENBSD_3_1_BASE:1.4
	OPENBSD_3_0:1.3.0.2
	OPENBSD_3_0_BASE:1.3
	OPENBSD_2_9_TRACKING_SWITCH:1.2
	OPENBSD_2_9:1.2.0.2
	OPENBSD_2_9_BASE:1.2
	OPENBSD_2_8:1.1.0.2;
locks; strict;
comment	@ * @;


1.7
date	2004.04.02.08.18.48;	author jakob;	state dead;
branches;
next	1.6;

1.6
date	2002.12.01.21.15.38;	author jakob;	state Exp;
branches;
next	1.5;

1.5
date	2002.07.09.19.34.49;	author jakob;	state Exp;
branches;
next	1.4;

1.4
date	2001.11.19.01.56.13;	author brad;	state Exp;
branches;
next	1.3;

1.3
date	2001.09.27.16.28.09;	author brad;	state Exp;
branches
	1.3.2.1;
next	1.2;

1.2
date	2001.01.19.01.05.06;	author brad;	state Exp;
branches;
next	1.1;

1.1
date	2000.12.12.17.28.11;	author brad;	state Exp;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2001.01.18.19.06.10;	author brad;	state Exp;
branches;
next	1.1.2.2;

1.1.2.2
date	2001.01.19.01.11.56;	author brad;	state Exp;
branches;
next	;

1.3.2.1
date	2002.01.16.23.52.07;	author brad;	state Exp;
branches;
next	;


desc
@@


1.7
log
@sync c-client with pine v4.58
@
text
@$OpenBSD: patch-src_osdep_unix_env_unix.c,v 1.6 2002/12/01 21:15:38 jakob Exp $
--- src/osdep/unix/env_unix.c.orig	Wed Oct 30 18:06:12 2002
+++ src/osdep/unix/env_unix.c	Mon Nov 25 20:06:58 2002
@@@@ -773,14 +773,12 @@@@ char *myhomedir ()
 static char *mymailboxdir ()
 {
   char *home = myhomedir ();
-  if (!myMailboxDir && home) {	/* initialize if first time */
     if (mailsubdir) {
       char tmp[MAILTMPLEN];
       sprintf (tmp,"%s/%s",home,mailsubdir);
       myMailboxDir = cpystr (tmp);/* use pre-defined subdirectory of home */
     }
     else myMailboxDir = cpystr (home);
-  }
   return myMailboxDir ? myMailboxDir : "";
 }
 
@@@@ -1036,7 +1034,8 @@@@ long dotlock_lock (char *file,DOTLOCK *b
       }
       close (pi[0]); close (pi[1]);
     }
-    if (lockEaccesError) {	/* punt silently if paranoid site */
+    if (strncmp(base->lock,"/var/mail/",10) && lockEaccesError) {
+	/* punt silently if paranoid site */
       sprintf (tmp,"Mailbox vulnerable - directory %.80s",base->lock);
       if (s = strrchr (tmp,'/')) *s = '\0';
       strcat (tmp," must have 1777 protection");
@


1.6
log
@update to c-client v4.50. mostly work by thorsten glaser.
@
text
@d1 1
a1 1
$OpenBSD: patch-src_osdep_unix_env_unix.c,v$
@


1.5
log
@add patch to fix blackbox mode. ok brad@@
@
text
@d1 4
a4 5
$OpenBSD: patch-src_osdep_unix_env_unix.c,v 1.1 2001/09/24 22:01:49 jakob Exp $

--- src/osdep/unix/env_unix.c.orig	Thu Dec 21 01:12:13 2000
+++ src/osdep/unix/env_unix.c	Thu Jan 18 16:11:09 2001
@@@@ -767,14 +767,12 @@@@
d18 2
a19 2

@@@@ -971,7 +971,8 @@@@ long dotlock_lock (char *file,DOTLOCK *b
a28 1
 
@


1.4
log
@upgrade to c-client 4.41
@
text
@d1 20
a20 4
$OpenBSD: patch-src_osdep_unix_env_unix.c,v 1.3 2001/09/27 16:28:09 brad Exp $
--- src/osdep/unix/env_unix.c.orig	Wed Oct 17 23:35:20 2001
+++ src/osdep/unix/env_unix.c	Sat Nov 17 19:06:47 2001
@@@@ -1001,7 +1001,8 @@@@ long dotlock_lock (char *file,DOTLOCK *b
d30 1
@


1.3
log
@upgrade to c-client 4.40
--
Based on patches from: jakob@@
@
text
@d1 4
a4 4
$OpenBSD$
--- src/osdep/unix/env_unix.c.orig	Mon Jun 25 23:10:04 2001
+++ src/osdep/unix/env_unix.c	Wed Sep 26 23:49:57 2001
@@@@ -992,7 +992,8 @@@@ long dotlock_lock (char *file,DOTLOCK *b
@


1.3.2.1
log
@Upgrade Pine to 4.44 which requires newer c-client.
This also fixes dependency entries for c-client and brings in some other
minor fixes from the -current ports tree.
@
text
@d1 4
a4 4
$OpenBSD: patch-src_osdep_unix_env_unix.c,v 1.4 2001/11/19 01:56:13 brad Exp $
--- src/osdep/unix/env_unix.c.orig	Wed Oct 17 23:35:20 2001
+++ src/osdep/unix/env_unix.c	Sat Nov 17 19:06:47 2001
@@@@ -1001,7 +1001,8 @@@@ long dotlock_lock (char *file,DOTLOCK *b
@


1.2
log
@upgrade to c-client 2000b
@
text
@d1 4
a4 3
--- src/osdep/unix/env_unix.c.orig	Thu Dec 21 01:12:13 2000
+++ src/osdep/unix/env_unix.c	Thu Jan 18 16:11:09 2001
@@@@ -971,7 +971,8 @@@@ long dotlock_lock (char *file,DOTLOCK *b
@


1.1
log
@don't complain about mailbox perms being wrong.
@
text
@d1 3
a3 3
--- src/osdep/unix/env_unix.c.orig	Tue Dec 12 09:52:27 2000
+++ src/osdep/unix/env_unix.c	Tue Dec 12 09:55:10 2000
@@@@ -952,7 +952,8 @@@@
@


1.1.2.1
log
@MFC:
upgrade to c-client 2000a
@
text
@@


1.1.2.2
log
@MFC:
upgrade to c-client 2000b
@
text
@d1 3
a3 3
--- src/osdep/unix/env_unix.c.orig	Thu Dec 21 01:12:13 2000
+++ src/osdep/unix/env_unix.c	Thu Jan 18 16:11:09 2001
@@@@ -971,7 +971,8 @@@@ long dotlock_lock (char *file,DOTLOCK *b
@


