head	1.15;
access;
symbols
	OPENBSD_4_2:1.14.0.4
	OPENBSD_4_2_BASE:1.14
	OPENBSD_4_1:1.14.0.2
	OPENBSD_4_1_BASE:1.14
	OPENBSD_4_0:1.13.0.10
	OPENBSD_4_0_BASE:1.13
	OPENBSD_3_9:1.13.0.8
	OPENBSD_3_9_BASE:1.13
	OPENBSD_3_8:1.13.0.6
	OPENBSD_3_8_BASE:1.13
	OPENBSD_3_7:1.13.0.4
	OPENBSD_3_7_BASE:1.13
	OPENBSD_3_6:1.13.0.2
	OPENBSD_3_6_BASE:1.13
	OPENBSD_3_5:1.10.0.6
	OPENBSD_3_5_BASE:1.10
	OPENBSD_3_4:1.10.0.4
	OPENBSD_3_4_BASE:1.10
	OPENBSD_3_3:1.10.0.2
	OPENBSD_3_3_BASE:1.10
	OPENBSD_3_2:1.9.0.4
	OPENBSD_3_2_BASE:1.9
	OPENBSD_3_1:1.9.0.2
	OPENBSD_3_1_BASE:1.9
	OPENBSD_3_0:1.8.0.2
	OPENBSD_3_0_BASE:1.8
	OPENBSD_2_9_TRACKING_SWITCH:1.7
	OPENBSD_2_9:1.7.0.2
	OPENBSD_2_9_BASE:1.7
	OPENBSD_2_8:1.3.0.2
	OPENBSD_2_8_BASE:1.3;
locks; strict;
comment	@# @;


1.15
date	2007.10.30.10.28.15;	author ajacoutot;	state dead;
branches;
next	1.14;

1.14
date	2006.10.12.08.23.25;	author jakob;	state Exp;
branches;
next	1.13;

1.13
date	2004.07.18.22.30.19;	author jakob;	state Exp;
branches;
next	1.12;

1.12
date	2004.06.09.07.25.26;	author pvalchev;	state Exp;
branches;
next	1.11;

1.11
date	2004.04.02.08.18.48;	author jakob;	state Exp;
branches;
next	1.10;

1.10
date	2002.12.01.21.15.38;	author jakob;	state Exp;
branches;
next	1.9;

1.9
date	2001.11.27.15.10.00;	author brad;	state Exp;
branches;
next	1.8;

1.8
date	2001.09.27.16.28.09;	author brad;	state Exp;
branches
	1.8.2.1;
next	1.7;

1.7
date	2001.02.02.16.43.56;	author brad;	state Exp;
branches;
next	1.6;

1.6
date	2001.01.19.01.05.06;	author brad;	state Exp;
branches;
next	1.5;

1.5
date	2000.12.12.14.44.24;	author brad;	state Exp;
branches;
next	1.4;

1.4
date	2000.11.11.16.32.46;	author brad;	state Exp;
branches;
next	1.3;

1.3
date	2000.10.16.23.23.11;	author brad;	state Exp;
branches
	1.3.2.1;
next	1.2;

1.2
date	2000.09.17.13.19.57;	author brad;	state Exp;
branches;
next	1.1;

1.1
date	2000.09.15.09.44.12;	author brad;	state Exp;
branches;
next	;

1.3.2.1
date	2000.11.20.14.59.45;	author espie;	state Exp;
branches;
next	1.3.2.2;

1.3.2.2
date	2001.01.18.19.06.09;	author brad;	state Exp;
branches;
next	1.3.2.3;

1.3.2.3
date	2001.01.19.01.11.56;	author brad;	state Exp;
branches;
next	1.3.2.4;

1.3.2.4
date	2001.02.02.17.18.20;	author brad;	state Exp;
branches;
next	;

1.8.2.1
date	2002.01.16.23.52.07;	author brad;	state Exp;
branches;
next	;


desc
@@


1.15
log
@- remove from the tree
this has been superseded by the c-client subpackage from mail/imap-uw

"go ahead" robert@@
@
text
@--- src/osdep/unix/Makefile.orig	Sat Apr 30 22:51:13 2005
+++ src/osdep/unix/Makefile	Thu Oct 12 10:15:37 2006
@@@@ -24,7 +24,7 @@@@ EXTRAAUTHENTICATORS=
 EXTRADRIVERS=mbox
 PASSWDTYPE=std
 SSLTYPE=nopwd
-IP=4
+IP=6
 
 
 # The optimization level here for GCC ports is set here for a reason.  It's
@@@@ -41,8 +41,8 @@@@ GCCOPTLEVEL= -O2
 
 # Extended flags needed for SSL.  You may need to modify.
 
-SSLDIR=/usr/local/ssl
-SSLCERTS=$(SSLDIR)/certs
+SSLDIR=/usr
+SSLCERTS=/etc/ssl
 SSLKEYS=$(SSLCERTS)
 SSLINCLUDE=$(SSLDIR)/include
 SSLLIB=$(SSLDIR)/lib
@@@@ -121,6 +121,7 @@@@ RANLIB=ranlib
 DEFAULTAUTHENTICATORS=md5 pla log
 DEFAULTDRIVERS=imap nntp pop3 mh mx mbx tenex mtx mmdf unix news phile
 
+.SUFFIXES: .o .so
 
 # Normally no need to change any of these
 
@@@@ -129,6 +130,7 @@@@ BINARIES=osdep.o mail.o misc.o newsrc.o 
  dummy.o pseudo.o netmsg.o flstring.o fdstring.o \
  rfc822.o nntp.o smtp.o imap4r1.o pop3.o \
  unix.o mbx.o mmdf.o tenex.o mtx.o news.o phile.o mh.o mx.o
+SOBINARIES=$(BINARIES:.o=.so)
 CFLAGS=-g
 
 CAT=cat
@@@@ -137,6 +139,11 @@@@ MV=mv
 RM=rm -rf
 SH=sh
 
+.if ${MACHINE_ARCH} == "sparc64" || ${MACHINE_ARCH} == "sparc"
+PICFLAG= -fPIC
+.else
+PICFLAG= -fpic
+.endif
 
 # Primary build command
 
@@@@ -801,23 +808,33 @@@@ vu2:	# VAX Ultrix 2.3, etc.
 
 # Build it!
 
+.if defined(NO_SHARED_LIBS) && ${NO_SHARED_LIBS:L} == "yes"
 build:	clean once $(ARCHIVE)
-
 all:	$(ARCHIVE)
+.else
+build:	clean once $(ARCHIVE) $(SHLIB)
+all:	$(ARCHIVE) $(SHLIB)
+.endif
 
 $(ARCHIVE): $(BINARIES)
 	sh -c '$(RM) $(ARCHIVE) || true'
 	@@$(CAT) ARCHIVE
 	@@$(SH) ARCHIVE
 
+$(SHLIB): $(SOBINARIES)
+	$(CC) -shared $(PICFLAG) -o $(SHLIB) $(SOBINARIES)
+
+
 .c.o:
 	`$(CAT) CCTYPE` -c `$(CAT) CFLAGS` $*.c
 
+.c.so:
+	`$(CAT) CCTYPE` -c `$(CAT) CFLAGS` $(PICFLAG) -DPIC $(@@:.so=.c) -o $@@
 
 # Cleanup
 
 clean:
-	sh -c '$(RM) auths.c crexcl.c nfstest.c linkage.[ch] siglocal.c osdep*.[ch] *.o ARCHIVE *FLAGS *TYPE $(ARCHIVE) || true'
+	sh -c '$(RM) auths.c crexcl.c nfstest.c linkage.[ch] siglocal.c osdep*.[ch] *.o *.so ARCHIVE *FLAGS *TYPE $(ARCHIVE) $(SHLIB) || true'
 
 
 # Dependencies
@@@@ -850,7 +867,7 @@@@ utf8.o: mail.h misc.h osdep.h utf8.h
 
 # OS-dependent
 
-osdep.o:mail.h misc.h env.h fs.h ftl.h nl.h tcp.h \
+OSDEPS=	mail.h misc.h env.h fs.h ftl.h nl.h tcp.h \
 	osdep.h env_unix.h tcp_unix.h \
 	osdep.c env_unix.c fs_unix.c ftl_unix.c nl_unix.c tcp_unix.c ip_unix.c\
 	auths.c crexcl.c flockcyg.c flocklnx.c flocksim.c nfstest.c fsync.c \
@@@@ -864,12 +881,12 @@@@ osdep.o:mail.h misc.h env.h fs.h ftl.h n
 	write.c sslstdio.c \
 	strerror.c strpbrk.c strstr.c strtok.c strtoul.c \
 	OSCFLAGS
-	@@echo Building OS-dependent module
-	@@echo If you get No such file error messages for files x509.h, ssl.h,
-	@@echo pem.h, buffer.h, bio.h, and crypto.h, that means that OpenSSL
-	@@echo is not installed on your system.  Either install OpenSSL first
-	@@echo or build with command: make `$(CAT) OSTYPE` SSLTYPE=none
-	`$(CAT) CCTYPE` -c `$(CAT) CFLAGS` `$(CAT) OSCFLAGS` -c osdep.c
+
+osdep.o: $(OSDEPS)
+	`$(CAT) CCTYPE` -c `$(CAT) CFLAGS` `$(CAT) OSCFLAGS` osdep.c
+
+osdep.so: $(OSDEPS)
+	`$(CAT) CCTYPE` -c `$(CAT) CFLAGS` `$(CAT) OSCFLAGS` $(PICFLAG) -DPIC osdep.c -o $@@
 
 osdep.c: osdepbas.c osdepckp.c osdeplog.c osdepssl.c
 	$(CAT) osdepbas.c osdepckp.c osdeplog.c osdepssl.c > osdep.c
@


1.14
log
@c-client 4.64; from jerome loyet
@
text
@@


1.13
log
@update to c-client from pine 4.61. based on patch from Eduardo Alvarenga.
@
text
@d1 3
a3 4
$OpenBSD$
--- src/osdep/unix/Makefile.orig	Thu Apr 29 23:10:25 2004
+++ src/osdep/unix/Makefile	Wed Jul  7 17:49:39 2004
@@@@ -24,13 +24,13 @@@@ EXTRAAUTHENTICATORS=
d11 3
d23 1
a23 1
@@@@ -109,6 +109,7 @@@@ RANLIB=ranlib
d31 1
a31 1
@@@@ -117,6 +118,7 @@@@ BINARIES=osdep.o mail.o misc.o newsrc.o 
d39 1
a39 1
@@@@ -125,6 +127,11 @@@@ MV=mv
d51 1
a51 10
@@@@ -236,7 +243,7 @@@@ bso:	# OpenBSD
 	 SPOOLDIR=/var \
 	 ACTIVEFILE=/usr/local/news/lib/active \
 	 RSHPATH=/usr/bin/rsh \
-	 BASECFLAGS="-O2 -pipe"
+	 BASECFLAGS="-pipe"
 
 cvx:	# Convex
 	$(BUILD) `$(CAT) SPECIALS` OS=$@@ \
@@@@ -786,23 +793,32 @@@@ vu2:	# VAX Ultrix 2.3, etc.
d72 1
d87 1
a87 1
@@@@ -835,7 +851,7 @@@@ utf8.o: mail.h misc.h osdep.h utf8.h
d95 2
a96 2
 	auths.c crexcl.c flocksim.c nfstest.c flcksafe.c fsync.c gethstid.c \
@@@@ -848,12 +864,12 @@@@ osdep.o:mail.h misc.h env.h fs.h ftl.h n
@


1.12
log
@use -fPIC on sparc
prodded to fix by Anil and joakinen@@yahoo.es
@
text
@d1 10
a10 4
$OpenBSD: patch-src_osdep_unix_Makefile,v 1.11 2004/04/02 08:18:48 jakob Exp $
--- src/osdep/unix/Makefile.orig	2003-07-15 03:35:30.000000000 +0200
+++ src/osdep/unix/Makefile	2004-04-02 09:58:52.000000000 +0200
@@@@ -28,8 +28,8 @@@@ SSLTYPE=nopwd
d21 1
a21 1
@@@@ -108,6 +108,7 @@@@ RANLIB=ranlib
d29 1
a29 1
@@@@ -116,6 +117,7 @@@@ BINARIES=osdep.o mail.o misc.o newsrc.o 
d32 1
a32 1
  unix.o mbox.o mbx.o mmdf.o tenex.o mtx.o news.o phile.o mh.o mx.o
d37 1
a37 1
@@@@ -124,6 +126,11 @@@@ MV=mv
d49 1
a49 1
@@@@ -235,7 +242,7 @@@@ bso:	# OpenBSD
d58 1
a58 1
@@@@ -763,23 +770,33 @@@@ vu2:	# VAX Ultrix 2.3, etc.
a83 1
+
d93 1
a93 1
@@@@ -813,7 +830,7 @@@@ utf8.o: mail.h misc.h osdep.h utf8.h
d100 1
a100 1
 	osdep.c env_unix.c fs_unix.c ftl_unix.c nl_unix.c tcp_unix.c \
d102 1
a102 1
@@@@ -826,12 +843,12 @@@@ osdep.o:mail.h misc.h env.h fs.h ftl.h n
@


1.11
log
@sync c-client with pine v4.58
@
text
@d1 1
a1 1
$OpenBSD: patch-src_osdep_unix_Makefile,v 1.10 2002/12/01 21:15:38 jakob Exp $
d35 1
a35 1
+.if ${MACHINE_ARCH} == "sparc64"
@


1.10
log
@update to c-client v4.50. mostly work by thorsten glaser.
@
text
@d1 3
a3 3
$OpenBSD: patch-src_osdep_unix_Makefile,v$
--- src/osdep/unix/Makefile.orig	Tue Oct 15 02:44:49 2002
+++ src/osdep/unix/Makefile	Sun Dec  1 14:45:09 2002
d12 1
d15 1
a15 2
 
@@@@ -107,6 +107,7 @@@@ RANLIB=ranlib
d23 1
a23 1
@@@@ -115,6 +116,7 @@@@ BINARIES=osdep.o mail.o misc.o newsrc.o 
d31 1
a31 1
@@@@ -123,6 +125,11 @@@@ MV=mv
d43 1
a43 1
@@@@ -234,7 +241,7 @@@@ bso:	# OpenBSD
d52 1
a52 1
@@@@ -762,23 +769,33 @@@@ vu2:	# VAX Ultrix 2.3, etc.
d88 1
a88 1
@@@@ -812,7 +829,7 @@@@ utf8.o: mail.h misc.h osdep.h utf8.h
d97 1
a97 1
@@@@ -824,12 +841,12 @@@@ osdep.o:mail.h misc.h env.h fs.h ftl.h n
@


1.9
log
@-fPIC vs. -fpic, now the c-client shared library links on sparc64 and pine atleast links and loads, no extensive testing done.
@
text
@d1 4
a4 4
$OpenBSD: patch-src_osdep_unix_Makefile,v 1.8 2001/09/27 16:28:09 brad Exp $
--- src/osdep/unix/Makefile.orig	Tue Nov  6 19:23:48 2001
+++ src/osdep/unix/Makefile	Tue Nov 27 07:05:26 2001
@@@@ -28,8 +28,8 @@@@ SSLTYPE=none
d23 1
a23 1
@@@@ -115,6 +116,7 @@@@ BINARIES=mail.o misc.o newsrc.o smanager
d97 1
a97 1
@@@@ -824,7 +841,12 @@@@ osdep.o:mail.h misc.h env.h fs.h ftl.h n
d101 5
@


1.8
log
@upgrade to c-client 4.40
--
Based on patches from: jakob@@
@
text
@d1 3
a3 3
$OpenBSD$
--- src/osdep/unix/Makefile.orig	Wed Aug 29 15:15:15 2001
+++ src/osdep/unix/Makefile	Wed Sep 26 23:32:25 2001
d31 1
a31 1
@@@@ -123,6 +125,7 @@@@ MV=mv
d35 3
d39 1
d43 1
a43 1
@@@@ -234,7 +237,7 @@@@ bso:	# OpenBSD
d52 1
a52 1
@@@@ -762,23 +765,33 @@@@ vu2:	# VAX Ultrix 2.3, etc.
d88 1
a88 1
@@@@ -812,7 +825,7 @@@@ utf8.o: mail.h misc.h osdep.h utf8.h
d97 1
a97 1
@@@@ -824,7 +837,12 @@@@ osdep.o:mail.h misc.h env.h fs.h ftl.h n
@


1.8.2.1
log
@Upgrade Pine to 4.44 which requires newer c-client.
This also fixes dependency entries for c-client and brings in some other
minor fixes from the -current ports tree.
@
text
@d1 3
a3 3
$OpenBSD: patch-src_osdep_unix_Makefile,v 1.9 2001/11/27 15:10:00 brad Exp $
--- src/osdep/unix/Makefile.orig	Tue Nov  6 19:23:48 2001
+++ src/osdep/unix/Makefile	Tue Nov 27 07:05:26 2001
d31 1
a31 1
@@@@ -123,6 +125,11 @@@@ MV=mv
a34 3
+.if ${MACHINE_ARCH} == "sparc64"
+PICFLAG= -fPIC
+.else
a35 1
+.endif
d39 1
a39 1
@@@@ -234,7 +241,7 @@@@ bso:	# OpenBSD
d48 1
a48 1
@@@@ -762,23 +769,33 @@@@ vu2:	# VAX Ultrix 2.3, etc.
d84 1
a84 1
@@@@ -812,7 +829,7 @@@@ utf8.o: mail.h misc.h osdep.h utf8.h
d93 1
a93 1
@@@@ -824,7 +841,12 @@@@ osdep.o:mail.h misc.h env.h fs.h ftl.h n
@


1.7
log
@upgrade to c-client 2000c
@
text
@d1 16
a16 4
--- src/osdep/unix/Makefile.orig	Thu Feb  1 13:15:58 2001
+++ src/osdep/unix/Makefile	Fri Feb  2 09:06:26 2001
@@@@ -84,6 +84,7 @@@@
 DEFAULTAUTHENTICATORS=md5 $(SPECIALAUTHENTICATORS) log
d23 1
a23 1
@@@@ -92,6 +93,7 @@@@
d31 1
a31 1
@@@@ -100,6 +102,7 @@@@
d39 1
a39 1
@@@@ -210,7 +213,7 @@@@
d48 1
a48 1
@@@@ -718,23 +721,32 @@@@
d74 1
d79 2
a80 2
-	sh -c '$(RM) auths.c crexcl.c flockbsd.c linkage.[ch] siglocal.c osdep*.[ch] *.o ARCHIVE *FLAGS *TYPE $(ARCHIVE) || true'
+	sh -c '$(RM) auths.c crexcl.c flockbsd.c linkage.[ch] siglocal.c osdep*.[ch] *.o *.so ARCHIVE *FLAGS *TYPE $(ARCHIVE) $(SHLIB) || true'
d84 1
a84 1
@@@@ -768,7 +780,7 @@@@
d92 3
a94 3
 	auths.c crexcl.c flock.c flockbsd.c flcksafe.c fsync.c gethstid.c \
@@@@ -780,7 +792,12 @@@@
 	write.c \
d105 2
a106 2
 osdep.c: osdepbas.c osdepckp.c osdeplog.c
 	$(CAT) osdepbas.c osdepckp.c osdeplog.c > osdep.c
@


1.6
log
@upgrade to c-client 2000b
@
text
@d1 3
a3 3
--- src/osdep/unix/Makefile.orig	Thu Jan  4 13:10:00 2001
+++ src/osdep/unix/Makefile	Thu Jan 18 16:11:07 2001
@@@@ -84,6 +84,7 @@@@ RANLIB=ranlib
d11 1
a11 1
@@@@ -92,6 +93,7 @@@@ BINARIES=mail.o misc.o newsrc.o smanager
d16 1
a16 1
 CFLAGS=$(BASECFLAGS) $(EXTRACFLAGS)
d19 1
a19 1
@@@@ -100,6 +102,7 @@@@ MV=mv
d27 1
a27 1
@@@@ -211,7 +214,7 @@@@ bso:	# OpenBSD
d36 1
a36 1
@@@@ -719,19 +722,26 @@@@ vu2:	# VAX Ultrix 2.3, etc.
d57 6
d71 1
a71 1
@@@@ -765,7 +775,7 @@@@ utf8.o: mail.h misc.h osdep.h utf8.h
d80 1
a80 1
@@@@ -777,7 +787,15 @@@@ osdep.o:mail.h misc.h env.h fs.h ftl.h n
d84 1
d87 1
a87 1
 	$(CC) $(CFLAGS) `$(CAT) OSCFLAGS` -c osdep.c
d90 1
a90 4
+	$(CC) $(CFLAGS) `$(CAT) OSCFLAGS` $(PICFLAG) -DPIC -c osdep.c -o $@@
+
+.c.so: osdep.h
+	$(CC) $(CFLAGS) $(PICFLAG) -DPIC -c $(@@:.so=.c) -o $@@
@


1.5
log
@upgrade to c-client 2000a
@
text
@d1 3
a3 3
--- src/osdep/unix/Makefile.orig	Tue Oct 31 16:55:01 2000
+++ src/osdep/unix/Makefile	Fri Dec  8 10:05:30 2000
@@@@ -84,6 +84,7 @@@@
d11 1
a11 1
@@@@ -92,6 +93,7 @@@@
d19 1
a19 1
@@@@ -100,6 +102,7 @@@@
d27 1
a27 1
@@@@ -211,7 +214,7 @@@@
d36 1
a36 1
@@@@ -702,19 +705,26 @@@@
d65 1
a65 1
@@@@ -748,7 +758,7 @@@@
d74 1
a74 1
@@@@ -760,7 +770,15 @@@@
@


1.4
log
@upgrade to c-client 2000
@
text
@d1 2
a2 2
--- src/osdep/unix/Makefile.orig	Tue Oct 24 19:59:24 2000
+++ src/osdep/unix/Makefile	Wed Nov  1 18:55:57 2000
d36 1
a36 1
@@@@ -707,19 +710,26 @@@@
d65 1
a65 1
@@@@ -753,7 +763,7 @@@@
d74 1
a74 1
@@@@ -765,7 +775,15 @@@@
@


1.3
log
@- respect CFLAGS.
- pass the pic flag along to the compiler when linking the shared library.
@
text
@d1 3
a3 3
--- src/osdep/unix/Makefile.orig	Tue Nov 16 21:05:48 1999
+++ src/osdep/unix/Makefile	Mon Oct 16 18:27:36 2000
@@@@ -96,6 +96,7 @@@@
d11 1
a11 1
@@@@ -104,12 +105,14 @@@@
d15 1
a15 1
+SOBINARIES=${BINARIES:.o=.so}
d17 3
a19 2
 MAKE=make
 MV=mv
d27 1
a27 1
@@@@ -209,7 +212,7 @@@@
d31 2
a32 2
-	 BASECFLAGS="-O2 -pipe -DNFSKLUDGE"
+	 BASECFLAGS="-pipe -DNFSKLUDGE -DIGNORE_LOCK_EACCES_ERRORS=1"
d35 2
a36 2
 	$(BUILD) `cat EXTRASPECIALS` OS=$@@ \
@@@@ -627,19 +630,26 @@@@
d51 1
a51 1
 	@@cat ARCHIVE
d60 2
a61 2
-	sh -c '$(RM) auths.c flockbsd.c linkage.[ch] siglocal.c osdep*.[ch] *.o ARCHIVE *FLAGS *TYPE $(ARCHIVE) || true'
+	sh -c '$(RM) auths.c flockbsd.c linkage.[ch] siglocal.c osdep*.[ch] *.o *.so ARCHIVE *FLAGS *TYPE $(ARCHIVE) $(SHLIB) || true'
d65 1
a65 1
@@@@ -673,7 +683,7 @@@@
d73 2
a74 2
 	auths.c flock.c flockbsd.c flcksafe.c fsync.c gethstid.c \
@@@@ -685,10 +695,18 @@@@
d80 2
a81 2
 	$(CC) $(CFLAGS) `cat OSCFLAGS` -c osdep.c
 
d83 1
a83 4
+	$(CC) $(CFLAGS) `cat OSCFLAGS` $(PICFLAG) -DPIC -c osdep.c -o $@@
+
 osdep.c: osdepbas.c osdepckp.c osdeplog.c
 	cat osdepbas.c osdepckp.c osdeplog.c > osdep.c
d88 2
a89 2
 flockbsd.c:	# cretin Linux
 
@


1.3.2.1
log
@c-client 2000, will be used for pine.
@
text
@d1 3
a3 3
--- src/osdep/unix/Makefile.orig	Tue Oct 24 19:59:24 2000
+++ src/osdep/unix/Makefile	Wed Nov  1 18:55:57 2000
@@@@ -84,6 +84,7 @@@@
d11 1
a11 1
@@@@ -92,6 +93,7 @@@@
d15 1
a15 1
+SOBINARIES=$(BINARIES:.o=.so)
d17 2
a18 3
 
 CAT=cat
@@@@ -100,6 +102,7 @@@@
d26 1
a26 1
@@@@ -211,7 +214,7 @@@@
d30 2
a31 2
-	 BASECFLAGS="-O2 -pipe"
+	 BASECFLAGS="-pipe"
d34 2
a35 2
 	$(BUILD) `$(CAT) SPECIALS` OS=$@@ \
@@@@ -707,19 +710,26 @@@@
d50 1
a50 1
 	@@$(CAT) ARCHIVE
d59 2
a60 2
-	sh -c '$(RM) auths.c crexcl.c flockbsd.c linkage.[ch] siglocal.c osdep*.[ch] *.o ARCHIVE *FLAGS *TYPE $(ARCHIVE) || true'
+	sh -c '$(RM) auths.c crexcl.c flockbsd.c linkage.[ch] siglocal.c osdep*.[ch] *.o *.so ARCHIVE *FLAGS *TYPE $(ARCHIVE) $(SHLIB) || true'
d64 1
a64 1
@@@@ -753,7 +763,7 @@@@
d72 2
a73 2
 	auths.c crexcl.c flock.c flockbsd.c flcksafe.c fsync.c gethstid.c \
@@@@ -765,7 +775,15 @@@@
d79 4
a82 1
 	$(CC) $(CFLAGS) `$(CAT) OSCFLAGS` -c osdep.c
d84 2
a85 2
+osdep.so: $(OSDEPS)
+	$(CC) $(CFLAGS) `$(CAT) OSCFLAGS` $(PICFLAG) -DPIC -c osdep.c -o $@@
d90 2
a91 2
 osdep.c: osdepbas.c osdepckp.c osdeplog.c
 	$(CAT) osdepbas.c osdepckp.c osdeplog.c > osdep.c
@


1.3.2.2
log
@MFC:
upgrade to c-client 2000a
@
text
@d1 2
a2 2
--- src/osdep/unix/Makefile.orig	Tue Oct 31 16:55:01 2000
+++ src/osdep/unix/Makefile	Fri Dec  8 10:05:30 2000
d36 1
a36 1
@@@@ -702,19 +705,26 @@@@
d65 1
a65 1
@@@@ -748,7 +758,7 @@@@
d74 1
a74 1
@@@@ -760,7 +770,15 @@@@
@


1.3.2.3
log
@MFC:
upgrade to c-client 2000b
@
text
@d1 3
a3 3
--- src/osdep/unix/Makefile.orig	Thu Jan  4 13:10:00 2001
+++ src/osdep/unix/Makefile	Thu Jan 18 16:11:07 2001
@@@@ -84,6 +84,7 @@@@ RANLIB=ranlib
d11 1
a11 1
@@@@ -92,6 +93,7 @@@@ BINARIES=mail.o misc.o newsrc.o smanager
d19 1
a19 1
@@@@ -100,6 +102,7 @@@@ MV=mv
d27 1
a27 1
@@@@ -211,7 +214,7 @@@@ bso:	# OpenBSD
d36 1
a36 1
@@@@ -719,19 +722,26 @@@@ vu2:	# VAX Ultrix 2.3, etc.
d65 1
a65 1
@@@@ -765,7 +775,7 @@@@ utf8.o: mail.h misc.h osdep.h utf8.h
d74 1
a74 1
@@@@ -777,7 +787,15 @@@@ osdep.o:mail.h misc.h env.h fs.h ftl.h n
@


1.3.2.4
log
@MFC:
upgrade to c-client 2000c
@
text
@d1 3
a3 3
--- src/osdep/unix/Makefile.orig	Thu Feb  1 13:15:58 2001
+++ src/osdep/unix/Makefile	Fri Feb  2 09:06:26 2001
@@@@ -84,6 +84,7 @@@@
d11 1
a11 1
@@@@ -92,6 +93,7 @@@@
d16 1
a16 1
 CFLAGS=-g
d19 1
a19 1
@@@@ -100,6 +102,7 @@@@
d27 1
a27 1
@@@@ -210,7 +213,7 @@@@
d36 1
a36 1
@@@@ -718,23 +721,32 @@@@
a56 6
 .c.o:
 	`$(CAT) CCTYPE` -c `$(CAT) CFLAGS` $*.c
 
+.c.so:
+	`$(CAT) CCTYPE` -c `$(CAT) CFLAGS` $(PICFLAG) -DPIC $(@@:.so=.c) -o $@@
 
d65 1
a65 1
@@@@ -768,7 +780,7 @@@@
d74 1
a74 1
@@@@ -780,7 +792,12 @@@@
a77 1
-	`$(CAT) CCTYPE` -c `$(CAT) CFLAGS` `$(CAT) OSCFLAGS` -c osdep.c
d80 1
a80 1
+	`$(CAT) CCTYPE` -c `$(CAT) CFLAGS` `$(CAT) OSCFLAGS` osdep.c
d83 4
a86 1
+	`$(CAT) CCTYPE` -c `$(CAT) CFLAGS` `$(CAT) OSCFLAGS` $(PICFLAG) -DPIC osdep.c -o $@@
@


1.2
log
@*** empty log message ***
@
text
@d2 1
a2 1
+++ src/osdep/unix/Makefile	Sun Sep 17 08:22:35 2000
d11 1
a11 1
@@@@ -104,6 +105,7 @@@@
d19 8
a26 1
@@@@ -209,7 +211,7 @@@@
d31 1
a31 1
+	 BASECFLAGS="-O2 -pipe -DNFSKLUDGE -DIGNORE_LOCK_EACCES_ERRORS=1"
d35 1
a35 1
@@@@ -627,20 +629,27 @@@@
d54 1
a54 1
+	$(CC) -shared -o $(SHLIB) $(SOBINARIES)
d59 3
a61 3
 	sh -c '$(RM) auths.c flockbsd.c linkage.[ch] siglocal.c osdep*.[ch] *.o ARCHIVE *FLAGS *TYPE $(ARCHIVE) || true'
-
+	$(RM) *.so $(SHLIB)
d64 1
a64 2
 
@@@@ -673,7 +682,7 @@@@
d73 1
a73 1
@@@@ -685,10 +694,18 @@@@
d82 1
a82 1
+	$(CC) $(CFLAGS) `cat OSCFLAGS` -fpic -DPIC -c osdep.c -o $@@
d88 1
a88 1
+	$(CC) $(CFLAGS) -fpic -DPIC -c $(@@:.so=.c) -o $@@
@


1.1
log
@create a shared library
@
text
@d2 1
a2 1
+++ src/osdep/unix/Makefile	Fri Sep 15 04:26:14 2000
d19 9
@

