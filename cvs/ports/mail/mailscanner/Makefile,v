head	1.57;
access;
symbols
	OPENBSD_6_0:1.57.0.6
	OPENBSD_6_0_BASE:1.57
	OPENBSD_5_9:1.57.0.2
	OPENBSD_5_9_BASE:1.57
	OPENBSD_5_8:1.57.0.4
	OPENBSD_5_8_BASE:1.57
	OPENBSD_5_7:1.55.0.4
	OPENBSD_5_7_BASE:1.55
	OPENBSD_5_6:1.55.0.2
	OPENBSD_5_6_BASE:1.55
	OPENBSD_5_5:1.52.0.2
	OPENBSD_5_5_BASE:1.52
	OPENBSD_5_4:1.50.0.2
	OPENBSD_5_4_BASE:1.50
	OPENBSD_5_3:1.49.0.2
	OPENBSD_5_3_BASE:1.49
	OPENBSD_5_2:1.48.0.2
	OPENBSD_5_2_BASE:1.48
	OPENBSD_5_1_BASE:1.46
	OPENBSD_5_1:1.46.0.2
	OPENBSD_5_0:1.44.0.2
	OPENBSD_5_0_BASE:1.44
	OPENBSD_4_9:1.36.0.2
	OPENBSD_4_9_BASE:1.36
	OPENBSD_4_8:1.28.0.2
	OPENBSD_4_8_BASE:1.28
	OPENBSD_4_7:1.23.0.2
	OPENBSD_4_7_BASE:1.23
	OPENBSD_4_6:1.15.0.2
	OPENBSD_4_6_BASE:1.15
	OPENBSD_4_5:1.12.0.2
	OPENBSD_4_5_BASE:1.12
	OPENBSD_4_4:1.7.0.2
	OPENBSD_4_4_BASE:1.7
	OPENBSD_4_3:1.3.0.2
	OPENBSD_4_3_BASE:1.3
	todd_20080219:1.1.1.1
	todd:1.1.1;
locks; strict;
comment	@# @;


1.57
date	2015.07.15.20.45.24;	author ajacoutot;	state Exp;
branches;
next	1.56;
commitid	utzYkRQlde9vNz0v;

1.56
date	2015.04.09.19.55.09;	author sthen;	state Exp;
branches;
next	1.55;
commitid	sE7HMnORBsGkv9M7;

1.55
date	2014.07.22.10.55.40;	author ajacoutot;	state Exp;
branches;
next	1.54;
commitid	3LzguPEQl5LkjlcD;

1.54
date	2014.07.12.11.25.00;	author sthen;	state Exp;
branches;
next	1.53;
commitid	76ij4rO0HAnPaXZj;

1.53
date	2014.03.29.22.50.05;	author brad;	state Exp;
branches;
next	1.52;

1.52
date	2013.12.12.21.56.19;	author brad;	state Exp;
branches
	1.52.2.1;
next	1.51;

1.51
date	2013.08.12.20.22.44;	author brad;	state Exp;
branches;
next	1.50;

1.50
date	2013.03.11.11.23.51;	author espie;	state Exp;
branches;
next	1.49;

1.49
date	2012.12.02.07.22.33;	author brad;	state Exp;
branches;
next	1.48;

1.48
date	2012.03.06.20.09.40;	author pea;	state Exp;
branches;
next	1.47;

1.47
date	2012.03.06.08.34.20;	author sthen;	state Exp;
branches;
next	1.46;

1.46
date	2011.12.08.08.03.20;	author sthen;	state Exp;
branches
	1.46.2.1;
next	1.45;

1.45
date	2011.08.21.11.03.26;	author sthen;	state Exp;
branches;
next	1.44;

1.44
date	2011.07.22.19.57.20;	author sthen;	state Exp;
branches;
next	1.43;

1.43
date	2011.07.22.07.33.55;	author sthen;	state Exp;
branches;
next	1.42;

1.42
date	2011.06.02.13.41.39;	author ajacoutot;	state Exp;
branches;
next	1.41;

1.41
date	2011.05.12.12.20.41;	author sthen;	state Exp;
branches;
next	1.40;

1.40
date	2011.04.21.20.25.35;	author sthen;	state Exp;
branches;
next	1.39;

1.39
date	2011.03.24.09.55.30;	author sthen;	state Exp;
branches;
next	1.38;

1.38
date	2011.03.19.00.12.08;	author sthen;	state Exp;
branches;
next	1.37;

1.37
date	2011.03.02.23.38.52;	author sthen;	state Exp;
branches;
next	1.36;

1.36
date	2010.12.29.06.42.16;	author ajacoutot;	state Exp;
branches;
next	1.35;

1.35
date	2010.11.22.09.28.34;	author espie;	state Exp;
branches;
next	1.34;

1.34
date	2010.11.21.08.02.38;	author ajacoutot;	state Exp;
branches;
next	1.33;

1.33
date	2010.11.16.09.17.55;	author jasper;	state Exp;
branches;
next	1.32;

1.32
date	2010.11.16.07.33.59;	author sthen;	state Exp;
branches;
next	1.31;

1.31
date	2010.10.15.18.52.05;	author sthen;	state Exp;
branches;
next	1.30;

1.30
date	2010.09.27.09.38.23;	author sthen;	state Exp;
branches;
next	1.29;

1.29
date	2010.08.19.08.34.19;	author sthen;	state Exp;
branches;
next	1.28;

1.28
date	2010.07.26.11.22.07;	author sthen;	state Exp;
branches;
next	1.27;

1.27
date	2010.06.22.07.38.14;	author sthen;	state Exp;
branches;
next	1.26;

1.26
date	2010.06.18.21.48.23;	author sthen;	state Exp;
branches;
next	1.25;

1.25
date	2010.05.27.11.04.30;	author sthen;	state Exp;
branches;
next	1.24;

1.24
date	2010.03.21.00.00.09;	author sthen;	state Exp;
branches;
next	1.23;

1.23
date	2010.02.24.15.28.14;	author sthen;	state Exp;
branches;
next	1.22;

1.22
date	2010.01.20.08.47.12;	author sthen;	state Exp;
branches;
next	1.21;

1.21
date	2010.01.15.20.37.51;	author sthen;	state Exp;
branches;
next	1.20;

1.20
date	2010.01.12.00.22.01;	author sthen;	state Exp;
branches;
next	1.19;

1.19
date	2009.11.29.23.07.45;	author sthen;	state Exp;
branches;
next	1.18;

1.18
date	2009.11.27.23.19.06;	author sthen;	state Exp;
branches;
next	1.17;

1.17
date	2009.10.17.16.25.49;	author sthen;	state Exp;
branches;
next	1.16;

1.16
date	2009.10.07.20.59.29;	author sthen;	state Exp;
branches;
next	1.15;

1.15
date	2009.06.11.23.33.26;	author sthen;	state Exp;
branches;
next	1.14;

1.14
date	2009.05.23.21.30.05;	author sthen;	state Exp;
branches;
next	1.13;

1.13
date	2009.04.08.22.29.24;	author todd;	state Exp;
branches;
next	1.12;

1.12
date	2009.01.28.15.16.17;	author sthen;	state Exp;
branches;
next	1.11;

1.11
date	2008.12.16.00.51.06;	author todd;	state Exp;
branches;
next	1.10;

1.10
date	2008.11.07.02.33.58;	author brad;	state Exp;
branches;
next	1.9;

1.9
date	2008.11.06.15.53.46;	author sthen;	state Exp;
branches;
next	1.8;

1.8
date	2008.10.05.21.08.49;	author jasper;	state Exp;
branches;
next	1.7;

1.7
date	2008.07.24.03.25.03;	author brad;	state Exp;
branches;
next	1.6;

1.6
date	2008.05.16.16.38.36;	author sthen;	state Exp;
branches;
next	1.5;

1.5
date	2008.04.24.21.31.00;	author todd;	state Exp;
branches;
next	1.4;

1.4
date	2008.04.17.07.30.27;	author jasper;	state Exp;
branches;
next	1.3;

1.3
date	2008.02.22.18.38.03;	author todd;	state Exp;
branches;
next	1.2;

1.2
date	2008.02.20.04.25.12;	author todd;	state Exp;
branches;
next	1.1;

1.1
date	2008.02.20.03.47.18;	author todd;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2008.02.20.03.47.18;	author todd;	state Exp;
branches;
next	;

1.46.2.1
date	2012.04.11.14.18.52;	author sthen;	state Exp;
branches;
next	;

1.52.2.1
date	2014.03.29.22.51.13;	author brad;	state Exp;
branches;
next	;


desc
@@


1.57
log
@Fix pexp.
@
text
@# $OpenBSD: Makefile,v 1.56 2015/04/09 19:55:09 sthen Exp $

COMMENT=	virus/spam scanning framework

V=		4.85
Vs=		2
Vss=		${Vs}-1
DISTNAME=	MailScanner-${V}.${Vss}
PKGNAME=	mailscanner-${V}.${Vss:S/-/./}
CATEGORIES=	mail
MASTER_SITES=	https://s3.amazonaws.com/mailscanner/release/v4/tar/
REVISION=	0

HOMEPAGE=	http://www.mailscanner.info/

MAINTAINER=	Brad Smith <brad@@comstyle.com>

# GPLv2+
PERMIT_PACKAGE_CDROM=	Yes

RUN_DEPENDS+=	archivers/lha \
		archivers/p5-Archive-Zip>=1.30p0 \
		archivers/unzip \
		archivers/zoo \
		converters/p5-Convert-BinHex \
		converters/p5-Convert-TNEF \
		databases/p5-DBD-SQLite \
		databases/p5-DBI \
		devel/p5-IO-String \
		devel/p5-OLE-Storage_Lite \
		devel/p5-Sys-SigAction \
		mail/p5-MIME-tools \
		mail/tnef>=1.4.7 \
		net/p5-Net-CIDR \
		net/p5-Net-IP \
		net/p5-Sys-Hostname-Long \
		net/wget \
		security/p5-Digest-SHA1 \
		sysutils/p5-Filesys-Df \
		textproc/antiword \
		www/p5-HTML-Parser

WRKDIST=	${WRKDIR}/MailScanner-${V}.${Vss}

NO_BUILD=	Yes
NO_TEST=	Yes

post-extract:
	@@cd ${WRKDIR} && ${TAR} xzf MailScanner-install-${V}.${Vs}/perl-tar/MailScanner-${V}.${Vss}${EXTRACT_SUFX} && \
		find ${WRKDIST} -type d | xargs chmod 755

do-install:	install_libexec install_etc install_share install_lib install_bin

BINS=	MailScanner Quick.Peek df2mbox d2mbox update_bad_phishing_emails
BINS+=	update_bad_phishing_sites update_phishing_sites check_mailscanner
BINS+=	clean.quarantine clean.SA.cache analyse_SpamAssassin_cache
BINS+=	mailscanner_create_locks processing_messages_alert upgrade_MailScanner_conf

_MS_sed_frag= _subst() { sed 's,%PREFIX%,${LOCALBASE},g;s,%SYSCONFDIR%,${SYSCONFDIR},g' \
		"$$2" > ${WRKDIST}/file; \
		case "$$1" in \
		script) ${INSTALL_SCRIPT} -m 755 ${WRKDIST}/file "$$3";; \
		data) ${INSTALL_DATA}	${WRKDIST}/file "$$3";; \
		*) echo "subst invalid 1st arg, given 1=$$1";exit 2;; \
		esac; }; _subst

INST_SCRIPT=	${_MS_sed_frag} script
INST_DATA=	${_MS_sed_frag} data

install_bin:
.for _f in ${BINS}
	@@${INST_SCRIPT} ${WRKSRC}/bin/${_f} ${PREFIX}/bin/${_f}
.endfor

install_libexec:
	${INSTALL_DATA_DIR} ${PREFIX}/libexec/MailScanner
	@@${INST_SCRIPT} ${WRKSRC}/bin/MailScanner ${PREFIX}/libexec/MailScanner/MailScanner
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/MailScanner/libexec
	@@cd ${WRKSRC}/lib ; find * -name "*-wrapper" | while read f; do ${INST_SCRIPT} "$$f" ${PREFIX}/share/examples/MailScanner/libexec/"$${f}".sample; done
	@@cd ${WRKSRC}/lib ; find * -name "*-autoupdate" | while read f; do ${INST_SCRIPT} "$$f" ${PREFIX}/share/examples/MailScanner/libexec/"$${f}".sample; done

ETC=	MailScanner.conf country.domains.conf filename.rules.conf
ETC+=   filetype.rules.conf phishing.bad.sites.conf phishing.safe.sites.conf
ETC+=	spam.assassin.prefs.conf spam.lists.conf virus.scanners.conf
ETC+=	archives.filename.rules.conf archives.filetype.rules.conf
ETC+=	conf.d/README mcp/mcp.spam.assassin.prefs.conf mcp/10_example.cf
ETC+=	mcp/v320.pre rules/bounce.rules rules/max.message.size.rules
ETC+=	rules/spam.whitelist.rules

install_etc:
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/MailScanner
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/MailScanner/conf.d
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/MailScanner/mcp
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/MailScanner/rules
.for _f in ${ETC}
	@@${INST_DATA} ${WRKSRC}/etc/${_f} ${PREFIX}/share/examples/MailScanner/${_f}
.endfor
	@@${INST_DATA} ${WRKSRC}/etc/rules/EXAMPLES ${PREFIX}/share/examples/MailScanner/rules/EXAMPLES
	@@${INST_DATA} ${WRKSRC}/etc/rules/README ${PREFIX}/share/examples/MailScanner/rules/README

install_share:
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc
	${INSTALL_DATA_DIR} ${PREFIX}/share/MailScanner
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/MailScanner
	@@${INST_DATA} ${WRKDIR}/MailScanner-install-${V}.${Vs}/README ${PREFIX}/share/doc/MailScanner/README
	@@cd ${WRKSRC}/etc ; find reports -type d -exec ${INSTALL_DATA_DIR} ${PREFIX}'/share/examples/MailScanner/{}' \;
	@@cd ${WRKSRC}/etc ; find reports -type f ! -name "*.orig" | while read f; do ${INST_DATA} $$f ${PREFIX}/share/examples/MailScanner/$$f; done
	@@cd ${PREFIX}/share/examples/MailScanner/reports ; find . -name "*.bak" -print0 | xargs -0 rm -f

install_lib:
	${INSTALL_PROGRAM_DIR} ${PREFIX}/lib/MailScanner
	${INSTALL_PROGRAM_DIR} ${PREFIX}/lib/MailScanner/MailScanner 
	${INSTALL_PROGRAM_DIR} ${PREFIX}/lib/MailScanner/MailScanner/CustomFunctions
	@@${INST_SCRIPT} ${WRKSRC}/lib/MailScanner.pm ${PREFIX}/lib/MailScanner/MailScanner.pm
	@@cd ${WRKSRC}/lib/MailScanner ; find * -type f ! -name "*.orig" | while read f; do ${INST_SCRIPT} $$f ${PREFIX}/lib/MailScanner/MailScanner/$$f ; done

.include <bsd.port.mk>
@


1.56
log
@update to MailScanner-4.85.2-1, from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55 2014/07/22 10:55:40 ajacoutot Exp $
d12 1
@


1.55
log
@Tweak documentation according to recent rc changes.

ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.54 2014/07/12 11:25:00 sthen Exp $
d5 2
a6 2
V=		4.84
Vs=		6
d8 1
a8 1
DISTNAME=	mailscanner-${V}.${Vss}
a9 1
REVISION=	2
d11 1
a11 3
MASTER_SITES=	http://comstyle.com/source/

DISTFILES=	MailScanner-install-${V}.${Vss}${EXTRACT_SUFX}
d28 1
d34 1
d37 1
d104 1
a104 1
	@@${INST_DATA} ${WRKSRC}/README ${PREFIX}/share/doc/MailScanner/README
@


1.54
log
@don't use "echo 'pkg_scripts="${pkg_scripts} icinga' >> /etc/rc.conf.local"
examples
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2014/03/29 22:50:05 brad Exp $
d10 1
a10 1
REVISION=	1
@


1.53
log
@Mirror the distfile and change MASTER_SITES to my server; upstream
snuck in config file changes to the distfile.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.52 2013/12/12 21:56:19 brad Exp $
d10 1
a10 1
REVISION=	0
@


1.52
log
@Lift some temp file fixes from the github repo. It's always fun noticing your
mail server blow up so to speak and then wonder why /var is out of inodes and
seeing that 803,000 or so inodes are in use. Where could they posibly be in
use? Then finding 801,000+ 0 byte temp files which had been accumulating for
quite awhile in /var/spool/MailScanner/incoming/SpamAssassin-Temp.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 2013/08/12 20:22:44 brad Exp $
d12 1
a12 1
MASTER_SITES=	http://mailscanner.info/files/4/tar/
@


1.52.2.1
log
@Mirror the distfile and change MASTER_SITES to my server; upstream
snuck in config file changes to the distfile.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.52 2013/12/12 21:56:19 brad Exp $
d12 1
a12 1
MASTER_SITES=	http://comstyle.com/source/
@


1.51
log
@Update to MailScanner 4.84.6-1.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2013/03/11 11:23:51 espie Exp $
d8 3
d13 1
a13 2
DISTNAME=	mailscanner-${V}.${Vss}
PKGNAME=	mailscanner-${V}.${Vss:S/-/./}
a14 1
WRKDIST=	${WRKDIR}/MailScanner-${V}.${Vss}
d20 3
d42 1
a42 2
# GPLv2+
PERMIT_PACKAGE_CDROM=	Yes
@


1.50
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2012/12/02 07:22:33 brad Exp $
d6 2
a7 2
Vs=		5
Vss=		${Vs}-3
@


1.49
log
@Update to MailScanner 4.84.5-3.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2012/03/06 20:09:40 pea Exp $
a39 3
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM= Yes
PERMIT_DISTFILES_FTP=	Yes
d42 1
a42 1
NO_REGRESS=	Yes
@


1.48
log
@unbreak update_bad_phishing_sites and
update_bad_phishing_emails scripts.

ok brad (maintainer), sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2012/03/06 08:34:20 sthen Exp $
d7 1
a7 2
Vss=		${Vs}-2
REVISION=	0
@


1.47
log
@Update to MailScanner 4.84.5-2, OK with Brad.

- Fixes URL used to fetch phishing-detection database; the domain that
it was hosted on lapsed. You may have a corrupt database: if the file
/var/spool/MailScanner/quarantine/phishingupdate exists, delete it
and run update_bad_phishing_sites and update_bad_phishing_emails
manually as the "run as user".

- While there update the TNEF.pm fix to improve temp file handling.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2011/12/08 08:03:20 sthen Exp $
d8 1
@


1.46
log
@Previous update caused a problem with external TNEF unpacking; add a
diff posted on the mailing list to fix it. OK Brad (maintainer).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2011/08/21 11:03:26 sthen Exp $
d6 2
a7 3
Vs=		3
Vss=		${Vs}-1
REVISION=	0
@


1.46.2.1
log
@MFC update to MailScanner 4.84.5-2

- Fixes URL used to fetch phishing-detection database; the domain that
it was hosted on lapsed. You may have a corrupt database: if the file
/var/spool/MailScanner/quarantine/phishingupdate exists, delete it
and run update_bad_phishing_sites and update_bad_phishing_emails
manually as the "run as user".

- While there update the TNEF.pm fix to improve temp file handling.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2012/03/06 20:09:40 pea Exp $
d6 2
a7 2
Vs=		5
Vss=		${Vs}-2
@


1.45
log
@update to MailScanner 4.84.3-1, from Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2011/07/22 19:57:20 sthen Exp $
d8 1
@


1.44
log
@add an rc script for MailScanner, looks ok to Brad (maintainer).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2011/07/22 07:33:55 sthen Exp $
d6 1
a6 1
Vs=		1
a7 1
REVISION=	0
@


1.43
log
@update to MailScanner 4.84.1-1, from Brad (maintainer).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2011/06/02 13:41:39 ajacoutot Exp $
d8 1
@


1.42
log
@Add a consistent header that substitutes FULLPKGNAME for the READMEs.

ok jasper@@ sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2011/05/12 12:20:41 sthen Exp $
d5 2
a6 2
V=		4.83
Vs=		5
a13 1
REVISION=	0
@


1.41
log
@update to 4.83.5-1, from Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2011/04/21 20:25:35 sthen Exp $
d14 1
@


1.40
log
@Have check_mailscanner pick up the "Run As User" setting from
MailScanner.conf and explicitly start as that user. This avoids setuid
in perl (triggering taint mode) and so it sidesteps taint mode fallout
which has appeared recently, most likely due to the CVE-2011-1487 fix
in Perl.

Maintainer believed to be away this week, so committing now and we
can change it later if he disagrees when he returns.   ok todd@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2011/03/24 09:55:30 sthen Exp $
d6 1
a6 1
Vs=		4
a7 1
REVISION=	0
@


1.39
log
@update MailScanner to 4.83.4-1, ok Brad

- fixed logging of ClamAV updates (thanks for Peter Bonivart for this!).
- fixed "Return-Path:" header so it doesn't contain any 8-bit characters
which conflict with the new "RP_8BIT" rule in SpamAssassin.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2011/03/19 00:12:08 sthen Exp $
d8 1
@


1.38
log
@update MailScanner to 4.83.2-1; ok Brad. Fixes crashes with spaces
in virus names (recently triggered by some sanesecurity signature files).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2011/03/02 23:38:52 sthen Exp $
d6 1
a6 1
Vs=		2
@


1.37
log
@update to 4.82.6-1, ok Brad (maintainer).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2010/12/29 06:42:16 ajacoutot Exp $
d5 2
a6 2
V=		4.82
Vs=		6
@


1.36
log
@Update to mailscanner-4.82.3.1.

from Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2010/11/22 09:28:34 espie Exp $
d6 1
a6 1
Vs=		3
@


1.35
log
@missed some
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2010/11/21 08:02:38 ajacoutot Exp $
d5 2
a6 2
V=		4.81
Vs=		4
a7 1
REVISION=	2
@


1.34
log
@Missed bump after move to pkg-readmes.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2010/11/16 09:17:55 jasper Exp $
d20 18
a37 18
RUN_DEPENDS+=	::archivers/lha \
		:p5-Archive-Zip->=1.30p0:archivers/p5-Archive-Zip \
		::archivers/unzip \
		::archivers/zoo \
		::converters/p5-Convert-BinHex \
		::converters/p5-Convert-TNEF \
		::databases/p5-DBD-SQLite \
		::databases/p5-DBI \
		::devel/p5-OLE-Storage_Lite \
		::devel/p5-Sys-SigAction \
		::mail/p5-MIME-tools \
		:tnef->=1.4.7:mail/tnef \
		::net/p5-Net-CIDR \
		::net/p5-Sys-Hostname-Long \
		::net/wget \
		::sysutils/p5-Filesys-Df \
		::textproc/antiword \
		::www/p5-HTML-Parser
@


1.33
log
@- switch to pkg-readmes

ok brad (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2010/11/16 07:33:59 sthen Exp $
d8 1
a8 1
REVISION=	1
@


1.32
log
@alphabetically sort RUN_DEPENDS and add p5-DBD-SQLite, it's optional but
fairly lightweight and is used in the default configuration.
Brad (maintainer) ok.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2010/10/15 18:52:05 sthen Exp $
a105 1
	@@${INST_DATA} ${FILESDIR}/README.OpenBSD.port ${PREFIX}/share/doc/MailScanner/README.OpenBSD.port
@


1.31
log
@Force dep on newer p5-Archive-Zip, req by Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2010/09/27 09:38:23 sthen Exp $
d8 1
a8 1
REVISION=	0
d20 1
a20 1
RUN_DEPENDS+=	::databases/p5-DBI \
d22 8
d31 1
d34 1
a34 3
		::www/p5-HTML-Parser \
		::converters/p5-Convert-BinHex \
		::converters/p5-Convert-TNEF \
d36 2
a37 8
		:tnef->=1.4.7:mail/tnef \
		::archivers/unzip \
		::archivers/lha \
		::archivers/zoo \
		::net/wget \
		::devel/p5-OLE-Storage_Lite \
		::devel/p5-Sys-SigAction \
		::textproc/antiword
@


1.30
log
@update to 4.81.4-1 from Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2010/08/19 08:34:19 sthen Exp $
d8 1
d21 1
a21 1
		::archivers/p5-Archive-Zip \
@


1.29
log
@update MailScanner to 4.81.3-1, from Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2010/07/26 11:22:07 sthen Exp $
d6 1
a6 1
Vs=		3
@


1.28
log
@fix RUN_DEPENDS, bump REVISION. Spotted by Viq.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2010/06/22 07:38:14 sthen Exp $
d5 2
a6 2
V=		4.80
Vs=		10
a7 1
REVISION=	0
@


1.27
log
@update to 4.80.10-1, bugfixes include a regression introduced with the
last update using % variables in rulesets. From Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2010/06/18 21:48:23 sthen Exp $
d8 1
d29 1
a29 1
		:tnef->=4.7:mail/tnef \
@


1.26
log
@update to 4.80.7-1 (notable addition: support for storing config in sql)
From Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2010/05/27 11:04:30 sthen Exp $
d6 1
a6 1
Vs=		7
@


1.25
log
@update to 4.80.4-1, Brad (maintainer) ok.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2010/02/24 15:28:14 sthen Exp $
d6 1
a6 1
Vs=		4
d34 1
@


1.24
log
@RUN_DEPENDS on a specific minimum version of mail/tnef rather than
just allowing any version; from Brad
@
text
@d6 1
a6 1
Vs=		1
d11 1
a11 1
PKGNAME=	mailscanner-${V}.${Vss:S/-/./}p0
@


1.23
log
@Update to 4.80.1-1, fixes more Perl 5.10.1 taint mode problems
and problems with certain virus scanners.

ok Brad (maintainer), jasper@@.

ports is not fully open, do not commit without specific permission.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2010/01/20 08:47:12 sthen Exp $
d11 1
a11 1
PKGNAME=	mailscanner-${V}.${Vss:S/-/./}
d28 1
a28 1
		::mail/tnef \
@


1.22
log
@update to 4.79.8-1, fixes another problem with perl 5.10.1 taint mode.
ok Brad, jasper
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2010/01/15 20:37:51 sthen Exp $
d5 2
a6 2
V=		4.79
Vs=		8
@


1.21
log
@Update to 4.79.6-1; more perl taint mode cleanup, bug in clamav output
parser fixed (just clamav, not clamd/clamavmodule).

ok jasper@@, Brad (maintainer).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2010/01/12 00:22:01 sthen Exp $
d6 1
a6 1
Vs=		6
@


1.20
log
@Update MailScanner to 4.79.5-1, another perl taint mode fix needed
with perl 5.10. From Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2009/11/29 23:07:45 sthen Exp $
d6 1
a6 1
Vs=		5
@


1.19
log
@Update to 4.79.4-1 from Brad; fixes another Perl taint-mode check
which causes problems with Perl 5.10.1.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2009/11/27 23:19:06 sthen Exp $
d6 1
a6 1
Vs=		4
@


1.18
log
@Update to 4.79.3-1, from Brad (maintainer).
Fixes problems with Perl taint mode since the Perl 5.10.1 upgrade.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2009/10/17 16:25:49 sthen Exp $
d6 1
a6 1
Vs=		3
@


1.17
log
@install upgrade_MailScanner_conf, from Brad (maintainer).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2009/10/07 20:59:29 sthen Exp $
d5 2
a6 2
V=		4.78
Vs=		17
d11 1
a11 1
PKGNAME=	mailscanner-${V}.${Vss:S/-/./}p0
@


1.16
log
@update to 4.78.17-1, from Brad (maintainer).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2009/06/11 23:33:26 sthen Exp $
d11 1
a11 1
PKGNAME=	mailscanner-${V}.${Vss:S/-/./}
d54 1
a54 1
BINS+=	mailscanner_create_locks processing_messages_alert
@


1.15
log
@update to 4.77.10-1; from Brad, taking MAINTAINER, todd@@ agrees.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2009/05/23 21:30:05 sthen Exp $
d5 2
a6 2
V=		4.77
Vs=		10
d51 3
a53 2
BINS=	MailScanner df2mbox d2mbox update_bad_phishing_sites update_phishing_sites
BINS+=	check_mailscanner clean.quarantine clean.SA.cache analyse_SpamAssassin_cache
d83 3
a85 2
ETC+=	mcp/mcp.spam.assassin.prefs.conf mcp/10_example.cf mcp/v320.pre
ETC+=	rules/bounce.rules rules/max.message.size.rules rules/spam.whitelist.rules
d89 1
@


1.14
log
@update to 4.76.25-1, from Brad. ok todd@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2009/04/08 22:29:24 todd Exp $
d5 2
a6 2
V=		4.76
Vs=		25
d17 1
a17 1
MAINTAINER=	Todd T. Fries <todd@@openbsd.org>
@


1.13
log
@update to 4.75.11, tested by brad and sthen@@ for nearly a week now, from brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2009/01/28 15:16:17 sthen Exp $
d5 2
a6 2
V=		4.75
Vs=		11
d81 1
@


1.12
log
@update to 4.74.16-1, from Brad. ok todd@@ (maintainer).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2008/12/16 00:51:06 todd Exp $
d5 2
a6 2
V=		4.74
Vs=		16
d53 1
a53 1
BINS+=	mailscanner_create_locks
@


1.11
log
@update to 4.73.4-2; DoS issue, see ChangeLog
from Brad, ok sthen@@ and myself, tested by sthen@@ for a week
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2008/11/07 02:33:58 brad Exp $
d5 3
a7 3
V=		4.73
Vs=		4
Vss=		${Vs}-2
d53 1
@


1.10
log
@Upgrade to MailScanner 4.72.5-1.

Feedback from sthen@@ including adding a conflict marker as a
kludge to ensure that if a user wants to use AV support that
the correct version is installed (0.94 or newer) since it is
an optional dependency. Great job by the Clam crew for making
this such a mess. The current version of MailScanner is broken
if using 0.94 since the commandline opts were changed.

ok todd@@ sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2008/11/06 15:53:46 sthen Exp $
d5 3
a7 3
V=		4.72
Vs=		5
Vss=		${Vs}-1
@


1.9
log
@unfortunately the manpages were removed from MailScanner at some
point, so don't point people at them in MESSAGE.

"Sucks!  But ok.." todd@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2008/10/05 21:08:49 jasper Exp $
d5 2
a6 2
V=		4.70
Vs=		6
d10 2
a11 2
DISTNAME=       mailscanner-${V}.${Vss}
PKGNAME=	mailscanner-${V}.${Vss:S/-/./}p0
d33 2
a34 1
		::devel/p5-OLE-Storage_Lite
@


1.8
log
@- add missing NO_REGRESS

ok todd@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2008/07/24 03:25:03 brad Exp $
d11 1
a11 1
PKGNAME=	mailscanner-${V}.${Vss:S/-/./}
@


1.7
log
@Upgrade to MailScanner 4.70.6-1.

ok todd@@ sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2008/05/16 16:38:36 sthen Exp $
d42 1
@


1.6
log
@update to 4.69.9-1 and fix typo in @@sample line
(spam.assasin.prefs.conf -> spam.assassin.prefs.conf)

from brad, ok todd (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2008/04/24 21:31:00 todd Exp $
d5 2
a6 2
V=		4.69
Vs=		9
@


1.5
log
@update to 4.68.8, from brad@@
tested by todd@@ and brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2008/04/17 07:30:27 jasper Exp $
d5 2
a6 2
V=		4.68
Vs=		8
d32 2
a33 1
		::net/wget
d35 1
a35 1
# GPLv2
@


1.4
log
@- loosen check on IO::

ok brad@@ simon@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2008/02/22 18:38:03 todd Exp $
d5 3
a7 3
V=		4.66
Vs=		5
Vss=		${Vs}-3
d11 1
a11 1
PKGNAME=	mailscanner-${V}.${Vss:S/-/./}p1
a20 1
		::archivers/p5-Compress-Zlib \
d34 1
a34 1
# GPL
d48 2
a49 2
BINS=	MailScanner df2mbox d2mbox update_phishing_sites check_mailscanner
BINS+=	clean.quarantine clean.SA.cache analyse_SpamAssassin_cache
@


1.3
log
@remove unused line in Makefile; no change so no pkg bump
reported by brad@@ and ajacoutot@@ separately
ok naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2008/02/20 04:25:12 todd Exp $
d11 1
a11 1
PKGNAME=	mailscanner-${V}.${Vss:S/-/./}p0
@


1.2
log
@on 2nd thought, remove dependencies on software that would prevent this from
being able to be put on ftp (unrar, unarj, unace); dependencies are used
if installed, but are truly optional runtime dependencies
bump pkgname
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2008/02/20 03:47:18 todd Exp $
a18 1
MODULE=		cpan
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d11 1
a11 1
PKGNAME=	mailscanner-${V}.${Vss:S/-/./}
a31 3
		::archivers/unrar \
		::archivers/unarj \
		::archivers/unace \
@


1.1.1.1
log
@import MailScanner 4.66.5-3, a virus/spam scanning framework

MailScanner is a complete e-mail security system designed for use on
e-mail gateways. It protects against viruses, and detects attacks
against e-mail client packages (such as Outlook, Outlook Express,
Eudora). It can also detect almost all unsolicited commercial e-mail
(spam) passing through it and respond to all incidents in a wide variety
of ways.

..see http://www.mailscanner.info/ for more details.

I have included a generic spam scanner that if enabled uses dspam, as an
alternative to SpamAssassin.

Thanks to Brad Smith for helping get this ready for import.  This has been
a few years in the making.
@
text
@@
