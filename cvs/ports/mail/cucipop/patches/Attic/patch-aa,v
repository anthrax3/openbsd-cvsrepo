head	1.6;
access;
symbols
	OPENBSD_2_8:1.5.0.4
	OPENBSD_2_8_BASE:1.5
	OPENBSD_2_7:1.5.0.2
	OPENBSD_2_7_BASE:1.5
	OPENBSD_2_6:1.3.0.6
	OPENBSD_2_6_BASE:1.3
	OPENBSD_2_5:1.3.0.4
	OPENBSD_2_5_BASE:1.3
	OPENBSD_2_4:1.3.0.2
	OPENBSD_2_4_BASE:1.3
	marc_1998-apr-25:1.1.1.1
	marc:1.1.1;
locks; strict;
comment	@# @;


1.6
date	2001.02.19.15.00.49;	author danh;	state dead;
branches;
next	1.5;

1.5
date	2000.03.28.08.46.25;	author brad;	state Exp;
branches;
next	1.4;

1.4
date	2000.03.27.17.26.06;	author form;	state Exp;
branches;
next	1.3;

1.3
date	98.06.30.05.54.52;	author form;	state Exp;
branches;
next	1.2;

1.2
date	98.04.28.17.23.10;	author marc;	state Exp;
branches;
next	1.1;

1.1
date	98.04.26.04.48.28;	author marc;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	98.04.26.04.48.28;	author marc;	state Exp;
branches;
next	;


desc
@@


1.6
log
@- bump NEED_VERSION.
- update IPv6 patch from Kame (20010128).
- add no_ipv6 flavor so there is an option to run without inetd.
@
text
@--- Makefile.orig	Tue May 12 17:09:14 1998
+++ Makefile	Mon Mar 27 15:25:45 2000
@@@@ -32,7 +32,7 @@@@
 MD5_OBJ=md5/md5c.$(O)
 
 OBJS=cucipop.$(O) authenticate.$(O) atotime.$(O) locking.$(O) xcreat.$(O) \
-	dbops.$(O) hsort.$(O) simplecrypt.$(O) $(MD5_OBJ)
+	dbops.$(O) hsort.$(O) simplecrypt.$(O)
 
 BINS=cucipop makevpopdb
 
@


1.5
log
@- revert most of patch-aa and instead use a combination of MAKE_FLAGS and
our own install target, this also has the affect of not unnecessarily
creating the spool dir durring the fake install
- add INSTALL script
@
text
@@


1.4
log
@respect CFLAGS.
fake.
@
text
@d1 2
a2 40
# $OpenBSD: $

--- Makefile.orig	Wed May 13 04:09:14 1998
+++ Makefile	Tue Mar 28 01:09:54 2000
@@@@ -1,6 +1,6 @@@@
 #$Id: Makefile,v 1.18 1998/05/12 21:09:14 srb Exp $
 
-BASENAME= /usr
+BASENAME= $(PREFIX)
 
 GCC_WARNINGS = -O2 -pedantic -Wreturn-type -Wunused -Wformat \
  -Wpointer-arith -Wconversion -Waggregate-return \
@@@@ -10,21 +10,21 @@@@
 # Omit USE_DB if you don't have the -ldb2 library (Berkeley DB, v2.x)
 # WARNING: bulletins are not remembered to have been deleted without USE_DB
 
-CFLAGS	= -O -DUSE_DB #$(GCC_WARNINGS)
-LDFLAGS = -lcrypt -ldb2
+#CFLAGS	+= #-DUSE_DB #$(GCC_WARNINGS)
+#LDFLAGS = 
 
 # If you change this, edit config.h as well
-CUCIPOPLIB=/var/lib/cucipop
+CUCIPOPLIB=/var/spool/cucipop
 CUCIPOPBULLETINS=$(CUCIPOPLIB)/bulletins
 
 O=o
 
-BINDIR=$(BASENAME)/sbin
+BINDIR=$(BASENAME)/libexec
 MANDIR=$(BASENAME)/man/man8
 
 INSTALL=install -o root -m
-BINPERM=02755 -s -g mail
-REGPERM=0644
+BINPERM=755 -s -g bin
+REGPERM=444
 
 #
 # When compiling without APOP support, the md5 library can be omitted.
a10 11
 
@@@@ -70,8 +70,8 @@@@
 install: $(BINS) $(MANS)
 	$(INSTALL) $(BINPERM) $(BINS) $(BINDIR)
 	$(INSTALL) $(REGPERM) $(MANS) $(MANDIR)
-	mkdir $(CUCIPOPLIB) 2>/dev/null; exit 0
-	mkdir $(CUCIPOPBULLETINS) 2>/dev/null; exit 0
+	mkdir -p $(CUCIPOPLIB) 2>/dev/null; exit 0
+	mkdir -p $(CUCIPOPBULLETINS) 2>/dev/null; exit 0
 	@@for a in $(BINS); do ls -l $(BINDIR)/$$a; done
 	@@for a in $(MANS); do ls -l $(MANDIR)/$$a; done
@


1.3
log
@update to 1.31
@
text
@d1 60
a60 98
*** Makefile.orig	Wed May 13 04:09:14 1998
--- Makefile	Tue Jun 30 12:44:07 1998
***************
*** 1,6 ****
  #$Id: Makefile,v 1.18 1998/05/12 21:09:14 srb Exp $
  
! BASENAME= /usr
  
  GCC_WARNINGS = -O2 -pedantic -Wreturn-type -Wunused -Wformat \
   -Wpointer-arith -Wconversion -Waggregate-return \
--- 1,6 ----
  #$Id: Makefile,v 1.18 1998/05/12 21:09:14 srb Exp $
  
! BASENAME= $(PREFIX)
  
  GCC_WARNINGS = -O2 -pedantic -Wreturn-type -Wunused -Wformat \
   -Wpointer-arith -Wconversion -Waggregate-return \
***************
*** 10,30 ****
  # Omit USE_DB if you don't have the -ldb2 library (Berkeley DB, v2.x)
  # WARNING: bulletins are not remembered to have been deleted without USE_DB
  
! CFLAGS	= -O -DUSE_DB #$(GCC_WARNINGS)
! LDFLAGS = -lcrypt -ldb2
  
  # If you change this, edit config.h as well
! CUCIPOPLIB=/var/lib/cucipop
  CUCIPOPBULLETINS=$(CUCIPOPLIB)/bulletins
  
  O=o
  
! BINDIR=$(BASENAME)/sbin
  MANDIR=$(BASENAME)/man/man8
  
  INSTALL=install -o root -m
! BINPERM=02755 -s -g mail
! REGPERM=0644
  
  #
  # When compiling without APOP support, the md5 library can be omitted.
--- 10,30 ----
  # Omit USE_DB if you don't have the -ldb2 library (Berkeley DB, v2.x)
  # WARNING: bulletins are not remembered to have been deleted without USE_DB
  
! CFLAGS	= -O #-DUSE_DB #$(GCC_WARNINGS)
! LDFLAGS = 
  
  # If you change this, edit config.h as well
! CUCIPOPLIB=/var/spool/cucipop
  CUCIPOPBULLETINS=$(CUCIPOPLIB)/bulletins
  
  O=o
  
! BINDIR=$(BASENAME)/libexec
  MANDIR=$(BASENAME)/man/man8
  
  INSTALL=install -o root -m
! BINPERM=755 -s -g bin
! REGPERM=444
  
  #
  # When compiling without APOP support, the md5 library can be omitted.
***************
*** 32,38 ****
  MD5_OBJ=md5/md5c.$(O)
  
  OBJS=cucipop.$(O) authenticate.$(O) atotime.$(O) locking.$(O) xcreat.$(O) \
! 	dbops.$(O) hsort.$(O) simplecrypt.$(O) $(MD5_OBJ)
  
  BINS=cucipop makevpopdb
  
--- 32,38 ----
  MD5_OBJ=md5/md5c.$(O)
  
  OBJS=cucipop.$(O) authenticate.$(O) atotime.$(O) locking.$(O) xcreat.$(O) \
! 	dbops.$(O) hsort.$(O) simplecrypt.$(O)
  
  BINS=cucipop makevpopdb
  
***************
*** 70,77 ****
  install: $(BINS) $(MANS)
  	$(INSTALL) $(BINPERM) $(BINS) $(BINDIR)
  	$(INSTALL) $(REGPERM) $(MANS) $(MANDIR)
! 	mkdir $(CUCIPOPLIB) 2>/dev/null; exit 0
! 	mkdir $(CUCIPOPBULLETINS) 2>/dev/null; exit 0
  	@@for a in $(BINS); do ls -l $(BINDIR)/$$a; done
  	@@for a in $(MANS); do ls -l $(MANDIR)/$$a; done
  
--- 70,77 ----
  install: $(BINS) $(MANS)
  	$(INSTALL) $(BINPERM) $(BINS) $(BINDIR)
  	$(INSTALL) $(REGPERM) $(MANS) $(MANDIR)
! 	mkdir -p $(CUCIPOPLIB) 2>/dev/null; exit 0
! 	mkdir -p $(CUCIPOPBULLETINS) 2>/dev/null; exit 0
  	@@for a in $(BINS); do ls -l $(BINDIR)/$$a; done
  	@@for a in $(MANS); do ls -l $(MANDIR)/$$a; done
  
@


1.2
log
@use proper locking and spool directory.
patch from Oleg Safiullin <form@@vs.itam.nsc.ru>
@
text
@d1 98
a98 51
--- Makefile.orig	Thu Jul 31 18:00:30 1997
+++ Makefile	Mon Apr 27 14:48:12 1998
@@@@ -1,30 +1,29 @@@@
 #$Id: Makefile,v 1.3 1997/08/01 01:00:30 srb Exp $
 
-BASENAME= /usr
+BASENAME= $(PREFIX)
 
 GCC_WARNINGS = -O2 -pedantic -Wreturn-type -Wunused -Wformat \
  -Wpointer-arith -Wconversion -Waggregate-return \
  #-Wimplicit -Wshadow #-Wuninitialized
 
-CFLAGS	= -O #$(GCC_WARNINGS)
-LDFLAGS =
+CFLAGS	= -O -DMAILSPOOLDIR=\"/var/mail/\" #$(GCC_WARNINGS)
+LDFLAGS +=
 
 O=o
 
-BINDIR=$(BASENAME)/sbin
+BINDIR=$(BASENAME)/libexec
 MANDIR=$(BASENAME)/man/man8
 
-INSTALL=install -o root -m
-BINPERM=02755 -s -g mail
-REGPERM=0644
+INSTALL=install -o bin -m
+BINPERM=0555 -s -g bin
+REGPERM=0444 -g bin
 
 #
 # When compiling without APOP support, the md5 library can be omitted.
 
 MD5_OBJ=md5/md5c.$(O)
 
-OBJS=cucipop.$(O) authenticate.$(O) atotime.$(O) locking.$(O) xcreat.$(O) \
-	$(MD5_OBJ)
+OBJS=cucipop.$(O) authenticate.$(O) atotime.$(O) locking.$(O) xcreat.$(O)
 
 all: cucipop
 
@@@@ -44,7 +43,8 @@@@
 
 install: cucipop cucipop.8
 	$(INSTALL) $(BINPERM) cucipop $(BINDIR)
-	$(INSTALL) $(REGPERM) cucipop.8 $(MANDIR)
+	sed -e 's,!!PREFIX!!,$(PREFIX),g' cucipop.8 > cucipop.8-out
+	$(INSTALL) $(REGPERM) cucipop.8-out $(MANDIR)/cucipop.8
 	ls -l $(BINDIR)/cucipop $(MANDIR)/cucipop.8
 
 deinstall:
@


1.1
log
@Initial revision
@
text
@d1 51
a51 64
*** Makefile.orig	Fri Aug  1 08:00:30 1997
--- Makefile	Tue Apr 21 22:46:59 1998
***************
*** 1,30 ****
  #$Id: Makefile,v 1.3 1997/08/01 01:00:30 srb Exp $
  
! BASENAME= /usr
  
  GCC_WARNINGS = -O2 -pedantic -Wreturn-type -Wunused -Wformat \
   -Wpointer-arith -Wconversion -Waggregate-return \
   #-Wimplicit -Wshadow #-Wuninitialized
  
! CFLAGS	= -O #$(GCC_WARNINGS)
! LDFLAGS =
  
  O=o
  
! BINDIR=$(BASENAME)/sbin
  MANDIR=$(BASENAME)/man/man8
  
! INSTALL=install -o root -m
! BINPERM=02755 -s -g mail
! REGPERM=0644
  
  #
  # When compiling without APOP support, the md5 library can be omitted.
  
  MD5_OBJ=md5/md5c.$(O)
  
! OBJS=cucipop.$(O) authenticate.$(O) atotime.$(O) locking.$(O) xcreat.$(O) \
! 	$(MD5_OBJ)
  
  all: cucipop
  
--- 1,29 ----
  #$Id: Makefile,v 1.3 1997/08/01 01:00:30 srb Exp $
  
! BASENAME= $(PREFIX)
  
  GCC_WARNINGS = -O2 -pedantic -Wreturn-type -Wunused -Wformat \
   -Wpointer-arith -Wconversion -Waggregate-return \
   #-Wimplicit -Wshadow #-Wuninitialized
  
! #CFLAGS	= -O #$(GCC_WARNINGS)
! LDFLAGS +=
  
  O=o
  
! BINDIR=$(BASENAME)/libexec
  MANDIR=$(BASENAME)/man/man8
  
! INSTALL=install -o bin -m
! BINPERM=0555 -s -g bin
! REGPERM=0444 -g bin
  
  #
  # When compiling without APOP support, the md5 library can be omitted.
  
  MD5_OBJ=md5/md5c.$(O)
  
! OBJS=cucipop.$(O) authenticate.$(O) atotime.$(O) locking.$(O) xcreat.$(O)
  
  all: cucipop
  
@


1.1.1.1
log
@Cubic Circle's POP3 daemon (fully RFC1939 compliant).
Port from Oleg Safiullin (form@@vs.itam.nsc.ru)
@
text
@@
