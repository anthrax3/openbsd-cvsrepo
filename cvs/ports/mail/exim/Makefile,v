head	1.113;
access;
symbols
	OPENBSD_6_2:1.113.0.4
	OPENBSD_6_2_BASE:1.113
	OPENBSD_6_1:1.113.0.2
	OPENBSD_6_1_BASE:1.113
	OPENBSD_6_0:1.109.0.2
	OPENBSD_6_0_BASE:1.109
	OPENBSD_5_9:1.105.0.2
	OPENBSD_5_9_BASE:1.105
	OPENBSD_5_8:1.103.0.4
	OPENBSD_5_8_BASE:1.103
	OPENBSD_5_7:1.102.0.2
	OPENBSD_5_7_BASE:1.102
	OPENBSD_5_6:1.98.0.2
	OPENBSD_5_6_BASE:1.98
	OPENBSD_5_5:1.94.0.2
	OPENBSD_5_5_BASE:1.94
	OPENBSD_5_4:1.93.0.2
	OPENBSD_5_4_BASE:1.93
	OPENBSD_5_3:1.90.0.2
	OPENBSD_5_3_BASE:1.90
	OPENBSD_5_2:1.89.0.2
	OPENBSD_5_2_BASE:1.89
	OPENBSD_5_1_BASE:1.87
	OPENBSD_5_1:1.87.0.2
	OPENBSD_5_0:1.83.0.2
	OPENBSD_5_0_BASE:1.83
	OPENBSD_4_9:1.80.0.2
	OPENBSD_4_9_BASE:1.80
	OPENBSD_4_8:1.73.0.2
	OPENBSD_4_8_BASE:1.73
	OPENBSD_4_7:1.72.0.2
	OPENBSD_4_7_BASE:1.72
	OPENBSD_4_6:1.65.0.2
	OPENBSD_4_6_BASE:1.65
	OPENBSD_4_5:1.64.0.6
	OPENBSD_4_5_BASE:1.64
	OPENBSD_4_4:1.64.0.4
	OPENBSD_4_4_BASE:1.64
	OPENBSD_4_3:1.64.0.2
	OPENBSD_4_3_BASE:1.64
	OPENBSD_4_2:1.61.0.2
	OPENBSD_4_2_BASE:1.61
	OPENBSD_4_1:1.60.0.2
	OPENBSD_4_1_BASE:1.60
	OPENBSD_4_0:1.54.0.2
	OPENBSD_4_0_BASE:1.54
	OPENBSD_3_9:1.52.0.2
	OPENBSD_3_9_BASE:1.52
	OPENBSD_3_8:1.50.0.2
	OPENBSD_3_8_BASE:1.50
	OPENBSD_3_7:1.48.0.2
	OPENBSD_3_7_BASE:1.48
	OPENBSD_3_6:1.44.0.2
	OPENBSD_3_6_BASE:1.44
	OPENBSD_3_5:1.37.0.2
	OPENBSD_3_5_BASE:1.37
	OPENBSD_3_4:1.36.0.2
	OPENBSD_3_4_BASE:1.36
	OPENBSD_3_3:1.35.0.2
	OPENBSD_3_3_BASE:1.35
	OPENBSD_3_2:1.32.0.4
	OPENBSD_3_2_BASE:1.32
	OPENBSD_3_1:1.32.0.2
	OPENBSD_3_1_BASE:1.32
	OPENBSD_3_0:1.28.0.2
	OPENBSD_3_0_BASE:1.28
	OPENBSD_2_9_TRACKING_SWITCH:1.25
	OPENBSD_2_9:1.23.0.2
	OPENBSD_2_9_BASE:1.23
	OPENBSD_2_8:1.17.0.2
	OPENBSD_2_8_BASE:1.17
	OPENBSD_2_7:1.12.0.2
	OPENBSD_2_7_BASE:1.12
	OPENBSD_2_6:1.4.0.4
	OPENBSD_2_6_BASE:1.4
	OPENBSD_2_5:1.4.0.2
	OPENBSD_2_5_BASE:1.4
	OPENBSD_2_4:1.3.0.4
	OPENBSD_2_4_BASE:1.3
	OPENBSD_2_3:1.3.0.2
	OPENBSD_2_3_BASE:1.3
	joey_1_1:1.1.1.1
	joey_1:1.1.1;
locks; strict;
comment	@# @;


1.113
date	2017.03.08.17.05.34;	author sthen;	state Exp;
branches;
next	1.112;
commitid	wgrxZr1HmAVHOR5g;

1.112
date	2016.12.25.21.13.35;	author sthen;	state Exp;
branches;
next	1.111;
commitid	oxGCjdG5xgkQy1To;

1.111
date	2016.12.24.16.02.10;	author sthen;	state Exp;
branches;
next	1.110;
commitid	HMsLGgDLBhD8fPVt;

1.110
date	2016.09.12.17.51.07;	author naddy;	state Exp;
branches;
next	1.109;
commitid	unrzt8OtHTH3JdtT;

1.109
date	2016.07.09.08.46.24;	author sthen;	state Exp;
branches;
next	1.108;
commitid	5V5x7yAKWjzdrmlj;

1.108
date	2016.04.06.21.41.55;	author sthen;	state Exp;
branches;
next	1.107;
commitid	kxqGmKnAGboWdzjM;

1.107
date	2016.03.07.15.34.16;	author sthen;	state Exp;
branches;
next	1.106;
commitid	jYZcqQMFpduTXHYk;

1.106
date	2016.03.02.20.13.54;	author sthen;	state Exp;
branches;
next	1.105;
commitid	4vHWfXdcdAi1Ji0S;

1.105
date	2015.08.17.19.10.12;	author sthen;	state Exp;
branches
	1.105.2.1;
next	1.104;
commitid	4CippZtWcqcVBaoK;

1.104
date	2015.08.12.22.11.57;	author sthen;	state Exp;
branches;
next	1.103;
commitid	iMTkRP2nXi4qwyEx;

1.103
date	2015.07.15.17.10.35;	author ajacoutot;	state Exp;
branches;
next	1.102;
commitid	OvdOGD10ob4gfqzz;

1.102
date	2015.01.15.21.39.36;	author kirby;	state Exp;
branches;
next	1.101;
commitid	lIsyzcnLX0ByXfEb;

1.101
date	2015.01.13.18.00.23;	author sthen;	state Exp;
branches;
next	1.100;
commitid	RazbufODbXfaTsK9;

1.100
date	2014.09.13.18.09.21;	author brad;	state Exp;
branches;
next	1.99;
commitid	PpbRjVZdAmlrmi8q;

1.99
date	2014.08.10.09.58.05;	author espie;	state Exp;
branches;
next	1.98;
commitid	jyyOLTDxRdjpw44n;

1.98
date	2014.07.23.10.36.24;	author sthen;	state Exp;
branches;
next	1.97;
commitid	Xi6hnk3lk4nZFsFJ;

1.97
date	2014.05.28.14.23.27;	author sthen;	state Exp;
branches;
next	1.96;

1.96
date	2014.03.24.17.39.35;	author sthen;	state Exp;
branches;
next	1.95;

1.95
date	2014.03.13.14.50.41;	author sthen;	state Exp;
branches;
next	1.94;

1.94
date	2013.08.24.09.22.25;	author sthen;	state Exp;
branches;
next	1.93;

1.93
date	2013.06.12.20.36.33;	author brad;	state Exp;
branches;
next	1.92;

1.92
date	2013.05.25.00.33.09;	author brad;	state Exp;
branches;
next	1.91;

1.91
date	2013.03.11.11.23.50;	author espie;	state Exp;
branches;
next	1.90;

1.90
date	2012.10.26.08.50.01;	author sthen;	state Exp;
branches;
next	1.89;

1.89
date	2012.04.30.13.08.18;	author espie;	state Exp;
branches
	1.89.2.1;
next	1.88;

1.88
date	2012.04.30.13.07.58;	author espie;	state Exp;
branches;
next	1.87;

1.87
date	2011.12.17.22.01.13;	author sthen;	state Exp;
branches
	1.87.2.1;
next	1.86;

1.86
date	2011.11.18.13.29.29;	author espie;	state Exp;
branches;
next	1.85;

1.85
date	2011.10.19.23.06.57;	author fkr;	state Exp;
branches;
next	1.84;

1.84
date	2011.09.16.10.31.21;	author espie;	state Exp;
branches;
next	1.83;

1.83
date	2011.07.17.20.15.59;	author sthen;	state Exp;
branches;
next	1.82;

1.82
date	2011.05.11.12.57.48;	author jasper;	state Exp;
branches;
next	1.81;

1.81
date	2011.05.09.14.56.56;	author fkr;	state Exp;
branches;
next	1.80;

1.80
date	2011.02.07.16.01.26;	author jasper;	state Exp;
branches
	1.80.2.1;
next	1.79;

1.79
date	2011.01.12.05.45.29;	author fkr;	state Exp;
branches;
next	1.78;

1.78
date	2010.11.19.07.23.06;	author espie;	state Exp;
branches;
next	1.77;

1.77
date	2010.11.11.10.54.02;	author espie;	state Exp;
branches;
next	1.76;

1.76
date	2010.11.06.10.18.38;	author espie;	state Exp;
branches;
next	1.75;

1.75
date	2010.10.24.21.25.12;	author ajacoutot;	state Exp;
branches;
next	1.74;

1.74
date	2010.10.18.19.59.15;	author espie;	state Exp;
branches;
next	1.73;

1.73
date	2010.06.15.08.43.30;	author fkr;	state Exp;
branches
	1.73.2.1;
next	1.72;

1.72
date	2010.02.02.20.23.30;	author sthen;	state Exp;
branches
	1.72.2.1;
next	1.71;

1.71
date	2010.02.02.19.48.15;	author espie;	state Exp;
branches;
next	1.70;

1.70
date	2010.01.15.07.59.45;	author jasper;	state Exp;
branches;
next	1.69;

1.69
date	2010.01.09.11.47.32;	author sthen;	state Exp;
branches;
next	1.68;

1.68
date	2009.12.15.11.32.18;	author sthen;	state Exp;
branches;
next	1.67;

1.67
date	2009.08.10.06.32.42;	author kili;	state Exp;
branches;
next	1.66;

1.66
date	2009.07.22.10.48.31;	author sthen;	state Exp;
branches;
next	1.65;

1.65
date	2009.03.16.17.52.52;	author sthen;	state Exp;
branches;
next	1.64;

1.64
date	2008.02.03.20.39.11;	author fkr;	state Exp;
branches;
next	1.63;

1.63
date	2007.09.16.00.17.04;	author merdely;	state Exp;
branches;
next	1.62;

1.62
date	2007.09.10.20.08.16;	author fkr;	state Exp;
branches;
next	1.61;

1.61
date	2007.04.20.18.14.22;	author fkr;	state Exp;
branches;
next	1.60;

1.60
date	2007.01.12.21.51.55;	author fkr;	state Exp;
branches;
next	1.59;

1.59
date	2007.01.05.23.47.05;	author fkr;	state Exp;
branches;
next	1.58;

1.58
date	2006.12.28.12.44.13;	author fkr;	state Exp;
branches;
next	1.57;

1.57
date	2006.11.09.07.13.01;	author fkr;	state Exp;
branches;
next	1.56;

1.56
date	2006.10.30.20.54.27;	author fkr;	state Exp;
branches;
next	1.55;

1.55
date	2006.10.13.15.18.54;	author alek;	state Exp;
branches;
next	1.54;

1.54
date	2006.08.03.13.09.09;	author espie;	state Exp;
branches;
next	1.53;

1.53
date	2006.05.05.06.02.30;	author sturm;	state Exp;
branches;
next	1.52;

1.52
date	2006.02.05.14.30.11;	author steven;	state Exp;
branches;
next	1.51;

1.51
date	2006.01.15.13.06.42;	author sturm;	state Exp;
branches;
next	1.50;

1.50
date	2005.08.27.15.57.31;	author naddy;	state Exp;
branches;
next	1.49;

1.49
date	2005.07.06.23.18.10;	author jolan;	state Exp;
branches;
next	1.48;

1.48
date	2005.01.26.19.33.20;	author sturm;	state Exp;
branches
	1.48.2.1;
next	1.47;

1.47
date	2005.01.02.12.56.04;	author alek;	state Exp;
branches;
next	1.46;

1.46
date	2004.11.18.23.26.41;	author alek;	state Exp;
branches;
next	1.45;

1.45
date	2004.10.10.10.29.53;	author sturm;	state Exp;
branches;
next	1.44;

1.44
date	2004.08.10.09.14.48;	author xsa;	state Exp;
branches
	1.44.2.1;
next	1.43;

1.43
date	2004.07.26.10.56.01;	author peter;	state Exp;
branches;
next	1.42;

1.42
date	2004.07.26.10.14.27;	author peter;	state Exp;
branches;
next	1.41;

1.41
date	2004.07.17.11.19.50;	author peter;	state Exp;
branches;
next	1.40;

1.40
date	2004.07.15.19.32.45;	author peter;	state Exp;
branches;
next	1.39;

1.39
date	2004.05.10.08.42.42;	author brad;	state Exp;
branches;
next	1.38;

1.38
date	2004.05.10.07.42.32;	author brad;	state Exp;
branches;
next	1.37;

1.37
date	2004.01.02.05.03.33;	author brad;	state Exp;
branches
	1.37.2.1;
next	1.36;

1.36
date	2003.09.03.17.21.05;	author brad;	state Exp;
branches
	1.36.2.1;
next	1.35;

1.35
date	2002.12.07.16.34.57;	author brad;	state Exp;
branches
	1.35.2.1;
next	1.34;

1.34
date	2002.11.21.00.15.10;	author naddy;	state Exp;
branches;
next	1.33;

1.33
date	2002.10.27.17.21.39;	author naddy;	state Exp;
branches;
next	1.32;

1.32
date	2001.12.29.12.55.08;	author peter;	state Exp;
branches
	1.32.2.1
	1.32.4.1;
next	1.31;

1.31
date	2001.12.03.15.06.30;	author naddy;	state Exp;
branches;
next	1.30;

1.30
date	2001.11.17.00.12.23;	author naddy;	state Exp;
branches;
next	1.29;

1.29
date	2001.10.24.12.22.45;	author espie;	state Exp;
branches;
next	1.28;

1.28
date	2001.09.28.19.06.30;	author jakob;	state Exp;
branches;
next	1.27;

1.27
date	2001.09.07.22.23.46;	author peter;	state Exp;
branches;
next	1.26;

1.26
date	2001.09.07.22.15.50;	author peter;	state Exp;
branches;
next	1.25;

1.25
date	2001.07.25.08.18.48;	author peter;	state Exp;
branches;
next	1.24;

1.24
date	2001.06.03.05.32.16;	author brad;	state Exp;
branches;
next	1.23;

1.23
date	2001.04.21.18.54.11;	author peter;	state Exp;
branches;
next	1.22;

1.22
date	2001.03.07.19.05.34;	author brad;	state Exp;
branches;
next	1.21;

1.21
date	2001.02.28.15.13.19;	author brad;	state Exp;
branches;
next	1.20;

1.20
date	2001.02.23.11.30.02;	author peter;	state Exp;
branches;
next	1.19;

1.19
date	2001.02.22.20.03.43;	author danh;	state Exp;
branches;
next	1.18;

1.18
date	2000.12.07.15.27.33;	author peter;	state Exp;
branches;
next	1.17;

1.17
date	2000.10.27.12.56.09;	author espie;	state Exp;
branches;
next	1.16;

1.16
date	2000.09.06.05.48.48;	author brad;	state Exp;
branches;
next	1.15;

1.15
date	2000.08.12.23.57.45;	author naddy;	state Exp;
branches;
next	1.14;

1.14
date	2000.08.02.15.44.11;	author naddy;	state Exp;
branches;
next	1.13;

1.13
date	2000.06.04.22.42.05;	author espie;	state Exp;
branches;
next	1.12;

1.12
date	2000.04.26.09.40.57;	author peter;	state Exp;
branches
	1.12.2.1;
next	1.11;

1.11
date	2000.04.09.17.36.54;	author espie;	state Exp;
branches;
next	1.10;

1.10
date	2000.03.17.03.25.58;	author turan;	state Exp;
branches;
next	1.9;

1.9
date	2000.02.23.13.43.56;	author peter;	state Exp;
branches;
next	1.8;

1.8
date	2000.02.12.08.29.36;	author turan;	state Exp;
branches;
next	1.7;

1.7
date	2000.02.12.08.02.23;	author turan;	state Exp;
branches;
next	1.6;

1.6
date	2000.02.11.01.10.05;	author espie;	state Exp;
branches;
next	1.5;

1.5
date	2000.01.26.11.54.13;	author peter;	state Exp;
branches;
next	1.4;

1.4
date	99.03.31.22.39.43;	author marc;	state Exp;
branches;
next	1.3;

1.3
date	97.12.31.11.34.26;	author tacho;	state Exp;
branches;
next	1.2;

1.2
date	97.11.17.21.47.28;	author joey;	state Exp;
branches;
next	1.1;

1.1
date	97.11.15.00.04.37;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	97.11.15.00.04.37;	author deraadt;	state Exp;
branches;
next	;

1.12.2.1
date	2000.09.15.05.01.19;	author marc;	state Exp;
branches;
next	;

1.32.2.1
date	2002.12.10.15.30.10;	author brad;	state Exp;
branches;
next	;

1.32.4.1
date	2002.12.10.15.29.31;	author brad;	state Exp;
branches;
next	1.32.4.2;

1.32.4.2
date	2003.09.03.20.52.27;	author brad;	state Exp;
branches;
next	;

1.35.2.1
date	2003.09.03.20.50.57;	author brad;	state Exp;
branches;
next	;

1.36.2.1
date	2004.05.10.08.50.41;	author brad;	state Exp;
branches;
next	;

1.37.2.1
date	2004.05.10.08.45.04;	author brad;	state Exp;
branches;
next	1.37.2.2;

1.37.2.2
date	2005.01.27.06.35.40;	author sturm;	state Exp;
branches;
next	;

1.44.2.1
date	2005.01.27.06.34.10;	author sturm;	state Exp;
branches;
next	1.44.2.2;

1.44.2.2
date	2005.09.04.20.23.01;	author sturm;	state Exp;
branches;
next	;

1.48.2.1
date	2005.09.04.20.28.27;	author sturm;	state Exp;
branches;
next	;

1.72.2.1
date	2010.06.16.01.41.26;	author william;	state Exp;
branches;
next	;

1.73.2.1
date	2011.02.07.16.01.52;	author jasper;	state Exp;
branches;
next	;

1.80.2.1
date	2011.05.10.13.50.10;	author jasper;	state Exp;
branches;
next	;

1.87.2.1
date	2012.10.26.08.50.15;	author sthen;	state Exp;
branches;
next	;

1.89.2.1
date	2012.10.26.08.50.07;	author sthen;	state Exp;
branches;
next	;

1.105.2.1
date	2016.03.19.12.19.25;	author sthen;	state Exp;
branches;
next	;
commitid	edPSK2D4koCinpIs;


desc
@@


1.113
log
@update to exim-4.89
@
text
@# $OpenBSD: Makefile,v 1.112 2016/12/25 21:13:35 sthen Exp $

COMMENT-main =		flexible mail transfer agent
COMMENT-eximon =	X11 monitor tool for Exim MTA

VERSION =		4.89
DISTNAME =		exim-${VERSION}
PKGNAME-main =		exim-${VERSION}
FULLPKGNAME-eximon =	exim-eximon-${VERSION}
FULLPKGPATH-eximon =	${PKGPATH},-eximon

CATEGORIES =		mail

HOMEPAGE =		http://www.exim.org/

# GPLv2+, with OpenSSL exemption
PERMIT_PACKAGE_CDROM =   Yes

cWANTLIB =		c m
WANTLIB-main =		${cWANTLIB} crypto iconv perl pcre ssl
WANTLIB-eximon =	${cWANTLIB} X11 Xaw Xext Xmu Xt pcre

MASTER_SITES =		http://ftp.exim.org/pub/exim/exim4/ \
			http://ftp.exim.org/pub/exim/exim4/old/ \
			ftp://ftp.exim.org/pub/exim/exim4/ \
			http://mirror.switch.ch/ftp/mirror/exim/exim/exim4/

LIB_DEPENDS-main =	converters/libiconv devel/pcre
RUN_DEPENDS-eximon =	${PKGPATH},-main
LIB_DEPENDS-eximon =	devel/pcre

MAKE_FLAGS +=		FULLECHO=

PSEUDO_FLAVORS =	no_eximon
FLAVORS =		mysql postgresql sqlite3 ldap sasl
FLAVOR ?=
MULTI_PACKAGES =	-main -eximon

.include <bsd.port.arch.mk>

.if ${BUILD_PACKAGES:M-eximon}
EXIM_MAKECAT +=		"EXIM_MONITOR=eximon.bin\n"
.endif

.if ${FLAVOR:Mmysql}
EXIM_MAKECAT +=		"LOOKUP_MYSQL=yes\n"
EXIM_LOOKUP_INCLUDE +=	-I${LOCALBASE}/include/mysql
EXIM_LOOKUP_LIBS +=	-L${LOCALBASE}/lib/mysql -lmysqlclient
LIB_DEPENDS-main +=	databases/mariadb
WANTLIB-main +=		lib/mysql/mysqlclient pthread
.endif

.if ${FLAVOR:Mpostgresql}
EXIM_MAKECAT +=		"LOOKUP_PGSQL=yes\n"
EXIM_LOOKUP_INCLUDE +=	-I${LOCALBASE}/include/postgresql
EXIM_LOOKUP_LIBS +=	-L${LOCALBASE}/lib/ -lpq
LIB_DEPENDS-main +=	databases/postgresql
WANTLIB-main +=		pq>=2
.endif

.if ${FLAVOR:Msqlite3}
EXIM_MAKECAT +=		"LOOKUP_SQLITE=yes\n"
EXIM_LOOKUP_LIBS +=	-lsqlite3
WANTLIB-main +=		sqlite3>=8
.endif

.if ${FLAVOR:Mldap}
EXIM_MAKECAT +=		"LOOKUP_LDAP=yes\n"
EXIM_MAKECAT +=		"LDAP_LIB_TYPE=OPENLDAP2\n"
EXIM_LOOKUP_LIBS +=	-L${LOCALBASE}/lib -lldap -llber
LIB_DEPENDS-main +=	databases/openldap>=2.3
WANTLIB-main +=		ldap>=9 lber
.endif

.if ${FLAVOR:Msasl}
EXIM_MAKECAT +=		"AUTH_CYRUS_SASL=yes\n"
EXIM_EXTRA_LIBS +=	-L${LOCALBASE}/lib -lsasl2
LIB_DEPENDS-main +=	security/cyrus-sasl2
WANTLIB-main +=		sasl2
.endif

EXIM_EXTRA_LIBS +=	-L${LOCALBASE}/lib -liconv

EXIM_MAKECAT +=		"BIN_DIRECTORY=${PREFIX}/bin\n"
EXIM_MAKECAT +=		"CONFIGURE_FILE=${SYSCONFDIR}/exim/configure\n"
EXIM_MAKECAT +=		"LOOKUP_INCLUDE=${EXIM_LOOKUP_INCLUDE}\n"
EXIM_MAKECAT +=		"LOOKUP_LIBS=${EXIM_LOOKUP_LIBS}\n"
EXIM_MAKECAT +=		"EXTRALIBS_EXIM=${EXIM_EXTRA_LIBS}\n"
EXIM_MAKECAT +=		"CFLAGS=${CFLAGS} ${EXIM_CFLAGS}\n"
EXIM_MAKECAT +=		"INCLUDE=-I${LOCALBASE}/include\n"

NO_TEST =		Yes

do-configure:
	@@mkdir -p ${WRKSRC}/Local
	@@cp ${FILESDIR}/Makefile ${WRKSRC}/Local
	@@echo -n ${EXIM_MAKECAT} >> ${WRKSRC}/Local/Makefile
	@@cp ${FILESDIR}/eximon.conf ${WRKSRC}/Local

pre-fake:
	${INSTALL_DATA_DIR} ${WRKINST}${SYSCONFDIR}/mail

post-install:
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/exim
	${INSTALL_DATA} ${WRKINST}${SYSCONFDIR}/exim/configure \
	    ${PREFIX}/share/examples/exim
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/exim
	${INSTALL_DATA} ${WRKSRC}/doc/spec.txt ${PREFIX}/share/doc/exim
	${INSTALL_DATA} ${WRKSRC}/doc/README.SIEVE ${PREFIX}/share/doc/exim
	${INSTALL_DATA} ${WRKSRC}/doc/filter.txt ${PREFIX}/share/doc/exim
	${SUBST_DATA} ${FILESDIR}/mailer.conf.exim \
	    ${PREFIX}/share/doc/exim/mailer.conf.exim
	${INSTALL_SCRIPT} ${FILESDIR}/exim-enable ${FILESDIR}/exim-disable \
	    ${PREFIX}/sbin
	${INSTALL_MAN} ${WRKSRC}/doc/exim.8 ${PREFIX}/man/man8

.include <bsd.port.mk>
@


1.112
log
@security update to exim-4.88, changelog includes

JH/27 Fix a possible security hole, wherein a process operating with the Exim
      UID can gain a root shell.  Credit to http://www.halfdog.net/ for
      discovery and writeup.  Ubuntu bug 1580454; no bug raised against Exim
      itself :(

JH/34 SECURITY: Use proper copy of DATA command in error message.
      Could leak key material.  Remotely explaoitable.  CVE-2016-9963.

whoever decided to have an embargo period ending on 25 December: this was
not a particularly good idea
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.111 2016/12/24 16:02:10 sthen Exp $
d6 1
a6 1
VERSION =		4.88
@


1.111
log
@Enable LMTP transport in mail/exim, requested by Thomas Schneider
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.110 2016/09/12 17:51:07 naddy Exp $
d6 1
a6 1
VERSION =		4.87
a8 1
REVISION-main =		1
d20 1
a20 1
WANTLIB-main =		${cWANTLIB} crypto iconv perl pthread pcre ssl
@


1.110
log
@replace libiconv module
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.109 2016/07/09 08:46:24 sthen Exp $
d9 1
a9 1
REVISION-main =		0
@


1.109
log
@sync WANTLIB
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.108 2016/04/06 21:41:55 sthen Exp $
d21 1
a21 1
WANTLIB-main =		${WANTLIB} ${cWANTLIB} crypto perl pthread pcre ssl
d29 1
a29 2
MODULES =		converters/libiconv
LIB_DEPENDS-main =	${LIB_DEPENDS} devel/pcre
@


1.108
log
@update to exim-4.87
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.107 2016/03/07 15:34:16 sthen Exp $
d9 1
d21 1
a21 1
WANTLIB-main =		${WANTLIB} ${cWANTLIB} crypto perl ssl util pcre
@


1.107
log
@fix ECDH as server in Exim, from Renaud Allard
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.106 2016/03/02 20:13:54 sthen Exp $
d6 1
a6 2
VERSION =		4.86.2
REVISION-main =		0
@


1.106
log
@security update to exim 4.86.2: clean the environment and "cd /" at startup.

"Any user who can start an instance of Exim (and this is normally *any* user)
can gain root privileges. If you do not use 'perl_startup' you *should* be
safe."  CVE-2016-1531
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.105 2015/08/17 19:10:12 sthen Exp $
d7 1
@


1.105
log
@sync WANTLIB
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.104 2015/08/12 22:11:57 sthen Exp $
d6 1
a6 1
VERSION =		4.86
a8 1
REVISION-main =		0
@


1.105.2.1
log
@MFC fixes for mail/exim:

- security update to exim 4.86.2: clean the environment and "cd /" at startup.
"Any user who can start an instance of Exim (and this is normally *any* user)
can gain root privileges. If you do not use 'perl_startup' you *should* be
safe."  CVE-2016-1531

- fix ECDH as server in Exim, from Renaud Allard (LibreSSL incompatibility)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.107 2016/03/07 15:34:16 sthen Exp $
d6 1
a6 2
VERSION =		4.86.2
REVISION-main =		0
d9 1
@


1.104
log
@update to exim-4.86
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.103 2015/07/15 17:10:35 ajacoutot Exp $
d9 1
d52 1
a52 1
WANTLIB-main +=		lib/mysql/mysqlclient
@


1.103
log
@No need to override pexp.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.102 2015/01/15 21:39:36 kirby Exp $
d6 1
a6 1
VERSION =		4.85
a10 1
REVISION-main =		1
@


1.102
log
@ - sort variables
 - add some blank lines for higher readability
 - drop USE_GROFF (mandoc version looks better)
 - bump for safety
OK sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.101 2015/01/13 18:00:23 sthen Exp $
d11 1
a11 1
REVISION-main =		0
@


1.101
log
@update to exim 4.85
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.100 2014/09/13 18:09:21 brad Exp $
a2 1
CATEGORIES =		mail
d5 1
d11 3
a13 4
MASTER_SITES =		http://ftp.exim.org/pub/exim/exim4/ \
			http://ftp.exim.org/pub/exim/exim4/old/ \
			ftp://ftp.exim.org/pub/exim/exim4/ \
			http://mirror.switch.ch/ftp/mirror/exim/exim/exim4/
d20 8
a27 4
PSEUDO_FLAVORS =	no_eximon
FLAVORS =		mysql postgresql sqlite3 ldap sasl
FLAVOR ?=
MULTI_PACKAGES =	-main -eximon
a30 3
cWANTLIB =		c m
WANTLIB-main =		${WANTLIB} ${cWANTLIB} crypto perl ssl util pcre
WANTLIB-eximon =	${cWANTLIB} X11 Xaw Xext Xmu Xt pcre
d34 6
a39 2
USE_GROFF =		Yes
NO_TEST =		Yes
d94 1
a94 1
MAKE_FLAGS +=		FULLECHO=
@


1.100
log
@Switch from using MySQL to using MariaDB attempt #2. MariaDB is a drop-in replacement.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.99 2014/08/10 09:58:05 espie Exp $
d6 1
a6 1
VERSION =		4.83
a10 1
REVISION-main =		0
@


1.99
log
@use more specific version of SUBST_* where appropriate
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.98 2014/07/23 10:36:24 sthen Exp $
d11 1
d48 2
a49 2
LIB_DEPENDS-main +=	databases/mysql
WANTLIB-main +=		lib/mysql/mysqlclient>=10
@


1.98
log
@update to Exim 4.83, fixes CVE-2014-2972 - more information at
https://lists.exim.org/lurker/message/20140722.152452.d6c019e8.en.html

ok naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.97 2014/05/28 14:23:27 sthen Exp $
d109 1
a109 2
	${SUBST_CMD} -c -o ${SHAREOWN} -g ${SHAREGRP} \
	    ${FILESDIR}/mailer.conf.exim \
@


1.97
log
@update to exim 4.82.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.96 2014/03/24 17:39:35 sthen Exp $
d6 1
a6 1
VERSION =		4.82.1
@


1.96
log
@disable tcp wrappers
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.95 2014/03/13 14:50:41 sthen Exp $
d6 1
a6 2
VERSION =		4.80.1
REVISION-main =		1
@


1.95
log
@default MTA is now smtpd not sendmail
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.94 2013/08/24 09:22:25 sthen Exp $
d7 1
a7 1
REVISION-main =		0
d30 1
a30 1
WANTLIB-main =		${WANTLIB} ${cWANTLIB} crypto perl ssl util wrap pcre
d81 1
a81 1
EXIM_EXTRA_LIBS +=	-lwrap -L${LOCALBASE}/lib -liconv
@


1.94
log
@update to exim 4.80.1, and drop fkr@@ as maintainer at his request
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.93 2013/06/12 20:36:33 brad Exp $
d7 1
@


1.93
log
@Revert back to using MySQL 5.1 for the time being. MariaDB 5.5 introduces
a new libmysqlclient non-blocking API which utilizes co-routines. The X86
specific GCC ASM co-routine support hid the fact that there was an issue.
The only fallback code so far is POSIX user contexts which OpenBSD does not
support.

Input from and Ok sthen@@ jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.92 2013/05/25 00:33:09 brad Exp $
d6 1
a6 2
VERSION =		4.77
REVISION =		4
a16 2

MAINTAINER =		Felix Kronlage <fkr@@openbsd.org>
@


1.92
log
@Switch from using MySQL to using MariaDB. MariaDB is a drop-in replacement.


ok sthen aja
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.91 2013/03/11 11:23:50 espie Exp $
d7 1
a7 1
REVISION =		3
d50 1
a50 1
LIB_DEPENDS-main +=	databases/mariadb
@


1.91
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.90 2012/10/26 08:50:01 sthen Exp $
d7 1
a7 1
REVISION =		2
d50 1
a50 1
LIB_DEPENDS-main +=	databases/mysql
@


1.90
log
@SECURITY fix for Exim CVE-2012-5671 - Remote code execution with DKIM decoding

Workaround: "You are not vulnerable if <...> you put this at the start
of an ACL plumbed into acl_smtp_connect or acl_smtp_rcpt:

  warn control = dkim_disable_verify"

This is backported from the diff between exim 4.80 and 4.80.1
(not updating fully to 4.80.1 yet as this small diff is safer to commit)

same diff rpointel@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.89 2012/04/30 13:08:18 espie Exp $
a22 3
PERMIT_PACKAGE_FTP =     Yes
PERMIT_DISTFILES_CDROM = Yes
PERMIT_DISTFILES_FTP =   Yes
d38 1
a38 1
NO_REGRESS =		Yes
@


1.89
log
@and bump
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.88 2012/04/30 13:07:58 espie Exp $
d7 1
a7 1
REVISION =		1
@


1.89.2.1
log
@SECURITY fix for Exim CVE-2012-5671 - Remote code execution with DKIM decoding

Workaround: "You are not vulnerable if <...> you put this at the start
of an ACL plumbed into acl_smtp_connect or acl_smtp_rcpt:

  warn control = dkim_disable_verify"

This is backported from the diff between exim 4.80 and 4.80.1
(not updating fully to 4.80.1 yet as this small diff is safer to commit)

same diff rpointel@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.89 2012/04/30 13:08:18 espie Exp $
d7 1
a7 1
REVISION =		2
@


1.88
log
@sqlite3 dep must die
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.87 2011/12/17 22:01:13 sthen Exp $
d7 1
a7 1
REVISION =		0
@


1.87
log
@Where a program with an rc script _requires_ a certain command line
parameter to daemonize, move the parameter from daemon to daemon_flags,
so that the user cannot inadvertently prevent it from daemonizing by
adjusting the flags.

Discussed with ajacoutot and schwarze, this method was suggested
by schwarze@@ as a simpler alternative to my diff. ok aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.86 2011/11/18 13:29:29 espie Exp $
d67 1
a67 2
EXIM_LOOKUP_LIBS +=	-L${LOCALBASE}/lib/ -lsqlite3
LIB_DEPENDS-main +=	databases/sqlite3
@


1.87.2.1
log
@SECURITY fix for Exim CVE-2012-5671 - Remote code execution with DKIM decoding

Workaround: "You are not vulnerable if <...> you put this at the start
of an ACL plumbed into acl_smtp_connect or acl_smtp_rcpt:

  warn control = dkim_disable_verify"

This is backported from the diff between exim 4.80 and 4.80.1
(not updating fully to 4.80.1 yet as this small diff is safer to commit)

same diff rpointel@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.87 2011/12/17 22:01:13 sthen Exp $
d7 1
a7 1
REVISION =		1
@


1.86
log
@new-style pseudo flavors
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.85 2011/10/19 23:06:57 fkr Exp $
d7 1
@


1.85
log
@update to exim version 4.77.
This release changes the behaviour of certain expansion methods.
Details can be found here: http://www.gossamer-threads.com/lists/exim/announce/92353

ok sthen@@, jasper@@ and ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.84 2011/09/16 10:31:21 espie Exp $
d29 1
a29 1
MULTI_PACKAGES =	-main
d42 3
a44 2
.if !${FLAVOR:L:Mno_eximon}
MULTI_PACKAGES +=	-eximon
d48 1
a48 1
.if ${FLAVOR:L:Mmysql}
d56 1
a56 1
.if ${FLAVOR:L:Mpostgresql}
d64 1
a64 1
.if ${FLAVOR:L:Msqlite3}
d71 1
a71 1
.if ${FLAVOR:L:Mldap}
d79 1
a79 1
.if ${FLAVOR:L:Msasl}
@


1.84
log
@normalize pkgpath
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.83 2011/07/17 20:15:59 sthen Exp $
d6 1
a6 1
VERSION =		4.76
a10 1
REVISION-main =		2
@


1.83
log
@Add an rc script for exim, ok aja@@ fkr@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.82 2011/05/11 12:57:48 jasper Exp $
d11 1
a11 1
REVISION-main =		1
@


1.82
log
@Sanitize some @@unexec/@@extraunexec calls to rm: move them up in the
PLIST and delete everything under the @@sample'd directory instead of the
directory itself to prevent a warning from pkg_delete(1) trying to
remove a non existing directory and to help preventing left-over files
and directories.

ok aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.81 2011/05/09 14:56:56 fkr Exp $
d11 5
a15 5
REVISION-main = 	0
MASTER_SITES =		ftp://ftp.exim.org/pub/exim/exim4/ \
			ftp://ftp.exim.org/pub/exim/exim4/old/ \
			http://mirror.switch.ch/ftp/mirror/exim/exim/exim4/ \
			ftp://mirror.switch.ch/mirror/exim/exim/exim4/
d109 2
a110 1
	${INSTALL_DATA} ${WRKINST}${SYSCONFDIR}/exim/configure ${PREFIX}/share/examples/exim
d115 5
@


1.81
log
@update exim to version 4.76.

This contains a security fix for CVE-2011-1764.

ok sthen@@ and jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.80 2011/02/07 16:01:26 jasper Exp $
d11 1
@


1.80
log
@Security fix for CVE-2011-0017
Patch extracted from exim 3.74.

ok fkr@@ (MAINTAINER), sthen@@, ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.79 2011/01/12 05:45:29 fkr Exp $
d6 1
a6 1
VERSION =		4.73
a8 1
REVISION-main = 	0
@


1.80.2.1
log
@update exim to version 4.76.
This contains a security fix for CVE-2011-1764.

as agreed by sthen@@ and fkr@@ the fix for stable is the full update, as 4.75
was tested succesfully by various people and the bump to 4.76 only contains
the security fix.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.80 2011/02/07 16:01:26 jasper Exp $
d6 1
a6 1
VERSION =		4.76
d9 1
@


1.79
log
@update to exim 4.73.
While this resolves CVE-2010-4344 and CVE-2010-4345, the first was
actually fixed in exim 4.70 and the latter is a no-issue on OpenBSD
due to it always being built with ALT_CONFIG_ROOT_ONLY.

with input from Andreas Voegele
ok sthen@@, jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.78 2010/11/19 07:23:06 espie Exp $
d9 1
d13 1
@


1.78
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.77 2010/11/11 10:54:02 espie Exp $
d6 1
a6 1
VERSION =		4.72
@


1.77
log
@a few email WANTLIBs
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.76 2010/11/06 10:18:38 espie Exp $
d31 1
a31 1
LIB_DEPENDS-main =	${LIB_DEPENDS} ::devel/pcre
d35 2
a36 2
RUN_DEPENDS-eximon =	::${PKGPATH},-main
LIB_DEPENDS-eximon =	::devel/pcre
d50 2
a51 2
LIB_DEPENDS-main +=	:mysql-client-*:databases/mysql
WANTLIB-main +=		lib/mysql/mysqlclient.>=10
d58 2
a59 2
LIB_DEPENDS-main +=	:postgresql-client-*:databases/postgresql
WANTLIB-main +=		pq.>=2
d65 2
a66 2
LIB_DEPENDS-main +=	::databases/sqlite3
WANTLIB-main +=		sqlite3.>=8
d73 2
a74 2
LIB_DEPENDS-main +=	:openldap-client->=2.3:databases/openldap
WANTLIB-main +=		ldap.>=9 lber
d80 1
a80 1
LIB_DEPENDS-main +=	::security/cyrus-sasl2
@


1.76
log
@convert libiconv to new wantlib
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.75 2010/10/24 21:25:12 ajacoutot Exp $
d31 1
a31 1
LIB_DEPENDS-main =	${LIB_DEPENDS} pcre::devel/pcre
d33 2
a34 2
WANTLIB-main =		${WANTLIB} ${cWANTLIB} crypto perl ssl util wrap
WANTLIB-eximon =	${cWANTLIB} X11 Xaw Xext Xmu Xt
d36 1
a36 1
LIB_DEPENDS-eximon =	pcre::devel/pcre
d38 1
a38 1
USE_GROFF =	Yes
d50 2
a51 1
LIB_DEPENDS-main +=	lib/mysql/mysqlclient.>=10:mysql-client-*:databases/mysql
d58 2
a59 1
LIB_DEPENDS-main +=	pq.>=2:postgresql-client-*:databases/postgresql
d65 2
a66 1
LIB_DEPENDS-main +=	sqlite3.>=8::databases/sqlite3
d73 2
a74 1
LIB_DEPENDS-main +=	ldap.>=9,lber:openldap-client->=2.3:databases/openldap
d80 2
a81 1
LIB_DEPENDS-main +=	sasl2::security/cyrus-sasl2
@


1.75
log
@Remove USE_X11.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.74 2010/10/18 19:59:15 espie Exp $
d32 3
a34 3
WANTLIB =		c m
WANTLIB-main =		${WANTLIB} crypto perl ssl util wrap
WANTLIB-eximon =		${WANTLIB} X11 Xaw Xext Xmu Xt
@


1.74
log
@USE_GROFF=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.73 2010/06/15 08:43:30 fkr Exp $
a41 1
USE_X11 =		Yes
@


1.73
log
@Update exim to version 4.72.
This includes security fixes for CVE-2010-2023 and CVE-2010-2024.
ok bernd@@, sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.72 2010/02/02 20:23:30 sthen Exp $
d38 1
@


1.73.2.1
log
@Security fix for CVE-2011-0017
Patch extracted from exim 3.74.

ok fkr@@ (MAINTAINER), sthen@@, ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.73 2010/06/15 08:43:30 fkr Exp $
a8 1
REVISION-main = 	0
a11 1
			ftp://ftp.exim.org/pub/exim/exim4/old/ \
@


1.72
log
@Fix RUN_DEPENDS-eximon and FULLPKGPATH-eximon too, they were
varying according to the flavour. ok espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.70 2010/01/15 07:59:45 jasper Exp $
d6 1
a6 1
VERSION =		4.71
d8 2
a9 2
PKGNAME-main =		exim-${VERSION}p0
FULLPKGNAME-eximon =	exim-eximon-${VERSION}p1
@


1.72.2.1
log
@MFC:

SECURITY UPDATE to exim-4.72

Resolves CVE-2010-2023 and CVE-2010-2024

version upgrade ok fkr@@ sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.72 2010/02/02 20:23:30 sthen Exp $
d6 1
a6 1
VERSION =		4.72
d8 2
a9 2
PKGNAME-main =		exim-${VERSION}
FULLPKGNAME-eximon =	exim-eximon-${VERSION}
@


1.71
log
@setting fullpkgname implies it's the same package, not depending on
flavors. This is actually the case, but the eximon LIB_DEPENDS are
wrong (they pick up sqlite... as main should have them).

Fix the LIB_DEPENDS, bump the eximon packagename, and that's it.
@
text
@d10 1
d31 1
a31 1
LIB_DEPENDS =		pcre::devel/pcre
d34 3
a36 3
WANTLIB-eximon =	${WANTLIB} X11 Xaw Xext Xmu Xt
RUN_DEPENDS-eximon =	::${BASE_PKGPATH},-main
LIB_DEPENDS-main =	${LIB_DEPENDS}
d38 1
a38 1
NO_REGRESS =	Yes
d63 1
a63 1
LIB_DEPENDS-main +=		sqlite3.>=8::databases/sqlite3
d70 1
a70 1
LIB_DEPENDS-main +=		ldap.>=9,lber:openldap-client->=2.3:databases/openldap
d76 1
a76 1
LIB_DEPENDS-main +=		sasl2::security/cyrus-sasl2
@


1.70
log
@- bump exim-eximon pkgname after recent ldap pkgspec change.

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.69 2010/01/09 11:47:32 sthen Exp $
d3 8
a10 8
CATEGORIES=		mail
COMMENT-main=		flexible mail transfer agent
COMMENT-eximon=		X11 monitor tool for Exim MTA
VERSION=		4.71
DISTNAME=		exim-${VERSION}
PKGNAME-main=		exim-${VERSION}p0
FULLPKGNAME-eximon=	exim-eximon-${VERSION}p0
MASTER_SITES=		ftp://ftp.exim.org/pub/exim/exim4/ \
d14 1
a14 1
HOMEPAGE=		http://www.exim.org/
d16 1
a16 1
MAINTAINER=		Felix Kronlage <fkr@@openbsd.org>
d19 17
a35 16
PERMIT_PACKAGE_CDROM=   Yes
PERMIT_PACKAGE_FTP=     Yes
PERMIT_DISTFILES_CDROM= Yes
PERMIT_DISTFILES_FTP=   Yes

PSEUDO_FLAVORS=		no_eximon
FLAVORS=		mysql postgresql sqlite3 ldap sasl
FLAVOR?=
MULTI_PACKAGES=		-main

MODULES=		converters/libiconv
LIB_DEPENDS=		pcre::devel/pcre
WANTLIB=		c m
WANTLIB-main=		${WANTLIB} crypto perl ssl util wrap
WANTLIB-eximon=		${WANTLIB} X11 Xaw Xext Xmu Xt
RUN_DEPENDS-eximon=	::${BASE_PKGPATH},-main
d37 1
a37 1
NO_REGRESS=Yes
d40 3
a42 3
USE_X11=		Yes
MULTI_PACKAGES+=	-eximon
EXIM_MAKECAT+=		"EXIM_MONITOR=eximon.bin\n"
d46 4
a49 4
EXIM_MAKECAT+=		"LOOKUP_MYSQL=yes\n"
EXIM_LOOKUP_INCLUDE+=	-I${LOCALBASE}/include/mysql
EXIM_LOOKUP_LIBS+=	-L${LOCALBASE}/lib/mysql -lmysqlclient
LIB_DEPENDS+=		lib/mysql/mysqlclient.>=10:mysql-client-*:databases/mysql
d53 4
a56 4
EXIM_MAKECAT+=		"LOOKUP_PGSQL=yes\n"
EXIM_LOOKUP_INCLUDE+=	-I${LOCALBASE}/include/postgresql
EXIM_LOOKUP_LIBS+=	-L${LOCALBASE}/lib/ -lpq
LIB_DEPENDS+=		pq.>=2:postgresql-client-*:databases/postgresql
d60 3
a62 3
EXIM_MAKECAT+=		"LOOKUP_SQLITE=yes\n"
EXIM_LOOKUP_LIBS+=	-L${LOCALBASE}/lib/ -lsqlite3
LIB_DEPENDS+=		sqlite3.>=8::databases/sqlite3
d66 4
a69 4
EXIM_MAKECAT+=		"LOOKUP_LDAP=yes\n"
EXIM_MAKECAT+=		"LDAP_LIB_TYPE=OPENLDAP2\n"
EXIM_LOOKUP_LIBS+=	-L${LOCALBASE}/lib -lldap -llber
LIB_DEPENDS+=		ldap.>=9,lber:openldap-client->=2.3:databases/openldap
d73 14
a86 14
EXIM_MAKECAT+=		"AUTH_CYRUS_SASL=yes\n"
EXIM_EXTRA_LIBS+=	-L${LOCALBASE}/lib -lsasl2
LIB_DEPENDS+=		sasl2::security/cyrus-sasl2
.endif

EXIM_EXTRA_LIBS+=	-lwrap -L${LOCALBASE}/lib -liconv

EXIM_MAKECAT+=		"BIN_DIRECTORY=${PREFIX}/bin\n"
EXIM_MAKECAT+=		"CONFIGURE_FILE=${SYSCONFDIR}/exim/configure\n"
EXIM_MAKECAT+=		"LOOKUP_INCLUDE=${EXIM_LOOKUP_INCLUDE}\n"
EXIM_MAKECAT+=		"LOOKUP_LIBS=${EXIM_LOOKUP_LIBS}\n"
EXIM_MAKECAT+=		"EXTRALIBS_EXIM=${EXIM_EXTRA_LIBS}\n"
EXIM_MAKECAT+=		"CFLAGS=${CFLAGS} ${EXIM_CFLAGS}\n"
EXIM_MAKECAT+=		"INCLUDE=-I${LOCALBASE}/include\n"
d88 1
a88 1
MAKE_FLAGS+=		FULLECHO=
@


1.69
log
@LIB_DEPENDS for the -ldap flavour has a bad package spec which is
now rejected by pkg_create; fix and bump PKGNAME-main.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.68 2009/12/15 11:32:18 sthen Exp $
d9 1
a9 1
FULLPKGNAME-eximon=	exim-eximon-${VERSION}
@


1.68
log
@- update to 4.71
- tweak MESSAGE/DESCR
- drop no_x11 flavour in favour of an -eximon subpackage and a
pseudo-flavour to disable it
- use iconv by default rather than as a flavour
- drop no_exiscan flavour

from bernd@@, Bjorn Ketelaars and myself; ok fkr@@ bernd@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.67 2009/08/10 06:32:42 kili Exp $
d8 1
a8 1
PKGNAME-main=		exim-${VERSION}
d68 1
a68 1
LIB_DEPENDS+=		ldap.>=2,lber:openldap-client-2.*:databases/openldap
@


1.67
log
@WANTLIB changes after xcb addition and bump.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.66 2009/07/22 10:48:31 sthen Exp $
d3 10
a12 7
COMMENT=	Flexible mail transfer agent
DISTNAME=	exim-4.69
PKGNAME=	${DISTNAME}p2
CATEGORIES=	mail
MASTER_SITES=	ftp://ftp.exim.org/pub/exim/exim4/ \
		http://mirror.switch.ch/ftp/mirror/exim/exim/exim4/ \
		ftp://mirror.switch.ch/mirror/exim/exim/exim4/
d14 1
a14 1
HOMEPAGE=	http://www.exim.org/
d16 1
a16 1
MAINTAINER=	Felix Kronlage <fkr@@openbsd.org>
d18 1
a18 1
# GPL
a22 1
WANTLIB=		c crypto perl ssl util wrap m
d24 2
a25 1
FLAVORS=no_exiscan no_x11 mysql postgresql sqlite3 ldap iconv sasl
d27 8
d38 1
a38 6
.if !${FLAVOR:L:Mno_exiscan}
EXIM_MAKECAT+=		"WITH_CONTENT_SCAN=yes\n"
EXIM_MAKECAT+=		"WITH_OLD_DEMIME=yes\n"
.endif

.if !${FLAVOR:L:Mno_x11}
d40 1
a41 1
WANTLIB+=		X11 Xaw Xext Xmu Xt pthread-stubs xcb
a59 1
EXIM_LOOKUP_INCLUDE+=	-I${LOCALBASE}/include
a66 1
EXIM_LOOKUP_INCLUDE+=	-I${LOCALBASE}/include
d68 1
a68 8
LIB_DEPENDS+=		ldap.>=2,lber:openldap-client->=2,<3:databases/openldap
.endif

.if ${FLAVOR:L:Miconv}
MODULES=		converters/libiconv
EXIM_MAKECAT+=		"HAVE_ICONV=yes\n"
EXIM_EXTRA_LIBS+=	-L${LOCALBASE}/lib -liconv
EXIM_CFLAGS+=		-I${LOCALBASE}/include
a73 1
EXIM_CFLAGS+=		-I${LOCALBASE}/include
d77 1
a77 1
EXIM_EXTRA_LIBS+=	-lwrap
a78 1
EXIM_MAKECAT+=		"AUTH_DOVECOT=yes\n"
d85 3
a92 1
.if !${FLAVOR:L:Mno_x11}
a93 1
.endif
a100 1
	${INSTALL_DATA} ${WRKSRC}/build-`uname -s`-`uname -m`/convert4r4 ${PREFIX}/share/examples/exim
@


1.66
log
@- enable Dovecot authentication (optional, adds no dependencies)
- regen PLIST, bump PKGNAME

ok fkr@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.65 2009/03/16 17:52:52 sthen Exp $
d5 1
a5 1
PKGNAME=	${DISTNAME}p1
d35 1
a35 1
WANTLIB+=		X11 Xaw Xext Xmu Xt
@


1.65
log
@fix depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.64 2008/02/03 20:39:11 fkr Exp $
d5 1
a5 1
PKGNAME=	${DISTNAME}p0
d83 1
@


1.64
log
@update to exim version 4.69
ok jasper@@, bernd@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.63 2007/09/16 00:17:04 merdely Exp $
d5 1
d64 1
a64 1
LIB_DEPENDS+=		ldap.>=2,lber:openldap-client-2.*:databases/openldap
@


1.63
log
@Remove surrounding quotes in COMMENT*/PERMIT_*
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62 2007/09/10 20:08:16 fkr Exp $
d4 1
a4 1
DISTNAME=	exim-4.68
@


1.62
log
@update to version 4.68, change to patches/patch-scripts_exim_install
from Andreas Voegele (as discussed on ports@@, binary does not contain
version number anymore)

ok bernd@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.61 2007/04/20 18:14:22 fkr Exp $
d3 1
a3 1
COMMENT=	"Flexible mail transfer agent"
@


1.61
log
@update to exim version 4.67
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.60 2007/01/12 21:51:55 fkr Exp $
d4 1
a4 1
DISTNAME=	exim-4.67
@


1.60
log
@bump to version 4.66, which (again, *sigh*) fixes bugs that were supposed to be
fixed in 4.65, that were introduced in 4.64.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59 2007/01/05 23:47:05 fkr Exp $
d4 1
a4 1
DISTNAME=	exim-4.66
@


1.59
log
@update to exim-4.65 (which mostly fixes two bugs that were introduced in
version 4.64)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2006/12/28 12:44:13 fkr Exp $
d4 1
a4 1
DISTNAME=	exim-4.65
@


1.58
log
@update to new version 4.64
ok mbalmer@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.57 2006/11/09 07:13:01 fkr Exp $
d4 1
a4 1
DISTNAME=	exim-4.64
@


1.57
log
@note in the PLIST that bin/exim-4.63 is installed suid root.
from sturm@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2006/10/30 20:54:27 fkr Exp $
d4 1
a4 2
DISTNAME=	exim-4.63
PKGNAME=	${DISTNAME}p1
@


1.56
log
@take over maintainership as discussed on ports@@
ok mbalmer@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55 2006/10/13 15:18:54 alek Exp $
d5 1
a5 1
PKGNAME=	${DISTNAME}p0
@


1.55
log
@Update to 4.63 from Andreas Vgele <andreas@@altroot.de>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.54 2006/08/03 13:09:09 espie Exp $
d5 1
d13 1
a13 1
MAINTAINER=	Andreas Voegele <andreas@@altroot.de>
@


1.54
log
@new lib specs
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2006/05/05 06:02:30 sturm Exp $
d4 1
a4 1
DISTNAME=	exim-4.62
@


1.53
log
@update to exim 4.62

from maintainer Andreas Voegele <andreas at altroot.de>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.52 2006/02/05 14:30:11 steven Exp $
d41 1
a41 1
LIB_DEPENDS+=		lib/mysql/mysqlclient.10:mysql-client-*:databases/mysql
d48 1
a48 1
LIB_DEPENDS+=		pq.2:postgresql-client-*:databases/postgresql
d55 1
a55 1
LIB_DEPENDS+=		sqlite3.8::databases/sqlite3
d63 1
a63 1
LIB_DEPENDS+=		ldap.2,lber:openldap-client-2.*:databases/openldap
@


1.52
log
@Revision 4.60-1 was rerolled into the 4.60 tarball. Only spec.txt changed.
Bump PKGNAME.
ok alek@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 2006/01/15 13:06:42 sturm Exp $
d4 1
a4 2
DISTNAME=	exim-4.60
PKGNAME=	${DISTNAME}p0
d12 1
a12 1
MAINTAINER=	Andreas Voegele <voegelas@@gmx.net>
d96 3
@


1.51
log
@update to exim 4.60 with new FLAVORS sqlite3 and sasl

from new maintainer Andreas Voegele <voegelas at gmx.net>
timeout from old maintainer
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2005/08/27 15:57:31 naddy Exp $
d5 1
@


1.50
log
@SECURITY:
CAN-2005-2491, http://securitytracker.com/id?1014744
A remote or local user may be able to supply a specially crafted
regular expression to trigger a heap integer overflow in PCRE.

ok pvalchev@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2005/07/06 23:18:10 jolan Exp $
d4 1
a4 2
DISTNAME=	exim-4.44
PKGNAME=	${DISTNAME}p0
d6 4
a9 5
MASTER_SITES=	ftp://ftp.csx.cam.ac.uk/pub/software/email/exim/exim4/ \
		http://ftp.planetmirror.com/pub/exim/exim4/ \
		ftp://ftp.planetmirror.com/pub/exim/exim4/
MASTER_SITES0=	http://duncanthrax.net/exiscan-acl/
				
d12 1
a12 1
MAINTAINER=	ilya voronin <ivoronin@@ivoronin.pp.ru>
d21 1
a21 1
FLAVORS=no_exiscan no_x11 mysql postgresql ldap iconv
d27 2
a28 2
PATCHFILES=		exiscan-acl-4.44-28.patch:0
PATCH_DIST_STRIP=	-p1
d51 7
d73 5
a77 5
.if ${FLAVOR:L:Mpostgresql}
LIB_DEPENDS+=	pq.2:postgresql-client-*:databases/postgresql
EXIM_MAKECAT+=	"LOOKUP_PGSQL=yes\n"
EXIM_LOOKUP_INCLUDE+=	-I${LOCALBASE}/include/postgresql
EXIM_LOOKUP_LIBS+=	-L${LOCALBASE}/lib -lpq
a105 5

.if !${FLAVOR:L:Mno_exiscan}
	${INSTALL_DATA} ${WRKSRC}/doc/exiscan-acl-examples.txt ${PREFIX}/share/doc/exim
	${INSTALL_DATA} ${WRKSRC}/doc/exiscan-acl-spec.txt ${PREFIX}/share/doc/exim
.endif
@


1.49
log
@remove peter galbavy as maintainer per his request
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2005/01/26 19:33:20 sturm Exp $
d4 2
a5 2
VERSION=	4.44
DISTNAME=	exim-${VERSION}
@


1.48
log
@SECURITY update to exim 4.44

This fixes lots of bugs and at least the security issues noticed in
CAN-2005-0021 and CAN-2005-0022.

based on a diff from "Andrey N. Oktyabrski" <ano at antora.ru>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2005/01/02 12:56:04 alek Exp $
d13 2
a14 2
MAINTAINER=	ilya voronin <ivoronin@@ivoronin.pp.ru> \
		Peter Galbavy <peter.galbavy@@knowtion.net>
@


1.48.2.1
log
@SECURITY:
CAN-2005-2491, http://securitytracker.com/id?1014744
A remote or local user may be able to supply a specially crafted
regular expression to trigger a heap integer overflow in PCRE.

ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2005/01/26 19:33:20 sturm Exp $
a5 1
PKGNAME=	${DISTNAME}p0
@


1.47
log
@Add WANTLIB markers
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2004/11/18 23:26:41 alek Exp $
d4 1
a4 1
VERSION=	4.41
a5 1
PKGNAME=	${DISTNAME}p0
d29 1
a29 1
PATCHFILES=		exiscan-acl-4.41-24.patch:0
@


1.46
log
@- Remove INSTALL script
- Use @@sample to install configuration files
- @@new(user|group) to create _exim user/group
- Add MESSAGE with tips&tricks from INSTALL
- Bump PKGNAME

MAINTAINERs timeout

ok strum@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2004/10/10 10:29:53 sturm Exp $
d22 1
d37 1
@


1.45
log
@/etc -> SYSCONFDIR

ok maintainer Peter Galbavy <peter.galbavy at knowtion.net>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2004/08/10 09:14:48 xsa Exp $
d6 1
@


1.44
log
@
new-style MODULES.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2004/07/26 10:56:01 peter Exp $
d92 1
a92 1
	${INSTALL_DATA} ${WRKINST}/etc/exim/configure ${PREFIX}/share/examples/exim
@


1.44.2.1
log
@http://www.vuxml.org/openbsd/29a17ee2-6fd9-11d9-a77b-080020f8e4df.html

patches borrowed from FreeBSD, ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2004/08/10 09:14:48 xsa Exp $
a5 1
PKGNAME=	${DISTNAME}p0
@


1.44.2.2
log
@MFC:
SECURITY:
CAN-2005-2491, http://securitytracker.com/id?1014744
A remote or local user may be able to supply a specially crafted
regular expression to trigger a heap integer overflow in PCRE

ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44.2.1 2005/01/27 06:34:10 sturm Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p1
@


1.43
log
@Update to exim 4.41.

This is a major update and configuration files are not compatible.
A conversion script is included and installed in

        ${PREFIX}/share/examples/exim4/convert4r4

New co-maintainer and much of the inital work done by Ilya Voronin.

A decision was made to include the semi-official exiscan patch in
the default installation, as most admins appear to use this. It is
hoped that is will become part of the core exim4 code "soon".

This port now creates an _exim user and group if they don't already
exist.

Work and testing by Ilya Voronin, Richard Welty, Axel Rau and others
who I can't now find in my mailbox. Apologies if I left you out.
@
text
@d1 1
a1 1
# $OpenBSD$
d60 1
a60 1
MODULES=		iconv
@


1.42
log
@Update to use new postgresql-client dependency
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2004/07/17 11:19:50 peter Exp $
d3 2
a4 4
COMMENT=	"flexible mail transfer agent"

VERSION=	3.36
VERSION_DOC=	3.30
a5 1
PKGNAME=	${DISTNAME}p3
d7 5
a11 6

MASTER_SITES=	ftp://ftp.csx.cam.ac.uk/pub/software/email/exim/exim3/ \
		ftp://ftp.exim.org/pub/exim/exim3/ \
		ftp://ftp.fu-berlin.de/unix/mail/exim/exim3/
DISTFILES=	exim-${VERSION}.tar.gz exim-texinfo-${VERSION_DOC}.tar.gz

d13 2
d16 5
a20 1
MAINTAINER=	Peter Galbavy <peter.galbavy@@knowtion.net>
d22 1
a22 7
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes

# ldap - once openldap is supported by exim
FLAVORS=	no_x11 no_perl mysql postgresql ldap no_ssl
d25 1
a25 2
MAKE_ENV=	FLAVOR="${FLAVOR}"
MAKE_FLAGS=	CC="${CC}" CFLAGS="${CFLAGS}"
d27 4
a30 3
EXIM_MAKECAT=
EXIM_LOOKUP_INCLUDE=
EXIM_LOOKUP_LIBS=
d33 2
a34 2
USE_X11=	Yes
EXIM_MAKECAT+=	"EXIM_MONITOR=eximon.bin\n"
d37 12
a48 2
.if !${FLAVOR:L:Mno_perl}
EXIM_MAKECAT+=	"EXIM_PERL=perl.o\n"
d52 2
a53 2
LIB_DEPENDS+=	ldap.2,lber:openldap-client-2.*:databases/openldap
EXIM_MAKECAT+=	"LOOKUP_LDAP=yes\nLDAP_LIB_TYPE=OPENLDAP2\n"
d56 1
d59 5
a63 5
.if ${FLAVOR:L:Mmysql}
LIB_DEPENDS+=	lib/mysql/mysqlclient.10::databases/mysql
EXIM_MAKECAT+=	"LOOKUP_MYSQL=yes\n"
EXIM_LOOKUP_INCLUDE+=	-I${LOCALBASE}/include/mysql
EXIM_LOOKUP_LIBS+=	-L${LOCALBASE}/lib/mysql -lmysqlclient
d73 1
a73 3
.if !${FLAVOR:L:Mno_ssl}
EXIM_MAKECAT+=	"SUPPORT_TLS=yes\nTLS_LIBS=-lssl -lcrypto\n"
.endif
d75 6
a80 1
NO_REGRESS=	Yes
d85 1
a88 7
	@@echo -n ${EXIM_MAKECAT} >> ${WRKSRC}/Local/Makefile
	@@echo "LOOKUP_INCLUDE=${EXIM_LOOKUP_INCLUDE}">>${WRKSRC}/Local/Makefile
	@@echo "LOOKUP_LIBS=${EXIM_LOOKUP_LIBS}">>${WRKSRC}/Local/Makefile
	@@cd ${WRKSRC}/doc ; \
	for i in ../../exim-texinfo-${VERSION_DOC}/doc/* ; do \
		ln -sf $$i ; \
	done
d90 1
a90 1
pre-install:
d92 2
a93 2

post-install:
d95 9
a103 1
	${INSTALL_DATA} ${WRKSRC}/doc/spec.txt ${PREFIX}/share/doc/exim/spec.txt
@


1.41
log
@back out my misunderstanding.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2004/07/15 19:32:45 peter Exp $
d60 1
a60 1
LIB_DEPENDS+=	pq.2::databases/postgresql
@


1.40
log
@allow the pgsql flavour to install with the postgresql-clients subpackage
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2004/05/10 08:42:42 brad Exp $
d60 1
a60 1
LIB_DEPENDS+=	pq.2::databases/postgresql,-clients
@


1.39
log
@simplify, use MAKE_FLAGS
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2004/05/10 07:42:32 brad Exp $
d60 1
a60 1
LIB_DEPENDS+=	pq.2::databases/postgresql
@


1.38
log
@Fix 2 buffer overflows in exim discovered by Georgi Guninski
Not exploitable in default install

http://www.guninski.com/exim1.html

ok MAINTAINER
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2004/01/02 05:03:33 brad Exp $
d30 1
a30 1
MAKE_FLAGS=	CC="${CC}"
@


1.37
log
@- remove useless LIBS variable
- fix a typo
- better LIB_DEPENDS entry for MySQL
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2003/09/03 17:21:05 brad Exp $
d8 1
a8 1
PKGNAME=	${DISTNAME}p2
d30 1
@


1.37.2.1
log
@Fix 2 buffer overflows in exim discovered by Georgi Guninski
Not exploitable in default install

http://www.guninski.com/exim1.html

ok MAINTAINER
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2004/05/10 08:42:42 brad Exp $
d8 1
a8 1
PKGNAME=	${DISTNAME}p3
a29 1
MAKE_FLAGS=	CC="${CC}" CFLAGS="${CFLAGS}"
@


1.37.2.2
log
@http://www.vuxml.org/openbsd/29a17ee2-6fd9-11d9-a77b-080020f8e4df.html
(CAN-2005-0022 does not apply)

patches borrowed from FreeBSD, ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37.2.1 2004/05/10 08:45:04 brad Exp $
d8 1
a8 1
PKGNAME=	${DISTNAME}p4
@


1.36
log
@Fix a remote heap overflow in exim, though it's probably not exploitable.

http://www.exim.org/pipermail/exim-announce/2003q3/000094.html

ok pvalchev@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2002/12/07 16:34:57 brad Exp $
d33 1
a33 1
EXIM_LOOKUP_LIB=
d52 1
a52 2
LIBS+=		${LOCALBASE}/lib/mysql
LIB_DEPENDS+=	lib/mysql/mysqlclient.10:mysql-client-3.23.*:databases/mysql
@


1.36.2.1
log
@Fix 2 buffer overflows in exim discovered by Georgi Guninski
Not exploitable in default install

http://www.guninski.com/exim1.html

ok MAINTAINER
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2004/05/10 08:42:42 brad Exp $
d8 1
a8 1
PKGNAME=	${DISTNAME}p3
a29 1
MAKE_FLAGS=	CC="${CC}" CFLAGS="${CFLAGS}"
d33 1
a33 1
EXIM_LOOKUP_LIBS=
d52 2
a53 1
LIB_DEPENDS+=	lib/mysql/mysqlclient.10::databases/mysql
@


1.35
log
@Fix a format string bug. The vulnerability can only be exploited by the
"admin user" of exim. Thus the risk of this vulnerability is low.

http://online.securityfocus.com/archive/1/302101/2002-2/2002-12-08/0
http://www.exim.org/pipermail/exim-users/Week-of-Mon-20021202/046978.html
--
From: MAINTAINER with heads up from me
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2002/11/21 00:15:10 naddy Exp $
d8 1
a8 1
PKGNAME=	${DISTNAME}p1
@


1.35.2.1
log
@MFC:
Fix a remote heap overflow in exim, though it's probably not exploitable.

http://www.exim.org/pipermail/exim-announce/2003q3/000094.html
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2002/12/07 16:34:57 brad Exp $
d8 1
a8 1
PKGNAME=	${DISTNAME}p2
@


1.34
log
@Update to 3.36; from Peter Galbavy <peter.galbavy@@knowtion.net>.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2002/10/27 17:21:39 naddy Exp $
d8 1
@


1.33
log
@No regression tests available.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2001/12/29 12:55:08 peter Exp $
d5 1
a5 1
VERSION=	3.34
@


1.32
log
@From the ChangeLog:

Version 3.34
------------
1. Exim was failing to diagnose a lone \ at the end of an expansion string as
an error (basically a typo in the code).

2. If logging was only to syslog, and Exim was trying to panic-die, it crashed
instead of dying cleanly.

3. If an address was routed using a DNS lookup that found no MX records, but
one or more A records, and fallback hosts were specified on the transport, the
fallback hosts were ignored.

4. $message_body_size was set incorrectly (to zero) during filter testing.

5. Ensure the configuration file is closed before running the -bi command.

6. Reap all complete processes within the loop for accepting -bs or -bS
messages, because it seems that not all OS do this automatically when SIGCHLD
is set to SIG_IGN.

7. Reset SIGHUP to SIG_IGN before restarting a daemon, in case another SIGHUP
arrives very quickly and kills the newly started Exim before it has a chance to
get going.

8. After "452 space shortage", was not unsetting the sender address. Could lead
to strange effects when the client was pipelining.

9. There was no check that getpeername() was giving a socket address when
called on stdin passed from a previous delivery.

10. If a local part beginning with a pipe symbol was directed to a pipe
transport, the transport got confused as to which command it should run.
This could be a security exposure if unchecked local parts are directed
or routed to pipe transports.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2001/12/03 15:06:30 naddy Exp $
d9 1
a9 1
NEED_VERSION=	1.502
d69 1
@


1.32.2.1
log
@MFC:
Update to 3.36
+
Fix a format string bug. The vulnerability can only be exploited by the
"admin user" of exim. Thus the risk of this vulnerability is low.

http://online.securityfocus.com/archive/1/302101/2002-2/2002-12-08/0
http://www.exim.org/pipermail/exim-users/Week-of-Mon-20021202/046978.html
--
From: MAINTAINER with heads up from me
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2001/12/29 12:55:08 peter Exp $
d5 1
a5 1
VERSION=	3.36
a7 1
PKGNAME=	${DISTNAME}p1
d9 1
a9 1

a68 1
NO_REGRESS=	Yes
@


1.32.4.1
log
@MFC:
Update to 3.36
+
Fix a format string bug. The vulnerability can only be exploited by the
"admin user" of exim. Thus the risk of this vulnerability is low.

http://online.securityfocus.com/archive/1/302101/2002-2/2002-12-08/0
http://www.exim.org/pipermail/exim-users/Week-of-Mon-20021202/046978.html
--
From: MAINTAINER with heads up from me
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2001/12/29 12:55:08 peter Exp $
d5 1
a5 1
VERSION=	3.36
a7 1
PKGNAME=	${DISTNAME}p1
d9 1
a9 1

a68 1
NO_REGRESS=	Yes
@


1.32.4.2
log
@MFC:
Fix a remote heap overflow in exim, though it's probably not exploitable.

http://www.exim.org/pipermail/exim-announce/2003q3/000094.html
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32.4.1 2002/12/10 15:29:31 brad Exp $
d8 1
a8 1
PKGNAME=	${DISTNAME}p2
@


1.31
log
@- update MASTER_SITES to new location
- better COMMENT

From Sebastian Stark <seb@@todesplanet.de>.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2001/11/17 00:12:23 naddy Exp $
d5 1
a5 1
VERSION=	3.33
d9 1
a9 1
NEED_VERSION=	1.474
@


1.30
log
@add lib/mysql path to library dependencies
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2001/10/24 12:22:45 espie Exp $
d3 1
a3 1
COMMENT=	"MTA for systems connected to the Internet"
d10 3
a12 3
MASTER_SITES=	ftp://ftp.csx.cam.ac.uk/pub/software/email/exim/ \
		ftp://ftp.exim.org/pub/exim/ \
		ftp://ftp.fu-berlin.de/unix/mail/exim/
@


1.29
log
@Complete lib dependencies
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2001/09/28 19:06:30 jakob Exp $
d52 1
a52 1
LIB_DEPENDS+=	mysqlclient.10:mysql-client-3.23.*:databases/mysql
@


1.28
log
@depend on openldap-client
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2001/09/07 22:23:46 peter Exp $
d9 1
a9 1
NEED_VERSION=	1.405
d44 1
a44 1
LIB_DEPENDS+=	ldap.2:openldap-client-2.*:databases/openldap
@


1.27
log
@change my official e-mail address
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2001/09/07 22:15:50 peter Exp $
d44 1
a44 1
LIB_DEPENDS+=	ldap.2::databases/openldap
@


1.26
log
@update to maintenance release 3.33 - see CHANGES file for what has
been fixed. There are no new features in this release.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2001/07/25 08:18:48 peter Exp $
d17 1
a17 1
MAINTAINER=	Peter Galbavy <peter.galbavy@@knowledge.com>
@


1.25
log
@update to exim 3.30

This does not yet include the IPv6 / IPv4 OpenBSD patch discussed on
various lists.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2001/06/03 05:32:16 brad Exp $
d5 2
a6 1
VERSION=	3.30
d13 1
a13 1
DISTFILES=	exim-${VERSION}.tar.gz exim-texinfo-${VERSION}.tar.gz
d80 1
a80 1
	for i in ../../exim-texinfo-${VERSION}/doc/* ; do \
@


1.24
log
@update dependency entries for MySQL.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2001/04/21 18:54:11 peter Exp $
d5 2
a6 1
DISTNAME=	exim-3.22
d9 1
a9 1
MASTER_SITES=	ftp://ftp.cus.cam.ac.uk/pub/software/programs/exim/ \
d12 1
a12 1
DISTFILES=	exim-3.22.tar.gz exim-texinfo-3.20.tar.gz
d79 1
a79 1
	for i in ../../exim-texinfo-3.20/doc/* ; do \
@


1.23
log
@bump NEED_VERSION
integrate COMMENT
change postgresql dependencies to new paths and names

ok espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2001/03/07 19:05:34 brad Exp $
d50 1
a50 1
LIB_DEPENDS+=	mysqlclient::databases/mysql
@


1.22
log
@remove major rev for mysqlclient dependency entry.
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.21 2001/02/28 15:13:19 brad Exp $
d7 1
a7 1
NEED_VERSION=	1.336
d23 1
a23 1
FLAVORS=	no_x11 no_perl mysql pgsql ldap no_tls
d56 1
a56 1
.if ${FLAVOR:L:Mpgsql}
d59 2
a60 2
EXIM_LOOKUP_INCLUDE+=	-I${LOCALBASE}/include/pgsql
EXIM_LOOKUP_LIBS+=	-L${LOCALBASE}/lib/pgsql -lpq
d63 1
a63 1
.if !${FLAVOR:L:Mno_tls}
@


1.21
log
@openldap, mysql and postgresql make shared libraries, dont cause great
pain with incorrect dependencies.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2001/02/23 11:30:02 peter Exp $
d48 1
a48 1
LIB_DEPENDS+=	mysqlclient.10::databases/mysql
@


1.20
log
@Update to exim 3.22.

Quite a few bug fixes and a small number of new features are
documented in doc/ChangeLog in the exim source tree.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2001/02/22 20:03:43 danh Exp $
d5 1
a5 1
NEED_VERSION=	1.324
d40 1
a40 1
BUILD_DEPENDS+=	${LOCALBASE}/lib/libldap.a::databases/openldap
d48 1
a48 1
BUILD_DEPENDS+=	${LOCALBASE}/lib/mysql/libmysqlclient.a::databases/mysql
d55 1
a55 1
BUILD_DEPENDS+=	${LOCALBASE}/lib/pgsql/libpq.a::databases/postgresql
@


1.19
log
@- update postgresql dependency based on 7.0.3 layout.
- /usr/local -> ${LOCALBASE}
- ${PREFIX} -> ${LOCALBASE}
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2000/12/07 15:27:33 peter Exp $
d3 1
a3 1
DISTNAME=	exim-3.20
d9 1
a9 1
DISTFILES=	exim-3.20.tar.gz exim-texinfo-3.20.tar.gz
@


1.18
log
@stupid CVS missed this again - but I expected it this time.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2000/10/27 12:56:09 espie Exp $
d40 1
a40 1
BUILD_DEPENDS+=	${PREFIX}/lib/libldap.a::databases/openldap
d42 2
a43 2
EXIM_LOOKUP_INCLUDE+=	-I/usr/local/include
EXIM_LOOKUP_LIBS+=	-L/usr/local/lib -lldap -llber
d47 2
a48 2
LIBS+=		${PREFIX}/lib/mysql
BUILD_DEPENDS+=	${PREFIX}/lib/mysql/libmysqlclient.a::databases/mysql
d50 2
a51 2
EXIM_LOOKUP_INCLUDE+=	-I/usr/local/include/mysql
EXIM_LOOKUP_LIBS+=	-L/usr/local/lib/mysql -lmysqlclient
d55 1
a55 1
BUILD_DEPENDS+=	${PREFIX}/pgsql/lib/libpq.a::databases/postgresql
d57 2
a58 2
EXIM_LOOKUP_INCLUDE+=	-I/usr/local/pgsql/include
EXIM_LOOKUP_LIBS+=	-L/usr/local/pgsql/lib -lpq
@


1.17
log
@MAINTAINER address
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2000/09/06 05:48:48 brad Exp $
d3 1
a3 1
DISTNAME=	exim-3.16
d9 1
a9 1
DISTFILES=	exim-3.16.tar.gz exim-texinfo-3.10.tar.gz
d13 1
a13 1
MAINTAINER=	Sebastian Stark <seb@@todesplanet.de>
d20 2
a21 1
FLAVORS=	no_x11
d25 5
d32 20
d54 12
d69 1
d71 4
d76 1
a76 1
	for i in ../../exim-texinfo-3.10/doc/* ; do \
@


1.16
log
@remove SYSCONFDIR from SUBST_VARS and SUBST_VARS too if no other variables
are listed
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2000/08/12 23:57:45 naddy Exp $
d13 1
a13 1
MAINTAINER=	seb@@gosh.todesplanet.de
@


1.15
log
@- update to 3.16; submitted by seb@@gosh.todesplanet.de
- move config file handling to (DE)INSTALL; requested by brad@@
- switch maintainer; offered by Peter
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2000/08/02 15:44:11 naddy Exp $
d5 5
a9 1
NEED_VERSION=	1.319
a19 5
MASTER_SITES=	ftp://ftp.cus.cam.ac.uk/pub/software/programs/exim/ \
		ftp://ftp.exim.org/pub/exim/ \
		ftp://ftp.fu-berlin.de/unix/mail/exim/
DISTFILES=	exim-3.16.tar.gz exim-texinfo-3.10.tar.gz

a23 1
SUBST_VARS=	SYSCONFDIR
@


1.14
log
@- add no_x11 flavor
- make build respect CC and CFLAGS
- add HOMEPAGE
- move example configuration to ${PREFIX}/share/examples/
- add RCS IDs
ok peter@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2000/06/04 22:42:05 espie Exp $
d3 1
a3 1
DISTNAME=	exim-3.14
d9 1
a9 1
MAINTAINER=	peter.galbavy@@knowledge.com
d19 1
a19 1
DISTFILES=	exim-3.14.tar.gz exim-texinfo-3.10.tar.gz
d23 3
a28 1
MAKE_ENV=	FLAVOR="${FLAVOR}"
d40 1
a40 1
	${INSTALL} -d ${DESTDIR}/etc/exim
d43 2
a44 3
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/exim
	${INSTALL_DATA} ${WRKSRC}/src/configure.default \
		${PREFIX}/share/examples/exim/configure.sample
@


1.13
log
@Fake, slightly non-trivial, as this involves fixing up the packaging.
@
text
@d1 1
a1 2
# $OpenBSD: Makefile,v 1.12 2000/04/26 09:40:57 peter Exp $
#
d5 3
a7 1
#FAKE=No
d16 3
a18 1
MASTER_SITES=	ftp://ftp.cus.cam.ac.uk/pub/software/programs/exim/
d21 7
d32 1
a32 1
	@@(cd ${WRKSRC}/doc ; \
d35 1
a35 1
	done )
d41 3
a43 3
	${INSTALL_DATA_DIR}	${PREFIX}/lib/exim
	@@cp ${WRKSRC}/src/configure.default ${PREFIX}/lib/exim/configure.sample

@


1.12
log
@Commit makefile *again*.

(I am starting to hate CVS).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2000/04/09 17:36:54 espie Exp $
d6 1
a6 1
FAKE=No
d28 1
a28 1
	${INSTALL} -d /etc/exim
d31 2
a32 17
	@@cp ${WRKSRC}/src/configure.default /etc/exim/configure.sample
	@@echo "EXIM is installed. You must now edit /etc/exim/configure"
	@@echo "and set the correct values for your system."
	@@echo
	@@echo "It is strongly advised that you configure exim to use"
	@@echo "a UID and GID other that 0/0. You can do this by adding"
	@@echo "lines to the configure file like this:"
	@@echo
	@@echo "\texim_user = \"nobody\""
	@@echo "\texim_group = \"nogroup\""
	@@echo
	@@echo "but you must remember to allow that user write"
	@@echo "permissions to /var/log/exim and /var/spool/exim"
	@@echo
	@@echo "If you intend replacing sendmail with exim, then don't"
	@@echo "forget to modify /etc/mailer.conf accordingly."
	@@echo
@


1.12.2.1
log
@bring mail as of cut-over date into 2.7 branch
@
text
@d1 2
a2 1
# $OpenBSD: Makefile,v 1.15 2000/08/12 23:57:45 naddy Exp $
d4 1
a4 1
DISTNAME=	exim-3.16
d6 1
a6 1
NEED_VERSION=	1.319
d8 1
a8 3
HOMEPAGE=	http://www.exim.org/

MAINTAINER=	seb@@gosh.todesplanet.de
d15 2
a16 13
MASTER_SITES=	ftp://ftp.cus.cam.ac.uk/pub/software/programs/exim/ \
		ftp://ftp.exim.org/pub/exim/ \
		ftp://ftp.fu-berlin.de/unix/mail/exim/
DISTFILES=	exim-3.16.tar.gz exim-texinfo-3.10.tar.gz

FLAVORS=	no_x11
FLAVOR?=

MAKE_ENV=	FLAVOR="${FLAVOR}"
SUBST_VARS=	SYSCONFDIR
.if !${FLAVOR:L:Mno_x11}
USE_X11=	Yes
.endif
d22 1
a22 1
	@@cd ${WRKSRC}/doc ; \
d25 1
a25 1
	done
d28 1
a28 1
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/exim
d31 18
a48 2
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/exim
	${INSTALL_DATA} ${WRKSRC}/doc/spec.txt ${PREFIX}/share/doc/exim/spec.txt
@


1.11
log
@explicit FAKE=No, so that we can turn FAKE on by default.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2000/03/17 03:25:58 turan Exp $
d4 1
a4 1
DISTNAME=	exim-3.13
d16 1
a16 1
DISTFILES=	exim-3.13.tar.gz exim-texinfo-3.10.tar.gz
a28 1
#	${INSTALL} -d /var/log/exim
@


1.10
log
@license
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2000/02/23 13:43:56 peter Exp $
d6 1
@


1.9
log
@cvs missed this, and I forgot to check out a fresh copy to double
check.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2000/02/12 08:29:36 turan Exp $
d8 5
@


1.8
log
@Combination GPL/COPY license.  delete info until it can be looked at.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2000/02/12 08:02:23 turan Exp $
d4 1
a4 1
DISTNAME=	exim-3.12
d10 1
a10 1
DISTFILES=	exim-3.12.tar.gz exim-texinfo-3.10.tar.gz
@


1.7
log
@gpl licenses
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2000/02/11 01:10:05 espie Exp $
a7 6

LICENSE_TYPE=		GPL
PERMIT_PKG_CDROM=	YES
PERMIT_PKG_FTP=		YES
PERMIT_DISTF_CDROM=	YES
PERMIT_DISTF_FTP=	YES
@


1.6
log
@Kill a large set of deprecated variables.
Thoroughly unsubtle, most mkdir -p should probably be INSTALL* at
*install stage, and echo/ECHO_MSG is somewhat unsorted.

It's quite possible I missed a few automated changes...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2000/01/26 11:54:13 peter Exp $
d8 6
@


1.5
log
@For some very strange reason, this file did not get committed. Rather
critical I think.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 1999/03/31 22:39:43 marc Exp $
d13 3
a15 3
	@@${MKDIR} ${WRKSRC}/Local
	@@${CP} ${FILESDIR}/Makefile ${WRKSRC}/Local
	@@${CP} ${FILESDIR}/eximon.conf ${WRKSRC}/Local
d26 1
a26 1
	@@${CP} ${WRKSRC}/src/configure.default /etc/exim/configure.sample
@


1.4
log
@update to exim-2.12; peter.galbavy@@knowledge.com
@
text
@d1 1
a1 1
# $OpenBSD$
d4 1
a4 1
DISTNAME=	exim-2.12
d10 1
a10 1
DISTFILES=	exim-2.12.tar.gz exim-texinfo-2.10.tar.gz
d15 1
a15 1
#	@@${CP} ${FILESDIR}/eximon.conf ${WRKSRC}/Local
d17 1
a17 1
	for i in ../../exim-texinfo-2.10/doc/* ; do \
d23 1
a23 1
	${INSTALL} -d /var/log/exim
d26 1
d39 5
@


1.3
log
@recent changes - new versions. all work.
@
text
@d1 1
a1 6
# OpenBSD makefile for: exim 
# Version required: 	1.71 
# Date created: 	10 Nov 1997
# Whom: 		ejovi  
#
# $OpenBSD: Makefile,v 1.2 1997/11/17 21:47:28 joey Exp $
d4 1
a4 1
DISTNAME=	exim-1.82
d6 3
d10 1
a10 3
DISTFILES=	exim-1.82.tar.gz exim-texinfo-1.80.tar.gz

MAINTAINER=	joey@@OpenBSD.ORG
d15 1
a15 1
	@@${CP} ${FILESDIR}/eximon.conf ${WRKSRC}/Local
d17 1
a17 1
	for i in ../../exim-texinfo-1.71/doc/* ; do \
d20 18
@


1.2
log
@added $OpenBSD$, changed ejovi to joey...removed freebsd contact from ssh
@
text
@d6 1
a6 1
# $OpenBSD$
d9 1
a9 1
DISTNAME=	exim-1.71
d12 1
a12 1
DISTFILES=	exim-1.71.tar.gz exim-texinfo-1.71.tar.gz
@


1.1
log
@Initial revision
@
text
@d5 3
d14 1
a14 1
MAINTAINER=	ejovi@@OpenBSD.ORG
@


1.1.1.1
log
@initial ports subsystem from joey
@
text
@@
