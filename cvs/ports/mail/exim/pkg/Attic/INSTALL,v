head	1.4;
access;
symbols
	OPENBSD_3_6:1.3.0.2
	OPENBSD_3_6_BASE:1.3
	OPENBSD_3_5:1.2.0.4
	OPENBSD_3_5_BASE:1.2
	OPENBSD_3_4:1.2.0.2
	OPENBSD_3_4_BASE:1.2
	OPENBSD_3_3:1.1.0.14
	OPENBSD_3_3_BASE:1.1
	OPENBSD_3_2:1.1.0.12
	OPENBSD_3_2_BASE:1.1
	OPENBSD_3_1:1.1.0.10
	OPENBSD_3_1_BASE:1.1
	OPENBSD_3_0:1.1.0.8
	OPENBSD_3_0_BASE:1.1
	OPENBSD_2_9_TRACKING_SWITCH:1.1
	OPENBSD_2_9:1.1.0.6
	OPENBSD_2_9_BASE:1.1
	OPENBSD_2_8:1.1.0.4
	OPENBSD_2_8_BASE:1.1
	OPENBSD_2_7:1.1.0.2;
locks; strict;
comment	@# @;


1.4
date	2004.11.18.23.26.41;	author alek;	state dead;
branches;
next	1.3;

1.3
date	2004.07.26.10.56.01;	author peter;	state Exp;
branches;
next	1.2;

1.2
date	2003.06.23.19.11.12;	author sturm;	state Exp;
branches;
next	1.1;

1.1
date	2000.08.12.23.57.46;	author naddy;	state Exp;
branches;
next	;


desc
@@


1.4
log
@- Remove INSTALL script
- Use @@sample to install configuration files
- @@new(user|group) to create _exim user/group
- Add MESSAGE with tips&tricks from INSTALL
- Bump PKGNAME

MAINTAINERs timeout

ok strum@@
@
text
@#!/bin/sh
# $OpenBSD: INSTALL,v 1.3 2004/07/26 10:56:01 peter Exp $
#
# Pre/post-installation setup of exim

# use a sane path and install prefix
#
PATH=/bin:/usr/bin:/sbin:/usr/sbin
PREFIX=${PKG_PREFIX:-/usr/local}
CONFIG_DIR=${SYSCONFDIR}/exim
SAMPLE_CONFIG_DIR=$PREFIX/share/examples/exim

EXIMSPOOL=/var/spool/exim
EXIM=_exim
ID=521

# add user/group _exim if they don't already exist
do_accts()
{
	echo
	echo "+---------------------"

	groupinfo -e $EXIM
	if [ $? -eq 0 ]; then
		echo "| Using existing group '$EXIM'"
	else
		echo "| Creating group '$EXIM'"
		groupadd -g $ID $EXIM
	fi

	userinfo -e $EXIM
	if [ $? -eq 0 ]; then
		echo "| Using existing account '$EXIM'"
	else
		echo "| Creating user '$EXIM'"
		if [ -d $EXIMSPOOL ]; then
			EXIMCREATEHOME=""
		else
			EXIMCREATEHOME="-m"
		fi
		useradd -g $EXIM \
			-c "$1 Account" \
			$EXIMCREATEHOME -d $EXIMSPOOL \
			-L daemon \
			-u $ID $EXIM
	fi

	echo "+---------------------"
	echo
}

# Function: tell the user what they need to do to use the port just installed
#
do_notice()
{
	echo
	echo "+---------------"
	echo "| If you intend replacing sendmail with exim, then don't"
	echo "| forget to modify /etc/mailer.conf accordingly; see"
	echo "| mailwrapper(8)."
}

# Function: install configuration files
#
do_install_conf()
{
	install -d -o root -g wheel ${CONFIG_DIR}
	install -o root -g wheel ${SAMPLE_CONFIG_DIR}/configure \
		${CONFIG_DIR}/configure
	echo "| "
	echo "| A default $1 configuration file has been installed"
	echo "| in ${CONFIG_DIR}."
	echo "|"
	echo "| Please review this file and change the configuration"
	echo "| to meet your needs."
	echo "+---------------"
	echo
}

# Function: tell the user what they need to do to use the port just installed
#
do_notice_conf()
{
	echo "| "
	echo "| The existing $1 configuration files in ${CONFIG_DIR} have NOT"
	echo "| been changed.  You may want to compare them to the current samples"
	echo "| in ${SAMPLE_CONFIG_DIR}, and update your configuration files"
	echo "| as needed."
	echo "|"
	echo "| A perl script may help converting from exim-3.xx config"
	echo "| files and has been installed in"
	echo "|       ${PREFIX}/share/examples/exim/convert4r4"
	echo "+---------------"
	echo
}

# Verify proper execution
#
if [ $# -ne 2 ]; then
	echo "usage: $0 distname { PRE-INSTALL | POST-INSTALL }" >&2
	exit 1
fi

# Verify/process the command
#
case $2 in
	PRE-INSTALL)
		do_accts $1
		;;
	POST-INSTALL)
		do_notice "$1"
		if [ ! -d ${CONFIG_DIR} ]; then
		    do_install_conf "$1"
		elif [ ! -f ${CONFIG_DIR}/configure ]; then
		    do_install_conf "$1"
		else
		    do_notice_conf "$1"
		fi
		;;
	*)
		echo "usage: $0 distname { PRE-INSTALL | POST-INSTALL }" >&2
		exit 1
		;;
esac

exit 0
@


1.3
log
@Update to exim 4.41.

This is a major update and configuration files are not compatible.
A conversion script is included and installed in

        ${PREFIX}/share/examples/exim4/convert4r4

New co-maintainer and much of the inital work done by Ilya Voronin.

A decision was made to include the semi-official exiscan patch in
the default installation, as most admins appear to use this. It is
hoped that is will become part of the core exim4 code "soon".

This port now creates an _exim user and group if they don't already
exist.

Work and testing by Ilya Voronin, Richard Welty, Axel Rau and others
who I can't now find in my mailbox. Apologies if I left you out.
@
text
@d2 1
a2 1
# $OpenBSD: INSTALL,v 1.2 2003/06/23 19:11:12 sturm Exp $
@


1.2
log
@new user naming schema

bump PKGNAME where necessary

rohee@@ ok leafnode
"you don't have to wait for oks" pval@@
@
text
@d2 1
a2 1
# $OpenBSD: INSTALL,v 1.1 2000/08/12 23:57:46 naddy Exp $
d6 1
a6 1
# exit on errors, use a sane path and install prefix
a7 1
set -e
d13 39
d56 5
a60 20
    echo
    echo "+---------------"
    echo "| It is strongly advised that you configure exim to use"
    echo "| a UID and GID other that 0/0. You can do this by adding"
    echo "| lines to the configure file like this:"
    echo "| "
    echo "|       exim_user = \"_exim\""
    echo "|       exim_group = \"_exim\""
    echo "|       with uid/gid = \"521\""
    echo "| "
    echo "| but you must remember to allow that user write"
    echo "| permissions to /var/spool/exim."
    echo "| "
    echo "| If you want to do local deliveries as another user"
    echo "| (e.g. if you allow users to put procmail into their"
    echo "| .forward file) make the exim binary setuid root."
    echo "| "
    echo "| If you intend replacing sendmail with exim, then don't"
    echo "| forget to modify /etc/mailer.conf accordingly; see"
    echo "| mailwrapper(8)."
d67 11
a77 9
    install -d -o root -g wheel ${CONFIG_DIR}
    install -o root -g wheel ${SAMPLE_CONFIG_DIR}/configure \
      ${CONFIG_DIR}/configure
    echo "| "
    echo "| The $1 configuration files have been installed in ${CONFIG_DIR}."
    echo "| Please view these files and change the configuration to meet"
    echo "| your needs."
    echo "+---------------"
    echo
d84 11
a94 7
    echo "| "
    echo "| The existing $1 configuration files in ${CONFIG_DIR} have NOT"
    echo "| been changed.  You may want to compare them to the current samples"
    echo "| in ${SAMPLE_CONFIG_DIR}, and update your configuration files"
    echo "| as needed."
    echo "+---------------"
    echo
d100 2
a101 2
    echo "usage: $0 distname { PRE-INSTALL | POST-INSTALL }" >&2
    exit 1
d107 17
a123 17
    PRE-INSTALL)
	: nothing to pre-install for this port
	;;
    POST-INSTALL)
	do_notice "$1"
	if [ ! -d ${CONFIG_DIR} ]; then
	    do_install_conf "$1"
	elif [ ! -f ${CONFIG_DIR}/configure ]; then
	    do_install_conf "$1"
	else
	    do_notice_conf "$1"
	fi
	;;
    *)
	echo "usage: $0 distname { PRE-INSTALL | POST-INSTALL }" >&2
	exit 1
	;;
@


1.1
log
@- update to 3.16; submitted by seb@@gosh.todesplanet.de
- move config file handling to (DE)INSTALL; requested by brad@@
- switch maintainer; offered by Peter
@
text
@d2 1
a2 1
# $OpenBSD$
d24 3
a26 2
    echo "|       exim_user = \"exim\""
    echo "|       exim_group = \"mail\""
@

