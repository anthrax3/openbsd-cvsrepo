head	1.3;
access;
symbols
	OPENBSD_2_9:1.2.0.6
	OPENBSD_2_9_BASE:1.2
	OPENBSD_2_8:1.2.0.4
	OPENBSD_2_8_BASE:1.2
	OPENBSD_2_7:1.2.0.2;
locks; strict;
comment	@# @;


1.3
date	2001.07.25.08.18.48;	author peter;	state dead;
branches;
next	1.2;

1.2
date	2000.08.12.23.57.45;	author naddy;	state Exp;
branches;
next	1.1;

1.1
date	2000.08.02.15.44.12;	author naddy;	state Exp;
branches;
next	;


desc
@@


1.3
log
@update to exim 3.30

This does not yet include the IPv6 / IPv4 OpenBSD patch discussed on
various lists.
@
text
@$OpenBSD: patch-src_transports_appendfile_c,v 1.2 2000/08/12 23:57:45 naddy Exp $
--- src/transports/appendfile.c.orig	Thu Jul 20 13:08:51 2000
+++ src/transports/appendfile.c	Wed Aug  9 02:11:10 2000
@@@@ -2343,9 +2343,16 @@@@ opened, so that it goes away on closure.
 #ifdef SUPPORT_MBX
 if (yield == OK && ob->mbx_format)
   {
+#if OpenBSD
+  char tempbuf[] = "/tmp/exim.XXXXXXXXXX";
+
+  tempname = tempbuf;
+  if ((temp_fd = mkstemp(tempname)) == -1 || unlink(tempname) < 0)
+#else
   tempname = tmpnam(NULL);
   if ((temp_fd = open(tempname, (O_RDWR|O_CREAT|O_TRUNC), 0600)) < 0 ||
       unlink(tempname) < 0)
+#endif
     {
     addr->basic_errno = errno;
     addr->message = string_sprintf("while setting up temporary file %s",
@


1.2
log
@- update to 3.16; submitted by seb@@gosh.todesplanet.de
- move config file handling to (DE)INSTALL; requested by brad@@
- switch maintainer; offered by Peter
@
text
@d1 1
a1 1
$OpenBSD: patch-src_transports_appendfile_c,v 1.1 2000/08/02 15:44:12 naddy Exp $
@


1.1
log
@- add no_x11 flavor
- make build respect CC and CFLAGS
- add HOMEPAGE
- move example configuration to ${PREFIX}/share/examples/
- add RCS IDs
ok peter@@
@
text
@d1 4
a4 4
$OpenBSD$
--- src/transports/appendfile.c.orig	Wed Apr 12 11:44:59 2000
+++ src/transports/appendfile.c	Mon Jun  5 00:14:52 2000
@@@@ -2330,9 +2330,16 @@@@ opened, so that it goes away on closure.
@

