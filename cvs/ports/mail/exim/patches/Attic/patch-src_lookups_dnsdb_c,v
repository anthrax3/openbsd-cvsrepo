head	1.1;
access;
symbols
	OPENBSD_3_5:1.1.0.4
	OPENBSD_3_6:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2005.01.27.06.34.10;	author sturm;	state dead;
branches
	1.1.2.1
	1.1.4.1;
next	;

1.1.2.1
date	2005.01.27.06.34.10;	author sturm;	state Exp;
branches;
next	;

1.1.4.1
date	2005.01.27.06.35.40;	author sturm;	state Exp;
branches;
next	;


desc
@@


1.1
log
@file patch-src_lookups_dnsdb_c was initially added on branch OPENBSD_3_6.
@
text
@@


1.1.4.1
log
@http://www.vuxml.org/openbsd/29a17ee2-6fd9-11d9-a77b-080020f8e4df.html
(CAN-2005-0022 does not apply)

patches borrowed from FreeBSD, ok brad@@
@
text
@a0 12
$OpenBSD$
--- src/lookups/dnsdb.c.orig	2005-01-26 21:55:58.000000000 +0100
+++ src/lookups/dnsdb.c	2005-01-26 21:55:35.000000000 +0100
@@@@ -116,7 +116,7 @@@@ if (equals != NULL)
 /* If the type is PTR, we have to construct the relevant magic lookup
 key. */
 
-if (type == T_PTR)
+if (type == T_PTR && string_is_ip_address(keystring, NULL))
   {
   char *p = keystring + (int)strlen(keystring);
   char *pp = buffer;
@


1.1.2.1
log
@http://www.vuxml.org/openbsd/29a17ee2-6fd9-11d9-a77b-080020f8e4df.html

patches borrowed from FreeBSD, ok brad@@
@
text
@a0 12
$OpenBSD$
--- src/lookups/dnsdb.c.orig	Thu Jul 22 10:46:52 2004
+++ src/lookups/dnsdb.c	Wed Jan 26 21:40:52 2005
@@@@ -125,7 +125,7 @@@@ if (equals != NULL)
 /* If the type is PTR, we have to construct the relevant magic lookup
 key. This code is now in a separate function. */
 
-if (type == T_PTR)
+if (type == T_PTR && string_is_ip_address(keystring, NULL))
   {
   dns_build_reverse(keystring, buffer);
   keystring = buffer;
@

