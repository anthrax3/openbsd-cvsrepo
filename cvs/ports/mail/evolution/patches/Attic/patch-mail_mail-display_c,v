head	1.1;
access;
symbols
	OPENBSD_3_2:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2003.04.15.03.18.32;	author marcm;	state dead;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2003.04.15.03.18.32;	author marcm;	state Exp;
branches;
next	;


desc
@@


1.1
log
@file patch-mail_mail-display_c was initially added on branch OPENBSD_3_2.
@
text
@@


1.1.2.1
log
@Security update: addresses CORE security advisory CORE-20030304-01

ok brad@@
@
text
@a0 17
$OpenBSD$
--- mail/mail-display.c.orig	Fri Feb 15 16:34:32 2002
+++ mail/mail-display.c	Mon Apr  7 20:44:44 2003
@@@@ -864,7 +864,12 @@@@ do_external_viewer (GtkHTML *html, GtkHT
 	GByteArray *ba;
 	CamelStream *cstream;
 	BonoboStream *bstream;
-
+	MailMimeHandler *handler;
+	
+	handler = mail_lookup_handler (eb->type);
+	if (!handler || !handler->is_bonobo)
+		return FALSE;
+	
 	component = gnome_vfs_mime_get_default_component (eb->type);
 	if (!component)
 		return FALSE;
@

