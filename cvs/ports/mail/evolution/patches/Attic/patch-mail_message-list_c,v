head	1.12;
access;
symbols
	OPENBSD_4_7:1.8.0.2
	OPENBSD_4_7_BASE:1.8
	OPENBSD_4_6:1.7.0.4
	OPENBSD_4_6_BASE:1.7
	OPENBSD_4_5:1.7.0.2
	OPENBSD_4_5_BASE:1.7
	OPENBSD_4_4:1.4.0.2
	OPENBSD_4_4_BASE:1.4
	OPENBSD_4_3:1.3.0.2
	OPENBSD_4_3_BASE:1.3
	OPENBSD_4_2:1.2.0.2
	OPENBSD_4_2_BASE:1.2
	OPENBSD_4_1:1.1.0.6
	OPENBSD_4_1_BASE:1.1
	OPENBSD_4_0:1.1.0.4
	OPENBSD_4_0_BASE:1.1
	OPENBSD_3_9:1.1.0.2
	OPENBSD_3_9_BASE:1.1;
locks; strict;
comment	@# @;


1.12
date	2010.06.21.05.17.04;	author ajacoutot;	state dead;
branches;
next	1.11;

1.11
date	2010.06.15.10.51.38;	author ajacoutot;	state Exp;
branches;
next	1.10;

1.10
date	2010.04.26.19.52.25;	author ajacoutot;	state Exp;
branches;
next	1.9;

1.9
date	2010.04.22.16.30.02;	author jasper;	state Exp;
branches;
next	1.8;

1.8
date	2009.10.13.22.07.04;	author jasper;	state Exp;
branches;
next	1.7;

1.7
date	2009.01.31.08.32.35;	author jasper;	state Exp;
branches;
next	1.6;

1.6
date	2009.01.12.16.13.42;	author jasper;	state Exp;
branches;
next	1.5;

1.5
date	2008.11.21.17.28.07;	author jasper;	state Exp;
branches;
next	1.4;

1.4
date	2008.07.08.11.16.44;	author jasper;	state Exp;
branches;
next	1.3;

1.3
date	2007.11.21.16.18.15;	author jasper;	state Exp;
branches;
next	1.2;

1.2
date	2007.06.02.11.32.11;	author jasper;	state Exp;
branches;
next	1.1;

1.1
date	2005.09.08.04.52.12;	author marcm;	state Exp;
branches;
next	;


desc
@@


1.12
log
@Bugfixe update to evolution-2.30.2.
@
text
@$OpenBSD: patch-mail_message-list_c,v 1.11 2010/06/15 10:51:38 ajacoutot Exp $

From pstream GIT 4a2343cb34498c701e71679e3c50c9fc81dd5b80
Bug 618902 - Crash when viewing/closing messages quickly
Closing an EMailBrowser window causes it to be disposed immediately, but
ongoing async operations still hold an EMailBrowser reference -- in
particular, regenerating the internal message list and fetching a mail
message. The callback functions for these operations were not equipped
to deal with the disposed-but-not-yet-finalized object.

--- mail/message-list.c.orig	Tue Jun 15 09:15:42 2010
+++ mail/message-list.c	Tue Jun 15 09:19:16 2010
@@@@ -4909,7 +4909,7 @@@@ mail_regen_list (MessageList *ml, const gchar *search,
 #endif
 
 	m = mail_msg_new (&regen_list_info);
-	m->ml = ml;
+	m->ml = g_object_ref (ml);
 	m->search = g_strdup (search);
 	m->hideexpr = g_strdup (hideexpr);
 	m->changes = changes;
@@@@ -4917,7 +4917,6 @@@@ mail_regen_list (MessageList *ml, const gchar *search,
 	m->hidedel = ml->hidedeleted;
 	m->hidejunk = ml->hidejunk;
 	m->thread_subject = gconf_client_get_bool (gconf, "/apps/evolution/mail/display/thread_subject", NULL);
-	g_object_ref(ml);
 	m->folder = ml->folder;
 	camel_object_ref(m->folder);
 	m->last_row = -1;
@


1.11
log
@Remove evo_mail_notifier.png, it's unused and removed upstream.

Add 2 patches from upstream/GNOME bugzilla to prevent crashes:
    GNOME bug 618902 - Crash when viewing/closing messages quickly
    GNOME bug 612082 - Crash in em_format_snoop_type
@
text
@d1 1
a1 1
$OpenBSD: patch-mail_message-list_c,v 1.10 2010/04/26 19:52:25 ajacoutot Exp $
@


1.10
log
@Update the (in)famous evolution to version 2.30.1.1.
@
text
@d1 14
a14 25
$OpenBSD: patch-mail_message-list_c,v 1.9 2010/04/22 16:30:02 jasper Exp $
--- mail/message-list.c.orig	Thu Apr  8 16:17:42 2010
+++ mail/message-list.c	Mon Apr 26 09:09:25 2010
@@@@ -2835,6 +2835,11 @@@@ clear_tree (MessageList *ml, gboolean tfree)
 	ml->tree_root = e_tree_memory_node_insert (E_TREE_MEMORY(etm), NULL, 0, NULL);
 	if (tfree)
 		e_tree_model_rebuilt (E_TREE_MODEL(etm));
+
+#ifdef BROKEN_ETREE
+	GPtrArray *selected;
+#endif
+
 #ifdef TIMEIT
 	gettimeofday(&end, NULL);
 	diff = end.tv_sec * 1000 + end.tv_usec/1000;
@@@@ -3453,6 +3458,10 @@@@ mail_folder_hide_by_flag (CamelFolder *folder, Message
 	CamelFolderChangeInfo *newchanges, *oldchanges = *changes;
 	CamelMessageInfo *info;
 	gint i;
+
+#ifdef BROKEN_ETREE
+	GPtrArray *selected;
+#endif
 
 	newchanges = camel_folder_change_info_new ();
d16 14
@


1.9
log
@- major update evolution to 2.30.0.1
@
text
@d1 4
a4 4
$OpenBSD: patch-mail_message-list_c,v 1.8 2009/10/13 22:07:04 jasper Exp $
--- mail/message-list.c.orig	Wed Mar 17 12:14:53 2010
+++ mail/message-list.c	Thu Apr 22 12:53:49 2010
@@@@ -2844,6 +2844,11 @@@@ clear_tree (MessageList *ml, gboolean tfree)
d16 1
a16 1
@@@@ -3445,6 +3450,10 @@@@ mail_folder_hide_by_flag (CamelFolder *folder, Message
@


1.8
log
@- update evolution to 2.28.0
* among the many, many changes are the pst-importer plugin

if there is any fallout, it'll be fixed soon
@
text
@d1 4
a4 4
$OpenBSD: patch-mail_message-list_c,v 1.7 2009/01/31 08:32:35 jasper Exp $
--- mail/message-list.c.orig	Tue Oct 13 15:19:10 2009
+++ mail/message-list.c	Tue Oct 13 15:21:26 2009
@@@@ -2613,6 +2613,11 @@@@ clear_tree (MessageList *ml, gboolean tfree)
d16 1
a16 1
@@@@ -3214,6 +3219,10 @@@@ mail_folder_hide_by_flag (CamelFolder *folder, Message
@


1.7
log
@- bugfix update evolution to 2.24.4
- explicitly depend on latest e-d-s (for CAMEL_STORE_IS_MIGRATING)
- resolve an XXX

ok ajacoutot@@
@
text
@d1 4
a4 5
$OpenBSD: patch-mail_message-list_c,v 1.6 2009/01/12 16:13:42 jasper Exp $
--- mail/message-list.c.orig	Fri Jan 30 05:55:03 2009
+++ mail/message-list.c	Fri Jan 30 22:31:23 2009
@@@@ -2549,6 +2549,10 @@@@ clear_tree (MessageList *ml)
 
d6 3
a8 1
 
d16 1
a16 1
@@@@ -3152,6 +3156,9 @@@@ mail_folder_hide_by_flag (CamelFolder *folder, Message
d19 2
a20 1
 	int i;
@


1.6
log
@- update evolution to 2.24.3
@
text
@d1 4
a4 4
$OpenBSD: patch-mail_message-list_c,v 1.5 2008/11/21 17:28:07 jasper Exp $
--- mail/message-list.c.orig	Mon Dec 15 07:50:24 2008
+++ mail/message-list.c	Mon Jan 12 14:44:40 2009
@@@@ -2548,6 +2548,10 @@@@ clear_tree (MessageList *ml)
d15 1
a15 1
@@@@ -3151,6 +3155,9 @@@@ mail_folder_hide_by_flag (CamelFolder *folder, Message
@


1.5
log
@- update evolution to 2.24.1.1 (somewhat unbreaks it)
- fix license version
- explicitly disable mono

feedback and ok ajacoutot@@
@
text
@d1 4
a4 4
$OpenBSD: patch-mail_message-list_c,v 1.4 2008/07/08 11:16:44 jasper Exp $
--- mail/message-list.c.orig	Mon Oct 20 05:28:32 2008
+++ mail/message-list.c	Thu Nov 13 20:19:22 2008
@@@@ -2543,6 +2543,10 @@@@ clear_tree (MessageList *ml)
d15 1
a15 1
@@@@ -3146,6 +3150,9 @@@@ mail_folder_hide_by_flag (CamelFolder *folder, Message
@


1.4
log
@- update evolution to 2.22.3, which includes fixes for CVE-2008-1108
and CVE-2008-1109
@
text
@d1 4
a4 4
$OpenBSD: patch-mail_message-list_c,v 1.3 2007/11/21 16:18:15 jasper Exp $
--- mail/message-list.c.orig	Wed Jan 16 05:47:37 2008
+++ mail/message-list.c	Fri Jul  4 23:27:25 2008
@@@@ -2492,6 +2492,10 @@@@ clear_tree (MessageList *ml)
d15 1
a15 1
@@@@ -3095,6 +3099,9 @@@@ mail_folder_hide_by_flag (CamelFolder *folder, Message
@


1.3
log
@- update evolution to 2.12.1
- explicitly disable some stuff
- enable base plugins

"no objections here" martynas@@

note, there is are some issues left, but this will be fixed shortly.
@
text
@d1 4
a4 4
$OpenBSD: patch-mail_message-list_c,v 1.2 2007/06/02 11:32:11 jasper Exp $
--- mail/message-list.c.orig	Sun Sep 16 21:17:46 2007
+++ mail/message-list.c	Wed Oct 31 16:47:44 2007
@@@@ -2390,6 +2390,10 @@@@ clear_tree (MessageList *ml)
d15 1
a15 1
@@@@ -2994,6 +2998,9 @@@@ mail_folder_hide_by_flag (CamelFolder *folder, Message
d24 1
a24 1
 			
@


1.2
log
@- update evolution to 2.10.1
- use ssl by default

still some little issues left, but basic operation works.

with a lot of help from kurt@@
@
text
@d1 4
a4 4
$OpenBSD: patch-mail_message-list_c,v 1.1 2005/09/08 04:52:12 marcm Exp $
--- mail/message-list.c.orig	Mon Apr  9 15:09:27 2007
+++ mail/message-list.c	Wed Apr 25 23:37:53 2007
@@@@ -2348,6 +2348,10 @@@@ clear_tree (MessageList *ml)
d15 1
a15 1
@@@@ -2949,6 +2953,9 @@@@ mail_folder_hide_by_flag (CamelFolder *folder, Message
@


1.1
log
@Update to 2.2.3, the latest in the 2.2 tree.

BROKEN!! Committed here so that others may have something to work with.
Also, replaces Evo 1 which was unsupported and well out-of-date.
@
text
@d1 4
a4 4
$OpenBSD$
--- mail/message-list.c.orig	Mon Mar 14 18:02:04 2005
+++ mail/message-list.c	Wed Apr  6 20:41:11 2005
@@@@ -2125,6 +2125,10 @@@@ clear_tree (MessageList *ml)
d15 1
a15 1
@@@@ -2671,6 +2675,9 @@@@ mail_folder_hide_by_flag (CamelFolder *f
@

