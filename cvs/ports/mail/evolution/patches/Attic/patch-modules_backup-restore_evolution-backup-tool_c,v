head	1.2;
access;
symbols;
locks; strict;
comment	@# @;


1.2
date	2015.04.13.07.56.06;	author ajacoutot;	state dead;
branches;
next	1.1;
commitid	Z0jEDLNedcANfxuj;

1.1
date	2015.04.08.10.33.18;	author ajacoutot;	state Exp;
branches;
next	;
commitid	N05ULE92CIWxx6cb;


desc
@@


1.2
log
@Update to evolution-3.16.1.
@
text
@$OpenBSD: patch-modules_backup-restore_evolution-backup-tool_c,v 1.1 2015/04/08 10:33:18 ajacoutot Exp $

From d9e63d55cd8ce597d9668dd4dd6f78c0900c9a94 Mon Sep 17 00:00:00 2001
From: Ting-Wei Lan <lantw@@src.gnome.org>
Date: Wed, 8 Apr 2015 12:21:47 +0200
Subject: Bug 747461 - The tar command used to restore backups doesn't work on FreeBSD

--- modules/backup-restore/evolution-backup-tool.c.orig	Thu Mar  5 22:02:35 2015
+++ modules/backup-restore/evolution-backup-tool.c	Wed Apr  8 12:32:19 2015
@@@@ -538,14 +538,14 @@@@ restore (const gchar *filename,
 		g_mkdir_with_parents (e_get_user_config_dir (), 0700);
 
 		command = g_strdup_printf (
-			"cd $DATADIR && tar xzf %s %s --strip-components=%d",
-			quotedfname, data_dir, get_dir_level (data_dir));
+			"cd $DATADIR && tar --strip-components %d -xzf %s %s",
+			 get_dir_level (data_dir), quotedfname, data_dir);
 		run_cmd (command);
 		g_free (command);
 
 		command = g_strdup_printf (
-			"cd $CONFIGDIR && tar xzf %s %s --strip-components=%d",
-			quotedfname, config_dir, get_dir_level (config_dir));
+			"cd $CONFIGDIR && tar --strip-components %d -xzf %s %s",
+			get_dir_level (config_dir), quotedfname, config_dir);
 		run_cmd (command);
 		g_free (command);
 
@


1.1
log
@Fix tar(1) invocation (upstream).
@
text
@d1 1
a1 1
$OpenBSD$
@

