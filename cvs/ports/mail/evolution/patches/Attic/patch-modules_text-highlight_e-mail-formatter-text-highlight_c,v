head	1.6;
access;
symbols;
locks; strict;
comment	@# @;


1.6
date	2014.04.13.16.14.19;	author ajacoutot;	state dead;
branches;
next	1.5;

1.5
date	2014.04.08.15.23.15;	author ajacoutot;	state Exp;
branches;
next	1.4;

1.4
date	2012.10.14.09.20.59;	author ajacoutot;	state dead;
branches;
next	1.3;

1.3
date	2012.10.04.13.58.17;	author ajacoutot;	state Exp;
branches;
next	1.2;

1.2
date	2012.10.04.07.03.40;	author ajacoutot;	state Exp;
branches;
next	1.1;

1.1
date	2012.09.28.14.27.10;	author ajacoutot;	state Exp;
branches;
next	;


desc
@@


1.6
log
@Update to evolution-3.12.1.
@
text
@$OpenBSD: patch-modules_text-highlight_e-mail-formatter-text-highlight_c,v 1.5 2014/04/08 15:23:15 ajacoutot Exp $

From 7c54be0edafd10f1e1d6d26c83a8cd4b011b2398 Mon Sep 17 00:00:00 2001
From: Milan Crha <mcrha@@redhat.com>
Date: Wed, 26 Mar 2014 10:38:34 +0100
Subject: [text-highlight] Fix a possible memory leak

--- modules/text-highlight/e-mail-formatter-text-highlight.c.orig	Fri Feb 28 20:38:11 2014
+++ modules/text-highlight/e-mail-formatter-text-highlight.c	Tue Apr  8 16:36:32 2014
@@@@ -105,6 +105,7 @@@@ get_syntax (EMailPart *part,
 		if (filename != NULL) {
 			gchar *ext = g_strrstr (filename, ".");
 			if (ext != NULL) {
+				g_free (syntax);
 				syntax = (gchar *) get_syntax_for_ext (ext + 1);
 				syntax = syntax ? g_strdup (syntax) : NULL;
 			}
@


1.5
log
@Start unbreaking the evolution stack by merging relevant commits from
upstream.
@
text
@d1 1
a1 1
$OpenBSD$
@


1.4
log
@Bugfix update to evolution-3.6.1.
@
text
@d1 1
a1 1
$OpenBSD: patch-modules_text-highlight_e-mail-formatter-text-highlight_c,v 1.3 2012/10/04 13:58:17 ajacoutot Exp $
d3 4
a6 4
From 1cfe0327ca436a687383412664e3a5c2869c7dda Mon Sep 17 00:00:00 2001
From: Antoine Jacoutot <ajacoutot@@gnome.org>
Date: Thu, 04 Oct 2012 13:34:23 +0000
Subject: portability: don't use too generic variable names
d8 10
a17 27
--- modules/text-highlight/e-mail-formatter-text-highlight.c.orig	Sun Sep 16 17:05:50 2012
+++ modules/text-highlight/e-mail-formatter-text-highlight.c	Thu Oct  4 15:36:19 2012
@@@@ -187,7 +187,7 @@@@ emfe_text_highlight_format (EMailFormatterExtension *e
 		return TRUE;
 
 	} else if (context->mode == E_MAIL_FORMATTER_MODE_RAW) {
-		gint stdin, stdout;
+		gint pipe_stdin, pipe_stdout;
 		GPid pid;
 		CamelStream *read, *write, *utf8;
 		CamelDataWrapper *dw;
@@@@ -262,12 +262,12 @@@@ emfe_text_highlight_format (EMailFormatterExtension *e
 			NULL, (gchar **) argv, NULL,
 			G_SPAWN_SEARCH_PATH |
 			G_SPAWN_DO_NOT_REAP_CHILD,
-			NULL, NULL, &pid, &stdin, &stdout, NULL, NULL)) {
+			NULL, NULL, &pid, &pipe_stdin, &pipe_stdout, NULL, NULL)) {
 			return FALSE;
 		}
 
-		write = camel_stream_fs_new_with_fd (stdin);
-		read = camel_stream_fs_new_with_fd (stdout);
+		write = camel_stream_fs_new_with_fd (pipe_stdin);
+		read = camel_stream_fs_new_with_fd (pipe_stdout);
 
 		/* Decode the content of mime part to the 'utf8' stream */
 		utf8 = camel_stream_mem_new ();
@


1.3
log
@Merge a slightly modified version of this patch that I committed upstream.
@
text
@d1 1
a1 1
$OpenBSD: patch-modules_text-highlight_e-mail-formatter-text-highlight_c,v 1.2 2012/10/04 07:03:40 ajacoutot Exp $
@


1.2
log
@BZ URL.
@
text
@d1 1
a1 1
$OpenBSD: patch-modules_text-highlight_e-mail-formatter-text-highlight_c,v 1.1 2012/09/28 14:27:10 ajacoutot Exp $
d3 4
a6 1
https://bugzilla.gnome.org/show_bug.cgi?id=685471
d8 2
a9 2
--- modules/text-highlight/e-mail-formatter-text-highlight.c.orig	Fri Sep 28 16:25:37 2012
+++ modules/text-highlight/e-mail-formatter-text-highlight.c	Fri Sep 28 16:26:11 2012
d15 1
a15 1
+		gint ev_stdin, ev_stdout;
d24 1
a24 1
+			NULL, NULL, &pid, &ev_stdin, &ev_stdout, NULL, NULL)) {
d30 2
a31 2
+		write = camel_stream_fs_new_with_fd (ev_stdin);
+		read = camel_stream_fs_new_with_fd (ev_stdout);
@


1.1
log
@Forgot in previous.
@
text
@d1 1
a1 1
$OpenBSD$
d3 1
a3 2
XXX push uptream
e-mail-formatter-text-highlight.c:190: error: expected identifier or '(' before '&' token
@

