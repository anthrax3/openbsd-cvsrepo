head	1.2;
access;
symbols
	OPENBSD_2_6:1.1.0.4
	OPENBSD_2_6_BASE:1.1
	OPENBSD_2_5:1.1.0.2
	OPENBSD_2_5_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2000.03.08.05.11.47;	author kevlo;	state dead;
branches;
next	1.1;

1.1
date	99.03.26.08.48.33;	author marc;	state Exp;
branches;
next	;


desc
@@


1.2
log
@- Upgrade to 1.0.3 and fix the security problem.
- Mark unbroken.
- Update the MASTER_SITES.
@
text
@--- ./mts/smtp/smtp.c.orig	Sat Mar 20 16:02:43 1999
+++ ./mts/smtp/smtp.c	Sat Mar 20 16:11:46 1999
@@@@ -244,12 +244,16 @@@@
 	for (ap = arguments; *ap; ap++)
 	    if (**ap == '/') {
 		char *dp;
+		int fd;
 
 		if ((dp = strrchr(*ap, '/')) && *++dp == NULL)
 		    *--dp = NULL;
 		snprintf (sm_tmpfil, sizeof(sm_tmpfil), "%s/smtpXXXXXX", *ap);
-		mktemp (sm_tmpfil);
-
+		fd = mkstemp (sm_tmpfil);
+		if (fd == -1)
+		    return NOTOK;
+		close (fd);
+		unlink (sm_tmpfil);
 		if ((sd = creat (sm_tmpfil, 0600)) != NOTOK) {
 		    sm_ispool = 1;
 		    break;
@


1.1
log
@update to 1.0; Keith A Watson <kaw@@best.com>
@
text
@@

