head	1.7;
access;
symbols
	OPENBSD_4_8:1.6.0.6
	OPENBSD_4_8_BASE:1.6
	OPENBSD_4_7:1.6.0.4
	OPENBSD_4_7_BASE:1.6
	OPENBSD_4_6:1.6.0.2
	OPENBSD_4_6_BASE:1.6
	OPENBSD_4_5:1.5.0.6
	OPENBSD_4_5_BASE:1.5
	OPENBSD_4_4:1.5.0.4
	OPENBSD_4_4_BASE:1.5
	OPENBSD_4_3:1.5.0.2
	OPENBSD_4_3_BASE:1.5
	OPENBSD_4_2:1.4.0.2
	OPENBSD_4_2_BASE:1.4
	OPENBSD_4_1:1.3.0.6
	OPENBSD_4_1_BASE:1.3
	OPENBSD_4_0:1.3.0.4
	OPENBSD_4_0_BASE:1.3
	OPENBSD_3_9:1.3.0.2
	OPENBSD_3_9_BASE:1.3
	OPENBSD_3_8:1.2.0.4
	OPENBSD_3_8_BASE:1.2
	OPENBSD_3_7:1.2.0.2
	OPENBSD_3_7_BASE:1.2
	OPENBSD_3_6:1.1.1.1.0.14
	OPENBSD_3_6_BASE:1.1.1.1
	OPENBSD_3_5:1.1.1.1.0.12
	OPENBSD_3_5_BASE:1.1.1.1
	OPENBSD_3_4:1.1.1.1.0.10
	OPENBSD_3_4_BASE:1.1.1.1
	OPENBSD_3_3:1.1.1.1.0.8
	OPENBSD_3_3_BASE:1.1.1.1
	OPENBSD_3_2:1.1.1.1.0.6
	OPENBSD_3_2_BASE:1.1.1.1
	OPENBSD_3_1:1.1.1.1.0.4
	OPENBSD_3_1_BASE:1.1.1.1
	OPENBSD_3_0:1.1.1.1.0.2
	OPENBSD_3_0_BASE:1.1.1.1
	lebel_2001-Aug-20:1.1.1.1
	lebel:1.1.1;
locks; strict;
comment	@# @;


1.7
date	2010.09.08.09.57.28;	author sthen;	state dead;
branches;
next	1.6;

1.6
date	2009.06.16.09.37.19;	author sthen;	state Exp;
branches;
next	1.5;

1.5
date	2007.11.11.10.09.43;	author sthen;	state Exp;
branches;
next	1.4;

1.4
date	2007.06.21.17.26.29;	author bernd;	state Exp;
branches;
next	1.3;

1.3
date	2005.09.14.21.00.03;	author bernd;	state Exp;
branches;
next	1.2;

1.2
date	2005.02.07.17.16.16;	author naddy;	state Exp;
branches;
next	1.1;

1.1
date	2001.08.20.19.51.53;	author lebel;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2001.08.20.19.51.53;	author lebel;	state Exp;
branches;
next	;


desc
@@


1.7
log
@- update the sidebar/compressed patches to work with this snapshot.
- new LIB_DEPENDS/REVISION.
- switch to a newer snapshot pulled from the repo, rolling in the
upstream patches.

requested by edd@@. thanks to jasper@@, landry@@, pea@@ for testing.
@
text
@$OpenBSD: patch-browser_c,v 1.6 2009/06/16 09:37:19 sthen Exp $
--- browser.c.orig	Thu Jun 11 18:52:54 2009
+++ browser.c	Mon Jun 15 21:06:08 2009
@@@@ -27,6 +27,7 @@@@
 #include "buffy.h"
 #include "mapping.h"
 #include "sort.h"
+#include "mx.h"
 #include "mailbox.h"
 #include "browser.h"
 #ifdef USE_IMAP
@@@@ -352,6 +353,21 @@@@ static void init_state (struct browser_state *state, M
     menu->data = state->entry;
 }
 
+static void check_maildir_times (BUFFY *buf, struct stat *st)
+{
+  char buffer[_POSIX_PATH_MAX + SHORT_STRING];
+  struct stat s;
+
+  if(!buf || buf->magic != M_MAILDIR)
+    return;
+
+  snprintf (buffer, sizeof (buffer), "%s/tmp", buf->path);
+  if (lstat (buffer, &s) != 0)
+    return;
+
+  st->st_mtime = s.st_mtime;
+}
+
 static int examine_directory (MUTTMENU *menu, struct browser_state *state,
 			      char *d, const char *prefix)
 {
@@@@ -415,6 +431,7 @@@@ static int examine_directory (MUTTMENU *menu, struct b
     tmp = Incoming;
     while (tmp && mutt_strcmp (buffer, tmp->path))
       tmp = tmp->next;
+    check_maildir_times (tmp, &s);
     add_folder (menu, state, de->d_name, &s, (tmp) ? tmp->new : 0);
   }
   closedir (dp);  
@@@@ -479,6 +496,7 @@@@ static int examine_mailboxes (MUTTMENU *menu, struct b
     strfcpy (buffer, NONULL(tmp->path), sizeof (buffer));
     mutt_pretty_mailbox (buffer, sizeof (buffer));
 
+    check_maildir_times (tmp, &s);
     add_folder (menu, state, buffer, &s, tmp->new);
   }
   while ((tmp = tmp->next));
@


1.6
log
@- bug-fix and SECURITY update to 1.5.20; fixes CVE-2009-1390 (X.509
Certificate Chain Security Bypass vulnerability).

- added a couple of post-1.5.20 patches from upstream for regressions

- cleanup the port's handling of sample config files

testing by Simon Kuhnle, Edd Barrett, testing and ok landry@@.
@
text
@d1 1
a1 1
$OpenBSD: patch-browser_c,v 1.5 2007/11/11 10:09:43 sthen Exp $
@


1.5
log
@Update Mutt to 1.5.17, fix WANTLIB for 1.5.xx (adding qdbm in 1.5.16
brought in a dependency on libz).

feedback/ok bernd@@, simon@@
@
text
@d1 3
a3 3
$OpenBSD: patch-browser_c,v 1.4 2007/06/21 17:26:29 bernd Exp $
--- browser.c.orig	Wed Sep  5 19:28:05 2007
+++ browser.c	Fri Nov  2 08:17:06 2007
d42 1
a42 1
@@@@ -464,6 +481,7 @@@@ static int examine_mailboxes (MUTTMENU *menu, struct b
d44 1
a44 1
     mutt_pretty_mailbox (buffer);
@


1.4
log
@Update to mutt-1.5.16.

Initial diff and sidebar-patch hosting by Stuart Henderson. Thanks!

Enable the Maildir/POP3/IMAP header cache by default and remove
the hcache FLAVOR.

Tested by many. Corrections from simon@@.

ok simon@@, steven@@
@
text
@d1 3
a3 3
$OpenBSD: patch-browser_c,v 1.3 2005/09/14 21:00:03 bernd Exp $
--- browser.c.orig	Tue Apr  3 06:57:21 2007
+++ browser.c	Sat Apr  7 11:40:27 2007
d12 1
a12 1
@@@@ -351,6 +352,21 @@@@ static void init_state (struct browser_state *state, M
d34 1
a34 1
@@@@ -414,6 +430,7 @@@@ static int examine_directory (MUTTMENU *menu, struct b
d42 1
a42 1
@@@@ -463,6 +480,7 @@@@ static int examine_mailboxes (MUTTMENU *menu, struct b
@


1.3
log
@- update to mutt-1.5.10
- preprocess muttrc manpage with tbl

ok sturm@@
@
text
@d1 3
a3 3
$OpenBSD: patch-browser_c,v 1.2 2005/02/07 17:16:16 naddy Exp $
--- browser.c.orig	Thu Aug 11 21:37:01 2005
+++ browser.c	Fri Aug 12 09:21:37 2005
d12 1
a12 1
@@@@ -351,6 +352,21 @@@@ static void init_state (struct browser_s
d34 1
a34 1
@@@@ -414,6 +430,7 @@@@ static int examine_directory (MUTTMENU *
d42 1
a42 1
@@@@ -459,6 +476,7 @@@@ static int examine_mailboxes (MUTTMENU *
@


1.2
log
@update snapshot to 1.5.7; from Bernd Ahlers <b.ahlers@@ba-net.org>
@
text
@d1 4
a4 4
$OpenBSD$
--- browser.c.orig	Thu Feb  3 09:23:58 2005
+++ browser.c	Thu Feb  3 09:25:52 2005
@@@@ -22,6 +22,7 @@@@
d12 1
a12 1
@@@@ -346,6 +347,21 @@@@ static void init_state (struct browser_s
d34 1
a34 1
@@@@ -409,6 +425,7 @@@@ static int examine_directory (MUTTMENU *
d42 1
a42 1
@@@@ -454,6 +471,7 @@@@ static int examine_mailboxes (MUTTMENU *
@


1.1
log
@Initial revision
@
text
@d2 2
a3 2
--- browser.c.orig	Thu May 24 05:56:48 2001
+++ browser.c	Sun Aug 19 20:30:22 2001
d12 1
a12 1
@@@@ -344,6 +345,21 @@@@ static void init_state (struct browser_s
d20 1
a20 1
+  
d27 1
a27 1
+  
d34 1
a34 1
@@@@ -407,6 +423,7 @@@@ static int examine_directory (MUTTMENU *
d38 1
a38 1
+    check_maildir_times (tmp, &s);      
d42 1
a42 1
@@@@ -452,6 +469,7 @@@@ static int examine_mailboxes (MUTTMENU *
d46 1
a46 1
+    check_maildir_times (tmp, &s);      
@


1.1.1.1
log
@initial import of mutt/snapshot 1.3.20i:
--
The Mutt Mail User Agent

This is a nifty e-mail client that includes excellent PGP hooks.
Other features include:

- color support
- message threading
- MIME support (including RFC2047 support for encoded headers)
- IMAP (also over SSL) and POP3 support
- support for multiple mailbox formats (mbox, MMDF, MH, maildir)
- highly customizable, including key bindings
- searches using regular expression
- Delivery Status Notification (DSN) support
- PGP/MIME (RFC2015)
- small and efficient

Flavors:
	slang	   - build using the S-Lang library for screen handling.
	imap	   - build with IMAP & SSL support.
	pop	   - build with POP3 support.
	compressed - build with compressed folder support 
		     (see: http://www.spinnaker.de/mutt/compressed/)
        mixmaster  - build with anonymous remailing support.

This is the development version of mutt.

WWW: http://www.mutt.org/

@
text
@@
