head	1.2;
access;
symbols
	OPENBSD_4_8:1.1.0.6
	OPENBSD_4_8_BASE:1.1
	OPENBSD_4_7:1.1.0.4
	OPENBSD_4_7_BASE:1.1
	OPENBSD_4_6:1.1.0.2
	OPENBSD_4_6_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2010.09.08.09.57.28;	author sthen;	state dead;
branches;
next	1.1;

1.1
date	2009.06.16.09.37.19;	author sthen;	state Exp;
branches;
next	;


desc
@@


1.2
log
@- update the sidebar/compressed patches to work with this snapshot.
- new LIB_DEPENDS/REVISION.
- switch to a newer snapshot pulled from the repo, rolling in the
upstream patches.

requested by edd@@. thanks to jasper@@, landry@@, pea@@ for testing.
@
text
@$OpenBSD: patch-imap_imap_c,v 1.1 2009/06/16 09:37:19 sthen Exp $

fix segfault in imap_synx_mailbox; mutt bug #3226

--- imap/imap.c.orig	Mon Jun 15 21:11:05 2009
+++ imap/imap.c	Mon Jun 15 21:11:58 2009
@@@@ -1178,7 +1178,7 @@@@ int imap_sync_mailbox (CONTEXT* ctx, int expunge, int*
     return rc;
 
   /* if we are expunging anyway, we can do deleted messages very quickly... */
-  if (expunge && mutt_bit_isset (ctx->rights, M_ACL_DELETE))
+  if (expunge && mutt_bit_isset (idata->ctx->rights, M_ACL_DELETE))
   {
     if ((rc = imap_exec_msgset (idata, "UID STORE", "+FLAGS.SILENT (\\Deleted)",
                                 M_DELETED, 1, 0)) < 0)
@@@@ -1293,7 +1293,7 @@@@ int imap_sync_mailbox (CONTEXT* ctx, int expunge, int*
   ctx->changed = 0;
 
   /* We must send an EXPUNGE command if we're not closing. */
-  if (expunge && !(ctx->closing) &&
+  if (expunge && !(idata->ctx->closing) &&
       mutt_bit_isset(ctx->rights, M_ACL_DELETE))
   {
     mutt_message _("Expunging messages from server...");
@


1.1
log
@- bug-fix and SECURITY update to 1.5.20; fixes CVE-2009-1390 (X.509
Certificate Chain Security Bypass vulnerability).

- added a couple of post-1.5.20 patches from upstream for regressions

- cleanup the port's handling of sample config files

testing by Simon Kuhnle, Edd Barrett, testing and ok landry@@.
@
text
@d1 1
a1 1
$OpenBSD$
@

