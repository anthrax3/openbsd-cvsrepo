head	1.3;
access;
symbols
	OPENBSD_6_1:1.2.0.2
	OPENBSD_6_1_BASE:1.2
	sthen_20161202:1.1.1.1
	sthen:1.1.1;
locks; strict;
comment	@# @;


1.3
date	2017.05.01.14.15.54;	author sthen;	state Exp;
branches;
next	1.2;
commitid	NlR0ykVp9bmnPK1q;

1.2
date	2016.12.02.15.17.40;	author sthen;	state Exp;
branches;
next	1.1;
commitid	8zJmRuCkqJNjFtdD;

1.1
date	2016.12.02.14.57.41;	author sthen;	state Exp;
branches
	1.1.1.1;
next	;
commitid	dd8meP197Xg3dwF8;

1.1.1.1
date	2016.12.02.14.57.41;	author sthen;	state Exp;
branches;
next	;
commitid	dd8meP197Xg3dwF8;


desc
@@


1.3
log
@use MODGCC4_ARCHS=${GCC3_ARCHS} ${GCC4_ARCHS}; c99 but no c++
@
text
@# $OpenBSD: Makefile,v 1.2 2016/12/02 15:17:40 sthen Exp $

COMMENT=	milter for rspamd (also supports clamav, rate-limiting, etc)

GH_ACCOUNT=	vstakhov
GH_PROJECT=	rmilter
GH_TAGNAME=	1.10.0

CATEGORIES=	mail

MAINTAINER=	Stuart Henderson <sthen@@openbsd.org>

# BSD
PERMIT_PACKAGE_CDROM=	Yes

WANTLIB += c crypto glib-2.0 intl m milter opendkim pcre pthread ssl

MODULES+=	devel/cmake \
		gcc4
MODGCC4_ARCHS=	${GCC3_ARCHS} ${GCC4_ARCHS}

BUILD_DEPENDS=	devel/bison
LIB_DEPENDS=	devel/glib2 \
		devel/pcre \
		mail/sendmail,-libmilter \
		mail/opendkim

CONFIGURE_ARGS=	-DCMAKE_C_OPT_FLAGS="${CFLAGS}" \
		-DMANDIR="${TRUEPREFIX}/man"

NO_TEST=	Yes

# no trailing crlf
post-extract:
	cd ${WRKSRC}; for i in http-parser lc-btrie xxhash; \
	    do echo >> contrib/$$i/CMakeLists.txt; done

pre-configure:
	sed -i -e 's,/etc/,${SYSCONFDIR}/,g' \
	    -e 's,/var/,${LOCALSTATEDIR}/,g' \
	    ${WRKSRC}/rmilter*conf* ${WRKSRC}/src/main.c

post-install:
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/rmilter
	${INSTALL_DATA} ${WRKSRC}/rmilter.conf.sample \
	    ${WRKSRC}/rmilter-grey.conf \
	    ${PREFIX}/share/examples/rmilter/

.include <bsd.port.mk>
@


1.2
log
@avoid unnecessary >80col line
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2016/12/02 14:57:41 sthen Exp $
d20 1
a20 1
MODGCC4_ARCHS=	*
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d35 2
a36 2
	cd ${WRKSRC}; for i in contrib/http-parser contrib/lc-btrie contrib/xxhash; \
	    do echo >> $$i/CMakeLists.txt; done
@


1.1.1.1
log
@import ports/mail/rmilter, testing/tweaks Johan Huldtgren, review/ok jca

Rmilter is used to integrate rspamd with any milter-compatible MTA, for
example postfix or sendmail. Features include:

- ClamAV scanning (via unix or tcp socket).
- Rspamd scanning
- Greylisting and rate-limiting with redis upstream
- Auto-whitelisting (internal and via redis upstream)
- Replies check (whitelisting replies to sent messages)
- Passing messages and/or their headers to beanstalk servers
@
text
@@
