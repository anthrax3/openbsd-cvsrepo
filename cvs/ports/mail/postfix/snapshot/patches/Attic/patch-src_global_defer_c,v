head	1.2;
access;
symbols;
locks; strict;
comment	@# @;


1.2
date	2004.06.22.05.20.13;	author brad;	state dead;
branches;
next	1.1;

1.1
date	2004.06.11.07.47.30;	author brad;	state Exp;
branches;
next	;


desc
@@


1.2
log
@upgrade Postfix ports to latest releases, 2.1.3 and 2.2-20040616 as well
as installing qshape.

ok MAINTAINER
@
text
@$OpenBSD: patch-src_global_defer_c,v 1.1 2004/06/11 07:47:30 brad Exp $
--- src/global/defer.c.orig	2003-09-21 19:43:38.000000000 -0400
+++ src/global/defer.c	2004-06-10 00:13:49.000000000 -0400
@@@@ -224,14 +224,16 @@@@ int     vdefer_append(int flags, const c
 			     ATTR_TYPE_STR, MAIL_ATTR_WHY, vstring_str(why),
 				ATTR_TYPE_END) != 0)
 	    msg_warn("%s: %s service failure", id, var_defer_service);
-	vlog_adhoc(id, orig_rcpt, recipient, relay, entry, "deferred", fmt, ap);
+	log_adhoc(id, orig_rcpt, recipient, relay, entry, "deferred",
+	          "%s", vstring_str(why));
 
 	/*
 	 * Traced delivery.
 	 */
 	if (flags & DEL_REQ_FLAG_RECORD)
-	    if (vtrace_append(flags, id, orig_rcpt, recipient, relay,
-			      entry, "4.0.0", "deferred", fmt, ap) != 0)
+	    if (trace_append(flags, id, orig_rcpt, recipient, relay,
+			     entry, "4.0.0", "deferred",
+			     "%s", vstring_str(why)) != 0)
 		msg_warn("%s: %s service failure", id, var_trace_service);
 
 	/*
@


1.1
log
@fix sig11's and logfile string corruption that happen on PowerPC only
with Postfix' smtp.

details:
http://marc.theaimsgroup.com/?l=postfix-users&m=108684058831938&w=2
http://marc.theaimsgroup.com/?t=108680602700006&r=1&w=2
http://marc.theaimsgroup.com/?t=108683377500002&r=1&w=2
@
text
@d1 1
a1 1
$OpenBSD$
@

