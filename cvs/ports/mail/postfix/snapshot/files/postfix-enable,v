head	1.8;
access;
symbols
	OPENBSD_6_1:1.8.0.8
	OPENBSD_6_1_BASE:1.8
	OPENBSD_6_0:1.8.0.6
	OPENBSD_6_0_BASE:1.8
	OPENBSD_5_9:1.8.0.2
	OPENBSD_5_9_BASE:1.8
	OPENBSD_5_8:1.8.0.4
	OPENBSD_5_8_BASE:1.8
	OPENBSD_5_7:1.7.0.4
	OPENBSD_5_7_BASE:1.7
	OPENBSD_5_6:1.7.0.2
	OPENBSD_5_6_BASE:1.7
	OPENBSD_5_5:1.6.0.12
	OPENBSD_5_5_BASE:1.6
	OPENBSD_5_4:1.6.0.10
	OPENBSD_5_4_BASE:1.6
	OPENBSD_5_3:1.6.0.8
	OPENBSD_5_3_BASE:1.6
	OPENBSD_5_2:1.6.0.6
	OPENBSD_5_2_BASE:1.6
	OPENBSD_5_1_BASE:1.6
	OPENBSD_5_1:1.6.0.4
	OPENBSD_5_0:1.6.0.2
	OPENBSD_5_0_BASE:1.6
	OPENBSD_4_9:1.5.0.20
	OPENBSD_4_9_BASE:1.5
	OPENBSD_4_8:1.5.0.18
	OPENBSD_4_8_BASE:1.5
	OPENBSD_4_7:1.5.0.16
	OPENBSD_4_7_BASE:1.5
	OPENBSD_4_6:1.5.0.14
	OPENBSD_4_6_BASE:1.5
	OPENBSD_4_5:1.5.0.12
	OPENBSD_4_5_BASE:1.5
	OPENBSD_4_4:1.5.0.10
	OPENBSD_4_4_BASE:1.5
	OPENBSD_4_3:1.5.0.8
	OPENBSD_4_3_BASE:1.5
	OPENBSD_4_2:1.5.0.6
	OPENBSD_4_2_BASE:1.5
	OPENBSD_4_1:1.5.0.4
	OPENBSD_4_1_BASE:1.5
	OPENBSD_4_0:1.5.0.2
	OPENBSD_4_0_BASE:1.5
	OPENBSD_3_9:1.4.0.2
	OPENBSD_3_9_BASE:1.4
	OPENBSD_3_8:1.3.0.14
	OPENBSD_3_8_BASE:1.3
	OPENBSD_3_7:1.3.0.12
	OPENBSD_3_7_BASE:1.3
	OPENBSD_3_6:1.3.0.10
	OPENBSD_3_6_BASE:1.3
	OPENBSD_3_5:1.3.0.8
	OPENBSD_3_5_BASE:1.3
	OPENBSD_3_4:1.3.0.6
	OPENBSD_3_4_BASE:1.3
	OPENBSD_3_3:1.3.0.4
	OPENBSD_3_3_BASE:1.3
	OPENBSD_3_2:1.3.0.2
	OPENBSD_3_2_BASE:1.3
	OPENBSD_3_1:1.2.0.2
	OPENBSD_3_1_BASE:1.2
	OPENBSD_3_0:1.1.0.6
	OPENBSD_3_0_BASE:1.1
	OPENBSD_2_9_TRACKING_SWITCH:1.1
	OPENBSD_2_9:1.1.0.4
	OPENBSD_2_9_BASE:1.1
	OPENBSD_2_8:1.1.0.2
	OPENBSD_2_8_BASE:1.1;
locks; strict;
comment	@# @;


1.8
date	2015.05.12.22.06.18;	author sthen;	state Exp;
branches;
next	1.7;
commitid	xACITehQCNflsQvB;

1.7
date	2014.04.02.00.33.09;	author brad;	state Exp;
branches;
next	1.6;

1.6
date	2011.07.15.18.10.18;	author robert;	state Exp;
branches;
next	1.5;

1.5
date	2006.07.05.06.21.09;	author jakob;	state Exp;
branches;
next	1.4;

1.4
date	2006.02.07.19.48.53;	author brad;	state Exp;
branches;
next	1.3;

1.3
date	2002.04.19.21.11.29;	author jakob;	state Exp;
branches;
next	1.2;

1.2
date	2001.11.10.23.33.45;	author jakob;	state Exp;
branches;
next	1.1;

1.1
date	2000.09.25.21.02.33;	author jakob;	state Exp;
branches
	1.1.6.1;
next	;

1.1.6.1
date	2001.11.12.20.56.53;	author jakob;	state Exp;
branches;
next	;


desc
@@


1.8
log
@Adjust the message printed by postfix-enable; since sendsyslog(2) was
introduced there's no longer need for a log socket in the chroot jail,
also demonstrate use of rcctl rather than asking the user to manually
change rc.conf.local (making the message more generic while there).
OK brad.
@
text
@#!/bin/sh
#
# $OpenBSD: postfix-enable,v 1.7 2014/04/02 00:33:09 brad Exp $

if [ -f /etc/mailer.conf.postfix ]; then
    if [ -f /etc/mailer.conf ]; then
        mv -f /etc/mailer.conf /etc/mailer.conf.pre-postfix
        echo "old /etc/mailer.conf saved as /etc/mailer.conf.pre-postfix"
    fi
    mv -f /etc/mailer.conf.postfix /etc/mailer.conf
    echo "postfix /etc/mailer.conf enabled"
    echo ""
    echo "NOTE: rc.conf changes are required to disable your previous MTA and"
    echo "      start Postfix, e.g.:"
    echo ""
    echo "rcctl stop smtpd; rcctl disable smtpd"
    echo "rcctl enable postfix; rcctl start postfix"
else
    echo "can't find /etc/mailer.conf.postfix, postfix not enabled"
fi
@


1.7
log
@Replace sendmail with smtpd.

From David Hill

ok sthen@@
@
text
@d3 1
a3 1
# $OpenBSD: postfix-enable,v 1.6 2011/07/15 18:10:18 robert Exp $
d13 2
a14 2
    echo "NOTE: do not forget to add smtpd_flags=NO to"
    echo "      /etc/rc.conf.local to disable smtpd." 
d16 2
a17 5
    echo "NOTE: do not forget to add \"-a /var/spool/postfix/dev/log\" to"
    echo "      syslogd_flags in /etc/rc.conf.local and restart syslogd."
    echo ""
    echo "NOTE: do not forget to add postfix to pkg_scripts in"
    echo "      /etc/rc.conf.local to start postfix automatically." 
@


1.6
log
@add an rc script for postfix and modify postfix-enable to tell the
user to disable sendmail compeltely to stop abusing that script to starting
up postfix.

the script itself also checks if postfix is actually enabled and if it's not
it is going to fail to avoid conflicts with mailer.conf
@
text
@d3 1
a3 1
# $OpenBSD: postfix-enable,v 1.8 2008/02/01 16:37:53 jakob Exp $
d13 2
a14 2
    echo "NOTE: do not forget to add sendmail_flags=NO to"
    echo "      /etc/rc.conf.local to disable sendmail." 
a20 3
    echo ""
    echo "NOTE: do not forget to remove the \"sendmail clientmqueue runner\""
    echo "      from root's crontab."
@


1.5
log
@move syslog warning to postfix-enable script
@
text
@d3 1
a3 1
# $OpenBSD: postfix-enable,v 1.4 2006/02/07 19:48:53 brad Exp $
d13 2
a14 2
    echo "NOTE: do not forget to add sendmail_flags=\"-bd\" to"
    echo "      /etc/rc.conf.local to startup postfix correctly." 
d18 3
@


1.4
log
@do not bother mentioning the sendmail -q[num] flag as the Postfix
sendmail wrapper ignores this flag; Postfix uses the value of
queue_run_delay instead.
@
text
@d3 1
a3 1
# $OpenBSD: postfix-enable,v 1.3 2002/04/19 21:11:29 jakob Exp $
d15 3
@


1.3
log
@update to snapshot 1.1.7-20020331
@
text
@d3 1
a3 1
# $OpenBSD: postfix-enable,v 1.2 2001/11/10 23:33:22 jakob Exp $
d13 1
a13 1
    echo "NOTE: do not forget to add sendmail_flags=\"-bd -q30m\" to"
@


1.2
log
@sync enable script with stable
@
text
@@


1.1
log
@split port into stable and snapshot versions
@
text
@d3 1
a3 1
# $OpenBSD: postfix-enable,v 1.2 1999/12/05 15:01:28 jakob Exp $
d12 6
@


1.1.6.1
log
@add note about sendmail_flags and sendmail clientmqueue runner
@
text
@d3 1
a3 1
# $OpenBSD: postfix-enable,v 1.2 2001/11/10 23:33:45 jakob Exp $
a11 6
    echo ""
    echo "NOTE: do not forget to add sendmail_flags=\"-bd -q30m\" to"
    echo "      /etc/rc.conf.local to startup postfix correctly." 
    echo ""
    echo "NOTE: do not forget to remove the \"sendmail clientmqueue runner\""
    echo "      from root's crontab."
@


