head	1.37;
access;
symbols
	OPENBSD_6_2:1.37.0.2
	OPENBSD_6_2_BASE:1.37
	OPENBSD_6_1:1.34.0.2
	OPENBSD_6_1_BASE:1.34
	OPENBSD_6_0:1.33.0.2
	OPENBSD_6_0_BASE:1.33
	OPENBSD_5_9:1.32.0.2
	OPENBSD_5_9_BASE:1.32
	OPENBSD_5_8:1.30.0.6
	OPENBSD_5_8_BASE:1.30
	OPENBSD_5_7:1.30.0.2
	OPENBSD_5_7_BASE:1.30
	OPENBSD_5_6:1.29.0.2
	OPENBSD_5_6_BASE:1.29
	OPENBSD_5_5:1.28.0.2
	OPENBSD_5_5_BASE:1.28
	OPENBSD_5_4:1.27.0.2
	OPENBSD_5_4_BASE:1.27
	OPENBSD_5_3:1.15.0.2
	OPENBSD_5_3_BASE:1.15
	OPENBSD_5_2:1.14.0.2
	OPENBSD_5_2_BASE:1.14
	OPENBSD_5_1_BASE:1.13
	OPENBSD_5_1:1.13.0.2
	OPENBSD_5_0:1.10.0.4
	OPENBSD_5_0_BASE:1.10
	OPENBSD_4_9:1.10.0.2
	OPENBSD_4_9_BASE:1.10
	OPENBSD_4_8:1.6.0.6
	OPENBSD_4_8_BASE:1.6
	OPENBSD_4_7:1.6.0.4
	OPENBSD_4_7_BASE:1.6
	OPENBSD_4_6:1.6.0.2
	OPENBSD_4_6_BASE:1.6
	OPENBSD_4_5:1.5.0.4
	OPENBSD_4_5_BASE:1.5
	OPENBSD_4_4:1.5.0.2
	OPENBSD_4_4_BASE:1.5
	OPENBSD_4_3:1.4.0.2
	OPENBSD_4_3_BASE:1.4
	OPENBSD_4_2:1.3.0.4
	OPENBSD_4_2_BASE:1.3
	OPENBSD_4_1:1.3.0.2
	OPENBSD_4_1_BASE:1.3
	msf_20061117:1.1.1.1
	msf:1.1.1;
locks; strict;
comment	@# @;


1.37
date	2017.07.26.22.45.26;	author sthen;	state Exp;
branches;
next	1.36;
commitid	tD4MFrpYYDDL2UFT;

1.36
date	2017.07.16.19.18.59;	author espie;	state Exp;
branches;
next	1.35;
commitid	tt0GhWK5c4uf9ILG;

1.35
date	2017.04.10.11.46.22;	author sthen;	state Exp;
branches;
next	1.34;
commitid	BLsh88fJB8thZTwY;

1.34
date	2016.11.07.21.29.56;	author giovanni;	state Exp;
branches;
next	1.33;
commitid	mX31HLaFUvtyQEmq;

1.33
date	2016.03.11.20.28.27;	author naddy;	state Exp;
branches;
next	1.32;
commitid	UYLP8TE6V7RS2GhJ;

1.32
date	2015.08.27.13.51.27;	author giovanni;	state Exp;
branches;
next	1.31;
commitid	pudQgKvh2JXpwAI6;

1.31
date	2015.08.21.22.51.10;	author sthen;	state Exp;
branches;
next	1.30;
commitid	Ahig7CHjExrDzTdF;

1.30
date	2014.09.13.18.09.21;	author brad;	state Exp;
branches;
next	1.29;
commitid	PpbRjVZdAmlrmi8q;

1.29
date	2014.04.21.14.18.14;	author sthen;	state Exp;
branches;
next	1.28;

1.28
date	2013.11.15.10.10.02;	author sthen;	state Exp;
branches;
next	1.27;

1.27
date	2013.06.20.08.26.13;	author ajacoutot;	state Exp;
branches
	1.27.2.1;
next	1.26;

1.26
date	2013.06.20.06.54.36;	author ajacoutot;	state Exp;
branches;
next	1.25;

1.25
date	2013.06.18.18.59.42;	author sthen;	state Exp;
branches;
next	1.24;

1.24
date	2013.06.17.19.28.36;	author ajacoutot;	state Exp;
branches;
next	1.23;

1.23
date	2013.06.12.20.36.33;	author brad;	state Exp;
branches;
next	1.22;

1.22
date	2013.05.26.13.45.00;	author espie;	state Exp;
branches;
next	1.21;

1.21
date	2013.05.25.00.33.10;	author brad;	state Exp;
branches;
next	1.20;

1.20
date	2013.03.21.08.46.32;	author ajacoutot;	state Exp;
branches;
next	1.19;

1.19
date	2013.03.16.01.30.25;	author sthen;	state Exp;
branches;
next	1.18;

1.18
date	2013.03.15.16.41.19;	author sthen;	state Exp;
branches;
next	1.17;

1.17
date	2013.03.15.15.17.36;	author sthen;	state Exp;
branches;
next	1.16;

1.16
date	2013.03.11.11.23.53;	author espie;	state Exp;
branches;
next	1.15;

1.15
date	2013.02.09.14.49.51;	author sthen;	state Exp;
branches;
next	1.14;

1.14
date	2012.04.28.10.52.08;	author ajacoutot;	state Exp;
branches;
next	1.13;

1.13
date	2011.09.16.10.31.22;	author espie;	state Exp;
branches;
next	1.12;

1.12
date	2011.09.12.18.08.26;	author naddy;	state Exp;
branches;
next	1.11;

1.11
date	2011.09.12.18.02.35;	author naddy;	state Exp;
branches;
next	1.10;

1.10
date	2010.11.26.14.44.27;	author espie;	state Exp;
branches;
next	1.9;

1.9
date	2010.11.19.07.23.09;	author espie;	state Exp;
branches;
next	1.8;

1.8
date	2010.11.11.10.54.02;	author espie;	state Exp;
branches;
next	1.7;

1.7
date	2010.10.18.19.59.18;	author espie;	state Exp;
branches;
next	1.6;

1.6
date	2009.03.16.17.52.52;	author sthen;	state Exp;
branches;
next	1.5;

1.5
date	2008.06.08.10.55.25;	author simon;	state Exp;
branches;
next	1.4;

1.4
date	2007.09.16.00.17.06;	author merdely;	state Exp;
branches;
next	1.3;

1.3
date	2006.11.25.11.00.38;	author msf;	state Exp;
branches;
next	1.2;

1.2
date	2006.11.24.09.41.09;	author msf;	state Exp;
branches;
next	1.1;

1.1
date	2006.11.16.23.26.00;	author msf;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2006.11.16.23.26.00;	author msf;	state Exp;
branches;
next	;

1.27.2.1
date	2013.11.17.15.21.55;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.37
log
@bump LIBCXX/LIBECXX/COMPILER_LIBCXX ports.
@
text
@# $OpenBSD: Makefile,v 1.36 2017/07/16 19:18:59 espie Exp $

COMMENT-main=	fully featured POP3 and IMAP4 proxy server
COMMENT-ldap=	LDAP backend for perdition mail proxy
COMMENT-mysql=	MySQL backend for perdition mail proxy
COMMENT-pgsql=	PostgreSQL backend for perdition mail proxy

DISTVER=	2.2
DISTNAME=	perdition-${DISTVER}
PKGNAME-main=	perdition-${DISTVER:S/-//}
PKGNAME-ldap=	perdition-ldap-${DISTVER:S/-//}
PKGNAME-mysql=	perdition-mysql-${DISTVER:S/-//}
PKGNAME-pgsql=	perdition-pgsql-${DISTVER:S/-//}
REVISION-ldap=	0
REVISION-main=	0
REVISION-mysql=	0
REVISION-pgsql=	0

CATEGORIES=	mail

HOMEPAGE=	http://horms.net/projects/perdition/
MAINTAINER=	Giovanni Bechis <giovanni@@openbsd.org>

SHARED_LIBS +=  perditiondb_bdb              0.0  # .0.0
SHARED_LIBS +=  perditiondb_nis              0.0  # .0.0
SHARED_LIBS +=  perditiondb_posix_regex      0.0  # .0.0
SHARED_LIBS +=  perditiondb_daemon           0.0  # .0.0
SHARED_LIBS +=  perditiondb_daemon_base      0.0  # .0.0
SHARED_LIBS +=  perditiondb_ldap             0.0  # .0.0
SHARED_LIBS +=  perditiondb_mysql            0.0  # .0.0
SHARED_LIBS +=  perditiondb_postgresql       0.0  # .0.0

# GPLv2+ (included COPYING is v3, but all files with a
# copyright claim specify version 2 or above).
PERMIT_PACKAGE_CDROM=	Yes

MASTER_SITES=	${HOMEPAGE}download/${DISTVER}/

MODULES=	devel/gettext

USE_GMAKE=	Yes

CONFIGURE_STYLE= gnu
CONFIGURE_ENV+=	CPPFLAGS="-I${LOCALBASE}/include -I${LOCALBASE}/include/db4" \
		LDFLAGS="-L${LOCALBASE}/lib"

CONFIGURE_ARGS+=	--enable-ssl \
			--disable-cdb \
			--disable-gdbm \
			--disable-odbc \
			--disable-pam \
			--with-ssl-includes=/usr/include \
			--with-ssl-libraries=/usr/lib \
			--with-user=_perdition \
			--with-group=_perdition

PSEUDO_FLAVORS=		no_ldap no_mysql no_pgsql
FLAVOR?=

MULTI_PACKAGES=		-main -mysql -pgsql -ldap

.include <bsd.port.arch.mk>

cWANTLIB=		lib/db4/db>=4 vanessa_logger>=1.0
cLIB_DEPENDS+=		databases/db/v4 \
			vanessa_logger->=0.0.10:devel/vanessa/logger

WANTLIB-main=		${cWANTLIB} ${MODGETTEXT_WANTLIB} \
			c crypto ssl util popt idn \
			vanessa_adt>=1.0 vanessa_socket>=1.0
LIB_DEPENDS-main=	${cLIB_DEPENDS} ${LIB_DEPENDS} \
			${MODGETTEXT_LIB_DEPENDS} \
			devel/popt devel/libidn \
			vanessa_adt->=0.0.9:devel/vanessa/adt \
			vanessa_socket->=0.0.12:devel/vanessa/socket

LIB_DEPENDS-ldap=	${cLIB_DEPENDS} security/cyrus-sasl2 \
			openldap-client->=2,<3:databases/openldap
WANTLIB-ldap=		crypto lber-2.4 ldap-2.4 sasl2 ssl util ${cWANTLIB}

.if !${BUILD_PACKAGES:M-ldap}
CONFIGURE_ARGS+=	--disable-ldap
.else
CONFIGURE_ARGS+=	--with-ldap-libraries=${LOCALBASE}/lib \
			--with-ldap-includes=${LOCALBASE}/include \
			--disable-ldap-doc
.endif

LIB_DEPENDS-mysql=	${cLIB_DEPENDS} databases/mariadb \
			vanessa_adt->=0.0.9:devel/vanessa/adt
WANTLIB-mysql=		crypto pthread ssl ${COMPILER_LIBCXX} util m z \
			lib/mysql/mysqlclient ${cWANTLIB} \
			vanessa_adt>=1.0

.if !${BUILD_PACKAGES:M-mysql}
CONFIGURE_ARGS+=	--disable-mysql
.else
CONFIGURE_ARGS+=	--with-mysql-libraries=${LOCALBASE}/lib/mysql \
			--with-mysql-includes=${LOCALBASE}/include/mysql
.endif

LIB_DEPENDS-pgsql=	${cLIB_DEPENDS} databases/postgresql \
			vanessa_adt->=0.0.9:devel/vanessa/adt
WANTLIB-pgsql=		crypto pq ssl util ${cWANTLIB} vanessa_adt>=1.0

.if !${BUILD_PACKAGES:M-pgsql}
CONFIGURE_ARGS+=	--disable-pg
.else
CONFIGURE_ARGS+=	--enable-pg
.endif

EXAMPLE_DIR=	${PREFIX}/share/examples/perdition/

post-install:
	${INSTALL_DATA_DIR} ${EXAMPLE_DIR}
	@@mv ${WRKINST}${SYSCONFDIR}/perdition/* ${EXAMPLE_DIR}

.include <bsd.port.mk>
@


1.36
log
@use COMPILER_LIBCXX where applicable
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2017/04/10 11:46:22 sthen Exp $
d14 4
@


1.35
log
@use LIBCXX
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2016/11/07 21:29:56 giovanni Exp $
d87 1
a87 1
WANTLIB-mysql=		crypto pthread ssl ${LIBCXX} util m z \
@


1.34
log
@Update to 2.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2016/03/11 20:28:27 naddy Exp $
d87 1
a87 1
WANTLIB-mysql=		crypto pthread ssl stdc++ util m z \
@


1.33
log
@garbage collect CONFIGURE_SHARED
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2015/08/27 13:51:27 giovanni Exp $
d8 1
a8 1
DISTVER=	2.1
@


1.32
log
@Update to 2.1 and take maintainership
ok jca@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2015/08/21 22:51:10 sthen Exp $
d43 1
a43 2
CONFIGURE_ARGS+=	${CONFIGURE_SHARED} \
			--enable-ssl \
@


1.31
log
@sync WANTLIB
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2014/09/13 18:09:21 brad Exp $
d5 1
a5 1
COMMENT-mysql=  MySQL backend for perdition mail proxy
d8 1
a8 3
DISTVER=	1.19-rc5
REVISION=	6
REVISION-mysql=	8
d12 2
a13 2
PKGNAME-mysql=  perdition-mysql-${DISTVER:S/-//}
PKGNAME-pgsql=  perdition-pgsql-${DISTVER:S/-//}
d17 3
a19 1
SHARED_LIBS +=  jain                         0.0  # .0.0
a28 2
HOMEPAGE=	http://www.vergenet.net/linux/perdition/

d61 10
a70 3
cWANTLIB=		lib/db4/db>=4 vanessa_logger>=1.0 vanessa_socket>=1.0 \
			vanessa_adt>=1.0
LIB_DEPENDS+=		databases/db/v4 \
a71 1
			vanessa_logger->=0.0.10:devel/vanessa/logger \
d74 1
a74 5
WANTLIB-main=		${MODGETTEXT_WANTLIB} ${cWANTLIB} \
			c crypto ssl util popt idn
LIB_DEPENDS-main=	${LIB_DEPENDS} devel/popt devel/libidn

LIB_DEPENDS-ldap=	${LIB_DEPENDS} security/cyrus-sasl2 \
d86 5
a90 3
LIB_DEPENDS-mysql=	${LIB_DEPENDS} databases/mariadb
WANTLIB-mysql=		crypto ssl util m z lib/mysql/mysqlclient \
			pthread stdc++ ${cWANTLIB}
d99 3
a101 2
LIB_DEPENDS-pgsql=	${LIB_DEPENDS} databases/postgresql
WANTLIB-pgsql=		crypto pq ssl util ${cWANTLIB}
@


1.30
log
@Switch from using MySQL to using MariaDB attempt #2. MariaDB is a drop-in replacement.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2014/04/21 14:18:14 sthen Exp $
d10 1
a10 1
REVISION-mysql=	7
d87 2
a88 1
WANTLIB-mysql=		crypto ssl util m z lib/mysql/mysqlclient ${cWANTLIB}
@


1.29
log
@sync wantlib
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2013/11/15 10:10:02 sthen Exp $
d10 1
d86 2
a87 2
LIB_DEPENDS-mysql=	${LIB_DEPENDS} databases/mysql
WANTLIB-mysql=		crypto ssl util m z lib/mysql/mysqlclient>=10 ${cWANTLIB}
@


1.28
log
@SECURITY patch for Perdition: use the correct list of ciphers for
outgoing STARTTLS cnnections.  CVE-2013-4584
http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=729028
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2013/06/20 08:26:13 ajacoutot Exp $
d9 1
a9 3
REVISION=	4
REVISION-main=	5
REVISION-mysql=	5
d62 3
a64 4
WANTLIB-main=		${MODGETTEXT_WANTLIB} \
			c crypto ssl util lib/db4/db>=4 vanessa_adt>=1.0 \
			vanessa_logger>=1.0 vanessa_socket>=1.0 popt idn
LIB_DEPENDS-main=	databases/db/v4 \
d67 9
a75 10
			vanessa_socket->=0.0.12:devel/vanessa/socket \
			devel/popt \
			devel/libidn

LIB_DEPENDS-ldap=	security/cyrus-sasl2 \
			openldap-client->=2,<3:databases/openldap \
			vanessa_logger->=0.0.10:devel/vanessa/logger
WANTLIB-ldap=		asn1 com_err crypto gssapi krb5 ssl util sasl2 \
			heimbase lber-2.4 ldap-2.4 \
			wind roken vanessa_logger
d85 2
a86 5
LIB_DEPENDS-mysql=	databases/mysql \
			devel/vanessa/adt \
			devel/vanessa/logger
WANTLIB-mysql=		crypto ssl util m z lib/mysql/mysqlclient>=10 \
			vanessa_adt>=1.0 vanessa_logger>=1.0
d95 2
a96 6
LIB_DEPENDS-pgsql=	databases/postgresql \
			devel/vanessa/adt \
			devel/vanessa/logger
WANTLIB-pgsql=		crypto ssl util pq>=2 vanessa_adt>=1.0 \
			vanessa_logger>=1.0 asn1 com_err heimbase \
			krb5 roken wind
@


1.27
log
@No need for pthread.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2013/06/20 06:54:36 ajacoutot Exp $
d10 1
@


1.27.2.1
log
@SECURITY patch for Perdition: use the correct list of ciphers for
outgoing STARTTLS cnnections.  CVE-2013-4584
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2013/06/20 08:26:13 ajacoutot Exp $
a9 1
REVISION-main=	5
@


1.26
log
@Unbreak after hx509 and ntlm removal from Kerberos.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2013/06/18 18:59:42 sthen Exp $
d9 1
a9 1
REVISION=	3
d77 1
a77 1
			heimbase lber-2.4 ldap-2.4 pthread \
d106 1
a106 1
			krb5 pthread roken wind
@


1.25
log
@bump
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2013/06/17 19:28:36 ajacoutot Exp $
d9 2
a10 2
REVISION=	2
REVISION-mysql=	4
d77 1
a77 1
			heimbase heimntlm hx509 lber-2.4 ldap-2.4 pthread \
d106 1
a106 1
			hx509 krb5 pthread roken wind
@


1.24
log
@Some trivial WANTLIB and tweaks to unbreak after the Heimdal update.
Stop hardcoding the Kerberos libs and use krb5-config(1).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2013/06/12 20:36:33 brad Exp $
d10 1
a14 1
REVISION-mysql=	3
@


1.23
log
@Revert back to using MySQL 5.1 for the time being. MariaDB 5.5 introduces
a new libmysqlclient non-blocking API which utilizes co-routines. The X86
specific GCC ASM co-routine support hid the fact that there was an issue.
The only fallback code so far is POSIX user contexts which OpenBSD does not
support.

Input from and Ok sthen@@ jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2013/05/26 13:45:00 espie Exp $
d9 1
a9 1
REVISION=	1
d37 2
d63 3
a65 2
WANTLIB-main=		c crypto ssl util db>=4.2 vanessa_adt>=1.0 \
			vanessa_logger>=1.0 vanessa_socket>=1.0 popt
d70 2
a71 1
			devel/popt
d74 2
a75 1
			openldap-client->=2,<3:databases/openldap
d77 2
a78 1
			ldap>=2 lber>=2
d105 2
a106 1
			vanessa_logger>=1.0
@


1.22
log
@brad, build your shit, use register-plist
you will avoid beginner's mistakes like those
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2013/05/25 00:33:10 brad Exp $
d14 1
a14 1
REVISION-mysql=	2
d82 1
a82 1
LIB_DEPENDS-mysql=	databases/mariadb \
@


1.21
log
@Switch from using MySQL to using MariaDB. MariaDB is a drop-in replacement.


ok sthen aja
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2013/03/21 08:46:32 ajacoutot Exp $
d14 1
a14 1
REVISION-mysql=	0
@


1.20
log
@USE_LIBTOOL=Yes is the default now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2013/03/16 01:30:25 sthen Exp $
d14 1
d82 1
a82 1
LIB_DEPENDS-mysql=	databases/mysql \
@


1.19
log
@tighten lib specs; from Rogier Krieger
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2013/03/15 16:41:19 sthen Exp $
a36 1
USE_LIBTOOL=	Yes
@


1.18
log
@Forcibly disable unported modules (pam failure pointed out by nigel@@).
Clean up configure env handling.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2013/03/15 15:17:36 sthen Exp $
d9 1
a9 1
REVISION=	0
d86 1
a86 1
			vanessa_adt>=0.3 vanessa_logger>=0.3
d98 2
a99 2
WANTLIB-pgsql=		crypto ssl util pq>=2 vanessa_adt>=0.3 \
			vanessa_logger>=0.3
@


1.17
log
@Update Perdition to 1.19-rc5 (using a so-called "release candidate" because
upstream haven't made a real release in quite some time, and this fixes
problems people have encountered). Change to DPB-friendly no_subpackage
handling and don't use groff.

Feedback/tweaks, fix for SSL timeout-related failure, and testing
from Rogier Krieger.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2013/03/11 11:23:53 espie Exp $
d9 1
d39 3
a41 3
CONFIGURE_STYLE=gnu
CFLAGS+=-I${LOCALBASE}/include -I${LOCALBASE}/include/db4
CONFIGURE_ENV+="LDFLAGS=-L${LOCALBASE}/lib"
d43 1
a43 1
CONFIGURE_ARGS+=	--disable-silent-rules \
d45 4
a50 2
			--disable-gdbm \
			--disable-odbc \
@


1.16
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2013/02/09 14:49:51 sthen Exp $
d8 1
a8 1
DISTVER=	1.17.1
d10 4
a13 8
PKGNAME-main=	${DISTNAME}
PKGNAME-ldap=	perdition-ldap-${DISTVER}
REVISION-main =	2
REVISION-ldap =	1
REVISION-mysql =	0
REVISION-pgsql =	0
PKGNAME-mysql=  perdition-mysql-${DISTVER}
PKGNAME-pgsql=  perdition-pgsql-${DISTVER}
d23 3
d29 2
a30 1
# GPL
a36 1
USE_GROFF =	Yes
d42 2
a43 1
CONFIGURE_ARGS+=	--enable-ssl \
a50 2
NO_TEST=Yes

d54 3
a56 1
MULTI_PACKAGES= 	-main
d58 2
a59 2
WANTLIB-main=       	c crypto ssl util db>=4.2 vanessa_adt>=0.3 \
			vanessa_logger>=0.3 vanessa_socket>=0.3 popt
d61 3
a63 3
			devel/vanessa/adt \
			devel/vanessa/logger \
			devel/vanessa/socket \
d66 6
a71 1
.if ${FLAVOR:Mno_ldap}
a73 2
SHARED_LIBS +=  	perditiondb_ldap             0.0  # .0.0
MULTI_PACKAGES+=	-ldap
a76 4
LIB_DEPENDS-ldap=	security/cyrus-sasl2 \
			openldap-client->=2,<3:databases/openldap
WANTLIB-ldap= 		asn1 com_err crypto gssapi krb5 ssl util sasl2 \
			ldap>=2 lber>=2
a78 7
.if ${FLAVOR:Mno_mysql}
CONFIGURE_ARGS+=	--disable-mysql
.else
SHARED_LIBS +=  	perditiondb_mysql            0.0  # .0.0
MULTI_PACKAGES+=	-mysql
CONFIGURE_ARGS+=	--with-mysql-libraries=${LOCALBASE}/lib/mysql \
			--with-mysql-includes=${LOCALBASE}/include/mysql
d84 6
a91 6
.if ${FLAVOR:Mno_pgsql}
CONFIGURE_ARGS+=	--disable-pg
.else 
SHARED_LIBS +=  	perditiondb_postgresql       0.0  # .0.0
MULTI_PACKAGES+=	-pgsql
CONFIGURE_ARGS+=	--enable-pg
d97 5
@


1.15
log
@Don't use ${FLAVOR:L}, we only support lower-case flavours now.
OK ajacoutot@@ espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2012/04/28 10:52:08 ajacoutot Exp $
a31 3
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
d51 1
a51 1
NO_REGRESS=Yes
@


1.14
log
@--localstatedir=/var is the default now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2011/09/16 10:31:22 espie Exp $
d69 1
a69 1
.if ${FLAVOR:L:Mno_ldap}
d83 1
a83 1
.if ${FLAVOR:L:Mno_mysql}
d97 1
a97 1
.if ${FLAVOR:L:Mno_pgsql}
@


1.13
log
@normalize pkgpath
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2011/09/12 18:08:26 naddy Exp $
d52 1
a52 2
			--with-group=_perdition \
			--localstatedir=/var
@


1.12
log
@remove unused pseudo-flavor
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2011/09/12 18:02:35 naddy Exp $
d12 4
a15 2
REVISION-main =	1
REVISION-ldap =	0
@


1.11
log
@bump all (sub)packages that depend on db/v4; requested by and help from espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2010/11/26 14:44:27 espie Exp $
d55 1
a55 1
PSEUDO_FLAVORS=		no_bdb no_ldap no_mysql no_pgsql
@


1.10
log
@default db-* for db/v4 is incorrect, set PKGSPEC=db->=4,<5, bump packages
with erroneous depends.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2010/11/19 07:23:09 espie Exp $
d12 1
a12 1
REVISION-main =	0
@


1.9
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2010/11/11 10:54:02 espie Exp $
d12 1
@


1.8
log
@a few email WANTLIBs
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2010/10/18 19:59:18 espie Exp $
d59 7
a65 7
WANTLIB-main=       	c crypto ssl util db.>=4.2 vanessa_adt.>=0.3 \
			vanessa_logger.>=0.3 vanessa_socket.>=0.3 popt.>=0
LIB_DEPENDS-main=	::databases/db/v4 \
			::devel/vanessa/adt \
			::devel/vanessa/logger \
			::devel/vanessa/socket \
			::devel/popt
d75 2
a76 2
LIB_DEPENDS-ldap=	::security/cyrus-sasl2 \
			:openldap-client->=2,<3:databases/openldap
d78 1
a78 1
			ldap.>=2 lber.>=2
d88 5
a92 5
LIB_DEPENDS-mysql=	::databases/mysql \
			::devel/vanessa/adt \
			::devel/vanessa/logger
WANTLIB-mysql=		crypto ssl util m z lib/mysql/mysqlclient.>=10 \
			vanessa_adt.>=0.3 vanessa_logger.>=0.3
d101 5
a105 5
LIB_DEPENDS-pgsql=	:postgresql-client-*:databases/postgresql \
			::devel/vanessa/adt \
			::devel/vanessa/logger
WANTLIB-pgsql=		crypto ssl util pq.>=2 vanessa_adt.>=0.3 \
			vanessa_logger.>=0.3
@


1.7
log
@USE_GROFF=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2009/03/16 17:52:52 sthen Exp $
d11 2
a12 1
PKGNAME-ldap=	perdition-ldap-${DISTVER}p0
d59 7
a65 6
WANTLIB-main=       	c crypto ssl util
LIB_DEPENDS-main=	db.>=4.2::databases/db/v4 \
			vanessa_adt.>=0.3::devel/vanessa/adt \
			vanessa_logger.>=0.3::devel/vanessa/logger \
			vanessa_socket.>=0.3::devel/vanessa/socket \
			popt.>=0::devel/popt
d75 4
a78 3
LIB_DEPENDS-ldap=	sasl2::security/cyrus-sasl2 \
			ldap.>=2,lber.>=2:openldap-client->=2,<3:databases/openldap
WANTLIB-ldap= 		asn1 com_err crypto gssapi krb5 ssl util
d88 5
a92 4
LIB_DEPENDS-mysql=	lib/mysql/mysqlclient.>=10::databases/mysql \
			vanessa_adt.>=0.3::devel/vanessa/adt \
			vanessa_logger.>=0.3::devel/vanessa/logger
WANTLIB-mysql=		crypto ssl util m z 
d101 5
a105 4
LIB_DEPENDS-pgsql=	pq.>=2:postgresql-client-*:databases/postgresql \
			vanessa_adt.>=0.3::devel/vanessa/adt \
			vanessa_logger.>=0.3::devel/vanessa/logger
WANTLIB-pgsql=		crypto ssl util
@


1.6
log
@fix depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2008/06/08 10:55:25 simon Exp $
d36 1
@


1.5
log
@security update to version 1.17.1

fixes CVE-2007-5740

prod and ok dlg@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2007/09/16 00:17:06 merdely Exp $
d11 1
a11 1
PKGNAME-ldap=	perdition-ldap-${DISTVER}
d72 2
a73 2
LIB_DEPENDS-ldap=		sasl2::security/cyrus-sasl2 \
			ldap.>=2,lber.>=2:openldap-client-2.*:databases/openldap
@


1.4
log
@Remove surrounding quotes in COMMENT*/PERMIT_*
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2006/11/25 11:00:38 msf Exp $
d8 1
a8 1
DISTVER=	1.17
d10 1
a10 1
PKGNAME-main=	${DISTNAME}p1
d22 1
@


1.3
log
@fix conflicting uid and gid. bump PKGNAME
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2006/11/24 09:41:09 msf Exp $
d3 4
a6 4
COMMENT-main=	"fully featured POP3 and IMAP4 proxy server"
COMMENT-ldap=	"LDAP backend for perdition mail proxy"
COMMENT-mysql=  "MySQL backend for perdition mail proxy"
COMMENT-pgsql=	"PostgreSQL backend for perdition mail proxy"
@


1.2
log
@convert to new MULTI_PACKAGES

ok bernd@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2006/11/16 23:26:00 msf Exp $
d10 1
a10 1
PKGNAME-main=	${DISTNAME}p0
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d3 1
a3 1
COMMENT=	"fully featured POP3 and IMAP4 proxy server"
d10 1
d49 1
a49 1
NO_REGRESS=	Yes
d51 1
a51 2
MULTI_PACKAGES= 
SUBPACKAGE?=
a52 1
PSEUDO_FLAVORS=	no_bdb no_ldap no_mysql no_pgsql
d54 8
a61 8
.if !defined(PACKAGING) || ${SUBPACKAGE} == ""
WANTLIB+=       c crypto ssl util
LIB_DEPENDS+=	db.>=4.2::databases/db/v4 \
		vanessa_adt.>=0.3::devel/vanessa/adt \
		vanessa_logger.>=0.3::devel/vanessa/logger \
		vanessa_socket.>=0.3::devel/vanessa/socket \
		popt.>=0::devel/popt
.endif
d66 1
a66 1
SHARED_LIBS +=  perditiondb_ldap             0.0  # .0.0
d71 1
a71 2
.  if !defined(PACKAGING) || ${SUBPACKAGE} == "-ldap"
LIB_DEPENDS+=		sasl2::security/cyrus-sasl2 \
d73 1
a73 2
WANTLIB += 		asn1 com_err crypto gssapi krb5 ssl util
.  endif
d79 1
a79 1
SHARED_LIBS +=  perditiondb_mysql            0.0  # .0.0
d83 2
a84 5
.  if !defined(PACKAGING) || ${SUBPACKAGE} == "-mysql"
LIB_DEPENDS+=		lib/mysql/mysqlclient.>=10::databases/mysql
WANTLIB+=		crypto ssl util m z 
.    if defined(PACKAGING)
LIB_DEPENDS+=		vanessa_adt.>=0.3::devel/vanessa/adt \
d86 1
a86 2
.    endif
.  endif
d92 1
a92 1
SHARED_LIBS +=  perditiondb_postgresql       0.0  # .0.0
d95 2
a96 5
.  if !defined(PACKAGING) || ${SUBPACKAGE} == "-pgsql"
LIB_DEPENDS+=		pq.>=2:postgresql-client-*:databases/postgresql
WANTLIB+=		crypto ssl util
.    if defined(PACKAGING)
LIB_DEPENDS+=		vanessa_adt.>=0.3::devel/vanessa/adt \
d98 1
a98 2
.    endif
.  endif
@


1.1.1.1
log
@initial import of perdition 1.17

Perdition is a fully featured POP3 and IMAP4 proxy server. It is able to
handle both SSL and non-SSL connections and redirect users to a real-server
based on a database lookup. Perdition supports modular based database access.
ODBC, MySQL, PostgreSQL, GDBM, POSIX Regular Expression and NIS modules ship
with the distribution. The API for modules is open allowing arbitrary modules
to be written to allow access to any data store.

Perdition has many uses. Including, creating large mail systems where an
end-user's mailbox may be stored on one of several hosts, integrating
different mail systems together, migrating between different email
infrastructures, and bridging plain-text, SSL and TLS services. It can also
be used as part of a firewall.

based off initial work from dlg@@

ok sturm@@ bernd@@
@
text
@@
