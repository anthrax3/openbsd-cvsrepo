head	1.2;
access;
symbols
	OPENBSD_4_9:1.1.0.4
	OPENBSD_4_9_BASE:1.1
	OPENBSD_4_8:1.1.0.2
	OPENBSD_4_8_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2011.05.09.09.30.26;	author giovanni;	state dead;
branches;
next	1.1;

1.1
date	2010.07.08.16.29.58;	author giovanni;	state Exp;
branches;
next	;


desc
@@


1.2
log
@
Update to 4.9.1, utf-8 support completely rewritten and some bug fixes.
@
text
@$OpenBSD: patch-rfc822_rfc822_c,v 1.1 2010/07/08 16:29:58 giovanni Exp $
--- rfc822/rfc822.c.orig	Sun Nov 22 22:22:24 2009
+++ rfc822/rfc822.c	Tue Jun 29 13:19:53 2010
@@@@ -627,10 +627,12 @@@@ static int rfc822_print_common_nameaddr(const struct r
 	p=(*decode_func)(addrbuf, chset, 1);
 	free(addrbuf);
 
+	if (!p)
+		return -1;
+
 	if (print_braces)
 		(*print_func)(' ', ptr);
 
-
 	for (q=p; *q; ++q)
 		if (*q != '.' && *q != '@@' && strchr(RFC822_SPECIALS, *q))
 		{
@@@@ -640,9 +642,6 @@@@ static int rfc822_print_common_nameaddr(const struct r
 
 	if (print_braces)
 		(*print_func)('<', ptr);
-
-	if (!p)
-		return -1;
 
 	for (addrbuf=p; *p; p++)
 		(*print_func)(*p, ptr);
@


1.1
log
@
Update to 4.8.0 plus a patch from upstream to prevent a segfault
@
text
@d1 1
a1 1
$OpenBSD$
@

