head	1.5;
access;
symbols
	OPENBSD_6_2:1.5.0.6
	OPENBSD_6_2_BASE:1.5
	OPENBSD_6_1:1.5.0.4
	OPENBSD_6_1_BASE:1.5
	OPENBSD_6_0:1.5.0.2
	OPENBSD_6_0_BASE:1.5
	OPENBSD_5_9:1.4.0.4
	OPENBSD_5_9_BASE:1.4
	OPENBSD_5_8:1.4.0.6
	OPENBSD_5_8_BASE:1.4
	OPENBSD_5_7:1.4.0.2
	OPENBSD_5_7_BASE:1.4
	OPENBSD_5_6:1.3.0.2
	OPENBSD_5_6_BASE:1.3
	OPENBSD_5_5:1.2.0.2
	OPENBSD_5_5_BASE:1.2;
locks; strict;
comment	@# @;


1.5
date	2016.04.18.07.15.14;	author ajacoutot;	state Exp;
branches;
next	1.4;
commitid	Gdjl3aglRoNMjWVU;

1.4
date	2014.09.16.23.41.41;	author jturner;	state Exp;
branches;
next	1.3;
commitid	MEXr8eptv7wCpCy3;

1.3
date	2014.05.15.01.29.52;	author jturner;	state Exp;
branches;
next	1.2;

1.2
date	2013.08.25.02.06.26;	author jturner;	state Exp;
branches;
next	1.1;

1.1
date	2013.08.06.23.20.37;	author jturner;	state Exp;
branches;
next	;


desc
@@


1.5
log
@Unbreak with glib2 >=2.48.0.
@
text
@$OpenBSD: patch-src_bindings_cc,v 1.4 2014/09/16 23:41:41 jturner Exp $

Unbreak with glib2 >=2.48.0

--- src/bindings.cc.orig	Tue Sep 16 19:29:01 2014
+++ src/bindings.cc	Mon Apr 18 09:10:24 2016
@@@@ -19,7 +19,7 @@@@
 
 
 #include <algorithm>
-#include <cursesw.h>
+#include <curses.h>
 #include <fstream>
 #include <iostream>
 #include <map>
@@@@ -724,9 +724,9 @@@@ int show_help(lua_State * L)
      */
     if (str == NULL)
     {
-        if ( CFile::exists( "/usr/share/lumail/lumail.help" ))
+        if ( CFile::exists( "${LOCALBASE}/share/lumail/lumail.help" ))
         {
-            lua_pushstring(L, "/usr/share/lumail/lumail.help"  );
+            lua_pushstring(L, "${LOCALBASE}/share/lumail/lumail.help"  );
             show_file_contents( L );
             CLua::Instance()->execute( "global_mode( \"text\" )" );
             return 0;
@@@@ -784,19 +784,14 @@@@ int sleep(lua_State *L )
     return 0;
 }
 
-
 /**
  * Stuff input into the input-buffer.
  */
 int stuff(lua_State * L)
 {
-    UTFString str = NULL;
+    const char *str = lua_tostring(L, -1);
 
-    if (lua_isstring(L, -1))
-        str = lua_tostring(L, 1);
-
-
-    if ((str == NULL) || (str.empty()) )
+    if (str == NULL)
         return luaL_error(L, "Missing argument to stuff(..)");
 
     CInput::Instance()->add( UTFString( str ) );
@


1.4
log
@Update lumail to 0.26
@
text
@d1 1
a1 1
$OpenBSD: patch-src_bindings_cc,v 1.3 2014/05/15 01:29:52 jturner Exp $
d3 1
a3 1
Check ${LOCALBASE} for help file.
d5 2
a6 2
--- src/bindings.cc.orig	Tue Sep 16 13:29:01 2014
+++ src/bindings.cc	Tue Sep 16 18:45:20 2014
d28 22
@


1.3
log
@Update lumail to 0.25.

Primarily a bug fix release. Change log can be found on github:
https://github.com/skx/lumail/commit/c595413e38c61e825425908505aa3a16405dbd18
@
text
@d1 1
a1 1
$OpenBSD: patch-src_bindings_cc,v 1.2 2013/08/25 02:06:26 jturner Exp $
d5 2
a6 2
--- src/bindings.cc.orig	Wed May 14 04:01:18 2014
+++ src/bindings.cc	Wed May 14 21:21:29 2014
d16 1
a16 1
@@@@ -719,9 +719,9 @@@@ int show_help(lua_State * L)
@


1.2
log
@Update lumail to 0.20 with new glib2mm depend.
@
text
@d1 6
a6 3
$OpenBSD: patch-src_bindings_cc,v 1.1 2013/08/06 23:20:37 jturner Exp $
--- src/bindings.cc.orig	Sat Aug 24 09:28:27 2013
+++ src/bindings.cc	Sat Aug 24 21:30:50 2013
d16 12
@


1.1
log
@Update lumail to 0.16.

Upstream removed tests and switched to ncursesw.
@
text
@d1 7
a7 7
$OpenBSD$
--- src/bindings.cc.orig	Sun Aug  4 18:12:57 2013
+++ src/bindings.cc	Sun Aug  4 18:13:03 2013
@@@@ -27,7 +27,7 @@@@
 #include <string.h>
 #include <stdlib.h>
 #include <pcrecpp.h>
d10 3
a12 3
 #include <unistd.h>
 #include <dirent.h>
 
@

