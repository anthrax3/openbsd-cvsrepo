head	1.2;
access;
symbols
	OPENBSD_3_3:1.1.1.1.0.20
	OPENBSD_3_3_BASE:1.1.1.1
	OPENBSD_3_2:1.1.1.1.0.18
	OPENBSD_3_2_BASE:1.1.1.1
	OPENBSD_3_1:1.1.1.1.0.16
	OPENBSD_3_1_BASE:1.1.1.1
	OPENBSD_3_0:1.1.1.1.0.14
	OPENBSD_3_0_BASE:1.1.1.1
	OPENBSD_2_9_TRACKING_SWITCH:1.1.1.1
	OPENBSD_2_9:1.1.1.1.0.12
	OPENBSD_2_9_BASE:1.1.1.1
	OPENBSD_2_8:1.1.1.1.0.10
	OPENBSD_2_8_BASE:1.1.1.1
	OPENBSD_2_7:1.1.1.1.0.8
	OPENBSD_2_7_BASE:1.1.1.1
	OPENBSD_2_6:1.1.1.1.0.6
	OPENBSD_2_6_BASE:1.1.1.1
	OPENBSD_2_5:1.1.1.1.0.4
	OPENBSD_2_5_BASE:1.1.1.1
	OPENBSD_2_4:1.1.1.1.0.2
	OPENBSD_2_4_BASE:1.1.1.1
	marc_1998-apr-30:1.1.1.1
	marc:1.1.1;
locks; strict;
comment	@# @;


1.2
date	2003.07.16.21.46.41;	author naddy;	state dead;
branches;
next	1.1;

1.1
date	98.04.30.23.51.57;	author marc;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	98.04.30.23.51.57;	author marc;	state Exp;
branches;
next	;


desc
@@


1.2
log
@remove mail/mh, which has been marked BROKEN and superseded by nmh for
more than three years
@
text
@*** uip/rcvtty.c.orig	Wed Feb 11 21:23:50 1998
--- uip/rcvtty.c	Wed Feb 11 22:18:18 1998
***************
*** 158,164 ****
  
      user = getusr ();
  #ifndef	TTYD
!     if ((uf = fopen ("/etc/utmp", "r")) == NULL)
  	exit (RCV_MBX);
      while (fread ((char *) &ut, sizeof ut, 1, uf) == 1)
  	if (ut.ut_name[0] != 0
--- 158,164 ----
  
      user = getusr ();
  #ifndef	TTYD
!     if ((uf = fopen (_PATH_UTMP, "r")) == NULL)
  	exit (RCV_MBX);
      while (fread ((char *) &ut, sizeof ut, 1, uf) == 1)
  	if (ut.ut_name[0] != 0
***************
*** 194,206 ****
      char    tmpfil[BUFSIZ];
      struct stat st;
  
!     (void) unlink (mktemp (strcpy (tmpfil, "/tmp/rcvttyXXXXX")));
      if ((fd = creat (tmpfil, 0600)) == NOTOK)
  	return header_fd ();
      (void) close (fd);
  
      if ((fd = open (tmpfil, 2)) == NOTOK)
  	return header_fd ();
      (void) unlink (tmpfil);
  
  /*  */
--- 194,208 ----
      char    tmpfil[BUFSIZ];
      struct stat st;
  
!     fd = mkstemp (strcpy (tmpfil, "/tmp/rcvttyXXXXX"));
! #if 0
      if ((fd = creat (tmpfil, 0600)) == NOTOK)
  	return header_fd ();
      (void) close (fd);
  
      if ((fd = open (tmpfil, 2)) == NOTOK)
  	return header_fd ();
+ #endif
      (void) unlink (tmpfil);
  
  /*  */
***************
*** 258,267 ****
      char    tmpfil[BUFSIZ];
  
      (void) strcpy (tmpfil, m_tmpfil (invo_name));
      if ((fd = creat (tmpfil, 0600)) == NOTOK)
  	return NOTOK;
      (void) close (fd);
! 
      if ((fd = open (tmpfil, 2)) == NOTOK)
  	return NOTOK;
      (void) unlink (tmpfil);
--- 260,270 ----
      char    tmpfil[BUFSIZ];
  
      (void) strcpy (tmpfil, m_tmpfil (invo_name));
+ #if 0
      if ((fd = creat (tmpfil, 0600)) == NOTOK)
  	return NOTOK;
      (void) close (fd);
! #endif
      if ((fd = open (tmpfil, 2)) == NOTOK)
  	return NOTOK;
      (void) unlink (tmpfil);
@


1.1
log
@Initial revision
@
text
@@


1.1.1.1
log
@mh port from "Angelos D. Keromytis" <angelos@@cvs.openbsd.org> with
minor tweaks by me.
@
text
@@
