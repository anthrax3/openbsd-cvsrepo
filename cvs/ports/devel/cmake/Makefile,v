head	1.159;
access;
symbols
	OPENBSD_6_1:1.154.0.2
	OPENBSD_6_1_BASE:1.154
	OPENBSD_6_0:1.145.0.2
	OPENBSD_6_0_BASE:1.145
	OPENBSD_5_9:1.142.0.2
	OPENBSD_5_9_BASE:1.142
	OPENBSD_5_8:1.131.0.4
	OPENBSD_5_8_BASE:1.131
	OPENBSD_5_7:1.123.0.2
	OPENBSD_5_7_BASE:1.123
	OPENBSD_5_6:1.102.0.2
	OPENBSD_5_6_BASE:1.102
	OPENBSD_5_5:1.96.0.2
	OPENBSD_5_5_BASE:1.96
	OPENBSD_5_4:1.86.0.2
	OPENBSD_5_4_BASE:1.86
	OPENBSD_5_3:1.75.0.2
	OPENBSD_5_3_BASE:1.75
	OPENBSD_5_2:1.62.0.2
	OPENBSD_5_2_BASE:1.62
	OPENBSD_5_1_BASE:1.50
	OPENBSD_5_1:1.50.0.2
	OPENBSD_5_0:1.43.0.2
	OPENBSD_5_0_BASE:1.43
	OPENBSD_4_9:1.37.0.2
	OPENBSD_4_9_BASE:1.37
	OPENBSD_4_8:1.24.0.2
	OPENBSD_4_8_BASE:1.24
	OPENBSD_4_7:1.17.0.2
	OPENBSD_4_7_BASE:1.17
	OPENBSD_4_6:1.16.0.2
	OPENBSD_4_6_BASE:1.16
	OPENBSD_4_5:1.15.0.6
	OPENBSD_4_5_BASE:1.15
	OPENBSD_4_4:1.15.0.4
	OPENBSD_4_4_BASE:1.15
	OPENBSD_4_3:1.15.0.2
	OPENBSD_4_3_BASE:1.15
	OPENBSD_4_2:1.12.0.2
	OPENBSD_4_2_BASE:1.12
	OPENBSD_4_1:1.4.0.2
	OPENBSD_4_1_BASE:1.4
	OPENBSD_4_0:1.2.0.2
	OPENBSD_4_0_BASE:1.2
	kde:1.1.1.1
	espie:1.1.1;
locks; strict;
comment	@# @;


1.159
date	2017.07.10.23.05.54;	author zhuk;	state Exp;
branches;
next	1.158;
commitid	HXIb1SJ1e1YG2zL2;

1.158
date	2017.07.04.20.07.51;	author dcoppa;	state Exp;
branches;
next	1.157;
commitid	gUgowqqwtK0VH8O0;

1.157
date	2017.07.04.16.38.53;	author dcoppa;	state Exp;
branches;
next	1.156;
commitid	Oz05wUWda9N0KZ9U;

1.156
date	2017.04.21.18.37.43;	author kurt;	state Exp;
branches;
next	1.155;
commitid	HEXF3QaCTdQpnj0F;

1.155
date	2017.04.10.11.45.25;	author sthen;	state Exp;
branches;
next	1.154;
commitid	XDh1zlSBq0boKsHk;

1.154
date	2017.01.16.08.51.50;	author dcoppa;	state Exp;
branches;
next	1.153;
commitid	osvXM2EreXC5IYS6;

1.153
date	2016.12.01.09.38.54;	author dcoppa;	state Exp;
branches;
next	1.152;
commitid	wuyftDXhbLpDV36v;

1.152
date	2016.11.28.09.15.13;	author dcoppa;	state Exp;
branches;
next	1.151;
commitid	jOocuc05F30hpQ6W;

1.151
date	2016.11.04.09.34.22;	author dcoppa;	state Exp;
branches;
next	1.150;
commitid	e8QehGihwlVuz0Lv;

1.150
date	2016.09.08.07.53.32;	author dcoppa;	state Exp;
branches;
next	1.149;
commitid	8riHCw1G1M4qd6gy;

1.149
date	2016.09.06.08.43.54;	author dcoppa;	state Exp;
branches;
next	1.148;
commitid	J21iimDWw0LsOp86;

1.148
date	2016.08.13.15.01.13;	author dcoppa;	state Exp;
branches;
next	1.147;
commitid	VT7T7iy2tqPuzrjc;

1.147
date	2016.08.12.14.23.02;	author dcoppa;	state Exp;
branches;
next	1.146;
commitid	a57LF8Y6HJFBqtPN;

1.146
date	2016.08.08.07.44.48;	author dcoppa;	state Exp;
branches;
next	1.145;
commitid	r4e0Be8ugQYraWeW;

1.145
date	2016.04.29.10.34.33;	author dcoppa;	state Exp;
branches;
next	1.144;
commitid	z7Jo8sWkfT7EmMLb;

1.144
date	2016.04.19.19.48.28;	author dcoppa;	state Exp;
branches;
next	1.143;
commitid	g3SGIwIdD1je3GeH;

1.143
date	2016.04.15.08.53.49;	author shadchin;	state Exp;
branches;
next	1.142;
commitid	DdvlmL5VDlYoSZZS;

1.142
date	2016.02.19.01.19.51;	author jsg;	state Exp;
branches;
next	1.141;
commitid	OENJZvX6in9kQz7s;

1.141
date	2016.01.28.11.28.02;	author dcoppa;	state Exp;
branches;
next	1.140;
commitid	qHeUHp3ecmYfPHxV;

1.140
date	2016.01.28.09.22.31;	author dcoppa;	state Exp;
branches;
next	1.139;
commitid	k9xRkOXHHvMctof8;

1.139
date	2016.01.26.08.44.07;	author dcoppa;	state Exp;
branches;
next	1.138;
commitid	rfF2Gku3i53ro4vR;

1.138
date	2016.01.20.09.39.46;	author dcoppa;	state Exp;
branches;
next	1.137;
commitid	rW4serAvcchcv0Fd;

1.137
date	2015.12.29.14.44.34;	author jsg;	state Exp;
branches;
next	1.136;
commitid	SX3vHXX6LT690FMr;

1.136
date	2015.12.18.17.20.40;	author dcoppa;	state Exp;
branches;
next	1.135;
commitid	xOdq4H94EC1a6q4Z;

1.135
date	2015.12.09.11.34.50;	author dcoppa;	state Exp;
branches;
next	1.134;
commitid	N3aAHAkTAjpDuveI;

1.134
date	2015.12.08.17.18.59;	author dcoppa;	state Exp;
branches;
next	1.133;
commitid	AX6ONjs8OJ4jyAD6;

1.133
date	2015.09.18.09.18.56;	author dcoppa;	state Exp;
branches;
next	1.132;
commitid	FIOwYrNDE1GMK5Yu;

1.132
date	2015.09.03.07.09.25;	author dcoppa;	state Exp;
branches;
next	1.131;
commitid	KGLL6yBcZn2xZciC;

1.131
date	2015.08.03.06.11.50;	author dcoppa;	state Exp;
branches;
next	1.130;
commitid	IPdcXaPHDgspR8Ca;

1.130
date	2015.08.01.11.48.16;	author dcoppa;	state Exp;
branches;
next	1.129;
commitid	qBlsFmLudvSwtJhc;

1.129
date	2015.07.01.08.08.18;	author dcoppa;	state Exp;
branches;
next	1.128;
commitid	GKV9CXiY9JAIriRI;

1.128
date	2015.06.24.06.39.03;	author dcoppa;	state Exp;
branches;
next	1.127;
commitid	lTyLqWBmal97eHrV;

1.127
date	2015.06.03.08.25.30;	author dcoppa;	state Exp;
branches;
next	1.126;
commitid	u6rlhnzykSkEH2fC;

1.126
date	2015.04.23.09.19.44;	author dcoppa;	state Exp;
branches;
next	1.125;
commitid	FLEY1YvPtCOXOAgO;

1.125
date	2015.04.21.18.33.48;	author sthen;	state Exp;
branches;
next	1.124;
commitid	rFzrQpbY9B2q3eUy;

1.124
date	2015.03.26.07.10.02;	author dcoppa;	state Exp;
branches;
next	1.123;
commitid	RC163bs6emik8Gf9;

1.123
date	2015.02.13.14.17.36;	author dcoppa;	state Exp;
branches;
next	1.122;
commitid	iwfjOyEMolXZaxIL;

1.122
date	2015.02.06.08.09.42;	author dcoppa;	state Exp;
branches;
next	1.121;
commitid	1IBmTZsHlo0lfDHY;

1.121
date	2015.01.23.18.01.09;	author dcoppa;	state Exp;
branches;
next	1.120;
commitid	AasrIjjpfxr6UqVY;

1.120
date	2015.01.20.11.41.32;	author dcoppa;	state Exp;
branches;
next	1.119;
commitid	dOH6y5sUpeBAsMFC;

1.119
date	2015.01.13.08.22.48;	author dcoppa;	state Exp;
branches;
next	1.118;
commitid	BxokaRxycfspBSAJ;

1.118
date	2015.01.08.16.58.00;	author dcoppa;	state Exp;
branches;
next	1.117;
commitid	JvDdNJH4ENeN1MeG;

1.117
date	2014.12.31.11.06.02;	author dcoppa;	state Exp;
branches;
next	1.116;
commitid	q283NDlM4qiVneVU;

1.116
date	2014.11.04.13.50.24;	author dcoppa;	state Exp;
branches;
next	1.115;
commitid	YszMQUykV3aR0MRf;

1.115
date	2014.10.07.11.12.23;	author dcoppa;	state Exp;
branches;
next	1.114;
commitid	9DDbd0n1bntl2dGy;

1.114
date	2014.10.03.10.11.45;	author dcoppa;	state Exp;
branches;
next	1.113;
commitid	2kN0tj2KqHFNY4hg;

1.113
date	2014.10.02.09.40.16;	author zhuk;	state Exp;
branches;
next	1.112;
commitid	njKyjVzutDieVgXw;

1.112
date	2014.10.01.08.42.32;	author dcoppa;	state Exp;
branches;
next	1.111;
commitid	mHpGk6g0wcp4upsl;

1.111
date	2014.09.30.15.02.32;	author dcoppa;	state Exp;
branches;
next	1.110;
commitid	fhduiNtLwEOexuC7;

1.110
date	2014.09.30.14.24.31;	author dcoppa;	state Exp;
branches;
next	1.109;
commitid	UNvE6uRiD96fproi;

1.109
date	2014.09.29.08.45.35;	author dcoppa;	state Exp;
branches;
next	1.108;
commitid	kcvCJaFLgS6fbd4g;

1.108
date	2014.09.29.08.25.39;	author dcoppa;	state Exp;
branches;
next	1.107;
commitid	Rs6vJ0tO5v5EhITe;

1.107
date	2014.09.28.18.15.40;	author dcoppa;	state Exp;
branches;
next	1.106;
commitid	8bywDz0GHNyYARwx;

1.106
date	2014.09.28.17.06.24;	author dcoppa;	state Exp;
branches;
next	1.105;
commitid	aZjacCdYQd9Q1teY;

1.105
date	2014.09.17.11.57.17;	author sthen;	state Exp;
branches;
next	1.104;
commitid	Js0iIuyp6NcrVBBu;

1.104
date	2014.09.12.08.36.12;	author dcoppa;	state Exp;
branches;
next	1.103;
commitid	lN5EaWqGfTyCDbtq;

1.103
date	2014.09.11.10.24.38;	author dcoppa;	state Exp;
branches;
next	1.102;
commitid	m0ESeGbhnaGm45G1;

1.102
date	2014.06.25.00.29.45;	author zhuk;	state Exp;
branches;
next	1.101;
commitid	DF3OsXZrygjkn6rh;

1.101
date	2014.05.13.05.55.30;	author dcoppa;	state Exp;
branches;
next	1.100;

1.100
date	2014.05.12.14.47.49;	author dcoppa;	state Exp;
branches;
next	1.99;

1.99
date	2014.05.07.15.42.15;	author kurt;	state Exp;
branches;
next	1.98;

1.98
date	2014.04.14.14.02.44;	author dcoppa;	state Exp;
branches;
next	1.97;

1.97
date	2014.03.12.08.32.13;	author dcoppa;	state Exp;
branches;
next	1.96;

1.96
date	2014.01.15.19.54.37;	author dcoppa;	state Exp;
branches;
next	1.95;

1.95
date	2014.01.10.08.21.12;	author dcoppa;	state Exp;
branches;
next	1.94;

1.94
date	2013.11.25.14.16.22;	author sthen;	state Exp;
branches;
next	1.93;

1.93
date	2013.11.11.07.23.32;	author dcoppa;	state Exp;
branches;
next	1.92;

1.92
date	2013.10.14.12.58.02;	author dcoppa;	state Exp;
branches;
next	1.91;

1.91
date	2013.09.30.11.18.09;	author dcoppa;	state Exp;
branches;
next	1.90;

1.90
date	2013.08.22.09.53.20;	author dcoppa;	state Exp;
branches;
next	1.89;

1.89
date	2013.08.20.14.22.58;	author dcoppa;	state Exp;
branches;
next	1.88;

1.88
date	2013.08.16.10.37.22;	author dcoppa;	state Exp;
branches;
next	1.87;

1.87
date	2013.08.12.16.09.50;	author zhuk;	state Exp;
branches;
next	1.86;

1.86
date	2013.07.04.16.34.05;	author dcoppa;	state Exp;
branches;
next	1.85;

1.85
date	2013.06.28.14.58.23;	author dcoppa;	state Exp;
branches;
next	1.84;

1.84
date	2013.06.25.07.16.46;	author dcoppa;	state Exp;
branches;
next	1.83;

1.83
date	2013.06.21.11.12.51;	author dcoppa;	state Exp;
branches;
next	1.82;

1.82
date	2013.06.06.12.47.06;	author dcoppa;	state Exp;
branches;
next	1.81;

1.81
date	2013.05.30.08.34.32;	author dcoppa;	state Exp;
branches;
next	1.80;

1.80
date	2013.05.13.15.02.26;	author dcoppa;	state Exp;
branches;
next	1.79;

1.79
date	2013.04.22.13.13.56;	author zhuk;	state Exp;
branches;
next	1.78;

1.78
date	2013.04.12.17.39.57;	author sthen;	state Exp;
branches;
next	1.77;

1.77
date	2013.03.21.10.21.49;	author zhuk;	state Exp;
branches;
next	1.76;

1.76
date	2013.03.11.10.50.02;	author espie;	state Exp;
branches;
next	1.75;

1.75
date	2013.01.18.22.17.06;	author dcoppa;	state Exp;
branches;
next	1.74;

1.74
date	2013.01.02.08.59.59;	author dcoppa;	state Exp;
branches;
next	1.73;

1.73
date	2012.12.11.11.51.39;	author dcoppa;	state Exp;
branches;
next	1.72;

1.72
date	2012.12.06.15.11.07;	author dcoppa;	state Exp;
branches;
next	1.71;

1.71
date	2012.12.05.11.32.04;	author dcoppa;	state Exp;
branches;
next	1.70;

1.70
date	2012.11.26.12.32.29;	author dcoppa;	state Exp;
branches;
next	1.69;

1.69
date	2012.11.22.13.21.49;	author dcoppa;	state Exp;
branches;
next	1.68;

1.68
date	2012.11.15.12.29.07;	author dcoppa;	state Exp;
branches;
next	1.67;

1.67
date	2012.11.15.08.43.25;	author dcoppa;	state Exp;
branches;
next	1.66;

1.66
date	2012.11.11.17.13.31;	author dcoppa;	state Exp;
branches;
next	1.65;

1.65
date	2012.10.08.07.23.09;	author dcoppa;	state Exp;
branches;
next	1.64;

1.64
date	2012.08.31.12.28.31;	author dcoppa;	state Exp;
branches;
next	1.63;

1.63
date	2012.08.20.08.07.34;	author dcoppa;	state Exp;
branches;
next	1.62;

1.62
date	2012.07.12.16.26.13;	author dcoppa;	state Exp;
branches;
next	1.61;

1.61
date	2012.07.12.15.36.20;	author dcoppa;	state Exp;
branches;
next	1.60;

1.60
date	2012.07.10.15.20.24;	author jasper;	state Exp;
branches;
next	1.59;

1.59
date	2012.07.03.07.48.54;	author dcoppa;	state Exp;
branches;
next	1.58;

1.58
date	2012.06.27.19.28.39;	author dcoppa;	state Exp;
branches;
next	1.57;

1.57
date	2012.06.15.10.26.56;	author dcoppa;	state Exp;
branches;
next	1.56;

1.56
date	2012.06.14.09.32.00;	author dcoppa;	state Exp;
branches;
next	1.55;

1.55
date	2012.05.15.08.36.28;	author dcoppa;	state Exp;
branches;
next	1.54;

1.54
date	2012.05.14.19.24.33;	author bentley;	state Exp;
branches;
next	1.53;

1.53
date	2012.05.07.13.58.18;	author dcoppa;	state Exp;
branches;
next	1.52;

1.52
date	2012.05.07.07.06.20;	author dcoppa;	state Exp;
branches;
next	1.51;

1.51
date	2012.03.29.13.38.13;	author sthen;	state Exp;
branches;
next	1.50;

1.50
date	2012.01.12.13.14.33;	author dcoppa;	state Exp;
branches;
next	1.49;

1.49
date	2012.01.07.22.14.51;	author dcoppa;	state Exp;
branches;
next	1.48;

1.48
date	2011.12.05.21.44.02;	author sthen;	state Exp;
branches;
next	1.47;

1.47
date	2011.12.03.13.38.43;	author dcoppa;	state Exp;
branches;
next	1.46;

1.46
date	2011.10.14.17.22.10;	author dcoppa;	state Exp;
branches;
next	1.45;

1.45
date	2011.10.08.18.55.36;	author dcoppa;	state Exp;
branches;
next	1.44;

1.44
date	2011.09.20.11.32.36;	author dcoppa;	state Exp;
branches;
next	1.43;

1.43
date	2011.07.12.08.35.29;	author dcoppa;	state Exp;
branches;
next	1.42;

1.42
date	2011.05.02.15.59.43;	author sthen;	state Exp;
branches;
next	1.41;

1.41
date	2011.04.29.16.50.32;	author sthen;	state Exp;
branches;
next	1.40;

1.40
date	2011.04.16.15.18.13;	author sthen;	state Exp;
branches;
next	1.39;

1.39
date	2011.04.14.15.55.19;	author jasper;	state Exp;
branches;
next	1.38;

1.38
date	2011.03.13.18.23.01;	author dcoppa;	state Exp;
branches;
next	1.37;

1.37
date	2010.11.22.22.27.02;	author dcoppa;	state Exp;
branches;
next	1.36;

1.36
date	2010.11.22.16.26.30;	author dcoppa;	state Exp;
branches;
next	1.35;

1.35
date	2010.11.19.16.18.12;	author dcoppa;	state Exp;
branches;
next	1.34;

1.34
date	2010.11.19.11.10.35;	author dcoppa;	state Exp;
branches;
next	1.33;

1.33
date	2010.11.15.19.45.57;	author espie;	state Exp;
branches;
next	1.32;

1.32
date	2010.11.15.11.39.08;	author dcoppa;	state Exp;
branches;
next	1.31;

1.31
date	2010.10.26.18.31.18;	author dcoppa;	state Exp;
branches;
next	1.30;

1.30
date	2010.10.18.17.47.51;	author espie;	state Exp;
branches;
next	1.29;

1.29
date	2010.09.29.07.33.24;	author dcoppa;	state Exp;
branches;
next	1.28;

1.28
date	2010.09.06.00.16.22;	author sthen;	state Exp;
branches;
next	1.27;

1.27
date	2010.09.02.08.06.13;	author landry;	state Exp;
branches;
next	1.26;

1.26
date	2010.08.25.14.29.56;	author sthen;	state Exp;
branches;
next	1.25;

1.25
date	2010.08.23.18.17.30;	author jasper;	state Exp;
branches;
next	1.24;

1.24
date	2010.07.28.20.34.22;	author dcoppa;	state Exp;
branches;
next	1.23;

1.23
date	2010.07.12.19.19.30;	author dcoppa;	state Exp;
branches;
next	1.22;

1.22
date	2010.06.11.08.07.17;	author dcoppa;	state Exp;
branches;
next	1.21;

1.21
date	2010.05.31.06.29.27;	author dcoppa;	state Exp;
branches;
next	1.20;

1.20
date	2010.05.28.20.21.48;	author dcoppa;	state Exp;
branches;
next	1.19;

1.19
date	2010.04.22.16.10.11;	author dcoppa;	state Exp;
branches;
next	1.18;

1.18
date	2010.04.15.20.30.47;	author dcoppa;	state Exp;
branches;
next	1.17;

1.17
date	2009.09.10.13.54.47;	author landry;	state Exp;
branches;
next	1.16;

1.16
date	2009.03.14.18.59.36;	author ajacoutot;	state Exp;
branches;
next	1.15;

1.15
date	2008.02.04.22.31.20;	author espie;	state Exp;
branches;
next	1.14;

1.14
date	2008.01.26.21.26.32;	author espie;	state Exp;
branches;
next	1.13;

1.13
date	2007.08.25.08.35.20;	author espie;	state Exp;
branches;
next	1.12;

1.12
date	2007.06.18.11.52.26;	author ajacoutot;	state Exp;
branches;
next	1.11;

1.11
date	2007.06.16.13.01.37;	author espie;	state Exp;
branches;
next	1.10;

1.10
date	2007.06.09.09.09.44;	author espie;	state Exp;
branches;
next	1.9;

1.9
date	2007.05.14.20.40.15;	author naddy;	state Exp;
branches;
next	1.8;

1.8
date	2007.04.28.10.10.29;	author bernd;	state Exp;
branches;
next	1.7;

1.7
date	2007.04.25.14.56.13;	author espie;	state Exp;
branches;
next	1.6;

1.6
date	2007.03.26.21.27.44;	author espie;	state Exp;
branches;
next	1.5;

1.5
date	2007.03.23.16.30.35;	author espie;	state Exp;
branches;
next	1.4;

1.4
date	2007.02.17.19.04.24;	author espie;	state Exp;
branches;
next	1.3;

1.3
date	2006.12.18.16.04.31;	author espie;	state Exp;
branches;
next	1.2;

1.2
date	2006.07.31.23.55.51;	author espie;	state Exp;
branches;
next	1.1;

1.1
date	2006.07.20.09.23.13;	author espie;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2006.07.20.09.23.13;	author espie;	state Exp;
branches;
next	;


desc
@@


1.159
log
@Use standard CMake idiom for Foo_INCLUDE_DIR/DIRS and Foo_LIBRARY/LIBRARIES
in FindLibXml2.cmake.

To be used by pgpointcloud port. See also the upstream merge request #1043:
https://gitlab.kitware.com/cmake/cmake/merge_requests/1043

okay dcoppa@@, landry@@
@
text
@# $OpenBSD: Makefile,v 1.158 2017/07/04 20:07:51 dcoppa Exp $

DPB_PROPERTIES =parallel

COMMENT =	portable build system

VER =		3.7.2
DISTNAME =	cmake-${VER}
CATEGORIES =	devel
REVISION =	3

HOMEPAGE =	https://www.cmake.org/

MAINTAINER =	David Coppa <dcoppa@@openbsd.org>

MASTER_SITES =	${HOMEPAGE}files/v${VER:R}/

# BSD
PERMIT_PACKAGE_CDROM =	Yes

WANTLIB += archive c curl expat form jsoncpp m ncurses pthread
WANTLIB += ${LIBCXX} z

# XXX: Ninja is broken on m88k
.if ${MACHINE_ARCH} != "m88k"
BUILD_DEPENDS =		devel/ninja>=1.5.1
.endif

BUILD_DEPENDS +=	textproc/py-sphinx>=1.4

LIB_DEPENDS =		archivers/libarchive \
			devel/jsoncpp \
			net/curl

CONFIGURE_STYLE =	simple
CONFIGURE_ARGS =	--prefix=${PREFIX} \
			--datadir=share/cmake \
			--docdir=share/doc/cmake \
			--mandir=man \
			--no-qt-gui \
			--no-server \
			--parallel=${MAKE_JOBS} \
			--sphinx-build=${LOCALBASE}/bin/sphinx-build \
			--sphinx-html \
			--sphinx-man \
			--system-libs \
			--verbose

.if ${MACHINE_ARCH} == "arm"
CXXFLAGS+=-fno-stack-protector
.endif

CONFIGURE_ENV +=	MAKE=${MAKE_PROGRAM}

PORTHOME =		${WRKDIR}

SEPARATE_BUILD =	Yes

TEST_TARGET =		test

MAKE_FLAGS +=		VERBOSE=1

pre-configure:
	cp ${FILESDIR}/*.cmake ${WRKSRC}/Modules/
	${SUBST_CMD} ${WRKSRC}/Modules/CMakeDetermineJavaCompiler.cmake \
		${WRKSRC}/Modules/FindJNI.cmake \
		${WRKSRC}/Modules/FindJava.cmake \
		${WRKSRC}/Modules/FindMPEG.cmake \
		${WRKSRC}/Modules/FindMPEG2.cmake \
		${WRKSRC}/Modules/FindQt.cmake \
		${WRKSRC}/Modules/FindQt4.cmake \
		${WRKSRC}/Modules/FindSDL.cmake \
		${WRKSRC}/Modules/FindTCL.cmake

# XXX: Ninja is broken on m88k
.if ${MACHINE_ARCH} != "m88k"
do-build:
	cd ${WRKBUILD} && exec ${SETENV} ${MAKE_ENV} ninja -v -j \
		${MAKE_JOBS} ${ALL_TARGET}

do-install:
	cd ${WRKBUILD} && exec ${SETENV} ${MAKE_ENV} \
		${FAKE_SETUP} ninja -v -j ${MAKE_JOBS} ${FAKE_TARGET}

do-test:
	cd ${WRKBUILD} && exec ${SETENV} ${ALL_TEST_ENV} ninja -v -j \
		${MAKE_JOBS} ${TEST_FLAGS} ${TEST_TARGET}
.endif

post-install:
	rm ${WRKINST}${LOCALBASE}/share/cmake/Modules/*.{beforesubst,orig} \
		${WRKINST}${LOCALBASE}/share/cmake/Modules/Compiler/*.orig \
		${WRKINST}${LOCALBASE}/share/cmake/Modules/Platform/*.orig

.include <bsd.port.mk>
@


1.158
log
@
Revert previous
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.157 2017/07/04 16:38:53 dcoppa Exp $
d10 1
a10 1
REVISION =	2
@


1.157
log
@
include/libxml2/libxml/encoding.h wants iconv.h, so teach
FindLibXml2.cmake how to find the libiconv include directory.

Problem spotted by landry@@ while porting geo/pgpointcloud
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.156 2017/04/21 18:37:43 kurt Exp $
d10 1
a10 1
REVISION =	1
@


1.156
log
@Update for devel/jdk/1.7 removal. okay dcoppa@@ sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.155 2017/04/10 11:45:25 sthen Exp $
d10 1
a10 1
REVISION =	0
@


1.155
log
@use LIBCXX
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.154 2017/01/16 08:51:50 dcoppa Exp $
d10 1
@


1.154
log
@
Update to cmake-3.7.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.153 2016/12/01 09:38:54 dcoppa Exp $
d21 1
a21 1
WANTLIB += stdc++ z
@


1.153
log
@
Bugfixing update to cmake-3.7.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.152 2016/11/28 09:15:13 dcoppa Exp $
d7 1
a7 1
VER =		3.7.1
@


1.152
log
@
Update to CMake-3.7.0

Thanks to naddy@@ who ran a bulk build with it
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.151 2016/11/04 09:34:22 dcoppa Exp $
d7 1
a7 1
VER =		3.7.0
@


1.151
log
@
maintenance update to cmake-3.6.3
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.150 2016/09/08 07:53:32 dcoppa Exp $
d7 1
a7 1
VER =		3.6.3
d11 1
a11 1
HOMEPAGE =	http://www.cmake.org/
d20 2
a21 1
WANTLIB += archive c curl expat form jsoncpp m ncurses pthread stdc++ z
d40 1
@


1.150
log
@
Maintenance update to cmake-3.6.2.
Nothing worth of interest for us.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.149 2016/09/06 08:43:54 dcoppa Exp $
d7 1
a7 1
VER =		3.6.2
@


1.149
log
@
Hack cmake so that if webkit is in the list of shared libraries
that are passed to the linker, automatically add '-Wl,-z,wxneeded'
to the linker flags.
Works for libQt5WebKit, libQtWebKit, libwebkit2gtk, libwebkitgtk.

Requested by, and ok, ajacoutot@@
Also ok landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.148 2016/08/13 15:01:13 dcoppa Exp $
d7 1
a7 1
VER =		3.6.1
a8 1
REVISION =	2
@


1.148
log
@
Revert previous, it was causing breakage to some ports.
spotted by naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.147 2016/08/12 14:23:02 dcoppa Exp $
d9 1
a9 1
REVISION =	1
@


1.147
log
@
FindPkgConfig: call find_library() for every library returned by
the .pc file, so that at the end a list of full paths to the libraries
is returned.
This makes the pkg_check_modules() behaviour consistent with the
normal CMake convention, where use of link_directories() is discouraged
in favour of using absolute paths to system libraries.

Patch by Sam Thursfield <sam.thursfield@@codethink.co.uk>
https://cmake.org/Bug/view.php?id=15804
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.146 2016/08/08 07:44:48 dcoppa Exp $
d9 1
a9 1
REVISION =	0
@


1.146
log
@
Update to CMake-3.6.1.

Tested in a bulk build by naddy@@: the one and only fallout has been
fixed.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.145 2016/04/29 10:34:33 dcoppa Exp $
d9 1
@


1.145
log
@
Update to CMake-3.5.2

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.144 2016/04/19 19:48:28 dcoppa Exp $
d7 1
a7 1
VER =		3.5.2
@


1.144
log
@
sync
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.143 2016/04/15 08:53:49 shadchin Exp $
d7 1
a7 1
VER =		3.4.3
a8 1
REVISION =	2
d15 1
a15 2
MASTER_SITES =	${HOMEPAGE}files/v3.5/ \
		${HOMEPAGE}files/v${VER:R}/
@


1.143
log
@Unbreak after py-sphinx update to 1.4
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.142 2016/02/19 01:19:51 jsg Exp $
d16 2
a17 1
MASTER_SITES =	${HOMEPAGE}files/v${VER:R}/
d29 1
a29 1
BUILD_DEPENDS +=	textproc/py-sphinx>=1.1.3p1
@


1.142
log
@Switch arm back to using base gcc for cmake.  This requires disabling
the stack protector so the bootstrap won't hit toolchain bugs.

ok dcoppa@@ sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.141 2016/01/28 11:28:02 dcoppa Exp $
d9 1
a9 1
REVISION =	1
@


1.141
log
@
Do not handle jsoncpp in a special way, treat it like all the other
external libraries

$ diff -u objdump-pre.out objdump-post.out | grep libjsoncpp
-  NEEDED      /usr/local/lib/libjsoncpp.so.0.0
+  NEEDED      libjsoncpp.so.0.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.140 2016/01/28 09:22:31 dcoppa Exp $
d9 1
a9 1
REVISION =	0
a22 6
# XXX: On arm libstdc++ from base (and especially iostream) seems
# to be broken, so use g++ from ports.
MODULES =		gcc4
MODGCC4_ARCHS =		arm
MODGCC4_LANGS =		c++

d46 4
@


1.140
log
@
Use g++-4.9 from ports to build cmake on arm

OK jsg@@, sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.139 2016/01/26 08:44:07 dcoppa Exp $
d9 1
@


1.139
log
@
Update to cmake-3.4.3.
Windows10-related fixes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.138 2016/01/20 09:39:46 dcoppa Exp $
a4 6
# avoid segfaults from binaries compiled and then used during the build
.if ${MACHINE_ARCH} == "arm"
CFLAGS +=	-O1 -fno-stack-protector
CXXFLAGS +=	-O1 -fno-stack-protector
.endif

d22 6
a27 1
# XXX: CMake's built-in ELF parser is broken on arm
d29 1
a29 1
.if ${MACHINE_ARCH} != "arm" && ${MACHINE_ARCH} != "m88k"
a73 1
# XXX: CMake's built-in ELF parser is broken on arm
d75 1
a75 1
.if ${MACHINE_ARCH} != "arm" && ${MACHINE_ARCH} != "m88k"
@


1.138
log
@
Maintenance update to cmake-3.4.2.
Nothing interesting for us...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.137 2015/12/29 14:44:34 jsg Exp $
d13 1
a13 1
VER =		3.4.2
@


1.137
log
@set CXXFLAGS in addition to CFLAGS for an arm specific workaround here as well
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.136 2015/12/18 17:20:40 dcoppa Exp $
d13 1
a13 1
VER =		3.4.1
a14 1
REVISION =	0
@


1.136
log
@
Fix pasto:

size_t last = env_vers.find_first_of(".");

should have been

size_t last = env_vers.find_last_of(".");

Spotted by zhuk@@
Gave him my ok for the diff, but he probably forgot to commit it
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.135 2015/12/09 11:34:50 dcoppa Exp $
d8 1
@


1.135
log
@
... And CMake-3.4.1 (bugfixing update)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.134 2015/12/08 17:18:59 dcoppa Exp $
d14 1
@


1.134
log
@
Update to cmake-3.4.0

tested in a bulk build by naddy@@
kde4-related failures proactively fixed by zhuk@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.133 2015/09/18 09:18:56 dcoppa Exp $
d12 1
a12 1
VER =		3.4.0
@


1.133
log
@
Bugfixing update to cmake-3.3.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.132 2015/09/03 07:09:25 dcoppa Exp $
d12 1
a12 1
VER =		3.3.2
@


1.132
log
@
Update to CMake-3.3.1

No fallout in a bulk build
OK ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.131 2015/08/03 06:11:50 dcoppa Exp $
d12 1
a12 1
VER =		3.3.1
@


1.131
log
@
second attempt
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.130 2015/08/01 11:48:16 dcoppa Exp $
d12 1
a12 1
VER =		3.2.3
a13 1
REVISION =	1
d20 1
a20 2
MASTER_SITES =	${HOMEPAGE}files/v3.3/ \
		${HOMEPAGE}files/v${VER:R}/
@


1.130
log
@
tentative trick to please portroach...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.129 2015/07/01 08:08:18 dcoppa Exp $
d21 2
a22 2
MASTER_SITES =	${HOMEPAGE}files/v${VER:R}/ \
		${HOMEPAGE}files/v3.3/
@


1.129
log
@
Prompted by a mail from "EdaSky"
(http://marc.info/?l=openbsd-misc&m=143552406830762):

automagically add pthread to Boost_LIBRARIES and '-pthread' to
compiler flags if the boost_thread component is requested.

Fix boost_thread's "Compiler threading support is not turned on,
please set the correct command line options for threading" error
without the need to tamper with CMAKE_CXX_FLAGS.

Based on a patch found in the Debian package for cmake, which I've
enhanced/modernized a bit.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.128 2015/06/24 06:39:03 dcoppa Exp $
d21 2
a22 1
MASTER_SITES =	${HOMEPAGE}files/v${VER:R}/
@


1.128
log
@
jdk-1.8 bits for CMake
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.127 2015/06/03 08:25:30 dcoppa Exp $
d14 1
a14 1
REVISION =	0
@


1.127
log
@
maintenance update to CMake 3.2.3
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.126 2015/04/23 09:19:44 dcoppa Exp $
d14 1
a14 1

@


1.126
log
@
Maintenance update to cmake-3.2.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.125 2015/04/21 18:33:48 sthen Exp $
d12 1
a12 1
VER =		3.2.2
@


1.125
log
@add some missing pthread to WANTLIB
(using modified portbump, thanks zhuk@@)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.124 2015/03/26 07:10:02 dcoppa Exp $
d12 1
a12 1
VER =		3.2.1
a13 1
REVISION =	0
@


1.124
log
@
Update to CMake-3.2.1

Tested in a bulk build by landry@@
OK landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.123 2015/02/13 14:17:36 dcoppa Exp $
d14 1
d27 1
a27 2
WANTLIB =		archive c curl expat form jsoncpp \
			m ncurses stdc++ z
@


1.123
log
@
Maintenance update to CMake-3.1.3
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.122 2015/02/06 08:09:42 dcoppa Exp $
d12 1
a12 1
VER =		3.1.3
d26 2
a27 2
WANTLIB =		archive c curl expat form m ncurses \
			stdc++ z
d38 1
a64 1
	rm -f ${WRKSRC}/Help/manual/cmake-gui.1.rst
d93 1
a93 2
	rm ${WRKINST}${LOCALBASE}/share/cmake/Help/*.orig \
		${WRKINST}${LOCALBASE}/share/cmake/Modules/*.{beforesubst,orig} \
@


1.122
log
@
Bugfixing update to cmake-3.1.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.121 2015/01/23 18:01:09 dcoppa Exp $
d12 1
a12 1
VER =		3.1.2
@


1.121
log
@
Maintenance update to cmake-3.1.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.120 2015/01/20 11:41:32 dcoppa Exp $
d12 1
a12 1
VER =		3.1.1
@


1.120
log
@
Fetch the right version of ruby from MODRUBY_REV automagically
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.119 2015/01/13 08:22:48 dcoppa Exp $
d12 1
a12 1
VER =		3.1.0
a13 1
REVISION =	2
@


1.119
log
@
FindRuby.cmake: fix selection of version x.0
FindRuby.cmake: properly detect Ruby 2.2.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.118 2015/01/08 16:58:00 dcoppa Exp $
d14 1
a14 1
REVISION =	1
@


1.118
log
@
Sync patches with upstream:

FindQt4: search for versioned qmake names first before general qmake
(upstream git commit 8de3f22e8fe9e798b63eb00e35eee6404748d3bd)

FindSDL: fix bad variable expansion
(upstream git commit fd329307b2ee76abaa41e25a300902a2fb983895)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.117 2014/12/31 11:06:02 dcoppa Exp $
d14 1
a14 1
REVISION =	0
@


1.117
log
@
Update to cmake-3.1.0

Bulk build by landry@@
KDE-related fixes by zhuk@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.116 2014/11/04 13:50:24 dcoppa Exp $
d14 1
@


1.116
log
@
Remove '-O2' as default optimization
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.115 2014/10/07 11:12:23 dcoppa Exp $
d12 1
a12 1
VER =		3.0.2
a13 1
REVISION =	7
@


1.115
log
@
fix FindLua module; from upstream (Rolf Eike Beer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.114 2014/10/03 10:11:45 dcoppa Exp $
d14 1
a14 1
REVISION =	6
@


1.114
log
@
Do not register full paths to shared libraries in the ELF "NEEDED"
sections

tested in a bulk build by landry@@

OK landry@@, zhuk@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.113 2014/10/02 09:40:16 zhuk Exp $
d14 1
a14 1
REVISION =	5
@


1.113
log
@Use ALL_TEST_ENV instead of MAKE_ENV here, too.

Reminded by dcoppa@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.112 2014/10/01 08:42:32 dcoppa Exp $
d14 1
a14 1
REVISION =	4
@


1.112
log
@
Use ${VER:R} instead of hardcoding the major version into MASTER_SITES
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.111 2014/09/30 15:02:32 dcoppa Exp $
d89 1
a89 1
	cd ${WRKBUILD} && exec ${SETENV} ${MAKE_ENV} ninja -v -j \
@


1.111
log
@
Add missing bits of sthen's commit to disable ninja on m88k
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.110 2014/09/30 14:24:31 dcoppa Exp $
a9 2
HOMEPAGE =	http://www.cmake.org/
CATEGORIES =	devel
d11 3
a13 1
DISTNAME =	cmake-3.0.2
d15 4
a18 1
MASTER_SITES =	${HOMEPAGE}files/v3.0/
d21 2
@


1.110
log
@
Simplify patch
Thanks to to Rolf Eike Beer for this too
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.109 2014/09/29 08:45:35 dcoppa Exp $
d26 1
d73 2
a74 1
.if ${MACHINE_ARCH} != "arm"
@


1.109
log
@
Shrug. Fix typo
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.108 2014/09/29 08:25:39 dcoppa Exp $
d14 1
a14 1
REVISION =	3
@


1.108
log
@
Merge OpenBSD-related fixes from upstream git
kudos to Rolf Eike Beer
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.107 2014/09/28 18:15:40 dcoppa Exp $
d14 1
a14 1
REVISION =	2
@


1.107
log
@
Better safe than sorry
(adapted from upstream)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.106 2014/09/28 17:06:24 dcoppa Exp $
d14 1
a14 1
REVISION =	1
@


1.106
log
@
Temporary workaround for a sporadic segfault which seems to result
from memory corruption. To be removed when CMake 3.1 will be released.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.105 2014/09/17 11:57:17 sthen Exp $
d14 1
a14 1
REVISION =	0
@


1.105
log
@devel/ninja is knocked out on m88k; disable its use with cmake (as already
done with arm)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.104 2014/09/12 08:36:12 dcoppa Exp $
d14 1
@


1.104
log
@
Bugfixing update to cmake-3.0.2

Use Ninja-1.5's console pool to have visible output during long-running
tasks which produce status updates on the console (such as test suites)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.103 2014/09/11 10:24:38 dcoppa Exp $
d25 1
a25 1
.if ${MACHINE_ARCH} != "arm"
@


1.103
log
@
Update to cmake-3.0.1

Tested in a bulk build by landry@@
OK landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.102 2014/06/25 00:29:45 zhuk Exp $
d13 1
a13 1
DISTNAME =	cmake-3.0.1
d26 1
a26 1
BUILD_DEPENDS =		devel/ninja
@


1.102
log
@Sync FindBacktrace.cmake with what's been committed upstream and what's the
Clementine actually waits for.

Pointed out, initially patched and tested by sthen@@, thanks!
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.101 2014/05/13 05:55:30 dcoppa Exp $
d13 2
a14 3
DISTNAME =	cmake-2.8.12.2
REVISION =	4
MASTER_SITES =	${HOMEPAGE}files/v2.8/
d21 1
a21 1
WANTLIB =		archive c curl curses expat form m \
d29 2
d36 4
a39 2
			--datadir=/share/cmake \
			--docdir=/share/doc/cmake \
d41 3
d58 1
a62 1
		${WRKSRC}/Modules/FindLuaLibs.cmake \
d86 4
a89 3
	rm ${WRKINST}/${LOCALBASE}/share/cmake/Modules/*.{beforesubst,orig}
	rm ${WRKINST}/${LOCALBASE}/share/cmake/Modules/Compiler/*.orig
	rm ${WRKINST}/${LOCALBASE}/share/cmake/Modules/Platform/*.orig
@


1.101
log
@
Fix uninitialized variable
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.100 2014/05/12 14:47:49 dcoppa Exp $
d14 1
a14 1
REVISION =	3
@


1.100
log
@kurt@@ forgot Modules/FindJava.cmake in his commit (and, while here,
fix style).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.99 2014/05/07 15:42:15 kurt Exp $
d14 1
a14 1
REVISION =	2
@


1.99
log
@- Unlink jdk/1.6 and make jdk/1.7 the default jdk for all java ports
- Adjust java.port.mk and cmake to use 1.7
- Adjust jdk/1.7 for pkg_add upgrades
okay sthen@@, jasper@@, ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.98 2014/04/14 14:02:44 dcoppa Exp $
d14 1
a14 1
REVISION =	1
@


1.98
log
@FindPython{Interp,Libs}: Search for Python 3.4
(upstream git commit ab6201ab647c13fee44c44822b8502e9848faaaf)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.97 2014/03/12 08:32:13 dcoppa Exp $
d14 1
a14 1
REVISION =	0
@


1.97
log
@
Maintenance update to cmake-2.8.12.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.96 2014/01/15 19:54:37 dcoppa Exp $
d14 1
@


1.96
log
@Teach FindRuby.cmake about the recently imported Ruby 2.1

ok zhuk@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.95 2014/01/10 08:21:12 dcoppa Exp $
d13 1
a13 2
DISTNAME =	cmake-2.8.12.1
REVISION =	1
@


1.95
log
@Fixes for Freetype 2.5.x

Upstream git commits:
http://cmake.org/gitweb?p=cmake.git;a=commit;h=7435ae7c97590a0713d86b63add761d5e1607ec1
http://cmake.org/gitweb?p=cmake.git;a=commit;h=bc49d820a276243324003bc34d92a69194938adf
http://cmake.org/gitweb?p=cmake.git;a=commit;h=9b08e3f5993eb004e3eb0d9ae8b593f553989f89

OK naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.94 2013/11/25 14:16:22 sthen Exp $
d14 1
a14 1
REVISION =	0
@


1.94
log
@kill VMEM_WARNING
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.93 2013/11/11 07:23:32 dcoppa Exp $
d14 1
@


1.93
log
@Bugfix update to cmake-2.8.12.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.92 2013/10/14 12:58:02 dcoppa Exp $
a2 1
VMEM_WARNING =	Yes
@


1.92
log
@Update to cmake-2.8.12.
Tested in a bulk build by the usual suspects, Thanks!

ok espie@@, kili@@
ok zhuk@@ for kde4
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.91 2013/09/30 11:18:09 dcoppa Exp $
d14 1
a14 1
DISTNAME =	cmake-2.8.12
@


1.91
log
@
FindTCL: Add OpenBSD paths for Tcl/Tk 8.6
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.90 2013/08/22 09:53:20 dcoppa Exp $
d14 1
a14 2
DISTNAME =	cmake-2.8.11.2
REVISION =	3
@


1.90
log
@CMake's built-in ELF parser is broken on arm:

> #0  cmELF (this=0xbfff4674, fname=0x4337438c "/usr/lib/libz.so.4.1")
>     at basic_ios.h:124
> 124           { return _M_streambuf_state; }

Since this is a requirement for Ninja, disable both of
them if ${MACHINE_ARCH} == "arm".

As a workaround, ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.89 2013/08/20 14:22:58 dcoppa Exp $
d15 1
a15 1
REVISION =	2
@


1.89
log
@Move rm commands back to where they were before (post-install)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.88 2013/08/16 10:37:22 dcoppa Exp $
d15 1
a15 1
REVISION =	1
d26 2
d29 1
d65 2
d78 1
@


1.88
log
@Missed in previous commit.
okay zhuk@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.87 2013/08/12 16:09:50 zhuk Exp $
a68 3
	rm ${WRKINST}/${LOCALBASE}/share/cmake/Modules/*.{beforesubst,orig}
	rm ${WRKINST}/${LOCALBASE}/share/cmake/Modules/Compiler/*.orig
	rm ${WRKINST}/${LOCALBASE}/share/cmake/Modules/Platform/*.orig
d73 5
@


1.87
log
@Unbreak (bulk) builds of Java-based apps using CMake: we force using JDK 1.6
to build MODJAVA_VER=1.6+ ports, and CMake should do the same. Otherwise we
could, e.g., pick up co-installed JDK 1.7, start build using it, and while
build process goes, JDK 1.7 may disappear...

Discovered while working on OpenCV 2.4, which contains Java bindings.

okay dcoppa@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.86 2013/07/04 16:34:05 dcoppa Exp $
d15 1
a15 1
REVISION =	0
@


1.86
log
@Maintenance update to cmake-2.8.11.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.85 2013/06/28 14:58:23 dcoppa Exp $
d15 1
@


1.85
log
@Switch CMake to use ninja to build itself.

OK espie@@; makes sense to sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.84 2013/06/25 07:16:46 dcoppa Exp $
d14 1
a14 2
DISTNAME =	cmake-2.8.11.1
REVISION =	0
@


1.84
log
@Enable ELF parsing and editing support on OpenBSD.
Ninja will use it.

OK espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.83 2013/06/21 11:12:51 dcoppa Exp $
d26 2
d62 7
a68 1
post-install:
d72 4
@


1.83
log
@Bugfix update to cmake-2.8.11.1
See: http://public.kitware.com/Bug/changelog_page.php?version_id=113

OK jasper@@, sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.82 2013/06/06 12:47:06 dcoppa Exp $
d15 1
@


1.82
log
@Update to cmake-2.8.11.

Tested in a bulk build by landry@@
Tested with KDE4 by zhuk@@
OK zhuk@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.81 2013/05/30 08:34:32 dcoppa Exp $
d14 1
a14 1
DISTNAME =	cmake-2.8.11
@


1.81
log
@Simplification
Minor fixes and cleanups
Put stuff where it belongs
Zap some useless patches

(in preparation for cmake-2.8.11)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.80 2013/05/13 15:02:26 dcoppa Exp $
d14 1
a14 2
DISTNAME =	cmake-2.8.10.2
REVISION =	6
a48 1
		${WRKSRC}/Modules/FindFreetype.cmake \
a54 1
		${WRKSRC}/Modules/FindQt3.cmake \
@


1.80
log
@Fix for the problem sthen@@ reported some time ago: if a library is
not listed in SHARED_LIBS, it will be created with no version suffix.

It was a regression caused by my "build shared libraries without
soname" work, sorry.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.79 2013/04/22 13:13:56 zhuk Exp $
d15 1
a15 1
REVISION =	5
d43 1
a43 1
TEST_TARGET =	test
d60 1
a60 2
		${WRKSRC}/Modules/FindTCL.cmake \
		${WRKSRC}/Modules/UseJava.cmake
@


1.79
log
@Add support for rubyarchhdrdir and rubyarchlibdir, with fallback to "defaults"
on systems that have such directories but RbConfig doesn't have such options.

Needed for some minor KDE SC parts.

ok dcoppa@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.78 2013/04/12 17:39:57 sthen Exp $
d15 1
a15 1
REVISION =	4
@


1.78
log
@Replace BROKEN-arm with arch-conditional "CFLAGS += -O1 -fno-stack-protector".
Big thanks to miod@@ for tracking down the area in which the problem lies
and suggesting this workaround.

Unbreaks a big chunk of the ports tree on arm.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.77 2013/03/21 10:21:49 zhuk Exp $
d15 1
a15 1
REVISION =	3
@


1.77
log
@Add hand-written FindBacktrace.cmake, a helper to find our libexecinfo and
other backtrace() implementation sources.

okayed by dcoppa@@ before lock
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.76 2013/03/11 10:50:02 espie Exp $
a3 1
BROKEN-arm =	build fails since move to gcc4
d5 5
@


1.76
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.75 2013/01/18 22:17:06 dcoppa Exp $
d11 1
a11 1
REVISION =	2
@


1.75
log
@Fix a couple of crashers, from upstream:

Bugfix: don't crash when a target is expected but is not available
(upstream git commit e767ffcda58ab73cf2c4394202eec7ae1f6035b5)

Bugfix: don't crash if the link.txt file contains empty lines
(upstream git commit 8ff1d4714fb7cd42eb3cd8db041b529e433eb7c8)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.74 2013/01/02 08:59:59 dcoppa Exp $
a16 3
PERMIT_DISTFILES_FTP =	Yes
PERMIT_DISTFILES_CDROM =Yes
PERMIT_PACKAGE_FTP =	Yes
d39 1
a39 1
REGRESS_TARGET =	test
@


1.74
log
@Do not pick up gmake first if installed (even without 'USE_GMAKE=Yes')

Add '--parallel=${MAKE_JOBS}' to CONFIGURE_ARGS

Add '--verbose' to CONFIGURE_ARGS

Remove USE_GROFF
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.73 2012/12/11 11:51:39 dcoppa Exp $
d11 1
a11 1
REVISION =	1
@


1.73
log
@Add DPB_PROPERTIES=parallel

Test/OK sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.72 2012/12/06 15:11:07 dcoppa Exp $
d11 1
a11 1
REVISION =	0
d32 5
a36 1
			--system-libs
a40 1
USE_GROFF =		Yes
@


1.72
log
@Sync with upstream.

Thanks Amit Kulkarni and brad.king@@kitware.com
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.71 2012/12/05 11:32:04 dcoppa Exp $
d5 1
@


1.71
log
@Bugfix update to cmake-2.8.10.2.
Sync patches with what has been committed upstream (kudos to Amit)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.70 2012/11/26 12:32:29 dcoppa Exp $
d10 1
@


1.70
log
@Sync with upstream
(http://cmake.org/gitweb?p=cmake.git;a=commit;h=94f37851ef5c6dccbe2dd647a3b38e3196393298)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.69 2012/11/22 13:21:49 dcoppa Exp $
d9 1
a9 2
DISTNAME =	cmake-2.8.10.1
REVISION =	2
a54 1
		${WRKSRC}/Modules/FindwxWindows.cmake \
@


1.69
log
@Append "/usr/X11R6/include" to ${QT_INCLUDES} to unbreak the build
in some circumstances (i.e. QtOpenGL not finding GL/gl.h)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.68 2012/11/15 12:29:07 dcoppa Exp $
d10 1
a10 1
REVISION =	1
@


1.68
log
@Fix string literal typo (from upstream)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.67 2012/11/15 08:43:25 dcoppa Exp $
d10 1
a10 1
REVISION =	0
d53 1
@


1.67
log
@Update to cmake-2.8.10.1 (plus some fixes)

Thanks Vadim, landry@@

OK landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.66 2012/11/11 17:13:31 dcoppa Exp $
d10 1
@


1.66
log
@Update to cmake-2.8.10.
Successfully gone through a bulk build.

Feedback landry@@, Vadim Zhukov, Amit Kulkarni
Bulk build and OK landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.65 2012/10/08 07:23:09 dcoppa Exp $
d9 1
a9 1
DISTNAME =	cmake-2.8.10
d42 1
a42 1
	@@cp ${FILESDIR}/*.cmake ${WRKSRC}/Modules/
d44 1
d58 3
a60 3
	@@rm ${WRKINST}/${LOCALBASE}/share/cmake/Modules/*.{beforesubst,orig}
	@@rm ${WRKINST}/${LOCALBASE}/share/cmake/Modules/Compiler/*.orig
	@@rm ${WRKINST}/${LOCALBASE}/share/cmake/Modules/Platform/*.orig
@


1.65
log
@CMake now creates shared libraries without soname.

Tested in a bulk build by landry@@
Feedback by nigel@@ and landry@@
OK landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.64 2012/08/31 12:28:31 dcoppa Exp $
d9 1
a9 2
DISTNAME =	cmake-2.8.9
REVISION =	0
d52 1
@


1.64
log
@Update to cmake-2.8.9.

"There was no cmake fallout in the bulk on amd64" jasper@@
Also tested by Brad with a handful of CMake using ports
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.63 2012/08/20 08:07:34 dcoppa Exp $
d10 1
@


1.63
log
@Garbage collect the pthread patching for CMake.

From Brad, thanks.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62 2012/07/12 16:26:13 dcoppa Exp $
d9 1
a9 2
DISTNAME =	cmake-2.8.8
REVISION =	10
@


1.62
log
@Fix the old FindLua51 module too.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.61 2012/07/12 15:36:20 dcoppa Exp $
d10 1
a10 1
REVISION =	9
@


1.61
log
@Finish the work with lua and cmake: it's nicer and more compact now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.60 2012/07/10 15:20:24 jasper Exp $
d10 1
a10 1
REVISION =	8
@


1.60
log
@fixes for lua

from dcoppa@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59 2012/07/03 07:48:54 dcoppa Exp $
d10 1
a10 1
REVISION =	7
a46 1
		${WRKSRC}/Modules/FindLuaInterp.cmake \
a56 1
	@@rm ${WRKINST}/${LOCALBASE}/share/cmake/Modules/FindLua5?.cmake
@


1.59
log
@Fix typo: "_CXX_" -> "_C_"
(upstream git commit b9ccaf5f7977b7444a50a7b1dbb1902422f7ab27)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2012/06/27 19:28:39 dcoppa Exp $
d10 1
a10 1
REVISION =	6
d47 2
d58 1
@


1.58
log
@Fix mandir path when using GNUInstallDirs.cmake: on OpenBSD it's
$prefix/man, not $prefix/share/man. While here, fix infodir too.

Pointed out by sthen@@
Ok landry@@, sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.57 2012/06/15 10:26:56 dcoppa Exp $
d10 1
a10 1
REVISION =	5
@


1.57
log
@Sync FindIconv, FindLCMS, FindLibintl modules with KDE's upstream git

Add FindLibLZMA module
(upstream git commit ee26019bd433020b8aad3c3a70bcb537e03b04ba)

Bugfix: FindPythonLibs: honor EXACT version specification
(upstream git commit 9d145b0998f21ae6d0571c5b6a7ab0168722df7c)

Bugfix: UseJava: fix find_jar() called with multiple files
(upstream git commit 5593d5718ec90f6a2e37ca4e2fdf3fc4537380ff)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2012/06/14 09:32:00 dcoppa Exp $
d10 1
a10 1
REVISION =	4
@


1.56
log
@Fix libpthread linking (use '-pthread' instead of '-lpthread') for
cmake-based ports that use "CHECK_LIBRARY_EXISTS(pthread ...)".

Fix libpthread linking for devel/llvm too (additional care was
needed).

No fallout in a bulk build: thanks landry!
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55 2012/05/15 08:36:28 dcoppa Exp $
d10 1
a10 1
REVISION =	3
@


1.55
log
@Sync with what bentley@@ pushed upstream.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.54 2012/05/14 19:24:33 bentley Exp $
d10 1
a10 1
REVISION =	2
@


1.54
log
@Set wxWidgets_INCLUDE_DIRS_NO_SYSTEM.

This prevents compiler errors with cmake/wxwidgets:
"error: template with C linkage"

See the variable's comments and links in
/usr/local/share/cmake/Modules/FindwxWidgets.cmake for more information.

ok dcoppa@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2012/05/07 13:58:18 dcoppa Exp $
d10 1
a10 1
REVISION =	1
@


1.53
log
@
try_compile: Cleanup temporary directories
Since commit 4fbdce2b (try_compile: Use random executable file name,
2012-02-13) a different <target>.dir is used for each try-compile.
Cleanup the directories as well as their content to avoid accumulating
leftover temporary directories.
(upstream git commit 953257ca611526c9a161a22e5148802be1c67649)

Remove troublesome "Qt4Deploy" and "CTest.UpdateCVS" tests
(from gentoo's package/dev-util/cmake/files/)

Sync FindPkgConfig.cmake patch with upstream
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.52 2012/05/07 07:06:20 dcoppa Exp $
d10 1
a10 1
REVISION =	0
@


1.52
log
@Update to cmake-2.8.8

OK sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 2012/03/29 13:38:13 sthen Exp $
d10 1
@


1.51
log
@Change SEPARATE_BUILD=(concurrent|simple) to Yes; bsd.port.mk doesn't
make a distinction between these.  ok aja@@ dcoppa@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2012/01/12 13:14:33 dcoppa Exp $
d9 1
a9 2
DISTNAME =	cmake-2.8.7
REVISION =	0
@


1.50
log
@Some fixes from upstream git:

fixes for Modules/FindRuby.cmake

fix wrong use of IS_ABSOLUTE into Modules/GenerateExportHeader.cmake

fix Source/cmLocalUnixMakefileGenerator3.cxx: exit the loop when
we have determined the language
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2012/01/07 22:14:51 dcoppa Exp $
d35 1
a35 1
SEPARATE_BUILD =	simple
@


1.49
log
@Update to cmake-2.8.7.

Tested in a bulk build by naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2011/12/05 21:44:02 sthen Exp $
d10 1
@


1.48
log
@cmake doesn't build following move to gcc4. Mark it as broken so it's not
forgotten as arm packages are not being built at present.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2011/12/03 13:38:43 dcoppa Exp $
d9 1
a9 2
DISTNAME =	cmake-2.8.6
REVISION =	0
@


1.47
log
@FindRuby.cmake: use RbConfig::CONFIG instead of obsolete and
deprecated Config::CONFIG.

pointed out by Amit Kulkarni and jeremy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2011/10/14 17:22:10 dcoppa Exp $
d4 1
@


1.46
log
@Update to cmake-2.8.6

Fixed FindRuby.cmake module (from Vadim Zhukov)

Fixed FindJava.cmake and FindJNI.cmake modules when cmake is used
outside of our ports tree (problem reported and fix tested by
pirofti@@)

Still "100% tests passed, 0 tests failed out of 197".

No fallout in a bulk build.

OK jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2011/10/08 18:55:36 dcoppa Exp $
d9 1
@


1.45
log
@Fix my lameness.

pointed out by espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2011/09/20 11:32:36 dcoppa Exp $
d8 1
a8 1
DISTNAME =	cmake-2.8.5
d42 4
a45 1
	${SUBST_CMD} ${WRKSRC}/Modules/FindMPEG.cmake \
d50 2
a51 1
		${WRKSRC}/Modules/FindwxWindows.cmake
a52 1
# Remove spurious post-build files
@


1.44
log
@Update to cmake-2.8.5

Went in a bulk without issues, ok landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2011/07/12 08:35:29 dcoppa Exp $
d51 3
a53 3
	@@rm ${WRKDIST}/Modules/*.{beforesubst,orig}
	@@rm ${WRKDIST}/Modules/Compiler/*.orig
	@@rm ${WRKDIST}/Modules/Platform/*.orig
@


1.43
log
@Remove -O0 workaround for arm. It should be unneeded now that arm
has been switched to gcc4.

OK ajacoutot@@, sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2011/05/02 15:59:43 sthen Exp $
d8 1
a8 2
DISTNAME =	cmake-2.8.4
REVISION =	3
@


1.42
log
@Switch to simpler Modules/CMakeDetermineSystem.cmake patch now committed
upstream. Suggested by/ok dcoppa@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2011/04/29 16:50:32 sthen Exp $
d9 1
a9 1
REVISION =	2
a37 5

# XXX eats all memory
.if ${MACHINE_ARCH} == "arm"
CFLAGS +=		-O0
.endif
@


1.41
log
@Set CMAKE_HOST_SYSTEM_PROCESSOR more like people are expecting by
using arch -s instead of uname -p. Tested with all current CMake
users in tree, no change.  ok dcoppa@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2011/04/16 15:18:13 sthen Exp $
d9 1
a9 1
REVISION =	1
@


1.40
log
@Don't try to create directories which already exist, this significantly
cleans up the console output if you set USE_SYSTRACE.  ok dcoppa@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2011/04/14 15:55:19 jasper Exp $
d9 1
a9 1
REVISION =	0
@


1.39
log
@don't use ``rm -f'' for remove unneeded files.
this will remember us, when not needed anymore this treatment.

from gleydson soares
ok aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2011/03/13 18:23:01 dcoppa Exp $
d9 1
@


1.38
log
@Update to cmake-2.8.4.
Tested in a bulk build by landry@@.
Lot of feedback from various people on ports@@: thanks!

OK landry@@, sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2010/11/22 22:27:02 dcoppa Exp $
d56 3
a58 3
	@@rm -f ${WRKDIST}/Modules/*.{beforesubst,orig}
	@@rm -f ${WRKDIST}/Modules/Compiler/*.orig
	@@rm -f ${WRKDIST}/Modules/Platform/*.orig
@


1.37
log
@It's better having iconv and intl as QtCore dependencies.
This is my last commit for this, I promise.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2010/11/22 16:26:30 dcoppa Exp $
d8 1
a8 2
DISTNAME =	cmake-2.8.3
REVISION =	3
d19 2
a20 2
WANTLIB =		archive c crypto curl curses expat form m \
			ssl stdc++ z
@


1.36
log
@Sync with KDE upstream
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2010/11/19 16:18:12 dcoppa Exp $
d9 1
a9 1
REVISION =	2
@


1.35
log
@Just removing that check makes more sense. I'm a moron.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2010/11/19 11:10:35 dcoppa Exp $
d9 1
a9 1
REVISION =	1
d48 1
a48 2
	${SUBST_CMD} ${WRKSRC}/Modules/FindLibIntl.cmake \
		${WRKSRC}/Modules/FindMPEG.cmake \
@


1.34
log
@Fix a bug that broke $QT_QT*_LIB_DEPENDENCIES since cmake-2.8.2.
Now port-lib-depends-check for geo/qgis is happy.

Problem noticed by, and OK landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2010/11/15 19:45:57 espie Exp $
d9 1
a9 1
REVISION =	0
@


1.33
log
@move depends to new style
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2010/11/15 11:39:08 dcoppa Exp $
d9 1
@


1.32
log
@Update to cmake-2.8.3

OK sthen@@, landry@@ (who also tested this in a bulk build)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2010/10/26 18:31:18 dcoppa Exp $
d22 2
a23 2
LIB_DEPENDS =		::archivers/libarchive \
			::net/curl
d34 1
a34 1
USE_GROFF =	Yes
@


1.31
log
@Zap some unwanted optimization flags ("-O3", "-Os") that were brought
in by cmake when the CMAKE_BUILD_TYPE var is used.

Pointed out by and OK steven@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2010/10/18 17:47:51 espie Exp $
d8 1
a8 2
DISTNAME =	cmake-2.8.2
REVISION =	3
d19 2
a20 1
WANTLIB =		c crypto curl curses expat form m ssl stdc++ z
d22 2
a23 1
LIB_DEPENDS =		::net/curl
d42 2
@


1.30
log
@USE_GROFF=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2010/09/29 07:33:24 dcoppa Exp $
d9 1
a9 1
REVISION =	2
d55 1
@


1.29
log
@Remove mips64 from the list of archs that want -O0 to build cmake. This
is not needed anymore since the switch to gcc4.

Tested by jasper@@ and phessler@@ on loongson and sgi.

OK jasper@@, phessler@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2010/09/06 00:16:22 sthen Exp $
d33 1
@


1.28
log
@- bump REVISION following change for hppa/powerpc to stop forcing -O0
- sort remaining arch

from Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2010/09/02 08:06:13 landry Exp $
d9 1
a9 1
REVISION =	1
d37 1
a37 1
.if ${MACHINE_ARCH} == "arm" || ${MACHINE_ARCH} == "mips64"
@


1.27
log
@Remove hppa and powerpc from the list of archs that needs -O0 to build
cmake. This is apparently not needed anymore since the switch to gcc4.
prodded by brad, tested by myself
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2010/08/25 14:29:56 sthen Exp $
d9 1
a9 1
REVISION =	0
d37 1
a37 1
.if ${MACHINE_ARCH} == "mips64" || ${MACHINE_ARCH} == "arm"
@


1.26
log
@arm needs -O0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2010/08/23 18:17:30 jasper Exp $
d37 1
a37 1
.if ${MACHINE_ARCH} == "hppa" || ${MACHINE_ARCH} == "powerpc" || ${MACHINE_ARCH} == "mips64" || ${MACHINE_ARCH} == "arm"
@


1.25
log
@- add mips64 to the list of architectures that need -O0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2010/07/28 20:34:22 dcoppa Exp $
d37 1
a37 1
.if ${MACHINE_ARCH} == "hppa" || ${MACHINE_ARCH} == "powerpc" || ${MACHINE_ARCH} == "mips64"
@


1.24
log
@We overwrite library version numbers using our LIBxxx_VERSION
environment variable, but we want to do it for shared libraries
only. Otherwise a static library gets created as
libfoo.a.${LIBfoo_VERSION}, which is wrong.
Bug reported and patch tested by Alexandr Shadchin <alexandr DOT
shadchin AT gmail DOT com>: thanks!

While here, reword/clarify some comments to better explain what my
patches do.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2010/07/12 19:19:30 dcoppa Exp $
d37 1
a37 1
.if ${MACHINE_ARCH} == "hppa" || ${MACHINE_ARCH} == "powerpc"
@


1.23
log
@Fix a bug with shared libraries having OUTPUT_NAME in their target
properties.

Update to cmake-2.8.2.

While here, move to new-style LIB_DEPENDS/WANTLIB.

OK espie@@, landry@@, sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2010/06/11 08:07:17 dcoppa Exp $
d9 1
@


1.22
log
@Set CFLAGS in the ports Makefile instead of using handrolled patches.
Unbreak build on hppa too. From landry@@: thanks!

OK landry@@
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.21 2010/05/31 06:29:27 dcoppa Exp $
d8 1
a8 2
DISTNAME =	cmake-2.8.1
PKGNAME =	${DISTNAME}p0
d19 1
a19 1
WANTLIB =		c curses expat form m stdc++ z
d21 1
a21 1
LIB_DEPENDS =		curl::net/curl
d28 3
d35 2
a36 1
.if ${MACHINE_ARCH} == "hppa" || ${MACHINE_ARCH} == "sparc64"
d48 1
a48 2
		${WRKSRC}/Modules/FindwxWindows.cmake \
		${WRKSRC}/Modules/Platform/UnixPaths.cmake
a52 1
	@@rm -f ${WRKDIST}/Modules/Platform/*.beforesubst
a53 5

# For the registry test to work
pre-regress:
	mkdir -p ${WRKDIR}/registryhome
	REGRESS_FLAGS=HOME=${WRKDIR}/registryhome
@


1.21
log
@Add some bits needed by kde4.
Move the "cleaning commands" from post-build to post-install.
From espie@@: thanks!

OK espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2010/05/28 20:21:48 dcoppa Exp $
d30 4
@


1.20
log
@Update to cmake 2.8.1 (I also take maintainership).

"This is good, commit." espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2010/04/22 16:10:11 dcoppa Exp $
d7 1
d43 1
a43 1
post-build:
@


1.19
log
@Fix for Fortran shared libraries that were generated without
versioning.

OK ajacoutot@@, landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2010/04/15 20:30:47 dcoppa Exp $
d3 5
a7 7
HOMEPAGE=		http://www.cmake.org/
CATEGORIES=		devel
COMMENT=		portable build system
DISTNAME=		cmake-2.4.8
PKGNAME=		${DISTNAME}p4
MASTER_SITES=		${HOMEPAGE}files/v2.4/
MAINTAINER=		Marc Espie <espie@@openbsd.org>
d9 1
d12 34
a45 4
PERMIT_DISTFILES_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes
PERMIT_PACKAGE_CDROM=	Yes
a46 19
CONFIGURE_STYLE=	simple
CONFIGURE_SCRIPT=	${WRKSRC}/bootstrap
SEPARATE_BUILD=		simple
CONFIGURE_ENV=		LOCALBASE=${LOCALBASE} X11BASE=${X11BASE} MAKE=make
CONFIGURE_ARGS=		--prefix=${LOCALBASE} --docdir=/share/doc/CMake \
			--datadir=/share/CMake --system-libs



LIB_DEPENDS=		curl::net/curl \
			xmlrpc,xmlrpc_client,xmlrpc_util,xmlrpc_xmlparse,xmlrpc_xmltok::net/xmlrpc-c 

WANTLIB=	expat m curses c stdc++ z crypto pthread ssl idn

# Add these if you need to figure out what's going on.
#CONFIGURE_ARGS+=	--verbose
#MAKE_FLAGS=	VERBOSE=1

REGRESS_TARGET=	test
d50 1
a50 1
REGRESS_FLAGS=HOME=${WRKDIR}/registryhome
@


1.18
log
@Avoid creating .so symlinks for shared libraries, as they break
OpenBSD porting standards.

OK landry@@, sthen@@
"if it works and other people like it, go ahead" espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2009/09/10 13:54:47 landry Exp $
d7 1
a7 1
PKGNAME=		${DISTNAME}p3
@


1.17
log
@Force the use of -pthread in FindThreads.cmake module. It was looking
for -lpthread first.
No fallouts in a bulk build done by jasper@@, thanks!
ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2009/03/14 18:59:36 ajacoutot Exp $
d7 1
a7 1
PKGNAME=		${DISTNAME}p2
@


1.16
log
@- regen PLIST
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2008/02/04 22:31:20 espie Exp $
d7 1
a7 1
PKGNAME=		${DISTNAME}p1
@


1.15
log
@deal with qt4 issues here, instead of in kde.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2008/01/26 21:26:32 espie Exp $
d7 1
a7 1
PKGNAME=		${DISTNAME}p0
@


1.14
log
@minor update to 2.4.8 (all tests pass now)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2007/08/25 08:35:20 espie Exp $
d7 1
a7 1
PKGNAME=		${DISTNAME}
@


1.13
log
@minor update cmake 2.4.7
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2007/06/18 11:52:26 ajacoutot Exp $
d6 1
a6 1
DISTNAME=		cmake-2.4.7
@


1.12
log
@- when cmake uses gcc to build things, make it correctly grab CFLAGS and
CXXFLAGS variables and don't force compiler optimizations

ok espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2007/06/16 13:01:37 espie Exp $
d6 2
a7 2
DISTNAME=		cmake-2.4.6
PKGNAME=		${DISTNAME}p7
@


1.11
log
@only call mkdir on !empty stuff that does not exist.
removes systrace warnings. reported by ajacoutout.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2007/06/09 09:09:44 espie Exp $
d7 1
a7 1
PKGNAME=		${DISTNAME}p6
@


1.10
log
@allow cmake to proceed in color unless you `explicitly' ask it otherwise
(setting BATCH, for instance).

Synch FindQt4 with some of qt 4.3.0 stuff. Need to be fully synched with
qt 4.3.0 anyways...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2007/05/14 20:40:15 naddy Exp $
d7 1
a7 1
PKGNAME=		${DISTNAME}p5
@


1.9
log
@chase wantlib changes introduced by curl update
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2007/04/28 10:10:29 bernd Exp $
d7 1
a7 1
PKGNAME=		${DISTNAME}p4
@


1.8
log
@Use xenocara expat.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2007/04/25 14:56:13 espie Exp $
d7 1
a7 1
PKGNAME=		${DISTNAME}p3
d30 1
a30 1
WANTLIB=	expat m curses c stdc++ z crypto pthread ssl
@


1.7
log
@list -pthread as a dependency of qt4core, so that stuff will link in a simpler
way.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2007/03/26 21:27:44 espie Exp $
d7 1
a7 1
PKGNAME=		${DISTNAME}p2
a27 1
			expat::textproc/expat \
d30 1
a30 1
WANTLIB=	m curses c stdc++ z crypto pthread ssl
@


1.6
log
@fix shared library numbers for OpenBSD. Patch may still change, but it
appears to work fine w/ kde4.

cmake will still generate a libfoo.so (which is useful as a placeholder to
know the lib has been built, since other directories don't have access to
the version number), but it obeys OpenBSD conventions for the actual library
now.

ld does the right thing, namely it ignores the libfoo.so and links against
libfoo.so.5.0 properly.

Also take environment into account to allow the ports tree to override
version numbers.

Todo: logfile of built libraries.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2007/03/23 16:30:35 espie Exp $
d7 1
a7 1
PKGNAME=		${DISTNAME}p1
@


1.5
log
@fix openbsd lib detection, don't break out of the loop (I'm stupid).
let cmake detect most recent library, as it should
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2007/02/17 19:04:24 espie Exp $
d7 1
a7 1
PKGNAME=		${DISTNAME}p0
@


1.4
log
@minor update, mostly some sh compat stuff...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2006/12/18 16:04:31 espie Exp $
d7 1
@


1.3
log
@update to cmake 2.4.5, quite a few patches vanish since cmake can now
build stuff with system libraries, so we no longer have to repair
curl/zlib... just xmlrpc which cmake can't find without help.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2006/07/31 23:55:51 espie Exp $
d6 1
a6 1
DISTNAME=		cmake-2.4.5
@


1.2
log
@update to 2.4.3
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2006/07/20 09:23:13 espie Exp $
d6 1
a6 1
DISTNAME=		cmake-2.4.3
d21 2
a22 1
CONFIGURE_ARGS=		--prefix=${LOCALBASE} --docdir=/share/doc/CMake
d27 2
a28 1
			expat::textproc/expat
d30 1
a30 1
WANTLIB=	m curses c stdc++ z
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d6 1
a6 1
DISTNAME=		cmake-2.4.2
@


1.1.1.1
log
@cmake, a `new' build system. Used by KDE4.

Easier to work with than autoconf/automake/libtool.
@
text
@@
