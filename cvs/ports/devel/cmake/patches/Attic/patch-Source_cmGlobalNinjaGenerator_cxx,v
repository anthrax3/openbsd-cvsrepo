head	1.3;
access;
symbols
	OPENBSD_5_7:1.2.0.2
	OPENBSD_5_7_BASE:1.2;
locks; strict;
comment	@# @;


1.3
date	2015.03.26.07.10.02;	author dcoppa;	state dead;
branches;
next	1.2;
commitid	RC163bs6emik8Gf9;

1.2
date	2014.12.31.11.06.02;	author dcoppa;	state Exp;
branches;
next	1.1;
commitid	q283NDlM4qiVneVU;

1.1
date	2014.09.12.08.36.12;	author dcoppa;	state Exp;
branches;
next	;
commitid	lN5EaWqGfTyCDbtq;


desc
@@


1.3
log
@
Update to CMake-3.2.1

Tested in a bulk build by landry@@
OK landry@@
@
text
@$OpenBSD: patch-Source_cmGlobalNinjaGenerator_cxx,v 1.2 2014/12/31 11:06:02 dcoppa Exp $

Use Ninja-1.5's console pool to have visible output during long-running
tasks which produce status updates on the console (such as test suites)

--- Source/cmGlobalNinjaGenerator.cxx.orig	Mon Dec 15 14:07:43 2014
+++ Source/cmGlobalNinjaGenerator.cxx	Thu Dec 18 05:37:12 2014
@@@@ -238,6 +238,7 @@@@ void cmGlobalNinjaGenerator::AddCustomCommandRule()
                 "$COMMAND",
                 "$DESC",
                 "Rule for running custom commands.",
+                /*pool*/ "console",
                 /*depfile*/ "",
                 /*deptype*/ "",
                 /*rspfile*/ "",
@@@@ -300,6 +301,7 @@@@ cmGlobalNinjaGenerator::AddMacOSXContentRule()
                 cmd.str(),
                 "Copying OS X Content $out",
                 "Rule for copying OS X bundle content file.",
+                /*pool*/ "",
                 /*depfile*/ "",
                 /*deptype*/ "",
                 /*rspfile*/ "",
@@@@ -335,6 +337,7 @@@@ void cmGlobalNinjaGenerator::WriteRule(std::ostream& o
                                        const std::string& command,
                                        const std::string& description,
                                        const std::string& comment,
+                                       const std::string& pool,
                                        const std::string& depfile,
                                        const std::string& deptype,
                                        const std::string& rspfile,
@@@@ -365,6 +368,13 @@@@ void cmGlobalNinjaGenerator::WriteRule(std::ostream& o
   // Write the rule.
   os << "rule " << name << "\n";
 
+  // Write the pool if any.
+  if(!pool.empty())
+    {
+    cmGlobalNinjaGenerator::Indent(os, 1);
+    os << "pool = " << pool << "\n";
+    }
+
   // Write the depfile if any.
   if(!depfile.empty())
     {
@@@@ -598,6 +608,7 @@@@ void cmGlobalNinjaGenerator::AddRule(const std::string
                                      const std::string& command,
                                      const std::string& description,
                                      const std::string& comment,
+                                     const std::string& pool,
                                      const std::string& depfile,
                                      const std::string& deptype,
                                      const std::string& rspfile,
@@@@ -617,6 +628,7 @@@@ void cmGlobalNinjaGenerator::AddRule(const std::string
                                     command,
                                     description,
                                     comment,
+                                    pool,
                                     depfile,
                                     deptype,
                                     rspfile,
@@@@ -1112,6 +1124,7 @@@@ void cmGlobalNinjaGenerator::WriteTargetRebuildManifes
             cmd.str(),
             "Re-running CMake...",
             "Rule for re-running cmake.",
+            /*pool=*/ "",
             /*depfile=*/ "",
             /*deptype=*/ "",
             /*rspfile=*/ "",
@@@@ -1192,6 +1205,7 @@@@ void cmGlobalNinjaGenerator::WriteTargetClean(std::ost
             ninjaCmd() + " -t clean",
             "Cleaning all built files...",
             "Rule for cleaning all built files.",
+            /*pool=*/ "",
             /*depfile=*/ "",
             /*deptype=*/ "",
             /*rspfile=*/ "",
@@@@ -1215,6 +1229,7 @@@@ void cmGlobalNinjaGenerator::WriteTargetHelp(std::ostr
             ninjaCmd() + " -t targets",
             "All primary targets available:",
             "Rule for printing all primary targets available.",
+            /*pool=*/ "",
             /*depfile=*/ "",
             /*deptype=*/ "",
             /*rspfile=*/ "",
@


1.2
log
@
Update to cmake-3.1.0

Bulk build by landry@@
KDE-related fixes by zhuk@@
@
text
@d1 1
a1 1
$OpenBSD: patch-Source_cmGlobalNinjaGenerator_cxx,v 1.1 2014/09/12 08:36:12 dcoppa Exp $
@


1.1
log
@
Bugfixing update to cmake-3.0.2

Use Ninja-1.5's console pool to have visible output during long-running
tasks which produce status updates on the console (such as test suites)
@
text
@d1 1
a1 1
$OpenBSD$
d6 3
a8 3
--- Source/cmGlobalNinjaGenerator.cxx.orig	Thu Jul 31 17:03:57 2014
+++ Source/cmGlobalNinjaGenerator.cxx	Fri Sep  5 16:02:54 2014
@@@@ -242,6 +242,7 @@@@ void cmGlobalNinjaGenerator::AddCustomCommandRule()
d16 1
a16 1
@@@@ -297,6 +298,7 @@@@ cmGlobalNinjaGenerator::AddMacOSXContentRule()
d24 1
a24 1
@@@@ -332,6 +334,7 @@@@ void cmGlobalNinjaGenerator::WriteRule(std::ostream& o
d32 1
a32 1
@@@@ -362,6 +365,13 @@@@ void cmGlobalNinjaGenerator::WriteRule(std::ostream& o
d46 1
a46 1
@@@@ -586,6 +596,7 @@@@ void cmGlobalNinjaGenerator::AddRule(const std::string
d54 1
a54 1
@@@@ -605,6 +616,7 @@@@ void cmGlobalNinjaGenerator::AddRule(const std::string
d70 2
a71 2
@@@@ -1171,6 +1184,7 @@@@ void cmGlobalNinjaGenerator::WriteTargetClean(std::ost
             (ninjaCmd() + " -t clean").c_str(),
d78 2
a79 2
@@@@ -1194,6 +1208,7 @@@@ void cmGlobalNinjaGenerator::WriteTargetHelp(std::ostr
             (ninjaCmd() + " -t targets").c_str(),
@

