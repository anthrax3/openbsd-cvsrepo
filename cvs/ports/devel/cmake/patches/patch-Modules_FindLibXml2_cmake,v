head	1.3;
access;
symbols;
locks; strict;
comment	@# @;


1.3
date	2017.07.10.23.05.54;	author zhuk;	state Exp;
branches;
next	1.2;
commitid	HXIb1SJ1e1YG2zL2;

1.2
date	2017.07.04.20.07.51;	author dcoppa;	state dead;
branches;
next	1.1;
commitid	gUgowqqwtK0VH8O0;

1.1
date	2017.07.04.16.38.53;	author dcoppa;	state Exp;
branches;
next	;
commitid	Oz05wUWda9N0KZ9U;


desc
@@


1.3
log
@Use standard CMake idiom for Foo_INCLUDE_DIR/DIRS and Foo_LIBRARY/LIBRARIES
in FindLibXml2.cmake.

To be used by pgpointcloud port. See also the upstream merge request #1043:
https://gitlab.kitware.com/cmake/cmake/merge_requests/1043

okay dcoppa@@, landry@@
@
text
@$OpenBSD$
Provide de-facto standard CMake variables.

Upstream merge request:
https://gitlab.kitware.com/cmake/cmake/merge_requests/1043

Index: Modules/FindLibXml2.cmake
--- Modules/FindLibXml2.cmake.orig
+++ Modules/FindLibXml2.cmake
@@@@ -12,7 +12,9 @@@@
 # ::
 #
 #   LIBXML2_FOUND - System has LibXml2
-#   LIBXML2_INCLUDE_DIR - The LibXml2 include directory
+#   LIBXML2_INCLUDE_DIR - The actual LibXml2 include directory
+#   LIBXML2_INCLUDE_DIRS - The list of include directories needed to use LibXml2
+#   LIBXML2_LIBRARY - The actual LibXml2 library
 #   LIBXML2_LIBRARIES - The libraries needed to use LibXml2
 #   LIBXML2_DEFINITIONS - Compiler switches required for using LibXml2
 #   LIBXML2_XMLLINT_EXECUTABLE - The XML checking tool xmllint coming with LibXml2
@@@@ -31,7 +33,7 @@@@ find_path(LIBXML2_INCLUDE_DIR NAMES libxml/xpath.h
    PATH_SUFFIXES libxml2
    )
 
-find_library(LIBXML2_LIBRARIES NAMES xml2 libxml2
+find_library(LIBXML2_LIBRARY NAMES xml2 libxml2
    HINTS
    ${PC_LIBXML_LIBDIR}
    ${PC_LIBXML_LIBRARY_DIRS}
@@@@ -52,11 +54,14 @@@@ elseif(LIBXML2_INCLUDE_DIR AND EXISTS "${LIBXML2_INCLU
     unset(libxml2_version_str)
 endif()
 
+set(LIBXML2_INCLUDE_DIRS ${LIBXML2_INCLUDE_DIR} ${PC_LIBXML_INCLUDE_DIRS})
+set(LIBXML2_LIBRARIES ${LIBXML2_LIBRARY})
+
 # handle the QUIETLY and REQUIRED arguments and set LIBXML2_FOUND to TRUE if
 # all listed variables are TRUE
 include(${CMAKE_CURRENT_LIST_DIR}/FindPackageHandleStandardArgs.cmake)
 FIND_PACKAGE_HANDLE_STANDARD_ARGS(LibXml2
-                                  REQUIRED_VARS LIBXML2_LIBRARIES LIBXML2_INCLUDE_DIR
+                                  REQUIRED_VARS LIBXML2_LIBRARY LIBXML2_INCLUDE_DIR
                                   VERSION_VAR LIBXML2_VERSION_STRING)
 
-mark_as_advanced(LIBXML2_INCLUDE_DIR LIBXML2_LIBRARIES LIBXML2_XMLLINT_EXECUTABLE)
+mark_as_advanced(LIBXML2_INCLUDE_DIR LIBXML2_LIBRARY LIBXML2_XMLLINT_EXECUTABLE)
@


1.2
log
@
Revert previous
@
text
@d1 2
a2 1
$OpenBSD: patch-Modules_FindLibXml2_cmake,v 1.1 2017/07/04 16:38:53 dcoppa Exp $
d4 2
a5 1
include/libxml2/libxml/encoding.h wants iconv.h
d10 10
a19 1
@@@@ -18,6 +18,8 @@@@
d21 3
a23 1
 #   LIBXML2_VERSION_STRING - the version of LibXml2 found (since CMake 2.8.8)
d25 6
a30 8
+include(FindIconv)
+
 # use pkg-config to get the directories and then use these values
 # in the find_path() and find_library() calls
 find_package(PkgConfig QUIET)
@@@@ -50,6 +52,10 @@@@ elseif(LIBXML2_INCLUDE_DIR AND EXISTS "${LIBXML2_INCLU
     string(REGEX REPLACE "^#define[\t ]+LIBXML_DOTTED_VERSION[\t ]+\"([^\"]*)\".*" "\\1"
            LIBXML2_VERSION_STRING "${libxml2_version_str}")
a31 4
+endif()
+
+if(ICONV_FOUND)
+    list(INSERT LIBXML2_INCLUDE_DIR 0 ${ICONV_INCLUDE_DIR})
d34 3
d38 9
@


1.1
log
@
include/libxml2/libxml/encoding.h wants iconv.h, so teach
FindLibXml2.cmake how to find the libiconv include directory.

Problem spotted by landry@@ while porting geo/pgpointcloud
@
text
@d1 1
a1 1
$OpenBSD$
@

