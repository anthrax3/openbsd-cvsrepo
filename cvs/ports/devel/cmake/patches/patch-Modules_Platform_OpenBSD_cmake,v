head	1.14;
access;
symbols
	OPENBSD_6_0:1.14.0.8
	OPENBSD_6_0_BASE:1.14
	OPENBSD_5_9:1.14.0.4
	OPENBSD_5_9_BASE:1.14
	OPENBSD_5_8:1.14.0.6
	OPENBSD_5_8_BASE:1.14
	OPENBSD_5_7:1.14.0.2
	OPENBSD_5_7_BASE:1.14
	OPENBSD_5_6:1.11.0.6
	OPENBSD_5_6_BASE:1.11
	OPENBSD_5_5:1.11.0.4
	OPENBSD_5_5_BASE:1.11
	OPENBSD_5_4:1.11.0.2
	OPENBSD_5_4_BASE:1.11
	OPENBSD_5_3:1.9.0.2
	OPENBSD_5_3_BASE:1.9
	OPENBSD_5_2:1.5.0.8
	OPENBSD_5_2_BASE:1.5
	OPENBSD_5_1_BASE:1.5
	OPENBSD_5_1:1.5.0.6
	OPENBSD_5_0:1.5.0.4
	OPENBSD_5_0_BASE:1.5
	OPENBSD_4_9:1.5.0.2
	OPENBSD_4_9_BASE:1.5
	OPENBSD_4_8:1.4.0.2
	OPENBSD_4_8_BASE:1.4
	OPENBSD_4_7:1.1.1.1.0.16
	OPENBSD_4_7_BASE:1.1.1.1
	OPENBSD_4_6:1.1.1.1.0.14
	OPENBSD_4_6_BASE:1.1.1.1
	OPENBSD_4_5:1.1.1.1.0.12
	OPENBSD_4_5_BASE:1.1.1.1
	OPENBSD_4_4:1.1.1.1.0.10
	OPENBSD_4_4_BASE:1.1.1.1
	OPENBSD_4_3:1.1.1.1.0.8
	OPENBSD_4_3_BASE:1.1.1.1
	OPENBSD_4_2:1.1.1.1.0.6
	OPENBSD_4_2_BASE:1.1.1.1
	OPENBSD_4_1:1.1.1.1.0.4
	OPENBSD_4_1_BASE:1.1.1.1
	OPENBSD_4_0:1.1.1.1.0.2
	OPENBSD_4_0_BASE:1.1.1.1
	kde:1.1.1.1
	espie:1.1.1;
locks; strict;
comment	@# @;


1.14
date	2014.12.31.11.06.02;	author dcoppa;	state Exp;
branches;
next	1.13;
commitid	q283NDlM4qiVneVU;

1.13
date	2014.09.30.14.24.31;	author dcoppa;	state Exp;
branches;
next	1.12;
commitid	UNvE6uRiD96fproi;

1.12
date	2014.09.29.08.25.39;	author dcoppa;	state Exp;
branches;
next	1.11;
commitid	Rs6vJ0tO5v5EhITe;

1.11
date	2013.06.06.12.47.06;	author dcoppa;	state Exp;
branches;
next	1.10;

1.10
date	2013.05.30.08.34.32;	author dcoppa;	state Exp;
branches;
next	1.9;

1.9
date	2012.12.05.11.32.04;	author dcoppa;	state Exp;
branches;
next	1.8;

1.8
date	2012.11.15.08.43.25;	author dcoppa;	state Exp;
branches;
next	1.7;

1.7
date	2012.11.11.17.13.32;	author dcoppa;	state Exp;
branches;
next	1.6;

1.6
date	2012.08.31.12.28.31;	author dcoppa;	state Exp;
branches;
next	1.5;

1.5
date	2010.11.15.11.39.09;	author dcoppa;	state Exp;
branches;
next	1.4;

1.4
date	2010.07.12.19.19.30;	author dcoppa;	state Exp;
branches;
next	1.3;

1.3
date	2010.05.28.20.21.48;	author dcoppa;	state Exp;
branches;
next	1.2;

1.2
date	2010.04.22.16.10.11;	author dcoppa;	state Exp;
branches;
next	1.1;

1.1
date	2006.07.20.09.23.13;	author espie;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2006.07.20.09.23.13;	author espie;	state Exp;
branches;
next	;


desc
@@


1.14
log
@
Update to cmake-3.1.0

Bulk build by landry@@
KDE-related fixes by zhuk@@
@
text
@$OpenBSD: patch-Modules_Platform_OpenBSD_cmake,v 1.13 2014/09/30 14:24:31 dcoppa Exp $
--- Modules/Platform/OpenBSD.cmake.orig	Mon Dec 15 14:07:43 2014
+++ Modules/Platform/OpenBSD.cmake	Thu Dec 18 05:37:12 2014
@@@@ -1,5 +1,7 @@@@
 include(Platform/NetBSD)
 
+unset(CMAKE_SHARED_LIBRARY_SONAME_C_FLAG)
+
 # On OpenBSD, the compile time linker does not share it's configuration with
 # the runtime linker.  This will extract the library search paths from the
 # system's ld.so.hints file which will allow CMake to set the appropriate
@


1.13
log
@
Simplify patch
Thanks to to Rolf Eike Beer for this too
@
text
@d1 3
a3 3
$OpenBSD: patch-Modules_Platform_OpenBSD_cmake,v 1.12 2014/09/29 08:25:39 dcoppa Exp $
--- Modules/Platform/OpenBSD.cmake.orig	Thu Sep 11 15:24:00 2014
+++ Modules/Platform/OpenBSD.cmake	Tue Sep 30 11:44:17 2014
a11 23
@@@@ -17,6 +19,22 @@@@ endif()
 
 set_property(GLOBAL PROPERTY FIND_LIBRARY_USE_OPENBSD_VERSIONING 1)
 
+# OpenBSD has no multilib
+set_property(GLOBAL PROPERTY FIND_LIBRARY_USE_LIB64_PATHS FALSE)
+
 # OpenBSD policy requires that shared libraries be installed without
 # executable permission.
 set(CMAKE_INSTALL_SO_NO_EXE 1)
+
+if($ENV{LOCALBASE})
+  set(OPENBSD_LOCALBASE $ENV{LOCALBASE})
+else()
+  set(OPENBSD_LOCALBASE /usr/local)
+endif()
+if($ENV{X11BASE})
+  set(OPENBSD_X11BASE $ENV{X11BASE})
+else()
+  set(OPENBSD_X11BASE /usr/X11R6)
+endif()
+
+list(APPEND CMAKE_SYSTEM_PREFIX_PATH ${OPENBSD_LOCALBASE})
@


1.12
log
@
Merge OpenBSD-related fixes from upstream git
kudos to Rolf Eike Beer
@
text
@d1 1
a1 1
$OpenBSD: patch-Modules_Platform_OpenBSD_cmake,v 1.11 2013/06/06 12:47:06 dcoppa Exp $
d3 3
a5 13
+++ Modules/Platform/OpenBSD.cmake	Mon Sep 29 08:21:49 2014
@@@@ -1,5 +1,16 @@@@
-include(Platform/NetBSD)
+set(CMAKE_DL_LIBS "")
+set(CMAKE_C_COMPILE_OPTIONS_PIC "-fPIC")
+set(CMAKE_C_COMPILE_OPTIONS_PIE "-fPIE")
+set(CMAKE_SHARED_LIBRARY_C_FLAGS "-fPIC")            # -pic
+set(CMAKE_SHARED_LIBRARY_CREATE_C_FLAGS "-shared")       # -shared
+set(CMAKE_SHARED_LIBRARY_LINK_C_FLAGS "")         # +s, flag for exe link to use shared lib
+set(CMAKE_SHARED_LIBRARY_RUNTIME_C_FLAG "-Wl,-rpath,")       # -rpath
+set(CMAKE_SHARED_LIBRARY_RUNTIME_C_FLAG_SEP ":")   # : or empty
+set(CMAKE_SHARED_LIBRARY_RPATH_LINK_C_FLAG "-Wl,-rpath-link,")
+set(CMAKE_EXE_EXPORTS_C_FLAG "-Wl,--export-dynamic")
d7 1
a7 1
+include(Platform/UnixPaths)
d12 1
a12 1
@@@@ -17,6 +28,22 @@@@ endif()
@


1.11
log
@Update to cmake-2.8.11.

Tested in a bulk build by landry@@
Tested with KDE4 by zhuk@@
OK zhuk@@
@
text
@d1 4
a4 4
$OpenBSD: patch-Modules_Platform_OpenBSD_cmake,v 1.10 2013/05/30 08:34:32 dcoppa Exp $
--- Modules/Platform/OpenBSD.cmake.orig	Wed May 15 19:38:12 2013
+++ Modules/Platform/OpenBSD.cmake	Thu May 30 11:06:11 2013
@@@@ -1,4 +1,15 @@@@
d16 2
a18 2
+include(Platform/UnixPaths)
 
d21 24
@


1.10
log
@Simplification
Minor fixes and cleanups
Put stuff where it belongs
Zap some useless patches

(in preparation for cmake-2.8.11)
@
text
@d1 4
a4 4
$OpenBSD: patch-Modules_Platform_OpenBSD_cmake,v 1.9 2012/12/05 11:32:04 dcoppa Exp $
--- Modules/Platform/OpenBSD.cmake.orig	Tue Nov 27 14:26:32 2012
+++ Modules/Platform/OpenBSD.cmake	Wed May 29 14:39:43 2013
@@@@ -1,5 +1,16 @@@@
d16 2
a18 2
+include(Platform/UnixPaths)
+
a20 9
 # system's ld.so.hints file which will allow CMake to set the appropriate
@@@@ -16,3 +27,7 @@@@ if(NOT CMAKE_PLATFORM_RUNTIME_PATH)
 endif()
 
 set_property(GLOBAL PROPERTY FIND_LIBRARY_USE_OPENBSD_VERSIONING 1)
+
+# OpenBSD policy requires that shared libraries be installed without
+# executable permission.
+set(CMAKE_INSTALL_SO_NO_EXE 1)
@


1.9
log
@Bugfix update to cmake-2.8.10.2.
Sync patches with what has been committed upstream (kudos to Amit)
@
text
@d1 1
a1 1
$OpenBSD: patch-Modules_Platform_OpenBSD_cmake,v 1.8 2012/11/15 08:43:25 dcoppa Exp $
d3 2
a4 2
+++ Modules/Platform/OpenBSD.cmake	Wed Dec  5 10:13:03 2012
@@@@ -1,5 +1,37 @@@@
d6 10
a15 12
+if(EXISTS /usr/include/dlfcn.h)
+  set(CMAKE_DL_LIBS "")
+  set(CMAKE_C_COMPILE_OPTIONS_PIC "-fPIC")
+  set(CMAKE_C_COMPILE_OPTIONS_PIE "-fPIE")
+  set(CMAKE_SHARED_LIBRARY_C_FLAGS "-fPIC")            # -pic
+  set(CMAKE_SHARED_LIBRARY_CREATE_C_FLAGS "-shared")       # -shared
+  set(CMAKE_SHARED_LIBRARY_LINK_C_FLAGS "")         # +s, flag for exe link to use shared lib
+  set(CMAKE_SHARED_LIBRARY_RUNTIME_C_FLAG "-Wl,-rpath,")       # -rpath
+  set(CMAKE_SHARED_LIBRARY_RUNTIME_C_FLAG_SEP ":")   # : or empty
+  set(CMAKE_SHARED_LIBRARY_RPATH_LINK_C_FLAG "-Wl,-rpath-link,")
+  set(CMAKE_EXE_EXPORTS_C_FLAG "-Wl,--export-dynamic")
+endif()
a18 19
+if($ENV{LOCALBASE})
+  set(OPENBSD_LOCALBASE $ENV{LOCALBASE})
+else($ENV{LOCALBASE})
+  set(OPENBSD_LOCALBASE /usr/local)
+endif($ENV{LOCALBASE})
+
+if($ENV{X11BASE})
+  set(OPENBSD_X11BASE $ENV{X11BASE})
+else($ENV{X11BASE})
+  set(OPENBSD_X11BASE /usr/X11R6)
+endif($ENV{X11BASE})
+
+set(CMAKE_SYSTEM_INCLUDE_PATH ${CMAKE_SYSTEM_INCLUDE_PATH} /usr/include
+  ${OPENBSD_LOCALBASE}/include ${OPENBSD_X11BASE}/include)
+set(CMAKE_SYSTEM_LIBRARY_PATH ${CMAKE_SYSTEM_LIBRARY_PATH} /usr/lib
+  ${OPENBSD_LOCALBASE}/lib ${OPENBSD_X11BASE}/lib)
+set(CMAKE_SYSTEM_PROGRAM_PATH ${CMAKE_SYSTEM_PROGRAM_PATH} /bin /usr/bin
+  ${OPENBSD_LOCALBASE}/bin /sbin /usr/sbin ${OPENBSD_LOCALBASE}/sbin)
+
d22 1
a22 1
@@@@ -16,3 +48,7 @@@@ if(NOT CMAKE_PLATFORM_RUNTIME_PATH)
@


1.8
log
@Update to cmake-2.8.10.1 (plus some fixes)

Thanks Vadim, landry@@

OK landry@@
@
text
@d1 3
a3 3
$OpenBSD: patch-Modules_Platform_OpenBSD_cmake,v 1.7 2012/11/11 17:13:32 dcoppa Exp $
--- Modules/Platform/OpenBSD.cmake.orig	Tue Nov  6 20:41:36 2012
+++ Modules/Platform/OpenBSD.cmake	Tue Nov 13 10:59:45 2012
d43 1
a43 1
@@@@ -16,3 +48,9 @@@@ if(NOT CMAKE_PLATFORM_RUNTIME_PATH)
a50 2
+set(CMAKE_INSTALL_SO_NO_EXE 1 CACHE INTERNAL
+  "Install .so files without execute permission.")
@


1.7
log
@Update to cmake-2.8.10.
Successfully gone through a bulk build.

Feedback landry@@, Vadim Zhukov, Amit Kulkarni
Bulk build and OK landry@@
@
text
@d1 17
a17 5
$OpenBSD: patch-Modules_Platform_OpenBSD_cmake,v 1.6 2012/08/31 12:28:31 dcoppa Exp $
--- Modules/Platform/OpenBSD.cmake.orig	Wed Oct 31 16:32:05 2012
+++ Modules/Platform/OpenBSD.cmake	Fri Nov  2 08:28:09 2012
@@@@ -1,5 +1,24 @@@@
 include(Platform/NetBSD)
d19 2
d43 1
a43 1
@@@@ -16,3 +35,9 @@@@ if(NOT CMAKE_PLATFORM_RUNTIME_PATH)
@


1.6
log
@Update to cmake-2.8.9.

"There was no cmake fallout in the bulk on amd64" jasper@@
Also tested by Brad with a handful of CMake using ports
@
text
@d1 3
a3 3
$OpenBSD: patch-Modules_Platform_OpenBSD_cmake,v 1.5 2010/11/15 11:39:09 dcoppa Exp $
--- Modules/Platform/OpenBSD.cmake.orig	Thu Aug  9 20:15:19 2012
+++ Modules/Platform/OpenBSD.cmake	Fri Aug 31 14:20:36 2012
d5 1
a5 1
 INCLUDE(Platform/NetBSD)
d7 5
a11 5
+IF($ENV{LOCALBASE})
+  SET(OPENBSD_LOCALBASE $ENV{LOCALBASE})
+ELSE($ENV{LOCALBASE})
+  SET(OPENBSD_LOCALBASE /usr/local)
+ENDIF($ENV{LOCALBASE})
d13 5
a17 5
+IF($ENV{X11BASE})
+  SET(OPENBSD_X11BASE $ENV{X11BASE})
+ELSE($ENV{X11BASE})
+  SET(OPENBSD_X11BASE /usr/X11R6)
+ENDIF($ENV{X11BASE})
d19 1
a19 1
+SET(CMAKE_SYSTEM_INCLUDE_PATH ${CMAKE_SYSTEM_INCLUDE_PATH} /usr/include
d21 1
a21 1
+SET(CMAKE_SYSTEM_LIBRARY_PATH ${CMAKE_SYSTEM_LIBRARY_PATH} /usr/lib
d23 1
a23 1
+SET(CMAKE_SYSTEM_PROGRAM_PATH ${CMAKE_SYSTEM_PROGRAM_PATH} /bin /usr/bin
d29 2
a30 2
@@@@ -16,3 +35,9 @@@@ IF(NOT CMAKE_PLATFORM_RUNTIME_PATH)
 ENDIF()
d32 1
a32 1
 SET_PROPERTY(GLOBAL PROPERTY FIND_LIBRARY_USE_OPENBSD_VERSIONING 1)
d36 2
a37 2
+SET(CMAKE_INSTALL_SO_NO_EXE 1)
+SET(CMAKE_INSTALL_SO_NO_EXE 1 CACHE INTERNAL
@


1.5
log
@Update to cmake-2.8.3

OK sthen@@, landry@@ (who also tested this in a bulk build)
@
text
@d1 3
a3 3
$OpenBSD: patch-Modules_Platform_OpenBSD_cmake,v 1.4 2010/07/12 19:19:30 dcoppa Exp $
--- Modules/Platform/OpenBSD.cmake.orig	Wed Nov  3 20:58:27 2010
+++ Modules/Platform/OpenBSD.cmake	Fri Nov 12 10:04:21 2010
d29 1
a29 1
@@@@ -16,3 +35,4 @@@@ IF(NOT CMAKE_PLATFORM_RUNTIME_PATH)
d33 3
d37 2
@


1.4
log
@Fix a bug with shared libraries having OUTPUT_NAME in their target
properties.

Update to cmake-2.8.2.

While here, move to new-style LIB_DEPENDS/WANTLIB.

OK espie@@, landry@@, sthen@@
@
text
@d1 3
a3 3
$OpenBSD: patch-Modules_Platform_OpenBSD_cmake,v 1.3 2010/05/28 20:21:48 dcoppa Exp $
--- Modules/Platform/OpenBSD.cmake.orig	Mon Jun 28 17:15:57 2010
+++ Modules/Platform/OpenBSD.cmake	Fri Jul  9 16:21:13 2010
@


1.3
log
@Update to cmake 2.8.1 (I also take maintainership).

"This is good, commit." espie@@
@
text
@d1 4
a4 4
$OpenBSD: patch-Modules_Platform_OpenBSD_cmake,v 1.2 2010/04/22 16:10:11 dcoppa Exp $
--- Modules/Platform/OpenBSD.cmake.orig	Tue Apr  6 16:45:32 2010
+++ Modules/Platform/OpenBSD.cmake	Tue May 11 13:33:12 2010
@@@@ -1,2 +1,37 @@@@
d6 1
a6 1
+ 
d12 1
a12 1
+ 
d19 1
a19 1
+SET(CMAKE_SYSTEM_INCLUDE_PATH ${CMAKE_SYSTEM_INCLUDE_PATH} /usr/include  
d21 1
a21 1
+SET(CMAKE_SYSTEM_LIBRARY_PATH ${CMAKE_SYSTEM_LIBRARY_PATH} /usr/lib 
d23 1
a23 1
+SET(CMAKE_SYSTEM_PROGRAM_PATH ${CMAKE_SYSTEM_PROGRAM_PATH} /bin /usr/bin 
d26 6
a31 15
+# On OpenBSD, the compile time linker does not share it's configuration with
+# the runtime linker.  This will extract the library search paths from the
+# system's ld.so.hints file which will allow CMake to set the appropriate
+# -rpath-link flags
+IF(NOT CMAKE_PLATFORM_RUNTIME_PATH)
+  EXECUTE_PROCESS(COMMAND /sbin/ldconfig -r
+                  OUTPUT_VARIABLE LDCONFIG_HINTS
+                  ERROR_QUIET)
+  STRING(REGEX REPLACE ".*search\\ directories:\\ ([^\n]*).*" "\\1"
+         LDCONFIG_HINTS "${LDCONFIG_HINTS}")
+  STRING(REGEX REPLACE ":" ";"
+         CMAKE_PLATFORM_RUNTIME_PATH
+         "${LDCONFIG_HINTS}")
+ENDIF()
+
d33 1
@


1.2
log
@Fix for Fortran shared libraries that were generated without
versioning.

OK ajacoutot@@, landry@@
@
text
@d1 6
a6 19
$OpenBSD: patch-Modules_Platform_OpenBSD_cmake,v 1.1.1.1 2006/07/20 09:23:13 espie Exp $
--- Modules/Platform/OpenBSD.cmake.orig	Mon Jan 21 19:59:51 2008
+++ Modules/Platform/OpenBSD.cmake	Fri Apr 16 10:33:28 2010
@@@@ -1,2 +1,38 @@@@
-SET(CMAKE_DL_LIBS "")
-INCLUDE(Platform/UnixPaths)
+IF(EXISTS /usr/include/dlfcn.h)
+  SET(CMAKE_DL_LIBS "")
+  SET(CMAKE_SHARED_LIBRARY_C_FLAGS "-fPIC")            # -pic 
+  SET(CMAKE_SHARED_LIBRARY_CREATE_C_FLAGS "-shared")       # -shared
+  SET(CMAKE_SHARED_LIBRARY_LINK_C_FLAGS "")         # +s, flag for exe link to use shared lib
+  SET(CMAKE_SHARED_LIBRARY_RUNTIME_C_FLAG "-Wl,-rpath,")       # -rpath
+  SET(CMAKE_SHARED_LIBRARY_RUNTIME_C_FLAG_SEP ":")   # : or empty
+# XXX we set these so that they will be detected
+  SET(CMAKE_SHARED_LIBRARY_SONAME_C_FLAG "-Wl,-soname,")
+  SET(CMAKE_SHARED_LIBRARY_SONAME_CXX_FLAG "-Wl,-soname,")
+  SET(CMAKE_SHARED_LIBRARY_SONAME_Fortran_FLAG "-Wl,-soname,")
+ENDIF(EXISTS /usr/include/dlfcn.h)
+
d8 1
a8 1
+SET(OPENBSD_LOCALBASE $ENV{LOCALBASE})
d10 1
a10 1
+SET(OPENBSD_LOCALBASE /usr/local)
d12 1
d14 1
a14 1
+SET(OPENBSD_X11BASE $ENV{X11BASE})
d16 1
a16 1
+SET(OPENBSD_X11BASE /usr/X11R6)
a17 1
+SET(CMAKE_OPENBSD_SHARED_LIBS "TRUE")
d25 17
a41 7
+# somewhat klugy, but produces the correct names.
+SET(CMAKE_CXX_CREATE_SHARED_LIBRARY
+      "<CMAKE_CXX_COMPILER> <CMAKE_SHARED_LIBRARY_CXX_FLAGS> <LANGUAGE_COMPILE_FLAGS> <LINK_FLAGS> <CMAKE_SHARED_LIBRARY_CREATE_CXX_FLAGS> -o <TARGET> <OBJECTS> <LINK_LIBRARIES>")
+SET(CMAKE_C_CREATE_SHARED_LIBRARY
+      "<CMAKE_C_COMPILER> <CMAKE_SHARED_LIBRARY_C_FLAGS> <LANGUAGE_COMPILE_FLAGS> <LINK_FLAGS> <CMAKE_SHARED_LIBRARY_CREATE_C_FLAGS> -o <TARGET> <OBJECTS> <LINK_LIBRARIES>")
+SET(CMAKE_Fortran_CREATE_SHARED_LIBRARY
+      "<CMAKE_Fortran_COMPILER> <CMAKE_SHARED_LIBRARY_Fortran_FLAGS> <LANGUAGE_COMPILE_FLAGS> <LINK_FLAGS> <CMAKE_SHARED_LIBRARY_CREATE_Fortran_FLAGS> -o <TARGET> <OBJECTS> <LINK_LIBRARIES>")
@


1.1
log
@Initial revision
@
text
@d1 4
a4 4
$OpenBSD$
--- Modules/Platform/OpenBSD.cmake.orig	Wed May 17 15:48:52 2006
+++ Modules/Platform/OpenBSD.cmake	Mon Jul  3 14:45:04 2006
@@@@ -1,2 +1,37 @@@@
d17 1
@


1.1.1.1
log
@cmake, a `new' build system. Used by KDE4.

Easier to work with than autoconf/automake/libtool.
@
text
@@
