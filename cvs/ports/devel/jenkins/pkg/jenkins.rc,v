head	1.9;
access;
symbols
	OPENBSD_6_1:1.8.0.2
	OPENBSD_6_1_BASE:1.8
	OPENBSD_6_0:1.7.0.6
	OPENBSD_6_0_BASE:1.7
	OPENBSD_5_9:1.7.0.2
	OPENBSD_5_9_BASE:1.7
	OPENBSD_5_8:1.7.0.4
	OPENBSD_5_8_BASE:1.7
	OPENBSD_5_7:1.6.0.6
	OPENBSD_5_7_BASE:1.6
	OPENBSD_5_6:1.6.0.4
	OPENBSD_5_6_BASE:1.6
	OPENBSD_5_5:1.6.0.2
	OPENBSD_5_5_BASE:1.6
	OPENBSD_5_4:1.3.0.2
	OPENBSD_5_4_BASE:1.3
	OPENBSD_5_3:1.2.0.8
	OPENBSD_5_3_BASE:1.2
	OPENBSD_5_2:1.2.0.6
	OPENBSD_5_2_BASE:1.2
	OPENBSD_5_1_BASE:1.2
	OPENBSD_5_1:1.2.0.4
	OPENBSD_5_0:1.2.0.2
	OPENBSD_5_0_BASE:1.2
	ian_2011-Mar-25:1.1.1.1
	ian:1.1.1;
locks; strict;
comment	@ * @;


1.9
date	2017.05.27.13.53.06;	author ajacoutot;	state Exp;
branches;
next	1.8;
commitid	SDpZdO8hfYIlMQ9j;

1.8
date	2016.10.11.05.51.03;	author jasper;	state Exp;
branches;
next	1.7;
commitid	ZtKZpcBnSN7SqqXI;

1.7
date	2015.07.15.14.59.15;	author ajacoutot;	state Exp;
branches;
next	1.6;
commitid	3M8rWDdk3egW952j;

1.6
date	2014.02.10.19.26.25;	author jasper;	state Exp;
branches;
next	1.5;

1.5
date	2014.01.27.09.43.24;	author jasper;	state Exp;
branches;
next	1.4;

1.4
date	2014.01.05.18.37.51;	author jasper;	state Exp;
branches;
next	1.3;

1.3
date	2013.06.27.12.58.26;	author jasper;	state Exp;
branches;
next	1.2;

1.2
date	2011.03.28.22.03.44;	author ian;	state Exp;
branches;
next	1.1;

1.1
date	2011.03.25.19.40.39;	author ian;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2011.03.25.19.40.39;	author ian;	state Exp;
branches;
next	;


desc
@@


1.9
log
@Cope with recent rc.subr(8) change (removal of rc_bg etc.)
@
text
@#!/bin/sh
#
# $OpenBSD: jenkins.rc,v 1.8 2016/10/11 05:51:03 jasper Exp $

daemon=$(${LOCALBASE}/bin/javaPathHelper -c jenkins)
daemon_flags="-Djava.io.tmpdir=/var/cache/jenkins -jar ${TRUEPREFIX}/share/jenkins/jenkins.war --httpPort=8000 --httpsPort=-1 --ajp13Port=-1"
daemon_user="_jenkins"

. /etc/rc.d/rc.subr

rc_reload=NO

# Move Jenkins' exploded .war files away from a location
# where daily(8)/weekly(8) may clean them.
# https://issues.jenkins-ci.org/browse/JENKINS-17526
# https://issues.jenkins-ci.org/browse/JENKINS-20858
rc_pre() {
	install -d -o _jenkins /var/cache/jenkins
}

rc_stop() {
	pkill -9 -T "${daemon_rtable}" -xf "${pexp}"	
}

rc_cmd $1
@


1.8
log
@- update HOMEPAGE
- tweak rcscript: sync rc_stop() with current best practice and trim rc_pre()

ok aja@@
@
text
@d3 1
a3 1
# $OpenBSD: jenkins.rc,v 1.7 2015/07/15 14:59:15 ajacoutot Exp $
a10 1
rc_bg=YES
@


1.7
log
@Adapr rc.d script after recent rc.subr change.
@
text
@d3 1
a3 1
# $OpenBSD: jenkins.rc,v 1.6 2014/02/10 19:26:25 jasper Exp $
d19 1
a19 2
        rm -fr /var/cache/jenkins && \
                install -d -o _jenkins /var/cache/jenkins
a21 1

d23 1
a23 1
	pkill -9 -xf "${pexp}"	
@


1.6
log
@Upon startup Jenkins explodes it's war for serving static files such as
javascript/css/images into /tmp. However this directory may get cleaned
over time and if the Jenkins process gets these files wiped from underneath
itself the web interfaces is completely thrashed.
So move these files to /var/cache/jenkins for now; there are various
upstream tickets about this but no update is provided which addresses this
issue.

note: jenkins-1.509.x is not affected but gets bumped as the rc script
is shared between the two packages.

ok aja@@ espie@@ gonzalo@@ ian@@ (MAINTAINER)
@
text
@d3 1
a3 1
# $OpenBSD: jenkins.rc,v 1.5 2014/01/27 09:43:24 jasper Exp $
d25 1
a25 1
	pkill -9 -f "^${pexp}"	
@


1.5
log
@ugh, commit right diff. better late than never.
@
text
@d3 1
a3 1
# $OpenBSD: jenkins.rc,v 1.4 2014/01/05 18:37:51 jasper Exp $
d6 1
a6 1
daemon_flags="-jar ${TRUEPREFIX}/share/jenkins/jenkins.war --httpPort=8000 --httpsPort=-1 --ajp13Port=-1"
d13 10
@


1.4
log
@jenkins doesn't do anything with the current rc_stop, so poke it a bit harder.

ok ian@@ (MAINTAINER)
@
text
@d3 1
a3 1
# $OpenBSD: jenkins.rc,v 1.3 2013/06/27 12:58:26 jasper Exp $
d14 1
a14 1
rc_stop {
@


1.3
log
@add rcs id to the rc script
@
text
@d3 1
a3 1
# $OpenBSD$
d13 4
@


1.2
log
@Put more options into daemon_flags, and document in README how to configure
the HTTPS and AJP ports (both now disabled). Remove dead variables.
Use ${LOCALBASE} one place instead of ${TRUEPREFIX}, requested by sthen@@.
Brief note on migration from Hudson. Bump REVISION.
Spirited discussion with ajacoutot@@ and schwarze@@; ok ajacoutot@@
@
text
@d2 2
@


1.1
log
@Initial revision
@
text
@d3 2
a4 5
JENKINS_HOME=/var/jenkins
PORT=8000

daemon=$(${TRUEPREFIX}/bin/javaPathHelper -c jenkins)
daemon_flags="-jar ${TRUEPREFIX}/share/jenkins/jenkins.war --httpPort=${PORT}"
@


1.1.1.1
log
@Import Jenkins, community fork of Hudson, looks ok to sthen@@
@
text
@@
