head	1.65;
access;
symbols
	OPENBSD_6_1:1.65.0.2
	OPENBSD_6_1_BASE:1.65
	OPENBSD_6_0:1.63.0.4
	OPENBSD_6_0_BASE:1.63
	OPENBSD_5_9:1.63.0.2
	OPENBSD_5_9_BASE:1.63
	OPENBSD_5_8:1.58.0.4
	OPENBSD_5_8_BASE:1.58
	OPENBSD_5_7:1.57.0.2
	OPENBSD_5_7_BASE:1.57
	OPENBSD_5_6:1.54.0.4
	OPENBSD_5_6_BASE:1.54
	OPENBSD_5_5:1.54.0.2
	OPENBSD_5_5_BASE:1.54
	OPENBSD_5_4:1.53.0.2
	OPENBSD_5_4_BASE:1.53
	OPENBSD_5_3:1.50.0.2
	OPENBSD_5_3_BASE:1.50
	OPENBSD_5_2:1.47.0.2
	OPENBSD_5_2_BASE:1.47
	OPENBSD_5_1_BASE:1.44
	OPENBSD_5_1:1.44.0.2
	OPENBSD_5_0:1.42.0.2
	OPENBSD_5_0_BASE:1.42
	OPENBSD_4_9:1.36.0.2
	OPENBSD_4_9_BASE:1.36
	OPENBSD_4_8:1.33.0.2
	OPENBSD_4_8_BASE:1.33
	OPENBSD_4_7:1.25.0.2
	OPENBSD_4_7_BASE:1.25
	OPENBSD_4_6:1.24.0.4
	OPENBSD_4_6_BASE:1.24
	OPENBSD_4_5:1.24.0.2
	OPENBSD_4_5_BASE:1.24
	OPENBSD_4_4:1.22.0.4
	OPENBSD_4_4_BASE:1.22
	OPENBSD_4_3:1.22.0.2
	OPENBSD_4_3_BASE:1.22
	OPENBSD_4_2:1.20.0.2
	OPENBSD_4_2_BASE:1.20
	OPENBSD_4_1:1.16.0.4
	OPENBSD_4_1_BASE:1.16
	OPENBSD_4_0:1.16.0.2
	OPENBSD_4_0_BASE:1.16
	OPENBSD_3_9:1.14.0.2
	OPENBSD_3_9_BASE:1.14
	OPENBSD_3_8:1.13.0.2
	OPENBSD_3_8_BASE:1.13
	OPENBSD_3_7:1.10.0.2
	OPENBSD_3_7_BASE:1.10
	OPENBSD_3_6:1.7.0.2
	OPENBSD_3_6_BASE:1.7
	OPENBSD_3_5:1.3.0.4
	OPENBSD_3_5_BASE:1.3
	OPENBSD_3_4:1.3.0.2
	OPENBSD_3_4_BASE:1.3
	avsm_2003-Jul-19:1.1.1.1
	avsm:1.1.1;
locks; strict;
comment	@# @;


1.65
date	2016.09.03.10.43.21;	author kili;	state Exp;
branches;
next	1.64;
commitid	rhgW6deBGcfFnopD;

1.64
date	2016.09.03.10.28.22;	author kili;	state Exp;
branches;
next	1.63;
commitid	thhogc9SPa2im2ZI;

1.63
date	2016.02.01.20.06.50;	author kili;	state Exp;
branches;
next	1.62;
commitid	Nhsneil1wEdBnJME;

1.62
date	2016.01.31.17.47.49;	author kili;	state Exp;
branches;
next	1.61;
commitid	81k7k3E25KrS8jLQ;

1.61
date	2015.12.29.12.54.38;	author kili;	state Exp;
branches;
next	1.60;
commitid	DREmzcwPMwacDWML;

1.60
date	2015.12.23.20.06.28;	author kili;	state Exp;
branches;
next	1.59;
commitid	2eLyRnqlYnhDIoHC;

1.59
date	2015.10.19.21.21.02;	author kili;	state Exp;
branches;
next	1.58;
commitid	uncyDDzCkj6SgwKZ;

1.58
date	2015.07.17.21.46.10;	author jasper;	state Exp;
branches;
next	1.57;
commitid	1Pqo8w3qhrFUoe3q;

1.57
date	2014.12.07.19.12.58;	author kili;	state Exp;
branches;
next	1.56;
commitid	pKS6dHUo5JMpPSsV;

1.56
date	2014.11.24.16.12.43;	author kili;	state Exp;
branches;
next	1.55;
commitid	y2GaBEBX93sfhHmF;

1.55
date	2014.10.14.12.28.14;	author dcoppa;	state Exp;
branches;
next	1.54;
commitid	mNSqfP6RbsAEdJXw;

1.54
date	2014.01.11.18.52.34;	author edd;	state Exp;
branches;
next	1.53;

1.53
date	2013.07.21.13.44.40;	author kili;	state Exp;
branches;
next	1.52;

1.52
date	2013.07.19.07.09.00;	author kili;	state Exp;
branches;
next	1.51;

1.51
date	2013.03.11.10.50.02;	author espie;	state Exp;
branches;
next	1.50;

1.50
date	2013.01.17.13.19.05;	author kili;	state Exp;
branches;
next	1.49;

1.49
date	2012.10.11.13.31.29;	author dcoppa;	state Exp;
branches;
next	1.48;

1.48
date	2012.09.02.21.58.45;	author kili;	state Exp;
branches;
next	1.47;

1.47
date	2012.05.13.21.27.38;	author kili;	state Exp;
branches;
next	1.46;

1.46
date	2012.05.11.20.59.47;	author kili;	state Exp;
branches;
next	1.45;

1.45
date	2012.05.09.21.00.20;	author kili;	state Exp;
branches;
next	1.44;

1.44
date	2011.12.31.22.30.49;	author kili;	state Exp;
branches;
next	1.43;

1.43
date	2011.12.27.21.13.09;	author kili;	state Exp;
branches;
next	1.42;

1.42
date	2011.06.30.21.30.20;	author kili;	state Exp;
branches;
next	1.41;

1.41
date	2011.04.27.11.19.13;	author kili;	state Exp;
branches;
next	1.40;

1.40
date	2011.04.26.19.29.16;	author kili;	state Exp;
branches;
next	1.39;

1.39
date	2011.04.23.14.32.50;	author kili;	state Exp;
branches;
next	1.38;

1.38
date	2011.04.11.14.59.27;	author kili;	state Exp;
branches;
next	1.37;

1.37
date	2011.04.05.11.45.14;	author kili;	state Exp;
branches;
next	1.36;

1.36
date	2010.11.15.19.45.57;	author espie;	state Exp;
branches;
next	1.35;

1.35
date	2010.11.02.20.22.34;	author kili;	state Exp;
branches;
next	1.34;

1.34
date	2010.10.18.17.47.52;	author espie;	state Exp;
branches;
next	1.33;

1.33
date	2010.07.17.13.54.30;	author kili;	state Exp;
branches;
next	1.32;

1.32
date	2010.06.30.15.41.01;	author kili;	state Exp;
branches;
next	1.31;

1.31
date	2010.06.15.18.00.33;	author kili;	state Exp;
branches;
next	1.30;

1.30
date	2010.05.24.14.33.03;	author kili;	state Exp;
branches;
next	1.29;

1.29
date	2010.05.09.17.00.39;	author kili;	state Exp;
branches;
next	1.28;

1.28
date	2010.05.06.20.06.28;	author kili;	state Exp;
branches;
next	1.27;

1.27
date	2010.04.25.21.20.45;	author kili;	state Exp;
branches;
next	1.26;

1.26
date	2010.04.22.21.53.18;	author kili;	state Exp;
branches;
next	1.25;

1.25
date	2009.10.04.21.16.17;	author kili;	state Exp;
branches;
next	1.24;

1.24
date	2009.01.25.18.53.33;	author kili;	state Exp;
branches;
next	1.23;

1.23
date	2008.10.18.18.58.06;	author kili;	state Exp;
branches;
next	1.22;

1.22
date	2007.12.21.19.38.46;	author kili;	state Exp;
branches;
next	1.21;

1.21
date	2007.09.16.02.52.58;	author merdely;	state Exp;
branches;
next	1.20;

1.20
date	2007.06.21.15.13.45;	author kili;	state Exp;
branches;
next	1.19;

1.19
date	2007.06.06.19.52.17;	author kili;	state Exp;
branches;
next	1.18;

1.18
date	2007.05.14.20.40.15;	author naddy;	state Exp;
branches;
next	1.17;

1.17
date	2007.04.13.03.58.53;	author steven;	state Exp;
branches;
next	1.16;

1.16
date	2006.08.01.22.46.16;	author espie;	state Exp;
branches;
next	1.15;

1.15
date	2006.07.30.21.02.32;	author alek;	state Exp;
branches;
next	1.14;

1.14
date	2005.11.17.09.31.16;	author dons;	state Exp;
branches;
next	1.13;

1.13
date	2005.05.26.01.45.38;	author dons;	state Exp;
branches;
next	1.12;

1.12
date	2005.05.16.03.17.28;	author dons;	state Exp;
branches;
next	1.11;

1.11
date	2005.05.09.03.41.34;	author dons;	state Exp;
branches;
next	1.10;

1.10
date	2005.02.14.01.59.12;	author dons;	state Exp;
branches
	1.10.2.1;
next	1.9;

1.9
date	2004.11.23.11.22.01;	author espie;	state Exp;
branches;
next	1.8;

1.8
date	2004.10.09.10.06.17;	author sturm;	state Exp;
branches;
next	1.7;

1.7
date	2004.08.10.08.23.37;	author xsa;	state Exp;
branches;
next	1.6;

1.6
date	2004.07.31.03.18.29;	author dons;	state Exp;
branches;
next	1.5;

1.5
date	2004.05.18.23.26.33;	author dons;	state Exp;
branches;
next	1.4;

1.4
date	2004.04.29.03.49.51;	author dons;	state Exp;
branches;
next	1.3;

1.3
date	2003.08.03.18.16.46;	author avsm;	state Exp;
branches;
next	1.2;

1.2
date	2003.07.23.18.27.53;	author avsm;	state Exp;
branches;
next	1.1;

1.1
date	2003.07.20.03.55.46;	author avsm;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2003.07.20.03.55.46;	author avsm;	state Exp;
branches;
next	;

1.10.2.1
date	2005.10.27.20.06.09;	author sturm;	state Exp;
branches;
next	;


desc
@@


1.65
log
@Set USE_WXNEEDED=Yes.

When running darcs record, darcs ends up with a W^X violation in
newCAF() (from the ghc runtime) via system_io_mmap_file_close()
(from devel/hs-mmap). This can only be fixed in the ghc runtime,
which isn't trivial (and I don't want to work on it before I've
updated to ghc-8).

Since the problem is triggered via devel/hs-mmap, which is only
used by devel/darcs, I hope that darcs is the only haskell program
in our tree running into this problem (instead of changing lang/ghc
to link all programs with -z wxneeded).

Problem initially noticed by Francisco de Borja Lopez Rio.
@
text
@# $OpenBSD: Makefile,v 1.64 2016/09/03 10:28:22 kili Exp $

# Needs template Haskell in Setup.lhs, which doesn't work on i386.
NOT_FOR_ARCHS =		i386

USE_WXNEEDED =		Yes

COMMENT =		advanced revision control system written in Haskell

DISTNAME =		darcs-2.10.3
REVISION =		0

CATEGORIES =		devel
HOMEPAGE =		http://www.darcs.net/

WANTLIB =		c curl>=2 iconv m ncursesw pthread util z
MODULES =		lang/ghc
MODGHC_BUILD =		cabal hackage nort
MODGHC_SETUP_CONF_ARGS =-f 'curl -http -library' --enable-tests
LIB_DEPENDS =		converters/libiconv \
			net/curl

# Yes, build dependencies, because GHC libs are still static and we
# don't want to pull in all of ghc.
BUILD_DEPENDS =		archivers/hs-zip-archive>=0.2.3,<0.3 \
			archivers/hs-zlib>=0.5.3.0,<0.7.0.0 \
			devel/hs-base16-bytestring>=0.1,<0.2 \
			devel/hs-data-ordlist>=0.4,<0.5 \
			devel/hs-hashable>=1.0,<1.3 \
			devel/hs-mmap>=0.5,<0.6 \
			devel/hs-mtl>=2.1,<2.3 \
			devel/hs-old-time>=1.1,<1.2 \
			devel/hs-parsec>=3.1,<3.2 \
			devel/hs-random>=1.0,<1.2 \
			devel/hs-regex-applicative>=0.2,<0.4 \
			devel/hs-regex-compat-tdfa>=0.95.1,<0.96 \
			devel/hs-sandi>=0.2,<0.4 \
			devel/hs-tar>=0.4,<0.6 \
			devel/hs-text>=1.2.1.3,<1.3 \
			devel/hs-transformers-compat>=0.4,<0.6 \
			devel/hs-unix-compat>=0.1.2,<0.5 \
			devel/hs-utf8-string>=0.3.6,<1.1 \
			devel/hs-vector>=0.7,<0.12 \
			security/hs-cryptohash>=0.4,<0.12 \
			textproc/hs-attoparsec>=0.11,<0.14 \
			www/hs-html>=1.0.1.1 \
			${RUN_DEPENDS}

# Used for building the test suite (which is done during normal
# build time, not during regress time).
BUILD_DEPENDS +=	devel/hs-cmdargs>=0.10,<0.11 \
			devel/hs-shelly>=1.6.2,<1.7 \
			devel/hs-split>=0.1.4.1,<0.3 \
			devel/hs-FindBin>=0.0,<0.1 \
			devel/hs-QuickCheck>=2.3,<2.9 \
			devel/hs-HUnit>=1.0,<1.4 \
			devel/hs-test-framework>=0.4.0,<0.9 \
			devel/hs-test-framework-hunit>=0.2.2,<0.4 \
			devel/hs-test-framework-quickcheck2>=0.3,<0.4

TEST_DEPENDS =		shells/bash

post-install:
	# Wrong directory, and wrong permissions (600):
	rm -rf ${PREFIX}/share/man
	${INSTALL_MAN_DIR} ${PREFIX}/man/man1
	${INSTALL_MAN} ${WRKBUILD}/dist/build/darcs/darcs.1 ${PREFIX}/man/man1

	# We don't want the library nor yet another copy of the GPL
	rm -rf ${PREFIX}/lib/${DISTNAME}
	rm -rf ${PREFIX}/share/doc/${DISTNAME}

# Some of the tests rely on GNU functionality.
pre-test:
	ln -fs ${LOCALBASE}/bin/gdate ${WRKDIR}/bin/date

# GPLv2
PERMIT_PACKAGE_CDROM =	Yes

.include <bsd.port.mk>
@


1.64
log
@Drop the iconv module.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.63 2016/02/01 20:06:50 kili Exp $
d6 2
d11 1
@


1.63
log
@Reenable the test suite.

Fun fact: if bash isn't installed, the test suite will just hang
in select(2) waiting for stdout to become writable. So add shells/bash
to TEST_DEPENDS. (Any brave soul may try this on some linux without
bash, it would be interesting to know wether it hangs there, too)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62 2016/01/31 17:47:49 kili Exp $
d13 2
a14 2
WANTLIB =		c curl>=2 m ncursesw pthread util z
MODULES =		lang/ghc converters/libiconv
d17 2
a18 1
LIB_DEPENDS =		net/curl
@


1.62
log
@Update to darcs-2.10.3.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.61 2015/12/29 12:54:38 kili Exp $
d16 1
a16 1
MODGHC_SETUP_CONF_ARGS =-f 'curl -http -library use-time-1point5 -test'
d35 1
a35 1
			devel/hs-text>=0.11.2.0,<1.3 \
d45 13
a57 2
# Tests Disabled for now, because of additional dependencies.
NO_TEST =		Yes
@


1.61
log
@Update to darcs-2.10.2 and unbreak.

Unfortunately, it doesn't build on i386.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.60 2015/12/23 20:06:28 kili Exp $
d8 1
a8 1
DISTNAME =		darcs-2.10.2
d34 1
a34 1
			devel/hs-tar>=0.4,<0.5 \
d36 1
a36 1
			devel/hs-transformers-compat>=0.4,<0.5 \
@


1.60
log
@Comment BUILD_DEPENDS and TEST_DEPENDS. I want to remove at least
devel/hs-hashed-storage before updating darcs, and maybe some more.
And I don't want to confuse dpb.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59 2015/10/19 21:21:02 kili Exp $
d3 2
a4 1
BROKEN =		needs an update
d8 1
a8 2
DISTNAME =		darcs-2.8.5
REVISION =		0
d16 1
a16 1
MODGHC_SETUP_CONF_ARGS =-f 'curl -http -library test'
d21 23
a43 39
#
# Commented out because I want to mop up a little bit before the update.
#
# BUILD_DEPENDS =		archivers/hs-zlib>=0.5.1.0,<0.6.0.0 \
# 			devel/hs-extensible-exceptions>=0.1,<0.2 \
# 			devel/hs-hashed-storage>=0.5.6,<0.6 \
# 			devel/hs-mmap>=0.5,<0.6 \
# 			devel/hs-mtl>=1.0,<2.3 \
# 			devel/hs-network>=2.2,<2.5 \
# 			devel/hs-parsec>=2.0,<3.2 \
# 			devel/hs-random>=1.0,<1.1 \
# 			devel/hs-regex-compat>=0.95.1 \
# 			devel/hs-tar>=0.3,<0.5 \
# 			devel/hs-text>=0.11.0.6,<1.2 \
# 			devel/hs-utf8-string>=0.3.6,<0.4 \
# 			devel/hs-vector>=0.7 \
# 			www/hs-html>=1.0,<1.1 \
# 			print/texlive/base \
#  			textproc/latex2html \
# 			${RUN_DEPENDS}

# Used for building the test suite (which is done during normal
# build time, not during regress time).
# BUILD_DEPENDS +=	devel/hs-FindBin>=0.0,<0.1 \
# 			devel/hs-QuickCheck>=2.3 \
# 			devel/hs-HUnit>=1.0 \
# 			devel/hs-cmdlib>=0.2.1,<0.4 \
# 			devel/hs-shellish>=0.1.3,<0.2 \
# 			devel/hs-test-framework>=0.4.0 \
# 			devel/hs-test-framework-hunit>=0.2.2 \
# 			devel/hs-test-framework-quickcheck2>=0.2.8

# TEST_DEPENDS =	devel/hs-hlint \
# 			shells/bash \
# 			sysutils/coreutils

# For the documentation
USE_GMAKE =		Yes
PORTHOME =		${WRKDIR}
d45 2
a46 2
post-build:
	@@cd ${WRKBUILD} && exec ${SETENV} ${MAKE_ENV} ${MAKE_PROGRAM} html
a48 2
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/darcs
	cd ${WRKBUILD}/doc/manual && umask 022 && pax -rw . ${PREFIX}/share/doc/darcs
d53 4
@


1.59
log
@Mark as broken until i find the time to update it and
fix all the dependencies.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2015/07/17 21:46:10 jasper Exp $
d21 20
a40 17
BUILD_DEPENDS =		archivers/hs-zlib>=0.5.1.0,<0.6.0.0 \
			devel/hs-extensible-exceptions>=0.1,<0.2 \
			devel/hs-hashed-storage>=0.5.6,<0.6 \
			devel/hs-mmap>=0.5,<0.6 \
			devel/hs-mtl>=1.0,<2.3 \
			devel/hs-network>=2.2,<2.5 \
			devel/hs-parsec>=2.0,<3.2 \
			devel/hs-random>=1.0,<1.1 \
			devel/hs-regex-compat>=0.95.1 \
			devel/hs-tar>=0.3,<0.5 \
			devel/hs-text>=0.11.0.6,<1.2 \
			devel/hs-utf8-string>=0.3.6,<0.4 \
			devel/hs-vector>=0.7 \
			www/hs-html>=1.0,<1.1 \
			print/texlive/base \
 			textproc/latex2html \
			${RUN_DEPENDS}
d44 12
a55 12
BUILD_DEPENDS +=	devel/hs-FindBin>=0.0,<0.1 \
			devel/hs-QuickCheck>=2.3 \
			devel/hs-HUnit>=1.0 \
			devel/hs-cmdlib>=0.2.1,<0.4 \
			devel/hs-shellish>=0.1.3,<0.2 \
			devel/hs-test-framework>=0.4.0 \
			devel/hs-test-framework-hunit>=0.2.2 \
			devel/hs-test-framework-quickcheck2>=0.2.8

TEST_DEPENDS =	devel/hs-hlint \
			shells/bash \
			sysutils/coreutils
@


1.58
log
@drop dependencies on gsed now that our sed can cope with -i
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.57 2014/12/07 19:12:58 kili Exp $
@


1.57
log
@Missed devel/hs-utf8-string as BUILD_DEPENDS.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2014/11/24 16:12:43 kili Exp $
d50 1
a50 2
			sysutils/coreutils \
			textproc/gsed
a69 1
	ln -fs ${LOCALBASE}/bin/gsed ${WRKDIR}/bin/sed
@


1.56
log
@Fix dependencies and bump.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55 2014/10/14 12:28:14 dcoppa Exp $
d30 1
@


1.55
log
@
Bugfix update to darcs-2.8.5
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.54 2014/01/11 18:52:34 edd Exp $
d6 1
a21 1
			devel/hs-haskeline>=0.6.3,<0.8 \
d23 1
a23 1
			devel/hs-mtl>=1.0,<2.2 \
d29 1
a29 2
			devel/hs-terminfo>=0.3,<0.4 \
			devel/hs-text>=0.11.0.6,<0.12.0.0 \
@


1.54
log
@Use the new texlive buildset as a BUILD_DEPEND.

OK espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2013/07/21 13:44:40 kili Exp $
d5 1
a5 2
DISTNAME =		darcs-2.8.4
REVISION =		0
@


1.53
log
@Fix build by adding forgotten build dependency.

Noticed by naddy@@

ok espie@@, naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.52 2013/07/19 07:09:00 kili Exp $
d6 1
d34 1
a34 1
			print/texlive/texmf,-full \
@


1.52
log
@Update to darcs-2.8.4.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 2013/03/11 10:50:02 espie Exp $
d39 2
a40 1
BUILD_DEPENDS +=	devel/hs-QuickCheck>=2.3 \
@


1.51
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2013/01/17 13:19:05 kili Exp $
d5 1
a5 1
DISTNAME =		darcs-2.8.3
d19 1
a19 1
			devel/hs-tar>=0.4,<0.5 \
d21 1
a21 1
			devel/hs-haskeline>=0.6.3,<0.7 \
d24 1
a24 1
			devel/hs-network>=2.2,<2.4 \
d26 3
a28 1
			devel/hs-regex-compat=0.95.1 \
@


1.50
log
@Unbreak with hs-tar-0.4.0.1.

Also, update to darcs-2.8.3.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2012/10/11 13:31:29 dcoppa Exp $
d45 1
a45 1
REGRESS_DEPENDS =	devel/hs-hlint \
d66 1
a66 1
pre-regress:
a71 3
PERMIT_PACKAGE_FTP =	Yes
PERMIT_DISTFILES_CDROM =Yes
PERMIT_DISTFILES_FTP =	Yes
@


1.49
log
@Fix fallout of haskell ports, now that devel/gmp is no more a
dependency for ghc - devel category

ok kili@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2012/09/02 21:58:45 kili Exp $
d5 1
a5 2
DISTNAME =		darcs-2.8.1
REVISION =		0
d19 1
a19 1
			devel/hs-tar>=0.3,<0.4 \
@


1.48
log
@Update to darcs-2.8.1.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2012/05/13 21:27:38 kili Exp $
d6 1
d11 1
a11 1
WANTLIB =		c curl>=2 gmp m ncursesw pthread util z
d15 1
a15 2
LIB_DEPENDS =		devel/gmp \
			net/curl
@


1.47
log
@Add a 0.5 GB build dependency to get a 2.7 kB LaTeX package, which
is required for a successful build and package.

found and ok by jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2012/05/11 20:59:47 kili Exp $
d5 1
a5 2
DISTNAME =		darcs-2.8.0
REVISION =		0
d24 1
a24 1
			devel/hs-mtl>=1.0,<2.1 \
@


1.46
log
@Always use curl (for now) instead of magically using hs-HTTP if
it's installed.

Found while tracking down a completely different problem reported.

"looks good" jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2012/05/09 21:00:20 kili Exp $
d33 1
@


1.45
log
@Update to darcs-2.8.0.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2011/12/31 22:30:49 kili Exp $
d6 1
d14 1
a14 1
MODGHC_SETUP_CONF_ARGS =-f '-library test'
@


1.44
log
@Adjust dependency on hs-regex-compat. Darcs works fine
with the new version.

ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2011/12/27 21:13:09 kili Exp $
d5 1
a5 2
DISTNAME =		darcs-2.5.2
REVISION =		5
d13 1
a13 1
MODGHC_SETUP_CONF_ARGS =-f '-library -threaded'
d19 25
a43 11
BUILD_DEPENDS =		hs-tar->=0.3,<0.4:devel/hs-tar \
			hs-zlib->=0.5.0,<0.6.0:archivers/hs-zlib \
			hs-hashed-storage->=0.5.2,<0.6:devel/hs-hashed-storage \
			hs-haskeline->=0.6.2.2,<0.7:devel/hs-haskeline \
			hs-mtl->=1.0,<2.1:devel/hs-mtl \
			hs-parsec->=2.0,<3.2:devel/hs-parsec \
			hs-regex-compat->=0.71,<0.96:devel/hs-regex-compat \
			hs-text->=0.3:devel/hs-text \
			hs-html->=1.0,<1.1:www/hs-html \
			${RUN_DEPENDS} \
			textproc/latex2html
d46 3
a48 1
			shells/bash
a51 1
USE_GROFF =		Yes
d64 5
@


1.43
log
@Bump to enforce updates.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2011/06/30 21:30:20 kili Exp $
d6 1
a6 1
REVISION =		4
d26 1
a26 1
			hs-regex-compat->=0.71,<0.94:devel/hs-regex-compat \
@


1.42
log
@Bump after ghc update.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2011/04/27 11:19:13 kili Exp $
d6 1
a6 1
REVISION =		3
@


1.41
log
@Save some build time by not building the darcs library at all.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2011/04/26 19:29:16 kili Exp $
d6 1
a6 1
REVISION =		2
@


1.40
log
@This now depends on devel/hs-haskeline. While here, add a version range
matching the .cabal file to the devel/hs-mtl dependency.
(I really have to work on a .cabal => *_DEPENDS tool, and I also should
switch to the more readable stemless dependencies whereever possible,
but on the other hand, this can wait until the next major haskell update)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2011/04/23 14:32:50 kili Exp $
d14 1
a14 1
MODGHC_SETUP_CONF_ARGS =-f '-threaded'
a49 1
	rm -rf ${PREFIX}/lib/${DISTNAME}
@


1.39
log
@Depend on and use mtl-2 from devel/hs-mtl.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2011/04/11 14:59:27 kili Exp $
d6 1
a6 1
REVISION =		1
d23 2
a24 1
			devel/hs-mtl \
@


1.38
log
@Accept hs-parsec-3.1 and bump.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2011/04/05 11:45:14 kili Exp $
d6 1
a6 1
REVISION =		0
d23 1
@


1.37
log
@Update to darcs-2.5.2.

Set PORTHOME to let texlive (called via latex2html) build some fonts.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2010/11/15 19:45:57 espie Exp $
d6 1
d23 1
a23 1
			hs-parsec->=2.0,<3.1:devel/hs-parsec \
@


1.36
log
@move depends to new style
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2010/11/02 20:22:34 kili Exp $
d5 1
a5 1
DISTNAME =		darcs-2.5
d29 2
a30 1
REGRESS_DEPENDS =	shells/bash
d35 1
@


1.35
log
@Update to darcs-2.5.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2010/10/18 17:47:52 espie Exp $
d10 1
a10 1
WANTLIB =		c curl.>=2 gmp m ncursesw pthread util z
d14 2
a15 2
LIB_DEPENDS =		::devel/gmp \
			::net/curl
d19 7
a25 7
BUILD_DEPENDS =		:hs-tar->=0.3,<0.4:devel/hs-tar \
			:hs-zlib->=0.5.0,<0.6.0:archivers/hs-zlib \
			:hs-hashed-storage->=0.5.2,<0.6:devel/hs-hashed-storage \
			:hs-parsec->=2.0,<3.1:devel/hs-parsec \
			:hs-regex-compat->=0.71,<0.94:devel/hs-regex-compat \
			:hs-text->=0.3:devel/hs-text \
			:hs-html->=1.0,<1.1:www/hs-html \
d27 1
a27 1
			::textproc/latex2html
d29 1
a29 1
REGRESS_DEPENDS =	::shells/bash
d33 1
a33 1
USE_GROFF =	Yes
@


1.34
log
@USE_GROFF=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2010/07/17 13:54:30 kili Exp $
d5 1
a5 2
DISTNAME =		darcs-2.4.4
REVISION =		1
d10 1
a10 1
WANTLIB =		c curl.>=2 gmp m ncurses pthread util z
d19 3
a21 2
BUILD_DEPENDS =		:hs-zlib->=0.5.0,<0.6.0:archivers/hs-zlib \
			:hs-hashed-storage-0.4.13:devel/hs-hashed-storage \
d24 1
a34 5
# Weird permission alert!
# http://bugs.darcs.net/issue1815 (it's a bug in Cabal, not in darcs)
post-extract:
	@@chmod -R a+r ${WRKSRC}

d45 1
@


1.33
log
@Switch to REVISION and new WANTLIB/LIB_DEPENDS style.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2010/06/30 15:41:01 kili Exp $
d32 1
@


1.32
log
@WANTLIB += pthread and bump PKGNAME.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2010/06/15 18:00:33 kili Exp $
d6 1
a6 1
PKGNAME =		${DISTNAME}p1
d11 1
a11 1
WANTLIB =		c m ncurses pthread util z
d15 2
a16 2
LIB_DEPENDS =		gmp::devel/gmp \
			curl.>=2::net/curl
@


1.31
log
@Add gmp and bump.
While here, adjust the comment about weird permissions (don't blame
the darcs people, it's not their fault).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2010/05/24 14:33:03 kili Exp $
d6 1
a6 1
PKGNAME =		${DISTNAME}p0
d11 1
a11 1
WANTLIB =		c m ncurses util z
@


1.30
log
@Update to darcs-2.4.4, to let people think I'm not a slacker.

While here, set REGRESS_DEPENDS = ::shells/bash (yes, it really
needs bash).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2010/05/09 17:00:39 kili Exp $
d6 1
d15 2
a16 1
LIB_DEPENDS =		curl.>=2::net/curl
d33 2
a34 1
# Weird permission alert! (still not fixed)
@


1.29
log
@Update to darcs-2.4.3 (bugfix release).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2010/05/06 20:06:28 kili Exp $
d5 1
a5 1
DISTNAME =		darcs-2.4.3
d26 2
d31 1
a31 1
# Weird permission alert! (Hopefully fixed in the next release)
@


1.28
log
@Fix build and adjust wantlib after threading has been disabled in
ghc. While here, rename the `log' matcher to `comment' and add a
little bit of documentation as discussed upstream.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2010/04/25 21:20:45 kili Exp $
d5 1
a5 2
DISTNAME =		darcs-2.4.1
PKGNAME =		${DISTNAME}p1
d19 1
a19 1
			:hs-hashed-storage-0.4.11:devel/hs-hashed-storage \
@


1.27
log
@Add support for matching against log messages.

Now you can check out the latest ghc sources and then run
something like

darcs changes --match 'log "(moose|balls|fuck|shit)"'

(and you'll notice that ghc is far too british)

I've also send a similar patch upstream and hope that it'll
be included in the next darcs release.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2010/04/22 21:53:18 kili Exp $
d6 1
a6 1
PKGNAME =		${DISTNAME}p0
d11 1
a11 1
WANTLIB =		c m ncurses pthread util z
d14 1
@


1.26
log
@Update to darcs-2.4.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2009/10/04 21:16:17 kili Exp $
d6 1
@


1.25
log
@Drop maintainership.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2009/01/25 18:53:33 kili Exp $
d3 1
a3 1
COMMENT=	advanced revision control system written in Haskell
d5 1
a5 2
DISTNAME=	darcs-2.2.0
PKGNAME=	${DISTNAME}p0
d7 41
a47 36
CATEGORIES=	devel
HOMEPAGE=	http://www.darcs.net/
MASTER_SITES=	${HOMEPAGE}

WANTLIB=	c curses crypto idn m pthread ssl z
MODULES=	lang/ghc
MODGHC_RUNTIME=	No
LIB_DEPENDS=	curl.>=2::net/curl \
		gmp::devel/gmp
BUILD_DEPENDS=	${RUN_DEPENDS}

CONFIGURE_STYLE=simple
CONFIGURE_ARGS=	--prefix=${PREFIX} \
		--datadir=${PREFIX}/share \
		--libexecdir=${PREFIX}/libexec/darcs \
		--mandir=${PREFIX}/man \
		--sysconfdir=${PREFIX}/share/darcs \
		--without-manual
CONFIGURE_ENV=	CPPFLAGS="${CPPFLAGS} -I${LOCALBASE}/include" \
		LDFLAGS="${LDFLAGS} -L${LOCALBASE}/lib" CFLAGS="" \
		HOME=/nonexistent \
		AWK=/usr/bin/awk DIFF=/usr/bin/diff GREP=/usr/bin/grep

USE_GMAKE=	Yes
MAKE_FILE=	GNUmakefile
INSTALL_TARGET=	install installserver install-html install-examples
MAKE_ENV+= 	DARCS=${WRKSRC}/darcs
MAKE_FLAGS+=	VERBOSE=Yes
REGRESS_TARGET=	check
REGRESS_DEPENDS=::shells/bash

# GPL
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
@


1.24
log
@
Update to darcs-2.2.0.

ok okan@@ ("works for me as much as i can test")
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2008/10/18 18:58:06 kili Exp $
d6 1
a10 1
MAINTAINER=	Matthias Kilian <kili@@openbsd.org>
@


1.23
log
@
Update to 2.1.0.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2007/12/21 19:38:46 kili Exp $
d5 1
a5 1
DISTNAME=	darcs-2.1.0
a24 1
		--with-curl-pipelining \
d28 1
d33 1
a33 1
INSTALL_TARGET=	install installserver installdocs
@


1.22
log
@
Take maintainership -- Jon Olsson doesn't want to maintain this any
longer.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2007/09/16 02:52:58 merdely Exp $
d5 1
a5 2
DISTNAME=	darcs-1.0.9
PKGNAME=	${DISTNAME}p1
d12 1
d17 1
d25 2
a26 2
		--disable-mmap \
		--without-docs
d29 1
a29 1
		GREP=/usr/bin/grep AWK=/usr/bin/awk
d35 1
d37 1
a43 1
WANTLIB=		c crypto curses idn m ssl z
@


1.21
log
@Remove quotes surrounding COMMENT*/PERMIT_*/BROKEN
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2007/06/21 15:13:45 kili Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p0
d11 1
a11 1
MAINTAINER=	Jon Olsson <jon@@abc.se>
@


1.20
log
@
The distfile changed (found by steven@@).

Some autoconf fallout in generated documentation (and one source
file), so bump the PKGNAME. They even changed the default installation
path of the manpage, which requires an additional tweak to
CONFIGURE_ARGS.

No functional changes; same result for regression tests as before.

While here, force configure to use our grep and the one true awk,
even if g{grep,awk} are installed.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2007/06/06 19:52:17 kili Exp $
d3 1
a3 1
COMMENT=	"advanced revision control system written in Haskell"
@


1.19
log
@
Update to 1.0.9, from Jon Olsson (maintainer).
Tested by me with both ghc-6.2.2 and upcoming ghc-6.6.1 on i386 and
by R.D. Thrush on amd64. Some spaces vs. tabs detected by sturm@@.

ok sturm@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2007/05/14 20:40:15 naddy Exp $
d6 1
d22 1
d27 2
a28 1
		LDFLAGS="${LDFLAGS} -L${LOCALBASE}/lib" CFLAGS=""
@


1.18
log
@chase wantlib changes introduced by curl update
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2007/04/13 03:58:53 steven Exp $
d5 2
a6 2
DISTNAME=	darcs-1.0.8
PKGNAME=	${DISTNAME}p1
d19 5
a23 4
                --datadir=${PREFIX}/share \
                --libexecdir=${PREFIX}/libexec/darcs \
                --sysconfdir=${PREFIX}/share/darcs \
                --disable-mmap
d29 1
a29 1
INSTALL_TARGET= install installserver installdocs
d31 1
a31 1
REGRESS_TARGET= check
@


1.17
log
@change maintainer's email address per his request
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2006/08/01 22:46:16 espie Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p0
d37 1
a37 1
WANTLIB=		c crypto curses m ssl z
@


1.16
log
@new libspecs
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2006/07/30 21:02:32 alek Exp $
d6 1
d10 1
a10 1
MAINTAINER=	Jon Olsson <jon@@vexed.se>
@


1.15
log
@Update to 1.0.8

From new maintainer Jon Olsson <jon@@vexed.se>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2005/11/17 09:31:16 dons Exp $
d13 1
a13 1
LIB_DEPENDS=	curl.2::net/curl \
@


1.14
log
@Update to darcs 1.0.4
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2005/05/26 01:45:38 dons Exp $
d5 1
a5 2
V=		1.0.4
DISTNAME=	darcs-${V}
d9 1
a9 1
MAINTAINER=	Don Stewart <dons@@openbsd.org>
d12 3
a14 1
LIB_DEPENDS=	curl.2::net/curl
d36 1
a36 1
WANTLIB=		c crypto curses gmp m ncurses pthread readline ssl z
@


1.13
log
@Update to latest stable.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2005/05/16 03:17:28 dons Exp $
d5 1
a5 1
V=		1.0.3
d16 5
a20 2
CONFIGURE_ARGS=	--prefix=${PREFIX} --datadir=${PREFIX}/share \
                --libexecdir=${PREFIX}/libexec/darcs --sysconfdir=${PREFIX}/share/darcs
@


1.12
log
@Update.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2005/05/09 03:41:34 dons Exp $
d5 1
a5 1
V=		1.0.3rc2
@


1.11
log
@Update to darcs-1.0.3rc1.
Cleaner installation settings by using simple configure style.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2005/02/14 01:59:12 dons Exp $
d5 1
a5 1
V=		1.0.3rc1
@


1.10
log
@Update darcs to 1.0.2. Fixes stability issues, should close PR 4074.

ok sturm@@ pvalchev@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2004/11/23 11:22:01 espie Exp $
d5 1
a5 1
V=		1.0.2
a7 1

a9 1

d15 3
a17 2
CONFIGURE_STYLE=gnu
CONFIGURE_ARGS=	--datadir=${PREFIX}/share --libexecdir=${PREFIX}/libexec
d19 1
a19 2
		LDFLAGS="${LDFLAGS} -L${LOCALBASE}/lib" \
		CFLAGS=""
d25 1
@


1.10.2.1
log
@bump PKGNAMEs for new packages after libcurl update

discussed with pval
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2005/02/14 01:59:12 dons Exp $
a6 1
PKGNAME=	${DISTNAME}p0
@


1.9
log
@WANTLIB markers
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2004/10/09 10:06:17 sturm Exp $
d5 1
a5 1
V=		0.9.23
d9 1
a9 1
HOMEPAGE=	http://www.abridgegame.org/darcs/
d17 1
a17 1
CONFIGURE_STYLE= gnu
d26 1
@


1.8
log
@install documentation regardless of latex being around or not

from maintainer dons at cse.unsw.edu.au (Donald Bruce Stewart)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2004/08/10 08:23:37 xsa Exp $
d32 1
@


1.7
log
@
MODULES= lang/ghc
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2004/07/31 03:18:29 dons Exp $
d25 1
a25 1
INSTALL_TARGET= install installserver
@


1.6
log
@Update darcs to 0.9.23

ok pvalchev@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2004/05/18 23:26:33 dons Exp $
d14 1
a14 1
MODULES=	ghc
@


1.5
log
@Update darcs to 0.9.20, bug fix release

ok pvalchev@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2004/04/29 03:49:51 dons Exp $
d5 1
a5 1
V=		0.9.20
@


1.4
log
@Update darcs to 0.9.19.
Now builds with latest GHC, and works on amd64
Change maintainer to me.

ok @@avsm
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2003/08/03 18:16:46 avsm Exp $
d5 1
a5 1
V=		0.9.19
@


1.3
log
@update to darcs-0.9.12
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2003/07/23 18:27:53 avsm Exp $
d5 1
a5 1
V=		0.9.12
d12 1
a12 1
MAINTAINER=	Anil Madhavapeddy <avsm@@openbsd.org>
a15 1
BUILD_DEPENDS+=	latex::print/teTeX/base
d18 1
a18 1
CONFIGURE_ARGS=	--datadir=${PREFIX}/share
@


1.2
log
@use the ghc module, which cleans up the various depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2003/07/20 03:55:46 avsm Exp $
d5 1
a5 1
V=		0.9.11
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d14 1
a14 3
# ghc only works on i386 at the moment
ONLY_FOR_ARCHS=	i386

d16 1
a16 2
BUILD_DEPENDS=	ghc::lang/ghc \
		latex::print/teTeX/base
@


1.1.1.1
log
@initial import of darcs-0.9.11

any rcs with a formal theory of patches is worth looking at :)
http://abridgegame.org/darcs/manual/node7.html

--
Darcs is a revision control system, along the lines of CVS or arch.
That means that it keeps track of various revisions and branches
of your project, allows for changes to propogate from one branch
to another.  Darcs is intended to be an ``advanced'' revision control
system.

Darcs has two particularly distinctive features which differ from
other revision control systems: 1) each copy of the source is a
fully functional branch, and 2) underlying darcs is a consistent
and powerful theory of patches.

@
text
@@
