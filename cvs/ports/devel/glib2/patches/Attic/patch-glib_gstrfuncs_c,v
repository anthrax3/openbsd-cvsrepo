head	1.15;
access;
symbols
	OPENBSD_5_6:1.14.0.2
	OPENBSD_5_6_BASE:1.14
	OPENBSD_5_0:1.10.0.4
	OPENBSD_5_0_BASE:1.10
	OPENBSD_4_9:1.10.0.2
	OPENBSD_4_9_BASE:1.10
	OPENBSD_4_8:1.9.0.4
	OPENBSD_4_8_BASE:1.9
	OPENBSD_4_7:1.9.0.2
	OPENBSD_4_7_BASE:1.9
	OPENBSD_4_6:1.8.0.4
	OPENBSD_4_6_BASE:1.8
	OPENBSD_4_5:1.8.0.2
	OPENBSD_4_5_BASE:1.8
	OPENBSD_4_4:1.7.0.2
	OPENBSD_4_4_BASE:1.7
	OPENBSD_4_3:1.6.0.2
	OPENBSD_4_3_BASE:1.6
	OPENBSD_4_2:1.4.0.2
	OPENBSD_4_2_BASE:1.4
	OPENBSD_4_1:1.3.0.6
	OPENBSD_4_1_BASE:1.3
	OPENBSD_4_0:1.3.0.4
	OPENBSD_4_0_BASE:1.3
	OPENBSD_3_9:1.3.0.2
	OPENBSD_3_9_BASE:1.3
	OPENBSD_3_8:1.2.0.2
	OPENBSD_3_8_BASE:1.2;
locks; strict;
comment	@# @;


1.15
date	2014.09.20.16.23.45;	author ajacoutot;	state dead;
branches;
next	1.14;
commitid	TzZM8RWvDdhDTpaT;

1.14
date	2014.04.10.14.19.38;	author ajacoutot;	state Exp;
branches;
next	1.13;

1.13
date	2014.04.10.05.43.26;	author ajacoutot;	state Exp;
branches;
next	1.12;

1.12
date	2011.10.07.17.19.51;	author ajacoutot;	state dead;
branches;
next	1.11;

1.11
date	2011.09.20.21.09.34;	author ajacoutot;	state Exp;
branches;
next	1.10;

1.10
date	2010.09.30.07.17.19;	author ajacoutot;	state Exp;
branches;
next	1.9;

1.9
date	2009.07.12.20.38.09;	author ajacoutot;	state Exp;
branches;
next	1.8;

1.8
date	2008.10.27.21.28.01;	author landry;	state Exp;
branches;
next	1.7;

1.7
date	2008.04.09.13.10.17;	author jasper;	state Exp;
branches;
next	1.6;

1.6
date	2007.12.05.14.31.24;	author steven;	state Exp;
branches;
next	1.5;

1.5
date	2007.10.24.22.29.03;	author jasper;	state Exp;
branches;
next	1.4;

1.4
date	2007.04.23.16.22.07;	author jasper;	state Exp;
branches;
next	1.3;

1.3
date	2005.11.13.06.22.03;	author marcm;	state Exp;
branches;
next	1.2;

1.2
date	2005.05.24.21.26.17;	author marcm;	state Exp;
branches;
next	1.1;

1.1
date	2005.04.14.17.06.18;	author espie;	state Exp;
branches;
next	;


desc
@@


1.15
log
@Update to glib2-2.40.1.
@
text
@$OpenBSD: patch-glib_gstrfuncs_c,v 1.14 2014/04/10 14:19:38 ajacoutot Exp $

From eec507c15987388ae624eada236032e700bf8c50 Mon Sep 17 00:00:00 2001
From: Dan Winship <danw@@gnome.org>
Date: Wed, 9 Apr 2014 09:57:46 -0400
Subject: g_str_has_prefix: don't call strlen(str)

--- glib/gstrfuncs.c.orig	Sat Feb 22 16:29:07 2014
+++ glib/gstrfuncs.c	Thu Apr 10 07:39:50 2014
@@@@ -2794,19 +2794,10 @@@@ gboolean
 g_str_has_prefix (const gchar *str,
                   const gchar *prefix)
 {
-  int str_len;
-  int prefix_len;
-
   g_return_val_if_fail (str != NULL, FALSE);
   g_return_val_if_fail (prefix != NULL, FALSE);
 
-  str_len = strlen (str);
-  prefix_len = strlen (prefix);
-
-  if (str_len < prefix_len)
-    return FALSE;
-
-  return strncmp (str, prefix, prefix_len) == 0;
+  return strncmp (str, prefix, strlen (prefix)) == 0;
 }
 
 /**
@


1.14
log
@Committed upstream.
@
text
@d1 1
a1 1
$OpenBSD: patch-glib_gstrfuncs_c,v 1.13 2014/04/10 05:43:26 ajacoutot Exp $
@


1.13
log
@g_str_has_prefix: don't call strlen(str) (BZ #727890).
This prevents a segfault when using WebKit browsers.
@
text
@d1 1
a1 1
$OpenBSD$
d3 4
a6 1
https://bugzilla.gnome.org/show_bug.cgi?id=727890
@


1.12
log
@Enable all regress tests.
Remove some _g_snprintf patches that were left over.
@
text
@d1 15
a15 6
$OpenBSD: patch-glib_gstrfuncs_c,v 1.11 2011/09/20 21:09:34 ajacoutot Exp $
--- glib/gstrfuncs.c.orig	Sun Sep 18 08:12:24 2011
+++ glib/gstrfuncs.c	Mon Sep 19 23:11:45 2011
@@@@ -1392,7 +1392,7 @@@@ g_strerror (gint errnum)
       g_static_private_set (&msg_private, msg, g_free);
     }
d17 9
a25 8
-  _g_sprintf (msg, "unknown error (%d)", errnum);
+  _g_snprintf (msg, 64, "unknown error (%d)", errnum);
 
   errno = saved_errno;
   return msg;
@@@@ -1556,7 +1556,7 @@@@ extern const char *strsignal(int);
       g_static_private_set (&msg_private, msg, g_free);
     }
d27 1
a27 5
-  _g_sprintf (msg, "unknown signal (%d)", signum);
+  _g_snprintf (msg, 64, "unknown signal (%d)", signum);
 
   return msg;
 }
@


1.11
log
@Update to glib2-2.29.92 (2.30 coming in the next few days).
Committing now (along with upcoming atk, pango and gtk+3 updates) during
the hackathon where we have time to fix all the eventual fallout (bulk
running).

ok jasper@@ robert@@
@
text
@d1 1
a1 1
$OpenBSD: patch-glib_gstrfuncs_c,v 1.10 2010/09/30 07:17:19 ajacoutot Exp $
@


1.10
log
@*** HEADS UP!

Major update to glib2-2.26.0.
This starts a flood commit of several big updates (gtk+2 and GNOME 2.32).

Please note that there will be some WANTLIB/DEPENDS breakage probably,
this went into several bulks but it's impossible to catch everything.
Any gtk+2/glib2 related build failures, please talk to me or jasper@@

The ports tree is expected to be in a unconsistent state for a couple of
days to give us time to fix everything we didn't spot or any runtime
issue with the latest GNOME.
We do this now so that we have packages with all the latest major bumped
libraries at p2k10.

Thanks to landry@@ and his zomg!cluster for the bulks and reports.

ok jasper@@
@
text
@d1 4
a4 4
$OpenBSD: patch-glib_gstrfuncs_c,v 1.9 2009/07/12 20:38:09 ajacoutot Exp $
--- glib/gstrfuncs.c.orig	Mon Sep 13 17:57:51 2010
+++ glib/gstrfuncs.c	Mon Sep 27 14:44:40 2010
@@@@ -1394,7 +1394,7 @@@@ g_strerror (gint errnum)
d13 1
a13 1
@@@@ -1558,7 +1558,7 @@@@ extern const char *strsignal(int);
@


1.9
log
@- major update to glib2-2.20.4
- add missing REGRESS_DEPENDS

*remove previous version before trying to compile this*

Report any failure directly to me please.

tested by landry@@ on a sparc64 bulk, thanks!
ok jasper@@ on a previous diff
@
text
@d1 4
a4 4
$OpenBSD: patch-glib_gstrfuncs_c,v 1.8 2008/10/27 21:28:01 landry Exp $
--- glib/gstrfuncs.c.orig	Wed Apr  1 01:04:20 2009
+++ glib/gstrfuncs.c	Thu Jun 11 14:15:29 2009
@@@@ -1381,7 +1381,7 @@@@ g_strerror (gint errnum)
d13 1
a13 1
@@@@ -1545,7 +1545,7 @@@@ extern const char *strsignal(int);
d19 1
a19 1
   
@


1.8
log
@Major upgrade to glib 2.18.2.
It's the perfect timing to slap it in now during p2k8, and it paves the way
for the incoming gtk 2.14.4 upgrade.
Tested by bernd@@ in a mulk muild.

ok ajacoutot@@ bernd@@ 'go ahead' jasper@@
@
text
@d1 4
a4 4
$OpenBSD: patch-glib_gstrfuncs_c,v 1.7 2008/04/09 13:10:17 jasper Exp $
--- glib/gstrfuncs.c.orig	Thu Oct 16 16:31:58 2008
+++ glib/gstrfuncs.c	Sat Oct 18 16:46:26 2008
@@@@ -1313,7 +1313,7 @@@@ g_strerror (gint errnum)
d13 1
a13 1
@@@@ -1463,7 +1463,7 @@@@ extern const char *strsignal(int);
@


1.7
log
@- update glib2 to 2.16.1

lots of changes, most importantly, the addition of GIO (VFS API to replace
GnomeVFS).

testing and feedback by many, thanks!

ok landry@@ merdely@@ simon@@
"go ahead" bernd@@ steven@@

(diffs to unbreak some ports will follow)
@
text
@d1 4
a4 4
$OpenBSD: patch-glib_gstrfuncs_c,v 1.6 2007/12/05 14:31:24 steven Exp $
--- glib/gstrfuncs.c.orig	Mon Feb 11 18:14:22 2008
+++ glib/gstrfuncs.c	Fri Feb 22 11:40:05 2008
@@@@ -1311,7 +1311,7 @@@@ g_strerror (gint errnum)
d13 1
a13 1
@@@@ -1461,7 +1461,7 @@@@ extern const char *strsignal(int);
@


1.6
log
@maintenance update to 2.14.4
@
text
@d1 4
a4 4
$OpenBSD: patch-glib_gstrfuncs_c,v 1.5 2007/10/24 22:29:03 jasper Exp $
--- glib/gstrfuncs.c.orig	Sat Nov 24 07:40:59 2007
+++ glib/gstrfuncs.c	Sun Nov 25 22:47:55 2007
@@@@ -1310,7 +1310,7 @@@@ g_strerror (gint errnum)
d13 1
a13 1
@@@@ -1460,7 +1460,7 @@@@ extern const char *strsignal(int);
@


1.5
log
@- update glib2 to 2.14.2
- don't use the local pcre, but use pcre from ports

with tweaks from wilfried@@ (pcre and static libs)
ok steven@@
@
text
@d1 4
a4 4
$OpenBSD: patch-glib_gstrfuncs_c,v 1.4 2007/04/23 16:22:07 jasper Exp $
--- glib/gstrfuncs.c.orig	Sun Sep 16 18:28:33 2007
+++ glib/gstrfuncs.c	Tue Oct  2 20:47:04 2007
@@@@ -1308,7 +1308,7 @@@@ g_strerror (gint errnum)
d13 1
a13 1
@@@@ -1458,7 +1458,7 @@@@ extern const char *strsignal(int);
@


1.4
log
@update glib2 to 2.12.11

based on diffs by alek@@

ok'd by several, "go ahead" steven@@
tested by many, thanks!
@
text
@d1 4
a4 4
$OpenBSD: patch-glib_gstrfuncs_c,v 1.3 2005/11/13 06:22:03 marcm Exp $
--- glib/gstrfuncs.c.orig	Fri Mar  9 05:01:39 2007
+++ glib/gstrfuncs.c	Fri Apr 20 19:02:41 2007
@@@@ -1280,7 +1280,7 @@@@ g_strerror (gint errnum)
d13 1
a13 1
@@@@ -1430,7 +1430,7 @@@@ extern const char *strsignal(int);
@


1.3
log
@Update glib2 to 2.8.3.  Part of the update to the GTK 2.8 series.

Glib 2.8 Release notes are here:
http://mail.gnome.org/archives/gnome-announce-list/2005-August/msg00048.html
@
text
@d1 4
a4 4
$OpenBSD: patch-glib_gstrfuncs_c,v 1.2 2005/05/24 21:26:17 marcm Exp $
--- glib/gstrfuncs.c.orig	Mon Sep 26 07:47:16 2005
+++ glib/gstrfuncs.c	Sun Oct  2 07:38:59 2005
@@@@ -1209,7 +1209,7 @@@@ g_strerror (gint errnum)
d13 1
a13 1
@@@@ -1359,7 +1359,7 @@@@ extern const char *strsignal(int);
@


1.2
log
@Update to 2.6.4, part of GTK+ 2.6 and Gnome 2.10
@
text
@d1 4
a4 4
$OpenBSD: patch-glib_gstrfuncs_c,v 1.1 2005/04/14 17:06:18 espie Exp $
--- glib/gstrfuncs.c.orig	Sun Mar 13 20:02:07 2005
+++ glib/gstrfuncs.c	Sat Apr 16 19:13:32 2005
@@@@ -1206,7 +1206,7 @@@@ g_strerror (gint errnum)
d13 1
a13 1
@@@@ -1356,7 +1356,7 @@@@ extern const char *strsignal(int);
@


1.1
log
@sprintf/strcpy stuff in glib2
okay naddy@@, a while ago...
@
text
@d1 4
a4 4
$OpenBSD$
--- glib/gstrfuncs.c.orig	Fri Sep 17 03:15:13 2004
+++ glib/gstrfuncs.c	Mon Mar 14 13:00:31 2005
@@@@ -1199,7 +1199,7 @@@@ g_strerror (gint errnum)
d13 1
a13 1
@@@@ -1349,7 +1349,7 @@@@ extern const char *strsignal(int);
@

