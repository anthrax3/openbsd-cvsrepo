head	1.3;
access;
symbols
	OPENBSD_4_7:1.1.0.8
	OPENBSD_4_7_BASE:1.1
	OPENBSD_4_6:1.1.0.6
	OPENBSD_4_6_BASE:1.1
	OPENBSD_4_5:1.1.0.4
	OPENBSD_4_5_BASE:1.1
	OPENBSD_4_4:1.1.0.2
	OPENBSD_4_4_BASE:1.1;
locks; strict;
comment	@# @;


1.3
date	2010.07.09.15.19.31;	author sthen;	state dead;
branches;
next	1.2;

1.2
date	2010.07.09.09.20.53;	author sthen;	state Exp;
branches;
next	1.1;

1.1
date	2008.03.31.21.19.17;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.3
log
@zap empty patches; pointed out by Brad
@
text
@@


1.2
log
@update sdl-image to 1.2.10, from Brad, tested in bulk build by landry@@
@
text
@@


1.1
log
@SECURITY FIX for http://secunia.com/advisories/28640/

Patches were taken from libsdl's svn.
@
text
@a0 29
$OpenBSD$
--- IMG_lbm.c.orig	Fri Mar 28 18:37:11 2008
+++ IMG_lbm.c	Fri Mar 28 18:39:09 2008
@@@@ -30,6 +30,7 @@@@
    EHB and HAM (specific Amiga graphic chip modes) support added by Marc Le Douarain
    (http://www.multimania.com/mavati) in December 2003.
    Stencil and colorkey fixes by David Raulo (david.raulo AT free DOT fr) in February 2004.
+   Buffer overflow fix in RLE decompression by David Raulo in January 2008.
 */
 
 #include <stdio.h>
@@@@ -321,7 +322,7 @@@@ SDL_Surface *IMG_LoadLBM_RW( SDL_RWops *src )
 						count ^= 0xFF;
 						count += 2; /* now it */
 
-						if ( !SDL_RWread( src, &color, 1, 1 ) )
+						if ( ( count > remainingbytes ) || !SDL_RWread( src, &color, 1, 1 ) )
 						{
 						   error="error reading BODY chunk";
 							goto done;
@@@@ -332,7 +333,7 @@@@ SDL_Surface *IMG_LoadLBM_RW( SDL_RWops *src )
 					{
 						++count;
 
-						if ( !SDL_RWread( src, ptr, count, 1 ) )
+						if ( ( count > remainingbytes ) || !SDL_RWread( src, ptr, count, 1 ) )
 						{
 						   error="error reading BODY chunk";
 							goto done;
@

