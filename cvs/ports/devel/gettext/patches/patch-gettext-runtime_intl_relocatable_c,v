head	1.5;
access;
symbols
	OPENBSD_6_1:1.5.0.8
	OPENBSD_6_1_BASE:1.5
	OPENBSD_6_0:1.5.0.6
	OPENBSD_6_0_BASE:1.5
	OPENBSD_5_9:1.5.0.2
	OPENBSD_5_9_BASE:1.5
	OPENBSD_5_8:1.5.0.4
	OPENBSD_5_8_BASE:1.5
	OPENBSD_5_7:1.4.0.10
	OPENBSD_5_7_BASE:1.4
	OPENBSD_5_6:1.4.0.8
	OPENBSD_5_6_BASE:1.4
	OPENBSD_5_5:1.4.0.6
	OPENBSD_5_5_BASE:1.4
	OPENBSD_5_4:1.4.0.4
	OPENBSD_5_4_BASE:1.4
	OPENBSD_5_3:1.4.0.2
	OPENBSD_5_3_BASE:1.4
	OPENBSD_5_2:1.3.0.12
	OPENBSD_5_2_BASE:1.3
	OPENBSD_5_1_BASE:1.3
	OPENBSD_5_1:1.3.0.8
	OPENBSD_5_0:1.3.0.6
	OPENBSD_5_0_BASE:1.3
	OPENBSD_4_9:1.3.0.4
	OPENBSD_4_9_BASE:1.3
	OPENBSD_4_8:1.3.0.2
	OPENBSD_4_8_BASE:1.3
	OPENBSD_4_7:1.2.0.10
	OPENBSD_4_7_BASE:1.2
	OPENBSD_4_6:1.2.0.8
	OPENBSD_4_6_BASE:1.2
	OPENBSD_4_5:1.2.0.6
	OPENBSD_4_5_BASE:1.2
	OPENBSD_4_4:1.2.0.4
	OPENBSD_4_4_BASE:1.2
	OPENBSD_4_3:1.2.0.2
	OPENBSD_4_3_BASE:1.2
	OPENBSD_4_2:1.1.0.8
	OPENBSD_4_2_BASE:1.1
	OPENBSD_4_1:1.1.0.6
	OPENBSD_4_1_BASE:1.1
	OPENBSD_4_0:1.1.0.4
	OPENBSD_4_0_BASE:1.1
	OPENBSD_3_9:1.1.0.2
	OPENBSD_3_9_BASE:1.1;
locks; strict;
comment	@# @;


1.5
date	2015.07.19.23.46.08;	author naddy;	state Exp;
branches;
next	1.4;
commitid	IyS3g0JqidQTnmPw;

1.4
date	2013.01.21.22.08.52;	author naddy;	state Exp;
branches;
next	1.3;

1.3
date	2010.07.03.03.23.22;	author naddy;	state Exp;
branches;
next	1.2;

1.2
date	2007.08.25.13.48.23;	author naddy;	state Exp;
branches;
next	1.1;

1.1
date	2005.11.05.23.47.58;	author naddy;	state Exp;
branches;
next	;


desc
@@


1.5
log
@Split gettext into a small runtime component and a separate large
set of development tools as recommended by upstream.

Ports will continue to depend on devel/gettext for libintl.  The
gettext module also provides an automatic build dependency on
devel/gettext-tools for msgfmt etc.

A few ports that require a library provided by gettext-tools get a
corresponding dependency.

Also update gettext to 0.19.5.1.

COMMENT and DESCR from FreeBSD.  Bulk build testing by sthen@@.

ok sthen@@
@
text
@$OpenBSD: patch-gettext-runtime_intl_relocatable_c,v 1.4 2013/01/21 22:08:52 naddy Exp $
--- gettext-runtime/intl/relocatable.c.orig	Fri Jun  5 09:01:10 2015
+++ gettext-runtime/intl/relocatable.c	Sat Jul 18 19:13:09 2015
@@@@ -510,13 +510,17 @@@@ relocate (const char *pathname)
       if (pathname[orig_prefix_len] == '\0')
         {
           /* pathname equals orig_prefix.  */
-          char *result = (char *) xmalloc (strlen (curr_prefix) + 1);
+          char *result;
+          size_t len;
 
+          len = strlen (curr_prefix) + 1;
+          result = (char *) xmalloc (len);
+
 #ifdef NO_XMALLOC
           if (result != NULL)
 #endif
             {
-              strcpy (result, curr_prefix);
+              strlcpy (result, curr_prefix, len);
               return result;
             }
         }
@@@@ -524,15 +528,19 @@@@ relocate (const char *pathname)
         {
           /* pathname starts with orig_prefix.  */
           const char *pathname_tail = &pathname[orig_prefix_len];
-          char *result =
-            (char *) xmalloc (curr_prefix_len + strlen (pathname_tail) + 1);
+          char *result;
+          size_t len;
 
+          len = curr_prefix_len + strlen (pathname_tail) + 1;
+          result = (char *) xmalloc (len);
+
 #ifdef NO_XMALLOC
           if (result != NULL)
 #endif
             {
               memcpy (result, curr_prefix, curr_prefix_len);
-              strcpy (result + curr_prefix_len, pathname_tail);
+              result[curr_prefix_len] = '\0';
+              strlcat (result, pathname_tail, len);
               return result;
             }
         }
@


1.4
log
@maintenance update to 0.18.2
@
text
@d1 4
a4 4
$OpenBSD: patch-gettext-runtime_intl_relocatable_c,v 1.3 2010/07/03 03:23:22 naddy Exp $
--- gettext-runtime/intl/relocatable.c.orig	Tue Dec  4 07:28:58 2012
+++ gettext-runtime/intl/relocatable.c	Wed Jan 16 23:06:10 2013
@@@@ -462,13 +462,17 @@@@ relocate (const char *pathname)
d24 1
a24 1
@@@@ -476,15 +480,19 @@@@ relocate (const char *pathname)
@


1.3
log
@update to 0.18.1
@
text
@d1 4
a4 4
$OpenBSD: patch-gettext-runtime_intl_relocatable_c,v 1.2 2007/08/25 13:48:23 naddy Exp $
--- gettext-runtime/intl/relocatable.c.orig	Sat Dec 12 16:08:01 2009
+++ gettext-runtime/intl/relocatable.c	Tue Jun 29 00:13:57 2010
@@@@ -459,13 +459,17 @@@@ relocate (const char *pathname)
d24 1
a24 1
@@@@ -473,15 +477,19 @@@@ relocate (const char *pathname)
@


1.2
log
@update to 0.16.1; mostly c2k7 work
@
text
@d1 10
a10 14
$OpenBSD: patch-gettext-runtime_intl_relocatable_c,v 1.1 2005/11/05 23:47:58 naddy Exp $
--- gettext-runtime/intl/relocatable.c.orig	Mon Nov 27 18:02:00 2006
+++ gettext-runtime/intl/relocatable.c	Wed Aug  1 17:17:41 2007
@@@@ -448,15 +448,19 @@@@ relocate (const char *pathname)
 	{
 	  /* pathname starts with orig_prefix.  */
 	  const char *pathname_tail = &pathname[orig_prefix_len];
-	  char *result =
-	    (char *) xmalloc (curr_prefix_len + strlen (pathname_tail) + 1);
+	  size_t len;
+	  char *result;
+	  
+	  len = curr_prefix_len + strlen (pathname_tail) + 1;
+	  result = (char *) xmalloc (len);
d12 3
d16 1
a16 1
 	  if (result != NULL)
d18 29
a46 8
 	    {
 	      memcpy (result, curr_prefix, curr_prefix_len);
-	      strcpy (result + curr_prefix_len, pathname_tail);
+	      result[curr_prefix_len] = '\0';
+	      strlcat (result, pathname_tail, len);
 	      return result;
 	    }
 	}
@


1.1
log
@MAJOR update to 0.14.5.  Help and ok espie@@
@
text
@d1 4
a4 4
$OpenBSD$
--- gettext-runtime/intl/relocatable.c.orig	Wed Nov  2 21:45:39 2005
+++ gettext-runtime/intl/relocatable.c	Wed Nov  2 21:48:14 2005
@@@@ -429,15 +429,19 @@@@ relocate (const char *pathname)
@

