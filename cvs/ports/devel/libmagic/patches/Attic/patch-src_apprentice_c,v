head	1.2;
access;
symbols
	OPENBSD_4_1:1.1.1.1.0.4
	OPENBSD_4_1_BASE:1.1.1.1
	OPENBSD_4_0:1.1.1.1.0.2
	OPENBSD_4_0_BASE:1.1.1.1
	jolan_20060414:1.1.1.1
	jolan:1.1.1;
locks; strict;
comment	@# @;


1.2
date	2007.03.17.21.43.20;	author jolan;	state dead;
branches;
next	1.1;

1.1
date	2006.04.14.17.02.58;	author jolan;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2006.04.14.17.02.58;	author jolan;	state Exp;
branches;
next	;


desc
@@


1.2
log
@update to 4.20, from maintainer rui reis
@
text
@$OpenBSD: patch-src_apprentice_c,v 1.1 2006/04/14 17:02:58 jolan Exp $
--- src/apprentice.c.orig	Sat Apr  1 20:32:37 2006
+++ src/apprentice.c	Sat Apr  1 20:57:19 2006
@@@@ -386,6 +386,8 @@@@ apprentice_file(struct magic_set *ms, st
 		file_oomem(ms);
 		return -1;
 	}
+
+	memset(marray, 0x0, maxmagic * sizeof(*marray));
 	marraycount = 0;
 
 	/* print silly verbose header for USG compat. */
@@@@ -892,8 +894,8 @@@@ GetDesc:
 		m->nospflag = 1;
 	} else
 		m->nospflag = 0;
-	while ((m->desc[i++] = *l++) != '\0' && i < MAXDESC)
-		/* NULLBODY */;
+
+	strlcpy(m->desc, l, sizeof(m->desc));
 
 	if (ms->flags & MAGIC_CHECK) {
 		if (!check_format(ms, m))
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
$OpenBSD$
@


1.1.1.1
log
@libmagic-4.17, library to determine file type
@
text
@@
