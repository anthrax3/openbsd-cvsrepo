head	1.6;
access;
symbols
	OPENBSD_6_1:1.6.0.2
	OPENBSD_6_1_BASE:1.6
	OPENBSD_6_0:1.5.0.4
	OPENBSD_6_0_BASE:1.5
	OPENBSD_5_9:1.5.0.2
	OPENBSD_5_9_BASE:1.5
	OPENBSD_5_8:1.3.0.4
	OPENBSD_5_8_BASE:1.3
	jasper_20152107:1.1.1.1
	jasper:1.1.1;
locks; strict;
comment	@# @;


1.6
date	2017.01.24.00.43.43;	author jca;	state Exp;
branches;
next	1.5;
commitid	xPzHhzYZvB55j5ry;

1.5
date	2015.09.25.10.16.13;	author ajacoutot;	state Exp;
branches;
next	1.4;
commitid	lpAWs0tgHRN9SUGy;

1.4
date	2015.09.24.17.33.14;	author sthen;	state Exp;
branches;
next	1.3;
commitid	15dHf2cJWOtydcKR;

1.3
date	2015.08.02.12.57.12;	author jasper;	state Exp;
branches;
next	1.2;
commitid	oyXUpv3oB0dGz8jF;

1.2
date	2015.07.21.16.24.50;	author jasper;	state Exp;
branches;
next	1.1;
commitid	hlSxs4E1e882yfZo;

1.1
date	2015.07.21.15.51.37;	author jasper;	state Exp;
branches
	1.1.1.1;
next	;
commitid	12LXwZHpZ36LlIBB;

1.1.1.1
date	2015.07.21.15.51.37;	author jasper;	state Exp;
branches;
next	;
commitid	12LXwZHpZ36LlIBB;


desc
@@


1.6
log
@BROKEN on alpha

relocation truncated to fit: GPRELHIGH against symbol `default_target_hard_regs' defined in .bss section in libbackend.a(reginfo.o)
@
text
@# $OpenBSD: Makefile,v 1.5 2015/09/25 10:16:13 ajacoutot Exp $

BROKEN-alpha =	relocation truncated to fit: GPRELHIGH against symbol default_target_hard_regs

COMMENT =		TI's open source compiler for MSP430 microcontrollers#'

V =			3_03_04_00
REVISION =		1
PKGNAME =		ti-msp430gcc-${V:S/_/./g}
GCC_V =			4.9.1
CATEGORIES =		devel

HOMEPAGE =		http://www.ti.com/tool/msp430-gcc-opensource

# GPLv2+BSD
PERMIT_PACKAGE_CDROM =	Yes

MASTER_SITES =		http://software-dl.ti.com/msp430/msp430_public_sw/mcu/msp430/MSPGCC/$V/exports/
DIST_SUBDIR =		ti-msp430gcc-$V
DISTFILES =		msp430-gcc-source.tar.bz2 \
			msp430-gcc-support-files.zip

WANTLIB += c gmp m mpc mpfr stdc++ z

BUILD_DEPENDS =		archivers/bzip2 \
			archivers/unzip \
			devel/autogen
BUILD_DEPENDS +=	sysutils/coreutils # autoconf picks up gmkdir
LIB_DEPENDS =		devel/libmpc

CONFIGURE_STYLE =	gnu
CONFIGURE_ARGS =	--target=msp430-none-elf \
			--program-prefix=msp430- \
			--enable-languages=c \
			--disable-nls \
			--with-mpc=${LOCALBASE} \
			--with-mpfr=${LOCALBASE} \
			--with-gmp=${LOCALBASE} \
			--disable-lto
# Prevents building gdbtk, and a whole bunch of patching
CONFIGURE_ARGS +=	--without-x
CONFIGURE_ENV =		TARGET=msp430-none-elf

USE_GMAKE =		Yes
SEPARATE_BUILD =	Yes

SUBST_VARS +=		DESTDIR GCC_V

WRKSRC =		${WRKDIR}/sources/tools/

post-extract:
.for c in dejagnu intl itcl tcl tk
	rm -r ${WRKSRC}/$c
.endfor

post-patch:
	cd ${WRKSRC} && autogen Makefile.def

pre-configure:
	${SUBST_CMD} ${WRKSRC}/libgloss/msp430/Makefile.in

post-install:
	rm ${PREFIX}/info/*
	${INSTALL_SCRIPT} ${WRKDIR}/msp430-gcc-support-files/*.ld \
		${PREFIX}/msp430-none-elf/lib/430/
	${INSTALL_DATA} ${WRKDIR}/msp430-gcc-support-files/*.h \
		${PREFIX}/msp430-none-elf/include

.include <bsd.port.mk>
@


1.5
log
@Unbreak: previous commit removed all other BUILD_DEPENDS.
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.4 2015/09/24 17:33:14 sthen Exp $
@


1.4
log
@build dep on coreutils; newlib's autoconf picks up gmkdir if present and
doesn't pick up the normal config.cache file.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2015/08/02 12:57:12 jasper Exp $
d26 1
a26 1
BUILD_DEPENDS =		sysutils/coreutils # autoconf picks up gmkdir
@


1.3
log
@disable LTO which doesn't really do anything but emit errors
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2015/07/21 16:24:50 jasper Exp $
d3 1
a3 1
COMMENT =		TI's open source compiler for MSP430 microcontrollers
d26 1
@


1.2
log
@install headers
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2015/07/21 15:51:37 jasper Exp $
d6 1
a6 1
REVISION =		0
a8 1
SHARED_LIBS +=  lto_plugin                0.0 # 0.0
d35 2
a36 1
			--with-gmp=${LOCALBASE}
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d6 1
d63 1
a63 1
	${INSTALL_DATA} ${WRKDIR}/msp430-gcc-support-files/*.ld \
@


1.1.1.1
log
@import ti-msp430gcc, TI's open source compiler for MSP430 microcontrollers

this will replace the existing msp430 toolchain at some point

ok aja@@
@
text
@@
