head	1.5;
access;
symbols
	OPENBSD_4_6:1.4.0.10
	OPENBSD_4_6_BASE:1.4
	OPENBSD_4_5:1.4.0.8
	OPENBSD_4_5_BASE:1.4
	OPENBSD_4_4:1.4.0.6
	OPENBSD_4_4_BASE:1.4
	OPENBSD_4_3:1.4.0.4
	OPENBSD_4_3_BASE:1.4
	OPENBSD_4_2:1.4.0.2
	OPENBSD_4_2_BASE:1.4
	OPENBSD_4_1:1.3.0.4
	OPENBSD_4_1_BASE:1.3
	OPENBSD_4_0:1.3.0.2
	OPENBSD_4_0_BASE:1.3
	OPENBSD_3_9:1.1.0.4
	OPENBSD_3_9_BASE:1.1
	OPENBSD_3_8:1.1.0.2
	OPENBSD_3_8_BASE:1.1;
locks; strict;
comment	@# @;


1.5
date	2009.09.06.19.25.22;	author jolan;	state dead;
branches;
next	1.4;

1.4
date	2007.05.10.20.23.29;	author pedro;	state Exp;
branches;
next	1.3;

1.3
date	2006.07.30.04.38.39;	author pedro;	state Exp;
branches;
next	1.2;

1.2
date	2006.03.26.04.56.02;	author pedro;	state Exp;
branches;
next	1.1;

1.1
date	2005.07.08.17.57.27;	author jolan;	state Exp;
branches;
next	;


desc
@@


1.5
log
@update to 1.4.2
@
text
@$OpenBSD: patch-src_lfs_c,v 1.4 2007/05/10 20:23:29 pedro Exp $
--- src/lfs.c.orig	Thu May 10 10:12:15 2007
+++ src/lfs.c	Thu May 10 10:13:50 2007
@@@@ -32,7 +32,7 @@@@
 #include <unistd.h>
 #include <dirent.h>
 #include <fcntl.h>
-#include <sys/types.h>
+#include <sys/param.h>
 #include <utime.h>
 #endif
 
@@@@ -89,8 +89,8 @@@@ static int change_dir (lua_State *L) {
 **  and a string describing the error
 */
 static int get_dir (lua_State *L) {
-	char path[255+2];
-	if (getcwd(path, 255) == NULL) {
+	char path[MAXPATHLEN];
+	if (getcwd(path, sizeof(path)) == NULL) {
 		lua_pushnil(L);
 		lua_pushstring(L, getcwd_error);
 		return 2;
@


1.4
log
@luafs-1.2.1, okay rui@@
@
text
@d1 1
a1 1
$OpenBSD$
@


1.3
log
@Switch to Lua 5.1, okay jolan@@
@
text
@d1 23
a23 30
$OpenBSD: patch-src_lfs_c,v 1.2 2006/03/26 04:56:02 pedro Exp $
--- src/lfs.c.orig	Tue Mar 14 13:18:30 2006
+++ src/lfs.c	Thu Jul 27 16:40:51 2006
@@@@ -32,14 +32,13 @@@@
 #include <unistd.h>
 #include <dirent.h>
 #include <fcntl.h>
-#include <sys/types.h>
+#include <sys/param.h>
 #include <utime.h>
 #endif
 
 #include "lua.h"
 #include "lauxlib.h"
 #include "lualib.h"
-#include "compat-5.1.h"
 
 #include "lfs.h"
 
@@@@ -91,8 +90,8 @@@@ static int change_dir (lua_State *L) {
 **  and a string describing the error
 */
 static int get_dir (lua_State *L) {
-	char path[255+2];
-	if (getcwd(path, 255) == NULL) {
+	char path[MAXPATHLEN];
+	if (getcwd(path, sizeof(path)) == NULL) {
 		lua_pushnil(L);
 		lua_pushstring(L, getcwd_error);
 		return 2;
@


1.2
log
@luafs-1.2, okay jolan@@
@
text
@d1 1
a1 1
$OpenBSD$
d3 1
a3 1
+++ src/lfs.c	Sun Mar 26 00:15:08 2006
a30 9
@@@@ -580,7 +579,7 @@@@ static const struct luaL_reg fslib[] = {
 	{NULL, NULL},
 };
 
-int luaopen_lfs (lua_State *L) {
+int luaopen_fs_core (lua_State *L) {
 	dir_create_meta (L);
 	luaL_openlib (L, "lfs", fslib, 0);
 	set_info (L);
@


1.1
log
@update to 1.1, ok pedro@@
@
text
@d2 38
a39 29
--- src/lfs.c.orig	Fri May 20 13:32:19 2005
+++ src/lfs.c	Thu Jul  7 23:29:53 2005
@@@@ -28,14 +28,13 @@@@
 #include <unistd.h>
 #include <dirent.h>
 #include <fcntl.h>
-#include <sys/types.h>
+#include <sys/param.h>
 #include <utime.h>
 #endif
 
 #include "lua.h"
 #include "lauxlib.h"
 #include "lualib.h"
-#include "compat-5.1.h"
 
 #include "lfs.h"
 
@@@@ -84,8 +83,8 @@@@ static int change_dir (lua_State *L) {
 **  and a string describing the error
 */
 static int get_dir (lua_State *L) {
-	char path[255+2];
-	if (getcwd(path, 255) == NULL) {
+	char path[MAXPATHLEN];
+	if (getcwd(path, sizeof(path)) == NULL) {
 		lua_pushnil(L);
 		lua_pushstring(L, getcwd_error);
 		return 2;
@

