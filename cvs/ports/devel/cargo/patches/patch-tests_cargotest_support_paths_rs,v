head	1.4;
access;
symbols;
locks; strict;
comment	@# @;


1.4
date	2017.02.15.12.49.43;	author landry;	state Exp;
branches;
next	1.3;
commitid	utIITmspanVhe2Yj;

1.3
date	2017.01.01.18.49.58;	author landry;	state Exp;
branches;
next	1.2;
commitid	6SWxgObeOy9Te7JN;

1.2
date	2016.12.26.13.55.11;	author landry;	state Exp;
branches;
next	1.1;
commitid	lFh89WHX48grNn8e;

1.1
date	2016.08.31.08.33.37;	author landry;	state Exp;
branches;
next	;
commitid	2TGYdWcgJPSbO4Zr;


desc
@@


1.4
log
@Update to cargo 0.16.0.

All the hard work by semarie@@, thanks!
@
text
@$OpenBSD: patch-tests_cargotest_support_paths_rs,v 1.3 2017/01/01 18:49:58 landry Exp $
use MODCARGO_TARGET_DIR as temporary directory for testing.
--- tests/cargotest/support/paths.rs.orig	Fri Jan 27 08:50:00 2017
+++ tests/cargotest/support/paths.rs	Sat Feb  4 07:18:18 2017
@@@@ -1,4 +1,3 @@@@
-use std::env;
 use std::cell::Cell;
 use std::fs;
 use std::io::{self, ErrorKind};
@@@@ -30,19 +29,7 @@@@ fn init() {
 }
 
 fn global_root() -> PathBuf {
-    let mut path = t!(env::current_exe());
-    path.pop(); // chop off exe name
-    path.pop(); // chop off 'debug'
-
-    // If `cargo test` is run manually then our path looks like
-    // `target/debug/foo`, in which case our `path` is already pointing at
-    // `target`. If, however, `cargo test --target $target` is used then the
-    // output is `target/$target/debug/foo`, so our path is pointing at
-    // `target/$target`. Here we conditionally pop the `$target` name.
-    if path.file_name().and_then(|s| s.to_str()) != Some("target") {
-        path.pop();
-    }
-
+    let path = PathBuf::from("${MODCARGO_TARGET_DIR}/debug");
     path.join(CARGO_INTEGRATION_TEST_DIR)
 }
 
@


1.3
log
@Update to cargo 0.15.0, from Maintainer semarie@@
@
text
@d1 1
a1 1
$OpenBSD: patch-tests_cargotest_support_paths_rs,v 1.2 2016/12/26 13:55:11 landry Exp $
d3 2
a4 2
--- tests/cargotest/support/paths.rs.orig	Tue Dec 20 22:16:05 2016
+++ tests/cargotest/support/paths.rs	Fri Dec 30 06:06:19 2016
d10 1
a10 1
@@@@ -30,22 +29,7 @@@@ fn init() {
a15 3
-    if path.ends_with("deps") {
-        path.pop();
-    }
@


1.2
log
@Enable cargo on i386, from MAINTAINER semarie@@

- provide a new cargo MODULE for ports based on cargo (documentation pending)
- convert cargo itself to use this module

tested on i386 here.
@
text
@d1 1
a1 1
$OpenBSD: patch-tests_cargotest_support_paths_rs,v 1.1 2016/08/31 08:33:37 landry Exp $
d3 2
a4 2
--- tests/cargotest/support/paths.rs.orig	Sun Aug 21 20:00:19 2016
+++ tests/cargotest/support/paths.rs	Sun Aug 21 20:09:38 2016
d10 1
a10 1
@@@@ -30,19 +29,7 @@@@ fn init() {
d16 3
@


1.1
log
@Update to cargo 0.12.0, from semarie@@, thanks!
@
text
@d1 2
a2 2
$OpenBSD$
use WRKBUILD as temporary directory for testing.
d27 1
a27 1
+    let path = PathBuf::from("${WRKBUILD}/target/debug");
@

