head	1.34;
access;
symbols
	OPENBSD_6_2:1.34.0.2
	OPENBSD_6_2_BASE:1.34
	OPENBSD_6_1:1.33.0.8
	OPENBSD_6_1_BASE:1.33
	OPENBSD_6_0:1.33.0.6
	OPENBSD_6_0_BASE:1.33
	OPENBSD_5_9:1.33.0.2
	OPENBSD_5_9_BASE:1.33
	OPENBSD_5_8:1.33.0.4
	OPENBSD_5_8_BASE:1.33
	OPENBSD_5_7:1.32.0.2
	OPENBSD_5_7_BASE:1.32
	OPENBSD_5_6:1.31.0.2
	OPENBSD_5_6_BASE:1.31
	OPENBSD_5_5:1.30.0.2
	OPENBSD_5_5_BASE:1.30
	OPENBSD_5_4:1.29.0.2
	OPENBSD_5_4_BASE:1.29
	OPENBSD_5_3:1.27.0.2
	OPENBSD_5_3_BASE:1.27
	OPENBSD_5_2:1.26.0.2
	OPENBSD_5_2_BASE:1.26
	OPENBSD_5_1_BASE:1.25
	OPENBSD_5_1:1.25.0.2
	OPENBSD_5_0:1.23.0.4
	OPENBSD_5_0_BASE:1.23
	OPENBSD_4_9:1.23.0.2
	OPENBSD_4_9_BASE:1.23
	OPENBSD_4_8:1.17.0.4
	OPENBSD_4_8_BASE:1.17
	OPENBSD_4_7:1.17.0.2
	OPENBSD_4_7_BASE:1.17
	OPENBSD_4_6:1.16.0.4
	OPENBSD_4_6_BASE:1.16
	OPENBSD_4_5:1.16.0.2
	OPENBSD_4_5_BASE:1.16
	OPENBSD_4_4:1.14.0.2
	OPENBSD_4_4_BASE:1.14
	OPENBSD_4_3:1.12.0.2
	OPENBSD_4_3_BASE:1.12
	OPENBSD_4_2:1.7.0.2
	OPENBSD_4_2_BASE:1.7
	OPENBSD_4_1:1.3.0.2
	OPENBSD_4_1_BASE:1.3
	OPENBSD_4_0:1.1.1.1.0.2
	OPENBSD_4_0_BASE:1.1.1.1
	sturm_20060611:1.1.1.1
	sturm:1.1.1;
locks; strict;
comment	@# @;


1.34
date	2017.09.02.21.34.12;	author jeremy;	state Exp;
branches;
next	1.33;
commitid	CNZruoNJxjG8r965;

1.33
date	2015.06.24.06.59.56;	author jasper;	state Exp;
branches
	1.33.8.1;
next	1.32;
commitid	jd0I5nnlDQfDGR13;

1.32
date	2014.10.11.19.52.10;	author jeremy;	state Exp;
branches;
next	1.31;
commitid	FUidtwTUnJBIVSAa;

1.31
date	2014.06.25.15.38.18;	author jeremy;	state Exp;
branches;
next	1.30;
commitid	buhPpdWoqjstIEY1;

1.30
date	2014.01.06.02.24.49;	author jeremy;	state Exp;
branches;
next	1.29;

1.29
date	2013.03.20.19.13.50;	author jeremy;	state Exp;
branches
	1.29.2.1;
next	1.28;

1.28
date	2013.03.11.10.50.29;	author espie;	state Exp;
branches;
next	1.27;

1.27
date	2012.10.24.22.50.27;	author jeremy;	state Exp;
branches;
next	1.26;

1.26
date	2012.04.27.18.41.07;	author jeremy;	state Exp;
branches;
next	1.25;

1.25
date	2011.11.08.23.44.12;	author jeremy;	state Exp;
branches;
next	1.24;

1.24
date	2011.09.16.09.24.57;	author espie;	state Exp;
branches;
next	1.23;

1.23
date	2010.11.24.21.35.14;	author jeremy;	state Exp;
branches;
next	1.22;

1.22
date	2010.11.15.19.46.08;	author espie;	state Exp;
branches;
next	1.21;

1.21
date	2010.11.08.23.21.47;	author jeremy;	state Exp;
branches;
next	1.20;

1.20
date	2010.10.06.18.12.19;	author jeremy;	state Exp;
branches;
next	1.19;

1.19
date	2010.09.28.21.07.14;	author jeremy;	state Exp;
branches;
next	1.18;

1.18
date	2010.09.23.22.06.47;	author jeremy;	state Exp;
branches;
next	1.17;

1.17
date	2009.10.12.17.18.00;	author bernd;	state Exp;
branches;
next	1.16;

1.16
date	2009.01.14.22.54.53;	author bernd;	state Exp;
branches;
next	1.15;

1.15
date	2008.09.28.15.45.17;	author bernd;	state Exp;
branches;
next	1.14;

1.14
date	2008.06.17.22.42.59;	author bernd;	state Exp;
branches;
next	1.13;

1.13
date	2008.06.14.23.46.38;	author landry;	state Exp;
branches;
next	1.12;

1.12
date	2008.01.12.14.51.15;	author bernd;	state Exp;
branches;
next	1.11;

1.11
date	2007.11.13.17.27.17;	author bernd;	state Exp;
branches;
next	1.10;

1.10
date	2007.11.13.16.02.35;	author bernd;	state Exp;
branches;
next	1.9;

1.9
date	2007.09.20.12.33.32;	author msf;	state Exp;
branches;
next	1.8;

1.8
date	2007.09.16.02.53.13;	author merdely;	state Exp;
branches;
next	1.7;

1.7
date	2007.06.04.15.22.03;	author jcs;	state Exp;
branches;
next	1.6;

1.6
date	2007.05.30.23.34.36;	author jcs;	state Exp;
branches;
next	1.5;

1.5
date	2007.05.03.11.28.48;	author msf;	state Exp;
branches;
next	1.4;

1.4
date	2007.05.03.11.25.17;	author msf;	state Exp;
branches;
next	1.3;

1.3
date	2006.10.30.07.28.21;	author sturm;	state Exp;
branches;
next	1.2;

1.2
date	2006.10.19.00.53.55;	author bernd;	state Exp;
branches;
next	1.1;

1.1
date	2006.06.11.19.11.07;	author sturm;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2006.06.11.19.11.07;	author sturm;	state Exp;
branches;
next	;

1.29.2.1
date	2014.01.06.09.26.34;	author jasper;	state Exp;
branches;
next	;

1.33.8.1
date	2017.09.07.17.26.48;	author jeremy;	state Exp;
branches;
next	;
commitid	2rNzaPKgilANE9Yw;


desc
@@


1.34
log
@Backport security patches in rubygems 2.6.13 to 1.8.24. No CVE numbers,
but this fixes the following vulnerabilities:

* Fix a DNS request hijacking vulnerability.
* Fix an ANSI escape sequence vulnerability.
* Fix a DOS vulernerability in the query command.
* Fix a vulnerability in the gem installer that allowed a malicious
  gem to overwrite arbitrary files.
@
text
@# $OpenBSD: Makefile,v 1.33 2015/06/24 06:59:56 jasper Exp $

COMMENT=	package management framework for the Ruby language

V=		1.8.24
DISTNAME=	rubygems-$V
PKGNAME= 	ruby-gems-$V
CATEGORIES=	devel

REVISION=	0

HOMEPAGE=	http://docs.rubygems.org/

# GPL
PERMIT_PACKAGE_CDROM=	Yes

MASTER_SITES=	http://production.cf.rubygems.org/rubygems/
EXTRACT_SUFX=	.tgz

MODULES= 	lang/ruby
MODRUBY_REV=	1.8

CONFIGURE_STYLE=ruby setup

MAKE_ENV=	GEM_HOME=${PREFIX}/lib/ruby/gems/${MODRUBY_LIBREV} \
		RUBYLIB=${PREFIX}/lib/ruby/site_ruby/${MODRUBY_LIBREV}

PORTHOME = 	${WRKDIR}

SUBST_VARS=	DISTNAME

do-configure:
do-build:

pre-install:
	@@${SUBST_CMD} ${WRKSRC}/lib/rubygems/config_file.rb

do-install:
	@@cd ${WRKSRC} && ${SETENV} ${MAKE_ENV} ${RUBY} setup.rb install \
		--prefix=${PREFIX}
	@@mkdir -p ${WRKINST}${LOCALBASE}/lib/ruby/gems/${MODRUBY_LIBREV}/{,cache,doc,gems,specifications}

TEST_DEPENDS=	devel/ruby-hoe
MODRUBY_TEST=	rake

.include <bsd.port.mk>
@


1.33
log
@update to ruby-gems-1.8.24
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2014/10/11 19:52:10 jeremy Exp $
d9 2
@


1.33.8.1
log
@Backport rubygems 2.6.13 security patches to rubygems 1.8.24.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2015/06/24 06:59:56 jasper Exp $
a8 2

REVISION=	0
@


1.32
log
@Use a 18 suffix for ruby 1.8 gem binaries

This makes them consistent with ruby 1.9+ gem binaries.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2014/06/25 15:38:18 jeremy Exp $
d5 1
a5 1
V=		1.8.23
a7 1
REVISION=	3
@


1.31
log
@Backport an upstream rubygems patch fixing issues with Gem.refresh.

OK ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2014/01/06 02:24:49 jeremy Exp $
d8 1
a8 1
REVISION=	2
@


1.30
log
@Add patch to fix algorithmic complexity vulnerabilities CVE-2013-4287
and CVE-2013-4363.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2013/03/20 19:13:50 jeremy Exp $
d8 1
a8 1
REVISION=	1
@


1.29
log
@Make ruby 1.9 the default ruby for non-gem/extconf ports,
for consistency with the gem/extconf ports.

Update non-gem/extconf ports that relied on the previous
default of ruby 1.8 to explicitly specify it.

OK ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2013/03/11 10:50:29 espie Exp $
d8 1
a8 1
REVISION=	0
@


1.29.2.1
log
@Add patch to fix algorithmic complexity vulnerabilities CVE-2013-4287
and CVE-2013-4363.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2013/03/20 19:13:50 jeremy Exp $
d8 1
a8 1
REVISION=	1
@


1.28
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2012/10/24 22:50:27 jeremy Exp $
d20 1
@


1.27
log
@Handle building of C extension gems as non-root in more cases.

OK jcs@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2012/04/27 18:41:07 jeremy Exp $
a14 3
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
d41 2
a42 2
REGRESS_DEPENDS=	devel/ruby-hoe
MODRUBY_REGRESS=	rake
@


1.26
log
@Update to rubygems 1.8.23, fixes SSL security issues when installing
gems.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2011/11/08 23:44:12 jeremy Exp $
d8 1
@


1.25
log
@Update to rubygems 1.8.10.  This makes the ruby 1.8 version
of rubygems pretty much the same as the version that ships with
with ruby 1.9.3.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2011/09/16 09:24:57 espie Exp $
d5 1
a5 1
V=		1.8.10
@


1.24
log
@normalize pkgpath
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2010/11/24 21:35:14 jeremy Exp $
d5 1
a5 1
V=		1.3.7
a7 1
REVISION =	3
@


1.23
log
@REVISION bump all ruby ports due to a change in the pkgspec.
Previously, we were using ruby->=1.8,<=1.9, instead of
ruby->=1.8,<1.9.  While this wouldn't cause an issue, since
our ruby-1.9.2 package isn't included in ruby->=1.8,<=1.9,
it's still wrong and should be fixed.  This also fixes the
following minor issues:

Switch from using FLAVOR to MODRUBY_FLAVOR for *_DEPENDS.
Currently we don't have a ruby port that uses FLAVORs that
would differ from MODRUBY_FLAVOR, but it's possible we will
in the future.

Switch from BASE_PKGPATH to BUILD_PKGPATH in a few cases in
REGRESS_DEPENDS.  This probably is not strictly necessary, but
BUILD_PKGPATH is used in more cases, so it is good for
consistency.

Switch to new style *_DEPENDS, with the version specification
at the end.  The remaining cases where this is not done is
because a specific version is used.

Some FULLPKGNAME added to REGRESS_DEPENDS, to make sure that if
the old version is installed when you run a regress test, it
will install the new version first.

Some conversion of spaces to tabs for consistency.

OK landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2010/11/15 19:46:08 espie Exp $
d8 1
a8 1
REVISION =	2
@


1.22
log
@move depends to new style
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2010/11/08 23:21:47 jeremy Exp $
d8 1
a8 1
REVISION =	1
d26 2
a27 2
MAKE_ENV=	GEM_HOME=${PREFIX}/lib/ruby/gems/${MODRUBY_REV} \
		RUBYLIB=${PREFIX}/lib/ruby/site_ruby/${MODRUBY_REV}
d42 1
a42 1
	@@mkdir -p ${WRKINST}${LOCALBASE}/lib/ruby/gems/${MODRUBY_REV}/{,cache,doc,gems,specifications}
@


1.21
log
@Remove --skip-depends and --default-source-index gem install options,
no longer needed.

OK landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2010/10/06 18:12:19 jeremy Exp $
d44 1
a44 1
REGRESS_DEPENDS=	::devel/ruby-hoe
@


1.20
log
@This adds an ugly hack to make gem install --user-install work
for gems with native extensions. Without this, it calls
/usr/bin/install -o root -g bin as a regular user, which fails due
to permission issues. This removes the -o root -g bin, so it can
succeed as a regular user.

Regen patches while here.

Idea to just remove -o root -g bin instead of using cp -p from
landry@@.

OK landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2010/09/28 21:07:14 jeremy Exp $
d8 1
a8 1
REVISION =	0
@


1.19
log
@Update MASTER_SITES, future versions will probably not be hosted on
rubyforge

OK landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2010/09/23 22:06:47 jeremy Exp $
d8 1
a8 1
#REVISION =	0
@


1.18
log
@Upgrade to ruby-gems 1.3.7 and work with the new split ruby port.

This now installs gem as gem18, since gem is included in ruby 1.9.

OK jcs@@, landry@@, jasper@@, sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2009/10/12 17:18:00 bernd Exp $
d19 1
a19 1
MASTER_SITES=	${MASTER_SITE_RUBYFORGE:=rubygems/}
@


1.17
log
@Update to ruby-gems-1.3.5.

From Jeremy Evans. Thank you!
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2008/09/28 15:45:17 bernd Exp $
d5 1
a5 1
V=		1.3.5
d8 1
a32 2
REGRESS_DEPENDS=::devel/ruby-rake

d40 1
a40 1
	 @@cd ${WRKSRC} && ${SETENV} ${MAKE_ENV} ${RUBY} setup.rb install \
d42 4
a45 2
do-regress:
	@@cd ${WRKBUILD} && ${LOCALBASE}/bin/rake test
@


1.16
log
@Update to ruby-gems-1.3.1.
@
text
@d5 1
a5 1
V=		1.3.1
@


1.15
log
@Update to ruby-gems-1.3.0.

Initial diff for 1.2.0 from Jeremy Evans.
Some hints from sturm@@.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2008/06/17 22:42:59 bernd Exp $
d5 1
a5 1
V=		1.3.0
@


1.14
log
@Update to ruby-gems-1.1.1.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2008/06/14 23:46:38 landry Exp $
d5 1
a5 1
V=		1.1.1
d28 2
d36 3
@


1.13
log
@bump PKGNAMEs after lang/ruby module change.
Fix CATEGORIES in rdt eclipse plugin.
in subversion, only bump subpackages that use lang/ruby module.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2008/01/12 14:51:15 bernd Exp $
d5 1
a5 1
V=		1.0.1
d7 1
a7 1
PKGNAME= 	ruby-gems-$Vp0
d27 2
@


1.12
log
@Update to ruby-gems-1.0.1.

help & testing jcs@@, msf@@

ok jcs@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2007/11/13 17:27:17 bernd Exp $
d7 1
a7 1
PKGNAME= 	ruby-gems-$V
@


1.11
log
@Actually remove the skipped gem from the dependency chain so that it
doesn't end up in the .gemspec file.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2007/11/13 16:02:35 bernd Exp $
d5 1
a5 1
V=		0.9.4
d7 1
a7 1
PKGNAME= 	ruby-gems-$Vp2
d25 13
a37 1
MAKE_ENV=	GEM_HOME=${PREFIX}/lib/ruby/gems/${MODRUBY_REV}
@


1.10
log
@Add a --skip-dependencies option to the gem install command.
This can be used to ignore bogus gem depends.

ok jcs, "sounds reasonable but I haven't really looked at it" msf@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2007/09/20 12:33:32 msf Exp $
d7 1
a7 1
PKGNAME= 	ruby-gems-$Vp1
@


1.9
log
@use MASTER_SITE_RUBYFORGE
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2007/09/16 02:53:13 merdely Exp $
d7 1
a7 1
PKGNAME= 	ruby-gems-$Vp0
@


1.8
log
@Remove quotes surrounding COMMENT*/PERMIT_*/BROKEN
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2007/06/04 15:22:03 jcs Exp $
d18 1
a18 1
MASTER_SITES=	http://rubyforge.org/frs/download.php/20989/
@


1.7
log
@move local build lib to the front of the line so we don't pick up a
currently installed gems when upgrading

noticed by and ok espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2007/05/30 23:34:36 jcs Exp $
d3 1
a3 1
COMMENT=	"package management framework for the Ruby language"
@


1.6
log
@update to gems 0.9.4
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2007/05/03 11:28:48 msf Exp $
d7 1
a7 1
PKGNAME= 	ruby-gems-$V
@


1.5
log
@sigh... bump PKGNAME too
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2007/05/03 11:25:17 msf Exp $
d5 1
a5 1
V=		0.9.0
d7 1
a7 1
PKGNAME= 	ruby-gems-$Vp0
d18 1
a18 1
MASTER_SITES=	http://rubyforge.org/frs/download.php/11289/
@


1.4
log
@drop maintainer on ruby rails and friends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2006/10/30 07:28:21 sturm Exp $
d7 1
a7 1
PKGNAME= 	ruby-gems-$V
@


1.3
log
@missing REV -> MODRUBY_REV conversion
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2006/10/19 00:53:55 bernd Exp $
a10 2

MAINTAINER=	Mathieu Sauve-Frankel <msf@@openbsd.org> 
@


1.2
log
@Update to ruby-gems-0.9.0 and backport some code from the gems subversion
repository to fix building of native extensions. (sigh!)

A summary of changes can be found here:
http://rubyforge.org/forum/forum.php?forum_id=7575

ok msf@@, sturm@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2006/06/11 19:11:07 sturm Exp $
d27 1
a27 1
MAKE_ENV=	GEM_HOME=${PREFIX}/lib/ruby/gems/${REV}
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d5 1
a5 1
V=		0.8.11
d20 1
a20 1
MASTER_SITES=	http://rubyforge.org/frs/download.php/5207/
@


1.1.1.1
log
@Initial import of ruby-gems 0.8.11

RubyGems is the Ruby standard for publishing and managing third party
libraries.

from msf
@
text
@@
