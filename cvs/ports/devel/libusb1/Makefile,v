head	1.27;
access;
symbols
	OPENBSD_6_1:1.26.0.2
	OPENBSD_6_1_BASE:1.26
	OPENBSD_6_0:1.25.0.2
	OPENBSD_6_0_BASE:1.25
	OPENBSD_5_9:1.24.0.2
	OPENBSD_5_9_BASE:1.24
	OPENBSD_5_8:1.23.0.4
	OPENBSD_5_8_BASE:1.23
	OPENBSD_5_7:1.22.0.6
	OPENBSD_5_7_BASE:1.22
	OPENBSD_5_6:1.22.0.4
	OPENBSD_5_6_BASE:1.22
	OPENBSD_5_5:1.22.0.2
	OPENBSD_5_5_BASE:1.22
	OPENBSD_5_4:1.21.0.2
	OPENBSD_5_4_BASE:1.21
	OPENBSD_5_3:1.15.0.2
	OPENBSD_5_3_BASE:1.15
	OPENBSD_5_2:1.13.0.2
	OPENBSD_5_2_BASE:1.13
	OPENBSD_5_1_BASE:1.6
	OPENBSD_5_1:1.6.0.2
	mpi_20110211:1.1.1.1
	mpi:1.1.1;
locks; strict;
comment	@# @;


1.27
date	2017.04.19.06.09.02;	author ajacoutot;	state Exp;
branches;
next	1.26;
commitid	byfa467Feqreg8Z6;

1.26
date	2016.09.10.13.03.40;	author ajacoutot;	state Exp;
branches;
next	1.25;
commitid	4KcvAK91uGdTLejD;

1.25
date	2016.03.11.19.59.13;	author naddy;	state Exp;
branches;
next	1.24;
commitid	pguKLBEFv33DrgKU;

1.24
date	2015.09.15.09.03.53;	author dcoppa;	state Exp;
branches;
next	1.23;
commitid	rEDGIyrWWPY5ovqE;

1.23
date	2015.03.16.18.07.43;	author naddy;	state Exp;
branches;
next	1.22;
commitid	IJdm3Zowcdkcxp5X;

1.22
date	2013.08.07.15.37.09;	author naddy;	state Exp;
branches;
next	1.21;

1.21
date	2013.06.28.12.11.50;	author espie;	state Exp;
branches;
next	1.20;

1.20
date	2013.04.22.08.37.20;	author mpi;	state Exp;
branches;
next	1.19;

1.19
date	2013.04.17.14.28.17;	author mpi;	state Exp;
branches;
next	1.18;

1.18
date	2013.04.12.08.22.10;	author mpi;	state Exp;
branches;
next	1.17;

1.17
date	2013.03.21.08.45.16;	author ajacoutot;	state Exp;
branches;
next	1.16;

1.16
date	2013.03.11.10.50.10;	author espie;	state Exp;
branches;
next	1.15;

1.15
date	2012.08.25.15.25.51;	author mpi;	state Exp;
branches;
next	1.14;

1.14
date	2012.08.05.10.55.24;	author mpi;	state Exp;
branches;
next	1.13;

1.13
date	2012.07.08.22.21.32;	author sthen;	state Exp;
branches;
next	1.12;

1.12
date	2012.07.08.17.41.14;	author sthen;	state Exp;
branches;
next	1.11;

1.11
date	2012.06.19.20.45.00;	author mpi;	state Exp;
branches;
next	1.10;

1.10
date	2012.04.23.08.48.08;	author mpi;	state Exp;
branches;
next	1.9;

1.9
date	2012.04.22.19.52.05;	author mpi;	state Exp;
branches;
next	1.8;

1.8
date	2012.04.22.09.06.37;	author mpi;	state Exp;
branches;
next	1.7;

1.7
date	2012.04.08.13.14.54;	author mpi;	state Exp;
branches;
next	1.6;

1.6
date	2012.02.01.13.26.20;	author mpi;	state Exp;
branches;
next	1.5;

1.5
date	2012.01.18.14.09.52;	author mpi;	state Exp;
branches;
next	1.4;

1.4
date	2011.11.18.15.18.50;	author mpi;	state Exp;
branches;
next	1.3;

1.3
date	2011.11.04.12.17.50;	author jasper;	state Exp;
branches;
next	1.2;

1.2
date	2011.11.04.09.18.11;	author mpi;	state Exp;
branches;
next	1.1;

1.1
date	2011.11.02.14.31.56;	author mpi;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2011.11.02.14.31.56;	author mpi;	state Exp;
branches;
next	;


desc
@@


1.27
log
@Update to libusb1-1.0.21.

ok mpi@@ (maintainer)
@
text
@# $OpenBSD: Makefile,v 1.26 2016/09/10 13:03:40 ajacoutot Exp $

COMMENT =		library for USB device access from userspace

VERSION =		1.0.21
DISTNAME =		libusb-${VERSION}
PKGNAME =		libusb1-${VERSION}

SHARED_LIBS +=		usb-1.0			1.1	# 1.0

CATEGORIES =		devel

HOMEPAGE =		http://www.libusb.info

MAINTAINER =		Martin Pieuchot <mpi@@openbsd.org>

# LGPL 2.1
PERMIT_PACKAGE_CDROM =	Yes

WANTLIB =		pthread

MASTER_SITES =		${MASTER_SITE_SOURCEFORGE:=libusb/}
EXTRACT_SUFX =		.tar.bz2

CONFIGURE_STYLE =	gnu

.ifdef DEBUG
CONFIGURE_ARGS +=	--enable-debug-log \
			--enable-examples-build
.endif

.include <bsd.port.mk>
@


1.26
log
@First pass at pre-entively fixing ports that would break once guenther's header
pollution diff is in.

lang/squeak/vm does not build but it's due to the recent audio changes
games/xbattle: also fixes some conflicting implicit decl
print/hplip: also fixes some conflicting implicit decl
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2016/03/11 19:59:13 naddy Exp $
d5 1
a5 1
VERSION =		1.0.20
a7 1
REVISION =		0
@


1.25
log
@garbage collect CONFIGURE_SHARED
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2015/09/15 09:03:53 dcoppa Exp $
d8 1
@


1.24
log
@
Update to libusb1-1.0.20

OK mpi@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2015/03/16 18:07:43 naddy Exp $
a25 1
CONFIGURE_ARGS +=	${CONFIGURE_SHARED}
@


1.23
log
@fold lib-only PFRAG.shared into PLIST, regen PLIST, and bump
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2013/08/07 15:37:09 naddy Exp $
d5 1
a5 1
VERSION =		1.0.9
d8 2
a9 2
REVISION =		9
SHARED_LIBS +=  	usb-1.0                   1.0 # 1.0
d13 1
a13 1
HOMEPAGE =		http://www.libusb.org
@


1.22
log
@kill direct and indirect references to GCC2_ARCHS
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2013/06/28 12:11:50 espie Exp $
d8 1
a8 1
REVISION =		8
@


1.21
log
@don't bother on vax
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2013/04/22 08:37:20 mpi Exp $
a3 3

# -std=gnu99 doesn't work there
NOT_FOR_ARCHS =		${GCC2_ARCHS}
@


1.20
log
@Instead of generating I/O to get the active configuration number, just read
it from the cached descriptor.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2013/04/17 14:28:17 mpi Exp $
d4 3
@


1.19
log
@Make use of the new usb(4) ioctl to retrieve the device descriptor from
memory instead of generating I/O as adertised by the libusb API.

ok mglocker@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2013/04/12 08:22:10 mpi Exp $
d8 1
a8 1
REVISION =		7
@


1.18
log
@Make use of the new usb(4) ioctls to retrieve the config descriptor from
memory instead of generating I/O as adertised by the libusb API.

ok mglocker@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2013/03/21 08:45:16 ajacoutot Exp $
d8 1
a8 1
REVISION =		6
@


1.17
log
@USE_LIBTOOL=Yes is the default now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2013/03/11 10:50:10 espie Exp $
d8 1
a8 1
REVISION =		5
@


1.16
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2012/08/25 15:25:51 mpi Exp $
a24 1
USE_LIBTOOL =		Yes
@


1.15
log
@Remove -pthread patch, from Brad

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2012/08/05 10:55:24 mpi Exp $
a18 3
PERMIT_PACKAGE_FTP =	Yes
PERMIT_DISTFILES_CDROM =Yes
PERMIT_DISTFILES_FTP =	Yes
@


1.14
log
@Associate an ugen node to an USB device even if it is not attached as
first device and don't use the new bConfigurationValue for the index
when caching the config descriptor.

Fix scanning problems reported and tested by ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2012/07/08 22:21:32 sthen Exp $
d8 1
a8 1
REVISION =		4
d22 2
@


1.13
log
@revert -pthread in cflags, after a bit of discussion with aja and guenther
and looking at the port which wanted -pthread in cflags, I came to the
conclusion that the other port was wrong, so it's right to zap this again.
ok mpi ajacoutot
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2012/07/08 17:41:14 sthen Exp $
d8 1
a8 1
REVISION =		3
@


1.12
log
@add -pthread to cflags as well as libs in the pc file. ok jasper@@ mpi@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2012/06/19 20:45:00 mpi Exp $
d8 1
a8 1
REVISION =		2
@


1.11
log
@Rework the OpenBSD backend to add *basic support* for non ugen(4) devices.

It is now possible to have a read access and submit control transfers to
all USB devices using libusb, please note that controllers and hubs also
appear as devices.

Requested by many, tested by and ok ajacoutot@@, jasper@@, henning@@, shten@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2012/04/23 08:48:08 mpi Exp $
d8 1
a8 1
REVISION =		1
@


1.10
log
@Remove now unused BUILD_DEPENDS.

spotted by Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2012/04/22 19:52:05 mpi Exp $
d8 1
a8 1
REVISION =		0
d29 5
@


1.9
log
@Re-adds `-pthread' to the .pc file, this unbreaks application depending
on libusb1, I wrongly removed this patch during the last commit.

spotted by nigel@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2012/04/22 09:06:37 mpi Exp $
a24 3

# XXX Depends on libtool macros
BUILD_DEPENDS =		devel/libtool
@


1.8
log
@Update libusb1 to 1.0.9

All OpenBSD specific code has been committed upstream.

ok sthen@@, ajacoutot@@, jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2012/04/08 13:14:54 mpi Exp $
d8 1
@


1.7
log
@Correctly catch attempts to do isochronous OUT transfers and fix a warning
from upstream.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2012/02/01 13:26:20 mpi Exp $
d5 1
a5 1
VERSION =		1.0.8
d8 1
a8 2
REVISION =		4
SHARED_LIBS +=  	usb-1.0                   0.0 # 0.0
d29 1
a29 3
AUTOCONF_VERSION =	2.65
AUTOMAKE_VERSION =	1.11
CONFIGURE_STYLE =	automake autoconf
a30 20

.ifdef DEBUG
CONFIGURE_ARGS +=	--enable-log \
			--enable-debug-log \
			--enable-examples-build
.endif

AUTO_ENV=	AUTOCONF_VERSION=${AUTOCONF_VERSION} \
		AUTOMAKE_VERSION=${AUTOMAKE_VERSION}

post-extract:
	cp ${FILESDIR}/openbsd_ugen.c ${WRKSRC}/libusb/os/

post-patch:
	@@echo "Running aclocal-${AUTOMAKE_VERSION} in ${WRKSRC}"
	@@cd ${WRKSRC}; ${AUTO_ENV} aclocal

pre-configure:
	@@echo "Running automake-${AUTOMAKE_VERSION} in ${WRKSRC}"
	@@cd ${WRKSRC}; ${AUTO_ENV} automake --foreign
@


1.6
log
@Fix a memleak reported by upstream.

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2012/01/18 14:09:52 mpi Exp $
d8 1
a8 1
REVISION =		3
@


1.5
log
@Always try to open a node in rw mode if possible, the same endpoint may
be used for reading and writting and don't close it if a timeout occured

Fix a regression reported by mpf@@, ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2011/11/18 15:18:50 mpi Exp $
d8 1
a8 1
REVISION =		2
@


1.4
log
@Various changes for OpenBSD's backend with inputs from upstream.

Transfer completion notifications are now send asynchronously this should
prevent potential lock of applications using a different thread for polling
events.

Fix interrupt tranfers, reported by and helped to debug, sebastia@@

Other minor improvements and style fixes.

Tested by sebastia@@ and ajacoutot@@

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2011/11/04 12:17:50 jasper Exp $
d8 1
a8 1
REVISION =		1
@


1.3
log
@unbreak
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2011/11/04 09:18:11 mpi Exp $
d8 1
a8 1
REVISION =		0
@


1.2
log
@Add missing build depend spotted by nigel@@ and fix two minor issues in the
backend.

Tested and ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2011/11/02 14:31:56 mpi Exp $
d27 1
a27 1
BUILD_DEPEND =		devel/libtool
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d8 1
d25 3
@


1.1.1.1
log
@Import libusb1 1.0.8

libusb is a library for USB device access from userland.

Note that the OpenBSD backend based on ugen(4) does not provide 
asynchronous I/O.

with tests, tweaks and ok ajacoutot@@
@
text
@@
