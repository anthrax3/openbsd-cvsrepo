head	1.14;
access;
symbols
	OPENBSD_6_1:1.14.0.2
	OPENBSD_6_1_BASE:1.14
	OPENBSD_6_0:1.11.0.6
	OPENBSD_6_0_BASE:1.11
	OPENBSD_5_9:1.11.0.2
	OPENBSD_5_9_BASE:1.11
	OPENBSD_5_8:1.11.0.4
	OPENBSD_5_8_BASE:1.11
	OPENBSD_5_7:1.10.0.2
	OPENBSD_5_7_BASE:1.10
	OPENBSD_5_6:1.9.0.2
	OPENBSD_5_6_BASE:1.9
	OPENBSD_5_5:1.8.0.2
	OPENBSD_5_5_BASE:1.8
	OPENBSD_5_4:1.6.0.2
	OPENBSD_5_4_BASE:1.6
	OPENBSD_5_3:1.3.0.8
	OPENBSD_5_3_BASE:1.3
	OPENBSD_5_2:1.3.0.6
	OPENBSD_5_2_BASE:1.3
	OPENBSD_5_1_BASE:1.3
	OPENBSD_5_1:1.3.0.4
	OPENBSD_5_0:1.3.0.2
	OPENBSD_5_0_BASE:1.3
	OPENBSD_4_9:1.1.0.2
	OPENBSD_4_9_BASE:1.1;
locks; strict;
comment	@# @;


1.14
date	2017.03.01.11.56.05;	author naddy;	state Exp;
branches;
next	1.13;
commitid	v3NUoZ9ljtX9ssrL;

1.13
date	2016.09.11.10.52.51;	author tb;	state Exp;
branches;
next	1.12;
commitid	WinR5ygehGSFelNd;

1.12
date	2016.07.30.14.10.58;	author naddy;	state Exp;
branches;
next	1.11;
commitid	tsfsDJVjIjaCFFkZ;

1.11
date	2015.06.20.20.36.04;	author naddy;	state Exp;
branches;
next	1.10;
commitid	63bZB0u7WvAwCNoZ;

1.10
date	2014.11.25.11.59.37;	author naddy;	state Exp;
branches;
next	1.9;
commitid	XuurBzdsVEqcdhZu;

1.9
date	2014.07.26.19.38.03;	author naddy;	state Exp;
branches;
next	1.8;
commitid	R7QWrSO9abXyimb9;

1.8
date	2013.11.13.19.53.08;	author naddy;	state Exp;
branches;
next	1.7;

1.7
date	2013.08.13.16.47.27;	author naddy;	state Exp;
branches;
next	1.6;

1.6
date	2013.06.02.19.09.09;	author naddy;	state Exp;
branches;
next	1.5;

1.5
date	2013.04.07.20.07.24;	author naddy;	state Exp;
branches;
next	1.4;

1.4
date	2013.04.01.20.20.22;	author tobias;	state Exp;
branches;
next	1.3;

1.3
date	2011.06.02.13.41.38;	author ajacoutot;	state Exp;
branches;
next	1.2;

1.2
date	2011.04.21.11.28.22;	author landry;	state Exp;
branches;
next	1.1;

1.1
date	2010.11.13.09.24.52;	author ajacoutot;	state Exp;
branches;
next	;


desc
@@


1.14
log
@update chroot instructions for perl 5.24.1
@
text
@# $OpenBSD: README,v 1.13 2016/09/11 10:52:51 tb Exp $
# 
# +-----------------------------------------------------------------------
# | Running ${FULLPKGNAME} on OpenBSD
# +-----------------------------------------------------------------------
#
# Original author: Jolan Luff <jolan@@openbsd.org>
#
# In order to make CVSweb operate in a chroot environment, it is
# necessary to copy all of the relevant tools, libraries, and perl modules
# that CVSweb employs into /var/www.
#
# NOTE: You can run this README directly with sh(1).
#
# First, create the basic directory structure:

cd /var/www
mkdir -p tmp usr
chown www:www tmp	# needs to be writeable for the www user

cd /var/www/usr
mkdir -p bin lib libdata/perl5 libexec

cd /var/www/usr/libdata/perl5
mkdir -p File IPC Time warnings `arch -s`-openbsd/auto/Fcntl unicore

# The "annotate" function requires this empty file:
#
# NOTE: You can create an actual null device instead, but that will
# not work if the filesystem is mounted with the nodev option, and
# it is not required for cvsweb.

cd /var/www/dev
touch null

# Now, the required binaries:

cd /var/www/usr/bin
cp -p /usr/bin/{co,cvs,diff,perl,rcsdiff,rlog,uname} .

# Next, the libraries that the binaries are linked to:
#
# NOTE: Wildcards will, of course, copy any old, unused libraries that are
# lurking around (for example, from an upgrade):

cd /var/www/usr/lib
cp -p /usr/lib/lib{c,m,perl,pthread,util,z}.so* .

# Now, the run-time link-editor:

cd /var/www/usr/libexec
cp -p /usr/libexec/ld.so .

# And finally, the perl modules:

cd /var/www/usr/libdata/perl5
cp -p /usr/libdata/perl5/{Carp,Exporter,Symbol,base,integer}.pm .
cp -p /usr/libdata/perl5/{strict,warnings,vars,constant,utf8}.pm .
cp -p /usr/libdata/perl5/utf8_heavy.pl .
cp -p /usr/libdata/perl5/unicore/Heavy.pl ./unicore/
cp -p /usr/libdata/perl5/File/Basename.pm ./File/
cp -p /usr/libdata/perl5/IPC/Open{2,3}.pm ./IPC/
cp -p /usr/libdata/perl5/Time/Local.pm ./Time/
cp -p /usr/libdata/perl5/warnings/register.pm ./warnings/
cp -p /usr/libdata/perl5/XSLoader.pm .

cd /var/www/usr/libdata/perl5/`arch -s`-openbsd
cp -p /usr/libdata/perl5/`arch -s`-openbsd/{Config,Cwd}.pm .
cp -p /usr/libdata/perl5/`arch -s`-openbsd/Config_{git,heavy}.pl .
cp -p /usr/libdata/perl5/`arch -s`-openbsd/DynaLoader.pm .
cp -p /usr/libdata/perl5/`arch -s`-openbsd/Fcntl.pm .
cp -p /usr/libdata/perl5/`arch -s`-openbsd/auto/Fcntl/Fcntl.so ./auto/Fcntl/

# Editing cvsweb and cvsweb.conf
# ------------------------------
#
# The cvsweb program itself and cvsweb.conf both assume httpd is not
# running in a chroot environment, so we need to change some default paths
# so they are relative to /var/www.
#
# In /var/www/cgi-bin/cvsweb:
#
# for ("$mydir/cvsweb.conf", '/var/www/conf/cvsweb/cvsweb.conf') {
# for ("$mydir/cvsweb.conf", '/conf/cvsweb/cvsweb.conf') {
# 
# In /var/www/conf/cvsweb/cvsweb.conf:
# 
# Change CVSrepositories to reflect the location of the directories which
# contain CVSROOT.  This example shows a local repository NFS mounted over
# loopback into /var/www/cvs, since the directory must be relative to
# /var/www, we use /cvs.
#
# @@CVSrepositories = (
# 	'local'   => ['Local Repository', '/home/cvs'],	      (default)
# 	'local'   => ['Local Repository', '/cvs'],	      (chroot)
#
# And the same idea for $mimetypes:
#
# $mime_types = '/var/www/conf/mime.types';		       (default)
# $mime_types = '/conf/mime.types';			       (chroot)
@


1.13
log
@Refer to httpd instead of Apache.

ok naddy
@
text
@d1 1
a1 1
# $OpenBSD: README,v 1.12 2016/07/30 14:10:58 naddy Exp $
d25 1
a25 1
mkdir -p File IPC Time warnings `arch -s`-openbsd/5.20.3/auto/Fcntl unicore
d67 6
a72 7
cd /var/www/usr/libdata/perl5/`arch -s`-openbsd/5.20.3
cp -p /usr/libdata/perl5/`arch -s`-openbsd/5.20.3/{Config,Cwd}.pm .
cp -p /usr/libdata/perl5/`arch -s`-openbsd/5.20.3/Config_{git,heavy}.pl .
cp -p /usr/libdata/perl5/`arch -s`-openbsd/5.20.3/DynaLoader.pm .
cp -p /usr/libdata/perl5/`arch -s`-openbsd/5.20.3/Fcntl.pm .
cp -p /usr/libdata/perl5/`arch -s`-openbsd/5.20.3/auto/Fcntl/Fcntl.so \
    ./auto/Fcntl/
@


1.12
log
@update paths for Perl 5.20.3
@
text
@d1 1
a1 1
# $OpenBSD: README,v 1.11 2015/06/20 20:36:04 naddy Exp $
d78 1
a78 1
# The cvsweb program itself and cvsweb.conf both assume Apache is not
@


1.11
log
@update chroot instructions for perl 5.20.2
@
text
@d1 1
a1 1
# $OpenBSD: README,v 1.10 2014/11/25 11:59:37 naddy Exp $
d25 1
a25 1
mkdir -p File IPC Time warnings `arch -s`-openbsd/5.20.2/auto/Fcntl unicore
d67 6
a72 6
cd /var/www/usr/libdata/perl5/`arch -s`-openbsd/5.20.2
cp -p /usr/libdata/perl5/`arch -s`-openbsd/5.20.2/{Config,Cwd}.pm .
cp -p /usr/libdata/perl5/`arch -s`-openbsd/5.20.2/Config_{git,heavy}.pl .
cp -p /usr/libdata/perl5/`arch -s`-openbsd/5.20.2/DynaLoader.pm .
cp -p /usr/libdata/perl5/`arch -s`-openbsd/5.20.2/Fcntl.pm .
cp -p /usr/libdata/perl5/`arch -s`-openbsd/5.20.2/auto/Fcntl/Fcntl.so \
@


1.10
log
@fix chroot instructions for perl 5.20.1
@
text
@d1 1
a1 1
# $OpenBSD: README,v 1.9 2014/07/26 19:38:03 naddy Exp $
d25 1
a25 1
mkdir -p File IPC Time warnings `arch -s`-openbsd/5.20.1/auto/Fcntl unicore
d67 6
a72 6
cd /var/www/usr/libdata/perl5/`arch -s`-openbsd/5.20.1
cp -p /usr/libdata/perl5/`arch -s`-openbsd/5.20.1/{Config,Cwd}.pm .
cp -p /usr/libdata/perl5/`arch -s`-openbsd/5.20.1/Config_{git,heavy}.pl .
cp -p /usr/libdata/perl5/`arch -s`-openbsd/5.20.1/DynaLoader.pm .
cp -p /usr/libdata/perl5/`arch -s`-openbsd/5.20.1/Fcntl.pm .
cp -p /usr/libdata/perl5/`arch -s`-openbsd/5.20.1/auto/Fcntl/Fcntl.so \
@


1.9
log
@Fix chroot instructions to work with the perl version we ship in 5.6.
While here, drop some obsolete configuration examples and tweak the
default man.cgi URL.
ok espie@@
@
text
@d1 1
a1 1
# $OpenBSD: README,v 1.8 2013/11/13 19:53:08 naddy Exp $
d25 1
a25 1
mkdir -p File IPC Time warnings `arch -s`-openbsd/5.18.2/auto/Fcntl unicore
d67 6
a72 6
cd /var/www/usr/libdata/perl5/`arch -s`-openbsd/5.18.2
cp -p /usr/libdata/perl5/`arch -s`-openbsd/5.18.2/{Config,Cwd}.pm .
cp -p /usr/libdata/perl5/`arch -s`-openbsd/5.18.2/Config_{git,heavy}.pl .
cp -p /usr/libdata/perl5/`arch -s`-openbsd/5.18.2/DynaLoader.pm .
cp -p /usr/libdata/perl5/`arch -s`-openbsd/5.18.2/Fcntl.pm .
cp -p /usr/libdata/perl5/`arch -s`-openbsd/5.18.2/auto/Fcntl/Fcntl.{bs,so} \
@


1.8
log
@cvs doesn't link against Kerberos any longer, so less stuff needed in chroot
@
text
@d1 1
a1 1
# $OpenBSD: README,v 1.7 2013/08/13 16:47:27 naddy Exp $
d25 1
a25 1
mkdir -p File IPC Time warnings `arch -s`-openbsd/5.16.3/auto/Fcntl unicore
d67 6
a72 6
cd /var/www/usr/libdata/perl5/`arch -s`-openbsd/5.16.3
cp -p /usr/libdata/perl5/`arch -s`-openbsd/5.16.3/{Config,Cwd}.pm .
cp -p /usr/libdata/perl5/`arch -s`-openbsd/5.16.3/Config_{git,heavy}.pl .
cp -p /usr/libdata/perl5/`arch -s`-openbsd/5.16.3/DynaLoader.pm .
cp -p /usr/libdata/perl5/`arch -s`-openbsd/5.16.3/Fcntl.pm .
cp -p /usr/libdata/perl5/`arch -s`-openbsd/5.16.3/auto/Fcntl/Fcntl.{bs,so} \
@


1.7
log
@update chroot instructions: more Kerberos libraries required
@
text
@d1 1
a1 1
# $OpenBSD: README,v 1.6 2013/06/02 19:09:09 naddy Exp $
d47 1
a47 2
cp -p /usr/lib/lib{c,crypto,m,perl,pthread,util,z}.so* .
cp -p /usr/lib/lib{asn1,com_err,gssapi,heimbase,krb5,roken,wind}.so* .
@


1.6
log
@* Install icons under the document root.
* Reformat the README so that it can be fed directly to sh(1).
@
text
@d1 1
a1 1
# $OpenBSD: README,v 1.5 2013/04/07 20:07:24 naddy Exp $
d18 1
a18 1
mkdir tmp usr
d47 2
a48 1
cp -p /usr/lib/lib{c,crypto,gssapi,krb5,m,perl,pthread,util,z}.so* .
@


1.5
log
@More perl 5.16 fixes:
* Add further modules to README so that "annotate" will work.
* Fix a deprecation warning.
ok tobias@@, sthen@@
@
text
@d1 72
a72 70
$OpenBSD: README,v 1.4 2013/04/01 20:20:22 tobias Exp $

+-----------------------------------------------------------------------
| Running ${FULLPKGNAME} on OpenBSD
+-----------------------------------------------------------------------

# Author: Jolan Luff <jolan@@openbsd.org>

In order to make CVSweb operate in a chroot environment, it is
necessary to copy all of the relevant tools, libraries, and perl modules
that CVSweb employs into /var/www.

First, create the basic directory structure:

$ cd /var/www
# mkdir tmp usr
# chown www:www tmp	(needs to be writeable for the www user)

$ cd /var/www/usr
# mkdir -p {bin,lib,libdata/perl5,libexec}

$ cd /var/www/usr/libdata/perl5
# mkdir -p {File,IPC,Time,warnings,`machine`-openbsd/5.16.3/auto/Fcntl,unicore}

The "annotate" function requires this empty file:

NOTE: You can create an actual null device instead, but that will
not work if the filesystem is mounted with the nodev option, and
it is not required for cvsweb.

$ cd /var/www/dev
# touch null

Now, the required binaries:

$ cd /var/www/usr/bin
# cp -p /usr/bin/{co,cvs,diff,perl,rcsdiff,rlog,uname} .

Next, the libraries that the binaries are linked to:

NOTE: Wildcards will, of course, copy any old, unused libraries that are
lurking around (for example, from an upgrade):

$ cd /var/www/usr/lib
# cp -p /usr/lib/lib{c,crypto,gssapi,krb5,m,perl,pthread,util,z}.so* .

Now, the run-time link-editor:

$ cd /var/www/usr/libexec
# cp -p /usr/libexec/ld.so .

And finally, the perl modules:

$ cd /var/www/usr/libdata/perl5
# cp -p /usr/libdata/perl5/{Carp,Exporter,Symbol,base,integer}.pm .
# cp -p /usr/libdata/perl5/{strict,warnings,vars,constant,utf8}.pm .
# cp -p /usr/libdata/perl5/utf8_heavy.pl .
# cp -p /usr/libdata/perl5/unicore/Heavy.pl ./unicore/
# cp -p /usr/libdata/perl5/File/Basename.pm ./File/
# cp -p /usr/libdata/perl5/IPC/Open{2,3}.pm ./IPC/
# cp -p /usr/libdata/perl5/Time/Local.pm ./Time/
# cp -p /usr/libdata/perl5/warnings/register.pm ./warnings/
# cp -p /usr/libdata/perl5/XSLoader.pm .

$ cd /var/www/usr/libdata/perl5/`machine`-openbsd/5.16.3
# cp -p /usr/libdata/perl5/`machine`-openbsd/5.16.3/{Config,Cwd}.pm .
# cp -p /usr/libdata/perl5/`machine`-openbsd/5.16.3/Config_{git,heavy}.pl .
# cp -p /usr/libdata/perl5/`machine`-openbsd/5.16.3/DynaLoader.pm .
# cp -p /usr/libdata/perl5/`machine`-openbsd/5.16.3/Fcntl.pm .
# cp -p /usr/libdata/perl5/`machine`-openbsd/5.16.3/auto/Fcntl/Fcntl.{bs,so} \
d75 27
a101 27
Editing cvsweb and cvsweb.conf
------------------------------

The cvsweb program itself and cvsweb.conf both assume Apache is not
running in a chroot environment, so we need to change some default paths
so they are relative to /var/www.

In /var/www/cgi-bin/cvsweb:

for ("$mydir/cvsweb.conf", '/var/www/conf/cvsweb/cvsweb.conf') {
for ("$mydir/cvsweb.conf", '/conf/cvsweb/cvsweb.conf') {

In /var/www/conf/cvsweb/cvsweb.conf:

Change CVSrepositories to reflect the location of the directories which
contain CVSROOT.  This example shows a local repository NFS mounted over
loopback into /var/www/cvs, since the directory must be relative to
/var/www, we use /cvs.

@@CVSrepositories = (
	'local'   => ['Local Repository', '/home/cvs'],	      (default)
	'local'   => ['Local Repository', '/cvs'],	      (chroot)

And the same idea for $mimetypes:

$mime_types = '/var/www/conf/mime.types';		       (default)
$mime_types = '/conf/mime.types';			       (chroot)
@


1.4
log
@Update README after perl upgrade.

ok sthen
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.3 2011/06/02 13:41:38 ajacoutot Exp $
d23 1
a23 1
# mkdir -p {File,IPC,Time,warnings,`machine`-openbsd/5.16.3,unicore}
d63 1
d68 4
@


1.3
log
@Add a consistent header that substitutes FULLPKGNAME for the READMEs.

ok jasper@@ sthen@@
@
text
@d1 1
a1 1
$OpenBSD: README,v 1.2 2011/04/21 11:28:22 landry Exp $
d23 1
a23 1
# mkdir -p {File,IPC,Time,warnings,`machine`-openbsd/5.12.2}
d45 1
a45 1
# cp -p /usr/lib/lib{c,crypto,gssapi,krb5,m,perl,util,z}.so* .
d56 3
a58 1
# cp -p /usr/libdata/perl5/{strict,warnings,vars,constant}.pm .
d64 3
a66 3
$ cd /var/www/usr/libdata/perl5/`machine`-openbsd/5.12.2
# cp -p /usr/libdata/perl5/`machine`-openbsd/5.12.2/{Config,Cwd}.pm .
# cp -p /usr/libdata/perl5/`machine`-openbsd/5.12.2/Config_{git,heavy}.pl .
@


1.2
log
@Update instructions for running in chroot, from Mattieu Baptiste, thanks!
@
text
@d1 5
a5 1
$OpenBSD: README,v 1.1 2010/11/13 09:24:52 ajacoutot Exp $
@


1.1
log
@Move to pkg-readmes.
@
text
@d1 1
a1 1
$OpenBSD: README.chroot,v 1.8 2009/11/25 19:54:19 naddy Exp $
d19 1
a19 1
# mkdir -p {File,IPC,Time,warnings,`machine`-openbsd/5.10.1}
d41 1
a41 1
# cp -p /usr/lib/lib{c,crypto,des,gssapi,krb5,m,perl,util,z}.so* .
d58 3
a60 3
$ cd /var/www/usr/libdata/perl5/`machine`-openbsd/5.10.1
# cp -p /usr/libdata/perl5/`machine`-openbsd/5.10.1/{Config,Cwd}.pm .
# cp -p /usr/libdata/perl5/`machine`-openbsd/5.10.1/Config_{git,heavy}.pl .
@

