head	1.5;
access;
symbols
	OPENBSD_4_1:1.4.0.22
	OPENBSD_4_1_BASE:1.4
	OPENBSD_4_0:1.4.0.20
	OPENBSD_4_0_BASE:1.4
	OPENBSD_3_9:1.4.0.18
	OPENBSD_3_9_BASE:1.4
	OPENBSD_3_8:1.4.0.16
	OPENBSD_3_8_BASE:1.4
	OPENBSD_3_7:1.4.0.14
	OPENBSD_3_7_BASE:1.4
	OPENBSD_3_6:1.4.0.12
	OPENBSD_3_6_BASE:1.4
	OPENBSD_3_5:1.4.0.10
	OPENBSD_3_5_BASE:1.4
	OPENBSD_3_4:1.4.0.8
	OPENBSD_3_4_BASE:1.4
	OPENBSD_3_3:1.4.0.6
	OPENBSD_3_3_BASE:1.4
	OPENBSD_3_2:1.4.0.4
	OPENBSD_3_2_BASE:1.4
	OPENBSD_3_1:1.4.0.2
	OPENBSD_3_1_BASE:1.4
	OPENBSD_3_0:1.2.0.2
	OPENBSD_3_0_BASE:1.2
	libgtop_1_0_12:1.1.1.1
	todd:1.1.1;
locks; strict;
comment	@ * @;


1.5
date	2007.05.01.20.54.25;	author bernd;	state dead;
branches;
next	1.4;

1.4
date	2001.11.27.23.07.02;	author todd;	state Exp;
branches;
next	1.3;

1.3
date	2001.11.13.09.03.25;	author wilfried;	state Exp;
branches;
next	1.2;

1.2
date	2001.09.19.14.37.49;	author naddy;	state Exp;
branches;
next	1.1;

1.1
date	2001.09.13.20.45.46;	author todd;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2001.09.13.20.45.46;	author todd;	state Exp;
branches;
next	;


desc
@@


1.5
log
@Remove some old and broken gnome-1.x stuff.

ok robert@@, sturm@@, steven@@, espie@@
@
text
@$OpenBSD: patch-sysdeps_freebsd_procmap.c,v 1.4 2001/11/27 23:07:02 todd Exp $
--- sysdeps/freebsd/procmap.c.orig	Mon Nov 26 23:37:59 2001
+++ sysdeps/freebsd/procmap.c	Tue Nov 27 21:29:39 2001
@@@@ -32,9 +32,6 @@@@
 #include <sys/param.h>
 #include <sys/proc.h>
 #include <sys/resource.h>
-#include <vm/vm_object.h>
-#include <vm/vm_prot.h>
-#include <vm/vm_map.h>
 
 #include <sys/vnode.h>
 #include <sys/mount.h>
@@@@ -46,9 +43,8 @@@@
 #include <sys/user.h>
 #endif
 #include <sys/sysctl.h>
-#include <vm/vm.h>
 
-#if defined(__NetBSD__) && (__NetBSD_Version__ >= 104000000)
+#if (defined(__NetBSD__) && (__NetBSD_Version__ >= 104000000)) || defined(OpenBSD)
 /* Fixme ... */
 #undef _KERNEL
 #define _UVM_UVM_AMAP_I_H_ 1
@@@@ -82,7 +78,7 @@@@ glibtop_get_proc_map_p (glibtop *server,
 	struct kinfo_proc *pinfo;
 	struct vm_map_entry entry, *first;
 	struct vmspace vmspace;
-#if defined(__NetBSD__) && (__NetBSD_Version__ >= 104000000)
+#if (defined(__NetBSD__) && (__NetBSD_Version__ >= 104000000)) || defined(OpenBSD)
 	struct vnode vnode;
 	struct inode inode;
 #else
@@@@ -142,7 +138,7 @@@@ glibtop_get_proc_map_p (glibtop *server,
 
 	/* I tested this a few times with `mmap'; as soon as you write
 	 * to the mmap'ed area, the object type changes from OBJT_VNODE
-	 * to OBJT_DEFAULT so if seems this really works. */
+	 * to OBJT_DEFAULT so it seems this really works. */
 
 	do {
 		if (update) {
@@@@ -163,7 +159,7 @@@@ glibtop_get_proc_map_p (glibtop *server,
  			continue;
 #endif
 #else
-#if defined(__NetBSD__) && (__NetBSD_Version__ >= 104000000)
+#if (defined(__NetBSD__) && (__NetBSD_Version__ >= 104000000)) || defined(OpenBSD)
  		if (UVM_ET_ISSUBMAP (&entry))
 			continue;
 #else
@@@@ -189,7 +185,7 @@@@ glibtop_get_proc_map_p (glibtop *server,
 
 		i++;
 
-#if defined(__NetBSD__) && (__NetBSD_Version__ >= 104000000)
+#if (defined(__NetBSD__) && (__NetBSD_Version__ >= 104000000)) || defined(OpenBSD)
 		if (!entry.object.uvm_obj)
 			continue;
 
@@@@ -213,9 +209,7 @@@@ glibtop_get_proc_map_p (glibtop *server,
 			glibtop_error_io_r (server, "kvm_read (object)");
 #endif
 
-#if defined(__NetBSD__) && (__NetBSD_Version__ >= 104000000)
-		if (!vnode.v_uvm.u_flags & UVM_VNODE_VALID)
-			continue;
+#if (defined(__NetBSD__) && (__NetBSD_Version__ >= 104000000)) || defined(OpenBSD)
 
 		if ((vnode.v_type != VREG) || (vnode.v_tag != VT_UFS) ||
 		    !vnode.v_data) continue;
@


1.4
log
@Security update for libgtop to libgtop-1.0.13:

The Laboratory intexxia found a remote exploitable format string
vulnerability in libgtop_daemon which could cause privilege escalation
on a remote system.

The libgtop_daemon is not running by default if you run GNOME.

New since last version:

- security fix
- update for parallel install with libgtop-2.0
+ Only install shared libraries on shared arches.

From maintainer (Nils Nordman <nino@@nforced.com>).
@
text
@d1 1
a1 1
$OpenBSD: patch-sysdeps_freebsd_procmap.c,v 1.3 2001/11/13 09:03:25 wilfried Exp $
@


1.3
log
@don't use vm/vm.h, from maintainer
@
text
@d1 3
a3 3
$OpenBSD$
--- sysdeps/freebsd/procmap.c.orig	Thu May 27 20:56:48 1999
+++ sysdeps/freebsd/procmap.c	Mon Nov 12 20:54:39 2001
d61 1
a61 1
@@@@ -213,7 +209,7 @@@@ glibtop_get_proc_map_p (glibtop *server,
d66 2
a68 2
 		if (!vnode.v_uvm.u_flags & UVM_VNODE_VALID)
 			continue;
d70 2
@


1.2
log
@- fix message catalog installation
- sync libtool patches
- UVM is no longer an option
- remove useless install message
- add RCS Ids, clean up
@
text
@d3 1
a3 1
+++ sysdeps/freebsd/procmap.c	Mon Aug 27 17:26:53 2001
d14 3
a16 1
@@@@ -48,7 +45,7 @@@@
d18 1
a18 1
 #include <vm/vm.h>
d25 1
a25 1
@@@@ -82,7 +79,7 @@@@ glibtop_get_proc_map_p (glibtop *server,
d34 1
a34 1
@@@@ -142,7 +139,7 @@@@ glibtop_get_proc_map_p (glibtop *server,
d43 1
a43 1
@@@@ -163,7 +160,7 @@@@ glibtop_get_proc_map_p (glibtop *server,
d52 1
a52 1
@@@@ -189,7 +186,7 @@@@ glibtop_get_proc_map_p (glibtop *server,
d61 1
a61 1
@@@@ -213,7 +210,7 @@@@ glibtop_get_proc_map_p (glibtop *server,
@


1.1
log
@Initial revision
@
text
@d1 1
@


1.1.1.1
log
@portable library for obtaining system information
@
text
@@
