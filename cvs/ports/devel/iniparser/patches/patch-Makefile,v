head	1.2;
access;
symbols
	OPENBSD_6_2:1.2.0.20
	OPENBSD_6_2_BASE:1.2
	OPENBSD_6_1:1.2.0.18
	OPENBSD_6_1_BASE:1.2
	OPENBSD_6_0:1.2.0.16
	OPENBSD_6_0_BASE:1.2
	OPENBSD_5_9:1.2.0.12
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.2.0.14
	OPENBSD_5_8_BASE:1.2
	OPENBSD_5_7:1.2.0.10
	OPENBSD_5_7_BASE:1.2
	OPENBSD_5_6:1.2.0.8
	OPENBSD_5_6_BASE:1.2
	OPENBSD_5_5:1.2.0.6
	OPENBSD_5_5_BASE:1.2
	OPENBSD_5_4:1.2.0.4
	OPENBSD_5_4_BASE:1.2
	OPENBSD_5_3:1.2.0.2
	OPENBSD_5_3_BASE:1.2
	OPENBSD_5_2:1.1.1.1.0.2
	OPENBSD_5_2_BASE:1.1.1.1
	ajacoutot_20120616:1.1.1.1
	ajacoutot:1.1.1;
locks; strict;
comment	@# @;


1.2
date	2012.08.04.15.01.06;	author ajacoutot;	state Exp;
branches;
next	1.1;

1.1
date	2012.06.16.09.48.38;	author ajacoutot;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2012.06.16.09.48.38;	author ajacoutot;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Fix soname so that the library is properly loaded.
spotted by edd@@
@
text
@$OpenBSD: patch-Makefile,v 1.1.1.1 2012/06/16 09:48:38 ajacoutot Exp $
--- Makefile.orig	Sun Apr  8 16:44:57 2012
+++ Makefile	Wed Aug  1 08:32:34 2012
@@@@ -3,16 +3,16 @@@@
 #
 
 # Compiler settings
-CC      = gcc
-CFLAGS  = -O2 -fPIC -Wall -ansi -pedantic
+CC      ?= gcc
+CFLAGS  += -fPIC -Wall -ansi -pedantic
 
 # Ar settings to build the library
 AR	    = ar
 ARFLAGS = rcv
 
 SHLD = ${CC} ${CFLAGS}
-LDSHFLAGS = -shared -Wl,-Bsymbolic  -Wl,-rpath -Wl,/usr/lib -Wl,-rpath,/usr/lib
-LDFLAGS = -Wl,-rpath -Wl,/usr/lib -Wl,-rpath,/usr/lib
+LDSHFLAGS = -shared -Wl,-Bsymbolic  -Wl,-rpath -Wl,/usr/lib -Wl,-rpath,${PREFIX}/lib
+LDFLAGS = -Wl,-rpath -Wl,/usr/lib -Wl,-rpath,${PREFIX}/lib
 
 # Set RANLIB to ranlib on systems that require it (Sun OS < 4, Mac OSX)
 # RANLIB  = ranlib
@@@@ -28,7 +28,7 @@@@ SUFFIXES = .o .c .h .a .so .sl
 COMPILE.c=$(CC) $(CFLAGS) -c
 .c.o:
 	@@(echo "compiling $< ...")
-	@@($(COMPILE.c) -o $@@ $<)
+	($(COMPILE.c) -o $@@ $<)
 
 
 SRCS = src/iniparser.c \
@@@@ -40,12 +40,12 @@@@ OBJS = $(SRCS:.c=.o)
 default:	libiniparser.a libiniparser.so
 
 libiniparser.a:	$(OBJS)
-	@@($(AR) $(ARFLAGS) libiniparser.a $(OBJS))
-	@@($(RANLIB) libiniparser.a)
+	($(AR) $(ARFLAGS) libiniparser.a $(OBJS))
+	($(RANLIB) libiniparser.a)
 
 libiniparser.so:	$(OBJS)
-	@@$(SHLD) $(LDSHFLAGS) -o $@@.0 $(OBJS) $(LDFLAGS) \
-		-Wl,-soname=`basename $@@`.0
+	$(SHLD) $(LDSHFLAGS) -o $@@.${LIBiniparser_VERSION} $(OBJS) $(LDFLAGS) \
+		-Wl,-soname=`basename $@@.${LIBiniparser_VERSION}`
 
 clean:
 	$(RM) $(OBJS)
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
$OpenBSD$
d3 1
a3 1
+++ Makefile	Sat Jun 16 11:46:02 2012
d25 9
d47 1
a47 1
+		-Wl,-soname=`basename $@@`
@


1.1.1.1
log
@Import iniparser-3.1.

iniParser is a simple C library offering ini file parsing services.

input from and ok jasper@@
@
text
@@
