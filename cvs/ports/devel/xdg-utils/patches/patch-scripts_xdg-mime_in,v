head	1.3;
access;
symbols
	OPENBSD_6_0:1.3.0.4
	OPENBSD_6_0_BASE:1.3
	OPENBSD_5_9:1.3.0.2
	OPENBSD_5_9_BASE:1.3
	OPENBSD_5_8:1.2.0.6
	OPENBSD_5_8_BASE:1.2
	OPENBSD_5_7:1.2.0.2
	OPENBSD_5_7_BASE:1.2;
locks; strict;
comment	@# @;


1.3
date	2015.11.01.22.23.03;	author ajacoutot;	state Exp;
branches;
next	1.2;
commitid	m7fmE1ZJrLPRhB0t;

1.2
date	2015.01.04.15.36.22;	author ajacoutot;	state Exp;
branches;
next	1.1;
commitid	uIGTkjZHWJJFeiuF;

1.1
date	2014.08.28.10.26.21;	author ajacoutot;	state Exp;
branches;
next	;
commitid	Frtw9s8VeEV9DBnq;


desc
@@


1.3
log
@Update to xdg-utils-1.1.1.
@
text
@$OpenBSD: patch-scripts_xdg-mime_in,v 1.2 2015/01/04 15:36:22 ajacoutot Exp $
--- scripts/xdg-mime.in.orig	Mon Oct  5 20:59:19 2015
+++ scripts/xdg-mime.in	Sun Nov  1 23:17:38 2015
@@@@ -409,6 +409,9 @@@@ defapp_generic()
        for prefix in "$XDG_MENU_PREFIX" ""; do
           DEBUG 2 "Checking $x/applications/${prefix}defaults.list and $x/applications/${prefix}mimeinfo.cache"
           trader_result=`grep "$MIME=" $x/applications/${prefix}defaults.list $x/applications/${prefix}mimeinfo.cache 2> /dev/null | head -n 1 | cut -d '=' -f 2 | cut -d ';' -f 1`
+          if [ -z "$trader_result" ] ; then
+              trader_result=`grep "$MIME=" $x/applications/mimeinfo.cache 2>/dev/null | cut -d '=' -f 2 | cut -d ';' -f 1`
+          fi
           if [ -n "$trader_result" ] ; then
               echo $trader_result
               exit_success
@


1.2
log
@xdg-utils-1.1.0-rc3 is out, so use that for DISTFILE and drop all the
backport patches.
@
text
@d1 4
a4 4
$OpenBSD: patch-scripts_xdg-mime_in,v 1.1 2014/08/28 10:26:21 ajacoutot Exp $
--- scripts/xdg-mime.in.orig	Thu Oct  9 16:44:34 2014
+++ scripts/xdg-mime.in	Sun Jan  4 16:32:44 2015
@@@@ -384,6 +384,9 @@@@ defapp_generic()
d7 4
a10 4
           trader_result=`grep "$MIME=" $x/applications/${prefix}defaults.list $x/applications/${prefix}mimeinfo.cache 2> /dev/null | cut -d '=' -f 2 | cut -d ';' -f 1`
+       if [ -z "$trader_result" ] ; then
+          trader_result=`grep "$MIME=" $x/applications/mimeinfo.cache  2> /dev/null | cut -d '=' -f 2 | cut -d ';' -f 1`
+       fi
@


1.1
log
@Update to xdg-utils-1.1.0rc2 + fixes from upstream.
Committing now since these utilities tend to break after an update in very
subtle ways...
@
text
@d1 4
a4 4
$OpenBSD$
--- scripts/xdg-mime.in.orig	Thu Aug 28 11:47:45 2014
+++ scripts/xdg-mime.in	Thu Aug 28 11:48:30 2014
@@@@ -380,6 +380,9 @@@@ defapp_generic()
@

