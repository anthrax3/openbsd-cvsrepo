head	1.3;
access;
symbols
	OPENBSD_4_5:1.2.0.20
	OPENBSD_4_5_BASE:1.2
	OPENBSD_4_4:1.2.0.18
	OPENBSD_4_4_BASE:1.2
	OPENBSD_4_3:1.2.0.16
	OPENBSD_4_3_BASE:1.2
	OPENBSD_4_2:1.2.0.14
	OPENBSD_4_2_BASE:1.2
	OPENBSD_4_1:1.2.0.12
	OPENBSD_4_1_BASE:1.2
	OPENBSD_4_0:1.2.0.10
	OPENBSD_4_0_BASE:1.2
	OPENBSD_3_9:1.2.0.8
	OPENBSD_3_9_BASE:1.2
	OPENBSD_3_8:1.2.0.6
	OPENBSD_3_8_BASE:1.2
	OPENBSD_3_7:1.2.0.4
	OPENBSD_3_7_BASE:1.2
	OPENBSD_3_6:1.2.0.2
	OPENBSD_3_6_BASE:1.2
	OPENBSD_3_5:1.1.0.2
	OPENBSD_3_5_BASE:1.1;
locks; strict;
comment	@# @;


1.3
date	2009.06.01.23.05.32;	author benoit;	state dead;
branches;
next	1.2;

1.2
date	2004.04.20.12.32.53;	author avsm;	state Exp;
branches;
next	1.1;

1.1
date	2004.01.30.01.01.11;	author naddy;	state Exp;
branches;
next	;


desc
@@


1.3
log
@- update gputils to 0.13.7
- remove patches & regen PLIST
- change maintainer (timeout old maintainer)
- update testsuite

ok ajacoutot@@
@
text
@$OpenBSD: patch-gpal_gpal_c,v 1.2 2004/04/20 12:32:53 avsm Exp $
--- gpal/gpal.c.orig	2004-01-07 06:35:53.000000000 +0000
+++ gpal/gpal.c	2004-04-20 13:27:14.000000000 +0100
@@@@ -67,10 +67,11 @@@@ add_file(char *name,
   struct file_struct *file_data;
 
   if (extension != NULL) {
-    file_name = malloc(strlen(name) + strlen(extension)+ 2);
-    strcpy(file_name, name);
-    strcat(file_name, ".");
-    strcat(file_name, extension);
+    size_t len = strlen(name) + strlen(extension) + 2;
+    file_name = malloc(len);
+    strlcpy(file_name, name, len);
+    strlcat(file_name, ".", len);
+    strlcat(file_name, extension, len);
   } else {
     file_name = strdup(name);
   }
@@@@ -389,18 +390,18 @@@@ assemble(gp_boolean debug_info)
     exit(1);
   }
 
-  strcpy(command, "gpasm -c ");
+  strlcpy(command, "gpasm -c ", sizeof(command));
 
   if (debug_info) {
-    strcat(command, "-g ");
+    strlcat(command, "-g ", sizeof(command));
   }
 
   if (gp_quiet) {
-    strcat(command, "-q ");
+    strlcat(command, "-q ", sizeof(command));
   }
 
-  strcat(command, state.basefilename);
-  strcat(command, ".asm ");
+  strlcat(command, state.basefilename, sizeof(command));
+  strlcat(command, ".asm ", sizeof(command));
 
   if (!gp_debug_disable) {
     printf("%s\n", command);
@@@@ -438,38 +439,38 @@@@ combine_output(void)
     return;
 
   if (state.archive == true) {
-    strcpy(command, "gplib -c ");
+    strlcpy(command, "gplib -c ", sizeof(command));
   } else {
-    strcpy(command, "gplink ");
+    strlcpy(command, "gplink ", sizeof(command));
   }
   
   if (gp_quiet) {
-    strcat(command, "-q ");
+    strlcat(command, "-q ", sizeof(command));
   }
 
   if (state.options) {
-    strcat(command, state.options);
-    strcat(command, " ");
+    strlcat(command, state.options, sizeof(command));
+    strlcat(command, " ", sizeof(command));
   }
 
   if (state.outfilename == NULL) {
     if (state.archive == true) {
       gp_message("using \"library.a\" for archive name");
-      strcat(command, "library.a ");
+      strlcat(command, "library.a ", sizeof(command));
     }
   } else {
     if (state.archive == false) {
-      strcat(command, "-o ");    
+      strlcat(command, "-o ", sizeof(command));
     }
-    strcat(command, state.outfilename);
-    strcat(command, " ");
+    strlcat(command, state.outfilename, sizeof(command));
+    strlcat(command, " ", sizeof(command));
   }
 
   list = state.path;
   while(list) {
-    strcat(command, "-I ");    
-    strcat(command, gp_list_get(list)); 
-    strcat(command, " ");
+    strlcat(command, "-I ", sizeof(command));
+    strlcat(command, gp_list_get(list), sizeof(command));
+    strlcat(command, " ", sizeof(command));
     list = list->next;
   }  
   
@@@@ -477,8 +478,8 @@@@ combine_output(void)
   while(list) {
     file_data = gp_list_get(list);
     if (file_data->is_link) {
-      strcat(command, file_data->name); 
-      strcat(command, " ");
+      strlcat(command, file_data->name, sizeof(command));
+      strlcat(command, " ", sizeof(command));
     }
     list = list->next;
   }
@


1.2
log
@dont take sizeof(pointer) for length to strlcpy/strlcat
@
text
@d1 1
a1 1
$OpenBSD: patch-gpal_gpal_c,v 1.1 2004/01/30 01:01:11 naddy Exp $
@


1.1
log
@update to 0.12.0; from Andrew Dalgleish <openbsd@@ajd.net.au>
@
text
@d1 5
a5 4
$OpenBSD$
--- gpal/gpal.c.orig	2004-01-26 10:36:51.000000000 +1100
+++ gpal/gpal.c	2004-01-26 10:40:38.000000000 +1100
@@@@ -68,9 +68,9 @@@@ add_file(char *name,
d8 1
a8 1
     file_name = malloc(strlen(name) + strlen(extension)+ 2);
d12 5
a16 3
+    strlcpy(file_name, name, sizeof(file_name));
+    strlcat(file_name, ".", sizeof(file_name));
+    strlcat(file_name, extension, sizeof(file_name));
d20 1
a20 1
@@@@ -389,18 +389,18 @@@@ assemble(gp_boolean debug_info)
d44 1
a44 1
@@@@ -438,38 +438,38 @@@@ combine_output(void)
d95 1
a95 1
@@@@ -477,8 +477,8 @@@@ combine_output(void)
@

