head	1.7;
access;
symbols
	OPENBSD_5_0:1.4.0.2
	OPENBSD_5_0_BASE:1.4
	OPENBSD_4_9:1.3.0.2
	OPENBSD_4_9_BASE:1.3
	jasper_20100212:1.1.1.1
	jasper:1.1.1;
locks; strict;
comment	@# @;


1.7
date	2011.11.11.15.48.39;	author jasper;	state dead;
branches;
next	1.6;

1.6
date	2011.09.06.20.36.24;	author jasper;	state Exp;
branches;
next	1.5;

1.5
date	2011.08.24.12.05.55;	author jasper;	state Exp;
branches;
next	1.4;

1.4
date	2011.04.02.08.22.28;	author jasper;	state Exp;
branches;
next	1.3;

1.3
date	2010.12.02.18.41.46;	author jasper;	state Exp;
branches;
next	1.2;

1.2
date	2010.12.02.11.40.53;	author jasper;	state Exp;
branches;
next	1.1;

1.1
date	2010.12.02.10.35.04;	author jasper;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2010.12.02.10.35.04;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.7
log
@- update to 0.18
@
text
@$OpenBSD: patch-rf2500_c,v 1.6 2011/09/06 20:36:24 jasper Exp $

From 7a0a30f62665ba85fa6e74ec3d9541bcafec34ad Mon Sep 17 00:00:00 2001
From: Daniel Beer <dlbeer@@gmail.com>
Date: Wed, 7 Sep 2011 08:18:00 +1200
Subject: [PATCH] usb_bulk_read: may return 0 on timeout.

--- rf2500.c.orig	Wed Aug 24 06:24:16 2011
+++ rf2500.c	Tue Sep  6 22:35:25 2011
@@@@ -231,7 +231,7 @@@@ transport_t rf2500_open(const char *devpath, const cha
 #ifndef __APPLE__
 	while (usb_bulk_read(tr->handle, USB_FET_IN_EP,
 			     buf, sizeof(buf),
-			     100) >= 0);
+			     100) > 0);
 #endif
 
 	return (transport_t)tr;
@


1.6
log
@sync patch with upstream
@
text
@d1 1
a1 1
$OpenBSD$
@


1.5
log
@- update mspdebug to 0.17
@
text
@d1 1
a1 1
$OpenBSD: patch-rf2500_c,v 1.4 2011/04/02 08:22:28 jasper Exp $
d3 4
a6 1
- usb_bulk_read() returns 0 on timeout, not -1
d9 2
a10 2
+++ rf2500.c	Wed Aug 24 13:54:24 2011
@@@@ -231,8 +231,12 @@@@ transport_t rf2500_open(const char *devpath, const cha
d14 1
a14 1
+#if defined(__OpenBSD__)
d16 1
a16 5
+#else
 			     100) >= 0);
-#endif
+#endif /* __OpenBSD__ */
+#endif /* !__APPLE__ */
a18 1
 }
@


1.4
log
@- update mspdebug to 0.14
* most patches have been committed upstream

tested on a launchpad
@
text
@d1 1
a1 1
$OpenBSD: patch-rf2500_c,v 1.3 2010/12/02 18:41:46 jasper Exp $
d5 3
a7 3
--- rf2500.c.orig	Sun Feb  6 23:55:37 2011
+++ rf2500.c	Sat Apr  2 10:03:14 2011
@@@@ -221,8 +221,12 @@@@ transport_t rf2500_open(const char *devpath)
@


1.3
log
@- update mspdebug to 0.13
- remove support for Olimex MSP430-JTAG-ISO which requires a linux-only ioctl.
@
text
@d1 1
a1 1
$OpenBSD: patch-rf2500_c,v 1.2 2010/12/02 11:40:53 jasper Exp $
d5 2
a6 11
--- rf2500.c.orig	Mon Nov  8 22:40:57 2010
+++ rf2500.c	Thu Dec  2 13:31:01 2010
@@@@ -67,7 +67,7 @@@@ static int open_interface(struct rf2500_transport *tr,
 		return -1;
 	}
 
-#if !(defined(__APPLE__) || defined(WIN32))
+#if defined (__linux__)
 	if (usb_detach_kernel_driver_np(tr->handle, tr->int_number) < 0)
 		pr_error("rf2500: warning: can't "
 			"detach kernel driver");
@


1.2
log
@- use better ifdef blocks
@
text
@d1 1
a1 1
$OpenBSD: patch-rf2500_c,v 1.1.1.1 2010/12/02 10:35:04 jasper Exp $
d5 3
a7 3
--- rf2500.c.orig	Sun Nov 28 12:04:17 2010
+++ rf2500.c	Thu Dec  2 00:36:44 2010
@@@@ -66,7 +66,7 @@@@ static int open_interface(struct rf2500_transport *tr,
d12 1
a12 1
+#if defined(__linux__)
d14 1
a14 1
 		perror("rf2500: warning: can't "
d16 2
a17 2
@@@@ -215,7 +215,7 @@@@ transport_t rf2500_open(const char *devpath)
 	/* Flush out lingering data */
d20 1
a20 1
-			     100) >= 0);
d22 5
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
$OpenBSD$
d12 1
a12 1
+#if !(defined(__APPLE__) || defined(WIN32) || defined(__OpenBSD__))
@


1.1.1.1
log
@import mspdebug 0.10

MSPDebug is a free debugger for use with MSP430 MCUs. It supports
FET430UIF, eZ430, RF2500 and Olimex MSP-JTAG-TINY programmers. It can be
used as a proxy for gdb or as an independent debugger with support for
programming, disassembly and reverse engineering.

With a patch from jakemsr@@ to work around a ugen/libusb issue where
usb_bulk_read return 0 on timeout, which isn't deal with properly.

ok ajacoutot@@
@
text
@@
