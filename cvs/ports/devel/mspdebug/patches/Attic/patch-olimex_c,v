head	1.6;
access;
symbols
	OPENBSD_4_9:1.3.0.2
	OPENBSD_4_9_BASE:1.3
	jasper_20100212:1.1.1.1
	jasper:1.1.1;
locks; strict;
comment	@# @;


1.6
date	2011.11.11.15.48.39;	author jasper;	state dead;
branches;
next	1.5;

1.5
date	2011.09.06.20.36.24;	author jasper;	state Exp;
branches;
next	1.4;

1.4
date	2011.04.02.08.22.28;	author jasper;	state dead;
branches;
next	1.3;

1.3
date	2010.12.02.18.41.46;	author jasper;	state Exp;
branches;
next	1.2;

1.2
date	2010.12.02.11.40.53;	author jasper;	state Exp;
branches;
next	1.1;

1.1
date	2010.12.02.10.35.04;	author jasper;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2010.12.02.10.35.04;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.6
log
@- update to 0.18
@
text
@$OpenBSD: patch-olimex_c,v 1.5 2011/09/06 20:36:24 jasper Exp $

From 7a0a30f62665ba85fa6e74ec3d9541bcafec34ad Mon Sep 17 00:00:00 2001
From: Daniel Beer <dlbeer@@gmail.com>
Date: Wed, 7 Sep 2011 08:18:00 +1200
Subject: [PATCH] usb_bulk_read: may return 0 on timeout.

--- olimex.c.orig	Wed Aug 24 06:24:16 2011
+++ olimex.c	Tue Sep  6 22:35:25 2011
@@@@ -272,7 +272,7 @@@@ transport_t olimex_open(const char *devpath, const cha
 	/* Flush out lingering data */
 	while (usb_bulk_read(tr->handle, tr->in_ep,
 			     buf, sizeof(buf),
-			     100) >= 0);
+			     100) > 0);
 
 	return (transport_t)tr;
 }
@


1.5
log
@sync patch with upstream
@
text
@d1 1
a1 1
$OpenBSD$
@


1.4
log
@- update mspdebug to 0.14
* most patches have been committed upstream

tested on a launchpad
@
text
@d1 15
a15 15
$OpenBSD: patch-olimex_c,v 1.3 2010/12/02 18:41:46 jasper Exp $
--- olimex.c.orig	Mon Nov  8 22:40:57 2010
+++ olimex.c	Thu Dec  2 13:05:14 2010
@@@@ -66,7 +66,7 @@@@ struct olimex_transport {
 static int open_interface(struct olimex_transport *tr,
 			  struct usb_device *dev, int ino)
 {
-#if !(defined (__APPLE__) || defined(WIN32))
+#if defined(__linux__)
 	int drv;
 	char drName[256];
 #endif
@@@@ -82,7 +82,7 @@@@ static int open_interface(struct olimex_transport *tr,
 		return -1;
 	}
d17 2
a18 5
-#if !(defined(__APPLE__) || defined(WIN32))
+#if defined(__linux__)
 	drv = usb_get_driver_np(tr->handle, tr->int_number, drName,
 				sizeof(drName));
 	printc(__FILE__" : driver %d\n", drv);
@


1.3
log
@- update mspdebug to 0.13
- remove support for Olimex MSP430-JTAG-ISO which requires a linux-only ioctl.
@
text
@d1 1
a1 1
$OpenBSD: patch-olimex_c,v 1.2 2010/12/02 11:40:53 jasper Exp $
@


1.2
log
@- use better ifdef blocks
@
text
@d1 4
a4 4
$OpenBSD: patch-olimex_c,v 1.1.1.1 2010/12/02 10:35:04 jasper Exp $
--- olimex.c.orig	Wed Aug  4 04:08:43 2010
+++ olimex.c	Thu Aug 12 13:04:12 2010
@@@@ -65,7 +65,7 @@@@ struct olimex_transport {
d13 1
a13 1
@@@@ -81,7 +81,7 @@@@ static int open_interface(struct olimex_transport *tr,
d21 1
a21 1
 	printf(__FILE__" : driver %d\n", drv);
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
$OpenBSD$
d9 1
a9 1
+#if !(defined (__APPLE__) || defined(WIN32) || defined(__OpenBSD__))
d18 1
a18 1
+#if !(defined(__APPLE__) || defined(WIN32) || defined(__OpenBSD__))
@


1.1.1.1
log
@import mspdebug 0.10

MSPDebug is a free debugger for use with MSP430 MCUs. It supports
FET430UIF, eZ430, RF2500 and Olimex MSP-JTAG-TINY programmers. It can be
used as a proxy for gdb or as an independent debugger with support for
programming, disassembly and reverse engineering.

With a patch from jakemsr@@ to work around a ugen/libusb issue where
usb_bulk_read return 0 on timeout, which isn't deal with properly.

ok ajacoutot@@
@
text
@@
