head	1.28;
access;
symbols
	OPENBSD_6_1:1.27.0.12
	OPENBSD_6_1_BASE:1.27
	OPENBSD_6_0:1.27.0.10
	OPENBSD_6_0_BASE:1.27
	OPENBSD_5_9:1.27.0.6
	OPENBSD_5_9_BASE:1.27
	OPENBSD_5_8:1.27.0.8
	OPENBSD_5_8_BASE:1.27
	OPENBSD_5_7:1.27.0.4
	OPENBSD_5_7_BASE:1.27
	OPENBSD_5_6:1.27.0.2
	OPENBSD_5_6_BASE:1.27
	OPENBSD_5_5:1.26.0.2
	OPENBSD_5_5_BASE:1.26
	OPENBSD_5_4:1.25.0.2
	OPENBSD_5_4_BASE:1.25
	OPENBSD_5_3:1.24.0.2
	OPENBSD_5_3_BASE:1.24
	OPENBSD_5_2:1.23.0.2
	OPENBSD_5_2_BASE:1.23
	OPENBSD_5_1_BASE:1.22
	OPENBSD_5_1:1.22.0.2
	OPENBSD_5_0:1.21.0.2
	OPENBSD_5_0_BASE:1.21
	OPENBSD_4_9:1.19.0.2
	OPENBSD_4_9_BASE:1.19
	OPENBSD_4_8:1.7.0.2
	OPENBSD_4_8_BASE:1.7
	OPENBSD_4_7:1.4.0.2
	OPENBSD_4_7_BASE:1.4
	martynas_20090728:1.1.1.1
	martynas:1.1.1;
locks; strict;
comment	@# @;


1.28
date	2017.07.29.06.33.46;	author landry;	state dead;
branches;
next	1.27;
commitid	9BTPHx3lwRtAKql0;

1.27
date	2014.04.29.21.37.20;	author landry;	state Exp;
branches;
next	1.26;

1.26
date	2013.10.19.16.26.55;	author landry;	state Exp;
branches;
next	1.25;

1.25
date	2013.03.11.10.50.32;	author espie;	state Exp;
branches;
next	1.24;

1.24
date	2012.12.04.21.05.30;	author landry;	state Exp;
branches;
next	1.23;

1.23
date	2012.04.07.13.10.50;	author landry;	state Exp;
branches;
next	1.22;

1.22
date	2011.12.08.00.19.07;	author nigel;	state Exp;
branches;
next	1.21;

1.21
date	2011.06.15.16.16.10;	author sthen;	state Exp;
branches;
next	1.20;

1.20
date	2011.03.26.13.25.50;	author landry;	state Exp;
branches;
next	1.19;

1.19
date	2011.01.14.22.50.38;	author landry;	state Exp;
branches;
next	1.18;

1.18
date	2010.11.15.19.46.10;	author espie;	state Exp;
branches;
next	1.17;

1.17
date	2010.11.08.09.20.49;	author espie;	state Exp;
branches;
next	1.16;

1.16
date	2010.10.26.10.15.39;	author landry;	state Exp;
branches;
next	1.15;

1.15
date	2010.10.26.10.01.33;	author landry;	state Exp;
branches;
next	1.14;

1.14
date	2010.10.24.21.11.03;	author ajacoutot;	state Exp;
branches;
next	1.13;

1.13
date	2010.10.22.19.24.47;	author landry;	state Exp;
branches;
next	1.12;

1.12
date	2010.10.15.08.32.21;	author landry;	state Exp;
branches;
next	1.11;

1.11
date	2010.10.11.08.12.31;	author jasper;	state Exp;
branches;
next	1.10;

1.10
date	2010.10.03.16.28.06;	author kili;	state Exp;
branches;
next	1.9;

1.9
date	2010.09.26.09.49.53;	author kili;	state Exp;
branches;
next	1.8;

1.8
date	2010.09.12.17.58.51;	author landry;	state Exp;
branches;
next	1.7;

1.7
date	2010.07.11.14.55.56;	author landry;	state Exp;
branches;
next	1.6;

1.6
date	2010.06.20.19.44.40;	author landry;	state Exp;
branches;
next	1.5;

1.5
date	2010.04.24.16.08.01;	author landry;	state Exp;
branches;
next	1.4;

1.4
date	2010.01.30.19.08.30;	author jolan;	state Exp;
branches;
next	1.3;

1.3
date	2009.08.10.06.31.08;	author kili;	state Exp;
branches;
next	1.2;

1.2
date	2009.07.27.21.55.49;	author martynas;	state Exp;
branches;
next	1.1;

1.1
date	2009.07.27.21.35.56;	author martynas;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2009.07.27.21.35.56;	author martynas;	state Exp;
branches;
next	;


desc
@@


1.28
log
@Remove xulrunner/24.

Doesn't build with clang (and it's a fscking maze of
defines/headers/wrappers to fix..), this branch is dead upstream since 3
years, all consumers have been either removed or prevented from using it,
and xul itself as a technology is considered dead upstream, HTML5 killed
it.

further cleanup to come in mozilla.port.mk.

ok ajacoutot@@ sthen@@
@
text
@# $OpenBSD: Makefile.inc,v 1.27 2014/04/29 21:37:20 landry Exp $

COMMENT-main =		standalone XUL/XPCOM runtime environment
COMMENT-devel =		devel files for Gecko
PKGNAME =		xulrunner-${MOZILLA_VERSION:S/esr//}
PKGNAME-main =		xulrunner-${MOZILLA_VERSION:S/esr//}
PKGNAME-devel =		xulrunner-devel-${MOZILLA_VERSION:S/esr//}

MOZILLA_CODENAME =	xulrunner
CATEGORIES +=		devel

HOMEPAGE =		http://developer.mozilla.org/en/docs/XULRunner

MULTI_PACKAGES +=	-main -devel

# MPL
PERMIT_PACKAGE_CDROM=	Yes

# lots of logic in mozilla.port.mk
MODULES +=		www/mozilla devel/gettext lang/python
MODPY_RUNDEP =		No

LIB_DEPENDS-main =	${LIB_DEPENDS}
WANTLIB-main =		${WANTLIB}

MODGNU_CONFIG_GUESS_DIRS +=	${WRKSRC}/build/autoconf

CONFIGURE_STYLE =	autoconf no-autoheader
CONFIGURE_ARGS +=	--disable-javaxpcom \
			--enable-extensions=default,cookie,permissions
@


1.27
log
@Update to xulrunner 24.5.0.

- building from firefox-esr source tarball will allow us to better track
  security fixes.. and download one less distfile.
- remove the two config/system-headers patches from #944454, were merged
  in esr24 branch.

Went in a bulk build without fallout..
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.inc,v 1.26 2013/10/19 16:26:55 landry Exp $
@


1.26
log
@Prepare for an upcoming xulrunner/24 port, move some WANTLIB/LIB_DEPENDS
around, fix @@conflict markers...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.inc,v 1.25 2013/03/11 10:50:32 espie Exp $
d5 3
a7 3
PKGNAME =		xulrunner-${MOZILLA_VERSION}
PKGNAME-main =		xulrunner-${MOZILLA_VERSION}
PKGNAME-devel =		xulrunner-devel-${MOZILLA_VERSION}
@


1.25
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.inc,v 1.24 2012/12/04 21:05:30 landry Exp $
d20 1
a20 1
MODULES =		www/mozilla devel/gettext lang/python
a24 7

LIB_DEPENDS-devel =	${MODGETTEXT_LIB_DEPENDS} \
			devel/libIDL \
			${PKGNAME-main}:${BASE_PKGPATH},-main
WANTLIB-devel +=	${MODGETTEXT_WANTLIB} \
			c glib-2.0 gobject-2.0 m pthread stdc++ \
			IDL-2 nspr4 plc4 plds4
@


1.24
log
@Winter cleanup of the mozillas :

- Add gtar to BUILD_DEPENDS everywhere in moz.port.mk, since fx 18 will
  start using gtar-only options. Ditto for unzip, used during install.
- special-case the deps for firefox/thunderbird/seamonkey, since those
  are maintained on the long-term. Only those need to depend on the
latest and greatest nss/nspr.
- move the '--relax LDFLAGS for ppc' to moz.port.mk
- move the 'yasm BUILD_DEPENDS for i385/amd64' to moz.port.mk
- move more common CONFIGURE_ARGS to moz.port.mk (libevent,gio,bz2,gconf..)
- fix MODMOZ_WANTLIB wrt nss/nspr majors
- ensure we depend on sqlite3>=21, needed for fx/tb 18
- use --with-system-jpeg only in firefox36/sunbird/fennec/xulrunner,
  fx/tb 18 will have to use its bundled libjpeg-turbo (#791305)
- bump REVISIONs for the WANTLIB/LIB_DEPENDS change.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.inc,v 1.23 2012/04/07 13:10:50 landry Exp $
a17 3
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
@


1.23
log
@Assorted cleanups to xulrunner 1.9 port :

- rename libxul{,-embedding}.pc files to libxul19{,-embedding}.pc to
  cope with an eventual xulrunner built from latest mozilla
- move some WANTLIB-devel from Makefile.inc to 1.9/Makefile
- use BASE_PKGPATH instead of devel/xulrunner/${MOZILLA_VERSION:R:R}, as
  there might be a devel/xulrunner/last someday
- sanitize the subst regexps done on the .pc files, half of them were
  useless
- bump REVISIONs.

Tested in a full bulk build with all xulrunner users..
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.inc,v 1.22 2011/12/08 00:19:07 nigel Exp $
d33 1
a33 1
			c glib-2.0 gobject-2.0 gthread-2.0 m pthread stdc++ \
@


1.22
log
@Update to xulrunner v1.9.2.24 sent to ports@@ for review.
Built on i386/amd64.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.inc,v 1.21 2011/06/15 16:16:10 sthen Exp $
d31 1
a31 1
			${PKGNAME-main}:devel/xulrunner/${MOZILLA_VERSION:R:R},-main
d34 1
a34 3
			IDL-2 nspr4 plc4 plds4 \
			${MOZILLA_PROJECT}/mozjs ${MOZILLA_PROJECT}/xpcom \
			${MOZILLA_PROJECT}/xul
d39 1
a39 1
CONFIGURE_ARGS =	--disable-javaxpcom \
@


1.21
log
@the Mozilla ports don't need Python at runtime, so set MODPY_RUNDEP=No.
(Firefox was already set this way). ok/reminder about sunbird landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.inc,v 1.20 2011/03/26 13:25:50 landry Exp $
d29 1
a29 2
LIB_DEPENDS-devel +=	${LIB_DEPENDS} \
			${MODGETTEXT_LIB_DEPENDS} \
@


1.20
log
@Use PATCHDIR and FILESDIR from www/firefox36. Fix LIB_DEPENDS while here.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.inc,v 1.19 2011/01/14 22:50:38 landry Exp $
d24 1
@


1.19
log
@Chase mozilla-firefox change and build against system sqlite too.
ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.inc,v 1.18 2010/11/15 19:46:10 espie Exp $
d28 2
a29 1
LIB_DEPENDS-devel +=	${MODGETTEXT_LIB_DEPENDS} \
@


1.18
log
@move depends to new style
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.inc,v 1.17 2010/11/08 09:20:49 espie Exp $
a40 1
			--disable-system-sqlite \
@


1.17
log
@forgotten commit, noticed by landry...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.inc,v 1.16 2010/10/26 10:15:39 landry Exp $
d29 2
a30 2
			::devel/libIDL \
			:${PKGNAME-main}:devel/xulrunner/${MOZILLA_VERSION:R:R},-main
@


1.16
log
@spacing
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.inc,v 1.15 2010/10/26 10:01:33 landry Exp $
d31 5
a35 2
WANTLIB-devel +=	c glib-2.0 gobject-2.0 gthread-2.0 m pthread stdc++ IDL-2 nspr4 plc4 plds4 \
			${MOZILLA_PROJECT}/mozjs ${MOZILLA_PROJECT}/xpcom ${MOZILLA_PROJECT}/xul
@


1.15
log
@Convert to use www/mozilla MODULE, removes shitload of lines. Less kittens cry.
Went in a bunch of bulks without fallout..
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.inc,v 1.13 2010/10/22 19:24:47 landry Exp $
d3 2
a4 2
COMMENT-main=		standalone XUL/XPCOM runtime environment
COMMENT-devel=		devel files for Gecko
d10 1
a10 1
CATEGORIES+=		devel
d12 1
a12 1
HOMEPAGE=		http://developer.mozilla.org/en/docs/XULRunner
d14 1
a14 1
MULTI_PACKAGES+=	-main -devel
@


1.14
log
@Remove USE_X11.
@
text
@a2 8
#
# For legacy reasons (smooth updates), directory is xulrunner.
# New versions of xulrunner will actually use xulrunnerX.Y.
#
DIRECTORY?=		xulrunner

ONLY_FOR_ARCHS+=	alpha amd64 arm i386 powerpc sparc sparc64

d5 3
d9 1
a9 5
DISTNAME?=		mozilla
PKGNAME=		xulrunner-${VERSION}
PKGNAME-main=		xulrunner-${VERSION}
PKGNAME-devel=		xulrunner-devel-${VERSION}

d22 17
a38 59
MASTER_SITES+=		http://releases.mozilla.org/pub/mozilla.org/xulrunner/releases/${VERSION}/source \
			http://openbsddistfiles.com/martynas/mozilla/xulrunner/
DISTFILES?=		xulrunner-${VERSION}-source.tar.bz2

MODULES+=		devel/gettext
BUILD_DEPENDS+=		:zip->=2.3:archivers/zip
LIB_DEPENDS+=		::x11/gtk+2 \
			:nspr->=4.7:devel/nspr \
			:nss->=3.12:security/nss
WANTLIB+=		c glib-2.0 m pthread stdc++ \
			nspr4.>=20 plc4.>=20 plds4.>=20

WANTLIB-main+=		${WANTLIB} X11 Xau Xcomposite Xcursor Xdamage Xdmcp \
			Xext Xfixes Xi Xinerama Xrandr Xrender Xt atk-1.0 \
			cairo expat fontconfig freetype gmodule-2.0 \
			gobject-2.0 gthread-2.0 jpeg pango-1.0 pangocairo-1.0 \
			pangoft2-1.0 pixman-1 png pthread-stubs xcb z gio-2.0 \
			xcb-render GL Xxf86vm drm xcb-shm \
 			gdk-x11-2.0 gdk_pixbuf-2.0 gtk-x11-2.0 \
			nss3.>=22 smime3.>=22 softokn3.>=22 ssl3.>=22

LIB_DEPENDS-devel+=	${MODGETTEXT_LIB_DEPENDS} ::devel/libIDL \
			:${PKGNAME-main}:devel/xulrunner/${VERSION:R:R},-main
WANTLIB-devel+=		${WANTLIB} IDL-2 nspr4 plc4 plds4 ${DIRECTORY}/mozjs ${DIRECTORY}/xpcom ${DIRECTORY}/xul

VMEM_WARNING=		Yes

USE_GMAKE=		Yes
NO_REGRESS=		Yes

MODGNU_CONFIG_GUESS_DIRS+=	${WRKSRC}/build/autoconf

AUTOCONF_VERSION=	2.13
CONFIGURE_STYLE=	autoconf no-autoheader
CONFIGURE_ARGS+=	--with-system-jpeg=${LOCALBASE}	\
			--with-system-zlib=/usr/lib	\
			--with-system-nspr		\
			--with-system-nss		\
			--with-pthreads			\
			--enable-xft			\
			--disable-optimize		\
			--disable-debug			\
			--disable-freetypetest		\
			--disable-mochitest		\
			--disable-libIDLtest		\
			--disable-glibtest		\
			--disable-tests			\
			--disable-pedantic		\
			--disable-installer		\
			--disable-updater		\
			--disable-gnomeui		\
			--disable-gnomevfs		\
			--disable-dbus			\
			--disable-javaxpcom		\
			--enable-xinerama		\
			--enable-svg			\
			--enable-svg-renderer=cairo	\
			--enable-canvas			\
			--enable-application=xulrunner	\
a39 9

MAKE_ENV+=		MOZ_CO_PROJECT=xulrunner \
			LD_LIBRARY_PATH="${WRKSRC}/dist/bin" \
			BUILD_OFFICIAL=1 \
			MOZILLA_OFFICIAL=1 \
			SO_VERSION="${SO_VERSION}" \
			mozappdir="${LOCALBASE}/${DIRECTORY}"
CONFIGURE_ENV+=		${MAKE_ENV} \
			topsrcdir=${WRKSRC}
@


1.13
log
@Refix WANTLIB, X11-xcb shouldn't be here. Bump REVISION.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.inc,v 1.12 2010/10/15 08:32:21 landry Exp $
a57 1
USE_X11=		Yes
@


1.12
log
@Build xulrunner 1.9.2.x against bundled cairo, and fix WANTLIB while
here. Keep building xulrunner 1.8.x against systemwide cairo, as it
doesn't build with bundled cairo, because systemwide pango is too
recent and uses structs not defined in bundled cairo headers.
Too bad for the remaining xl 1.8 users, gtk-vnc-plugin and swt-browser..
if they fail, be my guest, fix them.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.inc,v 1.11 2010/10/11 08:12:31 jasper Exp $
d48 1
a48 1
			xcb-render GL X11-xcb Xxf86vm drm xcb-shm \
@


1.11
log
@- fix WANTLIB after cairo update.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.inc,v 1.10 2010/10/03 16:28:06 kili Exp $
d48 1
a48 1
			xcb-render xcb-render-util \
a88 1
			--enable-system-cairo		\
@


1.10
log
@Add openbsddistfiles.com to master_sites as martynas did for the other
stuff a week ago. Reminded by Mikolaj Kucharski.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.inc,v 1.9 2010/09/26 09:49:53 kili Exp $
d45 1
a45 1
			cairo expat fontconfig freetype glitz gmodule-2.0 \
@


1.9
log
@Zap malware spreading server from MASTER_SITES.

ok landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.inc,v 1.8 2010/09/12 17:58:51 landry Exp $
d31 2
a32 1
MASTER_SITES+=		http://releases.mozilla.org/pub/mozilla.org/xulrunner/releases/${VERSION}/source
@


1.8
log
@Chase mozilla-firefox update and bump xulrunner to 1.9.2.9.
Switch to use internal sqlite as now mozilla needs SQLITE_SECURE_DELETE
set, and there's no way we're going to do that with systemwide sqlite.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.inc,v 1.7 2010/07/11 14:55:56 landry Exp $
d31 1
a31 2
MASTER_SITES+=		http://releases.mozilla.org/pub/mozilla.org/xulrunner/releases/${VERSION}/source/ \
			http://openbsddistfiles.org/martynas/mozilla/xulrunner/
@


1.7
log
@Switch to newer LIB_DEPENDS/WANTLIB/REVISION, remove PATCHLEVEL.
symlink libxpcomglue{,_s}_pic.a to libxpcomglue{,_s}.a so that #@@#@@!@@$
libtool correctly links with the xpcom glue. Adjust libxul{-embedding}.pc
to return the appropriate _pic lib.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.inc,v 1.6 2010/06/20 19:44:40 landry Exp $
a89 1
			--enable-system-sqlite		\
@


1.6
log
@Fix WANTLIBs and bump PKGNAME.
Prodded by/ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.inc,v 1.5 2010/04/24 16:08:01 landry Exp $
d16 2
a17 2
PKGNAME-main=		xulrunner-${VERSION}${PATCHLEVEL}
PKGNAME-devel=		xulrunner-devel-${VERSION}${PATCHLEVEL}
d37 5
a41 4
LIB_DEPENDS+=		gdk-x11-2.0,gdk_pixbuf-2.0,gtk-x11-2.0::x11/gtk+2 \
			nspr4.>=20,plc4.>=20,plds4.>=20:nspr->=4.7:devel/nspr \
			nss3.>=22,smime3.>=22,softokn3.>=22,ssl3.>=22:nss->=3.12:security/nss
WANTLIB+=		c glib-2.0 m pthread stdc++
d48 7
a54 5
			xcb-render xcb-render-util

LIB_DEPENDS-devel+=	${MODGETTEXT_LIB_DEPENDS} IDL-2::devel/libIDL \
			${DIRECTORY}/mozjs,${DIRECTORY}/xpcom,${DIRECTORY}/xul:${PKGNAME-main}:devel/xulrunner/${VERSION:R:R},-main
WANTLIB-devel+=		${WANTLIB} nspr4 plc4 plds4
@


1.5
log
@Update xulrunner 1.9.0.14 to 1.9.1.7, latest release in the branch
corresponding to ffx 3.5.x. Most patches taken from there, tested
successfully @@ppc/amd64/sparc64. Branch 1.9.0.x is approaching attic
upstream, as ffx 3.0.x.
The plan is to move all users of xulrunner/1.8 to use this latest
version, and then ditch the old unmaintained one from ffx 2.x days.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.inc,v 1.4 2010/01/30 19:08:30 jolan Exp $
d43 1
a43 1
			Xext Xfixes Xft Xi Xinerama Xrandr Xrender Xt atk-1.0 \
d46 2
a47 1
			pangoft2-1.0 pixman-1 png pthread-stubs xcb z gio-2.0
@


1.4
log
@fix MASTER_SITES, ok naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.inc,v 1.3 2009/08/10 06:31:08 kili Exp $
d14 1
a14 1
DISTNAME=		mozilla
d33 1
a33 1
DISTFILES+=		xulrunner-${VERSION}-source.tar.bz2
@


1.3
log
@WANTLIB changes after xcb addition and bump.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.inc,v 1.2 2009/07/27 21:55:49 martynas Exp $
d32 1
a32 1
			http://mirrors.protection.cx/~martynas/mozilla/xulrunner/
@


1.2
log
@missed PATCHLEVEL, ptd out by sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.inc,v 1.1.1.1 2009/07/27 21:35:56 martynas Exp $
d46 1
a46 1
			pangoft2-1.0 pixman-1 png z gio-2.0
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d17 1
a17 1
PKGNAME-devel=		xulrunner-devel-${VERSION}
@


1.1.1.1
log
@import xulrunner 1.9, and implement infrastructure for multiple
xulrunners.  this was necessary for smooth migration, since we want
plugins work for mozilla 1.8 branch too (seamonkey, thunderbird);
they are upwards-compatible if built against 1.8.  however, some
new applications started to depend on 1.9, and also other (non-plugin)
apps will start to migrate so that the old xulrunner can go away
requested by many;  bulk build & pkgpath & bump done by sthen@@
@
text
@@
