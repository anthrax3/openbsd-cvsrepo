head	1.17;
access;
symbols
	OPENBSD_6_0:1.16.0.2
	OPENBSD_6_0_BASE:1.16
	OPENBSD_5_9:1.14.0.2
	OPENBSD_5_9_BASE:1.14
	OPENBSD_5_8:1.13.0.4
	OPENBSD_5_8_BASE:1.13
	OPENBSD_5_7:1.12.0.2
	OPENBSD_5_7_BASE:1.12
	OPENBSD_5_6:1.9.0.2
	OPENBSD_5_6_BASE:1.9
	OPENBSD_5_5:1.8.0.2
	OPENBSD_5_5_BASE:1.8
	OPENBSD_5_4:1.7.0.2
	OPENBSD_5_4_BASE:1.7
	OPENBSD_5_3:1.6.0.2
	OPENBSD_5_3_BASE:1.6
	OPENBSD_5_2:1.2.0.2
	OPENBSD_5_2_BASE:1.2
	edd_20120713:1.1.1.1
	edd:1.1.1;
locks; strict;
comment	@# @;


1.17
date	2017.03.04.16.22.57;	author krw;	state dead;
branches;
next	1.16;
commitid	UnPGUSQ6sBcsLE59;

1.16
date	2016.06.24.15.59.12;	author krw;	state Exp;
branches;
next	1.15;
commitid	uNq7PAnG26SO2XnT;

1.15
date	2016.06.23.19.23.53;	author krw;	state Exp;
branches;
next	1.14;
commitid	vwUgBiCmN1lWQqPh;

1.14
date	2015.08.30.15.52.33;	author avsm;	state Exp;
branches;
next	1.13;
commitid	ivcDi8qzkZ8BKHnH;

1.13
date	2015.04.05.13.31.13;	author sthen;	state Exp;
branches;
next	1.12;
commitid	1hQJnDR1GYYQ0MPE;

1.12
date	2014.10.22.13.00.54;	author jasper;	state Exp;
branches;
next	1.11;
commitid	OTqxgjzD231sCRcj;

1.11
date	2014.08.27.07.54.22;	author chrisz;	state Exp;
branches;
next	1.10;
commitid	8v3XtfCXenaTBSc1;

1.10
date	2014.08.22.22.21.53;	author kili;	state Exp;
branches;
next	1.9;
commitid	V82zoWOaRELJa7mF;

1.9
date	2014.07.10.11.06.15;	author rpe;	state Exp;
branches;
next	1.8;
commitid	zXOWyDxvWRmZFNNv;

1.8
date	2013.11.25.14.35.26;	author dcoppa;	state Exp;
branches;
next	1.7;

1.7
date	2013.03.11.10.50.12;	author espie;	state Exp;
branches;
next	1.6;

1.6
date	2013.01.09.10.29.47;	author nigel;	state Exp;
branches;
next	1.5;

1.5
date	2013.01.08.21.50.17;	author chrisz;	state Exp;
branches;
next	1.4;

1.4
date	2012.11.30.19.08.05;	author chrisz;	state Exp;
branches;
next	1.3;

1.3
date	2012.08.18.22.04.48;	author avsm;	state Exp;
branches;
next	1.2;

1.2
date	2012.07.13.11.27.16;	author edd;	state Exp;
branches;
next	1.1;

1.1
date	2012.07.13.08.40.27;	author edd;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2012.07.13.08.40.27;	author edd;	state Exp;
branches;
next	;


desc
@@


1.17
log
@Remove unused, older library versions. Current ones
available via normal Ocaml ecosystem (a.k.a. opam).

ok chrisz@@ avsm@@ (maintainers)
@
text
@# $OpenBSD: Makefile,v 1.16 2016/06/24 15:59:12 krw Exp $

COMMENT =	OCaml Batteries Included - OCaml foundation library
CATEGORIES =	devel

V =		2.5.0
GH_ACCOUNT =	ocaml-batteries-team
GH_PROJECT =	batteries-included
GH_TAGNAME =	v$V
DISTNAME =	${GH_PROJECT}-$V
PKGNAME =	ocaml-batteries-$V
REVISION =	0

HOMEPAGE =	http://batteries.forge.ocamlcore.org/

MAINTAINER =	Christopher Zimmermann <chrisz@@openbsd.org>

# LGPL >=2.1
PERMIT_PACKAGE_CDROM =		Yes

MODULES =		lang/ocaml

RUN_DEPENDS =		devel/ocaml-camomile
BUILD_DEPENDS =		${RUN_DEPENDS} sysutils/findlib devel/ocaml-ocamlbuild
# ocaml-test not available yet
#TEST_DEPENDS = 	devel/ounit devel/ocaml-qtest
TEST_DEPENDS = 	devel/ounit

USE_GMAKE =	Yes

MAKE_ENV =	DOCROOT=${PREFIX}/share/doc/ocaml-batteries

.include <bsd.port.arch.mk>
.if ${PROPERTIES:Mocaml_native}
MAKE_ENV +=	BATTERIES_NATIVE=yes
.else
MAKE_ENV +=	BATTERIES_NATIVE=no
.endif

FAKE_FLAGS =	DOCROOT=${WRKINST}${PREFIX}/share/doc/ocaml-batteries

ALL_TARGET =		all doc
INSTALL_TARGET =	install install-doc
TEST_TARGET =	test


post-install:
	${INSTALL_DATA} \
		${WRKSRC}/ocamlinit \
		${PREFIX}/share/doc/ocaml-batteries/


.include <bsd.port.mk>
@


1.16
log
@Upgrade Ocaml to 4.3.0 and tweak ports the minimal amount to keep
them all compiling.

Tweaks include updating

ocaml-batteries 2.3.1 -> 2.5.0
ocaml-lwt 2.4.8 -> 2.5.2
ocaml-ppx-tools 0.99.2 -> 4.03.0
ocaml-camlp4 4.02+6 -> 4.03+1
utop 1.15 -> 1.19.2

and fixes to coccinelle and wyrd to let them build on bytecode archs.

Other necessary tweaks from the various homes of the projects.

Everything still builds on amd64 (native and bytecode) and sparc64 (bytecode).

ok anil@@ sthen@@ so final 4.3.0 tweaks can be done in-tree.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2016/06/23 19:23:53 krw Exp $
@


1.15
log
@Stop building Ocaml's internal ocamlbuild and use the ocaml-ocamlbuild port
where needed.

The next step towards Ocaml 4.3.0.

Bulk build by sthen@@ identified several laggards which are included here.

ok anil@@ sthen@@ so final 4.3.0 polishing can be done in-tree.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2015/08/30 15:52:33 avsm Exp $
d6 1
a6 1
V =		2.3.1
@


1.14
log
@update to ocaml-batteries-2.3.1

Removes OCaml 4.02.0+ patches which are now upstreamed

ok jca@@, tested by krw@@ daniel@@ jsg@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2015/04/05 13:31:13 sthen Exp $
d12 1
d24 1
a24 1
BUILD_DEPENDS =		${RUN_DEPENDS} sysutils/findlib
@


1.13
log
@drop GH_COMMIT lines which are hidden behind GH_TAGNAME,
discussed with a few in the room.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2014/10/22 13:00:54 jasper Exp $
d6 1
a6 1
V =		2.2.0
a11 1
REVISION =	1
@


1.12
log
@unify maintainer addresses

ok chrisz@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2014/08/27 07:54:22 chrisz Exp $
a9 1
GH_COMMIT =	9370680ef30e225e50c76fc05654a897d79ee79d
@


1.11
log
@Update ocaml-batteries to 2.2.0.
Also include fixes from upstream to support OCaml 4.02

OK jca@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2014/08/22 22:21:53 kili Exp $
d13 1
a13 1
REVISION =	0
d17 1
a17 1
MAINTAINER =	Christopher Zimmermann <madroach@@gmerlin.de>
@


1.10
log
@Bump after lang/ocaml pkgname change (first round, more bumps will follow).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2014/07/10 11:06:15 rpe Exp $
d6 1
a6 1
V =		2.1.0
d10 1
a10 1
GH_COMMIT =	7613438a4e8425fc51b16f21faaccdebc7ea76ce
@


1.9
log
@Move ports that used filename{url}sufx to fetch DISTFILES from
Github to GH_ACCOUNT, GH_PROJECT, GH_TAGNAME, GH_COMMIT.

OK sthen@@ jasper@@ aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2013/11/25 14:35:26 dcoppa Exp $
d13 1
@


1.8
log
@ocaml-related updates:

ocaml-batteries 2.0.0 -> 2.1.0

ocaml-lwt 2.4.2 -> 2.4.4

ocaml-net 3.6 -> 3.7.3

All needed for an upcoming update to ocaml-4.01.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2013/03/11 10:50:12 espie Exp $
d6 7
a12 5
GH_VER =	v2.1.0
DISTNAME =	batteries-included-${GH_VER:S/v//}
PKGNAME =	ocaml-batteries-${GH_VER:S/v//}
MASTER_SITES =	https://github.com/ocaml-batteries-team/batteries-included/archive/
DISTFILES =	${DISTNAME}${EXTRACT_SUFX}{${GH_VER}${EXTRACT_SUFX}}
@


1.7
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2013/01/09 10:29:47 nigel Exp $
d6 3
a8 5
V =		2.0.0
DISTNAME =	batteries-included-${V}
PKGNAME =	ocaml-batteries-${V}
DISTFILES =	v${V}.tar.gz
DIST_SUBDIR =	ocaml-batteries
d10 1
@


1.6
log
@Remove ocaml-qtest from REGRESS_DEPENDS until available else breaks sqlports
Ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2013/01/08 21:50:17 chrisz Exp $
a17 1
PERMIT_PACKAGE_FTP =		Yes
a18 2
PERMIT_DISTFILES_FTP =		Yes
PERMIT_DISTFILES_CDROM =	Yes
d25 2
a26 2
#REGRESS_DEPENDS = 	devel/ounit devel/ocaml-qtest
REGRESS_DEPENDS = 	devel/ounit
d43 1
a43 1
REGRESS_TARGET =	test
@


1.5
log
@update to version 2.0.0

regression tests depend on qtest.
They will be broken until qtest is in ports, too.


OK jasper@@, avsm@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2012/11/30 19:08:05 chrisz Exp $
d27 3
a29 1
REGRESS_DEPENDS = 	devel/ounit devel/ocaml-qtest
@


1.4
log
@Update lang/ocaml to 4.00.1.
Make all ocaml ports depend on the version of ocaml they were built with.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2012/08/18 22:04:48 avsm Exp $
d6 2
a7 3
V =		1.5.0
REVISION=	0
DISTNAME =	batteries-${V}
d9 3
a11 3

# You need to update MASTER_SITES too, when changing the version number.
MASTER_SITES =	https://forge.ocamlcore.org/frs/download.php/950/
d23 1
a23 1
MODULES =	lang/ocaml
d25 3
a27 3
RUN_DEPENDS =	devel/ocaml-camomile
BUILD_DEPENDS =	${RUN_DEPENDS} sysutils/findlib
REGRESS_DEPENDS = devel/ounit
d31 2
a32 2
MAKE_ENV =	DOCROOT=${PREFIX}/share/doc/ocaml-batteries \
		TERM=${TERM}
d40 1
a40 2
FAKE_FLAGS =	DESTDIR=${WRKINST}${PREFIX}/lib/ocaml \
		DOCROOT=${WRKINST}${PREFIX}/share/doc/ocaml-batteries
d43 1
a44 2
INSTALL_TARGET =	install install-doc

a45 2
pre-fake:
	${INSTALL_DATA_DIR} ${PREFIX}/lib/ocaml
@


1.3
log
@update to ocaml-batteries-1.5.0

* META info fixed upstream
* move cmxs to PFRAG.native-dynlink
* update ocamlfind sitelib path
* /usr/local/ocaml/site-lib/batteries/ocaml is a script, not executable
* Fix toplevel help system
  The path to the documentation is hardcoded at build time.
  Therefore DOCROOT may not be prefixed by WRKINST at build time.

From: Christopher Zimmermann <madroach@@gmerlin.de>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2012/07/13 11:27:16 edd Exp $
d7 1
@


1.2
log
@Fixes "Cannot find file /usr/local/lib/ocaml/site-lib/batteries/pa_llist"
when interpreting on non-native architectures.

From Chris Zimmermann.

OK sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2012/07/13 08:40:27 edd Exp $
a4 1
REVISION =	0
d6 1
a6 3
V =		1.4.3
# $N changes with every release, too.
N =		884
d10 2
a11 1
MASTER_SITES =	https://forge.ocamlcore.org/frs/download.php/$N/
d31 1
a31 2
MAKE_ENV =	BATTERIES_NATIVE=${MODOCAML_NATIVE:S/Yes/yes/:S/No/no/} \
    		DOCROOT=${WRKINST}${LOCALBASE}/share/doc/ocaml-batteries \
d33 6
d40 2
a41 1
FAKE_FLAGS =	DESTDIR=${WRKINST}${LOCALBASE}/lib/ocaml/site-lib
d43 1
a43 1
ALL_TARGET =	all doc
d49 1
a49 1
	${INSTALL_DATA_DIR} ${PREFIX}/lib/ocaml/site-lib
d53 2
a54 2
	    ${WRKSRC}/ocamlinit \
	    ${PREFIX}/share/doc/ocaml-batteries/
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d5 1
@


1.1.1.1
log
@Import the "ocaml batteries included" foundation library.

From Chris Zimmermann.

OK sthen@@

@
text
@@
