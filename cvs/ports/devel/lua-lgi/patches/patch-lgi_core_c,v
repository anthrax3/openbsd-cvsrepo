head	1.6;
access;
symbols
	OPENBSD_6_0:1.5.0.12
	OPENBSD_6_0_BASE:1.5
	OPENBSD_5_9:1.5.0.8
	OPENBSD_5_9_BASE:1.5
	OPENBSD_5_8:1.5.0.10
	OPENBSD_5_8_BASE:1.5
	OPENBSD_5_7:1.5.0.6
	OPENBSD_5_7_BASE:1.5
	OPENBSD_5_6:1.5.0.4
	OPENBSD_5_6_BASE:1.5
	OPENBSD_5_5:1.5.0.2
	OPENBSD_5_5_BASE:1.5
	OPENBSD_5_4:1.4.0.2
	OPENBSD_5_4_BASE:1.4
	OPENBSD_5_3:1.2.0.2
	OPENBSD_5_3_BASE:1.2;
locks; strict;
comment	@# @;


1.6
date	2017.02.28.11.32.16;	author dcoppa;	state Exp;
branches;
next	1.5;
commitid	Mdr5XMYroB79rNlA;

1.5
date	2013.12.30.08.00.03;	author jasper;	state Exp;
branches;
next	1.4;

1.4
date	2013.05.21.07.50.28;	author dcoppa;	state Exp;
branches;
next	1.3;

1.3
date	2013.03.08.10.26.26;	author jasper;	state dead;
branches;
next	1.2;

1.2
date	2012.09.21.13.57.32;	author jasper;	state Exp;
branches;
next	1.1;

1.1
date	2012.09.20.20.56.34;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.6
log
@
Update to lgi-0.9.1
@
text
@$OpenBSD: patch-lgi_core_c,v 1.5 2013/12/30 08:00:03 jasper Exp $
--- lgi/core.c.orig	Tue Feb 28 11:57:18 2017
+++ lgi/core.c	Tue Feb 28 11:58:03 2017
@@@@ -673,7 +673,7 @@@@ set_resident (lua_State *L)
 }
 
 G_MODULE_EXPORT int
-luaopen_lgi_corelgilua51 (lua_State* L)
+luaopen_lgi_corelgilua${MODLUA_DEP_VERSION} (lua_State* L)
 {
   LgiStateMutex *mutex;
   gint state_id;
@


1.5
log
@update to lua-lgi-0.7.2
@
text
@d1 4
a4 4
$OpenBSD: patch-lgi_core_c,v 1.4 2013/05/21 07:50:28 dcoppa Exp $
--- lgi/core.c.orig	Thu Sep 12 20:55:48 2013
+++ lgi/core.c	Mon Dec 30 08:45:13 2013
@@@@ -620,7 +620,7 @@@@ set_resident (lua_State *L)
d7 1
a7 1
 int
d12 1
a12 1
 
@


1.4
log
@Unbreak with Lua 5.2

ok jasper@@
@
text
@d1 4
a4 4
$OpenBSD$
--- lgi/core.c.orig	Mon May 20 14:17:38 2013
+++ lgi/core.c	Mon May 20 14:18:14 2013
@@@@ -607,7 +607,7 @@@@ set_resident (lua_State *L)
@


1.3
log
@- update to lgi-0.7.0
@
text
@d1 9
a9 12
$OpenBSD: patch-lgi_core_c,v 1.2 2012/09/21 13:57:32 jasper Exp $

commit 44676d0ec67ac19385917eb537423f235d5d3a7b
Author: Jasper Lievisse Adriaanse <jasper@@humppa.nl>
Date:   Thu Sep 20 22:41:59 2012 +0200
Subject: Unbreak loading of shared objects/modules on OpenBSD.

https://github.com/pavouk/lgi/commit/44676d0ec67ac19385917eb537423f235d5d3a7b

--- lgi/core.c.orig	Mon Jun 25 10:25:21 2012
+++ lgi/core.c	Thu Sep 20 22:29:55 2012
@@@@ -487,12 +487,18 @@@@ core_module (lua_State *L)
d11 1
a11 17
   char *name;
 
-  /* If the version is present, combine it with basename. */
+  /* If the version is present, combine it with basename.
+     Except on OpenBSD, where libraries are versioned like libfoo.so.0.0
+     and we will always load the shared object with the highest version
+     number.
+   */
+#ifndef __OpenBSD__
   if (!lua_isnoneornil (L, 2))
     name = g_strdup_printf (MODULE_NAME_FORMAT_VERSION,
 			    luaL_checkstring (L, 1),
 			    (int) luaL_checkinteger (L, 2));
   else
+#endif
     name = g_strdup_printf (MODULE_NAME_FORMAT_PLAIN,
 			    luaL_checkstring (L, 1));
@


1.2
log
@sync comment now that it's been merged upstream
@
text
@d1 1
a1 1
$OpenBSD: patch-lgi_core_c,v 1.1 2012/09/20 20:56:34 jasper Exp $
@


1.1
log
@fix loading of introspected libraries
@
text
@d1 1
a1 1
$OpenBSD$
d6 1
d8 1
a8 1
    Unbreak loading of shared objects/modules on OpenBSD.
@

