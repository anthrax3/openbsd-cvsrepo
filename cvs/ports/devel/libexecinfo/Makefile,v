head	1.22;
access;
symbols
	OPENBSD_6_2:1.22.0.2
	OPENBSD_6_2_BASE:1.22
	OPENBSD_6_1:1.20.0.4
	OPENBSD_6_1_BASE:1.20
	OPENBSD_6_0:1.20.0.2
	OPENBSD_6_0_BASE:1.20
	OPENBSD_5_9:1.19.0.2
	OPENBSD_5_9_BASE:1.19
	OPENBSD_5_8:1.19.0.4
	OPENBSD_5_8_BASE:1.19
	OPENBSD_5_7:1.18.0.4
	OPENBSD_5_7_BASE:1.18
	OPENBSD_5_6:1.18.0.2
	OPENBSD_5_6_BASE:1.18
	OPENBSD_5_5:1.17.0.2
	OPENBSD_5_5_BASE:1.17
	OPENBSD_5_4:1.16.0.2
	OPENBSD_5_4_BASE:1.16
	OPENBSD_5_3:1.15.0.2
	OPENBSD_5_3_BASE:1.15
	OPENBSD_5_2:1.12.0.4
	OPENBSD_5_2_BASE:1.12
	OPENBSD_5_1_BASE:1.12
	OPENBSD_5_1:1.12.0.2
	OPENBSD_5_0:1.7.0.4
	OPENBSD_5_0_BASE:1.7
	OPENBSD_4_9:1.7.0.2
	OPENBSD_4_9_BASE:1.7
	OPENBSD_4_8:1.6.0.4
	OPENBSD_4_8_BASE:1.6
	OPENBSD_4_7:1.6.0.2
	OPENBSD_4_7_BASE:1.6
	OPENBSD_4_6:1.3.0.2
	OPENBSD_4_6_BASE:1.3
	OPENBSD_4_5:1.2.0.2
	OPENBSD_4_5_BASE:1.2
	ajacoutot_20081021:1.1.1.1
	bernd:1.1.1;
locks; strict;
comment	@# @;


1.22
date	2017.04.10.11.45.26;	author sthen;	state Exp;
branches;
next	1.21;
commitid	XDh1zlSBq0boKsHk;

1.21
date	2017.04.07.20.59.49;	author sthen;	state Exp;
branches;
next	1.20;
commitid	UoRVifNHBukT2q8g;

1.20
date	2016.03.11.19.46.13;	author sthen;	state Exp;
branches;
next	1.19;
commitid	wuJHEdseRcm03EQX;

1.19
date	2015.03.16.18.07.42;	author naddy;	state Exp;
branches;
next	1.18;
commitid	IJdm3Zowcdkcxp5X;

1.18
date	2014.04.03.13.46.47;	author pirofti;	state Exp;
branches;
next	1.17;

1.17
date	2013.08.06.18.58.52;	author espie;	state Exp;
branches;
next	1.16;

1.16
date	2013.03.11.10.50.09;	author espie;	state Exp;
branches;
next	1.15;

1.15
date	2013.02.07.12.30.44;	author zhuk;	state Exp;
branches;
next	1.14;

1.14
date	2012.09.27.15.45.42;	author jasper;	state Exp;
branches;
next	1.13;

1.13
date	2012.09.01.12.02.27;	author naddy;	state Exp;
branches;
next	1.12;

1.12
date	2011.12.09.10.20.56;	author sthen;	state Exp;
branches;
next	1.11;

1.11
date	2011.12.09.08.17.31;	author jasper;	state Exp;
branches;
next	1.10;

1.10
date	2011.11.18.11.16.24;	author espie;	state Exp;
branches;
next	1.9;

1.9
date	2011.11.16.15.12.53;	author jasper;	state Exp;
branches;
next	1.8;

1.8
date	2011.11.14.19.14.18;	author sthen;	state Exp;
branches;
next	1.7;

1.7
date	2010.11.15.19.45.59;	author espie;	state Exp;
branches;
next	1.6;

1.6
date	2010.02.09.12.23.59;	author jasper;	state Exp;
branches;
next	1.5;

1.5
date	2010.02.08.17.42.51;	author jasper;	state Exp;
branches;
next	1.4;

1.4
date	2009.10.09.15.10.13;	author jasper;	state Exp;
branches;
next	1.3;

1.3
date	2009.04.09.15.03.06;	author ajacoutot;	state Exp;
branches;
next	1.2;

1.2
date	2008.11.11.15.48.47;	author naddy;	state Exp;
branches;
next	1.1;

1.1
date	2008.10.21.17.01.24;	author ajacoutot;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2008.10.21.17.01.24;	author ajacoutot;	state Exp;
branches;
next	;


desc
@@


1.22
log
@use LIBCXX
@
text
@# $OpenBSD: Makefile,v 1.21 2017/04/07 20:59:49 sthen Exp $

COMMENT =	clone of backtrace facility found in the GNU libc

V =		0.3
GH_TAGNAME=	BACKTRACE_${V:S/./_/g}
GH_ACCOUNT=	conformal
GH_PROJECT=	backtrace
DISTNAME =	${GH_PROJECT}-${V}
PKGNAME =	libexecinfo-$V
EPOCH =		0
REVISION =	0
CATEGORIES =	devel

SHARED_LIBS =	execinfo	2.0

HOMEPAGE =	https://github.com/conformal/backtrace/wiki

# BSD
PERMIT_PACKAGE_CDROM =		Yes

WANTLIB=	c
LDFLAGS+=	-Wl,--export-dynamic

MAKE_FLAGS =	LIB=execinfo
FAKE_FLAGS =	PREFIX=${WRKINST}/${TRUEPREFIX} \
		MANDIR=${PREFIX}/man/man

.if ${MACHINE_ARCH:Mmips64*} || ${MACHINE_ARCH:Mhppa} || ${MACHINE_ARCH:Marm} || ${MACHINE_ARCH:Mvax} || ${MACHINE_ARCH:Msh}
CFLAGS+=	-D__BUILTIN_HACK
.endif

do-configure:
	printf "major=${LIBexecinfo_VERSION:R}\nminor=${LIBexecinfo_VERSION:E}\n" \
	    > ${WRKSRC}/libbacktrace/shlib_version

post-install:
	mv ${PREFIX}/include/backtrace.h ${PREFIX}/include/execinfo.h
	${INSTALL_PROGRAM} ${WRKDIST}/examples/backtrace_test \
		${PREFIX}/bin/backtrace_test

do-test:
	${SETENV} LD_LIBRARY_PATH=${WRKSRC}/libbacktrace ${WRKSRC}/examples/backtrace_test

do-test:
	${SETENV} LD_LIBRARY_PATH=${WRKSRC}/libbacktrace \
		${WRKSRC}/examples/backtrace_test

.include <bsd.port.mk>
@


1.21
log
@- only do -Wl,--export-dynamic in LDFLAGS not CFLAGS, removes a warning on
gcc, removes a build failure with -Werror on clang.

- add a do-test target.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2016/03/11 19:46:13 sthen Exp $
d41 3
@


1.20
log
@move to github, opensource.conformal.com is going away. from dhill.
update to 0.3, rolling in patch.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2015/03/16 18:07:42 naddy Exp $
d12 1
a22 1
CFLAGS+=	-Wl,--export-dynamic
d41 4
@


1.19
log
@fold lib-only PFRAG.shared into PLIST, regen PLIST, and bump
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2014/04/03 13:46:47 pirofti Exp $
d5 5
a9 2
V =		0.2
DISTNAME =	backtrace-$V
a10 1
REVISION =	5
d16 1
a16 3
HOMEPAGE =	http://opensource.conformal.com/wiki/Backtrace
MASTER_SITES =	http://opensource.conformal.com/snapshots/backtrace/
EXTRACT_SUFX =	.tgz
@


1.18
log
@Landisk needs __BUILTIN_HACK to build libexecinfo.

Suggested by jasper@@
Okay sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2013/08/06 18:58:52 espie Exp $
d8 1
a8 1
REVISION =	4
@


1.17
log
@vax has simple builtin macros for unwinding stack, join the ranks of arm
and hppa and let this build
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2013/03/11 10:50:09 espie Exp $
d8 1
a8 1
REVISION =	3
d29 1
a29 1
.if ${MACHINE_ARCH:Mmips64*} || ${MACHINE_ARCH:Mhppa} || ${MACHINE_ARCH:Marm} || ${MACHINE_ARCH:Mvax}
@


1.16
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2013/02/07 12:30:44 zhuk Exp $
d29 1
a29 1
.if ${MACHINE_ARCH:Mmips64*} || ${MACHINE_ARCH:Mhppa} || ${MACHINE_ARCH:Marm}
@


1.15
log
@Fixup header name in manual page.

"yep" sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2012/09/27 15:45:42 jasper Exp $
a19 3
PERMIT_PACKAGE_FTP =		Yes
PERMIT_DISTFILES_CDROM =	Yes
PERMIT_DISTFILES_FTP =		Yes
@


1.14
log
@- remove BT_MAX_DEPTH and struct bt_frame from the public API as they don't belong there
  and create issues with guenthers upcoming header cleaning.

  as discussed with guenther@@
  ok landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2012/09/01 12:02:27 naddy Exp $
d8 1
a8 1
REVISION =	2
@


1.13
log
@bsd.lib.mk does not build _pic.a libraries any longer
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2011/12/09 10:20:56 sthen Exp $
d8 1
a8 1
REVISION =	1
d12 1
a12 1
SHARED_LIBS =	execinfo	1.0
@


1.12
log
@fix build on arm
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2011/12/09 08:17:31 jasper Exp $
d8 1
a8 1
REVISION =	0
@


1.11
log
@- fix build on hppa and use a simpler construct
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2011/11/18 11:16:24 espie Exp $
d32 1
a32 1
.if ${MACHINE_ARCH:Mmips64*} || ${MACHINE_ARCH:Mhppa}
@


1.10
log
@shrink, this lives in bsd.port.mk itself now
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2011/11/16 15:12:53 jasper Exp $
d32 2
a33 2
.if ${MACHINE_ARCH:Mmips64*}
EXTRA_CFLAGS=   -D__BUILTIN_HACK
@


1.9
log
@- bring back fixes to fix this on mips64*

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2011/11/14 19:14:18 sthen Exp $
a33 4
# See bsd.lib.mk:162
PKG_ARGS+=      -Dno_mips64=0
.else
PKG_ARGS+=      -Dno_mips64=1
@


1.8
log
@switch the libexecinfo port to use marco's libbacktrace, sources modified
to produce a library named libexecinfo.so.XX, avoiding the need to patch a
bunch of places where it's used in other ports. with help from robert@@
@
text
@d1 1
a1 1
# $OpenBSD$
d8 1
d31 8
@


1.7
log
@move depends to new style
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2010/02/09 12:23:59 jasper Exp $
d3 1
a3 1
COMMENT=	clone of backtrace facility found in the GNU libc
d5 5
a9 3
DISTNAME=	libexecinfo-1.1
REVISION =	2
CATEGORIES=	devel
d11 1
a11 1
SHARED_LIBS=	execinfo	0.0
d13 3
a15 2
# <sobomax@@FreeBSD.org>
HOMEPAGE=	http://www.freebsd.org/
d18 16
a33 26
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes

MASTER_SITES=	${MASTER_SITE_FREEBSD_LOCAL:=itetcu/}
EXTRACT_SUFX=	.tar.bz2

WANTLIB=	m

# Hack that allows this lib to build on mips64(el), although
# it essentially turns this lib into an empty shell...
# ...too many ports require it to mark it NOT_FOR_ARCHS
.if ${MACHINE_ARCH:Mmips64*}
EXTRA_CFLAGS=   -D__BUILTIN_HACK
# See bsd.lib.mk:162
PKG_ARGS+=	-Dno_mips64=0
.else
PKG_ARGS+=	-Dno_mips64=1
.endif

MAKE_FLAGS+=    EXTRA_CFLAGS=${EXTRA_CFLAGS}

MAKE_ENV=	LIBDIR=${PREFIX}/lib \
		LIBexecinfo_MAJOR=${LIBexecinfo_VERSION:R} \
		LIBexecinfo_MINOR=${LIBexecinfo_VERSION:E}
d36 3
a38 4
	${INSTALL_DATA} ${WRKBUILD}/*.h ${PREFIX}/include
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/libexecinfo
	${INSTALL_DATA} ${WRKBUILD}/README \
		${PREFIX}/share/doc/libexecinfo
@


1.6
log
@- extend archtecture tests for mips64el

ok naddy@@ phessler@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2010/02/08 17:42:51 jasper Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p2
@


1.5
log
@- let this build on mips64el too

ok espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2009/10/09 15:10:13 jasper Exp $
d28 1
a28 1
.if ${MACHINE_ARCH} == "mips64" || ${MACHINE_ARCH} == "mips64el"
@


1.4
log
@- castrate libexecinfo on mips64 as
__builtin_return_address() and __builtin_frame_address()
can't have a !0 argument on mips.

with a hint from miod@@
ok aja@@ (sorry for making your eyes bleed..!)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2009/04/09 15:03:06 ajacoutot Exp $
d25 1
a25 1
# Hack that allows this lib to build on mips64, although
d28 1
a28 1
.if ${MACHINE_ARCH} == "mips64"
@


1.3
log
@- install README file
- add HOMEPAGE
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2008/11/11 15:48:47 naddy Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p1
d24 13
@


1.2
log
@* LP64 fixes
* use MASTER_SITE_FREEBSD_LOCAL
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2008/10/21 17:01:24 ajacoutot Exp $
d6 1
a6 1
PKGNAME=	${DISTNAME}p0
d11 3
d31 3
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d6 1
d17 1
a17 1
MASTER_SITES=	ftp://ftp.freebsd.org/pub/FreeBSD/ports/local-distfiles/itetcu/
@


1.1.1.1
log
@Import libexecinfo-1.1

This is a quick-n-dirty BSD licensed clone of backtrace facility found
in the GNU libc, mainly intended for porting linuxish code to BSD
platforms, however it can be used at any platform which has a gcc
compiler.

from bernd@@ (patch-execinfo_c from FreeBSD)
@
text
@@
