head	1.32;
access;
symbols
	OPENBSD_3_6:1.29.0.2
	OPENBSD_3_6_BASE:1.29
	OPENBSD_3_5:1.28.0.2
	OPENBSD_3_5_BASE:1.28
	OPENBSD_3_4:1.24.0.2
	OPENBSD_3_4_BASE:1.24
	OPENBSD_3_3:1.12.0.2
	OPENBSD_3_3_BASE:1.12
	OPENBSD_3_2:1.8.0.2
	OPENBSD_3_2_BASE:1.8
	OPENBSD_3_1:1.5.0.2
	OPENBSD_3_1_BASE:1.5
	fgsch_20020219:1.1.1.1
	fgsch:1.1.1;
locks; strict;
comment	@# @;


1.32
date	2004.11.18.23.40.06;	author fgsch;	state dead;
branches;
next	1.31;

1.31
date	2004.11.18.23.23.56;	author fgsch;	state Exp;
branches;
next	1.30;

1.30
date	2004.09.15.19.07.48;	author espie;	state Exp;
branches;
next	1.29;

1.29
date	2004.05.20.23.11.58;	author brad;	state Exp;
branches;
next	1.28;

1.28
date	2004.03.01.00.10.38;	author brad;	state Exp;
branches;
next	1.27;

1.27
date	2004.02.10.22.49.36;	author brad;	state Exp;
branches;
next	1.26;

1.26
date	2004.01.19.01.56.05;	author brad;	state Exp;
branches;
next	1.25;

1.25
date	2003.10.11.00.52.21;	author brad;	state Exp;
branches;
next	1.24;

1.24
date	2003.07.28.05.12.00;	author brad;	state Exp;
branches;
next	1.23;

1.23
date	2003.07.16.19.17.21;	author brad;	state Exp;
branches;
next	1.22;

1.22
date	2003.06.30.21.01.14;	author espie;	state Exp;
branches;
next	1.21;

1.21
date	2003.06.30.18.24.16;	author brad;	state Exp;
branches;
next	1.20;

1.20
date	2003.06.27.02.47.08;	author kevlo;	state Exp;
branches;
next	1.19;

1.19
date	2003.06.15.04.43.31;	author brad;	state Exp;
branches;
next	1.18;

1.18
date	2003.06.13.04.17.12;	author brad;	state Exp;
branches;
next	1.17;

1.17
date	2003.06.09.19.11.29;	author brad;	state Exp;
branches;
next	1.16;

1.16
date	2003.06.08.19.02.58;	author brad;	state Exp;
branches;
next	1.15;

1.15
date	2003.06.05.23.39.47;	author brad;	state Exp;
branches;
next	1.14;

1.14
date	2003.06.05.18.28.24;	author brad;	state Exp;
branches;
next	1.13;

1.13
date	2003.06.05.04.03.55;	author brad;	state Exp;
branches;
next	1.12;

1.12
date	2003.02.27.19.27.01;	author espie;	state Exp;
branches;
next	1.11;

1.11
date	2003.02.16.15.17.58;	author espie;	state Exp;
branches;
next	1.10;

1.10
date	2003.02.15.14.26.03;	author espie;	state Exp;
branches;
next	1.9;

1.9
date	2002.10.25.22.37.12;	author naddy;	state Exp;
branches;
next	1.8;

1.8
date	2002.05.13.10.54.45;	author fgsch;	state Exp;
branches;
next	1.7;

1.7
date	2002.05.06.22.55.07;	author drahn;	state Exp;
branches;
next	1.6;

1.6
date	2002.04.25.22.37.10;	author fgsch;	state Exp;
branches;
next	1.5;

1.5
date	2002.04.07.21.26.16;	author fgsch;	state Exp;
branches;
next	1.4;

1.4
date	2002.04.07.21.11.45;	author fgsch;	state Exp;
branches;
next	1.3;

1.3
date	2002.03.19.08.28.00;	author fgsch;	state Exp;
branches;
next	1.2;

1.2
date	2002.02.20.05.27.18;	author fgsch;	state Exp;
branches;
next	1.1;

1.1
date	2002.02.19.04.19.21;	author fgsch;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2002.02.19.04.19.21;	author fgsch;	state Exp;
branches;
next	;


desc
@@


1.32
log
@remove binutils now that we have a recent and more closely tracked version.
if it's needed in the future, we can bring it back. pvalchev@@ ok.
@
text
@# $OpenBSD: Makefile,v 1.31 2004/11/18 23:23:56 fgsch Exp $

COMMENT=		"GNU development tools"

V=			2.14
DISTNAME=		binutils-$V
CATEGORIES=		devel
MASTER_SITES=		${MASTER_SITE_GNU:=binutils/}
EXTRACT_SUFX=		.tar.bz2

# GPL
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes

HOMEPAGE=		http://sources.redhat.com/binutils/

AUTOCONF_VERSION=	2.13
BUILD_DEPENDS=		::devel/automake \
			${MODGNU_AUTOCONF_DEPENDS}

SUBST_VARS=		TARGET_ARCH OSREV

CONFIGURE_STYLE=	gnu
CONFIGURE_ARGS+=	--disable-nls --disable-commonbfdlib

# cross-tools
FLAVORS=		alpha arm armeb hppa i386 m68k m88k mips powerpc \
			sparc sparc64 vax amd64
FLAVOR?=

SEPARATE_BUILD=		flavored

# XXX: special handling needed for powerpc arch's and bootstraping
.if !empty(FLAVOR:L) && ${FLAVOR:L} != ${MACHINE_ARCH}
CONFIGURE_ARGS+=	--target=${FLAVOR:L}-unknown-openbsd${OSREV}
TARGET_ARCH=		${FLAVOR:L}
FULLPKGNAME=		binutils-${TARGET_ARCH}-$V
.if ${FLAVOR} == "alpha" || ${FLAVOR} == "amd64" || ${FLAVOR} == "sparc64"
CONFIGURE_ARGS+=	--enable-64-bit-bfd
.endif
.else
TARGET_ARCH=		${MACHINE_ARCH}
.endif

TARGET_DIR=		$${PREFIX}/${TARGET_ARCH}-unknown-openbsd${OSREV}

REGRESS_TARGET=		check
REGRESS_DEPENDS=	::devel/dejagnu

FILES=			addr2line ar nm-new objdump objcopy ranlib readelf size strings strip-new 

EMULPARAMS=		i386obsd.sh sparcobsd.sh m68kobsd.sh \
			elf32_sparc_obsd.sh elf32ppc_obsd.sh \
			elf64_sparc_obsd.sh elf64alpha_obsd.sh \
			elf_i386_obsd.sh elf_x86_64_obsd.sh \
			elf_obsd.sh armelf_obsd.sh armelfb_obsd.sh

post-extract:
.for f in ${EMULPARAMS}
	@@cp -f ${FILESDIR}/${f} ${WRKSRC}/ld/emulparams
.endfor
	@@cp -f ${FILESDIR}/te-obsd.h ${WRKSRC}/gas/config
	@@cp -f ${FILESDIR}/dis-init.c ${WRKSRC}/opcodes

post-patch:
	@@-cd ${WRKSRC}/bfd && { automake; AUTOCONF_VERSION=${AUTOCONF_VERSION} autoconf; }
	@@cd ${WRKSRC}/binutils && automake
	@@-cd ${WRKSRC}/gas && { automake; AUTOCONF_VERSION=${AUTOCONF_VERSION} autoconf; }
	@@cd ${WRKSRC}/gprof && automake
	@@cd ${WRKSRC}/ld && automake
	@@cd ${WRKSRC}/opcodes && automake

post-build:
	cd ${WRKBUILD}/binutils/doc && ${MAKE} info
	cd ${WRKBUILD}/gas/doc && ${MAKE} info
	cd ${WRKBUILD}/ld && ${MAKE} ld.1

do-install:
	${INSTALL_DATA_DIR} ${TARGET_DIR}/bin
	${INSTALL_DATA_DIR} ${TARGET_DIR}/man/man1
	${INSTALL_DATA_DIR} ${TARGET_DIR}/lib/ldscripts
	cd ${WRKBUILD} && {						\
	    ${INSTALL_PROGRAM} binutils/addr2line ${TARGET_DIR}/bin;	\
	    ${INSTALL_PROGRAM} binutils/readelf ${TARGET_DIR}/bin;	\
	    ${INSTALL_PROGRAM} gas/as-new ${TARGET_DIR}/bin/as;		\
	    ${INSTALL_PROGRAM} ld/ld-new ${TARGET_DIR}/bin/ld;		\
	    ${INSTALL_MAN} gas/doc/as.1 ${TARGET_DIR}/man/man1;		\
	    ${INSTALL_MAN} ld/ld.1 ${TARGET_DIR}/man/man1;		\
	    ${INSTALL_DATA} ld/ldscripts/* ${TARGET_DIR}/lib/ldscripts;	\
	    for s in ${FILES}; do					\
		d=`echo $${s} | sed s/-new//`;				\
		${INSTALL_PROGRAM} binutils/$${s} ${TARGET_DIR}/bin/$${d}; \
		${INSTALL_MAN} ${WRKSRC}/binutils/doc/$${d}.1 ${TARGET_DIR}/man/man1; \
	    done							\
	}

.include <bsd.port.mk>
@


1.31
log
@remove myself as maintainer.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2004/09/15 19:07:48 espie Exp $
@


1.30
log
@new style fragments.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2004/05/20 23:11:58 brad Exp $
a15 2

MAINTAINER=		Federico G. Schwindt <fgsch@@openbsd.org>
@


1.29
log
@sync with in-tree binutils

Add dis-init.c from gdb 6.1.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2004/03/01 00:10:38 brad Exp $
a52 13

PLIST_ARCH?=
.if !empty(FLAVOR:L)
. if ${FLAVOR:L} == "armeb"
    PLIST_ARCH=	arm
. else
    PLIST_ARCH= ${FLAVOR:L}
. endif
.else
 PLIST_ARCH= ${MACHINE_ARCH}
.endif

SED_PLIST+=		|sed -e '/^%%arch%%$$/r${PKGDIR}/PFRAG.${PLIST_ARCH}' -e '//d'
@


1.28
log
@x86_64 -> amd64
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2004/02/10 22:49:36 brad Exp $
d80 1
@


1.27
log
@- CONFIGURE_STYLE= simple -> gnu
- add missing objcopy
--
From: drahn@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2004/01/19 01:56:05 brad Exp $
d32 1
a32 1
			sparc sparc64 vax x86_64
d42 1
a42 1
.if ${FLAVOR} == "x86_64" || ${FLAVOR} == "sparc64" || ${FLAVOR} == "alpha"
@


1.26
log
@automake in a few more places and build the man pages
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2003/10/11 00:52:21 brad Exp $
d27 2
a28 4
MODULES=		gnu
CONFIGURE_STYLE=	simple
CONFIGURE_ARGS=		--with-prefix=${PREFIX} \
			--disable-nls --disable-commonbfdlib
d67 1
a67 1
FILES=			addr2line ar nm-new objdump ranlib readelf size strings strip-new 
@


1.25
log
@upgrade to binutils 2.14

Tested on powerpc/sparc64/alpha
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2003/07/28 05:12:00 brad Exp $
d84 2
a85 1
	@@cd ${WRKSRC}/bfd && AUTOCONF_VERSION=${AUTOCONF_VERSION} autoconf
d87 1
d89 6
@


1.24
log
@add ARM support.
--
From: brad@@, based on original diffs from kevlo@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2003/07/16 19:17:21 brad Exp $
d5 1
a5 1
V=			2.13.2.1
d9 1
a42 1
PLIST=			${PKGDIR}/PLIST.cross
d56 14
a69 1
FILES=			ar nm-new objdump ranlib size strings strip-new 
d91 1
a91 5
	if [ -f ${WRKBUILD}/gprof/gprof ]; then \
	  cd ${WRKBUILD};  \
	     ${INSTALL_PROGRAM} gprof/gprof ${TARGET_DIR}/bin; \
	     ${INSTALL_MAN} gprof/gprof.1 ${TARGET_DIR}/man/man1; \
	fi
d93 2
d99 1
@


1.23
log
@- ensure consistent LIB_PATH on all OpenBSD ELF systems
- move WxorX setup into separate OpenBSD arch targets
--
"I have not found any problems with the binutils patch" drahn@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2003/06/30 21:01:14 espie Exp $
d32 1
a32 1
FLAVORS=		alpha hppa i386 m68k m88k mips powerpc \
d62 1
a62 1
			elf_obsd.sh
@


1.22
log
@fix PKGNAME, so that cross-binutils have real different names.
Install files correctly, so that SEPARATE_BUILD gets possible.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2003/06/30 18:24:16 brad Exp $
d58 5
a62 1
EMULPARAMS=		i386obsd.sh sparcobsd.sh m68kobsd.sh
d66 1
a66 1
	cp -f ${FILESDIR}/${f} ${WRKSRC}/ld/emulparams
@


1.21
log
@Remove this ARM support crap. It was not given the ok because it had mistakes
and obviously was not tested.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2003/06/27 02:47:08 kevlo Exp $
d5 2
a6 1
DISTNAME=		binutils-2.13.2.1
d36 2
d43 1
d74 2
a75 2
	if [ -f ${WRKSRC}/gprof/gprof ]; then \
	  cd ${WRKSRC};  \
d79 1
a79 1
	cd ${WRKSRC} && {						\
d87 1
a87 1
		${INSTALL_MAN} binutils/doc/$${d}.1 ${TARGET_DIR}/man/man1; \
@


1.20
log
@add ARM support
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2003/06/15 04:43:31 brad Exp $
d31 1
a31 1
FLAVORS=		alpha arm hppa i386 m68k m88k mips powerpc \
d54 2
d57 3
a59 2
	@@cp -f ${FILESDIR}/{i386obsd.sh,sparcobsd.sh,m68kobsd.sh} \
		${WRKSRC}/ld/emulparams
@


1.19
log
@add AMD64 support.
--
From: art@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2003/06/13 04:17:12 brad Exp $
d31 2
a32 2
FLAVORS=		alpha hppa i386 m68k m88k mips powerpc sparc \
			sparc64 vax x86_64
@


1.18
log
@Actually use the obsd target environment, fgsch@@ thinks this is a better
direction to go in for possible future changes which would afford us greater
flexibility.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2003/06/09 19:11:29 brad Exp $
d32 1
a32 1
			sparc64 vax
d40 3
@


1.17
log
@fix
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2003/06/08 19:02:58 brad Exp $
d54 1
@


1.16
log
@- don't need a separate OpenBSD target environment
- simplify hppa case
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2003/06/05 23:39:47 brad Exp $
d63 5
a67 5
.if exists (${WRKSRC}/gprof/gprof)
	cd ${WRKSRC} && \
	   ${INSTALL_PROGRAM} gprof/gprof ${TARGET_DIR}/bin && \
	   ${INSTALL_MAN} gprof/gprof.1 ${TARGET_DIR}/man/man1
.endif
@


1.15
log
@- put back a a.out related patch I removed on upgrade
- don't like new files being patched into existence
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2003/06/05 18:28:24 brad Exp $
a53 1
	@@cp -f ${FILESDIR}/te-obsd.h ${WRKSRC}/gas/config
@


1.14
log
@- gprof is not built with cross-binutils so add another PLIST without it
- fix syntax of gas configure.in stuff for sparc
- add missing change for the sparc ELF transition to bfd
--
Hasn't actually been tested on a real sparc system but it at least allows
me to build a cross-binutils without bombing durring build or the PLIST issue
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2003/06/05 04:03:55 brad Exp $
d54 1
@


1.13
log
@upgrade to binutils 2.13.2.1

This is work in progress. It is being commited as a starting point so other
people can look at it/fix issues/and maybe Art can add Hammer support? :)
It has been lightly tested on macppc/sparc64/i386 and compile tested by
mickey@@ on hppa.

DO NOT try to build ld.so on sparc/sparc64/macppc and install the resulting
binary unless you like having a hosed system. A known "misfeature" in ld.so
that is being worked on.
--
MAINTAINER ok
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2003/02/27 19:27:01 espie Exp $
d39 1
d63 5
a69 1
	    ${INSTALL_PROGRAM} gprof/gprof ${TARGET_DIR}/bin;		\
a71 1
	    ${INSTALL_MAN} gprof/gprof.1 ${TARGET_DIR}/man/man1;	\
@


1.12
log
@MODULES=gnu can be used to access MODGNU_AUTOCONF_DEPENDS without entering
into CONFIGURE_STYLE issues.
ok naddy, pval
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2003/02/16 15:17:58 espie Exp $
d5 1
a5 1
DISTNAME=		binutils-2.11.2
d7 1
a7 1
MASTER_SITES=           ${MASTER_SITE_GNU:=binutils/}
d9 1
d17 1
a17 1
HOMEPAGE=		http://sources.redhat.com/
d23 2
d28 1
a28 1
			--disable-nls --disable-gdbtk --disable-commonbfdlib
d46 1
d50 4
a55 1
	@@cd ${WRKSRC}/binutils && AUTOCONF_VERSION=${AUTOCONF_VERSION} autoconf
d72 1
a72 1
		${INSTALL_MAN} binutils/$${d}.1 ${TARGET_DIR}/man/man1;	\
a74 2

SUBST_VARS=TARGET_ARCH OSREV
@


1.11
log
@use MODGNU_AUTOCONF_DEPENDS
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2003/02/15 14:26:03 espie Exp $
d22 1
@


1.10
log
@explicit check for autoconf version
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2002/10/25 22:37:12 naddy Exp $
d20 1
a20 2
			::devel/autoconf/${AUTOCONF_VERSION} \
			::devel/metaauto
@


1.9
log
@Enable regression tests.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2002/05/13 10:54:45 fgsch Exp $
d18 4
a21 2
BUILD_DEPENDS=		automake::devel/automake \
			autoconf::devel/autoconf
d47 3
a49 3
	@@cd ${WRKSRC}/bfd && autoconf
	@@cd ${WRKSRC}/binutils && autoconf
	@@-cd ${WRKSRC}/gas && { automake; autoconf; }
@


1.8
log
@- MASTER_SITE_SUBDIR -> ${SITE:=subdir/}
- bump NEED_VERSION.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2002/05/06 22:55:07 drahn Exp $
a6 1
NEED_VERSION=		1.528
d39 2
@


1.7
log
@Opps, run autoconf in the Makefile, not run autoconf and commit.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2002/04/25 22:37:10 fgsch Exp $
d7 2
a8 3
NEED_VERSION=		1.504
MASTER_SITES=		${MASTER_SITE_GNU}
MASTER_SITE_SUBDIR=	binutils
@


1.6
log
@enable vax.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2002/04/07 21:26:16 fgsch Exp $
d46 1
@


1.5
log
@oops, missing ;
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2002/04/07 21:11:45 fgsch Exp $
d28 2
a29 2
FLAVORS=		alpha hppa i386 m68k m88k mips powerpc sparc sparc64
#FLAVORS+=		 vax
@


1.4
log
@don't start subshells; now ppl will love me again.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2002/03/19 08:28:00 fgsch Exp $
d46 1
a46 1
	@@-cd ${WRKSRC}/gas && { automake; autoconf }
@


1.3
log
@add mips.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2002/02/20 05:27:18 fgsch Exp $
d46 1
a46 1
	@@-cd ${WRKSRC}/gas && ( automake; autoconf )
d52 1
a52 1
	cd ${WRKSRC} && (						\
d64 1
a64 1
	)
@


1.2
log
@Change directory layout to ${TARGET_ARCH}-unknown-openbsd${OSREV}/. This
is more clear for cross-tools.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2002/02/19 04:19:21 fgsch Exp $
d28 1
a28 1
FLAVORS=		alpha hppa i386 m68k m88k powerpc sparc sparc64
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d7 1
a7 1
NEED_VERSION=		1.500
a31 2
BINUTILS=		ar nm-new objdump ranlib size strings strip-new 

d35 3
d40 4
d50 2
d53 7
a59 7
	    ${INSTALL_PROGRAM} gas/as-new ${PREFIX}/bin/as;		\
	    ${INSTALL_PROGRAM} gprof/gprof ${PREFIX}/bin;		\
	    ${INSTALL_PROGRAM} ld/ld-new ${PREFIX}/bin/ld;		\
	    ${INSTALL_MAN} gas/doc/as.1 ${PREFIX}/man/man1;		\
	    ${INSTALL_MAN} gprof/gprof.1 ${PREFIX}/man/man1;		\
	    ${INSTALL_MAN} ld/ld.1 ${PREFIX}/man/man1;			\
	    for s in ${BINUTILS}; do					\
d61 2
a62 2
		${INSTALL_PROGRAM} binutils/$${s} ${PREFIX}/bin/$${d};	\
		${INSTALL_MAN} binutils/$${d}.1 ${PREFIX}/man/man1;	\
d65 2
@


1.1.1.1
log
@GNU binutils 2.11.2.
@
text
@@
