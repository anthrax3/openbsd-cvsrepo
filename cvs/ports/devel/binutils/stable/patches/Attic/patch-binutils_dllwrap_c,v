head	1.5;
access;
symbols
	OPENBSD_3_6:1.4.0.6
	OPENBSD_3_6_BASE:1.4
	OPENBSD_3_5:1.4.0.4
	OPENBSD_3_5_BASE:1.4
	OPENBSD_3_4:1.4.0.2
	OPENBSD_3_4_BASE:1.4
	OPENBSD_3_3:1.2.0.4
	OPENBSD_3_3_BASE:1.2
	OPENBSD_3_2:1.2.0.2
	OPENBSD_3_2_BASE:1.2;
locks; strict;
comment	@# @;


1.5
date	2004.11.18.23.40.06;	author fgsch;	state dead;
branches;
next	1.4;

1.4
date	2003.06.08.03.04.50;	author brad;	state Exp;
branches;
next	1.3;

1.3
date	2003.06.05.04.03.55;	author brad;	state Exp;
branches;
next	1.2;

1.2
date	2002.05.09.02.44.35;	author fgsch;	state Exp;
branches;
next	1.1;

1.1
date	2002.05.08.11.02.40;	author fgsch;	state Exp;
branches;
next	;


desc
@@


1.5
log
@remove binutils now that we have a recent and more closely tracked version.
if it's needed in the future, we can bring it back. pvalchev@@ ok.
@
text
@$OpenBSD: patch-binutils_dllwrap_c,v 1.4 2003/06/08 03:04:50 brad Exp $
--- binutils/dllwrap.c.orig	Mon Jul 15 22:04:32 2002
+++ binutils/dllwrap.c	Sun Mar 16 15:35:15 2003
@@@@ -366,7 +366,11 @@@@ run (what, args)
   int i;
   const char **argv;
   char *errmsg_fmt, *errmsg_arg;
+#if defined(__MSDOS__) && !defined(__GO32__)
   char *temp_base = choose_temp_base ();
+#else
+  char *temp_base = NULL;
+#endif
   int in_quote;
   char sep;
 
@@@@ -820,12 +824,9 @@@@ main (argc, argv)
 
   if (! def_file_seen)
     {
-      char *fileprefix = choose_temp_base ();
-      def_file_name = (char *) xmalloc (strlen (fileprefix) + 5);
-      sprintf (def_file_name, "%s.def",
-	       (dontdeltemps) ? mybasename (fileprefix) : fileprefix);
-      delete_def_file = 1;
-      free (fileprefix);
+      def_file_name = make_temp_file (".def");
+      if (dontdeltemps)
+	def_file_name = mybasename (def_file_name);
       delete_def_file = 1;
       warn (_("no export definition file provided.\n\
 Creating one, but that may not be what you want"));
@@@@ -1008,12 +1009,10 @@@@ Creating one, but that may not be what y
 
   if (! base_file_name)
     {
-      char *fileprefix = choose_temp_base ();
-      base_file_name = (char *) xmalloc (strlen (fileprefix) + 6);
-      sprintf (base_file_name, "%s.base",
-	       (dontdeltemps) ? mybasename (fileprefix) : fileprefix);
+      base_file_name = make_temp_file (".base");
+      if (dontdeltemps)
+	base_file_name = mybasename (base_file_name);
       delete_base_file = 1;
-      free (fileprefix);
     }
 
   {
@


1.4
log
@RCS ids
@
text
@d1 1
a1 1
$OpenBSD$
@


1.3
log
@upgrade to binutils 2.13.2.1

This is work in progress. It is being commited as a starting point so other
people can look at it/fix issues/and maybe Art can add Hammer support? :)
It has been lightly tested on macppc/sparc64/i386 and compile tested by
mickey@@ on hppa.

DO NOT try to build ld.so on sparc/sparc64/macppc and install the resulting
binary unless you like having a hosed system. A known "misfeature" in ld.so
that is being worked on.
--
MAINTAINER ok
@
text
@d1 1
@


1.2
log
@after some mails, the 'pe' problem has been fixed in binutils, so pull
the diff; openbsd should no longer match any of these. regen.
@
text
@d1 3
a3 4
$OpenBSD: patch-binutils_dllwrap_c,v 1.1 2002/05/08 11:02:40 fgsch Exp $
--- binutils/dllwrap.c.orig	Thu Jun  7 00:12:27 2001
+++ binutils/dllwrap.c	Wed May  8 21:40:35 2002
@@@@ -392,7 +392,11 @@@@ run (what, args)
d15 1
a15 1
@@@@ -834,12 +838,9 @@@@ main (argc, argv)
d21 2
a22 2
-      sprintf (def_file_name, "%s.def", 
-               (dontdeltemps) ? mybasename (fileprefix) : fileprefix);
d27 1
a27 1
+        def_file_name = mybasename (def_file_name);
d29 4
a32 4
       warn (_("no export definition file provided"));
       warn (_("creating one, but that may not be what you want"));
@@@@ -1022,12 +1023,10 @@@@ main (argc, argv)
   
d37 2
a38 2
-      sprintf (base_file_name, "%s.base", 
-               (dontdeltemps) ? mybasename (fileprefix) : fileprefix);
d41 1
a41 1
+        base_file_name = mybasename (base_file_name);
d45 1
a45 1
   
@


1.1
log
@pull more changes from the FSF tag, a few more to come.
@
text
@d1 3
a3 3
$OpenBSD$
--- binutils/dllwrap.c.orig	Wed May  8 04:03:55 2002
+++ binutils/dllwrap.c	Wed May  8 04:06:02 2002
a7 1
-  char *temp_base = choose_temp_base ();
d9 1
a9 1
+  char *temp_base = choose_temp_base ();
@

