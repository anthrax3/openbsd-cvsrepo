head	1.1;
branch	1.1.1;
access;
symbols
	OPENBSD_6_0:1.1.1.1.0.12
	OPENBSD_6_0_BASE:1.1.1.1
	OPENBSD_5_9:1.1.1.1.0.8
	OPENBSD_5_9_BASE:1.1.1.1
	OPENBSD_5_8:1.1.1.1.0.10
	OPENBSD_5_8_BASE:1.1.1.1
	OPENBSD_5_7:1.1.1.1.0.6
	OPENBSD_5_7_BASE:1.1.1.1
	OPENBSD_5_6:1.1.1.1.0.4
	OPENBSD_5_6_BASE:1.1.1.1
	OPENBSD_5_5:1.1.1.1.0.2
	OPENBSD_5_5_BASE:1.1.1.1
	brad_20131126:1.1.1.1
	brad:1.1.1;
locks; strict;
comment	@# @;


1.1
date	2013.11.27.04.46.56;	author brad;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2013.11.27.04.46.56;	author brad;	state Exp;
branches;
next	;


desc
@@



1.1
log
@Initial revision
@
text
@$OpenBSD$
--- audio/MPEGaudio.cpp.orig	Wed Oct 30 22:24:56 2013
+++ audio/MPEGaudio.cpp	Wed Oct 30 22:28:52 2013
@@@@ -68,10 +68,16 @@@@ MPEGaudio:: MPEGaudio(MPEGstream *stream, bool initSDL
         if ( sdl_audio ) {
             /* Open the audio, get actual audio hardware format and convert */
             bool audio_active;
+#ifdef DISABLE_SDL_CONVERSIONS
             SDL_AudioSpec actual;
             audio_active = (SDL_OpenAudio(&wanted, &actual) == 0);
             if ( audio_active ) {
                 ActualSpec(&actual);
+#else
+            audio_active = (SDL_OpenAudio(&wanted, NULL) == 0);
+            if ( audio_active ) {
+                ActualSpec(&wanted);
+#endif
                 valid_stream = true;
             } else {
                 SetError(SDL_GetError());
@@@@ -126,6 +132,8 @@@@ MPEGaudio:: WantedSpec(SDL_AudioSpec *wanted)
 void
 MPEGaudio:: ActualSpec(const SDL_AudioSpec *actual)
 {
+#ifdef DISABLE_SDL_CONVERSIONS
+
     /* Splay can optimize some of the conversion */
     if ( actual->channels == 1 && outputstereo ) {
         forcetomonoflag = true;
@@@@ -145,6 +153,9 @@@@ MPEGaudio:: ActualSpec(const SDL_AudioSpec *actual)
 	;
 #endif
     }
+
+#endif  /* DISABLE_SDL_CONVERSIONS */
+
     if ( actual->format != AUDIO_S16SYS )
     {
         if ( (actual->format^0x1000) == AUDIO_S16SYS ) {
@


1.1.1.1
log
@Import smpeg2.

SMPEG is a free MPEG-1 video player library with sound support.  Video
playback is based on the ubiquitous Berkeley MPEG player, mpeg_play v2.2.
SMPEG support MPEG audio (MP3), based on mpg123's source, MPEG-1 video,
and MPEG system streams.

ok sthen@@
@
text
@@
