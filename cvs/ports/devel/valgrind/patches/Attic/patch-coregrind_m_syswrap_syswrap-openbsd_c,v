head	1.3;
access;
symbols
	OPENBSD_5_9:1.2.0.2
	OPENBSD_5_9_BASE:1.2;
locks; strict;
comment	@# @;


1.3
date	2016.03.29.05.10.55;	author uebayasi;	state dead;
branches;
next	1.2;
commitid	OBDtcQl5fnlZFAkp;

1.2
date	2015.08.24.04.44.29;	author uebayasi;	state Exp;
branches;
next	1.1;
commitid	R33lR5w04vqDT0EJ;

1.1
date	2015.08.24.03.34.43;	author uebayasi;	state Exp;
branches;
next	;
commitid	sPLtlzAmi0OyYUKl;


desc
@@


1.3
log
@valgrind-3.10.1p9: Not only recognize pledge(2) but also skip it so
Valgrind can call syscalls implicitly.
@
text
@$OpenBSD: patch-coregrind_m_syswrap_syswrap-openbsd_c,v 1.2 2015/08/24 04:44:29 uebayasi Exp $
--- coregrind/m_syswrap/syswrap-openbsd.c.orig	Mon Aug 24 13:33:28 2015
+++ coregrind/m_syswrap/syswrap-openbsd.c	Mon Aug 24 13:30:18 2015
@@@@ -541,6 +541,11 @@@@ PRE(sys_listen)
    PRE_REG_READ2(long, "listen", int, s, int, backlog);
 }
 
+PRE(sys_tame)
+{
+// XXXTBD
+}
+
 PRE(sys_ppoll)
 {
 // XXXTBD
@@@@ -2752,6 +2757,11 @@@@ PRE(sys_futimens)
 // XXXTBD
 }
 
+PRE(sys_kbind)
+{
+// XXXTBD
+}
+
 PRE(sys___set_tcb)
 {
 // XXXTBD
@@@@ -3964,6 +3974,7 @@@@ const SyscallTableEntry ML_(syscall_table)[] = {
   BSDX_(__NR_utimensat,		sys_utimensat),		// 84
   BSDX_(__NR_futimens,		sys_futimens),		// 85
 
+  BSDX_(__NR_kbind,		sys_kbind),		// 86
   BSDXY(__NR_clock_gettime,	sys_clock_gettime),	// 87
   BSDX_(__NR_clock_settime,	sys_clock_settime),	// 88
   BSDXY(__NR_clock_getres,	sys_clock_getres),	// 89
@@@@ -3988,7 +3999,7 @@@@ const SyscallTableEntry ML_(syscall_table)[] = {
 
   BSDX_(__NR_listen,		sys_listen),		// 106
   // obsol vtimes					// 107
-  // obsol osigvec					// 108
+  BSDX_(__NR_tame,		sys_tame),		// 108
   BSDX_(__NR_ppoll,		sys_ppoll),		// 109
   BSDX_(__NR_pselect,		sys_pselect),		// 110
 
@


1.2
log
@Minimally support tame(2) too; ride on the previous revision bump.
@
text
@d1 1
a1 1
$OpenBSD: patch-coregrind_m_syswrap_syswrap-openbsd_c,v 1.1 2015/08/24 03:34:43 uebayasi Exp $
@


1.1
log
@valgrind-3.10.1p7: Minimally support kbind(2).
@
text
@d1 16
a16 4
$OpenBSD$
--- coregrind/m_syswrap/syswrap-openbsd.c.orig	Sat Aug  1 11:57:49 2015
+++ coregrind/m_syswrap/syswrap-openbsd.c	Mon Aug 24 12:18:13 2015
@@@@ -2752,6 +2752,11 @@@@ PRE(sys_futimens)
d28 1
a28 1
@@@@ -3964,6 +3969,7 @@@@ const SyscallTableEntry ML_(syscall_table)[] = {
d36 9
@

