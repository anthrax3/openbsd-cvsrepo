head	1.2;
access;
symbols
	OPENBSD_4_5:1.1.0.2
	OPENBSD_4_5_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2009.06.19.16.52.14;	author simon;	state dead;
branches;
next	1.1;

1.1
date	2008.09.24.17.45.42;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.2
log
@update to version 1.34

confirmed by maintainer Srebrenko Sehic
@
text
@$OpenBSD: patch-Cache-FastMmap-CImpl_mmap_cache_c,v 1.1 2008/09/24 17:45:42 jasper Exp $
--- Cache-FastMmap-CImpl/mmap_cache.c.orig	Wed Sep 24 19:45:10 2008
+++ Cache-FastMmap-CImpl/mmap_cache.c	Wed Sep 24 19:46:50 2008
@@@@ -649,6 +649,7 @@@@ int mmc_write(
 ) {
   int did_store = 0;
   MU32 kvlen = KV_SlotLen(key_len, val_len);
+  MU32 expire_time;
 
   /* Search for slot with given key */
   MU32 * slot_ptr = _mmc_find_slot(cache, hash_slot, key_ptr, key_len, 1);
@@@@ -676,7 +677,7 @@@@ int mmc_write(
 
     /* Calculate expiry time */
     if (expire_seconds == (MU32)-1) expire_seconds = cache->expire_time;
-    MU32 expire_time = expire_seconds ? now + expire_seconds : 0;
+    expire_time = expire_seconds ? now + expire_seconds : 0;
 
     /* Store info into slot */
     S_LastAccess(base_det) = now;
@


1.1
log
@- fix build with GCC2
@
text
@d1 1
a1 1
$OpenBSD$
@

