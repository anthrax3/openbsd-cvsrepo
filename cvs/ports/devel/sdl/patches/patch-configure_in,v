head	1.30;
access;
symbols
	OPENBSD_6_2:1.30.0.16
	OPENBSD_6_2_BASE:1.30
	OPENBSD_6_1:1.30.0.14
	OPENBSD_6_1_BASE:1.30
	OPENBSD_6_0:1.30.0.12
	OPENBSD_6_0_BASE:1.30
	OPENBSD_5_9:1.30.0.8
	OPENBSD_5_9_BASE:1.30
	OPENBSD_5_8:1.30.0.10
	OPENBSD_5_8_BASE:1.30
	OPENBSD_5_7:1.30.0.6
	OPENBSD_5_7_BASE:1.30
	OPENBSD_5_6:1.30.0.4
	OPENBSD_5_6_BASE:1.30
	OPENBSD_5_5:1.30.0.2
	OPENBSD_5_5_BASE:1.30
	OPENBSD_4_2:1.28.0.2
	OPENBSD_4_2_BASE:1.28
	OPENBSD_4_1:1.27.0.2
	OPENBSD_4_1_BASE:1.27
	OPENBSD_4_0:1.25.0.4
	OPENBSD_4_0_BASE:1.25
	OPENBSD_3_9:1.25.0.2
	OPENBSD_3_9_BASE:1.25
	OPENBSD_3_8:1.24.0.2
	OPENBSD_3_8_BASE:1.24
	OPENBSD_3_7:1.23.0.2
	OPENBSD_3_7_BASE:1.23
	OPENBSD_3_6:1.22.0.4
	OPENBSD_3_6_BASE:1.22
	OPENBSD_3_5:1.22.0.2
	OPENBSD_3_5_BASE:1.22
	OPENBSD_3_4:1.20.0.2
	OPENBSD_3_4_BASE:1.20
	OPENBSD_3_3:1.19.0.2
	OPENBSD_3_3_BASE:1.19
	OPENBSD_3_2:1.18.0.2
	OPENBSD_3_2_BASE:1.18
	OPENBSD_3_1:1.14.0.2
	OPENBSD_3_1_BASE:1.14
	OPENBSD_3_0:1.12.0.2
	OPENBSD_3_0_BASE:1.12
	OPENBSD_2_9_TRACKING_SWITCH:1.12
	OPENBSD_2_9:1.2.0.2
	OPENBSD_2_9_BASE:1.2
	obecian_2001-Apr-19:1.1.1.1
	obecian:1.1.1;
locks; strict;
comment	@# @;


1.30
date	2013.12.15.01.57.55;	author brad;	state Exp;
branches;
next	1.29;

1.29
date	2007.09.22.01.12.38;	author pvalchev;	state dead;
branches;
next	1.28;

1.28
date	2007.07.20.05.23.41;	author jakemsr;	state Exp;
branches;
next	1.27;

1.27
date	2006.10.19.00.26.34;	author pvalchev;	state Exp;
branches;
next	1.26;

1.26
date	2006.10.18.17.53.08;	author pvalchev;	state dead;
branches;
next	1.25;

1.25
date	2005.09.17.00.38.15;	author pvalchev;	state Exp;
branches;
next	1.24;

1.24
date	2005.05.11.17.26.15;	author pvalchev;	state Exp;
branches;
next	1.23;

1.23
date	2004.10.25.02.34.21;	author pvalchev;	state Exp;
branches;
next	1.22;

1.22
date	2003.12.07.19.45.43;	author espie;	state Exp;
branches;
next	1.21;

1.21
date	2003.09.29.05.41.37;	author pvalchev;	state Exp;
branches;
next	1.20;

1.20
date	2003.04.18.02.37.06;	author pvalchev;	state Exp;
branches;
next	1.19;

1.19
date	2002.11.30.11.17.26;	author wcobb;	state Exp;
branches;
next	1.18;

1.18
date	2002.05.26.04.11.16;	author wcobb;	state Exp;
branches;
next	1.17;

1.17
date	2002.05.06.04.26.08;	author pvalchev;	state Exp;
branches;
next	1.16;

1.16
date	2002.05.03.19.27.17;	author pvalchev;	state Exp;
branches;
next	1.15;

1.15
date	2002.04.21.00.20.08;	author pvalchev;	state Exp;
branches;
next	1.14;

1.14
date	2002.02.19.20.51.46;	author pvalchev;	state Exp;
branches;
next	1.13;

1.13
date	2001.12.28.23.42.27;	author pvalchev;	state Exp;
branches;
next	1.12;

1.12
date	2001.08.14.22.42.03;	author pvalchev;	state Exp;
branches;
next	1.11;

1.11
date	2001.07.25.07.58.32;	author pvalchev;	state Exp;
branches;
next	1.10;

1.10
date	2001.07.20.03.07.07;	author pvalchev;	state Exp;
branches;
next	1.9;

1.9
date	2001.07.11.16.45.45;	author pvalchev;	state Exp;
branches;
next	1.8;

1.8
date	2001.07.03.01.00.14;	author pvalchev;	state Exp;
branches;
next	1.7;

1.7
date	2001.06.23.23.35.10;	author pvalchev;	state Exp;
branches;
next	1.6;

1.6
date	2001.06.23.19.05.36;	author pvalchev;	state Exp;
branches;
next	1.5;

1.5
date	2001.05.24.05.54.57;	author pvalchev;	state Exp;
branches;
next	1.4;

1.4
date	2001.05.16.23.55.36;	author pvalchev;	state Exp;
branches;
next	1.3;

1.3
date	2001.05.12.04.27.06;	author pvalchev;	state Exp;
branches;
next	1.2;

1.2
date	2001.04.21.15.37.57;	author brad;	state Exp;
branches;
next	1.1;

1.1
date	2001.04.19.18.55.40;	author obecian;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2001.04.19.18.55.40;	author obecian;	state Exp;
branches;
next	;


desc
@@


1.30
log
@- Rename the sndio backend files to match what was submitted upstream
  and sync in the autoconf bits.
- Sync WANTLIB.
- Merge in PFRAG.shared.

ok bcallah@@
@
text
@$OpenBSD$
--- configure.in.orig	Thu Jan 19 01:30:05 2012
+++ configure.in	Thu Dec  5 14:41:54 2013
@@@@ -486,6 +486,35 @@@@ AC_HELP_STRING([--enable-esd-shared], [dynamically loa
     fi
 }
 
+dnl Find Sndio
+CheckSndio()
+{
+    AC_ARG_ENABLE(sndio,
+AC_HELP_STRING([--enable-sndio], [support the sndio audio API [[default=yes]]]),
+                  , enable_sndioaudio=yes)
+    if test x$enable_audio = xyes -a x$enable_sndioaudio = xyes; then
+        AC_CHECK_HEADER(sndio.h, have_sndio_hdr=yes)
+        AC_CHECK_LIB(sndio, sio_open, have_sndio_lib=yes)
+
+        AC_MSG_CHECKING(for sndio support)
+        have_sndio=no
+
+        if test x$have_sndio_hdr = xyes -a x$have_sndio_lib = xyes; then
+            have_sndio=yes
+            SNDIO_LIBS="-lsndio"
+        fi
+
+        AC_MSG_RESULT($have_sndio)
+
+        if test x$have_sndio = xyes; then
+            AC_DEFINE(SDL_AUDIO_DRIVER_SNDIO)
+            SOURCES="$SOURCES $srcdir/src/audio/sndio/*.c"
+            EXTRA_LDFLAGS="$EXTRA_LDFLAGS $SNDIO_LIBS"
+            have_audio=yes
+        fi
+    fi
+}
+
 dnl Find PulseAudio
 CheckPulseAudio()
 {
@@@@ -860,8 +889,8 @@@@ CheckVisibilityHidden()
     save_CFLAGS="$CFLAGS"
     CFLAGS="$save_CFLAGS $visibility_CFLAGS -Werror"
     AC_TRY_COMPILE([
-    #if !defined(__GNUC__) || __GNUC__ < 4
-    #error SDL only uses visibility attributes in GCC 4 or newer
+    #if !defined(__GNUC__) || __GNUC__ < 3
+    #error SDL only uses visibility attributes in GCC 3 or newer
     #endif
     ],[
     ],[
@@@@ -1005,6 +1034,12 @@@@ AC_HELP_STRING([--enable-x11-shared], [dynamically loa
                     x11_lib='libX11.so'
                     x11ext_lib='libXext.so'
                     ;;
+                *-*-openbsd*)
+                    x11_lib='libX11.so'
+                    x11ext_lib='libXext.so'
+                    xrender_lib='libXrender.so'
+                    xrandr_lib='libXrandr.so'
+                    ;;
                 *)
                     x11_lib=[`find_lib "libX11.so.*" "$X_LIBS -L/usr/X11/$base_libdir -L/usr/X11R6/$base_libdir" | sed 's/.*\/\(.*\)/\1/; q'`]
                     x11ext_lib=[`find_lib "libXext.so.*" "$X_LIBS -L/usr/X11/$base_libdir -L/usr/X11R6/$base_libdir" | sed 's/.*\/\(.*\)/\1/; q'`]
@@@@ -1034,7 +1069,7 @@@@ AC_HELP_STRING([--enable-x11-shared], [dynamically loa
             fi
             if test x$x11_symbols_private != xyes && \
                test x$enable_x11_shared = xyes; then
-                AC_MSG_WARN([You must have gcc4 (-fvisibility=hidden) for dynamic X11 loading])
+                AC_MSG_WARN([You must have gcc3 (-fvisibility=hidden) for dynamic X11 loading])
                 enable_x11_shared=no
             fi
 
@@@@ -2358,6 +2393,7 @@@@ case "$host" in
         CheckALSA
         CheckARTSC
         CheckESD
+        CheckSndio
         CheckPulseAudio
         CheckNAS
         CheckX11
@@@@ -2390,7 +2426,7 @@@@ case "$host" in
                 SOURCES="$SOURCES $srcdir/src/audio/sun/*.c"
                 have_audio=yes
             ;;
-            netbsd|openbsd)
+            netbsd)
                 AC_DEFINE(SDL_AUDIO_DRIVER_BSD)
                 SOURCES="$SOURCES $srcdir/src/audio/bsd/*.c"
                 have_audio=yes
@


1.29
log
@update to sdl-1.2.12. long due update, possible now since the macppc
X acceleration bug is now gone (thanks for ajacoutot for endless testing
of this issue), diff from brad
@
text
@d1 4
a4 21
$OpenBSD: patch-configure_in,v 1.28 2007/07/20 05:23:41 jakemsr Exp $
--- configure.in.orig	Sat Aug 27 23:31:18 2005
+++ configure.in	Sun Jul  8 01:07:57 2007
@@@@ -535,9 +535,6 @@@@ CheckNASM()
               win32)
                   NASMFLAGS="-f win32"
                   ;;
-              openbsd)
-                  NASMFLAGS="-f aoutb"
-                  ;;
               *)
                   NASMFLAGS="-f elf"
                   ;;
@@@@ -1082,9 +1079,6 @@@@ CheckOpenGL()
         AC_MSG_RESULT($video_opengl)
         if test x$video_opengl = xyes; then
             CFLAGS="$CFLAGS -DHAVE_OPENGL"
-            if test x$use_dlopen != xyes; then
-                AC_CHECK_LIB(dl, dlopen, SYSTEM_LIBS="$SYSTEM_LIBS -ldl")
-            fi
         fi
a6 23
@@@@ -1105,9 +1099,6 @@@@ CheckOpenGLQNX()
         if test x$video_opengl = xyes; then
             CFLAGS="$CFLAGS -DHAVE_OPENGL"
             SYSTEM_LIBS="$SYSTEM_LIBS -lGL"
-            if test x$use_dlopen != xyes; then
-                AC_CHECK_LIB(c, dlopen, SYSTEM_LIBS="$SYSTEM_LIBS", AC_CHECK_LIB(ltdl, dlopen, SYSTEM_LIBS="$SYSTEM_LIBS -lltdl"))
-            fi
         fi
     fi
 }
@@@@ -1680,6 +1671,9 @@@@ CheckDLOPEN()
     AC_ARG_ENABLE(sdl-dlopen,
 [  --enable-sdl-dlopen     use dlopen for shared object loading [default=yes]],
                   , enable_sdl_dlopen=yes)
+    AC_ARG_ENABLE(ltdl,
+[  --enable-ltdl           use libtool for shared object loading [default=no]],
+		  , enable_ltdl=yes)
     if test x$enable_sdl_dlopen = xyes; then
         AC_MSG_CHECKING(for dlopen)
         use_dlopen=no
@@@@ -1691,7 +1685,7 @@@@ CheckDLOPEN()
         ])
         AC_MSG_RESULT($use_dlopen)
d8 64
a71 25
-        if test x$use_dlopen = xyes; then
+        if test x$use_dlopen = xyes -a x$enable_ltdl = xyes; then
             CFLAGS="$CFLAGS -DUSE_DLOPEN"
             AC_CHECK_LIB(c, dlopen, SYSTEM_LIBS="$SYSTEM_LIBS",
                AC_CHECK_LIB(dl, dlopen, SYSTEM_LIBS="$SYSTEM_LIBS -ldl",
@@@@ -2115,9 +2109,9 @@@@ case "$target" in
         CheckRPATH
         # Set up files for the audio library
         if test x$enable_audio = xyes; then
-            CFLAGS="$CFLAGS -DOPENBSD_AUDIO_SUPPORT"
-            AUDIO_SUBDIRS="$AUDIO_SUBDIRS openbsd"
-            AUDIO_DRIVERS="$AUDIO_DRIVERS openbsd/libaudio_openbsd.la"
+            CFLAGS="$CFLAGS -DSUNAUDIO_SUPPORT"
+            AUDIO_SUBDIRS="$AUDIO_SUBDIRS sun"
+            AUDIO_DRIVERS="$AUDIO_DRIVERS sun/libaudio_sun.la"
         fi
         # OpenBSD needs linking with ossaudio emulation library
         if test x$have_oss = xyes; then
@@@@ -2764,6 +2758,9 @@@@ if test "x$enable_rpath" = "xyes"; then
 else
   SDL_RLD_FLAGS=""
 fi
+if test $ARCH = openbsd -a x$enable_video_x11 = xyes; then
+  SDL_RLD_FLAGS="-L${X11BASE}/lib"
+fi
d73 17
a89 11
 case "$ARCH" in
   openbsd | netbsd | bsdi)
@@@@ -2797,7 +2794,7 @@@@ esac
 STATIC_SYSTEM_LIBS="$SYSTEM_LIBS"
 
 dnl Output the video drivers we use
-if test x$enable_video = xtrue; then
+if test x$enable_video = xyes; then
     if test "$VIDEO_SUBDIRS" = ""; then
         AC_MSG_ERROR(*** No video drivers are enabled!)
     fi
@


1.28
log
@- use the sun audio interface instead of the OpenBSD interface
- sync patches with update-patches
- bump PKGNAME

the sun interface keeps fewer samples in the play buffer, and with
less fluctuation than the OpenBSD interface.  results in better
audio-video synchronization in e.g. ffplay and gnash

go for it -pval
@
text
@d1 1
a1 1
$OpenBSD: patch-configure_in,v 1.27 2006/10/19 00:26:34 pvalchev Exp $
@


1.27
log
@revert to sdl-1.2.9 for now as this causes some breakage with
at least some macppc scenarios; discovered by ajacoutot
since it's only a few hour window of breakage, be careful reverting
things if you updated during that time
@
text
@d1 3
a3 3
$OpenBSD: patch-configure_in,v 1.25 2005/09/17 00:38:15 pvalchev Exp $
--- configure.in.orig	Sun Aug 28 00:31:18 2005
+++ configure.in	Sat Sep 10 20:34:34 2005
d53 13
@


1.26
log
@update to sdl-1.2.11
sdl-config --libs is now fixed to pass just -lSDL and the needed deps
get pulled implicitly as is proper
feedback/testing by various and ports@@
@
text
@@


1.25
log
@Update to sdl-1.2.9
@
text
@d1 1
a1 1
$OpenBSD: patch-configure_in,v 1.24 2005/05/11 17:26:15 pvalchev Exp $
@


1.24
log
@update to SDL-1.2.8
@
text
@d1 3
a3 3
$OpenBSD: patch-configure_in,v 1.23 2004/10/25 02:34:21 pvalchev Exp $
--- configure.in.orig	Mon Dec 13 20:02:08 2004
+++ configure.in	Fri Dec 17 16:36:47 2004
d34 1
a34 1
@@@@ -1681,6 +1672,9 @@@@ CheckDLOPEN()
d44 1
a44 1
@@@@ -1692,7 +1686,7 @@@@ CheckDLOPEN()
d53 3
a55 3
@@@@ -2730,6 +2724,9 @@@@ fi
 if test $ARCH = solaris; then
   SDL_RLD_FLAGS="-R\${exec_prefix}/lib"
d63 1
a63 1
@@@@ -2763,7 +2760,7 @@@@ esac
@


1.23
log
@Update to SDL-1.2.7; based on work by jsg@@
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.22 2003/12/07 19:45:43 espie Exp $
--- configure.in.orig	Mon Feb 23 08:31:47 2004
+++ configure.in	Mon Sep 27 12:01:55 2004
@@@@ -501,9 +501,6 @@@@ CheckNASM()
d14 1
a14 1
@@@@ -1040,9 +1037,6 @@@@ CheckOpenGL()
d24 1
a24 1
@@@@ -1063,9 +1057,6 @@@@ CheckOpenGLQNX()
d34 1
a34 1
@@@@ -1595,6 +1586,9 @@@@ CheckDLOPEN()
d44 1
a44 1
@@@@ -1606,7 +1600,7 @@@@ CheckDLOPEN()
d53 1
a53 1
@@@@ -2612,6 +2606,9 @@@@ fi
d63 1
a63 1
@@@@ -2645,7 +2642,7 @@@@ esac
@


1.22
log
@do not pick up libtool on the way.
okay pval@@
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.21 2003/09/29 05:41:37 pvalchev Exp $
--- configure.in.orig	2003-08-30 21:13:18.000000000 +0200
+++ configure.in	2003-12-07 19:43:19.000000000 +0100
@@@@ -492,9 +492,6 @@@@ CheckNASM()
d14 1
a14 1
@@@@ -1030,9 +1027,6 @@@@ CheckOpenGL()
d24 1
a24 1
@@@@ -1053,9 +1047,6 @@@@ CheckOpenGLQNX()
d34 4
a37 4
@@@@ -1559,6 +1550,9 @@@@ CheckDLOPEN()
     AC_ARG_ENABLE(dlopen,
 [  --enable-dlopen         use dlopen for shared object loading [default=no]],
                   , enable_dlopen=yes)
d40 2
a41 2
+                  , enable_ltdl=yes)
     if test x$enable_dlopen = xyes; then
d44 1
a44 1
@@@@ -1570,7 +1564,7 @@@@ CheckDLOPEN()
d51 3
a53 3
             AC_CHECK_LIB(dl, dlopen, SYSTEM_LIBS="$SYSTEM_LIBS -ldl", AC_CHECK_LIB(ltdl, dlopen, SYSTEM_LIBS="$SYSTEM_LIBS -lltdl"))
         fi
@@@@ -2549,6 +2543,9 @@@@ fi
d63 1
a63 1
@@@@ -2571,7 +2568,7 @@@@ esac
@


1.21
log
@Update to SDL-1.2.6; mostly from espie, much testing by jolan, thanks!
@
text
@d1 1
a1 1
$OpenBSD: patch-configure_in,v 1.20 2003/04/18 02:37:06 pvalchev Exp $
d3 1
a3 1
+++ configure.in	2003-09-21 14:43:28.000000000 +0200
d14 40
a53 1
@@@@ -2549,6 +2546,9 @@@@ fi
d63 1
a63 1
@@@@ -2571,7 +2571,7 @@@@ esac
@


1.20
log
@nasm -f elf; pt. out by naddy
@
text
@d1 4
a4 4
$OpenBSD: patch-configure_in,v 1.19 2002/11/30 11:17:26 wcobb Exp $
--- configure.in.orig	Sun Oct  6 14:34:53 2002
+++ configure.in	Thu Apr 17 20:27:23 2003
@@@@ -484,9 +484,6 @@@@ CheckNASM()
d14 1
a14 1
@@@@ -2484,6 +2481,9 @@@@ fi
d24 1
a24 1
@@@@ -2503,7 +2503,7 @@@@ esac
@


1.19
log
@Update to SDL-1.2.5.
- sdl-config no longer provides -I${LOCALBASE}/include.
- add an `aa' flavor (ASCII art display).
- GNU make is not needed.
- don't use nasm with gcc 3.
- don't install a SEGV handler.
- prevent the joystick driver from picking up usb keyboards.
ok pvalchev@@
@
text
@d1 14
a14 4
$OpenBSD$
--- configure.in.orig	Fri Nov  1 21:54:26 2002
+++ configure.in	Fri Nov  1 22:04:03 2002
@@@@ -2484,6 +2484,9 @@@@ fi
d24 1
a24 1
@@@@ -2503,7 +2506,7 @@@@ esac
@


1.18
log
@fix two bogus tests. ok pvalchev@@.
@
text
@d1 4
a4 26
$OpenBSD: patch-configure_in,v 1.17 2002/05/06 04:26:08 pvalchev Exp $
--- configure.in.orig	Sat Apr 13 20:57:24 2002
+++ configure.in	Sun May 26 01:07:30 2002
@@@@ -468,7 +468,12 @@@@ CheckNASM()
                   NASMFLAGS="-f elf"
                   ;;
             esac
-            AC_SUBST(NASMFLAGS)
+	    case "$target" in
+		    *-*-openbsd*)
+		      NASMFLAGS="-f aoutb"
+		      ;;
+	    esac
+	    	AC_SUBST(NASMFLAGS)
             CFLAGS="$CFLAGS -I\$(top_srcdir)/src/hermes"
             SDL_EXTRADIRS="$SDL_EXTRADIRS hermes"
             SDL_EXTRALIBS="$SDL_EXTRALIBS hermes/libhermes.la"
@@@@ -1681,6 +1686,7 @@@@ case "$target" in
         if test x$enable_joystick = xyes; then
             JOYSTICK_SUBDIRS="$JOYSTICK_SUBDIRS bsd"
             JOYSTICK_DRIVERS="$JOYSTICK_DRIVERS bsd/libjoystick_bsd.la"
+	    SYSTEM_LIBS="$SYSTEM_LIBS -lusbhid"
         fi
         # Set up files for the cdrom library
         if test x$enable_cdrom = xyes; then
@@@@ -2355,7 +2361,10 @@@@ fi
a7 1
-if test $ARCH = openbsd -o $ARCH = bsdi; then
d11 4
a14 5
+if test $ARCH = bsdi; then
     SHARED_SYSTEM_LIBS="$SYSTEM_LIBS"
 else
     SHARED_SYSTEM_LIBS=""
@@@@ -2363,7 +2372,7 @@@@ fi
@


1.17
log
@Add -L${X11BASE}/lib to sdl-config in when X11 is used, as SDL depends on
libraries there and needs to know the path.  this means sdl-config was
broken for a few days but none of the ports depended on this.
Also bump package revision to p1 for the last couple of fixes to the port.
@
text
@d1 3
a3 3
$OpenBSD: patch-configure_in,v 1.16 2002/05/03 19:27:17 pvalchev Exp $
--- configure.in.orig	Sat Apr 13 17:57:24 2002
+++ configure.in	Sun May  5 22:14:47 2002
d31 1
a31 1
+if test $ARCH = openbsd -o x$enable_x11 = xtrue; then
d38 9
@


1.16
log
@Fix bogus sdl-config creation, this fixes some lib depends issues when
non-default flavors are used.
@
text
@d1 1
a1 1
$OpenBSD: patch-configure_in,v 1.15 2002/04/21 00:20:08 pvalchev Exp $
d3 1
a3 1
+++ configure.in	Fri May  3 13:11:35 2002
d26 1
a26 1
@@@@ -2355,7 +2361,7 @@@@ fi
d31 3
@


1.15
log
@Update to SDL-1.2.4
@
text
@d1 1
a1 1
$OpenBSD$
d3 1
a3 1
+++ configure.in	Sat Apr 20 01:19:21 2002
d26 9
@


1.14
log
@USB uhid(4) joystick support for SDL by Wilbern Cobb <vedge@@csoft.org>
@
text
@d1 4
a4 3
--- configure.in.orig	Thu Nov  8 03:28:00 2001
+++ configure.in	Wed Jan 23 07:03:39 2002
@@@@ -432,7 +432,13 @@@@
d9 4
a12 4
+            case "$target" in
+  	      *-*-openbsd*)
+	          NASMFLAGS="-f aoutb"
+		  ;;
d14 1
a14 2
+       	    AC_SUBST(NASMFLAGS)
+	    
d18 1
a18 18
@@@@ -1530,22 +1536,15 @@@@
         CheckPTHREAD
         # Set up files for the main() stub
         COPY_ARCH_SRC(src/main, linux, SDL_main.c)
-        # Set up files for the audio library
-        # We use the OSS and native API's, not the Sun audio API
-        #if test x$enable_audio = xyes; then
-        #    CFLAGS="$CFLAGS -DSUNAUDIO_SUPPORT"
-        #    AUDIO_SUBDIRS="$AUDIO_SUBDIRS sun"
-        #    AUDIO_DRIVERS="$AUDIO_DRIVERS sun/libaudio_sun.la"
-        #fi
-        # OpenBSD needs linking with ossaudio emulation library
         if test x$have_oss = xyes; then
+            # OpenBSD needs linking with ossaudio emulation library
             SYSTEM_LIBS="$SYSTEM_LIBS -lossaudio"
         fi
         # Set up files for the joystick library
-        # (No joystick support yet)
d20 2
a21 4
-            JOYSTICK_SUBDIRS="$JOYSTICK_SUBDIRS dummy"
-            JOYSTICK_DRIVERS="$JOYSTICK_DRIVERS dummy/libjoystick_dummy.la"
+            JOYSTICK_SUBDIRS="$JOYSTICK_SUBDIRS bsd"
+            JOYSTICK_DRIVERS="$JOYSTICK_DRIVERS bsd/libjoystick_bsd.la"
a25 21
@@@@ -2160,7 +2159,11 @@@@
 fi
 
 if test $ARCH = openbsd; then
-  SDL_RLD_FLAGS="-Wl,-rpath,\${exec_prefix}/lib $SYSTEM_LIBS"
+	if test x$have_x = xyes; then
+		SDL_RLD_FLAGS="-Wl,-rpath,\${exec_prefix}/lib -Wl,-rpath,${X11BASE}/lib $SYSTEM_LIBS"
+	else
+		SDL_RLD_FLAGS="-Wl,-rpath,\${exec_prefix}/lib $SYSTEM_LIBS"
+	fi
 fi
 
 dnl Output the video drivers we use
@@@@ -2277,6 +2280,7 @@@@
 src/joystick/Makefile
 src/joystick/amigaos/Makefile
 src/joystick/beos/Makefile
+src/joystick/bsd/Makefile
 src/joystick/darwin/Makefile
 src/joystick/dummy/Makefile
 src/joystick/linux/Makefile
@


1.13
log
@Update to SDL-1.2.3.  thanks mark for the feedback
@
text
@d1 45
a45 4
$OpenBSD$
--- configure.in.orig	Thu Nov  8 00:28:00 2001
+++ configure.in	Thu Dec 27 01:26:30 2001
@@@@ -2160,7 +2160,11 @@@@ if test $ARCH = solaris; then
d58 8
@


1.12
log
@Pass libSDL_la_LDFLAGS containing -version-info for libtool via MAKE_FLAGS
instead of patching configure unnecessarily.
@
text
@d1 4
a4 13
$OpenBSD: patch-configure_in,v 1.11 2001/07/25 07:58:32 pvalchev Exp $
--- configure.in.orig	Mon Jul 23 13:54:03 2001
+++ configure.in	Tue Jul 24 23:05:55 2001
@@@@ -1450,8 +1450,6 @@@@ case "$target" in
         if test x$enable_timers = xyes; then
             COPY_ARCH_SRC(src/timer, linux, SDL_systimer.c)
         fi
-        # OpenBSD does not define "unix"
-        CFLAGS="$CFLAGS -Dunix"
         ;;
     *-*-sysv5*)
         ARCH=sysv5
@@@@ -2024,7 +2022,11 @@@@ if test $ARCH = solaris; then
d10 1
a10 1
+	    SDL_RLD_FLAGS="-Wl,-rpath,\${exec_prefix}/lib -Wl,-rpath,${X11BASE}/lib $SYSTEM_LIBS"
d12 1
a12 1
+	    SDL_RLD_FLAGS="-Wl,-rpath,\${exec_prefix}/lib $SYSTEM_LIBS"
@


1.11
log
@Update to SDL-1.2.2
Includes OpenBSD fixes and cleanups.
Other changes that concern us:
* Now gets correct keyboard state when starting up on X11
* Improved X11 fullscreen support, works better with KDE
@
text
@d1 1
a1 1
$OpenBSD$
a3 15
@@@@ -13,10 +13,10 @@@@ dnl Set various version strings - taken 
 # set SDL_BINARY_AGE and SDL_INTERFACE_AGE to 0.
 #
 SDL_MAJOR_VERSION=1
-SDL_MINOR_VERSION=2
-SDL_MICRO_VERSION=2
-SDL_INTERFACE_AGE=2
-SDL_BINARY_AGE=2
+SDL_MINOR_VERSION=3
+SDL_MICRO_VERSION=3
+SDL_INTERFACE_AGE=3
+SDL_BINARY_AGE=3
 SDL_VERSION=$SDL_MAJOR_VERSION.$SDL_MINOR_VERSION.$SDL_MICRO_VERSION
 
 AC_SUBST(SDL_MAJOR_VERSION)
@


1.10
log
@When native audio is enabled, define OPENBSD_SUPPORT.  This is simpler,
and makes it easier to know when to initialize the corresponding
structures, never touching them if they're empty.
Fits with SDL code-style, fixes things such as soundless builds.
@
text
@d1 5
a5 4
$OpenBSD: patch-configure_in,v 1.9 2001/07/11 16:45:45 pvalchev Exp $
--- configure.in.orig	Mon Jun 18 09:21:38 2001
+++ configure.in	Thu Jul 19 20:38:01 2001
@@@@ -14,9 +14,9 @@@@ dnl Set various version strings - taken 
d8 8
a15 7
 SDL_MINOR_VERSION=2
-SDL_MICRO_VERSION=1
-SDL_INTERFACE_AGE=1
-SDL_BINARY_AGE=1
+SDL_MICRO_VERSION=2
+SDL_INTERFACE_AGE=2
+SDL_BINARY_AGE=2
d19 1
a19 21
@@@@ -246,7 +246,11 @@@@ CheckOSS()
         AC_MSG_CHECKING(for OSS audio support)
         have_oss=no
         AC_TRY_COMPILE([
+          #ifdef __OpenBSD__
+          #include <soundcard.h>
+          #else
           #include <sys/soundcard.h>
+          #endif
         ],[
           int arg = SNDCTL_DSP_SETFRAGMENT;
         ],[
@@@@ -289,6 +293,7 @@@@ CheckOPENBSDAUDIO()
 [  --enable-openbsdaudio   OpenBSD native audio support [default=no]],
                   , enable_openbsdaudio=no)
     if test x$enable_audio = xyes -a x$enable_openbsdaudio = xyes; then
+	CFLAGS="$CFLAGS -DOPENBSD_SUPPORT"
         SYSTEM_LIBS="$SYSTEM_LIBS $ESD_LIBS"
         AUDIO_SUBDIRS="$AUDIO_SUBDIRS openbsd"
         AUDIO_DRIVERS="$AUDIO_DRIVERS openbsd/libaudio_openbsd.la"
@@@@ -1385,8 +1390,10 @@@@ case "$target" in
a24 4
+	# OpenBSD needs linking with ossaudio emulation library
+	if test x$enable_oss = xyes; then
+	    LIBS="$LIBS -lossaudio"
+	fi
d28 1
a28 1
@@@@ -1959,7 +1966,7 @@@@ if test $ARCH = solaris; then
d32 6
a37 2
-  SDL_RLD_FLAGS="-L${X11BASE}/lib -Wl,-rpath,\${exec_prefix}/lib -Wl,-rpath,${X11BASE}/lib"
+  SDL_RLD_FLAGS="-Wl,-rpath,${X11BASE}/lib"
@


1.9
log
@Enable dummy joystick driver building.  This offers empty joystick
function stubs.
Bump package version revision and crank library minor number.
@
text
@d1 1
a1 1
$OpenBSD: patch-configure_in,v 1.8 2001/07/03 01:00:14 pvalchev Exp $
d3 1
a3 1
+++ configure.in	Wed Jul 11 10:08:01 2001
d29 9
a37 1
@@@@ -1385,8 +1389,10 @@@@ case "$target" in
d50 1
a50 1
@@@@ -1959,7 +1965,7 @@@@ if test $ARCH = solaris; then
@


1.8
log
@simplify and remove unneeded stuff
@
text
@d1 1
a1 1
$OpenBSD: patch-configure_in,v 1.7 2001/06/23 23:35:10 pvalchev Exp $
d3 14
a16 1
+++ configure.in	Mon Jul  2 18:47:27 2001
@


1.7
log
@pass -Wl,rpath,${X11BASE} as well as -L{$X11BASE} in sdl-config
@
text
@d1 1
a1 1
$OpenBSD: patch-configure_in,v 1.6 2001/06/23 19:05:36 pvalchev Exp $
d3 1
a3 1
+++ configure.in	Sat Jun 23 17:27:55 2001
d16 1
a16 1
@@@@ -1385,8 +1389,14 @@@@ case "$target" in
d20 1
a20 2
+	if test x$enable_openbsdaudio = xyes; then
         # OpenBSD does not define "unix"
a21 2
+	    CFLAGS="$CFLAGS -Dunix"
+	fi
d29 1
a29 1
@@@@ -1959,7 +1969,7 @@@@ if test $ARCH = solaris; then
@


1.6
log
@Upgrade to SDL-1.2.1
Various improvements, including OpenBSD native audio.

* Fix audio device path.  This has caused audio not to work without the
esd flavor before, many people (including me) had link to /dev/dsp because
of linux emulation programs and haven't noticed the problem.
* Fix OSS audio.
* Sync libtool patches
* Properly include @@SYSTEM_LIBS@@ in sdl-config to ensure proper linking
of SDL applications.
@
text
@d1 1
a1 1
$OpenBSD$
d3 1
a3 1
+++ configure.in	Fri Jun 22 15:57:39 2001
d32 1
a32 2
@@@@ -1958,9 +1968,9 @@@@ if test $ARCH = solaris; then
   SDL_RLD_FLAGS="-R\${exec_prefix}/lib"
d35 1
a35 1
-if test $ARCH = openbsd; then
d37 2
a38 4
-fi
+#if test $ARCH = openbsd; then
+#  SDL_RLD_FLAGS="-L${X11BASE}/lib -Wl,-rpath,\${exec_prefix}/lib -Wl,-rpath,${X11BASE}/lib"
+#fi
a40 1
 if test x$enable_video = xtrue; then
@


1.5
log
@- Implement a native audio driver by <vedge2@@vedge.com.ar> as a "sun"
flavor, being the default one (fetching distfile from an external site).
- Isolate esd as a separate flavor from oss -- a combination with either
"sun" or "oss" is possible.
@
text
@d1 32
a32 53
$OpenBSD: patch-configure_in,v 1.4 2001/05/16 23:55:36 pvalchev Exp $
--- configure.in.orig	Mon Mar 26 20:39:19 2001
+++ configure.in	Sat May 19 12:01:23 2001
@@@@ -289,6 +289,20 @@@@ CheckALSA()
     fi
 }
 
+dnl Find the OpenBSD native audio includes and libraries
+CheckOPENBSDAUDIO()
+{
+    AC_ARG_ENABLE(openbsdaudio,
+[  --enable-openbsdaudio   OpenBSD native audio support [default=no]],
+                  , enable_openbsdaudio=no)
+    if test x$enable_audio = xyes -a x$enable_openbsdaudio = xyes; then
+            CFLAGS="$CFLAGS -Dunix"
+            SYSTEM_LIBS="$SYSTEM_LIBS $ESD_LIBS"
+            AUDIO_SUBDIRS="$AUDIO_SUBDIRS obsd"
+            AUDIO_DRIVERS="$AUDIO_DRIVERS obsd/libaudio_obsd.la"
+    fi
+}
+
 dnl Find the ESD includes and libraries
 CheckESD()
 {
@@@@ -1199,7 +1213,11 @@@@ case "$target" in
             COPY_ARCH_SRC(src/thread, linux, SDL_systhread_c.h)
             COPY_ARCH_SRC(src/thread, linux, SDL_sysmutex.c)
             COPY_ARCH_SRC(src/thread, linux, SDL_sysmutex_c.h)
-            COPY_ARCH_SRC(src/thread, linux, SDL_syssem.c)
+	    if test x$use_pthreads = xyes -a x$enable_pthread_sem != xyes; then
+		COPY_ARCH_SRC(src/thread, generic, SDL_syssem.c)
+	    else
+		COPY_ARCH_SRC(src/thread, linux, SDL_syssem.c)
+	    fi
             COPY_ARCH_SRC(src/thread, generic, SDL_syssem_c.h)
             COPY_ARCH_SRC(src/thread, linux, SDL_syscond.c)
             COPY_ARCH_SRC(src/thread, generic, SDL_syscond_c.h)
@@@@ -1222,13 +1240,9 @@@@ case "$target" in
         CheckAAlib
         CheckOpenGL
         CheckPTHREAD
+	CheckOPENBSDAUDIO
         # Set up files for the main() stub
         COPY_ARCH_SRC(src/main, linux, SDL_main.c)
-        # Set up files for the audio library
-        if test x$enable_audio = xyes; then
-            AUDIO_SUBDIRS="$AUDIO_SUBDIRS sun"
-            AUDIO_DRIVERS="$AUDIO_DRIVERS sun/libaudio_sun.la"
-        fi
         # Set up files for the joystick library
         # (No joystick support yet)
         if test x$enable_joystick = xyes; then
@@@@ -1790,6 +1804,10 @@@@ if test $ARCH = solaris; then
d36 7
a42 4
+if test $ARCH = openbsd; then
+  SDL_RLD_FLAGS="-L${X11BASE}/lib -Wl,-rpath,\${exec_prefix}/lib -Wl,-rpath,${X11BASE}/lib"
+fi
+
a44 9
     if test "$VIDEO_SUBDIRS" = ""; then
@@@@ -1852,6 +1870,7 @@@@ src/audio/esd/Makefile
 src/audio/macrom/Makefile
 src/audio/nas/Makefile
 src/audio/nto/Makefile
+src/audio/obsd/Makefile
 src/audio/paudio/Makefile
 src/audio/sun/Makefile
 src/audio/ums/Makefile
@


1.4
log
@Add -L${X11BASE} to sdl-config, as it is usually required.
Noticed by naddy@@
@
text
@d1 1
a1 1
$OpenBSD: patch-configure_in,v 1.3 2001/05/12 04:27:06 pvalchev Exp $
d3 23
a25 2
+++ configure.in	Wed May 16 17:45:33 2001
@@@@ -1199,7 +1199,11 @@@@ case "$target" in
d38 18
a55 1
@@@@ -1788,6 +1792,10 @@@@ fi
d57 2
a58 2
 if test $ARCH = solaris; then
   SDL_RLD_FLAGS="-R\${exec_prefix}/lib"
a60 4
+if test $ARCH = openbsd; then
+  SDL_RLD_FLAGS="-L${X11BASE}/lib -Wl,-rpath,\${exec_prefix}/lib -Wl,-rpath,${X11BASE}/lib"
 fi
 
d62 10
@


1.3
log
@Pass and handle X11BASE correctly throughout configure and put it
sdl-config.
Noticed by: vedge2@@vedge.com.ar
@
text
@d1 1
a1 1
$OpenBSD: patch-configure_in,v 1.2 2001/04/21 15:37:57 brad Exp $
d3 1
a3 1
+++ configure.in	Fri May 11 22:12:16 2001
d24 1
a24 1
+  SDL_RLD_FLAGS="-Wl,-rpath,\${exec_prefix}/lib -Wl,-rpath,${X11BASE}/lib"
@


1.2
log
@- shorten patches for configure/configure.in by not unnecessarily changing
pthreads flags for other OS's that have nothing todo with compilation on
OpenBSD.
- change linker flag from "-Wl,-R" to "-Wl,-rpath," so that this will
possibly even get through a compile on our ELF archs (tested on sparc, not
tested on an ELF arch but this is definately a first step in the right
direction).
--
Ok'd by: maintainer
@
text
@d1 3
a3 3
$OpenBSD: patch-configure_in,v 1.1.1.1 2001/04/19 18:55:40 obecian Exp $
--- configure.in.orig	Mon Mar 26 22:39:19 2001
+++ configure.in	Fri Apr 20 21:18:32 2001
d24 1
a24 1
+  SDL_RLD_FLAGS="-Wl,-rpath,\${exec_prefix}/lib -Wl,-rpath,\${X11BASE}/lib"
@


1.1
log
@Initial revision
@
text
@d1 3
a3 35
$OpenBSD: $
--- configure.in.orig	Mon Mar 26 20:39:19 2001
+++ configure.in	Sun Apr  1 19:16:25 2001
@@@@ -786,7 +786,7 @@@@ CheckPTHREAD()
             ;;
         *-*-solaris*)
             pthread_cflags="-D_REENTRANT"
-            pthread_lib="-lpthread -lposix4"
+            pthread_lib="-pthread -lposix4"
             ;;
         *-*-sysv5*)
             pthread_cflags="-D_REENTRANT -Kthread"
@@@@ -794,11 +794,11 @@@@ CheckPTHREAD()
             ;;
         *-*-irix*)
             pthread_cflags="-D_SGI_MP_SOURCE"
-            pthread_lib="-lpthread"
+            pthread_lib="-pthread"
             ;;
         *-*-aix*)
             pthread_cflags="-D_REENTRANT -mthreads"
-            pthread_lib="-lpthread"
+            pthread_lib="-pthread"
             ;;
         *-*-qnx*)
             pthread_cflags=""
@@@@ -806,7 +806,7 @@@@ CheckPTHREAD()
             ;;
         *)
             pthread_cflags="-D_REENTRANT"
-            pthread_lib="-lpthread"
+            pthread_lib="-pthread"
             ;;
     esac
     LIBS="$LIBS $pthread_lib"
d24 1
a24 1
+  SDL_RLD_FLAGS="-Wl,-R\${exec_prefix}/lib -Wl,-R\${X11BASE}/lib"
@


1.1.1.1
log
@sdl-1.2.0 - Simple DirectMedia Layer
@
text
@@
