head	1.2;
access;
symbols
	OPENBSD_3_2:1.1.0.2
	OPENBSD_3_2_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2002.10.11.12.27.00;	author todd;	state dead;
branches;
next	1.1;

1.1
date	2002.08.28.22.23.29;	author todd;	state Exp;
branches;
next	;


desc
@@


1.2
log
@update to alpha17 (finally some activity!)
@
text
@$OpenBSD: patch-base_src_common_xfopen_c,v 1.1 2002/08/28 22:23:29 todd Exp $
--- base/src/common/xfopen.c.orig	Wed Jul 17 12:10:40 2002
+++ base/src/common/xfopen.c	Wed Aug 28 14:26:40 2002
@@@@ -73,6 +73,11 @@@@ xfopen(const char *path, const char mode
 void
 xfclose(FILE *f)
 {
+  int retval; 
   if (f != NULL)
-    fclose(f);
+  {
+    retval = fclose(f);
+    if(retval) /* shame we can't get the filename here... */
+      THROW(ExTruncated, format("Closing file failed, error %d\n", retval));
+  }
 }
@


1.1
log
@64bit stuff breaks in bad ways. more testing needed
@
text
@d1 1
a1 1
$OpenBSD$
@

