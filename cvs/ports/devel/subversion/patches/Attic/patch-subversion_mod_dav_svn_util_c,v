head	1.1;
access;
symbols
	OPENBSD_5_8:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2015.12.16.10.23.18;	author stsp;	state dead;
branches
	1.1.2.1;
next	;
commitid	vCJ4Pgh71XDZncZJ;

1.1.2.1
date	2015.12.16.10.23.18;	author stsp;	state Exp;
branches;
next	;
commitid	vCJ4Pgh71XDZncZJ;


desc
@@


1.1
log
@file patch-subversion_mod_dav_svn_util_c was initially added on branch OPENBSD_5_8.
@
text
@@


1.1.2.1
log
@Patch CVE-2015-5343 in Apache Subversion for 5.8-stable.
@
text
@a0 18
$OpenBSD$
CVE-2015-5343
--- subversion/mod_dav_svn/util.c.orig	Fri Jun 12 06:00:24 2015
+++ subversion/mod_dav_svn/util.c	Wed Dec 16 10:01:10 2015
@@@@ -778,7 +778,12 @@@@ request_body_to_string(svn_string_t **request_str,
 
   if (content_length)
     {
-      buf = svn_stringbuf_create_ensure(content_length, pool);
+      /* Do not allocate more than 1 MB until we receive request body. */
+      apr_size_t alloc_len = 1 * 1024 *1024;
+      if (content_length < alloc_len)
+        alloc_len = (apr_size_t) content_length;
+
+      buf = svn_stringbuf_create_ensure(alloc_len, pool);
     }
   else
     {
@

