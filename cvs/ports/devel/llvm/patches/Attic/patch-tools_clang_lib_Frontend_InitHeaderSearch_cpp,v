head	1.5;
access;
symbols
	OPENBSD_4_8:1.2.0.2
	OPENBSD_4_8_BASE:1.2;
locks; strict;
comment	@# @;


1.5
date	2012.12.23.20.49.29;	author brad;	state dead;
branches;
next	1.4;

1.4
date	2012.08.06.22.35.26;	author sthen;	state Exp;
branches;
next	1.3;

1.3
date	2011.01.13.00.15.50;	author jeremy;	state dead;
branches;
next	1.2;

1.2
date	2010.06.12.12.15.08;	author sthen;	state Exp;
branches;
next	1.1;

1.1
date	2010.04.29.16.37.09;	author jsg;	state Exp;
branches;
next	;


desc
@@


1.5
log
@Update to LLVM 3.2 and switces to __guard_local for stack protector support.

Initial work from landry@@ with some fixes and further tweaking from pascal@@ and brad@@

ok sthen@@ landry@@
@
text
@$OpenBSD: patch-tools_clang_lib_Frontend_InitHeaderSearch_cpp,v 1.4 2012/08/06 22:35:26 sthen Exp $

Only provide /usr/include in the default C header search path.

--- tools/clang/lib/Frontend/InitHeaderSearch.cpp.orig	Wed Aug  1 23:49:24 2012
+++ tools/clang/lib/Frontend/InitHeaderSearch.cpp	Wed Aug  1 23:49:57 2012
@@@@ -210,6 +210,7 @@@@ void InitHeaderSearch::AddDefaultCIncludePaths(const l
     switch (os) {
     case llvm::Triple::FreeBSD:
     case llvm::Triple::NetBSD:
+    case llvm::Triple::OpenBSD:
       break;
     default:
       // FIXME: temporary hack: hard-coded paths.
@


1.4
log
@Add several CLang patches from upstream via Brad.

- Only provide /usr/include in the default C header search path.
- OpenBSD does not support TLS.
- Provide target support for powerpc, arm, mips64, mips64el and sparc.
@
text
@d1 1
a1 1
$OpenBSD$
@


1.3
log
@Bump llvm version to 2.8.

OK @@sthen
@
text
@d1 14
a14 19
$OpenBSD: patch-tools_clang_lib_Frontend_InitHeaderSearch_cpp,v 1.2 2010/06/12 12:15:08 sthen Exp $
--- tools/clang/lib/Frontend/InitHeaderSearch.cpp.orig	Sat Mar  6 20:38:10 2010
+++ tools/clang/lib/Frontend/InitHeaderSearch.cpp	Wed Apr 28 21:11:32 2010
@@@@ -581,6 +581,15 @@@@ void InitHeaderSearch::AddDefaultCPlusPlusIncludePaths
   case llvm::Triple::FreeBSD:
     AddGnuCPlusPlusIncludePaths("/usr/include/c++/4.2", "", "", "", triple);
     break;
+  case llvm::Triple::OpenBSD:
+    {
+      std::string t = triple.getTriple();
+      if (t.substr(0, 6) == "x86_64")
+        t.replace(0, 6, "amd64");
+      AddGnuCPlusPlusIncludePaths("/usr/include/g++",
+          t, "", "", triple);
+    }
+    break;
   case llvm::Triple::Solaris:
     // Solaris - Fall though..
   case llvm::Triple::AuroraUX:
@


1.2
log
@Adjust LLVM/CLang to work with GCC4 in base, while still working
with ports GCC4 for arch which haven't switched yet.

With/ok jsg@@.
@
text
@d1 1
a1 1
$OpenBSD: patch-tools_clang_lib_Frontend_InitHeaderSearch_cpp,v 1.1 2010/04/29 16:37:09 jsg Exp $
@


1.1
log
@Update to LLVM/Clang 2.7
ok sthen@@
@
text
@d1 1
a1 1
$OpenBSD$
d4 1
a4 1
@@@@ -581,6 +581,16 @@@@ void InitHeaderSearch::AddDefaultCPlusPlusIncludePaths
d13 1
a13 2
+      // 4.7 gcc 4.2.4 from ports
+      AddGnuCPlusPlusIncludePaths("/usr/local/include/c++/4.2.4",
@

