head	1.2;
access;
symbols
	OPENBSD_6_0:1.1.1.1.0.16
	OPENBSD_6_0_BASE:1.1.1.1
	OPENBSD_5_9:1.1.1.1.0.12
	OPENBSD_5_9_BASE:1.1.1.1
	OPENBSD_5_8:1.1.1.1.0.14
	OPENBSD_5_8_BASE:1.1.1.1
	OPENBSD_5_7:1.1.1.1.0.10
	OPENBSD_5_7_BASE:1.1.1.1
	OPENBSD_5_6:1.1.1.1.0.8
	OPENBSD_5_6_BASE:1.1.1.1
	OPENBSD_5_5:1.1.1.1.0.6
	OPENBSD_5_5_BASE:1.1.1.1
	OPENBSD_5_4:1.1.1.1.0.4
	OPENBSD_5_4_BASE:1.1.1.1
	OPENBSD_5_3:1.1.1.1.0.2
	OPENBSD_5_3_BASE:1.1.1.1
	ports:1.1.1.1
	espie:1.1.1;
locks; strict;
comment	@# @;


1.2
date	2017.02.28.21.46.51;	author naddy;	state dead;
branches;
next	1.1;
commitid	cJORfq6YF1l3Ccmw;

1.1
date	2012.09.02.14.14.02;	author espie;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2012.09.02.14.14.02;	author espie;	state Exp;
branches;
next	;


desc
@@


1.2
log
@* Switch to tradcpp(1) as the preprocessor.
This is required for clang archs, since imake chokes on the output
of "clang -E -traditional", and doesn't hurt on gcc archs.

* Use the normal autotools build infrastructure instead of rolling our own.
@
text
@# $OpenBSD: Makefile,v 1.1 2012/09/02 14:14:02 espie Exp $

CFLAGS += -DCPP_PROGRAM=\"${CPP_PROGRAM}\"
CFLAGS += -I${X11BASE}/include

PROGS = imake revpath

SCRIPTS = xmkmf ccmakedep mergelib mkhtmlindex mkdirhier cleanlinks makeg
MANS = ccmakedep.1 imake.1 mergelib.1 mkhtmlindex.1 xmkmf.1 cleanlinks.1 \
	makeg.1 mkdirhier.1 revpath.1

all: ${PROGS} ${SCRIPTS} ${MANS}

install:
.for p in ${PROGS}
	${INSTALL_PROGRAM} $p ${PREFIX}/bin
.endfor
.for s in ${SCRIPTS}
	${INSTALL_SCRIPT} $s ${PREFIX}/bin
.endfor
.for m in ${MANS}
	${INSTALL_MAN} $m ${PREFIX}/man/man1
.endfor

SUBSTS += -e 's|__xorgversion__|"imake 1.0.5" "X Version 11"|'
SUBSTS += -e 's|__vendorversion__|"imake 1.0.5" "X Version 11"|'
SUBSTS += -e 's|__cpp__|${CPP_PROGRAM}|'

CPPSUBSTS += -DCONFIGDIRSPEC='"-I$(XCONFDIR)"' 
CPPSUBSTS += -DCCPP='gcc -E'
CPPSUBSTS += -DARCMD='ar clq'
CPPSUBSTS += -DRANLIB=ranlib
imake: imake.o
	${CC} -o $@@ ${CFLAGS} imake.o

revpath: revpath.o
	${CC} -o $@@ ${CFLAGS} revpath.o

ccmakedep.cpp: mdepend.cpp
	ln -f mdepend.cpp $@@

mkhtmlindex: mkhtmlindex.pl
	ln -f mkhtmlindex.pl $@@

.SUFFIXES: .cpp .man .1

.cpp:
	${CPP_PROGRAM} ${CPPSUBSTS} < $*.cpp | \
	    sed -e /^\#/d | sed -e s/XCOMM/\#/ >$@@

.man.1:
	sed ${SUBSTS} <$*.man >$*.1

.PHONY: all
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
@


1.1.1.1
log
@matthieu wants to scrape imake off xenocara
initial port, to be worked in-tree
(no need for autoconf to discover we have mkstemp...)
@
text
@@
