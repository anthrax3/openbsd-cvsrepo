head	1.3;
access;
symbols
	OPENBSD_4_5:1.2.0.10
	OPENBSD_4_5_BASE:1.2
	OPENBSD_4_4:1.2.0.6
	OPENBSD_4_4_BASE:1.2
	OPENBSD_4_3:1.2.0.4
	OPENBSD_4_3_BASE:1.2
	OPENBSD_4_2:1.2.0.2
	OPENBSD_4_2_BASE:1.2
	OPENBSD_4_1:1.1.0.8
	OPENBSD_4_1_BASE:1.1
	OPENBSD_4_0:1.1.0.6
	OPENBSD_4_0_BASE:1.1
	OPENBSD_3_9:1.1.0.4
	OPENBSD_3_9_BASE:1.1
	OPENBSD_3_8:1.1.0.2;
locks; strict;
comment	@# @;


1.3
date	2009.03.18.01.45.38;	author kurt;	state dead;
branches;
next	1.2;

1.2
date	2007.07.18.15.09.52;	author kurt;	state Exp;
branches;
next	1.1;

1.1
date	2006.01.18.15.08.16;	author kurt;	state Exp;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2006.01.30.02.50.40;	author kurt;	state Exp;
branches;
next	;


desc
@@


1.3
log
@remove 1.3 and 1.4 as per plan made last June
@
text
@$OpenBSD: patch-hotspot_src_cpu_i486_vm_interpreterRT_i486_cpp,v 1.2 2007/07/18 15:09:52 kurt Exp $
--- hotspot/src/cpu/i486/vm/interpreterRT_i486.cpp.orig	Wed Sep 10 21:40:12 2003
+++ hotspot/src/cpu/i486/vm/interpreterRT_i486.cpp	Wed Jul 18 10:56:32 2007
@@@@ -8,6 +8,8 @@@@
 
 #include "incls/_precompiled.incl"
 #include "incls/_interpreterRT_i486.cpp.incl"
+#include <sys/types.h>
+#include <sys/mman.h>
 
 
 #define __ _masm->
@@@@ -83,6 +85,7 @@@@ class SignatureHandlerLibrary: public AllStatic {
           InterpreterRuntime::SignatureHandlerGenerator(method, buffer).generate(fingerprint);
           // copy into C-heap allocated memory location
           address handler = (address)NEW_C_HEAP_ARRAY(u_char, buffer->code_size());
+          mprotect(handler, buffer->code_size(), PROT_READ|PROT_WRITE|PROT_EXEC);
           memcpy(handler, buffer->code_begin(), buffer->code_size());
           // debugging suppport
           if (PrintSignatureHandlers) {
@


1.2
log
@regen patches
@
text
@d1 1
a1 1
$OpenBSD: patch-hotspot_src_cpu_i486_vm_interpreterRT_i486_cpp,v 1.1 2006/01/18 15:08:16 kurt Exp $
@


1.1
log
@- recent w^x changes combined with random malloc/mmap exposed a previously
undiscovered bug in the SignatureHandlerLibrary. Code generated at runtime
was put into malloc()'ed memory and later attempted to execute it without
first making it executable with mprotect(). Debugging suggestions and help
from tom@@, weingart@@, marc@@, millert@@. Thx!
- make sure linux emulation is on for the build phase. needed if you reboot
after extracting.

okay tom@@
@
text
@d1 1
a1 1
$OpenBSD$
d3 1
a3 1
+++ hotspot/src/cpu/i486/vm/interpreterRT_i486.cpp	Wed Jan 18 09:26:07 2006
d13 1
a13 1
@@@@ -83,6 +85,7 @@@@ class SignatureHandlerLibrary: public Al
@


1.1.2.1
log
@- recent w^x changes combined with random malloc/mmap exposed a
previously undiscovered bug in the SignatureHandlerLibrary. Code
generated at runtime was put into malloc()'ed memory and later
attempted to execute it without first making it executable with
mprotect(). Debugging suggestions and help from tom@@, weingart@@,
marc@@, millert@@. Thx! okay pvalchev@@ brad@@
@
text
@d1 1
a1 1
$OpenBSD: patch-hotspot_src_cpu_i486_vm_interpreterRT_i486_cpp,v 1.1 2006/01/18 15:08:16 kurt Exp $
@

