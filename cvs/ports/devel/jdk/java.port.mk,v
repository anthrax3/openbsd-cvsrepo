head	1.35;
access;
symbols
	OPENBSD_6_2:1.35.0.2
	OPENBSD_6_2_BASE:1.35
	OPENBSD_6_1:1.34.0.8
	OPENBSD_6_1_BASE:1.34
	OPENBSD_6_0:1.34.0.6
	OPENBSD_6_0_BASE:1.34
	OPENBSD_5_9:1.34.0.2
	OPENBSD_5_9_BASE:1.34
	OPENBSD_5_8:1.34.0.4
	OPENBSD_5_8_BASE:1.34
	OPENBSD_5_7:1.33.0.4
	OPENBSD_5_7_BASE:1.33
	OPENBSD_5_6:1.33.0.2
	OPENBSD_5_6_BASE:1.33
	OPENBSD_5_5:1.32.0.4
	OPENBSD_5_5_BASE:1.32
	OPENBSD_5_4:1.32.0.2
	OPENBSD_5_4_BASE:1.32
	OPENBSD_5_3:1.31.0.2
	OPENBSD_5_3_BASE:1.31
	OPENBSD_5_2:1.30.0.4
	OPENBSD_5_2_BASE:1.30
	OPENBSD_5_1_BASE:1.30
	OPENBSD_5_1:1.30.0.2
	OPENBSD_5_0:1.21.0.4
	OPENBSD_5_0_BASE:1.21
	OPENBSD_4_9:1.21.0.2
	OPENBSD_4_9_BASE:1.21
	OPENBSD_4_8:1.19.0.4
	OPENBSD_4_8_BASE:1.19
	OPENBSD_4_7:1.19.0.2
	OPENBSD_4_7_BASE:1.19
	OPENBSD_4_6:1.18.0.2
	OPENBSD_4_6_BASE:1.18
	OPENBSD_4_5:1.16.0.6
	OPENBSD_4_5_BASE:1.16
	OPENBSD_4_4:1.16.0.2
	OPENBSD_4_4_BASE:1.16
	OPENBSD_4_3:1.13.0.2
	OPENBSD_4_3_BASE:1.13
	OPENBSD_4_2:1.12.0.2
	OPENBSD_4_2_BASE:1.12
	OPENBSD_4_1:1.11.0.2
	OPENBSD_4_1_BASE:1.11
	OPENBSD_4_0:1.7.0.2
	OPENBSD_4_0_BASE:1.7
	OPENBSD_3_9:1.3.0.4
	OPENBSD_3_9_BASE:1.3
	OPENBSD_3_8:1.3.0.2
	OPENBSD_3_8_BASE:1.3;
locks; strict;
comment	@# @;


1.35
date	2017.04.21.13.27.46;	author kurt;	state Exp;
branches;
next	1.34;
commitid	lfz5IYSiUvvvq1Ub;

1.34
date	2015.06.17.17.16.04;	author kurt;	state Exp;
branches;
next	1.33;
commitid	N9w2qOQQio5JJ2HO;

1.33
date	2014.05.07.15.42.15;	author kurt;	state Exp;
branches;
next	1.32;

1.32
date	2013.07.02.10.36.35;	author espie;	state Exp;
branches;
next	1.31;

1.31
date	2013.02.03.15.03.03;	author jasper;	state Exp;
branches;
next	1.30;

1.30
date	2011.12.15.21.31.29;	author kili;	state Exp;
branches;
next	1.29;

1.29
date	2011.10.07.13.54.31;	author kurt;	state Exp;
branches;
next	1.28;

1.28
date	2011.09.30.09.10.18;	author jasper;	state Exp;
branches;
next	1.27;

1.27
date	2011.09.19.20.03.20;	author jasper;	state Exp;
branches;
next	1.26;

1.26
date	2011.09.01.17.13.51;	author jasper;	state Exp;
branches;
next	1.25;

1.25
date	2011.09.01.08.03.47;	author jasper;	state Exp;
branches;
next	1.24;

1.24
date	2011.08.31.20.33.32;	author jasper;	state Exp;
branches;
next	1.23;

1.23
date	2011.08.31.20.00.56;	author jasper;	state Exp;
branches;
next	1.22;

1.22
date	2011.08.30.17.16.10;	author jasper;	state Exp;
branches;
next	1.21;

1.21
date	2011.01.13.22.35.52;	author kurt;	state Exp;
branches;
next	1.20;

1.20
date	2010.11.15.19.45.59;	author espie;	state Exp;
branches;
next	1.19;

1.19
date	2009.11.09.11.02.58;	author sthen;	state Exp;
branches;
next	1.18;

1.18
date	2009.03.16.16.38.25;	author sthen;	state Exp;
branches;
next	1.17;

1.17
date	2009.03.11.22.04.07;	author sthen;	state Exp;
branches;
next	1.16;

1.16
date	2008.06.24.02.38.31;	author kurt;	state Exp;
branches;
next	1.15;

1.15
date	2008.05.05.02.53.15;	author kurt;	state Exp;
branches;
next	1.14;

1.14
date	2008.03.18.19.40.03;	author sturm;	state Exp;
branches;
next	1.13;

1.13
date	2008.02.14.21.48.43;	author kurt;	state Exp;
branches;
next	1.12;

1.12
date	2007.06.27.21.33.33;	author kurt;	state Exp;
branches;
next	1.11;

1.11
date	2007.01.16.02.47.14;	author kurt;	state Exp;
branches;
next	1.10;

1.10
date	2006.11.28.14.28.25;	author kurt;	state Exp;
branches;
next	1.9;

1.9
date	2006.11.20.19.28.18;	author espie;	state Exp;
branches;
next	1.8;

1.8
date	2006.11.01.20.34.24;	author kurt;	state Exp;
branches;
next	1.7;

1.7
date	2006.08.05.16.38.20;	author kurt;	state Exp;
branches;
next	1.6;

1.6
date	2006.07.28.13.06.24;	author kurt;	state Exp;
branches;
next	1.5;

1.5
date	2006.05.28.00.14.39;	author kurt;	state Exp;
branches;
next	1.4;

1.4
date	2006.03.20.14.42.37;	author kurt;	state Exp;
branches;
next	1.3;

1.3
date	2005.07.14.17.29.58;	author kurt;	state Exp;
branches;
next	1.2;

1.2
date	2005.06.17.15.37.33;	author kurt;	state Exp;
branches;
next	1.1;

1.1
date	2005.06.17.14.59.27;	author kurt;	state Exp;
branches;
next	;


desc
@@


1.35
log
@- disconnect devel/jdk/1.7 from the build
- adjust java.port.mk so all 1.7 and lower ports now build with 1.8
- bump revision on affected ports
okay sthen@@, ian@@, landry@@
@
text
@# $OpenBSD: java.port.mk,v 1.34 2015/06/17 17:16:04 kurt Exp $

# Set MODJAVA_VER to x.y or x.y+ based on the version
# of the jdk needed for the port. x.y  means any x.y jdk.
# x.y+ means any x.y jdk or higher version. Valid values
# for x.y are 1.4, 1.5, 1.6, 1.7 or 1.8

MODJAVA_VER?=

# Set MODJAVA_JRERUN=yes if the port can run with just
# the jre. This will add the jre's to the RUN_DEPENDS
# based on how MODJAVA_VER is set.

MODJAVA_JRERUN?=no

# Based on the MODJAVA_VER, MODJAVA_JRERUN, NO_BUILD
# and MACHINE_ARCH, the following things will be setup:
#   ONLY_FOR_ARCHS if not already set.
#   BUILD_DEPENDS on a jdk (only if not NO_BUILD)
#   JAVA_HOME to pass on to the port build (only if not NO_BUILD)
#   RUN_DEPENDS for all jdk's and jre's that can run
#   the port.
#   MODJAVA_RUN_DEPENDS with same value as RUN_DEPENDS
#   to assist with multipackages.
#
# NOTE: All source built java ports must properly set
# javac -source and -target build arguments. Depending
# on the architecture a 1.4 or 1.5 level port may be
# built by a 1.6 jdk. The JAVA_HOME variable points to the
# build jdk not the default RUN_DEPEND jdk, so it
# should not be used to set a default jdk to run with.
# The javaPathHelper port should be used to set the
# default JAVA_HOME or JAVACMD vars for a package.
#

.if ${MODJAVA_VER} == "1.4" || ${MODJAVA_VER} == "1.5" || ${MODJAVA_VER} == "1.6" || ${MODJAVA_VER} == "1.7"
    BROKEN=MODJAVA_VER=${MODJAVA_VER} only ports are not supported
.elif ${MODJAVA_VER} == "1.4+" || ${MODJAVA_VER} == "1.5+" || ${MODJAVA_VER} == "1.6+" || ${MODJAVA_VER} == "1.7+"
   ONLY_FOR_ARCHS?= i386 amd64
.  if ${NO_BUILD:L} != "yes"
     JAVA_HOME= ${LOCALBASE}/jdk-1.8.0
     BUILD_DEPENDS+= jdk->=1.8v0,<1.9v0:devel/jdk/1.8
.  endif
.  if ${MODJAVA_JRERUN:L} == "yes"
     MODJAVA_RUN_DEPENDS= jdk->=1.8v0|jre->=1.8v0:devel/jdk/1.8
.  else
     MODJAVA_RUN_DEPENDS= jdk->=1.8v0:devel/jdk/1.8
.  endif
.elif ${MODJAVA_VER:S/+//} == "1.8"
   ONLY_FOR_ARCHS?= i386 amd64
.  if ${NO_BUILD:L} != "yes"
     JAVA_HOME= ${LOCALBASE}/jdk-1.8.0
     BUILD_DEPENDS+= jdk->=1.8v0,<1.9v0:devel/jdk/1.8
.  endif
.  if ${MODJAVA_JRERUN:L} == "yes"
     _MODJAVA_RUNDEP= jdk->=1.8v0,<1.9v0|jre->=1.8v0,<1.9v0
.  else
     _MODJAVA_RUNDEP= jdk->=1.8v0,<1.9v0
.  endif
.  if ${MODJAVA_VER} == "1.8+"
     MODJAVA_RUN_DEPENDS= ${_MODJAVA_RUNDEP:S/,<1.9v0//g}:devel/jdk/1.8
.  else
     MODJAVA_RUN_DEPENDS= ${_MODJAVA_RUNDEP}:devel/jdk/1.8
.  endif
.else
   ERRORS+="Fatal: MODJAVA_VER must be set to a valid value."
.endif

RUN_DEPENDS+= ${MODJAVA_RUN_DEPENDS}

# Append 'java' to the list of categories.
CATEGORIES+=	java

# Allow ports to that use devel/apache-ant to set MODJAVA_BUILD=ant
# In case a non-standard build target, build file or build directory are
# needed, set MODJAVA_BUILD_TARGET_NAME, MODJAVA_BUILD_FILE or MODJAVA_BUILD_DIR
# respectively.
.if defined(MODJAVA_BUILD) && ${MODJAVA_BUILD:L} == "ant"
    BUILD_DEPENDS += devel/apache-ant
    MAKE_ENV += JAVA_HOME=${JAVA_HOME}
    MODJAVA_BUILD_TARGET_NAME ?=
    MODJAVA_BUILD_FILE ?= build.xml
    MODJAVA_BUILD_DIR ?= ${WRKSRC}
    MODJAVA_BUILD_ARGS ?=

MODJAVA_BUILD_TARGET = \
	cd ${MODJAVA_BUILD_DIR} && \
		${SETENV} ${MAKE_ENV} ${LOCALBASE}/bin/ant \
		-buildfile ${MODJAVA_BUILD_FILE} ${MODJAVA_BUILD_TARGET_NAME} \
		${MODJAVA_BUILD_ARGS}
.   if !target(do-build)
do-build:
	${MODJAVA_BUILD_TARGET}
.   endif
.endif

# Convenience variables.
# Ports that install .jar files for public use (ie, in ${MODJAVA_JAR_DIR})
# please install unversioned .jar files. If a port installs
# multiple .jar files, use a ${MODJAVA_JAR_DIR}/<project_name>/ prefix.
# This will help other ports to pickup these classes.
MODJAVA_SHARE_DIR = ${PREFIX}/share/java/
MODJAVA_JAR_DIR   = ${MODJAVA_SHARE_DIR}/classes/
MODJAVA_EXAMPLE_DIR = ${MODJAVA_SHARE_DIR}/examples/
MODJAVA_DOC_DIR   = ${MODJAVA_SHARE_DIR}/doc/

SUBST_VARS +=	MODJAVA_SHARE_DIR MODJAVA_JAR_DIR MODJAVA_EXAMPLE_DIR \
		MODJAVA_DOC_DIR
@


1.34
log
@Enable devel/jdk/1.8 and add support for it in java.port.mk. okay jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: java.port.mk,v 1.33 2014/05/07 15:42:15 kurt Exp $
d6 1
a6 1
# for x.y are 1.3, 1.4, 1.5, 1.6, 1.7 or 1.8
d28 1
a28 1
# on the architecture a 1.3, 1.4 or 1.5 level port may be
d36 1
a36 1
.if ${MODJAVA_VER} == "1.3" || ${MODJAVA_VER} == "1.4" || ${MODJAVA_VER} == "1.5" || ${MODJAVA_VER} == "1.6"
d38 1
a38 1
.elif ${MODJAVA_VER} == "1.3+" || ${MODJAVA_VER} == "1.4+" || ${MODJAVA_VER} == "1.5+" || ${MODJAVA_VER} == "1.6+"
d41 2
a42 2
     JAVA_HOME= ${LOCALBASE}/jdk-1.7.0
     BUILD_DEPENDS+= jdk->=1.7.0,<1.8v0:devel/jdk/1.7
d45 1
a45 1
     MODJAVA_RUN_DEPENDS= jdk->=1.7.0|jre->=1.7.0:devel/jdk/1.7
d47 1
a47 17
     MODJAVA_RUN_DEPENDS= jdk->=1.7.0:devel/jdk/1.7
.  endif
.elif ${MODJAVA_VER:S/+//} == "1.7"
   ONLY_FOR_ARCHS?= i386 amd64
.  if ${NO_BUILD:L} != "yes"
     JAVA_HOME= ${LOCALBASE}/jdk-1.7.0
     BUILD_DEPENDS+= jdk->=1.7.0,<1.8v0:devel/jdk/1.7
.  endif
.  if ${MODJAVA_JRERUN:L} == "yes"
     _MODJAVA_RUNDEP= jdk->=1.7.0,<1.8v0|jre->=1.7.0,<1.8v0
.  else
     _MODJAVA_RUNDEP= jdk->=1.7.0,<1.8v0
.  endif
.  if ${MODJAVA_VER} == "1.7+"
     MODJAVA_RUN_DEPENDS= ${_MODJAVA_RUNDEP:S/,<1.8v0//g}:devel/jdk/1.7
.  else
     MODJAVA_RUN_DEPENDS= ${_MODJAVA_RUNDEP}:devel/jdk/1.7
@


1.33
log
@- Unlink jdk/1.6 and make jdk/1.7 the default jdk for all java ports
- Adjust java.port.mk and cmake to use 1.7
- Adjust jdk/1.7 for pkg_add upgrades
okay sthen@@, jasper@@, ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: java.port.mk,v 1.32 2013/07/02 10:36:35 espie Exp $
d6 1
a6 1
# for x.y are 1.3, 1.4, 1.5, 1.6 or 1.7
d64 16
@


1.32
log
@rename stuff so that java.port.mk conforms to the new style of overriding
do-build.
@
text
@d1 1
a1 1
# $OpenBSD: java.port.mk,v 1.31 2013/02/03 15:03:03 jasper Exp $
d36 1
a36 1
.if ${MODJAVA_VER} == "1.3" || ${MODJAVA_VER} == "1.4" || ${MODJAVA_VER} == "1.5"
d38 1
a38 1
.elif ${MODJAVA_VER} == "1.3+" || ${MODJAVA_VER} == "1.4+" || ${MODJAVA_VER} == "1.5+"
d41 2
a42 2
     JAVA_HOME= ${LOCALBASE}/jdk-1.6.0
     BUILD_DEPENDS+= jdk->=1.6.0,<1.7:devel/jdk/1.6
d45 1
a45 1
     MODJAVA_RUN_DEPENDS= jdk->=1.6.0|jre->=1.6.0|jamvm-*:devel/jdk/1.6
d47 1
a47 17
     MODJAVA_RUN_DEPENDS= jdk->=1.6.0:devel/jdk/1.6
.  endif
.elif ${MODJAVA_VER:S/+//} == "1.6"
   ONLY_FOR_ARCHS?= i386 amd64
.  if ${NO_BUILD:L} != "yes"
     JAVA_HOME= ${LOCALBASE}/jdk-1.6.0
     BUILD_DEPENDS+= jdk->=1.6.0,<1.7:devel/jdk/1.6
.  endif
.  if ${MODJAVA_JRERUN:L} == "yes"
     _MODJAVA_RUNDEP= jdk->=1.6.0,<1.7|jre->=1.6.0,<1.7
.  else
     _MODJAVA_RUNDEP= jdk->=1.6.0,<1.7
.  endif
.  if ${MODJAVA_VER} == "1.6+"
     MODJAVA_RUN_DEPENDS= ${_MODJAVA_RUNDEP:S/,<1.7//g}:devel/jdk/1.6
.  else
     MODJAVA_RUN_DEPENDS= ${_MODJAVA_RUNDEP}:devel/jdk/1.6
@


1.31
log
@add MODJAVA_*_DIR to SUBST_VARS.

ok kurt@@
@
text
@d1 1
a1 1
# $OpenBSD: java.port.mk,v 1.30 2011/12/15 21:31:29 kili Exp $
d92 1
a92 1
# needed, set MODJAVA_BUILD_TARGET, MODJAVA_BUILD_FILE or MODJAVA_BUILD_DIR
d97 1
a97 1
    MODJAVA_BUILD_TARGET ?=
d101 2
a102 2
.   if !target(do-build)
do-build:
d105 1
a105 1
		-buildfile ${MODJAVA_BUILD_FILE} ${MODJAVA_BUILD_TARGET} \
d107 3
@


1.30
log
@For MODJAVA_BUILD=ant, pass JAVA_HOME via MAKE_ENV.

ok kurt@@, tested in a bulk build by naddy@@ (thanks!).
@
text
@d1 1
a1 1
# $OpenBSD: java.port.mk,v 1.29 2011/10/07 13:54:31 kurt Exp $
d107 1
a107 1
.   endif 
d119 3
@


1.29
log
@- remove devel/jdk/1.5 and lang/kaffe
- adjust java.port.mk for their removal
- bump affected packages
okay jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: java.port.mk,v 1.28 2011/09/30 09:10:18 jasper Exp $
d96 1
@


1.28
log
@Revert previous.

As discussed with kurt@@ and daniel dickman
@
text
@d1 1
a1 1
# $OpenBSD: java.port.mk,v 1.27 2011/09/19 20:03:20 jasper Exp $
d28 2
a29 2
# on the architecture a 1.3 or 1.4 level port may be built
# by a 1.5 jdk. The JAVA_HOME variable points to the
d36 1
a36 1
.if ${MODJAVA_VER} == "1.3" || ${MODJAVA_VER} == "1.4"
d38 1
a38 1
.elif ${MODJAVA_VER} == "1.3+" || ${MODJAVA_VER} == "1.4+"
d41 2
a42 2
     JAVA_HOME= ${LOCALBASE}/jdk-1.5.0
     BUILD_DEPENDS+= jdk->=1.5.0,<1.6:devel/jdk/1.5
d45 1
a45 1
     MODJAVA_RUN_DEPENDS= jdk->=1.5.0|jre->=1.5.0|kaffe-*|jamvm-*:devel/jdk/1.5
d47 1
a47 17
     MODJAVA_RUN_DEPENDS= jdk->=1.5.0|kaffe-*:devel/jdk/1.5
.  endif
.elif ${MODJAVA_VER:S/+//} == "1.5"
   ONLY_FOR_ARCHS?= i386 amd64
.  if ${NO_BUILD:L} != "yes"
     JAVA_HOME= ${LOCALBASE}/jdk-1.5.0
     BUILD_DEPENDS+= jdk->=1.5.0,<1.6:devel/jdk/1.5
.  endif
.  if ${MODJAVA_JRERUN:L} == "yes"
     _MODJAVA_RUNDEP= jdk->=1.5.0,<1.6|jre->=1.5.0,<1.6
.  else
     _MODJAVA_RUNDEP= jdk->=1.5.0,<1.6
.  endif
.  if ${MODJAVA_VER} == "1.5+"
     MODJAVA_RUN_DEPENDS= ${_MODJAVA_RUNDEP:S/,<1.6//g}:devel/jdk/1.5
.  else
     MODJAVA_RUN_DEPENDS= ${_MODJAVA_RUNDEP}:devel/jdk/1.5
@


1.27
log
@put JAVA_HOME in SUBST_VARS
@
text
@d1 1
a1 1
# $OpenBSD: java.port.mk,v 1.26 2011/09/01 17:13:51 jasper Exp $
a98 4
.endif

.if defined(JAVA_HOME)
   SUBST_VARS += JAVA_HOME
@


1.26
log
@- make it possible to pass extra arguments to ant using MODJAVA_BUILD_ARGS
@
text
@d1 1
a1 1
# $OpenBSD: java.port.mk,v 1.25 2011/09/01 08:03:47 jasper Exp $
d99 4
@


1.25
log
@- don't use ${DISTNAME} to construct MODJAVA_{DOC,EXAMPLES}_DIR
@
text
@d1 1
a1 1
# $OpenBSD: java.port.mk,v 1.24 2011/08/31 20:33:32 jasper Exp $
d115 1
d120 2
a121 1
		-buildfile ${MODJAVA_BUILD_FILE} ${MODJAVA_BUILD_TARGET}
@


1.24
log
@Provide a few more convenience variables, of which MODJAVA_JAR_DIR is the most
important.
Ports that install .jar files for public use (ie, in share/java/classes/)
please install unversioned jar files from now on. If a port installs
multiple jar files, use a share/java/classes/<project_name>/ prefix.
This will help other ports to pickup these classes.

discussed with and ok kurt@@
@
text
@d1 1
a1 1
# $OpenBSD: java.port.mk,v 1.23 2011/08/31 20:00:56 jasper Exp $
d130 2
a131 2
MODJAVA_EXAMPLE_DIR = ${MODJAVA_SHARE_DIR}/examples/${DISTNAME}/
MODJAVA_DOC_DIR   = ${MODJAVA_SHARE_DIR}/doc/${DISTNAME}/
@


1.23
log
@Implement MODJAVA_BUILD, and add MODJAVA_BUILD_{DIR,FILE,TARGET}.
When MODJAVA_BUILD is set to 'ant' this adds the correct build dependencies,
as well as providing a do-build target (if not already set by the port).

  discussed with and ok kurt@@
@
text
@d1 1
a1 1
# $OpenBSD: java.port.mk,v 1.22 2011/08/30 17:16:10 jasper Exp $
d122 10
@


1.22
log
@Append 'java' to the list of categories.

ok kurt@@
@
text
@d1 1
a1 1
# $OpenBSD: java.port.mk,v 1.21 2011/01/13 22:35:52 kurt Exp $
d105 17
@


1.21
log
@Correct snafu with pkg version going backwards. Clue bat
beating from espie@@ help and okay landry@@
@
text
@d1 1
a1 1
# $OpenBSD: java.port.mk,v 1.20 2010/11/15 19:45:59 espie Exp $
d102 3
@


1.20
log
@move depends to new style
@
text
@d1 1
a1 1
# $OpenBSD: java.port.mk,v 1.19 2009/11/09 11:02:58 sthen Exp $
d85 1
a85 1
     BUILD_DEPENDS+= jdk->=1.7.0,<1.8:devel/jdk/1.7
d88 1
a88 1
     _MODJAVA_RUNDEP= jdk->=1.7.0,<1.8|jre->=1.7.0,<1.8
d90 1
a90 1
     _MODJAVA_RUNDEP= jdk->=1.7.0,<1.8
d93 1
a93 1
     MODJAVA_RUN_DEPENDS= ${_MODJAVA_RUNDEP:S/,<1.8//g}:devel/jdk/1.7
@


1.19
log
@Fix RUN_DEPENDS with MODJAVA_VER=1.3+ or 1.4+, it was allowing 1.5/jamvm/kaffe
but not newer jdk/jre versions. Problem noted by Matthew Szudzik. ok kurt@@
@
text
@d1 1
a1 1
# $OpenBSD: java.port.mk,v 1.18 2009/03/16 16:38:25 sthen Exp $
d42 1
a42 1
     BUILD_DEPENDS+= :jdk->=1.5.0,<1.6:devel/jdk/1.5
d45 1
a45 1
     MODJAVA_RUN_DEPENDS= :jdk->=1.5.0|jre->=1.5.0|kaffe-*|jamvm-*:devel/jdk/1.5
d47 1
a47 1
     MODJAVA_RUN_DEPENDS= :jdk->=1.5.0|kaffe-*:devel/jdk/1.5
d53 1
a53 1
     BUILD_DEPENDS+= :jdk->=1.5.0,<1.6:devel/jdk/1.5
d61 1
a61 1
     MODJAVA_RUN_DEPENDS= :${_MODJAVA_RUNDEP:S/,<1.6//g}:devel/jdk/1.5
d63 1
a63 1
     MODJAVA_RUN_DEPENDS= :${_MODJAVA_RUNDEP}:devel/jdk/1.5
d69 1
a69 1
     BUILD_DEPENDS+= :jdk->=1.6.0,<1.7:devel/jdk/1.6
d77 1
a77 1
     MODJAVA_RUN_DEPENDS= :${_MODJAVA_RUNDEP:S/,<1.7//g}:devel/jdk/1.6
d79 1
a79 1
     MODJAVA_RUN_DEPENDS= :${_MODJAVA_RUNDEP}:devel/jdk/1.6
d85 1
a85 1
     BUILD_DEPENDS+= :jdk->=1.7.0,<1.8:devel/jdk/1.7
d93 1
a93 1
     MODJAVA_RUN_DEPENDS= :${_MODJAVA_RUNDEP:S/,<1.8//g}:devel/jdk/1.7
d95 1
a95 1
     MODJAVA_RUN_DEPENDS= :${_MODJAVA_RUNDEP}:devel/jdk/1.7
@


1.18
log
@unbreak RUN_DEPENDS for MOD_JAVA_VER=1.x+, which I missed when I fixed
the normal case. problem found by Andreas Kahari.
@
text
@d1 1
a1 1
# $OpenBSD: java.port.mk,v 1.17 2009/03/11 22:04:07 sthen Exp $
d45 1
a45 1
     MODJAVA_RUN_DEPENDS= :jdk->=1.5.0,<1.6|jre->=1.5.0,<1.6|kaffe-*|jamvm-*:devel/jdk/1.5
d47 1
a47 1
     MODJAVA_RUN_DEPENDS= :jdk->=1.5.0,<1.6|kaffe-*:devel/jdk/1.5
@


1.17
log
@fix pkgspec for dependencies - looks ok to phessler, kili
@
text
@d1 1
a1 1
# $OpenBSD: java.port.mk,v 1.16 2008/06/24 02:38:31 kurt Exp $
d61 1
a61 1
     MODJAVA_RUN_DEPENDS= :${_MODJAVA_RUNDEP:S/-/->=/g}:devel/jdk/1.5
d77 1
a77 1
     MODJAVA_RUN_DEPENDS= :${_MODJAVA_RUNDEP:S/-/->=/g}:devel/jdk/1.6
d93 1
a93 1
     MODJAVA_RUN_DEPENDS= :${_MODJAVA_RUNDEP:S/-/->=/g}:devel/jdk/1.7
@


1.16
log
@Deprecate 1.3 and 1.4 due to lack of security updates, end-of-life status
or near eol, and bulk build time. This removes the limited Java support we
had on arm, powerpc and sparc until such time OpenJDK/IcedTea can replace
it. 1.3 and 1.4 ports directories will be removed next release to avoid
bit rot. Requested by espie@@ and okay by many with no objections.
@
text
@d1 1
a1 1
# $OpenBSD: java.port.mk,v 1.15 2008/05/05 02:53:15 kurt Exp $
d42 1
a42 1
     BUILD_DEPENDS+= :jdk-1.5.0*:devel/jdk/1.5
d45 1
a45 1
     MODJAVA_RUN_DEPENDS= :jdk->=1.5.0.*|jre->=1.5.0.*|kaffe-*|jamvm-*:devel/jdk/1.5
d47 1
a47 1
     MODJAVA_RUN_DEPENDS= :jdk->=1.5.0.*|kaffe-*:devel/jdk/1.5
d53 1
a53 1
     BUILD_DEPENDS+= :jdk-1.5.0*:devel/jdk/1.5
d56 1
a56 1
     _MODJAVA_RUNDEP= jdk-1.5.0.*|jre-1.5.0.*
d58 1
a58 1
     _MODJAVA_RUNDEP= jdk-1.5.0.*
d69 1
a69 1
     BUILD_DEPENDS+= :jdk-1.6.0*:devel/jdk/1.6
d72 1
a72 1
     _MODJAVA_RUNDEP= jdk-1.6.0.*|jre-1.6.0.*
d74 1
a74 1
     _MODJAVA_RUNDEP= jdk-1.6.0.*
d85 1
a85 1
     BUILD_DEPENDS+= :jdk-1.7.0*:devel/jdk/1.7
d88 1
a88 1
     _MODJAVA_RUNDEP= jdk-1.7.0.*|jre-1.7.0.*
d90 1
a90 1
     _MODJAVA_RUNDEP= jdk-1.7.0.*
@


1.15
log
@Add support for 1.6 and 1.7 level ports. okay nikolay@@ ian@@
@
text
@d1 1
a1 1
# $OpenBSD: java.port.mk,v 1.14 2008/03/18 19:40:03 sturm Exp $
d36 4
a39 6
.if ${MACHINE_ARCH} == "amd64" && (${MODJAVA_VER} == "1.3+" || ${MODJAVA_VER} == "1.4+")
# this is a special case for amd64. since amd64 doesn't have 1.3 or 1.4,
# but 1.5 can run any 1.3+ or 1.4+ port, so special case them to run
# on 1.5+ for amd64. Also add in jamvm and kaffe since they likely can
# run these too. 
   ONLY_FOR_ARCHS?= amd64
d45 1
a45 1
     MODJAVA_RUN_DEPENDS= :jdk->=1.5.0|jre->=1.5.0|kaffe-*|jamvm-*:devel/jdk/1.5
d47 1
a47 49
     MODJAVA_RUN_DEPENDS= :jdk->=1.5.0|kaffe-*:devel/jdk/1.5
.  endif
.elif ${MODJAVA_VER:S/+//} == "1.3"
   ONLY_FOR_ARCHS?= arm i386 powerpc sparc
.  if ${NO_BUILD:L} != "yes"
.    if ${MACHINE_ARCH} == "i386" 
       JAVA_HOME= ${LOCALBASE}/jdk-1.5.0
       BUILD_DEPENDS+= :jdk-1.5.0*:devel/jdk/1.5
.    else
       JAVA_HOME= ${LOCALBASE}/jdk-1.3.1
       BUILD_DEPENDS+= :jdk-1.3.1:devel/jdk/1.3
.    endif
.  endif
.  if ${MODJAVA_JRERUN:L} == "yes"
.    if ${MODJAVA_VER} == "1.3+"
       _MODJAVA_RUNDEP= jdk-1.3.1*|jre-1.3.1*|jdk->=1.4.2p9|jre->=1.4.2p9|kaffe-*|jamvm-*
.    else
       _MODJAVA_RUNDEP= jdk-1.3.1|jre-1.3.1
.    endif
.  else
.    if ${MODJAVA_VER} == "1.3+"
       _MODJAVA_RUNDEP= jdk-1.3.1*|jdk->=1.4.2p9|kaffe-*
.    else
       _MODJAVA_RUNDEP= jdk-1.3.1
.    endif
.  endif
.  if ${MACHINE_ARCH} == "i386" && ${MODJAVA_VER} == "1.3+"
     MODJAVA_RUN_DEPENDS= :${_MODJAVA_RUNDEP}:devel/jdk/1.5
.  else
     MODJAVA_RUN_DEPENDS= :${_MODJAVA_RUNDEP}:devel/jdk/1.3
.  endif
.elif ${MODJAVA_VER:S/+//} == "1.4"
   ONLY_FOR_ARCHS?= i386
.  if ${NO_BUILD:L} != "yes"
     JAVA_HOME= ${LOCALBASE}/jdk-1.5.0
     BUILD_DEPENDS+= :jdk-1.5.0*:devel/jdk/1.5
.  endif
.  if ${MODJAVA_JRERUN:L} == "yes"
.    if ${MODJAVA_VER} == "1.4+"
       MODJAVA_RUN_DEPENDS= :jdk->=1.4.2p9|jre->=1.4.2p9|kaffe-*|jamvm-*:devel/jdk/1.5
.    else
       MODJAVA_RUN_DEPENDS= :jdk->=1.4.2p9,<1.5|jre->=1.4.2p9,<1.5|kaffe-*|jamvm-*:devel/jdk/1.4
.    endif
.  else
.    if ${MODJAVA_VER} == "1.4+"
       MODJAVA_RUN_DEPENDS= :jdk->=1.4.2p9|kaffe-*:devel/jdk/1.5
.    else
       MODJAVA_RUN_DEPENDS= :jdk->=1.4.2p9,<1.5|kaffe-*:devel/jdk/1.4
.    endif
@


1.14
log
@fix java RUN_DEPENDS for the 1.5 case
ok kurt
@
text
@d1 1
a1 1
# $OpenBSD: java.port.mk,v 1.13 2008/02/14 21:48:43 kurt Exp $
d6 1
a6 1
# for x.y are 1.3, 1.4 or 1.5.
d114 32
@


1.13
log
@- remove 1.3-linux now that it is no longer needed for building 1.4
- update 1.3+ MODJAVA_RUN_DEPENDS to account for 1.3-linux removal
okay ian@@ pval@@
@
text
@d1 1
a1 1
# $OpenBSD: java.port.mk,v 1.12 2007/06/27 21:33:33 kurt Exp $
d106 1
a106 1
     _MODJAVA_RUNDEP= jdk-1.5.0|jre-1.5.0
d108 1
a108 1
     _MODJAVA_RUNDEP= jdk-1.5.0
@


1.12
log
@expand BUILD_DEPENDS to allow building ports with jdk-1.5.0 update 11
@
text
@d1 1
a1 1
# $OpenBSD: java.port.mk,v 1.11 2007/01/16 02:47:14 kurt Exp $
d28 1
a28 1
# on the architecture a 1.3 or 1.4 level port my built
d75 2
a76 6
.  if ${MACHINE_ARCH} == "i386"
.    if ${MODJAVA_VER} == "1.3+"
       MODJAVA_RUN_DEPENDS= :${_MODJAVA_RUNDEP}|jdk-linux-1.3.1*:devel/jdk/1.5
.    else
       MODJAVA_RUN_DEPENDS= :${_MODJAVA_RUNDEP}|jdk-linux-1.3.1*:devel/jdk/1.3
.    endif
@


1.11
log
@Change the default package for 1.3+ and 1.4+ ports to devel/jdk/1.5 on
i386. This fixed a 'FORCE_UPDATE=yes make install' issue noticed by brad@@
and further encourages users to use the 1.5 jdk which works the best.
@
text
@d1 1
a1 1
# $OpenBSD: java.port.mk,v 1.10 2006/11/28 14:28:25 kurt Exp $
d44 1
a44 1
     BUILD_DEPENDS+= :jdk-1.5.0:devel/jdk/1.5
d56 1
a56 1
       BUILD_DEPENDS+= :jdk-1.5.0:devel/jdk/1.5
d88 1
a88 1
     BUILD_DEPENDS+= :jdk-1.5.0:devel/jdk/1.5
d107 1
a107 1
     BUILD_DEPENDS+= :jdk-1.5.0:devel/jdk/1.5
@


1.10
log
@On i386 all source built java ports will use the 1.5 jdk to build. Runtime
compatibility is preserved through the use of the javac -source and
-target arguments. These arguments are now required for any new source
built java ports.
@
text
@d1 1
a1 1
# $OpenBSD: java.port.mk,v 1.9 2006/11/20 19:28:18 espie Exp $
d76 5
a80 1
     MODJAVA_RUN_DEPENDS= :${_MODJAVA_RUNDEP}|jdk-linux-1.3.1*:devel/jdk/1.3
d92 1
a92 1
       MODJAVA_RUN_DEPENDS= :jdk->=1.4.2p9|jre->=1.4.2p9|kaffe-*|jamvm-*:devel/jdk/1.4
d98 1
a98 1
       MODJAVA_RUN_DEPENDS= :jdk->=1.4.2p9|kaffe-*:devel/jdk/1.4
@


1.9
log
@tweak for new MULTI_PACKAGES
@
text
@d1 1
a1 1
# $OpenBSD: java.port.mk,v 1.8 2006/11/01 20:34:24 kurt Exp $
d19 2
a20 2
#   BUILD_DEPENDS on a jdk (native preferred).
#   JAVA_HOME to pass on to the port build.
d23 12
a41 1
   JAVA_HOME= ${LOCALBASE}/jdk-1.5.0
d43 1
a52 1
   JAVA_HOME= ${LOCALBASE}/jdk-1.3.1
d54 7
a60 1
     BUILD_DEPENDS+= :jdk-1.3.1:devel/jdk/1.3
a81 1
   JAVA_HOME= ${LOCALBASE}/jdk-1.4.2
d83 2
a84 1
     BUILD_DEPENDS+= :jdk-1.4.2:devel/jdk/1.4
a100 1
   JAVA_HOME= ${LOCALBASE}/jdk-1.5.0
d102 1
@


1.8
log
@adjust depends so that 1.3+, 1.4 & 1.4+ level ports must use libz free
jdk/1.4 from now on.
@
text
@d1 1
a1 1
# $OpenBSD: java.port.mk,v 1.7 2006/08/05 16:38:20 kurt Exp $
d35 1
a35 1
     RUN_DEPENDS+= :jdk->=1.5.0|jre->=1.5.0|kaffe-*|jamvm-*:devel/jdk/1.5
d37 1
a37 1
     RUN_DEPENDS+= :jdk->=1.5.0|kaffe-*:devel/jdk/1.5
d59 1
a59 1
     RUN_DEPENDS+= :${_MODJAVA_RUNDEP}|jdk-linux-1.3.1*:devel/jdk/1.3
d61 1
a61 1
     RUN_DEPENDS+= :${_MODJAVA_RUNDEP}:devel/jdk/1.3
d71 1
a71 1
       RUN_DEPENDS+= :jdk->=1.4.2p9|jre->=1.4.2p9|kaffe-*|jamvm-*:devel/jdk/1.4
d73 1
a73 1
       RUN_DEPENDS+= :jdk->=1.4.2p9,<1.5|jre->=1.4.2p9,<1.5|kaffe-*|jamvm-*:devel/jdk/1.4
d77 1
a77 1
       RUN_DEPENDS+= :jdk->=1.4.2p9|kaffe-*:devel/jdk/1.4
d79 1
a79 1
       RUN_DEPENDS+= :jdk->=1.4.2p9,<1.5|kaffe-*:devel/jdk/1.4
d94 1
a94 1
     RUN_DEPENDS+= :${_MODJAVA_RUNDEP:S/-/->=/g}:devel/jdk/1.5
d96 1
a96 1
     RUN_DEPENDS+= :${_MODJAVA_RUNDEP}:devel/jdk/1.5
d101 2
@


1.7
log
@expand RUN_DEPENDS to include kaffe and jamvm where appropriate so if
someone wants to run a java port with them they don't need to first build
one of Sun's jdks.  okay nikolay@@
@
text
@d1 1
a1 1
# $OpenBSD: java.port.mk,v 1.6 2006/07/28 13:06:24 kurt Exp $
d47 1
a47 1
       _MODJAVA_RUNDEP= jdk->=1.3.1|jre->=1.3.1|kaffe-*|jamvm-*
d53 1
a53 1
       _MODJAVA_RUNDEP= jdk->=1.3.1|kaffe-*
d71 1
a71 1
       RUN_DEPENDS+= :jdk->=1.4.2|jre->=1.4.2|kaffe-*|jamvm-*:devel/jdk/1.4
d73 1
a73 1
       RUN_DEPENDS+= :jdk-1.4.2|jre-1.4.2|kaffe-*|jamvm-*:devel/jdk/1.4
d77 1
a77 1
       RUN_DEPENDS+= :jdk->=1.4.2|kaffe-*:devel/jdk/1.4
d79 1
a79 1
       RUN_DEPENDS+= :jdk-1.4.2|kaffe-*:devel/jdk/1.4
@


1.6
log
@indent defines too so that this is more readable. 'looks sane' nikolay@@
@
text
@d1 1
a1 1
# $OpenBSD: java.port.mk,v 1.5 2006/05/28 00:14:39 kurt Exp $
d27 2
a28 1
# on 1.5+ for amd64 
d35 1
a35 1
     RUN_DEPENDS+= :jdk->=1.5.0|jre->=1.5.0:devel/jdk/1.5
d37 1
a37 1
     RUN_DEPENDS+= :jdk->=1.5.0:devel/jdk/1.5
d46 11
a56 8
     _MODJAVA_RUNDEP_TMP= jdk-1.3.1|jre-1.3.1
.  else
     _MODJAVA_RUNDEP_TMP= jdk-1.3.1
.  endif
.  if ${MODJAVA_VER} == "1.3+"
     _MODJAVA_RUNDEP= ${_MODJAVA_RUNDEP_TMP:S/-/->=/g}
.  else
     _MODJAVA_RUNDEP= ${_MODJAVA_RUNDEP_TMP}
d70 11
a80 8
     _MODJAVA_RUNDEP= jdk-1.4.2|jre-1.4.2
.  else
     _MODJAVA_RUNDEP= jdk-1.4.2
.  endif
.  if ${MODJAVA_VER} == "1.4+"
     RUN_DEPENDS+= :${_MODJAVA_RUNDEP:S/-/->=/g}:devel/jdk/1.4
.  else
     RUN_DEPENDS+= :${_MODJAVA_RUNDEP}:devel/jdk/1.4
@


1.5
log
@add amd64 support. tested & ok ian@@
@
text
@d1 1
a1 1
# $OpenBSD: java.port.mk,v 1.4 2006/03/20 14:42:37 kurt Exp $
d28 2
a29 2
ONLY_FOR_ARCHS?=	amd64
JAVA_HOME=		${LOCALBASE}/jdk-1.5.0
d31 1
a31 1
BUILD_DEPENDS+=		:jdk-1.5.0:devel/jdk/1.5
d34 1
a34 1
RUN_DEPENDS+=		:jdk->=1.5.0|jre->=1.5.0:devel/jdk/1.5
d36 1
a36 1
RUN_DEPENDS+=		:jdk->=1.5.0:devel/jdk/1.5
d39 2
a40 2
ONLY_FOR_ARCHS?=	arm i386 powerpc sparc
JAVA_HOME=		${LOCALBASE}/jdk-1.3.1
d42 1
a42 1
BUILD_DEPENDS+=		:jdk-1.3.1:devel/jdk/1.3
d45 1
a45 1
_MODJAVA_RUNDEP_TMP=	jdk-1.3.1|jre-1.3.1
d47 1
a47 1
_MODJAVA_RUNDEP_TMP=	jdk-1.3.1
d50 1
a50 1
_MODJAVA_RUNDEP=	${_MODJAVA_RUNDEP_TMP:S/-/->=/g}
d52 1
a52 1
_MODJAVA_RUNDEP=	${_MODJAVA_RUNDEP_TMP}
d55 1
a55 1
RUN_DEPENDS+=		:${_MODJAVA_RUNDEP}|jdk-linux-1.3.1*:devel/jdk/1.3
d57 1
a57 1
RUN_DEPENDS+=		:${_MODJAVA_RUNDEP}:devel/jdk/1.3
d60 2
a61 2
ONLY_FOR_ARCHS?=	i386
JAVA_HOME=		${LOCALBASE}/jdk-1.4.2
d63 1
a63 1
BUILD_DEPENDS+=		:jdk-1.4.2:devel/jdk/1.4
d66 1
a66 1
_MODJAVA_RUNDEP=	jdk-1.4.2|jre-1.4.2
d68 1
a68 1
_MODJAVA_RUNDEP=	jdk-1.4.2
d71 1
a71 1
RUN_DEPENDS+=	:${_MODJAVA_RUNDEP:S/-/->=/g}:devel/jdk/1.4
d73 1
a73 1
RUN_DEPENDS+=	:${_MODJAVA_RUNDEP}:devel/jdk/1.4
d76 2
a77 2
ONLY_FOR_ARCHS?=	i386 amd64
JAVA_HOME=		${LOCALBASE}/jdk-1.5.0
d79 1
a79 1
BUILD_DEPENDS+=		:jdk-1.5.0:devel/jdk/1.5
d82 1
a82 1
_MODJAVA_RUNDEP=	jdk-1.5.0|jre-1.5.0
d84 1
a84 1
_MODJAVA_RUNDEP=	jdk-1.5.0
d87 1
a87 1
RUN_DEPENDS+=		:${_MODJAVA_RUNDEP:S/-/->=/g}:devel/jdk/1.5
d89 1
a89 1
RUN_DEPENDS+=		:${_MODJAVA_RUNDEP}:devel/jdk/1.5
d92 1
a92 1
ERRORS+="Fatal: MODJAVA_VER must be set to a valid value."
@


1.4
log
@add sparc to ONLY_FOR_ARCHS for ports with MODJAVA_VER=1.3/1.3+
@
text
@d1 1
a1 1
# $OpenBSD: java.port.mk,v 1.3 2005/07/14 17:29:58 kurt Exp $
d24 15
a38 1
.if ${MODJAVA_VER:S/+//} == "1.3"
d76 1
a76 1
ONLY_FOR_ARCHS?=	i386
@


1.3
log
@- enable 1.3 on arm
@
text
@d1 1
a1 1
# $OpenBSD: java.port.mk,v 1.2 2005/06/17 15:37:33 kurt Exp $
d25 1
a25 1
ONLY_FOR_ARCHS?=	arm i386 powerpc
@


1.2
log
@- fix linux 1.3.1 jdk pkgspec
@
text
@d1 1
a1 1
# $OpenBSD: java.port.mk,v 1.1 2005/06/17 14:59:27 kurt Exp $
d25 1
a25 1
ONLY_FOR_ARCHS?=	i386 powerpc
@


1.1
log
@- add java MODULE to handle some commmon java port issues
- Based on the MODJAVA_VER, MODJAVA_JRERUN, NO_BUILD
  and MACHINE_ARCH, the following things will be setup:
    ONLY_FOR_ARCHS if not already set.
    BUILD_DEPENDS on a jdk (native preferred).
    JAVA_HOME to pass on to the port build.
    RUN_DEPENDS for all jdk's and jre's that can run the port.

Review and feedback nikolay@@, ian@@.
@
text
@d1 1
a1 1
# $OpenBSD$
d41 1
a41 1
RUN_DEPENDS+=		:${_MODJAVA_RUNDEP}|jdk1.3.1-linux:devel/jdk/1.3
@

