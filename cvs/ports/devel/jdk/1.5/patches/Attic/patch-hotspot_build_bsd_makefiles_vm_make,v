head	1.6;
access;
symbols
	OPENBSD_4_1:1.3.0.4
	OPENBSD_4_1_BASE:1.3
	OPENBSD_4_0:1.3.0.2
	OPENBSD_4_0_BASE:1.3
	OPENBSD_3_9:1.2.0.2
	OPENBSD_3_9_BASE:1.2
	OPENBSD_3_8:1.1.1.1.0.2
	OPENBSD_3_8_BASE:1.1.1.1
	kurt_20050525:1.1.1.1
	kurt:1.1.1;
locks; strict;
comment	@# @;


1.6
date	2007.07.27.19.29.52;	author kurt;	state dead;
branches;
next	1.5;

1.5
date	2007.07.01.20.34.02;	author kurt;	state Exp;
branches;
next	1.4;

1.4
date	2007.06.27.21.51.09;	author kurt;	state dead;
branches;
next	1.3;

1.3
date	2006.05.15.18.11.22;	author ian;	state Exp;
branches;
next	1.2;

1.2
date	2005.11.22.14.43.05;	author kurt;	state Exp;
branches;
next	1.1;

1.1
date	2005.05.25.17.27.53;	author kurt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2005.05.25.17.27.53;	author kurt;	state Exp;
branches;
next	;


desc
@@


1.6
log
@- upgrade to Update 12 srcs which fixes the following bugs:
http://java.sun.com/j2se/1.5.0/ReleaseNotes.html#150_12
- remove patches I committed into patchset 6
@
text
@$OpenBSD: patch-hotspot_build_bsd_makefiles_vm_make,v 1.5 2007/07/01 20:34:02 kurt Exp $
--- hotspot/build/bsd/makefiles/vm.make.orig	Wed Jun 20 11:02:14 2007
+++ hotspot/build/bsd/makefiles/vm.make	Wed Jun 20 11:03:02 2007
@@@@ -197,6 +197,12 @@@@ $(AOUT): $(AOUT.o) $(LIBJVM)
 	${LINK} -o $@@ ${AOUT_FLAGS} $(AOUT.o) -L `pwd` -L ${JAVA_HOME}/jre/lib/$(Platform_gnu_dis_arch) -L ${JAVA_HOME}/lib/$(Platform_gnu_dis_arch) -l$(JVM) $(LIBS) ; \
 	${LINK} -o $@@ ${AOUT_FLAGS} $(AOUT.o) -L `pwd` -L ${JAVA_HOME}/jre/lib/$(Platform_gnu_dis_arch) -L ${JAVA_HOME}/lib/$(Platform_gnu_dis_arch) -l$(JVM) $(LIBS)
 
+ifndef LDNOMAP
+  ifdef MAPFILE
+    LFLAGS_VM += -Xlinker --version-script=$(MAPFILE)
+  endif
+endif
+
 # Set soname, see 5009832
 LFLAGS_VM += -Xlinker -soname=$(LIBJVM)
 
@


1.5
log
@- actually enable version scripts on libjvm which fixes a symbol conflict
with recent xulrunner which is used by eclipse's internal swt-browser.
(patch missed in last update)
- adjust url to update 11 download which has been move to the archive.
@
text
@d1 1
a1 1
$OpenBSD$
@


1.4
log
@- update port to be based of Sun's 1.5.0 Update 11 src which includes many
bug fixes since the initial release of the 1.5 jdk. I'm sure some of the
fixes are security related but I wasn't able to find a concise list. All
the bugs fixes listed here from update 11 and lower should be fixed by
this update: http://java.sun.com/j2se/1.5.0/ReleaseNotes.html#150_11
- NOTE: License change: used to be SCSL, now is JRL (Java Research
License). Still no packages with this license but at least we get the bug
fixes and security fixes now: https://tiger.dev.java.net/
- enable version scripts on libjvm which fixes a symbol conflict with
recent xulrunner which is used by eclipse's internal swt-browser.
@
text
@d1 6
a6 4
$OpenBSD: patch-hotspot_build_bsd_makefiles_vm_make,v 1.3 2006/05/15 18:11:22 ian Exp $
--- hotspot/build/bsd/makefiles/vm.make.orig	Mon May  8 15:04:13 2006
+++ hotspot/build/bsd/makefiles/vm.make	Tue May  9 19:49:32 2006
@@@@ -71,6 +71,10 @@@@ BUILD_VERSION$(HOTSPOT_BUILD_VERSION) = 
d8 4
a11 4
 CPPFLAGS = ${SYSDEFS} ${INCLUDES} ${BUILD_VERSION}
 
+ifdef DEFAULT_LD_LIBRARY_PATH
+CPPFLAGS += -DDEFAULT_LD_LIBRARY_PATH="\"$(DEFAULT_LD_LIBRARY_PATH)\""
d14 2
a15 11
 # Suppress warnings (for now)
 CFLAGS += -w
 
@@@@ -78,7 +82,7 @@@@ CFLAGS += -w
 #AOUT_FLAGS += -norunpath
 
 COMPILE   = ${CPP} ${CPPFLAGS} ${CFLAGS}
-LINK_LIB  = ${CPP} -shared -mimpure-text
+LINK_LIB  = ${CPP} -shared -mimpure-text -fPIC
 LINK      = ${CPP} ${AOUT_FLAGS}
 
@


1.3
log
@Enable JDK/JRE build on amd64. Switch to bootstrapping using Kaffe + Solaris JDK binary,
obviating need to build with JDK Linux compat (which was i386 only anyway).
Add native_bootstrap pseudo-flavor so you can build with a native Sun JDK if you
have one (tested by building this way using JDK built with default Kaffe-based build).
Work by kurt@@, tested by him on i386 and me on amd64. OK kurt@@.
@
text
@d1 1
a1 1
$OpenBSD: patch-hotspot_build_bsd_makefiles_vm_make,v 1.2 2005/11/22 14:43:05 kurt Exp $
@


1.2
log
@- update to patchset 2. mostly removing patches now included in patchset.
- link awt_robot with -pthread
- disable a runtime Motif version check that incorrectly thought we were
using Motif 1.2 based on Xm major version. problem reported by Laurence
Tratt
- plugin and webstart comming later
@
text
@d1 3
a3 3
$OpenBSD$
--- hotspot/build/bsd/makefiles/vm.make.orig	Wed Nov 16 17:13:31 2005
+++ hotspot/build/bsd/makefiles/vm.make	Wed Nov 16 21:21:40 2005
d14 9
@


1.1
log
@Initial revision
@
text
@d2 2
a3 2
--- hotspot/build/bsd/makefiles/vm.make.orig	Wed Feb 16 21:21:03 2005
+++ hotspot/build/bsd/makefiles/vm.make	Wed Feb 16 21:54:14 2005
a14 21
@@@@ -140,6 +144,11 @@@@ verbose-echo$(MAKE_VERBOSE) = :
 
 LIBS += -lm -pthread
 
+# g++ doesn't recognize -pthread, add it manually
+ifeq ($(TRUE_PLATFORM), OpenBSD)
+LIBS += -lpthread
+endif
+
 JVM = jvm$(G_SUFFIX)
 LIBJVM = lib$(JVM).so
 
@@@@ -200,7 +209,7 @@@@ LIBJVM.o/LINK_INTO_LIBJVM  = $(Obj_Files
 
 $(LIBJVM): $(LIBJVM.o)
 	echo Linking vm... ; \
-	${LINK_LIB} ${LIB_FLAGS} ${LFLAGS_VM} -z noversion -o $@@ $(LIBJVM.o) $(LIBS)
+	${LINK_LIB} ${LIB_FLAGS} ${LFLAGS_VM} -o $@@ $(LIBJVM.o) $(LIBS)
 ifdef STRIP
 	echo Stripping vm... ; \
 	$(STRIP) $(LIBJVM)
@


1.1.1.1
log
@initial import of 1.5
@
text
@@
