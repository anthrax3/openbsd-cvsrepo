head	1.2;
access;
symbols
	OPENBSD_6_1:1.1.0.16
	OPENBSD_6_1_BASE:1.1
	OPENBSD_6_0:1.1.0.14
	OPENBSD_6_0_BASE:1.1
	OPENBSD_5_9:1.1.0.10
	OPENBSD_5_9_BASE:1.1
	OPENBSD_5_8:1.1.0.12
	OPENBSD_5_8_BASE:1.1
	OPENBSD_5_7:1.1.0.8
	OPENBSD_5_7_BASE:1.1
	OPENBSD_5_6:1.1.0.6
	OPENBSD_5_6_BASE:1.1
	OPENBSD_5_5:1.1.0.4
	OPENBSD_5_5_BASE:1.1
	OPENBSD_5_4:1.1.0.2
	OPENBSD_5_4_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2017.05.03.07.10.37;	author sthen;	state Exp;
branches;
next	1.1;
commitid	tEgA5wB0XsbqZPP0;

1.1
date	2013.06.23.18.36.50;	author landry;	state Exp;
branches;
next	;


desc
@@


1.2
log
@handle aarch64, ok landry@@
@
text
@$OpenBSD$

Index: nspr/pr/include/md/_openbsd.h
--- nspr/pr/include/md/_openbsd.h.orig
+++ nspr/pr/include/md/_openbsd.h
@@@@ -22,8 +22,14 @@@@
 #define _PR_SI_ARCHITECTURE "powerpc"
 #elif defined(__sparc__)
 #define _PR_SI_ARCHITECTURE "sparc"
+#elif defined(__aarch64__)
+#define _PR_SI_ARCHITECTURE "aarch64"
 #elif defined(__arm__)
 #define _PR_SI_ARCHITECTURE "arm"
+#elif defined(__hppa__)
+#define _PR_SI_ARCHITECTURE "hppa"
+#elif defined(__mips64__) || defined(__mips64el__)
+#define _PR_SI_ARCHITECTURE "mips64"
 #endif
 
 #define PR_DLL_SUFFIX		".so"
@@@@ -33,7 +39,11 @@@@
 #define _MD_DEFAULT_STACK_SIZE	65536L
 #define _MD_MMAP_FLAGS          MAP_PRIVATE
 
+#if defined(__hppa__)
+#define HAVE_STACK_GROWING_UP
+#else
 #undef  HAVE_STACK_GROWING_UP
+#endif
 #define HAVE_DLL
 #define USE_DLFCN
 #define _PR_HAVE_SOCKADDR_LEN
@@@@ -67,8 +77,10 @@@@
 #define JB_SP_INDEX 34
 #elif defined(__amd64__)
 #define JB_SP_INDEX 6
-#elif defined(__arm__)
+#elif defined(__arm__) || defined(__aarch64__)
 #define JB_SP_INDEX 23
+#elif defined(__mips64__) || defined(__mips64el__)
+#define JB_SP_INDEX 29
 #else
 #error "Need to define SP index in jmp_buf here"
 #endif
@


1.1
log
@Update to nspr 4.10.

http://mozilla.6506.n7.nabble.com/ANNOUNCE-NSPR-4-10-Release-td280660.html

After years of sticking to CVS, upstream finally switched to hg,
changing its directory layout while here. All our patches are actually
unchanged, but got renamed/moved. CVS doesn't handle moves :)

Tested in an amd64 bulk build.
@
text
@d2 7
a8 3
--- nspr/pr/include/md/_openbsd.h.orig	Tue May 28 23:39:29 2013
+++ nspr/pr/include/md/_openbsd.h	Wed Jun 12 21:26:27 2013
@@@@ -24,6 +24,10 @@@@
d10 2
d21 1
a21 1
@@@@ -33,7 +37,11 @@@@
d33 3
a35 1
@@@@ -69,6 +77,8 @@@@
d37 2
a38 1
 #elif defined(__arm__)
@

