head	1.3;
access;
symbols
	OPENBSD_5_8:1.1.0.8
	OPENBSD_5_8_BASE:1.1
	OPENBSD_5_7:1.1.0.4
	OPENBSD_5_7_BASE:1.1
	OPENBSD_5_6:1.1.0.2
	OPENBSD_5_6_BASE:1.1;
locks; strict;
comment	@# @;


1.3
date	2017.07.06.05.32.32;	author landry;	state Exp;
branches;
next	1.2;
commitid	0qaXdB4DXO2xSK8B;

1.2
date	2016.01.07.04.49.37;	author jsg;	state dead;
branches;
next	1.1;
commitid	xsFZegtaL9mMmZAZ;

1.1
date	2014.05.25.01.35.14;	author brad;	state Exp;
branches;
next	;


desc
@@


1.3
log
@Fix SDL2 apps SIGBUS on mips64el.

https://bugzilla.libsdl.org/show_bug.cgi?id=3692
https://hg.libsdl.org/SDL/rev/97c66d81b2c9

SDL2 calls XChangeProperty with an integer while X11 expects a long.

From Donovan Watteau, thanks!
@
text
@$OpenBSD$

The Xlib documentation demands that 32-bit values here be passed in a long,
even when long itself isn't a 32-bit value. Otherwise libx11 might read
memory incorrectly (Bugzilla #3692).

97c66d81b2c9 upstream.

Index: src/video/x11/SDL_x11window.c
--- src/video/x11/SDL_x11window.c.orig
+++ src/video/x11/SDL_x11window.c
@@@@ -376,7 +376,7 @@@@ X11_CreateWindow(_THIS, SDL_Window * window)
     Atom _NET_WM_WINDOW_TYPE;
     Atom wintype;
     const char *wintype_name = NULL;
-    int compositor = 1;
+    long compositor = 1;
     Atom _NET_WM_PID;
     Atom XdndAware, xdnd_version = 5;
     long fevent = 0;
@


1.2
log
@update to SDL2 2.0.4
ok aja@@
@
text
@d1 1
a1 1
$OpenBSD: patch-src_video_x11_SDL_x11window_c,v 1.1 2014/05/25 01:35:14 brad Exp $
d3 3
a5 1
Fix stack overflow detected by stack protector strong.
d7 1
a7 2
https://bugzilla.libsdl.org/show_bug.cgi?id=2513
http://hg.libsdl.org/SDL/rev/b74a32894c02
d9 9
a17 4
--- src/video/x11/SDL_x11window.c.orig	Sat May 24 14:44:20 2014
+++ src/video/x11/SDL_x11window.c	Sat May 24 14:44:55 2014
@@@@ -362,7 +362,7 @@@@ X11_CreateWindow(_THIS, SDL_Window * window)
     Atom _NET_WM_WINDOW_TYPE_NORMAL;
d20 1
a20 5
-    Uint32 fevent = 0;
+    long fevent = 0;
 
 #if SDL_VIDEO_OPENGL_GLX || SDL_VIDEO_OPENGL_EGL
     if ((window->flags & SDL_WINDOW_OPENGL) &&
@


1.1
log
@Fix a stack overflow detected in X11_CreateWindow() after the switch to stack
protector strong.

https://bugzilla.libsdl.org/show_bug.cgi?id=2513
http://hg.libsdl.org/SDL/rev/b74a32894c02

ok bcallah@@
@
text
@d1 1
a1 1
$OpenBSD$
@

