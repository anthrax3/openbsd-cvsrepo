head	1.25;
access;
symbols
	OPENBSD_6_1:1.20.0.2
	OPENBSD_6_1_BASE:1.20
	OPENBSD_6_0:1.19.0.2
	OPENBSD_6_0_BASE:1.19
	OPENBSD_5_9:1.18.0.2
	OPENBSD_5_9_BASE:1.18
	OPENBSD_5_8:1.16.0.4
	OPENBSD_5_8_BASE:1.16
	OPENBSD_5_7:1.15.0.2
	OPENBSD_5_7_BASE:1.15
	OPENBSD_5_6:1.10.0.2
	OPENBSD_5_6_BASE:1.10
	OPENBSD_5_5:1.7.0.2
	OPENBSD_5_5_BASE:1.7
	OPENBSD_5_4:1.4.0.2
	OPENBSD_5_4_BASE:1.4
	matthew_2013-May-02:1.1.1.1
	matthew:1.1.1;
locks; strict;
comment	@# @;


1.25
date	2017.09.20.07.30.19;	author giovanni;	state Exp;
branches;
next	1.24;
commitid	D9esc7B8xEzgj8j6;

1.24
date	2017.07.26.22.45.18;	author sthen;	state Exp;
branches;
next	1.23;
commitid	tD4MFrpYYDDL2UFT;

1.23
date	2017.07.23.09.26.26;	author espie;	state Exp;
branches;
next	1.22;
commitid	FZPR2Emws5uDqXzb;

1.22
date	2017.07.16.19.18.51;	author espie;	state Exp;
branches;
next	1.21;
commitid	tt0GhWK5c4uf9ILG;

1.21
date	2017.04.10.11.45.26;	author sthen;	state Exp;
branches;
next	1.20;
commitid	XDh1zlSBq0boKsHk;

1.20
date	2016.11.19.16.06.59;	author sthen;	state Exp;
branches;
next	1.19;
commitid	reCteo5HymQFO3gN;

1.19
date	2016.05.12.07.14.15;	author dcoppa;	state Exp;
branches;
next	1.18;
commitid	SKRdcNfxdzTQjkaF;

1.18
date	2016.01.24.15.10.09;	author ajacoutot;	state Exp;
branches;
next	1.17;
commitid	nsLnVlsqZ0Lpsnr8;

1.17
date	2015.10.05.08.52.10;	author dcoppa;	state Exp;
branches;
next	1.16;
commitid	3YBmo2ZwX3VLdnGe;

1.16
date	2015.04.05.13.31.13;	author sthen;	state Exp;
branches;
next	1.15;
commitid	1hQJnDR1GYYQ0MPE;

1.15
date	2015.02.09.12.56.20;	author dcoppa;	state Exp;
branches;
next	1.14;
commitid	Bf9tXCAiOiQVUHRT;

1.14
date	2014.12.29.21.22.34;	author dcoppa;	state Exp;
branches;
next	1.13;
commitid	aTnKrmOkFgWsu3Lu;

1.13
date	2014.09.17.11.58.31;	author sthen;	state Exp;
branches;
next	1.12;
commitid	6pHPVVECFgWhHNAD;

1.12
date	2014.09.16.19.56.09;	author miod;	state Exp;
branches;
next	1.11;
commitid	qDBOPrPo8GxXpZDD;

1.11
date	2014.09.02.07.50.44;	author dcoppa;	state Exp;
branches;
next	1.10;
commitid	OlsP9QDlIHW23hP5;

1.10
date	2014.07.10.23.20.42;	author sthen;	state Exp;
branches;
next	1.9;
commitid	lJK4B136nUBpuDuV;

1.9
date	2014.07.10.20.13.55;	author sthen;	state Exp;
branches;
next	1.8;
commitid	PF1GDGKAgg1yDmf2;

1.8
date	2014.07.10.11.06.15;	author rpe;	state Exp;
branches;
next	1.7;
commitid	zXOWyDxvWRmZFNNv;

1.7
date	2013.12.02.16.25.08;	author espie;	state Exp;
branches;
next	1.6;

1.6
date	2013.11.12.15.00.25;	author sthen;	state Exp;
branches;
next	1.5;

1.5
date	2013.10.16.05.52.46;	author dcoppa;	state Exp;
branches;
next	1.4;

1.4
date	2013.07.02.06.37.24;	author jasper;	state Exp;
branches;
next	1.3;

1.3
date	2013.06.14.16.39.39;	author matthew;	state Exp;
branches;
next	1.2;

1.2
date	2013.05.21.16.06.52;	author matthew;	state Exp;
branches;
next	1.1;

1.1
date	2013.05.02.19.09.18;	author matthew;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2013.05.02.19.09.18;	author matthew;	state Exp;
branches;
next	;


desc
@@


1.25
log
@Update to 1.8.2 and enable regression tests
original diff by rsadowski@@ with tweaks by me
ok sthen@@ dcoppa@@
bulk build by naddy@@
maintainer timeout
@
text
@# $OpenBSD: Makefile,v 1.24 2017/07/26 22:45:18 sthen Exp $

# as error: ``operation combines symbols in different segments''
# (known toolchain problem) - if fixing, re-enable in devel/cmake/Makefile
# and devel/cmake/cmake.port.mk.
NOT_FOR_ARCHS=		m88k

COMMENT =		small build system with a focus on speed

GH_ACCOUNT =		ninja-build
GH_PROJECT =		ninja
GH_TAGNAME =		v1.8.2

CATEGORIES =		devel
HOMEPAGE =		https://ninja-build.org/
MAINTAINER =		Matthew Dempsky <matthew@@dempsky.org>

# Apache License v2.0
PERMIT_PACKAGE_CDROM =	Yes

# c>=68.1 needed for ppoll
WANTLIB =		c>=68.1 m ${COMPILER_LIBCXX}

MODULES =		lang/python

MODPY_RUNDEP =		No
MODPY_ADJ_FILES =	bootstrap.py \
			configure.py \
			misc/ninja_syntax.py \
			src/browse.py

# Not strictly required, but will be used if available.  Included as a build
# dependency to ensure consistent builds.
BUILD_DEPENDS =		devel/re2c

MAKE_ENV =		CXX="${CXX}"

do-build:
	@@cd ${WRKSRC} && ${SETENV} ${MAKE_ENV} \
	    ${MODPY_BIN} ./configure.py --bootstrap \
	    --verbose --with-python=${MODPY_BIN}

do-install:
	${INSTALL_PROGRAM} ${WRKBUILD}/ninja ${PREFIX}/bin
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/ninja
	${INSTALL_DATA} ${WRKSRC}/doc/manual.asciidoc ${PREFIX}/share/doc/ninja
	${INSTALL_DATA_DIR} ${PREFIX}/share/ninja
	${INSTALL_DATA} ${WRKSRC}/misc/bash-completion ${PREFIX}/share/ninja
	${INSTALL_DATA} ${WRKSRC}/misc/ninja-mode.el ${PREFIX}/share/ninja
	${INSTALL_DATA} ${WRKSRC}/misc/ninja.vim ${PREFIX}/share/ninja
	${INSTALL_DATA} ${WRKSRC}/misc/ninja_syntax.py ${PREFIX}/share/ninja
	${INSTALL_DATA} ${WRKSRC}/misc/write_fake_manifests.py ${PREFIX}/share/ninja
	${INSTALL_DATA} ${WRKSRC}/misc/measure.py ${PREFIX}/share/ninja
	${INSTALL_DATA} ${WRKSRC}/misc/zsh-completion ${PREFIX}/share/ninja

do-test:
	@@cd ${WRKSRC} && ./ninja ninja_test \
	&& ./ninja_test --gtest_filter=MyTest.Name

.include <bsd.port.mk>
@


1.24
log
@bump LIBCXX/LIBECXX/COMPILER_LIBCXX ports.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2017/07/23 09:26:26 espie Exp $
d12 1
a12 2
GH_TAGNAME =		v1.7.2
REVISION =		1
d52 2
d55 4
@


1.23
log
@add pthread to COMPILER_LIBCXX.
white lie, but it allows clang and gcc to be more similar
bump accordingly.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2017/07/16 19:18:51 espie Exp $
d13 1
a13 1
REVISION =		0
@


1.22
log
@use COMPILER_LIBCXX where applicable
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2017/04/10 11:45:26 sthen Exp $
d13 1
@


1.21
log
@use LIBCXX
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2016/11/19 16:06:59 sthen Exp $
d22 1
a22 1
WANTLIB =		c>=68.1 m ${LIBCXX}
@


1.20
log
@update to ninja-01.7.2, from Rafael Sadowski (who tested it with various
ports including chromium, llvm, opencv). Small tweak by me to remove an
unnecessary extra pyc file, dcoppa agrees.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2016/05/12 07:14:15 dcoppa Exp $
d22 1
a22 1
WANTLIB =		c>=68.1 m stdc++
@


1.19
log
@
Update to ninja-1.7.1

From Rafael Sadowski, thanks!
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2016/01/24 15:10:09 ajacoutot Exp $
d10 1
a10 2
V =			1.7.1
GH_ACCOUNT =		martine
d12 1
a12 2
GH_TAGNAME =		v$V
DISTNAME =		${GH_PROJECT}-$V
d15 1
a15 1
HOMEPAGE =		http://martine.github.io/ninja/
@


1.18
log
@No need to run depends on python by default.
While here, fix shebang in the ninja_syntax.py script.

ok espie@@ matthew@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2015/10/05 08:52:10 dcoppa Exp $
d10 1
a10 1
V =			1.6.0
a14 1
REVISION =		0
@


1.17
log
@
Update to ninja-1.6.0

kudos to aja@@ for the bulk build
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2015/04/05 13:31:13 sthen Exp $
d15 1
d29 1
d32 1
@


1.16
log
@drop GH_COMMIT lines which are hidden behind GH_TAGNAME,
discussed with a few in the room.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2015/02/09 12:56:20 dcoppa Exp $
d10 1
a10 1
V =			1.5.3
a14 1
REVISION =		0
@


1.15
log
@
Verbose build; replace my cheap hack with the proper fix from
upstream:

commit 54d82356d8317a62f076eefdbe1ab62c88d1e6a6
Author: Ben Boeckel <mathstuf@@gmail.com>
Date:   Wed Dec 10 23:09:38 2014 -0500

configure: add a verbose mode

Required for Fedora infrastructure so that the commands used to build
ninja are logged.


While here, fix a typo in graph.cc: 'for for' -> 'for'
(upstream git commit 6ffb66d171a6962c2a7dad0492dffc42e65d666e)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2014/12/29 21:22:34 dcoppa Exp $
a13 1
GH_COMMIT =		3309498174411e02e7680ea8b470bb7d1d70bdb8
@


1.14
log
@
Update to ninja-1.5.3

No fallout in a bulk build
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2014/09/17 11:58:31 sthen Exp $
d16 1
d43 1
a43 1
	    --with-python=${MODPY_BIN}
@


1.13
log
@add a comment to re-enable USE_NINJA in cmake if m88k is fixed for ninja
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2014/09/16 19:56:09 miod Exp $
d10 1
a10 1
V =			1.5.1
d14 1
a14 1
GH_COMMIT =		85e13c163d0129216fb382df6a53d11393c4c0c2
d41 2
a42 1
	    ${MODPY_BIN} ./bootstrap.py --verbose
@


1.12
log
@Add a bunch of NOT_FOR_ARCHS and BROKEN- annotations, either for all gcc3
platforms (due to compiler deficiencies) or m88k only (due to toolchain
issues leading to libGL not being available).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2014/09/02 07:50:44 dcoppa Exp $
d4 2
a5 1
# (known toolchain problem)
@


1.11
log
@
Update to ninja-1.5.1

bulk build && ok landry@@
kde build && ok zhuk@@
ok matthew@@ (maintainer)
@
text
@d1 5
a5 1
# $OpenBSD: Makefile,v 1.10 2014/07/10 23:20:42 sthen Exp $
@


1.10
log
@revert revert now that bsd.port.mk can handle WRKDIST with GH_TAG=vXXX
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2014/07/10 11:06:15 rpe Exp $
d5 1
a5 1
V =			1.4.0
d9 1
a9 1
GH_COMMIT =		63d5b1013cafb2db95687cf446eb5bb68cf6a27a
@


1.9
log
@revert previous, req'd by espie
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2013/12/02 16:25:08 espie Exp $
d4 8
a11 2
GH_VER =		v1.4.0
DISTNAME =		ninja-${GH_VER:S/v//}
a20 3

MASTER_SITES =		https://github.com/martine/ninja/archive/
DISTFILES =		${DISTNAME}{${GH_VER}}${EXTRACT_SUFX}
@


1.8
log
@Move ports that used filename{url}sufx to fetch DISTFILES from
Github to GH_ACCOUNT, GH_PROJECT, GH_TAGNAME, GH_COMMIT.

OK sthen@@ jasper@@ aja@@
@
text
@d4 2
a5 8

V =			1.4.0
GH_ACCOUNT =		martine
GH_PROJECT =		ninja
GH_TAGNAME =		v$V
GH_COMMIT =		63d5b1013cafb2db95687cf446eb5bb68cf6a27a
DISTNAME =		${GH_PROJECT}-$V

d15 3
@


1.7
log
@remove redundancies with new filename{url}sufx scheme
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2013/11/12 15:00:25 sthen Exp $
d4 8
a11 2
GH_VER =		v1.4.0
DISTNAME =		ninja-${GH_VER:S/v//}
a20 3

MASTER_SITES =		https://github.com/martine/ninja/archive/
DISTFILES =		${DISTNAME}{${GH_VER}}${EXTRACT_SUFX}
@


1.6
log
@switch github MASTER_SITES urls with the query-string hack to using
DISTFILES=myfilename{theirfilename} type syntax, using a unified DISTFILES
line so they can later be merged.  ok rpe@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2013/10/16 05:52:46 dcoppa Exp $
d17 1
a17 1
DISTFILES =		${DISTNAME}${EXTRACT_SUFX}{${GH_VER}${EXTRACT_SUFX}}
@


1.5
log
@Update to ninja-1.4.0

Tested in different bulk builds by naddy@@, kili@@, etc.

ok kili@@, zhuk@@
maintainer timeout.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2013/07/02 06:37:24 jasper Exp $
d4 2
a5 2
V =			1.4.0
DISTNAME =		ninja-${V}
d16 2
a17 1
MASTER_SITES =		https://github.com/martine/ninja/archive/v${V}.tar.gz?bleh=/
@


1.4
log
@fix an unaligned mem access, which caused ninja's build to fail on strict
alignment arches.

tested by jturner@@ and me,
from and committing on behalf of matthew@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2013/06/14 16:39:39 matthew Exp $
d4 1
a4 1
V =			1.3.4
a5 1
REVISION =		0
@


1.3
log
@Update devel/ninja to v1.3.4.  Also, install asciidocs and
shell/editor integration scripts.

ok espie
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2013/05/21 16:06:52 matthew Exp $
d6 1
@


1.2
log
@Update devel/ninja to v1.3.3.

ok (and COMMENT tweak) dcoppa
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2013/05/02 19:09:18 matthew Exp $
d4 1
a4 1
V =			1.3.3
d36 8
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d3 2
a4 2
COMMENT =		a small build system with a focus on speed
V =			1.2.0
@


1.1.1.1
log
@Initial import of ninja, a simple build system with a focus on speed.

ok dcoppa, sthen

@
text
@@
