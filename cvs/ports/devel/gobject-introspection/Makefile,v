head	1.87;
access;
symbols
	OPENBSD_6_1:1.85.0.2
	OPENBSD_6_1_BASE:1.85
	OPENBSD_6_0:1.84.0.2
	OPENBSD_6_0_BASE:1.84
	OPENBSD_5_9:1.82.0.2
	OPENBSD_5_9_BASE:1.82
	OPENBSD_5_8:1.81.0.4
	OPENBSD_5_8_BASE:1.81
	OPENBSD_5_7:1.80.0.2
	OPENBSD_5_7_BASE:1.80
	OPENBSD_5_6:1.79.0.2
	OPENBSD_5_6_BASE:1.79
	OPENBSD_5_5:1.74.0.2
	OPENBSD_5_5_BASE:1.74
	OPENBSD_5_4:1.70.0.2
	OPENBSD_5_4_BASE:1.70
	OPENBSD_5_3:1.67.0.2
	OPENBSD_5_3_BASE:1.67
	OPENBSD_5_2:1.59.0.2
	OPENBSD_5_2_BASE:1.59
	OPENBSD_5_1_BASE:1.55
	OPENBSD_5_1:1.55.0.2
	OPENBSD_5_0:1.44.0.2
	OPENBSD_5_0_BASE:1.44
	OPENBSD_4_9:1.23.0.2
	OPENBSD_4_9_BASE:1.23
	OPENBSD_4_8:1.11.0.2
	OPENBSD_4_8_BASE:1.11
	OPENBSD_4_7:1.3.0.2
	OPENBSD_4_7_BASE:1.3
	jasper_20090924:1.1.1.1
	jasper:1.1.1;
locks; strict;
comment	@# @;


1.87
date	2017.09.25.09.16.12;	author robert;	state Exp;
branches;
next	1.86;
commitid	xOeDnABBxynvFYIF;

1.86
date	2017.04.13.07.05.37;	author jasper;	state Exp;
branches;
next	1.85;
commitid	sc1A384Si3MrzULF;

1.85
date	2016.10.29.08.47.42;	author jasper;	state Exp;
branches;
next	1.84;
commitid	19ft8J0TNIuuhrQv;

1.84
date	2016.04.26.15.54.59;	author jasper;	state Exp;
branches;
next	1.83;
commitid	7BLN6UOlPyPR5hPp;

1.83
date	2016.04.20.06.21.35;	author jasper;	state Exp;
branches;
next	1.82;
commitid	0afFv6AafDvwyoX2;

1.82
date	2015.09.28.12.02.01;	author jasper;	state Exp;
branches;
next	1.81;
commitid	MSFyPyOtr1cBbGMP;

1.81
date	2015.04.02.19.22.24;	author jasper;	state Exp;
branches;
next	1.80;
commitid	bCfHmiG8Tz9DGQp1;

1.80
date	2014.10.01.08.53.34;	author jasper;	state Exp;
branches;
next	1.79;
commitid	cxHtycTu7d2r6Q0N;

1.79
date	2014.04.08.17.23.41;	author ajacoutot;	state Exp;
branches;
next	1.78;

1.78
date	2014.03.26.08.29.11;	author jasper;	state Exp;
branches;
next	1.77;

1.77
date	2014.03.17.12.23.24;	author ajacoutot;	state Exp;
branches;
next	1.76;

1.76
date	2014.03.10.19.39.40;	author ajacoutot;	state Exp;
branches;
next	1.75;

1.75
date	2014.03.09.22.11.44;	author ajacoutot;	state Exp;
branches;
next	1.74;

1.74
date	2013.12.14.09.16.49;	author ajacoutot;	state Exp;
branches;
next	1.73;

1.73
date	2013.09.28.08.50.44;	author ajacoutot;	state Exp;
branches;
next	1.72;

1.72
date	2013.09.26.06.27.48;	author jasper;	state Exp;
branches;
next	1.71;

1.71
date	2013.08.15.14.53.11;	author ajacoutot;	state Exp;
branches;
next	1.70;

1.70
date	2013.03.28.19.32.11;	author jasper;	state Exp;
branches;
next	1.69;

1.69
date	2013.03.21.08.45.15;	author ajacoutot;	state Exp;
branches;
next	1.68;

1.68
date	2013.03.11.10.50.04;	author espie;	state Exp;
branches;
next	1.67;

1.67
date	2012.11.13.08.09.53;	author jasper;	state Exp;
branches;
next	1.66;

1.66
date	2012.10.17.19.43.34;	author jasper;	state Exp;
branches;
next	1.65;

1.65
date	2012.10.17.16.31.55;	author jasper;	state Exp;
branches;
next	1.64;

1.64
date	2012.10.17.16.29.30;	author jasper;	state Exp;
branches;
next	1.63;

1.63
date	2012.09.29.13.14.05;	author ajacoutot;	state Exp;
branches;
next	1.62;

1.62
date	2012.09.24.18.46.18;	author jasper;	state Exp;
branches;
next	1.61;

1.61
date	2012.09.21.13.19.40;	author jasper;	state Exp;
branches;
next	1.60;

1.60
date	2012.09.01.14.36.57;	author ajacoutot;	state Exp;
branches;
next	1.59;

1.59
date	2012.06.19.17.21.15;	author jasper;	state Exp;
branches;
next	1.58;

1.58
date	2012.04.18.08.41.58;	author jasper;	state Exp;
branches;
next	1.57;

1.57
date	2012.03.29.07.46.17;	author ajacoutot;	state Exp;
branches;
next	1.56;

1.56
date	2012.03.29.06.29.08;	author ajacoutot;	state Exp;
branches;
next	1.55;

1.55
date	2011.11.18.11.11.33;	author jasper;	state Exp;
branches;
next	1.54;

1.54
date	2011.11.17.15.51.47;	author jasper;	state Exp;
branches;
next	1.53;

1.53
date	2011.11.17.11.39.49;	author jasper;	state Exp;
branches;
next	1.52;

1.52
date	2011.09.30.07.47.58;	author jasper;	state Exp;
branches;
next	1.51;

1.51
date	2011.09.28.09.51.35;	author jasper;	state Exp;
branches;
next	1.50;

1.50
date	2011.09.21.14.03.50;	author jasper;	state Exp;
branches;
next	1.49;

1.49
date	2011.09.21.13.59.21;	author jasper;	state Exp;
branches;
next	1.48;

1.48
date	2011.09.20.21.04.24;	author jasper;	state Exp;
branches;
next	1.47;

1.47
date	2011.09.20.20.51.51;	author jasper;	state Exp;
branches;
next	1.46;

1.46
date	2011.09.16.09.24.49;	author espie;	state Exp;
branches;
next	1.45;

1.45
date	2011.09.12.12.07.25;	author jasper;	state Exp;
branches;
next	1.44;

1.44
date	2011.07.11.14.04.42;	author jasper;	state Exp;
branches;
next	1.43;

1.43
date	2011.06.28.10.41.48;	author ajacoutot;	state Exp;
branches;
next	1.42;

1.42
date	2011.06.14.13.53.30;	author sebastia;	state Exp;
branches;
next	1.41;

1.41
date	2011.06.08.17.40.08;	author jasper;	state Exp;
branches;
next	1.40;

1.40
date	2011.06.06.18.15.52;	author ajacoutot;	state Exp;
branches;
next	1.39;

1.39
date	2011.05.20.13.33.53;	author ajacoutot;	state Exp;
branches;
next	1.38;

1.38
date	2011.05.16.15.14.00;	author ajacoutot;	state Exp;
branches;
next	1.37;

1.37
date	2011.05.14.20.24.02;	author ajacoutot;	state Exp;
branches;
next	1.36;

1.36
date	2011.05.14.11.22.12;	author ajacoutot;	state Exp;
branches;
next	1.35;

1.35
date	2011.05.13.22.18.34;	author ajacoutot;	state Exp;
branches;
next	1.34;

1.34
date	2011.04.27.12.53.01;	author ajacoutot;	state Exp;
branches;
next	1.33;

1.33
date	2011.04.25.11.43.17;	author jasper;	state Exp;
branches;
next	1.32;

1.32
date	2011.04.07.16.16.21;	author ajacoutot;	state Exp;
branches;
next	1.31;

1.31
date	2011.04.07.15.09.58;	author jasper;	state Exp;
branches;
next	1.30;

1.30
date	2011.04.07.14.50.22;	author ajacoutot;	state Exp;
branches;
next	1.29;

1.29
date	2011.04.07.11.09.06;	author ajacoutot;	state Exp;
branches;
next	1.28;

1.28
date	2011.04.07.09.57.18;	author jasper;	state Exp;
branches;
next	1.27;

1.27
date	2011.04.07.09.38.12;	author jasper;	state Exp;
branches;
next	1.26;

1.26
date	2011.04.07.09.28.32;	author jasper;	state Exp;
branches;
next	1.25;

1.25
date	2011.03.30.17.53.29;	author jasper;	state Exp;
branches;
next	1.24;

1.24
date	2011.03.02.06.35.23;	author jasper;	state Exp;
branches;
next	1.23;

1.23
date	2011.01.13.08.08.47;	author jasper;	state Exp;
branches;
next	1.22;

1.22
date	2010.12.23.14.34.49;	author jasper;	state Exp;
branches;
next	1.21;

1.21
date	2010.11.15.19.45.58;	author espie;	state Exp;
branches;
next	1.20;

1.20
date	2010.10.27.13.09.35;	author jasper;	state Exp;
branches;
next	1.19;

1.19
date	2010.10.25.11.39.59;	author steven;	state Exp;
branches;
next	1.18;

1.18
date	2010.10.24.15.33.14;	author jasper;	state Exp;
branches;
next	1.17;

1.17
date	2010.10.24.13.40.27;	author jasper;	state Exp;
branches;
next	1.16;

1.16
date	2010.10.18.17.47.53;	author espie;	state Exp;
branches;
next	1.15;

1.15
date	2010.10.11.08.12.30;	author jasper;	state Exp;
branches;
next	1.14;

1.14
date	2010.09.07.11.39.12;	author jasper;	state Exp;
branches;
next	1.13;

1.13
date	2010.08.30.22.03.58;	author jasper;	state Exp;
branches;
next	1.12;

1.12
date	2010.08.26.08.01.44;	author ajacoutot;	state Exp;
branches;
next	1.11;

1.11
date	2010.07.30.05.49.24;	author ajacoutot;	state Exp;
branches;
next	1.10;

1.10
date	2010.06.12.17.02.27;	author steven;	state Exp;
branches;
next	1.9;

1.9
date	2010.05.01.09.10.00;	author ajacoutot;	state Exp;
branches;
next	1.8;

1.8
date	2010.04.28.17.15.45;	author jasper;	state Exp;
branches;
next	1.7;

1.7
date	2010.04.28.10.10.44;	author jasper;	state Exp;
branches;
next	1.6;

1.6
date	2010.04.20.11.36.37;	author jasper;	state Exp;
branches;
next	1.5;

1.5
date	2010.04.20.11.20.08;	author jasper;	state Exp;
branches;
next	1.4;

1.4
date	2010.03.29.15.17.10;	author jasper;	state Exp;
branches;
next	1.3;

1.3
date	2009.12.22.15.19.52;	author ajacoutot;	state Exp;
branches;
next	1.2;

1.2
date	2009.11.12.21.48.18;	author jasper;	state Exp;
branches;
next	1.1;

1.1
date	2009.09.24.20.08.09;	author jasper;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2009.09.24.20.08.09;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.87
log
@Unbreak autoconf checks with clang by not using nested functions
in the checks.

Someone clearly did not read the autoconf documentation because
using the following functions with a function declaration inside
the body will end up declaring a function inside a function.

- AC_TRY_COMPILE( [], [ int main() { return 0; } ],
- AC_LANG_PROGRAM([[]], [[int main (void) { return 0; }]])],
- AC_TRY_LINK([], [int main (void) { return 0; }],

Result:

int
main ()
{
int main (void) { return 0; }
  ;
  return 0;
}

nested functions is a gcc extension which is not supported by
clang.

test.c:4:17: error: function definition is not allowed here
int main (void) { return 0; }
                ^
1 error generated.

This causes tests to fail in the configure scripts resulting in
missing compile and link time flags from the builds.

This resulted in weird behaviour of several software, like gnome
hanging completely due to gtk+3 not being built properly.

This change intrudces the following fixes:

- remove int main() declaration from AC_TRY_COMPILE, AC_LANG_PROGRAM, AC_TRY_LINK
  as it comes with a declaration already, and people misused them

- change to use AC_LANG_SOURCE when needed in case a complete source block is specified

Most of the changes are in configure.(ac|in), however there were some cases
where autoconf is either broken or the build failed because of an autoconf
generated configure script. Everytihng else is switched to autoconf, so
the maintainers can go ahead and upstream these diffs.

There are more to come, we are continously checking the tree for these issues
and in the future the infrastructure will error if such a case is found.
@
text
@# $OpenBSD: Makefile,v 1.86 2017/04/13 07:05:37 jasper Exp $

COMMENT=		GObject Introspection

GNOME_VERSION=		1.52.1
GNOME_PROJECT=		gobject-introspection

REVISION=		0

CATEGORIES=		devel

SHARED_LIBS +=  girepository-1.0     3.0      # 1.1

MAINTAINER=		Jasper Lievisse Adriaanse <jasper@@openbsd.org>, \
			Antoine Jacoutot <ajacoutot@@openbsd.org>

# Library: LGPLv2+
# Tools: GPLv2+
PERMIT_PACKAGE_CDROM=	Yes

MODULES=		lang/python \
			x11/gnome

WANTLIB += c ffi gio-2.0 glib-2.0 gmodule-2.0 gobject-2.0 iconv
WANTLIB += intl m pcre pthread z

LIB_DEPENDS=		devel/glib2

BUILD_DEPENDS=		devel/bison \
			graphics/cairo \
			www/py-mako

RUN_DEPENDS=		graphics/cairo \
			www/py-mako

# XXX: tests/scanner/test_transformer.py fails otherwise
TEST_DEPENDS+=		textproc/gsed

YACC=			bison

AUTOCONF_VERSION=	2.69
CONFIGURE_STYLE=	autoconf

post-install:
	rm ${PREFIX}/lib/gobject-introspection/giscanner/*.{a,la}

# XXX: tidy-up some GNU-isms; see above.
pre-test:
	sed -i 's,\"sed ,\"gsed ,g' ${WRKSRC}/tests/scanner/test_transformer.py

.include <bsd.port.mk>
@


1.86
log
@update to gobject-introspection-1.52.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.85 2016/10/29 08:47:42 jasper Exp $
d8 2
d41 2
a42 1
CONFIGURE_STYLE=	gnu
@


1.85
log
@update to goject-introspection-1.50.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.84 2016/04/26 15:54:59 jasper Exp $
d5 1
a5 1
GNOME_VERSION=		1.50.0
@


1.84
log
@Replace -B GNUism wit portable -I-equivalent and drop gdiff TDEP
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.83 2016/04/20 06:21:35 jasper Exp $
d5 1
a5 1
GNOME_VERSION=		1.48.0
@


1.83
log
@- update to gobject-introspection-1.48.0

this and the upcoming vala update were tested in a bulk by aja@@, thanks!
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.82 2015/09/28 12:02:01 jasper Exp $
a33 2
# XXX: gi-tester uses "-B" (--ignore-blank-lines)
TEST_DEPENDS=		textproc/gdiff
a45 1
	sed -i 's,^\([ \t]*\)diff,\1gdiff,' ${WRKSRC}/tests/gi-tester
@


1.82
log
@update to gobject-introspection-1.46.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.81 2015/04/02 19:22:24 jasper Exp $
d5 1
a5 1
GNOME_VERSION=		1.46.0
d19 1
a19 2
MODULES=		devel/gettext \
			lang/python \
d22 2
a23 1
WANTLIB += c ffi gio-2.0 glib-2.0 gmodule-2.0 gobject-2.0 m pcre pthread z
d34 5
d45 5
@


1.81
log
@update to gobject-introspection-1.44.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.80 2014/10/01 08:53:34 jasper Exp $
d5 1
a5 1
GNOME_VERSION=		1.44.0
@


1.80
log
@- update to gobject-introspecion-1.42.0

ok aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.79 2014/04/08 17:23:41 ajacoutot Exp $
d5 1
a5 1
GNOME_VERSION=		1.42.0
@


1.79
log
@Drop local path that forces libtool path.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.78 2014/03/26 08:29:11 jasper Exp $
d5 1
a5 1
GNOME_VERSION=		1.40.0
a6 1
REVISION=		0
d10 1
a10 1
SHARED_LIBS +=  girepository-1.0     3.0      # 1.0
@


1.78
log
@update to gobject-introspection-1.40.0

ok aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.77 2014/03/17 12:23:24 ajacoutot Exp $
d7 1
@


1.77
log
@Slighly modified version of the libtool patch and add BZ URL.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.76 2014/03/10 19:39:40 ajacoutot Exp $
d5 1
a5 1
GNOME_VERSION=		1.38.0
a6 1
REVISION=		4
@


1.76
log
@This patch is still needed after all for the old gstreamer plugins-base.
I missed that when testing other g-o-i ports... my bad.
I am working with upstream to find a final solution to this.

breakage reported by espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.75 2014/03/09 22:11:44 ajacoutot Exp $
d7 1
a7 1
REVISION=		3
@


1.75
log
@Remove now uneeded LIBTOOL patch.
Drop uneeded MODPY_ADJ_FILES.
Missing dep on py-mako.

ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.74 2013/12/14 09:16:49 ajacoutot Exp $
d7 1
a7 1
REVISION=		2
@


1.74
log
@Merge some patches from upstream and remove some local modifications:
- if CC is not set, fall back to cc
- do not forcibly add ${X11BASE}/include nor ${LOCALBASE}/include, now
the scanner is supposed to properly pass CFLAGS
- forcing -pthread should not be needed anymore

Tested with a handful of ports that were known to need these tweaks.
Any regression, please let me know directly.

ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.73 2013/09/28 08:50:44 ajacoutot Exp $
d7 1
a7 1
REVISION=		1
d27 1
d29 2
a30 2
			graphics/cairo
RUN_DEPENDS=		graphics/cairo
d32 2
a33 1
USE_GROFF =		Yes
a37 5

MODPY_ADJ_FILES=	giscanner/scannermain.py \
			giscanner/shlibs.py \
			giscanner/message.py \
			tests/offsets/gen-gitestoffsets
@


1.73
log
@Remove hardcoded HOMEPAGE and use the one from the x11/gnome MODULE
instead. It is just too hard to maintain a coherent list of still
reachable homepages for GNOME projects so use wiki.gnome.org which is
the entry point for *all* GNOME apps.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.72 2013/09/26 06:27:48 jasper Exp $
d7 1
a7 1
REVISION=		0
d26 1
a26 1
LIB_DEPENDS=		devel/glib2>=2.34.1
a36 4
CFLAGS+=		-pthread

SUBST_VARS+=		MODPY_SITEPKG CC

a40 3

pre-configure:
	${SUBST_CMD} ${WRKSRC}/giscanner/{dumper,scannermain,sourcescanner}.py
@


1.72
log
@- update to gobject-introspection-1.38.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.71 2013/08/15 14:53:11 ajacoutot Exp $
d7 1
a14 2

HOMEPAGE=		http://live.gnome.org/GObjectIntrospection
@


1.71
log
@Remove, we have 64-bit time_t.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.70 2013/03/28 19:32:11 jasper Exp $
d5 1
a5 1
GNOME_VERSION=		1.36.0
a6 1
REVISION=		0
@


1.70
log
@- update to gobject-introspection 1.36.0

ok aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.69 2013/03/21 08:45:15 ajacoutot Exp $
d7 1
@


1.69
log
@USE_LIBTOOL=Yes is the default now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.68 2013/03/11 10:50:04 espie Exp $
d5 1
a5 1
GNOME_VERSION=		1.34.2
d25 1
a25 2
WANTLIB += c ffi gio-2.0 glib-2.0 gmodule-2.0 gobject-2.0 gthread-2.0
WANTLIB += m pcre pthread z
@


1.68
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.67 2012/11/13 08:09:53 jasper Exp $
a32 1
USE_LIBTOOL=		Yes
@


1.67
log
@- update to gobject-introspection-1.34.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.66 2012/10/17 19:43:34 jasper Exp $
a19 3
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM= Yes
PERMIT_DISTFILES_FTP=	Yes
@


1.66
log
@- fixup LIB_DEPENDS
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.65 2012/10/17 16:31:55 jasper Exp $
d5 1
a5 1
GNOME_VERSION=		1.34.1.1
a6 1
REVISION=		0
@


1.65
log
@- update to 1.34.1.1..
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.64 2012/10/17 16:29:30 jasper Exp $
d7 1
d32 1
a32 1
LIB_DEPENDS=		devel/glib2>=2.33.14
@


1.64
log
@- update to 1.34.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.63 2012/09/29 13:14:05 ajacoutot Exp $
d5 1
a5 1
GNOME_VERSION=		1.34.1
@


1.63
log
@@@comment -> post-install rm
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62 2012/09/24 18:46:18 jasper Exp $
d5 1
a5 1
GNOME_VERSION=		1.34.0
a6 1
REVISION=		0
@


1.62
log
@- bump to 1.34.0; no real change since the previous development release.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.61 2012/09/21 13:19:40 jasper Exp $
d7 2
d55 3
@


1.61
log
@- update to 1.33.14
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.60 2012/09/01 14:36:57 ajacoutot Exp $
d5 1
a5 1
GNOME_VERSION=		1.33.14
@


1.60
log
@register-plist did not catch the devel/glib2 -main -> empty change.
espie asked me in such a nice way to fix this that I'm bumping all ports
that have a direct dependency on glib2.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59 2012/06/19 17:21:15 jasper Exp $
d5 1
a5 1
GNOME_VERSION=		1.32.1
a6 1
REVISION=		1
d30 1
a30 1
LIB_DEPENDS=		devel/glib2>=2.32.0
@


1.59
log
@Adjust now that libtool lives in base

ok aja@@ (who came up with the same goi diff)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2012/04/18 08:41:58 jasper Exp $
d7 1
a7 1
REVISION=		0
@


1.58
log
@- update to 1.32.1
* various bugfixes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.57 2012/03/29 07:46:17 ajacoutot Exp $
d7 1
@


1.57
log
@Update to stable gobject-introspection-1.32.0.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2012/03/29 06:29:08 ajacoutot Exp $
d5 1
a5 1
GNOME_VERSION=		1.32.0
@


1.56
log
@Update to gobject-introspection-1.31.22.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55 2011/11/18 11:11:33 jasper Exp $
d5 1
a5 1
GNOME_VERSION=		1.31.22
@


1.55
log
@Adjust patch a bit with upstream feedback
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.54 2011/11/17 15:51:47 jasper Exp $
d5 1
a5 1
GNOME_VERSION=		1.30.0
a6 1
REVISION=		4
d9 1
a9 1
SHARED_LIBS +=  girepository-1.0     2.0      # 1.0
d30 1
a30 2
LIB_DEPENDS=		devel/glib2>=2.29.7 \
			devel/libffi
@


1.54
log
@Adjust a bit to make it committable upstream.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2011/11/17 11:39:49 jasper Exp $
d7 1
a7 1
REVISION=		3
@


1.53
log
@*Finally* fix the issue where certain ports using GI and our ports libtool
would fail to build and had to switch to gnu libtool.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.52 2011/09/30 07:47:58 jasper Exp $
d7 1
a7 1
REVISION=		2
@


1.52
log
@- fix CAIRO_SHARED_LIBRARY
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 2011/09/28 09:51:35 jasper Exp $
d7 1
a7 1
REVISION=		1
@


1.51
log
@sync after recent gnome.port.mk CONFIGURE_ENV changes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2011/09/21 14:03:50 jasper Exp $
d7 1
a7 1
REVISION=		0
@


1.50
log
@i made you a diff, but cvs eated it.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2011/09/21 13:59:21 jasper Exp $
a42 2
CONFIGURE_ENV=		CPPFLAGS="-I${LOCALBASE}/include" \
			LDFLAGS="-L${LOCALBASE}/lib"
@


1.49
log
@- update to 1.30.0

there is some known fallout, which we're working on.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2011/09/20 21:04:24 jasper Exp $
d7 1
@


1.48
log
@CONFIGURE_SHARED is now implied by gnome.port.mk, so no need to make it explicit anymore.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2011/09/20 20:51:51 jasper Exp $
d5 1
a5 1
GNOME_VERSION=		0.10.8
d9 1
a9 3
REVISION=		9

SHARED_LIBS +=  girepository-1.0     1.0      # 1.0
a22 2
EXTRACT_SUFX=		.tar.bz2

d30 1
a30 1
LIB_DEPENDS=		devel/glib2>=2.28.8p0 \
@


1.47
log
@switch to MODGNOME_TOOLS
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2011/09/16 09:24:49 espie Exp $
a45 1
CONFIGURE_ARGS+=	${CONFIGURE_SHARED}
@


1.46
log
@normalize pkgpath
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2011/09/12 12:07:25 jasper Exp $
d46 1
a46 2
CONFIGURE_ARGS+=	${CONFIGURE_SHARED} \
			--disable-gtk-doc
@


1.45
log
@switch the rest of the ports using gnome.port.mk over to .tar.xz where applicable.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2011/07/11 14:04:42 jasper Exp $
d9 1
a9 1
REVISION=		8
@


1.44
log
@no need to keep using the gcc3 module on sparc

from brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2011/06/28 10:41:48 ajacoutot Exp $
d24 2
@


1.43
log
@Remove now useless patch.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2011/06/14 13:53:30 sebastia Exp $
d9 1
a9 1
REVISION=		7
d27 1
a27 3
			x11/gnome \
			gcc3
MODGCC3_ARCHES =        sparc
@


1.42
log
@Use gcc3 module on sparc.

OK jasper@@, ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2011/06/08 17:40:08 jasper Exp $
d9 1
a9 1
REVISION=		6
d34 1
a34 1
LIB_DEPENDS=		devel/glib2 \
@


1.41
log
@bump after default python version switch
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2011/06/06 18:15:52 ajacoutot Exp $
d27 3
a29 1
			x11/gnome
@


1.40
log
@Set CAIRO_SHARED_LIBRARY is a somewhat less ugly way.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2011/05/20 13:33:53 ajacoutot Exp $
d9 1
a9 1
REVISION=		5
@


1.39
log
@Ugly hack to fix CAIRO_SHARED_LIBRARY. I'll need to revisit this soon.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2011/05/16 15:14:00 ajacoutot Exp $
d9 1
a9 1
REVISION=		4
a51 3

# XXX ugly
MAKE_FLAGS=		CAIRO_SHARED_LIBRARY=libcairo-gobject.so.0.0
@


1.38
log
@Remove LIBTOOL from SUBST_VARS.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2011/05/14 20:24:02 ajacoutot Exp $
d9 1
a9 1
REVISION=		3
d52 3
@


1.37
log
@Be safe with the subsitution, we want to cc -> $CC only when cc means
cc(1).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2011/05/14 11:22:12 ajacoutot Exp $
d51 1
a51 1
SUBST_VARS+=		MODPY_SITEPKG LIBTOOL CC
@


1.36
log
@Install files where they belong too (i.e. don't move out from default).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2011/05/13 22:18:34 ajacoutot Exp $
d9 1
a9 1
REVISION=		2
d59 1
a59 3
	${SUBST_CMD} ${WRKSRC}/giscanner/dumper.py \
		${WRKSRC}/giscanner/scannermain.py
	perl -pi -e "s,'cc','${CC}'," ${WRKSRC}/giscanner/sourcescanner.py
@


1.35
log
@Don't install static lib and libtool file for modules.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2011/04/27 12:53:01 ajacoutot Exp $
d9 1
a9 1
REVISION=		1
d60 1
a60 2
		${WRKSRC}/giscanner/scannermain.py \
		${WRKSRC}/tools/g-ir-scanner.in
@


1.34
log
@Use MODPY_ADJ_FILES to remove the 'env python' stuffs...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2011/04/25 11:43:17 jasper Exp $
d9 1
a9 1
REVISION=		0
@


1.33
log
@- update to 0.10.8

ok aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2011/04/07 16:16:21 ajacoutot Exp $
d9 2
d52 5
@


1.32
log
@Remove now unneeded patches.

ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2011/04/07 15:09:58 jasper Exp $
d5 1
a5 1
GNOME_VERSION=		0.10.7
a6 1
REVISION=		4
@


1.31
log
@- tweak the way we depend on cairo, it's just a build/run dependency now.

ok aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2011/04/07 14:50:22 ajacoutot Exp $
d53 1
a53 3
	${SUBST_CMD} ${WRKSRC}/Makefile.in \
		${WRKSRC}/Makefile.introspection \
		${WRKSRC}/giscanner/dumper.py \
a54 2
		${WRKSRC}/tests/scanner/Makefile.in \
		${WRKSRC}/tests/offsets/Makefile.in \
@


1.30
log
@Re-enable tests now that they work on sparc64. This allows use to generate
regress.c amongst other things.

ok jasper@@
@
text
@d1 1
a1 4
# $OpenBSD: Makefile,v 1.29 2011/04/07 11:09:06 ajacoutot Exp $

# XXX Look at cairo-related regression failure
# and cairo/cairo.h: No such file or directory during build.
d7 1
a7 1
REVISION=		3
d28 2
a29 4
WANTLIB += X11 Xau Xdmcp Xrender c expat fontconfig freetype
WANTLIB += m pcre pixman-1 png pthread pthread-stubs xcb xcb-render
WANTLIB += xcb-render-util z gio-2.0 glib-2.0 gmodule-2.0 ffi
WANTLIB += gobject-2.0 gthread-2.0 cairo
d32 2
a33 1
			devel/libffi \
d35 1
a35 1
BUILD_DEPENDS=		devel/bison
@


1.29
log
@Get LIBTOOL from the environment so that we can choose between our libtool
or the gnu one (default to our libtool).

ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2011/04/07 09:57:18 jasper Exp $
d3 1
a3 1
# Look at cairo-related regression failure.
a4 2
#
# Look at re-entering tests/.
d10 1
a10 1
REVISION=		2
@


1.28
log
@- don't override ${CC} with gcc.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2011/04/07 09:38:12 jasper Exp $
d12 1
a12 1
REVISION=		1
a62 1
		${WRKSRC}/giscanner/utils.py \
@


1.27
log
@- prime the scanner to search in ${X11BASE}/include and ${LOCALBASE}/include

ok aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2011/04/07 09:28:32 jasper Exp $
d12 1
a12 1
REVISION=		0
d56 1
a56 1
SUBST_VARS+=		MODPY_SITEPKG LIBTOOL
d61 1
@


1.26
log
@- update to 0.10.7

ok aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2011/03/30 17:53:29 jasper Exp $
d12 1
d61 1
@


1.25
log
@- bugfix update of gobject-introspection to 0.10.6
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2011/03/02 06:35:23 jasper Exp $
d10 1
a10 1
GNOME_VERSION=		0.10.6
@


1.24
log
@- update gobject-introspection to 0.10.3
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2011/01/13 08:08:47 jasper Exp $
d10 1
a10 1
GNOME_VERSION=		0.10.3
@


1.23
log
@- bugfix update gobject-introspection to 0.10.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2010/12/23 14:34:49 jasper Exp $
d10 1
a10 1
GNOME_VERSION=		0.10.1
@


1.22
log
@- update gobject-introspection to 0.10.0

ok aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2010/11/15 19:45:58 espie Exp $
d10 1
a10 1
GNOME_VERSION=		0.10.0
@


1.21
log
@move depends to new style
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2010/10/27 13:09:35 jasper Exp $
d10 1
a10 1
GNOME_VERSION=		0.9.12
a11 1
REVISION=		1
d58 2
a59 2
	${SUBST_CMD} ${WRKSRC}/Makefile.introspection \
		${WRKSRC}/gir/Makefile.in \
@


1.20
log
@- this can use our libtool now, prompted by steven.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2010/10/25 11:39:59 steven Exp $
d38 4
a41 4
LIB_DEPENDS=		::devel/glib2 \
			::devel/libffi \
			::graphics/cairo
BUILD_DEPENDS=		::devel/bison
@


1.19
log
@indicate reason for gnu libtool
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2010/10/24 15:33:14 jasper Exp $
d12 1
a12 1
REVISION=		0
a15 1
#SHARED_LIBS +=	everything-1.0      0.0          # .0.0
d43 1
a43 2
# weird libtool use by some python script
USE_LIBTOOL=		gnu
@


1.18
log
@- improve handling libtool a bit better
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2010/10/24 13:40:27 jasper Exp $
d44 1
@


1.17
log
@- update gobject-introspection to 0.9.12 (development release needed by folks)

teeth-grindingly ok'd by aja
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2010/10/18 17:47:53 espie Exp $
d12 1
d62 1
@


1.16
log
@USE_GROFF=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2010/10/11 08:12:30 jasper Exp $
d5 2
d10 1
a10 1
GNOME_VERSION=		0.6.14
a11 3

REVISION=		3

d14 2
a15 3
SHARED_LIBS +=  girepository-1.0     0.0      # .0.0
SHARED_LIBS +=  girepository-everything-1.0 0.0      # .1.0
SHARED_LIBS +=  girepository-gimarshallingtests-1.0 0.0      # .1.0
d44 1
a44 1
USE_GROFF =	Yes
d63 1
a63 2
		${WRKSRC}/tools/g-ir-scanner.in \
		${WRKSRC}/gir/Everything-1.0-expected.gir
@


1.15
log
@- fix WANTLIB after cairo update.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2010/09/07 11:39:12 jasper Exp $
d46 1
@


1.14
log
@- slightly improve the situation on sparc64:
* extend the DO_ALIGNED_COPY usage from girnode.c into ginfo.c
(freebsd seems to do the same)
* skips tests/scanner/ as opensolaris and several other distributions do,
this prevents g-ir-repository SIGBUSing there and allows the build to succeed.

it's not really a great improvement (apart from ginfo.c patch), but at least
it allows things to move forward, and gobject-introspection isn't enabled yet
in other ports.

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2010/08/30 22:03:58 jasper Exp $
d11 1
a11 1
REVISION=		2
d35 1
a35 1
WANTLIB += X11 Xau Xdmcp Xrender c expat fontconfig freetype glitz
@


1.13
log
@- first round of bumps for devel
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2010/08/26 08:01:44 ajacoutot Exp $
d11 1
a11 1
REVISION=		1
@


1.12
log
@Don't hardcode "cc" in sourcescanner.py.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2010/07/30 05:49:24 ajacoutot Exp $
d11 1
a11 1
REVISION=		0
@


1.11
log
@Update to gobject-introspection-0.6.14.

hobbits take maintainership.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2010/06/12 17:02:27 steven Exp $
d11 2
d66 1
@


1.10
log
@use gnu libtool
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2010/04/28 17:15:45 jasper Exp $
d8 1
a8 1
GNOME_VERSION=		0.6.10
d10 1
a10 1
PKGNAME=		${DISTNAME}p0
d17 3
d35 2
a36 1
WANTLIB += xcb-render-util z
d38 3
a40 3
LIB_DEPENDS=		gio-2.0,glib-2.0,gmodule-2.0,gobject-2.0,gthread-2.0::devel/glib2 \
			ffi::devel/libffi \
			cairo::graphics/cairo
@


1.9
log
@Don't use SUBST_CMD on non existing files.
@
text
@d39 1
a39 1
USE_LIBTOOL=		Yes
@


1.8
log
@hmm, forgot to bump
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2010/04/28 10:10:44 jasper Exp $
a52 3
SUBST_SO=	gir/GLib-2.0.gir gir/GObject-2.0.gir gir/GModule-2.0 \
		gir/Gio-2.0.gir

a59 3
.for i in  ${SUBST_SO}
	perl -pi -e 's,\.so\.[0-9],\.so,g' ${WRKSRC}/${i}
.endfor
@


1.7
log
@- fix lib depends and regen wantlib
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2010/04/20 11:36:37 jasper Exp $
d10 1
@


1.6
log
@- add reminder comment
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2010/04/20 11:20:08 jasper Exp $
d4 1
d29 7
a35 4
WANTLIB += c pcre pthread

LIB_DEPENDS=		gio-2.0,glib-2.0,gmodule-2.0,gobject-2.0::devel/glib2 \
			ffi::devel/libffi
@


1.5
log
@- update gobject-introspection to 0.6.10
* this seems to be making sparc64 quite a bit less sad.
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.4 2010/03/29 15:17:10 jasper Exp $
@


1.4
log
@- update gobject-introspection to 0.6.9...still badly broken on sparc64.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2009/12/22 15:19:52 ajacoutot Exp $
d5 1
a5 1
GNOME_VERSION=		0.6.9
d9 3
a11 2
SHARED_LIBS +=  girepository-1.0        0.0      # .0.0
SHARED_LIBS +=  girepository-everything-1.0        0.0  # .1.0
@


1.3
log
@Update to gobject-introspection-0.6.7.

ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2009/11/12 21:48:18 jasper Exp $
d5 1
a5 1
GNOME_VERSION=		0.6.7
a53 2
		${WRKSRC}/gir/GIRepository-2.0.gir \
		${WRKSRC}/gir/Everything-1.0.gir \
@


1.2
log
@Prevent redefinition of ALIGN in giroffsets.c, doesn't fix sparc64 build though..
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2009/09/24 20:08:09 jasper Exp $
d5 1
a5 1
GNOME_VERSION=		0.6.5
a6 1
PKGNAME=		${DISTNAME}p0
d25 1
a25 1
WANTLIB += c pcre
d41 6
a46 1
SUBST_VARS+=		MODPY_SITEPKG
a47 1
# Ugly hack to fix build. See upstream Bugzilla #596224.
d49 11
a59 3
	${SUBST_CMD} ${WRKSRC}/gir/Makefile.in \
		${WRKSRC}/giscanner/Makefile.in \
		${WRKSRC}/tools/g-ir-scanner.in
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d7 1
@


1.1.1.1
log
@import gobject-introspection 0.6.5

GObject Introspection is a project for providing machine readable
introspection data of the API of C libraries. This introspection data
can be used in several different use cases, for example automatic code
generation for bindings, API verification and documentation generation.

feedback and ok ajacoutot@@ landry@@
@
text
@@
