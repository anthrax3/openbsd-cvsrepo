head	1.5;
access;
symbols
	OPENBSD_4_0:1.4.0.6
	OPENBSD_4_0_BASE:1.4
	OPENBSD_3_9:1.4.0.4
	OPENBSD_3_9_BASE:1.4
	OPENBSD_3_8:1.4.0.2
	OPENBSD_3_8_BASE:1.4
	OPENBSD_3_7:1.3.0.2
	OPENBSD_3_7_BASE:1.3
	OPENBSD_3_6:1.1.0.2
	OPENBSD_3_6_BASE:1.1;
locks; strict;
comment	@# @;


1.5
date	2007.01.18.19.31.34;	author jasper;	state dead;
branches;
next	1.4;

1.4
date	2005.05.25.23.28.16;	author marcm;	state Exp;
branches;
next	1.3;

1.3
date	2004.12.11.17.41.53;	author marcm;	state Exp;
branches;
next	1.2;

1.2
date	2004.12.10.20.33.59;	author marcm;	state Exp;
branches;
next	1.1;

1.1
date	2004.08.01.06.06.35;	author marcm;	state Exp;
branches;
next	;


desc
@@


1.5
log
@update libgtop2 to 2.14.6

based on work by Alexander Wirt <alexander.wirt@@credativ.de>

ok ajacoutot@@
@
text
@--- sysdeps/freebsd/cpu.c.orig	Tue Mar  1 15:03:57 2005
+++ sysdeps/freebsd/cpu.c	Mon Apr 11 19:56:33 2005
@@@@ -27,7 +27,7 @@@@
 
 #include <glibtop_suid.h>
 
-#ifdef __NetBSD__
+#ifdef __NetBSD__ || defined(__OpenBSD__)
 #include <sys/sched.h>
 #endif
 
@@@@ -37,7 +37,7 @@@@ static const unsigned long _glibtop_sysd
 (1L << GLIBTOP_CPU_IDLE) + (1L << GLIBTOP_CPU_FREQUENCY) +
 (1L << GLIBTOP_CPU_IOWAIT);
 
-#ifndef KERN_CP_TIME
+#if !defined(KERN_CP_TIME) && !defined(KERN_CPTIME)
 /* nlist structure for kernel access */
 static struct nlist nlst [] = {
 #ifdef __bsdi__
@@@@ -55,13 +55,16 @@@@ static int mib [] = { CTL_KERN, KERN_CLO
 #ifdef KERN_CP_TIME
 static int mib2 [] = { CTL_KERN, KERN_CP_TIME };
 #endif
+#ifdef KERN_CPTIME
+static int mib2 [] = { CTL_KERN, KERN_CPTIME };
+#endif
 
 /* Init function. */
 
 void
 glibtop_init_cpu_p (glibtop *server)
 {
-#ifndef KERN_CP_TIME
+#if !defined(KERN_CP_TIME) && !defined(KERN_CPTIME)
 	if (kvm_nlist (server->machine.kd, nlst) < 0) {
 		glibtop_warn_io_r (server, "kvm_nlist (cpu)");
 		return;
@@@@ -94,7 +97,7 @@@@ glibtop_get_cpu_p (glibtop *server, glib
 	if (server->sysdeps.cpu == 0)
 		return;
 
-#ifdef KERN_CP_TIME
+#if defined(KERN_CP_TIME) || defined(KERN_CPTIME)
 	length = sizeof (cpts);
 	if (sysctl (mib2, mib_length, cpts, &length, NULL, 0)) {
 		glibtop_warn_io_r (server, "sysctl");
@


1.4
log
@Up to 2.10.1 for Gnome 2.10.1.
@
text
@@


1.3
log
@CVS wasn't kind to this commit :).  Remove the zero length patches,
fix another patch that was lost in the update, oh and what the heck
update the version again.
@
text
@d1 2
a2 2
--- sysdeps/freebsd/cpu.c.orig	Sun Jul 18 13:33:56 2004
+++ sysdeps/freebsd/cpu.c	Fri Dec 10 19:15:09 2004
d12 3
a14 3
@@@@ -36,7 +36,7 @@@@ static const unsigned long _glibtop_sysd
 (1L << GLIBTOP_CPU_NICE) + (1L << GLIBTOP_CPU_SYS) +
 (1L << GLIBTOP_CPU_IDLE) + (1L << GLIBTOP_CPU_FREQUENCY);
d21 1
a21 1
@@@@ -54,13 +54,16 @@@@ static int mib [] = { CTL_KERN, KERN_CLO
d39 1
a39 1
@@@@ -93,7 +96,7 @@@@ glibtop_get_cpu_p (glibtop *server, glib
@


1.2
log
@Update the supporting Gnome ports to their Gnome 2.8 versions.

ORBit2      2.10.2 -> 2.12.0
atk          1.6.1 -> 1.8.0
gconf-editor 2.6.2 -> 2.8.2
gconf2       2.6.2 -> 2.8.1
libIDL       0.8.3 -> 0.8.4
libgsf      1.10.0 -> 1.11.1
libgtop2     2.6.0 -> 2.8.1
libwnck      2.6.2 -> 2.8.1
pango        1.4.1 -> 1.6.0
startup-notification 0.5 -> 0.7

Real work done by Francois Briere.
@
text
@d1 2
a2 2
--- sysdeps/freebsd/cpu.c.orig	Wed Dec  1 19:22:45 2004
+++ sysdeps/freebsd/cpu.c	Wed Dec  1 19:25:52 2004
d12 1
a12 1
@@@@ -36,7 +36,7 @@@@
d21 1
a21 1
@@@@ -54,13 +54,16 @@@@
d39 1
a39 1
@@@@ -93,7 +96,7 @@@@
@


1.1
log
@Update to 2.6.0.  Get rid of the custom OpenBSD support from the
former nino@@ that has been a part of this port for some time.
Updates to the internal API finally broke it, but a huge thanks
to Nils for his work there (thanks Nils!).

Now we use the Free/NetBSD support as a base and patch from there :).
@
text
@d1 2
a2 3
$OpenBSD$
--- sysdeps/freebsd/cpu.c.orig	Thu Jul 29 20:54:47 2004
+++ sysdeps/freebsd/cpu.c	Thu Jul 29 21:10:23 2004
d8 1
a8 1
+#if defined(__NetBSD__) || defined(__OpenBSD__)
d12 1
a12 1
@@@@ -36,7 +36,7 @@@@ static const unsigned long _glibtop_sysd
d21 1
a21 1
@@@@ -54,13 +54,16 @@@@ static int mib [] = { CTL_KERN, KERN_CLO
d39 1
a39 1
@@@@ -93,7 +96,7 @@@@ glibtop_get_cpu_p (glibtop *server, glib
@

