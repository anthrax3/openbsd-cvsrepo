head	1.1;
access;
symbols
	OPENBSD_5_5:1.1.0.4
	OPENBSD_5_6:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2014.09.30.15.02.16;	author ajacoutot;	state dead;
branches
	1.1.2.1
	1.1.4.1;
next	;
commitid	EaWh9ot6gcGLnG64;

1.1.2.1
date	2014.09.30.15.02.16;	author ajacoutot;	state Exp;
branches;
next	;
commitid	EaWh9ot6gcGLnG64;

1.1.4.1
date	2014.09.30.15.03.27;	author ajacoutot;	state Exp;
branches;
next	;
commitid	oMq0fepPPymetkRz;


desc
@@


1.1
log
@file patch-trytond_ir_cron_py was initially added on branch OPENBSD_5_6.
@
text
@@


1.1.4.1
log
@SECURITY fixes:
* Use literal_eval instead of safe_eval (CVE-2014-6633)
* Prevent double underscore in safe_eval (CVE-2014-6633)
@
text
@a0 28
$OpenBSD$

* Use literal_eval instead of safe_eval (CVE-2014-6633)
* Prevent double underscore in safe_eval (CVE-2014-6633)

--- trytond/ir/cron.py.orig	Mon Dec 16 19:08:05 2013
+++ trytond/ir/cron.py	Tue Sep 30 16:59:21 2014
@@@@ -8,9 +8,10 @@@@ import sys
 import logging
 from email.mime.text import MIMEText
 from email.header import Header
+from ast import literal_eval
 
 from ..model import ModelView, ModelSQL, fields
-from ..tools import safe_eval, get_smtp_server
+from ..tools import get_smtp_server
 from ..transaction import Transaction
 from ..pool import Pool
 from .. import backend
@@@@ -157,7 +158,7 @@@@ class Cron(ModelSQL, ModelView):
         pool = Pool()
         Config = pool.get('ir.configuration')
         try:
-            args = (cron.args or []) and safe_eval(cron.args)
+            args = (cron.args or []) and literal_eval(cron.args)
             Model = pool.get(cron.model)
             with Transaction().set_user(cron.user.id):
                 getattr(Model, cron.function)(*args)
@


1.1.2.1
log
@SECURITY fixes:
* Use literal_eval instead of safe_eval (CVE-2014-6633)
* Prevent double underscore in safe_eval (CVE-2014-6633)
@
text
@a0 28
$OpenBSD$

* Use literal_eval instead of safe_eval (CVE-2014-6633)
* Prevent double underscore in safe_eval (CVE-2014-6633)

--- trytond/ir/cron.py.orig	Sun Jun 15 18:55:32 2014
+++ trytond/ir/cron.py	Tue Sep 30 16:55:15 2014
@@@@ -7,9 +7,10 @@@@ import sys
 import logging
 from email.mime.text import MIMEText
 from email.header import Header
+from ast import literal_eval
 
 from ..model import ModelView, ModelSQL, fields
-from ..tools import safe_eval, get_smtp_server
+from ..tools import get_smtp_server
 from ..transaction import Transaction
 from ..pool import Pool
 from .. import backend
@@@@ -156,7 +157,7 @@@@ class Cron(ModelSQL, ModelView):
         pool = Pool()
         Config = pool.get('ir.configuration')
         try:
-            args = (cron.args or []) and safe_eval(cron.args)
+            args = (cron.args or []) and literal_eval(cron.args)
             Model = pool.get(cron.model)
             with Transaction().set_user(cron.user.id):
                 getattr(Model, cron.function)(*args)
@

