head	1.2;
access;
symbols
	OPENBSD_6_1:1.2.0.6
	OPENBSD_6_1_BASE:1.2
	OPENBSD_6_0:1.2.0.4
	OPENBSD_6_0_BASE:1.2
	OPENBSD_5_9:1.2.0.2
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.1.1.1.0.8
	OPENBSD_5_8_BASE:1.1.1.1
	OPENBSD_5_7:1.1.1.1.0.4
	OPENBSD_5_7_BASE:1.1.1.1
	OPENBSD_5_6:1.1.1.1.0.2
	OPENBSD_5_6_BASE:1.1.1.1
	landry_20140703:1.1.1.1
	vic:1.1.1;
locks; strict;
comment	@# @;


1.2
date	2016.01.28.17.15.03;	author kspillner;	state Exp;
branches;
next	1.1;
commitid	ne0vn0YfCU59thCO;

1.1
date	2014.07.12.22.08.35;	author landry;	state Exp;
branches
	1.1.1.1;
next	;
commitid	BiP1NU93TY4KegGP;

1.1.1.1
date	2014.07.12.22.08.35;	author landry;	state Exp;
branches;
next	;
commitid	BiP1NU93TY4KegGP;


desc
@@


1.2
log
@Update to v1.1.0.

ok sthen@@
@
text
@$OpenBSD$

Fix CA certificate generation for GNUTLS v3.3.20 and later.
When this option was present clients failed to validate the
server's certificate when trust=strict with "certificate
violates signer's constraints" errors.
--- pki/generate.ca.orig	Wed Jan 20 09:43:57 2016
+++ pki/generate.ca	Wed Jan 20 09:44:09 2016
@@@@ -26,7 +26,6 @@@@ country = $COUNTRY
 state = $STATE
 locality = $LOCALITY
 ca
-cert_signing_key
 EOF
 
 $CERTTOOL \
@


1.1
log
@Initial revision
@
text
@d2 10
a11 37
--- pki/generate.ca.orig	Fri Jun 20 22:26:36 2014
+++ pki/generate.ca	Fri Jun 20 21:59:50 2014
@@@@ -1,27 +1,30 @@@@
-#!/bin/bash
+#!/bin/sh
 
 # Take the correct binary to create the certificates
-CERTTOOL=$(which gnutls-certtool || which certtool)
+CERTTOOL=$(which certtool)
 if [[ -z "${CERTTOOL}" ]]
 then
   echo "ERROR: No certtool found" >&2
   exit 1
 fi
 
+. ./vars
+
 # Create a CA key.
 ${CERTTOOL} \
   --generate-privkey \
+  --bits=$bits \
   --outfile ca.key.pem
 
 chmod 600 ca.key.pem
 
 # Sign a CA cert.
 cat <<EOF >ca.info
-organization = Göteborg Bit Factory
-cn = Göteborg Bit Factory
-country = SE
-state = Västra Götaland
-locality = Göteborg
+organization = $organization
+cn = $cn
+country = $country
+state = $state
+locality = $locality
d13 1
a13 1
 cert_signing_key
d15 2
@


1.1.1.1
log
@Import taskd 1.0.0, from vic

Taskserver is a lightweight, secure server providing multi-user,
multi-client access to task data. This allows true syncing between
desktop and mobile clients.

ok abieber@@ on a previous version, with tweaks from sthen@@
@
text
@@
