head	1.6;
access;
symbols
	OPENBSD_5_8:1.5.0.8
	OPENBSD_5_8_BASE:1.5
	OPENBSD_5_7:1.5.0.4
	OPENBSD_5_7_BASE:1.5
	OPENBSD_5_6:1.5.0.2
	OPENBSD_5_6_BASE:1.5
	OPENBSD_5_5:1.3.0.2
	OPENBSD_5_5_BASE:1.3;
locks; strict;
comment	@# @;


1.6
date	2015.10.26.10.14.04;	author jasper;	state dead;
branches;
next	1.5;
commitid	DhgVw2lwdUaBwfvj;

1.5
date	2014.04.06.12.09.14;	author ajacoutot;	state Exp;
branches;
next	1.4;

1.4
date	2014.03.09.22.31.54;	author ajacoutot;	state Exp;
branches;
next	1.3;

1.3
date	2013.09.12.06.49.54;	author ajacoutot;	state Exp;
branches;
next	1.2;

1.2
date	2013.03.28.21.37.34;	author jasper;	state dead;
branches;
next	1.1;

1.1
date	2013.03.28.19.56.09;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.6
log
@update to zeitgeist-0.9.16
@
text
@$OpenBSD: patch-libzeitgeist_log_vala,v 1.5 2014/04/06 12:09:14 ajacoutot Exp $

From 3fe95cdb5a4c48d3b6606ffb1f60fae3e375fdff Mon Sep 17 00:00:00 2001
From: Seif Lotfy <seif@@lotfy.com>
Date: Tue, 04 Mar 2014 19:55:53 +0000
Subject: Replace get_nprocs_conf with g_get_num_processors()

From d2c966faf4979b5745ea0df8062795fc82b9fcc1 Mon Sep 17 00:00:00 2001
From: Rico Tzschichholz <ricotz@@ubuntu.com>
Date: Mon, 17 Mar 2014 20:02:01 +0000
Subject: Require glib >= 2.35.4 according to the usage of g_get_num_processors()

--- libzeitgeist/log.vala.orig	Sun Apr  6 13:39:13 2014
+++ libzeitgeist/log.vala	Sun Apr  6 13:39:07 2014
@@@@ -40,6 +40,7 @@@@
  * Zeitgeist also comes with a blacklist extension to make sure the user
  * always stays in control of what information is logged.
  */
+
 namespace Zeitgeist
 {
 
@@@@ -58,9 +59,6 @@@@ namespace Zeitgeist
  */
 public class Log : QueuedProxyWrapper
 {
-    [CCode (cheader_filename = "sys/sysinfo.h", cname = "get_nprocs_conf")]
-    extern static int get_nprocs_conf ();
-
     class DbWorker
     {
         private unowned ThreadFunc<void*> func;
@@@@ -141,7 +139,7 @@@@ public class Log : QueuedProxyWrapper
         try {
             threads = new ThreadPool<DbWorker>.with_owned_data ((worker) => {
                 worker.run ();
-            }, get_nprocs_conf (), true);
+            }, (int) get_num_processors (), true);
         } catch (ThreadError err) {
             warning ("%s", err.message);
             threads = null;
@@@@ -637,4 +635,3 @@@@ public class Log : QueuedProxyWrapper
 
 }
 
-// vim:expandtab:ts=4:sw=4
@


1.5
log
@Merge some patches from upstream to better deal with new glib2 and new vala.

ok jasper@@ (maintainer)
@
text
@d1 1
a1 1
$OpenBSD: patch-libzeitgeist_log_vala,v 1.4 2014/03/09 22:31:54 ajacoutot Exp $
@


1.4
log
@Merge build fixes from upstream.

ok jasper@@ (maintainer)
@
text
@d1 1
a1 1
$OpenBSD$
d8 7
a14 2
--- libzeitgeist/log.vala.orig	Mon Jun 17 08:40:08 2013
+++ libzeitgeist/log.vala	Thu Mar  6 09:01:29 2014
d23 1
a23 1
@@@@ -58,8 +59,8 @@@@ namespace Zeitgeist
d29 1
a29 3
+    [CCode (cname = "g_get_num_processors")]
+    private extern static uint get_num_processors ();
 
d32 2
a33 1
@@@@ -141,7 +142,7 @@@@ public class Log : QueuedProxyWrapper
d42 1
a42 1
@@@@ -637,4 +638,3 @@@@ public class Log : QueuedProxyWrapper
@


1.3
log
@Major update to zeitgeist-0.9.14.
Based on jasper@@'s work which got reverted several months ago.

ok jasper@@ (maintainer)
@
text
@d1 1
a1 1
$OpenBSD: patch-libzeitgeist_log_vala,v 1.1 2013/03/28 19:56:09 jasper Exp $
d3 4
a6 2
get_nprocs_conf() is a glibc-extension equivalent to sysconf(_SC_NPROCESSORS_CONF).
https://bugs.launchpad.net/libzeitgeist/+bug/1161565
d8 3
a10 3
--- libzeitgeist/log.vala.orig	Tue Mar 19 07:01:48 2013
+++ libzeitgeist/log.vala	Thu Mar 28 20:03:52 2013
@@@@ -40,6 +40,10 @@@@
a14 3
+using Posix;
+using Linux;
+
d18 1
a18 1
@@@@ -58,9 +62,6 @@@@ namespace Zeitgeist
d24 3
a26 1
-
a28 1
         private unowned ThreadFunc<void*> func;
d34 1
a34 1
+            }, (int) Posix.sysconf(Linux._SC_NPROCESSORS_CONF), true);
d38 5
@


1.2
log
@revert previous. dependants need more work afterall.
@
text
@@


1.1
log
@- update to zeitgeist-0.9.10
* libzeitgeist and datahub have been merged now.
@
text
@d1 1
a1 1
$OpenBSD$
@

