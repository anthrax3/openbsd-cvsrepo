head	1.2;
access;
symbols
	OPENBSD_5_6:1.1.0.8
	OPENBSD_5_6_BASE:1.1
	OPENBSD_5_5:1.1.0.6
	OPENBSD_5_5_BASE:1.1
	OPENBSD_5_4:1.1.0.4
	OPENBSD_5_4_BASE:1.1
	OPENBSD_5_3:1.1.0.2
	OPENBSD_5_3_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2014.09.27.07.48.07;	author landry;	state dead;
branches;
next	1.1;
commitid	PsH5PQh08MdT9ypU;

1.1
date	2012.11.11.20.50.18;	author landry;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Fix user creation (and probably other db-related issues) by removing
quotes around LANGUAGE 'plpgsql' declarations, needed since pgsql > 9.3.
Remove the patch that was fixing a single occurence, and apply some perl
-pi -e magic during post-patch instead.
Taken from https://gitlab.com/davical-project/davical/issues/26, tested
by viq.
@
text
@$OpenBSD: patch-dba_davical_sql,v 1.1 2012/11/11 20:50:18 landry Exp $
http://postgresql.1045698.n5.nabble.com/Buildfarm-now-building-but-with-test-failures-td5119291.html#a5120094
Fix with psql > 9.xx ?
--- dba/davical.sql.orig	Sun Nov 11 21:36:43 2012
+++ dba/davical.sql	Sun Nov 11 21:37:04 2012
@@@@ -36,7 +36,7 @@@@ BEGIN
           ELSE 0 END)::BIT(24);
 END
 $$
-LANGUAGE 'PlPgSQL' IMMUTABLE STRICT;
+LANGUAGE PlPgSQL IMMUTABLE STRICT;
 
 -- Given an array of verbose DAV: or CalDAV: privilege names return the bitmask
 CREATE or REPLACE FUNCTION privilege_to_bits( TEXT[] ) RETURNS BIT(24) AS $$
@@@@ -62,7 +62,7 @@@@ BEGIN
   RETURN out_bits;
 END
 $$
-LANGUAGE 'PlPgSQL' IMMUTABLE STRICT;
+LANGUAGE PlPgSQL IMMUTABLE STRICT;
 
 
 -- This sequence is used in a number of places so that any DAV resource will have a unique ID
@


1.1
log
@Update to davical 1.1.1, from viq.

Add a patch to unbreak db initialization (remove quotes around LANGUAGE
'plpgsql', breaking with recent psqls ?)
@
text
@d1 1
a1 1
$OpenBSD$
@

