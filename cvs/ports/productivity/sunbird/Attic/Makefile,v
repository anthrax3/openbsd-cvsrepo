head	1.55;
access;
symbols
	OPENBSD_5_4:1.53.0.2
	OPENBSD_5_4_BASE:1.53
	OPENBSD_5_3:1.48.0.2
	OPENBSD_5_3_BASE:1.48
	OPENBSD_5_2:1.43.0.2
	OPENBSD_5_2_BASE:1.43
	OPENBSD_5_1_BASE:1.38
	OPENBSD_5_1:1.38.0.2
	OPENBSD_5_0:1.32.0.2
	OPENBSD_5_0_BASE:1.32
	OPENBSD_4_9:1.22.0.2
	OPENBSD_4_9_BASE:1.22
	OPENBSD_4_8:1.9.0.2
	OPENBSD_4_8_BASE:1.9
	OPENBSD_4_7:1.4.0.2
	OPENBSD_4_7_BASE:1.4
	landry_20091110:1.1.1.1
	landry:1.1.1;
locks; strict;
comment	@# @;


1.55
date	2013.12.07.12.50.16;	author landry;	state dead;
branches;
next	1.54;

1.54
date	2013.09.19.13.47.05;	author landry;	state Exp;
branches;
next	1.53;

1.53
date	2013.06.26.19.31.58;	author landry;	state Exp;
branches;
next	1.52;

1.52
date	2013.06.20.06.54.38;	author ajacoutot;	state Exp;
branches;
next	1.51;

1.51
date	2013.06.17.19.29.05;	author ajacoutot;	state Exp;
branches;
next	1.50;

1.50
date	2013.04.06.14.41.17;	author landry;	state Exp;
branches;
next	1.49;

1.49
date	2013.03.11.11.37.55;	author espie;	state Exp;
branches;
next	1.48;

1.48
date	2012.12.04.21.05.30;	author landry;	state Exp;
branches;
next	1.47;

1.47
date	2012.11.12.20.45.32;	author landry;	state Exp;
branches;
next	1.46;

1.46
date	2012.09.22.10.30.17;	author landry;	state Exp;
branches;
next	1.45;

1.45
date	2012.09.21.13.21.44;	author ajacoutot;	state Exp;
branches;
next	1.44;

1.44
date	2012.09.01.14.35.06;	author landry;	state Exp;
branches;
next	1.43;

1.43
date	2012.06.11.15.26.14;	author landry;	state Exp;
branches;
next	1.42;

1.42
date	2012.04.24.17.49.39;	author sthen;	state Exp;
branches;
next	1.41;

1.41
date	2012.03.16.21.42.58;	author landry;	state Exp;
branches;
next	1.40;

1.40
date	2012.03.08.12.13.01;	author ajacoutot;	state Exp;
branches;
next	1.39;

1.39
date	2012.02.20.20.28.25;	author landry;	state Exp;
branches;
next	1.38;

1.38
date	2011.10.03.21.13.02;	author landry;	state Exp;
branches;
next	1.37;

1.37
date	2011.09.16.11.13.42;	author espie;	state Exp;
branches;
next	1.36;

1.36
date	2011.09.06.19.47.03;	author landry;	state Exp;
branches;
next	1.35;

1.35
date	2011.08.24.06.22.19;	author landry;	state Exp;
branches;
next	1.34;

1.34
date	2011.08.23.20.28.57;	author landry;	state Exp;
branches;
next	1.33;

1.33
date	2011.08.23.08.38.13;	author landry;	state Exp;
branches;
next	1.32;

1.32
date	2011.08.02.19.24.38;	author naddy;	state Exp;
branches;
next	1.31;

1.31
date	2011.07.22.05.25.27;	author landry;	state Exp;
branches;
next	1.30;

1.30
date	2011.06.22.14.52.11;	author landry;	state Exp;
branches;
next	1.29;

1.29
date	2011.06.22.12.34.42;	author landry;	state Exp;
branches;
next	1.28;

1.28
date	2011.06.15.16.16.10;	author sthen;	state Exp;
branches;
next	1.27;

1.27
date	2011.06.08.17.37.46;	author jasper;	state Exp;
branches;
next	1.26;

1.26
date	2011.05.11.07.45.53;	author ajacoutot;	state Exp;
branches;
next	1.25;

1.25
date	2011.04.29.08.06.01;	author landry;	state Exp;
branches;
next	1.24;

1.24
date	2011.03.22.13.18.26;	author landry;	state Exp;
branches;
next	1.23;

1.23
date	2011.03.20.20.09.28;	author landry;	state Exp;
branches;
next	1.22;

1.22
date	2011.01.28.21.38.12;	author landry;	state Exp;
branches;
next	1.21;

1.21
date	2011.01.18.12.37.44;	author landry;	state Exp;
branches;
next	1.20;

1.20
date	2011.01.14.22.57.44;	author landry;	state Exp;
branches;
next	1.19;

1.19
date	2011.01.05.08.22.30;	author dcoppa;	state Exp;
branches;
next	1.18;

1.18
date	2010.12.01.15.00.12;	author dcoppa;	state Exp;
branches;
next	1.17;

1.17
date	2010.10.27.13.00.55;	author landry;	state Exp;
branches;
next	1.16;

1.16
date	2010.10.24.21.33.27;	author ajacoutot;	state Exp;
branches;
next	1.15;

1.15
date	2010.10.22.19.22.36;	author landry;	state Exp;
branches;
next	1.14;

1.14
date	2010.10.18.07.15.56;	author landry;	state Exp;
branches;
next	1.13;

1.13
date	2010.10.15.07.16.19;	author landry;	state Exp;
branches;
next	1.12;

1.12
date	2010.10.11.08.17.46;	author jasper;	state Exp;
branches;
next	1.11;

1.11
date	2010.09.19.19.22.46;	author landry;	state Exp;
branches;
next	1.10;

1.10
date	2010.08.30.21.52.53;	author fgsch;	state Exp;
branches;
next	1.9;

1.9
date	2010.07.27.16.52.35;	author landry;	state Exp;
branches;
next	1.8;

1.8
date	2010.06.23.17.11.50;	author landry;	state Exp;
branches;
next	1.7;

1.7
date	2010.06.20.19.59.16;	author landry;	state Exp;
branches;
next	1.6;

1.6
date	2010.04.27.21.00.50;	author landry;	state Exp;
branches;
next	1.5;

1.5
date	2010.04.03.09.43.20;	author landry;	state Exp;
branches;
next	1.4;

1.4
date	2009.12.21.21.03.56;	author ajacoutot;	state Exp;
branches;
next	1.3;

1.3
date	2009.11.18.08.56.40;	author landry;	state Exp;
branches;
next	1.2;

1.2
date	2009.11.18.08.44.51;	author landry;	state Exp;
branches;
next	1.1;

1.1
date	2009.11.10.20.48.06;	author landry;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2009.11.10.20.48.06;	author landry;	state Exp;
branches;
next	;


desc
@@


1.55
log
@Remove devel/xulrunner/1.9, www/fennec, www/firefox36 and productivity/sunbird

- nothing uses xulrunner 1.9 anymore, and that branch was EOL'd upstream
  20 months ago (firefox36 was already unlinked from the build)
- www/fennec as a xul app is dead upstream, since now firefox mobile is
  built on top of java android libs and thus unportable to regular OS.
The esr10 branch from which it was built upon was EOL'd upstream 10 months ago
- productivity/sunbird as a standalone app is dead upstream since 3
  years, hypothetical users should just use thunderbird+lightning which
is still supported/developed.

No complains from ports@@, this will allow for a serious mozilla ports
cleanup, and we're down to 5 mozillas in the ports tree.
@
text
@# $OpenBSD: Makefile,v 1.54 2013/09/19 13:47:05 landry Exp $

COMMENT =		Mozilla calendar

MOZILLA_PROJECT =	sunbird
MOZILLA_VERSION =	1.0b2
MOZILLA_DIST =		thunderbird
MOZILLA_DIST_VERSION =	3.1.19
MOZILLA_BRANCH =	1.9.2
MOZILLA_CODENAME =	calendar

EPOCH =			0
REVISION =		28

HOMEPAGE =	http://www.mozilla.org/projects/calendar/sunbird/

CATEGORIES =	productivity mail

SO_VERSION =	17.0

MOZILLA_LIBS = calbasecomps accessibility auth autoconfig caps chardet chrome \
	commandlines composer cookie docshell embedcomponents fileview gkgfxthebes \
	gklayout gkplugin htmlpars i18n imgicon imglib2 intlapp jar50 jsd jsctypes mork \
	mozfind necko nsappshell permissions pipboot pipnss pippki pref rdf \
	remoteservice satchel spellchecker storagecomps system-pref \
	tkautocomplete toolkitcomps txmgr uconv unixproxy webbrwsr widget_gtk2 \
	windowds xpautocomplete xpconnect xpinstall zipwriter gfxpsshar gkgfx \
	gtkxtbin mozjs thebes xpcom xpcom_core xul nullplugin unixprintplugin

# MPL
PERMIT_PACKAGE_CDROM=	Yes

MODULES =	www/mozilla devel/gettext lang/python
MODPY_RUN_DEP =	No

# Regression tests are too hard to adapt to run here
NO_TEST =	Yes

# use files and patches from mail/mozilla-thunderbird
# XXX impossible until we can build sb from tb 5+
# PATCHDIR =		${PORTSDIR}/mail/mozilla-thunderbird/patches
# FILESDIR =		${PORTSDIR}/mail/mozilla-thunderbird/files

MODGNU_CONFIG_GUESS_DIRS +=	${WRKSRC}/directory/sdks/c-sdk/config/autoconf

CONFIGURE_STYLE =	autoconf no-autoheader
CONFIGURE_ARGS =	--enable-official-branding

ALL_TARGET=	default

MOZILLA_DATADIRS =	calendar-js chrome components defaults dictionaries extensions \
		greprefs modules plugins res

MOZILLA_AUTOCONF_DIRS =		directory/sdks/c-sdk mozilla mozilla/js/src
MOZILLA_SUBST_FILES +=		config/autoconf.mk.in

.include <bsd.port.mk>
@


1.54
log
@Bump REVISIONS to be on the safe side after typo fix in mozilla.port.mk
(MOZMOZ_WANTLIB instead of MODMOZ_WANTLIB for krb5 libs...)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2013/06/26 19:31:58 landry Exp $
@


1.53
log
@Bump some REVISIONs after mozilla.port.mk WANTLIB change.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.52 2013/06/20 06:54:38 ajacoutot Exp $
d13 1
a13 1
REVISION =		27
@


1.52
log
@Unbreak after hx509 and ntlm removal from Kerberos.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 2013/06/17 19:29:05 ajacoutot Exp $
d13 1
a13 1
REVISION =		26
@


1.51
log
@Unbreak Mozilla ports after the Heimdal update.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2013/04/06 14:41:17 landry Exp $
d13 1
a13 1
REVISION =		25
@


1.50
log
@Bump after WANTLIB fix - while here, backport kettenis' libffi i386 fix
to fennec.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2013/03/11 11:37:55 espie Exp $
d13 1
a13 1
REVISION =		24
@


1.49
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2012/12/04 21:05:30 landry Exp $
d13 1
a13 1
REVISION =		23
@


1.48
log
@Winter cleanup of the mozillas :

- Add gtar to BUILD_DEPENDS everywhere in moz.port.mk, since fx 18 will
  start using gtar-only options. Ditto for unzip, used during install.
- special-case the deps for firefox/thunderbird/seamonkey, since those
  are maintained on the long-term. Only those need to depend on the
latest and greatest nss/nspr.
- move the '--relax LDFLAGS for ppc' to moz.port.mk
- move the 'yasm BUILD_DEPENDS for i385/amd64' to moz.port.mk
- move more common CONFIGURE_ARGS to moz.port.mk (libevent,gio,bz2,gconf..)
- fix MODMOZ_WANTLIB wrt nss/nspr majors
- ensure we depend on sqlite3>=21, needed for fx/tb 18
- use --with-system-jpeg only in firefox36/sunbird/fennec/xulrunner,
  fx/tb 18 will have to use its bundled libjpeg-turbo (#791305)
- bump REVISIONs for the WANTLIB/LIB_DEPENDS change.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2012/11/12 20:45:32 landry Exp $
a31 3
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
d37 1
a37 1
NO_REGRESS =	Yes
@


1.47
log
@Bump all ports depending on nspr to account for the devel/nspr,-main ->
devel/nspr pkgpath change. While here, make sure mozilla ports depend on
the latest and greatest via mozilla.port.mk.
Tested in a bulk build..
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2012/09/22 10:30:17 landry Exp $
d13 1
a13 1
REVISION =		22
@


1.46
log
@Remove useless dependency on deprecated pangox.

- remove useless patch to gfx/thebes/Makefile.in adding -lpangox-1.0 to
EXTRA_DSO_LDOPTS, this was maybe useful before ffx 3.0, but mozilla
stopped using pangox between 2.0 and 3.0. See for the last traces of
pangox.h use : https://bugzilla.mozilla.org/show_bug.cgi?id=528941. See
also bugs #323671/#338446
- backport the patch from #528941 to remove useless pangox.h inclusion
from www/firefox35.
- remove the RUN_DEPENDS on pangox-compat
- bump all corresponding REVISIONS
- while here, make sure all moz ports depend on latest nspr 4.9.2 since
  it'll be a requirement for upcoming gecko 16 releases
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2012/09/21 13:21:44 ajacoutot Exp $
d13 1
a13 1
REVISION =		21
@


1.45
log
@Fix after pangox removal from devel/pango.
ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2012/09/01 14:35:06 landry Exp $
d13 1
a13 1
REVISION =		20
a37 3

# EXTRA_DSO_LDOPTS += -lpangox-1.0
RUN_DEPENDS +=		devel/pangox-compat
@


1.44
log
@Garge collect nsSound.cpp, the original one uses libcanberra
properly and thus sndio. Bump corresponding REVISIONs.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2012/06/11 15:26:14 landry Exp $
d13 1
a13 1
REVISION =		19
d38 3
@


1.43
log
@Fix WANTLIB (remove gmodule-2.0) and bump depending ports (others will
be updated in a sec)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2012/04/24 17:49:39 sthen Exp $
d13 1
a13 1
REVISION =		18
@


1.42
log
@bump
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2012/03/16 21:42:58 landry Exp $
d13 1
a13 1
REVISION =		17
@


1.41
log
@bump after mozilla.port.mk dependency change
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2012/03/08 12:13:01 ajacoutot Exp $
d13 1
a13 1
REVISION =		16
@


1.40
log
@Garbage collect the /dev/arandom patches.

from Brad
ok landry@@ sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2012/02/20 20:28:25 landry Exp $
d13 1
a13 1
REVISION =		15
@


1.39
log
@Build sunbird from thunderbird 3.1.19.
Remove patch-mozilla_gfx_qcms_iccread_c, was commited upstream.
CVS: ----------------------------------------------------------------------
CVS: Enter Log.  Lines beginning with `CVS:' are removed automatically
CVS:
CVS: Committing in .
CVS:
CVS: Modified Files:
CVS: 	Makefile distinfo
CVS: Removed Files:
CVS: 	patches/patch-mozilla_gfx_qcms_iccread_c
CVS: ----------------------------------------------------------------------
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2011/10/03 21:13:02 landry Exp $
d13 1
a13 1
REVISION =		14
@


1.38
log
@Remove PR_LoadLibrary() patches now that nspr contains the fix.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2011/09/16 11:13:42 espie Exp $
d6 1
a6 1
MOZILLA_VERSION =	1.0beta2
d8 1
a8 1
MOZILLA_DIST_VERSION =	3.1.11
d13 1
a13 1
REVISION =		13
@


1.37
log
@normalize pkgpath
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2011/09/06 19:47:03 landry Exp $
d13 1
a13 1
REVISION =		12
@


1.36
log
@Bump REVISION after nss dependency change.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2011/08/24 06:22:19 landry Exp $
d13 1
a13 1
REVISION =		11
@


1.35
log
@Use MOZILLA_DIST/MOZILLA_DIST_VERSION where appropriate, remove
MASTER_SITES & DISTNAME (they're now properly set by the module).
Bump REVISION where HOMEPAGE changes.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2011/08/23 20:28:57 landry Exp $
d13 1
a13 1
REVISION =		10
@


1.34
log
@bump after nss/nspr dependency change
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2011/08/23 08:38:13 landry Exp $
a5 1
TB_VERSION =		3.1.11
d7 2
a11 1
DISTNAME =		thunderbird-${TB_VERSION}.source
d13 1
a13 1
REVISION =		9
d15 1
a15 2
MASTER_SITES =	http://releases.mozilla.org/pub/mozilla.org/thunderbird/releases/${TB_VERSION}/source/ \
		ftp://ftp.mozilla.org/pub/mozilla.org/thunderbird/releases/${TB_VERSION}/source/
@


1.33
log
@Add ftp://ftp.mozilla.org as backup MASTER_SITES to still be able to
fetch 'old' releases phased out of mirrors. Prodded by espie@@.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2011/08/02 19:24:38 naddy Exp $
d13 1
a13 1
REVISION =		8
@


1.32
log
@Fix for CVE-2011-2691 in the included apng, backported from png 1.2.45.
with landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2011/07/22 05:25:27 landry Exp $
d15 2
a16 1
MASTER_SITES =	http://releases.mozilla.org/pub/mozilla.org/thunderbird/releases/${TB_VERSION}/source/
@


1.31
log
@Readd patches/files from mail/mozilla-thunderbird, atm sunbird can't be
built from newer thunderbird tarballs (as it's officially
unmaintained/dead upstream) and this gets in the way of thunderbird 5
update. Hopefully i'll figure out how to fix that... bump REVISION to be
on the safe side.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2011/06/22 14:52:11 landry Exp $
d13 1
a13 1
REVISION =		7
@


1.30
log
@Add missing shlib to PLIST, and update PLIST while here. Bump REVISION.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2011/06/22 12:34:42 landry Exp $
d13 1
a13 1
REVISION =		6
d43 3
a45 2
PATCHDIR =		${PORTSDIR}/mail/mozilla-thunderbird/patches
FILESDIR =		${PORTSDIR}/mail/mozilla-thunderbird/files
@


1.29
log
@Build sunbird from thunderbird 3.1.11 tarball.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2011/06/15 16:16:10 sthen Exp $
d13 1
a13 1
REVISION =		5
d22 1
a22 1
	commandlines cookie docshell embedcomponents fileview gkgfxthebes \
@


1.28
log
@the Mozilla ports don't need Python at runtime, so set MODPY_RUNDEP=No.
(Firefox was already set this way). ok/reminder about sunbird landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2011/06/08 17:37:46 jasper Exp $
d6 1
a6 1
TB_VERSION =		3.1.10
d13 1
a13 1
REVISION =		4
@


1.27
log
@bump after default python version switch
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2011/05/11 07:45:53 ajacoutot Exp $
d13 1
a13 1
REVISION =		3
d37 1
@


1.26
log
@Sanitize some @@unexec/@@extraunexec calls to rm: move them up in the
PLIST and delete everything under the @@sample'd directory instead of the
directory itself to prevent a warning from pkg_delete(1) trying to
remove a non existing directory and to help preventing left-over files
and directories.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2011/04/29 08:06:01 landry Exp $
d13 1
a13 1
REVISION =		2
@


1.25
log
@Chase thunderbird update and build sunbird from 3.1.10 tarball..
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2011/03/22 13:18:26 landry Exp $
d13 1
a13 1
REVISION =		1
@


1.24
log
@Remove the .if for system sqlite, now every port using mozilla MODULE
uses it. Bump dependency to 3.7.5 to ensure it has unlock_notify for
ffx4, and bump all corresponding REVISIONs.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2011/03/20 20:09:28 landry Exp $
d6 1
a6 1
TB_VERSION =		3.1.8
d13 1
a13 1
REVISION =		0
@


1.23
log
@Update to sunbird 1.0beta2. Upstream doesn't have enough manpower to do
formal releases of sunbird, so let's build it from thunderbird source
tarball as we do for xulrunner w/ firefox. Use tb files/ and patches/
while here.
After discussion with upstream.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2011/01/28 21:38:12 landry Exp $
d13 1
@


1.22
log
@Fix an unaligned access on sparc64 leading to random crashes when
mozilla tries to read a malformed ICC profile on random image content
found on the web.
backport of http://hg.mozilla.org/mozilla-central/rev/e8207773d54d
ref: https://bugzilla.mozilla.org/show_bug.cgi?id=629057
issue reported and fix found by naddy@@
ok naddy@@ ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2011/01/18 12:37:44 landry Exp $
d6 3
a8 2
MOZILLA_VERSION =	1.0beta1
MOZILLA_BRANCH =	1.9.1
d11 1
a11 2
DISTNAME =		lightning-sunbird-1.0b1.source
REVISION =		11
d14 2
d18 1
a18 1
SO_VERSION =	16.1
d22 1
a22 1
	gklayout gkplugin htmlpars i18n imgicon imglib2 intlapp jar50 jsd mork \
a34 2
MASTER_SITES =	http://releases.mozilla.org/pub/mozilla.org/calendar/${MOZILLA_PROJECT}/releases/${MOZILLA_VERSION}/source/

d40 5
a44 1
MODGNU_CONFIG_GUESS_DIRS +=	${WRKSRC}/directory/c-sdk/config/autoconf
d52 1
a52 1
		greprefs icons modules plugins res
d54 1
a54 1
MOZILLA_AUTOCONF_DIRS =		directory/c-sdk mozilla mozilla/js/src
@


1.21
log
@mozilla.port.mk makes all mozilla ports use the sydney_audio_sndio.c
file from www/mozilla-firefox, so remove old instances of that file that
weren't updated with last commits (and were unused anyway)
While here bump all REVISIONs after LIB_DEPENDS change.
ok naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2011/01/14 22:57:44 landry Exp $
d11 1
a11 1
REVISION =		10
@


1.20
log
@Build sunbird against systemwide sqlite3 and add the PRAGMA
secure_delete patch. Consistency uber alles!
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2011/01/05 08:22:30 dcoppa Exp $
d11 1
a11 1
REVISION =		9
@


1.19
log
@Apply the cups fix to the rest of Mozilla apps (mozilla-thunderbird,
sunbird, firefox35, seamonkey).

Ok & tested by landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2010/12/01 15:00:12 dcoppa Exp $
d11 1
a11 1
REVISION =		8
d16 1
a16 1
SO_VERSION =	16.0
d25 1
a25 1
	gtkxtbin mozjs sqlite3 thebes xpcom xpcom_core xul nullplugin unixprintplugin
@


1.18
log
@Fix Kerberos/GSSAPI authentication within mozilla ports.
OpenBSD does not have gssapi_krb5. So, to avoid undefined symbol
errors, link libxul with "-lkrb5 -lcrypto".

OK phessler@@, landry@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2010/10/27 13:00:55 landry Exp $
d11 1
a11 1
REVISION =		7
@


1.17
log
@Add a patch so that it finds our gdb. Remove updates/ subdir at
uninstall time.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2010/10/24 21:33:27 ajacoutot Exp $
d11 1
a11 1
REVISION =		6
@


1.16
log
@Remove USE_X11.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2010/10/22 19:22:36 landry Exp $
d11 1
a11 1
REVISION =		5
@


1.15
log
@Bump sunbird REVISION after mozilla.port.mk change. While here remove
now unneeded comment.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2010/10/18 07:15:56 landry Exp $
a36 1
USE_X11 =	Yes
@


1.14
log
@Fix WANTLIB again after cairo's last commit where X11-xcb went away.
Bump REVISIONs.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2010/10/15 07:16:19 landry Exp $
d11 1
a11 1
REVISION =		4
a15 2
# need to be in synch with SO_VERSION in
# mail/mozilla-thunderbird and www/seamonkey for lighting to work
@


1.13
log
@Switch all mozilla-based ports to using the bundled cairo, mozilla doesn't
like the systemwide cairo since 1.10.x update (crashes,gifs not displaying
properly), and there's few hope it will be fixed in 1.9.2.x branch.
Fix WANTLIB while here and bump REVISIONs.
Reported by dcoppa@@, also found in upstream bz #597174 and various linux
vendors bugzillas (red hat #628331, mdv #60738, gentoo #337813).
devel/xulrunner will follow in a few..
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2010/10/11 08:17:46 jasper Exp $
d11 1
a11 1
REVISION =		3
@


1.12
log
@- fix WANTLIB after cairo update.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2010/09/19 19:22:46 landry Exp $
d11 1
a11 1
REVISION =		2
@


1.11
log
@Bump sunbird REVISION as nspr dependency was changed.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2010/08/30 21:52:53 fgsch Exp $
d11 1
a11 1
REVISION =		1
@


1.10
log
@More bumps for python.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2010/07/27 16:52:35 landry Exp $
d11 1
a11 1
REVISION =		0
@


1.9
log
@Remove -lighting subpackages, they can be built from their respective
host applications using --enable-calendar, so it makes more sense to
move the subpackages there, as seamonkey and thunderbird can get out of
synch.. now sunbird is only a standalone app.
Convert to mozilla MODULE while here, greatly shrinks Makefile. Use
EPOCH for seamless upgrades, as previous PKGNAME contained 1.0b1 which
wasn't detected as 1.0beta1.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2010/06/23 17:11:50 landry Exp $
d11 1
@


1.8
log
@Bump PKGNAME/SO_VERSION to chase www/mozilla-thunderbird update.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2010/06/20 19:59:16 landry Exp $
d3 1
a3 1
SHARED_ONLY =	Yes
d5 4
a8 3
COMMENT-main =		Mozilla calendar
COMMENT-lightning =	Mozilla Thunderbird calendar extension
COMMENT-seamonkey =	Mozilla Seamonkey calendar extension
a9 1
VER =			1.0b1
d11 1
a11 3
PKGNAME-main =		sunbird-${VER}p2
PKGNAME-lightning =	lightning-${VER}p1
PKGNAME-seamonkey =	lightning-seamonkey-${VER}p1
a12 1
EXTRACT_SUFX =	.tar.bz2
a14 2
MULTI_PACKAGES =	-main -lightning -seamonkey

d19 1
a19 1
.for _lib in calbasecomps accessibility auth autoconfig caps chardet chrome \
a26 4
SHARED_LIBS+=	${_lib} ${SO_VERSION}
.endfor

HOMEPAGE =	http://www.mozilla.org/projects/calendar
d34 1
a34 24
MASTER_SITES =	http://releases.mozilla.org/pub/mozilla.org/calendar/lightning/releases/${VER}/source/

MODULES =	devel/gettext lang/python
RUN_DEPENDS-main =	:desktop-file-utils-*:devel/desktop-file-utils
BUILD_DEPENDS =	:libIDL-*:devel/libIDL \
		::archivers/zip \
		::archivers/unzip

LIB_DEPENDS-main =	${LIB_DEPENDS} \
		gdk-x11-2.0,gdk_pixbuf-2.0,gtk-x11-2.0::x11/gtk+2 \
		sqlite3.>=13.3:sqlite3->=3.6.16:databases/sqlite3 \
		nspr4.>=17,plc4.>=17,plds4.>=17:nspr->=4.6.4p1:devel/nspr \
		nss3.>=19,smime3.>=19,softokn3.>=19,ssl3.>=19:nss->=3.11.4p1:security/nss

WANTLIB = c m
WANTLIB-main += ${WANTLIB} X11 Xau Xcomposite Xcursor Xdamage Xdmcp Xext Xfixes
WANTLIB-main += Xi Xinerama Xrandr Xrender Xt atk-1.0 cairo expat
WANTLIB-main += fontconfig freetype gio-2.0 glib-2.0 glitz gmodule-2.0
WANTLIB-main += gobject-2.0 gthread-2.0 jpeg pango-1.0 pangocairo-1.0
WANTLIB-main += pangoft2-1.0 pixman-1 png pthread sndio stdc++
WANTLIB-main += pthread-stubs xcb z

LIB_DEPENDS-lightning = mozilla-thunderbird/mozjs,mozilla-thunderbird/xpcom::mail/mozilla-thunderbird
LIB_DEPENDS-seamonkey = seamonkey/mozjs,seamonkey/xpcom::www/seamonkey
d36 1
a36 2
WANTLIB-lightning = ${WANTLIB} nspr4 plc4 plds4
WANTLIB-seamonkey = ${WANTLIB} nspr4 plc4 plds4
a38 1
USE_GMAKE =	Yes
d42 1
a42 3
MODGNU_CONFIG_GUESS_DIRS=	${WRKSRC}/mozilla/build/autoconf \
				${WRKSRC}/mozilla/js/src/build/autoconf \
				${WRKSRC}/directory/c-sdk/config/autoconf
a43 1
AUTOCONF_VERSION =	2.13
d45 1
a45 22
CONFIGURE_ARGS=	--with-system-jpeg=${LOCALBASE}	\
		--with-system-zlib=/usr/lib	\
		--with-system-nspr		\
		--with-system-nss		\
		--with-pthreads			\
		--disable-optimize		\
		--disable-debug			\
		--disable-tests			\
		--disable-pedantic		\
		--disable-installer		\
		--disable-updater		\
		--disable-gnomeui		\
		--disable-gnomevfs		\
		--disable-dbus			\
		--enable-default-toolkit=cairo-gtk2	\
		--enable-xinerama		\
		--enable-svg			\
		--enable-svg-renderer=cairo	\
		--enable-system-cairo		\
		--enable-canvas			\
		--enable-official-branding	\
		--enable-application=calendar
d49 1
a49 20
WRKDIST =	${WRKDIR}/comm-1.9.1
MAKE_ENV =	MOZ_CO_PROJECT=calendar \
		LD_LIBRARY_PATH="${WRKSRC}/mozilla/dist/bin" \
		BUILD_OFFICIAL=1 \
		MOZILLA_OFFICIAL=1 \
		SO_VERSION="${SO_VERSION}"
CONFIGURE_ENV =	${MAKE_ENV} \
		PKG_CONFIG_PATH="${LOCALBASE}/lib/pkgconfig:${X11BASE}/lib/pkgconfig" \
		MOZ_ENABLE_COREXFONTS=1 \
		topsrcdir=${WRKSRC}

MOB =		${WRKSRC}/mozilla/dist/bin
MOZ =		${PREFIX}/sunbird

# magic number taken from xpi/install.rdf
GUID =		{e2fda1a4-762b-4020-b5ad-a41df1933103}
LIGHTNINGDIR =	${PREFIX}/mozilla-thunderbird/extensions/${GUID}
SEAMONKEYDIR =	${PREFIX}/seamonkey/extensions/${GUID}
SUBST_VARS =	GUID
DATADIRS =	calendar-js chrome components defaults dictionaries extensions \
d52 2
a53 43
post-extract:
	cp -f ${FILESDIR}/sydney_audio_sndio.c \
		${WRKSRC}/mozilla/media/libsydneyaudio/src/
	@@cp -f ${FILESDIR}/nsSound.cpp ${WRKSRC}/mozilla/widget/src/gtk2/

pre-configure:
	cd ${WRKSRC}/directory/c-sdk && ${SETENV} ${AUTOCONF_ENV} ${AUTOCONF}
	cd ${WRKSRC}/mozilla && ${SETENV} ${AUTOCONF_ENV} ${AUTOCONF}
	cd ${WRKSRC}/mozilla/js/src && ${SETENV} ${AUTOCONF_ENV} ${AUTOCONF}
	${SUBST_CMD} ${WRKSRC}/mozilla/js/src/xpconnect/shell/Makefile.in \
		${WRKSRC}/mozilla/xpcom/io/nsAppFileLocationProvider.cpp \
		${WRKSRC}/mozilla/extensions/spellcheck/hunspell/src/mozHunspell.cpp \
		${WRKSRC}/mozilla/build/unix/mozilla.in \
		${WRKSRC}/mozilla/toolkit/xre/nsXREDirProvider.cpp

do-install:
	@@cd ${MOB} && \
		find ${DATADIRS} -type d \
			-exec ${INSTALL_DATA_DIR} ${MOZ}/{} \; && \
		find ${DATADIRS} ! -type d \
			-exec ${INSTALL_DATA} -m 644 {} ${MOZ}/{} \;
	${INSTALL_DATA} ${MOB}/*.so.${SO_VERSION} ${MOZ}
	${INSTALL_DATA} ${MOB}/*.ini ${MOZ}
	${INSTALL_SCRIPT} ${MOB}/sunbird ${PREFIX}/bin/
	${INSTALL_SCRIPT} ${MOB}/run-mozilla.sh ${MOZ}
	${INSTALL_PROGRAM} ${MOB}/regxpcom \
		${MOB}/sunbird-bin \
		${MOB}/mozilla-xremote-client ${MOZ}
	${INSTALL_DATA_DIR} ${PREFIX}/share/applications/
	${SUBST_CMD} -c ${FILESDIR}/sunbird.desktop \
		${PREFIX}/share/applications/sunbird.desktop
	chown ${SHAREOWN}:${SHAREGRP} \
		${PREFIX}/share/applications/sunbird.desktop

	# install lightning for thunderbird from the built xpi
	${INSTALL_DATA_DIR} ${LIGHTNINGDIR}
	unzip -q ${MOB}/../xpi-stage/lightning.xpi -d ${LIGHTNINGDIR}
	@@perl -pi -e 's,OpenBSD_</em:targetPlatform>,OpenBSD</em:targetPlatform>\n<em:type>2</em:type>,' ${LIGHTNINGDIR}/install.rdf

	# install lightning for seamonkey from the built xpi
	${INSTALL_DATA_DIR} ${SEAMONKEYDIR}
	unzip -q ${MOB}/../xpi-stage/lightning.xpi -d ${SEAMONKEYDIR}
	@@perl -pi -e 's,OpenBSD_</em:targetPlatform>,OpenBSD</em:targetPlatform>\n<em:type>2</em:type>,' ${SEAMONKEYDIR}/install.rdf
@


1.7
log
@As done in ffx/tb/sm, remove nss/nspr patches, as sunbird uses
systemwide nss/nspr too. While here dont call autojunk in nsprpub/,
and bump PKGNAMEs.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2010/04/27 21:00:50 landry Exp $
d11 3
a13 3
PKGNAME-main =		sunbird-${VER}p1
PKGNAME-lightning =	lightning-${VER}p0
PKGNAME-seamonkey =	lightning-seamonkey-${VER}p0
d22 1
a22 1
SO_VERSION =	15.0
@


1.6
log
@Same change as done for mail/mozilla-thunderbird, Harmonize default
search paths for systemwide sunbird extensions and plugins to
${LOCALBASE}/lib/mozilla/{plugins,extensions}.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2010/04/03 09:43:20 landry Exp $
d11 3
a13 3
PKGNAME-main =		sunbird-${VER}p0
PKGNAME-lightning =	lightning-${VER}
PKGNAME-seamonkey =	lightning-seamonkey-${VER}
a77 1
				${WRKSRC}/mozilla/nsprpub/build/autoconf \
a137 1
	cd ${WRKSRC}/mozilla/nsprpub && ${SETENV} ${AUTOCONF_ENV} ${AUTOCONF}
@


1.5
log
@Update to sunbird/lightning 1.0b1, the calendar and task management
suite from Mozilla.
http://weblogs.mozillazine.org/calendar/2010/04/sunbird_10_beta1_now_available.html
Note that development of standalone sunbird is stopped due to lack of
manpower, and efforts will port on lightning addon for
thunderbird/seamonkey from now on.
Update also largely based on www/firefox35 port, added a -seamonkey
subpackage to allow users to get lighting inside seamonkey suite.

ok naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2009/12/21 21:03:56 ajacoutot Exp $
d11 1
a11 1
PKGNAME-main =		sunbird-${VER}
d141 1
@


1.4
log
@Use @@unexec-delete instead of @@unexec for the *-update-* goos.

prodded by espie@@
discussed with espie@@ sthen@@ landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2009/11/18 08:56:40 landry Exp $
d7 1
d9 5
a13 4
VER =			0.9
DISTNAME =		lightning-sunbird-${VER}-source
PKGNAME-main =		sunbird-${VER}p2
PKGNAME-lightning =	lightning-${VER}p1
d18 1
a18 1
MULTI_PACKAGES =	-main -lightning
d20 12
a31 13
# need to be in synch with mail/mozilla-thunderbird for lighting to work
SO_VERSION =	14.0

.for _lib in accessibility appcomps auth autoconfig calbasecomps caps chrome commandlines \
	composer cookie docshell editor embedcomponents fileview gfx_gtk gfxps \
	gfxpsshar gkdebug gkgfx gklayout gtkembedmoz gtkxtbin htmlpars i18n imglib2 \
	import jar50 jsd ldap50 mail mailcomps mork mozfind mozjs mozldap \
	msgsmime myspell necko necko2 nkdatetime nkfinger nsappshell p3p permissions pipboot \
	pipnss pippki pref prldap50 rdf remoteservice schemavalidation \
	spellchecker sql sroaming storagecomps system-pref toolkitcomps transformiix typeaheadfind \
	txmgr uconv universalchardet wallet walletviewers webbrwsr websrvcs \
	widget_gtk2 xforms xmlextras xpcom xpcom_compat xpcom_compat_c xpcom_core \
	xpconnect xpinstall xpistub
d43 1
a43 1
MASTER_SITES =	http://releases.mozilla.org/pub/mozilla.org/calendar/sunbird/releases/${VER}/source/
d45 1
a45 1
MODULES =	devel/gettext
d53 1
d59 1
a59 1
WANTLIB-main += Xft Xi Xinerama Xrandr Xrender Xt atk-1.0 cairo expat
d62 1
a62 1
WANTLIB-main += pangoft2-1.0 pangox-1.0 pixman-1 png pthread stdc++
d65 2
a66 1
LIB_DEPENDS-lightning = mozilla-thunderbird/mozjs,mozilla-thunderbird/xpcom,mozilla-thunderbird/xpcom_core::mail/mozilla-thunderbird
d69 1
d76 3
a78 1
MODGNU_CONFIG_GUESS_DIRS =	${WRKSRC}/build/autoconf \
a83 1
		--with-system-png=${LOCALBASE}	\
a87 1
		--enable-xft			\
a88 1
		--enable-default-toolkit=gtk2	\
d96 2
a103 1
		--enable-extensions=default,lightning \
d106 3
a108 1
WRKDIST =	${WRKDIR}/mozilla
d110 1
a110 1
		LD_LIBRARY_PATH="${WRKSRC}/dist/bin" \
d119 1
a119 1
MOB =		${WRKSRC}/dist/bin
d125 1
d127 2
a128 2
DATADIRS =	chrome components defaults extensions \
		greprefs icons res js
d131 3
a133 1
	@@cp -f ${FILESDIR}/nsSound.cpp ${WRKSRC}/widget/src/gtk2/
d136 8
a143 5
	@@perl -pi -e 's|_LOCALBASE_|${LOCALBASE}|g; s|_X11BASE_|${X11BASE}|g' \
		${WRKSRC}/js/src/xpconnect/shell/Makefile.in \
		${WRKSRC}/mail/app/mozilla.in
	@@perl -pi -e 's|_SO_VERSION_|${SO_VERSION}|g' \
		${WRKSRC}/xpcom/components/nsNativeComponentLoader.cpp
d151 3
a153 4
	${INSTALL_DATA} ${MOB}/*.so.${SO_VERSION} \
		${WRKSRC}/LICENSE ${MOZ}
	${INSTALL_SCRIPT} ${MOB}/sunbird \
		${MOB}/sunbird-config ${PREFIX}/bin/
d159 4
a162 3
	@@sed -e 's,!!PREFIX!!,${TRUEPREFIX},g' \
		< ${FILESDIR}/sunbird.desktop > \
			${PREFIX}/share/applications/sunbird.desktop
d164 1
a164 1
	# install lightning from the built xpi
d168 5
@


1.3
log
@revert, sunbird uses systemwide nss and doesnt need this. discussed with aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2009/11/18 08:44:51 landry Exp $
d10 1
a10 1
PKGNAME-main =		sunbird-${VER}p1
@


1.2
log
@Pull in the same fix as applied in firefox35, mozilla-thunderbird and
seamonkey. Bump PKGNAMEs & SHARED_LIBS.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2009/11/10 20:48:06 landry Exp $
d10 2
a11 2
PKGNAME-main =		sunbird-${VER}p0
PKGNAME-lightning =	lightning-${VER}p0
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d10 2
a11 2
PKGNAME-main =		sunbird-${VER}
PKGNAME-lightning =	lightning-${VER}
d19 1
a19 1
SO_VERSION =	13.0
@


1.1.1.1
log
@Import Mozilla Sunbird/Lightning 0.9:
Mozilla Sunbird is a full blown enterprise ready calendar and task
management application, using Mozilla XUL framework. It supports local
and remote calendar using CalDAV or WCAP protocols, and subscription
to iCal/.ics invitations.
Lightning provides the calendar/task management extension for Mozilla
Thunderbird.
Port heavily based on mail/mozilla-thunderbird.
with feedback from sthen@@, jj@@, ian@@, Christian Rueger and Rune Lynge, thanks!
@
text
@@
