head	1.34;
access;
symbols
	OPENBSD_6_1:1.29.0.2
	OPENBSD_6_1_BASE:1.29
	OPENBSD_6_0:1.24.0.2
	OPENBSD_6_0_BASE:1.24
	OPENBSD_5_9:1.19.0.2
	OPENBSD_5_9_BASE:1.19
	OPENBSD_5_8:1.12.0.4
	OPENBSD_5_8_BASE:1.12
	OPENBSD_5_7:1.11.0.2
	OPENBSD_5_7_BASE:1.11
	OPENBSD_5_6:1.8.0.2
	OPENBSD_5_6_BASE:1.8
	OPENBSD_5_5:1.7.0.2
	OPENBSD_5_5_BASE:1.7
	OPENBSD_5_4:1.3.0.2
	OPENBSD_5_4_BASE:1.3
	OPENBSD_5_3:1.2.0.2
	OPENBSD_5_3_BASE:1.2
	phessler_20120917:1.1.1.1
	phessler:1.1.1;
locks; strict;
comment	@# @;


1.34
date	2017.08.24.06.05.27;	author ajacoutot;	state Exp;
branches;
next	1.33;
commitid	XiFyEmzD6nQJNISB;

1.33
date	2017.07.13.17.01.14;	author sthen;	state Exp;
branches;
next	1.32;
commitid	FxGgaeNVFEiHdwPj;

1.32
date	2017.07.10.20.10.36;	author sthen;	state Exp;
branches;
next	1.31;
commitid	uKZ0CrY3AmijfYLx;

1.31
date	2017.07.10.19.04.12;	author sthen;	state Exp;
branches;
next	1.30;
commitid	QrZXnaW6Gym3z6hM;

1.30
date	2017.06.28.16.34.59;	author sthen;	state Exp;
branches;
next	1.29;
commitid	lxDeoyUd8qfEGrgP;

1.29
date	2017.02.20.17.14.31;	author jca;	state Exp;
branches;
next	1.28;
commitid	WHSjcXb351Rm5oFZ;

1.28
date	2017.01.26.12.30.02;	author naddy;	state Exp;
branches;
next	1.27;
commitid	stiR17pMhtPummAL;

1.27
date	2016.09.23.09.16.57;	author sthen;	state Exp;
branches;
next	1.26;
commitid	XLnI6AbHAmyVU5mO;

1.26
date	2016.09.10.13.03.43;	author ajacoutot;	state Exp;
branches;
next	1.25;
commitid	4KcvAK91uGdTLejD;

1.25
date	2016.09.02.15.42.07;	author sthen;	state Exp;
branches;
next	1.24;
commitid	rnRJgAljeEbOhGGg;

1.24
date	2016.06.23.13.19.43;	author sthen;	state Exp;
branches;
next	1.23;
commitid	GiiYiHuayBScBcFP;

1.23
date	2016.05.27.12.53.13;	author sthen;	state Exp;
branches;
next	1.22;
commitid	BxNojVzFHGshcZBf;

1.22
date	2016.05.24.20.02.27;	author sthen;	state Exp;
branches;
next	1.21;
commitid	f9vUaU1ctI4AdCa1;

1.21
date	2016.05.19.09.22.11;	author sthen;	state Exp;
branches;
next	1.20;
commitid	8kCJk36A6Covenjd;

1.20
date	2016.04.13.09.44.25;	author sthen;	state Exp;
branches;
next	1.19;
commitid	NtVNS49EzY1x4djA;

1.19
date	2015.12.18.13.17.41;	author sthen;	state Exp;
branches;
next	1.18;
commitid	f5cqT0LpoiH1rnjq;

1.18
date	2015.10.17.10.29.04;	author ajacoutot;	state Exp;
branches;
next	1.17;
commitid	EJIyWGe7IqSOb7VO;

1.17
date	2015.10.05.16.29.02;	author sthen;	state Exp;
branches;
next	1.16;
commitid	AqjFzXOPaoxpieFE;

1.16
date	2015.10.01.16.28.01;	author sthen;	state Exp;
branches;
next	1.15;
commitid	QZ2oMy01Hc8NXyHn;

1.15
date	2015.09.11.20.54.54;	author sthen;	state Exp;
branches;
next	1.14;
commitid	IX5ecYF7ycYl4WHI;

1.14
date	2015.09.11.14.25.47;	author sthen;	state Exp;
branches;
next	1.13;
commitid	mmORkJfuXFOE28yK;

1.13
date	2015.09.08.17.48.55;	author sthen;	state Exp;
branches;
next	1.12;
commitid	VQR9r5oF3wOS8DRl;

1.12
date	2015.07.23.22.11.47;	author jca;	state Exp;
branches;
next	1.11;
commitid	Xk4FDEAV8EffI8yt;

1.11
date	2015.01.10.13.13.16;	author sthen;	state Exp;
branches;
next	1.10;
commitid	lIoXfSxsCIP9JfDf;

1.10
date	2015.01.10.12.44.01;	author sthen;	state Exp;
branches;
next	1.9;
commitid	iTyrNOxYupakCTaw;

1.9
date	2015.01.10.12.00.07;	author sthen;	state Exp;
branches;
next	1.8;
commitid	O3vkpKQB3Cadp8Th;

1.8
date	2014.07.05.10.03.05;	author sthen;	state Exp;
branches;
next	1.7;
commitid	nlP6EECq3goMn3PI;

1.7
date	2014.01.29.16.26.17;	author naddy;	state Exp;
branches;
next	1.6;

1.6
date	2013.11.27.14.14.22;	author jca;	state Exp;
branches;
next	1.5;

1.5
date	2013.10.31.21.12.13;	author sthen;	state Exp;
branches;
next	1.4;

1.4
date	2013.08.15.14.45.34;	author sthen;	state Exp;
branches;
next	1.3;

1.3
date	2013.03.11.11.41.29;	author espie;	state Exp;
branches;
next	1.2;

1.2
date	2013.02.12.16.23.33;	author chris;	state Exp;
branches;
next	1.1;

1.1
date	2012.09.17.13.51.51;	author phessler;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2012.09.17.13.51.51;	author phessler;	state Exp;
branches;
next	;


desc
@@


1.34
log
@Fix link order to unbreak with FTS5 enabled sqlite3.
@
text
@# $OpenBSD: Makefile,v 1.33 2017/07/13 17:01:14 sthen Exp $

COMMENT =	network switch style shell

DISTNAME =	nsh-1.0.20160605
REVISION =	9

GH_ACCOUNT =	yellowman
GH_PROJECT =	nsh
GH_COMMIT =	ef0ff429c8b61365b070fc4feee00a4c0dbc9960

CATEGORIES =	shells net
HOMEPAGE =	http://www.nmedia.net/nsh/

# 3 & 2 clause BSD
PERMIT_PACKAGE_CDROM =	Yes

WANTLIB += c edit termcap sqlite3

FLAVORS =	static
FLAVOR ?=

MAKE_FLAGS =	CC="${CC}" \
		CPPFLAGS="-I${LOCALBASE}/include" \
		LDFLAGS="-L${LOCALBASE}/lib"
LIB_DEPENDS =	databases/sqlite3

.if ${FLAVOR:Mstatic}
MAKE_FLAGS +=	LDADD="-ledit -ltermcap -lsqlite3 -lm -lpthread -static"
.endif

do-install:
	${INSTALL_PROGRAM} ${WRKDIST}/nsh ${PREFIX}/bin
.for i in save-ro.sh save-rw.sh
	${INSTALL_SCRIPT} ${WRKDIST}/${i} ${PREFIX}/bin
.endfor
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/nsh
	sed -i s,/usr/local,${LOCALBASE},g ${WRKDIST}/MANUAL
.for i in MANUAL README TODO COPYRIGHT
	${INSTALL_DATA} ${WRKDIST}/${i} ${PREFIX}/share/doc/nsh/
.endfor

.include <bsd.port.mk>
@


1.33
log
@IPV6CTL_MAXIFDEFROUTERS, IPV6CTL_MAXIFPREFIXES going away - patch nsh to cope.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2017/07/10 20:10:36 sthen Exp $
d6 1
a6 1
REVISION =	8
d29 1
a29 1
MAKE_FLAGS +=	LDADD="-ledit -ltermcap -lsqlite3 -lpthread -static"
@


1.32
log
@tweak nsh's MANUAL a bit, especially rc.local suggestions (/usr/local/bin isn't
in the default PATH, and the current example with tee hangs)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2017/07/10 19:04:12 sthen Exp $
d6 1
a6 1
REVISION =	7
@


1.31
log
@convert nsh's save.sh from a symlink to an @@sample, such that it can be
modified or pointed to an alternative file (e.g. save-ro.sh instead of the
standard save-rw.sh) and have the changes stay intact after pkg_add -u.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2017/06/28 16:34:59 sthen Exp $
d6 1
a6 1
REVISION =	6
d38 1
@


1.30
log
@disable timeslots code to unbreak following SIOCSIFTIMESLOT removal
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2017/02/20 17:14:31 jca Exp $
d6 1
a6 1
REVISION =	5
a36 1
	ln -s ${TRUEPREFIX}/bin/save-rw.sh ${PREFIX}/bin/save.sh
@


1.29
log
@Adapt after the struct ipipstat members size bump
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2017/01/26 12:30:02 naddy Exp $
d6 1
a6 1
REVISION =	4
@


1.28
log
@fix build after recent network changes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2016/09/23 09:16:57 sthen Exp $
d6 1
a6 1
REVISION =	3
@


1.27
log
@Cope with moving sqlite3 back to ports.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2016/09/10 13:03:43 ajacoutot Exp $
d6 1
a6 1
REVISION =	2
@


1.26
log
@First pass at pre-entively fixing ports that would break once guenther's header
pollution diff is in.

lang/squeak/vm does not build but it's due to the recent audio changes
games/xbattle: also fixes some conflicting implicit decl
print/hplip: also fixes some conflicting implicit decl
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2016/09/02 15:42:07 sthen Exp $
d6 1
a6 1
REVISION =	1
d23 4
a26 1
MAKE_FLAGS =	CC="${CC}"
d29 1
a29 1
MAKE_FLAGS +=	LDADD="-ledit -ltermcap -lsqlite3 -static"
@


1.25
log
@handle RTF_MASK removal
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2016/06/23 13:19:43 sthen Exp $
d6 1
a6 1
REVISION =	0
@


1.24
log
@update to newer nsh snapshot
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2016/05/27 12:53:13 sthen Exp $
d6 1
@


1.23
log
@update to newer nsh snapshot
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2016/05/24 20:02:27 sthen Exp $
d5 1
a5 1
DISTNAME =	nsh-1.0.20160527
d9 1
a9 1
GH_COMMIT =	386f8ce0559d043e0dc5fa96a8015c3744bd1c69
d23 1
@


1.22
log
@update to 20160524 snapshot of nsh
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2016/05/19 09:22:11 sthen Exp $
d5 1
a5 1
DISTNAME =	nsh-1.0.20160524
d9 1
a9 1
GH_COMMIT =	c87609b45c9e413b62c157c4ac2f5ec95c98ac6d
@


1.21
log
@update to new nsh snapshot, including jca's patch to remove IPV6CTL_V6ONLY
(which is a noop anyway) and more useful pppoe support (saves authkey)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2016/04/13 09:44:25 sthen Exp $
d5 1
a5 1
DISTNAME =	nsh-1.0.20160519
d9 1
a9 1
GH_COMMIT =	878764c385c0f0d2a1ec3e87ee7153daefdc4be8
@


1.20
log
@add an optional static flavour to nsh
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2015/12/18 13:17:41 sthen Exp $
d5 1
a5 2
DISTNAME =	nsh-1.0.20151213
REVISION =	0
d9 1
a9 1
GH_COMMIT =	d20e09e1dab907067eaad228432af8b0117cb741
@


1.19
log
@update to nsh-20151213, unbreak
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2015/10/17 10:29:04 ajacoutot Exp $
d3 1
a3 1
COMMENT =		network switch style shell
d5 2
a6 1
DISTNAME =		nsh-1.0.20151213
d8 3
a10 4
GH_ACCOUNT =		yellowman
GH_PROJECT =		nsh
GH_COMMIT =		d20e09e1dab907067eaad228432af8b0117cb741
#WRKDIST =		${WRKDIR}/nsh-${GH_COMMIT}
d12 2
a13 2
CATEGORIES =		shells net
HOMEPAGE =		http://www.nmedia.net/nsh/
d20 7
a26 1
MAKE_FLAGS =		CC="${CC}"
@


1.18
log
@BROKEN=need to be adapted to current pflow(4)

ok sthen@@
@
text
@d1 1
a1 3
# $OpenBSD: Makefile,v 1.17 2015/10/05 16:29:02 sthen Exp $

BROKEN =		need to be adapted to current pflow(4)
d5 1
a5 2
DISTNAME =		nsh-1.0.20150914
REVISION =		0
d9 2
a10 2
GH_COMMIT =		d152f0631ad4e9cd40f093f548e771cf7d019286
WRKDIST =		${WRKDIR}/nsh-${GH_COMMIT}
@


1.17
log
@REVISION bumps following the additional member in struct if_data,
to make sure packages get updated
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.16 2015/10/01 16:28:01 sthen Exp $
@


1.16
log
@update to newer nsh snapshot
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2015/09/11 20:54:54 sthen Exp $
d6 1
@


1.15
log
@-RTF_XRESOLVE
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2015/09/11 14:25:47 sthen Exp $
d5 1
a5 2
DISTNAME =		nsh-1.0.20150902
REVISION =		1
d9 1
a9 1
GH_COMMIT =		49782fe717102b640d1ab98d666bdc295a8a8b60
@


1.14
log
@fix shells/nsh with ifmedia64
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2015/09/08 17:48:55 sthen Exp $
d6 1
a6 1
REVISION =		0
@


1.13
log
@update to a new snapshot of nsh
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2015/07/23 22:11:47 jca Exp $
d6 1
@


1.12
log
@Unbreak nsh: remove MPLS ifq reporting support

Noticed by ajacoutot@@ and nigel@@, ok sthen@@ chris@@ (upstream)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2015/01/10 13:13:16 sthen Exp $
d5 1
a5 2
DISTNAME =		nsh-1.0.20140503
REVISION =		2
d9 1
a9 1
GH_COMMIT =		17aad6edd4ad4b0a7f4f281aa575490cbe68606a
a19 1
#MASTER_SITES =		ftp://ftp.nmedia.net/pub/nsh/
@


1.11
log
@fix nsh use-after-free in tab completion of ifnames
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2015/01/10 12:44:01 sthen Exp $
d6 1
a6 1
REVISION =		1
@


1.10
log
@Patch nsh with an initial fix following NOINET6 removal.

"no inet6" (to remove ip6 from an interface after it has been
explicitly or implicitly added) is not yet supported.

"inet6 autoconf" also needs to be handled (replacement for rtsol).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2015/01/10 12:00:07 sthen Exp $
d6 1
a6 1
REVISION =		0
@


1.9
log
@Switch shells/nsh to fetching from github, which has most of our patches
rolled in. (Build currently fails due to noinet6 changes, this change
doesn't fix this yet).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2014/07/05 10:03:05 sthen Exp $
d6 1
d31 1
a31 1
.for i in MANUAL README TODO COPYRIGHT ChangeLog
@


1.8
log
@fix following move from struct pool to struct kinfo_pool for userland
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2014/01/29 16:26:17 naddy Exp $
d5 6
a10 2
DISTNAME =		nsh-1.0
REVISION =		4
d20 1
a20 2
MASTER_SITES =		ftp://ftp.nmedia.net/pub/nsh/
WRKDIST =		${WRKDIR}/nsh
@


1.7
log
@Catch up with network header changes and fix time_t type mismatches.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2013/11/27 14:14:22 jca Exp $
d6 1
a6 1
REVISION =		3
@


1.6
log
@Unbreak after net*/ headers changes.  Patches by mikeb@@, applied
upstream by chris@@.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2013/10/31 21:12:13 sthen Exp $
d6 1
a6 1
REVISION =		2
@


1.5
log
@bump REVISION for any ports using route messages. regen some distinfos and
remove unnecessary USE_GROFFs while there.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2013/08/15 14:45:34 sthen Exp $
d6 1
a6 1
REVISION =		1
@


1.4
log
@bump due to SIOCGETVLAN/SIOCSETVLAN abi change. slight Makefile tidying
while there.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2013/03/11 11:41:29 espie Exp $
d6 1
a6 1
REVISION =		0
@


1.3
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 2
a2 1
# $OpenBSD: Makefile,v 1.2 2013/02/12 16:23:33 chris Exp $
d5 2
a6 3
V =			1.0
DISTNAME =		nsh-${V}
PKGNAME =		nsh-${V}
@


1.2
log
@update to 1.0
ok sthen, naddy
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2012/09/17 13:51:51 phessler Exp $
a12 3
PERMIT_PACKAGE_FTP =	Yes
PERMIT_DISTFILES_CDROM =Yes
PERMIT_DISTFILES_FTP =	Yes
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.template,v 1.61 2012/03/29 13:41:58 sthen Exp $
d4 1
a4 1
V =			20120523
d6 1
a6 1
PKGNAME =		nsh-0.0.${V}
d17 1
a17 1
WANTLIB += c edit termcap
@


1.1.1.1
log
@NSH consolidates configuration for interfaces, bridging, routing, PF
packet filtering, NAT, queueing, BGP, OSPF, RIP, IPsec, DHCP, DVMRP,
SNMP, relayd, sshd, inetd, ftp-proxy, resolv.conf and NTP. It presents
the user with a vaguely cisco-like interface with all configuration in
one easy to read text list.

some improvements from, and OK, sthen@@
@
text
@@
