head	1.2;
access;
symbols
	OPENBSD_3_0:1.1.0.2
	OPENBSD_3_0_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2001.11.18.18.24.19;	author lebel;	state dead;
branches;
next	1.1;

1.1
date	2001.09.07.02.11.47;	author lebel;	state Exp;
branches;
next	;


desc
@@


1.2
log
@update zsh/stable to 4.0.4:
--
This is a maintenance release of the stable 4.0 series. A large number
of small bugfixes have been made covering the whole shell. There are
very few user-visible changes, mostly minor enhancements to the
completion function system.
@
text
@$OpenBSD: patch-zshconfig_ac,v 1.1 2001/09/07 02:11:47 lebel Exp $
--- zshconfig.ac.orig	Tue Jun 26 06:08:54 2001
+++ zshconfig.ac	Thu Sep  6 13:24:37 2001
@@@@ -1602,7 +1602,14 @@@@ char *argv[];
   else
     case "$host" in
       *openbsd*)
-	DLLD="${DLLD=$CC}"
+	case "$host_os" in
+	  openbsd[01].* | openbsd2.[0-7] | openbsd2.[0-7].*)
+	    DLLD="${DLLD=ld}"
+	  ;;
+	  *)
+	    DLLD="${DLLD=$CC}"
+	  ;;
+	esac
 	DLLDARG="${LDARG}"
       ;;
       * )
@@@@ -1630,11 +1637,29 @@@@ char *argv[];
     netbsd*)      DLLDFLAGS="${DLLDFLAGS=${DLLDARG}-x -shared --whole-archive}" ;;
     aix*)         DLLDFLAGS="${DLLDFLAGS=-G -bexpall -lc}" ;;
     solaris*|sysv4*|esix*) DLLDFLAGS="${DLLDFLAGS=-G}" ;;
-    openbsd*)     DLLDFLAGS="${DLLDFLAGS=-shared -fPIC}" ;;
+    openbsd*)
+      if test $zsh_cv_sys_elf = yes; then
+	DLLDFLAGS="${DLLDFLAGS=-shared -fPIC}"
+      else
+	case "$host_os" in
+	  openbsd[01].* | openbsd2.[0-7] | openbsd2.[0-7].*)
+	   DLLDFLAGS="${DLLDFLAGS=-Bshareable}"
+	  ;;
+	  *)
+	    DLLDFLAGS="${DLLDFLAGS=-shared -fPIC}"
+	  ;;
+	esac
+      fi
+    ;;
   esac
   case "$host" in
     *-hpux*)  EXTRA_LDFLAGS="${EXTRA_LDFLAGS=-Wl,-E}" ;;
     *-freebsd[3-9]*|*-linux*) EXTRA_LDFLAGS="${EXTRA_LDFLAGS=-rdynamic}" ;;
+    *openbsd*)
+       if test $zsh_cv_sys_elf = yes; then
+	 EXTRA_LDFLAGS="${EXTRA_LDFLAGS=-Wl,-E}"
+       fi
+    ;;
     mips-sni-sysv4)
       #
       # unfortunately, we have different compilers
@


1.1
log
@new patches to zshconfig_ac to build modules under ELF archs.
thanks brad@@
@
text
@d1 1
a1 1
$OpenBSD$
@

