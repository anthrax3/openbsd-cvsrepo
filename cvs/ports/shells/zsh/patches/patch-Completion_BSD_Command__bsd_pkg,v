head	1.4;
access;
symbols
	OPENBSD_6_0:1.4.0.4
	OPENBSD_6_0_BASE:1.4
	OPENBSD_5_9:1.4.0.2
	OPENBSD_5_9_BASE:1.4
	OPENBSD_5_8:1.2.0.42
	OPENBSD_5_8_BASE:1.2
	OPENBSD_5_7:1.2.0.38
	OPENBSD_5_7_BASE:1.2
	OPENBSD_5_6:1.2.0.36
	OPENBSD_5_6_BASE:1.2
	OPENBSD_5_5:1.2.0.34
	OPENBSD_5_5_BASE:1.2
	OPENBSD_5_4:1.2.0.32
	OPENBSD_5_4_BASE:1.2
	OPENBSD_5_3:1.2.0.30
	OPENBSD_5_3_BASE:1.2
	OPENBSD_5_2:1.2.0.28
	OPENBSD_5_2_BASE:1.2
	OPENBSD_5_1_BASE:1.2
	OPENBSD_5_1:1.2.0.26
	OPENBSD_5_0:1.2.0.24
	OPENBSD_5_0_BASE:1.2
	OPENBSD_4_9:1.2.0.22
	OPENBSD_4_9_BASE:1.2
	OPENBSD_4_8:1.2.0.20
	OPENBSD_4_8_BASE:1.2
	OPENBSD_4_7:1.2.0.18
	OPENBSD_4_7_BASE:1.2
	OPENBSD_4_6:1.2.0.16
	OPENBSD_4_6_BASE:1.2
	OPENBSD_4_5:1.2.0.14
	OPENBSD_4_5_BASE:1.2
	OPENBSD_4_4:1.2.0.12
	OPENBSD_4_4_BASE:1.2
	OPENBSD_4_3:1.2.0.10
	OPENBSD_4_3_BASE:1.2
	OPENBSD_4_2:1.2.0.8
	OPENBSD_4_2_BASE:1.2
	OPENBSD_4_1:1.2.0.6
	OPENBSD_4_1_BASE:1.2
	OPENBSD_4_0:1.2.0.4
	OPENBSD_4_0_BASE:1.2
	OPENBSD_3_9:1.2.0.2
	OPENBSD_3_9_BASE:1.2
	OPENBSD_3_8:1.1.0.6
	OPENBSD_3_8_BASE:1.1
	OPENBSD_3_7:1.1.0.4
	OPENBSD_3_7_BASE:1.1
	OPENBSD_3_6:1.1.0.2
	OPENBSD_3_6_BASE:1.1;
locks; strict;
comment	@# @;


1.4
date	2015.12.21.19.13.17;	author jasper;	state Exp;
branches;
next	1.3;
commitid	P4lxMRVUY8B1zV48;

1.3
date	2015.11.06.14.17.03;	author pea;	state Exp;
branches;
next	1.2;
commitid	idt9NM6zv04gvKJd;

1.2
date	2006.01.29.20.41.02;	author sturm;	state Exp;
branches;
next	1.1;

1.1
date	2004.07.12.19.46.52;	author lebel;	state Exp;
branches;
next	;


desc
@@


1.4
log
@- add completion type for object files
this applies the same fix we have for nm(1) to other programs too

from Matthew Martin
ok pea@@ (MAINTAINER)
@
text
@$OpenBSD: patch-Completion_BSD_Command__bsd_pkg,v 1.3 2015/11/06 14:17:03 pea Exp $

From 3272bdce987a3e5d5448688529ccb8290e148a67 Mon Sep 17 00:00:00 2001
From: Matthew Martin <phy1729@@gmail.com>
Date: Fri, 11 Dec 2015 11:51:09 +0100
Subject: [PATCH] 37383: add completion type for object files

--- Completion/BSD/Command/_bsd_pkg.orig	Wed Jan 21 14:53:28 2004
+++ Completion/BSD/Command/_bsd_pkg	Mon Jan 23 21:30:02 2006
@@@@ -6,15 +6,19 @@@@ _bsd_pkg_pkgfiles() {
 
   case $OSTYPE in
   netbsd*)
-    portsdir=/usr/pkgsrc
+    portsdir=${PORTSDIR:-/usr/pkgsrc}
+    pkgsdir=${PACKAGES:-$portsdir/packages}/All
     ;;
+  openbsd*)
+    portsdir=${PORTSDIR:-/usr/ports}
+    pkgsdir=${PACKAGES:-$portsdir/packages}/$(arch -s)/All
+    ;;
   *)
     portsdir=${PORTSDIR:-/usr/ports}
+    pkgsdir=${PACKAGES:-$portsdir/packages}/All
     ;;
   esac
 
-  pkgsdir=${PACKAGES:-$portsdir/packages}/All
-
   paths=( "${(@@)${(@@s.:.)PKG_PATH}:#}" )
   _files "$@@" -g '*.t[bg]z(-.)' && ret=0
   (( $#path )) && _files "$@@" -W paths -g '*.t[bg]z(-.)' && ret=0
@@@@ -25,7 +29,7 @@@@ _bsd_pkg_pkgfiles() {
 
 (( $+functions[_bsd_pkg_pkgs] )) ||
 _bsd_pkg_pkgs() {
-  compadd "$@@" - ${PKG_DBDIR:-/var/db/pkg}/*(/:t)
+  compadd "$@@" - ${PKG_DBDIR:-/var/db/pkg}/*(-/:t)
 }
 
 (( $+functions[_bsd_pkg_pkgs_and_files] )) ||
@@@@ -67,9 +71,9 @@@@ _bsd_pkg() {
       ;;
     netbsd*)
       flags=(
-	$flags[@@]
-	'-u[update]'
-	'-V[show version and exit]'
+        $flags[@@]
+        '-u[update]'
+        '-V[show version and exit]'
       )
       ;;
     esac
@@@@ -83,37 +87,37 @@@@ _bsd_pkg() {
     case "$OSTYPE" in
     freebsd*)
       flags=(
-	'-f[specify plist file]:plist file:_files'
-	'(-b)-c[specify comment file]:comment file:_files'
-	'(-b)-d[specify descr file]:descr file:_files'
-	'-Y[assume YES for any questions asked]'
-	'-N[assume NO for any questions asked]'
-	'(-b)-O[packing list only mode]'
-	'-v[be verbose]'
-	'-h[force tar to follow symlinks]'
-	'(-b)-i[specify pre-install script]:pre-install script:_files'
-	'(-b)-I[specify post-install script]:post-install script:_files'
-	'(-b)-P[specify initial dependencies]:dependencies:_bsd_pkg_pkgs'
-	'(-b)-p[specify prefix]:prefix directory:_files -/'
-	'(-b)-k[specify deinstall script]:deinstall script:_files'
-	'(-b)-K[specify post-deinstall script]:post-deinstall script:_files'
-	'(-b)-r[specify req script]:req script:_files'
-	'(-b)-s[specify source directory]:source directory:_files -/'
-	'(-b)-t[specify mktemp template]:mktemp template:_files'
-	'(-b)-X[specify exclude file]:exclude file for tar:_files'
-	'(-b)-D[specify message file]:message file:_files'
-	'(-b)-m[specify mtree file]:mtree file:_files'
-	'(-b)-o[specify origin]:origin:_files -W ${PORTSDIR\:-/usr/ports} -/'
-	'-j[use bzip2]'
-	'-z[use gzip]'
-	'(-c -d -O -i -I -P -p -k -K -r -s -t -X -D -m -o)-b[specify pkgname]:pkgname:_bsd_pkg_pkgs'
-	'*:package file name:_files'
+        '-f[specify plist file]:plist file:_files'
+        '(-b)-c[specify comment file]:comment file:_files'
+        '(-b)-d[specify descr file]:descr file:_files'
+        '-Y[assume YES for any questions asked]'
+        '-N[assume NO for any questions asked]'
+        '(-b)-O[packing list only mode]'
+        '-v[be verbose]'
+        '-h[force tar to follow symlinks]'
+        '(-b)-i[specify pre-install script]:pre-install script:_files'
+        '(-b)-I[specify post-install script]:post-install script:_files'
+        '(-b)-P[specify initial dependencies]:dependencies:_bsd_pkg_pkgs'
+        '(-b)-p[specify prefix]:prefix directory:_files -/'
+        '(-b)-k[specify deinstall script]:deinstall script:_files'
+        '(-b)-K[specify post-deinstall script]:post-deinstall script:_files'
+        '(-b)-r[specify req script]:req script:_files'
+        '(-b)-s[specify source directory]:source directory:_files -/'
+        '(-b)-t[specify mktemp template]:mktemp template:_files'
+        '(-b)-X[specify exclude file]:exclude file for tar:_files'
+        '(-b)-D[specify message file]:message file:_files'
+        '(-b)-m[specify mtree file]:mtree file:_files'
+        '(-b)-o[specify origin]:origin:_files -W ${PORTSDIR\:-/usr/ports} -/'
+        '-j[use bzip2]'
+        '-z[use gzip]'
+        '(-c -d -O -i -I -P -p -k -K -r -s -t -X -D -m -o)-b[specify pkgname]:pkgname:_bsd_pkg_pkgs'
+        '*:package file name:_files'
       )
       ;;
     netbsd*)
       # NetBSD users, improve me!
       flags=(
-	'*:package name:_bsd_pkg_pkgs'
+        '*:package name:_bsd_pkg_pkgs'
       )
       ;;
     esac
@@@@ -136,35 +140,43 @@@@ _bsd_pkg() {
     freebsd*)
       flags=(
         $flags[@@]
-	'(:)-a[delete all installed packages]'
+        '(:)-a[delete all installed packages]'
         '-G[do not expand glob patterns]'
-	'-i[be interactive]'
+        '-i[be interactive]'
         '-r[delete recursively]'
         '-x[use regular expression]'
       )
       ;;
     netbsd*)
       flags=(
-	$flags[@@]
-	'(:)-a[delete all installed packages]'
-	'-F[specify each package by an installed file]'
-	'-i[be interactive]'
-	'-O[only delete the package'\''s entries]'
+        $flags[@@]
+        '(:)-a[delete all installed packages]'
+        '-F[specify each package by an installed file]'
+        '-i[be interactive]'
+        '-O[only delete the package'\''s entries]'
         '-R[delete upward recursively]'
         '-r[delete recursively]'
-	'-V[show version and exit]'
+        '-V[show version and exit]'
       )
       ;;
     esac
 
-    _arguments -s \
-      $flags[@@] \
-      '(-a)*:package name:_bsd_pkg_pkgs_and_files'
+    case "$OSTYPE" in
+    openbsd*)
+      _arguments -s \
+        $flags[@@] \
+        '*:installed package name:_bsd_pkg_pkgs'
+      ;;
+    *)
+      _arguments -s \
+        $flags[@@] \
+        '(-a)*:package name:_bsd_pkg_pkgs_and_files'
+      ;;
+    esac
     ;;
 
   pkg_info)
     flags=(
-      '(:)-a[show all installed packages]'
       '-c[show comment fields]'
       '-D[show install-message files]'
       '-d[show long descriptions]'
@@@@ -188,30 +200,41 @@@@ _bsd_pkg() {
       flags=(
         $flags[@@]
         '-G[do not expand glob patterns]'
-	'-g[show files that'\''s modified]'
-	'-o[show origin]'
-	'-s[show total size occupied by each package]'
-	'-t[specify mktemp template]:mktemp template:_files -/'
-	'*-W[show which package the file belongs to]:file:_files'
-	'-x[use regular expression]'
+        '-g[show files that are modified]'
+        '-o[show origin]'
+        '-s[show total size occupied by each package]'
+        '-t[specify mktemp template]:mktemp template:_files -/'
+        '*-W[show which package the file belongs to]:file:_files'
+        '-x[use regular expression]'
       )
       ;;
     netbsd*)
       flags=(
-	$flags[@@]
-	'-B[show build information]'
-	'-b[show RCS Id strings]'
-	'-F[specify each package by an installed file]'
-	'-S[show total size occupied by each package and its dependents]'
-	'-s[show total size occupied by each package]'
-	'-V[show version and exit]'
+        $flags[@@]
+        '-B[show build information]'
+        '-b[show RCS Id strings]'
+        '-F[specify each package by an installed file]'
+        '-S[show total size occupied by each package and its dependents]'
+        '-s[show total size occupied by each package]'
+        '-V[show version and exit]'
       )
       ;;
     esac
 
-    _arguments -s \
-      $flags[@@] \
-      '(-a)*:package name:_bsd_pkg_pkgs_and_files'
+    case "$OSTYPE" in
+    openbsd*)
+      _arguments -s \
+        '(* -)-a[show all installed packages]' \
+        $flags[@@] \
+        '*:installed package name:_bsd_pkg_pkgs'
+      ;;
+    *)
+      _arguments -s \
+        '(:)-a[show all installed packages]' \
+        $flags[@@] \
+        '(-a)*:package name:_bsd_pkg_pkgs_and_files'
+      ;;
+    esac
     ;;
   esac
 }
@


1.3
log
@Update to 5.1.1

from Matthew Martin <phy1729 at gmail dot com>, thanks.
@
text
@d1 7
a7 1
$OpenBSD: patch-Completion_BSD_Command__bsd_pkg,v 1.2 2006/01/29 20:41:02 sturm Exp $
@


1.2
log
@update to zsh 4.2.6

from Frank Denis <obsd-ports at pureftpd.org>
@
text
@d1 1
a1 1
$OpenBSD: patch-Completion_BSD_Command__bsd_pkg,v 1.1 2004/07/12 19:46:52 lebel Exp $
a35 15
@@@@ -48,11 +52,11 @@@@ _bsd_pkg() {
   pkg_add)
     flags=(
       '-f[force installation]'
-      '-I[don'\''t execute installation scripts]'
+      '-I[don''t execute installation scripts]'
       '-M[run in master mode]'
-      '-n[don'\''t really install packages]'
+      '-n[don''t really install packages]'
       '-p[specify prefix]:prefix directory:_files -/'
-      '-R[don'\''t record]'
+      '-R[don''t record]'
       '-S[run in slave mode]'
       '-t[specify mktemp template]:mktemp template:_files -/'
       '-v[be verbose]'
a112 13
@@@@ -124,10 +128,10 @@@@ _bsd_pkg() {
 
   pkg_delete)
     flags=(
-      '-D[don'\''t execute deinstallation scripts]'
+      '-D[don''t execute deinstallation scripts]'
       '-d[remove empty directories]'
       '-f[force deinstallation]'
-      '-n[don'\''t really deinstall packages]'
+      '-n[don''t really deinstall packages]'
       '-p[specify prefix]:prefix directory:_files -/'
       '-v[be verbose]'
     )
d137 1
a137 1
+        '-O[only delete the package''s entries]'
@


1.1
log
@nuke stable/snapshot trees
@
text
@d1 3
a3 3
$OpenBSD: patch-Completion_BSD_Command__bsd_pkg,v 1.4 2003/07/03 12:56:52 lebel Exp $
--- Completion/BSD/Command/_bsd_pkg.orig	Tue Oct 15 13:59:37 2002
+++ Completion/BSD/Command/_bsd_pkg	Fri May 23 10:13:59 2003
d11 1
a11 1
+    ;;
d15 1
a15 1
     ;;
d25 2
a26 2
   _files "$@@" -g '*.t[bg]z' && ret=0
   (( $#path )) && _files "$@@" -W paths -g '*.t[bg]z' && ret=0
@

