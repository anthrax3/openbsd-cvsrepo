head	1.2;
access;
symbols
	OPENBSD_4_9:1.1.0.2;
locks; strict;
comment	@# @;


1.2
date	2011.06.22.11.41.35;	author pea;	state dead;
branches;
next	1.1;

1.1
date	2011.03.04.10.08.59;	author pea;	state Exp;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2011.03.16.14.16.37;	author pea;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Update to 4.3.12

ok jasper@@
@
text
@$OpenBSD: patch-Src_subst_c,v 1.1 2011/03/04 10:08:59 pea Exp $

Fix for ${foo:0:} crash

--- Src/subst.c.orig	Thu Dec 16 10:26:50 2010
+++ Src/subst.c	Thu Mar  3 15:14:28 2011
@@@@ -2814,12 +2814,14 @@@@ paramsubst(LinkList l, LinkNode n, char **str, int qt,
 			zerr("invalid length: %s", check_offset);
 			return NULL;
 		    }
-		    length = mathevali(check_offset);
-		    if (errflag)
-			return NULL;
-		    if (length < (zlong)0) {
-			zerr("invalid length: %s", check_offset);
-			return NULL;
+                    if (check_offset) {
+			length = mathevali(check_offset);
+			if (errflag)
+			    return NULL;
+			if (length < (zlong)0) {
+			    zerr("invalid length: %s", check_offset);
+			    return NULL;
+			}
 		    }
 		}
 		if (horrible_offset_hack) {
@


1.1
log
@Fix the ${foo:0:} crash

ok ajacoutot@@, jasper@@
@
text
@d1 1
a1 1
$OpenBSD$
@


1.1.2.1
log
@Fix the ${foo:0:} crash

ok ajacoutot@@, jasper@@
@
text
@@

