head	1.5;
access;
symbols
	OPENBSD_6_1:1.4.0.10
	OPENBSD_6_1_BASE:1.4
	OPENBSD_6_0:1.4.0.8
	OPENBSD_6_0_BASE:1.4
	OPENBSD_5_9:1.4.0.4
	OPENBSD_5_9_BASE:1.4
	OPENBSD_5_8:1.4.0.6
	OPENBSD_5_8_BASE:1.4
	OPENBSD_5_7:1.4.0.2
	OPENBSD_5_7_BASE:1.4
	OPENBSD_5_6:1.2.0.4
	OPENBSD_5_6_BASE:1.2
	OPENBSD_5_5:1.2.0.2
	OPENBSD_5_5_BASE:1.2
	OPENBSD_5_4:1.1.0.2
	OPENBSD_5_4_BASE:1.1;
locks; strict;
comment	@# @;


1.5
date	2017.08.28.05.21.22;	author dcoppa;	state Exp;
branches;
next	1.4;
commitid	caXKFJ4jJhS8W8PX;

1.4
date	2015.02.13.15.24.59;	author dcoppa;	state Exp;
branches;
next	1.3;
commitid	tMZ7Xu6c8ZJYcg4A;

1.3
date	2014.12.11.11.21.55;	author dcoppa;	state Exp;
branches;
next	1.2;
commitid	m1vacJYnVVoHFQL5;

1.2
date	2014.01.22.12.01.57;	author dcoppa;	state Exp;
branches;
next	1.1;

1.1
date	2013.05.17.07.52.48;	author dcoppa;	state Exp;
branches;
next	;


desc
@@


1.5
log
@
Update to ruby-redis-4.0.0
@
text
@$OpenBSD: patch-test_publish_subscribe_test_rb,v 1.4 2015/02/13 15:24:59 dcoppa Exp $
Index: test/publish_subscribe_test.rb
--- test/publish_subscribe_test.rb.orig
+++ test/publish_subscribe_test.rb
@@@@ -233,7 +233,7 @@@@ class TestPublishSubscribe < Test::Unit::TestCase
   def test_subscribe_past_a_timeout
     # For some reason, a thread here doesn't reproduce the issue.
     sleep = %{sleep #{OPTIONS[:timeout] * 2}}
-    publish = %{ruby -rsocket -e 't=TCPSocket.new("127.0.0.1",#{OPTIONS[:port]});t.write("publish foo bar\\r\\n");t.read(4);t.close'}
+    publish = %{${LOCALBASE}/bin/ruby${GEM_BIN_SUFFIX} -rsocket -e 't=TCPSocket.new("127.0.0.1",#{OPTIONS[:port]});t.write("publish foo bar\\r\\n");t.read(4);t.close'}
     cmd = [sleep, publish].join("; ")
 
     IO.popen(cmd, "r+") do |pipe|
@


1.4
log
@
Update to ruby-redis-3.2.1
@
text
@d1 5
a5 4
$OpenBSD: patch-test_publish_subscribe_test_rb,v 1.3 2014/12/11 11:21:55 dcoppa Exp $
--- test/publish_subscribe_test.rb.orig	Wed Feb 11 13:21:18 2015
+++ test/publish_subscribe_test.rb	Fri Feb 13 08:25:04 2015
@@@@ -235,7 +235,7 @@@@ class TestPublishSubscribe < Test::Unit::TestCase
@


1.3
log
@
Update to ruby-redis-3.2.0
@
text
@d1 4
a4 4
$OpenBSD: patch-test_publish_subscribe_test_rb,v 1.2 2014/01/22 12:01:57 dcoppa Exp $
--- test/publish_subscribe_test.rb.orig	Wed Dec 10 20:27:10 2014
+++ test/publish_subscribe_test.rb	Thu Dec 11 04:33:53 2014
@@@@ -191,7 +191,7 @@@@ class TestPublishSubscribe < Test::Unit::TestCase
@


1.2
log
@
Update to ruby-redis-3.0.7
@
text
@d1 3
a3 3
$OpenBSD: patch-test_publish_subscribe_test_rb,v 1.1 2013/05/17 07:52:48 dcoppa Exp $
--- test/publish_subscribe_test.rb.orig	Thu Jan  1 01:00:00 1970
+++ test/publish_subscribe_test.rb	Wed Jan 22 12:48:13 2014
d8 2
a9 2
-    publish = %{echo "publish foo bar\r\n" | nc 127.0.0.1 #{OPTIONS[:port]}}
+    publish = %{echo "publish foo bar\r\n" | nc -N 127.0.0.1 #{OPTIONS[:port]}}
@


1.1
log
@Update to redis-rb-3.0.4
@
text
@d1 4
a4 4
$OpenBSD$
--- test/publish_subscribe_test.rb.orig	Fri May 17 08:30:47 2013
+++ test/publish_subscribe_test.rb	Fri May 17 08:31:18 2013
@@@@ -132,7 +132,7 @@@@ class TestPublishSubscribe < Test::Unit::TestCase
d8 2
a9 2
-    publish = %{echo "publish foo bar\r\n" | nc localhost #{OPTIONS[:port]}}
+    publish = %{echo "publish foo bar\r\n" | nc -N localhost #{OPTIONS[:port]}}
@

