head	1.3;
access;
symbols
	OPENBSD_6_1:1.2.0.10
	OPENBSD_6_1_BASE:1.2
	OPENBSD_6_0:1.2.0.8
	OPENBSD_6_0_BASE:1.2
	OPENBSD_5_9:1.2.0.4
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.2.0.6
	OPENBSD_5_8_BASE:1.2
	OPENBSD_5_7:1.2.0.2
	OPENBSD_5_7_BASE:1.2;
locks; strict;
comment	@# @;


1.3
date	2017.08.28.05.21.22;	author dcoppa;	state dead;
branches;
next	1.2;
commitid	caXKFJ4jJhS8W8PX;

1.2
date	2015.02.13.15.44.13;	author dcoppa;	state Exp;
branches;
next	1.1;
commitid	TskwrET1rpZzkVDW;

1.1
date	2015.02.13.15.24.59;	author dcoppa;	state Exp;
branches;
next	;
commitid	tMZ7Xu6c8ZJYcg4A;


desc
@@


1.3
log
@
Update to ruby-redis-4.0.0
@
text
@$OpenBSD: patch-Rakefile,v 1.2 2015/02/13 15:44:13 dcoppa Exp $
--- Rakefile.orig	Wed Feb 11 13:21:18 2015
+++ Rakefile	Fri Feb 13 09:39:06 2015
@@@@ -1,14 +1,12 @@@@
 require "rake/testtask"
 
-ENV["REDIS_BRANCH"] ||= "unstable"
-
 REDIS_DIR = File.expand_path(File.join("..", "test"), __FILE__)
 REDIS_CNF = File.join(REDIS_DIR, "test.conf")
 REDIS_CNF_TEMPLATE = File.join(REDIS_DIR, "test.conf.erb")
 REDIS_PID = File.join(REDIS_DIR, "db", "redis.pid")
 REDIS_LOG = File.join(REDIS_DIR, "db", "redis.log")
 REDIS_SOCKET = File.join(REDIS_DIR, "db", "redis.sock")
-BINARY = "tmp/redis-#{ENV["REDIS_BRANCH"]}/src/redis-server"
+BINARY = ENV.fetch("REDIS_BINARY")
 
 task :default => :run
 
@@@@ -48,22 +46,7 @@@@ end
 
 desc "Clean up testing artifacts"
 task :clean do
-  FileUtils.rm_f(BINARY)
   FileUtils.rm_f(REDIS_CNF)
-end
-
-file BINARY do
-  branch = ENV.fetch("REDIS_BRANCH")
-
-  sh <<-SH
-  mkdir -p tmp;
-  cd tmp;
-  rm -rf redis-#{branch};
-  wget https://github.com/antirez/redis/archive/#{branch}.tar.gz -O #{branch}.tar.gz;
-  tar xf #{branch}.tar.gz;
-  cd redis-#{branch};
-  make
-  SH
 end
 
 file REDIS_CNF => [REDIS_CNF_TEMPLATE, __FILE__] do |t|
@


1.2
log
@
Use an env var to avoid a ${SUBST_CMD}
@
text
@d1 1
a1 1
$OpenBSD: patch-Rakefile,v 1.1 2015/02/13 15:24:59 dcoppa Exp $
@


1.1
log
@
Update to ruby-redis-3.2.1
@
text
@d1 1
a1 1
$OpenBSD$
d3 1
a3 1
+++ Rakefile	Fri Feb 13 08:56:08 2015
d16 1
a16 1
+BINARY = "${LOCALBASE}/sbin/redis-server"
@

