head	1.50;
access;
symbols
	OPENBSD_6_1:1.49.0.2
	OPENBSD_6_1_BASE:1.49
	OPENBSD_6_0:1.42.0.2
	OPENBSD_6_0_BASE:1.42
	OPENBSD_5_9:1.38.0.2
	OPENBSD_5_9_BASE:1.38
	OPENBSD_5_8:1.29.0.4
	OPENBSD_5_8_BASE:1.29
	OPENBSD_5_7:1.23.0.2
	OPENBSD_5_7_BASE:1.23
	OPENBSD_5_6:1.15.0.2
	OPENBSD_5_6_BASE:1.15
	OPENBSD_5_5:1.9.0.2
	OPENBSD_5_5_BASE:1.9
	OPENBSD_5_4:1.4.0.2
	OPENBSD_5_4_BASE:1.4
	brad_20130404:1.1.1.1
	brad:1.1.1;
locks; strict;
comment	@# @;


1.50
date	2017.04.10.11.45.24;	author sthen;	state Exp;
branches;
next	1.49;
commitid	XDh1zlSBq0boKsHk;

1.49
date	2017.03.13.10.57.00;	author sthen;	state Exp;
branches;
next	1.48;
commitid	xY8ZBGop4KxLOveT;

1.48
date	2017.02.26.13.31.57;	author ajacoutot;	state Exp;
branches;
next	1.47;
commitid	8OoM6xLWCdtCtgBU;

1.47
date	2017.01.20.10.03.10;	author sthen;	state Exp;
branches;
next	1.46;
commitid	lbdM73zRQyvFYkXu;

1.46
date	2016.11.01.10.52.20;	author sthen;	state Exp;
branches;
next	1.45;
commitid	2Sy0K9AN4vQC4ren;

1.45
date	2016.09.01.10.53.26;	author jasper;	state Exp;
branches;
next	1.44;
commitid	LdsIxWmxagN2Kq33;

1.44
date	2016.08.31.22.59.53;	author sthen;	state Exp;
branches;
next	1.43;
commitid	zyPmFTp3jgbJev0A;

1.43
date	2016.07.31.21.30.06;	author sthen;	state Exp;
branches;
next	1.42;
commitid	a31PwcLp8yLjFBWT;

1.42
date	2016.05.12.14.00.12;	author espie;	state Exp;
branches
	1.42.2.1;
next	1.41;
commitid	ahNJS3ufsPPzbnzQ;

1.41
date	2016.05.04.07.37.22;	author sthen;	state Exp;
branches;
next	1.40;
commitid	fOUXuHQPovfFOpK9;

1.40
date	2016.03.18.23.12.16;	author naddy;	state Exp;
branches;
next	1.39;
commitid	KZAl4KEiw6a3Jixw;

1.39
date	2016.03.15.12.42.08;	author sthen;	state Exp;
branches;
next	1.38;
commitid	Tb1M8WGFmSXCRNWw;

1.38
date	2016.02.12.13.30.38;	author sthen;	state Exp;
branches
	1.38.2.1;
next	1.37;
commitid	2d469VyNVJ2q1IMy;

1.37
date	2015.12.28.08.49.25;	author ajacoutot;	state Exp;
branches;
next	1.36;
commitid	cBLhv5Q6Wzfo7I01;

1.36
date	2015.12.21.01.09.51;	author sthen;	state Exp;
branches;
next	1.35;
commitid	GjpRSFYxAqNFZRWG;

1.35
date	2015.12.08.16.15.23;	author sthen;	state Exp;
branches;
next	1.34;
commitid	VmnJPsxZfrUOlN1p;

1.34
date	2015.10.31.19.40.43;	author sthen;	state Exp;
branches;
next	1.33;
commitid	XTFWdHZ018lNCSDx;

1.33
date	2015.10.29.09.55.18;	author sthen;	state Exp;
branches;
next	1.32;
commitid	RTsXGBMB2yYq9sEg;

1.32
date	2015.10.08.21.19.21;	author sthen;	state Exp;
branches;
next	1.31;
commitid	pVDZUjJm7yyuQSI1;

1.31
date	2015.08.25.07.30.29;	author ajacoutot;	state Exp;
branches;
next	1.30;
commitid	x3rR2VHR7RvISfgT;

1.30
date	2015.08.24.10.21.10;	author giovanni;	state Exp;
branches;
next	1.29;
commitid	PszjFN6tFZgCxAoS;

1.29
date	2015.07.17.17.31.27;	author sthen;	state Exp;
branches
	1.29.4.1;
next	1.28;
commitid	0d5OaUh4LxbuNosW;

1.28
date	2015.07.15.15.52.29;	author ajacoutot;	state Exp;
branches;
next	1.27;
commitid	1heQdbgx3JmVR9Ch;

1.27
date	2015.06.19.10.55.46;	author sthen;	state Exp;
branches;
next	1.26;
commitid	UFUl9dAtQPPBYLtZ;

1.26
date	2015.05.12.18.03.41;	author giovanni;	state Exp;
branches;
next	1.25;
commitid	xtooICNC4OkR9Ixh;

1.25
date	2015.04.17.07.59.19;	author phessler;	state Exp;
branches;
next	1.24;
commitid	lZW2A6ug5Iurk452;

1.24
date	2015.04.09.06.58.12;	author giovanni;	state Exp;
branches;
next	1.23;
commitid	jN3hFtFbutATqb2V;

1.23
date	2015.01.30.18.43.12;	author brad;	state Exp;
branches
	1.23.2.1;
next	1.22;
commitid	4N7CzGnAgY88PJaG;

1.22
date	2014.10.03.08.32.53;	author brad;	state Exp;
branches;
next	1.21;
commitid	WDBfK65MArwb08D5;

1.21
date	2014.09.23.21.48.28;	author landry;	state Exp;
branches;
next	1.20;
commitid	SQZl9qJq44tkxbtj;

1.20
date	2014.09.21.19.17.22;	author landry;	state Exp;
branches;
next	1.19;
commitid	7GDM7WfyRGf6f8zH;

1.19
date	2014.09.18.21.01.50;	author landry;	state Exp;
branches;
next	1.18;
commitid	z7t470ePGWfQnmVc;

1.18
date	2014.09.17.15.56.50;	author landry;	state Exp;
branches;
next	1.17;
commitid	PFoC5AHKqshRkknV;

1.17
date	2014.08.23.02.25.34;	author brad;	state Exp;
branches;
next	1.16;
commitid	2gO9tEHpqcVa52wr;

1.16
date	2014.08.19.16.42.40;	author brad;	state Exp;
branches;
next	1.15;
commitid	zAgOCWfMzKXUVZ5C;

1.15
date	2014.06.19.23.04.42;	author brad;	state Exp;
branches;
next	1.14;
commitid	C0rBAxANedzRXFw9;

1.14
date	2014.05.09.08.47.48;	author brad;	state Exp;
branches;
next	1.13;

1.13
date	2014.04.01.18.26.56;	author brad;	state Exp;
branches;
next	1.12;

1.12
date	2014.03.23.16.49.30;	author brad;	state Exp;
branches;
next	1.11;

1.11
date	2014.03.11.09.27.45;	author brad;	state Exp;
branches;
next	1.10;

1.10
date	2014.03.10.01.13.34;	author brad;	state Exp;
branches;
next	1.9;

1.9
date	2014.01.11.19.28.40;	author brad;	state Exp;
branches;
next	1.8;

1.8
date	2013.11.30.20.37.20;	author brad;	state Exp;
branches;
next	1.7;

1.7
date	2013.11.25.14.16.22;	author sthen;	state Exp;
branches;
next	1.6;

1.6
date	2013.09.22.14.28.13;	author dcoppa;	state Exp;
branches;
next	1.5;

1.5
date	2013.09.04.19.20.28;	author brad;	state Exp;
branches;
next	1.4;

1.4
date	2013.06.12.20.36.33;	author brad;	state Exp;
branches;
next	1.3;

1.3
date	2013.05.30.12.39.18;	author brad;	state Exp;
branches;
next	1.2;

1.2
date	2013.04.11.21.02.19;	author brad;	state Exp;
branches;
next	1.1;

1.1
date	2013.04.04.18.58.44;	author brad;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2013.04.04.18.58.44;	author brad;	state Exp;
branches;
next	;

1.23.2.1
date	2015.08.11.21.22.55;	author sthen;	state Exp;
branches;
next	;
commitid	g1cZyAqhMNHSKGtR;

1.29.4.1
date	2015.12.09.13.01.00;	author jasper;	state Exp;
branches;
next	;
commitid	lEtjzO7YUttFjLZu;

1.38.2.1
date	2016.05.19.12.04.33;	author jasper;	state Exp;
branches;
next	;
commitid	wp7ygM8m7G5m3Vxd;

1.42.2.1
date	2016.09.05.08.40.06;	author jasper;	state Exp;
branches;
next	1.42.2.2;
commitid	bq6hH3kUIMPcxDwx;

1.42.2.2
date	2016.11.03.21.50.51;	author sthen;	state Exp;
branches;
next	1.42.2.3;
commitid	ZsIeYIqG1cYL21kZ;

1.42.2.3
date	2017.01.20.10.05.13;	author sthen;	state Exp;
branches;
next	1.42.2.4;
commitid	bgfVMLbVOVKXtCvD;

1.42.2.4
date	2017.03.14.09.15.34;	author robert;	state Exp;
branches;
next	;
commitid	OgeWvLXstv212tLx;


desc
@@


1.50
log
@use LIBCXX
@
text
@# $OpenBSD: Makefile,v 1.49 2017/03/13 10:57:00 sthen Exp $

# archs with atomic ops
ONLY_FOR_ARCHS-server=	alpha aarch64 amd64 i386 mips64 mips64el powerpc sparc64
ONLY_FOR_ARCHS-tests=	${ONLY_FOR_ARCHS-server}

COMMENT-main=	multithreaded SQL database (client)
COMMENT-server=	multithreaded SQL database (server)
COMMENT-tests=	multithreaded SQL database (regression test suite/benchmark)

VERSION=	10.0.30
DISTNAME=	mariadb-${VERSION}
PKGNAME-main=	mariadb-client-${VERSION}
PKGNAME-server=	mariadb-server-${VERSION}
PKGNAME-tests= 	mariadb-tests-${VERSION}
EPOCH=		1

CATEGORIES=	databases
MASTER_SITES=	http://mariadb.mirror.iweb.com//${DISTNAME}/source/ \
		http://ftp.osuosl.org/pub/mariadb/${DISTNAME}/source/ \

LIB_VERSION=	27
SHARED_LIBS=	mysqlclient_r	${LIB_VERSION}.0 \
		mysqlclient	${LIB_VERSION}.0

HOMEPAGE=	http://mariadb.org/

MAINTAINER=	Brad Smith <brad@@comstyle.com>

# GPLv2 and LGPLv2.1
PERMIT_PACKAGE_CDROM=	Yes

WANTLIB=	c crypto m pthread ssl ${LIBCXX} z
WANTLIB-main=	curses readline ${WANTLIB}
WANTLIB-server=	mysqlclient ${WANTLIB}
WANTLIB-tests=	mysqlclient ${WANTLIB}

LOCALSTATEDIR=	${BASELOCALSTATEDIR}/mysql
SOCKET_DIR=	/var/run/mysql
SUBST_VARS=	SOCKET_DIR

MODULES=	devel/cmake
BUILD_DEPENDS=	devel/bison

RUN_DEPENDS-server=	${BASE_PKGPATH}>=10.0v1,<10.1v1 \
			databases/p5-DBD-mysql
LIB_DEPENDS-server=	${BASE_PKGPATH}>=10.0v1,<10.1v1
LIB_DEPENDS-tests=	${BASE_PKGPATH}>=10.0v1,<10.1v1

USE_GROFF=	Yes
CONFIGURE_ARGS+=-DCMAKE_INSTALL_PREFIX="${PREFIX}" \
		-DINSTALL_DOCDIR="share/doc/mysql" \
		-DINSTALL_DOCREADMEDIR="share/doc/mysql" \
		-DINSTALL_INCLUDEDIR="include/mysql" \
		-DINSTALL_INFODIR="info" \
		-DINSTALL_LIBDIR="lib/mysql" \
		-DINSTALL_MANDIR="man" \
		-DINSTALL_MYSQLDATADIR="${LOCALSTATEDIR}" \
		-DINSTALL_MYSQLSHAREDIR="share/mysql" \
		-DINSTALL_MYSQLTESTDIR="share/mysql-test" \
		-DINSTALL_PLUGINDIR="lib/mysql/plugin" \
		-DINSTALL_SBINDIR="libexec" \
		-DINSTALL_SCRIPTDIR="bin" \
		-DINSTALL_SHAREDIR="share" \
		-DINSTALL_SQLBENCHDIR="share/mysql-bench" \
		-DINSTALL_SUPPORTFILESDIR="share/examples/mysql" \
		-DMYSQL_UNIX_ADDR="${SOCKET_DIR}/mysql.sock" \
		-DCOMPILATION_COMMENT='OpenBSD port: ${FULLPKGNAME-server}' \
		-DWITH_SSL=system \
		-DCONNECT_WITH_LIBXML2=Off

# The Mroonga storage engine does not build at the moment on OpenBSD.
# It is still not enabled due to a linking issue with liblz4.
CONFIGURE_ARGS+=-DWITHOUT_MROONGA_STORAGE_ENGINE=1

MULTI_PACKAGES=	-main -server -tests

.include <bsd.port.arch.mk>

.if !${BUILD_PACKAGES:M-server}
CONFIGURE_ARGS+=-DWITHOUT_SERVER=On
.endif

.if !${BUILD_PACKAGES:M-tests}
CONFIGURE_ARGS+=-DWITH_UNIT_TESTS=Off
.endif

pre-configure:
	@@${SUBST_CMD} ${WRKSRC}/cmake/mysql_version.cmake

post-install:
	@@cd ${PREFIX}/lib && \
		ln -sf mysql/libmysqlclient.so.${LIBmysqlclient_VERSION} . && \
		ln -sf mysql/libmysqlclient_r.so.${LIBmysqlclient_r_VERSION} .

.if ${BUILD_PACKAGES:M-tests}
do-regress:
	@@cd ${WRKBUILD}/mysql-test && ./mysql-test-run.pl --force --verbose --max-test-fail=0
.else
NO_TEST=	Yes
.endif

.include <bsd.port.mk>
@


1.49
log
@update to MariaDB 10.0.30, from Brad. Fixes CVE-2017-3302 and CVE-2017-3313.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2017/02/26 13:31:57 ajacoutot Exp $
d33 1
a33 1
WANTLIB=	c crypto m pthread ssl stdc++ z
@


1.48
log
@Add aarch64 to ONLY_FOR_ARCHS.

from Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2017/01/20 10:03:10 sthen Exp $
d11 1
a11 1
VERSION=	10.0.29
@


1.47
log
@update to MariaDB 10.0.29, from Brad (maintainer)

CVE-2016-6664, CVE-2017-3238, CVE-2017-3243, CVE-2017-3244, CVE-2017-3257,
CVE-2017-3258, CVE-2017-3265, CVE-2017-3291, CVE-2017-3312, CVE-2017-3317,
CVE-2017-3318
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2016/11/01 10:52:20 sthen Exp $
d4 1
a4 1
ONLY_FOR_ARCHS-server=	alpha amd64 i386 mips64 mips64el powerpc sparc64
@


1.46
log
@update to MariaDB 10.0.28, from Brad (who also tested it on ppc): fixes
CVE-2016-5616, CVE-2016-5624, CVE-2016-5626, CVE-2016-3492, CVE-2016-5629,
CVE-2016-8283, CVE-2016-7440, CVE-2016-5584 and CVE-2016-6663.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2016/09/01 10:53:26 jasper Exp $
d11 1
a11 1
VERSION=	10.0.28
@


1.45
log
@retire sparc
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2016/08/31 22:59:53 sthen Exp $
d11 1
a11 1
VERSION=	10.0.27
@


1.44
log
@update to mariadb-10.0.27, from Brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2016/07/31 21:30:06 sthen Exp $
a5 1
BROKEN-sparc=	Requires v9|v9a|v9b; requested architecture is sparclite
@


1.43
log
@update to mariadb-10.0.26, from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2016/05/12 14:00:12 espie Exp $
d12 1
a12 1
VERSION=	10.0.26
@


1.42
log
@Term-ReadKey is part of the base system now
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2016/05/04 07:37:22 sthen Exp $
d12 1
a12 1
VERSION=	10.0.25
a17 1
REVISION-server=0
@


1.42.2.1
log
@- security update to mariadb-10.0.27, addressing CVE-2016-3477, CVE-2016-3521,
CVE-2016-3615 and CVE-2016-5440

from brad (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2016/05/12 14:00:12 espie Exp $
d12 1
a12 1
VERSION=	10.0.27
d18 1
@


1.42.2.2
log
@MFC update to MariaDB 10.0.28

CVE-2016-5616, CVE-2016-5624, CVE-2016-5626, CVE-2016-3492, CVE-2016-5629,
CVE-2016-8283, CVE-2016-7440, CVE-2016-5584 and CVE-2016-6663.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2016/11/01 10:52:20 sthen Exp $
d6 1
d12 1
a12 1
VERSION=	10.0.28
@


1.42.2.3
log
@MFC update to MariaDB 10.0.29

CVE-2016-6664, CVE-2017-3238, CVE-2017-3243, CVE-2017-3244, CVE-2017-3257,
CVE-2017-3258, CVE-2017-3265, CVE-2017-3291, CVE-2017-3312, CVE-2017-3317,
CVE-2017-3318
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42.2.2 2016/11/03 21:50:51 sthen Exp $
d11 1
a11 1
VERSION=	10.0.29
@


1.42.2.4
log
@MFC:
update to MariaDB 10.0.30, from Brad. Fixes CVE-2017-3302 and CVE-2017-3313.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2017/03/13 10:57:00 sthen Exp $
d11 1
a11 1
VERSION=	10.0.30
@


1.41
log
@update to MariaDB 10.0.25, from Brad.

CVE-2016-0643, CVE-2016-0647, CVE-2016-0648, CVE-2016-0655, CVE-2016-0666
https://mariadb.com/kb/en/mariadb/mariadb-10025-changelog/
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2016/03/18 23:12:16 naddy Exp $
d18 2
d48 1
a48 2
			databases/p5-DBD-mysql \
			devel/p5-Term-ReadKey
@


1.40
log
@remove SHARED_ONLY from ports that only use modules that neither set nor
read this variable
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2016/03/15 12:42:08 sthen Exp $
d12 1
a12 1
VERSION=	10.0.24
@


1.39
log
@Update to mariadb-10.0.24, from Brad.  I've tested on macppc/amd64,
and thanks to Markus Lude for testing on sparc64.
@
text
@d1 1
a1 3
# $OpenBSD: Makefile,v 1.38 2016/02/12 13:30:38 sthen Exp $

SHARED_ONLY=	Yes
@


1.38
log
@Set default MariaDB config files to use bind-address=127.0.0.1, partly because
localhost is a safer default, and partly because otherwise it binds to an IPv6
socket (::) and OpenBSD deliberately doesn't allow v4 connections to those,
so people who do want (v4) network connections have trouble too. Add a comment
explaining use of 0.0.0.0 to listen to any IPv4 interface.

ok juanfra@@ pea@@ giovanni@@, ok jcs@@ on an earlier version (only change in the
new one was adding a comment), dhill likes it too
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2015/12/28 08:49:25 ajacoutot Exp $
d14 1
a14 1
VERSION=	10.0.23
a18 1
REVISION-server= 0
d101 1
a101 1
	@@cd ${WRKBUILD}/mysql-test && ./mysql-test-run.pl --force --max-test-fail=0
@


1.38.2.1
log
@update to MariaDB 10.0.25, from Brad.

CVE-2016-0643, CVE-2016-0647, CVE-2016-0648, CVE-2016-0655, CVE-2016-0666
https://mariadb.com/kb/en/mariadb/mariadb-10025-changelog/
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2016/02/12 13:30:38 sthen Exp $
d14 1
a14 1
VERSION=	10.0.25
d19 1
d102 1
a102 1
	@@cd ${WRKBUILD}/mysql-test && ./mysql-test-run.pl --force --verbose --max-test-fail=0
@


1.37
log
@Enable building the MariaDB server on mips64 and more correct fix for dealing
with the use of atomic ops.

from Brad (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2015/12/21 01:09:51 sthen Exp $
d19 1
@


1.36
log
@update to MariaDB 10.0.23, from Brad.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2015/12/08 16:15:23 sthen Exp $
d6 1
a6 1
ONLY_FOR_ARCHS-server=	alpha amd64 i386 powerpc sparc64
@


1.35
log
@update to MariaDB-10.0.22, from Brad (sorry for the belated commit).
https://mariadb.com/kb/en/mariadb/mariadb-10022-release-notes/

CVE-2015-4802	CVE-2015-4807	CVE-2015-4815
CVE-2015-4826	CVE-2015-4830	CVE-2015-4836
CVE-2015-4858	CVE-2015-4861	CVE-2015-4870
CVE-2015-4913	CVE-2015-4792
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2015/10/31 19:40:43 sthen Exp $
d14 1
a14 1
VERSION=	10.0.22
@


1.34
log
@Backout the MariaDB update, it has issues on too many arch at present,
Brad (maintainer) agrees.  Bump EPOCH/lib versions to raise them above the
updated versions.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2015/10/08 21:19:21 sthen Exp $
d14 1
a14 1
VERSION=	10.0.21
d75 2
a76 2
# The Mroonga storage engine does not build at the moment on
# OpenBSD. https://mariadb.atlassian.net/browse/MDEV-7209
@


1.33
log
@update to MariaDB-10.1.8, from giovanni@@ and Brad, ok giovanni
@
text
@d14 1
a14 1
VERSION=	10.1.8
d19 1
a19 1
EPOCH=		0
d24 1
a24 1
LIB_VERSION=	26
d47 1
a47 1
RUN_DEPENDS-server=	${BASE_PKGPATH}>=10.1v0,<10.2v0 \
d50 2
a51 2
LIB_DEPENDS-server=	${BASE_PKGPATH}>=10.1v0,<10.2v0
LIB_DEPENDS-tests=	${BASE_PKGPATH}>=10.1v0,<10.2v0
@


1.32
log
@Bump some ports which reference if_msghdr in their source, so that package
updates are triggered. This is following the struct if_data ABI change a few
days ago; if_msghdr has an embedded if_data.  Some may be unnecessary, but
some are definitely needed and bumps are cheaper than debugging.
Problem reported with wpa_supplicant by Mikolaj Kucharski.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2015/08/25 07:30:29 ajacoutot Exp $
d14 1
a14 1
VERSION=	10.0.21
a19 2
REVISION-server=1
REVISION-main=	0
d24 1
a24 1
LIB_VERSION=	25
d47 1
a47 1
RUN_DEPENDS-server=	${BASE_PKGPATH}>=10.0v0,<10.1v0 \
d50 2
a51 2
LIB_DEPENDS-server=	${BASE_PKGPATH}>=10.0v0,<10.1v0
LIB_DEPENDS-tests=	${BASE_PKGPATH}>=10.0v0,<10.1v0
@


1.31
log
@/var/run content is already removed by /etc/rc, so no need to handle that in
the package. If a /var/run/foo directory must exist for proper start of a
software, then the rc.d script should take care of it.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2015/08/24 10:21:10 giovanni Exp $
d20 2
a21 1
REVISION-server=0
@


1.30
log
@Bugfix update to 10.0.21
From Brad (Maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2015/07/17 17:31:27 sthen Exp $
d20 1
@


1.29
log
@Correct the examples path in the pkg-readme. Issue pointed out by
Thanos Tsouanas <thanos at tsouanas dot org>, diff from brad, ok giovanni
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2015/07/15 15:52:29 ajacoutot Exp $
d14 1
a14 1
VERSION=	10.0.20
a18 2
REVISION-main=	0
REVISION-server=0
@


1.29.4.1
log
@security update to 10.0.22

https://mariadb.com/kb/en/mariadb/mariadb-10022-release-notes/

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2015/07/17 17:31:27 sthen Exp $
d14 1
a14 1
VERSION=	10.0.22
d19 2
d27 2
a28 2
SHARED_LIBS=	mysqlclient_r	${LIB_VERSION}.1 \
		mysqlclient	${LIB_VERSION}.1
d77 2
a78 2
# The Mroonga storage engine does not build at the moment on OpenBSD.
# It is still not enabled due to a linking issue with liblz4.
@


1.28
log
@Fix rc.d script after recent rc.subr change.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2015/06/19 10:55:46 sthen Exp $
d20 1
@


1.27
log
@update to MariaDB 10.0.20, from brad, ok giovanni
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2015/05/12 18:03:41 giovanni Exp $
d19 1
@


1.26
log
@Update to 10.0.19
from Brad (Maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2015/04/17 07:59:19 phessler Exp $
d14 1
a14 1
VERSION=	10.0.19
@


1.25
log
@these expect that "sparc" is sparc64, not 32bit.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2015/04/09 06:58:12 giovanni Exp $
d14 1
a14 1
VERSION=	10.0.17
@


1.24
log
@Update to 10.0.17
diff from brad@@
ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2015/01/30 18:43:12 brad Exp $
d8 1
@


1.23
log
@Update to MariaDB 10.0.16.

Mainly to deal with the 15 CVE assigned issues fixed by .15 and .16.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2014/10/03 08:32:53 brad Exp $
d13 1
a13 1
VERSION=	10.0.16
@


1.23.2.1
log
@MFC MariaDB 10.0.20 update to OPENBSD_5_7, from Brad, ok giovanni@@

CVE-2015-2568, CVE-2015-2573, CVE-2015-0433, CVE-2015-0441, CVE-2014-8964,
CVE-2015-2325, CVE-2015-2326, CVE-2015-0501, CVE-2015-2571, CVE-2015-0505,
CVE-2015-0499, CVE-2015-3152
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2015/01/30 18:43:12 brad Exp $
d13 1
a13 1
VERSION=	10.0.20
@


1.22
log
@Update to MariaDB 10.0.14.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2014/09/23 21:48:28 landry Exp $
d13 1
a13 1
VERSION=	10.0.14
d73 4
@


1.21
log
@Use ONLY_FOR_ARCHS-server/-test instead of messing up with MULTI_PACKAGES,
should unconfuse dpb on exotic archs. Note that powerpc is still BROKEN,
for total lack of testing from MAINTAINER.
With help from espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2014/09/21 19:17:22 landry Exp $
d5 4
a8 1
BROKEN-powerpc=	rpl_parallel.cc:800: error: 'rli' was not declared in this scope
a11 4
# archs with atomic ops
ONLY_FOR_ARCHS-server=	alpha amd64 i386 powerpc sparc64
ONLY_FOR_ARCHS-tests=	${ONLY_FOR_ARCHS-server}
MULTI_PACKAGES=	-main -server -tests
d13 1
a13 2
EPOCH=		0
VERSION=	10.0.13
d18 1
a18 1
REVISION-main=	0
a52 1

d70 1
a70 1
		-DWITH_COMMENT='OpenBSD port: ${FULLPKGNAME-server}' \
a71 1
		-DWITH_LIBEDIT=Off \
d73 2
@


1.20
log
@BROKEN-powerpc: rpl_parallel.cc:800: error: 'rli' was not declared in this scope
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2014/09/18 21:01:50 landry Exp $
d9 4
a76 9

MULTI_PACKAGES=	-main

# archs with atomic ops
.if ${MACHINE_ARCH} == "alpha" || ${MACHINE_ARCH} == "amd64" || \
    ${MACHINE_ARCH} == "i386" || ${MACHINE_ARCH} == "powerpc" || \
    ${MACHINE_ARCH} == "sparc64"
MULTI_PACKAGES+= -server -tests
.endif
@


1.19
log
@Propagate EPOCH=0 to self-depends, fixes packaging.
Reported by nigel@@ & kili@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2014/09/17 15:56:50 landry Exp $
d5 1
@


1.18
log
@EPOCH=0 for seamless updates from mysql.
ok/on behalf of sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2014/08/23 02:25:34 brad Exp $
d43 1
a43 1
RUN_DEPENDS-server=	${BASE_PKGPATH}>=10.0,<10.1 \
d46 2
a47 2
LIB_DEPENDS-server=	${BASE_PKGPATH}>=10.0,<10.1
LIB_DEPENDS-tests=	${BASE_PKGPATH}>=10.0,<10.1
@


1.17
log
@Add a conflict marker for MySQL server to the MariaDB client sub-package as
some files moved around between the two ports/packages and their respective
sub-packages.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2014/08/19 16:42:40 brad Exp $
d9 1
@


1.16
log
@Update to MariaDB 10.0.13.

ok giovanni@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2014/06/19 23:04:42 brad Exp $
d14 1
@


1.15
log
@Update to MariaDB 10.0.12.

ok giovanni@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2014/05/09 08:47:48 brad Exp $
d9 1
a9 1
VERSION=	10.0.12
@


1.14
log
@Only build the server (and tests) on archs that have atomic ops.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2014/04/01 18:26:56 brad Exp $
d9 1
a9 1
VERSION=	10.0.10
d15 2
a16 5
MASTER_SITES=	http://ftp.osuosl.org/pub/mariadb/${DISTNAME}/kvm-tarbake-jaunty-x86/ \
		http://ftp.heanet.ie/mirrors/mariadb/${DISTNAME}/kvm-tarbake-jaunty-x86/

REVISION-main=	0
REVISION-server= 1
d74 2
a75 2
.if ${MACHINE_ARCH} == "alpha" || ${MACHINE_ARCH} == "amd64" ||
    ${MACHINE_ARCH} == "i386" || ${MACHINE_ARCH} == "powerpc" ||
@


1.13
log
@Update to MariaDB 10.0.10.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2014/03/23 16:49:30 brad Exp $
d18 2
a19 1
REVISION-server= 0
d74 18
a91 1
MULTI_PACKAGES=	-main -server -tests
d101 1
d104 3
@


1.12
log
@Disable the TCP wrappers support.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2014/03/11 09:27:45 brad Exp $
d9 1
a9 1
VERSION=	10.0.9
@


1.11
log
@Update to MariaDB 10.0.9.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2014/03/10 01:13:34 brad Exp $
d18 2
d33 1
a33 1
WANTLIB-server=	mysqlclient wrap ${WANTLIB}
a70 1
		-DWITH_LIBWRAP=On \
@


1.10
log
@Update to MariaDB 10.0.8.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2014/01/11 19:28:40 brad Exp $
d9 1
a9 1
VERSION=	10.0.8
@


1.9
log
@Update to MariaDB 10.0.7. This is the last beta release and it is
feature complete; the next release will be RC and then a GA.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2013/11/30 20:37:20 brad Exp $
d9 1
a9 1
VERSION=	10.0.7
@


1.8
log
@Update to MariaDB 5.5.34.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2013/11/25 14:16:22 sthen Exp $
d9 1
a9 1
VERSION=	5.5.34
d18 1
a18 1
LIB_VERSION=	24
d41 1
a41 1
RUN_DEPENDS-server=	${BASE_PKGPATH}>=5.5,<5.6 \
d44 2
a45 2
LIB_DEPENDS-server=	${BASE_PKGPATH}>=5.5,<5.6
LIB_DEPENDS-tests=	${BASE_PKGPATH}>=5.5,<5.6
d69 2
a70 1
		-DWITH_LIBWRAP=On
@


1.7
log
@kill VMEM_WARNING
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2013/09/22 14:28:13 dcoppa Exp $
d9 1
a9 1
VERSION=	5.5.32
@


1.6
log
@Fix and enable Ninja build.

ok brad@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2013/09/04 19:20:28 brad Exp $
a45 2

VMEM_WARNING=	Yes
@


1.5
log
@Upgrade to MariaDB 5.5.32.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2013/06/12 20:36:33 brad Exp $
a49 1
USE_NINJA=	No
@


1.4
log
@Revert back to using MySQL 5.1 for the time being. MariaDB 5.5 introduces
a new libmysqlclient non-blocking API which utilizes co-routines. The X86
specific GCC ASM co-routine support hid the fact that there was an issue.
The only fallback code so far is POSIX user contexts which OpenBSD does not
support.

Input from and Ok sthen@@ jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2013/05/30 12:39:18 brad Exp $
d9 1
a9 1
VERSION=	5.5.31
a17 4
REVISION-main=	0
REVISION-server= 0
REVISION-tests=	0

d50 1
@


1.3
log
@Update to MariaDB 5.5.31. Also add pkgpath and conflict markers for mytop.

ok sthen@@ giovanni@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2013/04/11 21:02:19 brad Exp $
d18 5
a22 1
LIB_VERSION=	22
@


1.2
log
@Move mytop back to the server sub-package where I had it originally.
It requires DBD::mysql which the server sub-package already has and
I don't want to add more dependencies to the client sub-package.
Plus add the missing dependency on Term::ReadKey for mytop.

From giovanni@@ OK sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2013/04/04 18:58:44 brad Exp $
d9 1
a9 1
VERSION=	5.5.30
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d42 2
a43 1
			databases/p5-DBD-mysql
@


1.1.1.1
log
@Import of MariaDB.

MariaDB is a multi-threaded SQL database with a command syntax very similar
to mSQL.

ok sthen@@ giovanni@@
@
text
@@
