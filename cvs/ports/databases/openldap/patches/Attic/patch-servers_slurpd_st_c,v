head	1.1;
access;
symbols
	OPENBSD_3_9:1.1.0.4
	OPENBSD_3_8:1.1.0.2;
locks; strict;
comment	@# @;


1.1
date	2006.06.23.22.23.23;	author sturm;	state dead;
branches
	1.1.2.1
	1.1.4.1;
next	;

1.1.2.1
date	2006.06.23.22.23.23;	author sturm;	state Exp;
branches;
next	;

1.1.4.1
date	2006.06.23.22.23.49;	author sturm;	state Exp;
branches;
next	;


desc
@@


1.1
log
@file patch-servers_slurpd_st_c was initially added on branch OPENBSD_3_8.
@
text
@@


1.1.4.1
log
@backport a diff that fixes a status file handling buffer overflow in slurpd.
(CVE-2006-2754)

More information:
http://secunia.com/advisories/20126/
@
text
@a0 17
$OpenBSD$
--- servers/slurpd/st.c.orig	Thu Jun 22 22:02:26 2006
+++ servers/slurpd/st.c	Thu Jun 22 22:03:52 2006
@@@@ -240,10 +240,10 @@@@ St_read(
 	}
 	if ( found ) {
 	    char tbuf[ 255 ];
-	    sprintf( tbuf, "%s:%s (timestamp %s.%s)", hostname, port,
-		    timestamp, seq );
+	    sprintf( tbuf, "%s.%s", timestamp, seq );
 	    Debug( LDAP_DEBUG_ARGS,
-		    "Retrieved state information for %s\n", tbuf, 0, 0 );
+		    "Retrieved state information for %s:%s (timestamp %s)\n",
+		    hostname, port, tbuf );
 	} else {
 	    Debug(  LDAP_DEBUG_ANY,
 		    "Warning: saved state for %s:%s, not a known replica\n",
@


1.1.2.1
log
@backport a diff that fixes a status file handling buffer overflow in slurpd.
(CVE-2006-2754)

More information:
http://secunia.com/advisories/20126/
@
text
@a0 24
$OpenBSD$
--- servers/slurpd/st.c.orig	Thu Jan 20 18:01:19 2005
+++ servers/slurpd/st.c	Thu Jun 22 22:14:12 2006
@@@@ -257,14 +257,15 @@@@ St_read(
 	}
 	if ( found ) {
 	    char tbuf[ 255 ];
-	    sprintf( tbuf, "%s:%s (timestamp %s.%s)", hostname, port,
-		    timestamp, seq );
+	    sprintf( tbuf, "%s.%s", timestamp, seq );
 #ifdef NEW_LOGGING
-		LDAP_LOG ( SLURPD, DETAIL1, "St_write: "
-			"Retrieved state information for %s\n", tbuf, 0, 0 );
+	    LDAP_LOG ( SLURPD, DETAIL1, "St_write: "
+		"Retrieved state information for %s:%s (timestamp %s)\n",
+		hostname, port, tbuf );
 #else
 	    Debug( LDAP_DEBUG_ARGS,
-		    "Retrieved state information for %s\n", tbuf, 0, 0 );
+		"Retrieved state information for %s:%s (timestamp %s)\n",
+		hostname, port, tbuf );
 #endif
 	} else {
 #ifdef NEW_LOGGING
@

