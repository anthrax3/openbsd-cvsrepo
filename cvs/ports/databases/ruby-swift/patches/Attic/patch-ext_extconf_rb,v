head	1.3;
access;
symbols
	OPENBSD_5_3:1.2.0.4
	OPENBSD_5_3_BASE:1.2
	OPENBSD_5_2:1.2.0.2
	OPENBSD_5_2_BASE:1.2
	OPENBSD_5_1_BASE:1.1.1.1
	OPENBSD_5_1:1.1.1.1.0.6
	OPENBSD_5_0:1.1.1.1.0.4
	OPENBSD_5_0_BASE:1.1.1.1
	OPENBSD_4_9:1.1.1.1.0.2
	OPENBSD_4_9_BASE:1.1.1.1
	jeremy_2010-Dec-20:1.1.1.1
	jeremy:1.1.1;
locks; strict;
comment	@# @;


1.3
date	2013.05.25.22.22.35;	author jeremy;	state dead;
branches;
next	1.2;

1.2
date	2012.04.06.19.26.13;	author jeremy;	state Exp;
branches;
next	1.1;

1.1
date	2010.12.20.17.43.58;	author jeremy;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2010.12.20.17.43.58;	author jeremy;	state Exp;
branches;
next	;


desc
@@


1.3
log
@Update to swift 1.2.0.  The database drivers have been moved into
separate swift-db-* ports (recently imported), and this no longer
depends on dbic++.

While here, allowing building on ruby 2.0.

OK sthen@@
@
text
@$OpenBSD: patch-ext_extconf_rb,v 1.2 2012/04/06 19:26:13 jeremy Exp $
--- ext/extconf.rb.orig	Wed Dec 31 16:00:00 1969
+++ ext/extconf.rb	Wed Feb 22 13:58:58 2012
@@@@ -4,14 +4,14 @@@@ require 'mkmf'
 Config::CONFIG['CC']  = 'g++'
 Config::CONFIG['CPP'] = 'g++'
 
-$CFLAGS  = '-fPIC -Os -I/usr/include -I/opt/local/include -I/usr/local/include'
+$CFLAGS  = "-fPIC -I#{ENV['LOCALBASE']}/include"
 
 def apt_install_hint pkg
   "sudo apt-get install #{pkg}"
 end
 
 def library_installed? name, hint
-  if find_library(name, 'main', *%w(/usr/lib /usr/local/lib /opt/lib /opt/local/lib /sw/lib))
+  if find_library(name, 'main', *%w(/usr/lib #{ENV['LOCALBASE']}/lib))
     true
   else
     $stderr.puts <<-ERROR
@@@@ -34,7 +34,7 @@@@ end
 
 def assert_dbicpp_version ver
   passed  = false
-  header  = '/usr/include/dbic++.h'
+  header  = "#{ENV['LOCALBASE']}/include/dbic++.h"
   message = "Swift needs dbic++ >= #{ver}. Please update your dbic++ installation."
 
   if File.exists?(header) && match = File.read(header).match(/DBI_VERSION\s+(.*?)\n/mi)
@@@@ -52,7 +52,7 @@@@ def assert_dbicpp_version ver
 end
 
 exit 1 unless library_installed? 'pcrecpp', apt_install_hint('libpcre3-dev')
-exit 1 unless library_installed? 'uuid',    apt_install_hint('uuid-dev')
+exit 1 unless library_installed? 'e2fs-uuid',    apt_install_hint('uuid-dev')
 exit 1 unless library_installed? 'dbic++',  apt_install_hint('dbic++-dev')
 
 assert_dbicpp_version '0.5.9'
@


1.2
log
@Update to ruby-swift 0.14.0.  Respect patches to respect LOCALBASE.
@
text
@d1 1
a1 1
$OpenBSD: patch-ext_extconf_rb,v 1.1.1.1 2010/12/20 17:43:58 jeremy Exp $
@


1.1
log
@Initial revision
@
text
@d1 4
a4 4
$OpenBSD$
--- ext/extconf.rb.orig	Thu Oct 28 17:03:48 2010
+++ ext/extconf.rb	Thu Oct 28 17:05:57 2010
@@@@ -4,7 +4,7 @@@@ require 'mkmf'
d8 2
a9 2
-$CFLAGS  = '-fPIC -Os'
+$CFLAGS  = '-fPIC'
d13 8
d38 1
a38 1
 assert_dbicpp_version '0.4.0'
@


1.1.1.1
log
@Import ruby-swift 0.7.2

Swift is a fast database API and ORM for ruby 1.9, featuring:
* Multiple databases.
* Prepared statements.
* Bind values.
* Transactions and named save points.
* EventMachine asynchronous interface.
* IdentityMap.
* Migrations.
@
text
@@
