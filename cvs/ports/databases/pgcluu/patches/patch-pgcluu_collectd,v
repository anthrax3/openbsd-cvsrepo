head	1.4;
access;
symbols
	OPENBSD_6_1:1.3.0.4
	OPENBSD_6_1_BASE:1.3
	OPENBSD_6_0:1.3.0.2
	OPENBSD_6_0_BASE:1.3
	OPENBSD_5_9:1.2.0.2
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.1.0.4
	OPENBSD_5_8_BASE:1.1;
locks; strict;
comment	@# @;


1.4
date	2017.08.09.12.49.36;	author jasper;	state Exp;
branches;
next	1.3;
commitid	WHuf1xszMKTeclsw;

1.3
date	2016.05.02.09.28.27;	author jasper;	state Exp;
branches;
next	1.2;
commitid	kEbuJk5b2hLeQHRE;

1.2
date	2016.01.06.09.48.28;	author jasper;	state Exp;
branches;
next	1.1;
commitid	xNQoPCHeznfCeFjz;

1.1
date	2015.06.17.12.10.42;	author jasper;	state Exp;
branches;
next	;
commitid	tomvVmH9j734l8Fc;


desc
@@


1.4
log
@update to pgcluu-2.6
@
text
@$OpenBSD: patch-pgcluu_collectd,v 1.3 2016/05/02 09:28:27 jasper Exp $

- Set $sysinfo{"RELEASE"}, $sysinfo{"CPU"} (minus cache)

Index: pgcluu_collectd
--- pgcluu_collectd.orig
+++ pgcluu_collectd
@@@@ -1501,9 +1501,9 @@@@ sub grab_os_information
 {
 
 	# Look at CPU informations
-	my $cmd = 'cat /proc/cpuinfo 2>/dev/null';
+	my $cmd = 'sysctl hw.ncpu hw.model hw.cpuspeed 2>/dev/null';
 	$cmd = $sshcmd . ' "' . $cmd . "\"" if ($sshcmd);
-	my @@cpuinfo = `$cmd | grep -E "model name|cpu MHz|cache size|cpu cores|processor"`;
+	my @@cpuinfo = `$cmd`;
 	# Look at kernel informations
 	$cmd = 'uname -a  2>/dev/null';
 	$cmd = $sshcmd . ' "' . $cmd . "\"" if ($sshcmd);
@@@@ -1529,8 +1529,7 @@@@ sub grab_os_information
 	$cmd = $sshcmd . ' "' . $cmd . "\"" if ($sshcmd);
 	my @@pciinfo = `$cmd`;
 	# Release informations
-	$cmd = 'cat /etc/*release 2>/dev/null';
-	$cmd = $sshcmd . ' "' . $cmd . "\"" if ($sshcmd);
+	$cmd = 'uname -srv 2>/dev/null';
 	my @@releaseinfo = `$cmd`;
 	# Process list
 	$cmd = 'ps -faux 2>/dev/null';
@


1.3
log
@update to pgcluu-2.5
@
text
@d1 1
a1 1
$OpenBSD: patch-pgcluu_collectd,v 1.2 2016/01/06 09:48:28 jasper Exp $
d5 4
a8 3
--- pgcluu_collectd.orig	Wed Apr 27 15:43:05 2016
+++ pgcluu_collectd	Mon May  2 11:27:39 2016
@@@@ -1442,9 +1442,9 @@@@ sub grab_os_information
d20 1
a20 1
@@@@ -1470,8 +1470,7 @@@@ sub grab_os_information
@


1.2
log
@update to pgcluu-2.4
@
text
@d1 1
a1 1
$OpenBSD: patch-pgcluu_collectd,v 1.1 2015/06/17 12:10:42 jasper Exp $
d5 3
a7 3
--- pgcluu_collectd.orig	Sat Jul 25 12:33:53 2015
+++ pgcluu_collectd	Tue Jan  5 20:19:31 2016
@@@@ -1296,9 +1296,9 @@@@ sub grab_os_information
d19 1
a19 1
@@@@ -1324,8 +1324,7 @@@@ sub grab_os_information
@


1.1
log
@start to fill out some sysinfo related fields
@
text
@d1 1
a1 1
$OpenBSD$
d5 3
a7 3
--- pgcluu_collectd.orig	Wed Jun 17 13:18:13 2015
+++ pgcluu_collectd	Wed Jun 17 13:49:47 2015
@@@@ -1102,9 +1102,9 @@@@ sub grab_os_information
d19 1
a19 1
@@@@ -1130,8 +1130,7 @@@@ sub grab_os_information
d27 2
a28 2
 	# System kernel tuning parameters
 	$cmd = '/sbin/sysctl -a 2>/dev/null';
@

