head	1.3;
access;
symbols
	OPENBSD_6_0:1.3.0.2
	OPENBSD_6_0_BASE:1.3
	OPENBSD_5_9:1.2.0.2
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.1.0.4
	OPENBSD_5_8_BASE:1.1;
locks; strict;
comment	@# @;


1.3
date	2016.05.02.09.28.27;	author jasper;	state Exp;
branches;
next	1.2;
commitid	kEbuJk5b2hLeQHRE;

1.2
date	2016.01.06.09.48.28;	author jasper;	state Exp;
branches;
next	1.1;
commitid	xNQoPCHeznfCeFjz;

1.1
date	2015.06.17.12.10.42;	author jasper;	state Exp;
branches;
next	;
commitid	tomvVmH9j734l8Fc;


desc
@@


1.3
log
@update to pgcluu-2.5
@
text
@$OpenBSD: patch-pgcluu,v 1.2 2016/01/06 09:48:28 jasper Exp $

- Set $sysinfo{"KERNEL"} and $sysinfo{"CPU"} (minus cache) values

--- pgcluu.orig	Wed Apr 27 15:43:05 2016
+++ pgcluu	Mon May  2 11:27:39 2016
@@@@ -9489,13 +9489,13 @@@@ sub read_sysinfo
 			next;
 		}
 		if ($section eq 'CPU') {
-			my ($key, $val) = split(/\s+:\s+/, $l);
-			if ($key eq 'processor') {
-				$sysinfo{$section}{$key} = $val + 1;
-			} elsif ($key eq 'model name') {
-				$val =~ s/\s+\@@\s+(.*)$//;
-				$sysinfo{$section}{'cpu MHz'} = $1;
-				$sysinfo{$section}{$key} = $val;
+			my ($key, $val) = split(/=/, $l);
+			if ($key eq 'hw.ncpu') {
+				$sysinfo{$section}{'processor'} = $val;
+			} elsif ($key eq 'hw.model') {
+				$sysinfo{$section}{'model name'} = $val;
+			} elsif ($key eq 'hw.cpuspeed') {
+				$sysinfo{$section}{'cpu MHz'} = $val;
 			} else {
 				$sysinfo{$section}{$key} = $val;
 			}
@@@@ -9503,8 +9503,8 @@@@ sub read_sysinfo
 		if ($section eq 'KERNEL') {
 			my @@kinf = split(/\s+/, $l);
 			$sysinfo{$section}{'hostname'} = $kinf[1];
-			$sysinfo{$section}{'kernel'} = "$kinf[0] $kinf[2] $kinf[3] $kinf[4]";
-			$sysinfo{$section}{'arch'} = "$kinf[-2] $kinf[-1]";
+			$sysinfo{$section}{'kernel'} = "$kinf[2] $kinf[3]";
+			$sysinfo{$section}{'arch'} = "$kinf[-1]";
 		}
 		if ($section eq 'UPTIME') {
 			$sysinfo{$section}{'all'} = $l;
@


1.2
log
@update to pgcluu-2.4
@
text
@d1 1
a1 1
$OpenBSD: patch-pgcluu,v 1.1 2015/06/17 12:10:42 jasper Exp $
d5 3
a7 3
--- pgcluu.orig	Sat Jul 25 12:33:53 2015
+++ pgcluu	Tue Jan  5 20:19:31 2016
@@@@ -8500,13 +8500,13 @@@@ sub read_sysinfo
d28 1
a28 1
@@@@ -8514,8 +8514,8 @@@@ sub read_sysinfo
d37 2
a38 2
 		if ($section eq 'RELEASE') {
 			my ($key, $val) = split(/=/, $l);
@


1.1
log
@start to fill out some sysinfo related fields
@
text
@d1 1
a1 1
$OpenBSD$
d5 3
a7 3
--- pgcluu.orig	Wed Jun 17 13:18:10 2015
+++ pgcluu	Wed Jun 17 13:49:47 2015
@@@@ -6854,13 +6854,13 @@@@ sub read_sysinfo
d28 1
a28 1
@@@@ -6868,8 +6868,8 @@@@ sub read_sysinfo
@

