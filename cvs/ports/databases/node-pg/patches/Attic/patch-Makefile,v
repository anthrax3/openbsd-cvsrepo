head	1.2;
access;
symbols
	OPENBSD_5_8:1.1.0.10
	OPENBSD_5_8_BASE:1.1
	OPENBSD_5_7:1.1.0.6
	OPENBSD_5_7_BASE:1.1
	OPENBSD_5_6:1.1.0.4
	OPENBSD_5_6_BASE:1.1
	OPENBSD_5_5:1.1.0.2
	OPENBSD_5_5_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2015.10.20.01.08.48;	author abieber;	state dead;
branches;
next	1.1;
commitid	sNboRQhNdZ8uEuKC;

1.1
date	2013.11.25.23.27.02;	author abieber;	state Exp;
branches;
next	;


desc
@@


1.2
log
@remove node-pg as part of the great purge of node-*

OK jturner@@ juanfra@@ jasper@@, "sounds alright to me" sthen@@
@
text
@$OpenBSD: patch-Makefile,v 1.1 2013/11/25 23:27:02 abieber Exp $
--- Makefile.orig	Fri Sep  6 00:14:17 2013
+++ Makefile	Thu Sep 12 12:32:08 2013
@@@@ -1,9 +1,12 @@@@
 SHELL := /bin/sh
 
-connectionString=postgres://
+connectionString=postgres://postgres:1234@@localhost:5432/postgres
 
 params := $(connectionString)
 
+MODULES := $(WRKDIR)/node_modules
+PG := $(MODULES)/pg
+
 node-command := xargs -n 1 -I file node file $(params)
 
 .PHONY : test test-connection test-integration bench test-native \
@@@@ -21,7 +24,7 @@@@ help:
 
 test: test-unit
 
-test-all: jshint test-unit test-integration test-native test-binary
+test-all: jshint prepare-test-db test-unit test-integration test-native test-binary
 
 test-travis: test-all upgrade-pg
 	@@make test-all connectionString=postgres://postgres@@localhost:5433/postgres
@@@@ -37,36 +40,38 @@@@ build/default/binding.node:
 	@@node-gyp rebuild
 
 test-unit:
-	@@find test/unit -name "*-tests.js" | $(node-command)
+	@@find $(PG)/test/unit -name "*-tests.js" | $(node-command)
 
 test-connection:
 	@@echo "***Testing connection***"
-	@@node script/test-connection.js $(params)
+	@@node $(PG)/script/test-connection.js $(params)
 
 test-connection-binary:
 	@@echo "***Testing binary connection***"
-	@@node script/test-connection.js $(params) binary
+	@@node $(PG)/script/test-connection.js $(params) binary
 
-test-native: build/default/binding.node
+test-native:
 	@@echo "***Testing native bindings***"
-	@@find test/native -name "*-tests.js" | $(node-command)
-	@@find test/integration -name "*-tests.js" | $(node-command) native
+	@@find $(PG)/test/native -name "*-tests.js" | $(node-command)
+	@@find $(PG)/test/integration -name "*-tests.js" | $(node-command) native
 
-test-integration: test-connection build/default/binding.node
+test-integration: test-connection
 	@@echo "***Testing Pure Javascript***"
-	@@find test/integration -name "*-tests.js" | $(node-command)
+	@@find $(PG)/test/integration -name "*-tests.js" | $(node-command)
 
 test-binary: test-connection-binary
 	@@echo "***Testing Pure Javascript (binary)***"
-	@@find test/integration -name "*-tests.js" | $(node-command) binary
+	@@find $(PG)/test/integration -name "*-tests.js" | $(node-command) binary
 
 prepare-test-db:
 	@@echo "***Preparing the database for tests***"
-	@@find script/create-test-tables.js  | $(node-command)
+	@@find $(PG)/script/create-test-tables.js | $(node-command) down
+	@@find $(PG)/script/create-test-tables.js  | $(node-command)
 
 jshint:
+	@@test -s $(MODULES)/jshint/bin/jshint || { echo "Please run: 'cd \`make show=WRKDIR\`; npm install jshint; cd -'"; exit 1; }
 	@@echo "***Starting jshint***"
-	@@./node_modules/.bin/jshint lib
+	@@$(MODULES)/jshint/bin/jshint $(PG)/lib
 
 publish:
 	@@rm -r build || (exit 0)
@


1.1
log
@Update from MAINTAINER Roman Kravchuk <kravchuk.kp@@gmail.com>

OK sthen@@
@
text
@d1 1
a1 1
$OpenBSD$
@

