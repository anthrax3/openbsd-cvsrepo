head	1.10;
access;
symbols
	OPENBSD_6_1:1.9.0.4
	OPENBSD_6_1_BASE:1.9
	OPENBSD_6_0:1.9.0.2
	OPENBSD_6_0_BASE:1.9
	OPENBSD_5_9:1.7.0.4
	OPENBSD_5_9_BASE:1.7
	OPENBSD_5_8:1.7.0.6
	OPENBSD_5_8_BASE:1.7
	OPENBSD_5_7:1.7.0.2
	OPENBSD_5_7_BASE:1.7
	OPENBSD_5_6:1.5.0.4
	OPENBSD_5_6_BASE:1.5
	OPENBSD_5_5:1.5.0.2
	OPENBSD_5_5_BASE:1.5
	OPENBSD_5_4:1.4.0.4
	OPENBSD_5_4_BASE:1.4
	OPENBSD_5_3:1.4.0.2
	OPENBSD_5_3_BASE:1.4;
locks; strict;
comment	@# @;


1.10
date	2017.08.09.09.16.09;	author dcoppa;	state Exp;
branches;
next	1.9;
commitid	KL6bkeK2RgpQiU3p;

1.9
date	2016.06.20.10.49.38;	author dcoppa;	state Exp;
branches;
next	1.8;
commitid	5Fle6QRUJ2xMCP8L;

1.8
date	2016.05.10.09.38.48;	author dcoppa;	state Exp;
branches;
next	1.7;
commitid	nsv8lxQo5Ys4l82d;

1.7
date	2014.12.05.09.33.09;	author dcoppa;	state Exp;
branches;
next	1.6;
commitid	WAOjA0U1BcrOo8q7;

1.6
date	2014.09.02.08.11.46;	author dcoppa;	state Exp;
branches;
next	1.5;
commitid	HKdKyVEglF8IzW03;

1.5
date	2013.11.29.08.32.24;	author dcoppa;	state Exp;
branches;
next	1.4;

1.4
date	2013.01.16.13.13.03;	author dcoppa;	state Exp;
branches;
next	1.3;

1.3
date	2012.11.23.08.29.42;	author dcoppa;	state Exp;
branches;
next	1.2;

1.2
date	2012.11.07.10.13.44;	author dcoppa;	state Exp;
branches;
next	1.1;

1.1
date	2012.10.23.10.41.23;	author dcoppa;	state Exp;
branches;
next	;


desc
@@


1.10
log
@
Update to redis-4.0.1
@
text
@$OpenBSD: patch-deps_Makefile,v 1.9 2016/06/20 10:49:38 dcoppa Exp $
Index: deps/Makefile
--- deps/Makefile.orig
+++ deps/Makefile
@@@@ -35,49 +35,16 @@@@ endif
 distclean:
 	-(cd hiredis && $(MAKE) clean) > /dev/null || true
 	-(cd linenoise && $(MAKE) clean) > /dev/null || true
-	-(cd lua && $(MAKE) clean) > /dev/null || true
-	-(cd jemalloc && [ -f Makefile ] && $(MAKE) distclean) > /dev/null || true
 	-(rm -f .make-*)
 
 .PHONY: distclean
 
 hiredis: .make-prerequisites
-	@@printf '%b %b\n' $(MAKECOLOR)MAKE$(ENDCOLOR) $(BINCOLOR)$@@$(ENDCOLOR)
 	cd hiredis && $(MAKE) static
 
 .PHONY: hiredis
 
 linenoise: .make-prerequisites
-	@@printf '%b %b\n' $(MAKECOLOR)MAKE$(ENDCOLOR) $(BINCOLOR)$@@$(ENDCOLOR)
 	cd linenoise && $(MAKE)
 
 .PHONY: linenoise
-
-ifeq ($(uname_S),SunOS)
-	# Make isinf() available
-	LUA_CFLAGS= -D__C99FEATURES__=1
-endif
-
-LUA_CFLAGS+= -O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL -DREDIS_STATIC='' $(CFLAGS)
-LUA_LDFLAGS+= $(LDFLAGS)
-# lua's Makefile defines AR="ar rcu", which is unusual, and makes it more
-# challenging to cross-compile lua (and redis).  These defines make it easier
-# to fit redis into cross-compilation environments, which typically set AR.
-AR=ar
-ARFLAGS=rcu
-
-lua: .make-prerequisites
-	@@printf '%b %b\n' $(MAKECOLOR)MAKE$(ENDCOLOR) $(BINCOLOR)$@@$(ENDCOLOR)
-	cd lua/src && $(MAKE) all CFLAGS="$(LUA_CFLAGS)" MYLDFLAGS="$(LUA_LDFLAGS)" AR="$(AR) $(ARFLAGS)"
-
-.PHONY: lua
-
-JEMALLOC_CFLAGS= -std=gnu99 -Wall -pipe -g3 -O3 -funroll-loops $(CFLAGS)
-JEMALLOC_LDFLAGS= $(LDFLAGS)
-
-jemalloc: .make-prerequisites
-	@@printf '%b %b\n' $(MAKECOLOR)MAKE$(ENDCOLOR) $(BINCOLOR)$@@$(ENDCOLOR)
-	cd jemalloc && ./configure --with-lg-quantum=3 --with-jemalloc-prefix=je_ --enable-cc-silence CFLAGS="$(JEMALLOC_CFLAGS)" LDFLAGS="$(JEMALLOC_LDFLAGS)"
-	cd jemalloc && $(MAKE) CFLAGS="$(JEMALLOC_CFLAGS)" LDFLAGS="$(JEMALLOC_LDFLAGS)" lib/libjemalloc.a
-
-.PHONY: jemalloc
@


1.9
log
@
Update to redis-3.2.1
@
text
@d1 5
a5 4
$OpenBSD: patch-deps_Makefile,v 1.8 2016/05/10 09:38:48 dcoppa Exp $
--- deps/Makefile.orig	Fri May  6 09:11:36 2016
+++ deps/Makefile	Tue May 10 09:51:32 2016
@@@@ -35,7 +35,6 @@@@ endif
d10 1
a10 2
 	-(cd geohash-int && $(MAKE) clean) > /dev/null || true
 	-(cd jemalloc && [ -f Makefile ] && $(MAKE) distclean) > /dev/null || true
d12 1
a12 1
@@@@ -43,48 +42,25 @@@@ distclean:
d26 1
a26 1
 
d46 4
a49 4
 JEMALLOC_CFLAGS= -std=gnu99 -Wall -pipe -g3 -O3 -funroll-loops $(CFLAGS)
 JEMALLOC_LDFLAGS= $(LDFLAGS)
 
 jemalloc: .make-prerequisites
d51 4
a54 10
 	cd jemalloc && ./configure --with-lg-quantum=3 --with-jemalloc-prefix=je_ --enable-cc-silence CFLAGS="$(JEMALLOC_CFLAGS)" LDFLAGS="$(JEMALLOC_LDFLAGS)"
 	cd jemalloc && $(MAKE) CFLAGS="$(JEMALLOC_CFLAGS)" LDFLAGS="$(JEMALLOC_LDFLAGS)" lib/libjemalloc.a
 
 .PHONY: jemalloc
 
 geohash-int: .make-prerequisites
-	@@printf '%b %b\n' $(MAKECOLOR)MAKE$(ENDCOLOR) $(BINCOLOR)$@@$(ENDCOLOR)
 	cd geohash-int && $(MAKE)
 
 .PHONY: geohash-int
@


1.8
log
@
Update to redis-3.2.0
@
text
@d1 1
a1 1
$OpenBSD: patch-deps_Makefile,v 1.7 2014/12/05 09:33:09 dcoppa Exp $
d51 1
a51 1
 	cd jemalloc && ./configure --with-jemalloc-prefix=je_ --enable-cc-silence CFLAGS="$(JEMALLOC_CFLAGS)" LDFLAGS="$(JEMALLOC_LDFLAGS)"
@


1.7
log
@
Update to redis-2.8.18
@
text
@d1 4
a4 4
$OpenBSD: patch-deps_Makefile,v 1.6 2014/09/02 08:11:46 dcoppa Exp $
--- deps/Makefile.orig	Fri Dec  5 02:34:15 2014
+++ deps/Makefile	Fri Dec  5 02:47:26 2014
@@@@ -35,48 +35,25 @@@@ endif
d9 1
d12 1
a12 1
 
d32 1
a32 1
-LUA_CFLAGS+= -O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL $(CFLAGS)
d54 7
@


1.6
log
@
Update to redis-2.8.14
@
text
@d1 3
a3 3
$OpenBSD: patch-deps_Makefile,v 1.5 2013/11/29 08:32:24 dcoppa Exp $
--- deps/Makefile.orig	Tue Sep  2 10:06:01 2014
+++ deps/Makefile	Tue Sep  2 10:07:06 2014
d31 1
a31 1
-LUA_CFLAGS+= -O2 -Wall -DLUA_ANSI $(CFLAGS)
@


1.5
log
@Update to redis-2.8.1
@
text
@d1 4
a4 4
$OpenBSD: patch-deps_Makefile,v 1.4 2013/01/16 13:13:03 dcoppa Exp $
--- deps/Makefile.orig	Wed Nov 27 15:21:52 2013
+++ deps/Makefile	Wed Nov 27 15:23:07 2013
@@@@ -35,43 +35,25 @@@@ endif
d33 5
d41 1
a41 1
-	cd lua/src && $(MAKE) all CFLAGS="$(LUA_CFLAGS)" MYLDFLAGS="$(LUA_LDFLAGS)"
@


1.4
log
@Switch Redis to use lua from ports instead of the one that comes
bundled with it.

OK jasper@@
@
text
@d1 3
a3 3
$OpenBSD: patch-deps_Makefile,v 1.3 2012/11/23 08:29:42 dcoppa Exp $
--- deps/Makefile.orig	Thu Jan 10 17:15:16 2013
+++ deps/Makefile	Mon Jan 14 16:46:33 2013
d27 2
a28 2
-  # Make isinf() available
-  LUA_CFLAGS= -D__C99FEATURES__=1
@


1.3
log
@Update to redis-2.6.5
@
text
@d1 11
a11 4
$OpenBSD: patch-deps_Makefile,v 1.2 2012/11/07 10:13:44 dcoppa Exp $
--- deps/Makefile.orig	Thu Nov 22 17:03:27 2012
+++ deps/Makefile	Fri Nov 23 08:59:25 2012
@@@@ -42,13 +42,11 @@@@ distclean:
a24 3
@@@@ -58,11 +56,10 @@@@ ifeq ($(uname_S),SunOS)
   LUA_CFLAGS= -D__C99FEATURES__=1
 endif
d26 5
d32 3
a34 4
+LUA_CFLAGS+= -Wall -DLUA_ANSI $(CFLAGS)
 LUA_LDFLAGS+= $(LDFLAGS)
 
 lua: .make-prerequisites
d36 5
a40 4
 	cd lua/src && $(MAKE) all CFLAGS="$(LUA_CFLAGS)" MYLDFLAGS="$(LUA_LDFLAGS)"
 
 .PHONY: lua
@@@@ -71,7 +68,6 @@@@ JEMALLOC_CFLAGS= -std=gnu99 -Wall -pipe -g3 -O3 -funro
@


1.2
log
@Bugfix update to redis-2.6.3
@
text
@d1 3
a3 3
$OpenBSD: patch-deps_Makefile,v 1.1 2012/10/23 10:41:23 dcoppa Exp $
--- deps/Makefile.orig	Tue Nov  6 22:07:51 2012
+++ deps/Makefile	Wed Nov  7 10:31:01 2012
d18 6
a23 1
@@@@ -62,7 +60,6 @@@@ LUA_CFLAGS+= -O2 -Wall -DLUA_ANSI $(CFLAGS)
@


1.1
log
@Update to redis-2.6.0

https://raw.github.com/antirez/redis/2.6/00-RELEASENOTES

All tests passed without errors on sparc64: yay!
@
text
@d1 3
a3 3
$OpenBSD$
--- deps/Makefile.orig	Tue Oct 23 10:56:16 2012
+++ deps/Makefile	Tue Oct 23 10:56:41 2012
d32 1
a32 1
 	cd jemalloc && $(MAKE) lib/libjemalloc.a
@

