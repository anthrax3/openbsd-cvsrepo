head	1.40;
access;
symbols
	OPENBSD_6_0:1.38.0.2
	OPENBSD_6_0_BASE:1.38
	OPENBSD_5_9:1.36.0.2
	OPENBSD_5_9_BASE:1.36
	OPENBSD_5_8:1.34.0.4
	OPENBSD_5_8_BASE:1.34
	OPENBSD_5_7:1.27.0.2
	OPENBSD_5_7_BASE:1.27
	OPENBSD_5_6:1.18.0.2
	OPENBSD_5_6_BASE:1.18
	OPENBSD_5_5:1.12.0.2
	OPENBSD_5_5_BASE:1.12
	OPENBSD_5_4:1.6.0.2
	OPENBSD_5_4_BASE:1.6
	jasper_20132806:1.1.1.1
	jasper:1.1.1;
locks; strict;
comment	@# @;


1.40
date	2016.09.06.11.27.26;	author jasper;	state Exp;
branches;
next	1.39;
commitid	IcL9InTVn5vnIGvq;

1.39
date	2016.09.05.09.00.08;	author jasper;	state Exp;
branches;
next	1.38;
commitid	i2n4AbDJLmxZQ2Ec;

1.38
date	2016.06.29.16.14.38;	author espie;	state Exp;
branches;
next	1.37;
commitid	c1yQMbJbfo0CFBcL;

1.37
date	2016.06.01.12.09.12;	author jasper;	state Exp;
branches;
next	1.36;
commitid	AjZy28tsql3GdlLj;

1.36
date	2015.10.23.20.34.55;	author jasper;	state Exp;
branches;
next	1.35;
commitid	sjXUsytNBtshNviP;

1.35
date	2015.08.14.12.21.41;	author jasper;	state Exp;
branches;
next	1.34;
commitid	TwRP4GbLsFIx4xlq;

1.34
date	2015.07.18.21.11.18;	author jasper;	state Exp;
branches;
next	1.33;
commitid	7lAcPgPxUa1f4S8R;

1.33
date	2015.07.17.15.07.51;	author jasper;	state Exp;
branches;
next	1.32;
commitid	kflVWQN6aJow7Okm;

1.32
date	2015.07.17.14.47.24;	author nigel;	state Exp;
branches;
next	1.31;
commitid	SBfNSKZKEftDnBmT;

1.31
date	2015.07.16.21.56.23;	author jasper;	state Exp;
branches;
next	1.30;
commitid	hgT0Z1u9Gp9mKnKj;

1.30
date	2015.06.07.10.22.31;	author jasper;	state Exp;
branches;
next	1.29;
commitid	7r9mJzuXc5lHTxEv;

1.29
date	2015.05.09.08.04.30;	author jasper;	state Exp;
branches;
next	1.28;
commitid	aPDfQ8A0zaRsencs;

1.28
date	2015.04.15.15.15.26;	author jasper;	state Exp;
branches;
next	1.27;
commitid	sbQzZBt6wizUT7Gd;

1.27
date	2014.12.07.19.24.10;	author jasper;	state Exp;
branches;
next	1.26;
commitid	7fpo7tLXGh2f0Lxd;

1.26
date	2014.11.20.09.28.52;	author jasper;	state Exp;
branches;
next	1.25;
commitid	lCxg7cXYGqmQHoo5;

1.25
date	2014.10.22.08.19.45;	author jasper;	state Exp;
branches;
next	1.24;
commitid	d0nO9VS6TpbXF26E;

1.24
date	2014.10.16.11.55.42;	author jasper;	state Exp;
branches;
next	1.23;
commitid	HuYxbtq5JbNzISdH;

1.23
date	2014.09.28.16.08.44;	author jeremy;	state Exp;
branches;
next	1.22;
commitid	r4Lbw9qrEa6d0uGB;

1.22
date	2014.09.27.17.08.47;	author jeremy;	state Exp;
branches;
next	1.21;
commitid	VuChuI65GQ9mvmEc;

1.21
date	2014.08.30.14.16.07;	author jasper;	state Exp;
branches;
next	1.20;
commitid	yZMOQ7Yij0fceC21;

1.20
date	2014.08.30.14.07.45;	author jasper;	state Exp;
branches;
next	1.19;
commitid	dKjpXJqz0npIG0dw;

1.19
date	2014.08.29.10.51.39;	author sebastia;	state Exp;
branches;
next	1.18;
commitid	sm8YiJKUFMtUc5kb;

1.18
date	2014.07.09.14.24.38;	author jasper;	state Exp;
branches;
next	1.17;
commitid	RgipoCoaeT649CjR;

1.17
date	2014.07.09.08.31.51;	author jasper;	state Exp;
branches;
next	1.16;
commitid	WsUGHIFFnn3SVHfD;

1.16
date	2014.05.07.10.59.53;	author jasper;	state Exp;
branches;
next	1.15;

1.15
date	2014.04.17.18.12.09;	author jasper;	state Exp;
branches;
next	1.14;

1.14
date	2014.03.31.09.17.56;	author jasper;	state Exp;
branches;
next	1.13;

1.13
date	2014.03.31.08.43.22;	author jasper;	state Exp;
branches;
next	1.12;

1.12
date	2014.02.09.13.09.22;	author jasper;	state Exp;
branches;
next	1.11;

1.11
date	2014.01.30.18.29.51;	author jasper;	state Exp;
branches;
next	1.10;

1.10
date	2013.12.23.09.51.12;	author jasper;	state Exp;
branches;
next	1.9;

1.9
date	2013.12.23.09.44.46;	author jasper;	state Exp;
branches;
next	1.8;

1.8
date	2013.12.15.11.29.22;	author jasper;	state Exp;
branches;
next	1.7;

1.7
date	2013.08.20.06.58.26;	author jasper;	state Exp;
branches;
next	1.6;

1.6
date	2013.07.11.18.39.43;	author sthen;	state Exp;
branches;
next	1.5;

1.5
date	2013.07.11.18.38.50;	author sthen;	state Exp;
branches;
next	1.4;

1.4
date	2013.07.01.13.49.00;	author jasper;	state Exp;
branches;
next	1.3;

1.3
date	2013.06.28.09.40.10;	author jasper;	state Exp;
branches;
next	1.2;

1.2
date	2013.06.28.09.30.44;	author jasper;	state Exp;
branches;
next	1.1;

1.1
date	2013.06.28.09.13.09;	author jasper;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2013.06.28.09.13.09;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.40
log
@sebastia@@ takes over these too
@
text
@# $OpenBSD: Makefile,v 1.39 2016/09/05 09:00:08 jasper Exp $

PORTROACH=	limit:^2

COMMENT-main=	fast, scalable, and reliable data warehouse for Puppet
COMMENT-plugin= PuppetDB terminus plugin

V=		2.3.8
DISTNAME=	puppetdb-$V
PKGNAME-main=	${DISTNAME}
PKGNAME-plugin= puppetdb-terminus-$V
CATEGORIES=	databases

REVISION-main=	2
REVISION-plugin=1

HOMEPAGE=	http://docs.puppetlabs.com/puppetdb/latest/

MAINTAINER=	Sebastian Reitenbach <sebastia@@openbsd.org>

MASTER_SITES=	http://downloads.puppetlabs.com/puppetdb/

# Apache
PERMIT_PACKAGE_CDROM=	Yes

MODULES=	java \
		lang/ruby
MODJAVA_VER=	1.7+
MODRUBY_REV=	2.2

MULTI_PACKAGES= -main -plugin

RUN_DEPENDS-plugin=sysutils/ruby-puppet/3>=3.5.1

RUN_DEPENDS-main=${BASE_PKGPATH},-plugin \
		${MODJAVA_RUN_DEPENDS} \
		java/javaPathHelper \
		shells/bash

NO_BUILD=	Yes
NO_TEST=	Yes

SCRIPTS=	anonymize export foreground import ssl-setup

do-configure:
	${SUBST_CMD} ${WRKSRC}/Rakefile \
		${WRKSRC}/tasks/install.rake \
		${WRKSRC}/ext/files/config.ini \
		${WRKSRC}/ext/files/puppetdb.env
.for s in ${SCRIPTS}
	${SUBST_CMD} ${WRKSRC}/ext/files/puppetdb-$s
.endfor
	sed -i -e 's,/bin/bash,${LOCALBASE}/bin/bash,g;' \
		-e 's,/usr/libexec,${LOCALBASE}/libexec,g;' \
		${WRKSRC}/ext/files/puppetdb*


do-install:
	${INSTALL_DATA_DIR} ${PREFIX}/share/{,examples/}puppetdb
	${INSTALL_DATA_DIR} ${PREFIX}/libexec/puppetdb/
	${INSTALL_SCRIPT} ${WRKSRC}/ext/files/puppetdb ${PREFIX}/bin/
.for s in ${SCRIPTS}
	${INSTALL_SCRIPT} ${WRKSRC}/ext/files/puppetdb-$s ${PREFIX}/libexec/puppetdb/
.endfor
	${INSTALL_DATA} ${WRKSRC}/ext/files/puppetdb.env ${PREFIX}/libexec/puppetdb/
.for c in config.ini database.ini jetty.ini repl.ini
	 ${INSTALL_DATA} ${WRKSRC}/ext/files/$c ${PREFIX}/share/examples/puppetdb/
.endfor
	${INSTALL_DATA} ${WRKSRC}/ext/files/logback.xml \
		${PREFIX}/share/examples/puppetdb/
	${INSTALL_DATA} ${WRKSRC}/puppetdb.jar ${PREFIX}/share/puppetdb/
	cd ${PREFIX}/share/puppetdb/ && ln -sf /var/db/puppetdb/db db
	cd ${PREFIX}/share/puppetdb/ && ln -sf /var/db/puppetdb/mq mq
	cd ${PREFIX}/share/puppetdb/ && ln -sf /var/db/puppetdb/state state
	${INSTALL_DATA_DIR} ${PREFIX}/${MODRUBY_SITEDIR}
	cd ${WRKSRC}/ext/master/lib/ && pax -rw . ${PREFIX}/${MODRUBY_SITEDIR}

.include <bsd.port.mk>
@


1.39
log
@force MODRUBY_REV=2.2, partially from jeremy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2016/06/29 16:14:38 espie Exp $
d14 2
a15 2
REVISION-main=	1
REVISION-plugin=0
d19 1
a19 1
MAINTAINER=	Jasper Lievisse Adriaanse <jasper@@openbsd.org>
@


1.38
log
@add is-branch to all trivial ports that exist as multiple branches.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2016/06/01 12:09:12 jasper Exp $
d29 1
@


1.37
log
@register conflict with upcoming puppetdb4 port
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2015/10/23 20:34:55 jasper Exp $
d14 1
a14 1
REVISION-main=	0
@


1.36
log
@update to puppetdb-2.3.8
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2015/08/14 12:21:41 jasper Exp $
d13 3
@


1.35
log
@- update to puppetdb-2.3.7
* only one bug fixed:
"The max-frame-size setting is now applied to the ActiveMQ consumer thread. It
was previously set to the default, which could case errors when extremely
large commands were submitted"
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2015/07/18 21:11:18 jasper Exp $
d8 1
a8 1
V=		2.3.7
@


1.34
log
@use sed -i
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2015/07/17 15:07:51 jasper Exp $
d8 1
a8 1
V=		2.3.6
@


1.33
log
@update to puppetdb-2.3.6
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2015/07/17 14:47:24 nigel Exp $
d49 1
a49 1
	perl -pi -e 's,/bin/bash,${LOCALBASE}/bin/bash,g;' \
@


1.32
log
@bump now ruby22 is the default FLAVOR
Ok jeremy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2015/07/16 21:56:23 jasper Exp $
d8 1
a8 1
V=		2.3.5
a12 1
REVISION-plugin=	0
@


1.31
log
@set PORTROACH
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2015/06/07 10:22:31 jasper Exp $
d13 1
@


1.30
log
@- update to puppetdb-2.3.5

also tested by sebastia@@
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.29 2015/05/09 08:04:30 jasper Exp $
@


1.29
log
@update to puppetdb-2.3.4
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2015/04/15 15:15:26 jasper Exp $
d6 1
a6 1
V=		2.3.4
@


1.28
log
@- update to puppetdb-2.3.3

additional testing/ok sebastia@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2014/12/07 19:24:10 jasper Exp $
d6 1
a6 1
V=		2.3.3
@


1.27
log
@tweak SSL setup instructions
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2014/11/20 09:28:52 jasper Exp $
d6 1
a6 1
V=		2.2.2
a10 2

REVISION-main=	1
@


1.26
log
@fix typo in puppetdb routes configuration
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2014/10/22 08:19:45 jasper Exp $
d12 1
a12 1
REVISION-main=	0
@


1.25
log
@update to puppetdb-2.2.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2014/10/16 11:55:42 jasper Exp $
d11 2
@


1.24
log
@update to puppetdb-2.2.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2014/09/28 16:08:44 jeremy Exp $
d6 1
a6 1
V=		2.2.1
@


1.23
log
@Unbreak by removing ${MODRUBY_FLAVOR} from RDEP that doesn't use FLAVORs.

Pointed out by nigel@@ and naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2014/09/27 17:08:47 jeremy Exp $
d6 1
a6 1
V=		2.2.0
a9 2
REVISION-main=	0
REVISION-plugin=0
@


1.22
log
@Use default version of ruby instead of ruby 2.0.

OK jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2014/08/30 14:16:07 jasper Exp $
d29 1
a29 1
RUN_DEPENDS-plugin=sysutils/ruby-puppet/3,${MODRUBY_FLAVOR}>=3.5.1
@


1.21
log
@Document pg_trgm indexes procedure
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2014/08/30 14:07:45 jasper Exp $
d11 1
a24 1
MODRUBY_REV=	2.0
d29 1
a29 1
RUN_DEPENDS-plugin=sysutils/ruby-puppet/3>=3.5.1
@


1.20
log
@update to puppetdb-2.2.0
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2014/08/29 10:51:39 sebastia Exp $
d10 1
@


1.19
log
@Tweak puppetdb port to install multiple .ini files in the puppetdb/conf.d
configuration directory. Update the README to the according changes and
add a section about upgrading.

Feedback, testing and OK jasper@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2014/07/09 14:24:38 jasper Exp $
d6 1
a6 1
V=		2.1.0
a9 1
REVISION-main=	1
@


1.18
log
@set daemon_timeout a reasonble enough value to give this beast time to
shutdown cleanly.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2014/07/09 08:31:51 jasper Exp $
d10 1
a10 1
REVISION-main=	0
d63 1
a63 1
	cat ${WRKSRC}/ext/files/$c >> ${PREFIX}/share/examples/puppetdb/puppetdb.ini
@


1.17
log
@- update to puppetdb-2.1.0
* http://docs.puppetlabs.com/puppetdb/latest/release_notes.html#section
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2014/05/07 10:59:53 jasper Exp $
d10 1
@


1.16
log
@- update to puppetdb-2.0.0
* http://docs.puppetlabs.com/puppetdb/latest/release_notes.html#section
- when upgrading, please merge your log4j.properties into logback.xml
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2014/04/17 18:12:09 jasper Exp $
d6 1
a6 1
V=		2.0.0
@


1.15
log
@follow the puppet master and switch to ruby 2.0.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2014/03/31 09:17:56 jasper Exp $
d6 1
a6 1
V=		1.6.3
a9 2
REVISION-main=	1
REVISION-plugin=0
d28 1
a28 1
RUN_DEPENDS-plugin=sysutils/ruby-puppet/3
d42 3
a44 3
			${WRKSRC}/tasks/install.rake \
			${WRKSRC}/ext/files/config.ini \
			${WRKSRC}/ext/files/puppetdb.env
d62 1
a62 1
	cat ${WRKSRC}/ext/files/$c >> ${PREFIX}/share/examples/puppetdb/puppetdb.conf
d64 1
a64 1
	${INSTALL_DATA} ${WRKSRC}/ext/files/log4j.properties \
@


1.14
log
@simplify patches
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2014/03/31 08:43:22 jasper Exp $
d10 2
a11 1
REVISION-main=	0
d25 1
a25 1
MODRUBY_REV=	1.9
@


1.13
log
@update to puppetdb-1.6.3
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2014/02/09 13:09:22 jasper Exp $
d10 1
d44 2
a45 1
			${WRKSRC}/ext/files/config.ini
d49 4
d57 1
d61 1
@


1.12
log
@- bugfix update to puppetdb-1.6.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2014/01/30 18:29:51 jasper Exp $
d6 1
a6 1
V=		1.6.2
@


1.11
log
@- update to puppetdb-1.6.0
* mostly performance and bugfixes: http://docs.puppetlabs.com/puppetdb/latest/release_notes.html#section
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2013/12/23 09:51:12 jasper Exp $
d6 1
a6 1
V=		1.6.0
@


1.10
log
@make it clear the hardcoded /etc is for non-OpenBSD installations.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2013/12/23 09:44:46 jasper Exp $
d6 1
a6 1
V=		1.5.2
a8 1
REVISION-main=	1
d50 1
d52 1
a52 1
	${INSTALL_SCRIPT} ${WRKSRC}/ext/files/puppetdb-$s ${PREFIX}/sbin/
@


1.9
log
@add some instructions on how to setup and configure puppetdb
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2013/12/15 11:29:22 jasper Exp $
d9 1
a9 1
REVISION-main=	0
@


1.8
log
@- update to puppetdb-1.5.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2013/08/20 06:58:26 jasper Exp $
d9 1
@


1.7
log
@add missing run dependency which got lost in the switch to multi-packages

spotted by Jean-Gerard Pailloncy, thanks
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2013/07/11 18:39:43 sthen Exp $
d6 1
a6 1
V=		1.3.2
a9 2
REVISION-main=	4
REVISION-plugin=0
d38 1
a38 1
SCRIPTS=	export foreground import ssl-setup
@


1.6
log
@oops, bump the right subpackage
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2013/07/11 18:38:50 sthen Exp $
d10 2
a11 2
REVISION-main=	3
REVISION-plugin= 0
d33 1
@


1.5
log
@missed bump (ruby-puppet -> puppet)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2013/07/01 13:49:00 jasper Exp $
d11 1
@


1.4
log
@don't hardcode /etc here.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2013/06/28 09:40:10 jasper Exp $
d10 1
a10 1
REVISION-main=	2
@


1.3
log
@- don't install puppetdb.default which is just for Linuxen
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2013/06/28 09:30:44 jasper Exp $
d10 1
a10 1
REVISION-main=	1
d41 3
a43 1
	${SUBST_CMD} ${WRKSRC}/Rakefile ${WRKSRC}/tasks/install.rake
@


1.2
log
@- drop unneeded [jetty] block from config.ini since all configs are concatenated
  into puppetdb.conf
- puppetdb-ssl-setup were committed upstream
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2013/06/28 09:13:09 jasper Exp $
d10 1
a10 1
REVISION-main=	0
d41 1
a41 2
	${SUBST_CMD} ${WRKSRC}/Rakefile ${WRKSRC}/tasks/install.rake \
		${WRKSRC}/ext/files/puppetdb.default
a53 2
	${INSTALL_DATA} ${WRKSRC}/ext/files/puppetdb.default \
		${PREFIX}/share/examples/puppetdb/
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d10 1
@


1.1.1.1
log
@import puppetdb 1.3.2

PuppetDB is the fast, scalable, and reliable data warehouse for Puppet.
It caches data generated by Puppet, and gives you advanced features at
awesome speed with a powerful API.

ok aja@@
@
text
@@
