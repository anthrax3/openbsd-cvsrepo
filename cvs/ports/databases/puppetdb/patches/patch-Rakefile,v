head	1.7;
access;
symbols
	OPENBSD_6_2:1.7.0.14
	OPENBSD_6_2_BASE:1.7
	OPENBSD_6_1:1.7.0.12
	OPENBSD_6_1_BASE:1.7
	OPENBSD_6_0:1.7.0.10
	OPENBSD_6_0_BASE:1.7
	OPENBSD_5_9:1.7.0.6
	OPENBSD_5_9_BASE:1.7
	OPENBSD_5_8:1.7.0.8
	OPENBSD_5_8_BASE:1.7
	OPENBSD_5_7:1.7.0.4
	OPENBSD_5_7_BASE:1.7
	OPENBSD_5_6:1.7.0.2
	OPENBSD_5_6_BASE:1.7
	OPENBSD_5_5:1.4.0.2
	OPENBSD_5_5_BASE:1.4
	OPENBSD_5_4:1.2.0.2
	OPENBSD_5_4_BASE:1.2
	jasper_20132806:1.1.1.1
	jasper:1.1.1;
locks; strict;
comment	@# @;


1.7
date	2014.07.09.08.31.51;	author jasper;	state Exp;
branches;
next	1.6;
commitid	WsUGHIFFnn3SVHfD;

1.6
date	2014.05.07.10.59.53;	author jasper;	state Exp;
branches;
next	1.5;

1.5
date	2014.03.31.08.43.22;	author jasper;	state Exp;
branches;
next	1.4;

1.4
date	2014.01.30.18.29.51;	author jasper;	state Exp;
branches;
next	1.3;

1.3
date	2013.12.15.11.29.22;	author jasper;	state Exp;
branches;
next	1.2;

1.2
date	2013.07.02.14.43.04;	author jasper;	state Exp;
branches;
next	1.1;

1.1
date	2013.06.28.09.13.09;	author jasper;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2013.06.28.09.13.09;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.7
log
@- update to puppetdb-2.1.0
* http://docs.puppetlabs.com/puppetdb/latest/release_notes.html#section
@
text
@$OpenBSD: patch-Rakefile,v 1.6 2014/05/07 10:59:53 jasper Exp $

- Change various configuration variables to what they would be like when
  PuppetDB has been _installed_, as these variables are used in other scripts.
  The installer has been modified in tasks/install.rake
- Set OpenBSD's Ruby site dir.

--- Rakefile.orig	Mon Jul  7 19:37:05 2014
+++ Rakefile	Wed Jul  9 10:20:57 2014
@@@@ -85,24 +85,24 @@@@ else
       else
         "/usr/share/puppetdb"
       end
-    @@etc_dir = "/etc/puppetdb"
-    @@config_dir = "/etc/puppetdb/conf.d"
-    @@lib_dir = "/var/lib/puppetdb"
+    @@etc_dir = "${SYSCONFDIR}/puppetdb"
+    @@config_dir = "${SYSCONFDIR}/puppetdb/conf.d"
+    @@lib_dir = "${VARBASE}/db//puppetdb"
     @@libexec_dir = case @@osfamily
       when /openbsd/
-        "/usr/local/libexec/puppetdb"
+        "${PREFIX}/libexec/puppetdb"
       when /redhat/, /suse/, /darwin/, /bsd/
         "/usr/libexec/puppetdb"
       else
         "/usr/lib/puppetdb"
       end
-    @@link = "/usr/share/puppetdb"
-    @@name = "puppetdb"
+    @@link = "share/puppetdb"
+    @@name = "_puppetdb"
     @@sbin_dir = case @@osfamily
       when /archlinux/
         "/usr/bin"
       else
-        "/usr/sbin"
+        "sbin"
       end
 end
 
@@@@ -128,7 +128,7 @@@@ case @@osfamily
   when /suse/
     @@plibdir = @@pe ? PE_SITELIBDIR : (%x(ruby -rrbconfig -e "puts RbConfig::CONFIG['sitelibdir']").chomp)
   when /openbsd/
-    @@plibdir = @@pe ? PE_SITELIBDIR : '/usr/local/lib/ruby/site_ruby/1.9.1'
+    @@plibdir = @@pe ? PE_SITELIBDIR : '${MODRUBY_SITEDIR}'
   when /archlinux/
     @@plibdir = @@pe ? PE_SITELIBDIR : (%x(ruby -rrbconfig -e 'puts RbConfig::CONFIG["vendorlibdir"]').chomp)
 end
@


1.6
log
@- update to puppetdb-2.0.0
* http://docs.puppetlabs.com/puppetdb/latest/release_notes.html#section
- when upgrading, please merge your log4j.properties into logback.xml
@
text
@d1 1
a1 1
$OpenBSD: patch-Rakefile,v 1.5 2014/03/31 08:43:22 jasper Exp $
d8 3
a10 3
--- Rakefile.orig	Thu May  1 09:34:35 2014
+++ Rakefile	Thu May  1 09:37:13 2014
@@@@ -85,20 +85,20 @@@@ else
d19 1
a19 1
+    @@lib_dir = "${VARBASE}/db/puppetdb"
a30 1
-    @@sbin_dir = "/usr/sbin"
d33 7
a39 1
+    @@sbin_dir = "sbin"
d42 1
a42 2
 @@initscriptname = "/etc/init.d/#{@@name}"
@@@@ -123,7 +123,7 @@@@ case @@osfamily
@


1.5
log
@update to puppetdb-1.6.3
@
text
@d1 1
a1 1
$OpenBSD: patch-Rakefile,v 1.4 2014/01/30 18:29:51 jasper Exp $
d8 6
a13 7
--- Rakefile.orig	Thu Mar 27 00:48:54 2014
+++ Rakefile	Mon Mar 31 09:55:34 2014
@@@@ -75,19 +75,19 @@@@ if @@pe
     @@pe_version = ENV['PE_VER'] || '3.0'
     @@java_bin = "/opt/puppet/bin/java"
 else
-    @@install_dir = "/usr/share/puppetdb"
a16 1
+    @@install_dir = "${PREFIX}/share/puppetdb"
d21 3
d30 2
d33 1
a33 2
     @@name = "puppetdb"
-    @@sbin_dir = "/usr/sbin"
d38 1
a38 1
@@@@ -112,7 +112,7 @@@@ case @@osfamily
d44 2
a46 2
 
 @@heap_dump_path = "#{@@log_dir}/puppetdb-oom.hprof"
@


1.4
log
@- update to puppetdb-1.6.0
* mostly performance and bugfixes: http://docs.puppetlabs.com/puppetdb/latest/release_notes.html#section
@
text
@d1 1
a1 1
$OpenBSD: patch-Rakefile,v 1.3 2013/12/15 11:29:22 jasper Exp $
d8 3
a10 3
--- Rakefile.orig	Mon Jan  6 22:48:56 2014
+++ Rakefile	Sun Jan 12 11:02:23 2014
@@@@ -57,19 +57,19 @@@@ if @@pe
d36 1
a36 1
@@@@ -94,7 +94,7 @@@@ case @@osfamily
@


1.3
log
@- update to puppetdb-1.5.2
@
text
@d1 1
a1 1
$OpenBSD: patch-Rakefile,v 1.2 2013/07/02 14:43:04 jasper Exp $
d8 3
a10 3
--- Rakefile.orig	Sun Dec 15 11:51:56 2013
+++ Rakefile	Sun Dec 15 11:52:45 2013
@@@@ -54,13 +54,13 @@@@ if @@pe
d18 1
a18 2
-    @@link = "/usr/share/puppetdb"
+    @@install_dir = "share/puppetdb"
d21 8
a28 1
+    @@lib_dir = "/var/db/puppetdb"
d36 1
a36 1
@@@@ -86,7 +86,7 @@@@ case @@osfamily
@


1.2
log
@sync with what's been pushed upstream; no pkg change.
@
text
@d1 1
a1 1
$OpenBSD: patch-Rakefile,v 1.1.1.1 2013/06/28 09:13:09 jasper Exp $
a2 1
- Remove unsupported ln(1) option: -T.
d8 3
a10 16
--- Rakefile.orig	Mon Jun  3 19:12:39 2013
+++ Rakefile	Tue Jul  2 16:41:54 2013
@@@@ -9,8 +9,10 @@@@ RAKE_ROOT = File.dirname(__FILE__)
 # Load tasks and variables for packaging automation
 Dir[ File.join(RAKE_ROOT, 'ext', 'packaging', 'tasks', '*.rake') ].sort.each { |t| load t }
 
-def ln_sfT(src, dest)
-  sh "ln -sfT #{src} #{dest}"
+def ln_sf(src, dest)
+  if !File.exist?(dest)
+    sh "ln -sf #{src} #{dest}"
+  end
 end
 
 def cp_pr(src, dest, options={})
@@@@ -51,15 +53,15 @@@@ if @@pe
d17 2
a21 4
     @@initscriptname = "/etc/init.d/puppetdb"
     @@log_dir = "/var/log/puppetdb"
-    @@lib_dir = "/var/lib/puppetdb"
-    @@link = "/usr/share/puppetdb"
d29 2
a30 3
 # We only need the ruby major, minor versions
@@@@ -82,6 +84,8 @@@@ case @@osfamily
     @@plibdir = @@pe ? PE_SITELIBDIR : ( @@ruby_version == '1.8' ? '/usr/lib/ruby/site_ruby/1.8' : '/usr/share/ruby/vendor_ruby' )
d32 3
a34 2
     @@plibdir = @@pe ? PE_SITELIBDIR : nil
+  when /openbsd/
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
$OpenBSD$
d10 3
a12 2
+++ Rakefile	Fri Jun 28 10:26:46 2013
@@@@ -10,7 +10,7 @@@@ RAKE_ROOT = File.dirname(__FILE__)
d15 1
a15 1
 def ln_sfT(src, dest)
d17 4
a20 1
+  sh "ln -sf #{src} #{dest}"
d24 1
a24 1
@@@@ -51,15 +51,15 @@@@ if @@pe
d46 1
a46 1
@@@@ -82,6 +82,8 @@@@ case @@osfamily
@


1.1.1.1
log
@import puppetdb 1.3.2

PuppetDB is the fast, scalable, and reliable data warehouse for Puppet.
It caches data generated by Puppet, and gives you advanced features at
awesome speed with a powerful API.

ok aja@@
@
text
@@
