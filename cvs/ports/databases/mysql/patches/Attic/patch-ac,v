head	1.9;
access;
symbols
	OPENBSD_2_8:1.8.0.2
	OPENBSD_2_8_BASE:1.8
	OPENBSD_2_7:1.5.0.2
	OPENBSD_2_7_BASE:1.5
	OPENBSD_2_6:1.2.0.2
	OPENBSD_2_6_BASE:1.2
	OPENBSD_2_5:1.1.1.1.0.2
	OPENBSD_2_5_BASE:1.1.1.1
	marc_1999-Mar-29:1.1.1.1
	marc:1.1.1;
locks; strict;
comment	@# @;


1.9
date	2001.01.21.17.09.13;	author brad;	state dead;
branches;
next	1.8;

1.8
date	2000.11.03.00.54.09;	author espie;	state Exp;
branches;
next	1.7;

1.7
date	2000.11.02.15.15.25;	author espie;	state Exp;
branches;
next	1.6;

1.6
date	2000.11.02.14.42.44;	author brad;	state Exp;
branches;
next	1.5;

1.5
date	2000.01.04.17.39.43;	author brad;	state Exp;
branches;
next	1.4;

1.4
date	2000.01.01.05.54.13;	author brad;	state Exp;
branches;
next	1.3;

1.3
date	99.12.02.03.41.01;	author brad;	state dead;
branches;
next	1.2;

1.2
date	99.10.04.03.18.31;	author brad;	state Exp;
branches;
next	1.1;

1.1
date	99.03.30.06.42.47;	author marc;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	99.03.30.06.42.47;	author marc;	state Exp;
branches;
next	;


desc
@@


1.9
log
@upgrade to MySQL 3.23.31
@
text
@--- scripts/mysql_install_db.sh.orig	Wed Jan 12 15:06:30 2000
+++ scripts/mysql_install_db.sh	Thu Nov  2 09:11:00 2000
@@@@ -15,10 +15,6 @@@@
 force=0
 IN_RPM=0
 
-# Are we doing an rpm install?
-if test "$1" = "-IN-RPM"; then IN_RPM=1; shift; fi
-if test "$1" = "--force"; then force=1; shift; fi
-
 # Get mysqld/safe_mysqld options from /etc/my.cnf or ~/.my.cnf
 if test -w /
 then
@@@@ -49,20 +45,12 @@@@
 
 if test ! -x $execdir/mysqld
 then
-  if test "$IN_RPM" -eq 1
-  then
-    echo "FATAL ERROR $execdir/mysqld not found!"
-    exit 1
-  else
     echo "Didn't find $execdir/mysqld"
     echo "You should do a 'make install' before executing this script"
     exit 1
-  fi
 fi
 
-# On IRIX hostname is in /usr/bsd so add this to the path
-PATH=$PATH:/usr/bsd
-hostname=`hostname`		# Install this too in the user table
+hostname=`hostname -s`		# Install this too in the user table
 
 # Check if hostname is valid
 if test "$IN_RPM" -eq 0 -a $force -eq 0
@@@@ -89,7 +77,7 @@@@
 # Create database directories mysql & test
 if test "$IN_RPM" -eq 0
 then
-  if test ! -d $ldata; then mkdir $ldata; chmod 700 $ldata ; fi
+  if test ! -d $ldata; then mkdir $ldata; chmod 711 $ldata ; fi
   if test ! -d $ldata/mysql; then mkdir $ldata/mysql;  chmod 700 $ldata/mysql ; fi
   if test ! -d $ldata/test; then mkdir $ldata/test;  chmod 700 $ldata/test ; fi
   if test -w / -a ! -z "$user"; then
@@@@ -255,12 +243,6 @@@@
 END_OF_DATA
 then
   echo ""
-  if test "$IN_RPM" -eq 0
-  then
-    echo "To start mysqld at boot time you have to copy support-files/mysql.server"
-    echo "to the right place for your system"
-    echo
-  fi
   echo "PLEASE REMEMBER TO SET A PASSWORD FOR THE MySQL root USER !"
   echo "This is done with:"
   echo "$bindir/mysqladmin -u root password 'new-password'"
@


1.8
log
@commit mysql fix, now that I've had time to look at it
@
text
@@


1.7
log
@Ports is locked.
Revert unauthorized commit, until I have a chance to look at it.
@
text
@d1 2
a2 2
--- scripts/mysql_install_db.sh.orig	Sun Sep 19 07:16:46 1999
+++ scripts/mysql_install_db.sh	Mon Jan  3 14:23:05 2000
d36 9
@


1.6
log
@fix initial permissions on the database directory, they were a little too tight for the client apps to be able to read DB_DIR/mysql.sock.
@
text
@d1 2
a2 2
--- scripts/mysql_install_db.sh.orig	Wed Jan 12 15:06:30 2000
+++ scripts/mysql_install_db.sh	Thu Nov  2 09:11:00 2000
a35 9
@@@@ -89,7 +77,7 @@@@
 # Create database directories mysql & test
 if test "$IN_RPM" -eq 0
 then
-  if test ! -d $ldata; then mkdir $ldata; chmod 700 $ldata ; fi
+  if test ! -d $ldata; then mkdir $ldata; chmod 711 $ldata ; fi
   if test ! -d $ldata/mysql; then mkdir $ldata/mysql;  chmod 700 $ldata/mysql ; fi
   if test ! -d $ldata/test; then mkdir $ldata/test;  chmod 700 $ldata/test ; fi
   if test -w / -a ! -z "$user"; then
@


1.5
log
@- forgot to run the INSTALL script again for the post-install target
- fix mysql_install_db to pickup the hostname that's used while creating
the database
- add a missing brace for DB_DIR in INSTALL script
- run mysql_install_db as user mysql to make sure the database has proper
file permissions
--
Reported by: Peter Strömberg <peter.stromberg@@commentor.se>
@
text
@d1 2
a2 2
--- scripts/mysql_install_db.sh.orig	Sun Sep 19 07:16:46 1999
+++ scripts/mysql_install_db.sh	Mon Jan  3 14:23:05 2000
d36 9
@


1.4
log
@- upgrade to MySQL 3.22.27
- make the default database directory a bit easier to change with the
DB_DIR variable
- add warning about possible virtual memory limit exhaustion
- change default database directory to /var/mysql and chown it to the
user:group
- integrate check_old_version script into Makefile
- we should be able to make this into a full package now, though not
tested fully
- install user:group of mysql and make MySQL load as user mysql

Reviewed and tested by: ericj@@
@
text
@d1 2
a2 2
--- scripts/mysql_install_db.sh.orig	Sun Dec 19 01:16:27 1999
+++ scripts/mysql_install_db.sh	Sun Dec 19 01:33:38 1999
d14 1
a14 1
@@@@ -49,21 +45,11 @@@@
d32 2
a33 1
-
d36 1
a36 2
 then
@@@@ -255,12 +241,6 @@@@
@


1.3
log
@- remove unnecessary mit-pthreads patches
- don't disable inlining
- add a workaround patch for GCC 2.95.x which compiles sql_yacc.cc with -O0
@
text
@d1 21
a21 8
--- mit-pthreads/config/configure.orig	Mon Jun  7 06:34:01 1999
+++ mit-pthreads/config/configure	Wed Sep 15 15:25:29 1999
@@@@ -692,10 +692,6 @@@@
 echo "$ac_t""$ac_cv_prog_cc_g" 1>&6
   if test "$ac_test_CFLAGS" = set; then
     CFLAGS="$ac_save_CFLAGS"
-  elif test $ac_cv_prog_cc_g = yes; then
-    CFLAGS="-g -O2"
d23 26
a48 4
-    CFLAGS="-O2"
   fi
 else
   GCC=
@


1.2
log
@remove FreeBSD specific patches
@
text
@@


1.1
log
@Initial revision
@
text
@d1 2
a2 2
--- mit-pthreads/config/configure.orig	Tue Mar 10 10:11:25 1998
+++ mit-pthreads/config/configure	Thu Feb  4 23:02:41 1999
a13 9
@@@@ -1280,7 +1276,7 @@@@
     m68*-*-netbsd*)
 	name=m68000-netbsd
 	;;
-    i386-*-freebsd2.*)
+    i386-*-freebsd*)
         name=i386-freebsd-2.0
         sysincludes=freebsd-2.0
         except="fork lseek ftruncate sigsuspend sigprocmask"
@


1.1.1.1
log
@mysql, from freebsd via d@@openbsd.org.  Uses egcc with -pthread
said to work on i386, not tested on any other architecture
@
text
@@
