head	1.17;
access;
symbols
	OPENBSD_5_6:1.16.0.4
	OPENBSD_5_6_BASE:1.16
	OPENBSD_5_5:1.16.0.2
	OPENBSD_5_5_BASE:1.16
	OPENBSD_5_4:1.15.0.4
	OPENBSD_5_4_BASE:1.15
	OPENBSD_5_3:1.15.0.2
	OPENBSD_5_3_BASE:1.15
	OPENBSD_5_2:1.14.0.10
	OPENBSD_5_2_BASE:1.14
	OPENBSD_5_1_BASE:1.14
	OPENBSD_5_1:1.14.0.8
	OPENBSD_5_0:1.14.0.6
	OPENBSD_5_0_BASE:1.14
	OPENBSD_4_9:1.14.0.4
	OPENBSD_4_9_BASE:1.14
	OPENBSD_4_8:1.14.0.2
	OPENBSD_4_8_BASE:1.14
	OPENBSD_4_7:1.13.0.2
	OPENBSD_4_7_BASE:1.13
	OPENBSD_4_6:1.12.0.10
	OPENBSD_4_6_BASE:1.12
	OPENBSD_4_5:1.12.0.8
	OPENBSD_4_5_BASE:1.12
	OPENBSD_4_4:1.12.0.6
	OPENBSD_4_4_BASE:1.12
	OPENBSD_4_3:1.12.0.4
	OPENBSD_4_3_BASE:1.12
	OPENBSD_4_2:1.12.0.2
	OPENBSD_4_2_BASE:1.12
	OPENBSD_4_1:1.11.0.2
	OPENBSD_4_1_BASE:1.11
	OPENBSD_4_0:1.10.0.4
	OPENBSD_4_0_BASE:1.10
	OPENBSD_3_9:1.10.0.2
	OPENBSD_3_9_BASE:1.10
	OPENBSD_3_8:1.7.0.4
	OPENBSD_3_8_BASE:1.7
	OPENBSD_3_7:1.7.0.2
	OPENBSD_3_7_BASE:1.7
	OPENBSD_3_6:1.6.0.2
	OPENBSD_3_6_BASE:1.6
	OPENBSD_3_5:1.2.0.2
	OPENBSD_3_5_BASE:1.2;
locks; strict;
comment	@# @;


1.17
date	2014.10.03.10.54.55;	author brad;	state dead;
branches;
next	1.16;
commitid	l38yfxK2clf7O9UX;

1.16
date	2013.09.04.19.17.00;	author brad;	state Exp;
branches;
next	1.15;

1.15
date	2012.12.28.02.03.58;	author brad;	state Exp;
branches;
next	1.14;

1.14
date	2010.05.24.20.40.41;	author sthen;	state Exp;
branches
	1.14.10.1;
next	1.13;

1.13
date	2009.07.27.15.19.15;	author sthen;	state Exp;
branches
	1.13.2.1;
next	1.12;

1.12
date	2007.04.09.22.43.06;	author ckuethe;	state Exp;
branches
	1.12.10.1;
next	1.11;

1.11
date	2006.10.14.05.04.54;	author brad;	state Exp;
branches;
next	1.10;

1.10
date	2006.01.06.00.13.26;	author brad;	state Exp;
branches;
next	1.9;

1.9
date	2005.10.07.22.48.12;	author brad;	state Exp;
branches;
next	1.8;

1.8
date	2005.09.04.22.51.24;	author brad;	state Exp;
branches;
next	1.7;

1.7
date	2005.01.14.01.42.58;	author brad;	state Exp;
branches;
next	1.6;

1.6
date	2004.05.24.22.40.28;	author brad;	state Exp;
branches;
next	1.5;

1.5
date	2004.05.21.12.16.21;	author brad;	state Exp;
branches;
next	1.4;

1.4
date	2004.05.16.09.01.16;	author brad;	state Exp;
branches;
next	1.3;

1.3
date	2004.05.16.04.30.39;	author brad;	state Exp;
branches;
next	1.2;

1.2
date	2004.02.22.01.20.11;	author brad;	state Exp;
branches;
next	1.1;

1.1
date	2003.12.30.05.58.51;	author brad;	state Exp;
branches;
next	;

1.12.10.1
date	2009.11.07.18.04.19;	author william;	state Exp;
branches;
next	;

1.13.2.1
date	2010.05.29.01.06.16;	author william;	state Exp;
branches;
next	;

1.14.10.1
date	2013.01.05.03.04.45;	author brad;	state Exp;
branches;
next	;


desc
@@


1.17
log
@So long and into the Attic you go.

ok sthen@@
@
text
@$OpenBSD: patch-scripts_mysqld_safe_sh,v 1.16 2013/09/04 19:17:00 brad Exp $
--- scripts/mysqld_safe.sh.orig	Thu Jul 11 09:39:36 2013
+++ scripts/mysqld_safe.sh	Tue Sep  3 19:39:35 2013
@@@@ -18,7 +18,8 @@@@ niceness=0
 logging=init
 want_syslog=0
 syslog_tag=
-user='@@MYSQLD_USER@@'
+user='_mysql'
+group='_mysql'
 pid_file=
 err_log=
 
@@@@ -439,8 +440,8 @@@@ mysql_unix_port_dir=`dirname $safe_mysql_unix_port`
 if [ ! -d $mysql_unix_port_dir ]
 then
   mkdir $mysql_unix_port_dir
-  chown $user $mysql_unix_port_dir
-  chmod 755 $mysql_unix_port_dir
+  chown $user:$group $mysql_unix_port_dir
+  chmod 711 $mysql_unix_port_dir
 fi
 
 # If the user doesn't specify a binary, we assume name "mysqld"
@


1.16
log
@- Remove some unnecessary patching
- Mention the rc script in mysql_install_db
- Move the removal of the plugins subdir to the correct PLIST

ok sthen@@
@
text
@d1 1
a1 1
$OpenBSD: patch-scripts_mysqld_safe_sh,v 1.15 2012/12/28 02:03:58 brad Exp $
@


1.15
log
@Update to MySQL 5.1.67.

ok giovanni@@
@
text
@d1 3
a3 3
$OpenBSD: patch-scripts_mysqld_safe_sh,v 1.14 2010/05/24 20:40:41 sthen Exp $
--- scripts/mysqld_safe.sh.orig	Thu Dec 13 05:05:51 2012
+++ scripts/mysqld_safe.sh	Tue Dec 25 02:04:51 2012
a24 36
@@@@ -610,35 +611,6 @@@@ do
     break
   fi
 
-  if @@TARGET_LINUX@@ && test $KILL_MYSQLD -eq 1
-  then
-    # Test if one process was hanging.
-    # This is only a fix for Linux (running as base 3 mysqld processes)
-    # but should work for the rest of the servers.
-    # The only thing is ps x => redhat 5 gives warnings when using ps -x.
-    # kill -9 is used or the process won't react on the kill.
-    numofproces=`ps xaww | grep -v "grep" | grep "$ledir/$MYSQLD\>" | grep -c "pid-file=$pid_file"`
-
-    log_notice "Number of processes running now: $numofproces"
-    I=1
-    while test "$I" -le "$numofproces"
-    do 
-      PROC=`ps xaww | grep "$ledir/$MYSQLD\>" | grep -v "grep" | grep "pid-file=$pid_file" | sed -n '$p'` 
-
-      for T in $PROC
-      do
-        break
-      done
-      #    echo "TEST $I - $T **"
-      if kill -9 $T
-      then
-        log_error "$MYSQLD process hanging, pid $T - killed"
-      else
-        break
-      fi
-      I=`expr $I + 1`
-    done
-  fi
   log_notice "mysqld restarted"
 done
 
@


1.14
log
@Update MySQL to 5.1.47. This is a security update - for more details, see
http://dev.mysql.com/doc/refman/5.1/en/news-5-1-47.html
@
text
@d1 3
a3 3
$OpenBSD: patch-scripts_mysqld_safe_sh,v 1.13 2009/07/27 15:19:15 sthen Exp $
--- scripts/mysqld_safe.sh.orig	Thu May  6 11:26:32 2010
+++ scripts/mysqld_safe.sh	Thu May 20 20:22:17 2010
d14 1
a14 1
@@@@ -412,8 +413,8 @@@@ mysql_unix_port_dir=`dirname $safe_mysql_unix_port`
d25 1
a25 1
@@@@ -577,35 +578,6 @@@@ do
@


1.14.10.1
log
@MFC:

Update to MySQL 5.1.67.

ok jasper@@ sthen@@
@
text
@d1 3
a3 3
$OpenBSD: patch-scripts_mysqld_safe_sh,v 1.15 2012/12/28 02:03:58 brad Exp $
--- scripts/mysqld_safe.sh.orig	Thu Dec 13 05:05:51 2012
+++ scripts/mysqld_safe.sh	Tue Dec 25 02:04:51 2012
d14 1
a14 1
@@@@ -439,8 +440,8 @@@@ mysql_unix_port_dir=`dirname $safe_mysql_unix_port`
d25 1
a25 1
@@@@ -610,35 +611,6 @@@@ do
@


1.13
log
@Update MySQL to 5.1.33; from Brad.

Tested by giovanni@@ on amd64 and several ports@@ readers.
No problems found with a complete bulk build.
@
text
@d1 3
a3 3
$OpenBSD: patch-scripts_mysqld_safe_sh,v 1.12 2007/04/09 22:43:06 ckuethe Exp $
--- scripts/mysqld_safe.sh.orig	Tue Mar 31 10:38:52 2009
+++ scripts/mysqld_safe.sh	Wed May  6 04:27:09 2009
d14 1
a14 1
@@@@ -407,8 +408,8 @@@@ mysql_unix_port_dir=`dirname $safe_mysql_unix_port`
d25 1
a25 1
@@@@ -572,35 +573,6 @@@@ do
@


1.13.2.1
log
@MFC:

SECURITY UPDATE to mysql-5.1.47

http://dev.mysql.com/doc/refman/5.1/en/news-5-1-47.html

from Brad
@
text
@d1 3
a3 3
$OpenBSD: patch-scripts_mysqld_safe_sh,v 1.13 2009/07/27 15:19:15 sthen Exp $
--- scripts/mysqld_safe.sh.orig	Thu May  6 11:26:32 2010
+++ scripts/mysqld_safe.sh	Thu May 20 20:22:17 2010
d14 1
a14 1
@@@@ -412,8 +413,8 @@@@ mysql_unix_port_dir=`dirname $safe_mysql_unix_port`
d25 1
a25 1
@@@@ -577,35 +578,6 @@@@ do
@


1.12
log
@Update to MySQL 5.0.37, from Frank Denis and Brad Smith
ok $MAINTAINER, robert
@
text
@d1 12
a12 5
$OpenBSD: patch-scripts_mysqld_safe_sh,v 1.11 2006/10/14 05:04:54 brad Exp $
--- scripts/mysqld_safe.sh.orig	Mon Mar  5 20:21:13 2007
+++ scripts/mysqld_safe.sh	Sat Mar 31 19:02:39 2007
@@@@ -107,72 +107,12 @@@@ parse_arguments() {
 }
d14 1
a14 76
 
-#
-# First, try to find BASEDIR and ledir (where mysqld is)
-# 
+MY_BASEDIR_VERSION=@@prefix@@
+ledir=@@libexecdir@@
+DATADIR=@@localstatedir@@
 
-MY_PWD=`pwd`
-# Check for the directories we would expect from a binary release install
-if test -f ./share/mysql/english/errmsg.sys -a -x ./bin/mysqld
-then
-  MY_BASEDIR_VERSION=$MY_PWD		# Where bin, share and data are
-  ledir=$MY_BASEDIR_VERSION/bin		# Where mysqld is
-# Check for the directories we would expect from a source install
-elif test -f ./share/mysql/english/errmsg.sys -a \
- -x ./libexec/mysqld
-then
-  MY_BASEDIR_VERSION=$MY_PWD		# Where libexec, share and var are
-  ledir=$MY_BASEDIR_VERSION/libexec	# Where mysqld is
-# Since we didn't find anything, used the compiled-in defaults
-else
-  MY_BASEDIR_VERSION=@@prefix@@
-  ledir=@@libexecdir@@
-fi
-
-#
-# Second, try to find the data directory
-#
-
-# Try where the binary installs put it
-if test -d $MY_BASEDIR_VERSION/data/mysql
-then
-  DATADIR=$MY_BASEDIR_VERSION/data
-  if test -z "$defaults" -a -r "$DATADIR/my.cnf"
-  then
-    defaults="--defaults-extra-file=$DATADIR/my.cnf"
-  fi
-# Next try where the source installs put it
-elif test -d $MY_BASEDIR_VERSION/var/mysql
-then
-  DATADIR=$MY_BASEDIR_VERSION/var
-# Or just give up and use our compiled-in default
-else
-  DATADIR=@@localstatedir@@
-fi
-
-if test -z "$MYSQL_HOME"
-then 
-  if test -r "$MY_BASEDIR_VERSION/my.cnf" && test -r "$DATADIR/my.cnf"
-  then
-    echo "WARNING: Found two instances of my.cnf -"
-    echo "$MY_BASEDIR_VERSION/my.cnf and"
-    echo "$DATADIR/my.cnf"
-    echo "IGNORING $DATADIR/my.cnf"
-    echo
-    MYSQL_HOME=$MY_BASEDIR_VERSION
-  elif test -r "$DATADIR/my.cnf"
-  then
-    echo "WARNING: Found $DATADIR/my.cnf"
-    echo "Datadir is deprecated place for my.cnf, please move it to $MY_BASEDIR_VERSION"
-    echo
-    MYSQL_HOME=$DATADIR
-  else
-    MYSQL_HOME=$MY_BASEDIR_VERSION
-  fi
-fi
-export MYSQL_HOME
-
-user=@@MYSQLD_USER@@
+user=_mysql
+group=_mysql
 niceness=0
 
 # these rely on $DATADIR by default, so we'll set them later on
@@@@ -210,8 +150,8 @@@@ mysql_unix_port_dir=`dirname $safe_mysql_unix_port`
d24 2
a25 15
 # Use the mysqld-max binary by default if the user doesn't specify a binary
@@@@ -371,12 +311,6 @@@@ fi
 
 echo "Starting $MYSQLD daemon with databases from $DATADIR"
 
-# Does this work on all systems?
-#if type ulimit | grep "shell builtin" > /dev/null
-#then
-#  ulimit -n 256 > /dev/null 2>&1		# Fix for BSD and FreeBSD systems
-#fi
-
 echo "`date +'%y%m%d %H:%M:%S  mysqld started'`" >> $err_log
 while true
 do
@@@@ -393,35 +327,6 @@@@ do
d38 1
a38 1
-    echo -e "\nNumber of processes running now: $numofproces" | tee -a $err_log
d51 2
a52 2
-        echo "$MYSQLD process hanging, pid $T - killed" | tee -a $err_log
-      else 
d58 1
a58 1
   echo "`date +'%y%m%d %H:%M:%S'`  mysqld restarted" | tee -a $err_log
@


1.12.10.1
log
@SECURITY and bugfix update to mysql-5.0.87

From ian@@, tweaked by Brad... thanks!

ok Brad jasper@@
@
text
@d1 4
a4 4
$OpenBSD: patch-scripts_mysqld_safe_sh,v 1.12 2007/04/09 22:43:06 ckuethe Exp $
--- scripts/mysqld_safe.sh.orig	Thu Sep 10 05:04:45 2009
+++ scripts/mysqld_safe.sh	Mon Oct 12 12:20:22 2009
@@@@ -107,83 +107,13 @@@@ parse_arguments() {
d17 1
a17 12
-if test -n "$MY_BASEDIR_VERSION" -a -d "$MY_BASEDIR_VERSION"
-then
-  # BASEDIR is already overridden on command line.  Do not re-set.
 
-  # Use BASEDIR to discover le.
-  if test -x "$MY_BASEDIR_VERSION/libexec/mysqld"
-  then
-    ledir="$MY_BASEDIR_VERSION/libexec"
-  else
-    ledir="$MY_BASEDIR_VERSION/bin"
-  fi
-elif test -f ./share/mysql/english/errmsg.sys -a -x "$MY_PWD/bin/mysqld"
a20 1
-  ledir="$MY_PWD/bin"			# Where mysqld is
d22 2
a23 1
-elif test -f ./share/mysql/english/errmsg.sys -a -x "$MY_PWD/libexec/mysqld"
d26 1
a26 1
-  ledir="$MY_PWD/libexec"		# Where mysqld is
d82 1
a82 1
@@@@ -224,8 +154,8 @@@@ mysql_unix_port_dir=`dirname $safe_mysql_unix_port`
d93 1
a93 1
@@@@ -385,12 +315,6 @@@@ fi
d106 1
a106 1
@@@@ -407,35 +331,6 @@@@ do
@


1.11
log
@upgrade to MySQL 5.0.26
@
text
@d1 3
a3 3
$OpenBSD: patch-scripts_mysqld_safe_sh,v 1.10 2006/01/06 00:13:26 brad Exp $
--- scripts/mysqld_safe.sh.orig	Wed Oct  4 07:24:11 2006
+++ scripts/mysqld_safe.sh	Thu Oct 12 05:18:57 2006
d82 1
a82 1
@@@@ -210,7 +150,8 @@@@ mysql_unix_port_dir=`dirname $safe_mysql
d87 1
d93 1
a93 1
@@@@ -370,12 +311,6 @@@@ fi
d106 1
a106 1
@@@@ -392,35 +327,6 @@@@ do
@


1.10
log
@upgrade to MySQL 5.0.18
@
text
@d1 3
a3 3
$OpenBSD: patch-scripts_mysqld_safe_sh,v 1.9 2005/10/07 22:48:12 brad Exp $
--- scripts/mysqld_safe.sh.orig	Wed Dec 14 18:33:33 2005
+++ scripts/mysqld_safe.sh	Sun Dec 18 17:36:00 2005
d92 1
a92 1
@@@@ -367,12 +308,6 @@@@ fi
d105 1
a105 1
@@@@ -389,35 +324,6 @@@@ do
@


1.9
log
@fix creation of socket dir.

From: kevlo@@
@
text
@d1 4
a4 4
$OpenBSD$
--- scripts/mysqld_safe.sh.orig	Wed Aug 17 17:06:29 2005
+++ scripts/mysqld_safe.sh	Fri Oct  7 15:51:03 2005
@@@@ -84,50 +84,12 @@@@ parse_arguments() {
d41 1
a41 1
-  if test -z "$defaults"
d54 22
d81 2
a82 2
 # Use the mysqld-max binary by default if the user doesn't specify a binary
@@@@ -173,7 +135,8 @@@@ mysql_unix_port_dir=`dirname $safe_mysql
d91 2
a92 2
 
@@@@ -320,12 +283,6 @@@@ fi
d105 1
a105 1
@@@@ -342,35 +299,6 @@@@ do
@


1.8
log
@upgrade to MySQL 4.1.14
@
text
@d2 2
a3 2
--- scripts/mysqld_safe.sh.orig	Wed Aug 17 13:06:29 2005
+++ scripts/mysqld_safe.sh	Sun Sep  4 13:36:37 2005
d60 11
a70 9
@@@@ -167,6 +129,7 @@@@ fi
 parse_arguments `$print_defaults $defaults --loose-verbose mysqld_safe safe_mysqld`
 parse_arguments PICK-ARGS-FROM-ARGV "$@@"
 safe_mysql_unix_port=${mysql_unix_port:-${MYSQL_UNIX_PORT:-@@MYSQL_UNIX_ADDR@@}}
+socket_dir=`dirname $safe_mysql_unix_port`
 
 # Make sure that directory for $safe_mysql_unix_port exists
 mysql_unix_port_dir=`dirname $safe_mysql_unix_port`
@@@@ -320,11 +283,12 @@@@ fi
d79 1
a79 7
+if test ! -d $socket_dir
+then
+   mkdir -p $socket_dir
+   chown $user:$group $socket_dir
+   chmod 711 $socket_dir
+fi
 
d82 2
a83 1
@@@@ -342,35 +306,6 @@@@ do
@


1.7
log
@upgrade to MySQL 4.0.23

fixes some crashing issues among many other bug fixes,
seems to have resolved a crashing issue henning@@ was
experiencing on sparc64.
@
text
@d1 4
a4 4
$OpenBSD: patch-scripts_mysqld_safe_sh,v 1.6 2004/05/24 22:40:28 brad Exp $
--- scripts/mysqld_safe.sh.orig	Sat Dec 18 12:25:05 2004
+++ scripts/mysqld_safe.sh	Wed Dec 22 11:01:01 2004
@@@@ -84,32 +84,12 @@@@ parse_arguments() {
d8 7
d16 2
a17 3
-# Check if we are starting this relative (for the binary release)
-if test -d $MY_PWD/data/mysql -a -f ./share/mysql/english/errmsg.sys -a \
- -x ./bin/mysqld
d21 19
d43 1
a43 1
-    defaults="--defaults-extra-file=$MY_BASEDIR_VERSION/data/my.cnf"
d45 2
a46 3
-# Check if this is a 'moved install directory'
-elif test -f ./var/mysql/db.frm -a -f ./share/mysql/english/errmsg.sys -a \
- -x ./libexec/mysqld
a47 2
-  MY_BASEDIR_VERSION=$MY_PWD		# Where libexec, share and var are
-  ledir=$MY_BASEDIR_VERSION/libexec	# Where mysqld is
d49 1
a50 1
-  MY_BASEDIR_VERSION=@@prefix@@
a51 1
-  ledir=@@libexecdir@@
d53 1
a53 4
+MY_BASEDIR_VERSION=@@prefix@@
+ledir=@@libexecdir@@
+DATADIR=@@localstatedir@@
 
d60 2
a61 2
@@@@ -149,6 +129,7 @@@@ fi
 parse_arguments `$print_defaults --loose-verbose $defaults mysqld_safe safe_mysqld`
d66 3
a68 3
 if test ! -x $ledir/$MYSQLD
 then
@@@@ -293,11 +274,12 @@@@ fi
d86 1
a86 1
@@@@ -315,35 +297,6 @@@@ do
d90 1
a90 1
-  if @@IS_LINUX@@ && test $KILL_MYSQLD -eq 1
d97 1
a97 1
-    numofproces=`ps xa | grep -v "grep" | grep "$ledir/$MYSQLD\>" | grep -c "pid-file=$pid_file"`
d103 1
a103 1
-      PROC=`ps xa | grep "$ledir/$MYSQLD\>" | grep -v "grep" | grep "pid-file=$pid_file" | sed -n '$p'` 
@


1.6
log
@remove extra ulimit setting
@
text
@d1 4
a4 4
$OpenBSD: patch-scripts_mysqld_safe_sh,v 1.5 2004/05/21 12:16:21 brad Exp $
--- scripts/mysqld_safe.sh.orig	2004-05-13 20:53:19.000000000 -0400
+++ scripts/mysqld_safe.sh	2004-05-24 18:35:56.000000000 -0400
@@@@ -90,32 +90,12 @@@@ parse_arguments() {
d42 1
a42 1
@@@@ -155,6 +135,7 @@@@ fi
d50 1
a50 1
@@@@ -299,11 +280,12 @@@@ fi
d68 1
a68 1
@@@@ -320,33 +302,6 @@@@ do
d72 1
a72 1
-  if test @@IS_LINUX@@ -a $KILL_MYSQLD -eq 1
d79 2
a80 1
-    numofproces=`ps xa | grep -v "grep" | grep -c $ledir/$MYSQLD`
d85 14
a98 13
-      PROC=`ps xa | grep $ledir/$MYSQLD | grep -v "grep" | sed -n '$p'` 
-	for T in $PROC
-	do
-	  break
-	done
-	#    echo "TEST $I - $T **"
-	if kill -9 $T
-	then
-	  echo "$MYSQLD process hanging, pid $T - killed" | tee -a $err_log
-	else 
-	  break
-	fi
-	I=`expr $I + 1`
@


1.5
log
@upgrade to MySQL 4.0.20
@
text
@d1 1
a1 1
$OpenBSD: patch-scripts_mysqld_safe_sh,v 1.4 2004/05/16 09:01:16 brad Exp $
d3 1
a3 1
+++ scripts/mysqld_safe.sh	2004-05-18 16:28:36.000000000 -0400
d50 2
a51 1
@@@@ -300,10 +281,17 @@@@ fi
d54 1
a54 1
 # Does this work on all systems?
a58 5
+if type ulimit | grep "shell builtin" > /dev/null
+then
+  ulimit -n 256 > /dev/null 2>&1		# Fix for BSD and FreeBSD systems
+fi
+
d68 1
a68 1
@@@@ -320,33 +308,6 @@@@ do
@


1.4
log
@revert back to 4.0.18

for details http://dev.mysql.com/doc/mysql/en/News-4.0.19.html

thanks to Frank Denis for pointing this out to me.
@
text
@d1 3
a3 3
$OpenBSD: patch-scripts_mysqld_safe_sh,v 1.2 2004/02/22 01:20:11 brad Exp $
--- scripts/mysqld_safe.sh.orig	2004-02-10 13:15:48.000000000 -0500
+++ scripts/mysqld_safe.sh	2004-02-12 21:33:38.000000000 -0500
d50 1
a50 1
@@@@ -298,10 +279,17 @@@@ fi
d72 1
a72 1
@@@@ -318,33 +306,6 @@@@ do
@


1.3
log
@upgrade to MySQL 4.0.19
@
text
@d2 2
a3 2
--- scripts/mysqld_safe.sh.orig	2004-05-03 17:10:24.000000000 -0400
+++ scripts/mysqld_safe.sh	2004-05-14 00:02:13.000000000 -0400
d50 1
a50 1
@@@@ -300,10 +281,17 @@@@ fi
d72 1
a72 1
@@@@ -320,33 +308,6 @@@@ do
@


1.2
log
@upgrade to MySQL 4.0.18
@
text
@d1 3
a3 3
$OpenBSD: patch-scripts_mysqld_safe_sh,v 1.1 2003/12/30 05:58:51 brad Exp $
--- scripts/mysqld_safe.sh.orig	2004-02-10 13:15:48.000000000 -0500
+++ scripts/mysqld_safe.sh	2004-02-12 21:33:38.000000000 -0500
d50 1
a50 1
@@@@ -298,10 +279,17 @@@@ fi
d72 1
a72 1
@@@@ -318,33 +306,6 @@@@ do
@


1.1
log
@missed this one.
@
text
@d1 4
a4 4
$OpenBSD$
--- scripts/mysqld_safe.sh.orig	2003-12-14 16:23:47.000000000 -0500
+++ scripts/mysqld_safe.sh	2003-12-21 18:51:10.000000000 -0500
@@@@ -89,33 +89,15 @@@@ parse_arguments() {
a35 1
 safe_mysql_unix_port=${mysql_unix_port:-${MYSQL_UNIX_PORT:-@@MYSQL_UNIX_ADDR@@}}
a38 2
+
+socket_dir=`dirname $safe_mysql_unix_port`
d42 9
a50 1
@@@@ -292,10 +274,17 @@@@ fi
d72 1
a72 1
@@@@ -312,33 +301,6 @@@@ do
@

