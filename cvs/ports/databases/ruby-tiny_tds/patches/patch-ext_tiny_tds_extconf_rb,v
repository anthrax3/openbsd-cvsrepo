head	1.4;
access;
symbols
	OPENBSD_6_0:1.4.0.2
	OPENBSD_6_0_BASE:1.4
	OPENBSD_5_9:1.3.0.2
	OPENBSD_5_9_BASE:1.3
	OPENBSD_5_2:1.1.0.6
	OPENBSD_5_2_BASE:1.1
	OPENBSD_5_1_BASE:1.1
	OPENBSD_5_1:1.1.0.4
	OPENBSD_5_0:1.1.0.2
	OPENBSD_5_0_BASE:1.1;
locks; strict;
comment	@# @;


1.4
date	2016.05.05.22.45.39;	author jeremy;	state Exp;
branches;
next	1.3;
commitid	YbOzb6sAos3MUZl5;

1.3
date	2015.09.05.14.49.32;	author jeremy;	state Exp;
branches;
next	1.2;
commitid	EILQiCV7curZTUdc;

1.2
date	2013.01.29.22.44.05;	author jeremy;	state dead;
branches;
next	1.1;

1.1
date	2011.04.15.16.13.23;	author ajacoutot;	state Exp;
branches;
next	;


desc
@@


1.4
log
@Update to tiny_tds 1.0.2
@
text
@$OpenBSD$

Don't require mini_portile to build.

--- ext/tiny_tds/extconf.rb.orig	Sun May  1 15:43:50 2016
+++ ext/tiny_tds/extconf.rb	Tue May  3 14:43:34 2016
@@@@ -7,8 +7,9 @@@@ require 'fileutils'
 
 # The gem version constraint in the gemspec is not respected at install time.
 # Keep this version in sync with the one in the gemspec !
-gem 'mini_portile2', '~> 2.0'
-require 'mini_portile2'
+#gem 'mini_portile2', '~> 2.0'
+#require 'mini_portile2'
+require 'openssl'
 require_relative './extconsts'
 
 OpenSSL::SSL::VERIFY_PEER = OpenSSL::SSL::VERIFY_NONE
@@@@ -79,6 +80,7 @@@@ def searchable_paths_with_directories(*directories)
   end.flatten.compact
 end
 
+=begin
 class BuildRecipe < MiniPortile
   def initialize(name, version, files)
     super(name, version)
@@@@ -245,6 +247,7 @@@@ def define_freetds_recipe(host, libiconv, libssl, gnut
 
   end
 end
+=end
 
 if RbConfig::CONFIG['target_os'] =~ /mswin32|mingw32/
   lib_prefix = 'lib' unless RbConfig::CONFIG['target_os'] =~ /mingw32/
@@@@ -302,7 +305,7 @@@@ def freetds_usable?(lib_prefix)
 end
 
 # We use freetds, when available already, and fallback to compilation of ports
-system_freetds = enable_config('system-freetds', ENV['TINYTDS_SKIP_PORTS'] || freetds_usable?(lib_prefix))
+system_freetds = enable_config('system-freetds', true)
 
 # We expect to have iconv and OpenSSL available on non-Windows systems
 host = RbConfig::CONFIG["host"]
@


1.3
log
@Update to tiny_tds 0.7.0
@
text
@d5 3
a7 4
--- ext/tiny_tds/extconf.rb.orig	Sun Aug  9 11:30:35 2015
+++ ext/tiny_tds/extconf.rb	Wed Sep  2 11:13:23 2015
@@@@ -3,7 +3,7 @@@@ ENV['RC_ARCHS'] = '' if RUBY_PLATFORM =~ /darwin/
 # :stopdoc:
d9 8
a16 4
 require 'mkmf'
-require 'mini_portile'
+#require 'mini_portile'
 require 'fileutils'
d18 2
a19 2
 # If your using 0.82, you may have to make a conf file to get it to work. For example:
@@@@ -85,6 +85,7 @@@@ def searchable_paths_with_directories(*directories)
d27 2
a28 2
@@@@ -222,6 +223,7 @@@@ def define_freetds_recipe(host, libiconv, libssl)
     end
d35 1
a35 1
@@@@ -279,7 +281,7 @@@@ def freetds_usable?(lib_prefix)
@


1.2
log
@Update to tiny_tds 0.5.1.  Remove now unnecessary patches.
@
text
@d1 40
a40 14
$OpenBSD: patch-ext_tiny_tds_extconf_rb,v 1.1 2011/04/15 16:13:23 ajacoutot Exp $
--- ext/tiny_tds/extconf.rb.orig	Thu Apr 14 19:42:32 2011
+++ ext/tiny_tds/extconf.rb	Thu Apr 14 19:42:21 2011
@@@@ -27,8 +27,8 @@@@ def find_freetds_libraries_path
       message = "looking for library directory #{dir} ..."
       if File.directory?(dir)
         puts "#{message} yes"
-        if with_ldflags("#{$LDFLAGS} -L#{dir}".strip) { have_freetds_libraries?(*FREETDS_LIBRARIES) }
-          $LDFLAGS = "-L#{dir} #{$LDFLAGS}".strip
+        if with_ldflags("#{$LDFLAGS} -pthread -L#{dir}".strip) { have_freetds_libraries?(*FREETDS_LIBRARIES) }
+          $LDFLAGS = "-L#{dir} -pthread #{$LDFLAGS}".strip
           true
         else
           false
@


1.1
log
@Fix build after gnutls update.

ok jasper@@ landry@@
@
text
@d1 1
a1 1
$OpenBSD$
@

