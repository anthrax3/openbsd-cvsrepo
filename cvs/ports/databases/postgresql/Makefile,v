head	1.223;
access;
symbols
	OPENBSD_6_1:1.223.0.2
	OPENBSD_6_1_BASE:1.223
	OPENBSD_6_0:1.215.0.2
	OPENBSD_6_0_BASE:1.215
	OPENBSD_5_9:1.209.0.2
	OPENBSD_5_9_BASE:1.209
	OPENBSD_5_8:1.207.0.4
	OPENBSD_5_8_BASE:1.207
	OPENBSD_5_7:1.200.0.2
	OPENBSD_5_7_BASE:1.200
	OPENBSD_5_6:1.188.0.2
	OPENBSD_5_6_BASE:1.188
	OPENBSD_5_5:1.182.0.2
	OPENBSD_5_5_BASE:1.182
	OPENBSD_5_4:1.178.0.2
	OPENBSD_5_4_BASE:1.178
	OPENBSD_5_3:1.171.0.2
	OPENBSD_5_3_BASE:1.171
	OPENBSD_5_2:1.165.0.2
	OPENBSD_5_2_BASE:1.165
	OPENBSD_5_1_BASE:1.160
	OPENBSD_5_1:1.160.0.2
	OPENBSD_5_0:1.153.0.2
	OPENBSD_5_0_BASE:1.153
	OPENBSD_4_9:1.145.0.2
	OPENBSD_4_9_BASE:1.145
	OPENBSD_4_8:1.127.0.2
	OPENBSD_4_8_BASE:1.127
	OPENBSD_4_7:1.125.0.2
	OPENBSD_4_7_BASE:1.125
	OPENBSD_4_6:1.120.0.2
	OPENBSD_4_6_BASE:1.120
	OPENBSD_4_5:1.119.0.2
	OPENBSD_4_5_BASE:1.119
	OPENBSD_4_4:1.116.0.2
	OPENBSD_4_4_BASE:1.116
	OPENBSD_4_3:1.114.0.2
	OPENBSD_4_3_BASE:1.114
	OPENBSD_4_2:1.111.0.2
	OPENBSD_4_2_BASE:1.111
	OPENBSD_4_1:1.102.0.2
	OPENBSD_4_1_BASE:1.102
	OPENBSD_4_0:1.88.0.2
	OPENBSD_4_0_BASE:1.88
	OPENBSD_3_9:1.85.0.2
	OPENBSD_3_9_BASE:1.85
	OPENBSD_3_8:1.78.0.2
	OPENBSD_3_8_BASE:1.78
	OPENBSD_3_7:1.72.0.2
	OPENBSD_3_7_BASE:1.72
	OPENBSD_3_6:1.69.0.2
	OPENBSD_3_6_BASE:1.69
	OPENBSD_3_5:1.68.0.2
	OPENBSD_3_5_BASE:1.68
	OPENBSD_3_4:1.65.0.2
	OPENBSD_3_4_BASE:1.65
	OPENBSD_3_3:1.64.0.2
	OPENBSD_3_3_BASE:1.64
	OPENBSD_3_2:1.57.0.2
	OPENBSD_3_2_BASE:1.57
	OPENBSD_3_1:1.56.0.2
	OPENBSD_3_1_BASE:1.56
	OPENBSD_3_0:1.54.0.2
	OPENBSD_3_0_BASE:1.54
	OPENBSD_2_9_TRACKING_SWITCH:1.50
	OPENBSD_2_9:1.48.0.2
	OPENBSD_2_9_BASE:1.48
	OPENBSD_2_8:1.38.0.2
	OPENBSD_2_8_BASE:1.38
	OPENBSD_2_7:1.29.0.2
	OPENBSD_2_7_BASE:1.29
	OPENBSD_2_6:1.15.0.2
	OPENBSD_2_6_BASE:1.15
	OPENBSD_2_5:1.14.0.2
	OPENBSD_2_5_BASE:1.14
	OPENBSD_2_4:1.12.0.2
	OPENBSD_2_4_BASE:1.12
	OPENBSD_2_3:1.3.0.2
	OPENBSD_2_3_BASE:1.3;
locks; strict;
comment	@# @;


1.223
date	2017.02.10.14.07.28;	author pea;	state Exp;
branches;
next	1.222;
commitid	WWLhOWLg8O3LmquM;

1.222
date	2017.02.09.15.14.11;	author sthen;	state Exp;
branches;
next	1.221;
commitid	TFNZNNqUD3rBZOD1;

1.221
date	2016.12.26.13.56.04;	author jsg;	state Exp;
branches;
next	1.220;
commitid	5oRdQBibYGUOZjMy;

1.220
date	2016.12.21.07.43.57;	author phessler;	state Exp;
branches;
next	1.219;
commitid	i0Q24pEhaQPwr468;

1.219
date	2016.12.18.18.18.27;	author jeremy;	state Exp;
branches;
next	1.218;
commitid	OHOlIBnsGwUOgKJV;

1.218
date	2016.09.10.13.03.41;	author ajacoutot;	state Exp;
branches;
next	1.217;
commitid	4KcvAK91uGdTLejD;

1.217
date	2016.09.01.10.53.26;	author jasper;	state Exp;
branches;
next	1.216;
commitid	LdsIxWmxagN2Kq33;

1.216
date	2016.08.17.09.43.46;	author pea;	state Exp;
branches;
next	1.215;
commitid	DnLZ2tqAUQyYFenx;

1.215
date	2016.06.03.07.28.07;	author landry;	state Exp;
branches
	1.215.2.1;
next	1.214;
commitid	nLijveMUKlH0YLbq;

1.214
date	2016.05.13.17.15.55;	author pea;	state Exp;
branches;
next	1.213;
commitid	y1LiKyn3ptkC6DdE;

1.213
date	2016.05.13.14.27.48;	author pea;	state Exp;
branches;
next	1.212;
commitid	CPcwwBHUP5Zpueae;

1.212
date	2016.04.01.14.41.07;	author sthen;	state Exp;
branches;
next	1.211;
commitid	csGgLh3wB1jHiC2Y;

1.211
date	2016.04.01.13.00.18;	author pea;	state Exp;
branches;
next	1.210;
commitid	WTPKUNu7xIQ3FGAm;

1.210
date	2016.03.20.16.12.23;	author naddy;	state Exp;
branches;
next	1.209;
commitid	guiZq8cnNbVyyHzx;

1.209
date	2016.02.13.21.54.28;	author sthen;	state Exp;
branches
	1.209.2.1;
next	1.208;
commitid	PuOL68CXNBZydpca;

1.208
date	2015.11.03.09.35.31;	author pea;	state Exp;
branches;
next	1.207;
commitid	woApIedweCzGyUIz;

1.207
date	2015.08.03.07.42.30;	author kirby;	state Exp;
branches
	1.207.4.1;
next	1.206;
commitid	leKqd5zXWRuBEcQO;

1.206
date	2015.07.18.15.32.47;	author ajacoutot;	state Exp;
branches;
next	1.205;
commitid	b7tHxDyCH6AdrH57;

1.205
date	2015.06.23.07.26.21;	author bentley;	state Exp;
branches;
next	1.204;
commitid	Evg2A0BxL7Gicblj;

1.204
date	2015.06.22.07.29.42;	author pea;	state Exp;
branches;
next	1.203;
commitid	2RWq9KejUikx2XpS;

1.203
date	2015.06.01.08.23.47;	author pea;	state Exp;
branches;
next	1.202;
commitid	e36nnVhtg77MitAe;

1.202
date	2015.05.22.11.31.11;	author ajacoutot;	state Exp;
branches;
next	1.201;
commitid	2khjHXfpTaOuNVcx;

1.201
date	2015.04.17.07.59.19;	author phessler;	state Exp;
branches;
next	1.200;
commitid	lZW2A6ug5Iurk452;

1.200
date	2015.02.18.17.49.56;	author jca;	state Exp;
branches
	1.200.2.1;
next	1.199;
commitid	PMjoyq1h5DCAaFZ2;

1.199
date	2015.02.17.12.43.08;	author jca;	state Exp;
branches;
next	1.198;
commitid	ptvl6zq7GEqrMDL6;

1.198
date	2015.02.06.09.01.21;	author pea;	state Exp;
branches;
next	1.197;
commitid	18eJpkhTKqKNlL5V;

1.197
date	2015.01.16.23.24.15;	author landry;	state Exp;
branches;
next	1.196;
commitid	odkoX8jTKvDY2gxZ;

1.196
date	2015.01.16.18.24.57;	author landry;	state Exp;
branches;
next	1.195;
commitid	XrC31XbOA8EMVKzw;

1.195
date	2015.01.08.15.01.11;	author pea;	state Exp;
branches;
next	1.194;
commitid	yFcByahJB4ZZYrD6;

1.194
date	2014.10.16.00.08.54;	author jeremy;	state Exp;
branches;
next	1.193;
commitid	Peezmskx9VaJJs5q;

1.193
date	2014.09.23.08.41.10;	author sthen;	state Exp;
branches;
next	1.192;
commitid	P942euuPnCJgHzGW;

1.192
date	2014.09.16.09.09.46;	author espie;	state Exp;
branches;
next	1.191;
commitid	6Lt9epP559Qkvcv4;

1.191
date	2014.09.02.13.39.39;	author pea;	state Exp;
branches;
next	1.190;
commitid	F34l7O3xAdY4uyQH;

1.190
date	2014.09.02.12.56.35;	author espie;	state Exp;
branches;
next	1.189;
commitid	nWd40UQAMdVXueiL;

1.189
date	2014.08.14.17.04.12;	author naddy;	state Exp;
branches;
next	1.188;
commitid	ssbpBt8RBXirjLk7;

1.188
date	2014.04.21.22.15.09;	author ajacoutot;	state Exp;
branches
	1.188.2.1;
next	1.187;

1.187
date	2014.04.21.13.32.08;	author sthen;	state Exp;
branches;
next	1.186;

1.186
date	2014.04.21.13.29.19;	author sthen;	state Exp;
branches;
next	1.185;

1.185
date	2014.04.21.13.13.29;	author ajacoutot;	state Exp;
branches;
next	1.184;

1.184
date	2014.03.28.11.50.51;	author pea;	state Exp;
branches;
next	1.183;

1.183
date	2014.03.11.10.42.34;	author pea;	state Exp;
branches;
next	1.182;

1.182
date	2014.01.06.10.47.14;	author pea;	state Exp;
branches
	1.182.2.1;
next	1.181;

1.181
date	2013.11.01.21.07.59;	author sthen;	state Exp;
branches;
next	1.180;

1.180
date	2013.10.22.06.26.09;	author kili;	state Exp;
branches;
next	1.179;

1.179
date	2013.10.15.02.18.16;	author jeremy;	state Exp;
branches;
next	1.178;

1.178
date	2013.06.20.08.26.13;	author ajacoutot;	state Exp;
branches
	1.178.2.1;
next	1.177;

1.177
date	2013.06.20.06.54.36;	author ajacoutot;	state Exp;
branches;
next	1.176;

1.176
date	2013.06.19.14.35.02;	author sthen;	state Exp;
branches;
next	1.175;

1.175
date	2013.06.17.20.08.21;	author ajacoutot;	state Exp;
branches;
next	1.174;

1.174
date	2013.06.17.19.30.22;	author ajacoutot;	state Exp;
branches;
next	1.173;

1.173
date	2013.04.04.14.45.46;	author sthen;	state Exp;
branches;
next	1.172;

1.172
date	2013.03.11.02.52.07;	author espie;	state Exp;
branches;
next	1.171;

1.171
date	2013.02.07.17.29.05;	author jasper;	state Exp;
branches
	1.171.2.1;
next	1.170;

1.170
date	2012.12.10.13.45.49;	author pea;	state Exp;
branches;
next	1.169;

1.169
date	2012.11.22.10.52.38;	author sthen;	state Exp;
branches;
next	1.168;

1.168
date	2012.09.24.19.57.02;	author pea;	state Exp;
branches;
next	1.167;

1.167
date	2012.08.19.18.22.32;	author pea;	state Exp;
branches;
next	1.166;

1.166
date	2012.08.04.15.28.14;	author ajacoutot;	state Exp;
branches;
next	1.165;

1.165
date	2012.06.04.13.01.58;	author pea;	state Exp;
branches
	1.165.2.1;
next	1.164;

1.164
date	2012.06.01.15.06.45;	author ajacoutot;	state Exp;
branches;
next	1.163;

1.163
date	2012.04.22.11.41.55;	author ajacoutot;	state Exp;
branches;
next	1.162;

1.162
date	2012.04.12.11.47.05;	author sthen;	state Exp;
branches;
next	1.161;

1.161
date	2012.03.05.15.00.57;	author pea;	state Exp;
branches;
next	1.160;

1.160
date	2012.01.24.09.20.17;	author sthen;	state Exp;
branches
	1.160.2.1;
next	1.159;

1.159
date	2011.12.07.08.32.18;	author pea;	state Exp;
branches;
next	1.158;

1.158
date	2011.10.18.12.03.01;	author sthen;	state Exp;
branches;
next	1.157;

1.157
date	2011.10.17.13.27.11;	author espie;	state Exp;
branches;
next	1.156;

1.156
date	2011.09.26.11.58.28;	author pea;	state Exp;
branches;
next	1.155;

1.155
date	2011.09.23.09.46.14;	author pea;	state Exp;
branches;
next	1.154;

1.154
date	2011.09.16.08.48.03;	author espie;	state Exp;
branches;
next	1.153;

1.153
date	2011.06.06.08.43.59;	author sthen;	state Exp;
branches
	1.153.2.1;
next	1.152;

1.152
date	2011.06.02.13.41.38;	author ajacoutot;	state Exp;
branches;
next	1.151;

1.151
date	2011.05.08.23.11.36;	author fgsch;	state Exp;
branches;
next	1.150;

1.150
date	2011.04.19.08.39.21;	author pea;	state Exp;
branches;
next	1.149;

1.149
date	2011.04.07.14.45.25;	author pea;	state Exp;
branches;
next	1.148;

1.148
date	2011.04.07.13.54.16;	author pea;	state Exp;
branches;
next	1.147;

1.147
date	2011.03.17.16.49.27;	author ajacoutot;	state Exp;
branches;
next	1.146;

1.146
date	2011.03.09.18.51.48;	author ajacoutot;	state Exp;
branches;
next	1.145;

1.145
date	2011.02.09.10.53.12;	author pea;	state Exp;
branches
	1.145.2.1;
next	1.144;

1.144
date	2011.02.02.14.10.45;	author pea;	state Exp;
branches;
next	1.143;

1.143
date	2011.01.05.16.05.54;	author ajacoutot;	state Exp;
branches;
next	1.142;

1.142
date	2011.01.04.16.03.00;	author ajacoutot;	state Exp;
branches;
next	1.141;

1.141
date	2010.12.27.14.50.22;	author ajacoutot;	state Exp;
branches;
next	1.140;

1.140
date	2010.12.24.10.40.05;	author ajacoutot;	state Exp;
branches;
next	1.139;

1.139
date	2010.12.24.09.07.38;	author jasper;	state Exp;
branches;
next	1.138;

1.138
date	2010.12.17.10.27.18;	author pea;	state Exp;
branches;
next	1.137;

1.137
date	2010.12.15.11.32.26;	author ajacoutot;	state Exp;
branches;
next	1.136;

1.136
date	2010.12.13.16.14.38;	author ajacoutot;	state Exp;
branches;
next	1.135;

1.135
date	2010.11.26.07.18.59;	author espie;	state Exp;
branches;
next	1.134;

1.134
date	2010.11.15.12.44.20;	author espie;	state Exp;
branches;
next	1.133;

1.133
date	2010.11.15.00.22.53;	author espie;	state Exp;
branches;
next	1.132;

1.132
date	2010.11.08.14.57.56;	author ajacoutot;	state Exp;
branches;
next	1.131;

1.131
date	2010.11.08.14.12.24;	author pea;	state Exp;
branches;
next	1.130;

1.130
date	2010.11.06.22.50.02;	author espie;	state Exp;
branches;
next	1.129;

1.129
date	2010.10.18.17.06.08;	author espie;	state Exp;
branches;
next	1.128;

1.128
date	2010.10.08.06.50.23;	author pea;	state Exp;
branches;
next	1.127;

1.127
date	2010.05.18.12.01.23;	author jasper;	state Exp;
branches
	1.127.2.1;
next	1.126;

1.126
date	2010.03.23.10.24.45;	author pea;	state Exp;
branches;
next	1.125;

1.125
date	2009.12.16.14.34.58;	author pea;	state Exp;
branches
	1.125.2.1;
next	1.124;

1.124
date	2009.10.02.16.03.02;	author pea;	state Exp;
branches;
next	1.123;

1.123
date	2009.09.15.17.37.21;	author jasper;	state Exp;
branches;
next	1.122;

1.122
date	2009.09.14.20.22.27;	author pea;	state Exp;
branches;
next	1.121;

1.121
date	2009.07.21.19.43.45;	author pea;	state Exp;
branches;
next	1.120;

1.120
date	2009.03.18.14.34.10;	author pea;	state Exp;
branches
	1.120.2.1;
next	1.119;

1.119
date	2009.02.07.16.56.31;	author pea;	state Exp;
branches
	1.119.2.1;
next	1.118;

1.118
date	2008.11.04.12.56.50;	author pea;	state Exp;
branches;
next	1.117;

1.117
date	2008.10.09.06.05.39;	author brad;	state Exp;
branches;
next	1.116;

1.116
date	2008.07.18.06.57.30;	author brad;	state Exp;
branches;
next	1.115;

1.115
date	2008.03.24.17.26.12;	author simon;	state Exp;
branches;
next	1.114;

1.114
date	2008.01.07.16.34.52;	author mbalmer;	state Exp;
branches;
next	1.113;

1.113
date	2007.09.20.19.20.48;	author mbalmer;	state Exp;
branches;
next	1.112;

1.112
date	2007.09.15.20.34.02;	author simon;	state Exp;
branches;
next	1.111;

1.111
date	2007.07.09.19.31.07;	author jasper;	state Exp;
branches;
next	1.110;

1.110
date	2007.07.04.19.18.46;	author jasper;	state Exp;
branches;
next	1.109;

1.109
date	2007.06.07.20.39.51;	author mbalmer;	state Exp;
branches;
next	1.108;

1.108
date	2007.05.18.16.21.30;	author mbalmer;	state Exp;
branches;
next	1.107;

1.107
date	2007.04.28.08.26.34;	author mbalmer;	state Exp;
branches;
next	1.106;

1.106
date	2007.04.23.15.25.17;	author mbalmer;	state Exp;
branches;
next	1.105;

1.105
date	2007.04.15.18.26.03;	author espie;	state Exp;
branches;
next	1.104;

1.104
date	2007.04.13.20.40.51;	author sturm;	state Exp;
branches;
next	1.103;

1.103
date	2007.03.22.19.29.17;	author simon;	state Exp;
branches;
next	1.102;

1.102
date	2007.02.10.08.01.35;	author mbalmer;	state Exp;
branches
	1.102.2.1;
next	1.101;

1.101
date	2007.02.07.15.29.25;	author mbalmer;	state Exp;
branches;
next	1.100;

1.100
date	2007.02.06.06.57.27;	author mbalmer;	state Exp;
branches;
next	1.99;

1.99
date	2007.01.17.16.47.25;	author mbalmer;	state Exp;
branches;
next	1.98;

1.98
date	2007.01.13.16.39.45;	author mbalmer;	state Exp;
branches;
next	1.97;

1.97
date	2006.11.23.21.21.54;	author kili;	state Exp;
branches;
next	1.96;

1.96
date	2006.10.31.06.50.24;	author mbalmer;	state Exp;
branches;
next	1.95;

1.95
date	2006.10.29.09.29.29;	author mbalmer;	state Exp;
branches;
next	1.94;

1.94
date	2006.10.29.08.27.05;	author mbalmer;	state Exp;
branches;
next	1.93;

1.93
date	2006.10.18.16.22.18;	author mbalmer;	state Exp;
branches;
next	1.92;

1.92
date	2006.10.18.13.54.22;	author mbalmer;	state Exp;
branches;
next	1.91;

1.91
date	2006.10.15.16.00.11;	author mbalmer;	state Exp;
branches;
next	1.90;

1.90
date	2006.10.09.12.22.53;	author aanriot;	state Exp;
branches;
next	1.89;

1.89
date	2006.10.09.11.55.18;	author aanriot;	state Exp;
branches;
next	1.88;

1.88
date	2006.08.01.22.19.46;	author espie;	state Exp;
branches
	1.88.2.1;
next	1.87;

1.87
date	2006.05.25.13.03.07;	author steven;	state Exp;
branches;
next	1.86;

1.86
date	2006.05.24.11.18.29;	author bernd;	state Exp;
branches;
next	1.85;

1.85
date	2006.02.14.18.59.36;	author mbalmer;	state Exp;
branches
	1.85.2.1;
next	1.84;

1.84
date	2006.02.05.09.23.22;	author mbalmer;	state Exp;
branches;
next	1.83;

1.83
date	2006.01.07.11.11.17;	author mbalmer;	state Exp;
branches;
next	1.82;

1.82
date	2005.12.31.13.03.39;	author mbalmer;	state Exp;
branches;
next	1.81;

1.81
date	2005.11.08.23.40.01;	author mbalmer;	state Exp;
branches;
next	1.80;

1.80
date	2005.11.08.15.20.42;	author mbalmer;	state Exp;
branches;
next	1.79;

1.79
date	2005.10.10.22.48.24;	author mbalmer;	state Exp;
branches;
next	1.78;

1.78
date	2005.08.16.09.49.51;	author espie;	state Exp;
branches
	1.78.2.1;
next	1.77;

1.77
date	2005.05.11.10.10.39;	author mbalmer;	state Exp;
branches;
next	1.76;

1.76
date	2005.04.30.12.02.10;	author mbalmer;	state Exp;
branches;
next	1.75;

1.75
date	2005.04.30.10.00.03;	author mbalmer;	state Exp;
branches;
next	1.74;

1.74
date	2005.04.07.17.45.43;	author sturm;	state Exp;
branches;
next	1.73;

1.73
date	2005.04.06.06.23.46;	author sturm;	state Exp;
branches;
next	1.72;

1.72
date	2005.02.05.15.11.58;	author sturm;	state Exp;
branches
	1.72.2.1;
next	1.71;

1.71
date	2005.01.02.00.23.28;	author alek;	state Exp;
branches;
next	1.70;

1.70
date	2004.11.22.16.59.29;	author espie;	state Exp;
branches;
next	1.69;

1.69
date	2004.07.26.10.10.46;	author peter;	state Exp;
branches
	1.69.2.1;
next	1.68;

1.68
date	2004.02.04.07.39.18;	author sturm;	state Exp;
branches
	1.68.2.1;
next	1.67;

1.67
date	2003.12.23.19.40.32;	author brad;	state Exp;
branches;
next	1.66;

1.66
date	2003.11.11.15.11.34;	author margarida;	state Exp;
branches;
next	1.65;

1.65
date	2003.05.20.13.52.00;	author lebel;	state Exp;
branches
	1.65.2.1;
next	1.64;

1.64
date	2003.02.12.17.09.03;	author naddy;	state Exp;
branches
	1.64.2.1;
next	1.63;

1.63
date	2003.01.08.21.33.21;	author todd;	state Exp;
branches;
next	1.62;

1.62
date	2003.01.03.14.24.55;	author todd;	state Exp;
branches;
next	1.61;

1.61
date	2003.01.02.14.48.23;	author todd;	state Exp;
branches;
next	1.60;

1.60
date	2003.01.02.07.15.34;	author todd;	state Exp;
branches;
next	1.59;

1.59
date	2002.12.18.05.13.15;	author brad;	state Exp;
branches;
next	1.58;

1.58
date	2002.12.17.16.38.53;	author naddy;	state Exp;
branches;
next	1.57;

1.57
date	2002.05.19.23.39.57;	author brad;	state Exp;
branches;
next	1.56;

1.56
date	2002.03.25.03.18.20;	author brad;	state Exp;
branches;
next	1.55;

1.55
date	2002.01.11.18.56.34;	author brad;	state Exp;
branches;
next	1.54;

1.54
date	2001.09.27.05.45.34;	author pvalchev;	state Exp;
branches;
next	1.53;

1.53
date	2001.09.07.22.48.47;	author peter;	state Exp;
branches;
next	1.52;

1.52
date	2001.09.03.23.24.37;	author brad;	state Exp;
branches;
next	1.51;

1.51
date	2001.08.23.16.29.55;	author peter;	state Exp;
branches;
next	1.50;

1.50
date	2001.08.07.13.25.50;	author brad;	state Exp;
branches;
next	1.49;

1.49
date	2001.07.25.08.16.46;	author peter;	state Exp;
branches;
next	1.48;

1.48
date	2001.04.23.21.58.44;	author espie;	state Exp;
branches;
next	1.47;

1.47
date	2001.04.21.18.25.42;	author peter;	state Exp;
branches;
next	1.46;

1.46
date	2001.04.13.07.00.44;	author brad;	state Exp;
branches;
next	1.45;

1.45
date	2001.03.10.19.27.15;	author brad;	state Exp;
branches;
next	1.44;

1.44
date	2001.03.10.16.56.54;	author brad;	state Exp;
branches;
next	1.43;

1.43
date	2001.03.05.19.36.22;	author brad;	state Exp;
branches;
next	1.42;

1.42
date	2001.02.23.02.41.00;	author brad;	state Exp;
branches;
next	1.41;

1.41
date	2001.02.22.20.08.57;	author danh;	state Exp;
branches;
next	1.40;

1.40
date	2001.02.22.19.28.12;	author danh;	state Exp;
branches;
next	1.39;

1.39
date	2000.11.30.19.23.14;	author dugsong;	state Exp;
branches;
next	1.38;

1.38
date	2000.10.22.18.46.02;	author espie;	state Exp;
branches;
next	1.37;

1.37
date	2000.09.11.06.38.45;	author brad;	state Exp;
branches;
next	1.36;

1.36
date	2000.08.25.21.12.44;	author brad;	state Exp;
branches;
next	1.35;

1.35
date	2000.08.25.15.34.13;	author brad;	state Exp;
branches;
next	1.34;

1.34
date	2000.07.01.18.10.37;	author form;	state Exp;
branches;
next	1.33;

1.33
date	2000.06.28.13.18.45;	author espie;	state Exp;
branches;
next	1.32;

1.32
date	2000.06.07.03.38.12;	author form;	state Exp;
branches;
next	1.31;

1.31
date	2000.05.24.04.23.21;	author form;	state Exp;
branches;
next	1.30;

1.30
date	2000.05.23.16.31.41;	author form;	state Exp;
branches;
next	1.29;

1.29
date	2000.04.09.17.36.14;	author espie;	state Exp;
branches
	1.29.2.1;
next	1.28;

1.28
date	2000.03.27.18.17.27;	author espie;	state Exp;
branches;
next	1.27;

1.27
date	2000.03.24.23.28.04;	author espie;	state Exp;
branches;
next	1.26;

1.26
date	2000.03.05.18.30.24;	author espie;	state Exp;
branches;
next	1.25;

1.25
date	2000.02.22.17.08.38;	author espie;	state Exp;
branches;
next	1.24;

1.24
date	2000.02.15.05.04.09;	author turan;	state Exp;
branches;
next	1.23;

1.23
date	2000.02.12.06.29.51;	author turan;	state Exp;
branches;
next	1.22;

1.22
date	2000.02.11.01.10.01;	author espie;	state Exp;
branches;
next	1.21;

1.21
date	2000.02.11.00.37.20;	author espie;	state Exp;
branches;
next	1.20;

1.20
date	99.12.09.02.57.07;	author form;	state Exp;
branches;
next	1.19;

1.19
date	99.12.07.11.47.47;	author form;	state Exp;
branches;
next	1.18;

1.18
date	99.12.07.08.26.41;	author form;	state Exp;
branches;
next	1.17;

1.17
date	99.12.07.05.09.41;	author form;	state Exp;
branches;
next	1.16;

1.16
date	99.11.11.02.24.29;	author kevlo;	state Exp;
branches;
next	1.15;

1.15
date	99.08.18.02.43.45;	author angelos;	state Exp;
branches;
next	1.14;

1.14
date	99.04.01.06.20.06;	author brad;	state Exp;
branches;
next	1.13;

1.13
date	99.02.21.04.26.10;	author marc;	state Exp;
branches;
next	1.12;

1.12
date	98.10.20.08.39.44;	author form;	state Exp;
branches;
next	1.11;

1.11
date	98.10.19.09.52.49;	author form;	state Exp;
branches;
next	1.10;

1.10
date	98.10.08.04.42.57;	author marc;	state Exp;
branches;
next	1.9;

1.9
date	98.07.02.07.29.45;	author form;	state Exp;
branches;
next	1.8;

1.8
date	98.06.27.22.18.34;	author marc;	state Exp;
branches;
next	1.7;

1.7
date	98.06.17.06.27.17;	author form;	state Exp;
branches;
next	1.6;

1.6
date	98.06.17.05.41.24;	author form;	state Exp;
branches;
next	1.5;

1.5
date	98.06.10.06.06.52;	author form;	state Exp;
branches;
next	1.4;

1.4
date	98.05.06.16.55.37;	author form;	state Exp;
branches;
next	1.3;

1.3
date	98.03.11.02.06.34;	author marc;	state Exp;
branches;
next	1.2;

1.2
date	97.12.03.20.10.01;	author niklas;	state Exp;
branches;
next	1.1;

1.1
date	97.11.20.20.34.05;	author mickey;	state Exp;
branches;
next	;

1.29.2.1
date	2000.09.15.04.47.50;	author marc;	state Exp;
branches;
next	;

1.64.2.1
date	2003.11.11.15.12.40;	author margarida;	state Exp;
branches;
next	1.64.2.2;

1.64.2.2
date	2003.11.20.22.52.26;	author margarida;	state Exp;
branches;
next	;

1.65.2.1
date	2003.11.11.15.13.26;	author margarida;	state Exp;
branches;
next	1.65.2.2;

1.65.2.2
date	2003.11.17.00.05.01;	author margarida;	state Exp;
branches;
next	;

1.68.2.1
date	2005.02.05.21.54.44;	author sturm;	state Exp;
branches;
next	;

1.69.2.1
date	2005.02.05.21.55.23;	author sturm;	state Exp;
branches;
next	1.69.2.2;

1.69.2.2
date	2005.06.06.22.00.47;	author sturm;	state Exp;
branches;
next	;

1.72.2.1
date	2005.06.06.20.43.03;	author sturm;	state Exp;
branches;
next	1.72.2.2;

1.72.2.2
date	2006.02.07.21.08.28;	author sturm;	state Exp;
branches;
next	1.72.2.3;

1.72.2.3
date	2006.02.15.21.09.43;	author sturm;	state Exp;
branches;
next	1.72.2.4;

1.72.2.4
date	2006.02.17.22.15.35;	author sturm;	state Exp;
branches;
next	;

1.78.2.1
date	2006.02.15.22.20.32;	author sturm;	state Exp;
branches;
next	1.78.2.2;

1.78.2.2
date	2006.02.17.22.20.56;	author sturm;	state Exp;
branches;
next	1.78.2.3;

1.78.2.3
date	2006.05.24.17.50.12;	author sturm;	state Exp;
branches;
next	1.78.2.4;

1.78.2.4
date	2006.10.30.17.56.09;	author sturm;	state Exp;
branches;
next	;

1.85.2.1
date	2006.05.24.22.29.59;	author sturm;	state Exp;
branches;
next	1.85.2.2;

1.85.2.2
date	2006.10.29.18.19.07;	author sturm;	state Exp;
branches;
next	1.85.2.3;

1.85.2.3
date	2007.01.15.21.33.32;	author sturm;	state Exp;
branches;
next	1.85.2.4;

1.85.2.4
date	2007.02.07.20.02.49;	author sturm;	state Exp;
branches;
next	1.85.2.5;

1.85.2.5
date	2007.04.25.18.30.28;	author sturm;	state Exp;
branches;
next	;

1.88.2.1
date	2006.11.03.17.34.38;	author sturm;	state Exp;
branches;
next	1.88.2.2;

1.88.2.2
date	2007.01.15.21.53.04;	author sturm;	state Exp;
branches;
next	1.88.2.3;

1.88.2.3
date	2007.02.07.20.04.20;	author sturm;	state Exp;
branches;
next	1.88.2.4;

1.88.2.4
date	2007.04.25.17.58.00;	author sturm;	state Exp;
branches;
next	;

1.102.2.1
date	2007.05.01.16.46.02;	author sturm;	state Exp;
branches;
next	;

1.119.2.1
date	2009.09.19.03.21.18;	author william;	state Exp;
branches;
next	;

1.120.2.1
date	2009.10.29.04.10.52;	author william;	state Exp;
branches;
next	1.120.2.2;

1.120.2.2
date	2009.12.16.04.25.58;	author william;	state Exp;
branches;
next	1.120.2.3;

1.120.2.3
date	2010.03.30.02.05.52;	author william;	state Exp;
branches;
next	;

1.125.2.1
date	2010.05.22.03.23.47;	author william;	state Exp;
branches;
next	1.125.2.2;

1.125.2.2
date	2010.10.26.02.33.34;	author william;	state Exp;
branches;
next	;

1.127.2.1
date	2010.10.26.02.34.06;	author william;	state Exp;
branches;
next	1.127.2.2;

1.127.2.2
date	2010.12.19.20.00.31;	author jasper;	state Exp;
branches;
next	1.127.2.3;

1.127.2.3
date	2011.02.08.10.27.16;	author pea;	state Exp;
branches;
next	1.127.2.4;

1.127.2.4
date	2011.04.19.08.50.22;	author pea;	state Exp;
branches;
next	;

1.145.2.1
date	2011.04.19.08.41.02;	author pea;	state Exp;
branches;
next	1.145.2.2;

1.145.2.2
date	2011.09.27.13.46.40;	author pea;	state Exp;
branches;
next	;

1.153.2.1
date	2011.09.27.13.42.53;	author pea;	state Exp;
branches;
next	1.153.2.2;

1.153.2.2
date	2011.12.07.09.16.31;	author pea;	state Exp;
branches;
next	1.153.2.3;

1.153.2.3
date	2012.03.05.15.19.04;	author pea;	state Exp;
branches;
next	;

1.160.2.1
date	2012.04.12.14.52.18;	author pea;	state Exp;
branches;
next	1.160.2.2;

1.160.2.2
date	2012.06.04.14.04.36;	author pea;	state Exp;
branches;
next	1.160.2.3;

1.160.2.3
date	2012.08.31.12.25.43;	author pea;	state Exp;
branches;
next	1.160.2.4;

1.160.2.4
date	2012.09.26.09.24.51;	author sthen;	state Exp;
branches;
next	;

1.165.2.1
date	2012.08.22.13.05.32;	author jasper;	state Exp;
branches;
next	1.165.2.2;

1.165.2.2
date	2012.09.26.06.49.13;	author jasper;	state Exp;
branches;
next	1.165.2.3;

1.165.2.3
date	2013.01.09.12.18.59;	author pea;	state Exp;
branches;
next	1.165.2.4;

1.165.2.4
date	2013.02.07.17.34.43;	author jasper;	state Exp;
branches;
next	1.165.2.5;

1.165.2.5
date	2013.04.04.14.59.39;	author sthen;	state Exp;
branches;
next	;

1.171.2.1
date	2013.05.03.07.30.18;	author jasper;	state Exp;
branches;
next	1.171.2.2;

1.171.2.2
date	2014.01.06.10.57.27;	author pea;	state Exp;
branches;
next	1.171.2.3;

1.171.2.3
date	2014.03.20.09.03.37;	author pea;	state Exp;
branches;
next	1.171.2.4;

1.171.2.4
date	2014.03.28.11.45.25;	author pea;	state Exp;
branches;
next	;

1.178.2.1
date	2014.01.06.10.50.57;	author pea;	state Exp;
branches;
next	1.178.2.2;

1.178.2.2
date	2014.03.20.09.12.50;	author pea;	state Exp;
branches;
next	1.178.2.3;

1.178.2.3
date	2014.03.28.11.46.49;	author pea;	state Exp;
branches;
next	;

1.182.2.1
date	2014.03.21.10.27.45;	author pea;	state Exp;
branches;
next	1.182.2.2;

1.182.2.2
date	2014.03.28.11.54.25;	author pea;	state Exp;
branches;
next	;

1.188.2.1
date	2015.02.06.11.00.33;	author pea;	state Exp;
branches;
next	;
commitid	YXVBbLSmY8Yfvb1T;

1.200.2.1
date	2015.06.01.08.25.23;	author pea;	state Exp;
branches;
next	1.200.2.2;
commitid	0NJVxtR69vYaa1gJ;

1.200.2.2
date	2015.06.22.07.32.21;	author pea;	state Exp;
branches;
next	1.200.2.3;
commitid	K1n0znlK4dM1oNvE;

1.200.2.3
date	2015.11.03.09.29.15;	author pea;	state Exp;
branches;
next	;
commitid	pBJe2qbmjtP2PjXC;

1.207.4.1
date	2015.11.03.16.49.08;	author pea;	state Exp;
branches;
next	1.207.4.2;
commitid	MwjJTmWdfHNBWhRl;

1.207.4.2
date	2016.02.16.09.20.36;	author jasper;	state Exp;
branches;
next	1.207.4.3;
commitid	Sz2fOZKrVdgk7cOl;

1.207.4.3
date	2016.04.04.10.35.26;	author jasper;	state Exp;
branches;
next	;
commitid	MtypPv2QmivvDyFU;

1.209.2.1
date	2016.04.01.14.23.59;	author pea;	state Exp;
branches;
next	1.209.2.2;
commitid	5Ri4Lwc4itrINaEG;

1.209.2.2
date	2016.08.19.15.22.34;	author pea;	state Exp;
branches;
next	1.209.2.3;
commitid	xTApQefqhvfCse7N;

1.209.2.3
date	2016.09.25.16.26.03;	author pea;	state Exp;
branches;
next	;
commitid	RJb6KFHDkcQ29gWE;

1.215.2.1
date	2016.08.19.11.41.39;	author pea;	state Exp;
branches;
next	1.215.2.2;
commitid	bClyY0B6xY0PmDgK;

1.215.2.2
date	2017.01.06.14.17.28;	author pea;	state Exp;
branches;
next	1.215.2.3;
commitid	znBradqhmBU9CyhQ;

1.215.2.3
date	2017.04.06.03.49.40;	author pea;	state Exp;
branches;
next	;
commitid	lHLDgIhrjkTcOx5C;


desc
@@


1.223
log
@Update to 9.6.2

ok jeremy@@
@
text
@# $OpenBSD: Makefile,v 1.222 2017/02/09 15:14:11 sthen Exp $

COMMENT-main=	PostgreSQL RDBMS (client)
COMMENT-server=	PostgreSQL RDBMS (server)
COMMENT-docs=	PostgreSQL RDBMS documentation
COMMENT-contrib=PostgreSQL RDBMS contributions
COMMENT-plpython=Python procedural language for PostgreSQL
COMMENT-pg_upgrade=Support for upgrading PostgreSQL data from previous version

VERSION=	9.6.2
PREV_MAJOR=	9.5
DISTNAME=	postgresql-${VERSION}
PKGNAME-main=	postgresql-client-${VERSION}
PKGNAME-server=	postgresql-server-${VERSION}
PKGNAME-docs=	postgresql-docs-${VERSION}
PKGNAME-contrib=postgresql-contrib-${VERSION}
PKGNAME-plpython=postgresql-plpython-${VERSION}
PKGNAME-pg_upgrade=postgresql-pg_upgrade-${VERSION}


CATEGORIES=	databases
SHARED_LIBS=	ecpg		7.8 \
		ecpg_compat	4.8 \
		pgtypes		4.7 \
		pq		6.9 

HOMEPAGE=	http://www.postgresql.org/

MAINTAINER=	Pierre-Emmanuel Andre <pea@@openbsd.org>

# BSD
PERMIT_PACKAGE_CDROM=	Yes

WANTLIB += c crypto m readline ssl termcap z

MASTER_SITES=	https://ftp.postgresql.org/pub/source/v${VERSION}/ \
		ftp://ftp.postgresql.org/pub/source/v${VERSION}/
MULTI_PACKAGES=	-docs -main -server -contrib -pg_upgrade -plpython

MAKE_FILE=	GNUmakefile

V_MAJOR=	${VERSION:R}
SUBST_VARS=	VERSION V_MAJOR PREV_MAJOR

USE_GMAKE=	Yes
USE_GROFF=	Yes

CONFIGURE_STYLE=gnu

MODULES=	lang/python gcc4
MODPY_RUNDEP=	No

# for __sync_lock_test_and_set
MODGCC4_ARCHS=	arm

CONFIGURE_ENV=	ac_cv_path_PYTHON=${MODPY_BIN} \
		CPPFLAGS="-I${LOCALBASE}/include" \
		LDFLAGS="-L${LOCALBASE}/lib"

CONFIGURE_ARGS=	--disable-rpath --with-openssl=/usr \
		--with-bsd-auth \
		--with-perl \
		--with-python \
		--with-pam=no \
		--with-uuid=bsd \
		--enable-integer-datetimes \
		--includedir="${PREFIX}/include/postgresql" \
		--datadir="${PREFIX}/share/postgresql" \
		--docdir="${PREFIX}/share/doc/postgresql" \
		--with-includes="${INCLUDES}" \
		--with-libraries="${LOCALBASE}/lib" \
		--with-system-tzdata="/usr/share/zoneinfo" \
		--with-openssl \
		--with-libxml \
		--disable-thread-safety

# There is no spinlock support for hppa and alpha yet. Until we have access to
# a system to get this working, disable them for now. There is
# (apparently) a serious performance hit doing this.

.if ${MACHINE_ARCH} == "hppa" || ${MACHINE_ARCH} == "alpha"
CONFIGURE_ARGS+=--disable-spinlocks
.endif

MODGNU_CONFIG_GUESS_DIRS=	${WRKSRC}/config

ALL_TARGET=	world
INSTALL_TARGET=	install-world

LIB_DEPENDS-main= textproc/libxml
WANTLIB-main =	${WANTLIB} xml2


LIB_DEPENDS-server= databases/postgresql=${VERSION} \
		    ${LIB_DEPENDS-main}
WANTLIB-server=	${WANTLIB-main} perl pq>=4

RUN_DEPENDS-contrib= databases/postgresql,-server=${VERSION}
LIB_DEPENDS-contrib= databases/postgresql=${VERSION} \
		     ${LIB_DEPENDS-main}
WANTLIB-contrib=	${WANTLIB-main} pq>=4

RUN_DEPENDS-pg_upgrade=	databases/postgresql,-server=${VERSION} \
			databases/postgresql-previous
LIB_DEPENDS-pg_upgrade= databases/postgresql=${VERSION} \
		     ${LIB_DEPENDS-main}
WANTLIB-pg_upgrade=	${WANTLIB-main} pq>=4

LIB_DEPENDS-plpython=	${MODPY_LIB_DEPENDS}
WANTLIB-plpython =	c m pthread util \
			${MODPY_WANTLIB}
RUN_DEPENDS-plpython=	databases/postgresql,-server=${VERSION}

WANTLIB-docs=
PKG_ARCH-docs=	*


MAKE_ENV=	LIBpq_MAJOR=${LIBpq_VERSION:R} \
		LIBpq_MINOR=${LIBpq_VERSION:E} \
		LIBecpg_MAJOR=${LIBecpg_VERSION:R} \
		LIBecpg_MINOR=${LIBecpg_VERSION:E} \
		LIBecpg_compat_MAJOR=${LIBecpg_compat_VERSION:R} \
		LIBecpg_compat_MINOR=${LIBecpg_compat_VERSION:E} \
		LIBpgtypes_MAJOR=${LIBpgtypes_VERSION:R} \
		LIBpgtypes_MINOR=${LIBpgtypes_VERSION:E}

# Regression tests must be done manually and not as root. Successful
# runs have been achieved on the i386 using the following:
#
#	$ ulimit -p 128
#	$ ulimit -n 1024
#	$ make test NO_TEST=No
#
# Note, you may also need to change a variety of SYSV IPC parameters.
# See pkg/README-server for more details
NO_TEST=	Yes

DOCS=	${WRKSRC}/COPYRIGHT ${WRKSRC}/HISTORY \
	${WRKSRC}/INSTALL ${WRKSRC}/README \
	${WRKSRC}/doc/TODO

# Work around Makefile issue where it attempts to rebuild
# the documentation even if it is not necessary.
pre-build:
	touch ${WRKSRC}/doc/src/sgml/*-stamp

INSTALL_REPLACE = 's/^install_bin = .*$$/ifdef BSD_INSTALL_SCRIPT\ninstall_bin
INSTALL_REPLACE += = \$$\(subst -m 755,,\$${BSD_INSTALL_SCRIPT}\)
INSTALL_REPLACE += \nelse\ninstall_bin = \/usr\/bin\/install -c -o ${BINOWN}
INSTALL_REPLACE += -g ${BINGRP}\nendif/'
post-install:
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/postgresql
	${INSTALL_DATA} ${DOCS} ${PREFIX}/share/doc/postgresql
	perl -i -pe ${INSTALL_REPLACE} \
		${PREFIX}/lib/postgresql/pgxs/src/Makefile.global

.include <bsd.port.mk>
@


1.222
log
@Adjust pg_upgrade docs. Written by jeremy@@ based on my notes, with small
tweaks by me to avoid hardcoding versions (both in this README and in the
@@ask-update in PLIST).  OK jeremy@@ pea@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.221 2016/12/26 13:56:04 jsg Exp $
d10 1
a10 1
VERSION=	9.6.1
a11 2
REVISION=	0
REVISION-server= 1
@


1.221
log
@Base gcc does not have atomic builtins on arm.  Instead of disabling
spinlocks build with ports gcc for now to get the atomic builtins.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.220 2016/12/21 07:43:57 phessler Exp $
a9 3
# DO NOT FORGET to also change the @@ask-update entry in pkg/PLIST-server
# in case a dump before / restore after pkg_add -u is required!

d11 1
d13 1
d44 2
a45 1
SUBST_VARS=	VERSION
@


1.220
log
@disable spinlocks on arm, so we can have a postgresql package
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.219 2016/12/18 18:18:27 jeremy Exp $
d14 1
d52 1
a52 1
MODULES=	lang/python
d55 3
d83 1
a83 1
.if ${MACHINE_ARCH} == "hppa" || ${MACHINE_ARCH} == "alpha" || ${MACHINE_ARCH} == "arm"
@


1.219
log
@Update to PostgreSQL 9.6.1

This moves pg_upgrade to a subpackage, and has that
subpackage depend on postgresql-previous.

pthread is removed from WANTLIB, as it is no longer
needed for suppoting threaded extensions.

This adds support for PostgreSQL 9.6's new BSD
authentication.

OK pea@@ landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.218 2016/09/10 13:03:41 ajacoutot Exp $
d79 1
a79 1
.if ${MACHINE_ARCH} == "hppa" || ${MACHINE_ARCH} == "alpha"
@


1.218
log
@First pass at pre-entively fixing ports that would break once guenther's header
pollution diff is in.

lang/squeak/vm does not build but it's due to the recent audio changes
games/xbattle: also fixes some conflicting implicit decl
print/hplip: also fixes some conflicting implicit decl
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.217 2016/09/01 10:53:26 jasper Exp $
d8 1
d13 1
a13 1
VERSION=	9.5.4
d20 2
a21 5
REVISION-contrib=	0
REVISION-docs=	0
REVISION-main=	0
REVISION-plpython=	0
REVISION-server=0
d24 4
a27 4
SHARED_LIBS=	ecpg		7.7 \
		ecpg_compat	4.7 \
		pgtypes		4.6 \
		pq		6.8
d36 1
a36 1
WANTLIB += c crypto m readline ssl termcap z pthread
d40 1
a40 1
MULTI_PACKAGES=	-docs -main -server -contrib -plpython
d59 1
d95 1
a96 1

d101 6
a114 1
WANTLIB-server+=	util
@


1.217
log
@retire sparc
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.216 2016/08/17 09:43:46 pea Exp $
d19 5
@


1.216
log
@Security update to 9.5.4

ok robert@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.215 2016/06/03 07:28:07 landry Exp $
a7 2

BROKEN-sparc=	Requires v9|v9a|v9b; requested architecture is sparclite.
@


1.215
log
@Add alpha to the 'need --disable-spinlocks' boat

http://build-failures.rhaalovely.net/alpha/2016-05-26/databases/postgresql.log

error: #error PostgreSQL does not have native spinlock support on this
platform. To continue the compilation, rerun configure using
--disable-spinlocks. However, performance will be poor. Please report
this to pgsql-bugs@@postgresql.org.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.214 2016/05/13 17:15:55 pea Exp $
d14 1
a14 1
VERSION=	9.5.3
@


1.215.2.1
log
@Security update to 9.5.4

ok robert@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.215 2016/06/03 07:28:07 landry Exp $
d14 1
a14 1
VERSION=	9.5.4
@


1.215.2.2
log
@Bugfix update to 9.5.5
ok jeremy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.215.2.1 2016/08/19 11:41:39 pea Exp $
d14 1
a14 1
VERSION=	9.5.5
@


1.215.2.3
log
@Reliability update to 9.5.6
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.215.2.2 2017/01/06 14:17:28 pea Exp $
d14 1
a14 1
VERSION=	9.5.6
@


1.214
log
@Update ton 9.5.3

ok jeremy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.213 2016/05/13 14:27:48 pea Exp $
d73 1
a73 1
# There is no spinlock support for hppa yet. Until we have access to
d77 1
a77 1
.if ${MACHINE_ARCH} == "hppa"
@


1.213
log
@Update to 9.5.2
Tested in a bulk by ajacoutot@@
ok jeremy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.212 2016/04/01 14:41:07 sthen Exp $
d14 1
a14 1
VERSION=	9.5.2
@


1.212
log
@garbage-collect comment that was associated with the (removed) SHARED_ONLY
line. ok pea@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.211 2016/04/01 13:00:18 pea Exp $
d14 1
a14 1
VERSION=	9.4.7
a21 1

d23 4
a26 4
SHARED_LIBS=	ecpg		7.6 \
		ecpg_compat	4.6 \
		pgtypes		4.5 \
		pq		5.7
@


1.211
log
@Security update to 9.4.7

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.210 2016/03/20 16:12:23 naddy Exp $
a40 5

# The -client SUBPACKAGE should build and run fine on static arches,
# but the server requires loadable library support. Until we figure
# out the correct incantation to not build the server on those systems,
# simply don't build for them, yet.
@


1.210
log
@drop SHARED_ONLY from python and ruby ports
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.209 2016/02/13 21:54:28 sthen Exp $
d14 1
a14 1
VERSION=	9.4.6
@


1.209
log
@SECURITY update to PostgreSQL 9.4.6: various fixes including one for
CVE-2016-0773, an issue with regular expression parsing. Various other fixes.

Note: ..."if you are upgrading an installation that contains any GIN
indexes that use the (non-default) jsonb_path_ops operator class, see
the first changelog entry"...
http://www.postgresql.org/docs/current/static/release-9-4-6.html

OK pea@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.208 2015/11/03 09:35:31 pea Exp $
a45 1
SHARED_ONLY=	Yes
@


1.209.2.1
log
@Security update to 9.4.7

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.209 2016/02/13 21:54:28 sthen Exp $
d14 1
a14 1
VERSION=	9.4.7
@


1.209.2.2
log
@Security update to 9.4.8

ok robert@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.209.2.1 2016/04/01 14:23:59 pea Exp $
d14 1
a14 1
VERSION=	9.4.8
@


1.209.2.3
log
@Security update to 9.4.9 ( CVE-2016-5423, CVE-2016-5424)
ok robert@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.209.2.2 2016/08/19 15:22:34 pea Exp $
d14 1
a14 1
VERSION=	9.4.9
@


1.208
log
@Security update to 9.4.5
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.207 2015/08/03 07:42:30 kirby Exp $
d14 1
a14 1
VERSION=	9.4.5
@


1.207
log
@ - remove trailing white spaces
 - add RSC id and header to README-plpython
OK jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.206 2015/07/18 15:32:47 ajacoutot Exp $
d14 1
a14 1
VERSION=	9.4.4
a21 2
REVISION-server=	1
REVISION-plpython=	0
@


1.207.4.1
log
@Security update to 9.4.5
"go ahead" sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.208 2015/11/03 09:35:31 pea Exp $
d14 1
a14 1
VERSION=	9.4.5
d22 2
@


1.207.4.2
log
@SECURITY update to PostgreSQL 9.4.6: various fixes including one for
CVE-2016-0773, an issue with regular expression parsing. Various other fixes.

Note: ..."if you are upgrading an installation that contains any GIN
indexes that use the (non-default) jsonb_path_ops operator class, see
the first changelog entry"...

http://www.postgresql.org/docs/current/static/release-9-4-6.html
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.207.4.1 2015/11/03 16:49:08 pea Exp $
d14 1
a14 1
VERSION=	9.4.6
@


1.207.4.3
log
@update to postgresql-9.4.7
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.209.2.1 2016/04/01 14:23:59 pea Exp $
d14 1
a14 1
VERSION=	9.4.7
@


1.206
log
@sudo(8) -> su(1)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.205 2015/06/23 07:26:21 bentley Exp $
d22 2
a23 1
REVISION-server=	0
@


1.205
log
@Kill dead mirrors, and add a http mirror.

ok pea@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.204 2015/06/22 07:29:42 pea Exp $
d21 2
@


1.204
log
@Upgrade to 9.4.4

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.203 2015/06/01 08:23:47 pea Exp $
d37 2
a38 5
MASTER_SITES=	http://ftp.postgresql.org/pub/source/v${VERSION}/ \
	http://ftp5.es.postgresql.org/mirror/postgresql/source/v${VERSION}/ \
	ftp://ftp.postgresql.org/pub/source/v${VERSION}/ \
	ftp://ftp5.us.postgresql.org/pub/PostgreSQL/source/v${VERSION}/

@


1.203
log
@Security / reliability update to 9.4.2

go ahead ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.202 2015/05/22 11:31:11 ajacoutot Exp $
d14 1
a14 1
VERSION=	9.4.2
@


1.202
log
@"/usr/local/lib/pkgconfig/" is part of mtree(8).
Packages should not own this dir to prevent its deletion or a warning that it
cannot be removed because it's not empty at pkg_delete(1) time.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.201 2015/04/17 07:59:19 phessler Exp $
d14 1
a14 2
VERSION=	9.4.1
REVISION-server= 2
a20 4
REVISION-contrib=	0
REVISION-docs=	0
REVISION-main=	0
REVISION-plpython=	0
d35 1
a35 1
WANTLIB += c crypto m readline ssl termcap z
@


1.201
log
@these expect that "sparc" is sparc64, not 32bit.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.200 2015/02/18 17:49:56 jca Exp $
d15 1
a15 1
REVISION-server= 1
d22 4
@


1.200
log
@Fix hba "samehost"/"samenet" support.

On OpenBSD, the sa_family field in netmask sockaddrs can be zero and
thus different from the sa_family of the address sockaddr.
Until this glitch gets corrected, fix postgresql.

ok sthen@@ pea@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.199 2015/02/17 12:43:08 jca Exp $
d8 2
@


1.200.2.1
log
@Security / reliability update to 9.4.2

go ahead ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.200 2015/02/18 17:49:56 jca Exp $
d12 2
a13 1
VERSION=	9.4.2
@


1.200.2.2
log
@Reliability upgrade to 9.4.4

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.200.2.1 2015/06/01 08:25:23 pea Exp $
d12 1
a12 1
VERSION=	9.4.4
@


1.200.2.3
log
@Security update to 9.4.5
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.200.2.2 2015/06/22 07:32:21 pea Exp $
d12 1
a12 1
VERSION=	9.4.5
@


1.199
log
@Fix hba with IPv6 connections.

The incorrect code was generating memcpy calls with src and dest
overlapping, which raises SIGABRT, making the server unreachable
using IPv6.  The fix consists in passing the right parameters to
memcpy, including sizeof(struct sockaddr_in) as len, since
sizeof(struct sockaddr_storage) would be too much, and sa_len
is unusable in netmask sockaddrs.  Debugged with sthen@@ and lteo@@

Problem reported by Hugo Osvaldo Barrera.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.198 2015/02/06 09:01:21 pea Exp $
d13 1
a13 1
REVISION-server= 0
@


1.198
log
@Security / bugfixes update to 9.4.1 (5 CVE)

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.197 2015/01/16 23:24:15 landry Exp $
d13 1
@


1.197
log
@Unbreak on alpha by using the correct memory barrier instruction, courtesy of miod@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.196 2015/01/16 18:24:57 landry Exp $
d12 1
a12 1
VERSION=	9.4.0
@


1.196
log
@That had to happen... postgresql fails to build on alpha:
{standard input}:1354: Error: unknown opcode `rmb'
Mark as BROKEN accordingly, until a proper fix is devised.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.195 2015/01/08 15:01:11 pea Exp $
a2 1
BROKEN-alpha=	{standard input}:1354: Error: unknown opcode `rmb'
@


1.195
log
@Update to 9.4.0

Tested in a bulk build by landry@@

help and ok jeremy@@, sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.194 2014/10/16 00:08:54 jeremy Exp $
d3 1
@


1.194
log
@Allow installation of PostgreSQL extensions outside of the ports system.
Remove FAKE_AS_ROOT = always-wrap, since it is no longer necessary.

espie@@ in favor
OK pea@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.193 2014/09/23 08:41:10 sthen Exp $
d12 1
a12 2
VERSION=	9.3.5
REVISION-server= 1
d21 4
a24 4
SHARED_LIBS=	ecpg		7.5 \
		ecpg_compat	4.5 \
		pgtypes		4.4 \
		pq		5.6
d68 1
a76 1
		--with-ossp-uuid \
d103 2
a104 3
		     ${LIB_DEPENDS-main} \
		     devel/uuid
WANTLIB-contrib=	${WANTLIB-main} pq>=4 ossp-uuid
@


1.193
log
@use -w when starting postgresql, to wait for startup to complete before
continuing. suggested by frantisek holop, ok ajacoutot@@

while there, s/an another/another/ in README
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.192 2014/09/16 09:09:46 espie Exp $
d13 1
a13 1
REVISION-server= 0
a19 2
FAKE_AS_ROOT=	always-wrap

d147 4
d154 2
@


1.192
log
@turn on "always-wrap" for the 3 ports known to embed their install program
in installed files.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.191 2014/09/02 13:39:39 pea Exp $
d13 1
d20 1
a20 1
FAKE_AS_ROOT =	always-wrap
@


1.191
log
@Update to 9.3.5

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.190 2014/09/02 12:56:35 espie Exp $
d19 1
a19 1
#FAKE_AS_ROOT =	always-wrap
@


1.190
log
@not yet on by default, still some love needed for umasks
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.189 2014/08/14 17:04:12 naddy Exp $
d12 1
a12 1
VERSION=	9.3.4
a20 1
REVISION=		0
@


1.189
log
@Add the remaining pieces to allow fake as non-root.
Not enabled as a general default yet.

Committing for espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.188 2014/04/21 22:15:09 ajacoutot Exp $
d19 1
a19 1
FAKE_AS_ROOT =	always-wrap
@


1.188
log
@Drop commented line.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.187 2014/04/21 13:32:08 sthen Exp $
d19 1
@


1.188.2.1
log
@Security / bugfixes update to 9.3.6 ( 5 CVE )

ok jasper@@, sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.188 2014/04/21 22:15:09 ajacoutot Exp $
d12 1
a12 1
VERSION=	9.3.6
d20 1
@


1.187
log
@blech, revert previous
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.186 2014/04/21 13:29:19 sthen Exp $
a61 1
#INCLUDES=	${LOCALBASE}/include /usr/include/kerberosV
@


1.186
log
@restore PLIST-plpython, update-plist likes overwriting pkg-readmes lines
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.185 2014/04/21 13:13:29 ajacoutot Exp $
a20 1
REVISION-plpython=	1
@


1.185
log
@Drop kerberos support.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.184 2014/03/28 11:50:51 pea Exp $
d21 1
@


1.184
log
@Critical update to 9.3.4

"The data corruption issue in PostgreSQL 9.3 affects binary replication
standbys, servers being recovered from point-in-time-recovery backup,
and standalone servers which recover from a system crash. The bug
causes unrecoverable index corruption during recovery due to incorrect
replay of row locking operations. This can then cause query results to be
inconsistent depending on whether or not an index is used, and eventually
lead to primary key violations and similar issues."

ok sthen@@, jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.183 2014/03/11 10:42:34 pea Exp $
d20 1
d35 1
a35 2
WANTLIB=		c com_err crypto m readline ssl termcap z asn1 \
			heimbase krb5 roken wind
d64 2
a65 2
		CPPFLAGS="-I${LOCALBASE}/include $$(krb5-config --cflags)" \
		LDFLAGS="-L${LOCALBASE}/lib $$(krb5-config --libs)"
a80 1
		--with-krb5 \
d111 2
a112 2
WANTLIB-plpython =	c m pthread util com_err crypto asn1 \
			heimbase krb5 roken wind ${MODPY_WANTLIB}
@


1.183
log
@Update to 9.3.3.
This update fixes 8 CVE (CVE-2014-0060, CVE-2014-0061, CVE-2014-0062,
CVE-2014-0063, CVE-2014-0064, CVE-2014-0065, CVE-2014-0066 and CVE-2014-0067).
This update also fixes some issues which affect binary replication and row
locking, and can cause recoverable data corruption in some cases.

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.182 2014/01/06 10:47:14 pea Exp $
d12 1
a12 1
VERSION=	9.3.3
@


1.182
log
@Critical update to 9.3.2.
Fixes three serious data-loss bugs affecting replication and
database maintenance.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.181 2013/11/01 21:07:59 sthen Exp $
d12 1
a12 1
VERSION=	9.3.2
@


1.182.2.1
log
@Update to 9.3.3

This update fixes 8 CVE (CVE-2014-0060, CVE-2014-0061, CVE-2014-0062,
CVE-2014-0063, CVE-2014-0064, CVE-2014-0065, CVE-2014-0066 and CVE-2014-0067).
This update also fixes some issues which affect binary replication and row
locking, and can cause recoverable data corruption in some cases.

ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.182 2014/01/06 10:47:14 pea Exp $
d12 1
a12 1
VERSION=	9.3.3
@


1.182.2.2
log
@Critical update to 9.3.4

"The data corruption issue in PostgreSQL 9.3 affects binary replication
standbys, servers being recovered from point-in-time-recovery backup,
and standalone servers which recover from a system crash. The bug
causes unrecoverable index corruption during recovery due to incorrect
replay of row locking operations. This can then cause query results to be
inconsistent depending on whether or not an index is used, and eventually
lead to primary key violations and similar issues."

ok sthen@@, jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.182.2.1 2014/03/21 10:27:45 pea Exp $
d12 1
a12 1
VERSION=	9.3.4
@


1.181
log
@tweak login.conf fragment to use openfiles rather than openfiles-cur thus
avoiding any issues with it being higher than whatever value openfiles-max
ends up taking (which may be non-obvious as it may be inherited from
"openfiles" in "default"). ok ajacoutot@@ pea@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.180 2013/10/22 06:26:09 kili Exp $
d12 1
a12 1
VERSION=	9.3.0
a19 1
REVISION-server=	1
d112 2
a113 1
WANTLIB-plpython =	c m pthread util ${MODPY_WANTLIB}
@


1.180
log
@Crank the @@ask-update entry in pkg/PLIST-server and add a reminder
to do so for every major update.

ok jeremy@@, pea@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.179 2013/10/15 02:18:16 jeremy Exp $
d20 1
a20 1
REVISION-server=	0
@


1.179
log
@Major update to 9.3.0.  As usual, a dump/restore is required.

Add plpython subpackage. Move some contrib module .so files to the
contrib subpackage.

OK pea@@ (MAINTAINER), bulk testing by landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.178 2013/06/20 08:26:13 ajacoutot Exp $
d9 3
d19 2
@


1.178
log
@No need for pthread.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.177 2013/06/20 06:54:36 ajacoutot Exp $
d7 1
d9 1
a9 1
VERSION=	9.2.4
d15 1
a15 4

REVISION-main=	2
REVISION-server=2
REVISION-contrib=3
d18 4
a21 4
SHARED_LIBS=	ecpg		7.4 \
		ecpg_compat	4.4 \
		pgtypes		4.3 \
		pq		5.5
d38 1
a38 1
MULTI_PACKAGES=	-docs -main -server -contrib
d54 7
a60 1
CONFIGURE_ENV=	CPPFLAGS="-I${LOCALBASE}/include $$(krb5-config --cflags)" \
d62 1
d65 1
d107 4
d139 5
@


1.178.2.1
log
@Critical update to 9.2.6.
Fixes three serious data-loss bugs affecting replication and
database maintenance.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.178 2013/06/20 08:26:13 ajacoutot Exp $
d8 1
a8 1
VERSION=	9.2.6
d15 3
@


1.178.2.2
log
@Update to 9.2.7

This update fixes 8 CVE (CVE-2014-0060, CVE-2014-0061, CVE-2014-0062,
CVE-2014-0063, CVE-2014-0064, CVE-2014-0065, CVE-2014-0066 and CVE-2014-0067).
This update also fixes some issues which affect binary replication and row
locking, and can cause recoverable data corruption in some cases.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.178.2.1 2014/01/06 10:50:57 pea Exp $
d8 1
a8 1
VERSION=	9.2.7
@


1.178.2.3
log
@Bugfixes update to 9.2.8

ok sthen@@, jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.178.2.2 2014/03/20 09:12:50 pea Exp $
d8 1
a8 1
VERSION=	9.2.8
@


1.177
log
@Unbreak after hx509 and ntlm removal from Kerberos.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.176 2013/06/19 14:35:02 sthen Exp $
d15 3
a17 3
REVISION-main=	1
REVISION-server=1
REVISION-contrib=2
d33 1
a33 1
			heimbase krb5 pthread roken wind
@


1.176
log
@sync -contrib wantlib following devel/uuid change
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.175 2013/06/17 20:08:21 ajacoutot Exp $
d15 3
a17 3
REVISION-main=	0
REVISION-server=0
REVISION-contrib=1
d33 1
a33 1
			heimbase hx509 krb5 pthread roken wind
@


1.175
log
@Explicitely compile with --with-pam=no ; this is currently the default
but in case an update changes that, we don't want it to pick up openpam
inadvertently.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.174 2013/06/17 19:30:22 ajacoutot Exp $
d17 1
a17 1
REVISION-contrib=0
d99 1
a99 1
WANTLIB-contrib = 	${WANTLIB-main} pq>=4 uuid
@


1.174
log
@Unbreak with new Heimdal; get rid of self-cooked krb5-config since we
have it in base now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.173 2013/04/04 14:45:46 sthen Exp $
d60 1
@


1.173
log
@Critical SECURITY update to PostgreSQL, fixing CVE-2013-1899,
CVE-2013-1900 and CVE-2013-1901. ok jasper@@

"A major security issue fixed in this release, CVE-2013-1899, makes
it possible for a connection request containing a database name that
begins with "-" to be crafted that can damage or destroy files within a
server's data directory. Anyone with access to the port the PostgreSQL
server listens on can initiate this request. This issue was discovered
by Mitsumasa Kondo and Kyotaro Horiguchi of NTT Open Source Software
Center."   http://www.postgresql.org/about/news/1456/
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.172 2013/03/11 02:52:07 espie Exp $
d15 4
d31 3
a33 1
WANTLIB=		c com_err crypto m readline ssl termcap z
d53 2
a54 1
USE_GROFF =	Yes
d56 2
a57 2

INCLUDES=	${LOCALBASE}/include /usr/include/kerberosV
d70 2
a71 2
		--disable-thread-safety \
		--with-krb5
@


1.172
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.171 2013/02/07 17:29:05 jasper Exp $
d8 1
a8 1
VERSION=	9.2.3
d29 4
a32 3
MASTER_SITES= 	ftp://ftp5.us.postgresql.org/pub/PostgreSQL/source/v${VERSION}/ \
	ftp://ftp5.es.postgresql.org/mirror/postgresql/source/v${VERSION}/ \
	ftp://ftp.postgresql.org/pub/source/v${VERSION}/
@


1.171
log
@- update to postgresql 9.2.3
* includes a fix for CVE-2013-0255

ok pea@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.170 2012/12/10 13:45:49 pea Exp $
a26 3
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
d111 1
a111 1
#	$ make regress NO_REGRESS=No
d115 1
a115 1
NO_REGRESS=	Yes
@


1.171.2.1
log
@Critical SECURITY update to PostgreSQL, fixing CVE-2013-1899,
CVE-2013-1900 and CVE-2013-1901.

"A major security issue fixed in this release, CVE-2013-1899, makes
it possible for a connection request containing a database name that
begins with "-" to be crafted that can damage or destroy files within a
server's data directory. Anyone with access to the port the PostgreSQL
server listens on can initiate this request. This issue was discovered
by Mitsumasa Kondo and Kyotaro Horiguchi of NTT Open Source Software
Center."   http://www.postgresql.org/about/news/1456/
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.171 2013/02/07 17:29:05 jasper Exp $
d8 1
a8 1
VERSION=	9.2.4
d32 3
a34 4
MASTER_SITES=   http://ftp.postgresql.org/pub/source/v${VERSION}/ \
	http://ftp5.es.postgresql.org/mirror/postgresql/source/v${VERSION}/ \
	ftp://ftp.postgresql.org/pub/source/v${VERSION}/ \
	ftp://ftp5.us.postgresql.org/pub/PostgreSQL/source/v${VERSION}/
@


1.171.2.2
log
@Critical update to 9.2.6.
Fixes three serious data-loss bugs affecting replication and
database maintenance.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.171.2.1 2013/05/03 07:30:18 jasper Exp $
d8 1
a8 1
VERSION=	9.2.6
@


1.171.2.3
log
@Update to 9.2.7

This update fixes 8 CVE (CVE-2014-0060, CVE-2014-0061, CVE-2014-0062,
CVE-2014-0063, CVE-2014-0064, CVE-2014-0065, CVE-2014-0066 and CVE-2014-0067).
This update also fixes some issues which affect binary replication and row
locking, and can cause recoverable data corruption in some cases.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.171.2.2 2014/01/06 10:57:27 pea Exp $
d8 1
a8 1
VERSION=	9.2.7
@


1.171.2.4
log
@Bugfixes update to 9.2.8

ok sthen@@, jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.171.2.3 2014/03/20 09:03:37 pea Exp $
d8 1
a8 1
VERSION=	9.2.8
@


1.170
log
@Bugfixes update to 9.2.2

ok jeremy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.169 2012/11/22 10:52:38 sthen Exp $
d8 1
a8 1
VERSION=	9.2.2
d19 1
a19 1
		pq		5.5 
@


1.169
log
@Lower the suggested increase to sysv semaphores to a level which is still
suitable for normal use, but is a bit lower (semmni=60, semmns=1024),
make it clear that the default in the kernel is *just* enough for the
default max_connections value, and point out the manual section
describing this in more detail.   ok pea@@ jeremy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.168 2012/09/24 19:57:02 pea Exp $
d8 1
a8 1
VERSION=	9.2.1
a13 1
REVISION-server= 0
@


1.168
log
@Major update to PostgreSQL 9.2.1.
As usual a dump/restore is required.

ok jasper@@ jeremy@@ landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.167 2012/08/19 18:22:32 pea Exp $
d14 1
@


1.167
log
@Bugfix update to 9.1.5.
2 CVE fixed (CVE-2012-3488 and CVE-2012-3489)

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.166 2012/08/04 15:28:14 ajacoutot Exp $
d8 1
a8 1
VERSION=	9.1.5
d16 4
a19 4
SHARED_LIBS=	ecpg		7.3 \
		ecpg_compat	4.3 \
		pgtypes		4.2 \
		pq		5.4
d32 1
a32 2
MASTER_SITES= ftp://ftp2.uk.postgresql.org/sites/ftp.postgresql.org/source/v${VERSION}/ \
	ftp://ftp5.us.postgresql.org/pub/PostgreSQL/source/v${VERSION}/ \
@


1.166
log
@Set rc_usercheck to NO.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.165 2012/06/04 13:01:58 pea Exp $
d8 1
a8 1
VERSION=	9.1.4
a13 1
REVISION-main=	0
@


1.165
log
@Bugfixes update to 9.1.4

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.164 2012/06/01 15:06:45 ajacoutot Exp $
d14 1
@


1.165.2.1
log
@Bugfix update to 9.1.5.
2 CVE fixed (CVE-2012-3488 and CVE-2012-3489)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.165 2012/06/04 13:01:58 pea Exp $
d8 1
a8 1
VERSION=	9.1.5
@


1.165.2.2
log
@Update to postgresql-9.1.6, which fixes critical data corruption issues.
For more information please refer to http://www.postgresql.org/about/news/1416/

ok pea@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.165.2.1 2012/08/22 13:05:32 jasper Exp $
d8 1
a8 1
VERSION=	9.1.6
@


1.165.2.3
log
@Bugfix update to 9.1.7

ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.165.2.2 2012/09/26 06:49:13 jasper Exp $
d8 1
a8 1
VERSION=	9.1.7
@


1.165.2.4
log
@- update to postgresql 9.1.8
* includes a fix for CVE-2013-0255

ok pea@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.165.2.3 2013/01/09 12:18:59 pea Exp $
d8 1
a8 1
VERSION=	9.1.8
@


1.165.2.5
log
@Critical SECURITY update to PostgreSQL in 5.2-stable, fixing CVE-2013-1899,
CVE-2013-1900 and CVE-2013-1901.

"A major security issue fixed in this release, CVE-2013-1899, makes
it possible for a connection request containing a database name that
begins with "-" to be crafted that can damage or destroy files within a
server's data directory. Anyone with access to the port the PostgreSQL
server listens on can initiate this request. This issue was discovered
by Mitsumasa Kondo and Kyotaro Horiguchi of NTT Open Source Software
Center."   http://www.postgresql.org/about/news/1456/

A dump/restore is not required for those running 9.1.X.

However, this release corrects several errors in management of GiST
indexes. After installing this update, it is advisable to REINDEX
any GiST indexes that meet one or more of the conditions described
below.

Also, if you are upgrading from a version earlier than 9.1.6, see
the release notes for 9.1.6.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.165.2.4 2013/02/07 17:34:43 jasper Exp $
d8 1
a8 1
VERSION=	9.1.9
d32 4
a35 4
MASTER_SITES=	http://ftp.postgresql.org/pub/source/v${VERSION}/ \
	http://ftp5.es.postgresql.org/mirror/postgresql/source/v${VERSION}/ \
	ftp://ftp.postgresql.org/pub/source/v${VERSION}/ \
	ftp://ftp5.us.postgresql.org/pub/PostgreSQL/source/v${VERSION}/
@


1.164
log
@Make the rc.d(8) script use pg_ctl all the way.

ok pea@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.163 2012/04/22 11:41:55 ajacoutot Exp $
d8 1
a8 2
VERSION=	9.1.3
REVISION-server=2
@


1.163
log
@Use RCDIR instead of /etc/rc.d when refering to packages rc scripts.

discussed with espie and sthen
ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.162 2012/04/12 11:47:05 sthen Exp $
d9 1
a9 1
REVISION-server=1
@


1.162
log
@Add steps to copy SSL certs and a reminder about UTF8 to postgresql-server's
upgrade notes.  ok pea@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.161 2012/03/05 15:00:57 pea Exp $
d9 1
a9 1
REVISION-server=0
@


1.161
log
@Update to 9.1.3

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.160 2012/01/24 09:20:17 sthen Exp $
d9 1
@


1.160
log
@- show an example command line for initializing the database with UTF8,
it's mentioned in text but this makes it clearer (and it's a pain to switch
it afterwards :)

- s/task/tasks

ok pea@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.159 2011/12/07 08:32:18 pea Exp $
d8 1
a8 2
VERSION=	9.1.2
REVISION-server=0
@


1.160.2.1
log
@Update to 9.1.3
Fixes for CVE-2012-0866, CVE-2012-0867 and CVE-2012-0868

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.160 2012/01/24 09:20:17 sthen Exp $
d8 2
a9 1
VERSION=	9.1.3
@


1.160.2.2
log
@Update to 9.1.4:
+ Security fixes for CVE-2012-2143 and CVE-2012-2655
+ Lot of bugfixes.

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.160.2.1 2012/04/12 14:52:18 pea Exp $
d8 1
a8 1
VERSION=	9.1.4
@


1.160.2.3
log
@Bugfixe update to 9.1.5
2 CVE fixed (CVE-2012-3488 and CVE-2012-3489)

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.160.2.2 2012/06/04 14:04:36 pea Exp $
d8 1
a8 1
VERSION=	9.1.5
@


1.160.2.4
log
@Update to postgresql-9.1.6, which fixes critical data corruption issues.
For more information please refer to http://www.postgresql.org/about/news/1416/

ok pea@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.160.2.3 2012/08/31 12:25:43 pea Exp $
d8 1
a8 1
VERSION=	9.1.6
@


1.159
log
@Update to 9.1.2

Two important things:

+ Fix bugs in information_schema.referential_constraints view
If you need to fix this in an existing installation, you
can (as a superuser) drop the information_schema schema then re-create it
by sourcing /usr/local/share/postgresql/information_schema.sql.
This must be repeated in each database to be fixed.

+ Make contrib/citext's upgrade script fix collations of
citext columns and indexes.
If you have a previously-upgraded database that is suffering
from this problem, and you already ran the CREATE EXTENSION command,
you can manually run (as superuser) the UPDATE commands found
at the end of /usr/local/share/postgresql/extension/citext--unpackaged--1.0.sql.


ok jeremy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.158 2011/10/18 12:03:01 sthen Exp $
d9 1
@


1.158
log
@tweak the pgsql major upgrade upgrade notes;

- use /etc/rc.d to stop and start the daemon.
- use sudo rather than keep jumping between root/_postgresql users.
- use pkg_add -ui rather than just -u (allow it to ask if you've backed
up, rather than just terminating).

ok pea@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.157 2011/10/17 13:27:11 espie Exp $
d8 1
a8 1
VERSION=	9.1.1
a11 1
REVISION-server= 0
@


1.157
log
@bsd.own.mk hasn't been needed since krb5 has been standard...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.156 2011/09/26 11:58:28 pea Exp $
d12 1
@


1.156
log
@Bugfix update

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.155 2011/09/23 09:46:14 pea Exp $
a51 2

.include <bsd.own.mk>
@


1.155
log
@Major upgrade to PostgreSQL 9.1.0
A dump/restore is required.

Tested in a bulk by jasper@@, thanks !

ok jasper@@, jeremy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.154 2011/09/16 08:48:03 espie Exp $
d8 1
a8 1
VERSION=	9.1.0
@


1.154
log
@normalize pkgpath
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.153 2011/06/06 08:43:59 sthen Exp $
d8 1
a8 1
VERSION=	9.0.4
a14 4
REVISION-main =	0
REVISION-server = 2
REVISION-contrib = 0

d16 4
a19 4
SHARED_LIBS=	ecpg		7.2 \
		ecpg_compat	4.2 \
		pgtypes		4.1 \
		pq		5.3
d64 1
d81 1
a124 1
	${WRKSRC}/doc/README.mb.big5 ${WRKSRC}/doc/README.mb.jp \
a126 4
post-build:
	cd ${WRKBUILD}/contrib && exec ${SETENV} ${MAKE_ENV} \
	    ${MAKE_PROGRAM} ${MAKE_FLAGS} ${ALL_TARGET}

a129 2
	cd ${WRKBUILD}/contrib && exec ${SETENV} ${MAKE_ENV} DESTDIR=${WRKINST} \
		${MAKE_PROGRAM} ${MAKE_FLAGS} ${INSTALL_TARGET}
@


1.153
log
@- only suggest cap_mkdb if login.conf.db exists, ok aja@@ landry pea@@
- show people how to setup ssl and tweak headings, ok pea@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.152 2011/06/02 13:41:38 ajacoutot Exp $
d15 3
a17 1
REVISION-server=1
@


1.153.2.1
log
@Update to 9.0.5
Lot of bugfixes + CVE-2011-2483

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.153 2011/06/06 08:43:59 sthen Exp $
d8 1
a8 1
VERSION=	9.0.5
d14 2
@


1.153.2.2
log
@Bugfix update to 9.0.6.
Important thing:

+ Fix bugs in information_schema.referential_constraints view
If you need to fix this in an existing installation, you
can (as a superuser) drop the information_schema schema then re-create it
by sourcing /usr/local/share/postgresql/information_schema.sql.
This must be repeated in each database to be fixed.

ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.153.2.1 2011/09/27 13:42:53 pea Exp $
d8 1
a8 1
VERSION=	9.0.6
@


1.153.2.3
log
@Update to 9.0.7.
Include fixes for CVE-2012-0866, CVE-2012-0867 and CVE-2012-0868

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.153.2.2 2011/12/07 09:16:31 pea Exp $
d8 1
a8 1
VERSION=	9.0.7
@


1.152
log
@Add a consistent header that substitutes FULLPKGNAME for the READMEs.

ok jasper@@ sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.151 2011/05/08 23:11:36 fgsch Exp $
d15 1
a15 1
REVISION-server=0
@


1.151
log
@Sync comment with reality.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.150 2011/04/19 08:39:21 pea Exp $
d15 1
@


1.150
log
@Update to 9.0.4.
Changelog: http://www.postgresql.org/docs/9.0/static/release-9-0-4.html

ok ajacoutot@@, jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.149 2011/04/07 14:45:25 pea Exp $
d119 1
a119 1
# See files/README.OpenBSD for more details
@


1.149
log
@Add an explanation about cluster's encoding.
Spotted by ajacoutot@@

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.148 2011/04/07 13:54:16 pea Exp $
d8 1
a8 1
VERSION=	9.0.3
a14 1
REVISION-server=	4
@


1.148
log
@Allow PostgreSQL to run on Loongson.
With help of miod@@ (thx !)

ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.147 2011/03/17 16:49:27 ajacoutot Exp $
d15 1
a15 1
REVISION-server=	3
@


1.147
log
@Remove all redirections -- rc.subr(8) now takes care of it.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.146 2011/03/09 18:51:48 ajacoutot Exp $
d15 1
a15 1
REVISION-server=	2
@


1.146
log
@Remove now uneeded redirection.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.145 2011/02/09 10:53:12 pea Exp $
d15 1
a15 1
REVISION-server=	1
@


1.145
log
@Add a small upgrade howto.

idea from sthen@@
ok sthen@@, landry@@
looks good espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.144 2011/02/02 14:10:45 pea Exp $
d15 1
a15 1
REVISION-server=	0
@


1.145.2.1
log
@Bugfixes update to 9.0.4

ok ajacoutot@@, jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.145 2011/02/09 10:53:12 pea Exp $
d8 1
a8 1
VERSION=	9.0.4
d15 1
@


1.145.2.2
log
@Update to 9.0.5
Lot of bugfixes + CVE-2011-2483

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.145.2.1 2011/04/19 08:41:02 pea Exp $
d8 1
a8 1
VERSION=	9.0.5
@


1.144
log
@Update to 9.0.3.

+ CVE fix (CVE-2010-4015)
+ fix nasty behavior:
  - Before exiting walreceiver, ensure all the received WAL is fsync'd to disk.
    Otherwise the standby server could replay some un-synced WAL, conceivably leading
    to data corruption if the system crashes just at that point.
  - Make ALTER TABLE revalidate uniqueness and exclusion constraints when needed

Tested in a bulk by landry@@

ok ajacoutot@@, landry@@, sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.143 2011/01/05 16:05:54 ajacoutot Exp $
d14 2
@


1.143
log
@Make use of rcexec.
While here, force postgresql to quit in rc_stop, ok pea@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.142 2011/01/04 16:03:00 ajacoutot Exp $
d8 1
a8 1
VERSION=	9.0.2
a13 3

REVISION-server=3
REVISION-contrib=0
@


1.142
log
@Cope with recent class handling in rc.subr.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.141 2010/12/27 14:50:22 ajacoutot Exp $
d15 1
a15 1
REVISION-server=2
@


1.141
log
@Simplify after recent rc.subr change.
The framework is now stable and we will start documenting it (at last).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.140 2010/12/24 10:40:05 ajacoutot Exp $
d15 1
a15 1
REVISION-server=1
@


1.140
log
@Cope with recent rc.subr changes.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.139 2010/12/24 09:07:38 jasper Exp $
d15 1
a15 1
REVISION-server=0
@


1.139
log
@- bump after uuid rename, reminded by aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.138 2010/12/17 10:27:18 pea Exp $
d15 1
@


1.138
log
@Bugfixes update to 9.0.2
Changelog: http://www.postgresql.org/docs/9.0/static/release-9-0-2.html

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.137 2010/12/15 11:32:26 ajacoutot Exp $
d15 1
@


1.137
log
@Fix variable names in rc script. Breakage spotted by pea@@
While here, deal with the pidfile in pre, not post.

ok pea@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.136 2010/12/13 16:14:38 ajacoutot Exp $
d8 1
a8 1
VERSION=	9.0.1
a14 1
REVISION-server=	2
@


1.136
log
@Move to using daemon_user.

ok pea@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.135 2010/11/26 07:18:59 espie Exp $
d15 1
a15 1
REVISION-server=	1
@


1.135
log
@newer depends with >=
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.134 2010/11/15 12:44:20 espie Exp $
d15 1
a15 1
REVISION-server=	0
@


1.134
log
@a few depends I missed
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.133 2010/11/15 00:22:53 espie Exp $
d88 1
a88 1
LIB_DEPENDS-server= postgresql-client-${VERSION}:databases/postgresql \
d91 1
a91 1
RUN_DEPENDS-contrib=postgresql-server-${VERSION}:databases/postgresql,-server
d93 1
a93 1
LIB_DEPENDS-contrib= postgresql-client-${VERSION}:databases/postgresql \
@


1.133
log
@convert to new style depends
zap default spec that are not needed
convert libspecs as well
convert p* to REVISION.

No package changes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.132 2010/11/08 14:57:56 ajacoutot Exp $
d84 1
a84 1
LIB_DEPENDS-main= ::textproc/libxml
@


1.132
log
@Add missing RCS id.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.131 2010/11/08 14:12:24 pea Exp $
d88 1
a88 1
LIB_DEPENDS-server= :postgresql-client-${VERSION}:databases/postgresql \
d90 2
a91 2
WANTLIB-server=	${WANTLIB-main} perl pq.>=4
RUN_DEPENDS-contrib=:postgresql-server-${VERSION}:databases/postgresql,-server
d93 1
a93 1
LIB_DEPENDS-contrib= :postgresql-client-${VERSION}:databases/postgresql \
d95 2
a96 2
		     ::devel/uuid
WANTLIB-contrib = 	${WANTLIB-main} pq.>=4 uuid
@


1.131
log
@* MAJOR UPGRADE *

+ upgrade to 9.0.1
+ move readme to new location
+ add a rc script

A dump / restore is needed for this upgrade.
See http://openbsd.raveland.org/ports/postgresql/UPGRADE_HOWTO.txt
if you need help for this.

ok jasper@@, eric@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.130 2010/11/06 22:50:02 espie Exp $
d14 2
@


1.130
log
@bye bye old LIB_DEPENDS
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.129 2010/10/18 17:06:08 espie Exp $
d8 1
a8 1
VERSION=	8.4.5
d16 2
a17 2
SHARED_LIBS=	ecpg		7.1 \
		ecpg_compat	4.1 \
d19 1
a19 1
		pq		5.2
d55 1
a55 1
INCLUDES=	${LOCALBASE}/include
d66 3
a68 6
		--with-libxml

.if ${KERBEROS5} == "yes"
CONFIGURE_ARGS+=--with-krb5
INCLUDES+=	/usr/include/kerberosV
.endif
d80 1
a80 1
INSTALL_TARGET=	install
a132 4
	@@sed -e s#!!PREFIX!!#${TRUEPREFIX}#g ${FILESDIR}/README.OpenBSD > \
		${WRKBUILD}/README.OpenBSD
	${INSTALL_DATA} ${WRKBUILD}/README.OpenBSD \
		${PREFIX}/share/doc/postgresql
d134 1
a134 1
	    ${MAKE_PROGRAM} ${MAKE_FLAGS} ${INSTALL_TARGET}
@


1.129
log
@USE_GROFF=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.128 2010/10/08 06:50:23 pea Exp $
d85 2
a86 1
LIB_DEPENDS-main= xml2::textproc/libxml
a87 1
WANTLIB-server=	${WANTLIB} perl
d89 1
a89 1
LIB_DEPENDS-server= pq.>=4:postgresql-client-${VERSION}:databases/postgresql \
d91 1
d94 1
a94 1
LIB_DEPENDS-contrib= pq.>=4:postgresql-client-${VERSION}:databases/postgresql \
d96 2
a97 1
		     uuid::devel/uuid
@


1.128
log
@Update to 8.4.5
Changelog here: http://www.postgresql.org/docs/8.4/static/release-8-4-5.html

ok jasper@@

note: i will update it to 9.0.1 in a few days
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.127 2010/05/18 12:01:23 jasper Exp $
d50 1
@


1.127
log
@- SECURITY update of postgresql to 8.4.4
fixes CVE-2010-1169 CVE-2010-1447 and CVE-2010-1170.

ok pea@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.126 2010/03/23 10:24:45 pea Exp $
d8 1
a8 1
VERSION=	8.4.4
@


1.127.2.1
log
@SECURITY UPDATE to postgresql-8.4.5

Changelog:
http://www.postgresql.org/docs/8.4/static/release-8-4-5.html

from pea@@, thanks!

ok jasper
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.127 2010/05/18 12:01:23 jasper Exp $
d8 1
a8 1
VERSION=	8.4.5
@


1.127.2.2
log
@- advised update of postgresql to 8.4.6

from pea@@ (MAINTAINER)
'yes please' aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.127.2.1 2010/10/26 02:34:06 william Exp $
d8 1
a8 1
VERSION=	8.4.6
@


1.127.2.3
log
@Bugfix update to 8.4.7
Security fix for CVE-2010-4015

ok sthen@@, ajacoutot@@, jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.127.2.2 2010/12/19 20:00:31 jasper Exp $
d8 1
a8 1
VERSION=	8.4.7
@


1.127.2.4
log
@Bugfixes update to 8.4.8

ok ajacoutot@@, jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.127.2.3 2011/02/08 10:27:16 pea Exp $
d8 1
a8 1
VERSION=	8.4.8
@


1.126
log
@Update to 8.4.3
Please note that pg_standby is now in the -contrib package

ok jasper@@, sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.125 2009/12/16 14:34:58 pea Exp $
d8 1
a8 1
VERSION=	8.4.3
@


1.125
log
@Update to 8.4.2

Please note:
if you have any hash indexes, you should REINDEX them after updating to 8.4.2,
to repair possible damage.

Changelog:
http://www.postgresql.org/docs/current/static/release-8-4-2.html

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.124 2009/10/02 16:03:02 pea Exp $
d8 1
a8 1
VERSION=	8.4.2
@


1.125.2.1
log
@SECURITY UPDATE to postgresql-8.4.4

http://www.postgresql.org/docs/8.4/static/release-8-4-4.html

from pea@@

ok pea@@ jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.125 2009/12/16 14:34:58 pea Exp $
d8 1
a8 1
VERSION=	8.4.4
@


1.125.2.2
log
@SECURITY UPDATE to postgresql-8.4.5

Changelog:
http://www.postgresql.org/docs/8.4/static/release-8-4-5.html

from pea@@, thanks!

ok jasper
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.125.2.1 2010/05/22 03:23:47 william Exp $
d8 1
a8 1
VERSION=	8.4.5
@


1.124
log
@Take maintainership

discussed with many.
please commit jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.123 2009/09/15 17:37:21 jasper Exp $
d8 1
a8 1
VERSION=	8.4.1
d10 4
a13 4
PKGNAME-main=	postgresql-client-${VERSION}p1
PKGNAME-server=	postgresql-server-${VERSION}p1
PKGNAME-docs=	postgresql-docs-${VERSION}p1
PKGNAME-contrib=postgresql-contrib-${VERSION}p1
@


1.123
log
@remove marc balmer as maintainer of all of his ports, to take away the
illusion marc still maintains them. as requested by himself.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.122 2009/09/14 20:22:27 pea Exp $
d10 4
a13 4
PKGNAME-main=	postgresql-client-${VERSION}p0
PKGNAME-server=	postgresql-server-${VERSION}p0
PKGNAME-docs=	postgresql-docs-${VERSION}p0
PKGNAME-contrib=postgresql-contrib-${VERSION}p0
d22 2
@


1.122
log
@Update to 8.4.1.
Changelog: http://www.postgresql.org/docs/8.4/static/release-8-4-1.html
Security fixes: http://www.postgresql.org/support/security

"fine by me" mbalmer@@, ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.121 2009/07/21 19:43:45 pea Exp $
d10 4
a13 4
PKGNAME-main=	postgresql-client-${VERSION}
PKGNAME-server=	postgresql-server-${VERSION}
PKGNAME-docs=	postgresql-docs-${VERSION}
PKGNAME-contrib=postgresql-contrib-${VERSION}
a21 2

MAINTAINER=	Marc Balmer <mbalmer@@openbsd.org>
@


1.121
log
@Upgrade PostgreSQL to the latest version 8.4.0.
Initial diff (for rc and beta) from simon@@

ok mbalmer@@, simon@@
commitski jasper@@

BE CAREFULL: it's a major upgrade !
You MUST dump/restore all your data for this upgrade.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.120 2009/03/18 14:34:10 pea Exp $
d8 1
a8 1
VERSION=	8.4.0
@


1.120
log
@Update to 8.3.7
See http://www.postgresql.org/docs/8.3/static/release-8-3-7.html

ok mbalmer@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.119 2009/02/07 16:56:31 pea Exp $
d8 1
a8 1
VERSION=	8.3.7
d16 4
a19 4
SHARED_LIBS=	ecpg		7.0 \
		ecpg_compat	4.0 \
		pgtypes		4.0 \
		pq		5.1
d60 1
a60 1
		--with-docdir="${PREFIX}/share/doc/postgresql" \
d124 1
a124 1
	${WRKSRC}/doc/FAQ ${WRKSRC}/doc/FAQ_DEV ${WRKSRC}/doc/TODO
@


1.120.2.1
log
@SECURITY update to 8.3.8

A dump/restore is not required for those running 8.3.X. However, if you have
any hash indexes on interval columns, you must REINDEX them after updating
to 8.3.8.

from pea@@, thanks!

ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.120 2009/03/18 14:34:10 pea Exp $
d8 1
a8 1
VERSION=	8.3.8
@


1.120.2.2
log
@SECURITY FIX

Update to PostgreSQL-8.3.9
http://www.postgresql.org/docs/8.3/static/release-8-3-9.html

Resolves CVE-2009-4034, CVE-2009-4136, reject SSL certificates
containing an embedded null byte in the common name (CN) field, crash fixes

from pea@@

ok sthen@@ jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.120.2.1 2009/10/29 04:10:52 william Exp $
d8 1
a8 1
VERSION=	8.3.9
d23 1
a23 1
MAINTAINER=	Pierre-Emmanuel Andre <pea@@openbsd.org>
@


1.120.2.3
log
@SECURITY FIX

postgresql-8.3.10

NOTE:  pg_standby has moved from the -server package to -contrib

from pea@@, thanks!

ok sthen@@ ajacoutot@@ jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.120.2.2 2009/12/16 04:25:58 william Exp $
d8 1
a8 1
VERSION=	8.3.10
@


1.119
log
@Upgrade to 8.3.6.
See http://www.postgresql.org/docs/8.3/static/release-8-3-6.html

ok mbalmer@@ ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.118 2008/11/04 12:56:50 pea Exp $
d8 1
a8 1
VERSION=	8.3.6
@


1.119.2.1
log
@SECURITY update to 8.3.8

from pea@@, ok mbalmer@@, reads ok to ajacoutot@@

ok jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.119 2009/02/07 16:56:31 pea Exp $
d8 1
a8 1
VERSION=	8.3.8
@


1.118
log
@Upgrade to PostgreSQL 8.3.5: bug fix release.

OK mbalmer@@, ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.117 2008/10/09 06:05:39 brad Exp $
d8 1
a8 1
VERSION=	8.3.5
@


1.117
log
@Upgrade to PostgreSQL 8.3.4; bug fix release.

ok mbalmer@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.116 2008/07/18 06:57:30 brad Exp $
d8 1
a8 1
VERSION=	8.3.4
a108 1
		
@


1.116
log
@Upgrade to PostgreSQL 8.3.3; bug fix release.

ok mbalmer@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.115 2008/03/24 17:26:12 simon Exp $
d8 1
a8 1
VERSION=	8.3.3
@


1.115
log
@Major update to version 8.3.1 - be sure to dump your databases before
you apply this and restore afterwards!

Additionally, implicit typecasts are history and not supported anymore.
Versions prior to 8.3 had the feature (some say bug) that functions,
expecting an argument to be of a certain type, have casted a variable of
any other type to the expected type, if possible.
This has changed now.  Tests surfaced rare occurrences of regressions,
which were then fixed in about ten minutes - and that code was not even
in the ports tree;  no issues found there.

A few more things have changed, namely tsearch2 went from contrib to the
core and native uuid type support was added;  for details read the
release announcement at
http://www.postgresql.org/docs/8.3/static/release-8-3.html.

tests & ok mbalmer@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.114 2008/01/07 16:34:52 mbalmer Exp $
d8 1
a8 1
VERSION=	8.3.1
@


1.114
log
@Cumulative security update to PostgreSQL 8.2.6 that fixes five security
vulnerabilities.

See http://www.postgresql.org/about/news.905 for details.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.113 2007/09/20 19:20:48 mbalmer Exp $
d8 1
a8 1
VERSION=	8.2.6
d16 4
a19 4
SHARED_LIBS=	ecpg		6.0 \
		ecpg_compat	3.0 \
		pgtypes		3.0 \
		pq		5.0
d54 1
d61 5
a65 1
		--with-openssl
d68 2
a69 1
CONFIGURE_ARGS+=--with-krb5 --with-includes=/usr/include/kerberosV
d84 2
d88 2
a89 1
LIB_DEPENDS-server= pq.>=4:postgresql-client-${VERSION}:databases/postgresql
d92 3
a94 1
LIB_DEPENDS-contrib= pq.>=4:postgresql-client-${VERSION}:databases/postgresql
@


1.113
log
@Update PostgreSQL to version 8.2.5.

Release date: 2007-09-17
This release contains a variety of fixes from 8.2.4.

A dump/restore is not required for those running 8.2.X.

See http://www.postgresql.org/docs/8.2/static/release-8-2-5.html for a list
of all changes.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.112 2007/09/15 20:34:02 simon Exp $
d8 1
a8 1
VERSION=	8.2.5
d10 4
a13 4
PKGNAME-main=	postgresql-client-${VERSION}p0
PKGNAME-server=	postgresql-server-${VERSION}p3
PKGNAME-docs=	postgresql-docs-${VERSION}p0
PKGNAME-contrib=postgresql-contrib-${VERSION}p0
@


1.112
log
@remove surrounding quotes from COMMENT/BROKEN/PERMIT_*
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.111 2007/07/09 19:31:07 jasper Exp $
d8 1
a8 1
VERSION=	8.2.4
@


1.111
log
@forgot to bump pkgnames after PFRAG.shared removal, sorry..

noticed by naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.110 2007/07/04 19:18:46 jasper Exp $
d3 4
a6 4
COMMENT-main=	"PostgreSQL RDBMS (client)"
COMMENT-server=	"PostgreSQL RDBMS (server)"
COMMENT-docs=	"PostgreSQL RDBMS documentation"
COMMENT-contrib="PostgreSQL RDBMS contributions"
@


1.110
log
@-NOT_FOR_ARCHS=	${NO_SHARED_ARCHS}
+SHARED_ONLY=	Yes

ok ajacoutot@@, simon@@, mbalmer@@ (for the postgresql bits)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.109 2007/06/07 20:39:51 mbalmer Exp $
d10 4
a13 4
PKGNAME-main=	postgresql-client-${VERSION}
PKGNAME-server=	postgresql-server-${VERSION}p2
PKGNAME-docs=	postgresql-docs-${VERSION}
PKGNAME-contrib=postgresql-contrib-${VERSION}
@


1.109
log
@Fix a typo in the server README.OpenBSD file.
Noticed by Ingo Schwarze <schwarze@@usta.de>.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.108 2007/05/18 16:21:30 mbalmer Exp $
d43 1
a43 1
NOT_FOR_ARCHS=	${NO_SHARED_ARCHS}
@


1.108
log
@Give better advice on what to put in /etc/rc.local, unclutters output
at system startup time.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.107 2007/04/28 08:26:34 mbalmer Exp $
d11 1
a11 1
PKGNAME-server=	postgresql-server-${VERSION}p1
@


1.107
log
@Fix a typo.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.106 2007/04/23 15:25:17 mbalmer Exp $
d11 1
a11 1
PKGNAME-server=	postgresql-server-${VERSION}p0
@


1.106
log
@Security update to PostgreSQL 8.2.4.

This fixes several bugs and one vulnerability (CVE-2007-2138).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.105 2007/04/15 18:26:03 espie Exp $
d11 1
a11 1
PKGNAME-server=	postgresql-server-${VERSION}
@


1.105
log
@you can't have inter-packages WANTLIB, you've got to go through LIB_DEPENDS
so that build proceeds correctly.

noticed by naddy@@, kili@@, bug by sturm@@

bump PKGNAME for people who managed to build the broken version.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.104 2007/04/13 20:40:51 sturm Exp $
d8 1
a8 1
VERSION=	8.2.3
d10 1
a10 1
PKGNAME-main=	postgresql-client-${VERSION}p1
d12 2
a13 2
PKGNAME-docs=	postgresql-docs-${VERSION}p1
PKGNAME-contrib=postgresql-contrib-${VERSION}p1
@


1.104
log
@WANTLIB
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.103 2007/03/22 19:29:17 simon Exp $
d13 1
a13 1
PKGNAME-contrib=postgresql-contrib-${VERSION}p0
d82 3
a84 1
WANTLIB-contrib=${WANTLIB} pq
@


1.103
log
@add the postgresql contributions from the contrib/ directory
as a subpackage, bump as required.

ok mbalmer@@, go ahead robert@@, kili@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.102 2007/02/10 08:01:35 mbalmer Exp $
d13 1
a13 1
PKGNAME-contrib=postgresql-contrib-${VERSION}
d82 1
@


1.102
log
@Move some manpages that sneaked into the -docs subpackage to the -main
subpackage.  spotted by nikolay.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.101 2007/02/07 15:29:25 mbalmer Exp $
d6 1
d10 1
a10 1
PKGNAME-main=	postgresql-client-${VERSION}p0
d12 2
a13 1
PKGNAME-docs=	postgresql-docs-${VERSION}p0
d37 1
a37 1
MULTI_PACKAGES=	-docs -main -server
d81 1
d113 4
d124 2
@


1.102.2.1
log
@MFC:
Security update to PostgreSQL 8.2.4.

This fixes several bugs and one vulnerability (CVE-2007-2138).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.102 2007/02/10 08:01:35 mbalmer Exp $
d7 1
a7 1
VERSION=	8.2.4
d9 1
a9 1
PKGNAME-main=	postgresql-client-${VERSION}
d11 1
a11 1
PKGNAME-docs=	postgresql-docs-${VERSION}
@


1.101
log
@The PostgreSQL 8.2.2 security update introduced a bug that has been fixed
by the PostgreSQL team in 8.2.3.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.100 2007/02/06 06:57:27 mbalmer Exp $
d9 1
a9 1
PKGNAME-main=	postgresql-client-${VERSION}
d11 1
a11 1
PKGNAME-docs=	postgresql-docs-${VERSION}
@


1.100
log
@Security update to PostgreSQL 8.2.2.

This update fixes the following problems:

CVE-2007-0555 and CVE-2007-0556.  Both of these issues
allow an authenticated attacker with the permissions to run arbitrary SQL to
launch a denial-of-service attack or possibly read out random chunks of
memory.  Since attacks to require authenticated access, the security hole is
only considered medium risk.  You can read more about the issues on Mitre:
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-0555
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-0556
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.100 2007/02/05 21:08:55 mbalmer Exp $
d7 1
a7 1
VERSION=	8.2.2
@


1.99
log
@Update to PostgreSQL 8.2.1
Please note that a database dump/restore is required to upgrade to this
version.  See the full details at the following URL:
http://www.postgresql.org/docs/current/static/release-8-2.html

requested, tested and ok by robert, simon
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.98 2007/01/13 16:39:45 mbalmer Exp $
d7 1
a7 1
VERSION=	8.2.1
@


1.98
log
@Maintenance update to PostreSQL 8.1.6, bugfixes and changes in DST rules
for canade.  No API changes.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.97 2006/11/23 21:21:54 kili Exp $
d7 1
a7 1
VERSION=	8.1.6
d14 4
a17 4
SHARED_LIBS=	ecpg		5.2 \
		ecpg_compat	2.2 \
		pgtypes		2.2 \
		pq		4.2
d28 1
a28 1
WANTLIB=		c com_err crypto m readline ssl termcap util z
d81 2
@


1.97
log
@new MULTI_PACKAGES
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.96 2006/10/31 06:50:24 mbalmer Exp $
d7 1
a7 1
VERSION=	8.1.5
d9 2
a10 2
PKGNAME-main=	postgresql-client-${VERSION}p1
PKGNAME-server=	postgresql-server-${VERSION}p4
@


1.96
log
@Give slightly better advice on KerberosV usage.
From Bioern Sandell, <biorn@@chalmers.se>, thanks.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.95 2006/10/29 09:29:29 mbalmer Exp $
d3 1
a3 1
COMMENT=	"PostgreSQL RDBMS (client)"
d9 1
a9 1
FULLPKGNAME=	postgresql-client-${VERSION}
d35 1
a35 2
MULTI_PACKAGES=	-server -docs
SUBPACKAGE?=
d76 1
a76 3
.if !defined(PACKAGING) || ${SUBPACKAGE} == "-server"
WANTLIB+=	perl
.endif
d78 3
a80 8
.if defined(PACKAGING)
.  if ${SUBPACKAGE} == "-server"
LIB_DEPENDS=	pq.>=4:postgresql-client-${VERSION}:databases/postgresql
.  elif ${SUBPACKAGE} == "-docs"
WANTLIB=
PKG_ARCH=	*
.  endif
.endif
@


1.95
log
@Add a section on KerberosV support to the README.OpenBSD file.
From Tom McLaughlin <tmclaugh@@sdf.lonestar.org>, thanks!
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.94 2006/10/29 08:27:05 mbalmer Exp $
d10 1
a10 1
PKGNAME-server=	postgresql-server-${VERSION}p3
@


1.94
log
@Add a section in the README file about the accounts involved in a PostgreSQL
database and point to two administrative user interfaces (phppgadmin and
pgadmin3).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.93 2006/10/18 16:22:18 mbalmer Exp $
d10 1
a10 1
PKGNAME-server=	postgresql-server-${VERSION}p2
@


1.93
log
@Typo in the MESSAGE-server file.  Found by bernd, gracias!
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.92 2006/10/18 13:54:22 mbalmer Exp $
d10 1
a10 1
PKGNAME-server=	postgresql-server-${VERSION}p1
@


1.92
log
@Do not install a default database when installing the -server subpackage,
instead give advice on how to install a dabase with proper protection.

ok pvalchev, bernd, krw
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.91 2006/10/15 16:00:11 mbalmer Exp $
d10 1
a10 1
PKGNAME-server=	postgresql-server-${VERSION}p0
@


1.91
log
@Update to PostgreSQL 8.1.5.   As the file sizes of the libraries are not the
same in most cases, I bumped the minor version just to be on the safe side.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.90 2006/10/09 12:22:53 aanriot Exp $
d10 1
a10 1
PKGNAME-server=	postgresql-server-${VERSION}
@


1.90
log
@put back "nohup", I should have read also this history. PostgreSQL runs
fine without it but we are not sure if the signal race has been fixed or
not, sorry.

spotted by bernd@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.89 2006/10/09 11:55:18 aanriot Exp $
d7 1
a7 1
VERSION=	8.1.4
d10 1
a10 1
PKGNAME-server=	postgresql-server-${VERSION}p1
d14 4
a17 4
SHARED_LIBS=	ecpg		5.1 \
		ecpg_compat	2.1 \
		pgtypes		2.1 \
		pq		4.1
@


1.89
log
@- remove "nohup" from the suggested rc script.
- get ride of INSTALL-server and move database init to PLIST-server.
- bump PKGNAME.

ok mbalmer@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.88 2006/08/01 22:19:46 espie Exp $
d10 1
a10 1
PKGNAME-server=	postgresql-server-${VERSION}p0
@


1.88
log
@more new libspecs.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.87 2006/05/25 13:03:07 steven Exp $
d10 1
a10 1
PKGNAME-server=	postgresql-server-${VERSION}
@


1.88.2.1
log
@MFC:
update to postgresql  8.1.5, turns out this fixes several bugs that
could cause DoS
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.88 2006/08/01 22:19:46 espie Exp $
d7 1
a7 1
VERSION=	8.1.5
d14 4
a17 4
SHARED_LIBS=	ecpg		5.2 \
		ecpg_compat	2.2 \
		pgtypes		2.2 \
		pq		4.2
@


1.88.2.2
log
@MFC:
Maintenance update to PostreSQL 8.1.6, bugfixes and changes in DST rules
for canade.  No API changes.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.88.2.1 2006/11/03 17:34:38 sturm Exp $
d7 1
a7 1
VERSION=	8.1.6
@


1.88.2.3
log
@Security update to PostgreSQL 8.1.8.

This update fixes the following problems:

CVE-2007-0555 and CVE-2007-0556.  Both of these issues
allow an authenticated attacker with the permissions to run arbitrary SQL to
launch a denial-of-service attack or possibly read out random chunks of
memory.  Since attacks to require authenticated access, the security hole is
only considered medium risk.  You can read more about the issues on Mitre:
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-0555
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-0556
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.88.2.2 2007/01/15 21:53:04 sturm Exp $
d7 1
a7 1
VERSION=	8.1.8
@


1.88.2.4
log
@Security update to PostgreSQL 8.1.9.

This fixes several bugs and one vulnerability (CVE-2007-2138).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.88.2.3 2007/02/07 20:04:20 sturm Exp $
d7 1
a7 1
VERSION=	8.1.9
@


1.87
log
@remove defunct master site and add a few more mirrors
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.86 2006/05/24 11:18:29 bernd Exp $
d83 1
a83 1
LIB_DEPENDS=	pq.4:postgresql-client-${VERSION}:databases/postgresql
@


1.86
log
@Security update to postgresql-8.1.4.

Fixes SQL-injection attacks. (CVE-2006-2313, CVE-2006-2314)

For detailed information please see:

http://developer.postgresql.org/docs/postgres/release-8-1-4.html
http://secunia.com/advisories/20231/

ok mbalmer@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.85 2006/02/14 18:59:36 mbalmer Exp $
d30 4
a33 2
MASTER_SITES= ftp://ftp3.us.postgresql.org/pub/postgresql/source/v${VERSION}/ \
	      ftp://ftp.postgresql.org/pub/source/v${VERSION}/
@


1.85
log
@Security update to PostgreSQL version 8.1.3.

Vulnerabilities in PostgreSQL SET ROLE/SET SESSION AUTHORIZATION

By issuing SET ROLE with a specially crafted argument, it is possible
for any logged-in database user to acquire the privileges of any other
database user, including superusers.  Database superuser status allows
access to the machine's filesystem and hence might be used to mount
remote attacks against the rest of the server's operating system.
This error exists in PostgreSQL releases 8.1.0 - 8.1.2 and is fixed in 8.1.3.

The same underlying bug exists in SET SESSION AUTHORIZATION in all
releases back to 7.3.  This variant cannot be exploited for privilege
escalation, because one must already be superuser to use SET SESSION
AUTHORIZATION.  However, if the server has been compiled with Asserts
enabled (which is not the default), then it is possible to trigger an
Assert failure before the privilege check is reached.  This would cause
a momentary denial of service to other database users.  This is repaired
in PostgreSQL releases 8.1.3, 8.0.7, 7.4.12, and 7.3.14.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.83 2006/01/07 11:11:17 mbalmer Exp $
d7 1
a7 1
VERSION=	8.1.3
@


1.85.2.1
log
@MFC:
Security update to postgresql-8.1.4.

Fixes SQL-injection attacks. (CVE-2006-2313, CVE-2006-2314)

For detailed information please see:

http://developer.postgresql.org/docs/postgres/release-8-1-4.html
http://secunia.com/advisories/20231/
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.85 2006/02/14 18:59:36 mbalmer Exp $
d7 1
a7 1
VERSION=	8.1.4
@


1.85.2.2
log
@update to postgresql  8.1.5, turns out this fixes several bugs that
could cause DoS
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.85.2.1 2006/05/24 22:29:59 sturm Exp $
d7 1
a7 1
VERSION=	8.1.5
d14 4
a17 4
SHARED_LIBS=	ecpg		5.2 \
		ecpg_compat	2.2 \
		pgtypes		2.2 \
		pq		4.2
@


1.85.2.3
log
@MFC:
Maintenance update to PostreSQL 8.1.6, bugfixes and changes in DST rules
for canade.  No API changes.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.85.2.2 2006/10/29 18:19:07 sturm Exp $
d7 1
a7 1
VERSION=	8.1.6
@


1.85.2.4
log
@Security update to PostgreSQL 8.1.8.

This update fixes the following problems:

CVE-2007-0555 and CVE-2007-0556.  Both of these issues
allow an authenticated attacker with the permissions to run arbitrary SQL to
launch a denial-of-service attack or possibly read out random chunks of
memory.  Since attacks to require authenticated access, the security hole is
only considered medium risk.  You can read more about the issues on Mitre:
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-0555
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-0556
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.85.2.3 2007/01/15 21:33:32 sturm Exp $
d7 1
a7 1
VERSION=	8.1.8
@


1.85.2.5
log
@Security update to PostgreSQL 8.1.9.

This fixes several bugs and one vulnerability (CVE-2007-2138).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.85.2.4 2007/02/07 20:02:49 sturm Exp $
d7 1
a7 1
VERSION=	8.1.9
@


1.84
log
@Update PostgreSQL to version 8.1.2 and move the README.OpenBSD file to the
server package, so that the informationis always available and not only
when the docs package is installed.  This was requested by many people.

SECURITY:
Version 8.1.2 fixes security and other problems that were present in 8.1.0.
See http://archives.postgresql.org/pgsql-announce/2006-01/msg00001.php for
details.
@
text
@d7 1
a7 1
VERSION=	8.1.2
@


1.83
log
@SHARED_LIBS

ok bernd
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.82 2005/12/31 13:03:39 mbalmer Exp $
d7 1
a7 1
VERSION=	8.1.0
d9 3
a11 3
FULLPKGNAME=	postgresql-client-${VERSION}p0
PKGNAME-server=	postgresql-server-${VERSION}p0
PKGNAME-docs=	postgresql-docs-${VERSION}p1
d119 2
a120 1
	${INSTALL_DATA} ${WRKBUILD}/README.OpenBSD ${PREFIX}/share/doc/postgresql
@


1.82
log
@Forgot to bump the package name of the -docs subpackage after a change
to the PLIST.

"gentle" reminder by nikolay...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.81 2005/11/08 23:40:01 mbalmer Exp $
d14 4
d87 10
@


1.81
log
@Bump package name.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.80 2005/11/08 15:20:42 mbalmer Exp $
d11 1
a11 1
PKGNAME-docs=	postgresql-docs-${VERSION}p0
@


1.80
log
@Update to PostgreSQL 8.1.0

Detailed information can be found at http://www.postgresql.org/docs/whatsnew
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.77 2005/05/11 10:10:39 mbalmer Exp $
d9 3
a11 3
FULLPKGNAME=	postgresql-client-${VERSION}
PKGNAME-server=	postgresql-server-${VERSION}
PKGNAME-docs=	postgresql-docs-${VERSION}
@


1.79
log
@Update to PostgreSQL 8.0.4.
@
text
@d7 1
a7 1
VERSION=	8.0.4
@


1.78
log
@conflicts from the past: history since 3.7.

As noted on ports@@ recently, pkg_add -r relies on conflicts, and the
sheer existence of updates means we MUST take the past into account in
conflicts now.

Note the renaming of hugs98 to valid package names where versions are
concerned.

This commit shows clearly the renaming of the xfce4 plugin packages, the
ditching of eclipse flavors, the splitting of nessus into subpackages,
the splitting of various other software documentations, some packaging bugs
in kdeedu, and a lot of files moving around...

okay pvalchev@@
@
text
@d7 1
a7 1
VERSION=	8.0.3
d11 1
a11 1
PKGNAME-docs=	postgresql-docs-${VERSION}p0
d77 1
a77 1
LIB_DEPENDS=	pq.3:postgresql-client-${VERSION}:databases/postgresql
@


1.78.2.1
log
@Security update to PostgreSQL 8.0.7

fixes CVE-2006-0678
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.78 2005/08/16 09:49:51 espie Exp $
d7 1
a7 1
VERSION=	8.0.7
d11 1
a11 1
PKGNAME-docs=	postgresql-docs-${VERSION}
@


1.78.2.2
log
@fix packaging, noticed by brad
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.78.2.1 2006/02/15 22:20:32 sturm Exp $
d9 1
a9 1
FULLPKGNAME=	postgresql-client-${VERSION}p0
d11 1
a11 1
PKGNAME-docs=	postgresql-docs-${VERSION}p0
@


1.78.2.3
log
@Security update to postgresql-8.0.8

Fixes SQL-injection attacks. (CVE-2006-2313, CVE-2006-2314)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.78.2.2 2006/02/17 22:20:56 sturm Exp $
d7 1
a7 1
VERSION=	8.0.8
d9 1
a9 1
FULLPKGNAME=	postgresql-client-${VERSION}
d11 1
a11 1
PKGNAME-docs=	postgresql-docs-${VERSION}
@


1.78.2.4
log
@update to postgresql  8.0.9, turns out this fixes several bugs that
could cause DoS
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.78.2.3 2006/05/24 17:50:12 sturm Exp $
d7 1
a7 1
VERSION=	8.0.9
@


1.77
log
@Security update to version 8.0.3

ok robert@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.71 2005/01/02 00:23:28 alek Exp $
d11 1
a11 1
PKGNAME-docs=	postgresql-docs-${VERSION}
@


1.76
log
@WANTLIB tweaks

ok alek@@
@
text
@d7 1
a7 1
VERSION=	8.0.2
@


1.75
log
@Update to PostgreSQL 8.0.2 and take maintainerhsip with the old maintainers
consent.

ok nikolay@@, todd@@
@
text
@d24 1
a24 1
WANTLIB=		c crypto curses m readline ssl util z
@


1.74
log
@remove Peter Galbavy as maintainer per his request
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.73 2005/04/06 06:23:46 sturm Exp $
d7 1
a7 1
VERSION=	7.4.3
d9 3
a11 3
FULLPKGNAME=	postgresql-client-${VERSION}p2
PKGNAME-server=	postgresql-server-${VERSION}p2
PKGNAME-docs=	postgresql-docs-${VERSION}p1
d17 1
a17 1
MAINTAINER=	Brandon Palmer <bpalmer@@crimelabs.net>
d19 2
a20 1
PERMIT_PACKAGE_CDROM=	"without fee clause"
d22 1
a22 1
PERMIT_DISTFILES_CDROM=	"without fee clause"
a43 1
CONFIGURE_ENV=	LIBS=-lcurses
a47 1
		--with-includes=/usr/include/kerberosV \
d52 2
a53 1
		--docdir="${PREFIX}/share/doc/postgresql"
d56 1
a56 1
CONFIGURE_ARGS+=--with-krb5=/usr/lib
a58 1

d69 1
a69 1
INSTALL_TARGET=	install install-all-headers
@


1.73
log
@fix kerberos support (from Jesse Kempf <kempf at rpi.edu>) and
mention to start the server with nohup to prevent a signal race (from mpf@@)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.72 2005/02/05 15:11:58 sturm Exp $
d17 1
a17 2
MAINTAINER=	Brandon Palmer <bpalmer@@crimelabs.net>, \
		Peter Galbavy <peter.galbavy@@knowtion.net>
@


1.72
log
@SECURITY fix

This patch fixes a problem where low privileged users can invoke the
LOAD extension to load arbitrary libraries into the postgres process
space.

ok peter.galbavy at knowtion.net
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.71 2005/01/02 00:23:28 alek Exp $
d9 2
a10 2
FULLPKGNAME=	postgresql-client-${VERSION}p1
PKGNAME-server=	postgresql-server-${VERSION}p1
a47 5
.if ${KERBEROS5} == "yes"
POSTGRES_KRB5_LIBS=--with-krb5=/usr
POSTGRES_KRB5_INCLUDES=/usr/include/kerberosV
.endif

d49 2
a50 1
		--with-includes=${POSTGRES_KRB5_LIBS} --with-perl \
d55 5
@


1.72.2.1
log
@MFC:
fix kerberos support (from Jesse Kempf <kempf at rpi.edu> and mention
to start the server with nohup to prevent a signal race (from mpf@@)

ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.72 2005/02/05 15:11:58 sturm Exp $
d9 2
a10 2
FULLPKGNAME=	postgresql-client-${VERSION}p2
PKGNAME-server=	postgresql-server-${VERSION}p2
d48 5
d54 1
a54 2
		--with-includes=/usr/include/kerberosV \
		--with-perl \
a58 4

.if ${KERBEROS5} == "yes"
CONFIGURE_ARGS+=--with-krb5=/usr/lib
.endif
@


1.72.2.2
log
@update to porstgresql 7.4.11, fixing several bugs and security issues
CVE-2005-{0977,0227,0244,0245,0246,0247,1409,1410}
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.72.2.1 2005/06/06 20:43:03 sturm Exp $
d7 1
a7 1
VERSION=	7.4.11
d9 3
a11 3
FULLPKGNAME=	postgresql-client-${VERSION}
PKGNAME-server=	postgresql-server-${VERSION}
PKGNAME-docs=	postgresql-docs-${VERSION}
d24 1
a24 1
WANTLIB=		c com_err crypto curses m readline ssl util z
@


1.72.2.3
log
@Security update to PostgreSQL version 7.4.12

this fixes CVE-2006-0678
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.72.2.2 2006/02/07 21:08:28 sturm Exp $
d7 1
a7 1
VERSION=	7.4.12
@


1.72.2.4
log
@fix packaging, noticed by brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.72.2.3 2006/02/15 21:09:43 sturm Exp $
d9 1
a9 1
FULLPKGNAME=	postgresql-client-${VERSION}p0
d11 1
a11 1
PKGNAME-docs=	postgresql-docs-${VERSION}p0
@


1.71
log
@- Fix libpq soname
- Rework WANTLIB as this port has SUBPACKAGES
- Replace RUN_DEPENDS with LIB_DEPENDS
- Add PKG_ARCH
- Bump PKGNAME

ok sturm@@, Brandon Palmer (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.70 2004/11/22 16:59:29 espie Exp $
d9 3
a11 3
FULLPKGNAME=	postgresql-client-${VERSION}p0
PKGNAME-server=	postgresql-server-${VERSION}p0
PKGNAME-docs=	postgresql-docs-${VERSION}p0
@


1.70
log
@WANTLIB markers
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.69 2004/07/26 10:10:46 peter Exp $
d9 3
a11 3
FULLPKGNAME=	postgresql-client-${VERSION}
PKGNAME-server=	postgresql-server-${VERSION}
PKGNAME-docs=	postgresql-docs-${VERSION}
d24 1
a24 1
WANTLIB=		c crypto curses m perl readline ssl util z
d72 11
a82 2
.if ${SUBPACKAGE} == "-server"
RUN_DEPENDS=    :postgresql-client-${VERSION}:databases/postgresql
@


1.69
log
@Update to PostgreSQL 7.4.3

Changes in the package layout means that there is now a -client and
-server subpackage, and users no longer need to decide which, as
the -server depends on the -client, just like the sane cases in
mysql and openldap.

Other changes include:

* Removal of the tcl FLAVOR until someone with more tcl/tk knowledge
can make it work correctly.

* The INSTALL-server script now created a _postgresql user and group
if they don't already exist, and also a default database in
/var/postgresql if that directory also doesn't exist.

* The port is marked for NO_SHARED_ARCHS as the -server subpackage
needs shared lib support to build.

* The port will build with spinlocks disabled on hppa until someone
can check and test this problem more closely.

Built and checked on i386, sparc64, amd64, macppc (waiting for regress
test feedback).

Dependent packages will be updated after this commit, shortly.
@
text
@d1 1
a1 1
# $OpenBSD$
d24 1
@


1.69.2.1
log
@MFC:

SECURITY fix

This patch fixes a problem where low privileged users can invoke the
LOAD extension to load arbitrary libraries into the postgres process
space.

ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.69 2004/07/26 10:10:46 peter Exp $
d9 3
a11 3
FULLPKGNAME=	postgresql-client-${VERSION}p1
PKGNAME-server=	postgresql-server-${VERSION}p1
PKGNAME-docs=	postgresql-docs-${VERSION}p1
@


1.69.2.2
log
@MFC:
fix kerberos support (from Jesse Kempf <kempf at rpi.edu> and mention
to start the server with nohup to prevent a signal race (from mpf@@)

same diff as for 3.7
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.69.2.1 2005/02/05 21:55:23 sturm Exp $
d9 2
a10 2
FULLPKGNAME=	postgresql-client-${VERSION}p2
PKGNAME-server=	postgresql-server-${VERSION}p2
d47 5
d53 1
a53 2
		--with-includes=/usr/include/kerberosV \
		--with-perl \
a57 4

.if ${KERBEROS5} == "yes"
CONFIGURE_ARGS+=--with-krb5=/usr/lib
.endif
@


1.68
log
@mark some subpackages arch independent

ok naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.67 2003/12/23 19:40:32 brad Exp $
d3 2
a4 3
COMMENT=	"PostgreSQL RDBMS"
COMMENT-tcl=	"PostgreSQL RDBMS tcl libraries and utilities"
COMMENT-clients="PostgreSQL RDBMS client libraries and utilities"
d7 1
a7 1
VERSION=	7.3.5
d9 2
a10 1
PKGNAME-clients=postgresql-clients-${VERSION}
d12 1
a12 1
PKGNAME-tcl=	postgresql-tcl-${VERSION}
a19 1
# BSD
d25 2
a26 7
MASTER_SITES=	\
	ftp://ftp.us.postgresql.org/source/v${VERSION}/ \
	ftp://ftp.au.postgresql.org/pub/postgresql/source/v${VERSION}/ \
	ftp://ftp.at.postgresql.org/db/www.postgresql.org/pub/source/v${VERSION}/ \
	ftp://ftp.cl.postgresql.org/pub/GNU/pgsql/source/v${VERSION}/ \
	ftp://ftp.cz.postgresql.org/pub/ftp.postgresql.org/source/v${VERSION}/ \
	ftp://ftp.dk.postgresql.org/mirrors/postgresql/source/v${VERSION}/
d28 2
a29 2
PSEUDO_FLAVORS=	tcl
FLAVOR?=
d31 5
a35 2
MULTI_PACKAGES=	-clients -docs
SUBPACKAGE?=
d44 10
a53 1
CONFIGURE_ARGS=	--disable-rpath \
d59 8
d71 4
a88 1
	${WRKSRC}/register.txt \
a89 25

# For tcl
.if ${FLAVOR:L:Mtcl}
MULTI_PACKAGES+= -tcl

TCL_INCDIR=     ${LOCALBASE}/include/tcl8.3
TK_INCDIR=      ${LOCALBASE}/include/tk8.3
CONFIGURE_ENV+= WISH="${LOCALBASE}/bin/wish8.3"
CONFIGURE_ARGS+= --with-tcl \
        --with-tclconfig="${LOCALBASE}/lib/tcl8.3 ${LOCALBASE}/lib/tk8.3" \
        --with-includes="${TCL_INCDIR} ${TK_INCDIR} ${LOCALBASE}/include"
BUILD_DEPENDS+=   tk83::x11/tk/8.3

. if defined(PACKAGING)
.  if ${SUBPACKAGE} == "-tcl"
RUN_DEPENDS=	::databases/postgresql
LIB_DEPENDS+=   tk83::x11/tk/8.3
.  endif
. endif
.else
CONFIGURE_ARGS+= --without-tcl
.endif
.if defined(PACKAGING) && ${SUBPACKAGE} == "-docs"
PKG_ARCH=	*
.endif
@


1.68.2.1
log
@MFC:

SECURITY fix

This patch fixes a problem where low privileged users can invoke the
LOAD extension to load arbitrary libraries into the postgres process
space.

ok brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.68 2004/02/04 07:39:18 sturm Exp $
d10 3
a12 4
PKGNAME=	${DISTNAME}p1
PKGNAME-clients=postgresql-clients-${VERSION}p1
PKGNAME-docs=	postgresql-docs-${VERSION}p1
PKGNAME-tcl=	postgresql-tcl-${VERSION}p1
@


1.67
log
@upgrade to PostgreSQL 7.3.5
--
ok MAINTAINER (Peter Galbavy)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.66 2003/11/11 15:11:34 margarida Exp $
d94 3
@


1.66
log
@Security fix:
Two bugs were discovered that lead to a buffer overflow in PostgreSQL
in the abstract data type (ADT) to ASCII conversion functions.
It is believed that, under the right circumstances, an attacker may use
this vulnerability to execute arbitrary instructions on the PostgreSQL
server.

ok Brandon Palmer (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.65 2003/05/20 13:52:00 lebel Exp $
d8 1
a8 1
VERSION=	7.3.2
d10 3
a12 3
PKGNAME-clients=postgresql-clients-${VERSION}p1
PKGNAME-docs=	postgresql-docs-${VERSION}p1
PKGNAME-tcl=	postgresql-tcl-${VERSION}p1
d20 1
@


1.65
log
@PERMIT_*_CDROM can't be Yes:

The license says:

Permission to use, copy, modify, and distribute this software and its
documentation for any purpose, without fee, and without a written agreement
is hereby granted, provided that the above copyright notice and this
paragraph and the following two paragraphs appear in all copies.

noticed by markus@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.64 2003/02/12 17:09:03 naddy Exp $
d10 3
a12 3
PKGNAME-clients=postgresql-clients-${VERSION}
PKGNAME-docs=	postgresql-docs-${VERSION}
PKGNAME-tcl=	postgresql-tcl-${VERSION}
@


1.65.2.1
log
@Security fix:
Two bugs were discovered that lead to a buffer overflow in PostgreSQL
in the abstract data type (ADT) to ASCII conversion functions.
It is believed that, under the right circumstances, an attacker may use
this vulnerability to execute arbitrary instructions on the PostgreSQL
server.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.65 2003/05/20 13:52:00 lebel Exp $
d10 3
a12 3
PKGNAME-clients=postgresql-clients-${VERSION}p1
PKGNAME-docs=	postgresql-docs-${VERSION}p1
PKGNAME-tcl=	postgresql-tcl-${VERSION}p1
@


1.65.2.2
log
@Forgot to bump one package.. sigh
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.65.2.1 2003/11/11 15:13:26 margarida Exp $
a9 1
PKGNAME=	${DISTNAME}p1
@


1.64
log
@Update to 7.3.2.  Change flavor no_tcl -> tcl.
From: Peter Galbavy <peter.galbavy@@knowtion.net>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.63 2003/01/08 21:33:21 todd Exp $
d20 1
a20 1
PERMIT_PACKAGE_CDROM=	Yes
d22 1
a22 1
PERMIT_DISTFILES_CDROM=	Yes
@


1.64.2.1
log
@Security fix:
Two bugs were discovered that lead to a buffer overflow in PostgreSQL
in the abstract data type (ADT) to ASCII conversion functions.
It is believed that, under the right circumstances, an attacker may use
this vulnerability to execute arbitrary instructions on the PostgreSQL
server.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.64 2003/02/12 17:09:03 naddy Exp $
d10 3
a12 3
PKGNAME-clients=postgresql-clients-${VERSION}p1
PKGNAME-docs=	postgresql-docs-${VERSION}p1
PKGNAME-tcl=	postgresql-tcl-${VERSION}p1
@


1.64.2.2
log
@Bump package (forgot in last commit..)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.64.2.1 2003/11/11 15:12:40 margarida Exp $
a9 1
PKGNAME=	${DISTNAME}p1
@


1.63
log
@add no_tcl flavor, for those not building all of ports,
not wanting to install x to have a database; from brad@@,
prodded by Ben Lindstrom
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62 2003/01/03 14:24:55 todd Exp $
d8 1
a8 1
VERSION=	7.3
d33 1
a33 1
PSEUDO_FLAVORS=	no_tcl
d74 1
a74 3
.if ${FLAVOR:L:Mno_tcl}
CONFIGURE_ARGS+= --without-tcl
.else
d91 2
@


1.62
log
@PKGNAME-tcl= .. from naddy@@ .. thanks!
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.61 2003/01/02 14:48:23 todd Exp $
d33 4
a36 1
MULTI_PACKAGES=	-clients -docs -tcl
d74 4
d84 1
a84 1
        --with-includes="${LOCALBASE}/include ${TCL_INCDIR} ${TK_INCDIR}"
d87 2
a88 2
.if defined(PACKAGING)
. if ${SUBPACKAGE} == "-tcl"
d91 1
@


1.61
log
@build depends on tcl too
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.60 2003/01/02 07:15:34 todd Exp $
d12 1
@


1.60
log
@add tcl multi-package to postgresql
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59 2002/12/18 05:13:15 brad Exp $
d77 1
@


1.59
log
@sloppy update. this port used to install ALL the headers for a good reason.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2002/12/17 16:38:53 naddy Exp $
d4 1
d32 1
a32 1
MULTI_PACKAGES=	-clients -docs
d68 16
@


1.58
log
@Update to 7.3.
From: Peter Galbavy <peter.galbavy@@knowtion.net>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.57 2002/05/19 23:39:57 brad Exp $
d48 2
@


1.57
log
@remove sourceforge URL
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2002/03/25 03:18:20 brad Exp $
d7 1
a7 1
VERSION=	7.1.3
d10 1
a10 1
FULLPKGNAME-docs=postgresql-docs-${VERSION}
a11 1
NEED_VERSION=	1.435
d15 2
a16 1
MAINTAINER=	Brandon Palmer <bpalmer@@crimelabs.net>, Peter Galbavy <peter.galbavy@@knowtion.net>
d24 6
a29 18
		ftp://ftp.digex.net/pub/packages/database/postgresql/v${VERSION}/ \
		ftp://postgresql.readysetnet.com/pub/postgresql/v${VERSION}/ \
		ftp://ftp.crimelabs.net/pub/postgresql/v${VERSION}/ \
		ftp://www.ndesign.com.ua/pub/psql/v${VERSION}/ \
		ftp://looking-glass.usask.ca/pub/postgresql/v${VERSION}/ \
		ftp://ftp.iodynamics.com/pub/mirror/postgresql/v${VERSION}/ \
		ftp://postgresql.rmplc.co.uk/pub/postgresql/v${VERSION}/ \
		ftp://ftp.fhl.net/pub/postgresql/v${VERSION}/ \
		ftp://ftp.sunet.se/pub/unix/databases/relational/postgresql/v${VERSION}/ \
		ftp://postgresql.godzone.net.nz/postgresql/v${VERSION}/ \
		ftp://linux.sarang.net/mirror/database/postgresql/v${VERSION}/ \
		ftp://ring.asahi-net.or.jp/pub/misc/db/postgresql/v${VERSION}/ \
		ftp://ftp.postgreSQL.uli.it/pub/v${VERSION}/ \
		ftp://ftp.fr.postgresql.org/pub/v${VERSION}/ \
		ftp://postgresql.matrix.fi/pub/v${VERSION}/

FLAVORS=	tcl odbc no_locale no_ssl # perl
FLAVOR?=
d41 3
a43 3
CONFIGURE_ARGS=	--enable-syslog \
		--disable-rpath \
		--with-CXX \
d47 1
a47 46
MODGNU_CONFIG_GUESS_DIRS=	${WRKSRC} ${WRKSRC}/config

.if ${FLAVOR:L:Mtcl}
LIB_DEPENDS+=	tk83::x11/tk/8.3
TCL_INCDIR=	${LOCALBASE}/include/tcl8.3
TK_INCDIR=	${LOCALBASE}/include/tk8.3
CONFIGURE_ENV+=	WISH="${LOCALBASE}/bin/wish8.3"
CONFIGURE_ARGS+= --with-tcl \
	--with-tclconfig="${LOCALBASE}/lib/tcl8.3 ${LOCALBASE}/lib/tk8.3" \
	--with-includes="${LOCALBASE}/include ${TCL_INCDIR} ${TK_INCDIR}"
.endif

.if ${FLAVOR:L:Modbc}
LIB_DEPENDS+=	iodbc::databases/iodbc
CONFIGURE_ARGS+=--enable-odbc --with-odbcinst="${SYSCONFDIR}"
.endif

# This does not work yet. The Pg module Makefile do not follow the fake
# install scheme properly. The best bet if you need this is to go with
# either a direct install of the Pg modules from CPAN, look out for a
# p5-Pg package or use the DBI interface - Peter
.if ${FLAVOR:L:Mperl}
CONFIGURE_ARGS+= --with-perl
.endif

.if ${FLAVOR:L:Mno_ssl}
CONFIGURE_ARGS+= --without-openssl
.else
CONFIGURE_ARGS+= --with-openssl="/usr"
.endif

.if ${FLAVOR:L:Mno_locale}
CONFIGURE_ARGS+= --disable-locale --disable-recode
.else
CONFIGURE_ARGS+= --enable-locale --enable-recode
DOCS+=		${WRKSRC}/doc/README.mb.big5 ${WRKSRC}/doc/README.mb.jp
.endif

.if ${FLAVOR:L:Mtcl}
post-patch:
	@@mv ${WRKSRC}/src/bin/pgaccess/main.tcl \
		${WRKSRC}/src/bin/pgaccess/main.tcl.orig
	@@sed -e "s=wish=${LOCALBASE}/bin/wish8.3=" \
		${WRKSRC}/src/bin/pgaccess/main.tcl.orig \
		> ${WRKSRC}/src/bin/pgaccess/main.tcl
.endif
d49 10
a58 1
INSTALL_TARGET=	install install-all-headers
d60 1
a60 1
DOCS+=	${WRKSRC}/COPYRIGHT ${WRKSRC}/HISTORY \
d62 1
a73 14

.if ${FLAVOR:L:Mtcl} && !defined(NO_SHARED_LIBS)
SED_PLIST+=-e '/%%SHARED-tcl%%/r${PKGDIR}/PFRAG.tcl.shared' -e '//d'
.elif ${FLAVOR:L:Mtcl} && defined(NO_SHARED_LIBS) && \
	${NO_SHARED_LIBS:L} == "yes"
SED_PLIST+=-e '/%%SHARED-tcl%%/d'
.endif

.if ${FLAVOR:L:Modbc} && !defined(NO_SHARED_LIBS)
SED_PLIST+=-e '/%%SHARED-odbc%%/r${PKGDIR}/PFRAG.odbc.shared' -e '//d'
.elif ${FLAVOR:L:Modbc} && defined(NO_SHARED_LIBS) && \
	${NO_SHARED_LIBS:L} == "yes"
SED_PLIST+=-e '/%%SHARED-odbc%%/d'
.endif
@


1.56
log
@install ALL headers
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55 2002/01/11 18:56:34 brad Exp $
a23 1
		ftp://download.sourceforge.net/pub/mirrors/postgresql/v${VERSION}/ \
@


1.55
log
@YUCK! ftp.postgresql.org is rate limited to 1KB/sec per user so remove it.
--
Pointed out by: Jedi/Sector One <j@@pureftpd.org>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.54 2001/09/27 05:45:34 pvalchev Exp $
d106 2
@


1.54
log
@fill MODGNU_CONFIG_GUESS_DIRS; for powerpc
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2001/09/07 22:48:47 peter Exp $
a23 2
                ftp://ftp.postgresql.org/pub/v${VERSION}/ \
		ftp://ftp.crimelabs.net/pub/postgresql/v${VERSION}/ \
d27 1
@


1.53
log
@update my e-mail address
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.52 2001/09/03 23:24:37 brad Exp $
d60 2
@


1.52
log
@upgrade to PostgreSQL 7.1.3
--
Based on patches from: maintainer
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 2001/08/23 16:29:55 peter Exp $
d16 1
a16 1
MAINTAINER=	Brandon Palmer <bpalmer@@crimelabs.net>, Peter Galbavy <peter.galbavy@@knowledge.com>
@


1.51
log
@add missing '/' to rmplc.co.uk mirror site
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2001/08/07 13:25:50 brad Exp $
d7 1
a7 1
VERSION=	7.1.2
d12 1
a12 1
NEED_VERSION=	1.427
d48 4
a89 8
## making
MAKE_FILE=	GNUmakefile

DOCS=		${WRKSRC}/COPYRIGHT ${WRKSRC}/HISTORY \
		${WRKSRC}/INSTALL ${WRKSRC}/README \
		${WRKSRC}/register.txt \
		${WRKSRC}/doc/FAQ ${WRKSRC}/doc/FAQ_DEV ${WRKSRC}/doc/TODO

a96 2
SUBST_VARS=	VERSION

d106 5
d130 1
a130 1
        ${NO_SHARED_LIBS:L} == "yes"
@


1.50
log
@- PKGNAME -> FULLPKGNAME for -docs subpackage, FLAVORs do not apply here
- .else if -> .elif
- remove unnecessary symlinks used on "other" ELF-based systems which were
intentionally removed awhile back
--
Ok'd by: Brandon Palmer <bpalmer@@crimelabs.net>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2001/07/25 08:16:46 peter Exp $
d32 1
a32 1
		ftp://postgresql.rmplc.co.uk/pub/postgresqlv${VERSION}/ \
@


1.49
log
@update to PostgreSQL 7.1.2

All the hard work (apart from a small amount of testing) is by
Brandon Palmer <bpalmer@@crimelabs.net>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2001/04/23 21:58:44 espie Exp $
d10 1
a10 1
PKGNAME-docs=	postgresql-docs-${VERSION}
d123 2
a124 2
.else if ${FLAVOR:L:Mtcl} && defined(NO_SHARED_LIBS) && \
	${NO_SHARED_LIBS:U} == YES
d130 2
a131 2
.else if ${FLAVOR:L:Modbc} && defined(NO_SHARED_LIBS) && \
        ${NO_SHARED_LIBS:U} == YES
@


1.48
log
@Patches to fix dynamic libraries, especially on ppc which understands
only major/minor.

Add DYNLIBDIR where needed.

Some style issues.

From peter@@, brad@@ and peter_e@@gmx.net
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2001/04/21 18:25:42 peter Exp $
d5 1
a5 1
COMMENT-docs=	"PostgreSQL RDBMS documentaion"
d7 1
a7 1
VERSION=	7.1
d12 1
a12 1
NEED_VERSION=	1.405
@


1.47
log
@Upgrade to postgresql 7.1. ok'd espie@@

* The package is now called `postgresql' and not `pgsql'.

* The default user that is suggested for the admin account is also
  `postgresql'. This will work with OpenBSD-current with long username
  support. If anything breaks please report to the maintainers.

* pgwrap is no longer shipped or supported

* Please note, you will HAVE TO BACKUP your old data if you are
  upgrading from a previous release of postgresql. Do this before
  removing the old pgsql package.

From the announcement last weekend:

Key New Features and Capabilities of Version 7.1 Include:

* Write-ahead Log (WAL) increases data integrity and processing
speed. To maintain database consistency in case of an operating
system crash, previous releases of PostgreSQL have forced all all
data modifications to disk before each transaction commit. With
WAL, only one log file must be flushed to disk, greatly improving
performance. (Tech note: can eliminate use of -F in to disable disk
flushes)

* TOAST (The Oversized-Attribute Storage Technique) Past releases
had compiled-in row length limit typically between 8Kb & 32Kb. This
restriction made storage of long text fields difficult, cumbersome
and slow. TOAST enables rows of any length while maintaing the high
performance PostgreSQL users have come to expect.

* SQL92 Outer Joins are now supported. (Tech note: eliminates the
UNION/NOT IN workaround)

* 64-bit C Language Function Manager support The previous C function
manager did not handle support 64-bit CPU's (e.g. Alpha, Sun,
Itanium). (Tech note: This change should not impact existing custom
functions developed for past versions, but performance will be
improved through rewriting to use the new call interface.)

* Complex Queries that are better, stronger and faster Many complex
queries were unsupported in previous releases. With v7.1 combinations
of views, aggregates, UNION, LIMIT, cursors, subqueries, and inherited
tables are enabled. Inherited tables are now accessed by default,
and subqueries in FROM are now supported.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2001/03/10 19:27:15 brad Exp $
d9 2
a41 1

a47 6
.if ${SUBPACKAGE}	== "-clients"
PKGNAME:=	postgresql-clients-${VERSION}
.elif ${SUBPACKAGE}	== "-docs"
PKGNAME:=	postgresql-docs-${VERSION}
.endif

d50 1
a50 1
CONFIGURE_ENV=	POSTGRESDIR="${PREFIX}" LIBS=-lcurses
d54 1
a54 1
		--datadir="${PREFIX}/share/examples/postgresql" \
a64 2
MAKE_ENV=	USE_TCL=true TCL_INCDIR="${TCL_INCDIR}" \
		TK_INCDIR="${TK_INCDIR}"
d69 1
a69 1
CONFIGURE_ARGS+=--enable-odbc --with-odbcinst=/etc
d80 2
a81 2
.if !${FLAVOR:L:Mno_ssl}
CONFIGURE_ARGS+= --with-openssl=/etc
d83 1
a83 1
CONFIGURE_ARGS+= --without-openssl
a87 1
FAKE_FLAGS=	POSTGRESDIR="${WRKINST}${PREFIX}"
d94 3
a96 1
.if !${FLAVOR:L:Mno_locale}
a114 1
	@@rm -f ${WRKBUILD}/README.OpenBSD
a117 3
	@@cd ${WRKSRC}/doc && \
		${MAKE_PROGRAM} PGDOCS="${PREFIX}/share/doc/postgresql" all
	${INSTALL_DATA} ${WRKSRC}/doc/*.ps* ${PREFIX}/share/doc/postgresql
@


1.46
log
@- integrate COMMENT's
- bump NEED_VERSION
- use PKGNAME-foo instead of overriding PKGNAME
- fixup INSTALL/DEINSTALL
- takeover as MAINTAINER until Pavel has a working e-mail address that
doesn't bounce.
@
text
@a1 1
# $FreeBSD: Makefile,v 1.25 1998/04/22 08:28:07 asami Exp $
d4 2
a5 2
COMMENT-clients="PostgreSQL RDBMS clients"
COMMENT-docs=	"PostgreSQL RDBMS documentation"
d7 1
a7 1
VERSION=	7.0.3
a8 3
PKGNAME=	pgsql-${VERSION}
PKGNAME-clients=pgsql-clients-${VERSION}
PKGNAME-docs=	pgsql-docs-${VERSION}
d10 1
a10 1
NEED_VERSION=	1.384
d14 1
a14 2
#MAINTAINER=	Pavel Korovin <pvk@@openbsd.ru>
MAINTAINER=	Brad Smith <brad@@openbsd.org>
d21 18
a38 49
MASTER_SITES=	ftp://ftp.postgresql.org/pub/%SUBDIR%/ \
	ftp://gd.tuwien.ac.at/db/www.postgresql.org/pub/%SUBDIR%/ \
	ftp://ftp.cwb.fnn.net/pub/Linux/postgresql/%SUBDIR%/ \
	ftp://looking-glass.usask.ca/pub/postgresql/%SUBDIR%/ \
	ftp://linux.netfirm.net/pub/Linux/PostgreSQL/%SUBDIR%/ \
	ftp://sunsite.uniandes.edu.co/pub/postgresql/%SUBDIR%/ \
	ftp://ftp.fi.muni.cz/pub/postgresql/%SUBDIR%/ \
	ftp://ftp.sunsite.auc.dk/mirrors/www.postgresql.org/%SUBDIR%/ \
	ftp://postgresql.matrix.fi/%SUBDIR%/ \
	ftp://ftp.fr.postgresql.org/%SUBDIR%/ \
	ftp://ftp.de.postgresql.org/%SUBDIR%/ \
	ftp://ftp.ntua.gr/pub/databases/postgresql/%SUBDIR%/ \
	ftp://ftp.postgreSQL.uli.it/%SUBDIR%/ \
	ftp://mirror.nucba.ac.jp/mirror/postgresql/pub/%SUBDIR%/ \
	ftp://ring.ip-kyoto.ad.jp/pub/misc/db/postgresql/%SUBDIR%/ \
	ftp://ring.crl.go.jp/pub/misc/db/postgresql/%SUBDIR%/ \
	ftp://ring.saitama-u.ac.jp/pub/misc/db/postgresql/%SUBDIR%/ \
	ftp://ring.astem.or.jp/pub/misc/db/postgresql/%SUBDIR%/ \
	ftp://ring.exp.fujixerox.co.jp/pub/misc/db/postgresql/%SUBDIR%/ \
	ftp://ring.jah.ne.jp/pub/misc/db/postgresql/%SUBDIR%/ \
	ftp://ring.etl.go.jp.jp/pub/misc/db/postgresql/%SUBDIR%/ \
	ftp://ring.asahi-net.or.jp/pub/misc/db/postgresql/%SUBDIR%/ \
	ftp://ring.so-net.ne.jp/pub/misc/db/postgresql/%SUBDIR%/ \
	ftp://ring.aist.go.jp/pub/misc/db/postgresql/%SUBDIR%/ \
	ftp://jordan.ce.yeungnam.ac.kr/pub/postgresql/%SUBDIR%/ \
	ftp://ftp.kr.postgresql.org/pub/postgresql/%SUBDIR%/ \
	ftp://postgresql.linux.com.mx/pub/postgresql/pub/%SUBDIR%/ \
	ftp://postgresql.godzone.net.nz/postgresql/%SUBDIR%/ \
	ftp://postgresql.iphil.net/%SUBDIR%/ \
	ftp://ftp.sai.msu.su/unix/database/pgsql/%SUBDIR%/ \
	ftp://www.sk.postgresql.org/pub/linux/postgresql/%SUBDIR%/ \
	ftp://ftp.linux.co.za/pub/postgresql/%SUBDIR%/ \
	ftp://ftp.sunet.se/pub/unix/databases/relational/postgresql/%SUBDIR%/ \
	ftp://ftp.danyk.ch/postgres/%SUBDIR%/ \
	ftp://ftp.ccit.edu.tw/packages/postgresql/%SUBDIR%/ \
	ftp://ftp.siamu.ac.th/pub/pub2/ftp.postgresql.org/%SUBDIR%/ \
	ftp://postgresql.rmplc.co.uk/pub/postgresql/%SUBDIR%/ \
	ftp://ftp.scyph.org/pub/Mirrors/ftp.postgresql.org/%SUBDIR%/ \
	ftp://mars.capital-data.com/pub/postgresql/%SUBDIR%/ \
	ftp://ftp.digex.net/pub/packages/database/postgresql/%SUBDIR%/ \
	ftp://ftp.iodynamics.com/pub/mirror/postgresql/%SUBDIR%/ \
	ftp://postgresql.nextpath.com/pub/postgresql/%SUBDIR%/ \
	ftp://www.ndesign.com.ua/pub/psql/%SUBDIR%/ \
	ftp://postgresql.netafric.ci/%SUBDIR%/
MASTER_SITE_SUBDIR= v${VERSION}
DIST_SUBDIR=	postgresql
DISTFILES= ${DISTNAME}.base.tar.gz \
	${DISTNAME}.support.tar.gz \
	${DISTNAME}.docs.tar.gz
d40 2
a41 1
FLAVORS=	tcl odbc
d47 4
a50 4
## build dependencies
USE_GMAKE= Yes
.if ${FLAVOR:L:Mtcl}
LIB_DEPENDS=	tk83::x11/tk/8.3
d53 8
a60 6
## configuring
CONFIGURE_STYLE= simple
CONFIGURE_ENV=	POSTGRESDIR="${PREFIX}"
CONFIGURE_ARGS= --prefix="${PREFIX}" \
	--enable-locale --enable-multibyte --enable-recode \
	--with-template="openbsd" --with-libraries="${LOCALBASE}/lib"
d63 1
d66 1
a66 2
CONFIGURE_ENV+=	WISH="${LOCALBASE}/bin/wish8.3" \
		PGACCESS_HOME="${PREFIX}/lib/pgsql"
d70 7
a76 2
.else
CONFIGURE_ARGS+= --with-includes="${LOCALBASE}/include"
d79 12
a90 2
. if ${FLAVOR:L:Modbc}
CONFIGURE_ARGS+= --with-odbc
d97 8
a104 5
.if ${FLAVOR:L:Mtcl}
MAKE_ENV=	USE_TCL=true TCL_INCDIR="${TCL_INCDIR}" \
		TK_INCDIR="${TK_INCDIR}" \
		PGACCESS_HOME="${PREFIX}/lib/pgsql"
FAKE_FLAGS+=	PGACCESS_HOME="${WRKINST}/${PREFIX}/lib/pgsql"
a106 11
DOCDIR=		${WRKSRC}/../doc
DOCS=		${WRKSRC}/../COPYRIGHT ${WRKSRC}/../HISTORY \
		${WRKSRC}/../INSTALL ${WRKSRC}/../README \
		${WRKSRC}/../register.txt \
		${DOCDIR}/FAQ ${DOCDIR}/FAQ_DEV ${DOCDIR}/README.Charsets \
		${DOCDIR}/README.fsync ${DOCDIR}/README.inet \
		${DOCDIR}/README.locale ${DOCDIR}/README.mb \
		${DOCDIR}/README.mb.jp ${DOCDIR}/TODO \

WRKDIST=	${WRKDIR}/${DISTNAME}/src

d111 2
a112 2
	@@mv ${WRKSRC}/bin/pgaccess/main.tcl \
		${WRKSRC}/bin/pgaccess/main.tcl.orig
d114 2
a115 2
		${WRKSRC}/bin/pgaccess/main.tcl.orig \
		> ${WRKSRC}/bin/pgaccess/main.tcl
a117 5
post-build:
	@@mkdir -p ${WRKBUILD}/pgwrap
	@@cp ${FILESDIR}/{Makefile,pgwrap.c,pgwrap.h} ${WRKBUILD}/pgwrap
	@@cd ${WRKBUILD}/pgwrap && ${MAKE} depend && ${MAKE}

d119 2
a120 4
	${INSTALL_PROGRAM} ${WRKBUILD}/pgwrap/pgwrap ${PREFIX}/bin
	@@cd ${DOCDIR} && ${MAKE_PROGRAM} POSTGRESDIR="${PREFIX}" man
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/pgsql
	${INSTALL_DATA} ${DOCS} ${PREFIX}/share/doc/pgsql
d124 4
a127 3
	${INSTALL_DATA} ${WRKBUILD}/README.OpenBSD ${PREFIX}/share/doc/pgsql
	@@cd ${DOCDIR} && ${MAKE_PROGRAM} PGDOCS="${PREFIX}/share/doc/pgsql" all
	${INSTALL_DATA} ${DOCDIR}/*.ps* ${PREFIX}/share/doc/pgsql
d137 1
@


1.45
log
@do not hardcode path of /usr/local
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2001/03/10 16:56:54 brad Exp $
d4 4
d11 2
d14 1
a14 1
NEED_VERSION=	1.356
d18 2
a19 1
MAINTAINER=	Pavel Korovin <pvk@@openbsd.ru>
d83 1
a83 1
USE_GMAKE=	Yes
a161 6

.if ${SUBPACKAGE} == "-clients"
PKGNAME:=	pgsql-clients-${VERSION}
.elif ${SUBPACKAGE} == "-docs"
PKGNAME:=	pgsql-docs-${VERSION}
.endif
@


1.44
log
@move -clients SUBPACKAGE check to after including bsd.port.mk.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2001/03/05 19:36:22 brad Exp $
d147 4
a150 1
	${INSTALL_DATA} ${FILESDIR}/README.OpenBSD ${PREFIX}/share/doc/pgsql
@


1.43
log
@remove redundant dependency
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2001/02/23 02:41:00 brad Exp $
a73 3
.if ${SUBPACKAGE} == "-clients"
PKGNAME:=pgsql-clients-${VERSION}
.endif
d153 4
a156 2
.if ${SUBPACKAGE} == "-docs"
PKGNAME:=pgsql-docs-${VERSION}
@


1.42
log
@upgrade to 7.0.3 blew away the RCS ids.
@
text
@d1 1
a1 1
# $OpenBSD$
d81 1
a81 1
LIB_DEPENDS=    tcl83::lang/tcl/8.3 tk83::x11/tk/8.3
@


1.41
log
@one small ${PREFIX} -> ${LOCALBASE} change
@
text
@d1 3
@


1.40
log
@upgrade to postgresql 7.0.3
@
text
@d86 1
a86 1
	--with-template="openbsd" --with-libraries="${PREFIX}/lib"
@


1.39
log
@add odbc flavor
@
text
@d1 1
a1 4
# $OpenBSD: Makefile,v 1.38 2000/10/22 18:46:02 espie Exp $
# $FreeBSD: Makefile,v 1.25 1998/04/22 08:28:07 asami Exp $

VERSION=	7.0.2
d3 1
d5 1
a5 50
NEED_VERSION=	1.320
MASTER_SITES=	ftp://ftp.postgresql.org/pub/%SUBDIR%/ \
		ftp://gd.tuwien.ac.at/db/www.postgresql.org/pub/%SUBDIR%/ \
		ftp://ftp.cwb.fnn.net/pub/Linux/postgresql/%SUBDIR%/ \
		ftp://looking-glass.usask.ca/pub/postgresql/%SUBDIR%/ \
		ftp://linux.netfirm.net/pub/Linux/PostgreSQL/%SUBDIR%/ \
		ftp://sunsite.uniandes.edu.co/pub/postgresql/%SUBDIR%/ \
		ftp://ftp.fi.muni.cz/pub/postgresql/%SUBDIR%/ \
		ftp://ftp.sunsite.auc.dk/mirrors/www.postgresql.org/%SUBDIR%/ \
		ftp://postgresql.matrix.fi/%SUBDIR%/ \
		ftp://ftp.fr.postgresql.org/%SUBDIR%/ \
		ftp://ftp.de.postgresql.org/%SUBDIR%/ \
		ftp://ftp.ntua.gr/pub/databases/postgresql/%SUBDIR%/ \
		ftp://ftp.postgreSQL.uli.it/%SUBDIR%/ \
		ftp://mirror.nucba.ac.jp/mirror/postgresql/pub/%SUBDIR%/ \
		ftp://ring.ip-kyoto.ad.jp/pub/misc/db/postgresql/%SUBDIR%/ \
		ftp://ring.crl.go.jp/pub/misc/db/postgresql/%SUBDIR%/ \
		ftp://ring.saitama-u.ac.jp/pub/misc/db/postgresql/%SUBDIR%/ \
		ftp://ring.astem.or.jp/pub/misc/db/postgresql/%SUBDIR%/ \
		ftp://ring.exp.fujixerox.co.jp/pub/misc/db/postgresql/%SUBDIR%/ \
		ftp://ring.jah.ne.jp/pub/misc/db/postgresql/%SUBDIR%/ \
		ftp://ring.etl.go.jp.jp/pub/misc/db/postgresql/%SUBDIR%/ \
		ftp://ring.asahi-net.or.jp/pub/misc/db/postgresql/%SUBDIR%/ \
		ftp://ring.so-net.ne.jp/pub/misc/db/postgresql/%SUBDIR%/ \
		ftp://ring.aist.go.jp/pub/misc/db/postgresql/%SUBDIR%/ \
		ftp://jordan.ce.yeungnam.ac.kr/pub/postgresql/%SUBDIR%/ \
		ftp://ftp.kr.postgresql.org/pub/postgresql/%SUBDIR%/ \
		ftp://postgresql.linux.com.mx/pub/postgresql/pub/%SUBDIR%/ \
		ftp://postgresql.godzone.net.nz/postgresql/%SUBDIR%/ \
		ftp://postgresql.iphil.net/%SUBDIR%/ \
		ftp://ftp.sai.msu.su/unix/database/pgsql/%SUBDIR%/ \
		ftp://www.sk.postgresql.org/pub/linux/postgresql/%SUBDIR%/ \
		ftp://ftp.linux.co.za/pub/postgresql/%SUBDIR%/ \
		ftp://ftp.sunet.se/pub/unix/databases/relational/postgresql/%SUBDIR%/ \
		ftp://ftp.danyk.ch/postgres/%SUBDIR%/ \
		ftp://ftp.ccit.edu.tw/packages/postgresql/%SUBDIR%/ \
		ftp://ftp.siamu.ac.th/pub/pub2/ftp.postgresql.org/%SUBDIR%/ \
		ftp://postgresql.rmplc.co.uk/pub/postgresql/%SUBDIR%/ \
		ftp://ftp.scyph.org/pub/Mirrors/ftp.postgresql.org/%SUBDIR%/ \
		ftp://mars.capital-data.com/pub/postgresql/%SUBDIR%/ \
		ftp://ftp.digex.net/pub/packages/database/postgresql/%SUBDIR%/ \
		ftp://ftp.iodynamics.com/pub/mirror/postgresql/%SUBDIR%/ \
		ftp://postgresql.nextpath.com/pub/postgresql/%SUBDIR%/ \
		ftp://www.ndesign.com.ua/pub/psql/%SUBDIR%/ \
		ftp://postgresql.netafric.ci/%SUBDIR%/
MASTER_SITE_SUBDIR= v${VERSION}
DISTFILES=	postgresql-${VERSION}.base.tar.gz \
		postgresql-${VERSION}.support.tar.gz \
		postgresql-${VERSION}.docs.tar.gz
DIST_SUBDIR=	postgresql
d16 49
a64 1
FAKE_FLAGS=	POSTGRESDIR="${WRKINST}${PREFIX}/pgsql"
d66 1
a66 8
USE_GMAKE=	yes
MAKE_FILE=	GNUmakefile
CONFIGURE_STYLE= simple
CONFIGURE_ARGS= --prefix="${PREFIX}/pgsql" --enable-locale \
		--with-template="openbsd" --with-libraries="${PREFIX}/lib"
CONFIGURE_ENV=	POSTGRESDIR="${PREFIX}/pgsql"

FLAVORS=	odbc tcl
d69 1
a69 1
MULTI_PACKAGES=	-docs
d71 16
a88 1
LIB_DEPENDS=	tcl83::lang/tcl/8.3 tk83::x11/tk/8.3
d91 2
a92 1
MAKE_ENV=	USE_TCL=true TCL_INCDIR="${TCL_INCDIR}" TK_INCDIR="${TK_INCDIR}"
d94 2
a95 2
		--with-tclconfig="${LOCALBASE}/lib/tcl8.3 ${LOCALBASE}/lib/tk8.3" \
		--with-includes="${LOCALBASE}/include ${TCL_INCDIR} ${TK_INCDIR}"
d100 1
a100 1
.if ${FLAVOR:L:Modbc}
d104 11
a115 1

d118 1
a118 1
		${WRKSRC}/../README.OpenBSD ${WRKSRC}/../register.txt \
d122 1
a122 1
		${DOCDIR}/README.mb.jp ${DOCDIR}/TODO
d124 1
a124 4
PGUSER=		pgsql
PGBIN=		${PREFIX}/pgsql/bin
PGLIB=		${PREFIX}/pgsql/lib
PGDATA=		/var/pgsql/data
d126 1
a126 1
WRKDIST=	${WRKDIR}/${DISTNAME}/src
d139 1
a139 8
	@@cp ${FILESDIR}/{pgwrap.c,pgwrap.h} ${WRKBUILD}/pgwrap
	@@sed -e "s,@@PGUSER@@,${PGUSER},g" -e "s,@@PGBIN@@,${PGBIN},g" \
		-e "s,@@PGLIB@@,${PGLIB},g" -e "s,@@PGDATA@@,${PGDATA},g" \
		-e "s,@@PREFIX@@,${PREFIX},g" < ${FILESDIR}/Makefile.in \
		> ${WRKBUILD}/pgwrap/Makefile
	@@sed -e "s,@@PREFIX@@,${PREFIX},g" \
		< ${FILESDIR}/README.OpenBSD.in \
		> ${WRKSRC}/../README.OpenBSD
d144 1
a144 1
	@@cd ${DOCDIR} && ${MAKE_PROGRAM} POSTGRESDIR="${PREFIX}/pgsql" man
d147 1
d154 1
a154 1
PKGNAME:=postgresql-docs-${VERSION}
d162 6
@


1.38
log
@Update pvk MAINTAINER name.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2000/09/11 06:38:45 brad Exp $
d76 1
a76 1
FLAVORS=	tcl
d92 4
@


1.37
log
@don't need to specify --srcdir
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2000/08/25 21:12:44 brad Exp $
d60 1
a60 1
MAINTAINER=	pvk@@openbsd.ru
@


1.36
log
@- ${PREFIX} -> ${LOCALBASE}
- remove unnecessary sub-shell
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2000/08/25 15:34:13 brad Exp $
d73 1
a73 2
		--with-template=openbsd --with-libraries="${PREFIX}/lib" \
		--srcdir="${WRKSRC}"
@


1.35
log
@- fixup Makefile
- replace docs FLAVOR with a -docs sub-package
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2000/07/01 18:10:37 form Exp $
d90 1
a90 1
		--with-includes="${PREFIX}/include ${TCL_INCDIR} ${TK_INCDIR}"
d92 1
a92 1
CONFIGURE_ARGS+= --with-includes="${PREFIX}/include"
d123 1
a123 1
	@@cp ${FILESDIR}/pgwrap.c ${FILESDIR}/pgwrap.h ${WRKBUILD}/pgwrap
d131 1
a131 1
	(cd ${WRKBUILD}/pgwrap; ${MAKE} depend && ${MAKE})
@


1.34
log
@@@exec /sbin/ldconfig -> DYNLIBDIR
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2000/06/28 13:18:45 espie Exp $
d4 2
a5 2
DISTNAME=	postgresql-${VERS}
DIST_SUBDIR=	postgresql
d7 1
a7 13
NEED_VERSION=	1.310

HOMEPAGE=	http://www.postgresql.org

MAINTAINER=	pvk@@openbsd.ru

PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes

VERS=		7.0.2

d52 9
a60 1
MASTER_SITE_SUBDIR=	v${VERS}
d62 4
a65 3
DISTFILES=	postgresql-${VERS}.base${EXTRACT_SUFX} \
		postgresql-${VERS}.support${EXTRACT_SUFX} \
		postgresql-${VERS}.docs${EXTRACT_SUFX}
d67 11
a77 1
FLAVORS=tcl docs
d80 3
d87 6
a92 2
MAKE_ENV+=	USE_TCL=true TCL_INCDIR=${TCL_INCDIR} TK_INCDIR=${TK_INCDIR}
WITH_TCL=	--with-tcl --with-tclconfig="${LOCALBASE}/lib/tcl8.3 ${LOCALBASE}/lib/tk8.3"
a94 12
WRKDIST=	${WRKDIR}/${DISTNAME}/src

USE_GMAKE=	yes
MAKE_FILE=	GNUmakefile
HAS_CONFIGURE=	Yes
CONFIGURE_ENV+=	POSTGRESDIR="${PREFIX}/pgsql"
CONFIGURE_ARGS= --prefix=${PREFIX}/pgsql --enable-locale \
		--with-template=openbsd \
		--with-includes="${PREFIX}/include ${TCL_INCDIR} \
		${TK_INCDIR}" ${WITH_TCL} --with-libraries=${PREFIX}/lib \
		--srcdir=${WRKSRC}

d99 2
a100 4
		${WRKSRC}/../README.OpenBSD ${WRKSRC}/../register.txt

.if ${FLAVOR:L:Mdocs}
DOCS+=		${DOCDIR}/FAQ ${DOCDIR}/FAQ_DEV ${DOCDIR}/README.Charsets \
a103 3
.endif

FAKE_FLAGS=	POSTGRESDIR=${WRKINST}${PREFIX}/pgsql
d110 2
d135 1
a135 1
	@@cd ${DOCDIR} && ${MAKE_PROGRAM} POSTGRESDIR=${PREFIX}/pgsql man
d138 1
a138 2
.if ${FLAVOR:L:Mdocs}
	@@cd ${DOCDIR} && ${MAKE_PROGRAM} PGDOCS=${PREFIX}/share/doc/pgsql all
a139 1
.endif
d142 4
@


1.33
log
@Kill PLIST.sed
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2000/06/07 03:38:12 form Exp $
d7 1
a7 1
NEED_VERSION=	1.302
@


1.32
log
@upgrade to 7.0.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2000/05/24 04:23:21 form Exp $
d7 1
a7 3
NEED_VERSION=	1.251

FAKE=		Yes
@


1.31
log
@fix MASTER_SITE_SUBDIR; naddy@@mips.inka.de
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2000/05/23 16:31:41 form Exp $
d20 1
a20 1
VERS=		7.0
@


1.30
log
@new postgresql 7.0 port from pvk@@openbsd.ru
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2000/04/09 17:36:14 espie Exp $
d66 1
a66 1
MASTER_SITE_SUBDIR=	${VERS}
@


1.29
log
@explicit FAKE=No, so that we can turn FAKE on by default.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2000/03/27 18:17:27 espie Exp $
d4 2
a5 1
DISTNAME=	postgresql-6.5.3
d7 1
a7 2
NEED_VERSION=	1.230
FAKE=No
d9 5
a13 1
MAINTAINER=	form@@OpenBSD.ORG
a14 1
LICENSE_TYPE=		BSD
d20 61
a80 56
MASTER_SITES=	ftp://ftp.postgresql.org/pub/ \
		ftp://gd.tuwien.ac.at/db/www.postgresql.org/pub/ \
		ftp://ftp.cwb.fnn.net/pub/Linux/postgresql/ \
		ftp://looking-glass.usask.ca/pub/postgresql/ \
		ftp://linux.netfirm.net/pub/Linux/PostgreSQL/ \
		ftp://sunsite.uniandes.edu.co/pub/postgresql/ \
		ftp://ftp.fi.muni.cz/pub/postgresql/ \
		ftp://ftp.sunsite.auc.dk/mirrors/www.postgresql.org/ \
		ftp://postgresql.matrix.fi/ \
		ftp://ftp.fr.postgresql.org/ \
		ftp://ftp.de.postgresql.org/ \
		ftp://ftp.ntua.gr/pub/databases/postgresql/ \
		ftp://ftp.postgreSQL.uli.it/ \
		ftp://mirror.nucba.ac.jp/mirror/postgresql/pub/ \
		ftp://ring.ip-kyoto.ad.jp/pub/misc/db/postgresql/ \
		ftp://ring.crl.go.jp/pub/misc/db/postgresql/ \
		ftp://ring.saitama-u.ac.jp/pub/misc/db/postgresql/ \
		ftp://ring.astem.or.jp/pub/misc/db/postgresql/ \
		ftp://ring.exp.fujixerox.co.jp/pub/misc/db/postgresql/ \
		ftp://ring.jah.ne.jp/pub/misc/db/postgresql/ \
		ftp://ring.etl.go.jp.jp/pub/misc/db/postgresql/ \
		ftp://ring.asahi-net.or.jp/pub/misc/db/postgresql/ \
		ftp://ring.so-net.ne.jp/pub/misc/db/postgresql/ \
		ftp://ring.aist.go.jp/pub/misc/db/postgresql/ \
		ftp://jordan.ce.yeungnam.ac.kr/pub/postgresql/ \
		ftp://ftp.kr.postgresql.org/pub/postgresql/ \
		ftp://postgresql.linux.com.mx/pub/postgresql/pub/ \
		ftp://postgresql.godzone.net.nz/postgresql/ \
		ftp://postgresql.iphil.net/ \
		ftp://ftp.sai.msu.su/unix/database/pgsql/ \
		ftp://www.sk.postgresql.org/pub/linux/postgresql/ \
		ftp://ftp.linux.co.za/pub/postgresql/ \
		ftp://ftp.sunet.se/pub/unix/databases/relational/postgresql/ \
		ftp://ftp.danyk.ch/postgres/ \
		ftp://ftp.ccit.edu.tw/packages/postgresql/ \
		ftp://ftp.siamu.ac.th/pub/pub2/ftp.postgresql.org/ \
		ftp://postgresql.rmplc.co.uk/pub/postgresql/ \
		ftp://ftp.scyph.org/pub/Mirrors/ftp.postgresql.org/ \
		ftp://mars.capital-data.com/pub/postgresql/ \
		ftp://ftp.digex.net/pub/packages/database/postgresql/ \
		ftp://ftp.iodynamics.com/pub/mirror/postgresql/ \
		ftp://postgresql.nextpath.com/pub/postgresql/ \
		ftp://www.ndesign.com.ua/pub/psql/ \
		ftp://postgresql.netafric.ci/

# if you want to use the tcl/tk frontend pgaccess, then you need to build
# postgresql with tcl support by typing: make USE_TCL=yes
.if defined(USE_TCL) && ${USE_TCL:U} == "YES"
TCL_INCDIR=	${LOCALBASE}/include/tcl8.0
TK_INCDIR=	${LOCALBASE}/include/tk8.0
MAKE_ENV=	USE_TCL=true TCL_INCDIR=${TCL_INCDIR} TK_INCDIR=${TK_INCDIR}
LIB_DEPENDS=	tcl80::lang/tcl/8.0 tk80::x11/tk/8.0
WITH_TCL=	--with-tcl --with-tclconfig="${LOCALBASE}/lib/tcl8.0 ${LOCALBASE}/lib/tk8.0"
PKGNAME=	${DISTNAME}-tcl
.else
PKGNAME=	${DISTNAME}
d83 2
d87 4
a90 4
HAS_CONFIGURE=	yes
CONFIGURE_ARGS= --prefix=${PREFIX}/pgsql \
		--enable-locale \
		--with-template=`uname -s | tr '[A-Z]' '[a-z]'` \
d92 2
a93 1
		${TK_INCDIR}" ${WITH_TCL} --with-libraries=${PREFIX}/lib
d95 1
a95 1
WRKDIST=		${WRKDIR}/${DISTNAME}/src
d97 10
a106 1
PLIST=		${WRKDIR}/PLIST
d108 1
a108 1
INSTALL_TARGET= install install-man
d115 1
a115 16
post-configure:
.if defined(USE_TCL) && ${USE_TCL:U} == "YES"
	@@if [ x"${NO_SHARED_LIBS}" = "x" ]; then \
		cp ${PKGDIR}/PLIST.tcl ${WRKDIR}/PLIST; \
	else \
		cp ${PKGDIR}/PLIST.tcl.noshared ${WRKDIR}/PLIST; \
	fi
.else
	@@if [ x"${NO_SHARED_LIBS}" = "x" ]; then \
		cp ${PKGDIR}/PLIST ${WRKDIR}/PLIST; \
	else \
		cp ${PKGDIR}/PLIST.noshared ${WRKDIR}/PLIST; \
	fi
.endif

.if defined(USE_TCL) && ${USE_TCL:U} == "YES"
d119 1
a119 1
	@@sed -e "s=wish=${LOCALBASE}/bin/wish8.0=" \
d124 3
a126 3
pre-build:
	@@mkdir -p ${WRKSRC}/pgwrap
	@@cp ${FILESDIR}/pgwrap.c ${FILESDIR}/pgwrap.h ${WRKSRC}/pgwrap
d130 1
a130 1
		> ${WRKSRC}/pgwrap/Makefile
d133 2
a134 5
		> ${WRKSRC}/../doc/README.OpenBSD
	(cd ${WRKSRC}/pgwrap; ${MAKE} depend && ${MAKE})

pre-install:
	${INSTALL_DATA_DIR} ${PREFIX}/pgsql
d137 2
a138 3
	@@rmdir ${PREFIX}/pgsql/include/port/bsd
	@@rmdir ${PREFIX}/pgsql/include/port
	${INSTALL_PROGRAM} ${WRKSRC}/pgwrap/pgwrap ${PREFIX}/bin
d140 5
a144 7
	${INSTALL_DATA} ${WRKSRC}/../doc/FAQ* ${PREFIX}/share/doc/pgsql
	${INSTALL_DATA} ${WRKSRC}/../doc/README* ${PREFIX}/share/doc/pgsql
	${INSTALL_DATA} ${WRKSRC}/../doc/TODO* ${PREFIX}/share/doc/pgsql
	${INSTALL_DATA} ${WRKSRC}/../doc/*ps.gz ${PREFIX}/share/doc/pgsql
	${INSTALL_DATA} ${WRKSRC}/../INSTALL ${PREFIX}/share/doc/pgsql
	@@${LDCONFIG} -m ${PREFIX}/pgsql/lib
	@@PKG_PREFIX="${PREFIX}" ${SH} ${PKGDIR}/INSTALL ${DISTNAME} POST-INSTALL
d147 7
@


1.29.2.1
log
@bring databases as of cut-over date into 2.7 branch
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2000/07/01 18:10:37 form Exp $
d4 1
a4 2
DISTNAME=	postgresql-${VERS}
DIST_SUBDIR=	postgresql
d6 2
a7 1
NEED_VERSION=	1.310
d9 1
a9 3
HOMEPAGE=	http://www.postgresql.org

MAINTAINER=	pvk@@openbsd.ru
d11 1
d17 56
a72 61
VERS=		7.0.2

MASTER_SITES=	ftp://ftp.postgresql.org/pub/%SUBDIR%/ \
		ftp://gd.tuwien.ac.at/db/www.postgresql.org/pub/%SUBDIR%/ \
		ftp://ftp.cwb.fnn.net/pub/Linux/postgresql/%SUBDIR%/ \
		ftp://looking-glass.usask.ca/pub/postgresql/%SUBDIR%/ \
		ftp://linux.netfirm.net/pub/Linux/PostgreSQL/%SUBDIR%/ \
		ftp://sunsite.uniandes.edu.co/pub/postgresql/%SUBDIR%/ \
		ftp://ftp.fi.muni.cz/pub/postgresql/%SUBDIR%/ \
		ftp://ftp.sunsite.auc.dk/mirrors/www.postgresql.org/%SUBDIR%/ \
		ftp://postgresql.matrix.fi/%SUBDIR%/ \
		ftp://ftp.fr.postgresql.org/%SUBDIR%/ \
		ftp://ftp.de.postgresql.org/%SUBDIR%/ \
		ftp://ftp.ntua.gr/pub/databases/postgresql/%SUBDIR%/ \
		ftp://ftp.postgreSQL.uli.it/%SUBDIR%/ \
		ftp://mirror.nucba.ac.jp/mirror/postgresql/pub/%SUBDIR%/ \
		ftp://ring.ip-kyoto.ad.jp/pub/misc/db/postgresql/%SUBDIR%/ \
		ftp://ring.crl.go.jp/pub/misc/db/postgresql/%SUBDIR%/ \
		ftp://ring.saitama-u.ac.jp/pub/misc/db/postgresql/%SUBDIR%/ \
		ftp://ring.astem.or.jp/pub/misc/db/postgresql/%SUBDIR%/ \
		ftp://ring.exp.fujixerox.co.jp/pub/misc/db/postgresql/%SUBDIR%/ \
		ftp://ring.jah.ne.jp/pub/misc/db/postgresql/%SUBDIR%/ \
		ftp://ring.etl.go.jp.jp/pub/misc/db/postgresql/%SUBDIR%/ \
		ftp://ring.asahi-net.or.jp/pub/misc/db/postgresql/%SUBDIR%/ \
		ftp://ring.so-net.ne.jp/pub/misc/db/postgresql/%SUBDIR%/ \
		ftp://ring.aist.go.jp/pub/misc/db/postgresql/%SUBDIR%/ \
		ftp://jordan.ce.yeungnam.ac.kr/pub/postgresql/%SUBDIR%/ \
		ftp://ftp.kr.postgresql.org/pub/postgresql/%SUBDIR%/ \
		ftp://postgresql.linux.com.mx/pub/postgresql/pub/%SUBDIR%/ \
		ftp://postgresql.godzone.net.nz/postgresql/%SUBDIR%/ \
		ftp://postgresql.iphil.net/%SUBDIR%/ \
		ftp://ftp.sai.msu.su/unix/database/pgsql/%SUBDIR%/ \
		ftp://www.sk.postgresql.org/pub/linux/postgresql/%SUBDIR%/ \
		ftp://ftp.linux.co.za/pub/postgresql/%SUBDIR%/ \
		ftp://ftp.sunet.se/pub/unix/databases/relational/postgresql/%SUBDIR%/ \
		ftp://ftp.danyk.ch/postgres/%SUBDIR%/ \
		ftp://ftp.ccit.edu.tw/packages/postgresql/%SUBDIR%/ \
		ftp://ftp.siamu.ac.th/pub/pub2/ftp.postgresql.org/%SUBDIR%/ \
		ftp://postgresql.rmplc.co.uk/pub/postgresql/%SUBDIR%/ \
		ftp://ftp.scyph.org/pub/Mirrors/ftp.postgresql.org/%SUBDIR%/ \
		ftp://mars.capital-data.com/pub/postgresql/%SUBDIR%/ \
		ftp://ftp.digex.net/pub/packages/database/postgresql/%SUBDIR%/ \
		ftp://ftp.iodynamics.com/pub/mirror/postgresql/%SUBDIR%/ \
		ftp://postgresql.nextpath.com/pub/postgresql/%SUBDIR%/ \
		ftp://www.ndesign.com.ua/pub/psql/%SUBDIR%/ \
		ftp://postgresql.netafric.ci/%SUBDIR%/
MASTER_SITE_SUBDIR=	v${VERS}

DISTFILES=	postgresql-${VERS}.base${EXTRACT_SUFX} \
		postgresql-${VERS}.support${EXTRACT_SUFX} \
		postgresql-${VERS}.docs${EXTRACT_SUFX}

FLAVORS=tcl docs
FLAVOR?=

.if ${FLAVOR:L:Mtcl}
LIB_DEPENDS=	tcl83::lang/tcl/8.3 tk83::x11/tk/8.3
TCL_INCDIR=	${LOCALBASE}/include/tcl8.3
TK_INCDIR=	${LOCALBASE}/include/tk8.3
MAKE_ENV+=	USE_TCL=true TCL_INCDIR=${TCL_INCDIR} TK_INCDIR=${TK_INCDIR}
WITH_TCL=	--with-tcl --with-tclconfig="${LOCALBASE}/lib/tcl8.3 ${LOCALBASE}/lib/tk8.3"
a74 2
WRKDIST=	${WRKDIR}/${DISTNAME}/src

d77 4
a80 4
HAS_CONFIGURE=	Yes
CONFIGURE_ENV+=	POSTGRESDIR="${PREFIX}/pgsql"
CONFIGURE_ARGS= --prefix=${PREFIX}/pgsql --enable-locale \
		--with-template=openbsd \
d82 1
a82 2
		${TK_INCDIR}" ${WITH_TCL} --with-libraries=${PREFIX}/lib \
		--srcdir=${WRKSRC}
d84 1
a84 1
DOCDIR=		${WRKSRC}/../doc
d86 1
a86 10
DOCS=		${WRKSRC}/../COPYRIGHT ${WRKSRC}/../HISTORY \
		${WRKSRC}/../INSTALL ${WRKSRC}/../README \
		${WRKSRC}/../README.OpenBSD ${WRKSRC}/../register.txt

.if ${FLAVOR:L:Mdocs}
DOCS+=		${DOCDIR}/FAQ ${DOCDIR}/FAQ_DEV ${DOCDIR}/README.Charsets \
		${DOCDIR}/README.fsync ${DOCDIR}/README.inet \
		${DOCDIR}/README.locale ${DOCDIR}/README.mb \
		${DOCDIR}/README.mb.jp ${DOCDIR}/TODO
.endif
d88 1
a88 1
FAKE_FLAGS=	POSTGRESDIR=${WRKINST}${PREFIX}/pgsql
d95 16
a110 1
.if ${FLAVOR:L:Mtcl}
d114 1
a114 1
	@@sed -e "s=wish=${LOCALBASE}/bin/wish8.3=" \
d119 3
a121 3
post-build:
	@@mkdir -p ${WRKBUILD}/pgwrap
	@@cp ${FILESDIR}/pgwrap.c ${FILESDIR}/pgwrap.h ${WRKBUILD}/pgwrap
d125 1
a125 1
		> ${WRKBUILD}/pgwrap/Makefile
d128 5
a132 2
		> ${WRKSRC}/../README.OpenBSD
	(cd ${WRKBUILD}/pgwrap; ${MAKE} depend && ${MAKE})
d135 3
a137 2
	${INSTALL_PROGRAM} ${WRKBUILD}/pgwrap/pgwrap ${PREFIX}/bin
	@@cd ${DOCDIR} && ${MAKE_PROGRAM} POSTGRESDIR=${PREFIX}/pgsql man
d139 7
a145 5
	${INSTALL_DATA} ${DOCS} ${PREFIX}/share/doc/pgsql
.if ${FLAVOR:L:Mdocs}
	@@cd ${DOCDIR} && ${MAKE_PROGRAM} PGDOCS=${PREFIX}/share/doc/pgsql all
	${INSTALL_DATA} ${DOCDIR}/*.ps* ${PREFIX}/share/doc/pgsql
.endif
a147 7

.if ${FLAVOR:L:Mtcl} && !defined(NO_SHARED_LIBS)
SED_PLIST+=-e '/%%SHARED-tcl%%/r${PKGDIR}/PFRAG.tcl.shared' -e '//d'
.else if ${FLAVOR:L:Mtcl} && defined(NO_SHARED_LIBS) && \
	${NO_SHARED_LIBS:U} == YES
SED_PLIST+=-e '/%%SHARED-tcl%%/d'
.endif
@


1.28
log
@Fix tcl/tk 8.0 and 8.3 dependencies...

tcl/tk 8.2 still needs to be updated to 8.3 to fully clean up that mess.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2000/03/24 23:28:04 espie Exp $
d7 1
@


1.27
log
@Introduce :: in *_DEPENDS as a place holder for a package spec
Bump NEED_VERSION.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2000/03/05 18:30:24 espie Exp $
d6 1
a6 1
NEED_VERSION=	 1.230
d67 1
a67 1
LIB_DEPENDS=	tcl80::lang/tcl80 tk80::x11/tk80
@


1.26
log
@PORTSDIR no longer needed in *DEPENDS.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2000/02/22 17:08:38 espie Exp $
d6 1
a6 1
NEED_VERSION=	1.223
d67 1
a67 1
LIB_DEPENDS=	tcl80:lang/tcl80 tk80:x11/tk80
@


1.25
log
@MAKEFILE-> MAKE_FILE
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2000/02/15 05:04:09 turan Exp $
d6 1
a6 2

NEED_VERSION=	1.210
d11 4
a14 4
PERMIT_PACKAGE_CDROM=	YES
PERMIT_PACKAGE_FTP=	YES
PERMIT_DISTFILES_CDROM=	YES
PERMIT_DISTFILES_FTP=	YES
d67 1
a67 1
LIB_DEPENDS=	tcl80:${PORTSDIR}/lang/tcl80 tk80:${PORTSDIR}/x11/tk80
@


1.24
log
@espie will not shut up about this, DISTF -> DISTFILES, PKG -> PACKAGE
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2000/02/12 06:29:51 turan Exp $
d7 1
a7 1
NEED_VERSION=	1.191
d76 1
a76 1
MAKEFILE=	GNUmakefile
@


1.23
log
@bsd licenses
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2000/02/11 01:10:01 espie Exp $
d12 4
a15 4
PERMIT_PKG_CDROM=	YES
PERMIT_PKG_FTP=		YES
PERMIT_DISTF_CDROM=	YES
PERMIT_DISTF_FTP=	YES
@


1.22
log
@Kill a large set of deprecated variables.
Thoroughly unsubtle, most mkdir -p should probably be INSTALL* at
*install stage, and echo/ECHO_MSG is somewhat unsorted.

It's quite possible I missed a few automated changes...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2000/02/11 00:37:20 espie Exp $
d10 6
@


1.21
log
@Use WRKDIST where appropriate.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 1999/12/09 02:57:07 form Exp $
d74 1
a74 1
		--with-template=`uname -s | ${TR} '[A-Z]' '[a-z]'` \
d92 1
a92 1
		${CP} ${PKGDIR}/PLIST.tcl ${WRKDIR}/PLIST; \
d94 1
a94 1
		${CP} ${PKGDIR}/PLIST.tcl.noshared ${WRKDIR}/PLIST; \
d98 1
a98 1
		${CP} ${PKGDIR}/PLIST ${WRKDIR}/PLIST; \
d100 1
a100 1
		${CP} ${PKGDIR}/PLIST.noshared ${WRKDIR}/PLIST; \
d106 1
a106 1
	@@${MV} ${WRKSRC}/bin/pgaccess/main.tcl \
d108 1
a108 1
	@@${SED} -e "s=wish=${LOCALBASE}/bin/wish8.0=" \
d114 3
a116 3
	@@${MKDIR} ${WRKSRC}/pgwrap
	@@${CP} ${FILESDIR}/pgwrap.c ${FILESDIR}/pgwrap.h ${WRKSRC}/pgwrap
	@@${SED} -e "s,@@PGUSER@@,${PGUSER},g" -e "s,@@PGBIN@@,${PGBIN},g" \
d120 1
a120 1
	@@${SED} -e "s,@@PREFIX@@,${PREFIX},g" \
d129 2
a130 2
	@@${RMDIR} ${PREFIX}/pgsql/include/port/bsd
	@@${RMDIR} ${PREFIX}/pgsql/include/port
@


1.20
log
@pgwrap: missing ')' in comment.
Makefile: .if defined(USE_TCL) -> .if defined(USE_TCL) && ${USE_TCL:U} == "YES"
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 1999/12/07 11:47:47 form Exp $
d7 1
a7 1
NEED_VERSION=	1.64
d78 1
a78 1
WRKSRC=		${WRKDIR}/${DISTNAME}/src
@


1.19
log
@Use different package names for PostgreSQL and PostgreSQL with TCL/Tk.
Fix PLIST for postgresql-tcl.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 1999/12/07 08:26:41 form Exp $
d58 1
a58 1
.if defined(USE_TCL) || defined(USE_TK)
d90 1
a90 1
.if defined(USE_TCL) || defined(USE_TK)
d104 1
a104 1
.if defined(USE_TCL) || defined(USE_TK)
@


1.18
log
@ldconfig
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 1999/12/07 05:09:41 form Exp $
d64 3
d75 2
a76 2
		--with-includes="${PREFIX}/include ${TCL_INCDIR} ${TK_INCDIR}" ${WITH_TCL} \
		--with-libraries=${PREFIX}/lib
d102 9
@


1.17
log
@Update to 6.5.3.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 1999/11/11 02:24:29 kevlo Exp $
d126 1
@


1.16
log
@Update to version 6.5.2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 1999/08/18 02:43:45 angelos Exp $
d4 1
a4 1
DISTNAME=	postgresql-6.5.2
d54 1
a54 1
		ftp://postgresql.netafric.ci/ \
@


1.15
log
@Mark as broken for now, lots of versions have gone by since 6.3.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 1999/04/01 06:20:06 brad Exp $
d4 1
a4 1
DISTNAME=	postgresql-6.3.2
a6 2
BROKEN=		"Version 6.5.1 is out, time someone updated this"

a7 3
NO_PACKAGE=	"Requires pgsql uid"

MAINTAINER=	ports@@openbsd.org
d9 1
a9 1
MASTER_SITES=	ftp://ftp.postgresql.org/pub/
d11 53
a63 10
# openbsd yacc fails with: /usr/bin/yacc: f - maximum table size exceeded
# so use bison
#
BUILD_DEPENDS=	bison:${PORTSDIR}/devel/bison

.if defined(USE_TCL)
MAKE_ENV=	USE_TCL=true TCL_INCDIR=${PREFIX}/include/tcl8.0
LIB_DEPENDS=	tcl80:${PORTSDIR}/lang/tcl80 \
		tk80:${PORTSDIR}/x11/tk80
WITH_TCL=	--with-tcl
d66 1
a66 5
DBPREFIX=	/var/db

WRKSRC=		${WRKDIR}/${DISTNAME}/src

USE_GMAKE=	YES
d68 1
a68 1
HAS_CONFIGURE=	YES
d72 2
a73 2
		--with-includes=/usr/local/include ${WITH_TCL} \
		--with-libraries=/usr/local/lib
d75 18
a92 6
# Spit this message out right away.
#
pre-build:
.if !defined(USE_TCL)
	@@${ECHO_MSG} "To build the \"PostgreSQL to Tcl interface library\", libpgtcl, type:"
	@@${ECHO_MSG} "    make USE_TCL=yes"
d94 5
a98 1
	@@${ECHO_MSG} "Building PostgreSQL with \"libpgtcl\"."
d101 12
d114 1
a114 5
.if defined(PACKAGE_BUILDING)
	/bin/rm -rf ${PREFIX}/pgsql
.endif
	@@ ${MKDIR} ${PREFIX}/pgsql
	@@ ${SETENV} ${MAKE_ENV} perl ${SCRIPTDIR}/createuser
d117 10
a126 44
	@@ if [ ! -f ${PREFIX}/pgsql/.profile ]; then \
		${ECHO} "PATH=${PATH}:${PREFIX}/pgsql/bin" \
			> ${PREFIX}/pgsql/.profile; \
		${ECHO} "MANPATH=${MANPATH}:${PREFIX}/pgsql/man" \
			>> ${PREFIX}/pgsql/.profile; \
		${ECHO} "PGLIB=${PREFIX}/pgsql/lib" \
			>> ${PREFIX}/pgsql/.profile; \
		${ECHO} "# note: PGDATA overwrites the -D startup option" \
			>> ${PREFIX}/pgsql/.profile; \
		${ECHO} "PGDATA=${DBPREFIX}/pgsql/data" \
			>> ${PREFIX}/pgsql/.profile; \
		${ECHO} "DISPLAY=:0" \
			>> ${PREFIX}/pgsql/.profile; \
		${ECHO} "export PATH MANPATH PGLIB PGDATA DISPLAY" \
			>> ${PREFIX}/pgsql/.profile; \
		${ECHO} "# if you want to make regression tests use this TZ" \
			>> ${PREFIX}/pgsql/.profile; \
		${ECHO} "#TZ=PST8PDT" \
			>> ${PREFIX}/pgsql/.profile; \
		${ECHO} "#export TZ" \
			>> ${PREFIX}/pgsql/.profile; \
	fi
	@@ chown -R pgsql:pgsql ${PREFIX}/pgsql
	@@ if [ ! -d ${DBPREFIX}/pgsql/data ]; then \
		${MKDIR} -p ${DBPREFIX}/pgsql/data; \
		chown pgsql:pgsql ${DBPREFIX}/pgsql ${DBPREFIX}/pgsql/data; \
		chmod 700 ${DBPREFIX}/pgsql/data; \
		${ECHO} 'Initializing PostgreSQL Databases - this may take a few minutes...'; \
		${LDCONFIG} -m ${PREFIX}/pgsql/lib; \
		su -l pgsql -c '${PREFIX}/pgsql/bin/initdb --pglib=${PREFIX}/pgsql/lib --pgdata=${DBPREFIX}/pgsql/data'; \
	else \
		${ECHO} 'Found existing PostgreSQL database(s) -- skipping database initializing...'; \
	fi
	${SED} -e "s=!!PREFIX!!=${PREFIX}=g" < ${FILESDIR}/pgsql.sh.tmpl > ${PREFIX}/pgsql/bin/pgsql.sh
	chmod 554 ${PREFIX}/pgsql/bin/pgsql.sh
	chown root.pgsql ${PREFIX}/pgsql/bin/pgsql.sh
	${INSTALL_DATA} ${FILESDIR}/post-install-notes ${PREFIX}/pgsql
.if !defined(NOPORTDOCS)
	${MKDIR} ${PREFIX}/share/doc/pgsql
	${CP} -r ${WRKDIR}/${DISTNAME}/doc/* ${PREFIX}/share/doc/pgsql
.endif
.if !defined(BATCH)
	@@ more -e ${FILESDIR}/post-install-notes
.endif
@


1.14
log
@fix dependency lists, fix email address's and remove unnecessary comments
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 1999/02/21 04:26:10 marc Exp $
d6 2
@


1.13
log
@needs version 1.64 (or later) of bsd.port.mk
to build/install correctly; PLIST.noshared
@
text
@d1 2
a2 3
# $OpenBSD: Makefile,v 1.12 1998/10/20 08:39:44 form Exp $
# FreeBSD: Makefile,v 1.25 1998/04/22 08:28:07 asami Exp
#
d10 1
a10 1
MAINTAINER=	form@@OpenBSD.ORG
d21 2
a22 2
LIB_DEPENDS=	tcl80\\.1\\.:${PORTSDIR}/lang/tcl80 \
		tk80\\.1\\.:${PORTSDIR}/x11/tk80
@


1.12
log
@form@@vs.itam.nsc.ru -> form@@openbsd.org
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 1998/10/19 09:52:49 form Exp $
d8 1
@


1.11
log
@do not use ${PREFIX}/etc/rc.d
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 1998/10/08 04:42:57 marc Exp $
d10 1
a10 1
MAINTAINER=	form@@vs.itam.nsc.ru
@


1.10
log
@reorg makefile
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 1998/07/02 07:29:45 form Exp $
d90 3
a92 3
	${SED} -e "s=!!PREFIX!!=${PREFIX}=g" < ${FILESDIR}/pgsql.sh.tmpl > ${PREFIX}/etc/rc.d/pgsql.sh
	chmod 554 ${PREFIX}/etc/rc.d/pgsql.sh
	chown root.pgsql ${PREFIX}/etc/rc.d/pgsql.sh
@


1.9
log
@fix MANPATH
@
text
@d1 1
a1 6
# New ports collection makefile for:	PostgreSQL
# Version required:	6.3.2
# Date created:		6 May 1998
# Whom:			Oleg Safiullin <form@@vs.itam.nsc.ru>
#
# $OpenBSD: Makefile,v 1.8 1998/06/27 22:18:34 marc Exp $
d7 2
a8 1
MASTER_SITES=	ftp://ftp.postgresql.org/pub/
d12 2
a27 1
NO_PACKAGE=	"Requires pgsql uid"
a37 21

MAN1=		cleardbdir.1 createdb.1 createuser.1 destroydb.1 \
		destroyuser.1 ecpg.1 initdb.1 ipcclean.1 initlocation.1 \
		pg_dump.1 pg_dumpall.1 pg_passwd.1 pgintro.1 postgres.1 \
		postmaster.1 psql.1
MAN3=		catalogs.3 large_objects.3 libpq.3 oracle_compat.3 pgbuiltin.3
MAN5=		bki.5 page.5 pg_hba.conf.5
MANL=		abort.l alter_table.l alter_user.l begin.l close.l cluster.l \
		commit.l copy.l create_aggregate.l create_database.l \
		create_function.l create_index.l create_language.l \
		create_operator.l create_rule.l create_sequence.l \
		create_table.l create_trigger.l create_type.l create_user.l \
		create_version.l create_view.l declare.l delete.l drop.l \
		drop_aggregate.l drop_database.l drop_function.l drop_index.l \
		drop_language.l drop_operator.l drop_rule.l drop_sequence.l \
		drop_table.l drop_trigger.l drop_type.l drop_user.l \
		drop_view.l end.l explain.l fetch.l grant.l insert.l listen.l \
		load.l lock.l move.l notify.l reset.l revoke.l \
		rollback.l select.l set.l show.l sql.l update.l vacuum.l

MANPREFIX=	${PREFIX}/pgsql
@


1.8
log
@spit out USE_TCL message pre fetch, not pre-build;
USE_TCL is used by configuration (before building)
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.7 1998/06/17 06:27:17 form Exp $
d65 1
a65 1
pre-fetch:
d84 1
a84 1
		${ECHO} "MANPATH=${MANPATH}:${PREFIX}/pgsql/bin" \
@


1.7
log
@more fixes
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.6 1998/06/17 05:41:24 form Exp $
d16 3
d63 3
a65 1
pre-build:
@


1.6
log
@some fixes
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.5 1998/06/10 06:06:52 form Exp $
a17 2
# if you want to use the tcl/tk frontend pgaccess, then you need to build
# postgresql with tcl support by typing: make USE_TCL=yes
d25 2
d85 1
a85 1
		${ECHO} "PGDATA=${PREFIX}/pgsql/data" \
d99 4
a102 1
	@@ if [ ! -d ${PREFIX}/pgsql/data ]; then \
d105 1
a105 1
		su -l pgsql -c '${PREFIX}/pgsql/bin/initdb --pglib=${PREFIX}/pgsql/lib --pgdata=${PREFIX}/pgsql/data'; \
@


1.5
log
@fix build dependencies
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.4 1998/05/06 16:55:37 form Exp $
d22 2
a23 1
LIB_DEPENDS=	tcl80\\.1\\.:${PORTSDIR}/lang/tcl80
d60 1
a60 1
pre-fetch:
a67 6
post-build:
	@@ ${ECHO} "------------------------------------------------------------"
	@@ ${ECHO} "Dump existing databases, before installing new db version !!"
	@@ ${ECHO} "Detailed instructions, see INSTALL file under ${WRKDIR}...  "
	@@ ${ECHO} "------------------------------------------------------------"

d99 11
a109 8
	@@ ${ECHO} 'Initializing PostgreSQL Databases - this may take a few minutes...'
	@@ ${LDCONFIG} -m ${PREFIX}/pgsql/lib
	@@ su -l pgsql -c '${PREFIX}/pgsql/bin/initdb --pglib=${PREFIX}/pgsql/lib --pgdata=${PREFIX}/pgsql/data'
	@@ ${SED} -e "s=!!PREFIX!!=${PREFIX}=g" < ${FILESDIR}/pgsql.sh.tmpl \
		> ${PREFIX}/etc/rc.d/pgsql.sh
	@@ chmod 554 ${PREFIX}/etc/rc.d/pgsql.sh
	@@ chown root.pgsql ${PREFIX}/etc/rc.d/pgsql.sh
	@@ ${INSTALL_DATA} ${FILESDIR}/post-install-notes ${PREFIX}/pgsql
@


1.4
log
@update postgres to 6.3.2
@
text
@d6 1
a6 1
# $OpenBSD: Makefile,v 1.0 1998/05/06 20:35:07 form Exp $
d15 2
@


1.3
log
@update to version 6.3 and make it install in standard locations
@
text
@d2 6
a7 4
# Version required:	6.3
# Date created:		November 19, 1997
# Whom:			mickey
#			from:	Marc G. Fournier <scrappy@@FreeBSD.ORG>
a8 1
# $OpenBSD: Makefile,v 1.2 1997/12/03 20:10:01 niklas Exp $
d10 1
a10 1
DISTNAME=	postgresql-6.3
d12 3
a14 3
MASTER_SITES=	ftp://ftp.PostgreSQL.org/pub/ \
		ftp://ftp.luga.or.at/pub/postgres95/ \
		ftp://ftp.jaist.ac.jp/pub/dbms/postgres95/
d16 7
a22 1
MAINTAINER=	ports@@openbsd.org
d30 1
a30 1
CONFIGURE_ARGS+=--prefix=${PREFIX}/pgsql \
d32 3
a34 10
		--with-template=openbsd \
		--with-defaults=yes

# if you want to use the tcl/tk frontend pgaccess, then you need to build
# postgresql with tcl support by typing: make WITH_TCL=yes
#
.if defined(WITH_TCL) && ${WITH_TCL} == yes
CONFIGURE_ARGS+=--with-tcl
LIB_DEPENDS=	tcl80\\.1\\.:${PORTSDIR}/lang/tcl80
.endif
d37 1
a37 1
		destroyuser.1 ecpg.1 initdb.1 initlocation.1 ipcclean.1 \
d42 2
a43 2
MANL=		abort.l alter_table.l alter_user.l begin.l close.l \
		cluster.l commit.l copy.l create_aggregate.l create_database.l \
d52 1
a52 1
		load.l lock.l move.l notify.l rename.l reset.l revoke.l \
d55 2
d58 3
a60 4
.if defined(WITH_TCL)
.if ${WITH_TCL} == yes
	@@${ECHO_MSG} "Building/Installing PostgreSQL with \"libpgtcl\"."
.endif
d62 1
a62 21
	@@${ECHO_MSG} "To build/install the \"PostgreSQL to Tcl interface library\", libpgtcl, type:"
	@@${ECHO_MSG} "    make WITH_TCL=yes"
.endif

# The configuration step, this overrides the standard which sets
# INSTALL to a value that caused the gnu configure to bitch.  Since
# this file takes over installation, this is a not issue.
#
do-configure:
	@@(cd ${WRKSRC} && CC="${CC}" ac_cv_path_CC="${CC}" CFLAGS="${CFLAGS}" \
	    INSTALL="/usr/bin/install" \
	    INSTALL_PROGRAM="${INSTALL_PROGRAM}" \
	    ${CONFIGURE_ENV} ./${CONFIGURE_SCRIPT} ${CONFIGURE_ARGS})

# Use the postgres makefile override facility to disable shared libs
# libs if necessary
#
pre-build:
.if (${MACHINE_ARCH} == "alpha")
	${ECHO} "# OpenBSD Makefile overrides" > ${WRKSRC}/Makefile.custom
	${ECHO} "BSD_SHLIB= false" >> ${WRKSRC}/Makefile.custom
d71 3
a73 102
# Take over the install phase so things are put in OpenBSD standard
# locations (more or less).
#
# The install steps are:
# 1) create pgsql "home" directory
# 2) create pgsql user -- this updates the password file
# 3) install pgsql binaries, libraries, library files, and headers
# 4) install tcl extensions (if requested).
# 5) install man pages
#
do-install:
	@@${MKDIR} ${PREFIX}/pgsql
	@@${SETENV} ${MAKE_ENV} perl ${SCRIPTDIR}/createuser
	@@${ECHO_MSG} "installing in ${PREFIX}/bin"
	@@${INSTALL_PROGRAM} \
		${WRKSRC}/backend/postgres \
		${WRKSRC}/bin/pg_id/pg_id \
		${WRKSRC}/bin/pg_version/pg_version \
		${WRKSRC}/bin/psql/psql \
		${WRKSRC}/bin/pg_dump/pg_dump \
		${WRKSRC}/bin/pg_passwd/pg_passwd \
			${PREFIX}/bin
	@@${LN} -sf ${PREFIX}/bin/postgres ${PREFIX}/bin/postmaster
	@@${INSTALL_SCRIPT} \
		${WRKSRC}/bin/pg_dump/pg_dumpall \
		${WRKSRC}/bin/cleardbdir/cleardbdir \
		${WRKSRC}/bin/createdb/createdb \
		${WRKSRC}/bin/createuser/createuser \
		${WRKSRC}/bin/destroydb/destroydb \
		${WRKSRC}/bin/destroyuser/destroyuser \
		${WRKSRC}/bin/initdb/initdb \
		${WRKSRC}/bin/initlocation/initlocation \
			${PREFIX}/bin
	@@${ECHO_MSG} "installing in ${PREFIX}/lib"
	@@${INSTALL_DATA} \
		${WRKSRC}/interfaces/libpq/libpq.a ${PREFIX}/lib
.if (${MACHINE_ARCH} != "alpha")
	@@${INSTALL_DATA} \
		${WRKSRC}/interfaces/libpq/libpq.so.1.1 ${PREFIX}/lib
.endif
	@@${ECHO_MSG} "installing in ${PREFIX}/lib/pgsql"
	@@${MKDIR} ${PREFIX}/lib/pgsql
	@@${INSTALL_DATA} \
		${WRKSRC}/backend/global1.bki.source \
		${WRKSRC}/backend/global1.description \
		${WRKSRC}/backend/local1_template1.bki.source \
		${WRKSRC}/backend/local1_template1.description \
		${WRKSRC}/backend/libpq/pg_hba.conf.sample \
		${WRKSRC}/backend/optimizer/geqo/pg_geqo.sample \
			${PREFIX}/lib/pgsql
	@@${ECHO_MSG} "installing in ${PREFIX}/include/pgsql"
	@@${MKDIR} ${PREFIX}/include/pgsql
	@@${INSTALL_DATA} \
		${WRKSRC}/backend/fmgr.h \
		${WRKSRC}/include/os.h \
		${WRKSRC}/include/config.h \
		${WRKSRC}/include/postgres.h \
		${WRKSRC}/include/postgres_ext.h \
		${WRKSRC}/interfaces/libpq/libpq-fe.h \
		${WRKSRC}/interfaces/libpq/c.h \
			${PREFIX}/include/pgsql
	@@${MKDIR} ${PREFIX}/include/pgsql/libpq
	@@${INSTALL_DATA} \
		${WRKSRC}/include/libpq/pqcomm.h \
		${WRKSRC}/include/libpq/libpq-fs.h \
			${PREFIX}/include/pgsql/libpq
	@@${MKDIR} ${PREFIX}/include/pgsql/lib
	@@${INSTALL_DATA} \
		${WRKSRC}/include/lib/dllist.h \
			${PREFIX}/include/pgsql/lib
	@@${MKDIR} ${PREFIX}/include/pgsql/utils
	@@${INSTALL_DATA} \
		${WRKSRC}/include/utils/geo_decls.h \
		${WRKSRC}/include/utils/elog.h \
		${WRKSRC}/include/utils/palloc.h \
			${PREFIX}/include/pgsql/utils
	@@${MKDIR} ${PREFIX}/include/pgsql/access
	@@${INSTALL_DATA} \
		${WRKSRC}/include/access/attnum.h \
			${PREFIX}/include/pgsql/access
	@@${MKDIR} ${PREFIX}/include/pgsql/executor
	@@${INSTALL_DATA} \
		${WRKSRC}/include/executor/spi.h \
			${PREFIX}/include/pgsql/executor
	@@${MKDIR} ${PREFIX}/include/pgsql/commands
	@@${INSTALL_DATA} \
		${WRKSRC}/include/commands/trigger.h \
			${PREFIX}/include/pgsql/commands
.if defined( WITH_TCL ) && ${WITH_TCL} == yes
	@@${ECHO_MSG} "installing tcl/tk interface"
	@@${INSTALL_PROGRAM} \
		${WRKSRC}/bin/pgtclsh/pgtclsh \
		${WRKSRC}/bin/pgtclsh/pgtksh \
			${PREFIX}/bin
	@@${INSTALL_DATA} \
		${WRKSRC}/interfaces/libpgtcl/libpgtcl.a ${PREFIX}/lib
.if (${MACHINE_ARCH} != "alpha")
	@@${INSTALL_DATA} \
		${WRKSRC}/interfaces/libpgtcl/libpgtcl.so.1.0 ${PREFIX}/lib
.endif
	@@${INSTALL_DATA} \
		${WRKSRC}/interfaces/libpgtcl/libpgtcl.h ${PREFIX}/include/pgsql
d75 2
a76 16
	@@${ECHO_MSG} "installing in ${PREFIX}/man"
.for man in ${MAN1}
	@@${INSTALL_MAN} ${WRKSRC}/man/${man} ${PREFIX}/man/man1
.endfor
.for man in ${MAN3}
	@@${INSTALL_MAN} ${WRKSRC}/man/${man} ${PREFIX}/man/man3
.endfor
.for man in ${MAN5}
	@@${INSTALL_MAN} ${WRKSRC}/man/${man} ${PREFIX}/man/man5
.endfor
	@@${ECHO_MSG} "installing in ${PREFIX}/pgsql/man"
	@@${MKDIR} ${PREFIX}/pgsql/man/manl
.for man in ${MANL}
	@@${INSTALL_MAN} ${WRKSRC}/man/${man} ${PREFIX}/pgsql/man/manl
.endfor
	@@${LDCONFIG} -m ${PREFIX}/lib
d80 1
a80 1
		${ECHO} "PATH=${PATH}" \
d82 1
a82 1
		${ECHO} "MANPATH=${MANPATH}:${PREFIX}/pgsql/man" \
d84 1
a84 1
		${ECHO} "PGLIB=${PREFIX}/lib/pgsql" \
a100 5
	@@ ${SED} -e "s=!!PREFIX!!=${PREFIX}=g" <${FILESDIR}/post-install-notes \
		> ${PREFIX}/pgsql/post-install-notes
	@@ ${SED} -e "s=!!PREFIX!!=${PREFIX}=g" <${FILESDIR}/man.conf \
		> ${PREFIX}/pgsql/man.conf
	@@ ${CP} -r ${WRKSRC}/bin/pgaccess ${PREFIX}/pgsql
d103 2
a104 1
	@@ su -l pgsql -c '${PREFIX}/bin/initdb --pglib=${PREFIX}/lib/pgsql --pgdata=${PREFIX}/pgsql/data'
d106 4
a109 3
		> ${PREFIX}/pgsql/rc.pgsql
	@@ chmod 554 ${PREFIX}/pgsql/rc.pgsql
	@@ chown root.pgsql ${PREFIX}/pgsql/rc.pgsql
d111 2
a112 2
	@@${MKDIR} ${PREFIX}/share/doc/pgsql
	@@${CP} -r ${WRKDIR}/${DISTNAME}/doc/* ${PREFIX}/share/doc/pgsql
d115 1
a115 1
	@@ more -e ${PREFIX}/pgsql/post-install-notes
@


1.2
log
@Hey we are OpenBSD
@
text
@d2 1
a2 1
# Version required:	6.1
d7 1
a7 1
# $OpenBSD: Makefile,v 1.1 1997/11/20 20:34:05 mickey Exp $
d9 1
a9 1
DISTNAME=	postgresql-6.2.1
d15 1
a15 8
MAINTAINER=	mickey@@openbsd.org

# if you want to use the tcl/tk frontend pgaccess, then you need to build
# postgresql with tcl support by typing: make USE_TCL=yes
.if defined(USE_TCL)
MAKE_ENV+=	USE_TCL=true TCL_INCDIR=${PREFIX}/include/tcl8.0
LIB_DEPENDS=	tcl80\\.1\\.:${PORTSDIR}/lang/tcl80
.endif
d25 10
a34 2
		--with-template=openbsd
#		--with-template=`uname -s | ${TR} '[A-Z]' '[a-z]'`
d37 2
a38 2
		destroyuser.1 initdb.1 ipcclean.1 monitor.1 pg_dump.1 \
		pg_dumpall.1 pg_passwd.1 pgintro.1 postgres.1 \
d42 12
a53 14
MANL=		abort.l alter_table.l begin.l close.l cluster.l \
		commit.l copy.l create_aggregate.l create_database.l \
		create_function.l create_index.l create_operator.l \
		create_rule.l create_sequence.l create_table.l \
		create_trigger.l create_type.l create_version.l \
		create_view.l declare.l delete.l drop.l drop_aggregate.l \
		drop_database.l drop_function.l drop_index.l drop_operator.l \
		drop_rule.l drop_sequence.l drop_table.l drop_trigger.l \
		drop_type.l drop_view.l end.l explain.l fetch.l grant.l \
		insert.l listen.l load.l move.l notify.l purge.l rename.l \
		reset.l revoke.l rollback.l select.l set.l show.l sql.l \
		update.l vacuum.l

MANPREFIX=	${PREFIX}/pgsql
d56 4
a59 3
.if !defined(USE_TCL)
	@@${ECHO_MSG} "To build the \"PostgreSQL to Tcl interface library\", libpgtcl, type:"
	@@${ECHO_MSG} "    make USE_TCL=yes"
d61 21
a81 1
	@@${ECHO_MSG} "Building PostgreSQL with \"libpgtcl\"."
d90 119
a208 3
pre-install:
	@@ ${MKDIR} ${PREFIX}/pgsql
	@@ ${SETENV} ${MAKE_ENV} perl ${SCRIPTDIR}/createuser
d212 1
a212 1
		${ECHO} "PATH=${PATH}:${PREFIX}/pgsql/bin" \
d214 1
a214 1
		${ECHO} "MANPATH=${MANPATH}:${PREFIX}/pgsql/bin" \
d216 1
a216 1
		${ECHO} "PGLIB=${PREFIX}/pgsql/lib" \
d233 5
d240 1
a240 2
	@@ ${LDCONFIG} -m ${PREFIX}/pgsql/lib
	@@ su -l pgsql -c '${PREFIX}/pgsql/bin/initdb --pglib=${PREFIX}/pgsql/lib --pgdata=${PREFIX}/pgsql/data'
d242 3
a244 4
		> ${PREFIX}/etc/rc.pgsql
	@@ chmod 554 ${PREFIX}/etc/rc.pgsql
	@@ chown root.pgsql ${PREFIX}/etc/rc.pgsql
	@@ ${INSTALL_DATA} ${FILESDIR}/post-install-notes ${PREFIX}/pgsql
d246 2
a247 2
	${MKDIR} ${PREFIX}/share/doc/pgsql
	${CP} -r ${WRKDIR}/${DISTNAME}/doc/* ${PREFIX}/share/doc/pgsql
d250 1
a250 1
	@@ more -e ${FILESDIR}/post-install-notes
@


1.1
log
@posgresql port (from freebsd)
most of major bugs cleaned, some of the smaller ones.
openbsd profile sent to the patches mailist.
@
text
@d7 1
a7 1
# $OpenBSD$
d32 1
a32 1
		--with-template=freebsd
@

