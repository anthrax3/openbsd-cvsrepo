head	1.2;
access;
symbols
	OPENBSD_5_9:1.1.0.8
	OPENBSD_5_9_BASE:1.1
	OPENBSD_5_8:1.1.0.10
	OPENBSD_5_8_BASE:1.1
	OPENBSD_5_7:1.1.0.6
	OPENBSD_5_7_BASE:1.1
	OPENBSD_5_6:1.1.0.4
	OPENBSD_5_6_BASE:1.1
	OPENBSD_5_5:1.1.0.2
	OPENBSD_5_5_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2016.05.06.15.33.37;	author sthen;	state dead;
branches;
next	1.1;
commitid	5e1KALTAPXjZQxNY;

1.1
date	2013.12.10.17.30.41;	author joshe;	state Exp;
branches;
next	;


desc
@@


1.2
log
@update to MongoDB 3.2.6, from Andrew Aldridge, minor tweaks from me
@
text
@$OpenBSD: patch-src_mongo_platform_random_cpp,v 1.1 2013/12/10 17:30:41 joshe Exp $
--- src/mongo/platform/random.cpp.orig	Thu Oct 17 11:37:56 2013
+++ src/mongo/platform/random.cpp	Mon Oct 28 20:21:29 2013
@@@@ -138,6 +138,21 @@@@ namespace mongo {
         return new InputStreamSecureRandom( "/dev/urandom" );
     }
 
+#elif defined(__OpenBSD__)
+
+    class ARC4SecureRandom : public SecureRandom {
+    public:
+        int64_t nextInt64() {
+            int64_t n;
+            arc4random_buf(&n, sizeof(n));
+            return n;
+        }
+    };
+
+    SecureRandom* SecureRandom::create() {
+        return new ARC4SecureRandom();
+    }
+
 #else
     class SRandSecureRandom : public SecureRandom {
     public:
@


1.1
log
@Update mongodb to 2.4.7. Still BROKEN, but a bit closer to working.

This also switches the javascript backend from spidermonkey to v8, as
support for the former has already been removed in the mongodb repo.

"since it's broken go ahead and commit that" fgsch@@
@
text
@d1 1
a1 1
$OpenBSD$
@

