head	1.3;
access;
symbols
	OPENBSD_5_4:1.2.0.8
	OPENBSD_5_4_BASE:1.2
	OPENBSD_5_3:1.2.0.6
	OPENBSD_5_3_BASE:1.2
	OPENBSD_5_2:1.2.0.4
	OPENBSD_5_2_BASE:1.2
	OPENBSD_5_1_BASE:1.2
	OPENBSD_5_1:1.2.0.2
	OPENBSD_5_0:1.1.1.1.0.2
	OPENBSD_5_0_BASE:1.1.1.1
	fgsch_20110602:1.1.1.1
	fgsch:1.1.1;
locks; strict;
comment	@# @;


1.3
date	2013.12.10.17.30.41;	author joshe;	state dead;
branches;
next	1.2;

1.2
date	2011.10.03.16.38.21;	author fgsch;	state Exp;
branches;
next	1.1;

1.1
date	2011.06.02.00.26.32;	author fgsch;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2011.06.02.00.26.32;	author fgsch;	state Exp;
branches;
next	;


desc
@@


1.3
log
@Update mongodb to 2.4.7. Still BROKEN, but a bit closer to working.

This also switches the javascript backend from spidermonkey to v8, as
support for the former has already been removed in the mongodb repo.

"since it's broken go ahead and commit that" fgsch@@
@
text
@$OpenBSD: patch-db_nonce_cpp,v 1.2 2011/10/03 16:38:21 fgsch Exp $
--- db/nonce.cpp.orig	Sun Sep 11 15:09:34 2011
+++ db/nonce.cpp	Sun Sep 18 21:35:45 2011
@@@@ -42,7 +42,7 @@@@ namespace mongo {
         massert( 10353 ,  "can't open dev/urandom", _devrandom->is_open() );
 #elif defined(_WIN32)
         srand(curTimeMicros()); // perhaps not relevant for rand_s but we might want elsewhere anyway
-#else
+#elif !defined(__openbsd__)
         srandomdev();
 #endif
 
@@@@ -63,6 +63,8 @@@@ namespace mongo {
         assert( rand_s(&a) == 0 );
         assert( rand_s(&b) == 0 );
         n = (((unsigned long long)a)<<32) | b;
+#elif defined(__openbsd__)
+        n = arc4random();
 #else
         n = (((unsigned long long)random())<<32) | random();
 #endif
@


1.2
log
@Update to MongoDB 2.0.0.
benoit@@ rpointel@@ ok.
@
text
@d1 1
a1 1
$OpenBSD: patch-db_nonce_cpp,v 1.1.1.1 2011/06/02 00:26:32 fgsch Exp $
@


1.1
log
@Initial revision
@
text
@d1 4
a4 4
$OpenBSD$
--- db/nonce.cpp.orig	Sat Apr  2 04:01:52 2011
+++ db/nonce.cpp	Sat Apr  2 04:05:01 2011
@@@@ -40,7 +40,7 @@@@ namespace mongo {
d7 1
a7 1
         srand(curTimeMicros());
d13 1
a13 1
@@@@ -70,6 +70,8 @@@@ namespace mongo {
@


1.1.1.1
log
@Import mongodb, a scalable, high-performance, open source, document-oriented
database.
with input from dcoppa and martynas, martynas ok some time ago.
@
text
@@
