head	1.7;
access;
symbols
	OPENBSD_6_0:1.7.0.14
	OPENBSD_6_0_BASE:1.7
	OPENBSD_5_9:1.7.0.10
	OPENBSD_5_9_BASE:1.7
	OPENBSD_5_8:1.7.0.12
	OPENBSD_5_8_BASE:1.7
	OPENBSD_5_7:1.7.0.8
	OPENBSD_5_7_BASE:1.7
	OPENBSD_5_6:1.7.0.6
	OPENBSD_5_6_BASE:1.7
	OPENBSD_5_5:1.7.0.4
	OPENBSD_5_5_BASE:1.7
	OPENBSD_5_4:1.7.0.2
	OPENBSD_5_4_BASE:1.7
	OPENBSD_5_3:1.6.0.10
	OPENBSD_5_3_BASE:1.6
	OPENBSD_5_2:1.6.0.8
	OPENBSD_5_2_BASE:1.6
	OPENBSD_5_1_BASE:1.6
	OPENBSD_5_1:1.6.0.6
	OPENBSD_5_0:1.6.0.4
	OPENBSD_5_0_BASE:1.6
	OPENBSD_4_9:1.6.0.2
	OPENBSD_4_9_BASE:1.6
	OPENBSD_4_8:1.5.0.20
	OPENBSD_4_8_BASE:1.5
	OPENBSD_4_7:1.5.0.18
	OPENBSD_4_7_BASE:1.5
	OPENBSD_4_6:1.5.0.16
	OPENBSD_4_6_BASE:1.5
	OPENBSD_4_5:1.5.0.14
	OPENBSD_4_5_BASE:1.5
	OPENBSD_4_4:1.5.0.12
	OPENBSD_4_4_BASE:1.5
	OPENBSD_4_3:1.5.0.10
	OPENBSD_4_3_BASE:1.5
	OPENBSD_4_2:1.5.0.8
	OPENBSD_4_2_BASE:1.5
	OPENBSD_4_1:1.5.0.6
	OPENBSD_4_1_BASE:1.5
	OPENBSD_4_0:1.5.0.4
	OPENBSD_4_0_BASE:1.5
	OPENBSD_3_9:1.5.0.2
	OPENBSD_3_9_BASE:1.5
	OPENBSD_3_8:1.3.0.8
	OPENBSD_3_8_BASE:1.3
	OPENBSD_3_7:1.3.0.6
	OPENBSD_3_7_BASE:1.3
	OPENBSD_3_6:1.3.0.4
	OPENBSD_3_6_BASE:1.3
	OPENBSD_3_5:1.3.0.2
	OPENBSD_3_5_BASE:1.3
	sturm_2003-Dec-08:1.1.1.1
	sturm:1.1.1;
locks; strict;
comment	@# @;


1.7
date	2013.07.09.17.06.14;	author espie;	state Exp;
branches;
next	1.6;

1.6
date	2010.10.28.10.33.16;	author steven;	state Exp;
branches;
next	1.5;

1.5
date	2005.12.25.20.35.42;	author sturm;	state Exp;
branches;
next	1.4;

1.4
date	2005.11.01.15.44.24;	author bernd;	state Exp;
branches;
next	1.3;

1.3
date	2004.01.10.08.36.28;	author sturm;	state Exp;
branches;
next	1.2;

1.2
date	2003.12.11.06.49.17;	author sturm;	state Exp;
branches;
next	1.1;

1.1
date	2003.12.08.17.37.55;	author sturm;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2003.12.08.17.37.55;	author sturm;	state Exp;
branches;
next	;


desc
@@


1.7
log
@fix install in the purely static case
@
text
@$OpenBSD: patch-dist_Makefile_in,v 1.6 2010/10/28 10:33:16 steven Exp $
--- dist/Makefile.in.orig	Tue Jul 18 17:37:57 2000
+++ dist/Makefile.in	Tue Jul  9 19:05:04 2013
@@@@ -26,7 +26,9 @@@@ LIBTSO_LIBS=	@@LIBTSO_LIBS@@
 LIBXSO_LIBS=	@@LIBXSO_LIBS@@
 
 POSTLINK=	@@POSTLINK@@
-SOLINK=		@@SOLINK@@
+dbLINK=		@@dbLINK@@
+dbcxxLINK=	@@dbcxxLINK@@
+dbtclLINK=	@@dbtclLINK@@
 SOFLAGS=	@@SOFLAGS@@
 SOMAJOR=	@@DB_VERSION_MAJOR@@
 SOVERSION=	@@DB_VERSION_MAJOR@@.@@DB_VERSION_MINOR@@
@@@@ -34,11 +36,11 @@@@ SOVERSION=	@@DB_VERSION_MAJOR@@.@@DB_VERSION_MINOR@@
 libdb=		libdb.a
 
 libso_base=	libdb
-libso_linkname=	$(libso_base)-$(SOVERSION).la
-libso=		$(libso_base)-$(SOVERSION).@@SOSUFFIX@@
-libso_target=	$(libso_base)-$(SOVERSION).la
+libso_linkname=	$(libso_base).la
+libso=		$(libso_base).@@SOSUFFIX@@.$(DBVERSION)
+libso_target=	$(libso_base).la
 libso_default=	$(libso_base).@@SOSUFFIX@@
-libso_major=	$(libso_base)-$(SOMAJOR).@@SOSUFFIX@@
+libso_major=	$(libso_base).@@SOSUFFIX@@.$(SOMAJOR)
 
 ##################################################
 # C++
@@@@ -49,10 +51,10 @@@@ libso_major=	$(libso_base)-$(SOMAJOR).@@SOSUFFIX@@
 ##################################################
 libcxx=		libdb_cxx.a
 libxso_base=	libdb_cxx
-libxso=		$(libxso_base)-$(SOVERSION).@@SOSUFFIX@@
-libxso_target=	$(libxso_base)-$(SOVERSION).la
+libxso=		$(libxso_base).@@SOSUFFIX@@.$(DBCXXVERSION)
+libxso_target=	$(libxso_base).la
 libxso_default=	$(libxso_base).@@SOSUFFIX@@
-libxso_major=	$(libxso_base)-$(SOMAJOR).@@SOSUFFIX@@
+libxso_major=	$(libxso_base).@@SOSUFFIX@@.$(SOMAJOR)
 
 ##################################################
 # JAVA
@@@@ -71,11 +73,11 @@@@ JAVA_DBDIR=	$(JAVA_SRCDIR)/com/sleepycat/db
 JAVA_EXDIR=	$(JAVA_SRCDIR)/com/sleepycat/examples
 
 libjso_base=	libdb_java
-libjso=		$(libjso_base)-$(SOVERSION).@@SOSUFFIX@@
-libjso_target=	$(libjso_base)-$(SOVERSION).la
+libjso=		$(libjso_base).@@SOSUFFIX@@.$(SOVERSION)
+libjso_target=	$(libjso_base).la
 libjso_default=	$(libjso_base).@@SOSUFFIX@@
-libjso_major=	$(libjso_base)-$(SOMAJOR).@@SOSUFFIX@@
-libjso_g=	$(libjso_base)-$(SOVERSION)_g.@@SOSUFFIX@@
+libjso_major=	$(libjso_base).@@SOSUFFIX@@.$(SOVERSION)
+libjso_g=	$(libjso_base)_g.@@SOSUFFIX@@.$(SOVERSION)
 
 ##################################################
 # TCL
@@@@ -86,10 +88,10 @@@@ libjso_g=	$(libjso_base)-$(SOVERSION)_g.@@SOSUFFIX@@
 ##################################################
 TCFLAGS=	@@TCFLAGS@@
 libtso_base=	libdb_tcl
-libtso=		$(libtso_base)-$(SOVERSION).@@SOSUFFIX@@
-libtso_target=	$(libtso_base)-$(SOVERSION).la
+libtso=		$(libtso_base).@@SOSUFFIX@@.$(DBTCLVERSION)
+libtso_target=	$(libtso_base).la
 libtso_default=	$(libtso_base).@@SOSUFFIX@@
-libtso_major=	$(libtso_base)-$(SOMAJOR).@@SOSUFFIX@@
+libtso_major=	$(libtso_base).@@SOSUFFIX@@.$(SOMAJOR)
 
 ##################################################
 # DB_DUMP185 UTILITY
@@@@ -112,7 +114,8 @@@@ exec_prefix=@@exec_prefix@@
 bindir=	@@bindir@@
 includedir=@@includedir@@
 libdir=	@@libdir@@
-docdir=	$(prefix)/docs
+libsdir=	$(prefix)/lib
+docdir=	$(prefix)/share/doc/db
 
 dmode=	755
 emode=	555
@@@@ -233,11 +236,11 @@@@ $(libcxx): $(COBJS) $(OBJS)
 	test ! -f $(ranlib) || $(ranlib) $@@
 
 $(libso_target): $(OBJS)
-	$(SOLINK) $(SOFLAGS) -o $(libso_target) \
+	$(dbLINK) $(SOFLAGS) -o $(libso_target) \
 	    $(OBJS) $(LDFLAGS) $(LIBSO_LIBS)
 
 $(libxso_target): $(COBJS) $(OBJS)
-	$(SOLINK) $(SOFLAGS) -o $(libxso_target) \
+	$(dbcxxLINK) $(SOFLAGS) -o $(libxso_target) \
 	    $(COBJS) $(OBJS) $(LDFLAGS) $(LIBXSO_LIBS)
 
 $(libjso_target): $(JOBJS) $(OBJS)
@@@@ -245,7 +248,7 @@@@ $(libjso_target): $(JOBJS) $(OBJS)
 	    $(JOBJS) $(OBJS) $(LDFLAGS) $(LIBJSO_LIBS)
 
 $(libtso_target): $(TOBJS) $(OBJS)
-	$(SOLINK) $(SOFLAGS) -o $(libtso_target) \
+	$(dbtclLINK) $(SOFLAGS) -o $(libtso_target) \
 	    $(TOBJS) $(OBJS) $(LDFLAGS) $(LIBTSO_LIBS)
 
 ##################################################
@@@@ -398,7 +401,7 @@@@ install_include:
 	@@test -d $(includedir) || \
 	    ($(mkdir) -p $(includedir) && $(chmod) $(dmode) $(includedir))
 	@@cd $(includedir) && $(rm) -f db.h db_185.h db_cxx.h
-	@@$(cp) -p db.h db_185.h $(srcdir)/include/db_cxx.h $(includedir)
+	@@${BSD_INSTALL_DATA} -p db.h db_185.h $(srcdir)/include/db_cxx.h $(includedir)
 	@@cd $(includedir) && $(chmod) $(fmode) db.h db_185.h db_cxx.h
 
 install_static: install_setup
@@@@ -406,74 +409,75 @@@@ install_static: install_setup
 	@@test -d $(libdir) || \
 	    ($(mkdir) -p $(libdir) && $(chmod) $(dmode) $(libdir))
 	@@cd $(libdir) && $(rm) -f $(libdb)
-	@@$(cp) -p $(libdb) $(libdir)
-	@@cd $(libdir) && $(chmod) $(fmode) $(libdb)
+	@@${BSD_INSTALL_PROGRAM} $(libdb) $(libdir)
 
 install_static_cxx: install_setup
 	@@echo "Installing DB C++ static library: $(libdir) ..."
-	@@test -d $(libdir) || \
+	test -d $(libdir) || \
 	    ($(mkdir) -p $(libdir) && $(chmod) $(dmode) $(libdir))
-	@@cd $(libdir) && $(rm) -f $(libcxx)
-	@@$(cp) -p $(libcxx) $(libdir)
-	@@cd $(libdir) && $(chmod) $(fmode) $(libcxx)
+	cd $(libdir) && $(rm) -f $(libcxx)
+	@@${BSD_INSTALL_PROGRAM} $(libcxx) $(libdir)
 
 install_dynamic: install_setup
 	@@echo "Installing DB library: $(libdir) ..."
 	@@test -d $(libdir) || \
 	    ($(mkdir) -p $(libdir) && $(chmod) $(dmode) $(libdir))
-	@@cd $(libdir) && \
+	cd $(libdir) && \
 	    $(rm) -f $(libso) $(libso_default) $(libso_major)
-	@@$(INSTALLER) $(libso_target) $(libdir)
-	@@cd $(libdir) && $(ln) -s $(libso) $(libso_default)
-	@@cd $(libdir) && $(ln) -s $(libso) $(libso_major)
-	@@$(LIBTOOL) --mode=finish $(libdir)
+	$(INSTALLER) $(libso_target) $(libdir)
+	cd $(libsdir) && $(ln) -s db/$(libso)
+	cd $(libdir) && $(ln) -s $(libso) $(libso_default)
+	cd $(libdir) && $(ln) -s $(libso) $(libso_major)
 
 install_dynamic_cxx: install_setup
 	@@echo "Installing DB C++ library: $(libdir) ..."
-	@@test -d $(libdir) || \
+	test -d $(libdir) || \
 	    ($(mkdir) -p $(libdir) && $(chmod) $(dmode) $(libdir))
-	@@cd $(libdir) && \
+	cd $(libdir) && \
 	    $(rm) -f $(libxso) $(libxso_default) $(libxso_major)
-	@@$(INSTALLER) $(libxso_target) $(libdir)
-	@@cd $(libdir) && $(ln) -s $(libxso) $(libxso_default)
-	@@cd $(libdir) && $(ln) -s $(libxso) $(libxso_major)
+	$(INSTALLER) $(libxso_target) $(libdir)
+	cd $(libsdir) && $(ln) -s db/$(libxso)
+	cd $(libdir) && $(ln) -s $(libxso) $(libxso_default)
+	cd $(libdir) && $(ln) -s $(libxso) $(libxso_major)
 
 install_tcl: install_setup
 	@@echo "Installing DB Tcl library: $(libdir) ..."
-	@@test -d $(libdir) || \
+	test -d $(libdir) || \
 	    ($(mkdir) -p $(libdir) && $(chmod) $(dmode) $(libdir))
-	@@cd $(libdir) && \
+	cd $(libdir) && \
 	    $(rm) -f $(libtso) $(libtso_default) $(libtso_major)
-	@@$(INSTALLER) $(libtso_target) $(libdir)
-	@@cd $(libdir) && $(ln) -s $(libtso) $(libtso_default)
-	@@cd $(libdir) && $(ln) -s $(libtso) $(libtso_major)
+	$(INSTALLER) $(libtso_target) $(libdir)
+	cd $(libsdir) && $(ln) -s db/$(libtso)
+	cd $(libdir) && $(ln) -s $(libtso) $(libtso_default)
+	cd $(libdir) && $(ln) -s $(libtso) $(libtso_major)
 
 install_java: install_setup
 	@@echo "Installing DB Java library: $(libdir) ..."
-	@@test -d $(libdir) || \
+	test -d $(libdir) || \
 	    ($(mkdir) -p $(libdir) && $(chmod) $(dmode) $(libdir))
-	@@cd $(libdir) && \
+	cd $(libdir) && \
 	    $(rm) -f $(libjso) $(libjso_default) $(libjso_major)
-	@@$(INSTALLER) $(libjso_target) $(libdir)
-	@@cd $(libdir) && $(ln) -s $(libjso) $(libjso_default)
-	@@cd $(libdir) && $(ln) -s $(libjso) $(libjso_major)
-	@@cd $(libdir) && $(ln) -s $(libjso) $(libjso_g)
+	$(INSTALLER) $(libjso_target) $(libdir)
+	cd $(libdir) && $(ln) -s $(libjso) $(libjso_default)
+	cd $(libdir) && $(ln) -s $(libjso) $(libjso_major)
+	cd $(libdir) && $(ln) -s $(libjso) $(libjso_g)
 
 install_docs: install_setup
 	@@echo "Installing documentation: $(docdir) ..."
-	@@test -d $(docdir) || \
+	test -d $(docdir) || \
 	    ($(mkdir) -p $(docdir) && $(chmod) $(dmode) $(docdir))
-	@@cd $(docdir) && $(rm) -rf *
-	@@cd $(srcdir)/docs && $(cp) -pr * $(docdir)/
+	cd $(docdir) && $(rm) -rf *
+	cd $(srcdir)/docs && $(cp) -pr * $(docdir)/
+	chown -R root:wheel $(docdir)/
 
 install_utilities: install_setup
 	@@echo "Installing DB utilities: $(bindir) ..."
-	@@test -d $(bindir) || \
+	test -d $(bindir) || \
 	    ($(mkdir) -p $(bindir) && $(chmod) $(dmode) $(bindir))
-	@@cd $(bindir) && $(rm) -f $(PROGS)
-	@@$(INSTALLER) -fp $(PROGS) $(bindir)
-	@@cd $(bindir) && (test ! -f $(strip) || $(strip) $(PROGS))
-	@@cd $(bindir) && $(chmod) $(emode) $(PROGS)
+	cd $(bindir) && $(rm) -f $(PROGS)
+	$(INSTALLER) $(PROGS) $(bindir)
+	cd $(bindir) && (test ! -f $(strip) || $(strip) $(PROGS))
+	cd $(bindir) && $(chmod) $(emode) $(PROGS)
 
 uninstall:
 	-cd $(bindir) && $(rm) -f $(PROGS)
@


1.6
log
@remove some @@ in makefile, so we can see what is executed, e.g. libtool...

regen patches for v3 while here
@
text
@d1 1
a1 1
$OpenBSD: patch-dist_Makefile_in,v 1.4 2005/11/01 15:44:24 bernd Exp $
d3 1
a3 1
+++ dist/Makefile.in	Thu Oct 28 12:30:14 2010
d117 7
a123 1
@@@@ -411,69 +414,72 @@@@ install_static: install_setup
d134 1
a134 2
+	$(cp) -p $(libcxx) $(libdir)
+	cd $(libdir) && $(chmod) $(fmode) $(libcxx)
@


1.5
log
@SHARED_LIBS and USE_LIBTOOL
@
text
@d3 1
a3 1
+++ dist/Makefile.in	Sun Dec 25 20:00:19 2005
d15 1
a15 1
@@@@ -34,11 +36,11 @@@@ SOVERSION=	@@DB_VERSION_MAJOR@@.@@DB_VERSIO
d31 1
a31 1
@@@@ -49,10 +51,10 @@@@ libso_major=	$(libso_base)-$(SOMAJOR).@@S
d45 1
a45 1
@@@@ -71,11 +73,11 @@@@ JAVA_DBDIR=	$(JAVA_SRCDIR)/com/sleepycat
d61 1
a61 1
@@@@ -86,10 +88,10 @@@@ libjso_g=	$(libjso_base)-$(SOVERSION)_g.
d117 20
a136 2
@@@@ -424,9 +427,9 @@@@ install_dynamic: install_setup
 	@@cd $(libdir) && \
d138 3
a140 4
 	@@$(INSTALLER) $(libso_target) $(libdir)
+	@@cd $(libsdir) && $(ln) -s db/$(libso)
 	@@cd $(libdir) && $(ln) -s $(libso) $(libso_default)
 	@@cd $(libdir) && $(ln) -s $(libso) $(libso_major)
d142 4
d149 5
a153 2
@@@@ -435,6 +438,7 @@@@ install_dynamic_cxx: install_setup
 	@@cd $(libdir) && \
d155 15
a169 7
 	@@$(INSTALLER) $(libxso_target) $(libdir)
+	@@cd $(libsdir) && $(ln) -s db/$(libxso)
 	@@cd $(libdir) && $(ln) -s $(libxso) $(libxso_default)
 	@@cd $(libdir) && $(ln) -s $(libxso) $(libxso_major)
 
@@@@ -445,6 +449,7 @@@@ install_tcl: install_setup
 	@@cd $(libdir) && \
d171 29
a199 6
 	@@$(INSTALLER) $(libtso_target) $(libdir)
+	@@cd $(libsdir) && $(ln) -s db/$(libtso)
 	@@cd $(libdir) && $(ln) -s $(libtso) $(libtso_default)
 	@@cd $(libdir) && $(ln) -s $(libtso) $(libtso_major)
 
@@@@ -465,13 +470,14 @@@@ install_docs: install_setup
d201 5
a205 3
 	@@cd $(docdir) && $(rm) -rf *
 	@@cd $(srcdir)/docs && $(cp) -pr * $(docdir)/
+	@@chown -R root:wheel $(docdir)/
d209 2
a210 1
 	@@test -d $(bindir) || \
d212 1
a212 1
 	@@cd $(bindir) && $(rm) -f $(PROGS)
d214 6
a219 3
+	@@$(INSTALLER) $(PROGS) $(bindir)
 	@@cd $(bindir) && (test ! -f $(strip) || $(strip) $(PROGS))
 	@@cd $(bindir) && $(chmod) $(emode) $(PROGS)
d221 2
@


1.4
log
@- fix file modes for some files
- bump PKGNAMES

v3: "looks good" espie@@, ok niallo@@
v4: ok niallo@@
@
text
@d1 1
a1 1
$OpenBSD: patch-dist_Makefile_in,v 1.3 2004/01/10 08:36:28 sturm Exp $
d3 13
a15 2
+++ dist/Makefile.in	Tue Nov  1 13:02:45 2005
@@@@ -34,11 +34,11 @@@@ SOVERSION=	@@DB_VERSION_MAJOR@@.@@DB_VERSIO
d23 1
a23 1
+libso=		$(libso_base).@@SOSUFFIX@@.$(SOVERSION)
d31 1
a31 1
@@@@ -49,10 +49,10 @@@@ libso_major=	$(libso_base)-$(SOMAJOR).@@S
d37 1
a37 1
+libxso=		$(libxso_base).@@SOSUFFIX@@.$(SOVERSION)
d45 1
a45 1
@@@@ -71,11 +71,11 @@@@ JAVA_DBDIR=	$(JAVA_SRCDIR)/com/sleepycat
d61 1
a61 1
@@@@ -86,10 +86,10 @@@@ libjso_g=	$(libjso_base)-$(SOVERSION)_g.
d67 1
a67 1
+libtso=		$(libtso_base).@@SOSUFFIX@@.$(SOVERSION)
d75 1
a75 1
@@@@ -112,7 +112,8 @@@@ exec_prefix=@@exec_prefix@@
d85 24
a108 1
@@@@ -398,7 +399,7 @@@@ install_include:
d117 1
a117 1
@@@@ -424,9 +425,9 @@@@ install_dynamic: install_setup
d128 1
a128 1
@@@@ -435,6 +436,7 @@@@ install_dynamic_cxx: install_setup
d136 1
a136 1
@@@@ -445,6 +447,7 @@@@ install_tcl: install_setup
d144 1
a144 1
@@@@ -465,13 +468,14 @@@@ install_docs: install_setup
@


1.3
log
@use tcl 8.4
fix packaging on NO_SHARED_ARCHS
bump PKGNAME
@
text
@d1 3
a3 3
$OpenBSD: patch-dist_Makefile_in,v 1.2 2003/12/11 06:49:17 sturm Exp $
--- dist/Makefile.in.orig	2000-07-18 17:37:57.000000000 +0200
+++ dist/Makefile.in	2004-01-09 23:47:00.000000000 +0100
d74 9
d109 16
@


1.2
log
@set symlinks to *all* shared libraries
bump PKGNAMEs
noticed by brad@@
@
text
@d1 3
a3 3
$OpenBSD: patch-dist_Makefile_in,v 1.1.1.1 2003/12/08 17:37:55 sturm Exp $
--- dist/Makefile.in.orig	2000-07-18 17:37:35.000000000 +0200
+++ dist/Makefile.in	2003-12-11 07:20:07.000000000 +0100
d92 8
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
$OpenBSD: patch-dist_Makefile_in,v 1.3 2001/09/07 16:06:08 heko Exp $
d3 1
a3 1
+++ dist/Makefile.in	2003-12-07 12:09:59.000000000 +0100
d85 8
@


1.1.1.1
log
@split import of versions v3 and v4 of Berkeley DB
@
text
@@
