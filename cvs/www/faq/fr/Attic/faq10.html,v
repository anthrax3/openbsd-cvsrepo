head	1.92;
access;
symbols;
locks; strict;
comment	@# @;


1.92
date	2014.04.01.17.03.09;	author nick;	state dead;
branches;
next	1.91;

1.91
date	2013.11.06.17.16.47;	author ajacoutot;	state Exp;
branches;
next	1.90;

1.90
date	2013.07.23.06.21.49;	author ajacoutot;	state Exp;
branches;
next	1.89;

1.89
date	2013.06.07.13.38.23;	author ajacoutot;	state Exp;
branches;
next	1.88;

1.88
date	2013.05.09.13.43.01;	author ajacoutot;	state Exp;
branches;
next	1.87;

1.87
date	2013.03.08.15.50.18;	author ajacoutot;	state Exp;
branches;
next	1.86;

1.86
date	2013.02.10.00.07.09;	author ajacoutot;	state Exp;
branches;
next	1.85;

1.85
date	2012.11.02.07.24.04;	author ajacoutot;	state Exp;
branches;
next	1.84;

1.84
date	2012.08.13.10.14.16;	author ajacoutot;	state Exp;
branches;
next	1.83;

1.83
date	2012.07.23.16.03.56;	author ajacoutot;	state Exp;
branches;
next	1.82;

1.82
date	2012.05.30.20.26.15;	author ajacoutot;	state Exp;
branches;
next	1.81;

1.81
date	2012.05.26.08.43.41;	author ajacoutot;	state Exp;
branches;
next	1.80;

1.80
date	2012.05.08.17.23.35;	author ajacoutot;	state Exp;
branches;
next	1.79;

1.79
date	2011.05.26.16.59.30;	author ajacoutot;	state Exp;
branches;
next	1.78;

1.78
date	2011.04.09.08.17.17;	author ajacoutot;	state Exp;
branches;
next	1.77;

1.77
date	2010.11.25.16.49.10;	author ajacoutot;	state Exp;
branches;
next	1.76;

1.76
date	2010.11.09.08.15.20;	author ajacoutot;	state Exp;
branches;
next	1.75;

1.75
date	2010.11.02.09.40.25;	author ajacoutot;	state Exp;
branches;
next	1.74;

1.74
date	2010.05.23.16.20.39;	author ajacoutot;	state Exp;
branches;
next	1.73;

1.73
date	2010.05.16.20.33.43;	author ajacoutot;	state Exp;
branches;
next	1.72;

1.72
date	2009.11.08.22.09.17;	author tobias;	state Exp;
branches;
next	1.71;

1.71
date	2009.11.07.07.32.54;	author ajacoutot;	state Exp;
branches;
next	1.70;

1.70
date	2009.10.20.20.44.41;	author ajacoutot;	state Exp;
branches;
next	1.69;

1.69
date	2009.05.26.21.30.39;	author ajacoutot;	state Exp;
branches;
next	1.68;

1.68
date	2009.05.01.13.16.22;	author tobias;	state Exp;
branches;
next	1.67;

1.67
date	2009.04.26.15.44.20;	author tobias;	state Exp;
branches;
next	1.66;

1.66
date	2008.12.01.07.52.52;	author tobias;	state Exp;
branches;
next	1.65;

1.65
date	2008.07.13.18.21.56;	author tobias;	state Exp;
branches;
next	1.64;

1.64
date	2008.04.28.08.25.41;	author tobias;	state Exp;
branches;
next	1.63;

1.63
date	2008.02.02.17.34.39;	author saad;	state Exp;
branches;
next	1.62;

1.62
date	2008.01.19.17.39.43;	author saad;	state Exp;
branches;
next	1.61;

1.61
date	2007.03.16.19.15.24;	author jufi;	state Exp;
branches;
next	1.60;

1.60
date	2007.02.21.10.27.59;	author jufi;	state Exp;
branches;
next	1.59;

1.59
date	2007.02.06.06.04.56;	author saad;	state Exp;
branches;
next	1.58;

1.58
date	2007.02.04.08.19.55;	author saad;	state Exp;
branches;
next	1.57;

1.57
date	2007.02.02.06.46.52;	author saad;	state Exp;
branches;
next	1.56;

1.56
date	2007.01.29.22.16.09;	author saad;	state Exp;
branches;
next	1.55;

1.55
date	2006.11.10.10.44.45;	author jufi;	state Exp;
branches;
next	1.54;

1.54
date	2006.11.03.14.23.31;	author jufi;	state Exp;
branches;
next	1.53;

1.53
date	2006.09.13.11.40.59;	author jufi;	state Exp;
branches;
next	1.52;

1.52
date	2006.09.12.07.34.05;	author jufi;	state Exp;
branches;
next	1.51;

1.51
date	2006.09.08.20.49.53;	author saad;	state Exp;
branches;
next	1.50;

1.50
date	2006.09.07.05.25.50;	author saad;	state Exp;
branches;
next	1.49;

1.49
date	2006.08.31.07.52.39;	author jufi;	state Exp;
branches;
next	1.48;

1.48
date	2006.08.24.12.42.01;	author jufi;	state Exp;
branches;
next	1.47;

1.47
date	2006.06.26.18.32.12;	author jufi;	state Exp;
branches;
next	1.46;

1.46
date	2006.05.24.06.48.44;	author jufi;	state Exp;
branches;
next	1.45;

1.45
date	2006.04.25.16.49.42;	author jufi;	state Exp;
branches;
next	1.44;

1.44
date	2006.04.18.16.51.34;	author jufi;	state Exp;
branches;
next	1.43;

1.43
date	2006.04.06.17.23.11;	author jufi;	state Exp;
branches;
next	1.42;

1.42
date	2006.03.30.18.51.32;	author saad;	state Exp;
branches;
next	1.41;

1.41
date	2006.03.10.16.35.06;	author saad;	state Exp;
branches;
next	1.40;

1.40
date	2006.02.24.22.10.54;	author saad;	state Exp;
branches;
next	1.39;

1.39
date	2005.11.25.00.26.21;	author saad;	state Exp;
branches;
next	1.38;

1.38
date	2005.11.03.11.30.52;	author saad;	state Exp;
branches;
next	1.37;

1.37
date	2005.11.02.00.40.41;	author saad;	state Exp;
branches;
next	1.36;

1.36
date	2005.08.24.06.42.32;	author saad;	state Exp;
branches;
next	1.35;

1.35
date	2005.06.13.13.11.43;	author saad;	state Exp;
branches;
next	1.34;

1.34
date	2005.05.25.04.52.28;	author saad;	state Exp;
branches;
next	1.33;

1.33
date	2005.05.22.17.38.06;	author saad;	state Exp;
branches;
next	1.32;

1.32
date	2005.02.13.17.40.34;	author saad;	state Exp;
branches;
next	1.31;

1.31
date	2005.01.28.09.03.50;	author saad;	state Exp;
branches;
next	1.30;

1.30
date	2005.01.24.09.25.15;	author saad;	state Exp;
branches;
next	1.29;

1.29
date	2005.01.21.16.59.41;	author saad;	state Exp;
branches;
next	1.28;

1.28
date	2005.01.18.09.54.29;	author jufi;	state Exp;
branches;
next	1.27;

1.27
date	2004.12.06.06.47.49;	author saad;	state Exp;
branches;
next	1.26;

1.26
date	2004.11.03.21.01.24;	author saad;	state Exp;
branches;
next	1.25;

1.25
date	2004.10.31.22.05.01;	author jufi;	state Exp;
branches;
next	1.24;

1.24
date	2004.10.25.13.55.37;	author saad;	state Exp;
branches;
next	1.23;

1.23
date	2004.09.09.20.43.23;	author saad;	state Exp;
branches;
next	1.22;

1.22
date	2004.08.31.16.16.23;	author saad;	state Exp;
branches;
next	1.21;

1.21
date	2004.08.18.16.29.06;	author jufi;	state Exp;
branches;
next	1.20;

1.20
date	2004.06.01.18.59.57;	author jufi;	state Exp;
branches;
next	1.19;

1.19
date	2004.05.20.09.58.51;	author jufi;	state Exp;
branches;
next	1.18;

1.18
date	2004.03.26.08.40.41;	author jufi;	state Exp;
branches;
next	1.17;

1.17
date	2004.03.14.21.41.01;	author jufi;	state Exp;
branches;
next	1.16;

1.16
date	2004.03.10.13.09.41;	author jufi;	state Exp;
branches;
next	1.15;

1.15
date	2004.03.02.13.50.41;	author jufi;	state Exp;
branches;
next	1.14;

1.14
date	2004.03.01.09.26.08;	author jufi;	state Exp;
branches;
next	1.13;

1.13
date	2004.01.03.19.44.34;	author jufi;	state Exp;
branches;
next	1.12;

1.12
date	2003.11.18.21.00.16;	author horacio;	state Exp;
branches;
next	1.11;

1.11
date	2003.11.14.22.44.23;	author horacio;	state Exp;
branches;
next	1.10;

1.10
date	2003.06.21.12.19.07;	author jufi;	state Exp;
branches;
next	1.9;

1.9
date	2003.05.12.19.07.12;	author jufi;	state Exp;
branches;
next	1.8;

1.8
date	2003.05.08.15.49.27;	author jufi;	state Exp;
branches;
next	1.7;

1.7
date	2003.05.06.21.18.01;	author jufi;	state Exp;
branches;
next	1.6;

1.6
date	2003.05.04.18.06.03;	author jufi;	state Exp;
branches;
next	1.5;

1.5
date	2003.05.03.07.43.06;	author jufi;	state Exp;
branches;
next	1.4;

1.4
date	2002.07.30.07.19.30;	author jufi;	state Exp;
branches;
next	1.3;

1.3
date	2002.05.08.11.05.46;	author jufi;	state Exp;
branches;
next	1.2;

1.2
date	2002.05.02.20.41.54;	author jufi;	state Exp;
branches;
next	1.1;

1.1
date	2002.05.01.08.07.51;	author jufi;	state Exp;
branches;
next	;


desc
@@


1.92
log
@
Abandon translations, per deraadt@@ and ajacoutot@@.
Thanks to all those that did the translation work, and my appologies to
those who had to translate my writing!
@
text
@<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>10 - Gestion du Système</title>
<link rev= "made" href= "mailto:www@@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name= "resource-type" content= "document">
<meta name= "description"   content= "OpenBSD FAQ 10 - System Management">
<meta name= "keywords"      content= "openbsd,faq10">
<meta name= "distribution"  content= "global">
<meta name= "copyright"     content= "This document copyright 1998-2013 by OpenBSD.">
</head>

<body bgcolor= "#ffffff" text= "#000000">
<a href="../../fr/index.html">
<img alt="[OpenBSD]" height=30 width=141 src="../../images/smalltitle.gif" border="0">    
</a>
<p>
<font color= "#0000e0">
<a href= "index.html">[Index de la FAQ]</a>
<a href= "faq9.html">[Section 9 - Migrer vers OpenBSD]</a>
<a href= "faq11.html">[Section 11 - Le système X Window]</a>
</font>

<h1><font color="#e00000">10 - Gestion du Système</font></h1> 
<hr>

<p>
<h3>Table des matières</h3>
<ul>
  <li><a href="#wheel"         >10.1 - Quand j'essaie de passer root à l'aide de su, on me dit que je suis dans le mauvais groupe.</a> 
  <li><a href="#DupFS"         >10.2 - Comment dupliquer un système de fichiers ?</a> 
  <li><a href="#rc"            >10.3 - Comment démarrer des services en même temps que le système ? (Vue d'ensemble de rc(8))</a> 
  <li><a href="#RelayingDenied">10.4 - Pourquoi les utilisateurs sont interdits de relais quand ils envoient des mails à distance à travers mon système OpenBSD ?</a> 
  <li><a href="#POP"           >10.5 - J'ai mis en place POP, mais j'ai des erreurs quand j'accède à ma messagerie via POP. Que puis-je faire ?</a> 
  <li><a href="#SendmailDNS"   >10.6 - Pourquoi Sendmail ignore-t-il le
fichier /etc/hosts ?</a>
  <li><a href="#HTTPS"         >10.7 - Configurer HTTP en mode sécurisé à l'aide de ssl(8)</a> 
  <li><a href="#vipw"          >10.8 - J'ai effectué des changements dans /etc/passwd avec vi(1), mais les changements ne semblent pas être pris en compte. Pourquoi ?</a> 
  <li><a href="#AddDelUser"    >10.9 - Comment puis-je créer/supprimer un compte utilisateur ?</a> 
  <li><a href="#FTPOnly"       >10.10 - Comment puis-je créer un compte pour ftp uniquement ?</a> 
  <li><a href="#Quotas"        >10.11 - Mise en place des quotas </a>
  <li><a href="#Kerberos"      >10.12 - Mise en place de Clients et Serveurs KerberosV</a>
  <li><a href="#AnonFTP"       >10.13 - Mise en place d'un serveur FTP Anonyme</a>
  <li><a href="#ftpchroot"     >10.14 - Confiner les utilisateurs à leur répertoire HOME avec ftpd(8)</a> 
  <li><a href="#Patches"       >10.15 - Appliquer des correctifs sous OpenBSD</a>
  <li><a href="#httpdchroot"   >10.16 - Parlez-moi de chroot(2) Apache</a>
  <li><a href="#rootshell" >10.17 - Puis-je changer le shell de
      l'utilisateur root ?</a>
  <li><a href="#ksh"           >10.18 - Que puis-je faire d'autre avec ksh ?</a>
  <li><a href="#Dir"           >10.19 - Services d'annuaires</a>
  <ul>
   <li><a href="#Dir.available" >10.19.1 - Quels sont les services d'annuaires 
   disponibles ?</a>
   <li><a href="#YP_secure"     >10.19.2 - Considérations sur la sécurité de YP</a>
   <li><a href="#YP_server"     >10.19.3 - Configurer un serveur YP</a>
   <li><a href="#YP_client"     >10.19.4 - Configurer un client YP</a>
  </ul>
<li><a href="#locales"         >10.20 - Jeux de caractères et localisation</a>
<ul>
  <li><a href="#charset"       >10.20.1 - Configurer le jeu de caractère actif</a>
  <li><a href="#nls"           >10.20.2 - Changer la langue des messages d'applications</a>
</ul>
</ul>

<hr>

<p>
<a name= "wheel"></a>
<h2>10.1 - Quand j'essaie de passer root à l'aide de su, on me
    dit que je suis dans le mauvais groupe</h2>

<p>
Sous OpenBSD, les utilisateurs appartenant au groupe <kbd>wheel</kbd> sont
autorisés à utiliser le programme
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=su&amp;sektion=1">su(1)</a>
pour devenir root. Sinon ils auront une erreur.

<p>Si vous créez un utilisateur avec 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=adduser&amp;sektion=8">adduser(8)</a>, 
vous pouvez l'ajouter dans le groupe wheel en répondant wheel à la
question "<tt>Invite <i>user</i> into other groups:</tt>". 
Les utilisateurs existant sur le système doivent être rajoutés au groupe
<kbd>"wheel"</kbd> à la main.
Voici un exemple d'une entrée <kbd>/etc/group</kbd> pour mettre l'utilisateur 
<b>ericj</b> dans le groupe <kbd>"wheel"</kbd> :
 
<blockquote><pre>
wheel:*:0:root,ericj
</pre></blockquote>

<p>
Si vous voulez donner l'accès aux privilèges du super utilisateur, 
sans pour autant mettre les utilisateurs dans le groupe <kbd>"wheel"</kbd>, utilisez
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sudo&amp;sektion=8">sudo(8)</a>. 

<p><a name= "DupFS"></a>
<h2>10.2 - Comment dupliquer un système de fichiers ?</h2>

<p>
Pour dupliquer votre système de fichiers, utilisez 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dump&amp;sektion=8">dump(8)</a> 
et 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=restore&amp;sektion=8">restore(8)</a>. 
Par exemple, pour dupliquer tout ce qu'il y a sous le répertoire
<kbd>SRC</kbd> vers le répertoire <kbd>DST</kbd>, faites un :
<blockquote><pre>
# <b>cd /SRC; dump 0f - . | (cd /DST; restore -rf - )</b>
</pre></blockquote>

<p>
dump est conçu pour vous fournir beaucoup de possibilités de sauvegarde,
et c'est peut-être trop si vous voulez juste dupliquer une partie d'un
système de fichiers (entier). La commande
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tar&amp;sektion=1">tar(1)</a> 
peut être plus rapide pour ce genre d'opération. Le format est très
similaire à celui de dump :

<blockquote><pre>
# <b>cd /SRC; tar cf -  . | (cd /DST; tar xpf - )</b>
</pre></blockquote>

<p>
<a name= "rc"></a>
<h2>10.3 - Comment démarrer des services en même temps que
    le système ? (Vue d'ensemble de rc(8))</h2>

OpenBSD utilise lui-même un démarrage de type 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc&amp;sektion=8">rc(8)</a>.
Il utilise seulement quelques fichiers clés pour le démarrage.
<ul>
  <li>/etc/rc - Script principal. Ne doit pas être édité.
  <li>/etc/rc.conf - Fichier de configuration utilisé par
       <i>/etc/rc </i>pour activer les paramètres 
       démarrés en même temps que le système.
       Ne doit pas être édité.
  <li>/etc/rc.conf.local - Fichier de configuration servant à écraser
       /etc/rc.conf, ainsi vous ne touchez pas à /etc/rc.conf, ce
       qui est important lors de la mise à jour du système.
  <li>/etc/netstart - Script pour initialiser le réseau. Ne devrait pas
       être édité.
  <li>/etc/rc.local - Script utilisé pour l'administration locale. C'est
       là où les informations relatives à de nouveaux services ou des
       informations spécifiques à l'hôte peuvent être stockées.
  <li>/etc/rc.securelevel - Script utilisé pour exécuter des commandes
       qui doivent être exécutées avant que le niveau de sécurité ne
       change. Voir
       <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=init&amp;sektion=8">init(8)</a> 
  <li>/etc/rc.shutdown - Script exécuté lors de l'arrêt de la machine.
       Mettez tout ce que vous voulez exécuter avant l'arrêt de la
       machine dans ce fichier. Voir
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc.shutdown&amp;sektion=8">rc.shutdown(8)</a> 
</ul>

<h3>Comment fonctionne rc(8) ?</h3>

<p>
<i>/etc/rc.conf</i> (comme guide), <i>/etc/rc.conf.local</i> (pour les
    changements), <i>/etc/rc.local</i>
    et <i>/etc/rc.shutdown</i> sont les principaux fichiers à connaître
    par l'administrateur système. Pour comprendre le fonctionnement de
    la procédure rc(8), en voici le déroulement :

<p>
<i>/etc/rc </i>est appelé après le démarrage du noyau :
<ul> 
  <li>Les systèmes de fichiers sont vérifiés.
  <li>Les variables de configuration par défaut sont lues à partir de
      <i>/etc/rc.conf</i> et ensuite les changements locaux dans 
      <i>/etc/rc.conf.local</i>. Les
      paramètres dans rc.local.conf vont surpasser ceux se
      trouvant dans rc.conf.
  <li>Les systèmes de fichiers sont montés.
  <li><i>/tmp </i>est nettoyé et les fichiers d'éditeurs sont préservés.
  <li>Le réseau est configuré à l'aide de <i>/etc/netstart</i>
  <ul>
      <li>Les interfaces réseau sont montées.
      <li>Le nom d'hôte et le nom de domaine (ainsi que d'autres
          paramètres) sont positionnés.</ul>
  <li>Les services système sont démarrés.
  <li>Diverses vérifications sont effectuées (quota, savecore, etc).
  <li>Exécute <i>/etc/rc.firsttime</i>
  <li>Exécute <i>/etc/rc.local</i>
  <li>Exécute local et les scripts de package dans <i>/etc/rc.d</i>
</ul>

<h3>Démarrage des services fournis avec OpenBSD</h3>

<p>
La plupart des services fournis avec OpenBSD sont lancés au
démarrage simplement par des variables définies dans le fichier de configuration
<i>/etc/rc.conf</i>. Pour commencer, jetez un coup d'oeil au fichier
<a href="http://www.openbsd.org/cgi-bin/cvsweb/~checkout~/src/etc/rc.conf?content-type=text/plain">/etc/rc.conf</a> 
par défaut. Vous verrez des lignes similaires à la ligne suivante :
 
<blockquote><pre>
ftpd_flags=NO           # for non-inetd use: ftpd_flags=""
</pre></blockquote>

<p>
Une ligne telle que celle-ci montre que 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&amp;sektion=8">ftpd(8)</a>
n'est pas lancé au démarrage du système (du moins pas à travers rc(8);
ftpd est souvent démarré via 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=inetd&amp;sektion=8">inetd(8)</a>,
lisez la <a href="faq10.html#AnonFTP">FAQ Serveur FTP Anonyme</a> pour plus
d'informations). 
Chaque ligne est dotée d'un commentaire qui vous montre les drapeaux 
utilisés dans le cadre d'une utilisation courante du service ou du
démon. 
Cela ne veut pas dire que vous
devez appeler ce service avec ces mêmes drapeaux. Lisez la page man
correspondante pour savoir comment démarrer un service ou démon donné de la
manière que vous souhaitez. 

<p>
Nous vous suggérons fortement de ne pas toucher au fichier <i>/etc/rc.conf</i> 
lui-même.
À la place, créez ou éditez le fichier <i>/etc/rc.conf.local</i>, copiez juste les
lignes que vous désirez modifier de <i>/etc/rc.conf</i> et ajustez-les à
votre convenance. 
Cela permettra de faire les futures mises à jour simplement -- tous les
changements seront dans un seul fichier qui ne sera pas touché lors de la
mise à jour.
<!-- XXX version -->
En fait, le <a href="../upgrade54.html">processus de mise à jour</a> standard
considère que vous n'avez pas modifié <i>/etc/rc.conf</i>, et l'écrasera
avec la nouvelle version.

<p>
Par exemple, voici la ligne par défaut concernant httpd(8) :
<blockquote><pre>
httpd_flags=NO          # for normal use: "" (or "-DSSL" after reading ssl(8))
</pre></blockquote>

<p>
D'après cet exemple, vous pouvez voir qu'aucun drapeau n'est nécessaire
pour démarrer httpd normalement. Ainsi, la ligne <tt>httpd_flags=""</tt>
ajoutée à <i>/etc/rc.conf.local</i> suffit. 
Mais pour démarrer httpd avec le support SSL (reportez-vous à la
<a href="#HTTPS">FAQ SSL</a> ou à
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssl&amp;sektion=8">ssl(8)</a>),
vous devez démarrer httpd avec une ligne comme celle-ci : <tt>httpd_flags="-DSSL"</tt>,
et vous pouvez aussi ajouter d'autres paramètres pour d'autres raisons.

<h3>Démarrage et configuration des services locaux</h3>

<p>
Pour les services que vous installez via les paquetages ou
d'autres méthodes, vous pouvez utiliser le fichier
<i>/etc/rc.local</i>. Par exemple, j'ai installé un service
fourni par l'applicatif /usr/local/sbin/daemonx. Je souhaite que ce
service soit lancé au démarrage. Pour cela, je peux ajouter les lignes
suivantes dans <i>/etc/rc.local</i> :

<blockquote><pre>
if [ -x /usr/local/sbin/daemonx ]; then
	echo 'Starting daemonx'; /usr/local/sbin/daemonx
fi
</pre></blockquote>

<p>
(Si le service ne se détache pas automatiquement lors de son démarrage,
souvenez-vous de rajouter "&amp;" à la fin de la commande.)

<p>
À partir de là, ce service sera lancé au démarrage. Vous pourrez voir
toutes les erreurs au démarrage. Un démarrage normal sans erreurs
affichera le message suivant :
<blockquote><pre>
Starting daemonx
</pre></blockquote>

<h3>Le répertoire <i>/etc/rc.d/</i></h3>
À partir d'OpenBSD 5.0, les démons système ("services") sont démarrés,
stoppés et contrôlés par
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc.d&amp;sektion=8"><i>/etc/rc.d</i></a>.
Tous les démons système sont contrôlés par ces scripts, et la plupart
des <a href="faq15.html">paquetages</a> complémentaires également.

<p>
Ces scripts, un par démon, sont invoqués par <tt>rc</tt>.
La gestion des démons système se code dans <tt>rc</tt>,
et celle pour les paquetages supplémentaires par la
variable d'environnement <tt>pkg_scripts</tt>, qui devrait être
définie dans <tt>/etc/rc.conf.local</tt>.
Notez que le simple fait de placer un script dans ce répertoire
ne suffit pas à le faire s'exécuter au démarrage; le nom du script
doit être spécifié dans la variable <tt>pkg_scripts</tt> pour se
lancer au démarrage.

<p>
Le démarrage des scripts système est déterminé par les entrées
dans le fichier <tt>/etc/rc.conf.local</tt>.
Par exemple, <tt>/etc/rc.d/httpd</tt> ne lance pas
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=httpd&amp;sektion=8">httpd(8)</a>
sauf si le fichier <tt>/etc/rc.conf</tt> ou <tt>/etc/rc.conf.local</tt>
contient une ligne définissant la variable "<tt>httpd_flags</tt>".

Pour vous assurer que votre système sera en place comme
prévu lors du prochain démarrage, les scripts <tt>rc.d</tt>
ne vont pas lancer leurs démons si la variable appropriée
n'est pas définie.
Vous pouvez bien sûr invoquer manuellement <tt>/usr/sbin/httpd</tt>
avec les options que vous voulez, si vous souhaitez lancer
le programme manuellement.

<p>
Il faut remarquer qu'au lieu d'avoir chaque script dans rc.d gérant la
totalité des démarrages, arrêts, rechargements, redémarrages et les opérations
de vérification, la plupart des scripts rc.d peuvent être réduits à juste
spécifier quelques variables et invoquer le script
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc.subr&amp;sektion=8">rc.subr</a>,
qui gère la plupart des façons d'exécuter ces tâches.

<p>
Par exemple, notre application précédente, <tt>daemonx</tt>, pourrait
être lancée avec un fichier <tt>/etc/rc.d</tt> contenant:
 
<blockquote><pre>
#!/bin/sh

daemon="/usr/local/sbin/daemonx"

. /etc/rc.d/rc.subr

rc_cmd $1
</pre></blockquote>

et il faudrait ajouter le nom du démon à la variable <tt>pkg_scripts</tt>
dans <tt>/etc/rc.conf.local</tt>.

<h3>rc.shutdown</h3>

<p>
<i>/etc/rc.shutdown</i> est un script exécuté à l'arrêt de la machine.
Toutes les tâches à effectuer avant l'arrêt du système devront être
ajoutées à ce fichier. Si vous avez apm, vous pouvez aussi positionner
"powerdown=YES". C'est l'équivalent de "shutdown -p".

<p>
<a name= "RelayingDenied"></a>
<h2>10.4 - Pourquoi les utilisateurs sont interdits de relais quand ils
    envoient des mails à distance à travers mon système OpenBSD ?</h2>

<p> 
Essayez ceci : 

<blockquote><pre>
# <b>grep relay-domains /etc/mail/sendmail.cf</b>
</pre></blockquote>

<p>
Le résultat ressemblerait à la ligne suivante :

<blockquote><pre>
FR-o /etc/mail/relay-domains
</pre></blockquote>

<p>
Si ce fichier n'existe pas, créez-le. Vous devez saisir les hôtes qui
envoient des messages à distance en respectant la syntaxe suivante :

<blockquote><pre>
.domain.com    #Allow relaying for/to any host in domain.com
sub.domain.com #Allow relaying for/to sub.domain.com and any host in that domain
10.2           #Allow relaying from all hosts in the IP net 10.2.*.*
</pre></blockquote>

<p>
N'oubliez pas d'envoyer un signal 'HangUP' à sendmail (signal qui
notifie la plupart des processus de relire leur fichier de
configuration) :

<blockquote><pre>
# <b>kill -HUP `head -1 /var/run/sendmail.pid`</b>
</pre></blockquote>

<p>
<h3>Pour plus d'informations </h3>

<p>
<ul>
<li><a href="http://www.sendmail.org/~ca/email/relayingdenied.html">http://www.sendmail.org/~ca/email/relayingdenied.html</a>
<li><a href="http://www.sendmail.org/tips/relaying.php">http://www.sendmail.org/tips/relaying.html</a>
<li><a href="http://www.sendmail.org/antispam/">http://www.sendmail.org/antispam.html</a>
</ul>

<p>
<a name= "POP"></a>
<h2>10.5 - J'ai mis en place POP, mais j'ai des erreurs quand
    j'accède à ma messagerie via POP. Que puis-je faire ? </h2>

<p>
La plupart des problèmes rencontrés avec POP sont liés aux fichiers
temporaires et aux fichiers verrous. Si votre serveur POP renvoie une
erreur du type :

<blockquote><pre>
-ERR Couldn't open temporary file, do you own it?
</pre></blockquote>

<p>
Essayez de positionner les permissions comme suit :

<blockquote><pre>
permission in  /var
drwxrwxr-x   2 bin     mail     512 May 26 20:08 mail


permissions in  /var/mail
-rw-------   1 username   username        0 May 26 20:08 username
</pre></blockquote>

<p>
Vérifiez aussi que l'utilisateur possède son propre fichier /var/mail.
Bien évidemment, ceci devrait être le cas (comme par exemple
l'utilisateur joe qui possède /var/mail/joe) mais si ça n'a pas été
configuré proprement, le problème viendrait de là !

<p>
Bien entendu, si vous donner l'accès à /var/mail en écriture au groupe
mail, vous allez probablement vous exposer à des vagues et obscurs
problèmes de sécurité. Il se pourrait que ça ne pose aucun problème mais
on ne sait jamais (et particulièrement si vous êtes un site de haut vol,
un FAI,...) ! Il existe plusieurs services POP de la collection de ports
OpenBSD. Si possible, utilisez
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=popa3d&amp;sektion=8">popa3d(8)</a> 
disponible dans le système de base d'OpenBSD. Ou peut-être vous avez
sélectionné les mauvaises options pour votre programme POP serveur
(comme le dot locking). Ou vous avez peut-être simplement besoin de
changer le répertoire dans lequel les verrous sont crées (bien que les
opérations de verrouillage ne devraient être bénéfiques qu'au service
POP).

<p>
<b>Note :</b> Il est à noter que OpenBSD n'a pas de groupe "mail". Vous
   devez en créer un, si nécessaire, dans le fichier <i>/etc/group</i>.
   La ligne suivante devrait suffire :

<blockquote><pre>
mail:*:6:
</pre></blockquote>

<p>
<a name="SendmailDNS"></a>
<h2>10.6 - Pourquoi Sendmail ignore-t-il le fichier <tt>/etc/hosts</tt>
    ?</h2>

<p>
Par défaut, Sendmail utilise le DNS pour la résolution de nom, non le
fichier <tt>/etc/hosts</tt>. Ce comportement peut être changé par
l'usage du fichier <tt>/etc/mail/service.switch</tt>.

<p>
Si vous désirez interroger le fichier d'hôtes avant les serveurs DNS,
créez un fichier <tt>/etc/mail/service.switch</tt> contenant les lignes
suivantes :

<blockquote><pre>
hosts       files dns
</pre></blockquote>

<p>
Si vous désirez n'interroger QUE le fichier d'hôtes, utilisez ce qui
suit :

<blockquote><pre>
hosts       files
</pre></blockquote>

<p>
Envoyez un signal HUP à Sendmail :

<blockquote><pre>
# <b>kill -HUP `head -1 /var/run/sendmail.pid`</b>
</pre></blockquote>

<p>
et les changements prendront effet.


<p>
<a name= "HTTPS"></a>
<h2>10.7 - Configurer HTTP en mode sécurisé à
    l'aide de SSL(8)</h2>

<p>
OpenBSD est fourni avec des bibliothèques RSA et un service httpd
supportant SSL. Pour utiliser SSL avec
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=httpd&amp;sektion=8">httpd(8)</a>, 
vous devez d'abord créer un certificat. Ce certificat sera stocké dans
<i>/etc/ssl</i> avec la clef correspondante dans <i>/etc/ssl/private/</i>.
Les étapes décrites ici sont en partie prises de la page de manuel
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssl&amp;sektion=8">ssl(8)</a>. 
Lisez la pour plus d'informations. Cette partie de la FAQ s'intéresse
seulement à la génération d'un certificat RSA pour les serveurs Web.
Elle ne décrit pas les certificats serveur DSA. Pour plus d'informations
à ce sujet, lisez la page de manuel
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssl&amp;sektion=8">ssl(8)</a>.

<p>
Pour commencer, vous aurez besoin de créer votre clé serveur et le
certificat en utilisant OpenSSL :

<blockquote><pre>
# <b>openssl genrsa -out /etc/ssl/private/server.key 2048</b>
</pre></blockquote>

<p>
Ou si vous voulez que la clé soit cryptée avec un mot de passe que vous
devez saisir à chaque démarrage des serveurs

<blockquote><pre>
# <b>openssl genrsa -aes256 -out /etc/ssl/private/server.key 2048</b>
</pre></blockquote>

<p>
La prochaine étape consiste à générer une requête de signature de
certificat qui est utilisée pour permettre à une autorité de
certification (CA) de signer votre certificat. Pour cela, utilisez la
commande suivante :

<blockquote><pre>
# <b>openssl req -new -key /etc/ssl/private/server.key -out /etc/ssl/private/server.csr</b>
</pre></blockquote>

<p>
Le fichier <i>server.csr</i> pourra alors être communiqué à une autorité
de certification qui signera la clé. Une de ces autorités est <b>Thawte
Certification</b> que vous pourrez joindre à l'adresse
<a href="http://www.thawte.com/">http://www.thawte.com/</a>.

<p>
Si vous ne pouvez pas vous permettre un tel service, ou si vous voulez
auto signer le certificat, vous pouvez utiliser la commande suivante :

<blockquote><pre>
# <b>openssl x509 -sha256 -req -days 365 -in /etc/ssl/private/server.csr \
       -signkey /etc/ssl/private/server.key -out /etc/ssl/server.crt</b>
</pre></blockquote>

<p> 
Avec <i>/etc/ssl/server.crt</i> et <i>/etc/ssl/private/server.key</i>,
vous devez être désormais capable de démarrer
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=httpd&amp;sektion=8">httpd(8)</a> 
avec le drapeau <b>-DSSL</b> (consultez la
<a href="#rc">section à propos de rc(8) dans cette faq</a>), activant
ainsi les transactions https sur le port 443 de votre machine.

<p>
<a name= "vipw"></a>
<h2>10.8 - J'ai effectué des changements dans /etc/passwd avec
    vi(1), mais les changements ne semblent pas être pris en compte.
    Pourquoi ?</h2>

<p>
Si vous éditez <i>/etc/passwd</i>, vos modifications seront perdues.
OpenBSD génère <i>/etc/passwd</i> dynamiquement avec
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pwd_mkdb&amp;sektion=8">pwd_mkdb(8)</a>. 
Le fichier principal de mots de passe sous OpenBSD est
<i>/etc/master.passwd</i>. D'après pwd_mkdb(8),

<blockquote><pre>
FILES
     /etc/master.passwd  fichier courant de mots de passe 
     /etc/passwd         fichier de mots de passe au style "6th Edition"
     /etc/pwd.db         fichier non sécurisé de mots de passe au format base de données
     /etc/pwd.db.tmp     fichier temporaire
     /etc/spwd.db        fichier sécurisé de mots de passe au format base de données
     /etc/spwd.db.tmp    fichier temporaire
</pre></blockquote>

<p>
Dans un fichier de mots de passe Unix traditionnel, toutes les
informations y compris le mot de passe crypté de l'utilisateur sont à la
disposition de n'importe quel utilisateur du système (et c'est la cible
principale de programmes tels que Crack). 4.4BSD a introduit le fichier
master.passwd qui a un format étendu (avec les options additionnelles
par rapport à /etc/passwd). Ce fichier n'est accessible que pour root.
Pour un accès plus rapide aux données, les appels à la bibliothèque qui
utilisent ce type d'informations accèdent normalement à /etc/pwd.db et à
/etc/spwd.db.

<p>
OpenBSD met à votre disposition un outil qui vous permet d'éditer le
fichier de mots de passe. Cet outil s'appelle 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>. 
vipw utilisera vi
(ou votre éditeur favori tel que défini par $EDITOR) pour éditer
/etc/master.passwd. Suite à vos modifications, vipw recréera
/etc/passwd, /etc/pwd.db et /etc/spwd.db qui tiendront compte de vos
modifications. vipw verrouille aussi l'accès à ces fichiers de telle
façon à en interdire l'accès à quiconque essaie d'en changer le contenu
en même temps que vous.

<p>
<a name= "AddDelUser"></a>
<h2>10.9 - Comment puis-je créer/supprimer un compte utilisateur ?</h2>

<p>
OpenBSD offre deux commandes pour facilement créer des comptes
utilisateurs sur le système :
<ul>
        <li><a href="#adduser">adduser(8)</a>
        <li><a href="#user">user(8)</a>
</ul>

Il est toujours possible de créer des utilisateurs à la main en utilisant
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>,
mais cela complique la plupart des étapes.

<a name="adduser"></a> 
<p>
La manière la plus facile pour créer un compte utilisateur sous OpenBSD
est d'utiliser le script
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=adduser&amp;sektion=8">adduser(8)</a>.
Ce script est paramétrable à travers le fichier <i>/etc/adduser.conf</i>. 
adduser(8) permet d'effectuer des vérifications sur la cohérence de
<i>/etc/passwd</i>, <i>/etc/group</i> et les bases de données shell.
adduser(8) crée pour vous les entrées correspondantes et les répertoires
$HOME. Il peut aussi envoyer un message de bienvenue aux utilisateurs.
Le comportement de ce programme peut être adapté à vos besoins. Pour
illustrer notre propos, prenons comme exemple la création du compte
<b>testuser</b>. Le répertoire de cet utilisateur sera
<i>/home/testuser</i>. L'utilisateur fera partie du groupe <b>guest
</b>comme groupe et aura un shell <i>/bin/ksh </i>.

<blockquote><pre>
# <b>adduser</b>
Use option ``-silent'' if you don't want to see all warnings and questions.

Reading /etc/shells
Check /etc/master.passwd
Check /etc/group

Ok, let's go.
Don't worry about mistakes. There will be a chance later to correct any input.
Enter username []: <b>testuser</b>
Enter full name []: <b>Test FAQ User</b>
Enter shell csh ksh nologin sh [ksh]: <b>ksh</b>
Uid [1002]: <b><i>Entrée</i></b>
Login group testuser [testuser]: <b>guest</b>
Login group is ``guest''. Invite testuser into other groups: guest no 
[no]: <b>no</b>
Login class authpf daemon default staff [default]: <b><i>Enter</i></b>
Enter password []: <b><i>Type password, then Enter</i></b>
Enter password again []: <b><i>Type password, then Enter</i></b>

Name:        testuser
Password:    ****
Fullname:    Test FAQ User
Uid:         1002
Gid:         31 (guest)
Groups:      guest
Login Class: default
HOME:        /home/testuser
Shell:       /bin/ksh
OK? (y/n) [y]: <b>y</b>
Added user ``testuser''
Copy files from /etc/skel to /home/testuser
Add another user? (y/n) [y]: <b>n</b>
Goodbye!
</pre></blockquote>

<p>
Pour supprimer des comptes utilisateurs, utilisez la commande 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rmuser&amp;sektion=8">rmuser(8)</a>. 
Cette commande supprimera toute chose relative à l'utilisateur. Elle
supprimera son entrée
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=crontab&amp;sektion=1">crontab(1)</a>, 
son répertoire $HOME (s'il lui appartient) et son courrier. Bien
évidemment, cette commande supprimera aussi les entrées correspondantes
dans <i>/etc/passwd</i> et <i>/etc/group</i>. Comme exemple, nous allons
utiliser cette commande pour supprimer le compte utilisateur
précédemment crée. Notez que la commande vous demande l'identifiant du
compte et si oui ou non elle doit supprimer le répertoire home de
l'utilisateur.

<blockquote><pre>
# <b>rmuser</b>
Enter login name for user to remove: <b>testuser</b>
Matching password entry:

testuser:$2a$07$ZWnBOsbqMJ.ducQBfsTKUe3PL97Ve1AHWJ0A4uLamniLNXLeYrEie:1002
:31::0:0:Test FAQ User:/home/testuser:/bin/ksh

Is this the entry you wish to remove? <b>y</b>
Remove user's home directory (/home/testuser)? <b>y</b>
Updating password file, updating databases, done.
Updating group file: done.
Removing user's home directory (/home/testuser): done.
</pre></blockquote>

<a name="user"></a>
<h3>Créer des comptes utilisateurs via user(8)</h3>

<p>
Ces outils sont moins interactifs que la commande 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=adduser&amp;sektion=8">adduser(8)</a>, 
ce qui en facilite l'usage dans des scripts.

<p>
La liste complète des outils est :
<ul>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=group&amp;sektion=8">group(8)</a> 
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=groupadd&amp;sektion=8">groupadd(8)</a> 
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=groupdel&amp;sektion=8">groupdel(8)</a> 
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=groupinfo&amp;sektion=8">groupinfo(8)</a> 
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=groupmod&amp;sektion=8">groupmod(8)</a> 
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=user&amp;sektion=8">user(8)</a> 
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=useradd&amp;sektion=8">useradd(8)</a> 
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=userdel&amp;sektion=8">userdel(8)</a> 
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=userinfo&amp;sektion=8">userinfo(8)</a> 
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=usermod&amp;sektion=8">usermod(8)</a> 
</ul>

<h4>Création effective des comptes utilisateurs</h4>

<p>
La commande <i>/usr/sbin/user</i> est juste un frontal pour le reste des
commandes <i>/usr/sbin/user*</i>.
Par conséquent, les commandes suivantes peuvent être ajoutées à l'aide de
<b>user add</b> ou <b>useradd</b>, qui font que ce que vous avez choisi ne
change pas les résultats à tous.
Rappelez-vous, puisque user(8) n'est pas interactif, le plus simple pour
ajouter des utilisateurs c'est avec adduser(8).
useradd (8) est moins intimidant à utiliser si vous connaissez les paramètres 
par défaut à l'avance.
Ces paramètres se trouvent dans le fichier
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=usermgmt.conf&amp;sektion=5">usermgmt.conf(5)</a>
et peuvent être visualisés comme suit :

<blockquote><pre>
$ <b>user add -D</b>
group           users
base_dir        /home
skel_dir        /etc/skel
shell           /bin/csh
inactive        0
expire          Null (unset)
range           1000..60000
</pre></blockquote>

<p>
Ces paramètres vont être utilisés tant que vous ne
changez pas leur valeur en utilisant des options en ligne de commande.
Par exemple, nous voulons que l'utilisateur soit ajouté
au groupe <b>guest </b> et non pas à <b>users</b>. Il est à noter que
lors de la création des comptes utilisateurs, les mots de passe doivent
être spécifiés en ligne de commande. Le plus important, les mots de passe
doivent être chiffrés, vous devez donc utiliser, au préalable, l'utilitaire
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=encrypt&amp;sektion=1">encrypt(1)</a>.
Par exemple : Les mots de passe par défaut
sous OpenBSD utilisent l'algorithme Blowfish avec 6 réitérations. Voici un exemple
pour créer un mot de passe chiffré pour le donner à useradd(8) :

<blockquote><pre>
$ <b>encrypt -p -b 6</b>
Enter string:
$2a$06$YOdOZM3.4m6MObBXjeZtBOWArqC2.uRJZXUkOghbieIvSWXVJRzlq
</pre></blockquote>

<p> 
Maintenant que nous avons un mot de passe chiffré, nous sommes prêts à
créer le compte utilisateur.
Nous allons ajouter le même utilisateur avec les mêmes spécifications que
l'utilisateur que nous avons ajouté <a href="#adduser">plus haut</a>, via
adduser(8).

<blockquote><pre>
# <b>user add -p '$2a$06$YOdOZM3.4m6MObBXjeZtBOWArqC2.uRJZXUkOghbieIvSWXVJRzlq' -u 1002 \
-s /bin/ksh -c "Test FAQ User" -m -g guest testuser</b>
</pre></blockquote>

<p>
<b>Remarque :</b> Assurez vous d'utiliser " pour englober le mot de
   passe. L'utilisation de "" ne permet pas d'empêcher le shell
   d'interpréter le jeu de caractères correspondant au mot de passe
   avant de les communiquer à user(8). De même, assurez vous d'utiliser
   l'option <b>-m </b>si vous voulez créer le répertoire $HOME de
   l'utilisateur et copier les fichiers à partir de <i>/etc/skel</i>
   vers $HOME.

<p>
Pour voir si le compte utilisateur a été correctement crée, nous pouvons
recourir à plusieurs utilitaires. Voici quelques commandes pour vérifier
rapidement que tout s'est bien passé :

<blockquote><pre>
$ <b>ls -la /home</b>
total 14
drwxr-xr-x   5 root      wheel   512 May 12 14:29 .
drwxr-xr-x  15 root      wheel   512 Apr 25 20:52 ..
drwxr-xr-x  24 ericj     wheel  2560 May 12 13:38 ericj
drwxr-xr-x   2 testuser  guest   512 May 12 14:28 testuser
$ <b>id testuser</b>
uid=1002(testuser) gid=31(guest) groups=31(guest)
$ <b>finger testuser</b>
Login: testuser                         Name: Test FAQ User
Directory: /home/testuser               Shell: /bin/ksh
Last login Sat Apr 22 16:05 (EDT) on ttyC2
No Mail.
No Plan.
</pre></blockquote>

<p>
En plus de ces commandes, user(8) fournit son propre utilitaire, appelé
userinfo(8), qui permet d'afficher les caractéristiques d'un compte
utilisateur :

<blockquote><pre>
$ <b>userinfo testuser</b>
login   testuser
passwd  *
uid     1002
groups  guest
change  Wed Dec 31 19:00:00 1969
class
gecos   Test FAQ User
dir     /home/testuser
shell   /bin/ksh
expire  Wed Dec 31 19:00:00 1969
</pre></blockquote>

<h4>Suppression des comptes utilisateurs</h4>

<p>
Pour supprimer des comptes utilisateurs avec la hiérarchie de commandes
user(8), vous devez utiliser userdel(8). Cette commande est simple et
efficace. Pour supprimer le compte précédemment crée, utilisez :

<blockquote><pre>
# <b>userdel -r testuser</b>
</pre></blockquote>

<p>
Notez bien l'option <b>-r</b> qui doit être spécifiée si vous voulez
supprimer les répertoires $HOME aussi. Si vous voulez juste bloquer
l'accès au compte sans supprimer des informations liées au compte,
utilisez <b>-p</b> au lieu de <b>-r</b>.

<p>
<a name= "FTPOnly"></a>
<h2>10.10 - Comment puis-je créer un compte pour ftp uniquement
    ?</h2>

<p>
Il y a plusieurs méthodes pour effectuer cette opération.
Une des manières les plus communes est d'ajouter
<tt>/usr/bin/false</tt>" à "<tt>/etc/shells</tt>".
A partir de là, lorsque vous affectez "<tt>/usr/bin/false</tt>" à un
utilisateur, il ne sera plus capable d'ouvrir une session interactive
sur le système, néanmoins il pourra utiliser le service ftp.
Vous souhaiterez peut-être aussi restreindre l'accès en
<a href="#ftpchroot">Confiner les utilisateurs à leur répertoire HOME avec ftpd(8)</a>.

<p>
<a name= "Quotas"></a>
<h2>10.11 - Mise en place des quotas</h2>

<p>
Les quotas sont utilisés pour limiter l'espace disque disponible pour
les utilisateurs. Ce système peut être très utile si vous avez des
ressources limitées. Les quotas peuvent être configurés par utilisateur
et/ou par groupe.


<p>
La première étape pour configurer les quotas est de s'assurer que
<tt>option QUOTA</tt> est présente dans votre
<a href="faq5.html#Options">configuration noyau</a>. Cette option est
incluse dans le noyau GENERIC. Ensuite, vous aurez besoin de marquer les
systèmes de fichiers où les quotas sont utilisés dans le fichier

<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fstab&amp;sektion=5"><tt>/etc/fstab</tt></a>. 
Les mots clés <tt>userquota</tt> et <tt>groupquota</tt> doivent être
utilisés pour marquer chaque système de fichiers où les quotas sont
activés. Par défaut, les fichiers <tt>quota.user</tt> et
<tt>quota.group</tt> seront crées à la racine des systèmes de fichiers
où les quotas sont utilisés pour stocker les informations relatives à
ces derniers. Si vous voulez les créer ailleurs, spécifiez un fichier
avec l'option des quotas dans <tt>/etc/fstab</tt>, par exemple
"<tt>userquota=/var/quotas/quota.user</tt>". Voici un exemple de
<tt>/etc/fstab</tt> avec un système de fichiers avec quotas activés et
le fichier de quotas se trouvant dans un endroit non-standard :

<blockquote><pre>
/dev/wd0a / ffs rw,userquota=/var/quotas/quota.user 1 1
</pre></blockquote>

<p>
Maintenant, il faut configurer les quotas par utilisateur. À cette fin,
nous utilisons la commande
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=edquota&amp;sektion=8">edquota(8)</a>. 
Une utilisation simple est "<tt>edquota&nbsp;&lt;user&gt;</tt>".
edquota(8) va utiliser vi(1) pour éditer les quotas à moins que la
variable d'environnement EDITOR est positionnée pour charger un autre
éditeur. Par exemple la commande :

<blockquote><pre>
# <b>edquota ericj</b>
</pre></blockquote>

<p>
Affichera un résultat similaire à :

<blockquote><pre>
Quotas for user ericj:
/: KBytes in use: 62, limits (soft = 0, hard = 0)
        inodes in use: 25, limits (soft = 0, hard = 0)
</pre></blockquote>

<p>
Pour ajouter des limites, éditer là pour donner un résultat similaire à
:

<blockquote><pre>
Quotas for user ericj:
/: KBytes in use: 62, limits (soft = 1000, hard = 1050)
        inodes in use: 25, limits (soft = 0, hard = 0)
</pre></blockquote>

<p>
Notez que l'allocation de quotas est en blocs de 1k. Dans ce cas-ci,
softlimit est fixé à 1000k et hardlimit à 1050k. softlimit est une
limite qui permet au système de prévenir les utilisateurs quand ils
l'ont dépassé. Ils auront alors jusqu'à la fin de leur période de grâce
pour redescendre en dessous de cette limite. Les périodes de grâce
peuvent être configurées à l'aide de l'option <b>-t</b> de edquota(8).
Après la fin de la période de grâce, softlimit est géré comme hardlimit.
Ce qui cause un échec d'allocation.

<p>
Une fois les quotas configurés, il faut les activer. Pour cela, utilisez
la commande
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=quotaon&amp;sektion=8">quotaon(8)</a>. 
Par exemple :

<blockquote><pre>
# <b>quotaon -a</b>
</pre></blockquote>

<p>
Cette commande analysera le contenu de <tt>/etc/fstab</tt> et activera
les quotas sur les systèmes de fichiers où les options de quota sont
positionnées. Maintenant que les quotas sont activés, vous pouvez les
visualiser à l'aide de
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=quota&amp;sektion=1">quota(1)</a>. 
Ainsi, la commande "<tt>quota &lt;user&gt;</tt>" fournit les
informations concernant cet utilisateur. Si aucun argument n'est
utilisé, quota vous fournira des statistiques sur les quotas. Par
exemple :

<blockquote><pre>
# <b>quota ericj</b>
</pre></blockquote>

<p>
Afficherait :

<blockquote><pre>
Disk quotas for user ericj (uid 1001): 
     Filesystem  blocks   quota   limit   grace   files   quota   limit   grace
              /      62    1000    1050              27       0       0        
</pre></blockquote>

<p>
Par défaut, les quotas positionnés dans <tt>/etc/fstab</tt> seront
activés au démarrage. Pour les désactiver, utilisez :

<blockquote><pre>
# <b>quotaoff -a</b>
</pre></blockquote>

<p>
<a name= "Kerberos"></a>
<h2>10.12 - Mise en place de Clients et Serveurs KerberosV</h2>

<p>
OpenBSD inclut KerberosV comme un composant pré-installé sur le système
par défaut.

<p>
Pour plus d'information concernant KerberosV, sur votre système OpenBSD,
utilisez la commande :

<blockquote><pre>
  # <b>info heimdal</b>
</pre></blockquote>

<p>
<a name= "AnonFTP"></a>
<h2>10.13 - Mise en place d'un serveur FTP Anonyme</h2>

<p>
Le mode FTP anonyme permet à des utilisateurs sans compte d'accéder aux
fichiers sur votre machine en utilisant le protocole de transfert de
fichiers. Ce chapitre a pour but de fournir une vue d'ensemble de la
configuration d'un serveur FTP anonyme, les logs générés, etc...

<h3>Création du compte FTP</h3>

<p>
La première étape consiste à créer un compte <i>ftp</i> sur votre
système. Ce compte ne doit pas avoir de mot de passe utilisable. Dans
cet exemple, nous allons considérer que /home/ftp est le répertoire
correspondant au compte "ftp" mais vous n'êtes pas obligé de choisir la
même chose. Quand le mode anonyme est utilisé, le service ftp va se
confiner au répertoire HOME de l'utilisateur <i>ftp</i> (dans notre cas,
ce répertoire est /home/ftp). Pour en savoir plus, lisez les pages du
manuel
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&amp;sektion=8">ftpd(8)</a> 
et 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=chroot&amp;sektion=2">chroot(2)</a>. 
Voici un exemple de création du compte <i>ftp</i> en utilisant la
commande
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=adduser&amp;sektion=8">adduser(8)</a>. 
Au préalable, nous avons besoin d'ajouter /usr/bin/false au fichier
<i>/etc/shells</i>. C'est le shell que nous allons attribuer à
l'utilisateur <i>ftp</i>. Il ne permettra pas de connexion en login à ce
compte
même si nous configurons un mot de passe vide. Pour effectuer cette
opération, il suffit de faire

<blockquote><pre>
echo /usr/bin/false &gt;&gt; /etc/shells
</pre></blockquote>

Ensuite vous êtes prêt pour ajouter l'utilisateur <i>ftp</i>.

<blockquote><pre>
# <b>adduser</b>
Use option ``-silent'' if you don't want to see all warnings and questions.

Reading /etc/shells
Check /etc/master.passwd
Check /etc/group

Ok, let's go.
Don't worry about mistakes. There will be a chance later to correct any input.
Enter username []: <b>ftp</b>
Enter full name []: <b>anonymous ftp</b>
Enter shell csh false ksh nologin sh [ksh]: <b>false</b>
Uid [1002]: <b><i>Entrée</i></b>
Login group ftp [ftp]: <b><i>Entrée</i></b>
Login group is ``ftp''. Invite ftp into other groups: guest no 
[no]: <b>no</b>
Login class authpf daemon default staff [default]: <b><i>Entrée</i></b>
Enter password []: <b><i>Entrée</i></b>
Set the password so that user cannot logon? (y/n) [n]: <b>y</b>

Name:        ftp
Password:    ****
Fullname:    anonymous ftp
Uid:         1002
Gid:         1002 (ftp)
Groups:      ftp
Login Class: default
HOME:        /home/ftp
Shell:       /usr/bin/false
OK? (y/n) [y]: <b>y</b>
Added user ``ftp''
Copy files from /etc/skel to /home/ftp
Add another user? (y/n) [y]: <b>n</b>
Goodbye!
</pre></blockquote>

<h3>Configuration du répertoire</h3>

<p>
L'opération a crée, en plus de l'utilisateur, le répertoire
<i>/home/ftp</i>. C'est ce que nous voulons mais nous avons besoin
d'effectuer quelques modifications pour préparer le système à héberger
le service FTP anonyme. Ces modifications sont expliquées dans la page
du manuel
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&amp;sektion=8">ftpd(8)</a>.

<p>
<b>Vous n'avez pas besoin</b> de créer un répertoire /home/ftp/usr ou
/home/ftp/bin.

<ul>
<li><i>/home/ftp</i> - C'est le répertoire principal. Il doit être
    possédé par root avec les permissions 555.
<li><i>/home/ftp/etc</i> - Ce répertoire est optionnel et non
    recommandé. Son seul but est de fournir des informations sur les
    comptes utilisateurs existant. Si vous voulez que les fichiers de
    votre répertoire de ftp soient associés à de vrais utilisateurs,
    vous devez copier /etc/pwd.db et /etc/group dans ce répertoire. Les
    permissions du répertoire doivent être 511. Les permissions sur les
    deux fichiers doivent être 444. Ils sont utilisés pour fournir une
    correspondance entre des nombres et les noms attribués aux comptes
    utilisateurs et groupes. Il n'y a pas de mots de passe dans pwd.db.
    Tous les mots de passe sont stockés dans spwd.db alors ne copiez pas
    ce fichier.
<li><i>/home/ftp/pub</i> - C'est le répertoire standard pour mettre les
    fichiers que vous voulez partagez. Ce répertoire doit avoir les
    permissions 555.
</ul>

<p>
Il est à noter que tous ces répertoires doivent être la propriété de
"root". Voici à quoi doivent ressembler les répertoires après leur
création :

<blockquote><pre>
# pwd 
/home
# ls -laR ftp
total 5
dr-xr-xr-x  5 root  ftp    512 Jul  6 11:33 .
drwxr-xr-x  7 root  wheel  512 Jul  6 10:58 ..
dr-x--x--x  2 root  ftp    512 Jul  6 11:34 etc
dr-xr-xr-x  2 root  ftp    512 Jul  6 11:33 pub

ftp/etc:
total 43
dr-x--x--x  2 root  ftp    512 Jul  6 11:34 .
dr-xr-xr-x  5 root  ftp    512 Jul  6 11:33 ..
-r--r--r--  1 root  ftp    316 Jul  6 11:34 group
-r--r--r--  1 root  ftp  40960 Jul  6 11:34 pwd.db

ftp/pub:
total 2
dr-xr-xr-x  2 root  ftp  512 Jul  6 11:33 .
dr-xr-xr-x  5 root  ftp  512 Jul  6 11:33 ..
</pre></blockquote>

<h3>Démarrage du serveur et logs</h3>

<p>
Vous pouvez choisir d'exécuter ftpd soit à partir de
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=inetd&amp;sektion=8">inetd(8)</a>
soit de le lancer directement via les scripts <a href="#rc">rc</a>. Les
exemples suivants vous montreront le service lancé via inetd.conf. Tout
d'abord, nous devons nous familiariser avec quelques options de ftpd. La
ligne par défaut dans <i>/etc/inetd.conf</i> est :

<blockquote><pre>
<b>ftp             stream  tcp     nowait  root    /usr/libexec/ftpd       ftpd -US</b>
</pre></blockquote>

<p>
Comme vous pouvez le voir, ftpd est invoqué avec <i>-US</i>. Ces options
vont permettre de loguer les connexions anonymes dans
<i>/var/log/ftpd </i>et les sessions courantes dans
<i>/var/run/utmp</i>. Ce qui permet de voir ces sessions via who(1).
Dans certains cas, on souhaitera fournir un accès anonyme et désactiver
ftp pour les utilisateurs du système. Pour cela, il faut utiliser
l'option <i>-A </i>de ftpd. Voici une ligne d'invocation de ftpd en mode
anonyme exclusif. On utilise aussi <i>-ll</i> qui logue chaque connexion
vers syslog en plus des commandes ftp get, retrieve, etc...

<blockquote><pre> 
<b>ftp             stream  tcp     nowait  root    /usr/libexec/ftpd       ftpd -llUSA</b>
</pre></blockquote>

<p> 
<b>Note</b> : Les personnes gérant des serveurs ftp à HAUT trafic ne
devraient pas invoquer ftpd à partir de inetd.conf. La meilleure option
consiste à commenter la ligne correspondant à ftpd dans /etc/inetd.conf
et à démarrer ftpd à partir de rc.conf.local. Cela va démarrer ftpd en
tant que service. Ce mode de fonctionnement est beaucoup moins coûteux
et plus rapide que le démarrage via inetd.
La ligne correspondant à ftpd dans rc.conf.local ressemblerait à :

<blockquote><pre>
ftpd_flags="-llUSA"           # for non-inetd use: ftpd_flags=""
</pre></blockquote>

<p>
Bien évidemment, cette méthode ne fonctionnera que si ftpd est commenté
dans <i>/etc/inetd.conf</i> et en veillant qu'inetd ait bien relu son
fichier de configuration.

<p>
Il n'est pas nécessaire d'ajouter des options supplémentaires à ftpd pour
activer les connexions anonymes.
Les étapes précédentes pour créer un utilisateur 'ftp' et configurer les
répertoires nécessaires avec les permissions correctes sont suffisantes.
Cependant, pour arrêter les connexions anonymes il n'est pas nécessaire de
supprimer tout cela.
Il faut juste redémarrer ftpd en incluant l'option <b>-n</b>.
Les connexions anonymes seront désactivées.

<h3>Autres fichiers importants </h3>

<ul>
<li><i>/etc/ftpwelcome</i> - Ce fichier contient le message de bienvenue
    qui sera affiché aux personnes qui se connectent sur votre serveur
    ftp.
<li><i>/etc/motd</i> - Ce fichier contient le message qui sera affiché
    aux utilisateurs une fois authentifiés sur votre serveur ftp.
<li><i>.message</i> - Ce fichier peut être mis dans n'importe quel
    répertoire. Il contient un message qui sera affiché lorsque
    l'utilisateur entre dans le répertoire où ce fichier se trouve.
</ul>

<p>
<a name= "ftpchroot"></a>
<h2>10.13 - Confiner les utilisateurs à leur répertoire
    HOME avec ftpd(8)</h2>

<p>
Par défaut, lorsque les utilisateurs se connectent en ftp, ils peuvent
aller dans n'importe quel répertoire du système, dans la mesure où les
contrôles d'accès leur permettent.
Dans certains cas, ce comportement peut ne pas être souhaitable.
Il est possible de restreindre les utilisateurs ftp à leur répertoire
HOME en utilisant "chroot".

<p>
Si vous voulez autoriser les connexions ftp en chroot, utilisez l'option
<b>-A</b> de
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&amp;sektion=8">ftpd(8)</a>.

<p>
Si vous voulez utiliser chroot de manière plus fine, consultez
"<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=login.conf&amp;sektion=5">login capability infrastructure</a>" et
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&amp;sektion=8">ftpd(8)</a>
<p>

Les utilisateurs appartenant à une classe de connexion où la variable
<tt>ftp-chroot</tt> est positionnée seront automatiquement mis dans un
chroot.
De plus, vous pouvez ajouter un nom d'utilisateur au fichier
<b>/etc/ftpchroot</b> pour mettre ces utilisateurs dans un chroot.
Un utilisateur a uniquement besoin d'être listé dans un de ces endroits.

<p>
<a name= "Patches"></a>
<h2>10.15 - Appliquer des correctifs sous OpenBSD</h2>

<p>
Même avec OpenBSD, des bogues apparaissent de temps à autre.
Certaines bogues causent des problèmes de fiabilité (par exemple,
quelque chose peut amener le système à ne plus fonctionner
correctement). D'autres bogues causent des problèmes de sécurité (qui
peuvent permettre à d'autres personnes d'utiliser votre machine de façon
inattendue et non autorisée).
Lorsqu'un bogue critique est trouvé, le correctif sera mis en place au
niveau de l'arborescence du code source <i>-current</i>. Ce correctif
sera ensuite propagé vers les <a href="faq5.html#Flavors">versions
maintenues</a> d'OpenBSD.

Ces correctifs apparaissent sur la
<a href="../../fr/errata.html">page web des errata</a>. Ils sont séparés
en correctifs "communs" applicables à toutes les <a
href="../../fr/plat.html">plates-formes</a>, et en correctifs
applicables à une ou plusieurs plates-formes mais pas toutes.

<p>
Cependant, il est à noter qu'il n'y a pas de correctifs pour les
nouvelles fonctionnalités et le nouveau matériel ajoutés à OpenBSD, 
et ils sont uniquement publiés pour d'importants 
problèmes de stabilité ou de sécurité qui doivent être
réglés très rapidement sur les systèmes impactés (mais pas tous
les systèmes vu que l'application de tel ou tel correctif dépend des
logiciels utilisés).

<p> 
Il existe trois façons d'installer les correctifs sur votre système :

<ul>
<li><b>Mettez à jour votre système en
<a href="current.html"><i>-current</i></a>.</b>
Vu que tous les correctifs sont appliqués systématiquement au code
source de la branche <i>-current</i>, la mise à jour de votre système
avec le dernier snapshot disponible est une excellente façon d'installer
les correctifs.
Cependant, l'utilisation de la branche <i>-current</i> n'est pas adaptée
à tout le monde.
<li><b>Mettez à jour votre système en <a
href="../../fr/stable.html"><i>-stable</i></a>.</b>
Vous pouvez faire ceci en téléchargeant votre arborescence du code
source ou en la mettant à jour en utilisant la branche <i>-stable</i>
appropriée puis en recompilant le noyau et le reste du système
d'exploitation. C'est probablement la méthode la plus aisée mais la
recompilation de tout le système prend du temps. De plus, le
téléchargement complet du code source peut prendre du temps aussi si
vous avez une bande passante limitée.
<li><b>Corrigez, compilez et installer les fichiers impactées
individuellement.</b>
C'est la méthode que nous allons aborder ci-après de manière détaillée.
Bien que cette méthode nécessite peu de bande passante et prend,
typiquement, peu de temps par rapport à un téléchargement ou une mise à
jour via cvs(1) et une compilation complète de tout le système, elle
peut parfois être la plus difficile à utiliser. En effet, il n'y a pas
de procédure universelle à suivre pour la mise à jour. Certaines fois
vous devez mettre en oeuvre un correctif pour une application donnée
puis recompiler et installer cette dernière. D'autres fois, vous aurez
peut-être à recompiler des sections entières de l'arborescence des
sources si le problème est localisé au niveau d'une bibliothèque.</ul>
Encore une fois, la correction de fichiers individuels n'est pas
toujours simple. Pensez à utiliser la deuxième méthode décrite plus haut
et suivre la branche <a href="../../fr/stable.html"><i>-stable</i></a>
(dite aussi la branche "des correctifs") d'OpenBSD.
L'utilisation combinée de ces différentes méthodes est possible si vous
comprenez exactement comment cela fonctionne. Les nouveaux utilisateurs
devront choisir une seule méthode.

<h3>Quelle est la différence entre les correctifs de la page des errata
    et ce qui existe au niveau de la base de données CVS ?</h3>

<p>
Tous les correctifs postés sur la <a href="../../fr/errata.html">page
web des errata</a> concernent uniquement l'arborescence des sources de
la version indiquée dans cette page. Les autres correctifs qui
concernent l'arborescence actuelle de CVS peuvent contenir certaines
modifications qui ne sont peut-être pas désirables sur la version de
production.
Ceci est important : Si vous avez installé un snapshot et que vous avez
téléchargé les arborescences du code source au moment où vous avez
obtenu le snapshot, il se peut que si vous essayer d'appliquer un des
correctifs publiés, ça ne marche pas à cause d'une modification du code
source.



<h3>Application des correctifs</h3>

<p>
Les correctifs d'OpenBSD sont distribués sous la forme de fichiers diff
unifiés.
Ces fichiers sont des fichiers texte qui contiennent les différences par
rapport au code source d'origine. Ils ne sont <b>PAS</b> distribués sous
forme binaire. Cela veut dire que pour appliquer les correctifs, vous
devez avoir à disposition sur votre système le code source de la version
<b>RELEASE </b>d'OpenBSD.
De manière générale, il est recommandé d'avoir à disposition l'arborescence
complète du code source.
Si votre machine héberge une version à partir d'un CDROM officiel,
l'arborescence du code source est disponible sur le disque 3. Elle est
aussi disponible sous forme de fichiers à partir des
<a href="../../fr/ftp.html">serveurs FTP</a>.
Nous allons désormais supposer que vous avez l'arborescence complète à
votre disposition.

<p>
À titre d'exemple, nous allons appliquer le correctif 001 pour OpenBSD
qui corrige un bogue au niveau du pilote
<a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=st&amp;sektion=4">st(4)</a>
qui gère les lecteurs de bandes magnétiques.
Sans ce correctif, la restauration de sauvegardes était assez difficile.
Les personnes utilisant un lecteur de bandes magnétiques avaient
<i>besoin</i> de ce correctif. Les autres personnes pouvaient s'en passer.
Jetons un coup d'oeil à ce correctif :

<blockquote><pre>
# <b>more 001_st.patch</b>
Apply by doing:
        patch -p0 < 001_st.patch

Rebuild your kernel.
Index: sys/scsi/st.c
===================================================================
RCS file: /cvs/src/sys/scsi/st.c,v
retrieving revision 1.41
retrieving revision 1.41.2.1
diff -u -p -r1.41 -r1.41.2.1
--- sys/scsi/st.c       1 Aug 2004 23:01:06 -0000       1.41
+++ sys/scsi/st.c       2 Nov 2004 01:05:50 -0000       1.41.2.1
@@@@ -1815,7 +1815,7 @@@@ st_interpret_sense(xs)
        u_int8_t skey = sense->flags &amp; SSD_KEY;
        int32_t info;
 
-       if (((sense-&gt;flags & SDEV_OPEN) == 0) ||
+       if (((sc_link-&gt;flags & SDEV_OPEN) == 0) ||
            (serr != 0x70 && serr != 0x71))
                return (EJUSTRETURN); /* let the generic code handle it */
</pre></blockquote>

Comme vous pouvez le constater, le début du patch inclut de brèves instructions
sur la façon de l'appliquer. Nous admettrons que vous avez placé ce patch dans
le répertoire <tt>/usr/src</tt> auquel cas les étapes suivantes seront
utilisées :

<blockquote><pre>
# <b>cd /usr/src</b>
# <b>patch -p0 &lt; 001_st.patch</b>
Hmm...  Looks like a unified diff to me...
The text leading up to this was:
--------------------------
|Apply by doing:
|        cd /usr/src
|        patch -p0 &lt; 001_st.patch
|
|Rebuild your kernel.
|
|Index: sys/scsi/st.c
|===================================================================
|RCS file: /cvs/src/sys/scsi/st.c,v
|retrieving revision 1.41
|retrieving revision 1.41.2.1
|diff -u -p -r1.41 -r1.41.2.1
|--- sys/scsi/st.c      1 Aug 2004 23:01:06 -0000       1.41
|+++ sys/scsi/st.c      2 Nov 2004 01:05:50 -0000       1.41.2.1
--------------------------
Patching file sys/scsi/st.c using Plan A...
Hunk #1 succeeded at 1815.              <i>&lt;-- Ce message indique le succès de l'opération</i>
done
</pre></blockquote>

Le message "<tt>Hunk #1 succeeded</tt>" indique que le correctif a été
appliqué avec succès.
Plusieurs correctifs sont plus complexes que l'exemple utilisé, et
impliqueront de multiples "hunks" et fichiers. Dans ce cas, il faudra
que vous vous assuriez que tous les "hunks" ont été appliqués avec
succès pour tous les fichiers concernés. 
Si ce n'est pas le cas, ceci veut normalement dire que votre
arborescence du code source est quelque peu différente de
l'arbre "release" d'où le patch a été créé, ou que vous n'avez pas suivi
les instructions, ou encore que le correctif ne correspond pas au correctif
originel.
Les correctifs sont très sensibles aux espaces blancs -- un
copier/coller depuis votre navigateur changera la plupart du temps les
caractères de tabulation en espaces ou modifiera les espaces blancs de
telle façon à rendre le correctif inutilisable.

<p>
Vous pouvez maintenant <a href="faq5.html#BldKernel">compiler et installer</a>
le nouveau noyau, et redémarrer le système normalement.

<p>
Les correctifs ne s'appliquent pas systématiquement au noyau.
Dans certains cas, vous devrez recompiler des utilitaires. Dans
d'autres, vous devrez recompiler tous les utilitaires liés statiquement
à une bibliothèque sujette à correction.
Suivez les instructions dans l'en-tête du correctif, et si vous n'êtes
pas certain, recompilez tout le système.

<p>
Les correctifs qui n'impactent pas directement votre utilisation du
système n'ont pas besoin d'être appliqués normalement.
Par exemple, si vous n'aviez pas de lecteur de bande magnétique dans
votre système, vous ne bénéficieriez pas du correctif ci-dessus.
Cependant, les correctifs sont supposés être appliqués dans l'ordre. Il
est donc possible qu'un correctif ultérieur dépende d'un correctif apparu
plus tôt.
Soyez conscient de ce mode de fonctionnement si vous sélectionnez la
méthode consistant à choisir vous-même vos correctifs. Si vous avez un
doute, appliquez-les tous, dans l'ordre de leur mise à disposition.

<p>
<a name="httpdchroot"></a>
<h2>10.16 - Parlez-moi de chroot(2) Apache</h2>

<p>
Sous OpenBSD, le serveur 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=httpd&amp;sektion=8">httpd(8)</a>
d'Apache est 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=chroot&amp;sektion=2">chroot(2)</a>é
par défaut. Étant un grand pas en avant du point de vue de la sécurité,
cela peut créer des problèmes si vous n'y êtes pas préparé.

<h3>Qu'est-ce qu'un chroot ?</h3>

Une application 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=chroot&amp;sektion=2">chroot(2)</a>ée
est bloquée dans un répertoire spécifique et ne peut errer dans les
autres répertoires de l'arbre du système de fichiers et voit ce
répertoire comme son répertoire <tt>/</tt> (root). Dans le cas
d'httpd(8), le programme démarre, ouvre ses fichiers log, ouvre ses
ports TCP (bien qu'il n'accepte pas encore de données), et lit son
fichier de configuration. Ensuite, il se fixe lui-même dans le
répertoire <i>/var/www</i> et baisse ses privilèges. Ce qui veut dire
que tous les fichiers servis et utilisés par Apache, doivent être dans
le répertoire <i>/var/www</i>. Dans la configuration par défaut
d'OpenBSD, tous les fichiers du répertoire <i>/var/www</i> sont en
lecture seule pour l'utilisateur qui fait tourner Apache, <i>www</i>.
Cela accroît considérablement le niveau de sécurité ;
s'il devait y avoir un problème de sécurité, les dégâts seraient
confinés dans un seul répertoire avec les permissions de "lecture seule"
et aucune ressource pour causer des problèmes.

<h3>Qu'est-ce que cela signifie pour l'administrateur ?</h3>

<p>
En gros, chroot(2)er Apache est quelque chose qui n'est pas adopté par
la plupart des autres systèmes d'exploitation. Beaucoup d'applications
et de configurations système ne fonctionneront plus comme avant sans
aménagement. De plus, il faut se souvenir que sécurité et commodité sont
souvent incompatibles.
L'implémentation d'Apache sous OpenBSD ne sacrifie pas la sécurité aux
profits des capacités ou de la "facilité".

<ul>
<li><b>Hiérarchie historique du système de fichiers :</b>
Les serveurs mis à jour depuis d'anciennes versions d'OpenBSD peuvent
avoir les fichiers web situés dans les répertoires HOME des
utilisateurs, ce qui clairement ne fonctionnera pas dans un
environnement chroot(2)é étant donné qu'httpd(8) ne peut atteindre le
répertoire <i>/home</i>. Les administrateurs découvriront peut-être que
leur partition /var/www existante est trop petite pour accueillir tous
les fichiers web. Vos options sont dès lors de restructurer votre
système ou de ne pas utiliser l'option du chroot(2). Vous pouvez, bien
évidemment, utiliser des liens symboliques dans le répertoire HOME de
l'utilisateur pointant vers les sous-répertoires dans
<i>/var/www</i>, mais vous ne pouvez PAS utiliser des liens dans
<i>/var/www</i> pointant vers une autre partie du système de
fichier -- ceci ne peut fonctionner dû au chroot(2). Notez que si
vous voulez que vos utilisateurs aient un
<a href="faq10.html#ftpchroot">accès FTP chroot(2)é</a>,
ceci ne fonctionnera pas plus étant donné que le chroot FTP va (à
nouveau) vous empêcher d'accéder aux destinations de ces liens
symboliques. Une solution est donc, de ne pas utiliser <i>/home</i>
comme répertoire HOME pour ces utilisateurs mais plutôt quelque chose
similaire à <i>/var/www/users</i>.
Les liens symboliques sont totalement utilisables à l'intérieur du
chroot(2) mais ceux-ci doivent être relatifs et non absolus.

<li><b>Rotation des fichiers log :</b> Normalement, une rotation des
fichiers log est réalisée en renommant les anciens fichiers, ensuite
en envoyant à httpd(8) un signal SIGUSR1 qui forcera Apache à fermer
ses anciens fichiers logs et à en ouvrir de nouveaux. Ceci n'est
désormais plus possible, étant donné que httpd(8) n'a pas la
possibilité d'ouvrir les fichiers de log en écriture une fois que ses
privilèges ont été abaissés. httpd(8) doit donc être stoppé et 
relancé.
Cela demande parfois quelques secondes pour que tous les processus
enfants se terminent, ce qui est obligatoire avant que httpd(8) ne
puisse redémarrer ; une possibilité de rotation des logs pourrait être :

<blockquote><pre>
# <b>apachectl stop</b>
  <i>rename your log files</i>
# <b>apachectl start ; sleep 10 ; apachectl start</b>
</pre></blockquote> 

Oui, la dernière ligne tente de redémarrer Apache immédiatement et dans
le cas où cela ne fonctionnerait pas, on attend quelques secondes puis
on réessaie.
Et oui, cela signifie bien que pendant quelques secondes chaque fois que
vous effectuerez une rotation des logs, votre serveur web sera
inaccessible.
Bien que cela puisse poser des problème, n'importe quelle tentative pour
permettre à httpd(8) de rouvrir des fichiers après avoir
chroot(2)é ira à l'encontre de l'intérêt même du chroot !

Il existe néanmoins d'autres techniques, notamment loguer vers un
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pipe&amp;sektion=2">pipe(2)</a>, 
et utiliser un programme extérieur afin de réaliser une rotation des
fichiers à la fin du pipe.

<li><b>Modules Apache existants :</b> Pratiquement, ils se lanceront
    tous, cependant, certains pourraient ne pas fonctionner correctement
    dans le chroot(2), et pourraient causer des problèmes lors de
"<tt><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=apachectl&amp;sektion=8">apachectl</a> 
    restart"</tt>, générant une erreur, causant httpd(8) à se stopper.

<li><b>CGIs existants :</b> La plupart ne fonctionneront pas tels quels.
    Ils auront certainement besoin de programmes ou de bibliothèques se
    trouvant hors de <i>/var/www</i>. Certains peuvent être corrigés en
    étant compilés statiquement (n'ayant pas besoin de bibliothèques se
    trouvant dans un autre répertoire), la plupart peuvent être corrigés
    en copiant dans <i>/var/www</i> les fichiers nécessaires à
    l'application, bien que cette manoeuvre soit non triviale et
    requiert une certaine connaissance du programme.

<li><b>Options de montage du système de fichiers :</b>
Par défaut sous OpenBSD, votre partition <i>/var</i> est monté avec les
options <tt>nosuid</tt> et <tt>nodev</tt>/
Si vous tentez d'utiliser une application à l'intérieur du chroot, vous
serez peut-être amené à changer ces options.
Bien entendu, il est possible que vous ayez besoin d'effectuer ces
changements même si vous n'utiliser pas l'option du chroot.

<li><b>Résolution de noms :</b>
httpd(8) à l'intérieur de chroot(2) NE sera pas capable d'utiliser
<i>/etc/hosts</i> ou <i>/etc/resolv.conf</i>. Par conséquent, si vous avez
applications qui nécessitent la résolution de nom, vous devrez remplir
<i>/var/www/etc/hosts</i> et/ou <i>/var/www/etc/resolv.conf</i> dans
l'environnement chroot(2). Il est à noter que certaines applications
ont besoin de faire la résolution de "localhost" pour fonctionner.

<li><b>Timezone :</b>
httpd(8) à l'intérieur de chroot(2) NE sera pas capable d'utiliser le
<i>/etc/localtime</i> système. Si vous avez besoin de la journalisation des
événements avec localtime, vous devrez copier (pas de lien) la timezone
correspondante de <i>/usr/share/zoneinfo/</i> dans <i>/var/www/etc/localtime</i>.

</ul>

Dans certains cas, les applications ou les configurations peuvent être
changées pour fonctionner dans le chroot(2). Dans d'autres cas, vous
devrez tout simplement retirer cette option en utilisant l'option
<tt>-u</tt> de httpd(8) dans
<i><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc.conf.local&amp;sektion=8">/etc/rc.conf.local</a></i>.

<h3>Exemple de chroot(2) d'une application : wwwcount</h3>

Voyons comment mettre en place chroot(2) pour une application à travers
un exemple. Cet exemple se base sur wwwcount, un compteur tout simple
d'accès aux pages web disponible dans les
<a href="../fr/faq15.html#PkgMgmt">paquetages</a>. Bien qu'il soit un
programme très efficace, wwwcount ne sait rien d'Apache chroot(2)é et ne
fonctionnera pas dans un environnement chroot(2)é avec sa configuration
de base.

<p>
Tout d'abord, nous installons le paquetage
<a href="http://www.muquit.com/muquit/software/Count/Count.html">wwwcount</a>.
Nous le configurons et le testons et c'est là que nous en déduisons
qu'il ne semble pas fonctionner : Apache nous affiche le message
"Internal Server Error".

La première étape consiste à arrêter Apache et à le redémarrer avec
l'option <tt>-u</tt> pour vérifier que le problème vient bien du
chroot(2) et pas de la configuration système.

<blockquote><pre>
# <b>apachectl stop</b>
/usr/sbin/apachectl stop: httpd stopped
# <b>httpd -u</b>
</pre></blockquote>

Après avoir fait cela, nous constatons que le compteur fonctionne
correctement, du moins après avoir changé les droits d'un répertoire
afin qu'Apache (et les CGIs qu'il exécute) puisse écrire à des fichiers.
Ainsi, nous sommes maintenant certains que le problème vient du chroot.
Nous arrêtons alors et redémarrons Apache à nouveau en utilisant le
chroot par défaut :

<blockquote><pre>
# <b>apachectl stop</b>
/usr/sbin/apachectl stop: httpd stopped
# <b>httpd</b>
</pre></blockquote>

<p>
Un bon point pour commencer serait de supposer que wwwcount utilise des
bibliothèques et d'autres fichiers qu'il ne peut accéder une fois dans le
chroot. On peut utiliser à cet effet la commande
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ldd&amp;sektion=1">ldd(1)</a>
pour trouver les dépendances dynamiques dont le CGI a besoin :

<blockquote><pre>
# <b>cd /var/www/cgi-bin/</b>
# <b>ldd Count.cgi</b>
Count.cgi:
        Start    End      Type Open Ref GrpRef Name
        1c000000 3c007000 exe  1    0   0      /var/www/cgi-bin/Count.cgi
        0c085000 2c0be000 rlib 0    1   0      /usr/lib/libc.so.57.0
        08713000 08713000 rtld 0    1   0      /usr/libexec/ld.so
</pre></blockquote>
Ah ! voilà un problème. Deux fichiers ne sont pas disponibles dans
l'environnement chroot(2). Alors, on les copie dans cet environnement :

<blockquote><pre>
# <b>mkdir -p /var/www/usr/lib /var/www/usr/libexec</b>
# <b>cp /usr/lib/libc.so.57.0 /var/www/usr/lib</b>
# <b>cp /usr/libexec/ld.so /var/www/usr/libexec</b>
</pre></blockquote>
Puis nous essayons le compteur à nouveau.

<p>
Au moins, le programme s'exécute maintenant et nous affiche des messages
d'erreur directement : "Unable to open config file for reading". Nous
avons bien progressé mais nous n'avons pas encore fini. Le fichier de
configuration se trouve normalement dans le répertoire
<tt>/var/www/wwwcount/conf</tt>, mais au sein de l'environnement chroot,
le programme devrait le voir sous <tt>/wwwcount/conf</tt>.
Nous avons donc deux options. Soit nous recompilons le programme pour
qu'il tienne compte du nouveau fichier de configuration par défaut (où
plutôt du chemin pour l'atteindre) soit nous déplaçons les fichiers de
données. Vu que nous avons installé le programme à partir d'un paquetage,
nous prenons l'option 2, à savoir le déplacement des fichiers de
données. Afin que nous puissions utiliser exactement la même
configuration dans un environnement chroot(2)é ou pas, nous utiliserons
un lien symbolique :

<blockquote><pre>
# <b>mkdir -p /var/www/var/www</b>
# <b>cd /var/www/var/www</b>
# <b>ln -s ../../wwwcount wwwcount</b>
</pre></blockquote>
Remarquez que le lien symbolique a été pensé pour fonctionner au sein du
chroot. Nous testons notre programme à nouveau et nous voilà avec un
autre problème.
Maintenant wwwcount se plaint de ne pas trouver les fichiers "strip
image" qu'il utilise pour afficher des messages. Après quelques
recherches, nous nous rendons compte que ces fichiers sont stockés dans
<tt>/usr/local/lib/wwwcount</tt>, nous devons donc les copier dans le
chroot aussi.

<blockquote><pre>
# <b>tar cf - /usr/local/lib/wwwcount | (cd /var/www; tar xpf - )</b>
</pre></blockquote>
Nous testons à nouveau ... et ça marche !

<p>
Notez que nous n'avons copié que les fichiers strictement nécessaires au
bon fonctionnement.
En général, seuls les fichiers nécessaires à l'application doivent être
copiés dans le chroot.

<h3>Dois-je utiliser chroot ?</h3>
Dans l'exemple précédent, le programme est relativement simple et
pourtant nous avons rencontré différents types de problèmes.

<p>
<i>Toutes les applications ne peuvent ou ne devraient pas être
chroot(2)ées.</i>

<p>
Le but est la mise en place d'un serveur web sécurisé et le chroot(2)age
n'en est qu'un outil, pas un but en soi.
Souvenez-vous, la configuration initiale de l'Apache chroot(2)é sous
OpenBSD fait en sorte que l'utilisateur sous lequel le programme
httpd(8) tourne ne peut pas lancer de programme, ne peut pas modifier de
fichiers et ne peut pas prendre l'identité d'un autre utilisateur.
Réduire ces restrictions diminuera votre sécurité, chroot ou pas.

<p>
Certaines applications sont relativement
simples et les mettre dans un chroot(2) n'a aucun sens. D'autres sont
très complexes. Elles ne valent pas les efforts nécessaires pour les
mettre en chroot(2) et même si c'était le cas, vous perdriez les
avantages du chroot(2) après avoir copié la masse importante de fichiers
dont elles ont besoin pour fonctionner.
Ainsi le programme OpenWebMail a besoin de pouvoir lire et écrire dans
le répertoire mail, le répertoire home de l'utilisateur et doit pouvoir
travailler en tant que n'importe quel utilisateur du système.
Essayer le mettre cette application en chroot serait inutile car vous
serez obliger de désactiver tous les bénéfices du chroot(2)age.
Même avec des applications aussi simples que le compteur précédent, il
doit pouvoir écrire sur le disque (pour garder la trace de ses
compteurs) et donc, une <i>partie</i> du bénéfice du chroot(2) est
perdue.

<p>
Toute application qui doit fonctionne sous root ne vaut pas le coup
d'être chroot(2)ée puisque root peut généralement s'échapper du
chroot(2).

<p>
N'oubliez pas, si la procédure de chroot pour votre application est trop
complexe vous pourriez ne pas mettre à jour votre système aussi souvent
qu'il le faudrait.
Ceci pourrait rendre votre système MOINS sécurisé qu'un système plus
facilement administrable et dont le chroot est désactivé.

<p>
<a name="rootshell"></a>
<!-- XXXversion - root shell is now ksh -->
<h2>10.17 - Puis-je changer le shell de l'utilisateur root ?</h2>
Il est parfois dit qu'il ne faut pas changer le shell de l'utilisateur
root, bien qu'il n'y ait aucune raison de ne pas le faire sous OpenBSD.

<p>
Le shell par défaut sur OpenBSD de l'utilisateur <i>root</i> est
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ksh&amp;sektion=1">ksh</a>.

<p>
Une directive Unix traditionnelle est d'utiliser pour l'utilisateur root
des shells compilés statiquement, car si votre système démarre en mode
utilisateur unique, les partitions non-root ne seront pas montées et les
shells liés dynamiquement ne seront pas capable d'accéder aux bibliothèques
situées dans la partition <tt>/usr</tt>. Ceci n'étant pas très important
pour OpenBSD, car le système vous demandera de choisir un shell lors
d'un démarrage en mode utilisateur unique, le shell par défaut étant
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sh&amp;sektion=1">sh</a>.

Les trois shells standards sous OpenBSD 
(<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=csh&amp;sektion=1">csh</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sh&amp;sektion=1">sh</a>
et
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ksh&amp;sektion=1">ksh</a>)
sont liés statiquement et donc utilisables en mode utilisateur unique.

<p>
<a name="ksh"></a>
<h2>10.18 - Que puis-je faire d'autre avec <i>ksh</i> ?</h2>
Sous OpenBSD,  
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ksh&amp;sektion=1">ksh</a>
est 
<a href="http://web.cs.mun.ca/~michael/pdksh/">pdksh</a>, 
le Shell Korn du Domaine Public (Public Domain Korn Shell), et est le
même binaire que
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sh&amp;sektion=1">sh</a>.

<p>
Les utilisateurs qui sont à l'aise avec <i>bash</i>, souvent utilisé sur
les systèmes Linux, trouveront probablement
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ksh&amp;sektion=1">ksh</a>
très familier. Ksh(1) offre la plupart des options habituellement
utilisées avec <i>bash</i>, notamment l'achèvement des commandes avec la
touche tab, l'édition de la ligne de commande et l'historique via les
touches fléchées, et CTRL-A/CTRL-E pour aller au début/à la fin de la
ligne de commande. Si vous désirez d'autres options de <i>bash</i>,
<i>bash</i> peut être installé soit via les
<a href="../fr/faq15.html#PkgMgmt">paquetages</a> ou soit via les
<a href="../fr/faq15.html#Ports">ports</a>.

<p>
Le prompt de <i>ksh</i> peut être facilement changé de manière à fournir
plus d'informations que le simple "$ " par défaut en modifiant la
variable <tt>PS1</tt>. Par exemple, en insérant la ligne suivante :

<blockquote><pre>
export PS1='$PWD $ '
</pre></blockquote> 

dans votre <tt>/etc/profile</tt>, cela produira le prompt suivant :

<blockquote><pre>
/home/nick $
</pre></blockquote>
 
Consultez le fichier 
<a href="http://www.openbsd.org/cgi-bin/cvsweb/~checkout~/src/etc/ksh.kshrc?content-type=text/plain"><tt>/etc/ksh.kshrc</tt></a>,
qui inclut plusieurs options utiles ainsi que des exemples, et qui peut
être invoqué dans les fichiers <tt>.profile</tt> de vos utilisateurs.


<p>
ksh(1) sous OpenBSD a été amélioré. Un certain nombre de caractères
spéciaux ont été ajoutés au niveau de la chaîne primaire de l'invite de
commandes, PS1. Ces caractères sont similaires à ceux présents dans
bash.
Par exemple :
<blockquote>
<tt>\e - </tt>Insertion d'un caractère d'échappement ASCII.<br>
<tt>\h - </tt>Le nom d'hôte sans le nom de domaine.<br>
<tt>\H - </tt>Le nom d'hôte complet, avec le nom de domaine.<br>
<tt>\n - </tt>Insertion d'un caractère de retour à la ligne.<br>
<tt>\t - </tt>L'heure actuelle, sur 24 heures, au format HH:MM:SS.<br>
<tt>\u - </tt>Le nom de l'utilisateur actuel.<br>
<tt>\w - </tt>Le répertoire de travail actuel. $HOME est abrégé en `~'.<br>
<tt>\W - </tt>La racine du répertoire de travail actuel.<br>
<tt>\$ - </tt>Affiche "#" pour les super-utilisateurs, et "$" pour les autres
</blockquote>

(consultez la page du manuel
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ksh&amp;sektion=1">ksh(1)</a>
pour plus de détails , et beaucoup, beaucoup plus de caractères spéciaux !
Veuillez noter que le caractère "$" a une signification spéciale à
l'intérieur des double quotes. Il est donc à manipuler avec précaution)

<p>
Vous pouvez par exemple utiliser la commande suivante :
<blockquote><pre>
export PS1="\n\u@@\H\n\w \\$ "
</pre></blockquote>
pour disposer d'une invite de commandes très parlante mais dont
l'utilité n'est que relative.


<p>
<a name="Dir"></a>
<h2>10.19 - Services d'Annuaires</h2>

<p>
OpenBSD peut-être utilisé aussi bien comme client que serveur de bases de
données contenant l'identification de l'utilisateur, l'information sur les
groupes et d'autres données liées au réseau.

<p>
<a name="Dir.available"></a>
<h3>10.19.1 - Quels sont les services d'annuaires disponibles ?</h3>

<p>
Évidemment vous pouvez utiliser différents services d'annuaires sur OpenBSD.
Mais YP est le seul qui peut-être accessible directement en utilisant les
fonctions standards de la librairie C comme
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=getpwent&amp;sektion=3">getpwent(3)</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=getgrent&amp;sektion=3">getgrent(3)</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=gethostbyname&amp;sektion=3">gethostbyname(3)</a>
et bien d'autres.
Donc, si vous conservez vos données dans une base de données YP, vous n'avez
pas besoin de les copier dans les fichiers de configuration locaux comme
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=master.passwd&amp;sektion=5">master.passwd(5)</a>
avant de l'utiliser, par exemple pour authentifier des utilisateurs système.

<p>
YP est un service d'annuaire compatible avec
Sun Microsystems NIS (Network Information System).
Regardez
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=yp&amp;sektion=8">yp(8)</a>
pour un aperçu des pages de manuel disponibles.
Soyez prudent, certains systèmes d'exploitation possèdent des services
d'annuaires qui contiennent des noms similaires mais qui sont incompatibles,
comme par exemple NIS+.

<p>
Pour utiliser d'autres services d'annuaires à l'exception de YP, vous avez
besoin de remplir les fichiers de configuration locaux de l'annuaire ou vous
avez besoin d'un frontal YP pour l'annuaire. 
Par exemple, vous pouvez utiliser le port <tt>sysutils/login_ldap</tt> quand
vous choisissez le premier, alors que le démon 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ypldap&amp;sektion=8">ypldap(8)</a>
fournit ce dernier.

<p>
Pour certaines applications, synchroniser simplement un petit nombre de
fichiers de configuration sur un groupe de machines en utilisant des outils
comme
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cron&amp;sektion=8">cron(8)</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=scp&amp;sektion=1">scp(1)</a>
ou <tt>rsync</tt> (disponible dans les ports) constitue une alternative
robuste et facile à un service d'annuaire complet.

<p>
<a name="YP_secure"></a> 
<h3>10.19.2 - Considérations sur la sécurité de YP</h3>

<p>
Pour des raisons de compatibilité, toutes les fonctionnalités de sécurité
de OpenBSD construites dans l'implémentation de YP sont <em>désactivées</em>
par défaut.
Même quand elles sont toutes activées, le protocole NIS reste intrinsèquement
non sécurisé pour deux raisons :
Toutes les données, incluant les données sensibles comme les hashs de mot de
passe, sont transmises non chiffrées sur le réseau, et ni le client ou le
serveur ne peut vérifier de manière fiable l'identité de l'autre.

<p>
Donc, avant de mettre en place un serveur YP, vous devez considérer ces
faiblesses de sécurité intrinsèque comme acceptable dans votre contexte.
En particulier, YP n'est pas adapté si des attaquants potentiels ont un
accès physique à votre réseau.
Quiconque obtient l'accès root d'un des ordinateurs connecté sur l'un de vos
segment réseau faisant transiter du trafic YP peut se connecter sur votre
domaine YP et récupérer des données.
Dans certains cas, faire transiter du trafic YP à travers des tunnels SSL ou
IPSec peut-être une option, ou vous devrez considérer de combiner YP avec une
authentification
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=kerberos&amp;sektion=8">kerberos(8)</a>.

<p>
<a name="YP_server"></a> 
<h3>10.19.3 - Configurer un serveur YP</h3>

<ol>
<li><p>	
Un serveur YP sert un groupe de clients appelé un "domaine".
Vous devez d'abord choisir un nom de domaine; cela peut être une chaîne
arbitraire et ne doit pas avoir de lien avec les noms de domaines DNS.
Choisir un nom aléatoire comme "Eepoo5vi" peut améliorer de façon marginale
la sécurité, avec l'effet d'être plutôt de la sécurité par l'obscurité.
Dans le cas où vous devez maintenir plusieurs domaines YP distincts, il est
sûrement meilleur de choisir des noms de description comme "ventes",
"marketing" et "recherche" pour ne pas avoir d'erreurs d'administration
système causées par l'obscurité.
Il faut aussi remarquer que certaines versions de SunOS doivent utiliser le
nom de domaine DNS de l'hôte, donc votre choix est plutôt restreint dans un
réseau incluant de tels hôtes.

<p>
Utilisez l'utilitaire
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=domainname&amp;sektion=1">domainname(1)</a>
pour configurer le nom de domaine et le mettre dans le fichier
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=defaultdomain&amp;sektion=5">defaultdomain(5)</a>
pour qu'il soit automatiquement configuré au démarrage du système.

<blockquote><pre>
echo "puffynet" > /etc/defaultdomain
domainname `cat /etc/defaultdomain`
</pre></blockquote>

<li><p>
Initialiser le serveur YP en utilisant la commande interactive :

<blockquote><pre>
ypinit -m
</pre></blockquote>

À ce stade, il n'est plus nécessaire de spécifier les serveurs esclaves.
Pour ajouter des serveurs esclaves, vous pourrez relancer
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ypinit&amp;sektion=8"
>ypinit(8)</a> plus tard, en utilisant l'option <tt>-u</tt>.
Configurer au moins un serveur esclave pour chaque domaine est utile pour
éviter les interruptions de service, le serveur maître pourrait s'arrêter ou
perdre sa connectivité réseau, en particulier les processus clients
essaieront d'accéder aux blocs de tables YP indéfiniment tant qu'ils ne
recevront pas les informations demandées. Donc, les interruptions de service
YP rendront typiquement les hôtes clients complètement inutilisables tant
que le service YP n'est pas de retour.

<li><p>
Il faut décider ou stocker les fichiers sources pour générer vos tables YP
initiales.
Garder distincte la configuration du serveur de la configuration du service
aide à contrôler quelle information sera donnée de celle qui ne le sera pas,
donc le répertoire par défaut <tt>/etc</tt> n'est pas souvent le meilleur
choix.

<p>
Le seul inconvénient causé par le changement de répertoire source est que
vous ne pourrez plus ajouter, supprimer ou modifier des utilisateurs et des
groupes dans le domaine YP en utilisant des utilitaires comme
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=user&amp;sektion=8">user(8)</a>
et
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=group&amp;sektion=8">group(8)</a>.
À la place, vous devrez éditer les fichiers de configuration avec un éditeur
de texte.

<p>
Pour définir le répertoire source, éditez le fichier
<tt>/var/yp/`domainname`/Makefile.yp</tt>
et modifiez la variable <tt>DIR</tt>, par exemple :

<blockquote><pre>
DIR=/etc/yp/src/puffynet
</pre></blockquote>

<li><p>
Considérez la possibilité de personnalisation d'autres variables dans
<tt>/var/yp/`domainname`/Makefile</tt>. Regardez
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=Makefile.yp&amp;sektion=8"
>Makefile.yp(8)</a> pour plus de détails.

<p>
Par exemple, même dans le cas ou vous utilisez le répertoire source par
défaut <tt>/etc</tt>, vous n'avez généralement pas besoin de tous les
comptes et groupes existants sur le serveur pour tous les hôtes clients.
En particulier, ne pas fournir de compte root et garder le hash du compte
root confidentiel est souvent bénéfique pour la sécurité.
Étudiez les valeurs des variables <tt>MINUID</tt>, <tt>MAXUID</tt>,
<tt>MINGID</tt> et <tt>MAXGID</tt> et ajustez les selon vos besoins.

<p>
Si tous vos clients YP utilisent OpenBSD ou FreeBSD, excluez les mots de
passe chiffrés de la table <tt>passwd</tt> en configurant <tt>UNSECURE=""</tt>
dans <tt>/var/yp/`domainname`/Makefile.yp</tt>.

<p>
La pratique courante d'éditer le fichier modèle <tt>/var/yp/Makefile.yp</tt>
n'est plus recommandé. Les changements dans ce fichier affectent tous les
domaines initialisés après le changement, mais n'affecte pas les domaines
initialisés avant le changement, il s'agit donc d'erreurs de toute façon :
vous risquez que les changements attendus ne soient pas pris en compte, et
vous risquez de les oublier et qu'ils affectent d'autres domaines plus tard
alors que cela n'était pas voulu. 

<li><p>
Créez le répertoire source et le remplir avec les fichiers de configuration
dont vous avez besoin. Regardez
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=Makefile.yp&amp;sektion=8">Makefile.yp(8)</a>
pour savoir quel table YP a besoin de quel fichier source.
Pour le format de fichier de configuration individuel, consultez
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=passwd&amp;sektion=5">passwd(5)</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=group&amp;sektion=5">group(5)</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=hosts&amp;sektion=5">hosts(5)</a>
voir plus, et regardez les exemple dans <tt>/etc</tt>.

<li><p>
Créez la version initiale de votre table YP en utilisant les commandes

<blockquote><pre>
cd /var/yp
make
</pre></blockquote>

Ne vous inquiétez pas des messages d'erreurs de
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=yppush&amp;sektion=8"
>yppush(8)</a> maintenant.
Le serveur YP ne fonctionne pas encore.

<li><p>
YP utilise les
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rpc&amp;sektion=3">rpc(3)</a>
(remote procedure calls) pour communiquer avec ces clients,
il est donc nécessaire d'activer
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=portmap&amp;sektion=8">portmap(8)</a>.
Pour le faire, éditez
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc.conf.local&amp;sektion=8">rc.conf.local(8)</a>
et configurez <tt>portmap_flags=""</tt>.
Cela démarrera le portmapper au prochain redémarrage.
Vous pouvez aussi éviter de redémarrer en le démarrant manuellement :

<blockquote><pre>
echo 'portmap_flags=""' >> /etc/rc.conf.local
portmap
</pre></blockquote>

<li><p>
Pensez à utiliser soit le
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=securenet&amp;sektion=5">securenet(5)</a>
ou les fonctionnalités de sécurité de votre serveur démon YP dans
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ypserv.acl&amp;sektion=5">ypserv.acl(5)</a>.
Mais sachez que les deux fournissent seulement du contrôle d'accès IP.
Ainsi, ils aident aussi longtemps que des agresseurs potentiels n'ont ni
l'accès physique au matériel du réseau transportant des segments de votre
trafic YP, ni l'accès root de toute machine connectée sur ces segments réseaux.

<li><p>
Finalement démarrez le démon serveur YP :

<blockquote><pre>
ypserv
</pre></blockquote>

Il démarrera automatiquement à chaque redémarrage aussi longtemps que le
répertoire <tt>/var/yp/`domainname`</tt> continuera d'exister.

<li><p>
Pour tester le nouveau serveur, faite le devenir son propre client en
suivant les instructions de la première partie de la section suivante. 
Dans le cas ou vous ne voulez pas que le serveur utilise ces propres tables,
vous pouvez désactiver la partie cliente après le test avec les commandes
suivantes :

<blockquote><pre>
pkill ypbind
rm -rf /var/yp/binding
</pre></blockquote>

<li><p>
Si vous désirez permettre aux utilisateurs de changer leurs mots de passe
des machines clientes, vous devez activer
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=yppasswdd&amp;sektion=8">yppasswdd(8)</a> :

<blockquote><pre>
echo 'yppasswdd_flags="-d /etc/yp/src/puffynet"' >> /etc/rc.conf.local
rpc.yppasswdd
</pre></blockquote>

Dans le cas ou vous utilisez le répertoire source par défaut dans <tt>/etc</tt>,
utilisez juste <tt>yppasswdd_flags=""</tt>.

<li><p>
Rappelez vous que chaque fois que vous changez un fichier source d'une
table YP, vous devez regénérer vos tables YP.

<blockquote><pre>
cd /var/yp
make
</pre></blockquote>

Cela va mettre à jour tous les fichiers de bases de données dans <tt>/var/yp/`domainname`</tt>,
avec une exception : le fichier <tt>ypservers.db</tt>, contenant tous les 
serveurs YP maîtres et esclaves associés avec le domaine, qui est crée
directement avec <tt>ypinit -m</tt> et modifié exclusivement par <tt>ypinit -u</tt>.
Dans le cas ou vous l'avez supprimé accidentellement, exécutez <tt>ypinit -u</tt>
pour le recréer de zéro.
</ol>

<a name="YP_client"></a> 
<h3>10.19.4 - Configurer un client YP</h3>

Configurer un client YP comprend deux parties distinctes.
En premier, vous devez exécuter le démon YP client,
connecter votre hôte client au serveur YP.
Finaliser les points suivants vous permettra de récupérer les données du
serveur YP, mais ces données ne seront pas encore utilisables par le système :

<ol>
<li><p>
Comme sur le serveur, vous devez configurer le nom de domaine et activer le
portmapper:

<blockquote><pre>
echo "puffynet" > /etc/defaultdomain
domainname `cat /etc/defaultdomain`
echo 'portmap_flags=""' >> /etc/rc.conf.local
portmap
</pre></blockquote>

<li><p>
Il est recommandé de fournir une liste de serveurs YP dans le fichier de
configuration <tt>/etc/yp/`domainname`</tt>.
Sinon le démon client YP utilisera des broadcasts réseaux pour trouver les
serveurs YP pour son domaine.
Spécifier de manière explicite les serveurs et plus robuste et aussi
marginalement moins ouvert aux attaques. 
Si vous n'avez pas configuré de serveurs esclaves, mettez juste le nom du
serveur maître dans <tt>/etc/yp/`domainname`</tt>.

<li><p>
Le démon client YP est appelé
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ypbind&amp;sektion=8">ypbind(8)</a>.
Le démarrer manuellement créera le répertoire <tt>/var/yp/binding</tt>,
comme cela il sera automatiquement redémarré au démarrage.

<blockquote><pre>
ypbind
</pre></blockquote>

<li><p>
Si tout se passe bien vous devez être capable de faire une requête sur le
serveur YP en utilisant
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ypcat&amp;sektion=1">ypcat(1)</a>
et voir votre table passwd retournée.

<blockquote><pre>
ypcat passwd
bob:*:5001:5000:Bob Nuggets:/home/bob:/usr/local/bin/zsh
...
</pre></blockquote>

D'autres outils utiles pour déboguer votre configuration YP inclus
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ypmatch&amp;sektion=1">ypmatch(1)</a> et
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=yptest&amp;sektion=8">yptest(8)</a>.
</ol>

La deuxième partie de configuration de votre client YP 
inclus l'édition de fichiers de configuration locale
comme certaines tables YP utilisées par certains moyens offerts par le
système.
Tous les serveurs ne fournissent pas toutes les tables standards supportées
par le système d'exploitation, certains serveurs fournissent aussi des
tables non standards,
et vous n'êtes pas obligé d'utiliser tous les tables.
Laquelle de ces tables doit ou ne doit pas être utilisé,
et à quelles fins elles seront utilisées, est entièrement à la discrétion
de l'administrateur système de l'hôte client.

<p>
Pour une liste des tables standards YP et leur usage standard, regardez
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=Makefile.yp&amp;sektion=8">Makefile.yp(8)</a>.
L'utilisation la plus courante des cas :

<ul>
<li><p>
Si vous désirez utiliser tous les comptes utilisateurs de votre domaine YP,
ajoutez la balise par défaut au fichier master.passwd et
reconstruisez la base de données de mot de passe :

<blockquote><pre>
echo '+:*::::::::' >> /etc/master.passwd
pwd_mkdb -p /etc/master.passwd
</pre></blockquote>

Pour des détails sur l'inclusion ou l'exclusion sélective de comptes
utilisateurs, regardez
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=passwd&amp;sektion=5">passwd(5)</a>.
Pour tester si l'inclusion fonctionne, utiliser l'utilitaire
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=id&amp;sektion=1">id(1)</a>.

<li><p>
Si vous voulez inclure tous les groupes de votre domaine YP,
ajoutez la balise par défaut YP au fichier group :

<blockquote><pre>
echo '+:*::' >> /etc/group
</pre></blockquote>

Pour des détails sur l'inclusion sélective de groupes, regardez
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=group&amp;sektion=5">group(5)</a>.

<li><p>
Si vous distribuez des noms d'hôtes via YP, vous devez maintenant regarder
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=resolv.conf&amp;sektion=5">resolv.conf(5)</a>
et vérifier que l'ordre de recherche de service d'annuaire est correct.
La plupart des utilisateurs utiliseront une ligne comme celle-là :

<blockquote><pre>
lookup file yp bind
</pre></blockquote>
</ul>

<p>
<a name="locales"></a>
<h2>10.20 - Jeux de caractères et localisation</h2>

OpenBSD utilise les caractères ASCII par défaut. Il supporte
également les jeux de caractères Latin (ISO-8859-*), KOI-8, et
Unicode (UTF-8).

<a name="charset"></a>
<h3>10.20.1 - Configurer le jeu de caractère actif</h3>

<p>Pour utiliser l'un des jeux de caractères, la variable
d'environnement <i>LC_CTYPE</i> doit être définie par le nom
d'une langue supportée.
<i>LC_CTYPE</i> affecte seulement le jeu de caractères disponible
dans les applications. Elle ne va pas changer les langages utilisés
par les messages d'applications.

<p>La liste des langages supportés peut être obtenue en utilisant
la commande:
<blockquote><pre>
locale -a
</pre></blockquote>

La variable d'environnement <i>LC_CTYPE</i> peut être définie par les façons suivantes:

<ul>
<li>Si vous vous loguez via
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xdm&amp;sektion=1">xdm(1)</a>
ajoutez une ligne comme
<blockquote><pre>
export LC_CTYPE="en_US.UTF-8"
</pre></blockquote>
à <i>~/.xsession</i> avant de lancer le gestionnaire de fenêtres (jetez un oeil à la section
<a href="faq11.html#CustomizingX">personnaliser X</a> pour plus de détails).
Cet exemple active le jeu de caractères Unicode (UTF-8) et va faire que des applications
comme
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xterm&amp;sektion=1">xterm(1)</a>
vont activer le mode UTF-8 par défaut.

<li><p>Si vous vous loguez via une console texte, ajoutez une ligne comme
<blockquote><pre>
export LC_CTYPE="en_US.ISO8859-1"
</pre></blockquote>
à <i>~/.profile</i>.
Notez que la console texte supporte uniquement l'ASCII et l'ISO8859-1.
Elle ne supporte pas l'UTF-8.
</ul>

<p>À ce jour, quelques utilitaires dans le système de base supportent l'UTF-8.
La plupart va utiliser l'ASCII si l'UTF-8 est défini.
Cependant, quelques programmes de la collection de ports supportent
l'UTF-8.

<p>UTF-8 peut également être utilisé par des applications spécifiques si vous
lancez ces applications dans
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=uxterm&amp;sektion=1">uxterm(1)</a>.
Cela fonctionne même si la session de login utilise une langue non-UTF-8.

<p>Si vous vous loguez à un système distant avec
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh&amp;sektion=1">ssh(1)</a>,
la variable d'environnement <i>LC_CTYPE</i> n'est pas étendue et va devoir
être définie à la même valeur dans le terminal local.

<a name="nls"></a>
<h3>10.20.2 - Changer la langue des messages d'applications</h3>

<p>La langue utilisée pour les messages d'application peut être changée
en donnant à la variable d'environnement <i>LC_MESSAGES</i> le nom d'un
locale supporté.
Ceci peut être fait de la même façon qu'avec <i>LC_CTYPE</i>, décrite
<a href="#charset">précédemment</a>. <i>LC_MESSAGES</i> et <i>LC_CTYPE</i>
devraient tous deux être définis sur la même valeur.

<p>À ce jour, quelques utilitaires dans le système de base supportent d'autres
langues que l'anglais.
Cependant, certains programmes de la collection de ports supportent
le messages localisés dans plusieurs langages. Ils retournent à
l'anglais si la langue désirée n'est pas disponible.

<p>
<font color= "#0000e0">
<a href= "index.html">[Index de la FAQ]</a> 
<a href= "faq9.html">[Section 9 - Migrer vers OpenBSD]</a>
<a href= "faq11.html">[Section 11 - Le système X Window]</a>
</font>

<p>
<hr>
<a href= "index.html"><img height= "24" width= "24" src= "../../images/back.gif" border= "0" alt="[back]"></a> 
<a href="mailto:www@@openbsd.org">www@@openbsd.org</a> <br>
<small>
<!--
Originally [OpenBSD: faq10.html,v 1.180 ]<br>
$Translation: faq10.html,v 1.97 2013/11/06 15:12:59 rustybsd Exp $<br>
-->
$OpenBSD: faq10.html,v 1.91 2013/11/06 17:16:47 ajacoutot Exp $
</small>
</body>
</html>
@


1.91
log
@Sync with Steelix CVS
@
text
@d2351 1
a2351 1
$OpenBSD$
@


1.90
log
@Sync with Steelix CVS
@
text
@d225 2
a226 1
En fait, le <a href="../upgrade53.html">processus de mise à jour</a> standard
d2273 6
d2348 2
a2349 2
Originally [OpenBSD: faq10.html,v 1.179 ]<br>
$Translation: faq10.html,v 1.96 2013/07/23 03:18:39 rustybsd Exp $<br>
@


1.89
log
@Sync with Steelix CVS
@
text
@d1254 1
a1254 1
nouvelles fonctionnalités et le nouveau matériel ajoutées à OpenBSD, 
d1259 1
a1259 1
applications utilisées).
d1289 1
a1289 1
une procédure universelle à suivre pour la mise à jour. Certaines fois
d1299 1
a1299 1
comprenez exactement comment ça fonctionne. Les nouveaux utilisateurs
d1401 1
a1401 2
Hunk #1 succeeded at 1815.              <i>&lt;-- Ce message indique le
succès de l'opération</i>
d1408 1
a1408 1
impliqueront de multiples "hunks" et fichiers. Dans ce cas, il faudrait
d1437 1
a1437 1
votre système, vous ne bénéficierez pas du correctif ci-dessus.
d1439 2
a1440 2
est donc possible qu'un correctif ultérieur dépend d'un correctif apparu
plutôt.
d1472 2
a1473 2
Cela aide considérablement la sécurité ;
si il devait y avoir un problème de sécurité, les dégâts seraient
d2342 1
a2342 1
$Translation: faq10.html,v 1.95 2013/06/07 12:03:35 rustybsd Exp $<br>
@


1.88
log
@Sync with Steelix CVS
@
text
@a2272 5
<p>La liste des langues supportées peut être obtenue avec la commande:
<blockquote><pre>
ls /usr/share/locale
</pre></blockquote>

d2342 2
a2343 2
Originally [OpenBSD: faq10.html,v 1.178 ]<br>
$Translation: faq10.html,v 1.94 2013/05/09 08:13:31 rustybsd Exp $<br>
@


1.87
log
@Sync with Steelix CVS
@
text
@d11 1
a11 1
<meta name= "copyright"     content= "This document copyright 1998-2012 by OpenBSD.">
d225 1
a225 1
En fait, le <a href="../upgrade52.html">processus de mise à jour</a> standard
d237 2
a238 2
pour démarrer httpd normalement. Ainsi, la ligne "<tt> httpd_flags=""</tt>
ajoutées à <i>/etc/rc.conf.local</i> suffit. 
d242 1
a242 1
vous devez démarrer httpd avec une ligne comme celle-ci : <tt>"httpd_flags="-DSSL"</tt>,
d295 1
a295 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=&amp;sektion=4">httpd(1)</a>
d2282 1
a2282 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xdm&sektion=1">xdm(1)</a>
d2286 1
a2286 1
</blockquote></pre>
d2291 1
a2291 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xterm&sektion=1">xterm(1)</a>
d2297 1
a2297 1
</blockquote></pre>
d2310 1
a2310 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=uxterm&sektion=1">uxterm(1)</a>.
d2314 1
a2314 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh&sektion=1">ssh(1)</a>,
d2347 2
a2348 2
Originally [OpenBSD: faq10.html,v 1.174 ]<br>
$Translation: faq10.html,v 1.93 2013/03/07 13:11:20 rustybsd Exp $<br>
@


1.86
log
@Sync with Steelix CVS
@
text
@d1534 1
a1534 1
on rééssaie.
d2348 1
a2348 1
$Translation: faq10.html,v 1.92 2013/02/09 11:02:17 rustybsd Exp $<br>
@


1.85
log
@Sync with Steelix CVS
@
text
@d191 1
a191 1
démarrage simplement par des variables définis dans le fichier de configuration
d205 1
a205 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=inetd&amp;sektion=8">inetd(8)</a>
d241 2
a242 2
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssl&amp;sektion=8">ssl(8)</a>
), vous devez démarrer httpd avec une ligne comme celle-ci : <tt>"httpd_flags="-DSSL"</tt>,
d2348 1
a2348 1
$Translation: faq10.html,v 1.91 2012/11/01 19:46:20 rustybsd Exp $<br>
@


1.84
log
@Sync with Steelix CVS
@
text
@d225 1
a225 1
En fait, le <a href="../upgrade51.html">processus de mise à jour</a> standard
d1870 1
a1870 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=gethostbyname&amp;sektion=3">gethostbyname(3)</a> 
d1874 1
a1874 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=master.passwd&amp;sektion=5">master.passwd(5)</a> 
d1893 1
a1893 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ypldap&amp;sektion=8">ypldap(8)</a> 
d1901 1
a1901 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=scp&amp;sektion=1">scp(1)</a> 
d1913 1
a1913 1
Même quand elles sont toutes activées, le protocole NIS reste intrinsèquement 
d1953 1
a1953 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=domainname&amp;sektion=1">domainname(1)</a> 
d1955 2
a1956 2
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=defaultdomain&amp;sektion=5">defaultdomain(5)</a> 
pour qu'il soit automatiquement configuré au démarrage du système. 
d2001 1
a2001 1
Pour définir le répertoire source, éditez le fichier 
d2026 1
a2026 1
passe chiffrés de la table <tt>passwd</tt> en configurant <tt>UNSECURE=""</tt> 
d2041 1
a2041 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=Makefile.yp&amp;sektion=8">Makefile.yp(8)</a> 
d2046 1
a2046 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=hosts&amp;sektion=5">hosts(5)</a> 
d2057 1
a2057 1
Ne vous inquiétez pas des messages d'erreurs de 
d2064 1
a2064 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rpc&amp;sektion=3">rpc(3)</a> 
d2069 1
a2069 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc.conf.local&amp;sektion=8">rc.conf.local(8)</a> 
d2081 1
a2081 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=securenet&amp;sektion=5">securenet(5)</a> 
d2185 1
a2185 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ypcat&amp;sektion=1">ypcat(1)</a> 
d2246 1
a2246 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=resolv.conf&amp;sektion=5">resolv.conf(5)</a> 
d2347 2
a2348 2
Originally [OpenBSD: faq10.html,v 1.173 ]<br>
$Translation: faq10.html,v 1.90 2012/08/13 07:23:41 rustybsd Exp $<br>
@


1.83
log
@Sync with Steelix CVS
@
text
@d1162 4
a1165 4
et à démarrer ftpd à partir de rc.conf.local avec l'option <i>-D</i>. Ce
qui va démarrer ftpd en tant que service. Ce mode de fonctionnement est
beaucoup moins coûteux et plus rapide que le démarrage via inetd. La
ligne correspondant à ftpd dans rc.conf.local ressemblerait à :
d2070 1
a2070 1
et configurez <tt>portmap=YES</tt>.
d2075 1
a2075 1
echo "portmap=YES" >> /etc/rc.conf.local
d2158 1
a2158 1
echo "portmap=YES" >> /etc/rc.conf.local
d2347 2
a2348 2
Originally [OpenBSD: faq10.html,v 1.172 ]<br>
$Translation: faq10.html,v 1.89 2012/07/23 10:05:59 rustybsd Exp $<br>
@


1.82
log
@Sync with Steelix CVS
@
text
@d197 1
a197 1
ftpd_flags=NO           # for non-inetd use: ftpd_flags="-D"
d1168 1
a1168 1
ftpd_flags="-DllUSA"           # for non-inetd use: ftpd_flags="-D"
d2347 2
a2348 2
Originally [OpenBSD: faq10.html,v 1.171 ]<br>
$Translation: faq10.html,v 1.88 2012/05/27 10:22:48 rustybsd Exp $<br>
@


1.81
log
@Sync with Steelix CVS
@
text
@d506 1
a506 1
# <b>openssl genrsa -out /etc/ssl/private/server.key 4096</b>
d514 1
a514 1
# <b>openssl genrsa -des3 -out /etc/ssl/private/server.key 4096</b>
d2347 2
a2348 2
Originally [OpenBSD: faq10.html,v 1.170 ]<br>
$Translation: faq10.html,v 1.87 2012/05/26 08:19:08 rustybsd Exp $<br>
@


1.80
log
@Sync with Steelix CVS
@
text
@d47 1
a47 1
  <li><a href="#httpdchroot"   >10.16 - Parlez-moi de chroot(2) Apache ?</a>
d506 1
a506 1
# <b>openssl genrsa -out /etc/ssl/private/server.key 1024</b>
d514 1
a514 1
# <b>openssl genrsa -des3 -out /etc/ssl/private/server.key 1024</b>
d538 1
a538 1
# <b>openssl x509 -req -days 365 -in /etc/ssl/private/server.csr \
d1448 1
a1448 1
<h2>10.16 - Parlez-moi de chroot(2) Apache ?</h2>
d1487 1
a1487 1
profit des capacités ou de la "facilité".
d1534 1
a1534 1
on rééssaye.
d1865 1
a1865 1
Evidemment vous pouvez utiliser différents services d'annuaires sur OpenBSD.
d1939 1
a1939 1
Vous devez d'abord choisir un nom de domaine; cela peut-être une chaine
d2347 2
a2348 2
Originally [OpenBSD: faq10.html,v 1.169 ]<br>
$Translation: faq10.html,v 1.85 2012/05/05 19:22:54 rustybsd Exp $<br>
@


1.79
log
@Sync with Steelix CVS
@
text
@d8 2
a9 2
<meta name= "description"   content= "the OpenBSD FAQ page">
<meta name= "keywords"      content= "openbsd,faq">
d11 1
a11 1
<meta name= "copyright"     content= "This document copyright 1998-2010 by OpenBSD.">
d40 1
a40 1
  <li><a href="#AddDelUser"    >10.9 - Comment je crée un compte utilisateur ? Ou je supprime un compte utilisateur ?</a> 
d47 1
a47 1
  <li><a href="#httpdchroot"   >10.16 - Parlez moi de chroot(2) Apache ?</a>
d59 5
d134 1
a134 1
       <i>/etc/rc </i>pour activer les paramêtres 
d144 1
a144 1
       informations spécifiques à l'hôte doivent être stockées.
d182 3
a184 3
  <li>Execute <i>/etc/rc.firsttime</i>
  <li>Execute <i>/etc/rc.local</i>
  <li>Execute les scripts dans <i>/etc/rc.d</i>
d208 1
a208 1
Chaque ligne est dotée d'un commentaire qui vous montrent les drapeaux 
d210 1
a210 1
daemon. 
d213 1
a213 1
correspondante pour savoir comment démarrer un service ou daemon donné de la
d217 1
a217 1
Nous vous suggerons fortement de ne toucher au fichier <i>/etc/rc.conf</i> 
d219 2
a220 2
A la place, créez ou éditez le fichier <i>/etc/rc.conf.local</i>, copiez juste les
lignes que vous désirez modifier de <i>/etc/rc.conf</i> et ajustez les à
d225 1
a225 1
En fait, le <a href="../upgrade49.html">processus de mise à jour</a> standard
d239 1
a239 1
Mais pour démarrer httpd avec le support ssl (Reportez vous à la
d243 1
a243 1
et vous pouvez aussi ajouter d'autres paramétres pour d'autres raisons.
d257 1
a257 1
             echo -n ' daemonx';       /usr/local/sbin/daemonx
d266 1
a266 1
A partir de là, ce service sera lancé au démarrage. Vous pourrez voir
d270 1
a270 1
Starting local daemons: daemonx.
d274 32
a305 7
A partir de OpenBSD 4.9, vous avez une autre possibilité pour les
<a href="faq15.html#Packages">paquetages</a>.
La plupart des paquetages installeront maintenant un script de démarrage dans
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc.d&amp;sektion=8"><i>/etc/rc.d</i></a> 
pour gérer leur démarrage et arrêt.
C'est UNIQUEMENT utilisé pour les applications ajoutées, le système de base
n'utilise aucun script dans ce répertoire.
d310 1
a310 1
de vérification, la plupart des scripts rc.d peuvent être réduit à juste
d313 18
a330 1
qui gére la plupart des facons d'éxecuter ces taches.
d360 1
a360 1
Si ce fichier n'existe pas, créez le. Vous devez saisir les hôtes qui
d552 1
a552 1
<h2>10.7 - J'ai effectué des changements dans /etc/passwd avec
d598 1
a598 2
<h2>10.8 - Comment je crée un compte utilisateur ? Ou je supprime
    un compte utilisateur ?</h2>
d892 1
a892 1
Maintenant, il faut configurer les quotas par utilisateur. A cette fin,
d1179 1
a1179 1
Les étapes précédents pour créer un utilisateur 'ftp' user et configurer les
d1330 1
a1330 1
De manière générale, vous devriez avoir à disposition l'arborescence
d1340 1
a1340 1
A titre d'exemple, nous allons appliquer le correctif 001 pour OpenBSD
d1345 3
a1347 3
Sans ce correctif, la restauration de sauvegardes est assez difficile.
Les personnes utilisant un lecteur de bandes magnétiques ont
<i>besoin</i> de ce correctif. Les autres personnes peuvent s'en passer.
d1413 3
a1415 2
arborescence du code source n'est pas bonne, que vous n'avez pas suivi
les instructions, ou que le correctif ne correspond pas au correctif
d1423 2
a1424 2
Vous pouvez maintenant <a href="faq5.html#BldKernel">recompiler le
noyau</a> comme d'habitude, l'installer et redémarrer le système.
d1448 1
a1448 1
<h2>10.16 - Parlez moi de chroot(2) Apache ?</h2>
d1455 1
a1455 1
par défaut. Etant un grand pas en avant du point de vue de la sécurité,
d1883 1
a1883 1
Soyez prudent, certains systèmes d'exploitation possédent des services
d1892 1
a1892 1
vous choisissez le premier, alors que le daemon 
d1917 1
a1917 1
serveur ne peut vérifier de maniére fiable l'identité de l'autre.
d1923 2
a1924 2
accés physique à votre réseau.
Quiconque obtient l'accés root d'un des ordinateurs connecté sur l'un de vos
d1943 2
a1944 2
Dans le cas ou vous devez maintenir plusieurs domaines YP distincts, il est
surement meilleur de choisir des noms de description comme "ventes",
d1964 1
a1964 1
Initialiser le serveur YP en utilisant la commande intéractive :
d1970 1
a1970 1
A ce stade, il n'est plus nécessaire de spécifier les serveurs esclaves.
d1978 2
a1979 2
reçevront pas les informations demandées. Donc, les interruptions de service
YP rendront typiquement les hôtes clients complétement inutilisables tant
d1997 1
a1997 1
A la place, vous devrez éditer les fichiers de configuration avec un éditeur
d2021 1
a2021 1
Etudiez les valeurs des variables <tt>MINUID</tt>, <tt>MAXUID</tt>,
d2032 1
a2032 1
domaines initialisés aprés le changement, mais n'affecte pas les domaines
d2082 1
a2082 1
ou les fonctionnalités de sécurité de votre serveur daemon YP dans
d2084 1
a2084 1
Mais sachez que les deux ne fournissent seulement que du contrôle d'accès IP.
d2090 1
a2090 1
Finalement démarrez le daemon serveur YP :
d2135 1
a2135 1
serveurs YP maitres et esclaves associés avec le domaine, qui est crée
d2137 1
a2137 1
Dans le cas ou vous l'avez supprimé accidentellement, executez <tt>ypinit -u</tt>
d2145 1
a2145 1
En premier, vous devez exécuter le daemon YP client,
d2147 1
a2147 1
Finaliser les points suivants vous permettra de récuperer les données du
d2165 1
a2165 1
Sinon le daemon client YP utilisera des broadcasts réseaux pour trouver les
d2173 1
a2173 1
Le daemon client YP est appelé
d2194 1
a2194 1
D'autres outils utiles pour deboguer votre configuration YP inclus
d2227 1
a2227 1
Pour des détails sur l'inclusion ou l'exclusion séléctive de comptes
d2241 1
a2241 1
Pour des détails sur l'inclusion séléctive de groupes, regardez
d2255 78
d2347 2
a2348 2
Originally [OpenBSD: faq10.html,v 1.160 ]<br>
$Translation: faq10.html,v 1.84 2011/05/13 08:28:31 benoit Exp $<br>
@


1.78
log
@Sync with Steelix CVS
@
text
@d68 2
a69 6
<p> 
Les utilisateurs existant sur le système doivent être rajoutés au groupe
<kbd>"wheel"</kbd> à la main. Ceci est fait pour des raisons
de sécurité, et vous devriez apporter une attention toute particulière
lorsque vous donnez l'accès à ce groupe à des utilisateurs. Sous
OpenBSD, les utilisateurs appartenant au groupe <kbd>wheel</kbd> sont
d72 3
a74 5
pour devenir root. Les utilisateurs n'appartenant pas au groupe
<kbd>"wheel"</kbd> ne peuvent pas utiliser su(1). Voici un exemple d'une entrée
<kbd>/etc/group</kbd> pour mettre l'utilisateur <b>ericj</b>
dans le groupe <kbd>"wheel"</kbd>.
<p>Si vous ajoutez un utilisateur avec 
d76 7
a82 5
vous pouvez le mettre dans le groupe wheel en répondant wheel à la
question "<tt>Invite <i>user</i> into other groups:</tt>". Ceci aura
pour effet de rajouter l'entrée correspondante dans /etc/group qui
ressemble à la ligne suivante :

d88 2
a89 4
Si vous cherchez un moyen pour limiter l'accès des utilisateurs aux
privilèges du super utilisateur, sans pour autant les mettre dans le
groupe <kbd>"wheel"</kbd>, utilisez

d123 1
a123 1
OpenBSD utilise un démarrage de type 
d177 3
a179 2
  <li>Les services locaux sont démarrés à partir de
      <i>/etc/rc.local</i>.
d212 1
a212 1
Nous vous suggerons fortement de ne jamais toucher au fichier <i>/etc/rc.conf</i> 
d214 1
a214 1
A la place, créez un fichier <i>/etc/rc.conf.local</i>, copiez juste les
d218 3
a220 2
changements seront dans un seul fichier.
En fait, le <a href="../upgrade48.html">processus de mise à jour</a> standard
d244 1
a244 1
d'autres méthodes, vous devez utiliser le fichier
d247 1
a247 1
service soit lancé au démarrage. Pour cela, je rajoute les lignes
d268 17
a586 1
Reading /etc/login.conf
d591 1
a591 1
Don't worry about mistakes. I will give you the chance later to correct any input.
d594 1
a594 1
Enter shell csh ksh nologin sh [sh]: <b>ksh</b>
d599 1
a599 2
Login class auth-defaults auth-ftp-defaults daemon default staff 
[default]: <b><i>Entrée</i></b>
d674 12
a685 12
Etant donné que la commande user(8) n'est pas interactive, la manière la
plus simple et la plus efficace pour créer des comptes utilisateurs est
d'utiliser la commande adduser(8). La commande <i>/usr/sbin/user</i> est
seulement une interface aux autres commandes <i>/usr/sbin/user*</i>.
Ainsi, dans l'exemple qui suit il est possible d'utiliser soit <b>user
add</b> soit <b>useradd</b>. Le choix est votre et ne change rien au
résultat. <p>Dans cet exemple, nous allons créer un compte avec les
mêmes spécificités que le compte crée
<a href="#adduser">précédemment</a>. useradd(8) est bien plus facile à
utiliser si vous connaissez les paramètres par défaut avant de créer un
compte utilisateur. Ces paramètres se trouvent dans le fichier
<i>/etc/usermgmt.conf </i>et peuvent être visualisés comme suit :
d699 1
a699 1
Ces paramètres vont être appliqués à chaque nouveau compte si vous ne
d701 1
a701 1
Par exemple, dans notre cas nous voulons que l'utilisateur appartienne
d704 6
a709 6
être spécifiés sous leur forme cryptée en ligne de commande. Vous devez
donc utiliser, au préalable, l'utilitaire
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=encrypt&amp;sektion=1">encrypt(1)</a> 
pour créer le mot de passe. Par exemple : Les mots de passe par défaut
sous OpenBSD utilisent l'algorithme Blowfish avec 6 réitérations. Voici
un exemple d'utilisation de la commande encrypt :
d718 5
a722 2
Maintenant que nous avons le mot de passe crypté, nous sommes prêts à
créer le compte utilisateur :
a989 1
Reading /etc/login.conf
d994 1
a994 1
Don't worry about mistakes. I will give you the chance later to correct any input.
d997 1
a997 1
Enter shell csh false ksh nologin sh tcsh zsh [sh]: <b>false</b>
d1002 1
a1002 2
Login class auth-defaults auth-ftp-defaults daemon default staff 
[default]: <b><i>Entrée</i></b>
d1130 10
d1399 1
d1698 1
d1726 1
d1858 1
d1885 1
d2222 2
a2223 2
Originally [OpenBSD: faq10.html,v 1.153 ]<br>
$Translation: faq10.html,v 1.83 2011/04/09 07:17:03 benoit Exp $<br>
@


1.77
log
@Sync with Steelix CVS
@
text
@d1172 1
a1172 1
inattendue).
d1186 3
a1188 2
nouvelles fonctionnalités ajoutées à OpenBSD. Les correctifs corrigent
uniquement des problèmes de stabilité ou de sécurité qui doivent être
d2195 2
a2196 2
Originally [OpenBSD: faq10.html,v 1.152 ]<br>
$Translation: faq10.html,v 1.82 2010/11/22 21:09:37 benoit Exp $<br>
@


1.76
log
@Sync with Steelix CVS
@
text
@d1353 1
a1353 1
Vous pouvez maintenant <a href="faq5.html#Building">recompiler le
d2194 2
a2195 2
Originally [OpenBSD: faq10.html,v 1.151 ]<br>
$Translation: faq10.html,v 1.81 2010/11/06 15:15:31 benoit Exp $<br>
@


1.75
log
@Sync with Steelix CVS
@
text
@d224 1
a224 1
En fait, le <a href="../upgrade47.html">processus de mise à jour</a> standard
d1574 1
a1574 1
        0c085000 2c0be000 rlib 0    1   0      /usr/lib/libc.so.50.1
d1582 1
a1582 1
# <b>cp /usr/lib/libc.so.50.1 /var/www/usr/lib</b>
d2194 2
a2195 2
Originally [OpenBSD: faq10.html,v 1.150 ]<br>
$Translation: faq10.html,v 1.80 2010/10/31 07:48:31 benoit Exp $<br>
@


1.74
log
@Sync with Steelix CVS
@
text
@d1507 6
d2194 2
a2195 2
Originally [OpenBSD: faq10.html,v 1.149 ]<br>
$Translation: faq10.html,v 1.79 2010/05/23 06:42:51 benoit Exp $<br>
@


1.73
log
@Sync with Steelix CVS
@
text
@d11 1
a11 1
<meta name= "copyright"     content= "This document copyright 1998-2009 by OpenBSD.">
d224 1
a224 1
En fait, le <a href="../upgrade46.html">processus de mise à jour</a> standard
d2188 2
a2189 2
Originally [OpenBSD: faq10.html,v 1.148 ]<br>
$Translation: faq10.html,v 1.78 2010/05/16 20:16:01 gapz Exp $<br>
@


1.72
log
@Sync with Steelix CVS
@
text
@d209 1
a209 1
utilisés dans le cadre d'une utilisation <b>NORMALE </b>du service ou du
d1512 1
a1512 1
<tt>-u</tt> de httpd(8) dans<i>
a2050 1
</ol>
d2189 1
a2189 1
$Translation: faq10.html,v 1.77 2009/11/07 09:22:00 benoit Exp $<br>
@


1.71
log
@Sync with Steelix CVS
@
text
@d2057 2
a2058 5
Donc, donnez une attention particuliére pour ne jamais endommager ce
fichier, vous pourrez le régénerer manuellement en utilisant
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=makedbm&amp;sektion=8"
>makedbm(8)</a>,
ou en réinitialisant le serveur en réexecutant <tt>ypinit -m</tt>.
d2189 2
a2190 2
Originally [OpenBSD: faq10.html,v 1.147 ]<br>
$Translation: faq10.html,v 1.76 2009/11/05 09:09:28 benoit Exp $<br>
@


1.70
log
@Sync with Steelix CVS
@
text
@d1854 3
a1856 1
	
d1870 1
a1870 2
<ol>
<li><p>
d1883 19
d1904 6
a1909 6
Habituellement, l'endroit par défaut <tt>/etc</tt> n'est <em>pas</em>
approprié :
Comme règle, vous n'avez pas besoin de tous les comptes et groupes existants
sur le serveur pour tous vos hôtes clients.
En particulier, ne pas fournir le compte root et donc garder le hash du mot
de passe root confidentiel est plutôt bénéfique pour la sécurité.
d1920 2
a1921 1
Pour définir le répertoire source, éditez le fichier <tt>/var/yp/Makefile.yp</tt>
d1928 16
d1946 1
a1946 1
dans <tt>/var/yp/Makefile.yp</tt>.
d1949 7
a1955 3
Une sauvegarde du modèle original de <tt>Makefile.yp</tt> est placée dans
<tt>/var/yp/Makefile.yp.dist</tt> au moment de l'installation du système,
dans le cas ou vous auriez besoin de retrouver une configuration initiale.
d1969 1
a1969 1
Initialisez le serveur YP en utilisant la commande interactive
d1972 2
a1973 1
ypinit -m
d1976 4
a1979 27
A cet instant, il n'est pas encore nécessaire de spécifier les serveurs
esclaves.
Pour ajouter des serveurs esclaves, vous devez re-exécuter
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ypinit&amp;sektion=8">ypinit(8)</a> 
plus tard, en utilisant l'option <tt>-u</tt>.
Configurer au moins un serveur esclave pour chaque domaine est utile pour
éviter les interruptions de service, le serveur maître pourrait s'arrêter ou
perdre sa connectivité réseau, en particulier les processus clients
essaieront d'accéder aux blocs de tables YP indéfiniment tant qu'ils ne
reçevront pas les informations demandées. Donc, les interruptions de service
YP rendront typiquement les hôtes clients complétement inutilisables tant
que le service YP n'est pas de retour. 

<p>
Il faut remarquer que les changements fait dans <tt>/var/yp/Makefile.yp</tt> 
après avoir exécuté <tt>ypinit -m</tt> n'ont aucun effet parce que <tt>ypinit -m</tt>
copie le modèle de <tt>/var/yp/`domainname`/Makefile</tt>.
Bien que le la plupart des fichiers de la base de données dans <tt>/var/yp/`domainname`</tt>
peuvent être facilement recrées en utilisant ce nouveau Makefile, il y a une
exception :
Le fichier <tt>ypservers.db</tt>, affichant tous les serveurs YP maîtres et
esclaves associés au domaine, est crée directement de <tt>ypinit -m</tt>
et modifié exclusivement par <tt>ypinit -u</tt>.
Donc, il faut prendre un soin particulier à ne jamais endommager ce fichier
en particulier, sinon vous devrez le regénérer manuellement en utilisant
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=makedbm&amp;sektion=8">makedbm(8)</a>,
ou en reinitialisant le serveur en re-exécutant <tt>ypinit -m</tt>.
d2053 11
d2192 2
a2193 2
Originally [OpenBSD: faq10.html,v 1.146 ]<br>
$Translation: faq10.html,v 1.75 2009/10/19 19:33:33 benoit Exp $<br>
@


1.69
log
@Sync with Steelix CVS
@
text
@a128 1
<p>
d135 1
a135 1
       <i>/etc/rc </i>pour savoir quels services doivent être
d137 2
a138 1
  <li>/etc/rc.conf.local - Fichier de configuration servant à compléter
d140 1
a140 1
       qui est commode lors de la mise à jour du système.
d159 2
a160 1
<i>/etc/rc.conf</i> (ou <i>/etc/rc.conf.local</i>), <i>/etc/rc.local</i>
d169 3
a171 2
  <li>Les variables de configuration sont lues à partir de
      <i>/etc/rc.conf</i> et ensuite <i>/etc/rc.conf.local</i>. Les
d190 2
a191 2
La plupart des services fournis par défaut avec OpenBSD sont lancés au
démarrage simplement en modifiant le fichier de configuration
d201 11
a211 6
Une ligne telle que celle-ci montre que ftpd n'est pas lancé au
démarrage du système (du moins pas à travers rc(8), lisez la
<a href="faq10.html#AnonFTP">FAQ Serveur FTP Anonyme</a> pour plus
d'informations). Dans tous les cas, chaque ligne est dotée d'un
commentaire qui vous montrent les drapeaux utilisés dans le cadre d'une
utilisation <b>NORMALE </b>du service. Cela ne veut pas dire que vous
d213 17
a229 3
correspondante pour savoir comment démarrer un service donné de la
manière que vous souhaitez. Par exemple, voici la ligne par défaut
concernant httpd(8) :
d236 3
a238 2
pour démarrer httpd normalement. Ainsi, la ligne "<b> httpd_flags=""</b>
suffit. Mais pour démarrer httpd avec le support ssl (Reportez vous à la
d241 2
a242 10
), vous devez démarrer httpd avec une ligne comme celle-ci : "httpd_flags="-
DSSL"".

<p>
Une autre approche serait de ne jamais toucher à <i>/etc/rc.conf</i>. Au
contraire, créez le fichier <i>/etc/rc.conf.local</i> et ne copiez que
les lignes que vous comptez changer dans <i>/etc/rc.conf</i> et
modifiez-les comme vous voulez. Ceci peut rendre vos mises à jour
futures plus faciles -- tous les changements se trouvant dans un
fichier.
d1513 1
a1513 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc.conf&amp;sektion=8">rc.conf</a></i>.
d2162 2
a2163 2
Originally [OpenBSD: faq10.html,v 1.144 ]<br>
$Translation: faq10.html,v 1.74 2009/05/24 09:49:53 benoit Exp $<br>
@


1.68
log
@Sync with Steelix CVS
@
text
@d2103 1
a2103 1
pwd_mkdb /etc/master.passwd
d2148 2
a2149 2
Originally [OpenBSD: faq10.html,v 1.143 ]<br>
$Translation: faq10.html,v 1.73 2009/04/30 06:31:13 benoit Exp $<br>
@


1.67
log
@Sync with Steelix CVS -- we are back to normal operation!
@
text
@d1552 4
a1555 4
        Start    End      Type Ref Name
        00000000 00000000 exe   1  Count.cgi
        03791000 237ca000 rlib  1  /usr/lib/libc.so.30.3
        03db4000 03db4000 rtld  1  /usr/libexec/ld.so
d1562 1
a1562 1
# <b>cp /usr/lib/libc.so.30.3 /var/www/usr/lib</b>
d1775 3
a1777 3
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=getpwent&sektion=3">getpwent(3)</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=getgrent&sektion=3">getgrent(3)</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=gethostbyname&sektion=3">gethostbyname(3)</a> 
d1781 1
a1781 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=master.passwd&sektion=5">master.passwd(5)</a> 
d1788 1
a1788 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=yp&sektion=8">yp(8)</a>
d1800 1
a1800 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ypldap&sektion=8">ypldap(8)</a> 
d1807 2
a1808 2
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cron&sektion=8">cron(8)</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=scp&sektion=1">scp(1)</a> 
d1836 1
a1836 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=kerberos&sektion=8">kerberos(8)</a>.
d1857 1
a1857 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=domainname&sektion=1">domainname(1)</a> 
d1859 1
a1859 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=defaultdomain&sektion=5">defaultdomain(5)</a> 
d1879 1
a1879 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=user&sektion=8">user(8)</a>
d1881 1
a1881 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=group&sektion=8">group(8)</a>.
d1905 1
a1905 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=Makefile.yp&sektion=8">Makefile.yp(8)</a> 
d1908 3
a1910 3
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=passwd&sektion=5">passwd(5)</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=group&group=5">group(5)</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=hosts&sektion=5">hosts(5)</a> 
d1923 1
a1923 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ypinit&sektion=8">ypinit(8)</a> 
d1945 1
a1945 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=makedbm&sektion=8">makedbm(8)</a>,
d1950 1
a1950 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rpc&sektion=3">rpc(3)</a> 
d1953 1
a1953 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=portmap&sektion=8">portmap(8)</a>.
d1955 1
a1955 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc.conf.local&sektion=8">rc.conf.local(8)</a> 
d1967 1
a1967 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=securenet&sektion=5">securenet(5)</a> 
d1969 1
a1969 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ypserv.acl&sektion=5">ypserv.acl(5)</a>.
d2000 1
a2000 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=yppasswdd&sektion=8">yppasswdd(8)</a> :
d2053 1
a2053 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ypbind&sektion=8">ypbind(8)</a>.
d2064 1
a2064 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ypcat&sektion=1">ypcat(1)</a> 
d2074 2
a2075 2
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ypmatch&sektion=1">ypmatch(1)</a> et
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=yptest&sektion=8">yptest(8)</a>.
d2092 1
a2092 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=Makefile.yp&sektion=8">Makefile.yp(8)</a>.
d2108 1
a2108 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=passwd&sektion=5">passwd(5)</a>.
d2110 1
a2110 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=id&sektion=1">id(1)</a>.
d2121 1
a2121 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=group&sektion=5">group(5)</a>.
d2125 1
a2125 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=resolv.conf&sektion=5">resolv.conf(5)</a> 
d2148 2
a2149 2
Originally [OpenBSD: faq10.html,v 1.142 ]<br>
$Translation: faq10.html,v 1.72 2009/04/13 11:01:35 benoit Exp $<br>
@


1.66
log
@Sync with Steelix CVS
@
text
@d11 1
a11 1
<meta name= "copyright"     content= "This document copyright 1998-2007 by OpenBSD.">
d51 8
d1759 377
d2148 2
a2149 2
Originally [OpenBSD: faq10.html,v 1.140 ]<br>
$Translation: faq10.html,v 1.71 2008/11/26 21:11:03 benoit Exp $<br>
@


1.65
log
@Sync with Steelix CVS
@
text
@d504 3
a506 1
fichier de mots de passe. Cet outil s'appelle vipw(8). vipw utilisera vi
d1477 8
d1763 2
a1764 2
Originally [OpenBSD: faq10.html,v 1.138 ]<br>
$Translation: faq10.html,v 1.70 2008/07/10 19:59:30 gapz Exp $<br>
@


1.64
log
@Sync with Steelix CVS
@
text
@d825 1
a825 1
/: blocks in use: 62, limits (soft = 0, hard = 0)
d835 1
a835 1
/: blocks in use: 62, limits (soft = 1000, hard = 1050)
d1753 2
a1754 2
Originally [OpenBSD: faq10.html,v 1.137 ]<br>
$Translation: faq10.html,v 1.69 2008/04/18 18:35:17 gapz Exp $<br>
@


1.63
log
@Sync with Steelix CVS
@
text
@d393 1
a393 1
   # <b>kill -HUP `head -1 /var/run/sendmail.pid`</b>
d1252 1
a1252 1
Sans ce correctif, la restoration de sauvegardes est assez difficile.
d1375 1
a1375 1
le répertoire <i>/var/www</i>. Dans la configurarion par défaut
d1505 3
a1507 3
    # <b>apachectl stop</b>
    /usr/sbin/apachectl stop: httpd stopped
    # <b>httpd -u</b>
d1518 3
a1520 3
    # <b>apachectl stop</b>
    /usr/sbin/apachectl stop: httpd stopped
    # <b>httpd</b>
d1543 3
a1545 3
    # <b>mkdir -p /var/www/usr/lib /var/www/usr/libexec</b>
    # <b>cp /usr/lib/libc.so.30.3 /var/www/usr/lib</b>
    # <b>cp /usr/libexec/ld.so /var/www/usr/libexec</b>
d1566 3
a1568 3
    # <b>mkdir -p /var/www/var/www</b>
    # <b>cd /var/www/var/www</b>
    # <b>ln -s ../../wwwcount wwwcount</b>
d1580 1
a1580 2
    # <b>tar cf - /usr/local/lib/wwwcount | (cd /var/www; tar xpf - )
      </b>
d1602 1
a1602 1
OpenBSD fair en sorte que l'utilisateur sous lequel le programme
d1754 1
a1754 1
$Translation: faq10.html,v 1.68 2008/01/28 05:31:41 saad Exp $<br>
@


1.62
log
@Sync with Steelix CVS
@
text
@d924 1
a924 1
même chose. Quand le mode anonyme est utilisé, le démon ftp va se
d1081 1
a1081 1
qui va démarrer ftpd en tant que démon. Ce mode de fonctionnement est
d1755 1
a1755 1
$Translation: faq10.html,v 1.67 2008/01/14 21:54:35 saad Exp $<br>
@


1.61
log
@sync with steelix translation CVS
@
text
@d1709 4
a1712 4
A partir d'OpenBSD 3.7, ksh(1) a été amélioré. Un certain nombre de
caractères spéciaux ont été ajoutés au niveau de la chaîne primaire de
l'invite de commandes, PS1. Ces caractères sont similaires à ceux
présents dans bash.
d1754 2
a1755 2
Originally [OpenBSD: faq10.html,v 1.136 ]<br>
$Translation: faq10.html,v 1.66 2007/03/16 14:58:50 ajacoutot Exp $<br>
@


1.60
log
@sync with steelix translation CVS
@
text
@d1447 1
a1447 1
Il existe néanmoins d'autres techniques, notamment logguer vers un
d1755 1
a1755 1
$Translation: faq10.html,v 1.65 2007/02/20 15:18:28 ajacoutot Exp $<br>
@


1.59
log
@sync with Steelix CVS
@
text
@d183 1
a183 1
<a href="http://www.openbsd.org/cgi-bin/cvsweb/src/etc/rc.conf">/etc/rc.conf</a> 
d302 2
a303 2
<li><a href="http://www.sendmail.org/tips/relaying.html">http://www.sendmail.org/tips/relaying.html</a>
<li><a href="http://www.sendmail.org/antispam.html">http://www.sendmail.org/antispam.html</a>
d1754 2
a1755 2
Originally [OpenBSD: faq10.html,v 1.135 ]<br>
$Translation: faq10.html,v 1.64 2007/02/05 22:26:14 benoit Exp $<br>
@


1.58
log
@sync with Steelix CVS
@
text
@d129 1
a129 1
       démarrés en même temps que le système
d131 1
a131 1
       /etc/rc.conf, ainsi vous ne devez pas toucher à /etc/rc.conf, ce
d164 2
a165 2
  <li>Les systèmes de fichiers sont montés
  <li><i>/tmp </i>est nettoyé et les fichiers d'éditeurs sont préservés
d170 2
a171 2
          paramètres) sont positionnés </ul>
  <li>Les services système sont démarrés
d174 1
a174 1
      <i>/etc/rc.local</i>
d382 1
a382 1
Si vous désirez interroger QUE le le fichier d'hôtes, utilisez ce qui
d507 1
a507 1
/etc/passwd, /etc/pwd.db, et /etc/spwd.db qui tiendront compte de vos
d536 1
a536 1
<i>/etc/passwd</i>, <i>/etc/group</i>, et les bases de données shell.
d590 1
a590 1
son répertoire $HOME (s'il lui appartient), et son courrier. Bien
d915 1
a915 1
configuration d'un serveur FTP anonyme, les logs générés, ...etc.
d1070 1
a1070 1
vers syslog en plus des commandes ftp get, retrieve, etc.
d1091 1
a1091 1
dans <i>/etc/inetd.conf</i> et en veillant qu'inetd ait bien relu sont
d1117 1
a1117 1
Il est possible de retreindre les utilisateurs ftp à leur répertoire
d1755 1
a1755 1
$Translation: faq10.html,v 1.63 2007/02/02 14:20:59 ajacoutot Exp $<br>
@


1.57
log
@sync with Steelix CVS
@
text
@d1488 1
a1488 1
<a href="../faq15.html#PkgMgmt">paquetages</a>. Bien qu'il soit un
d1684 2
a1685 2
<a href="../faq15.html#PkgMgmt">paquetages</a> ou soit via les
<a href="../faq15.html#Ports">ports</a>.
d1755 1
a1755 1
$Translation: faq10.html,v 1.62 2007/02/01 16:31:37 ajacoutot Exp $<br>
@


1.56
log
@sync with Steelix CVS
@
text
@d1242 1
a1242 1
<a href="../../ftp.html">serveurs FTP</a>.
d1755 1
a1755 1
$Translation: faq10.html,v 1.61 2007/01/29 22:09:47 saad Exp $<br>
@


1.55
log
@sync with steelix translation CVS
@
text
@d11 1
a11 1
<meta name= "copyright"     content= "This document copyright 1998-2006 by OpenBSD.">
d1723 1
d1728 3
a1730 1
pour plus de détails !)
d1735 1
a1735 1
export PS1="\n\u@@\H\n\w $ "
d1754 2
a1755 2
Originally [OpenBSD: faq10.html,v 1.134 ]<br>
$Translation: faq10.html,v 1.60 2006/11/06 15:20:27 ajacoutot Exp $<br>
@


1.54
log
@sync with steelix translation CVS
@
text
@d994 1
a994 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&amp;sektion=8">ftp(8)</a>. 
d1751 2
a1752 2
Originally [OpenBSD: faq10.html,v 1.133 ]<br>
$Translation: faq10.html,v 1.59 2006/11/03 10:18:49 ajacoutot Exp $<br>
@


1.53
log
@sync with steelix translation CVS
@
text
@d22 1
a22 2
<!-- <a href= "faq11.html">[Section 11 - Optimisation des Performances]</a> -->
<a href="faq12.html">[Section 12 - Questions Spécifiques Aux Plates-Formes]</a>
d1742 1
a1742 2
<!-- <a href= "faq11.html">[Section 11 - Optimisation des Performances]</a> -->
<a href="faq12.html">[Section 12 - Questions Spécifiques Aux Plates-Formes]</a>
d1751 2
a1752 2
Originally [OpenBSD: faq10.html,v 1.132 ]<br>
$Translation: faq10.html,v 1.58 2006/09/12 08:11:42 ajacoutot Exp $<br>
@


1.52
log
@sync with steelix translation CVS
@
text
@d48 1
a48 1
  <li><a href="#httpdchroot"   >10.16 - Parlez moi de chroot() Apache ?</a>
d1354 1
a1354 1
<h2>10.16 - Parlez moi de chroot() Apache ?</h2>
d1601 1
a1601 1
Le but est la mise en place d'un serveur web sécurisé et le chroot()age
d1753 2
a1754 2
Originally [OpenBSD: faq10.html,v 1.131 ]<br>
$Translation: faq10.html,v 1.57 2006/09/11 12:35:58 ajacoutot Exp $<br>
@


1.51
log
@sync with Steelix CVS
@
text
@a1365 1
<p>
d1376 4
a1379 1
le répertoire <i>/var/www</i>. Cela aide considérablement la sécurité --
d1384 1
a1384 1
<h3>Qu'est-ce que cela signifie pour l'utilisateur ?</h3>
d1387 7
a1393 4
En gros, chroot(2)er Apache est quelque chose de nouveau. Ce mode de
configuration n'est pas adopté par la plupart des autres systèmes
d'exploitation. Beaucoup d'applications et de configurations système ne
fonctionneront plus comme avant.
d1416 3
a1418 2
similaire à <i>/var/www/home</i>.

d1421 10
a1430 7
    fichiers log est réalisée en renommant les anciens fichiers, ensuite
    en envoyant à httpd(8) un signal SIGUSR1 qui forcera Apache à fermer
    ses anciens fichiers logs et à en ouvrir de nouveaux. Ceci n'est
    désormais plus possible, étant donné que httpd(8) n'a pas la
    possibilité d'ouvrir les fichiers de log en écriture une fois que ses
    privilèges ont été abaissés. httpd(8) doit donc être stoppé et 
    relancé :
d1433 3
a1435 1
   # <b>apachectl stop && apachectl start</b>
d1438 10
d1466 10
a1475 3
    requiert certaines notions de programmation -- la plupart des
    utilisateurs trouveront plus facile de ne pas employer le chroot(2)
    en attendant une mise à jour de ces CGIs.
d1479 3
a1481 3
changées pour fonctionner dans le chroot. Dans d'autres cas, vous devrez
tout simplement retirer cette option en utilisant l'option <tt>-u</tt>
de httpd(8) dans<i>
d1587 24
a1610 2
Dans cet exemple, le programme est simple et malgré ça, nous avons
constaté plusieurs problèmes. Certaines applications sont relativement
d1613 1
a1613 1
mettre en chroot(2) et même si c'était le cas, vous perdriez tous les
d1615 22
a1636 8
dont elles ont besoin pour fonctionner. Même avec une application aussi
simple que celle que nous avons utilisé pour cet exemple, l'accès au
disque est nécessaire (pour mettre à jour les compteurs). Du coup,
certains avantages de chroot(2) ont été perdus. De manière générale, le
minimum de fichiers nécessaires pour faire fonctionner une application
devraient être copiés dans le chroot.
<i>On ne peut ou on ne doit pas chroot(2)er n'importe quelle
   application</i>
d1753 2
a1754 2
Originally [OpenBSD: faq10.html,v 1.129 ]<br>
$Translation: faq10.html,v 1.56 2006/09/08 20:41:17 saad Exp $<br>
@


1.50
log
@sync with Steelix CVS
@
text
@d770 1
a770 1
sur le système néamoins il pourra utiliser le service ftp.
d1149 1
a1149 1
innatendue).
d1164 1
a1164 1
uniquement des problémes de stabilité ou de sécurité qui doivent être
d1175 1
a1175 1
Vu que tous les correctifs sont appliqués systèmatiquement au code
d1282 1
a1282 1
Comme vous pouvez le constater, le début du patch inclu de brêves instructions
d1342 1
a1342 1
Les correctifs qui n'impactement pas directement votre utilisation du
d1378 1
a1378 1
si il devait y avoir un problème de sécurité, les dégats seraient
d1397 1
a1397 1
leur partition /var/www existente est trop petite pour accueillir tous
d1400 1
a1400 1
evidemment, utiliser des liens symboliques dans le répertoire HOME de
d1534 1
a1534 1
données. Afin que nous puissons utiliser exactement la même
d1585 1
a1585 1
Une directive Unix traditionelle est d'utiliser pour l'utilisateur root
d1618 1
a1618 1
touches flèchées, et CTRL-A/CTRL-E pour aller au début/à la fin de la
d1690 1
a1690 1
$Translation: faq10.html,v 1.55 2006/09/07 04:40:29 saad Exp $<br>
@


1.49
log
@sync with steelix translation CVS
@
text
@d1362 1
a1362 1
cela peut créer des problè si vous n'y êtes pas préparé.
d1371 1
a1371 1
répertoire comme sont répertoire <tt>/</tt> (root). Dans le cas
d1373 1
a1373 1
ports TCP (bien qu'il n'accepte pas encore de données), et lis sont
d1387 1
a1387 1
d'exploitation. beaucoup d'applications et de configurations système ne
d1410 1
a1410 1
comme répertoire HOME pour ces utilisateurs mais plutot quelque chose
d1419 1
a1419 1
    possibilité d'ouvrir les fichiers de log en ecriture une fois que ses
d1690 1
a1690 1
$Translation: faq10.html,v 1.54 2006/08/30 14:25:02 ajacoutot Exp $<br>
@


1.48
log
@sync with steelix translation CVS
@
text
@d1074 1
a1074 3
<b>
ftp stream tcp nowait root /usr/libexec/tcpd ftpd -llUSA
</b> 
d1689 2
a1690 2
Originally [OpenBSD: faq10.html,v 1.128 ]<br>
$Translation: faq10.html,v 1.53 2006/08/24 11:12:51 ajacoutot Exp $<br>
@


1.47
log
@sync with steelix translation CVS
@
text
@d71 1
a71 1
<kbd>/etc/group</kbd> pour mettre l'utilisateur <strong>ericj</strong>
d102 1
a102 1
# <strong>cd /SRC; dump 0f - . | (cd /DST; restore -rf - )</strong>
d114 1
a114 1
# <strong>cd /SRC; tar cf -  . | (cd /DST; tar xpf - )</strong>
d133 1
a133 2
       qui est commode pour ceux qui (re)mettent souvent à jour leur
       système.
d198 2
a199 2
devez appeler ce service avec ces mêmes drapeaux. Vous pouvez toujours
utiliser man(1) pour savoir comment démarrer un service donné de la
d226 1
a226 1
Pour les services que vous installez via la collection de ports ou
d268 1
a268 1
# <strong>grep relay-domains /etc/mail/sendmail.cf</strong>
d294 1
a294 1
# <Strong>kill -HUP `head -1 /var/run/sendmail.pid`</strong>
d355 1
a355 1
<b>PS:</b> Il est à noter que OpenBSD n'a pas de groupe "mail". Vous
d378 3
a380 3
<pre>
   hosts      files dns
</pre>
d386 3
a388 3
<pre>
   hosts      files
</pre>
d393 1
a393 1
<pre>
d395 1
a395 1
</pre>
d424 3
a426 5
<div style="margin-left: 2em">
<pre>
# <strong>openssl genrsa -out /etc/ssl/private/server.key 1024</strong>
</pre>
</div>
d432 3
a434 5
<div style="margin-left: 2em">
<pre>
# <strong>openssl genrsa -des3 -out /etc/ssl/private/server.key 1024</strong>
</pre>
</div>
d442 3
a444 5
<div style="margin-left: 2em">
<pre>
# <strong>openssl req -new -key /etc/ssl/private/server.key -out /etc/ssl/private/server.csr</strong>
</pre>
</div>
d456 4
a459 6
<div style="margin-left: 2em">
<pre>
# <strong>openssl x509 -req -days 365 -in /etc/ssl/private/server.csr \
       -signkey /etc/ssl/private/server.key -out /etc/ssl/server.crt</strong>
</pre>
</div>
d547 1
a547 1
# <strong>adduser</strong>
d600 2
a601 2
# <strong>rmuser</strong>
Enter login name for user to remove: <strong>testuser</strong>
d607 2
a608 2
Is this the entry you wish to remove? <strong>y</strong>
Remove user's home directory (/home/testuser)? <strong>y</strong>
d654 1
a654 1
$ <strong>user add -D</strong>
d678 1
a678 1
$ <strong>encrypt -p -b 6</strong>
d688 2
a689 2
# <strong>user add -p '$2a$06$YOdOZM3.4m6MObBXjeZtBOWArqC2.uRJZXUkOghbieIvSWXVJRzlq' -u 1002 \
-s /bin/ksh -c "Test FAQ User" -m -g guest testuser</strong>
d707 1
a707 1
$ <strong>ls -la /home</strong>
d713 1
a713 1
$ <strong>id testuser</strong>
d715 1
a715 1
$ <strong>finger testuser</strong>
d729 1
a729 1
$ <strong>userinfo testuser</strong>
d750 2
a751 3
# <strong>userdel -r testuser</strong>
</pre>
</blockquote>
d818 1
a818 1
# <strong>edquota ericj</strong>
d846 1
a846 1
peuvent être configurées à l'aide de l'option <strong>-t</strong> de edquota(8).
d857 1
a857 1
# <strong>quotaon -a</strong>
d872 1
a872 1
# <Strong>quota ericj</strong>
d889 1
a889 1
# <strong>quotaoff -a</strong>
d904 1
a904 1
<pre>
d906 1
a906 1
</pre>
d921 8
a928 7
La première étape consiste à créer un compte "ftp" sur votre système. Ce
compte ne doit pas avoir de mot de passe utilisable. Dans cet exemple,
nous allons considérer que /home/ftp est le répertoire correspondant au
compte "ftp" mais vous n'êtes pas obligé de choisir la même chose. Quand
le mode anonyme est utilisé, le démon ftp va se confiner au répertoire
HOME de l'utilisateur 'ftp' (dans notre cas, ce répertoire est
/home/ftp). Pour en savoir plus, lisez les pages du manuel
d937 2
a938 1
l'utilisateur ftp. Il ne permettra pas de connexion en login à ce compte
d940 1
a940 4
opération, il suffit de faire <i>echo /usr/bin/false &gt;&gt;
/etc/shells</i>. Si en plus vous souhaitez que ce shell apparaisse dans
la liste des choix proposés par adduser, vous devez modifier le fichier
<i>/etc/adduser.conf</i>.
d943 7
a949 1
# <strong>adduser</strong>
d1051 6
a1056 6
Vous pouvez choisir d'exécuter ftpd soit à partir de inetd soit
directement de le lancer directement via les scripts rc. L'exemple
ci-après représente le cas où le service est démarré à partir de
<a href="http://www.openbsd.org/cgi-bin/cvsweb/src/etc/inetd.conf">inetd.conf</a>. 
Tout d'abord, nous devons nous familiariser avec quelques options de
ftpd. La ligne par défaut dans <i>/etc/inetd.conf</i> est :
d1059 1
a1059 1
<strong>ftp             stream  tcp     nowait  root    /usr/libexec/ftpd       ftpd -US</strong>
d1074 1
a1074 1
<strong>
d1076 1
a1076 1
</strong> 
d1080 1
a1080 1
Remarque - Les personnes gérant des serveurs ftp à HAUT trafic ne
d1083 2
a1084 2
et à démarrer ftpd à partir de rc.conf avec l'option <i>-D</i>. Ce qui
va démarrer ftpd en tant que démon. Ce mode de fonctionnement est
d1086 1
a1086 1
ligne correspondant à ftpd dans rc.conf ressemblerait à :
d1175 2
a1176 1
<li><b>Mettez à jour votre système en <i>-current</i>.</b>
d1282 1
a1282 2
</pre>
</blockquote>
d1425 1
a1425 1
<pre>
d1427 1
a1427 1
</pre> 
d1462 3
a1464 3
d'accès aux pages web disponible dans l'arborescence des
<a href="../faq15.html#Ports">ports</a>. Bien qu'il soit un programme
très efficace, wwwcount ne sait rien d'Apache chroot(2)é et ne
d1469 1
a1469 2
Tout d'abord, nous installons un
<a href="../faq15.html#PkgMgmt">paquetage</a> pour
d1478 2
a1479 1
<pre>
d1483 1
a1483 1
</pre>
d1492 1
a1492 1
<pre>
d1496 1
a1496 1
</pre>
d1504 2
a1505 1
<pre>
d1513 1
a1513 1
</pre>
d1517 1
a1517 1
<pre>
d1521 1
a1521 1
</pre>
d1540 1
a1540 1
<pre>
d1544 1
a1544 1
</pre>
d1553 2
a1554 1
<pre>
d1557 1
a1557 1
</pre>
d1561 1
a1561 1
Dans cet exemple, le programme était simple et malgré ça, nous avons
d1691 2
a1692 2
Originally [OpenBSD: faq10.html,v 1.125 ]<br>
$Translation: faq10.html,v 1.52 2006/06/26 12:40:13 ajacoutot Exp $<br>
@


1.46
log
@sync with steelix translation CVS
@
text
@d1475 1
a1475 1
<a href="../faq15.html#PkgMgmt">package</a> pour
d1538 1
a1538 1
données. Vu que nous avons installé le programme à partir d'un package,
d1626 1
a1626 1
<a href="../faq15.html#PkgMgmt">packages</a> ou soit via les
d1695 1
a1695 1
$Translation: faq10.html,v 1.51 2006/05/22 20:30:24 aanriot Exp $<br>
@


1.45
log
@sync with steelix translation CVS
@
text
@d143 1
a143 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=init&amp;sektion=8">init(8)</a> 
d161 1
a161 3
  <li>Les systèmes de fichiers sont vérifiés. Cette vérification n'aura
      pas lieu si le fichier /etc/fastboot existe. Ce n'est certainement
      pas une bonne idée.
d586 1
a586 1
Shell:i      /bin/ksh
d938 1
a938 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&amp;sektion=8">ftp(8)</a> 
d1694 2
a1695 2
Originally [OpenBSD: faq10.html,v 1.123 ]<br>
$Translation: faq10.html,v 1.50 2006/04/25 13:32:42 ajacoutot Exp $<br>
@


1.44
log
@sync with steelix translation CVS
@
text
@d410 1
a410 1
OpenBSD est fourni avec des librairies RSA et un service httpd
d510 1
a510 1
Pour un accès plus rapide aux données, les appels à la librairie qui
d1209 1
a1209 1
sources si le problème est localisé au niveau d'une librairie.</ul>
d1346 1
a1346 1
à une librairie sujette à correction.
d1448 1
a1448 1
    Ils auront certainement besoin de programmes ou de librairies se
d1450 1
a1450 1
    étant compilés statiquement (n'ayant pas besoin de librairies se
d1507 1
a1507 1
librairies et d'autres fichiers qu'il ne peut accéder une fois dans le
d1595 1
a1595 1
shells liés dynamiquement ne seront pas capable d'accéder aux librairies
d1697 1
a1697 1
$Translation: faq10.html,v 1.49 2006/04/16 20:51:33 saad Exp $<br>
@


1.43
log
@sync with steelix translation CVS
@
text
@d37 2
a38 1
  <li><a href="#SendmailDNS"   >10.6 - Pourquoi Sendmail ignore-t-il /etc/hosts ?</a>
d1696 2
a1697 2
Originally [OpenBSD: faq10.html,v 1.122 ]<br>
$Translation: faq10.html,v 1.48 2006/04/06 12:52:26 ajacoutot Exp $<br>
@


1.42
log
@sync with Steelix CVS
@
text
@d22 2
a23 1
<a href= "faq11.html">[Section 11 - Optimisation des Performances]</a>
d1685 2
a1686 1
<a href= "faq11.html">[Section 11 - Optimisation des Performances]</a>
d1695 2
a1696 2
Originally [OpenBSD: faq10.html,v 1.121 ]<br>
$Translation: faq10.html,v 1.47 2006/03/30 18:36:52 saad Exp $<br>
@


1.41
log
@sync with Steelix CVS
@
text
@d569 1
a569 1
Uid [1002]: <b><i>Enter</i></b>
d574 1
a574 1
[default]: <b><i>Enter</i></b>
d967 2
a968 2
Uid [1002]: <b><i>Enter</i></b>
Login group ftp [ftp]: <b><i>Enter</i></b>
d972 2
a973 2
[default]: <b><i>Enter</i></b>
Enter password []: <b><i>Enter</i></b>
d1694 1
a1694 1
$Translation: faq10.html,v 1.46 2006/03/09 07:54:16 ajacoutot Exp $<br>
@


1.40
log
@sync with Steelix CVS
@
text
@d11 1
a11 1
<meta name= "copyright"     content= "This document copyright 1998-2005 by OpenBSD.">
d1693 2
a1694 2
Originally [OpenBSD: faq10.html,v 1.120 ]<br>
$Translation: faq10.html,v 1.45 2006/02/24 10:58:15 ajacoutot Exp $<br>
@


1.39
log
@sync with Steelix CVS
@
text
@d61 1
a61 1
<kbd>"</kbd><kbd>wheel"</kbd> à la main. Ceci est fait pour des raisons
d67 2
a68 2
pour devenir root. Les utilisateurs n'appartenant pas à ce groupe
ne peuvent pas utiliser su(1). Voici un exemple d'une entrée
d412 2
a413 2
<i>/etc/ssl/private/</i>. Les étapes décrites ici sont en partie prises
de la page de manuel
d535 4
d544 1
a544 5
Ce script est paramétrable à travers le fichier
<i>/etc/adduser.conf</i>. Bien que c'est la méthode
recommandée pour créer des comptes utilisateurs, il est
toujours possible de les créer à la main en utilisant
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>. 
d822 1
a822 1
Une utilisation simple est <strong>edquota&nbsp;&lt;user&gt;</strong>.
d856 1
a856 1
peuvent être configurées à l'aide de l'option <b>-t </b> de edquota(8).
d876 1
a876 1
Ainsi, la commande <strong>quota &lt;user&gt;</strong> fournit les
d1207 1
a1207 1
sources si le problème est localisé au niveau d'une librairie.
a1214 1
</ul>
d1249 1
a1249 1
<a href="../../fr/ftp.html">serveurs FTP</a>.
d1289 5
d1363 1
d1373 1
d1390 2
d1694 1
a1694 1
$Translation: faq10.html,v 1.44 2005/11/24 23:16:39 saad Exp $<br>
@


1.38
log
@sync with Steelix CVS
@
text
@d1460 1
a1460 1
<a href="faq8.html#Ports">ports</a>. Bien qu'il soit un programme
d1467 1
a1467 1
<a href="faq8.html#Packages">package</a> pour
d1618 2
a1619 2
<a href="faq8.html#Ports">ports</a> ou soit via les
<a href="faq8.html#Packages">packages</a>.
d1685 2
a1686 2
Originally [OpenBSD: faq10.html,v 1.119 ]<br>
$Translation: faq10.html,v 1.43 2005/11/03 11:20:16 saad Exp $<br>
@


1.37
log
@sync with Steelix CVS
@
text
@d47 2
a48 1
  <li><a href="#rootshell"     >10.17 - Je n'aime pas le shell root standard !</a>
d1418 1
a1418 1
    possibilité d'ouvrir les fichiers de log en	ecriture une fois que ses
d1579 1
a1579 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=csh&amp;sektion=1">ksh</a>.
d1685 2
a1686 2
Originally [OpenBSD: faq10.html,v 1.117 ]<br>
$Translation: faq10.html,v 1.42 2005/11/01 23:55:31 saad Exp $<br>
@


1.36
log
@sync with Steelix CVS
@
text
@d1572 3
a1574 1
<h2>10.17 - Je n'aime pas le shell root standard !</h2>
d1576 1
d1578 1
a1578 29
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=csh&amp;sektion=1">csh</a>,
dû principalement à la tradition. Il n'est pas spécialement requis
qu'OpenBSD ait csh(1) comme shell pour l'utilisateur root (lisez
néanmoins avant de le changer).

<p>
Certains utilisateurs venant d'un système d'exploitation "Unix-like"
trouvent csh(1) peu familier et demande dès lors si ils peuvent le
changer et comment. Il y a plusieurs options :

<ul>
<li><b>Ne vous authentifiez pas directement en tant que <i>root</i></b>
    Entre
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=su&amp;sektion=1">su</a> 
    et
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sudo&amp;sektion=8">sudo</a>, 
    il ne devrait y avoir que peu de raisons pour que les utilisateurs
    s'authentifient en tant que <i>root</i> pour la plupart des
    applications après l'installation initiale.

<li><b>Invoquez votre shell favori après le login :</b> Si vous aimez
    ksh(1) ou n'importe quel autre shell, invoquez le simplement depuis
    votre shell par défaut.
<li><b>Changez le shell de l'utilisateur root :</b> Ceci peut être fait
    en utilisant
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=chsh&amp;sektion=1">chsh</a>
    ou
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw</a>.
</ul>
d1580 1
a1587 1

a1596 7
<p>
Il est parfois dit qu'il ne faut pas changer le shell de l'utilisateur
root, bien qu'il n'y ait aucune raison de ne pas le faire sous OpenBSD.
Mais encore une fois, ceci ne devrait pas être une raison -- ne vous
authentifiez pas directement en tant que root.
En fait, le shell par défaut est désormais ksh dans OpenBSD-current.

d1684 2
a1685 2
Originally [OpenBSD: faq10.html,v 1.116 ]<br>
$Translation: faq10.html,v 1.41 2005/08/22 16:18:20 aanriot Exp $<br>
@


1.35
log
@sync with Steelix CVS
@
text
@d1416 4
a1419 3
    désormais plus possible, étant donné qu'httpd(8) n'a plus la
    possibilité d'ouvrir ses propres fichiers log une fois que ses
    privilèges ont baissés. httpd(8) doit donc être stoppé et relancé :
d1501 2
a1502 2
# cd /var/www/cgi-bin/
# ldd Count.cgi
d1513 3
a1515 3
    # mkdir -p /var/www/usr/lib /var/www/usr/libexec
    # cp /usr/lib/libc.so.30.3 /var/www/usr/lib
    # cp /usr/libexec/ld.so /var/www/usr/libexec
d1536 3
a1538 3
    # mkdir -p /var/www/var/www          
    # cd /var/www/var/www
    # ln -s ../../wwwcount wwwcount
d1549 2
a1550 1
    # tar cf - /usr/local/lib/wwwcount | (cd /var/www; tar xpf - )
d1716 2
a1717 2
Originally [OpenBSD: faq10.html,v 1.115 ]<br>
$Translation: faq10.html,v 1.40 2005/06/13 12:57:53 saad Exp $<br>
@


1.34
log
@sync with Steelix CVS
@
text
@d268 1
a268 1
# <strong>cat /etc/mail/sendmail.cf | grep relay-domains</strong>
d1714 2
a1715 2
Originally [OpenBSD: faq10.html,v 1.114 ]<br>
$Translation: faq10.html,v 1.39 2005/05/24 12:26:25 saad Exp $<br>
@


1.33
log
@sync with Steelix CVS
@
text
@d1569 1
a1569 1
<!-- XXXversion root shell is now ksh -->
d1714 2
a1715 2
Originally [OpenBSD: faq10.html,v 1.113 ]<br>
$Translation: faq10.html,v 1.38 2005/05/20 17:54:23 saad Exp $<br>
@


1.32
log
@sync with Steelix CVS
@
text
@d1569 1
d1571 1
d1592 1
d1610 1
d1625 1
d1655 4
a1658 4
<pre>
   export PS1='$PWD $ '
</pre>
 
d1661 4
a1664 4
<pre>
   /home/nick $
</pre>

d1670 31
d1714 2
a1715 2
Originally [OpenBSD: faq10.html,v 1.112 ]<br>
$Translation: faq10.html,v 1.37 2005/02/13 16:53:12 saad Exp $<br>
@


1.31
log
@sync with Steelix CVS
@
text
@d11 1
a11 1
<meta name= "copyright"     content= "This document copyright 1998-2004 by OpenBSD.">
d1678 2
a1679 2
Originally [OpenBSD: faq10.html,v 1.111 ]<br>
$Translation: faq10.html,v 1.36 2005/01/24 21:46:21 saad Exp $<br>
@


1.30
log
@sync with Steelix CVS
@
text
@d1151 1
a1151 1
Certaines fois, les bogues causent des problèmes de fiabilité (par exemple,
d1153 3
a1155 3
correctement). D'autres fois, ces bogues causent des problèmes de
sécurité (qui peuvent permettre à d'autres personnes d'utiliser votre
machine de façon innatendue).
d1158 2
a1159 1
sera ensuite propagé vers les versions maintenues d'OpenBSD.
d1165 1
a1165 1
applicables uniquement à une plate-forme donnée.
d1171 3
a1173 2
réglés très rapidement sur les systèmes impactés (ce qui, dans la
plupart des cas, ne concernent pas TOUTES les applications).
d1227 4
a1230 3
téléchargé les arborescences du code source correspondant à ce snapshot,
il se peut que si vous essayer d'appliquer un des correctifs publiés, ça
ne marche pas à cause d'une modification du code source.
d1249 1
a1249 1
<a href="../../fr/ftp.html">serveurs ftp</a>.
d1351 1
a1351 1
Soyez conscient de ce mode de fonctionnement si vous choisissez la
d1678 2
a1679 2
Originally [OpenBSD: faq10.html,v 1.110 ]<br>
$Translation: faq10.html,v 1.35 2005/01/23 21:37:04 saad Exp $<br>
@


1.29
log
@sync with Steelix CVS
@
text
@d1163 2
a1164 2
href="../plat.html">plates-formes</a>, et en correctifs applicables
uniquement à une plate-forme donnée.
d1273 2
a1274 2
--- sys/scsi/st.c	1 Aug 2004 23:01:06 -0000	1.41
+++ sys/scsi/st.c	2 Nov 2004 01:05:50 -0000	1.41.2.1
d1276 2
a1277 2
 	u_int8_t skey = sense->flags &amp; SSD_KEY;
 	int32_t info;
d1279 4
a1282 4
-	if (((sense-&gt;flags & SDEV_OPEN) == 0) ||
+	if (((sc_link-&gt;flags & SDEV_OPEN) == 0) ||
 	    (serr != 0x70 && serr != 0x71))
 		return (EJUSTRETURN); /* let the generic code handle it */
d1676 1
a1676 1
$Translation: faq10.html,v 1.34 2005/01/21 00:38:40 saad Exp $<br>
@


1.28
log
@Sync with Steelix CVS
@
text
@d1150 11
a1160 3
Le code source de OpenBSD est en constante évolution et amélioration. En
même temps, des correctifs aux problèmes les plus communs sont crées et
diffusés au public. Ces correctifs apparaissent sur la
d1162 3
a1164 3
en catégories. Ces catégories correspondent à des correctifs qui
concernent différentes architectures ou à des correctifs indépendants de
l'architecture.
d1170 2
a1171 2
réglés très rapidement, bien que le choix final revienne à
l'administrateur.
d1174 39
a1212 4
Comme exemple, nous allons appliquer un correctif de sécurité obtenu à
partir de la
<a href="../../fr/errata.html">page web des errata</a> à
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=talkd&amp;sektion=8">talkd(8)</a>.
d1214 2
a1215 2
<h3>Quelle est la différence entre ces correctifs et ce qui se trouve
    dans l'arborescence CVS ? </h3>
d1220 10
a1229 3
la dernière version diffusée. Les autres correctifs qui concernent
l'arborescence actuelle de CVS peuvent contenir certaines modifications
qui ne sont peut-être pas désirables sur la version de production.
d1231 1
a1231 2
<h3>Préparer le système pour l'application des
    correctifs</h3>
d1234 2
a1235 1
Les correctifs d'OpenBSD sont distribués sous la forme de fichiers diff.
d1240 20
a1259 53
<b>RELEASE </b>d'OpenBSD. Cela ne veut pas dire que vous avez besoin de
tout le code source du système d'exploitation OpenBSD pour appliquer les
correctifs à votre système. Mais vous devez avoir le code source
correspondant au composant à corriger. Par exemple, si vous corrigez le
noyau vous devez avoir tout le code source au noyau.

<p>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cvs&amp;sektion=1">cvs(1)</a> 
est un outil très pratique pour télécharger uniquement les sources dont
vous avez besoin en utilisant des serveurs cvs anonymes situés un peu
partout dans le monde. Vous pouvez avoir une liste des serveurs
disponibles dans la
<a href="../../fr/anoncvs.html">page CVS Anonyme</a>.

<p>
Pour télécharger le code source de talkd(8) correspondant
à la version <i>3.6-release</i> via
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cvs&amp;sektion=1">cvs(1)</a>, 
vous utiliseriez les lignes de commande suivantes :

<div style="margin-left: 2em">
<pre>
$ <b>export CVSROOT=anoncvs@@anoncvs5.usa.openbsd.org:/cvs</b>
$ <b>cvs co -rOPENBSD_3_6_BASE src/libexec/talkd/</b>
cvs server: Updating src/libexec/talkd
U src/libexec/talkd/announce.c
U src/libexec/talkd/talkd.c
U src/libexec/talkd/talkd.h
</pre>
</div>

<p>
Pour connaître le chemin CVS du code dont vous avez besoin,
reportez-vous à la ligne <i>Index:</i>. Dans notre cas, le chemin CVS
est <i>src/libexec/talkd/</i>. Il faut toujours vérifier la révision de
OPENBSD_version_number_BASE. Sans "_BASE", vous obtiendrez le code
correspondant à la branche stable qui contient probablement d'autres
modifications qui peuvent interférer avec la procédure d'application des
correctifs. Si vous synchroniser vos sources par rapport à la branche
stable, les correctifs sont normalement déjà inclus dans le code source.
Cependant, nous vous conseillons de toujours effectuer une vérification.
Vous pouvez voir dans la page consacrée aux

<a href="../../plus.html">changements dans OpenBSD-current</a> les
correctifs qui ont été appliqués à la branche stable. Si les correctifs
n'ont pas encore été appliqués, vous devez télécharger les sources de la
dernière RELEASE en utilisant les commandes précédentes.

<p>
Pour les utilisateurs ayant acheté des CDs OpenBSD officiels, vous
pouvez obtenir le code source directement à partir du CD. Reportez vous
à l'encart livré avec votre CD. Vous n'aurez à ce moment-là besoin
d'obtenir les sources via anoncvs.
d1262 1
d1264 1
a1264 4
        cd /usr/src
        patch -p0 &lt; 026_talkd.patch
        cd libexec/talkd
        make obj &amp;&amp; make depend &amp;&amp; make &amp;&amp; make install
d1266 2
a1267 1
Index: libexec/talkd/announce.c <b>&lt;------ Chemin CVS</b>
d1269 14
a1282 14
RCS file: /cvs/src/libexec/talkd/announce.c,v
retrieving revision 1.8
retrieving revision 1.9
diff -u -r1.8 -r1.9
--- libexec/talkd/announce.c    1998/08/18 03:42:10     1.8
+++ libexec/talkd/announce.c    2000/07/06 00:01:45     1.9
@@@@ -160,6 +160,6 @@@@
                *(bptr++) = '\n';
        }
        *bptr = '\0';
-       fprintf(tf, big_buf);
+       fprintf(tf, "%s", big_buf);
        fflush(tf);
 }
d1286 3
a1288 11
<p>
Une fois que vous avez obtenu les sources, vous pouvez télécharger le
correctif que vous mettrez sous <i>src/</i>

<h3>Application des correctifs</h3>

<p>
<div style="margin-left: 2em">
<pre>
$ <b>cd /usr/src</b>
$ <b>patch -p0&lt;/path/to/026_talkd.patch</b>
d1293 4
a1296 4
|       cd /usr/src
|       patch -p0 &lt; 026_talkd.patch
|       cd libexec/talkd
|       make obj &amp;&amp; make depend &amp;&amp; make &amp;&amp; make install
d1298 1
a1298 1
|Index: libexec/talkd/announce.c
d1300 6
a1305 6
|RCS file: /cvs/src/libexec/talkd/announce.c,v
|retrieving revision 1.8
|retrieving revision 1.9
|diff -u -r1.8 -r1.9
|--- libexec/talkd/announce.c   1998/08/18 03:42:10     1.8
|+++ libexec/talkd/announce.c   2000/07/06 00:01:45     1.9
d1307 3
a1309 2
Patching file libexec/talkd/announce.c using Plan A...
Hunk #1 succeeded at 160. <b>&lt;------------ Patch Succeeded</b>
d1311 1
a1311 28
$ <b>cd /usr/src/libexec/talkd/</b>
$ <b>ls</b>
CVS             announce.c      print.c         table.c         talkd.c
Makefile        announce.c.orig process.c       talkd.8         talkd.h
$ <b>make obj &amp;&amp; make depend &amp;&amp; make</b>
making /home/ericj/lsrc/src/libexec/talkd/obj
mkdep -a /home/ericj/lsrc/src/libexec/talkd/talkd.c /home/ericj/lsrc/sr
c/libexec/talkd/announce.c /home/ericj/lsrc/src/libexec/talkd/process.c
/home/ericj/lsrc/src/libexec/talkd/table.c /home/ericj/lsrc/src/libexec
/talkd/print.c
cc -O2     -c /home/ericj/lsrc/src/libexec/talkd/talkd.c
cc -O2     -c /home/ericj/lsrc/src/libexec/talkd/announce.c
cc -O2     -c /home/ericj/lsrc/src/libexec/talkd/process.c
cc -O2     -c /home/ericj/lsrc/src/libexec/talkd/table.c
cc -O2     -c /home/ericj/lsrc/src/libexec/talkd/print.c
cc   -o ntalkd talkd.o announce.o process.o table.o print.o
nroff -Tascii -mandoc /home/ericj/lsrc/src/libexec/talkd/talkd.8 &gt; talk
d.cat8
$ <b>sudo make install</b>
install -c -s -o root -g bin  -m 555 ntalkd /usr/libexec
install -c -o root -g bin -m 444 talkd.cat8 /usr/share/man/cat8/talkd.0
/usr/share/man/cat8/ntalkd.0 -&gt; /usr/share/man/cat8/talkd.0
</pre>
</div>

<p>
Une fois cette opération effectuée, redémarrez le
service.
d1313 38
d1675 2
a1676 2
Originally [OpenBSD: faq10.html,v 1.109 ]<br>
$Translation: faq10.html,v 1.33 2005/01/17 21:31:58 aanriot Exp $<br>
@


1.27
log
@sync with Steelix CVS
@
text
@d1654 1
d1656 2
a1657 1
$Translation: faq10.html,v 1.32 2004/12/06 06:33:10 saad Exp $<br>
@


1.26
log
@sync with Steelix CVS
@
text
@d493 1
a493 1
     /etc/passwd         fichier de mots de passe au format Version 7
d1654 2
a1655 2
Originally [OpenBSD: faq10.html,v 1.108 ]<br>
$Translation: faq10.html,v 1.31 2004/11/03 14:24:36 saad Exp $<br>
@


1.25
log
@Sync with Steelix CVS
@
text
@d1435 1
a1435 1
<a href="../faq8.html#Ports">ports</a>. Bien qu'il soit un programme
d1442 1
a1442 1
<a href="../faq8.html#Packages">package</a> pour
d1655 1
a1655 1
$Translation: faq10.html,v 1.30 2004/10/31 21:41:49 saad Exp $<br>
@


1.24
log
@sync with Steelix CVS
@
text
@d1206 1
a1206 1
à la version <i>3.5-release</i> via
d1213 1
a1213 1
$ <b>cvs co -rOPENBSD_3_5_BASE src/libexec/talkd/</b>
d1654 2
a1655 2
Originally [OpenBSD: faq10.html,v 1.107 ]<br>
$Translation: faq10.html,v 1.29 2004/10/25 12:56:49 saad Exp $<br>
@


1.23
log
@sync with Steelix CVS
@
text
@d4 1
a4 1
<title>10 - Gestion du Syst&egrave;me</title>
d15 3
a17 1
<img alt="[OpenBSD]" height=30 width=141 src="../../images/smalltitle.gif"> 
d25 1
a25 1
<h1><font color="#e00000">10 - Gestion du Syst&egrave;me</font></h1> 
d29 1
a29 1
<h3>Table des mati&egrave;res</h3>
d31 5
a35 5
  <li><a href="#wheel"         >10.1 - Quand j'essaie de passer root &agrave; l'aide de su, on me dit que je suis dans le mauvais groupe.</a> 
  <li><a href="#DupFS"         >10.2 - Comment dupliquer un syst&egrave;me de fichiers ?</a> 
  <li><a href="#rc"            >10.3 - Comment d&eacute;marrer des services en m&ecirc;me temps que le syst&egrave;me ? (Vue d'ensemble de rc(8))</a> 
  <li><a href="#RelayingDenied">10.4 - Pourquoi les utilisateurs sont interdits de relais quand ils envoient des mails &agrave; distance &agrave; travers mon syst&egrave;me OpenBSD ?</a> 
  <li><a href="#POP"           >10.5 - J'ai mis en place POP, mais j'ai des erreurs quand j'acc&egrave;de &agrave; ma messagerie via POP. Que puis-je faire ?</a> 
d37 4
a40 4
  <li><a href="#HTTPS"         >10.7 - Configurer HTTP en mode s&eacute;curis&eacute; &agrave; l'aide de ssl(8)</a> 
  <li><a href="#vipw"          >10.8 - J'ai effectu&eacute; des changements dans /etc/passwd avec vi(1), mais les changements ne semblent pas &ecirc;tre pris en compte. Pourquoi ?</a> 
  <li><a href="#AddDelUser"    >10.9 - Comment je cr&eacute;e un compte utilisateur ? Ou je supprime un compte utilisateur ?</a> 
  <li><a href="#FTPOnly"       >10.10 - Comment puis-je cr&eacute;er un compte pour ftp uniquement ?</a> 
d44 1
a44 1
  <li><a href="#ftpchroot"     >10.14 - Confiner les utilisateurs &agrave; leur r&eacute;pertoire HOME avec ftpd(8)</a> 
d55 2
a56 2
<h2>10.1 - Quand j'essaie de passer root &agrave; l'aide de su, on me
       dit que je suis dans le mauvais groupe</h2>
d59 6
a64 8
Les utilisateurs existant sur le syst&egrave;me doivent &ecirc;tre
rajout&eacute;s au groupe <kbd>&quot;</kbd><kbd>wheel&quot;</kbd>
&agrave; la main. Ceci est fait pour des raisons de
s&eacute;curit&eacute;, et vous devriez apporter une attention toute
particuli&egrave;re lorsque vous donnez l'acc&egrave;s &agrave; ce
groupe &agrave; des utilisateurs. Sous OpenBSD, les utilisateurs
appartenant au groupe <kbd>wheel</kbd> sont autoris&eacute;s &agrave;
utiliser le programme
d66 2
a67 2
pour devenir root. Les utilisateurs n'appartenant pas &agrave; ce groupe
ne peuvent pas utiliser su(1). Voici un exemple d'une entr&eacute;e
d69 1
a69 1
dans le groupe <kbd>&quot;wheel&quot;</kbd>.
d72 4
a75 4
vous pouvez le mettre dans le groupe wheel en r&eacute;pondant wheel
&agrave; la question "<tt>Invite <i>user</i> into other groups:</tt>".
Ceci aura pour effet de rajouter l'entr&eacute;e correspondante dans
/etc/group qui ressemble &agrave; la ligne suivante :
d82 4
a85 3
Si vous cherchez un moyen pour limiter l'acc&egrave;s des utilisateurs
aux privil&egrave;ges du super utilisateur, sans pour autant les mettre
dans le groupe <kbd>&quot;wheel&quot;</kbd>, utilisez
d89 1
a89 1
<h2>10.2 - Comment dupliquer un syst&egrave;me de fichiers ?</h2>
d92 1
a92 1
Pour dupliquer votre syst&egrave;me de fichiers, utilisez 
d96 2
a97 2
Par exemple, pour dupliquer tout ce qu'il y a sous le r&eacute;pertoire
<kbd>SRC</kbd> vers le r&eacute;pertoire <kbd>DST</kbd>, faites un :
d103 3
a105 4
dump est con&ccedil;u pour vous fournir beaucoup de possibilit&eacute;s
de sauvegarde, et c'est peut-&ecirc;tre trop si vous voulez juste
dupliquer une partie d'un syst&egrave;me de fichiers (entier). La
commande
d107 2
a108 2
peut &ecirc;tre plus rapide pour ce genre d'op&eacute;ration. Le format
est tr&egrave;s similaire &agrave; celui de dump :
d116 2
a117 2
<h2>10.3 - Comment d&eacute;marrer des services en m&ecirc;me temps que
       le syst&egrave;me ? (Vue d'ensemble de rc(8))</h2>
d120 3
a122 4
OpenBSD utilise un d&eacute;marrage de type 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc&amp;sektion=8">rc(8)</a>
. Il utilise seulement quelques fichiers cl&eacute;s pour le
  d&eacute;marrage.
d124 16
a139 19
  <li>/etc/rc - Script principal. Ne doit pas &ecirc;tre
       &eacute;dit&eacute;.
  <li>/etc/rc.conf - Fichier de configuration utilis&eacute; par
       <i>/etc/rc </i>pour savoir quels services doivent &ecirc;tre
       d&eacute;marr&eacute;s en m&ecirc;me temps que le syst&egrave;me
  <li>/etc/rc.conf.local - Fichier de configuration servant &agrave;
       compl&eacute;ter /etc/rc.conf, ainsi vous ne devez pas toucher
       &agrave; /etc/rc.conf, ce qui est commode pour ceux qui
       (re)mettent souvent &agrave; jour leur syst&egrave;me.
  <li>/etc/netstart - Script pour initialiser le r&eacute;seau. Ne
       devrait pas &ecirc;tre &eacute;dit&eacute;.
  <li>/etc/rc.local - Script utilis&eacute; pour l'administration
       locale. C'est l&agrave; o&ugrave; les informations relatives
       &agrave; de nouveaux services ou des informations
       sp&eacute;cifiques &agrave; l'h&ocirc;te doivent &ecirc;tre
       stock&eacute;es.
  <li>/etc/rc.securelevel - Script utilis&eacute; pour ex&eacute;cuter
       des commandes qui doivent &ecirc;tre ex&eacute;cut&eacute;es
       avant que le niveau de s&eacute;curit&eacute; ne change. Voir
d141 3
a143 4
  <li>/etc/rc.shutdown - Script ex&eacute;cut&eacute; lors de
       l'arr&ecirc;t de la machine. Mettez tout ce que vous voulez
       ex&eacute;cuter avant l'arr&ecirc;t de la machine dans ce
       fichier. Voir
d151 3
a153 4
et <i>/etc/rc.shutdown</i> sont les principaux fichiers &agrave;
conna&icirc;tre par l'administrateur syst&egrave;me. Pour comprendre le
fonctionnement de la proc&eacute;dure rc(8), en voici le
d&eacute;roulement :
d156 1
a156 1
<i>/etc/rc </i>est appel&eacute; apr&egrave;s le d&eacute;marrage du noyau :
d158 4
a161 4
  <li>Les syst&egrave;mes de fichiers sont v&eacute;rifi&eacute;s. Cette
      v&eacute;rification n'aura pas lieu si le fichier /etc/fastboot
      existe. Ce n'est certainement pas une bonne id&eacute;e.
  <li>Les variables de configuration sont lues &agrave; partir de
d163 1
a163 1
      param&egrave;tres dans rc.local.conf vont surpasser ceux se
d165 3
a167 5
  <li>Les syst&egrave;mes de fichiers sont mont&eacute;s
  <li><i>/tmp </i>est nettoy&eacute; et les fichiers d'&eacute;diteurs
          sont pr&eacute;serv&eacute;s
  <li>Le r&eacute;seau est configur&eacute; &agrave; l'aide de
      <i>/etc/netstart</i>
d169 6
a174 7
      <li>Les interfaces r&eacute;seau sont mont&eacute;es.
      <li>Le nom d'h&ocirc;te et le nom de domaine (ainsi que d'autres
          param&egrave;tres) sont positionn&eacute;s </ul>
  <li>Les services syst&egrave;me sont d&eacute;marr&eacute;s
  <li>Diverses v&eacute;rifications sont effectu&eacute;es (quota,
      savecore, etc).
  <li>Les services locaux sont d&eacute;marr&eacute;s &agrave; partir de
d178 1
a178 1
<h3>D&eacute;marrage des services fournis avec OpenBSD</h3>
d181 3
a183 4
La plupart des services fournis par d&eacute;faut avec OpenBSD sont
lanc&eacute;s au d&eacute;marrage simplement en modifiant le fichier de
configuration <i>/etc/rc.conf</i>. Pour commencer, jetez un coup d'oeil
au fichier
d185 1
a185 2
par d&eacute;faut. Vous verrez des lignes similaires &agrave; la ligne
suivante :
d192 10
a201 10
Une ligne telle que celle-ci montre que ftpd n'est pas lanc&eacute; au
d&eacute;marrage du syst&egrave;me (du moins pas &agrave; travers rc(8),
lisez la <a href="faq10.html#AnonFTP">FAQ Serveur FTP Anonyme</a> pour
plus d'informations). Dans tous les cas, chaque ligne est dot&eacute;e
d'un commentaire qui vous montrent les drapeaux utilis&eacute;s dans le
cadre d'une utilisation <b>NORMALE </b>du service. Cela ne veut pas dire
que vous devez appeler ce service avec ces m&ecirc;mes drapeaux. Vous
pouvez toujours utiliser man(1) pour savoir comment d&eacute;marrer un
service donn&eacute; de la mani&egrave;re que vous souhaitez. Par
exemple, voici la ligne par d&eacute;faut concernant httpd(8) :
d207 4
a210 5
D'apr&egrave;s cet exemple, vous pouvez voir qu'aucun drapeau n'est
n&eacute;cessaire pour d&eacute;marrer httpd normalement. Ainsi, la
ligne &quot;<b> httpd_flags=""</b> suffit. Mais pour d&eacute;marrer
httpd avec le support ssl (Reportez vous &agrave; la <a
href="#HTTPS">FAQ SSL</a> ou &agrave;
d212 2
a213 2
), vous devez d&eacute;marrer httpd avec une ligne comme celle-ci :
&quot;httpd_flags="-DSSL"&quot;.
d216 6
a221 6
Une autre approche serait de ne jamais toucher &agrave;
<i>/etc/rc.conf</i>. Au contraire, cr&eacute;ez le fichier
<i>/etc/rc.conf.local</i> et ne copiez que les lignes que vous comptez
changer dans <i>/etc/rc.conf</i> et modifiez-les comme vous voulez. Ceci
peut rendre vos mises &agrave; jour futures plus faciles -- tous les
changements se trouvant dans un fichier.
d223 1
a223 1
<h3>D&eacute;marrage et configuration des services locaux</h3>
d227 2
a228 2
d'autres m&eacute;thodes, vous devez utiliser le fichier
<i>/etc/rc.local</i>. Par exemple, j'ai install&eacute; un service
d230 2
a231 2
service soit lanc&eacute; au d&eacute;marrage. Pour cela, je rajoute les
lignes suivantes dans <i>/etc/rc.local</i> :
d240 2
a241 3
(Si le service ne se d&eacute;tache pas automatiquement lors de son
d&eacute;marrage, souvenez-vous de rajouter "&amp;" &agrave; la fin de
la commande.)
d244 3
a246 3
A partir de l&agrave;, ce service sera lanc&eacute; au d&eacute;marrage.
Vous pourrez voir toutes les erreurs au d&eacute;marrage. Un
d&eacute;marrage normal sans erreurs affichera le message suivant :
d254 4
a257 6
<i>/etc/rc.shutdown</i> est un script ex&eacute;cut&eacute; &agrave;
l'arr&ecirc;t de la machine. Toutes les t&acirc;ches &agrave; effectuer
avant l'arr&ecirc;t du syst&egrave;me devront &ecirc;tre ajout&eacute;es
&agrave; ce fichier. Si vous avez apm, vous pouvez aussi positionner
&quot;powerdown=YES&quot;. C'est l'&eacute;quivalent de &quot;shutdown
-p&quot;.
d262 1
a262 2
       envoient des mails &agrave; distance &agrave; travers mon
       syst&egrave;me OpenBSD ?</h2>
d272 1
a272 1
Le r&eacute;sultat ressemblerait &agrave; la ligne suivante :
d279 2
a280 3
Si ce fichier n'existe pas, cr&eacute;ez le. Vous devez saisir les
h&ocirc;tes qui envoient des messages &agrave; distance en respectant la
syntaxe suivante :
d289 1
a289 1
N'oubliez pas d'envoyer un signal 'HangUP' &agrave; sendmail (signal qui
d310 1
a310 2
       j'acc&egrave;de &agrave; ma messagerie via POP. Que puis-je faire
       ? </h2>
d313 3
a315 3
La plupart des probl&egrave;mes rencontr&eacute;s avec POP sont
li&eacute;s aux fichiers temporaires et aux fichiers verrous. Si votre
serveur POP renvoie une erreur du type :
d334 4
a337 5
V&eacute;rifiez aussi que l'utilisateur poss&egrave;de son propre
fichier /var/mail. Bien &eacute;videmment, ceci devrait &ecirc;tre le
cas (comme par exemple l'utilisateur joe qui poss&egrave;de
/var/mail/joe) mais si &ccedil;a n'a pas &eacute;t&eacute;
configur&eacute; proprement, le probl&egrave;me viendrait de l&agrave; !
d340 6
a345 7
Bien entendu, si vous donner l'acc&egrave;s &agrave; /var/mail en
&eacute;criture au groupe mail, vous allez probablement vous exposer
&agrave; des vagues et obscurs probl&egrave;mes de
s&eacute;curit&eacute;. Il se pourrait que &ccedil;a ne pose aucun
probl&egrave;me mais on ne sait jamais (et particuli&egrave;rement si
vous &ecirc;tes un site de haut vol, un FAI,...) ! Il existe plusieurs
services POP de la collection de ports OpenBSD. Si possible, utilisez
d347 6
a352 7
disponible dans le syst&egrave;me de base d'OpenBSD. Ou peut-&ecirc;tre
vous avez s&eacute;lectionn&eacute; les mauvaises options pour votre
programme POP serveur (comme le dot locking). Ou vous avez
peut-&ecirc;tre simplement besoin de changer le r&eacute;pertoire dans
lequel les verrous sont cr&eacute;es (bien que les op&eacute;rations de
verrouillage ne devraient &ecirc;tre b&eacute;n&eacute;fiques qu'au
service POP).
d355 3
a357 4
<b>PS:</b> Il est &agrave; noter que OpenBSD n'a pas de groupe
   &quot;mail&quot;. Vous devez en cr&eacute;er un, si
   n&eacute;cessaire, dans le fichier <i>/etc/group</i>. La ligne
   suivante devrait suffire :
d366 1
a366 1
       ?</h2>
d369 3
a371 3
Par d&eacute;faut, Sendmail utilise le DNS pour la r&eacute;solution de
nom, non le fichier <tt>/etc/hosts</tt>. Ce comportement peut &ecirc;tre
chang&eacute; par l'usage du fichier <tt>/etc/mail/service.switch</tt>.
d374 3
a376 3
Si vous d&eacute;sirez interroger le fichier d'h&ocirc;tes avant les
serveurs DNS, cr&eacute;ez un fichier <tt>/etc/mail/service.switch</tt>
contenant les lignes suivantes :
d383 2
a384 2
Si vous d&eacute;sirez interroger QUE le le fichier d'h&ocirc;tes,
utilisez ce qui suit :
d391 1
a391 1
Envoyez un signal HUP &agrave; Sendmail :
d403 2
a404 2
<h2>10.7 - Configurer HTTP en mode s&eacute;curis&eacute; &agrave;
       l'aide de SSL(8)</h2>
d410 3
a412 3
vous devez d'abord cr&eacute;er un certificat. Ce certificat sera
stock&eacute; dans <i>/etc/ssl/private/</i>. Les &eacute;tapes
d&eacute;crites ici sont en partie prises de la page de manuel
d414 4
a417 5
Lisez la pour plus d'informations. Cette partie de la FAQ
s'int&eacute;resse seulement &agrave; la g&eacute;n&eacute;ration d'un
certificat RSA pour les serveurs Web. Elle ne d&eacute;crit pas les
certificats serveur DSA. Pour plus d'informations &agrave; ce sujet,
lisez la page de manuel
d421 2
a422 2
Pour commencer, vous aurez besoin de cr&eacute;er votre cl&eacute;
serveur et le certificat en utilisant OpenSSL :
d431 2
a432 3
Ou si vous voulez que la cl&eacute; soit crypt&eacute;e avec un mot de
passe que vous devez saisir &agrave; chaque d&eacute;marrage des
serveurs
d441 4
a444 4
La prochaine &eacute;tape consiste &agrave; g&eacute;n&eacute;rer une
requ&ecirc;te de signature de certificat qui est utilis&eacute;e pour
permettre &agrave; une autorit&eacute; de certification (CA) de signer
votre certificat. Pour cela, utilisez la commande suivante :
d453 4
a456 5
Le fichier <i>server.csr</i> pourra alors &ecirc;tre communiqu&eacute;
&agrave; une autorit&eacute; de certification qui signera la cl&eacute;.
Une de ces autorit&eacute;s est <b>Thawte Certification</b> que vous
pourrez joindre &agrave; l'adresse 
<a href="http://www.thawte.com/">http://www.thawte.com/</a>. 
d471 1
a471 1
vous devez &ecirc;tre d&eacute;sormais capable de d&eacute;marrer
d473 3
a475 3
avec le drapeau <b>-DSSL</b> (consultez la <a href="#rc">section &agrave;
propos de rc(8) dans cette faq</a>), activant ainsi les transactions
https sur le port 443 de votre machine.
d479 3
a481 3
<h2>10.7 - J'ai effectu&eacute; des changements dans /etc/passwd avec
       vi(1), mais les changements ne semblent pas &ecirc;tre pris en
       compte. Pourquoi ?</h2>
d484 2
a485 3
Si vous &eacute;ditez <i>/etc/passwd</i>, vos modifications seront
perdues. OpenBSD g&eacute;n&egrave;re <i>/etc/passwd</i> dynamiquement
avec
d488 1
a488 1
<i>/etc/master.passwd</i>. D'apr&egrave;s pwd_mkdb(8),
d494 1
a494 1
     /etc/pwd.db         fichier non s&eacute;curis&eacute; de mots de passe au format base de donn&eacute;es
d496 1
a496 1
     /etc/spwd.db        fichier s&eacute;curis&eacute; de mots de passe au format base de donn&eacute;es
d502 18
a519 20
informations y compris le mot de passe crypt&eacute; de l'utilisateur
sont &agrave; la disposition de n'importe quel utilisateur du
syst&egrave;me (et c'est la cible principale de programmes tels que
Crack). 4.4BSD a introduit le fichier master.passwd qui a un format
&eacute;tendu (avec les options additionnelles par rapport &agrave;
/etc/passwd). Ce fichier n'est accessible que pour root. Pour un
acc&egrave;s plus rapide aux donn&eacute;es, les appels &agrave; la
librairie qui utilisent ce type d'informations acc&egrave;dent
normalement &agrave; /etc/pwd.db et &agrave; /etc/spwd.db.

<p>
OpenBSD met &agrave; votre disposition un outil qui vous permet
d'&eacute;diter le fichier de mots de passe. Cet outil s'appelle
vipw(8). vipw utilisera vi (ou votre &eacute;diteur favori tel que
d&eacute;fini par $EDITOR) pour &eacute;diter /etc/master.passwd. Suite
&agrave; vos modifications, vipw recr&eacute;era /etc/passwd,
/etc/pwd.db, et /etc/spwd.db qui tiendront compte de vos modifications.
vipw verrouille aussi l'acc&egrave;s &agrave; ces fichiers de telle
fa&ccedil;on &agrave; en interdire l'acc&egrave;s &agrave; quiconque
essaie d'en changer le contenu en m&ecirc;me temps que vous.
d523 2
a524 2
<h2>10.8 - Comment je cr&eacute;e un compte utilisateur ? Ou je supprime
       un compte utilisateur ?</h2>
d527 2
a528 2
OpenBSD offre deux commandes pour facilement cr&eacute;er des comptes
utilisateurs sur le syst&egrave; :
d536 2
a537 2
La mani&egrave;re la plus facile pour cr&eacute;er un compte utilisateur
sous OpenBSD est d'utiliser le script
d539 4
a542 4
Ce script est param&eacute;trable &agrave; travers le fichier
<i>/etc/adduser.conf</i>. Bien que c'est la m&eacute;thode
recommand&eacute;e pour cr&eacute;er des comptes utilisateurs, il est
toujours possible de les cr&eacute;er &agrave; la main en utilisant
d544 7
a550 8
adduser(8) permet d'effectuer des v&eacute;rifications sur la
coh&eacute;rence de <i>/etc/passwd</i>, <i>/etc/group</i>, et les bases
de donn&eacute;es shell. adduser(8) cr&eacute;e pour vous les
entr&eacute;es correspondantes et les r&eacute;pertoires $HOME. Il peut
aussi envoyer un message de bienvenue aux utilisateurs. Le comportement
de ce programme peut &ecirc;tre adapt&eacute; &agrave; vos besoins. Pour
illustrer notre propos, prenons comme exemple la cr&eacute;ation du
compte <b>testuser</b>. Le r&eacute;pertoire de cet utilisateur sera
d596 2
a597 2
Cette commande supprimera toute chose relative &agrave; l'utilisateur.
Elle supprimera son entr&eacute;e
d599 7
a605 7
son r&eacute;pertoire $HOME (s'il lui appartient), et son courrier. Bien
&eacute;videmment, cette commande supprimera aussi les entr&eacute;es
correspondantes dans <i>/etc/passwd</i> et <i>/etc/group</i>. Comme
exemple, nous allons utiliser cette commande pour supprimer le compte
utilisateur pr&eacute;c&eacute;demment cr&eacute;e. Notez que la
commande vous demande l'identifiant du compte et si oui ou non elle doit
supprimer le r&eacute;pertoire home de l'utilisateur.
d623 1
a623 1
<h3>Cr&eacute;er des comptes utilisateurs via user(8)</h3>
d631 1
a631 1
La liste compl&egrave;te des outils est :
d645 1
a645 1
<h4>Cr&eacute;ation effective des comptes utilisateurs</h4>
d648 12
a659 14
Etant donn&eacute; que la commande user(8) n'est pas interactive, la
mani&egrave;re la plus simple et la plus efficace pour cr&eacute;er des
comptes utilisateurs est d'utiliser la commande adduser(8). La commande
<i>/usr/sbin/user</i> est seulement une interface aux autres commandes
<i>/usr/sbin/user*</i>. Ainsi, dans l'exemple qui suit il est possible
d'utiliser soit <b>user add</b> soit <b>useradd</b>. Le choix est votre
et ne change rien au r&eacute;sultat. <p>Dans cet exemple, nous allons
cr&eacute;er un compte avec les m&ecirc;mes sp&eacute;cificit&eacute;s
que le compte cr&eacute;e
<a href="#adduser">pr&eacute;c&eacute;demment</a>. useradd(8) est bien
plus facile &agrave; utiliser si vous connaissez les param&egrave;tres
par d&eacute;faut avant de cr&eacute;er un compte utilisateur. Ces
param&egrave;tres se trouvent dans le fichier <i>/etc/usermgmt.conf
</i>et peuvent &ecirc;tre visualis&eacute;s comme suit :
d673 7
a679 9
Ces param&egrave;tres vont &ecirc;tre appliqu&eacute;s &agrave; chaque
nouveau compte si vous ne changez pas leur valeur en utilisant des
options en ligne de commande. Par exemple, dans notre cas nous voulons
que l'utilisateur appartienne au groupe <b>guest </b> et non pas
&agrave; <b>users</b>. Il est &agrave; noter que lors de la
cr&eacute;ation des comptes utilisateurs, les mots de passe doivent
&ecirc;tre sp&eacute;cifi&eacute;s sous leur forme crypt&eacute;e en
ligne de commande. Vous devez donc utiliser, au pr&eacute;alable,
l'utilitaire
d681 3
a683 4
pour cr&eacute;er le mot de passe. Par exemple : Les mots de passe par
d&eacute;faut sous OpenBSD utilisent l'algorithme Blowfish avec 6
r&eacute;it&eacute;rations. Voici un exemple d'utilisation de la
commande encrypt :
d692 2
a693 2
Maintenant que nous avons le mot de passe crypt&eacute;, nous sommes
pr&ecirc;ts &agrave; cr&eacute;er le compte utilisateur :
d701 7
a707 8
<b>Remarque :</b> Assurez vous d'utiliser &quot; pour englober le mot de
   passe. L'utilisation de &quot;&quot; ne permet pas d'emp&ecirc;cher
   le shell d'interpr&eacute;ter le jeu de caract&egrave;res
   correspondant au mot de passe avant de les communiquer &agrave;
   user(8). De m&ecirc;me, assurez vous d'utiliser l'option <b>-m </b>si
   vous voulez cr&eacute;er le r&eacute;pertoire $HOME de l'utilisateur
   et copier les fichiers &agrave; partir de <i>/etc/skel</i> vers
   $HOME.
d710 3
a712 4
Pour voir si le compte utilisateur a &eacute;t&eacute; correctement
cr&eacute;e, nous pouvons recourir &agrave; plusieurs utilitaires. Voici
quelques commandes pour v&eacute;rifier rapidement que tout s'est bien
pass&eacute; :
d732 3
a734 3
En plus de ces commandes, user(8) fournit son propre utilitaire,
appel&eacute; userinfo(8), qui permet d'afficher les
caract&eacute;ristiques d'un compte utilisateur :
d753 3
a755 4
Pour supprimer des comptes utilisateurs avec la hi&eacute;rarchie de
commandes user(8), vous devez utiliser userdel(8). Cette commande est
simple et efficace. Pour supprimer le compte pr&eacute;c&eacute;demment
cr&eacute;e, utilisez :
d763 4
a766 5
Notez bien l'option <b>-r</b> qui doit &ecirc;tre
sp&eacute;cifi&eacute;e si vous voulez supprimer les r&eacute;pertoires
$HOME aussi. Si vous voulez juste bloquer l'acc&egrave;s au compte sans
supprimer des informations li&eacute;es au compte, utilisez <b>-p</b> au
lieu de <b>-r</b>.
d770 2
a771 2
<h2>10.10 - Comment puis-je cr&eacute;er un compte pour ftp uniquement
       ?</h2>
d774 8
a781 18
Il y a plusieurs m&eacute;thodes pour effectuer cette op&eacute;ration.
Une des mani&egrave;res les plus communes est d'ajouter
<i>/usr/bin/false </i> dans le fichier <i>/etc/shells</i>. Et quand vous
cr&eacute;ez le compte utilisateur, attribuez lui le shell
/usr/bin/false. Il sera alors capable d'utiliser les
fonctionnalit&eacute;s ftp sans pour autant &ecirc;tre capable de se
connecter de mani&egrave;re interactive. Par d&eacute;faut,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=adduser&amp;sektion=8">adduser(8)</a> 
affecte &agrave; l'utilisateur le r&eacute;pertoire
<i>/home/&lt;user&gt;</i>. Si c'est ce que vous souhaitez, laissez-le
tel quel. Cependant, vous pouvez affecter &agrave; l'utilisateur le
r&eacute;pertoire que vous souhaitez. De m&ecirc;me, vous pouvez
confiner l'utilisateur &agrave; son r&eacute;pertoire $HOME en ajoutant
son nom &agrave; <i>/etc/ftpchroot</i>. En utilisant l'option <b>-A</b>
de
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&amp;sektion=8">ftpd(8)</a>, 
seuls les comptes list&eacute;s dans ce fichier seront autoris&eacute;s
&agrave; se connecter !
d788 4
a791 4
Les quotas sont utilis&eacute;s pour limiter l'espace disque disponible
pour les utilisateurs. Ce syst&egrave;me peut &ecirc;tre tr&egrave;s
utile si vous avez des ressources limit&eacute;es. Les quotas peuvent
&ecirc;tre configur&eacute;s par utilisateur et/ou par groupe.
d795 3
a797 3
La premi&egrave;re &eacute;tape pour configurer les quotas est de
s'assurer que <tt>option QUOTA</tt> est pr&eacute;sente dans votre <a
href="faq5.html#Options">configuration noyau</a>. Cette option est
d799 1
a799 2
syst&egrave;mes de fichiers o&ugrave; les quotas sont utilis&eacute;s
dans le fichier
d802 7
a808 9
Les mots cl&eacute;s <tt>userquota</tt> et <tt>groupquota</tt> doivent
&ecirc;tre utilis&eacute;s pour marquer chaque syst&egrave;me de
fichiers o&ugrave; les quotas sont activ&eacute;s. Par d&eacute;faut,
les fichiers <tt>quota.user</tt> et <tt>quota.group</tt> seront
cr&eacute;es &agrave; la racine des syst&egrave;mes de fichiers
o&ugrave; les quotas sont utilis&eacute;s pour stocker les informations
relatives &agrave; ces derniers. Si vous voulez les cr&eacute;er
ailleurs, sp&eacute;cifiez un fichier avec l'option des quotas dans
<tt>/etc/fstab</tt>, par exemple
d810 2
a811 3
<tt>/etc/fstab</tt> avec un syst&egrave;me de fichiers avec quotas
activ&eacute;s et le fichier de quotas se trouvant dans un endroit
non-standard :
d822 3
a824 3
edquota(8) va utiliser vi(1) pour &eacute;diter les quotas &agrave;
moins que la variable d'environnement EDITOR est positionn&eacute;e pour
charger un autre &eacute;diteur. Par exemple la commande :
d831 1
a831 1
Affichera un r&eacute;sultat similaire &agrave; :
d840 2
a841 2
Pour ajouter des limites, &eacute;diter l&agrave; pour donner un
r&eacute;sultat similaire &agrave; :
d851 7
a857 9
softlimit est fix&eacute; &agrave; 1000k et hardlimit &agrave; 1050k.
softlimit est une limite qui permet au syst&egrave;me de pr&eacute;venir
les utilisateurs quand ils l'ont d&eacute;pass&eacute;. Ils auront alors
jusqu'&agrave; la fin de leur p&eacute;riode de gr&acirc;ce pour
redescendre en dessous de cette limite. Les p&eacute;riodes de
gr&acirc;ce peuvent &ecirc;tre configur&eacute;es &agrave; l'aide de
l'option <b>-t </b> de edquota(8). Apr&egrave;s la fin de la
p&eacute;riode de gr&acirc;ce, softlimit est g&eacute;r&eacute; comme
hardlimit. Ce qui cause un &eacute;chec d'allocation.
d860 2
a861 2
Une fois les quotas configur&eacute;s, il faut les activer. Pour cela,
utilisez la commande
d871 3
a873 3
les quotas sur les syst&egrave;mes de fichiers o&ugrave; les options de
quota sont positionn&eacute;es. Maintenant que les quotas sont
activ&eacute;s, vous pouvez les visualiser &agrave; l'aide de
d877 1
a877 1
utilis&eacute;, quota vous fournira des statistiques sur les quotas. Par
d894 2
a895 3
Par d&eacute;faut, les quotas positionn&eacute;s dans
<tt>/etc/fstab</tt> seront activ&eacute;s au d&eacute;marrage. Pour les
d&eacute;sactiver, utilisez :
d906 2
a907 2
OpenBSD inclut KerberosV comme un composant pr&eacute;-install&eacute;
sur le syst&egrave;me par d&eacute;faut.
d910 2
a911 2
Pour plus d'information concernant KerberosV, sur votre syst&egrave;me
OpenBSD, utilisez la commande :
d922 14
a935 17
Le mode FTP anonyme permet &agrave; des utilisateurs sans compte
d'acc&eacute;der aux fichiers sur votre machine en utilisant le
protocole de transfert de fichiers. Ce chapitre a pour but de fournir
une vue d'ensemble de la configuration d'un serveur FTP anonyme, les
logs g&eacute;n&eacute;r&eacute;s, ...etc.

<h3>Cr&eacute;ation du compte FTP</h3>

<p>
La premi&egrave;re &eacute;tape consiste &agrave; cr&eacute;er un compte
&quot;ftp&quot; sur votre syst&egrave;me. Ce compte ne doit pas avoir de
mot de passe utilisable. Dans cet exemple, nous allons consid&eacute;rer
que /home/ftp est le r&eacute;pertoire correspondant au compte
&quot;ftp&quot; mais vous n'&ecirc;tes pas oblig&eacute; de choisir la
m&ecirc;me chose. Quand le mode anonyme est utilis&eacute;, le
d&eacute;mon ftp va se confiner au r&eacute;pertoire HOME de
l'utilisateur 'ftp' (dans notre cas, ce r&eacute;pertoire est
d940 1
a940 1
Voici un exemple de cr&eacute;ation du compte <i>ftp</i> en utilisant la
d943 8
a950 8
Au pr&eacute;alable, nous avons besoin d'ajouter /usr/bin/false au
fichier <i>/etc/shells</i>. C'est le shell que nous allons attribuer
&agrave; l'utilisateur ftp. Il ne permettra pas de connexion en login
&agrave; ce compte m&ecirc;me si nous configurons un mot de passe vide.
Pour effectuer cette op&eacute;ration, il suffit de faire <i>echo
/usr/bin/false &gt;&gt; /etc/shells</i>. Si en plus vous souhaitez que
ce shell apparaisse dans la liste des choix propos&eacute;s par adduser,
vous devez modifier le fichier <i>/etc/adduser.conf</i>.
d991 1
a991 1
<h3>Configuration du r&eacute;pertoire</h3>
d994 5
a998 5
L'op&eacute;ration a cr&eacute;e, en plus de l'utilisateur, le
r&eacute;pertoire <i>/home/ftp</i>. C'est ce que nous voulons mais nous
avons besoin d'effectuer quelques modifications pour pr&eacute;parer le
syst&egrave;me &agrave; h&eacute;berger le service FTP anonyme. Ces
modifications sont expliqu&eacute;es dans la page du manuel
d1002 2
a1003 2
<b>Vous n'avez pas besoin</b> de cr&eacute;er un r&eacute;pertoire
   /home/ftp/usr ou /home/ftp/bin.
d1006 16
a1021 18
<li><i>/home/ftp</i> - C'est le r&eacute;pertoire principal. Il doit &ecirc;tre 
    poss&eacute;d&eacute; par root avec les permissions 555.
<li><i>/home/ftp/etc</i> - Ce r&eacute;pertoire est optionnel et non
        recommand&eacute;. Son seul but est de fournir des informations
        sur les comptes utilisateurs existant. Si vous voulez que les
        fichiers de votre r&eacute;pertoire de ftp soient
        associ&eacute;s &agrave; de vrais utilisateurs, vous devez
        copier /etc/pwd.db et /etc/group dans ce r&eacute;pertoire. Les
        permissions du r&eacute;pertoire doivent &ecirc;tre 511. Les
        permissions sur les deux fichiers doivent &ecirc;tre 444. Ils
        sont utilis&eacute;s pour fournir une correspondance entre des
        nombres et les noms attribu&eacute;s aux comptes utilisateurs et
        groupes. Il n'y a pas de mots de passe dans pwd.db. Tous les
        mots de passe sont stock&eacute;s dans spwd.db alors ne copiez
        pas ce fichier.
<li><i>/home/ftp/pub</i> - C'est le r&eacute;pertoire standard pour
        mettre les fichiers que vous voulez partagez. Ce
        r&eacute;pertoire doit avoir les permissions 555. 
d1025 3
a1027 4
Il est &agrave; noter que tous ces r&eacute;pertoires doivent &ecirc;tre
la propri&eacute;t&eacute; de &quot;root&quot;. Voici &agrave; quoi
doivent ressembler les r&eacute;pertoires apr&egrave;s leur
cr&eacute;ation :
d1052 1
a1052 1
<h3>D&eacute;marrage du serveur et logs</h3>
d1055 3
a1057 4
Vous pouvez choisir d'ex&eacute;cuter ftpd soit &agrave; partir de inetd
soit directement de le lancer directement via les scripts rc. L'exemple
ci-apr&egrave;s repr&eacute;sente le cas o&ugrave; le service est
d&eacute;marr&eacute; &agrave; partir de
d1060 1
a1060 1
ftpd. La ligne par d&eacute;faut dans <i>/etc/inetd.conf</i> est :
d1067 2
a1068 2
Comme vous pouvez le voir, ftpd est invoqu&eacute; avec <i>-US</i>. Ces
options vont permettre de loguer les connexions anonymes dans
d1071 5
a1075 6
Dans certains cas, on souhaitera fournir un acc&egrave;s anonyme et
d&eacute;sactiver ftp pour les utilisateurs du syst&egrave;me. Pour
cela, il faut utiliser l'option <i>-A </i>de ftpd. Voici une ligne
d'invocation de ftpd en mode anonyme exclusif. On utilise aussi
<i>-ll</i> qui logue chaque connexion vers syslog en plus des commandes
ftp get, retrieve, etc. 
d1084 7
a1090 9
Remarque - Les personnes g&eacute;rant des serveurs ftp &agrave; HAUT
trafic ne devraient pas invoquer ftpd &agrave; partir de inetd.conf. La
meilleure option consiste &agrave; commenter la ligne correspondant
&agrave; ftpd dans /etc/inetd.conf et &agrave; d&eacute;marrer ftpd
&agrave; partir de rc.conf avec l'option <i>-D</i>. Ce qui va
d&eacute;marrer ftpd en tant que d&eacute;mon. Ce mode de fonctionnement
est beaucoup moins co&ucirc;teux et plus rapide que le d&eacute;marrage
via inetd. La ligne correspondant &agrave; ftpd dans rc.conf
ressemblerait &agrave; :
d1097 3
a1099 3
Bien &eacute;videmment, cette m&eacute;thode ne fonctionnera que si ftpd
est comment&eacute; dans <i>/etc/inetd.conf</i> et en veillant qu'inetd
ait bien relu sont fichier de configuration.
d1105 7
a1111 9
        qui sera affich&eacute; aux personnes qui se connectent sur
        votre serveur ftp.
<li><i>/etc/motd</i> - Ce fichier contient le message qui sera
        affich&eacute; aux utilisateurs une fois authentifi&eacute;s sur
        votre serveur ftp.
<li><i>.message</i> - Ce fichier peut &ecirc;tre mis dans n'importe quel
        r&eacute;pertoire. Il contient un message qui sera
        affich&eacute; lorsque l'utilisateur entre dans le
        r&eacute;pertoire o&ugrave; ce fichier se trouve.
d1116 2
a1117 2
<h2>10.13 - Confiner les utilisateurs &agrave; leur r&eacute;pertoire
       HOME avec ftpd(8)</h2>
d1120 24
a1143 109
le d&eacute;mon 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&amp;sektion=8">ftpd(8)</a> 
livr&eacute; avec OpenBSD est configur&eacute; par d&eacute;faut pour
g&eacute;rer cela de mani&egrave;re tr&egrave;s facile. Cette action est
accomplie par le biais du fichier <b>/etc/ftpchroot</b>. Puisqu'on ne
peut pas toujours faire confiance aux utilisateurs, il sera
peut-&ecirc;tre n&eacute;cessaire de les confiner &agrave; leur
r&eacute;pertoire HOME. Ce mode de fonctionnement n'est pas
activ&eacute; par d&eacute;faut. Voici &agrave; quoi ressemble le mode
par d&eacute;faut :

<blockquote><pre>
$ <strong>ftp localhost</strong>
Connected to localhost.
220 oshibana FTP server (Version 6.4/OpenBSD) ready.
Name (localhost:ericj): <strong>ericj</strong>
331 Password required for ericj.
Password: <strong>*********</strong>
230- OpenBSD 3.5 (GENERIC) #34: Mon Mar 29 12:24:55 MST 2004
230- 
230- Welcome to OpenBSD: The proactively secure Unix-like operating system.
230- 
230- Please use the sendbug(1) utility to report bugs in the system.
230- Before reporting a bug, please try to reproduce it with the latest
230- version of the code.  With bug reports, please try to ensure that
230- enough information to reproduce the problem is enclosed, and if a
230- known fix for it exists, include that as well.
230- 
230 User ericj logged in.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; <strong>cd /</strong>
250 CWD command successful.
ftp&gt; <strong>ls</strong>
227 Entering Passive Mode (127,0,0,1,60,7)
150 Opening ASCII mode data connection for 'file list'.
altroot
bin
dev
etc
home
mnt
root
sbin
stand
tmp
usr
var
bsd
sys
boot
226 Transfer complete.
ftp&gt; <strong>quit</strong>
221 Goodbye.
</pre></blockquote>

<p>
Comme vous pouvez le voir, l'acc&egrave;s est permis &agrave; tout le
serveur. Dans un monde parfait o&ugrave; on peut faire confiance aux
utilisateurs, il n'y a pas de mal &agrave; &ccedil;a mais c'est loin
d'&ecirc;tre le cas dans la r&eacute;alit&eacute;. Pour confiner un
utilisateur &agrave; son r&eacute;pertoire HOME, il suffit simplement
d'ajouter son nom au fichier <b>/etc/ftpchroot</b>. Voici un exemple
pour montrer cette restriction appliqu&eacute;e &agrave; l'utilisateur
&quot;ericj&quot; :

<blockquote><pre>
$ <strong>cat /etc/ftpchroot</strong>
#       $OpenBSD: ftpchroot,v 1.3 1996/07/18 12:12:47 deraadt Exp $
#
# list of users (one per line) given ftp access to a chrooted area.
# read by ftpd(8).
ericj
</pre></blockquote>

<p>
Cette op&eacute;ration est suffisante pour emp&ecirc;cher l'utilisateur
&quot;ericj&quot; de sortir de son propre r&eacute;pertoire comme vous
pouvez le voir &agrave; travers l'exemple suivant. Le r&eacute;pertoire
/ correspond maintenant &agrave; son r&eacute;pertoire HOME !

<blockquote><pre>
$ <strong>ftp localhost</strong>
Connected to localhost.
220 oshibana FTP server (Version 6.4/OpenBSD) ready.
Name (localhost:ericj): <strong>ericj</strong>
331 Password required for ericj.
Password: <strong>*********</strong>
230 User ericj logged in.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; <strong>cd /</strong>
250 CWD command successful.
ftp&gt; <strong>ls</strong>
227 Entering Passive Mode (127,0,0,1,92,171)
150 Opening ASCII mode data connection for 'file list'.
.login
.mailrc
.profile
.rhosts
.ssh
.cshrc
work
mail
src
226 Transfer complete.
ftp&gt; <strong>quit</strong>
221 Goodbye.
</pre></blockquote>
d1150 13
a1162 16
Le code source de OpenBSD est en constante &eacute;volution et
am&eacute;lioration. En m&ecirc;me temps, des correctifs aux
probl&egrave;mes les plus communs sont cr&eacute;es et diffus&eacute;s
au public. Ces correctifs apparaissent sur la
<a href="../../fr/errata.html">page web des errata</a>.
Ils sont s&eacute;par&eacute;s en cat&eacute;gories. Ces
cat&eacute;gories correspondent &agrave; des correctifs qui concernent
diff&eacute;rentes architectures ou &agrave; des correctifs
ind&eacute;pendants de l'architecture.

<p>
Cependant, il est &agrave; noter qu'il n'y a pas de correctifs pour les
nouvelles fonctionnalit&eacute;s ajout&eacute;es &agrave; OpenBSD. Les
correctifs corrigent uniquement des probl&eacute;mes de stabilit&eacute;
ou de s&eacute;curit&eacute; qui doivent &ecirc;tre r&eacute;gl&eacute;s
tr&egrave;s rapidement, bien que le choix final revienne &agrave;
d1166 3
a1168 3
Comme exemple, nous allons appliquer un correctif de
s&eacute;curit&eacute; obtenu &agrave; partir de la
<a href="../../fr/errata.html">page web des errata</a> &agrave;
d1171 2
a1172 2
<h3>Quelle est la diff&eacute;rence entre ces correctifs et ce qui se
    trouve dans l'arborescence CVS ? </h3>
d1175 3
a1177 4
Tous les correctifs post&eacute;s sur la
<a href="../../fr/errata.html">page web des errata</a>
concernent uniquement l'arborescence des sources de la derni&egrave;re
version diffus&eacute;e. Les autres correctifs qui concernent
d1179 1
a1179 2
qui ne sont peut-&ecirc;tre pas d&eacute;sirables sur la version de
production.
d1181 1
a1181 1
<h3>Pr&eacute;parer le syst&egrave;me pour l'application des
d1185 10
a1194 11
Les correctifs d'OpenBSD sont distribu&eacute;s sous la forme de
fichiers diff. Ces fichiers sont des fichiers texte qui contiennent les
diff&eacute;rences par rapport au code source d'origine. Ils ne sont
<b>PAS </b> distribu&eacute;s sous forme binaire. Cela veut dire que
pour appliquer les correctifs, vous devez avoir &agrave; disposition sur
votre syst&egrave;me le code source de la version <b>RELEASE
</b>d'OpenBSD. Cela ne veut pas dire que vous avez besoin de tout le
code source du syst&egrave;me d'exploitation OpenBSD pour appliquer les
correctifs &agrave; votre syst&egrave;me. Mais vous devez avoir le code
source correspondant au composant &agrave; corriger. Par exemple, si
vous corrigez le noyau vous devez avoir tout le code source au noyau.
d1198 4
a1201 4
est un outil tr&egrave;s pratique pour t&eacute;l&eacute;charger
uniquement les sources dont vous avez besoin en utilisant des serveurs
cvs anonymes situ&eacute;s un peu partout dans le monde. Vous pouvez
avoir une liste des serveurs disponibles dans la
d1205 2
a1206 2
Pour t&eacute;l&eacute;charger le code source de talkd(8) correspondant
&agrave; la version <i>3.5-release</i> via
d1222 11
a1232 11
Pour conna&icirc;tre le chemin CVS du code dont vous avez besoin, reportez-
vous &agrave; la ligne <i>Index:</i>. Dans notre cas, le chemin CVS est
<i>src/libexec/talkd/</i>. Il faut toujours v&eacute;rifier la
r&eacute;vision de OPENBSD_version_number_BASE. Sans &quot;_BASE&quot;,
vous obtiendrez le code correspondant &agrave; la branche stable qui
contient probablement d'autres modifications qui peuvent
interf&eacute;rer avec la proc&eacute;dure d'application des correctifs.
Si vous synchroniser vos sources par rapport &agrave; la branche stable,
les correctifs sont normalement d&eacute;j&agrave; inclus dans le code
source. Cependant, nous vous conseillons de toujours effectuer une
v&eacute;rification. Vous pouvez voir dans la page consacr&eacute;e aux
d1234 3
a1236 5
correctifs qui ont &eacute;t&eacute; appliqu&eacute;s &agrave; la
branche stable. Si les correctifs n'ont pas encore &eacute;t&eacute;
appliqu&eacute;s, vous devez t&eacute;l&eacute;charger les sources de la
derni&egrave;re RELEASE en utilisant les commandes
pr&eacute;c&eacute;dentes.
d1239 4
a1242 4
Pour les utilisateurs ayant achet&eacute; des CDs OpenBSD officiels,
vous pouvez obtenir le code source directement &agrave; partir du CD.
Reportez vous &agrave; l'encart livr&eacute; avec votre CD. Vous n'aurez
&agrave; ce moment-l&agrave; besoin d'obtenir les sources via anoncvs.
d1271 2
a1272 2
Une fois que vous avez obtenu les sources, vous pouvez
t&eacute;l&eacute;charger le correctif que vous mettrez sous <i>src/</i>
d1328 1
a1328 1
Une fois cette op&eacute;ration effectu&eacute;e, red&eacute;marrez le
d1338 3
a1340 4
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=chroot&amp;sektion=2">chroot(2)</a>&eacute;
par d&eacute;faut. Etant un grand pas en avant du point de vue de la
s&eacute;curit&eacute;, cela peut cr&eacute;er des probl&egrave; si vous
n'y &ecirc;tes pas pr&eacute;par&eacute;.
d1345 13
a1357 16
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=chroot&amp;sektion=2">chroot(2)</a>&eacute;e
est bloqu&eacute;e dans un r&eacute;pertoire sp&eacute;cifique et ne
peut errer dans les autres r&eacute;pertoires de l'arbre du
syst&egrave;me de fichiers et voit ce r&eacute;pertoire comme sont
r&eacute;pertoire <tt>/</tt> (root). Dans le cas d'httpd(8), le
programme d&eacute;marre, ouvre ses fichiers log, ouvre ses ports TCP
(bien qu'il n'accepte pas encore de donn&eacute;es), et lis sont fichier
de configuration. Ensuite, il se fixe lui-m&ecirc;me dans le
r&eacute;pertoire <i>/var/www</i> et baisse ses privil&egrave;ges. Ce
qui veut dire que tous les fichiers servis et utilis&eacute;s par
Apache, doivent &ecirc;tre dans le r&eacute;pertoire <i>/var/www</i>.
Cela aide consid&eacute;rablement la s&eacute;curit&eacute; -- si il
devait y avoir un probl&egrave;me de s&eacute;curit&eacute;, les
d&eacute;gats seraient confin&eacute;s dans un seul r&eacute;pertoire
avec les permissions de "lecture seule" et aucune ressource pour causer
des probl&egrave;mes.
d1361 3
a1363 3
configuration n'est pas adopt&eacute; par la plupart des autres
syst&egrave;mes d'exploitation. beaucoup d'applications et de
configurations syst&egrave;me ne fonctionneront plus comme avant.
d1366 11
a1376 12
<li><b>Hi&eacute;rarchie historique du syst&egrave;me de fichiers :</b>
Les serveurs mis &agrave; jour depuis d'anciennes versions d'OpenBSD
peuvent avoir les fichiers web situ&eacute;s dans les r&eacute;pertoires
HOME des utilisateurs, ce qui clairement ne fonctionnera pas dans un
environnement chroot(2)&eacute; &eacute;tant donn&eacute; qu'httpd(8) ne
peut atteindre le r&eacute;pertoire <i>/home</i>. Les administrateurs
d&eacute;couvriront peut-&ecirc;tre que leur partition /var/www
existente est trop petite pour accueillir tous les fichiers web. Vos
options sont d&egrave;s lors de restructurer votre syst&egrave;me ou de
ne pas utiliser l'option du chroot(2). Vous pouvez, bien evidemment,
utiliser des liens symboliques dans le r&eacute;pertoire HOME de
l'utilisateur pointant vers les sous-r&eacute;pertoires dans
d1378 2
a1379 2
<i>/var/www</i> pointant vers une autre partie du syst&egrave;me de
fichier -- ceci ne peut fonctionner d&ucirc; au chroot(2). Notez que si
d1381 6
a1386 6
<a href="faq10.html#ftpchroot">acc&egrave;s FTP chroot(2)&eacute;</a>,
ceci ne fonctionnera pas plus &eacute;tant donn&eacute; que le chroot
FTP va (&agrave; nouveau) vous emp&ecirc;cher d'acc&eacute;der aux
destinations de ces liens symboliques. Une solution est donc, de ne pas
utiliser <i>/home</i> comme r&eacute;pertoire HOME pour ces utilisateurs
mais plutot quelque chose similaire &agrave; <i>/var/www/home</i>.
d1390 6
a1395 8
fichiers log est r&eacute;alis&eacute;e en renommant les anciens
fichiers, ensuite en envoyant &agrave; httpd(8) un signal SIGUSR1 qui
forcera Apache &agrave; fermer ses anciens fichiers logs et &agrave; en
ouvrir de nouveaux. Ceci n'est d&eacute;sormais plus possible,
&eacute;tant donn&eacute; qu'httpd(8) n'a plus la possibilit&eacute;
d'ouvrir ses propres fichiers log une fois que ses privil&egrave;ges ont
baiss&eacute;s. httpd(8) doit donc &ecirc;tre stopp&eacute; et
relanc&eacute; :
d1401 1
a1401 2
Il existe n&eacute;anmoins d'autres techniques, notamment logguer 
vers un 
d1403 2
a1404 2
et utiliser un programme ext&eacute;rieur afin de r&eacute;aliser une
rotation des fichiers &agrave; la fin du pipe.
d1407 2
a1408 2
tous, cependant, certains pourraient ne pas fonctionner correctement
dans le chroot(2), et pourraient causer des probl&egrave;mes lors de
d1410 1
a1410 2
restart"</tt>, g&eacute;n&eacute;rant une erreur, causant httpd(8)
&agrave; se stopper.
d1413 9
a1421 10
Ils auront certainement besoin de programmes ou de librairies se
trouvant hors de <i>/var/www</i>. Certains peuvent &ecirc;tre
corrig&eacute;s en &eacute;tant compil&eacute;s statiquement (n'ayant
pas besoin de librairies se trouvant dans un autre r&eacute;pertoire),
la plupart peuvent &ecirc;tre corrig&eacute;s en copiant dans
<i>/var/www</i> les fichiers n&eacute;cessaires &agrave; l'application,
bien que cette manoeuvre soit non triviale et requiert certaines notions
de programmation -- la plupart des utilisateurs trouveront plus facile
de ne pas employer le chroot(2) en attendant une mise &agrave; jour de
ces CGIs.
d1424 4
a1427 4
Dans certains cas, les applications ou les configurations peuvent
&ecirc;tre chang&eacute;es pour fonctionner dans le chroot. Dans 
d'autres cas, vous devrez tout simplement retirer cette option 
en utilisant l'option <tt>-u</tt> de httpd(8) dans<i>
d1432 7
a1438 7
Voyons comment mettre en place chroot(2) pour une application &agrave;
travers un exemple. Cet exemple se base sur wwwcount, un compteur tout
simple d'acc&egrave;s aux pages web disponible dans l'arborescence des
<a href="../faq8.html#Ports">ports</a>.
Bien qu'il soit un programme tr&egrave;s efficace, wwwcount ne sait rien
d'Apache chroot(2)&eacute; et ne fonctionnera pas dans un environnement
chroot(2)&eacute; avec sa configuration de base.
d1444 7
a1450 8
Nous le configurons et le testons et c'est l&agrave; que nous en
d&eacute;duisons qu'il ne semble pas fonctionner : Apache nous affiche
le message "Internal Server Error".

La premi&egrave;re &eacute;tape consiste &agrave; arr&ecirc;ter Apache
et &agrave; le red&eacute;marrer avec l'option <tt>-u</tt> pour
v&eacute;rifier que le probl&egrave;me vient bien du chroot(2) et pas de
la configuration syst&egrave;me.
d1457 6
a1462 7
Apr&egrave;s avoir fait cela, nous constatons que le compteur fonctionne
correctement, du moins apr&egrave;s avoir chang&eacute; les droits d'un
r&eacute;pertoire afin qu'Apache (et les CGIs qu'il ex&eacute;cute)
puisse &eacute;crire &agrave; des fichiers.
Ainsi, nous sommes maintenant certains que le probl&egrave;me vient du
chroot. Nous arr&ecirc;tons alors et red&eacute;marrons Apache &agrave;
nouveau en utilisant le chroot par d&eacute;faut :
d1472 2
a1473 3
librairies et d'autres fichiers qu'il ne peut acc&eacute;der une fois
dans le chroot.
On peut utiliser &agrave; cet effet la commande
d1475 1
a1475 1
pour trouver les d&eacute;pendances dynamiques dont le CGI a besoin :
d1485 3
a1487 3
Ah ! voil&agrave; un probl&egrave;me. Deux fichiers ne sont pas
disponibles dans l'environnement chroot(2).
Alors, on les copie dans cet environnement :
d1493 1
a1493 1
Puis nous essayons le compteur &agrave; nouveau.
d1496 6
a1501 8
Au moins, le programme s'ex&eacute;cute maintenant et nous affiche des
messages d'erreur directement : "Unable to open config file for
reading". Nous avons bien progress&eacute; mais nous n'avons pas encore
fini.
Le fichier de configuration se trouve normalement dans le
r&eacute;pertoire <tt>/var/www/wwwcount/conf</tt>, mais au sein de
l'environnement chroot, le programme devrait le voir sous
<tt>/wwwcount/conf</tt>.
d1503 7
a1509 9
qu'il tienne compte du nouveau fichier de configuration par
d&eacute;faut (o&ugrave; plut&ocirc;t du chemin pour l'atteindre) soit
nous d&eacute;pla&ccedil;ons les fichiers de donn&eacute;es.
Vu que nous avons install&eacute; le programme &agrave; partir d'un
package, nous prenons l'option 2, &agrave; savoir le d&eacute;placement
des fichiers de donn&eacute;es.
Afin que nous puissons utiliser exactement la m&ecirc;me configuration
dans un environnement chroot(2)&eacute; ou pas, nous utiliserons un lien
symbolique :
d1516 3
a1518 4
Remarquez que le lien symbolique a &eacute;t&eacute; pens&eacute; pour
fonctionner au sein du chroot.
Nous testons notre programme &agrave; nouveau et nous voil&agrave; avec
un autre probl&egrave;me.
d1520 4
a1523 4
image" qu'il utilise pour afficher des messages.
Apr&egrave;s quelques recherches, nous nous rendons compte que ces
fichiers sont stock&eacute;s dans <tt>/usr/local/lib/wwwcount</tt>, nous
devons donc les copier dans le chroot aussi.
d1527 1
a1527 1
Nous testons &agrave; nouveau ... et &ccedil;a marche !
d1530 12
a1541 16
Dans cet exemple, le programme &eacute;tait simple et malgr&eacute;
&ccedil;a, nous avons constat&eacute; plusieurs probl&egrave;mes.
Certaines applications sont relativement simples et les mettre dans un
chroot(2) n'a aucun sens.
D'autres sont tr&egrave;s complexes. Elles ne valent pas les efforts
n&eacute;cessaires pour les mettre en chroot(2) et m&ecirc;me si
c'&eacute;tait le cas, vous perdriez tous les avantages du chroot(2)
apr&egrave;s avoir copi&eacute; la masse importante de fichiers dont
elles ont besoin pour fonctionner.
M&ecirc;me avec une application aussi simple que celle que nous avons
utilis&eacute; pour cet exemple, l'acc&egrave;s au disque est
n&eacute;cessaire (pour mettre &agrave; jour les compteurs). Du coup,
certains avantages de chroot(2) ont &eacute;t&eacute; perdus.
De mani&egrave;re g&eacute;n&eacute;rale, le minimum de fichiers
n&eacute;cessaires pour faire fonctionner une application devraient
&ecirc;tre copi&eacute;s dans le chroot.
d1547 1
a1547 2
Le shell par d&eacute;faut sur OpenBSD de l'utilisateur 
<i>root</i> est 
d1549 3
a1551 3
d&ucirc; principalement &agrave; la tradition. Il n'est pas
sp&eacute;cialement requis qu'OpenBSD ait csh(1) comme shell pour
l'utilisateur root (lisez n&eacute;anmoins avant de le changer).
d1554 3
a1556 3
Certains utilisateurs venant d'un syst&egrave;me d'exploitation
"Unix-like" trouvent csh(1) peu familier et demande d&egrave;s lors si
ils peuvent le changer et comment. Il y a plusieurs options :
d1559 2
a1560 1
<li><b>Ne vous authentifiez pas directement en tant que <i>root</i></b> Entre
d1562 1
a1562 1
et
d1564 8
a1571 8
il ne devrait y avoir que peu de raisons pour que les utilisateurs
s'authentifient en tant que <i>root</i> pour la plupart des applications
apr&egrave;s l'installation initiale.
<li><b>Invoquez votre shell favori apr&egrave;s le login :</b> Si vous
aimez ksh(1) ou n'importe quel autre shell, invoquez le simplement
depuis votre shell par d&eacute;faut.
<li><b>Changez le shell de l'utilisateur root :</b> Ceci peut &ecirc;tre
fait en utilisant
d1573 1
a1573 1
ou
d1578 6
a1583 8
des shells compil&eacute;s statiquement, car si votre syst&egrave;me
d&eacute;marre en mode utilisateur unique, les partitions non-root ne
seront pas mont&eacute;es et les shells li&eacute;s dynamiquement ne
seront pas capable d'acc&eacute;der aux librairies situ&eacute;es dans
la partition <tt>/usr</tt>. Ceci n'&eacute;tant pas tr&egrave;s
important pour OpenBSD, car le syst&egrave;me vous demandera de choisir
un shell lors d'un d&eacute;marrage en mode utilisateur unique, le shell
par d&eacute;faut &eacute;tant
d1591 1
a1591 2
sont li&eacute;s statiquement et donc utilisables en mode utilisateur
unique.
d1596 2
a1597 2
Mais encore une fois, ceci ne devrait pas &ecirc;tre une raison -- ne
vous authentifiez pas directement en tant que root.
d1606 1
a1606 1
m&ecirc;me binaire que
d1610 9
a1618 10
Les utilisateurs qui sont &agrave; l'aise avec <i>bash</i>, souvent
utilis&eacute; sur les syst&egrave;mes Linux, trouveront probablement
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ksh&amp;sektion=1">ksh</a> 
tr&egrave;s familier. Ksh(1) offre la plupart des options habituellement
utilis&eacute;es avec <i>bash</i>, notamment l'ach&egrave;vement des
commandes avec la touche tab, l'&eacute;dition de la ligne de commande
et l'historique via les touches fl&egrave;ch&eacute;es, et CTRL-A/CTRL-E
pour aller au d&eacute;but/&agrave; la fin de la ligne de commande. Si
vous d&eacute;sirez d'autres options de <i>bash</i>, <i>bash</i> peut
&ecirc;tre install&eacute; soit via les
d1623 3
a1625 4
Le prompt de <i>ksh</i> peut &ecirc;tre facilement chang&eacute; de
mani&egrave;re &agrave; fournir plus d'informations que le simple "$ "
par d&eacute;faut en modifiant la variable <tt>PS1</tt>. Par exemple, en
ins&eacute;rant la ligne suivante :
d1640 1
a1640 2
&ecirc;tre invoqu&eacute; dans les fichiers <tt>.profile</tt> de vos
utilisateurs.
d1654 2
a1655 2
Originally [OpenBSD: faq10.html,v 1.105 ]<br>
$Translation: faq10.html,v 1.28 2004/09/09 13:27:29 saad Exp $<br>
@


1.22
log
@sync with Steelix CVS
@
text
@d1577 1
a1577 2
"<tt>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=apachectl&amp;sektion=8">apachectl</a> 
d1842 2
a1843 2
Originally [OpenBSD: faq10.html,v 1.104 ]<br>
$Translation: faq10.html,v 1.27 2004/08/31 12:04:26 saad Exp $<br>
@


1.21
log
@Sync with Steelix CVS
@
text
@d1834 1
a1834 1
<a href= "../faq9.html">[Section 9 - Migrer vers OpenBSD]</a>
d1844 1
a1844 1
$Translation: faq10.html,v 1.26 2004/08/18 14:42:08 saad Exp $<br>
@


1.20
log
@Sync with Steelix CVS
@
text
@d19 1
a19 1
<a href= "faq9.html">[Section 9 - Migrer depuis Linux]</a>
d1834 1
a1834 1
<a href= "../faq9.html">[Section 9 - Migrer depuis Linux]</a>
d1843 2
a1844 2
Originally [OpenBSD: faq10.html,v 1.103 ]<br>
$Translation: faq10.html,v 1.25 2004/06/01 08:36:58 saad Exp $<br>
@


1.19
log
@Sync with Steelix CVS
@
text
@d23 1
a23 1
<h1><font color=#e00000>10 - Gestion du Syst&egrave;me</font></h1> 
d498 1
a498 1
avec le drapeau <b>-DSSL</b> (consultez la <a href=#rc">section &agrave;
d1844 1
a1844 1
$Translation: faq10.html,v 1.24 2004/05/19 20:56:37 saad Exp $<br>
@


1.18
log
@Sync with Steelix CVS
@
text
@d1205 1
a1205 1
230- OpenBSD 3.4 (GENERIC) #18: Wed Sep 17 03:34:47 MDT 2003
d1364 1
a1364 1
&agrave; la version <i>3.4-release</i> via
d1371 1
a1371 1
$ <b>cvs co -rOPENBSD_3_4_BASE src/libexec/talkd/</b>
d1524 4
a1527 3
En gros, chroot(2)er Apache est quelque chose de nouveau, et donc
beaucoup d'applications et de configurations syst&egrave;me ne
fonctionneront plus comme avant.
d1574 1
a1574 1
<li><b>Modules Apache existant :</b> Pratiquement, ils se lanceront
d1582 1
a1582 1
<li><b>CGIs existant :</b> La plupart ne fonctionneront pas tels quels.
d1598 129
a1726 2
en utilisant l'option <tt>u</tt> d'Apache dans<i>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc.conf&amp;sektion=8">rc.conf</a></i>
d1843 2
a1844 2
Originally [OpenBSD: faq10.html,v 1.100 ]<br>
$Translation: faq10.html,v 1.23 2004/03/25 21:03:18 saad Exp $<br>
@


1.17
log
@Sync with Steelix CVS
@
text
@d1360 1
a1360 1
<a href="http://www.openbsd.org/fr/anoncvs.html">page CVS Anonyme</a>.
d1715 2
a1716 2
Originally [OpenBSD: faq10.html,v 1.99 ]<br>
$Translation: faq10.html,v 1.22 2004/03/12 22:53:19 saad Exp $<br>
@


1.16
log
@Sync with Steelix CVS
@
text
@d1359 2
a1360 3
avoir une liste des serveurs disponibles &agrave; l'adresse suivante
:<br>
<a href="http://www.openbsd.org/fr/anoncvs.html">http://www.openbsd.org/anoncvs.html</a>. 
d1363 5
a1367 3
Pour t&eacute;l&eacute;charger le code source de talkd(8) correspondant &agrave; la version 
  <i>3.4-release</i> via <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cvs&amp;sektion=1">cvs(1)</a>, 
  vous utiliseriez les lignes de commande suivantes : 
d1379 26
a1404 19
<p>Pour conna&icirc;tre le chemin CVS du code dont vous avez besoin, reportez-vous 
  &agrave; la ligne <i>Index:</i>. Dans notre cas, le chemin CVS est <i>src/libexec/talkd/</i>. 
  Il faut toujours v&eacute;rifier la r&eacute;vision de OPENBSD_version_number_BASE. 
  Sans &quot;_BASE&quot;, vous obtiendrez le code correspondant &agrave; la branche 
  stable qui contient probablement d'autres modifications qui peuvent interf&eacute;rer 
  avec la proc&eacute;dure d'application des correctifs. Si vous synchroniser 
  vos sources par rapport &agrave; la branche stable, les correctifs sont normalement 
  d&eacute;j&agrave; inclus dans le code source. Cependant, nous vous conseillons 
  de toujours effectuer une v&eacute;rification. Vous pouvez voir sur <a href="../../plus.html">http://www.openbsd.org/plus.html</a> 
  les correctifs qui ont &eacute;t&eacute; appliqu&eacute;s &agrave; la branche 
  stable. Si les correctifs n'ont pas encore &eacute;t&eacute; appliqu&eacute;s, 
  vous devez t&eacute;l&eacute;charger les sources de la derni&egrave;re RELEASE 
  en utilisant les commandes pr&eacute;c&eacute;dentes.
<p>Pour les utilisateurs ayant achet&eacute; des CDs OpenBSD officiels, vous pouvez 
  obtenir le code source directement &agrave; partir du CD. Reportez vous &agrave; 
  l'encart livr&eacute; avec votre CD. Vous n'aurez &agrave; ce moment-l&agrave; 
  besoin d'obtenir les sources via anoncvs. 
<blockquote>
<pre>
d1430 5
a1434 3
<p>Une fois que vous avez obtenu les sources, vous pouvez t&eacute;l&eacute;charger 
  le correctif que vous mettrez sous <i>src/</i>
<h3>Application des correctifs </h3>
d1530 21
a1550 25
       Les serveurs mis &agrave; jour depuis d'anciennes versions
       d'OpenBSD peuvent avoir les fichiers web situ&eacute;s dans les
       r&eacute;pertoires HOME des utilisateurs, ce qui clairement ne
       fonctionnera pas dans un environnement chroot(2)&eacute;
       &eacute;tant donn&eacute; qu'httpd(8) ne peut atteindre le
       r&eacute;pertoire <i>/home</i>. Les administrateurs
       d&eacute;couvriront peut-&ecirc;tre que leur partition /var/www
       existente est trop petite pour accueillir tous les fichiers web.
       Vos options sont d&egrave;s lors de restructurer votre
       syst&egrave;me ou de ne pas utiliser l'option du chroot(2). Vous
       pouvez, bien evidemment, utiliser des liens symboliques dans le
       r&eacute;pertoire HOME de l'utilisateur pointant vers les
       sous-r&eacute;pertoires dans <i>/var/www</i>, mais vous ne pouvez
       PAS utiliser des liens dans <i>/var/www</i> pointant vers une
       autre partie du syst&egrave;me de fichier -- ceci ne peut
       fonctionner d&ucirc; au chroot(2). Notez que si vous voulez que
       vos utilisateurs aient un <a
       href="faq10.html#ftpchroot">acc&egrave;s FTP
       chroot(2)&eacute;</a>, ceci ne fonctionnera pas plus &eacute;tant
       donn&eacute; que le chroot FTP va (&agrave; nouveau) vous
       emp&ecirc;cher d'acc&eacute;der aux destinations de ces liens
       symboliques. Une solution est donc, de ne pas utiliser
       <i>/home</i> comme r&eacute;pertoire HOME pour ces utilisateurs
       mais plutot quelque chose similaire &agrave;
       <i>/var/www/home</i>.
d1554 8
a1561 8
       fichiers log est r&eacute;alis&eacute;e en renommant les anciens
       fichiers, ensuite en envoyant &agrave; httpd(8) un signal SIGUSR1
       qui forcera Apache &agrave; fermer ses anciens fichiers logs et
       &agrave; en ouvrir de nouveaux. Ceci n'est d&eacute;sormais plus
       possible, &eacute;tant donn&eacute; qu'httpd(8) n'a plus la
       possibilit&eacute; d'ouvrir ses propres fichiers log une fois que
       ses privil&egrave;ges ont baiss&eacute;s. httpd(8) doit donc
       &ecirc;tre stopp&eacute; et relanc&eacute; :
d1574 3
a1576 3
       tous, cependant, certains pourraient ne pas fonctionner
       correctement dans le chroot(2), et pourraient causer des
       probl&egrave;mes lors de "<tt>
d1578 2
a1579 2
        restart"</tt>, g&eacute;n&eacute;rant une erreur, causant
        httpd(8) &agrave; se stopper.
d1582 10
a1591 11
       Ils auront certainement besoin de programmes ou de librairies se
       trouvant hors de <i>/var/www</i>. Certains peuvent &ecirc;tre
       corrig&eacute;s en &eacute;tant compil&eacute;s statiquement
       (n'ayant pas besoin de librairies se trouvant dans un autre
       r&eacute;pertoire), la plupart peuvent &ecirc;tre corrig&eacute;s
       en copiant dans <i>/var/www</i> les fichiers n&eacute;cessaires
       &agrave; l'application, bien que cette manoeuvre soit non
       triviale et requiert certaines notions de programmation -- la
       plupart des utilisateurs trouveront plus facile de ne pas
       employer le chroot(2) en attendant une mise &agrave; jour de ces
       CGIs.
d1597 1
a1597 1
en utilisant l'option <tt>u</tt> d'Apache dans <i>
d1623 2
a1624 2
       aimez ksh(1) ou n'importe quel autre shell, invoquez le
       simplement depuis votre shell par d&eacute;faut.
d1626 1
a1626 1
       fait en utilisant
d1677 3
a1679 3
&ecirc;tre install&eacute; soit via les <a
href="faq8.html#Ports">ports</a> ou soit via les <a
href="faq8.html#Packages">packages</a>.
d1712 2
a1713 2
<p><a href= "index.html"><img height= "24" width= "24" src= "../../images/back.gif" border= "0" alt="[back]"></a> 
  <a href="mailto:www@@openbsd.org">www@@openbsd.org</a> <br>
d1715 2
a1716 2
Originally [OpenBSD: faq10.html,v 1.98 ]<br>
$Translation: faq10.html,v 1.21 2004/03/09 20:59:45 saad Exp $<br>
@


1.15
log
@Sync with Steelix CVS
@
text
@d1710 2
a1711 2
Originally [OpenBSD: faq10.html,v 1.97 ]<br>
$Translation: faq10.html,v 1.20 2004/03/02 05:30:43 saad Exp $<br>
@


1.14
log
@Sync with Steelix CVS
@
text
@d1305 2
a1306 3
au public. Ces correctifs apparaissent sur une page web &agrave;
l'adresse 
<a href="../../fr/errata.html">http://www.openbsd.org/fr/errata.html</a>.
d1322 2
a1323 2
s&eacute;curit&eacute; obtenu &agrave; partir de 
<a href="../../fr/errata.html">errata.html</a> &agrave;
d1330 2
a1331 2
Tous les correctifs post&eacute;s sur
<a href="../../fr/errata.html">http://www.openbsd.org/fr/errata.html</a>
d1710 2
a1711 2
Originally [OpenBSD: faq10.html,v 1.96 ]<br>
$Translation: faq10.html,v 1.19 2004/02/29 20:26:10 saad Exp $<br>
@


1.13
log
@Sync with Steelix CVS
@
text
@d1307 5
a1311 5
<a href="../errata.html">http://www.openbsd.org/errata.html</a>. Ils
sont s&eacute;par&eacute;s en cat&eacute;gories. Ces cat&eacute;gories
correspondent &agrave; des correctifs qui concernent diff&eacute;rentes
architectures ou &agrave; des correctifs ind&eacute;pendants de
l'architecture.
d1324 1
a1324 1
<a href="../errata.html">errata.html</a> &agrave;
d1331 7
a1337 6
Tous les correctifs post&eacute;s sur <a
href="../errata.html">http://www.openbsd.org/errata.html</a> concernent
uniquement l'arborescence des sources de la derni&egrave;re version
diffus&eacute;e. Les autres correctifs qui concernent l'arborescence
actuelle de CVS peuvent contenir certaines modifications qui ne sont
peut-&ecirc;tre pas d&eacute;sirables sur la version de production.
d1712 1
a1712 1
$Translation: faq10.html,v 1.18 2004/01/02 22:19:03 saad Exp $<br>
@


1.12
log
@Sync with Steelix CVS
@
text
@d11 1
a11 1
<meta name= "copyright"     content= "This document copyright 1998-2003 by OpenBSD.">
d1710 2
a1711 2
Originally [OpenBSD: faq10.html,v 1.95 ]<br>
$Translation: faq10.html,v 1.17 2003/11/17 21:27:42 saad Exp $<br>
@


1.11
log
@Sync with Steelix CVS
@
text
@d155 5
a159 5
<i>/etc/rc.conf</i> (or <i>/etc/rc.conf.local</i>),<i>/etc/rc.local</i>
<i>et <i>/etc/rc.shutdown</i>.
Les principaux fichiers &agrave; conna&icirc;tre par l'administrateur
syst&egrave;me. Pour comprendre le fonctionnement de la proc&eacute;dure
rc(8), en voici le d&eacute;roulement : 
d499 1
a499 1
propos d'rc(8) dans cette faq</a>), activant ainsi les transactions
d682 1
a682 1
d'utiliser soit <b>user add</b>soit <b>useradd</b>. Le choix est votre
d685 1
a685 1
que le compte cr&eacute;e 
d1711 1
a1711 1
$Translation: faq10.html,v 1.16 2003/11/11 09:57:06 saad Exp $<br>
@


1.10
log
@sync with steelix translation CVS
@
text
@d53 2
a54 2
<h2>10.1 - Quand j'essaie de passer root &agrave; l'aide de su, on me dit que 
  je suis dans le mauvais groupe</h2>
d56 20
a75 16
<p> Les utilisateurs existant sur le syst&egrave;me doivent &ecirc;tre rajout&eacute;s 
  au groupe <kbd>&quot;</kbd><kbd>wheel&quot;</kbd> &agrave; la main. Ceci est 
  fait pour des raisons de s&eacute;curit&eacute;, et vous devriez apporter une 
  attention toute particuli&egrave;re lorsque vous donnez l'acc&egrave;s &agrave; 
  ce groupe &agrave; des utilisateurs. Sous OpenBSD, les utilisateurs appartenant 
  au groupe <kbd>wheel</kbd> sont autoris&eacute;s &agrave; utiliser le programme 
  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=su&amp;sektion=1">su(1)</a> 
  pour devenir root. Les utilisateurs n'appartenant pas &agrave; ce groupe ne 
  peuvent pas utiliser su(1). Voici un exemple d'une entr&eacute;e <kbd>/etc/group</kbd> 
  pour mettre l'utilisateur <strong>ericj</strong> dans le groupe <kbd>&quot;wheel&quot;</kbd>. 
<p>Si vous ajoutez un utilisateur avec <a 
href="http://www.openbsd.org/cgi-bin/man.cgi?query=adduser&amp;sektion=8">adduser(8)</a>, 
  vous pouvez le mettre dans le groupe wheel en r&eacute;pondant wheel &agrave; 
  la question "<tt>Invite <i>user</i> into other groups:</tt>". Ceci aura pour effet 
  de rajouter l'entr&eacute;e correspondante dans /etc/group qui ressemble &agrave; 
  la ligne suivante :
d81 5
a85 4
<p>Si vous cherchez un moyen pour limiter l'acc&egrave;s des utilisateurs aux 
  privil&egrave;ges du super utilisateur, sans pour autant les mettre dans le 
  groupe <kbd>&quot;wheel&quot;</kbd>, utilisez <a 
href="http://www.openbsd.org/cgi-bin/man.cgi?query=sudo&amp;sektion=8">sudo(8)</a>. 
d90 2
a91 1
<p>Pour dupliquer votre syst&egrave;me de fichiers, utilisez 
d93 4
a96 3
  et <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=restore&amp;sektion=8">restore(8)</a>. 
  Par exemple, pour dupliquer tout ce qu'il y a sous le r&eacute;pertoire <kbd>SRC</kbd> 
  vers le r&eacute;pertoire <kbd>DST</kbd>, faites un : 
d101 8
a108 6
<p>dump est con&ccedil;u pour vous fournir beaucoup de possibilit&eacute;s de 
  sauvegarde, et c'est peut-&ecirc;tre trop si vous voulez juste dupliquer une 
  partie d'un syst&egrave;me de fichiers (entier). La commande <a 
href="http://www.openbsd.org/cgi-bin/man.cgi?query=tar&amp;sektion=1">tar(1)</a> 
  peut &ecirc;tre plus rapide pour ce genre d'op&eacute;ration. Le format est 
  tr&egrave;s similaire &agrave; celui de dump : 
d116 2
a117 2
<h2>10.3 - Comment d&eacute;marrer des services en m&ecirc;me temps que le syst&egrave;me 
  ? (Vue d'ensemble de rc(8))</h2>
d119 5
a123 3
<p>OpenBSD utilise un d&eacute;marrage de type <a 
href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc&amp;sektion=8">rc(8)</a>. 
  Il utilise seulement quelques fichiers cl&eacute;s pour le d&eacute;marrage.
d125 25
a149 21
  <li>/etc/rc - Script principal. Ne doit pas &ecirc;tre &eacute;dit&eacute;.
  <li>/etc/rc.conf - Fichier de configuration utilis&eacute; par <i>/etc/rc </i>pour 
    savoir quels services doivent &ecirc;tre d&eacute;marr&eacute;s en m&ecirc;me 
    temps que le syst&egrave;me
  <li>/etc/rc.conf.local - Fichier de configuration servant &agrave; compl&eacute;ter
    /etc/rc.conf, ainsi vous ne devez pas toucher &agrave; /etc/rc.conf, ce qui est 
    commode pour ceux qui (re)mettent souvent &agrave; jour leur syst&egrave;me. 
  <li>/etc/netstart - Script pour initialiser le r&eacute;seau. Ne devrait pas 
    &ecirc;tre &eacute;dit&eacute;. 
  <li>/etc/rc.local - Script utilis&eacute; pour l'administration locale. C'est 
    l&agrave; o&ugrave; les informations relatives &agrave; de nouveaux services 
    ou des informations sp&eacute;cifiques &agrave; l'h&ocirc;te doivent &ecirc;tre 
    stock&eacute;es.
  <li>/etc/rc.securelevel - Script utilis&eacute; pour ex&eacute;cuter des commandes 
    qui doivent &ecirc;tre ex&eacute;cut&eacute;es avant que le niveau de s&eacute;curit&eacute; 
    ne change. Voir <a 
href="http://www.openbsd.org/cgi-bin/man.cgi?query=init&amp;sektion=8">init(8)</a> 
  <li>/etc/rc.shutdown - Script ex&eacute;cut&eacute; lors de l'arr&ecirc;t de 
    la machine. Mettez tout ce que vous voulez ex&eacute;cuter avant l'arr&ecirc;t 
    de la machine dans ce fichier. Voir <a 
href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc.shutdown&amp;sektion=8">rc.shutdown(8)</a> 
d154 6
a159 5
<p><i>/etc/rc.conf</i> (or <i>/etc/rc.conf.local</i>),<i>/etc/rc.local</i> et <i>/etc/rc.shutdown</i>. 
  Les principaux 
  fichiers &agrave; conna&icirc;tre par l'administrateur syst&egrave;me. Pour 
  comprendre le fonctionnement de la proc&eacute;dure rc(8), en voici le d&eacute;roulement 
  : 
d161 2
a162 1
<p><i>/etc/rc </i>est appel&eacute; apr&egrave;s le d&eacute;marrage du noyau :
d164 7
a170 6
  <li>Les syst&egrave;mes de fichiers sont v&eacute;rifi&eacute;s. Cette v&eacute;rification 
    n'aura pas lieu si le fichier /etc/fastboot existe. Ce n'est certainement 
    pas une bonne id&eacute;e.
  <li>Les variables de configuration sont lues &agrave; partir de <i>/etc/rc.conf</i> et
    ensuite <i>/etc/rc.conf.local</i>. Les param&egrave;tres dans rc.local.conf vont 
    surpasser ceux se trouvant dans rc.conf.
d172 4
a175 2
  <li><i>/tmp </i>est nettoy&eacute; et les fichiers d'&eacute;diteurs sont pr&eacute;serv&eacute;s
  <li>Le r&eacute;seau est configur&eacute; &agrave; l'aide de <i>/etc/netstart</i>
d178 2
a179 3
      <li>Le nom d'h&ocirc;te et le nom de domaine (ainsi que d'autres param&egrave;tres) 
        sont positionn&eacute;s 
  </ul>
d181 4
a184 2
  <li>Diverses v&eacute;rifications sont effectu&eacute;es (quota, savecore, etc).
  <li>Les services locaux sont d&eacute;marr&eacute;s &agrave; partir de <i>/etc/rc.local</i>
d189 8
a196 6
<p>La plupart des services fournis par d&eacute;faut avec OpenBSD sont lanc&eacute;s 
  au d&eacute;marrage simplement en modifiant le fichier de configuration <i>/etc/rc.conf</i>. 
  Pour commencer, jetez un coup d'oeil au fichier <a 
href="http://www.openbsd.org/cgi-bin/cvsweb/src/etc/rc.conf">/etc/rc.conf</a> 
  par d&eacute;faut. Vous verrez des lignes similaires &agrave; la ligne suivante 
  :
d202 11
a212 9
<p>Une ligne telle que celle-ci montre que ftpd n'est pas lanc&eacute; au d&eacute;marrage 
  du syst&egrave;me (du moins pas &agrave; travers rc(8), lisez la <a href="faq10.html#AnonFTP">FAQ 
  Serveur FTP Anonyme</a> pour plus d'informations). Dans tous les cas, chaque 
  ligne est dot&eacute;e d'un commentaire qui vous montrent les drapeaux utilis&eacute;s 
  dans le cadre d'une utilisation <b>NORMALE </b>du service. Cela ne veut pas 
  dire que vous devez appeler ce service avec ces m&ecirc;mes drapeaux. Vous pouvez 
  toujours utiliser man(1) pour savoir comment d&eacute;marrer un service donn&eacute; 
  de la mani&egrave;re que vous souhaitez. Par exemple, voici la ligne par d&eacute;faut 
  concernant httpd(8) :
d217 17
a233 12
<p>D'apr&egrave;s cet exemple, vous pouvez voir qu'aucun drapeau n'est n&eacute;cessaire 
  pour d&eacute;marrer httpd normalement. Ainsi, la ligne &quot;<b> httpd_flags=""</b> 
  suffit. Mais pour d&eacute;marrer httpd avec le support ssl (Reportez vous &agrave; 
  la <a href="#HTTPS">FAQ SSL</a> ou &agrave; <a 
href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssl&amp;sektion=8">ssl(8)</a>), 
  vous devez d&eacute;marrer httpd avec une ligne comme celle-ci : &quot;httpd_flags="-DSSL"&quot;.

<p>Une autre approche serait de ne jamais toucher &agrave;
  <i>/etc/rc.conf</i>. Au contraire, cr&eacute;ez le fichier <i>/etc/rc.conf.local</i> 
  et ne copiez que les lignes que vous comptez changer dans <i>/etc/rc.conf</i> et 
  modifiez-les comme vous voulez. Ceci peut rendre vos mises &agrave; jour
  futures plus faciles -- tous les changements se trouvant dans un fichier.
d237 8
a244 5
<p>Pour les services que vous installez via la collection de ports ou d'autres 
  m&eacute;thodes, vous devez utiliser le fichier <i>/etc/rc.local</i>. Par exemple, 
  j'ai install&eacute; un service fourni par l'applicatif /usr/local/sbin/daemonx. 
  Je souhaite que ce service soit lanc&eacute; au d&eacute;marrage. Pour cela, 
  je rajoute les lignes suivantes dans <i>/etc/rc.local</i> :
d253 2
a254 2
d&eacute;marrage, souvenez-vous de rajouter "&amp;" &agrave; la fin
de la commande.) 
d256 4
a259 4

<p>A partir de l&agrave;, ce service sera lanc&eacute; au d&eacute;marrage. Vous 
  pourrez voir toutes les erreurs au d&eacute;marrage. Un d&eacute;marrage normal 
  sans erreurs affichera le message suivant : 
d266 8
a273 5
<p> <i>/etc/rc.shutdown</i> est un script ex&eacute;cut&eacute; &agrave; l'arr&ecirc;t 
  de la machine. Toutes les t&acirc;ches &agrave; effectuer avant l'arr&ecirc;t 
  du syst&egrave;me devront &ecirc;tre ajout&eacute;es &agrave; ce fichier. Si 
  vous avez apm, vous pouvez aussi positionner &quot;powerdown=YES&quot;. C'est 
  l'&eacute;quivalent de &quot;shutdown -p&quot;.
d276 3
a278 2
<h2>10.4 - Pourquoi les utilisateurs sont interdits de relais quand ils envoient 
  des mails &agrave; distance &agrave; travers mon syst&egrave;me OpenBSD ?</h2>
d280 2
a281 1
<p> Essayez ceci : 
d287 2
a288 1
<p>Le r&eacute;sultat ressemblerait &agrave; la ligne suivante :
d294 4
a297 2
<p> Si ce fichier n'existe pas, cr&eacute;ez le. Vous devez saisir les h&ocirc;tes 
  qui envoient des messages &agrave; distance en respectant la syntaxe suivante :
d305 5
a309 2
<p>N'oubliez pas d'envoyer un signal 'HangUP' &agrave; sendmail (signal qui notifie 
  la plupart des processus de relire leur fichier de configuration) :
d326 4
a329 2
<h2>10.5 - J'ai mis en place POP, mais j'ai des erreurs quand j'acc&egrave;de 
  &agrave; ma messagerie via POP. Que puis-je faire ? </h2>
d331 5
a335 5
La plupart des probl&egrave;mes rencontr&eacute;s avec POP sont li&eacute;s aux 
fichiers temporaires et aux fichiers verrous. Si votre serveur POP renvoie une 
erreur du type : 
<blockquote>
<pre>
d337 6
a342 5
</pre>
</blockquote>
<p>Essayez de positionner les permissions comme suit :
<blockquote>
<pre>
d349 32
a380 23
</pre>
</blockquote>
<p>V&eacute;rifiez aussi que l'utilisateur poss&egrave;de son propre fichier /var/mail. 
  Bien &eacute;videmment, ceci devrait &ecirc;tre le cas (comme par exemple l'utilisateur 
  joe qui poss&egrave;de /var/mail/joe) mais si &ccedil;a n'a pas &eacute;t&eacute; 
  configur&eacute; proprement, le probl&egrave;me viendrait de l&agrave; !
<p>Bien entendu, si vous donner l'acc&egrave;s &agrave; /var/mail en &eacute;criture 
  au groupe mail, vous allez probablement vous exposer &agrave; des vagues et 
  obscurs probl&egrave;mes de s&eacute;curit&eacute;. Il se pourrait que &ccedil;a 
  ne pose aucun probl&egrave;me mais on ne sait jamais (et particuli&egrave;rement 
  si vous &ecirc;tes un site de haut vol, un FAI,...) ! Il existe plusieurs
  services POP de la collection de ports OpenBSD. Si possible, utilisez
  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=popa3d&amp;sektion=8">popa3d(8)</a> 
  disponible dans le syst&egrave;me de base d'OpenBSD. 
  Ou peut-&ecirc;tre vous 
  avez s&eacute;lectionn&eacute; les mauvaises options pour votre programme POP 
  serveur (comme le dot locking). Ou vous avez peut-&ecirc;tre simplement besoin 
  de changer le r&eacute;pertoire dans lequel les verrous sont cr&eacute;es (bien 
  que les op&eacute;rations de verrouillage ne devraient &ecirc;tre b&eacute;n&eacute;fiques 
  qu'au service POP). 
<p><b>PS:</b> Il est &agrave; noter que OpenBSD n'a pas de groupe &quot;mail&quot;. 
  Vous devez en cr&eacute;er un, si n&eacute;cessaire, 
  dans le fichier <i>/etc/group</i>. La ligne suivante devrait suffire :
a384 1

d387 3
a389 1
<h2>10.6 - Pourquoi Sendmail ignore-t-il le fichier <tt>/etc/hosts</tt> ?</h2>
d391 3
a393 3
Par defaut, Sendmail utilise le DNS pour la r&eacute;solution de nom, non le
fichier <tt>/etc/hosts</tt>. Ce comportement peut &ecirc;tre chang&eacute; 
par l'usage du fichier <tt>/etc/mail/service.switch</tt>. 
d396 4
a399 3
Si vous d&eacute;sirez interroger le fichier d'h&ocirc;tes avant les serveurs 
DNS, cr&eacute;ez un fichier <tt>/etc/mail/service.switch</tt> contenant les
lignes suivantes :
d403 5
a407 2
Si vous d&eacute;sirez interroger QUE le le fichier d'h&ocirc;tes, utilisez
ce qui suit :
d411 2
d414 1
d418 2
d425 2
a426 1
<h2>10.7 - Configurer HTTP en mode s&eacute;curis&eacute; &agrave; l'aide de SSL(8)</h2>
d429 17
a445 14
OpenBSD est fourni avec des librairies RSA et un service httpd supportant SSL.
Pour utiliser SSL avec <a 
href="http://www.openbsd.org/cgi-bin/man.cgi?query=httpd&amp;sektion=8">httpd(8)</a>, 
  vous devez d'abord cr&eacute;er un certificat. Ce certificat sera stock&eacute; 
  dans <i>/etc/ssl/private/</i>. Les &eacute;tapes d&eacute;crites ici sont en 
  partie prises de la page de manuel <a 
href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssl&amp;sektion=8">ssl(8)</a>. 
  Lisez la pour plus d'informations. Cette partie de la FAQ s'int&eacute;resse 
  seulement &agrave; la g&eacute;n&eacute;ration d'un certificat RSA pour les 
  serveurs Web. Elle ne d&eacute;crit pas les certificats serveur DSA. Pour plus 
  d'informations &agrave; ce sujet, lisez la page de manuel <a 
href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssl&amp;sektion=8">ssl(8)</a>.
<p>Pour commencer, vous aurez besoin de cr&eacute;er votre cl&eacute; serveur 
  et le certificat en utilisant OpenSSL :
d453 4
a456 2
<p>Ou si vous voulez que la cl&eacute; soit crypt&eacute;e avec un mot de passe 
  que vous devez saisir &agrave; chaque d&eacute;marrage des serveurs
d464 5
a468 4
<p>La prochaine &eacute;tape consiste &agrave; g&eacute;n&eacute;rer une requ&ecirc;te 
  de signature de certificat qui est utilis&eacute;e pour permettre &agrave; une 
  autorit&eacute; de certification (CA) de signer votre certificat. Pour cela, 
  utilisez la commande suivante : 
d476 6
a481 6
<p>Le fichier <i>server.csr</i> pourra alors &ecirc;tre communiqu&eacute; &agrave; 
  une autorit&eacute; de certification qui signera la cl&eacute;. Une de ces autorit&eacute;s 
  est <b>Thawte Certification</b> que vous pourrez joindre &agrave; l'adresse 
  <a href="http://www.thawte.com/">http://www.thawte.com/</a>. Thawte peut actuellement 
  signer vos cl&eacute;s RSA keys. Une proc&eacute;dure est entrain d'&ecirc;tre 
  mise en place pour permettre la signature des cl&eacute;s DSA.
d483 3
a485 2
<p>Si vous ne pouvez pas vous permettre un tel service, ou si vous voulez auto 
  signer le certificat, vous pouvez utiliser la commande suivante :
d494 7
a500 6
<p> Avec <i>/etc/ssl/server.crt</i> et <i>/etc/ssl/private/server.key</i>, vous 
  devez &ecirc;tre d&eacute;sormais capable de d&eacute;marrer <a 
href="http://www.openbsd.org/cgi-bin/man.cgi?query=httpd&amp;sektion=8">httpd(8)</a> 
  avec le drapeau <b>-DSSL</b> (consultez la <a href=#rc">section &agrave; propos d'rc(8) dans cette faq</a>), 
  activant ainsi les transactions https sur le port 
  443 de votre machine. 
d504 3
a506 2
<h2>10.7 - J'ai effectu&eacute; des changements dans /etc/passwd avec vi(1), mais 
  les changements ne semblent pas &ecirc;tre pris en compte. Pourquoi ?</h2>
d508 7
a514 5
<p>Si vous &eacute;ditez <i>/etc/passwd</i>, vos modifications seront perdues. OpenBSD 
  g&eacute;n&egrave;re <i>/etc/passwd</i> dynamiquement avec <a 
href="http://www.openbsd.org/cgi-bin/man.cgi?query=pwd_mkdb&amp;sektion=8">pwd_mkdb(8)</a>. 
  Le fichier principal de mots de passe sous OpenBSD est <i>/etc/master.passwd</i>. D'apr&egrave;s 
  pwd_mkdb(8), 
d516 1
a516 2
<blockquote>
<pre>
d524 24
a547 19
</pre>
</blockquote>
<p>Dans un fichier de mots de passe Unix traditionnel, toutes les informations 
  y compris le mot de passe crypt&eacute; de l'utilisateur sont &agrave; la disposition 
  de n'importe quel utilisateur du syst&egrave;me (et c'est la cible principale 
  de programmes tels que Crack). 4.4BSD a introduit le fichier master.passwd qui 
  a un format &eacute;tendu (avec les options additionnelles par rapport &agrave; 
  /etc/passwd). Ce fichier n'est accessible que pour root. Pour un acc&egrave;s 
  plus rapide aux donn&eacute;es, les appels &agrave; la librairie qui utilisent 
  ce type d'informations acc&egrave;dent normalement &agrave; /etc/pwd.db et &agrave; 
  /etc/spwd.db.
<p>OpenBSD met &agrave; votre disposition un outil qui vous permet d'&eacute;diter 
  le fichier de mots de passe. Cet outil s'appelle vipw(8). vipw utilisera vi 
  (ou votre &eacute;diteur favori tel que d&eacute;fini par $EDITOR) pour &eacute;diter 
  /etc/master.passwd. Suite &agrave; vos modifications, vipw recr&eacute;era /etc/passwd, 
  /etc/pwd.db, et /etc/spwd.db qui tiendront compte de vos modifications. vipw 
  verrouille aussi l'acc&egrave;s &agrave; ces fichiers de telle fa&ccedil;on 
  &agrave; en interdire l'acc&egrave;s &agrave; quiconque essaie d'en changer 
  le contenu en m&ecirc;me temps que vous.
d551 2
a552 2
<h2>10.8 - Comment je cr&eacute;e un compte utilisateur ? Ou je supprime un compte 
  utilisateur ?</h2>
d558 2
a559 2
	<li><a href="#adduser">adduser(8)</a>
	<li><a href="#user">user(8)</a>
d563 20
a582 15
<p>La mani&egrave;re la plus facile pour cr&eacute;er un compte utilisateur sous OpenBSD 
  est d'utiliser le script <a 
href="http://www.openbsd.org/cgi-bin/man.cgi?query=adduser&amp;sektion=8">adduser(8)</a>. 
  Ce script est param&eacute;trable &agrave; travers le fichier <i>/etc/adduser.conf</i>. 
  Bien que c'est la m&eacute;thode recommand&eacute;e pour cr&eacute;er des comptes 
  utilisateurs, il est toujours possible de les cr&eacute;er &agrave; la main 
  en utilisant <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>. 
  adduser(8) permet d'effectuer des v&eacute;rifications sur la coh&eacute;rence 
  de <i>/etc/passwd</i>, <i>/etc/group</i>, et les bases de donn&eacute;es shell. 
  adduser(8) cr&eacute;e pour vous les entr&eacute;es correspondantes et les r&eacute;pertoires 
  $HOME. Il peut aussi envoyer un message de bienvenue aux utilisateurs. Le comportement 
  de ce programme peut &ecirc;tre adapt&eacute; &agrave; vos besoins. Pour illustrer 
  notre propos, prenons comme exemple la cr&eacute;ation du compte <b>testuser</b>. 
  Le r&eacute;pertoire de cet utilisateur sera plac&eacute; sous <i>/home/testuser</i>. 
  L'utilisateur aura <b>guest </b>comme groupe et <i>/bin/ksh </i>comme shell.
d588 1
d594 22
a615 19
Enter username [a-z0-9_]: <strong>testuser</strong>
Enter full name []: <strong>Test FAQ User</strong>
Enter shell csh ksh nologin sh [ksh]: <strong>ksh</strong>
Uid [1002]: <strong>&lt;Enter&gt;</strong>
Login group testuser [testuser]: <strong>guest</strong>
Login group is ``guest''. Invite testuser into other groups: guest no
[no]: <strong>no</strong>
Enter password []: 
Enter password again []:

Name:     testuser
Password: ****
Fullname: Test FAQ User
Uid:      1002
Gid:      31 (guest)
Groups:   guest
HOME:     /home/testuser
Shell:    /bin/ksh
OK? (y/n) [y]: <strong>y</strong>
d617 2
a618 2
Copy files from /usr/share/skel to /home/testuser
Add another user? (y/n) [y]: <strong>n</strong>
d622 2
a623 1
<p>Pour supprimer des comptes utilisateurs, utilisez la commande 
d625 10
a634 9
Cette commande supprimera toute chose relative &agrave; l'utilisateur. Elle 
supprimera son entr&eacute;e <a 
href="http://www.openbsd.org/cgi-bin/man.cgi?query=crontab&amp;sektion=1">crontab(1)</a>, 
son r&eacute;pertoire $HOME (s'il lui appartient), et son courrier. Bien &eacute;videmment, 
cette commande supprimera aussi les entr&eacute;es correspondantes dans <i>/etc/passwd</i> 
et <i>/etc/group</i>. Comme exemple, nous allons utiliser cette commande 
pour supprimer le compte utilisateur pr&eacute;c&eacute;demment cr&eacute;e. 
Notez que la commande vous demande l'identifiant du compte et si oui ou non 
elle doit supprimer le r&eacute;pertoire home de l'utilisateur.
d641 2
a642 1
testuser:$2a$07$ZWnBOsbqMJ.ducQBfsTKUe3PL97Ve1AHWJ0A4uLamniLNXLeYrEie:1002:31::0:0:Test FAQ User:/home/testuser:/bin/ksh
d653 1
d655 2
a656 3
Ces outils 
sont moins interactifs que la commande <a 
href="http://www.openbsd.org/cgi-bin/man.cgi?query=adduser&amp;sektion=8">adduser(8)</a>, 
d658 1
d662 10
a671 10
  <li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=group&amp;sektion=8">group(8)</a> 
  <li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=groupadd&amp;sektion=8">groupadd(8)</a> 
  <li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=groupdel&amp;sektion=8">groupdel(8)</a> 
  <li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=groupinfo&amp;sektion=8">groupinfo(8)</a> 
  <li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=groupmod&amp;sektion=8">groupmod(8)</a> 
  <li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=user&amp;sektion=8">user(8)</a> 
  <li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=useradd&amp;sektion=8">useradd(8)</a> 
  <li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=userdel&amp;sektion=8">userdel(8)</a> 
  <li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=userinfo&amp;sektion=8">userinfo(8)</a> 
  <li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=usermod&amp;sektion=8">usermod(8)</a> 
d676 15
a690 12
<p>Etant donn&eacute; que la commande user(8) n'est pas interactive, la mani&egrave;re 
  la plus simple et la plus efficace pour cr&eacute;er des comptes utilisateurs 
  est d'utiliser la commande adduser(8). La commande <i>/usr/sbin/user</i> est 
  seulement une interface aux autres commandes <i>/usr/sbin/user*</i>. Ainsi, 
  dans l'exemple qui suit il est possible d'utiliser soit <b>user add</b>soit 
  <b>useradd</b>. Le choix est votre et ne change rien au r&eacute;sultat.
<p>Dans cet exemple, nous allons cr&eacute;er un compte avec les m&ecirc;mes sp&eacute;cificit&eacute;s 
  que le compte cr&eacute;e <a href="#adduser">pr&eacute;c&eacute;demment</a>. 
  useradd(8) est bien plus facile &agrave; utiliser si vous connaissez les param&egrave;tres 
  par d&eacute;faut avant de cr&eacute;er un compte utilisateur. Ces param&egrave;tres 
  se trouvent dans le fichier <i>/etc/usermgmt.conf </i>et peuvent &ecirc;tre 
  visualis&eacute;s comme suit :
d703 16
a718 11
<p>Ces param&egrave;tres vont &ecirc;tre appliqu&eacute;s &agrave; chaque nouveau 
  compte si vous ne changez pas leur valeur en utilisant des options en ligne 
  de commande. Par exemple, dans notre cas nous voulons que l'utilisateur appartienne 
  au groupe <b>guest </b> et non pas &agrave; <b>users</b>. Il est &agrave; noter 
  que lors de la cr&eacute;ation des comptes utilisateurs, les mots de passe doivent 
  &ecirc;tre sp&eacute;cifi&eacute;s sous leur forme crypt&eacute;e en ligne de 
  commande. Vous devez donc utiliser, au pr&eacute;alable, l'utilitaire <a 
href="http://www.openbsd.org/cgi-bin/man.cgi?query=encrypt&amp;sektion=1">encrypt(1)</a> 
  pour cr&eacute;er le mot de passe. Par exemple : Les mots de passe par d&eacute;faut 
  sous OpenBSD utilisent l'algorithme Blowfish avec 6 r&eacute;it&eacute;rations. 
  Voici un exemple d'utilisation de la commande encrypt : 
d725 3
a727 2
<p> Maintenant que nous avons le mot de passe crypt&eacute;, nous sommes pr&ecirc;ts 
  &agrave; cr&eacute;er le compte utilisateur :
d734 16
a749 9
<p><b>Remarque :</b> Assurez vous d'utiliser &quot; pour englober le mot de passe. 
  L'utilisation de &quot;&quot; ne permet pas d'emp&ecirc;cher le shell d'interpr&eacute;ter 
  le jeu de caract&egrave;res correspondant au mot de passe avant de les communiquer 
  &agrave; user(8). De m&ecirc;me, assurez vous d'utiliser l'option <b>-m </b>si 
  vous voulez cr&eacute;er le r&eacute;pertoire $HOME de l'utilisateur et copier 
  les fichiers &agrave; partir de <i>/etc/skel</i> vers $HOME.
<p>Pour voir si le compte utilisateur a &eacute;t&eacute; correctement cr&eacute;e, 
  nous pouvons recourir &agrave; plusieurs utilitaires. Voici quelques commandes 
  pour v&eacute;rifier rapidement que tout s'est bien pass&eacute; : 
d767 5
a771 3
<p>En plus de ces commandes, user(8) fournit son propre utilitaire, appel&eacute; 
  userinfo(8), qui permet d'afficher les caract&eacute;ristiques d'un compte utilisateur 
  : 
d788 5
a792 3
<p>Pour supprimer des comptes utilisateurs avec la hi&eacute;rarchie de commandes 
  user(8), vous devez utiliser userdel(8). Cette commande est simple et efficace. 
  Pour supprimer le compte pr&eacute;c&eacute;demment cr&eacute;e, utilisez : 
d799 6
a804 4
<p>Notez bien l'option <b>-r</b> qui doit &ecirc;tre sp&eacute;cifi&eacute;e si 
  vous voulez supprimer les r&eacute;pertoires $HOME aussi. Si vous voulez juste 
  bloquer l'acc&egrave;s au compte sans supprimer des informations li&eacute;es 
  au compte, utilisez <b>-p</b> au lieu de <b>-r</b>.
d808 2
a809 1
<h2>10.10 - Comment puis-je cr&eacute;er un compte pour ftp uniquement ?</h2>
d811 19
a829 15
<p>Il y a plusieurs m&eacute;thodes pour effectuer cette op&eacute;ration. Une 
  des mani&egrave;res les plus communes est d'ajouter <i>/usr/bin/false </i> dans 
  le fichier <i>/etc/shells</i>. Et quand vous cr&eacute;ez le compte utilisateur, 
  attribuez lui le shell /usr/bin/false. Il sera alors capable d'utiliser les 
  fonctionnalit&eacute;s ftp sans pour autant &ecirc;tre capable de se connecter 
  de mani&egrave;re interactive. Par d&eacute;faut, <a 
href="http://www.openbsd.org/cgi-bin/man.cgi?query=adduser&amp;sektion=8">adduser(8)</a> 
  affecte &agrave; l'utilisateur le r&eacute;pertoire <i>/home/&lt;user&gt;</i>. 
  Si c'est ce que vous souhaitez, laissez-le tel quel. Cependant, vous pouvez 
  affecter &agrave; l'utilisateur le r&eacute;pertoire que vous souhaitez. De 
  m&ecirc;me, vous pouvez confiner l'utilisateur &agrave; son r&eacute;pertoire 
  $HOME en ajoutant son nom &agrave; <i>/etc/ftpchroot</i>. En utilisant l'option 
  <b>-A</b> de <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&amp;sektion=8">ftpd(8)</a>, 
  seuls les comptes list&eacute;s dans ce fichier seront autoris&eacute;s &agrave; 
  se connecter !
d835 6
a840 23
<p>Les quotas sont utilis&eacute;s pour limiter l'espace disque disponible pour 
  les utilisateurs. Ce syst&egrave;me peut &ecirc;tre tr&egrave;s utile si vous 
  avez des ressources limit&eacute;es. Les quotas peuvent &ecirc;tre 
  configur&eacute;s par utilisateur et/ou par groupe.


<p>La premi&egrave;re &eacute;tape pour configurer les quotas est de s'assurer 
  que <tt>option QUOTA</tt> est pr&eacute;sente dans votre 
  <a href="faq5.html#Options">configuration noyau</a>. 
  Cette option est incluse dans le noyau GENERIC. Ensuite, vous aurez besoin de 
  marquer les syst&egrave;mes de fichiers o&ugrave; les quotas sont utilis&eacute;s 
  dans le fichier <a 
  href="http://www.openbsd.org/cgi-bin/man.cgi?query=fstab&amp;sektion=5"><tt>/etc/fstab</tt></a>. 
  Les mots cl&eacute;s <tt>userquota</tt> et 
  <tt>groupquota</tt> doivent &ecirc;tre utilis&eacute;s pour marquer chaque syst&egrave;me 
  de fichiers o&ugrave; les quotas sont activ&eacute;s. Par d&eacute;faut, les 
  fichiers <tt>quota.user</tt> et <tt>quota.group</tt> seront cr&eacute;es &agrave; 
  la racine des syst&egrave;mes de fichiers o&ugrave; les quotas sont utilis&eacute;s 
  pour stocker les informations relatives &agrave; ces derniers. Si vous voulez 
  les cr&eacute;er ailleurs, sp&eacute;cifiez un fichier avec l'option des quotas 
  dans <tt>/etc/fstab</tt>, par exemple "<tt>userquota=/var/quotas/quota.user</tt>". 
  Voici un exemple de <tt>/etc/fstab</tt> avec un syst&egrave;me de fichiers avec quotas 
  activ&eacute;s et le fichier de quotas se trouvant dans un endroit non-standard :
d842 24
a865 2
<blockquote>
<pre>
d867 10
a876 2
</pre>
</blockquote>
d878 1
a878 9
<p>Maintenant, il faut configurer les quotas par utilisateur. A cette fin, nous 
  utilisons la commande <a 
href="http://www.openbsd.org/cgi-bin/man.cgi?query=edquota&amp;sektion=8">edquota(8)</a>. 
  Une utilisation simple est <strong>edquota&nbsp;&lt;user&gt;</strong>. edquota(8) 
  va utiliser vi(1) pour &eacute;diter les quotas &agrave; moins que la variable 
  d'environnement EDITOR est positionn&eacute;e pour charger un autre &eacute;diteur. 
  Par exemple la commande :
<blockquote>
<pre>
d880 1
a880 2
</pre>
</blockquote>
d882 2
a883 1
<p>Affichera un r&eacute;sultat similaire &agrave; :
d885 1
a885 2
<blockquote>
<pre>
d888 2
a889 3
	inodes in use: 25, limits (soft = 0, hard = 0)
</pre>
</blockquote>
d891 3
a893 2
<p>Pour ajouter des limites, &eacute;diter l&agrave; pour donner un r&eacute;sultat 
  similaire &agrave; :
d895 1
a895 2
<blockquote>
<pre>
d898 2
a899 3
	inodes in use: 25, limits (soft = 0, hard = 0)
</pre>
</blockquote>
d902 18
a919 16
  Notez que l'allocation de quotas est en blocs de 1k.
  Dans ce cas-ci, softlimit est fix&eacute; &agrave; 1000k et 
  hardlimit &agrave; 1050k.
  softlimit est une limite qui permet au syst&egrave;me de 
  pr&eacute;venir les utilisateurs quand ils l'ont d&eacute;pass&eacute;. Ils 
  auront alors jusqu'&agrave; la fin de leur p&eacute;riode de gr&acirc;ce pour 
  redescendre en dessous de cette limite. Les p&eacute;riodes de gr&acirc;ce peuvent 
  &ecirc;tre configur&eacute;es &agrave; l'aide de l'option <b>-t </b> de edquota(8). 
  Apr&egrave;s la fin de la p&eacute;riode de gr&acirc;ce, softlimit est g&eacute;r&eacute; 
  comme hardlimit. Ce qui cause un &eacute;chec d'allocation. 
<p>Une fois les quotas configur&eacute;s, il faut les activer. Pour cela, utilisez 
  la commande <a 
href="http://www.openbsd.org/cgi-bin/man.cgi?query=quotaon&amp;sektion=8">quotaon(8)</a>. 
  Par exemple :
<blockquote>
<pre>
d921 12
a932 2
</pre>
</blockquote>
d934 1
a934 9
<p>Cette commande analysera le contenu de <tt>/etc/fstab</tt> et activera les quotas sur 
  les syst&egrave;mes de fichiers o&ugrave; les options de quota sont positionn&eacute;es. 
  Maintenant que les quotas sont activ&eacute;s, vous pouvez les visualiser &agrave; 
  l'aide de <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=quota&amp;sektion=1">quota(1)</a>. 
  Ainsi, la commande <strong>quota &lt;user&gt;</strong> fournit les informations 
  concernant cet utilisateur. Si aucun argument n'est utilis&eacute;, quota vous 
  fournira des statistiques sur les quotas. Par exemple :
<blockquote>
<pre>
d936 1
a936 2
</pre>
</blockquote>
d938 2
a939 1
<p>Afficherait :
d941 1
a941 2
<blockquote>
<pre>
d945 1
a945 2
</pre>
</blockquote>
d947 4
a950 2
<p>Par d&eacute;faut, les quotas positionn&eacute;s dans <tt>/etc/fstab</tt> seront activ&eacute;s 
  au d&eacute;marrage. Pour les d&eacute;sactiver, utilisez :
d965 1
a965 1
Pour plus d'information concernant KerberosV, sur votre syst&egrave;me 
d976 35
a1010 27
<p>Le mode FTP anonyme permet &agrave; des utilisateurs sans compte d'acc&eacute;der 
  aux fichiers sur votre machine en utilisant le protocole de transfert de fichiers. 
  Ce chapitre a pour but de fournir une vue d'ensemble de la configuration d'un 
  serveur FTP anonyme, les logs g&eacute;n&eacute;r&eacute;s, ...etc.

<h3>Cr&eacute;ation du compte FTP account</h3>

<p>La premi&egrave;re &eacute;tape consiste &agrave; cr&eacute;er un compte &quot;ftp&quot; 
  sur votre syst&egrave;me. Ce compte ne doit pas avoir de mot de passe utilisable. 
  Dans cet exemple, nous allons consid&eacute;rer que /home/ftp est le r&eacute;pertoire 
  correspondant au compte &quot;ftp&quot; mais vous n'&ecirc;tes pas oblig&eacute; 
  de choisir la m&ecirc;me chose. Quand le mode anonyme est utilis&eacute;, le 
  d&eacute;mon ftp va se confiner au r&eacute;pertoire HOME de l'utilisateur 'ftp' 
  (dans notre cas, ce r&eacute;pertoire est /home/ftp). Pour en savoir plus, lisez 
  les pages du manuel <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&amp;sektion=8">ftp(8)</a> 
  et <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=chroot&amp;sektion=2">chroot(2)</a>. 
  Voici un exemple de cr&eacute;ation du compte <i>ftp</i> en utilisant la commande 
  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=adduser&amp;sektion=8">adduser(8)</a>. 
  Au pr&eacute;alable, nous avons besoin d'ajouter /usr/bin/false au fichier <i>/etc/shells</i>. 
  C'est le shell que nous allons attribuer &agrave; l'utilisateur ftp. Il ne permettra 
  pas de connexion en login &agrave; ce compte m&ecirc;me si nous configurons 
  un mot de passe vide. Pour effectuer cette op&eacute;ration, il suffit de faire 
  <i>echo /usr/bin/false &gt;&gt; /etc/shells</i>. Si en plus vous souhaitez que 
  ce shell apparaisse dans la liste des choix propos&eacute;s par adduser, vous 
  devez modifier le fichier <i>/etc/adduser.conf</i>. 
<blockquote>
<pre>
d1012 1
a1012 1
Use option ``-silent'' if you don't want see all warnings &amp; questions.
d1015 1
d1021 22
a1042 19
Enter username [a-z0-9_]: <strong>ftp</strong>
Enter full name []: <strong>anonymous ftp</strong>
Enter shell csh false ksh nologin sh tcsh zsh [sh]: <strong>false</strong>
Uid [1002]:
Login group ftp [ftp]:
Login group is ``ftp''. Invite ftp into other groups: guest no
[no]: <strong>no</strong>
Enter password []:
Set the password so that user cannot logon? (y/n) [n]: <strong>y</strong>

Name:     ftp
Password: ****
Fullname: anonymous ftp
Uid:      1002
Gid:      1002 (ftp)
Groups:   ftp
HOME:     /home/ftp
Shell:    /usr/bin/false
OK? (y/n) [y]: <strong>y</strong>
d1044 2
a1045 2
Copy files from /usr/share/skel to /home/ftp
Add another user? (y/n) [y]: <strong>n</strong>
d1047 1
a1047 2
</pre>
</blockquote>
d1051 7
a1057 5
<p>L'op&eacute;ration a cr&eacute;e, en plus de l'utilisateur, le r&eacute;pertoire 
  <i>/home/ftp</i>. C'est ce que nous voulons mais nous avons besoin d'effectuer 
  quelques modifications pour pr&eacute;parer le syst&egrave;me &agrave; h&eacute;berger 
  le service FTP anonyme. Ces modifications sont expliqu&eacute;es dans la page 
  du manuel <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&amp;sektion=8">ftp(8)</a>. 
d1060 3
a1062 2
<b>Vous n'avez pas besoin</b> de cr&eacute;er un r&eacute;pertoire /home/ftp/usr 
  ou /home/ftp/bin.
d1064 1
a1064 1
  <li><i>/home/ftp</i> - C'est le r&eacute;pertoire principal. Il doit &ecirc;tre 
d1066 16
a1081 13
  <li><i>/home/ftp/etc</i> - Ce r&eacute;pertoire est optionnel et non recommand&eacute;. 
    Son seul but est de fournir des informations sur les comptes utilisateurs 
    existant. Si vous voulez que les fichiers de votre r&eacute;pertoire de ftp 
    soient associ&eacute;s &agrave; de vrais utilisateurs, vous devez copier /etc/pwd.db 
    et /etc/group dans ce r&eacute;pertoire. Les permissions du r&eacute;pertoire 
    doivent &ecirc;tre 511. Les permissions sur les deux fichiers doivent &ecirc;tre 
    444. Ils sont utilis&eacute;s pour fournir une correspondance entre des nombres 
    et les noms attribu&eacute;s aux comptes utilisateurs et groupes. Il n'y a 
    pas de mots de passe dans pwd.db. Tous les mots de passe sont stock&eacute;s 
    dans spwd.db alors ne copiez pas ce fichier.
  <li><i>/home/ftp/pub</i> - C'est le r&eacute;pertoire standard pour mettre les 
    fichiers que vous voulez partagez. Ce r&eacute;pertoire doit avoir les permissions 
    555. 
d1084 7
a1090 5
<p>Il est &agrave; noter que tous ces r&eacute;pertoires doivent &ecirc;tre la 
  propri&eacute;t&eacute; de &quot;root&quot;. Voici &agrave; quoi doivent ressembler 
  les r&eacute;pertoires apr&egrave;s leur cr&eacute;ation :
<blockquote>
<pre>
d1111 1
a1111 2
</pre>
</blockquote>
d1115 9
a1123 6
<p>Vous pouvez choisir d'ex&eacute;cuter ftpd soit &agrave; partir de inetd soit 
  directement de le lancer directement via les scripts rc. L'exemple ci-apr&egrave;s 
  repr&eacute;sente le cas o&ugrave; le service est d&eacute;marr&eacute; &agrave; 
  partir de <a href="http://www.openbsd.org/cgi-bin/cvsweb/src/etc/inetd.conf">inetd.conf</a>. 
  Tout d'abord, nous devons nous familiariser avec quelques options de ftpd. La 
  ligne par d&eacute;faut dans <i>/etc/inetd.conf</i> est :
d1128 29
a1156 20
<p>Comme vous pouvez le voir, ftpd est invoqu&eacute; avec <i>-US</i>. Ces options 
  vont permettre de loguer les connexions anonymes dans <i>/var/log/ftpd </i>et 
  les sessions courantes dans <i>/var/run/utmp</i>. Ce qui permet de voir ces 
  sessions via who(1). Dans certains cas, on souhaitera fournir un acc&egrave;s 
  anonyme et d&eacute;sactiver ftp pour les utilisateurs du syst&egrave;me. Pour 
  cela, il faut utiliser l'option <i>-A </i>de ftpd. Voici une ligne d'invocation 
  de ftpd en mode anonyme exclusif. On utilise aussi <i>-ll</i> qui logue chaque 
  connexion vers syslog en plus des commandes ftp get, retrieve, etc.
<blockquote><pre>
<strong>ftp             stream  tcp     nowait  root    /usr/libexec/tcpd       ftpd -llUSA</strong>
</pre></blockquote>

<p> Remarque - Les personnes g&eacute;rant des serveurs ftp &agrave; HAUT trafic 
  ne devraient pas invoquer ftpd &agrave; partir de inetd.conf. La meilleure option 
  consiste &agrave; commenter la ligne correspondant &agrave; ftpd dans /etc/inetd.conf 
  et &agrave; d&eacute;marrer ftpd &agrave; partir de rc.conf avec l'option <i>-D</i>. 
  Ce qui va d&eacute;marrer ftpd en tant que d&eacute;mon. Ce mode de fonctionnement 
  est beaucoup moins co&ucirc;teux et plus rapide que le d&eacute;marrage via 
  inetd. La ligne correspondant &agrave; ftpd dans rc.conf ressemblerait &agrave; 
  : 
d1161 5
a1165 3
<p>Bien &eacute;videmment, cette m&eacute;thode ne fonctionnera que si ftpd est 
  comment&eacute; dans <i>/etc/inetd.conf</i> et en veillant qu'inetd ait bien
  relu sont fichier de configuration.
d1169 10
a1178 7
  <li><i>/etc/ftpwelcome</i> - Ce fichier contient le message de bienvenue qui 
    sera affich&eacute; aux personnes qui se connectent sur votre serveur ftp.
  <li><i>/etc/motd</i> - Ce fichier contient le message qui sera affich&eacute; 
    aux utilisateurs une fois authentifi&eacute;s sur votre serveur ftp.
  <li><i>.message</i> - Ce fichier peut &ecirc;tre mis dans n'importe quel r&eacute;pertoire. 
    Il contient un message qui sera affich&eacute; lorsque l'utilisateur entre 
    dans le r&eacute;pertoire o&ugrave; ce fichier se trouve.
d1181 4
d1187 10
a1196 2
<a name= "ftpchroot"></a>
<h2>10.13 - Confiner les utilisateurs &agrave; leur r&eacute;pertoire HOME avec ftpd(8)</h2> 
a1197 8
<p>le d&eacute;mon <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&amp;sektion=8">ftpd(8)</a> 
  livr&eacute; avec OpenBSD est configur&eacute; par d&eacute;faut pour g&eacute;rer 
  cela de mani&egrave;re tr&egrave;s facile. Cette action est accomplie par le 
  biais du fichier <b>/etc/ftpchroot</b>. Puisqu'on ne peut pas toujours faire 
  confiance aux utilisateurs, il sera peut-&ecirc;tre n&eacute;cessaire de les 
  confiner &agrave; leur r&eacute;pertoire HOME. Ce mode de fonctionnement n'est 
  pas activ&eacute; par d&eacute;faut. Voici &agrave; quoi ressemble le mode par 
  d&eacute;faut :
d1205 1
a1205 1
230- OpenBSD 3.3 (GENERIC) #44: Sat Mar 29 13:22:05 MST 2003 
d1243 10
a1252 7
<p>Comme vous pouvez le voir, l'acc&egrave;s est permis &agrave; tout le serveur. 
  Dans un monde parfait o&ugrave; on peut faire confiance aux utilisateurs, il 
  n'y a pas de mal &agrave; &ccedil;a mais c'est loin d'&ecirc;tre le cas dans 
  la r&eacute;alit&eacute;. Pour confiner un utilisateur &agrave; son r&eacute;pertoire 
  HOME, il suffit simplement d'ajouter son nom au fichier <b>/etc/ftpchroot</b>. 
  Voici un exemple pour montrer cette restriction appliqu&eacute;e &agrave; l'utilisateur 
  &quot;ericj&quot; :
d1262 6
a1267 4
<p>Cette op&eacute;ration est suffisante pour emp&ecirc;cher l'utilisateur &quot;ericj&quot; 
  de sortir de son propre r&eacute;pertoire comme vous pouvez le voir &agrave; 
  travers l'exemple suivant. Le r&eacute;pertoire / correspond maintenant &agrave; 
  son r&eacute;pertoire HOME !
d1301 66
a1366 46
<p>Le code source de OpenBSD est en constante &eacute;volution et am&eacute;lioration. 
  En m&ecirc;me temps, des correctifs aux probl&egrave;mes les plus communs sont 
  cr&eacute;es et diffus&eacute;s au public. Ces correctifs apparaissent sur une 
  page web &agrave; l'adresse <a href="../errata.html">http://www.openbsd.org/errata.html</a>. 
  Ils sont s&eacute;par&eacute;s en cat&eacute;gories. Ces cat&eacute;gories correspondent 
  &agrave; des correctifs qui concernent diff&eacute;rentes architectures ou &agrave; 
  des correctifs ind&eacute;pendants de l'architecture.
<p>Cependant, il est &agrave; noter qu'il n'y a pas de correctifs pour les nouvelles 
  fonctionnalit&eacute;s ajout&eacute;es &agrave; OpenBSD. Les correctifs corrigent 
  uniquement des probl&eacute;mes de stabilit&eacute; ou de s&eacute;curit&eacute; 
  qui doivent &ecirc;tre r&eacute;gl&eacute;s tr&egrave;s rapidement, bien que 
  le choix final revienne &agrave; l'administrateur.

<p> Comme exemple, nous allons appliquer un correctif de s&eacute;curit&eacute; 
  obtenu &agrave; partir de <a href="../errata.html">errata.html</a> &agrave; 
  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=talkd&amp;sektion=8">talkd(8)</a>.

<h3>Quelle est la diff&eacute;rence entre ces correctifs et ce qui se trouve dans 
  l'arborescence CVS ? </h3>

<p>Tous les correctifs post&eacute;s sur <a href="../errata.html">http://www.openbsd.org/errata.html</a> 
  concernent uniquement l'arborescence des sources de la derni&egrave;re version 
  diffus&eacute;e. Les autres correctifs qui concernent l'arborescence actuelle 
  de CVS peuvent contenir certaines modifications qui ne sont peut-&ecirc;tre 
  pas d&eacute;sirables sur la version de production.
<h3>Pr&eacute;parer le syst&egrave;me pour l'application des correctifs</h3>
<p>Les correctifs d'OpenBSD sont distribu&eacute;s sous la forme de fichiers diff. 
  Ces fichiers sont des fichiers texte qui contiennent les diff&eacute;rences 
  par rapport au code source d'origine. Ils ne sont <b>PAS </b> distribu&eacute;s 
  sous forme binaire. Cela veut dire que pour appliquer les correctifs, vous devez 
  avoir &agrave; disposition sur votre syst&egrave;me le code source de la version 
  <b>RELEASE </b>d'OpenBSD. Cela ne veut pas dire que vous avez besoin de tout 
  le code source du syst&egrave;me d'exploitation OpenBSD pour appliquer les correctifs 
  &agrave; votre syst&egrave;me. Mais vous devez avoir le code source correspondant 
  au composant &agrave; corriger. Par exemple, si vous corrigez le noyau vous 
  devez avoir tout le code source au noyau.
<p><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cvs&amp;sektion=1">cvs(1)</a> 
  est un outil tr&egrave;s pratique pour t&eacute;l&eacute;charger uniquement 
  les sources dont vous avez besoin en utilisant des serveurs cvs anonymes situ&eacute;s 
  un peu partout dans le monde. Vous pouvez avoir une liste des serveurs disponibles 
  &agrave; l'adresse suivante :<br>
  <a href="http://www.openbsd.org/anoncvs.html">http://www.openbsd.org/anoncvs.html</a>. 

<p>Pour t&eacute;l&eacute;charger le code source de talkd(8) correspondant &agrave; la version 
  <i>3.3-release</i> via <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cvs&amp;sektion=1">cvs(1)</a>, 
  vous utiliseriez la ligne de commande suivante : 
d1369 2
a1370 1
$ <b>cvs -danoncvs@@anoncvs5.usa.openbsd.org:/cvs co -rOPENBSD_3_3_BASE src/libexec/talkd/</b>
d1458 4
a1461 1
mkdep -a /home/ericj/lsrc/src/libexec/talkd/talkd.c /home/ericj/lsrc/src/libexec/talkd/announce.c /home/ericj/lsrc/src/libexec/talkd/process.c /home/ericj/lsrc/src/libexec/talkd/table.c /home/ericj/lsrc/src/libexec/talkd/print.c
d1468 2
a1469 1
nroff -Tascii -mandoc /home/ericj/lsrc/src/libexec/talkd/talkd.8 &gt; talkd.cat8
d1477 3
a1479 1
<p>Une fois cette op&eacute;ration effectu&eacute;e, red&eacute;marrez le service.
a1483 1
<!-- XXXchangements - n'est plus nouveau avec 3.3 -->
d1485 7
a1491 7
Depuis OpenBSD 3.2, le serveur <a 
href="http://www.openbsd.org/cgi-bin/man.cgi?query=httpd&amp;sektion=8">httpd(8)</a>
d'Apache est <a 
href="http://www.openbsd.org/cgi-bin/man.cgi?query=chroot&amp;sektion=2">chroot(2)</a>&eacute;
par d&eacute;faut. Etant un grand pas en avant du point de vue 
de la s&eacute;curit&eacute;, cela peut cr&eacute;er des 
probl&egrave; si vous n'y &ecirc;tes pas pr&eacute;par&eacute;. 
d1495 4
a1498 4
Une application <a 
href="http://www.openbsd.org/cgi-bin/man.cgi?query=chroot&amp;sektion=2">chroot(2)</a>&eacute;e
est bloqu&eacute;e dans un r&eacute;pertoire sp&eacute;cifique et 
ne peut errer dans les autres r&eacute;pertoires de l'arbre du 
d1500 12
a1511 11
r&eacute;pertoire <tt>/</tt> (root). Dans le cas d'httpd(8), le programme
d&eacute;marre, ouvre ses fichiers log, ouvre ses ports TCP (bien qu'il 
n'accepte pas encore de donn&eacute;es), et lis sont fichier de
configuration. Ensuite, il se fixe lui-m&ecirc;me dans le 
r&eacute;pertoire <i>/var/www</i> et baisse ses privil&egrave;ges.
Ce qui veut dire que tous les fichiers servis et utilis&eacute;s par Apache, 
doivent &ecirc;tre dans le r&eacute;pertoire <i>/var/www</i>. Cela aide
consid&eacute;rablement la s&eacute;curit&eacute; -- si il devait y avoir 
un probl&egrave;me de s&eacute;curit&eacute;, les d&eacute;gats seraient 
confin&eacute;s dans un seul r&eacute;pertoire avec les permissions de
"lecture seule" et aucune ressource pour causer des probl&egrave;mes. 
d1514 3
a1516 3
En gros, chroot(2)er Apache est quelque chose de nouveau, 
et donc beaucoup d'applications et de configurations syst&egrave;me 
ne fonctionneront plus comme avant. 
d1520 36
a1555 32
Les serveurs mis &agrave; jour depuis  
d'anciennes versions d'OpenBSD peuvent avoir les fichiers web 
situ&eacute;s dans les r&eacute;pertoires HOME des utilisateurs, ce qui
clairement ne fonctionnera pas dans un environnement chroot(2)&eacute; 
&eacute;tant donn&eacute; qu'httpd(8) ne peut atteindre le 
r&eacute;pertoire <i>/home</i>. Les administrateurs d&eacute;couvriront
peut-&ecirc;tre que leur partition /var/www existente est trop petite 
pour accueillir tous les fichiers web. Vos options sont d&egrave;s lors 
de restructurer votre syst&egrave;me ou de ne pas utiliser l'option du 
chroot(2). Vous 
pouvez, bien evidemment, utiliser des liens symboliques dans le 
r&eacute;pertoire HOME de l'utilisateur pointant vers les 
sous-r&eacute;pertoires dans <i>/var/www</i>, mais vous ne pouvez PAS 
utiliser des liens dans <i>/var/www</i> pointant vers une autre partie 
du syst&egrave;me de fichier -- ceci ne peut fonctionner d&ucirc; au 
chroot(2). Notez que si vous voulez que vos utilisateurs aient un 
<a href="faq10.html#ftpchroot">acc&egrave;s FTP chroot(2)&eacute;</a>, 
ceci ne fonctionnera pas plus &eacute;tant donn&eacute; que le chroot FTP
va (&agrave; nouveau) vous emp&ecirc;cher d'acc&eacute;der aux  
destinations de ces liens symboliques. Une solution est donc, de ne pas utiliser 
<i>/home</i> comme r&eacute;pertoire HOME pour ces utilisateurs  
mais plutot quelque chose similaire &agrave; <i>/var/www/home</i>.


<li><b>Rotation des fichiers log :</b> Normalement, une rotation des 
fichiers log est r&eacute;alis&eacute;e  
en renommant les anciens fichiers, ensuite en envoyant &agrave; 
httpd(8) un signal SIGUSR1 qui forcera Apache &agrave; fermer ses   
anciens fichiers logs et &agrave; en  ouvrir de nouveaux. Ceci n'est d&eacute;sormais 
plus possible, &eacute;tant donn&eacute; qu'httpd(8) n'a plus la possibilit&eacute;
d'ouvrir ses propres fichiers log une fois que ses privil&egrave;ges ont baiss&eacute;s.
httpd(8) doit donc &ecirc;tre stopp&eacute; et relanc&eacute; : 
d1562 25
a1586 22
vers un <a 
href="http://www.openbsd.org/cgi-bin/man.cgi?query=pipe&amp;sektion=2">pipe(2)</a>, 
et utiliser un programme ext&eacute;rieur afin
de r&eacute;aliser une rotation des fichiers &agrave; la fin du pipe. 

<li><b>Modules Apache existant :</b> Pratiquement, ils se lanceront tous, 
cependant, certains pourraient ne pas fonctionner correctement dans le chroot(2), 
et pourraient causer des probl&egrave;mes lors de "<tt><a 
href="http://www.openbsd.org/cgi-bin/man.cgi?query=apachectl&amp;sektion=8">apachectl</a> 
restart"</tt>, g&eacute;n&eacute;rant une erreur, causant httpd(8) &agrave; se stopper.

<li><b>CGIs existant :</b> La plupart ne fonctionneront pas tels quels. 
Ils auront certainement besoin de programmes ou de librairies se
trouvant hors de <i>/var/www</i>. Certains peuvent &ecirc;tre corrig&eacute;s 
en &eacute;tant compil&eacute;s statiquement (n'ayant pas besoin de librairies 
se trouvant dans un autre r&eacute;pertoire), la plupart peuvent &ecirc;tre 
corrig&eacute;s en copiant dans <i>/var/www</i> les fichiers n&eacute;cessaires 
&agrave; l'application, bien que cette manoeuvre soit non triviale et requiert 
certaines notions de programmation -- la plupart des utilisateurs trouveront 
plus facile de ne pas employer le chroot(2) en attendant une mise &agrave; 
jour de ces CGIs.

d1592 2
a1593 2
en utilisant l'option <tt>u</tt> d'Apache dans <i><a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc.conf&amp;sektion=8">rc.conf</a></i>
d1598 5
a1602 5
<i>root</i> est <a 
href="http://www.openbsd.org/cgi-bin/man.cgi?query=csh&amp;sektion=1">csh</a>, 
d&ucirc; principalement &agrave; la tradition. Il n'est pas sp&eacute;cialement 
requis qu'OpenBSD ait csh(1) comme shell pour l'utilisateur root (lisez
n&eacute;anmoins avant de le changer). 
d1605 3
a1607 3
Certains utilisateurs venant d'un syst&egrave;me d'exploitation "Unix-like" 
trouvent csh(1) peu familier et demande d&egrave;s lors si ils peuvent 
le changer et comment. Il y a plusieurs options :
d1614 2
a1615 2
il ne devrait y avoir que peu de raisons pour que les utilisateurs 
s'authentifient en tant que <i>root</i> pour la plupart des applications 
d1617 3
a1619 3
<li><b>Invoquez votre shell favori apr&egrave;s le login :</b> Si vous aimez
ksh(1) ou n'importe quel autre shell, invoquez le simplement depuis
votre shell par d&eacute;faut.
d1621 1
a1621 1
fait en utilisant 
d1627 9
a1635 9
Une directive Unix traditionelle est d'utiliser pour l'utilisateur root 
des shells compil&eacute;s statiquement, car si votre 
syst&egrave;me d&eacute;marre en mode utilisateur unique, les partitions 
non-root ne seront pas mont&eacute;es et les shells li&eacute;s 
dynamiquement ne seront pas capable d'acc&eacute;der aux librairies 
situ&eacute;es dans la partition <tt>/usr</tt>. Ceci n'&eacute;tant 
pas tr&egrave;s important pour OpenBSD, car le syst&egrave;me vous
demandera de choisir un shell lors d'un d&eacute;marrage en mode utilisateur
unique, le shell par d&eacute;faut &eacute;tant 
d1643 2
a1644 1
sont li&eacute;s statiquement et donc utilisables en mode utilisateur unique.
d1647 4
a1650 5
Il est parfois dit qu'il ne faut pas changer le shell de 
l'utilisateur root, bien qu'il n'y
ait aucune raison de ne pas le faire sous OpenBSD. Mais encore une fois, 
ceci ne devrait pas &ecirc;tre une raison -- ne vous authentifiez pas
directement en tant que root.
d1656 4
a1659 2
est <a href="http://web.cs.mun.ca/~michael/pdksh/">pdksh</a>, le Shell Korn du 
Domaine Public (Public Domain Korn Shell), et est le m&ecirc;me binaire que 
d1663 2
a1664 2
Les utilisateurs qui sont &agrave; l'aise avec <i>bash</i>, souvent utilis&eacute; 
sur les syst&egrave;mes Linux, trouveront probablement 
d1666 15
a1680 13
tr&egrave;s familier. Ksh(1) offre la plupart des options habituellement 
utilis&eacute;es avec <i>bash</i>, notamment l'ach&egrave;vement des commandes 
avec la touche tab, l'&eacute;dition de la ligne de commande et l'historique 
via les touches fl&egrave;ch&eacute;es, et CTRL-A/CTRL-E pour aller au
d&eacute;but/&agrave; la fin de la ligne de commande. Si vous d&eacute;sirez 
d'autres options de <i>bash</i>, <i>bash</i> peut &ecirc;tre install&eacute; 
soit via les <a href="faq8.html#Ports">ports</a> ou soit via les 
<a href="faq8.html#Packages">packages</a>.

<p>Le prompt de <i>ksh</i> peut &ecirc;tre facilement chang&eacute; de
mani&egrave;re &agrave; fournir plus d'informations que le simple "$ " par d&eacute;faut 
en modifiant la variable <tt>PS1</tt>. Par exemple, en ins&eacute;rant 
la ligne suivante :
d1692 5
a1696 5
Consultez le fichier <a
href="http://www.openbsd.org/cgi-bin/cvsweb/~checkout~/src/etc/ksh.kshrc?content-type=text/plain"><tt>/etc/ksh.kshrc</tt></a>,
qui inclut plusieurs options utiles ainsi que des exemples, et 
qui peut &ecirc;tre invoqu&eacute; dans les fichiers <tt>.profile</tt>
de vos utilisateurs.
d1701 1
a1701 1
<a href= "faq9.html">[Section 9 - Migrer depuis Linux]</a>
d1710 2
a1711 2
Originally [OpenBSD: faq10.html,v 1.91 ]<br>
$Translation: faq10.html,v 1.15 2003/06/17 21:30:12 xsa Exp $<br>
@


1.9
log
@
sync with steelix translation CVS
@
text
@a52 1
<a name= "10.1"></a>
d82 1
a82 2
<p><a name= "DupFS"></a> <a name= "10.2"></a> 

a106 1
<a name="10.3"></a>
a239 1
<a name="10.4"></a>
a281 1
<a name="10.5"></a>
a358 1
<a name="10.6"></a>
a428 1
<a name="10.8"></a>
a468 1
<a name="10.9"></a>
a690 1
<a name="10.9"></a>
a710 1
<a name="10.10"></a>
a829 1
<a name="10.11"></a>
a845 1
<a name="10.12"></a>
a1020 1
<a name="10.14"></a>
a1126 1
<a name="10.14"></a>
d1500 2
a1501 2
Originally [OpenBSD: faq10.html,v 1.89 ]<br>
$Translation: faq10.html,v 1.14 2003/05/11 15:42:48 saad Exp $<br>
@


1.8
log
@
sync with steelix translation CVS
@
text
@d4 1
a4 1
<title>10 - Gestion du syst&egrave;me</title>
d23 1
a23 1
<h1><font color=#e00000>10 - Gestion du syst&egrave;me</font></h1> 
d1515 1
a1515 1
$Translation: faq10.html,v 1.13 2003/05/06 21:28:08 xsa Exp $<br>
@


1.7
log
@
sync with steelix translation CVS
@
text
@d17 7
a23 1
<h2><font color=#e00000>10 - Gestion du syst&egrave;me</font></h2> 
d40 1
a40 1
  <li><a href="#Kerberos"      >10.12 - Mise en place d'un Client/Serveur KerberosIV</a>
d70 1
a70 1
  la question <tt>Invite <i>user</i> into other groups:</tt> Ceci aura pour effet 
d221 6
d573 1
a573 1
Voici une liste des commandes additionnelles : 
d725 2
a726 2
  avez des ressources limit&eacute;es. Il y a deux mani&egrave;res de configurer 
  des quotas :
a727 5
<p>
<ul>
  <li>Quotas utilisateur
  <li>Quotas groupe
</ul>
d730 2
a731 1
  que <tt>option QUOTA</tt> est pr&eacute;sente dans votre configuration noyau. 
d734 3
a736 1
  dans le fichier <i>/etc/fstab</i>. Les mots cl&eacute;s <tt>userquota</tt> et 
d742 4
a745 3
  les cr&eacute;er ailleurs (par exemple sous /var/quotas), utilisez userquota=/var/quotas/quota.user. 
  Voici un exemple de /etc/fstab avec un syst&egrave;me de fichiers avec quotas 
  activ&eacute;s :
d756 1
a756 1
  Une utilisation simple est <strong>edquota &lt;user&gt;</strong>. edquota(8) 
d787 5
a791 2
<p>Comme on peut le voir, softlimit est fix&eacute; &agrave; 1000 blocs et hardlimit 
  &agrave; 1050 blocs. softlimit est une limite qui permet au syst&egrave;me de 
d808 1
a808 1
<p>Cette commande analysera le contenu de /etc/fstab et activera les quotas sur 
d831 1
a831 1
<p>Par d&eacute;faut, les quotas positionn&eacute;s dans /etc/fstab seront activ&eacute;s 
d841 1
a841 1
<h2>10.12 - Mise en place d'un Client/Serveur KerberosIV</h2>
d843 3
a845 9
<p>En tant d'utilisateur/administrateur de syst&egrave;mes OpenBSD, vous &ecirc;tes 
  chanceux car KerberosIV est pr&eacute;-install&eacute; par d&eacute;faut. Ce 
  chapitre est un guide pour l'installation et la configuration d'un serveur de 
  domaine Kerberos et d'un client.
<p>Il est *TRES* important de se rappeler que les horloges des clients et des 
  serveurs Kerberos soient synchrones. S'il y a un d&eacute;calage de plus de 
  5 minutes, vous aurez des messages bizarres dont la signification ne laisse 
  rien supposer quant &agrave; un probl&egrave;me de d&eacute;calage d'horloge. 
  Par exemple :
d847 3
a849 60
<blockquote>
<pre>
kinit: Can't send request (send_to_kdc) 
</pre>
</blockquote>

Voici un message d'erreur plus pr&eacute;cis : 
<blockquote>
<pre>
kauth: Time is out of bounds (krb_rd_req) 
</pre>
</blockquote>

<p>Une mani&egrave;re simple de synchroniser les horloges des syst&egrave;mes 
  consiste &agrave; utiliser ntpd, disponible dans la collection de ports sous 
  <b>/usr/ports/net/ntp/</b>. 
<p>Dans ce chapitre, nous supposerons que vous avez une connaissance pr&eacute;alable 
  des concepts Kerberos. Voici une liste d'excellentes r&eacute;f&eacute;rences 
  &agrave; ce sujet :

<ul>
<li><a href="http://www.freebsd.org/doc/en_US.ISO8859-1/books/handbook/kerberos.html">The FreeBSD handbook</a> 
<li>Utilisez la commande <strong>info kth-krb</strong>
<li><a href="http://web.mit.edu/kerberos/www/dialogue.html">Designing an Authentication System: a Dialogue in Four Scenes</a>
<li><a href="http://web.mit.edu/kerberos/www/papers.html#krb4">Papers and Documentation Describing KerberosIV</a>
</ul>
Sinon, faites l'acquisition de l'ouvrage suivant : 
<ul>
<li><a href="http://www.amazon.com/exec/obidos/ASIN/0130614661/qid%3D930594963/">Network Security Private Communication in a Public World [Kaufman, Perlman, Speciner, 1995]</a> 
</ul>

<h3>Comment configurer le domaine et le serveur Kerberos</h3>

<p>Dans les exemples suivants, nous allons configurer le domaine CIARASYSTEMS.COM 
  dont le serveur principal est avalanche.ciarasystems.com.
<p>Pour commencer, nous devons &eacute;diter les fichiers de configuration. Ces 
  fichiers se trouvent sous <tt>/etc/kerberosIV/</tt>. Les deux fichiers qui nous 
  int&eacute;ressent sont <i>krb.realms </i>et <i>krb.conf</i>. Commen&ccedil;ons 
  par ce dernier. 

<blockquote>
<pre>
# <strong>cat krb.conf</strong>
CIARASYSTEMS.COM
CIARASYSTEMS.COM avalanche.ciarasystems.com admin server
</pre>
</blockquote>

<p>Comme vous pouvez le voir, les lignes pr&eacute;c&eacute;dentes informent kerberos 
  que le domaine est CIARASYSTEMS.COM (ou un domain logique) et qu'au sein de 
  ce domaine, avalanche est le serveur d'administration. Au tour de <i>krb.realms</i> 
  maintenant. Pour plus d'informations &agrave; ce sujet, voir <a 
href="http://www.openbsd.org/cgi-bin/man.cgi?query=krb.conf&amp;sektion=5">krb.conf</a>.
<blockquote>
<pre>
# <strong>cat krb.realms</strong>
avalanche.ciarasystems.com      CIARASYSTEMS.COM
.ciarasystems.com               CIARASYSTEMS.COM
</pre>
</blockquote>
a850 51
<p> krb.realms permet de traduire un nom d'h&ocirc;te en nom de domaine Kerberos 
  pour les services fournis par l'h&ocirc;te en question. Chaque ligne du fichier 
  de traduction ressemble &agrave; l'une des lignes suivantes (domain_name doit 
  &ecirc;tre de la forme .XXX.YYY). Dans cet exemple, avalanche est le nom d'h&ocirc;te 
  d'une machine appartenant au domaine CIARASYSTEMS.COM. .ciarasystems.com est 
  le nom de domaine correspondant au domaine Kerberos CIARASYSTEMS.COM. Pout plus 
  d'informations, consultez la page de manuel <a 
href="http://www.openbsd.org/cgi-bin/man.cgi?query=krb.realms&amp;sektion=5">krb.realms</a>.
<p>Nous allons maintenant ex&eacute;cuter <a 
href="http://www.openbsd.org/cgi-bin/man.cgi?query=kdb_init&amp;sektion=8">kdb_init(8)</a> 
  pour initialiser la base de donn&eacute;es Kerberos :
<blockquote>
<pre>
# <strong>kdb_init</strong>
Realm name [default  NO.DEFAULT.REALM ]: CIARASYSTEMS.COM
You will be prompted for the database Master Password.
It is important that you NOT FORGET this password.

Enter Kerberos master password: <strong>not shown</strong>
Verifying password -
Enter Kerberos master password:
</pre>
</blockquote>

<p>Ensuite nous devons utiliser <a 
href="http://www.openbsd.org/cgi-bin/man.cgi?query=kstash&amp;sektion=8">kstash(8)</a> 
  pour sauvegarder la cl&eacute; du ma&icirc;tre de la base de donn&eacute;es 
  du centre de distribution de cl&eacute;s Kerberos (KDC) dans le fichier cache 
  de la cl&eacute; ma&icirc;tre.
<blockquote>
<pre>
# <strong>kstash</strong>
Enter Kerberos master password:

Current Kerberos master key version is 1.

Master key entered.  BEWARE!
Wrote master key to /etc/kerberosIV/master_key
</pre>
</blockquote>
<p>Le mot de passe crypt&eacute; du ma&icirc;tre est ainsi sauvegard&eacute; dans 
  /etc/kerberosIV/master_key. 
<p>L'&eacute;tape suivante consiste &agrave; ajouter deux noms principaux &agrave; 
  la base de donn&eacute;es pour chaque syst&egrave;me &agrave; s&eacute;curiser 
  avec Kerberos. Ces noms correspondent &agrave; <i>kpasswd </i>et <i>rcmd</i>. 
  Ils doivent exister pour chaque syst&egrave;me et on doit prendre comme nom 
  d'instance le nom du syst&egrave;me &agrave; s&eacute;curiser. Les services 
  <i>kpasswd </i>et <i>rcmd</i> permettent &agrave; d'autres syst&egrave;mes de 
  changer les mots de passe Kerberos et d'ex&eacute;cuter des commandes telles 
  que <i>rcp</i>, <i>rlogin </i>et <i>rsh</i>.
<blockquote>
d852 1
a852 49
# <b>kdb_edit</b>
Opening database...
    
Enter Kerberos master key:
    
Current Kerberos master key version is 1.
    
Master key entered.  BEWARE!

Previous or default values are in [brackets] ,
enter return to leave the same, or new value.

Principal name: <strong>passwd</strong>
Instance: <strong>avalanche</strong>

&lt;Not found&gt;, Create [y] ? <strong>y</strong>

Principal: passwd, Instance: avalanche, kdc_key_ver: 1
New Password:                <strong>&lt;----- Utilisez 'RANDOM' comme mot de passe</strong>
Verifying password -
New Password:

Random password [y] ? <strong>y</strong>

Principal's new key version = 1
Expiration date (enter yyyy-mm-dd) [ 1999-12-31 ] ? <strong>2003-12-31</strong>
Max ticket lifetime (*5 minutes) [ 255 ] ?
Attributes [ 0 ] ?
Edit O.K.


Principal name: <strong>rcmd</strong>
Instance: <strong>avalanche</strong>

&lt;Not found&gt;, Create [y] ? <strong>y</strong>
Principal: rcmd, Instance: avalanche, kdc_key_ver: 1
New Password:                 <strong>&lt;----- </strong><strong>Utilisez 'RANDOM' comme mot de passe</strong>
Verifying password -
New Password:

Random password [y] ? <Strong>y</strong>

Principal's new key version = 1
Expiration date (enter yyyy-mm-dd) [ 1999-12-31 ] ? <strong>2003-12-31</strong>
Max ticket lifetime (*5 minutes) [ 255 ] ?
Attributes [ 0 ] ?
Edit O.K.
Principal name:               <strong>&lt;----- Tapez sur &lt;Entr&eacute;e&gt; pour finir</strong>

a853 182
</blockquote>

<p>Les fichiers srvtab sont les fichiers des cl&eacute;s de service. Ces cl&eacute;s 
  doivent extraites de la base de donn&eacute;es du centre de distribution de 
  cl&eacute;s Kerberos pour permettre &agrave; des services de s'authentifier 
  en utilisant Kerberos. Pour chaque nom d'h&ocirc;te sp&eacute;cifi&eacute; en 
  ligne de commande, <a 
href="http://www.openbsd.org/cgi-bin/man.cgi?query=ext_srvtab&amp;sektion=8">ext_srvtab(8)</a> 
  cr&eacute;e le fichier des cl&eacute;s de service hostname-new-srvtab. Ce fichier 
  contient toutes les entr&eacute;es dans la base correspondant &agrave; une instance 
  hostname.
<blockquote>
<pre>
# <Strong>ext_srvtab avalanche</strong>

Enter Kerberos master password:

Current Kerberos master key version is 1.

Master key entered.  BEWARE!
Generating 'avalanche-new-srvtab'....

# <strong>mv avalanche-new-srvtab srvtab</strong>
# <strong>chmod 600 srvtab</strong>
</pre>
</blockquote>

<p>Maintenant nous pouvons ajouter des utilisateurs &agrave; notre base.
<blockquote>
<pre>
# <strong>kdb_edit</strong>
Opening database...
    
Enter Kerberos master key:
    
Current Kerberos master key version is 1.
    
Master key entered.  BEWARE!
Previous or default values are in [brackets] ,
enter return to leave the same, or new value.
    
Principal name: <strong>jeremie</strong>
Instance:
    
&lt;Not found&gt;, Create [y] ? <strong>y</strong>
    
Principal: jeremie, Instance: , kdc_key_ver: 1
New Password:                &lt;---- saisissez un mot de passe s&eacute;curis&eacute; ici
Verifying password
    
New Password:                &lt;---- ressaisissez votre mot de passe
Principal's new key version = 1
Expiration date (enter yyyy-mm-dd) [ 2000-01-01 ] ?
Max ticket lifetime (*5 minutes) [ 255 ] ?
Attributes [ 0 ] ? 
Edit O.K.
Principal name:          &lt;---- une entr&eacute;e vide terminera la session 
			       sinon vous pouvez ajouter d'autres entr&eacute;es.
</pre>
</blockquote>

<p>Kerberos est maintenant configur&eacute; et pr&ecirc;t &agrave; l'utilisation. 
  Tout ce qu'il reste &agrave; faire est d'activer le lancement au d&eacute;marrage 
  du serveur Kerberos et d'activer le support Kerberos au niveau des services.
<p> Dans /etc/rc.conf, assurez-vous d'avoir la ligne suivante : 
<blockquote>
<tt>kerberos_server=YES</tt>
</blockquote>

Dans /etc/inetd.conf, supprimer le commentaire au niveau des lignes suivantes 
: 
<blockquote>
<pre>
telnet       stream  tcp     nowait  root    /usr/libexec/telnetd    telnetd -k
klogin       stream  tcp     nowait  root    /usr/libexec/rlogind    rlogind -k
kshell       stream  tcp     nowait  root    /usr/libexec/rshd       rshd -k
kauth        stream  tcp     nowait  root    /usr/libexec/kauthd     kauthd
</pre>
</blockquote>

Puis red&eacute;marrez ou effectuer les op&eacute;rations suivantes :
<blockquote>
<pre>
# <Strong>kill -HUP `cat /var/run/inetd.pid`</strong>
# <Strong>/usr/libexec/kerberos &gt;&gt; /var/log/kerberos.log &amp;</strong>
# <strong>/usr/libexec/kadmind -n &gt;&gt; /var/log/kadmind.log &amp;</strong>
</pre>
</blockquote>

<p>Remarque : l'exemple ci-dessus montre une configuration serveur simple. Habituellement, 
  des serveurs redondants sont configur&eacute;s (comme serveurs esclaves) de 
  telle fa&ccedil;on que lorsqu'un serveur est hors service, les services d&eacute;pendant 
  de Kerberos sont toujours disponibles. Nous pouvons aussi ajouter les privil&egrave;ges 
  'su' &agrave; un nom principal donn&eacute;. Pour plus de d&eacute;tails, voir 
  <a href="http://www.freebsd.org/doc/en_US.ISO8859-1/books/handbook/kerberos.html#AEN9189">le 
  manuel FreeBSD</a>.
<h3>Comment activer Kerberos c&ocirc;t&eacute; client</h3>

<p>Dans les exemples ci-apr&egrave;s, nous allons configurer une station de travail 
  appel&eacute;e <i>gatekeeper </i>pour qu'elle fasse partie du domaine Kerberos 
  CIARASYSTEMS.COM ayant avalanche.ciarasystems.com comme serveur principal.
<p>Pour commencer, nous devons configurer <i>krb.conf </i>et <i>krb.realms</i> 
  comme nous l'avons fait pour le serveur afin de permettre &agrave; <i>gatekeeper 
  </i>de savoir quel serveur est le KDC et dans quel domaine il se trouve. Voici 
  le contenu de ces deux fichiers :

<blockquote>
<pre>
# <strong>cat krb.conf</strong>
CIARASYSTEMS.COM
CIARASYSTEMS.COM avalanche.ciarasystems.com admin server

# <strong>cat krb.realms</strong>
avalanche.ciarasystems.com      CIARASYSTEMS.COM
.ciarasystems.com               CIARASYSTEMS.COM
</pre>
</blockquote>

<p>Nous avons maintenant besoin d'initialiser Kerberos. Pour obtenir un ticket, 
  nous utilisons <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=kinit&sektion=1&format=html">kinit(1)</a>.
<blockquote>
<pre>
$ <Strong>kinit</strong>
The OpenBSD Project (gatekeeper)
Kerberos Initialization
Kerberos name: <strong>jeremie</strong>
Password:
</pre>
</blockquote>

<p>Une fois que nous nous sommes identifi&eacute;s, nous pouvons lister nos tickets 
  avec <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=klist&sektion=1&format=html">klist(1)</a>.
<blockquote>
<pre>
$ <strong>klist</strong>
Ticket file:    /tmp/tkt1000
Principal:      jeremie@@CIARASYSTEMS.COM

  Issued           Expires          Principal
Jun 28 01:03:25  Jun 28 11:03:25  krbtgt.CIARASYSTEMS.COM@@CIARASYSTEMS.COM
</pre>
</blockquote>

<p>Apparemment, notre configuration est correcte. Il nous suffit de tester. Ci-apr&egrave;s, 
  nous effectuons les tests avec rlogin(1) et telnet(1).
<blockquote>
<pre>
$ <Strong>telnet avalanche</strong>
Trying 192.168.0.38...
Connected to avalanche.
Escape character is '^]'.
[ Trying mutual KERBEROS4 ... ]
[ Kerberos V4 accepts you ]
[ Kerberos V4 challenge successful ]
Last login: Sun Jun 27 22:52:25 on ttyp1 from gatekeeper
Warning: no Kerberos tickets issued.
OpenBSD 3.2 (GENERIC) #25: Thu Oct  3 19:51:53 MDT 2002
</pre></blockquote>

De m&ecirc;me : 
<blockquote><pre>
$ <strong>rlogin avalanche</strong>
Last login: Sun Jun 27 22:53:39 on ttyp1 from gatekeeper
Warning: no Kerberos tickets issued.
OpenBSD 3.2 (GENERIC) #25: Thu Oct  3 19:51:53 MDT 2002
</pre>
</blockquote>

<p>Comme vous pouvez le constater, nous utilisons effectivement Kerberos pour 
  authentifier notre session rlogin. Pour supprimer les tickets, utilisez la commande 
  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=kdestroy&amp;sektion=1">kdestroy(1)</a>. 
  Par exemple :
<blockquote>
<pre>
$ <strong>kdestroy</strong>
Tickets destroyed.
xyz:jeremie% <Strong>rlogin avalanche</strong>
krcmd: No ticket file (tf_util)
rlogin: warning, using standard rlogin: can't provide Kerberos auth data.
avalanche: Connection refused
</pre>
</blockquote>
a854 8
<p>Ne soyez pas alarm&eacute; quand vous obtenez l'erreur 'Warning: no Kerberos 
  tickets issued.'. Cette erreur est normale car nous utilisons seulement l'authentification 
  Kerberos et pas de passation de tickets. Si vous souhaitez utiliser cette fonctionnalit&eacute;, 
  configurez <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh&amp;sektion=1">OpenSSH</a> 
  qui supporte ce mode de fonctionnement. L'impl&eacute;mentation standard de 
  KerberosIV n'a pas le support pour la passation tgt non plus - alors que l'impl&eacute;mentation 
  krb4 de AFS kaserver le permet, puisque la version standard de KerberosIV v&eacute;rifie 
  l'adresse IP du client list&eacute; dans le ticket.
d1051 1
a1051 1
230- OpenBSD 3.2 (GENERIC) #25: Thu Oct  3 19:51:53 MDT 2002 
d1186 2
a1187 2
<p>Pour t&eacute;l&eacute;charger le code source correspondant &agrave; la version 
  <i>3.2-release</i> via <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cvs&amp;sektion=1">cvs(1)</a>, 
d1191 1
a1191 1
$ <b>cvs -danoncvs@@anoncvs5.usa.openbsd.org:/cvs co -rOPENBSD_3_2_BASE src/libexec/talkd/</b>
d1299 1
d1301 1
a1301 1
A partir d'OpenBSD 3.2, le serveur <a 
d1514 2
a1515 2
Originally [OpenBSD: faq10.html,v 1.82 ]<br>
$Translation: faq10.html,v 1.12 2003/05/06 20:01:15 xsa Exp $<br>
@


1.6
log
@
sync with steelix translation CVS
@
text
@d39 2
d1525 1
a1525 1
  actuelle via <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cvs&amp;sektion=1">cvs(1)</a>, 
d1529 1
a1529 1
$ <b>cvs -danoncvs@@anoncvs5.usa.openbsd.org:/cvs co -rOPENBSD_3_0_BASE src/libexec/talkd/</b>
d1735 1
a1735 1
&ecirc;tre chang&eacute;es pour fonctionner dans la chroot. Dans 
d1740 99
d1851 2
a1852 2
Originally [OpenBSD: faq10.html,v 1.78 ]<br>
$Translation: faq10.html,v 1.11 2003/05/04 14:10:21 xsa Exp $<br>
@


1.5
log
@
sync with steelix translation CVS
@
text
@d1 1
d4 1
a4 1
<title>10.0 - Gestion du syst&egrave;me</title>
d6 1
d11 1
a11 1
<meta name= "copyright"     content= "This document copyright 1998-2002 by OpenBSD.">
d17 2
a18 3
<h2><font color=#e00000>10.0 - Gestion du syst&egrave;me</font> 
  <hr></h2>
<p></p>
d21 1
a22 1
  <h3>Table des mati&egrave;res</h3>
d25 1
a25 1
  <li><a href="#rc"            >10.3 - Comment d&eacute;marrer des services en m&ecirc;me temps que le syst&egrave;me ? (Vue d'ensemble de rc(8) )</a> 
d38 1
d40 1
a40 1
<p></p> 
a42 2
<br>

a47 2
<p></p>
<p></p>
d55 1
a55 1
  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=su&apropos=0&sektion=1&format=html">su(1)</a> 
d59 2
a60 1
<p>Si vous ajoutez un utilisateur avec <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=adduser&apropos=0&sektion=8&format=html">adduser(8)</a>, 
d65 2
a66 2
<ul>
<pre>
d68 1
a68 2
</pre>
</ul>
d72 4
a75 3
  groupe <kbd>&quot;wheel&quot;</kbd>, utilisez <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sudo&sektion=8&format=html">sudo(8)</a>. 
</p>
<p><a name= "DupFS"></a> <a name= "10.2"></a> </p>
a77 5
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
d79 3
a81 2
<p>Pour dupliquer votre syst&egrave;me de fichiers, utilisez <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dump&sektion=8&format=html">dump(8)</a> 
  et <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=restore&sektion=8&format=html">restore(8)</a>. 
d83 2
a84 3
  vers le r&eacute;pertoire <kbd>DST</kbd>, faites un : </p>
<ul>
<pre>
d86 2
a87 2
</pre>
</ul>
d91 1
a91 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=tar&sektion=1&format=html">tar(1)</a> 
d94 2
a95 2
<UL>
<PRE>
d97 2
a98 2
</PRE>
</UL>
d103 1
a103 2
  ? (Vue d'ensemble de rc(8) )</h2>
<p></p>
d105 3
a107 2
<p>OpenBSD utilise un d&eacute;marrage de type <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc&sektion=8&format=html">rc(8)</a>. 
  Il utilise seulement quelques fichiers cl&eacute;s pour le d&eacute;marrage.</p>
d124 2
a125 1
    ne change. Voir <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=init&sektion=8&format=html">init(8)</a> 
d128 2
a129 1
    de la machine dans ce fichier. Voir <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc.shutdown&sektion=8&format=html">rc.shutdown(8)</a> 
d133 1
d138 4
a141 3
  : </p>
<ul>
  <i>/etc/rc </i>est appel&eacute; apr&egrave;s le d&eacute;marrage du noyau. 
d151 1
a151 1
<ul>
d155 1
a155 1
    </ul>
d165 2
a166 1
  Pour commencer, jetez un coup d'oeil au fichier <a href="http://www.openbsd.org/cgi-bin/cvsweb/src/etc/rc.conf">/etc/rc.conf</a> 
d168 3
a170 2
  : </p>
<ul><pre>
d172 1
a172 1
</pre></ul>
d182 2
a183 2
  concernant httpd(8) :</p>
<ul><pre>
d185 1
a185 1
</pre></ul>
d190 3
a192 2
  la <a href="#HTTPS">FAQ SSL</a> ou &agrave; <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssl&sektion=8&format=html">ssl(8)</a>), 
  vous devez d&eacute;marrer httpd avec une ligne comme celle-ci : &quot;httpd_flags="-DSSL"&quot;.</p>
d206 2
a207 2
  je rajoute les lignes suivantes dans <i>/etc/rc.local</i> :</p>
<ul><pre>
d211 1
a211 1
</pre></ul>
d215 2
a216 2
  sans erreurs affichera le message suivant : </p>
<ul><pre>
d218 1
a218 1
</pre></ul>
d226 1
a226 1
  l'&eacute;quivalent de &quot;shutdown -p&quot;.</p>
a231 1
<p></p>
d233 3
a235 3
<p> Essayez ceci : </p>
<ul>
<pre>
d237 5
a241 5
</pre>
</ul>
<p> Le r&eacute;sultat ressemblerait &agrave; la ligne suivante : </p>
<ul>
<pre>
d243 2
a244 2
</pre>
</ul>
d246 3
a248 4
  qui envoient des messages &agrave; distance en respectant la syntaxe suivante 
  :</p>
<ul>
<pre>
d252 2
a253 2
</pre>
</ul>
d255 2
a256 2
  la plupart des processus de relire leur fichier de configuration) :</p>
<ul><pre>
d258 2
a259 1
</pre></ul>
a268 1
<p></p>
d275 1
a275 2
<p></p>

d279 1
a279 1
<ul>
d283 3
a285 3
</ul>
<p> Essayez de positionner les permissions comme suit :
<ul>
d294 1
a294 1
</ul>
d305 1
a305 1
  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=popa3d&sektion=8">popa3d(8)</a> 
d316 1
a316 1
<ul><pre>
d318 1
a318 1
</pre></ul>
a319 1
<p></p>
d324 1
a324 1
<p></p>
d341 1
a341 1
Envoyez un signal HUP &agrave; Sendmail avec la commande suivante :
d343 1
a343 1
   $<b>sudo kill -HUP `head -1 /var/run/sendmail.pid`</b>
a351 3
<p></p>
<p></p>
<p></p>
d355 2
a356 2
 
Pour utiliser SSL avec <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=httpd&sektion=8&format=html">httpd(8)</a>, 
d359 2
a360 1
  partie prises de la page de manuel <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssl&sektion=8&format=html">ssl(8)</a>. 
d364 4
a367 3
  d'informations &agrave; ce sujet, lisez la page de manuel <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssl&sektion=8&format=html">ssl(8)</a>.</p>
<p> Pour commencer, vous aurez besoin de cr&eacute;er votre cl&eacute; serveur 
  et le certificat en utilisant OpenSSL :</p>
d375 2
a376 2
<p> Ou si vous voulez que la cl&eacute; soit crypt&eacute;e avec un mot de passe 
  que vous devez saisir &agrave; chaque d&eacute;marrage des serveurs </p>
d384 1
a384 1
<p> La prochaine &eacute;tape consiste &agrave; g&eacute;n&eacute;rer une requ&ecirc;te 
d387 1
a387 1
  utilisez la commande suivante : </p>
d390 1
a390 1
  <pre>
d395 1
a395 1
<p> Le fichier <i>server.csr</i> pourra alors &ecirc;tre communiqu&eacute; &agrave; 
d400 1
a400 1
  mise en place pour permettre la signature des cl&eacute;s DSA.</p>
d402 2
a403 2
<p> Si vous ne pouvez pas vous permettre un tel service, ou si vous voulez auto 
  signer le certificat, vous pouvez utiliser la commande suivante :</p>
d413 2
a414 1
  devez &ecirc;tre d&eacute;sormais capable de d&eacute;marrer <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=httpd&sektion=8&format=html">httpd(8)</a> 
d417 1
a417 1
  443 de votre machine. </p> 
d424 1
a424 1
<p></p>
d426 2
a427 1
  g&eacute;n&egrave;re <i>/etc/passwd</i> dynamiquement avec <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pwd_mkdb&sektion=8&apropos=0">pwd_mkdb(8)</a>. 
d429 1
a429 1
  pwd_mkdb(8), </p>
d431 2
a432 2
<ul>
  <pre>
d439 4
a442 3
     /etc/spwd.db.tmp    fichier temporaire</pre>
</ul>
<P>Dans un fichier de mots de passe Unix traditionnel, toutes les informations 
d451 1
a451 1
<P>OpenBSD met &agrave; votre disposition un outil qui vous permet d'&eacute;diter 
d458 2
a459 1
  le contenu en m&ecirc;me temps que vous.</p>
a464 2
<p></p>
<p></p>
d476 2
a477 1
  est d'utiliser le script <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=adduser&sektion=8&format=html">adduser(8)</a>. 
d481 1
a481 1
  en utilisant <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&sektion=8&format=html">vipw(8)</a>. 
d483 1
a483 1
  de <i>/etc/passwd<i>, <i>/etc/group</i>, et les bases de donn&eacute;es shell. 
d489 2
a490 2
  L'utilisateur aura <b>guest </b>comme groupe et <i>/bin/ksh </i>comme shell.</p>
<ul><pre>
d523 13
a535 1
</pre></ul>
d537 1
a537 10
<p>Pour supprimer des comptes utilisateurs, utilisez la commande <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rmuser&sektion=8&format=html">rmuser(8)</a>. 
  Cette commande supprimera toute chose relative &agrave; l'utilisateur. Elle 
  supprimera son entr&eacute;e<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=crontab&sektion=1&format=html">crontab(1)</a>, 
  son r&eacute;pertoire $HOME (s'il lui appartient), et son courrier. Bien &eacute;videmment, 
  cette commande supprimera aussi les entr&eacute;es correspondantes dans <i>/etc/passwd 
  </i>et <i>/etc/group</i>. Comme exemple, nous allons utiliser cette commande 
  pour supprimer le compte utilisateur pr&eacute;c&eacute;demment cr&eacute;e. 
  Notez que la commande vous demande l'identifiant du compte et si oui ou non 
  elle doit supprimer le r&eacute;pertoire home de l'utilisateur. </p>
<ul><pre>
d549 1
a549 1
</pre></ul>
d556 4
a559 2
href="http://www.openbsd.org/cgi-bin/man.cgi?query=adduser&sektion=8&format=html">adduser(8)</a>, 
ce qui en facilite l'usage dans des scripts. </p>
d561 10
a570 11
  Voici une liste des commandes additionnelles : 
  <li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=group&sektion=8&format=html">group(8)</a> 
  <li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=groupadd&sektion=8&format=html">groupadd(8)</a> 
  <li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=groupdel&sektion=8&format=html">groupdel(8)</a> 
  <li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=groupinfo&sektion=8&format=html">groupinfo(8)</a> 
  <li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=groupmod&sektion=8&format=html">groupmod(8)</a> 
  <li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=user&sektion=8&format=html">user(8)</a> 
  <li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=useradd&sektion=8&format=html">useradd(8)</a> 
  <li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=userdel&sektion=8&format=html">userdel(8)</a> 
  <li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=userinfo&sektion=8&format=html">userinfo(8)</a> 
  <li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=usermod&sektion=8&format=html">usermod(8)</a> 
d579 2
a580 2
  dans l'exemple qui suit il est possible d'utiliser soit <b>user add </b>soit 
  <b>useradd</b>. Le choix est votre et ne change rien au r&eacute;sultat.</p>
d586 1
a586 1
  visualis&eacute;s comme suit :</p>
d588 1
a588 1
<ul><pre>
d597 1
a597 1
</pre></ul>
d605 2
a606 1
  commande. Vous devez donc utiliser, au pr&eacute;alable, l'utilitaire <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=encrypt&sektion=1&format=html">encrypt(1)</a> 
d609 2
a610 2
  Voici un exemple d'utilisation de la commande encrypt : </p>
<ul><pre>
d614 1
a614 1
</pre></ul>
d617 1
a617 1
  &agrave; cr&eacute;er le compte utilisateur :</p>
d619 1
a619 1
<ul><pre>
d622 1
a622 1
</pre></ul>
d629 1
a629 1
  les fichiers &agrave; partir de <i>/etc/skel</i> vers $HOME.</p>
d632 2
a633 2
  pour v&eacute;rifier rapidement que tout s'est bien pass&eacute; : </p>
<ul><pre>
d648 1
a648 1
</pre></ul>
d652 2
a653 2
  : </p>
<ul><pre>
d665 1
a665 1
</pre></ul>
d672 5
a676 2
</p>
<p> # <strong>userdel -r testuser</strong> </p>
d681 2
a682 1
  au compte, utilisez <b>-p </b> au lieu de <b> -r</b>.</p>
a686 1
<p></p>
d693 2
a694 1
  de mani&egrave;re interactive. Par d&eacute;faut, <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=adduser&sektion=8&format=html">adduser(8)</a> 
d700 1
a700 1
  <b>-A</b> de <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&sektion=8&format=html">ftpd(8)</a>, 
d702 2
a703 1
  se connecter ! </p>
d708 1
a708 1
<p></p>
d712 1
a712 1
  des quotas :</p>
d716 2
a717 2
  <li>Quotas utilisateur</li>
  <li>Quotas groupe</li>
d719 1
a719 1
<p></p>
d732 1
a732 1
  activ&eacute;s :</p>
d734 1
a734 1
<ul>
d738 1
a738 1
</ul>
d741 2
a742 1
  utilisons la commande <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=edquota&sektion=8&format=html">edquota(8)</a>. 
d746 2
a747 2
  Par exemple la commande :</p>
<ul>
d751 1
a751 1
</ul>
d753 1
a753 1
<p> Affichera un r&eacute;sultat similaire &agrave; : </p>
d755 1
a755 1
<ul>
d761 1
a761 1
</ul>
d763 2
a764 2
<p> Pour ajouter des limites, &eacute;diter l&agrave; pour donner un r&eacute;sultat 
  similaire &agrave; :</p>
d766 1
a766 1
<ul>
d772 1
a772 1
</ul>
d781 1
a781 1
  comme hardlimit. Ce qui cause un &eacute;chec d'allocation. </p>
d783 4
a786 3
  la commande <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=quotaon&sektion=8&format=html">quotaon(8)</a>. 
  Par exemple :</p>
<ul>
d790 1
a790 1
</ul>
d795 1
a795 1
  l'aide de <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=quota&sektion=1&format=html">quota(1)</a>. 
d798 2
a799 2
  fournira des statistiques sur les quotas. Par exemple :</p>
<ul>
d803 1
a803 1
</ul>
d805 1
a805 1
<p> Afficherait :</p>
d807 1
a807 1
<ul>
d813 1
a813 1
</ul>
d817 4
a820 2
<ul><pre># <strong>quotaoff -a</strong></pre></ul>
<p></p>
a825 1
<p></p>
d830 1
a830 1
  domaine Kerberos et d'un client.</p>
d835 1
a835 1
  Par exemple :</p>
d837 1
a837 1
<ul>
d841 1
a841 1
</ul>
d844 1
a844 1
<ul>
d848 1
a848 1
</ul>
d852 1
a852 1
  <b>/usr/ports/net/ntp/</b>. </p>
d855 1
a855 1
  &agrave; ce sujet :</p>
d858 4
a861 4
<li><a href="http://www.freebsd.org/doc/en_US.ISO8859-1/books/handbook/kerberos.html">The FreeBSD handbook</a> </li>
  <li>Utilisez la commande <strong>info kth-krb</strong></li>
<li><a href="http://web.mit.edu/kerberos/www/dialogue.html">Designing an Authentication System: a Dialogue in Four Scenes</a></li>
<li><a href="http://web.mit.edu/kerberos/www/papers.html#krb4">Papers and Documentation Describing KerberosIV</a></li>
d865 1
a865 1
<li><a href="http://www.amazon.com/exec/obidos/ASIN/0130614661/qid%3D930594963/">Network Security Private Communication in a Public World [Kaufman, Perlman, Speciner, 1995]</a></li> 
d871 1
a871 1
  dont le serveur principal est avalanche.ciarasystems.com.</p>
d875 1
a875 1
  par ce dernier. </p>
d877 1
a877 1
<ul>
d883 1
a883 1
</ul>
d888 3
a890 2
  maintenant. Pour plus d'informations &agrave; ce sujet, voir <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=krb.conf&sektion=5&format=html">krb.conf</a>.</p>
<ul>
d896 1
a896 1
</ul>
d904 6
a909 4
  d'informations, consultez la page de manuel <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=krb.realms&sektion=5&format=html">krb.realms</a>.</p>
<p>Nous allons maintenant ex&eacute;cuter <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=kdb_init&sektion=8&format=html">kdb_init(8)</a> 
  pour initialiser la base de donn&eacute;es Kerberos :</p>
<ul>
d920 1
a920 1
</ul>
d922 2
a923 1
<p>Ensuite nous devons utiliser <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=kstash&sektion=8&format=html">kstash(8)</a> 
d926 3
a928 3
  de la cl&eacute; ma&icirc;tre.</p>
<ul>
  <pre>
d937 1
a937 1
</ul>
d939 1
a939 1
  /etc/kerberosIV/master_key. </p>
d947 3
a949 3
  que <i>rcp</i>, <i>rlogin </i>et <i>rsh</i>.</p>
<ul>
  <pre>
d975 1
a975 1
Expiration date (enter yyyy-mm-dd) [ 1999-12-31 ] ? <strong>2002-12-31</strong>
d993 1
a993 1
Expiration date (enter yyyy-mm-dd) [ 1999-12-31 ] ? <strong>2002-12-31</strong>
d1000 1
a1000 1
</ul>
d1006 2
a1007 1
  ligne de commande, <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ext_srvtab&sektion=8&format=html">ext_srvtab(8)</a> 
d1010 2
a1011 2
  hostname.</p>
<ul>
d1025 1
a1025 1
</ul>
d1027 4
a1030 4
<p>Maintenant nous pouvons ajouter des utilisateurs &agrave; notre base.</p>
<ul>
  <pre>
[root@@avalanche kerberosIV] <strong>kdb_edit</strong>
d1059 1
a1059 1
</ul>
d1063 1
a1063 1
  du serveur Kerberos et d'activer le support Kerberos au niveau des services.</p>
d1065 1
a1065 1
<ul>
d1067 1
a1067 1
</ul>
d1071 1
a1071 1
<UL>
d1078 1
a1078 1
</ul>
d1081 1
a1081 1
<ul>
d1087 1
a1087 2
</ul>
<p></p>
d1095 1
a1095 1
  manuel FreeBSD</a>.</p>
d1100 1
a1100 1
  CIARASYSTEMS.COM ayant avalanche.ciarasystems.com comme serveur principal.</p>
d1104 1
a1104 1
  le contenu de ces deux fichiers :</p>
d1106 2
a1107 2
<ul>
  <pre>
d1116 1
a1116 1
</ul>
d1119 2
a1120 2
  nous utilisons <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=kinit&sektion=1&format=html">kinit(1)</a>.</p>
<ul>
d1128 1
a1128 1
</ul>
d1131 2
a1132 2
  avec <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=klist&sektion=1&format=html">klist(1)</a>.</p>
<ul>
d1141 1
a1141 1
</ul>
d1144 2
a1145 2
  nous effectuons les tests avec rlogin(1) et telnet(1).</p>
<ul>
d1157 1
a1157 1
</pre></ul>
d1160 2
a1161 2
<ul><pre>
$ <Strong>rlogin avalanche</strong>
d1166 1
a1166 1
</ul>
d1170 3
a1172 3
  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=kdestroy&sektion=1&format=html">kdestroy(1)</a>. 
  Par exemple :</p>
<ul>
d1181 1
a1181 1
</ul>
d1186 1
a1186 1
  configurez <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh&sektion=1&format=html">OpenSSH</a> 
d1190 1
a1190 1
  l'adresse IP du client list&eacute; dans le ticket.</p>
d1195 1
a1195 2
<p></p>
<p></p>
d1199 1
a1199 3
  serveur FTP anonyme, les logs g&eacute;n&eacute;r&eacute;s, ...etc.</p>
<p></p>
<p></p>
d1210 2
a1211 2
  les pages du manuel <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&sektion=8&format=html">ftp(8)</a> 
  et <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=chroot&sektion=2&format=html">chroot(2)</a>. 
d1213 1
a1213 1
  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=adduser&sektion=8&format=html">adduser(8)</a>. 
d1220 2
a1221 2
  devez modifier le fichier <i>/etc/adduser.conf</i>. </p>
<ul>
d1256 1
a1256 1
</ul>
d1264 5
a1268 2
  du manuel <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&sektion=8&format=html">ftp(8)</a>. 
</p>
a1269 2
  <b>Vous n'avez pas besoin</b> de cr&eacute;er un r&eacute;pertoire /home/ftp/usr 
  ou /home/ftp/bin. <BR>
d1271 1
a1271 1
    poss&eacute;d&eacute; par root avec les permissions 555.</li>
d1281 1
a1281 1
    dans spwd.db alors ne copiez pas ce fichier.</li>
d1284 1
a1284 1
    555. </li>
d1289 2
a1290 2
  les r&eacute;pertoires apr&egrave;s leur cr&eacute;ation :</p>
<ul>
d1313 1
a1313 1
</ul>
d1322 2
a1323 2
  ligne par d&eacute;faut dans <i>/etc/inetd.conf</i> est :</p>
<ul><pre>
d1325 1
a1325 1
</pre></ul>
d1334 2
a1335 2
  connexion vers syslog en plus des commandes ftp get, retrieve, etc.</p>
<ul><pre>
d1337 1
a1337 1
</pre></ul>
d1346 2
a1347 2
  : </p>
<ul><pre>
d1349 1
a1349 1
</pre></ul>
d1353 1
a1353 1
  relu sont fichier de configuration.</p>
a1355 1
<p>
d1358 1
a1358 1
    sera affich&eacute; aux personnes qui se connectent sur votre serveur ftp.</li>
d1360 1
a1360 1
    aux utilisateurs une fois authentifi&eacute;s sur votre serveur ftp.</li>
d1363 1
a1363 1
    dans le r&eacute;pertoire o&ugrave; ce fichier se trouve.</li>
a1370 1
<p></p>
d1372 1
a1372 1
<p>le d&eacute;mon <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&sektion=8&format=html">ftpd(8)</a> 
d1379 2
a1380 2
  d&eacute;faut :</p>
<ul><pre>
d1423 1
a1423 1
</pre></ul>
d1431 2
a1432 2
  &quot;ericj&quot; :</p>
<ul><pre>
d1439 1
a1439 1
</pre></ul>
d1444 2
a1445 2
  son r&eacute;pertoire HOME !</p>
<ul><pre>
d1472 1
a1472 1
</pre></ul>
a1477 1
<p></p>
d1485 1
a1485 1
  des correctifs ind&eacute;pendants de l'architecture.</p>
d1490 1
a1490 1
  le choix final revienne &agrave; l'administrateur.</p>
d1494 1
a1494 1
  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=talkd&sektion=8">talkd(8).</a></p>
d1503 1
a1503 1
  pas d&eacute;sirables sur la version de production.</p>
d1514 2
a1515 2
  devez avoir tout le code source au noyau.</p>
<p><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cvs&sektion=1">cvs(1)</a> 
d1521 1
a1521 1
</p>
d1523 2
a1524 2
  actuelle via <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cvs&sektion=1">cvs(1)</a>, 
  vous utiliseriez la ligne de commande suivante : </p>
d1547 1
a1547 1
  en utilisant les commandes pr&eacute;c&eacute;dentes.</p>
d1551 3
a1553 3
  besoin d'obtenir les sources via anoncvs. </p>
<ul>
  <pre>
d1577 1
a1577 1
</ul>
d1580 1
a1580 1
  le correctif que vous mettrez sous <i>src/</i></p>
d1630 107
a1736 1
<p>Une fois cette op&eacute;ration effectu&eacute;e, red&eacute;marrez le service.</p>
d1741 2
a1742 2
<a href= "faq9.html">[Section 9.0 - Migrer depuis Linux]</a>
<a href= "faq11.html">[Section 11.0 - Optimisation des Performances]</a>
d1744 1
a1744 1
</p>
d1750 2
a1751 2
Originally [OpenBSD: faq10.html,v 1.74 ]<br>
$Translation: faq10.html,v 1.10 2003/05/02 12:46:30 xsa Exp $<br>
@


1.4
log
@
broken version tags
@
text
@d22 15
a36 27
  <li><a href="#wheel"         >10.1 - Quand j'essaie de passer root &agrave; 
    l'aide de su, on me dit que je suis dans le mauvais groupe</a></li>
  <li><a href="#DupFS"         >10.2 - Comment dupliquer un syst&egrave;me de 
    fichiers ?</A></li>
  <li><a href="#rc"            >10.3 - Comment d&eacute;marrer des services en 
    m&ecirc;me temps que le syst&egrave;me ? (Vue d'ensemble de rc(8) )</A></li>
  <li><a href="#RelayingDenied">10.4 - Pourquoi les utilisateurs sont interdits 
    de relais quand ils envoient des mails &agrave; distance &agrave; travers 
    mon syst&egrave;me OpenBSD ?</a></li>
  <li><a href="#POP"           >10.5 - J'ai mis en place POP, mais j'ai des erreurs 
    quand j'acc&egrave;de &agrave; ma messagerie via POP. Que puis-je faire ? 
    </a></li>
  <li><a href="#HTTPS"         >10.6 - Configurer HTTP en mode s&eacute;curis&eacute; 
    &agrave; l'aide de SSL(8)</a></li>
  <li><a href="#vipw"          >10.7 - J'ai effectu&eacute; des changements dans 
    /etc/passwd avec vi(1), mais les changements ne semblent pas &ecirc;tre pris 
    en compte. Pourquoi ?</a></li>
  <li><a href="#AddDelUser"    >10.8 - Comment je cr&eacute;e un compte utilisateur 
    ? Ou je supprime un compte utilisateur ?</a></li>
  <li><a href="#FTPOnly"       >10.9 - Comment puis-je cr&eacute;er un compte 
    pour ftp uniquement ?</a></li>
  <li><a href="#Quotas"        >10.10 - Mise en place des quotas </a></li>
  <li><a href="#Kerberos"      >10.11 - Mise en place d'un Client/Serveur Kerberos</a></li>
  <li><a href="#AnonFTP"       >10.12 - Mise en place d'un serveur FTP Anonyme</a></li>
  <li><a href="#ftpchroot"     >10.13 - Confiner les utilisateurs &agrave; leur 
    r&eacute;pertoire HOME avec ftpd(8)</a> 
  <li><a href="#Patches"       >10.14 - Appliquer des correctifs sous OpenBSD</a> 
d119 3
d137 2
a138 1
<p><i>/etc/rc.conf</i>, <i>/etc/rc.local</i> et <i>/etc/rc.shutdown</i>. Les principaux 
d147 3
a149 1
  <li>Les variables de configuration sont lues &agrave; partir de <i>/etc/rc.conf</i>
d175 2
a176 2
  du syst&egrave;me. (Du moins pas &agrave; travers rc(8), lisez la <a href="faq10.html#AnonFTP">FAQ 
  Serveur FTP Anonyme</a> pour plus d'informations. ) Dans tous les cas, chaque 
d192 7
d305 5
a309 2
  si vous &ecirc;tes un site de haut vol, un FAI,...) ! Essayez cucipop ou un 
  autre service POP de la collection de ports OpenBSD. Ou peut-&ecirc;tre vous 
d316 2
a317 2
  Vous devez en cr&eacute;er un dans le fichier <i>/etc/group</i>. La ligne suivante 
  devrait suffire :
d325 27
d354 1
a354 1
<h2>10.6 - Configurer HTTP en mode s&eacute;curis&eacute; &agrave; l'aide de SSL(8)</h2>
d359 4
a362 5
<p>OpenBSD est fourni avec des librairies RSA et un service httpd supportant SSL 
  &agrave; partir de la version 2.8. Cependant, si vous utilisez OpenBSD 2.6 ou 
  2.7 vous devez utiliser des packages SSL fournis pour avoir le support SSL. 
  Pour plus d'informations, <b>man 8 ssl</b>. </p>
<p>Pour utiliser SSL avec <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=httpd&sektion=8&format=html">httpd(8)</a>, 
d371 1
a371 3
  et le certificat. Pour utiliser les fonctionnalit&eacute;s RSA, vous devez mettre 
  &agrave; jour libssl. Maintenant vous pouvez cr&eacute;er votre cl&eacute; en 
  utilisant OpenSSL :</p> 
d418 2
a419 1
  avec le drapeau <b>-DSSL</b>, activant ainsi les transactions https sur le port 
d424 1
a424 1
<a name="10.7"></a>
d428 3
a430 3
<p>Si vous &eacute;ditez /etc/passwdf, vos modifications seront perdues. OpenBSD 
  g&eacute;n&egrave;re /etc/passwd dynamiquement avec <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pwd_mkdb&sektion=8&apropos=0">pwd_mkdb(8)</a>. 
  Le fichier principal de mots de passe sous OpenBSD est /etc/master.passwd. D'apr&egrave;s 
d462 1
a462 1
<a name="10.8"></a>
d468 3
a470 5
<p>Sous OpenBSD 2.6, la commande <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=adduser&sektion=8&format=html">adduser(8)</a> 
  permet de cr&eacute;er des comptes utilisateurs. Dans la version 2.7, la commande 
  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=user&sektion=8&format=html">user(8)</a> 
  a &eacute;t&eacute; ajout&eacute;e pour permettre d'ajouter et de supprimer 
  des comptes utilisateurs et des groupes.
d477 1
a477 1
<p>La meilleure mani&egrave;re de cr&eacute;er un compte utilisateur sous OpenBSD 
d479 1
a479 1
  Ce script est param&eacute;trable &agrave; travers le fichier <b>/etc/adduser.conf</b>. 
d484 1
a484 1
  de <b>/etc/passwd<i>, </i>/etc/group</b>, et les bases de donn&eacute;es shell. 
d530 2
a531 2
  cette commande supprimera aussi les entr&eacute;es correspondantes dans <b>/etc/passwd 
  </b>et <b>/etc/group</b>. Comme exemple, nous allons utiliser cette commande 
d550 6
a555 5
<h3>10.8.2 - Cr&eacute;er des comptes utilisateurs via user(8)</h3>
<p>A partir de la version 2.7 de OpenBSD, plusieurs commandes ont &eacute;t&eacute; 
  ajout&eacute;es pour g&eacute;rer les utilisateurs et les groupes. Ces outils 
  sont moins interactifs que la commande <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=adduser&sektion=8&format=html">adduser(8)</a>, 
  ce qui en facilite l'usage dans des scripts. </p>
d570 1
a570 1
<h4>10.8.2.1 - Cr&eacute;ation effective des comptes utilisateurs</h4>
d663 1
a663 1
<h4>10.8.2.2 - Suppression des comptes utilisateurs</h4>
d678 1
a678 1
<h2>10.9 - Comment puis-je cr&eacute;er un compte pour ftp uniquement ?</h2>
d683 1
a683 1
  le fichier <b>/etc/shells</b>. Et quand vous cr&eacute;ez le compte utilisateur, 
d698 1
a698 1
<h2>10.10 - Mise en place des quotas</h2>
d812 1
a812 1
<h2>10.11 - Mise en place d'un Client/Serveur Kerberos</h2>
d867 1
a867 1
[root@@avalanche kerberosIV] <strong>cat krb.conf</strong>
d879 1
a879 1
[root@@avalanche kerberosIV] <strong>cat krb.realms</strong>
d896 1
a896 1
[root@@avalanche kerberosIV] <strong>kdb_init</strong>
d913 1
a913 1
[root@@avalanche kerberosIV] <strong>kstash</strong>
d996 1
a996 1
[root@@avalanche kerberosIV] <Strong>ext_srvtab avalanche</strong>
d1005 2
a1006 2
[root@@avalanche kerberosIV] <strong>mv avalanche-new-srvtab srvtab</strong>
[root@@avalanche kerberosIV] <strong>chmod 600 srvtab</strong>
d1066 3
a1068 3
[root@@avalanche /] <Strong>kill -HUP `cat /var/run/inetd.pid`</strong>
[root@@avalanche /] <Strong>/usr/libexec/kerberos >> /var/log/kerberos.log &</strong>
[root@@avalanche /] <strong>/usr/libexec/kadmind -n >> /var/log/kadmind.log &</strong>
d1092 1
a1092 1
[root@@gatekeeper kerberosIV] <strong>cat krb.conf</strong>
d1096 1
a1096 1
[root@@gatekeeper kerberosIV] <strong>cat krb.realms</strong>
d1106 1
a1106 1
xyz:jeremie% <Strong>kinit</strong>
d1118 1
a1118 1
xyz:jeremie$ <strong>klist</strong>
d1131 1
a1131 1
xyz:jeremie% <Strong>telnet avalanche</strong>
d1140 1
a1140 1
OpenBSD 2.5 (AVALANCHE) #5: Tue Apr  6 01:18:16 EDT 1999
d1145 1
a1145 1
xyz:jeremie% <Strong>rlogin avalanche</strong>
d1148 1
a1148 1
OpenBSD 2.5 (AVALANCHE) #5: Tue Apr  6 01:18:16 EDT 1999
d1158 1
a1158 1
xyz:jeremie% <strong>kdestroy</strong>
d1178 1
a1178 1
<h2>10.12 - Mise en place d'un serveur FTP Anonyme</h2>
d1210 2
a1211 2
oshibana# <strong>adduser</strong>
Use option ``-silent'' if you don't want see all warnings & questions.
d1278 1
a1278 1
oshibana# pwd 
d1280 1
a1280 1
oshibana# ls -laR ftp
d1338 2
a1339 1
  comment&eacute; dans <i>/etc/inetd.conf</i>.</p>
d1356 2
a1357 3
<a name="10.13"></a>
<h2>10.13 - Confiner les utilisateurs &agrave; leur r&eacute;pertoire HOME avec 
  ftpd(8) </h2>
d1375 1
a1375 1
230- OpenBSD 2.6 (GENERIC) #690: Fri Oct 29 16:32:17 MDT 1999
d1388 1
a1388 1
ftp> <strong>cd /</strong>
d1390 1
a1390 1
ftp> <strong>ls</strong>
d1409 1
a1409 1
ftp> <strong>quit</strong>
d1422 1
a1422 1
#       $OpenBSD: faq10.html,v 1.64 2002/02/05 23:24:13 nick Exp $
d1443 1
a1443 1
ftp> <strong>cd /</strong>
d1445 1
a1445 1
ftp> <strong>ls</strong>
d1458 1
a1458 1
ftp> <strong>quit</strong>
d1465 1
a1465 1
<h2>10.14 - Appliquer des correctifs sous OpenBSD</h2>
d1471 1
a1471 1
  page web &agrave; l'adresse <a href="../../errata.html">http://www.openbsd.org/errata.html</a>. 
d1482 1
a1482 1
  obtenu &agrave; partir de <a href="../../errata.html">errata.html</a> &agrave; 
d1488 1
a1488 1
<p>Tous les correctifs post&eacute;s sur <a href="../../errata.html">http://www.openbsd.org/errata.html</a> 
d1545 1
a1545 1
        patch -p0 < 026_talkd.patch
d1547 1
a1547 1
        make obj && make depend && make && make install
d1582 1
a1582 1
|       patch -p0 < 026_talkd.patch
d1584 1
a1584 1
|       make obj && make depend && make && make install
d1602 1
a1602 1
$ <b>make obj && make depend && make</b>
d1611 1
a1611 1
nroff -Tascii -mandoc /home/ericj/lsrc/src/libexec/talkd/talkd.8 > talkd.cat8
d1615 1
a1615 1
/usr/share/man/cat8/ntalkd.0 -> /usr/share/man/cat8/talkd.0
d1620 8
a1627 3
<p> <font color= "#0000e0"> <a href= "index.html">[Retour &agrave; l'Index G&eacute;n&eacute;ral]</a> 
  <a href= "faq9.html">[Vers la Section 9.0 - Migrer depuis Linux]</a> <a href= "faq11.html">[Vers 
  la Section 11.0 - Optimisation des Performances]</a> </font> </p>
d1633 2
a1634 4
Originally [OpenBSD: faq10.html,v 1.65 ]
<br>
$Translation: faq10.html,v 1.9 2002/07/30 07:06:27 jufi Exp $
<br>
@


1.3
log
@
sync with badlands translation CVS
@
text
@d1599 7
a1605 4
  <small>Originally [OpenBSD: faq10.html,v 1.65 2002/04/30 13:02:47 nick Exp ]</small><br>
<small>$Translation: faq10.html,v 1.8 2002/05/05 09:36:46 saad Exp $</small><br>
<small>$OpenBSD$</small><br>
<p></p>
@


1.2
log
@
syc with badlands translation CVS
@
text
@d85 1
a85 1
  privil&egrave;ges du super-utilisateur, sans pour autant les mettre dans le 
d131 2
a132 2
  <li>/etc/netstart - Script pour initializer le r&eacute;seau. Ne devrait pas 
    &ecirc;tre &eacute;dit&eacute;.
d378 2
a379 2
<p> Si vous ne pouvez pas vous permettre un tel service, ou si vous voulez auto-signer 
  le certificat, vous pouvez utiliser la commande suivante :</p>
d428 3
a430 3
  verouille aussi l'acc&egrave;s &agrave; ces fichiers de telle fa&ccedil;on &agrave; 
  en interdire l'acc&egrave;s &agrave; quiconque essaie d'en changer le contenu 
  en m&ecirc;me temps que vous.</p>
d568 7
a574 8
<p>Les param&egrave;tres ci-haut vont &ecirc;tre appliqu&eacute;s si vous ne les 
  positionnez pas &agrave; d'autres valeurs en utilisant des options lors de la 
  saisie de la ligne de commande. Par exemple, dans notre cas nous voulons que 
  l'utilisateur appartienne au groupe <b>guest </b> et non pas &agrave; <b>users</b>. 
  Il est &agrave; noter que lors de la cr&eacute;ation des comptes utilisateurs, 
  les mots de passe doivent &ecirc;tre sp&eacute;cifi&eacute;s sous leur forme 
  crypt&eacute;e en ligne de commande. Vous devez donc utiliser, au pr&eacute;alable, 
  l'utilitaire <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=encrypt&sektion=1&format=html">encrypt(1)</a> 
d1005 1
a1005 1
New Password:                &lt;---- resaisissez votre mot de passe
d1048 1
a1048 1
  de Kerberos sont toujours disponibles. Nous pouvons aussi ajouter les privileges 
d1286 1
a1286 1
  vont permettre de logguer les connexions anonymes dans <i>/var/log/ftpd </i>et 
d1291 1
a1291 1
  de ftpd en mode anonyme exclusif. On utilise aussi <i>-ll</i> qui loggue chaque 
d1335 1
a1335 1
  biais du fichier <b>/etc/ftpchroot</b>.Puisqu'on ne peut pas toujours faire 
d1441 1
a1441 1
  En m&ecirc;me temps, des correctifs aux probl&eacute;mes les plus communs sont 
d1498 1
a1498 1
  Il faut toujours v&eacute;rifier la revision de OPENBSD_version_number_BASE. 
d1508 1
a1508 1
  en utilisant les commandes ci-haut.</p>
d1593 1
a1593 1
  <a href= "faq9.html">[Vers la Section 9.0 - Migrer depuis Linux]</a> <a href= "../faq11.html">[Vers 
d1600 1
a1600 1
<small>$Translation: faq10.html,v 1.6 2002/05/02 07:14:40 saad Exp $</small><br>
@


1.1
log
@
sync with badlands translation CVS
@
text
@d43 1
a43 1
  <li><a href="#Quotas"        >10.10 - Mise en place des quotas disque utilisateur</a></li>
d46 3
a48 4
  <li><a href="#ftpchroot"     >10.13 - Restreindre les utilisateurs &agrave; 
    leur r&eacute;pertoire HOME avec ftpd(8)</a>
  <li><a href="#Patches"       >10.14 - Appliquer des correctifs dans l'environnement 
    OpenBSD.</a> 
d671 1
a671 1
<h2>10.10 - Setting up Quotas</h2>
d673 4
a676 6

<p>
Quotas are used to limit users space that they have available to them on
your drives. It can be very helpful in situations where you have limited resources.
Quotas can be set in two different ways. 
</p>
d680 17
a696 18
<li>User Quotas</li>
<li>Group Quotas</li>
</ul>
<p></p>

<p>
The first step to setting up quotas is to make sure that <tt>option
QUOTA</tt> is in your Kernel Configuration. This option is in the
GENERIC kernel. After this you need to mark in <i>/etc/fstab</i>
the filesystems which will have quotas enabled. The keywords
<tt>userquota</tt> and <tt>groupquota</tt> should be used
to mark each fs that you will be using quotas on. By default the files
<tt>quota.user</tt> and <tt>quota.group</tt> will be
created at the root of that filesystem to hold the quota information. This
default can be overwritten by doing, userquota=/var/quotas/quota.user. Or
whatever file you want to use for holding quota information. Here is an
example /etc/fstab that has one filesystem with userquotas enabled.
</p>
d704 6
a709 8
<p>
Now it's time to set the user's quotas. To do so you use the utility
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=edquota&sektion=8&format=html">edquota(8)</a>.
A simple use is just <strong>edquota &lt;user&gt;</strong>. edquota(8)
will use vi(1) to edit the quotas unless the environmental variable
EDITOR is set to a different editor. For example:
</p>

d716 1
a716 3
<p>
This will give you output similar to this:
</p>
d726 2
a727 3
<p>
To add limits, edit it to give results like this:
</p>
d737 11
a747 16
<p>
In this the softlimit is set to 1000 blocks and the hardlimit is set to
1050 blocks. A softlimit is a limit where the user is just warned when
they cross it and have until their grace period is up to get their disk
usage below their limit. Grace periods can be set by using the
<strong>-t</strong> option on edquota(8). After the grace period is over
the softlimit is handled as a hardlimit. This usually results in an
allocation failure.
</p>

<p>
Now that the quotas are set, you need to turn the quotas on. To do
this use <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=quotaon&sektion=8&format=html">quotaon(8)</a>.
For example:
</p>

d754 7
a760 9
<p>
This will go through /etc/fstab to turn on the filesystems with quota
options. Now that quotas are up and running, you can view them by
the <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=quota&sektion=1&format=html">quota(1)</a>.
Using a command of <strong>quota &lt;user&gt;</strong> will give that users
information. When called with no arguments the quota command will give your quota statistics. For
example:
</p>

d767 1
a767 3
<p>
Will result in output similar to this:
</p>
d777 2
a778 3
<p>
By default quotas set in /etc/fstab will be started on boot. To turn them
off use
d785 1
a785 1
<h2>10.11 - How to Setup Kerberos Clients and Servers under OpenBSD</h2>
d788 9
a796 13
<p>
As a user/administrator of OpenBSD systems, you are fortunate that
KerberosIV is an pre-installed component of the default system. Here is
a guide to setting up both the Kerberos realm server, as well as a
client.
</p>

<p>
An *EXTREMELY* important point to remember is that Kerberos clients
and servers must have their system clocks synchronized. If there is
more than a 5 minute time skew, you will receive weird errors that
do not immediately reveal themselves to be caused by time skew, such as:
</p>
d804 1
a804 2
Another more accurate error is:

d811 6
a816 7
<p>
An easy way to synchronize system clocks is with ntpd, available in the ports tree at
<strong>/usr/ports/net/ntp/</strong>.
</p>

This FAQ entry assumes you have prior knowledge of the Kerberos concepts.
For a great, easy to understand, reference, see:
d820 1
a820 1
<li>Use the command <strong>info kth-krb</strong></li>
d823 3
a825 1
</ul>Or the book<ul>
d829 1
a829 1
<h3>How to setup the Kerberos IV REALM and SERVER</h3>
d831 6
a836 8
<p>
We will be setting up the CIARASYSTEMS.COM realm, with avalanche.ciarasystems.com as the main server.
</p>

<p>
To start off, we will need to edit our configuration files. These files are located at <tt>/etc/kerberosIV/</tt>.
The two files we are concerned about are <i>krb.realms</i> and <i>krb.conf</i>. Let's start off with <i>krb.conf</i>.
</p>
d846 4
a849 6
<p>
As you can see, this tells kerberos that the domain is CIARASYSTEMS.COM (or logical realm) and that
within that domain, avalanche is the administration server. Next we will look at <i>krb.realms</i>. For more information
on this refer to <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=krb.conf&sektion=5&format=html">krb.conf</a>.
</p>

d858 9
a866 13
<p>
krb.realms provides a translation from a hostname to the Kerberos realm name for the services provided by that host.
Each line of the translation file is in one of the following forms (domain_name should be  of  the  form  .XXX.YYY).
So in this example, avalanche is the hostname of a computer on the CIARASYSTEMS.COM realm. And
.ciarasystems.com is the domain name on the realm CIARASYSTEMS.COM. Again, for further information read
the <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=krb.realms&sektion=5&format=html">krb.realms</a>. man page.
</p>

<p>
Next we will run <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=kdb_init&sektion=8&format=html">kdb_init(8)</a> 
to create the initial Kerberos database.
</p>

d880 4
a883 5
<p>
Next we need to use <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=kstash&sektion=8&format=html">kstash(8)</a> 
which is used to save the Kerberos key distribution center (KDC) database master key in the master key cache file.
</p>

d885 1
a885 1
<pre>
d894 13
a906 13
This saves the encrypted master password in /etc/kerberosIV/master_key.<p>

Next, we need two principals to be added to the database for each
system that will be secured with Kerberos. Their names are
<i>kpasswd</i> and <i>rcmd</i>. These two principals are made for
each system, with the instance being the name of the individual system. 

These daemons, <i>kpasswd</i> and <i>rcmd</i> allow other systems
to change Kerberospasswords and run commands like <i>rcp, rlogin</i> 
and <i>rsh</i>. 


<pre>
d925 1
a925 1
New Password:                <strong>&lt;----- Use 'RANDOM' as password</strong>
d943 1
a943 1
New Password:                 <strong>&lt;----- Use 'RANDOM' as password</strong>
d954 1
a954 1
Principal name:               <strong>&lt;----- Hit &lt;ENTER&gt; to end</strong>
d959 8
a966 8
<p>
A srvtab file is the service key file. These must be extracted from the  Kerberos key  distribution center database in
order for services to authenticate using Kerberos. For  each  hostname  specified  on
the command line, <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ext_srvtab&sektion=8&format=html">ext_srvtab(8)</a>
creates the service key file hostname-new-srvtab, containing all the entries in the database with an instance field of
hostname.
</p>

d983 1
a983 4
<p>
Now we can add users to our database.
</p>

d985 1
a985 1
<pre>
d1003 1
a1003 1
New Password:                &lt;---- enter a secure password here
d1006 1
a1006 1
New Password:                &lt;---- re-enter the password here
d1010 1
a1010 1
Attributes [ 0 ] ?
d1012 2
a1013 2
Principal name:          &lt;---- null entry here will cause an exit
			       or you can add more entries.
d1017 4
a1020 7
<p>
So now all the Kerberos particulars are setup. All that is left is to enable
boot-time loading of the Kerberos server and to enable Kerberized-daemons.
</p>

<p>
In /etc/rc.conf, set:
d1025 2
a1026 1
In /etc/inetd.conf, uncomment:
d1036 1
a1036 1
Then, either reboot, or:
d1046 16
a1061 19
<p>
Note: this is a rather simple server setup. Usually, redundant servers
are setup (as slave servers) so that if one server goes down, all the
services that depend on Kerberos don't go down. We can also add 'su'
privileges to a specific principal, see 
<a href="http://www.freebsd.org/doc/en_US.ISO8859-1/books/handbook/kerberos.html#AEN9189">the FreeBSD Handbook</a>.
</p>

<h3>How to kerberize your client workstation</h3>

<p>
We will be setting the workstation named <i>gatekeeper</i> to be in the
CIARASYSTEMS.COM realm, with avalanche.ciarasystems.com as the main server.
</p>

<p>
To start off, we need to setup our <i>krb.conf</i> and <i>krb.realms</i> like the above machine. This is so
<i>gatekeeper</i> will know what server is the KDC and what domain it is on. Again here are the file contents.
</p>
d1064 1
a1064 1
<pre>
d1075 2
a1076 4
<p>
Now that is set up, we need to initialize kerberos. To obtain a ticket you use <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=kinit&sektion=1&format=html">kinit(1)</a>.
</p>

d1087 2
a1088 4
<p>
Now we have identified we can list our tickets with <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=klist&sektion=1&format=html">klist(1)</a>.
</p>

d1100 2
a1101 4
<p>
Looks like we are set now. All that's left to do is test it. Here we will test it with rlogin(1) and telnet(1).
</p>

d1116 1
a1116 1
and 
d1125 4
a1128 6
<p>
We can tell that it is indeed using Kerberos to authenticate the rlogin
session. To get rid of any tickets issued, you would use <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=kdestroy&sektion=1&format=html">kdestroy(1)</a>.
For example:
</p>

d1140 8
a1147 8
<p>
Do not worry about 'Warning: no Kerberos tickets issued.' This is because
we're only doing kerberos authentication, not ticket passing. If you want
ticket passing, use <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh&sektion=1&format=html">OpenSSH</a> which has support.
Stock KerberosIV  doesn't have support for tgt passing, either - only the AFS kaserver's implementation of krb4,
since the regular KerberosIV kdc checks client IP address listed in the ticket.
</p>

d1151 8
a1158 1
<h2>10.12 - Setting up Anonymous FTP Services.</h2>
d1161 20
a1180 21
<p>
Anonymous FTP allows users without accounts to access files on your computer via the File Transfer Protocol. This
will give an overview of setting up the anonymous FTP server, and its logging, etc. 
</p>

<h3>Adding the FTP account</h3>

<p>
To start off, you need to have an account on your system of "ftp". This account shouldn't have a usable
password.  Here we will set the login directory to /home/ftp, but
you can put it wherever you want. When using anonymous ftp, the ftp daemon will
chroot itself to the home directory of the 'ftp' user. To read up more on that, read the <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&sektion=8&format=html">ftp(8)</a> and 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=chroot&sektion=2&format=html">chroot(2)</a> man pages. Here
is an example of adding the <i>ftp</i> user. I will do this using <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=adduser&sektion=8&format=html">adduser(8)</a>.
We also need to add /usr/bin/false to our <i>/etc/shells</i>, this is the &quot;shell&quot; that we will be giving to
the ftp user. This won't allow them to login, even though we will give them an empty password. To do this you
can simply <i>echo /usr/bin/false &gt;&gt; /etc/shells</i>. Also if you wish for that shell to show up during the adduser
questions, you need to modify <i>/etc/adduser.conf</i>.
</p>


d1218 1
a1218 23
<h3>Directory Setup</h3>

<p>
Along with the user, this created the directory <i>/home/ftp</i>. This is what we want, but there are some
changes that we will have to make to get it ready for anonymous ftp. Again these changes are explained in the
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&sektion=8&format=html">ftp(8)</a> man page.
</p>

<ul>
You <b>do not</b> need to make a /home/ftp/usr or /home/ftp/bin directory.
<BR>
<li><i>/home/ftp</i> - This is the main directory. It should be owned by root and have permissions of 555.</li>
<li><i>/home/ftp/etc</i> - This is entirely optional and not recommended, as it only serves to give out information on users which exist on your box.  If you want your anonymous ftp directory to appear to have real users attached to your files, you should copy /etc/pwd.db and /etc/group to this
directory. This directory should be mode 511, and the two files should be mode 444. These are used to give owner
names as opposed to numbers. There are no passwords stored in pwd.db, they are all in spwd.db, so don't copy that over.</li>
<li><i>/home/ftp/pub</i> - This is a standard directory to place files in which you wish to share. This directory should
also be mode 555.
</ul>

<p> 
Note that all these directories should be owned by ''root''. Here is a listing of what the directories should
look like after their creation.
</p>
d1220 29
d1274 1
a1274 7
<h3>Starting up the server and logging</h3>

<p>
With ftpd you can choose to either run it from inetd or the rc scripts can kick it off. These examples will show
our daemon being started from <a href="http://www.openbsd.org/cgi-bin/cvsweb/src/etc/inetd.conf">inetd.conf</a>.
First we must become familiar with some of the options to ftpd. The default line from <i>/etc/inetd.conf</i> is:
</p>
d1276 6
d1286 8
a1293 8
<p>
Here ftpd is invoked with <i>-US</i>. This will log anonymous connections to <i>/var/log/ftpd</i> and concurrent
sessions to <i>/var/run/utmp</i>. That will allow for these sessions to be seen via who(1). For some, you might
want to run only an anonymous server, and disallow ftp for users. To do so you should invoke ftpd with the
<i>-A</i> option. Here is a line that starts ftpd up for anonymous connections only. It also uses <i>-ll</i>
which logs each connection to syslog, along with the get, retrieve, etc, ftp commands.
</p>

d1298 8
a1305 7
<p>
Note - For people using HIGH traffic ftp servers, you might want to not invoke ftpd from inetd.conf. The best
option is to comment the ftpd line from inetd.conf and start ftpd from rc.conf along with the <i>-D</i> option.
This will start ftpd as a daemon, and has much less overhead as starting it from inetd. Here is an example line
to start it from rc.conf.
</p>

d1310 3
a1312 5
<p>
This of course only works if you have ftpd taken out of <i>/etc/inetd.conf</i>.
</p>

<h3>Other relevant files</h3>
d1316 7
a1322 3
<li><i>/etc/ftpwelcome</i> - This holds the Welcome message for people once they have connected to your ftp server.</li>
<li><i>/etc/motd</i> - This holds the message for people once they have successfully logged into your ftp server.</li>  
<li><i>.message</i> - This file can be placed in any directory. It will be shown once a user enters that directory.</li>
d1329 2
a1330 1
<h2>10.13 - Confining users to their home dir's in ftpd(8).</h2>
d1333 8
a1340 9
<p>
OpenBSD's <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&sektion=8&format=html">ftpd(8)</a> 
is setup by default to be able to handle this very easily. This is
accomplished via the file <strong>/etc/ftpchroot</strong>. Since users
cannot always be trusted, it might be necessary to restrain them to their
home directories. This behavior is NOT on by default. Here is an example
of what the default behavior is like.
</p>

d1386 7
a1392 8
<p>
As you can see here, access is granted to the whole server. In a perfect
world this is ok, where all users can be trusted, but this isn't so. To
limit a user, simply add their name to the file
<strong>/etc/ftpchroot</strong>. Here is an example showing user
&quot;ericj&quot; being restricted.
</p>

d1402 4
a1405 6
<p>
This is enough to keep the user &quot;ericj&quot; from escaping from his
own directory. As you can see in the next example. The / directory has
suddenly changed to his home dir!
</p>

d1438 1
a1438 1
<h2>10.14 - Applying patches in OpenBSD</h2>
d1441 46
a1486 59
<p>
The OpenBSD source tree is constantly changing and improving, 
along with this fixes to common problems are often made and patches
released to the public. These patches appear on the errata web page
located at <a href="../errata.html">http://www.openbsd.org/errata.html</a>, 
and are separated into categories. These categories correspond to patches
that should be applied to different architectures or architecture independent
patches.
</p>

<p>
Note, however, that patches aren't made for new additions to OpenBSD, 
and are only done for important reliability fixes or security problems
that should be addressed right away, although the choice to do so is, as
always, up to the administrator.
</p>

<p>
For the examples I will be patching 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=talkd&sektion=8">talkd(8)</a> 
with a security fix from the patch obtained from 
<a href="../errata.html">errata.html</a>.
</p>

<h3>How are these patches different from what I would find in the CVS tree?</h3>

<p>
All patches posted at <a href="../errata.html">http://www.openbsd.org/errata.html</a> are patches
directly against the latest release's source tree. Patches against the
latest CVS tree might also include other changes that wouldn't be wanted
on a release system.
</p>

<h3>Getting your system ready to be patched.</h3>

<p>
Patches for the OpenBSD Operating System are distributed as diffs, which
are text files that hold differences to the original source code. They are
<b>NOT</b> distributed in binary form. This means that to patch your system
you must have the source code from the <b>RELEASE</b> version of OpenBSD
readily available. This does not mean that you must have ALL source code
to the OpenBSD operating system to patch your system, but must have all
code for the program which you are patching. For instance, if you are 
patching the kernel you must have all source for the kernel on hand.
</p>

<p>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cvs&sektion=1">cvs(1)</a>
is a very handy tool that can be used to grab only the source that you need 
via any of the anonymous cvs servers located around the world. You can get a 
listing of these servers at <a href="http://www.openbsd.org/anoncvs.html">http://www.openbsd.org/anoncvs.html</a>.  
</p>

<p>
To retrieve the current release's source code using
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cvs&sektion=1">cvs(1)</a>, you would use
the following line: 
</p>

d1497 19
a1515 10
<p>
To find the CVS path to the code that you need, you can find this in the patch on the <i>Index:</i> line.
In this case, the CVS path was <i>src/libexec/talkd/</i>. Always check out the revision of OPENBSD_version_number_BASE. Without &quot;_BASE&quot; you will be checking out the stable branch, which might contain other changes that will interfere. If you are already tracking the patch branch, the patches should already be in that source, however you should always check and make sure. You can always look at <a href="../plus.html">http://www.openbsd.org/plus.html</a> to see which patches have been applied to the patch branch. If the patches haven't been applied yet, you will need to grab the latest release source using the commands above.
</p>

<p>
Also, for those users that bought official OpenBSD CDs, you can get the source code directly off of the CD. Refer to the CD insert on how to extract the source from the CD. In which case you won't need to obtain the source via anoncvs.
</p>

<ul><pre>
d1522 1
a1522 1
Index: libexec/talkd/announce.c <b>&lt;------ Path to sources </b>
d1538 2
a1539 5
</pre></ul>

<p>
Once you've obtained the proper sources, you can obtain the patch and place it in <i>src/</i>
</p>
d1541 3
a1543 1
<h3>Applying Patches</h3>
d1594 1
a1594 1
  <a href= "faq9.html">[Vers la Section 9.0 - Migrer depuis Linux]</a> <a href= "faq11.html">[Vers 
d1600 2
a1601 2
  <small>Originally [OpenBSD: faq10.html,v 1.64 2002/02/05 23:24:13 nick Exp ]</small><br>
<small>$Translation: faq10.html,v 1.4 2002/04/30 22:00:53 saad Exp $</small><br>
@

