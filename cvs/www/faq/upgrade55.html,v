head	1.44;
access;
symbols;
locks; strict;
comment	@# @;


1.44
date	2017.06.26.17.18.58;	author tb;	state Exp;
branches;
next	1.43;
commitid	jKVBuSx5No9bUpg1;

1.43
date	2017.03.25.19.07.05;	author tb;	state Exp;
branches;
next	1.42;
commitid	HspC9U4j3u1PNnAZ;

1.42
date	2017.03.25.18.03.37;	author tb;	state Exp;
branches;
next	1.41;
commitid	rL4ajudaGg7ru4hH;

1.41
date	2016.10.16.19.11.30;	author tb;	state Exp;
branches;
next	1.40;
commitid	XJczuXy5Z9mhvZdx;

1.40
date	2016.08.15.02.22.14;	author tb;	state Exp;
branches;
next	1.39;
commitid	3DeixV5YkPOb78RN;

1.39
date	2016.06.16.22.50.01;	author tj;	state Exp;
branches;
next	1.38;
commitid	F440HJjauf3xOR5c;

1.38
date	2016.06.16.14.36.00;	author tj;	state Exp;
branches;
next	1.37;
commitid	6gCpTRJwEHqbbahf;

1.37
date	2016.04.15.20.39.49;	author tb;	state Exp;
branches;
next	1.36;
commitid	jwteSMEb4rFzI8UA;

1.36
date	2016.04.09.22.55.45;	author tb;	state Exp;
branches;
next	1.35;
commitid	Wgx2QsAm21an230r;

1.35
date	2016.03.27.19.52.09;	author sthen;	state Exp;
branches;
next	1.34;
commitid	hi2ObFv9LGB98JY5;

1.34
date	2016.03.22.10.54.48;	author sthen;	state Exp;
branches;
next	1.33;
commitid	cyODCFvIgxpUoVc0;

1.33
date	2016.03.21.05.46.21;	author beck;	state Exp;
branches;
next	1.32;
commitid	zEx6zFkNSFFExu0v;

1.32
date	2015.07.08.01.11.32;	author nick;	state Exp;
branches;
next	1.31;
commitid	QIEEnBvMxTNfvnfo;

1.31
date	2015.07.02.05.49.04;	author bentley;	state Exp;
branches;
next	1.30;
commitid	AP3UllesavMDEUhQ;

1.30
date	2015.05.11.11.18.30;	author sthen;	state Exp;
branches;
next	1.29;
commitid	wRrXxcro6dFYiwF8;

1.29
date	2014.11.10.09.29.52;	author sthen;	state Exp;
branches;
next	1.28;
commitid	5SVRX5sqq7WlHWXj;

1.28
date	2014.11.10.09.23.34;	author sthen;	state Exp;
branches;
next	1.27;
commitid	oS1cOIeheNRF4cWq;

1.27
date	2014.11.01.18.10.02;	author nick;	state Exp;
branches;
next	1.26;
commitid	niXwXn4VLqQxVazW;

1.26
date	2014.10.22.17.26.39;	author nick;	state Exp;
branches;
next	1.25;
commitid	zQZtNuePK10DY0J1;

1.25
date	2014.08.31.21.23.34;	author nick;	state Exp;
branches;
next	1.24;
commitid	0I0OLO4vuxgS5pGp;

1.24
date	2014.08.07.01.51.34;	author nick;	state Exp;
branches;
next	1.23;
commitid	RZYBSFOBtVHeVEME;

1.23
date	2014.08.03.02.31.31;	author nick;	state Exp;
branches;
next	1.22;
commitid	m6kyAPdSkdMmAixN;

1.22
date	2014.05.21.23.21.40;	author brad;	state Exp;
branches;
next	1.21;

1.21
date	2014.05.14.02.40.11;	author nick;	state Exp;
branches;
next	1.20;

1.20
date	2014.05.14.01.50.16;	author guenther;	state Exp;
branches;
next	1.19;

1.19
date	2014.05.10.18.43.31;	author guenther;	state Exp;
branches;
next	1.18;

1.18
date	2014.05.07.02.47.18;	author sthen;	state Exp;
branches;
next	1.17;

1.17
date	2014.05.06.23.19.20;	author nick;	state Exp;
branches;
next	1.16;

1.16
date	2014.05.05.04.06.58;	author nick;	state Exp;
branches;
next	1.15;

1.15
date	2014.05.05.03.52.18;	author nick;	state Exp;
branches;
next	1.14;

1.14
date	2014.05.04.03.55.15;	author jsg;	state Exp;
branches;
next	1.13;

1.13
date	2014.05.02.17.02.23;	author chl;	state Exp;
branches;
next	1.12;

1.12
date	2014.05.02.13.49.03;	author nick;	state Exp;
branches;
next	1.11;

1.11
date	2014.05.01.13.38.22;	author nick;	state Exp;
branches;
next	1.10;

1.10
date	2014.04.30.20.58.12;	author nick;	state Exp;
branches;
next	1.9;

1.9
date	2014.04.30.12.00.54;	author nick;	state Exp;
branches;
next	1.8;

1.8
date	2014.04.29.20.47.55;	author nick;	state Exp;
branches;
next	1.7;

1.7
date	2014.04.29.18.36.31;	author nick;	state Exp;
branches;
next	1.6;

1.6
date	2014.04.29.17.37.30;	author nick;	state Exp;
branches;
next	1.5;

1.5
date	2014.04.21.16.32.05;	author nick;	state Exp;
branches;
next	1.4;

1.4
date	2014.04.21.15.36.37;	author nick;	state Exp;
branches;
next	1.3;

1.3
date	2014.04.15.17.38.47;	author nick;	state Exp;
branches;
next	1.2;

1.2
date	2014.04.15.04.43.34;	author nick;	state Exp;
branches;
next	1.1;

1.1
date	2014.04.15.03.17.01;	author nick;	state Exp;
branches;
next	;


desc
@@


1.44
log
@move man.openbsd.org links from http:// to https://
reduces the number of http:// links in www/ from >33k to <7k

thanks to schwarze for doing the work
@
text
@<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>OpenBSD Upgrade Guide: 5.4 to 5.5</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name="description"   content="OpenBSD Upgrade Process for 5.4 -> 5.5">
<meta name="copyright"     content="This document copyright 2014 by OpenBSD">
<meta name="viewport"      content="width=device-width, initial-scale=1">
<link rel="stylesheet"     type="text/css" href="../openbsd.css">
<link rel="canonical"      href="https://www.openbsd.org/faq/upgrade55.html">
</head>

<body bgcolor="#ffffff" text="#000000">

<h2>
<a href="../index.html">
<font color="#0000ff"><i>Open</i></font><font color="#000084">BSD</font></a>
<font color="#e00000">Upgrade Guide: 5.4 to 5.5</font>
</h2>
<hr>
<p>
<a href="index.html">[FAQ Index]</a> |
<a href="upgrade54.html">[5.3 -> 5.4]</a> |
<a href="upgrade56.html">[5.5 -> 5.6]</a>

<p>

<i>Note: Upgrades are only supported from one release to the release
immediately following it.
Do not skip releases.
If you got lucky skipping releases in the past, you may not this time.</i>

<p><i>
It is highly recommended that you read through and fully understand
this process before attempting it.
If you are doing it on a critical or physically remote machine, it is
recommended that you test this process on an identical, local system to
verify its success before attempting on a critical or remote computer.
</i>

<p>
Upgrading is a convenient way to bring your OpenBSD system up to the most
recent version.
However, the results are not intended to precisely match the results of
a wipe-and-reload installation.
Old library files in particular are not removed in the upgrade process,
as they may be required by older applications that may or may not be
upgraded at this time.
If you REALLY wish to get rid of all these old files, you are probably
better off reinstalling from scratch.

<p>
Table of Contents:
<ul>
<li><a href="#before">Before upgrading</a>
  <ul>
  <li><a href="#time_t">Year 2038 ready</a>
  <li><a href="#signed">Releases signed</a>
  <li><a href="#popa3d">popa3d removed</a>
  <li><a href="#identd">identd(8) replaced</a>
  <li><a href="#pfqueue">pf queue changes</a>
  <li><a href="#smtpd.conf">smtpd.conf changes</a>
  <li><a href="#noi386java">No Java on i386</a>
  <li><a href="#multibooters">Multiboot users</a>
  <li><a href="#headsup">Advanced notice: Big changes coming!</a>
  <li><a href="#chkkern">Check the kernel</a>
  </ul>
<li><a href="#upgrade">The upgrade process</a>
<li><a href="#final">Final steps</a>
  <ul>
  <li><a href="#sysmerge">Merging changed files via sysmerge(8)</a>
  <li><a href="#RmFiles">Files to delete and move</a>
  <li><a href="#Kernchk">Checking the kernel</a>
  <li><a href="#Pkgup">Upgrading packages</a>
  </ul>
</ul>

<hr>
<p>
<h2 id="before">Before upgrading: things to think about and be aware of</h2>
This is <i>not</i> a complete list of the changes that took place
between 5.4 and 5.5, but rather some of the important things that will
impact users in the upgrade process.
For a more complete list of changes, see
<a href="../plus55.html">plus55.html</a> and the CVS change logs.

<ul>
<li id="time_t"><b>Year 2038 ready</b><br>
(For those not aware, Unix historically used a signed 32 bit counter to
track time.
This will roll over in January, 2038, and flip back to December, 1901
if not fixed before then.)

<p>
OpenBSD 5.5 is year 2038 ready on all platforms, but this required a
change to a 64 bit time type, which should cover us for the next 290
billion years.
This results in a "flag day" event, where old binaries will not run
on the new kernel, and the new binaries won't run on the old kernel,
and some file formats will be changing.
A remote, no-console upgrade process is provided below, but it will be a
more touchy process than usual.
If you can possibly do this upgrade with a console, this is highly
recommended.
This may also be a good time to consider a reload from scratch or to
rebuild on new hardware.
It is suggested you practice remote upgrades on a similar
system with similar applications with a local console before remotely
upgrading critical systems.

<p>
The system accounting log will change format; extract any needed active
accounting data from the system BEFORE upgrade.
After the upgrade, you will be deleting a number of old files including
the old accounting log file; a new one will be created on your next
reboot.

<p>
If you are using
<a href="https://man.openbsd.org/ldapd.8">ldapd(8)</a>,
the btree database file format will not be compatible.  To preserve data
you must dump the contents of any databases (for example, to LDIF) and
reload them afterward.

<p>
All packages and user-created binaries must be removed from the system
prior to the upgrade, and reloaded afterwards.

<p>
Reminder: if you rely on anything from packages for management
access to the system (for example: shells, VPN software, routing daemons,
etc), arrange alternative access before removing packages.

<p>
Various packages use non-portable data formats in cache files, etc.
If you run into problems it may be necessary to remove these.

<p>
Note that any conversions or data exports may need to be done BEFORE
packages are unloaded and before the upgrade takes place.

<li id="signed"><b>Releases signed</b><br>
OpenBSD releases are now cryptographically signed using the new
<a href="https://man.openbsd.org/signify.1">signify(1)</a>
utility.
However, the install media with all file sets (<tt>install55.fs</tt>,
<tt>install55.iso</tt>) cannot self-check, nor should they.
After all, if someone has delivered a compromised install set to you,
they would probably have set it to say "all is well."
<p>
Instead, you should <a href="faq4.html#Download">verify your install media
file</a> separately, then install without further concern.

<p>
<li id="popa3d"><b>popa3d removed</b><br>
The POP3 daemon has been removed.
Alternatives are available in packages, such as:
<a href="https://www.synflood.at/akpop3d.html">akpop3d</a>,
<a href="http://www.courier-mta.org/pop3d.html">courier-pop3</a>
and others.
Note that sendmail will be <a href="#headsup">removed</a> for 5.6, so
this might be a good time to reconsider your entire mail system design
(note: OpenSMTPD can deliver directly to a Maildir).

<p>
<li id="identd"><b><a href="https://man.openbsd.org/identd.8">identd(8)</a>
has been replaced</b><br>
The new version runs as a daemon, rather than from
<a href="https://man.openbsd.org/inetd.8">inetd(8)</a>.
So, you will need to set your desired flags in <tt>/etc/rc.conf.local</tt>
and remove them from <tt>/etc/inetd.conf</tt>.

<p>
<li id="pfqueue"><b>pf queue changes</b>
PF has a new implementation of packet queueing - the configuration
syntax is different to that used by altq.
During a transition period, the old mechanism is still available by
replacing "queue" keywords in /etc/pf.conf with "oldqueue".
If instead you wish to switch to the new implementation, review the
documentation in
<a href="https://man.openbsd.org/pf.conf.5">pf.conf(5)</a>.

<p>
<li id="smtpd.conf"><b>smtpd.conf changes</b><br>
<a href="https://man.openbsd.org/smtpd.8">smtpd(8)</a>
configuration file parser was updated.
Some changes might require existing setups to be adapted.
<p>
SSL certificates must be explicitly defined,
and the "certificate" keyword becomes "pki" in listen and relay rules.
<pre>
  pki mail.example.com certificate "/etc/ssl/mail.example.com.crt" \
                       key "/etc/ssl/private/mail.example.com.key"
  listen on egress tls pki mail.example.com auth
</pre>
<p>
The "ssl" keyword in relay URLs becomes "secure".
<pre>
  table secrets file:/etc/mail/secrets
  accept for any relay via secure+auth://label@@some.mx auth &lt;secrets&gt;
</pre>
<p>
Rules matching on source address must use "from source" rather than just "from".
<pre>
  accept from source "192.168.0.0/16" for any relay
</pre>
<p>
The "helo" keyword in relay rules becomes "hostnames".
<pre>
  accept for any relay source &lt;source&gt; hostnames &lt;htable&gt;
</pre>
<p>
See <a href="https://man.openbsd.org/smtpd.conf.5">smtpd.conf(5)</a>
for more details.

<p>
<li id="noi386java"><b>No Java on i386</b><br>
Be aware that Java is currently broken on i386, so packages are not available.
If you rely on Java on OpenBSD, you will either need to make a new installation
with the amd64 architecture (which supports 64-bit Intel CPUs as well as AMD
CPUs), stay with an older version of OpenBSD, or upgrade to 5.6.

<p>
<li id="multibooters"><b>Multiboot users: may have to reconfigure for a relocated
<tt>/boot</tt> file:</b>
Some multiboot systems utilize the process of grabbing a copy of the
partition boot record (PBR) and using that to start the OpenBSD boot
process.
Historically, upgrades did not relocate <tt>/boot</tt>, so your old PBR
would continue to work.
The upgrade process of 5.5 WILL relocate <tt>/boot</tt> and regenerate
the PBR, thus multiboot users that use a stored PBR will have to copy
over the new PBR as they did originally.
Failure to do this will result in an "<tt>ERR M</tt>" at boot.

<p>
<li id="headsup"><b>Advanced notice: Big changes coming for future releases!</b><br>
There are some big changes coming up in OpenBSD 5.6 and 5.7 (NOT 5.5!)
that you may wish to think about and plan for.
<ul>
<li>Platforms removed for 5.6: hp300, mvme88k, mvme68k.
This is expected to impact no serious users.
<li>OpenBSD's version of Apache 1.3 and nginx will be removed from base
in favor of an internally developed httpd server in 5.6 and 5.7, respectively.
Apache 1.3 and nginx will become a <a href="faq15.html">package</a> for
those with applications dependent upon it.
<li>sendmail will be removed from base in favor of
<a href="https://www.opensmtpd.org">OpenSMTPD</a>, but sendmail will be
available as a package.
<li>BIND (named) will be removed from base in 5.7 in favor of
<a href="https://man.openbsd.org/nsd.8">nsd(8)</a>
(authoritative DNS) and
<a href="https://man.openbsd.org/unbound.8">unbound(8)</a>
(recursive resolver).
Packages will exist for BIND.
<li>FTP will no longer be an install option for 5.6.
Instead, HTTP will be used.
This should not impact users of public mirrors, but if you replicate
internally, you may wish to make sure your files can be served by HTTP.
<li>Kerberos will be removed from base OpenBSD for 5.6, though should be
available as a package.
</ul>

<p>
<li id="chkkern"><b>Check the kernel:</b>
Although <b>most people can skip this step</b>, if you had a modified kernel
in 5.4, it is likely you will need to modify the stock kernel of 5.5.
Especially when you are performing the upgrade process remotely, now is
the time to make sure the new kernel will work upon rebooting the machine.
If any changes must be made to the kernel, the safest thing to do is to
make those changes on a local 5.5 system.
This can be as simple as modifying a specific device using
<a href="https://man.openbsd.org/config.8">config(8)</a>,
or it can involve a recompilation if the option you need is not included
in the GENERIC kernel.
Please consult <a href="faq5.html">FAQ 5 - Building the system from source</a>
before deciding to recompile your kernel.

</ul>

<p>
<hr>
<h2 id="upgrade">The upgrade process</h2>

<h3>*Special process* Before Upgrading: uninstall packages!</h3>
Due to the time_t change, virtually all old binaries will not work on
the upgraded system, so all packages must be removed PRIOR to upgrading.
<ul>
<li>Review and adjust your system so you can get access to it with NO
packages installed -- i.e., not dependent upon added shells or special
access systems.  You might want to verify you can log in as root and
that root uses a standard shell (i.e., ksh).

<li>Review the <a href="#Pkgup">package notes</a> below, before doing
this, as some packages require prep BEFORE removal.

<li>Save a record of what packages you had installed, manually and
automatically:
<blockquote><pre>
<b>pkg_info -mq >/root/pkg_list_manual
pkg_info -q >/root/pkg_list_full</b>
</pre></blockquote>

<li>Stop all packages.
The next step will remove the scripts that gracefully shut them down,
so they will be "hard-stopped" at the reboot, which may corrupt data if
they are not stopped now.
This is a good time to make sure that you aren't using any packages to
access and maintain the system!

<li>Remove all packages (except firmware packages):
<blockquote><pre>
<b>pkg_delete -X /var/db/pkg/*-firmware-[0-9]*</b>
</pre></blockquote>

<li>If you have any other system binaries which you installed without
using the package system, remove those as well.
</ul>

<h3>Upgrading by install kernel</h3>
If you have access to the system's console, the easiest and safest way
to upgrade is to boot from the install kernel by boot media or
<a href="faq4.html#bsd.rd">bsd.rd</a> and follow the upgrade steps,
which are very similar to the <a href="faq4.html">install process</a>.

<p>
Afterwards, complete the upgrade by following the <a href="#final">final
steps</a> as detailed below.

<p>
One easy way to boot from the install kernel is to place the 5.5 version
of <i>bsd.rd</i> in the root of your boot drive, then instruct the boot loader
to boot using this new <i>bsd.rd</i> file.
On amd64 and i386, you do this by entering "<tt>boot bsd.rd</tt>" at the
initial <tt>boot&gt;</tt> prompt.

<h3>Upgrading without install kernel</h3>
<i>This is NOT the recommended process.  Use the install kernel method
if at all possible!</i>

<p>
Sometimes, one needs to do an upgrade of a machine when one can't easily
use the normal upgrade process.
The most common case is when the machine is in a remote location and you
don't have easy access to the system console.
One can usually do this by carefully following this process:

<ul>
<li><b>Place install files in a "good" location</b>.
Make sure you have sufficient space!
Running out of space on a remote upgrade could be...unfortunate.
Note that using softdeps can exaggerate the situation as deleted and
overwritten files do not release their space immediately.
Having at least 200MB free on /usr would be recommended.

<p>
<li><b>Prepare for first reboot after time_t change</b>.
The time_t change requires rebuilding a some files, including the
<tt>/etc/master.password</tt> file.
Without this being done, you cannot log in after the reboot!
This is done automatically by the upgrade script, but has to be done
manually on first boot after upgrade by creating a <tt>/etc/rc.firsttime</tt>:
<blockquote><pre>
<b>echo "/usr/sbin/pwd_mkdb -d /etc /etc/master.passwd" >>/etc/rc.firsttime
echo "cp /dev/null /var/log/lastlog" >>/etc/rc.firsttime
echo "cp /dev/null /var/log/wtmp" >>/etc/rc.firsttime</b>
</pre></blockquote>
This will regenerate the password file and delete a couple files that will
not work after the time_t change.

<p>
<li><b>Become root with ksh(1):</b>
While using
<a href="https://man.openbsd.org/sudo.8">sudo(8)</a>
before each command is generally a good practice, the sudo(8) command
will be broken by the last steps, so you should be root before starting
this process.
Also, the use of the OpenBSD
<a href="https://man.openbsd.org/ksh.1">ksh(1)</a>
shell is assumed.

<p>
<li><b>Stop any appropriate applications:</b>
During this process, all the userland applications will be replaced but
may not be runnable, and strange things may happen as a result.
Shutdown scripts will not be able to run!
There may be other applications which you wish to keep from running
immediately after the upgrade, stop and disable them as well.

<p>
<li><b>Disable package daemons and local shutdown commands:</b>
The last steps in the upgrade process may result in various commands,
especially those which are dynamically linked, being broken.
In particular, this may prevent a normal shutdown of daemons listed
in pkg_scripts, or additional commands in /etc/rc.shutdown, which may
cause the machine to hang at shutdown.
Before you proceed with the upgrade, edit /etc/rc.conf.local and
comment out any pkg_scripts lines.
Also, inspect /etc/rc.shutdown and comment out any local shutdown commands.
These can be reinstated post upgrade.

<p>
<li><b>Install new boot blocks:</b>
This should actually be done at the end of any upgrade, but we will
assume this has been neglected.
Failure to do this may break serial console or other things, depending
on platform.
<p>
See the man page for installboot(8) for YOUR platform and your current
version of OpenBSD, but for i386/amd64 v5.4, assuming you boot from sd0,
you will want to do something like this:

<blockquote><pre>
<b>cd /usr/mdec
cp boot /boot
./installboot -v /boot ./biosboot sd0</b>
</pre></blockquote>
Note that snapshot users may have a very different installboot(8) process!

<p>
<li><b>Install new kernel(s):</b>

<ul>
<li>If using a single processor kernel:
<blockquote><pre>
<b>export RELEASEPATH=</b><i>/usr/rel</i>   <i># where you put the files</i>
<b>cd ${RELEASEPATH}</b>
<b>rm /obsd ; ln /bsd /obsd && cp bsd /nbsd && mv /nbsd /bsd</b>
<b>cp bsd.rd bsd.mp /</b>
</pre></blockquote>
(note: you will get a harmless error message if your platform doesn't
have a bsd.mp):
<p>

<li>If you are using the multiprocessor kernel:
<blockquote><pre>
<b>export RELEASEPATH=</b><i>/usr/rel</i>   <i># where you put the files</i>
<b>cd ${RELEASEPATH}</b>
<b>rm /obsd ; ln /bsd /obsd && cp bsd.mp /nbsd && mv /nbsd /bsd</b>
<b>cp bsd.rd /</b>
<b>cp bsd /bsd.sp</b>
</pre></blockquote>
</ul>

<p>
Note the extra steps for copying over the primary kernel: those are done
to ensure that there is always a valid copy of the kernel on the disk
that the system can boot from should there be a really badly timed power
outage or system crash.
For this upgrade, however, this is not a major concern.
You need to upgrade the kernel and userland together here, or things
will not work.

<p>
<li><b>Save a copy of reboot(8), install new userland applications.</b>
You are still running the old kernel, it is possible the new reboot
command will not run on the old kernel, so we will start by saving a
copy of the old reboot command.
<i>Do NOT install <tt>etc55.tgz</tt> and <tt>xetc55.tgz</tt> now, because
that will overwrite your current configuration files!</i>
Note that we are installing base55.tgz LAST, because it will include a new
<a href="https://man.openbsd.org/tar.1">tar(1)</a>
utility, which may or may not run on the old kernel.
We reboot immediately, as the system is probably barely runnable after
the unpacking of all the new files.

<blockquote><pre>
<b>cp /sbin/reboot /sbin/oreboot</b>
<b>tar -C / -xzphf xserv55.tgz</b>
<b>tar -C / -xzphf xfont55.tgz</b>
<b>tar -C / -xzphf xshare55.tgz</b>
<b>tar -C / -xzphf xbase55.tgz</b>
<b>tar -C / -xzphf game55.tgz</b>
<b>tar -C / -xzphf comp55.tgz</b>
<b>tar -C / -xzphf man55.tgz</b>
<b>tar -C / -xzphf base55.tgz</b> # Install last!
<b>/sbin/oreboot</b>
</pre></blockquote>

Not all file sets will need to be installed for all applications,
however if you installed a file set originally, you should certainly
upgrade it with the new file set now.

<p>
Again, the files in <tt>/etc</tt> are handled separately below, so
<tt>etc55.tgz</tt> and <tt>xetc55.tgz</tt> are NOT unpacked here.

<p>
<li><b>After reboot completes, upgrade <tt>/dev</tt>.</b>
The new
<a href="https://man.openbsd.org/OpenBSD-5.5/i386/MAKEDEV">MAKEDEV</a>
file was copied to /dev by the installation of
<tt>base55.tgz</tt>, so you simply need to do the following:
<blockquote><pre>
<b>cd /dev</b>
<b>./MAKEDEV all</b>
</pre></blockquote>

<li><b>Install the upgraded boot loader:</b>
Note that for OpenBSD 5.5,
<a href="https://man.openbsd.org/installboot.8">installboot(8)</a>
has been "unified" across platforms, so a common (and simplified!) syntax
can be used:
<blockquote><pre>
<b>installboot -v sd0</b>
</pre></blockquote>
assuming "sd0" is your boot disk.

</ul>

<hr>
<h2 id="final">Final steps</h2>

Whether you upgrade by using an install kernel and doing a formal
"upgrade" process, or do a "in-place" binary upgrade, you need to do a
few final steps to complete the upgrade.

<p>
<h3 id="sysmerge">1. Merging changed files via sysmerge(8)</h3>

The
<a href="https://man.openbsd.org/sysmerge.8">sysmerge(8)</a>
utility will compare the files that are actually on your system with
those that would be installed in a fresh install, and assist you in
merging the changes into your system.
There are no assumptions made about
what is actually on your system, so you can use sysmerge(8) to move
between more arbitrary <a href="faq5.html#Flavors">points in the
development process</a>, such as from an earlier <i>5.4-current</i> to
<i>5.5-release</i> or from one <i>-current</i> to a later one.
Sysmerge(8) compares the current files on your system with the files
that would have been installed with a new install, and what would have
been there from the last run of sysmerge.
Usually, it can figure out what to do to update your files.
If it has difficulty, it will give you the option of keeping the old
file, installing the new file, or assisting you in the manual merging of
the old and new files, using
<a href="https://man.openbsd.org/sdiff.1">sdiff</a>.

<p>
Please read the
<a href="https://man.openbsd.org/sysmerge.8">sysmerge(8)</a>
manual page before using it on your system.
You are also advised to read the
<a href="https://man.openbsd.org/diff.1">diff(1)</a>,
<a href="https://man.openbsd.org/sdiff.1">sdiff(1)</a>
and even review
<a href="https://man.openbsd.org/more.1">more(1)</a>
manual pages before continuing.
A wide terminal window (i.e., significantly more than 80 characters), if
available, will make sdiff(1) easier to use.

<p>
Assuming the <tt>SHA256.sig</tt>, <tt>etc55.tgz</tt> and <tt>xetc55.tgz</tt> files exists in
your ${RELEASEPATH}, run it with:

<blockquote><pre>
<b>sysmerge -s ${RELEASEPATH}/etc55.tgz -x ${RELEASEPATH}/xetc55.tgz</b>
</pre></blockquote>

(if you don't have SHA256.sig available, use the -S option to skip the
signature check)

For the files sysmerge(8) can't resolve on its own, it will show you a
unified
<a href="https://man.openbsd.org/diff.1">diff(1)</a>,
run through your favorite $PAGER (i.e.,
<a href="https://man.openbsd.org/more.1">more(1)</a>)
and ask you if you wish to:
<blockquote><pre>
  Use 'd' to delete the temporary ./var/www/htdocs/index.html
  Use 'i' to install the temporary ./var/www/htdocs/index.html
  Use 'm' to merge the temporary and installed versions
  Use 'v' to view the diff results again

  Default is to leave the temporary file to deal with by hand
</pre></blockquote>

<p>
If you wish to retain your existing file, delete the temporary file.
If you wish to replace your existing file with the new version, install the
temporary file.
If you wish to merge the two together, choosing 'm' will put you into
<a href="https://man.openbsd.org/sdiff.1">sdiff(1)</a>,
where you can manually merge the file.
The default is to come back and deal with the file later, manually.

<p>
Sysmerge(8) saves all your replaced files into a temporary directory,
similar to <tt>/var/tmp/sysmerge.24959/backups</tt>, so if you accidentally
clobber something that was probably not such a good idea, you have a chance
to recover it. Note that
<a href="https://man.openbsd.org/daily.8">daily(8)</a>
cleans old files from this directory, but it will survive a reboot.

<!-- p>
<b>Sysmerge notes for 5.3 -> 5.4:</b><br>
<ul>
<li><b><tt>/etc/sysctl.conf</tt>:</b>
The changes to <tt>sysctl.conf</tt> are all commented out items, so not
installing the changed file will not directly change your system's
behavior.
Blindly installing the new default over your old, customized file
will often cause significant annoyance.
However, the new file shows the defaults and common options that are
available, so you may wish to manually merge the changes into your file,
or install the new file and put your changes back into the new file.

</ul -->

<h3 id="RmFiles">2. Files to delete and move</h3>
Some files should be deleted from your system, and others
must be moved or updated.
Note that some of these may not exist on all systems; that's ok.
Copy and paste the following lines:
<blockquote><pre>
<b>rm -f /usr/libexec/identd
rm -f /usr/lib/libcompat.a /usr/lib/libcompat_p.a
rm -f /usr/include/{re_comp,regexp,sgtty,sys/timeb}.h
rm -f /usr/share/man/man3/{re_comp,re_exec,rexec,regexp}.3
rm -f /usr/share/man/man3/{cuserid,ftime,gtty,setrgid,setruid,stty}.3
rm -f /etc/rc.d/popa3d
rm -f /usr/bin/{crunchgen,nawk}
rm -f /usr/sbin/{iopctl,popa3d}
rm -f /usr/share/man/man8/{iopctl,popa3d}.8
rm -rf /usr/X11R6/include/freetype2/freetype
rm -f /usr/X11R6/include/ft2build.h
rm -f /usr/mdec/installboot
rm -f /usr/share/man/man8/{amd64,i386}/installboot.8
rm -f /var/account/acct
rm -f /var/games/tetris.scores

mv /etc/nsd.conf /var/nsd/etc/nsd.conf
cd /usr/sbin && rm nsd-notify nsd-patch nsd-xfer nsd-zonec nsdc
cd /usr/share/man/man8 && rm nsd-notify.8 nsd-patch.8 nsd-xfer.8 \
   nsd-zonec.8 nsdc.8
chown _nsd /var/nsd/db/nsd.db
printf '\nremote-control:\n\tcontrol-enable: yes\n' >> /var/nsd/etc/nsd.conf
</b></pre></blockquote>

Further, for the updated version of
<a href="https://man.openbsd.org/nsd.8">nsd(8)</a>
<ul>
<li>If you use "include" lines in nsd.conf, move the files into the chroot
path (/var/nsd) and change the include lines to specify the full path
(include: "/var/nsd/etc/nsd.local").
NSD strips the chroot prefix as needed.</li>

<li>Remove any old cron jobs that run "nsdc patch" as this is no longer needed.
If you wish to write slaved zones to the readable data files, you may want
to change this for a 'nsd-control write' job.</li>

<li>Check nsd_flags in /etc/rc.conf.local; NSD is now started by
<a href="https://man.openbsd.org/nsd-control">nsd-control(8)</a>,
and flags must be from the smaller set valid for this program, rather than
<a href="https://man.openbsd.org/nsd">nsd(8)</a>
as was previously the case.
</li>

<li>It is no longer necessary to compile zone files manually with zonec.
This is now handled automatically by the main program.
Please note that zone files must be readable by either the _nsd user
or group.</li>
</ul>

<h3 id="Kernchk">3. Checking the kernel</h3>
Note: <b>most people can skip this step!</b>
<p>
If you followed the instructions for the upgrade process without install
kernel, you have already completed this step.
However, if you used the install kernel, and if you had a modified kernel
in 5.4, it is likely you will need to modify the stock kernel of 5.5.
This can be as simple as modifying a specific device using config(8),
or it can involve a recompilation if the option you need is not included
in the GENERIC kernel.
Please consult <a href="faq5.html">FAQ 5 - Building the system from source</a>
before considering to recompile your kernel.

<p>
<h3 id="Pkgup">4. Upgrading packages</h3>
If you installed any packages on your system, you should upgrade them
after completing the upgrade of the base system.
Be aware, however, many packages will require further setup before
and/or after upgrading the package.
Check with the application's upgrade guide for details.

<p>
The following packages are known to have significant upgrade issues that
will impact users.
The fact that a package is not on this list doesn't mean it will have a
trivial upgrade.
You must do some homework on the applications YOU use.

<ul>
<li><b>rrdtool:</b>
the binary RRD database file
format on 32-bit architectures will not be compatible.
Export any RRD files to XML format before updating:
<blockquote><pre>
# Single file:
rrdtool dump filename.rrd filename.xml

# To convert a batch:
for i in *.rrd; do rrdtool dump $i ${i%.rrd}.xml; done
</pre></blockquote>
After updating, restore them as follows:
<blockquote><pre>
# Single file:
rrdtool restore filename.xml filename.rrd

# To convert a batch:
for i in *.xml; do rrdtool restore $i ${i%.xml}.rrd; done
</pre></blockquote>
This is not necessary on 64-bit architectures (amd64, sparc64, etc).

<p>
RRDtool has changed to using Cairo/Pango for graph and text generation.
If using it in a chroot jail (for cgi/php scripts, etc), you will need to
take additional steps to install the relevant files.
A script is provided to copy the relevant libraries and support files;
see <a href="https://cvsweb.openbsd.org/cgi-bin/cvsweb/~checkout~/ports/net/rrdtool/pkg/README-main">/usr/local/share/doc/pkg-readmes/rrdtool-1.4.8</a>
for more details.

<p>
<li><b>postgresql:</b>
Postgresql has had a major version upgrade
which requires the usual dump+restore cycle as described in the upgrade
notes (see /usr/local/share/doc/pkg-readmes/postgresql*).
<b>The old database must be dumped *before* upgrading OpenBSD.</b>
Also note that because all old packages are removed, the normal warning
from pkg_add at update time is not triggered.

<p><li><b>php:</b>
The primary PHP version used in ports has switched to 5.4.
This change means that if you run PHP applications packaged in ports,
you will need to switch your webserver config to use the newer version
of PHP.
Check /etc/php-5.3.ini for changes from the default configuration:
<blockquote><pre>
diff /usr/local/share/examples/php-5.3/php.ini-production /etc/php-5.4.ini
</pre></blockquote>
and carry them across to /etc/php-5.4.ini.
You will also need to check for links to any active PHP extension modules
in /etc/php-5.3 and re-create them in /etc/php-5.4, e.g.
<blockquote><pre>   cd /etc/php-5.4
ls -l ../php-5.4.sample
ln -s ../php-5.4.sample/pdo_mysql.ini .
# (etc)
</pre></blockquote>
If you are currently using PHP with Apache in base, you will also need to
adjust your Apache configuration:
<blockquote><pre>
cd /var/www/conf/modules
ln -fs /var/www/conf/modules.sample/php-5.4.conf /var/www/conf/modules/php.conf
</pre></blockquote>

<p>
<li><b>dspam:</b>
If you were using one of the mysql or pgsql FLAVORS of the <b>dspam</b> package
you will have to manually install the corresponding driver subpackage after the
upgrade to the 3.10.2 version.
If you were using dspam with the PostgreSQL driver:
<pre>
   pkg_add dspam-pgsql
</pre>
If you were using dspam with the MySQL driver:
<pre>
   pkg_add dspam-mysql
</pre>

<p>
<li><b>wordpress 3.6.1:</b>
The twentyeleven theme from wordpress 3.5.x is no longer included with
wordpress 3.6.x. If you are using this theme, back it up before updating:
<pre>
   cd /var/www/wordpress/wp-content/themes &&
   cp -Rp twentyeleven twentyeleven.bak
</pre>
and restore it after wordpress update:
<pre>
   cd /var/www/wordpress/wp-content/themes &&
   mv twentyeleven.bak twentyeleven
</pre>

<p>
<li><b>Apache Subversion 1.8.3:</b>
Apache Subversion has been upgraded to version 1.8.3.
This release of Subversion updates the working copy format (client-side).
Existing working copies need to be upgraded using <tt>svn upgrade</tt>
because Subversion 1.8 cannot operate with older working copy formats.
See the <a href="https://subversion.apache.org/docs/release-notes/1.8.html#wc-upgrade"
>section about working copy upgrades</a> in Subversion's release notes for details.
The server is fully backwards compatible and will serve existing repositories just fine.
However, to take advantage of new FSFS repository features a repository upgrade is necessary.
See the <a href="https://subversion.apache.org/docs/release-notes/1.8.html#fsfs-enhancements"
>section about FSFS enhancements</a> for details.

<p>
<li><b>lout-doc:</b>
lout-doc was merged into the lout package, so need not be manually re-added.

<p>
<li><b>ngircd:</b>
ngircd's configuration directory has changed.
If updating from a previous version, you will need to move your old
configuration file into place:
<pre>
   mv /etc/ngircd.conf /etc/ngircd/ngircd.conf
</pre>
Additional steps may be needed if you have configured it to use a motd file,
ssl or chroot.

<p>
<li><b>icinga 1.10:</b>
Note that the deprecated (and ignored) "log_external_commands_user" option
has been removed from Icinga.
If this is present in your configuration, Icinga will fail to start until
you remove it.
This is in addition to the database schema upgrades that are needed as
usual for Icinga-web/NDOUtils users (see the pkg-readme for more
information).

<p>
<li><b>openldap and other packages with persistent Berkeley DB databases:</b>
There are three levels of file formating/encoding involved in
Berkeley DB (BDB) databases:
<ol>
<li>the Berkeley DB shared memory files <tt>__db.*</tt></li>
<li>the Berkeley DB database file formats (<tt>*.db</tt> and <tt>log.*</tt>)</li>
<li>the data stored in the database keys and values</li>
</ol>
The first are dependent on the sizes of layout of the systems types.
They are rebuilt whenever database recovery is performed on BDB
databases, which is automatic on each restart for many packages.
If problems arise, they can be deleted whenever the database is not
open by a running process.
<p>
The BDB database file formats are independent of the sizes of the
system types and therefore don't need any special treatment during
the upgrade.
(While endian-aware, the files are more efficiently accessed when
do so with the same endianness as when originally created.)
<p>
The last level, the data stored in the database keys and values,
is strictly dependent on the application.
OpenLDAP appears to be independent of the sizes of the system
<tt>time_t</tt> type, but other applications may require application-level
dump and restore when transitioning from 5.4 to 5.5.

</ul>

<p>
<!-- The package tools support in-place updating using <tt>pkg_add -u</tt>.
For instance, to update all your packages, make sure <tt>PKG_PATH</tt> is
pointing to the 5.5 packages directory on your CD or nearest FTP mirror,
and use something like

<blockquote><pre>
<b>pkg_add -u</b>
</pre></blockquote>

where the <tt>-u</tt> indicates update mode;
pkg_add will prompt you for input when it encounters
some ambiguity.
-->
Usually at this point, you would update the packages, but since they
were all unloaded BEFORE the upgrade, you have to reinstall based on
your lists of saved packages before:

<blockquote><pre>
pkg_add -z -l /root/pkg_list_manual
pkg_add -za -l /root/pkg_list_full
</pre></blockquote>

Read the
<a href="https://man.openbsd.org/OpenBSD-5.4/pkg_add">pkg_add(1)</a>
manual page and the <a href="faq15.html#PkgMgmt">package management</a>
chapter of the FAQ for more information.

<p>
<a href="index.html">[FAQ Index]</a> |
<a href="upgrade54.html">[5.3 -> 5.4]</a> |
<a href="upgrade56.html">[5.5 -> 5.6]</a>

<p>
<hr>
<a href="index.html"><img height="24" width="24" src="../images/back.gif" border="0" alt="[back]"></a>
<br>
<small>$OpenBSD: upgrade55.html,v 1.43 2017/03/25 19:07:05 tb Exp $</small>

</body>
</html>
@


1.43
log
@a few more links can switch to https.
@
text
@d120 1
a120 1
<a href="http://man.openbsd.org/ldapd.8">ldapd(8)</a>,
d144 1
a144 1
<a href="http://man.openbsd.org/signify.1">signify(1)</a>
d166 1
a166 1
<li id="identd"><b><a href="http://man.openbsd.org/identd.8">identd(8)</a>
d169 1
a169 1
<a href="http://man.openbsd.org/inetd.8">inetd(8)</a>.
d181 1
a181 1
<a href="http://man.openbsd.org/pf.conf.5">pf.conf(5)</a>.
d185 1
a185 1
<a href="http://man.openbsd.org/smtpd.8">smtpd(8)</a>
d213 1
a213 1
See <a href="http://man.openbsd.org/smtpd.conf.5">smtpd.conf(5)</a>
d251 1
a251 1
<a href="http://man.openbsd.org/nsd.8">nsd(8)</a>
d253 1
a253 1
<a href="http://man.openbsd.org/unbound.8">unbound(8)</a>
d273 1
a273 1
<a href="http://man.openbsd.org/config.8">config(8)</a>,
d374 1
a374 1
<a href="http://man.openbsd.org/sudo.8">sudo(8)</a>
d379 1
a379 1
<a href="http://man.openbsd.org/ksh.1">ksh(1)</a>
d462 1
a462 1
<a href="http://man.openbsd.org/tar.1">tar(1)</a>
d491 1
a491 1
<a href="http://man.openbsd.org/OpenBSD-5.5/i386/MAKEDEV">MAKEDEV</a>
d501 1
a501 1
<a href="http://man.openbsd.org/installboot.8">installboot(8)</a>
d522 1
a522 1
<a href="http://man.openbsd.org/sysmerge.8">sysmerge(8)</a>
d538 1
a538 1
<a href="http://man.openbsd.org/sdiff.1">sdiff</a>.
d542 1
a542 1
<a href="http://man.openbsd.org/sysmerge.8">sysmerge(8)</a>
d545 2
a546 2
<a href="http://man.openbsd.org/diff.1">diff(1)</a>,
<a href="http://man.openbsd.org/sdiff.1">sdiff(1)</a>
d548 1
a548 1
<a href="http://man.openbsd.org/more.1">more(1)</a>
d566 1
a566 1
<a href="http://man.openbsd.org/diff.1">diff(1)</a>,
d568 1
a568 1
<a href="http://man.openbsd.org/more.1">more(1)</a>)
d584 1
a584 1
<a href="http://man.openbsd.org/sdiff.1">sdiff(1)</a>,
d593 1
a593 1
<a href="http://man.openbsd.org/daily.8">daily(8)</a>
d642 1
a642 1
<a href="http://man.openbsd.org/nsd.8">nsd(8)</a>
d654 1
a654 1
<a href="http://man.openbsd.org/nsd-control">nsd-control(8)</a>,
d656 1
a656 1
<a href="http://man.openbsd.org/nsd">nsd(8)</a>
d876 1
a876 1
<a href="http://man.openbsd.org/OpenBSD-5.4/pkg_add">pkg_add(1)</a>
d889 1
a889 1
<small>$OpenBSD: upgrade55.html,v 1.42 2017/03/25 18:03:37 tb Exp $</small>
@


1.42
log
@switch cvsweb and a couple of other links to https. thanks nick and tj!
@
text
@d158 1
a158 1
<a href="http://www.synflood.at/akpop3d.html">akpop3d</a>,
d791 1
a791 1
See the <a href="http://subversion.apache.org/docs/release-notes/1.8.html#wc-upgrade"
d795 1
a795 1
See the <a href="http://subversion.apache.org/docs/release-notes/1.8.html#fsfs-enhancements"
d889 1
a889 1
<small>$OpenBSD: upgrade55.html,v 1.41 2016/10/16 19:11:30 tb Exp $</small>
@


1.41
log
@Switch a few links to ftp.openbsd.org, www.libressl.org and www.openssh.org
to https now that the certificates are fully supported. Only fully
qualified links are modified and none that are generated from build/. While
there, fix a few broken links that were found during the conversion.

requested by tj, "yes, but carefully" beck
@
text
@d721 1
a721 1
see <a href="http://cvsweb.openbsd.org/cgi-bin/cvsweb/~checkout~/ports/net/rrdtool/pkg/README-main">/usr/local/share/doc/pkg-readmes/rrdtool-1.4.8</a>
d889 1
a889 1
<small>$OpenBSD: upgrade55.html,v 1.40 2016/08/15 02:22:14 tb Exp $</small>
@


1.40
log
@tls on openbsd.org is now real:
- link to https://www.openbsd.org from the sub-projects' pages
- make internal links relative
- switch link rel=canonical to https to please some search engines
"go ahead" from beck, "do it!!!!" tj
@
text
@d248 1
a248 1
<a href="http://www.opensmtpd.org">OpenSMTPD</a>, but sendmail will be
d889 1
a889 1
<small>$OpenBSD: upgrade55.html,v 1.39 2016/06/16 22:50:01 tj Exp $</small>
@


1.39
log
@first pass at cleaning up the new faq1 page:
- rename and reorder sections to make the document flow better as a whole
- merge a few very similar topics to reduce redundant information
- move signify instructions to faq4 (and zap a reference to isa cards)

ok tb
@
text
@d10 1
a10 1
<link rel="canonical"      href="http://www.openbsd.org/faq/upgrade55.html">
d889 1
a889 1
<small>$OpenBSD: upgrade55.html,v 1.38 2016/06/16 14:36:00 tj Exp $</small>
@


1.38
log
@merge faq2 and faq3 (getting to know openbsd and getting started with openbsd)
into faq1 (introduction to openbsd)

put a redirect to the faq index in place of the old files, and do the same
for faq12 (which was removed a while ago)

ok tb
@
text
@d151 1
a151 1
Instead, you should <a href="faq1.html#Verify">verify your install media
d889 1
a889 1
<small>$OpenBSD: upgrade55.html,v 1.37 2016/04/15 20:39:49 tb Exp $</small>
@


1.37
log
@use short form man links in the faq and fix a few broken links
@
text
@d151 1
a151 1
Instead, you should <a href="faq3.html#Verify">verify your install media
d889 1
a889 1
<small>$OpenBSD: upgrade55.html,v 1.36 2016/04/09 22:55:45 tb Exp $</small>
@


1.36
log
@more css surgery, metadata and other cleanup, validation fixes.
@
text
@d120 1
a120 1
<a href="http://man.openbsd.org/?query=ldapd&amp;sektion=8">ldapd(8)</a>,
d144 1
a144 1
<a href="http://man.openbsd.org/?query=signify&amp;sektion=1">signify(1)</a>
d166 1
a166 1
<li id="identd"><b><a href="http://man.openbsd.org/?query=identd&amp;sektion=8">identd(8)</a>
d169 1
a169 1
<a href="http://man.openbsd.org/?query=inetd&amp;sektion=8">inetd(8)</a>.
d181 1
a181 1
<a href="http://man.openbsd.org/?query=pf.conf&amp;sektion=5">pf.conf(5)</a>.
d185 1
a185 1
<a href="http://man.openbsd.org/?query=smtpd&amp;sektion=8">smtpd(8)</a>
d213 1
a213 1
See <a href="http://man.openbsd.org/?query=smtpd.conf&amp;sektion=5">smtpd.conf(5)</a>
d251 1
a251 1
<a href="http://man.openbsd.org/?query=nsd&amp;sektion=8">nsd(8)</a>
d253 1
a253 1
<a href="http://man.openbsd.org/?query=unbound&amp;sektion=8">unbound(8)</a>
d273 1
a273 1
<a href="http://man.openbsd.org/?query=config&amp;sektion=8">config(8)</a>,
d374 1
a374 1
<a href="http://man.openbsd.org/?query=sudo&amp;sektion=8">sudo(8)</a>
d379 1
a379 1
<a href="http://man.openbsd.org/?query=ksh&amp;sektion=1">ksh(1)</a>
d462 1
a462 1
<a href="http://man.openbsd.org/?query=tar&amp;sektion=1">tar(1)</a>
d491 1
a491 1
<a href="http://man.openbsd.org/?query=MAKEDEV&amp;sektion=8&amp;arch=i386">MAKEDEV</a>
d501 1
a501 1
<a href="http://man.openbsd.org/?query=installboot&amp;sektion=8">installboot(8)</a>
d522 1
a522 1
<a href="http://man.openbsd.org/?query=sysmerge&amp;sektion=8">sysmerge(8)</a>
d538 1
a538 1
<a href="http://man.openbsd.org/?query=sdiff&amp;sektion=1">sdiff</a>.
d542 1
a542 1
<a href="http://man.openbsd.org/?query=sysmerge&amp;sektion=8">sysmerge(8)</a>
d545 2
a546 2
<a href="http://man.openbsd.org/?query=diff&amp;sektion=1">diff(1)</a>,
<a href="http://man.openbsd.org/?query=sdiff&amp;sektion=1">sdiff(1)</a>
d548 1
a548 1
<a href="http://man.openbsd.org/?query=more&amp;sektion=1">more(1)</a>
d566 1
a566 1
<a href="http://man.openbsd.org/?query=diff&amp;sektion=1">diff(1)</a>,
d568 1
a568 1
<a href="http://man.openbsd.org/?query=more&amp;sektion=1">more(1)</a>)
d584 1
a584 1
<a href="http://man.openbsd.org/?query=sdiff&amp;sektion=1">sdiff(1)</a>,
d593 1
a593 1
<a href="http://man.openbsd.org/?query=daily&amp;sektion=8">daily(8)</a>
d642 1
a642 1
<a href="http://man.openbsd.org/?query=nsd&amp;sektion=8">nsd(8)</a>
d654 1
a654 1
<a href="http://man.openbsd.org/?query=nsd-control">nsd-control(8)</a>,
d656 1
a656 1
<a href="http://man.openbsd.org/?query=nsd">nsd(8)</a>
d876 1
a876 1
<a href="http://man.openbsd.org/?query=pkg_add&amp;sektion=1&amp;manpath=OpenBSD+5.4">pkg_add(1)</a>
d889 1
a889 1
<small>$OpenBSD: upgrade55.html,v 1.35 2016/03/27 19:52:09 sthen Exp $</small>
@


1.35
log
@add a small sprinkling of css to improve readability in the faq, ok tj@@ tb@@
@
text
@d8 3
a10 3
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="../openbsd.css">
<link rel="canonical" href="http://www.openbsd.org/faq/upgrade55.html">
d14 2
d17 4
a20 2
<img alt="[OpenBSD]" height=30 width=141 src="../images/smalltitle.gif" border="0">
</a>
d22 1
a22 16
<font color="#0000e0">
<a href="upgrade41.html">[4.0 -> 4.1]</a> |
<a href="upgrade42.html">[4.1 -> 4.2]</a> |
<a href="upgrade43.html">[4.2 -> 4.3]</a> |
<a href="upgrade44.html">[4.3 -> 4.4]</a> |
<a href="upgrade45.html">[4.4 -> 4.5]</a> |
<a href="upgrade46.html">[4.5 -> 4.6]</a> 
<br>
<a href="upgrade47.html">[4.6 -> 4.7]</a> |
<a href="upgrade48.html">[4.7 -> 4.8]</a> |
<a href="upgrade49.html">[4.8 -> 4.9]</a> |
<a href="upgrade50.html">[4.9 -> 5.0]</a> |
<a href="upgrade51.html">[5.0 -> 5.1]</a> |
<a href="upgrade52.html">[5.1 -> 5.2]</a>
<br>
<a href="upgrade53.html">[5.2 -> 5.3]</a> |
d24 3
a26 8
<a href="upgrade56.html">[5.5 -> 5.6]</a> |
<a href="index.html">[FAQ Index]</a>
</font>

<h1><font color="#e00000">
Upgrade Guide: 5.4 to 5.5
</font></h1>
<hr>
d59 1
a59 1
  <li><a href="#popa3d">popa3d removed<e/a>
d80 1
a80 2
<a name="before"></a>
<h2>Before upgrading: things to think about and be aware of</h2>
d88 1
a88 2
<a name="time_t"></a>
<li><b>Year 2038 ready</b><br>
d142 1
a142 2
<a name="signed"></a>
<li><b>Releases signed</b><br>
d155 1
a155 2
<a name="popa3d"></a>
<li><b>popa3d removed</b><br>
d166 1
a166 2
<a name="identd"></a>
<li><b><a href="http://man.openbsd.org/?query=identd&amp;sektion=8">identd(8)</a>
d174 1
a174 2
<a name="pfqueue"></a>
<li><b>pf queue changes</b>
d180 1
a180 1
documentation in 
d184 2
a185 3
<a name="smtpd.conf"></a>
<li><b>smtpd.conf changes</b><br>
<a href="http://man.openbsd.org/?query=smtpd&sektion=8">smtpd(8)</a>
d213 1
a213 1
See <a href="http://man.openbsd.org/?query=smtpd.conf&sektion=5">smtpd.conf(5)</a>
d217 1
a217 2
<a name="noi386java"></a>
<li><b>No Java on i386</b><br>
d224 1
a224 2
<a name="multibooters"></a>
<li><b>Multiboot users: may have to reconfigure for a relocated
d229 1
a229 1
Historically, upgrades did not relocate <tt>/boot</tt>, so your old PBR 
d237 1
a237 2
<a name="headsup"></a>
<li><b>Advanced notice: Big changes coming for future releases!</b><br>
d265 1
a265 2
<a name="chkkern"></a>
<li><b>Check the kernel:</b>
d272 1
a272 1
This can be as simple as modifying a specific device using 
a280 2
</ul>

d283 1
a283 2
<a name="upgrade"></a>
<h2>The upgrade process</h2>
d304 1
a304 1
<li>Stop all packages. 
d512 1
a512 2
<a name="final"></a>
<h2>Final steps</h2>
d519 1
a519 2
<a name="sysmerge"></a>
<h3>1. Merging changed files via sysmerge(8)</h3>
d611 1
a611 2
<a name="RmFiles"></a>
<h3>2. Files to delete and move</h3>
d666 1
a666 2
<a name="Kernchk"></a>
<h3>3. Checking the kernel</h3>
d680 1
a680 2
<a name="Pkgup"></a>
<h3>4. Upgrading packages</h3>
a694 3
<p>

<p>
d828 2
a829 2
<li>the Berkeley DB shared memory files <t>__db.*</t></li>
<li>the Berkeley DB database file formats (<t>*.db</t> and <t>log.*</t>)</li>
d847 1
a847 1
<t>time_t</t> type, but other applications may require application-level
a879 2

<p><br>
d881 1
a881 16
<font color="#0000e0">
<a href="upgrade41.html">[4.0 -> 4.1]</a> |
<a href="upgrade42.html">[4.1 -> 4.2]</a> |
<a href="upgrade43.html">[4.2 -> 4.3]</a> |
<a href="upgrade44.html">[4.3 -> 4.4]</a> |
<a href="upgrade45.html">[4.4 -> 4.5]</a> |
<a href="upgrade46.html">[4.5 -> 4.6]</a>
<br>
<a href="upgrade47.html">[4.6 -> 4.7]</a> |
<a href="upgrade48.html">[4.7 -> 4.8]</a> |
<a href="upgrade49.html">[4.8 -> 4.9]</a> |
<a href="upgrade50.html">[4.9 -> 5.0]</a> |
<a href="upgrade51.html">[5.0 -> 5.1]</a> |
<a href="upgrade52.html">[5.1 -> 5.2]</a>
<br>
<a href="upgrade53.html">[5.2 -> 5.3]</a> |
d883 1
a883 3
<a href="upgrade56.html">[5.5 -> 5.6]</a> |
<a href="index.html">[FAQ Index]</a>
</font>
d889 1
a889 1
<small>$OpenBSD: upgrade55.html,v 1.34 2016/03/22 10:54:48 sthen Exp $</small>
@


1.34
log
@fix URIs, the / before querystring isn't optional, if it isn't fixed up
by the browser the server returns 400 Bad Request
@
text
@d8 2
d946 1
a946 1
<small>$OpenBSD: upgrade55.html,v 1.33 2016/03/21 05:46:21 beck Exp $</small>
@


1.33
log
@change http://www.openbsd.org/cgi-bin/man.cgi to be http://man.openbsd.org
this points stuff to the new place and gets us ready to deprecate the old
place we did this.
@
text
@d136 1
a136 1
<a href="http://man.openbsd.org?query=ldapd&amp;sektion=8">ldapd(8)</a>,
d161 1
a161 1
<a href="http://man.openbsd.org?query=signify&amp;sektion=1">signify(1)</a>
d185 1
a185 1
<li><b><a href="http://man.openbsd.org?query=identd&amp;sektion=8">identd(8)</a>
d188 1
a188 1
<a href="http://man.openbsd.org?query=inetd&amp;sektion=8">inetd(8)</a>.
d201 1
a201 1
<a href="http://man.openbsd.org?query=pf.conf&amp;sektion=5">pf.conf(5)</a>.
d206 1
a206 1
<a href="http://man.openbsd.org?query=smtpd&sektion=8">smtpd(8)</a>
d234 1
a234 1
See <a href="http://man.openbsd.org?query=smtpd.conf&sektion=5">smtpd.conf(5)</a>
d275 1
a275 1
<a href="http://man.openbsd.org?query=nsd&amp;sektion=8">nsd(8)</a>
d277 1
a277 1
<a href="http://man.openbsd.org?query=unbound&amp;sektion=8">unbound(8)</a>
d298 1
a298 1
<a href="http://man.openbsd.org?query=config&amp;sektion=8">config(8)</a>,
d402 1
a402 1
<a href="http://man.openbsd.org?query=sudo&amp;sektion=8">sudo(8)</a>
d407 1
a407 1
<a href="http://man.openbsd.org?query=ksh&amp;sektion=1">ksh(1)</a>
d490 1
a490 1
<a href="http://man.openbsd.org?query=tar&amp;sektion=1">tar(1)</a>
d519 1
a519 1
<a href="http://man.openbsd.org?query=MAKEDEV&amp;sektion=8&amp;arch=i386">MAKEDEV</a>
d529 1
a529 1
<a href="http://man.openbsd.org?query=installboot&amp;sektion=8">installboot(8)</a>
d552 1
a552 1
<a href="http://man.openbsd.org?query=sysmerge&amp;sektion=8">sysmerge(8)</a>
d568 1
a568 1
<a href="http://man.openbsd.org?query=sdiff&amp;sektion=1">sdiff</a>.
d572 1
a572 1
<a href="http://man.openbsd.org?query=sysmerge&amp;sektion=8">sysmerge(8)</a>
d575 2
a576 2
<a href="http://man.openbsd.org?query=diff&amp;sektion=1">diff(1)</a>,
<a href="http://man.openbsd.org?query=sdiff&amp;sektion=1">sdiff(1)</a>
d578 1
a578 1
<a href="http://man.openbsd.org?query=more&amp;sektion=1">more(1)</a>
d596 1
a596 1
<a href="http://man.openbsd.org?query=diff&amp;sektion=1">diff(1)</a>,
d598 1
a598 1
<a href="http://man.openbsd.org?query=more&amp;sektion=1">more(1)</a>)
d614 1
a614 1
<a href="http://man.openbsd.org?query=sdiff&amp;sektion=1">sdiff(1)</a>,
d623 1
a623 1
<a href="http://man.openbsd.org?query=daily&amp;sektion=8">daily(8)</a>
d673 1
a673 1
<a href="http://man.openbsd.org?query=nsd&amp;sektion=8">nsd(8)</a>
d685 1
a685 1
<a href="http://man.openbsd.org?query=nsd-control">nsd-control(8)</a>,
d687 1
a687 1
<a href="http://man.openbsd.org?query=nsd">nsd(8)</a>
d912 1
a912 1
<a href="http://man.openbsd.org?query=pkg_add&amp;sektion=1&amp;manpath=OpenBSD+5.4">pkg_add(1)</a>
d944 1
a944 1
<small>$OpenBSD: upgrade55.html,v 1.32 2015/07/08 01:11:32 nick Exp $</small>
@


1.32
log
@
better pages <title>, better matching the page.  From Pavel Plamenov
(pvlplmnv at gmail), thanks!
@
text
@d136 1
a136 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ldapd&amp;sektion=8">ldapd(8)</a>,
d161 1
a161 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=signify&amp;sektion=1">signify(1)</a>
d185 1
a185 1
<li><b><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=identd&amp;sektion=8">identd(8)</a>
d188 1
a188 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=inetd&amp;sektion=8">inetd(8)</a>.
d201 1
a201 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5">pf.conf(5)</a>.
d206 1
a206 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=smtpd&sektion=8">smtpd(8)</a>
d234 1
a234 1
See <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=smtpd.conf&sektion=5">smtpd.conf(5)</a>
d275 1
a275 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=nsd&amp;sektion=8">nsd(8)</a>
d277 1
a277 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=unbound&amp;sektion=8">unbound(8)</a>
d298 1
a298 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8">config(8)</a>,
d402 1
a402 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sudo&amp;sektion=8">sudo(8)</a>
d407 1
a407 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ksh&amp;sektion=1">ksh(1)</a>
d490 1
a490 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tar&amp;sektion=1">tar(1)</a>
d519 1
a519 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=MAKEDEV&amp;sektion=8&amp;arch=i386">MAKEDEV</a>
d529 1
a529 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=installboot&amp;sektion=8">installboot(8)</a>
d552 1
a552 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysmerge&amp;sektion=8">sysmerge(8)</a>
d568 1
a568 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sdiff&amp;sektion=1">sdiff</a>.
d572 1
a572 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysmerge&amp;sektion=8">sysmerge(8)</a>
d575 2
a576 2
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=diff&amp;sektion=1">diff(1)</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sdiff&amp;sektion=1">sdiff(1)</a>
d578 1
a578 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=more&amp;sektion=1">more(1)</a>
d596 1
a596 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=diff&amp;sektion=1">diff(1)</a>,
d598 1
a598 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=more&amp;sektion=1">more(1)</a>)
d614 1
a614 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sdiff&amp;sektion=1">sdiff(1)</a>,
d623 1
a623 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=daily&amp;sektion=8">daily(8)</a>
d673 1
a673 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=nsd&amp;sektion=8">nsd(8)</a>
d685 1
a685 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=nsd-control">nsd-control(8)</a>,
d687 1
a687 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=nsd">nsd(8)</a>
d912 1
a912 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pkg_add&amp;sektion=1&amp;manpath=OpenBSD+5.4">pkg_add(1)</a>
d944 1
a944 1
<small>$OpenBSD: upgrade55.html,v 1.31 2015/07/02 05:49:04 bentley Exp $</small>
@


1.31
log
@Clean up meta tags.

name=distribution, name=keywords, and name=resource-type have no effect
in modern search engines and just clutter up the page source.

From Pavel Plamenov.
@
text
@d4 1
a4 1
<title>OpenBSD Upgrade Guide 5.5</title>
d944 1
a944 1
<small>$OpenBSD: upgrade55.html,v 1.30 2015/05/11 11:18:30 sthen Exp $</small>
@


1.30
log
@Add 'link rel="canonical"' to pages, acting as a hint to search engines
to list the copies on www.openbsd.org rather than mirrors.

From Carlin Bingham, ok millert@@ nick@@
@
text
@a5 1
<meta name="resource-type" content="document">
a6 2
<meta name="keywords"      content="openbsd,faq,upgrade,5.5">
<meta name="distribution"  content="global">
d944 1
a944 1
<small>$OpenBSD: upgrade55.html,v 1.29 2014/11/10 09:29:52 sthen Exp $</small>
@


1.29
log
@remove some more of the www@@ mentions, Job Snijders pointed out the
one on upgrade56.html
@
text
@d11 1
d947 1
a947 1
<small>$OpenBSD: upgrade55.html,v 1.28 2014/11/10 09:23:34 sthen Exp $</small>
@


1.28
log
@add a note to "no java on i386" to mention that it's back in 5.6.
leave the suggestion about moving to amd64 there (there are still some
issues with the compiler on i386).
@
text
@a4 1
<link rev="made" href="mailto:www@@openbsd.org">
a944 1
<a href="mailto:www@@openbsd.org">www@@openbsd.org</a>
d946 1
a946 1
<small>$OpenBSD: upgrade55.html,v 1.27 2014/11/01 18:10:02 nick Exp $</small>
@


1.27
log
@
add forward links
@
text
@d246 1
a246 1
CPUs), or stay with an older version of OpenBSD.
d948 1
a948 1
<small>$OpenBSD: upgrade55.html,v 1.26 2014/10/22 17:26:39 nick Exp $</small>
@


1.26
log
@
duplicated duplicated word word which has been here for a while.
diff from Carlin Bingham (cb at viennan dot net), thanks!
@
text
@d36 1
d939 1
d948 1
a948 1
<small>$OpenBSD: upgrade55.html,v 1.25 2014/08/31 21:23:34 nick Exp $</small>
@


1.25
log
@
The problem with predicting the future is it is subject to change.
Inspired by Daniel Jakots, though I went in a slightly different direction.
@
text
@a361 1
version
d946 1
a946 1
<small>$OpenBSD: upgrade55.html,v 1.24 2014/08/07 01:51:34 nick Exp $</small>
@


1.24
log
@
more -> cvsweb.openbsd.org for, well, cvsweb.
@
text
@d81 1
a81 1
  <li><a href="#headsup">Advanced notice: Big changes for 5.6</a>
d263 2
a264 2
<li><b>Advanced notice: Big changes coming for 5.6!</b><br>
There are some big changes coming up in OpenBSD 5.6 (NOT 5.5!)
d267 1
a267 1
<li>Platforms removed: hp300, mvme88k, mvme68k.
d269 4
a272 4
<li>OpenBSD's version of Apache 1.3 will be removed from base in favor of
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=nginx&amp;sektion=8">nginx(8)</a>.
Apache 1.3 will become a <a href="faq15.html">package</a> for those
with applications dependent upon it.
d276 1
a276 1
<li>BIND (named) will be removed from base in favor of
d281 3
a283 1
<li>FTP will no longer be an install option. Instead, HTTP will be used.
d286 2
a287 2
<li>Kerberos will be removed from base OpenBSD, though should be available
as a package.
d947 1
a947 1
<small>$OpenBSD: upgrade55.html,v 1.23 2014/08/03 02:31:31 nick Exp $</small>
@


1.23
log
@
ldap is fun^Wanother problem for upgraders.  From Matthew Weigel, thanks!
@
text
@d758 1
a758 1
see <a href="http://www.openbsd.org/cgi-bin/cvsweb/~checkout~/ports/net/rrdtool/pkg/README-main">/usr/local/share/doc/pkg-readmes/rrdtool-1.4.8</a>
d945 1
a945 1
<small>$OpenBSD: upgrade55.html,v 1.22 2014/05/21 23:21:40 brad Exp $</small>
@


1.22
log
@Add iopctl to the delete list.
@
text
@d137 7
d945 1
a945 1
<small>$OpenBSD: upgrade55.html,v 1.21 2014/05/14 02:40:11 nick Exp $</small>
@


1.21
log
@
stop packages before removing them; removing them will delete the shutdown
script, which will result in a hard kill at reboot.
@
text
@d649 2
a650 2
rm -f /usr/sbin/popa3d
rm -f /usr/share/man/man8/popa3d.8
d938 1
a938 1
<small>$OpenBSD: upgrade55.html,v 1.20 2014/05/14 01:50:16 guenther Exp $</small>
@


1.20
log
@Add a chunk of verbiage about BDB upgrade issues

prodded by nick@@
@
text
@d325 7
d938 1
a938 1
<small>$OpenBSD: upgrade55.html,v 1.19 2014/05/10 18:43:31 guenther Exp $</small>
@


1.19
log
@A couple typo fixes from Guido Tschakert (guido.tschakert (at) gmx.de)
@
text
@d846 27
d931 1
a931 1
<small>$OpenBSD: upgrade55.html,v 1.18 2014/05/07 02:47:18 sthen Exp $</small>
@


1.18
log
@explicitly mention that _nsd uid/gid requires read access to zone files;
found the hard way by Laurie Tratt - previously zonec would be run manually
and quite often by a uid with higher privileges than the nsd daemon so some
users will need to adjust permissions.

attempt to clarify that nsd_flags takes nsd-control(8) options rather
than nsd(8) options now; also mentioned by Laurie.
@
text
@d185 1
a185 1
and remove them from <tt>/etc/identd.conf</tt>.
d904 1
a904 1
<small>$OpenBSD: upgrade55.html,v 1.17 2014/05/06 23:19:20 nick Exp $</small>
@


1.17
log
@
Network lag tester is time_t dependent.  I speak, of course, of
tetris(6)'s score file.  Not sure how I missed this, but alex at flupzor
dot nl apparently has more time on his hand^W^W^W^Wnetworks to test
latency on than I have had lately.  Thanks!
@
text
@d672 5
a676 1
nsd-control(8), so nsd(8) flags are no longer available.</li>
d679 3
a681 1
This is now handled automatically by the main program.</li>
d904 1
a904 1
<small>$OpenBSD: upgrade55.html,v 1.16 2014/05/05 04:06:58 nick Exp $</small>
@


1.16
log
@
/var/account/acct is time_t dependent, so accounting is hosed when upgrading.

My proposed fix: rm /var/account/acct with the other rm'd files.  It
will be recreated (in the new format) with the next boot, which will
occur after you reinstall your packages, when your system is ready for
use.  For non-accounting users, this is a non-event and a no-change (the
file won't exist).  It appears the summary files, /var/account/usracct
and /var/account/savacct are not an issue.

If active users (and coders!) of accounting could verify this or maybe
come up with a better process, I'd appreciate it -- I'm not a user of
this feature.
@
text
@d649 1
d898 1
a898 1
<small>$OpenBSD: upgrade55.html,v 1.15 2014/05/05 03:52:18 nick Exp $</small>
@


1.15
log
@
clean up some ugly trailing spaces that snuck in.
@
text
@d130 7
d648 1
d897 1
a897 1
<small>$OpenBSD: upgrade55.html,v 1.14 2014/05/04 03:55:15 jsg Exp $</small>
@


1.14
log
@remove old nawk and crunchgen binaries if present
these will break future source builds if still around

ok nick@@
@
text
@d303 5
a307 4
<li>Review and adjust your system so you can get access to it with NO                                                                                                                                              
packages installed -- i.e., not dependent upon added shells or special                                                                                                                                             
access systems.  You might want to verify you can log in as root and                                                                                                                                               
that root uses a standard shell (i.e., ksh).                                                                                                                                                                       
d889 1
a889 1
<small>$OpenBSD: upgrade55.html,v 1.13 2014/05/02 17:02:23 chl Exp $</small>
@


1.13
log
@Add an explicit reminder that you need to be able to get access
to your system, with NO packages installed.

committed on behalf of nick@@

ok nick@@ chl@@
@
text
@d633 1
d888 1
a888 1
<small>$OpenBSD: upgrade55.html,v 1.12 2014/05/02 13:49:03 nick Exp $</small>
@


1.12
log
@
it's nsd-control.  From Daniel Levai, thanks!
@
text
@d303 4
d887 1
a887 1
<small>$OpenBSD: upgrade55.html,v 1.11 2014/05/01 13:38:22 nick Exp $</small>
@


1.11
log
@
couple missed TOC lines from remco via bugs@@, typo from chl@@.  Thanks!
@
text
@d654 1
a654 1
to change this for a 'nsdc-control write' job.</li>
d883 1
a883 1
<small>$OpenBSD: upgrade55.html,v 1.10 2014/04/30 20:58:12 nick Exp $</small>
@


1.10
log
@
housekeeping.
@
text
@d77 1
d82 1
d275 1
d303 1
a303 1
<li>Review the <a href="#Pkgip">package notes</a> below, before doing
d883 1
a883 1
<small>$OpenBSD: upgrade55.html,v 1.9 2014/04/30 12:00:54 nick Exp $</small>
@


1.9
log
@
another heads-up: kerberos going away for 5.6
@
text
@d25 1
a25 1
<a href="upgrade46.html">[4.5 -> 4.6]</a> |
d32 1
a32 1
<a href="upgrade52.html">[5.1 -> 5.2]</a> |
d861 1
a861 1
<a href="upgrade46.html">[4.5 -> 4.6]</a> |
d868 1
a868 1
<a href="upgrade52.html">[5.1 -> 5.2]</a> |
d880 1
a880 1
<small>$OpenBSD: upgrade55.html,v 1.8 2014/04/29 20:47:55 nick Exp $</small>
@


1.8
log
@
I can't spell, and tj at mrsk dot me can, and for this, I am thankful.
@
text
@d268 2
d880 1
a880 1
<small>$OpenBSD: upgrade55.html,v 1.7 2014/04/29 18:36:31 nick Exp $</small>
@


1.7
log
@
add section about releases being signed.  Yes, references a not yet updated
article in faq3.html, will be there on release day.
@
text
@d146 1
a146 1
OpenBSD releases are now crypographically signed using the new
d151 2
a152 2
After all, if someone has delivered an compromised install set to you,
they would probably have set it to say "all is well".
d878 1
a878 1
<small>$OpenBSD: upgrade55.html,v 1.6 2014/04/29 17:37:30 nick Exp $</small>
@


1.6
log
@
grammar and punctuation, from tj at mrsk dot me, thanks!
@
text
@d74 1
d144 13
d878 1
a878 1
<small>$OpenBSD: upgrade55.html,v 1.5 2014/04/21 16:32:05 nick Exp $</small>
@


1.5
log
@
oops. forgot some 5.4->5.5's
@
text
@d212 1
a212 1
Be aware that Java is currently broken on i386 so packages are not available.
d221 1
a221 1
Some multi-boot systems utilize the process of grabbing a copy of the
d264 2
a265 1
This can be as simple as modifying a specific device using config(8),
d344 1
a344 1
Without this being done, you can not log in after the reboot!
d382 2
a383 2
comment-out any pkg_scripts lines.
Also inspect /etc/rc.shutdown and comment-out any local shutdown commands.
d520 4
a523 4
Usually, it can figure out what to do to update your files, but if it
has difficulty, it will give you the option of keeping the old file,
installing the new file, or assisting you in the manual merging of the
old and new files, using
d566 2
a567 2
If you wish to retain your existing file, delete the temporary file, if
you wish to replace your existing file with the new version, install the
d633 2
a634 2
<li>Remove any old cron jobs that run "nsdc patch", this is no longer needed.
If you wish to write slaved zones to the readable data files, you may like
d638 1
a638 1
nsd-control(8) so nsd(8) flags are no longer available.</li>
d787 3
a789 2
ngircd's configuration directory has changed; if updating from a previous
version, you will need to move your old configuration file into place:
d864 1
a864 1
<small>$OpenBSD: upgrade55.html,v 1.4 2014/04/21 15:36:37 nick Exp $</small>
@


1.4
log
@
Damien Couderc pointed out a bunch of errors: rc.<wrong> -> rc.firsttime
and 54 -> 55.  Thanks!
@
text
@d4 1
a4 1
<title>OpenBSD Upgrade Guide 5.4</title>
d263 1
a263 1
make those changes on a local 5.4 system.
d809 1
a809 1
pointing to the 5.4 packages directory on your CD or nearest FTP mirror,
d862 1
a862 1
<small>$OpenBSD: upgrade55.html,v 1.3 2014/04/15 17:38:47 nick Exp $</small>
@


1.3
log
@
some less annoying wording at the request of Rod Whitworth (and he's right)
@
text
@d345 1
a345 1
manually on first boot after upgrade by creating a <tt>/etc/rc.firstboot</tt>:
d442 1
a442 1
<i>Do NOT install <tt>etc54.tgz</tt> and <tt>xetc54.tgz</tt> now, because
d444 1
a444 1
Note that we are installing base54.tgz LAST, because it will include a new
d469 1
a469 1
<tt>etc54.tgz</tt> and <tt>xetc54.tgz</tt> are NOT unpacked here.
d476 1
a476 1
<tt>base54.tgz</tt>, so you simply need to do the following:
d862 1
a862 1
<small>$OpenBSD: upgrade55.html,v 1.2 2014/04/15 04:43:34 nick Exp $</small>
@


1.2
log
@
first set of typo fixes, from tj at mrsk dot me, thanks!
@
text
@d97 1
a97 1
impact a large number of users in the upgrade process.
d234 1
a234 1
There are a number of big changes coming up in OpenBSD 5.6 (NOT 5.5!)
d341 2
a342 2
The time_t change requires rebuilding a number of files, including
the <tt>/etc/master.password</tt> file.
d598 1
a598 1
A number of files should be deleted from your system, and others
d668 1
a668 1
will impact a large number of users.
d682 2
a683 2
    # Single file:
    rrdtool dump filename.rrd filename.xml
d685 2
a686 2
    # To convert a batch:
    for i in *.rrd; do rrdtool dump $i ${i%.rrd}.xml; done
d690 2
a691 2
    # Single file:
    rrdtool restore filename.xml filename.rrd
d693 2
a694 2
    # To convert a batch:
    for i in *.xml; do rrdtool restore $i ${i%.xml}.rrd; done
d862 1
a862 1
<small>$OpenBSD: upgrade55.html,v 1.1 2014/04/15 03:17:01 nick Exp $</small>
@


1.1
log
@
5.4 -> 5.5 upgrade instructions.
@
text
@d99 1
a99 1
<a href="../plus54.html">plus54.html</a> and the CVS change logs.
d251 1
a251 1
<li>FTP will no longer be an install option, instead, HTTP will be used.
d253 1
a253 1
internally, you may wish to make sure your files can be served by http.
d755 1
a755 1
he twentyeleven theme from wordpress 3.5.x is no longer included with
d862 1
a862 1
<small>$OpenBSD: upgrade54.html,v 1.3 2013/10/07 06:53:11 sthen Exp $</small>
@

