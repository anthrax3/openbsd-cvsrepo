head	1.243;
access;
symbols;
locks; strict;
comment	@# @;


1.243
date	2016.06.16.16.48.45;	author tj;	state dead;
branches;
next	1.242;
commitid	BdkZ6v8AJ8BSSgsj;

1.242
date	2016.03.27.19.52.09;	author sthen;	state Exp;
branches;
next	1.241;
commitid	hi2ObFv9LGB98JY5;

1.241
date	2015.05.11.11.18.30;	author sthen;	state Exp;
branches;
next	1.240;
commitid	wRrXxcro6dFYiwF8;

1.240
date	2006.06.21.04.20.28;	author david;	state Exp;
branches;
next	1.239;

1.239
date	2005.02.09.20.38.54;	author nick;	state Exp;
branches;
next	1.238;

1.238
date	2005.02.07.13.12.20;	author nick;	state Exp;
branches;
next	1.237;

1.237
date	2005.02.02.08.16.46;	author otto;	state Exp;
branches;
next	1.236;

1.236
date	2005.02.02.07.56.38;	author otto;	state Exp;
branches;
next	1.235;

1.235
date	2005.01.24.06.08.34;	author mcbride;	state Exp;
branches;
next	1.234;

1.234
date	2005.01.18.21.45.06;	author henning;	state Exp;
branches;
next	1.233;

1.233
date	2005.01.11.02.30.28;	author nick;	state Exp;
branches;
next	1.232;

1.232
date	2004.12.31.06.01.38;	author david;	state Exp;
branches;
next	1.231;

1.231
date	2004.12.30.21.57.47;	author pvalchev;	state Exp;
branches;
next	1.230;

1.230
date	2004.12.21.16.50.10;	author nick;	state Exp;
branches;
next	1.229;

1.229
date	2004.12.15.08.58.44;	author otto;	state Exp;
branches;
next	1.228;

1.228
date	2004.11.24.19.24.59;	author nick;	state Exp;
branches;
next	1.227;

1.227
date	2004.11.23.16.35.57;	author ian;	state Exp;
branches;
next	1.226;

1.226
date	2004.11.12.13.45.10;	author claudio;	state Exp;
branches;
next	1.225;

1.225
date	2004.11.10.05.13.44;	author nick;	state Exp;
branches;
next	1.224;

1.224
date	2004.10.29.21.04.35;	author pvalchev;	state Exp;
branches;
next	1.223;

1.223
date	2004.10.29.17.27.28;	author nick;	state Exp;
branches;
next	1.222;

1.222
date	2004.10.27.17.59.42;	author kettenis;	state Exp;
branches;
next	1.221;

1.221
date	2004.10.24.14.43.35;	author nick;	state Exp;
branches;
next	1.220;

1.220
date	2004.10.12.16.41.01;	author nick;	state Exp;
branches;
next	1.219;

1.219
date	2004.09.28.13.41.45;	author nick;	state Exp;
branches;
next	1.218;

1.218
date	2004.08.07.13.15.07;	author dhartmei;	state Exp;
branches;
next	1.217;

1.217
date	2004.08.07.13.10.42;	author dhartmei;	state Exp;
branches;
next	1.216;

1.216
date	2004.07.14.06.45.30;	author otto;	state Exp;
branches;
next	1.215;

1.215
date	2004.07.13.22.17.54;	author millert;	state Exp;
branches;
next	1.214;

1.214
date	2004.07.13.21.44.56;	author marc;	state Exp;
branches;
next	1.213;

1.213
date	2004.06.08.08.02.16;	author jmc;	state Exp;
branches;
next	1.212;

1.212
date	2004.06.01.09.46.18;	author henning;	state Exp;
branches;
next	1.211;

1.211
date	2004.05.30.17.03.38;	author henning;	state Exp;
branches;
next	1.210;

1.210
date	2004.05.07.13.20.11;	author henning;	state Exp;
branches;
next	1.209;

1.209
date	2004.05.06.22.08.54;	author nick;	state Exp;
branches;
next	1.208;

1.208
date	2004.05.04.16.39.48;	author millert;	state Exp;
branches;
next	1.207;

1.207
date	2004.05.02.18.02.49;	author millert;	state Exp;
branches;
next	1.206;

1.206
date	2004.05.01.19.43.09;	author millert;	state Exp;
branches;
next	1.205;

1.205
date	2004.04.30.18.32.37;	author nick;	state Exp;
branches;
next	1.204;

1.204
date	2004.04.29.09.22.09;	author tom;	state Exp;
branches;
next	1.203;

1.203
date	2004.04.29.03.28.47;	author nick;	state Exp;
branches;
next	1.202;

1.202
date	2004.04.18.12.31.52;	author otto;	state Exp;
branches;
next	1.201;

1.201
date	2004.04.18.11.10.40;	author deraadt;	state Exp;
branches;
next	1.200;

1.200
date	2004.04.17.20.09.42;	author henning;	state Exp;
branches;
next	1.199;

1.199
date	2004.04.17.19.56.02;	author henning;	state Exp;
branches;
next	1.198;

1.198
date	2004.04.15.00.00.29;	author henning;	state Exp;
branches;
next	1.197;

1.197
date	2004.04.14.07.36.00;	author xsa;	state Exp;
branches;
next	1.196;

1.196
date	2004.04.13.21.54.27;	author henning;	state Exp;
branches;
next	1.195;

1.195
date	2004.04.12.16.24.21;	author millert;	state Exp;
branches;
next	1.194;

1.194
date	2004.04.11.18.37.52;	author millert;	state Exp;
branches;
next	1.193;

1.193
date	2004.03.01.05.55.26;	author nick;	state Exp;
branches;
next	1.192;

1.192
date	2004.03.01.05.16.44;	author nick;	state Exp;
branches;
next	1.191;

1.191
date	2004.02.24.15.18.29;	author tom;	state Exp;
branches;
next	1.190;

1.190
date	2004.02.24.13.27.11;	author xsa;	state Exp;
branches;
next	1.189;

1.189
date	2004.02.22.19.23.47;	author nick;	state Exp;
branches;
next	1.188;

1.188
date	2004.02.02.18.34.40;	author nick;	state Exp;
branches;
next	1.187;

1.187
date	2004.02.02.17.37.29;	author nick;	state Exp;
branches;
next	1.186;

1.186
date	2004.02.02.16.28.43;	author nick;	state Exp;
branches;
next	1.185;

1.185
date	2004.01.28.21.06.07;	author otto;	state Exp;
branches;
next	1.184;

1.184
date	2004.01.23.20.38.08;	author otto;	state Exp;
branches;
next	1.183;

1.183
date	2004.01.15.21.42.38;	author millert;	state Exp;
branches;
next	1.182;

1.182
date	2003.12.28.19.54.54;	author otto;	state Exp;
branches;
next	1.181;

1.181
date	2003.12.07.15.38.29;	author sturm;	state Exp;
branches;
next	1.180;

1.180
date	2003.11.11.00.01.31;	author margarida;	state Exp;
branches;
next	1.179;

1.179
date	2003.11.07.22.25.51;	author nick;	state Exp;
branches;
next	1.178;

1.178
date	2003.11.02.22.49.21;	author david;	state Exp;
branches;
next	1.177;

1.177
date	2003.10.23.17.12.26;	author nick;	state Exp;
branches;
next	1.176;

1.176
date	2003.10.23.16.35.24;	author henning;	state Exp;
branches;
next	1.175;

1.175
date	2003.10.12.15.59.39;	author nick;	state Exp;
branches;
next	1.174;

1.174
date	2003.08.26.04.20.57;	author avsm;	state Exp;
branches;
next	1.173;

1.173
date	2003.08.03.04.49.28;	author avsm;	state Exp;
branches;
next	1.172;

1.172
date	2003.07.14.20.15.56;	author nick;	state Exp;
branches;
next	1.171;

1.171
date	2003.06.27.14.21.50;	author nick;	state Exp;
branches;
next	1.170;

1.170
date	2003.06.26.19.43.03;	author avsm;	state Exp;
branches;
next	1.169;

1.169
date	2003.06.22.18.54.12;	author david;	state Exp;
branches;
next	1.168;

1.168
date	2003.06.03.21.44.58;	author david;	state Exp;
branches;
next	1.167;

1.167
date	2003.05.25.01.42.45;	author tedu;	state Exp;
branches;
next	1.166;

1.166
date	2003.05.06.21.08.25;	author pvalchev;	state Exp;
branches;
next	1.165;

1.165
date	2003.05.05.19.28.33;	author miod;	state Exp;
branches;
next	1.164;

1.164
date	2003.05.05.17.55.52;	author drahn;	state Exp;
branches;
next	1.163;

1.163
date	2003.04.28.22.10.22;	author henning;	state Exp;
branches;
next	1.162;

1.162
date	2003.04.28.21.42.45;	author drahn;	state Exp;
branches;
next	1.161;

1.161
date	2003.04.17.13.28.14;	author drahn;	state Exp;
branches;
next	1.160;

1.160
date	2003.04.17.05.17.00;	author drahn;	state Exp;
branches;
next	1.159;

1.159
date	2003.04.14.21.54.43;	author wilfried;	state Exp;
branches;
next	1.158;

1.158
date	2003.03.25.16.45.22;	author henning;	state Exp;
branches;
next	1.157;

1.157
date	2003.03.22.00.11.56;	author henning;	state Exp;
branches;
next	1.156;

1.156
date	2003.02.26.02.54.48;	author nick;	state Exp;
branches;
next	1.155;

1.155
date	2003.02.25.23.16.56;	author nick;	state Exp;
branches;
next	1.154;

1.154
date	2003.02.20.19.01.25;	author millert;	state Exp;
branches;
next	1.153;

1.153
date	2003.02.19.22.43.40;	author millert;	state Exp;
branches;
next	1.152;

1.152
date	2003.02.10.17.59.21;	author kjell;	state Exp;
branches;
next	1.151;

1.151
date	2003.01.23.01.01.19;	author henning;	state Exp;
branches;
next	1.150;

1.150
date	2003.01.20.21.25.36;	author margarida;	state Exp;
branches;
next	1.149;

1.149
date	2003.01.19.18.11.32;	author henning;	state Exp;
branches;
next	1.148;

1.148
date	2003.01.19.13.55.49;	author henning;	state Exp;
branches;
next	1.147;

1.147
date	2003.01.17.22.31.18;	author drahn;	state Exp;
branches;
next	1.146;

1.146
date	2003.01.14.21.34.46;	author marc;	state Exp;
branches;
next	1.145;

1.145
date	2003.01.07.14.22.12;	author henning;	state Exp;
branches;
next	1.144;

1.144
date	2003.01.07.14.11.49;	author henning;	state Exp;
branches;
next	1.143;

1.143
date	2003.01.07.13.25.39;	author henning;	state Exp;
branches;
next	1.142;

1.142
date	2003.01.07.00.16.55;	author millert;	state Exp;
branches;
next	1.141;

1.141
date	2003.01.06.00.16.32;	author mcbride;	state Exp;
branches;
next	1.140;

1.140
date	2003.01.01.13.02.00;	author nick;	state Exp;
branches;
next	1.139;

1.139
date	2002.12.29.00.59.06;	author kjell;	state Exp;
branches;
next	1.138;

1.138
date	2002.12.26.19.53.48;	author miod;	state Exp;
branches;
next	1.137;

1.137
date	2002.12.15.15.19.55;	author nick;	state Exp;
branches;
next	1.136;

1.136
date	2002.12.03.07.14.11;	author mpech;	state Exp;
branches;
next	1.135;

1.135
date	2002.12.03.06.46.15;	author miod;	state Exp;
branches;
next	1.134;

1.134
date	2002.12.02.17.47.21;	author miod;	state Exp;
branches;
next	1.133;

1.133
date	2002.12.02.16.02.07;	author pvalchev;	state Exp;
branches;
next	1.132;

1.132
date	2002.12.02.16.00.42;	author henning;	state Exp;
branches;
next	1.131;

1.131
date	2002.12.02.14.31.48;	author henning;	state Exp;
branches;
next	1.130;

1.130
date	2002.12.02.14.22.16;	author henning;	state Exp;
branches;
next	1.129;

1.129
date	2002.12.02.12.56.13;	author henning;	state Exp;
branches;
next	1.128;

1.128
date	2002.12.02.12.51.05;	author henning;	state Exp;
branches;
next	1.127;

1.127
date	2002.11.21.22.42.03;	author millert;	state Exp;
branches;
next	1.126;

1.126
date	2002.11.21.22.41.11;	author millert;	state Exp;
branches;
next	1.125;

1.125
date	2002.11.21.22.20.26;	author millert;	state Exp;
branches;
next	1.124;

1.124
date	2002.11.21.21.31.14;	author millert;	state Exp;
branches;
next	1.123;

1.123
date	2002.11.05.18.25.37;	author millert;	state Exp;
branches;
next	1.122;

1.122
date	2002.11.05.13.23.50;	author henning;	state Exp;
branches;
next	1.121;

1.121
date	2002.10.14.09.39.51;	author henning;	state Exp;
branches;
next	1.120;

1.120
date	2002.10.13.21.07.15;	author henning;	state Exp;
branches;
next	1.119;

1.119
date	2002.10.13.02.41.34;	author nick;	state Exp;
branches;
next	1.118;

1.118
date	2002.10.09.10.21.30;	author henning;	state Exp;
branches;
next	1.117;

1.117
date	2002.09.15.16.16.59;	author nick;	state Exp;
branches;
next	1.116;

1.116
date	2002.09.13.13.20.11;	author henning;	state Exp;
branches;
next	1.115;

1.115
date	2002.08.17.10.37.41;	author henning;	state Exp;
branches;
next	1.114;

1.114
date	2002.07.21.08.37.56;	author horacio;	state Exp;
branches;
next	1.113;

1.113
date	2002.07.15.19.47.22;	author millert;	state Exp;
branches;
next	1.112;

1.112
date	2002.06.21.13.00.12;	author mpech;	state Exp;
branches;
next	1.111;

1.111
date	2002.06.13.04.39.24;	author kjell;	state Exp;
branches;
next	1.110;

1.110
date	2002.06.10.20.40.11;	author kjell;	state Exp;
branches;
next	1.109;

1.109
date	2002.06.09.10.01.45;	author kjell;	state Exp;
branches;
next	1.108;

1.108
date	2002.06.08.02.19.13;	author millert;	state Exp;
branches;
next	1.107;

1.107
date	2002.05.30.22.00.23;	author kjell;	state Exp;
branches;
next	1.106;

1.106
date	2002.05.30.19.56.17;	author kjell;	state Exp;
branches;
next	1.105;

1.105
date	2002.05.30.05.49.15;	author kjell;	state Exp;
branches;
next	1.104;

1.104
date	2002.05.30.05.34.12;	author kjell;	state Exp;
branches;
next	1.103;

1.103
date	2002.05.27.05.14.55;	author kjell;	state Exp;
branches;
next	1.102;

1.102
date	2002.05.17.18.21.47;	author millert;	state Exp;
branches;
next	1.101;

1.101
date	2002.05.17.17.46.46;	author millert;	state Exp;
branches;
next	1.100;

1.100
date	2002.05.17.16.29.36;	author millert;	state Exp;
branches;
next	1.99;

1.99
date	2002.05.16.22.42.14;	author naddy;	state Exp;
branches;
next	1.98;

1.98
date	2002.05.15.06.09.28;	author kjell;	state Exp;
branches;
next	1.97;

1.97
date	2002.05.14.20.34.51;	author kjell;	state Exp;
branches;
next	1.96;

1.96
date	2002.05.13.22.45.04;	author millert;	state Exp;
branches;
next	1.95;

1.95
date	2002.03.08.05.40.29;	author kjell;	state Exp;
branches;
next	1.94;

1.94
date	2002.03.04.21.23.13;	author millert;	state Exp;
branches;
next	1.93;

1.93
date	2002.02.14.19.07.46;	author mpech;	state Exp;
branches;
next	1.92;

1.92
date	2002.02.14.18.47.15;	author mpech;	state Exp;
branches;
next	1.91;

1.91
date	2002.02.13.21.40.39;	author pvalchev;	state Exp;
branches;
next	1.90;

1.90
date	2002.02.12.21.09.31;	author pvalchev;	state Exp;
branches;
next	1.89;

1.89
date	2002.02.02.05.17.18;	author chris;	state Exp;
branches;
next	1.88;

1.88
date	2002.01.17.17.49.39;	author kjell;	state Exp;
branches;
next	1.87;

1.87
date	2002.01.17.06.21.44;	author kjell;	state Exp;
branches;
next	1.86;

1.86
date	2002.01.17.05.21.58;	author kjell;	state Exp;
branches;
next	1.85;

1.85
date	2002.01.16.20.28.05;	author kjell;	state Exp;
branches;
next	1.84;

1.84
date	2002.01.14.22.49.17;	author kjell;	state Exp;
branches;
next	1.83;

1.83
date	2002.01.10.09.42.10;	author reinhard;	state Exp;
branches;
next	1.82;

1.82
date	2002.01.07.20.36.46;	author naddy;	state Exp;
branches;
next	1.81;

1.81
date	2001.12.31.00.32.07;	author horacio;	state Exp;
branches;
next	1.80;

1.80
date	2001.12.18.15.34.25;	author ian;	state Exp;
branches;
next	1.79;

1.79
date	2001.12.10.17.00.59;	author kjell;	state Exp;
branches;
next	1.78;

1.78
date	2001.11.26.02.12.25;	author pvalchev;	state Exp;
branches;
next	1.77;

1.77
date	2001.11.25.19.54.42;	author lebel;	state Exp;
branches;
next	1.76;

1.76
date	2001.11.25.02.00.56;	author miod;	state Exp;
branches;
next	1.75;

1.75
date	2001.11.25.01.53.34;	author pvalchev;	state Exp;
branches;
next	1.74;

1.74
date	2001.11.25.01.48.22;	author miod;	state Exp;
branches;
next	1.73;

1.73
date	2001.10.17.23.14.32;	author heko;	state Exp;
branches;
next	1.72;

1.72
date	2001.10.10.07.09.58;	author kjell;	state Exp;
branches;
next	1.71;

1.71
date	2001.09.20.13.28.18;	author horacio;	state Exp;
branches;
next	1.70;

1.70
date	2001.09.15.17.39.08;	author kjell;	state Exp;
branches;
next	1.69;

1.69
date	2001.09.06.05.54.43;	author kjell;	state Exp;
branches;
next	1.68;

1.68
date	2001.09.05.03.56.16;	author kjell;	state Exp;
branches;
next	1.67;

1.67
date	2001.08.23.07.12.50;	author heko;	state Exp;
branches;
next	1.66;

1.66
date	2001.08.21.14.45.54;	author hin;	state Exp;
branches;
next	1.65;

1.65
date	2001.08.17.18.26.11;	author kjell;	state Exp;
branches;
next	1.64;

1.64
date	2001.08.17.18.17.01;	author kjell;	state Exp;
branches;
next	1.63;

1.63
date	2001.08.17.17.57.52;	author kjell;	state Exp;
branches;
next	1.62;

1.62
date	2001.08.12.06.21.25;	author pvalchev;	state Exp;
branches;
next	1.61;

1.61
date	2001.07.06.13.39.05;	author hin;	state Exp;
branches;
next	1.60;

1.60
date	2001.07.05.20.26.00;	author pvalchev;	state Exp;
branches;
next	1.59;

1.59
date	2001.07.05.19.48.56;	author pvalchev;	state Exp;
branches;
next	1.58;

1.58
date	2001.07.04.16.17.21;	author pvalchev;	state Exp;
branches;
next	1.57;

1.57
date	2001.07.02.20.48.36;	author jufi;	state Exp;
branches;
next	1.56;

1.56
date	2001.07.02.01.17.24;	author pvalchev;	state Exp;
branches;
next	1.55;

1.55
date	2001.06.30.17.12.44;	author pvalchev;	state Exp;
branches;
next	1.54;

1.54
date	2001.06.29.21.14.01;	author pvalchev;	state Exp;
branches;
next	1.53;

1.53
date	2001.06.09.16.39.05;	author pvalchev;	state Exp;
branches;
next	1.52;

1.52
date	2001.06.07.04.10.05;	author pvalchev;	state Exp;
branches;
next	1.51;

1.51
date	2001.06.05.04.07.31;	author kjell;	state Exp;
branches;
next	1.50;

1.50
date	2001.06.05.03.22.18;	author kjell;	state Exp;
branches;
next	1.49;

1.49
date	2001.04.08.20.47.03;	author kjell;	state Exp;
branches;
next	1.48;

1.48
date	2001.03.02.20.21.28;	author kjell;	state Exp;
branches;
next	1.47;

1.47
date	2001.02.07.22.20.14;	author kjell;	state Exp;
branches;
next	1.46;

1.46
date	2001.02.07.21.44.55;	author aaron;	state Exp;
branches;
next	1.45;

1.45
date	2001.02.07.20.20.18;	author kjell;	state Exp;
branches;
next	1.44;

1.44
date	2001.01.27.22.19.48;	author ericj;	state Exp;
branches;
next	1.43;

1.43
date	2001.01.16.11.30.53;	author horacio;	state Exp;
branches;
next	1.42;

1.42
date	2000.12.29.15.28.52;	author aaron;	state Exp;
branches;
next	1.41;

1.41
date	2000.12.26.10.41.05;	author horacio;	state Exp;
branches;
next	1.40;

1.40
date	2000.12.24.23.46.05;	author naddy;	state Exp;
branches;
next	1.39;

1.39
date	2000.12.21.18.19.08;	author kjell;	state Exp;
branches;
next	1.38;

1.38
date	2000.08.07.06.18.51;	author kjell;	state Exp;
branches;
next	1.37;

1.37
date	2000.08.07.04.46.42;	author kjell;	state Exp;
branches;
next	1.36;

1.36
date	2000.08.07.04.08.38;	author kjell;	state Exp;
branches;
next	1.35;

1.35
date	2000.06.11.18.32.27;	author kjell;	state Exp;
branches;
next	1.34;

1.34
date	2000.06.05.13.20.21;	author kjell;	state Exp;
branches;
next	1.33;

1.33
date	2000.06.05.13.02.33;	author kjell;	state Exp;
branches;
next	1.32;

1.32
date	2000.05.15.02.36.52;	author wvdputte;	state Exp;
branches;
next	1.31;

1.31
date	2000.04.18.18.43.22;	author kjell;	state Exp;
branches;
next	1.30;

1.30
date	2000.04.18.17.49.38;	author wvdputte;	state Exp;
branches;
next	1.29;

1.29
date	2000.04.18.17.24.17;	author kjell;	state Exp;
branches;
next	1.28;

1.28
date	2000.04.15.19.33.35;	author millert;	state Exp;
branches;
next	1.27;

1.27
date	2000.04.15.17.32.15;	author millert;	state Exp;
branches;
next	1.26;

1.26
date	2000.04.12.18.15.37;	author kjell;	state Exp;
branches;
next	1.25;

1.25
date	2000.04.11.20.25.49;	author kjell;	state Exp;
branches;
next	1.24;

1.24
date	2000.04.11.19.18.39;	author kjell;	state Exp;
branches;
next	1.23;

1.23
date	2000.04.11.18.43.35;	author kjell;	state Exp;
branches;
next	1.22;

1.22
date	2000.04.07.22.26.57;	author kjell;	state Exp;
branches;
next	1.21;

1.21
date	2000.04.07.01.54.03;	author millert;	state Exp;
branches;
next	1.20;

1.20
date	2000.04.03.18.31.00;	author kjell;	state Exp;
branches;
next	1.19;

1.19
date	2000.03.12.21.39.23;	author kjell;	state Exp;
branches;
next	1.18;

1.18
date	2000.03.07.00.05.40;	author kjell;	state Exp;
branches;
next	1.17;

1.17
date	2000.02.17.20.27.10;	author millert;	state Exp;
branches;
next	1.16;

1.16
date	2000.01.21.03.16.53;	author kjell;	state Exp;
branches;
next	1.15;

1.15
date	2000.01.17.20.09.25;	author kjell;	state Exp;
branches;
next	1.14;

1.14
date	2000.01.12.19.37.28;	author kjell;	state Exp;
branches;
next	1.13;

1.13
date	2000.01.12.18.58.55;	author kjell;	state Exp;
branches;
next	1.12;

1.12
date	2000.01.12.17.59.16;	author kjell;	state Exp;
branches;
next	1.11;

1.11
date	2000.01.10.20.09.04;	author kjell;	state Exp;
branches;
next	1.10;

1.10
date	2000.01.09.20.17.43;	author kjell;	state Exp;
branches;
next	1.9;

1.9
date	99.11.24.20.42.29;	author ericj;	state Exp;
branches;
next	1.8;

1.8
date	99.10.02.03.08.12;	author ericj;	state Exp;
branches;
next	1.7;

1.7
date	99.07.27.05.25.48;	author kjell;	state Exp;
branches;
next	1.6;

1.6
date	99.07.05.20.05.36;	author kjell;	state Exp;
branches;
next	1.5;

1.5
date	99.06.30.16.01.28;	author ericj;	state Exp;
branches;
next	1.4;

1.4
date	99.06.21.21.54.39;	author ericj;	state Exp;
branches;
next	1.3;

1.3
date	99.06.03.20.08.31;	author kjell;	state Exp;
branches;
next	1.2;

1.2
date	99.06.03.12.43.23;	author kjell;	state Exp;
branches;
next	1.1;

1.1
date	99.06.03.04.19.27;	author kjell;	state Exp;
branches;
next	;


desc
@@


1.243
log
@this page has been obsoleted for eleven years.
@
text
@<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
    <title>OpenBSD Upgrading Mini-FAQ</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="../openbsd.css">
    <link rel="canonical" href="http://www.openbsd.org/faq/upgrade-minifaq.html">
  </head>

  <body bgcolor="#FFFFFF" text="#000000" link="#23238E">

<h1><font color="#FF0000">Note: this document has been obsoleted</font></h1>
Please see:
<ul>
<li><a href="faq5.html">Building from source</a>
<li><a href="current.html">Following Current</a>
</ul>
for the content formerly in this page.


<p>
<small>$OpenBSD: upgrade-minifaq.html,v 1.242 2016/03/27 19:52:09 sthen Exp $</small><br>

</body>
</html>

@


1.242
log
@add a small sprinkling of css to improve readability in the faq, ok tj@@ tb@@
@
text
@d24 1
a24 1
<small>$OpenBSD: upgrade-minifaq.html,v 1.241 2015/05/11 11:18:30 sthen Exp $</small><br>
@


1.241
log
@Add 'link rel="canonical"' to pages, acting as a hint to search engines
to list the copies on www.openbsd.org rather than mirrors.

From Carlin Bingham, ok millert@@ nick@@
@
text
@d7 2
d24 1
a24 1
<small>$OpenBSD: upgrade-minifaq.html,v 1.240 2006/06/21 04:20:28 david Exp $</small><br>
@


1.240
log
@HTML validation fixes; ok nick@@
@
text
@d7 1
d22 1
a22 1
<small>$OpenBSD: upgrade-minifaq.html,v 1.239 2005/02/09 20:38:54 nick Exp $</small><br>
@


1.239
log
@
Remove content, point to new locations. ok (and kick) from pvalchev@@
@
text
@d11 1
a11 1
<font color="#FF0000"><h1>Note: this document has been obsoleted</h1></font>
d21 1
a21 1
<small>$OpenBSD: upgrade-minifaq.html,v 1.238 2005/02/07 13:12:20 nick Exp $</small><br>
@


1.238
log
@
Move all info from 3.5 and older from upgrade-minifaq.html to
upgrade-old.html.  This is the next step on the evolution of documenting
the OpenBSD build process.
Want to upgrade from release to release?  Use upgradeXX.html.
Want to upgrade to -current from 3.6-release?  Use upgrade-minifaq.html
Want to know how to build from source?  Use faq5.html
Still to be done: remove building instructions from upgrade-minifaq.html.
@
text
@d11 7
a17 1
    <h1>MINI-FAQ: Upgrading OpenBSD</h1>
a18 681
    <h2>Latest OpenBSD Release - 3.6</h2>

    <blockquote>
      <p>This Mini-FAQ is an attempt to address the most common
      issues encountered when upgrading OpenBSD 3.6-release to
      <em>-current</em>.
      Information on older versions can be found in a <a href=
      "upgrade-old.html">separate document</a>.</p>

      <p>
      To upgrade from previous releases to 3.6, see 
      <a href="upgrade36.html">upgrade36.html</a>.
    </blockquote>

    <p>
      The Upgrade-MiniFAQ is intended for <b>Advanced Users</b>.
      If you are a beginner, or are <b>not completely confident</b>
      with your compiler and toolchain, then upgrading via source is
      <b>not for you</b>. Install a binary release or snapshot instead,
      then apply any relevant instructions below for upgrading
      <tt>/etc</tt>.
    </p>

    <h2>General Upgrade Questions</h2>
    
    <p>
      <a href="#1.1">1.1: Terminology. What is <em>-current</em>?
	What are Snapshots? What is <em>-stable</em>?</a><br>
      
      <a href="#1.2">1.2: What is the easiest way to upgrade?</a><br>
      
      <a href="#1.3">1.3: I looked, but didn't see any snapshots on
	the FTP site. Where did they go?</a><br>
      
      <a href="#1.4">1.4: How do I get the latest source?</a><br>
      
      <a href="#1.5">1.5: Okay, I have the tree. How do I build
	it?</a><br>
      
      <a href="#1.7">1.7: I'm getting errors during the build. What
	do I do?</a><br>
      
      <a href="#1.8">1.8: Is there a standard way of
	upgrading the compiler, <em>gcc</em>?</a><br>
      
      <a href="#1.9">1.9: What is the best way to upgrade
	<tt>/etc</tt>, <tt>/var</tt>, and <tt>/dev</tt>?</a><br>
      
      <a href="#1.11">1.11: Do I have to be root to do a <em>make
	  build</em>?</a><br>
      
      <a href="#1.12">1.12: Why am I not seeing any new
	devices?</a><br>
      
      <a href="#1.13">1.13: Is there an easy way to make all the
	file hierarchy changes?</a><br>

      <a href="#1.14">1.14: After an upgrade, <em>ps</em> now reports
	"proc size mismatch."</a><br>

      <a href="#1.15">1.15: How can I upgrade to the latest snapshot?</a><br>


    </p>

    <h2>Upgrading from 3.6 to <i>-current</i></h2>
    <p>
      <a href="#3.6.1">3.6.1: Exception handling flag day (amd64, cats,
                hppa, sgi, sparc64)</a><br>
      <a href="#3.6.2">3.6.2: Switch to gcc3 (macppc)</a><br>
      <a href="#3.6.3">3.6.3: bgpd behaviour change</a><br>
      <a href="#3.6.4">3.6.4: New user and group: _ftp</a><br>
      <a href="#3.6.5">3.6.5: Switch to gcc3 (i386)</a><br>
      <a href="#3.6.6">3.6.6: New user and group _ospfd</a><br>
      <a href="#3.6.7">3.6.7: pfsync takes syncdev instead of syncif</a><br>
      <a href="#3.6.8">3.6.8: POSIX hex and octal constants in (k)sh</a><br>
    </p>
    
    <h2>Upgrading from 3.5 to 3.6</h2>
    <p>
      <a href="upgrade36.html">upgrade36.html</a><br>
    </p>

    <h2>Upgrading from 3.4 to 3.5</h2>
    <p>
      <a href="upgrade35.html">upgrade35.html</a><br>

    <h2>Upgrading from Earlier Versions</h2>

    <p>Historic information on upgrading earlier versions of OpenBSD
      has been moved to a <a href="upgrade-old.html">separate
	document</a>. This document was getting just
      too darn big.</p>


    &nbsp;<hr width="30%">

    <a name="1.0"></a> 
    <h2>General Upgrade Questions</h2>

    <a name="1.1"></a> 
    <h3>1.1: Terminology. What is <em>-current</em>? What are
      Snapshots? What is <em>-stable</em>?</h3>
    
    <p>Prior to OpenBSD 2.7, OpenBSD development happened from a
      single, unbranched source tree. As of 2.7, a patch branch was
      introduced.</p>
    
    <p>At approximately six-month intervals, OpenBSD
      <em>releases</em> are produced. These are numbered in the
      conventional (2.x, 3.x) manner. The current OpenBSD release is
      indicated at the top of this document.</p>
    
    <p><em>-current</em>, short for <em>openbsd-current</em>,
      refers to the up-to-the-minute version of the source tree
      contained in the CVS repository. This is the tree most commonly
      used by OpenBSD developers. The <em>-current</em> tree contains
      all the code that is planned for the next release. From time to
      time, brave souls will abandon the formal releases and run
      openbsd-current, usually to take advantage of features that
      have not yet made it into the formal releases. Because of its
      uncertain nature, however, upgrading to <em>-current</em> is
      not recommended for non-technical users.</p>
    
    <p>Between formal releases, a series of <em>snapshot</em>
      releases are
      <a href="ftp://ftp.openbsd.org/pub/OpenBSD/snapshots/">made
	available.</a> Snapshots are test releases of the
      <em>-current</em> source tree. Because they reflect the current
      state of development, there is no guarantee that snapshot
      releases will work correctly (or even at all). Snapshots are
      quite useful when moving from a formal release (or older
      version of -current) to the current tree. If you happen to run
      <em>-current</em> it is strongly recommended to follow the
      <em>source-changes</em> <a href="/mail.html">mailing list</a>.
      The commit messages often contain valuable information about
      the latest and greatest features added.</p>
    
    <p>As of OpenBSD 2.7, a <a href="../stable.html">patch
	branch</a> (called <em>-stable</em>) was introduced. This
      branch contains the base release, and any important patches or
      fixes (important being the errata patches, plus others that are
      obvious and simple, but do not deserve an errata entry).</p>
    
    <p>The <a href="../ports.html">ports tree</a> is an integral
      part of the system. You should upgrade the ports tree at the
      same time as the rest of the system, following the same rules
      as for upgrading everything else; i.e., you should run -stable
      ports on a -stable system, and -current ports only on a
      -current system.</p>

    <a name="1.2"></a>
    <h3>1.2: What is the best way to upgrade?</h3>
    
    <p>Due to changes in the underlying libraries, upgrading by 
      source is very difficult.
      <b>The best and only supported way to move up to
      <i>-current</i> is to first <a href="#1.15">upgrade to the
      latest snapshot</a>.</b>
      <b>The best and only supported way to move from release
      to release is to install the binaries from the most
      recent release.</b>
      Instructions for upgrading from 3.5 to 3.6 are
      <a href="upgrade36.html">here</a>.
      Once the snapshot or release is installed, the source can be 
      <a href="#1.4">fetched</a> and <a href="#1.5">built</a>,
      though there is rarely reason to do so. This
      procedure should eliminate most toolchain and library
      problems.
      Again, attempting to upgrade from source without first starting
      from the closest available snapshot or release is <i>not
      supported</i>.

    <a name="1.3"></a> 
    <h3>1.3: I looked, but didn't see any snapshots on the FTP
      site. Where did they go?</h3>
    
    <p>Snapshots may be removed as they become old (or no longer
      relevant). If no snapshot is available, you should upgrade to
      the most recent release and build the remainder of the way from
      source.</p>

    <a name="1.4"></a> 
    <h3>1.4: How do I get the latest source?</h3>

    <p>Short answer: 
      <a href="../anoncvs.html">http://www.openbsd.org/anoncvs.html</a></p>
    
    <p>For example. To retrieve the entire tree via CVS: (using the
      ksh shell. Others substitute <em>setenv</em> for
      <em>export</em>)</p>

<pre>
  # export CVSROOT=anoncvs@@anoncvs.ca.openbsd.org:/cvs
  # export CVS_RSH=/usr/bin/ssh
  # cd /usr
  # cvs -q get -P src
</pre>

    <p>Note that this gets you -current. You probably don't want that.
      For example, to retrieve 3.6-stable, use</p>

<pre>
  # cvs -q get -rOPENBSD_3_6 -P src
</pre>

    <a name="1.5"></a> 
    <h3>1.5: Okay, I have the tree. How do I build it?</h3>
    
    <p>Basic instructions are in 
      <a href="http://www.openbsd.org/cgi-bin/cvsweb/src/Makefile"
	 ><tt>/usr/src/Makefile</tt></a>.
      This is a slightly expanded version.</p>
    
    <ol>
      <li>
        <p>Clean out the old object files, and rebuild the symbolic links:

<pre>
  # rm -rf /usr/obj/*
  # cd /usr/src
  # make obj
</pre>

        <p>If you find yourself performing this step a lot, you may
	  find it faster to place /usr/obj onto its own partition,
	  and use <em>newfs</em> instead of <em>rm</em>. For example,
	  I do a:</p>

<pre>
  # umount /usr/obj
  # newfs wd0h
  # mount /usr/obj
  # make obj
</pre>

        <p>If you're worried there are object files in your source
	  tree, do this:</p>

<pre>
  # cd /usr/src
  # find . -type l -name obj | xargs rm
  # make cleandir
  # rm -rf /usr/obj/*
  # make obj
</pre>

      </li>
      
      <li>
        <p>Perform any version-specific configuration changes. For
	  example, 3.5 users must add the <em>_dhcp</em> user and
	  group before moving to 3.6 or later. See the specific
	  Mini-FAQ section for your version.</p>
      </li>
      
      <li>
        <p>Make sure all the appropriate directories are created.
	  This is especially important when upgrading from older
	  versions, but is sometimes necessary in other cases. The
	  easiest way to do this is:</p>
<pre>
  # cd /usr/src/etc &amp;&amp; env DESTDIR=/ make distrib-dirs
</pre>

      </li>

      <li>
        <p>Compile a new kernel.</p>
<pre>
  # cd /usr/src/sys/arch/`machine`/conf
</pre>

        <p>Most users will want to use GENERIC:</p>
<pre>
  # config GENERIC
  # cd ../compile/GENERIC
</pre>

        <p><strong>NOTE:</strong> The truly masochistic in the
	  crowd may want to compile a custom kernel instead. In these
	  cases, it's usually best to start with GENERIC and adjust
	  from there. Do the following procedure instead:</p>
<pre>
  # cp GENERIC MYKERNEL
  # vi MYKERNEL
  (edit MYKERNEL to your liking)
  # config MYKERNEL
  # cd ../compile/MYKERNEL
</pre>
Note that this leaves you with an unsupported system.

        <p>In either case,</p>
<pre>
  # make clean &amp;&amp; make depend &amp;&amp; make
  (arc architecture only) copy bsd.ecoff to your FAT partition
  # cp /bsd /bsd.old &amp;&amp; cp bsd /bsd
  # chown root:wheel /bsd (if you compiled as someone else)
  (reboot)
</pre>
      </li>

      <li>
        <p>Compile the system.</p>
<pre>
  # cd /usr/src
  # make build
</pre>
      </li>

      <li>
        <p>Update <tt>/etc</tt> and <tt>/dev</tt> by hand. These
	  are not updated automatically. Choose a directory with
	  enough space to hold /, /dev, /var, and /etc. Here I'll use
	  <em>/home/newroot</em></p>
<pre>
  # mkdir /home/newroot          
  # export DESTDIR=/home/newroot
  # cd /usr/src/etc &amp;&amp; make distribution-etc-root-var
</pre>

        <p>Now compare the files in /home/newroot with their
	  installed counterparts. Replace or update the files as
	  necessary.</p>
<pre>
  # rm -rf /home/newroot   (when done)
</pre>
      </li>

      <li>
        <p>Reboot to make sure the new /etc files are correct</p>
      </li>
    </ol>

    <a name="1.7"></a> 
    <h3>1.7: I'm getting errors during the build. What do I
      do?</h3>

See <a href="#1.2">here</a>.

    <a name="1.8"></a> 
    <h3>1.8: I'm upgrading to a newer version of the compiler
      (<em>gcc</em>). Is there a standard way of bootstrapping
      it?</h3>

You should really just <a href="#1.2">install the latest snapshot</a>.

    <p>OpenBSD now supports two compilers in-tree, gcc v2.95.3 used by
      most platforms, but also gcc v3.3.5 used by a few platforms which
      work better with it than with v2.95.3.

      The two compilers are in different parts of the tree:
       <ul>
       <li>gcc3: <tt>/usr/src/gnu/usr.bin/gcc</tt>
       <li>gcc2: <tt>/usr/src/gnu/egcs/gcc</tt>
       </ul>
      Some platforms will be switching to gcc3 in the future, but some
      are unlikely to ever switch, due to lack of gcc3 support.

    <p>Because upgrading a compiler is a bit of a chicken-and-egg
      problem, changes to the in-tree compiler require a little extra
      attention. In general, you'll want to perform the following
      procedure:</p>

    <p>(and yes, you are building it twice)</p>

<pre>
  <b>If your platform uses gcc 2.95.3:</b>
    # rm -r /usr/obj/gnu/egcs/gcc/*
    # cd /usr/src/gnu/egcs/gcc
        <i>- or -</i>
  <b>If your platform uses gcc 3.3.5:</b>
    # rm -r /usr/obj/gnu/usr.bin/gcc/*
    # cd /usr/src/gnu/usr.bin/gcc

  <b>Common build procedure for v3.3.5 or v2.95.3</b>
  # make -f Makefile.bsd-wrapper clean
  # make -f Makefile.bsd-wrapper obj
  # make -f Makefile.bsd-wrapper depend
  # make -f Makefile.bsd-wrapper 
  # make -f Makefile.bsd-wrapper install
  # make -f Makefile.bsd-wrapper clean
  # make -f Makefile.bsd-wrapper depend
  # make -f Makefile.bsd-wrapper 
  # make -f Makefile.bsd-wrapper install
</pre>

    <p>And then run a normal <em>make build</em>.</p>


    <a name="1.9"></a> 
    <h3>1.9: What is the best way to upgrade <tt>/etc</tt>,
      <tt>/var</tt>, and <tt>/dev</tt>?</h3>
    
    <p><strong>Short Answer</strong>: By Hand.</p>
    
    <p><strong>Long answer</strong>:</p>

    <p>As a policy, software in the OpenBSD tree does not modify
      files in <tt>/etc</tt> automatically. This means it is
      <em>always</em> up to the administrator to make the necessary
      modifications there. Upgrades are no exception. To update files
      in these directories, first determine what changes have
      occurred to the base (distribution) files, and then manually
      reapply these changes.</p>

    <p>For example, to see the files in the tree that have changed
      most recently, do a:</p>

<pre>
  # cd /usr/src/etc
  # ls -lt |more
</pre>

    <p>To see all the changes in <tt>/etc</tt> between arbitrary
      versions of OpenBSD, you can use 
      <a href="../anoncvs.html">CVS</a>. For example, to see the changes
      between 3.5 and 3.6, do a:</p>

<pre>
  # cd /usr/src/etc
  # cvs diff -u -rOPENBSD_3_5 -rOPENBSD_3_6
</pre>

    <p>Once you have identified the changes, reapply them to your
      local tree, preserving any local configuration you may have
      done.</p>

    <p>Typical <tt>/etc</tt> changes to watch out for between releases
      include:</p>
     
    <ul>
      <li>Additions to <tt>/etc/protocols</tt> and <tt>/etc/services</tt></li>
      <li>New sysctls. (see <tt>/etc/sysctl.conf</tt>)</li>
      <li>Changes to the default cron jobs. See <tt>/etc/daily</tt>, 
	<tt>/etc/weekly</tt>, <tt>/etc/monthly</tt>, and <tt>/etc/security</tt>
      </li>
      <li>All rc scripts, including netstart</li>
      <li>Device changes. See
	<a href="#1.12">1.12</a>
      </li>
      <li>File hierarchy changes in <tt>/etc/mtree</tt>. See 
	<a href="#1.13">1.13</a>
      </li>
      <li>
	New users (<tt>/etc/passwd</tt>)and groups (<tt>/etc/group</tt>)
      </li>
    </ul>

    <a name="1.11"></a> 
    <h3>1.11: Do I have to be root to do a <em>make
	build</em>?</h3>

Yes.

    <a name="1.12"></a> 
    <h3>1.12: Why am I not seeing any new devices?</h3>
    
    <p>The <tt>/dev/MAKEDEV</tt> script is not updated
    automatically as part of the <em>make build</em> process. As a
      general rule, it is a good idea to copy and run this script
      from your source tree when performing an upgrade:</p>

<pre>
  # cd /dev
  # cp /usr/src/etc/etc.`machine`/MAKEDEV ./
  # ./MAKEDEV all
</pre>

    <a name="1.13"></a> 
    <h3>1.13: Is there an easy way to make all the file hierarchy
      changes?</h3>

    <p>From time to time, files or directories are added to, or
      removed from the file hierarchy. Also, ownership information
      for portions of the filesystem may change. An easy way to
      ensure that your file hierarchy is up-to-date is to use the 
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mtree&amp;sektion=8">
	mtree(8)</a> utility.</p>
    
    <p>First, fetch the latest source, then do the following:</p>

<pre>
  # cd /usr/src/etc/mtree
  # install -c -o root -g wheel -m 600 special /etc/mtree
  # install -c -o root -g wheel -m 444 4.4BSD.dist /etc/mtree
  # mtree -qdef /etc/mtree/4.4BSD.dist -p / -u
</pre>

    <p>Your file hierarchy should now be up to date.</p>

    <a name="1.14"></a> 
    <h3>1.14: After an upgrade, <em>ps</em> now reports
      "proc size mismatch."</h3>

    <p>
      Your userland and kernel are out of sync. They must both be
      compiled from the same sources, as certain dependencies exist
      between them. Rebuild your kernel and userland from the same
      sources to correct the problem.
    </p>
    
    <p>
      Since you've already made one mistake, now is an ideal time to
      reread this document in its entirety, to catch any other things
      you may have missed.
      Pay special attention to the advice to <a href="#1.15">install
      a snapshot</a>.
    </p>


    <a name="1.15"></a>
    <h3>1.15: How can I upgrade to the latest snapshot?</h3>

    <p>
      Installing snapshot is the best way to keep up to date.
      We want you to test snapshots
      to make sure the next release is of superior quality.
      And it is much less difficult than building the whole tree.
    </p>

    <p>
      The easiest way to get <em>-current</em> is to grab a
      snapshot boot image
      and prepare as described in the
      <a href="faq4.html">FAQ</a>. Once booted, you choose
      &quot;(U)pgrade&quot; and follow the instructions.

    <p>
Using a <i>-release</i> boot media is NOT recommended to install a
snapshot, use boot media that matches the version you are installing.

    <p>
      There are several opportunities to start the upgrade program.
      Usually, the easiest methods are booting from floppy or CD-ROM
      or place a -current <a href="faq4.html#bsd.rd">bsd.rd</a> on your /
      and boot that instead of <tt>/bsd</tt>.
      Other options include booting over the network and booting from tape.
      Not all methods are available for all architectures, refer to the
      installation instructions for more information.
    </p>

    <p>
      While in-place upgrades sometimes work, this is not recommended.
      The only safe way to upgrade is booting from a new install/upgrade media
      as described above.
    </p>

    <p>
      In all cases, you must upgrade <a href="#1.9">/etc, /var and /dev</a>
      by hand.
    </p>

    <a name="3.6"></a>
    <h2>
      Upgrading from 3.6 to <i>-current</i>
    </h2>

    <a name="3.6.1"></a>
    <h3>
      3.6.1: Exception handling flag day (amd64, cats,  hppa, sgi, sparc64) (2004/10/27)
    </h3>
    <p>
      Changes have been made to gcc3 to make it possible to use
      DWARF-based exception handling on OpenBSD.  Since these changes
      depend on some fairly recent changes to libc, the following
      steps must be followed to build a usable system.
      <ul>
          <li>Update your source code tree
          <li>Build a new kernel
	  <li>Install the new kernel and reboot
	  <li>Install new header files:
<pre>
     # cd /usr/src && make obj && make cleandir && make includes
</pre>
	  <li>Build and install a new version of libc:
<pre>
     # cd /usr/src/lib/libc && make depend && make && env NOMAN=1 make install
</pre>
          <li><a href="#1.8">Build and install gcc3</a>
	  <li>Build and install a new version of libstdc++:
<pre>
     # cd /usr/src/gnu/lib/libstdc++
     # make -f Makefile.bsd-wrapper cleandir
     # make -f Makefile.bsd-wrapper obj
     # make -f Makefile.bsd-wrapper
     # make -f Makefile.bsd-wrapper install
</pre>
	  <li>Build and install the system as usual:
<pre>
     # cd /usr/src && make build
</pre>
    </ul>
    <a name="3.6.2"></a>
    <h3>
     3.6.2: Switch to gcc3 (macppc) (2004/10/29)
    </h3>
    <p>
    OpenBSD/macppc has converted to gcc3.
    To upgrade,

<pre>
    # rm -rf /usr/include/g++
</pre>
    Now, <a href="#1.8">build gcc3</a>, (using the gcc3 directory) then
    build the kernel and system as <a href="#1.5">usual</a>.

    <a name="3.6.3"></a>
    <h3>
     3.6.3: bgpd behaviour change (2004/11/11)
    </h3>
    <p>
    The new <em>rde route-age [evaluate|ignore]</em> changed behaviour of bgpd.
    Until now <em>evaluate</em> was the implicit default but now the default is
    <em>ignore</em>.
    Route age evaluation is not specified in RFC 1771 and results in non
    deterministic decisions in preference for more stable links.

    <p>

<a name="3.6.4"></a>
<h3>3.6.4: New user and group _ftp (2004/11/24)</h3> 
The FTP daemon is being reworked to use privilege separation.
Thus a new user and group "_ftp" are required.
Add the user and group by running

<pre>
  useradd -u84 -g=uid -c"FTP Daemon" -d/var/empty -s/sbin/nologin _ftp
</pre>
as root.

    <a name="3.6.5"></a>
    <h3>
     3.6.5: Switch to gcc3 (i386) (2004/12/30)
    </h3>
    <p>
    OpenBSD/i386 has converted to gcc3.
    To upgrade,

<pre>
    # rm -rf /usr/include/g++
</pre>
    Now, <a href="#1.8">build gcc3</a>, (using the gcc3 directory) then
    build the kernel and system as <a href="#1.5">usual</a>.

<p>

<a name="3.6.6"></a>
<h3>3.6.6: New user and group _ospfd (2005/01/18)</h3> 
The upcoming ospf daemon needs its own user and group _ospfd.
Add them by running

<pre>
  useradd -u85 -g=uid -c"OSPF Daemon" -d/var/empty -s/sbin/nologin _ospfd
</pre>
as root.

<a name="3.6.7"></a>
<h3>3.6.7: pfsync takes syncdev instead of syncif</h3>
When configuring the
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4">pfsync</a>
device, use 'syncdev' instead of the deprecated keyword 'syncif'. 

<p>

<a name="3.6.8"></a>
<h3>3.6.8: POSIX hex and octal constants in (k)sh</h3>
Both
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sh&amp;sektion=1">sh(1)</a>
and
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ksh&amp;sektion=1">ksh(1)</a>
now interpret c-like hex (0x...) and octal (0...) constants in arithmetic
expressions.
As a consequence, the MAKEDEV script needs to be updated:
<pre>
     # cp /usr/src/etc/etc.`machine`/MAKEDEV /dev
</pre>

<p>

    <hr>
d21 1
a21 6
<small>$OpenBSD: upgrade-minifaq.html,v 1.237 2005/02/02 08:16:46 otto Exp $</small><br>
Copyright &copy; 1998-2004, OpenBSD.<br>
Comments about <i>this document</i> can be sent to
<a href="mailto:www@@openbsd.org">www@@openbsd.org</a>.
General questions about OpenBSD should be directed to the appropriate
<a href="../mail.html">mailing list</a>.
@


1.237
log
@don't forget section numbers
@
text
@d17 2
a18 4
      issues encountered when upgrading between OpenBSD releases,
      or from the releases to <em>-current</em>. Though hardly
      <em>Mini</em> anymore, this document retains the Mini-FAQ
      moniker for historical and/or consistency reasons.
d21 4
d93 1
a93 11
      <a href="#3.5.1">3.5.1: pty device minor numbers changed</a><br>
      <a href="#3.5.2">3.5.2: New user and group _dhcp</a><br>
      <a href="#3.5.3">3.5.3: New user and group _mopd</a><br>
      <a href="#3.5.4">3.5.4: New user and group _tftpd</a><br>
      <a href="#3.5.5">3.5.5: New user and group _rbootd</a><br>
      <a href="#3.5.6">3.5.6: cksum moves to /bin</a><br>
      <a href="#3.5.7">3.5.7: New user and group _afs</a><br>
      <a href="#3.5.8">3.5.8: New user and group _ppp</a><br>
      <a href="#3.5.9">3.5.9: New user and group _ntp</a><br>
      <a href="#3.5.10">3.5.10: Library bump flag day</a><br>
      <a href="#3.5.11">3.5.11: Changes in pf anchors</a><br>
d98 1
a98 40
      <a href="#3.4.1">3.4.1: svnd device minor numbers changed</a><br>
      <a href="#3.4.2">3.4.2: New user and group _pflogd</a><br>
      <a href="#3.4.3">3.4.3: Interface cloning</a><br>
      <a href="#3.4.4">3.4.4: New user and group _bgpd</a><br>
      <a href="#3.4.5">3.4.5: New version of join(1)</a><br>
      <a href="#3.4.6">3.4.6: sudo build change</a><br>
      <a href="#3.4.7">3.4.7: New user and group _tcpdump</a><br>
      <a href="#3.4.8">3.4.8: machdep.c change (i386)</a><br>
      <a href="#3.4.9">3.4.9: Update bsd.own.mk</a><br>
      <a href="#3.4.10">3.4.10: Switch to gcc3 (sparc64)</a><br>
    </p>
  
    <h2>Upgrading from 3.3 to 3.4</h2>

    <p>
      <a href="#3.3.1">3.3.1: i386 W^X support </a><br>
      <a href="#3.3.2">3.3.2: mquery syscall change</a><br>
      <a href="#3.3.3">3.3.3: i386 flag day, exe addr/MAXDSIZ change</a><br>
      <a href="#3.3.4">3.3.4: Removal of KerberosIV authentication</a><br>
      <a href="#3.3.5">3.3.5: config change</a><br>
      <a href="#3.3.6">3.3.6: Use __attribute__((bounded)) on certain
                functions</a><br>
      <a href="#3.3.7">3.3.7: New user and group _syslogd</a><br>
      <a href="#3.3.8">3.3.8: New format attribute __kprintf__ in kernel 
		headers</a><br>
    </p>
    
    <h2>Upgrading from 3.2 to 3.3</h2>
    
    <p>
      <a href="#3.2.1">3.2.1: New Perl</a><br>
      <a href="#3.2.2">3.2.2: New groups _radius, _token and _shadow</a><br>
      <a href="#3.2.3">3.2.3: Important compiler changes</a><br>
      <a href="#3.2.4">3.2.4: New user and group _spamd</a><br>
      <a href="#3.2.5">3.2.5: Alias for ipv6-icmp</a><br>
      <a href="#3.2.6">3.2.6: New group _lkm</a><br>
      <a href="#3.2.7">3.2.7: New libpthread</a><br>
      <a href="#3.2.8">3.2.8: Linker changes for ELF architectures </a><br>
      <a href="#3.2.9">3.2.9: Removal of /var/at and crontab changes </a><br>
    </p>
d102 1
a102 1
    <p>Information on upgrading from OpenBSD 2.3 to 3.1 
a692 785
<p>
    <a name="3.5"></a>
    <h2>
      Upgrading from 3.5 to 3.6
    </h2>

    <a name="3.5.1"></a>
    <h3>
      3.5.1: pty device minor numbers changed (2004/04/11)
    </h3>
    <p>
      The device minor numbers of
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pty&amp;sektion=4">pty</a>
      devices have changed to increase the maximum number of pseudo-terminals
      from 256 to 992, so you will need to run the updated
      <tt>/dev/MAKEDEV</tt> before booting the new kernel:
        <ul>
          <li>Update your source code tree
          <li>Build and install a new kernel
          <li>Build the rest of the system (<em>make build</em>)
          <li>Copy the new MAKEDEV script to the <tt>/dev</tt> directory and 
              create the new pty devices.
<pre>
     # cp /usr/src/etc/etc.`machine`/MAKEDEV /dev
     # cd /dev && ./MAKEDEV pty0
</pre>
          <li>Boot the new kernel
	  <li>Remove the old pty devices no longer in use:
<pre>
     # cd /dev && rm -f [pt]ty[rq]*
</pre>
	  <li> Or, for the vax platform:
<pre>
     # cd /dev && rm -f [pt]tyr*
</pre>
        </ul>

    <a name="3.5.2"></a>
    <h3>
      3.5.2: New user and group _dhcp (2004/04/12)
    </h3>
    <p>The various dhcp related daemons are being reworked to drop privileges
      or to use privilege separation. Thus a new user and group _dhcp are
      required.
      Add the group by running
<pre>
  # groupadd -g 77 _dhcp
</pre>
      as root, and add the user entry using
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>:
<pre>
  _dhcp:*:77:77::0:0:DHCP programs:/var/empty:/sbin/nologin
</pre>
    <p>

    <a name="3.5.3"></a>
    <h3>
      3.5.3: New user and group _mopd (2004/04/14)
    </h3>
    <p>The <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mopd&amp;sektion=8"
      >mopd(8)</a> daemon now drops privileges after initialization,
      and requires a new user and group _mopd.
      Add the group by running
<pre>
  # groupadd -g 78 _mopd
</pre>
      as root, and add the user entry using
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>:
<pre>
  _mopd:*:78:78::0:0:MOP Daemon:/var/empty:/sbin/nologin
</pre>
    <p>

    <a name="3.5.4"></a>
    <h3>
      3.5.4: New user and group _tftpd (2004/04/17)
    </h3>
    <p>The <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tftpd&amp;sektion=8"
      >tftpd(8)</a> daemon now drops privileges after initialization to
      a new user and group _tftpd instead of nobody.
      Add the group by running
<pre>
  # groupadd -g 79 _tftpd
</pre>
      as root, and add the user entry using
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>:
<pre>
  _tftpd:*:79:79::0:0:TFTP Daemon:/var/empty:/sbin/nologin
</pre>
    <p>

    <a name="3.5.5"></a>
    <h3>
      3.5.5: New user and group _rbootd (2004/04/30)
    </h3>
    <p>The <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rbootd&amp;sektion=8"
      >rbootd(8)</a> daemon now drops privileges after initialization to
      a new user and group _rbootd.
      Add the group by running
<pre>
  # groupadd -g 80 _rbootd
</pre>
      as root, and add the user entry using
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>:
<pre>
  _rbootd:*:80:80::0:0:rbootd Daemon:/var/empty:/sbin/nologin
</pre>
    <p>

    <a name="3.5.6"></a>
    <h3>
      3.5.6: cksum moves (2004/05/02)
    </h3>
    <p>The <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cksum&amp;sektion=1">cksum(1)</a> utility has moved from <tt>/usr/bin</tt> to <tt>/bin</tt>.
      After you have completed a <em>make build</em>, run the following as
      root:
<pre>
  # rm -f /usr/bin/cksum /usr/bin/sum
</pre>
    <p>

    <a name="3.5.7"></a>
    <h3>
      3.5.7: New user and group _afs (2004/05/06)
    </h3>
    <p>The <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=afsd&amp;sektion=8"
      >afsd(8)</a> daemon is about to be privilege separated. A new user
      and group _afs are required for this. Add the group by running
<pre>
  # groupadd -g 81 _afs
</pre>
      as root, and add the user entry using
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>:
<pre>
  _afs:*:81:81::0:0:afs Daemon:/var/empty:/sbin/nologin
</pre>
    <p>You need to change owner of the cache by running
<pre>
  # chown -R _afs:_afs /var/spool/afs
</pre>
    <p>

    <a name="3.5.8"></a>
    <h3>
      3.5.8: New user and group _ppp (2004/05/06)
    </h3>
    <p>The <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pppoe&amp;sektion=8"
      >pppoe(8)</a> program now drops privileges to a new user and group _ppp.
      Add the group by running
<pre>
  # groupadd -g 82 _ppp
</pre>
      as root, and add the user entry using
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>:
<pre>
  _ppp:*:82:82::0:0:PPP utilities:/var/empty:/sbin/nologin
</pre>
    <p>

    <a name="3.5.9"></a>
    <h3>
      3.5.9: New user and group _ntp (2004/05/30)
    </h3>
    <p>The upcoming
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ntpd&amp;sektion=8">ntpd(8)</a>
      program needs a new user and group _ntp.
      Add the group by running
<pre>
  # groupadd -g 83 _ntp
</pre>
      as root, and add the user entry using
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>:
<pre>
  _ntp:*:83:83::0:0:NTP Daemon:/var/empty:/sbin/nologin
</pre>
    <p>

    <a name="3.5.10"></a>
    <h3>
      3.5.10: Library bump flag day (2004/07/13)
    </h3>
    <p>Library and system interface changes have been made that require
	a bump of the major version number of every library.   The following
	steps must be followed to build a usable system.
	 <ul>
          <li>update your source code tree
          <li>Build a new kernel
	  <li>Install the new kernel and reboot
	  <li>install new header files:
<pre>
     # cd /usr/src && make obj && make cleandir && make includes
</pre>
	  <li>build and install a new version of libc
<pre>
     # cd /usr/src/lib/libc && make depend && make && env NOMAN=1 make install
</pre>
	  <li>Build and install the system as usual
<pre>
     # cd /usr/src && make build
</pre>
	 </ul>
    <p>

    <a name="3.5.11"></a>
    <h3>
      3.5.11: Changes in pf anchors (2004/08/07)
    </h3>
    <p>Users of authpf should change their anchor rule in the main
	ruleset from
<pre>
     anchor authpf
</pre>
	to
<pre>
     anchor "authpf/*"
</pre>
    <p>

    <a name="3.4"></a>
    <h2>
      Upgrading from 3.4 to 3.5
    </h2>

    <a name="3.4.1"></a>
    <h3>
      3.4.1: svnd device minor numbers changed (2003/10/10)
    </h3>
    <p>
      The device minor numbers of 
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=svnd&amp;sektion=4">svnd</a>
      devices have changed, so you will need to run the updated
      <tt>/dev/MAKEDEV</tt> after installing the new kernel:
        <ul>
          <li>update your source code tree
          <li>Build a new kernel
          <li>copy the new MAKEDEV script to the dev directory, remove
              the existing svnd(4) and rsvnd devices, and create new ones:
<pre>
     # cp /usr/src/etc/etc.`machine`/MAKEDEV /dev
     # cd /dev
     # rm svnd* rsvnd*
     # ./MAKEDEV vnd
</pre>
          <li>Continue with build and release process
        </ul>

      This affects anyone using svnd devices, which includes those who
      <tt>make release</tt>.
    <p>

    <a name="3.4.2"></a>
    <h3>
      3.4.2: New user and group _pflogd (2003/10/23)
    </h3>
    <p>The <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pflogd&amp;sektion=8"
      >pflogd(8)</a> daemon now runs in privilege separated mode, and requires a new
      user and group _pflogd.
      Add the group by running
<pre>
  # groupadd -g 74 _pflogd
</pre>
      as root, and add the user entry using
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>:
<pre>
  _pflogd:*:74:74::0:0:pflogd privsep:/var/empty:/sbin/nologin
</pre>
    <p>

    <a name="3.4.3"></a>
    <h3>
      3.4.3: Interface cloning (2003/12/07)
    </h3>
    <p>Several pseudo network drivers (like
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=gif&amp;sektion=4">gif(4)</a>,
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=lo&amp;sektion=4">lo(4)</a>, and
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tun&amp;sektion=4">tun(4)</a>)
      have been moved to support cloning, i.e. creation and destruction of
      devices on the fly. If you depend on these interfaces, you have to
      install an updated
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8">ifconfig(8)</a>
      and
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=netstart&amp;sektion=8">netstart(8)</a>
      before rebooting your new kernel.

    <p>First build and install your new kernel as usual, then
      <pre>
  # cd /usr/src && make includes
  # cd sbin/ifconfig
  # make obj depend
  # make
  # make install
  # cp /usr/src/etc/netstart /etc
      </pre>
      Now reboot your machine and proceed with building a new userland.
    <p>

    <a name="3.4.4"></a>
    <h3>
       3.4.4: New user and group _bgpd (2003/12/17)
    </h3>
    <p>The new <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bgpd&amp;sektion=8"
      >bgpd(8)</a> daemon runs in privilege separated mode, and requires a new
      user and group _bgpd.
      Add the group by running
<pre>
  # groupadd -g 75 _bgpd
</pre>
      as root, and add the user entry using
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>:
<pre>
  _bgpd:*:75:75::0:0:BGP Daemon:/var/empty:/sbin/nologin
</pre>
    <p>

    <a name="3.4.5"></a>
    <h3>
	3.4.5: New version of join(1) (2003/12/28)
    </h3>
    <p>The
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=join&amp;sektion=1">join(1)</a>
    command has been updated to follow the POSIX standard when writing
    non-matching lines.
    As a consequence
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=security&amp;sektion=8">security(8)</a>
    has to be updated:
     <pre>
  # cp /usr/src/etc/security /etc
     </pre>
    <p>

    <a name="3.4.6"></a>
    <h3>
	3.4.6: sudo build change (2004/01/15)
    </h3>
    <p>The way the
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sudo&amp;sektion=8">sudo(8)</a>
    command is built has changed.  A side-effect of this is that you will
    need to run:
     <pre>
  # rm -f /usr/obj/usr.bin/sudo/*
     </pre>
    before you can successfully do a "make build".  If this is not done,
    the build will abort when attempting to make obj dirs.
    <p>

    <a name="3.4.7"></a>
    <h3>
      3.4.7: New user and group _tcpdump (2004/01/19)
    </h3>
    <p>The <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tcpdump&amp;sektion=8"
      >tcpdump(8)</a> command now runs in privilege separated mode, and requires a new
      user and group _tcpdump.
      Add the group by running
<pre>
  # groupadd -g 76 _tcpdump
</pre>
      as root, and add the user entry using
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>:
<pre>
  _tcpdump:*:76:76::0:0:tcpdump:/var/empty:/sbin/nologin
</pre>

    <p>
    <a name="3.4.8"></a>
    <h3>
      3.4.8: machdep.c change (i386) (2004/02/01)
    </h3>

    <p>
    A change to <tt>machdep.c</tt> requires that binutils be rebuilt
    before the kernel can be compiled.
    This only affects i386.

<pre>
  # cd /usr/src/gnu/usr.bin/binutils
  # make -f Makefile.bsd-wrapper cleandir
  # make -f Makefile.bsd-wrapper obj
  # make -f Makefile.bsd-wrapper depend
  # make -f Makefile.bsd-wrapper
  # make -f Makefile.bsd-wrapper install
</pre>

    <p> Now you can rebuild the kernel and rest of the system according
    to section <a href="#1.5">1.5</a>

    <p>
    <a name="3.4.9"></a>
    <h3>
      3.4.9: Update bsd.own.mk (2004/02/20)
    </h3>

    <p>
    You must update <tt>/usr/share/mk/bsd.own.mk</tt> to get the USE_GCC3
    definition:

<pre>
    # cd /usr/src/share/mk
    # make install
</pre>

    <p>
    <a name="3.4.10"></a>
    <h3>
      3.4.10: Switch to gcc3 (sparc64) (2004/02/20)
    </h3>

    <p>
    OpenBSD/sparc64 has converted to gcc3.
    To upgrade,

<pre>
    # rm -rf /usr/include/g++
</pre>
    Now, <a href="#1.8">build gcc3</a>, (using the gcc3 directory) then
    build the kernel and system as <a href="#1.5">usual</a>.


    <a name="3.3"></a>
    <h2>
      Upgrading from 3.3 to 3.4
    </h2>
    
    <a name="3.3.1"></a>
    <h3>
      3.3.1: i386 W^X support (2003/04/16)
    </h3>

    <p>To enable i386 Writable xor eXecute support, OpenBSD/i386 has
      changed from a.out executable format to ELF. The flexibility of 
      ELF allows better control over the executable layout which
      allows for W^X support. a.out compatibility is only available in a
      limited form. Static a.out binaries will work as before, dynamic
      a.out binaries ARE NOT SUPPORTED.
    </p>
    <p>SOURCE UPGRADES FROM a.out -&gt; ELF WILL NOT BE SUPPORTED.
      INSTALL A SNAPSHOT and then you can rebuild from source.
      This is i386-only, other architectures are NOT affected by this change.
    </p>

    <a name="3.3.2"></a>
    <h3>
      3.3.2: mquery syscall change (2003/04/28)
    </h3>

    <p>The parameters to the mquery system call were changed to match mmap().
      This requires the system to be upgraded in the correct order:

      <pre>
      1. Build and boot new kernel.
      2. (cd /usr/src && sudo make includes)
      3. (cd /usr/src/libexec/ld.so && make && sudo make install)
      4. 'make build'
      </pre>

      Only i386 uses mquery, so other architectures do not need to
      follow this strict build order.

    <a name="3.3.3"></a>
    <h3>
      3.3.3: i386 flag day, exe addr/MAXDSIZ change (2003/05/05)
    </h3>

    <p>To allow MAXDSIZ to be changed back to 1G, the base
      address of all executables changes from 0 to 0x1c000000. The
      combination of these changes requires updating from snapshot.
      Updating from source is not supported.  This only affects i386.
    </p>
    
    <a name="3.3.4"></a>
    <h3>
      3.3.4: Removal of KerberosIV authentication (2003/05/13)
    </h3>

    <p>KerberosIV-based authentication has been removed. As a result, 
       you will need to remove all references to <tt>krb4</tt> in
       <tt>/etc/login.conf</tt>. 
    </p>

    <a name="3.3.5"></a>
    <h3>
      3.3.5: <tt>config</tt> change (2003/05/23)
    </h3>

    <p>Moving swapgeneric.c required a change to 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8">config(8)</a>.
      Before building a new kernel, you must first build and install
      the updated config(8):
<pre>
  # cd /usr/src/usr.sbin/config
  # make clean
  # make obj
  # make
  # make install
</pre>
      Now, <tt>config</tt> your kernel configuration and run 
      "<tt>make depend</tt>" in your kernel compile directory as detailed
      <a href="#1.5">above</a>. 

   <a name="3.3.6"></a>
   <h3>
    3.3.6: Use __attribute__((bounded)) on certain functions (2003/06/26)
   </h3>
      
   <p>
     __attribute__((bounded)) is now used to detect incorrect arguments
     for functions which take buffer lengths as one of their parameters.
     <br><br>You will need to rebuild gcc according to section
     <a href="#1.8">1.8</a>
     of the Mini-FAQ before proceeding with <tt>make build</tt>.
   </p>

    <a name="3.3.7"></a>
    <h3>
      3.3.7: New user and group _syslogd (2003/07/31)
    </h3>
    <p>The <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=syslogd&amp;sektion=8"
      >syslogd(8)</a> daemon now runs in privilege separated mode, and requires a new
      user and group _syslogd.
      Add the group by running
<pre>
  # groupadd -g 73 _syslogd
</pre>
      as root, and add the user entry using
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>:
<pre>
  _syslogd:*:73:73::0:0:Syslog Daemon:/var/empty:/sbin/nologin
</pre>
    <p>

    <a name="3.3.8"></a>
    <h3>
      3.3.8: Use format attribute __kprintf__ in kernel headers (2003/08/23)
    </h3>
    <p>
      A new format attribute __kprintf__ is now used in kernel header files to 
      make gcc aware of the format extensions in the kernel
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=printf&amp;sektion=9">printf(9)</a>.
      <br><br>You will need to rebuild gcc according to section <a href="#1.8">1.8</a>
     of the Mini-FAQ before proceeding with <tt>make build</tt>. You only need to rebuild
     gcc once from current sources to also support the __bounded__ attribute described
     in section <a href="#3.3.6">3.3.6</a>.
    </p>

    <a name="3.2"></a>
    <h2>
      Upgrading from 3.2 to 3.3
    </h2>

    <a name="3.2.1"></a>
    <h3>
      3.2.1: New Perl (2002/11/05)
    </h3>

    <p>Perl has been updated to version 5.8.0.<br>
      In Perl 5.8.0, the XS module API has changed due to a switch
      from stdio to PerlIO (see the perldelta manual page for more information).
      This means that any XS modules (perl .so files) you have installed
      <strong>must</strong> be rebuilt.  If you encounter an error such as
      <em>Undefined symbol "perl_get_sv"</em> this is your problem.  If the
      only modules you have installed were installed as packages or via the
      ports system, you can check your system for XS modules by running:
      <pre>
	# grep '\.so' /var/db/pkg/p5-*/+CONTENTS | cut -d: -f1 | sort -u
      </pre>
      You can then remove the offending modules with <em>pkg_delete -f</em>
      and rebuild/install them from the ports tree.

    <a name="3.2.2"></a>
    <h3>
      3.2.2: New groups _radius, _token and _shadow (2002/11/21)
    </h3>
    <p>Several new groups have been added:
      <ul>
      <li>The <em>_radius</em> group controls read-only access to
	  <tt>/etc/raddb/servers</tt> file.
      <li>The <em>_token</em> group controls read-only access to the
	  token databases used by 
	  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tokeninit&amp;sektion=8">tokeninit(8)</a>,
	  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tokenadm&amp;sektion=8">tokenadm(8)</a>, and
	  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=login_token&amp;sektion=8">login_token(8)</a>.
      <li>The <em>_shadow</em> group controls read-only access to
	  the shadow password database.
      </ul>

      You will need to add these groups and adjust the permissions on
      some files before running a &quot;make build&quot;.  The following
      commands, run as root, will do this:
	<pre>
	  # groupadd -g 63 _radius
	  # chgrp _radius /etc/raddb /etc/raddb/servers
	  # chmod g+x /etc/raddb
	  # chmod g+r /etc/raddb/servers

	  # groupadd -g 64 _token
	  # chgrp _token /etc/activ.db /etc/crypto.db /etc/snk.db
	  # chmod 0640 /etc/activ.db /etc/crypto.db /etc/snk.db

	  # groupadd -g 65 _shadow
	  # chgrp _shadow /etc/spwd.db
	  # chmod 0640 /etc/spwd.db
	</pre>

      Don't worry about error messages indicating that a file was not found.
      That just means you haven't setup <em>token</em> or <em>radius</em> authentication.

    <a name="3.2.3"></a>
    <h3>
      3.2.3: Important compiler changes (2002/12/02)
    </h3>
    <p>The <a href="http://www.trl.ibm.com/projects/security/ssp">propolice</a>
      stack protection extension has been merged into
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=gcc-local&amp;sektion=1"
      >gcc</a>. This requires a slightly different upgrade scenario:
      <ul>
      <li>Do <b>not</b> build a new kernel yet.
      <li>Do <b>not</b> rebuild gcc yet.
      <li>Build and install a new ld.so dynamic loader if your system has
        shared libraries.
        <pre>
	  # cd /usr/src
	  # make obj
          For ELF platforms (alpha, macppc, sparc, sparc64):
          # cd /usr/src/libexec/ld.so
          # make depend &amp;&amp; make &amp;&amp; make install
	  For a.out platforms (amiga, hp300, i386, mac68k, mvme68k):
          # cd /usr/src/gnu/usr.bin/ld/rtld
          # make depend &amp;&amp; make &amp;&amp; make install
	</pre>
      <li>Rebuild and install a new libc, following the first few commands
        from <i>make build</i>.
	<pre>
          # cd /usr/src/include
	  # make prereq &amp;&amp; make includes
	  # cd /usr/src/lib/libc
	  # make depend &amp;&amp; make NOMAN=1 &amp;&amp; make NOMAN=1 install
	</pre>
	Note that, if your compiler is too old, it will not be able to build
	libc. In this case, you'll have to do a binary upgrade from a snapshot.
      <li>Rebuild and install gcc, as told in section <a href="#1.8">1.8</a>.
      <li>You can now recompile a kernel.
        Be sure to run
        <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8"
	>config</a> again to regenerate the kernel Makefile.
      <li>Reboot on the new kernel, and run a <i>make build</i> to
        benefit from the stack protection.
      </ul>

    <a name="3.2.4"></a>
    <h3>
      3.2.4: New user and group _spamd (2002/12/24)
    </h3>
    <p>A new user and a new group _spamd for the
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=spamd&amp;sektion=8"
      >spamd(8)</a> daemon have been added.
      Add the group by running
<pre>
  # groupadd -g 62 _spamd
</pre>
      as root, and add the user entry using
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>:
<pre>
  _spamd:*:62:62::0:0:Spam daemon:/var/empty:/sbin/nologin
</pre>

    <a name="3.2.5"></a>
    <h3>
      3.2.5: Alias for ipv6-icmp (2002/12/30)
    </h3>

    <p>A new alias for ipv6-icmp, <em>icmp6</em> , has been added to
      <tt>/etc/protocols</tt>.  If you wish to use the <em>icmp6</em> alias
      (used in the
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8">pfctl(8)</a>
      regression tests) you must modify the <em>ipv6-icmp</em> line in
      <tt>/etc/protocols</tt>, adding the <em>icmp6</em> keyword before the #.
      The line should read as follows:
    </p>
<pre>
  ipv6-icmp 58    IPv6-ICMP icmp6 # ICMP for IPv6
</pre>

    <a name="3.2.6"></a>
    <h3>
      3.2.6: New group _lkm (2003/01/05)
    </h3>

    <p>The <em>_lkm</em> group controls access to
	  <tt>/dev/lkm</tt>.
	  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=modstat&amp;sektion=8">modstat(8)</a>
          is now setgid _lkm.
    <p>
      You will need to add this group and adjust the permissions on
      <tt>/dev/lkm</tt> before running a &quot;make build&quot;.  The following
      commands, run as root, will do this:
<pre>
  # groupadd -g 61 _lkm
  # chgrp _lkm /dev/lkm
</pre>

    <a name="3.2.7"></a>
    <h3>
      3.2.7: New libpthread (2003/01/14)
    </h3>

    <p><em>libc_r</em> and <em>libnpthread</em> have been removed and
    replaced by <em>libpthread</em>.  Threaded programs should still
    be compiled using the <em>-pthread</em> option; the compiler does
    the right thing.

    <p>Before removing <em>libc_r</em> and <em>libnpthread</em> threaded
    applications must be re-compiled using <em>libpthread</em>.  The
    recommended build sequence is:

    <ol>
      <li>
        <p>build gcc according to section <a href="#1.8">1.8</a>.
      <li>
        <p>re-build the system according to section <a href="#1.5">1.5</a>.
      <li>
        <p>re-build all threaded ports.
      <li>
        <p>remove the now unused libraries:
<pre>
  # rm /usr/lib/libc_r* /usr/lib/libnpthread*
</pre>
    </ol>

    <a name="3.2.8"></a>
    <h3>
      3.2.8: Linker changes for ELF architectures (2003/01/17)
    </h3>

    <p>Binutils/ld have been changed to introduce a new security feature to ELF
    executables. Instead of allowing the data section of executables and
    shared libraries to be marked executable by the linker, the layout has
    been changed to only mark the appropriate sections of the program image
    as executable. This change only affects ELF based architectures: alpha,
    sparc, sparc64, macppc.
    <p>
    It is recommended that binutils be rebuilt before the rest of the system.
    <p>
<pre>
  # cd /usr/src/gnu/usr.bin/binutils
  # make -f Makefile.bsd-wrapper cleandir
  # make -f Makefile.bsd-wrapper obj
  # make -f Makefile.bsd-wrapper depend
  # make -f Makefile.bsd-wrapper
  # make -f Makefile.bsd-wrapper install
</pre>
    <p>
    Then re-build the system according to section <a href="#1.5">1.5</a>

    <a name="3.2.9"></a>
    <h3>
      3.2.9: Removal of /var/at and crontab changes (2003/02/19)
    </h3>

    <p>The contents of <tt>/var/at</tt> have been merged into <tt>/var/cron</tt>
    now that <em>at</em> has been integrated into <em>cron</em>.  Furthermore,
    the <em>cron</em> allow and deny files have been renamed cron.allow and
    cron.deny for POSIX compliance and consistency with at.allow and at.deny.
    <p>
    First re-build the system according to section <a href="#1.5">1.5</a>
    Then move the existing files and restart cron as follows:
    <p>
<pre>
  # mv /var/at/* /var/cron
  # mv /var/cron/jobs /var/cron/atjobs
  # mv /var/cron/allow /var/cron/cron.allow
  # mv /var/cron/deny /var/cron/cron.deny
  # rm -rf /var/at 
  # kill `cat /var/run/cron.pid`
  # /usr/sbin/cron
</pre>
    <p>
    Disregard any warnings about missing allow or deny files.
    Not all of them are part of the default installation.
    <p>
    If you do not already have a cron.deny file (it was not installed
    prior to OpenBSD 3.3) you will need one to run <em>crontab</em> as
    a user other than the superuser.
<pre>
  # install -c -o root -g crontab -m 660 /dev/null /var/cron/cron.deny
</pre>

d696 1
a696 1
<small>$OpenBSD: upgrade-minifaq.html,v 1.236 2005/02/02 07:56:38 otto Exp $</small><br>
@


1.236
log
@update MAKEDEV now that we have POSIX octal and hex constants in the shell
@
text
@d728 1
a728 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sh&amp;sektion=1">sh</a>
d730 1
a730 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ksh&amp;sektion=1">ksh</a>
d1528 1
a1528 1
<small>$OpenBSD: upgrade-minifaq.html,v 1.235 2005/01/24 06:08:34 mcbride Exp $</small><br>
@


1.235
log
@Document change of syncif to syncdev, prodded by henning@@
@
text
@d86 1
d725 15
d1528 1
a1528 1
<small>$OpenBSD: upgrade-minifaq.html,v 1.234 2005/01/18 21:45:06 henning Exp $</small><br>
@


1.234
log
@_ospfd:_ospfd
@
text
@d85 1
d716 8
d1512 1
a1512 1
<small>$OpenBSD: upgrade-minifaq.html,v 1.233 2005/01/11 02:30:28 nick Exp $</small><br>
@


1.233
log
@
/usr/obj isn't an option.
@
text
@d84 1
d705 4
d710 6
d1503 1
a1503 1
<small>$OpenBSD: upgrade-minifaq.html,v 1.232 2004/12/31 06:01:38 david Exp $</small><br>
@


1.232
log
@gcc 3.3.5; ok espie@@
@
text
@d273 1
a273 4
        <p>Clean out the old object files.</p>
	
        <p>If you created a separate /usr/obj directory, clean
	  that, and rebuild the symbolic links:</p>
d1492 1
a1492 1
<small>$OpenBSD: upgrade-minifaq.html,v 1.231 2004/12/30 21:57:47 pvalchev Exp $</small><br>
@


1.231
log
@i386/gcc3 switch instructions
WARNING: this is a flag day for ports and many things. use snapshots and
special care if you do things by hand
@
text
@d408 1
a408 1
      most platforms, but also gcc v3.3.2 used by a few platforms which
d431 1
a431 1
  <b>If your platform uses gcc 3.3.2:</b>
d435 1
a435 1
  <b>Common build procedure for v3.3.2 or v2.95.3</b>
d1495 1
a1495 1
<small>$OpenBSD: upgrade-minifaq.html,v 1.230 2004/12/21 16:50:10 nick Exp $</small><br>
@


1.230
log
@
pr4045: bad tag.
@
text
@d83 1
d690 15
d1495 1
a1495 1
<small>$OpenBSD: upgrade-minifaq.html,v 1.229 2004/12/15 08:58:44 otto Exp $</small><br>
@


1.229
log
@remove ref to non-existent section. ok nick@@
@
text
@d565 1
a565 1
      Pay special attention to the advice to <a href="1.15">install
d1479 1
a1479 1
<small>$OpenBSD: upgrade-minifaq.html,v 1.228 2004/11/24 19:24:59 nick Exp $</small><br>
@


1.228
log
@
Add user/group _ftp, at request of (and ok) Henning@@.
@
text
@a58 3
      <a href="#1.10">1.10: How do I clean all the cruft out of my
	existing source tree?</a><br>
      
d1479 1
a1479 1
<small>$OpenBSD: upgrade-minifaq.html,v 1.227 2004/11/23 16:35:57 ian Exp $</small><br>
@


1.227
log
@spelling
@
text
@d85 1
d682 13
d1482 1
a1482 1
<small>$OpenBSD: upgrade-minifaq.html,v 1.226 2004/11/12 13:45:10 claudio Exp $</small><br>
@


1.226
log
@document bgpd behaviour change, prodded by henning.
OK henning@@ nick@@
@
text
@d567 1
a567 1
      Pay speciall attention to the advice to <a href="1.15">install
d1468 1
a1468 1
<small>$OpenBSD: upgrade-minifaq.html,v 1.225 2004/11/10 05:13:44 nick Exp $</small><br>
@


1.225
log
@
use snapshots, dammit.  If you gotta ask many questions, you don't belong
doing it by source.  If you DON'T have to ask the questions, you probably
know not to do it by source anyway.  Kick from deraadt@@,
(yes, I know, section numbers are skipping things at the moment. You'll
live.  I got more work to do here).
@
text
@d84 1
d668 11
d1468 1
a1468 1
<small>$OpenBSD: upgrade-minifaq.html,v 1.224 2004/10/29 21:04:35 pvalchev Exp $</small><br>
@


1.224
log
@OpenBSD/macppc is gcc3 now
@
text
@a49 3
      <a href="#1.6">1.6: My make build stopped halfway. Do I have
	to redo the whole thing?</a><br>
      
d219 2
d222 2
a223 1
      <a href="#1.4">fetched</a> and <a href="#1.5">built</a>. This
d257 1
a257 1
      For example, to retrieve 3.2-stable, use</p>
d260 1
a260 1
  # cvs -q get -rOPENBSD_3_2 -P src
d311 2
a312 2
	  example, 2.3 users must add the <em>named</em> user and
	  group before moving to 2.4 or later. See the specific
d341 1
a341 1
	  cases, it's usually best to start with GENERIC and trim
d350 1
a393 33
    <a name="1.6"></a> 
    <h3>1.6: My make build stopped halfway. Do I have to redo the
      whole thing?</h3>

    <p>I would, but if you really want to pick up where you left
      off, do a:</p>
<pre>
  # cd /usr/src
  # make -n build
</pre>

    <p>This will show you what make build is doing. For example,
      mine tells me:</p>
<pre>
  (cd /usr/src/share/mk &amp;&amp;  make install)
  (cd /usr/src/include; make prereq;  make includes)
  make cleandir
  (cd /usr/src/lib &amp;&amp; make depend &amp;&amp; make &amp;&amp;   make install)
  (cd /usr/src/gnu/lib &amp;&amp; make depend &amp;&amp; make &amp;&amp;   make install)
  (cd /usr/src/kerberosIV/lib &amp;&amp; make depend &amp;&amp; make &amp;&amp;   make install)
  (cd /usr/src/gnu/usr.bin/perl &amp;&amp;  make -f Makefile.bsd-wrapper config.sh &amp;&amp;  make -f Makefile.bsd-wrapper depend &amp;&amp;  make -f Makefile.bsd-wrapper perl.lib &amp;&amp;
  make -f Makefile.bsd-wrapper install.lib)
  make depend &amp;&amp; make &amp;&amp;  make install
</pre>

    <p>To pick up where you left off, just reissue the commands
      from the point where the compile died.</p>
    
    <p>If you do this procedure a lot, you may want to create a new
      target in your makefile. Simply copy the entry for
      <em>build</em> (to <em>build-noclean</em>, for example), and
      remove the <em>make cleandir</em> reference.</p>

a396 26
    
    <p>If your <em>make build</em> ends with an error, chances are
      it is because you failed to delete your old objects before
      rebuilding. See <a href="#1.5">1.5</a> for details on cleaning
      out these objects.</p>

    <p>If you are sure your tree is clean of old object cruft, and
      you are still receiving a build error, one of three things has
      probably happened:</p>
    
    <ol>
      <li>You have encountered a known upgrade issue. Make sure you
	have read the appropriate section of this document, and
	followed the instructions there carefully.</li>
      
      <li>You have encountered a new upgrade issue. This is life on
	the bleeding edge. Search recent postings to 
	<a href="../mail.html">misc@@ and tech@@</a> for possible
	workarounds.</li>
      
      <li>Someone has temporarily broken the source tree. This type
	of break is pretty rare, and is usually fixed immediately.
	Try waiting a few hours, and re-fetching the source tree. If
	you can't wait, try fetching a tree from a day or two
	beforehand.</li>
    </ol>
d398 1
a398 4
    <p>If you have tried all of the alternatives above, and your
      problem persists for more than a couple of days, post your
      problem to misc@@openbsd.org. Make sure to include the relevant
      error messages, and any peculiarities of your setup.</p>
d405 2
d477 1
a477 1
      between 3.1 and 3.2, do a:</p>
d481 1
a481 1
  # cvs diff -u -rOPENBSD_3_1 -rOPENBSD_3_2
a508 22

    <a name="1.10"></a> 
    <h3>1.10: How do I clean all the cruft out of my existing
      source tree?</h3>
    
    <p>The most important thing you can do is to clean out your obj
      directories. Here's a procedure to update source and kill any
      leftover objects:</p>

<pre>
  # cd /usr/src
  # cvs -q -d anoncvs@@some.anon.server:/cvs up -Pd
  # find . -type l -name obj | xargs rm
  # make -k cleandir
  # rm -rf /usr/obj/*
  # make obj
</pre>

    <p>If you're still having trouble, you may want to try adding
      <tt>-I ! -I CVS -I obj</tt> to your CVS updates. This will
      identify any extra cruft in your source tree.</p>

d513 1
a513 16
    <p>Though certain steps of the make build process require root
      privileges, the build process includes hooks to the 
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sudo&amp;sektion=8"
	 >sudo(8)</a> command that make this process relatively
      painless.</p>

    <p>If your <tt>/etc/sudoers</tt> file is configured correctly,
      you can use the sudo hooks in the following manner:</p>
    
    <ul>
      <li>Place SUDO=/usr/bin/sudo in your environment prior to
	starting the build, or</li>

      <li>Add the line "SUDO=/usr/bin/sudo" to your
	<tt>/etc/mk.conf</tt> file.</li>
    </ul>
d566 2
d575 2
a576 2
      Installing snapshot is a good way to keep up to date.
      We want you to test snapshots, especially at beta-time,
d582 2
a583 1
      The easiest way to get <em>-current</em> is to grab a boot image
d587 4
a590 1
    </p>
d1456 1
a1456 1
<small>$OpenBSD: upgrade-minifaq.html,v 1.223 2004/10/29 17:27:28 nick Exp $</small><br>
@


1.223
log
@
update for 3.6
@
text
@d86 1
d743 14
d1546 1
a1546 1
<small>$OpenBSD: upgrade-minifaq.html,v 1.222 2004/10/27 17:59:42 kettenis Exp $</small><br>
@


1.222
log
@Mention gcc3 exception handling flag day.
style ok nick@@
@
text
@d13 1
a13 1
    <h2>Latest OpenBSD Release - 3.5</h2>
d1531 1
a1531 1
<small>$OpenBSD: upgrade-minifaq.html,v 1.221 2004/10/24 14:43:35 nick Exp $</small><br>
@


1.221
log
@
missing period, "mail list" -> "mailing list".  PR3964
@
text
@d81 6
d88 1
a88 1
    <h2>Upgrading from 3.5 to <i>-current</i></h2>
d702 42
d746 1
a746 1
      Upgrading from 3.5 to <i>-current</i>
d1531 1
a1531 1
<small>$OpenBSD: upgrade-minifaq.html,v 1.220 2004/10/12 16:41:01 nick Exp $</small><br>
@


1.220
log
@
Per Kjell's request/permission, remove his name and e-mail as copyright
and contact, change to www@@openbsd.org.
ALSO: fix linko, pointed out by (christophe dot plasschaert at wanadoo,fr)
@
text
@d1483 1
a1483 1
<small>$OpenBSD: upgrade-minifaq.html,v 1.219 2004/09/28 13:41:45 nick Exp $</small><br>
d1486 1
a1486 1
<a href="mailto:www@@openbsd.org">www@@openbsd.org</a>
d1488 1
a1488 1
<a href="../mail.html">mail list</a>.
@


1.219
log
@
"dhcp programs" -> "DHCP programs" to match what is installed by 3.6
@
text
@a14 8
    <address>
      <p>Kjell Wooding 
	&lt;<a href="mailto:kjell@@openbsd.com">kjell@@openbsd.org</a>&gt;<br>
	Updated: 
	$OpenBSD: upgrade-minifaq.html,v 1.218 2004/08/07 13:15:07 dhartmei Exp $</p>
    </address>
    <br>
    
d1235 1
a1235 1
     in section <a href="#3.3.5">3.3.5</a>.
d1482 9
a1490 8
    <address>
      <p>
	<small>$OpenBSD: upgrade-minifaq.html,v 1.218 2004/08/07 13:15:07 dhartmei Exp $</small><br>
	Copyright &copy; 1998-2004, Kjell Wooding.<br>
	Please send any comments, questions, or suggestions to <a
          href="mailto:kjell@@openbsd.org">kjell@@openbsd.org</a></p>
    </address>
  </body>
@


1.218
log
@even needs quotes "authpf/*", ugly
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.217 2004/08/07 13:10:42 dhartmei Exp $</p>
d754 1
a754 1
  _dhcp:*:77:77::0:0:dhcp programs:/var/empty:/sbin/nologin
d1492 1
a1492 1
	<small>$OpenBSD: upgrade-minifaq.html,v 1.217 2004/08/07 13:10:42 dhartmei Exp $</small><br>
@


1.217
log
@Mention changes in pf anchors for -current authpf users, use
'anchor authpf/*' instead of 'anchor authpf', or the user rulesets
won't be evaluated at all.
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.216 2004/07/14 06:45:30 otto Exp $</p>
d917 1
a917 1
     anchor authpf/*
d1492 1
a1492 1
	<small>$OpenBSD: upgrade-minifaq.html,v 1.216 2004/07/14 06:45:30 otto Exp $</small><br>
@


1.216
log
@fix section num
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.215 2004/07/13 22:17:54 millert Exp $</p>
d102 1
d906 15
d1492 1
a1492 1
	<small>$OpenBSD: upgrade-minifaq.html,v 1.215 2004/07/13 22:17:54 millert Exp $</small><br>
@


1.215
log
@remove unneeded sudo in example and don't assume sh/ksh
also add "cleandir" to the steps just in case...
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.214 2004/07/13 21:44:56 marc Exp $</p>
d881 1
a881 1
      3.5.9: Library bump flag day (2004/07/13)
d1476 1
a1476 1
	<small>$OpenBSD: upgrade-minifaq.html,v 1.214 2004/07/13 21:44:56 marc Exp $</small><br>
@


1.214
log
@special build procedure for lib bump, OK millert@@
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.213 2004/06/08 08:02:16 jmc Exp $</p>
d892 1
a892 1
     # cd /usr/src && make obj && make includes
d896 1
a896 1
     # cd /usr/src/lib/libc && make depend && make && NOMAN=1 sudo make install
d1476 1
a1476 1
	<small>$OpenBSD: upgrade-minifaq.html,v 1.213 2004/06/08 08:02:16 jmc Exp $</small><br>
@


1.213
log
@typo from ray (PR #3812);
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.212 2004/06/01 09:46:18 henning Exp $</p>
d101 1
d879 26
d1476 1
a1476 1
	<small>$OpenBSD: upgrade-minifaq.html,v 1.212 2004/06/01 09:46:18 henning Exp $</small><br>
@


1.212
log
@need to chown afs cache; From: Gabriel Kihlman <gk@@stacken.kth.se>
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.211 2004/05/30 17:03:38 henning Exp $</p>
d827 1
a827 1
      >afsd(8)</a> daemon is about to be privilege seperated. A new user
d1449 1
a1449 1
	<small>$OpenBSD: upgrade-minifaq.html,v 1.211 2004/05/30 17:03:38 henning Exp $</small><br>
@


1.211
log
@hello _ntp
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.210 2004/05/07 13:20:11 henning Exp $</p>
d837 4
d1449 1
a1449 1
	<small>$OpenBSD: upgrade-minifaq.html,v 1.210 2004/05/07 13:20:11 henning Exp $</small><br>
@


1.210
log
@_afs and _ppp, nick
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.209 2004/05/06 22:08:54 nick Exp $</p>
d100 1
d856 18
d1445 1
a1445 1
	<small>$OpenBSD: upgrade-minifaq.html,v 1.209 2004/05/06 22:08:54 nick Exp $</small><br>
@


1.209
log
@
Upgrades by binary: It's not just for -current any more...
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.208 2004/05/04 16:39:48 millert Exp $</p>
d98 2
d821 34
d1426 1
a1426 1
	<small>$OpenBSD: upgrade-minifaq.html,v 1.208 2004/05/04 16:39:48 millert Exp $</small><br>
@


1.208
log
@rm /usr/bin/sum link in cksum update; RD Thrush
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.207 2004/05/02 18:02:49 millert Exp $</p>
d48 1
a48 2
      <a href="#1.2">1.2: What is the easiest way to upgrade to
	<em>-current</em>?</a><br>
d208 1
a208 2
    <h3>1.2: What is the best way to upgrade to
      <em>-current</em>?</h3>
d210 2
a211 2
    <p>Due to changes in the underlying libraries, moving directly
      from a release to <i>-current</i> is rarely easy.
d215 4
a218 1
      Once the snapshot is installed, the latest source can be 
d1390 1
a1390 1
	<small>$OpenBSD: upgrade-minifaq.html,v 1.207 2004/05/02 18:02:49 millert Exp $</small><br>
@


1.207
log
@_rbootd user/group and cksum move
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.206 2004/05/01 19:43:09 millert Exp $</p>
d814 1
a814 1
  # rm -f /usr/bin/cksum
d1389 1
a1389 1
	<small>$OpenBSD: upgrade-minifaq.html,v 1.206 2004/05/01 19:43:09 millert Exp $</small><br>
@


1.206
log
@Split 3.4.9 into two entries: one to update bsd.own.mk (all arches) and
one to build gcc3 (sparc64 only).  From Peter Clark via kjell@@
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.205 2004/04/30 18:32:37 nick Exp $</p>
d97 2
d788 30
d1389 1
a1389 1
	<small>$OpenBSD: upgrade-minifaq.html,v 1.205 2004/04/30 18:32:37 nick Exp $</small><br>
@


1.205
log
@
Bump version number, while waiting for "other things"...
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.204 2004/04/29 09:22:09 tom Exp $</p>
d109 2
a110 1
      <a href="#3.4.9">3.4.9: Switch to gcc3 (sparc64)</a><br>
d956 16
a971 1
      3.4.9:  Switch to gcc3 (sparc64) (2004/02/20)
a978 2
    # cd /usr/src/share/mk
    # make install
d1357 1
a1357 1
	<small>$OpenBSD: upgrade-minifaq.html,v 1.204 2004/04/29 09:22:09 tom Exp $</small><br>
@


1.204
log
@Fix typo, from Jochem Kossen, jkossen (at) xs4all (dot) nl.

Also s/systemcall/system call/.
@
text
@d13 1
a13 1
    <h2>Latest OpenBSD Release - 3.4</h2>
d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.203 2004/04/29 03:28:47 nick Exp $</p>
d1343 1
a1343 1
	<small>$OpenBSD: upgrade-minifaq.html,v 1.203 2004/04/29 03:28:47 nick Exp $</small><br>
@


1.203
log
@
Attitude++
Next time some dim^H^H^H^Hone thinks they have a Theo-given right to
make life difficult on themselves and everyone else by doing things the
hard way, just point 'em at
   http://www.openbsd.org/faq/upgrade-minifaq.html#1.2
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.202 2004/04/18 12:31:52 otto Exp $</p>
d219 1
a219 1
      from the closest avaialable snapshot or release is <i>not
d998 1
a998 1
    <p>The parameters to the mquery systemcall were changed to match mmap().
d1343 1
a1343 1
	<small>$OpenBSD: upgrade-minifaq.html,v 1.202 2004/04/18 12:31:52 otto Exp $</small><br>
@


1.202
log
@seperation -> separation
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.201 2004/04/18 11:10:40 deraadt Exp $</p>
d210 4
a213 3
      from a release to <em>-current</em> is not always easy. The
      most painless way to move up to <em>-current</em> is to first
      <a href="#1.15">upgrade to the latest snapshot</a>.
d217 4
a220 1
      problems.</p>
d1343 1
a1343 1
	<small>$OpenBSD: upgrade-minifaq.html,v 1.201 2004/04/18 11:10:40 deraadt Exp $</small><br>
@


1.201
log
@spelling error by henning who cannot commit from near kamloops; openbsd@@rukh.net
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.200 2004/04/17 20:09:42 henning Exp $</p>
d732 1
a732 1
      or to use privilege seperation. Thus a new user and group _dhcp are
d1339 1
a1339 1
	<small>$OpenBSD: upgrade-minifaq.html,v 1.200 2004/04/17 20:09:42 henning Exp $</small><br>
@


1.200
log
@my spelink sucks
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.199 2004/04/17 19:56:02 henning Exp $</p>
d777 1
a777 1
  _tftd:*:79:79::0:0:TFTP Daemon:/var/empty:/sbin/nologin
d1339 1
a1339 1
	<small>$OpenBSD: upgrade-minifaq.html,v 1.199 2004/04/17 19:56:02 henning Exp $</small><br>
@


1.199
log
@and another new user...
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.198 2004/04/15 00:00:29 henning Exp $</p>
d750 1
a750 1
      >mopd(8)</a> daemon now drops privileges after initializaton,
d768 1
a768 1
      >tftpd(8)</a> daemon now drops privileges after initializaton to
d1339 1
a1339 1
	<small>$OpenBSD: upgrade-minifaq.html,v 1.198 2004/04/15 00:00:29 henning Exp $</small><br>
@


1.198
log
@new user/group mopd (yes, the blabla is a bit ahead of time)
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.197 2004/04/14 07:36:00 xsa Exp $</p>
d96 1
d763 18
d1339 1
a1339 1
	<small>$OpenBSD: upgrade-minifaq.html,v 1.197 2004/04/14 07:36:00 xsa Exp $</small><br>
@


1.197
log
@
consistency fixes from Martin Reindl <mreindl at catai.org>
ok nick@@.
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.196 2004/04/13 21:54:27 henning Exp $</p>
d94 2
a95 1
      <a href="#3.5.2">3.5.2: New user and group _dhcp (2004/04/12)</a><br>
d744 18
d1320 1
a1320 1
	<small>$OpenBSD: upgrade-minifaq.html,v 1.196 2004/04/13 21:54:27 henning Exp $</small><br>
@


1.196
log
@user/group _dhcp, reminder and ok nick@@
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.195 2004/04/12 16:24:21 millert Exp $</p>
d708 2
a709 2
          <li>Copy the new MAKEDEV script to the dev directory and create
	      the new pty devices.
d1297 1
a1297 1
    <hr width="30%">
d1301 1
a1301 1
	$OpenBSD: upgrade-minifaq.html,v 1.195 2004/04/12 16:24:21 millert Exp $<br>
@


1.195
log
@Reorder the instructions in the pty section slightly.
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.194 2004/04/11 18:37:52 millert Exp $</p>
d94 1
d725 17
d1301 1
a1301 1
	$OpenBSD: upgrade-minifaq.html,v 1.194 2004/04/11 18:37:52 millert Exp $<br>
@


1.194
log
@Document the pty upgrade procedure
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.193 2004/03/01 05:55:26 nick Exp $</p>
d702 1
a702 1
      <tt>/dev/MAKEDEV</tt> after installing the new kernel:
d705 2
a706 1
          <li>Build a new kernel
d713 2
a714 3
          <li>Continue with your build
	  <li>After installing and rebooting the new kernel you should remove
	      the old pty devices no longer in use:
d1283 1
a1283 1
	$OpenBSD: upgrade-minifaq.html,v 1.193 2004/03/01 05:55:26 nick Exp $<br>
@


1.193
log
@
gcc 2.9.5 -> 2.95.3.  Oops.  Spotted by tedu@@.
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.192 2004/03/01 05:16:44 nick Exp $</p>
d91 6
a96 1
    <h2>Upgrading from 3.4 to <i>-current</i></h2>
d688 37
d727 1
a727 1
      Upgrading from 3.4 to <i>-current</i>
d1283 1
a1283 1
	$OpenBSD: upgrade-minifaq.html,v 1.192 2004/03/01 05:16:44 nick Exp $<br>
@


1.192
log
@
Old g++ include files need to be removed before rebuilding gcc3.
Noticed by marc@@ (Marc Hyman) and pvalchev@@, ok'd pvalchev@@, tested by
marc@@ (thanks!).
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.191 2004/02/24 15:18:29 tom Exp $</p>
d446 1
a446 1
    <p>OpenBSD now supports two compilers in-tree, gcc v2.9.5 used by
d448 1
a448 1
      work better with it than with v2.9.5.
d466 1
a466 1
  <b>If your platform uses gcc 2.9.5:</b>
d474 1
a474 1
  <b>Common build procedure for v3.3.2 or v2.9.5</b>
d1241 1
a1241 1
	$OpenBSD: upgrade-minifaq.html,v 1.191 2004/02/24 15:18:29 tom Exp $<br>
@


1.191
log
@bump copyrights to 2004

ok nick@@
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.190 2004/02/24 13:27:11 xsa Exp $</p>
d863 1
d1241 1
a1241 1
	$OpenBSD: upgrade-minifaq.html,v 1.190 2004/02/24 13:27:11 xsa Exp $<br>
@


1.190
log
@
ttyyppoo; from Martin Reindl <mreindl at catai.org>
ok nick@@.
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.189 2004/02/22 19:23:47 nick Exp $</p>
d1240 2
a1241 2
	$OpenBSD: upgrade-minifaq.html,v 1.189 2004/02/22 19:23:47 nick Exp $<br>
	Copyright &copy; 1998-2003, Kjell Wooding.<br>
@


1.189
log
@
OpenBSD/sparc64 has gone to gcc 3.3.2.  Requested by and ok, pvalchev@@
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.188 2004/02/02 18:34:40 nick Exp $</p>
d474 1
a474 1
  <b>Common build proceedure for v3.3.2 or v2.9.5</b>
d1240 1
a1240 1
	$OpenBSD: upgrade-minifaq.html,v 1.188 2004/02/02 18:34:40 nick Exp $<br>
@


1.188
log
@
"Upgrading from x.y" -> "Upgrading from x.y to x.y+1". Henning@@ concurred.
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.187 2004/02/02 17:37:29 nick Exp $</p>
d101 1
d446 12
d466 9
a474 2
  # rm -r /usr/obj/gnu/egcs/gcc/*
  # cd /usr/src/gnu/egcs/gcc
a487 13
    <p>You may be able to speed this process up by using the
      BOOTSTRAP procedure:</p>

<pre>
  # cd /usr/src/gnu/egcs/gcc
  # make -f Makefile.bsd-wrapper clean
  # make -f Makefile.bsd-wrapper obj
  # make -f Makefile.bsd-wrapper -DBOOTSTRAP
  # make -f Makefile.bsd-wrapper -DBOOTSTRAP install
  # make -f Makefile.bsd-wrapper clean
  # make -f Makefile.bsd-wrapper
  # make -f Makefile.bsd-wrapper install
</pre>
d850 16
d1240 1
a1240 1
	$OpenBSD: upgrade-minifaq.html,v 1.187 2004/02/02 17:37:29 nick Exp $<br>
@


1.187
log
@
move 2.9, 3.0 and 3.1 from upgrade-minifaq.html to upgrade-old.html,
make it more clear that "Upgrading from 3.4" means "to -current".
From discussion with Henning@@
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.186 2004/02/02 16:28:43 nick Exp $</p>
d103 1
a103 1
    <h2>Upgrading from 3.3</h2>
d118 1
a118 1
    <h2>Upgrading from 3.2</h2>
d847 1
a847 1
      Upgrading from 3.3
d973 1
a973 1
      Upgrading from 3.2
d1217 1
a1217 1
	$OpenBSD: upgrade-minifaq.html,v 1.186 2004/02/02 16:28:43 nick Exp $<br>
@


1.186
log
@
machdep.c change mandates rebuilding binutils first on i386.  ok henning@@
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.185 2004/01/28 21:06:07 otto Exp $</p>
d91 1
a91 1
    <h2>Upgrading from 3.4</h2>
a130 44
    
    <h2>Upgrading from 3.1</h2>
    
    <p>
      <a href="#3.1.1">3.1.1: New users/groups</a><br>
      <a href="#3.1.2">3.1.2: New group for crontab(1) and at(1)</a><br>
      <a href="#3.1.3">3.1.3: New Binutils</a><br>
      <a href="#3.1.4">3.1.4: New S/Key configuration</a><br>
      <a href="#3.1.5">3.1.5: New permissions for lp*</a><br>
      <a href="#3.1.6">3.1.6: atrun(8) no longer needed</a><br>
      <a href="#3.1.7">3.1.7: nat.conf merged into pf.conf</a><br>
      <a href="#3.1.8">3.1.8: New fbtab entry needed for xdm</a><br>
      <a href="#3.1.9">3.1.9: Use __attribute__((sentinel)) on certain
		functions</a><br>
    </p>

    <h2>Upgrading from 3.0</h2>
    
    <p>
      <a href="#3.0.1">3.0.1: New keyword supported by mtree(8)</a><br>
      <a href="#3.0.2">3.0.2: Removal of libdl on ELF platforms</a><br>
      <a href="#3.0.3">3.0.3: New regression framework</a><br>
      <a href="#3.0.4">3.0.4: ssh config files moved to /etc/ssh/</a><br>
    </p>
    
    <h2>Upgrading from 2.9</h2>

    <p>
      <a href="#2.9.1">2.9.1: New users/groups - <em>proxy</em>,
	<em>smmsp</em> and <em>popa3d</em></a><br>

      <a href="#2.9.2">2.9.2: New packet filter: <em>pf</em></a><br>

      <a href="#2.9.3">2.9.3: Changes to <em>make</em></a><br>

      <a href="#2.9.4">2.9.4: Build fails because of KerberosV
	errors</a><br>

      <a href="#2.9.5">2.9.5: New <em>sendmail</em> version</a><br>

      <a href="#2.9.6">2.9.6: <tt>/etc/primes</tt> Moved</a>

    </p>
    
d134 1
a134 1
    <p>Information on upgrading from OpenBSD 2.3 to 2.8 
d678 1
a678 1
      Upgrading from 3.4
a1212 654
    <a name="3.1"></a>
    <h2>
      Upgrading from 3.1
    </h2>
    
    <a name="3.1.1"></a>
    <h3>
      3.1.1: New users/groups
    </h3>

    <p>Several new users/groups have been added. 
      In support of 
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8"
      >authpf(8)</a>, a new group is required. Also, to support
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sshd&amp;sektion=8">sshd(8)</a>'s
      privilege separation feature, a new user and group named <em>sshd</em>
      have been added to the system.
      More new users for system services have been added, they are prefixed
      with &quot;_&quot;.
      Add the following user entries using 
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>:
    </p>
<pre>
  sshd:*:27:27::0:0:sshd privsep:/var/empty:/sbin/nologin
  _portmap:*:28:28::0:0:portmap:/var/empty:/sbin/nologin
  _identd:*:29:29::0:0:identd:/var/empty:/sbin/nologin
  _rstatd:*:30:30::0:0:rpc.rstatd:/var/empty:/sbin/nologin
  _rusersd:*:32:32::0:0:rpc.rusersd:/var/empty:/sbin/nologin
  _fingerd:*:33:33::0:0:fingerd:/var/empty:/sbin/nologin
  _x11:*:35:35::0:0:X server:/var/empty:/sbin/nologin
</pre>
    
    <p>Add the following to <tt>/etc/group</tt>:</p>
       
<pre>
  sshd:*:27:
  _portmap:*:28:
  _identd:*:29:
  _rstatd:*:30:
  _rusersd:*:32:
  _fingerd:*:33:
  _sshagnt:*:34:
  _x11:*:35:
  authpf:*:72:
</pre>

    <a name="3.1.2"></a>
    <h3>
      3.1.2: New group for crontab(1) and at(1)
    </h3>

    <p>
      The 
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=crontab&amp;sektion=1">
      crontab(1)</a> and
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=at&amp;sektion=1">
      at(1)</a> commands are no longer setuid root, they are now setgid
      <em>crontab</em>.

    <p>
      Before you run &quot;make build&quot;, you will need to add the
      <em>crontab</em> group.
      Add a line like the following to your <tt>/etc/group</tt> file:</p>

<pre>
  crontab:*:66:
</pre>

<p>
      The &quot;make build&quot; will update some, but not all, permissions
      for you.  After &quot;make build&quot; finishes, you must run following
      by hand (assumes <tt>/bin/csh</tt>):
</p>

<pre>
  # chgrp crontab /var/at/at.{allow,deny} /var/cron/{allow,deny}
  # chmod 0640 /var/at/at.{allow,deny} /var/cron/{allow,deny}
  # foreach f ( /var/cron/tabs/* )
	  set u=`basename $f`
 	  chown $u:crontab $f
    end
</pre>

<p>
      Note that you probably will not have all of the allow/deny files;
      this is not a problem.
</p>

    <a name="3.1.3"></a>
    <h3>
      3.1.3: New Binutils
    </h3>

<p>
A new binutils (2.11.2) has gone into the tree, requiring an updated
<em>libiberty</em>. To build this library, follow these steps:
</p>
  
<pre>
  # cd /usr/src/gnu/egcs/libiberty
  # make -f Makefile.bsd-wrapper cleandir
  # make -f Makefile.bsd-wrapper obj
  # make -f Makefile.bsd-wrapper depend
  # make -f Makefile.bsd-wrapper
  # make -f Makefile.bsd-wrapper install
</pre>

    <a name="3.1.4"></a>
    <h3>
      3.1.4: New S/Key configuration
    </h3>

    <p>
      The old S/Key database file, <tt>/etc/skeykeys</tt>, has been replaced by
      a directory, <tt>/etc/skey</tt>, where each record is an individual file
      owned by the user it describes.  You can convert <tt>/etc/skeykeys</tt>
      to the new format by running (as root):
    </p>
<pre>
  # skeyinit -C
  # mv /etc/skeykeys /etc/skeykeys.OLD
</pre>

<p>
      Note that any third-party programs that utilize S/Key directly will need
      to be recompiled.
</p>

    <a name="3.1.5"></a>
    <h3>
      3.1.5: New permissions for lp*
    </h3>

    <p>
      The spool directories used by lpd must now be writable by group
      daemon in order for lpr to be able to spool files.  Additionally,
      the files within the spool directories must be owned by user and
      group daemon.  This can be accomplished as follows:
    </p>
<pre>
 # find /var/spool/output /var/spool/lpd -type d \
	-execdir chgrp daemon {} \; -execdir chmod g+rwx {} \;
 # find /var/spool/output /var/spool/lpd -type f \
	-execdir chown daemon:daemon {} \;
</pre>

    <a name="3.1.6"></a>
    <h3>
      3.1.6: atrun(8) no longer needed
    </h3>

    <p>
      The <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=atrun&amp;sektion=8">atrun(8)</a>
      command is no longer needed.  Its functionality has been incorporated into
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cron&amp;sektion=8">cron(8)</a>.
      You should remove the <tt>/usr/libexec/atrun</tt> job from root's
      crontab by running the following as root:
    </p>
    <pre>
      # crontab -e
    </pre>

    <p>
      You may also wish to remove <tt>/usr/libexec/atrun</tt>,
      <tt>/usr/share/man/cat8/atrun.0</tt> and the
      <tt>/var/at/spool</tt> directory.
    </p>

    <a name="3.1.7"></a>
    <h3>
      3.1.7: nat.conf merged into pf.conf
    </h3>

    <p>
	<tt>/etc/nat.conf</tt> is now merged into <tt>/etc/pf.conf</tt>.
	You need to insert your NAT rules in pf.conf after scrub rules and
	before filter rules.
    </p>
    <p>
	<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8">pfctl(8)</a>
	has a new option to load the ruleset, -f, and the -R and -N options
	have new meanings now. Make sure to check the manpage
	and to update your <tt>/etc/rc</tt>.
    </p>

    <a name="3.1.8"></a>
    <h3>
     3.1.8: New fbtab entry needed for xdm
    </h3>

    <p>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=login&amp;sektion=1">
login(1)</a> needs to chown /dev/wsmouse to the new _x11 user that is used by
xdm for privilege revocation purposes on many architectures. The change to
<tt>/etc/fbtab</tt> needed is architecture dependent. The file is created via
this process (assuming sources in /usr/src):
    </p>
<pre>
  # cat /usr/src/etc/fbtab.head > /etc/fbtab
  # cat /usr/src/etc/etc.`uname -m`/fbtab >> /etc/fbtab
  # cat /usr/src/etc/fbtab.tail >> /etc/fbtab
</pre>
<p>
If you had custom changes to <tt>/etc/fbtab</tt>, you will have to merge them
back into the new file manually.
</p>
   <a name="3.1.9"></a>
   <h3>
    3.1.9: Use __attribute__((sentinel)) on certain functions
   </h3>

   <p>
     __attribute__((sentinel)) is now employed to warn when certain
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=exec&amp;sektion=3">
exec(3)</a>
     functions are used without a terminating NULL pointer.
     <br><br>You will need to rebuild gcc according to section
     <a href="#1.8">1.8</a>
     of the Mini-FAQ before proceeding with <tt>make build</tt>.
   </p>

    <a name="3.0"></a>
    <h2>
      Upgrading from 3.0
    </h2>
    
    <a name="3.0.1"></a>
    <h3>
      3.0.1: New keyword supported by mtree(8)
    </h3>

    <p>
      You must build and install a new version of the
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mtree&amp;sektion=8">
      mtree(8)</a> utility before &quot;make build&quot; will succeed.
    </p>
<pre>
  # cd /usr/src/usr.sbin/mtree
  # make cleandir
  # make obj
  # make depend
  # make
  # make install
</pre>

    <a name="3.0.2"></a>
    <h3>
      3.0.2: Removal of libdl on ELF platforms
    </h3>
    
    <p>
      ELF-based platforms (alpha, macppc and sparc64) do not use libdl
      anymore. The upgrade from a libdl system to a non-libdl is best
      done following these steps:
    </p>

    <ul>
      <li>
	<p>Recompile your system:</p>
<pre>
  # cd /usr/src
  # make build
</pre>
      </li>

      <li>
	<p>
	  If your &quot;make build&quot; completed successfully, you
	  can step ahead and remove libdl.  Note that packages that
	  have been linked against it should be reinstalled after
	  that.  If you are not ready for this, you can skip this step
	  for now.  Snapshots with correct packages will be made
	  available.
	</p>
<pre>
  # rm -f /usr/lib/libdl.* /usr/lib/libdl_pic.a
</pre>
	</li>
      <li>
	<p>
	  With libdl removed, regenerate your shared libraries cache:
	</p>
	
<pre>
  # ldconfig -R
</pre>
      </li>
    </ul>

    <a name="3.0.3"></a>
    <h3>
      3.0.3: New regression framework
    </h3>
    
    <p>
      A new infrastructure for regression tests has been introduced and
      <tt>bsd.regress.mk</tt> has been added.  You will need to install
      this file before running <em>make obj</em>.
    </p>

<pre>
  # cd /usr/src/share/mk
  # make install
</pre>

    <a name="3.0.4"></a>
    <h3>
      3.0.4: ssh config files moved to /etc/ssh/
    </h3>

    <p>
      You need to create /etc/ssh/ first, see section
      <a href="#1.13">1.13</a>
    </p>

    <p>
      Recompile your system:
    </p>
<pre>
  # cd /usr/src
  # make build
</pre>

    <p>
      Move your /etc/ssh*_* files into the newly created /etc/ssh/ directory:
    </p>
<pre>
  # cd /etc
  # mv ssh*_* ssh/
</pre>

    <p>
      You will need to
      <a href="http://www.openbsd.org/cgi-bin/cvsweb/src/etc/rc.diff?r1=1.188&amp;r2=1.189">
	change your <tt>rc</tt> scripts</a> to reflect
	these changes as well.
    </p>

    <p>
      Update any <tt>HostKey</tt> lines in your sshd_config to reflect
      the new location.  For example:
    </p>
<pre>
  HostKey /etc/ssh_host_key
</pre>

    <p>should be changed to:</p>

<pre>
  HostKey /etc/ssh/ssh_host_key
</pre>

    <p>
      After this, you can restart the sshd daemon.
    </p>

    <a name="2.9"></a> 
    <h2>Upgrading from 2.9</h2>

    <a name="2.9.1"></a> 
    <h3>2.9.1: New users/groups - <em>proxy</em>, <em>smmsp</em>, and
      <em>popa3d</em>.</h3>

    <p>
      First, with the addition of the 
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4">
	pf(4)</a> firewalling package, and its 
      <a href=
	 "http://www.openbsd.org/cgi-bin/man.cgi?query=ftp-proxy&amp;sektion=8"
	 >ftp-proxy(8)</a> suite, a new user and group named
      <em>proxy</em> were added to the system. To support this
      addition, add the following user entry using 
      <a href=
	 "http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">
	vipw(8)</a>:</p>
    
<pre>
proxy:*:71:71::0:0:Proxy Services:/nonexistent:/sbin/nologin
</pre>

    <p>Also add the <em>proxy</em> group to /etc/group:</p>

<pre>
proxy:*:71:
</pre>

    <p>Second, as part of the Sendmail 8.12 upgrade, sendmail no
      longer runs setuid root. Both a new user and a new group, named
      <em>smmsp</em>, have been added to the system. Add a line like
      the following to your <tt>/etc/group</tt>:</p>

<pre>
smmsp:*:25:
</pre>

    <p>Then, run 
      <a href=
	 "http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">
	vipw(8)</a> and add the following line for the <em>smmsp</em>
      user:</p>

<pre>
smmsp:*:25:25::0:0:Sendmail Message Submission Program:/nonexistent:/sbin/nologin
</pre>

    <p>Make sure this line appears before any <a href=
      "http://www.openbsd.org/cgi-bin/man.cgi?query=yp&amp;sektion=8">
      yp(8)</a> settings line.</p>

    <p>Finally, a new user and group were added for Solar
      Designer's popa3d server, now part of the core system. Add the
      following to <tt>/etc/group</tt>:</p>

<pre>
popa3d:*:26:
</pre>

    <p>And using <a href=
      "http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">
      vipw(8)</a>, add</p>
<pre>
popa3d:*:26:26::0:0:POP3 server:/var/empty:/sbin/nologin
</pre>

    <a name="2.9.2"></a> 
    <h3>2.9.2: New packet filter: <em>pf</em></h3>

    <p>The IPF firewalling package that has been part of previous
      OpenBSD releases has been replaced with an all-new firewalling
      suite called <a href=
      "http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4">
	pf(4)</a>. As a result, a number of changes need to be
      made.</p>

    <p>First, <em>pf</em> depends on a new device file. To ensure
      that this special device is created, do the following:</p>

<pre>
  # cd /dev
  # cp /usr/src/etc/etc.`machine`/MAKEDEV ./
  # ./MAKEDEV all
</pre>

    <p>Second, a number of filesystem change have occurred. For
      your reference, the following binaries have been replaced:</p>

<pre>
OLD:
/sbin/ipf /sbin/ipfstat /sbin/ipnat /usr/sbin/ipfs
/usr/sbin/ipftest /usr/sbin/ipmon /usr/sbin/ipresend
/usr/sbin/ipsend /usr/sbin/iptest
NEW:
/sbin/pfctl
/usr/libexec/ftp-proxy
</pre>

    <p>Similarly, for the devices:</p>

<pre>
OLD: /dev/ipl /dev/ipnat /dev/ipstate /dev/ipauth
NEW: /dev/pf
</pre>

    <p>And finally, the filter configuration files:</p>

<pre>
OLD: /etc/ipf.rules /etc/ipnat.rules
NEW: /etc/pf.conf /etc/nat.conf
</pre>
    <p>The old ipfilter sample configuration files may be removed:
    </p>
<pre>
  # rm -rf /usr/share/ipf
</pre>

    <p>A mechanism for safely enabling <em>pf</em> has been added
      to the <tt>/etc/rc</tt> and <tt>/etc/rc.conf</tt> files. You
      will need to update these files to include the new hooking
      mechanism. If you wish to enable <em>pf</em>, set PF=YES in
      <tt>/etc/rc.conf</tt>.</p>

    <a name="2.9.3"></a> 
    <h3>2.9.3: Changes to <em>make</em></h3>

    <p>There have been changes to <a href=
      "http://www.openbsd.org/cgi-bin/man.cgi?query=make&amp;sektion=1">
	make(1)</a> and its data files which may cause difficulties in
      the build process. This usually manifests as errors from
      <em>bsd.own.mk</em> during the build. To avoid these issues,
      first update the data files:</p>
<pre>
  # cd /usr/src/share/mk
  # make install
</pre>

    <p>Then build and install the new make.</p>

<pre>
  # cd /usr/src/usr.bin/make
  # make clean &amp;&amp; make obj &amp;&amp; make depend &amp;&amp; make
  # make install
</pre>

    <p>Now proceed with your upgrade.</p>
    
    <a name="2.9.4"></a>
    <h3>2.9.4: Build fails because of KerberosV errors</h3>

    <p>Before you try building the whole system, you need to first
      build KerberosV.</p>

    <p>First, there is a new KerberosV configuration directory in
      <em>/etc</em>. If you have not already done so, use the <a href=
      "http://www.openbsd.org/cgi-bin/man.cgi?query=mtree&amp;sektion=8">
	mtree(8)</a> procedure described in <a href="#1.13">section
	1.13</a> to create it:</p>

    <p>Now, build KerberosV</p>

<pre>
  # cd /usr/src/kerberosV
  # make obj
  # cd lib/roken
  # make 
  # cd ../../usr.bin/asn1_compile
  # make
  # make install
</pre>

    <p>You may also need to update your <tt>/etc/login.conf</tt>,
      to reflect that the file
      <tt>/usr/libexec/auth/login_krb-or-pwd</tt> has been renamed to
      <tt>login_krb<strong>4</strong>-or-pwd</tt>.</p>

    <a name="2.9.5"></a> 
    <h3>2.9.5: New <em>sendmail</em> version</h3>

    <p><a href=
      "http://www.openbsd.org/cgi-bin/man.cgi?query=sendmail&amp;sektion=8">
	sendmail(8)</a> has been upgraded to version 8.12. As this
      version of <em>sendmail</em> no longer runs setuid root,
      significant changes have resulted.</p>

    <ol>
      <li>Both a new user and a new group (<em>smmsp</em>) have
	been added. If you have not yet done so, follow the procedure
	in <a href="#2.9.1">section 2.9.1</a> to create them.</li>

      <li>Several changes to the file hierarchy have occurred,
	including a new <tt>/var/spool/clientmqueue</tt> directory
	and new permissions for <tt>/var/spool/mqueue</tt>. These
	changes can both be made using the <a href=
        "http://www.openbsd.org/cgi-bin/man.cgi?query=mtree&amp;sektion=8">
	  mtree(8)</a> procedure described in <a href="#1.13">section
	  1.13</a>.</li>

      <li>
        <p>Add the following to root's <a href=
          "http://www.openbsd.org/cgi-bin/man.cgi?query=crontab&amp;sektion=1">
	    crontab(1)</a>. This is necessary since <em>sendmail</em>
	  is no longer setuid root, and relies on this entry to do
	  parts of its job:</p>

<pre>
# sendmail clientmqueue runner
*/30    *       *       *       *       /usr/sbin/sendmail -L sm-msp-queue -Ac -q
</pre>

      </li>
      
      <li>
        <p>Upgrade sendmail:</p>

<pre>
  # cd /usr/src/gnu/usr.sbin/sendmail
  # make clean &amp;&amp; make obj &amp;&amp; make depend &amp;&amp; make &amp;&amp; make install
</pre>

        <p><strong>Note:</strong> The files <tt>submit.cf</tt> and
	  <tt>localhost.cf</tt> have been installed to your
	  <tt>/etc/mail</tt> directory. The first of these,
	  <tt>submit.cf</tt> (referred to as the "client"
	  configuration file in current sendmail documentation) is
	  used by mail user agents that want to submit mail locally
	  for delivery via sendmail. Due to the permissions changes
	  described above, this does not require root privileges; the
	  sendmail binary is set-groupid to group smmsp. The second
	  file, <tt>localhost.cf</tt>, is an OpenBSD-ism that runs
	  sendmail only listening on the localhost interface to
	  accept mail from the local host but not accept connections
	  from the network (you almost certainly want this if you
	  also use e.g., <a href=
          "http://www.openbsd.org/cgi-bin/man.cgi?query=smtpd&amp;sektion=8">
	    smtpd(8)</a> listening on the SMTP port on your outside
	  interface). For more details, see the file
	  <tt>SECURITY</tt> in
	  <tt>/usr/src/gnu/usr.sbin/sendmail/sendmail</tt>.</p>

        <p>It is highly recommended that you regenerate and update
	  your sendmail configuration files in <tt>/etc/mail</tt>.
	  You can find some working configuration files in
	  <tt>/usr/share/sendmail/cf</tt>. Note that localhost.cf is
	  generated from openbsd-localhost.mc.</p>
      </li>

      <li>
        <p>If you were running sendmail without the <tt>-bd</tt>
	  option in <tt>/etc/rc.conf</tt>, as the default
	  installation settings do, you will need to use
	  <tt>localhost.cf</tt>. Edit <tt>rc.conf</tt> to use the
	  following:</p>
<pre>
# For normal use: "-L sm-mta -bd -q30m"
sendmail_flags="-L sm-mta -C/etc/mail/localhost.cf -bd -q30m"
</pre>
      </li>

      <li>
        <p>Once your configuration file is ready, <a href=
         "http://www.openbsd.org/cgi-bin/man.cgi?query=kill&amp;sektion=1">
	    kill(1)</a> the existing sendmail:</p>
<pre>
  kill `sed 1q /var/run/sendmail.pid`
</pre>

        <p>Restart the new sendmail with the appropriate options,
	  for example:</p>
<pre>
  /usr/sbin/sendmail -L sm-mta -bd -q30m
</pre>

        <p>for a configuration accepting mail from outside, or</p>

<pre>
  /usr/sbin/sendmail -L sm-mta -C/etc/mail/localhost.cf -bd -q30m
</pre>

        <p>for a local mail-only configuration.</p>
	
        <p><strong>Note:</strong> the <tt>-bd</tt> flag is now
	  needed in both cases.</p>
      </li>
    </ol>

    <p>The new <em>sendmail</em> should now be running.</p>

    <a name="2.9.6"></a> 
    <h3>2.9.6: <tt>/etc/primes</tt> Moved</h3>

    <p><tt>/etc/primes</tt> has been renamed to
      <tt>/etc/moduli</tt>. Simply copy this file from its old
      location or from <tt>/usr/src/etc</tt>.</p>


d1217 1
a1217 1
	$OpenBSD: upgrade-minifaq.html,v 1.185 2004/01/28 21:06:07 otto Exp $<br>
@


1.185
log
@New user and group _tcpdump. ok nick@@
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.184 2004/01/23 20:38:08 otto Exp $</p>
d100 1
d863 7
d871 16
d1915 1
a1915 1
	$OpenBSD: upgrade-minifaq.html,v 1.184 2004/01/23 20:38:08 otto Exp $<br>
@


1.184
log
@Mention _bgpd user and group. Since this is a month after the fact,
renumber newer sections.
ok nick@@ henning@@
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.183 2004/01/15 21:42:38 millert Exp $</p>
d99 1
d846 19
d1891 1
a1891 1
	$OpenBSD: upgrade-minifaq.html,v 1.183 2004/01/15 21:42:38 millert Exp $<br>
@


1.183
log
@Mention sudo build gotcha
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.182 2003/12/28 19:54:54 otto Exp $</p>
d96 3
a98 2
      <a href="#3.4.4">3.4.4: New version of join(1)</a><br>
      <a href="#3.4.5">3.4.5: sudo build change</a><br>
d798 19
a816 1
	3.4.4: New version of join(1) (2003/12/28)
d830 1
a830 1
    <a name="3.4.5"></a>
d832 1
a832 1
	3.4.5: sudo build change (2004/01/15)
d1871 1
a1871 1
	$OpenBSD: upgrade-minifaq.html,v 1.182 2003/12/28 19:54:54 otto Exp $<br>
@


1.182
log
@Tell people to update /etc/security.

ok nick@@ millert@@
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.181 2003/12/07 15:38:29 sturm Exp $</p>
d97 1
d811 15
d1852 1
a1852 1
	$OpenBSD: upgrade-minifaq.html,v 1.181 2003/12/07 15:38:29 sturm Exp $<br>
@


1.181
log
@3.4.3 Interface cloning

ok markus@@ (the text itself), nick@@
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.180 2003/11/11 00:01:31 margarida Exp $</p>
d96 1
d794 16
d1836 1
a1836 1
	$OpenBSD: upgrade-minifaq.html,v 1.180 2003/11/11 00:01:31 margarida Exp $<br>
@


1.180
log
@Mention KerberosIV authentication removal.

help and ok miod@@ nick@@
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.179 2003/11/07 22:25:51 nick Exp $</p>
d95 1
d765 28
d1819 1
a1819 1
	$OpenBSD: upgrade-minifaq.html,v 1.179 2003/11/07 22:25:51 nick Exp $<br>
@


1.179
log
@
3.3 -> 3.4, pointed out by Dmitriy Medvedev (dima at oganer dot net).
Bring page back into validation while in neighborhood (bad </p>'s).
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.178 2003/11/02 22:49:21 david Exp $</p>
d103 3
a105 2
      <a href="#3.3.4">3.3.4: config change</a><br>
      <a href="#3.3.5">3.3.5: Use __attribute__((bounded)) on certain
d107 2
a108 2
      <a href="#3.3.6">3.3.6: New user and group _syslogd</a><br>
      <a href="#3.3.7">3.3.7: New format attribute __kprintf__ in kernel 
d814 5
d820 6
a825 1
    <a name="3.3.4"></a>
d827 1
a827 1
      3.3.4: <tt>config</tt> change (2003/05/23)
d845 1
a845 1
   <a name="3.3.5"></a>
d847 1
a847 1
    3.3.5: Use __attribute__((bounded)) on certain functions (2003/06/26)
d858 1
a858 1
    <a name="3.3.6"></a>
d860 1
a860 1
      3.3.6: New user and group _syslogd (2003/07/31)
d876 1
a876 1
    <a name="3.3.7"></a>
d878 1
a878 1
      3.3.7: Use format attribute __kprintf__ in kernel headers (2003/08/23)
d1790 1
a1790 1
	$OpenBSD: upgrade-minifaq.html,v 1.178 2003/11/02 22:49:21 david Exp $<br>
@


1.178
log
@prefix DESTDIR variable with env so it works in csh also
ok henning@@
@
text
@d13 1
a13 1
    <h2>Latest OpenBSD Release - 3.3</h2>
d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.177 2003/10/23 17:12:26 nick Exp $</p>
d743 1
a743 1
    </p>
d761 1
a761 1
    </p>
d863 1
a863 1
    </p>
d1779 1
a1779 1
	$OpenBSD: upgrade-minifaq.html,v 1.177 2003/10/23 17:12:26 nick Exp $<br>
@


1.177
log
@
3.4.2: New user and group _pflogd (2003/10/23)
From Srebrenko Sehic (haver at insecure dot dk), thanks!
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.176 2003/10/23 16:35:24 henning Exp $</p>
d338 1
a338 1
  # cd /usr/src/etc &amp;&amp; DESTDIR=/ make distrib-dirs
d1779 1
a1779 1
	$OpenBSD: upgrade-minifaq.html,v 1.176 2003/10/23 16:35:24 henning Exp $<br>
@


1.176
log
@DESTDIR=/ make distrib-dirs, not make DESTDIR=/ distrib-dirs
ok nick@@
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.175 2003/10/12 15:59:39 nick Exp $</p>
d93 2
a94 1
      <a href="#3.4.1">3.4.1: svnd device minor numbers changed</a>
d745 17
d1779 1
a1779 1
	$OpenBSD: upgrade-minifaq.html,v 1.175 2003/10/12 15:59:39 nick Exp $<br>
@


1.175
log
@
Add info about TedU@@'s svnd changes.  From Tom Cosgrove, input from TedU@@.
ok henning@@, tedu@@
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.174 2003/08/26 04:20:57 avsm Exp $</p>
d337 1
a337 1
  # cd /usr/src/etc &amp;&amp; make DESTDIR=/ distrib-dirs
d1761 1
a1761 1
	$OpenBSD: upgrade-minifaq.html,v 1.174 2003/08/26 04:20:57 avsm Exp $<br>
@


1.174
log
@mention the __kprintf__ attribute; nick@@ ok
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.173 2003/08/03 04:49:28 avsm Exp $</p>
d91 5
d712 33
d1761 1
a1761 1
	$OpenBSD: upgrade-minifaq.html,v 1.173 2003/08/03 04:49:28 avsm Exp $<br>
@


1.173
log
@note the _syslogd user
nick@@ ok
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.172 2003/07/14 20:15:56 nick Exp $</p>
d101 2
d201 1
a201 1
      releases are 
d807 15
a821 1
      </p>
d1723 1
a1723 1
	$OpenBSD: upgrade-minifaq.html,v 1.172 2003/07/14 20:15:56 nick Exp $<br>
@


1.172
log
@
Simplify man page links.  Several odd-ball links pointed out by
Dmitriy A. Medvedev (the_13 at mail dot ru).
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.169 2003/06/22 18:54:12 david Exp $</p>
d100 1
d789 18
d1707 1
a1707 1
	$OpenBSD: upgrade-minifaq.html,v 1.169 2003/06/22 18:54:12 david Exp $<br>
@


1.171
log
@
Oops! Forgot the date.  Pointed out by dp@@
@
text
@d597 1
a597 1
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sudo&amp;apropos=0&amp;sektion=8&amp;manpath=OpenBSD+Current&amp;arch=i386&amp;format=html"
@


1.170
log
@note that gcc needs a rebuild; kjell@@ nick@@ ok
@
text
@d777 1
a777 1
    3.3.5: Use __attribute__((bounded)) on certain functions
@


1.169
log
@doctype/charset cleanup
ok nick@@
@
text
@d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.168 2003/06/03 21:44:58 david Exp $</p>
d98 2
d775 12
a786 1

d1688 1
a1688 1
	$OpenBSD: upgrade-minifaq.html,v 1.168 2003/06/03 21:44:58 david Exp $<br>
@


1.168
log
@valid HTML 4.01 Transitional
ok nick@@
@
text
@d5 1
a5 3
    <meta http-equiv="Content-Type" content=
    "text/html; charset=iso-8859-1">

d19 1
a19 1
	$OpenBSD: upgrade-minifaq.html,v 1.167 2003/05/25 01:42:45 tedu Exp $</p>
d1675 1
a1675 1
	$OpenBSD: upgrade-minifaq.html,v 1.167 2003/05/25 01:42:45 tedu Exp $<br>
@


1.167
log
@config and swapgeneric change.  ok and help from nick@@ ok henning@@
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.166 2003/05/06 21:08:25 pvalchev Exp $</p>
a742 1
    </p>
a774 1
    </p>
a799 1
    </p>
a837 1
    </p>
a879 1
    </p>
a893 1
    </p>
a984 1
    </ol>
d1677 1
a1677 1
	$OpenBSD: upgrade-minifaq.html,v 1.166 2003/05/06 21:08:25 pvalchev Exp $<br>
@


1.166
log
@- 3.3.2 comes before 3.3.3
- change -> to -&gt; to avoid someone putting <!-- in beginning of file
from Jim Geovedi
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.165 2003/05/05 19:28:33 miod Exp $</p>
d99 1
d756 22
d1684 1
a1684 1
	$OpenBSD: upgrade-minifaq.html,v 1.165 2003/05/05 19:28:33 miod Exp $<br>
@


1.165
log
@Fix href and bad english in previous change.
Inspired by Eduardo Augusto Alvarenga.
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.164 2003/05/05 17:55:52 drahn Exp $</p>
d720 1
a720 1
    <p>SOURCE UPGRADES FROM a.out -> ELF WILL NOT BE SUPPORTED.
a724 11
    <a name="3.3.3"></a>
    <h3>
      3.3.3: i386 flag day, exe addr/MAXDSIZ change (2003/05/05)
    </h3>

    <p>To allow MAXDSIZ to be changed back to 1G, the base
      address of all executables changes from 0 to 0x1c000000. The
      combination of these changes requires updating from snapshot.
      Updating from source is not supported.  This only affects i386.
    </p>

d744 12
d1661 1
a1661 1
	$OpenBSD: upgrade-minifaq.html,v 1.164 2003/05/05 17:55:52 drahn Exp $<br>
@


1.164
log
@Note that i386 is having a flag day, all machines need to be updated from
snapshot, source updates not supported.
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.163 2003/04/28 22:10:22 henning Exp $</p>
d98 1
a98 1
      <a href="#3.3.2">3.3.3: i386 flag day, exe addr/MAXDSIZ change</a><br>
d730 4
a733 4
    <p>To allow MAXDSIZ to be changed back to 1G, changes in the base
      address of all executables change from 0 to 0x1c000000. The
      combination of these changes require updating from snapshot.
      Updating from source is not supported.  This only affect i386.
d1660 1
a1660 1
	$OpenBSD: upgrade-minifaq.html,v 1.163 2003/04/28 22:10:22 henning Exp $<br>
@


1.163
log
@add missing date
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.162 2003/04/28 21:42:45 drahn Exp $</p>
d98 1
d725 11
d1660 1
a1660 1
	$OpenBSD: upgrade-minifaq.html,v 1.162 2003/04/28 21:42:45 drahn Exp $<br>
@


1.162
log
@note how to build i386 with mquery syscall change.
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.161 2003/04/17 13:28:14 drahn Exp $</p>
d726 1
a726 1
      3.3.2: mquery syscall change
d739 1
a739 1
      Only i386 uses mquery, so other architectures, do not need to
d1648 1
a1648 1
	$OpenBSD: upgrade-minifaq.html,v 1.161 2003/04/17 13:28:14 drahn Exp $<br>
@


1.161
log
@clean up  support ... support,
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.160 2003/04/17 05:17:00 drahn Exp $</p>
d97 1
d724 19
d1648 1
a1648 1
	$OpenBSD: upgrade-minifaq.html,v 1.160 2003/04/17 05:17:00 drahn Exp $<br>
@


1.160
log
@Document that i386 has moved to ELF and we will NOT support source updates.
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.159 2003/04/14 21:54:43 wilfried Exp $</p>
d711 1
a711 1
    <p>To support i386 Writable xor eXecute support, OpenBSD/i386 has
d1628 1
a1628 1
	$OpenBSD: upgrade-minifaq.html,v 1.159 2003/04/14 21:54:43 wilfried Exp $<br>
@


1.159
log
@POSIX chown, ok millert@@
@
text
@d15 1
a15 1
    <h2>Latest OpenBSD Release - 3.2</h2>
d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.158 2003/03/25 16:45:22 henning Exp $</p>
d93 6
d701 22
d727 1
a727 1
    
d1628 1
a1628 1
	$OpenBSD: upgrade-minifaq.html,v 1.158 2003/03/25 16:45:22 henning Exp $<br>
@


1.158
log
@don't suggest in-place upgrades.
help nick@@
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.157 2003/03/22 00:11:56 henning Exp $</p>
d354 1
a354 1
  # chown root.wheel /bsd (if you compiled as someone else)
d1021 1
a1021 1
 	  chown $u.crontab $f
d1600 1
a1600 1
	$OpenBSD: upgrade-minifaq.html,v 1.157 2003/03/22 00:11:56 henning Exp $<br>
@


1.157
log
@first kernel, then userland
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.156 2003/02/26 02:54:48 nick Exp $</p>
d668 2
a669 2
      The easiest way to get <em>-current</em> is to grab a boot floppy
      image and prepare like described in the
d675 13
a687 12
      You could also download the distribution <tt>.tgz</tt> and kernel files
      and unpack them in /:
<pre>
  # mv /bsd /bsd.old
  # mv bsd /
  # reboot
  # tar pzxf base33.tgz -C /
  # tar pzxf comp33.tgz -C /
  # tar pzxf game33.tgz -C /
  # tar pzxf  man33.tgz -C /
  # tar pzxf misc33.tgz -C /
</pre>
d691 1
a691 1
      In both cases, you must upgrade <a href="#1.9">/etc, /var and /dev</a>
a694 1

d1600 1
a1600 1
	$OpenBSD: upgrade-minifaq.html,v 1.156 2003/02/26 02:54:48 nick Exp $<br>
@


1.156
log
@
typos, spotted by Tom Cosgrove (tom dot cosgrove at arches-consulting dot com>,
and at least a few weren't made by me!  whoo-hoo!  Thanks!
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.155 2003/02/25 23:16:56 nick Exp $</p>
d676 1
a676 1
      and unpack them in /: 
d678 3
a685 2
  # mv /bsd /bsd.old
  # mv bsd /
d1600 1
a1600 1
	$OpenBSD: upgrade-minifaq.html,v 1.155 2003/02/25 23:16:56 nick Exp $<br>
@


1.155
log
@
update the file names for 3.3-beta...
From Xavier Santolaria (xavier at santolaria dot net), thanks!
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.154 2003/02/20 19:01:25 millert Exp $</p>
d914 1
a914 1
    now that <em>at</em> has been intergrated into <em>cron</em>.  Furthermore,
d1599 1
a1599 1
	$OpenBSD: upgrade-minifaq.html,v 1.154 2003/02/20 19:01:25 millert Exp $<br>
@


1.154
log
@A cron.deny file is now required too.
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.153 2003/02/19 22:43:40 millert Exp $</p>
d678 5
a682 5
  # tar pzxf base32.tgz -C /
  # tar pzxf comp32.tgz -C /
  # tar pzxf game32.tgz -C /
  # tar pzxf  man32.tgz -C /
  # tar pzxf misc32.tgz -C /
d1599 1
a1599 1
	$OpenBSD: upgrade-minifaq.html,v 1.153 2003/02/19 22:43:40 millert Exp $<br>
@


1.153
log
@Add info on /var/at removal
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.152 2003/02/10 17:59:21 kjell Exp $</p>
d104 1
a104 1
      <a href="#3.2.9">3.2.9: Removal of /var/at </a><br>
d910 1
a910 1
      3.2.9: Removal of /var/at (2003/02/19)
d931 9
a939 3
    Disregard any warmings about missing allow or deny files.
    Not all of them are part of the default install.
    </ol>
d1599 1
a1599 1
	$OpenBSD: upgrade-minifaq.html,v 1.152 2003/02/10 17:59:21 kjell Exp $<br>
@


1.152
log
@Speeling. from ernie at ernie.org and ispell.
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.151 2003/01/23 01:01:19 henning Exp $</p>
d104 1
d908 27
d1593 1
a1593 1
	$OpenBSD: upgrade-minifaq.html,v 1.151 2003/01/23 01:01:19 henning Exp $<br>
@


1.151
log
@add date for 3.2.8 (worx)
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.150 2003/01/20 21:25:36 margarida Exp $</p>
d199 1
a199 1
      the latest and greatest faetures added.</p>
d410 1
a410 2
  (cd /usr/src/gnu/usr.bin/perl &amp;&amp;  make -f Makefile.bsd-wrapper config.sh &amp;&amp;  mak
e -f Makefile.bsd-wrapper depend &amp;&amp;  make -f Makefile.bsd-wrapper perl.lib &amp;&amp;
d662 1
a662 1
      to make sure the next release is of superiour quality.
d1565 1
a1565 1
	$OpenBSD: upgrade-minifaq.html,v 1.150 2003/01/20 21:25:36 margarida Exp $<br>
@


1.150
log
@those too.

pvalchev@@ henning@@ ok
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.149 2003/01/19 18:11:32 henning Exp $</p>
d884 1
a884 1
      3.2.8: Linker changes for ELF architectures
d1566 1
a1566 1
	$OpenBSD: upgrade-minifaq.html,v 1.149 2003/01/19 18:11:32 henning Exp $<br>
@


1.149
log
@minor style
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.148 2003/01/19 13:55:49 henning Exp $</p>
d878 1
a878 1
  # rm /usr/lib/libc_r.* /usr/lib/libnpthread.*
d1566 1
a1566 1
	$OpenBSD: upgrade-minifaq.html,v 1.148 2003/01/19 13:55:49 henning Exp $<br>
@


1.148
log
@english(4) police in persona Lt. David Krause w/ minor addition by me
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.147 2003/01/17 22:31:18 drahn Exp $</p>
d870 1
a870 2
        <p>build gcc according to section <a href="#1.8">1.8</a> of the
        Mini-FAQ.
d872 1
a872 2
        <p>re-build the system according to section <a href="#1.5">1.5</a>
        of the Mini-FAQ.
d1566 1
a1566 1
	$OpenBSD: upgrade-minifaq.html,v 1.147 2003/01/17 22:31:18 drahn Exp $<br>
@


1.147
log
@Note that worx recommends building binutils before the entire system, to avoid
to full builds. ok henning
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.146 2003/01/14 21:34:46 marc Exp $</p>
d889 2
a890 2
    <p>Binutils/ld has change to introduce a new security feature to ELF
    executables, instead of allowing the data section of executables and
d1568 1
a1568 1
	$OpenBSD: upgrade-minifaq.html,v 1.146 2003/01/14 21:34:46 marc Exp $<br>
@


1.146
log
@libpthread notes added
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.145 2003/01/07 14:22:12 henning Exp $</p>
d103 1
d884 26
d1568 1
a1568 1
	$OpenBSD: upgrade-minifaq.html,v 1.145 2003/01/07 14:22:12 henning Exp $<br>
@


1.145
log
@group _spamd as well
reminded by margarida@@ & Eduardo Augusto Alvarenga <eduardo at thrx.dyndns.org>

ok nick@@ margarida@@
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.144 2003/01/07 14:11:49 henning Exp $</p>
d102 1
d853 30
a882 1
    <a name="3.1"></a>
d1541 1
a1541 1
	$OpenBSD: upgrade-minifaq.html,v 1.144 2003/01/07 14:11:49 henning Exp $<br>
@


1.144
log
@group _lkm

ok nick@@
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.143 2003/01/07 13:25:39 henning Exp $</p>
d99 1
a99 1
      <a href="#3.2.4">3.2.4: New user _spamd</a><br>
d801 1
a801 1
      3.2.4: New user _spamd (2002/12/24)
d803 1
a803 1
    <p>A new user has been added, for the
d805 6
a810 2
      >spamd(8)</a> daemon.
      Add the following user entry using
d1511 1
a1511 1
	$OpenBSD: upgrade-minifaq.html,v 1.143 2003/01/07 13:25:39 henning Exp $<br>
@


1.143
log
@now that we have dates on the items we will have multiple entries for new
users/groups, so mention the new user/group name(s) in the headline
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.142 2003/01/07 00:16:55 millert Exp $</p>
d101 1
d830 18
d1507 1
a1507 1
	$OpenBSD: upgrade-minifaq.html,v 1.142 2003/01/07 00:16:55 millert Exp $<br>
@


1.142
log
@When updating to propolice tell people to run "make obj" in /usr/src
so "make prereq" don't get files created in the non-obj dir.
miod@@ OK
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.141 2003/01/06 00:16:32 mcbride Exp $</p>
d97 1
a97 1
      <a href="#3.2.2">3.2.2: New groups</a><br>
d99 1
a99 1
      <a href="#3.2.4">3.2.4: New user</a><br>
d718 1
a718 1
      3.2.2: New groups (2002/11/21)
d800 1
a800 1
      3.2.4: New user (2002/12/24)
d1488 1
a1488 1
	$OpenBSD: upgrade-minifaq.html,v 1.141 2003/01/06 00:16:32 mcbride Exp $<br>
@


1.141
log
@Add a note about the new icmp6 keyword in /etc/protocols,
requested by henning@@

ok nick@@
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.140 2003/01/01 13:02:00 nick Exp $</p>
d769 2
a772 1
          # make obj
a775 1
          # make obj
d1488 1
a1488 1
	$OpenBSD: upgrade-minifaq.html,v 1.140 2003/01/01 13:02:00 nick Exp $<br>
@


1.140
log
@
Rev copyrights to 2003.
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.139 2002/12/29 00:59:06 kjell Exp $</p>
d100 1
d812 18
d1488 1
a1488 1
	$OpenBSD: upgrade-minifaq.html,v 1.139 2002/12/29 00:59:06 kjell Exp $<br>
@


1.139
log
@Typo. Spotted by fensys@@evc.net
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.138 2002/12/26 19:53:48 miod Exp $</p>
d1469 2
a1470 2
	$OpenBSD: upgrade-minifaq.html,v 1.138 2002/12/26 19:53:48 miod Exp $<br>
	Copyright &copy; 1998-2002, Kjell Wooding.<br>
@


1.138
log
@Mention _spamd user; ok kjell@@
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.137 2002/12/15 15:19:55 nick Exp $</p>
d658 1
a658 1
      We want you to test snapshots, especially at beta-time, to 
d1469 1
a1469 1
	$OpenBSD: upgrade-minifaq.html,v 1.137 2002/12/15 15:19:55 nick Exp $<br>
@


1.137
log
@
Add dates to changes, help people figure out which are needed.  Cool idea
and patch from Sam Smith <S@@mSmith.net>, thanks!
"Oh yes, very good idea" henning@@
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.136 2002/12/03 07:14:11 mpech Exp $</p>
d99 1
d797 14
d1469 1
a1469 1
	$OpenBSD: upgrade-minifaq.html,v 1.136 2002/12/03 07:14:11 mpech Exp $<br>
@


1.136
log
@Broken link in "3.2.3: Important compiler changes".

miod@@ ok
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.135 2002/12/03 06:46:15 miod Exp $</p>
d696 1
a696 1
      3.2.1: New Perl
d716 1
a716 1
      3.2.2: New groups
d755 1
a755 1
      3.2.3: Important compiler changes
d1454 1
a1454 1
	$OpenBSD: upgrade-minifaq.html,v 1.135 2002/12/03 06:46:15 miod Exp $<br>
@


1.135
log
@Better upgrade instructions, the previous ones would fail during first
make build (but after libc was built).
Pointed out by various people.
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.134 2002/12/02 17:47:21 miod Exp $</p>
d789 1
a789 1
        <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config-local&amp;sektion=8"
d1454 1
a1454 1
	$OpenBSD: upgrade-minifaq.html,v 1.134 2002/12/02 17:47:21 miod Exp $<br>
@


1.134
log
@Document an appropriate upgrade procedure with the propolice changes (read:
the safest).
Once again, it's _way_ easier to upgrade with the snapshots, folks.

ok nick@@ henning@@
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.133 2002/12/02 16:02:07 pvalchev Exp $</p>
d776 12
a787 6
      <li>Run a regular <i>make build</i>. This will build and install a new
        libc, which will provide some support code required by the stack
	protection, before the compiler gets recompiled. Note that, if your
	compiler is too old, it will not be able to build libc. In this case,
	you'll have to do a binary upgrade from a snapshot.
      <li>After <i>make build</i> is finished, you can now recompile a kernel.
d791 1
a791 1
      <li>Reboot on the new kernel, and run a second <i>make build</i> to
a793 5

      You can actually save time by only recompiling and installing libc, and
      then gcc, instead of doing the first make build in the instructions
      above. However, this is more error-prone and can render your system
      unusable if not done carefully.
d1454 1
a1454 1
	$OpenBSD: upgrade-minifaq.html,v 1.133 2002/12/02 16:02:07 pvalchev Exp $<br>
@


1.133
log
@regen -> regenerate; Han Boetes
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.132 2002/12/02 16:00:42 henning Exp $</p>
d98 1
d753 42
d1453 1
a1453 1
	$OpenBSD: upgrade-minifaq.html,v 1.132 2002/12/02 16:00:42 henning Exp $<br>
@


1.132
log
@if you still need evidence that germans cannot type, look at this diff.
Han Boetes, Thanks.
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.131 2002/12/02 14:31:48 henning Exp $</p>
d1032 1
a1032 1
	  With libdl removed, regen your shared libraries cache:
d1410 1
a1410 1
	$OpenBSD: upgrade-minifaq.html,v 1.131 2002/12/02 14:31:48 henning Exp $<br>
@


1.131
log
@use less ancient version numbers in the cvs example

pointed out, motivated, inspired by margarida@@
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.130 2002/12/02 14:22:16 henning Exp $</p>
d190 1
a190 1
      <em>-current</em> it is stronly recommended to follow the
d193 1
a193 1
      the latest and greates faetures added.</p>
d1410 1
a1410 1
	$OpenBSD: upgrade-minifaq.html,v 1.130 2002/12/02 14:22:16 henning Exp $<br>
@


1.130
log
@rework the upgrade via snapshot section to mention and encourage boot floppy
useage.
pointed out by margarida@@

discussion, help, ok margarida@@ nick@@
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.129 2002/12/02 12:56:13 henning Exp $</p>
d522 1
a522 1
      between 2.8 and 2.9, do a:</p>
d526 1
a526 1
  # cvs diff -u -rOPENBSD_2_8 -rOPENBSD_2_9
d1410 1
a1410 1
	$OpenBSD: upgrade-minifaq.html,v 1.129 2002/12/02 12:56:13 henning Exp $<br>
@


1.129
log
@mention that one should read source-changes when running -current
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.128 2002/12/02 12:51:05 henning Exp $</p>
d658 1
a658 1
      And it is much less difficult that building the whole tree.
d662 4
a665 1
      Proceed like this:
d668 3
a670 13
    <ol>
      <li> Read the mini-upgrade faq and follow the steps that apply to what
           you want to upgrade to.</li>
      <li> Download the *32.tgz and bsd kernel from the snapshot that you
           want.</li>
      <li> Unpack etc32.tgz in <em>/var/tmp/temproot</em></li>

<pre>
  # tar pzxf etc32.tgz -C /var/tmp/temproot
</pre>

      <li> Unpack the other tarballs and the bsd kernel in /

d677 1
a677 1
  # mv /bsd /obsd
d680 1
d682 4
a685 3
      <li> Upgrade <a href="#1.9">/etc, /var and /dev</a> from <em>/var/tmp/temproot</em>
      <li> Reboot.
    </ol>
d1410 1
a1410 1
	$OpenBSD: upgrade-minifaq.html,v 1.128 2002/12/02 12:51:05 henning Exp $<br>
@


1.128
log
@update using snapshots; mostly from Han Boetes, Thanks!
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.127 2002/11/21 22:42:03 millert Exp $</p>
d189 5
a193 1
      version of -current) to the current tree.</p>
d1415 1
a1415 1
	$OpenBSD: upgrade-minifaq.html,v 1.127 2002/11/21 22:42:03 millert Exp $<br>
@


1.127
log
@use 0640 as the mode for consistency
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.126 2002/11/21 22:41:11 millert Exp $</p>
d88 3
d204 1
a204 1
    <a name="1.2"></a> 
d211 1
a211 1
      upgrade to the latest snapshot (usually, via an FTP install).
d646 43
d1411 1
a1411 1
	$OpenBSD: upgrade-minifaq.html,v 1.126 2002/11/21 22:41:11 millert Exp $<br>
@


1.126
log
@Rewrite the section on the new groups and add a bit about _radius.
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.125 2002/11/21 22:20:26 millert Exp $</p>
d700 1
a700 1
	  # chmod 640 /etc/spwd.db
d1365 1
a1365 1
	$OpenBSD: upgrade-minifaq.html,v 1.125 2002/11/21 22:20:26 millert Exp $<br>
@


1.125
log
@Document _token group and change shadow -> _shadow.
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.124 2002/11/21 21:31:14 millert Exp $</p>
d672 16
a687 7
    <p>Two new groups have been added. 
      The <em>_token</em> group controls read-only access to the
      token databases used by 
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tokeninit&amp;sektion=8">tokeninit(8)</a>,
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tokenadm&amp;sektion=8">tokenadm(8)</a>, and
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=login_token&amp;sektion=8">login_token(8)</a>.
      If you use token-based authentication you should do the following:
d689 5
a696 1
	</pre>
a697 3
      The shadow password database is now readable by the <em>_shadow</em> group.
      Before doing a &quot;make build&quot;, you must do the following:
	<pre>
d702 3
d1365 1
a1365 1
	$OpenBSD: upgrade-minifaq.html,v 1.124 2002/11/21 21:31:14 millert Exp $<br>
@


1.124
log
@Mention group shadow
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.123 2002/11/05 18:25:37 millert Exp $</p>
d94 1
a94 1
      <a href="#3.2.2">3.2.2: New <em>shadow</em> group</a><br>
d670 1
a670 1
      3.2.2: New <em>shadow</em> group
d672 7
a678 2
      The shadow password database is now readable by the <em>shadow</em> group.
      Before doing a &quot;make build&quot;, you should do the following:
d680 10
a689 2
	  # groupadd -g 65 shadow
	  # chgrp shadow /etc/spwd.db
a691 1
    <p>
d1352 1
a1352 1
	$OpenBSD: upgrade-minifaq.html,v 1.123 2002/11/05 18:25:37 millert Exp $<br>
@


1.123
log
@Mention that perl XS modules must be rebuilt
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.122 2002/11/05 13:23:50 henning Exp $</p>
d94 1
d668 14
d1340 1
a1340 1
	$OpenBSD: upgrade-minifaq.html,v 1.122 2002/11/05 13:23:50 henning Exp $<br>
@


1.122
log
@clarify that "latest source" means -current
@
text
@d15 1
a15 1
    <h2>Latest OpenBSD Release - 3.1</h2>
d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.121 2002/10/14 09:39:51 henning Exp $</p>
d90 6
d642 25
d1325 1
a1325 1
	$OpenBSD: upgrade-minifaq.html,v 1.121 2002/10/14 09:39:51 henning Exp $<br>
@


1.121
log
@few "use relative links for internal stuff"
horacio@@
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.120 2002/10/13 21:07:15 henning Exp $</p>
d233 7
d1294 1
a1294 1
	$OpenBSD: upgrade-minifaq.html,v 1.120 2002/10/13 21:07:15 henning Exp $<br>
@


1.120
log
@-gcc changes
From: Jolan Luff <jolan@@cryptonomicon.org>

-fbtab changes
got two diffs
From: Jolan Luff <jolan@@cryptonomicon.org>
From: Sebastian Stark <seb@@todesplanet.de>
both were i386 only.
nick@@ helped with making that arch-independant.

ok nick@@
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.119 2002/10/13 02:41:34 nick Exp $</p>
d523 1
a523 1
	<a href="http://www.openbsd.org/faq/upgrade-minifaq.html#1.12">1.12</a>
d526 1
a526 1
	<a href="http://www.openbsd.org/faq/upgrade-minifaq.html#1.13">1.13</a>
d846 1
a846 1
     <a href="http://www.openbsd.org/faq/upgrade-minifaq.html#1.8">1.8</a>
d1287 1
a1287 1
	$OpenBSD: upgrade-minifaq.html,v 1.119 2002/10/13 02:41:34 nick Exp $<br>
@


1.119
log
@
Target error on 3.1.7
spotted by Fery Wibowo Utomo (ferywu at artdico.or.id), thanks!
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.118 2002/10/09 10:21:30 henning Exp $</p>
d100 3
a104 1
    
d813 37
a849 1
	
d1287 1
a1287 1
	$OpenBSD: upgrade-minifaq.html,v 1.118 2002/10/09 10:21:30 henning Exp $<br>
@


1.118
log
@nat.conf/pf.conf merge
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.117 2002/09/15 16:16:59 nick Exp $</p>
d795 1
a795 1
    <a name="3.1.6"></a>
d1249 1
a1249 1
	$OpenBSD: upgrade-minifaq.html,v 1.117 2002/09/15 16:16:59 nick Exp $<br>
@


1.117
log
@
Typo, spotted by Steve Shockley <steve.shockley@@shockley.net>, thanks!
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.116 2002/09/13 13:20:11 henning Exp $</p>
d99 1
d795 17
d1249 1
a1249 1
	$OpenBSD: upgrade-minifaq.html,v 1.116 2002/09/13 13:20:11 henning Exp $<br>
@


1.116
log
@new user/group _x11
noticed by pb@@, nick@@ told me. don't try to understand that message path.
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.115 2002/08/17 10:37:41 henning Exp $</p>
d593 1
a593 1
      for portions of the filesystem may changes. An easy way to
d1231 1
a1231 1
	$OpenBSD: upgrade-minifaq.html,v 1.115 2002/08/17 10:37:41 henning Exp $<br>
@


1.115
log
@new users & groups in -current
ok pb@@, jufi@@
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.114 2002/07/21 08:37:56 horacio Exp $</p>
d655 1
d668 1
d1231 1
a1231 1
	$OpenBSD: upgrade-minifaq.html,v 1.114 2002/07/21 08:37:56 horacio Exp $<br>
@


1.114
log
@wrong link
extra "
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.113 2002/07/15 19:47:22 millert Exp $</p>
d93 1
a93 2
      <a href="#3.1.1">3.1.1: New users/groups: <em>sshd</em> and
      <em>authpf</em></a><br>
d633 1
a633 2
      3.1.1: New users/groups: <em>sshd</em> and
      <em>authpf</em>
d642 4
a645 1
      have been added to the system.  Add the following user entry using 
d650 5
d661 6
d1229 1
a1229 1
	$OpenBSD: upgrade-minifaq.html,v 1.113 2002/07/15 19:47:22 millert Exp $<br>
@


1.113
log
@Mention that atrun has been folded into cron.
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.112 2002/06/21 13:00:12 mpech Exp $</p>
d99 1
a99 1
      <a href="#3.1.5">3.1.6: atrun(8) no longer needed</a><br>
d640 1
a640 1
      <a href=""http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8"
d1217 1
a1217 1
	$OpenBSD: upgrade-minifaq.html,v 1.112 2002/06/21 13:00:12 mpech Exp $<br>
@


1.112
log
@Spotted by form@@:
o) fix /usr/obj/* recreation;
o) fix /usr/obj recreation (umount -> newfs -> mount);
o) fix chmod inside /var/at/ and /var/cron/;

kjell@@ ok
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.111 2002/06/13 04:39:24 kjell Exp $</p>
d99 1
d758 22
d1217 1
a1217 1
	$OpenBSD: upgrade-minifaq.html,v 1.111 2002/06/13 04:39:24 kjell Exp $<br>
@


1.111
log
@kafs.h removal was not necessary. Pointed out by art days ago.
I'm sober and rested now.
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.110 2002/06/10 20:40:11 kjell Exp $</p>
d246 1
a246 2
  # rm -rf /usr/obj
  # mkdir /usr/obj
d257 1
a257 1
  # umount /dev/wd0h                 (the /usr/obj partition)
d259 1
a259 1
  # mount -a
d270 1
a270 2
  # rm -rf /usr/obj
  # mkdir /usr/obj
d687 1
a687 1
  # chmod 0660 /var/at/at.{allow,deny} /var/cron/{allow,deny}
d1194 1
a1194 1
	$OpenBSD: upgrade-minifaq.html,v 1.110 2002/06/10 20:40:11 kjell Exp $<br>
@


1.110
log
@new addition from hin@@
Some cleanup. Add authpf group.
Note: If you are tracking -current right now, you are insane...
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.109 2002/06/09 10:01:45 kjell Exp $</p>
a35 1
     <blink>
a41 1
      </blink>
a98 1
      <a href="#3.1.6">3.1.6: kafs.h header moved</a>
a758 15
    <a name="3.1.6"></a>
    <h3>
      3.1.6: kafs.h header moved
    </h3>

    <p>
      The file /usr/include/kerberosIV/kafs.h has been moved to
      /usr/include/kerberosV/kafs.h. So to be sure you do not use the old one,
      please remove the old one by running:
    </p>

<pre>
  # rm /usr/include/kerberosIV/kafs.h
</pre>

d1196 1
a1196 1
	$OpenBSD: upgrade-minifaq.html,v 1.109 2002/06/09 10:01:45 kjell Exp $<br>
@


1.109
log
@Yes, I just committed a blink tag.
No, I don't care. Because NOBODY READS THIS PART ANYWAY!
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.108 2002/06/08 02:19:13 millert Exp $</p>
d95 2
a96 2
      <a href="#3.1.1">3.1.1: New <em>sshd</em> user and group</a><br>

a97 1

a98 1

d100 2
a101 2

      <a href="#3.1.5">3.1.5: New permissions for lp*</a>
d638 2
a639 1
      3.1.1: New <em>sshd</em> user and group
d642 4
a645 2
    <p>
      In support of
d655 1
a655 1
    <p>Also add the <em>sshd</em> group to /etc/group:</p>
d659 1
d728 6
a733 6
<p>
The old S/Key database file, <tt>/etc/skeykeys</tt>, has been replaced by
a directory, <tt>/etc/skey</tt>, where each record is an individual file
owned by the user it describes.  You can convert <tt>/etc/skeykeys</tt>
to the new format by running (as root):
</p>
d739 4
a742 2
Note that any third-party programs that utilize S/Key directly will need
to be recompiled.
d749 6
a754 6
<p>
The spool directories used by lpd must now be writable by group
daemon in order for lpr to be able to spool files.  Additionally,
the files within the spool directories must be owned by user and
group daemon.  This can be accomplished as follows:
</p>
d762 15
d1214 1
a1214 1
	$OpenBSD: upgrade-minifaq.html,v 1.108 2002/06/08 02:19:13 millert Exp $<br>
@


1.108
log
@Describe how to deal with lp* ownership changes.
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.107 2002/05/30 22:00:23 kjell Exp $</p>
d36 1
d38 1
a38 1
      If you are a beginner, or are not completely confident
d40 1
a40 1
      probably not for you. Try installing a binary release or snapshot
d43 1
d1195 1
a1195 1
	$OpenBSD: upgrade-minifaq.html,v 1.107 2002/05/30 22:00:23 kjell Exp $<br>
@


1.107
log
@Grammar, after prodding from several sources
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.106 2002/05/30 19:56:17 kjell Exp $</p>
d99 3
a101 1
      <a href="#3.1.4">3.1.4: New S/Key configuration</a>
d738 18
d1193 1
a1193 1
	$OpenBSD: upgrade-minifaq.html,v 1.106 2002/05/30 19:56:17 kjell Exp $<br>
@


1.106
log
@speeling. from Ted U
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.105 2002/05/30 05:49:15 kjell Exp $</p>
d625 1
a625 1
      reread the entirety of this document to catch any other things
d1173 1
a1173 1
	$OpenBSD: upgrade-minifaq.html,v 1.105 2002/05/30 05:49:15 kjell Exp $<br>
@


1.105
log
@add 'proc size mismatch' hint. Another good suggestion by S@@mSmith.net
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.104 2002/05/30 05:34:12 kjell Exp $</p>
d625 1
a625 1
      reread the entirity of this document to catch any other things
d1173 1
a1173 1
	$OpenBSD: upgrade-minifaq.html,v 1.104 2002/05/30 05:34:12 kjell Exp $<br>
@


1.104
log
@add warning for beginners. suggestion by S@@mSmith.net
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.103 2002/05/27 05:14:55 kjell Exp $</p>
d59 1
a59 1
	it.</a><br>
d84 4
d232 1
a232 1
    <h3>1.5: Okay, I have the tree. How do I build it.</h3>
d612 17
d1173 1
a1173 1
	$OpenBSD: upgrade-minifaq.html,v 1.103 2002/05/27 05:14:55 kjell Exp $<br>
@


1.103
log
@The old IPFilter config files can go. from amonk@@backwatcher.com
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.102 2002/05/17 18:21:47 millert Exp $</p>
d35 9
d1152 1
a1152 1
	$OpenBSD: upgrade-minifaq.html,v 1.102 2002/05/17 18:21:47 millert Exp $<br>
@


1.102
log
@Move S/Key info to correct section.
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.101 2002/05/17 17:46:46 millert Exp $</p>
d954 5
d1143 1
a1143 1
	$OpenBSD: upgrade-minifaq.html,v 1.101 2002/05/17 17:46:46 millert Exp $<br>
@


1.101
log
@Fix csh snippet to fix crontab users; noticed by brad@@
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.100 2002/05/17 16:29:36 millert Exp $</p>
d687 19
a729 19
    <a name="3.1.4"></a>
    <h3>
      3.1.4: New S/Key configuration
    </h3>

<p>
The old S/Key database file, <tt>/etc/skeykeys</tt>, has been replaced by
a directory, <tt>/etc/skey</tt>, where each record is an individual file
owned by the user it describes.  You can convert <tt>/etc/skeykeys</tt>
to the new format by running (as root):
</p>
<pre>
  # skeyinit -C
  # mv /etc/skeykeys /etc/skeykeys.OLD
</pre>

Note that any third-party programs that utilize S/Key directly will need
to be recompiled.

d1138 1
a1138 1
	$OpenBSD: upgrade-minifaq.html,v 1.100 2002/05/17 16:29:36 millert Exp $<br>
@


1.100
log
@Add S/Key conversion info; kjell@@ OK
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.99 2002/05/16 22:42:14 naddy Exp $</p>
d658 2
a659 1
 	  chown $f.crontab $f
d1138 1
a1138 1
	$OpenBSD: upgrade-minifaq.html,v 1.99 2002/05/16 22:42:14 naddy Exp $<br>
@


1.99
log
@Upgrading from 3.1:
* Insert entry for new sshd user and group.
* Add "make obj" step to binutils entry.

ok kjell@@
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.98 2002/05/15 06:09:28 kjell Exp $</p>
d84 3
a86 1
      <a href="#3.1.3">3.1.3: New Binutils</a>
d700 1
d710 19
d1137 1
a1137 1
	$OpenBSD: upgrade-minifaq.html,v 1.98 2002/05/15 06:09:28 kjell Exp $<br>
@


1.98
log
@clean up markup. Add reference to new binutils (nudge by miod)
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.97 2002/05/14 20:34:51 kjell Exp $</p>
d80 1
a80 1
      <a href="#3.1.1">3.1.1: New group for crontab(1) and at(1)</a><br>
d82 3
a84 1
      <a href="#3.1.2">3.1.2: New Binutils</a>
d604 23
a626 1
      3.1.1: New group for crontab(1) and at(1)
d665 1
a665 1
    <a name="3.1.2"></a>
d667 1
a667 1
      3.1.2: New Binutils
d678 1
d1115 1
a1115 1
	$OpenBSD: upgrade-minifaq.html,v 1.97 2002/05/14 20:34:51 kjell Exp $<br>
@


1.97
log
@Move 2.8 to upgrade-old and make that page conform to the new anchor style
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.96 2002/05/13 22:45:04 millert Exp $</p>
d81 2
d84 1
d619 1
a619 1
crontab:*:66:
d622 1
d625 2
a626 1
      by hand (assumes /bin/csh):
d629 5
a633 5
# chgrp crontab /var/at/at.{allow,deny} /var/cron/{allow,deny}
# chmod 0660 /var/at/at.{allow,deny} /var/cron/{allow,deny}
# foreach f ( /var/cron/tabs/* )
	chown $f.crontab $f
  end
d636 1
d639 19
d673 8
a680 8
      <pre>
	# cd /usr/src/usr.sbin/mtree
	# make cleandir
	# make obj
	# make depend
	# make
	# make install
      </pre>
d1090 1
a1090 1
	$OpenBSD: upgrade-minifaq.html,v 1.96 2002/05/13 22:45:04 millert Exp $<br>
@


1.96
log
@document crontab/at changes; kjell@@ ok
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.95 2002/03/08 05:40:29 kjell Exp $</p>
a110 10
    <h2>Upgrading from 2.8</h2>
    
    <p>
      <a href="#2.8.1">2.8.1: New <em>auth</em> group</a><br>

      <a href="#2.8.2">2.8.2: New <em>wscons</em> console system</a><br>

      <a href="#2.8.3">2.8.3: Kernel compile fails with undefined
	symbols</a><br>
    </p>
d114 1
a114 1
    <p>Information on upgrading from OpenBSD 2.3 to 2.7 
a1059 59
    <a name="2.8"></a> 
    <h2>Upgrading from 2.8</h2>


    <a name="2.8.1"></a> 
    <h3>2.8.1: New <em>auth</em> group</h3>

    <p>A new group, <em>auth</em>, gid 11, has been added to the
      system. Add a line like the following to your
      <tt>/etc/group</tt>:</p>

<pre>
  auth:*:11:
</pre>

    <a name="2.8.2"></a> 
    <h3>2.8.2: New <em>wscons</em> console system</h3>

    <p>The <em>pcvt</em> console driver has been replaced with the
      <em>wscons</em> console system. Before using wscons, you will
      need to create the new wscons-related devices. Ensure you have
      the latest MAKEDEV installed, then make all devices:</p>

<pre>
 # cp /usr/src/etc/etc.i386/MAKEDEV /dev/MAKEDEV
 # cd /dev
 # ./MAKEDEV all
</pre>

    <p>If you are running X, change the Pointer section of your
      <em>XF86Config</em> file to contain the following:</p>

<pre>
    Protocol    "wsmouse"
    Device      "/dev/wsmouse"
</pre>

    <a name="2.8.3"></a> 
    <h3>2.8.3: Kernel compile fails with undefined symbols</h3>

    <p><a href=
    "http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;apropos=0&amp;sektion=8&amp;manpath=OpenBSD+Current&amp;arch=i386&amp;format=html">
	config(8)</a> has been updated. Building with the old
      <em>config</em> will result in errors like:</p>
<pre>
  Undefined symbol `_pdevnames_size' referenced
  Undefined symbol `_pdevnames' referenced
</pre>

    <p>To correct this, compile and install the new
      <em>config</em>:</p>
<pre>
  # cd /usr/src/usr.sbin/config
  # make clean &amp;&amp; make depend &amp;&amp; make
  # make install
</pre>

    <p>Now, recompile a new kernel as before.</p>

d1065 1
a1065 1
	$OpenBSD: upgrade-minifaq.html,v 1.95 2002/03/08 05:40:29 kjell Exp $<br>
@


1.95
log
@remind people to change rc files for new ssh location
@
text
@d15 1
a15 1
    <h2>Latest OpenBSD Release - 3.0</h2>
d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.94 2002/03/04 21:23:13 millert Exp $</p>
d77 6
d602 42
d1134 1
a1134 1
	$OpenBSD: upgrade-minifaq.html,v 1.94 2002/03/04 21:23:13 millert Exp $<br>
@


1.94
log
@Have to update mtree since etc/mtree/4.4BSD.dist uses the new 'preserve'
option.
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.93 2002/02/14 19:07:46 mpech Exp $</p>
a617 1
    </p>
d704 1
d706 9
a714 2
      And update HostKey lines in your sshd_config to reflect the change.
      For example:
d719 3
a721 1
      line should be changed to:
d1086 1
a1086 1
	$OpenBSD: upgrade-minifaq.html,v 1.93 2002/02/14 19:07:46 mpech Exp $<br>
@


1.93
log
@ssh* -> ssh*_* in #3.0.3. Spotted by grange@@grange.ru

deraadt@@, pval@@ ok
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.92 2002/02/14 18:47:15 mpech Exp $</p>
d80 4
a83 5
      <a href="#3.0.1">3.0.1: Removal of libdl on ELF
	platforms</a><br>
      
      <a href="#3.0.2">3.0.2: New regression framework</a><br>
      <a href="#3.0.3">3.0.3: ssh config files moved to /etc/ssh/</a><br>
d603 20
a622 1
      3.0.1: Removal of libdl on ELF platforms
d664 1
a664 1
    <a name="3.0.2"></a>
d666 1
a666 1
      3.0.2: New regression framework
d680 1
a680 1
    <a name="3.0.3"></a>
d682 1
a682 1
      3.0.3: ssh config files moved to /etc/ssh/
a720 1

d1077 1
a1077 1
	$OpenBSD: upgrade-minifaq.html,v 1.92 2002/02/14 18:47:15 mpech Exp $<br>
@


1.92
log
@Improve examples:
o) $ -> #
o) remove sudo

kjell@@ ok
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.91 2002/02/13 21:40:39 pvalchev Exp $</p>
d681 1
a681 1
      Move your /etc/ssh* files into the newly created /etc/ssh/ directory:
d685 1
a685 1
  # mv ssh* ssh/
d1060 1
a1060 1
	$OpenBSD: upgrade-minifaq.html,v 1.91 2002/02/13 21:40:39 pvalchev Exp $<br>
@


1.91
log
@fix some html in my last changes; thanks horacio
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.90 2002/02/12 21:09:31 pvalchev Exp $</p>
d355 2
a356 2
# cd /usr/src
# make -n build
d430 11
a440 11
  $ rm -r /usr/obj/gnu/egcs/gcc/*
  $ cd /usr/src/gnu/egcs/gcc
  $ make -f Makefile.bsd-wrapper clean
  $ make -f Makefile.bsd-wrapper obj
  $ make -f Makefile.bsd-wrapper depend
  $ make -f Makefile.bsd-wrapper 
  $ sudo make -f Makefile.bsd-wrapper install
  $ make -f Makefile.bsd-wrapper clean
  $ make -f Makefile.bsd-wrapper depend
  $ make -f Makefile.bsd-wrapper 
  $ sudo make -f Makefile.bsd-wrapper install
d449 8
a456 8
  $ cd /usr/src/gnu/egcs/gcc
  $ make -f Makefile.bsd-wrapper clean
  $ make -f Makefile.bsd-wrapper obj
  $ make -f Makefile.bsd-wrapper -DBOOTSTRAP
  $ sudo make -f Makefile.bsd-wrapper -DBOOTSTRAP install
  $ make -f Makefile.bsd-wrapper clean
  $ make -f Makefile.bsd-wrapper
  $ sudo make -f Makefile.bsd-wrapper install
d617 2
a618 2
  $ cd /usr/src
  $ make build
d658 2
a659 2
  $ cd /usr/src/share/mk
  $ sudo make install
d676 2
a677 2
  $ cd /usr/src
  $ make build
d786 3
a788 3
  $ cd /dev
  $ sudo cp /usr/src/etc/etc.`machine`/MAKEDEV ./
  $ sudo ./MAKEDEV all
d834 2
a835 2
  $ cd /usr/src/share/mk
  $ sudo make install
d841 3
a843 3
  $ cd /usr/src/usr.bin/make
  $ make clean &amp;&amp; make obj &amp;&amp; make depend &amp;&amp; make
  $ sudo make install
d863 7
a869 7
  $ cd /usr/src/kerberosV
  $ sudo make obj
  $ cd lib/roken
  $ sudo make 
  $ cd ../../usr.bin/asn1_compile
  $ sudo make
  $ sudo make install
d917 2
a918 2
  $ cd /usr/src/gnu/usr.sbin/sendmail
  $ make clean &amp;&amp; make obj &amp;&amp; make depend &amp;&amp; make &amp;&amp; sudo make install
d1048 3
a1050 3
  $ cd /usr/src/usr.sbin/config
  $ make clean &amp;&amp; make depend &amp;&amp; make
  $ sudo make install
d1060 1
a1060 1
	$OpenBSD: upgrade-minifaq.html,v 1.90 2002/02/12 21:09:31 pvalchev Exp $<br>
@


1.90
log
@/etc/ssh/ move
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.89 2002/02/02 05:17:18 chris Exp $</p>
d669 1
a669 1
      <a href="http://www.openbsd.org/faq/upgrade-minifaq.html#1.13">1.13</a>
d674 1
a678 1
    </p>
d682 1
d687 1
d690 1
a697 1
    </p>
d1060 1
a1060 1
	$OpenBSD: upgrade-minifaq.html,v 1.89 2002/02/02 05:17:18 chris Exp $<br>
@


1.89
log
@Remove more -A from cvs examples.
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.88 2002/01/17 17:49:39 kjell Exp $</p>
d84 1
d604 1
a604 1
      Removal of libdl on ELF platforms
d662 39
d1058 1
a1058 1
	$OpenBSD: upgrade-minifaq.html,v 1.88 2002/01/17 17:49:39 kjell Exp $<br>
@


1.88
log
@that was dumb. 3.0-current instructions got lost in the split.
Thanks nick@@wanadoo.be
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.87 2002/01/17 06:21:44 kjell Exp $</p>
d212 1
a212 1
  # cvs -q get -PA src
d528 1
a528 1
  # cvs -q -d anoncvs@@some.anon.server:/cvs up -PAd
d1018 1
a1018 1
	$OpenBSD: upgrade-minifaq.html,v 1.87 2002/01/17 06:21:44 kjell Exp $<br>
@


1.87
log
@Add some more general tips on upgrading /etc
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.86 2002/01/17 05:21:58 kjell Exp $</p>
d596 65
d1018 1
a1018 1
	$OpenBSD: upgrade-minifaq.html,v 1.86 2002/01/17 05:21:58 kjell Exp $<br>
@


1.86
log
@The minifaq was getting out of hand, so:
Split out the old entries, change the numbering scheme,
and rearrange so the latest stuff is at the top.
@
text
@d21 1
a21 1
	$OpenBSD: upgrade-minifaq.html,v 1.84 2002/01/14 22:49:17 kjell Exp $</p>
d102 1
d496 22
d953 1
a953 1
	$OpenBSD: upgrade-minifaq.html,v 1.84 2002/01/14 22:49:17 kjell Exp $<br>
@


1.85
log
@BIG update of the HTML (it now validates), in prep for splitting this in two.
@
text
@d2 1
d4 224
a227 401
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <title>OpenBSD Upgrading Mini-FAQ</title>
</head>
<body bgcolor="#FFFFFF" text="#000000" link="#23238E">


<h1>MINI-FAQ: Upgrading OpenBSD</h1>
<h2>Latest OpenBSD Release - 3.0</h2>

<address>
<p>
Kjell Wooding 
&lt;<a href="mailto:kjell@@openbsd.com">kjell@@openbsd.org</a>&gt; <br />
Updated:
$OpenBSD: upgrade-minifaq.html,v 1.84 2002/01/14 22:49:17 kjell Exp $
</p>
</address>

<br />

<blockquote>
<p>
If you've ever tried compiling the <em>-current</em> sources from an older
OpenBSD release, you're aware that the process isn't always
straightforward. This Mini-FAQ is
an attempt to address the most common issues encountered when upgrading
between OpenBSD releases, or from the releases to <em>-current</em>.
Though hardly <em>Mini</em> anymore, this document retains the Mini-FAQ
moniker for historical and/or consistency reasons.
</p>
</blockquote>


<h2>1.0: General Upgrade Questions</h2>

<p>
<a href="#1.1">
1.1: Terminology. What is <em>-current</em>? What are Snapshots? What is
<em>-stable</em>?
</a> <br />

<a href="#1.2">
1.2: What is the easiest way to upgrade to <em>-current</em>?
</a> <br />

<a href="#1.3">
1.3: I looked, but didn't see any snapshots on the FTP site. Where did
they go?
</a> <br />

<a href="#1.4">
1.4: How do I get the latest source?
</a> <br />

<a href="#1.5">
1.5: Okay, I have the tree. How do I build it.
</a> <br />

<a href="#1.6">
1.6: My make build stopped halfway. Do I have to redo the whole thing?
</a> <br />

<a href="#1.7">
1.7: I'm getting errors during the build. What do I do?
</a> <br />

<a href="#1.8">
1.8: I'm upgrading to a newer version of the compiler (<em>gcc</em>). Is there a
standard way of bootstrapping it?
</a> <br />

<a href="#1.9">
1.9: What is the best way to upgrade <tt>/etc</tt>, <tt>/var</tt>,
and <tt>/dev</tt>?
</a> <br />

<a href="#1.10">
1.10: How do I clean all the cruft out of my existing source tree?
</a> <br />

<a href="#1.11">
1.11: Do I have to be root to do a <em>make build</em>?
</a> <br />

<a href="#1.12">
1.12: Why am I not seeing any new devices?
</a> <br />

<a href="#1.13">
1.13: Is there an easy way to make all the file hierarchy changes?
</a> <br />
</p>

<h2>2.0: Upgrading from 2.3</h2>

<p>
<a href="#2.1">
2.1: What are the major problems upgrading from 2.3 to 2.4?
</a> <br />

<a href="#2.2">
2.2: I tried the build, but it failed when trying to compile <em>ssleay</em>.
</a> <br />

<a href="#2.3">
2.3: I tried the build, but it failed when trying to make something for the
PowerPC.
</a> <br />
</p>

<h2>3.0: Upgrading from 2.4</h2>

<p>
<a href="#3.1">
3.1: What are the major problems upgrading from 2.4 to 2.5?
</a> <br />
<a href="#3.2">
3.2: I tried the build, but it failed on cap_mkdb.
</a> <br />
</p>

<h2>4.0: Upgrading from 2.5</h2>

<p>
<a href="#4.1">
4.1: What are the major problems upgrading from 2.5 to 2.6?
</a> <br />
<a href="#4.2">
4.2: How do I upgrade <em>gcc</em> to <em>egcs</em>
</a>
</p>

<blockquote>
<p>
<a href="#4.2.1">4.2.1 - i386 and sparc are no longer #define'ed </a><br />
<a href="#4.2.2">4.2.2 - Build fails in xlint </a><br />
<a href="#4.2.3">4.2.3 - Core Dump on uthread_autoinit.c </a><br />
<a href="#4.2.4">4.2.4 - egcs seems much slower than gcc </a><br />
<a href="#4.2.5">4.2.5 - egcs generates larger code than gcc </a><br />
<a href="#4.2.6">4.2.6 - After installing egcs I have very little disk space 
left </a><br />
<a href="#4.2.7">4.2.7 - My build fails to build libcurses</a><br />
<a href="#4.2.8">4.2.8 - make obj fails</a>
</p>
</blockquote>

<p>
<a href="#4.3">
4.3: My <em>make build</em> dies with <em>unimplemented syscall</em> errors.
</a> <br />

<a href="#4.4">
4.4: Link to the new 2.6 directory.
</a> <br />

<a href="#4.5">
4.5: After an <strong>(U)</strong>pgrade, extraction of <em>base26.tar.gz</em>
fails with a message.
</a>
</p>

<h2>5.0 - Upgrading from 2.6</h2>

<p>
<a href="#5.1">
5.1: Termcap entries are too long.
</a> <br />

<a href="#5.2">
5.2: My <em>pn</em> (or <em>mx</em>, <em>al</em>, <em>ax</em>) device
is no longer recognized by the kernel.
</a> <br />

<a href="#5.3">
5.3: Upgrading gcc 2.95.1 to 2.95.2
</a> <br />

<a href="#5.4">
5.4: Upgrading Kerberos.
</a> <br />

<a href="#5.5">
5.5: Upgrading M4.
</a> <br />

<a href="#5.6">
5.6: Upgrading Sendmail.
</a> <br />

<a href="#5.7">
5.7: After upgrading, kernels that include 
<em>apm(8)</em> support no longer boot.
</a> <br />
</p>

<h2>6.0 - Upgrading from 2.7</h2>

<p>
<a href="#6.1">
6.1: What are the major problems upgrading from 2.7 to 2.8?
</a> <br />
</p>

<h2>7.0 - Upgrading from 2.8</h2>

<p>
<a href="#7.1">
7.1: New auth group
</a> <br />

<a href="#7.2">
7.2: New wscons console system
</a> <br />

<a href="#7.3">
7.3: Kernel compile fails with undefined symbols
</a> <br />

</p>

<h2>8.0 - Upgrading from 2.9</h2>
<p>
<a href="#8.1">
8.1: New users/groups - <em>proxy</em>, <em>smmsp</em> and <em>popa3d</em>
</a>
<br>

<a href="#8.2">
8.2: New packet filter: <em>pf</em>
</a>
<br>

<a href="#8.3">
8.3: Changes to <em>make</em>
</a>
<br>

<a href="#8.4">
8.4: Build fails because of KerberosV errors
</a>
<br>

<a href="#8.5">
8.5: New sendmail version
</a>
<br>

<a href="#8.6">
8.6: /etc/primes Moved
</a>

</p>

<h2>9.0 - Upgrading from 3.0</h2>
<p>
<a href="#9.1">
9.1: Removal of libdl on ELF platforms
</a>
<br>

<a href="#9.2">
9.2: New regression framework
</a>
<br>

</p>

&nbsp;<hr width="30%">

<a name="1.0"></a>
<h2>1.0: General Upgrade Questions</h2>


<a name="1.1"></a>
<h3>
1.1: Terminology. What is <em>-current</em>? What are Snapshots? What is
<em>-stable</em>?
</h3>

<p>
Prior to OpenBSD 2.7, OpenBSD development happened from a single, 
unbranched source tree. As of 2.7, a patch branch was introduced.
</p>

<p>
At approximately
six-month intervals, OpenBSD <em>releases</em> are produced. These are
numbered in the conventional (2.x, 3.x) manner. The current OpenBSD release is
indicated at the top of this document. 
</p>

<p>
<em>-current</em>, short for <em>openbsd-current</em>, refers to the
up-to-the-minute
version of the source tree contained in the CVS repository. This is the tree 
most commonly used by OpenBSD developers. The <em>-current</em> tree contains
all the code that is planned for the next release. From time to time,
brave souls will abandon the formal releases and run openbsd-current, usually
to take advantage of features that have not yet made it into the
formal releases. Because of its uncertain nature, however, upgrading
to <em>-current</em> is not recommended for non-technical users.
</p>

<p>
Between formal releases, a series of <em>snapshot</em> releases are 
<a href="ftp://ftp.openbsd.org/pub/OpenBSD/snapshots/"> made available.</a> 
Snapshots are test releases of the <em>-current</em> source tree. 
Because they reflect the current state of development, 
there is no guarantee that snapshot releases will
work correctly (or even at all). Snapshots are quite useful when moving
from a formal release (or older version of -current) to the current tree.
</p>

<p>
As of OpenBSD 2.7, a <a href="../stable.html">patch branch</a> (called
<em>-stable</em>) was introduced.  This branch contains the base
release, and any important patches or fixes (important being the
errata patches, plus others that are obvious and simple, but do not
deserve an errata entry).
</p>

<p>
The <a href="../ports.html">ports tree</a> is an integral part of the
system. You should upgrade the ports tree at the same time as the rest
of the system, following the same rules as for upgrading everything
else; i.e., you should run -stable ports on a -stable system, 
and -current ports only on a -current system.
</p>

<a name="1.2"></a>
<h3>
1.2: What is the best way to upgrade to <em>-current</em>?
</h3>

<p>
Due to changes in the underlying libraries, moving directly from 
a release to <em>-current</em> is not always easy. 
The most painless way to
move up to <em>-current</em> is to first upgrade to the latest snapshot
(usually, via an FTP install). Once the snapshot is installed, the
latest source can be <a href="#1.4">fetched</a> and 
<a href="#1.5">built</a>. This
procedure should eliminate most toolchain and library problems.
</p>

<a name="1.3"></a>
<h3>
1.3: I looked, but didn't see any snapshots on the FTP site. Where did
they go?
</h3>

<p>
Snapshots may be removed as they become old (or no longer relevant).
If no snapshot is available, you should upgrade to the most recent
release and build the remainder of the way from source.
</p>

<a name="1.4"></a>
<h3>
1.4: How do I get the latest source?
</h3>

<p>
Short answer:
<a href="../anoncvs.html">http://www.openbsd.org/anoncvs.html</a>
</p>

<p>
For example. To retrieve the entire tree via CVS:
(using the ksh shell. Others substitute <em>setenv</em> for <em>export</em>)
</p>

<pre>
# export CVSROOT=anoncvs@@anoncvs.ca.openbsd.org:/cvs
# export CVS_RSH=/usr/bin/ssh
# cd /usr
# cvs -q get -PA src
</pre>

<a name="1.5"></a>
<h3>
1.5: Okay, I have the tree. How do I build it.
</h3>

<p>
Basic instructions are in
<a href="http://www.openbsd.org/cgi-bin/cvsweb/src/Makefile">
<tt>/usr/src/Makefile</tt></a>. This is a slightly expanded
version.
</p>

<ol>

<li>
<p> Clean out the old object files.</p>

<p>
If you created a separate /usr/obj directory, clean that, and
rebuild the symbolic links:
</p>
d236 4
a239 5
<p>
If you find yourself performing this step a lot, you may find it faster
to place /usr/obj onto its own partition, and use <em>newfs</em> instead 
of <em>rm</em>. For example, I do a:
</p>
d248 2
a249 4
<p>
If you're worried there are object files in your source tree, 
do this:
</p>
d260 14
a273 18
</li>

<li>
<p>
Perform any version-specific configuration changes. For example, 
2.3 users must add the <em>named</em> user and group before
moving to 2.4 or later. See the specific Mini-FAQ section for 
your version.
</p>
</li>

<li>
<p>
Make sure all the appropriate directories are created. This
is especially important when upgrading from older versions, but is
sometimes necessary in other cases. The easiest way to do this is:
</p>

a276 1
</li>
d278 1
a278 2
<li>
<p>Compile a new kernel.</p>
d280 2
d286 1
a286 2
<p>Most users will want to use GENERIC:</p>

d292 4
a295 7
<p>
<strong>NOTE:</strong> The truly masochistic in the crowd may want
to compile a custom kernel instead. In these cases, it's usually best
to start with GENERIC and trim from there. Do the following procedure
instead:
</p>

d304 1
a304 4
<p>
In either case, 
</p>

d312 1
a312 4
</li>

<li>
<p>Compile the system.</p>
d314 2
d320 1
a320 8
</li>

<li>

<p>Update <tt>/etc</tt> and <tt>/dev</tt> by hand. These are not updated 
automatically. Choose a directory with enough space to 
hold /, /dev, /var, and /etc. Here I'll use <em>/home/newroot</em> 
</p>
d322 5
d333 3
a335 6
<p>
Now compare the files in /home/newroot with their 
installed counterparts. Replace or update the files as 
necessary.
</p>

d339 1
a339 1
</li>
d341 8
a348 13
<li>
<p> Reboot to make sure the new /etc files are correct </p>
</li>
</ol>

<a name="1.6"></a>
<h3>
1.6: My make build stopped halfway. Do I have to redo the whole thing?
</h3>

<p>
I would, but if you really want to pick up where you left off, do a:
</p>
d350 2
d357 2
a358 4
<p>
This will show you what make build is doing. For example, mine tells me:
</p>

d367 1
a367 1
  e -f Makefile.bsd-wrapper depend &amp;&amp;  make -f Makefile.bsd-wrapper perl.lib &amp;&amp;
d372 54
a425 72
<p>
To pick up where you left off, just reissue the commands from the point
where the compile died.
</p>

<p>
If you do this procedure a lot, you may want to create a new target in your
makefile. Simply copy the entry for <em>build</em> (to 
<em>build-noclean</em>, for example), and remove the <em>make cleandir</em> 
reference.
</p>

<a name="1.7"></a>
<h3>
1.7: I'm getting errors during the build. What do I do?
</h3>

<p>
If your <em>make build</em> ends with an error, chances are it is
because you failed to delete your old objects before rebuilding.
See <a href="#1.5">1.5</a> for details on cleaning out these objects.
</p>

<p>
If you are sure your tree is clean of old object cruft, and you are
still receiving a build error, one of three things has probably happened:
</p>

<ol>
<li>
You have encountered a known upgrade issue. Make sure you have
read the appropriate section of this document, and followed the instructions
there carefully.
</li>

<li>
You have encountered a new upgrade issue. This is life on the bleeding
edge. Search recent postings to
<a href="../mail.html">misc@@ and tech@@</a>
for possible workarounds.
</li>

<li>
Someone has temporarily broken the source tree. This type of break
is pretty rare, and is usually fixed immediately. Try waiting a few hours, and
re-fetching the source tree. If you can't wait, try fetching a tree from
a day or two beforehand.
</li>
</ol>

<p>
If you have tried all of the alternatives above, and your problem persists
for more than a couple of days, post your problem to misc@@openbsd.org.
Make sure to include the relevant error messages,
and any peculiarities of your setup.
</p>

<a name="1.8"></a>
<h3>
1.8: I'm upgrading to a newer version of the compiler
(<em>gcc</em>). Is there a standard way of bootstrapping it?
</h3>

<p>
Because upgrading a compiler is a bit of a chicken-and-egg problem,
changes to the in-tree compiler require a little extra attention.
In general, you'll want to perform the following procedure:
</p>

<p>
(and yes, you are building it twice)
</p>
d441 4
a444 8
<p>
And then run a normal <em>make build</em>.
</p>

<p>
You may be able to speed this process up by using the
BOOTSTRAP procedure:
</p>
d457 15
d473 2
a474 27
<a name="1.9"></a>
<h3>
1.9: What is the best way to upgrade <tt>/etc</tt>, <tt>/var</tt>,
and <tt>/dev</tt>?
</h3>

<p>
<strong>Short Answer</strong>: By Hand.
</p>

<p>
<strong>Long answer</strong>:
</p>

<p>
As a policy, software in the OpenBSD tree does not modify files in
<tt>/etc</tt> automatically. This means it is <em>always</em> up to
the administrator to make the necessary modifications there. Upgrades
are no exception. To update files in these directories, first determine
what changes have occurred to the base (distribution) files, and then
manually reapply these changes.
</p>

<p>
For example, to see the files in the tree that have changed most recently,
do a:
</p>
d481 4
a484 5
<p>
To see all the changes in <tt>/etc</tt> between arbitrary versions of
OpenBSD, you can use <a href="../anoncvs.html">CVS</a>. For example, 
to see the changes between 2.8 and 2.9, do a:
</p>
d491 11
a501 15
<p>
Once you have identified the changes, reapply them to your
local tree, preserving any local configuration you may have done.
</p>

<a name="1.10"></a>
<h3>
1.10: How do I clean all the cruft out of my existing source tree?
</h3>

<p>
The most important thing you can do is to clean out your obj
directories. Here's a procedure to update source and kill any leftover
objects:
</p>
d512 32
a543 44
<p>
If you're still having trouble, you may want to try adding
<tt>-I ! -I CVS -I obj</tt> to your CVS updates. This will identify any
extra cruft in your source tree.
</p>

<a name="1.11"></a>
<h3>
1.11: Do I have to be root to do a <em>make build</em>?
</h3>

<p>
Though certain steps of the make build process require root
privileges, the build process includes hooks to the 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sudo&amp;apropos=0&amp;sektion=8&amp;manpath=OpenBSD+Current&amp;arch=i386&amp;format=html">sudo(8)</a>
command that make this process relatively painless.
</p>

<p>
If your <tt>/etc/sudoers</tt> file is configured correctly, 
you can use the sudo hooks in the following manner:
</p>

<ul>
<li>
Place SUDO=/usr/bin/sudo in your environment prior to starting the build,
or
</li>
<li>
Add the line "SUDO=/usr/bin/sudo" to your <tt>/etc/mk.conf</tt> file.
</li>
</ul>

<a name="1.12"></a>
<h3>
1.12: Why am I not seeing any new devices?
</h3>

<p>
The <tt>/dev/MAKEDEV</tt> script is not updated automatically
as part of the <em>make build</em> process. As a general rule, it
is a good idea to copy and run this script from your source tree when
performing an upgrade:
</p>
d551 12
a562 18
<a name="1.13"></a>

<h3>
1.13: Is there an easy way to make all the file hierarchy changes?
</h3>

<p>
From time to time, files or directories are added to, or removed from
the file hierarchy. Also, ownership information for portions of the
filesystem may changes.  An easy way to ensure that your file hierarchy
is up-to-date is to use the
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mtree&amp;sektion=8"
>mtree(8)</a> utility. 
</p>

<p>
First, fetch the latest source, then do the following:
</p>
d571 1
a571 1116
<p>
Your file hierarchy should now be up to date.
</p>

<a name="2.0"></a>
<h2>2.0: Upgrading from 2.3</h2>

<a name="2.1"></a>
<h3>
2.1: What are the major problems upgrading from 2.3 to 2.4?
</h3>

<h4>New User: <em>named</em></h4>

<p>
After 2.3, the <em>named</em> DNS daemon was moved to a chroot jail.
To make this change possible, the <em>named</em> user was created.
If you do not have it already, you will need to create this user to
ensure that all directories get created properly during the build process.
</p>

<p>
Add the following entry to /etc/passwd using <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>:
</p>

<pre>
named:*:70:70::0:0:BIND Daemon:/var/named:/sbin/nologin
</pre>

<p>
Add the following to /etc/group:
</p>

<pre>
named:*:70:
</pre>


<a name="2.2"></a>
<h3>
2.2: I tried the build, but it failed when trying to compile <em>ssleay</em>.
</h3>

<p>
You are likely missing an entry for the <em>named</em> user in your
password file.
</p>

<p>
<strong>Short Answer:</strong>
</p>

<p>
Create this user prior to the build.
</p>

<p>
<strong>Long Answer:</strong>
</p>

<p>
The <em>named</em> user is required in order to set permissions
correctly.  If this user is missing, part of the build process fails.
If you capture your build to a file (say, with a <em>make build
&amp;&gt;/tmp/build.log</em>) you will notice the following message:
</p>

<pre>
(cd /usr/src/etc &amp;&amp; make DESTDIR=/ distrib-dirs)
install -d -o root -g wheel -m 755 /
mtree -def mtree/4.4BSD.dist -p // -u

mtree: unknown user named
mtree: failed at line 1632 of the specification
*** Error code 1 (ignored)
</pre>

<p>
Unfortunately for us, the build continued happily on its way,
totally ignoring the fact that an error occurred.
</p>

<p>
If the <em>named</em> user exists, mtree works properly:
</p>

<pre>
missing: ./var/named (created)
missing: ./var/named/dev (created)
missing: ./var/named/etc (created)
missing: ./etc/afs (created)
missing: ./etc/ssl (created)
missing: ./etc/ssl/private (created)
missing: ./usr/obj (not created: File exists)
missing: ./usr/share/doc/html (created)
missing: ./usr/share/doc/html/lynx_help (created)
missing: ./usr/share/doc/html/lynx_help/keystrokes (created)
missing: ./usr/share/doc/usd/13.viref (created)
missing: ./usr/share/man/cat4/powerpc (created)
missing: ./usr/share/man/man4/alpha (created)
missing: ./usr/share/man/man4/pmax (created)
missing: ./usr/share/man/man4/powerpc (created)
missing: ./usr/share/tmac/mdoc (created)
missing: ./var/www/htdocs/manual/vhosts (created)
missing: ./usr/include/ssl (created)
</pre>

<p>
The reason for the fail, then, is that the <em>/usr/include/ssl</em> directory
was never created. Without the header files, the <em>ssleay</em> build fails.
</p>

<p>
<strong>Fix:</strong>
</p>

<p>
Create the <em>named</em> user and group. Remove <em>/usr/include/ssl</em>,
<em>/var/named</em>, and any other directory from the list above that was
mistakenly created as a normal file by the <em>make build</em>.
</p>


<a name="2.3"></a>
<h3>
2.3: I tried the build, but it failed when trying to make something for the
PowerPC.
</h3>

<p>
Your directory tree is incomplete. Specifically, the 
<tt>/usr/share/man/cat4/powerpc</tt> directory is missing. 
</p>

<p>
<strong>Quick Fix:</strong>
</p>

<p>
Create this directory and proceed with the compilation
</p>

<p>
<strong>Complete Fix:</strong>
</p>

<p>
Create the entire directory tree. Do a:
</p>

<pre>
# cd /usr/src/etc &amp;&amp; make DESTDIR=/ distrib-dirs
</pre>

<p>
You will likely see an output like the following:
</p>

<pre>
install -d -o root -g wheel -m 755 /
mtree -def mtree/4.4BSD.dist -p // -u

missing: ./var/named (created)
missing: ./var/named/dev (created)
missing: ./var/named/etc (created)
missing: ./etc/afs (created)
missing: ./etc/ssl (created)
missing: ./etc/ssl/private (created)
missing: ./usr/obj (not created: File exists)
missing: ./usr/share/doc/html (created)
missing: ./usr/share/doc/html/lynx_help (created)
missing: ./usr/share/doc/html/lynx_help/keystrokes (created)
missing: ./usr/share/doc/usd/13.viref (created)
missing: ./usr/share/man/cat4/powerpc (created)
missing: ./usr/share/man/man4/alpha (created)
missing: ./usr/share/man/man4/pmax (created)
missing: ./usr/share/man/man4/powerpc (created)
missing: ./usr/share/tmac/mdoc (created)
missing: ./var/www/htdocs/manual/vhosts (created)
missing: ./usr/include/ssl (created)
</pre>

<p>
Note that /usr/share/man/cat4/powerpc was one of the directories created by this process.
</p>

<a name="3.0"></a>
<h2>3.0: Upgrading from 2.4</h2>

<a name="3.1"></a>
<h3>
3.1: What are the major problems upgrading from 2.4 to 2.5?
</h3>

<p>
<h3>cap_mkdb</h3>

<p>
The syntax for invoking <em>cap_mkdb</em> has changed slightly.
Before doing a <em>make build</em>, rebuild cap_mkdb from the latest source:
</p>
<pre>
# cd /usr/src/usr.bin/cap_mkdb
# make clean &amp;&amp; make &amp;&amp; make install
</pre>

<p>
The make build should then run to completion
</p>

<h3>Man Page Changes</h3>
<p>
Several man pages were moved from section 1 to later sections.
Unfortunately, if the old man pages are left in section 1, unwary
users will not see the latest version of the page.
</p>

<p>
The following pages should be removed:
</p>
<pre>
/usr/share/man/cat1/ipf.0
/usr/share/man/cat1/ipnat.0
/usr/share/man/cat1/ipsecadm.0
</pre>

<h3>Snake</h3>
<p>
You will need to remove the contents of the obj directory before upgrading
<code>/usr/src/games/snake</code>.
</p>

<h3><a name="3.2">
3.2: I tried the build, but it failed on cap_mkdb.
</a></h3>

<p>
<strong>Symptom:</strong>
</p>

<p>
A <em>make build</em> resulted in an error like this:
</p>

<pre>
cap_mkdb -i -f terminfo terminfo.src
cap_mkdb: illegal option -- i
usage: cap_mkdb [-v] [-f outfile] file1 [file2 ...]
*** Error code 1
</pre>

<p>
<strong>Quick Fix:</strong>
</p>

<p>
You need to build a new <em>cap_mkdb</em>. See 
<a href="#3.1">3.1</a>.
</p>

<a name="4.0"></a>
<h2>4.0: Upgrading from 2.5</h2>

<a name="4.1"></a>
<h3>
4.1: What are the major problems upgrading from 2.5 to 2.6?
</h3>

<h5><em>perl</em> and <em>make</em></h5>
<p>
The latest version of Perl (5.005_03) requires a new version of
<em>make</em> to compile properly. You must rebuild make before
building the new Perl. Do a:
</p>

<pre>
# cd /usr/src/usr.bin/make
# make clean &amp;&amp; make &amp;&amp; make install
</pre>

<p>
Then go ahead and rebuild the new Perl. You will need to clean out the Perl
<code>obj</code> directory by hand before building.
</p>

<p>
Perl developers should take note of the latest changes. From 
millert@@openbsd.org:
</p>

<pre>
The version of perl in the OpenBSD source tree (post 2.5) has been
upgraded to 5.005_03.  The build method has changed somewhat but
most of that should be invisible.  The important changes that affect
people are as follows:

1) Perl lib files have moved from /usr/lib/perl5 to the more correct
/usr/libdata/perl5
2) The default site_perl directories now live in /usr/local.  Ie:
if you install a perl module, it will place itself in
/usr/local/libdata/perl5/site_lib.  This makes it easy to
see what non-stock modules you have.  It also means that we
can have perl modules in the ports system easily.
3) The perl library man pages are now install in /usr/share/man/cat3p
You'll need to update your man.conf based on the src/etc/man.conf
to take advantage of them.  This means you can now do
"man 3p less" and get info on the less pragma but "man less"
will still get you the less pager manpage.

If you have modules or other non-stock perl files the simplest thing
to do is to move /usr/lib/perl5 to /usr/libdata/perl5 and add a link
from /usr/lib/perl5 to /usr/libdata/perl5.  Alternately, you could
just edit the installed Config.pm file and fix up the paths there.

</pre>

<h5>Compiler Change: <em>egcs</em> replaces <em>gcc</em></h5>
<p>
This change is likely the most significant change you will encounter.
For detailed instructions, see section <a href="#4.2">4.2</a>.
</p>

<h5>Kernel Structure - <em>statfs</em> - changed</h5>
<p>
The <tt>statfs</tt> structure has changed as of May 31. You must
rebuild your kernel before attempting a <em>make build</em>.
See <a href="#4.3">4.3</a> for details.
</p>

<a name="4.2"></a>
<h3>
4.2: How do I upgrade <em>gcc</em> to <em>egcs</em>
</h3>

<p>
The safest way will be to upgrade to a recent snapshot, once one is 
available. <strong>Look for a snapshot first!</strong>. Bootstrapping the new 
compiler from the old should be a <em>last resort</em>.
</p>

<p>
First, note that some platforms have not been bootstrapped
successfully yet. To date, the following should work, if you are 
careful:
</p>

<ul>
<li><strong>i386</strong>
<li><strong>sparc</strong>
<li><strong>m68k</strong>
<li><strong>alpha</strong>
</ul>

<p>
<strong>mips</strong> and <strong>rs6000</strong> have problems.
</p>

<p>
To test whether your platform can be bootstrapped, grab and install
the egcs-snapshot, available from the 
<a href="../ports.html">ports collection</a>. 
If this works, the in-tree version likely will, too.
This is the <em>safest</em> method of proceeding.
</p>

<p>
Now, before going any further, ensure that your copies of
<em>binutils</em>, <em>gas</em>, and <em>ld</em> are up to date.  Note
that there are two copies of <em>gas</em> and <em>ld</em> in the tree.
On <strong>i386</strong> and <strong>sparc</strong>, the binutils
versions are not used.  Check <tt>/usr/src/gnu/usr.bin/gas</tt> and
<tt>/usr/src/gnu/usr.bin/ld</tt> instead.
</p>

<p>
The following instructions referred to the original egcs snapshot 
(egcs-990517). Since that time, a second snapshot (egcs-990608) has gone
into the tree. If you are coming from vanilla 2.5, it is unlikely that
you will be able to build the latest version directly. In this event, you
will have to bootstrap an intermediate version using these instructions.
</p>

<p>
From espie@@openbsd.org:
</p>

<blockquote>
<pre>
Today, the compiler changes.

Exit gcc 2.8.1, enter egcs... or more precisely, gcc 2.95 prerelease.

This is probably going to be a rough ride, but I can't work out all
the kinks on every architecture by myself.

I'm going to start importing stuff *now*. There will be a second message
to tech@@ once things are settled...

Thanks to everyone who helped me sorting stuff out, most especially
niklas, turan, and millert.

Why the switch
--------------
as most of you already know, egcs is now the *official* compiler supported
by the FSF.  The upcoming july release as been re-christened gcc 2.95.

Just looking at the log messages will show you many improvements:
support for newer processors is better, C++ is more accurately matching
the ANSI/ISO standards, Fortran 77 is more closely integrated.
There are also countless bug-fixes and code generation improvements.

Also the development is more open. There is a cvs tree, there are several
mailing-lists available, and we are cooperating closely with the egcs
team. More precisely, I've been feeding patches back to the egcs team
so that OpenBSD configurations are officially supported.
Also, the development team is highly responsive to bug-reports, and problems
get fixed.

There also is a band-wagon phenomenon: everyone is switching to egcs,
which means lots of code to test the compiler on, and that we can benefit
from related projects.

Why now
-------
egcs-1.1 was unfit for some purposes. Specifically, code size on i386
was larger than gcc 2.8.1, which yielded floppy-disks problems. 
At 2.5 freeze, the only code fit to include was a somewhat unstable
snapshot.  In the interest of stability, after much pondering, egcs was
not put into 2.5.

Right now, the egcs project is going through a release cycle which will
yield egcs 1.2.  Judging from their time schedule, there is ample margin
between egcs 1.2 and the next release of OpenBSD.  Also, we want to get
in now, so that we get a chance to report problems on less frequently 
used architectures, and get everything fixed for 1.2.

egcs `feature freeze' is supposed to occur on may 7th, and the current
snapshot 19990502 looks solid.

What works and what doesn't
---------------------------
egcs runs an i386 OpenBSD system without problems.  m68k works as well,
with a few work-arounds linked to obscure bugs that will get fixed.
sparc seems to be running as well.  There is some linker trouble on some 
other arches that needs to be fixed before our next release.

Right now, constructors across dynamic libraries are not quite ready.

egcs now features a stand-alone cpp which is going to be better than
the current hackish solution we use. This means a few interface changes
and possibly weird warnings.

Keeping gcc 2.8.1 ?
-------------------
due to size constraints, as soon as egcs is imported, gcc is going
to move to cvs Attic.  If you don't want to deal with egcs now, you'll
have to be careful through your cvs updates.
Some Makefiles are bound to change: includes, gnu/usr.bin, and gnu/lib.
xlint and cpp.sh are going to change as well.

How to bootstrap the compiler
-----------------------------
the simplest way is probably to trust the various arch maintainers
and download a snapshot.

If you want to do stuff the hard way, you must first remake proper
obj dirs:
cd /usr/src
make obj

If you run i386, gas must be up-to-date.
If you run sparc, ld must be up-to-date.

then build libiberty:
cd /usr/src/gnu/egcs/libiberty
make -f Makefile.bsd-wrapper clean
make -f Makefile.bsd-wrapper depend
make -f Makefile.bsd-wrapper 
make -f Makefile.bsd-wrapper install

then the C compiler:
cd /usr/src/gnu/egcs/gcc
make -f Makefile.bsd-wrapper clean
make -f Makefile.bsd-wrapper depend
make -f Makefile.bsd-wrapper 
make -f Makefile.bsd-wrapper install

rebuild the C compiler with the new version:
cd /usr/src/gnu/egcs/gcc
make -f Makefile.bsd-wrapper clean
make -f Makefile.bsd-wrapper depend
make -f Makefile.bsd-wrapper 
make -f Makefile.bsd-wrapper install

rebuild the includes
cd /usr/src/include
make includes

build all egcs libraries and install them
cd /usr/src/gnu/egcs
make -f Makefile.bsd-wrapper clean
make -f Makefile.bsd-wrapper depend
make -f Makefile.bsd-wrapper 
make -f Makefile.bsd-wrapper install

install the new cpp driver
cd /usr/src/usr.bin/cpp
make install

then you're all set, and a standard make build should work...
</pre>


<p>
[author note: Actually, it doesn't quite work. xlint will fail to build.
The fix is simple though. Simply do a 
<code> make &amp;&amp; make install </code>
in the <code>/usr/src/usr.bin/xlint/xlint</code> directory before 
you attempt a <em>make build</em> and proceed. See <a href="#4.2.2">4.2.2</a>.]
</p>

<pre>
If it doesn't, you're using an arch that didn't go through make build yet.
The most probably occurrence is an Internal Compiler Error, as known as an
ICE.

First try to see if the ICE will go away with -O1 or -O0. In that case, you
can put a work-around in the Makefile until it's fixed 
(see /usr/src/lib/libm/Makefile for an example of how to put in such
work-arounds for m68k).

Then the error needs to be reported to the egcs-bugs mailing list.

At a minimum, you must run the source through the same compiler invocation,
with an addition of -v -save-temps to the options.

-v yields the precise sequence of commands invoked by gcc. -save-temps
will give you a pre-processed C file (.i) or C++ (.ii) that the egcs people
can make sense of... you can't ask them to run OpenBSD on their boxes.

If you have more time, you can try to trim down the pre-processed C file to
the bare minimum that triggers the bug. Dichotomy works nicely.
</pre>
</blockquote>

If you made it through this procedure, and everything is still working,
congratulations. If not, check the following sections for advice. Problems
not listed here should be posted to tech@@openbsd.org.

<a name="4.2.1"></a>
<h5>
4.2.1 - <tt>i386</tt> and <tt>sparc</tt> are no longer 
<tt>#define</tt>'ed
</h5>

<p>
This is true. <em>egcs</em> uses the cleaner <tt>__i386__</tt> and
<tt>__sparc__</tt>. If you need to compile code that relies on the old
defines, add a <tt>-Dsparc</tt> or <tt>-Di386</tt> 
to the appropriate location of your Makefile.
</p>

<a name="4.2.2"></a>
<h5>
4.2.2 - Build fails in xlint
</h5>

<p>
This is due to semantic differences in cpp. The workaround is simple,
and similar to the <em>cap_mkdb</em> issue described in <a href="#3.1">3.1</a>.
</p>

<p>
Do a:
</p>

<pre>
# cd /usr/src/usr.bin/xlint/xlint
# make &amp;&amp; make install
</pre>

<p>
now re-run make, and the build should continue.
</p>

<a name="4.2.3"></a>
<h5>
4.2.3 - Core Dump on <tt>uthread_autoinit.c</tt>
</h5>

<p>
You have fallen victim to a linker bug. Here's a relevant message:
</p>

<pre>
From: Marc Espie &lt;Marc.Espie@@liafa.jussieu.fr&gt;
Subject: egcs core-dumping on uthread_autoinit.c

If this happens to you, this is a known linker problem... the cc1 you have
was linked in a weird way.

Initially, I made cc1 link against static /usr/lib/libiberty.a to avoid this
problem, but this was cutting things too close, and the bug reappeared,
probably thanks to unrelated changes in libc or elsewhere...

The tree has been patched with a work-around in

src/gnu/egcs/f/lang-options.h

make sure you have the kludged version of that file (at least rev 1.2),
recompile and reinstall cc1, the problem should go away.

What's going on is that the 386 linker gets something wrong because of
the huge strings array in toplev.c, and something gets mislinked, so
that
void f(void) __attribute((constructor)) {}
kills cc1.

As a work-around, I've killed Fortran options help texts, until someone finds
where the linker errs.
</pre>

<a name="4.2.4"></a>
<h5>
4.2.4 - <em>egcs</em> seems much slower than <em>gcc</em>
</h5>

<p>
It is, but there is a reason. <em>egcs</em> performs more optimizing passes.
Data alignment and other such functionality will be better with 
<em>egcs</em>-generated code.
</p>

<a name="4.2.5"></a>
<h5>
4.2.5 - <em>egcs</em> generates larger code than <em>gcc</em>
</h5>

<p>
Yes it does. This is especially noticeable with the old <tt>-O2</tt>
gcc switch.  <em>egcs</em> introduces a new option, <tt>-Os</tt> which
optimizes for space.  This is roughly comparable to the old
<TT>-O2</TT> behavior.
</p>

<a name="4.2.6"></a>
<h5>
4.2.6 - After installing <em>egcs</em> I have very little disk space left
</h5>

<p>
<em>egcs</em> installs into a different subdirectory than gcc 2.8.1. You
may remove <em>gcc</em> once egcs is bootstrapped and working.
</p>

<p>
On a related note, the perl changes mentioned in <a href="#4.1">4.1</a>
mean that you can remove the <tt>/usr/lib/perl5</tt> directory. The
new location for this data is <tt>/usr/libdata/perl5</tt>.
</p>

<a name="4.2.7"></a>
<h5>
4.2.7 - My build dies while making libcurses
</h5>

<p>
<em>libcurses</em> now relies on the latest version of <em>cpp</em>.
Fetch the latest version, rebuild <em>cpp</em>, and continue. Eg:
</p>
<pre>
# cd /usr/src/usr.bin/cpp &amp;&amp; make install
</pre>

<p>And try the make build again.</p>

<a name="4.2.8"></a>
<h5>
4.2.8 - make obj fails
</h5>

<p>
If your <em>make obj</em> fails, citing errors in a Makefile, your
makefile includes are likely out of date. For example:
</p>

<pre>
===> lib/libkvm
"Makefile", line 30: Malformed conditional ((${UVM} == "yes"))
"Makefile", line 30: Missing dependency operator
"Makefile", line 32: if-less endif
"Makefile", line 32: Need an operator
Fatal errors encountered -- cannot continue

</pre>

<p>
This can be solved by rebuilding the makefile includes. Do a:
</p>

<pre>
cd /usr/src/share/mk &amp;&amp; make install
</pre>

<p>
and try the build again.
</p>

<a name="4.3"></a>
<h3>
4.3: My <em>make build</em> dies with <em>unimplemented syscall</em> errors.
</h3>

<p><strong>Short Answer:</strong> </p>

<p>
The kernel structure <tt>statfs</tt> has changed. You will need to recompile
the kernel before attempting a <em>make build</em>.
</p>

<p><strong>Long Answer:</strong> </p>

<p>
The kernel structure <tt>statfs</tt> has changed. 
The new <tt>struct statfs</tt> has the following features:
</p>

<ul>
<li> Has a <tt>u_int32_t</tt> flags field--now softdep can have a real flag.
</li>

<li> Uses <tt>u_int32_t</tt> instead of longs (nicer on the alpha).  
Note: the man page used to lie about setting invalid/unused fields to -1.  
SunOS does that but our code never has.
</li>

<li> Gets rid of <tt>f_type</tt> completely.  It hasn't been used since NetBSD 
0.9, and having it there but always 0 is confusing.  It is conceivable
that this may cause some old code to not compile, but that is better
than silently breaking.
</li>

<li> Adds a <tt>mount_info</tt> union that contains the <tt>FSTYPE_args</tt>
struct.  This means that <em>mount</em> can now tell you all the options a 
filesystem was mounted with.  This is especially nice for NFS.
</li>
</ul>

<p>
Other changes:
</p>

<ul>
<li> The linux statfs emulation didn't convert between BSD fs names
and linux <tt>f_type</tt> numbers.  Now it does, since the BSD <tt>f_type</tt>
number is useless to linux apps (and has been removed anyway)
</li>

<li> FreeBSD's struct statfs is different from ours (both old and new)
and thus needs conversion.  Previously, the OpenBSD syscalls
were used without any real translation.
</li>

<li> <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mount&amp;apropos=0&amp;sektion=8&amp;manpath=OpenBSD+Current&amp;arch=i386&amp;format=html">mount(8)</a>
will now show extra info when invoked with no arguments.
However, to see <em>everything</em> you need to use the -v (verbose) flag. 
</li>
</ul>

<a name="4.4"></a>
<h3>
4.4: Link to the new 2.6 directory.
</h3>

<p>
When upgrading to 2.6 you'll need to create one simple link for gcc.
</p>

<pre>
   cd /usr/lib/gcc-lib
   ln -s ${ARCH}-unknown-openbsd2.5 ${ARCH}-unknown-openbsd2.6
</pre>

<a name="4.5"></a>
<h3>
4.5: After an <strong>(U)</strong>pgrade, extraction of <em>base26.tar.gz</em>
fails with a message:
</h3>

<p>
<em>tar: Unable to remove directory ./usr/include/machine &lt;Directory
not empty&gt;
</em>
</p>

<p>In 2.5, <tt>/usr/include/machine</tt> was a directory, and
<tt>/usr/include/i386</tt> was a link to it. In 2.6, this situation
is reversed.
</p>

<p>
To correct the problem, escape to the shell, remove the <tt>/usr/include/machine</tt> directory, and retry the upgrade.
</p>

<a name="5.0"></a>
<h2>
5.0 - Upgrading from 2.6
</h2>

<a name="5.1"></a>
<h3>
5.1: Termcap entries are too long.
</h3>

<p>
There is a new <tt>termcaps.master</tt> file. You will need
to regenerate the <tt>terminfo</tt> and <tt>termcaps</tt> files
with the current version of
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tic&amp;apropos=0&amp;sektion=1&amp;manpath=OpenBSD+Current&amp;arch=i386&amp;format=html">tic(1)</a>.
If you are upgrading via <em>make build</em>, the correct version of
tic(1) will be used and this will be done for you.  If not, you will
get the following error:
</p>

<pre>
    terminfo.src is corrupt! You need to update /usr/bin/tic
</pre>

<p>
In this case, you must either rebuild and install tic(1) (being sure
to use the current version of <tt>libcurses</tt>) or simply build
the version of tic(1) in your source tree.
</p>

<a name="5.2"></a>
<h3>
5.2: My <em>pn</em> (or <em>mx</em>, <em>al</em>, <em>ax</em>) device is no longer
recognized by the kernel.
</h3>

<p> (Note: <em>pn</em> is used below for simplicity. This should
be taken to read <em>pn</em>, <em>mx</em>, <em>al</em>, or <em>ax</em>
as appropriate)
</p>

<p>
These four drivers were replaced with the a unified <em>dc</em> driver.
You must change all occurrences of <em>pn*</em>, <em>mx</em>,
<em>al</em>, or <em>ax</em> in your configuration files. This includes:
</p>

<ul>
<li>Updating your kernel configuration file(s). (Hint: start with a
    fresh GENERIC kernel, and modify from there)
</li>
<li>mv'ing <tt>/etc/hostname.pn*</tt>  to <tt>/etc/hostname.dc*</tt>
</li>
<li>Updating your <tt>/etc/ifaliases</tt> file.
</li>
<li>Changing your <tt>/etc/ipnat.rules</tt> and <tt>/etc/ipf.rules</tt> to
    reflect the new interface name.</li>
</ul>

<p>
If you are modifying a custom kernel, make sure you have
included the <em>dcphy</em> device in your kernel config, as follows:
</p>

<pre>
dcphy*  at mii? phy ?                           # Digital Clone PHYs
</pre>

<p>While you are at it, you may also want to add:</p>

<pre>
ukphy*  at mii? phy ?                           # "unknown" PHYs
</pre>

<a name="5.3"></a>
<h3>
5.3: Upgrading gcc 2.95.1 to 2.95.2
</h3>

<p><em>gcc</em> 2.95.2 was merged into the OpenBSD source tree around
January 19, 2000. In order for <em>gcc</em> to build properly, a more
recent (post 2.6) <em>libiberty</em> is required. To build this library,
do the following:</p>

<pre>
	cd /usr/src/gnu/egcs/libiberty
	make -f Makefile.bsd-wrapper clean
	make -f Makefile.bsd-wrapper obj
	make -f Makefile.bsd-wrapper
	make -f Makefile.bsd-wrapper install
</pre>

<p>
NOTE: On mips-based architectures, such as pmax, you must
perform an explicit <em>ldconfig</em> after new libraries are build.
</p>

<p>Once <em>libiberty</em> is build, you may proceed with a standard
<em>gcc</em> bootstrap:</p>

<pre>
   cd /usr/src/gnu/egcs/gcc
   make -f Makefile.bsd-wrapper clean
   make -f Makefile.bsd-wrapper obj
   make -f Makefile.bsd-wrapper -DBOOTSTRAP
   make -f Makefile.bsd-wrapper -DBOOTSTRAP install
   make -f Makefile.bsd-wrapper clean
   make -f Makefile.bsd-wrapper 
   make -f Makefile.bsd-wrapper install
</pre>

<a name="5.4"></a>
<h3>
5.4: Upgrading Kerberos.
</h3>

<p>
For Kerberos IV to build correctly, you will have to perform the following
steps:
</p>

<ul>
<li>
<p> Obtain and build the latest <tt>usr.bin/compile_et</tt>. </p>
<pre>
   # cd /usr/src/usr.bin/compile_et
   # make clean &amp;&amp; make depend &amp;&amp; make &amp;&amp; make install
</pre>
</li>

<li>
<p> Obtain and build the latest <tt>lib/libcom_err</tt>. </p>
<pre>
   # cd /usr/src/lib/libcom_err
   # make clean &amp;&amp; make depend &amp;&amp; make &amp;&amp; make install
</pre>
</li>

<li>
<p> Clean out and reinstall the Kerberos header files: </p>
<pre>
  # rm -r /usr/include/kerberosIV/*
  # cd /usr/src/kerberosIV
  # make includes
</pre>
</li>
<li>
<p> Now, rebuild the Kerberos library files:</p>
<pre>
   # cd /usr/src/kerberosIV/lib
   # make clean &amp;&amp; make depend &amp;&amp; make &amp;&amp; make install
</pre>
</li>
<li>
<p> If you are not doing a complete make build, rebuild Kerberos:</p>
<pre>
   # cd /usr/src/kerberosIV
   # make cleandir &amp;&amp; make depend &amp;&amp; make &amp;&amp; make install
</pre>
</li>
<li> Otherwise, simply restart your <em>make build</em>. </li>
</ul>


<a name="5.5"></a>
<h3>
5.5: Upgrading M4.
</h3>

<p>
The version of m4 that shipped with OpenBSD 2.6 will get into an infinite
loop while processing the sendmail .mc files into .cf files.  Because
of this you will need to install the new version of m4 <strong>before</strong>
you attempt a <em>make build</em>.  In other words:
</p>

<pre>
    # cd /usr/src/usr.bin/m4
    # make &amp;&amp; make install &amp;&amp; make cleandir
</pre>

<a name="5.6"></a>
<h3>
5.6: Upgrading Sendmail.
</h3>

<p>
In sendmail 8.10.X, locations (and names) of the sendmail configuration files
have changed.  Everything but the pid file now lives in /etc/mail.
Additionally, several files have changed names.
</p>

<table border="0">
<tr>
  <td><strong>OLD</strong></td>
  <td><strong>NEW</strong></td>
</tr>
<tr>
  <td><tt>/etc/sendmail.cf</tt></td>
  <td><tt>/etc/mail/sendmail.cf</tt></td>
</tr>
<tr>
  <td><tt>/etc/sendmail.cw</tt></td>
  <td><tt>/etc/mail/local-host-names</tt></td>
</tr>
<tr>
  <td><tt>/etc/sendmail.ct</tt></td>
  <td><tt>/etc/mail/trusted-users</tt></td>
</tr>
<tr>
  <td><tt>/etc/sendmail.oE</tt></td>
  <td><tt>/etc/mail/error-header</tt></td>
</tr>
<tr>
  <td><tt>/etc/aliases</tt></td>
  <td><tt>/etc/mail/aliases</tt></td>
</tr>
<tr>
  <td><tt>/etc/service.switch</tt></td>
  <td><tt>/etc/mail/service.switch</tt></td>
</tr>
<tr>
  <td><tt>/etc/userdb</tt></td>
  <td><tt>/etc/mail/userdb</tt></td>
</tr>
<tr>
  <td><tt>/usr/share/misc/sendmail.hf</tt></td>
  <td><tt>/etc/mail/helpfile</tt></td>
</tr>
</table>

<p>
There are a couple of ways to convert from the old sendmail config
to the new, but the first step is always the same.
</p>

<ol>
<li> Update <tt>/etc/rc</tt> so that it looks for
     <tt>/etc/mail/sendmail.cf</tt> instead of <tt>/etc/sendmail.cf</tt>
</li>
<li> <tt>mv /etc/sendmail.cf /etc/mail/sendmail.cf</tt> <br />
     This is the path of least resistance and you won't have to change
     the location of any other files.
</li>
<li> Or, build a new .cf file from your .mc source file.  Note that you
     no longer need to specify the line:
     <pre>include(`../m4/cf.m4')</pre>
     since it will be included for you by make.  Also note that when
     adding machines to class w (via "Cw machinename"), you now need
     to do that in the LOCAL_CONFIG section (see <tt>openbsd-lists.mc</tt>
     for an example).
</li>
</ol>

<a name="5.7"></a>
<h3>
5.7: After upgrading, kernels that include 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=apm&amp;apropos=0&amp;sektion=8&amp;manpath=OpenBSD+Current&amp;arch=i386&amp;format=html">apm(8)</a>
support no longer boot.
</h3>

<p>
You need to update your bootblocks. See
<a href="faq14.html#14.8">Section 14.8</a>
of the OpenBSD FAQ for details.
</p>

<a name="6.0"></a>
<h2>
6.0 - Upgrading from 2.7
</h2>

<a name="6.1"></a>
<h3>
6.1: What are the major problems upgrading from 2.7 to 2.8?
</h3>

<p>
A significant gcc change was introduced that makes it all too easy
to generate self-referencing <em>libc</em> libraries. For this reason, upgrades
should follow exactly this procedure:
</p>

<ol>
<li> <a href="#1.10">Clean the cruft</a> from your source tree, and fetch
the 2.8 code.</li>

<li>
<p>
 Build and install a new linker. This <strong>must</strong> be done before
a full <em>gcc</em> build.
</p>
<pre>
  $ cd /usr/src/gnu/usr.bin/ld
  $ make clean &amp;&amp; make obj &amp;&amp; make
  $ sudo make install
</pre>
</li>
<li> Build and install the new <em>gcc</em>. Use the
     <a href="#1.8">BOOTSTRAP</a> procedure to speed
     things up.<p>
</li>

<li>
<p> Build a new kernel. Do not install it yet </p>
<pre>
  $ cd /usr/src/sys/arch/`machine`/conf
  $ config GENERIC
  $ cd ../compile/GENERIC
  $ make clean &amp;&amp; make depend &amp;&amp; make
</pre>
</li>
a572 31
<li><p> Because of some libc changes, your machine may hang on startup unless
   your <tt>/etc/resolv.conf</tt> contains <em>lookup file bind</em>.
   Add this line if necessary </p>
<pre>
  # echo &quot;lookup file bind&quot; &gt;&gt; /etc/resolv.conf
</pre>
</li>
<li> Install the new kernel and reboot
<pre>
  # cd /usr/src/sys/arch/`machine`/compile/GENERIC
  # mv /bsd /bsd.old
  # mv bsd /bsd
  # chown root.wheel /bsd
  # shutdown -r now
</pre>
<p>
(If this step fails, you can recover by booting the old kernel - bsd.old -
at the <tt>boot&gt;</tt> prompt.)</p>
</li>
<li> 
<p>Build and install the new make (and support files). 
     Do not skip the <tt>make depend</tt> step.
</p>
<pre>
  $ cd /usr/src/usr.bin/make
  $ make clean &amp;&amp; make obj &amp;&amp; make depend &amp;&amp; make
  $ sudo make install
  $ cd /usr/src/share/mk
  $ sudo make install
</pre>
</li>
d574 2
a575 118
<li> Install the latest <em>mtree</em>, and ensure the necessary directory
     structure is present.
<pre>
  $ cd /usr/src/etc/mtree
  $ sudo install -c -o root -g wheel -m 444 4.4BSD.dist /etc/mtree
  $ sudo mtree -qdef /etc/mtree/
</pre>
</li>

<li> Perform the make build
<pre>
  # cd /usr/src &amp;&amp; make build
</pre>
</li>

<li> <a href="#1.9">Update <tt>/etc</tt> <tt>/var</tt> and 
     <tt>/dev/MAKEDEV</tt></a> by hand.

</li>
</ol>

<a name="7.0"></a>
<h2>
7.0 - Upgrading from 2.8
</h2>

<a name="7.1"></a>
<h3>
7.1: New auth group
</h3>

<p>
A new group, <em>auth</em>, gid 11, has been added to the system.
Add a line like the following to your <tt>/etc/group</tt>:
</p>

<pre>
  auth:*:11:
</pre>

<a name="7.2"></a>
<h3>
7.2: New wscons console system
</h3>

<p>
The <em>pcvt</em> console driver has been replaced with the <em>wscons</em>
console system.
Before using wscons, you will need to create the new wscons-related devices.
Ensure you have the latest MAKEDEV installed, then make all devices:
</p>

<pre>
 # cp /usr/src/etc/etc.i386/MAKEDEV /dev/MAKEDEV
 # cd /dev
 # ./MAKEDEV all
</pre>

<p>
If you are running X, change the Pointer section of your <em>XF86Config</em> 
file to contain the following:
</p>

<pre>
    Protocol    "wsmouse"
    Device      "/dev/wsmouse"
</pre>

<a name="7.3"></a>
<h3>
7.3: Kernel compile fails with undefined symbols
</h3>

<p>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;apropos=0&amp;sektion=8&amp;manpath=OpenBSD+Current&amp;arch=i386&amp;format=html">config(8)</a>
has been updated. Building with the old <em>config</em> will result
in errors like:
</p>

<pre>
  Undefined symbol `_pdevnames_size' referenced
  Undefined symbol `_pdevnames' referenced
</pre>

<p>
To correct this, compile and install the new <em>config</em>:
</p>

<pre>
  $ cd /usr/src/usr.sbin/config
  $ make clean &amp;&amp; make depend &amp;&amp; make
  $ sudo make install
</pre>

<p>
Now, recompile a new kernel as before.
</p>

<a name="8.0"></a>
<h2>
8.0 - Upgrading from 2.9
</h2>

<a name="8.1"></a>
<h3>
8.1: New users/groups - <em>proxy</em>, <em>smmsp</em>, and <em>popa3d</em>.
</h3>

<p>
First, with the addition of the 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4"
>pf(4)</a> firewalling package, and its
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftp-proxy&amp;sektion=8"
>ftp-proxy(8)</a> suite, a new user and
group named <em>proxy</em> were added to the system.  To support this
addition, add the following user entry using 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>:
</p>
d577 17
d598 1
a598 3
<p>
Also add the <em>proxy</em> group to /etc/group:
</p>
d604 4
a607 6
<p>
Second, as part of the Sendmail 8.12 upgrade, sendmail no longer runs
setuid root.  Both a new user and a new group, named <em>smmsp</em>,
have been added to the system.  Add a line like the following to your
<tt>/etc/group</tt>:
</p>
d613 5
a617 3
<p>
Then, run <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a> and add the following line for the <em>smmsp</em> user:
</p>
d623 7
a629 8
<p>
Make sure this line appears before any <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=yp&amp;sektion=8">yp(8)</a> settings line.
</p>

<p>Finally, a new user and group were added for Solar Designer's
popa3d server, now part of the core system. Add the following to
<tt>/etc/group</tt>:
</p>
d633 1
a633 7
</pre> 

<p>
And using  <a 
href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8"
>vipw(8)</a>, add
</p>
d635 3
d642 12
a653 15
<a name="8.2"></a>
<h3>
8.2: New packet filter: <em>pf</em>
</h3>

<p>
The IPF firewalling package that has been part of previous
OpenBSD releases has been replaced with an all-new firewalling suite
called <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4"
>pf(4)</a>. As a result, a number of changes need to be made.
</p>

<p>First, <em>pf</em> depends on a new device file. To ensure that this
special device is created, do the following:
</p>
d661 2
a662 4
<p>
Second, a number of filesystem change have occurred. For your
reference, the following binaries have been replaced:
</p>
d674 1
a674 3
<p>
Similarly, for the devices:
</p>
d681 1
a681 3
<p>
And finally, the filter configuration files:
</p>
d688 15
a702 22
<p>
A mechanism for safely enabling <em>pf</em> has been added to the
<tt>/etc/rc</tt> and <tt>/etc/rc.conf</tt> files. You will need to
update these files to include the new hooking mechanism. If you wish
to enable <em>pf</em>, set PF=YES in <tt>/etc/rc.conf</tt>.
</p>

<a name="8.3"></a>
<h3>
8.3: Changes to <em>make</em>
</h3>

<p>
There have been changes to 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=make&amp;sektion=1"
>make(1)</a> and its data files which may cause difficulties in the
build process. This usually manifests as
errors from <em>bsd.own.mk</em> during the build. To avoid these issues,
first update
the data files:
</p>

d708 1
a708 3
<p>
Then build and install the new make.
</p>
d716 15
a730 24
<p>
Now proceed with your upgrade.
</p>

<h3><a name="8.4">
8.4: Build fails because of KerberosV errors
</a></h3>

<p>
Before you try building the whole system, you need to first
build KerberosV.
</p>

<p>
First, there is a new KerberosV configuration directory in
<em>/etc</em>.  If you have not already done so, use the 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mtree&amp;sektion=8"
>mtree(8)</a> procedure described in 
<a href="#1.13">section 1.13</a> to create it:
</p>

<p>
Now, build KerberosV
</p>
d742 33
a774 39
<p>
You may also need to update your <tt>/etc/login.conf</tt>, to
reflect that the file <tt>/usr/libexec/auth/login_krb-or-pwd</tt> 
has been renamed to <tt>login_krb<strong>4</strong>-or-pwd</tt>.
</p>

<a name="8.5"></a>
<h3>
8.5: New sendmail version
</h3>

<p>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sendmail&amp;sektion=8"
>sendmail(8)</a> has been upgraded to version 8.12. As this version of
<em>sendmail</em> no longer runs setuid root, significant changes have
resulted.
</p>

<ol>
<li> Both a new user and a new group (<em>smmsp</em>) have been added.
If you have not yet done so, follow the procedure in 
<a href="#8.1">section 8.1</a> to create them.
</li>

<li> Several changes to the file hierarchy have occurred, including a new
<tt>/var/spool/clientmqueue</tt> directory and new permissions for
<tt>/var/spool/mqueue</tt>.
These changes can both be made using the 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mtree&amp;sektion=8"
>mtree(8)</a> procedure described in 
<a href="#1.13">section 1.13</a>.
</li>

<li>
<p>
Add the following to root's <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=crontab&amp;sektion=1">crontab(1)</a>. This is necessary since
<em>sendmail</em> is no longer setuid root, and relies on this entry to
do parts of its job:
</p>
a779 1
</li>
d781 4
a784 2
<li>
<p> Upgrade sendmail:</p>
d791 33
a823 32
<p><strong>Note:</strong> The files <tt>submit.cf</tt> and <tt>localhost.cf</tt> have
been installed to your <tt>/etc/mail</tt> directory.
The first of these, <tt>submit.cf</tt> (referred to as the "client" 
configuration file in current sendmail documentation) is used by mail user 
agents that want to submit mail locally for delivery via sendmail.
Due to the permissions changes described above, this does not require
root privileges; the sendmail binary is set-groupid to group smmsp.
The second file, <tt>localhost.cf</tt>, is an OpenBSD-ism that runs
sendmail only listening on the localhost interface to accept mail 
from the local host but not accept connections from the network
(you almost certainly want this if you also use e.g., 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=smtpd&amp;sektion=8">smtpd(8)</a>
listening on the SMTP port on your outside interface).
For more details, see the file <tt>SECURITY</tt> in 
<tt>/usr/src/gnu/usr.sbin/sendmail/sendmail</tt>.
</p>

<p>It is highly recommended that you regenerate and update your
sendmail configuration files in <tt>/etc/mail</tt>. You can find some
working configuration files in <tt>/usr/share/sendmail/cf</tt>.
Note that localhost.cf is generated from openbsd-localhost.mc.
<p>
</li>

<li> 
<p>
If you were running sendmail without the <tt>-bd</tt>
option in <tt>/etc/rc.conf</tt>, as the default installation settings do, 
you will need to use <tt>localhost.cf</tt>. Edit <tt>rc.conf</tt> to
use the following:
</p>

d828 40
a868 1
</li>
d870 6
a875 4
<li>
<p>
Once your configuration file is ready, <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=kill&amp;sektion=1">kill(1)</a> the existing sendmail:
</p>
d878 1
a878 1
  kill `sed 1q /var/run/sendmail.pid`
d881 7
a887 3
<p>
Restart the new sendmail with the appropriate options, for example:
</p>
d890 3
a892 1
  /usr/sbin/sendmail -L sm-mta -bd -q30m
d895 2
a896 3
<p>
for a configuration accepting mail from outside, or
</p>
d899 2
a900 1
  /usr/sbin/sendmail -L sm-mta -C/etc/mail/localhost.cf -bd -q30m
d903 11
a913 80
<p>
for a local mail-only configuration. 
</p>

<p><strong>Note:</strong> the <tt>-bd</tt> flag is now needed in both cases.
</p>

</li>

</ol>

<p>
The new <em>sendmail</em> should now be running.
</p>

<a name="8.6"></a>
<h3>
8.6: /etc/primes Moved
</h3>

<p>
<tt>/etc/primes</tt> has been renamed to <tt>/etc/moduli</tt>.
Simply copy this file from its old location or from <tt>/usr/src/etc</tt>.
</p>

<a name="9.0"></a>
<h2>
9.0 - Upgrading from 3.0
</h2>

<a name="9.1"></a>
<h3>
9.1: Removal of libdl on ELF platforms
</h3>

<p>
ELF-based platforms (alpha, macppc and sparc64) do not use libdl anymore. The
upgrade from a libdl system to a non-libdl is best done following these
steps:
</p>

<ul>
<li>
<p>Recompile your system:</p>
<pre>
$ cd /usr/src
$ make build
</pre>
</li>
<li>
<p>
If your &quot;make build&quot; completed successfully, you can step ahead
and remove libdl.  Note that packages that have been linked against it should
be reinstalled after that.  If you are not ready for this, you can skip this
step for now.  Snapshots with correct packages will be made available.
</p>
<pre>
# rm -f /usr/lib/libdl.* /usr/lib/libdl_pic.a
</pre>
<li>
<p>
With libdl removed, regen your shared libraries cache:
</p>

<pre>
# ldconfig -R
</pre>
</li>
</ul>

<a name="9.2"></a>
<h3>
9.2: New regression framework
</h3>

<p>
A new infrastructure for regression tests has been introduced and
<tt>bsd.regress.mk</tt> has been added.  You will need to install
this file before running <em>make obj</em>.
</p>
d915 2
d918 2
a919 1
  $ cd /usr/src/share/mk
d923 4
a926 13
<p>
--
</p>
<address>
<p>
$OpenBSD: upgrade-minifaq.html,v 1.84 2002/01/14 22:49:17 kjell Exp $
<br />
Copyright &copy; 1998-2002, Kjell Wooding. 
<br />
Please send any comments, questions, or suggestions to 
<a href="mailto:kjell@@openbsd.org">kjell@@openbsd.org</a>
</p>
</address>
d928 8
a935 1
</body>
@


1.84
log
@When upgrading 2.9->3.0, also add the popa3d user and group.
While I'm in here, clean up a little HTML.
@
text
@d1 26
a26 21
<HTML>
<HEAD>
   <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
   <TITLE>OpenBSD Upgrading Mini-FAQ </TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#23238E">


<h2>MINI-FAQ: Upgrading OpenBSD</h2>
<h3>Latest OpenBSD Release - 3.0</h3>

<h4>Kjell Wooding 
&lt;<A HREF="mailto:kjell@@openbsd.com">kjell@@openbsd.org</A>&gt;
</h4>
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.83 2002/01/10 09:42:10 reinhard Exp $

<P>

<BLOCKQUOTE>
<FONT SIZE=-1>
If you've ever tried compiling the <I>-current</I> sources from an older
d30 2
a31 2
between OpenBSD releases, or from the releases to <I>-current</I>.
Though hardly <i>Mini</i> anymore, this document retains the Mini-FAQ
d33 2
a34 2
</FONT>
</BLOCKQUOTE>
a35 1
<P>
d37 13
a49 11
<H3>1.0: General Upgrade Questions</H3>
<A HREF="#1.1">
1.1: Terminology. What is <I>-current</I>? What are Snapshots? What is
<I>-stable</I>?
</A>
<BR>
<A HREF="#1.2">
1.2: What is the easiest way to upgrade to <I>-current</I>?
</A>
<BR>
<A HREF="#1.3">
d52 3
a54 3
</A>
<BR>
<A HREF="#1.4">
d56 3
a58 3
</A>
<BR>
<A HREF="#1.5">
d60 3
a62 3
</A>
<BR>
<A HREF="#1.6">
d64 3
a66 3
</A>
<BR>
<A HREF="#1.7">
d68 4
a71 4
</A>
<BR>
<A HREF="#1.8">
1.8: I'm upgrading to a newer version of the compiler (<i>gcc</i>). Is there a
d73 1
a73 2
</A>
<BR>
d75 1
a75 1
<A HREF="#1.9">
d78 1
a78 2
</A>
<BR>
d80 1
a80 1
<A HREF="#1.10">
d82 1
a82 2
</A>
<BR>
d84 3
a86 4
<A HREF="#1.11">
1.11: Do I have to be root to do a <i>make build</i>?
</A>
<BR>
d88 1
a88 1
<A HREF="#1.12">
d90 1
a90 2
</A>
<BR>
d92 1
a92 1
<A HREF="#1.13">
d94 4
a97 2
</A>
<BR>
d99 2
a100 2
<H3>2.0: Upgrading from 2.3</H3>
<A HREF="#2.1">
d102 7
a108 7
</A>
<BR>
<A HREF="#2.2">
2.2: I tried the build, but it failed when trying to compile <I>ssleay</I>.
</A>
<BR>
<A HREF="#2.3">
d111 4
a114 2
</A>
<BR>
d116 2
a117 2
<H3>3.0: Upgrading from 2.4</H3>
<A HREF="#3.1">
d119 2
a120 3
</A>
<BR>
<A HREF="#3.2">
d122 4
a125 2
</A>
<BR>
d127 2
a128 2
<H3>4.0: Upgrading from 2.5</H3>
<A HREF="#4.1">
d130 18
a147 17
</A>
<BR>
<A HREF="#4.2">
4.2: How do I upgrade <i>gcc</i> to <i>egcs</i>
</A>
<Blockquote>
<font size=-1>
<A HREF="#4.2.1">4.2.1 - i386 and sparc are no longer #define'ed </A><BR>
<A HREF="#4.2.2">4.2.2 - Build fails in xlint </A><BR>
<A HREF="#4.2.3">4.2.3 - Core Dump on uthread_autoinit.c </A><BR>
<A HREF="#4.2.4">4.2.4 - egcs seems much slower than gcc </A><BR>
<A HREF="#4.2.5">4.2.5 - egcs generates larger code than gcc </A><BR>
<A HREF="#4.2.6">4.2.6 - After installing egcs I have very little disk space 
left </A><BR>
<A HREF="#4.2.7">4.2.7 - My build fails to build libcurses</A><BR>
<A HREF="#4.2.8">4.2.8 - make obj fails</A>
</font>
d150 4
a153 4
<A HREF="#4.3">
4.3: My <I>make build</I> dies with <I>unimplemented syscall</i> errors.
</A>
<BR>
d155 1
a155 1
<A HREF="#4.4">
d157 1
a157 2
</A>
<BR>
d159 2
a160 2
<A HREF="#4.5">
4.5: After an <B>(U)</B>pgrade, extraction of <i>base26.tar.gz</i>
d162 2
a163 1
</A>
d165 1
a165 1
<h3>5.0 - Upgrading from 2.6</h3>
d167 2
a168 1
<A HREF="#5.1">
d170 1
a170 2
</A>
<BR>
d172 4
a175 5
<A HREF="#5.2">
5.2: My <I>pn</I> (or <I>mx</I>, <I>al</I>, <I>ax</I>) device is no longer
recognized by the kernel.
</A>
<BR>
d177 1
a177 1
<A HREF="#5.3">
d179 1
a179 2
</A>
<BR>
d181 1
a181 1
<A HREF="#5.4">
d183 1
a183 2
</A>
<BR>
d185 1
a185 1
<A HREF="#5.5">
d187 1
a187 2
</A>
<BR>
d189 1
a189 1
<A HREF="#5.6">
d191 1
a191 2
</A>
<BR>
d193 1
a193 1
<A HREF="#5.7">
d195 3
a197 3
<I>apm(8)</I> support no longer boot.
</A>
<BR>
d199 1
a199 1
<h3>6.0 - Upgrading from 2.7</h3>
d201 2
a202 1
<A HREF="#6.1">
d204 2
a205 2
</A>
<BR>
d207 1
a207 1
<h3>7.0 - Upgrading from 2.8</h3>
d209 2
a210 1
<A HREF="#7.1">
d212 1
a212 2
</A>
<BR>
d214 1
a214 1
<A HREF="#7.2">
d216 1
a216 2
</A>
<BR>
d218 1
a218 1
<A HREF="#7.3">
d220 1
a220 2
</A>
<BR>
d222 1
a222 3
<P>

<h3>8.0 - Upgrading from 2.9</h3>
d224 2
d227 1
a227 1
8.1: New users/groups - <i>proxy</i>, <i>smmsp</i> and <i>popa3d</i>
d232 1
a232 1
8.2: New packet filter: <i>pf</i>
d237 1
a237 1
8.3: Changes to <i>make</i>
d255 3
a258 3

<h3>9.0 - Upgrading from 3.0</h3>

d269 7
a275 1
<p>
d277 5
a281 1
&nbsp;<HR Width="30%"><P>
d283 1
a283 7
<H3>1.0: General Upgrade Questions</H3>
<h4><A NAME="1.1">
1.1: Terminology. What is <I>-current</I>? What are Snapshots? What is
<I>-stable</I>?
</A>
</h4>
<P>
d286 3
a288 1
<P>
d290 4
a293 4
six-month intervals, OpenBSD <B>releases</B> are produced. These are
numbered in the conventional (2.x) manner. The current OpenBSD release is
2.9. 
<P>
d295 2
a296 1
<B>-current</B>, short for <I>openbsd-current</I>, refers to the
d299 1
a299 1
most commonly used by OpenBSD developers. The <I>-current</I> tree contains
d304 2
a305 1
to <I>-current</I> is not recommended for non-technical users.
d307 4
a310 4
<P>
Between formal releases, a series of <B>snapshot</B> releases are 
<A HREF="ftp://ftp.openbsd.org/pub/OpenBSD/snapshots/"> made available.</A> 
Snapshots are test releases of the <I>-current</I> source tree. 
d315 1
d317 3
a319 3
<P>
As of OpenBSD 2.7, a <A HREF="../stable.html">patch branch</A> (called
<B>-stable</B>) was introduced.  This branch contains the base
d323 1
d325 2
a326 2
<P>
The <A HREF="../ports.html">ports tree</A> is an integral part of the
d331 1
d333 6
a338 5
<H4><A NAME="1.2">
1.2: What is the best way to upgrade to <I>-current</I>?
</A>
</H4>
<P>
d340 1
a340 1
a release to <I>-current</I> is not always easy. 
d342 1
a342 1
move up to <I>-current</I> is to first upgrade to the latest snapshot
d344 2
a345 2
latest source can be <A HREF="#1.4">fetched</A> and 
<A HREF="#1.5">built</A>. This
d347 1
d349 2
a350 2

<h4><A NAME="1.3">
d353 1
a353 1
</A></H4>
d355 1
a355 3
The snapshots used to be taken temporarily offline right around the release
time of a new version. This is no longer the OpenBSD policy.
<P>
d359 1
d361 2
a362 2

<h4><A NAME="1.4">
d364 1
a364 1
</A></H4>
d366 4
a369 3
Short answer: <A HREF="../anoncvs.html">http://www.openbsd.org/anoncvs.html</A>

<P>
d371 1
d373 2
a374 1
(using the bash shell. Others substitute <I>setenv</I> for <I>export</I>)
d376 1
a376 1
<PRE>
d381 1
a381 1
</PRE>
d383 2
a384 2

<h4><A NAME="1.5">
d386 1
a386 1
</A></H4>
d388 4
a391 3
<P>

Basic instructions are in /usr/src/Makefile. This is a slightly expanded
d393 1
d395 1
d397 2
a398 1
<OL>
d400 1
a400 3
<LI> Clean out the old object files.

<P>
d403 1
d405 1
a405 1
<PRE>
d410 1
a410 1
</PRE>
d412 1
d414 3
a416 2
to place /usr/obj onto its own partition, and use <i>newfs</I> instead 
of <i>rm</i>. For example, I do a:
d418 1
a418 1
<PRE>
d423 1
a423 1
</PRE>
d425 1
d428 1
d430 1
a430 1
<PRE>
d437 3
a439 1
</PRE>
d441 4
a444 2
<LI> Perform any version-specific configuration changes. For example, 
2.3 users must add the <I>named</I> user and group before
d446 3
a448 1
your version.<P>
d450 3
a452 1
<LI> Make sure all the appropriate directories are created. This
d455 1
d457 1
a457 1
<PRE>
d459 2
a460 1
</PRE>
d462 2
a463 1
<LI> Compile a new kernel.
d465 1
a465 1
<PRE>
d467 5
a471 3
</PRE>
Most users will want to use GENERIC:
<PRE>
d474 1
a474 1
</PRE>
d476 2
a477 1
<b>NOTE:</b> For the truly masochistic in the crowd, you may want
d481 1
d483 1
a483 1
<PRE>
d489 3
a491 1
</PRE>
d493 3
a495 1
<PRE>
d501 2
a502 1
</PRE>
d504 2
a505 1
<LI> Compile the system.
d507 1
a507 1
<PRE>
d510 4
a513 1
</PRE>
d515 1
a515 1
<LI> Update <tt>/etc</tt> and <tt>/dev</tt> by hand. These are not updated 
d517 2
a518 1
hold /, /dev, /var, and /etc. Here I'll use <I>/home/newroot</I> 
d520 1
a520 1
<PRE>
d524 1
a524 1
</PRE>
d526 1
d530 1
d532 1
a532 1
<PRE>
d534 2
a535 1
</PRE>
d537 4
a540 2
<LI> Reboot to make sure the new /etc files are correct
</OL>
d542 2
a543 1
<h4><A NAME="1.6">
d545 1
a545 3
</A></H4>

<P>
d547 1
d549 1
d551 1
a551 1
<PRE>
d554 1
a554 1
</PRE>
d556 1
d558 1
d560 12
a571 12
<PRE>
(cd /usr/src/share/mk &amp;&amp;  make install)
(cd /usr/src/include; make prereq;  make includes)
make cleandir
(cd /usr/src/lib &amp;&amp; make depend &amp;&amp; make &amp;&amp;   make install)
(cd /usr/src/gnu/lib &amp;&amp; make depend &amp;&amp; make &amp;&amp;   make install)
(cd /usr/src/kerberosIV/lib &amp;&amp; make depend &amp;&amp; make &amp;&amp;   make install)
(cd /usr/src/gnu/usr.bin/perl &amp;&amp;  make -f Makefile.bsd-wrapper config.sh &amp;&amp;  mak
e -f Makefile.bsd-wrapper depend &amp;&amp;  make -f Makefile.bsd-wrapper perl.lib &amp;&amp;
make -f Makefile.bsd-wrapper install.lib)
make depend &amp;&amp; make &amp;&amp;  make install
</PRE>
d573 1
d576 3
a578 1
<P>
d580 2
a581 2
makefile. Simply copy the entry for <I>build</I> (to 
<I>build-noclean</I>, for example), and remove the <I>make cleandir</I> 
d583 1
d585 2
a586 1
<H4><A NAME="1.7">
d588 1
a588 1
</A></H4>
d590 2
a591 1
If your <i>make build</i> ends with an error, chances are it is
d593 2
a594 1
See <A HREF="#1.5">1.5</A> for details on cleaning out these objects.
d596 1
d599 1
d602 2
a603 1
<li>You have encountered a known upgrade issue. Make sure you have
d606 1
d608 2
a609 1
<li>You have encountered a new upgrade issue. This is life on the bleeding
d611 1
a611 1
<A HREF="../mail.html">misc@@ and tech@@</A>
d613 1
d615 2
a616 1
<li>Someone has temporarily broken the source tree. This type of break
d620 1
d623 1
d628 1
a628 1
<P>
d630 5
a634 6
<h4><A NAME="1.8">
1.8: I'm upgrading to a newer version of the compiler (<I>gcc</i>). Is there a
standard way of bootstrapping it?
</A></H4>

<P>
d636 1
d640 3
a642 1
<P>
d644 1
d646 1
a646 1
<PRE>
d658 7
a664 3
</PRE>
And then run a normal <i>make build</i>.
<P>
d667 1
d669 1
a669 1
<PRE>
d678 1
a678 1
</PRE>
d681 2
a682 1
<h4><A NAME="1.9">
d685 1
a685 1
</A></H4>
d687 7
a693 1
<P>
d695 1
a695 4
<B>Short Answer</B>: By Hand.
<P>
<B>Long answer</B>:
<P>
d697 1
a697 1
<tt>/etc</tt> automatically. This means it is <b>always</b> up to
d702 3
a704 1
<P>
d707 3
a709 1
<PRE>
d712 1
a712 1
</PRE>
d714 1
d716 1
a716 1
OpenBSD, you can use <A HREF="../anoncvs.html">CVS</A>. For example, 
d718 3
a720 1
<PRE>
d723 1
a723 1
</PRE>
d725 1
d728 1
d730 2
a731 1
<h4><A NAME="1.10">
d733 1
a733 1
</A></H4>
d735 1
d739 1
d741 1
a741 1
<PRE>
d748 1
a748 1
</PRE>
d750 1
d754 1
d756 4
a759 3
<h4><A NAME="1.11">
1.11: Do I have to be root to do a <i>make build</i>?
</A></H4>
d761 1
d764 1
a764 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sudo&apropos=0&sektion=8&manpath=OpenBSD+Current&arch=i386&format=html">sudo(8)</a>
d766 1
d768 1
a768 1
<P>
d771 1
a771 1
</P>
d773 3
a775 2
<UL>
<LI> Place SUDO=/usr/bin/sudo in your environment prior to starting the build,
d777 5
a781 2
<LI> Add the line "SUDO=/usr/bin/sudo" to your <tt>/etc/mk.conf</tt> file.
</UL>
d783 2
a784 1
<h4><A NAME="1.12">
d786 1
a786 1
</A></h4>
d788 1
d790 1
a790 1
as part of the <i>make build</i> process. As a general rule, it
d793 1
d801 3
a803 1
<h4><A NAME="1.13">
d805 1
a805 1
</A></h4>
d807 1
d812 1
a812 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mtree&sektion=8"
d814 1
d818 1
d827 1
d829 4
d834 2
a835 2
<H3>2.0: Upgrading from 2.3</H3>
<h4><A NAME="2.1">
d837 1
a837 1
</A></H4>
d839 1
a839 2
<P>
<h4>New User: <i>named</i></h4>
d841 3
a843 2
After 2.3, the <I>named</I> DNS daemon was moved to a chroot jail.
To make this change possible, the <I>named</I> user was created.
d846 1
a846 1
<P>
d848 5
a852 2
Add the following entry to /etc/passwd using <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&sektion=8">vipw(8)</a>:
<PRE>
d854 1
a854 1
</PRE>
d856 1
d858 3
a860 1
<PRE>
d862 1
a862 1
</PRE>
d865 4
a868 3
<h4><A NAME="2.2">
2.2: I tried the build, but it failed when trying to compile <I>ssleay</I>.
</A></H4>
d870 2
a871 1
You are likely missing an entry for the <I>named</I> user in your
d873 1
d875 5
a879 3
<P>
<B>Short Answer:</B>
<P>
d881 1
d883 3
a885 1
<P>
d887 2
a888 5
<B>Long Answer:</B>

<P>

The <I>named</I> user is required in order to set permissions
d890 3
a892 2
If you capture your build to a file (say, with a <I>make build
&amp;&gt;/tmp/build.log</I>) you will notice the following message:
d894 1
a894 1
<PRE>
d902 1
a902 1
</PRE>
d904 1
d907 1
d909 3
a911 1
<P>
d913 1
a913 3
If the <I>named</I> user exists, mtree works properly:

<PRE>
d932 1
a932 1
</PRE>
d934 4
a937 2
The reason for the fail, then, is that the <I>/usr/include/ssl</I> directory
was never created. Without the header files, the <I>ssleay</I> build fails.
d939 3
a941 1
<P>
d943 5
a947 3
<B>Fix:</B>

<P>
a948 3
Create the <I>named</I> user and group. Remove <I>/usr/include/ssl</I>,
<I>/var/named</I>, and any other directory from the list above that was
mistakenly created as a normal file by the <I>make build</I>.
d950 2
a951 3


<h4><A NAME="2.3">
d954 1
a954 1
</A></H4>
d956 4
a959 1
<P>
d961 3
a963 2
Your directory tree is incomplete. Specifically, the 
/usr/share/man/cat4/powerpc directory is missing. 
d965 1
a965 2
<P>
<B>Quick Fix:</B><P>
d967 1
d969 3
a971 3
<P>
<B>Complete Fix:</B>
<P>
d973 1
d975 1
d977 1
a977 1
<PRE>
d979 1
a979 1
</PRE>
d981 1
d983 1
d985 1
a985 1
<PRE>
d1007 1
a1007 1
</PRE>
d1009 1
d1011 1
d1013 5
a1017 2
<H3>3.0: Upgrading from 2.4</H3>
<h4><A NAME="3.1">
d1019 1
a1019 1
</A></H4>
d1021 2
a1022 2
<P>
<h4>cap_mkdb</h4>
d1024 5
a1028 3
The syntax for invoking <I>cap_mkdb</I> has changed slightly.
Before doing a <I>make build</I>, rebuild cap_mkdb from the latest source:
<PRE>
d1031 3
a1033 1
</PRE>
d1035 1
d1037 2
a1038 3
<P>

<h4>Man Page Changes</h4>
d1042 3
a1044 1
<P>
d1046 2
a1047 1
<PRE>
d1051 1
a1051 1
</PRE>
d1053 2
a1054 1
<H4>Snake</h4>
d1057 1
d1059 1
a1059 2

<h4><A NAME="3.2">
d1061 1
a1061 1
</A></H4>
d1063 3
a1065 2
<B>Symptom:</B>
<P>
d1067 5
a1071 2
A <I>make build</I> resulted in an error like this:
<PRE>
d1076 1
a1076 1
</PRE>
d1078 3
a1080 1
<B>Quick Fix:</B><P>
d1082 4
a1085 2
You need to build a new <I>cap_mkdb</I>. See 
<A HREF="#3.1">3.1</A>.
d1087 2
d1090 2
a1091 2
<H3>4.0: Upgrading from 2.5</H3>
<h4><A NAME="4.1">
d1093 1
a1093 1
</A></H4>
d1095 6
a1100 1
<P>
d1102 1
a1102 4
<h5><I>perl</I> and <i>make</I></h5>
The latest version of Perl (5.005_03) requires a new version of <I>make</I> to
compile properly. You must rebuild make before building the new Perl. Do a:
<PRE>
d1105 3
a1107 1
</PRE>
d1109 2
a1110 2
<CODE>obj</CODE> directory by hand before building.
<P>
d1112 1
d1115 1
d1117 1
a1117 1
<PRE>
d1141 1
a1141 1
</PRE>
d1143 2
a1144 1
<H5>Compiler Change: <I>egcs</I> replaces <I>gcc</I></H5>
d1146 2
a1147 1
For detailed instructions, see section <A HREF="#4.2">4.2</A>.
d1149 2
a1150 1
<H5>Kernel Structure - <I>statfs</I> - changed</H5>
d1152 3
a1154 2
rebuild your kernel before attempting a <i>make build</i>.
See <A HREF="#4.3">4.3</A> for details.
d1156 4
a1159 3
<h4><A NAME="4.2">
4.2: How do I upgrade <i>gcc</i> to <i>egcs</i>
</A></H4>
d1161 1
d1163 3
a1165 2
available. <b>Look for a snapshot first!</b>. Bootstrapping the new 
compiler from the old should be a <I>last resort</I>.
d1167 1
a1167 1
<P>
d1171 8
a1178 7
<UL>
<LI><b>i386</b>
<LI><b>sparc</b>
<LI><b>m68k</b>
<LI><b>alpha</b>
</UL>
<B>mips</b> and <b>rs6000</b> have problems.
d1180 5
a1184 1
<P>
d1187 1
a1187 1
<A HREF="../ports.html">ports collection</A>. 
d1189 2
a1190 1
This is the <i>safest</i> method of proceeding.
d1192 8
a1199 8
<P>
Now, before going any further, ensure that your copies of 
<I>binutils</i>, <I>gas</i>, and <I>ld</I> are up to date.
Note that there are two copies of <I>gas</I> and <i>ld</i> in the tree. 
On <b>i386</b> and <b>sparc</b>, the binutils versions are not used.
Check 
<tt>/usr/src/gnu/usr.bin/gas</tt> and <tt>/usr/src/gnu/usr.bin/ld</tt>
instead.
d1201 1
a1201 1
<P>
d1207 1
d1209 3
a1211 1
<P>
a1212 1
From espie@@openbsd.org:
d1214 1
a1214 1
<PRE>
d1337 1
a1337 1
</PRE>
d1340 1
d1342 5
a1346 3
The fix is simple though. Simply do a <CODE> make &amp;&amp; make install </CODE>
in the <CODE>/usr/src/usr.bin/xlint/xlint</CODE> directory before 
you attempt a <i>make build</i> and proceed. See <A HREF="#4.2.2">4.2.2</A>.]
d1348 1
a1348 2

<PRE>
d1369 1
a1369 1
</PRE>
d1376 2
a1377 1
<H5><A NAME="4.2.1">
d1380 1
a1380 1
</A></H5>
d1382 2
a1383 1
This is true. <I>egcs</i> uses the cleaner <tt>__i386__</tt> and
d1387 1
d1389 2
a1390 1
<H5><A NAME="4.2.2">
d1392 1
a1392 1
</A></H5>
d1394 1
d1396 4
a1399 2
and similar to the <i>cap_mkdb</i> issue described in <A HREF="#3.1">3.1</A>.
<P>
d1401 1
d1403 1
a1403 1
<PRE>
d1406 1
a1406 1
</PRE>
d1408 1
d1410 1
d1412 2
a1413 1
<H5><A NAME="4.2.3">
d1415 1
a1415 1
</A></H5>
d1417 1
d1419 1
d1421 1
a1421 1
<PRE>
d1447 1
a1447 1
</PRE>
d1449 4
a1452 3
<H5><A NAME="4.2.4">
4.2.4 - <i>egcs</i> seems much slower than <i>gcc</i>
</A></H5>
d1454 2
a1455 1
It is, but there is a reason. <I>egcs</i> performs more optimizing passes.
d1457 2
a1458 1
<I>egcs</i>-generated code.
d1460 4
a1463 3
<H5><A NAME="4.2.5">
4.2.5 - <I>egcs</i> generates larger code than <i>gcc</i>
</A></H5>
d1465 6
a1470 3
Yes it does. This is especially noticeable with the old <tt>-O2</tt> gcc switch. 
<I>egcs</I> introduces a new option, <tt>-Os</tt> which optimizes for space.
This is roughly comparable to the old <TT>-O2</TT> behavior.
d1472 4
a1475 3
<H5><A NAME="4.2.6">
4.2.6 - After installing <i>egcs</i> I have very little disk space left
</A></H5>
d1477 4
a1480 2
<i>egcs</i> installs into a different subdirectory than gcc 2.8.1. You
may remove <I>gcc</i> once egcs is bootstrapped and working.
d1482 2
a1483 1
(on a related note, the perl changes mentioned in <A HREF="#4.1">4.1</A>
d1485 2
a1486 1
new location for this data is <tt>/usr/libdata/perl5</tt>.)
d1488 2
a1489 1
<H5><A NAME="4.2.7">
d1491 1
a1491 1
</A></H5>
d1493 5
a1497 3
<i>libcurses</i> now relies on the latest version of <i>cpp</i>.
Fetch the latest version, rebuild <i>cpp</i>, and continue. Eg:
<PRE>
d1499 1
a1499 2
</PRE>
And try the make build again.
d1501 4
a1504 1
<H5><A NAME="4.2.8">
d1506 1
a1506 1
</A></H5>
d1508 2
a1509 1
If your <i>make obj</i> fails, citing errors in a Makefile, your
d1511 3
a1513 1
<PRE>
d1521 1
a1521 1
</PRE>
d1523 1
d1525 1
d1527 1
a1527 1
<PRE>
d1529 1
a1529 1
</PRE>
d1531 1
d1533 6
d1540 1
a1540 4
<h4><A NAME="4.3">
4.3: My <I>make build</I> dies with <I>unimplemented syscall</i> errors.
</A></H4>
<B>Short Answer:</B> <P>
d1542 1
d1544 2
a1545 2
the kernel before attempting a <I>make build</I>.
<P>
d1547 3
a1549 1
<B>Long Answer:</B> <P>
d1552 1
d1554 3
a1556 2
<UL>
<LI> Has a <tt>u_int32_t</tt> flags field--now softdep can have a real flag.
d1558 1
a1558 1
<LI> Uses <tt>u_int32_t</tt> instead of longs (nicer on the alpha).  
d1561 1
d1563 1
a1563 1
<LI> Gets rid of <tt>f_type</tt> completely.  It hasn't been used since NetBSD 
d1567 1
d1569 2
a1570 2
<LI> Adds a <tt>mount_info</tt> union that contains the <tt>FSTYPE_args</tt>
struct.  This means that <I>mount</I> can now tell you all the options a 
d1572 2
a1573 1
</UL>
d1575 1
d1577 1
d1579 2
a1580 2
<UL>
<LI> The linux statfs emulation didn't convert between BSD fs names
d1583 1
d1585 1
a1585 1
<LI> FreeBSD's struct statfs is different from ours (both old and new)
d1588 1
d1590 1
a1590 1
<LI> <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mount&apropos=0&sektion=8&manpath=OpenBSD+Current&arch=i386&format=html">mount(8)</a>
d1592 3
a1594 2
However, to see <I>everything</I> you need to use the -v (verbose) flag. 
</UL>
d1596 2
a1597 1
<h4><A NAME="4.4">
d1599 1
a1599 1
</A></H4>
d1610 3
a1612 2
<h4><A NAME="4.5">
4.5: After an <B>(U)</B>pgrade, extraction of <i>base26.tar.gz</i>
d1614 1
a1614 1
</A></H4>
d1616 2
a1617 2
<P>
<I>tar: Unable to remove directory ./usr/include/machine &lt;Directory
d1619 2
a1620 2
</I>
</P>
d1622 1
a1622 1
<P>In 2.5, <tt>/usr/include/machine</tt> was a directory, and
d1625 1
a1625 1
</P>
d1627 1
a1627 1
<P>
d1629 1
a1629 1
</P>
d1631 4
a1634 5
<P>
<H3><a name="5.0">
5.0 - Upgrading from 2.6 to 2.7
</A></H3>
</P>
d1636 2
a1637 1
<H4><A NAME="5.1">
d1639 1
a1639 1
</A></H4>
d1641 1
a1641 1
<P>
d1645 2
a1646 2
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tic&apropos=0&sektion=1&manpath=OpenBSD+Current&arch=i386&format=html">tic(1)</a>.
If you are upgrading via <i>make build</i>, the correct version of
d1649 1
a1649 1
</P>
d1651 1
a1651 1
<PRE>
d1653 1
a1653 1
</PRE>
d1655 1
a1655 1
<P>
d1659 1
a1659 1
</P>
d1661 3
a1663 2
<H4><A NAME="5.2">
5.2: My <I>pn</I> (or <I>mx</I>, <I>al</I>, <I>ax</I>) device is no longer
d1665 6
a1670 1
</A></H4>
d1672 5
a1676 9
<P> (Note: <I>pn</I> is used below for simplicity. This should
be taken to read <I>pn</I>, <I>mx</I>, <I>al</I>, or <I>ax</I>
as appropriate)</P>

<P>
These four drivers were replaced with the a unified <I>dc</I> driver.
You must change all occurrences of <I>pn*</I>, <I>mx</I>,
<I>al</I>, or <I>ax</I> in your configuration files. This includes:
</P>
d1678 2
a1679 2
<UL>
<LI>Updating your kernel configuration file(s). (Hint: start with a
d1681 8
a1688 5
<LI>mv'ing <tt>/etc/hostname.pn*</tt>  to <tt>/etc/hostname.dc*</tt>
<LI>Updating your <tt>/etc/ifaliases</tt> file.
<LI>Changing your <tt>/etc/ipnat.rules</tt> and <tt>/etc/ipf.rules</tt> to
    reflect the new interface name.
</UL>
d1690 1
a1690 1
<P>
d1692 4
a1695 3
included the <i>dcphy</i> device in your kernel config, as follows:
</P>
<PRE>
d1697 5
a1701 3
</PRE>
<P>While you are at it, you may also want to add:</P>
<PRE>
d1703 1
a1703 1
</PRE>
d1705 2
a1706 1
<H4><A NAME="5.3">
d1708 1
a1708 1
</A></H4>
d1710 6
a1715 5
<P><I>gcc</I> 2.95.2 was merged into the OpenBSD source tree around
January 19, 2000. In order for <I>gcc</I> to build properly, a more
recent (post 2.6) <i>libiberty</I> is required. To build this library,
do the following:</P>
<PRE>
d1721 1
a1721 1
</PRE>
d1723 1
d1725 2
a1726 1
perform an explicit <i>ldconfig</i> after new libraries are build.
d1728 2
a1729 2
<P>Once <i>libiberty</i> is build, you may proceed with a standard
<i>gcc</I> bootstrap:</P>
d1731 1
a1731 1
<PRE>
d1740 1
a1740 1
</PRE>
d1742 2
a1743 1
<H4><A NAME="5.4">
d1745 1
a1745 1
</A></H4>
d1747 1
a1747 1
<P>
d1750 1
d1752 4
a1755 3
<UL>
<LI> Obtain and build the latest <tt>usr.bin/compile_et</tt>.
<PRE>
d1758 6
a1763 3
</PRE>
<LI> Obtain and build the latest <tt>lib/libcom_err</tt>.
<PRE>
d1766 6
a1771 3
</PRE>
<LI> Clean out and reinstall the Kerberos header files:
<PRE>
d1775 5
a1779 3
</PRE>
<LI> Now, rebuild the Kerberos library files:
<PRE>
d1782 5
a1786 3
</PRE>
<LI> If you are not doing a complete make build, rebuild Kerberos:
<PRE>
d1789 4
a1792 4
</PRE>
<LI> Otherwise, simply restart your <I>make build</I>.
</UL>
</P>
d1794 3
a1796 1
<H4><A NAME="5.5">
d1798 1
a1798 1
</A></H4>
d1800 1
a1800 1
<P>
d1803 5
a1807 3
of this you will need to install the new version of m4 <B>before</B>
you attempt a <I>make build</I>.  In other words:
<PRE>
d1810 1
a1810 2
</PRE>
</P>
d1812 2
a1813 1
<H4><A NAME="5.6">
d1815 1
a1815 1
</A></H4>
d1817 1
a1817 1
<P>
d1821 1
a1821 1
</P>
d1823 38
a1860 38
<TABLE BORDER=0>
<TR>
  <TD><B>OLD</B></TD>
  <TD><B>NEW</B></TD>
</TR>
<TR>
  <TD><TT>/etc/sendmail.cf</TT></TD>
  <TD><TT>/etc/mail/sendmail.cf</TT></TD>
</TR>
<TR>
  <TD><TT>/etc/sendmail.cw</TT></TD>
  <TD><TT>/etc/mail/local-host-names</TT></TD>
</TR>
<TR>
  <TD><TT>/etc/sendmail.ct</TT></TD>
  <TD><TT>/etc/mail/trusted-users</TT></TD>
</TR>
<TR>
  <TD><TT>/etc/sendmail.oE</TT></TD>
  <TD><TT>/etc/mail/error-header</TT></TD>
</TR>
<TR>
  <TD><TT>/etc/aliases</TT></TD>
  <TD><TT>/etc/mail/aliases</TT></TD>
</TR>
<TR>
  <TD><TT>/etc/service.switch</TT></TD>
  <TD><TT>/etc/mail/service.switch</TT></TD>
</TR>
<TR>
  <TD><TT>/etc/userdb</TT></TD>
  <TD><TT>/etc/mail/userdb</TT></TD>
</TR>
<TR>
  <TD><TT>/usr/share/misc/sendmail.hf</TT></TD>
  <TD><TT>/etc/mail/helpfile</TT></TD>
</TR>
</TABLE>
d1862 1
a1862 1
<P>
d1865 1
a1865 1
</P>
d1867 5
a1871 5
<OL>
<LI> Update <TT>/etc/rc</TT> so that it looks for
     <TT>/etc/mail/sendmail.cf</TT> instead of <TT>/etc/sendmail.cf</TT>

<LI> <TT>mv /etc/sendmail.cf /etc/mail/sendmail.cf</TT> <BR>
d1874 2
a1875 2

<LI> Or, build a new .cf file from your .mc source file.  Note that you
d1877 1
a1877 1
     <PRE>include(`../m4/cf.m4')</PRE>
d1880 1
a1880 1
     to do that in the LOCAL_CONFIG section (see <TT>openbsd-lists.mc</TT>
d1882 2
a1883 2
</OL>

d1885 2
a1886 1
<h4><a name="5.7"></a>
d1888 1
a1888 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=apm&apropos=0&sektion=8&manpath=OpenBSD+Current&arch=i386&format=html">apm(8)</a>
d1890 1
a1890 1
</h4>
d1892 1
d1894 1
a1894 1
<A HREF="faq14.html#14.8">Section 14.8</A>
d1896 1
d1898 2
a1899 1
<H3><A NAME="6.0">
d1901 1
a1901 1
</A></H3>
d1903 2
a1904 1
<H4><A NAME="6.1">
d1906 1
a1906 1
</A></H4>
d1908 1
d1910 1
a1910 1
to generate self-referencing <i>libc</i> libraries. For this reason, upgrades
d1912 1
d1916 1
a1916 1
the 2.8 code.<P>
d1918 6
a1923 3
<li> Build and install a new linker. This <b>must</b> be done before
a full <i>gcc</i> build.
<PRE>
d1927 3
a1929 3
</PRE>

<li> Build and install the new <i>gcc</i>. Use the
d1931 2
a1932 1
     things up.<P>
d1934 3
a1936 2
<li> Build a new kernel. Do not install it yet
<PRE>
d1941 2
a1942 1
</PRE>
d1944 4
a1947 4
<li> Because of some libc changes, your machine may hang on startup unless
   your <tt>/etc/resolv.conf</tt> contains <i>lookup file bind</i>.
   Add this line if necessary
<PRE>
d1949 2
a1950 2
</PRE>

d1952 1
a1952 1
<PRE>
d1958 2
a1959 1
</PRE>
d1961 4
a1964 3
at the <tt>boot&gt;</tt> prompt.)<P>

<li> Build and install the new make (and support files). 
d1966 2
a1967 1
<PRE>
d1973 2
a1974 1
</PRE>
d1976 1
a1976 1
<li> Install the latest <i>mtree</i>, and ensure the necessary directory
d1978 1
a1978 1
<PRE>
d1982 2
a1983 1
</PRE>
d1986 1
a1986 1
<PRE>
d1988 2
a1989 1
</PRE>
d1994 1
d1997 2
a1998 1
<H3><A NAME="7.0"></A>
d2000 1
a2000 1
</H3>
d2002 2
a2003 1
<H4><A NAME="7.1">
d2005 1
a2005 1
</A></H4>
d2007 2
a2008 1
A new group, <i>auth</i>, gid 11, has been added to the system.
d2010 3
a2012 1
<PRE>
d2014 1
a2014 1
</PRE>
d2016 2
a2017 1
<H4><A NAME="7.2">
d2019 1
a2019 1
</A></H4>
d2021 2
a2022 1
The <i>pcvt</i> console driver has been replaced with the <i>wscons</i>
d2026 2
d2034 2
a2035 1
If you are running X, change the Pointer section of your <i>XF86Config</i> 
d2037 3
a2039 1
<PRE>
d2042 1
a2042 1
</PRE>
d2044 2
a2045 1
<H4><A NAME="7.3">
d2047 1
a2047 1
</A></H4>
d2049 3
a2051 2
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&apropos=0&sektion=8&manpath=OpenBSD+Current&arch=i386&format=html">config(8)</a>
has been updated. Building with the old <i>config</i> will result
d2053 1
d2055 1
a2055 1
<PRE>
d2058 1
a2058 1
</PRE>
d2060 3
a2062 1
To correct this, compile and install the new <i>config</i>:
d2064 1
a2064 1
<PRE>
d2068 1
a2068 1
</PRE>
d2070 1
d2072 1
d2074 2
a2075 1
<h3><a name="8.0"></a>
d2077 5
a2083 5
<h4><a name="8.1">
8.1: New users/groups - <i>proxy</i>, <i>smmsp</i>, and <i>popa3d</i>.
</a></h4>


d2086 1
a2086 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&sektion=4"
d2088 1
a2088 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftp-proxy&sektion=8"
d2090 1
a2090 1
group named <i>proxy</i> were added to the system.  To support this
d2092 1
a2092 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&sektion=8">vipw(8)</a>:
d2100 1
a2100 1
Also add the <i>proxy</i> group to /etc/group:
d2109 1
a2109 1
setuid root.  Both a new user and a new group, named <i>smmsp</i>,
d2119 1
a2119 1
Then, run <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&sektion=8">vipw(8)</a> and add the following line for the <i>smmsp</i> user:
d2127 1
a2127 1
Make sure this line appears before any <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=yp&sektion=8">yp(8)</a> settings line.
d2141 1
a2141 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&sektion=8"
d2149 4
d2154 1
a2154 4
<h4><a name="8.2">
8.2: New packet filter: <i>pf</i>
</a></h4>

d2157 1
a2157 1
called <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&sektion=4"
d2159 1
d2161 1
a2161 1
<p>First, <i>pf</i> depends on a new device file. To ensure that this
d2163 1
d2171 1
d2174 2
d2186 1
d2188 2
d2195 1
d2197 2
d2204 2
a2205 1
A mechanism for safely enabling <i>pf</i> has been added to the
d2208 2
a2209 1
to enable <i>pf</i>, set PF=YES in <tt>/etc/rc.conf</tt>.
d2211 4
a2214 3
<h4><a name="8.3">
8.3: Changes to <i>make</i>
</a></h4>
d2216 1
d2218 1
a2218 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=make&sektion=1"
d2221 1
a2221 1
errors from <i>bsd.own.mk</i> during the build. To avoid these issues,
d2224 1
d2231 1
d2233 1
d2241 1
d2243 1
d2245 1
a2245 1
<h4><a name="8.4">
d2247 1
a2247 1
</a></h4>
d2249 1
d2252 1
d2257 1
a2257 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mtree&sektion=8"
d2260 1
d2264 1
d2276 1
d2279 2
a2280 1
has been renamed to <tt>login_krb<b>4</b>-or-pwd</tt>.
d2282 2
a2283 1
<h4><a name="8.5">
d2285 1
a2285 1
</a></h4>
d2288 1
a2288 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sendmail&sektion=8"
d2290 1
a2290 1
<i>sendmail</i> no longer runs setuid root, significant changes have
d2293 1
d2295 1
a2295 1
<li> Both a new user and a new group (<i>smmsp</i>) have been added.
d2298 1
d2304 1
a2304 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mtree&sektion=8"
d2309 4
a2312 2
<li>Add the following to root's <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=crontab&sektion=1">crontab(1)</a>. This is necessary since
<i>sendmail</i> is no longer setuid root, and relies on this entry to
d2314 1
d2322 2
a2323 1
<li> Upgrade sendmail:
d2330 1
a2330 1
<p><b>Note:</b> The files <tt>submit.cf</tt> and <tt>localhost.cf</tt> have
d2341 1
a2341 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=smtpd&sektion=8">smtpd(8)</a>
d2354 3
a2356 1
<li> If you were running sendmail without the <tt>-bd</tt>
d2360 1
d2370 3
a2372 1
Once your configuration file is ready, <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=kill&sektion=1">kill(1)</a> the existing sendmail:
d2378 1
d2380 1
d2386 1
d2388 1
d2394 1
d2396 4
a2400 1
<p><b>Note:</b> the <tt>-bd</tt> flag is now needed in both cases.
d2405 3
a2407 1
The new <i>sendmail</i> should now be running.
d2409 2
a2410 1
<h4><a name="8.6">
d2412 1
a2412 1
</a></h4>
d2419 2
a2420 1
<h3><a name="9.0"></a>
d2422 1
a2422 1
</h3>
d2424 2
a2425 1
<h4><a name="9.1">
d2427 1
a2427 1
</a></h4>
d2429 1
d2432 2
a2433 1
steps:<br>
d2436 2
a2437 2
</pre>
<li>Recompile your system:
d2442 4
a2445 1
<li>If your &quot;make build&quot; completed successfully, you can step ahead
d2449 1
d2453 5
a2457 1
<li>With libdl removed, regen your shared libraries cache:
d2461 1
a2461 1

d2464 2
a2465 1
<h4><a name="9.2">
d2467 1
a2467 1
</a></h4>
d2472 1
a2472 1
this file before running <i>make obj</i>.
d2480 1
a2480 2
<P>
<FONT SIZE=-1>
d2482 7
a2488 6
<BR>
$OpenBSD: upgrade-minifaq.html,v 1.83 2002/01/10 09:42:10 reinhard Exp $

<BR>
Copyright &copy; 1998-2001, Kjell Wooding. 
<BR>
d2490 3
a2492 3
<A HREF="mailto:kjell@@openbsd.org">kjell@@openbsd.org</A>

</FONT>
d2494 2
a2495 2
</BODY>
</HTML>
@


1.83
log
@succesfully->successfully
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.82 2002/01/07 20:36:46 naddy Exp $
d226 1
a226 1
8.1: New Users - <i>proxy</i> and <i>smmsp</i>
d1614 1
a1614 1
<H4><A NAME="5.7">
d1616 1
a1616 1
<A HREF="http://www.openbsd.org/cgi-bin/man.cgi?query=apm&apropos=0&sektion=8&manpath=OpenBSD+Current&arch=i386&format=html">apm(8)</A>
d1618 1
a1618 1
</H4>
d1769 1
a1769 1
8.1: New Users - <i>proxy</i> and <i>smmsp</i>.
d1773 1
d1782 1
d1788 1
d1790 2
d1796 1
d1801 1
d1807 1
d1809 1
d1815 8
a1822 1
Make sure this line appears before any <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=yp&sektion=8">yp(8)</a> settings line.<p>
d1824 3
d1828 9
d2110 1
a2110 1
$OpenBSD: upgrade-minifaq.html,v 1.82 2002/01/07 20:36:46 naddy Exp $
@


1.82
log
@upgrading from 3.0: bsd.regress.mk; ok kjell@@
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.81 2001/12/31 00:32:07 horacio Exp $
d2049 1
a2049 1
<li>If your &quot;make build&quot; completed succesfully, you can step ahead
d2082 1
a2082 1
$OpenBSD: upgrade-minifaq.html,v 1.81 2001/12/31 00:32:07 horacio Exp $
@


1.81
log
@fix start html tag
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.80 2001/12/18 15:34:25 ian Exp $
d263 5
d2063 15
d2082 1
a2082 1
$OpenBSD: upgrade-minifaq.html,v 1.80 2001/12/18 15:34:25 ian Exp $
@


1.80
log
@Expand on multiple .cf files (ok kjell@@)
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.79 2001/12/10 17:00:59 kjell Exp $
d2021 1
a2021 1
<tt>/etc/primes</tt> has been renamed to </tt>/etc/moduli</tt>.
d2062 1
a2062 1
$OpenBSD: upgrade-minifaq.html,v 1.79 2001/12/10 17:00:59 kjell Exp $
@


1.79
log
@/etc/primes is now /etc/moduli. from jkrage@@buser.net
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.78 2001/11/26 02:12:25 pvalchev Exp $
d1953 15
a1967 1
been installed to your <tt>/etc/mail</tt> directory.</p>
d1971 3
a1973 1
working configuration files in <tt>/usr/share/sendmail/cf</tt>.<p>
d2062 1
a2062 1
$OpenBSD: upgrade-minifaq.html,v 1.78 2001/11/26 02:12:25 pvalchev Exp $
@


1.78
log
@Put back instructions about removing libdl.  If it is not removed, new
packages will continue to use it.  Put a note that warns about the
consequences of that step if you have packages installed on your system,
and that it can be skipped in this case temporarily.
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.77 2001/11/25 19:54:42 lebel Exp $
d250 4
d2000 9
d2046 1
a2046 1
$OpenBSD: upgrade-minifaq.html,v 1.77 2001/11/25 19:54:42 lebel Exp $
@


1.77
log
@Don't recommend to remove the libdl from the system, since this breaks already
installed ports that were linked to libdl. Eventually, it should be removed,
once ports are recompiled and/or upgraded. miod@@ OK.
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.76 2001/11/25 02:00:56 miod Exp $
d2015 12
d2033 1
a2033 1
$OpenBSD: upgrade-minifaq.html,v 1.76 2001/11/25 02:00:56 miod Exp $
@


1.76
log
@Oops, remove libdl_pic.a as well...
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.75 2001/11/25 01:53:34 pvalchev Exp $
a2014 8
<li>If your &quot;make build&quot; completed succesfully, remove your libdl:
<pre>
# rm -f /usr/lib/libdl.* /usr/lib/libdl_pic.a
</pre>
<li>With libdl removed, regen your shared libraries cache:
<pre>
# ldconfig -R
</pre>
d2021 1
a2021 1
$OpenBSD: upgrade-minifaq.html,v 1.75 2001/11/25 01:53:34 pvalchev Exp $
@


1.75
log
@fix a sentence, ok miod
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.74 2001/11/25 01:48:22 miod Exp $
d2017 1
a2017 1
# rm -f /usr/lib/libdl.*
d2019 1
a2019 1
<li>With libdl.so removed, regen your shared libraries cache:
d2029 1
a2029 1
$OpenBSD: upgrade-minifaq.html,v 1.74 2001/11/25 01:48:22 miod Exp $
@


1.74
log
@Instructions to update ELF systems now that libdl is gone.
ok pvalchev@@ kjell@@
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.73 2001/10/17 23:14:32 heko Exp $
d2015 1
a2015 2
<li>If your &quot;make build&quot; completed succesfully, remove your old libdl
archive:
d2029 1
a2029 1
$OpenBSD: upgrade-minifaq.html,v 1.73 2001/10/17 23:14:32 heko Exp $
@


1.73
log
@The ports tree is a part of the system that should be upgraded
following the same rules as everything else.
ok espie@@, kjell@@
@
text
@d10 1
a10 1
<h3>Latest OpenBSD Release - 2.9</h3>
d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.72 2001/10/10 07:09:58 kjell Exp $
d252 9
d1996 30
d2030 1
a2030 1
$OpenBSD: upgrade-minifaq.html,v 1.72 2001/10/10 07:09:58 kjell Exp $
@


1.72
log
@A long overdue rewrite and re-order of the post-2.9 section. mtree
trick moved to its own section. PF information is now more up-to-date.
Basically, the process can now be done in the order you'd expect.
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.71 2001/09/20 13:28:18 horacio Exp $
d297 5
a301 3
The <A HREF="../ports.html">ports tree</A> has a 
<A HREF="../ports.html#Life">special policy</A>
for following the src tree.
d1991 1
a1991 1
$OpenBSD: upgrade-minifaq.html,v 1.71 2001/09/20 13:28:18 horacio Exp $
@


1.71
log
@make(1), mtree(8), ftp-proxy(8), sendmail(8), vipw(8), yp(8)
crontab(1), kill(1)
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.70 2001/09/15 17:39:08 kjell Exp $
d25 3
a27 1
between OpenBSD releases, or from the releases to <I>-current</I>
d91 4
d226 1
a226 1
8.1: New packet filter
d231 1
a231 1
8.2: Changes to <i>make</i>
d236 1
a236 1
8.3: Build fails because of KerberosV errors
d241 1
a241 1
8.4: New proxy user
d658 1
a658 1
<h4><A NAME="#1.12">
d673 23
d1749 44
a1792 1
8.1: New packet filter.
d1795 7
a1801 2
With the integration of the new packet filter you need to
create its special device.  To make sure everything is updated:
d1809 2
a1810 2
With the IPF to PF transition, the binaries have
changed like this:
d1818 1
d1821 1
a1821 1
Devices:
d1827 1
a1827 1
And the filter configuration files:
d1833 4
a1836 1
Make sure you update them manually.
d1838 2
a1839 2
<h4><a name="8.2">
8.2: Changes to <i>make</i>
d1842 6
a1847 3
There have been changes to <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=make&sektion=1">make(1)</a> and its data files which need
to be updated before performing the build step. This usually
results in errors from <i>bsd.own.mk</i> during build. First update
d1863 4
a1866 2
<h4><a name="8.3">
8.3: Build fails because of KerberosV errors
d1872 1
d1874 4
a1877 7
<em>/etc</em>.  Use <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mtree&sektion=8">mtree(8)</a> to create it:
<pre>
  $ cd /usr/src/etc/mtree
  $ sudo install -c -o root -g wheel -m 600 special /etc/mtree
  $ sudo install -c -o root -g wheel -m 444 4.4BSD.dist /etc/mtree
  $ sudo mtree -qdef /etc/mtree/4.4BSD.dist -p / -u
</pre>
d1879 1
a1895 16
<h4><a name="8.4">
8.4: New proxy user
</a></h4>

With the addition of the <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftp-proxy&sektion=8">ftpproxy(8)</a> suite, a new user and
group named <i>proxy</i> were added to the system.  To support this
addition, add the following user entry using <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&sektion=8">vipw(8)</a>:
<pre>
proxy:*:71:71::0:0:Proxy Services:/nonexistent:/sbin/nologin
</pre>

Also add the <i>proxy</i> group to /etc/group:
<pre>
proxy:*:71:
</pre>

d1901 4
a1904 3
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sendmail&sektion=8">sendmail(8)</a> has been upgraded to version 8.12. As this version of
<i>sendmail</i> no longer runs setuid root, this has resulted
in some significant changes.
a1905 1

d1907 11
a1917 25
<li>Both a new user and a new group, named <i>smmsp</i>, have
been added to the system.  Add a line like the following to your
<tt>/etc/group</tt>:

<pre>
smmsp:*:25:
</pre>

Then, run <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&sektion=8">vipw(8)</a> and add the following line for the <i>smmsp</i> user:

<pre>
smmsp:*:25:25::0:0:Sendmail Message Submission Program:/nonexistent:/sbin/nologin
</pre>

Make sure this line appears before any <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=yp&sektion=8">yp(8)</a> settings line.<p>
</li>

<li> Create the <tt>/var/spool/clientmqueue</tt> directory and change
<tt>/var/spool/mqueue</tt> permissions with <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mtree&sektion=8">mtree(8)</a>:
<pre>
  # cd /usr/src/etc/mtree
  # install -c -o root -g wheel -m 600 special /etc/mtree
  # install -c -o root -g wheel -m 444 4.4BSD.dist /etc/mtree
  # mtree -qdef /etc/mtree/4.4BSD.dist -p / -u
</pre>
d1958 1
a1958 1
Once your configuration file is ready, <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=kill&sektion=1">kill(1)</a> THE existing sendmail:
d1989 1
a1989 1
$OpenBSD: upgrade-minifaq.html,v 1.70 2001/09/15 17:39:08 kjell Exp $
@


1.70
log
@Instructions for updating sendmail. Mostly my millert@@, miod@@.
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.69 2001/09/06 05:54:43 kjell Exp $
d681 1
a681 1
Add the following entry to /etc/passwd using vipw
d1761 1
a1761 1
There have been changes to <i>make</i> and its data files which need
d1786 2
a1787 2
First, there is a new KerberosV configuration directory in /etc.
Use mtree to create it:
d1815 1
a1815 1
With the addition of the <i>ftpproxy</i> suite, a new user and
d1817 1
a1817 1
addition, add the following user entry using vipw:
d1831 4
a1834 2
<p>Sendmail has been upgraded to version 8.12. As this version of <i>sendmail</i>
no longer runs setuid root, this has resulted in some significant changes.
d1846 1
a1846 1
Then, run <tt>vipw</tt> and add the following line for the <i>smmsp</i> user:
d1852 1
a1852 1
Make sure this line appears before any yp settings line.<p>
d1856 1
a1856 1
<tt>/var/spool/mqueue</tt> permissions with <tt>mtree</tt>:
d1865 1
a1865 1
<li>Add the following to root's crontab. This is necessary since
d1879 1
a1879 1
  $ make clean && make obj && make depend && make && sudo make install
d1903 1
a1903 1
Once your configuration file is ready, kill the existing sendmail:
d1934 1
a1934 1
$OpenBSD: upgrade-minifaq.html,v 1.69 2001/09/06 05:54:43 kjell Exp $
@


1.69
log
@New proxy user for ftpproxy suite
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.68 2001/09/05 03:56:16 kjell Exp $
d239 5
d1827 101
d1932 1
a1932 1
$OpenBSD: upgrade-minifaq.html,v 1.68 2001/09/05 03:56:16 kjell Exp $
@


1.68
log
@Sticking with GENERIC is a good idea. based on feedback
from jon@@bconnected.com
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.67 2001/08/23 07:12:50 heko Exp $
d234 5
d1806 16
d1826 1
a1826 1
$OpenBSD: upgrade-minifaq.html,v 1.67 2001/08/23 07:12:50 heko Exp $
@


1.67
log
@ o Link to upgrade minifaq for definitions on -current and -stable
 o Explain how to get different branches of the ports tree
 o Mention that ports tree has a special policy for branching
   and following src in the upgrade minifaq
Ok: brad@@, kjell@@
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.65 2001/08/17 18:26:11 kjell Exp $
d397 13
d415 3
d1805 1
a1805 1
$OpenBSD: upgrade-minifaq.html,v 1.65 2001/08/17 18:26:11 kjell Exp $
@


1.66
log
@kerberosV/lib/roken should not be installed.

Spotted by Mike Pechkin <mpech@@prosoft.org.lv>
@
text
@d280 4
@


1.65
log
@Make it much more obvious that you need to recompile make.
Some people missed this.
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.64 2001/08/17 18:17:01 kjell Exp $
a1771 1
  $ sudo make install
d1785 1
a1785 1
$OpenBSD: upgrade-minifaq.html,v 1.64 2001/08/17 18:17:01 kjell Exp $
@


1.64
log
@Add a reminder to update the /dev/MAKEDEV script, as this is not
done as part of a make build. Group some of the post-2.9 instructions
in a more sane fashion.
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.63 2001/08/17 17:57:52 kjell Exp $
d225 1
a225 1
8.2: Errors from bsd.own.mk during build
d1728 1
a1728 1
8.2: Errors from bsd.own.mk during build
d1732 3
a1734 1
to be updated before performing the build step:
d1786 1
a1786 1
$OpenBSD: upgrade-minifaq.html,v 1.63 2001/08/17 17:57:52 kjell Exp $
@


1.63
log
@login_krb-or-pwd was renamed to login_krb4-or-pwd. From David Krause.
Sorry folks. I've been ignoring this little document lately.
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.62 2001/08/12 06:21:25 pvalchev Exp $
d84 4
d220 1
a220 1
8.1: New packet filter and KerberosV configuration directory
d622 15
d1690 1
a1690 1
8.1: New packet filter and KerberosV configuration directory
d1702 1
a1702 1
With the IPF - PF transition, the binaries have
a1725 9
<br><br>
There is a new KerberosV configuration directory in /etc.
Use mtree to create it:
<pre>
  $ cd /usr/src/etc/mtree
  $ sudo install -c -o root -g wheel -m 600 special /etc/mtree
  $ sudo install -c -o root -g wheel -m 444 4.4BSD.dist /etc/mtree
  $ sudo mtree -qdef /etc/mtree/4.4BSD.dist -p / -u
</pre>
d1731 1
a1731 1
There have been changes to the <i>make</i> data files which need
d1752 12
a1763 1
build KerberosV alone:
d1784 1
a1784 1
$OpenBSD: upgrade-minifaq.html,v 1.62 2001/08/12 06:21:25 pvalchev Exp $
@


1.62
log
@updating make is needed too; op21@@squish.org
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.61 2001/07/06 13:39:05 hin Exp $
d1755 3
a1757 1
Then go back and start your full system make build.
d1763 1
a1763 1
$OpenBSD: upgrade-minifaq.html,v 1.61 2001/07/06 13:39:05 hin Exp $
@


1.61
log
@Correct instructions for bsd.own.mk and kerberosV build issues.x
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.60 2001/07/05 20:26:00 pvalchev Exp $
d1729 8
d1761 1
a1761 1
$OpenBSD: upgrade-minifaq.html,v 1.60 2001/07/05 20:26:00 pvalchev Exp $
@


1.60
log
@more to the ipf binaries list, rearrage them in alphabetical order; brad
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.59 2001/07/05 19:48:56 pvalchev Exp $
d221 1
a221 1
8.2: Build fails because of KerberosV errors
d226 1
a226 1
8.3: Errors from bsd.own.mk during build
d1718 1
a1718 1
8.2: Build fails because of KerberosV errors
d1721 2
a1722 2
Before you try building the whole system, you need to first
build KerberosV alone:
d1725 2
a1726 2
  $ cd /usr/src/kerberosV
  $ sudo make build
d1730 1
a1730 1
8.3: Errors from bsd.own.mk during build
d1733 2
a1734 2
There have been changes to the <i>make</i> data files which need
to be updated before performing the build step:
d1737 7
a1743 1
  $ cd /usr/src/share/mk
d1753 1
a1753 1
$OpenBSD: upgrade-minifaq.html,v 1.59 2001/07/05 19:48:56 pvalchev Exp $
@


1.59
log
@mention one more binary from ipf to be deleted in the transition - ipresend; brad
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.58 2001/07/04 16:17:21 pvalchev Exp $
d1688 2
a1689 1
/usr/sbin/ipftest /usr/sbin/ipmon /usr/sbin/ipresend /usr/sbin/ipsend
d1747 1
a1747 1
$OpenBSD: upgrade-minifaq.html,v 1.58 2001/07/04 16:17:21 pvalchev Exp $
@


1.58
log
@Mention use of sudo and better English; from jcs@@rt.fm
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.57 2001/07/02 20:48:36 jufi Exp $
d1688 1
a1688 1
/usr/sbin/ipftest /usr/sbin/ipsend /usr/sbin/ipmon
d1746 1
a1746 1
$OpenBSD: upgrade-minifaq.html,v 1.57 2001/07/02 20:48:36 jufi Exp $
@


1.57
log
@
all patches by David Krause <openbsd@@davidkrause.com>
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.56 2001/07/02 01:17:24 pvalchev Exp $
d1725 1
a1725 1
  $ make build
d1732 2
a1733 2
There have been changes to the <i>make</i> data files and you need
to update them before taking the build step:
d1746 1
a1746 1
$OpenBSD: upgrade-minifaq.html,v 1.56 2001/07/02 01:17:24 pvalchev Exp $
@


1.56
log
@packet filter is 2 words; kjell
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.55 2001/06/30 17:12:44 pvalchev Exp $
d568 1
a568 1
to see the changes between 2.6 and 2.7, do a:
d571 1
a571 1
  # cvs diff -u -rOPENBSD_2_6 -rOPENBSD_2_7
d1746 1
a1746 1
$OpenBSD: upgrade-minifaq.html,v 1.55 2001/06/30 17:12:44 pvalchev Exp $
@


1.55
log
@Mention what files were associated with ipf - bins, device and configuration
files and what are the new corresponding PF ones; per brad's suggestion
Also fix a minor formatting issue; from jcs@@rt.fm
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.54 2001/06/29 21:14:01 pvalchev Exp $
d216 1
a216 1
8.1: New packetfilter and KerberosV configuration directory
d1671 1
a1671 1
8.1: New packetfilter and KerberosV configuration directory
d1746 1
a1746 1
$OpenBSD: upgrade-minifaq.html,v 1.54 2001/06/29 21:14:01 pvalchev Exp $
@


1.54
log
@First trial to cover the -current tips, including pf and kerberosV; ok kjell
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.53 2001/06/09 16:39:05 pvalchev Exp $
d183 1
a183 1
<I>apm(8)</I>support no longer boot.
d216 1
a216 1
8.1: New packetfilter device and kerberosV configuration directory
d221 1
a221 1
8.2: Build fails because of kerberosV errors
d1671 1
a1671 1
8.1: New packetfilter device and kerberosV configuration directory
d1683 25
a1707 1
There is a new kerberosV configuration directory in /etc.
d1717 1
a1717 1
8.2: Build fails because of kerberosV errors
d1721 1
a1721 1
build kerberosV alone:
d1746 1
a1746 1
$OpenBSD: upgrade-minifaq.html,v 1.53 2001/06/09 16:39:05 pvalchev Exp $
@


1.53
log
@typos, spelling and link fixes; dstoikov@@biosgroup.com
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.52 2001/06/07 04:10:05 pvalchev Exp $
d213 18
d1666 52
d1722 1
a1722 1
$OpenBSD: upgrade-minifaq.html,v 1.52 2001/06/07 04:10:05 pvalchev Exp $
@


1.52
log
@typos and spelling fixes; dstoikov@@biosgroup.com
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.51 2001/06/05 04:07:31 kjell Exp $
d535 1
a535 1
<tt>/etc</tt> automatcally. This means it is <b>always</b> up to
d1652 1
a1652 1
$OpenBSD: upgrade-minifaq.html,v 1.51 2001/06/05 04:07:31 kjell Exp $
@


1.51
log
@explanation of SUDO use. Derived from comment by seb@@todesplanet.de
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.50 2001/06/05 03:22:18 kjell Exp $
d595 1
a595 1
<LI> Place SUDO=/usr/bin/sudo in your enviroment prior to starting the build,
d1652 1
a1652 1
$OpenBSD: upgrade-minifaq.html,v 1.50 2001/06/05 03:22:18 kjell Exp $
@


1.50
log
@We are now at 2.9
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.49 2001/04/08 20:47:03 kjell Exp $
d79 5
d580 19
d1652 1
a1652 1
$OpenBSD: upgrade-minifaq.html,v 1.49 2001/04/08 20:47:03 kjell Exp $
@


1.49
log
@Add reminder to copy MAKEDEV. Pointed out by Alex Farber
@
text
@d10 1
a10 1
<h3>Latest OpenBSD Release - 2.8</h3>
d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.48 2001/03/02 20:21:28 kjell Exp $
d108 1
a108 1
4.1: What are the major problems upgrading from 2.5 to <I>2.6</I>?
d189 1
a189 1
<h3>7.0 - Upgrading from 2.8 to <i>-current</i></h3>
d224 1
a224 1
2.8. 
d1485 1
a1485 1
6.0 - Upgrading from 2.7 to 2.8
d1567 1
a1567 1
7.0 - Upgrading from 2.8 to <i>-current</i>
d1594 2
a1595 2
If you are running X, change the Pointer section of <i>/etc/XF86Config</i> to
contain the following:
d1628 1
a1628 1
$OpenBSD: upgrade-minifaq.html,v 1.48 2001/03/02 20:21:28 kjell Exp $
@


1.48
log
@fix typo, ssh path. noticed by pvalchev@@toxiclinux.org
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.47 2001/02/07 22:20:14 kjell Exp $
d1587 3
a1589 2
Ensure you have the latest MAKEDEV installed and issue the following commands:
<PRE>
d1592 1
a1592 1
</PRE>
d1628 1
a1628 1
$OpenBSD: upgrade-minifaq.html,v 1.47 2001/02/07 22:20:14 kjell Exp $
@


1.47
log
@finish aaron's tweak
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.46 2001/02/07 21:44:55 aaron Exp $
d295 1
a295 1
# export CVS_RSH=/usr/local/bin/ssh
d1290 1
a1290 1
You must change all occurences of <I>pn*</I>, <I>mx</I>,
d1627 1
a1627 1
$OpenBSD: upgrade-minifaq.html,v 1.46 2001/02/07 21:44:55 aaron Exp $
@


1.46
log
@Tweaks to the wscons section.
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.45 2001/02/07 20:20:18 kjell Exp $
d197 1
a197 1
7.2: New wscons driver
d1627 1
a1627 1
$OpenBSD: upgrade-minifaq.html,v 1.45 2001/02/07 20:20:18 kjell Exp $
@


1.45
log
@add some of the -current tips, including wscons, and new config(8)
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.44 2001/01/27 22:19:48 ericj Exp $
d1581 1
a1581 1
7.2: New wscons driver
d1584 4
a1587 4
The <i>pcvt</i> console driver has been replaces with the <i>wscons</i>
driver. Before using this system, you will need to create the
wsmouse and wscons devices. Ensure you have the latest MAKEDEV installed,
and do a:
d1590 1
a1590 1
 # MAKEDEV all
d1593 2
a1594 1
If you are running X, you must change your XF86Config to contain the following:
d1627 1
a1627 1
$OpenBSD: upgrade-minifaq.html,v 1.44 2001/01/27 22:19:48 ericj Exp $
@


1.44
log
@
some html cleanup; from mpech@@prosoft.org.lv
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.43 2001/01/16 11:30:53 horacio Exp $
d196 10
d1580 39
d1620 1
d1626 1
a1626 1
$OpenBSD: upgrade-minifaq.html,v 1.43 2001/01/16 11:30:53 horacio Exp $
@


1.43
log
@typos
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.42 2000/12/29 15:28:52 aaron Exp $
d1468 1
a1468 1
</A></H4>
d1576 1
a1576 1
$OpenBSD: upgrade-minifaq.html,v 1.42 2000/12/29 15:28:52 aaron Exp $
@


1.42
log
@Insert missing colon; closes PR/1590 from user@@utopia.waldentwo.org.
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.41 2000/12/26 10:41:05 horacio Exp $
d520 1
a520 1
<tt>/etc</tt> automatcally. This means is is <b>always</b> up to
d527 1
a527 1
so a:
d548 1
a548 1
The most important thing you can do is clean out your obj
d612 1
a612 1
&amp;>/tmp/build.log</I>) you will notice the following message:
d738 1
a738 1
Several man pages were moved from section 1 to later sections
d1110 1
a1110 1
Yes it does. This is especially noticable with the old <tt>-O2</tt> gcc switch. 
d1181 2
a1182 2
0.9 and having it there but always 0 is confusing.  It is conceivable
that this may cause some old code to not compile but that is better
d1197 1
a1197 1
<LI> FreeBSD's struct statfs is different from our (both old and new)
d1295 1
a1295 1
included the <i>dcphy</i> device, in your kernel config, as follows:
d1398 1
a1398 1
has changed.  Everything but the pid file now lives in /etc/mail.
d1443 1
a1443 1
to the new but the first step is always the same.
d1447 1
a1447 1
<LI> Update <TT>/etc/rc</TT> to that it looks for
d1451 1
a1451 1
     This is the path of least resistence and you won't have to change
d1458 1
a1458 1
     add machines to class w (via "Cw machinename") you now need
d1576 1
a1576 1
$OpenBSD: upgrade-minifaq.html,v 1.41 2000/12/26 10:41:05 horacio Exp $
@


1.41
log
@fix link to apm(8)  add links to tic(1) & mount(8)
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.40 2000/12/24 23:46:05 naddy Exp $
d554 1
a554 1
  # cvs -q -d anoncvs@@some.anon.server/cvs up -PAd
d1576 1
a1576 1
$OpenBSD: upgrade-minifaq.html,v 1.40 2000/12/24 23:46:05 naddy Exp $
@


1.40
log
@Fix typos.
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.39 2000/12/21 18:19:08 kjell Exp $
d1201 2
a1202 1
<LI> <B>mount(8)</B> will now show extra info when invoked with no arguments.
d1252 5
a1256 3
with the current version of tic(1).  If you are upgrading via
<i>make build</i>, the correct version of tic(1) will be used and
this will be done for you.  If not, you will get the following error:
d1466 1
a1466 1
<A HREF="http://www.openbsd.org/cgi-bin/man.cgi?query=apm&apropos=0&sektion=8&manpath=OpenBSD+Current&format=html">apm(8)</A>
d1576 1
a1576 1
$OpenBSD: upgrade-minifaq.html,v 1.39 2000/12/21 18:19:08 kjell Exp $
@


1.39
log
@Fix a note about sendmail permissions (naddy@@).
Add some tips for cleaning your source tree (millert and marco)
Add the long overdue 2.7->2.8 and post-2.8 procedures. (mainly marco)
minor cleanups
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.38 2000/08/07 06:18:51 kjell Exp $
d339 1
a339 1
<LI> Perform any verion-specific configuration changes. For example, 
d344 1
a344 1
<LI>. Make sure all the appropriate directories are created. This
d1573 1
a1573 1
$OpenBSD: upgrade-minifaq.html,v 1.38 2000/08/07 06:18:51 kjell Exp $
@


1.38
log
@pretty up html. Add examples for updating /etc
@
text
@d10 1
a10 1
<h3>Latest OpenBSD Release - 2.7</h3>
d13 1
a13 1
&lt;<A HREF="mailto:kwooding@@codetalker.com">kwooding@@codetalker.com</A>&gt;
d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.37 2000/08/07 04:46:42 kjell Exp $
d74 6
d182 1
a182 1
<h3>6.0 - Upgrading from 2.7 to <I>-current</I></h3>
d185 8
a192 1
6.1: Upgrading gcc 2.95.2 to 2.95.3-pre (May 27)
d214 1
a214 1
2.7. 
d237 6
a242 4
As of OpenBSD 2.7, a 
<A HREF="../stable.html">patch branch</A> (called <B>-stable</B>) 
was introduced.  This branch contains the base 2.7 release, plus any
errata patches that have been published.
a377 5
<P>
(<B>Note</B>: make sure the directory hierarchy you choose
does not have group write (g+w) or other write (o+w)  
permissions or sendmail will complain during this step. 
This makes /tmp a bad choice):
d479 11
a489 11
  # rm -r /usr/obj/gnu/egcs/gcc/*
  # cd /usr/src/gnu/egcs/gcc
  # make -f Makefile.bsd-wrapper obj
  # make -f Makefile.bsd-wrapper clean
  # make -f Makefile.bsd-wrapper depend
  # make -f Makefile.bsd-wrapper 
  # make -f Makefile.bsd-wrapper install
  # make -f Makefile.bsd-wrapper clean
  # make -f Makefile.bsd-wrapper depend
  # make -f Makefile.bsd-wrapper 
  # make -f Makefile.bsd-wrapper install
d492 15
d544 22
d1240 1
a1240 1
5.0 - Upgrading from 2.6
d1472 1
a1472 1
6.0 - Upgrading from 2.7 to <I>-current</I>
d1476 1
a1476 1
6.1: Upgrading gcc 2.95.2 to 2.95.3-pre (May 27)
d1479 89
a1567 3
<I>gcc</I> has been upgraded to a 2.95.3 pre-release. 
Follow the <A HREF="#1.8">standard procedure</A> for
upgrading to a new gcc version.
d1573 1
a1573 1
$OpenBSD: upgrade-minifaq.html,v 1.37 2000/08/07 04:46:42 kjell Exp $
d1576 1
a1576 1
Copyright &copy; 1998-2000, Kjell Wooding. 
d1579 1
a1579 1
<A HREF="mailto:kwooding@@codetalker.com">kwooding@@codetalker.com</A>
@


1.37
log
@make gcc upgrade instructions more generic
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.36 2000/08/07 04:08:38 kjell Exp $
d68 7
d286 1
a286 1
<PRE>
d288 1
a288 1
1. Clean out the old object files.
d290 1
d294 6
a299 4
# rm -rf /usr/obj
# mkdir /usr/obj
# cd /usr/src
# make obj
d305 6
a310 4
# umount /dev/wd0h                 (the /usr/obj partition)
# newfs wd0h
# mount -a
# make obj
d315 8
a322 7
# cd /usr/src
# find . -type l -name obj | xargs rm
# make cleandir
# rm -rf /usr/obj
# mkdir /usr/obj
# make obj

d324 1
a324 1
2. Perform any verion-specific configuration changes. For example, 
d327 1
a327 1
your version.
d329 1
a329 1
3. Make sure all the appropriate directories are created. This
d333 3
a335 1
# cd /usr/src/etc &amp;&amp; make DESTDIR=/ distrib-dirs
d337 1
a337 1
4. Compile a new kernel.
d339 13
a351 11
# cd /usr/src/sys/arch/`machine`/conf
# cp GENERIC MYKERNEL
# vi MYKERNEL
(edit MYKERNEL to your liking)
# config MYKERNEL
# cd ../compile/MYKERNEL
# make clean &amp;&amp; make depend &amp;&amp; make
(arc architecture only) copy bsd.ecoff to your FAT partition
# cp /bsd /bsd.old &amp;&amp; cp bsd /bsd
# chown root.wheel /bsd (if you compiled as someone else)
(reboot)
d353 1
a353 1
5. Compile the system.
d355 4
a358 2
# cd /usr/src
# make build
d360 1
a360 1
6. Update /etc and /dev by hand. These are not updated 
d363 1
d369 5
a373 3
# mkdir /home/newroot          
# export DESTDIR=/home/newroot
# cd /usr/src/etc &amp;&amp; make distribution-etc-root-var
d379 3
a381 1
# rm -rf /home/newroot   (when done)
d383 2
a384 2
7. Reboot to make sure the new /etc files are correct
</PRE>
d483 32
d516 2
d1440 1
a1440 1
$OpenBSD: upgrade-minifaq.html,v 1.36 2000/08/07 04:08:38 kjell Exp $
@


1.36
log
@fix kerberos upgrading instructions again. Yes. This worked for me
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.35 2000/06/11 18:32:27 kjell Exp $
d62 5
d431 30
d1374 3
a1376 18
<I>gcc</I> has been upgraded to a 2.95.3 pre-release. The correct
procedure to build the new compiler is as follows:

<PRE>
  # cd /usr/src/gnu/egcs/gcc
  # make -f Makefile.bsd-wrapper obj
  # make -f Makefile.bsd-wrapper clean
  # make -f Makefile.bsd-wrapper depend
  # make -f Makefile.bsd-wrapper 
  # make -f Makefile.bsd-wrapper install
  # make -f Makefile.bsd-wrapper clean
  # make -f Makefile.bsd-wrapper depend
  # make -f Makefile.bsd-wrapper 
  # make -f Makefile.bsd-wrapper install
</PRE>
And then run a normal <i>make build</i>.


d1382 1
a1382 1
$OpenBSD: upgrade-minifaq.html,v 1.35 2000/06/11 18:32:27 kjell Exp $
@


1.35
log
@Change for 2.7 release. Add gcc 2.95.3-pre instructions. Add
-stable info.
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.34 2000/06/05 13:20:21 kjell Exp $
d1214 12
a1225 2
<LI> If you are not doing a complete make build, regenerate the Kerberos
     header files, and then rebuild Kerberos:
a1226 3
   # rm -r /usr/include/kerberosIV/*
   # cd /usr/src
   # make includes
d1362 1
a1362 1
$OpenBSD: upgrade-minifaq.html,v 1.34 2000/06/05 13:20:21 kjell Exp $
@


1.34
log
@pmax needs an explicit ldconfig after new libraries are build. miod@@
@
text
@d10 1
a10 1
<h3>Latest OpenBSD Release - 2.6</h3>
d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.33 2000/06/05 13:02:33 kjell Exp $
d33 2
a34 1
1.1: Terminology. What is <I>-current</I>? What are Snapshots?
d125 1
a125 1
<h3>5.0 - Upgrading from 2.6 to -current</h3>
d159 1
a159 1
5.7: After upgrading to <I>-current</I>, kernels that include 
d164 7
d178 2
a179 1
1.1: Terminology. What is <I>-current</I>? What are Snapshots?
d183 4
a186 3
Unlike Operating System projects like Linux and FreeBSD, 
OpenBSD development happens from a single, unbranched source tree. 
On approximately
d189 1
a189 1
2.6. 
d200 1
a200 1
to -current is not recommended for non-technical users.
d211 5
d1100 1
a1100 1
5.0 - Upgrading from 2.6 to <i>-current</i>
d1167 2
a1168 2
January 19, 2000. In order for <I>gcc</I> to build properly, the
most recent (post 2.6) <i>libiberty</I> is required. To build this library,
d1315 1
a1315 1
5.7: After upgrading to <I>-current</I>, kernels that include 
d1324 26
d1355 1
a1355 1
$OpenBSD: upgrade-minifaq.html,v 1.33 2000/06/05 13:02:33 kjell Exp $
@


1.33
log
@Fix Kerberos nit.  Noticed by jason@@thought.net and others.
@
text
@d15 1
a15 1
Last Update - $OpenBSD: upgrade-minifaq.html,v 1.32 2000/05/15 02:36:52 wvdputte Exp $
d1163 3
d1314 1
a1314 1
$OpenBSD: upgrade-minifaq.html,v 1.32 2000/05/15 02:36:52 wvdputte Exp $
@


1.32
log
@I hate these $Date$ tags.
@
text
@d15 1
a15 1
Last Update - $OpenBSD$
d1199 1
a1199 1
   # rm -r /usr/include/kerberosIV
d1311 1
a1311 1
$OpenBSD: upgrade-minifaq.html,v 1.31 2000/04/18 18:43:22 kjell Exp $
@


1.31
log
@Bye Bye absolute hrefs
@
text
@d15 1
a15 1
Last Update - $Date: 2000/04/18 17:49:38 $
d1311 1
a1311 1
$OpenBSD: upgrade-minifaq.html,v 1.30 2000/04/18 17:49:38 wvdputte Exp $
@


1.30
log
@Fix evil /absolute link in upgrade-minifaq.html (please stop using those)
new German translation of FAQ by Reinard (reinhard@@sammer.net)
@
text
@d15 1
a15 1
Last Update - $Date: 2000/04/18 17:24:17 $
d396 1
a396 1
<A HREF="http://www.openbsd.org/mail.html">misc@@ and tech@@</A>
d1303 1
a1303 1
<A HREF="http://www.openbsd.org/faq/faq14.html#14.8">Section 14.8</A>
d1311 1
a1311 1
$OpenBSD: upgrade-minifaq.html,v 1.29 2000/04/18 17:24:17 kjell Exp $
@


1.29
log
@Need to update bootblocks for new apm code.
Some HTML cleanup
@
text
@d15 1
a15 1
Last Update - $Date: 2000/04/15 19:33:35 $
d234 1
a234 1
Short answer: <A HREF="/anoncvs.html">http://www.openbsd.org/anoncvs.html</A>
d1311 1
a1311 1
$OpenBSD: upgrade-minifaq.html,v 1.28 2000/04/15 19:33:35 millert Exp $
@


1.28
log
@fix typo introduced in last commit
@
text
@d10 1
a10 1
<h3>Latest OpenBSD Version - 2.6</h3>
d15 1
a15 1
Last Update - $Date: 2000/04/15 17:32:15 $
d95 1
a96 1
<Blockquote>
d106 1
a107 1
</font>
d149 1
d155 1
d157 5
d166 1
a166 1
&nbsp;<HR Width=30%><P>
d231 1
a231 1
1.4: How do I get the latest source?</B>
d234 1
a234 1
Short answer: <A HREF="../anoncvs.html">http://www.openbsd.org/anoncvs.html</A>
d883 4
a886 4
<A NAME="4.2.1">
<H5>4.2.1 - <tt>i386</tt> and <tt>sparc</tt> are no longer 
<tt>#define</tt>'ed</H5>
</A>
d893 3
a895 3
<A NAME="4.2.2">
<H5>4.2.2 - Build fails in xlint</H5>
</A>
d909 3
a911 3
<A NAME="4.2.3">
<H5>4.2.3 - Core Dump on <tt>uthread_autoinit.c</tt></h5>
</A>
d916 1
a916 1
From: Marc Espie <Marc.Espie@@liafa.jussieu.fr>
d943 3
a945 3
<A NAME="4.2.4">
<H5> 4.2.4 - <i>egcs</i> seems much slower than <i>gcc</i></H5>
</A>
d951 3
a953 3
<A NAME="4.2.5">
<H5>4.2.5 - <I>egcs</i> generates larger code than <i>gcc</i></H5>
</A>
d959 3
a961 3
<A NAME="4.2.6">
<H5>4.2.6 - After installing <i>egcs</i> I have very little disk space left</h5>
</A>
d970 3
a972 3
<A NAME="4.2.7">
<H5>4.2.7 - My build dies while making libcurses</H5>
</A>
d981 4
a984 3
<A NAME="4.2.8">
<H5>4.2.8 - make obj fails</H5>
</A>
d1058 4
a1061 4
<ul><pre>
cd /usr/lib/gcc-lib
ln -s ${ARCH}-unknown-openbsd2.5 ${ARCH}-unknown-openbsd2.6
</pre></ul>
d1069 2
a1070 1
<I>tar: Unable to remove directory ./usr/include/machine <Directory not empty>
d1083 5
a1087 3
<p>
<a name="5.0"><h3>5.0 - Upgrading from 2.6 to <i>-current</i></a></h3>
</p>
d1295 12
d1311 1
a1311 1
$OpenBSD: upgrade-minifaq.html,v 1.27 2000/04/15 17:32:15 millert Exp $
@


1.27
log
@Aparently the 2.6 m4 chokes on the new sendmail .mc files.
@
text
@d15 1
a15 1
Last Update - $Date: 2000/04/12 18:15:37 $
d1199 1
a1199 1
5.6: Upgrading M4.
d1288 1
a1288 1
$OpenBSD: upgrade-minifaq.html,v 1.26 2000/04/12 18:15:37 kjell Exp $
@


1.26
log
@nit nit, & to &amp; Thanks je@@sekure.net
@
text
@d15 1
a15 1
Last Update - $Date: 2000/04/11 20:25:49 $
d148 5
a152 1
5.5: Upgrading Sendmail.
d1199 16
a1214 1
5.5: Upgrading Sendmail.
d1288 1
a1288 1
$OpenBSD: upgrade-minifaq.html,v 1.25 2000/04/11 20:25:49 kjell Exp $
@


1.25
log
@hopefully, last tweak to kerberos section.
@
text
@d15 1
a15 1
Last Update - $Date: 2000/04/11 19:18:39 $
d289 1
a289 1
# cd /usr/src/etc && make DESTDIR=/ distrib-dirs
d299 1
a299 1
# make clean && make depend && make
d301 1
a301 1
# cp /bsd /bsd.old && cp bsd /bsd
d320 1
a320 1
# cd /usr/src/etc && make distribution-etc-root-var
d347 1
a347 1
(cd /usr/src/share/mk &&  make install)
d350 5
a354 5
(cd /usr/src/lib && make depend && make &&   make install)
(cd /usr/src/gnu/lib && make depend && make &&   make install)
(cd /usr/src/kerberosIV/lib && make depend && make &&   make install)
(cd /usr/src/gnu/usr.bin/perl &&  make -f Makefile.bsd-wrapper config.sh &&  mak
e -f Makefile.bsd-wrapper depend &&  make -f Makefile.bsd-wrapper perl.lib &&
d356 1
a356 1
make depend && make &&  make install
d446 1
a446 1
&>/tmp/build.log</I>) you will notice the following message:
d449 1
a449 1
(cd /usr/src/etc && make DESTDIR=/ distrib-dirs)
d522 1
a522 1
# cd /usr/src/etc && make DESTDIR=/ distrib-dirs
d565 1
a565 1
# make clean && make && make install
d621 1
a621 1
# make clean && make && make install
d839 1
a839 1
The fix is simple though. Simply do a <CODE> make && make install </CODE>
d893 1
a893 1
# make && make install
d966 1
a966 1
# cd /usr/src/usr.bin/cpp && make install
d988 1
a988 1
cd /usr/src/share/mk && make install
d1174 1
a1174 1
   # make clean make depend && make && make install
d1179 1
a1179 1
   # make clean && make depend && make && make install
d1184 1
a1184 1
   # rm /usr/include/kerberosIV
d1188 1
a1188 1
   # make cleandir && make depend && make && make install
d1269 1
a1269 1
$OpenBSD: upgrade-minifaq.html,v 1.24 2000/04/11 19:18:39 kjell Exp $
@


1.24
log
@forgot a depend.
@
text
@d15 1
a15 1
Last Update - $Date: 2000/04/11 18:43:35 $
d1187 2
a1188 2
   # cd /usr/src/kerberosIV/lib && make depend && make && make install
   # cd /usr/src/kerberosIV && make && make install
d1269 1
a1269 1
$OpenBSD: upgrade-minifaq.html,v 1.23 2000/04/11 18:43:35 kjell Exp $
@


1.23
log
@Clean up the KerberosIV instructions, once and for all.
Hopefully, this will dispell any remaining questions.
@
text
@d15 1
a15 1
Last Update - $Date: 2000/04/07 22:26:57 $
d1174 1
a1174 1
   # make clean && make && make install
d1269 1
a1269 1
$OpenBSD: upgrade-minifaq.html,v 1.22 2000/04/07 22:26:57 kjell Exp $
@


1.22
log
@Convert PRE to TABLE in sendmail section.
@
text
@d15 1
a15 1
Last Update - $Date: 2000/04/07 01:54:03 $
d1172 4
d1177 14
a1190 1
<LI> Rebuild KerberosIV.
d1269 1
a1269 1
$OpenBSD: upgrade-minifaq.html,v 1.21 2000/04/07 01:54:03 millert Exp $
@


1.21
log
@Talk about sendmail stuff.  The old/new bit should really be in a table.
@
text
@d15 1
a15 1
Last Update - $Date: 2000/04/03 18:31:00 $
d145 1
d1187 38
a1224 12
<PRE>
OLD:				NEW:
===========================	===========================
/etc/sendmail.cf		/etc/mail/sendmail.cf
/etc/sendmail.cw		/etc/mail/local-host-names
/etc/sendmail.ct		/etc/mail/trusted-users
/etc/sendmail.oE		/etc/mail/error-header
/etc/aliases			/etc/mail/aliases
/etc/service.switch		/etc/mail/service.switch
/etc/userdb			/etc/mail/userdb
/usr/share/misc/sendmail.hf	/etc/mail/helpfile
</PRE>
d1232 2
a1233 2
<LI> Update /etc/rc to that it looks for /etc/mail/sendmail.cf instead of
/etc/sendmail.cf
d1235 1
a1235 1
<LI> mv /etc/sendmail.cf /etc/mail/sendmail.cf <BR>
d1244 1
a1244 1
     to do that in the LOCAL_CONFIG section (see openbsd-lists.mc
d1252 1
a1252 1
$OpenBSD: upgrade-minifaq.html,v 1.20 2000/04/03 18:31:00 kjell Exp $
@


1.20
log
@Update the overview to reflect the way kerberos builds now
(chouanard@@parc.xerox.com). Add another remider to blow out old
objects if you encounter errors. tip: /usr/obj on its own partition.
@
text
@d15 1
a15 1
Last Update - $Date: 2000/03/12 21:39:23 $
d146 4
d1176 45
d1225 1
a1225 1
$OpenBSD: upgrade-minifaq.html,v 1.19 2000/03/12 21:39:23 kjell Exp $
@


1.19
log
@Fix a couple of nits. halogen@@nol.net and hin@@stacken.kth.se
@
text
@d15 1
a15 1
Last Update - $Date: 2000/03/07 00:05:40 $
d57 4
d255 9
d274 1
d326 1
a326 1
<h4><A NAME=1.6">
d343 1
a343 1
(cd /usr/src/include;  make includes)
d347 4
a350 1
(cd /usr/src/kerberosIV && make build)
d362 3
d366 28
d1176 1
a1176 1
$OpenBSD: upgrade-minifaq.html,v 1.18 2000/03/07 00:05:40 kjell Exp $
@


1.18
log
@Add Kerberos information that recently hit the lists.
@
text
@d15 1
a15 1
Last Update - $Date: 2000/02/17 20:27:10 $
d136 1
d1119 3
a1121 2
<LI> Remove <tt>/usr/include/kerberosIV/com_err.h</TT> to avoid
     problems with a recursive definition.
d1128 1
a1128 1
$OpenBSD: upgrade-minifaq.html,v 1.17 2000/02/17 20:27:10 millert Exp $
@


1.17
log
@When buliding the termtypes file the version of tic inthe source tree
is used in preference to the one in /usr/bin.
@
text
@d15 1
a15 1
Last Update - $Date: 2000/01/21 03:16:53 $
d137 4
d1108 14
d1126 1
a1126 1
$OpenBSD: upgrade-minifaq.html,v 1.16 2000/01/21 03:16:53 kjell Exp $
@


1.16
log
@gcc 2.95.2. From marc@@snafu.org.
@
text
@d15 1
a15 1
Last Update - $Date: 2000/01/17 20:09:25 $
d1023 3
a1025 1
with the current version of tic(1). After a <i>make build</i> to a:
d1029 1
a1029 5
    cd /usr/src/share/termtypes
    make clean
    make depend
    make
    make install
d1032 6
d1108 1
a1108 1
$OpenBSD: upgrade-minifaq.html,v 1.15 2000/01/17 20:09:25 kjell Exp $
@


1.15
log
@Remind dc(4) users to include the dcphy in their kernel config.
@
text
@d15 1
a15 1
Last Update - $Date$
d131 1
d133 3
d1070 30
d1104 1
a1104 1
$OpenBSD: upgrade-minifaq.html,v 1.14 2000/01/12 19:37:28 kjell Exp $
@


1.14
log
@al, ax -> dc also. (last one, I hope)
@
text
@d15 1
a15 1
Last Update - 09 Jan 2000
d1035 2
a1036 2
<P> (Note: <I>pn</I> has been used below for simplicity. This should
be taken to read <I>pn</I> <I>mx</I>, <I>al</I>, or <I>ax</I>
d1041 2
a1042 2
You must change all occurences of <I>pn*</I> 
in your configuration files. This includes:
d1055 12
d1070 1
a1070 1
$OpenBSD: upgrade-minifaq.html,v 1.13 2000/01/12 18:58:55 kjell Exp $
@


1.13
log
@mx->dc also.
@
text
@d128 2
a129 1
5.2: My <I>pn</I> (or <I>mx</I>) device is no longer recognized by the kernel.
d1031 2
a1032 1
5.2: My <I>pn</I> (or <I>mx</I>) device is no longer recognized by the kernel.
d1035 4
d1040 2
a1041 2
The <I>pn</i> and <I>mx</I> devices were replaced with the <I>dc</I> driver.
You must change all occurences of <I>pn*</I> (or <I>mx*</I>) with <I>dc*</I>
d1048 1
a1048 1
<LI>mv'ing <tt>/etc/hostname.(pn|mx)*</tt>  to <tt>/etc/hostname.dc*</tt>
d1058 1
a1058 1
$OpenBSD: upgrade-minifaq.html,v 1.12 2000/01/12 17:59:16 kjell Exp $
@


1.12
log
@Add info on pn->dc device change.
@
text
@d128 1
a128 1
5.2: My <I>pn</I> device is no longer recognized by the kernel.
d1030 1
a1030 1
5.2: My <I>pn</I> device is no longer recognized by the kernel.
d1034 2
a1035 2
The <I>pn</i> device was replaced with the <I>dc</I> driver.
You must change all occurences of <I>pn*</I> with <I>dc*</I>
d1040 4
a1043 2
<LI>Updating your kernel configuration file(s).
<LI>mv'ing <tt>/etc/hostname.pn*</tt>  to <tt>/etc/hostname.dc*</tt>
d1052 1
a1052 1
$OpenBSD: upgrade-minifaq.html,v 1.11 2000/01/10 20:09:04 kjell Exp $
@


1.11
log
@clarify.
@
text
@d125 6
d1029 17
d1050 1
a1050 1
$OpenBSD: upgrade-minifaq.html,v 1.10 2000/01/09 20:17:43 kjell Exp $
@


1.10
log
@Update to reflect 2.6. Add Todd's termcap issue and dne@@mayonnaise.net's
Upgrade tarfile issue.
@
text
@d139 2
a140 1
OpenBSD development happens from a single source tree. On approximately
d143 1
a143 1
2.5. 
d146 2
a147 1
<B>-current</B>, short for <I>openbsd-current</I>, refers to the up-to-the-minute
d1027 1
a1027 1
$OpenBSD: upgrade-minifaq.html,v 1.9 1999/11/24 20:42:29 ericj Exp $
@


1.9
log
@fix nasty font
@
text
@d10 1
a10 1
<h3>Latest OpenBSD Version - 2.5</h3>
d15 1
a15 1
Last Update - 27 Jul 1999
d85 1
a85 1
4.1: What are the major problems upgrading from 2.5 to <I>-current</I>?
d108 6
d115 6
a120 2
<h3>5.0 - Upgrading to 2.6</h3>
<a href=#5.1>Link to the new 2.6 directory</a>
d122 3
d204 4
a207 4
 # export CVSROOT=anoncvs@@anoncvs.ca.openbsd.org:/cvs
 # export CVS_RSH=/usr/local/bin/ssh
 # cd /usr
 # cvs -q get -PA src
d225 2
a226 2
   If you created a separate /usr/obj directory, clean that, and
   rebuild the symbolic links:
d228 14
a241 14
   # rm -rf /usr/obj
   # mkdir /usr/obj
   # cd /usr/src
   # make obj

   If you're worried there are object files in your source tree, 
   do this:

   # cd /usr/src
   # find . -type l -name obj | xargs rm
   # make cleandir
   # rm -rf /usr/obj
   # mkdir /usr/obj
   # make obj
d244 3
a246 3
   2.3 users must add the <I>named</I> user and group before
   moving to 2.4 or later. See the specific Mini-FAQ section for 
   your version.
d249 2
a250 2
   is especially important when upgrading from older versions, but is
   sometimes necessary in other cases. The easiest way to do this is:
d252 1
a252 1
   # cd /usr/src/etc && make DESTDIR=/ distrib-dirs
d256 11
a266 11
   # cd /usr/src/sys/arch/`machine`/conf
   # cp GENERIC MYKERNEL
   # vi MYKERNEL
   (edit MYKERNEL to your liking)
   # config MYKERNEL
   # cd ../compile/MYKERNEL
   # make clean && make depend && make
   (arc architecture only) copy bsd.ecoff to your FAT partition
   # cp /bsd /bsd.old && cp bsd /bsd
   # chown root.wheel /bsd (if you compiled as someone else)
   (reboot)
d270 2
a271 2
   # cd /usr/src
   # make build
d274 14
a287 14
   automatically. Choose a directory with enough space to 
   hold /, /dev, /var, and /etc. Here I'll use <I>/home/newroot</I> 
   (<B>Note</B>: make sure the directory hierarchy you choose
   does not have group write (g+w) or other write (o+w)  
   permissions or sendmail will complain during this step. 
   This makes /tmp a bad choice):

   # mkdir /home/newroot          
   # export DESTDIR=/home/newroot
   # cd /usr/src/etc && make distribution-etc-root-var
   
   Now compare the files in /home/newroot with their 
   installed counterparts. Replace or update the files as 
   necessary.
d289 1
a289 1
   # rm -rf /home/newroot   (when done)
d303 2
a304 2
 # cd /usr/src
 # make -n build
d310 7
a316 7
 (cd /usr/src/share/mk &&  make install)
 (cd /usr/src/include;  make includes)
 make cleandir
 (cd /usr/src/lib && make depend && make &&   make install)
 (cd /usr/src/gnu/lib && make depend && make &&   make install)
 (cd /usr/src/kerberosIV && make build)
 make depend && make &&  make install
d345 1
a345 1
   named:*:70:70::0:0:BIND Daemon:/var/named:/sbin/nologin
d347 1
a347 1
   
d350 1
a350 1
   named:*:70:
d378 7
a384 7
  (cd /usr/src/etc && make DESTDIR=/ distrib-dirs)
  install -d -o root -g wheel -m 755 /
  mtree -def mtree/4.4BSD.dist -p // -u
  
  mtree: unknown user named
  mtree: failed at line 1632 of the specification
  *** Error code 1 (ignored)
d395 18
a412 18
  missing: ./var/named (created)
  missing: ./var/named/dev (created)
  missing: ./var/named/etc (created)
  missing: ./etc/afs (created)
  missing: ./etc/ssl (created)
  missing: ./etc/ssl/private (created)
  missing: ./usr/obj (not created: File exists)
  missing: ./usr/share/doc/html (created)
  missing: ./usr/share/doc/html/lynx_help (created)
  missing: ./usr/share/doc/html/lynx_help/keystrokes (created)
  missing: ./usr/share/doc/usd/13.viref (created)
  missing: ./usr/share/man/cat4/powerpc (created)
  missing: ./usr/share/man/man4/alpha (created)
  missing: ./usr/share/man/man4/pmax (created)
  missing: ./usr/share/man/man4/powerpc (created)
  missing: ./usr/share/tmac/mdoc (created)
  missing: ./var/www/htdocs/manual/vhosts (created)
  missing: ./usr/include/ssl (created)
d451 1
a451 1
  # cd /usr/src/etc && make DESTDIR=/ distrib-dirs
d457 2
a458 2
  install -d -o root -g wheel -m 755 /
  mtree -def mtree/4.4BSD.dist -p // -u
d460 18
a477 18
  missing: ./var/named (created)
  missing: ./var/named/dev (created)
  missing: ./var/named/etc (created)
  missing: ./etc/afs (created)
  missing: ./etc/ssl (created)
  missing: ./etc/ssl/private (created)
  missing: ./usr/obj (not created: File exists)
  missing: ./usr/share/doc/html (created)
  missing: ./usr/share/doc/html/lynx_help (created)
  missing: ./usr/share/doc/html/lynx_help/keystrokes (created)
  missing: ./usr/share/doc/usd/13.viref (created)
  missing: ./usr/share/man/cat4/powerpc (created)
  missing: ./usr/share/man/man4/alpha (created)
  missing: ./usr/share/man/man4/pmax (created)
  missing: ./usr/share/man/man4/powerpc (created)
  missing: ./usr/share/tmac/mdoc (created)
  missing: ./var/www/htdocs/manual/vhosts (created)
  missing: ./usr/include/ssl (created)
d526 4
a529 4
  cap_mkdb -i -f terminfo terminfo.src
  cap_mkdb: illegal option -- i
  usage: cap_mkdb [-v] [-f outfile] file1 [file2 ...]
  *** Error code 1
d540 1
a540 1
4.1: What are the major problems upgrading from 2.5 to <I>-current</I>?
d565 12
a576 12
    1) Perl lib files have moved from /usr/lib/perl5 to the more correct
       /usr/libdata/perl5
    2) The default site_perl directories now live in /usr/local.  Ie:
       if you install a perl module, it will place itself in
       /usr/local/libdata/perl5/site_lib.  This makes it easy to
       see what non-stock modules you have.  It also means that we
       can have perl modules in the ports system easily.
    3) The perl library man pages are now install in /usr/share/man/cat3p
       You'll need to update your man.conf based on the src/etc/man.conf
       to take advantage of them.  This means you can now do
       "man 3p less" and get info on the less pragma but "man less"
       will still get you the less pager manpage.
d834 2
a835 2
   From: Marc Espie <Marc.Espie@@liafa.jussieu.fr>
   Subject: egcs core-dumping on uthread_autoinit.c
d837 2
a838 2
   If this happens to you, this is a known linker problem... the cc1 you have
   was linked in a weird way.
d840 3
a842 3
   Initially, I made cc1 link against static /usr/lib/libiberty.a to avoid this
   problem, but this was cutting things too close, and the bug reappeared,
   probably thanks to unrelated changes in libc or elsewhere...
d844 1
a844 1
   The tree has been patched with a work-around in
d846 1
a846 1
   src/gnu/egcs/f/lang-options.h
d848 2
a849 2
   make sure you have the kludged version of that file (at least rev 1.2),
   recompile and reinstall cc1, the problem should go away.
d851 5
a855 5
   What's going on is that the 386 linker gets something wrong because of
   the huge strings array in toplev.c, and something gets mislinked, so
   that
   void f(void) __attribute((constructor)) {}
   kills cc1.
d857 2
a858 2
   As a work-around, I've killed Fortran options help texts, until someone finds
   where the linker errs.
d967 3
a969 7
<p>
<a name="5.0"><h3>5.0 - Upgrading to 2.6</a></h3>
</p>

<p>
<a name="5.1"><h5>5.1 - Link to the new 2.6 directory</h5></a>
</p>
d980 4
d985 35
d1025 1
a1025 1
$OpenBSD: upgrade-minifaq.html,v 1.8 1999/10/02 03:08:12 ericj Exp $
d1028 1
a1028 1
Copyright &copy; 1998-1999, Kjell Wooding. 
@


1.8
log
@forgot on last commit
@
text
@d753 1
a753 1
<FONT COLOR="#EEEE00">
d758 1
a758 1
</FONT>
d977 1
a977 1
$OpenBSD: upgrade-minifaq.html,v 1.7 1999/07/27 05:25:48 kjell Exp $
@


1.7
log
@Added 4.2.8. (Make obj fails)
@
text
@d109 5
d954 19
d977 1
a977 1
$OpenBSD: upgrade-minifaq.html,v 1.6 1999/07/05 20:05:36 kjell Exp $
@


1.6
log
@Note that espie's instructions apply to the 990517 import. The
current tree is 990608, and users may have to bootstrap the intermediate
version. Also, note workaround for the recent libcurses/cpp issues.
@
text
@d15 1
a15 1
Last Update - 03 Jun 1999
d100 2
a101 1
<A HREF="#4.2.7">4.2.7 - My build fails to build libcurses</A>
d881 23
d953 1
a953 1
$OpenBSD: upgrade-minifaq.html,v 1.5 1999/06/30 16:01:28 ericj Exp $
@


1.5
log
@spelling fix's <ccsdhd@@bath.ac.uk>
@
text
@d99 2
a100 1
left </A>
d580 2
a581 2
available. Until then (or for the brave of heart) read
the following <i>carefully</i>.
d612 8
a619 1
To bootstrap to the in-tree egcs, read the following carefully.<P> 
d747 1
d752 1
d869 10
d929 1
a929 1
$OpenBSD: upgrade-minifaq.html,v 1.4 1999/06/21 21:54:39 ericj Exp $
@


1.4
log
@fix links
@
text
@d602 1
a602 1
Now, before going any futher, ensure that your copies of 
d909 1
a909 1
$OpenBSD: upgrade-minifaq.html,v 1.3 1999/06/03 20:08:31 kjell Exp $
@


1.3
log
@added full path to xlint directory
@
text
@d176 1
a176 1
Short answer: <A HREF="http://www.openbsd.org/anoncvs.html">http://www.openbsd.org/anoncvs.html</A>
d597 1
a597 1
<A HREF="http://www.openbsd.org/ports.html">ports collection</A>. 
d909 1
a909 1
$OpenBSD: upgrade-minifaq.html,v 1.2 1999/06/03 12:43:23 kjell Exp $
@


1.2
log
@Alpha works. Make xlint workaround more obvious. Comments by millert
@
text
@d741 2
a742 2
in the xlint directory before you attempt a <i>make build</i> and
proceed. See <A HREF="#4.2.2">4.2.2</A>.]
d789 1
a789 1
Change to the xlint directory. Do a:
d792 1
d909 1
a909 1
$OpenBSD: upgrade-minifaq.html,v 1.1 1999/06/03 04:19:27 kjell Exp $
@


1.1
log
@Added upgrade minifaq to OpenBSD FAQ tree
@
text
@d15 1
a15 1
Last Update - 02 Jun 1999
d590 1
d592 1
a592 2
<b>alpha</b> support is forthcoming. <B>mips</b> and <b>rs6000</b> 
have problems.
d737 6
d744 1
d908 1
a908 1
$OpenBSD$
@

