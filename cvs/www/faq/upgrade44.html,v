head	1.40;
access;
symbols;
locks; strict;
comment	@# @;


1.40
date	2017.06.26.17.18.58;	author tb;	state Exp;
branches;
next	1.39;
commitid	jKVBuSx5No9bUpg1;

1.39
date	2017.03.25.19.07.05;	author tb;	state Exp;
branches;
next	1.38;
commitid	HspC9U4j3u1PNnAZ;

1.38
date	2016.08.15.02.22.14;	author tb;	state Exp;
branches;
next	1.37;
commitid	3DeixV5YkPOb78RN;

1.37
date	2016.04.15.20.39.49;	author tb;	state Exp;
branches;
next	1.36;
commitid	jwteSMEb4rFzI8UA;

1.36
date	2016.04.09.22.55.45;	author tb;	state Exp;
branches;
next	1.35;
commitid	Wgx2QsAm21an230r;

1.35
date	2016.03.27.19.52.09;	author sthen;	state Exp;
branches;
next	1.34;
commitid	hi2ObFv9LGB98JY5;

1.34
date	2016.03.22.10.54.48;	author sthen;	state Exp;
branches;
next	1.33;
commitid	cyODCFvIgxpUoVc0;

1.33
date	2016.03.21.05.46.21;	author beck;	state Exp;
branches;
next	1.32;
commitid	zEx6zFkNSFFExu0v;

1.32
date	2015.07.08.01.11.32;	author nick;	state Exp;
branches;
next	1.31;
commitid	QIEEnBvMxTNfvnfo;

1.31
date	2015.07.02.05.49.04;	author bentley;	state Exp;
branches;
next	1.30;
commitid	AP3UllesavMDEUhQ;

1.30
date	2015.05.11.11.18.30;	author sthen;	state Exp;
branches;
next	1.29;
commitid	wRrXxcro6dFYiwF8;

1.29
date	2014.03.31.01.47.54;	author nick;	state Exp;
branches;
next	1.28;

1.28
date	2009.04.30.17.24.33;	author nick;	state Exp;
branches;
next	1.27;

1.27
date	2009.04.20.11.23.26;	author nick;	state Exp;
branches;
next	1.26;

1.26
date	2008.12.28.03.12.46;	author nick;	state Exp;
branches;
next	1.25;

1.25
date	2008.12.04.20.34.26;	author sthen;	state Exp;
branches;
next	1.24;

1.24
date	2008.11.22.11.04.08;	author tobias;	state Exp;
branches;
next	1.23;

1.23
date	2008.11.10.22.00.26;	author kili;	state Exp;
branches;
next	1.22;

1.22
date	2008.11.07.03.17.49;	author nick;	state Exp;
branches;
next	1.21;

1.21
date	2008.11.01.20.42.15;	author tobias;	state Exp;
branches;
next	1.20;

1.20
date	2008.10.17.20.34.15;	author sthen;	state Exp;
branches;
next	1.19;

1.19
date	2008.10.05.18.21.55;	author nick;	state Exp;
branches;
next	1.18;

1.18
date	2008.10.03.03.04.35;	author nick;	state Exp;
branches;
next	1.17;

1.17
date	2008.10.03.02.23.17;	author nick;	state Exp;
branches;
next	1.16;

1.16
date	2008.09.24.20.08.38;	author chl;	state Exp;
branches;
next	1.15;

1.15
date	2008.09.18.01.04.27;	author nick;	state Exp;
branches;
next	1.14;

1.14
date	2008.09.18.00.56.42;	author nick;	state Exp;
branches;
next	1.13;

1.13
date	2008.09.17.10.42.58;	author nick;	state Exp;
branches;
next	1.12;

1.12
date	2008.09.05.11.14.15;	author nick;	state Exp;
branches;
next	1.11;

1.11
date	2008.09.05.11.00.03;	author nick;	state Exp;
branches;
next	1.10;

1.10
date	2008.09.03.10.57.33;	author nick;	state Exp;
branches;
next	1.9;

1.9
date	2008.09.03.02.34.08;	author nick;	state Exp;
branches;
next	1.8;

1.8
date	2008.09.02.11.03.04;	author nick;	state Exp;
branches;
next	1.7;

1.7
date	2008.09.01.18.09.56;	author nick;	state Exp;
branches;
next	1.6;

1.6
date	2008.09.01.18.02.01;	author nick;	state Exp;
branches;
next	1.5;

1.5
date	2008.09.01.17.41.15;	author nick;	state Exp;
branches;
next	1.4;

1.4
date	2008.08.31.15.50.26;	author nick;	state Exp;
branches;
next	1.3;

1.3
date	2008.08.30.17.15.44;	author nick;	state Exp;
branches;
next	1.2;

1.2
date	2008.08.30.16.29.24;	author nick;	state Exp;
branches;
next	1.1;

1.1
date	2008.08.20.02.21.54;	author nick;	state Exp;
branches;
next	;


desc
@@


1.40
log
@move man.openbsd.org links from http:// to https://
reduces the number of http:// links in www/ from >33k to <7k

thanks to schwarze for doing the work
@
text
@<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>OpenBSD Upgrade Guide: 4.3 to 4.4</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name="description"   content="OpenBSD Upgrade Process for 4.3 -> 4.4">
<meta name="copyright"     content="This document copyright 2008 by OpenBSD">
<meta name="viewport"      content="width=device-width, initial-scale=1">
<link rel="stylesheet"     type="text/css" href="../openbsd.css">
<link rel="canonical"      href="https://www.openbsd.org/faq/upgrade44.html">
</head>

<body bgcolor="#ffffff" text="#000000">

<h2>
<a href="../index.html">
<font color="#0000ff"><i>Open</i></font><font color="#000084">BSD</font></a>
<font color="#e00000">Upgrade Guide: 4.3 to 4.4</font>
</h2>
<hr>
<p>
<a href="index.html">[FAQ Index]</a> |
<a href="upgrade43.html">[4.2 -> 4.3]</a> |
<a href="upgrade45.html">[4.4 -> 4.5]</a>

<p>

<i>Note: Upgrades are only supported from one release to the release
immediately following it.
Do not skip releases.</i>

<p><i>
It is highly recommended that you read through and fully understand
this process before attempting it.
If you are doing it on a critical or physically remote machine, it is
recommended that you test this process on an identical, local system to
verify its success before attempting on a critical or remote computer.
</i>

<p>
Upgrading is a convenient way to bring your OpenBSD system up to the most
recent version.
However, the results are not intended to precisely match the results of
a wipe-and-reload installation.
Old library files in particular are not removed in the upgrade process,
as they may be required by older applications that may or may not be
upgraded at this time.
If you REALLY wish to get rid of all these old files, you are probably
better off reinstalling from scratch.

<p>
Table of Contents:
<ul>
<li><a href="#before">Before upgrading</a>
  <ul>
  <li><a href="#newsysmerge">New sysmerge tool</a>
  <li><a href="#dhcpd.interfaces">dhcpd.interfaces no longer used</a>
  <li><a href="#newXdrivers">New X drivers</a>
  <li><a href="#pfsync">pfsync</a>
  <li><a href="#rc.conf">rc.conf</a>
  <li><a href="#kern">Modified kernel</a>
  </ul>
<li><a href="#upgrade">The upgrade process</a>
<li><a href="#final">Final steps</a>
  <ul>
  <li><a href="#UsersGroups">New and changed Users and Groups</a>
  <li><a href="#etcUpgrade">Upgrading <tt>/etc</tt></a>
  <li><a href="#Kernchk">Checking the kernel</a>
  <li><a href="#Pkgup">Upgrading packages</a>
  </ul>
</ul>

<hr>
<p>
<h2 id="before">Before upgrading: things to think about and be aware of</h2>
This is <i>not</i> a complete list of the changes that took place
between 4.3 and 4.4, but rather some of the important things that will
impact a large number of users in the upgrade process.
For a more complete list of changes, see
<a href="../plus44.html">plus44.html</a> and the CVS change logs.

<ul>
<li id="newsysmerge"><b>New
<a href="https://man.openbsd.org/sysmerge.8">sysmerge(8)</a>
utility:</b><br>
OpenBSD 4.4 includes the new
<a href="https://man.openbsd.org/sysmerge.8">sysmerge(8)</a>
utility, which helps administrators update configuration files after
upgrading their system.
Sysmerge(8) compares the current files on your system with the files
that would have been installed with a new install, and gives you the
option of keeping the old file, installing the new file, or assisting
you in the manual merging of the old and new files, using
<a href="https://man.openbsd.org/sdiff.1">sdiff</a>.
For past upgrades, we've presented a list of files that are usually
copied over "as-is", and a list of files which should be changed, and a
patch file that applies those changes to what might be in those files on
your system.
For the 4.3 to 4.4 upgrade, instead of using the patch file, you may
opt to use sysmerge to make the changes.

<p>
<b>Who should use sysmerge(8):</b><br>
People running highly modified systems or systems that didn't start out
at the previous release (for example, a snapshot partway between
releases), who are upgrading to a snapshot or who have not carefully
upgraded their system in the past will find sysmerge vastly superior to
using the patches, as it works with what is actually on your system,
instead of what we expected was on your system.
It will also give you much greater control over your upgrade process,
and will involve you in it more closely.

<p>
<b>Who may wish to NOT use sysmerge(8):</b><br>
People who have a lot of machines to upgrade that were kept fairly
simple and at the previous release/stable point will probably find the
old patch file system much faster.

<p>
Note that while sysmerge can handle ALL the changes of <tt>/etc</tt>,
<tt>/dev</tt>, <tt>/root</tt> and <tt>/var</tt>, we highly recommend
that you do some steps manually before hand, as it will save time and
reduce the possibility of user error.
In particular, it is highly recommended that you do not use sysmerge to
update your user and group accounts, as it is very easy to chose the
wrong option leading to erasing your entire user base and setting the
root password to an empty value, preventing remote login to fix the
problem.

<p>
<li id="dhcpd.interfaces"><b>dhcpd.interfaces no longer used:</b><br>
The file <tt>/etc/dhcpd.interfaces</tt> is no longer used to select
which interfaces dhcpd listens on.
This can now be specified in the <i>dhcpd_flags</i> setting in
<tt>/etc/rc.conf.local</tt>.
Most users can probably just let
<a href="https://man.openbsd.org/dhcpd.8">dhcpd(8)</a>
figure out which interface it can listen on from the configuration
information in the dhcpd.conf file.

<p>
<li id="newXdrivers"><b>New X drivers</b>
The xf86-video-openchrome driver has been added to Xenocara for VIA chipsets
in place of the old, "via" driver.
If you're using a VIA chipset with a configuration file, replace
<tt>Driver "via"</tt> with <tt>Driver "openchrome"</tt> in
<tt>/etc/X11/xorg.conf</tt> to use the new driver.
See the
<a href="https://man.openbsd.org/openchrome.4">openchrome(4)</a>
manual page for more configuration options.

<p>
The
<a href="https://man.openbsd.org/ati.4">ati(4)</a>
driver has been updated.
This update of xf86-video-ati brings about some important changes.
<ul>
<li>No more <a href="https://dri.freedesktop.org/wiki/MergedFB">MergedFB</a>:
Support for MergedFB mode has been removed in favor of
<a href="https://man.openbsd.org/xrandr.1">xrandr(1)</a>.

<li>Quirk option for Macbooks changed:
Users with Macs or Macbooks that use the following quirk
<tt>Option "iBookHacks" "on"</tt>
should read the
<a href="https://man.openbsd.org/radeon.4">radeon(4)</a>
man page, specifically the <tt>"MacModel"</tt> section, if there are problems.
<br>
As of this revision this quirk has been removed.
</ul>

<p>
<li id="pfsync"><b>pfsync:</b><br>
Due to changes in the
<a href="https://man.openbsd.org/pf">pf(4)</a>
state table, the
<a href="https://man.openbsd.org/pfsync">pfsync(4)</a>
protocol version number has been incremented; firewalls with differing
version numbers will be unable to synchronise state tables, and existing
connections will be terminated on failover.

<p>
<li id="rc.conf"><b>rc.conf:</b><br>
Unlike earlier versions of this process, since
<a href="upgrade41.html">4.1</a> it is assumed that
<tt>/etc/rc.conf</tt> is not a user-altered file.
If you have made changes to your <tt>/etc/rc.conf</tt> file, merge those
changes into <tt>/etc/rc.conf.local</tt>.
If you have NO <tt>/etc/rc.conf.local</tt>, simply copy your existing
<tt>/etc/rc.conf</tt> file to <tt>/etc/rc.conf.local</tt> and
<i>delete the last line of the script!</i>
Otherwise, pull your existing <tt>rc.conf</tt> into the top of your
existing <tt>rc.conf.local</tt> file <i>and remove the last line</i>
before doing the rest of this process.

<p>
<li id="kern"><b>Modified kernel:</b><br>
Check whether you have made any modifications to your kernel.
For example, you might have modified your network device to use a
non-default setting using config(8).
Note your changes, so you can repeat them for the new 4.4 kernel.

</ul>

<p>
<hr>
<h2 id="upgrade">The upgrade process</h2>

<h3>Upgrading by install kernel</h3>
If you have access to the system's console, the easiest and safest way
to upgrade is to boot from install media or
<a href="faq4.html#bsd.rd">bsd.rd</a> and follow the upgrade steps,
which are very similar to the <a href="faq4.html">install process</a>.
Afterwards, complete the upgrade by following the <a href="#final">final
steps</a> as detailed below.

<p>
One easy way to boot from the install kernel is to place the 4.4 version
of <i>bsd.rd</i> in the root of your boot drive, then instruct the boot loader
to boot using this new <i>bsd.rd</i> file.
On amd64 and i386, you do this by entering "<tt>boot bsd.rd</tt>" at the
initial <tt>boot&gt;</tt> prompt.

<h3>Upgrading without install kernel</h3>
<i>This is NOT the recommended process.  Use the install kernel method
if at all possible!</i>

<p>
Sometimes, one needs to do an upgrade of a machine when one can't easily
use the normal upgrade process.
The most common case is when the machine is in a remote location and you
don't have easy access to the system console.
One can usually do this by carefully following this process:

<ul>
<li><b>Place install files in a "good" location</b>.
Make sure you have sufficient space!

<p>
<li><b>Stop any "insecure" applications from starting at boot:</b>
There will be a time when PF will be unlikely to be running during this
upgrade process, but your applications may still start and run properly.
Any application dependent upon PF for security should be disabled
before this happens, and should not be re-enabled until proper PF
operation is verified after upgrade.
There may be other applications which you wish to keep from running
during the upgrade, stop and disable them as well.

<p>
<li><b>Check the kernel:</b>
Although <b>most people can skip this step</b>, if you had a modified kernel
in 4.3, it is likely you will need to modify the stock kernel of 4.4.
Especially when you are performing the upgrade process remotely, now is
the time to make sure the new kernel will work upon rebooting the machine.
If any changes must be made to the kernel, the safest thing to do is to
make those changes on a local 4.4 system.
This can be as simple as modifying a specific device using config(8),
or it can involve a recompilation if the option you need is not included
in the GENERIC kernel.
Please consult <a href="faq5.html">FAQ 5 - Building the system from source</a>
before considering to recompile your kernel.

<p>
<li><b>Install new kernel(s)</b>
<blockquote><pre>
<b>export RELEASEPATH=</b><i>/usr/rel</i>   <i># where you put the files</i>
<b>cd ${RELEASEPATH}</b>
<b>rm /obsd ; ln /bsd /obsd && cp bsd /nbsd && mv /nbsd /bsd</b>
<b>cp bsd.rd bsd.mp /</b>
</pre></blockquote>

(if you are using the multiprocessor kernel, use<br>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>rm /obsd ;
ln /bsd /obsd && cp bsd.mp /nbsd && mv /nbsd /bsd</b></tt><br>
instead)

<p>
Note the extra steps for copying over the primary kernel: those are done
to ensure that there is always a valid copy of the kernel on the disk
that the system can boot from should there be a really badly timed power
outage or system crash.

<p>
<li><b>Install new <tt>/etc/firmware</tt> files and other critical
utilities:</b>
Some uploaded "firmware" files may have been updated, so
you may need to update the files in the <tt>/etc/firmware</tt> directory.
This will impact users of only a few devices, though all users can use
this step without harm.
To make sure your network is fully functional on reboot, the new kernel
will need updated <tt>ifconfig</tt> and <tt>pfctl</tt> utilities to be
configured properly after the reboot in the next step.
Again, it's something that all users can do without harm, but if you are
performing your remote upgrade over a <tt>pppoe(4)</tt> connection this
step can be crucial.
To extract the firmware files and utilies from <tt>base44.tgz</tt>,
use the following as root:

<blockquote><pre>
<b>tar -C / -xzphf ${RELEASEPATH}/base44.tgz ./etc/firmware ./sbin/ifconfig ./sbin/pfctl</b>
</pre></blockquote>

<p>
<li><b>Reboot on the new kernel:</b>
This might be a tempting step to skip, but it should be done now, as
usually, the new kernel will run old userland apps (such as the soon to
be important <tt>reboot</tt>!), but often a new userland will NOT
work on the old kernel.

<p>
<li><b>Install new userland applications.</b>
<i>Do NOT install <tt>etc44.tgz</tt> and <tt>xetc44.tgz</tt> now, because
that will overwrite your current configuration files!</i>

<blockquote><pre>
<b>export RELEASEPATH=</b><i>/usr/rel</i>
<b>cd ${RELEASEPATH}</b>
<b>tar -C / -xzphf base44.tgz</b>
<b>tar -C / -xzphf comp44.tgz</b>
<b>tar -C / -xzphf game44.tgz</b>
<b>tar -C / -xzphf man44.tgz</b>
<b>tar -C / -xzphf misc44.tgz</b>
<b>tar -C / -xzphf xbase44.tgz</b>
<b>tar -C / -xzphf xfont44.tgz</b>
<b>tar -C / -xzphf xserv44.tgz</b>
<b>tar -C / -xzphf xshare44.tgz</b>
</pre></blockquote>

Note: not all file sets will need to be installed for all applications,
however if you installed a file set originally, you should certainly
upgrade it with the new file set now.

<p>
Note: the files in <tt>/etc</tt> are handled separately below, so
<tt>etc44.tgz</tt> and <tt>xetc44.tgz</tt> are NOT unpacked here.

<p>
<li><b>Upgrade <tt>/dev</tt>.</b>
The new
<a href="https://man.openbsd.org/OpenBSD-4.4/i386/MAKEDEV">MAKEDEV</a>
file will be copied to /dev by the installation of
<tt>base44.tgz</tt>, so you simply need to do the following:
<blockquote><pre>
<b>cd /dev</b>
<b>./MAKEDEV all</b>
</pre></blockquote>

<p>
<li><b>Upgrade <tt>/etc</tt> as below</b>.

<p>
<li><b>Reboot</b>
</ul>

During this process,
<a href="https://man.openbsd.org/sendmail.8">sendmail(8)</a>
may produce some error messages like the following:

<p>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;Nov 1 12:47:05 puffy sm-mta[16733]: filesys_update failed: No such file or directory, fs=., avail=-1, blocksize=380204
</tt>

<p>
These messages can be safely ignored for the moment, or you may wish to
halt sendmail(8) during the upgrade process.
Note that sendmail is not working properly at this point, and will need
to be restarted (as part of the reboot) before mail is expected to be
handled properly.

<p>

<hr>
<h2 id="final">Final steps</h2>

Whether you upgrade by using an install kernel and doing a formal
"upgrade" process, or do a "in-place" binary upgrade, there are certain
manual steps that have to be performed.

<h3 id="UsersGroups">1. New Users and Groups</h3>
New users are needed for
<a href="https://man.openbsd.org/rtadvd.8">rtadvd</a>,
and the upcoming ypldap(8).
Create the users and groups using
<a href="https://man.openbsd.org/useradd.8">useradd(8)</a>
<blockquote><pre>
<b>useradd -u92 -g=uid -c"IPv6 Router Advertisement Daemon" -d/var/empty -s/sbin/nologin _rtadvd</b>
<b>useradd -u93 -g=uid -c"YP to LDAP Daemon" -d/var/empty -s/sbin/nologin _ypldap</b>
</pre></blockquote>

<h3 id="etcUpgrade">2. Upgrading <tt>/etc</tt></h3>
<p>
You will want to extract the <tt>etc44.tgz</tt> files to a temporary
location:
<blockquote><pre>
<b>tar -C /tmp -xzphf ${RELEASEPATH}/etc44.tgz</b>
</pre></blockquote>


Files that can probably be copied from <tt>etc44.tgz</tt> "as is":

<blockquote><pre>
etc/magic
etc/netstart
etc/rc
etc/rc.conf
etc/security
etc/services
etc/mail/localhost.cf
etc/mail/sendmail.cf
etc/mail/submit.cf
etc/mtree/4.4BSD.dist
</pre></blockquote>

Note that it IS possible to locally modify these files, if this has been
done, do NOT copy over those files, and use the
<a href="#sysmerge">sysmerge(8) process</a> instead.
Pay special attention to <tt>mail/*</tt> if you are using something
other than the default Sendmail(8) configuration.
Here are copy/paste lines for copying these files, assuming you unpacked
<tt>etc44.tgz</tt> in the above recommended place:

<blockquote><pre>
<b>cd /tmp/etc
cp magic netstart rc rc.conf security services /etc
cp mtree/* /etc/mtree
cp mail/*.cf /etc/mail</b> <i># Careful on this one!!</i>
</pre></blockquote>

<p>
<h3 id="patchfile">3a.  Merging locally changed files via a patch file</h3>
<i>Use either this patch file process OR the
<a href="#sysmerge">sysmerge</a> process below, not both.</i>


<p>
These files likely have local changes, but should be updated for
4.4.  IF you have not altered these files, you can copy over the
new version, otherwise the changes must be merged with your files:

<blockquote><pre>
etc/changelist
etc/ftpusers
etc/hosts.lpd
etc/man.conf
etc/sudoers
etc/mail/aliases
etc/ssh/ssh_config
etc/ssh/sshd_config
</pre></blockquote>

The changes to these files are in <a href="upgrade44.patch">this
patch file</a>.
You can attempt to use this by executing the following as root:
<blockquote><pre>
<b>cd /</b>
<b>patch -C -p0 &lt; upgrade44.patch</b>
</pre></blockquote>

This will test the patch to see how well it will apply to YOUR system;
to actually apply it, leave off the "<tt>-C</tt>" option.
Note that it is likely that if you have customized files or not kept
them closely updated, or are upgrading from a snapshot of 4.3, they may
not accept the patch cleanly.
In those cases, you will need to manually apply the changes.
Please test this process before relying on it for a machine you can not
easily get to.

<p>
The following files have had changes which should be looked at, but it
is unlikely they should be directly copied or merged (i.e., if you are
using pf.conf, look at the suggested change of strategy, and decide if
it is appropriate for your use).

<blockquote><pre>
etc/dhclient.conf
etc/pf.conf
var/www/conf/httpd.conf
</pre></blockquote>

<p>
There is a file that can be deleted as it is no longer used
in 4.4:

<blockquote><pre>
<b>rm /etc/dhcpd.interfaces</b>
</pre></blockquote>


Finally, use
<a href="https://man.openbsd.org/newaliases.8">newaliases(8)</a>
to update the aliases database,
<a href="https://man.openbsd.org/mtree.8">mtree(8)</a>
create any new directories:

<blockquote><pre>
<b>newaliases</b>
<b>mtree -qdef /etc/mtree/4.4BSD.dist -p / -u</b>
</pre></blockquote>

<h3 id="sysmerge">3b. Merging locally changed files via sysmerge(8)</h3>
<i>Use either this sysmerge(8) process, OR the
<a href="#patchfile">patchfile</a> process above, not both.</i>

<p>
The new
<a href="https://man.openbsd.org/sysmerge.8">sysmerge(8)</a>
utility will compare the files that are actually on your system with
those that would be installed to a fresh install, and assist you in
merging the changes into your system.
Note that unlike the patch file, there are no assumptions made about
what is actually on your system, so you can use sysmerge(8) to move
between more arbitrary <a href="faq5.html#Flavors">points in the
development process</a>, such as from an earlier <i>-current</i> to
<i>4.4-release</i> or from one <i>-current</i> to a later one.

<p>
Please read the
<a href="https://man.openbsd.org/sysmerge.8">sysmerge(8)</a>
manual page before using it on your system.
You are also advised to read the
<a href="https://man.openbsd.org/diff.1">diff(1)</a>,
<a href="https://man.openbsd.org/sdiff.1">sdiff(1)</a>
and even review
<a href="https://man.openbsd.org/more.1">more(1)</a>
manual pages before continuing.

<p>
Assuming the <tt>etc44.tgz</tt> and <tt>xetc44.tgz</tt> files exists in
your $RELEASEPATH, run it with:

<blockquote><pre>
# <b>sudo sysmerge -as $RELEASEPATH/etc44.tgz -x $RELEASEPATH/xetc44.tgz</b>
</pre></blockquote>

Sysmerge(8) will show you a unified
<a href="https://man.openbsd.org/diff.1">diff(1)</a>,
run through your favorite $PAGER (i.e.,
<a href="https://man.openbsd.org/more.1">more(1)</a>)
and ask you, for most changed files, if you wish to:
<blockquote><pre>
  Use 'd' to delete the temporary ./var/www/htdocs/index.html
  Use 'i' to install the temporary ./var/www/htdocs/index.html
  Use 'm' to merge the temporary and installed versions
  Use 'v' to view the diff results again

  Default is to leave the temporary file to deal with by hand
</pre></blockquote>

<p>
If you wish to retain your existing file, delete the temporary file, if
you wish to replace your existing file with the new version, install the
temporary file.
If you wish to merge the two together, chosing 'm' will put you into
<a href="https://man.openbsd.org/sdiff.1">sdiff(1)</a>,
where you can manually merge the file.
The default is to come back and deal with the file later, manually.

<p>
While it can work, we do not recommend you use sysmerge to integrate new
users into the system, but rather use the useradd(8) line
<a href="#UsersGroups">above</a>.
We believe it is much less error prone.
(hint: do <i>not</i> <b>i</b>nstall the temporary master.passwd file
over your existing one!).

<p>
Sysmerge(8) saves all your replaced files into a temporary directory,
similar to <tt>/var/tmp/sysmerge.24959/backups</tt>, so if you accidentally
clobber something that was probably not such a good idea, you have a chance
to recover it. Note that
<a href="https://man.openbsd.org/daily.8">daily(8)</a>
cleans old files from this directory.

<h3 id="Kernchk">4. Checking the kernel</h3>
Note: <b>most people can skip this step!</b>
<p>
If you followed the instructions for the upgrade process without install
kernel, you have already completed this step.
However, if you used the install kernel, and if you had a modified kernel
in 4.3, it is likely you will need to modify the stock kernel of 4.4.
This can be as simple as modifying a specific device using config(8),
or it can involve a recompilation if the option you need is not included
in the GENERIC kernel.
Please consult <a href="faq5.html">FAQ 5 - Building the system from source</a>
before considering to recompile your kernel.

<h3 id="Pkgup">5. Upgrading packages</h3>
If you installed any packages on your system, you should upgrade them
after completing the upgrade of the base system.
Be aware, however, many packages will require further setup before
and/or after upgrading the package.
Check with the application's upgrade guide for details.

<p>
The following packages are known to have significant upgrade issues that
will impact a large number of users.
The fact that a package is not on this list doesn't mean it will have a
trivial upgrade.
You must do some homework on the applications YOU use.

<ul>
<li><b>ejabberd:</b> When upgrading ejabberd from 1.x to 2.x you will
need to dump and restore database as described at
<a href="https://www.ejabberd.im/migrate-host">https://www.ejabberd.im/migrate-host</a>.
<li><b>Postgresql:</b> you must dump your database before upgrade and
restore it after.
</ul>

<p>
The package tools support in-place updating using <tt>pkg_add -u</tt>.
For instance, to update all your packages, make sure <tt>PKG_PATH</tt> is
pointing to the 4.4 packages directory on your CD or nearest FTP mirror,
and use something like

<blockquote><pre>
#<b> pkg_add -ui -F update -F updatedepends</b>
</pre></blockquote>

where the <tt>-u</tt> indicates update mode, and <tt>-i</tt> specifies
interactive mode, so pkg_add will prompt you for input when it encounters
some ambiguity. Read the
<a href="https://man.openbsd.org/OpenBSD-4.4/pkg_add">pkg_add(1)</a>
manual page and the <a href="faq15.html#PkgMgmt">package management</a>
chapter of the FAQ for more information.

<p>
<a href="index.html">[FAQ Index]</a> |
<a href="upgrade43.html">[4.2 -> 4.3]</a> |
<a href="upgrade45.html">[4.4 -> 4.5]</a>

<p>
<hr>
<a href="index.html"><img height="24" width="24" src="../images/back.gif" border="0" alt="[back]"></a>
<br>
<small>$OpenBSD: upgrade44.html,v 1.39 2017/03/25 19:07:05 tb Exp $</small>

</body>
</html>
@


1.39
log
@a few more links can switch to https.
@
text
@d84 1
a84 1
<a href="http://man.openbsd.org/sysmerge.8">sysmerge(8)</a>
d87 1
a87 1
<a href="http://man.openbsd.org/sysmerge.8">sysmerge(8)</a>
d94 1
a94 1
<a href="http://man.openbsd.org/sdiff.1">sdiff</a>.
d137 1
a137 1
<a href="http://man.openbsd.org/dhcpd.8">dhcpd(8)</a>
d149 1
a149 1
<a href="http://man.openbsd.org/openchrome.4">openchrome(4)</a>
d154 1
a154 1
<a href="http://man.openbsd.org/ati.4">ati(4)</a>
d160 1
a160 1
<a href="http://man.openbsd.org/xrandr.1">xrandr(1)</a>.
d166 1
a166 1
<a href="http://man.openbsd.org/radeon.4">radeon(4)</a>
d175 1
a175 1
<a href="http://man.openbsd.org/pf">pf(4)</a>
d177 1
a177 1
<a href="http://man.openbsd.org/pfsync">pfsync(4)</a>
d340 1
a340 1
<a href="http://man.openbsd.org/OpenBSD-4.4/i386/MAKEDEV">MAKEDEV</a>
d356 1
a356 1
<a href="http://man.openbsd.org/sendmail.8">sendmail(8)</a>
d381 1
a381 1
<a href="http://man.openbsd.org/rtadvd.8">rtadvd</a>,
d384 1
a384 1
<a href="http://man.openbsd.org/useradd.8">useradd(8)</a>
d490 1
a490 1
<a href="http://man.openbsd.org/newaliases.8">newaliases(8)</a>
d492 1
a492 1
<a href="http://man.openbsd.org/mtree.8">mtree(8)</a>
d506 1
a506 1
<a href="http://man.openbsd.org/sysmerge.8">sysmerge(8)</a>
d518 1
a518 1
<a href="http://man.openbsd.org/sysmerge.8">sysmerge(8)</a>
d521 2
a522 2
<a href="http://man.openbsd.org/diff.1">diff(1)</a>,
<a href="http://man.openbsd.org/sdiff.1">sdiff(1)</a>
d524 1
a524 1
<a href="http://man.openbsd.org/more.1">more(1)</a>
d536 1
a536 1
<a href="http://man.openbsd.org/diff.1">diff(1)</a>,
d538 1
a538 1
<a href="http://man.openbsd.org/more.1">more(1)</a>)
d554 1
a554 1
<a href="http://man.openbsd.org/sdiff.1">sdiff(1)</a>,
d571 1
a571 1
<a href="http://man.openbsd.org/daily.8">daily(8)</a>
d622 1
a622 1
<a href="http://man.openbsd.org/OpenBSD-4.4/pkg_add">pkg_add(1)</a>
d635 1
a635 1
<small>$OpenBSD: upgrade44.html,v 1.38 2016/08/15 02:22:14 tb Exp $</small>
@


1.38
log
@tls on openbsd.org is now real:
- link to https://www.openbsd.org from the sub-projects' pages
- make internal links relative
- switch link rel=canonical to https to please some search engines
"go ahead" from beck, "do it!!!!" tj
@
text
@d158 1
a158 1
<li>No more <a href="http://dri.freedesktop.org/wiki/MergedFB">MergedFB</a>:
d604 1
a604 1
<a href="http://www.ejabberd.im/migrate-host">http://www.ejabberd.im/migrate-host</a>.
d635 1
a635 1
<small>$OpenBSD: upgrade44.html,v 1.37 2016/04/15 20:39:49 tb Exp $</small>
@


1.37
log
@use short form man links in the faq and fix a few broken links
@
text
@d10 1
a10 1
<link rel="canonical"      href="http://www.openbsd.org/faq/upgrade44.html">
d635 1
a635 1
<small>$OpenBSD: upgrade44.html,v 1.36 2016/04/09 22:55:45 tb Exp $</small>
@


1.36
log
@more css surgery, metadata and other cleanup, validation fixes.
@
text
@d84 1
a84 1
<a href="http://man.openbsd.org/?query=sysmerge&amp;sektion=8">sysmerge(8)</a>
d87 1
a87 1
<a href="http://man.openbsd.org/?query=sysmerge&amp;sektion=8">sysmerge(8)</a>
d94 1
a94 1
<a href="http://man.openbsd.org/?query=sdiff&amp;sektion=1">sdiff</a>.
d137 1
a137 1
<a href="http://man.openbsd.org/?query=dhcpd&amp;sektion=8">dhcpd(8)</a>
d149 1
a149 1
<a href="http://man.openbsd.org/?query=openchrome&amp;sektion=4">openchrome(4)</a>
d154 1
a154 1
<a href="http://man.openbsd.org/?query=ati&amp;sektion=4">ati(4)</a>
d160 1
a160 1
<a href="http://man.openbsd.org/?query=xrandr&amp;sektion=1">xrandr(1)</a>.
d166 1
a166 1
<a href="http://man.openbsd.org/?query=radeon&amp;sektion=4">radeon(4)</a>
d175 1
a175 1
<a href="http://man.openbsd.org/?query=pf">pf(4)</a>
d177 1
a177 1
<a href="http://man.openbsd.org/?query=pfsync">pfsync(4)</a>
d340 1
a340 1
<a href="http://man.openbsd.org/?query=MAKEDEV&amp;sektion=8&amp;arch=i386">MAKEDEV</a>
d356 1
a356 1
<a href="http://man.openbsd.org/?query=sendmail&amp;sektion=8">sendmail(8)</a>
d381 1
a381 1
<a href="http://man.openbsd.org/?query=rtadvd&amp;sektion=8">rtadvd</a>,
d384 1
a384 1
<a href="http://man.openbsd.org/?query=useradd&amp;sektion=8">useradd(8)</a>
d490 1
a490 1
<a href="http://man.openbsd.org/?query=newaliases&amp;sektion=8">newaliases(8)</a>
d492 1
a492 1
<a href="http://man.openbsd.org/?query=mtree&amp;sektion=8">mtree(8)</a>
d506 1
a506 1
<a href="http://man.openbsd.org/?query=sysmerge&amp;sektion=8">sysmerge(8)</a>
d518 1
a518 1
<a href="http://man.openbsd.org/?query=sysmerge&amp;sektion=8">sysmerge(8)</a>
d521 2
a522 2
<a href="http://man.openbsd.org/?query=diff&amp;sektion=1">diff(1)</a>,
<a href="http://man.openbsd.org/?query=sdiff&amp;sektion=1">sdiff(1)</a>
d524 1
a524 1
<a href="http://man.openbsd.org/?query=more&amp;sektion=1">more(1)</a>
d536 1
a536 1
<a href="http://man.openbsd.org/?query=diff&amp;sektion=1">diff(1)</a>,
d538 1
a538 1
<a href="http://man.openbsd.org/?query=more&amp;sektion=1">more(1)</a>)
d554 1
a554 1
<a href="http://man.openbsd.org/?query=sdiff&amp;sektion=1">sdiff(1)</a>,
d571 1
a571 1
<a href="http://man.openbsd.org/?query=daily&amp;sektion=8">daily(8)</a>
d622 1
a622 1
<a href="http://man.openbsd.org/?query=pkg_add&amp;sektion=1&amp;manpath=OpenBSD+4.4">pkg_add(1)</a>
d635 1
a635 1
<small>$OpenBSD: upgrade44.html,v 1.35 2016/03/27 19:52:09 sthen Exp $</small>
@


1.35
log
@add a small sprinkling of css to improve readability in the faq, ok tj@@ tb@@
@
text
@d8 3
a10 3
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="../openbsd.css">
<link rel="canonical" href="http://www.openbsd.org/faq/upgrade44.html">
d14 2
d17 4
a20 2
<img alt="[OpenBSD]" height=30 width=141 src="../images/smalltitle.gif" border="0">    
</a>
d22 1
a22 10
<font color="#0000e0">
<a href="upgrade35.html">[3.4 -> 3.5]</a> |
<a href="upgrade36.html">[3.5 -> 3.6]</a> |
<a href="upgrade37.html">[3.6 -> 3.7]</a> |
<a href="upgrade38.html">[3.7 -> 3.8]</a> |
<a href="upgrade39.html">[3.8 -> 3.9]</a> |
<br>
<a href="upgrade40.html">[3.9 -> 4.0]</a> |
<a href="upgrade41.html">[4.0 -> 4.1]</a> |
<a href="upgrade42.html">[4.1 -> 4.2]</a> |
d24 3
a26 8
<a href="upgrade45.html">[4.4 -> 4.5]</a> |
<a href="index.html">[FAQ Index]</a>
</font>

<h1><font color="#e00000">
Upgrade Guide: 4.3 to 4.4
</font></h1>
<hr>
d70 1
a70 1
  </ul> 
d75 1
a75 2
<a name="before"></a>
<h2>Before upgrading: things to think about and be aware of</h2>
a81 1
<a name="newsysmerge"></a>
d83 1
a83 1
<li><b>New
d131 1
a131 2
<a name="dhcpd.interfaces"></a>
<li><b>dhcpd.interfaces no longer used:</b><br>
d142 1
a142 2
<a name="newXdrivers"></a>
<li><b>New X drivers</b>
d173 1
a173 2
<a name="pfsync"></a>
<li><b>pfsync:</b><br>
d183 1
a183 2
<a name="rc.conf"></a>
<li><b>rc.conf:</b><br>
d197 1
a197 2
<a name="kern"></a>
<li><b>Modified kernel:</b><br>
d207 1
a207 2
<a name="upgrade"></a>
<h2>The upgrade process</h2>
d243 1
a243 1
Any application dependent upon PF for security should be disabled 
d339 1
a339 1
The new 
d373 1
a373 2
<a name="final"></a>
<h2>Final steps</h2>
d375 2
a376 2
Whether you upgrade by using an install kernel and doing a formal  
"upgrade" process, or do a "in-place" binary upgrade, there are certain 
d378 2
a379 3
  
<a name="UsersGroups"></a>
<h3>1. New Users and Groups</h3>
d390 1
a390 2
<a name="etcUpgrade"></a>
<h3>2. Upgrading <tt>/etc</tt></h3>
d419 1
a419 1
Here are copy/paste lines for copying these files, assuming you unpacked 
d430 1
a430 2
<a name="patchfile"></a>
<h3>3a.  Merging locally changed files via a patch file</h3>
d500 1
a500 2
<a name="sysmerge"></a>
<h3>3b. Merging locally changed files via sysmerge(8)</h3>
d517 1
a517 1
Please read the 
d570 1
a570 1
to recover it. Note that 
d574 1
a574 2
<a name="Kernchk"></a>
<h3>4. Checking the kernel</h3>
d587 1
a587 2
<a name="Pkgup"></a>
<h3>5. Upgrading packages</h3>
d614 1
a614 1
 
d627 1
a627 10
<font color="#0000e0">
<a href="upgrade35.html">[3.4 -> 3.5]</a> |
<a href="upgrade36.html">[3.5 -> 3.6]</a> |
<a href="upgrade37.html">[3.6 -> 3.7]</a> |
<a href="upgrade38.html">[3.7 -> 3.8]</a> |
<a href="upgrade39.html">[3.8 -> 3.9]</a> |
<br>
<a href="upgrade40.html">[3.9 -> 4.0]</a> |
<a href="upgrade41.html">[4.0 -> 4.1]</a> |
<a href="upgrade42.html">[4.1 -> 4.2]</a> |
d629 1
a629 3
<a href="upgrade45.html">[4.4 -> 4.5]</a> |
<a href="index.html">[FAQ Index]</a>
</font>
d635 1
a635 1
<small>$OpenBSD: upgrade44.html,v 1.34 2016/03/22 10:54:48 sthen Exp $</small>
@


1.34
log
@fix URIs, the / before querystring isn't optional, if it isn't fixed up
by the browser the server returns 400 Bad Request
@
text
@d8 2
d671 1
a671 1
<small>$OpenBSD: upgrade44.html,v 1.33 2016/03/21 05:46:21 beck Exp $</small>
@


1.33
log
@change http://www.openbsd.org/cgi-bin/man.cgi to be http://man.openbsd.org
this points stuff to the new place and gets us ready to deprecate the old
place we did this.
@
text
@d94 1
a94 1
<a href="http://man.openbsd.org?query=sysmerge&amp;sektion=8">sysmerge(8)</a>
d97 1
a97 1
<a href="http://man.openbsd.org?query=sysmerge&amp;sektion=8">sysmerge(8)</a>
d104 1
a104 1
<a href="http://man.openbsd.org?query=sdiff&amp;sektion=1">sdiff</a>.
d148 1
a148 1
<a href="http://man.openbsd.org?query=dhcpd&amp;sektion=8">dhcpd(8)</a>
d161 1
a161 1
<a href="http://man.openbsd.org?query=openchrome&amp;sektion=4">openchrome(4)</a>
d166 1
a166 1
<a href="http://man.openbsd.org?query=ati&amp;sektion=4">ati(4)</a>
d172 1
a172 1
<a href="http://man.openbsd.org?query=xrandr&amp;sektion=1">xrandr(1)</a>.
d178 1
a178 1
<a href="http://man.openbsd.org?query=radeon&amp;sektion=4">radeon(4)</a>
d188 1
a188 1
<a href="http://man.openbsd.org?query=pf">pf(4)</a>
d190 1
a190 1
<a href="http://man.openbsd.org?query=pfsync">pfsync(4)</a>
d356 1
a356 1
<a href="http://man.openbsd.org?query=MAKEDEV&amp;sektion=8&amp;arch=i386">MAKEDEV</a>
d372 1
a372 1
<a href="http://man.openbsd.org?query=sendmail&amp;sektion=8">sendmail(8)</a>
d399 1
a399 1
<a href="http://man.openbsd.org?query=rtadvd&amp;sektion=8">rtadvd</a>,
d402 1
a402 1
<a href="http://man.openbsd.org?query=useradd&amp;sektion=8">useradd(8)</a>
d510 1
a510 1
<a href="http://man.openbsd.org?query=newaliases&amp;sektion=8">newaliases(8)</a>
d512 1
a512 1
<a href="http://man.openbsd.org?query=mtree&amp;sektion=8">mtree(8)</a>
d527 1
a527 1
<a href="http://man.openbsd.org?query=sysmerge&amp;sektion=8">sysmerge(8)</a>
d539 1
a539 1
<a href="http://man.openbsd.org?query=sysmerge&amp;sektion=8">sysmerge(8)</a>
d542 2
a543 2
<a href="http://man.openbsd.org?query=diff&amp;sektion=1">diff(1)</a>,
<a href="http://man.openbsd.org?query=sdiff&amp;sektion=1">sdiff(1)</a>
d545 1
a545 1
<a href="http://man.openbsd.org?query=more&amp;sektion=1">more(1)</a>
d557 1
a557 1
<a href="http://man.openbsd.org?query=diff&amp;sektion=1">diff(1)</a>,
d559 1
a559 1
<a href="http://man.openbsd.org?query=more&amp;sektion=1">more(1)</a>)
d575 1
a575 1
<a href="http://man.openbsd.org?query=sdiff&amp;sektion=1">sdiff(1)</a>,
d592 1
a592 1
<a href="http://man.openbsd.org?query=daily&amp;sektion=8">daily(8)</a>
d645 1
a645 1
<a href="http://man.openbsd.org?query=pkg_add&amp;sektion=1&amp;manpath=OpenBSD+4.4">pkg_add(1)</a>
d669 1
a669 1
<small>$OpenBSD: upgrade44.html,v 1.32 2015/07/08 01:11:32 nick Exp $</small>
@


1.32
log
@
better pages <title>, better matching the page.  From Pavel Plamenov
(pvlplmnv at gmail), thanks!
@
text
@d94 1
a94 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysmerge&amp;sektion=8">sysmerge(8)</a>
d97 1
a97 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysmerge&amp;sektion=8">sysmerge(8)</a>
d104 1
a104 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sdiff&amp;sektion=1">sdiff</a>.
d148 1
a148 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dhcpd&amp;sektion=8">dhcpd(8)</a>
d161 1
a161 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=openchrome&amp;sektion=4">openchrome(4)</a>
d166 1
a166 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ati&amp;sektion=4">ati(4)</a>
d172 1
a172 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xrandr&amp;sektion=1">xrandr(1)</a>.
d178 1
a178 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=radeon&amp;sektion=4">radeon(4)</a>
d188 1
a188 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf">pf(4)</a>
d190 1
a190 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync">pfsync(4)</a>
d356 1
a356 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=MAKEDEV&amp;sektion=8&amp;arch=i386">MAKEDEV</a>
d372 1
a372 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sendmail&amp;sektion=8">sendmail(8)</a>
d399 1
a399 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rtadvd&amp;sektion=8">rtadvd</a>,
d402 1
a402 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=useradd&amp;sektion=8">useradd(8)</a>
d510 1
a510 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=newaliases&amp;sektion=8">newaliases(8)</a>
d512 1
a512 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mtree&amp;sektion=8">mtree(8)</a>
d527 1
a527 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysmerge&amp;sektion=8">sysmerge(8)</a>
d539 1
a539 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysmerge&amp;sektion=8">sysmerge(8)</a>
d542 2
a543 2
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=diff&amp;sektion=1">diff(1)</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sdiff&amp;sektion=1">sdiff(1)</a>
d545 1
a545 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=more&amp;sektion=1">more(1)</a>
d557 1
a557 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=diff&amp;sektion=1">diff(1)</a>,
d559 1
a559 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=more&amp;sektion=1">more(1)</a>)
d575 1
a575 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sdiff&amp;sektion=1">sdiff(1)</a>,
d592 1
a592 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=daily&amp;sektion=8">daily(8)</a>
d645 1
a645 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pkg_add&amp;sektion=1&amp;manpath=OpenBSD+4.4">pkg_add(1)</a>
d669 1
a669 1
<small>$OpenBSD: upgrade44.html,v 1.31 2015/07/02 05:49:04 bentley Exp $</small>
@


1.31
log
@Clean up meta tags.

name=distribution, name=keywords, and name=resource-type have no effect
in modern search engines and just clutter up the page source.

From Pavel Plamenov.
@
text
@d4 1
a4 1
<title>OpenBSD Upgrade Guide 4.4</title>
d669 1
a669 1
<small>$OpenBSD: upgrade44.html,v 1.30 2015/05/11 11:18:30 sthen Exp $</small>
@


1.30
log
@Add 'link rel="canonical"' to pages, acting as a hint to search engines
to list the copies on www.openbsd.org rather than mirrors.

From Carlin Bingham, ok millert@@ nick@@
@
text
@a5 1
<meta name="resource-type" content="document">
a6 2
<meta name="keywords"      content="openbsd,faq,upgrade,4.4">
<meta name="distribution"  content="global">
d669 1
a669 1
<small>$OpenBSD: upgrade44.html,v 1.29 2014/03/31 01:47:54 nick Exp $</small>
@


1.29
log
@
www@@ is no more.  normalized 54 to new footer style, but rest were left
unchanged deliberately.
@
text
@d11 1
d672 1
a672 1
<small>$OpenBSD: upgrade44.html,v 1.28 2009/04/30 17:24:33 nick Exp $</small>
@


1.28
log
@
add links to upgrade45.html
@
text
@a4 1
<link rev="made" href="mailto:www@@openbsd.org">
a669 1
<a href="mailto:www@@openbsd.org">www@@openbsd.org</a>
d671 1
a671 1
<small>$OpenBSD: upgrade44.html,v 1.27 2009/04/20 11:23:26 nick Exp $</small>
@


1.27
log
@
my breaking the lines at 80 chars like it would look like on a CRT is
clever (not really), but obscures the string from search engines.
Not an issue for the 4.5 upgrade process (hopefully).
@
text
@d30 1
d664 1
d673 1
a673 1
<small>$OpenBSD: upgrade44.html,v 1.26 2008/12/28 03:12:46 nick Exp $</small>
@


1.26
log
@
we've had a couple requests for adding pfctl to the list of pre-unpacked
utilities for the first reboot, which does allow PF to come up, even
though we warn you that it might not.  4.5 is going to be even more
exciting.
@
text
@d376 6
a381 4
<pre>
    Nov 1 12:47:05 puffy sm-mta[16733]: filesys_update failed: No such file or dire
    ctory, fs=., avail=-1, blocksize=380204
</pre>
d671 1
a671 1
<small>$OpenBSD: upgrade44.html,v 1.25 2008/12/04 20:34:26 sthen Exp $</small>
@


1.25
log
@Mention the pfsync version bump, pointed out by John L. Scarfone on www@@.
ok nick
@
text
@d302 3
a304 3
<li><b>Install new <tt>/etc/firmware</tt> files and
<tt>/sbin/ifconfig</tt> utility:</b>
Due to the fact that some uploaded "firmware" files may have been updated,
d308 3
a310 3
Sometimes the network drivers (especially more complex devices such as
<tt>pppoe(4)</tt>) in the new kernel need an updated <tt>ifconfig</tt>
utility to be configured properly after the reboot in the next step.
d314 1
a314 1
To extract the firmware files and ifconfig from <tt>base44.tgz</tt>,
d318 1
a318 1
<b>tar -C / -xzphf ${RELEASEPATH}/base44.tgz ./etc/firmware ./sbin/ifconfig</b>
d669 1
a669 1
<small>$OpenBSD: upgrade44.html,v 1.24 2008/11/22 11:04:08 tobias Exp $</small>
@


1.24
log
@Missing full stop added.
@
text
@d69 1
d187 11
d669 1
a669 1
<small>$OpenBSD: upgrade44.html,v 1.23 2008/11/10 22:00:26 kili Exp $</small>
@


1.23
log
@
Postgresql needs a dump before the upgrade.
@
text
@d617 1
a617 1
restore it after
d657 1
a657 1
<small>$OpenBSD: upgrade44.html,v 1.22 2008/11/07 03:17:49 nick Exp $</small>
@


1.22
log
@
semicolon probably better than comma, from Aaron W. Hsu.
@
text
@d606 1
a606 1
The following package is known to have significant upgrade issues that
d616 2
d657 1
a657 1
<small>$OpenBSD: upgrade44.html,v 1.21 2008/11/01 20:42:15 tobias Exp $</small>
@


1.21
log
@Sync with Steelix CVS
@
text
@d467 1
a467 1
This will test the patch to see how well it will apply to YOUR system,
d655 1
a655 1
<small>$OpenBSD: upgrade44.html,v 1.20 2008/10/17 20:34:15 sthen Exp $</small>
@


1.20
log
@- fix typos pointed out by Remco on www@@, thanks!
- rework phrase about sysmerge backup directory and add a little
(reminder|educational piece) about what daily(8) does to /var/tmp.

ok nick@@
@
text
@d511 1
a511 1
<a href="#patchfile">patchfile</a> process above, not both</i>
d655 1
a655 1
<small>$OpenBSD: upgrade44.html,v 1.19 2008/10/05 18:21:55 nick Exp $</small>
@


1.19
log
@
time to remove the qualifiers, I think it is ready for use.
@
text
@d142 1
a142 1
<a name="dhcpd.inerfaces"></a>
d576 6
a581 4
Sysmerge(8) saves all your replaced files a temporary directory, similar
to <tt>/var/tmp/sysmerge.24959/backups</tt>, so if you accidently clobber
something that was probably not such a good idea, it can be recovered
until you delete that directory.
d655 1
a655 1
<small>$OpenBSD: upgrade44.html,v 1.18 2008/10/03 03:04:35 nick Exp $</small>
@


1.18
log
@
HTML validation fixes
@
text
@a33 1
<!--
a34 2
-->
Work In Progress, use with care!
d653 1
a653 1
<small>$OpenBSD: upgrade44.html,v 1.17 2008/10/03 02:23:17 nick Exp $</small>
@


1.17
log
@
add dhcpd.interfaces and new X drivers sections to "things to be aware of".
@
text
@d95 1
a96 1
<a name="newsysmerge"></a>
d165 1
a165 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=openchrome&sektion=4">openchrome(4)</a>
d182 1
a182 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=radeon&sektion=4">radeon(4)</a>
d656 1
a656 1
<small>$OpenBSD: upgrade44.html,v 1.16 2008/09/24 20:08:38 chl Exp $</small>
@


1.16
log
@keep consistency between upgrade43 and upgrade44

ok nick@@
@
text
@d70 2
d144 43
d656 1
a656 1
<small>$OpenBSD: upgrade44.html,v 1.15 2008/09/18 01:04:27 nick Exp $</small>
@


1.15
log
@
ejabberd is a special case for upgrades, per viq at viq dot ath dot cx,
and a discussion on ports@@.
Anything else out there we are forgetting, porters?
@
text
@d451 1
a451 1
etc/dhcpd.interfaces
d611 1
a611 1
<small>$OpenBSD: upgrade44.html,v 1.14 2008/09/18 00:56:42 nick Exp $</small>
@


1.14
log
@
promote from "don't use" to "use with care"
@
text
@d569 3
a571 1
<li> XXX
d611 1
a611 1
<small>$OpenBSD: upgrade44.html,v 1.13 2008/09/17 10:42:58 nick Exp $</small>
@


1.13
log
@
fix version number, from bsd at openbsd dot rutgers dot edu, thanks!
@
text
@d37 1
a37 1
Work In Progress, don't even try it (yet)!
d609 1
a609 1
<small>$OpenBSD: upgrade44.html,v 1.12 2008/09/05 11:14:15 nick Exp $</small>
@


1.12
log
@
singular -> plural, since there are multiple users to add.
@
text
@d216 1
a216 1
in 4.4, it is likely you will need to modify the stock kernel of 4.4.
d609 1
a609 1
<small>$OpenBSD: upgrade44.html,v 1.11 2008/09/05 11:00:03 nick Exp $</small>
@


1.11
log
@
missing new user.  <sarcasm>So nice to see people carefully keeping
current.html up-to-date</sarcasm>.  Thanks to Daniel Ouellet for
noticing.
@
text
@d343 2
a344 2
<h3>1. New and changed Users and Groups</h3>
A new user is needed for
d346 2
a347 1
Create the user and group using
d609 1
a609 1
<small>$OpenBSD: upgrade44.html,v 1.10 2008/09/03 10:57:33 nick Exp $</small>
@


1.10
log
@
Typos, thinkos and stupidos from sthen@@ and ajocoutot@@, thanks!  Also
add package upgrade advisory section, which should be a separate commit,
'cept I've already removed it twice, and I'm tired of doing so :)
@
text
@d350 1
d608 1
a608 1
<small>$OpenBSD: upgrade44.html,v 1.9 2008/09/03 02:34:08 nick Exp $</small>
@


1.9
log
@
correct numbering of sections 4 & 5
Add another reason to use sysmerge -- it cleans up past sloppy upgrades
nicely.
Fill out sysmerge section (sysmerge people: look over and comment, please).
@
text
@d127 1
a127 1
People who have a lot of machines to upgprade that were kept fairly
d493 2
a494 2
Assuming the <tt>etc44.tgz</tt> file exists in your $RELEASEPATH,
run it with:
d520 1
a520 1
where you can manually merge the file, (different) line-by-line.
d560 11
a586 1
A
d607 1
a607 1
<small>$OpenBSD: upgrade44.html,v 1.8 2008/09/02 11:03:04 nick Exp $</small>
@


1.8
log
@
service -> services
@
text
@d118 4
a121 3
releases) or who are upgrading to a snapshot will find sysmerge vastly
superior to using the patches, as it works with what is actually on your
system, instead of what we expected was on your system.
d469 1
d483 8
a490 2
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysmerge&amp;sektion=8">sysmerge(8)
manual page</a> before using it on your system.
d496 3
d500 10
d511 2
d514 22
d538 1
a538 1
<h3>5. Checking the kernel</h3>
d552 1
a552 1
<h3>4. Upgrading packages</h3>
d597 1
a597 1
<small>$OpenBSD: upgrade44.html,v 1.7 2008/09/01 18:09:56 nick Exp $</small>
@


1.7
log
@
+upgrade44.patch.  WARNING: very lightly tested so far.
@
text
@d386 1
a386 1
cp magic netstart rc rc.conf security service /etc
d552 1
a552 1
<small>$OpenBSD: upgrade44.html,v 1.6 2008/09/01 18:02:01 nick Exp $</small>
@


1.6
log
@
chio.conf was a left-over from 4.3
@
text
@a414 1
currently nonexistant
d552 1
a552 1
<small>$OpenBSD: upgrade44.html,v 1.5 2008/09/01 17:41:15 nick Exp $</small>
@


1.5
log
@
fill in manual merge and delete sections.
@
text
@d457 1
a457 2
create any new directories, and change the ownership and access to
<tt>/etc/chio.conf</tt>:
a461 2
<b>chown root:operator /etc/chio.conf</b>
<b>chmod 644 /etc/chio.conf</b>
d553 1
a553 1
<small>$OpenBSD: upgrade44.html,v 1.4 2008/08/31 15:50:26 nick Exp $</small>
@


1.4
log
@
I managed to reverse the bsd.mp and bsd kernel upgrade lines.  Jonathan
Armani (dbd at asystant dot net) managed to spot it, thanks!
@
text
@d439 3
a441 1
XXX
d445 1
a445 1
There are a couple files that can be deleted that are no longer used
d449 1
a449 1
XXX
d556 1
a556 1
<small>$OpenBSD: upgrade44.html,v 1.3 2008/08/30 17:15:44 nick Exp $</small>
@


1.3
log
@
starting to fill in the blanks.  copy-as-is, patch list.
Verification of my lists is welcome, but not expected.
@
text
@d231 1
a231 1
<b>rm /obsd ; ln /bsd /obsd && cp bsd.mp /nbsd && mv /nbsd /bsd</b>
d236 2
a237 1
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>rm /obsd ; ln /bsd /obsd && cp bsd /nbsd && mv /nbsd /bsd</b></tt><br>
d554 1
a554 1
<small>$OpenBSD: upgrade44.html,v 1.2 2008/08/30 16:29:24 nick Exp $</small>
@


1.2
log
@
restructure to work-in option of using sysmerge.
I'm opting for a hybrid approach -- some files should just be copied
over, some files should be handled in other ways (master.passwd, group),
and sysmerge rocks for the rest.  As does a patch file for some users.
@
text
@d363 10
a372 1
 ... tbd ...
d385 3
a387 1
...XXX </b>
d403 8
a410 1
...XXX
d553 1
a553 1
<small>$OpenBSD: upgrade44.html,v 1.1 2008/08/20 02:21:54 nick Exp $</small>
@


1.1
log
@
start getting ready for 4.4.
Don't even think of trying to use this yet, all details are still not here.
sysmerge part is missing still, too.
@
text
@d69 1
a69 1
  <li><a href="#"></a>
d94 47
d246 2
a247 1
<li><b>Install new <tt>/etc/firmware</tt> files:</b>
a251 10
To extract the firmware files from <tt>base44.tgz</tt>, use the
following as root:

<blockquote><pre>
<b>cd /</b>
<b>tar -C / -xzphf ${RELEASEPATH}/base44.tgz ./etc/firmware</b>
</pre></blockquote>

<p>
<li><b>Install new <tt>/sbin/ifconfig</tt> utility:</b>
d258 2
a259 2
To extract the <tt>ifconfig</tt> utility from <tt>base44.tgz</tt>, use the
following as root:
d262 1
a262 1
<b>tar -C / -xzphf ${RELEASEPATH}/base44.tgz ./sbin/ifconfig</b>
d367 2
a368 1
done, manual merging will be needed.
d381 6
d436 1
a436 1
to create any new directories, and change the ownership and access to
d446 29
d476 1
a476 1
<h3>3. Checking the kernel</h3>
d535 1
a535 1
<small>$OpenBSD: upgrade44.html,v 1.15 2008/07/13 15:36:41 nick Exp $</small>
@

