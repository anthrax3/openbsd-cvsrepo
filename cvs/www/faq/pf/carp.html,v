head	1.57;
access;
symbols;
locks; strict;
comment	@# @;


1.57
date	2016.09.19.23.57.52;	author tj;	state Exp;
branches;
next	1.56;
commitid	GNVOkJslrAyDPluC;

1.56
date	2016.08.15.02.22.14;	author tb;	state Exp;
branches;
next	1.55;
commitid	3DeixV5YkPOb78RN;

1.55
date	2016.06.13.17.58.24;	author tj;	state Exp;
branches;
next	1.54;
commitid	Grx2UyJPWzJbbhkP;

1.54
date	2016.04.18.19.07.50;	author tj;	state Exp;
branches;
next	1.53;
commitid	g0cUF3jNn5Tz4oaZ;

1.53
date	2016.04.16.00.30.41;	author tj;	state Exp;
branches;
next	1.52;
commitid	rTxoenHHaeutOff1;

1.52
date	2016.04.15.20.39.49;	author tb;	state Exp;
branches;
next	1.51;
commitid	jwteSMEb4rFzI8UA;

1.51
date	2016.03.29.01.27.39;	author tb;	state Exp;
branches;
next	1.50;
commitid	4Y8oU6GBrSY1UOfW;

1.50
date	2016.03.27.19.52.09;	author sthen;	state Exp;
branches;
next	1.49;
commitid	hi2ObFv9LGB98JY5;

1.49
date	2016.03.22.10.56.56;	author sthen;	state Exp;
branches;
next	1.48;
commitid	G2izHhNJ7aqR0Y6j;

1.48
date	2016.03.21.05.46.21;	author beck;	state Exp;
branches;
next	1.47;
commitid	zEx6zFkNSFFExu0v;

1.47
date	2016.02.27.15.08.43;	author tj;	state Exp;
branches;
next	1.46;
commitid	WG2Gu8hJLI5LFubY;

1.46
date	2016.01.24.21.40.35;	author tj;	state Exp;
branches;
next	1.45;
commitid	bFaFSpgHCeTHjIC5;

1.45
date	2016.01.10.01.28.23;	author tb;	state Exp;
branches;
next	1.44;
commitid	XRwfjSZEEhwWVFGt;

1.44
date	2015.10.29.15.03.12;	author nick;	state Exp;
branches;
next	1.43;
commitid	48Ojv9Pv8QIZZ2bF;

1.43
date	2015.10.18.19.48.19;	author nick;	state Exp;
branches;
next	1.42;
commitid	gkrFWKimwWNVivXe;

1.42
date	2015.07.02.05.49.05;	author bentley;	state Exp;
branches;
next	1.41;
commitid	AP3UllesavMDEUhQ;

1.41
date	2015.05.11.11.18.30;	author sthen;	state Exp;
branches;
next	1.40;
commitid	wRrXxcro6dFYiwF8;

1.40
date	2015.04.30.23.48.01;	author nick;	state Exp;
branches;
next	1.39;
commitid	uFWv68UTtTmjkqVF;

1.39
date	2014.12.02.03.17.26;	author nick;	state Exp;
branches;
next	1.38;
commitid	RQ0cKiFD5x45dGyo;

1.38
date	2014.12.01.10.01.07;	author bentley;	state Exp;
branches;
next	1.37;
commitid	DtrOVs7q8kqgEsjm;

1.37
date	2014.05.01.15.03.50;	author nick;	state Exp;
branches;
next	1.36;

1.36
date	2014.03.31.02.33.07;	author nick;	state Exp;
branches;
next	1.35;

1.35
date	2013.11.01.14.07.05;	author nick;	state Exp;
branches;
next	1.34;

1.34
date	2013.05.01.13.21.45;	author nick;	state Exp;
branches;
next	1.33;

1.33
date	2012.12.19.12.03.19;	author nick;	state Exp;
branches;
next	1.32;

1.32
date	2012.11.01.15.06.36;	author nick;	state Exp;
branches;
next	1.31;

1.31
date	2012.05.11.11.20.04;	author nick;	state Exp;
branches;
next	1.30;

1.30
date	2012.02.04.22.20.43;	author dtucker;	state Exp;
branches;
next	1.29;

1.29
date	2011.11.02.01.01.47;	author nick;	state Exp;
branches;
next	1.28;

1.28
date	2011.05.01.12.57.11;	author nick;	state Exp;
branches;
next	1.27;

1.27
date	2010.11.01.09.53.51;	author nick;	state Exp;
branches;
next	1.26;

1.26
date	2010.05.19.13.25.16;	author sthen;	state Exp;
branches;
next	1.25;

1.25
date	2010.02.01.14.48.11;	author jsg;	state Exp;
branches;
next	1.24;

1.24
date	2009.10.16.19.12.42;	author nick;	state Exp;
branches;
next	1.23;

1.23
date	2009.04.30.17.27.31;	author nick;	state Exp;
branches;
next	1.22;

1.22
date	2008.11.12.02.53.32;	author nick;	state Exp;
branches;
next	1.21;

1.21
date	2008.10.31.16.49.34;	author nick;	state Exp;
branches;
next	1.20;

1.20
date	2008.07.27.17.13.47;	author nick;	state Exp;
branches;
next	1.19;

1.19
date	2007.11.01.02.57.56;	author joel;	state Exp;
branches;
next	1.18;

1.18
date	2007.05.07.01.27.19;	author joel;	state Exp;
branches;
next	1.17;

1.17
date	2007.05.06.18.59.54;	author nick;	state Exp;
branches;
next	1.16;

1.16
date	2007.02.12.20.19.17;	author joel;	state Exp;
branches;
next	1.15;

1.15
date	2007.01.23.07.30.16;	author joel;	state Exp;
branches;
next	1.14;

1.14
date	2007.01.21.15.41.15;	author steven;	state Exp;
branches;
next	1.13;

1.13
date	2006.11.01.01.56.01;	author joel;	state Exp;
branches;
next	1.12;

1.12
date	2006.10.27.19.26.13;	author nick;	state Exp;
branches;
next	1.11;

1.11
date	2006.10.25.15.33.53;	author steven;	state Exp;
branches;
next	1.10;

1.10
date	2006.05.01.00.54.29;	author nick;	state Exp;
branches;
next	1.9;

1.9
date	2005.11.11.02.22.50;	author nick;	state Exp;
branches;
next	1.8;

1.8
date	2005.11.11.02.01.13;	author nick;	state Exp;
branches;
next	1.7;

1.7
date	2005.11.01.11.35.18;	author nick;	state Exp;
branches;
next	1.6;

1.6
date	2005.09.24.21.00.58;	author msf;	state Exp;
branches;
next	1.5;

1.5
date	2005.05.22.17.15.00;	author saad;	state Exp;
branches;
next	1.4;

1.4
date	2005.05.22.16.41.27;	author saad;	state Exp;
branches;
next	1.3;

1.3
date	2005.05.22.16.25.36;	author saad;	state Exp;
branches;
next	1.2;

1.2
date	2005.05.22.08.21.36;	author saad;	state Exp;
branches;
next	1.1;

1.1
date	2005.05.21.05.51.24;	author joel;	state Exp;
branches;
next	;


desc
@@


1.57
log
@"keep state" is the default so we don't need to specify it so many times.
@
text
@<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>

<!-- If you make edits to any FAQ documents, please start each sentence
     on a new line, and try to keep the general formatting consistent
     with the rest of the pages -->

<title>OpenBSD PF: Firewall Redundancy (CARP and pfsync)</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="../../openbsd.css">
<link rel="canonical" href="https://www.openbsd.org/faq/pf/carp.html">
</head>

<!--
Copyright (c) 2005-2007 Joel Knight <enabled@@myrealbox.com>

Permission to use, copy, modify, and distribute this documentation for
any purpose with or without fee is hereby granted, provided that the
above copyright notice and this permission notice appear in all copies.

THE DOCUMENTATION IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL
WARRANTIES WITH REGARD TO THIS DOCUMENTATION INCLUDING ALL IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE
AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL
DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR
PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS DOCUMENTATION
-->

<body bgcolor="#ffffff" text="#000000">

<h2>
<a href="../../index.html">
<font color="#0000ff"><i>Open</i></font><font color="#000084">BSD</font></a>
<font color="#e00000">PF - Firewall Redundancy (CARP and pfsync)</font>
<small>
<a href="index.html" style="font-weight:normal; float:right">[Contents]</a>
</small>
</h2>
<hr>

<ul>
  <li><a href="#carpintro"         >Introduction to CARP</a>
  <li><a href="#carpop"            >CARP operation</a>
  <li><a href="#carpconfig"        >Configuring CARP</a>
  <li><a href="#carpex"            >CARP example</a>
  <li><a href="#pfsyncintro"       >Introduction to pfsync</a>
  <li><a href="#pfsyncop"          >pfsync operation</a>
  <li><a href="#pfsyncconfig"      >Configuring pfsync</a>
  <li><a href="#pfsyncex"          >pfsync example</a>
  <li><a href="#failover"          >Combining CARP and pfsync for failover
                                    and redundancy</a>
  <li><a href="#ops"               >Operational issues</a>
        <ul>
        <li><a href="#bootconfig"  >Configuring CARP and pfsync during boot</a>
        <li><a href="#forcefail"   >Forcing failover of the master</a>
        <li><a href="#RulesetTips" >Ruleset tips</a>
        </ul>
  <li><a href="#ref"               >Other references</a>
</ul>

<hr>

<h2 id="carpintro">Introduction to CARP</h2>

CARP is the Common Address Redundancy Protocol.
Its primary purpose is to allow multiple hosts on the same network segment
to share an IP address.
CARP is a secure, free alternative to the
<a href="http://www.ietf.org/rfc/rfc3768.txt">Virtual Router Redundancy
Protocol</a> (VRRP) and the
<a href="http://www.ietf.org/rfc/rfc2281.txt">Hot Standby Router Protocol</a>
(HSRP).

<p>
CARP works by allowing a group of hosts on the same network segment to
share an IP address.
This group of hosts is referred to as a "redundancy group."
The redundancy group is assigned an IP address that is shared amongst
the group members.
Within the group, one host is designated the "master" and the rest as
"backups."
The master host is the one that currently "holds" the shared IP; it
responds to any traffic or ARP requests directed towards it.
Each host may belong to more than one redundancy group at a time.

<p>
One common use for CARP is to create a group of redundant firewalls.
The virtual IP that is assigned to the redundancy group is configured on
client machines as the default gateway.
In the event that the master firewall suffers a failure or is taken
offline, the IP will move to one of the backup firewalls and service
will continue unaffected.

<p>
CARP supports IPv4 and IPv6.

<h2 id="carpop">CARP operation</h2>

The master host in the group sends regular advertisements to the local
network so that the backup hosts know it's still alive.
If the backup hosts don't hear an advertisement from the master for a
set period of time, then one of them will take over the duties of master
(whichever backup host has the lowest configured <tt>advbase</tt> and
<tt>advskew</tt> values).

<p>
It's possible for multiple CARP groups to exist on the same network segment.
CARP advertisements contain the Virtual Host ID which allows group
members to identify which redundancy group the advertisement belongs to.

<p>
In order to prevent a malicious user on the network segment from spoofing
CARP advertisements, each group can be configured with a password.
Each CARP packet sent to the group is then protected by an SHA1 HMAC.

<p>
Since CARP is its own protocol, it should have an explicit pass rule in
filter rulesets:

<blockquote><pre>
pass out on $carp_dev proto carp
</pre></blockquote>

<tt>$carp_dev</tt> should be the physical interface that CARP is
communicating over.

<h2 id="carpconfig">Configuring CARP</h2>

Each redundancy group is represented by a
<a href="http://man.openbsd.org/carp">carp(4)</a> virtual network interface.
As such, CARP is configured using
<a href="http://man.openbsd.org/ifconfig">ifconfig(8)</a>.

<blockquote><pre>
# <b>ifconfig <i>carpN</i> create</b>
# <b>ifconfig <i>carpN</i> vhid <i>vhid</i> [pass <i>password</i>] [carpdev <i>carpdev</i>] \
   [advbase <i>advbase</i>] [advskew <i>advskew</i>] [state <i>state</i>] [group|-group <i>group</i>] \
   <i>ipaddress</i> netmask <i>mask</i></b>
</pre></blockquote>
<!-- XXX someone who understands carpnodes should add a piece -->

<dl>
<dt><tt><i>carpN</i></tt>
<dd>The name of the carp(4) virtual interface where <i>N</i> is an
    integer that represents the interface's number (e.g. carp10).

<dt><tt><i>vhid</i></tt>
<dd>The Virtual Host ID.
    This is a unique number that is used to identify the redundancy group to
    other nodes in the group, and to distinguish between groups on the same
    network.
    Acceptable values are from 1 to 255.
    This must be the same on all members of the group.

<dt><tt><i>password</i></tt>
<dd>The authentication password to use when talking to other CARP-enabled
    hosts in this redundancy group.
    This must be the same on all members of the group.

<dt><tt><i>carpdev</i></tt>
<dd>This optional parameter specifies the physical network interface that
    belongs to this redundancy group.
    By default, CARP will try to determine which interface to use by
    looking for a physical interface that is in the same subnet as the
    <i>ipaddress</i> and <i>mask</i> combination given to the carp(4)
    interface.

<dt><tt><i>advbase</i></tt>
<dd>This optional parameter specifies how often, in seconds, to advertise
    that we're a member of the redundancy group.
    The default is 1 second.
    Acceptable values are from 1 to 255.

<dt><tt><i>advskew</i></tt>
<dd>This optional parameter specifies how much to skew the
    <tt><i>advbase</i></tt> when sending CARP advertisements.
    By manipulating <tt><i>advskew</i></tt>, the master CARP host can be
    chosen.
    The higher the number, the <i>less</i> preferred the host will be when
    choosing a master.
    The default is 0.
    Acceptable values are from 0 to 254.

<dt><tt><i>state</i></tt>
<dd>Force a carp(4) interface into a certain state.
    Valid states are <tt>init</tt>, <tt>backup</tt>, and <tt>master</tt>.

<dt><tt><i>group</i>, <i>-group</i></tt>
<dd>Add or remove a carp(4) interface to a certain interface group.
    By default, all carp(4) interfaces are added to the <tt>carp</tt> group.
    Each group has a <tt>carpdemote</tt> counter affecting all carp(4)
    interfaces belonging to that group.
    As described below, it can be useful to group certain interfaces together
    for failover purposes.

<dt><tt><i>ipaddress</i></tt>
<dd>This is the shared IP address assigned to the redundancy group.
    This address does not have to be in the same subnet as the IP address on
    the physical interface (if present).
    This address needs to be the same on all hosts in the group, however.

<dt><tt><i>mask</i></tt>
<dd>The subnet mask of the shared IP.
</dl>

<p>
Further CARP behavior can be controlled via
<a href="http://man.openbsd.org/sysctl">sysctl(8)</a>.

<dl>
<dt><tt>net.inet.carp.allow</tt>
<dd>Accept incoming CARP packets or not.
    Default is 1 (yes).

<dt><tt>net.inet.carp.preempt</tt>
<dd>Allow hosts within a redundancy group that have a better
    <tt>advbase</tt> and <tt>advskew</tt> to preempt the master.
    In addition, this option also enables failing over a group of interfaces
    together in the event that one interface goes down.
    If one physical CARP-enabled interface goes down, CARP will increase
    the demotion counter, <tt>carpdemote</tt>, by 1 on interface groups that
    the carp(4) interface is a member of, in effect causing all group
    members to fail-over together.
    <tt>net.inet.carp.preempt</tt> is 0 (disabled) by default.

<dt><tt>net.inet.carp.log</tt>
<dd>Log state changes, bad packets and other errors.
    This value may be between 0 and 7, corresponding with syslog(3) priorities.
    The default is 2 (state changes only).
</dl>

<h2 id="carpex">CARP example</h2>

Here is an example CARP configuration:

<blockquote><pre>
# <b>sysctl net.inet.carp.allow=1</b>
# <b>echo 'net.inet.carp.allow=1' >> /etc/sysctl.conf</b>
# <b>ifconfig carp1 create</b>
# <b>ifconfig carp1 vhid 1 pass mekmitasdigoat carpdev em0 advskew 100 10.0.0.1 netmask 255.255.255.0</b>
</pre></blockquote>

This sets up the following:

<ul>
  <li>Enables receipt of CARP packets (this is the default setting).
  <li>Creates a carp(4) interface, <tt>carp1</tt>.
  <li>Configures <tt>carp1</tt> for virtual host #1, enables a password,
      sets <tt>em0</tt> as the interface belonging to the group, and makes
      this host a backup due to the <tt>advskew</tt> of <tt>100</tt>
      (assuming of course that the master is set up with an <tt>advskew</tt>
      less than 100).
      The shared IP assigned to this group is 10.0.0.1/255.255.255.0.
</ul>

Running <tt>ifconfig</tt> on <tt>carp1</tt> shows the status of the interface.

<blockquote><pre>
# <b>ifconfig carp1</b>
carp1: flags=8802&lt;UP,BROADCAST,SIMPLEX,MULTICAST&gt; mtu 1500
     carp: BACKUP carpdev em0 vhid 1 advbase 1 advskew 100
     groups: carp
     inet 10.0.0.1 netmask 0xffffff00 broadcast 10.0.0.255
</pre></blockquote>

<h2 id="pfsyncintro">Introduction to pfsync</h2>

The <a href="http://man.openbsd.org/pfsync">pfsync(4)</a> network interface
exposes certain changes made to the
<a href="http://man.openbsd.org/pf">pf(4)</a> state table.
By monitoring this device using
<a href="http://man.openbsd.org/tcpdump">tcpdump(8)</a>, state table changes
can be observed in real time.
In addition, the pfsync(4) interface can send these state change messages out
on the network so that other nodes running PF can merge the changes into their
own state tables.
Likewise, pfsync(4) can also listen on the network for incoming messages.

<h2 id="pfsyncop">pfsync operation</h2>

By default, pfsync(4) does not send or receive state table updates
on the network; however, updates can still be monitored using tcpdump(8)
or other such tools on the local machine.

<p>
When pfsync(4) is set up to send and receive updates on the network,
the default behavior is to multicast updates out on the local network.
All updates are sent without authentication.
Best common practice is either:

<ol>
  <li>Connect the two nodes that will be exchanging updates back-to-back
      using a crossover cable and use that interface as the
  <tt>syncdev</tt> (see <a href="#pfsyncconfig">below</a>).
  <li>Use the ifconfig(8) <tt>syncpeer</tt> option (see
      <a href="#pfsyncconfig">below</a>) so that updates are unicast directly
      to the peer, then configure
      <a href="http://man.openbsd.org/ipsec">ipsec(4)</a> between the hosts
      to secure the pfsync(4) traffic.
</ol>

When updates are being sent and received on the network, pfsync packets
should be passed in the filter ruleset:

<blockquote><pre>
pass on $sync_if proto pfsync
</pre></blockquote>

<tt>$sync_if</tt> should be the physical interface that pfsync(4) is
communicating over.

<h2 id="pfsyncconfig">Configuring pfsync</h2>

Since pfsync(4) is a virtual network interface, it is configured using
<a href="http://man.openbsd.org/ifconfig">ifconfig(8)</a>.

<blockquote><pre>
# <b>ifconfig <i>pfsyncN</i> syncdev <i>syncdev</i> [syncpeer <i>syncpeer</i>] [defer|-defer]</b>
</pre></blockquote>

<dl>
<dt><tt><i>pfsyncN</i></tt>
<dd>The name of the pfsync(4) interface.
    <tt>pfsync0</tt> exists by default when using the <tt>GENERIC</tt> kernel.

<dt><tt><i>syncdev</i></tt>
<dd>The name of the physical interface used to send pfsync updates out.

<dt><tt><i>syncpeer</i></tt>
<dd>This optional parameter specifies the IP address of a host to exchange
    pfsync updates with.
    By default, pfsync updates are multicast on the local network.
    This option overrides that behavior and instead unicasts the update to
    the specified <tt><i>syncpeer</i></tt>.

<dt><tt><i>defer</i></tt>
<dd>If the <tt>defer</tt> flag is used, the initial packet of a new connection
    passing through the firewall will not be transmitted until either another
    pfsync(4) system has acknowledged the state table addition, or a timeout
    has expired.
    This adds small delays but allows traffic to flow when more than one
    firewall might actively handle packets ("active/active"), e.g. with
    certain ospfd(8), bgpd(8) or carp(4) configurations.
</dl>

<h2 id="pfsyncex">pfsync example</h2>

Here is an example pfsync configuration:

<blockquote><pre>
# <b>ifconfig pfsync0 syncdev em1 up</b>
</pre></blockquote>

This enables pfsync on the <tt>em1</tt> interface.
Outgoing updates will be multicast on the network allowing any other
host running pfsync to receive them.

<h2 id="failover">Combining CARP and pfsync for failover</h2>

By combining the features of CARP and pfsync, a group of two or more
firewalls can be used to create a highly-available, fully redundant
firewall cluster.

<dl>
<dt>CARP:
<dd>Handles the automatic failover of one firewall to another.

<dt>pfsync:
<dd>Synchronizes the state table amongst all the firewalls.
    In the event of a failover, traffic can flow uninterrupted through the
    new master firewall.
</dl>

<p>
An example scenario.
Two firewalls, <tt>fw1</tt> and <tt>fw2</tt>.

<blockquote><pre>
         +----| WAN/Internet |----+
         |                        |
      em2|                        |em2
      +-----+                  +-----+
      | fw1 |-em1----------em1-| fw2 |
      +-----+                  +-----+
      em0|                        |em0
         |                        |
      ---+-------Shared LAN-------+---
</pre></blockquote>

The firewalls are connected back-to-back using a crossover cable on
<tt>em1</tt>.
Both are connected to the LAN on <tt>em0</tt> and to a WAN/Internet
connection on <tt>em2</tt>.
IP addresses are as follows:

<ul>
  <li>fw1 em0: 172.16.0.1
  <li>fw1 em1: 10.10.10.1
  <li>fw1 em2: 192.0.2.1
  <li>fw2 em0: 172.16.0.2
  <li>fw2 em1: 10.10.10.2
  <li>fw2 em2: 192.0.2.2
  <li>LAN shared IP: 172.16.0.100
  <li>WAN/internet shared IP: 192.0.2.100
</ul>

The network policy is that <tt>fw1</tt> will be the preferred master.

<p>
Configure fw1:

<blockquote><pre>
! enable preemption and group interface failover
# <b>sysctl net.inet.carp.preempt=1</b>
# <b>echo 'net.inet.carp.preempt=1' >> /etc/sysctl.conf</b>

! configure pfsync
# <b>ifconfig em1 10.10.10.1 netmask 255.255.255.0</b>
# <b>ifconfig pfsync0 syncdev em1</b>
# <b>ifconfig pfsync0 up</b>

! configure CARP on the LAN side
# <b>ifconfig carp1 create</b>
# <b>ifconfig carp1 vhid 1 carpdev em0 pass lanpasswd \
     172.16.0.100 netmask 255.255.255.0</b>

! configure CARP on the WAN/Internet side
# <b>ifconfig carp2 create</b>
# <b>ifconfig carp2 vhid 2 carpdev em2 pass netpasswd \
     192.0.2.100 netmask 255.255.255.0</b>
</pre></blockquote>

Configure fw2:

<blockquote><pre>
! enable preemption and group interface failover
# <b>sysctl net.inet.carp.preempt=1</b>
# <b>echo 'net.inet.carp.preempt=1' >> /etc/sysctl.conf</b>

! configure pfsync
# <b>ifconfig em1 10.10.10.2 netmask 255.255.255.0</b>
# <b>ifconfig pfsync0 syncdev em1</b>
# <b>ifconfig pfsync0 up</b>

! configure CARP on the LAN side
# <b>ifconfig carp1 create</b>
# <b>ifconfig carp1 vhid 1 carpdev em0 pass lanpasswd \
     advskew 128 172.16.0.100 netmask 255.255.255.0</b>

! configure CARP on the WAN/Internet side
# <b>ifconfig carp2 create</b>
# <b>ifconfig carp2 vhid 2 carpdev em2 pass netpasswd \
     advskew 128 192.0.2.100 netmask 255.255.255.0</b>
</pre></blockquote>

<h2 id="ops">Operational issues</h2>

Some common operational issues encountered with CARP/pfsync.

<h3 id="bootconfig">Configuring CARP and pfsync during boot</h3>

Since carp(4) and pfsync(4) are both types of network interfaces, they
can be configured at boot by creating a
<a href="http://man.openbsd.org/hostname.if">hostname.if(5)</a> file.
The <a href="http://man.openbsd.org/netstart">netstart</a> startup script
will take care of creating the interface and configuring it.

<p>
Examples:

<dl>
<dt>/etc/hostname.carp1</dt>
<dd>
inet 172.16.0.100 255.255.255.0 172.16.0.255 vhid 1 carpdev em0 pass lanpasswd
</dd>
</dl>

<dl>
<dt>/etc/hostname.pfsync0</dt>
<dd>
up syncdev em1
</dd>
</dl>

<h3 id="forcefail">Forcing failover of the master</h3>

There can be times when it's necessary to failover or demote the master
node on purpose.
Examples include taking the master node down for maintenance or when
troubleshooting a problem.
The objective here is to gracefully fail over traffic to one of the
backup hosts so that users do not notice any impact.

<p>
To failover a particular CARP group, shut down the carp(4) interface on the
master node.
This will cause the master to advertise itself with an "infinite"
<tt>advbase</tt> and <tt>advskew</tt>.
The backup host(s) will see this and immediately take over the role of master.

<blockquote><pre>
# <b>ifconfig carp1 down</b>
</pre></blockquote>

An alternative is to increase the <tt>advskew</tt> to a value that's
higher than the <tt>advskew</tt> on the backup host(s).
This will cause a failover but still allow the master to participate in
the CARP group.

<p>
Another method of failover is to tweak the CARP demotion counter.
The demotion counter is a measure of how "ready" a host is to become master
of a CARP group.
For example, while a host is in the middle of booting up it's a bad idea
for it to become the CARP master until all interfaces have been configured,
all network daemons have been started, etc.
Hosts advertising a high demotion value will be less preferred as the master.

<p>
A demotion counter is stored in each interface group that the CARP interface
belongs to.
By default, all CARP interfaces are members of the "carp" interface group.
The current value of a demotion counter can be viewed using ifconfig(8):

<blockquote><pre>
# <b>ifconfig -g carp</b>
carp: carp demote count 0
</pre></blockquote>

In this example, the counter associated with the "carp" interface group is
shown.
When a CARP host advertises itself on the network, it takes the sum of
the demotion counters for each interface group the carp(4) interface
belongs to and advertises that value as its demotion value.

<p>
Now assume the following example.
Two firewalls running CARP with the following CARP interfaces:

<ul>
  <li>carp1 -- Accounting Department
  <li>carp2 -- Regular Employees
  <li>carp3 -- Internet
  <li>carp4 -- DMZ
</ul>

The objective is to failover just the carp1 and carp2 groups to the
secondary firewall.

<p>
First, assign each to a new interface group, in this case named "internal":

<blockquote><pre>
# <b>ifconfig carp1 group internal</b>
# <b>ifconfig carp2 group internal</b>
# <b>ifconfig internal</b>
carp1: flags=8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
     carp: MASTER carpdev em0 vhid 1 advbase 1 advskew 100
     groups: carp internal
     inet 10.0.0.1 netmask 0xffffff00 broadcast 10.0.0.255
carp2: flags=8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
     carp: MASTER carpdev em1 vhid 2 advbase 1 advskew 100
     groups: carp internal
     inet 10.0.1.1 netmask 0xffffff00 broadcast 10.0.1.255
</pre></blockquote>

Now increase the demotion counter for the "internal" group using ifconfig(8):

<blockquote><pre>
# <b>ifconfig -g internal</b>
internal: carp demote count 0
# <b>ifconfig -g internal carpdemote 50</b>
# <b>ifconfig -g internal</b>
internal: carp demote count 50
</pre></blockquote>

The firewall will now gracefully failover on the carp1 and carp2 groups
to the other firewall in the cluster while still remaining the master on
carp3 and carp4.
If the other firewall started advertising itself with a demotion value
higher than 50, or if the other firewall stopped advertising altogether,
then this firewall would again take over mastership on carp1 and carp2.

<p>
To fail back to the primary firewall, reverse the changes:

<blockquote><pre>
# <b>ifconfig -g internal -carpdemote 50</b>
# <b>ifconfig -g internal</b>
internal: carp demote count 0
</pre></blockquote>

Network daemons such as <a href="http://man.openbsd.org/bgpd">OpenBGPD</a>
and <a href="http://man.openbsd.org/sasyncd">sasyncd(8)</a> make use of the
demotion counter to ensure that the firewall does not become master until BGP
sessions become established and IPsec SAs are synchronized.

<h3 id="RulesetTips">Ruleset tips</h3>

<b>Filter the physical interface.</b>
As far as PF is concerned, network traffic comes from the physical
interface, not the CARP virtual interface (i.e., <tt>carp0</tt>).
So, write your rule sets accordingly.
Don't forget that an interface name in a PF rule can be either the name of
a physical interface or an address associated with that interface.
For example, this rule could be correct:

<blockquote><pre>
pass in on fxp0 inet proto tcp from any to carp0 port 22
</pre></blockquote>

But replacing the <tt>fxp0</tt> with <tt>carp0</tt> would not work as
you desire.

<p>
<b>DON'T forget</b> to pass <tt>proto carp</tt> and <tt>proto pfsync</tt>!

<h2 id="ref">Other references</h2>

Please see these other sources for more information:

<ul>
  <li><a href="http://man.openbsd.org/carp"          >carp(4)</a>
  <li><a href="http://man.openbsd.org/pfsync"        >pfsync(4)</a>
  <li><a href="http://man.openbsd.org/ifconfig"      >ifconfig(8)</a>
  <li><a href="http://man.openbsd.org/hostname.if"   >hostname.if(5)</a>
  <li><a href="http://man.openbsd.org/pf.conf"       >pf.conf(5)</a>
  <li><a href="http://man.openbsd.org/ifstated"      >ifstated(8)</a>
  <li><a href="http://man.openbsd.org/ifstated.conf" >ifstated.conf(5)</a>
</ul>

<p>
</body>
</html>
@


1.56
log
@tls on openbsd.org is now real:
- link to https://www.openbsd.org from the sub-projects' pages
- make internal links relative
- switch link rel=canonical to https to please some search engines
"go ahead" from beck, "do it!!!!" tj
@
text
@d125 1
a125 1
pass out on $carp_dev proto carp keep state
@


1.55
log
@sync pf guide formatting with the main faq's style, fixing a few grammar
knits and broken links along the way.

input and ok tb
@
text
@d13 1
a13 1
<link rel="canonical" href="http://www.openbsd.org/faq/pf/carp.html">
@


1.54
log
@page titles and <title> should be the same.
@
text
@d4 5
a10 1
<meta name="description"   content="the OpenBSD FAQ page">
d46 17
a62 17
<li><a href="#carpintro">Introduction to CARP</a>
<li><a href="#carpop">CARP Operation</a>
<li><a href="#carpconfig">Configuring CARP</a>
<li><a href="#carpex">CARP Example</a>
<li><a href="#pfsyncintro">Introduction to pfsync</a>
<li><a href="#pfsyncop">pfsync Operation</a>
<li><a href="#pfsyncconfig">Configuring pfsync</a>
<li><a href="#pfsyncex">pfsync Example</a>
<li><a href="#failover">Combining CARP and pfsync for Failover and
Redundancy</a>
<li><a href="#ops">Operational Issues</a>
	<ul>
	<li><a href="#bootconfig">Configuring CARP and pfsync During Boot</a>
	<li><a href="#forcefail">Forcing Failover of the Master</a>
	<li><a href="#RulesetTips">Ruleset Tips</a>
	</ul>
<li><a href="#ref">Other References</a>
d68 1
d70 3
a72 3
Its primary purpose is to allow multiple hosts on the same network
segment to share an IP address.
CARP is a secure, free alternative to the 
d75 2
a76 2
<a href="http://www.ietf.org/rfc/rfc2281.txt">Hot Standby Router
Protocol</a> (HSRP).
d81 1
a81 1
This group of hosts is referred to as a "redundancy group".
d83 1
a83 1
the group members. 
d85 1
a85 1
"backups".
d101 2
a102 1
<h2 id="carpop">CARP Operation</h2>
d111 1
a111 2
It's possible for multiple CARP groups to exist on the same network
segment.
d116 2
a117 3
In order to prevent a malicious user on the network segment from
spoofing CARP advertisements, each group can be configured with a
password.
d121 1
a121 1
Since CARP is its own protocol it should have an explicit pass rule in
a127 1
<p>
d132 1
d134 3
a136 5
<a href="http://man.openbsd.org/carp.4"
>carp(4)</a> virtual network interface. As such, CARP is configured
using
<a href="http://man.openbsd.org/ifconfig.8"
>ifconfig(8)</a>.
d149 1
a149 1
integer that represents the interface's number (e.g. carp10).
d152 6
a157 5
<dd>The Virtual Host ID. This is a unique number that is used to
identify the redundancy group to other nodes in the group, and to
distinguish between groups on the same network.
Acceptable values are from 1 to 255.
This must be the same on all members of the group.
d160 3
a162 3
<dd>The authentication password to use when talking to other
CARP-enabled hosts in this redundancy group.
This must be the same on all members of the group.
d165 6
a170 6
<dd>This optional parameter specifies the physical network interface
that belongs to this redundancy group.
By default, CARP will try to determine which interface to use by
looking for a physical interface that is in the same subnet as the 
<i>ipaddress</i> and <i>mask</i> combination given to the carp(4)
interface.
d173 4
a176 4
<dd>This optional parameter specifies how often, in seconds, to
advertise that we're a member of the redundancy group.
The default is 1 second.
Acceptable values are from 1 to 255.
d180 7
a186 7
<tt><i>advbase</i></tt> when sending CARP advertisements.
By manipulating <tt><i>advskew</i></tt>, the master CARP host can be
chosen.
The higher the number, the <i>less</i> preferred the host will be when
choosing a master.
The default is 0.
Acceptable values are from 0 to 254.
d189 2
a190 2
<dd>Force a carp(4) interface into a certain state. Valid states are
<tt>init</tt>, <tt>backup</tt>, and <tt>master</tt>.
d194 5
a198 5
By default all carp(4) interfaces are added to the <tt>carp</tt> group.
Each group has a <tt>carpdemote</tt> counter affecting all carp(4)
interfaces belonging to that group.
As described <a href="#demote">below</a>, it can be useful to group
certain interfaces together for failover purposes.
d202 3
a204 3
This address does not have to be in the same subnet as the IP address on
the physical interface (if present).
This address needs to be the same on all hosts in the group, however.
d211 2
a212 3
Further CARP behavior can be controlled via 
<a href="http://man.openbsd.org/sysctl.8"
>sysctl(8)</a>.
d216 2
a217 1
<dd>Accept incoming CARP packets or not. Default is 1 (yes).
d221 8
a228 8
<tt>advbase</tt> and <tt>advskew</tt> to preempt the master.
In addition, this option also enables failing over a group of
interfaces together in the event that one interface goes down.
If one physical CARP-enabled interface goes down, CARP will increase
the demotion counter, <tt>carpdemote</tt>, by 1 on interface groups that
the carp(4) interface is a member of, in effect causing all group
members to fail-over together.
<tt>net.inet.carp.preempt</tt> is 0 (disabled) by default.
d232 2
a233 2
This value may be between 0 and 7, corresponding with syslog(3) priorities.
The default is 2 (state changes only).
d236 2
a237 1
<h2 id="carpex">CARP Example</h2>
a246 1
<p>
d248 1
d250 8
a257 8
<li>Enables receipt of CARP packets (this is the default setting).
<li>Creates a carp(4) interface, <tt>carp1</tt>.
<li>Configures <tt>carp1</tt> for virtual host #1, enables a password,
sets <tt>em0</tt> as the interface belonging to the group, and makes
this host a backup due to the <tt>advskew</tt> of <tt>100</tt> (assuming
of course that the master is set up with an <tt>advskew</tt> less than
100).
The shared IP assigned to this group is 10.0.0.1/255.255.255.0.
d260 1
a260 3
<p>
Running <tt>ifconfig</tt> on <tt>carp1</tt> shows the status of the
interface.
d271 4
a274 5
The
<a href="http://man.openbsd.org/pfsync.4"
>pfsync(4)</a> network interface exposes certain changes made to the
<a href="http://man.openbsd.org/pf.4"
>pf(4)</a> state table.
d276 8
a283 7
<a href="http://man.openbsd.org/tcpdump.8"
>tcpdump(8)</a>, state table changes can be observed in real time.
In addition, the pfsync(4) interface can send these state change
messages out on the network so that other nodes running PF can merge the
changes into their own state tables.
Likewise, pfsync(4) can also listen on the network for incoming
messages.
a284 1
<h2 id="pfsyncop">pfsync Operation</h2>
d290 1
a290 1
When pfsync(4) is set up to send and receive updates on the network, 
d296 8
a303 9
<li>Connect the two nodes that will be exchanging updates back-to-back
using a crossover cable and use that interface as the 
<tt>syncdev</tt> (see <a href="#pfsyncconfig">below</a>).
<li>Use the ifconfig(8) <tt>syncpeer</tt> option (see <a
href="#pfsyncconfig">below</a>) so that updates are unicast directly to
the peer, then configure
<a href="http://man.openbsd.org/ipsec.4"
>ipsec(4)</a>
between the hosts to secure the pfsync(4) traffic.
a305 1
<p>
d309 1
a309 2
<blockquote>
<tt>
d311 1
a311 2
</tt>
</blockquote>
a312 1
<p>
d317 1
d319 1
a319 2
<a href="http://man.openbsd.org/ifconfig.8"
>ifconfig(8)</a>. 
d327 2
a328 2
<dd>The name of the pfsync(4) interface. <tt>pfsync0</tt> exists by
default when using the <tt>GENERIC</tt> kernel.
d334 5
a338 5
<dd>This optional parameter specifies the IP address of a host to
exchange pfsync updates with.
By default pfsync updates are multicast on the local network.
This option overrides that behavior and instead unicasts the update to
the specified <tt><i>syncpeer</i></tt>.
d341 7
a347 7
<dd>If the <tt>defer</tt> flag is used, the initial packet of a new
connection passing through the firewall will not be transmitted
until either another pfsync(4) system has acknowledged the state
table addition, or a timeout has expired.
This adds small delays but allows traffic to flow when more than
one firewall might actively handle packets ("active/active"),
e.g. with certain ospfd(8), bgpd(8) or carp(4) configurations.
d350 2
a351 1
<h2 id="pfsyncex">pfsync Example</h2>
d362 2
a363 1
<h2 id="failover">Combining CARP and pfsync For Failover</h2>
d374 2
a375 2
In the event of a failover, traffic can flow uninterrupted through the
new master firewall.
d382 2
a383 2
<pre>
         +----| WAN/Internet |----+ 
d385 1
a385 1
      em2|                        |em2   
d390 1
a390 1
         |                        | 
d392 1
a392 1
</pre>
a393 1
<p>
d401 8
a408 8
<li>fw1 em0: 172.16.0.1
<li>fw1 em1: 10.10.10.1
<li>fw1 em2: 192.0.2.1
<li>fw2 em0: 172.16.0.2
<li>fw2 em1: 10.10.10.2
<li>fw2 em2: 192.0.2.2
<li>LAN shared IP: 172.16.0.100
<li>WAN/Internet shared IP: 192.0.2.100
a410 1
<p>
d434 1
a434 1
    192.0.2.100 netmask 255.255.255.0</b>
a436 1
<p>
d457 1
a457 1
    advskew 128 192.0.2.100 netmask 255.255.255.0</b>
d460 2
a461 1
<h2 id="ops">Operational Issues</h2>
d464 2
a465 1
<h3 id="bootconfig">Configuring CARP and pfsync During Boot</h3>
d468 3
a470 6
<a href="http://man.openbsd.org/hostname.if.5"
>hostname.if(5)</a> file.
The
<a href="http://man.openbsd.org/netstart.8"
>netstart</a> startup script will take care of creating the interface
and configuring it.
d489 2
a490 1
<h3 id="forcefail">Forcing Failover of the Master</h3>
d499 2
a500 2
To failover a particular CARP group, shut down the carp(4) interface on
the master node.
d503 1
a503 2
The backup host(s) will see this and immediately take over the role of
master.
a508 1
<p>
d513 2
a514 2
 
<p id="demote">
d516 2
a517 2
The demotion counter is a measure of how "ready" a host is to become
master of a CARP group.
d519 3
a521 4
for it to become the CARP master until all interfaces have been
configured, all network daemons have been started, etc.
Hosts advertising a high demotion value will be less preferred as the
master.
d524 4
a527 6
A demotion counter is stored in each interface group that the CARP
interface belongs to.
By default, all CARP interfaces are members of the "carp" interface
group.
The current value of a demotion counter can be viewed using
ifconfig(8):
d534 2
a535 3
<p>
In this example the counter associated with the "carp" interface group
is shown.
d545 4
a548 4
<li>carp1 -- Accounting Department
<li>carp2 -- Regular Employees
<li>carp3 -- Internet
<li>carp4 -- DMZ
a550 1
<p>
d555 1
a555 2
First, assign each to a new interface group, in this case named
"internal":
d571 1
a571 3
<p>
Now increase the demotion counter for the "internal" group using
ifconfig(8):
a580 1
<p>
d597 6
a602 8
<p>
Network daemons such as
<a href="http://man.openbsd.org/bgpd.8"
>OpenBGPD</a> and
<a href="http://man.openbsd.org/sasyncd.8"
>sasyncd(8)</a> make use of the demotion counter to ensure that the
firewall does not become master until BGP sessions become established
and IPsec SAs are synchronized.
a603 1
<h3 id="RulesetTips">Ruleset Tips</h3>
d607 3
a609 4
So, write your rule sets accordingly.     
Don't forget that an interface name in a PF rule can be either the
name of a physical interface or an address associated with that 
interface.   
d616 1
a616 1
but replacing the <tt>fxp0</tt> with <tt>carp0</tt> would not work as
d620 3
a622 2
<b>DON'T forget</b> to pass <tt>proto carp</tt> and <tt>proto
pfsync</tt>!
a623 1
<h2 id="ref">Other References</h2>
d627 7
a633 21
<li>
<a href="http://man.openbsd.org/carp.4"
>carp(4)</a>
<li>
<a href="http://man.openbsd.org/pfsync.4"
>pfsync(4)</a>
<li>
<a href="http://man.openbsd.org/ifconfig.8"
>ifconfig(8)</a>
<li>
<a href="http://man.openbsd.org/hostname.if.5"
>hostname.if(5)</a>
<li>
<a href="http://man.openbsd.org/pf.conf.5"
>pf.conf(5)</a>
<li>
<a href="http://man.openbsd.org/ifstated.8"
>ifstated(8)</a>
<li>
<a href="http://man.openbsd.org/ifstated.conf.5" 
>ifstated.conf(5)</a>
d638 1
a638 1
</html> 
@


1.53
log
@tweak [faq index] button and sync the pf user's guide with that style.
@
text
@d4 1
a4 1
<title>PF - Firewall Redundancy with CARP and pfsync</title>
d34 1
a34 1
<font color="#e00000">PF - Firewall Redundancy with CARP and pfsync</font>
@


1.52
log
@use short form man links in the faq and fix a few broken links
@
text
@a29 2
<!-- Passes validator.w3.org, please keep it this way;
please, use a max of 72 chars per line -->
d35 3
a39 6
<p>
[<a href="index.html">Contents</a>]
[<a href="authpf.html">Previous: Authpf: User Shell for Authenticating
Gateways</a>]
[<a href="example1.html">Next: Building an OpenBSD Router</a>]
<p>
a40 1
<h3>Table of Contents</h3>
a668 7


<p>
[<a href="authpf.html">Previous: Authpf: User Shell for Authenticating
Gateways</a>]
[<a href="index.html">Contents</a>]
[<a href="example1.html">Next: Building an OpenBSD Router</a>]
@


1.51
log
@new openbsd faq style. joint with tj and validator.w3.org
@
text
@d136 1
a136 1
<a href="http://man.openbsd.org/?query=carp&amp;sektion=4"
d139 1
a139 1
<a href="http://man.openbsd.org/?query=ifconfig&amp;sektion=8"
d215 1
a215 1
<a href="http://man.openbsd.org/?query=sysctl&amp;sektion=8"
d276 1
a276 1
<a href="http://man.openbsd.org/?query=pfsync&amp;sektion=4"
d278 1
a278 1
<a href="http://man.openbsd.org/?query=pf&amp;sektion=4"
d281 1
a281 1
<a href="http://man.openbsd.org/?query=tcpdump&amp;sektion=8"
d307 1
a307 1
<a href="http://man.openbsd.org/?query=ipsec&amp;sektion=4"
d328 1
a328 1
<a href="http://man.openbsd.org/?query=ifconfig&amp;sektion=8"
d477 1
a477 1
<a href="http://man.openbsd.org/?query=hostname.if&amp;sektion=5"
d480 1
a480 1
<a href="http://man.openbsd.org/?query=netstart&amp;sektion=8"
d621 1
a621 1
<a href="http://man.openbsd.org/?query=bgpd&amp;sektion=8"
d623 1
a623 1
<a href="http://man.openbsd.org/?query=sasyncd&amp;sektion=8"
d654 1
a654 1
<a href="http://man.openbsd.org/?query=carp&amp;sektion=4"
d657 1
a657 1
<a href="http://man.openbsd.org/?query=pfsync&amp;sektion=4"
d660 1
a660 1
<a href="http://man.openbsd.org/?query=ifconfig&amp;sektion=8"
d663 1
a663 1
<a href="http://man.openbsd.org/?query=hostname.if&amp;sektion=5"
d666 1
a666 1
<a href="http://man.openbsd.org/?query=pf.conf&amp;sektion=5"
d669 1
a669 1
<a href="http://man.openbsd.org/?query=ifstated&amp;sektion=8"
d672 1
a672 1
<a href="http://man.openbsd.org/?query=ifstated.conf&amp;sektion=5" 
@


1.50
log
@add a small sprinkling of css to improve readability in the faq, ok tj@@ tb@@
@
text
@d4 1
a4 1
<title>PF: Firewall Redundancy with CARP and pfsync</title>
d33 1
d35 4
a38 2
<img alt="[OpenBSD]" height=30 width=141 src="../../images/smalltitle.gif" border="0">
</a>
d40 1
a42 1
[<a href="index.html">Contents</a>]
a43 1

a44 3
<h1><font color="#e00000">PF: Firewall Redundancy with CARP and pfsync</font></h1>

<hr>
@


1.49
log
@fix URIs, the / before querystring is not optional,
if not fixed up by browsers the server returns 400 Bad Request.
@
text
@d7 2
@


1.48
log
@change http://www.openbsd.org/cgi-bin/man.cgi to be http://man.openbsd.org
this points stuff to the new place and gets us ready to deprecate the old
place we did this.
@
text
@d135 1
a135 1
<a href="http://man.openbsd.org?query=carp&amp;sektion=4"
d138 1
a138 1
<a href="http://man.openbsd.org?query=ifconfig&amp;sektion=8"
d214 1
a214 1
<a href="http://man.openbsd.org?query=sysctl&amp;sektion=8"
d275 1
a275 1
<a href="http://man.openbsd.org?query=pfsync&amp;sektion=4"
d277 1
a277 1
<a href="http://man.openbsd.org?query=pf&amp;sektion=4"
d280 1
a280 1
<a href="http://man.openbsd.org?query=tcpdump&amp;sektion=8"
d306 1
a306 1
<a href="http://man.openbsd.org?query=ipsec&amp;sektion=4"
d327 1
a327 1
<a href="http://man.openbsd.org?query=ifconfig&amp;sektion=8"
d476 1
a476 1
<a href="http://man.openbsd.org?query=hostname.if&amp;sektion=5"
d479 1
a479 1
<a href="http://man.openbsd.org?query=netstart&amp;sektion=8"
d620 1
a620 1
<a href="http://man.openbsd.org?query=bgpd&amp;sektion=8"
d622 1
a622 1
<a href="http://man.openbsd.org?query=sasyncd&amp;sektion=8"
d653 1
a653 1
<a href="http://man.openbsd.org?query=carp&amp;sektion=4"
d656 1
a656 1
<a href="http://man.openbsd.org?query=pfsync&amp;sektion=4"
d659 1
a659 1
<a href="http://man.openbsd.org?query=ifconfig&amp;sektion=8"
d662 1
a662 1
<a href="http://man.openbsd.org?query=hostname.if&amp;sektion=5"
d665 1
a665 1
<a href="http://man.openbsd.org?query=pf.conf&amp;sektion=5"
d668 1
a668 1
<a href="http://man.openbsd.org?query=ifstated&amp;sektion=8"
d671 1
a671 1
<a href="http://man.openbsd.org?query=ifstated.conf&amp;sektion=5" 
@


1.47
log
@fix sentence fragment; from victor slinv
@
text
@d135 1
a135 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4"
d138 1
a138 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8"
d214 1
a214 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysctl&amp;sektion=8"
d275 1
a275 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4"
d277 1
a277 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4"
d280 1
a280 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tcpdump&amp;sektion=8"
d306 1
a306 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ipsec&amp;sektion=4"
d327 1
a327 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8"
d476 1
a476 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=hostname.if&amp;sektion=5"
d479 1
a479 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=netstart&amp;sektion=8"
d620 1
a620 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bgpd&amp;sektion=8"
d622 1
a622 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sasyncd&amp;sektion=8"
d653 1
a653 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4"
d656 1
a656 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4"
d659 1
a659 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8"
d662 1
a662 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=hostname.if&amp;sektion=5"
d665 1
a665 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5"
d668 1
a668 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifstated&amp;sektion=8"
d671 1
a671 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifstated.conf&amp;sektion=5" 
@


1.46
log
@replace a disorganized assortment of tables and hand-rolled command output
with more standard formatting. while here, run a few less of those commands
as root where it's not needed. the cvs checkout examples were adopted to
use the wsrc group as is done in the ports faq.

input/ok tb
@
text
@d234 1
a234 1
May be between 0 and 7, corresponding with syslog(3) priorities.
@


1.45
log
@Replace decade-old 'firewall for home or small office' page with a new
modern guide written from scratch. From tj@@mrsk.me

with input from sthen@@
@
text
@d125 1
a125 2
<blockquote>
<tt>
d127 1
a127 2
</tt>
</blockquote>
d141 6
a146 11
<blockquote>
<tt>
ifconfig <i>carpN</i> create<br>
<br>
ifconfig <i>carpN</i> vhid <i>vhid</i> [pass <i>password</i>]
[carpdev <i>carpdev</i>] \<br>
&nbsp;&nbsp;&nbsp;[advbase <i>advbase</i>] [advskew <i>advskew</i>]
[state <i>state</i>] [group|-group <i>group</i>] \<br>
&nbsp;&nbsp;&nbsp;<i>ipaddress</i> netmask <i>mask</i>
</tt>
</blockquote>
d241 6
a246 9
<blockquote>
<tt>
# sysctl net.inet.carp.allow=1<br>
# echo 'net.inet.carp.allow=1' >> /etc/sysctl.conf<br>
# ifconfig carp1 create<br>
# ifconfig carp1 vhid 1 pass mekmitasdigoat carpdev em0 \<br>
&nbsp;&nbsp;&nbsp;&nbsp;advskew 100 10.0.0.1 netmask 255.255.255.0<br>
</tt>
</blockquote>
d265 7
a271 11
<blockquote>
<tt>
# ifconfig carp1<br>
carp1: flags=8802&lt;UP,BROADCAST,SIMPLEX,MULTICAST&gt; mtu 1500<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;carp: BACKUP carpdev em0 vhid 1 advbase 1
advskew 100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;groups: carp<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inet 10.0.0.1 netmask 0xffffff00 broadcast
10.0.0.255
</tt>
</blockquote>
d330 3
a332 6
<blockquote>
<tt>
ifconfig <i>pfsyncN</i> syncdev <i>syncdev</i> [syncpeer
<i>syncpeer</i>] [defer|-defer]
</tt>
</blockquote>
d362 3
a364 5
<blockquote>
<tt>
# ifconfig pfsync0 syncdev em1 up<br>
</tt>
</blockquote>
d425 1
a425 3
<table border=0 width="650">
<tr><td nowrap bgcolor="#EEEEEE">
<pre>
d427 2
a428 2
# sysctl net.inet.carp.preempt=1
# echo 'net.inet.carp.preempt=1' >> /etc/sysctl.conf
d431 3
a433 3
# ifconfig em1 10.10.10.1 netmask 255.255.255.0
# ifconfig pfsync0 syncdev em1
# ifconfig pfsync0 up
d436 3
a438 3
# ifconfig carp1 create
# ifconfig carp1 vhid 1 carpdev em0 pass lanpasswd \
     172.16.0.100 netmask 255.255.255.0
d441 4
a444 6
# ifconfig carp2 create
# ifconfig carp2 vhid 2 carpdev em2 pass netpasswd \
    192.0.2.100 netmask 255.255.255.0
</pre>
</td></tr>
</table>
d449 1
a449 3
<table border=0 width="650">
<tr><td nowrap bgcolor="#EEEEEE">
<pre>
d451 2
a452 2
# sysctl net.inet.carp.preempt=1
# echo 'net.inet.carp.preempt=1' >> /etc/sysctl.conf
d455 3
a457 3
# ifconfig em1 10.10.10.2 netmask 255.255.255.0
# ifconfig pfsync0 syncdev em1
# ifconfig pfsync0 up
d460 3
a462 3
# ifconfig carp1 create
# ifconfig carp1 vhid 1 carpdev em0 pass lanpasswd \
     advskew 128 172.16.0.100 netmask 255.255.255.0
d465 4
a468 6
# ifconfig carp2 create
# ifconfig carp2 vhid 2 carpdev em2 pass netpasswd \
    advskew 128 192.0.2.100 netmask 255.255.255.0
</pre>
</td></tr>
</table>
d489 1
a489 2
inet 172.16.0.100 255.255.255.0 172.16.0.255 vhid 1 carpdev em0 \<br>
&nbsp;&nbsp;&nbsp;&nbsp;pass lanpasswd
d516 3
a518 5
<blockquote>
<tt>
# ifconfig carp1 down
</tt>
</blockquote>
d544 2
a545 3
<blockquote>
<tt>
# ifconfig -g carp<br>
d547 1
a547 2
</tt>
</blockquote>
d575 13
a587 19
<blockquote>
<tt>
# ifconfig carp1 group internal<br>
# ifconfig carp2 group internal<br>
# ifconfig internal<br>
carp1: flags=8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;carp: MASTER carpdev em0 vhid 1 advbase 1
advskew 100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;groups: carp internal<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inet 10.0.0.1 netmask 0xffffff00 broadcast
10.0.0.255<br>
carp2: flags=8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;carp: MASTER carpdev em1 vhid 2 advbase 1
advskew 100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;groups: carp internal<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inet 10.0.1.1 netmask 0xffffff00 broadcast
10.0.1.255
</tt>
</blockquote>
d593 7
a599 9
<blockquote>
<tt>
# ifconfig -g internal<br>
internal: carp demote count 0<br>
# ifconfig -g internal carpdemote 50<br>
# ifconfig -g internal<br>
internal: carp demote count 50<br>
</tt>
</blockquote>
d612 5
a616 7
<blockquote>
<tt>
# ifconfig -g internal -carpdemote 50<br>
# ifconfig -g internal<br>
internal: carp demote count 0<br>
</tt>
</blockquote>
d636 2
a637 1
<blockquote><tt>
d639 2
a640 1
</tt></blockquote>
@


1.44
log
@
sysctl no longer has the -w flag, thanks to TJ at mrsk dot me!
@
text
@d38 1
a38 1
[<a href="example1.html">Next: Firewall for Home or Small Office</a>]
d720 1
a720 1
[<a href="example1.html">Next: Firewall for Home or Small Office</a>]
@


1.43
log
@
rev for 5.8, mostly removing manpath part of man page urls
@
text
@d250 2
a251 1
# sysctl -w net.inet.carp.allow=1<br>
d448 2
a449 1
# sysctl -w net.inet.carp.preempt=1
d476 2
a477 1
# sysctl -w net.inet.carp.preempt=1
@


1.42
log
@Clean up meta tags.

name=distribution, name=keywords, and name=resource-type have no effect
in modern search engines and just clutter up the page source.

From Pavel Plamenov.
@
text
@d137 1
a137 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+5.7"
d288 1
a288 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+5.7"
d290 1
a290 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+5.7"
d690 1
a690 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+5.7"
d693 1
a693 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+5.7"
d702 1
a702 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+5.7"
@


1.41
log
@Add 'link rel="canonical"' to pages, acting as a hint to search engines
to list the copies on www.openbsd.org rather than mirrors.

From Carlin Bingham, ok millert@@ nick@@
@
text
@a5 1
<meta name="resource-type" content="document">
a6 2
<meta name="keywords"      content="openbsd,faq,pf,carp,pfsync">
<meta name="distribution"  content="global">
@


1.40
log
@
updates for 5.7
@
text
@d10 1
@


1.39
log
@
5.5->5.6 which I forgot and Jonathan Thornburg (jthorn at astro dot
indiana dot edu) reminded me of, but also sent a diff for, thanks!
@
text
@d139 1
a139 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+5.6"
d290 1
a290 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+5.6"
d292 1
a292 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+5.6"
d692 1
a692 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+5.6"
d695 1
a695 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+5.6"
d704 1
a704 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+5.6"
@


1.38
log
@Convert the pf faq to use id="" instead of "a name=""></a>.
@
text
@d139 1
a139 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+5.5"
d290 1
a290 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+5.5"
d292 1
a292 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+5.5"
d692 1
a692 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+5.5"
d695 1
a695 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+5.5"
d704 1
a704 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+5.5"
@


1.37
log
@
update for 5.5
@
text
@d70 1
a70 2
<a name="carpintro"></a>
<h2>Introduction to CARP</h2>
d103 1
a103 3

<a name="carpop"></a>
<h2>CARP Operation</h2>
d137 1
a137 3

<a name="carpconfig"></a>
<h2>Configuring CARP</h2>
d247 1
a247 3

<a name="carpex"></a>
<h2>CARP Example</h2>
d288 1
a288 3

<a name="pfsyncintro"></a>
<h2>Introduction to pfsync</h2>
d303 1
a303 3

<a name="pfsyncop"></a>
<h2>pfsync Operation</h2>
d340 1
a340 3

<a name="pfsyncconfig"></a>
<h2>Configuring pfsync</h2>
d377 1
a377 3

<a name="pfsyncex"></a>
<h2>pfsync Example</h2>
d390 1
a390 3

<a name="failover"></a>
<h2>Combining CARP and pfsync For Failover</h2>
d496 1
a496 3

<a name="ops"></a>
<h2>Operational Issues</h2>
d499 1
a499 2
<a name="bootconfig"></a>
<h3>Configuring CARP and pfsync During Boot</h3>
d527 1
a527 2
<a name="forcefail"></a>
<h3>Forcing Failover of the Master</h3>
d555 1
a555 2
<a name="demote"></a>
<p>
d668 1
a668 2
<a name="RulesetTips"></a> 
<h3>Ruleset Tips</h3>
d687 1
a687 4
<p>

<a name="ref"></a>
<h2>Other References</h2>
@


1.36
log
@
www@@ removal, normalize footers.
@
text
@d144 1
a144 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+5.4"
d299 1
a299 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+5.4"
d301 1
a301 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+5.4"
d718 1
a718 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+5.4"
d721 1
a721 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+5.4"
d730 1
a730 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+5.4"
@


1.35
log
@
update for 5.4
@
text
@a4 1
<link rev="made" href="mailto:www@@openbsd.org">
a747 6
<hr>
<a href="index.html"><img height="24" width="24" src="../../images/back.gif" border="0" alt="[back]"></a> 
<a href="mailto:www@@openbsd.org">www@@openbsd.org</a>
<br>
<small>$OpenBSD: carp.html,v 1.34 2013/05/01 13:21:45 nick Exp $</small>

@


1.34
log
@
updates for 5.3
@
text
@d145 1
a145 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+5.3"
d300 1
a300 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+5.3"
d302 1
a302 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+5.3"
d719 1
a719 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+5.3"
d722 1
a722 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+5.3"
d731 1
a731 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+5.3"
d753 1
a753 1
<small>$OpenBSD: carp.html,v 1.33 2012/12/19 12:03:19 nick Exp $</small>
@


1.33
log
@
make things a little more clear, perhaps.  ok sthen@@
@
text
@d145 1
a145 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+5.2"
d300 1
a300 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+5.2"
d302 1
a302 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+5.2"
d719 1
a719 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+5.2"
d722 1
a722 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+5.2"
d731 1
a731 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+5.2"
d753 1
a753 1
<small>$OpenBSD: carp.html,v 1.32 2012/11/01 15:06:36 nick Exp $</small>
@


1.32
log
@
enter 5.2
@
text
@d171 2
a172 1
identify the redundancy group to other nodes on the network.
d174 1
d753 1
a753 1
<small>$OpenBSD: carp.html,v 1.31 2012/05/11 11:20:04 nick Exp $</small>
@


1.31
log
@
forgot to actually COMMIT these 5.1 changes.  *sigh*
@
text
@d145 1
a145 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+5.1"
d298 1
a298 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+5.1"
d300 1
a300 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+5.1"
d717 1
a717 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+5.1"
d720 1
a720 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+5.1"
d729 1
a729 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+5.1"
d751 1
a751 1
<small>$OpenBSD: carp.html,v 1.30 2012/02/04 22:20:43 dtucker Exp $</small>
@


1.30
log
@bring up the pfsync0 interface in the example in case it's not up; ok nick
@
text
@d145 1
a145 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+5.0"
d298 1
a298 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+5.0"
d300 1
a300 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+5.0"
d717 1
a717 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+5.0"
d720 1
a720 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+5.0"
d729 1
a729 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+5.0"
d751 1
a751 1
<small>$OpenBSD: carp.html,v 1.29 2011/11/02 01:01:47 nick Exp $</small>
@


1.29
log
@
rev man page references to 5.0
@
text
@d396 1
a396 1
# ifconfig pfsync0 syncdev em1<br>
d751 1
a751 1
<small>$OpenBSD: carp.html,v 1.28 2011/05/01 12:57:11 nick Exp $</small>
@


1.28
log
@
updates for 4.9
@
text
@d145 1
a145 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.9"
d298 1
a298 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+4.9"
d300 1
a300 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+4.9"
d717 1
a717 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.9"
d720 1
a720 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+4.9"
d729 1
a729 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+4.9"
d751 1
a751 1
<small>$OpenBSD: carp.html,v 1.27 2010/11/01 09:53:51 nick Exp $</small>
@


1.27
log
@
update to 4.8
@
text
@d145 1
a145 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.8"
d298 1
a298 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+4.8"
d300 1
a300 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+4.8"
d717 1
a717 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.8"
d720 1
a720 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+4.8"
d729 1
a729 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+4.8"
d751 1
a751 1
<small>$OpenBSD: carp.html,v 1.26 2010/05/19 13:25:16 sthen Exp $</small>
@


1.26
log
@Update the PF faq for 4.7 changes.
@
text
@d145 1
a145 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.7"
d298 1
a298 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+4.7"
d300 1
a300 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+4.7"
d717 1
a717 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.7"
d720 1
a720 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+4.7"
d729 1
a729 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+4.7"
d751 1
a751 1
<small>$OpenBSD: carp.html,v 1.25 2010/02/01 14:48:11 jsg Exp $</small>
@


1.25
log
@Remove reference to net.inet.carp.arpbalance which got removed
with 4.3, some discussion of carpnodes and balancing options still
needs to be added here however.
@
text
@d145 1
a145 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.6"
d158 2
a159 2
[state <i>state</i>] <i>ipaddress</i> \<br>
&nbsp;&nbsp;&nbsp;netmask <i>mask</i>
d162 1
d207 8
d235 9
a243 8
<dd>Allow hosts within a redundancy group that have a better <tt>advbase</tt>
and <tt>advskew</tt> to preempt the master.
In addition, this option also enables failing over all interfaces in the
event that one interface goes down.
If one physical CARP-enabled interface goes down, CARP will change
<tt>advskew</tt> to 240 on all other CARP-enabled interfaces, in
essence, failing itself over.
This option is 0 (disabled) by default.
d246 3
a248 1
<dd>Log bad CARP packets. Default is 0 (disabled).
d298 1
a298 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+4.6"
d300 1
a300 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+4.6"
d360 1
a360 1
<i>syncpeer</i>]
d378 9
d574 2
a575 1

d717 1
a717 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.6"
d720 1
a720 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+4.6"
d729 1
a729 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+4.6"
d751 1
a751 1
<small>$OpenBSD: carp.html,v 1.24 2009/10/16 19:12:42 nick Exp $</small>
@


1.24
log
@
quick update for 4.6.  much more is needed, at least scrub.html is
currently dead wrong, so I've unlinked it from the rest for now.
@
text
@a236 7

<dt><tt>net.inet.carp.arpbalance</tt>
<dd>Load balance traffic across multiple redundancy group hosts.
Default is 0 (disabled).
See
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.6"
>carp(4)</a> for more information.
d729 1
a729 1
<small>$OpenBSD: carp.html,v 1.23 2009/04/30 17:27:31 nick Exp $</small>
@


1.23
log
@
updates for 4.5
@
text
@d145 1
a145 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.5"
d242 1
a242 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.5"
d293 1
a293 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+4.5"
d295 1
a295 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+4.5"
d702 1
a702 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.5"
d705 1
a705 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+4.5"
d714 1
a714 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+4.5"
d736 1
a736 1
<small>$OpenBSD: carp.html,v 1.22 2008/11/12 02:53:32 nick Exp $</small>
@


1.22
log
@
HTML fix from Alan R. S. Bueno (alan dot bsd at gmail dot com)
@
text
@d145 1
a145 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.4"
d242 1
a242 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.4"
d293 1
a293 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+4.4"
d295 1
a295 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+4.4"
d702 1
a702 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.4"
d705 1
a705 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+4.4"
d714 1
a714 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+4.4"
d736 1
a736 1
<small>$OpenBSD: carp.html,v 1.21 2008/10/31 16:49:34 nick Exp $</small>
@


1.21
log
@
update numbers for 4.4
@
text
@d523 3
a525 1
<br>
d736 1
a736 1
<small>$OpenBSD: carp.html,v 1.20 2008/07/27 17:13:47 nick Exp $</small>
@


1.20
log
@
PF updates for 4.3..which got missed a few times.
@
text
@d145 1
a145 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.3"
d242 1
a242 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.3"
d293 1
a293 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+4.3"
d295 1
a295 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+4.3"
d700 1
a700 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.3"
d703 1
a703 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+4.3"
d712 1
a712 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+4.3"
d734 1
a734 1
<small>$OpenBSD: carp.html,v 1.19 2007/11/01 02:57:56 joel Exp $</small>
@


1.19
log
@Updates for OpenBSD 4.2
@
text
@d145 1
a145 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.2"
d242 1
a242 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.2"
d293 1
a293 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+4.2"
d295 1
a295 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+4.2"
d700 1
a700 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.2"
d703 1
a703 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+4.2"
d712 1
a712 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+4.2"
d734 1
a734 1
<small>$OpenBSD: carp.html,v 1.18 2007/05/07 01:27:19 joel Exp $</small>
@


1.18
log
@Follow Nick's lead and remove a few more manpath options from manpage
URLs.
@
text
@d145 1
a145 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.1"
d242 1
a242 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.1"
d293 1
a293 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+4.1"
d295 1
a295 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+4.1"
d700 1
a700 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.1"
d703 1
a703 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+4.1"
d712 1
a712 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+4.1"
d734 1
a734 1
<small>$OpenBSD: carp.html,v 1.17 2007/05/06 18:59:54 nick Exp $</small>
@


1.17
log
@
manpath changes to:
  4.1 for PF related items
  removed for non-PF-related items, which will probably either not
    change much, or benefit from the newest, best man pages.
@
text
@d326 1
a326 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ipsec&amp;sektion=4&amp;manpath=OpenBSD+4.1"
d510 1
a510 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=netstart&amp;sektion=8&amp;manpath=OpenBSD+4.1"
d665 1
a665 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bgpd&amp;sektion=8&amp;manpath=OpenBSD+4.1"
d667 1
a667 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sasyncd&amp;sektion=8&amp;manpath=OpenBSD+4.1"
d706 1
a706 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8&amp;manpath=OpenBSD+4.1"
d715 1
a715 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifstated&amp;sektion=8&amp;manpath=OpenBSD+4.1"
d718 1
a718 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifstated.conf&amp;sektion=5&amp;manpath=OpenBSD+4.1" 
d734 1
a734 1
<small>$OpenBSD: carp.html,v 1.16 2007/02/12 20:19:17 joel Exp $</small>
@


1.16
log
@Make some corrections on how to do a controlled failover.
Suggestion by Mike Erdely.
@
text
@d145 1
a145 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.0"
d148 1
a148 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8&amp;manpath=OpenBSD+4.0"
d218 1
a218 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysctl&amp;sektion=8&amp;manpath=OpenBSD+4.0"
d242 1
a242 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.0"
d293 1
a293 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+4.0"
d295 1
a295 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+4.0"
d298 1
a298 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tcpdump&amp;sektion=8&amp;manpath=OpenBSD+4.0"
d326 1
a326 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ipsec&amp;sektion=4&amp;manpath=OpenBSD+4.0"
d349 1
a349 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8&amp;manpath=OpenBSD+4.0"
d507 1
a507 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=hostname.if&amp;sektion=5&amp;manpath=OpenBSD+4.0"
d510 1
a510 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=netstart&amp;sektion=8&amp;manpath=OpenBSD+4.0"
d665 1
a665 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bgpd&amp;sektion=8&amp;manpath=OpenBSD+4.0"
d667 1
a667 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sasyncd&amp;sektion=8&amp;manpath=OpenBSD+4.0"
d700 1
a700 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.0"
d703 1
a703 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+4.0"
d706 1
a706 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8&amp;manpath=OpenBSD+4.0"
d709 1
a709 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=hostname.if&amp;sektion=5&amp;manpath=OpenBSD+4.0"
d712 1
a712 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+4.0"
d715 1
a715 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifstated&amp;sektion=8&amp;manpath=OpenBSD+4.0"
d718 1
a718 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifstated.conf&amp;sektion=5&amp;manpath=OpenBSD+4.0" 
d734 1
a734 1
<small>$OpenBSD: carp.html,v 1.15 2007/01/23 07:30:16 joel Exp $</small>
@


1.15
log
@Typo, pointed out by nick@@
@
text
@d540 2
a541 1
To failover, shut down the carp(4) interface on the master node.
d554 4
a557 2
If preempt is enabled, this also causes <b>all</b> other CARP groups to
failover as well.
d734 1
a734 1
<small>$OpenBSD: carp.html,v 1.14 2007/01/21 15:41:15 steven Exp $</small>
@


1.14
log
@advbase -> advskew, noticed by r.garcia at ovea.com
@
text
@d14 1
a14 1
Copyright (c) 2005 Joel Knight <enabled@@myrealbox.com>
d200 1
a200 1
Acceptable values are from 1 to 254.
d731 1
a731 1
<small>$OpenBSD: carp.html,v 1.13 2006/11/01 01:56:01 joel Exp $</small>
@


1.13
log
@Updates for OpenBSD 4.0. uRPF, tftp-proxy, more ftp-proxy, etc.
Thanks to mcbride for the bits about interface groups
@
text
@d195 1
a195 1
By manipulating <tt><i>advbase</i></tt>, the master CARP host can be
d731 1
a731 1
<small>$OpenBSD: carp.html,v 1.12 2006/10/27 19:26:13 nick Exp $</small>
@


1.12
log
@
"tweaks and fixes" from Jeremy Reed, via Joel@@.  Committed at request
of joel@@
@
text
@d145 1
a145 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+3.9"
d148 1
a148 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8&amp;manpath=OpenBSD+3.9"
d218 1
a218 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysctl&amp;sektion=8&amp;manpath=OpenBSD+3.9"
d242 1
a242 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+3.9"
d283 1
d293 1
a293 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+3.9"
d295 1
a295 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+3.9"
d298 1
a298 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tcpdump&amp;sektion=8&amp;manpath=OpenBSD+3.9"
d326 1
a326 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ipsec&amp;sektion=4&amp;manpath=OpenBSD+3.9"
d349 1
a349 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8&amp;manpath=OpenBSD+3.9"
d507 1
a507 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=hostname.if&amp;sektion=5&amp;manpath=OpenBSD+3.9"
d510 1
a510 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=netstart&amp;sektion=8&amp;manpath=OpenBSD+3.9"
d552 117
d697 1
a697 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+3.9"
d700 1
a700 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+3.9"
d703 1
a703 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8&amp;manpath=OpenBSD+3.9"
d706 1
a706 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=hostname.if&amp;sektion=5&amp;manpath=OpenBSD+3.9"
d709 1
a709 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+3.9"
d712 1
a712 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifstated&amp;sektion=8&amp;manpath=OpenBSD+3.9"
d715 1
a715 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifstated.conf&amp;sektion=5&amp;manpath=OpenBSD+3.9" 
d731 1
a731 1
<small>$OpenBSD: carp.html,v 1.11 2006/10/25 15:33:53 steven Exp $</small>
@


1.11
log
@fix ifconfig syntax for carp, adding the 'netmask' keyword.
noticed by me at falz.net
@
text
@d78 1
a78 1
Protocol</a> and the
d80 1
a80 1
Protocol</a>.
d249 1
a249 1
An example CARP configuration.
d322 1
a322 1
<li>Use the <tt>syncpeer</tt> ifconfig(8) option (see <a
d377 1
a377 1
An example pfsync configuration.
d613 1
a613 1
<small>$OpenBSD: carp.html,v 1.10 2006/05/01 00:54:29 nick Exp $</small>
@


1.10
log
@
3.9 updates, mostly rev'ing man page links
@
text
@d158 2
a159 2
[state <i>state</i>] <i>ipaddress</i>
<i>mask</i>
d256 1
a256 1
&nbsp;&nbsp;&nbsp;&nbsp;advskew 100 10.0.0.1 255.255.255.0<br>
d460 1
a460 1
     172.16.0.100 255.255.255.0
d465 1
a465 1
    192.0.2.100 255.255.255.0
d487 1
a487 1
     advskew 128 172.16.0.100 255.255.255.0
d492 1
a492 1
    advskew 128 192.0.2.100 255.255.255.0
d613 1
a613 1
<small>$OpenBSD: carp.html,v 1.9 2005/11/11 02:22:50 nick Exp $</small>
@


1.9
log
@
add man page links to ifstated(8) and ifstated.conf(5).  More needs to
be written here on that, I think.
@
text
@d145 1
a145 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+3.8"
d148 1
a148 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8&amp;manpath=OpenBSD+3.8"
d218 1
a218 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysctl&amp;sektion=8&amp;manpath=OpenBSD+3.8"
d242 1
a242 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+3.8"
d292 1
a292 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+3.8"
d294 1
a294 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+3.8"
d297 1
a297 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tcpdump&amp;sektion=8&amp;manpath=OpenBSD+3.8"
d325 1
a325 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ipsec&amp;sektion=4&amp;manpath=OpenBSD+3.8"
d348 1
a348 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8&amp;manpath=OpenBSD+3.8"
d506 1
a506 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=hostname.if&amp;sektion=5&amp;manpath=OpenBSD+3.8"
d509 1
a509 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=netstart&amp;sektion=8&amp;manpath=OpenBSD+3.8"
d579 1
a579 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+3.8"
d582 1
a582 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+3.8"
d585 1
a585 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8&amp;manpath=OpenBSD+3.8"
d588 1
a588 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=hostname.if&amp;sektion=5&amp;manpath=OpenBSD+3.8"
d591 1
a591 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+3.8"
d594 1
a594 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifstated&amp;sektion=8&amp;manpath=OpenBSD+3.8"
d597 1
a597 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifstated.conf&amp;sektion=5&amp;manpath=OpenBSD+3.8" 
d613 1
a613 1
<small>$OpenBSD: carp.html,v 1.8 2005/11/11 02:01:13 nick Exp $</small>
@


1.8
log
@
I've been Learning by Doing (incorrectly): Filter the real interface,
and another reminder to pass proto carp and proto pfsync.  ok Joel@@
@
text
@d593 6
d613 1
a613 1
<small>$OpenBSD: carp.html,v 1.7 2005/11/01 11:35:18 nick Exp $</small>
@


1.7
log
@
bump manpath= tag for 3.8
@
text
@d64 1
d551 21
d607 1
a607 1
<small>$OpenBSD: carp.html,v 1.6 2005/09/24 21:00:58 msf Exp $</small>
@


1.6
log
@- the keyword for carp passwords is pass not password

ok nick@@
@
text
@d144 1
a144 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+3.7"
d147 1
a147 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8&amp;manpath=OpenBSD+3.7"
d217 1
a217 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysctl&amp;sektion=8&amp;manpath=OpenBSD+3.7"
d241 1
a241 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+3.7"
d291 1
a291 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+3.7"
d293 1
a293 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+3.7"
d296 1
a296 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tcpdump&amp;sektion=8&amp;manpath=OpenBSD+3.7"
d324 1
a324 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ipsec&amp;sektion=4&amp;manpath=OpenBSD+3.7"
d347 1
a347 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8&amp;manpath=OpenBSD+3.7"
d505 1
a505 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=hostname.if&amp;sektion=5&amp;manpath=OpenBSD+3.7"
d508 1
a508 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=netstart&amp;sektion=8&amp;manpath=OpenBSD+3.7"
d557 1
a557 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+3.7"
d560 1
a560 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+3.7"
d563 1
a563 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8&amp;manpath=OpenBSD+3.7"
d566 1
a566 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=hostname.if&amp;sektion=5&amp;manpath=OpenBSD+3.7"
d569 1
a569 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+3.7"
d585 1
a585 1
<small>$OpenBSD: carp.html,v 1.5 2005/05/22 17:15:00 saad Exp $</small>
@


1.5
log
@wrong links and consistency fixes
@
text
@d458 1
a458 1
# ifconfig carp1 vhid 1 carpdev em0 password lanpasswd \
d463 1
a463 1
# ifconfig carp2 vhid 2 carpdev em2 password netpasswd \
d485 1
a485 1
# ifconfig carp1 vhid 1 carpdev em0 password lanpasswd \
d490 1
a490 1
# ifconfig carp2 vhid 2 carpdev em2 password netpasswd \
d519 1
a519 1
&nbsp;&nbsp;&nbsp;&nbsp;password lanpasswd
d585 1
a585 1
<small>$OpenBSD: carp.html,v 1.4 2005/05/22 16:41:27 saad Exp $</small>
@


1.4
log
@consistency fix
@
text
@d63 1
a63 1
	<li><a href="forcefail">Forcing Failover of the Master</a>
d78 1
a78 1
<a href="http://www.ietf.org/rfc/rfc2281.html">Hot Standby Router
d461 1
a461 1
! configure CARP on the Internet side
d488 1
a488 1
! configure CARP on the Internet side
d585 1
a585 1
<small>$OpenBSD: carp.html,v 1.3 2005/05/22 16:25:36 saad Exp $</small>
@


1.3
log
@better wording
@
text
@d436 1
a436 1
<li>Internet shared IP: 192.0.2.100
d585 1
a585 1
<small>$OpenBSD: carp.html,v 1.2 2005/05/22 08:21:36 saad Exp $</small>
@


1.2
log
@minor typminor typo
@
text
@d320 4
a323 3
<tt>syncdev</tt>.
<li>Use the <tt>syncpeer</tt> ifconfig(8) option (see below) so
that updates are unicast directly to the peer, then configure 
d363 1
a363 1
<dd>The name of the physical interface to send pfsync updates out.
d585 1
a585 1
<small>$OpenBSD: carp.html,v 1.1 2005/05/21 05:51:24 joel Exp $</small>
@


1.1
log
@New addition: Firewall Redundancy with CARP and pfsync

Thanks to jmc@@ and nick@@ for their feedback
@
text
@d248 1
a248 1
An exmple CARP configuration.
d584 1
a584 1
<small>$OpenBSD$</small>
@

