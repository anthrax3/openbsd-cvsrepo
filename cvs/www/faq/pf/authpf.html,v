head	1.54;
access;
symbols;
locks; strict;
comment	@# @;


1.54
date	2016.09.19.23.44.47;	author tj;	state Exp;
branches;
next	1.53;
commitid	P53AgOpLKrOmgs5r;

1.53
date	2016.08.15.02.22.14;	author tb;	state Exp;
branches;
next	1.52;
commitid	3DeixV5YkPOb78RN;

1.52
date	2016.06.13.17.58.24;	author tj;	state Exp;
branches;
next	1.51;
commitid	Grx2UyJPWzJbbhkP;

1.51
date	2016.04.18.19.07.50;	author tj;	state Exp;
branches;
next	1.50;
commitid	g0cUF3jNn5Tz4oaZ;

1.50
date	2016.04.16.00.30.41;	author tj;	state Exp;
branches;
next	1.49;
commitid	rTxoenHHaeutOff1;

1.49
date	2016.04.15.20.39.49;	author tb;	state Exp;
branches;
next	1.48;
commitid	jwteSMEb4rFzI8UA;

1.48
date	2016.03.29.01.27.39;	author tb;	state Exp;
branches;
next	1.47;
commitid	4Y8oU6GBrSY1UOfW;

1.47
date	2016.03.27.19.52.09;	author sthen;	state Exp;
branches;
next	1.46;
commitid	hi2ObFv9LGB98JY5;

1.46
date	2016.03.22.10.56.56;	author sthen;	state Exp;
branches;
next	1.45;
commitid	G2izHhNJ7aqR0Y6j;

1.45
date	2016.03.21.05.46.21;	author beck;	state Exp;
branches;
next	1.44;
commitid	zEx6zFkNSFFExu0v;

1.44
date	2016.01.24.21.40.35;	author tj;	state Exp;
branches;
next	1.43;
commitid	bFaFSpgHCeTHjIC5;

1.43
date	2015.10.18.19.48.19;	author nick;	state Exp;
branches;
next	1.42;
commitid	gkrFWKimwWNVivXe;

1.42
date	2015.07.02.05.49.05;	author bentley;	state Exp;
branches;
next	1.41;
commitid	AP3UllesavMDEUhQ;

1.41
date	2015.05.11.11.18.30;	author sthen;	state Exp;
branches;
next	1.40;
commitid	wRrXxcro6dFYiwF8;

1.40
date	2015.04.30.23.48.01;	author nick;	state Exp;
branches;
next	1.39;
commitid	uFWv68UTtTmjkqVF;

1.39
date	2014.12.02.03.17.26;	author nick;	state Exp;
branches;
next	1.38;
commitid	RQ0cKiFD5x45dGyo;

1.38
date	2014.12.01.10.01.07;	author bentley;	state Exp;
branches;
next	1.37;
commitid	DtrOVs7q8kqgEsjm;

1.37
date	2014.07.30.21.57.19;	author sthen;	state Exp;
branches;
next	1.36;
commitid	632wqensvvuAHAOA;

1.36
date	2014.05.01.15.03.50;	author nick;	state Exp;
branches;
next	1.35;

1.35
date	2014.03.31.02.33.07;	author nick;	state Exp;
branches;
next	1.34;

1.34
date	2013.11.01.14.07.05;	author nick;	state Exp;
branches;
next	1.33;

1.33
date	2013.05.01.13.21.45;	author nick;	state Exp;
branches;
next	1.32;

1.32
date	2012.11.01.15.06.36;	author nick;	state Exp;
branches;
next	1.31;

1.31
date	2012.05.11.11.20.04;	author nick;	state Exp;
branches;
next	1.30;

1.30
date	2011.11.02.01.01.47;	author nick;	state Exp;
branches;
next	1.29;

1.29
date	2011.05.01.12.57.11;	author nick;	state Exp;
branches;
next	1.28;

1.28
date	2010.11.01.09.53.51;	author nick;	state Exp;
branches;
next	1.27;

1.27
date	2010.05.19.13.25.16;	author sthen;	state Exp;
branches;
next	1.26;

1.26
date	2009.10.16.19.12.42;	author nick;	state Exp;
branches;
next	1.25;

1.25
date	2009.04.30.17.27.31;	author nick;	state Exp;
branches;
next	1.24;

1.24
date	2008.10.31.16.49.34;	author nick;	state Exp;
branches;
next	1.23;

1.23
date	2008.07.27.17.13.47;	author nick;	state Exp;
branches;
next	1.22;

1.22
date	2007.11.01.02.57.56;	author joel;	state Exp;
branches;
next	1.21;

1.21
date	2007.05.07.01.13.53;	author joel;	state Exp;
branches;
next	1.20;

1.20
date	2007.05.06.18.59.54;	author nick;	state Exp;
branches;
next	1.19;

1.19
date	2006.11.01.01.56.01;	author joel;	state Exp;
branches;
next	1.18;

1.18
date	2006.05.01.00.54.29;	author nick;	state Exp;
branches;
next	1.17;

1.17
date	2005.11.01.11.35.18;	author nick;	state Exp;
branches;
next	1.16;

1.16
date	2005.05.21.05.55.43;	author joel;	state Exp;
branches;
next	1.15;

1.15
date	2005.05.20.00.12.02;	author joel;	state Exp;
branches;
next	1.14;

1.14
date	2005.02.11.06.57.07;	author joel;	state Exp;
branches;
next	1.13;

1.13
date	2005.02.11.06.44.04;	author joel;	state Exp;
branches;
next	1.12;

1.12
date	2005.02.11.05.30.50;	author joel;	state Exp;
branches;
next	1.11;

1.11
date	2005.02.07.05.51.38;	author joel;	state Exp;
branches;
next	1.10;

1.10
date	2004.12.22.04.28.16;	author david;	state Exp;
branches;
next	1.9;

1.9
date	2004.11.11.09.50.15;	author saad;	state Exp;
branches;
next	1.8;

1.8
date	2004.10.29.17.22.57;	author nick;	state Exp;
branches;
next	1.7;

1.7
date	2004.05.07.01.55.23;	author nick;	state Exp;
branches;
next	1.6;

1.6
date	2004.04.30.18.00.25;	author nick;	state Exp;
branches;
next	1.5;

1.5
date	2004.01.01.04.16.17;	author nick;	state Exp;
branches;
next	1.4;

1.4
date	2003.11.09.23.29.02;	author nick;	state Exp;
branches;
next	1.3;

1.3
date	2003.09.22.02.29.03;	author nick;	state Exp;
branches;
next	1.2;

1.2
date	2003.09.16.01.23.49;	author nick;	state Exp;
branches;
next	1.1;

1.1
date	2003.06.29.20.20.11;	author nick;	state Exp;
branches;
next	;


desc
@@


1.54
log
@less "$ext_if" and more egress to simplify example rulesets.
zap some stray <p> tags while here.
@
text
@<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>

<!-- If you make edits to any FAQ documents, please start each sentence
     on a new line, and try to keep the general formatting consistent
     with the rest of the pages -->

<title>OpenBSD PF: User Shell for Authenticating Gateways (authpf)</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="../../openbsd.css">
<link rel="canonical" href="https://www.openbsd.org/faq/pf/authpf.html">
</head>

<!--
Copyright (c) 2003-2007 Joel Knight <enabled@@myrealbox.com>

Permission to use, copy, modify, and distribute this documentation for
any purpose with or without fee is hereby granted, provided that the
above copyright notice and this permission notice appear in all copies.

THE DOCUMENTATION IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL
WARRANTIES WITH REGARD TO THIS DOCUMENTATION INCLUDING ALL IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE
AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL
DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR
PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS DOCUMENTATION
-->

<body bgcolor="#ffffff" text="#000000">

<h2>
<a href="../../index.html">
<font color="#0000ff"><i>Open</i></font><font color="#000084">BSD</font></a>
<font color="#e00000">PF - User Shell for Authenticating Gateways
                      (authpf)</font>
<small>
<a href="index.html" style="font-weight:normal; float:right">[Contents]</a>
</small>
</h2>
<hr>

<ul>
  <li><a href="#intro"            >Introduction</a>
  <li><a href="#config"           >Configuration</a>
        <ul>
        <li><a href="#enable"     >Enabling authpf</a>
        <li><a href="#linkmain"   >Linking authpf into the main ruleset</a>
        <li><a href="#loadrules"  >Configuring loaded rules</a>
        <li><a href="#acl"        >Access Control Lists</a>
        <li><a href="#message"    >Displaying a login message</a>
        <li><a href="#shell"      >Assigning authpf as a user's shell</a>
        </ul>
  <li><a href="#loginclass"       >Creating an authpf login class</a>
  <li><a href="#wholog"           >Seeing who is logged in</a>
  <li><a href="#example"          >Example</a>
</ul>

<hr>

<h2 id="intro">Introduction</h2>

The <a href="http://man.openbsd.org/authpf">authpf(8)</a> utility is a user
shell for authenticating gateways.
An authenticating gateway is just like a regular network gateway (also known
as a router) except that users must first authenticate themselves to it before
their traffic is allowed to pass through.
When a user's shell is set to <tt>/usr/sbin/authpf</tt> and they log in using
SSH, authpf will make the necessary changes to the active
<a href="http://man.openbsd.org/pf">pf(4)</a> ruleset so that the user's
traffic is passed through the filter and/or translated using NAT/redirection.
Once the user logs out or their session is disconnected, authpf will remove
any rules loaded for the user and kill any stateful connections the user has
open.
Because of this, the ability of the user to pass traffic through the gateway
only exists while the user keeps their SSH session open.

<p>
A user's rules are loaded into a unique <a href="anchors.html">anchor</a>
point by authpf.
The anchor is named by combining the username and the authpf process-id
in the <tt>username(PID)</tt> format.
Each user's anchor is stored within the <tt>authpf</tt> anchor which is
in turn anchored to the main ruleset.
The fully qualified anchor path then becomes:

<blockquote><pre>
main_ruleset/authpf/username(PID)
</pre></blockquote>

The rules that authpf loads can be configured on a per-user or global basis.

<p>
Example uses of authpf include:

<ul>
 <li>Requiring users to authenticate before allowing internet access.
 <li>Granting certain users -- such as administrators -- access to
     restricted parts of the network.
 <li>Allowing only known users to access the rest of the network or
     internet from a wireless network segment.
 <li>Allowing workers from home or on the road access to resources on the
     company network.
     Users outside the office can not only open access to the company network,
     but can also be redirected to particular resources (their own desktop,
     for example) based on the username they authenticate with.
 <li>In a setting such as a library or other place with public Internet
     terminals, PF may be configured to allow limited Internet access to
     guest users.
     Registered users can then be provided with complete access.
</ul>

The authpf tool logs the username and IP of each user who authenticates
successfully, as well as the start and end times of their login session via
<a href="http://man.openbsd.org/syslogd">syslogd(8)</a>.
By using this information, an administrator can determine who was logged in
when and also make users accountable for their network traffic.

<h2 id="config">Configuration</h2>

The basic steps needed to configure authpf are outlined here.
For a complete description of authpf configuration, please refer to the
<a href="http://man.openbsd.org/authpf">man page</a>.

<h3 id="enable">Enabling authpf</h3>

The authpf utility will not run if the <tt>/etc/authpf/authpf.conf</tt>
config file is not present.
The file may be empty, but unless it is present, authpf will exit immediately
after a user authenticates successfully.

<p>
The following configuration directives can be placed in <tt>authpf.conf</tt>:

<ul>
  <li><tt>anchor=name</tt> - Use the specified
      <a href="anchors.html">anchor</a> <tt>name</tt> instead of
      <tt>authpf</tt>
  <li><tt>table=name</tt> - Use the specified
      <a href="tables.html">table</a> <tt>name</tt> instead of
      <tt>authpf_users</tt>
</ul>

<h3 id="linkmain">Linking authpf into the main ruleset</h3>

You can link authpf into the main ruleset by using an <tt>anchor</tt> rule:

<blockquote><pre>
anchor "authpf/*"
</pre></blockquote>

Wherever the <tt>anchor</tt> rule is placed within the ruleset is where PF
will branch off from the main ruleset to evaluate the authpf rules.

<h3 id="loadrules">Configuring loaded rules</h3>

The authpf rules can be loaded from one of these two files:

<ul>
 <li><tt>/etc/authpf/users/$USER/authpf.rules</tt>
 <li><tt>/etc/authpf/authpf.rules</tt>
</ul>

The first file contains rules that are only loaded when the user
<tt>$USER</tt> (which is replaced with the user's username) logs in.
The per-user rule configuration is used when a specific user, such as an
administrator, requires a set of rules that is different than the default set.
The second file contains the default rules which are loaded for any user that
doesn't have their own <tt>authpf.rules</tt> file.
If the user-specific file exists, it will override the default file.
At least one of the files must exist or authpf will not run.

<p>
Rules have the same syntax as in any other PF ruleset with one exception:
authpf allows for the use of two predefined macros:

<ul>
 <li><tt>$user_ip</tt> - the IP address of the logged in user
 <li><tt>$user_id</tt> - the username of the logged in user
</ul>

It's recommended practice to use the <tt>$user_ip</tt> macro to only permit
traffic through the gateway from the authenticated user's computer.

<p>
In addition to the <tt>$user_ip</tt> macro, authpf will make use of the
<tt>authpf_users</tt> table (if it exists) for storing the IP addresses
of all authenticated users.
Be sure to define the table before using it:

<blockquote><pre>
table &lt;authpf_users&gt; persist
pass in on egress proto tcp from &lt;authpf_users&gt; to port smtp
</pre></blockquote>

This table should only be used in rules that are meant to apply to all
authenticated users.

<h3 id="acl">Access Control Lists</h3>

Users can be prevented from using authpf by creating a file in the
<tt>/etc/authpf/banned/</tt> directory and naming it after their username.
The contents of the file will be displayed to the user before authpf
disconnects them.
This provides a handy way to notify the user of why they're disallowed access
and who to contact to have their access restored.

<p>
Conversely, it's also possible to allow only specific users access by
placing usernames in the <tt>/etc/authpf/authpf.allow</tt> file.
If the <tt>/etc/authpf/authpf.allow</tt> file does not exist or "<tt>*</tt>"
is entered into the file, then authpf will permit access to any user who
successfully logs in via SSH as long as they are not explicitly banned.

<p>
If authpf is unable to determine if a username is allowed or denied, it
will print a brief message and then disconnect the user.
An entry in <tt>/etc/authpf/banned/</tt> always overrides an entry in
<tt>/etc/authpf/authpf.allow</tt>.

<h3 id="message">Displaying a login message</h3>

Whenever a user successfully authenticates to authpf, a greeting is printed
which indicates that the user is authenticated.

<blockquote><pre>
Hello charlie. You are authenticated from host "198.51.100.10"
</pre></blockquote>

This message can be supplemented by putting a custom message in
<tt>/etc/authpf/authpf.message</tt>.
The contents of this file will be displayed after the default welcome message.

<h3 id="shell">Assigning authpf as a user's shell</h3>

In order for authpf to work, it must be assigned as the user's login shell.
When the user successfully authenticates to
<a href="http://man.openbsd.org/sshd">sshd(8)</a>, authpf will be executed
as the user's shell.
It will then check if the user is allowed to use authpf, load the rules from
the appropriate file, etc.

<p>
There are a couple ways of assigning authpf as a user's shell:

<ol>
  <li>Manually for each user using
      <a href="http://man.openbsd.org/chsh">chsh(1)</a>,
      <a href="http://man.openbsd.org/vipw">vipw(8)</a>,
      <a href="http://man.openbsd.org/useradd">useradd(8)</a>,
      <a href="http://man.openbsd.org/usermod">usermod(8)</a>, etc.
  <li>By assigning users to a login class and changing the class's
      <tt>shell</tt> option in
      <a href="http://man.openbsd.org/login.conf">login.conf(5)</a>.
</ol>

<h2 id="loginclass">Creating an authpf login class</h2>

When using authpf on a system that has regular user accounts and authpf
user accounts, it can be beneficial to use a separate login class for
the authpf users.
This allows for certain changes to those accounts to be made on a global
basis, and also allows different policies to be placed on regular accounts
and authpf accounts.
Some examples of what policies can be set:

<ul>
 <li><b>shell</b> - Specify a user's login shell.
     This can be used to force a user's shell to <tt>authpf</tt> regardless
     of the entry in the <a href="http://man.openbsd.org/passwd">passwd(5)</a>
     database.
 <li><b>welcome</b> - Specify which
     <a href="http://man.openbsd.org/motd">motd(5)</a> file to display when
     a user logs in.
     This is useful for displaying messages that are relevant only to authpf
     users.
</ul>

<p>
Login classes are created in the
<a href="http://man.openbsd.org/login.conf">login.conf(5)</a> file.
OpenBSD comes with an authpf login class defined as:

<blockquote><pre>
authpf:\
    :welcome=/etc/motd.authpf:\
    :shell=/usr/sbin/authpf:\
    :tc=default:
</pre></blockquote>

Users are assigned to a login class by editing the <tt>class</tt> field
of the user's passwd(5) database entry.
One way to do this is with the
<a href="http://man.openbsd.org/chsh">chsh(1)</a> command.

<h2 id="wholog">Seeing who is logged in</h2>

Once a user has successfully logged in and authpf has adjusted the PF
rules, authpf changes its process title to indicate the username and IP
address of the logged in user:

<blockquote><pre>
# <b>ps -ax | grep authpf</b>
23664 p0  Is+     0:00.11 -authpf: charlie@@192.168.1.3 (authpf)
</pre></blockquote>

Here the user <tt>charlie</tt> is logged in from the machine 192.168.1.3.
By sending a SIGTERM signal to the authpf process, the user can be forcefully
logged out.
Any rules loaded for the user will be removed and any stateful connections
the user has open will be killed.

<blockquote><pre>
# <b>kill -TERM 23664</b>
</pre></blockquote>

<h2 id="example">Example</h2>

The authpf tool is being used on an OpenBSD gateway to authenticate users on
a wireless network which is part of a larger campus network.
Once a user has authenticated, assuming they're not on the banned list, they
will be permitted to SSH out and to browse the web (including secure websites)
in addition to accessing either of the campus DNS servers.

<p>
The <tt>/etc/authpf/authpf.rules</tt> file contains the following rules:

<blockquote><pre>
wifi_if = "wi0"

pass in quick on $wifi_if \
   proto tcp from $user_ip to any port { ssh, http, https }
</pre></blockquote>

The administrative user <tt>charlie</tt> needs to be able to access the
campus SMTP and POP3 servers in addition to surfing the web and using SSH.
The following rules are set up in
<tt>/etc/authpf/users/charlie/authpf.rules</tt>:

<blockquote><pre>
wifi_if = "wi0"
smtp_server = "10.0.1.50"
pop3_server = "10.0.1.51"

pass in quick on $wifi_if \
   proto tcp from $user_ip to $smtp_server port smtp
pass in quick on $wifi_if \
   proto tcp from $user_ip to $pop3_server port pop3
pass in quick on $wifi_if \
   proto tcp from $user_ip to port { ssh, http, https }
</pre></blockquote>

The main ruleset -- located in <tt>/etc/pf.conf</tt> -- is set up as follows:

<blockquote><pre>
wifi_if = "wi0"
ext_if  = "fxp0"
dns_servers = "{ 10.0.1.56, 10.0.2.56 }"

table &lt;authpf_users&gt; persist

block drop all

pass out quick on $ext_if \
   inet proto { tcp, udp, icmp } from { $wifi_if:network, $ext_if }

pass in quick on $wifi_if \
   inet proto tcp from $wifi_if:network to $wifi_if port ssh

pass in quick on $wifi_if \
   inet proto { tcp, udp } from &lt;authpf_users&gt; to $dns_servers port domain

anchor "authpf/*" in on $wifi_if
</pre></blockquote>

The ruleset is very simple and does the following:

<ul>
  <li>Block everything (default deny).
  <li>Pass outgoing TCP, UDP and ICMP traffic on the external interface
      from the wireless network and from the gateway itself.
  <li>Pass incoming SSH traffic from the wireless network destined for the
      gateway itself.
      This rule is necessary to permit users to log in.
  <li>Pass incoming DNS requests from all authenticated authpf users to
      the campus DNS servers.
  <li>Create the anchor point "authpf" for incoming traffic on the wireless
      interface.
</ul>

The idea behind the main ruleset is to block everything and allow the
least amount of traffic through as possible.
Traffic is free to flow out on the external interface but is blocked from
entering the wireless interface by the default deny policy.
Once a user authenticates, their traffic is permitted to pass in on the
wireless interface and to then flow through the gateway into the rest of
the network.
The <tt>quick</tt> keyword is used throughout so that PF doesn't have to
evaluate each named ruleset when a new connection passes through the gateway.

<p>
</body>
</html>
@


1.53
log
@tls on openbsd.org is now real:
- link to https://www.openbsd.org from the sub-projects' pages
- make internal links relative
- switch link rel=canonical to https to please some search engines
"go ahead" from beck, "do it!!!!" tj
@
text
@a115 1
<p>
a166 1
<p>
a184 1
<p>
d196 1
a196 1
pass in on $ext_if proto tcp from &lt;authpf_users&gt; to port smtp
a393 1
<p>
@


1.52
log
@sync pf guide formatting with the main faq's style, fixing a few grammar
knits and broken links along the way.

input and ok tb
@
text
@d13 1
a13 1
<link rel="canonical" href="http://www.openbsd.org/faq/pf/authpf.html">
@


1.51
log
@page titles and <title> should be the same.
@
text
@d4 5
a10 1
<meta name="description"   content="the OpenBSD FAQ page">
d47 13
a59 13
<li><a href="#intro"            >Introduction</a>
<li><a href="#config"           >Configuration</a>
	<ul>
	<li><a href="#enable"   >Enabling Authpf</a>
	<li><a href="#linkmain" >Linking Authpf into the Main Ruleset</a>
	<li><a href="#loadrules">Configuring Loaded Rules</a>
	<li><a href="#acl"      >Access Control Lists</a>
	<li><a href="#message"  >Displaying a Login Message</a>
	<li><a href="#shell"    >Assigning Authpf as a User's Shell</a>
	</ul>
<li><a href="#loginclass"       >Creating an authpf Login Class</a>
<li><a href="#wholog"           >Seeing Who is Logged In</a>
<li><a href="#example"          >Example</a>
d65 22
a86 27
<a href="http://man.openbsd.org/authpf.8"
>Authpf(8)</a> is a user shell for authenticating gateways. An
authenticating gateway is just like a regular network gateway (a.k.a. a
router) except that users must first authenticate themselves to the
gateway before it will allow traffic to pass through it. When a user's
shell is set to <tt>/usr/sbin/authpf</tt> (i.e., instead of setting a
user's shell to
<a href="http://man.openbsd.org/ksh.1"
>ksh(1)</a>,
<a href="http://man.openbsd.org/csh.1"
>csh(1)</a>, etc) and the user logs in using SSH, authpf will make the
necessary changes to the active  
<a href="http://man.openbsd.org/pf.4"
>pf(4)</a> ruleset so that the user's traffic is passed through the
filter and/or translated using Network Address Translation or
redirection. Once the user logs out or their session is disconnected,
authpf will remove any rules loaded for the user and kill any stateful
connections the user has open. Because of this, the ability of the user
to pass traffic through the gateway only exists while the user keeps
their SSH session open. 

<p>
Authpf loads a user's rules into a unique
<a href="anchors.html">anchor point</a>. 
The anchor is named by combining the user's UNIX username and the authpf
process-id into the format "<tt>username(PID)</tt>".
Each users' anchor is stored within the <tt>authpf</tt> anchor which is
d88 1
a88 1
The "fully qualified anchor path" then becomes:
d90 3
a92 5
<blockquote>
<tt>
<i>main_ruleset</i>/authpf/<i>username</i>(<i>PID</i>)
</tt>
</blockquote>
d94 1
a94 3
<p>
The rules that authpf loads can be configured on a per-user or global
basis.
d98 1
d100 14
a113 14
<li>Requiring users to authenticate before allowing Internet access.
<li>Granting certain users -- such as administrators -- access to
restricted parts of the network.
<li>Allowing only known users to access the rest of the network or
Internet from a wireless network segment.
<li>Allowing workers from home, on the road, etc., access to resources on
the company network.  Users outside the office can not only open access
to the company network, but can also be redirected to particular
resources (e.g., their own desktop) based on the username they
authenticate with.
<li>In a setting such as a library or other place with public Internet
terminals, PF may be configured to allow limited Internet access to
guest users. Authpf can then be used to provide registered users with
complete access.
d117 5
a121 7
Authpf logs the username and IP address of each user who authenticates
successfully as well as the start and end times of their login session
via
<a href="http://man.openbsd.org/syslogd.8"
>syslogd(8)</a>. By using this information, an administrator can
determine who was logged in when and also make users accountable for
their network traffic.
a123 4
The basic steps needed to configure authpf are outlined here. For a
complete description of authpf configuration, please refer to the
<a href="http://man.openbsd.org/authpf.8"
>authpf man page</a>.
d125 5
a129 1
<h3 id="enable">Enabling Authpf</h3>
d131 4
a134 5
<p>
Authpf will not run if the config file <tt>/etc/authpf/authpf.conf</tt>
is not present.
The file may be empty (zero size), but unless it is present
authpf will exit immediately after a user authenticates successfully.
d137 1
a137 2
The following configuration directives can be placed in
<tt>authpf.conf</tt>:
d140 6
a145 4
<li><tt>anchor=<i>name</i></tt> - Use the specified
<a href="anchors.html">anchor</a> name instead of "authpf".
<li><tt>table=<i>name</i></tt> - Use the specified 
<a href="tables.html">table</a> name instead of "authpf_users".
d148 1
a148 7
<h3 id="linkmain">Linking Authpf into the Main Ruleset</h3>
Authpf is linked into the main ruleset by using an <tt>anchor</tt> rule:
<blockquote>
<tt>
anchor "authpf/*"<br>
</tt>
</blockquote>
d150 12
a161 4
<p>
Wherever the <tt>anchor</tt> rule is placed within the ruleset is
where PF will branch off from the main ruleset to evaluate the authpf
rules.
a162 2
<h3 id="loadrules">Configuring Loaded Rules</h3>
Authpf loads its rules from one of two files:
d164 2
a165 2
<li><tt>/etc/authpf/users/$USER/authpf.rules</tt>
<li><tt>/etc/authpf/authpf.rules</tt>
d170 7
a176 7
<tt>$USER</tt> (which is replaced with the user's username) logs in. The
per-user rule configuration is used when a specific user -- such as an
administrator -- requires a set of rules that is different than the
default set.  The second file contains the default rules which are
loaded for any user that doesn't have their own <tt>authpf.rules</tt>
file. If the user-specific file exists, it will override the default
file. At least one of the files must exist or authpf will not run. 
d179 3
a181 2
Rules have the same syntax as in any other PF ruleset with one
exception: Authpf allows for the use of two predefined macros:
d183 2
a184 2
<li><tt>$user_ip</tt> - the IP address of the logged in user
<li><tt>$user_id</tt> - the username of the logged in user
d188 2
a189 3
It's recommended practice to use the <tt>$user_ip</tt> macro to only
permit traffic through the gateway from the authenticated user's
computer.
a201 1
<p>
d206 1
d208 5
a212 5
<tt>/etc/authpf/banned/</tt> directory and naming it after the username
that is to be denied access.  The contents of the file will be displayed
to the user before authpf disconnects them. This provides a handy way to
notify the user of why they're disallowed access and who to contact to
have their access restored.
d216 3
a218 3
placing usernames in the <tt>/etc/authpf/authpf.allow</tt> file.  If the
<tt>/etc/authpf/authpf.allow</tt> file does not exist or "<tt>*</tt>" is
entered into the file, then authpf will permit access to any user who
d223 2
a224 2
will print a brief message and then disconnect the user. An entry in
<tt>/etc/authpf/banned/</tt> always overrides an entry in
d227 1
a227 1
<h3 id="message">Displaying a Login Message</h3>
d229 2
a230 3
<p>
Whenever a user successfully authenticates to authpf, a greeting is
printed that indicates that the user is authenticated.
d232 1
a232 2
<blockquote>
<tt>
d234 1
a234 2
</tt>
</blockquote>
a235 1
<p>
d237 11
a247 11
<tt>/etc/authpf/authpf.message</tt>. 
The contents of this file will be displayed after the default welcome
message.

<h3 id="shell">Assigning Authpf as a User's Shell</h3>
In order for authpf to work it must be assigned as the user's login
shell. When the user successfully authenticates to
<a href="http://man.openbsd.org/sshd.8"
>sshd(8)</a>, authpf will be executed as the user's shell. It will then
check if the user is allowed to use authpf, load the rules from the
appropriate file, etc.
d251 1
d253 8
a260 13
<li>Manually for each user using
<a href="http://man.openbsd.org/chsh.1"
>chsh(1)</a>, 
<a href="http://man.openbsd.org/vipw.8"
>vipw(8)</a>,
<a href="http://man.openbsd.org/useradd.8"
>useradd(8)</a>,
<a href="http://man.openbsd.org/usermod.8"
>usermod(8)</a>, etc.
<li>By assigning users to a login class and changing the class's 
<tt>shell</tt> option in
<a href="http://man.openbsd.org/login.conf.5"
><tt>/etc/login.conf</tt></a>.
d263 2
a264 1
<h2 id="loginclass">Creating an authpf Login Class</h2>
d269 2
a270 2
basis and also allows different policies to be placed on regular
accounts and authpf accounts.
d274 9
a282 10
<li><b>shell</b> - Specify a user's login shell.
This can be used to force a user's shell to <tt>authpf</tt> regardless
of the entry in the
<a href="http://man.openbsd.org/passwd.5"
>passwd(5)</a> database. 
<li><b>welcome</b> - Specify which
<a href="http://man.openbsd.org/motd.5"
>motd(5)</a> file to display when a user logs in. 
This is useful for displaying messages that are relevant only to authpf
users.
d287 1
a287 2
<a href="http://man.openbsd.org/login.conf.5"
>login.conf(5)</a> file. 
d290 6
a295 8
<blockquote>
<tt>
authpf:\<br>
&nbsp;&nbsp;&nbsp;&nbsp;:welcome=/etc/motd.authpf:\<br>
&nbsp;&nbsp;&nbsp;&nbsp;:shell=/usr/sbin/authpf:\<br>
&nbsp;&nbsp;&nbsp;&nbsp;:tc=default:
</tt>
</blockquote>
a296 1
<p>
d300 3
a302 2
<a href="http://man.openbsd.org/chsh.1"
>chsh(1)</a> command.
a303 1
<h2 id="wholog">Seeing Who is Logged In</h2>
a306 4
<pre>
    # ps -ax | grep authpf
    23664 p0  Is+     0:00.11 -authpf: charlie@@192.168.1.3 (authpf)
</pre>
d308 14
a321 8
<p>
Here the user <tt>charlie</tt> is logged in from the machine
192.168.1.3.  By sending a SIGTERM signal to the authpf process, the
user can be forcefully logged out. Authpf will also remove any rules
loaded for the user and kill any stateful connections the user has open.
<pre>
    # kill -TERM 23664
</pre>
d324 5
a328 4
Authpf is being used on an OpenBSD gateway to authenticate users on a
wireless network which is part of a larger campus network. Once a user
has authenticated, assuming they're not on the banned list, they will be
permitted to SSH out and to browse the web (including secure web sites)
d337 2
a338 2
pass in quick on $wifi_if proto tcp from $user_ip to port { ssh, http, \
   https }
a340 1
<p>
d342 2
a343 2
campus SMTP and POP3 servers in addition to surfing the web and using
SSH. The following rules are setup in
d359 1
a359 3
<p>
The main ruleset -- located in <tt>/etc/pf.conf</tt> -- is setup
as follows:
a361 1
# macros
a367 1
# filter
d370 2
a371 2
pass out quick on $ext_if inet proto { tcp, udp, icmp } \
   from { $wifi_if:network, $ext_if }
d373 2
a374 2
pass in quick on $wifi_if inet proto tcp \
   from $wifi_if:network to $wifi_if port ssh
d376 2
a377 2
pass in quick on $wifi_if inet proto { tcp, udp } \
   from &lt;authpf_users&gt; to $dns_servers port domain
a381 1
<p>
d383 1
d385 10
a394 9
<li>Block everything (default deny).
<li>Pass outgoing TCP, UDP, and ICMP traffic on the external interface 
from the wireless network and from the gateway itself.
<li>Pass incoming SSH traffic from the wireless network destined for the
gateway itself. This rule is necessary to permit users to log in.
<li>Pass incoming DNS requests from all authenticated authpf users to
the campus DNS servers.
<li>Create the anchor point "authpf" for incoming traffic on the wireless
interface. 
d399 8
a406 8
least amount of traffic through as possible. Traffic is free to flow out
on the external interface but is blocked from entering the wireless
interface by the default deny policy. Once a user authenticates,
their traffic is permitted to pass in on the wireless interface
and to then flow through the gateway into the rest of the network. The
<tt>quick</tt> keyword is used throughout so that PF doesn't have to
evaluate each named ruleset when a new connection passes through the
gateway.
d410 1
a410 1
</html> 
@


1.50
log
@tweak [faq index] button and sync the pf user's guide with that style.
@
text
@d4 1
a4 1
<title>PF - Authpf: User Shell for Authenticating Gateways</title>
d34 2
a35 1
<font color="#e00000">PF - Authpf: User Shell for Authenticating Gateways</font>
d43 2
a44 2
<li><a href="#intro">Introduction</a>
<li><a href="#config">Configuration</a>
d46 2
a47 2
	<li><a href="#enable">Enabling Authpf</a>
	<li><a href="#linkmain">Linking Authpf into the Main Ruleset</a>
d49 3
a51 3
	<li><a href="#acl">Access Control Lists</a>
	<li><a href="#message">Displaying a Login Message</a>
	<li><a href="#shell">Assigning Authpf as a User's Shell</a>
d53 3
a55 3
<li><a href="#loginclass">Creating an authpf Login Class</a>
<li><a href="#wholog">Seeing Who is Logged In</a>
<li><a href="#example">Example</a>
@


1.49
log
@use short form man links in the faq and fix a few broken links
@
text
@a29 2
<!-- Passes validator.w3.org, please keep it this way;
please, use a max of 72 chars per line -->
d35 3
a39 5
<p>
[<a href="index.html">Contents</a>]
[<a href="ftp.html">Previous: Issues with FTP</a>]
[<a href="carp.html">Next: Firewall Redundancy with CARP and pfsync</a>]
<p>
a40 1
<h3>Table of Contents</h3>
a424 5

<p>
[<a href="ftp.html">Previous: Issues with FTP</a>]
[<a href="index.html">Contents</a>]
[<a href="carp.html">Next: Firewall Redundancy with CARP and pfsync</a>]
@


1.48
log
@new openbsd faq style. joint with tj and validator.w3.org
@
text
@d65 1
a65 1
<a href="http://man.openbsd.org/?query=authpf&amp;sektion=8"
d72 1
a72 1
<a href="http://man.openbsd.org/?query=ksh&amp;sektion=1"
d74 1
a74 1
<a href="http://man.openbsd.org/?query=csh&amp;sektion=1"
d77 1
a77 1
<a href="http://man.openbsd.org/?query=pf&amp;sektion=4"
d128 1
a128 1
<a href="http://man.openbsd.org/?query=syslogd&amp;sektion=8"
d136 1
a136 1
<a href="http://man.openbsd.org/?query=authpf&amp;sektion=8"
d258 1
a258 1
<a href="http://man.openbsd.org/?query=sshd&amp;sektion=8"
d267 1
a267 1
<a href="http://man.openbsd.org/?query=chsh&amp;sektion=1"
d269 1
a269 1
<a href="http://man.openbsd.org/?query=vipw&amp;sektion=8"
d271 1
a271 1
<a href="http://man.openbsd.org/?query=useradd&amp;sektion=8"
d273 1
a273 1
<a href="http://man.openbsd.org/?query=usermod&amp;sektion=8"
d277 1
a277 1
<a href="http://man.openbsd.org/?query=login.conf&amp;sektion=5"
d294 1
a294 1
<a href="http://man.openbsd.org/?query=passwd&amp;sektion=5"
d297 1
a297 1
<a href="http://man.openbsd.org/?query=motd&amp;sektion=5"
d305 1
a305 1
<a href="http://man.openbsd.org/?query=login.conf&amp;sektion=5"
d322 1
a322 1
<a href="http://man.openbsd.org/?query=chsh&amp;sektion=1"
@


1.47
log
@add a small sprinkling of css to improve readability in the faq, ok tj@@ tb@@
@
text
@d4 1
a4 1
<title>PF: Authpf: User Shell for Authenticating Gateways</title>
d33 1
d35 4
a38 2
<img alt="[OpenBSD]" height=30 width=141 src="../../images/smalltitle.gif" border="0">
</a>
d40 1
a41 1
[<a href="index.html">Contents</a>]
d43 1
a43 5

<h1><font color="#e00000">PF: Authpf: User Shell for Authenticating
Gateways</font></h1>

<hr>
@


1.46
log
@fix URIs, the / before querystring is not optional,
if not fixed up by browsers the server returns 400 Bad Request.
@
text
@d7 2
@


1.45
log
@change http://www.openbsd.org/cgi-bin/man.cgi to be http://man.openbsd.org
this points stuff to the new place and gets us ready to deprecate the old
place we did this.
@
text
@d64 1
a64 1
<a href="http://man.openbsd.org?query=authpf&amp;sektion=8"
d71 1
a71 1
<a href="http://man.openbsd.org?query=ksh&amp;sektion=1"
d73 1
a73 1
<a href="http://man.openbsd.org?query=csh&amp;sektion=1"
d76 1
a76 1
<a href="http://man.openbsd.org?query=pf&amp;sektion=4"
d127 1
a127 1
<a href="http://man.openbsd.org?query=syslogd&amp;sektion=8"
d135 1
a135 1
<a href="http://man.openbsd.org?query=authpf&amp;sektion=8"
d257 1
a257 1
<a href="http://man.openbsd.org?query=sshd&amp;sektion=8"
d266 1
a266 1
<a href="http://man.openbsd.org?query=chsh&amp;sektion=1"
d268 1
a268 1
<a href="http://man.openbsd.org?query=vipw&amp;sektion=8"
d270 1
a270 1
<a href="http://man.openbsd.org?query=useradd&amp;sektion=8"
d272 1
a272 1
<a href="http://man.openbsd.org?query=usermod&amp;sektion=8"
d276 1
a276 1
<a href="http://man.openbsd.org?query=login.conf&amp;sektion=5"
d293 1
a293 1
<a href="http://man.openbsd.org?query=passwd&amp;sektion=5"
d296 1
a296 1
<a href="http://man.openbsd.org?query=motd&amp;sektion=5"
d304 1
a304 1
<a href="http://man.openbsd.org?query=login.conf&amp;sektion=5"
d321 1
a321 1
<a href="http://man.openbsd.org?query=chsh&amp;sektion=1"
@


1.44
log
@replace a disorganized assortment of tables and hand-rolled command output
with more standard formatting. while here, run a few less of those commands
as root where it's not needed. the cvs checkout examples were adopted to
use the wsrc group as is done in the ports faq.

input/ok tb
@
text
@d64 1
a64 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8"
d71 1
a71 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ksh&amp;sektion=1"
d73 1
a73 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=csh&amp;sektion=1"
d76 1
a76 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4"
d127 1
a127 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=syslogd&amp;sektion=8"
d135 1
a135 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8"
d257 1
a257 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sshd&amp;sektion=8"
d266 1
a266 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=chsh&amp;sektion=1"
d268 1
a268 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8"
d270 1
a270 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=useradd&amp;sektion=8"
d272 1
a272 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=usermod&amp;sektion=8"
d276 1
a276 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=login.conf&amp;sektion=5"
d293 1
a293 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=passwd&amp;sektion=5"
d296 1
a296 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=motd&amp;sektion=5"
d304 1
a304 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=login.conf&amp;sektion=5"
d321 1
a321 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=chsh&amp;sektion=1"
@


1.43
log
@
rev for 5.8, mostly removing manpath part of man page urls
@
text
@d206 4
a209 7
<blockquote>
<tt>
table &lt;authpf_users&gt; persist<br>
pass in on $ext_if proto tcp from &lt;authpf_users&gt; \<br>
&nbsp;&nbsp;&nbsp;&nbsp;to port smtp
</tt>
</blockquote>
d350 1
a350 2
The <tt>/etc/authpf/authpf.rules</tt> file contains the following rules:<br>
<br>
d352 1
a352 3
<table border=0 width="650">
<tr><td nowrap bgcolor="#EEEEEE">
<pre>
d357 1
a357 3
</pre>
</td></tr>
</table>
d363 1
a363 2
<tt>/etc/authpf/users/charlie/authpf.rules</tt>:<br>
<br>
d365 1
a365 3
<table border=0 width="650">
<tr><td nowrap bgcolor="#EEEEEE">
<pre>
d376 1
a376 3
</pre>
</td></tr>
</table>
d380 1
a380 2
as follows:<br>
<br>
d382 1
a382 3
<table border=0 width="650">
<tr><td nowrap bgcolor="#EEEEEE">
<pre>
d403 1
a403 3
</pre>
</td></tr>
</table>
@


1.42
log
@Clean up meta tags.

name=distribution, name=keywords, and name=resource-type have no effect
in modern search engines and just clutter up the page source.

From Pavel Plamenov.
@
text
@d64 1
a64 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+5.7"
d76 1
a76 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+5.7"
d135 1
a135 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+5.7"
@


1.41
log
@Add 'link rel="canonical"' to pages, acting as a hint to search engines
to list the copies on www.openbsd.org rather than mirrors.

From Carlin Bingham, ok millert@@ nick@@
@
text
@a5 1
<meta name="resource-type" content="document">
a6 2
<meta name="keywords"      content="openbsd,faq,pf">
<meta name="distribution"  content="global">
@


1.40
log
@
updates for 5.7
@
text
@d10 1
@


1.39
log
@
5.5->5.6 which I forgot and Jonathan Thornburg (jthorn at astro dot
indiana dot edu) reminded me of, but also sent a diff for, thanks!
@
text
@d66 1
a66 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+5.6"
d78 1
a78 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+5.6"
d137 1
a137 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+5.6"
@


1.38
log
@Convert the pf faq to use id="" instead of "a name=""></a>.
@
text
@d66 1
a66 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+5.5"
d78 1
a78 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+5.5"
d137 1
a137 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+5.5"
@


1.37
log
@Switch example addresses to the prefixes reserved for documentation in rfc5737.
From Sevan Janiyan, nick@@ ok
@
text
@d65 1
a65 2
<a name="intro"></a>
<h2>Introduction</h2>
d134 1
a134 2
<a name="config"></a>
<h2>Configuration</h2>
d140 1
a140 2
<a name="enable"></a>
<h3>Enabling Authpf</h3>
d159 1
a159 2
<a name="linkmain"></a>
<h3>Linking Authpf into the Main Ruleset</h3>
d172 1
a172 2
<a name="loadrules"></a>
<h3>Configuring Loaded Rules</h3>
d220 1
a220 2
<a name="acl"></a>
<h3>Access Control Lists</h3>
d241 1
a241 2
<a name="message"></a>
<h3>Displaying a Login Message</h3>
d259 1
a259 2
<a name="shell"></a>
<h3>Assigning Authpf as a User's Shell</h3>
d285 1
a285 2
<a name="loginclass"></a>
<h2>Creating an authpf Login Class</h2>
d329 1
a329 3

<a name="wholog"></a>
<h2>Seeing Who is Logged In</h2>
d347 1
a347 2
<a name="example"></a>
<h2>Example</h2>
@


1.36
log
@
update for 5.5
@
text
@d256 1
a256 1
Hello charlie. You are authenticated from host "64.59.56.140"
@


1.35
log
@
www@@ removal, normalize footers.
@
text
@d67 1
a67 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+5.4"
d79 1
a79 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+5.4"
d139 1
a139 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+5.4"
@


1.34
log
@
update for 5.4
@
text
@a4 1
<link rev="made" href="mailto:www@@openbsd.org">
a467 6
<hr>
<a href="index.html"><img height="24" width="24" src="../../images/back.gif" border="0" alt="[back]"></a> 
<a href="mailto:www@@openbsd.org">www@@openbsd.org</a>
<br>
<small>$OpenBSD: authpf.html,v 1.33 2013/05/01 13:21:45 nick Exp $</small>

@


1.33
log
@
updates for 5.3
@
text
@d68 1
a68 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+5.3"
d80 1
a80 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+5.3"
d140 1
a140 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+5.3"
d473 1
a473 1
<small>$OpenBSD: authpf.html,v 1.32 2012/11/01 15:06:36 nick Exp $</small>
@


1.32
log
@
enter 5.2
@
text
@d68 1
a68 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+5.2"
d80 1
a80 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+5.2"
d140 1
a140 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+5.2"
d473 1
a473 1
<small>$OpenBSD: authpf.html,v 1.31 2012/05/11 11:20:04 nick Exp $</small>
@


1.31
log
@
forgot to actually COMMIT these 5.1 changes.  *sigh*
@
text
@d68 1
a68 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+5.1"
d80 1
a80 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+5.1"
d140 1
a140 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+5.1"
d473 1
a473 1
<small>$OpenBSD: authpf.html,v 1.30 2011/11/02 01:01:47 nick Exp $</small>
@


1.30
log
@
rev man page references to 5.0
@
text
@d68 1
a68 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+5.0"
d80 1
a80 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+5.0"
d140 1
a140 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+5.0"
d473 1
a473 1
<small>$OpenBSD: authpf.html,v 1.29 2011/05/01 12:57:11 nick Exp $</small>
@


1.29
log
@
updates for 4.9
@
text
@d68 1
a68 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+4.9"
d80 1
a80 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+4.9"
d140 1
a140 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+4.9"
d473 1
a473 1
<small>$OpenBSD: authpf.html,v 1.28 2010/11/01 09:53:51 nick Exp $</small>
@


1.28
log
@
update to 4.8
@
text
@d68 1
a68 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+4.8"
d80 1
a80 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+4.8"
d140 1
a140 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+4.8"
d473 1
a473 1
<small>$OpenBSD: authpf.html,v 1.27 2010/05/19 13:25:16 sthen Exp $</small>
@


1.27
log
@Update the PF faq for 4.7 changes.
@
text
@d68 1
a68 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+4.7"
d80 1
a80 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+4.7"
d140 1
a140 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+4.7"
d473 1
a473 1
<small>$OpenBSD: authpf.html,v 1.26 2009/10/16 19:12:42 nick Exp $</small>
@


1.26
log
@
quick update for 4.6.  much more is needed, at least scrub.html is
currently dead wrong, so I've unlinked it from the rest for now.
@
text
@d68 1
a68 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+4.6"
d80 1
a80 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+4.6"
d90 1
a90 1
Authpf loads a user's filter/NAT rules into a unique
d140 1
a140 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+4.6"
d149 1
a149 1
Even if the file is empty (zero size), it must still be present or
d165 1
a165 1
Authpf is linked into the main ruleset by using <tt>anchor</tt> rules:
a167 3
nat-anchor "authpf/*"<br>
rdr-anchor "authpf/*"<br>
binat-anchor "authpf/*"<br>
d173 1
a173 1
Wherever the <tt>anchor</tt> rules are placed within the ruleset is
d175 1
a175 3
rules. It's not necessary for all four <tt>anchor</tt> rules to be
present; for example, if authpf hasn't been setup to load any
<tt>nat</tt> rules, the <tt>nat-anchor</tt> rule can be omitted.
d196 2
a197 3
Filter and translation rules have the same syntax as in any other PF
ruleset with one exception: Authpf allows for the use of two predefined
macros:
d218 1
a218 1
&nbsp;&nbsp;&nbsp;&nbsp;to port  smtp flags S/SA keep state
d377 1
a377 1
   https } flags S/SA keep state
d396 6
a401 6
pass in quick on $wifi_if proto tcp from $user_ip to $smtp_server \
   port smtp flags S/SA keep state
pass in quick on $wifi_if proto tcp from $user_ip to $pop3_server \
   port pop3 flags S/SA keep state
pass in quick on $wifi_if proto tcp from $user_ip to port { ssh, http, \
   https } flags S/SA keep state
a420 2
scrub in all

d424 5
a428 4
pass out quick on $ext_if inet proto tcp from \
   { $wifi_if:network, $ext_if } flags S/SA modulate state
pass out quick on $ext_if inet proto { udp, icmp } from \
   { $wifi_if:network, $ext_if } keep state
d430 2
a431 2
pass in quick on $wifi_if inet proto tcp from $wifi_if:network to $wifi_if \
   port ssh flags S/SA keep state
a432 2
pass in quick on $wifi_if inet proto { tcp, udp } from &lt;authpf_users&gt; \
   to $dns_servers port domain keep state
d473 1
a473 1
<small>$OpenBSD: authpf.html,v 1.25 2009/04/30 17:27:31 nick Exp $</small>
@


1.25
log
@
updates for 4.5
@
text
@d68 1
a68 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+4.5"
d80 1
a80 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+4.5"
d140 1
a140 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+4.5"
d482 1
a482 1
<small>$OpenBSD: authpf.html,v 1.24 2008/10/31 16:49:34 nick Exp $</small>
@


1.24
log
@
update numbers for 4.4
@
text
@d68 1
a68 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+4.4"
d80 1
a80 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+4.4"
d140 1
a140 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+4.4"
d482 1
a482 1
<small>$OpenBSD: authpf.html,v 1.23 2008/07/27 17:13:47 nick Exp $</small>
@


1.23
log
@
PF updates for 4.3..which got missed a few times.
@
text
@d68 1
a68 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+4.3"
d80 1
a80 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+4.3"
d140 1
a140 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+4.3"
d482 1
a482 1
<small>$OpenBSD: authpf.html,v 1.22 2007/11/01 02:57:56 joel Exp $</small>
@


1.22
log
@Updates for OpenBSD 4.2
@
text
@d68 1
a68 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+4.2"
d80 1
a80 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+4.2"
d140 1
a140 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+4.2"
d482 1
a482 1
<small>$OpenBSD: authpf.html,v 1.21 2007/05/07 01:13:53 joel Exp $</small>
@


1.21
log
@Updates for OpenBSD 4.1
@
text
@d68 1
a68 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+4.1"
d80 1
a80 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+4.1"
d140 1
a140 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+4.1"
d482 1
a482 1
<small>$OpenBSD: authpf.html,v 1.20 2007/05/06 18:59:54 nick Exp $</small>
@


1.20
log
@
manpath changes to:
  4.1 for PF related items
  removed for non-PF-related items, which will probably either not
    change much, or benefit from the newest, best man pages.
@
text
@d14 1
a14 1
Copyright (c) 2003-2005 Joel Knight <enabled@@myrealbox.com>
d303 1
a303 1
user accounts, it can be beneficial to create a separate login class for
d327 1
a327 1
An example login class for authpf users:
d482 1
a482 1
<small>$OpenBSD: authpf.html,v 1.19 2006/11/01 01:56:01 joel Exp $</small>
@


1.19
log
@Updates for OpenBSD 4.0. uRPF, tftp-proxy, more ftp-proxy, etc.
Thanks to mcbride for the bits about interface groups
@
text
@d68 1
a68 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+4.0"
d75 1
a75 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ksh&amp;sektion=1&amp;manpath=OpenBSD+4.0"
d77 1
a77 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=csh&amp;sektion=1&amp;manpath=OpenBSD+4.0"
d80 1
a80 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+4.0"
d131 1
a131 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=syslogd&amp;sektion=8&amp;manpath=OpenBSD+4.0"
d140 1
a140 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+4.0"
d277 1
a277 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sshd&amp;sektion=8&amp;manpath=OpenBSD+4.0"
d286 1
a286 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=chsh&amp;sektion=1&amp;manpath=OpenBSD+4.0"
d288 1
a288 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8&amp;manpath=OpenBSD+4.0"
d290 1
a290 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=useradd&amp;sektion=8&amp;manpath=OpenBSD+4.0"
d292 1
a292 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=usermod&amp;sektion=8&amp;manpath=OpenBSD+4.0"
d296 1
a296 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=login.conf&amp;sektion=5&amp;manpath=OpenBSD+4.0"
d482 1
a482 1
<small>$OpenBSD: authpf.html,v 1.18 2006/05/01 00:54:29 nick Exp $</small>
@


1.18
log
@
3.9 updates, mostly rev'ing man page links
@
text
@d68 1
a68 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+3.9"
d75 1
a75 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ksh&amp;sektion=1&amp;manpath=OpenBSD+3.9"
d77 1
a77 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=csh&amp;sektion=1&amp;manpath=OpenBSD+3.9"
d80 1
a80 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+3.9"
d131 1
a131 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=syslogd&amp;sektion=8&amp;manpath=OpenBSD+3.9"
d140 1
a140 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+3.9"
d277 1
a277 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sshd&amp;sektion=8&amp;manpath=OpenBSD+3.9"
d286 1
a286 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=chsh&amp;sektion=1&amp;manpath=OpenBSD+3.9"
d288 1
a288 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8&amp;manpath=OpenBSD+3.9"
d290 1
a290 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=useradd&amp;sektion=8&amp;manpath=OpenBSD+3.9"
d292 1
a292 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=usermod&amp;sektion=8&amp;manpath=OpenBSD+3.9"
d296 1
a296 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=login.conf&amp;sektion=5&amp;manpath=OpenBSD+3.9"
d482 1
a482 1
<small>$OpenBSD: authpf.html,v 1.17 2005/11/01 11:35:18 nick Exp $</small>
@


1.17
log
@
bump manpath= tag for 3.8
@
text
@d68 1
a68 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+3.8"
d75 1
a75 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ksh&amp;sektion=1&amp;manpath=OpenBSD+3.8"
d77 1
a77 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=csh&amp;sektion=1&amp;manpath=OpenBSD+3.8"
d80 1
a80 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+3.8"
d131 1
a131 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=syslogd&amp;sektion=8&amp;manpath=OpenBSD+3.8"
d140 1
a140 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+3.8"
d277 1
a277 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sshd&amp;sektion=8&amp;manpath=OpenBSD+3.8"
d286 1
a286 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=chsh&amp;sektion=1&amp;manpath=OpenBSD+3.8"
d288 1
a288 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8&amp;manpath=OpenBSD+3.8"
d290 1
a290 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=useradd&amp;sektion=8&amp;manpath=OpenBSD+3.8"
d292 1
a292 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=usermod&amp;sektion=8&amp;manpath=OpenBSD+3.8"
d296 1
a296 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=login.conf&amp;sektion=5&amp;manpath=OpenBSD+3.8"
d482 1
a482 1
<small>$OpenBSD: authpf.html,v 1.16 2005/05/21 05:55:43 joel Exp $</small>
@


1.16
log
@Tie in pf/carp.html
@
text
@d68 1
a68 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+3.7"
d75 1
a75 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ksh&amp;sektion=1&amp;manpath=OpenBSD+3.7"
d77 1
a77 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=csh&amp;sektion=1&amp;manpath=OpenBSD+3.7"
d80 1
a80 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+3.7"
d131 1
a131 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=syslogd&amp;sektion=8&amp;manpath=OpenBSD+3.7"
d140 1
a140 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+3.7"
d277 1
a277 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sshd&amp;sektion=8&amp;manpath=OpenBSD+3.7"
d286 1
a286 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=chsh&amp;sektion=1&amp;manpath=OpenBSD+3.7"
d288 1
a288 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8&amp;manpath=OpenBSD+3.7"
d290 1
a290 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=useradd&amp;sektion=8&amp;manpath=OpenBSD+3.7"
d292 1
a292 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=usermod&amp;sektion=8&amp;manpath=OpenBSD+3.7"
d296 1
a296 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=login.conf&amp;sektion=5&amp;manpath=OpenBSD+3.7"
d482 1
a482 1
<small>$OpenBSD: authpf.html,v 1.15 2005/05/20 00:12:02 joel Exp $</small>
@


1.15
log
@Updates for OpenBSD 3.7.
@
text
@d40 1
a40 2
[<a href="example1.html">Next: Example: Firewall for Home or
Small Office</a>]
d475 1
a475 2
[<a href="example1.html">Next: Example: Firewall for Home or
Small Office</a>]
d482 1
a482 1
<small>$OpenBSD: authpf.html,v 1.14 2005/02/11 06:57:07 joel Exp $</small>
@


1.14
log
@Fix a parse error in the example.
@
text
@d69 1
a69 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+3.6"
d76 1
a76 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ksh&amp;sektion=1&amp;manpath=OpenBSD+3.6"
d78 1
a78 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=csh&amp;sektion=1&amp;manpath=OpenBSD+3.6"
d81 1
a81 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+3.6"
d132 1
a132 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=syslogd&amp;sektion=8&amp;manpath=OpenBSD+3.6"
d141 1
a141 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+3.6"
d278 1
a278 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sshd&amp;sektion=8&amp;manpath=OpenBSD+3.6"
d287 1
a287 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=chsh&amp;sektion=1&amp;manpath=OpenBSD+3.6"
d289 1
a289 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8&amp;manpath=OpenBSD+3.6"
d291 1
a291 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=useradd&amp;sektion=8&amp;manpath=OpenBSD+3.6"
d293 1
a293 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=usermod&amp;sektion=8&amp;manpath=OpenBSD+3.6"
d297 1
a297 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=login.conf&amp;sektion=5&amp;manpath=OpenBSD+3.6"
d484 1
a484 1
<small>$OpenBSD: authpf.html,v 1.13 2005/02/11 06:44:04 joel Exp $</small>
@


1.13
log
@In the example:
- allow outbound traffic from the gateway itself
- use the authpf_users table
@
text
@d433 3
a435 3
pass out quick on $ext_if proto tcp from { $wifi_if:network, $ext_if } \
   flags S/SA modulate state
pass out quick on $ext_if proto { udp, icmp } from \
d438 1
a438 1
pass in quick on $wifi_if proto tcp from $wifi_if:network to $wifi_if \
d441 1
a441 1
pass in quick on $wifi_if proto { tcp, udp } from &lt;authpf_users&gt; \
d484 1
a484 1
<small>$OpenBSD: authpf.html,v 1.12 2005/02/11 05:30:50 joel Exp $</small>
@


1.12
log
@- Cover the /etc/authpf/authpf.conf file
- Mention authpf_users table
- Cover /etc/authpf/authpf.message
- Introduce how to create a login class in login.conf(5) for authpf
  users

ok nick@@
@
text
@a381 1
dns_servers = "{ 10.0.1.56, 10.0.2.56 }"
a382 2
pass in quick on $wifi_if proto udp from $user_ip to $dns_servers \
   port domain keep state
a401 1
dns_servers = "{ 10.0.1.56, 10.0.2.56 }"
a402 2
pass in quick on $wifi_if proto udp from $user_ip to $dns_servers \
   port domain keep state
d424 3
d433 4
a436 4
pass out quick on $ext_if proto tcp from $wifi_if:network flags S/SA \
   modulate state
pass out quick on $ext_if proto { udp, icmp } from $wifi_if:network \
   keep state
d441 2
d453 1
a453 1
from the wireless network.
d456 2
d484 1
a484 1
<small>$OpenBSD: authpf.html,v 1.11 2005/02/07 05:51:38 joel Exp $</small>
@


1.11
log
@Remove reference to named rulesets. Explain that authpf now uses a
unique anchor point per user.  Adjust copyright date while here.

ok nick@@
@
text
@d53 1
d57 1
d60 1
a61 1
<li><a href="#moreinfo">More Information</a>
d144 20
d215 18
d255 19
d301 46
a365 6
<a name="moreinfo"></a>
<h2>More Information</h2>
For a complete description of authpf operation, please refer to the 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+3.6"
>authpf man page</a>.

d483 1
a483 1
<small>$OpenBSD: authpf.html,v 1.10 2004/12/22 04:28:16 david Exp $</small>
@


1.10
log
@make small title logo a link back to main page; ok nick@@
@
text
@d14 1
a14 1
Copyright (c) 2003, 2004 Joel Knight <enabled@@myrealbox.com>
d89 17
a105 10
Authpf alters the  
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+3.6"
>pf(4)</a> ruleset by adding rules to a 
<a href="anchors.html#named">named ruleset</a> attached to an
<a href="anchors.html">anchor point</a>. Each time a user authenticates,
authpf creates a new named ruleset and loads the preconfigured
<a href="filter.html">filter</a>, <a href="nat.html"><tt>nat</tt></a>,
<a href="nat.html#binat"><tt>binat</tt></a>, and 
<a href="rdr.html"><tt>rdr</tt></a> rules into it. The rules that authpf
loads can be configured on a per-user or global basis.
d384 1
a384 1
<small>$OpenBSD: authpf.html,v 1.9 2004/11/11 09:50:15 saad Exp $</small>
@


1.9
log
@fix anchor syntax for 3.6. ok joel and nick@@
@
text
@d34 3
a36 1
<img alt="[OpenBSD]" height=30 width=141 src="../../images/smalltitle.gif">
d377 1
a377 1
<small>$OpenBSD: authpf.html,v 1.8 2004/10/29 17:22:57 nick Exp $</small>
@


1.8
log
@
Update for 3.6
@
text
@d336 1
a336 1
anchor authpf in on $wifi_if
d375 1
a375 1
<small>$OpenBSD: authpf.html,v 1.7 2004/05/07 01:55:23 nick Exp $</small>
@


1.7
log
@
Add an OpenBSD license to the PF User's Guide.
Concept and breakdown of copyrights agreed to by Joel Knight and myself,
license assistance millert@@, ok deraadt@@.
@
text
@d65 1
a65 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+3.5"
d72 1
a72 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ksh&amp;sektion=1&amp;manpath=OpenBSD+3.5"
d74 1
a74 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=csh&amp;sektion=1&amp;manpath=OpenBSD+3.5"
d77 1
a77 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+3.5"
d88 1
a88 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+3.5"
d121 1
a121 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=syslogd&amp;sektion=8&amp;manpath=OpenBSD+3.5"
d130 1
a130 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+3.5"
d138 4
a141 4
nat-anchor authpf<br>
rdr-anchor authpf<br>
binat-anchor authpf<br>
anchor authpf<br>
d210 1
a210 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sshd&amp;sektion=8&amp;manpath=OpenBSD+3.5"
d219 1
a219 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=chsh&amp;sektion=1&amp;manpath=OpenBSD+3.5"
d221 1
a221 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8&amp;manpath=OpenBSD+3.5"
d223 1
a223 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=useradd&amp;sektion=8&amp;manpath=OpenBSD+3.5"
d225 1
a225 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=usermod&amp;sektion=8&amp;manpath=OpenBSD+3.5"
d229 1
a229 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=login.conf&amp;sektion=5&amp;manpath=OpenBSD+3.5"
d255 1
a255 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+3.5"
d375 1
a375 1
<small>$OpenBSD: authpf.html,v 1.6 2004/04/30 18:00:25 nick Exp $</small>
@


1.6
log
@
PF User's Guide updates for OpenBSD 3.5.
Work done by Joel Knight (enabled et myrealbox.dit com), many, many thanks
to him for providing and maintaining some darned good docs.
@
text
@a10 1
<meta name="copyright"     content="This document copyright 2003-2004 by OpenBSD.">
d13 17
d375 1
a375 1
<small>$OpenBSD: authpf.html,v 1.5 2004/01/01 04:16:17 nick Exp $</small>
@


1.5
log
@
Bump copyright to 2004
@
text
@d22 1
a22 1
[<a href="example1.html">Next: Example #1: Firewall for Home or
d49 1
a49 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+3.4"
d56 1
a56 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ksh&amp;sektion=1&amp;manpath=OpenBSD+3.4"
d58 1
a58 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=csh&amp;sektion=1&amp;manpath=OpenBSD+3.4"
d61 1
a61 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+3.4"
d72 1
a72 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+3.4"
d105 1
a105 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=syslogd&amp;sektion=8&amp;manpath=OpenBSD+3.4"
d114 1
a114 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+3.4"
d194 1
a194 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sshd&amp;sektion=8&amp;manpath=OpenBSD+3.4"
d203 1
a203 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=chsh&amp;sektion=1&amp;manpath=OpenBSD+3.4"
d205 1
a205 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8&amp;manpath=OpenBSD+3.4"
d207 1
a207 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=useradd&amp;sektion=8&amp;manpath=OpenBSD+3.4"
d209 1
a209 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=usermod&amp;sektion=8&amp;manpath=OpenBSD+3.4"
d213 1
a213 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=login.conf&amp;sektion=5&amp;manpath=OpenBSD+3.4"
d239 1
a239 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+3.4"
d351 1
a351 1
[<a href="example1.html">Next: Example #1: Firewall for Home or
d359 1
a359 1
<small>$OpenBSD: authpf.html,v 1.4 2003/11/09 23:29:02 nick Exp $</small>
@


1.4
log
@
Update of PF User's Guide to 3.4.  Ok, really just pointing the man page
links at the 3.4-release man pages rather than the 3.3-release man pages.
Work by Joel Knight.
@
text
@d11 1
a11 1
<meta name="copyright"     content="This document copyright 2003 by OpenBSD.">
d359 1
a359 1
<small>$OpenBSD: authpf.html,v 1.3 2003/09/22 02:29:03 nick Exp $</small>
@


1.3
log
@
From Joel Knight: changes formatting so that all keywords are
in <i>, all literals are in <tt>, etc.  Excess man page links removed.
No words were changed.
@
text
@d49 1
a49 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+3.3"
d56 1
a56 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ksh&amp;sektion=1&amp;manpath=OpenBSD+3.3"
d58 1
a58 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=csh&amp;sektion=1&amp;manpath=OpenBSD+3.3"
d61 1
a61 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+3.3"
d72 1
a72 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+3.3"
d105 1
a105 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=syslogd&amp;sektion=8&amp;manpath=OpenBSD+3.3"
d114 1
a114 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+3.3"
d194 1
a194 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sshd&amp;sektion=8&amp;manpath=OpenBSD+3.3"
d203 1
a203 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=chsh&amp;sektion=1&amp;manpath=OpenBSD+3.3"
d205 1
a205 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8&amp;manpath=OpenBSD+3.3"
d207 1
a207 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=useradd&amp;sektion=8&amp;manpath=OpenBSD+3.3"
d209 1
a209 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=usermod&amp;sektion=8&amp;manpath=OpenBSD+3.3"
d213 1
a213 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=login.conf&amp;sektion=5&amp;manpath=OpenBSD+3.3"
d239 1
a239 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+3.3"
d359 1
a359 1
<small>$OpenBSD: authpf.html,v 1.2 2003/09/16 01:23:49 nick Exp $</small>
@


1.2
log
@
Grammar and punctuation clean up, from Joel Knight.
Only a very few words changed.
@
text
@d15 2
d359 1
a359 1
<small>$OpenBSD: authpf.html,v 1.1 2003/06/29 20:20:11 nick Exp $</small>
@


1.1
log
@
New article on authpf.  Written by Joel Knight, with small amounts of
feedback from me.
@
text
@d88 1
a88 1
<li>Allowing workers from home, on the road, etc access to resources on
d91 1
a91 1
resources (i.e., their own desktop) based on the username they
d101 1
a101 1
successfully, as well as the start and end times of their login session,
d111 1
a111 1
complete description of authpf configuration please refer to the
d336 1
a336 1
The idea behind the main ruleset is: block everything and allow the
d357 1
a357 1
<small>$OpenBSD$</small>
@

