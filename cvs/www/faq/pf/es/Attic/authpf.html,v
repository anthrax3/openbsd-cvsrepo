head	1.9;
access;
symbols;
locks; strict;
comment	@# @;


1.9
date	2014.04.01.17.14.10;	author nick;	state dead;
branches;
next	1.8;

1.8
date	2011.03.13.07.16.15;	author ajacoutot;	state Exp;
branches;
next	1.7;

1.7
date	2004.08.31.16.10.23;	author saad;	state Exp;
branches;
next	1.6;

1.6
date	2004.01.04.22.29.12;	author horacio;	state Exp;
branches;
next	1.5;

1.5
date	2003.11.17.19.44.24;	author horacio;	state Exp;
branches;
next	1.4;

1.4
date	2003.09.27.14.55.54;	author horacio;	state Exp;
branches;
next	1.3;

1.3
date	2003.09.20.07.00.26;	author horacio;	state Exp;
branches;
next	1.2;

1.2
date	2003.07.13.13.11.41;	author jufi;	state Exp;
branches;
next	1.1;

1.1
date	2003.07.04.22.43.46;	author jufi;	state Exp;
branches;
next	;


desc
@@


1.9
log
@
Abandon translations, per deraadt@@ and ajacoutot@@.
@
text
@<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>PF: Authpf: shell de usuario para pasarelas
de autenticación</title>
<link rev="made" href="mailto:www@@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name="resource-type" content="document">
<meta name="description"   content="the OpenBSD FAQ page">
<meta name="keywords"      content="openbsd,faq,pf">
<meta name="distribution"  content="global">
</head>

<!--
Copyright (c) 2003-2007 Joel Knight <enabled@@myrealbox.com>

Permission to use, copy, modify, and distribute this documentation for
any purpose with or without fee is hereby granted, provided that the
above copyright notice and this permission notice appear in all copies.

THE DOCUMENTATION IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL
WARRANTIES WITH REGARD TO THIS DOCUMENTATION INCLUDING ALL IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE
AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL
DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR
PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS DOCUMENTATION
-->

<body bgcolor="#ffffff" text="#000000">
<!-- Passes validator.w3.org, please keep it this way;
please, use a max of 72 chars per line -->

<a href="../../../es/index.html">
<img alt="[OpenBSD]" height=30 width=141 src="../../../images/smalltitle.gif" border="0">
</a>
<p>
[<a href="ftp.html">Anterior: Cuestiones relacionadas con FTP</a>]
[<a href="index.html">Contenido</a>]
[<a href="carp.html">Siguiente: Redundancia de cortafuegos con CARP 
y pfsync</a>]

<h1><font color="#e00000">PF: authpf: shell de usuario para pasarelas
de autenticación</font></h1>

<hr>

<h3>Índice de contenidos</h3>
<ul>
<li><a href="#intro">Introducción</a>
<li><a href="#config">Configuración</a>
        <ul>
	<li><a href="#enable">Activación de authpf</a>
        <li><a href="#linkmain">Cómo enlazar authpf en el grupo
		de reglas principal</a>
        <li><a href="#loadrules">Configuración de las reglas
		cargadas</a>
        <li><a href="#acl">Listas de Control de Acceso</a> 
	<li><a href="#message">Mostrar un mensaje de inicio de sesión</a>
	<li><a href="#shell">Asignar authpf como
		shell de usuario</a>
        </ul>
<li><a href="#loginclass">Creación de una clase de inicio de sesión authpf</a>
<li><a href="#wholog">Cómo ver quién está conectado al sistema</a>
<li><a href="#example">Ejemplo</a>
</ul>

<hr>

<a name="intro"></a>
<h2>Introducción</h2>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+4.8"
>Authpf(8)</a> es una <i>shell</i> ("intérprete de órdenes") para pasarelas de
autenticación.  Una pasarela de autenticación es como una
pasarela de red normal (también llamada enrutador), con la
diferencia que los usuarios se deben autenticar ante la pasarela antes
de que se permita que pase el tráfico a través de
esta.  Cuando se configura el intérprete de un usuario
para que éste sea <tt>/usr/sbin/authpf</tt> (o sea, en lugar de
configurarlo como
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ksh&amp;sektion=1"
>ksh(1)</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=csh&amp;sektion=1"
>csh(1)</a>, o cualquier otro intérprete)
y el usuario ingresa en el sistema usando SSH, authpf realiza los
cambios necesarios en el grupo de reglas activo de
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+4.8"
>pf(4)</a>,
de modo que el tráfico del usuario pase a través del
filtro y/o sea traducido usando Traducción de Direcciones de Red (NAT) 
o redireccionamiento.  Una vez que el usuario sale del sistema o
que se desconecta la sesión, authpf elimina cualquier regla que
haya sido cargada por el usuario y termina cualquier conexión de
estado que haya dejado abierta el usuario.  De esta forma, el
tráfico generado por el usuario sólo podrá pasar a
través de la pasarela mientras el usuario mantenga abierta su
sesión de SSH.

<p>
Authpf carga un grupo de reglas de usuario en un 
<a href="anchors.html">punto de anclaje</a> único. 
Este anclaje es nombrado por la combinación el 
nombre de usuario UNIX y el identificador del proceso authpf 
en el formato "<tt>username(PID)</tt>".
Cada anclaje de usuario se almacena dentro del anclaje 
<tt>authpf</tt> que es a su vez anclado en el conjunto de reglas principal. 
La "ruta de anclaje completa", se convierte entonces en:

<blockquote>
<tt>
<i>conjunto_de_reglas_principal</i>/authpf/<i>nombre_usuario</i>(<i>PID</i>)
</tt>
</blockquote>

<p>
Las reglas que authpf carga pueden configurarse por usuario
o bien globalmente.

<p>
Algunos ejemplos de usos de authpf son:
<ul>
<li>Requerir a los usuarios que se autentiquen antes de permitir el
acceso desde Internet.
<li>Otorgar a ciertos usuarios, como los administradores, acceso a zonas
restringidas de la red.
<li>Permitir que sólo aquellos usuarios que sean conocidos puedan
acceder al resto de la red, o a Internet desde un segmento de una red
inalámbrica.
<li>Permitir que los usuarios puedan acceder desde sus casas, o mientras
estén de viaje, a recursos existentes dentro de la red de la
empresa.  Los usuarios que se encuentren físicamente fuera de la
oficina no sólo podrán abrir un acceso a la red de la
empresa, sino que también podrán ser redireccionados a
recursos concretos (por ejemplo, a su propio escritorio)
basándose en el nombre de usuario con el que se autentiquen.
<li>En un sitio como puede ser una biblioteca, u otro con terminales de
Internet públicas, se puede configurar PF para permitir un acceso
limitado a Internet a usuarios anónimos que entren como
invitados. Authpf puede entonces utilizarse para proveer acceso completo
a usuarios registrados.
</ul>

<p>
Authpf registra el nombre de usuario y la dirección IP de cada
usuario que se autentica con éxito, además de
también registrar el inicio y el final de sus sesiones de
ingreso mediante
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=syslogd&amp;sektion=8"
>syslogd(8)</a>.
Con el uso de esta información, un administrador puede determinar
quién ha ingresado en el sistema y cuándo, y
también calcular y pedir cuentas a los usuarios por el 
tráfico de red utilizado.

<a name="config"></a>
<h2>Configuración</h2>
<p>
Los pasos básicos necesarios para configurar authpf se
señalan a continuación.  Para una descripción
completa de la configuración de authpf, véase la
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+4.8"
>página de manual de authpf</a>.

<a name="enable"></a>
<h3>Activación de authpf</h3>

<p>
Authpf no se ejecutará si no está presente 
el fichero de configuración <tt>/etc/authpf/authpf.conf</tt>.
El fichero puede estar vacío (tamaño cero) pero, a menos que  
esté presente, authpf se cerrará inmediatamente después de que un 
usuario se autentique correctamente.

<p>
Las siguientes directivas de configuración pueden colocarse
en <tt>authpf.conf</tt>:

<ul>
<li><tt>anchor=<i>nombre</i></tt> - Use el nombre de 
<a href="anchors.html">anclaje</a> especificado en lugar de "authpf".
<li><tt>table=<i>nombre</i></tt> - Use el nombre de 
<a href="tables.html">tabla</a> en lugar de "authpf_users".
</ul>

<a name="linkmain"></a>
<h3>Cómo enlazar authpf en el grupo de reglas principal</h3>
<p>
Authpf está enlazado en el grupo de reglas principal mediante
una regla de anclaje <tt>anchor</tt>:
<blockquote>
<tt>
anchor "authpf/*"<br>
</tt>
</blockquote>

<p>
Allá donde la regla <tt>anchor</tt> se encuentre dentro del
grupo de reglas, será donde PF se ramificará desde el
grupo de reglas principal para evaluar las reglas de authpf.

<a name="loadrules"></a>
<h3>Configuración de las reglas cargadas</h3>
<p>
Authpf carga sus reglas desde uno de los dos ficheros siguientes:
<ul>
<li><tt>/etc/authpf/users/$USER/authpf.rules</tt>
<li><tt>/etc/authpf/authpf.rules</tt>
</ul>

<p>
El primer fichero contiene las reglas que sólo se cargarán
cuando el usuario <tt>$USER</tt> (sustitúyase por el nombre de
usuario del usuario) ingrese en el sistema.  La configuración
individual por usuario se usa cuando un usuario específico, como
un administrador, requiere un grupo de reglas diferente al grupo
predeterminado.  El segundo fichero contiene las reglas predeterminadas
que se cargarán para cualquier usuario que no tenga su propio
fichero <tt>authpf.rules</tt>.  Si existe este fichero específico
PARA el usuario, se anulará el fichero predeterminado.  Para que
funcione authpf, como mínimo debe existir uno de los ficheros.

<p>
Las reglas tienen la misma sintaxis que en cualquier otro grupo 
de reglas de PF, pero con una excepción:
authpf permite el uso de dos macros predefinidas:
<ul>
<li><tt>$user_ip</tt> - la dirección IP del usuario que ha
ingresado en el sistema
<li><tt>$user_id</tt> - el nombre de usuario del usuario que ha
ingresado en el sistema
</ul>

<p>
La práctica recomendada es usar la macro <tt>$user_ip</tt> para
que sólo se permita el paso a través de la pasarela al
tráfico originado desde la máquina del usuario que se ha
autenticado.

<p>
Además de la macro <tt>$user_ip</tt>, authpf hará uso de la
tabla <tt>authpf_users</tt> (si existe) para almacenar las
direcciones IP de todos los usuarios autenticados.
Asegúrese de definir la tabla antes de usarla:

<blockquote>
<tt>
table &lt;authpf_users&gt; persist<br>
pass in on $ext_if proto tcp from &lt;authpf_users&gt; \<br>
&nbsp;&nbsp;&nbsp;&nbsp;to port smtp
</tt>
</blockquote>

Esta tabla solo debe usarse en reglas que se pretendan aplicar 
a todos los usuarios autenticados.

<a name="acl"></a>
<h3>Listas de Control de Acceso</h3>
<p>
Se puede evitar que ciertos usuarios utilicen authpf creando un fichero
con el nombre de cada uno de los usuarios a los que se quiera denegar el
acceso, dentro del directorio <tt>/etc/authpf/banned/</tt>.  El
contenido del fichero es lo que se mostrará a los usuarios antes
de que authpf los desconecte.  Esto ofrece un modo sencillo de notificar
al usuario el motivo por el que se le impide el acceso, y con
quién debe contactar para que se le vuelva a otorgar acceso.

<p>
Y a la inversa, también es posible permitir el acceso sólo
a ciertos usuarios añadiendo sus nombres de usuario al fichero
<tt>/etc/authpf/authpf.allow</tt>.  Si no existe este fichero o si el
contenido de este fichero es un asterisco (<tt>*</tt>), entonces authpf
permitirá el acceso a cualquier usuario que se autentique con
éxito mediante SSH, siempre y cuando no exista una
prohibición explícita para el usuario.

<p>
Si authpf no puede determinar si un nombre de usuario tiene el acceso
permitido o denegado, mostrará un breve mensaje y luego
desconectará al usuario.  Una entrada en
<tt>/etc/authpf/banned/</tt> siempre tiene precedencia y anula otra
entrada en <tt>/etc/authpf/authpf.allow</tt>.

<a name="message"></a>
<h3>Mostrar un mensaje de inicio de sesión</h3>

<p>
Cada vez que un usuario se autentica correctamente en
authpf, se muestra un mensaje que indica que el usuario se ha 
autenticado: 

<blockquote>
<tt>
Hello charlie. You are authenticated from host "64.59.56.140"
</tt>
</blockquote>

<p>
Este mensaje puede ser complementado añadiendo un mensaje 
personalizado en <tt>/etc/authpf/authpf.message</tt>.  
El contenido de este fichero se mostrará después del mensaje 
de bienvenida por defecto.

<a name="shell"></a>
<h3>Asignar authpf como shell de usuario</h3>
<p>
Para que authpf funcione debe ser asignado como el intérprete
(<i>shell</i>) de ingreso del usuario.  Cuando el usuario se autentica
con éxito a
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sshd&amp;sektion=8"
>sshd(8)</a>,
authpf se ejecuta como shell del usuario;  entonces
comprueba si el usuario tiene permiso para usar authpf, carga las reglas
desde el fichero apropiado, etc.

<p>
Existen un par de formas para asignar authpf como el intérprete
del usuario:
<ol>
<li>Manualmente para cada usuario utilizando
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=chsh&amp;sektion=1"
>chsh(1)</a>, 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8"
>vipw(8)</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=useradd&amp;sektion=8"
>useradd(8)</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=usermod&amp;sektion=8"
>usermod(8)</a>, etc.
<li>Asignando usuarios a una clase de inicio de sesión y cambiando la
opción de clase <tt>shell</tt> en
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=login.conf&amp;sektion=5"
><tt>/etc/login.conf</tt></a>.
</ol>

<a name="loginclass"></a>
<h2>Creación de una clase de inicio de sesión authpf</h2>
Cuando se utiliza authpf en un sistema que tiene cuentas de usuario normales
y cuentas de usuarios de authpf, puede ser interesante utilizar una clase de 
inicio de sesión separada para los usuarios authpf.
Esto permite rewlizar globalmente ciertos cambios en estas cuentas, así
como emplazar distintas políticas en cuentas normales y cuentas authpf.
Algunos ejemplos de las políticas que pueden establecerse:


<ul>
<li><b>shell</b> - Especifica una shell de inicio de sesión de usuario.
Puede usarse para forzar una shell de usuario  <tt>authpf</tt>, 
independendientemente de la entrada en la base de datos de 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=passwd&amp;sektion=5"
>passwd(5)</a>. 
<li><b>welcome</b> - Especifica qué fichero
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=motd&amp;sektion=5"
>motd(5)</a> mostrar cuando un usuario inicia sesión. Esto es útil
para mostrar mensajes solo relevantes para los usuarios authpf.  
</ul>

<p>
Las clases de inicio de sesión se crean en el fichero
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=login.conf&amp;sektion=5"
>login.conf(5)</a>.
OpenBSD incluye una clase de inicio de sesión definida así: 

<blockquote>
<tt>
authpf:\<br>
&nbsp;&nbsp;&nbsp;&nbsp;:welcome=/etc/motd.authpf:\<br>
&nbsp;&nbsp;&nbsp;&nbsp;:shell=/usr/sbin/authpf:\<br>
&nbsp;&nbsp;&nbsp;&nbsp;:tc=default:
</tt>
</blockquote>

<p>
Los usuarios son asignados a una clase de inicio de sesión mediante 
la edición del campo <tt>class</tt> de la entrada de usuario en la 
base de datos passwd(5). Una forma de hacerlo es con la orden 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=chsh&amp;sektion=1"
>chsh(1)</a>.

<a name="wholog"></a>
<h2>Cómo ver quién está conectado al sistema</h2>
<p>
Una vez que un usuario ha ingresado con éxito y que authpf ha
ajustado las reglas de PF, authpf cambia el título de su proceso
para indicar el nombre de usuario y la dirección IP del usuario:
<pre>
    # ps -ax | grep authpf
    23664 p0  Is+     0:00.11 -authpf: charlie@@192.168.1.3 (authpf)
</pre>

<p>
En este ejemplo, el usuario <tt>charlie</tt> está conectado desde
la máquina 192.168.1.3.  Enviando una señal de SIGTERM al
proceso de authpf, el usuario puede forzar la terminación de la
conexión.  Authpf también elimina cualquier regla que se
haya cargado para el usuario, y termina cualquier conexión de
estado que tenga abierta el usuario.
<pre>
    # kill -TERM 23664
</pre>

<a name="example"></a>
<h2>Ejemplo</h2>
<p>
En el siguiente ejemplo se usa authpf en una pasarela OpenBSD, para
autenticar a usuarios en una red inalámbrica que forma parte de
otra red más grande del campus.  Una vez que un usuario se ha
autenticado, asumiendo que no se encuentre en la lista de usuarios
prohibidos, se le permitirá usar SSH y navegar por la web
(incluidos sitios web seguros), además de acceder a
cualquiera de los servidores de DNS del campus.

<p>
El fichero <tt>/etc/authpf/authpf.rules</tt> contiene las siguientes
reglas:<br>
<br>

<table border=0 width="650">
<tr><td nowrap bgcolor="#EEEEEE">
<pre>
wifi_if = "wi0"

pass in quick on $wifi_if proto tcp from $user_ip to port { ssh, http, \
   https }
</pre>
</td></tr>
</table>

<p>
El usuario administrador <tt>charlie</tt> necesita tener acceso a los
servidores de SMTP y POP3 del campus, además de poder navegar por
la web y de usar SSH.  Para ello se configuran las siguientes
reglas en <tt>/etc/authpf/users/charlie/authpf.rules</tt>:<br>
<br>

<table border=0 width="650">
<tr><td nowrap bgcolor="#EEEEEE">
<pre>
wifi_if = "wi0"
smtp_server = "10.0.1.50"
pop3_server = "10.0.1.51"

pass in quick on $wifi_if \
   proto tcp from $user_ip to $smtp_server port smtp
pass in quick on $wifi_if \
   proto tcp from $user_ip to $pop3_server port pop3
pass in quick on $wifi_if \
   proto tcp from $user_ip to port { ssh, http, https }
</pre>
</td></tr>
</table>

<p>
El grupo de reglas principal, que se encuentra en el fichero
<tt>/etc/pf.conf</tt>, se configura como sigue:<br>
<br>

<table border=0 width="650">
<tr><td nowrap bgcolor="#EEEEEE">
<pre>
# macros
wifi_if = "wi0"
ext_if  = "fxp0"
dns_servers = "{ 10.0.1.56, 10.0.2.56 }"

table &lt;authpf_users&gt; persist

# filtrado
block drop all

pass out quick on $ext_if inet proto { tcp, udp, icmp } \
   from { $wifi_if:network, $ext_if }

pass in quick on $wifi_if inet proto tcp \
   from $wifi_if:network to $wifi_if port ssh

pass in quick on $wifi_if inet proto { tcp, udp } \
   from &lt;authpf_users&gt; to $dns_servers port domain

anchor "authpf/*" in on $wifi_if
</pre>
</td></tr>
</table>

<p>
El grupo de reglas es muy simple y realiza las siguientes funciones:
<ul>
<li>Bloquea todo (denegación predeterminada).
<li>Permite el paso del tráfico saliente de TCP, UDP, y ICMP a la
interfaz externa desde la red inalámbrica y desde la propia pasarela.
<li>Permite el paso del tráfico entrante de SSH desde la red
inalámbrica con destino a la pasarela.  Esta regla es necesaria
para permitir que ingresen los usuarios.
<li>Permite el paso de consultas entrantes de DNS de todos los usuarios 
authpf autenticados a los servidores DNS del campus.
<li>Crea el punto de anclaje "authpf" para el tráfico
entrante en la interfaz inalámbrica.
</ul>

<p>
La idea detrás del grupo de reglas principal es bloquear todo y
permitir que pase la menor cantidad de tráfico que sea
posible.  El tráfico es libre de salir a la interfaz externa,
pero tiene bloqueada la entrada a la interfaz inalámbrica debido
a la política de denegación predeterminada.  Una vez que
el usuario se autentica, se permite que su tráfico pase a la
interfaz inalámbrica y desde allí, a través de la
pasarela, al resto de la red.  Se usa la clave <tt>quick</tt> de forma
consistente, para que PF no tenga que evaluar cada uno de los subgrupos
de reglas con nombre cada vez que pase a través de la pasarela
una nueva conexión.

<p>
[<a href="ftp.html">Anterior: Cuestiones relacionadas con FTP</a>]
[<a href="index.html">Contenido</a>]
[<a href="carp.html">Siguiente: Redundancia de cortafuegos con CARP 
y pfsync</a>]

<p>
<hr>
<a href="index.html"><img height="24" width="24" src="../../../images/back.gif" border="0" alt="[back]"></a> 
<a href="mailto:www@@openbsd.org">www@@openbsd.org</a>
<br>
<small>
<!--
Originally [OpenBSD: authpf.html,v 1.28 ]<br>
$Translation: authpf.html,v 1.8 2011/03/12 17:05:50 mvidal Exp $<br>
-->
$OpenBSD: authpf.html,v 1.8 2011/03/13 07:16:15 ajacoutot Exp $
</small>

</body>
</html>
@


1.8
log
@Sync with Steelix CVS
@
text
@d528 1
a528 1
$OpenBSD$
@


1.7
log
@sync with Steelix CVS
@
text
@d4 2
a5 2
<title>PF: Authpf: Shell de Usuario para la Autenticaci&oacute;n
de Pasarelas</title>
d8 3
a10 4
<meta http-equiv="Content-Language" content="es">
<meta name="resource-type" content="documento">
<meta name="description"   content="Guía de PF">
<meta name="keywords"      content="openbsd,faq,preguntas frecuentes,guía,pf">
d15 1
a15 1
Copyright (c) 2003, 2004 Joel Knight <enabled@@myrealbox.com>
a30 1

d32 2
d35 3
a37 1
<img alt="[OpenBSD]" height="30" width="141" src="../../../images/smalltitle.gif">
d39 1
a39 1
[<a href="ftp.html">Anterior: Cuestiones Relacionadas con FTP</a>]
d41 2
a42 2
[<a href="example1.html">Siguiente: Ejemplo: Cortafuegos para Red en
Casa u Oficina</a>]
d44 2
a45 2
<h1><font color="#e00000">PF: Authpf: <i>Shell</i> de Usuario para la
Autenticaci&oacute;n de Pasarelas</font></h1>
d49 1
a49 1
<h3>&Iacute;ndice de Contenidos</h3>
d51 2
a52 2
<li><a href="#intro">Introducci&oacute;n</a>
<li><a href="#config">Configuraci&oacute;n</a>
d54 9
a62 7
        <li><a href="#linkmain">C&oacute;mo Enlazar Authpf en el Grupo
		de Reglas Principal</a>
        <li><a href="#loadrules">Configuraci&oacute;n de las Reglas
		Cargadas</a>
        <li><a href="#acl">ACL, Listas de Control de Acceso</a>
		<li><a href="#shell">C&oacute;mo Asignar Authpf como
		Int&eacute;rprete de Usuario</a>
d64 2
a65 2
<li><a href="#wholog">C&oacute;mo Ver Qui&eacute;n Hay en el Sistema</a>
<li><a href="#moreinfo">M&aacute;s Informaci&oacute;n</a>
d72 5
a76 5
<h2>Introducci&oacute;n</h2>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+3.5">Authpf(8)</a>
es un int&eacute;rprete (<i>shell</i>) para pasarelas de
autenticaci&oacute;n.  Una pasarela de autenticaci&oacute;n es como una
pasarela de red normal (tambi&eacute;n llamada enrutador), con la
d78 3
a80 3
de que se permita que pase el tr&aacute;fico a trav&eacute;s de
&eacute;sta.  Cuando se configura el int&eacute;rprete de un usuario
para que &eacute;ste sea <tt>/usr/sbin/authpf</tt> (o sea, en lugar de
d82 4
a85 2
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ksh&amp;sektion=1&amp;manpath=OpenBSD+3.5">ksh(1)</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=csh&amp;sektion=1&amp;manpath=OpenBSD+3.5">csh(1)</a>, o cualquier otro int&eacute;rprete)
d88 7
a94 6
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+3.5">pf(4)</a>,
de modo que el tr&aacute;fico del usuario pase a trav&eacute;s del
filtro y/o sea traducido usando <a href="nat.html">nat</a> o
<a href="rdr.html">rdr</a>.  Una vez que el usuario sale del sistema o
que se desconecta la sesi&oacute;n, authpf elimina cualquier regla que
haya sido cargada por el usuario y termina cualquier conexi&oacute;n de
d96 23
a118 17
tr&aacute;fico generado por el usuario s&oacute;lo podr&aacute; pasar a
trav&eacute;s de la pasarela mientras el usuario mantenga abierta su
sesi&oacute;n de SSH.

<p>
Authpf altera el grupo de reglas de
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+3.5">pf(4)</a>
a&ntilde;adiendo reglas al <a href="anchors.html#named">grupo de reglas
con nombre</a> que est&eacute; adunto a un <a href="anchors.html">punto
de anclaje</a>.  Cada vez que se autentica un usuario, authpf crea un
nuevo grupo de reglas con nombre y carga en &eacute;ste las reglas
preconfiguradas de
<a href="filter.html">filtros</a>, <a href="nat.html"><tt>nat</tt></a>,
<a href="nat.html#binat"><tt>binat</tt></a>, y
<a href="rdr.html"><tt>rdr</tt></a>.  Las reglas que carga authpf se
pueden configurar de forma individual para cada usuario o de forma
global para todos.
d127 1
a127 1
<li>Permitir que s&oacute;lo aquellos usuarios que sean conocidos puedan
d129 1
a129 1
inal&aacute;mbrica.
d131 4
a134 4
est&eacute;n de viaje, a recursos existentes dentro de la red de la
empresa.  Los usuarios que se encuentren f&iacute;sicamente fuera de la
oficina no s&oacute;lo podr&aacute;n abrir un acceso a la red de la
empresa, sino que tambi&eacute;n podr&aacute;n ser redireccionados a
d136 1
a136 1
bas&aacute;ndose en el nombre de usuario con el que se autentiquen.
d138 4
a141 3
Internet p&uacute;blicas, se puede configurar PF para permitir un acceso
limitado a Internet a usuarios an&oacute;nimos que entren como
invitados.
d145 3
a147 3
Authpf registra el nombre de usuario y la direcci&oacute;n IP de cada
usuario que se autentica con &eacute;xito, adem&aacute;s de
tambi&eacute;n registrar el inicio y el final de sus sesiones de
d149 6
a154 5
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=syslogd&amp;sektion=8&amp;manpath=OpenBSD+3.5">syslogd(8)</a>.
Con el uso de esta informaci&oacute;n, un administrador puede determinar
qui&eacute;n ha ingresado en el sistema y cu&aacute;ndo, y
tambi&eacute;n pedir cuentas a los usuarios por sus sesiones de
tr&aacute;fico en la red.
d157 18
a174 1
<h2>Configuraci&oacute;n</h2>
d176 9
a184 5
Los pasos b&aacute;sicos necesarios para configurar authpf se
se&ntilde;alan a continuaci&oacute;n.  Para una descripci&oacute;n
completa de la configuraci&oacute;n de authpf, v&eacute;ase la
p&aacute;gina del manual de
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+3.5">authpf(8)</a>.
d187 1
a187 1
<h3>C&oacute;mo Enlazar Authpf en el Grupo de Reglas Principal</h3>
d189 2
a190 2
Authpf est&aacute; enlazado en el grupo de reglas principal usando
reglas de anclaje, <tt>anchor</tt>:
d193 1
a193 4
nat-anchor authpf<br>
rdr-anchor authpf<br>
binat-anchor authpf<br>
anchor authpf<br>
d198 3
a200 6
All&aacute; donde las reglas <tt>anchor</tt> se encuentren dentro del
grupo de reglas, ser&aacute; donde PF se ramificar&aacute; desde el
grupo de reglas principal para evaluar las reglas de authpf.  No es
necesario que est&eacute;n presentes las cuatro reglas <tt>anchor</tt>;
por ejemplo, si no se ha configurado authpf para que cargue cualquier
regla de <tt>nat</tt>, se puede omitir la regla <tt>nat-anchor</tt>.
d203 1
a203 1
<h3>Configuraci&oacute;n de las Reglas Cargadas</h3>
d212 4
a215 4
El primer fichero contiene las reglas que s&oacute;lo se cargar&aacute;n
cuando el usuario <tt>$USER</tt> (sustit&uacute;yase por el nombre de
usuario del usuario) ingrese en el sistema.  La configuraci&oacute;n
individual por usuario se usa cuando un usuario espec&iacute;fico, como
d218 4
a221 4
que se cargar&aacute;n para cualquier usuario que no tenga su propio
fichero <tt>authpf.rules</tt>.  Si existe este fichero espec&iacute;fico
PARA el usuario, se anular&aacute; el fichero predeterminado.  Para que
funcione authpf, como m&iacute;nimo debe existir uno de los ficheros.
d224 3
a226 3
Las reglas de filtrado y traducci&oacute;n tienen la misma sintaxis que
en cualquier otro grupo de reglas de PF, pero con una excepci&oacute;n:
Authpf permite el uso de dos macros predefinidas:
d228 1
a228 1
<li><tt>$user_ip</tt> - la direcci&oacute;n IP del usuario que ha
d235 3
a237 3
La pr&aacute;ctica recomendada es usar la macro <tt>$user_ip</tt> para
que s&oacute;lo se permita el paso a trav&eacute;s de la pasarela al
tr&aacute;fico originado desde la m&aacute;quina del usuario que se ha
d240 17
d258 1
a258 1
<h3>ACL, Listas de Control de Acceso</h3>
d263 1
a263 1
contenido del fichero es lo que se mostrar&aacute; a los usuarios antes
d266 1
a266 1
qui&eacute;n debe contactar para que se le vuelva a otorgar acceso.
d269 2
a270 2
Y a la inversa, tambi&eacute;n es posible permitir el acceso s&oacute;lo
a ciertos usuarios a&ntilde;adiendo sus nombres de usuario al fichero
d273 3
a275 3
permitir&aacute; el acceso a cualquier usuario que se autentique con
&eacute;xito mediante SSH, siempre y cuando no exista una
prohibici&oacute;n expl&iacute;cita para el usuario.
d279 2
a280 2
permitido o denegado, mostrar&aacute; un breve mensaje y luego
desconectar&aacute; al usuario.  Una entrada en
d284 20
d305 1
a305 1
<h3>C&oacute;mo Asignar Authpf como Int&eacute;rprete de Usuario</h3>
d307 1
a307 1
Para que authpf funcione debe ser asignado como el int&eacute;rprete
d309 4
a312 3
con &eacute;xito a
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sshd&amp;sektion=8&amp;manpath=OpenBSD+3.5">sshd(8)</a>,
authpf se ejecuta como el int&eacute;rprete del usuario;  entonces
d317 1
a317 1
Existen un par de formas para asignar authpf como el int&eacute;rprete
d321 12
a332 7
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=chsh&amp;sektion=1&amp;manpath=OpenBSD+3.5">chsh(1)</a>, 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8&amp;manpath=OpenBSD+3.5">vipw(8)</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=useradd&amp;sektion=8&amp;manpath=OpenBSD+3.5">useradd(8)</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=usermod&amp;sektion=8&amp;manpath=OpenBSD+3.5">usermod(8)</a>, etc.
<li>Asignando usuarios a una clase de ingreso y cambiando la
opci&oacute;n de clase <tt>shell</tt> en
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=login.conf&amp;sektion=5&amp;manpath=OpenBSD+3.5"><tt>/etc/login.conf</tt></a>.
d335 44
d380 1
a380 1
<h2>C&oacute;mo Ver Qui&eacute;n Hay en el Sistema</h2>
d382 3
a384 3
Una vez que un usuario ha ingresado con &eacute;xito y que authpf ha
ajustado las reglas de PF, authpf cambia el t&iacute;tulo de su proceso
para indicar el nombre de usuario y la direcci&oacute;n IP del usuario:
d391 5
a395 5
En este ejemplo, el usuario <tt>charlie</tt> est&aacute; conectado desde
la m&aacute;quina 192.168.1.3.  Enviando una se&ntilde;al de SIGTERM al
proceso de authpf, el usuario puede forzar la terminaci&oacute;n de la
conexi&oacute;n.  Authpf tambi&eacute;n elimina cualquier regla que se
haya cargado para el usuario, y termina cualquier conexi&oacute;n de
a400 7
<a name="moreinfo"></a>
<h2>M&aacute;s Informaci&oacute;n</h2>
<p>
Para una completa descripci&oacute;n de la operaci&oacute;n de authpf,
v&eacute;ase la p&aacute;gina del manual de
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+3.5">authpf(8)</a>.

d405 2
a406 2
autenticar a usuarios en una red inal&aacute;mbrica que forma parte de
otra red m&aacute;s grande del campus.  Una vez que un usuario se ha
d408 2
a409 2
prohibidos, se le permitir&aacute; usar SSH y navegar por la <i>web</i>
(incluidos sitios <i>web</i> seguros), adem&aacute;s de acceder a
d417 1
a417 1
<table border="0" width="650">
d420 1
a420 2
wifi_if = &quot;wi0&quot;
dns_servers = &quot;{ 10.0.1.56, 10.0.2.56 }&quot;
a421 2
pass in quick on $wifi_if proto udp from $user_ip to $dns_servers \
   port domain keep state
d423 1
a423 1
   https } flags S/SA keep state
d430 2
a431 2
servidores de SMTP y POP3 del campus, adem&aacute;s de poder navegar por
la <i>web</i> y de usar SSH.  Para ello se configuran las siguientes
d435 1
a435 1
<table border="0" width="650">
d438 10
a447 13
wifi_if = &quot;wi0&quot;
smtp_server = &quot;10.0.1.50&quot;
pop3_server = &quot;10.0.1.51&quot;
dns_servers = &quot;{ 10.0.1.56, 10.0.2.56 }&quot;

pass in quick on $wifi_if proto udp from $user_ip to $dns_servers \
   port domain keep state
pass in quick on $wifi_if proto tcp from $user_ip to $smtp_server \
   port smtp flags S/SA keep state
pass in quick on $wifi_if proto tcp from $user_ip to $pop3_server \
   port pop3 flags S/SA keep state
pass in quick on $wifi_if proto tcp from $user_ip to port { ssh, http, \
   https } flags S/SA keep state
d457 1
a457 1
<table border="0" width="650">
d461 3
a463 2
wifi_if = &quot;wi0&quot;
ext_if  = &quot;fxp0&quot;
d465 1
a465 1
scrub in all
d467 1
a467 1
# filtros
d470 5
a474 4
pass out quick on $ext_if proto tcp from $wifi_if:network flags S/SA \
   modulate state
pass out quick on $ext_if proto { udp, icmp } from $wifi_if:network \
   keep state
d476 2
a477 2
pass in quick on $wifi_if proto tcp from $wifi_if:network to $wifi_if \
   port ssh flags S/SA keep state
d479 1
a479 1
anchor authpf in on $wifi_if
d487 5
a491 5
<li>Bloquea todo (denegaci&oacute;n predeterminada).
<li>Permite el paso del tr&aacute;fico saliente de TCP, UDP, y ICMP a la
interfaz externa desde la red inal&aacute;mbrica.
<li>Permite el paso del tr&aacute;fico entrante de SSH desde la red
inal&aacute;mbrica con destino a la pasarela.  Esta regla es necesaria
d493 4
a496 2
<li>Crea el punto de anclaje &quot;authpf&quot; para el tr&aacute;fico
entrante en la interfaz inal&aacute;mbrica.
d500 7
a506 7
La idea detr&aacute;s del grupo de reglas principal es:  bloquear todo y
permitir que pase la m&iacute;nima cantidad de tr&aacute;fico que sea
posible.  El tr&aacute;fico es libre de salir a la interfaz externa,
pero tiene bloqueada la entrada a la interfaz inal&aacute;mbrica debido
a la pol&iacute;tica de denegaci&oacute;n predeterminada.  Una vez que
el usuario se autentica, se permite que su tr&aacute;fico pase a la
interfaz inal&aacute;mbrica y desde all&iacute;, a trav&eacute;s de la
d509 2
a510 2
de reglas con nombre cada vez que pase a trav&eacute;s de la pasarela
una nueva conexi&oacute;n.
d513 1
a513 1
[<a href="ftp.html">Anterior: Cuestiones Relacionadas con FTP</a>]
d515 2
a516 2
[<a href="example1.html">Siguiente: Ejemplo: Cortafuegos para Red en
Casa u Oficina</a>]
d520 1
a520 1
<a href="index.html"><img height="24" width="24" src="../../../images/back.gif" border="0" alt="[&Iacute;ndice]"></a> 
d524 5
a528 3
Originally [OpenBSD: authpf.html,v 1.7 ]<br>
$OpenBSD$<br>
$Translation: authpf.html,v 1.7 2004/08/30 17:02:17 santana Exp $
d530 1
d532 1
a532 1
</html> 
@


1.6
log
@Sync with Steelix CVS
@
text
@d4 1
a4 1
<title>PF: Authpf: <i>Shell</i> de Usuario para la Autenticaci&oacute;n
a12 1
<meta name="copyright"     content="Este documento es copyright 2003-2004 de OpenBSD.">
d15 18
d39 1
a39 1
[<a href="example1.html">Siguiente: Ejemplo #1: Cortafuegos para Red en
d69 1
a69 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+3.4">Authpf(8)</a>
d78 2
a79 2
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ksh&amp;sektion=1&amp;manpath=OpenBSD+3.4">ksh(1)</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=csh&amp;sektion=1&amp;manpath=OpenBSD+3.4">csh(1)</a>, o cualquier otro int&eacute;rprete)
d82 1
a82 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+3.4">pf(4)</a>,
d95 1
a95 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+3.4">pf(4)</a>
d135 1
a135 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=syslogd&amp;sektion=8&amp;manpath=OpenBSD+3.4">syslogd(8)</a>.
d148 1
a148 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+3.4">authpf(8)</a>.
d243 1
a243 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sshd&amp;sektion=8&amp;manpath=OpenBSD+3.4">sshd(8)</a>,
d253 4
a256 4
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=chsh&amp;sektion=1&amp;manpath=OpenBSD+3.4">chsh(1)</a>, 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8&amp;manpath=OpenBSD+3.4">vipw(8)</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=useradd&amp;sektion=8&amp;manpath=OpenBSD+3.4">useradd(8)</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=usermod&amp;sektion=8&amp;manpath=OpenBSD+3.4">usermod(8)</a>, etc.
d259 1
a259 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=login.conf&amp;sektion=5&amp;manpath=OpenBSD+3.4"><tt>/etc/login.conf</tt></a>.
d289 1
a289 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+3.4">authpf(8)</a>.
d407 1
a407 1
[<a href="example1.html">Siguiente: Ejemplo #1: Cortafuegos para Red en
d416 1
a416 1
Originally [OpenBSD: authpf.html,v 1.5 ]<br>
d418 1
a418 1
$Translation: authpf.html,v 1.6 2004/01/04 21:32:07 horacio Exp $
@


1.5
log
@Sync with Steelix CVS
@
text
@d13 1
a13 1
<meta name="copyright"     content="Este documento es copyright 2003 de OpenBSD.">
d399 1
a399 1
Originally [OpenBSD: authpf.html,v 1.4 ]<br>
d401 1
a401 1
$Translation: authpf.html,v 1.5 2003/11/17 19:22:08 horacio Exp $
@


1.4
log
@sync with steelix cvs
@
text
@d52 1
a52 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+3.3">Authpf(8)</a>
d61 2
a62 2
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ksh&amp;sektion=1&amp;manpath=OpenBSD+3.3">ksh(1)</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=csh&amp;sektion=1&amp;manpath=OpenBSD+3.3">csh(1)</a>, o cualquier otro int&eacute;rprete)
d65 1
a65 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+3.3">pf(4)</a>,
d78 1
a78 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+3.3">pf(4)</a>
d118 1
a118 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=syslogd&amp;sektion=8&amp;manpath=OpenBSD+3.3">syslogd(8)</a>.
d131 1
a131 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+3.3">authpf(8)</a>.
d226 1
a226 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sshd&amp;sektion=8&amp;manpath=OpenBSD+3.3">sshd(8)</a>,
d236 4
a239 4
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=chsh&amp;sektion=1&amp;manpath=OpenBSD+3.3">chsh(1)</a>, 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8&amp;manpath=OpenBSD+3.3">vipw(8)</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=useradd&amp;sektion=8&amp;manpath=OpenBSD+3.3">useradd(8)</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=usermod&amp;sektion=8&amp;manpath=OpenBSD+3.3">usermod(8)</a>, etc.
d242 1
a242 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=login.conf&amp;sektion=5&amp;manpath=OpenBSD+3.3"><tt>/etc/login.conf</tt></a>.
d272 1
a272 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8&amp;manpath=OpenBSD+3.3">authpf(8)</a>.
d399 1
a399 1
Originally [OpenBSD: authpf.html,v 1.3 ]<br>
d401 1
a401 1
$Translation: authpf.html,v 1.4 2003/09/27 13:46:08 horacio Exp $
@


1.3
log
@sync with steelix cvs
@
text
@d399 1
a399 1
Originally [OpenBSD: authpf.html,v 1.2 2003/09/16 01:23:49 nick Exp ]<br>
d401 1
a401 1
$Translation: authpf.html,v 1.3 2003/09/19 22:10:58 horacio Exp $
@


1.2
log
@sync with steelix translation CVS
@
text
@d399 1
a399 1
Originally [OpenBSD: authpf.html,v 1.1 2003/06/29 20:20:11 nick Exp ]<br>
d401 1
a401 1
$Translation: authpf.html,v 1.2 2003/07/13 12:22:53 horacio Exp $
@


1.1
log
@sync with steelix translation CVS
@
text
@d40 2
a41 2
        <li><a href="#shell">C&oacute;mo Asignar Authpf como una
		<i>Shell</i> de Usuario</a>
d55 1
a55 1
pasarelas de red normal (tambi&eacute;n llamada enrutador) con la
d58 3
a60 2
&eacute;sta.  Cuando se configura la <i>shell</i> de un usuario para que
sea <tt>/usr/sbin/authpf</tt> (o sea, en lugar de configurarla como
d62 1
a62 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=csh&amp;sektion=1&amp;manpath=OpenBSD+3.3">csh(1)</a>, etc... )
d65 1
a65 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+3.3">pf(4)</a>
d71 4
a74 4
estado que haya dejado abierta el usuario.  Debido a esto, el usuario
s&oacute;lo tiene la posibilidad de que pase el tr&aacute;fico a
trav&eacute;s de la pasarela mientras mantenga abierta su sesi&oacute;n
de SSH.
d80 4
a83 3
con nombre</a> ligado a un <a href="anchors.html">punto de anclaje</a>.
Cada vez que se autentica un usuario, authpf crea un nuevo grupo de
reglas con nombre y carga en &eacute;ste las reglas preconfiguradas de
d87 2
a88 1
pueden configurar para cada usuario o de forma global.
d94 1
a94 1
acceso de Internet.
d98 1
a98 1
acceder al resto de la red o a Internet desde un segmento de una red
d100 8
a107 8
<li>Permitir que los usuarios puedan acceder desde sus casas o mientras
est&eacute;n de viaje a recursos en la red de la empresa.  Los usuarios
que se encuentren f&iacute;sicamente fuera de la oficina no s&oacute;lo
podr&aacute;n abrir un acceso a la red red de la empresa, sino que
tambi&eacute;n podr&aacute;n ser redireccionados a recursos concretos
(por ejemplo a su propio escritorio) bas&aacute;ndose en el nombre de
usuario con el que se autentiquen.
<li>En un sitio como puede ser una biblioteca u otro con terminales de
d109 1
a109 1
limitado a Internet a los usuarios an&oacute;nimos que entran como
d121 2
a122 2
tambi&eacute;n pedir cuentas a los usuarios por su tr&aacute;fico en la
red.
d149 5
a153 5
grupo de reglas ser&aacute; donde PF se ramificar&aacute; desde el grupo
de reglas principal para evaluar las reglas de authpf.  No es necesario
que est&eacute;n presentes las cuatro reglas <tt>anchor</tt>;  por
ejemplo, si no se ha configurado authpf para que cargue cualquier regla
de <tt>nat</tt>, la reglas <tt>nat-anchor</tt> se puede omitir.
d158 1
a158 1
Authpf carga sus reglas desde uno de los dos siguientes ficheros:
d173 2
a174 2
para el usuario, se anular&aacute; el fichero predeterminado.  Como
m&iacute;nimo debe existir uno de los ficheros para que funcione authpf.
d189 3
a191 2
que s&oacute;lo permite el paso de tr&aacute;fico a trav&eacute;s de la
pasarela desde la m&aacute;quina del usuario que se ha autenticado.
d197 15
a211 15
en directorio <tt>/etc/authpf/banned/</tt> con el nombre de cada uno de
los usuarios a los que se quiera denegar el acceso.  El contenido del
fichero es lo que se mostrar&aacute; a los usuarios antes de que authpf
los desconecte.  Esto ofrece un modo f&aacute;cil de notificar al
usuario el motivo por el que se le impide el acceso y con qui&eacute;n
debe contactar para que se le vuelva a otorgar acceso.

<p>
Y al contrario, tambi&eacute;n es posible permitir el acceso s&oacute;lo
a ciertos usuarios a&ntilde;adiendo sus nombres de usuario en el fichero
<tt>/etc/authpf/authpf.allow</tt>.  Si no existe este fichero o si hay
un asterisco, &quot;<tt>*</tt>&quot;, en este fichero, entonces authpf
permitir&aacute; el acceso a cualquier usuario que ingrese con
&eacute;xito mediante SSH, siempre y cuando no tenga una
prohibici&oacute;n expl&iacute;cita.
d214 1
a214 1
Si authpf no pudiera determinar si un nombre de usuario tiene el acceso
d217 2
a218 2
<tt>/etc/authpf/banned/</tt> siempre anula una entrada en
<tt>/etc/authpf/authpf.allow</tt>.
d221 1
a221 1
<h3>C&oacute;mo Asignar Authpf como una <i>Shell</i> de Usuario</h3>
d241 1
a241 1
opci&oacute;n <tt>shell</tt> de la clase en
d277 1
a277 1
En el siguiente ejemplo se usa authpf en una pasarela OpenBSD para
d306 1
a306 1
servidores de SMTP y POP3 del campus adem&aacute;s de poder navegar por
d345 1
a345 1
# filter
d362 1
a362 1
El grupo de reglas es muy simple y hace lo siguiente:
d381 5
a385 5
interfaz inal&aacute;mbrica y desde all&iacute; a trav&eacute;s de la
pasarela al resto de la red.  Se usa la clave <tt>quick</tt> de forma
consistente para que PF no tenga que evaluar cada uno de los grupos de
reglas con nombre cada vez que pase a trav&eacute;s de la pasarela una
nueva conexi&oacute;n.
d401 1
a401 1
$Translation: authpf.html,v 1.1 2003/07/01 14:51:47 horacio Exp $
@

