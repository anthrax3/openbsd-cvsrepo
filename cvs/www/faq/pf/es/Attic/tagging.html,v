head	1.5;
access;
symbols;
locks; strict;
comment	@# @;


1.5
date	2014.04.01.17.14.10;	author nick;	state dead;
branches;
next	1.4;

1.4
date	2011.03.04.16.16.15;	author ajacoutot;	state Exp;
branches;
next	1.3;

1.3
date	2004.09.11.08.20.24;	author jufi;	state Exp;
branches;
next	1.2;

1.2
date	2004.01.04.22.29.12;	author horacio;	state Exp;
branches;
next	1.1;

1.1
date	2003.12.03.21.40.57;	author horacio;	state Exp;
branches;
next	;


desc
@@


1.5
log
@
Abandon translations, per deraadt@@ and ajacoutot@@.
@
text
@<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>PF: Marcado de paquetes (filtrado por política)</title>
<link rev="made" href="mailto:www@@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name="resource-type" content="document">
<meta name="description"   content="the OpenBSD FAQ page">
<meta name="keywords"      content="openbsd,faq,pf">
<meta name="distribution"  content="global">
</head>

<!--
Copyright (c) 2003-2007 Joel Knight <enabled@@myrealbox.com>

Permission to use, copy, modify, and distribute this documentation for
any purpose with or without fee is hereby granted, provided that the
above copyright notice and this permission notice appear in all copies.

THE DOCUMENTATION IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL
WARRANTIES WITH REGARD TO THIS DOCUMENTATION INCLUDING ALL IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE
AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL
DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR
PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS DOCUMENTATION
-->

<body bgcolor="#ffffff" text="#000000">
<!-- Passes validator.w3.org, please keep it this way;
please, use a max of 72 chars per line -->

<a href="../../../es/index.html">
<img alt="[OpenBSD]" height="30" width="141" src="../../../images/smalltitle.gif" border="0">
</a>
<p>
[<a href="pools.html">Anterior: Reservas de direcciones y
balanceo de carga</a>]
[<a href="index.html">Contenido</a>]
[<a href="logging.html">Siguiente: Registros de
bitácora</a>]

<p>
<h1><font color="#e00000">PF: Marcado de paquetes (filtrado por política)</font></h1>

<hr>

<h3>Índice de contenidos</h3>
<ul>
<li><a href="#intro">Introducción</a>
<li><a href="#assign">Asignación de etiquetas a los paquetes</a>
<li><a href="#check">Comprobación de las etiquetas aplicadas</a>
<li><a href="#policy">Filtrado por política</a>
<li><a href="#ethernet">Marcado de tramas de Ethernet</a>
</ul>

<hr>

<a name="intro"></a>
<h2>Introducción</h2>
<p>
El marcado de paquetes es una forma de etiquetar paquetes con un
identificador interno que más tarde se puede usar para el
criterio de las reglas de filtrado y traducción.
Mediante el marcado se pueden realizar tareas como la creación de
&laquo;relaciones de confianza&raquo; entre interfaces y determinar 
si los paquetes han sido procesados por las reglas de traducción.
También es posible alejarse del filtrado basado en reglas e
iniciar un filtrado basado en políticas.

<a name="assign"></a>
<h2>Asignación de etiquetas a los paquetes</h2>
<p>
Para añadir una etiqueta a un paquete, hay que usar la clave
<tt>tag</tt>:
<blockquote>
<tt>
pass in on $int_if all tag INTERNAL_NET keep state
</tt>
</blockquote>

<p>
De este modo, la etiqueta <tt>INTERNAL_NET</tt> será añadida
a cualquier paquete que concuerde con la regla anterior.  

<p>
Una etiqueta también puede ser asignada usando una
<a href="macros.html#macros">macro</a>.
Por ejemplo:

<blockquote>
<tt>
name = "INTERNAL_NET"<br>
pass in on $int_if all tag $name
</tt>
</blockquote>

<p>
Hay un conjunto de macros predefinidas que también pueden usarse.
<ul>
<li><tt>$if</tt> - La interfaz
<li><tt>$srcaddr</tt> - La dirección IP de origen
<li><tt>$dstaddr</tt> - La dirección IP de destino
<li><tt>$srcport</tt> - El puerto de origen
<li><tt>$dstport</tt> - El puerto de destino
<li><tt>$proto</tt> - El protocolo
<li><tt>$nr</tt> - El número de la regla
</ul>

<p>
Estas macros son expandidas al momento de cargar las reglas y NO en tiempo
de ejecución.

<p>
El proceso de marcado sigue estas reglas:
<ul>
<li>Las etiquetas son &laquo;adherentes&raquo; (<i>sticky</i>).  
Una vez que una regla concordante aplica una etiqueta a un paquete, 
esta ya no se elimina nunca.  Aunque se puede sustituir por una 
etiqueta diferente.
<li>Debido a la fuerte &laquo;adherencia&raquo; de una etiqueta, 
un paquete puede tener una etiqueta aunque la última regla concordante 
no use la clave <tt>tag</tt>.
<li>A un paquete sólo se le asigna un máximo de una etiqueta
por vez.
<li>Las etiquetas son identificadores <i>internos</i>.  Las etiquetas no se
envían fuera a través de la conexión.
<li>Los nombres de etiquetas pueden tener hasta 63 caracteres.
En OpenBSD 4.0 y versiones anteriores, los nombres de etiqueta están 
limitados a 15 caracteres.
</ul>

<p>
Tomemos el siguiente conjunto de reglas como ejemplo:
<blockquote>
<tt>
(1) pass in on $int_if tag INT_NET<br>
(2) pass in quick on $int_if proto tcp to port 80 tag INT_NET_HTTP<br>
(3) pass in quick on $int_if from 192.168.1.5
</tt>
</blockquote>

<p>
<ul>
<li>A los paquetes que entren por <tt>$int_if</tt> se les
asignará una etiqueta de <tt>INT_NET</tt>, de acuerdo con la regla
#1.
<li>A los paquetes TCP entrantes por <tt>$int_if</tt> y destinados al
puerto 80 se les asignará una etiqueta de <tt>INT_NET</tt>, de
acuerdo con la regla #1.  A continuación se sustituirá esa
marca con la etiqueta <tt>INT_NET_HTTP</tt>, de acuerdo con la regla #2.
<li>Los paquetes entrantes por <tt>$int_if</tt> desde 192.168.1.5 
serán etiquetados de una de dos maneras.
Si el paquete tiene como destino el puerto TCP 80, se corresponderá
con la regla #2 y se le marcará con la etiqueta <tt>INT_NET_HTTP</tt>.  
En caso contrario, el paquete se corresponde con la regla #3 
y se le marcará con la etiqueta <tt>INT_NET</tt>.
Debido a que el paquete se corresponde con la regla #1, se aplica la etiqueta 
<tt>INT_NET</tt> y no se quita a menos que una regla coincidente 
especifique posteriormente una etiqueta (esto es la "adherencia" de una etiqueta).
</ul>

<a name="check"></a>
<h2>Comprobación de las etiquetas aplicadas</h2>
<p>
Para comprobar las etiquetas que se hayan aplicado hay que usar la clave
<tt>tagged</tt>:
<blockquote>
<tt>
pass out on $ext_if tagged INT_NET
</tt>
</blockquote>

<p>
Los paquetes salientes por <tt>$ext_if</tt> deben ir marcados con la
etiqueta <tt>INT_NET</tt> para que coincidan con la regla anterior.
También se pueden realizar comprobaciones a la inversa usando el
operador <tt>!</tt>:
<blockquote>
<tt>
pass out on $ext_if ! tagged WIFI_NET
</tt>
</blockquote>

<a name="policy"></a>
<h2>Filtrado por política</h2>
<p>
El filtrado por política es un enfoque diferente al de los
conjuntos de reglas de filtrado.
Para empezar se define una política que configura las reglas
según las cuales se dejará pasar a unos tipos de
tráfico y se bloqueará a otros.
Entonces se clasifican los paquetes dentro de esta política en
base al criterio tradicional de dirección/puerto IP de
origen/destino, protocolo, etc.
Por ejemplo, examinemos la siguiente política de cortafuegos:
<ul>
<li>Se permite el paso del tráfico desde la LAN interna 
hacia Internet (LAN_INET) y debe ser traducido (LAN_INET_NAT)
<li>Se permite el paso del tráfico desde la LAN interna hacia la
DMZ (LAN_DMZ)
<li>Se permite el paso del tráfico desde Internet hacia los
servidores en la DMZ (INET_DMZ)
<li>Se permite el paso del tráfico desde Internet que esté
siendo redireccionado a
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=spamd&amp;sektion=8"
>spamd(8)</a> (SPAMD)
<li>Se bloqueará cualquier otro tráfico
</ul>

<p>
Nótese que la política cubre <i>todo</i> el tráfico
que pasará a través del cortafuegos.
La palabra que va entre paréntesis indica la etiqueta que se
usará para esa política.

<p>
Ahora hay que escribir las reglas para clasificar 
los paquetes dentro de la política.
<blockquote>
<tt>
block all<br>
pass out on $ext_if tag LAN_INET_NAT tagged LAN_INET nat-to ($ext_if)<br>
pass in on $int_if from $int_net tag LAN_INET<br>
pass in on $int_if from $int_net to $dmz_net tag LAN_DMZ<br>
pass in on $ext_if proto tcp to $www_server port 80 tag INET_DMZ<br>
pass in on $ext_if proto tcp from &lt;spamd&gt; to port smtp \<br>
&nbsp;&nbsp;&nbsp;tag SPAMD rdr-to 127.0.0.1 port 8025<br>
</tt>
</blockquote>

<p>
A continuación hay que configurar las reglas que definen esa
política.
<blockquote>
<tt>
pass in &nbsp;quick on $ext_if tagged SPAMD<br>
pass out quick on $ext_if tagged LAN_INET_NAT<br>
pass out quick on $dmz_if tagged LAN_DMZ<br>
pass out quick on $dmz_if tagged INET_DMZ
</tt>
</blockquote>

<p>
Ahora que ya se ha configurado el conjunto de reglas, para efectuar
cualquier cambio basta con modificar las reglas de clasificación.
Por ejemplo, si se añade un servidor de POP3/SMTP a la DMZ,
habrá que añadir reglas de clasificación para el
tráfico tipo POP3 y SMTP, como lo siguiente:
<blockquote>
<tt>
mail_server = "192.168.0.10"<br>
...<br>
pass in on $ext_if proto tcp to $mail_server port { smtp, pop3 } \<br>
&nbsp;&nbsp;&nbsp;tag INET_DMZ
</tt>
</blockquote>

<p>
Con esto se permitirá el paso al tráfico de correo
electrónico como parte de la entrada de política INET_DMZ.

<p>
Finalmente, el conjunto completo de reglas:
<table border=0 width="650">
<tr><td nowrap bgcolor="#EEEEEE">
<pre>
# macros
int_if  = "dc0"
dmz_if  = "dc1"
ext_if  = "ep0"
int_net = "10.0.0.0/24"
dmz_net = "192.168.0.0/24"
www_server = "192.168.0.5"
mail_server = "192.168.0.10"

table &lt;spamd&gt; persist file "/etc/spammers"

# clasificación -- clasificar los paquetes basándose en la política
# definida del cortafuegos
block all
pass out on $ext_if tag LAN_INET_NAT tagged LAN_INET nat-to ($ext_if)<br>
pass in on $int_if from $int_net tag LAN_INET<br>
pass in on $int_if from $int_net to $dmz_net tag LAN_DMZ<br>
pass in on $ext_if proto tcp to $www_server port 80 tag INET_DMZ
pass in on $ext_if proto tcp from &lt;spamd&gt; to port smtp \<br>
&nbsp;&nbsp;&nbsp;tag SPAMD rdr-to 127.0.0.1 port 8025<br>

# imposición de la política -- pasar/bloquear basándose en la política
# definida del cortafuegos
pass in  quick on $ext_if tagged SPAMD
pass out quick on $ext_if tagged LAN_INET_NAT
pass out quick on $dmz_if tagged LAN_DMZ
pass out quick on $dmz_if tagged INET_DMZ
</pre>
</td></tr>
</table>

<a name="ethernet"></a>
<h2>Marcado de tramas de Ethernet</h2>
<p>
El marcado también se puede aplicar en el nivel de Ethernet
si la máquina que está realizando el marcado/filtrado
también hace la vez de puente de red
(<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bridge&amp;sektion=4"
>bridge(4)</a>).
Creando reglas de filtrado para bridge(4) que usen la clave
<tt>tag</tt>, se puede hacer que PF filtre basándose en la
dirección MAC de origen/destino.
Las reglas para bridge(4) se crean usando la orden
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8"
>ifconfig(8)</a>.  Ejemplo:
<blockquote>
<tt>
# ifconfig bridge0 rule pass in on fxp0 src 0:de:ad:be:ef:0 \<br>
&nbsp;&nbsp;&nbsp;tag USER1
</tt>
</blockquote>

<p>
Y a continuación, en el fichero <tt>pf.conf</tt>:
<blockquote>
<tt>
pass in on fxp0 tagged USER1
</tt>
</blockquote>

<p>
[<a href="pools.html">Anterior: Reservas de direcciones y
balanceo de carga</a>]
[<a href="index.html">Contenido</a>]
[<a href="logging.html">Siguiente: Registros de
bitácora</a>]

<p>
<hr>
<a href="index.html"><img height="24" width="24"
src="../../../images/back.gif" border="0" alt="[back]"></a>
<a href="mailto:www@@openbsd.org">www@@openbsd.org</a>
<br>
<small>
<!--
Originally [OpenBSD: tagging.html,v 1.21 ]<br>
$Translation: tagging.html,v 1.4 2011/03/01 22:22:49 mvidal Exp $<br>
-->
$OpenBSD: tagging.html,v 1.4 2011/03/04 16:16:15 ajacoutot Exp $
</small>

</body>
</html> 
@


1.4
log
@Sync with Steelix CVS
@
text
@d347 1
a347 1
$OpenBSD$
@


1.3
log
@Sync with Steelix CVS
@
text
@d4 1
a4 1
<title>PF: Tagging: Marcado de Paquetes</title>
d7 3
a9 4
<meta http-equiv="Content-Language" content="es">
<meta name="resource-type" content="documento">
<meta name="description"   content="Preguntas Frecuentes de OpenBSD">
<meta name="keywords"      content="openbsd,preguntas frecuentes,faq,pf">
d14 1
a14 1
Copyright (c) 2003, 2004 Joel Knight <enabled@@myrealbox.com>
d34 3
a36 1
<img alt="[OpenBSD]" height="30" width="141" src="../../../images/smalltitle.gif">
d38 2
a39 2
[<a href="pools.html">Anterior: Reservas (<i>pools</i>) de Direcciones y
Balanceo de Carga</a>]
d41 2
a42 2
[<a href="logging.html">Siguiente: <i>Logging:</i> Registros de
Bit&aacute;cora</a>]
d45 1
a45 2
<h1><font color="#e00000">PF: <i>Tagging:</i> Marcado de
Paquetes</font></h1>
d49 1
a49 1
<h3>&Iacute;ndice de Contenidos</h3>
d51 5
a55 5
<li><a href="#intro">Introducci&oacute;n</a>
<li><a href="#assign">Asignaci&oacute;n de Marcas a los Paquetes</a>
<li><a href="#check">Comprobaci&oacute;n de las Marcas Aplicadas</a>
<li><a href="#policy">Pol&iacute;tica de Filtrado</a>
<li><a href="#ethernet">Marcado de Marcos de <i>Ethernet</i></a>
d61 1
a61 1
<h2>Introducci&oacute;n</h2>
d63 8
a70 8
El marcado de paquetes es una forma de marcar paquetes con un
identificador interno que m&aacute;s tarde se puede usar para el
criterio de las reglas de filtrado y traducci&oacute;n.
Mediante el marcado se pueden realizar tareas como la creaci&oacute;n de
&laquo;anillos de confianza&raquo; entre interfaces y determinar si los
paquetes han sido procesados por las reglas de traducci&oacute;n.
Tambi&eacute;n es posible alejarse del filtrado basado en reglas e
iniciar un filtrado basado en pol&iacute;ticas.
d73 1
a73 1
<h2>Asignaci&oacute;n de Marcas a los Paquetes</h2>
d75 1
a75 1
Para a&ntilde;adir una marca a un paquete, hay que usar la clave
d84 2
a85 5
De este modo, la marca <tt>INTERNAL_NET</tt> ser&aacute; a&ntilde;adida
a cualquier paquete que concuerde con la regla.  N&oacute;tese que se ha
usado <tt>keep state</tt>;  para marcar los paquetes es necesario usar
<tt>keep state</tt> (o <tt>modulate state</tt>, o <tt>synproxy
state</tt>) en las reglas <tt>pass</tt>.
d88 1
a88 1
Una marca también puede ser asignada usando una
d95 1
a95 1
pass in on $int_if all tag $name keep state
d100 1
a100 1
Hay un conjunto de macros predefinidas que también pueden ser usadas.
d118 8
a125 7
<li>Las marcas son &laquo;fijas&raquo;.  Una vez que una regla
concordante aplica una marca a un paquete, &eacute;sta ya no se elimina
nunca.  Aunque se puede sustituir por una marca diferente.
<li>Debido de la &laquo;fijeza&raquo; de una marca, un paquete puede
tener una marca aunque la &uacute;ltima regla concordante no use la
clave <tt>tag</tt>.
<li>A un paquete s&oacute;lo se le asigna un m&aacute;ximo de una marca
d127 5
a131 2
<li>Las marcas son identificadores <i>internos</i>.  Las marcas no se
env&iacute;an fuera a trav&eacute;s de la conexi&oacute;n.
d138 3
a140 4
(1) pass in on $int_if tag INT_NET keep state<br>
(2) pass in quick on $int_if proto tcp to port 80 tag \<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT_NET_HTTP keep state<br>
(3) pass in quick on $int_if from 192.168.1.5 keep state
d147 1
a147 1
asignar&aacute; una marca de <tt>INT_NET</tt>, de acuerdo con la regla
d150 12
a161 9
puerto 80 se les asignar&aacute; una marca de <tt>INT_NET</tt>, de
acuerdo con la regla #1.  A continuaci&oacute;n se sustituir&aacute; esa
marca con la marca <tt>INT_NET_HTTP</tt>, de acuerdo con la regla #2.
<li>A los paquetes entrantes por <tt>$int_if</tt> desde 192.168.1.5 se
les permitir&aacute; pasar, de acuerdo con la regla #3, ya que es la
&uacute;ltima regla que concuerda.
Sin embargo, si estos paquetes tienen como destino el puerto TCP 80, se
les marcar&aacute; con la marca <tt>INT_NET_HTTP</tt>;  de otro modo se
les marcar&aacute; con la marca <tt>INT_NET</tt>.
a163 6
<p>
Adem&aacute;s de aplicar marcas con reglas de filtrado, con las reglas
de traducci&oacute;n de <tt>nat</tt>, <tt>rdr</tt> y <tt>binat</tt>
tambi&eacute;n se puede aplicar marcas a los paquetes si se usa la clave
<tt>tag</tt>.

d165 1
a165 1
<h2>Comprobaci&oacute;n de las Marcas Aplicadas</h2>
d167 1
a167 1
Para comprobar las marcas que se hayan aplicado hay que usar la clave
d171 1
a171 1
pass out on $ext_if tagged INT_NET keep state
a175 3
Outgoing packets on <tt>$ext_if</tt> must be tagged with the
<tt>INT_NET</tt> tag in order to match the above rule. Inverse matching
can also be done by using the <tt>!</tt> operator:
d177 3
a179 3
marca <tt>INT_NET</tt> para que coincidan con la regla anterior.
Tambi&eacute;n se pueden realizar comprobaciones a la inversa usando el
operador `<tt>!</tt>':
d182 1
a182 1
pass out on $ext_if tagged ! WIFI_NET keep state
d187 1
a187 1
<h2>Pol&iacute;tica de Filtrado</h2>
d189 1
a189 1
La pol&iacute;tica de filtrado es un acercamiento diferente al de los
d191 5
a195 5
Para empezar se define una pol&iacute;tica que configura las reglas
seg&uacute;n las cuales se dejar&aacute; pasar a unos tipos de
tr&aacute;fico y se bloquear&aacute; a otros.
Entonces se clasifican los paquetes dentro de esta pol&iacute;tica en
base al criterio tradicional de direcci&oacute;n/puerto IP de
d197 1
a197 1
Por ejemplo, examinemos la siguiente pol&iacute;tica de cortafuegos:
d199 3
a201 1
<li>Se permite el paso del tr&aacute;fico desde la LAN interna hacia la
d203 1
a203 1
<li>Se permite el paso del tr&aacute;fico desde Internet hacia los
d205 1
a205 1
<li>Se permite el paso del tr&aacute;fico desde Internet que est&eacute;
d207 1
a207 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=spamd&amp;sektion=8&amp;manpath=OpenBSD+3.5"
d209 1
a209 1
<li>Se bloquear&aacute; cualquier otro tr&aacute;fico
d213 4
a216 4
N&oacute;tese que la pol&iacute;tica cubre <i>todo</i> el tr&aacute;fico
que pasar&aacute; a trav&eacute;s del cortafuegos.
La palabra que va entre par&eacute;ntesis indica la marca que se
usar&aacute; para esa pol&iacute;tica.
d219 2
a220 2
Ahora hay que escribir las reglas de filtrado y traducci&oacute;n para
clasificar los paquetes dentro de la pol&iacute;tica.
a222 3
rdr on $ext_if proto tcp from &lt;spamd&gt; to port smtp \<br>
&nbsp;&nbsp;&nbsp;tag SPAMD -&gt; 127.0.0.1 port 8025<br>
<br>
d224 6
a229 3
pass in on $int_if from $int_net tag LAN_INET keep state<br>
pass in on $int_if from $int_net to $dmz_net tag LAN_DMZ keep state<br>
pass in on $ext_if proto tcp to $www_server port 80 tag INET_DMZ keep state
d234 2
a235 2
A continuaci&oacute;n hay que configurar las reglas que definen esa
pol&iacute;tica.
d238 4
a241 4
pass in &nbsp;quick on $ext_if tagged SPAMD keep state<br>
pass out quick on $ext_if tagged LAN_INET keep state<br>
pass out quick on $dmz_if tagged LAN_DMZ keep state<br>
pass out quick on $dmz_if tagged INET_DMZ keep state
d247 4
a250 4
cualquier cambio basta con modificar las reglas de clasificaci&oacute;n.
Por ejemplo, si se a&ntilde;ade un servidor de POP3/SMTP a la DMZ,
habr&aacute; que a&ntilde;adir reglas de clasificaci&oacute;n para el
tr&aacute;fico tipo POP3 y SMTP, como lo siguiente:
d253 1
a253 1
mail_server = &quot;192.168.0.10&quot;<br>
d256 1
a256 1
&nbsp;&nbsp;&nbsp;tag INET_DMZ keep state
d261 2
a262 2
Con esto se permitir&aacute; el paso al tr&aacute;fico de correo
electr&oacute;nico como parte de la entrada de pol&iacute;tica INET_DMZ.
d266 1
a266 1
<table border="0" width="650">
d270 7
a276 7
int_if  = &quot;dc0&quot;
dmz_if  = &quot;dc1&quot;
ext_if  = &quot;ep0&quot;
int_net = &quot;10.0.0.0/24&quot;
dmz_net = &quot;192.168.0.0/24&quot;
www_server = &quot;192.168.0.5&quot;
mail_server = &quot;192.168.0.10&quot;
d278 1
a278 1
table &lt;spamd&gt; persist file &quot;/etc/spammers&quot;
d280 1
a280 1
# clasificaci&oacute;n -- clasificar los paquetes bas&aacute;ndose en la pol&iacute;tica
a281 3
rdr on $ext_if proto tcp from &lt;spamd&gt; to port smtp \
    tag SPAMD -&gt; 127.0.0.1 port 8025

d283 6
a288 5
pass in on $int_if from $int_net tag LAN_INET keep state
pass in on $int_if from $int_net to $dmz_net tag LAN_DMZ keep state
pass in on $ext_if proto tcp to $www_server port 80 tag INET_DMZ keep state 
pass in on $ext_if proto tcp to $mail_server port { smtp, pop3 } \
    tag INET_DMZ keep state 
d290 1
a290 1
# imposici&oacute;n de la pol&iacute;tica -- pasar/bloquear bas&aacute;ndose en la pol&iacute;tica
d292 4
a295 4
pass in  quick on $ext_if tagged SPAMD keep state
pass out quick on $ext_if tagged LAN_INET keep state
pass out quick on $dmz_if tagged LAN_DMZ keep state
pass out quick on $dmz_if tagged INET_DMZ keep state 
d301 1
a301 1
<h2>Marcado de Marcos de Ethernet</h2>
d303 5
a307 5
Si la m&aacute;quina que est&aacute; realizando el marcado/filtrado
tambi&eacute;n hace la vez de puente de red
(<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bridge&amp;sektion=4&amp;manpath=OpenBSD+3.5"
>bridge(4)</a>), el marcado tambi&eacute;n se puede aplicar a nivel de
la Ethernet.
d309 2
a310 2
<tt>tag</tt>, se puede hacer que PF filtre bas&aacute;ndose en la
direcci&oacute;n MAC de origen/destino.
d312 2
a313 2
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=brconfig&amp;sektion=8&amp;manpath=OpenBSD+3.5"
>brconfig(8)</a>.  Ejemplo:
d316 1
a316 1
# brconfig bridge0 rule pass in on fxp0 src 0:de:ad:be:ef:0 \<br>
d322 1
a322 1
Y a continuaci&oacute;n, en el fichero <tt>pf.conf</tt>:
d330 2
a331 2
[<a href="pools.html">Anterior: Reservas (<i>pools</i>) de Direcciones y
Balanceo de Carga</a>]
d333 2
a334 2
[<a href="logging.html">Siguiente: <i>Logging:</i> Registros de
Bit&aacute;cora</a>]
d338 2
a339 1
<a href="index.html"><img height="24" width="24" src="../../../images/back.gif" border="0" alt="[&Iacute;ndice]"></a> 
d343 4
a346 2
Originally [OpenBSD: tagging.html,v 1.4 ]<br>
$Translation: tagging.html,v 1.3 2004/09/10 15:15:18 santana Exp $<br>
@


1.2
log
@Sync with Steelix CVS
@
text
@d4 1
a4 1
<title>PF: <i>Tagging:</i> Marcado de Paquetes</title>
a11 1
<meta name="copyright"     content="Este documento es copyright 2003-2004 de OpenBSD.">
d14 17
d37 2
a38 2
[<a href="pools.html">Anterior: <i>Pools</i> de Direcciones y Balanceo
de Carga</a>]
d91 28
d211 1
a211 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=spamd&amp;sektion=8&amp;manpath=OpenBSD+3.4"
d311 1
a311 1
(<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bridge&amp;sektion=4&amp;manpath=OpenBSD+3.4"
d318 1
a318 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=brconfig&amp;sektion=8&amp;manpath=OpenBSD+3.4"
d336 2
a337 2
[<a href="pools.html">Anterior: <i>Pools</i> de Direcciones y Balanceo
de Carga</a>]
d348 2
a349 2
Originally [OpenBSD: tagging.html,v 1.2 ]<br>
$Translation: tagging.html,v 1.2 2004/01/04 21:32:07 horacio Exp $<br>
@


1.1
log
@Sync with Steelix CVS
@
text
@d12 1
a12 1
<meta name="copyright"     content="Este documento es copyright 2003 de OpenBSD.">
d304 2
a305 2
Originally [OpenBSD: tagging.html,v 1.1 2003/11/30 23:14:31 nick Exp ]<br>
$Translation: tagging.html,v 1.1 2003/12/02 15:35:12 horacio Exp $<br>
@

