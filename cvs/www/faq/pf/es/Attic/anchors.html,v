head	1.12;
access;
symbols;
locks; strict;
comment	@# @;


1.12
date	2014.04.01.17.14.10;	author nick;	state dead;
branches;
next	1.11;

1.11
date	2011.03.04.16.16.15;	author ajacoutot;	state Exp;
branches;
next	1.10;

1.10
date	2004.08.31.16.10.23;	author saad;	state Exp;
branches;
next	1.9;

1.9
date	2004.01.04.22.29.12;	author horacio;	state Exp;
branches;
next	1.8;

1.8
date	2003.12.03.21.40.56;	author horacio;	state Exp;
branches;
next	1.7;

1.7
date	2003.11.17.19.44.24;	author horacio;	state Exp;
branches;
next	1.6;

1.6
date	2003.09.27.14.55.54;	author horacio;	state Exp;
branches;
next	1.5;

1.5
date	2003.09.20.07.00.26;	author horacio;	state Exp;
branches;
next	1.4;

1.4
date	2003.07.13.13.11.41;	author jufi;	state Exp;
branches;
next	1.3;

1.3
date	2003.06.27.20.57.38;	author jufi;	state Exp;
branches;
next	1.2;

1.2
date	2003.06.15.12.27.34;	author jufi;	state Exp;
branches;
next	1.1;

1.1
date	2003.05.28.14.39.30;	author jufi;	state Exp;
branches;
next	;


desc
@@


1.12
log
@
Abandon translations, per deraadt@@ and ajacoutot@@.
@
text
@<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>PF: Anclajes</title>
<link rev="made" href="mailto:www@@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name="resource-type" content="document">
<meta name="description"   content="the OpenBSD FAQ page">
<meta name="keywords"      content="openbsd,faq,pf">
<meta name="distribution"  content="global">
</head>

<!--
Copyright (c) 2003-2007 Joel Knight <enabled@@myrealbox.com>

Permission to use, copy, modify, and distribute this documentation for
any purpose with or without fee is hereby granted, provided that the
above copyright notice and this permission notice appear in all copies.

THE DOCUMENTATION IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL
WARRANTIES WITH REGARD TO THIS DOCUMENTATION INCLUDING ALL IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE
AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL
DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR
PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS DOCUMENTATION
-->

<body bgcolor="#ffffff" text="#000000">
<!-- Passes validator.w3.org, please keep it this way;
please, use a max of 72 chars per line -->

<a href="../../../es/index.html">
<img alt="[OpenBSD]" height="30" width="141" src="../../../images/smalltitle.gif" border="0">
</a>
<p>
[<a href="options.html">Anterior: Opciones en tiempo de ejecución</a>]
[<a href="index.html">Contenido</a>]
[<a href="queueing.html">Siguiente: Formación de colas y
prioridades de paquetes</a>]

<p>
<h1><font color="#e00000">PF: Anclajes</font></h1>

<hr>

<h3>Índice de contenidos</h3>
<ul>
<li><a href="#intro">Introducción</a>
<li><a href="#anchors">Anclajes</a>
<li><a href="#options">Opciones de anclaje</a>
<li><a href="#manip">Manipulación de anclajes</a>
</ul>

<hr>

<a name="intro"></a>
<h2>Introducción</h2>
<p>
Además del conjunto de reglas principal, PF también puede
evaluar subconjuntos de reglas.  Los subconjuntos de reglas se pueden
manipular al vuelo usando
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+4.8"
>pfctl(8)</a>,
para lo que disponen de un modo conveniente para alterar
dinámicamente un conjunto de reglas activo.  Mientras que una
<a href="tables.html">tabla</a> se usa para contener una lista
dinámica de direcciones, un subconjunto de reglas se usa para
contener un conjunto dinámico de reglas de filtrado.
Estos subconjuntos de reglas van ligados al conjunto de reglas 
principal mediante el uso de anclajes (<tt>anchor</tt>).

<p>
Los anclajes pueden anidarse, lo que permite que al subconjunto 
de reglas ir encadenado juntamente. 
Las reglas de anclaje serán evaluadas en relación con el
anclaje que las carga. 
Por ejemplo, las reglas de anclaje en el conjunto de reglas 
principal crearán puntos vinculados con el conjunto de reglas 
principal como padre, y las reglas de anclaje 
cargadas de ficheros invocados por medio de la directiva 
<tt>load anchor</tt> crearán puntos de anclaje definiendo ese 
anclaje como padre. 

<a name="named"></a>
<a name="anchors"></a>
<h2>Anclajes</h2>
<p>
Un anclaje es una agrupación de reglas de filtrado, tablas y otros
anclajes a la que se ha asignado un nombre.  
Cuando PF se encuentra con una regla <tt>anchor</tt> en el conjunto 
principal de reglas, evalúa las reglas contenidas en ese punto de 
anclaje tal y como evalúa las reglas en el conjunto de reglas principal.
Entonces continúa el procesamiento en el conjunto de reglas principal, 
a menos que el paquete concuerde con una regla de filtrado que use la opción
<tt>quick</tt>, en cuyo caso la búsqueda de concordancia se
considerará finalizada y terminará la evaluación de
las reglas, tanto en el anclaje como en el conjunto de reglas principal.

<p>
Por ejemplo:
<blockquote>
<tt>
ext_if = "fxp0"<br>
<br>
block on $ext_if<br>
pass &nbsp;out on $ext_if<br>
anchor goodguys
</tt>
</blockquote>

<p>
En este conjunto de reglas se ha definido una política de
denegación predeterminada en <tt>fxp0</tt>, tanto para el
tráfico entrante como para el saliente.  
A continuación se permite pasar el tráfico, manteniendo el estado, 
y se crea una regla de anclaje con el nombre de <tt>goodguys</tt>.  
Hay tres métodos para llenar con reglas los anclajes:
<ul>
<li>usando un regla <tt>load</tt>
<li>usando
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+4.8"
>pfctl(8)</a>
<li>especificando las reglas directamente en el conjunto 
de reglas principal
</ul>

<p>
La regla <tt>load</tt> hace que <tt>pfctl</tt> llene el anclaje 
especificado leyendo las reglas desde un
fichero de texto.  Ejemplo:
<blockquote>
<tt>
anchor goodguys<br>
load anchor goodguys from "/etc/anchor-goodguys-ssh"
</tt>
</blockquote>

<p>
Para añadir reglas a un anclaje con <tt>pfctl</tt>, se puede
emplear una orden parecida a la siguiente:
<blockquote>
<tt>
# echo "pass in proto tcp from 192.0.2.3 to any port 22" \<br>
&nbsp;&nbsp;&nbsp;| pfctl -a goodguys -f -
</tt>
</blockquote>

<p>
También es posible guardar y cargar las reglas desde un fichero
de texto:
<blockquote>
<tt>
# cat &gt;&gt; /etc/anchor-goodguys-www<br>
pass in proto tcp from 192.0.2.3 to any port 80<br>
pass in proto tcp from 192.0.2.4 to any port { 80 443 }<br>
<br>
# pfctl -a goodguys -f /etc/anchor-goodguys-www<br>
</tt>
</blockquote>

<p>
Para cargar las reglas directamente desde un conjunto de reglas
principal, sitúe las reglas de anclaje en un bloque delimitado por 
llaves:

<blockquote>
<tt>
anchor "goodguys" { <br>
&nbsp;&nbsp;&nbsp;pass in proto tcp from 192.168.2.3 to port 22<br>
}
</tt>
</blockquote>

Los anclajes delimitados de esta manera pueden contener otros
anclajes:

<blockquote>
<tt>
allow = "{ 192.0.2.3 192.0.2.4 }" <br>
<br>
anchor "goodguys" { <br>
&nbsp;&nbsp;&nbsp;anchor { <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pass in proto tcp from 192.0.2.3 to port 80 <br>
&nbsp;&nbsp;&nbsp;} <br>
&nbsp;&nbsp;&nbsp;pass in proto tcp from $allow to port 22<br>
}
</tt>
</blockquote>

Con anclajes especificados directamente, el nombre del anclaje se convierte 
en opcional. Nótese que el anclaje anidado del ejemplo anterior no tiene nombre.
Tenga en cuenta también que la macro <tt>$allow</tt> se crea fuera del 
anclaje (en el conjunto de reglas principal) y entonces se utiliza dentro del 
anclaje.

<p>
Las reglas se pueden cargar en un anclaje, usando la misma sintaxis 
y opciones que para las reglas cargadas en el conjunto de reglas principal.  
Sin embargo, hay que tener en cuenta que, excepto que esté
usando anclajes directamente, cualquier
<a href="macros.html">macro</a> que esté siendo utilizada debe
ser definida en el anclaje mismo; las macros que se encuentran 
definidas en el conjunto de reglas principal
<i>no</i> son visibles desde el anclaje.

<p>
Dado que los anclajes pueden anidarse, es posible especificar que
todos los anclajes-hijo dentro de un anclaje específico 
sea evaluado:

<blockquote>
<tt>
anchor "spam/*"
</tt>
</blockquote>

<p>
Esta sintaxis hace que se evalúe cada regla vinculada al anclaje 
<tt>spam</tt>. Los anclajes-hijo serán evaluados en orden alfabético, 
pero no se recorren de forma recursiva. 
Los anclajes se evalúan siempre relativos al anclaje 
en el que están definidos.

<p>
Cada anclaje, así como el conjunto de reglas principal, 
existe de forma independiente de los otros conjuntos
de reglas.  Las operaciones que se realicen en un conjunto de reglas,
como la limpieza de las reglas, no afecta a ninguno de los otros
conjuntos.  Además, si se elimina un punto de anclaje del
conjunto de reglas principal, no se destruye el anclaje ni cualquier
subconjunto de reglas con nombre que esté adjunto a ese anclaje.
Un anclaje no se destruye hasta que se han
limpiado todas las reglas usando
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+4.8"
>pfctl(8)</a> y no existan anclajes-hijo dentro del anclaje.


<a name="options"></a>
<h2>Opciones de anclaje</h2>
<p>
De modo opcional, las reglas <tt>anchor</tt> pueden especificar una
interfaz, un protocolo, una dirección de origen y destino, una marca, etc..
mediante la misma sintaxis que las reglas de filtrado.  Cuando se da este
tipo de información, las reglas <tt>anchor</tt> sólo se
procesan si el paquete concuerda con la definición de la regla
<tt>anchor</tt>.  Por ejemplo:
<blockquote>
<tt>
ext_if = "fxp0"<br>
<br>
block on $ext_if<br>
pass &nbsp;out on $ext_if<br>
anchor ssh in on $ext_if proto tcp to port 22<br>
</tt>
</blockquote>

<p>
Las reglas en el anclaje <tt>ssh</tt> solo se evalúan para
los paquetes TCP destinados al puerto 22 que entran en la interfaz
<tt>fxp0</tt>.  Entonces se añaden las reglas al <tt>anchor</tt>,
del siguiente modo:
<blockquote>
<tt>
# echo "pass in from 192.0.2.10 to any" | pfctl -a ssh -f -
</tt>
</blockquote>

<p>
Por lo tanto, aunque la regla de filtrado no especifique una interfaz,
un protocolo, o un puerto, al anfitrión 192.0.2.10 sólo se
le permitirá conectar usando SSH, de acuerdo con la
definición de la regla <tt>anchor</tt>.

<p>
La misma sintaxis puede aplicarse a los anclajes especificados
directamente:

<blockquote>
<tt>
allow = "{ 192.0.2.3 192.0.2.4 }" <br>
<br>
anchor "goodguys" in proto tcp { <br>
&nbsp;&nbsp;&nbsp;anchor proto tcp to port 80 { <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pass from 192.0.2.3 <br>
&nbsp;&nbsp;&nbsp;} <br>
&nbsp;&nbsp;&nbsp;anchor proto tcp to port 22 { <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pass from $allow<br>
&nbsp;&nbsp;&nbsp;} <br>
}
</tt>
</blockquote>


<a name="manip"></a>
<h2>Manipulación de anclajes</h2>
<p>
La manipulación de anclajes se realiza mediante <tt>pfctl</tt>.  
Se puede usar para añadir y eliminar reglas de un anclaje 
sin recargar el conjunto de reglas principal.

<p>
Para ver una lista de todas las reglas en un anclaje llamado 
<tt>ssh</tt>:
<blockquote>
<tt>
# pfctl -a ssh -s rules
</tt>
</blockquote>

<p>
Para limpiar todas las reglas de filtrado de este mismo anclaje:
<blockquote>
<tt>
# pfctl -a ssh -F rules
</tt>
</blockquote>

<p>
Para una lista completa de órdenes, véase
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+4.8"
>pfctl(8)</a>.

<p>
[<a href="options.html">Anterior: Opciones en tiempo de ejecución</a>]
[<a href="index.html">Contenido</a>]
[<a href="queueing.html">Siguiente: Formación de colas y
prioridades de paquetes</a>]

<p>
<hr>
<a href="index.html"><img height="24" width="24"
src="../../../images/back.gif" border="0" alt="[back]"></a>
<a href="mailto:www@@openbsd.org">www@@openbsd.org</a>
<br>
<small>
<!--
Originally [OpenBSD: anchors.html,v 1.29 ]<br>
$Translation: anchors.html,v 1.13 2011/02/28 18:10:28 mvidal Exp $<br>
-->
$OpenBSD: anchors.html,v 1.11 2011/03/04 16:16:15 ajacoutot Exp $
</small>

</body>
</html> 
@


1.11
log
@Sync with Steelix CVS
@
text
@d342 1
a342 1
$OpenBSD$
@


1.10
log
@sync with Steelix CVS
@
text
@d4 1
a4 1
<title>PF: Anclajes y Subconjuntos de Reglas con Nombre</title>
a6 1
<meta http-equiv="Content-Language" content="es">
d8 2
a9 2
<meta name="description"   content="Preguntas Frecuentes de OpenBSD">
<meta name="keywords"      content="openbsd,preguntas frecuentes,faq,pf">
d14 1
a14 1
Copyright (c) 2003, 2004 Joel Knight <enabled@@myrealbox.com>
d34 3
a36 1
<img alt="[OpenBSD]" height="30" width="141" src="../../../images/smalltitle.gif">
d38 1
a38 2
[<a href="scrub.html">Anterior: <i>Scrubbing:</i> Normalizaci&oacute;n
de Paquetes)</a>]
d40 2
a41 2
[<a href="queueing.html">Siguiente: Formaci&oacute;n de Colas y
Prioridades de Paquetes</a>]
d44 1
a44 2
<h1><font color="#e00000">PF: Anclajes y Subconjuntos de Reglas con
Nombre</font></h1>
d48 1
a48 1
<h3>&Iacute;ndice de Contenidos</h3>
d50 4
a53 5
<li><a href="#intro">Introducci&oacute;n</a>
<li><a href="#named">Subconjuntos de Reglas con Nombre</a>
<li><a href="#options">Opciones de Anclaje</a>
<li><a href="#manip">Manipulaci&oacute;n de Subconjuntos de Reglas con
Nombre</a>
d59 1
a59 1
<h2>Introducci&oacute;n</h2>
d61 1
a61 1
Adem&aacute;s del conjunto de reglas principal, PF tambi&eacute;n puede
d63 3
a65 2
manipular sobre la marcha usando
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+3.4">pfctl(8)</a>,
d67 1
a67 1
din&aacute;micamente un conjunto de reglas activo.  Mientras que una
d69 16
a84 25
din&aacute;mica de direcciones, un subconjunto de reglas se usa para
contener un conjunto din&aacute;mico de reglas de filtrado,
<tt>nat</tt>, <tt>rdr</tt>, y <tt>binat</tt>.

<p>
Estos subconjuntos de reglas van ligados al conjunto de reglas principal
mediante el uso de reglas de anclaje;  las reglas de anclaje se crean
con la clave <tt>anchor</tt>:
<ul>
<li><tt>anchor <i>nombre</i></tt> - eval&uacute;a todas las
<a href="filter.html">reglas de filtrado</a> en el anclaje
<i><tt>nombre</tt></i>
<li><tt>binat-anchor <i>nombre</i></tt> - eval&uacute;a todas las reglas
de <a href="nat.html#binat"><tt>binat</tt></a> en el anclaje
<i><tt>nombre</tt></i>
<li><tt>nat-anchor <i>nombre</i></tt> - eval&uacute;a todas las reglas
de <a href="nat.html"><tt>nat</tt></a> en el anclaje
<i><tt>nombre</tt></i>
<li><tt>rdr-anchor <i>nombre</i></tt> - eval&uacute;a todas las reglas
de <a href="rdr.html"><tt>rdr</tt></a> en el anclaje
<i><tt>nombre</tt></i>
</ul>

Las reglas de anclaje <tt>anchor</tt> s&oacute;lo se pueden definir en
el conjunto de reglas principal.
d87 2
a88 1
<h2>Subconjuntos de Reglas con Nombre</h2>
d90 9
a98 12
Un subconjunto de reglas con nombre es una agrupaci&oacute;n de reglas
de filtrado y/o traducci&oacute;n a la que se ha asignado un nombre.  Un
punto de anclaje <tt>anchor</tt> puede contener m&aacute;s de uno de
estos subconjuntos de reglas.  Cuando PF se encuentra con una regla
<tt>anchor</tt> en el conjunto principal de reglas, eval&uacute;a todos
los subconjuntos de reglas adjuntas a ese punto de anclaje, en orden
alfab&eacute;tico de acuerdo con sus nombres.  Entonces contin&uacute;a
el procesamiento en el conjunto de reglas principal, a menos que el
paquete concuerde con una regla de filtrado que use la opci&oacute;n
<tt>quick</tt> o con una regla de traducci&oacute;n dentro del mismo
anclaje, en cuyo caso la b&uacute;squeda de concordancia se
considerar&aacute; finalizada y terminar&aacute; la evaluaci&oacute;n de
d105 1
a105 1
ext_if = &quot;fxp0&quot;<br>
d107 2
a108 2
block on $ext_if all<br>
pass &nbsp;out on $ext_if all keep state<br>
d114 6
a119 6
En este conjunto de reglas se ha definido una pol&iacute;tica de
denegaci&oacute;n predeterminada en <tt>fxp0</tt>, tanto para el
tr&aacute;fico entrante como para el saliente.  A continuaci&oacute;n se
permite pasar el tr&aacute;fico, manteniendo el estado, y se crea una
regla de anclaje con el nombre de <tt>goodguys</tt>.  Hay dos
m&eacute;todos para llenar con reglas los anclajes:
d123 1
a123 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+3.5"
d125 2
d130 2
a131 2
La regla <tt>load</tt> hace que <tt>pfctl</tt> llene el anclaje y el
conjunto de reglas con nombre especificados leyendo las reglas desde un
d135 2
a136 1
load anchor goodguys:ssh from &quot;/etc/anchor-goodguys-ssh&quot;
d141 2
a142 8
Cuando el conjunto de reglas principal est&eacute; cargado, las reglas
que aparecen en el fichero <tt>/etc/anchor-goodguys-ssh</tt> se
cargar&aacute;n en el conjunto de reglas con nombre <tt>ssh</tt>
vinculado al anclaje <tt>goodguys</tt>.

<p>
Para a&ntilde;adir reglas a un anclaje usando <tt>pfctl</tt>, hay que
usar una orden parecida a la siguiente:
d145 2
a146 2
# echo &quot;pass in proto tcp from 192.0.2.3 to any port 22&quot; \<br>
&nbsp;&nbsp;&nbsp;| pfctl -a goodguys:ssh -f -
d151 1
a151 8
Con esta orden se a&ntilde;ade una regla <tt>pass</tt> al conjunto de
reglas llamado <tt>ssh</tt>, adjunto al anclaje <tt>goodguys</tt>.  PF
eval&uacute;a esta regla, y cualquier otra regla de filtrado que se
a&ntilde;ada, cuando llega a la l&iacute;nea <tt>anchor goodguys</tt> en
el conjunto de reglas principal.

<p>
Tambi&eacute;n es posible guardar y cargar las reglas desde un fichero
d159 1
a159 1
# pfctl -a goodguys:www -f /etc/anchor-goodguys-www<br>
d164 54
a217 3
De este modo se cargan las reglas desde el fichero
<tt>/etc/anchor-goodguys-www</tt> al subconjunto de reglas con nombre
<tt>www</tt> en el anclaje <tt>goodguys</tt>.
d220 5
a224 8
Las reglas de filtrado y de traducci&oacute;n se pueden cargar en un
subconjunto de reglas con nombre, usando la misma sintaxis y opciones
que para las reglas cargadas en el conjunto de reglas principal.  Sin
embargo, hay que tener en cuenta que tambi&eacute;n se debe definir
dentro del subconjunto de reglas con nombre cualquier
<a href="macros.html">macro</a> que est&eacute; siendo utilizada;  Las
macros que se encuentran definidas en el conjunto de reglas principal
<i>no</i> son visibles desde los subconjuntos de reglas con nombre.
d227 2
a228 2
Cada subconjunto de reglas con nombre, as&iacute; como el conjunto de
reglas principal, existe de forma independiente de los otros conjuntos
d231 1
a231 1
conjuntos.  Adem&aacute;s, si se elimina un punto de anclaje del
d233 2
a234 2
subconjunto de reglas con nombre que est&eacute; adjunto a ese anclaje.
Un subconjunto de reglas con nombre no se destruye hasta que se han
d236 2
a237 3
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+3.5">pfctl(8)</a>.
Cuando un punto de anclaje ya no tiene ning&uacute;n conjunto de reglas
adjunto, tambi&eacute;n se destruye.
d241 1
a241 1
<h2>Opciones de Anclaje</h2>
d245 3
a247 3
usando la misma sintaxis que las reglas de filtrado.  Cuando se da este
tipo de informaci&oacute;n, las reglas <tt>anchor</tt> s&oacute;lo se
procesan si el paquete concuerda con la definici&oacute;n de la regla
d251 1
a251 1
ext_if = &quot;fxp0&quot;<br>
d253 3
a255 3
block on $ext_if all<br>
pass &nbsp;out on $ext_if all keep state<br>
anchor ssh in on $ext_if proto tcp from any to any port 22<br>
d260 1
a260 1
Las reglas en el anclaje <tt>ssh</tt> s&oacute;lo se eval&uacute;an para
d262 1
a262 1
<tt>fxp0</tt>.  Entonces se a&ntilde;aden las reglas al <tt>anchor</tt>,
d266 1
a266 1
# echo &quot;pass in from 192.0.2.10 to any&quot; | pfctl -a ssh:allowed -f -
d272 23
a294 3
un protocolo, o un puerto, al anfitri&oacute;n 192.0.2.10 s&oacute;lo se
le permitir&aacute; conectar usando SSH, de acuerdo con la
definici&oacute;n de la regla <tt>anchor</tt>.
d297 1
a297 1
<h2>Manipulaci&oacute;n de Subconjuntos de Reglas con Nombre</h2>
d299 3
a301 4
La manipulaci&oacute;n de los subconjuntos de reglas con nombre se
realiza mediante <tt>pfctl</tt>.  Se puede usar <tt>pfctl</tt> para
a&ntilde;adir y eliminar reglas de un conjunto de reglas sin recargar el
conjunto de reglas principal.
d304 2
a305 2
Para ver una lista de todas las reglas en el conjunto de reglas
<tt>allowed</tt> adjunto al anclaje <tt>ssh</tt>:
d308 1
a308 1
# pfctl -a ssh:allowed -s rules
d313 1
a313 2
Para limpiar todas las reglas de filtrado de este mismo conjunto de
reglas:
d316 1
a316 1
# pfctl -a ssh:allowed -F rules
d321 3
a323 2
Si se omite el nombre del conjunto de reglas, la acci&oacute;n se
aplicar&aacute; a todas las reglas en el anclaje.
d326 1
a326 6
Para una lista completa de &oacute;rdenes, v&eacute;ase
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+3.5">pfctl(8)</a>.

<p>
[<a href="scrub.html">Anterior: <i>Scrubbing:</i> Normalizaci&oacute;n
de Paquetes)</a>]
d328 2
a329 2
[<a href="queueing.html">Siguiente: Formaci&oacute;n de Colas y
Prioridades de Paquetes</a>]
d333 2
a334 1
<a href="index.html"><img height="24" width="24" src="../../../images/back.gif" border="0" alt="[&Iacute;ndice]"></a> 
d338 5
a342 3
Originally [OpenBSD: anchors.html,v 1.12 ]<br>
$OpenBSD$<br>
$Translation: anchors.html,v 1.12 2004/08/30 16:57:44 santana Exp $
d344 1
@


1.9
log
@Sync with Steelix CVS
@
text
@a11 1
<meta name="copyright"     content="Este documento es copyright 2003-2004 de OpenBSD.">
d14 17
d135 1
a135 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+3.4"
d210 1
a210 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+3.4">pfctl(8)</a>.
d219 1
a219 1
interfaz, un protocolo, una direcci&oacute;n de origen y destino, etc..
d283 1
a283 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+3.4">pfctl(8)</a>.
d298 1
a298 1
Originally [OpenBSD: anchors.html,v 1.10 ]<br>
d300 1
a300 1
$Translation: anchors.html,v 1.11 2004/01/04 21:32:07 horacio Exp $
@


1.8
log
@Sync with Steelix CVS
@
text
@d12 1
a12 1
<meta name="copyright"     content="Este documento es copyright 2003 de OpenBSD.">
d282 1
a282 1
Originally [OpenBSD: anchors.html,v 1.9 ]<br>
d284 1
a284 1
$Translation: anchors.html,v 1.10 2003/12/02 15:35:11 horacio Exp $
@


1.7
log
@Sync with Steelix CVS
@
text
@d4 1
a4 1
<title>PF: Anclajes y Subgrupos de Reglas con Nombre</title>
d21 2
a22 1
[<a href="logging.html">Anterior: Registros de Bit&aacute;cora</a>]
d24 2
a25 2
[<a href="shortcuts.html">Siguiente: Atajos para la Creaci&oacute;n de
Grupos de Reglas</a>]
d28 1
a28 1
<h1><font color="#e00000">PF: Anclajes y Subgrupos de Reglas con
d36 1
a36 1
<li><a href="#named">Subgrupos de Reglas con Nombre</a>
d38 1
a38 1
<li><a href="#manip">Manipulaci&oacute;n de Subgrupos de Reglas con
d47 2
a48 2
Adem&aacute;s del grupo de reglas principal, PF tambi&eacute;n puede
evaluar subgrupos de reglas.  Los subgrupos de reglas se pueden
d50 1
a50 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+3.4"><tt>pfctl(8)</tt></a>,
d52 1
a52 1
din&aacute;micamente un grupo de reglas activo.  Mientras que una
d54 3
a56 3
din&aacute;mica de direcciones, un subgrupo de reglas se usa para
contener un grupo din&aacute;mico de reglas de filtrado, <tt>nat</tt>,
<tt>rdr</tt>, y <tt>binat</tt>.
d59 1
a59 1
Estos subgrupos de reglas van ligados al grupo de reglas principal
d78 1
a78 1
el grupo de reglas principal.
d81 1
a81 1
<h2>Subgrupos de Reglas con Nombre</h2>
d83 2
a84 2
Un subgrupo de reglas con nombre es una agrupaci&oacute;n de reglas de
filtrado y/o traducci&oacute;n a la que se ha asignado un nombre.  Un
d86 3
a88 3
estos subgrupos de reglas.  Cuando PF se encuentra con una regla
<tt>anchor</tt> en el grupo principal de reglas, eval&uacute;a todos los
subgrupos de reglas adjuntas a ese punto de anclaje, en orden
d90 2
a91 2
el procesamiento en el grupo de reglas principal, a menos que el paquete
concuerde con una regla de filtrado que use la opci&oacute;n
d95 1
a95 1
las reglas, tanto en el anclaje como en el grupo de reglas principal.
d110 32
a141 7
En este grupo de reglas se ha definido una pol&iacute;tica de
denegaci&oacute;n predeterminada en fxp0, tanto para el tr&aacute;fico
entrante como para el saliente.  A continuaci&oacute;n se permite pasar
el tr&aacute;fico, manteniendo el estado, y se crea una regla de anclaje
con el nombre de <tt><i>goodguys</i></tt>.  Para a&ntilde;adir reglas al
anclaje <tt><i>goodguys</i></tt> se pueden usar las siguientes
&oacute;rdenes:
d150 5
a154 5
Con esta orden se a&ntilde;ade una regla <tt>pass</tt> al grupo de
reglas llamado <tt><i>ssh</i></tt>, adjunto al anclaje
<tt><i>goodguys</i></tt>.  PF eval&uacute;a esta regla, y cualquier otra
regla de filtrado que se a&ntilde;ada, cuando llega a la l&iacute;nea
<tt>anchor goodguys</tt> en el grupo de reglas principal.
d171 2
a172 2
<tt>/etc/anchor-goodguys-www</tt> al subgrupo de reglas con nombre
<tt><i>www</i></tt> en el anclaje <tt><i>goodguys</i></tt>.
d176 18
a193 17
subgrupo de reglas con nombre, usando la misma sintaxis y opciones que
para las reglas cargadas en el grupo de reglas principal.  Sin embargo,
hay que tener en cuenta que tambi&eacute;n se debe definir dentro del
subgrupo de reglas con nombre cualquier <a href="macros.html">macro</a>
que est&eacute; siendo utilizada;  Las macros que se encuentran
definidas en el grupo de reglas principal <i>no</i> son visibles desde
los subgrupos de reglas con nombre.

<p>
Cada subgrupo de reglas con nombre, as&iacute; como el grupo de reglas
principal, existe de forma independiente de los otros grupos de reglas.
Las operaciones que se realicen en un grupo de reglas, como la limpieza
de las reglas, no afecta a ninguno de los otros grupos.  Adem&aacute;s,
si se elimina un punto de anclaje del grupo de reglas principal, no se
destruye el anclaje ni cualquier subgrupo de reglas con nombre que
est&eacute; adjunto a ese anclaje.  Un subgrupo de reglas con nombre no
se destruye hasta que se han limpiado todas las reglas usando
d195 1
a195 1
Cuando un punto de anclaje ya no tiene ning&uacute;n grupo de reglas
d219 4
a222 4
Las reglas en el anclaje <tt><i>ssh</i></tt> s&oacute;lo se
eval&uacute;an para los paquetes TCP destinados al puerto 22 que entran
en la interfaz fxp0.  Entonces se a&ntilde;aden las reglas al
<tt>anchor</tt>, del siguiente modo:
d236 1
a236 1
<h2>Manipulaci&oacute;n de Subgrupos de Reglas con Nombre</h2>
d238 4
a241 4
La manipulaci&oacute;n de los subgrupos de reglas con nombre se realiza
mediante <tt>pfctl</tt>.  Se puede usar <tt>pfctl</tt> para
a&ntilde;adir y eliminar reglas de un grupo de reglas sin recargar el
grupo de reglas principal.
d244 2
a245 2
Para ver una lista de todas las reglas en el grupo de reglas
<tt><i>allowed</i></tt> adjunto al anclaje <tt><i>ssh</i></tt>:
d253 2
a254 1
Para limpiar todas las reglas de filtrado de este mismo grupo de reglas:
d262 1
a262 1
Si se omite el nombre del grupo de reglas, la acci&oacute;n se
d267 1
a267 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+3.4"><tt>pfctl(8)</tt></a>.
d270 2
a271 1
[<a href="logging.html">Anterior: Registros de Bit&aacute;cora</a>]
d273 2
a274 2
[<a href="shortcuts.html">Siguiente: Atajos para la Creaci&oacute;n de
Grupos de Reglas</a>]
d282 1
a282 1
Originally [OpenBSD: anchors.html,v 1.8 ]<br>
d284 1
a284 1
$Translation: anchors.html,v 1.8 2003/11/17 19:22:08 horacio Exp $
@


1.6
log
@sync with steelix cvs
@
text
@d49 1
a49 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+3.3"><tt>pfctl(8)</tt></a>,
d167 1
a167 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+3.3">pfctl(8)</a>.
d239 1
a239 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+3.3"><tt>pfctl(8)</tt></a>.
d253 1
a253 1
Originally [OpenBSD: anchors.html,v 1.7 ]<br>
d255 1
a255 1
$Translation: anchors.html,v 1.7 2003/09/27 13:46:08 horacio Exp $
@


1.5
log
@sync with steelix cvs
@
text
@d103 1
a103 1
pass  out on $ext_if all keep state<br>
d186 1
a186 1
pass  out on $ext_if all keep state<br>
d192 1
a192 1
Las reglas en el anclaje <tt>anchor <i>ssh</i></tt> s&oacute;lo se
d253 1
a253 1
Originally [OpenBSD: anchors.html,v 1.6 2003/09/16 01:23:49 nick Exp ]<br>
d255 1
a255 1
$Translation: anchors.html,v 1.6 2003/09/19 22:10:58 horacio Exp $
@


1.4
log
@sync with steelix translation CVS
@
text
@d253 1
a253 1
Originally [OpenBSD: anchors.html,v 1.5 2003/06/23 01:51:36 nick Exp ]<br>
d255 1
a255 1
$Translation: anchors.html,v 1.5 2003/07/13 12:22:53 horacio Exp $
@


1.3
log
@sync with steelix translation CVS
@
text
@d4 1
a4 1
<title>PF: Anclajes y Grupos de Reglas con Nombre</title>
d27 1
a27 1
<h1><font color="#e00000">PF: Anclajes y Grupos de Reglas con
d35 1
a35 1
<li><a href="#named">Grupos de Reglas con Nombre</a>
d37 1
a37 1
<li><a href="#manip">Manipulaci&oacute;n de Grupos de Reglas con
d50 1
a50 1
raz&oacute;n por la cual proveen un modo conveniente de alterar
d62 1
a62 1
<li><tt>anchor <i>name</i></tt> - eval&uacute;a todas las
d64 2
a65 2
<i><tt>name</tt></i>
<li><tt>binat-anchor <i>name</i></tt> - eval&uacute;a todas las reglas
d67 7
a73 5
<i><tt>name</tt></i>
<li><tt>nat-anchor <i>name</i></tt> - eval&uacute;a todas las reglas de
<a href="nat.html"><tt>nat</tt></a> en el anclaje <i><tt>name</tt></i>
<li><tt>rdr-anchor <i>name</i></tt> - eval&uacute;a todas las reglas de
<a href="rdr.html"><tt>rdr</tt></a> en el anclaje <i><tt>name</tt></i>
d80 1
a80 1
<h2>Grupos de Reglas con Nombre</h2>
d82 1
a82 1
Un grupo de reglas con nombre es una agrupaci&oacute;n de reglas de
d90 5
a94 5
coincida con una reglas de filtrado que use la opci&oacute;n
<tt>quick</tt> o una regla de traducci&oacute;n dentro del mismo
anclaje, en cuyo caso la coincidencia se considerar&aacute; finalizada y
terminar&aacute; la evaluaci&oacute;n de las reglas, tanto en el anclaje
como en el grupo de reglas principal.
d114 1
a114 1
anclaje <tt><i>goodguys</i></tt>, se pueden usar las siguientes
d124 5
a128 5
Esto a&ntilde;ade una regla <tt>pass</tt> al grupo de reglas llamado
<tt><i>ssh</i></tt>, adjunto al anclaje <tt><i>goodguys</i></tt>.  PF
eval&uacute;a esta regla (y cualquier otra reglas de filtrado que se
a&ntilde;ada) cuando llega a la l&iacute;nea <tt>anchor goodguys</tt> en
el grupo de reglas principal.
d131 2
a132 2
Tambi&eacute;n se puede guardar y cargar las reglas desde un fichero de
texto:
d150 17
a166 17
grupo de reglas con nombre, usando la misma sintaxis y opciones que para
las reglas cargadas en el grupo de reglas principal.  Sin embargo, hay
que tener en cuenta que tambi&eacute;n se debe definir dentro del grupo
de reglas con nombre cualquier <a href="macros.html">macro</a> que
est&eacute; siendo utilizada;  Las macros que se encuentran definidas en
el grupo de reglas principal <i>no</i> son visibles desde los grupos de
reglas con nombre.

<p>
Cada grupo de reglas con nombre, as&iacute; como el grupo de reglas
principal, existe de forma separada de los otros grupos de reglas.  Las
operaciones que se realicen en un grupo de reglas, como la limpieza de
las reglas, no afecta a ninguno de los otros grupos.  Adem&aacute;s, si
se elimina un punto de anclaje del grupo de reglas principal no se
destruye el anclaje ni cualquier grupo de reglas con nombre que
est&eacute; adjunto a ese anclaje.  Un grupo de reglas con nombre no se
destruye hasta que se han limpiado todas las reglas usando
d179 1
a179 1
procesan si el paquete coincide con la definici&oacute;n de la regla
d192 4
a195 4
Las reglas en <tt>anchor <i>ssh</i></tt> s&oacute;lo se eval&uacute;an
para los paquetes TCP destinados al puerto 22 que entran en la interfaz
fxp0.  Entonces se a&ntilde;aden las reglas al <tt>anchor</tt>, del
siguiente modo:
d209 1
a209 1
<h2>Manipulaci&oacute;n de Grupos de Reglas con Nombre</h2>
d211 1
a211 1
La manipulaci&oacute;n de los grupos de reglas con nombre se realiza
d255 1
a255 1
$Translation: anchors.html,v 1.4 2003/06/23 17:54:12 horacio Exp $
@


1.2
log
@sync with steelix translation CVS
@
text
@d146 24
d251 1
a251 1
Originally [OpenBSD: anchors.html,v 1.4 2003/06/13 02:54:08 nick Exp ]<br>
d253 1
a253 1
$Translation: anchors.html,v 1.3 2003/06/15 11:40:23 horacio Exp $
@


1.1
log
@
initial translation from horacio
@
text
@d227 1
a227 1
Originally [OpenBSD: anchors.html,v 1.3 2003/05/15 03:03:54 nick Exp ]<br>
d229 1
a229 1
$Translation: anchors.html,v 1.2 2003/05/26 09:12:05 horacio Exp $
@

