head	1.11;
access;
symbols;
locks; strict;
comment	@# @;


1.11
date	2014.04.01.17.14.10;	author nick;	state dead;
branches;
next	1.10;

1.10
date	2011.02.25.12.35.57;	author ajacoutot;	state Exp;
branches;
next	1.9;

1.9
date	2004.09.02.12.46.38;	author jufi;	state Exp;
branches;
next	1.8;

1.8
date	2004.01.04.22.29.12;	author horacio;	state Exp;
branches;
next	1.7;

1.7
date	2003.12.03.21.40.56;	author horacio;	state Exp;
branches;
next	1.6;

1.6
date	2003.11.17.19.44.24;	author horacio;	state Exp;
branches;
next	1.5;

1.5
date	2003.09.20.07.00.26;	author horacio;	state Exp;
branches;
next	1.4;

1.4
date	2003.07.13.13.11.41;	author jufi;	state Exp;
branches;
next	1.3;

1.3
date	2003.07.04.22.43.46;	author jufi;	state Exp;
branches;
next	1.2;

1.2
date	2003.06.15.12.27.34;	author jufi;	state Exp;
branches;
next	1.1;

1.1
date	2003.05.28.14.39.30;	author jufi;	state Exp;
branches;
next	;


desc
@@


1.11
log
@
Abandon translations, per deraadt@@ and ajacoutot@@.
@
text
@<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>PF: Cuestiones relacionadas con FTP</title><link rev="made" href="mailto:www@@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name="resource-type" content="document">
<meta name="description"   content="the OpenBSD FAQ page">
<meta name="keywords"      content="openbsd,faq,pf">
<meta name="distribution"  content="global">
</head>

<!--
Copyright (c) 2003, Nick Holland <nick@@openbsd.org>
Copyright (c) 2003, 2004, Joel Knight <enabled@@myrealbox.com>

Permission to use, copy, modify, and distribute this documentation for
any purpose with or without fee is hereby granted, provided that the
above copyright notice and this permission notice appear in all copies.

THE DOCUMENTATION IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL
WARRANTIES WITH REGARD TO THIS DOCUMENTATION INCLUDING ALL IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE
AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL
DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR
PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS DOCUMENTATION
-->

<body bgcolor="#ffffff" text="#000000">
<!-- Passes validator.w3.org, please keep it this way;
please, use a max of 72 chars per line -->

<a href="../../es/index.html">
<img alt="[OpenBSD]" height="30" width="141" src="../../../images/smalltitle.gif" border="0">
</a>
<p>
[<a href="perf.html">Anterior: Rendimiento</a>]
[<a href="index.html">Contenido</a>]
[<a href="authpf.html">Siguiente: Shell de usuario para pasarelas
de autentificación</a>]

<p>
<h1><font color="#e00000">PF: Cuestiones relacionadas con
FTP</font></h1>
<hr>

<h3>Índice de contenidos</h3>
<ul>
<li><a href="#modes">Modos de FTP</a>
<li><a href="#client">Cliente de FTP detrás de un cortafuegos</a>
<li><a href="#server">Autoprotección de un servidor de FTP con
PF</a>
<li><a href="#natserver">Servidor de FTP protegido por un cortafuegos de
PF externo con NAT</a>
<li><a href="#info">Más información sobre FTP</a>
<li><a href="#tftp-proxy">Proxy de TFTP</a>
</ul>

<hr>

<a name="modes"></a>
<h2>Modos de FTP</h2>
FTP es un protocolo que se remonta a los tiempos cuando Internet era una
pequeña colección de computadoras, basada en la confianza mutua, 
y todo el mundo se conocía.  En esos tiempos no
existía la necesidad de filtrar o de reforzar la seguridad.  Como
consecuencia, FTP no se diseñó para el filtrado ni para
que pasara a través de cortafuegos o para que funcionara con NAT.

<p>
Se puede usar FTP de dos modos:  pasivo o activo.  Generalmente, la
elección entre el modo activo o el pasivo se toma para determinar
quién tiene el problema con los cortafuegos.  La realidad es que
para mantener a los usuarios contentos tendrá que dar soporte 
para ambos modos.

<p>
Con FTP activo, cuando un usuario se conecta a un servidor de FTP remoto
y requiere información o un fichero de este, el servidor
de FTP abre una nueva conexión de vuelta al cliente para
transferir los datos que le ha requerido.  Esto se conoce como la
<i>conexión de datos</i>.  Para empezar, el cliente de FTP escoge
un puerto aleatorio por el que recibirá la conexión de
datos.  El cliente envía al servidor de FTP el número de
puerto que ha escogido, y permanece a la espera de recibir una
conexión entrante por este puerto.  Entonces el servidor de FTP
inicia una conexión a la dirección del cliente por el
puerto elegido, y da comienzo a la transferencia de los datos.  Esto
supone un problema para los usuarios que intenten obtener acceso a
servidores de FTP que se encuentren detrás de una pasarela de
NAT.  Debido al funcionamiento propio de NAT, el servidor de FTP inicia
la conexión de datos conectándose a la dirección
externa de la pasarela de NAT por el puerto elegido.  La máquina
de NAT recibe esta conexión, pero como no tiene asignación
para el paquete en su tabla de estado, lo bloquea y no lo entrega al
cliente.

<p>
Con el modo pasivo de FTP (el modo predeterminado con el cliente de
<a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftp&amp;sektion=1"
>ftp(1)</a> de OpenBSD),
el cliente envía un requerimiento al servidor para que
éste escoja un puerto aleatorio en el que permanezca a la escucha
en espera de la conexión de datos.  El servidor informa al
cliente sobre el puerto que ha escogido, y el cliente se conecta a este
puerto para la transferencia de datos.  Desafortunadamente, esto no es
siempre posible o deseable debido a la posiblidad de que exista un
cortafuegos delante del servidor de FTP bloqueando la conexión de
datos entrante.  En OpenBSD, ftp(1) está configurado para usar el
modo pasivo de forma predeterminada; para forzar el modo activo de FTP,
hay que usar el indicador -A de la orden ftp, o desactivar el modo
pasivo mediante la orden <tt>passive off</tt> desde el punto de
inserción (<i>prompt</i>) de <tt>ftp&gt;</tt>.


<a name="client"></a>
<h2>Cliente de FTP detrás de un cortafuegos</h2>
<p>
Como se ha indicado anteriormente, FTP no va demasiado bien 
a través de NAT y cortafuegos.

<p>
PF dispone de una solución para esta situación,
redireccionando el tráfico de FTP a través de un servidor
<i>proxy</i> de FTP. Este proceso actúa como
&laquo;guía&raquo; para el tráfico de FTP a través
de la pasarela/cortafuegos de NAT, añadiendo activamente 
las reglas necesarias y eliminándolas cuando ya no sean necesarias
a través del sistema de <a href="anchors.html">anclajes</a> de PF.  
El <i>proxy</i> de FTP que usa PF es 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftp-proxy&amp;sektion=8&amp;manpath=OpenBSD+4.8"
>ftp-proxy(8)</a>.

<p>
Para activarla, añada una línea parecida a la
siguiente en la sección de reglas de <tt>pf.conf</tt>:

<blockquote>
<tt>
pass in quick on $int_if proto tcp to port 21 rdr-to 127.0.0.1 port 8021
</tt>
</blockquote>

<p>
Esto redirecciona el FTP de nuestros clientes hacia el programa 
ftp-proxy(8), que está a la escucha en nuestra máquina por el 
puerto 8021.

<p>
También se necesita un anclaje en la sección de reglas:
<blockquote>
<tt>
anchor "ftp-proxy/*"
</tt>
</blockquote>

Evidentemente,  el servidor proxy debe estar iniciado y ejecutándose
en la máquina OpenBSD. Esto se hace incluyendo la siguiente línea en
<tt>/etc/rc.conf.local</tt>:

<blockquote>
<tt>
ftpproxy_flags=""
</tt>
</blockquote>

<p>
El programa ftp-proxy puede arrancarse como root para 
activarlo a fin de evitar un reinicio del sistema.

<p>
ftp-proxy está a la escucha en el puerto 8021, 
el mismo puerto al que la línea <tt>rdr-to</tt> 
precedente estaba enviando el tráfico de FTP.

<p>
Para soportar el modo de conexiones activas de 
determinados clientes (quisquillosos), es posible que 
necesite utilizar el parámetro '-r' en ftp-proxy(8).

<a name="server"></a>
<h2>"Autoprotección" de un servidor de FTP con PF</h2>
<p>
Para este caso, PF estaría funcionando en el mismo servidor de
FTP, en lugar de hacerlo en una máquina separada de cortafuegos.
Cuando dé servicio a una conexión de FTP pasiva, FTP
usará un puerto TCP alto, aleatorio, para los datos entrantes.
El servidor de FTP nativo de OpenBSD <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&amp;sektion=8"
>ftpd(8)</a> está configurado para usar
de forma predeterminada un puerto en el rango entre 49152 y 65535.
Obviamente, es necesario permitir el paso para estos puertos, junto con
el puerto 21 (el puerto de control de FTP):

<blockquote>
<tt>
pass in on $ext_if proto tcp to port 21<br>
pass in on $ext_if proto tcp to port &gt; 49151
</tt>
</blockquote>

<p>
Nótese que, si lo desea, es posible restringir el rango de puertos de forma
considerable.  En el caso del programa
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&amp;sektion=8"
>ftpd(8)</a> de OpenBSD, esto se hace usando las variables
<tt>net.inet.ip.porthifirst</tt> y <tt>net.inet.ip.porthilast</tt> de
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysctl&amp;sektion=8"
>sysctl(8)</a>.

<a name="natserver"></a>
<h2>Servidor de FTP protegido por un cortafuegos de PF con NAT</h2>
En este caso, el cortafuegos debe redireccionar el tráfico al
servidor de FTP, además de no bloquear los puertos requeridos.
Para lograr esto, volvemos de nuevo a ftp-proxy(8).

<p>
ftp-proxy(8) se puede ejecutar en un modo que hace que se 
redireccionen toda las conexiones FTP a un determinado servidor FTP.
Básicamente configuramos el proxy para que escuche en el 
puerto 21 del cortafuegos y redireccionamos las conexiones 
al servidor final.

<p>
Edite el fichero <tt>/etc/rc.conf.local</tt> y añada lo siguiente:

<blockquote>
<tt>
ftpproxy_flags="-R 10.10.10.1 -p 21 -b 192.168.0.1"
</tt>
</blockquote>

Aquí 10.10.10.1 es la dirección IP del servidor FTP real, 
21 es el puerto en el que queremos que ftp-proxy (8) escuche 
y 192.168.0.1 es la dirección en el cortafuegos para el proxy.

Ahora, para las reglas de pf.conf:

<blockquote>
<tt>
ext_ip = "192.168.0.1"<br>
ftp_ip = "10.10.10.1"<br>
<br>
match out on $ext_if inet from $int_if nat-to ($ext_if)<br>
<br>
anchor "ftp-proxy/*"<br>
pass in on $ext_if inet proto tcp to $ext_ip port 21<br>
pass out on $int_if inet proto tcp to $ftp_ip port 21 user proxy
</tt>
</blockquote>

<p>
Aquí permitimos la conexión entrante al puerto 21 en el interfaz
externo, así como la conexión de salida correspondiente al 
servidor de FTP.
La adición de "user proxy" a la regla de salida garantiza que solo
se permiten las conexiones iniciadas por ftp-proxy(8).

<p>
Tenga en cuenta que si usted desea ejecutar ftp-proxy(8) para 
proteger un servidor FTP sin impedir a los clientes salir 
fuera del firewall, son necesarias dos instancias de ftp-proxy.

<a name="info"></a>
<h2>Más información sobre FTP</h2>
<p>
Se puede encontrar más información sobre el filtrado  
y el funcionamiento de FTP en el siguiente documento:
<ul>
<li><a href="http://www.pintday.org/whitepapers/ftp-review.shtml">FTP
Reviewed</a>
</ul>

<a name="tftp-proxy"></a>
<h2>Proxy de TFTP</h2>

<p>
El Protocolo TFTP (<i>Trivial File Transfer Protocol</i>, 
&laquo;Protocolo de Transferencia de Ficheros Trivial&raquo;) 
sufre el mismo tipo de limitaciones que FTP cuando 
trata de atravesar un cortafuegos. Por suerte, PF 
dispone de un proxy de ayuda para TFTP llamado 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tftp-proxy&amp;sektion=8&amp;manpath=OpenBSD+4.8"
>tftp-proxy(8)</a>. 

<p>
tftp-proxy(8) se configura de una manera similar a como se hizo con 
ftp-proxy(8) en la sección anterior <a href="#client">Cliente de FTP detrás 
de un cortafuegos</a>. 


<blockquote>
<tt>
match out on $ext_if from $int_if nat-to ($ext_if)<br>
anchor "tftp-proxy/*"<br>
pass in quick on $int_if proto udp from $int_if to port tftp \<br>
&nbsp;&nbsp;&nbsp;&nbsp;rdr-to 127.0.0.1 port 6969<br>
<br>
anchor "tftp-proxy/*"
</tt>
</blockquote>

<p>
Las reglas anteriores autorizan la salida del tráfico TFTP 
de la red interna a los servidores TFTP en la la red externa.

<p>
El último paso es la activación de tftp-proxy en 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=inetd.conf&amp;sektion=5"
>inetd.conf(5)</a> a fin de que escuche en el mismo puerto que la regla
<tt>rdr-to</tt> mencionada anteriormente, en este caso 6969.

<blockquote>
<tt>
127.0.0.1:6969  dgram   udp   wait  root  /usr/libexec/tftp-proxy tftp-proxy
</tt>
</blockquote>

<p>
A diferencia de ftp-proxy(8), tftp-proxy(8) se invoca vía inetd.

<p>
[<a href="perf.html">Anterior: Rendimiento</a>]
[<a href="index.html">Contenido</a>]
[<a href="authpf.html">Siguiente: Siguiente: Shell de usuario para pasarelas
de autentificación</a>]

<p>
<hr>
<a href="index.html"><img height="24" width="24" src="../../../images/back.gif" border="0" alt="[back]"></a> 
<a href="mailto:www@@openbsd.org">www@@openbsd.org</a>
<br>
<small>
<!--
Originally [OpenBSD: ftp.html,v 1.32 ]<br>
$Translation: ftp.html,v 1.14 2011/02/25 12:16:18 mvidal Exp $<br>
-->
$OpenBSD: ftp.html,v 1.10 2011/02/25 12:35:57 ajacoutot Exp $
</small>

</body>
</html> 
@


1.10
log
@Sync with Steelix CVS
@
text
@d339 1
a339 1
$OpenBSD$
@


1.9
log
@Sync with Steelix CVS
@
text
@d4 1
a4 2
<title>PF: Cuestiones Relacionadas con FTP</title>
<link rev="made" href="mailto:www@@openbsd.org">
a5 1
<meta http-equiv="Content-Language" content="es">
d7 2
a8 2
<meta name="description"   content="Preguntas Frecuentes de OpenBSD">
<meta name="keywords"      content="openbsd,preguntas frecuentes,faq,pf">
d34 3
a36 1
<img alt="[OpenBSD]" height="30" width="141" src="../../../images/smalltitle.gif">
d40 2
a41 2
[<a href="authpf.html">Siguiente: <i>Shell</i> de Usuario para la
Autenticaci&oacute;n de Pasarelas</a>]
d44 1
a44 1
<h1><font color="#e00000">PF: Cuestiones Relacionadas con
d48 1
a48 1
<h3>&Iacute;ndice de Contenidos</h3>
d51 2
a52 2
<li><a href="#client">Cliente de FTP detr&aacute;s de un Cortafuegos</a>
<li><a href="#server">Autoprotecci&oacute;n de un Servidor de FTP con
d54 4
a57 3
<li><a href="#natserver">Servidor de FTP Protegido por un Cortafuegos de
PF Externo con NAT</a>
<li><a href="#info">M&aacute;s Informaci&oacute;n sobre FTP</a>
a63 1
<p>
d65 5
a69 5
peque&ntilde;a y amigable colecci&oacute;n de computadoras, y todos los
operadores se conoc&iacute;an entre ellos.  En esos tiempos no
exist&iacute;a la necesidad de filtrar o de reforzar la seguridad.  Como
consecuencia, FTP no se dise&ntilde;&oacute; para el filtrado ni para
que pasara a trav&eacute;s de cortafuegos o para que funcionara con NAT.
d73 4
a76 4
elecci&oacute;n entre el modo activo o el pasivo se toma para determinar
qui&eacute;n tiene el problema con los cortafuegos.  La realidad es que
para mantener a los usuarios contentos ser&aacute; el administrador
quien tenga que dar soporte para ambos modos.
d80 2
a81 2
y requiere informaci&oacute;n o un fichero de &eacute;ste, el servidor
de FTP abre una nueva conexi&oacute;n de vuelta al cliente para
d83 3
a85 3
<i>conexi&oacute;n de datos</i>.  Para empezar, el cliente de FTP escoge
un puerto aleatorio por el que recibir&aacute; la conexi&oacute;n de
datos.  El cliente env&iacute;a al servidor de FTP el n&uacute;mero de
d87 2
a88 2
conexi&oacute;n entrante por este puerto.  Entonces el servidor de FTP
inicia una conexi&oacute;n a la direcci&oacute;n del cliente por el
d91 1
a91 1
servidores de FTP que se encuentren detr&aacute;s de una pasarela de
d93 3
a95 3
la conexi&oacute;n de datos conect&aacute;ndose a la direcci&oacute;n
externa de la pasarela de NAT por el puerto elegido.  La m&aacute;quina
de NAT recibe esta conexi&oacute;n, pero como no tiene asignaci&oacute;n
d101 6
a106 4
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftp&amp;sektion=1&amp;manpath=OpenBSD+3.5">ftp(1)</a> de OpenBSD),
el cliente env&iacute;a un requerimiento al servidor para que
&eacute;ste escoja un puerto aleatorio en el que permanezca a la escucha
en espera de la conexi&oacute;n de datos.  El servidor informa al
d110 2
a111 2
cortafuegos delante del servidor de FTP bloqueando la conexi&oacute;n de
datos entrante.  En OpenBSD, ftp(1) est&aacute; configurado para usar el
d115 1
a115 1
inserci&oacute;n de <tt>ftp&gt;</tt>.
d119 5
a123 1
<h2>Cliente de FTP detr&aacute;s de un Cortafuegos</h2>
d125 10
a134 2
Como se ha indicado anteriormente, FTP no pasa muy bien a trav&eacute;s
de NAT y cortafuegos.
d137 2
a138 9
PF dispone de una soluci&oacute;n para esta situaci&oacute;n,
redireccionando el tr&aacute;fico de FTP a trav&eacute;s de un servidor
<i>proxy</i> de FTP, un proceso que act&uacute;a como
&laquo;gu&iacute;a&raquo; para el tr&aacute;fico de FTP a trav&eacute;s
de la pasarela/cortafuegos de NAT.  La <i>proxy</i> de FTP que usan
OpenBSD y PF es
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftp-proxy&amp;sektion=8&amp;manpath=OpenBSD+3.5">ftp-proxy(8)</a>.
Para activarla, hay que a&ntilde;adir una l&iacute;nea parecida a la
siguiente en la secci&oacute;n de NAT del fichero <tt>pf.conf</tt>:
d142 1
a142 2
rdr on $int_if proto tcp from any to any port 21 -&gt; 127.0.0.1 \<br>
&nbsp;&nbsp;&nbsp;port 8021
d147 3
a149 4
Una breve explicaci&oacute;n de esta l&iacute;nea es:  &laquo;El
tr&aacute;fico en la interfaz interna se redirecciona al servidor de
<i>proxy</i> de esta m&aacute;quina, que est&aacute; a la escucha por el
puerto 8021&raquo;.
d152 1
a152 5
Para que esto funcione, es obvio que el servidor de <i>proxy</i> debe
estar iniciado y funcionando en la m&aacute;quina de OpenBSD.  Para ello
hay que introducir la siguiente l&iacute;nea en el fichero
<tt>/etc/inetd.conf</tt>:

d155 1
a155 2
127.0.0.1:8021 stream tcp nowait root /usr/libexec/ftp-proxy \<br>
&nbsp;&nbsp;&nbsp;ftp-proxy
d159 3
a161 5
<p>
y a continuaci&oacute;n reiniciar el sistema o enviar una se&ntilde;al
de 'HUP' a
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=inetd&amp;sektion=8&amp;manpath=OpenBSD+3.5">inetd(8)</a>.
Una forma de enviar la se&ntilde;al de 'HUP' es mediante la orden:
d165 1
a165 1
kill -HUP `cat /var/run/inetd.pid`
d170 2
a171 6
Se podr&aacute; observar que ftp-proxy estar&aacute; a la escucha en el
puerto 8021, el mismo puerto al que la declaraci&oacute;n de
<tt>rdr</tt> anterior estaba enviando el tr&aacute;fico de FTP.  La
elecci&oacute;n del puerto 8021 es arbitraria, aunque 8021 es una buena
elecci&oacute;n ya que no est&aacute; definido para ninguna otra
aplicaci&oacute;n.
d174 3
a176 4
N&oacute;tese que ftp-proxy(8) sirve para ayudar a los <b>clientes de
FTP</b> que se encuentran detr&aacute;s de un filtro de PF, no para
manejar un <b>servidor de FTP</b> que se encuentre detr&aacute;s de un
filtro de PF.
d178 4
d184 1
a184 1
<h2>Autoprotecci&oacute;n de un Servidor de FTP con PF</h2>
d186 6
a191 6
Para este caso, PF estar&iacute;a funcionando en el mismo servidor de
FTP, en lugar de hacerlo en una m&aacute;quina separada de cortafuegos.
Cuando d&eacute; servicio a una conexi&oacute;n de FTP pasiva, FTP
usar&aacute; un puerto TCP alto, aleatorio, para los datos entrantes.
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&amp;sektion=8&amp;manpath=OpenBSD+3.5">ftpd(8)</a>,
el servidor nativo de FTP en OpenBSD, est&aacute; configurado para usar
d198 2
a199 3
pass in on $ext_if proto tcp from any to any port 21 keep state<br>
pass in on $ext_if proto tcp from any to any port &gt; 49151 \<br>
&nbsp;&nbsp;&nbsp;keep state
d204 4
a207 4
N&oacute;tese que es posible restringir el rango de puertos de forma
considerable;  en el caso del programa
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&amp;sektion=8&amp;manpath=OpenBSD+3.5">ftpd(8)</a>
de OpenBSD, esto se hace usando las variables
d209 2
a210 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysctl&amp;sektion=8&amp;manpath=OpenBSD+3.5">sysctl(8)</a>.
d212 5
a217 2
<a name="natserver"></a>
<h2>Servidor de FTP Protegido por un Cortafuegos de PF con NAT</h2>
d219 5
a223 6
En este caso, el cortafuegos debe redireccionar el tr&aacute;fico al
servidor de FTP, adem&aacute;s de no bloquear los puertos requeridos.
Para el ejemplo de esta secci&oacute;n, asumiremos que el servidor de
FTP en cuesti&oacute;n es el de
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&amp;sektion=8&amp;manpath=OpenBSD+3.5">ftpd(8)</a>
est&aacute;ndar de OpenBSD usando el rango de puertos predeterminado.
d226 13
a238 2
He aqu&iacute; un ejemplo de un subgrupo de reglas con el que se
obtendr&iacute;a esto:
d242 2
a243 6
ftp_server = &quot;10.0.3.21&quot;<br>
<br>
rdr on $ext_if proto tcp from any to any port 21 -&gt; $ftp_server \<br>
&nbsp;&nbsp;&nbsp;port 21<br>
rdr on $ext_if proto tcp from any to any port 49152:65535 -&gt; \<br>
&nbsp;&nbsp;&nbsp;$ftp_server port 49152:65535<br>
d245 1
a245 5
# hacia adentro en $ext_if<br>
pass in quick on $ext_if proto tcp from any to $ftp_server \<br>
&nbsp;&nbsp;&nbsp;port 21 keep state<br>
pass in quick on $ext_if proto tcp from any to $ftp_server \<br>
&nbsp;&nbsp;&nbsp;port &gt; 49151 keep state<br>
d247 3
a249 5
# hacia afuera en $int_if<br>
pass out quick on $int_if proto tcp from any to $ftp_server \<br>
&nbsp;&nbsp;&nbsp;port 21 keep state<br>
pass out quick on $int_if proto tcp from any to $ftp_server \<br>
&nbsp;&nbsp;&nbsp;port &gt; 49151 keep state
d253 12
d266 1
a266 1
<h2>M&aacute;s Informaci&oacute;n sobre FTP</h2>
d268 2
a269 2
Se puede encontrar m&aacute;s informaci&oacute;n sobre el filtrado de
OpenBSD y el funcionamiento de FTP en el siguiente documento:
d275 48
d326 2
a327 2
[<a href="authpf.html">Siguiente: <i>Shell</i> de Usuario para la
Autenticaci&oacute;n de Pasarelas</a>]
d331 1
a331 1
<a href="index.html"><img height="24" width="24" src="../../../images/back.gif" border="0" alt="[&Iacute;ndice]"></a> 
d335 5
a339 3
Originally [OpenBSD: ftp.html,v 1.14 ]<br>
$OpenBSD$<br>
$Translation: ftp.html,v 1.13 2004/08/31 16:33:10 santana Exp $
d341 1
@


1.8
log
@Sync with Steelix CVS
@
text
@a11 1
<meta name="copyright"     content="Este documento es copyright 2002-2004 de OpenBSD.">
d14 18
d101 1
a101 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftp&amp;sektion=1&amp;manpath=OpenBSD+3.4">ftp(1)</a> de OpenBSD),
d129 1
a129 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftp-proxy&amp;sektion=8&amp;manpath=OpenBSD+3.4">ftp-proxy(8)</a>.
d162 1
a162 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=inetd&amp;sektion=8&amp;manpath=OpenBSD+3.4">inetd(8)</a>.
d193 1
a193 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&amp;sektion=8&amp;manpath=OpenBSD+3.4">ftpd(8)</a>,
d210 1
a210 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&amp;sektion=8&amp;manpath=OpenBSD+3.4">ftpd(8)</a>
d213 1
a213 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysctl&amp;sektion=8&amp;manpath=OpenBSD+3.4">sysctl(8)</a>.
d223 1
a223 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&amp;sektion=8&amp;manpath=OpenBSD+3.4">ftpd(8)</a>
d239 1
d243 6
d275 1
a275 1
Originally [OpenBSD: ftp.html,v 1.11 ]<br>
d277 1
a277 1
$Translation: ftp.html,v 1.12 2004/01/04 21:32:07 horacio Exp $
@


1.7
log
@Sync with Steelix CVS
@
text
@d12 1
a12 1
<meta name="copyright"     content="Este documento es copyright 2002-2003 de OpenBSD.">
d251 1
a251 1
Originally [OpenBSD: ftp.html,v 1.10 ]<br>
d253 1
a253 1
$Translation: ftp.html,v 1.11 2003/12/01 22:53:16 horacio Exp $
@


1.6
log
@Sync with Steelix CVS
@
text
@d114 1
a114 1
siguiente en la secci&oacute;n de NAT del fichero <tt>/etc/pf.conf</tt>:
d251 1
a251 1
Originally [OpenBSD: ftp.html,v 1.9 ]<br>
d253 1
a253 1
$Translation: ftp.html,v 1.10 2003/11/17 19:22:08 horacio Exp $
@


1.5
log
@sync with steelix cvs
@
text
@d84 1
a84 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftp&amp;sektion=1&amp;manpath=OpenBSD+3.3">ftp(1)</a> de OpenBSD),
d112 1
a112 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftp-proxy&amp;sektion=8&amp;manpath=OpenBSD+3.3">ftp-proxy(8)</a>.
d145 1
a145 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=inetd&amp;sektion=8&amp;manpath=OpenBSD+3.3">inetd(8)</a>.
d176 1
a176 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&amp;sektion=8&amp;manpath=OpenBSD+3.3">ftpd(8)</a>,
d193 1
a193 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&amp;sektion=8&amp;manpath=OpenBSD+3.3">ftpd(8)</a>
d196 1
a196 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysctl&amp;sektion=8&amp;manpath=OpenBSD+3.3">sysctl(8)</a>.
d206 1
a206 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&amp;sektion=8&amp;manpath=OpenBSD+3.3">ftpd(8)</a>
d251 1
a251 1
Originally [OpenBSD: ftp.html,v 1.8 2003/09/16 01:23:49 nick Exp ]<br>
d253 1
a253 1
$Translation: ftp.html,v 1.9 2003/09/19 22:10:58 horacio Exp $
@


1.4
log
@sync with steelix translation CVS
@
text
@d251 1
a251 1
Originally [OpenBSD: ftp.html,v 1.7 2003/06/29 20:28:24 nick Exp ]<br>
d253 1
a253 1
$Translation: ftp.html,v 1.8 2003/07/13 12:22:53 horacio Exp $
@


1.3
log
@sync with steelix translation CVS
@
text
@d48 5
a52 5
peque&ntilde;a y amigable colecci&oacute;n de computadores y todos los
operadores se conoc&iacute;an entre ellos.  En esos tiempos, no
exist&iacute;a la necesidad de filtrar o de reforzar la seguridad.  FTP
no se dise&ntilde;&oacute; para el filtrado ni para que pasara a
trav&eacute;s de cortafuegos o para que funcionara con NAT.
d55 2
a56 2
Se puede usar FTP de dos modos, pasivo o activo.  Generalmente, la
elecci&oacute;n entre activo o pasivo se toma para determinar
d59 1
a59 1
tendr&aacute; que dar soporte ambos modos.
d72 6
a77 6
puerto elegido, y empieza la transferencia de los datos.  Esto supone un
problema para los usuarios que intenten obtener acceso a servidores de
FTP que se encuentren detr&aacute;s de una pasarela de NAT.  Debido al
funcionamiento propio de NAT, el servidor de FTP inicia la
conexi&oacute;n de datos conect&aacute;ndose a la direcci&oacute;n
externa de la pasarela de NAt por el puerto elegido.  La m&aacute;quina
d86 1
a86 1
&eacute;ste escoja un puerto aleatorio en el que se quede a la escucha
d90 1
a90 1
siempre posible o deseable a causa de la posiblidad de que exista un
d93 4
a96 4
modo pasivo; para forzar el modo activo de FTP, hay que usar el
indicador -A de la orden ftp, o desactivar el modo pasivo mediante la
orden <tt>passive off</tt> desde el punto de inserci&oacute;n de
<tt>ftp&gt;</tt>.
d106 6
a111 5
PF provee una soluci&oacute;n a esta situaci&oacute;n, redireccionando
el tr&aacute;fico de FTP a trav&eacute;s de un servidor <i>proxy</i> de
FTP, un proceso que act&uacute;a como &laquo;gu&iacute;a&raquo; del
tr&aacute;fico de FTP a trav&eacute;s de la pasarela/cortafuegos de NAT.
La <i>proxy</i> de FTP que usan OpenBSD y PF es
d130 3
a132 3
Para que esto funcione es obvio que el servidor de <i>proxy</i> debe
estar iniciado y funcionando en la m&aacute;quina de OpenBSD.  Esto se
hace introduciendo la siguiente l&iacute;nea en el fichero
d143 2
a144 2
y a continuaci&oacute;n reiniciando el sistema o enviando una
se&ntilde;al de 'HUP' a
d155 6
a160 5
Prodemos ver que ftp-proxy estar&aacute; a la escucha en el puerto 8021,
el mismo puerto al que la declaraci&oacute;n de <tt>rdr</tt> anterior
estaba enviando el tr&aacute;fico de FTP.  La elecci&oacute;n del puerto
8021 es arbitraria, aunque 8021 es una buena elecci&oacute;n ya que no
est&aacute; definido para ninguna otra aplicaci&oacute;n.
d175 1
a175 1
usar&aacute; un puerto TCP alto aleatorio para los datos entrantes.
d253 1
a253 1
$Translation: ftp.html,v 1.7 2003/07/01 14:55:02 horacio Exp $
@


1.2
log
@sync with steelix translation CVS
@
text
@d23 2
a24 2
[<a href="../example1.html">Siguiente: Example #1: Firewall For Home or
Small Office</a>]
d240 2
a241 2
[<a href="../example1.html">Siguiente: Example #1: Firewall For Home or
Small Office</a>]
d249 1
a249 1
Originally [OpenBSD: ftp.html,v 1.6 2003/06/13 02:54:08 nick Exp ]<br>
d251 1
a251 1
$Translation: ftp.html,v 1.4 2003/06/15 11:40:23 horacio Exp $
@


1.1
log
@
initial translation from horacio
@
text
@d249 1
a249 1
Originally [OpenBSD: ftp.html,v 1.5 2003/05/16 22:05:46 nick Exp ]<br>
d251 1
a251 1
$Translation: ftp.html,v 1.3 2003/05/26 09:12:05 horacio Exp $
@

