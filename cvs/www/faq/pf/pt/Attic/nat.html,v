head	1.19;
access;
symbols;
locks; strict;
comment	@# @;


1.19
date	2014.04.01.17.14.11;	author nick;	state dead;
branches;
next	1.18;

1.18
date	2013.12.06.20.52.46;	author ajacoutot;	state Exp;
branches;
next	1.17;

1.17
date	2013.05.03.05.53.48;	author ajacoutot;	state Exp;
branches;
next	1.16;

1.16
date	2013.04.26.13.06.05;	author ajacoutot;	state Exp;
branches;
next	1.15;

1.15
date	2013.02.25.08.23.50;	author ajacoutot;	state Exp;
branches;
next	1.14;

1.14
date	2013.01.23.15.57.13;	author ajacoutot;	state Exp;
branches;
next	1.13;

1.13
date	2013.01.20.07.39.01;	author ajacoutot;	state Exp;
branches;
next	1.12;

1.12
date	2009.11.16.12.38.13;	author ajacoutot;	state Exp;
branches;
next	1.11;

1.11
date	2009.10.19.09.39.59;	author ajacoutot;	state Exp;
branches;
next	1.10;

1.10
date	2009.10.17.15.58.26;	author ajacoutot;	state Exp;
branches;
next	1.9;

1.9
date	2009.05.16.08.59.12;	author ajacoutot;	state Exp;
branches;
next	1.8;

1.8
date	2009.03.16.20.24.23;	author tobias;	state Exp;
branches;
next	1.7;

1.7
date	2007.12.01.10.39.11;	author tobias;	state Exp;
branches;
next	1.6;

1.6
date	2006.12.29.12.56.48;	author jufi;	state Exp;
branches;
next	1.5;

1.5
date	2006.05.29.11.06.11;	author jufi;	state Exp;
branches;
next	1.4;

1.4
date	2006.01.20.20.05.19;	author jufi;	state Exp;
branches;
next	1.3;

1.3
date	2005.11.18.20.48.47;	author jufi;	state Exp;
branches;
next	1.2;

1.2
date	2005.05.30.13.52.07;	author saad;	state Exp;
branches;
next	1.1;

1.1
date	2005.01.06.20.03.30;	author jufi;	state Exp;
branches;
next	;


desc
@@


1.19
log
@
Abandon translations, per deraadt@@ and ajacoutot@@.
@
text
@<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>PF: Tradução do Endereço de Rede (NAT)</title>
<link rev="made" href="mailto:www@@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name="resource-type" content="document">
<meta name="description"   content="the OpenBSD FAQ page">
<meta name="keywords"      content="openbsd,faq,pf">
<meta name="distribution"  content="global">
</head>

<!--
Copyright (c) 2003, Nick Holland <nick@@openbsd.org>
Copyright (c) 2003, 2004, Joel Knight <enabled@@myrealbox.com>

Permission to use, copy, modify, and distribute this documentation for
any purpose with or without fee is hereby granted, provided that the
above copyright notice and this permission notice appear in all copies.

THE DOCUMENTATION IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL
WARRANTIES WITH REGARD TO THIS DOCUMENTATION INCLUDING ALL IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE
AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL
DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR
PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS DOCUMENTATION
-->

<body bgcolor="#ffffff" text="#000000">
<!-- Passes validator.w3.org, please keep it this way;
please, use a max of 72 chars per line -->


<a href="../../../pt/index.html">
<img alt="[OpenBSD]" height=30 width=141 src="../../../images/smalltitle.gif" border="0">
</a>
<p>
[<a href="filter.html">Anterior: Filtragem de Pacotes</a>]
[<a href="index.html">Conteúdo</a>]
[<a href="rdr.html">Próximo: Redirecionamento de Tráfego
("Port Forwarding")</a>]

<p>
<h1><font color="#e00000">PF: Tradução do Endereço de Rede (NAT)</font></h1>

<hr>

<h3>Conteúdo</h3>
<ul>
<li><a href="#intro">Introdução</a>
<li><a href="#works">Como Funciona a NAT</a>
<li><a href="#ipfwd">IP Forwarding</a>
<li><a href="#config">Configuração da NAT</a>
<li><a href="#binat">Mapeamento Bidirecional (mapeamento 1:1)</a>
<li><a href="#except">Exceções em Regras de Tradução</a>
<li><a href="#status">Verificação do Status da NAT</a>
</ul>

<hr>

<a name="intro"></a>
<h2>Introdução</h2>
A Tradução do Endereço de Rede (NAT - "Network Address Translation") é
uma forma de mapear toda uma rede (ou redes) para apenas um endereço IP.
NAT é necessária quando o número de endereços IP atribuídos a você pelo
seu Provedor de Serviços de Internet é menor que o número total de
computadores para os quais você quer prover acesso à Internet.
NAT está descrita na
<a href="http://www.geektools.com/rfc/rfc1631.txt">RFC 1631</a>,
"The IP Network Address Translator (NAT)".

<p>
NAT permite que você faça uso dos blocos de endereços reservados
descritos na
<a href="http://www.geektools.com/rfc/rfc1918.txt">RFC 1918</a>,
"Address Allocation for Private Internets".
Tipicamente, sua rede interna é configurada com endereços IP de
um ou mais desses blocos de redes. São eles:
<pre>
	10.0.0.0/8       (10.0.0.0 - 10.255.255.255)
	172.16.0.0/12    (172.16.0.0 - 172.31.255.255)
	192.168.0.0/16   (192.168.0.0 - 192.168.255.255)
</pre>

<p>
Um sistema OpenBSD fazendo NAT deve ter ao menos duas interfaces de
rede, um para a Internet e outro para a rede interna. A NAT
traduz as requisições da rede interna de forma que elas pareçam
se originar do sistema OpenBSD fazendo NAT.

<a name="works"></a>
<h2>Como Funciona a NAT</h2>
<p>
Quando um cliente na rede interna procura uma máquina na Internet,
ele envia pacotes IP destinados a essa máquina. Esses pacotes contêm
toda a informação de endereçamento necessária para chegar a seu
destino. Informação pertinente à NAT:
<ul>
<li>Endereço IP de origem (por exemplo, 192.168.1.35)
<li>Porta TCP ou UDP de origem (por exemplo, 2132)
</ul>

<p>
Quando o pacote passa pelo gateway NAT, ele é alterado para que pareça
ter sido originado no próprio gateway. O gateway NAT registra então as
alterações feitas por ele em sua tabela de estados para que ele
possa a) reverter as alterações nos pacotes que retornam e b)
certificar-se de que os pacotes que retornam cruzem o firewall sem
serem bloqueados. Por exemplo, as seguintes alterações devem ser feitas:
<ul>
<li>Endereço IP de origem: substituído pelo endereço externo do gateway
(por exemplo, 24.5.0.5)
<li>Porta de origem: substituída por uma porta disponível no gateway,
escolhida dinamicamente (por exemplo, 53136)
</ul>

<p>
Nem a máquina interna nem a máquina na Internet percebem esse trabalho
de tradução. Para a máquina interna, o sistema de NAT é simplesmente um
gateway de Internet. Para a máquina na Internet, os pacotes parecem vir
diretamente do sistema NAT; ele nem mesmo suspeita da existência da
estação de trabalho interna.

<p>
Quando a máquina na Internet responde aos pacotes da máquina interna,
eles são endereçados ao IP externo do gateway NAT (24.5.0.5) na porta
da tradução (53136). O gateway NAT então pesquisa na sua tabela de
estados para determinar se os pacotes de resposta correspondem a uma
conexão já estabelecida. Uma ocorrência única será encontrada
baseando-se na combinação endereço IP/porta, que diz ao PF que os
pacotes pertencem à conexão iniciada pela máquina interna 192.168.1.35.
O PF então faz as alterações reversas feitas nos pacotes que
estabeleceram a conexão e transfere os pacotes de resposta para a
máquina interna.

<p>
A tradução de pacotes ICMP ocorre de maneira similar, mas sem alteração
da porta de origem.

<!-- legacy anchor; can eventually be removed -->
<a name="filter"></a>
<a name="enable"></a>
<a name="ipfwd"></a>
<h2>IP Forwarding</h2>
<p>
Como a NAT é quase sempre usada em roteadores e gateways de rede,
provavelmente será necessário habilitar o IP forwarding para que
pacotes possam trafegar entre as interfaces de rede na máquina OpenBSD.
IP forwarding é habilitado usando o mecanismo
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysctl&amp;sektion=3"
>sysctl(3)</a>:
<blockquote>
<tt>
# sysctl net.inet.ip.forwarding=1<br>
# sysctl net.inet6.ip6.forwarding=1 <i>(se estiver usando IPv6)</i>
</tt>
</blockquote>

<p>
Para que essa alteração seja permanente, as linhas a seguir devem ser
acrescentadas ao arquivo
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysctl.conf&amp;sektion=5"
><tt>/etc/sysctl.conf</tt></a>:
<blockquote>
<tt>
net.inet.ip.forwarding=1<br>
net.inet6.ip6.forwarding=1
</tt>
</blockquote>

<p>
Essas linhas estão presentes, mas comentadas
(prefixadas por <tt>#</tt>). Remova o <tt>#</tt> e salve o arquivo.
O IP forwarding será habilitado quando a máquina for reinicializada.

<a name="config"></a>
<h2>Configuração da NAT</h2>
<font color="#ff0000">NOTA:</font> Estas informações são relevantes apenas ao OpenBSD 4.7.
As configurações de NAT são significativamente diferentes nas versões mais atuais.
<p>

O uso de NAT é especificado através do uso do parâmetro opcional 
<tt>nat-to</tt> atrelado a uma regra <tt>pass</tt> de saída.
Geralmente, em vez de ser definida diretamente numa regra 
<tt>pass</tt>, uma regra de <tt>match</tt> é utilizada.

Quando um pacote é selecionado/marcado por uma regra <tt>match</tt>, 
parâmetros (como o <tt>nat-to</tt>)presentes naquela regra são 
armazenados e são aplicados ao pacote quando este pacote bate 
com a regra de <tt>pass</tt>.

Isso permite que uma grande quantidade de pacotes seja gerenciada 
por uma única regra <tt>match</tt> e então decisões específicas 
podem ser aplicadas através de regras <tt>block</tt> ou <tt>pass</tt>.
<p>
Regras contidas no arquivo <tt>pf.conf</tt> teriam as seguintes sintaxes:
<blockquote>
<tt>
match out on <i>interface</i> [<i>af</i>] \<br>
&nbsp;&nbsp;&nbsp;from <i>src_addr</i> to <i>dst_addr</i> \<br>
&nbsp;&nbsp;&nbsp;nat-to <i>ext_addr</i> [<i>pool_type</i>] [static-port]<br>
...<br>
pass out [log] on <i>interface</i> [<i>af</i>] [proto <i>protocol]</i> \<br>
&nbsp;&nbsp;&nbsp;from <i>ext_addr</i> [port <i>src_port</i>] \<br>
&nbsp;&nbsp;&nbsp;to <i>dst_addr</i> [port <i>dst_port</i>]</tt>
</blockquote>

<dl>
<dt><tt>match</tt>
<dd>Quando um pacote atravessa o conjunto de regras e corresponde a uma 
regra <tt>match</tt>, os parâmetros opcionais especificados nesta 
referida serão lembrados para uso futuro (é adicionada uma espécie 
de etiqueta).

<dt><tt>pass</tt>
<dd>Esta regra permite que o pacote seja transmitido.
Se o pacote foi previamente marcado por uma regra <tt>match</tt> de acordo com
os parâmetros especificados, eles serão aplicados a este pacote.
Regras <tt>pass</tt> podem ter seus próprios parâmetros; estes parâmetros tomam
prioridade sobre os parâmetros especificados em uma regra <tt>match</tt>.

<dt><tt>log</tt>
<dd>Pacotes que corresponderam são registrados via
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pflogd&amp;sektion=8&amp;manpath=OpenBSD+5.4"
>pflogd(8)</a>.
Normalmente, apenas o primeiro pacote que corresponde é registrado.
Para registrar todos os pacotes que corresponderam, use
<tt>log (all)</tt>.

<dt><tt><i>interface</i></tt>
<dd>O nome ou grupo da interface de rede onde os pacotes devem ser
transmitidos.

<dt><tt><i>af</i></tt>
<dd>A família de endereços, <tt>inet</tt> para IPv4 ou
<tt>inet6</tt> para IPv6. Normalmente o PF pode determinar essa
informação com base no(s) endereço(s) de origem/destino.

<dt><tt><i>protocol</i></tt>
<dd>O protocolo (ex.: tcp, udp ou icmp) utilizado pelo pacote.
Caso <i>src_port</i> ou <i>dst_port</i> sejam especificados, o protocolo
<em>DEVE</em> ser informado.

<dt><tt><i>src_addr</i></tt>
<dd>O endereço de origem (interno) dos pacotes que serão
traduzidos. O endereço de origem pode ser especificado como:
<ul>
<li>Um endereço IPv4 ou IPv6 simples.
<li>Um bloco de rede
    <a href="http://public.swbell.net/dedicated/cidr.html">CIDR</a>.
<li>Um nome de domínio totalmente qualificado que será resolvido pelo
    DNS quando o conjunto de regras for carregado. Todos os endereços IP
    resultantes da pesquisa serão substituídos na regra.
<li>O nome ou grupo de uma interface de rede. Quaisquer endereços IP
    na interface serão substituídos quando a regra for carregada.
<li>O nome de uma interface de rede seguido de uma
    <tt>/<i>máscara</i></tt> (por exemplo, <tt>/24</tt>). Cada endereço
    IP na interface é combinado com a máscara para formar um bloco de
    rede CIDR que será substituído na regra.
<li>O nome ou grupo de uma interface de rede seguido de qualquer um
    destes modificadores:
    <ul>
    <li><tt>:network</tt> - substitui o bloco de rede CIDR (por exemplo,
        192.168.0.0/24)
    <li><tt>:broadcast</tt> - substitui o endereço de broadcast
        (por exemplo, 192.168.0.255)
    <li><tt>:peer</tt> - substitui o endereço da outra ponta em um
        link ponto a ponto
    </ul>
    <dl>
    <dd>Além disso, o modificador <tt>:0</tt> pode ser acrescentado a um
    nome/grupo de interface ou a qualquer um dos modificadores acima
    para dizer ao PF para não incluir apelidos de endereços IP na
    substituição.
    Esses modificadores também podem ser usados quando a interface está
    entre parêntesis.
    Exemplo: <tt>fxp0:network:0</tt>
    </dl>
<li>Uma <a href="tables.html">tabela</a>.
<li>Qualquer um dos apresentados acima, mas negado usando o modificador
    <tt>!</tt> ("não").
<li>Um grupo de endereços usando-se uma
    <a href="macros.html#lists">lista</a>.
<li>A palavra-chave <tt>any</tt>, indicando todos os endereços
</ul>

<dt><tt><i>src_port</i></tt>
<dd>A porta de origem no cabeçalho da Camada 4 do pacote. Portas
são especificadas como:
<ul>
<li>Um número entre 1 e 65535
<li>Um nome de serviço válido de
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=services&amp;sektion=5"
    ><tt>/etc/services</tt></a>
<li>Um grupo de portas usando-se uma
    <a href="macros.html#lists">lista</a>
<li>Uma faixa:
	<ul>
	<li><tt>!=</tt> (diferente de)
	<li><tt>&lt;</tt> (menor que)
	<li><tt>&gt;</tt> (maior que)
	<li><tt>&lt;=</tt> (menor ou igual a)
	<li><tt>&gt;=</tt> (maior ou igual a)
	<li><tt>&gt;&lt;</tt> (faixa)
	<li><tt>&lt;&gt;</tt> (faixa inversa)
	<dl>
	<dd>Os dois últimos são operadores binários (recebem dois
	argumentos) e não incluem os argumentos na faixa.
	</dl>
	<li><tt>:</tt> (faixa inclusiva)
	<dl>
	<dd>O operador de faixa inclusiva também é um operador binário
        e inclui os argumentos na faixa.
	</dl>
	</ul>
</ul>
A opção <tt>port</tt> geralmente não é usada em regras <tt>nat</tt>
porque o objetivo geralmente é fazer NAT de todo o tráfego,
independente da(s) porta(s) sendo utilizada(s).

<dt><tt><i>dst_addr</i></tt>
<dd>O endereço de destino dos pacotes a serem traduzidos.
Ele é especificado da mesma forma que o endereço de origem.

<dt><tt><i>dst_port</i></tt>
<dd>A porta de destino no cabeçalho da Camada 4 do pacote. Essa porta
é especificada da mesma forma que a porta de origem.

<dt><tt><i>ext_addr</i></tt>
<dd>O endereço externo (de tradução) do gateway NAT em que os pacotes
serão traduzidos. O endereço externo pode ser especificado como:
<ul>
<li>Um endereço IPv4 ou IPv6 simples.
<li>Um bloco de rede
    <a href="http://public.swbell.net/dedicated/cidr.html">CIDR</a>.
<li>Um nome de domínio totalmente qualificado que será resolvido pelo
    servidor DNS quando a regra for carregada.
<li>O nome de uma interface ou de um grupo de interfaces da rede externa.
    Quaisquer endereços IP atribuídos à interface serão substituídos 
    na regra quando for carregada.
<li>O nome de uma interface ou de um grupo de interfaces da rede externa entre parêntesis
    <tt>( )</tt>. Isso informa ao PF para atualizar a regra caso o(s)
    endereço(s) da interface sofra(m) alterações. É muito útil quando a
    interface externa tem seu endereço IP atribuído via DHCP ou discada,
    pois o conjunto de regras não precisa ser recarregado toda vez que
    o endereço mudar.
<li>O nome de uma interface ou de um grupo de interfaces de rede, 
    seguidos de um destes modificadores:
  <ul>
  <li><tt>:network</tt> - substitui o bloco de rede CIDR (por exemplo,
      192.168.0.0/24)
  <li><tt>:peer</tt> - substitui o endereço IP da outra ponta em um
      link ponto a ponto
  </ul>
  <dl>
  <dd>Além disso, o modificador <tt>:0</tt> pode ser acrescentado a um
  nome/grupo de interfaces ou a qualquer um dos modificadores acima para
  indicar que o PF não deve incluir apelidos de endereços IP na
  substituição.
  Esses modificadores também podem ser usados quando a interface está
  entre parêntesis.
  Exemplo: <tt>fxp0:network:0</tt>
  </dl>
<li>Um grupo de endereços usando-se uma
    <a href="macros.html#lists">lista</a>.
</ul>

<dt><tt><i>pool_type</i></tt>
<dd>Especifica o tipo de <a href="pools.html">grupo de endereços</a> a
usar para tradução.

<dt><tt>static-port</tt>
<dd>Informa ao PF para não traduzir a porta de origem em pacotes TCP e
UDP.

</dl>

<p>
Isso nos levaria à criação de regras básicas similares como estas:
<blockquote>
<tt>
match out on tl0 from 192.168.1.0/24 to any nat-to 24.5.0.5<br>
pass on tl0 from 192.168.1.0/24 to any
</tt>
</blockquote>
ou você poderia simplesmente usar algo como:
<blockquote>
<tt>
pass out on tl0 from 192.168.1.0/24 to any nat-to 24.5.0.5
</tt>
</blockquote>

<p>
Essa regra diz para fazer NAT na interface <tt>tl0</tt> para quaisquer
pacotes vindos de 192.168.1.0/24 e substituir o endereço IP de origem
por 24.5.0.5.

<p>
Embora a regra acima esteja correta, essa forma de uso não é
recomendada.
A manutenção pode se tornar difícil, porque caso algum endereço na
interface externa ou interna seja alterado, a linha também precisará
ser alterada.
Faça a comparação com uma linha que facilita um pouco a
manutenção (<tt>tl0</tt> é externa, <tt>dc0</tt> interna):
<blockquote>
<tt>
pass out on tl0 from dc0:network to any nat-to tl0
</tt>
</blockquote>

<p>
A vantagem deve ser clara: podemos alterar o endereço IP de qualquer
interface sem haver necessidade de se alterar a regra.

<p>
Ao especificar um nome de interface para a tradução de endereços como
mostrado acima, o endereço IP é determinado no <i>carregamento</i> do
pf.conf, e não em tempo real. Caso esteja usando DHCP para configurar
sua interface externa, isso pode se tornar um problema. Se o endereço
atribuído for alterado, a NAT continua traduzindo pacotes saindo do
firewall usando o endereço IP antigo. Isso faz com que as conexões
parem de funcionar.
Para evitar esse problema, você pode dizer ao PF para atualizar o
endereço de tradução automaticamente, colocando o nome da interface
entre parêntesis:
<blockquote>
<tt>
pass out on tl0 from dc0:network to any nat-to (tl0)
</tt>
</blockquote>

<p>
Esse método funciona para tradução tanto de endereços IPv4 quanto IPv6.

<a name="binat"></a>
<h2>Mapeamento Bidirecional (mapeamento 1:1)</h2>
Um mapeamento bidirecional pode ser estabelecido através do uso do parâmetro 
<tt>binat-to</tt>.
Uma regra com <tt>binat-to</tt> estabelece um mapeamento de um para um (1:1) 
entre um endereço IP interno e um endereço IP externo.
Isso pode ser útil, por exemplo, para fornecer acesso a um servidor web 
interno de modo que ele tenha seu próprio endereço IP externo.
Conexões vindas da Internet, destinadas aquele endereço, serão 
transmitidas ao IP interno do servidor web e as conexões originadas 
internamente pelo servidor web (tais como consultas de DNS) serão 
repassadas com o endereço IP externo.
Portas de protocolos TCP e UDP nunca serão alteradas com o uso de 
<tt>binat-to</tt>, da forma como são alteradas se você usar regras de 
<tt>nat</tt>.

<p>
Exemplo:
<blockquote>
<tt>
web_serv_int = "192.168.1.100"<br>
web_serv_ext = "24.5.0.6"<br>
<br>
pass on tl0 from $web_serv_int to any binat-to $web_serv_ext<br>
</tt>
</blockquote>

<a name="except"></a>
<h2>Exceções em Regras de Tradução</h2>
Se você necessita fazer tradução de grande parte do tráfego, mas prover 
exceções à alguns casos, assegure-se de que as exceções sejam gerenciadas 
por uma regra de filtro que não contenha o parâmetro <tt>nat-to</tt>.
Por exemplo, se o exemplo de NAT repassado anteriormente for 
modificado para se parecer com isto:
<blockquote>
<tt>
pass out on tl0 from 192.168.1.0/24 to any nat-to 24.2.74.79<br>
pass out on tl0 from 192.168.1.208 to any<br>
</tt>
</blockquote>

<p>
Então toda a rede 192.168.1.0/24 teria seus pacotes traduzidos para
o endereço externo 24.2.74.79, exceto a máquina 192.168.1.208.

<a name="status"></a>
<h2>Verificação do Status da NAT</h2>
O
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+5.4"
>pfctl(8)</a>
com a opção <tt>-s state</tt> é usado para verificar as traduções
NAT ativas.
Essa opção lista todas as sessões NAT ativas:

<pre>
   # pfctl -s state
   fxp0 tcp 192.168.1.35:2132 (24.5.0.5:53136) -&gt; 65.42.33.245:22 TIME_WAIT:TIME_WAIT
   fxp0 udp 192.168.1.35:2491 (24.5.0.5:60527) -&gt; 24.2.68.33:53   MULTIPLE:SINGLE
</pre>

<p>
Explicações (apenas da primeira linha):

<dl>
<dt>fxp0
<dd>Indica a interface a qual o estado está vinculado. A palavra
<tt>self</tt> aparecerá caso o estado seja
<a href="options.html#state-policy"><tt>floating</tt></a>.
</dl>

<dl>
<dt>TCP
<dd>O protocolo usado pela conexão.
</dl>

<dl>
<dt>192.168.1.35:2132
<dd>O endereço IP (192.168.1.35) da máquina na rede interna.
A porta de origem (2132) é mostrada após o endereço. Esse também é
o endereço substituído no cabeçalho IP.
</dl>

<dl>
<dt>24.5.0.5:53136
<dd>O endereço IP (24.5.0.5) e a porta (53136) no gateway onde os
pacotes estão sendo traduzidos.
</dl>

<dl>
<dt>65.42.33.245:22
<dd>O endereço IP (65.42.33.245) e a porta (22) onde a máquina interna
está se conectando.
</dl>

<dl>

<dt>TIME_WAIT:TIME_WAIT
<dd>Indica em qual estado o PF acredita que a conexão TCP esteja.
</dl>

<p>
[<a href="filter.html">Anterior: Filtragem de Pacotes</a>]
[<a href="index.html">Conteúdo</a>]
[<a href="rdr.html">Próximo: Redirecionamento de Tráfego
("Port Forwarding")</a>]

<p>
<hr>
<a href="index.html"><img height="24" width="24" src="../../../images/back.gif" border="0" alt="[voltar]"></a>
<a href="mailto:www@@openbsd.org">www@@openbsd.org</a>
<br>
<small>
<!--
Originally [OpenBSD: nat.html,v 1.44 ]<br>
$Translation: nat.html,v 1.18 2013/12/01 12:44:33 egypcio Exp $<br>
-->
$OpenBSD: nat.html,v 1.18 2013/12/06 20:52:46 ajacoutot Exp $
</small>

</body>
</html>
@


1.18
log
@Sync with Steelix CVS
@
text
@d554 1
a554 1
$OpenBSD$
@


1.17
log
@Sync with Steelix CVS
@
text
@d226 1
a226 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pflogd&amp;sektion=8&amp;manpath=OpenBSD+5.3"
d486 1
a486 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+5.3"
d551 2
a552 2
Originally [OpenBSD: nat.html,v 1.43 ]<br>
$Translation: nat.html,v 1.17 2013/05/02 22:48:46 renato Exp $<br>
@


1.16
log
@Sync with Steelix CVS
@
text
@d226 1
a226 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pflogd&amp;sektion=8&amp;manpath=OpenBSD+5.2"
d486 1
a486 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+5.2"
d551 2
a552 2
Originally [OpenBSD: nat.html,v 1.42 ]<br>
$Translation: nat.html,v 1.16 2013/04/22 14:22:03 renato Exp $<br>
@


1.15
log
@Sync with Steelix CVS
@
text
@d88 1
a88 1
Um sistema OpenBSD fazendo NAT deve ter ao menos dois adaptadores de
d551 2
a552 2
Originally [OpenBSD: nat.html,v 1.41 ]<br>
$Translation: nat.html,v 1.15 2013/02/24 17:01:46 egypcio Exp $<br>
@


1.14
log
@Sync with Steelix CVS
@
text
@d252 1
a252 1
    <a href="http://public.pacbell.net/dedicated/cidr.html">CIDR</a>.
d337 1
a337 1
    <a href="http://public.pacbell.net/dedicated/cidr.html">CIDR</a>.
d551 2
a552 2
Originally [OpenBSD: nat.html,v 1.40 ]<br>
$Translation: nat.html,v 1.14 2013/01/21 14:00:11 egypcio Exp $<br>
@


1.13
log
@Sync with Steelix CVS
@
text
@d194 3
a196 1
Isso permite que uma grande quantidade de pacotes seja gerenciada por uma única regra <tt>match</tt> e então decisões específicas podem ser aplicadas através de regras <tt>block</tt> ou <tt>pass</tt>.
d212 4
a215 3
<dd>When a packet traverses the ruleset and matches a <tt>match</tt>
rule, any optional parameters specified in that rule are remembered
for future use (made "sticky").
d218 5
a222 5
+<dd>This rule allows the packet to be transmitted.
+If the packet was previously matched by a <tt>match</tt> rule where
+parameters were specified, they will be applied to this packet.
+<tt>pass</tt> rules may have their own parameters; these take
+priority over parameters specified in a <tt>match</tt> rule.
d236 1
a236 1
<dt><tt><i>fam_de_end</i></tt>
d242 3
a244 3
<dd>The protocol (e.g. tcp, udp, icmp) of packets to allow.
If <i>src_port</i> or <i>dst_port</i> is specified, the protocol
<em>must</em> also be given.
d246 1
a246 1
<dt><tt><i>end_de_or</i></tt>
d289 1
a289 1
<dt><tt><i>porta_de_or</i></tt>
d323 1
a323 1
<dt><tt><i>end_de_dest</i></tt>
d327 1
a327 1
<dt><tt><i>porta_de_dest</i></tt>
d331 1
a331 1
<dt><tt><i>end_ext</i></tt>
d370 1
a370 1
<dt><tt><i>tipo_de_grupo</i></tt>
d440 13
a452 12
A bidirectional mapping can be established by using the 
<tt>binat-to</tt> parameter.
A <tt>binat-to</tt> rule establishes a one to one mapping between
an internal IP address and an external address.
This can be useful, for example, to provide a web server on
the internal network with its own external IP address.
Connections from the Internet to the external address will
be translated to the internal address and connections from
the web server (such as DNS requests) will be translated
to the external address.
TCP and UDP ports are never modified with <tt>binat-to</tt>
rules as they are with <tt>nat</tt> rules.
d467 5
a471 4
If you need to translate most traffic, but provide exceptions in
some cases, make sure that the exceptions are handled by a filter rule
which does not include the nat-to parameter.
For example, if the NAT example above was modified to look like this:
d551 2
a552 2
Originally [OpenBSD: nat.html,v 1.31 ]<br>
$Translation: nat.html,v 1.13 2013/01/19 02:36:06 egypcio Exp $<br>
@


1.12
log
@Sync with Steelix CVS
@
text
@a53 1
<li><a href="#filter">NAT e Filtragem de Pacotes</a>
d142 1
a143 17
<h2>NAT e Filtragem de Pacotes</h2>
<p>
<font color="#ff0000">NOTA:</font> Pacotes traduzidos ainda devem
passar pelo sistema de filtragem e serão aceitos ou bloqueados
baseando-se nas regras de filtragem definidas.
A <i>única</i> exceção à regra se dá quando a palavra-chave
<tt>pass</tt> é usada em uma regra <tt>nat</tt>.
Isso faz com que os pacotes "NATeados" passem direto pelo sistema
de filtragem.

<p>
Saiba também que, como a tradução ocorre <i>antes</i> da filtragem, o
sistema de filtragem enxerga o pacote já <i>traduzido</i> para o
endereço IP e porta conforme explicado em
<a href="#works">Como Funciona a NAT</a>.

<!-- legacy anchor; can eventually be removed -->
d180 17
a196 1
A forma geral de regras NAT no arquivo <tt>pf.conf</tt> se parece com:
d199 7
a205 5
nat [pass] [log] on <i>interface</i> [<i>fam_de_end</i>] from <i>end_de_or</i>
[port <i>porta_de_or</i>] to \<br>
&nbsp;&nbsp;&nbsp;<i>end_de_dest</i> [port <i>porta_de_dest</i>] -&gt;
<i>end_ext</i> [<i>tipo_de_grupo</i>] [static-port]
</tt>
d209 4
a212 2
<dt><tt>nat</tt>
<dd>A palavra-chave que inicia uma regra NAT.
d215 5
a219 2
<dd>Faz com que pacotes traduzidos passem direto pelas regras de
filtragem.
d223 1
a223 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pflogd&amp;sektion=8&amp;manpath=OpenBSD+4.6"
d231 1
a231 1
traduzidos.
d238 5
d337 4
a340 4
<li>O nome da interface de rede externa. Quaisquer endereços IP
    atribuídos à interface serão substituídos na regra quando for
    carregada.
<li>O nome da interface de rede externa entre parêntesis
d346 2
a347 1
<li>O nome da interface de rede seguido de um destes modificadores:
d356 1
a356 1
  nome de interface ou a qualquer um dos modificadores acima para
d378 1
a378 1
Isso nos levaria à criação de uma regra básica similar a esta:
d381 8
a388 1
nat on tl0 from 192.168.1.0/24 to any -&gt; 24.5.0.5
d407 1
a407 1
nat on tl0 from dc0:network to any -&gt; tl0
d428 1
a428 1
nat on tl0 from dc0:network to any -&gt; (tl0)
d437 12
a448 10
Um mapeamento bidirecional pode ser estabelecido através do uso da
regra <tt>binat</tt>. Uma regra <tt>binat</tt> estabelece o mapeamento
um para um entre um endereço IP interno e um endereço externo.
Isso pode ser útil, por exemplo, para disponibilizar um servidor Web
na rede interna que possua seu próprio IP externo.
As conexões vindas da Internet para esse endereço externo serão
traduzidas para o endereço interno e as conexões do servidor Web
(como pesquisas DNS) serão traduzidas para o endereço externo.
Portas TCP e UDP nunca são alteradas por regras <tt>binat</tt> como
acontece com regras <tt>nat</tt>.
d457 1
a457 1
binat on tl0 from $web_serv_int to any -&gt; $web_serv_ext<br>
d463 4
a466 3
Exceções às regras de tradução podem ser feitas usando-se a
palavra-chave <tt>no</tt>. Por exemplo, se o exemplo de NAT acima fosse
alterado para:
d469 2
a470 2
no nat on tl0 from 192.168.1.208 to any<br>
nat on tl0 from 192.168.1.0/24 to any -&gt; 24.2.74.79
a477 6
<p>
Note que a primeira regra que corresponde vence; se for uma regra
<tt>no</tt>, o pacote não é traduzido. A palavra-chave <tt>no</tt>
também pode ser usada com regras <tt>binat</tt> e
<a href="rdr.html"><tt>rdr</tt></a>.

d481 1
a481 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+4.6"
d489 2
a490 2
   fxp0 TCP 192.168.1.35:2132 -&gt; 24.5.0.5:53136 -&gt; 65.42.33.245:22 TIME_WAIT:TIME_WAIT
   fxp0 UDP 192.168.1.35:2491 -&gt; 24.5.0.5:60527 -&gt; 24.2.68.33:53   MULTIPLE:SINGLE
d547 1
a547 1
$Translation: nat.html,v 1.12 2009/11/12 10:00:47 alan Exp $<br>
@


1.11
log
@Sync with Steelix CVS
@
text
@d228 1
a228 1
<dd>A família de endereço, <tt>inet</tt> para IPv4 ou
d531 1
a531 1
$Translation: nat.html,v 1.11 2009/10/18 16:52:52 alan Exp $<br>
@


1.10
log
@Sync with Steelix CVS
@
text
@d66 1
a66 1
A Tradução do Endereço de Rede (NAT, "Network Address Translation") é
d217 1
a217 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pflogd&amp;sektion=8&amp;manpath=OpenBSD+4.5"
d465 1
a465 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+4.5"
d530 2
a531 2
Originally [OpenBSD: nat.html,v 1.30 ]<br>
$Translation: nat.html,v 1.10 2009/10/13 19:12:28 alan Exp $<br>
@


1.9
log
@Sync with Steelix CVS
@
text
@d46 1
a46 1
<h1><font color="#e00000">PF: Tradução do Endereço de Rede ("NAT")</font></h1>
d53 1
a53 1
<li><a href="#works">Como Funciona o NAT</a>
d56 1
a56 1
<li><a href="#config">Configurando NAT</a>
d59 1
a59 1
<li><a href="#status">Verificando Status do NAT</a>
d66 6
a71 5
Tradução do Endereço de Rede (NAT) é uma forma de mapear toda uma rede
(ou redes) para apenas um endereço IP. NAT é necessário quando o
número de endereços IP atribuídos a você pelo seu Provedor de Serviços
de Internet é menor que o número total de computadores para os quais
você quer prover acesso à Internet. NAT está descrito na
d73 1
a73 1
"The IP Network Address Translator (NAT)."
d79 3
a81 3
"Address Allocation for Private Internets."
Tipicamente, sua rede interna será configurada com endereços IP de
um ou mais blocos nessas redes. São eles:
d90 3
a92 3
rede, um para a Internet, e outro para a rede interna. O NAT irá
traduzir requisições da rede interna de forma que elas pareçam se
originar do sistema OpenBSD fazendo NAT.
d95 1
a95 1
<h2>Como Funciona o NAT</h2>
d98 1
a98 1
ele envia pacotes IP destinados a essa máquina. Esses pacotes contém
d100 1
a100 1
destino. Informação pertinente ao "NAT":
d103 1
a103 1
<li>Porta de origem TCP ou UDP (por exemplo, 2132)
d109 1
a109 1
alterações feitas por ele em sua tabela de estado para que ele
d111 1
a111 1
certificar-se de que os pacotes que retornam, cruzem o firewall sem
d121 3
a123 3
Nem a máquina interna e nem o host na Internet percebem esse trabalho
de tradução. Para a máquina interna, o sistema NAT é simplesmente um
gateway de Internet. Para o host na Internet, os pacotes parecem vir
d128 4
a131 4
Quando o host na Internet responde aos pacotes da máquina interna, eles
serão endereçados ao IP externo do gateway NAT (24.5.0.5) na porta
da tradução (53136). O gateway NAT pesquisará então sua tabela de
estado para determinar se os pacotes em resposta casam com uma
d133 5
a137 4
baseada na combinação endereço IP/porta, que diz ao PF que os pacotes
pertencem à conexão iniciada pela máquina interna 192.168.1.35. O PF
então faz as alterações reversas feitas nos pacotes que estabeleceram
a conexão e transfere as respostas para a máquina interna.
d140 1
a140 1
A tradução de pacotes ICMP ocorre de maneira similar mas sem alteração
d147 2
a148 2
passar pelo sistema de filtragem e serão aceitos ou bloqueados baseado
nas regras de filtragem definidas.
d151 1
a151 1
O que fará com que os pacotes NATeados passem direto pelo sistema
d156 1
a156 1
sistema de filtagem enxergará o pacote já <i>traduzido</i> para o
d158 1
a158 1
<a href="#works">Como Funciona o NAT</a>.
d165 1
a165 1
Como o NAT é quase sempre usado em roteadores e gateways de rede,
d193 1
a193 1
O IP forwarding será habilitado quando a máquina for reiniciada.
d196 1
a196 1
<h2>Configurando NAT</h2>
d200 4
a203 4
nat [pass] [log] on <i>interface</i> [<i>af</i>] from <i>src_addr</i>
[port <i>src_port</i>] to \<br>
&nbsp;&nbsp;&nbsp;<i>dst_addr</i> [port <i>dst_port</i>] -&gt;
<i>ext_addr</i> [<i>pool_type</i>] [static-port]
d216 1
a216 1
<dd>Pacotes que casaram são logados via
d219 3
a221 2
Normalmente, apenas o primeiro pacote que casa será logado.
Para logar todos os pacotes, use <tt>log (all)</tt>.
d227 2
a228 2
<dt><tt><i>af</i></tt>
<dd>A família do endereço, <tt>inet</tt> para IPv4 ou
d232 1
a232 1
<dt><tt><i>src_addr</i></tt>
d240 2
a241 2
    DNS quando as regras forem carregadas. Todos os endereços IP
    resultantes da pesquisa serão substituídos nas regras.
d244 1
a244 1
<li>O nome de uma interface de rede seguido por uma
d248 2
a249 2
<li>O nome ou grupo de uma interface de rede seguido por algum destes
    modificadores:
d255 2
a256 2
    <li><tt>:peer</tt> - substitui o endereço da outra ponta num
        link ponto-a-ponto
d259 3
a261 3
    <dd>Além disso, o modificador <tt>:0</tt> pode ser adicionado a um
    nome/grupo de interface ou a qualquer dos modificadores acima para
    dizer ao PF para não incluir aliases de endereços IP na
d264 1
a264 1
    entre parênteses.
d269 4
a272 3
    <tt>!</tt> ("not").
<li>Um grupo de endereços usando-se uma <a href="macros.html#lists">lista</a>.
<li>A palavra-chave <tt>any</tt> indicando todos os endereços
d275 1
a275 1
<dt><tt><i>src_port</i></tt>
d280 1
a280 1
<li>Um nome de serviço válido em
d283 2
a284 1
<li>Um grupo de portas usando uma <a href="macros.html#lists">lista</a>
d287 1
a287 1
	<li><tt>!=</tt> (diferente)
d290 2
a291 2
	<li><tt>&lt;=</tt> (menor ou igual)
	<li><tt>&gt;=</tt> (maior ou igual)
d300 2
a301 2
	<dd>O operador inclusivo também é um operador binário e inclui
	os argumentos na faixa.
d309 1
a309 1
<dt><tt><i>dst_addr</i></tt>
d313 1
a313 1
<dt><tt><i>dst_port</i></tt>
d317 1
a317 1
<dt><tt><i>ext_addr</i></tt>
d324 1
a324 1
<li>Nome de domínio totalmente qualificado que será resolvido pelo
d326 10
a335 9
<li>O nome da interface de rede externa. Quaisquer endereços IP na
    interface serão substituídos nas regras quando forem carregadas.
<li>O nome da interface de rede externa entre parênteses
    <tt>( )</tt>. Isso informa ao PF para atualizar a regra caso o
    endereço da interface sofra alterações. É muito útil quando a
    interface externa tem seu endereço IP atribuído via DHCP ou dial-up,
    já que as regras não precisam ser recarregadas a cada alteração no
    endereço.
<li>O nome da interface de rede seguido por algum destes modificadores:
d337 1
a337 1
  <li><tt>:network</tt> - substitui um bloco de rede CIDR (por exemplo,
d339 2
a340 2
  <li><tt>:peer</tt> - é trocado pelo endereço IP da outra ponta num
      link ponto-a-ponto
d343 4
a346 3
  <dd>Além disso o modificador <tt>:0</tt> pode ser incluído a um nome
  de interface ou a qualquer dos modificadores acima para indicar que
  o PF não deve incluir aliases de endereços IP na substituição.
d348 1
a348 1
  entre parênteses.
d351 2
a352 1
<li>Um grupo de endereços usando-se uma <a href="macros.html#lists">lista</a>.
d355 2
a356 2
<dt><tt><i>pool_type</i></tt>
<dd>Especifica o tipo do <a href="pools.html">grupo de endereços</a> a
d366 1
a366 1
O que pode nos levar a criação de uma regra básica equivalente:
d376 1
a376 1
para 24.5.0.5.
d381 1
a381 1
A manutenção pode se tornar difícil porque caso algum endereço na
d398 5
a402 5
acima, o endereço IP é determinado no <i>carregamento</i> do pf.conf,
e não em tempo real.  Caso esteja usando DHCP para configurar sua
interface externa, isso pode se tornar um problema. Se o endereço
atribuído for alterado, o NAT continuará traduzindo pacotes com destino
externo usando o endereço IP antigo. O que fará com que as conexões
d406 1
a406 1
entre parênteses:
d419 1
a419 1
regra <tt>binat</tt>. A regra <tt>binat</tt> estabelece o mapeamento
d421 7
a427 6
Podendo ser usado por exemplo, para disponibilizar um servidor web na
rede interna que possua seu próprio IP externo. Conexões vindas da
Internet para esse endereço serão traduzidas para o endereço interno
e as conexões do servidor web (como pesquisas DNS) serão traduzidas
para o endereço externo. Portas TCP e UDP nunca são alteradas por
regras <tt>binat</tt> como acontece com regras <tt>nat</tt>.
d454 1
a454 1
o endereço externo 24.2.74.79, exceto o host 192.168.1.208.
d457 4
a460 3
Note que a primeira regra que casa vence; se for uma regra <tt>no</tt>,
o pacote não é traduzido. A palavra-chave <tt>no</tt> pode também ser
usada com regras <tt>binat</tt> e <a href="rdr.html"><tt>rdr</tt></a>.
d463 1
a463 1
<h2>Verificando Status do NAT</h2>
d467 3
a469 2
com a opção <tt>-s state</tt> é usado para verificar as traduções NAT.
Esta opção listará todas as sessões NAT ativas:
d478 1
a478 1
Explicações (apenas a primeira linha):
d501 1
a501 1
<dd>O endereço IP (24.5.0.5) e porta (53136) no gateway onde os
d507 1
a507 1
<dd>O endereço IP (65.42.33.245) e porta (22) onde a máquina interna
d531 1
a531 1
$Translation: nat.html,v 1.9 2009/05/10 17:44:16 alan Exp $<br>
@


1.8
log
@Sync with Steelix CVS
@
text
@d215 1
a215 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pflogd&amp;sektion=8&amp;manpath=OpenBSD+4.4"
d242 3
a244 3
    <tt>/<i>máscara</i></tt> (ex. <tt>/24</tt>). Cada endereço IP na
    interface é combinado com a máscara para formar um bloco de rede
    CIDR que será substituído na regra.
d248 1
a248 1
    <li><tt>:network</tt> - substitui o bloco de rede CIDR (ex.,
d251 1
a251 1
        (ex., 192.168.0.255)
d331 1
a331 1
  <li><tt>:network</tt> - substitui um bloco de rede CIDR (ex.,
d455 1
a455 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+4.4"
d519 2
a520 2
Originally [OpenBSD: nat.html,v 1.29 ]<br>
$Translation: nat.html,v 1.8 2009/03/11 00:52:56 dsantos Exp $<br>
@


1.7
log
@Sync with Steelix CVS
@
text
@d4 1
a4 1
<title>PF: Tradu&ccedil;&atilde;o do Endere&ccedil;o de Rede (NAT)</title>
d8 3
a10 3
<meta name="description" content="the OpenBSD FAQ page">
<meta name="keywords" content="openbsd,faq,pf">
<meta name="distribution" content="global">
d41 3
a43 2
[<a href="index.html">Conte&uacute;do</a>]
[<a href="rdr.html">Pr&oacute;ximo: Redirecionamento de Tr&aacute;fego (Port Forwarding)</a>]
d46 1
a46 1
<h1><font color="#e00000">PF: Tradu&ccedil;&atilde;o do Endere&ccedil;o de Rede (NAT)</font></h1>
d50 1
a50 1
<h3>Conte&uacute;do</h3>
d52 1
a52 1
<li><a href="#intro">Introdu&ccedil;&atilde;o</a>
d58 1
a58 1
<li><a href="#except">Excess&otilde;es em Regras de Tradu&ccedil;&atilde;o</a>
d65 8
a72 7
<h2>Introdu&ccedil;&atilde;o</h2>
Tradu&ccedil;&atilde;o do Endere&ccedil;o de Rede (NAT) &eacute; uma forma de mapear toda uma rede 
(ou redes) para apenas um endere&ccedil;o IP.  NAT &eacute; necess&aacute;rio quando o 
n&uacute;mero de endere&ccedil;os IP atribu&iacute;dos a voc&ecirc; pelo seu Provedor de 
Servi&ccedil;os Internet &eacute; menor que o n&uacute;mero total de computadores para os quais 
voc&ecirc; quer prover acesso &agrave; Internet. NAT est&aacute; descrito na 
<a href="http://www.geektools.com/rfc/rfc1631.txt">RFC 1631</a>.
d75 3
a77 3
NAT permite voc&ecirc; fazer uso dos blocos de endere&ccedil;os reservados 
descritos na 
<a href="http://www.geektools.com/rfc/rfc1918.txt">RFC 1918</a>, 
d79 3
a81 3
Tipicamente sua rede interna ser&aacute; configurada com endere&ccedil;os IP de 
um ou mais blocos nessas redes. S&atilde;o eles:
<pre>	
d88 4
a91 4
Um sistema OpenBSD fazendo NAT deve ter ao menos dois adaptadores de rede, 
um para a Internet, e outro para a rede interna.  O NAT ir&aacute; traduzir 
requisi&ccedil;&otilde;es da rede interna de forma que elas pare&ccedil;am se originar 
do sistema OpenBSD fazendo NAT.
d96 4
a99 5
Quando um cliente na rede interna procura uma m&aacute;quina na Internet, 
ele envia pacotes IP destinados a esta m&aacute;quina. Estes pacotes cont&eacute;m 
toda a informa&ccedil;&atilde;o de endere&ccedil;amento necess&aacute;ria para chegar a seu 
destino. Informa&ccedil;&atilde;o pertinente ao NAT:

d101 1
a101 1
<li>Endere&ccedil;o IP de orgigem (por exemplo, 192.168.1.35)
d106 6
a111 6
Quando o pacote passa pelo gateway NAT &eacute; alterado para que pare&ccedil;a ter 
sido originado no pr&oacute;prio gateway. O gateway NAT registra ent&atilde;o as 
altera&ccedil;&otilde;es feitas por ele em sua tabela de estado para que ele 
possa a) reverter as altera&ccedil;&otilde;es nos pacotes que retornam e b) certificar-se 
de que os pacotes que retornam, cruzem o firewall sem serem bloqueados. Por exemplo, 
as seguintes altera&ccedil;&otilde;es devem ser feitas:
d113 1
a113 1
<li>Endere&ccedil;o IP de origem: substitu&iacute;do pelo endere&ccedil;o externo do gateway 
d115 1
a115 1
<li>Porta de origem: substitu&iacute;da por uma porta dispon&iacute;vel no gateway 
d120 16
a135 16
Nem a m&aacute;quina interna e nem o host na Internet percebem esse trabalho de 
tradu&ccedil;&atilde;o. Para a m&aacute;quina interna, o sistema NAT &eacute; simplesmente um 
gateway Internet. Para o host na Internet, os pacotes parecem vir diretamente 
do sistema NAT; ele nem mesmo suspeita da exist&ecirc;ncia da esta&ccedil;&atilde;o de 
trabalho interna.

<p>
Quando o host na Internet responde aos pacotes da m&aacute;quina interna, eles 
ser&atilde;o endere&ccedil;ados ao IP externo do gateway NAT (24.5.0.5) na 
porta da tradu&ccedil;&atilde;o (53136). O gateway NAT pesquisar&aacute; ent&atilde;o sua tabela 
de estado para determinar se os pacotes em resposta casam com uma 
conex&atilde;o j&aacute; estabelecida. Uma ocorr&ecirc;ncia &uacute;nica ser&aacute; encontrada 
baseado na combina&ccedil;&atilde;o endere&ccedil;o IP/porta que diz ao PF que os pacotes pertencem 
a conex&atilde;o iniciada pela m&aacute;quina interna 192.168.1.35. O PF ent&atilde;o 
faz as altera&ccedil;&otilde;es reversas feitas nos pacotes que
estabeleceram a conex&atilde;o e transfere as respostas para a m&aacute;quina interna.
d138 2
a139 2
A tradu&ccedil;&atilde;o de pacotes ICMP ocorre de maneira similar mas sem altera&ccedil;&atilde;o 
de porta de origem.
d144 6
a149 6
<font color="#ff0000">NOTA:</font> Pacotes traduzidos ainda devem passar 
pelo sistema de filtragem e ser&atilde;o aceitos ou bloqueados baseado nas regras
de filtragem definidas. 
A <i>&uacute;nica</i> excess&atilde;o a esta regra se d&aacute; quando 
a palavra-chave <tt>pass</tt> &eacute; usada em uma regra <tt>nat</tt>.
O que far&aacute; com que os pacotes NATeados passem direto pelo sistema 
d153 4
a156 3
Saiba tamb&eacute;m que, como a tradu&ccedil;&atilde;o ocorre <i>antes</i> da filtragem, o
sistema de filtagem enxergar&aacute; o pacote j&aacute; <i>traduzido</i> para o 
endere&ccedil;o IP e porta conforme explicado em <a href="#works">Como Funciona o NAT</a>.
d163 5
a167 6
Como o NAT &eacute; quase sempre usado em roteadores e gateways de rede, 
provavelmente ser&aacute; necess&aacute;rio habilitar o IP forwarding para que 
pacotes possam trafegar entre as interfaces de rede na m&aacute;quina OpenBSD.
IP forwarding &eacute; habilitado usando o mecanismo
<a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysctl&amp;sektion=3"
d177 1
a177 1
Para que essa altera&ccedil;&atilde;o seja permanente, as linhas a seguir devem ser 
d179 2
a180 3
<a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysctl.conf&amp;sektion=5">
<tt>/etc/sysctl.conf</tt></a>:
d189 1
a189 1
Estas linhas est&atilde;o presentes, mas comentadas 
d191 1
a191 1
O IP forwarding ser&aacute; habilitado quando a m&aacute;quina for reiniciada.
d198 1
a198 1
nat [pass] [log] on <i>interface</i> [<i>af</i>] from <i>src_addr</i> 
d200 1
a200 1
&nbsp;&nbsp;&nbsp;<i>dst_addr</i> [port <i>dst_port</i>] -&gt; 
d210 1
a210 1
<dd>Faz com que pacotes traduzidos passem direto pelas regras de 
d214 2
a215 3
<dd>Loga pacotes que combinem com a regra via 
<a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=pflogd&amp;sektion=8&amp;manpath=OpenBSD+4.2"
d217 1
a217 1
Normalmente apenas o primeiro pacote que combina ser&aacute; logado.
d221 1
a221 1
<dd>O nome ou grupo da interface de rede onde os pacotes devem ser 
d225 3
a227 3
<dd>A fam&iacute;lia do endere&ccedil;o, <tt>inet</tt> para IPv4 ou 
<tt>inet6</tt> para IPv6. Normalmente o PF pode determinar essa 
informa&ccedil;&atilde;o com base nos endere&ccedil;os de origem/destino.
d230 2
a231 2
<dd>O endere&ccedil;o de origem (interno) dos pacotes que ser&atilde;o 
traduzidos. O endere&ccedil;o de origem pode ser especificado como:
d233 31
a263 32
<li>Um endere&ccedil;o IPv4 ou IPv6 simples.
<li>Um bloco de rede <a href="http://public.pacbell.net/dedicated/cidr.html">CIDR</a>.
<li>Um nome de dom&iacute;nio totalmente qualificado que ser&aacute; 
resolvido pelo DNS quando as regras forem carregadas. Todos 
endere&ccedil;os IP resultantes da pesquisa ser&atilde;o 
substitu&iacute;dos nas regras.
<li>O nome ou grupo de uma interface de rede. Qualquer n&uacute;mero IP 
atribu&iacute;do &agrave; interface ser&aacute; usado quando a regra 
for carregada.
<li>O nome de uma interface de rede seguido por uma 
<tt>/<i>m&aacute;scara</i></tt> (ex. <tt>/24</tt>). Cada endere&ccedil;o 
IP na interface &eacute; combinado com a m&aacute;scara para formar um 
bloco de rede CIDR que &eacute; substitu&iacute;do na regra.
<li>O nome ou grupo de uma interface de rede acompanhado de um dos 
modificadores:
  <ul>
  <li><tt>:network</tt> - substitui o bloco de rede CIDR (ex.,
  192.168.0.0/24)
  <li><tt>:broadcast</tt> - substitui o endere&ccedil;o de broadcast 
  (ex., 192.168.0.255)
  <li><tt>:peer</tt> - substitui o endere&ccedil;o da outra ponta num 
  link ponto-a-ponto 
  </ul>
  <dl>
  <dd>Al&eacute;m disso, o modificador <tt>:0</tt> pode ser adicionado 
  a um nome/grupo de interface ou a qualquer dos modificadores acima 
  para dizer ao PF para n&atilde;o incluir aliases de endere&ccedil;os 
  IP na substitui&ccedil;&atilde;o.
  Esses modificadores tamb&eacute;m podem ser usados quando a interface 
  &eacute; colocada entre par&ecirc;nteses.
  Exemplo: <tt>fxp0:network:0</tt>
  </dl>
d265 4
a268 3
<li>Qualquer um acima, sendo negado com modificador <tt>!</tt> ("not").
<li>Um grupo de endere&ccedil;os usando uma <a href="macros.html#lists">lista</a>.
<li>A palavra-chave <tt>any</tt> que significa todos endere&ccedil;os
d272 2
a273 2
<dd>A porta de origem no cabe&ccedil;alho da Camada 4 do pacote. Portas 
s&atilde;o especificadas como:
d275 5
a279 6
<li>Um n&uacute;mero entre 1 e 65535
<li>Um nome de servi&ccedil;o v&aacute;lido em 
<a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=services&amp;sektion=5">
<tt>/etc/services</tt></a>
<li>Um grupo de portas utilizando uma <a href="macros.html#lists">lista</a>
d290 2
a291 3
	<dd>Os dois &uacute;ltimos s&atilde;o operadores bin&aacute;rios 
	(recebem dois argumentos)
	 e n&atilde;o incluem o argumento na faixa.
d293 1
a293 1
	<li><tt>:</tt> (faixa inclusive)
d295 2
a296 2
	<dd>O operador inclusivo tamb&eacute;m &eacute; um operador 
	bin&aacute;rio e inclui os argumentos na faixa.
d300 3
a302 3
A op&ccedil;&atilde;o <tt>port</tt> geralmente n&atilde;o &eacute; 
usada em regras <tt>nat</tt> porque o objetivo geralmente &eacute; 
fazer NAT de todo o tr&aacute;fego, independente das portas sendo usadas.
d305 2
a306 2
<dd>O endere&ccedil;o de destino dos pacotes a serem traduzidos.
Ele &eacute; especificado da mesma forma que o endere&ccedil;o de origem.
d309 2
a310 2
<dd>A porta de destino no cabe&ccedil;alho da Camada 4 do pacote. Esta 
porta &eacute; especificada da mesma forma que a porta de origem.
d313 2
a314 3
<dd>O endere&ccedil;o externo (de tradu&ccedil;&atilde;o) do gateway 
NAT em que os pacotes ser&atilde;o traduzidos. O endere&ccedil;o externo 
pode ser especificado como:
d316 14
a329 14
<li>Um endere&ccedil;o IPv4 ou IPv6 simples.
<li>Um bloco de rede <a href="http://public.pacbell.net/dedicated/cidr.html">CIDR</a> .
<li>Nome de dom&iacute;nio totalmente qualificado que ser&aacute; resolvido pelo 
servidor DNS quando a regra for carregada.
<li>O nome da interface de rede externa. Quaisquer endere&ccedil;os ip 
atribu&iacute;dos a interface ser&atilde;o substitu&iacute;dos nas regras quando forem 
carregadas.
<li>O nome da interface de rede externa entre par&ecirc;nteses
<tt>( )</tt>. Isso informa ao PF para atualizar a regra caso o 
endere&ccedil;o da interface sofra altera&ccedil;&otilde;es. &Eacute; muito &uacute;til quando a 
interface externa tem seu endere&ccedil;o IP atribu&iacute;do via DHCP ou dial-up, 
j&aacute; que as regras n&atilde;o precisam ser recarregadas a cada altera&ccedil;&atilde;o no 
endere&ccedil;o.
<li>O nome da interface de rede seguido de alguns destes modificadores:
d332 3
a334 3
  192.168.0.0/24)
  <li><tt>:peer</tt> - &eacute; trocado pelo endere&ccedil;o IP da outra ponta num link 
  ponto-a-ponto 
d337 5
a341 5
  <dd>Al&eacute;m disso o modificador <tt>:0</tt> pode ser inclu&iacute;do num nome de 
  interface ou em qualquer dos modificadores acima para indicar que o PF 
  n&atilde;o deve incluir endere&ccedil;os IP de aliases. 
  Estes modificadores tamb&eacute;m podem ser usados quando a interface est&aacute; 
  entre par&ecirc;nteses.
d344 1
a344 1
<li>Um grupo de endere&ccedil;os utilizando-se uma <a href="macros.html#lists">lista</a>.
d348 2
a349 2
<dd>Especifica o tipo do <a href="pools.html">grupo de endere&ccedil;os</a> a usar para 
tradu&ccedil;&atilde;o.
d352 2
a353 1
<dd>Informa ao PF para n&atilde;o traduzir a porta de origem em pacotes TCP e UDP.
d358 1
a358 1
O que pode nos levar a cria&ccedil;&atilde;o de uma regra b&aacute;sica equivalente:
d367 2
a368 2
pacotes vindos de 192.168.1.0/24 e substituir o endere&ccedil;o IP de origem para 
24.5.0.5.
d371 7
a377 5
Embora a regra acima esteja correta, esta forma de uso n&atilde;o &eacute; recomendada.
A manuten&ccedil;&atilde;o pode se tornar dificil porque caso algum endere&ccedil;o, na interface 
externa ou interna seja alterado a linha tamb&eacute;m precisar&aacute; ser alterada. 
Fa&ccedil;a a compara&ccedil;&atilde;o com uma linha que facilita um pouco a 
manuten&ccedil;&atilde;o (<tt>tl0</tt> &eacute; externa, <tt>dc0</tt> interna):
d385 1
a385 1
A vantatem deve ser clara: podemos alterar o endere&ccedil;o IP de qualquer 
d389 10
a398 9
Ao especificar um nome de interface para a tradu&ccedil;&atilde;o de endere&ccedil;os como 
acima, o endere&ccedil;o IP &eacute; determinado no <i>carregamento</i> do pf.conf, 
e n&atilde;o em tempo real.  Caso esteja usando DHCP para configurar sua interface 
externa, isso pode se tornar um problema. Se o endere&ccedil;o atribu&iacute;do for 
alterado, o NAT continuar&aacute; traduzindo pacotes com destino externo usando 
o endere&ccedil;o IP antigo. O que far&aacute; com que as conex&otilde;es parem de funcionar. 
Para evitar esse problema, voc&ecirc; pode dizer ao PF para atualizar o endere&ccedil;o 
de tradu&ccedil;&atilde;o automaticamente, colocando o nome da interface entre par&ecirc;nteses:

d406 1
a406 1
Este m&eacute;todo funciona para tradu&ccedil;&atilde;o tanto de endere&ccedil;os IPv4 quanto IPv6.
d410 9
a418 9
Um mapeamento bidirecional pode ser estabelecido atrav&eacute;s do uso da 
regra <tt>binat</tt>. A regra <tt>binat</tt> estabelece o 
mapeamento um para um entre um endere&ccedil;o IP interno e um endere&ccedil;o 
externo. Podendo ser usado por exemplo, para disponibilizar um servidor 
web na rede interna que possua seu pr&oacute;prio ip externo. Conex&otilde;es vindas 
da Internet para esse endere&ccedil;o ser&atilde;o traduzidas para o endere&ccedil;o 
interno e as conex&otilde;es do servidor web (como pesquisas DNS) ser&atilde;o 
traduzidas para o endere&ccedil;o externo. Portas TCP e UDP nunca s&atilde;o 
alteradas por regras <tt>binat</tt> como acontece com regras <tt>nat</tt>.
d432 4
a435 3
<h2>Excess&otilde;es em Regras de Tradu&ccedil;&atilde;o</h2>
Excess&otilde;es &agrave;s regras de tradu&ccedil;&atilde;o podem ser feitas usando-se a 
palavra-chave <tt>no</tt>. Por exemplo, se o exemplo de NAT acima fosse alterado para:
d444 2
a445 2
Ent&atilde;o toda a rede 192.168.1.0/24 teria seus pacotes traduzidos para 
o endere&ccedil;o externo 24.2.74.79 exceto o host 192.168.1.208.
d448 3
a450 4
Note que a primeira regra que casa vence; se for uma regra <tt>no</tt>, 
o pacote n&atilde;o &eacute; traduzido. A palavra-chave <tt>no</tt> 
pode tamb&eacute;m ser usada com regras <tt>binat</tt> e 
<a href="rdr.html"><tt>rdr</tt></a>.
d454 5
a458 5
O <a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+4.2">pfctl(8)</a> 
com a op&ccedil;&atilde;o <tt>-s state</tt> &eacute; usado para 
verificar as tradu&ccedil;&otilde;es NAT. Esta op&ccedil;&atilde;o 
listar&aacute; todas sess&otilde;es NAT ativas:
d460 1
a460 1
<pre>   
d467 1
a467 1
Explica&ccedil;&otilde;es (apenas a primeira linha):
d471 2
a472 2
<dd>Indica a interface a qual o estado est&aacute; vinculado. A palavra
<tt>self</tt> aparecer&aacute; caso o estado seja
d478 1
a478 1
<dd>O protocolo usado pela conex&atilde;o.
d483 3
a485 4
<dd>O endere&ccedil;o IP (192.168.1.35) da m&aacute;quina na rede 
interna. A porta de origem (2132) &eacute; mostrada ap&oacute;s o 
endere&ccedil;o. Este tamb&eacute;m &eacute; o endere&ccedil;o 
substitu&iacute;do no cabe&ccedil;alho IP.
d490 2
a491 2
<dd>O endere&ccedil;o IP (24.5.0.5) e porta (53136) no gateway onde os 
pacotes est&atilde;o sendo traduzidos.
d496 2
a497 2
<dd>O endere&ccedil;o IP (65.42.33.245) e porta (22) onde a 
m&aacute;quina interna est&aacute; se conectando.
d503 1
a503 1
<dd>Indica em qual estado o PF acredita que a conex&atilde;o TCP esteja.
d508 3
a510 2
[<a href="index.html">Conte&uacute;do</a>]
[<a href="rdr.html">Pr&oacute;ximo: Redirecionamento de Tr&aacute;fego (Port Forwarding)</a>]
d519 2
a520 2
Originally [OpenBSD: nat.html,v 1.27 ]<br>
$Translation: nat.html,v 1.7 2007/11/24 18:12:31 dsantos Exp $<br>
d522 1
a522 1
$OpenBSD$ 
@


1.6
log
@sync with steelix translation CVS
@
text
@d166 1
a166 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysctl&amp;sektion=3&amp;manpath=OpenBSD+4.0"
d179 2
a180 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysctl.conf&amp;sektion=5&amp;manpath=OpenBSD+4.0"><tt>/etc/sysctl.conf</tt></a>:
d198 1
a198 1
nat [pass [log]] on <i>interface</i> [<i>af</i>] from <i>src_addr</i>
d214 1
a214 2
<dd>Quando <tt>pass</tt> &eacute; especificado os pacotes podem ser 
logados via
d216 2
a217 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=pflogd&amp;sektion=8&amp;manpath=OpenBSD+4.0">pflogd(8)</a>.
d279 1
a279 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=services&amp;sektion=5&amp;manpath=OpenBSD+4.0">
d455 1
a455 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+4.0">pfctl(8)</a> 
d519 2
a520 2
Originally [OpenBSD: nat.html,v 1.25 ]<br>
$Translation: nat.html,v 1.6 2006/12/28 18:29:29 dsantos Exp $<br>
@


1.5
log
@sync with steelix translation CVS
@
text
@d75 2
a76 1
<a href="http://www.geektools.com/rfc/rfc1918.txt">RFC 1918</a>.
d166 1
a166 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysctl&amp;sektion=3&amp;manpath=OpenBSD+3.9"
d179 1
a179 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysctl.conf&amp;sektion=5&amp;manpath=OpenBSD+3.9"><tt>/etc/sysctl.conf</tt></a>:
d209 2
a210 1
<dd>Faz com que pacotes traduzidos passem direto pelas regras de filtragem.
d213 2
a214 1
<dd>Quando <tt>pass</tt> &eacute; especificado os pacotes podem ser logados via
d216 1
a216 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=pflogd&amp;sektion=8&amp;manpath=OpenBSD+3.9">pflogd(8)</a>.
d221 2
a222 1
<dd>O nome da interface de rede onde os pacotes devem ser traduzidos.
d225 3
a227 3
<dd>A fam&iacute;lia do endere&ccedil;o, <tt>inet</tt> para IPv4 ou <tt>inet6</tt>
para IPv6. Normalmente o PF pode determinar essa informa&ccedil;&atilde;o com base nos 
endere&ccedil;os de origem/destino.
d230 2
a231 2
<dd>O endere&ccedil;o de origem (interno) dos pacotes que ser&atilde;o traduzidos. 
O endere&ccedil;o de origem pode ser especificado como:
d235 7
a241 5
<li>Um nome de dom&iacute;nio totalmente qualificado que ser&aacute; resolvido pelo 
DNS quando as regras forem carregadas. Todos endere&ccedil;os IP resultantes da 
pesquisa ser&atilde;o substitu&iacute;dos nas regras.
<li>O nome de uma interface de rede. Qualquer n&uacute;mero IP atribu&iacute;do &agrave; 
interface ser&aacute; usado quando a regra for carregada.
d243 5
a247 4
<tt>/<i>m&aacute;scara</i></tt> (ex. <tt>/24</tt>). Cada endere&ccedil;o IP na interface
&eacute; combinado com a m&aacute;scara para formar um bloco de rede CIDR que &eacute; 
substitu&iacute;do na regra.
<li>O nome de uma interface de rede acompanhado de um dos modificadores:
d253 2
a254 2
  <li><tt>:peer</tt> - substitui o endere&ccedil;o da outra ponta num link 
  ponta-a-ponto 
d257 6
a262 5
  <dd>Al&eacute;m disso, o modificador <tt>:0</tt> pode ser adicionado a um nome 
  de interface ou a qualquer dos modificadores acima para dizer ao PF para 
  n&atilde;o incluir aliases de endere&ccedil;os IP na substitui&ccedil;&atilde;o.
  Esses modificadores tamb&eacute;m podem ser usados quando a interface &eacute; colocada 
  entre par&ecirc;nteses.
d278 1
a278 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=services&amp;sektion=5&amp;manpath=OpenBSD+3.9">
d291 2
a292 1
	<dd>Os dois &uacute;ltimos s&atilde;o operadores bin&aacute;rios (recebem dois argumentos)
d297 2
a298 2
	<dd>O operador inclusivo tamb&eacute;m &eacute; um operador bin&aacute;rio e inclui os 
	argumentos na faixa.
d302 3
a304 3
A op&ccedil;&atilde;o <tt>port</tt> geralmente n&atilde;o &eacute; usada em regras <tt>nat</tt>
porque o objetivo geralmente &eacute; fazer NAT de todo o tr&aacute;fego, independente das 
portas sendo usadas.
d311 2
a312 2
<dd>A porta de destino no cabe&ccedil;alho da Camada 4 do pacote. Esta porta 
&eacute; especificada da mesma forma que a porta de origem.
d315 3
a317 2
<dd>O endere&ccedil;o externo (de tradu&ccedil;&atilde;o) do gateway NAT em que os 
pacotes ser&atilde;o traduzidos. O endere&ccedil;o externo pode ser especificado como:
d446 4
a449 3
Note que a primeira regra que casa vence; se for uma regra <tt>no</tt>, o 
pacote n&atilde;o &eacute; traduzido. A palavra-chave <tt>no</tt> pode tamb&eacute;m ser usada 
com regras <tt>binat</tt> e <a href="rdr.html"><tt>rdr</tt></a>.
d454 4
a457 3
href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+3.9">pfctl(8)</a> com a op&ccedil;&atilde;o <tt>-s state</tt> &eacute; 
usado para verificar as tradu&ccedil;&otilde;es NAT. Esta op&ccedil;&atilde;o listar&aacute; todas 
sess&otilde;es NAT ativas:
d482 4
a485 3
<dd>O endere&ccedil;o IP (192.168.1.35) da m&aacute;quina na rede interna. A porta 
de origem (2132) &eacute; mostrada ap&oacute;s o endere&ccedil;o. Este tamb&eacute;m &eacute; 
o endere&ccedil;o substitu&iacute;do no cabe&ccedil;alho IP.
d490 2
a491 2
<dd>O endere&ccedil;o IP (24.5.0.5) e porta (53136) no gateway onde os pacotes 
est&atilde;o sendo traduzidos.
d496 2
a497 2
<dd>O endere&ccedil;o IP (65.42.33.245) e porta (22) onde a m&aacute;quina interna 
est&aacute; se conectando.
d518 2
a519 2
Originally [OpenBSD: nat.html,v 1.23 ]<br>
$Translation: nat.html,v 1.5 2006/05/28 17:23:03 dsantos Exp $<br>
@


1.4
log
@sync with steelix translation CVS
@
text
@d165 1
a165 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysctl&amp;sektion=3&amp;manpath=OpenBSD+3.8"
d178 1
a178 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysctl.conf&amp;sektion=5&amp;manpath=OpenBSD+3.8"><tt>/etc/sysctl.conf</tt></a>:
d212 2
a213 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pflogd&amp;sektion=8&amp;manpath=OpenBSD+3.8">pflogd(8)</a>.
d270 1
a270 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=services&amp;sektion=5&amp;manpath=OpenBSD+3.8">
d443 1
a443 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+3.8">pfctl(8)</a> com a op&ccedil;&atilde;o <tt>-s state</tt> &eacute; 
d505 2
a506 2
Originally [OpenBSD: nat.html,v 1.22 ]<br>
$Translation: nat.html,v 1.4 2006/01/18 18:44:11 dsantos Exp $<br>
@


1.3
log
@sync with steelix translation CVS
@
text
@d196 1
a196 1
nat [pass] on <i>interface</i> [<i>af</i>] from <i>src_addr</i> 
d210 6
d504 2
a505 2
Originally [OpenBSD: nat.html,v 1.21 ]<br>
$Translation: nat.html,v 1.3 2005/11/15 14:36:42 dsantos Exp $<br>
@


1.2
log
@sync with Steelix CVS
@
text
@d164 2
a165 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysctl&amp;sektion=3&amp;manpath=OpenBSD+3.7"
d177 2
a178 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysctl.conf&amp;sektion=5&amp;manpath=OpenBSD+3.7"><tt>/etc/sysctl.conf</tt></a>:
d262 2
a263 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=services&amp;sektion=5&amp;manpath=OpenBSD+3.7">
d435 2
a436 1
O <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+3.7">pfctl(8)</a> com a op&ccedil;&atilde;o <tt>-s state</tt> &eacute; 
d497 4
a500 2
Originally [OpenBSD: nat.html,v 1.20 ]<br>
$Translation: nat.html,v 1.2 2005/05/27 15:11:33 dsantos Exp $<br>
@


1.1
log
@sync with steelix translation CVS
@
text
@d164 1
a164 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysctl&amp;sektion=3&amp;manpath=OpenBSD+3.6"
d176 1
a176 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysctl.conf&amp;sektion=5&amp;manpath=OpenBSD+3.6"><tt>/etc/sysctl.conf</tt></a>:
d260 1
a260 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=services&amp;sektion=5&amp;manpath=OpenBSD+3.6">
d432 1
a432 1
O <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+3.6">pfctl(8)</a> com a op&ccedil;&atilde;o <tt>-s state</tt> &eacute; 
d493 2
a494 2
Originally [OpenBSD: nat.html,v 1.19 ]<br>                                                      
$Translation: nat.html,v 1.1 2005/01/04 17:09:07 dsantos Exp $<br>                 
@

