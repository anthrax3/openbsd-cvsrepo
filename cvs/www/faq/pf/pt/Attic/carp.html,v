head	1.18;
access;
symbols;
locks; strict;
comment	@# @;


1.18
date	2014.04.01.17.14.11;	author nick;	state dead;
branches;
next	1.17;

1.17
date	2013.12.06.20.52.46;	author ajacoutot;	state Exp;
branches;
next	1.16;

1.16
date	2013.05.03.05.53.48;	author ajacoutot;	state Exp;
branches;
next	1.15;

1.15
date	2013.01.18.07.15.55;	author ajacoutot;	state Exp;
branches;
next	1.14;

1.14
date	2009.10.19.09.39.59;	author ajacoutot;	state Exp;
branches;
next	1.13;

1.13
date	2009.10.17.15.58.26;	author ajacoutot;	state Exp;
branches;
next	1.12;

1.12
date	2009.05.16.08.59.12;	author ajacoutot;	state Exp;
branches;
next	1.11;

1.11
date	2009.03.16.20.24.23;	author tobias;	state Exp;
branches;
next	1.10;

1.10
date	2007.12.16.17.18.35;	author tobias;	state Exp;
branches;
next	1.9;

1.9
date	2007.06.23.18.29.30;	author jufi;	state Exp;
branches;
next	1.8;

1.8
date	2007.03.28.14.30.38;	author jufi;	state Exp;
branches;
next	1.7;

1.7
date	2006.12.29.12.56.48;	author jufi;	state Exp;
branches;
next	1.6;

1.6
date	2006.10.27.07.04.45;	author jufi;	state Exp;
branches;
next	1.5;

1.5
date	2006.06.26.18.32.12;	author jufi;	state Exp;
branches;
next	1.4;

1.4
date	2006.05.29.11.06.11;	author jufi;	state Exp;
branches;
next	1.3;

1.3
date	2005.12.03.08.02.51;	author saad;	state Exp;
branches;
next	1.2;

1.2
date	2005.10.26.19.06.04;	author jufi;	state Exp;
branches;
next	1.1;

1.1
date	2005.08.25.13.31.28;	author saad;	state Exp;
branches;
next	;


desc
@@


1.18
log
@
Abandon translations, per deraadt@@ and ajacoutot@@.
@
text
@<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>PF: Redundância de Firewall com CARP e pfsync</title>
<link rev="made" href="mailto:www@@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name="resource-type" content="document">
<meta name="description"   content="the OpenBSD FAQ page">
<meta name="keywords"      content="openbsd,faq,pf,carp,pfsync">
<meta name="distribution"  content="global">
</head>

<!--
Copyright (c) 2005-2007 Joel Knight <enabled@@myrealbox.com>

Permission to use, copy, modify, and distribute this documentation for
any purpose with or without fee is hereby granted, provided that the
above copyright notice and this permission notice appear in all copies.

THE DOCUMENTATION IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL
WARRANTIES WITH REGARD TO THIS DOCUMENTATION INCLUDING ALL IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE
AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL
DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR
PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS DOCUMENTATION
-->

<body bgcolor="#ffffff" text="#000000">
<!-- Passes validator.w3.org, please keep it this way;
please, use a max of 72 chars per line -->

<a href="../../../pt/index.html">
<img alt="[OpenBSD]" height=30 width=141 src="../../../images/smalltitle.gif" border="0">
</a>
<p>
[<a href="authpf.html">Anterior: Shell de Usuário para
Gateways de Autenticação</a>]
[<a href="index.html">Conteúdo</a>]
[<a href="example1.html">Próximo: Firewall para Casa ou Pequeno Escritório</a>]

<p>
<h1><font color="#e00000">PF: Redundância de Firewall com CARP
e pfsync</font></h1>

<hr>

<h3>Conteúdo</h3>
<ul>
<li><a href="#carpintro">Introdução ao CARP</a>
<li><a href="#carpop">Funcionamento do CARP</a>
<li><a href="#carpconfig">Configuração do CARP</a>
<li><a href="#carpex">Exemplo de configuração do CARP</a>
<li><a href="#pfsyncintro">Introdução ao pfsync</a>
<li><a href="#pfsyncop">Funcionamento do pfsync</a>
<li><a href="#pfsyncconfig">Configuração do pfsync</a>
<li><a href="#pfsyncex">Exemplo de configuração do pfsync</a>
<li><a href="#failover">Combinando CARP e pfsync para "Failover" e
    Redundância</a>
<li><a href="#ops">Problemas Operacionais</a>
	<ul>
	<li><a href="#bootconfig">Configuração do CARP e pfsync Durante
            a Inicialização</a>
	<li><a href="#forcefail">Forçando "Failover" do Mestre</a>
	<li><a href="#RulesetTips">Dicas de Conjunto de Regras</a>
	</ul>
<li><a href="#ref">Outras Referências</a>
</ul>

<hr>

<a name="carpintro"></a>
<h2>Introdução ao CARP</h2>
CARP é o Protocolo de Redundância de Endereço Comum
("Common Address Redundancy Protocol").
Seu objetivo principal é permitir que múltiplas máquinas no mesmo
segmento de rede compartilhem um endereço IP.
CARP é uma alternativa livre e segura ao
<a href="http://www.ietf.org/rfc/rfc3768.txt">Protocolo de Redundância de Roteador Virtual</a>
(VRRP - "Virtual Router Redundancy Protocol")
e ao
<a href="http://www.ietf.org/rfc/rfc2281.txt">Protocolo de Roteador de Espera a Quente</a>
(HSRP - "Hot Standby Router Protocol").

<p>
CARP funciona permitindo a um grupo de máquinas no mesmo
segmento de rede compartilhar um endereço IP.
Esse grupo de máquinas é referido como um "grupo de redundância".
Ao grupo de redundância é atribuído um endereço IP que é compartilhado
entre os membros do grupo.
Dentro do grupo, uma máquina é designada como "mestre" e o resto como
"backups".
A máquina mestre é a que atualmente "segura" o IP compartilhado; ela
responde a qualquer tráfego ou requisições ARP direcionadas a ele.
Cada máquina pode pertencer a mais de um grupo de redundância por vez.

<p>
Um uso comum para o CARP é criar um grupo de firewalls redundantes.
O IP virtual que é atribuído ao grupo de redundância é configurado nas
máquinas clientes como o gateway padrão.
Caso o firewall mestre sofra uma falha ou seja desligado, o IP se moverá
para um dos firewalls backup e o serviço vai continuar sem ser afetado.

<p>
CARP suporta IPv4 e IPv6.


<a name="carpop"></a>
<h2>Funcionamento do CARP</h2>
A máquina mestre no grupo envia regularmente anúncios à rede local,
assim as máquinas backup sabem que ela ainda está ativa.
Se as máquinas backup não ouvirem um anúncio do mestre por um período de
tempo, então uma delas tomará conta dos deveres do mestre (qualquer
máquina backup com os valores mais baixos definidos para
<tt>advbase</tt> e <tt>advskew</tt>).

<p>
É possível que múltiplos grupos CARP existam no mesmo segmento de rede.
Anúncios CARP contêm o ID de Máquina Virtual (VHID - "Virtual Host ID")
que permite aos membros do grupo identificar a que grupo de redundância
pertencem.

<p>
Para prevenir que um usuário malicioso no segmento de rede falsifique
anúncios CARP, cada grupo pode ser configurado com uma senha.
Cada pacote CARP enviado ao grupo é então protegido por um HMAC SHA1.

<p>
Como o CARP é seu próprio protocolo, ele deve ter uma regra de permissão
explícita no conjunto de regras de filtragem:

<blockquote>
<tt>
pass out on $carp_dev proto carp keep state
</tt>
</blockquote>

<p>
<tt>$carp_dev</tt> deve ser a interface física por onde o CARP se
comunica.


<a name="carpconfig"></a>
<h2>Configuração do CARP</h2>
Cada grupo de redundância é representado por uma interface
de rede virtual
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+5.4"
>carp(4)</a>. Assim o CARP é configurado usando o
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8"
>ifconfig(8)</a>.

<blockquote>
<tt>
ifconfig <i>carpN</i> create<br>
<br>
ifconfig <i>carpN</i> vhid <i>vhid</i> [pass <i>senha</i>]
[carpdev <i>carpdev</i>] \<br>
&nbsp;&nbsp;&nbsp;[advbase <i>advbase</i>] [advskew <i>advskew</i>]
[state <i>estado</i>] [group|-group <i>grupo</i>] \<br>
&nbsp;&nbsp;&nbsp;<i>endereço_ip</i> netmask <i>máscara</i>
</tt>
</blockquote>
<!-- XXX someone who understands carpnodes should add a piece -->

<dl>
<dt><tt><i>carpN</i></tt>
<dd>O nome da interface virtual carp(4), onde <i>N</i> é um número
inteiro que representa o número da interface (por exemplo, carp10).

<dt><tt><i>vhid</i></tt>
<dd>O ID de Host Virtual. Esse é um número único que é usado para
identificar o grupo de redundância aos outros nós no grupo e 
distingui-lo entre grupos numa mesma rede. 
Valores aceitos são de 1 a 255.
Este valor deve ser o mesmo para todos os hosts percentes ao grupo.

<dt><tt><i>senha</i></tt>
<dd>A senha de autenticação a usar quando estiver conversando com
outras máquinas CARP nesse grupo de redundância.
Deve ser a mesma para todos os membros do grupo.

<dt><tt><i>carpdev</i></tt>
<dd>Esse parâmetro opcional especifica a interface de rede física
que pertence a esse grupo de redundância.
Por padrão, o CARP tenta determinar qual interface usar procurando
pela interface física que está na mesma sub-rede da combinação
<i>endereço_ip</i> e <i>máscara</i> dada à interface carp(4).

<dt><tt><i>advbase</i></tt>
<dd>Esse parâmetro opcional especifica com que frequência, em segundos,
anunciar que somos um membro do grupo de redundância.
O padrão é 1 segundo.
Valores aceitos são de 1 a 255.

<dt><tt><i>advskew</i></tt>
<dd>Esse parâmetro opcional especifica o quanto desviar o
<tt><i>advbase</i></tt> ao enviar anúncios CARP.
Ao manipular o <tt><i>advskew</i></tt>, a máquina CARP mestre pode ser
escolhida. Quanto mais alto o número, <i>menos</i> preferida
será a máquina durante a escolha do mestre.
O padrão é 0.
Valores aceitos são de 0 a 254.

<dt><tt><i>estado</i></tt>
<dd>Força uma interface carp(4) em um certo estado. Estados válidos são
<tt>init</tt>, <tt>backup</tt> e <tt>master</tt>.

<dt><tt><i>grupo</i></tt>
<dd>Adiciona ou remove uma interface carp(4) a um determinado grupo. 
Por padrão, todas as interfaces carp(4) são adicionadas ao grupo 
<tt>carp</tt>. Cada grupo tem um contador <tt>carpdemote</tt> 
englobando todas as interfaces daquele grupo. Como descrito 
<a href="#demote">abaixo</a>, isso pode ser útil para agrupar 
determinadas interfaces juntas com propósito de utilizar failover.

<dt><tt><i>endereço_ip</i></tt>
<dd>Esse é o endereço IP compartilhado atribuído ao
grupo de redundância.
Esse endereço não tem que estar na mesma sub-rede que o endereço IP na
interface física (se presente).
Esse endereço, contudo, precisa ser o mesmo em todas as máquinas no
grupo.

<dt><tt><i>máscara</i></tt>
<dd>A máscara de sub-rede do IP compartilhado.
</dl>

<p>
Além disso, o comportamento do CARP pode ser controlado via
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysctl&amp;sektion=8"
>sysctl(8)</a>.

<dl>
<dt><tt>net.inet.carp.allow</tt>
<dd>Aceita ou não a entrada de pacotes CARP. O padrão é 1 (sim).

<dt><tt>net.inet.carp.preempt</tt>
<dd>Permite à máquinas dentro de um grupo de redundância que tenham
melhores <tt>advbase</tt> e <tt>advskew</tt> tomarem o lugar do mestre.
Adicionalmente, essa opção habilita "failing over" em um grupo de 
interfaces caso uma das interfaces venha a entrar em estado de shutdown.
Se uma interface física CARP cair, o CARP incrementa o contador 
(<tt>carpdemote</tt>) nos grupos cuja interface física faz parte em 1,
fazendo com que todas as outras interfaces possam assumir o failover juntas.
Por padrão, <tt>net.inet.carp.preempt</tt> é 0 (desabilitada).

<dt><tt>net.inet.carp.log</tt>
<dd>Registra mudanças de estado, pacotes mal formados e outros erros.
O valor pode variar de 0 até 7, de acordo com propriedades do syslog(3).
Por padrão, o valor usado é 2 (registra apenas mudanças de estado).
</dl>


<a name="carpex"></a>
<h2>Exemplo de configuração do CARP</h2>
Este é um exemplo de configuração do CARP.

<blockquote>
<tt>
# sysctl -w net.inet.carp.allow=1<br>
# ifconfig carp1 create<br>
# ifconfig carp1 vhid 1 pass mekmitasdigoat carpdev em0 \<br>
&nbsp;&nbsp;&nbsp;&nbsp;advskew 100 10.0.0.1 netmask 255.255.255.0<br>
</tt>
</blockquote>

<p>
Isso configura o seguinte:
<ul>
<li>Habilita a recepção de pacotes CARP (essa é a configuração
    padrão).
<li>Cria uma interface carp(4), <tt>carp1</tt>.
<li>Configura <tt>carp1</tt> para a máquina virtual número 1, habilita
    uma senha, define <tt>em0</tt> como a interface pertencente ao
    grupo, e faz dessa máquina uma máquina backup devido ao
    <tt>advskew</tt> de <tt>100</tt>
    (assumindo, é claro, que a máquina mestre seja configurada com um
    <tt>advskew</tt> menor do que 100).
    O IP compartilhado atribuído a esse grupo é 10.0.0.1/255.255.255.0.
</ul>

<p>
Executar o <tt>ifconfig</tt> na <tt>carp1</tt> mostra o status da
interface.

<blockquote>
<tt>
# ifconfig carp1<br>
carp1: flags=8802&lt;UP,BROADCAST,SIMPLEX,MULTICAST&gt; mtu 1500<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;carp: BACKUP carpdev em0 vhid 1 advbase 1
advskew 100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;groups: carp<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inet 10.0.0.1 netmask 0xffffff00 broadcast
10.0.0.255
</tt>
</blockquote>


<a name="pfsyncintro"></a>
<h2>Introdução ao pfsync</h2>
A interface de rede
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+5.4"
>pfsync(4)</a> expõe certas alterações feitas na tabela de estados do
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+5.4"
>pf(4)</a>.
Ao monitorar esse dispositivo usando o
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tcpdump&amp;sektion=8"
>tcpdump(8)</a>, alterações na tabela de estados podem ser observadas
em tempo real.
Além disso, a interface pfsync(4) pode enviar essas mensagens de
alterações de estados para a rede, de modo que outros nós executando o
PF possam mesclar as alterações em suas próprias tabelas de estados.
Da mesma forma, o pfsync(4) também pode ouvir a rede por mensagens
que chegam.


<a name="pfsyncop"></a>
<h2>Funcionamento do pfsync</h2>
Por padrão, o pfsync(4) não envia ou recebe atualizações da
tabela de estados na rede; entretanto, atualizações ainda podem ser
monitoradas usando o tcpdump(8) ou outras ferramentas na máquina local.

<p>
Quando o pfsync(4) está configurado para enviar e receber
atualizações na rede, o comportamento padrão é enviar atualizações
"multicast" na rede local.
Todas as atualizações são enviadas sem autenticação.
A prática mais comum é:

<ol>
<li>Conectar os dois nós que trocarão atualizações com um
    cabo cruzado e usar a interface como o <tt>syncdev</tt>
    (veja <a href="#pfsyncconfig">abaixo</a>).
<li>Usar a opção <tt>syncpeer</tt> do ifconfig(8) (veja
    <a href="#pfsyncconfig">abaixo</a>), assim as atualizações são
    direcionadas com "unicast" para o nó, e então configurar o
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ipsec&amp;sektion=4"
    >ipsec(4)</a> entre as máquinas para proteger o tráfego pfsync(4).
</ol>

<p>
Quando as atualizações estão sendo enviadas e recebidas na rede, os
pacotes pfsync devem ser aceitos no conjunto de regras de filtragem.

<blockquote>
<tt>
pass on $sync_if proto pfsync
</tt>
</blockquote>

<p>
<tt>$sync_if</tt> deve ser a interface física por onde o pfsync(4) se
comunica.


<a name="pfsyncconfig"></a>
<h2>Configuração do pfsync</h2>
Visto que pfsync(4) é uma interface de rede virtual, ela é configurada
usando o
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8"
>ifconfig(8)</a>.

<blockquote>
<tt>
ifconfig <i>pfsyncN</i> syncdev <i>syncdev</i> [syncpeer
<i>syncpeer</i>] [defer|-defer]
</tt>
</blockquote>

<dl>
<dt><tt><i>pfsyncN</i></tt>
<dd>O nome da interface pfsync(4). A <tt>pfsync0</tt> existe
por padrão quando estiver usando o kernel <tt>GENERIC</tt>.

<dt><tt><i>syncdev</i></tt>
<dd>O nome da interface física usada para enviar atualizações pfsync.

<dt><tt><i>syncpeer</i></tt>
<dd>Esse parâmetro opcional especifica o endereço IP de uma máquina para
trocar atualizações pfsync.
Por padrão as atualizações pfsync são "multicast" na rede local.
Essa opção cancela esse comportamento e, em vez disso, envia
atualizações "unicasts" para o <tt><i>syncpeer</i></tt> especificado.

<dt><tt><i>defer</i></tt>
<dd>Se a flag de <tt>defer</tt> for usada, o pacote inicial de uma nova
conexão que passe através da firewall não será transmitido
até que outro sistema com pfsync(4) reconheça sua adição na 
tabela de estados ou o tempo limite expire.
Isto adiciona pequenos atrasos, mas permite ao tráfego fluir quando mais de
um firewall pode estar, ativamente, manipulando pacotes ("ativo/ativo").
Por exemplo, em certos cenários e configurações com ospfd(8), bgpd(8) ou carp(4).

</dl>


<a name="pfsyncex"></a>
<h2>Exemplo de configuração do pfsync</h2>
Este é um exemplo de configuração do pfsync.

<blockquote>
<tt>
# ifconfig pfsync0 syncdev em1 up<br>
</tt>
</blockquote>

Isso habilita o pfsync na interface <tt>em1</tt>.
As atualizações enviadas serão "multicast" na rede, permitindo que
qualquer outra máquina executando o pfsync possa recebê-las.


<a name="failover"></a>
<h2>Combinando CARP e pfsync Para Failover</h2>
Ao combinar os recursos do CARP e do pfsync, um grupo de dois ou
mais firewalls pode ser usado para criar um cluster de firewalls
completamente redundante e de alta disponibilidade.

<dl>
<dt>CARP:
<dd>Trata o failover automático de um firewall para outro.

<dt>pfsync:
<dd>Sincroniza a tabela de estados entre todos os firewalls.
Caso aconteça um failover, o tráfego pode fluir ininterrupto
através do novo firewall mestre.
</dl>

<p>
Um cenário de exemplo.
Dois firewalls, <tt>fw1</tt> e <tt>fw2</tt>.

<pre>
         +----| WAN/Internet |----+
         |                        |
      em2|                        |em2
      +-----+                  +-----+
      | fw1 |-em1----------em1-| fw2 |
      +-----+                  +-----+
      em0|                        |em0
         |                        |
      ---+----LAN Compartilhada---+---
</pre>

<p>
Os firewalls estão conectados diretamente com um cabo cruzado
em <tt>em1</tt>.
Ambos estão conectados à LAN em <tt>em0</tt> e a uma conexão
WAN/Internet em <tt>em2</tt>.
Os endereços IP são os seguintes:

<ul>
<li>fw1 em0: 172.16.0.1
<li>fw1 em1: 10.10.10.1
<li>fw1 em2: 192.0.2.1
<li>fw2 em0: 172.16.0.2
<li>fw2 em1: 10.10.10.2
<li>fw2 em2: 192.0.2.2
<li>IP compartilhado da LAN: 172.16.0.100
<li>IP compartilhado da WAN/Internet: 192.0.2.100
</ul>

<p>
A política de rede é que <tt>fw1</tt> será o mestre preferido.

<p>
Configuração do fw1:

<table border=0 width="650">
<tr><td nowrap bgcolor="#EEEEEE">
<pre>
! Habilita a função de tomar o lugar e o failover de interface de grupo
# sysctl -w net.inet.carp.preempt=1

! Configura o pfsync
# ifconfig em1 10.10.10.1 netmask 255.255.255.0
# ifconfig pfsync0 syncdev em1
# ifconfig pfsync0 up

! Configura o CARP no lado LAN
# ifconfig carp1 create
# ifconfig carp1 vhid 1 carpdev em0 pass lanpasswd \
     172.16.0.100 netmask 255.255.255.0

! Configura o CARP no lado WAN/Internet
# ifconfig carp2 create
# ifconfig carp2 vhid 2 carpdev em2 pass netpasswd \
    192.0.2.100 netmask 255.255.255.0
</pre>
</td></tr>
</table>

<p>
Configuração do fw2:

<table border=0 width="650">
<tr><td nowrap bgcolor="#EEEEEE">
<pre>
! Habilita a função de tomar o lugar e o failover de interface de grupo
# sysctl -w net.inet.carp.preempt=1

! Configura o pfsync
# ifconfig em1 10.10.10.2 netmask 255.255.255.0
# ifconfig pfsync0 syncdev em1
# ifconfig pfsync0 up

! Configura o CARP no lado LAN
# ifconfig carp1 create
# ifconfig carp1 vhid 1 carpdev em0 pass lanpasswd \
     advskew 128 172.16.0.100 netmask 255.255.255.0

! Configura o CARP no lado WAN/Internet
# ifconfig carp2 create
# ifconfig carp2 vhid 2 carpdev em2 pass netpasswd \
    advskew 128 192.0.2.100 netmask 255.255.255.0
</pre>
</td></tr>
</table>


<a name="ops"></a>
<h2>Problemas Operacionais</h2>
Alguns problemas operacionais comuns encontrados com CARP/pfsync.

<a name="bootconfig"></a>
<h3>Configuração do CARP e pfsync Durante a Inicialização</h3>
Visto que carp(4) e pfsync(4) são ambos tipos de interfaces de rede,
elas podem ser configuradas durante a inicialização criando-se um
arquivo
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=hostname.if&amp;sektion=5"
>hostname.if(5)</a>.
O script de inicialização
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=netstart&amp;sektion=8"
>netstart</a> cuidará de criar as interfaces e configurá-las.

<p>
Exemplos:

<dl>
<dt>/etc/hostname.carp1</dt>
<dd>
inet 172.16.0.100 255.255.255.0 172.16.0.255 vhid 1 carpdev em0 \<br>
&nbsp;&nbsp;&nbsp;&nbsp;pass lanpasswd
</dd>
</dl>

<dl>
<dt>/etc/hostname.pfsync0</dt>
<dd>
up syncdev em1
</dd>
</dl>

<a name="forcefail"></a>
<h3>Forçando "Failover" do Mestre</h3>
De tempos em tempos é necessário fazer o "failover" ou derrubar o nó
mestre de propósito.
Exemplos incluem derrubar o nó mestre para manutenção ou quando estiver
resolvendo um problema.
O objetivo aqui é elegantemente passar ("fail over") o tráfego para uma
das máquinas backups de modo que os usuários não observem nenhum
impacto.

<p>
Para failover de um grupo CARP em particular, derrube a interface
carp(4) no nó mestre.
Isso faz com que o mestre anuncie a si mesmo com um
<tt>advbase</tt> e <tt>advskew</tt> "infinito".
A(s) máquina(s) backup vê(eem) isso e imediatamente toma(m) o
lugar da máquina mestre.

<blockquote>
<tt>
# ifconfig carp1 down
</tt>
</blockquote>

<p>
Uma alternativa é aumentar o <tt>advskew</tt> para um valor mais alto
que o <tt>advskew</tt> na(s) máquina(s) backup.
Isso causa um failover, mas ainda permite ao mestre participar
no grupo CARP.


<a name="demote"></a>
<p>
Um outro método para failover é ajustar o contador demotion do CARP.
O contador demotion é uma medida de como "pronta" uma máquina
está para se tornar o mestre do grupo CARP.
Por exemplo, enquanto uma máquina está no meio do processo de
inicialização é uma má ideia para ela tornar-se um mestre CARP até que
todas as interfaces estejam configuradas, todos os serviços de rede
estejam iniciados, etc.
Máquinas anunciando um valor demotion alto terão menos preferência como
mestre.

<p>
Um contador demotion é armazenado em cada grupo de interfaces que a
interface CARP pertence.
Por padrão, todas as interfaces CARP são membros do grupo de interfaces
"carp".
O valor atual de um contador demotion pode ser visto usando o
ifconfig(8):

<blockquote>
<tt>
# ifconfig -g carp<br>
carp: carp demote count 0
</tt>
</blockquote>

<p>
Nesse exemplo o contador associado com o grupo de interface "carp"
é mostrado.
Quando uma máquina CARP anuncia a si mesma na rede, ela pega a soma dos
contadores demotion para cada grupo de interfaces que a interface
carp(4) pertence e anuncia esse valor como seu valor demotion.

<p>
Agora assuma o seguinte exemplo.
Dois firewalls executando CARP com as seguintes interfaces CARP:

<ul>
<li>carp1 -- Departamento de Contabilidade
<li>carp2 -- Empregados Comuns
<li>carp3 -- Internet
<li>carp4 -- DMZ
</ul>

<p>
O objetivo é apenas fazer failover dos grupos carp1 e carp2 para
o firewall secundário.

<p>
Primeiro, associe cada grupo a um novo grupo de interfaces, neste caso
nomeado como "internal":

<blockquote>
<tt>
# ifconfig carp1 group internal<br>
# ifconfig carp2 group internal<br>
# ifconfig internal<br>
carp1: flags=8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;carp: MASTER carpdev em0 vhid 1 advbase 1
advskew 100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;groups: carp internal<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inet 10.0.0.1 netmask 0xffffff00 broadcast
10.0.0.255<br>
carp2: flags=8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;carp: MASTER carpdev em1 vhid 2 advbase 1
advskew 100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;groups: carp internal<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inet 10.0.1.1 netmask 0xffffff00 broadcast
10.0.1.255
</tt>
</blockquote>

<p>
Agora aumente o contador demotion para o grupo "internal" usando o
ifconfig(8):

<blockquote>
<tt>
# ifconfig -g internal<br>
internal: carp demote count 0<br>
# ifconfig -g internal carpdemote 50<br>
# ifconfig -g internal<br>
internal: carp demote count 50<br>
</tt>
</blockquote>

<p>
O firewall agora faz elegantemente o failover nos grupos carp1 e carp2
para o outro firewall no cluster, enquanto ainda se mantém como mestre
nos grupos carp3 e carp4.
Se o outro firewall começar a anunciar um valor demotion maior
do que 50 ou se parar de anunciar completamente, então esse firewall
tomaria novamente a liderança do mestre nos grupos carp1 e carp2.

<p>
Para voltar (fail back) para o firewall primário, reverta as mudanças:

<blockquote>
<tt>
# ifconfig -g internal -carpdemote 50<br>
# ifconfig -g internal<br>
internal: carp demote count 0<br>
</tt>
</blockquote>

<p>
Daemons de rede como
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bgpd&amp;sektion=8"
>OpenBGPD</a> e
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sasyncd&amp;sektion=8"
>sasyncd(8)</a>
fazem uso do contador demotion para garantir que o firewall não
se torne mestre até que as sessões BGP estejam estabelecidas e SAs
IPsec estejam sincronizados.

<a name="RulesetTips"></a>
<h3>Dicas de Conjunto de Regras</h3>
<b>Filtre a interface física.</b>
Até o ponto que o PF está preocupado, o tráfego da rede vem da
interface física, não da interface virtual CARP (ou seja,
<tt>carp0</tt>).
Assim, escreva seu conjunto de regras de acordo.
Não se esqueça de que um nome de interface em uma regra do PF pode
ser tanto o nome da interface física ou um endereço associado a
essa interface. Por exemplo, esta regra pode estar correta:
<blockquote><tt>
pass in on fxp0 inet proto tcp from any to carp0 port 22
</tt></blockquote>
mas substituir o <tt>fxp0</tt> por <tt>carp0</tt> não
funcionaria como você deseja.

<p>
<b>NÃO se esqueça</b> de uma regra de permissão de tráfego para
<tt>proto carp</tt> e <tt>proto pfsync</tt>!

<p>

<a name="ref"></a>
<h2>Outras Referências</h2>
Por favor veja estas outras fontes para obter mais informações:

<ul>
<li>
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+5.4"
    >carp(4)</a>
<li>
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+5.4"
    >pfsync(4)</a>
<li>
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8"
    >ifconfig(8)</a>
<li>
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=hostname.if&amp;sektion=5"
    >hostname.if(5)</a>
<li>
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+5.4"
    >pf.conf(5)</a>
<li>
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifstated&amp;sektion=8"
    >ifstated(8)</a>
<li>
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifstated.conf&amp;sektion=5"
    >ifstated.conf(5)</a>
</ul>


<p>
[<a href="authpf.html">Anterior: Shell de Usuário para
Gateways de Autenticação</a>]
[<a href="index.html">Conteúdo</a>]
[<a href="example1.html">Próximo: Firewall para Casa ou Pequeno Escritório</a>]

<p>
<hr>
<a href="index.html"><img height="24" width="24" src="../../../images/back.gif" border="0" alt="[voltar]"></a>
<a href="mailto:www@@openbsd.org">www@@openbsd.org</a>
<br>
<small>
<!--
Originally [OpenBSD: carp.html,v 1.35 ]<br>
$Translation: carp.html,v 1.17 2013/12/01 12:44:32 egypcio Exp $<br>
-->
$OpenBSD: carp.html,v 1.17 2013/12/06 20:52:46 ajacoutot Exp $
</small>

</body>
</html>
@


1.17
log
@Sync with Steelix CVS
@
text
@d768 1
a768 1
$OpenBSD$
@


1.16
log
@Sync with Steelix CVS
@
text
@d148 1
a148 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+5.3"
d303 1
a303 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+5.3"
d305 1
a305 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+5.3"
d729 1
a729 1
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+5.3"
d732 1
a732 1
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+5.3"
d741 1
a741 1
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+5.3"
d765 2
a766 2
Originally [OpenBSD: carp.html,v 1.34 ]<br>
$Translation: carp.html,v 1.16 2013/05/02 22:48:46 renato Exp $<br>
@


1.15
log
@Sync with Steelix CVS
@
text
@d148 1
a148 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+5.2"
d303 1
a303 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+5.2"
d305 1
a305 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+5.2"
d729 1
a729 1
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+5.2"
d732 1
a732 1
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+5.2"
d741 1
a741 1
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+5.2"
d765 2
a766 2
Originally [OpenBSD: carp.html,v 1.33 ]<br>
$Translation: carp.html,v 1.15 2013/01/13 17:38:21 egypcio Exp $<br>
@


1.14
log
@Sync with Steelix CVS
@
text
@d148 1
a148 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.6"
d160 2
a161 2
[state <i>estado</i>] <i>endereço_ip</i> \<br>
&nbsp;&nbsp;&nbsp;netmask <i>máscara</i>
d164 1
d172 3
a174 2
<dd>O ID de Máquina Virtual. Esse é um número único que é usado para
identificar o grupo de redundância para outros nós na rede.
d176 1
d209 8
d240 7
a246 8
melhores <tt>advbase</tt> e <tt>advskew</tt> tomarem o lugar
do mestre.
Adicionalmente, essa opção habilita "failing over" em todas as
interfaces caso uma interface caia.
Se uma interface física CARP cair, o CARP muda o <tt>advskew</tt>
para 240 em todas as outras interfaces CARP, em essência o "failing"
termina por si mesmo.
Essa opção por padrão é 0 (desabilitada).
d249 3
a251 9
<dd>Registra pacotes CARP ruins. O padrão é 0 (desabilitado).

<dt><tt>net.inet.carp.arpbalance</tt>
<dd>Carrega o balanceamento de tráfego entre múltiplas máquinas de
grupos de redundância.
O padrão é 0 (desabilitado).
Veja
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.6"
>carp(4)</a> para obter mais informações.
d303 1
a303 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+4.6"
d305 1
a305 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+4.6"
d367 1
a367 1
<i>syncpeer</i>]
d385 10
d404 1
a404 1
# ifconfig pfsync0 syncdev em1<br>
d584 2
d729 1
a729 1
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.6"
d732 1
a732 1
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+4.6"
d741 1
a741 1
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+4.6"
d765 2
a766 2
Originally [OpenBSD: carp.html,v 1.24 ]<br>
$Translation: carp.html,v 1.14 2009/10/18 16:52:52 alan Exp $<br>
@


1.13
log
@Sync with Steelix CVS
@
text
@d81 1
a81 1
(VRRP, "Virtual Router Redundancy Protocol")
d84 1
a84 1
(HSRP, "Hot Standby Router Protocol").
d120 1
a120 1
Anúncios CARP contêm o ID de Máquina Virtual (VHID, "Virtual Host ID")
d148 1
a148 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.5"
d246 1
a246 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.5"
d299 1
a299 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+4.5"
d301 1
a301 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+4.5"
d713 1
a713 1
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.5"
d716 1
a716 1
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+4.5"
d725 1
a725 1
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+4.5"
d749 2
a750 2
Originally [OpenBSD: carp.html,v 1.23 ]<br>
$Translation: carp.html,v 1.13 2009/10/13 19:12:27 alan Exp $<br>
@


1.12
log
@Sync with Steelix CVS
@
text
@d38 2
a39 2
[<a href="authpf.html">Anterior: Shell de Usuário para Autenticação
em Gateways</a>]
d53 2
a54 2
<li><a href="#carpconfig">Configurando o CARP</a>
<li><a href="#carpex">Exemplo de configuração CARP</a>
d57 2
a58 2
<li><a href="#pfsyncconfig">Configurando o pfsync</a>
<li><a href="#pfsyncex">Exemplo de configuração pfsync</a>
d63 4
a66 4
	<li><a href="#bootconfig">Configurando o CARP e pfsync Durante
            o Boot</a>
	<li><a href="#forcefail">Forçando "Failover" do Master</a>
	<li><a href="#RulesetTips">Dicas de Regras</a>
d75 3
a77 3
CARP é o Protocolo de Redundância de Endereço Comum (Common Address
Redundancy Protocol).
Seu objetivo principal é permitir que múltiplos hosts no mesmo
d80 5
a84 4
<a href="http://www.ietf.org/rfc/rfc3768.txt">Virtual Router Redundancy
Protocol</a> (VRRP) e ao
<a href="http://www.ietf.org/rfc/rfc2281.txt">Hot Standby Router
Protocol</a> (HSRP).
d87 3
a89 3
CARP funciona permitindo a um grupo de hosts no mesmo segmento de rede
compartilhar um endereço IP.
Esse grupo de hosts é referido como um "grupo de redundância".
d92 1
a92 1
Dentro do grupo, um host é designado o "master" e o resto como
d94 1
a94 1
O host "master" é o que atualmente "segura" o IP compartilhado; ele
d96 1
a96 1
Cada host pode pertencer a mais que um grupo de redundância por vez.
d101 2
a102 2
máquinas clientes como o gateway padrão (default).
Caso o firewall master sofra uma falha ou seja desligado, o IP se moverá
d111 6
a116 6
O host master no grupo envia regularmente anúncios à rede local,
assim os hosts backup sabem que ele ainda está ativo.
Se os hosts backup não ouvirem um anúncio do master por um período de
tempo, então um deles tomará conta dos deveres do master (qualquer host
backup que tenha configurado os valores para <tt>advbase</tt> e
<tt>advskew</tt> baixos).
d120 3
a122 2
Anúncios CARP contém o Virtual Host ID que permite aos membros do grupo
identificar que grupo de redundância pertencem.
d126 1
a126 1
(spoofing) anúncios CARP, cada grupo pode ser configurado com uma senha.
d140 2
a141 2
<tt>$carp_dev</tt> deve ser a interface física que o CARP está se
comunicando.
d145 1
a145 1
<h2>Configurando o CARP</h2>
d149 1
a149 1
>carp(4)</a>. Assim, o CARP é configurado usando o
d160 1
a160 1
[state <i>estado</i>] <i>endereço-ip</i> \<br>
d167 1
a167 1
<dd>O nome da interface virtual carp(4) onde <i>N</i> é um
d171 2
a172 2
<dd>O Virtual Host ID. Esse é um número único que é usado para
identificar o grupo de redundância de outros nós na rede.
d176 2
a177 2
<dd>A senha de autenticação para usar quando estiver conversando com
outros hosts CARP nesse grupo de redundância.
d183 3
a185 3
Por padrão, o CARP tentará determinar qual interface usar procurando
pela interface física que está na mesma subrede da combinação
<i>endereço-ip</i> e <i>máscara</i> dada à interface carp(4).
d194 5
a198 5
<dd>Esse parâmetro opcional especifica quanto desviar o
<tt><i>advbase</i></tt> quando estiver enviando anúncios CARP.
Manipulando o <tt><i>advskew</i></tt>, o host CARP master pode ser
escolhido. Quanto mais alto o número, <i>menos</i> preferido
será o host quando estiver escolhendo um master.
d206 4
a209 3
<dt><tt><i>endereço-ip</i></tt>
<dd>Esse é o endereço IP atribuído ao grupo de redundância.
Esse endereço não tem que estar na mesma subrede que o endereço IP na
d211 2
a212 1
Esse endereço, contudo, precisa ser o mesmo em todos os hosts no grupo.
d215 1
a215 1
<dd>A máscara de subrede do IP compartilhado.
d219 1
a219 1
Além disso, comportamentos CARP podem ser controlados via
d225 1
a225 1
<dd>Aceita entrada de pacotes CARP ou não. Padrão é 1 (sim).
d228 3
a230 3
<dd>Permite a hosts dentro de um grupo de redundância que tenham um
melhor <tt>advbase</tt> e <tt>advskew</tt> tomar o lugar (preempt)
do master.
d232 2
a233 2
interfaces caso uma interface caia (down).
Se uma interface física CARP cair, o CARP trocará o <tt>advskew</tt>
d236 1
a236 1
Essa opção é 0 (desabilitada) por padrão.
d239 1
a239 1
<dd>Loga pacotes CARP. O padrão é 0 (desabilitado).
d242 2
a243 2
<dd>Carrega balanceamento de tráfego entre múltiplos hosts no
grupo de redundância.
d247 1
a247 1
>carp(4)</a> para mais informações.
d252 2
a253 2
<h2>Exemplo de configuração CARP</h2>
Aqui tem um exemplo de configuração do CARP.
d267 1
a267 1
<li>Habilita o recebimento de pacotes CARP (isto é, a configuração
d270 5
a274 4
<li>Configura <tt>carp1</tt> para o virtual host #1, habilita uma senha,
    configura <tt>em0</tt> como a interface pertencente ao grupo, e faz
    desse host um backup devido ao <tt>advskew</tt> de <tt>100</tt>
    (assumindo, é claro, que o master seja configurado com um
d280 1
a280 1
Rodar o <tt>ifconfig</tt> na <tt>carp1</tt> mostra o status da
d300 1
a300 2
>pfsync(4)</a> expõe certas alterações feitas na tabela
de estados do
d303 1
a303 1
Monitorando esse dispositivo usando
d308 2
a309 2
alterações de estado para a rede de modo que outros nós rodando PF
possam unir as alterações em suas próprias tabelas de estado.
d316 3
a318 3
Por padrão, o pfsync(4) não envia ou recebe atualizações da tabela de
estados na rede; entretanto, atualizações ainda podem ser monitoradas
usando o tcpdump(8) ou outras ferramentas na máquina local.
d323 1
a323 1
multicast na rede local.
d325 1
a325 1
Prática mais comum é:
d328 3
a330 3
<li>Conectar os dois nós que estarão trocando atualizações usando um
    cabo crossover e usar a interface como <tt>syncdev</tt> (veja
    <a href="#pfsyncconfig">abaixo</a>).
d332 2
a333 2
    <a href="#pfsyncconfig">abaixo</a>), assim atualizações são
    direcionadas com unicast para o nó, então configure o
d335 1
a335 1
    >ipsec(4)</a> entre os hosts para proteger o tráfego pfsync(4).
d340 1
a340 1
pacotes pfsync devem ser aceitos nas regras de filtragem.
d349 2
a350 2
<tt>$sync_if</tt> deve ser a interface física que o pfsync(4) está se
comunicando.
d354 2
a355 2
<h2>Configurando o pfsync</h2>
Visto que o pfsync(4) é uma interface de rede virtual, é configurado
d376 1
a376 1
<dd>Esse parâmetro opcional especifica o endereço IP de um host para
d378 3
a380 3
Por padrão as atualizações pfsync são multicast na rede local.
Essa opção cancela esse comportamento e em vez disso envia atualizações
unicasts para o <tt><i>syncpeer</i></tt> especificado.
d385 2
a386 2
<h2>Exemplo de configuração pfsync</h2>
Aqui tem um exemplo de configuração do pfsync.
d395 2
a396 2
As atualizações enviadas serão multicast na rede, permitindo que
qualquer outro host rodando pfsync possa recebê-las.
d401 1
a401 1
Combinando as características do CARP e pfsync, um grupo de dois ou
d403 1
a403 1
completamente redundante e com alta disponibilidade.
d412 1
a412 1
através do novo firewall master.
d428 1
a428 1
      ---+-------Shared LAN-------+---
d432 1
a432 1
Os firewalls estão conectados diretamente usando um cabo crossover
d434 1
a434 1
Ambos estão conectados a LAN em <tt>em0</tt> e a uma conexão
d436 1
a436 1
Os endereços IP são como seguem:
d445 2
a446 2
<li>LAN shared IP: 172.16.0.100
<li>WAN/Internet shared IP: 192.0.2.100
d450 1
a450 1
A política de rede é que <tt>fw1</tt> será o master preferido.
d458 1
a458 1
! Habilita preemption e o grupo de interfaces failover
d461 1
a461 1
! Configura pfsync
d466 1
a466 1
! Configura CARP no lado LAN
d471 1
a471 1
! Configura CARP no lado WAN/Internet
d485 1
a485 1
! Habilita preemption e o grupo de interfaces failover
d488 1
a488 1
! Configura pfsync
d493 1
a493 1
! Configura CARP no lado LAN
d498 1
a498 1
! Configura CARP no lado WAN/Internet
d512 1
a512 1
<h3>Configurando o CARP e pfsync Durante o Boot</h3>
d514 1
a514 1
eles podem ser configurados durante a inicialização criando-se um
d541 4
a544 4
<h3>Forçando Failover do Master</h3>
De tempos em tempos, é necessário failover ou derrubar o nó master
de propósito.
Exemplos incluem derrubar o nó master para manutenção ou quando estiver
d546 3
a548 2
O objetivo aqui é elegantemente passar (fail over) o tráfego para um
dos hosts backups de modo que os usuários não observem nenhum impacto.
d552 2
a553 2
carp(4) no nó master.
Isso fará o master anunciar a si mesmo com um
d555 2
a556 2
O(s) host(s) backup verá(ão) isso e imediatamente tomará(ão) o
lugar do master.
d566 2
a567 2
que o <tt>advskew</tt> no(s) host(s) backup.
Isso causará failover, mas ainda permite ao master participar
d571 9
a579 9
Um outro método para failover é ajustar o contador CARP demotion.
O contador demotion é uma medida de como "pronto" um host
está para se tornar o master do grupo CARP.
Por exemplo, enquanto um host está no meio do processo de boot é
uma má idéia para ele se tornar um master CARP até que todas as
interfaces estejam configuradas, todos os serviços de rede estejam
iniciados, etc.
Hosts anunciando um valor demotion alto terão menos preferência como
master.
d582 1
a582 1
Um contador demotion é armazenado em cada grupo de interface que a
d584 1
a584 1
Por padrão, todas as interfaces CARP são membros do grupo de interface
d599 2
a600 2
Quando um host CARP anuncia a si mesmo na rede, ele pega a soma dos
contadores demotion para cada grupo de interface que a interface
d605 1
a605 1
Dois firewalls rodando CARP com as seguintes interfaces CARP:
d609 1
a609 1
<li>carp2 -- Empregados Regulares
d619 2
a620 2
Primeiro, associe cada grupo a um novo grupo de interface, neste caso
chamado "internal":
d657 2
a658 2
O firewall fará elegantemente o failover nos grupos carp1 e carp2
para o outro firewall no cluster, enquanto ainda se mantém como master
d661 2
a662 3
do que 50 ou se parar de anunciar completamente, então esse
firewall fará novamente o takeover do master nos grupos carp1 e
carp2.
d665 1
a665 2
Para voltar (fail back) para o firewall primário, reverta
as mudanças:
d676 1
a676 1
Serviços de rede como
d682 1
a682 1
se torne master até que as sessões BGP estejam estabelecidas e SAs
d686 1
a686 1
<h3>Dicas de Regras</h3>
d692 1
a692 1
Não se esqueça de que um nome de uma interface em uma regra do PF pode
d694 1
a694 1
essa interface. Por exemplo, esta regra poderia estar correta:
d698 1
a698 1
mas substituindo o <tt>fxp0</tt> por <tt>carp0</tt> não
d702 2
a703 2
<b>NÃO se esqueça</b> de uma regra pass para <tt>proto carp</tt>
e <tt>proto pfsync</tt>!
d709 1
a709 1
Por favor veja estas outras fontes para mais informação:
d737 2
a738 2
[<a href="authpf.html">Anterior: Shell de Usuário para Autenticação
em Gateways</a>]
d750 1
a750 1
$Translation: carp.html,v 1.12 2009/05/10 17:44:16 alan Exp $<br>
@


1.11
log
@Sync with Steelix CVS
@
text
@d146 1
a146 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.4"
d166 1
a166 1
inteiro que representa o número da interface (ex., carp10).
d242 1
a242 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.4"
d294 1
a294 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+4.4"
d297 1
a297 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+4.4"
d686 2
a687 1
interface física, não da interface virtual CARP (i.e., <tt>carp0</tt>).
d710 1
a710 1
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.4"
d713 1
a713 1
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+4.4"
d722 1
a722 1
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+4.4"
d746 2
a747 2
Originally [OpenBSD: carp.html,v 1.22 ]<br>
$Translation: carp.html,v 1.11 2009/03/11 00:52:55 dsantos Exp $<br>
@


1.10
log
@Sync with Steelix CVS
@
text
@d4 1
a4 1
<title>PF: Redund&acirc;ncia de Firewall com CARP e pfsync</title>
d34 1
a34 1
<a href="../../pt/index.html">
d38 4
a41 4
[<a href="authpf.html">Anterior: Shell de Usu&aacute;rio para
Atutentica&ccedil;&atilde;o em Gateways</a>]
[<a href="index.html">Conte&uacute;do</a>]
[<a href="example1.html">Pr&oacute;ximo: Firewall para Casa ou Pequeno Escrit&oacute;rio</a>]
d44 2
a45 1
<h1><font color="#e00000">PF: Redund&acirc;ncia de Firewall com CARP e pfsync</font></h1>
d49 1
a49 1
<h3>Conte&uacute;do</h3>
d51 2
a52 2
<li><a href="#carpintro">Introdu&ccedil;&atilde;o ao CARP</a>
<li><a href="#carpop">Opera&ccedil;&atilde;o do CARP</a>
d54 3
a56 3
<li><a href="#carpex">Exemplo do CARP</a>
<li><a href="#pfsyncintro">Introdu&ccedil;&atilde;o ao pfsync</a>
<li><a href="#pfsyncop">Opera&ccedil;&atilde;o do pfsync</a>
d58 4
a61 4
<li><a href="#pfsyncex">Exemplo de pfsync</a>
<li><a href="#failover">Combinando CARP e pfsync para failover e
Redund&acirc;ncia</a>
<li><a href="#ops">Assuntos Operacionais</a>
d63 3
a65 2
	<li><a href="#bootconfig">Configurando o CARP e pfsync Durante o Boot</a>
	<li><a href="#forcefail">For&ccedil;ando Failover do Master</a>
d68 1
a68 1
<li><a href="#ref">Outras Refer&ecirc;ncias</a>
d74 6
a79 6
<h2>Introdu&ccedil;&atilde;o ao CARP</h2>
CARP &eacute; o Protocolo de Redund&acirc;ncia de Endere&ccedil;o Comum 
(Common Address Redundancy Protocol).
Seu objetivo principal &eacute; permitir que m&uacute;ltiplos hosts no mesmo
segmento de rede compartilhem um endere&ccedil;o IP.
CARP &eacute; uma alternativa livre e segura ao
d81 1
a81 1
Protocol</a> (VRRP) e ao 
d86 6
a91 6
CARP funciona permitindo um grupo de hosts no mesmo segmento de rede
compartilhar um endere&ccedil;o IP.
Este grupo de hosts &eacute; referido como um "grupo de redund&acirc;ncia".
O grupo de redund&acirc;ncia &eacute; atribu&iacute;do a um endere&ccedil;o IP
que &eacute; compartilhado entre os membros do grupo.
Dentro do grupo, um host &eacute; designado o "master" e o resto como
d93 3
a95 5
O host master &eacute; o que atualmente "segura" o IP compartilhado;
ele responde a qualquer tr&aacute;fego ou requisi&ccedil;&otilde;es ARP 
direcionadas para ele.
Cada host pode pertencer a mais que um grupo de redund&acirc;ncia por
vez.
d98 5
a102 7
Um uso comum para o CARP &eacute; criar um grupo de firewalls redundantes. 
O IP virtual que &eacute; atribu&iacute;do ao grupo de redund&acirc;ncia
&eacute; configurado nas m&aacute;quinas clientes como o gateway padr&atilde;o
(default).
Caso o firewall sofra uma falha ou seja desligado, o IP se mover&aacute;
para um dos firewalls backup e o servi&ccedil;o vai continuar sem ser
afetado.
d107 1
d109 17
a125 20
<h2>Opera&ccedil;&atilde;o do CARP</h2>
O host master no grupo envia regularmente an&uacute;ncios &agrave; rede local
assim os hosts backup sabem que ele ainda est&aacute; ativo.
Se os hosts backup n&atilde;o ouvirem um an&uacute;ncio do master por
um per&iacute;odo de tempo, ent&atilde;o um deles tomar&aacute; conta
dos deveres do master (qualquer host backup que tenha configurado os
valores <tt>advbase</tt> e <tt>advskew</tt> baixos). 

<p>
&Eacute; poss&iacute;vel m&uacute;ltiplos grupos CARP existir no
mesmo segmento de rede.
Os an&uacute;ncios CARP cont&eacute;m o Virtual Host ID, que permite aos
membros do grupo identificar qual grupo de redund&acirc;ncia pertence.

<p>
Para prevenir que um usu&aacute;rio malicioso no segmento de rede
falsifique (spoofing) an&uacute;ncios CARP, cada grupo pode ser configurado
com uma senha.
Cada pacote CARP enviado ao grupo &eacute; ent&atilde;o protegido
por um HMAC SHA1.
d128 2
a129 2
Como o CARP &eacute; seu pr&oacute;prio protocolo ele deve ter uma
regra permitida explicitamente nas regras de filtragem:
d138 3
a140 2
<tt>$carp_dev</tt> deve ser a interface f&iacute;sica que o CARP est&aacute;
se comunicando.
d144 1
a144 1
Cada grupo de redund&acirc;ncia &eacute; representado por uma interface
d146 3
a148 5
<a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.2"
>carp(4)</a>. Assim, o CARP &eacute; configurado usando 
<a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8"
d158 2
a159 2
[state <i>estado</i>] <i>endere&ccedil;o-ip</i> \<br>
&nbsp;&nbsp;&nbsp;netmask <i>m&aacute;scara</i>
d165 2
a166 2
<dd>O nome da interface virtual carp(4) onde <i>N</i> &eacute; um
inteiro que representa o n&uacute;mero da interface (ex., carp10).
d169 3
a171 4
<dd>O Virtual Host ID. Este &eacute; um n&uacute;mero &uacute;nico que 
&eacute; usado para identificar o grupo de redund&acirc;ncia de outros 
n&oacute;s na rede.
Valores aceitos s&atilde;o 1 &agrave; 255.
d174 2
a175 2
<dd>A senha de autentica&ccedil;&atilde;o para usar quando estiver
conversando com outros hosts CARP neste grupo de redund&acirc;ncia.
d179 5
a183 6
<dd>Este par&acirc;metro opcional especifica a interface de rede f&iacute;sica
que pertence a este grupo de redund&acirc;ncia.
Por padr&atilde;o, o CARP tentar&aacute; determinar qual interface usar
procurando pela interface f&iacute;sica que est&aacute; na mesma subrede da
combina&ccedil;&atilde;o <i>endere&ccedil;o-ip</i> e <i>m&aacute;scara</i> 
dada a interface carp(4).
d186 4
a189 4
<dd>Este par&acirc;metro opcional especifica com que frequ&ecirc;ncia,
em segundos, anunciar que somos um membro do grupo de redund&acirc;ncia.
O padr&atilde;o &eacute; 1 segundo.
Valores aceitos s&atilde;o 1 &agrave; 255.
d192 7
a198 7
<dd>Este par&acirc;metro opcional especifica quanto desviar o  
<tt><i>advbase</i></tt> quando estiver enviando an&uacute;ncios CARP.
Manipulando o <tt><i>advskew</i></tt>, o host CARP master pode ser 
escolhido. Quanto mais alto o n&uacute;mero, <i>menos</i> preferido 
ser&aacute; o host quando estiver escolhendo um master.
O padr&atilde;o &eacute; 0.
Valores aceitos s&atilde;o 0 &agrave; 254.
d201 1
a201 2
<dd>For&ccedil;a uma interface carp(4) em um certo estado. Estados
v&aacute;lidos s&atilde;o   
d204 5
a208 6
<dt><tt><i>endere&ccedil;o-ip</i></tt>
<dd>Este &eacute; o endere&ccedil;o IP atribu&iacute;do ao grupo de 
redund&acirc;ncia.
Este endere&ccedil;o n&atilde;o tem que estar na mesma subrede que o 
endere&ccedil;o IP na interface f&iacute;sica (se presente).
Este endere&ccedil;o, contudo, precisa ser o mesmo em todos os hosts no grupo.
d210 2
a211 2
<dt><tt><i>m&aacute;scara</i></tt>
<dd>A m&aacute;scara de subrede do IP compartilhado.
d215 2
a216 3
Al&eacute;m disso comportamentos CARP podem ser controlados via
<a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysctl&amp;sektion=8"
d221 1
a221 2
<dd>Aceita entrada de pacotes CARP ou n&atilde;o. Padr&atilde;o &eacute; 1
(sim).
d224 4
a227 3
<dd>Permite hosts dentro de um grupo de redund&acirc;ncia ter um melhor
<tt>advbase</tt> e <tt>advskew</tt> para tomar o lugar (preempt) do master.
Adicionalmente, esta op&ccedil;&atilde;o habilita failing over em todas as
d229 4
a232 4
Se uma interface f&iacute;sica CARP cair, o CARP trocar&aacute; o
<tt>advskew</tt> para 240 em todas as outras interfaces CARP, em
ess&ecirc;ncia o failing termina por si mesmo.
Esta op&ccedil;&atilde;o &eacute; 0 (desabilitada) por padr&atilde;o.
d235 1
a235 1
<dd>Loga pacotes CARP. O padr&atilde;o &eacute; 0 (desabilitado).
d238 3
a240 3
<dd>Carrega balanceamento de tr&aacute;fego entre m&uacute;ltiplos hosts no 
grupo de redund&acirc;ncia.
O padr&atilde;o &eacute; 0 (desabilitado).
d242 2
a243 3
<a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.2"
>carp(4)</a> para mais informa&ccedil;&otilde;es.
d246 1
d248 2
a249 2
<h2>Exemplo do CARP</h2>
Aqui tem um exemplo de configura&ccedil;&atilde;o do CARP.
d261 1
a261 1
Isto configura o seguinte:
d263 2
a264 2
<li>Habilita o recebimento de pacotes CARP (isto &eacute; a
configura&ccedil;&atilde;o padr&atilde;o).
d267 5
a271 6
configura <tt>em0</tt> como a interface pertencente ao grupo, e faz
este host um backup devido ao <tt>advskew</tt> de <tt>100</tt> (assumindo,
&eacute; claro, que o master seja configurado com um <tt>advskew</tt>
menor do que 100).
O IP compartilhado atribu&iacute;do a este grupo &eacute; 
10.0.0.1/255.255.255.0.
d275 2
a276 1
Rodando <tt>ifconfig</tt> na <tt>carp1</tt> mostra o status da interface.
d292 6
a297 8
<h2>Introdu&ccedil;&atilde;o ao pfsync</h2>
A interface de rede 
<a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+4.2"
>pfsync(4)</a> exp&otilde;e certas altera&ccedil;&otilde;es feitas na tabela 
de estados
<a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+4.2"
d299 9
a307 11
Monitorando este dispositivo usando
<a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=tcpdump&amp;sektion=8"
>tcpdump(8)</a>, altera&ccedil;&otilde;es na tabela de estados podem ser
observadas em tempo real.
Al&eacute;m disso, a interface pfsync(4) pode enviar estas mensagens de
altera&ccedil;&otilde;es de estado para a rede de modo que outros n&oacute;s
rodando PF possam unir as altera&ccedil;&otilde;es em suas pr&oacute;prias
tabelas de estado.
Da mesma forma, o pfsync(4) tamb&eacute;m pode ouvir a rede por
mensagens que chegam.
d311 4
a314 5
<h2>Opera&ccedil;&atilde;o do pfsync</h2>
Por padr&atilde;o, o pfsync(4) n&atilde;o envia ou recebe
atualiza&ccedil;&otilde;es da tabela de estados na rede; entretanto, 
atualiza&ccedil;&otilde;es ainda podem ser monitoradas usando o tcpdump(8) 
ou outras ferramentas na m&aacute;quina local.
d317 5
a321 6
Quando o pfsync(4) est&aacute; configurado para enviar e receber
atualiza&ccedil;&otilde;es na rede, o comportamento padr&atilde;o &eacute;
enviar atualiza&ccedil;&otilde;es multicast na rede local.
Todas as atualiza&ccedil;&otilde;es s&atilde;o enviadas sem
autentica&ccedil;&atilde;o.
Pr&aacute;tica mais comum &eacute;: 
d324 8
a331 12
<li>Conectar os dois n&oacute;s que estar&atilde;o trocando
atualiza&ccedil;&otilde;es usando um cabo crossover e usar
a interface como <tt>syncdev</tt> (veja 
<a href="#pfsyncconfig">abaixo</a>).
<li>Usar a op&ccedil;&atilde;o ifconfig(8) <tt>syncpeer</tt> (veja
<a href="#pfsyncconfig">abaixo</a>) assim atualiza&ccedil;&otilde;es 
s&atilde;o direcionadas com unicast para o n&oacute;, ent&atilde;o 
configure o 
<a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=ipsec&amp;sektion=4"
>ipsec(4)</a>
entre os hosts para proteger o tr&aacute;fego pfsync(4).
d335 2
a336 3
Quando as atualiza&ccedil;&otilde;es est&atilde;o sendo enviadas e 
recebidas na rede, os pacotes pfsync devem ser aceitos nas regras de 
filtragem.
d345 2
a346 2
<tt>$sync_if</tt> deve ser a interface f&iacute;sica que o pfsync(4)
esta se comunicando.
d351 4
a354 5
Visto que o pfsync(4) &eacute; uma interface de rede virtual, &eacute;
configurado usando 
<a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8"
>ifconfig(8)</a>. 
d365 2
a366 2
<dd>O nome da interface pfsync(4). <tt>pfsync0</tt> existe
por padr&atilde;o quando estiver usando o kernel <tt>GENERIC</tt>.
d369 1
a369 2
<dd>O nome da interface f&iacute;sica usada para enviar
atualiza&ccedil;&otilde;es pfsync.
d372 5
a376 7
<dd>Este par&acirc;metro opcional espec&iacute;fica o endere&ccedil;o 
IP de um host para trocar atualiza&ccedil;&otilde;es pfsync.
Por padr&atilde;o atualiza&ccedil;&otilde;es pfsync s&atilde;o 
multicast na rede local.
Esta op&ccedil;&atilde;o cancela este comportamento e em vez disso
envia atualiza&ccedil;&otilde;es unicasts para o <tt><i>syncpeer</i></tt>
especificado. 
d381 2
a382 2
<h2>Exemplo de pfsync</h2>
Aqui tem um exemplo de configura&ccedil;&atilde;o do pfsync.
d390 3
a392 3
Isto habilita o pfsync na interface <tt>em1</tt>.
Atualiza&ccedil;&otilde;es ser&atilde;o enviadas via multicast na rede, 
permitindo que qualquer outro host rodando pfsync receb&ecirc;-las.
d397 2
a398 2
Combinando as caracter&iacute;sticas do CARP e pfsync, um grupo
de dois ou mais firewalls podem ser usados para criar um cluster de firewall
d403 1
a403 1
<dd>Trata o failover autom&aacute;tico de um firewall para outro.
d407 2
a408 2
Caso aconte&ccedil;a um failover, o tr&aacute;fego pode fluir ininterrupto
atrav&eacute;s do novo firewall master.
d412 1
a412 1
Um exemplo.
d416 1
a416 1
         +----| WAN/Internet |----+ 
d418 1
a418 1
      em2|                        |em2   
d423 1
a423 1
         |                        | 
d428 1
a428 1
Os firewalls est&atilde;o conectados diretamente usando um cabo crossover
d430 3
a432 3
Ambos est&atilde;o conectados a LAN em <tt>em0</tt> e a uma conex&atilde;o 
WAN/Internet em <tt>em2</tt>. 
Endere&ccedil;os IP s&atilde;o como seguem:
d446 1
a446 2
A pol&iacute;tica de rede &eacute; que <tt>fw1</tt> ser&aacute; o master 
preferido.
d449 1
a449 1
Configura o fw1:
d454 1
a454 1
! habilita preemption e grupo de interface failover
d457 1
a457 1
! configura pfsync
d462 1
a462 1
! configura CARP no lado LAN
d467 1
a467 1
! configura CARP no lado WAN/Internet
d476 1
a476 1
Configura o fw2:
d481 1
a481 1
! habilita preemption e grupo de interface failover
d484 1
a484 1
! configura pfsync
d489 1
a489 1
! configura CARP no lado LAN
d494 1
a494 1
! configura CARP no lado WAN/Internet
d504 2
a505 2
<h2>Assuntos Operacionais</h2>
Alguns assuntos operacionais comuns encontrados com CARP/pfsync.
d509 4
a512 5
Visto que carp(4) e pfsync(4) s&atilde;o ambos tipos de interfaces de rede,
eles podem ser configurados durante a inicializa&ccedil;&atilde;o criando-se um
arquivo 
<a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=hostname.if&amp;sektion=5"
d514 3
a516 4
O script de inicializa&ccedil;&atilde;o 
<a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=netstart&amp;sektion=8"
>netstart</a> cuidar&aacute; de criar as interfaces e configur&aacute;-las.
d527 3
a529 1
<br>
d537 7
a543 8
<h3>For&ccedil;ando Failover do Master</h3>
Podem existir algumas vezes que seja necess&aacute;rio o failover ou 
derrubar o n&oacute; master de prop&oacute;sito.
Exemplos incluem derrubar o n&oacute; master para 
manuten&ccedil;&atilde;o ou quando estiver resolvendo um problema.
O objetivo aqui &eacute; elegantemente passar (fail over) o 
tr&aacute;fego para um dos hosts backups de modo que os usu&aacute;rios 
n&atilde;o observem nenhum impacto.
d546 3
a548 3
Para failover de um grupo CARP em particular, derrube a interface 
carp(4) no n&oacute; master.
Isto far&aacute; o master anunciar a si mesmo com um
d550 1
a550 1
O(s) host(s) backup ver&aacute; isto e imediatamente tomar&aacute; o
d560 3
a562 3
Uma alternativa &eacute; aumentar o <tt>advskew</tt> para um valor
mais alto que o <tt>advskew</tt> no(s) host(s) backup.
Isto causar&aacute; failover mas ainda permite o master participar
d566 16
a581 17
Um outro m&eacute;todo para failover &eacute; ajustar o contador CARP 
demotion.
O contador demotion &eacute; uma medida de como "pronto" um host
esta para se tornar o master do grupo CARP.
Por exemplo, enquanto um host esta no meio do processo de boot &eacute; 
uma m&aacute; id&eacute;ia para ele se tornar um master CARP at&eacute;
que todas as interfaces estejam configuradas, todos os servi&ccedil;os
de rede estejam iniciados, etc.
Hosts anunciando um valor demotion alto ter&atilde;o menos 
prefer&ecirc;ncia como master.

<p>
Um contador demotion &eacute; armazenado em cada grupo de interface
que a interface CARP pertence.
Por padr&atilde;o, todas a interfaces CARP s&atilde;o membros do grupo
de interface "carp".
O valor atual de um contador demotion pode ser visto usando o 
d592 5
a596 5
Neste exemplo o contador associado com o grupo de interface "carp" 
&eacute; mostrado.
Quando um host CARP anuncia a si mesmo na rede, ele pega a soma dos 
contadores demotion para cada grupo de interface que a interface carp(4) 
pertence e anuncia este valor como seu valor demotion.
d610 2
a611 2
O objetivo &eacute; apenas fazer failover dos grupos carp1 e carp2 para
o firewall secund&aacute;rio.
d614 1
a614 1
Primeiro, associe cada grupo a um novo grupo de interface, neste caso 
d652 6
a657 6
O firewall far&aacute; elegantemente o failover nos grupos carp1 e 
carp2 para o outro firewall no cluster, enquanto ainda se mant&eacute;m
como master nos grupos carp3 e carp4.
Se o outro firewall come&ccedil;ar a anunciar um valor demotion maior
do que 50 ou se parar de anunciar completamente, ent&atilde;o este
firewall far&aacute; novamente o takeover do master nos grupos carp1 e
d661 2
a662 2
Para voltar (fail back) para o firewall prim&aacute;rio, reverta
as mudan&ccedil;as:
d673 8
a680 10
Servi&ccedil;os de rede como
<a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=bgpd&amp;sektion=8"
>OpenBGPD</a> e 
<a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=sasyncd&amp;sektion=8"
>sasyncd(8)</a> 
fazem uso do contador demotion para garantir que o firewall n&atilde;o
se torne master at&eacute; que as sess&otilde;es BGP estejam
estabelecidas e SAs IPsec estejam sincronizados.
d682 1
a682 1
<a name="RulesetTips"></a> 
d684 3
a686 4
<b>Filtre a interface f&iacute;sica.</b>
At&eacute; o ponto que o PF se interessa o tr&aacute;fego da rede vem
da interface f&iacute;sica, n&atilde;o da interface virtual CARP 
(isto &eacute;, <tt>carp0</tt>).
d688 3
a690 5
N&atilde;o se esque&ccedil;a de que um nome de uma interface em uma 
regra do PF pode ser tanto o nome da interface f&iacute;sica ou um 
endere&ccedil;o associado com esta interface.
Por exemplo, esta regra poderia estar correta:

d694 2
a695 2
mas substituindo o <tt>fxp0</tt> por <tt>carp0</tt> n&atilde;o
funcionaria como voc&ecirc; deseja.
d698 1
a698 1
<b>N&Atilde;O se esque&ccedil;a</b> de uma regra pass para <tt>proto carp</tt> 
d704 2
a705 2
<h2>Outras Refer&ecirc;ncias</h2>
Por favor veja estas outras fontes para mais informa&ccedil;&atilde;o:
d709 2
a710 3
<a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.2"
>carp(4)</a>
d712 2
a713 3
<a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+4.2"
>pfsync(4)</a>
d715 2
a716 3
<a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8"
>ifconfig(8)</a>
d718 2
a719 3
<a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=hostname.if&amp;sektion=5"
>hostname.if(5)</a>
d721 2
a722 3
<a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+4.2"
>pf.conf(5)</a>
d724 2
a725 2
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifstated&amp;sektion=8"
>ifstated(8)</a>
d727 2
a728 3
<a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifstated.conf&amp;sektion=5" 
>ifstated.conf(5)</a>
d733 4
a736 5
[<a href="authpf.html">Anterior: Shell de Usu&aacute;rio para
Atutentica&ccedil;&atilde;o em Gateways</a>]
[<a href="index.html">Conte&uacute;do</a>]
[<a href="example1.html">Pr&oacute;ximo: Firewall para Casa ou Pequeno
Escrit&oacute;rio</a>]
d740 1
a740 1
<a href="index.html"><img height="24" width="24" src="../../../images/back.gif" border="0" alt="[back]"></a> 
d745 2
a746 2
Originally [OpenBSD: carp.html,v 1.19 ]<br>
$Translation: carp.html,v 1.10 2007/11/24 03:02:04 dsantos Exp $<br>
d752 1
a752 1
</html> 
@


1.9
log
@sync with steelix translation CVS
@
text
@d119 1
a119 1
&Eacute; poss&iacute;vel para m&uacute;ltiplos grupos CARP existir no
d121 2
a122 2
An&uacute;ncios CARP cont&eacute;m o Virtual Host ID que permite
membros do grupo identificar que grupo de redund&acirc;ncia pertence.
d150 1
a150 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.1"
d253 1
a253 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.1"
d305 1
a305 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+4.1"
d309 1
a309 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+4.1"
d416 1
a416 1
Atualiza&ccedil;&otilde;es ser&atilde;o enviadas multicast na rede 
d423 1
a423 1
de dois ou mais firewall podem ser usados para criar um cluster de firewall
d708 1
a708 1
fazer uso do contador demotion para garantir que o firewall n&atilde;o
d743 1
a743 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.1"
d747 1
a747 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+4.1"
d759 1
a759 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+4.1"
d785 2
a786 2
Originally [OpenBSD: carp.html,v 1.18 ]<br>
$Translation: carp.html,v 1.9 2007/06/21 23:41:16 dsantos Exp $<br>
@


1.8
log
@sync with steelix translation CVS
@
text
@d150 1
a150 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.0"
d153 1
a153 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8&amp;manpath=OpenBSD+4.0"
d175 2
a176 1
&eacute; usado para identificar o grupo de redund&acirc;ncia de outros n&oacute;s na rede.
d226 1
a226 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysctl&amp;sektion=8&amp;manpath=OpenBSD+4.0"
d253 1
a253 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.0"
d305 3
a307 2
href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+4.0"
>pfsync(4)</a> exp&otilde;e certas altera&ccedil;&otilde;es feitas na tabela de estados
d309 1
a309 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+4.0"
d313 1
a313 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=tcpdump&amp;sektion=8&amp;manpath=OpenBSD+4.0"
d349 1
a349 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=ipsec&amp;sektion=4&amp;manpath=OpenBSD+4.0"
d375 1
a375 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8&amp;manpath=OpenBSD+4.0"
d539 1
a539 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=hostname.if&amp;sektion=5&amp;manpath=OpenBSD+4.0"
d543 1
a543 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=netstart&amp;sektion=8&amp;manpath=OpenBSD+4.0"
d703 1
a703 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=bgpd&amp;sektion=8&amp;manpath=OpenBSD+4.0"
d706 1
a706 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=sasyncd&amp;sektion=8&amp;manpath=OpenBSD+4.0"
d743 1
a743 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+4.0"
d747 1
a747 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+4.0"
d751 1
a751 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8&amp;manpath=OpenBSD+4.0"
d755 1
a755 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=hostname.if&amp;sektion=5&amp;manpath=OpenBSD+4.0"
d759 1
a759 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+4.0"
d762 3
d766 1
a766 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifstated.conf&amp;sektion=5&amp;manpath=OpenBSD+4.0" 
d785 2
a786 2
Originally [OpenBSD: carp.html,v 1.16 ]<br>
$Translation: carp.html,v 1.8 2007/03/27 23:12:06 dsantos Exp $<br>
@


1.7
log
@sync with steelix translation CVS
@
text
@d14 1
a14 1
Copyright (c) 2005 Joel Knight <enabled@@myrealbox.com>
d200 1
a200 1
Manipulando o <tt><i>advbase</i></tt>, o host CARP master pode ser 
d204 1
a204 1
Valores aceitos s&atilde;o 1 &agrave; 254.
d571 2
a572 1
Para failover, derrube a interface carp(4) no n&oacute; master.
d585 4
a588 2
Se o preempt estiver habilitado, causar&aacute; failover para 
<b>todos</b> os outros grupos CARP.
d780 2
a781 2
Originally [OpenBSD: carp.html,v 1.13 ]<br>
$Translation: carp.html,v 1.7 2006/12/28 18:29:28 dsantos Exp $<br>
@


1.6
log
@sync with steelix translation CVS
@
text
@d79 1
a79 1
Protocol (VRRP)</a> e ao 
d81 1
a81 1
Protocol (HSRP)</a>.
d150 1
a150 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+3.9"
d153 1
a153 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8&amp;manpath=OpenBSD+3.9"
d225 1
a225 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysctl&amp;sektion=8&amp;manpath=OpenBSD+3.9"
d252 1
a252 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+3.9"
d258 1
a258 1
Um exemplo de configura&ccedil;&atilde;o do CARP.
d293 1
d304 1
a304 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+3.9"
d307 1
a307 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+3.9"
d311 1
a311 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=tcpdump&amp;sektion=8&amp;manpath=OpenBSD+3.9"
d340 2
a341 1
a interface como <tt>syncdev</tt> (veja <a href="#pfsyncconfig">abaixo</a>).
d343 3
a345 2
<a href="#pfsyncconfig">abaixo</a>) assim atualiza&ccedil;&otilde;es s&atilde;o
direcionadas com unicast para o n&oacute;, ent&atilde;o configure o 
d347 1
a347 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=ipsec&amp;sektion=4&amp;manpath=OpenBSD+3.9"
d353 3
a355 2
Quando as atualiza&ccedil;&otilde;es est&atilde;o sendo enviadas e recebidas
na rede, os pacotes pfsync devem ser aceitos nas regras de filtragem.
d373 1
a373 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8&amp;manpath=OpenBSD+3.9"
d393 4
a396 4
<dd>Este par&acirc;metro opcional espec&iacute;fica o endere&ccedil;o IP
de um host para trocar atualiza&ccedil;&otilde;es pfsync.
Por padr&atilde;o atualiza&ccedil;&otilde;es pfsync s&atilde;o multicast
na rede local.
d405 1
a405 1
Um exemplo de configura&ccedil;&atilde;o do pfsync.
d537 1
a537 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=hostname.if&amp;sektion=5&amp;manpath=OpenBSD+3.9"
d541 1
a541 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=netstart&amp;sektion=8&amp;manpath=OpenBSD+3.9"
d564 5
a568 5
Exemplos incluem derrubar o n&oacute; master para manuten&ccedil;&atilde;o ou
quando estiver resolvendo um problema.
O objetivo aqui &eacute; elegantemente passar (fail over) o tr&aacute;fego 
para um dos hosts backups de modo que os usu&aacute;rios n&atilde;o observem
nenhum impacto.
d583 124
d714 3
a716 3
N&atilde;o se esque&ccedil;a de que um nome de uma interface em uma regra
do PF pode ser tanto o nome da interface f&iacute;sica ou um endere&ccedil;o
associado com esta interface.
d737 2
a738 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+3.9"
d741 2
a742 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+3.9"
d745 2
a746 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8&amp;manpath=OpenBSD+3.9"
d749 2
a750 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=hostname.if&amp;sektion=5&amp;manpath=OpenBSD+3.9"
d753 2
a754 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+3.9"
d757 2
a758 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifstated.conf&amp;sektion=5&amp;manpath=OpenBSD+3.9" 
d777 2
a778 2
Originally [OpenBSD: carp.html,v 1.11 ]<br>
$Translation: carp.html,v 1.6 2006/10/26 23:17:03 dsantos Exp $<br>
@


1.5
log
@sync with steelix translation CVS
@
text
@d163 2
a164 2
[state <i>estado</i>] <i>endere&ccedil;o-ip</i>
<i>m&aacute;scara</i>
d265 1
a265 1
&nbsp;&nbsp;&nbsp;&nbsp;advskew 100 10.0.0.1 255.255.255.0<br>
d485 1
a485 1
     172.16.0.100 255.255.255.0
d490 1
a490 1
    192.0.2.100 255.255.255.0
d512 1
a512 1
     advskew 128 172.16.0.100 255.255.255.0
d517 1
a517 1
    advskew 128 192.0.2.100 255.255.255.0
d643 2
a644 2
Originally [OpenBSD: carp.html,v 1.10 ]<br>
$Translation: carp.html,v 1.5 2006/06/23 15:10:21 dsantos Exp $<br>
@


1.4
log
@sync with steelix translation CVS
@
text
@d200 3
a202 3
Manipulando o <tt><i>advbase</i></tt>, o host CARP master pode ser escolhido.
Quanto mais alto o n&uacute;mero, menos preferido ser&aacute; o host quando
estiver escolhendo um master.
d609 1
a609 2
<a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+3.9"
d612 1
a612 2
<a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+3.9"
d615 1
a615 2
<a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8&amp;manpath=OpenBSD+3.9"
d618 1
a618 2
<a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=hostname.if&amp;sektion=5&amp;manpath=OpenBSD+3.9"
d621 1
a621 2
<a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+3.9"
d623 3
d644 1
a644 1
$Translation: carp.html,v 1.4 2006/05/28 17:23:02 dsantos Exp $<br>
@


1.3
log
@sync with Steelix CVS
@
text
@d150 1
a150 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+3.8"
d153 1
a153 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8&amp;manpath=OpenBSD+3.8"
d225 1
a225 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysctl&amp;sektion=8&amp;manpath=OpenBSD+3.8"
d252 1
a252 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+3.8"
d303 1
a303 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+3.8"
d306 1
a306 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+3.8"
d310 1
a310 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=tcpdump&amp;sektion=8&amp;manpath=OpenBSD+3.8"
d344 1
a344 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=ipsec&amp;sektion=4&amp;manpath=OpenBSD+3.8"
d369 1
a369 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8&amp;manpath=OpenBSD+3.8"
d533 1
a533 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=hostname.if&amp;sektion=5&amp;manpath=OpenBSD+3.8"
d537 1
a537 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=netstart&amp;sektion=8&amp;manpath=OpenBSD+3.8"
d610 1
a610 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+3.8"
d614 1
a614 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+3.8"
d618 1
a618 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8&amp;manpath=OpenBSD+3.8"
d622 1
a622 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=hostname.if&amp;sektion=5&amp;manpath=OpenBSD+3.8"
d626 1
a626 1
href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+3.8"
d645 2
a646 2
Originally [OpenBSD: carp.html,v 1.9 ]<br>
$Translation: carp.html,v 1.3 2005/12/01 17:48:38 dsantos Exp $<br>
@


1.2
log
@sync with steelix translation CVS
@
text
@d64 1
d149 2
a150 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+3.7"
d152 2
a153 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8&amp;manpath=OpenBSD+3.7"
d224 2
a225 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysctl&amp;sektion=8&amp;manpath=OpenBSD+3.7"
d251 2
a252 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+3.7"
d302 2
a303 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+3.7"
d305 2
a306 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+3.7"
d309 2
a310 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tcpdump&amp;sektion=8&amp;manpath=OpenBSD+3.7"
d343 2
a344 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ipsec&amp;sektion=4&amp;manpath=OpenBSD+3.7"
d368 2
a369 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8&amp;manpath=OpenBSD+3.7"
d532 2
a533 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=hostname.if&amp;sektion=5&amp;manpath=OpenBSD+3.7"
d536 2
a537 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=netstart&amp;sektion=8&amp;manpath=OpenBSD+3.7"
d579 23
d609 2
a610 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4&amp;manpath=OpenBSD+3.7"
d613 2
a614 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4&amp;manpath=OpenBSD+3.7"
d617 2
a618 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8&amp;manpath=OpenBSD+3.7"
d621 2
a622 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=hostname.if&amp;sektion=5&amp;manpath=OpenBSD+3.7"
d625 2
a626 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+3.7"
d644 4
a647 2
Originally [OpenBSD: carp.html,v 1.6 ]<br>
$Translation: carp.html,v 1.2 2005/10/25 23:47:46 dsantos Exp $<br>
@


1.1
log
@sync with Steelix CVS
@
text
@d474 1
a474 1
# ifconfig carp1 vhid 1 carpdev em0 password lanpasswd \
d479 1
a479 1
# ifconfig carp2 vhid 2 carpdev em2 password netpasswd \
d501 1
a501 1
# ifconfig carp1 vhid 1 carpdev em0 password lanpasswd \
d506 1
a506 1
# ifconfig carp2 vhid 2 carpdev em2 password netpasswd \
d535 1
a535 1
&nbsp;&nbsp;&nbsp;&nbsp;password lanpasswd
d604 2
a605 2
Originally [OpenBSD: carp.html,v 1.5 ]<br>
$Translation: carp.html,v 1.1 2005/08/24 19:16:51 dsantos Exp $<br>
@

