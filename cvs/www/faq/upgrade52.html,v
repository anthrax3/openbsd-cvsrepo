head	1.27;
access;
symbols;
locks; strict;
comment	@# @;


1.27
date	2017.06.26.17.18.58;	author tb;	state Exp;
branches;
next	1.26;
commitid	jKVBuSx5No9bUpg1;

1.26
date	2017.03.25.19.07.05;	author tb;	state Exp;
branches;
next	1.25;
commitid	HspC9U4j3u1PNnAZ;

1.25
date	2016.08.15.02.22.14;	author tb;	state Exp;
branches;
next	1.24;
commitid	3DeixV5YkPOb78RN;

1.24
date	2016.04.15.20.39.49;	author tb;	state Exp;
branches;
next	1.23;
commitid	jwteSMEb4rFzI8UA;

1.23
date	2016.04.09.22.55.45;	author tb;	state Exp;
branches;
next	1.22;
commitid	Wgx2QsAm21an230r;

1.22
date	2016.03.27.19.52.09;	author sthen;	state Exp;
branches;
next	1.21;
commitid	hi2ObFv9LGB98JY5;

1.21
date	2016.03.22.10.54.48;	author sthen;	state Exp;
branches;
next	1.20;
commitid	cyODCFvIgxpUoVc0;

1.20
date	2016.03.21.05.46.21;	author beck;	state Exp;
branches;
next	1.19;
commitid	zEx6zFkNSFFExu0v;

1.19
date	2016.02.25.20.58.00;	author tj;	state Exp;
branches;
next	1.18;
commitid	meXmm6pusQ2lZ39V;

1.18
date	2015.07.08.01.11.32;	author nick;	state Exp;
branches;
next	1.17;
commitid	QIEEnBvMxTNfvnfo;

1.17
date	2015.07.02.05.49.04;	author bentley;	state Exp;
branches;
next	1.16;
commitid	AP3UllesavMDEUhQ;

1.16
date	2015.05.11.11.18.30;	author sthen;	state Exp;
branches;
next	1.15;
commitid	wRrXxcro6dFYiwF8;

1.15
date	2014.10.22.17.26.39;	author nick;	state Exp;
branches;
next	1.14;
commitid	zQZtNuePK10DY0J1;

1.14
date	2014.03.31.01.47.54;	author nick;	state Exp;
branches;
next	1.13;

1.13
date	2013.09.23.13.11.51;	author espie;	state Exp;
branches;
next	1.12;

1.12
date	2013.05.01.13.18.27;	author nick;	state Exp;
branches;
next	1.11;

1.11
date	2012.11.06.15.00.27;	author sthen;	state Exp;
branches;
next	1.10;

1.10
date	2012.11.05.03.13.21;	author nick;	state Exp;
branches;
next	1.9;

1.9
date	2012.11.02.01.48.14;	author nick;	state Exp;
branches;
next	1.8;

1.8
date	2012.11.01.23.23.28;	author nick;	state Exp;
branches;
next	1.7;

1.7
date	2012.10.27.15.37.14;	author rpe;	state Exp;
branches;
next	1.6;

1.6
date	2012.10.26.17.53.10;	author rpe;	state Exp;
branches;
next	1.5;

1.5
date	2012.10.26.17.34.39;	author naddy;	state Exp;
branches;
next	1.4;

1.4
date	2012.10.24.01.07.11;	author nick;	state Exp;
branches;
next	1.3;

1.3
date	2012.10.23.06.17.49;	author rpe;	state Exp;
branches;
next	1.2;

1.2
date	2012.10.22.11.19.06;	author nick;	state Exp;
branches;
next	1.1;

1.1
date	2012.10.21.17.51.19;	author nick;	state Exp;
branches;
next	;


desc
@@


1.27
log
@move man.openbsd.org links from http:// to https://
reduces the number of http:// links in www/ from >33k to <7k

thanks to schwarze for doing the work
@
text
@<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>OpenBSD Upgrade Guide: 5.1 to 5.2</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name="description"   content="OpenBSD Upgrade Process for 5.1 -> 5.2">
<meta name="copyright"     content="This document copyright 2012 by OpenBSD">
<meta name="viewport"      content="width=device-width, initial-scale=1">
<link rel="stylesheet"     type="text/css" href="../openbsd.css">
<link rel="canonical"      href="https://www.openbsd.org/faq/upgrade52.html">
</head>

<body bgcolor="#ffffff" text="#000000">

<h2>
<a href="../index.html">
<font color="#0000ff"><i>Open</i></font><font color="#000084">BSD</font></a>
<font color="#e00000">Upgrade Guide: 5.1 to 5.2</font>
</h2>
<hr>
<p>
<a href="index.html">[FAQ Index]</a> |
<a href="upgrade51.html">[5.0 -> 5.1]</a> |
<a href="upgrade53.html">[5.2 -> 5.3]</a>

<p>

<i>Note: Upgrades are only supported from one release to the release
immediately following it.
Do not skip releases.</i>

<p><i>
It is highly recommended that you read through and fully understand
this process before attempting it.
If you are doing it on a critical or physically remote machine, it is
recommended that you test this process on an identical, local system to
verify its success before attempting on a critical or remote computer.
</i>

<p>
Upgrading is a convenient way to bring your OpenBSD system up to the most
recent version.
However, the results are not intended to precisely match the results of
a wipe-and-reload installation.
Old library files in particular are not removed in the upgrade process,
as they may be required by older applications that may or may not be
upgraded at this time.
If you REALLY wish to get rid of all these old files, you are probably
better off reinstalling from scratch.

<p>
Table of Contents:
<ul>
<li><a href="#before">Before upgrading</a>
  <ul>
  <li><a href="#raidframe">raid(4) and RAIDframe are no more</a>
  <li><a href="#radeon">Radeon X driver changes</a>
  <li><a href="#OpenSMTPd">OpenSMTPd changes</a>
  <li><a href="#pf">Packet Filter changes</a>
  <li><a href="#tftpd">tftpd starts from rc.d now</a>
  <li><a href="#nginx">Introducing nginx</a>
  </ul>
<li><a href="#upgrade">The upgrade process</a>
<li><a href="#final">Final steps</a>
  <ul>
  <li><a href="#sysmerge">Merging locally changed files via sysmerge(8)</a>
  <li><a href="#patchfile">Merging locally changed files via patch file</a>
  <li><a href="#RmFiles">Files to delete</a>
  <li><a href="#Kernchk">Checking the kernel</a>
  <li><a href="#Pkgup">Upgrading packages</a>
  </ul>
</ul>

<hr>
<p>
<h2 id="before">Before upgrading: things to think about and be aware of</h2>
This is <i>not</i> a complete list of the changes that took place
between 5.1 and 5.2, but rather some of the important things that will
impact a large number of users in the upgrade process.
For a more complete list of changes, see
<a href="../plus51.html">plus51.html</a> and the CVS change logs.

<ul>
<li id="raidframe"><b>raid(4) and RAIDframe are no more:</b>
If you are using RAIDframe for a system currently, you will need to make
plans to rebuild it using
<a href="https://man.openbsd.org/softraid.4">softraid(4)</a>
before you can upgrade it past 5.1.

<p>
<li id="radeon"><b>Radeon X driver changes:</b>
The
<a href="https://man.openbsd.org/radeon">radeon(4)</a>
driver has been updated to version 6.14.3, but it's not selected by
auto-configuration code.
The
<a href="https://man.openbsd.org/radeonold">radeonold(4)</a>
driver is providing a frozen version of the last working driver, as
there were some issues with the new driver.
Users with cards needing the new driver should create an
<a href="https://man.openbsd.org/xorg.conf">xorg.conf(5)</a>
file containing just
<pre>
Section "Device"
    Identifier "RadeonCard"
    Driver "radeon"
EndSection
</pre>
Or merge this section in their existing <tt>/etc/X11/xorg.conf</tt> file.

<p>
The <b>radeonhd</b> driver is now deprecated.
Users of this this driver should update their <tt>/etc/X11/xorg.conf</tt> file
by replacing
<pre>
      Driver "radeonhd"
</pre>
with
<pre>
      Driver "radeon"
</pre>

<p>
<li id="OpenSMTPd"><b>OpenSMTPd changes:</b>
<ul>
<li><b>smtpd.conf syntax changes:</b>
<ul>
<li><tt>relay via</tt> rules should now be expressed with a relay URL:
<pre>	accept [...] relay via "mx1.example.org" smtps port 465</pre>
becomes
<pre>	accept [...] relay via "smtps://mx1.example.org"</pre>
<li>makemap(8) virtual domains configuration:
<pre>	accept for virtual vmap [...]</pre>
becomes
<pre>	accept for virtual map vmap [...]</pre>
</ul>
The new syntax is documented in
<a href="https://man.openbsd.org/smtpd.conf.5">smtpd.conf(5)</a>

<p>
<li><b>smtpd queue layout changed:</b>
A change to the queue layout was introduced, you will want to empty your
queue before updating.
</ul>

<p>
<li id="pf"><b>pf.conf syntax changes:</b>
<ul>
<li><tt>prio</tt> to assign queueing priorities has changed to <tt>set prio</tt>.
<li><tt>set-tos</tt> to enforce a TOS has changed to <tt>set tos</tt>
</ul>
The new syntax is documented in
<a href="https://man.openbsd.org/pf.conf.5">pf.conf(5)</a>

<p>
<li id="tftpd"><b>tftpd starts from rc.d now:</b>
keeping with newer practices,
<a href="https://man.openbsd.org/tftpd.8">tftpd(8)</a>
is no longer run from
<a href="https://man.openbsd.org/inetd.8">inetd(8)</a>
but is now started using an rc.d script.
You will want to remove the tftpd lines from <tt>/etc/inetd</tt> and
replace them with a <tt>tftpd_flags="<i>[chroot directory]</i>"</tt>
line in <tt>/etc/rc.conf.local</tt>.

<p>
<li id="nginx"><b>Introducing nginx(8):</b>
<a href="https://nginx.org">nginx</a> (see also
<a href="https://man.openbsd.org/nginx.8">nginx(8)</a>)
has been added to OpenBSD, ultimately to replace the Apache 1.3 derived
<a href="https://man.openbsd.org/httpd.8">httpd(8)</a>.
For new installations, you are encouraged to utilize nginx rather than
httpd, existing installations are encouraged to start planning replacing
the stock httpd with nginx.
</ul>

<p>
<hr>
<h2 id="upgrade">The upgrade process</h2>

<h3>Upgrading by install kernel</h3>
If you have access to the system's console, the easiest and safest way
to upgrade is to boot from the install kernel by boot media or
<a href="faq4.html#bsd.rd">bsd.rd</a> and follow the upgrade steps,
which are very similar to the <a href="faq4.html">install process</a>.

<p>
Afterwards, complete the upgrade by following the <a href="#final">final
steps</a> as detailed below.

<p>
One easy way to boot from the install kernel is to place the 5.2 version
of <i>bsd.rd</i> in the root of your boot drive, then instruct the boot loader
to boot using this new <i>bsd.rd</i> file.
On amd64 and i386, you do this by entering "<tt>boot bsd.rd</tt>" at the
initial <tt>boot&gt;</tt> prompt.

<h3>Upgrading without install kernel</h3>
<i>This is NOT the recommended process.  Use the install kernel method
if at all possible!</i>

<p>
Sometimes, one needs to do an upgrade of a machine when one can't easily
use the normal upgrade process.
The most common case is when the machine is in a remote location and you
don't have easy access to the system console.
One can usually do this by carefully following this process:

<ul>
<li><b>Place install files in a "good" location</b>.
Make sure you have sufficient space!

<p>
<li><b>Become root with ksh(1):</b>
While using
<a href="https://man.openbsd.org/sudo.8">sudo(8)</a>
before each command is generally a good practice, the sudo(8) command
will be broken by the last steps, so you should be root before starting
this process.
Also, the use of the OpenBSD
<a href="https://man.openbsd.org/ksh.1">ksh(1)</a>
shell is assumed.

<p>
<li><b>Stop any appropriate applications:</b>
During this process, all the userland applications will be replaced but
may not be runnable, and strange things may happen as a result.
If this is a concern to you, shut down any applications that may
be impacted.
There may be other applications which you wish to keep from running
immediately after the upgrade, stop and disable them as well.

<p>
<li><b>Disable package daemons and local shutdown commands:</b>
The last steps in the upgrade process may result in various commands,
especially those which are dynamically linked, being broken.
In particular, this may prevent a normal shutdown of daemons listed
in pkg_scripts, or additional commands in /etc/rc.shutdown, which may
cause the machine to hang at shutdown.
Before you proceed with the upgrade, edit /etc/rc.conf.local and
comment-out any pkg_scripts lines.
Also inspect /etc/rc.shutdown and comment-out any local shutdown commands.
These can be reinstated post upgrade.

<p>
<li><b>Check the kernel:</b>
Although <b>most people can skip this step</b>, if you had a modified kernel
in 5.1, it is likely you will need to modify the stock kernel of 5.2.
Especially when you are performing the upgrade process remotely, now is
the time to make sure the new kernel will work upon rebooting the machine.
If any changes must be made to the kernel, the safest thing to do is to
make those changes on a local 5.2 system.
This can be as simple as modifying a specific device using config(8),
or it can involve a recompilation if the option you need is not included
in the GENERIC kernel.
Please consult <a href="faq5.html">FAQ 5 - Building the system from source</a>
before deciding to recompile your kernel.

<p>
<li><b>Install new kernel(s):</b>

<ul>
<li>If using a single processor kernel:
<blockquote><pre>
<b>export RELEASEPATH=</b><i>/usr/rel</i>   <i># where you put the files</i>
<b>cd ${RELEASEPATH}</b>
<b>rm /obsd ; ln /bsd /obsd && cp bsd /nbsd && mv /nbsd /bsd</b>
<b>cp bsd.rd bsd.mp /</b>
</pre></blockquote>
(note: you will get a harmless error message if your platform doesn't
have a bsd.mp):
<p>

<li>If you are using the multiprocessor kernel:
<blockquote><pre>
<b>export RELEASEPATH=</b><i>/usr/rel</i>   <i># where you put the files</i>
<b>cd ${RELEASEPATH}</b>
<b>rm /obsd ; ln /bsd /obsd && cp bsd.mp /nbsd && mv /nbsd /bsd</b>
<b>cp bsd.rd /</b>
<b>cp bsd /bsd.sp</b>
</pre></blockquote>
</ul>

<p>
Note the extra steps for copying over the primary kernel: those are done
to ensure that there is always a valid copy of the kernel on the disk
that the system can boot from should there be a really badly timed power
outage or system crash.

<p>
<li><b>Save a copy of reboot(8), install new userland applications.</b>
You are still running the old kernel, it is possible the new reboot
command will not run on the old kernel, so we will start by saving a
copy of the old reboot command.
<i>Do NOT install <tt>etc52.tgz</tt> and <tt>xetc52.tgz</tt> now, because
that will overwrite your current configuration files!</i>
Note that we are installing base52.tgz LAST, because it will include a new
<a href="https://man.openbsd.org/tar.1">tar(1)</a>
utility, which may or may not run on the old kernel.
We reboot immediately, as the system is probably barely runnable after
the unpacking of all the new files.

<blockquote><pre>
<b>cp /sbin/reboot /sbin/oreboot</b>
<b>tar -C / -xzphf xserv52.tgz</b>
<b>tar -C / -xzphf xfont52.tgz</b>
<b>tar -C / -xzphf xshare52.tgz</b>
<b>tar -C / -xzphf xbase52.tgz</b>
<b>tar -C / -xzphf game52.tgz</b>
<b>tar -C / -xzphf comp52.tgz</b>
<b>tar -C / -xzphf man52.tgz</b>
<b>tar -C / -xzphf base52.tgz</b> # Install last!
<b>/sbin/oreboot</b>
</pre></blockquote>

Not all file sets will need to be installed for all applications,
however if you installed a file set originally, you should certainly
upgrade it with the new file set now.

<p>
Again, the files in <tt>/etc</tt> are handled separately below, so
<tt>etc52.tgz</tt> and <tt>xetc52.tgz</tt> are NOT unpacked here.

<p>
<li><b>After reboot completes, upgrade <tt>/dev</tt>.</b>
The new
<a href="https://man.openbsd.org/OpenBSD-5.2/i386/MAKEDEV">MAKEDEV</a>
file was copied to /dev by the installation of
<tt>base52.tgz</tt>, so you simply need to do the following:
<blockquote><pre>
<b>cd /dev</b>
<b>./MAKEDEV all</b>
</pre></blockquote>

</ul>

<hr>
<h2 id="final">Final steps</h2>

Whether you upgrade by using an install kernel and doing a formal
"upgrade" process, or do a "in-place" binary upgrade, you need to update
the system configuration files which are included in the <tt>etc52.tgz</tt>
which have not been dealt with so far.
There are two processes we provide for you -- manually copying over some
files and patching others, or using the
<a href="https://man.openbsd.org/sysmerge.8">sysmerge(8)</a>
process.

<p>
<h3 id="sysmerge">1a. Merging locally changed files via sysmerge(8)</h3>

<blockquote>
<b>Who should use sysmerge(8):</b><br>
People running highly modified systems or systems that didn't start out
at the previous release (for example, a snapshot part way between
releases), who are upgrading to a snapshot or who have not carefully
upgraded their system in the past will find sysmerge vastly superior to
using the patches, as it works with what is actually on your system,
instead of what we expected was on your system.
It will also give you much greater control over your upgrade process,
and will involve you in it more closely.

<p>
<b>Who may wish to NOT use sysmerge(8):</b><br>
With recent improvements in sysmerge, we hope that relatively few
people have reason not to use sysmerge(8)!
However, people with a large quantity of similar machines to upgrade
may find the "patch file" process faster, and perhaps the basis of
a customized upgrade script.

<p>
<b>Using sysmerge(8) for the first time:</b><br>
If you have a system that's been upgraded in the past via the patch file
process you will probably find the FIRST time you upgrade by sysmerge,
you have a LOT of manual file changes to make.
This is because the patch file process only attempted to achieve
functional compatibility on the upgraded system, and did not respect
the version control information sysmerge(8) uses to identify "unchanged"
files.
Rest assured, later runs of sysmerge will be far less painful, and often
completely effortless.

<p>
The
<a href="https://man.openbsd.org/sysmerge.8">sysmerge(8)</a>
utility will compare the files that are actually on your system with
those that would be installed in a fresh install, and assist you in
merging the changes into your system.
Note that unlike the patch file, there are no assumptions made about
what is actually on your system, so you can use sysmerge(8) to move
between more arbitrary <a href="faq5.html#Flavors">points in the
development process</a>, such as from an earlier <i>5.1-current</i> to
<i>5.2-release</i> or from one <i>-current</i> to a later one.
Sysmerge(8) compares the current files on your system with the files
that would have been installed with a new install, and what would have
been there from the last run of sysmerge.
Usually, it can figure out what to do to update your files, but if it
has difficulty, it will give you the option of keeping the old file,
installing the new file, or assisting you in the manual merging of the
old and new files, using
<a href="https://man.openbsd.org/sdiff.1">sdiff</a>.

<p>
Please read the
<a href="https://man.openbsd.org/sysmerge.8">sysmerge(8)</a>
manual page before using it on your system.
You are also advised to read the
<a href="https://man.openbsd.org/diff.1">diff(1)</a>,
<a href="https://man.openbsd.org/sdiff.1">sdiff(1)</a>
and even review
<a href="https://man.openbsd.org/more.1">more(1)</a>
manual pages before continuing.

<p>
Assuming the <tt>etc52.tgz</tt> and <tt>xetc52.tgz</tt> files exists in
your ${RELEASEPATH}, run it with:

<blockquote><pre>
<b>sysmerge -s ${RELEASEPATH}/etc52.tgz -x ${RELEASEPATH}/xetc52.tgz</b>
</pre></blockquote>

For the files sysmerge(8) can't resolve on its own, it will show you a
unified
<a href="https://man.openbsd.org/diff.1">diff(1)</a>,
run through your favorite $PAGER (i.e.,
<a href="https://man.openbsd.org/more.1">more(1)</a>)
and ask you if you wish to:
<blockquote><pre>
  Use 'd' to delete the temporary ./var/www/htdocs/index.html
  Use 'i' to install the temporary ./var/www/htdocs/index.html
  Use 'm' to merge the temporary and installed versions
  Use 'v' to view the diff results again

  Default is to leave the temporary file to deal with by hand
</pre></blockquote>

<p>
If you wish to retain your existing file, delete the temporary file, if
you wish to replace your existing file with the new version, install the
temporary file.
If you wish to merge the two together, choosing 'm' will put you into
<a href="https://man.openbsd.org/sdiff.1">sdiff(1)</a>,
where you can manually merge the file.
The default is to come back and deal with the file later, manually.

<p>
Sysmerge(8) saves all your replaced files into a temporary directory,
similar to <tt>/var/tmp/sysmerge.24959/backups</tt>, so if you accidentally
clobber something that was probably not such a good idea, you have a chance
to recover it. Note that
<a href="https://man.openbsd.org/daily.8">daily(8)</a>
cleans old files from this directory, but it will survive a reboot.

<!-- p>
<b>Sysmerge notes for 5.1 -> 5.2:</b><br>
<ul>
<li><b><tt>/etc/sysctl.conf</tt>:</b>
The changes to <tt>sysctl.conf</tt> are all commented out items, so not
installing the changed file will not directly change your system's
behaviour.
Blindly installing the new default over your old, customized file
will often cause significant annoyance.
However, the new file shows the defaults and common options that are
available, so you may wish to manually merge the changes into your file,
or install the new file and put your changes back into the new file.

</ul -->
</blockquote>

<p>
<h3 id="patchfile">1b. Merging locally changed files via a patch file</h3>
<blockquote>
This process makes a lot of assumptions about what files you have and
have not modified, and that you are upgrading from <i>5.1-release</i> to
<i>5.2-release</i>.
Before following this, make sure your system matches the assumptions,
and alter the process accordingly if needed -- or just use the above
<a href="#sysmerge">sysmerge process</a>.

<p id="UsersGroups">
No new users and groups need to be created for 5.2.
<!--
The following users need to be created for 4.8:

<blockquote><pre>
<b>useradd -u 99 -g =uid -c "sndio privsep" -d /var/empty -s /sbin/nologin _sndio
useradd -u 100 -g =uid -c "LDAP Daemon" -d /var/empty -s /sbin/nologin _ldapd
useradd -u 101 -g =uid -c "IKEv2 Daemon" -d /var/empty -s /sbin/nologin _iked</b>
</pre></blockquote>
-->

<p>
You will want to extract the <tt>etc52.tgz</tt> files to a temporary
location:
<blockquote><pre>
<b>export RELEASEPATH=/usr/rel</b>
<b>tar -C /tmp -xzphf ${RELEASEPATH}/etc52.tgz</b>
</pre></blockquote>


Files that can probably be copied from <tt>etc52.tgz</tt> "as is":

<blockquote><pre>
etc/daily
etc/moduli
etc/rc
etc/rc.conf
etc/mail/localhost.cf
etc/mail/sendmail.cf
etc/mail/submit.cf
etc/rc.d/nfsd
etc/rc.d/nginx
etc/rc.d/sendmail
etc/rc.d/tftpd
etc/rc.d/rc.subr
var/www/conf/bgplg.head
</pre></blockquote>

Note that it IS possible to locally modify these files; if this has been
done, do NOT simply copy over those files, and consider using the
<a href="#sysmerge">sysmerge(8) process</a> instead.
Pay special attention to <tt>mail/*</tt> if you are using something
other than the default Sendmail(8) configuration.

<p>
Here are copy/paste lines for copying these files, assuming you unpacked
<tt>etc52.tgz</tt> in the above recommended place:

<blockquote><pre>
<b>cd /tmp/etc</b>
<b>cp daily moduli rc rc.conf /etc</b>
<b>mkdir /etc/nginx</b>
<b>cp nginx/* /etc/nginx/</b>
<b>cd /tmp/etc/rc.d</b>
<b>cp nfsd nginx sendmail tftpd rc.subr /etc/rc.d</b>
<b>cp /tmp/var/www/conf/bgplg.head /var/www/conf/</b>
<b>cp /tmp/etc/mail/*.cf /etc/mail</b>  # <i>Use with care!</i>
</pre></blockquote>
<p>


<p>
These files likely have local changes, but should be updated for
5.2.  IF you have not altered these files, you can copy over the
new version, otherwise the changes should be merged with your files:

<blockquote><pre>
etc/inetd.conf
etc/login.conf
etc/services
etc/sysctl.conf
etc/mail/smtpd.conf
etc/mail/spamd.conf
etc/ssh/sshd_config
</pre></blockquote>

The changes to these files are in <a href="upgrade52.patch">this
patch file</a>.
Please test this process before relying on it for a machine you can not
easily get to.
You can attempt to use this by executing the following as root:
<blockquote><pre>
<b>cd /</b>
<b>ftp http://www.openbsd.org/faq/upgrade52.patch</b>
<b>patch -C -p0 &lt; upgrade52.patch</b>
</pre></blockquote>

This will test the patch to see how well it will apply to YOUR system;
to actually apply it, leave off the "<tt>-C</tt>" option.
Note that it is likely that if you have customized files or not kept
them closely updated, or are upgrading from a snapshot of 5.1, they may
not accept the patch cleanly.
Make sure all file changes are attempted; patch(1) may quit prematurely
if it gets too confused in one file, which may happen if your machine
was originally installed from a snapshot or otherwise has some interim
changes.
The last file to be changed here should be <tt>sysctl.conf</tt>.
Deleting the file sections that fail from the patch file may permit the
rest to be applied.
You will need to manually apply the changes that are skipped.

<p>
The following files have had changes which should be looked at, but it
is unlikely they should be directly copied or merged (i.e., if you are
using nsd.conf, look at the suggested change of strategy, and decide if
it is appropriate for your use).

<blockquote><pre>
etc/bgpd.conf
etc/iked.conf
</pre></blockquote>

<p>

Finally, use
<a href="https://man.openbsd.org/newaliases.8">newaliases(8)</a>
to update the aliases database,
<a href="https://man.openbsd.org/mtree.8">mtree(8)</a>
create any new directories:

<blockquote><pre>
<b>newaliases</b>
<b>mtree -qdef /etc/mtree/4.4BSD.dist -p / -u</b>
</pre></blockquote>
</blockquote>

<p><br><p>
<b><i>All upgraders, whether merging via sysmerge(8) or patch file
should continue the upgrade process with these steps:</i></b>

<h3 id="RmFiles">2. Files to delete</h3>
A number of files should be deleted from your system.
Note that some of these may not exist on all systems; that's ok.
Copy and paste the following lines:
<blockquote><pre>
<b>rm /usr/bin/lint
rm /usr/libexec/lint[12]
rm -r /usr/libdata/lint
rm /usr/share/man/man1/lint.1
rm /etc/rc.d/btd
rm /usr/sbin/pkg
rm /sbin/raidctl
rm /usr/share/man/man4/raid.4
rm /usr/share/man/man8/raidctl.8
rm /usr/libexec/tftpd
rm -r /usr/lib/gcc-lib/*-unknown-openbsd5.1</b>
</pre></blockquote>

<h3 id="Kernchk">3. Checking the kernel</h3>
Note: <b>most people can skip this step!</b>
<p>
If you followed the instructions for the upgrade process without install
kernel, you have already completed this step.
However, if you used the install kernel, and if you had a modified kernel
in 5.1, it is likely you will need to modify the stock kernel of 5.2.
This can be as simple as modifying a specific device using config(8),
or it can involve a recompilation if the option you need is not included
in the GENERIC kernel.
Please consult <a href="faq5.html">FAQ 5 - Building the system from source</a>
before considering to recompile your kernel.

<p>
<h3 id="Pkgup">4. Upgrading packages</h3>
If you installed any packages on your system, you should upgrade them
after completing the upgrade of the base system.
Be aware, however, many packages will require further setup before
and/or after upgrading the package.
Check with the application's upgrade guide for details.

<p>
The following packages are known to have significant upgrade issues that
will impact a large number of users.
The fact that a package is not on this list doesn't mean it will have a
trivial upgrade.
You must do some homework on the applications YOU use.

<ul>
<li><b>Subversion gnome-keyring is now a subpackage:</b>
gnome-keyring support in Subversion was previously a FLAVOR of the port,
as it required the main program to link with libpthread causing some
side-effects with the previous uthread library (notably, strange
behavior with "svn diff | more" due to how I/O on file descriptors
was handled).
<p>
As this is no longer an issue with rthreads, the FLAVOR has been removed.
To continue using gnome-keyring with Subversion, after updating packages you
will need to "pkg_add gnome-keyring-subversion".

<p>
<li><b>xpdf-utils replaced with poppler-utils:</b>
The PDF-related tools from xpdf-utils (pdffonts, pdfimages, pdfinfo,
pdftotext) have been replaced with equivalents in poppler-utils.
Note that these no longer read xpdfrc files and are now only configured
using command-line options.

<p>
<li><b>ser removed:</b>
The ser port has been removed. Users of ser are advised to migrate
to kamailio for now.

<p>
<li><b>scrotwm renamed to spectrwm:</b>
The package update will be handled automatically but you will need to
rename your configuration files:
<tt>mv /etc/scrotwm.conf /etc/spectrwm.conf</tt> for the system
configuration file, and any <tt>.scrotwm.conf</tt> files in user home directories
will need to be renamed to <tt>.spectrwm.conf</tt>.
You will also need to adapt any entries in <tt>.xsession</tt>, etc., to start the
window manager.

<p>
<li><b>xxxterm renamed to xombrero:</b>
The package update will be handled automatically but you will need to
rename your configuration files and directories.
There is no system configuration file, but any <tt>.xxxterm.conf</tt> files in
user home directories will need to be renamed to <tt>.xombrero.conf</tt>.

<p>
<li><b>dovecot:</b>
Dovecot was updated to 2.1 which may require minor changes to configuration.
See the <a href="https://wiki2.dovecot.org/Upgrading/2.1">upgrade notes</a>
for details.

</ul>

<p>
The package tools support in-place updating using <tt>pkg_add -u</tt>.
For instance, to update all your packages, make sure <tt>PKG_PATH</tt> is
pointing to the 5.2 packages directory on your CD or nearest FTP mirror,
and use something like

<blockquote><pre>
<b>pkg_add -u</b>
</pre></blockquote>

where the <tt>-u</tt> indicates update mode;
pkg_add will prompt you for input when it encounters
some ambiguity. Read the
<a href="https://man.openbsd.org/OpenBSD-5.2/pkg_add">pkg_add(1)</a>
manual page and the <a href="faq15.html#PkgMgmt">package management</a>
chapter of the FAQ for more information.


<p>
<a href="index.html">[FAQ Index]</a> |
<a href="upgrade51.html">[5.0 -> 5.1]</a> |
<a href="upgrade53.html">[5.2 -> 5.3]</a>

<p>
<hr>
<a href="index.html"><img height="24" width="24" src="../images/back.gif" border="0" alt="[back]"></a>
<br>
<small>$OpenBSD: upgrade52.html,v 1.26 2017/03/25 19:07:05 tb Exp $</small>

</body>
</html>
@


1.26
log
@a few more links can switch to https.
@
text
@d87 1
a87 1
<a href="http://man.openbsd.org/softraid.4">softraid(4)</a>
d93 1
a93 1
<a href="http://man.openbsd.org/radeon">radeon(4)</a>
d97 1
a97 1
<a href="http://man.openbsd.org/radeonold">radeonold(4)</a>
d101 1
a101 1
<a href="http://man.openbsd.org/xorg.conf">xorg.conf(5)</a>
d138 1
a138 1
<a href="http://man.openbsd.org/smtpd.conf.5">smtpd.conf(5)</a>
d153 1
a153 1
<a href="http://man.openbsd.org/pf.conf.5">pf.conf(5)</a>
d158 1
a158 1
<a href="http://man.openbsd.org/tftpd.8">tftpd(8)</a>
d160 1
a160 1
<a href="http://man.openbsd.org/inetd.8">inetd(8)</a>
d169 1
a169 1
<a href="http://man.openbsd.org/nginx.8">nginx(8)</a>)
d171 1
a171 1
<a href="http://man.openbsd.org/httpd.8">httpd(8)</a>.
d216 1
a216 1
<a href="http://man.openbsd.org/sudo.8">sudo(8)</a>
d221 1
a221 1
<a href="http://man.openbsd.org/ksh.1">ksh(1)</a>
d298 1
a298 1
<a href="http://man.openbsd.org/tar.1">tar(1)</a>
d327 1
a327 1
<a href="http://man.openbsd.org/OpenBSD-5.2/i386/MAKEDEV">MAKEDEV</a>
d346 1
a346 1
<a href="http://man.openbsd.org/sysmerge.8">sysmerge(8)</a>
d385 1
a385 1
<a href="http://man.openbsd.org/sysmerge.8">sysmerge(8)</a>
d401 1
a401 1
<a href="http://man.openbsd.org/sdiff.1">sdiff</a>.
d405 1
a405 1
<a href="http://man.openbsd.org/sysmerge.8">sysmerge(8)</a>
d408 2
a409 2
<a href="http://man.openbsd.org/diff.1">diff(1)</a>,
<a href="http://man.openbsd.org/sdiff.1">sdiff(1)</a>
d411 1
a411 1
<a href="http://man.openbsd.org/more.1">more(1)</a>
d424 1
a424 1
<a href="http://man.openbsd.org/diff.1">diff(1)</a>,
d426 1
a426 1
<a href="http://man.openbsd.org/more.1">more(1)</a>)
d442 1
a442 1
<a href="http://man.openbsd.org/sdiff.1">sdiff(1)</a>,
d451 1
a451 1
<a href="http://man.openbsd.org/daily.8">daily(8)</a>
d596 1
a596 1
<a href="http://man.openbsd.org/newaliases.8">newaliases(8)</a>
d598 1
a598 1
<a href="http://man.openbsd.org/mtree.8">mtree(8)</a>
d719 1
a719 1
<a href="http://man.openbsd.org/OpenBSD-5.2/pkg_add">pkg_add(1)</a>
d733 1
a733 1
<small>$OpenBSD: upgrade52.html,v 1.25 2016/08/15 02:22:14 tb Exp $</small>
@


1.25
log
@tls on openbsd.org is now real:
- link to https://www.openbsd.org from the sub-projects' pages
- make internal links relative
- switch link rel=canonical to https to please some search engines
"go ahead" from beck, "do it!!!!" tj
@
text
@d168 1
a168 1
<a href="http://nginx.org">nginx</a> (see also
d701 1
a701 1
See the <a href="http://wiki2.dovecot.org/Upgrading/2.1">upgrade notes</a>
d733 1
a733 1
<small>$OpenBSD: upgrade52.html,v 1.24 2016/04/15 20:39:49 tb Exp $</small>
@


1.24
log
@use short form man links in the faq and fix a few broken links
@
text
@d10 1
a10 1
<link rel="canonical"      href="http://www.openbsd.org/faq/upgrade52.html">
d733 1
a733 1
<small>$OpenBSD: upgrade52.html,v 1.23 2016/04/09 22:55:45 tb Exp $</small>
@


1.23
log
@more css surgery, metadata and other cleanup, validation fixes.
@
text
@d87 1
a87 1
<a href="http://man.openbsd.org/?query=softraid&amp;sektion=4">softraid(4)</a>
d93 1
a93 1
<a href="http://man.openbsd.org/?query=radeon">radeon(4)</a>
d97 1
a97 1
<a href="http://man.openbsd.org/?query=radeonold">radeonold(4)</a>
d101 1
a101 1
<a href="http://man.openbsd.org/?query=xorg.conf">xorg.conf(5)</a>
d138 1
a138 1
<a href="http://man.openbsd.org/?query=smtpd.conf&amp;sektion=5">smtpd.conf(5)</a>
d153 1
a153 1
<a href="http://man.openbsd.org/?query=pf.conf&amp;sektion=5">pf.conf(5)</a>
d158 1
a158 1
<a href="http://man.openbsd.org/?query=tftpd&amp;sektion=8">tftpd(8)</a>
d160 1
a160 1
<a href="http://man.openbsd.org/?query=inetd&amp;sektion=8">inetd(8)</a>
d169 1
a169 1
<a href="http://man.openbsd.org/?query=nginx&amp;sektion=8">nginx(8)</a>)
d171 1
a171 1
<a href="http://man.openbsd.org/?query=httpd&amp;sektion=8">httpd(8)</a>.
d216 1
a216 1
<a href="http://man.openbsd.org/?query=sudo&amp;sektion=8">sudo(8)</a>
d221 1
a221 1
<a href="http://man.openbsd.org/?query=ksh&amp;sektion=1">ksh(1)</a>
d298 1
a298 1
<a href="http://man.openbsd.org/?query=tar&amp;sektion=1">tar(1)</a>
d327 1
a327 1
<a href="http://man.openbsd.org/?query=MAKEDEV&amp;sektion=8&amp;arch=i386">MAKEDEV</a>
d346 1
a346 1
<a href="http://man.openbsd.org/?query=sysmerge&amp;sektion=8">sysmerge(8)</a>
d385 1
a385 1
<a href="http://man.openbsd.org/?query=sysmerge&amp;sektion=8">sysmerge(8)</a>
d401 1
a401 1
<a href="http://man.openbsd.org/?query=sdiff&amp;sektion=1">sdiff</a>.
d405 1
a405 1
<a href="http://man.openbsd.org/?query=sysmerge&amp;sektion=8">sysmerge(8)</a>
d408 2
a409 2
<a href="http://man.openbsd.org/?query=diff&amp;sektion=1">diff(1)</a>,
<a href="http://man.openbsd.org/?query=sdiff&amp;sektion=1">sdiff(1)</a>
d411 1
a411 1
<a href="http://man.openbsd.org/?query=more&amp;sektion=1">more(1)</a>
d424 1
a424 1
<a href="http://man.openbsd.org/?query=diff&amp;sektion=1">diff(1)</a>,
d426 1
a426 1
<a href="http://man.openbsd.org/?query=more&amp;sektion=1">more(1)</a>)
d442 1
a442 1
<a href="http://man.openbsd.org/?query=sdiff&amp;sektion=1">sdiff(1)</a>,
d451 1
a451 1
<a href="http://man.openbsd.org/?query=daily&amp;sektion=8">daily(8)</a>
d596 1
a596 1
<a href="http://man.openbsd.org/?query=newaliases&amp;sektion=8">newaliases(8)</a>
d598 1
a598 1
<a href="http://man.openbsd.org/?query=mtree&amp;sektion=8">mtree(8)</a>
d719 1
a719 1
<a href="http://man.openbsd.org/?query=pkg_add&amp;sektion=1&amp;manpath=OpenBSD+5.2">pkg_add(1)</a>
d733 1
a733 1
<small>$OpenBSD: upgrade52.html,v 1.22 2016/03/27 19:52:09 sthen Exp $</small>
@


1.22
log
@add a small sprinkling of css to improve readability in the faq, ok tj@@ tb@@
@
text
@d8 3
a10 3
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="../openbsd.css">
<link rel="canonical" href="http://www.openbsd.org/faq/upgrade52.html">
d14 2
d17 4
a20 2
<img alt="[OpenBSD]" height=30 width=141 src="../images/smalltitle.gif" border="0">
</a>
d22 1
a22 19
<font color="#0000e0">
<a href="upgrade35.html">[3.4 -> 3.5]</a> |
<a href="upgrade36.html">[3.5 -> 3.6]</a> |
<a href="upgrade37.html">[3.6 -> 3.7]</a> |
<a href="upgrade38.html">[3.7 -> 3.8]</a> |
<a href="upgrade39.html">[3.8 -> 3.9]</a> |
<a href="upgrade40.html">[3.9 -> 4.0]</a> |
<br>
<a href="upgrade41.html">[4.0 -> 4.1]</a> |
<a href="upgrade42.html">[4.1 -> 4.2]</a> |
<a href="upgrade43.html">[4.2 -> 4.3]</a> |
<a href="upgrade44.html">[4.3 -> 4.4]</a> |
<a href="upgrade45.html">[4.4 -> 4.5]</a> |
<a href="upgrade46.html">[4.5 -> 4.6]</a> |
<br>
<a href="upgrade47.html">[4.6 -> 4.7]</a> |
<a href="upgrade48.html">[4.7 -> 4.8]</a> |
<a href="upgrade49.html">[4.8 -> 4.9]</a> |
<a href="upgrade50.html">[4.9 -> 5.0]</a> |
d24 3
a26 8
<a href="upgrade53.html">[5.2 -> 5.3]</a> |
<a href="index.html">[FAQ Index]</a>
</font>

<h1><font color="#e00000">
Upgrade Guide: 5.1 to 5.2
</font></h1>
<hr>
d76 1
a76 2
<a name="before"></a>
<h2>Before upgrading: things to think about and be aware of</h2>
d84 1
a84 2
<a name="raidframe"></a>
<li><b>raid(4) and RAIDframe are no more:</b>
d91 1
a91 2
<a name="radeon"></a>
<li><b>Radeon X driver changes:</b>
d124 1
a124 2
<a name="OpenSMTPd">
<li><b>OpenSMTPd changes:</b>
d134 1
a134 1
becomes 
d138 1
a138 1
<a href="http://man.openbsd.org/?query=smtpd.conf&sektion=5">smtpd.conf(5)</a>
d147 1
a147 2
<a name="pf">
<li><b>pf.conf syntax changes:</b>
d153 1
a153 1
<a href="http://man.openbsd.org/?query=pf.conf&sektion=5">pf.conf(5)</a>
d156 1
a156 2
<a name="tftpd"></a>
<li><b>tftpd starts from rc.d now:</b>
d167 1
a167 2
<a name="nginx"></a>
<li><b>Introducing nginx(8):</b>
d179 1
a179 2
<a name="upgrade"></a>
<h2>The upgrade process</h2>
d338 1
a338 2
<a name="final"></a>
<h2>Final steps</h2>
d350 1
a350 2
<a name="sysmerge"></a>
<h3>1a. Merging locally changed files via sysmerge(8)</h3>
d471 1
a471 2
<a name="patchfile"></a>
<h3>1b. Merging locally changed files via a patch file</h3>
d480 1
a480 2
<p>
<a name="UsersGroups"></a>
d611 1
a611 2
<a name="RmFiles"></a>
<h3>2. Files to delete</h3>
d629 1
a629 2
<a name="Kernchk"></a>
<h3>3. Checking the kernel</h3>
d643 1
a643 2
<a name="Pkgup"></a>
<h3>4. Upgrading packages</h3>
a657 1
<p>
a723 1

d725 1
a725 19
<font color="#0000e0">
<a href="upgrade35.html">[3.4 -> 3.5]</a> |
<a href="upgrade36.html">[3.5 -> 3.6]</a> |
<a href="upgrade37.html">[3.6 -> 3.7]</a> |
<a href="upgrade38.html">[3.7 -> 3.8]</a> |
<a href="upgrade39.html">[3.8 -> 3.9]</a> |
<a href="upgrade40.html">[3.9 -> 4.0]</a> |
<br>
<a href="upgrade41.html">[4.0 -> 4.1]</a> |
<a href="upgrade42.html">[4.1 -> 4.2]</a> |
<a href="upgrade43.html">[4.2 -> 4.3]</a> |
<a href="upgrade44.html">[4.3 -> 4.4]</a> |
<a href="upgrade45.html">[4.4 -> 4.5]</a> |
<a href="upgrade46.html">[4.5 -> 4.6]</a> |
<br>
<a href="upgrade47.html">[4.6 -> 4.7]</a> |
<a href="upgrade48.html">[4.7 -> 4.8]</a> |
<a href="upgrade49.html">[4.8 -> 4.9]</a> |
<a href="upgrade50.html">[4.9 -> 5.0]</a> |
d727 1
a727 3
<a href="upgrade52.html">[5.1 -> 5.2]</a> |
<a href="index.html">[FAQ Index]</a>
</font>
d733 1
a733 1
<small>$OpenBSD: upgrade52.html,v 1.21 2016/03/22 10:54:48 sthen Exp $</small>
@


1.21
log
@fix URIs, the / before querystring isn't optional, if it isn't fixed up
by the browser the server returns 400 Bad Request
@
text
@d8 2
d789 1
a789 1
<small>$OpenBSD: upgrade52.html,v 1.20 2016/03/21 05:46:21 beck Exp $</small>
@


1.20
log
@change http://www.openbsd.org/cgi-bin/man.cgi to be http://man.openbsd.org
this points stuff to the new place and gets us ready to deprecate the old
place we did this.
@
text
@d106 1
a106 1
<a href="http://man.openbsd.org?query=softraid&amp;sektion=4">softraid(4)</a>
d113 1
a113 1
<a href="http://man.openbsd.org?query=radeon">radeon(4)</a>
d117 1
a117 1
<a href="http://man.openbsd.org?query=radeonold">radeonold(4)</a>
d121 1
a121 1
<a href="http://man.openbsd.org?query=xorg.conf">xorg.conf(5)</a>
d159 1
a159 1
<a href="http://man.openbsd.org?query=smtpd.conf&sektion=5">smtpd.conf(5)</a>
d175 1
a175 1
<a href="http://man.openbsd.org?query=pf.conf&sektion=5">pf.conf(5)</a>
d181 1
a181 1
<a href="http://man.openbsd.org?query=tftpd&amp;sektion=8">tftpd(8)</a>
d183 1
a183 1
<a href="http://man.openbsd.org?query=inetd&amp;sektion=8">inetd(8)</a>
d193 1
a193 1
<a href="http://man.openbsd.org?query=nginx&amp;sektion=8">nginx(8)</a>)
d195 1
a195 1
<a href="http://man.openbsd.org?query=httpd&amp;sektion=8">httpd(8)</a>.
d241 1
a241 1
<a href="http://man.openbsd.org?query=sudo&amp;sektion=8">sudo(8)</a>
d246 1
a246 1
<a href="http://man.openbsd.org?query=ksh&amp;sektion=1">ksh(1)</a>
d323 1
a323 1
<a href="http://man.openbsd.org?query=tar&amp;sektion=1">tar(1)</a>
d352 1
a352 1
<a href="http://man.openbsd.org?query=MAKEDEV&amp;sektion=8&amp;arch=i386">MAKEDEV</a>
d372 1
a372 1
<a href="http://man.openbsd.org?query=sysmerge&amp;sektion=8">sysmerge(8)</a>
d412 1
a412 1
<a href="http://man.openbsd.org?query=sysmerge&amp;sektion=8">sysmerge(8)</a>
d428 1
a428 1
<a href="http://man.openbsd.org?query=sdiff&amp;sektion=1">sdiff</a>.
d432 1
a432 1
<a href="http://man.openbsd.org?query=sysmerge&amp;sektion=8">sysmerge(8)</a>
d435 2
a436 2
<a href="http://man.openbsd.org?query=diff&amp;sektion=1">diff(1)</a>,
<a href="http://man.openbsd.org?query=sdiff&amp;sektion=1">sdiff(1)</a>
d438 1
a438 1
<a href="http://man.openbsd.org?query=more&amp;sektion=1">more(1)</a>
d451 1
a451 1
<a href="http://man.openbsd.org?query=diff&amp;sektion=1">diff(1)</a>,
d453 1
a453 1
<a href="http://man.openbsd.org?query=more&amp;sektion=1">more(1)</a>)
d469 1
a469 1
<a href="http://man.openbsd.org?query=sdiff&amp;sektion=1">sdiff(1)</a>,
d478 1
a478 1
<a href="http://man.openbsd.org?query=daily&amp;sektion=8">daily(8)</a>
d625 1
a625 1
<a href="http://man.openbsd.org?query=newaliases&amp;sektion=8">newaliases(8)</a>
d627 1
a627 1
<a href="http://man.openbsd.org?query=mtree&amp;sektion=8">mtree(8)</a>
d752 1
a752 1
<a href="http://man.openbsd.org?query=pkg_add&amp;sektion=1&amp;manpath=OpenBSD+5.2">pkg_add(1)</a>
d787 1
a787 1
<small>$OpenBSD: upgrade52.html,v 1.19 2016/02/25 20:58:00 tj Exp $</small>
@


1.19
log
@old XXX comments in these files make it difficult to grep for things that
actually need to be fixed.
@
text
@d106 1
a106 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=softraid&amp;sektion=4">softraid(4)</a>
d113 1
a113 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=radeon">radeon(4)</a>
d117 1
a117 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=radeonold">radeonold(4)</a>
d121 1
a121 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xorg.conf">xorg.conf(5)</a>
d159 1
a159 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=smtpd.conf&sektion=5">smtpd.conf(5)</a>
d175 1
a175 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&sektion=5">pf.conf(5)</a>
d181 1
a181 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tftpd&amp;sektion=8">tftpd(8)</a>
d183 1
a183 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=inetd&amp;sektion=8">inetd(8)</a>
d193 1
a193 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=nginx&amp;sektion=8">nginx(8)</a>)
d195 1
a195 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=httpd&amp;sektion=8">httpd(8)</a>.
d241 1
a241 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sudo&amp;sektion=8">sudo(8)</a>
d246 1
a246 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ksh&amp;sektion=1">ksh(1)</a>
d323 1
a323 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tar&amp;sektion=1">tar(1)</a>
d352 1
a352 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=MAKEDEV&amp;sektion=8&amp;arch=i386">MAKEDEV</a>
d372 1
a372 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysmerge&amp;sektion=8">sysmerge(8)</a>
d412 1
a412 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysmerge&amp;sektion=8">sysmerge(8)</a>
d428 1
a428 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sdiff&amp;sektion=1">sdiff</a>.
d432 1
a432 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysmerge&amp;sektion=8">sysmerge(8)</a>
d435 2
a436 2
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=diff&amp;sektion=1">diff(1)</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sdiff&amp;sektion=1">sdiff(1)</a>
d438 1
a438 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=more&amp;sektion=1">more(1)</a>
d451 1
a451 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=diff&amp;sektion=1">diff(1)</a>,
d453 1
a453 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=more&amp;sektion=1">more(1)</a>)
d469 1
a469 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sdiff&amp;sektion=1">sdiff(1)</a>,
d478 1
a478 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=daily&amp;sektion=8">daily(8)</a>
d625 1
a625 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=newaliases&amp;sektion=8">newaliases(8)</a>
d627 1
a627 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mtree&amp;sektion=8">mtree(8)</a>
d752 1
a752 1
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pkg_add&amp;sektion=1&amp;manpath=OpenBSD+5.2">pkg_add(1)</a>
d787 1
a787 1
<small>$OpenBSD: upgrade52.html,v 1.18 2015/07/08 01:11:32 nick Exp $</small>
@


1.18
log
@
better pages <title>, better matching the page.  From Pavel Plamenov
(pvlplmnv at gmail), thanks!
@
text
@a605 1
<!-- XXX changes release to release -->
d787 1
a787 1
<small>$OpenBSD: upgrade52.html,v 1.17 2015/07/02 05:49:04 bentley Exp $</small>
@


1.17
log
@Clean up meta tags.

name=distribution, name=keywords, and name=resource-type have no effect
in modern search engines and just clutter up the page source.

From Pavel Plamenov.
@
text
@d4 1
a4 1
<title>OpenBSD Upgrade Guide 5.2</title>
d788 1
a788 1
<small>$OpenBSD: upgrade52.html,v 1.16 2015/05/11 11:18:30 sthen Exp $</small>
@


1.16
log
@Add 'link rel="canonical"' to pages, acting as a hint to search engines
to list the copies on www.openbsd.org rather than mirrors.

From Carlin Bingham, ok millert@@ nick@@
@
text
@a5 1
<meta name="resource-type" content="document">
a6 2
<meta name="keywords"      content="openbsd,faq,upgrade,5.2">
<meta name="distribution"  content="global">
d788 1
a788 1
<small>$OpenBSD: upgrade52.html,v 1.15 2014/10/22 17:26:39 nick Exp $</small>
@


1.15
log
@
duplicated duplicated word word which has been here for a while.
diff from Carlin Bingham (cb at viennan dot net), thanks!
@
text
@d11 1
d791 1
a791 1
<small>$OpenBSD: upgrade52.html,v 1.14 2014/03/31 01:47:54 nick Exp $</small>
@


1.14
log
@
www@@ is no more.  normalized 54 to new footer style, but rest were left
unchanged deliberately.
@
text
@a219 1
version
d790 1
a790 1
<small>$OpenBSD: upgrade52.html,v 1.13 2013/09/23 13:11:51 espie Exp $</small>
@


1.13
log
@pkg_add is interactive by default, say pkg_add -u instead of pkg_add -ui
@
text
@a4 1
<link rev="made" href="mailto:www@@openbsd.org">
a789 1
<a href="mailto:www@@openbsd.org">www@@openbsd.org</a>
d791 1
a791 1
<small>$OpenBSD: upgrade52.html,v 1.12 2013/05/01 13:18:27 nick Exp $</small>
@


1.12
log
@
5.3 updates
@
text
@d751 1
a751 1
<b>pkg_add -ui</b>
d754 2
a755 2
where the <tt>-u</tt> indicates update mode, and <tt>-i</tt> specifies
interactive mode, so pkg_add will prompt you for input when it encounters
d793 1
a793 1
<small>$OpenBSD: upgrade52.html,v 1.11 2012/11/06 15:00:27 sthen Exp $</small>
@


1.11
log
@Tell people following the non-recommended "untar on a running system"
instructions to disable pkg_scripts and rc.shutdown commands. It's unsafe
any time (so the instructions are made general), but in the 5.1->5.2
upgrade on i386 you're guaranteed problems at shutdown due to ld.so
changes if any dynamically linked binaries are run.  ok nick@@
@
text
@d39 1
d793 1
a793 1
<small>$OpenBSD: upgrade52.html,v 1.10 2012/11/05 03:13:21 nick Exp $</small>
@


1.10
log
@
another file to delete: /usr/rc.d/btd
@
text
@d262 12
d792 1
a792 1
<small>$OpenBSD: upgrade52.html,v 1.9 2012/11/02 01:48:14 nick Exp $</small>
@


1.9
log
@
i386ism slipped past original contributor and me, but spotted by Damien
Couderc (damien at petrocore dot eu).  fix ok naddy@@
@
text
@d642 1
d780 1
a780 1
<small>$OpenBSD: upgrade52.html,v 1.8 2012/11/01 23:23:28 nick Exp $</small>
@


1.8
log
@
more consistent formatting: no leading spaces in a <blockquote> and as
these are commands for the user to execute "as is", <b> </b> around 'em.
@
text
@d647 1
a647 1
rm -r /usr/lib/gcc-lib/i386-unknown-openbsd5.1</b>
d779 1
a779 1
<small>$OpenBSD: upgrade52.html,v 1.7 2012/10/27 15:37:14 rpe Exp $</small>
@


1.7
log
@talk about prio and tos options that are now part of the "set { }"
block

ok henning@@ nick@@
@
text
@d638 10
a647 10
    rm /usr/bin/lint
    rm /usr/libexec/lint[12]
    rm -r /usr/libdata/lint
    rm /usr/share/man/man1/lint.1
    rm /usr/sbin/pkg
    rm /sbin/raidctl
    rm /usr/share/man/man4/raid.4
    rm /usr/share/man/man8/raidctl.8
    rm /usr/libexec/tftpd
    rm -r /usr/lib/gcc-lib/i386-unknown-openbsd5.1
d779 1
a779 1
<small>$OpenBSD: upgrade52.html,v 1.6 2012/10/26 17:53:10 rpe Exp $</small>
@


1.6
log
@mention changed syntax vor makemap(8) virtual domains configuration

ok nick@@
@
text
@d78 1
d170 10
d779 1
a779 1
<small>$OpenBSD: upgrade52.html,v 1.5 2012/10/26 17:34:39 naddy Exp $</small>
@


1.5
log
@more old files to delete; ok nick@@
@
text
@d148 3
a150 2
<li><b>smtpd.conf syntax change:</b>
<tt>relay via</tt> rules should now be expressed with a relay URL:
d154 6
a159 1
The new relay URL syntax is documented in
d768 1
a768 1
<small>$OpenBSD: upgrade52.html,v 1.4 2012/10/24 01:07:11 nick Exp $</small>
@


1.4
log
@
Andrew dot daughertity at gmail spotted me misspelling "ultimately", and
made "patch file" two words while there.
@
text
@d621 5
d629 2
a630 2


d762 1
a762 1
<small>$OpenBSD: upgrade52.html,v 1.3 2012/10/23 06:17:49 rpe Exp $</small>
@


1.3
log
@don't mention kqemu anymore
it has been removed from ports in 2011

ok nick@@
@
text
@d179 1
a179 1
has been added to OpenBSD, utimately to replace the Apache 1.3 derived
d369 1
a369 1
may find the "patchfile" process faster, and perhaps the basis of
d374 1
a374 1
If you have a system that's been upgraded in the past via the patchfile
d461 1
a461 1
behavior.
d664 1
a664 1
behaviour with "svn diff | more" due to how I/O on file descriptors
d757 1
a757 1
<small>$OpenBSD: upgrade52.html,v 1.2 2012/10/22 11:19:06 nick Exp $</small>
@


1.2
log
@
typos, missed version numbers, and a couple things I won't try to explain.
From remco at d-compu dot dyndns dotorg, thanks!
@
text
@a658 4
<li><b>kqemu:</b> Must be kept in sync with the kernel. pkg_delete prior
to the upgrade, then pkg_add the new package once the upgrade has been
completed.

d757 1
a757 1
<small>$OpenBSD: upgrade52.html,v 1.1 2012/10/21 17:51:19 nick Exp $</small>
@


1.1
log
@
add 5.1 -> 5.2 upgrade notes
@
text
@d130 3
a132 1
Or merge this section in their existing <tt>/etc/X11/xorg.conf</tt> file.<br>
d393 1
a393 1
development process</a>, such as from an earlier <i>5.0-current</i> to
d417 1
a417 1
your $RELEASEPATH, run it with:
d420 1
a420 1
<b>sysmerge -s $RELEASEPATH/etc52.tgz -x $RELEASEPATH/xetc52.tgz</b>
d556 1
a556 1
etc/mail/smtdp.conf
d574 1
a574 1
them closely updated, or are upgrading from a snapshot of 5.0, they may
d594 1
a594 1
etc/ikedconf
d761 1
a761 1
<small>$OpenBSD: upgrade51.html,v 1.7 2012/05/01 15:17:56 jj Exp $</small>
@

