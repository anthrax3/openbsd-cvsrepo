head	1.2;
access;
symbols
	mesa-17_1_6:1.1.1.3
	OPENBSD_6_1:1.1.1.2.0.2
	OPENBSD_6_1_BASE:1.1.1.2
	mesa-13_0_6:1.1.1.2
	mesa-13_0_5:1.1.1.2
	mesa-13_0_3:1.1.1.2
	mesa-13_0_2:1.1.1.2
	OPENBSD_6_0:1.1.1.1.0.4
	OPENBSD_6_0_BASE:1.1.1.1
	mesa-11_2_2:1.1.1.1
	mesa:1.1.1;
locks; strict;
comment	@ * @;
expand	@o@;


1.2
date	2017.08.26.16.59.26;	author jsg;	state Exp;
branches;
next	1.1;
commitid	D0k2io1oY8gcsQ2S;

1.1
date	2016.05.29.10.20.44;	author jsg;	state Exp;
branches
	1.1.1.1;
next	;
commitid	OwGfrJACrYJkCVJ4;

1.1.1.1
date	2016.05.29.10.20.44;	author jsg;	state Exp;
branches;
next	1.1.1.2;
commitid	OwGfrJACrYJkCVJ4;

1.1.1.2
date	2016.12.11.08.30.20;	author jsg;	state Exp;
branches;
next	1.1.1.3;
commitid	uuv5VTS15jglEDZU;

1.1.1.3
date	2017.08.14.09.34.53;	author jsg;	state Exp;
branches;
next	;
commitid	enNyoMGkcgwM3Ww6;


desc
@@


1.2
log
@Revert to Mesa 13.0.6 to hopefully address rendering issues a handful of
people have reported with xpdf/fvwm on ivy bridge with modesetting driver.
@
text
@#ifndef __NVC0_QUERY_HW_SM_H__
#define __NVC0_QUERY_HW_SM_H__

#include "nvc0_query_hw.h"

struct nvc0_hw_sm_query {
   struct nvc0_hw_query base;
   uint8_t ctr[8];
};

static inline struct nvc0_hw_sm_query *
nvc0_hw_sm_query(struct nvc0_hw_query *hq)
{
   return (struct nvc0_hw_sm_query *)hq;
}

/*
 * Performance counter queries:
 */
#define NVC0_HW_SM_QUERY(i)    (PIPE_QUERY_DRIVER_SPECIFIC + (i))
#define NVC0_HW_SM_QUERY_LAST   NVC0_HW_SM_QUERY(NVC0_HW_SM_QUERY_COUNT - 1)
enum nvc0_hw_sm_queries
{
   NVC0_HW_SM_QUERY_ACTIVE_CYCLES = 0,
   NVC0_HW_SM_QUERY_ACTIVE_WARPS,
   NVC0_HW_SM_QUERY_ATOM_CAS_COUNT,
   NVC0_HW_SM_QUERY_ATOM_COUNT,
   NVC0_HW_SM_QUERY_BRANCH,
   NVC0_HW_SM_QUERY_DIVERGENT_BRANCH,
   NVC0_HW_SM_QUERY_GLD_REQUEST,
   NVC0_HW_SM_QUERY_GLD_MEM_DIV_REPLAY,
   NVC0_HW_SM_QUERY_GST_TRANSACTIONS,
   NVC0_HW_SM_QUERY_GST_MEM_DIV_REPLAY,
   NVC0_HW_SM_QUERY_GRED_COUNT,
   NVC0_HW_SM_QUERY_GST_REQUEST,
   NVC0_HW_SM_QUERY_INST_EXECUTED,
   NVC0_HW_SM_QUERY_INST_ISSUED,
   NVC0_HW_SM_QUERY_INST_ISSUED1,
   NVC0_HW_SM_QUERY_INST_ISSUED2,
   NVC0_HW_SM_QUERY_INST_ISSUED1_0,
   NVC0_HW_SM_QUERY_INST_ISSUED1_1,
   NVC0_HW_SM_QUERY_INST_ISSUED2_0,
   NVC0_HW_SM_QUERY_INST_ISSUED2_1,
   NVC0_HW_SM_QUERY_L1_GLD_HIT,
   NVC0_HW_SM_QUERY_L1_GLD_MISS,
   NVC0_HW_SM_QUERY_L1_GLD_TRANSACTIONS,
   NVC0_HW_SM_QUERY_L1_GST_TRANSACTIONS,
   NVC0_HW_SM_QUERY_L1_LOCAL_LD_HIT,
   NVC0_HW_SM_QUERY_L1_LOCAL_LD_MISS,
   NVC0_HW_SM_QUERY_L1_LOCAL_ST_HIT,
   NVC0_HW_SM_QUERY_L1_LOCAL_ST_MISS,
   NVC0_HW_SM_QUERY_L1_SHARED_LD_TRANSACTIONS,
   NVC0_HW_SM_QUERY_L1_SHARED_ST_TRANSACTIONS,
   NVC0_HW_SM_QUERY_LOCAL_LD,
   NVC0_HW_SM_QUERY_LOCAL_LD_TRANSACTIONS,
   NVC0_HW_SM_QUERY_LOCAL_ST,
   NVC0_HW_SM_QUERY_LOCAL_ST_TRANSACTIONS,
   NVC0_HW_SM_QUERY_NOT_PRED_OFF_INST_EXECUTED,
   NVC0_HW_SM_QUERY_PROF_TRIGGER_0,
   NVC0_HW_SM_QUERY_PROF_TRIGGER_1,
   NVC0_HW_SM_QUERY_PROF_TRIGGER_2,
   NVC0_HW_SM_QUERY_PROF_TRIGGER_3,
   NVC0_HW_SM_QUERY_PROF_TRIGGER_4,
   NVC0_HW_SM_QUERY_PROF_TRIGGER_5,
   NVC0_HW_SM_QUERY_PROF_TRIGGER_6,
   NVC0_HW_SM_QUERY_PROF_TRIGGER_7,
   NVC0_HW_SM_QUERY_SHARED_LD,
   NVC0_HW_SM_QUERY_SHARED_LD_REPLAY,
   NVC0_HW_SM_QUERY_SHARED_ST,
   NVC0_HW_SM_QUERY_SHARED_ST_REPLAY,
   NVC0_HW_SM_QUERY_SM_CTA_LAUNCHED,
   NVC0_HW_SM_QUERY_THREADS_LAUNCHED,
   NVC0_HW_SM_QUERY_TH_INST_EXECUTED,
   NVC0_HW_SM_QUERY_TH_INST_EXECUTED_0,
   NVC0_HW_SM_QUERY_TH_INST_EXECUTED_1,
   NVC0_HW_SM_QUERY_TH_INST_EXECUTED_2,
   NVC0_HW_SM_QUERY_TH_INST_EXECUTED_3,
   NVC0_HW_SM_QUERY_UNCACHED_GLD_TRANSACTIONS,
   NVC0_HW_SM_QUERY_WARPS_LAUNCHED,
   NVC0_HW_SM_QUERY_COUNT
};

struct nvc0_hw_query *
nvc0_hw_sm_create_query(struct nvc0_context *, unsigned);
int
nvc0_hw_sm_get_driver_query_info(struct nvc0_screen *, unsigned,
                                 struct pipe_driver_query_info *);
unsigned
nvc0_hw_sm_get_num_queries(struct nvc0_screen *);

#endif
@


1.1
log
@Initial revision
@
text
@d20 1
a20 53
#define NVE4_HW_SM_QUERY(i)    (PIPE_QUERY_DRIVER_SPECIFIC + (i))
#define NVE4_HW_SM_QUERY_LAST   NVE4_HW_SM_QUERY(NVE4_HW_SM_QUERY_COUNT - 1)
enum nve4_hw_sm_queries
{
   NVE4_HW_SM_QUERY_ACTIVE_CYCLES = 0,
   NVE4_HW_SM_QUERY_ACTIVE_WARPS,
   NVE4_HW_SM_QUERY_ATOM_CAS_COUNT,
   NVE4_HW_SM_QUERY_ATOM_COUNT,
   NVE4_HW_SM_QUERY_BRANCH,
   NVE4_HW_SM_QUERY_DIVERGENT_BRANCH,
   NVE4_HW_SM_QUERY_GLD_REQUEST,
   NVE4_HW_SM_QUERY_GLD_MEM_DIV_REPLAY,
   NVE4_HW_SM_QUERY_GST_TRANSACTIONS,
   NVE4_HW_SM_QUERY_GST_MEM_DIV_REPLAY,
   NVE4_HW_SM_QUERY_GRED_COUNT,
   NVE4_HW_SM_QUERY_GST_REQUEST,
   NVE4_HW_SM_QUERY_INST_EXECUTED,
   NVE4_HW_SM_QUERY_INST_ISSUED1,
   NVE4_HW_SM_QUERY_INST_ISSUED2,
   NVE4_HW_SM_QUERY_L1_GLD_HIT,
   NVE4_HW_SM_QUERY_L1_GLD_MISS,
   NVE4_HW_SM_QUERY_L1_GLD_TRANSACTIONS,
   NVE4_HW_SM_QUERY_L1_GST_TRANSACTIONS,
   NVE4_HW_SM_QUERY_L1_LOCAL_LD_HIT,
   NVE4_HW_SM_QUERY_L1_LOCAL_LD_MISS,
   NVE4_HW_SM_QUERY_L1_LOCAL_ST_HIT,
   NVE4_HW_SM_QUERY_L1_LOCAL_ST_MISS,
   NVE4_HW_SM_QUERY_L1_SHARED_LD_TRANSACTIONS,
   NVE4_HW_SM_QUERY_L1_SHARED_ST_TRANSACTIONS,
   NVE4_HW_SM_QUERY_LOCAL_LD,
   NVE4_HW_SM_QUERY_LOCAL_LD_TRANSACTIONS,
   NVE4_HW_SM_QUERY_LOCAL_ST,
   NVE4_HW_SM_QUERY_LOCAL_ST_TRANSACTIONS,
   NVE4_HW_SM_QUERY_PROF_TRIGGER_0,
   NVE4_HW_SM_QUERY_PROF_TRIGGER_1,
   NVE4_HW_SM_QUERY_PROF_TRIGGER_2,
   NVE4_HW_SM_QUERY_PROF_TRIGGER_3,
   NVE4_HW_SM_QUERY_PROF_TRIGGER_4,
   NVE4_HW_SM_QUERY_PROF_TRIGGER_5,
   NVE4_HW_SM_QUERY_PROF_TRIGGER_6,
   NVE4_HW_SM_QUERY_PROF_TRIGGER_7,
   NVE4_HW_SM_QUERY_SHARED_LD,
   NVE4_HW_SM_QUERY_SHARED_LD_REPLAY,
   NVE4_HW_SM_QUERY_SHARED_ST,
   NVE4_HW_SM_QUERY_SHARED_ST_REPLAY,
   NVE4_HW_SM_QUERY_SM_CTA_LAUNCHED,
   NVE4_HW_SM_QUERY_THREADS_LAUNCHED,
   NVE4_HW_SM_QUERY_UNCACHED_GLD_TRANSACTIONS,
   NVE4_HW_SM_QUERY_WARPS_LAUNCHED,
   NVE4_HW_SM_QUERY_COUNT
};

#define NVC0_HW_SM_QUERY(i)    (PIPE_QUERY_DRIVER_SPECIFIC + 2048 + (i))
d26 1
d31 3
d38 2
d44 10
d55 1
d57 2
d68 1
d70 2
d73 1
d78 1
d88 3
@


1.1.1.1
log
@Import Mesa 11.2.2
@
text
@@


1.1.1.2
log
@Import Mesa 13.0.2
@
text
@d20 53
a72 1
#define NVC0_HW_SM_QUERY(i)    (PIPE_QUERY_DRIVER_SPECIFIC + (i))
a77 1
   NVC0_HW_SM_QUERY_ATOM_CAS_COUNT,
a81 3
   NVC0_HW_SM_QUERY_GLD_MEM_DIV_REPLAY,
   NVC0_HW_SM_QUERY_GST_TRANSACTIONS,
   NVC0_HW_SM_QUERY_GST_MEM_DIV_REPLAY,
a85 2
   NVC0_HW_SM_QUERY_INST_ISSUED1,
   NVC0_HW_SM_QUERY_INST_ISSUED2,
a89 10
   NVC0_HW_SM_QUERY_L1_GLD_HIT,
   NVC0_HW_SM_QUERY_L1_GLD_MISS,
   NVC0_HW_SM_QUERY_L1_GLD_TRANSACTIONS,
   NVC0_HW_SM_QUERY_L1_GST_TRANSACTIONS,
   NVC0_HW_SM_QUERY_L1_LOCAL_LD_HIT,
   NVC0_HW_SM_QUERY_L1_LOCAL_LD_MISS,
   NVC0_HW_SM_QUERY_L1_LOCAL_ST_HIT,
   NVC0_HW_SM_QUERY_L1_LOCAL_ST_MISS,
   NVC0_HW_SM_QUERY_L1_SHARED_LD_TRANSACTIONS,
   NVC0_HW_SM_QUERY_L1_SHARED_ST_TRANSACTIONS,
a90 1
   NVC0_HW_SM_QUERY_LOCAL_LD_TRANSACTIONS,
a91 2
   NVC0_HW_SM_QUERY_LOCAL_ST_TRANSACTIONS,
   NVC0_HW_SM_QUERY_NOT_PRED_OFF_INST_EXECUTED,
a100 1
   NVC0_HW_SM_QUERY_SHARED_LD_REPLAY,
a101 2
   NVC0_HW_SM_QUERY_SHARED_ST_REPLAY,
   NVC0_HW_SM_QUERY_SM_CTA_LAUNCHED,
a102 1
   NVC0_HW_SM_QUERY_TH_INST_EXECUTED,
a106 1
   NVC0_HW_SM_QUERY_UNCACHED_GLD_TRANSACTIONS,
a115 3
unsigned
nvc0_hw_sm_get_num_queries(struct nvc0_screen *);

@


1.1.1.3
log
@Import Mesa 17.1.6
@
text
@d24 1
a24 2
   NVC0_HW_SM_QUERY_ACTIVE_CTAS = 0,
   NVC0_HW_SM_QUERY_ACTIVE_CYCLES,
a31 3
   NVC0_HW_SM_QUERY_GLOBAL_ATOM_CAS,
   NVC0_HW_SM_QUERY_GLOBAL_LD,
   NVC0_HW_SM_QUERY_GLOBAL_ST,
a37 1
   NVC0_HW_SM_QUERY_INST_ISSUED0,
a66 2
   NVC0_HW_SM_QUERY_SHARED_ATOM,
   NVC0_HW_SM_QUERY_SHARED_ATOM_CAS,
a67 1
   NVC0_HW_SM_QUERY_SHARED_LD_BANK_CONFLICT,
a68 1
   NVC0_HW_SM_QUERY_SHARED_LD_TRANSACTIONS,
a69 1
   NVC0_HW_SM_QUERY_SHARED_ST_BANK_CONFLICT,
a70 1
   NVC0_HW_SM_QUERY_SHARED_ST_TRANSACTIONS,
@


