head	1.19;
access;
symbols
	OPENBSD_6_0:1.18.0.6
	OPENBSD_6_0_BASE:1.18
	OPENBSD_5_9:1.18.0.4
	OPENBSD_5_9_BASE:1.18
	OPENBSD_5_8:1.18.0.2
	OPENBSD_5_8_BASE:1.18
	OPENBSD_5_7:1.17.0.6
	OPENBSD_5_7_BASE:1.17
	OPENBSD_5_6:1.17.0.4
	OPENBSD_5_6_BASE:1.17
	OPENBSD_5_5:1.17.0.2
	OPENBSD_5_5_BASE:1.17
	OPENBSD_5_4:1.15.0.4
	OPENBSD_5_4_BASE:1.15
	OPENBSD_5_3:1.15.0.2
	OPENBSD_5_3_BASE:1.15
	OPENBSD_5_2:1.14.0.2
	OPENBSD_5_2_BASE:1.14
	OPENBSD_5_1_BASE:1.12
	OPENBSD_5_1:1.12.0.2
	OPENBSD_5_0:1.10.0.2
	OPENBSD_5_0_BASE:1.10
	OPENBSD_4_9:1.7.0.2
	OPENBSD_4_9_BASE:1.7
	OPENBSD_4_8:1.6.0.4
	OPENBSD_4_8_BASE:1.6
	OPENBSD_4_7:1.5.0.2
	OPENBSD_4_7_BASE:1.5
	OPENBSD_4_6:1.4.0.4
	OPENBSD_4_6_BASE:1.4
	OPENBSD_4_5:1.4.0.2
	OPENBSD_4_5_BASE:1.4;
locks; strict;
comment	@# @;


1.19
date	2016.07.30.12.18.35;	author matthieu;	state dead;
branches;
next	1.18;
commitid	UJ4wwOuSgp5NvvWe;

1.18
date	2015.06.27.21.50.55;	author miod;	state Exp;
branches;
next	1.17;
commitid	4J0vVo1QeS1OB0ic;

1.17
date	2014.02.07.19.40.52;	author bcallah;	state Exp;
branches;
next	1.16;

1.16
date	2013.08.17.17.03.26;	author bcallah;	state Exp;
branches;
next	1.15;

1.15
date	2012.08.08.21.54.33;	author matthieu;	state Exp;
branches;
next	1.14;

1.14
date	2012.06.10.13.21.32;	author matthieu;	state Exp;
branches;
next	1.13;

1.13
date	2012.03.10.18.35.56;	author matthieu;	state Exp;
branches;
next	1.12;

1.12
date	2011.09.17.13.39.31;	author shadchin;	state Exp;
branches;
next	1.11;

1.11
date	2011.08.30.21.15.30;	author matthieu;	state Exp;
branches;
next	1.10;

1.10
date	2011.05.30.10.52.58;	author shadchin;	state Exp;
branches;
next	1.9;

1.9
date	2011.04.27.20.58.34;	author matthieu;	state Exp;
branches;
next	1.8;

1.8
date	2011.03.08.07.59.23;	author matthieu;	state Exp;
branches;
next	1.7;

1.7
date	2011.01.02.14.23.40;	author matthieu;	state Exp;
branches;
next	1.6;

1.6
date	2010.07.31.07.40.58;	author matthieu;	state Exp;
branches;
next	1.5;

1.5
date	2009.10.03.09.58.38;	author matthieu;	state Exp;
branches;
next	1.4;

1.4
date	2009.01.28.22.16.07;	author matthieu;	state Exp;
branches;
next	1.3;

1.3
date	2009.01.28.14.51.56;	author matthieu;	state Exp;
branches;
next	1.2;

1.2
date	2009.01.27.17.18.26;	author matthieu;	state Exp;
branches;
next	1.1;

1.1
date	2008.08.21.05.48.42;	author matthieu;	state Exp;
branches;
next	;


desc
@@


1.19
log
@Merge the build of Xephyr in the main xserver build.

Recent X server doesn't require to build the DIX with different
options for xfree86 and kdrive.

Tested for beeing a no-op on m88k by Kenji Aoyama. Thanks
@
text
@# $OpenBSD: Makefile.bsd-wrapper,v 1.18 2015/06/27 21:50:55 miod Exp $

.include <bsd.xconf.mk>

_SRCDIR= ${.CURDIR}/../xserver
NO_REORDER=yes

XKB_PATH=	${X11BASE}/share/X11/xkb
XKB_RULES=	base

CONFIGURE_ARGS=	--localstatedir=/var --sysconfdir=/etc/X11 \
		--with-xkb-path=${XKB_PATH} \
		--with-xkb-output=/var/db/xkb \
		--with-default-xkb-rules=${XKB_RULES} \
		--disable-xorg \
		--enable-xcsecurity \
		--enable-kdrive \
		--disable-dmx \
		--disable-xnest \
		--disable-xvfb \
		--without-fop --without-xmlto --without-xsltproc

realinstall:
	(cd hw/kdrive/ephyr ; make install)

.if ${MACHINE_CPU} == "mips64"
# disable cache file, because the compiler flags will not match
CONFIGURE_ARGS+=	--cache-file=/dev/null
CFLAGS+=	-Wa,-xgot
.endif

.include <bsd.xorg.mk>
@


1.18
log
@Build the Xserver with large got (-xgot as(1) option) on mips; needed to
accomodate the growth of recent changes. Tested on loongson.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.bsd-wrapper,v 1.17 2014/02/07 19:40:52 bcallah Exp $
@


1.17
log
@We're no longer building this on octeon.
"Sure!" miod@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.bsd-wrapper,v 1.16 2013/08/17 17:03:26 bcallah Exp $
d25 6
@


1.16
log
@Octeon needs CONFIGURE_FLAGS+=--disable-glx to avoid a configure error.
ok matthieu@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.bsd-wrapper,v 1.15 2012/08/08 21:54:33 matthieu Exp $
a21 4

.if ${MACHINE} == "octeon"
CONFIGURE_ARGS+=--disable-glx
.endif
@


1.15
log
@Don't touch the xserver autotools files a 2nd time in kdrive.
This causes a rebuild of xserver during make release (configure
becomes more recent than config.status again).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.bsd-wrapper,v 1.14 2012/06/10 13:21:32 matthieu Exp $
d22 4
@


1.14
log
@Update to xserver 1.12.2. tested by naddy@@, krw@@, mpi@@.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.bsd-wrapper,v 1.13 2012/03/10 18:35:56 matthieu Exp $
d6 1
@


1.13
log
@Disable doc formatting tools explicitely
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.bsd-wrapper,v 1.12 2011/09/17 13:39:31 shadchin Exp $
a13 1
		--enable-dri \
@


1.12
log
@Cleaning of current solution for 'Kill X on Ctrl+Alt+Backspace on default'

ok matthieu@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.bsd-wrapper,v 1.11 2011/08/30 21:15:30 matthieu Exp $
a13 1
		--with-dri-driver-path=${LIBDIR}/modules/dri \
d20 2
a21 1
		--disable-xvfb
@


1.11
log
@Switch to xkeyboard-config is done. Remove old xkbdata and unifdef it.
ok shadchin@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.bsd-wrapper,v 1.10 2011/05/30 10:52:58 shadchin Exp $
a8 1
XKB_OPTIONS=	terminate:ctrl_alt_bksp
a13 1
		--with-default-xkb-options=${XKB_OPTIONS} \
@


1.10
log
@If you do not have XkbOptions in xorg.conf, it is automatically set to
"terminate: ctrl_alt_bksp" (only if XENOCARA_USE_XKEYBOARD_CONFIG=Yes)

tested ajacoutot@@, ok matthieu@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.bsd-wrapper,v 1.9 2011/04/27 20:58:34 matthieu Exp $
a6 1
.if ${XENOCARA_USE_XKEYBOARD_CONFIG:L} == "yes"
a9 5
.else
XKB_PATH=	/etc/X11/xkb
XKB_RULES=	xorg
XKB_OPTIONS=
.endif
@


1.9
log
@Enable X-ACE and XC-SECURITY on kdrive (Xephyr)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.bsd-wrapper,v 1.8 2011/03/08 07:59:23 matthieu Exp $
d10 1
d14 1
d21 1
@


1.8
log
@add a new build switch 'XENOCARA_USE_XKEYBOARD_CONFIG' to enable
the use of xkeyboard-config xkb definitions instead of the old xkbdata.
This will make testing easier. No changes in default builds.
ok shadchin@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.bsd-wrapper,v 1.7 2011/01/02 14:23:40 matthieu Exp $
d22 1
a22 1
		--disable-xace \
@


1.7
log
@Specify default xkb rules for Xnest and Xephyr.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.bsd-wrapper,v 1.6 2010/07/31 07:40:58 matthieu Exp $
d7 8
d16 1
a16 1
		--with-xkb-path=/etc/X11/xkb \
d18 1
a18 1
		--with-default-xkb-rules=xorg \
@


1.6
log
@Disable XACE in kdrive too.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.bsd-wrapper,v 1.5 2009/10/03 09:58:38 matthieu Exp $
d10 1
@


1.5
log
@--disable-xinput and --disable-xprint are not valid configure options
anymore in xserver 1.6.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.bsd-wrapper,v 1.4 2009/01/28 22:16:07 matthieu Exp $
d13 1
@


1.4
log
@Install Xephyr and its manual page using the Makefile generated by
autotools.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.bsd-wrapper,v 1.3 2009/01/28 14:51:56 matthieu Exp $
a12 1
		--disable-xinput \
a14 1
		--disable-xprint \
@


1.3
log
@Pass all needed options to configure to get kdrive use the
same default directories as Xorg.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.bsd-wrapper,v 1.2 2009/01/27 17:18:26 matthieu Exp $
d21 1
a21 1
	${INSTALL} -c -m 755 hw/kdrive/ephyr/Xephyr ${DESDIR}${BINDIR}
@


1.2
log
@Xephyr requires dri support for now, so enable it.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.bsd-wrapper,v 1.1 2008/08/21 05:48:42 matthieu Exp $
d8 4
d18 1
a18 2
		--disable-xvfb \
		--enable-dri
@


1.1
log
@Add a way to build kdrive-based X servers in a separate directory,
to make it possible to build them at the same time as Xorg.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile.bsd-wrapper,v 1.22 2008/05/24 20:36:04 matthieu Exp $
d14 2
a15 1
		--disable-xvfb
@

