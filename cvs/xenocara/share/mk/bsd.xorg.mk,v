head	1.61;
access;
symbols
	OPENBSD_6_2:1.61.0.2
	OPENBSD_6_2_BASE:1.61
	OPENBSD_6_1:1.59.0.2
	OPENBSD_6_1_BASE:1.59
	OPENBSD_6_0:1.53.0.2
	OPENBSD_6_0_BASE:1.53
	OPENBSD_5_9:1.51.0.6
	OPENBSD_5_9_BASE:1.51
	OPENBSD_5_8:1.51.0.4
	OPENBSD_5_8_BASE:1.51
	OPENBSD_5_7:1.51.0.2
	OPENBSD_5_7_BASE:1.51
	OPENBSD_5_6:1.50.0.2
	OPENBSD_5_6_BASE:1.50
	OPENBSD_5_5:1.49.0.2
	OPENBSD_5_5_BASE:1.49
	OPENBSD_5_4:1.48.0.2
	OPENBSD_5_4_BASE:1.48
	OPENBSD_5_3:1.47.0.2
	OPENBSD_5_3_BASE:1.47
	OPENBSD_5_2:1.41.0.2
	OPENBSD_5_2_BASE:1.41
	OPENBSD_5_1_BASE:1.40
	OPENBSD_5_1:1.40.0.2
	OPENBSD_5_0:1.39.0.2
	OPENBSD_5_0_BASE:1.39
	OPENBSD_4_9:1.36.0.2
	OPENBSD_4_9_BASE:1.36
	OPENBSD_4_8:1.36.0.4
	OPENBSD_4_8_BASE:1.36
	OPENBSD_4_7:1.33.0.2
	OPENBSD_4_7_BASE:1.33
	OPENBSD_4_6:1.32.0.2
	OPENBSD_4_6_BASE:1.32
	OPENBSD_4_5:1.26.0.2
	OPENBSD_4_5_BASE:1.26
	OPENBSD_4_4:1.25.0.2
	OPENBSD_4_4_BASE:1.25
	OPENBSD_4_3_BASE:1.23
	OPENBSD_4_3:1.23.0.2
	OPENBSD_4_2:1.20.0.2
	OPENBSD_4_2_BASE:1.20
	v0_1:1.1.1.1
	xenocara:1.1.1;
locks; strict;
comment	@# @;


1.61
date	2017.07.02.09.53.05;	author espie;	state Exp;
branches;
next	1.60;
commitid	gQV6yDUO5LeashZz;

1.60
date	2017.04.16.09.58.50;	author robert;	state Exp;
branches;
next	1.59;
commitid	dCkyk8egzYXrtpif;

1.59
date	2017.03.07.21.35.58;	author naddy;	state Exp;
branches;
next	1.58;
commitid	Wp4ii9f6LUnyAnI9;

1.58
date	2017.02.12.18.19.54;	author matthieu;	state Exp;
branches;
next	1.57;
commitid	scwWtfiEx8FezLCl;

1.57
date	2016.11.19.14.22.05;	author tb;	state Exp;
branches;
next	1.56;
commitid	0ACu8WF2n8D09TYK;

1.56
date	2016.10.14.10.14.00;	author natano;	state Exp;
branches;
next	1.55;
commitid	vTNBawggvF7KQxhd;

1.55
date	2016.10.11.22.36.53;	author matthieu;	state Exp;
branches;
next	1.54;
commitid	4iNgGRtrZwUo3L7t;

1.54
date	2016.10.10.13.34.43;	author matthieu;	state Exp;
branches;
next	1.53;
commitid	EkQV3yf9tZSpUgE4;

1.53
date	2016.03.28.11.59.06;	author matthieu;	state Exp;
branches;
next	1.52;
commitid	hx1fNzI2WMmhyQN5;

1.52
date	2016.03.28.11.58.22;	author matthieu;	state Exp;
branches;
next	1.51;
commitid	3mLgrzTvR9ld70m7;

1.51
date	2014.08.24.15.53.08;	author matthieu;	state Exp;
branches;
next	1.50;
commitid	U54asZSEhR82sPBl;

1.50
date	2014.05.18.10.29.01;	author matthieu;	state Exp;
branches;
next	1.49;

1.49
date	2013.11.22.15.44.48;	author espie;	state Exp;
branches;
next	1.48;

1.48
date	2013.04.14.19.57.40;	author matthieu;	state Exp;
branches;
next	1.47;

1.47
date	2012.11.03.15.19.02;	author espie;	state Exp;
branches;
next	1.46;

1.46
date	2012.10.11.16.57.57;	author espie;	state Exp;
branches;
next	1.45;

1.45
date	2012.08.21.20.18.48;	author espie;	state Exp;
branches;
next	1.44;

1.44
date	2012.08.08.21.54.33;	author matthieu;	state Exp;
branches;
next	1.43;

1.43
date	2012.08.05.18.08.05;	author matthieu;	state Exp;
branches;
next	1.42;

1.42
date	2012.08.04.17.10.01;	author matthieu;	state Exp;
branches;
next	1.41;

1.41
date	2012.03.11.10.08.59;	author matthieu;	state Exp;
branches;
next	1.40;

1.40
date	2011.11.05.11.49.01;	author matthieu;	state Exp;
branches;
next	1.39;

1.39
date	2011.06.23.22.49.00;	author naddy;	state Exp;
branches;
next	1.38;

1.38
date	2011.06.02.19.47.33;	author matthieu;	state Exp;
branches;
next	1.37;

1.37
date	2011.06.02.17.01.59;	author matthieu;	state Exp;
branches;
next	1.36;

1.36
date	2010.08.04.22.56.00;	author espie;	state Exp;
branches;
next	1.35;

1.35
date	2010.08.04.22.50.51;	author espie;	state Exp;
branches;
next	1.34;

1.34
date	2010.05.08.10.32.12;	author matthieu;	state Exp;
branches;
next	1.33;

1.33
date	2010.01.17.20.48.49;	author matthieu;	state Exp;
branches;
next	1.32;

1.32
date	2009.05.22.15.46.13;	author matthieu;	state Exp;
branches;
next	1.31;

1.31
date	2009.05.22.15.34.15;	author matthieu;	state Exp;
branches;
next	1.30;

1.30
date	2009.05.22.15.21.21;	author matthieu;	state Exp;
branches;
next	1.29;

1.29
date	2009.05.22.15.09.28;	author matthieu;	state Exp;
branches;
next	1.28;

1.28
date	2009.05.22.15.03.03;	author matthieu;	state Exp;
branches;
next	1.27;

1.27
date	2009.05.02.13.51.29;	author matthieu;	state Exp;
branches;
next	1.26;

1.26
date	2008.08.21.05.54.41;	author matthieu;	state Exp;
branches;
next	1.25;

1.25
date	2008.05.11.20.58.10;	author matthieu;	state Exp;
branches;
next	1.24;

1.24
date	2008.03.25.23.28.19;	author matthieu;	state Exp;
branches;
next	1.23;

1.23
date	2008.03.03.07.01.44;	author matthieu;	state Exp;
branches;
next	1.22;

1.22
date	2007.11.25.10.23.01;	author matthieu;	state Exp;
branches;
next	1.21;

1.21
date	2007.11.05.16.51.37;	author espie;	state Exp;
branches;
next	1.20;

1.20
date	2007.05.01.08.31.47;	author espie;	state Exp;
branches;
next	1.19;

1.19
date	2007.03.31.20.25.53;	author matthieu;	state Exp;
branches;
next	1.18;

1.18
date	2007.03.30.17.24.12;	author aanriot;	state Exp;
branches;
next	1.17;

1.17
date	2007.03.30.07.11.06;	author espie;	state Exp;
branches;
next	1.16;

1.16
date	2007.03.28.19.38.57;	author matthieu;	state Exp;
branches;
next	1.15;

1.15
date	2007.03.25.16.52.54;	author matthieu;	state Exp;
branches;
next	1.14;

1.14
date	2007.03.18.10.27.58;	author matthieu;	state Exp;
branches;
next	1.13;

1.13
date	2007.03.17.19.32.41;	author matthieu;	state Exp;
branches;
next	1.12;

1.12
date	2007.02.04.23.15.27;	author matthieu;	state Exp;
branches;
next	1.11;

1.11
date	2006.12.31.16.00.03;	author matthieu;	state Exp;
branches;
next	1.10;

1.10
date	2006.12.31.10.55.41;	author matthieu;	state Exp;
branches;
next	1.9;

1.9
date	2006.12.17.20.41.36;	author matthieu;	state Exp;
branches;
next	1.8;

1.8
date	2006.12.02.16.28.48;	author matthieu;	state Exp;
branches;
next	1.7;

1.7
date	2006.11.29.21.51.46;	author matthieu;	state Exp;
branches;
next	1.6;

1.6
date	2006.11.28.13.43.46;	author matthieu;	state Exp;
branches;
next	1.5;

1.5
date	2006.11.27.12.03.10;	author matthieu;	state Exp;
branches;
next	1.4;

1.4
date	2006.11.26.13.54.48;	author matthieu;	state Exp;
branches;
next	1.3;

1.3
date	2006.11.26.13.53.45;	author matthieu;	state Exp;
branches;
next	1.2;

1.2
date	2006.11.26.12.58.32;	author matthieu;	state Exp;
branches;
next	1.1;

1.1
date	2006.11.25.14.56.32;	author matthieu;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2006.11.25.14.56.32;	author matthieu;	state Exp;
branches;
next	;


desc
@@


1.61
log
@xenocara is the first tree to zap 'make depend'!

okay matthieu@@
@
text
@# $OpenBSD: bsd.xorg.mk,v 1.60 2017/04/16 09:58:50 robert Exp $ -*- makefile  -*-
#
# Copyright © 2006,2012 Matthieu Herrb
#
# Permission to use, copy, modify, and distribute this software for any
# purpose with or without fee is hereby granted, provided that the above
# copyright notice and this permission notice appear in all copies.
#
# THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
# WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
# MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
# ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
# WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
# ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
# OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
#

.if exists(${.CURDIR}/../Makefile.inc)
.include "${.CURDIR}/../Makefile.inc"
.endif

AUTOMAKE_VERSION=	1.12
AUTOCONF_VERSION=	2.69
PYTHON_VERSION=		2.7

# Where source lives
XSRCDIR?=		/usr/xenocara

# Where to build
XOBJDIR?=	/usr/xobj

# Where to install
BINDIR?=		${X11BASE}/bin
LIBDIR=			${X11BASE}/lib
INCSDIR=		${X11BASE}/include
MANDIR=			${X11BASE}/man/man

PKG_CONFIG_LIBDIR=	/usr/lib/pkgconfig:${X11BASE}/lib/pkgconfig

# A few aliases for *-install targets
INSTALL_DATA = \
	${INSTALL} ${INSTALL_COPY} -o ${BINOWN} -g ${BINGRP} -m ${SHAREMODE}

# Autoconf cache
_cache= --cache-file=${XOBJDIR}/xorg-config.cache.${MACHINE}

CFLAGS+=	$(COPTS)

.if !defined(CONFIG_SITE)
CONFIG_SITE=	${XSRCDIR}/etc/config.site
.endif

_SRCDIR?=	${.CURDIR}

XENOCARA_PATH?=	/bin:/sbin:/usr/bin:/usr/sbin:/usr/X11R6/bin

CONFIGURE_ENV=	PKG_CONFIG_LIBDIR="$(PKG_CONFIG_LIBDIR)" \
		CONFIG_SITE=$(CONFIG_SITE) \
		CC="$(CC)" \
		CFLAGS="$(CFLAGS:C/ *$//)" \
		CXX="$(CXX)" \
		CXXFLAGS="$(CXXFLAGS:C/ *$//)" \
		AR_FLAGS="cruD" \
		MAKE="${MAKE}"

CONFIGURE_ARGS+= --disable-silent-rules

AUTOTOOLS_ENV=  AUTOMAKE_VERSION="$(AUTOMAKE_VERSION)" \
		AUTOCONF_VERSION="$(AUTOCONF_VERSION)" \
		ACLOCAL="aclocal -I ${X11BASE}/share/aclocal" \
		$(CONFIGURE_ENV)

##
## Default rules
##

# pkgconfig
.if defined(PKGCONFIG)

PACKAGE_VERSION ?= `m4 ${DESTDIR}${X11BASE}/share/mk/package_version.m4 ${_SRCDIR}/configure.ac`

all: ${PKGCONFIG}

${PKGCONFIG}: ${PKGCONFIG}.in
	@@sed -e 's#@@prefix@@#${X11BASE}#g' \
	    -e 's#@@datarootdir@@#$${prefix}/share#g' \
	    -e 's#@@datadir@@#$${datarootdir}#g' \
	    -e 's#@@exec_prefix@@#$${prefix}#g' \
	    -e 's#@@libdir@@#$${exec_prefix}/lib#g' \
	    -e 's#@@includedir@@#$${prefix}/include#g' \
	    -e 's#@@PACKAGE_VERSION@@#'${PACKAGE_VERSION}'#g' \
	    ${EXTRA_PKGCONFIG_SUBST} \
	< $? > $@@

install-pc: ${PKGCONFIG}
	${INSTALL_DATA} ${PKGCONFIG} ${DESTDIR}${LIBDIR}/pkgconfig

clean-pc:
	rm -rf ${PKGCONFIG}

realinstall: install-pc

clean:	clean-pc


.endif

# headers
.if defined(HEADERS)
install-headers:
	@@echo installing ${HEADERS} in ${INCSDIR}/${HEADERS_SUBDIR}
	@@cd ${_SRCDIR}; for i in ${HEADERS}; do \
	    cmp -s $$i ${DESTDIR}${INCSDIR}/${HEADERS_SUBDIR}$$i || \
		${INSTALL_DATA} $$i ${DESTDIR}${INCSDIR}/${HEADERS_SUBDIR}$$i;\
	done

realinstall: install-headers
.endif
.if defined(HEADERS_SUBDIRS)
.for d in ${HEADERS_SUBDIRS}
install-headers-subdirs::
	@@echo installing ${HEADERS_${d:S/\//_/}} in ${INCSDIR}/${d}
	@@cd ${_SRCDIR}; for i in ${HEADERS_${d:S/\//_/}}; do \
	    cmp -s $$i ${DESTDIR}${INCSDIR}/$d/$$i || \
		${INSTALL_DATA} $$i ${DESTDIR}${INCSDIR}/${d}; \
	done

realinstall: install-headers-subdirs
.endfor
.endif

.if !target(.MAIN)
.MAIN: all
.endif

.if defined(SHARED_LIBS)
_lt_libs=
.for _n _v in ${SHARED_LIBS}
_lt_libs+=lib${_n:S/+/_/g:S/-/_/g:S/./_/g}_ltversion=${_v}
.endfor
.endif

.if !target(all)
all:	config.status
	@@exec ${MAKE} ${_lt_libs}
.endif

autoreconf:
	cd ${_SRCDIR}; ${AUTOTOOLS_ENV} exec autoreconf -v --install --force

.if !target(config.status)
config.status:
	${CONFIGURE_ENV} PATH=$(XENOCARA_PATH) \
		exec sh ${_SRCDIR}/configure --prefix=${X11BASE} \
		--sysconfdir=/etc \
		--mandir=${X11BASE}/man \
		${_cache} \
		${CONFIGURE_ARGS}
.endif

.if !target(depend)
depend:
	@@echo "no dependencies here yet"
.endif

.if !target(install)
.  if !target(beforeinstall)
beforeinstall:
.  endif
.  if !target(afterinstall)
afterinstall:
.  endif
.  if !target(realinstall)
realinstall:
	exec ${MAKE} ${MAKE_FLAGS} ${_lt_libs} install
.endif
install: maninstall
maninstall: afterinstall
afterinstall: realinstall
realinstall: beforeinstall
.endif

.if !target(build)
.if exists(Makefile.bsd-wrapper)
_wrapper = -f Makefile.bsd-wrapper
.endif
.if defined(DESTDIR)
build:
	@@echo "cannot run make build with DESTDIR set"
	@@exit 2
.else
build:
	cd ${.CURDIR} && \
	    su ${BUILDUSER} -c 'exec ${MAKE} ${MAKE_FLAGS} ${_wrapper} cleandir' && \
	    su ${BUILDUSER} -c 'exec ${MAKE} ${MAKE_FLAGS} ${_wrapper} all' && \
	    exec ${MAKE} ${MAKE_FLAGS} ${_wrapper} install
.endif
.endif

.if !target(clean) && ${MAKEFILE:T} != "Makefile"
clean:
	-@@if [ -f Makefile ]; then exec ${MAKE} clean; fi
.endif

.if !target(cleandir)
cleandir: clean
	-@@if [ -f Makefile ]; then exec ${MAKE} distclean; fi
	-@@if [ -f config.status ]; then \
		echo "rm config.status"; \
		rm -f config.status; \
	fi
.endif

#
# Obj dir rules for xenocara
#
.if !target(_xenocara_obj)
. if defined(NOOBJ)
_xenocara_obj:
. else

. if defined(MAKEOBJDIR)
__objdir=	${MAKEOBJDIR}
. else
__objdir=	obj
. endif

_SUBDIRUSE:

_xenocara_obj! _SUBDIRUSE
	@@cd $(.CURDIR); \
	umask ${WOBJUMASK}; \
	here=`/bin/pwd`; xsrcdir=`cd $(XSRCDIR); /bin/pwd`; \
	subdir=$${here#$${xsrcdir}/}; \
	if [[ `id -u` -eq 0 && ${BUILDUSER} != root ]]; then \
		SETOWNER="chown -h ${BUILDUSER}:${WOBJGROUP}"; \
		if [[ $$here != $$subdir ]]; then \
			_mkdirs() { \
				su ${BUILDUSER} -c "mkdir -p $$1"; \
			}; \
			MKDIRS=_mkdirs; \
		fi; \
	elif [[ $$here == $$subdir ]]; then \
		SETOWNER="chown :${WOBJGROUP}"; \
	else \
		SETOWNER=:; \
	fi; \
	[[ -z $$MKDIRS ]] && MKDIRS="mkdir -p"; \
	if test $$here != $$subdir ; then \
	    dest=${XOBJDIR}/$$subdir; \
	    echo "$$here/${__objdir} -> $$dest"; \
	    if test ! -L ${__objdir} -o \
		X`readlink ${__objdir}` != X$$dest; then \
		    if  test -e ${__objdir}; then rm -rf ${__objdir}; fi; \
		    ln -sf $$dest ${__objdir}; \
		    $$SETOWNER ${__objdir}; \
	    fi; \
	    if test -d ${XOBJDIR}; then \
		    test -d $$dest || $$MKDIRS $$dest; \
	    else \
		    if test -e ${XOBJDIR}; then \
			    echo "${XOBJDIR} is not a directory"; \
		    else \
			    echo "${XOBJDIR} does not exist"; \
		    fi; \
	    fi; \
	else \
	    dest=$$here/${__objdir}; \
	    if test ! -d ${__objdir}; then \
		echo "making $$dest"; \
		$$MKDIRS $$dest; \
		$$SETOWNER $$dest; \
	    fi ; \
	fi
. endif
.endif

.if !target(obj)
obj:	_xenocara_obj
.endif

.PHONY: _xenocara_obj

.include <bsd.subdir.mk>
.include <bsd.own.mk>
@


1.60
log
@enforce ar to use the 'cruD' flagset in case libtool/automagic is used

ok matthieu@@
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.59 2017/03/07 21:35:58 naddy Exp $ -*- makefile  -*-
a194 1
	    su ${BUILDUSER} -c 'exec ${MAKE} ${MAKE_FLAGS} ${_wrapper} depend' && \
@


1.59
log
@pass CC, CXX, CXXFLAGS to the xenocara build; ok matthieu@@
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.58 2017/02/12 18:19:54 matthieu Exp $ -*- makefile  -*-
d63 1
@


1.58
log
@replace XENOCARA_RERUN_AUTOCONF setting with autoreconf make target.

The previous mechanism didn't play well with the new separated build
user.
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.57 2016/11/19 14:22:05 tb Exp $ -*- makefile  -*-
d59 1
d61 2
@


1.57
log
@Enable builds with a dedicated user for xenocara as well.

"push forward" deraadt; no objections matthieu; testing, input & ok rpe
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.56 2016/10/14 10:14:00 natano Exp $ -*- makefile  -*-
d144 3
a148 3
.if defined(XENOCARA_RERUN_AUTOCONF) && ${XENOCARA_RERUN_AUTOCONF:L} == "yes"
	cd ${_SRCDIR}; ${AUTOTOOLS_ENV} exec autoreconf -v --install --force
.endif
@


1.56
log
@Port the de-escalation mechanism we have in src to xenocara's make
bootstrap/obj/build. This is now possible due to a normal build not
writing to the source tree anymore.

ok deraadt
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.55 2016/10/11 22:36:53 matthieu Exp $ -*- makefile  -*-
d229 3
d233 9
a241 5
		SETOWNER="chown -h ${BUILDUSER}"; \
		_mkdirs() { \
			su ${BUILDUSER} -c "mkdir -p $$1"; \
		}; \
		MKDIRS=_mkdirs; \
a242 1
		MKDIRS="mkdir -p"; \
d245 1
a245 2
	here=`/bin/pwd`; xsrcdir=`cd $(XSRCDIR); /bin/pwd`; \
	subdir=$${here#$${xsrcdir}/}; \
d269 1
@


1.55
log
@Remove the REORDER_DEPENDENCIES mechanism.
The xenocara build process is not writing in the source tree.
This and previous commits was done in cooperation with natano@@
and deraadt@@
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.54 2016/10/10 13:34:43 matthieu Exp $ -*- makefile  -*-
d189 5
a193 4
	cd ${.CURDIR} && exec ${MAKE} ${MAKE_FLAGS} ${_wrapper} cleandir
	cd ${.CURDIR} && exec ${MAKE} ${MAKE_FLAGS} ${_wrapper} depend
	cd ${.CURDIR} && exec ${MAKE} ${MAKE_FLAGS} ${_wrapper} all
	cd ${.CURDIR} && exec ${SUDO} ${MAKE} ${MAKE_FLAGS} ${_wrapper} install
d229 10
d248 1
d251 1
a251 1
		    test -d $$dest || mkdir -p $$dest; \
d263 1
a263 1
		mkdir $$dest; \
d276 1
@


1.54
log
@Remove the global 'make includes' step from 'make build'.
This is no longer needed and gets in the way of tightening
permission used during build. ok and suggestions natano@@
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.53 2016/03/28 11:59:06 matthieu Exp $ -*- makefile  -*-
a143 4

REORDER_DEPENDENCIES += ${X11BASE}/share/mk/automake.dep
ECHO_REORDER ?= :

a147 17
.else
.if !defined(NO_REORDER)
	@@sed -e '/^#/d' ${REORDER_DEPENDENCIES} | \
	  tsort -r|while read f; do \
	    cd ${_SRCDIR}; \
		case $$f in \
		/*) \
			find . -name $${f#/} -print| while read i; \
				do ${ECHO_REORDER} "Touching $$i"; touch $$i; done \
			;; \
		*) \
			if test -e $$f ; then \
				${ECHO_REORDER} "Touching $$f"; touch $$f; \
			fi \
			;; \
		esac; done
.endif
@


1.53
log
@mark _xneocara_obj as PHONY
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.51 2014/08/24 15:53:08 matthieu Exp $ -*- makefile  -*-
a129 4
.endif

.if !target(includes)
includes: _SUBDIRUSE
@


1.52
log
@Protect against make build with DESTDIR set.
@
text
@d286 2
@


1.51
log
@less verbose
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.50 2014/05/18 10:29:01 matthieu Exp $ -*- makefile  -*-
d208 5
d218 1
@


1.50
log
@Add /usr/lib/pkgconfig to PKG_CONFIG_LIBDIR to let pkg-config find expat
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.49 2013/11/22 15:44:48 espie Exp $ -*- makefile  -*-
d145 1
a145 1
	exec ${MAKE} ${_lt_libs}
@


1.49
log
@remove useless goo. okay matthieu@@
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.48 2013/04/14 19:57:40 matthieu Exp $ -*- makefile  -*-
d38 1
a38 1
PKG_CONFIG_LIBDIR=	${X11BASE}/lib/pkgconfig
@


1.48
log
@Allow flags to be passed to make using ${MAKE_FLAGS}
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.47 2012/11/03 15:19:02 espie Exp $ -*- makefile  -*-
d237 2
a238 2
. if defined(OBJMACHINE)
__objdir=	obj.$(MACHINE)
a242 12
. if defined(XOBJMACHINE)
__xobjdir=	$(XOBJDIR).$(MACHINE)
__xobjdirpf=
. else
__xobjdir=	$(XOBJDIR)
.  if defined(OBJMACHINE)
__xobjdirpf=	.$(MACHINE)
.  else
__xobjdirpf=
.  endif
. endif

d250 1
a250 1
	    dest=${__xobjdir}/$$subdir${__xobjdirpf}; \
d257 1
a257 1
	    if test -d ${__xobjdir}; then \
d260 2
a261 2
		    if test -e ${__xobjdir}; then \
			    echo "${__xobjdir} is not a directory"; \
d263 1
a263 1
			    echo "${__xobjdir} does not exist"; \
@


1.47
log
@simplify directory interdependencies: install package_version.m4

avoid VAR != cmd which is run every which time, prefer VAR = `cmd` where
applicable.

okay matthieu@@
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.46 2012/10/11 16:57:57 espie Exp $ -*- makefile  -*-
d196 1
a196 1
	exec ${MAKE} ${_lt_libs} install
d209 4
a212 4
	cd ${.CURDIR} && exec ${MAKE} ${_wrapper} cleandir
	cd ${.CURDIR} && exec ${MAKE} ${_wrapper} depend
	cd ${.CURDIR} && exec ${MAKE} ${_wrapper} all
	cd ${.CURDIR} && exec ${SUDO} ${MAKE} ${_wrapper} install
@


1.46
log
@never intended to commit THAT debug line.
no real harm...
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.45 2012/08/21 20:18:48 espie Exp $ -*- makefile  -*-
d75 2
a76 3
.if !defined(PACKAGE_VERSION)
PACKAGE_VERSION!=m4 ${XSRCDIR}/share/mk/package_version.m4 ${_SRCDIR}/configure.ac
.endif
d87 1
a87 1
	    -e 's#@@PACKAGE_VERSION@@#${PACKAGE_VERSION}#g' \
@


1.45
log
@prevent non-existing clean to turn into an infinite loop.

okay matthieu@@, aja@@

(problem noticed by aja@@)
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.44 2012/08/08 21:54:33 matthieu Exp $ -*- makefile  -*-
a152 2
foo:
	cd ${_SRCDIR}; ${AUTOTOOLS_ENV} exec autoreconf -v --install --force
@


1.44
log
@Don't touch the xserver autotools files a 2nd time in kdrive.
This causes a rebuild of xserver during make release (configure
becomes more recent than config.status again).
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.43 2012/08/05 18:08:05 matthieu Exp $ -*- makefile  -*-
d153 2
d218 1
a218 1
.if !target(clean)
@


1.43
log
@Automake 1.12 now uses autoconf 2.69.
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.42 2012/08/04 17:10:01 matthieu Exp $ -*- makefile  -*-
d158 1
d173 1
@


1.42
log
@Switch to automake 1.12/autoconf 2.68.

Note that I don't plan to regenerate all the autotools files now.
It's a lazy update that will only take effect when autotools files
are re-generated, upon updates or for another reason.
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.41 2012/03/11 10:08:59 matthieu Exp $ -*- makefile  -*-
d23 1
a23 1
AUTOCONF_VERSION=	2.68
@


1.41
log
@Bump python version and copyright.
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.40 2011/11/05 11:49:01 matthieu Exp $ -*- makefile  -*-
d22 2
a23 2
AUTOMAKE_VERSION=	1.9
AUTOCONF_VERSION=	2.62
d61 2
@


1.40
log
@In make cleandir, force removal of config.status if it's left
around after running make distclean.
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.39 2011/06/23 22:49:00 naddy Exp $ -*- makefile  -*-
d3 1
a3 1
# Copyright © 2006 Matthieu Herrb
d24 1
a24 1
PYTHON_VERSION=		2.6
d180 1
a180 1
depend: 
@


1.39
log
@switch to installing source manuals:
* cope with new bsd.man.mk
* update imake configuration

ports use of imake remains unchanged
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.38 2011/06/02 19:47:33 matthieu Exp $ -*- makefile  -*-
d220 4
@


1.38
log
@Oops revert wip (using ports libtool) that wasn't meant to be committed.
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.36 2010/08/04 22:56:00 espie Exp $ -*- makefile  -*-
d36 1
a36 1
MANDIR=			${X11BASE}/man/cat
@


1.37
log
@Switch XKB layouts to xkeyboard-config.
Note: this moves xkb data files to /usr/X11R6/share/X11/xkb/
      /etc/X11/xkb can be removed.
Tested by many.
@
text
@a31 3
# For libtool replacement
PORTSDIR?=	/usr/ports

a66 2
LIBTOOL=	${PORTSDIR}/infrastructure/bin/libtool

d144 1
a144 1
	exec ${MAKE} LIBTOOL=${LIBTOOL} ${_lt_libs}
d193 1
a193 1
	exec ${MAKE} LIBTOOL=${LIBTOOL} ${_lt_libs} install
@


1.36
log
@set PATH only on configure run, unbreak autoreconf...
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.35 2010/08/04 22:50:51 espie Exp $ -*- makefile  -*-
d32 3
d70 2
d149 1
a149 1
	exec ${MAKE} ${_lt_libs}
d198 1
a198 1
	exec ${MAKE} ${_lt_libs} install
@


1.35
log
@enforce a consistent path in configure, avoid all kind of trouble with X
picking up ports from /usr/local.

okay matthieu@@
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.34 2010/05/08 10:32:12 matthieu Exp $ -*- makefile  -*-
a59 1
		PATH=$(XENOCARA_PATH) \
d171 2
a172 1
	${CONFIGURE_ENV} exec sh ${_SRCDIR}/configure --prefix=${X11BASE} \
@


1.34
log
@Use ${SHAREMODE} from bsd.own.mk in INSTALL_DATA instead of hard-coding
a value.
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.33 2010/01/17 20:48:49 matthieu Exp $ -*- makefile  -*-
d55 2
d60 1
@


1.33
log
@Use the new XORG_WITH_XMLTO macro in configure scripts and explicitely
disable it during Xenocara builds. Problem reported by kili@@ who also
tested this patch with an earlier version of the macro.
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.32 2009/05/22 15:46:13 matthieu Exp $ -*- makefile  -*-
d41 2
a42 1
INSTALL_DATA = ${INSTALL} ${INSTALL_COPY} -o ${BINOWN} -g ${BINGRP} -m 644
@


1.32
log
@use implicit variable to generate pkgconfig file.
This makes it possible to locate the .in file using .PATH
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.31 2009/05/22 15:34:15 matthieu Exp $ -*- makefile  -*-
a55 1
		XMLTO=: \
@


1.31
log
@Add PYTHON_VERSION (to be used by xcb).
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.30 2009/05/22 15:21:21 matthieu Exp $ -*- makefile  -*-
d86 1
a86 1
	< ${_SRCDIR}/${PKGCONFIG}.in > $@@
@


1.30
log
@Add more substitutions to .pc generation. Also provide
EXTRA_PKGCONFIG_SUBST for individual addition in package Makefiles.
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.29 2009/05/22 15:09:28 matthieu Exp $ -*- makefile  -*-
d24 1
d71 1
d73 1
@


1.29
log
@Get rid of double-column rules in the rules used by proto.

This will make it easier to re-use them for other stuff.
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.28 2009/05/22 15:03:03 matthieu Exp $ -*- makefile  -*-
d76 2
d82 1
@


1.28
log
@Use test -f rather than test -e to test for Makefile presence.
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.27 2009/05/02 13:51:29 matthieu Exp $ -*- makefile  -*-
d72 1
a72 1
all:: ${PKGCONFIG}
d82 1
a82 1
install:: ${PKGCONFIG}
d85 8
a92 2
clean::
	rm -f ${PKGCONFIG}
d97 1
a97 1
install::
d103 2
d108 1
a108 1
install::
d114 2
@


1.27
log
@switch to autoconf 2.62 to generate xenocara configure scripts.
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.26 2008/08/21 05:54:41 matthieu Exp $ -*- makefile  -*-
d195 1
a195 1
	-@@if [ -e Makefile ]; then exec ${MAKE} clean; fi
d200 1
a200 1
	-@@if [ -e Makefile ]; then exec ${MAKE} distclean; fi
@


1.26
log
@Provide a way to build sources that aren't in .CURDIR by specifying
_SRCDIR expliciteley in Makefile.bsd-wrapper.
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.25 2008/05/11 20:58:10 matthieu Exp $ -*- makefile  -*-
d23 1
a23 1
AUTOCONF_VERSION=	2.59
@


1.25
log
@provide a minimal config.site pre-built configure cache, to
protect xenocara builds from picking stuff installed by ports.
For now only paths to different programs are provided, avoiding the
use of bison instead of yacc. feedback from espie@@.
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.24 2008/03/25 23:28:19 matthieu Exp $ -*- makefile  -*-
d51 2
d70 1
a70 1
PACKAGE_VERSION!=m4 ${XSRCDIR}/share/mk/package_version.m4 ${.CURDIR}/configure.ac
d80 1
a80 1
	< ${.CURDIR}/${PKGCONFIG}.in > $@@
d93 1
a93 1
	@@cd ${.CURDIR}; for i in ${HEADERS}; do \
d102 1
a102 1
	@@cd ${.CURDIR}; for i in ${HEADERS_${d:S/\//_/}}; do \
d136 1
a136 1
	cd ${.CURDIR}; ${AUTOTOOLS_ENV} exec autoreconf -v --install --force
d140 1
a140 1
	    cd ${.CURDIR}; \
d153 1
a153 1
	${CONFIGURE_ENV} exec sh ${.CURDIR}/configure --prefix=${X11BASE} \
@


1.24
log
@Replace autotools based build by native BSD Makefiles in proto/.
tested by naddy@@ and oga@@. ok oga@@.
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.23 2008/03/03 07:01:44 matthieu Exp $ -*- makefile  -*-
d47 4
d52 1
@


1.23
log
@Change the default for XSRCDIR to /usr/xenocara. ok deraadt@@
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.22 2007/11/25 10:23:01 matthieu Exp $ -*- makefile  -*-
d56 45
@


1.22
log
@always redirect xmlto to ':'.
Broken configure sripts produced X.Org's macros are
assuming it's in /usr/local/bin if they couldn't find it.
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.21 2007/11/05 16:51:37 espie Exp $ -*- makefile  -*-
d26 1
a26 1
XSRCDIR?=		/usr/src/xenocara
@


1.21
log
@avoid hardcoding MAKE in various makefiles.

Fuck GNU and their idiot-proof configury that gets in our way each and
every time.

okay matthieu@@
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.20 2007/05/01 08:31:47 espie Exp $ -*- makefile  -*-
d48 1
@


1.20
log
@like src, warn if base obj dir does not exist.
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.19 2007/03/31 20:25:53 matthieu Exp $ -*- makefile  -*-
d48 2
a49 1
		CFLAGS="$(CFLAGS:C/ *$//)"
@


1.19
log
@XENOCARA_TOP -> XSRCDIR and now defaults to /usr/src/xenocara
XENOCARA_OBJDIR -> XOBJDIR  and now defaults to /usr/xobj
suggested by espie@@ ok krw@@ mbalmer@@
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.18 2007/03/30 17:24:12 aanriot Exp $ -*- makefile  -*-
d189 2
a190 2
	    if test -d ${__xobjdir} -a ! -d $$dest; then \
		mkdir -p $$dest; \
d192 5
a196 1
		true; \
@


1.18
log
@- add an INSTALL_DATA target in bsd.xorg.mk (inspired by bsd.port.mk).
- start using it in fvwm, ssh-askpass and xsystrace (more to come).

ok matthieu@@
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.17 2007/03/30 07:11:06 espie Exp $ -*- makefile  -*-
d26 1
a26 1
XENOCARA_TOP?=		/usr/xenocara
d29 1
a29 1
XENOCARA_OBJDIR?=	/usr/obj/xenocara
d43 1
a43 1
_cache= --cache-file=${XENOCARA_OBJDIR}/xorg-config.cache.${MACHINE}
d163 2
a164 2
. if defined(XENOCARA_OBJMACHINE)
__xobjdir=	$(XENOCARA_OBJDIR).$(MACHINE)
d167 1
a167 1
__xobjdir=	$(XENOCARA_OBJDIR)
d179 2
a180 2
	here=`/bin/pwd`; xenocara_top=`cd $(XENOCARA_TOP); /bin/pwd`; \
	subdir=$${here#$${xenocara_top}/}; \
@


1.17
log
@suppress reordering messages by default
okay matthieu@@
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.16 2007/03/28 19:38:57 matthieu Exp $ -*- makefile  -*-
d38 3
@


1.16
log
@Various cleanups of recursive make invocations. Ok espie@@, todd@@.
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.15 2007/03/25 16:52:54 matthieu Exp $ -*- makefile  -*-
d74 1
d87 1
a87 1
				do echo "Touching $$i"; touch $$i; done \
d91 1
a91 1
				echo "Touching $$f"; touch $$f; \
@


1.15
log
@Missed one PKG_CONFIG_PATH -> PKG_CONFIG_LIBDIR conversion.
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.14 2007/03/18 10:27:58 matthieu Exp $ -*- makefile  -*-
d44 4
a47 1
MAKE_ENV+=	AUTOMAKE_VERSION="$(AUTOMAKE_VERSION)" \
d50 1
a50 2
		PKG_CONFIG_LIBDIR="$(PKG_CONFIG_LIBDIR)" \
		CFLAGS="$(CFLAGS:C/ *$//)"
d69 1
a69 1
	${MAKE_ENV} ${MAKE} ${_lt_libs}
d78 1
a78 1
	cd ${.CURDIR}; ${MAKE_ENV} autoreconf -v --install --force
d95 1
a95 2
	PKG_CONFIG_LIBDIR="$(PKG_CONFIG_LIBDIR)" CFLAGS="$(CFLAGS:C/ *$//)" \
		${CONFIGURE_ENV} sh ${.CURDIR}/configure --prefix=${X11BASE} \
d116 1
a116 1
	${MAKE_ENV} ${MAKE} ${_lt_libs} install
a123 5
.if !target(dist)
dist:
	${MAKE_ENV} ${MAKE} ${_lt_libs} dist
.endif

d129 4
a132 4
	cd ${.CURDIR} && ${MAKE_ENV} ${MAKE} ${_wrapper} cleandir
	cd ${.CURDIR} && ${MAKE_ENV} ${MAKE} ${_wrapper} depend
	cd ${.CURDIR} && ${MAKE_ENV} ${MAKE} ${_wrapper} all
	cd ${.CURDIR} && ${MAKE_ENV} ${SUDO} ${MAKE} ${_wrapper} install
d137 1
a137 1
	-@@if [ -e Makefile ]; then ${MAKE_ENV} ${MAKE} clean; fi
d142 1
a142 1
	-@@if [ -e Makefile ]; then ${MAKE_ENV} ${MAKE} distclean; fi
@


1.14
log
@configure as checked out from CVS may not be executable. Patch from naddy@@.
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.13 2007/03/17 19:32:41 matthieu Exp $ -*- makefile  -*-
d93 1
a93 1
	PKG_CONFIG_PATH="$(PKG_CONFIG_PATH)" CFLAGS="$(CFLAGS:C/ *$//)" \
@


1.13
log
@Touch files that would be modified by autotools to avoid un-needed
calls to automake and autoconf. Code stolen from ports tree.
suggested by espie@@. Tested by todd@@.
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.12 2007/02/04 23:15:27 matthieu Exp $ -*- makefile  -*-
d94 1
a94 1
		${CONFIGURE_ENV} ${.CURDIR}/configure --prefix=${X11BASE} \
@


1.12
log
@replace PKG_CONFIG_PATH with PKG_CONFIG_LIBDIR which replaces the
builtin search path instead of adding to it. Suggested by espie@@
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.11 2006/12/31 16:00:03 matthieu Exp $ -*- makefile  -*-
d70 3
d77 15
@


1.11
log
@Handle CFLAGS and COPTS.
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.10 2006/12/31 10:55:41 matthieu Exp $ -*- makefile  -*-
d37 1
a37 1
PKG_CONFIG_PATH=	${X11BASE}/lib/pkgconfig
d47 1
a47 1
		PKG_CONFIG_PATH="$(PKG_CONFIG_PATH)" \
@


1.10
log
@- don't include bsd.own.mk twice
- don't define X11BASE and X11ETC twice
- remove --enable-maintainer-mode from configure args and factorize
  the config.status rule
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.9 2006/12/17 20:41:36 matthieu Exp $ -*- makefile  -*-
d42 2
d47 2
a48 1
		PKG_CONFIG_PATH="$(PKG_CONFIG_PATH)"
d75 1
a75 1
	PKG_CONFIG_PATH="$(PKG_CONFIG_PATH)" \
@


1.9
log
@make the install target more similar to what is done in the base system.
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.8 2006/12/02 16:28:48 matthieu Exp $ -*- makefile  -*-
a17 2
.include <bsd.own.mk>

a31 3
X11BASE?=		/usr/X11R6
X11ETC?=		/etc/X11

d39 1
d68 1
a69 1
config.status: _xenocara_obj
d71 1
a71 9
	PKG_CONFIG_PATH="$(PKG_CONFIG_PATH)" \
		${CONFIGURE_ENV} ${.CURDIR}/configure \
		--enable-maintainer-mode --prefix=${X11BASE} \
		--sysconfdir=/etc \
		--mandir=${X11BASE}/man \
		${_cache} \
		${CONFIGURE_ARGS}
.else
config.status: _xenocara_obj
a77 1
.endif
@


1.8
log
@Make 'obj' now can make symlinks to /usr/obj/xenocara (or any other
directory designed by XENOCARA_OBJDIR in /etc/mk.conf).
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.7 2006/11/29 21:51:46 matthieu Exp $ -*- makefile  -*-
d56 1
a56 1
includes:
d99 8
a106 1
install::
d109 4
a112 4

.if target(extra-install)
install::
	cd ${.CURDIR} && ${MAKE_ENV} ${MAKE} -f Makefile.bsd-wrapper extra-install
d199 2
@


1.7
log
@define X11ETC
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.6 2006/11/28 13:43:46 matthieu Exp $ -*- makefile  -*-
d30 2
a31 2
# Where to buid - not used?
# XORG_BUILDDIR=	${XENOCARA_TOP}
d44 1
a44 1
_cache= --cache-file=${XENOCARA_TOP}/xorg-config.cache.${MACHINE}
d73 1
a73 1
config.status:
d83 1
a83 1
config.status:
d134 58
a191 1
.include <bsd.obj.mk>
@


1.6
log
@Define BINDIR conditionnally. Mimics what bsd.prog.mk does.
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.5 2006/11/27 12:03:10 matthieu Exp $ -*- makefile  -*-
d35 1
@


1.5
log
@Use autoreconf --force to overwrite libtool scripts with the
OpenBSD ones.
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.4 2006/11/26 13:54:48 matthieu Exp $ -*- makefile  -*-
d36 1
a36 1
BINDIR=			${X11BASE}/bin
@


1.4
log
@Remove git update rules.
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.3 2006/11/26 13:53:45 matthieu Exp $ -*- makefile  -*-
d73 1
a73 1
	cd ${.CURDIR}; ${MAKE_ENV} autoreconf -v --install
@


1.3
log
@Cleanups: remove useless DIST and AUTOGEN variables
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.2 2006/11/26 12:58:32 matthieu Exp $ -*- makefile  -*-
a94 8
.endif

.if exists($(.CURDIR)/.git)
update:
	cd $(.CURDIR); git pull
.else
update:
	@@echo "no git repository to pull"
@


1.2
log
@Don't use the autogen.sh script to regenerate files with autotools
This script is not bundled in every X.Org tarball anymore.
@
text
@d1 1
a1 1
# $OpenBSD: bsd.xorg.mk,v 1.1.1.1 2006/11/25 14:56:32 matthieu Exp $ -*- makefile  -*-
a42 4
DIST?=			${.CURDIR}

AUTOGEN=		${DIST}/autogen.sh

d84 1
a84 1
		${CONFIGURE_ENV} ${DIST}/configure --prefix=${X11BASE} \
d97 1
a97 1
.if exists($(DIST)/.git)
d99 1
a99 1
	cd $(DIST); git pull
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$ -*- makefile  -*-
d77 4
a80 1
		${MAKE_ENV} ${CONFIGURE_ENV} ${AUTOGEN} --prefix=${X11BASE} \
@


1.1.1.1
log
@Makefile rules to help the build of the modular X.Org.
@
text
@@
