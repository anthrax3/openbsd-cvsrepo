head	1.4;
access;
symbols
	OPENBSD_5_8:1.3.0.14
	OPENBSD_5_8_BASE:1.3
	OPENBSD_5_7:1.3.0.12
	OPENBSD_5_7_BASE:1.3
	OPENBSD_5_6:1.3.0.10
	OPENBSD_5_6_BASE:1.3
	OPENBSD_5_5:1.3.0.8
	OPENBSD_5_5_BASE:1.3
	OPENBSD_5_4:1.3.0.6
	OPENBSD_5_4_BASE:1.3
	OPENBSD_5_3:1.3.0.4
	OPENBSD_5_3_BASE:1.3
	OPENBSD_5_2:1.3.0.2
	OPENBSD_5_2_BASE:1.3
	OPENBSD_5_1_BASE:1.2
	OPENBSD_5_1:1.2.0.8
	OPENBSD_5_0:1.2.0.6
	OPENBSD_5_0_BASE:1.2
	OPENBSD_4_9:1.2.0.2
	OPENBSD_4_9_BASE:1.2
	OPENBSD_4_8:1.2.0.4
	OPENBSD_4_8_BASE:1.2
	OPENBSD_4_7:1.1.1.1.0.12
	OPENBSD_4_7_BASE:1.1.1.1
	OPENBSD_4_6:1.1.1.1.0.10
	OPENBSD_4_6_BASE:1.1.1.1
	OPENBSD_4_5:1.1.1.1.0.8
	OPENBSD_4_5_BASE:1.1.1.1
	OPENBSD_4_4:1.1.1.1.0.6
	OPENBSD_4_4_BASE:1.1.1.1
	OPENBSD_4_3_BASE:1.1.1.1
	OPENBSD_4_3:1.1.1.1.0.4
	v1_4_0_90:1.1.1.1
	v1_4:1.1.1.1
	OPENBSD_4_2:1.1.1.1.0.2
	OPENBSD_4_2_BASE:1.1.1.1
	v1_2_0:1.1.1.1
	v1_1_99_903:1.1.1.1
	v1_1_99_902:1.1.1.1
	xorg:1.1.1;
locks; strict;
comment	@ * @;


1.4
date	2015.09.16.19.10.22;	author matthieu;	state dead;
branches;
next	1.3;
commitid	Te1daavkBLskZ8gc;

1.3
date	2012.06.10.13.21.24;	author matthieu;	state Exp;
branches;
next	1.2;

1.2
date	2010.07.27.19.02.33;	author matthieu;	state Exp;
branches;
next	1.1;

1.1
date	2006.11.26.18.17.39;	author matthieu;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2006.11.26.18.17.39;	author matthieu;	state Exp;
branches;
next	;


desc
@@


1.4
log
@Update to xserver 1.17.2. tested by dcoppa@@, jsg@@, jasper@@ & naddy@@
@
text
@#ifndef __MSP3430_H__
#define __MSP3430_H__

#include "xf86i2c.h"

typedef struct {
    I2CDevRec d;

    int standard;
    int connector;
    int mode;

    CARD8 hardware_version, major_revision, product_code, rom_version;
#ifdef MSP_DEBUG
    CARD8 registers_present[256];
#endif

    CARD16 chip_id;
    CARD8 chip_family;
    Bool recheck;               /*reinitialization needed after channel change */
    CARD8 c_format;             /*current state of audio format */
    CARD16 c_standard;          /*current state of standard register */
    CARD8 c_source;             /*current state of source register */
    CARD8 c_matrix;             /*current state of matrix register */
    CARD8 c_fmmatrix;           /*current state of fmmatrix register */
    int c_mode;                 /* current state of mode for autoswitchimg */
    CARD8 volume;
} MSP3430Rec, *MSP3430Ptr;

#define MSP3430_ADDR_1      0x80
#define MSP3430_ADDR_2		0x84
#define MSP3430_ADDR_3		0x88

#define MSP3430_PAL		1
#define MSP3430_NTSC		2
#define MSP3430_PAL_DK1         (0x100 | MSP3430_PAL)
#define MSP3430_SECAM           3

#define MSP3430_CONNECTOR_1     1       /* tuner on AIW cards */
#define MSP3430_CONNECTOR_2     2       /* SVideo on AIW cards */
#define MSP3430_CONNECTOR_3     3       /* composite on AIW cards */

#define MSP3430_ADDR(a)         ((a)->d.SlaveAddr)

#define MSP3430_FAST_MUTE	0xFF
/* a handy volume transform function, -1000..1000 -> 0x01..0x7F */
#define MSP3430_VOLUME(value) (0x01+(0x7F-0x01)*log(value+1001)/log(2001))

/*----------------------------------------------------------*/

/* MSP chip families */
#define MSPFAMILY_UNKNOWN	0
#define MSPFAMILY_34x0D		1
#define MSPFAMILY_34x5D		2
#define MSPFAMILY_34x0G		3
#define MSPFAMILY_34x5G		4

/* values for MSP standard */
#define MSPSTANDARD_UNKNOWN	0x00
#define MSPSTANDARD_AUTO	0x01
#define MSPSTANDARD_FM_M	0x02
#define MSPSTANDARD_FM_BG	0x03
#define MSPSTANDARD_FM_DK1	0x04
#define MSPSTANDARD_FM_DK2	0x04
#define MSPSTANDARD_NICAM_BG	0x08
#define MSPSTANDARD_NICAM_L	0x09
#define MSPSTANDARD_NICAM_I	0x0A
#define MSPSTANDARD_NICAM_DK	0x0B

/* values for MSP format */
#define MSPFORMAT_UNKNOWN	0x00
#define MSPFORMAT_FM		0x10
#define MSPFORMAT_1xFM		0x00|MSPFORMAT_FM
#define MSPFORMAT_2xFM		0x01|MSPFORMAT_FM
#define MSPFORMAT_NICAM		0x20
#define MSPFORMAT_NICAM_FM	0x00|MSPFORMAT_NICAM
#define MSPFORMAT_NICAM_AM	0x01|MSPFORMAT_NICAM
#define MSPFORMAT_SCART		0x30

/* values for MSP mode */
#define MSPMODE_UNKNOWN		0
/* automatic modes */
#define MSPMODE_STEREO_AB	1
#define MSPMODE_STEREO_A	2
#define MSPMODE_STEREO_B	3
/* forced modes */
#define MSPMODE_MONO		4
#define MSPMODE_STEREO		5
#define MSPMODE_AB			6
#define MSPMODE_A			7
#define MSPMODE_B			8
/*----------------------------------------------------------*/

#define xf86_InitMSP3430	InitMSP3430
extern _X_EXPORT void InitMSP3430(MSP3430Ptr m);

#define xf86_DetectMSP3430	DetectMSP3430
extern _X_EXPORT MSP3430Ptr DetectMSP3430(I2CBusPtr b, I2CSlaveAddr addr);

#define xf86_ResetMSP3430	ResetMSP3430
extern _X_EXPORT void ResetMSP3430(MSP3430Ptr m);

#define xf86_MSP3430SetVolume	MSP3430SetVolume
extern _X_EXPORT void MSP3430SetVolume(MSP3430Ptr m, CARD8 value);

#define xf86_MSP3430SetSAP	MSP3430SetSAP
extern _X_EXPORT void MSP3430SetSAP(MSP3430Ptr m, int mode);

#define MSP3430SymbolsList \
		"InitMSP3430", \
		"DetectMSP3430", \
		"ResetMSP3430", \
		"MSP3430SetVolume", \
		"MSP3430SetSAP"

#endif
@


1.3
log
@Update to xserver 1.12.2. tested by naddy@@, krw@@, mpi@@.
@
text
@@


1.2
log
@Update to xserver 1.8. Tested by many. Ok oga@@, todd@@.
@
text
@d7 1
a7 5
        I2CDevRec d;
	
	int standard;
	int connector;
	int mode;
d9 5
a13 1
        CARD8 hardware_version, major_revision, product_code, rom_version;
d15 1
a15 1
	CARD8 registers_present[256];
d18 11
a28 12
	CARD16 chip_id;
	CARD8  chip_family;
	Bool  recheck;		/*reinitialization needed after channel change */
	CARD8 c_format;		/*current state of audio format */
	CARD16 c_standard;	/*current state of standard register */
	CARD8	c_source;	/*current state of source register */
	CARD8	c_matrix;	/*current state of matrix register */
	CARD8	c_fmmatrix;	/*current state of fmmatrix register */
	int		c_mode;	/* current state of mode for autoswitchimg */
	CARD8	volume;
	} MSP3430Rec, * MSP3430Ptr;

d39 3
a41 3
#define MSP3430_CONNECTOR_1     1   /* tuner on AIW cards */
#define MSP3430_CONNECTOR_2     2   /* SVideo on AIW cards */
#define MSP3430_CONNECTOR_3     3   /* composite on AIW cards */
d52 1
a52 1
#define MSPFAMILY_UNKNOWN	0	
d96 1
d99 1
d102 1
d104 2
a105 1
extern _X_EXPORT void MSP3430SetVolume (MSP3430Ptr m, CARD8 value);
d107 1
a107 1
extern _X_EXPORT void MSP3430SetSAP (MSP3430Ptr m, int mode);
@


1.1
log
@Initial revision
@
text
@d95 10
a104 5
void InitMSP3430(MSP3430Ptr m);
MSP3430Ptr DetectMSP3430(I2CBusPtr b, I2CSlaveAddr addr);
void ResetMSP3430(MSP3430Ptr m);
void MSP3430SetVolume (MSP3430Ptr m, CARD8 value);
void MSP3430SetSAP (MSP3430Ptr m, int mode);
a111 6

#define xf86_DetectMSP3430     ((MSP3430Ptr (*)(I2CBusPtr, I2CSlaveAddr))LoaderSymbol("DetectMSP3430"))
#define xf86_ResetMSP3430      ((void (*)(MSP3430Ptr))LoaderSymbol("ResetMSP3430"))
#define xf86_MSP3430SetVolume  ((void (*)(MSP3430Ptr, CARD8))LoaderSymbol("MSP3430SetVolume"))
#define xf86_MSP3430SetSAP     ((void (*)(MSP3430Ptr, int))LoaderSymbol("MSP3430SetSAP"))
#define xf86_InitMSP3430       ((void (*)(MSP3430Ptr))LoaderSymbol("InitMSP3430"))
@


1.1.1.1
log
@Importing xserver from X.Org 7.2RC2
@
text
@@
