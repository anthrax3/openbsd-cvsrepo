head	1.7;
access;
symbols
	OPENBSD_6_2:1.7.0.8
	OPENBSD_6_2_BASE:1.7
	OPENBSD_6_1:1.7.0.6
	OPENBSD_6_1_BASE:1.7
	OPENBSD_6_0:1.7.0.4
	OPENBSD_6_0_BASE:1.7
	OPENBSD_5_9:1.7.0.2
	OPENBSD_5_9_BASE:1.7
	OPENBSD_5_8:1.6.0.4
	OPENBSD_5_8_BASE:1.6
	OPENBSD_5_7:1.6.0.2
	OPENBSD_5_7_BASE:1.6
	OPENBSD_5_6:1.5.0.6
	OPENBSD_5_6_BASE:1.5
	OPENBSD_5_5:1.5.0.4
	OPENBSD_5_5_BASE:1.5
	OPENBSD_5_4:1.5.0.2
	OPENBSD_5_4_BASE:1.5
	OPENBSD_5_3:1.4.0.4
	OPENBSD_5_3_BASE:1.4
	OPENBSD_5_2:1.4.0.2
	OPENBSD_5_2_BASE:1.4
	OPENBSD_5_1_BASE:1.3
	OPENBSD_5_1:1.3.0.8
	OPENBSD_5_0:1.3.0.6
	OPENBSD_5_0_BASE:1.3
	OPENBSD_4_9:1.3.0.2
	OPENBSD_4_9_BASE:1.3
	OPENBSD_4_8:1.3.0.4
	OPENBSD_4_8_BASE:1.3
	OPENBSD_4_7:1.2.0.6
	OPENBSD_4_7_BASE:1.2
	OPENBSD_4_6:1.2.0.4
	OPENBSD_4_6_BASE:1.2
	OPENBSD_4_5:1.2.0.2
	OPENBSD_4_5_BASE:1.2
	OPENBSD_4_4:1.1.1.3.0.4
	OPENBSD_4_4_BASE:1.1.1.3
	OPENBSD_4_3_BASE:1.1.1.3
	OPENBSD_4_3:1.1.1.3.0.2
	v1_4_0_90:1.1.1.3
	v1_4:1.1.1.3
	OPENBSD_4_2:1.1.1.2.0.2
	OPENBSD_4_2_BASE:1.1.1.2
	v1_2_0:1.1.1.2
	v1_1_99_903:1.1.1.2
	v1_1_99_902:1.1.1.1
	xorg:1.1.1;
locks; strict;
comment	@ * @;


1.7
date	2015.09.16.19.10.22;	author matthieu;	state Exp;
branches;
next	1.6;
commitid	Te1daavkBLskZ8gc;

1.6
date	2014.09.27.17.53.02;	author matthieu;	state Exp;
branches;
next	1.5;
commitid	cVXoV5PxI8YrEaVA;

1.5
date	2013.06.07.17.28.51;	author matthieu;	state Exp;
branches;
next	1.4;

1.4
date	2012.06.10.13.21.24;	author matthieu;	state Exp;
branches;
next	1.3;

1.3
date	2010.07.27.19.02.32;	author matthieu;	state Exp;
branches;
next	1.2;

1.2
date	2008.11.02.15.26.21;	author matthieu;	state Exp;
branches;
next	1.1;

1.1
date	2006.11.26.18.18.11;	author matthieu;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2006.11.26.18.18.11;	author matthieu;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	2006.12.16.20.16.11;	author matthieu;	state Exp;
branches;
next	1.1.1.3;

1.1.1.3
date	2007.11.24.18.01.16;	author matthieu;	state Exp;
branches;
next	;


desc
@@


1.7
log
@Update to xserver 1.17.2. tested by dcoppa@@, jsg@@, jasper@@ & naddy@@
@
text
@/**************************************************************************

Copyright 1998-1999 Precision Insight, Inc., Cedar Park, Texas.
All Rights Reserved.

Permission is hereby granted, free of charge, to any person obtaining a
copy of this software and associated documentation files (the
"Software"), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sub license, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:

The above copyright notice and this permission notice (including the
next paragraph) shall be included in all copies or substantial portions
of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT.
IN NO EVENT SHALL PRECISION INSIGHT AND/OR ITS SUPPLIERS BE LIABLE FOR
ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

**************************************************************************/

/*
 * Authors:
 *   Jens Owen <jens@@tungstengraphics.com>
 *
 */

/* Prototypes for DRI functions */

#ifndef _DRI_H_

#include <pciaccess.h>

#include "scrnintstr.h"
#include "xf86dri.h"

typedef int DRISyncType;

#define DRI_NO_SYNC 0
#define DRI_2D_SYNC 1
#define DRI_3D_SYNC 2

typedef int DRIContextType;

typedef struct _DRIContextPrivRec DRIContextPrivRec, *DRIContextPrivPtr;

typedef enum _DRIContextFlags {
    DRI_CONTEXT_2DONLY = 0x01,
    DRI_CONTEXT_PRESERVED = 0x02,
    DRI_CONTEXT_RESERVED = 0x04 /* DRI Only -- no kernel equivalent */
} DRIContextFlags;

#define DRI_NO_CONTEXT 0
#define DRI_2D_CONTEXT 1
#define DRI_3D_CONTEXT 2

typedef int DRISwapMethod;

#define DRI_HIDE_X_CONTEXT 0
#define DRI_SERVER_SWAP    1
#define DRI_KERNEL_SWAP    2

typedef int DRIWindowRequests;

#define DRI_NO_WINDOWS       0
#define DRI_3D_WINDOWS_ONLY  1
#define DRI_ALL_WINDOWS      2

typedef void (*ClipNotifyPtr) (WindowPtr, int, int);
typedef void (*AdjustFramePtr) (ScrnInfoPtr pScrn, int x, int y);

/*
 * These functions can be wrapped by the DRI.  Each of these have
 * generic default funcs (initialized in DRICreateInfoRec) and can be
 * overridden by the driver in its [driver]DRIScreenInit function.
 */
typedef struct {
    ScreenWakeupHandlerProcPtr WakeupHandler;
    ScreenBlockHandlerProcPtr BlockHandler;
    WindowExposuresProcPtr WindowExposures;
    CopyWindowProcPtr CopyWindow;
    ClipNotifyProcPtr ClipNotify;
    AdjustFramePtr AdjustFrame;
} DRIWrappedFuncsRec, *DRIWrappedFuncsPtr;

/*
 * Prior to Xorg 6.8.99.8, the DRIInfoRec structure was implicitly versioned
 * by the XF86DRI_*_VERSION defines in xf86dristr.h.  These numbers were also
 * being used to version the XFree86-DRI protocol.  Bugs #3066 and #3163
 * showed that this was inadequate.  The DRIInfoRec structure is now versioned
 * by the DRIINFO_*_VERSION defines in this file. - ajax, 2005-05-18.
 *
 * Revision history:
 * 4.1.0 and earlier: DRIQueryVersion returns XF86DRI_*_VERSION.
 * 4.2.0: DRIQueryVersion begins returning DRIINFO_*_VERSION.
 * 5.0.0: frameBufferPhysicalAddress changed from CARD32 to pointer.
 */

#define DRIINFO_MAJOR_VERSION   5
#define DRIINFO_MINOR_VERSION   4
#define DRIINFO_PATCH_VERSION   0

typedef unsigned long long (*DRITexOffsetStartProcPtr) (PixmapPtr pPix);
typedef void (*DRITexOffsetFinishProcPtr) (PixmapPtr pPix);

typedef struct {
    /* driver call back functions
     *
     * New fields should be added at the end for backwards compatibility.
     * Bump the DRIINFO patch number to indicate bugfixes.
     * Bump the DRIINFO minor number to indicate new fields.
     * Bump the DRIINFO major number to indicate binary-incompatible changes.
     */
    Bool (*CreateContext) (ScreenPtr pScreen,
                           VisualPtr visual,
                           drm_context_t hHWContext,
                           void *pVisualConfigPriv, DRIContextType context);
    void (*DestroyContext) (ScreenPtr pScreen,
                            drm_context_t hHWContext, DRIContextType context);
    void (*SwapContext) (ScreenPtr pScreen,
                         DRISyncType syncType,
                         DRIContextType readContextType,
                         void *readContextStore,
                         DRIContextType writeContextType,
                         void *writeContextStore);
    void (*InitBuffers) (WindowPtr pWin, RegionPtr prgn, CARD32 indx);
    void (*MoveBuffers) (WindowPtr pWin,
                         DDXPointRec ptOldOrg, RegionPtr prgnSrc, CARD32 indx);
    void (*TransitionTo3d) (ScreenPtr pScreen);
    void (*TransitionTo2d) (ScreenPtr pScreen);

    void (*SetDrawableIndex) (WindowPtr pWin, CARD32 indx);
    Bool (*OpenFullScreen) (ScreenPtr pScreen);
    Bool (*CloseFullScreen) (ScreenPtr pScreen);

    /* wrapped functions */
    DRIWrappedFuncsRec wrap;

    /* device info */
    char *drmDriverName;
    char *clientDriverName;
    char *busIdString;
    int ddxDriverMajorVersion;
    int ddxDriverMinorVersion;
    int ddxDriverPatchVersion;
    void *frameBufferPhysicalAddress;
    long frameBufferSize;
    long frameBufferStride;
    long SAREASize;
    int maxDrawableTableEntry;
    int ddxDrawableTableEntry;
    long contextSize;
    DRISwapMethod driverSwapMethod;
    DRIWindowRequests bufferRequests;
    int devPrivateSize;
    void *devPrivate;
    Bool createDummyCtx;
    Bool createDummyCtxPriv;

    /* New with DRI version 4.1.0 */
    void (*TransitionSingleToMulti3D) (ScreenPtr pScreen);
    void (*TransitionMultiToSingle3D) (ScreenPtr pScreen);

    /* New with DRI version 5.1.0 */
    void (*ClipNotify) (ScreenPtr pScreen, WindowPtr *ppWin, int num);

    /* New with DRI version 5.2.0 */
    Bool allocSarea;
    Bool keepFDOpen;

    /* New with DRI version 5.3.0 */
    DRITexOffsetStartProcPtr texOffsetStart;
    DRITexOffsetFinishProcPtr texOffsetFinish;

    /* New with DRI version 5.4.0 */
    int dontMapFrameBuffer;
    drm_handle_t hFrameBuffer;  /* Handle to framebuffer, either
                                 * mapped by DDX driver or DRI */

} DRIInfoRec, *DRIInfoPtr;

extern _X_EXPORT Bool DRIOpenDRMMaster(ScrnInfoPtr pScrn,
                                       unsigned long sAreaSize,
                                       const char *busID,
                                       const char *drmDriverName);

extern _X_EXPORT Bool DRIScreenInit(ScreenPtr pScreen,
                                    DRIInfoPtr pDRIInfo, int *pDRMFD);

extern _X_EXPORT void DRICloseScreen(ScreenPtr pScreen);

extern Bool DRIExtensionInit(void);

extern _X_EXPORT void DRIReset(void);

extern _X_EXPORT Bool DRIQueryDirectRenderingCapable(ScreenPtr pScreen,
                                                     Bool *isCapable);

extern _X_EXPORT Bool DRIOpenConnection(ScreenPtr pScreen,
                                        drm_handle_t * hSAREA,
                                        char **busIdString);

extern _X_EXPORT Bool DRIAuthConnection(ScreenPtr pScreen, drm_magic_t magic);

extern _X_EXPORT Bool DRICloseConnection(ScreenPtr pScreen);

extern _X_EXPORT Bool DRIGetClientDriverName(ScreenPtr pScreen,
                                             int *ddxDriverMajorVersion,
                                             int *ddxDriverMinorVersion,
                                             int *ddxDriverPatchVersion,
                                             char **clientDriverName);

extern _X_EXPORT Bool DRICreateContext(ScreenPtr pScreen,
                                       VisualPtr visual,
                                       XID context, drm_context_t * pHWContext);

extern _X_EXPORT Bool DRIDestroyContext(ScreenPtr pScreen, XID context);

extern _X_EXPORT Bool DRIContextPrivDelete(void *pResource, XID id);

extern _X_EXPORT Bool DRICreateDrawable(ScreenPtr pScreen,
                                        ClientPtr client,
                                        DrawablePtr pDrawable,
                                        drm_drawable_t * hHWDrawable);

extern _X_EXPORT Bool DRIDestroyDrawable(ScreenPtr pScreen,
                                         ClientPtr client,
                                         DrawablePtr pDrawable);

extern _X_EXPORT Bool DRIDrawablePrivDelete(void *pResource, XID id);

extern _X_EXPORT Bool DRIGetDrawableInfo(ScreenPtr pScreen,
                                         DrawablePtr pDrawable,
                                         unsigned int *indx,
                                         unsigned int *stamp,
                                         int *X,
                                         int *Y,
                                         int *W,
                                         int *H,
                                         int *numClipRects,
                                         drm_clip_rect_t ** pClipRects,
                                         int *backX,
                                         int *backY,
                                         int *numBackClipRects,
                                         drm_clip_rect_t ** pBackClipRects);

extern _X_EXPORT Bool DRIGetDeviceInfo(ScreenPtr pScreen,
                                       drm_handle_t * hFrameBuffer,
                                       int *fbOrigin,
                                       int *fbSize,
                                       int *fbStride,
                                       int *devPrivateSize, void **pDevPrivate);

extern _X_EXPORT DRIInfoPtr DRICreateInfoRec(void);

extern _X_EXPORT void DRIDestroyInfoRec(DRIInfoPtr DRIInfo);

extern _X_EXPORT Bool DRIFinishScreenInit(ScreenPtr pScreen);

extern _X_EXPORT void DRIWakeupHandler(void *wakeupData,
                                       int result, void *pReadmask);

extern _X_EXPORT void DRIBlockHandler(void *blockData,
                                      OSTimePtr pTimeout, void *pReadmask);

extern _X_EXPORT void DRIDoWakeupHandler(ScreenPtr pScreen,
                                         unsigned long result,
                                         void *pReadmask);

extern _X_EXPORT void DRIDoBlockHandler(ScreenPtr pScreen,
                                        void *pTimeout, void *pReadmask);

extern _X_EXPORT void DRISwapContext(int drmFD, void *oldctx, void *newctx);

extern _X_EXPORT void *DRIGetContextStore(DRIContextPrivPtr context);

extern _X_EXPORT void DRIWindowExposures(WindowPtr pWin, RegionPtr prgn);

extern _X_EXPORT Bool DRIDestroyWindow(WindowPtr pWin);

extern _X_EXPORT void DRICopyWindow(WindowPtr pWin,
                                    DDXPointRec ptOldOrg, RegionPtr prgnSrc);

extern _X_EXPORT void DRIClipNotify(WindowPtr pWin, int dx, int dy);

extern _X_EXPORT CARD32 DRIGetDrawableIndex(WindowPtr pWin);

extern _X_EXPORT void DRIPrintDrawableLock(ScreenPtr pScreen, char *msg);

extern _X_EXPORT void DRILock(ScreenPtr pScreen, int flags);

extern _X_EXPORT void DRIUnlock(ScreenPtr pScreen);

extern _X_EXPORT DRIWrappedFuncsRec *DRIGetWrappedFuncs(ScreenPtr pScreen);

extern _X_EXPORT void *DRIGetSAREAPrivate(ScreenPtr pScreen);

extern _X_EXPORT unsigned int DRIGetDrawableStamp(ScreenPtr pScreen,
                                                  CARD32 drawable_index);

extern _X_EXPORT DRIContextPrivPtr DRICreateContextPriv(ScreenPtr pScreen,
                                                        drm_context_t *
                                                        pHWContext,
                                                        DRIContextFlags flags);

extern _X_EXPORT DRIContextPrivPtr DRICreateContextPrivFromHandle(ScreenPtr
                                                                  pScreen,
                                                                  drm_context_t
                                                                  hHWContext,
                                                                  DRIContextFlags
                                                                  flags);

extern _X_EXPORT Bool DRIDestroyContextPriv(DRIContextPrivPtr pDRIContextPriv);

extern _X_EXPORT drm_context_t DRIGetContext(ScreenPtr pScreen);

extern _X_EXPORT void DRIQueryVersion(int *majorVersion,
                                      int *minorVersion, int *patchVersion);

extern _X_EXPORT void DRIAdjustFrame(ScrnInfoPtr pScrn, int x, int y);

extern _X_EXPORT void DRIMoveBuffersHelper(ScreenPtr pScreen,
                                           int dx,
                                           int dy,
                                           int *xdir, int *ydir, RegionPtr reg);

extern _X_EXPORT char *DRICreatePCIBusID(const struct pci_device *PciInfo);

#if 0
extern _X_EXPORT int drmInstallSIGIOHandler(int fd,
                                            void (*f) (int, void *, void *));
extern _X_EXPORT int drmRemoveSIGIOHandler(int fd);
#endif
extern _X_EXPORT int DRIMasterFD(ScrnInfoPtr pScrn);

extern _X_EXPORT void *DRIMasterSareaPointer(ScrnInfoPtr pScrn);

extern _X_EXPORT drm_handle_t DRIMasterSareaHandle(ScrnInfoPtr pScrn);

extern _X_EXPORT void DRIGetTexOffsetFuncs(ScreenPtr pScreen,
                                           DRITexOffsetStartProcPtr *
                                           texOffsetStartFunc,
                                           DRITexOffsetFinishProcPtr *
                                           texOffsetFinishFunc);

#define _DRI_H_

#endif
@


1.6
log
@Update to xserver 1.16.1.

Tested by naddy@@, jsg@@ & kettenis@@
@
text
@a87 2
    ValidateTreeProcPtr ValidateTree;
    PostValidateTreeProcPtr PostValidateTree;
d283 1
a283 2
extern _X_EXPORT void DRIWindowExposures(WindowPtr pWin,
                                         RegionPtr prgn, RegionPtr bsreg);
a288 6

extern _X_EXPORT int DRIValidateTree(WindowPtr pParent,
                                     WindowPtr pChild, VTKind kind);

extern _X_EXPORT void DRIPostValidateTree(WindowPtr pParent,
                                          WindowPtr pChild, VTKind kind);
@


1.5
log
@Update to X server 1.14.1. Tested by many during t2k13. Thanks.
@
text
@d154 1
a154 1
    pointer frameBufferPhysicalAddress;
d227 1
a227 1
extern _X_EXPORT Bool DRIContextPrivDelete(pointer pResource, XID id);
d238 1
a238 1
extern _X_EXPORT Bool DRIDrawablePrivDelete(pointer pResource, XID id);
d268 2
a269 2
extern _X_EXPORT void DRIWakeupHandler(pointer wakeupData,
                                       int result, pointer pReadmask);
d271 2
a272 2
extern _X_EXPORT void DRIBlockHandler(pointer blockData,
                                      OSTimePtr pTimeout, pointer pReadmask);
d276 1
a276 1
                                         pointer pReadmask);
d279 1
a279 1
                                        pointer pTimeout, pointer pReadmask);
@


1.4
log
@Update to xserver 1.12.2. tested by naddy@@, krw@@, mpi@@.
@
text
@d76 1
a76 1
typedef void (*AdjustFramePtr) (int scrnIndex, int x, int y, int flags);
d200 1
a200 1
extern _X_EXPORT Bool DRIExtensionInit(void);
d274 1
a274 2
extern _X_EXPORT void DRIDoWakeupHandler(int screenNum,
                                         pointer wakeupData,
d278 1
a278 2
extern _X_EXPORT void DRIDoBlockHandler(int screenNum,
                                        pointer blockData,
d335 1
a335 1
extern _X_EXPORT void DRIAdjustFrame(int scrnIndex, int x, int y, int flags);
d344 1
d348 1
@


1.3
log
@Update to xserver 1.8. Tested by many. Ok oga@@, todd@@.
@
text
@d53 2
a54 3
typedef enum _DRIContextFlags
{
    DRI_CONTEXT_2DONLY    = 0x01,
d56 1
a56 1
    DRI_CONTEXT_RESERVED  = 0x04 /* DRI Only -- no kernel equivalent */
d75 2
a76 4

typedef void (*ClipNotifyPtr)( WindowPtr, int, int );
typedef void (*AdjustFramePtr)(int scrnIndex, int x, int y, int flags);

d84 8
a91 8
    ScreenWakeupHandlerProcPtr   WakeupHandler;
    ScreenBlockHandlerProcPtr    BlockHandler;
    WindowExposuresProcPtr       WindowExposures;
    CopyWindowProcPtr            CopyWindow;
    ValidateTreeProcPtr          ValidateTree;
    PostValidateTreeProcPtr      PostValidateTree;
    ClipNotifyProcPtr            ClipNotify;
    AdjustFramePtr               AdjustFrame;
a93 1

d111 2
a112 2
typedef unsigned long long (*DRITexOffsetStartProcPtr)(PixmapPtr pPix);
typedef void (*DRITexOffsetFinishProcPtr)(PixmapPtr pPix);
d122 21
a142 27
    Bool	(*CreateContext)(ScreenPtr pScreen,
				 VisualPtr visual,
				 drm_context_t hHWContext,
				 void* pVisualConfigPriv,
				 DRIContextType context);
    void        (*DestroyContext)(ScreenPtr pScreen,
				  drm_context_t hHWContext,
                                  DRIContextType context);
    void	(*SwapContext)(ScreenPtr pScreen,
			       DRISyncType syncType,
			       DRIContextType readContextType,
			       void* readContextStore,
			       DRIContextType writeContextType,
			       void* writeContextStore);
    void	(*InitBuffers)(WindowPtr pWin,
			       RegionPtr prgn,
			       CARD32 indx);
    void	(*MoveBuffers)(WindowPtr pWin,
			       DDXPointRec ptOldOrg,
			       RegionPtr prgnSrc,
			       CARD32 indx);
    void        (*TransitionTo3d)(ScreenPtr pScreen);
    void        (*TransitionTo2d)(ScreenPtr pScreen);

    void	(*SetDrawableIndex)(WindowPtr pWin, CARD32 indx);
    Bool        (*OpenFullScreen)(ScreenPtr pScreen);
    Bool        (*CloseFullScreen)(ScreenPtr pScreen);
d145 1
a145 1
    DRIWrappedFuncsRec  wrap;
d148 19
a166 19
    char*		drmDriverName;
    char*		clientDriverName;
    char*		busIdString;
    int			ddxDriverMajorVersion;
    int			ddxDriverMinorVersion;
    int			ddxDriverPatchVersion;
    pointer		frameBufferPhysicalAddress;
    long		frameBufferSize;
    long		frameBufferStride;
    long		SAREASize;
    int			maxDrawableTableEntry;
    int			ddxDrawableTableEntry;
    long		contextSize;
    DRISwapMethod	driverSwapMethod;
    DRIWindowRequests	bufferRequests;
    int			devPrivateSize;
    void*		devPrivate;
    Bool		createDummyCtx;
    Bool		createDummyCtxPriv;
d169 2
a170 2
    void        (*TransitionSingleToMulti3D)(ScreenPtr pScreen);
    void        (*TransitionMultiToSingle3D)(ScreenPtr pScreen);
d173 1
a173 1
    void        (*ClipNotify)(ScreenPtr pScreen, WindowPtr *ppWin, int num);
d176 2
a177 2
    Bool                allocSarea;
    Bool                keepFDOpen;
d180 1
a180 1
    DRITexOffsetStartProcPtr  texOffsetStart;
d184 4
a187 4
    int			dontMapFrameBuffer;
    drm_handle_t   	hFrameBuffer; /* Handle to framebuffer, either
				       * mapped by DDX driver or DRI */
    
d190 4
a193 4

extern _X_EXPORT Bool DRIOpenDRMMaster(ScrnInfoPtr pScrn, unsigned long sAreaSize,
			     const char *busID,
			     const char *drmDriverName);
d196 1
a196 2
                          DRIInfoPtr pDRIInfo,
                          int *pDRMFD);
d205 1
a205 1
                                           Bool *isCapable);
d208 2
a209 2
                              drm_handle_t * hSAREA,
                              char **busIdString);
d216 4
a219 4
                                   int* ddxDriverMajorVersion,
                                   int* ddxDriverMinorVersion,
                                   int* ddxDriverPatchVersion,
                                   char** clientDriverName);
d222 2
a223 3
                             VisualPtr visual,
                             XID context,
                             drm_context_t * pHWContext);
d230 3
a232 3
                              ClientPtr client,
                              DrawablePtr pDrawable,
                              drm_drawable_t * hHWDrawable);
d235 2
a236 2
			       ClientPtr client,
                               DrawablePtr pDrawable);
d238 1
a238 2
extern _X_EXPORT Bool DRIDrawablePrivDelete(pointer pResource,
                                  XID id);
d241 13
a253 13
                               DrawablePtr pDrawable,
                               unsigned int* indx,
                               unsigned int* stamp,
                               int* X,
                               int* Y,
                               int* W,
                               int* H,
                               int* numClipRects,
                               drm_clip_rect_t ** pClipRects,
                               int* backX,
                               int* backY,
                               int* numBackClipRects,
                               drm_clip_rect_t ** pBackClipRects);
d256 5
a260 6
                             drm_handle_t * hFrameBuffer,
                             int* fbOrigin,
                             int* fbSize,
                             int* fbStride,
                             int* devPrivateSize,
                             void** pDevPrivate);
d269 1
a269 2
                             int result,
                             pointer pReadmask);
d272 1
a272 2
                            OSTimePtr pTimeout,
                            pointer pReadmask);
d275 3
a277 3
                               pointer wakeupData,
                               unsigned long result,
                               pointer pReadmask);
d280 4
a283 7
                              pointer blockData,
                              pointer pTimeout,
                              pointer pReadmask);

extern _X_EXPORT void DRISwapContext(int drmFD,
                           void *oldctx,
                           void *newctx);
d288 1
a288 2
                              RegionPtr prgn,
                              RegionPtr bsreg);
d293 1
a293 2
                          DDXPointRec ptOldOrg,
                          RegionPtr prgnSrc);
d296 1
a296 2
                           WindowPtr pChild,
                           VTKind    kind);
d299 1
a299 2
                                WindowPtr pChild,
                                VTKind    kind);
d301 1
a301 3
extern _X_EXPORT void DRIClipNotify(WindowPtr pWin,
                          int dx,
                          int dy);
d316 1
a316 1
                                        CARD32 drawable_index);
d319 3
a321 2
                                              drm_context_t * pHWContext,
                                              DRIContextFlags flags);
d323 6
a328 3
extern _X_EXPORT DRIContextPrivPtr DRICreateContextPrivFromHandle(ScreenPtr pScreen,
                                                        drm_context_t hHWContext,
                                                        DRIContextFlags flags);
d335 1
a335 2
                            int *minorVersion,
                            int *patchVersion);
d340 3
a342 5
                                 int dx,
                                 int dy,
                                 int *xdir, 
                                 int *ydir, 
                                 RegionPtr reg);
d346 2
a347 1
extern _X_EXPORT int drmInstallSIGIOHandler(int fd, void (*f)(int, void *, void *));
d356 4
a359 2
				 DRITexOffsetStartProcPtr *texOffsetStartFunc,
				 DRITexOffsetFinishProcPtr *texOffsetFinishFunc);
@


1.2
log
@xserver 1.5.2. tested by ckuethe@@, oga@@, and others.
@
text
@d201 1
a201 1
extern Bool DRIOpenDRMMaster(ScrnInfoPtr pScrn, unsigned long sAreaSize,
d205 1
a205 1
extern Bool DRIScreenInit(ScreenPtr pScreen,
d209 1
a209 1
extern void DRICloseScreen(ScreenPtr pScreen);
d211 1
a211 1
extern Bool DRIExtensionInit(void);
d213 1
a213 1
extern void DRIReset(void);
d215 1
a215 1
extern Bool DRIQueryDirectRenderingCapable(ScreenPtr pScreen,
d218 1
a218 1
extern Bool DRIOpenConnection(ScreenPtr pScreen,
d222 1
a222 1
extern Bool DRIAuthConnection(ScreenPtr pScreen, drm_magic_t magic);
d224 1
a224 1
extern Bool DRICloseConnection(ScreenPtr pScreen);
d226 1
a226 1
extern Bool DRIGetClientDriverName(ScreenPtr pScreen,
d232 1
a232 1
extern Bool DRICreateContext(ScreenPtr pScreen,
d237 1
a237 1
extern Bool DRIDestroyContext(ScreenPtr pScreen, XID context);
d239 1
a239 1
extern Bool DRIContextPrivDelete(pointer pResource, XID id);
d241 1
a241 1
extern Bool DRICreateDrawable(ScreenPtr pScreen,
d246 1
a246 1
extern Bool DRIDestroyDrawable(ScreenPtr pScreen, 
d250 1
a250 1
extern Bool DRIDrawablePrivDelete(pointer pResource,
d253 1
a253 1
extern Bool DRIGetDrawableInfo(ScreenPtr pScreen,
d268 1
a268 1
extern Bool DRIGetDeviceInfo(ScreenPtr pScreen,
d276 1
a276 1
extern DRIInfoPtr DRICreateInfoRec(void);
d278 1
a278 1
extern void DRIDestroyInfoRec(DRIInfoPtr DRIInfo);
d280 1
a280 1
extern Bool DRIFinishScreenInit(ScreenPtr pScreen);
d282 1
a282 1
extern void DRIWakeupHandler(pointer wakeupData,
d286 1
a286 1
extern void DRIBlockHandler(pointer blockData,
d290 1
a290 1
extern void DRIDoWakeupHandler(int screenNum,
d295 1
a295 1
extern void DRIDoBlockHandler(int screenNum,
d300 1
a300 1
extern void DRISwapContext(int drmFD,
d304 1
a304 1
extern void *DRIGetContextStore(DRIContextPrivPtr context);
d306 1
a306 1
extern void DRIWindowExposures(WindowPtr pWin,
d310 1
a310 1
extern Bool DRIDestroyWindow(WindowPtr pWin);
d312 1
a312 1
extern void DRICopyWindow(WindowPtr pWin,
d316 1
a316 1
extern int DRIValidateTree(WindowPtr pParent,
d320 1
a320 1
extern void DRIPostValidateTree(WindowPtr pParent,
d324 1
a324 1
extern void DRIClipNotify(WindowPtr pWin,
d328 1
a328 1
extern CARD32 DRIGetDrawableIndex(WindowPtr pWin);
d330 1
a330 1
extern void DRIPrintDrawableLock(ScreenPtr pScreen, char *msg);
d332 1
a332 1
extern void DRILock(ScreenPtr pScreen, int flags);
d334 1
a334 1
extern void DRIUnlock(ScreenPtr pScreen);
d336 1
a336 1
extern DRIWrappedFuncsRec *DRIGetWrappedFuncs(ScreenPtr pScreen);
d338 1
a338 1
extern void *DRIGetSAREAPrivate(ScreenPtr pScreen);
d340 1
a340 1
extern unsigned int DRIGetDrawableStamp(ScreenPtr pScreen,
d343 1
a343 1
extern DRIContextPrivPtr DRICreateContextPriv(ScreenPtr pScreen,
d347 1
a347 1
extern DRIContextPrivPtr DRICreateContextPrivFromHandle(ScreenPtr pScreen,
d351 1
a351 1
extern Bool DRIDestroyContextPriv(DRIContextPrivPtr pDRIContextPriv);
d353 1
a353 1
extern drm_context_t DRIGetContext(ScreenPtr pScreen);
d355 1
a355 1
extern void DRIQueryVersion(int *majorVersion,
d359 1
a359 1
extern void DRIAdjustFrame(int scrnIndex, int x, int y, int flags);
d361 1
a361 1
extern void DRIMoveBuffersHelper(ScreenPtr pScreen, 
d368 1
a368 1
extern char *DRICreatePCIBusID(const struct pci_device *PciInfo);
d370 3
a372 3
extern int drmInstallSIGIOHandler(int fd, void (*f)(int, void *, void *));
extern int drmRemoveSIGIOHandler(int fd);
extern int DRIMasterFD(ScrnInfoPtr pScrn);
d374 1
a374 1
extern void *DRIMasterSareaPointer(ScrnInfoPtr pScrn);
d376 1
a376 1
extern drm_handle_t DRIMasterSareaHandle(ScrnInfoPtr pScrn);
d378 1
a378 1
extern void DRIGetTexOffsetFuncs(ScreenPtr pScreen,
@


1.1
log
@Initial revision
@
text
@d38 2
d112 1
a112 1
#define DRIINFO_MINOR_VERSION   0
d115 3
d181 17
d201 4
d242 1
a242 1
                              Drawable id,
d247 1
a247 1
                               Drawable id,
d310 2
d368 13
a380 1
extern char *DRICreatePCIBusID(pciVideoPtr PciInfo);
@


1.1.1.1
log
@Importing xserver from X.Org 7.2RC2
@
text
@@


1.1.1.2
log
@xserver 1.1.99.903 from X.Org 7.2RC3
@
text
@a341 2
extern int drmInstallSIGIOHandler(int fd, void (*f)(int, void *, void *));
extern int drmRemoveSIGIOHandler(int fd);
@


1.1.1.3
log
@xserver 1.4
@
text
@d110 1
a110 1
#define DRIINFO_MINOR_VERSION   4
a112 3
typedef unsigned long long (*DRITexOffsetStartProcPtr)(PixmapPtr pPix);
typedef void (*DRITexOffsetFinishProcPtr)(PixmapPtr pPix);

a175 17

    /* New with DRI version 5.1.0 */
    void        (*ClipNotify)(ScreenPtr pScreen, WindowPtr *ppWin, int num);

    /* New with DRI version 5.2.0 */
    Bool                allocSarea;
    Bool                keepFDOpen;

    /* New with DRI version 5.3.0 */
    DRITexOffsetStartProcPtr  texOffsetStart;
    DRITexOffsetFinishProcPtr texOffsetFinish;

    /* New with DRI version 5.4.0 */
    int			dontMapFrameBuffer;
    drm_handle_t   	hFrameBuffer; /* Handle to framebuffer, either
				       * mapped by DDX driver or DRI */
    
a178 4
extern Bool DRIOpenDRMMaster(ScrnInfoPtr pScrn, unsigned long sAreaSize,
			     const char *busID,
			     const char *drmDriverName);

d216 1
a216 1
                              ClientPtr client,
d221 1
a221 1
			       ClientPtr client,
a283 2
extern Bool DRIDestroyWindow(WindowPtr pWin);

a343 10
extern int DRIMasterFD(ScrnInfoPtr pScrn);

extern void *DRIMasterSareaPointer(ScrnInfoPtr pScrn);

extern drm_handle_t DRIMasterSareaHandle(ScrnInfoPtr pScrn);

extern void DRIGetTexOffsetFuncs(ScreenPtr pScreen,
				 DRITexOffsetStartProcPtr *texOffsetStartFunc,
				 DRITexOffsetFinishProcPtr *texOffsetFinishFunc);

@


