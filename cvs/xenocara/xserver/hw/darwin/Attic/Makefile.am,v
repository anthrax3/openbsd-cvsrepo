head	1.2;
access;
symbols
	OPENBSD_4_4:1.1.1.2.0.4
	OPENBSD_4_4_BASE:1.1.1.2
	OPENBSD_4_3_BASE:1.1.1.2
	OPENBSD_4_3:1.1.1.2.0.2
	v1_4_0_90:1.1.1.2
	v1_4:1.1.1.2
	OPENBSD_4_2:1.1.1.1.0.2
	OPENBSD_4_2_BASE:1.1.1.1
	v1_2_0:1.1.1.1
	v1_1_99_903:1.1.1.1
	v1_1_99_902:1.1.1.1
	xorg:1.1.1;
locks; strict;
comment	@# @;


1.2
date	2008.11.02.15.26.14;	author matthieu;	state dead;
branches;
next	1.1;

1.1
date	2006.11.26.18.16.30;	author matthieu;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2006.11.26.18.16.30;	author matthieu;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	2007.11.24.18.01.52;	author matthieu;	state Exp;
branches;
next	;


desc
@@


1.2
log
@xserver 1.5.2. tested by ckuethe@@, oga@@, and others.
@
text
@EXTRA_DIST = \
	bundle/Dutch.lproj/Credits.rtf \
	bundle/Dutch.lproj/Localizable.strings \
	bundle/Dutch.lproj/MainMenu.nib/classes.nib \
	bundle/Dutch.lproj/MainMenu.nib/objects.nib \
	bundle/Dutch.lproj/XDarwinHelp.html.cpp \
	bundle/English.lproj/Credits.rtf \
	bundle/English.lproj/InfoPlist.strings.cpp \
	bundle/English.lproj/Localizable.strings \
	bundle/English.lproj/MainMenu.nib/classes.nib \
	bundle/English.lproj/MainMenu.nib/objects.nib \
	bundle/English.lproj/XDarwinHelp.html.cpp \
	bundle/French.lproj/Credits.rtf \
	bundle/French.lproj/Localizable.strings \
	bundle/French.lproj/MainMenu.nib/classes.nib \
	bundle/French.lproj/MainMenu.nib/objects.nib \
	bundle/French.lproj/XDarwinHelp.html.cpp \
	bundle/German.lproj/Credits.rtf \
	bundle/German.lproj/Localizable.strings \
	bundle/German.lproj/MainMenu.nib/classes.nib \
	bundle/German.lproj/MainMenu.nib/objects.nib \
	bundle/German.lproj/XDarwinHelp.html.cpp \
	bundle/Japanese.lproj/Credits.rtf \
	bundle/Japanese.lproj/Localizable.strings \
	bundle/Japanese.lproj/MainMenu.nib/classes.nib \
	bundle/Japanese.lproj/MainMenu.nib/objects.nib \
	bundle/Japanese.lproj/XDarwinHelp.html.cpp \
	bundle/ko.lproj/Credits.rtf \
	bundle/ko.lproj/Localizable.strings \
	bundle/ko.lproj/MainMenu.nib/classes.nib \
	bundle/ko.lproj/MainMenu.nib/objects.nib \
	bundle/ko.lproj/XDarwinHelp.html.cpp \
	bundle/Portuguese.lproj/Credits.rtf \
	bundle/Portuguese.lproj/Localizable.strings \
	bundle/Portuguese.lproj/MainMenu.nib/classes.nib \
	bundle/Portuguese.lproj/MainMenu.nib/objects.nib \
	bundle/Portuguese.lproj/XDarwinHelp.html.cpp \
	bundle/Spanish.lproj/Credits.rtf \
	bundle/Spanish.lproj/Localizable.strings \
	bundle/Spanish.lproj/MainMenu.nib/classes.nib \
	bundle/Spanish.lproj/MainMenu.nib/objects.nib \
	bundle/Spanish.lproj/XDarwinHelp.html.cpp \
	bundle/startXClients.cpp \
	bundle/Swedish.lproj/Credits.rtf \
	bundle/Swedish.lproj/Localizable.strings \
	bundle/Swedish.lproj/MainMenu.nib/classes.nib \
	bundle/Swedish.lproj/MainMenu.nib/objects.nib \
	bundle/Swedish.lproj/XDarwinHelp.html.cpp \
	bundle/XDarwin.icns \
	darwin.c \
	darwinClut8.h \
	darwinEvents.c \
	darwin.h \
	darwinKeyboard.c \
	darwinKeyboard.h \
	darwinXinput.c \
	iokit/xfIOKit.c \
	iokit/xfIOKitCursor.c \
	iokit/xfIOKit.h \
	iokit/xfIOKitStartup.c \
	Makefile.am \
	quartz/applewm.c \
	quartz/applewmExt.h \
	quartz/cr/crAppleWM.m \
	quartz/cr/crFrame.m \
	quartz/cr/cr.h \
	quartz/cr/crScreen.m \
	quartz/cr/XView.h \
	quartz/cr/XView.m \
	quartz/fullscreen/fullscreen.c \
	quartz/fullscreen/quartzCursor.c \
	quartz/fullscreen/quartzCursor.h \
	quartz/keysym2ucs.c \
	quartz/keysym2ucs.h \
	quartz/Preferences.h \
	quartz/Preferences.m \
	quartz/pseudoramiX.c \
	quartz/pseudoramiX.h \
	quartz/quartzAudio.c \
	quartz/quartzAudio.h \
	quartz/quartz.c \
	quartz/quartzCocoa.m \
	quartz/quartzCommon.h \
	quartz/quartzCursor.c \
	quartz/quartzCursor.h \
	quartz/quartz.h \
	quartz/quartzKeyboard.c \
	quartz/quartzPasteboard.c \
	quartz/quartzPasteboard.h \
	quartz/quartzStartup.c \
	quartz/XApplication.h \
	quartz/XApplication.m \
	quartz/XDarwin.pbproj/project.pbxproj \
	quartz/XDarwinStartup.c \
	quartz/XDarwinStartup.man \
	quartz/xpr/appledri.c \
	quartz/xpr/dri.c \
	quartz/xpr/dri.h \
	quartz/xpr/dristruct.h \
	quartz/xpr/x-hash.c \
	quartz/xpr/x-hash.h \
	quartz/xpr/x-hook.c \
	quartz/xpr/x-hook.h \
	quartz/xpr/x-list.c \
	quartz/xpr/x-list.h \
	quartz/xpr/Xplugin.h \
	quartz/xpr/xprAppleWM.c \
	quartz/xpr/xprCursor.c \
	quartz/xpr/xprFrame.c \
	quartz/xpr/xpr.h \
	quartz/xpr/xprScreen.c \
	quartz/XServer.h \
	quartz/XServer.m \
	utils/dumpkeymap.c \
	utils/dumpkeymap.man \
	utils/README.txt \
	XDarwin.man
@


1.1
log
@Initial revision
@
text
@@


1.1.1.1
log
@Importing xserver from X.Org 7.2RC2
@
text
@@


1.1.1.2
log
@xserver 1.4
@
text
@a0 278
noinst_LIBRARIES = libdarwinShared.a
libdarwin_XINPUT_SRCS = darwinXinput.c

AM_CFLAGS = @@XORG_CFLAGS@@ @@DIX_CFLAGS@@
AM_CPPFLAGS = @@XORG_CFLAGS@@ @@DIX_CFLAGS@@
INCLUDES = @@XORG_INCS@@ -I../../miext/rootless

DEFS = @@DEFS@@ -DUSE_NEW_CLUT

if XQUARTZ
XQUARTZ_SUBDIRS = bundle quartz
endif

SUBDIRS = \
	  iokit \
	  $(XQUARTZ_SUBDIRS) \
	  utils \
	  .

darwinappdir = @@APPLE_APPLICATIONS_DIR@@/XDarwin.app

libdarwinShared_a_SOURCES = darwin.c \
			  darwinEvents.c \
			  darwinKeyboard.c \
			  $(darwin_XINPUT_SRCS) 

bin_PROGRAMS = XDarwin Xquartz
XDarwin_SOURCES = \
                  $(top_srcdir)/fb/fbcmap_mi.c \
                  $(top_srcdir)/mi/miinitext.c \
                  $(top_srcdir)/Xi/stubs.c

Xquartz_SOURCES = \
                  $(top_srcdir)/fb/fbcmap_mi.c \
                  $(top_srcdir)/mi/miinitext.c \
                  $(top_srcdir)/Xi/stubs.c \
                  apple/X11Application.m \
                  apple/X11Controller.m \
                  quartz/Preferences.m \
                  quartz/applewm.c \
                  quartz/keysym2ucs.c \
                  quartz/pseudoramiX.c \
                  quartz/quartz.c \
                  quartz/quartzAudio.c \
                  quartz/quartzCocoa.m \
                  quartz/quartzKeyboard.c \
                  quartz/quartzPasteboard.c \
                  quartz/quartzStartup.c \
                  quartz/xpr/appledri.c \
                  quartz/xpr/dri.c \
                  quartz/xpr/xprAppleWM.c \
                  quartz/xpr/xprCursor.c \
                  quartz/xpr/xprFrame.c \
                  quartz/xpr/xprScreen.c \
                  quartz/xpr/x-hash.c \
                  quartz/xpr/x-hook.c \
                  quartz/xpr/x-list.c

XDarwin_LDADD = \
		$(top_builddir)/dix/dixfonts.lo \
		$(top_builddir)/dix/libdix.la \
		$(top_builddir)/config/libconfig.a \
		./libdarwinShared.a \
		./iokit/libiokit.a \
		$(top_builddir)/miext/shadow/libshadow.la \
		$(top_builddir)/miext/cw/libcw.la \
		$(DARWIN_LIBS) \
		$(top_builddir)/miext/rootless/librootless.la \
		$(top_builddir)/miext/rootless/safeAlpha/libsafeAlpha.la \
		$(top_builddir)/miext/rootless/accel/librlAccel.la \
		@@XORG_LIBS@@ \
		$(XSERVER_LIBS)

Xquartz_LDADD = \
		$(top_builddir)/dix/dixfonts.lo \
		$(top_builddir)/dix/libdix.la \
		$(top_builddir)/config/libconfig.a \
		./libdarwinShared.a \
		$(top_builddir)/miext/shadow/libshadow.la \
		$(top_builddir)/miext/cw/libcw.la \
		$(DARWIN_LIBS) \
		$(top_builddir)/miext/rootless/librootless.la \
		$(top_builddir)/miext/rootless/safeAlpha/libsafeAlpha.la \
		$(top_builddir)/miext/rootless/accel/librlAccel.la \
		@@XORG_LIBS@@ \
		$(XSERVER_LIBS) -lXplugin

XDarwin_LDFLAGS =  \
                 -XCClinker -Objc \
                 -Wl,-u,_miDCInitialize \
                 -Wl,-framework,IOKit

Xquartz_LDFLAGS =  \
                 -XCClinker -Objc \
                 -Wl,-u,_miDCInitialize \
                 -Wl,-framework,Carbon \
                 -Wl,-framework,OpenGL \
                 -Wl,-framework,Cocoa \
                 -Wl,-framework,CoreAudio \
                 -Wl,-framework,IOKit

XDarwin_CFLAGS = -DINXDARWIN
Xquartz_CFLAGS = -DINXQUARTZ -DHAS_CG_MACH_PORT -DHAS_KL_API  -DHAVE_XORG_CONFIG_H

if XQUARTZ
macosdir = $(darwinappdir)/Contents/MacOS

DEFS += -DDARWIN_WITH_QUARTZ -DXFree86Server

macos_PROGRAMS = XDarwinApp
macos_SCRIPTS = x11app

x11app:
	cd apple && xcodebuild CFLAGS="$(XSERVERCFLAGS_CFLAGS)" LDFLAGS="$(XSERVERCFLAGS_LIBS)"

XDarwinApp_SOURCES = \
                $(top_srcdir)/fb/fbcmap_mi.c \
                $(top_srcdir)/mi/miinitext.c \
		$(top_srcdir)/Xi/stubs.c 

XDarwinApp_LDADD = \
		$(top_builddir)/dix/dixfonts.lo \
		$(top_builddir)/dix/libdix.la \
		$(top_builddir)/config/libconfig.a \
		$(top_builddir)/os/libos.la \
		./quartz/XApplication.o \
		./libdarwinShared.a \
		./quartz/libXQuartz.a \
		 $(top_builddir)/miext/shadow/libshadow.la \
		 $(top_builddir)/miext/cw/libcw.la \
		 $(DARWIN_LIBS) \
		 $(top_builddir)/miext/rootless/librootless.la \
		 $(top_builddir)/miext/rootless/safeAlpha/libsafeAlpha.la \
		 $(top_builddir)/miext/rootless/accel/librlAccel.la \
		 @@XORG_LIBS@@ \
		 $(XSERVER_LIBS)

XDarwinApp_LDFLAGS =  \
		 -XCClinker -Objc \
		 -Wl,-u,_miDCInitialize \
		 -Wl,-framework,Carbon \
		 -Wl,-framework,ApplicationServices \
		 -Wl,-framework,Cocoa \
		 -Wl,-framework,CoreAudio \
		 -Wl,-framework,IOKit

XDarwinApp_CFLAGS = -DINXDARWINAPP
HOOK_TARGETS = xquartz-install-hook


crplugindir = $(darwinappdir)/Contents/Resources/cr.bundle/Contents/MacOS
crplugin_LTLIBRARIES = cr.la
cr_la_SOURCES = \
		quartz/cr/crAppleWM.m \
		quartz/cr/crFrame.m \
		quartz/cr/crScreen.m \
		quartz/fullscreen/quartzCursor.c \
		quartz/cr/XView.m

cr_la_LIBADD = \
		$(top_builddir)/miext/rootless/librootless.la \
		$(top_builddir)/miext/rootless/safeAlpha/libsafeAlpha.la \
		$(top_builddir)/miext/rootless/accel/librlAccel.la

cr_la_LDFLAGS = -shrext '' -Wl,-framework,ApplicationServices \
		-Wl,-framework,Cocoa \
		-Wl,-framework,Carbon \
		-XCClinker -ObjC \
		-XCClinker -bundle_loader -XCClinker XDarwinApp \
		-module -avoid-version -no-undefined
cr_la_DEPENDENCIES = XDarwinApp	

fullscreenplugindir = $(darwinappdir)/Contents/Resources/fullscreen.bundle/Contents/MacOS
fullscreenplugin_LTLIBRARIES = fullscreen.la
fullscreen_la_SOURCES = \
		quartz/fullscreen/fullscreen.c \
		quartz/fullscreen/quartzCursor.c

fullscreen_la_LIBADD = \
		$(top_builddir)/miext/shadow/libshadow.la

fullscreen_la_LDFLAGS = -shrext '' -Wl,-framework,ApplicationServices \
		-XCClinker -bundle_loader -XCClinker XDarwinApp \
		-module -avoid-version -no-undefined
fullscreen_la_DEPENDENCIES = XDarwinApp	

if GLX
glxMesaplugindir = $(darwinappdir)/Contents/Resources/glxMesa.bundle/Contents/MacOS
glxMesaplugin_LTLIBRARIES = glxMesa.la
glxMesa_la_SOURCES =
glxMesa_la_LIBADD = \
		$(top_builddir)/GL/glx/libglx.la \
		$(top_builddir)/GL/mesa/libGLcore.la 
glxMesa_la_LDFLAGS = -shrext '' \
		-Wl,-framework,AGL \
		-Wl,-framework,OpenGL \
		-XCClinker -ObjC \
		-XCClinker -bundle_loader -XCClinker XDarwinApp \
		-module -avoid-version -no-undefined
glxMesa_la_DEPENDENCIES = XDarwinApp	
endif

endif
if HAVE_X_PLUGIN

xprplugindir = $(darwinappdir)/Contents/Resources/xpr.bundle/Contents/MacOS
xprplugin_LTLIBRARIES = xpr.la
xpr_la_SOURCES = \
		quartz/xpr/appledri.c \
		quartz/xpr/dri.c \
		quartz/xpr/xprAppleWM.c \
		quartz/xpr/xprCursor.c \
		quartz/xpr/xprFrame.c \
		quartz/xpr/xprScreen.c \
		quartz/xpr/x-hash.c \
		quartz/xpr/x-hook.c \
		quartz/xpr/x-list.c

xpr_la_LIBADD = \
		$(top_builddir)/miext/rootless/librootless.la \
		$(top_builddir)/miext/rootless/safeAlpha/libsafeAlpha.la \
		$(top_builddir)/miext/rootless/accel/librlAccel.la

xpr_la_LDFLAGS = -shrext '' -Wl,-framework,ApplicationServices \
		-lXplugin \
		-XCClinker -bundle_loader -XCClinker XDarwinApp \
		-module -avoid-version -no-undefined
xpr_la_DEPENDENCIES = XDarwinApp	

endif

if HAVE_AGL_FRAMEWORK
glxCGLplugindir = $(darwinappdir)/Contents/Resources/glxCGL.bundle/Contents/MacOS
glxCGLplugin_LTLIBRARIES = glxCGL.la
glxCGL_la_SOURCES =
glxCGL_la_LIBADD = \
		$(top_builddir)/GL/glx/glxext.o \
		$(top_builddir)/GL/glx/libglx.a \
		$(top_builddir)/GL/apple/libAGLcore.a
glxCGL_la_LDFLAGS = -shrext '' -Wl,-framework,ApplicationServices \
		-Wl,-framework,AGL \
		-Wl,-framework,OpenGL \
		-XCClinker -ObjC \
		-XCClinker -bundle_loader -XCClinker XDarwinApp \
		-module -avoid-version -no-undefined
glxCGL_la_DEPENDENCIES = XDarwinApp	


glxAGLplugindir = $(darwinappdir)/Contents/Resources/glxAGL.bundle/Contents/MacOS
glxAGLplugin_LTLIBRARIES = glxAGL.la
glxAGL_la_SOURCES =
glxAGL_la_LIBADD = \
		$(top_builddir)/GL/glx/glxext.o \
		$(top_builddir)/GL/glx/libglx.a \
		$(top_builddir)/GL/apple/libAGLcore.a
glxAGL_la_LDFLAGS = -shrext '' \
		-Wl,-framework,AGL \
		-Wl,-framework,OpenGL \
		-XCClinker -ObjC \
		-XCClinker -bundle_loader -XCClinker XDarwinApp \
		-module -avoid-version -no-undefined
glxAGL_la_DEPENDENCIES = XDarwinApp	



endif

man1_MANS = XDarwin.man

uninstall-hook:
	rm -rf $(DESTDIR)$(macosdir)/XDarwin

install-data-hook: $(HOOK_TARGETS)

xquartz-install-hook:
	mv $(DESTDIR)$(macosdir)/XDarwinApp $(DESTDIR)$(macosdir)/XDarwin
	cd apple && xcodebuild install

d2 48
d57 60
@

