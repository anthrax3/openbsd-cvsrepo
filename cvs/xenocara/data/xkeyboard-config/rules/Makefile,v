head	1.10;
access;
symbols
	OPENBSD_6_2:1.10.0.14
	OPENBSD_6_2_BASE:1.10
	OPENBSD_6_1:1.10.0.12
	OPENBSD_6_1_BASE:1.10
	OPENBSD_6_0:1.10.0.10
	OPENBSD_6_0_BASE:1.10
	OPENBSD_5_9:1.10.0.8
	OPENBSD_5_9_BASE:1.10
	OPENBSD_5_8:1.10.0.6
	OPENBSD_5_8_BASE:1.10
	OPENBSD_5_7:1.10.0.4
	OPENBSD_5_7_BASE:1.10
	OPENBSD_5_6:1.10.0.2
	OPENBSD_5_6_BASE:1.10
	OPENBSD_5_5:1.8.0.6
	OPENBSD_5_5_BASE:1.8
	OPENBSD_5_4:1.8.0.4
	OPENBSD_5_4_BASE:1.8
	OPENBSD_5_3:1.8.0.2
	OPENBSD_5_3_BASE:1.8
	OPENBSD_5_2:1.7.0.2
	OPENBSD_5_2_BASE:1.7
	OPENBSD_5_1_BASE:1.6
	OPENBSD_5_1:1.6.0.2
	OPENBSD_5_0:1.5.0.2
	OPENBSD_5_0_BASE:1.5
	OPENBSD_4_9:1.3.0.2
	OPENBSD_4_9_BASE:1.3
	OPENBSD_4_8:1.2.0.8
	OPENBSD_4_8_BASE:1.2
	OPENBSD_4_7:1.2.0.4
	OPENBSD_4_7_BASE:1.2
	OPENBSD_4_6:1.2.0.2
	OPENBSD_4_6_BASE:1.2
	v0_0:1.1.1.1
	xenocara:1.1.1;
locks; strict;
comment	@# @;


1.10
date	2014.05.05.18.05.33;	author shadchin;	state Exp;
branches;
next	1.9;

1.9
date	2014.03.29.14.27.12;	author ajacoutot;	state Exp;
branches;
next	1.8;

1.8
date	2012.09.28.19.00.00;	author espie;	state Exp;
branches;
next	1.7;

1.7
date	2012.06.24.17.17.27;	author matthieu;	state Exp;
branches;
next	1.6;

1.6
date	2011.10.16.17.18.56;	author shadchin;	state Exp;
branches;
next	1.5;

1.5
date	2011.04.10.18.15.28;	author shadchin;	state Exp;
branches;
next	1.4;

1.4
date	2011.04.10.17.10.21;	author jasper;	state Exp;
branches;
next	1.3;

1.3
date	2011.01.10.14.42.48;	author shadchin;	state Exp;
branches;
next	1.2;

1.2
date	2009.06.06.19.43.22;	author matthieu;	state Exp;
branches;
next	1.1;

1.1
date	2009.06.06.17.55.01;	author matthieu;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2009.06.06.17.55.01;	author matthieu;	state Exp;
branches;
next	;


desc
@@


1.10
log
@Update to xkeyboard-config 2.11.

ok matthieu@@
@
text
@#	$OpenBSD: Makefile,v 1.9 2014/03/29 14:27:12 ajacoutot Exp $

SUBDIR=		compat

XKB_SUBDIR=	rules

DATA=		xkb.dtd README

BASE_PARTS=	base.hdr.part base.lists.part \
		base.lists.base.part \
		compat/base.lists.part \
		HDR base.m_k.part \
		HDR base.l1_k.part \
		HDR base.l_k.part \
		HDR base.o_k.part \
		HDR base.ml_g.part \
		HDR base.m_g.part \
		HDR compat/base.mlv_s.part    base.mlv_s.part \
		HDR compat/base.ml_s.part     base.ml_s.part  \
		HDR compat/base.ml1_s.part    base.ml1_s.part \
		HDR compat/base.ml1v1_s.part \
		HDR compat/base.ml2_s.part    base.ml2_s.part \
		HDR compat/base.ml3_s.part    base.ml3_s.part \
		HDR compat/base.ml4_s.part    base.ml4_s.part \
		HDR compat/base.ml2v2_s.part \
		HDR compat/base.ml3v3_s.part \
		HDR compat/base.ml4v4_s.part \
		HDR base.m_s.part \
		HDR base.ml_s1.part \
		HDR compat/base.lv_c.part   \
		HDR compat/base.l1v1_c.part \
		HDR compat/base.l2v2_c.part \
		HDR compat/base.l3v3_c.part \
		HDR compat/base.l4v4_c.part \
		HDR base.ml_c.part \
		HDR base.ml1_c.part \
		HDR base.m_t.part \
		HDR base.lo_s.part \
		HDR base.l1o_s.part \
		HDR base.l2o_s.part \
		HDR base.l3o_s.part \
		HDR base.l4o_s.part \
		HDR compat/base.o_s.part     base.o_s.part \
		HDR base.o_c.part \
		HDR base.o_t.part

EVDEV_PARTS=	base.hdr.part base.lists.part \
		evdev.lists.part \
		compat/base.lists.part \
		HDR evdev.m_k.part \
		HDR base.l1_k.part \
		HDR base.l_k.part \
		HDR base.o_k.part \
		HDR base.ml_g.part \
		HDR base.m_g.part \
		HDR compat/base.mlv_s.part   base.mlv_s.part \
		HDR compat/base.ml_s.part    base.ml_s.part  \
		HDR compat/base.ml1_s.part   base.ml1_s.part \
		HDR compat/base.ml1v1_s.part \
		HDR compat/base.ml2_s.part    base.ml2_s.part  \
		HDR compat/base.ml3_s.part    base.ml3_s.part  \
		HDR compat/base.ml4_s.part    base.ml4_s.part  \
		HDR compat/base.ml2v2_s.part  \
		HDR compat/base.ml3v3_s.part  \
		HDR compat/base.ml4v4_s.part  \
		HDR evdev.m_s.part \
		HDR \
		HDR compat/base.lv_c.part   \
		HDR compat/base.l1v1_c.part \
		HDR compat/base.l2v2_c.part \
		HDR compat/base.l3v3_c.part \
		HDR compat/base.l4v4_c.part \
		HDR base.ml_c.part \
		HDR base.ml1_c.part \
		HDR base.m_t.part \
		HDR base.lo_s.part \
		HDR base.l1o_s.part \
		HDR base.l2o_s.part \
		HDR base.l3o_s.part \
		HDR base.l4o_s.part \
		HDR compat/base.o_s.part     base.o_s.part \
		HDR base.o_c.part \
		HDR base.o_t.part

BASE_RULES=		base base.lst base.xml base.extras.xml
EVDEV_RULES=		evdev evdev.lst evdev.xml evdev.extras.xml

all:	parts_done ${BASE_RULES} ${EVDEV_RULES} _SUBDIRUSE

parts_done:
	cd ${.CURDIR} && exec ${MAKE} depend
	touch $@@

${BASE_PARTS}: parts_done

depend:	_SUBDIRUSE

base:	${BASE_PARTS}
	HDR="${XKB_DIR}/${XKB_SUBDIR}/HDR" ${SHELL} ${XKB_DIR}/${XKB_SUBDIR}/merge.sh $@@ ${BASE_PARTS}

base.lst:	base.xml
	perl ${XKB_DIR}/${XKB_SUBDIR}/xml2lst.pl < base.xml > $@@

base.xml:	base.xml.in
	sed -e 's,<_,<,g' -e 's,</_,</,g' ${XKB_DIR}/${XKB_SUBDIR}/base.xml.in > $@@

base.extras.xml:	base.extras.xml.in
	sed -e 's,<_,<,g' -e 's,</_,</,g' ${XKB_DIR}/${XKB_SUBDIR}/base.extras.xml.in > $@@

evdev:	${EVDEV_PARTS}
	HDR="${XKB_DIR}/${XKB_SUBDIR}/HDR" ${SHELL} ${XKB_DIR}/${XKB_SUBDIR}/merge.sh $@@ ${EVDEV_PARTS}

evdev.lst:	evdev.xml
	perl ${XKB_DIR}/${XKB_SUBDIR}/xml2lst.pl < evdev.xml > $@@

evdev.xml:	evdev.xml.in
	sed -e 's,<_,<,g' -e 's,</_,</,g' ${XKB_DIR}/${XKB_SUBDIR}/evdev.xml.in > $@@

evdev.extras.xml:	evdev.extras.xml.in
	sed -e 's,<_,<,g' -e 's,</_,</,g' ${XKB_DIR}/${XKB_SUBDIR}/evdev.extras.xml.in > $@@

install-files:	${BASE_RULES} ${EVDEV_RULES}
	test -z ${XKB_BASE}/${XKB_SUBDIR} || ${INSTALL_DIR} ${XKB_BASE}/${XKB_SUBDIR}
	@@for f in ${BASE_RULES} ${EVDEV_RULES}; do  \
		echo ${INSTALL_DATA} $$f ${XKB_BASE}/${XKB_SUBDIR}/$$f; \
		${INSTALL_DATA} $$f ${XKB_BASE}/${XKB_SUBDIR}/$$f; \
	done

clean:	_SUBDIRUSE
	rm -f ${BASE_RULES} ${EVDEV_RULES} parts_done

.include <bsd.xorg.mk>
.include <bsd.subdir.mk>
@


1.9
log
@Install the evdev rules for xkbdata. Note that only the rules are
installed, there is no evdev compat whatsoever in OpenBSD (yet?).
This is needed for gnome to prevent fucking up keyboard rules.

discussed with and ok matthieu@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.8 2012/09/28 19:00:00 espie Exp $
d10 1
d29 1
d48 1
d67 1
@


1.8
log
@make sure to have parts available when we need them, add a cookie to
depend to be sure.  Fixes races in make -j mode.

(tested through full build/release)

okay matthieu@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.7 2012/06/24 17:17:27 matthieu Exp $
d45 36
d82 1
d84 1
a84 1
all:	parts_done ${BASE_RULES} _SUBDIRUSE
d106 13
a118 1
install-files:	${BASE_RULES}
d120 1
a120 1
	@@for f in ${BASE_RULES}; do  \
d126 1
a126 1
	rm -f ${BASE_RULES} parts_done
@


1.7
log
@Do not assume that merge.sh has the 'x' bit set.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.6 2011/10/16 17:18:56 shadchin Exp $
d47 7
a53 1
all:	depend ${BASE_RULES} _SUBDIRUSE
d77 1
a77 1
	rm -f ${BASE_RULES}
@


1.6
log
@Update to 2.4.1

ok jasper@@, matthieu@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.5 2011/04/10 18:15:28 shadchin Exp $
d52 1
a52 1
	HDR="${XKB_DIR}/${XKB_SUBDIR}/HDR" ${XKB_DIR}/${XKB_SUBDIR}/merge.sh $@@ ${BASE_PARTS}
@


1.5
log
@Fix build, thanks and ok jasper@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.4 2011/04/10 17:10:21 jasper Exp $
d66 1
a66 2
		echo "installing $$f"; \
		cmp -s $$f ${XKB_BASE}/${XKB_SUBDIR}/$$f || \
@


1.4
log
@Sync with xkeyboard-config 2.2.1

ok ok shadchin@@ matthieu@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.3 2011/01/10 14:42:48 shadchin Exp $
d17 10
a26 10
		HDR compat/base.mlv_s.part    extras/base.mlv_s.part   base.mlv_s.part \
		HDR compat/base.ml_s.part     extras/base.ml_s.part    base.ml_s.part  \
		HDR compat/base.ml1_s.part    extras/base.ml1_s.part   base.ml1_s.part \
		HDR compat/base.ml1v1_s.part  extras/base.ml1v1_s.part \
		HDR compat/base.ml2_s.part    extras/base.ml2_s.part   base.ml2_s.part  \
		HDR compat/base.ml3_s.part    extras/base.ml3_s.part   base.ml3_s.part  \
		HDR compat/base.ml4_s.part    extras/base.ml4_s.part   base.ml4_s.part  \
		HDR compat/base.ml2v2_s.part  extras/base.ml2v2_s.part \
		HDR compat/base.ml3v3_s.part  extras/base.ml3v3_s.part \
		HDR compat/base.ml4v4_s.part  extras/base.ml4v4_s.part \
@


1.3
log
@Update makefile-wrapper for xkeyboard-config 2.0
ok matthieu
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.2 2009/06/06 19:43:22 matthieu Exp $
d3 1
a3 1
SUBDIR=		compat extras
@


1.2
log
@correct install targets, build of compat scripts in depend stage.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.1.1.1 2009/06/06 17:55:01 matthieu Exp $
d3 1
a3 1
SUBDIR=	compat
d7 1
a7 1
DATA=	xkb.dtd README
d9 35
a43 30
base_parts = base.hdr.part base.lists.part \
	compat/base.lists.part \
	HDR base.m_k.part \
	HDR base.l1_k.part \
	HDR base.l_k.part \
	HDR base.o_k.part \
	HDR base.ml_g.part \
	HDR base.m_g.part \
	HDR compat/base.mlv_s.part base.mlv_s.part \
	HDR compat/base.ml_s.part base.ml_s.part  \
	HDR compat/base.ml1_s.part base.ml1_s.part \
	HDR compat/base.ml1v1_s.part \
	HDR compat/base.l2_s.part base.l2_s.part  \
	HDR compat/base.l3_s.part base.l3_s.part  \
	HDR compat/base.l4_s.part base.l4_s.part  \
	HDR compat/base.l2v2_s.part \
	HDR compat/base.l3v3_s.part \
	HDR compat/base.l4v4_s.part \
	HDR base.m_s.part \
	HDR base.ml_c.part \
	HDR base.ml1_c.part \
	HDR base.m_t.part \
	HDR base.lo_s.part \
	HDR base.l1o_s.part \
	HDR base.l2o_s.part \
	HDR base.l3o_s.part \
	HDR base.l4o_s.part \
	HDR compat/base.o_s.part base.o_s.part \
	HDR base.o_c.part \
	HDR base.o_t.part
d45 1
a45 1
files= base base.lst base.xml
d47 1
a47 3
srcdir=	${XKB_DIR}/rules

all:	_SUBDIRUSE ${files}
d51 2
a52 2
base: $(base_parts)
	HDR="$(srcdir)/HDR" $(srcdir)/merge.sh $@@ $(base_parts)
d54 2
a55 2
base.lst: base.xml
	perl $(srcdir)/xml2lst.pl < base.xml > $@@
d57 1
a57 1
base.xml: base.xml.in
d59 10
a68 4
install-files: ${files}
	@@for i in ${files}; do  \
		echo "installing $$i"; \
		${INSTALL_DATA} $$i ${XKB_BASE}/${XKB_SUBDIR}; \
d71 2
a72 2
clean: _SUBDIRUSE
	rm -f base base.lst base.xml 
a75 3

.PATH:	${XKB_DIR}/rules
.SUFFIXES: .in .lst .xml
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
#	$OpenBSD$
d7 1
a7 1
DATA=	base base.lst base.xml xkb.dtd README
d10 31
a40 29
compat/base.lists.part \
HDR base.m_k.part \
HDR base.l1_k.part \
HDR base.l_k.part \
HDR base.o_k.part \
HDR base.ml_g.part \
HDR base.m_g.part \
HDR compat/base.mlv_s.part base.mlv_s.part \
HDR compat/base.ml_s.part base.ml_s.part  \
HDR compat/base.ml1_s.part base.ml1_s.part \
HDR compat/base.ml1v1_s.part \
HDR compat/base.l2_s.part base.l2_s.part  \
HDR compat/base.l3_s.part base.l3_s.part  \
HDR compat/base.l4_s.part base.l4_s.part  \
HDR compat/base.l2v2_s.part \
HDR compat/base.l3v3_s.part \
HDR compat/base.l4v4_s.part \
HDR base.m_s.part \
HDR base.ml_c.part \
HDR base.ml1_c.part \
HDR base.m_t.part \
HDR base.lo_s.part \
HDR base.l1o_s.part \
HDR base.l2o_s.part \
HDR base.l3o_s.part \
HDR base.l4o_s.part \
HDR compat/base.o_s.part base.o_s.part \
HDR base.o_c.part \
HDR base.o_t.part
d44 1
a44 1
all:	_SUBDIRUSE files
d46 1
a46 1
files: base base.lst base.xml
d48 1
a48 1
base: $(base_parts_no_compat)
d56 5
@


1.1.1.1
log
@BSD build system for xkeyboard-config. Work in progress.
@
text
@@
