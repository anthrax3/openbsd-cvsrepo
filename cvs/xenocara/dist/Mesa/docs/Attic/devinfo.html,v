head	1.9;
access;
symbols
	OPENBSD_5_8:1.8.0.4
	OPENBSD_5_8_BASE:1.8
	OPENBSD_5_7:1.8.0.2
	OPENBSD_5_7_BASE:1.8
	v10_2_9:1.1.1.7
	v10_4_3:1.1.1.6
	v10_2_7:1.1.1.5
	OPENBSD_5_6:1.6.0.2
	OPENBSD_5_6_BASE:1.6
	v10_2_3:1.1.1.5
	OPENBSD_5_5:1.5.0.2
	OPENBSD_5_5_BASE:1.5
	v9_2_5:1.1.1.4
	v9_2_3:1.1.1.4
	v9_2_2:1.1.1.4
	v9_2_1:1.1.1.4
	v9_2_0:1.1.1.4
	OPENBSD_5_4:1.4.0.14
	OPENBSD_5_4_BASE:1.4
	OPENBSD_5_3:1.4.0.12
	OPENBSD_5_3_BASE:1.4
	OPENBSD_5_2:1.4.0.10
	OPENBSD_5_2_BASE:1.4
	OPENBSD_5_1_BASE:1.4
	OPENBSD_5_1:1.4.0.8
	v7_10_3:1.1.1.3
	OPENBSD_5_0:1.4.0.6
	OPENBSD_5_0_BASE:1.4
	OPENBSD_4_9:1.4.0.2
	OPENBSD_4_9_BASE:1.4
	OPENBSD_4_8:1.4.0.4
	OPENBSD_4_8_BASE:1.4
	OPENBSD_4_7:1.2.0.6
	OPENBSD_4_7_BASE:1.2
	OPENBSD_4_6:1.2.0.4
	OPENBSD_4_6_BASE:1.2
	OPENBSD_4_5:1.2.0.2
	OPENBSD_4_5_BASE:1.2
	OPENBSD_4_4:1.1.1.2.0.6
	OPENBSD_4_4_BASE:1.1.1.2
	OPENBSD_4_3_BASE:1.1.1.2
	OPENBSD_4_3:1.1.1.2.0.4
	v7_0_1:1.1.1.2
	OPENBSD_4_2:1.1.1.2.0.2
	OPENBSD_4_2_BASE:1.1.1.2
	v6_5_2:1.1.1.2
	v6_5_1:1.1.1.1
	mesa:1.1.1;
locks; strict;
comment	@# @;


1.9
date	2015.12.23.05.17.22;	author jsg;	state dead;
branches;
next	1.8;
commitid	TnlogFl9nOv2eaRf;

1.8
date	2015.02.20.23.09.50;	author jsg;	state Exp;
branches;
next	1.7;
commitid	4ry2gvZGMXkCUD2n;

1.7
date	2015.01.25.14.41.14;	author jsg;	state Exp;
branches;
next	1.6;
commitid	mcxB0JvoI9gTDYXU;

1.6
date	2014.07.09.21.08.50;	author jsg;	state Exp;
branches;
next	1.5;
commitid	WPD6rgPryPkvXOr9;

1.5
date	2013.09.05.13.58.59;	author jsg;	state Exp;
branches;
next	1.4;

1.4
date	2010.06.22.20.04.22;	author matthieu;	state Exp;
branches;
next	1.3;

1.3
date	2010.05.22.20.05.53;	author matthieu;	state Exp;
branches;
next	1.2;

1.2
date	2008.11.02.14.58.06;	author matthieu;	state Exp;
branches;
next	1.1;

1.1
date	2006.11.25.18.49.19;	author matthieu;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2006.11.25.18.49.19;	author matthieu;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	2007.03.03.11.56.24;	author matthieu;	state Exp;
branches;
next	1.1.1.3;

1.1.1.3
date	2011.10.23.13.29.22;	author matthieu;	state Exp;
branches;
next	1.1.1.4;

1.1.1.4
date	2013.09.05.13.17.49;	author jsg;	state Exp;
branches;
next	1.1.1.5;

1.1.1.5
date	2014.07.09.20.35.15;	author jsg;	state Exp;
branches;
next	1.1.1.6;
commitid	3JhLfwcuBALP0ZR7;

1.1.1.6
date	2015.01.25.14.13.49;	author jsg;	state Exp;
branches;
next	1.1.1.7;
commitid	ce2W5rH5aF7VS9gi;

1.1.1.7
date	2015.02.20.22.50.50;	author jsg;	state Exp;
branches;
next	;
commitid	F54a1i0WXHMxq7kE;


desc
@@


1.9
log
@remove the now unused Mesa 10.2.9 code
@
text
@<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Development Notes</title>
  <link rel="stylesheet" type="text/css" href="mesa.css">
</head>
<body>

<div class="header">
  <h1>The Mesa 3D Graphics Library</h1>
</div>

<iframe src="contents.html"></iframe>
<div class="content">

<h1>Development Notes</h1>


<h2>Adding Extensions</h2>

<p>
To add a new GL extension to Mesa you have to do at least the following.

<ul>
<li>
   If glext.h doesn't define the extension, edit include/GL/gl.h and add
   code like this:
   <pre>
     #ifndef GL_EXT_the_extension_name
     #define GL_EXT_the_extension_name 1
     /* declare the new enum tokens */
     /* prototype the new functions */
     /* TYPEDEFS for the new functions */
     #endif
   </pre>
</li>
<li>
   In the src/mapi/glapi/gen/ directory, add the new extension functions and
   enums to the gl_API.xml file.
   Then, a bunch of source files must be regenerated by executing the
   corresponding Python scripts.
</li>
<li>
   Add a new entry to the <code>gl_extensions</code> struct in mtypes.h
</li>
<li>
   Update the <code>extensions.c</code> file.
</li>
<li>
   From this point, the best way to proceed is to find another extension,
   similar to the new one, that's already implemented in Mesa and use it
   as an example.
</li>
<li>
   If the new extension adds new GL state, the functions in get.c, enable.c
   and attrib.c will most likely require new code.
</li>
<li>
   The dispatch tests check_table.cpp and dispatch_sanity.cpp
   should be updated with details about the new extensions functions. These
   tests are run using 'make check'
</li>
</ul>



<h2>Coding Style</h2>

<p>
Mesa's code style has changed over the years.  Here's the latest.
</p>

<p>
Comment your code!  It's extremely important that open-source code be
well documented.  Also, strive to write clean, easily understandable code.
</p>

<p>
3-space indentation
</p>

<p>
If you use tabs, set them to 8 columns
</p>

<p>
Line width: the preferred width to fill comments and code in Mesa is 78
columns.  Exceptions are sometimes made for clarity (e.g. tabular data is
sometimes filled to a much larger width so that extraneous carriage returns
don't obscure the table).
</p>

<p>
Brace example:
</p>
<pre>
	if (condition) {
	   foo;
	}
	else {
	   bar;
	}

	switch (condition) {
	case 0:
	   foo();
	   break;

	case 1: {
	   ...
	   break;
	}

	default:
	   ...
	   break;
	}
</pre>

<p>
Here's the GNU indent command which will best approximate my preferred style:
(Note that it won't format switch statements in the preferred way)
</p>
<pre>
	indent -br -i3 -npcs --no-tabs infile.c -o outfile.c
</pre>


<p>
Local variable name example:  localVarName (no underscores)
</p>

<p>
Constants and macros are ALL_UPPERCASE, with _ between words
</p>

<p>
Global variables are not allowed.
</p>

<p>
Function name examples:
</p>
<pre>
	glFooBar()       - a public GL entry point (in glapi_dispatch.c)
	_mesa_FooBar()   - the internal immediate mode function
	save_FooBar()    - retained mode (display list) function in dlist.c
	foo_bar()        - a static (private) function
	_mesa_foo_bar()  - an internal non-static Mesa function
</pre>

<p>
Places that are not directly visible to the GL API should prefer the use
of <tt>bool</tt>, <tt>true</tt>, and
<tt>false</tt> over <tt>GLboolean</tt>, <tt>GL_TRUE</tt>, and
<tt>GL_FALSE</tt>.  In C code, this may mean that
<tt>#include &lt;stdbool.h&gt;</tt> needs to be added.  The
<tt>try_emit_</tt>* methods in src/mesa/program/ir_to_mesa.cpp and
src/mesa/state_tracker/st_glsl_to_tgsi.cpp can serve as examples.
</p>

<h2>Submitting patches</h2>

<p>
You should always run the Mesa Testsuite before submitting patches.
The Testsuite can be run using the 'make check' command. All tests
must pass before patches will be accepted, this may mean you have
to update the tests themselves.
</p>

<p>
Patches should be sent to the Mesa mailing list for review.
When submitting a patch make sure to use git send-email rather than attaching
patches to emails. Sending patches as attachments prevents people from being
able to provide in-line review comments.
</p>

<p>
When submitting follow-up patches you can use --in-reply-to to make v2, v3,
etc patches show up as replies to the originals. This usually works well
when you're sending out updates to individual patches (as opposed to
re-sending the whole series). Using --in-reply-to makes
it harder for reviewers to accidentally review old patches.
</p>

<h2>Marking a commit as a candidate for a stable branch</h2>

<p>
If you want a commit to be applied to a stable branch,
you should add an appropriate note to the commit message.
</p>

<p>
Here are some examples of such a note:
</p>
<ul>
  <li>CC: &lt;mesa-stable@@lists.freedesktop.org&gt;</li>
  <li>CC: "9.2 10.0" &lt;mesa-stable@@lists.freedesktop.org&gt;</li>
  <li>CC: "10.0" &lt;mesa-stable@@lists.freedesktop.org&gt;</li>
</ul>

Simply adding the CC to the mesa-stable list address is adequate to nominate
the commit for the most-recently-created stable branch. It is only necessary
to specify a specific branch name, (such as "9.2 10.0" or "10.0" in the
examples above), if you want to nominate the commit for an older stable
branch. And, as in these examples, you can nominate the commit for the older
branch in addition to the more recent branch, or nominate the commit
exclusively for the older branch.

This "CC" syntax for patch nomination will cause patches to automatically be
copied to the mesa-stable@@ mailing list when you use "git send-email" to send
patches to the mesa-dev@@ mailing list. Also, if you realize that a commit
should be nominated for the stable branch after it has already been committed,
you can send a note directly to the mesa-stable@@lists.freedesktop.org where
the Mesa stable-branch maintainers will receive it. Be sure to mention the
commit ID of the commit of interest (as it appears in the mesa master branch).

The latest set of patches that have been nominated, accepted, or rejected for
the upcoming stable release can always be seen on the
<a href=http://cworth.org/~cworth/mesa-stable-queue/">Mesa Stable Queue</a>
page.

<h2>Cherry-picking candidates for a stable branch</h2>

<p>
Please use <code>git cherry-pick -x &lt;commit&gt;</code> for cherry-picking a commit
from master to a stable branch.
</p>

<h2>Making a New Mesa Release</h2>

<p>
These are the instructions for making a new Mesa release.
</p>

<h3>Get latest source files</h3>
<p>
Use git to get the latest Mesa files from the git repository, from whatever
branch is relevant.
</p>


<h3>Verify and update version info in VERSION</h3>

<p>
Create a docs/relnotes/x.y.z.html file.
The bin/bugzilla_mesa.sh and bin/shortlog_mesa.sh scripts can be used to
create the HTML-formatted lists of bugfixes and changes to include in the file.
Link the new docs/relnotes/x.y.z.html file into the main <a href="relnotes.html">relnotes.html</a> file.
</p>

<p>
Update <a href="index.html">docs/index.html</a>.
</p>

<p>
Tag the files with the release name (in the form <b>mesa-x.y</b>)
with: <code>git tag -s mesa-x.y -m "Mesa x.y Release"</code>
Then: <code>git push origin mesa-x.y</code>
</p>


<h3>Make the tarballs</h3>
<p>
Make the distribution files.  From inside the Mesa directory:
<pre>
	./autogen.sh
	make tarballs
</pre>

<p>
After the tarballs are created, the md5 checksums for the files will
be computed.
Add them to the docs/relnotes/x.y.html file.
</p>

<p>
Copy the distribution files to a temporary directory, unpack them,
compile everything, and run some demos to be sure everything works.
</p>

<h3>Update the website and announce the release</h3>
<p>
Make a new directory for the release on annarchy.freedesktop.org with:
<br>
<code>
mkdir /srv/ftp.freedesktop.org/pub/mesa/x.y
</code>
</p>

<p>
Basically, to upload the tarball files with:
<br>
<code>
rsync -avP -e ssh MesaLib-x.y.* USERNAME@@annarchy.freedesktop.org:/srv/ftp.freedesktop.org/pub/mesa/x.y/
</code>
</p>

<p>
Update the web site by copying the docs/ directory's files to 
/home/users/b/br/brianp/mesa-www/htdocs/ with:
<br>
<code>
sftp USERNAME,mesa3d@@web.sourceforge.net
</code>
</p>

<p>
Make an announcement on the mailing lists:

<em>mesa-dev@@lists.freedesktop.org</em>,
<em>mesa-users@@lists.freedesktop.org</em>
and
<em>mesa-announce@@lists.freedesktop.org</em>
</p>

</div>
</body>
</html>
@


1.8
log
@Merge Mesa 10.2.9
@
text
@@


1.7
log
@Merge Mesa 10.4.3
Tested by matthieu@@ mpi@@ and myself.  landry@@ ran a ports bulk build.
kettenis@@ tracked down the cause of an alignment fault on archs
that require strict eight byte pointer alignment.
@
text
@d221 1
a221 1
<a href="http://cworth.org/~cworth/mesa-stable-queue/">Mesa Stable Queue</a>
d224 1
a224 1
<h2>Criteria for accepting patches to the stable branch</h2>
d226 4
a229 82
Mesa has a designated release manager for each stable branch, and the release
manager is the only developer that should be pushing changes to these
branches. Everyone else should simply nominate patches using the mechanism
described above.

The stable-release manager will work with the list of nominated patches, and
for each patch that meets the crtieria below will cherry-pick the patch with:
<code>git cherry-pick -x &lt;commit&gt;</code>. The <code>-x</code> option is
important so that the picked patch references the comit ID of the original
patch.

The stable-release manager may at times need to force-push changes to the
stable branches, for example, to drop a previously-picked patch that was later
identified as causing a regression). These force-pushes may cause changes to
be lost from the stable branch if developers push things directly. Consider
yourself warned.

The stable-release manager is also given broad discretion in rejecting patches
that have been nominated for the stable branch. The most basic rule is that
the stable branch is for bug fixes only, (no new features, no
regressions). Here is a non-exhaustive list of some reasons that a patch may
be rejected:

<ul>
  <li>Patch introduces a regression. Any reported build breakage or other
  regression caused by a particular patch, (game no longer work, piglit test
  changes from PASS to FAIL), is justification for rejecting a patch.</li>

  <li>Patch is too large, (say, larger than 100 lines)</li>

  <li>Patch is not a fix. For example, a commit that moves code around with no
  functional change should be rejected.</li>

  <li>Patch fix is not clearly described. For example, a commit message
  of only a single line, no description of the bug, no mention of bugzilla,
  etc.</li>

  <li>Patch has not obviously been reviewed, For example, the commit message
  has no Reviewed-by, Signed-off-by, nor Tested-by tags from anyone but the
  author.</li>

  <li>Patch has not already been merged to the master branch. As a rule, bug
  fixes should never be applied first to a stable branch. Patches should land
  first on the master branch and then be cherry-picked to a stable
  branch. (This is to avoid future releases causing regressions if the patch
  is not also applied to master.) The only things that might look like
  exceptions would be backports of patches from master that happen to look
  significantly different.</li>

  <li>Patch depends on too many other patches. Ideally, all stable-branch
  patches should be self-contained. It sometimes occurs that a single, logical
  bug-fix occurs as two separate patches on master, (such as an original
  patch, then a subsequent fix-up to that patch). In such a case, these two
  patches should be squashed into a single, self-contained patch for the
  stable branch. (Of course, if the squashing makes the patch too large, then
  that could be a reason to reject the patch.)</li>

  <li>Patch includes new feature development, not bug fixes. New OpenGL
  features, extensions, etc. should be applied to Mesa master and included in
  the next major release. Stable releases are intended only for bug fixes.

  Note: As an exception to this rule, the stable-release manager may accept
  hardware-enabling "features". For example, backports of new code to support
  a newly-developed hardware product can be accepted if they can be reasonably
  determined to not have effects on other hardware.</li>

  <li>Patch is a performance optimization. As a rule, performance patches are
  not candidates for the stable branch. The only exception might be a case
  where an application's performance was recently severely impacted so as to
  become unusable. The fix for this performance regression could then be
  considered for a stable branch. The optimization must also be
  non-controversial and the patches still need to meet the other criteria of
  being simple and self-contained</li>

  <li>Patch introduces a new failure mode (such as an assert). While the new
  assert might technically be correct, for example to make Mesa more
  conformant, this is not the kind of "bug fix" we want in a stable
  release. The potential problem here is that an OpenGL program that was
  previously working, (even if technically non-compliant with the
  specification), could stop working after this patch. So that would be a
  regression that is unaacceptable for the stable branch.</li>
</ul>
d240 1
a240 16
branch is relevant. This document uses the convention X.Y.Z for the release
being created, which should be created from a branch named X.Y.
</p>

<h3>Perform basic testing</h3>
<p>
The release manager should, at the very least, test the code by compiling it,
installing it, and running the latest piglit to ensure that no piglit tests
have regressed since the previous release.
</p>

<p>
The release manager should do this testing with at least one hardware driver,
(say, whatever is contained in the local development machine), as well as on
both Gallium and non-Gallium software drivers. The software testing can be
performed by running piglit with the following environment-variable set:
a242 3
<pre>
LIBGL_ALWAYS_SOFTWARE=1
</pre>
d244 1
a244 7
And Gallium vs. non-Gallium software drivers can be obtained by using the
following configure flags on separate builds:

<pre>
--with-dri-drivers=swrast
--with-gallium-drivers=swrast
</pre>
d247 4
a250 3
Note: If both options are given in one build, both swrast_dri.so drivers will
be compiled, but only one will be installed. The following command can be used
to ensure the correct driver is being tested:
a252 9
<pre>
LIBGL_ALWAYS_SOFTWARE=1 glxinfo | grep "renderer string"
</pre>

If any regressions are found in this testing with piglit, stop here, and do
not perform a release until regressions are fixed.

<h3>Update version in file VERSION</h3>

d254 1
a254 2
Increment the version contained in the file VERSION at Mesa's top-level, then
commit this change.
a256 2
<h3>Create release notes for the new release</h3>

d258 3
a260 3
Create a new file docs/relnotes/X.Y.Z.html, (follow the style of the previous
release notes). Note that the sha256sums section of the release notes should
be empty at this point.
a262 7
<p>
Two scripts are available to help generate portions of the release notes:

<pre>
	./bin/bugzilla_mesa.sh
	./bin/shortlog_mesa.sh
</pre>
d264 1
d266 1
a266 13
The first script identifies commits that reference bugzilla bugs and obtains
the descriptions of those bugs from bugzilla. The second script generates a
log of all commits. In both cases, HTML-formatted lists are printed to stdout
to be included in the release notes.
</p>

<p>
Commit these changes
</p>

<h3>Make the release archives, signatures, and the release tag</h3>
<p>
From inside the Mesa directory:
d269 1
a269 1
	make -j1 tarballs
d273 3
a275 2
After the tarballs are created, the sha256 checksums for the files will
be computed and printed. These will be used in a step below.
d279 2
a280 2
It's important at this point to also verify that the constructed tar file
actually builds:
d283 1
a283 8
<pre>
	tar xjf MesaLib-X.Y.Z.tar.bz2
	cd Mesa-X.Y.Z
	./configure --enable-gallium-llvm
	make -j6
	make install
</pre>

d285 5
a289 2
Some touch testing should also be performed at this point, (run glxgears or
more involved OpenGL programs against the installed Mesa).
d293 5
a297 90
Create detached GPG signatures for each of the archive files created above:
</p>

<pre>
	gpg --sign --detach MesaLib-X.Y.Z.tar.gz
	gpg --sign --detach MesaLib-X.Y.Z.tar.bz2
	gpg --sign --detach MesaLib-X.Y.Z.zip
</pre>

<p>
Tag the commit used for the build:
</p>

<pre>
	git tag -s mesa-X.Y.X -m "Mesa X.Y.Z release"
</pre>

<p>
Note: It would be nice to investigate and fix the issue that causes the
tarballs target to fail with multiple build process, such as with "-j4". It
would also be nice to incorporate all of the above commands into a single
makefile target. And instead of a custom "tarballs" target, we should
incorporate things into the standard "make dist" and "make distcheck" targets.
</p>

<h3>Add the sha256sums to the release notes</h3>

<p>
Edit docs/relnotes/X.Y.Z.html to add the sha256sums printed as part of "make
tarballs" in the previous step. Commit this change.
</p>

<h3>Push all commits and the tag creates above</h3>

<p>
This is the first step that cannot easily be undone. The release is going
forward from this point:
</p>

<pre>
	git push origin X.Y --tags
</pre>

<h3>Install the release files and signatures on the distribution server</h3>

<p>
The following commands can be used to copy the release archive files and
signatures to the freedesktop.org server:
</p>

<pre>
	scp MesaLib-X.Y.Z* people.freedesktop.org:
	ssh people.freedesktop.org
	cd /srv/ftp.freedesktop.org/pub/mesa
	mkdir X.Y.Z
	cd X.Y.Z
	mv ~/MesaLib-X.Y.Z* .
</pre>

<h3>Back on mesa master, andd the new release notes into the tree</h3>

<p>
Something like the following steps will do the trick:
</p>

<pre>
	cp docs/relnotes/X.Y.Z.html /tmp
        git checkout master
        cp /tmp/X.Y.Z.html docs/relnotes
        git add docs/relnotes/X.Y.Z.html
</pre>

<p>
Also, edit docs/relnotes.html to add a link to the new release notes, and edit
docs/index.html to add a news entry. Then commit and push:
</p>

<pre>
	git commit -a -m "docs: Import X.Y.Z release notes, add news item."
        git push origin
</pre>

<h3>Update the mesa3d.org website</h3>

<p>
NOTE: The recent release managers have not been performing this step
themselves, but leaving this to Brian Paul, (who has access to the
sourceforge.net hosting for mesa3d.org). Brian is more than willing to grant
the permission necessary to future release managers to do this step on their
own.
a308 2

<h3>Announce the release</h3>
d313 1
a315 8

Follow the template of previously-sent release announcements. The following
command can be used to generate the log of changes to be included in the
release announcement:

<pre>
	git shortlog mesa-X.Y.Z-1..mesa-X.Y.Z
</pre>
@


1.6
log
@Merge Mesa 10.2.3
tested by matthieu@@ kettenis@@ mpi@@ brett@@ and myself across a
diverse range of hardware
@
text
@d221 1
a221 1
<a href=http://cworth.org/~cworth/mesa-stable-queue/">Mesa Stable Queue</a>
d224 1
a224 1
<h2>Cherry-picking candidates for a stable branch</h2>
d226 82
a307 4
<p>
Please use <code>git cherry-pick -x &lt;commit&gt;</code> for cherry-picking a commit
from master to a stable branch.
</p>
d318 16
a333 1
branch is relevant.
d336 3
d340 7
a346 1
<h3>Verify and update version info in VERSION</h3>
d349 3
a351 4
Create a docs/relnotes/x.y.z.html file.
The bin/bugzilla_mesa.sh and bin/shortlog_mesa.sh scripts can be used to
create the HTML-formatted lists of bugfixes and changes to include in the file.
Link the new docs/relnotes/x.y.z.html file into the main <a href="relnotes.html">relnotes.html</a> file.
d354 9
d364 2
a365 1
Update <a href="index.html">docs/index.html</a>.
d368 2
d371 3
a373 3
Tag the files with the release name (in the form <b>mesa-x.y</b>)
with: <code>git tag -s mesa-x.y -m "Mesa x.y Release"</code>
Then: <code>git push origin mesa-x.y</code>
d376 7
a383 1
<h3>Make the tarballs</h3>
d385 13
a397 1
Make the distribution files.  From inside the Mesa directory:
d400 42
a441 1
	make tarballs
d445 5
a449 3
After the tarballs are created, the md5 checksums for the files will
be computed.
Add them to the docs/relnotes/x.y.html file.
d452 2
d455 2
a456 2
Copy the distribution files to a temporary directory, unpack them,
compile everything, and run some demos to be sure everything works.
d459 2
a460 1
<h3>Update the website and announce the release</h3>
d462 40
a501 5
Make a new directory for the release on annarchy.freedesktop.org with:
<br>
<code>
mkdir /srv/ftp.freedesktop.org/pub/mesa/x.y
</code>
d504 7
d512 5
a516 5
Basically, to upload the tarball files with:
<br>
<code>
rsync -avP -e ssh MesaLib-x.y.* USERNAME@@annarchy.freedesktop.org:/srv/ftp.freedesktop.org/pub/mesa/x.y/
</code>
d528 2
a533 1
<em>mesa-users@@lists.freedesktop.org</em>
d536 8
@


1.5
log
@Merge Mesa 9.2.0
@
text
@d20 1
a20 1
<h2>Adding Extentions</h2>
d39 1
a39 1
   In the src/mesa/glapi/ directory, add the new extension functions and
d59 5
d163 23
d198 3
a200 3
  <li>NOTE: This is a candidate for the 9.0 branch.</li>
  <li>NOTE: This is a candidate for the 8.0 and 9.0 branches.</li>
  <li>NOTE: This is a candidate for the stable branches.</li>
d203 20
d244 1
a244 9
<h3>Verify and update version info</h3>

<dl>
  <dt>SConstruct</dt>
  <dt>Android.common.mk</dt>
  <dd>PACKAGE_VERSION</dd>
  <dt>configure.ac</dt>
  <dd>AC_INIT</dd>
</dl>
d312 2
a313 2
<em>m</em><em>e</em><em>s</em><em>a</em><em>-</em><em>d</em><em>e</em><em>v</em><em>@@</em><em>l</em><em>i</em><em>s</em><em>t</em><em>s</em><em>.</em><em>f</em><em>r</em><em>e</em><em>e</em><em>d</em><em>e</em><em>s</em><em>k</em><em>t</em><em>o</em><em>p</em><em>.</em><em>o</em><em>r</em><em>g</em>,
<em>m</em><em>e</em><em>s</em><em>a</em><em>-</em><em>u</em><em>s</em><em>e</em><em>r</em><em>s</em><em>@@</em><em>l</em><em>i</em><em>s</em><em>t</em><em>s</em><em>.</em><em>f</em><em>r</em><em>e</em><em>e</em><em>d</em><em>e</em><em>s</em><em>k</em><em>t</em><em>o</em><em>p</em><em>.</em><em>o</em><em>r</em><em>g</em>
d315 1
a315 1
<em>m</em><em>e</em><em>s</em><em>a</em><em>-</em><em>a</em><em>n</em><em>n</em><em>o</em><em>u</em><em>n</em><em>c</em><em>e</em><em>@@</em><em>l</em><em>i</em><em>s</em><em>t</em><em>s</em><em>.</em><em>f</em><em>r</em><em>e</em><em>e</em><em>d</em><em>e</em><em>s</em><em>k</em><em>t</em><em>o</em><em>p</em><em>.</em><em>o</em><em>r</em><em>g</em>
@


1.4
log
@Update to Mesa 7.8.2. Tested by johan@@. Thanks.
@
text
@d1 12
a12 1
<HTML>
d14 2
a15 1
<TITLE>Development Notes</TITLE>
d17 1
a17 1
<link rel="stylesheet" type="text/css" href="mesa.css"></head>
a18 1
<BODY>
d20 1
a20 4
<H1>Development Notes</H1>


<H2>Adding Extentions</H2>
d63 1
a63 1
<H2>Coding Style</H2>
d83 7
d99 15
d118 1
d148 9
d158 2
a159 1
<H2>Making a New Mesa Release</H2>
d162 2
a163 1
These are the instructions for making a new Mesa release.
a165 1
<H3>Get latest source files</H3>
d167 1
a167 2
Use git to get the latest Mesa files from the git repository, from whatever
branch is relevant.
d169 5
d176 2
a177 1
<H3>Verify and update version info</H3>
d179 2
a180 2
Create/edit the docs/relnotes-x.y.html file to document what's new in the release.
Add the new relnotes-x.y.html file to <a href="relnotes.html">relnotes.html</a>.
d183 2
d186 1
a186 3
Update the MESA_MAJOR, MESA_MINOR and MESA_TINY version numbers in
configs/default.
Also update the VERSION line in the top-level Makefile.
d189 1
d191 2
a192 1
Make sure the values in src/mesa/main/version.h are correct.
d195 11
d207 4
a210 1
Update docs/news.html.
d214 1
a214 1
Check in all updates to git.
d218 3
a220 3
Tag the files with the release name (in the form <b>mesa_X_Y</b>)
with: <code>git tag -a mesa_X_Y</code>
Then: <code>git push origin mesa_X_Y</code>
d224 1
a224 7
<H3>Make the tarballs</H3>
<p>
Make a symbolic link from $(DIRECTORY) to 'Mesa'.  For example,
<code>ln -s Mesa Mesa-7.5</code>
This is needed in order to make a correct tar file in the next step.
</p>

d228 1
d235 1
a235 1
Add them to the docs/relnotes-X.Y.html file.
d243 1
a243 1
<H3>Update the website and announce the release</H3>
d245 5
a249 2
Follow the directions on SourceForge for creating a new "release" and
uploading the tarballs.
d256 1
a256 1
rsync -avP ssh Mesa*-X.Y.* USERNAME@@frs.sourceforge.net:uploads/
d278 1
a278 2


@


1.3
log
@Update to Mesa 7.8.1. Tested on a bulk ports build by naddy@@, ok oga@@.
@
text
@d148 1
a148 1
Update the docs/news.html file and docs/download.html files.
d211 3
a213 2
<em>m</em><em>e</em><em>s</em><em>a</em><em>3</em><em>d</em><em>-</em><em>d</em><em>e</em><em>v</em><em>@@</em><em>l</em><em>i</em><em>s</em><em>t</em><em>s</em><em>.</em><em>s</em><em>f</em><em>.</em><em>n</em><em>e</em><em>t</em>,
<em>m</em><em>e</em><em>s</em><em>a</em><em>3</em><em>d</em><em>-</em><em>u</em><em>s</em><em>e</em><em>r</em><em>s</em><em>@@</em><em>l</em><em>i</em><em>s</em><em>t</em><em>s</em><em>.</em><em>s</em><em>f</em><em>.</em><em>n</em><em>e</em><em>t</em>
d215 1
a215 1
<em>m</em><em>e</em><em>s</em><em>a</em><em>3</em><em>d</em><em>-</em><em>a</em><em>n</em><em>n</em><em>o</em><em>u</em><em>n</em><em>c</em><em>e</em><em>@@</em><em>l</em><em>i</em><em>s</em><em>t</em><em>s</em><em>.</em><em>s</em><em>f</em><em>.</em><em>n</em><em>e</em><em>t</em>
@


1.2
log
@Mesa 7.2, Tested by ckuethe@@, naddy@@, oga@@, and others.
@
text
@d110 1
a110 1
	glFooBar()       - a public GL entry point (in dispatch.c)
d126 2
a127 1
Use "cvs update -dAP " to get the latest Mesa files from CVS.
d133 2
a134 3
Create/edit the docs/RELNOTES-X.Y file to document what's new in the release.
Add the new RELNOTES-X.Y file to <a href="relnotes.html">relnotes.html</a>.
Update the docs/VERSIONS file too.
d138 1
a138 1
Edit the MESA_MAJOR, MESA_MINOR and MESA_TINY version numbers in
d140 1
a147 5
Edit the top-level Makefile and verify that DIRECTORY, LIB_NAME and
DEMO_NAME are correct.
</p>

<p>
d152 1
a152 1
Check in all updates to CVS.
d156 3
a158 1
Tag the CVS files with the release name (in the form <b>mesa_X_Y</b>).
d165 1
a165 1
ln -s Mesa Mesa-6.3
d178 1
a178 1
Add them to the docs/news.html file.
d193 8
d202 5
a206 1
/home/users/b/br/brianp/mesa-www/htdocs/
@


1.1
log
@Initial revision
@
text
@d37 9
a45 5
   Find an existing extension that's similar to the new one and search
   the sources for code related to that extension.
   Implement new code as needed.
   In general, new state variables will be added to mtypes.h.  If the
   extension is rather large, try to implement it in a new source file.
d138 2
a139 2
Edit configs/default and change the MESA_MAJOR, MESA_MINOR and MESA_TINY
version numbers.
d143 1
a143 1
Make sure the values in src/mesa/main/version.h is correct.
@


1.1.1.1
log
@Import MesaLibs 6.5.1. (in dist/ since its code is shared between lib 
and xserver)...
@
text
@@


1.1.1.2
log
@import MesaLibs version 6.5.2
@
text
@d37 5
a41 9
   Add a new entry to the <code>gl_extensions</code> struct in mtypes.h
</li>
<li>
   Update the <code>extensions.c</code> file.
</li>
<li>
   From this point, the best way to proceed is to find another extension,
   similar to the new one, that's already implemented in Mesa and use it
   as an example.
@


1.1.1.3
log
@Import Mesa 7.10.3
@
text
@d110 1
a110 1
	glFooBar()       - a public GL entry point (in glapi_dispatch.c)
d126 1
a126 2
Use git to get the latest Mesa files from the git repository, from whatever
branch is relevant.
d132 3
a134 2
Create/edit the docs/relnotes-x.y.html file to document what's new in the release.
Add the new relnotes-x.y.html file to <a href="relnotes.html">relnotes.html</a>.
d138 2
a139 3
Update the MESA_MAJOR, MESA_MINOR and MESA_TINY version numbers in
configs/default.
Also update the VERSION line in the top-level Makefile.
d143 1
a143 1
Make sure the values in src/mesa/main/version.h are correct.
d147 2
a148 1
Update docs/news.html.
d152 1
a152 1
Check in all updates to git.
d156 5
a160 3
Tag the files with the release name (in the form <b>mesa_X_Y</b>)
with: <code>git tag -a mesa_X_Y</code>
Then: <code>git push origin mesa_X_Y</code>
d167 1
a167 1
<code>ln -s Mesa Mesa-7.5</code>
d180 1
a180 1
Add them to the docs/relnotes-X.Y.html file.
a194 8
Basically, to upload the tarball files with:
<br>
<code>
rsync -avP ssh Mesa*-X.Y.* USERNAME@@frs.sourceforge.net:uploads/
</code>
</p>

<p>
d196 1
a196 5
/home/users/b/br/brianp/mesa-www/htdocs/ with:
<br>
<code>
sftp USERNAME,mesa3d@@web.sourceforge.net
</code>
d201 2
a202 3

<em>m</em><em>e</em><em>s</em><em>a</em><em>-</em><em>d</em><em>e</em><em>v</em><em>@@</em><em>l</em><em>i</em><em>s</em><em>t</em><em>s</em><em>.</em><em>f</em><em>r</em><em>e</em><em>e</em><em>d</em><em>e</em><em>s</em><em>k</em><em>t</em><em>o</em><em>p</em><em>.</em><em>o</em><em>r</em><em>g</em>,
<em>m</em><em>e</em><em>s</em><em>a</em><em>-</em><em>u</em><em>s</em><em>e</em><em>r</em><em>s</em><em>@@</em><em>l</em><em>i</em><em>s</em><em>t</em><em>s</em><em>.</em><em>f</em><em>r</em><em>e</em><em>e</em><em>d</em><em>e</em><em>s</em><em>k</em><em>t</em><em>o</em><em>p</em><em>.</em><em>o</em><em>r</em><em>g</em>
d204 1
a204 1
<em>m</em><em>e</em><em>s</em><em>a</em><em>-</em><em>a</em><em>n</em><em>n</em><em>o</em><em>u</em><em>n</em><em>c</em><em>e</em><em>@@</em><em>l</em><em>i</em><em>s</em><em>t</em><em>s</em><em>.</em><em>f</em><em>r</em><em>e</em><em>e</em><em>d</em><em>e</em><em>s</em><em>k</em><em>t</em><em>o</em><em>p</em><em>.</em><em>o</em><em>r</em><em>g</em>
@


1.1.1.4
log
@Import Mesa 9.2.0
@
text
@d1 1
a1 12
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Development Notes</title>
  <link rel="stylesheet" type="text/css" href="mesa.css">
</head>
<body>

<div class="header">
  <h1>The Mesa 3D Graphics Library</h1>
</div>
d3 1
a3 2
<iframe src="contents.html"></iframe>
<div class="content">
d5 1
a5 1
<h1>Development Notes</h1>
d7 1
d9 4
a12 1
<h2>Adding Extentions</h2>
d55 1
a55 1
<h2>Coding Style</h2>
a74 7
Line width: the preferred width to fill comments and code in Mesa is 78
columns.  Exceptions are sometimes made for clarity (e.g. tabular data is
sometimes filled to a much larger width so that extraneous carriage returns
don't obscure the table).
</p>

<p>
a83 15

	switch (condition) {
	case 0:
	   foo();
	   break;

	case 1: {
	   ...
	   break;
	}

	default:
	   ...
	   break;
	}
a87 1
(Note that it won't format switch statements in the preferred way)
a116 9
<p>
Places that are not directly visible to the GL API should prefer the use
of <tt>bool</tt>, <tt>true</tt>, and
<tt>false</tt> over <tt>GLboolean</tt>, <tt>GL_TRUE</tt>, and
<tt>GL_FALSE</tt>.  In C code, this may mean that
<tt>#include &lt;stdbool.h&gt;</tt> needs to be added.  The
<tt>try_emit_</tt>* methods in src/mesa/program/ir_to_mesa.cpp and
src/mesa/state_tracker/st_glsl_to_tgsi.cpp can serve as examples.
</p>
d118 1
a118 2

<h2>Marking a commit as a candidate for a stable branch</h2>
d121 1
a121 2
If you want a commit to be applied to a stable branch,
you should add an appropriate note to the commit message.
d124 1
d126 2
a127 1
Here are some examples of such a note:
a128 5
<ul>
  <li>NOTE: This is a candidate for the 9.0 branch.</li>
  <li>NOTE: This is a candidate for the 8.0 and 9.0 branches.</li>
  <li>NOTE: This is a candidate for the stable branches.</li>
</ul>
d131 5
a135 1
<h2>Cherry-picking candidates for a stable branch</h2>
d138 3
a140 2
Please use <code>git cherry-pick -x &lt;commit&gt;</code> for cherry-picking a commit
from master to a stable branch.
a142 2
<h2>Making a New Mesa Release</h2>

d144 1
a144 1
These are the instructions for making a new Mesa release.
a146 1
<h3>Get latest source files</h3>
d148 1
a148 2
Use git to get the latest Mesa files from the git repository, from whatever
branch is relevant.
a150 11

<h3>Verify and update version info</h3>

<dl>
  <dt>SConstruct</dt>
  <dt>Android.common.mk</dt>
  <dd>PACKAGE_VERSION</dd>
  <dt>configure.ac</dt>
  <dd>AC_INIT</dd>
</dl>

d152 1
a152 4
Create a docs/relnotes/x.y.z.html file.
The bin/bugzilla_mesa.sh and bin/shortlog_mesa.sh scripts can be used to
create the HTML-formatted lists of bugfixes and changes to include in the file.
Link the new docs/relnotes/x.y.z.html file into the main <a href="relnotes.html">relnotes.html</a> file.
d156 3
a158 1
Update <a href="index.html">docs/index.html</a>.
d161 2
d164 3
a166 3
Tag the files with the release name (in the form <b>mesa-x.y</b>)
with: <code>git tag -s mesa-x.y -m "Mesa x.y Release"</code>
Then: <code>git push origin mesa-x.y</code>
a168 2

<h3>Make the tarballs</h3>
a171 1
	./autogen.sh
d178 1
a178 1
Add them to the docs/relnotes/x.y.html file.
d186 1
a186 1
<h3>Update the website and announce the release</h3>
d188 2
a189 5
Make a new directory for the release on annarchy.freedesktop.org with:
<br>
<code>
mkdir /srv/ftp.freedesktop.org/pub/mesa/x.y
</code>
d196 1
a196 1
rsync -avP -e ssh MesaLib-x.y.* USERNAME@@annarchy.freedesktop.org:/srv/ftp.freedesktop.org/pub/mesa/x.y/
d218 2
a219 1
</div>
@


1.1.1.5
log
@Import Mesa 10.2.3
@
text
@d20 1
a20 1
<h2>Adding Extensions</h2>
d39 1
a39 1
   In the src/mapi/glapi/gen/ directory, add the new extension functions and
a58 5
<li>
   The dispatch tests check_table.cpp and dispatch_sanity.cpp
   should be updated with details about the new extensions functions. These
   tests are run using 'make check'
</li>
a157 23
<h2>Submitting patches</h2>

<p>
You should always run the Mesa Testsuite before submitting patches.
The Testsuite can be run using the 'make check' command. All tests
must pass before patches will be accepted, this may mean you have
to update the tests themselves.
</p>

<p>
Patches should be sent to the Mesa mailing list for review.
When submitting a patch make sure to use git send-email rather than attaching
patches to emails. Sending patches as attachments prevents people from being
able to provide in-line review comments.
</p>

<p>
When submitting follow-up patches you can use --in-reply-to to make v2, v3,
etc patches show up as replies to the originals. This usually works well
when you're sending out updates to individual patches (as opposed to
re-sending the whole series). Using --in-reply-to makes
it harder for reviewers to accidentally review old patches.
</p>
d170 3
a172 3
  <li>CC: &lt;mesa-stable@@lists.freedesktop.org&gt;</li>
  <li>CC: "9.2 10.0" &lt;mesa-stable@@lists.freedesktop.org&gt;</li>
  <li>CC: "10.0" &lt;mesa-stable@@lists.freedesktop.org&gt;</li>
a174 20
Simply adding the CC to the mesa-stable list address is adequate to nominate
the commit for the most-recently-created stable branch. It is only necessary
to specify a specific branch name, (such as "9.2 10.0" or "10.0" in the
examples above), if you want to nominate the commit for an older stable
branch. And, as in these examples, you can nominate the commit for the older
branch in addition to the more recent branch, or nominate the commit
exclusively for the older branch.

This "CC" syntax for patch nomination will cause patches to automatically be
copied to the mesa-stable@@ mailing list when you use "git send-email" to send
patches to the mesa-dev@@ mailing list. Also, if you realize that a commit
should be nominated for the stable branch after it has already been committed,
you can send a note directly to the mesa-stable@@lists.freedesktop.org where
the Mesa stable-branch maintainers will receive it. Be sure to mention the
commit ID of the commit of interest (as it appears in the mesa master branch).

The latest set of patches that have been nominated, accepted, or rejected for
the upcoming stable release can always be seen on the
<a href=http://cworth.org/~cworth/mesa-stable-queue/">Mesa Stable Queue</a>
page.
d196 9
a204 1
<h3>Verify and update version info in VERSION</h3>
d272 2
a273 2
<em>mesa-dev@@lists.freedesktop.org</em>,
<em>mesa-users@@lists.freedesktop.org</em>
d275 1
a275 1
<em>mesa-announce@@lists.freedesktop.org</em>
@


1.1.1.6
log
@Import Mesa 10.4.3
@
text
@d221 1
a221 1
<a href="http://cworth.org/~cworth/mesa-stable-queue/">Mesa Stable Queue</a>
d224 1
a224 1
<h2>Criteria for accepting patches to the stable branch</h2>
d226 4
a229 82
Mesa has a designated release manager for each stable branch, and the release
manager is the only developer that should be pushing changes to these
branches. Everyone else should simply nominate patches using the mechanism
described above.

The stable-release manager will work with the list of nominated patches, and
for each patch that meets the crtieria below will cherry-pick the patch with:
<code>git cherry-pick -x &lt;commit&gt;</code>. The <code>-x</code> option is
important so that the picked patch references the comit ID of the original
patch.

The stable-release manager may at times need to force-push changes to the
stable branches, for example, to drop a previously-picked patch that was later
identified as causing a regression). These force-pushes may cause changes to
be lost from the stable branch if developers push things directly. Consider
yourself warned.

The stable-release manager is also given broad discretion in rejecting patches
that have been nominated for the stable branch. The most basic rule is that
the stable branch is for bug fixes only, (no new features, no
regressions). Here is a non-exhaustive list of some reasons that a patch may
be rejected:

<ul>
  <li>Patch introduces a regression. Any reported build breakage or other
  regression caused by a particular patch, (game no longer work, piglit test
  changes from PASS to FAIL), is justification for rejecting a patch.</li>

  <li>Patch is too large, (say, larger than 100 lines)</li>

  <li>Patch is not a fix. For example, a commit that moves code around with no
  functional change should be rejected.</li>

  <li>Patch fix is not clearly described. For example, a commit message
  of only a single line, no description of the bug, no mention of bugzilla,
  etc.</li>

  <li>Patch has not obviously been reviewed, For example, the commit message
  has no Reviewed-by, Signed-off-by, nor Tested-by tags from anyone but the
  author.</li>

  <li>Patch has not already been merged to the master branch. As a rule, bug
  fixes should never be applied first to a stable branch. Patches should land
  first on the master branch and then be cherry-picked to a stable
  branch. (This is to avoid future releases causing regressions if the patch
  is not also applied to master.) The only things that might look like
  exceptions would be backports of patches from master that happen to look
  significantly different.</li>

  <li>Patch depends on too many other patches. Ideally, all stable-branch
  patches should be self-contained. It sometimes occurs that a single, logical
  bug-fix occurs as two separate patches on master, (such as an original
  patch, then a subsequent fix-up to that patch). In such a case, these two
  patches should be squashed into a single, self-contained patch for the
  stable branch. (Of course, if the squashing makes the patch too large, then
  that could be a reason to reject the patch.)</li>

  <li>Patch includes new feature development, not bug fixes. New OpenGL
  features, extensions, etc. should be applied to Mesa master and included in
  the next major release. Stable releases are intended only for bug fixes.

  Note: As an exception to this rule, the stable-release manager may accept
  hardware-enabling "features". For example, backports of new code to support
  a newly-developed hardware product can be accepted if they can be reasonably
  determined to not have effects on other hardware.</li>

  <li>Patch is a performance optimization. As a rule, performance patches are
  not candidates for the stable branch. The only exception might be a case
  where an application's performance was recently severely impacted so as to
  become unusable. The fix for this performance regression could then be
  considered for a stable branch. The optimization must also be
  non-controversial and the patches still need to meet the other criteria of
  being simple and self-contained</li>

  <li>Patch introduces a new failure mode (such as an assert). While the new
  assert might technically be correct, for example to make Mesa more
  conformant, this is not the kind of "bug fix" we want in a stable
  release. The potential problem here is that an OpenGL program that was
  previously working, (even if technically non-compliant with the
  specification), could stop working after this patch. So that would be a
  regression that is unaacceptable for the stable branch.</li>
</ul>
d240 1
a240 16
branch is relevant. This document uses the convention X.Y.Z for the release
being created, which should be created from a branch named X.Y.
</p>

<h3>Perform basic testing</h3>
<p>
The release manager should, at the very least, test the code by compiling it,
installing it, and running the latest piglit to ensure that no piglit tests
have regressed since the previous release.
</p>

<p>
The release manager should do this testing with at least one hardware driver,
(say, whatever is contained in the local development machine), as well as on
both Gallium and non-Gallium software drivers. The software testing can be
performed by running piglit with the following environment-variable set:
a242 3
<pre>
LIBGL_ALWAYS_SOFTWARE=1
</pre>
d244 1
a244 7
And Gallium vs. non-Gallium software drivers can be obtained by using the
following configure flags on separate builds:

<pre>
--with-dri-drivers=swrast
--with-gallium-drivers=swrast
</pre>
d247 4
a250 3
Note: If both options are given in one build, both swrast_dri.so drivers will
be compiled, but only one will be installed. The following command can be used
to ensure the correct driver is being tested:
a252 9
<pre>
LIBGL_ALWAYS_SOFTWARE=1 glxinfo | grep "renderer string"
</pre>

If any regressions are found in this testing with piglit, stop here, and do
not perform a release until regressions are fixed.

<h3>Update version in file VERSION</h3>

d254 1
a254 2
Increment the version contained in the file VERSION at Mesa's top-level, then
commit this change.
a256 2
<h3>Create release notes for the new release</h3>

d258 3
a260 3
Create a new file docs/relnotes/X.Y.Z.html, (follow the style of the previous
release notes). Note that the sha256sums section of the release notes should
be empty at this point.
a262 7
<p>
Two scripts are available to help generate portions of the release notes:

<pre>
	./bin/bugzilla_mesa.sh
	./bin/shortlog_mesa.sh
</pre>
d264 1
d266 1
a266 13
The first script identifies commits that reference bugzilla bugs and obtains
the descriptions of those bugs from bugzilla. The second script generates a
log of all commits. In both cases, HTML-formatted lists are printed to stdout
to be included in the release notes.
</p>

<p>
Commit these changes
</p>

<h3>Make the release archives, signatures, and the release tag</h3>
<p>
From inside the Mesa directory:
d269 1
a269 1
	make -j1 tarballs
d273 3
a275 2
After the tarballs are created, the sha256 checksums for the files will
be computed and printed. These will be used in a step below.
d279 2
a280 2
It's important at this point to also verify that the constructed tar file
actually builds:
d283 1
a283 8
<pre>
	tar xjf MesaLib-X.Y.Z.tar.bz2
	cd Mesa-X.Y.Z
	./configure --enable-gallium-llvm
	make -j6
	make install
</pre>

d285 5
a289 2
Some touch testing should also be performed at this point, (run glxgears or
more involved OpenGL programs against the installed Mesa).
d293 5
a297 90
Create detached GPG signatures for each of the archive files created above:
</p>

<pre>
	gpg --sign --detach MesaLib-X.Y.Z.tar.gz
	gpg --sign --detach MesaLib-X.Y.Z.tar.bz2
	gpg --sign --detach MesaLib-X.Y.Z.zip
</pre>

<p>
Tag the commit used for the build:
</p>

<pre>
	git tag -s mesa-X.Y.X -m "Mesa X.Y.Z release"
</pre>

<p>
Note: It would be nice to investigate and fix the issue that causes the
tarballs target to fail with multiple build process, such as with "-j4". It
would also be nice to incorporate all of the above commands into a single
makefile target. And instead of a custom "tarballs" target, we should
incorporate things into the standard "make dist" and "make distcheck" targets.
</p>

<h3>Add the sha256sums to the release notes</h3>

<p>
Edit docs/relnotes/X.Y.Z.html to add the sha256sums printed as part of "make
tarballs" in the previous step. Commit this change.
</p>

<h3>Push all commits and the tag creates above</h3>

<p>
This is the first step that cannot easily be undone. The release is going
forward from this point:
</p>

<pre>
	git push origin X.Y --tags
</pre>

<h3>Install the release files and signatures on the distribution server</h3>

<p>
The following commands can be used to copy the release archive files and
signatures to the freedesktop.org server:
</p>

<pre>
	scp MesaLib-X.Y.Z* people.freedesktop.org:
	ssh people.freedesktop.org
	cd /srv/ftp.freedesktop.org/pub/mesa
	mkdir X.Y.Z
	cd X.Y.Z
	mv ~/MesaLib-X.Y.Z* .
</pre>

<h3>Back on mesa master, andd the new release notes into the tree</h3>

<p>
Something like the following steps will do the trick:
</p>

<pre>
	cp docs/relnotes/X.Y.Z.html /tmp
        git checkout master
        cp /tmp/X.Y.Z.html docs/relnotes
        git add docs/relnotes/X.Y.Z.html
</pre>

<p>
Also, edit docs/relnotes.html to add a link to the new release notes, and edit
docs/index.html to add a news entry. Then commit and push:
</p>

<pre>
	git commit -a -m "docs: Import X.Y.Z release notes, add news item."
        git push origin
</pre>

<h3>Update the mesa3d.org website</h3>

<p>
NOTE: The recent release managers have not been performing this step
themselves, but leaving this to Brian Paul, (who has access to the
sourceforge.net hosting for mesa3d.org). Brian is more than willing to grant
the permission necessary to future release managers to do this step on their
own.
a308 2

<h3>Announce the release</h3>
d313 1
a315 8

Follow the template of previously-sent release announcements. The following
command can be used to generate the log of changes to be included in the
release announcement:

<pre>
	git shortlog mesa-X.Y.Z-1..mesa-X.Y.Z
</pre>
@


1.1.1.7
log
@Import Mesa 10.2.9
@
text
@d221 1
a221 1
<a href=http://cworth.org/~cworth/mesa-stable-queue/">Mesa Stable Queue</a>
d224 1
a224 1
<h2>Cherry-picking candidates for a stable branch</h2>
d226 82
a307 4
<p>
Please use <code>git cherry-pick -x &lt;commit&gt;</code> for cherry-picking a commit
from master to a stable branch.
</p>
d318 16
a333 1
branch is relevant.
d336 3
d340 7
a346 1
<h3>Verify and update version info in VERSION</h3>
d349 3
a351 4
Create a docs/relnotes/x.y.z.html file.
The bin/bugzilla_mesa.sh and bin/shortlog_mesa.sh scripts can be used to
create the HTML-formatted lists of bugfixes and changes to include in the file.
Link the new docs/relnotes/x.y.z.html file into the main <a href="relnotes.html">relnotes.html</a> file.
d354 9
d364 2
a365 1
Update <a href="index.html">docs/index.html</a>.
d368 2
d371 3
a373 3
Tag the files with the release name (in the form <b>mesa-x.y</b>)
with: <code>git tag -s mesa-x.y -m "Mesa x.y Release"</code>
Then: <code>git push origin mesa-x.y</code>
d376 7
a383 1
<h3>Make the tarballs</h3>
d385 13
a397 1
Make the distribution files.  From inside the Mesa directory:
d400 42
a441 1
	make tarballs
d445 5
a449 3
After the tarballs are created, the md5 checksums for the files will
be computed.
Add them to the docs/relnotes/x.y.html file.
d452 2
d455 2
a456 2
Copy the distribution files to a temporary directory, unpack them,
compile everything, and run some demos to be sure everything works.
d459 2
a460 1
<h3>Update the website and announce the release</h3>
d462 40
a501 5
Make a new directory for the release on annarchy.freedesktop.org with:
<br>
<code>
mkdir /srv/ftp.freedesktop.org/pub/mesa/x.y
</code>
d504 7
d512 5
a516 5
Basically, to upload the tarball files with:
<br>
<code>
rsync -avP -e ssh MesaLib-x.y.* USERNAME@@annarchy.freedesktop.org:/srv/ftp.freedesktop.org/pub/mesa/x.y/
</code>
d528 2
a533 1
<em>mesa-users@@lists.freedesktop.org</em>
d536 8
@


