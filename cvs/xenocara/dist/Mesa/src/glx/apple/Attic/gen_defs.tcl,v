head	1.2;
access;
symbols
	OPENBSD_5_2:1.1.0.10
	OPENBSD_5_2_BASE:1.1
	OPENBSD_5_1_BASE:1.1
	OPENBSD_5_1:1.1.0.8
	v7_10_3:1.1.1.1
	mesa:1.1.1
	OPENBSD_5_0:1.1.0.6
	OPENBSD_5_0_BASE:1.1
	OPENBSD_4_9:1.1.0.2
	OPENBSD_4_9_BASE:1.1
	OPENBSD_4_8:1.1.0.4
	OPENBSD_4_8_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2012.08.17.13.58.13;	author mpi;	state dead;
branches;
next	1.1;

1.1
date	2010.05.22.20.06.14;	author matthieu;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2011.10.23.13.29.34;	author matthieu;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Upate to libGL 7.11.2

Tested by jsg@@, matthieu@@ and ajacoutot@@, ok mattieu@@
@
text
@#This parses and generates #defines from an enum.spec type of file.

proc main {argc argv} {
    if {2 != $argc} {
	puts stderr "syntax is: [info script] input.spec output.h"
	exit 1
    }

    set fd [open [lindex $argv 0] r]
    set data [read $fd]
    close $fd

    set fd [open [lindex $argv 1] w]
    
    set state ""

    puts $fd "#define GL_VERSION_1_1 1"
    puts $fd "#define GL_VERSION_1_2 1"
    puts $fd "#define GL_VERSION_1_3 1"
    puts $fd "#define GL_VERSION_1_4 1"
    puts $fd "#define GL_VERSION_1_5 1"
    puts $fd "#define GL_VERSION_2_0 1"
    #puts $fd "#define GL_VERSION_3_0 1"

    set mask ""
    array set ar {}

    foreach line [split $data \n] {
	if {[regexp {^\S*#.*} $line] > 0} {
	    #puts COMMENT:$line
	    set state ""
	} elseif {"enum" eq $state} {
	    if {[string match "\t*" $line]} {
		if {[regexp {^\tuse.*} $line] > 0} {
		    lassign [split [string trim $line]] use usemask def
		    set usemask [string trim $usemask]
		    set def [string trim $def]
		    puts $fd "/* GL_$def */" 
		} else {
		    lassign [split [string trim $line] =] def value
		    set def [string trim $def]
		    set value [string trim $value]

		    #Trim out the data like: 0x0B00 # 4 F
		    set value [lindex [split $value] 0]

		    puts $fd "#define GL_$def $value"

		    #Save this association with the value.
		    set d $ar($mask)
		    dict set d $def $value
		    set ar($mask) $d
		}
	    } else {
		set state ""
	    }
	} elseif {[string match "* enum:*" $line]} {
	    lassign [split $line] mask _
	    puts $fd "\n/*[string trim $mask]*/"
	    set ar($mask) [dict create]
	    set state enum
  	}
    }
    
    close $fd
}
main $::argc $::argv
@


1.1
log
@Update to Mesa 7.8.1. Tested on a bulk ports build by naddy@@, ok oga@@.
@
text
@@


1.1.1.1
log
@Import Mesa 7.10.3
@
text
@@

