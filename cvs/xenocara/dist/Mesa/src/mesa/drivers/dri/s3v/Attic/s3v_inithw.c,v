head	1.2;
access;
symbols
	OPENBSD_4_7:1.1.1.1.0.12
	OPENBSD_4_7_BASE:1.1.1.1
	OPENBSD_4_6:1.1.1.1.0.10
	OPENBSD_4_6_BASE:1.1.1.1
	OPENBSD_4_5:1.1.1.1.0.8
	OPENBSD_4_5_BASE:1.1.1.1
	OPENBSD_4_4:1.1.1.1.0.6
	OPENBSD_4_4_BASE:1.1.1.1
	OPENBSD_4_3_BASE:1.1.1.1
	OPENBSD_4_3:1.1.1.1.0.4
	v7_0_1:1.1.1.1
	OPENBSD_4_2:1.1.1.1.0.2
	OPENBSD_4_2_BASE:1.1.1.1
	v6_5_2:1.1.1.1
	v6_5_1:1.1.1.1
	mesa:1.1.1;
locks; strict;
comment	@ * @;


1.2
date	2010.05.22.20.06.25;	author matthieu;	state dead;
branches;
next	1.1;

1.1
date	2006.11.25.18.53.47;	author matthieu;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2006.11.25.18.53.47;	author matthieu;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Update to Mesa 7.8.1. Tested on a bulk ports build by naddy@@, ok oga@@.
@
text
@/*
 * Author: Max Lingua <sunmax@@libero.it>
 */

#include <sys/ioctl.h>

#include "s3v_context.h"

void s3vInitHW( s3vContextPtr vmesa )
{
	int i;
	static short _reset = 1;

	DEBUG(("vmesa->driDrawable = %p\n", vmesa->driDrawable));
	DEBUG(("stride = %i\n",
		vmesa->driScreen->fbWidth*vmesa->s3vScreen->cpp));
	DEBUG(("frontOffset = 0x%x\n", vmesa->s3vScreen->frontOffset));
	DEBUG(("backOffset = 0x%x\n", vmesa->s3vScreen->backOffset));
	DEBUG(("depthOffset = 0x%x\n", vmesa->s3vScreen->depthOffset));
	DEBUG(("textureOffset = 0x%x\n", vmesa->s3vScreen->texOffset));

/*	if (_reset) { */
/*	ioctl(vmesa->driFd, 0x4a); */
		ioctl(vmesa->driFd, 0x41); /* reset */
		_reset = 0;
/*	ioctl(vmesa->driFd, 0x4c); */
/*	} */

	/* FIXME */
	switch (vmesa->s3vScreen->cpp) {
		case 2:
			break;
		case 4:
			break;
	}

	/* FIXME for stencil, gid, etc */
	switch (vmesa->DepthSize) {
		case 15:
		case 16:
			break;
		case 24:
			break;
		case 32:
			break;
	}

	vmesa->FogMode = 1;
	vmesa->ClearDepth = 0xffff;
	vmesa->x = 0;
	vmesa->y = 0;
	vmesa->w = 0;
	vmesa->h = 0;
	vmesa->FrameCount = 0;
	vmesa->MatrixMode = GL_MODELVIEW;
	vmesa->ModelViewCount = 0;
	vmesa->ProjCount = 0;
	vmesa->TextureCount = 0;


	/* FIXME: do we need the following? */

	for (i = 0; i < 16; i++)
		if (i % 5 == 0)
			vmesa->ModelView[i] =
			vmesa->Proj[i] =
			vmesa->ModelViewProj[i] =
			vmesa->Texture[i] = 1.0;
		else
			vmesa->ModelView[i] =
			vmesa->Proj[i] =
			vmesa->ModelViewProj[i] =
			vmesa->Texture[i] = 0.0;

	vmesa->LBWindowBase = vmesa->driScreen->fbWidth *
				(vmesa->driScreen->fbHeight - 1);
	vmesa->FBWindowBase = vmesa->driScreen->fbWidth * 
				(vmesa->driScreen->fbHeight - 1);
}
@


1.1
log
@Initial revision
@
text
@@


1.1.1.1
log
@Import MesaLibs 6.5.1. (in dist/ since its code is shared between lib 
and xserver)...
@
text
@@
