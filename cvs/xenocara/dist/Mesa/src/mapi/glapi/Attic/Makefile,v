head	1.3;
access;
symbols
	OPENBSD_5_4:1.2.0.4
	OPENBSD_5_4_BASE:1.2
	OPENBSD_5_3:1.2.0.2
	OPENBSD_5_3_BASE:1.2
	OPENBSD_5_2:1.1.1.1.0.4
	OPENBSD_5_2_BASE:1.1.1.1
	OPENBSD_5_1_BASE:1.1.1.1
	OPENBSD_5_1:1.1.1.1.0.2
	v7_10_3:1.1.1.1
	mesa:1.1.1;
locks; strict;
comment	@# @;


1.3
date	2013.09.05.14.03.48;	author jsg;	state dead;
branches;
next	1.2;

1.2
date	2012.08.17.13.58.14;	author mpi;	state Exp;
branches;
next	1.1;

1.1
date	2011.10.23.13.29.35;	author matthieu;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2011.10.23.13.29.35;	author matthieu;	state Exp;
branches;
next	;


desc
@@


1.3
log
@Merge Mesa 9.2.0
@
text
@# src/mapi/glapi/Makefile

TOP = ../../..
include $(TOP)/configs/current

TARGET = glapi

MAPI = $(TOP)/src/mapi/mapi

include sources.mak
include $(MAPI)/sources.mak

glapi_CPPFLAGS := \
	-I$(TOP)/include \
	-I$(TOP)/src/mapi \
	-I$(TOP)/src/mesa

ifeq ($(SHARED_GLAPI),1)
glapi_CPPFLAGS += \
	-DMAPI_MODE_BRIDGE \
	-DMAPI_ABI_HEADER=\"glapi/glapi_mapi_tmp.h\"
glapi_SOURCES := $(addprefix $(MAPI)/, $(MAPI_BRIDGE_SOURCES))

glapi_GLAPI_OBJECTS :=
glapi_ASM_OBJECTS :=
glapi_MAPI_OBJECTS := $(MAPI_BRIDGE_SOURCES:.c=.o)
else
glapi_CPPFLAGS += -DMAPI_MODE_UTIL
glapi_SOURCES := $(GLAPI_SOURCES) $(addprefix $(MAPI)/, $(MAPI_UTIL_SOURCES))

glapi_GLAPI_OBJECTS := $(GLAPI_SOURCES:.c=.o)
glapi_ASM_OBJECTS := $(GLAPI_ASM_SOURCES:.S=.o)
glapi_MAPI_OBJECTS := $(MAPI_UTIL_SOURCES:.c=.o)
endif # SHARED_GLAPI

glapi_OBJECTS := \
	$(glapi_GLAPI_OBJECTS) \
	$(glapi_ASM_OBJECTS) \
	$(glapi_MAPI_OBJECTS)

default: depend lib$(TARGET).a

lib$(TARGET).a: $(glapi_OBJECTS)
	@@$(MKLIB) -o $(TARGET) -static $(glapi_OBJECTS)

$(glapi_GLAPI_OBJECTS): %.o: %.c
	$(CC) -c $(glapi_CPPFLAGS) $(CFLAGS) $< -o $@@

$(glapi_ASM_OBJECTS): %.o: %.S
	$(CC) -c $(glapi_CPPFLAGS) $(CFLAGS) $< -o $@@

$(glapi_MAPI_OBJECTS): %.o: $(MAPI)/%.c
	$(CC) -c $(glapi_CPPFLAGS) $(CFLAGS) $< -o $@@

install:

clean:
	-rm -f $(glapi_OBJECTS)
	-rm -f lib$(TARGET).a
	-rm -f depend depend.bak

ifeq ($(SHARED_GLAPI),1)
# workaround a bug in makedepend
makedepend_CPPFLAGS := \
	$(filter-out -DMAPI_ABI_HEADER=%, $(glapi_CPPFLAGS))
$(glapi_OBJECTS): glapi_mapi_tmp.h
else
makedepend_CPPFLAGS := $(glapi_CPPFLAGS)
endif

depend: $(glapi_SOURCES)
	@@ echo "running $(MKDEP)"
	@@ touch depend
	@@$(MKDEP) $(MKDEP_OPTIONS) -f- $(DEFINES) $(makedepend_CPPFLAGS) \
		$(glapi_SOURCES) 2>/dev/null | sed -e 's,^$(MAPI)/,,' > depend

-include depend
@


1.2
log
@Upate to libGL 7.11.2

Tested by jsg@@, matthieu@@ and ajacoutot@@, ok mattieu@@
@
text
@@


1.1
log
@Initial revision
@
text
@a10 3
GLAPI_OBJECTS = $(GLAPI_SOURCES:.c=.o)
GLAPI_ASM_OBJECTS = $(GLAPI_ASM_SOURCES:.S=.o)

a11 4
MAPI_GLAPI_OBJECTS := $(MAPI_GLAPI_SOURCES:.c=.o)
MAPI_GLAPI_SOURCES := $(addprefix $(MAPI)/, $(MAPI_GLAPI_SOURCES))

TARGET_OBJECTS = $(GLAPI_OBJECTS) $(GLAPI_ASM_OBJECTS) $(MAPI_GLAPI_OBJECTS)
d13 1
a13 1
INCLUDE_DIRS = \
d18 23
d43 2
a44 2
lib$(TARGET).a: $(TARGET_OBJECTS)
	@@$(MKLIB) -o $(TARGET) -static $(TARGET_OBJECTS)
d46 2
a47 2
$(GLAPI_OBJECTS): %.o: %.c
	$(CC) -c $(INCLUDE_DIRS) $(CFLAGS) $< -o $@@
d49 2
a50 2
$(GLAPI_ASM_OBJECTS): %.o: %.S
	$(CC) -c $(INCLUDE_DIRS) $(CFLAGS) $< -o $@@
d52 2
a53 2
$(MAPI_GLAPI_OBJECTS): %.o: $(MAPI)/%.c
	$(CC) -c $(INCLUDE_DIRS) $(CFLAGS) -DMAPI_GLAPI_CURRENT $< -o $@@
d58 1
a58 1
	-rm -f $(TARGET_OBJECTS)
d62 10
a71 1
depend: $(GLAPI_SOURCES) $(MAPI_GLAPI_SOURCES)
d74 2
a75 3
	@@$(MKDEP) $(MKDEP_OPTIONS) -f- $(DEFINES) $(INCLUDE_DIRS) \
		-DMAPI_GLAPI_CURRENT $(GLAPI_SOURCES) $(MAPI_GLAPI_SOURCES) \
		2>/dev/null | sed -e 's,^$(MAPI)/,,' > depend
@


1.1.1.1
log
@Import Mesa 7.10.3
@
text
@@
