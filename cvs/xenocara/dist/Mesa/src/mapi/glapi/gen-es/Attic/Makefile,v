head	1.3;
access;
symbols
	OPENBSD_5_4:1.2.0.4
	OPENBSD_5_4_BASE:1.2
	OPENBSD_5_3:1.2.0.2
	OPENBSD_5_3_BASE:1.2
	OPENBSD_5_2:1.1.1.1.0.4
	OPENBSD_5_2_BASE:1.1.1.1
	OPENBSD_5_1_BASE:1.1.1.1
	OPENBSD_5_1:1.1.1.1.0.2
	v7_10_3:1.1.1.1
	mesa:1.1.1;
locks; strict;
comment	@# @;


1.3
date	2013.09.05.14.03.53;	author jsg;	state dead;
branches;
next	1.2;

1.2
date	2012.08.17.13.58.14;	author mpi;	state Exp;
branches;
next	1.1;

1.1
date	2011.10.23.13.29.35;	author matthieu;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2011.10.23.13.29.35;	author matthieu;	state Exp;
branches;
next	;


desc
@@


1.3
log
@Merge Mesa 9.2.0
@
text
@TOP = ../../../..
MAPI = $(TOP)/src/mapi/mapi
GLAPI = ../gen
include $(TOP)/configs/current

OUTPUTS :=			\
	glapi_mapi_tmp.h	\
	main/dispatch.h		\
	main/remap_helper.h

COMMON = gl_and_es_API.xml gl_XML.py glX_XML.py license.py typeexpr.py
COMMON := $(addprefix $(GLAPI)/, $(COMMON))

ES1_APIXML := es1_API.xml
ES2_APIXML := es2_API.xml
ES1_OUTPUT_DIR := $(TOP)/src/mapi/es1api
ES2_OUTPUT_DIR := $(TOP)/src/mapi/es2api

ES1_DEPS = $(ES1_APIXML) base1_API.xml es1_EXT.xml es_EXT.xml \
	   es1_COMPAT.xml es_COMPAT.xml
ES2_DEPS = $(ES2_APIXML) base2_API.xml es2_EXT.xml es_EXT.xml \
	   es2_COMPAT.xml es_COMPAT.xml

ES1_OUTPUTS := $(addprefix $(ES1_OUTPUT_DIR)/, $(OUTPUTS))
ES2_OUTPUTS := $(addprefix $(ES2_OUTPUT_DIR)/, $(OUTPUTS))

SHARED_GLAPI_APIXML := $(GLAPI)/gl_and_es_API.xml
SHARED_GLAPI_OUTPUT_DIR := $(TOP)/src/mapi/shared-glapi
SHARED_GLAPI_DEPS := $(SHARED_GLAPI_APIXML)
SHARED_GLAPI_OUTPUTS = $(SHARED_GLAPI_OUTPUT_DIR)/glapi_mapi_tmp.h

all: es1 es2 shared-glapi

es1: $(ES1_OUTPUTS)
es2: $(ES2_OUTPUTS)
shared-glapi: $(SHARED_GLAPI_OUTPUTS)

$(ES1_OUTPUTS): APIXML := $(ES1_APIXML)
$(ES1_OUTPUTS): PRINTER := es1api
$(ES1_OUTPUTS): $(ES1_DEPS)

$(ES2_OUTPUTS): APIXML := $(ES2_APIXML)
$(ES2_OUTPUTS): PRINTER := es2api
$(ES2_OUTPUTS): $(ES2_DEPS)

$(SHARED_GLAPI_OUTPUTS): APIXML := $(SHARED_GLAPI_APIXML)
$(SHARED_GLAPI_OUTPUTS): PRINTER := shared-glapi
$(SHARED_GLAPI_OUTPUTS): $(SHARED_GLAPI_DEPS)

define gen-glapi
	@@mkdir -p $(dir $@@)
	$(PYTHON2) $(PYTHON_FLAGS) $< -f $(APIXML) $(1) > $@@
endef

%/glapi_mapi_tmp.h: $(MAPI)/mapi_abi.py $(COMMON)
	@@mkdir -p $(dir $@@)
	$(PYTHON2) $(PYTHON_FLAGS) $< \
		--printer $(PRINTER) --mode lib $(GLAPI)/gl_and_es_API.xml > $@@

%/main/dispatch.h: $(GLAPI)/gl_table.py $(COMMON)
	$(call gen-glapi,-c -m remap_table)

%/main/remap_helper.h: $(GLAPI)/remap_helper.py $(COMMON)
	$(call gen-glapi)

verify_xml:
	@@if [ ! -f gl.h ]; then \
		echo "Please copy gl.h and gl2.h to this directory"; \
		exit 1; \
	fi
	@@echo "Verifying that es1_API.xml covers OpenGL ES 1.1..."
	@@$(PYTHON2) $(PYTHON_FLAGS) gl_parse_header.py gl.h > tmp.xml
	@@$(PYTHON2) $(PYTHON_FLAGS) gl_compare.py difference tmp.xml es1_API.xml
	@@echo "Verifying that es2_API.xml covers OpenGL ES 2.0..."
	@@$(PYTHON2) $(PYTHON_FLAGS) gl_parse_header.py gl2.h > tmp.xml
	@@$(PYTHON2) $(PYTHON_FLAGS) gl_compare.py difference tmp.xml es2_API.xml
	@@rm -f tmp.xml

clean-es1:
	-rm -f $(ES1_OUTPUTS)
	-rm -rf $(ES1_OUTPUT_DIR)/main

clean-es2:
	-rm -f $(ES2_OUTPUTS)
	-rm -rf $(ES2_OUTPUT_DIR)/main

clean-shared-glapi:
	-rm -f $(SHARED_GLAPI_OUTPUTS)

clean: clean-es1 clean-es2 clean-shared-glapi
	-rm -f *~ *.pyc *.pyo
@


1.2
log
@Upate to libGL 7.11.2

Tested by jsg@@, matthieu@@ and ajacoutot@@, ok mattieu@@
@
text
@@


1.1
log
@Initial revision
@
text
@d2 1
d7 2
a8 7
	glapi/glapitable.h	\
	glapi/glapitemp.h	\
	glapi/glprocs.h		\
	glapi/glapi_sparc.S	\
	glapi/glapi_x86-64.S	\
	glapi/glapi_x86.S	\
	main/glapidispatch.h	\
d11 1
a11 1
COMMON = gl_XML.py glX_XML.py license.py typeexpr.py
d27 6
a32 1
all: es1 es2
d36 1
d39 3
d43 1
a43 1
$(ES1_OUTPUTS): $(ES1_DEPS)
d46 4
d55 6
a60 1
%/glapidispatch.h: $(GLAPI)/gl_table.py $(COMMON)
a62 18
%/glapitable.h: $(GLAPI)/gl_table.py $(COMMON)
	$(call gen-glapi,-c)

%/glapitemp.h: $(GLAPI)/gl_apitemp.py $(COMMON)
	$(call gen-glapi,-c)

%/glprocs.h: $(GLAPI)/gl_procs.py $(COMMON)
	$(call gen-glapi,-c)

%/glapi_sparc.S: $(GLAPI)/gl_SPARC_asm.py $(COMMON)
	$(call gen-glapi)

%/glapi_x86-64.S: $(GLAPI)/gl_x86-64_asm.py $(COMMON)
	$(call gen-glapi)

%/glapi_x86.S: $(GLAPI)/gl_x86_asm.py $(COMMON)
	$(call gen-glapi)

d80 1
a80 1
	-rm -rf $(ES1_OUTPUT_DIR)/glapi
d84 1
a84 1
	-rm -rf $(ES2_OUTPUT_DIR)/glapi
d87 4
a90 1
clean: clean-es1 clean-es2
@


1.1.1.1
log
@Import Mesa 7.10.3
@
text
@@
