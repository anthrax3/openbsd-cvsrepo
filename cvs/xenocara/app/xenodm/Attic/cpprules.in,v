head	1.2;
access;
symbols
	OPENBSD_6_1:1.1.0.2
	OPENBSD_6_1_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2017.07.26.21.14.54;	author matthieu;	state dead;
branches;
next	1.1;
commitid	YLbJF64kdY9Ph5RT;

1.1
date	2016.10.23.08.30.37;	author matthieu;	state Exp;
branches;
next	;
commitid	Evhyt8BYuNk92NV2;


desc
@@


1.2
log
@Stop abusing cpp as generic macro processor in the build system.

ok naddy@@
@
text
@#							-*- Makefile -*-
# Rules for generating files using the C pre-processor
# (Replaces CppFileTarget from Imake)

SED = sed

SUFFIXES = .cpp

WCHAR32_FLAGS = -DWCHAR32=@@WCHAR32@@

# Translate XCOMM into pound sign with sed, rather than passing -DXCOMM=XCOMM
# to cpp, because that trick does not work on all ANSI C preprocessors.
# Delete line numbers from the cpp output (-P is not portable, I guess).
# Allow XCOMM to be preceded by whitespace and provide a means of generating
# output lines with trailing backslashes.
# Allow XHASH to always be substituted, even in cases where XCOMM isn't.

CPP_SED_MAGIC = $(SED) -e '/^\#  *[0-9][0-9]*  *.*$$/d' \
                       -e '/^\#line  *[0-9][0-9]*  *.*$$/d' \
                       -e '/^[         ]*XCOMM$$/s/XCOMM/\#/' \
                       -e '/^[         ]*XCOMM[^a-zA-Z0-9_]/s/XCOMM/\#/' \
                       -e '/^[         ]*XHASH/s/XHASH/\#/' \
                       -e '/\@@\@@$$/s/\@@\@@$$/\\/'

.cpp:
	$(AM_V_GEN)$(RAWCPP) $(RAWCPPFLAGS) $(CPP_FILES_FLAGS) < $< | $(CPP_SED_MAGIC) > $@@
@


1.1
log
@Add xenodm a stripped down xdm (X Display Manager) for OpenBSD.
@
text
@@

