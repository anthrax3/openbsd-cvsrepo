head	1.11;
access;
symbols
	OPENBSD_4_9:1.10.0.4
	OPENBSD_4_9_BASE:1.10
	OPENBSD_4_8:1.10.0.6
	OPENBSD_4_8_BASE:1.10
	OPENBSD_4_7:1.10.0.2
	OPENBSD_4_7_BASE:1.10
	OPENBSD_4_6:1.8.0.2
	OPENBSD_4_6_BASE:1.8
	OPENBSD_4_5:1.7.0.4
	OPENBSD_4_5_BASE:1.7
	OPENBSD_4_4:1.7.0.2
	OPENBSD_4_4_BASE:1.7
	OPENBSD_4_3_BASE:1.4
	OPENBSD_4_3:1.4.0.2
	OPENBSD_4_2:1.3.0.2
	OPENBSD_4_2_BASE:1.3
	version_3:1.1.1.1
	cwm:1.1.1;
locks; strict;
comment	@ * @;


1.11
date	2011.03.22.10.47.59;	author okan;	state dead;
branches;
next	1.10;

1.10
date	2009.12.15.04.10.42;	author okan;	state Exp;
branches;
next	1.9;

1.9
date	2009.12.15.03.24.36;	author okan;	state Exp;
branches;
next	1.8;

1.8
date	2009.06.20.00.55.42;	author okan;	state Exp;
branches;
next	1.7;

1.7
date	2008.07.11.14.21.28;	author okan;	state Exp;
branches;
next	1.6;

1.6
date	2008.05.19.18.07.53;	author okan;	state Exp;
branches;
next	1.5;

1.5
date	2008.04.15.18.33.13;	author okan;	state Exp;
branches;
next	1.4;

1.4
date	2008.01.11.16.06.44;	author oga;	state Exp;
branches;
next	1.3;

1.3
date	2007.05.28.18.34.27;	author jasper;	state Exp;
branches;
next	1.2;

1.2
date	2007.04.27.18.10.39;	author bernd;	state Exp;
branches;
next	1.1;

1.1
date	2007.04.27.17.58.48;	author bernd;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2007.04.27.17.58.48;	author bernd;	state Exp;
branches;
next	;


desc
@@


1.11
log
@move the single keycode function directly into the menu code.

ok oga@@
@
text
@/*
 * calmwm - the calm window manager
 *
 * Copyright (c) 2004 Marius Aamodt Eriksen <marius@@monkey.org>
 *
 * Permission to use, copy, modify, and distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * $Id: input.c,v 1.10 2009/12/15 04:10:42 okan Exp $
 */

#include <sys/param.h>
#include <sys/queue.h>

#include <err.h>
#include <errno.h>
#include <stdlib.h>
#include <string.h>
#include <stdio.h>
#include <unistd.h>

#include "calmwm.h"

int
input_keycodetrans(KeyCode kc, u_int state, enum ctltype *ctl, char *chr)
{
	int	 ks;

	*ctl = CTL_NONE;
	*chr = '\0';

	ks = XKeycodeToKeysym(X_Dpy, kc, (state & ShiftMask) ? 1 : 0);

	/* Look for control characters. */
	switch (ks) {
	case XK_BackSpace:
		*ctl = CTL_ERASEONE;
		break;
	case XK_Return:
		*ctl = CTL_RETURN;
		break;
	case XK_Up:
		*ctl = CTL_UP;
		break;
	case XK_Down:
		*ctl = CTL_DOWN;
		break;
	case XK_Escape:
		*ctl = CTL_ABORT;
		break;
	}

	if (*ctl == CTL_NONE && (state & ControlMask)) {
		switch (ks) {
		case XK_s:
		case XK_S:
			/* Emacs "next" */
			*ctl = CTL_DOWN;
			break;
		case XK_r:
		case XK_R:
			/* Emacs "previous" */
			*ctl = CTL_UP;
			break;
		case XK_u:
		case XK_U:
			*ctl = CTL_WIPE;
			break;
		case XK_h:
		case XK_H:
			*ctl = CTL_ERASEONE;
			break;
		case XK_a:
		case XK_A:
			*ctl = CTL_ALL;
			break;
		}
	}

	if (*ctl == CTL_NONE && (state & Mod1Mask)) {
		switch (ks) {
		case XK_j:
		case XK_J:
			/* Vi "down" */
			*ctl = CTL_DOWN;
			break;
		case XK_k:
		case XK_K:
			/* Vi "up" */
			*ctl = CTL_UP;
			break;
		}
	}

	if (*ctl != CTL_NONE)
		return (0);

	/*
	 * For regular characters, only (part of, actually) Latin 1
	 * for now.
	 */
	if (ks < 0x20 || ks > 0x07e)
		return (-1);

	*chr = (char)ks;

	return (0);
}
@


1.10
log
@pull all non-X11 headers from calmwm.h and place them only where they
are required.

encourged to go all the way by oga@@
@
text
@d18 1
a18 1
 * $Id: input.c,v 1.9 2009/12/15 03:24:36 okan Exp $
@


1.9
log
@merge the 2 common header files; specific includes to be pulled out as
separate commits.

ok oga@@
@
text
@d18 1
a18 1
 * $Id: input.c,v 1.8 2009/06/20 00:55:42 okan Exp $
d20 10
@


1.8
log
@compact a bit by condensing a few if-else's; from Thomas Pfaff

"go on then" oga@@
@
text
@d18 1
a18 1
 * $Id: input.c,v 1.7 2008/07/11 14:21:28 okan Exp $
a20 1
#include "headers.h"
@


1.7
log
@spacing, declaration lineup to be consistent throughout cwm,
readability, and a bit of knf.

ok oga@@
@
text
@d18 1
a18 1
 * $Id: input.c,v 1.6 2008/05/19 18:07:53 okan Exp $
d32 1
a32 4
	if (state & ShiftMask)
		ks = XKeycodeToKeysym(X_Dpy, kc, 1);
	else
		ks = XKeycodeToKeysym(X_Dpy, kc, 0);
@


1.6
log
@stop normalizing search input; searching and matching are still
case-insensitive.  since this was the only use of normalizing input,
simplify as well.

allows one to exec with mixed case unmatched commands.

"works for me" oga@@
@
text
@d18 1
a18 1
 * $Id: input.c,v 1.5 2008/04/15 18:33:13 okan Exp $
d27 1
a27 1
	int ks;
@


1.5
log
@- add vi keybindings to search
- allow for ctrl-h as well

discussion with and ok oga@@
@
text
@d18 1
a18 1
 * $Id: input.c,v 1.4 2008/01/11 16:06:44 oga Exp $
d25 1
a25 2
input_keycodetrans(KeyCode kc, u_int state,
    enum ctltype *ctl, char *chr, int normalize)
a108 2
	if (normalize)
		*chr = tolower(*chr);
@


1.4
log
@- Remove the "all rights reserved" tag at the top of most of the source
  files, and replace them with the actual ISC license.

- add license to the manpage (it was lacking before)

- correct license statement in the README

Permission given by Marius (copyright holder):
"1. please replace with the standard ISC license
2. you may add the ISC license to the man page
3. feel free to replace the information in the README as well"

and Dros (copyright holder for group.c):
"Please switch group.c to the ISC License."

ok ian@@
@
text
@d18 1
a18 1
 * $Id: input.c,v 1.3 2007/05/28 18:34:27 jasper Exp $
d73 4
d80 15
@


1.3
log
@convert globals from G_foo to Foo, as per TODO.

"looks good" pedro@@, ok matthieu@@
@
text
@a4 1
 * All rights reserved.
d6 13
a18 1
 * $Id: input.c,v 1.2 2007/04/27 18:10:39 bernd Exp $
@


1.2
log
@Apply cwm-3-input_shift.diff from http://aon.iki.fi/cwm/.
@
text
@d7 1
a7 1
 * $Id: input.c,v 1.1.1.1 2007/04/27 17:58:48 bernd Exp $
d23 1
a23 1
		ks = XKeycodeToKeysym(G_dpy, kc, 1);
d25 1
a25 1
		ks = XKeycodeToKeysym(G_dpy, kc, 0);
@


1.1
log
@Initial revision
@
text
@d7 1
a7 1
 * $Id: input.c,v 1.5 2005/06/27 04:24:25 marius Exp $
d22 4
a25 1
	ks = XKeycodeToKeysym(G_dpy, kc, 0);
@


1.1.1.1
log
@Initial import of cwm-3.

tested by sturm@@, ok matthieu@@
@
text
@@
