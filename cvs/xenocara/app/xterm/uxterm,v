head	1.4;
access;
symbols
	OPENBSD_6_1:1.4.0.28
	OPENBSD_6_1_BASE:1.4
	OPENBSD_6_0:1.4.0.26
	OPENBSD_6_0_BASE:1.4
	OPENBSD_5_9:1.4.0.24
	OPENBSD_5_9_BASE:1.4
	OPENBSD_5_8:1.4.0.22
	OPENBSD_5_8_BASE:1.4
	OPENBSD_5_7:1.4.0.20
	OPENBSD_5_7_BASE:1.4
	OPENBSD_5_6:1.4.0.18
	OPENBSD_5_6_BASE:1.4
	OPENBSD_5_5:1.4.0.16
	OPENBSD_5_5_BASE:1.4
	OPENBSD_5_4:1.4.0.14
	OPENBSD_5_4_BASE:1.4
	OPENBSD_5_3:1.4.0.12
	OPENBSD_5_3_BASE:1.4
	OPENBSD_5_2:1.4.0.10
	OPENBSD_5_2_BASE:1.4
	OPENBSD_5_1_BASE:1.4
	OPENBSD_5_1:1.4.0.8
	OPENBSD_5_0:1.4.0.6
	OPENBSD_5_0_BASE:1.4
	OPENBSD_4_9:1.4.0.2
	OPENBSD_4_9_BASE:1.4
	OPENBSD_4_8:1.4.0.4
	OPENBSD_4_8_BASE:1.4
	OPENBSD_4_7:1.3.0.10
	OPENBSD_4_7_BASE:1.3
	OPENBSD_4_6:1.3.0.8
	OPENBSD_4_6_BASE:1.3
	OPENBSD_4_5:1.3.0.6
	OPENBSD_4_5_BASE:1.3
	OPENBSD_4_4:1.3.0.4
	OPENBSD_4_4_BASE:1.3
	OPENBSD_4_3_BASE:1.3
	OPENBSD_4_3:1.3.0.2
	v232:1.1.1.2
	v229:1.1.1.1
	OPENBSD_4_2:1.2.0.2
	OPENBSD_4_2_BASE:1.2
	v225:1.1.1.1
	v216:1.1.1.1
	xterm:1.1.1;
locks; strict;
comment	@# @;


1.4
date	2010.03.25.22.03.51;	author matthieu;	state Exp;
branches;
next	1.3;

1.3
date	2008.02.16.09.40.00;	author matthieu;	state Exp;
branches;
next	1.2;

1.2
date	2007.05.30.21.39.16;	author matthieu;	state Exp;
branches;
next	1.1;

1.1
date	2006.11.26.11.11.44;	author matthieu;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2006.11.26.11.11.44;	author matthieu;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	2008.02.16.09.35.18;	author matthieu;	state Exp;
branches;
next	;


desc
@@


1.4
log
@Update to xterm-255. Tested by stsp@@, oga@@.
@
text
@#!/bin/sh
# $XTermId: uxterm,v 1.26 2007/12/30 16:33:36 tom Exp $
# -----------------------------------------------------------------------------
# this file is part of xterm
#
# Copyright 2001-2006,2007 by Thomas E. Dickey
# 
#                         All Rights Reserved
# 
# Permission is hereby granted, free of charge, to any person obtaining a
# copy of this software and associated documentation files (the
# "Software"), to deal in the Software without restriction, including
# without limitation the rights to use, copy, modify, merge, publish,
# distribute, sublicense, and/or sell copies of the Software, and to
# permit persons to whom the Software is furnished to do so, subject to
# the following conditions:
# 
# The above copyright notice and this permission notice shall be included
# in all copies or substantial portions of the Software.
# 
# THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
# OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
# MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
# IN NO EVENT SHALL THE ABOVE LISTED COPYRIGHT HOLDER(S) BE LIABLE FOR ANY
# CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
# TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
# SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
# 
# Except as contained in this notice, the name(s) of the above copyright
# holders shall not be used in advertising or otherwise to promote the
# sale, use or other dealings in this Software without prior written
# authorization.
# -----------------------------------------------------------------------------
#
# wrapper script to setup xterm with UTF-8 locale

whoami=uxterm

: ${XTERM_PROGRAM=xterm}

# Check if there is a workable locale program.  If there is not, we will read
# something via the standard error.  Ignore whatever is written to the
# standard output.
locale=`sh -c "LC_ALL=C LC_CTYPE=C LANG=C locale >/dev/null" 2>&1`
found=no

# Check for -version and -help options, to provide a simple return without
# requiring the program to create a window:
if test $# = 1
then
	case $1 in
	-v|-ver*|-h|-he*)
		$XTERM_PROGRAM "$@@"
		exit $?
		;;
	esac
fi

# Check environment variables that xterm does, in the same order:
for name in LC_ALL LC_CTYPE LANG
do
	eval 'value=$'$name
	if test -n "$value" ; then
		case $value in
		*.utf8|*.UTF8|*.utf-8|*.UTF-8)
			found=yes
			;;
		*.utf8@@*|*.UTF8@@*|*.utf-8@@*|*.UTF-8@@*)
			found=yes
			;;
		C|POSIX)
			# Yes, I know this is not the same - but why are you
			# here then?
			value=en_US
			;;
		esac
		break
	fi
done

# If we didn't find one that used UTF-8, modify the safest one.  Not everyone
# has a UTF-8 locale installed (and there appears to be no trivial/portable way
# to determine whether it is, from a shell script).  We could check if the
# user's shell does not reset unknown locale specifiers, but not all shells do.
if test $found != yes ; then
	if test -n "$value" ; then
		value=`echo ${value} |sed -e 's/[.@@].*//'`.UTF-8
	else
		name="LC_CTYPE"
		value="en_US.UTF-8"
	fi
	eval save=\$${name}
	eval ${name}=${value}
	eval export ${name}
	if test -z "$locale" ; then
		# The 'locale' program tries to do a sanity check.
		check=`sh -c "locale >/dev/null" 2>&1`
		if test -n "$check" ; then
			eval ${name}=${save}
			eval export ${name}

			echo "$whoami tried to use locale $value by setting \$$name" >&2
			xmessage -file - <<EOF
$whoami tried unsuccessfully to use locale $value
by setting \$$name to "${value}".
EOF
			exit 1
		fi
	fi
fi

# for testing:
#test -f ./xterm && XTERM_PROGRAM=./xterm

exec $XTERM_PROGRAM -class UXTerm -title $whoami -en UTF-8 "$@@"
@


1.3
log
@Merge xterm 232.
New local change: default value for pointerMode is 0.
@
text
@d2 32
a33 1
# $XTermId: uxterm,v 1.25 2007/12/30 16:33:36 tom Exp $
@


1.2
log
@fix switching to UTF-8 mode. tested and ok naddy@@, msf@@.
@
text
@d2 2
a3 2
# $XTermId: uxterm,v 1.23 2006/01/04 02:10:27 tom Exp $
# $XFree86: xc/programs/xterm/uxterm,v 1.12 2006/01/04 02:10:27 dickey Exp $
d6 2
d71 1
a71 1
			echo "uxterm tried to use locale $value by setting \$$name" >&2
d73 1
a73 1
uxterm tried unsuccessfully to use locale $value
d84 1
a84 1
exec $XTERM_PROGRAM -class UXTerm -title 'uxterm' -en UTF-8 "$@@"
@


1.1
log
@Initial revision
@
text
@d82 1
a82 1
exec $XTERM_PROGRAM -class UXTerm -title 'uxterm' -u8 "$@@"
@


1.1.1.1
log
@Importing xterm 216
@
text
@@


1.1.1.2
log
@Import xterm version 232. tested by many.
@
text
@d2 2
a3 2
# $XTermId: uxterm,v 1.25 2007/12/30 16:33:36 tom Exp $
#
a5 2
whoami=uxterm

d69 1
a69 1
			echo "$whoami tried to use locale $value by setting \$$name" >&2
d71 1
a71 1
$whoami tried unsuccessfully to use locale $value
d82 1
a82 1
exec $XTERM_PROGRAM -class UXTerm -title $whoami -u8 "$@@"
@

