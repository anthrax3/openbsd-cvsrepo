head	1.54;
access;
symbols
	OPENBSD_6_1:1.54.0.4
	OPENBSD_6_1_BASE:1.54
	OPENBSD_6_0:1.52.0.2
	OPENBSD_6_0_BASE:1.52
	OPENBSD_5_9:1.51.0.4
	OPENBSD_5_9_BASE:1.51
	OPENBSD_5_8:1.51.0.6
	OPENBSD_5_8_BASE:1.51
	OPENBSD_5_7:1.51.0.2
	OPENBSD_5_7_BASE:1.51
	OPENBSD_5_6:1.49.0.14
	OPENBSD_5_6_BASE:1.49
	OPENBSD_5_5:1.49.0.12
	OPENBSD_5_5_BASE:1.49
	OPENBSD_5_4:1.49.0.8
	OPENBSD_5_4_BASE:1.49
	OPENBSD_5_3:1.49.0.6
	OPENBSD_5_3_BASE:1.49
	OPENBSD_5_2:1.49.0.4
	OPENBSD_5_2_BASE:1.49
	OPENBSD_5_1_BASE:1.49
	OPENBSD_5_1:1.49.0.2
	OPENBSD_5_0:1.46.0.2
	OPENBSD_5_0_BASE:1.46
	OPENBSD_4_9:1.45.0.6
	OPENBSD_4_9_BASE:1.45
	OPENBSD_4_8:1.45.0.4
	OPENBSD_4_8_BASE:1.45
	OPENBSD_4_7:1.45.0.2
	OPENBSD_4_7_BASE:1.45
	OPENBSD_4_6:1.40.0.6
	OPENBSD_4_6_BASE:1.40
	OPENBSD_4_5:1.40.0.2
	OPENBSD_4_5_BASE:1.40
	OPENBSD_4_4:1.38.0.4
	OPENBSD_4_4_BASE:1.38
	OPENBSD_4_3:1.38.0.2
	OPENBSD_4_3_BASE:1.38
	OPENBSD_4_2:1.37.0.2
	OPENBSD_4_2_BASE:1.37
	OPENBSD_4_1:1.36.0.4
	OPENBSD_4_1_BASE:1.36
	OPENBSD_4_0:1.36.0.2
	OPENBSD_4_0_BASE:1.36
	OPENBSD_3_9:1.35.0.2
	OPENBSD_3_9_BASE:1.35
	OPENBSD_3_8:1.31.0.6
	OPENBSD_3_8_BASE:1.31
	OPENBSD_3_7:1.31.0.4
	OPENBSD_3_7_BASE:1.31
	OPENBSD_3_6:1.31.0.2
	OPENBSD_3_6_BASE:1.31
	OPENBSD_3_5:1.28.0.2
	OPENBSD_3_5_BASE:1.28
	OPENBSD_3_4:1.27.0.2
	OPENBSD_3_4_BASE:1.27
	OPENBSD_3_3:1.24.0.2
	OPENBSD_3_3_BASE:1.24
	OPENBSD_3_2:1.23.0.2
	OPENBSD_3_2_BASE:1.23
	OPENBSD_3_1:1.20.0.2
	OPENBSD_3_1_BASE:1.20
	OPENBSD_3_0:1.19.0.4
	OPENBSD_3_0_BASE:1.19
	OPENBSD_2_9_BASE:1.19
	OPENBSD_2_9:1.19.0.2
	OPENBSD_2_8:1.18.0.2
	OPENBSD_2_8_BASE:1.18
	OPENBSD_2_7:1.17.0.2
	OPENBSD_2_7_BASE:1.17
	OPENBSD_2_6:1.14.0.2
	OPENBSD_2_6_BASE:1.14
	OPENBSD_2_5:1.10.0.4
	OPENBSD_2_5_BASE:1.10
	OPENBSD_2_4:1.10.0.2
	OPENBSD_2_4_BASE:1.10
	OPENBSD_2_3:1.6.0.2
	OPENBSD_2_3_BASE:1.6
	OPENBSD_2_2:1.4.0.6
	OPENBSD_2_2_BASE:1.4
	OPENBSD_2_1:1.4.0.4
	OPENBSD_2_1_BASE:1.4
	OPENBSD_2_0:1.4.0.2
	OPENBSD_2_0_BASE:1.4
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@.\" @;


1.54
date	2017.01.21.12.21.56;	author deraadt;	state Exp;
branches;
next	1.53;
commitid	YkRvCySDf8eOWybK;

1.53
date	2016.10.02.23.16.08;	author guenther;	state Exp;
branches;
next	1.52;
commitid	vh3VI9XDCXDPAZOO;

1.52
date	2016.04.25.19.18.41;	author tedu;	state Exp;
branches;
next	1.51;
commitid	gkGRXuaZYSQDVf3h;

1.51
date	2015.01.31.19.33.45;	author jmc;	state Exp;
branches;
next	1.50;
commitid	dcTJ3JLmqdSpu4uX;

1.50
date	2014.08.20.11.23.42;	author mikeb;	state Exp;
branches;
next	1.49;
commitid	vzc4wz1s3pDevb7K;

1.49
date	2012.01.07.08.30.37;	author jmc;	state Exp;
branches;
next	1.48;

1.48
date	2012.01.07.05.38.12;	author guenther;	state Exp;
branches;
next	1.47;

1.47
date	2011.10.02.21.46.29;	author jmc;	state Exp;
branches;
next	1.46;

1.46
date	2011.05.02.11.14.11;	author jmc;	state Exp;
branches;
next	1.45;

1.45
date	2009.10.22.15.02.12;	author sobrado;	state Exp;
branches;
next	1.44;

1.44
date	2009.10.22.12.35.53;	author sobrado;	state Exp;
branches;
next	1.43;

1.43
date	2009.08.16.09.41.08;	author sobrado;	state Exp;
branches;
next	1.42;

1.42
date	2009.07.19.12.56.19;	author millert;	state Exp;
branches;
next	1.41;

1.41
date	2009.07.08.16.04.00;	author millert;	state Exp;
branches;
next	1.40;

1.40
date	2008.12.15.09.49.59;	author jmc;	state Exp;
branches;
next	1.39;

1.39
date	2008.10.07.02.20.12;	author deraadt;	state Exp;
branches;
next	1.38;

1.38
date	2007.10.01.22.06.02;	author sobrado;	state Exp;
branches;
next	1.37;

1.37
date	2007.05.31.19.20.10;	author jmc;	state Exp;
branches;
next	1.36;

1.36
date	2006.03.26.17.55.31;	author mickey;	state Exp;
branches;
next	1.35;

1.35
date	2005.12.15.16.35.47;	author jmc;	state Exp;
branches;
next	1.34;

1.34
date	2005.12.15.16.33.11;	author jmc;	state Exp;
branches;
next	1.33;

1.33
date	2005.12.15.12.15.45;	author pedro;	state Exp;
branches;
next	1.32;

1.32
date	2005.09.06.23.28.23;	author jmc;	state Exp;
branches;
next	1.31;

1.31
date	2004.07.13.23.36.56;	author jmc;	state Exp;
branches;
next	1.30;

1.30
date	2004.07.13.23.33.28;	author jmc;	state Exp;
branches;
next	1.29;

1.29
date	2004.05.09.06.17.15;	author otto;	state Exp;
branches;
next	1.28;

1.28
date	2004.01.21.19.25.33;	author deraadt;	state Exp;
branches;
next	1.27;

1.27
date	2003.09.05.13.38.46;	author jmc;	state Exp;
branches;
next	1.26;

1.26
date	2003.07.14.08.56.02;	author jmc;	state Exp;
branches;
next	1.25;

1.25
date	2003.06.03.02.56.08;	author millert;	state Exp;
branches;
next	1.24;

1.24
date	2003.03.10.15.37.30;	author jmc;	state Exp;
branches;
next	1.23;

1.23
date	2002.09.30.09.54.56;	author avsm;	state Exp;
branches;
next	1.22;

1.22
date	2002.05.20.21.19.21;	author deraadt;	state Exp;
branches;
next	1.21;

1.21
date	2002.05.18.17.54.15;	author deraadt;	state Exp;
branches;
next	1.20;

1.20
date	2001.11.09.00.56.24;	author miod;	state Exp;
branches;
next	1.19;

1.19
date	2000.11.10.05.10.27;	author aaron;	state Exp;
branches;
next	1.18;

1.18
date	2000.07.16.23.40.48;	author hugh;	state Exp;
branches;
next	1.17;

1.17
date	2000.03.23.21.10.17;	author aaron;	state Exp;
branches;
next	1.16;

1.16
date	2000.03.07.21.11.09;	author aaron;	state Exp;
branches;
next	1.15;

1.15
date	2000.01.19.07.38.25;	author pjanzen;	state Exp;
branches;
next	1.14;

1.14
date	99.10.17.20.24.34;	author aaron;	state Exp;
branches;
next	1.13;

1.13
date	99.09.23.04.12.08;	author alex;	state Exp;
branches;
next	1.12;

1.12
date	99.07.21.01.25.44;	author deraadt;	state Exp;
branches;
next	1.11;

1.11
date	99.06.05.01.21.25;	author aaron;	state Exp;
branches;
next	1.10;

1.10
date	98.09.26.19.54.46;	author aaron;	state Exp;
branches;
next	1.9;

1.9
date	98.09.08.18.59.00;	author deraadt;	state Exp;
branches;
next	1.8;

1.8
date	98.09.07.01.04.13;	author art;	state Exp;
branches;
next	1.7;

1.7
date	98.08.30.22.45.15;	author deraadt;	state Exp;
branches;
next	1.6;

1.6
date	98.01.22.23.40.22;	author deraadt;	state Exp;
branches;
next	1.5;

1.5
date	98.01.03.12.22.10;	author deraadt;	state Exp;
branches;
next	1.4;

1.4
date	96.08.17.09.12.27;	author deraadt;	state Exp;
branches;
next	1.3;

1.3
date	96.07.08.22.09.41;	author ccappuc;	state Exp;
branches;
next	1.2;

1.2
date	96.06.26.05.33.31;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.45.16;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.45.16;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.54
log
@Expose the close-on-exec flag near the R/W flags.
ok guenther
@
text
@.\"	$OpenBSD: fstat.1,v 1.53 2016/10/02 23:16:08 guenther Exp $
.\"
.\" Copyright (c) 1987, 1991, 1993
.\"	The Regents of the University of California.  All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. Neither the name of the University nor the names of its contributors
.\"    may be used to endorse or promote products derived from this software
.\"    without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.\"     from: @@(#)fstat.1	8.3 (Berkeley) 2/25/94
.\"
.Dd $Mdocdate: October 2 2016 $
.Dt FSTAT 1
.Os
.Sh NAME
.Nm fstat
.Nd display status of open files
.Sh SYNOPSIS
.Nm fstat
.Op Fl fnosv
.Op Fl M Ar core
.Op Fl N Ar system
.Op Fl p Ar pid
.Op Fl u Ar user
.Op Ar
.Sh DESCRIPTION
.Nm
identifies open files.
A file is considered open by a process if it was explicitly opened,
is the working directory, root directory, active executable text, or kernel
trace file for that process.
If no options are specified,
.Nm
reports on all open files in the system.
.Pp
The options are as follows:
.Bl -tag -width Ds
.It Fl f
Restrict examination to files open in the same file systems as
the named file arguments, or to the file system containing the
current directory if there are no additional filename arguments.
For example, to find all files open in the file system where the
directory
.Pa /usr/src
resides, type
.Pp
.Dl # fstat -f /usr/src
.It Fl M Ar core
Extract values associated with the name list from the specified core
instead of the running kernel.
.It Fl N Ar system
Extract the name list from the specified system instead of the running kernel.
.It Fl n
Numerical format.
Print the device number (maj,min) of the file system
the file resides in rather than the mount point name.
For special files, print the
device number that the special device refers to rather than the filename
in
.Pa /dev .
Also, print the mode of the file in octal instead of symbolic form.
.It Fl o
Output file offset.
Follow the size field with the descriptor's offset.
Useful for checking progress as a process works through a large file.
This information is only visible to the user or superuser.
.It Fl p Ar pid
Report all files open by the specified process.
.It Fl s
Report per file io statistics in two additional columns
.Sq XFERS
and
.Sq KBYTES .
This information is only visible to the user or superuser.
.It Fl u Ar user
Report all files open by the specified user.
.It Fl v
Verbose mode.
Print error messages upon failures to locate particular
system data structures rather than silently ignoring them.
Most of these data structures are dynamically created or deleted and it is
possible for them to disappear while
.Nm
is running.
This is normal and unavoidable since the rest of the system is running while
.Nm
itself is running.
.It Ar
Restrict reports to the specified files.
.El
.Pp
The following fields are printed:
.Bl -tag -width MOUNT
.It Li USER
The username of the owner of the process (effective UID).
.It Li CMD
The command name of the process.
.It Li PID
The process ID.
.It Li FD
The file number in the per-process open file table or one of the following
special names:
.Bd -literal -offset indent
text	\- executable text inode
wd	\- current working directory
root	\- root inode
tr	\- kernel trace file
.Ed
.Pp
If the file number is followed by an asterisk
.Pq Ql * ,
the file is not an inode, but rather a socket, or there is an error.
In this case the remainder of the line doesn't
correspond to the remaining headers -- the format of the line
is described later under
.Sx SOCKETS .
.It Li MOUNT
If the
.Fl n
flag wasn't specified, this header is present and is the
pathname that the file system the file resides in is mounted on.
.It Li DEV
If the
.Fl n
flag is specified, this header is present and is the
major/minor number of the device that this file resides in.
.It Li INUM
The inode number of the file.
It will be followed by an asterisk
.Pq Ql *
if the inode is unlinked from disk.
.It Li MODE
The mode of the file.
If the
.Fl n
flag isn't specified, the mode is printed
using a symbolic format (see
.Xr strmode 3 ) ;
otherwise, the mode is printed
as an octal number.
.It Li R/W
This column describes the properties of the file descriptor:
.Bd -literal -offset indent
r	Open for reading
w	Open for writing
e	close-on-exec flag is set
.Ed
.Pp
This field is useful when trying to find the processes that are
preventing a file system from being downgraded to read-only.
.It Li SZ | DV
If the file is not a character or block special file, prints the size of
the file in bytes.
Otherwise, if the
.Fl n
flag is not specified, prints
the name of the special file as located in
.Pa /dev .
If that cannot be located, or the
.Fl n
flag is specified, prints the major/minor device
number that the special device refers to.
.It Li NAME
If filename arguments are specified and the
.Fl f
flag is not, then
this field is present and is the name associated with the given file.
Normally the name cannot be determined since there is no mapping
from an open file back to the directory entry that was used to open
that file.
Also, since different directory entries may reference
the same file (via
.Xr ln 1 ) ,
the name printed may not be the actual
name that the process originally used to open that file.
.It Li XFERS
Displays number of total data transfers performed on the file.
.It Li KBYTES
Displays total number of Kbytes written and read to the file.
.El
.Sh SOCKETS
The formatting of open sockets depends on the protocol domain.
In all cases the first field is the domain name
and the second field is the socket type (stream, dgram, etc).
The remaining fields are protocol dependent.
For TCP, it is the address of the tcpcb, and for UDP, the inpcb (socket pcb).
For
.Ux Ns -domain
sockets, it's the address of the socket pcb and the address
of the connected pcb (if connected).
Otherwise the protocol number and address of the socket itself are printed.
The attempt is to make enough information available to
permit further analysis without duplicating
.Xr netstat 1 .
.Pp
For example, the addresses mentioned above are the addresses which the
.Ic netstat -A
command would print for TCP, UDP, and
.Ux Ns -domain.
A unidirectional
.Ux Ns -domain
socket indicates the direction of flow with
an arrow
.Pf ( Dq <-
or
.Dq -> ) ,
and a full duplex socket shows a double arrow
.Pq Dq <-> .
.Pp
For
.Dv AF_INET
and
.Dv AF_INET6
sockets,
.Nm
also attempts to print the internet address and port for the
local end of a connection.
If the socket is connected, it also prints the remote internet address
and port.
A
.Ql *
is used to indicate an
.Dv INADDR_ANY
binding.
In this case, the
use of the arrow
.Pf ( Dq <--
or
.Dq --> )
indicates the direction the socket connection was created.
.Pp
If the socket has been spliced to or from another socket (see
.Xr setsockopt 2
and
.Dv SO_SPLICE )
then
.Nm
prints a thick arrow
.Pf ( Dq <==> ,
.Dq <== ,
or
.Dq ==> ) ,
followed by the address and endpoint information of the other socket
in the splice,
if available.
.Sh PIPES
Every pipe is printed as an address which is the same for both sides of
the pipe and a state that is built of the letters
.Dq RWE .
W \- The pipe blocks waiting for the reader to read data.
R \- The pipe blocks waiting for the writer to write data.
E \- The pipe is in EOF state.
.Sh KQUEUE
Each
.Xr kqueue 2
is printed with some information as to queue length.
Since these things are normally serviced quickly, it is likely that
nothing of real importance can be discerned.
.Sh SEE ALSO
.Xr netstat 1 ,
.Xr nfsstat 1 ,
.Xr ps 1 ,
.Xr systat 1 ,
.Xr top 1 ,
.Xr iostat 8 ,
.Xr pstat 8 ,
.Xr tcpdrop 8 ,
.Xr vmstat 8
.Sh HISTORY
The
.Nm
command appeared in
.Bx 4.3 tahoe .
.Sh CAVEATS
Sockets in use by the kernel, such as those opened by
.Xr nfsd 8 ,
will not be seen by
.Nm ,
even though they appear in
.Xr netstat 1 .
.Sh BUGS
Since
.Nm
takes a snapshot of the system, it is only correct for a very short period
of time.
.Pp
Moreover, because DNS resolution and YP lookups cause many file
descriptor changes,
.Nm
does not attempt to translate the internet address and port numbers into
symbolic names.
@


1.53
log
@Indicate with an asterisk when a file has been unlinked.

from Sebastien Marie
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.52 2016/04/25 19:18:41 tedu Exp $
d32 1
a32 1
.Dd $Mdocdate: April 25 2016 $
d162 7
a168 7
This column describes the access mode that the file allows.
The letter
.Sq r
indicates open for reading;
the letter
.Sq w
indicates open for writing.
@


1.52
log
@remove systrace support
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.51 2015/01/31 19:33:45 jmc Exp $
d32 1
a32 1
.Dd $Mdocdate: January 31 2015 $
d149 3
@


1.51
log
@removing two instances of "c.f." - it seems actually "cf." is correct, but
i removed/reworded these as in the case of ftp.1 it read badly anyway, and
for fstat.1 it meant i could zap an escape sequence; while here i replaced
some sequences of <space><tab> where a single <tab> was sufficient;
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.50 2014/08/20 11:23:42 mikeb Exp $
d32 1
a32 1
.Dd $Mdocdate: August 20 2014 $
a275 5
.Sh SYSTRACE
Each
.Xr systrace 4
device is printed with only the kernel address of the
device private data.
@


1.50
log
@Remove userland bits related to the crypto(4) interface;  ok deraadt
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.49 2012/01/07 08:30:37 jmc Exp $
d32 1
a32 1
.Dd $Mdocdate: January 7 2012 $
d125 1
a125 1
wd 	\- current working directory
d249 1
a249 1
If the socket has been spliced to or from another socket (c.f.\&
@


1.49
log
@tweak previous;
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.48 2012/01/07 05:38:12 guenther Exp $
a269 4
.Sh CRYPTO
Each
.Xr crypto 4
device is printed with only the kernel address of the device private data.
@


1.48
log
@Add rtable id and thread id to struct kinfo_proc (and fix process id)
and add an 'rtableid' keyword to ps.

Add rtable id, thread id, and socket splice info to struct kinfo_file2
and make fstat display socket splice information.

Remove old KVM_PROC2 and kinfo_proc2 interfaces; bump libkvm major

Socket splice info and corrections from bluhm@@  "Lovely" deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.47 2011/10/02 21:46:29 jmc Exp $
d32 1
a32 1
.Dd $Mdocdate: October 2 2011 $
d249 1
a249 1
If the socket has been spliced to or from another socket (c.f.
d252 2
a253 2
.Dv SO_SPLICE
) then
@


1.47
log
@dislays -> displays; from David Vasek
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.46 2011/05/02 11:14:11 jmc Exp $
d32 1
a32 1
.Dd $Mdocdate: May 2 2011 $
d229 2
d248 15
@


1.46
log
@no need to escape `|'; as discussed with schwartze
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.45 2009/10/22 15:02:12 sobrado Exp $
d32 1
a32 1
.Dd $Mdocdate: October 22 2009 $
d194 1
a194 1
Dislays number of total data transfers performed on the file.
@


1.45
log
@write UNIX-domain in a more consistent way; while here, replace a
few remaining ".Tn UNIX" macros with ".Ux" ones.

pointed out by ratchov@@, thanks!

ok jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.44 2009/10/22 12:35:53 sobrado Exp $
d168 1
a168 1
.It Li SZ\&|DV
@


1.44
log
@use the UNIX-related macros (.At and .Ux) where appropriate.

ok jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.43 2009/08/16 09:41:08 sobrado Exp $
d32 1
a32 1
.Dd $Mdocdate: August 16 2009 $
d205 2
a206 2
.Ux
domain sockets, it's the address of the socket pcb and the address
d216 1
a216 2
.Ux
domain.
d218 2
a219 2
.Ux
domain socket indicates the direction of flow with
@


1.43
log
@replace ".Ar file ..." with ".Ar" whenever possible.

ok jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.42 2009/07/19 12:56:19 millert Exp $
d32 1
a32 1
.Dd $Mdocdate: July 19 2009 $
d204 3
a206 1
For Unix domain sockets, it's the address of the socket pcb and the address
d215 6
a220 2
command would print for TCP, UDP, and Unix domain.
A unidirectional Unix domain socket indicates the direction of flow with
@


1.42
log
@Hook up "text" (executable) output and implement for fuser too.
Man page bits adapted from FreeBSD.  OK miod@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.41 2009/07/08 16:04:00 millert Exp $
d32 1
a32 1
.Dd $Mdocdate: July 8 2009 $
d108 1
a108 1
.It Ar file ...
@


1.41
log
@Add POSIX-compliant fuser mode to fstat.  Originally based on
a diff from Peter Werner but largely rewritten to use kinfo_file2.
OK deraadt@@ with man fixes from jmc@@ and sobrado@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.40 2008/12/15 09:49:59 jmc Exp $
d32 1
a32 1
.Dd $Mdocdate: December 15 2008 $
d50 1
a50 1
is the working directory, root directory, active pure text, or kernel
d124 1
a124 1
text	\- pure text inode
@


1.40
log
@correct the description of fstat output for sockets;
reported by Stephan A. Rickauer
ok otto
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.39 2008/10/07 02:20:12 deraadt Exp $
d32 1
a32 1
.Dd $Mdocdate: October 7 2008 $
d45 1
a45 1
.Op Ar file ...
@


1.39
log
@Do not display file offsets and a few other pieces of information, except
to the user or the superuser.  Display * for those fields instead.  From
PR 5113, but modified to use copyout correctly.
comments from tedu, ok from others
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.38 2007/10/01 22:06:02 sobrado Exp $
d32 1
a32 1
.Dd $Mdocdate: October 1 2007 $
d200 2
a201 3
In all cases the first field is the domain name, the second field
is the socket type (stream, dgram, etc), and the third is the socket
flags field (in hex).
@


1.38
log
@sort the fields in manual page in the same order as in fstat output;
use the same name for fields in the manual page and command output;
while here, fix spacing

millert@@ has observed that this change makes the header fields consistent
with what is the output by NetBSD and FreeBSD too

ok millert@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.37 2007/05/31 19:20:10 jmc Exp $
d32 1
a32 1
.Dd $Mdocdate: May 31 2007 $
d86 1
d94 1
@


1.37
log
@convert to new .Dd format;
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.36 2006/03/26 17:55:31 mickey Exp $
d32 1
a32 1
.Dd $Mdocdate$
d156 10
a177 10
.It Li R/W
This column describes the access mode that the file allows.
The letter
.Sq r
indicates open for reading;
the letter
.Sq w
indicates open for writing.
This field is useful when trying to find the processes that are
preventing a file system from being downgraded to read-only.
@


1.36
log
@and put new flag into the manpage
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.35 2005/12/15 16:35:47 jmc Exp $
d32 1
a32 1
.Dd February 25, 1994
@


1.35
log
@remove inaccuracy (pipes do not appear as unix sockets);
ok jaredy@@ pedro@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.34 2005/12/15 16:33:11 jmc Exp $
d40 1
a40 1
.Op Fl fnov
d88 5
d191 4
@


1.34
log
@make the systrace section just like the rest...
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.33 2005/12/15 12:15:45 pedro Exp $
a203 2
Note that since pipes are implemented using sockets, a pipe appears as a
connected Unix domain stream socket.
@


1.33
log
@fstat does not print an '*' for fifos, okay jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.32 2005/09/06 23:28:23 jmc Exp $
d251 3
a253 1
Each systrace device is printed with only the kernel address of the
@


1.32
log
@make some of the stat utility pages reference each other;
idea from a mail to misc@@ from simon dassow;
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.31 2004/07/13 23:36:56 jmc Exp $
d125 1
a125 3
the file is not an inode, but rather a socket,
.Tn FIFO ,
or there is an error.
@


1.31
log
@indent an example;
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.30 2004/07/13 23:33:28 jmc Exp $
d260 1
@


1.30
log
@.Xr tcpdrop 8 ,
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.29 2004/05/09 06:17:15 otto Exp $
d67 1
a67 1
.Li # fstat -f /usr/src
@


1.29
log
@Say that only sockets owned by processes can been seen. Based on diff
from jmc@@, better wording from tedu@@. ok hshoexer@@ millert@@ deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.28 2004/01/21 19:25:33 deraadt Exp $
d262 1
@


1.28
log
@prompt before command demo; jmc ok
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.27 2003/09/05 13:38:46 jmc Exp $
d116 1
a116 2
.Pp
.Bd -literal -offset indent -compact
d268 7
@


1.27
log
@correct an .Sx;
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.26 2003/07/14 08:56:02 jmc Exp $
d66 2
a67 1
.Ic fstat -f /usr/src .
@


1.26
log
@- fix a display
- escape dashes
- remove extra bracket
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.25 2003/06/03 02:56:08 millert Exp $
d131 1
a131 1
.Sx Sockets .
@


1.25
log
@Remove the advertising clause in the UCB license which Berkeley
rescinded 22 July 1999.  Proofed by myself and Theo.
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.24 2003/03/10 15:37:30 jmc Exp $
d116 5
a120 5
.Bd -literal -ragged -offset indent -compact
text	- pure text inode
wd 	- current working directory
root	- root inode
tr	- kernel trace file
d214 1
a214 1
.Pq Dq <-> ) .
d239 3
a241 3
W - The pipe blocks waiting for the reader to read data.
R - The pipe blocks waiting for the writer to write data.
E - The pipe is in EOF state.
@


1.24
log
@these pages all had bad section numbers in the .Xr's;

lots of help and ok millert@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.23 2002/09/30 09:54:56 avsm Exp $
d14 1
a14 5
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgement:
.\"	This product includes software developed by the University of
.\"	California, Berkeley and its contributors.
.\" 4. Neither the name of the University nor the names of its contributors
@


1.23
log
@typo, art ok
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.22 2002/05/20 21:19:21 deraadt Exp $
d189 1
a189 1
.Xr ln 2 ) ,
@


1.22
log
@fix Xr
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.21 2002/05/18 17:54:15 deraadt Exp $
d254 1
a254 1
Since these things are normally services quickly, it is likely that
@


1.21
log
@grok crypto/kqueue/systrace vnodes
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.20 2001/11/09 00:56:24 miod Exp $
d247 3
a249 2
Each systrace device is printed with only the kernel address of the
device private data.
d251 3
a253 1
Each kqueue is printed with some information as to queue length.
@


1.20
log
@Since all our arches have /dev/ksyms, replace rigid mentions of the kernel
being /bsd with more correct terms, and remove /bsd and /dev/kmem from the
FILES section if they were there.
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.19 2000/11/10 05:10:27 aaron Exp $
d246 10
@


1.19
log
@- Section shuffling: comply to the section ordering outlined in mdoc(7).
- Some .Nm trimming.
- .Sh AUTHOR -> .Sh AUTHORS
- Other miscellaneous fixes here and there.
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.18 2000/07/16 23:40:48 hugh Exp $
d73 1
a73 2
instead of the default
.Pa /dev/kmem .
d75 1
a75 2
Extract the name list from the specified system instead of the default
.Pa /bsd .
@


1.18
log
@Add -o option for printing file offset. Also some whitespace reformatting.
Handy. Checked by millert and niklas.
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.17 2000/03/23 21:10:17 aaron Exp $
d51 1
a51 1
.Nm fstat
d57 1
a57 1
.Nm fstat
d91 1
a91 1
.It Fl p pid
d93 1
a93 1
.It Fl u user
d101 1
a101 1
.Nm fstat
d104 1
a104 1
.Nm fstat
d222 4
a225 2
For AF_INET sockets,
.Nm fstat
a247 11
.Sh BUGS
Since
.Nm fstat
takes a snapshot of the system, it is only correct for a very short period
of time.
.Pp
Moreover, because DNS resolution and YP lookups cause many file
descriptor changes,
.Nm fstat
does not attempt to translate the internet address and port numbers into
symbolic names.
d261 11
@


1.17
log
@Fix some formatting problems I missed before.
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.16 2000/03/07 21:11:09 aaron Exp $
d44 1
a44 1
.Op Fl fnv
d87 4
@


1.16
log
@Various cleanup.
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.15 2000/01/19 07:38:25 pjanzen Exp $
d81 2
a82 2
the file resides in rather than the mount point name. For special
files, print the
d99 1
a99 1
This is normal and  unavoidable since the rest of the system is running while
d147 2
a148 1
The mode of the file.  If the
@


1.15
log
@Better summary line, in keeping with other *stat commands; from NetBSD
@
text
@d1 2
a2 1
.\"	$OpenBSD: fstat.1,v 1.14 1999/10/17 20:24:34 aaron Exp $
d49 1
a49 1
.Op Ar filename...
d63 2
a64 2
Restrict examination to files open in the same filesystems as
the named file arguments, or to the filesystem containing the
d66 1
a66 1
For example, to find all files open in the filesystem where the
d70 1
a70 1
.Dq Li fstat -f /usr/src .
d79 3
a81 2
Numerical format.  Print the device number (maj,min) of the filesystem
the file resides in rather than the mount point name; for special
d85 2
a86 2
.Pa /dev ;
and print the mode of the file in octal instead of symbolic form.
d92 4
a95 3
Verbose mode.  Print error messages upon failures to locate particular
system data structures rather than silently ignoring them.  Most of
these data structures are dynamically created or deleted and it is
d98 2
a99 2
is running.  This
is normal and  unavoidable since the rest of the system is running while
d102 1
a102 1
.It Ar filename ...
d125 3
a127 2
If the file number is followed by an asterisk (``*''), the file is
not an inode, but rather a socket,
d138 1
a138 1
pathname that the filesystem the file resides in is mounted on.
d156 2
a157 1
the file in bytes.  Otherwise, if the
d162 1
a162 2
If that cannot be
located, or the
d168 6
a173 2
The letter ``r'' indicates open for reading;
the letter ``w'' indicates open for writing.
d175 1
a175 1
preventing a filesystem from being downgraded to read-only.
d183 2
a184 1
that file.  Also, since different directory entries may reference
d205 1
a205 1
.Dq Li netstat -A
d210 6
a215 2
an arrow (``<-'' or ``->''), and a full duplex socket shows a double arrow
(``<->'').
d223 11
a233 3
A ``*'' is used to indicate an INADDR_ANY binding.  In this case, the
use of the arrow (``<--'' or ``-->'') indicates the direction the socket
connection was created.
d236 2
a237 1
the pipe and a state that is built of the letters 'RWE'.
@


1.14
log
@More consistent introduction to options.
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.13 1999/09/23 04:12:08 alex Exp $
d40 1
a40 1
.Nd file status
@


1.13
log
@Typo fixes.
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.12 1999/07/21 01:25:44 deraadt Exp $
d59 1
a59 1
Options:
@


1.12
log
@use .Ar on later .It Fl lines
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.11 1999/06/05 01:21:25 aaron Exp $
d182 1
a182 1
The formating of open sockets depends on the protocol domain.
@


1.11
log
@- remove trailing white space
- remove arguments from .Os macros
- remove arguments from .Nm macros, where appropriate
- some more Dq/Sq/Ql insanity
- still lots to do in the usr.bin tree... :/
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.10 1998/09/26 19:54:46 aaron Exp $
d70 1
a70 1
.It Fl M
d74 1
a74 1
.It Fl N
d85 1
a85 1
.It Fl p
d87 1
a87 1
.It Fl u
@


1.10
log
@usr.bin/ man page fixes, f-m.
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.9 1998/09/08 18:59:00 deraadt Exp $
d37 1
a37 1
.Os BSD 4
d191 1
a191 1
The attempt is to make enough information available to 
@


1.9
log
@bad sentence
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.8 1998/09/07 01:04:13 art Exp $
d50 1
a50 1
.Nm Fstat
d106 1
a106 1
The username of the owner of the process (effective uid).
d110 1
a110 1
The process id.
d151 1
a151 1
If the file is not a character or block special, prints the size of
d167 1
a167 1
preventing a filesystem from being down graded to read-only.
d187 2
a188 2
For tcp, it is the address of the tcpcb, and for udp, the inpcb (socket pcb).
For unix domain sockets, it's the address of the socket pcb and the address
d197 1
a197 1
command would print for tcp, udp, and unixdomain.
d199 2
a200 2
connected unix domain stream socket.
A unidirectional unix domain socket indicates the direction of flow with
@


1.8
log
@support for pipes
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.7 1998/08/30 22:45:15 deraadt Exp $
d225 1
a225 1
Moreover, because DNS resolution and YP lookups cause many of file
@


1.7
log
@man page fixes; aaron@@ug.cs.dal.ca
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.6 1998/01/22 23:40:22 deraadt Exp $
d213 6
@


1.6
log
@indent better; mph@@pobox.com
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.5 1998/01/03 12:22:10 deraadt Exp $
d188 1
a188 1
For unix domain sockets, its the address of the socket pcb and the address
d222 1
a222 1
does not attempt to translate the internet adress and port numbers into
@


1.5
log
@clarify what --> and <-- mean in tcp headers
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.4 1996/08/17 09:12:27 deraadt Exp $
d115 1
a115 1
.Bd -ragged -offset indent -compact
@


1.4
log
@doc lsof-like behaviour
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.3 1996/07/08 22:09:41 ccappuc Exp $
d210 3
a212 1
A ``*'' is used to indicate an INADDR_ANY binding.
@


1.3
log
@kernel is /bsd, os is OpenBSD
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.2 1996/06/26 05:33:31 deraadt Exp $
d203 8
d216 6
@


1.2
log
@rcsid
@
text
@d1 1
a1 1
.\"	$OpenBSD: fstat.1,v 1.1.1.1 1995/10/18 08:45:16 deraadt Exp $
d76 1
a76 1
.Pa /netbsd .
@


1.1
log
@Initial revision
@
text
@d1 1
a33 1
.\"	$Id: fstat.1,v 1.8 1995/09/27 19:20:24 jtc Exp $
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
