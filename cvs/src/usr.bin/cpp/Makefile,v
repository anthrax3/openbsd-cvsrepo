head	1.12;
access;
symbols
	OPENBSD_6_1:1.12.0.16
	OPENBSD_6_1_BASE:1.12
	OPENBSD_6_0:1.12.0.12
	OPENBSD_6_0_BASE:1.12
	OPENBSD_5_9:1.12.0.8
	OPENBSD_5_9_BASE:1.12
	OPENBSD_5_8:1.12.0.10
	OPENBSD_5_8_BASE:1.12
	OPENBSD_5_7:1.12.0.2
	OPENBSD_5_7_BASE:1.12
	OPENBSD_5_6:1.12.0.6
	OPENBSD_5_6_BASE:1.12
	OPENBSD_5_5:1.12.0.4
	OPENBSD_5_5_BASE:1.12
	OPENBSD_5_4:1.10.0.14
	OPENBSD_5_4_BASE:1.10
	OPENBSD_5_3:1.10.0.12
	OPENBSD_5_3_BASE:1.10
	OPENBSD_5_2:1.10.0.10
	OPENBSD_5_2_BASE:1.10
	OPENBSD_5_1_BASE:1.10
	OPENBSD_5_1:1.10.0.8
	OPENBSD_5_0:1.10.0.6
	OPENBSD_5_0_BASE:1.10
	OPENBSD_4_9:1.10.0.4
	OPENBSD_4_9_BASE:1.10
	OPENBSD_4_8:1.10.0.2
	OPENBSD_4_8_BASE:1.10
	OPENBSD_4_7:1.8.0.24
	OPENBSD_4_7_BASE:1.8
	OPENBSD_4_6:1.8.0.26
	OPENBSD_4_6_BASE:1.8
	OPENBSD_4_5:1.8.0.22
	OPENBSD_4_5_BASE:1.8
	OPENBSD_4_4:1.8.0.20
	OPENBSD_4_4_BASE:1.8
	OPENBSD_4_3:1.8.0.18
	OPENBSD_4_3_BASE:1.8
	OPENBSD_4_2:1.8.0.16
	OPENBSD_4_2_BASE:1.8
	OPENBSD_4_1:1.8.0.14
	OPENBSD_4_1_BASE:1.8
	OPENBSD_4_0:1.8.0.12
	OPENBSD_4_0_BASE:1.8
	OPENBSD_3_9:1.8.0.10
	OPENBSD_3_9_BASE:1.8
	OPENBSD_3_8:1.8.0.8
	OPENBSD_3_8_BASE:1.8
	OPENBSD_3_7:1.8.0.6
	OPENBSD_3_7_BASE:1.8
	OPENBSD_3_6:1.8.0.4
	OPENBSD_3_6_BASE:1.8
	OPENBSD_3_5:1.8.0.2
	OPENBSD_3_5_BASE:1.8
	OPENBSD_3_4:1.7.0.16
	OPENBSD_3_4_BASE:1.7
	OPENBSD_3_3:1.7.0.14
	OPENBSD_3_3_BASE:1.7
	OPENBSD_3_2:1.7.0.12
	OPENBSD_3_2_BASE:1.7
	OPENBSD_3_1:1.7.0.10
	OPENBSD_3_1_BASE:1.7
	OPENBSD_3_0:1.7.0.8
	OPENBSD_3_0_BASE:1.7
	OPENBSD_2_9_BASE:1.7
	OPENBSD_2_9:1.7.0.6
	OPENBSD_2_8:1.7.0.4
	OPENBSD_2_8_BASE:1.7
	OPENBSD_2_7:1.7.0.2
	OPENBSD_2_7_BASE:1.7
	OPENBSD_2_6:1.6.0.12
	OPENBSD_2_6_BASE:1.6
	OPENBSD_2_5:1.6.0.10
	OPENBSD_2_5_BASE:1.6
	OPENBSD_2_4:1.6.0.8
	OPENBSD_2_4_BASE:1.6
	OPENBSD_2_3:1.6.0.6
	OPENBSD_2_3_BASE:1.6
	OPENBSD_2_2:1.6.0.4
	OPENBSD_2_2_BASE:1.6
	OPENBSD_2_1:1.6.0.2
	OPENBSD_2_1_BASE:1.6
	OPENBSD_2_0:1.4.0.2
	OPENBSD_2_0_BASE:1.4;
locks; strict;
comment	@# @;


1.12
date	2013.12.09.02.35.09;	author guenther;	state Exp;
branches;
next	1.11;

1.11
date	2013.08.06.19.11.53;	author miod;	state Exp;
branches;
next	1.10;

1.10
date	2010.05.10.18.20.31;	author drahn;	state Exp;
branches;
next	1.9;

1.9
date	2010.05.03.18.34.01;	author drahn;	state Exp;
branches;
next	1.8;

1.8
date	2004.02.10.02.02.22;	author espie;	state Exp;
branches;
next	1.7;

1.7
date	99.12.23.07.14.12;	author mickey;	state Exp;
branches;
next	1.6;

1.6
date	97.04.27.20.56.42;	author millert;	state Exp;
branches;
next	1.5;

1.5
date	96.12.08.14.32.21;	author downsj;	state Exp;
branches;
next	1.4;

1.4
date	96.08.26.21.25.22;	author niklas;	state Exp;
branches;
next	1.3;

1.3
date	96.06.26.05.32.24;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	96.01.04.01.50.33;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	96.01.02.13.49.07;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.12
log
@Use shell arrays to store arguments instead of building a string for eval.
Add option argument handling for all the options that take an argument.
Handle -I with separate path argument.
Retire gcc2-specific bits.
Handle -U__GNUC__ correctly on gcc4 systems.

ok jca@@ millert@@
@
text
@#	$OpenBSD: Makefile,v 1.11 2013/08/06 19:11:53 miod Exp $

.include <bsd.own.mk>

NOMAN=

PROG=cpp
SRCS=
INSTALL_STRIP=

cpp: cpp.sh
.if ${COMPILER_VERSION:L} == "gcc3"
	sed -e 's/@@GNUC@@/-D__GNUC__/' ${.CURDIR}/cpp.sh >$@@
.else
	sed -e 's/@@GNUC@@//' ${.CURDIR}/cpp.sh >$@@
.endif

.include <bsd.prog.mk>
@


1.11
log
@Remove support for COMPILER_VERSION == gcc2.
Change the logic depending upon COMPILER_VERSION everywhere, to assume gcc4
is the norm and to explicitely test for gcc3 when a different behaviour
is required.
No functional change intended. Be sure to `make install' in share/mk before
attempting to do anything.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.10 2010/05/10 18:20:31 drahn Exp $
d13 1
a13 1
	sed -e 's/@@GNUC@@/-D__GNUC__/' -e 's/@@dollaropt@@//' ${.CURDIR}/cpp.sh >$@@
d15 1
a15 1
	sed -e 's/@@GNUC@@//' -e 's/@@dollaropt@@//' ${.CURDIR}/cpp.sh >$@@
@


1.10
log
@Switch to using COMPILER_VERSION instead of USE_GCC3, allows for more flexible
complier picking, eg supporting gcc2, gcc3, and gcc4. based on diff by Marco,
with fixes from espie@@.
ok espie@@ general mumbling of approval of others.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.9 2010/05/03 18:34:01 drahn Exp $
d14 1
a14 1
.elif ${COMPILER_VERSION:L} == "gcc4"
a15 2
.else
	sed -e 's/@@GNUC@@/-D__GNUC__/' -e 's/@@dollaropt@@/-$$/' ${.CURDIR}/cpp.sh >$@@
@


1.9
log
@Support gcc4 with cpp (gcc4 binary to be installed in /usr/libexec/cpp).
ok kettenis@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.8 2004/02/10 02:02:22 espie Exp $
a9 2
USE_GCC3?="no"
USE_GCC4?="no"
d12 1
a12 1
.if ${USE_GCC3:L} == "yes"
d14 1
a14 1
.elif ${USE_GCC4:L} == "yes"
@


1.8
log
@Clean-up logic, support -$ on gcc2, nothing on gcc3.
Add -notraditional to help the transition into not -trad land.

ok deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.7 1999/12/23 07:14:12 mickey Exp $
d10 2
d14 4
a17 2
.if ${USE_GCC3:L} == "no"
	sed -e 's/@@dollaropt@@/-$$/' ${.CURDIR}/cpp.sh >$@@
d19 1
a19 1
	sed -e 's/@@dollaropt@@//' ${.CURDIR}/cpp.sh >$@@
@


1.7
log
@no need for obj dir at all; millert@@ ok
@
text
@d1 3
a3 1
#	$OpenBSD: Makefile,v 1.6 1997/04/27 20:56:42 millert Exp $
a5 1
NOOBJ=
d7 10
a16 3
beforeinstall:
	${INSTALL} ${INSTALL_COPY} -o ${BINOWN} -g ${BINGRP} -m ${BINMODE} \
		${.CURDIR}/cpp.sh ${DESTDIR}${BINDIR}/cpp
@


1.6
log
@COPY -> INSTALL_COPY and STRIP -> INSTALL_STRIP
This fixes namespace problems where STRIP is sometimes used as
the name of the strip(1) to use and other times used as
the flag to send install(1) when stripping (or not).
COPY doesn't have this problem (yet) but was poorly named.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.5 1996/12/08 14:32:21 downsj Exp $
d4 1
@


1.5
log
@install -> ${INSTALL}, -c -> ${COPY}
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.4 1996/08/26 21:25:22 niklas Exp $
d6 1
a6 1
	${INSTALL} ${COPY} -o ${BINOWN} -g ${BINGRP} -m ${BINMODE} \
@


1.4
log
@Our /usr/libexec/cpp link creation wasn't suitable for cross-builds
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.3 1996/06/26 05:32:24 deraadt Exp $
d6 1
a6 1
	install ${COPY} -o ${BINOWN} -g ${BINGRP} -m ${BINMODE} \
@


1.3
log
@rcsid
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.2 1996/01/04 01:50:33 deraadt Exp $
a7 4
	if [ `cc -print-libgcc-file-name` != /usr/lib/libgcc.a ]; then \
		(cd ${DESTDIR}/usr/libexec; rm -f cpp; \
		ln -s `cc -print-libgcc-file-name | sed -e 's/libgcc\.a/cpp/'` cpp); \
	fi
@


1.2
log
@create /usr/libexec/cpp as a symbolic link
@
text
@d1 1
a1 1
#	$Id: Makefile,v 1.1 1996/01/02 13:49:07 deraadt Exp $
@


1.1
log
@/usr/bin/cpp wrapper script (which now knows where to find the
correct path to GNU cpp through an incredibly twisted hack)
@
text
@d1 1
a1 1
#	$Id$
d8 4
@
