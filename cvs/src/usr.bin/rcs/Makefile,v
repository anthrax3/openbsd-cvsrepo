head	1.40;
access;
symbols
	OPENBSD_6_2:1.40.0.26
	OPENBSD_6_2_BASE:1.40
	OPENBSD_6_1:1.40.0.28
	OPENBSD_6_1_BASE:1.40
	OPENBSD_6_0:1.40.0.24
	OPENBSD_6_0_BASE:1.40
	OPENBSD_5_9:1.40.0.20
	OPENBSD_5_9_BASE:1.40
	OPENBSD_5_8:1.40.0.22
	OPENBSD_5_8_BASE:1.40
	OPENBSD_5_7:1.40.0.14
	OPENBSD_5_7_BASE:1.40
	OPENBSD_5_6:1.40.0.18
	OPENBSD_5_6_BASE:1.40
	OPENBSD_5_5:1.40.0.16
	OPENBSD_5_5_BASE:1.40
	OPENBSD_5_4:1.40.0.12
	OPENBSD_5_4_BASE:1.40
	OPENBSD_5_3:1.40.0.10
	OPENBSD_5_3_BASE:1.40
	OPENBSD_5_2:1.40.0.8
	OPENBSD_5_2_BASE:1.40
	OPENBSD_5_1_BASE:1.40
	OPENBSD_5_1:1.40.0.6
	OPENBSD_5_0:1.40.0.4
	OPENBSD_5_0_BASE:1.40
	OPENBSD_4_9:1.40.0.2
	OPENBSD_4_9_BASE:1.40
	OPENBSD_4_8:1.39.0.2
	OPENBSD_4_8_BASE:1.39
	OPENBSD_4_7:1.38.0.2
	OPENBSD_4_7_BASE:1.38
	OPENBSD_4_6:1.38.0.4
	OPENBSD_4_6_BASE:1.38
	OPENBSD_4_5:1.37.0.10
	OPENBSD_4_5_BASE:1.37
	OPENBSD_4_4:1.37.0.8
	OPENBSD_4_4_BASE:1.37
	OPENBSD_4_3:1.37.0.6
	OPENBSD_4_3_BASE:1.37
	OPENBSD_4_2:1.37.0.4
	OPENBSD_4_2_BASE:1.37
	OPENBSD_4_1:1.37.0.2
	OPENBSD_4_1_BASE:1.37
	OPENBSD_4_0:1.36.0.2
	OPENBSD_4_0_BASE:1.36
	OPENBSD_3_9:1.26.0.2
	OPENBSD_3_9_BASE:1.26
	OPENBSD_3_8:1.2.0.2
	OPENBSD_3_8_BASE:1.2;
locks; strict;
comment	@# @;


1.40
date	2010.10.15.08.44.12;	author tobias;	state Exp;
branches;
next	1.39;

1.39
date	2010.04.15.15.51.40;	author sobrado;	state Exp;
branches;
next	1.38;

1.38
date	2009.06.25.14.14.54;	author deraadt;	state Exp;
branches;
next	1.37;

1.37
date	2006.12.28.13.55.53;	author niallo;	state Exp;
branches;
next	1.36;

1.36
date	2006.05.15.07.00.14;	author xsa;	state Exp;
branches;
next	1.35;

1.35
date	2006.05.15.06.58.03;	author xsa;	state Exp;
branches;
next	1.34;

1.34
date	2006.04.27.07.59.33;	author xsa;	state Exp;
branches;
next	1.33;

1.33
date	2006.04.26.07.37.59;	author xsa;	state Exp;
branches;
next	1.32;

1.32
date	2006.04.26.02.55.13;	author joris;	state Exp;
branches;
next	1.31;

1.31
date	2006.04.21.17.17.29;	author xsa;	state Exp;
branches;
next	1.30;

1.30
date	2006.04.02.02.42.33;	author ray;	state Exp;
branches;
next	1.29;

1.29
date	2006.03.09.14.31.34;	author xsa;	state Exp;
branches;
next	1.28;

1.28
date	2006.03.08.20.19.39;	author joris;	state Exp;
branches;
next	1.27;

1.27
date	2006.03.07.11.19.08;	author jmc;	state Exp;
branches;
next	1.26;

1.26
date	2005.12.10.20.27.46;	author joris;	state Exp;
branches;
next	1.25;

1.25
date	2005.12.01.09.35.59;	author xsa;	state Exp;
branches;
next	1.24;

1.24
date	2005.11.12.21.34.48;	author niallo;	state Exp;
branches;
next	1.23;

1.23
date	2005.10.31.22.56.13;	author niallo;	state Exp;
branches;
next	1.22;

1.22
date	2005.10.26.07.02.59;	author xsa;	state Exp;
branches;
next	1.21;

1.21
date	2005.10.23.04.07.06;	author joris;	state Exp;
branches;
next	1.20;

1.20
date	2005.10.22.17.41.13;	author joris;	state Exp;
branches;
next	1.19;

1.19
date	2005.10.20.17.24.48;	author xsa;	state Exp;
branches;
next	1.18;

1.18
date	2005.10.18.16.20.31;	author xsa;	state Exp;
branches;
next	1.17;

1.17
date	2005.10.16.10.12.59;	author xsa;	state Exp;
branches;
next	1.16;

1.16
date	2005.10.15.20.38.01;	author joris;	state Exp;
branches;
next	1.15;

1.15
date	2005.10.15.20.06.07;	author niallo;	state Exp;
branches;
next	1.14;

1.14
date	2005.10.11.15.50.25;	author niallo;	state Exp;
branches;
next	1.13;

1.13
date	2005.10.06.16.26.43;	author mickey;	state Exp;
branches;
next	1.12;

1.12
date	2005.10.06.15.39.11;	author joris;	state Exp;
branches;
next	1.11;

1.11
date	2005.10.06.12.56.49;	author joris;	state Exp;
branches;
next	1.10;

1.10
date	2005.10.06.02.00.04;	author joris;	state Exp;
branches;
next	1.9;

1.9
date	2005.10.06.01.24.25;	author joris;	state Exp;
branches;
next	1.8;

1.8
date	2005.10.05.23.11.15;	author niallo;	state Exp;
branches;
next	1.7;

1.7
date	2005.10.03.01.45.33;	author joris;	state Exp;
branches;
next	1.6;

1.6
date	2005.10.02.20.32.19;	author joris;	state Exp;
branches;
next	1.5;

1.5
date	2005.09.30.16.37.27;	author niallo;	state Exp;
branches;
next	1.4;

1.4
date	2005.09.29.15.16.26;	author joris;	state Exp;
branches;
next	1.3;

1.3
date	2005.09.19.15.45.33;	author niallo;	state Exp;
branches;
next	1.2;

1.2
date	2005.04.15.16.15.34;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	2005.04.15.15.46.21;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.40
log
@Replaced RCS parser code with new rcsparse.{c,h}:
- be very strict about things we parse
- print more information about errors if they occur
- do not fatal() directly in parser, give caller a chance to react
- fix an rcs design issue when it comes to login names

tested by many on tech@@

ok xsa
@
text
@#	$OpenBSD: Makefile,v 1.39 2010/04/15 15:51:40 sobrado Exp $

PROG=	rcs
MAN=	ci.1 co.1 ident.1 merge.1 rcs.1 rcsclean.1 rcsdiff.1 rcsmerge.1 rlog.1

SRCS=	ci.c co.c ident.c merge.c rcsclean.c rcsdiff.c rcsmerge.c rcsparse.c \
	rcsprog.c rlog.c rcsutil.c buf.c date.y diff.c diff3.c rcs.c rcsnum.c \
	rcstime.c worklist.c xmalloc.c

LINKS=	${BINDIR}/rcs ${BINDIR}/ci ${BINDIR}/rcs ${BINDIR}/co \
	${BINDIR}/rcs ${BINDIR}/ident ${BINDIR}/rcs ${BINDIR}/merge \
	${BINDIR}/rcs ${BINDIR}/rcsclean ${BINDIR}/rcs ${BINDIR}/rcsdiff \
	${BINDIR}/rcs ${BINDIR}/rcsmerge ${BINDIR}/rcs ${BINDIR}/rlog

CPPFLAGS+=-I${.CURDIR}
CFLAGS+=-Wall
CFLAGS+=-Wstrict-prototypes -Wmissing-prototypes
CFLAGS+=-Wmissing-declarations
CFLAGS+=-Wshadow -Wpointer-arith -Wcast-qual
CFLAGS+=-Wsign-compare
YFLAGS=

.include <bsd.prog.mk>
@


1.39
log
@remove debugging information from the rcs binary; this saves 200K;
a similar change for OpenCVS would save 600K, but we choosed not
applying this one yet, as OpenCVS is under development.

ok xsa@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.38 2009/06/25 14:14:54 deraadt Exp $
d6 2
a7 2
SRCS=	ci.c co.c ident.c merge.c rcsclean.c rcsdiff.c rcsmerge.c rcsprog.c \
	rlog.c rcsutil.c buf.c date.y diff.c diff3.c rcs.c rcsnum.c \
@


1.38
log
@incorrect .PATH setting, discovered with nicm
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.37 2006/12/28 13:55:53 niallo Exp $
a20 1
DEBUG=	-g -ggdb
@


1.37
log
@- remove un-needed trailing backslash from LINKS declaration.

noticed by Igor Sobrado <igor at string1.ciencias.uniovi.es>
@
text
@d1 1
a1 3
#	$OpenBSD: Makefile,v 1.36 2006/05/15 07:00:14 xsa Exp $

.PATH: ${.CURDIR}/..
@


1.36
log
@oopps, missing \ at EOL.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.35 2006/05/15 06:58:03 xsa Exp $
d15 1
a15 1
	${BINDIR}/rcs ${BINDIR}/rcsmerge ${BINDIR}/rcs ${BINDIR}/rlog \
@


1.35
log
@missing bits for a working merge(1). Built and enabled.
OK joris@@ ray@@.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.34 2006/04/27 07:59:33 xsa Exp $
d13 1
a13 1
	${BINDIR}/rcs ${BINDIR}/ident ${BINDIR}/rcs ${BINDIR}/merge
@


1.34
log
@zap util.[ch] and move the content into rcsutil.[ch].
discussed with joris@@.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.33 2006/04/26 07:37:59 xsa Exp $
d6 1
a6 1
MAN=	ci.1 co.1 ident.1 rcs.1 rcsclean.1 rcsdiff.1 rcsmerge.1 rlog.1
d8 2
a9 2
SRCS=	ci.c co.c ident.c rcsclean.c rcsdiff.c rcsmerge.c rcsprog.c rlog.c \
	rcsutil.c buf.c date.y diff.c diff3.c rcs.c rcsnum.c \
d13 1
a15 1
	${BINDIR}/rcs ${BINDIR}/ident
@


1.33
log
@build again...
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.32 2006/04/26 02:55:13 joris Exp $
d10 1
a10 1
	rcstime.c util.c worklist.c xmalloc.c
@


1.32
log
@fork our code we shared between openrcs/cvs into the openrcs dir.

this was starting to become inhuman to maintain without
ugly ugly hacks in the shared code, and it will be easier
to make specific changes for openrcs without touching the
soon-to-be-replaced opencvs code.
@
text
@d1 3
a3 1
#	$OpenBSD: Makefile,v 1.31 2006/04/21 17:17:29 xsa Exp $
d17 1
@


1.31
log
@move shared functions into rcsutil.[ch]; this makes rcsprog.c cleaner;
"the voices in my head say OK!" joris@@.
@
text
@d1 1
a1 3
#	$OpenBSD: Makefile,v 1.30 2006/04/02 02:42:33 ray Exp $

.PATH:	${.CURDIR}/../cvs
d7 1
a7 1
	rcsutil.c buf.c date.y diff.c diff3.c fatal.c log.c rcs.c rcsnum.c \
a8 2

CPPFLAGS+=-I${.CURDIR}/../cvs -DRCSPROG
@


1.30
log
@Enable DEBUG=-g -ggdb for rcs, move -g -ggdb out of CFLAGS for cvs.
Line up flags while I'm at it.

OK to add DEBUG flags to rcs niallo@@.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.29 2006/03/09 14:31:34 xsa Exp $
d9 2
a10 2
	buf.c date.y diff.c diff3.c fatal.c log.c rcs.c rcsnum.c rcstime.c \
	util.c worklist.c xmalloc.c
@


1.29
log
@should have been part of previous commit (add rcstime.c here too).
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.28 2006/03/08 20:19:39 joris Exp $
d19 6
a24 5
CFLAGS+= -Wall
CFLAGS+= -Wstrict-prototypes -Wmissing-prototypes
CFLAGS+= -Wmissing-declarations
CFLAGS+= -Wshadow -Wpointer-arith -Wcast-qual
CFLAGS+= -Wsign-compare
@


1.28
log
@make openrcs use the worklist framework to keep track of temporary files
and remove them in case it gets interrupted.

suggested by deraadt@@, ok niallo@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.27 2006/03/07 11:19:08 jmc Exp $
d9 2
a10 2
	buf.c date.y diff.c diff3.c fatal.c log.c rcs.c rcsnum.c util.c \
	worklist.c xmalloc.c
@


1.27
log
@rcsintro.7 now merged into rcs.1;
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.26 2005/12/10 20:27:46 joris Exp $
d10 1
a10 1
	xmalloc.c
@


1.26
log
@switch to xmalloc stuff, me and xsa@@ agreed on this a long
time ago, but we were being held back by jfb. too bad for him.

next step is to use fatal() through out the code for unrecoverable
errors instead of trying to be all nice and fluffy and reach main() again.

ok niallo@@ and xsa@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.25 2005/12/01 09:35:59 xsa Exp $
d6 1
a6 2
MAN=	ci.1 co.1 ident.1 rcs.1 rcsclean.1 rcsdiff.1 rcsmerge.1 rlog.1 \
	rcsintro.7
@


1.25
log
@link rcsintro.7;
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.24 2005/11/12 21:34:48 niallo Exp $
d10 3
a12 1
	buf.c date.y diff.c diff3.c log.c rcs.c rcsnum.c util.c
@


1.24
log
@- remove strtab stuff. serves no useful purpose.

diff is from joris@@, committing on his behalf because his net connection
is very dodgy right now.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.23 2005/10/31 22:56:13 niallo Exp $
d6 2
a7 1
MAN=	ci.1 co.1 ident.1 rcs.1 rcsclean.1 rcsdiff.1 rcsmerge.1 rlog.1
@


1.23
log
@- remove MLINKS line, was commented out and is useless anyway.

pointed out by deraadt@@, ok joris@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.22 2005/10/26 07:02:59 xsa Exp $
d9 1
a9 1
	buf.c date.y diff.c diff3.c log.c rcs.c rcsnum.c strtab.c util.c
@


1.22
log
@install ident and rlog too; joris ok
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.21 2005/10/23 04:07:06 joris Exp $
a15 1
#MLINKS=	rcs.1 ci.1 rcs.1 co.1 rcs.1 rcsclean.1 rcs.1 rcsdiff.1
@


1.21
log
@with recent diff3 support, rcsmerge now works;
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.20 2005/10/22 17:41:13 joris Exp $
d14 2
a15 1
	${BINDIR}/rcs ${BINDIR}/rcsmerge
@


1.20
log
@need util.c for diff3
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.19 2005/10/20 17:24:48 xsa Exp $
d9 1
a9 1
	buf.c date.y diff.c log.c rcs.c rcsnum.c strtab.c util.c
d13 2
a14 1
	${BINDIR}/rcs ${BINDIR}/rcsclean ${BINDIR}/rcs ${BINDIR}/rcsdiff
@


1.19
log
@+YFLAGS=
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.18 2005/10/18 16:20:31 xsa Exp $
d9 1
a9 1
	buf.c date.y diff.c log.c rcs.c rcsnum.c strtab.c
@


1.18
log
@more rcsmerge(1) bits;
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.17 2005/10/16 10:12:59 xsa Exp $
d21 1
@


1.17
log
@remove obsolete comment;
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.16 2005/10/15 20:38:01 joris Exp $
d6 1
a6 1
MAN=	ci.1 co.1 ident.1 rcs.1 rcsclean.1 rcsdiff.1 rlog.1
d8 2
a9 2
SRCS=	ci.c co.c ident.c rcsclean.c rcsdiff.c rcsprog.c rlog.c buf.c date.y \
	diff.c log.c rcs.c rcsnum.c strtab.c
@


1.16
log
@install the rcs binaries correctly;
okay niallo@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.15 2005/10/15 20:06:07 niallo Exp $
a11 1
# Don't build the links until we actually support those commands
@


1.15
log
@we have manual pages for all the rcs tools now,
lets tell Makefile to generate them.

ok joris@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.14 2005/10/11 15:50:25 niallo Exp $
d13 2
a14 1
#LINKS=	${BINDIR}/ci ${BINDIR}/co ${BINDIR}/rcsclean ${BINDIR}/rcsdiff
@


1.14
log
@- support -d <date> option in ci.

ok joris@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.13 2005/10/06 16:26:43 mickey Exp $
d6 1
a6 1
MAN=	rcs.1
@


1.13
log
@put cpp opts into CPPFLAGS and add a future MLINKS; joris@@ ok
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.12 2005/10/06 15:39:11 joris Exp $
d8 2
a9 2
SRCS=	ci.c co.c ident.c rcsclean.c rcsdiff.c rcsprog.c rlog.c buf.c diff.c \
	log.c rcs.c rcsnum.c strtab.c
@


1.12
log
@ident command, written by xsa@@ but he is too busy with work right now;
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.11 2005/10/06 12:56:49 joris Exp $
d10 1
a10 1
CFLAGS+=-I${.CURDIR}/../cvs
d14 1
a20 1
CFLAGS+= -DRCSPROG
@


1.11
log
@support rlog command;
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.10 2005/10/06 02:00:04 joris Exp $
d8 1
a8 1
SRCS=	ci.c co.c rcsclean.c rcsdiff.c rcsprog.c rlog.c buf.c diff.c \
@


1.10
log
@rcsclean now works;
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.9 2005/10/06 01:24:25 joris Exp $
d8 1
a8 1
SRCS=	ci.c co.c rcsclean.c rcsdiff.c rcsprog.c buf.c diff.c \
@


1.9
log
@thanks to niallo's diff changes, we now can support rcsdiff;
only basic stuff works, more coming;
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.8 2005/10/05 23:11:15 niallo Exp $
d8 2
a9 1
SRCS=	ci.c co.c rcsdiff.c rcsprog.c buf.c diff.c log.c rcs.c rcsnum.c strtab.c
@


1.8
log
@- add a diff.h header file, corresponding to public functions in diff.c
  and some #defines
- include this header in rcs.c
- link rcs against diff.c

this allows us to use the existing diff work from opencvs within functions
in the rcs.c API and thus in rcs programs. paves the way for diff support
in usr.bin/rcs programs.

ok joris@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.7 2005/10/03 01:45:33 joris Exp $
d8 1
a8 1
SRCS=	ci.c co.c rcsprog.c buf.c diff.c log.c rcs.c rcsnum.c strtab.c
@


1.7
log
@revert rcs to rcsprog change,
requested by deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.6 2005/10/02 20:32:19 joris Exp $
d8 1
a8 1
SRCS=	ci.c co.c rcsprog.c buf.c log.c rcs.c rcsnum.c strtab.c
@


1.6
log
@change the name of the RCS tools binary to rcsprog instead of rcs to
avoid confusion with the rcs command itself.

ok xsa and niallo
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.5 2005/09/30 16:37:27 niallo Exp $
d5 1
a5 1
PROG=	rcsprog
@


1.5
log
@add a basic ci.c as a starting point. requires more changes to rcs api
to work properly.

ok joris@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.4 2005/09/29 15:16:26 joris Exp $
d5 1
a5 1
PROG=	rcs
@


1.4
log
@put it basic checkout code
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.3 2005/09/19 15:45:33 niallo Exp $
d8 1
a8 1
SRCS=	co.c rcsprog.c buf.c log.c rcs.c rcsnum.c strtab.c
@


1.3
log
@Add preprocessor directives needed for usr.bin/rcs programs to compile.

ok joris@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.2 2005/04/15 16:15:34 deraadt Exp $
d8 1
a8 1
SRCS=	rcsprog.c buf.c log.c rcs.c rcsnum.c strtab.c
@


1.2
log
@pick up BINDIR from above; ok joris
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.1 2005/04/15 15:46:21 deraadt Exp $
d19 1
@


1.1
log
@move rcs (and later on, clones of all the other rcs commands) out of the
cvs subdirectory; ok jfb joris
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.2 2005/04/06 18:51:29 joris Exp $
a9 2

BINDIR=	/usr/bin
@

