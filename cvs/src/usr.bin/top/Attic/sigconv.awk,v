head	1.6;
access;
symbols
	OPENBSD_4_0:1.5.0.10
	OPENBSD_4_0_BASE:1.5
	OPENBSD_3_9:1.5.0.8
	OPENBSD_3_9_BASE:1.5
	OPENBSD_3_8:1.5.0.6
	OPENBSD_3_8_BASE:1.5
	OPENBSD_3_7:1.5.0.4
	OPENBSD_3_7_BASE:1.5
	OPENBSD_3_6:1.5.0.2
	OPENBSD_3_6_BASE:1.5
	OPENBSD_3_5:1.4.0.4
	OPENBSD_3_5_BASE:1.4
	OPENBSD_3_4:1.4.0.2
	OPENBSD_3_4_BASE:1.4
	OPENBSD_3_3:1.3.0.4
	OPENBSD_3_3_BASE:1.3
	OPENBSD_3_2:1.3.0.2
	OPENBSD_3_2_BASE:1.3
	OPENBSD_3_1:1.2.0.20
	OPENBSD_3_1_BASE:1.2
	OPENBSD_3_0:1.2.0.18
	OPENBSD_3_0_BASE:1.2
	OPENBSD_2_9_BASE:1.2
	OPENBSD_2_9:1.2.0.16
	OPENBSD_2_8:1.2.0.14
	OPENBSD_2_8_BASE:1.2
	OPENBSD_2_7:1.2.0.12
	OPENBSD_2_7_BASE:1.2
	OPENBSD_2_6:1.2.0.10
	OPENBSD_2_6_BASE:1.2
	OPENBSD_2_5:1.2.0.8
	OPENBSD_2_5_BASE:1.2
	OPENBSD_2_4:1.2.0.6
	OPENBSD_2_4_BASE:1.2
	OPENBSD_2_3:1.2.0.4
	OPENBSD_2_3_BASE:1.2
	OPENBSD_2_2:1.2.0.2
	OPENBSD_2_2_BASE:1.2;
locks; strict;
comment	@# @;


1.6
date	2007.02.23.13.31.45;	author millert;	state dead;
branches;
next	1.5;

1.5
date	2004.05.09.22.14.15;	author deraadt;	state Exp;
branches;
next	1.4;

1.4
date	2003.06.18.08.42.31;	author deraadt;	state Exp;
branches;
next	1.3;

1.3
date	2002.07.15.17.20.36;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	97.08.17.01.02.00;	author downsj;	state Exp;
branches;
next	1.1;

1.1
date	97.08.14.14.00.25;	author downsj;	state Exp;
branches;
next	;


desc
@@


1.6
log
@Use sys_signame[] from libc instead of creating a top-specific
signame name to number table.  Also use strcasecmp() when matching
signal names for consistency with /bin/kill.
OK deraadt@@ henning@@ simon@@
@
text
@#
#  Top users/processes display for Unix
#  Version 3
#
# Copyright (c) 1984, 1989, William LeFebvre, Rice University
# Copyright (c) 1989, 1990, 1992, William LeFebvre, Northwestern University
#
# Redistribution and use in source and binary forms, with or without
# modification, are permitted provided that the following conditions
# are met:
# 1. Redistributions of source code must retain the above copyright
#    notice, this list of conditions and the following disclaimer.
# 2. Redistributions in binary form must reproduce the above copyright
#    notice, this list of conditions and the following disclaimer in the
#    documentation and/or other materials provided with the distribution.
#
# THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
# IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
# OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
# IN NO EVENT SHALL THE AUTHOR OR HIS EMPLOYER BE LIABLE FOR ANY DIRECT, INDIRECT,
# INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
# NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
# DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
# THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
# (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
# THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

BEGIN {
	nsig = 0;
	j = 0;
	print "/* This file was automatically generated */"
	print "/* by the awk script \"sigconv.awk\".      */"
	print "/* $OpenBSD: sigconv.awk,v 1.5 2004/05/09 22:14:15 deraadt Exp $ */\n"
	print "struct sigdesc {"
	print "	char	*name;"
	print "	int	number;"
	print "};\n"
	print "struct sigdesc sigdesc[] = {"
}

/^#define[ \t][ \t]*SIG[A-Z]/	{

	j = sprintf("%d", $3);
	str = $2;
	if (nsig < j)
		nsig = j;
	siglist[j] = sprintf("\"%s\",\t%2d", substr(str, 4), j);
}

/^#[ \t]*define[ \t][ \t]*SIG[A-Z]/	{

	j = sprintf("%d", $4);
	str = $3;
	if (nsig < j)
		nsig = j;
	siglist[j] = sprintf("\"%s\",\t%2d", substr(str, 4), j);
}

/^#[ \t]*define[ \t][ \t]*_SIG[A-Z]/	{

	j = sprintf("%d", $4);
	str = $3;
	if (nsig < j)
		nsig = j;

	siglist[j] = sprintf("\"%s\",\t%2d", substr(str, 5), j);
}

END {
	for (n = 1; n <= nsig; n++)
		if (siglist[n] != "")
			printf("	{ %s },\n", siglist[n]);

	printf("    { NULL,\t 0 }\n};\n");
}

@


1.5
log
@spaces
@
text
@d33 1
a33 1
	print "/* $OpenBSD: sigconv.awk,v 1.4 2003/06/18 08:42:31 deraadt Exp $ */\n"
@


1.4
log
@cleanup, and now it produces KNF output
@
text
@d32 2
a33 2
	print "/* by the awk script \"sigconv.awk\".      */"	
	print "/* $OpenBSD: sigconv.awk,v 1.3 2002/07/15 17:20:36 deraadt Exp $ */\n"
d45 1
a45 1
	if (nsig < j) 
d70 1
a70 1
	for (n = 1; n <= nsig; n++) 
@


1.3
log
@license change from William LeFebvre <wnl@@groupsys.com>; top is now BSD
licensed.  this same license will show up on his next release as well.
@
text
@d28 12
a39 12
BEGIN		{
		    nsig = 0;
		    j = 0;
		    print "/* This file was automatically generated */"
		    print "/* by the awk script \"sigconv.awk\".      */"	
		    print "/* $OpenBSD: sigconv.awk,v 1.2 1997/08/17 01:02:00 downsj Exp $ */\n"
		    print "struct sigdesc {"
		    print "    char *name;"
		    print "    int  number;"
		    print "};\n"
		    print "struct sigdesc sigdesc[] = {"
		}
d43 6
a48 2
				    j = sprintf("%d", $3);
				    str = $2;
a49 6
				    if (nsig < j) 
					nsig = j;

				    siglist[j] = sprintf("\"%s\",\t%2d", \
						substr(str, 4), j);
				}
d52 6
a57 5
				    j = sprintf("%d", $4);
				    str = $3;

				    if (nsig < j)
					nsig = j;
a58 3
				    siglist[j] = sprintf("\"%s\",\t%2d", \
						substr(str, 4), j);
				}
d61 12
a72 5
				    j = sprintf("%d", $4);
				    str = $3;

				    if (nsig < j)
					nsig = j;
d74 2
a75 8
				    siglist[j] = sprintf("\"%s\",\t%2d", \
					    substr(str, 5), j);
				}

END				{
				    for (n = 1; n <= nsig; n++) 
					if (siglist[n] != "")
					    printf("    { %s },\n", siglist[n]);
a76 2
				    printf("    { NULL,\t 0 }\n};\n");
				}
@


1.2
log
@some small fixes...
@
text
@d1 27
d33 1
a33 1
		    print "/* $OpenBSD$ */\n"
@


1.1
log
@top 3.4, with a few changes.  Still needs more work.
@
text
@d5 2
a6 1
		    print "/* by the awk script \"sigconv.awk\".      */\n"
d22 1
a22 1
				    siglist[j] = sprintf("\"%s\",\t%2d,", \
d33 1
a33 1
				    siglist[j] = sprintf("\"%s\",\t%2d,", \
d44 1
a44 1
				    siglist[j] = sprintf("\"%s\",\t%2d,", \
d51 1
a51 1
					    printf("    %s\n", siglist[n]);
d53 1
a53 1
				    printf("    NULL,\t 0\n};\n");
@
