head	1.49;
access;
symbols
	OPENBSD_6_1:1.49.0.4
	OPENBSD_6_1_BASE:1.49
	OPENBSD_6_0:1.48.0.2
	OPENBSD_6_0_BASE:1.48
	OPENBSD_5_9:1.47.0.2
	OPENBSD_5_9_BASE:1.47
	OPENBSD_5_8:1.46.0.4
	OPENBSD_5_8_BASE:1.46
	OPENBSD_5_7:1.45.0.2
	OPENBSD_5_7_BASE:1.45
	OPENBSD_5_6:1.45.0.4
	OPENBSD_5_6_BASE:1.45
	OPENBSD_5_5:1.42.0.4
	OPENBSD_5_5_BASE:1.42
	OPENBSD_5_4:1.40.0.8
	OPENBSD_5_4_BASE:1.40
	OPENBSD_5_3:1.40.0.6
	OPENBSD_5_3_BASE:1.40
	OPENBSD_5_2:1.40.0.4
	OPENBSD_5_2_BASE:1.40
	OPENBSD_5_1_BASE:1.40
	OPENBSD_5_1:1.40.0.2
	OPENBSD_5_0:1.39.0.2
	OPENBSD_5_0_BASE:1.39
	OPENBSD_4_9:1.38.0.10
	OPENBSD_4_9_BASE:1.38
	OPENBSD_4_8:1.38.0.8
	OPENBSD_4_8_BASE:1.38
	OPENBSD_4_7:1.38.0.4
	OPENBSD_4_7_BASE:1.38
	OPENBSD_4_6:1.38.0.6
	OPENBSD_4_6_BASE:1.38
	OPENBSD_4_5:1.38.0.2
	OPENBSD_4_5_BASE:1.38
	OPENBSD_4_4:1.37.0.4
	OPENBSD_4_4_BASE:1.37
	OPENBSD_4_3:1.37.0.2
	OPENBSD_4_3_BASE:1.37
	OPENBSD_4_2:1.35.0.2
	OPENBSD_4_2_BASE:1.35
	OPENBSD_4_1:1.34.0.2
	OPENBSD_4_1_BASE:1.34
	OPENBSD_4_0:1.21.0.10
	OPENBSD_4_0_BASE:1.21
	OPENBSD_3_9:1.21.0.8
	OPENBSD_3_9_BASE:1.21
	OPENBSD_3_8:1.21.0.6
	OPENBSD_3_8_BASE:1.21
	OPENBSD_3_7:1.21.0.4
	OPENBSD_3_7_BASE:1.21
	OPENBSD_3_6:1.21.0.2
	OPENBSD_3_6_BASE:1.21
	OPENBSD_3_5:1.19.0.4
	OPENBSD_3_5_BASE:1.19
	OPENBSD_3_4:1.19.0.2
	OPENBSD_3_4_BASE:1.19
	OPENBSD_3_3:1.15.0.2
	OPENBSD_3_3_BASE:1.15
	OPENBSD_3_2:1.14.0.2
	OPENBSD_3_2_BASE:1.14
	OPENBSD_3_1:1.12.0.10
	OPENBSD_3_1_BASE:1.12
	OPENBSD_3_0:1.12.0.8
	OPENBSD_3_0_BASE:1.12
	OPENBSD_2_9_BASE:1.12
	OPENBSD_2_9:1.12.0.6
	OPENBSD_2_8:1.12.0.4
	OPENBSD_2_8_BASE:1.12
	OPENBSD_2_7:1.12.0.2
	OPENBSD_2_7_BASE:1.12
	OPENBSD_2_6:1.9.0.2
	OPENBSD_2_6_BASE:1.9
	OPENBSD_2_5:1.7.0.4
	OPENBSD_2_5_BASE:1.7
	OPENBSD_2_4:1.7.0.2
	OPENBSD_2_4_BASE:1.7
	OPENBSD_2_3:1.5.0.4
	OPENBSD_2_3_BASE:1.5
	OPENBSD_2_2:1.5.0.2
	OPENBSD_2_2_BASE:1.5
	OPENBSD_2_1:1.4.0.4
	OPENBSD_2_1_BASE:1.4
	OPENBSD_2_0:1.4.0.2
	OPENBSD_2_0_BASE:1.4
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@.\" @;


1.49
date	2017.01.01.01.08.11;	author tb;	state Exp;
branches;
next	1.48;
commitid	wnNuSAo7K6MoaRxC;

1.48
date	2016.02.25.07.09.22;	author jmc;	state Exp;
branches;
next	1.47;
commitid	qHStJoTFF8ZmRi9H;

1.47
date	2015.11.30.17.03.05;	author jmc;	state Exp;
branches;
next	1.46;
commitid	34hNwlxcxhcYPM8K;

1.46
date	2015.07.27.17.28.39;	author sobrado;	state Exp;
branches;
next	1.45;
commitid	a73SHFfjDK7MTyGx;

1.45
date	2014.07.10.14.29.27;	author tedu;	state Exp;
branches;
next	1.44;
commitid	5Hj61xKwjGC4g5Vf;

1.44
date	2014.04.24.14.00.35;	author jmc;	state Exp;
branches;
next	1.43;

1.43
date	2014.04.19.18.11.19;	author tedu;	state Exp;
branches;
next	1.42;

1.42
date	2014.02.13.09.18.44;	author schwarze;	state Exp;
branches;
next	1.41;

1.41
date	2013.10.20.07.40.42;	author jmc;	state Exp;
branches;
next	1.40;

1.40
date	2011.09.03.22.59.07;	author jmc;	state Exp;
branches;
next	1.39;

1.39
date	2011.04.23.10.14.59;	author sobrado;	state Exp;
branches;
next	1.38;

1.38
date	2009.02.15.15.11.35;	author jmc;	state Exp;
branches;
next	1.37;

1.37
date	2008.02.11.07.58.28;	author jmc;	state Exp;
branches;
next	1.36;

1.36
date	2008.02.02.22.16.43;	author jmc;	state Exp;
branches;
next	1.35;

1.35
date	2007.05.31.19.20.15;	author jmc;	state Exp;
branches;
next	1.34;

1.34
date	2007.03.01.23.18.47;	author jmc;	state Exp;
branches;
next	1.33;

1.33
date	2007.03.01.23.01.18;	author jmc;	state Exp;
branches;
next	1.32;

1.32
date	2007.03.01.22.51.57;	author jmc;	state Exp;
branches;
next	1.31;

1.31
date	2007.03.01.22.36.25;	author jmc;	state Exp;
branches;
next	1.30;

1.30
date	2007.03.01.22.34.54;	author jmc;	state Exp;
branches;
next	1.29;

1.29
date	2007.02.27.08.08.40;	author jmc;	state Exp;
branches;
next	1.28;

1.28
date	2007.02.26.22.16.09;	author jmc;	state Exp;
branches;
next	1.27;

1.27
date	2007.02.26.22.06.36;	author jmc;	state Exp;
branches;
next	1.26;

1.26
date	2007.02.26.21.39.13;	author jmc;	state Exp;
branches;
next	1.25;

1.25
date	2007.02.26.16.39.23;	author jmc;	state Exp;
branches;
next	1.24;

1.24
date	2007.02.26.16.17.10;	author jmc;	state Exp;
branches;
next	1.23;

1.23
date	2007.02.26.15.53.12;	author jmc;	state Exp;
branches;
next	1.22;

1.22
date	2007.02.26.15.38.04;	author jmc;	state Exp;
branches;
next	1.21;

1.21
date	2004.07.13.23.18.10;	author jmc;	state Exp;
branches;
next	1.20;

1.20
date	2004.04.04.13.19.36;	author jmc;	state Exp;
branches;
next	1.19;

1.19
date	2003.06.10.09.12.11;	author jmc;	state Exp;
branches;
next	1.18;

1.18
date	2003.06.03.02.56.14;	author millert;	state Exp;
branches;
next	1.17;

1.17
date	2003.05.14.01.34.35;	author millert;	state Exp;
branches;
next	1.16;

1.16
date	2003.04.25.14.53.03;	author jmc;	state Exp;
branches;
next	1.15;

1.15
date	2003.01.15.15.05.36;	author deraadt;	state Exp;
branches;
next	1.14;

1.14
date	2002.05.10.02.01.32;	author millert;	state Exp;
branches;
next	1.13;

1.13
date	2002.05.09.19.19.33;	author millert;	state Exp;
branches;
next	1.12;

1.12
date	2000.03.14.21.31.41;	author aaron;	state Exp;
branches;
next	1.11;

1.11
date	2000.03.11.21.40.07;	author aaron;	state Exp;
branches;
next	1.10;

1.10
date	2000.03.04.22.19.26;	author aaron;	state Exp;
branches;
next	1.9;

1.9
date	99.06.05.04.16.04;	author aaron;	state Exp;
branches;
next	1.8;

1.8
date	99.06.05.01.21.37;	author aaron;	state Exp;
branches;
next	1.7;

1.7
date	98.07.24.20.49.04;	author deraadt;	state Exp;
branches;
next	1.6;

1.6
date	98.06.26.21.21.19;	author millert;	state Exp;
branches;
next	1.5;

1.5
date	97.07.22.06.59.39;	author millert;	state Exp;
branches;
next	1.4;

1.4
date	96.06.26.05.38.16;	author deraadt;	state Exp;
branches;
next	1.3;

1.3
date	96.03.05.03.16.10;	author dm;	state Exp;
branches;
next	1.2;

1.2
date	96.02.03.12.12.37;	author dm;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.45.59;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.45.59;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.49
log
@Hyphenate compound adjectives 'up-to-date', 'out-of-date' and 'well-known'
if they precede the noun and omit hyphens otherwise.

ok tj
@
text
@.\"	$OpenBSD: rdist.1,v 1.48 2016/02/25 07:09:22 jmc Exp $
.\"
.\" Copyright (c) 1983 Regents of the University of California.
.\" All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. Neither the name of the University nor the names of its contributors
.\"    may be used to endorse or promote products derived from this software
.\"    without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.\"	$From: rdist.man,v 6.34 1996/01/29 22:37:19 mcooper Exp $
.\"	@@(#)rdist.1	6.6 (Berkeley) 5/13/86
.\"
.Dd $Mdocdate: February 25 2016 $
.Dt RDIST 1
.Os
.Sh NAME
.Nm rdist
.Nd remote file distribution client program
.Sh SYNOPSIS
.Nm rdist
.Bk -words
.Op Fl DFnV
.Op Fl A Ar num
.Op Fl a Ar num
.Op Fl c Ar mini_distfile
.Op Fl d Ar var Ns = Ns Ar value
.Op Fl f Ar distfile
.Op Fl L Ar remote_logopts
.Op Fl l Ar local_logopts
.Op Fl M Ar maxproc
.Op Fl m Ar host
.Op Fl o Ar distopts
.Op Fl P Ar rsh-path
.Op Fl p Ar rdistd-path
.Op Fl t Ar timeout
.Op Ar name ...
.Ek
.Sh DESCRIPTION
.Nm
is a program to maintain identical copies of files over multiple hosts.
It preserves the owner, group, mode, and mtime of files if possible and
can update programs that are executing.
.Pp
.Nm
reads commands from
.Pa distfile
to direct the updating of files and/or directories.
If
.Pa distfile
is
.Sq - ,
the standard input is used.
If no
.Fl f
option is present, the program looks first for
.Pa distfile ,
then
.Pa Distfile ,
to use as the input.
If no names are specified on the command line,
.Nm
will update all of the files and directories listed in
.Pa distfile .
If the file
.Pa /etc/Distfile
exists,
it will be run automatically by the clock daemon
.Xr cron 8 ,
via the system script
.Xr daily 8 .
.Pp
If
.Ar name
is specified,
it is taken to be the name of a file to be updated
or the label of a command to execute.
If label and file names conflict, it is assumed to be a label.
These may be used together to update specific files using specific commands.
.Pp
.Nm
uses a remote shell command to access each target host.
By default,
.Xr ssh 1
is used unless overridden by the
.Fl P
option or the
.Ev RSH
environment variable.
If the target host is the string
.Dq localhost
and the remote user name is the same as the local user name,
.Nm
will run the command:
.Bd -literal -offset indent
/bin/sh -c rdistd -S
.Ed
.Pp
Otherwise,
.Nm
will run the command:
.Bd -literal -offset indent
ssh \*(Lthost\*(Gt -l \*(Ltlogin_name\*(Gt rdistd -S
.Ed
.Pp
.Ar host
is the name of the target host;
.Ar login_name
is the name of the user to make the connection as.
.Pp
On each target host
.Nm
will attempt to run the command:
.Bd -literal -offset indent
rdistd -S
.Ed
.Pp
Or if the
.Fl p
option was specified,
.Nm
will attempt to run the command:
.Bd -literal -offset indent
\*(Ltrdistd path\*(Gt -S
.Ed
.Pp
If no
.Fl p
option is specified, or
.Aq Ar rdistd path
is a simple filename,
.Xr rdistd 1
or
.Aq Ar rdistd path
must be somewhere in the
.Ev PATH
of the user running
.Nm
on the remote (target) host.
.Pp
The options are as follows:
.Bl -tag -width Ds
.It Fl A Ar num
Set the minimum number of free files (inodes) on a filesystem that must exist
for
.Nm
to update or install a file.
.It Fl a Ar num
Set the minimum amount of free space (in bytes) on a filesystem that must exist
for
.Nm
to update or install a file.
.It Fl c Ar mini_distfile
Forces
.Nm
to interpret the remaining arguments as a small distfile.
The format is:
.Bd -literal -offset indent
$ rdist -c name ... [login@@]host[:dest]
.Ed
.Pp
The equivalent distfile is as follows:
.Bd -literal -offset indent
(  name ... ) -\*(Gt [login@@]host
	install	[dest] ;
.Ed
.It Fl D
Enable copious debugging messages.
.It Xo
.Fl d Ar var Ns = Ns Ar value
.Xc
Define
.Ar var
to have
.Ar value .
This
option is used to define or override variable definitions in
.Pa distfile .
.Ar value
can be the empty string, one name, or a list of names surrounded by
parentheses and separated by tabs and/or spaces.
.It Fl F
Do not fork any child
.Nm
processes.
All clients are updated sequentially.
.It Fl f Ar distfile
Set the name of the distfile to
.Ar distfile .
If
.Sq -
(dash) is used then read from standard input (stdin).
.It Fl L Ar remote_logopts
Set remote logging options.
See the section
.Sx MESSAGE LOGGING
for details on the syntax for
.Ar remote_logopts .
.It Fl l Ar local_logopts
Set local logging options.
See the section
.Sx MESSAGE LOGGING
for details on the syntax for
.Ar local_logopts .
.It Fl M Ar maxproc
Set the maximum number of simultaneously running child
.Nm
processes to
.Ar maxproc .
The default is 4.
.It Fl m Ar host
Limit which machines are to be updated.
Multiple
.Fl m
arguments can be given to limit updates to a subset of the hosts listed in
.Pa distfile .
.It Fl n
Print the commands without executing them.
This option is useful for debugging a distfile.
.It Fl o Ar distopts
Specify the dist options to enable.
.Ar distopts
is a comma separated list of options which are listed below.
The valid values for
.Ar distopts
are:
.Bl -tag -width Ds
.It Ic chknfs
Do not check or update files on the target host
that reside on NFS filesystems.
.It Ic chkreadonly
Enable a check on the target host
to see if a file resides on a read-only filesystem.
If a file does, then no checking or updating of the file is attempted.
.It Ic chksym
If the target on the remote host is a symbolic link, but is not on the
master host, the remote target will be left a symbolic link.
This behavior is generally considered a bug in the original version of
.Nm rdist ,
but is present to allow compatibility with older versions.
.It Ic compare
Binary comparison.
Perform a binary comparison and update files if they differ rather than
comparing dates and sizes.
.It Ic defgroup Ns Op = Ns Ar groupname
If the group of a file to be transferred does not exist on the destination
host, use the specified group instead.
If
.Ar groupname
is not specified, the
.Em bin
group is used.
.It Ic defowner Ns Op = Ns Ar owner
If the owner of a file to be transferred does not exist on the destination
host, use the specified owner instead.
If
.Ar owner
is not specified, the user
.Em bin
is used.
.It Ic follow
Follow symbolic links.
Copy the file that the link points to rather than the link itself.
.It Ic history
When
.Ic savetargets
and
.Ic history
are both defined then the target file that is updated is first renamed from
.Pa file
to
.Pa file.NNN
where NNN increases for each generation update.
The first generation is 001, and the last is 999.
After 999 generations, the counter is reset and stuck to 001,
and 001 will get overwritten all the time.
This is undesirable behavior, so some other method needs to be devised
to clean up or limit the number of generations.
.It Ic ignlnks
Ignore unresolved links.
.Nm
will normally try to maintain the link structure of files being transferred
and warn the user if all the links cannot be found.
.It Ic nochkgroup
Do not check group ownership of files that already exist.
The file ownership is only set when the file is updated.
.It Ic nochkmode
Do not check file and directory permission modes.
The permission mode is only set when the file is updated.
.It Ic nochkowner
Do not check user ownership of files that already exist.
The file ownership is only set when the file is updated.
.It Ic nodescend
Do not descend into a directory.
Normally,
.Nm
will recursively check directories.
If this option is enabled, then any files listed in the file list in the
distfile that are directories are not recursively scanned.
Only the existence, ownership, and mode of the directory are checked.
.It Ic noexec
Automatically exclude executable binary files in
.Xr elf 5
format from being checked or updated.
.It Ic numchkgroup
Use the numeric group ID (GID) to check group ownership instead of
the group name.
.It Ic numchkowner
Use the numeric user ID (UID) to check user ownership instead of
the user name.
.It Ic quiet
Quiet mode.
Files that are being modified are normally printed on standard output.
This option suppresses that.
.It Ic remove
Remove extraneous files.
If a directory is being updated, any files that exist on the remote host
that do not exist in the master directory are removed.
This is useful for maintaining truly identical copies of directories.
.It Ic savetargets
Save files that are updated instead of removing them.
Any target file that is updated is first renamed from
.Pa file
to
.Pa file.OLD .
.It Ic sparse
Enable checking for sparse files.
One of the most common types of sparse files are those produced by
.Xr dbopen 3 .
This option adds some additional processing overhead so it should
only be enabled for targets likely to contain sparse files.
.It Ic updateperm
Do not send the whole file when the size and the modification time match.
Instead, just update the ownership, group, and permissions as necessary.
.It Ic verify
Verify that the files are up to date on all the hosts.
Any files that are out of date will be displayed
but no files will be changed and no mail will be sent.
.It Ic whole
Whole mode.
The whole file name is appended to the destination directory name.
Normally, only the last component of a name is used when renaming files.
This will preserve the directory structure of the files being
copied instead of flattening the directory structure.
For example, rdisting a list of files such as
.Pa /p/dir1/f1
and
.Pa /p/dir2/f2
to
.Pa /tmp/dir
would create files
.Pa /tmp/dir/p/dir1/f1
and
.Pa /tmp/dir/p/dir2/f2
instead of
.Pa /tmp/dir/dir1/f1
and
.Pa /tmp/dir/dir2/f2 .
.It Ic younger
Younger mode.
Files are normally updated if their
.Em mtime
and
.Em size
(see
.Xr stat 2 )
disagree.
This option causes
.Nm
not to update files that are younger than the master copy.
This can be used to prevent newer copies on other hosts from being replaced.
A warning message is printed for files which are newer than the master copy.
.El
.It Fl P Ar rsh-path
Set the path to the remote shell command.
.Ar rsh-path
may be a colon separated list of possible pathnames,
in which case the first component of the path to exist is used.
.It Fl p Ar rdistd-path
Set the path where the rdistd server is searched for on the target host.
.It Fl t Ar timeout
Set the timeout period,
in seconds,
for waiting for responses from the remote
.Nm
server.
The default is 900 seconds.
.It Fl V
Print version information and exit.
.El
.Sh DISTFILES
The
.Pa distfile
contains a sequence of entries that specify the files
to be copied, the destination hosts, and what operations to perform
to do the updating.
Each entry has one of the following formats.
.Bd -literal -offset indent
\*(Ltvariable name\*(Gt = \*(Ltname list\*(Gt
[ label: ] \*(Ltsource list\*(Gt -\*(Gt \*(Ltdestination list\*(Gt \*(Ltcommand list\*(Gt
[ label: ] \*(Ltsource list\*(Gt :: \*(Lttimestamp file\*(Gt \*(Ltcommand list\*(Gt
.Ed
.Pp
The first format is used for defining variables.
The second format is used for distributing files to other hosts.
The third format is used for making lists of files that have been changed
since some given date.
The
.Ar source list
specifies a list of files and/or directories on the local host which are to
be used as the master copy for distribution.
The
.Ar destination list
is the list of hosts to which these files are to be copied.
Each file in the source list is added to a list of changes if the file
is out of date on the host which is being updated (second format) or
the file is newer than the
.Ar timestamp file
(third format).
.Pp
Newlines, tabs, and blanks are only used as separators and are
otherwise ignored.
Comments begin with
.Sq #
and end with a newline.
.Pp
Variables to be expanded begin with
.Sq $
followed by one character or a name enclosed in curly braces
(see the examples at the end).
.Pp
Labels are optional.
They are used to identify a specific command to execute
(for example, allowing an update of a subset of a repository).
.Pp
The source and destination lists have the following format:
.Bd -literal -offset indent
\*(Ltname\*(Gt
.Ed
or
.Bd -literal -compact -offset indent
`(' \*(Ltzero or more names separated by whitespace\*(Gt `)'
.Ed
.Pp
These simple lists can be modified by using one level of set addition,
subtraction, or intersection like this:
.Pp
.Dl list - list
or
.Dl list + list
or
.Dl list & list
.Pp
If additional modifications are needed (e.g.\&
.Do
all servers and client machines except for the OSF/1 machines
.Dc )
then the list will have to be explicitly constructed in steps using
.Dq temporary
variables.
.Pp
The shell meta-characters `[', `]', `{', `}', `*', and `?'
are recognized and expanded (on the local host only) in the same way as
.Xr ksh 1 .
They can be escaped with a backslash.
The `~' character is also expanded in the same way as
.Xr ksh 1
but is expanded separately on the local and destination hosts.
When the
.Fl o Ar whole
option is used with a file name that begins with `~', everything except the
home directory is appended to the destination name.
File names which do not begin with `/' or `~' use the destination user's
home directory as the root directory for the rest of the file name.
.Pp
The command list consists of zero or more commands of the following
format:
.Bl -column "except_pat" "<pattern list>" "opt_dest_name" ";" -offset indent
.It install Ta \*(Ltoptions\*(Gt Ta opt_dest_name Ta ;
.It notify Ta \*(Ltname list\*(Gt Ta "" Ta ;
.It except Ta \*(Ltname list\*(Gt Ta "" Ta ;
.It except_pat Ta \*(Ltpattern list\*(Gt Ta "" Ta ;
.It special Ta \*(Ltname list\*(Gt Ta string Ta ;
.It cmdspecial Ta \*(Ltname list\*(Gt Ta string Ta ;
.El
.Pp
The
.Cm install
command is used to copy out-of-date files and/or directories.
Each source file is copied to each host in the destination list.
Directories are recursively copied in the same way.
.Ar opt_dest_name
is an optional parameter to rename files.
If no
.Cm install
command appears in the command list or the destination name is not specified,
the source file name is used.
Directories in the path name will be created if they
do not exist on the remote host.
The
.Fl o Ar distopts
option as specified above has the same semantics as
on the command line except
.Ar distopts
only applies to the files in the source list.
The login name used on the destination host is the same as the local host
unless the destination name is of the format
.Dq login@@host .
.Pp
The
.Cm notify
command is used to mail the list of files updated (and any errors
that may have occurred) to the listed names.
If no `@@' appears in the name, the destination host is appended to
the name
(e.g. name1@@host, name2@@host, ...).
.Pp
The
.Cm except
command is used to update all of the files in the source list
.Sy except
for the files listed in
.Ar name list .
This is usually used to copy everything in a directory except certain files.
.Pp
The
.Cm except_pat
command is like the
.Cm except
command except that
.Ar pattern list
is a list of basic regular expressions
(see
.Xr re_format 7
for details).
If one of the patterns matches some string within a file name, that file will
be ignored.
Note that since `\e' is a quote character, it must be doubled to become
part of the regular expression.
Variables are expanded in
.Ar pattern list
but not shell file pattern matching characters.
To include a `$', it must be escaped with `\e'.
.Pp
The
.Cm special
command is used to specify
.Xr sh 1
commands that are to be executed on the remote host after the file in
.Ar name list
is updated or installed.
If the
.Ar name list
is omitted then the shell commands will be executed for every file
updated or installed.
.Ar string
starts and ends with `"' and can cross multiple lines in
.Pa distfile .
Multiple commands to the shell should be separated by `;'.
Commands are executed in the user's home directory on the host
being updated.
The
.Cm special
command can be used, for example, to rebuild private databases
after a program has been updated.
The following environment variables are set for each
.Cm special
command:
.Pp
.Bl -tag -width "BASEFILE" -offset 3n -compact
.It Ev FILE
The full pathname of the local file that was just updated.
.It Ev REMFILE
The full pathname of the remote file that was just updated.
.It BASEFILE
The basename of the remote file that was just updated.
.El
.Pp
The
.Cm cmdspecial
command is similar to the
.Cm special
command, except it is executed only when the entire command is completed
instead of after each file is updated.
The list of files is placed in the
.Ev FILES
environment variable.
Each file name in
.Ev FILES
is separated by a
.Sq :\&
(colon).
.Pp
If a hostname ends in a
.Sq +
(plus sign),
then the plus
is stripped off and NFS checks are disabled.
This is equivalent to disabling the
.Fl o Ar chknfs
option just for this one host.
.Sh MESSAGE LOGGING
.Nm
uses a collection of predefined message
.Em facilities
that each contain a list of message
.Em types
specifying which types of messages to send to that facility.
The local client
and the remote server
each maintain their own copy
of what types of messages to log to what facilities.
.Pp
The
.Fl l
.Ar local_logopts
option specifies the logging options to use locally;
.Fl L
.Ar remote_logopts
specifies the logging options to pass to the remote server.
.Pp
Logging options should be of the form:
.Pp
.D1 facility=types:facility=types...
.Pp
The valid facility names are:
.Bl -tag -width Ds -offset indent
.It Ic file
Log to a file.
To specify the file name, use the format
.Dq file=filename=types .
For example:
.Pp
.Dl file=/tmp/rdist.log=all,debug
.It Ic notify
Use the internal
.Nm
.Ic notify
facility.
This facility is used in conjunction with the
.Ic notify
keyword in a
.Pa distfile
to specify what messages are mailed to the
.Ic notify
address.
.It Ic stdout
Messages to standard output.
.It Ic syslog
Use the
.Xr syslogd 8
facility.
.El
.Pp
.Ar types
should be a comma separated list of message types.
Each message type specified enables that message level.
This is unlike the
.Xr syslog 3
system facility which uses an ascending order scheme.
The following are the valid types:
.Bl -tag -width Ds -offset indent
.It Ic all
All but debug messages.
.It Ic change
Things that change.
This includes files that are installed or updated in some way.
.It Ic debug
Debugging information.
.It Ic ferror
Fatal errors.
.It Ic info
General information.
.It Ic nerror
Normal errors that are not fatal.
.It Ic notice
General info about things that change.
This includes things like making directories which are needed in order
to install a specific target, but which are not explicitly specified in the
.Pa distfile .
.It Ic warning
Warnings about errors which are not as serious as
.Ic nerror
type messages.
.El
.Pp
Here is a sample command line option:
.Bd -literal -offset indent
-l stdout=all:syslog=change,notice:file=/tmp/rdist.log=all
.Ed
.Pp
This entry will set local message logging to have all but debug
messages sent to standard output, change and notice messages will
be sent to
.Xr syslog 3 ,
and all messages will be written to the file
.Pa /tmp/rdist.log .
.Sh ENVIRONMENT
.Bl -tag -width "TMPDIR"
.It RSH
Name of the default remote shell program to use.
The default is
.Xr ssh 1 .
.It TMPDIR
Name of the temporary directory to use.
The default is
.Pa /tmp .
.El
.Sh FILES
.Bl -tag -width "$TMPDIR/rdist*XXX" -compact
.It Pa {d,D}istfile
.Nm
command file.
.It Pa /etc/Distfile
System-wide
.Nm
command file.
.It Pa $TMPDIR/rdist*
Temporary file for update lists.
.El
.Sh EXAMPLES
The following is an example
.Pa distfile :
.Bd -literal -offset indent
HOSTS = ( matisse root@@arpa)

FILES = ( /bin /lib /usr/bin /usr/games
	/usr/include/{*.h,{stand,sys,vax*,pascal,machine}/*.h}
	/usr/lib /usr/man/man? /usr/ucb /usr/local/rdist )

EXLIB = ( Mail.rc aliases aliases.db crontab dshrc
	sendmail.cf sendmail.hf sendmail.st uucp vfont )

${FILES} -\*(Gt ${HOSTS}
	install -oremove,chknfs ;
	except /usr/lib/${EXLIB} ;
	except /usr/games/lib ;
	special /usr/lib/sendmail "/usr/lib/sendmail -bi" ;

srcs:
/usr/src/bin -\*(Gt arpa
	except_pat ( \e\e.o\e$ /SCCS\e$ ) ;

IMAGEN = (ips dviimp catdvi)

imagen:
/usr/local/${IMAGEN} -\*(Gt arpa
	install /usr/local/lib ;
	notify ralph ;

sendmail.cf :: stamp.cory
	notify root@@cory ;
.Ed
.Pp
Using the above
.Pa distfile :
.Pp
Update everything that's out of date,
making any relevant notifications:
.Pp
.Dl $ rdist
.Pp
Update files in
.Pa /usr/src/bin
to host
.Dq arpa ,
except for files with names ending
.Dq .o
or
.Dq /SCCS :
.Pp
.Dl $ rdist srcs
.Pp
Update
.Pa sendmail.cf
if it's older than timestamp file
.Pa stamp.cory ,
notifying root@@cory if an update has happened:
.Pp
.Dl $ rdist sendmail.cf
.Sh SEE ALSO
.Xr rdistd 1 ,
.Xr sh 1 ,
.Xr ssh 1 ,
.Xr re_format 7 ,
.Xr daily 8 ,
.Xr syslogd 8
.Sh STANDARDS
The options
.Op Fl bhiNOqRrsvwxy
are still recognized for backwards compatibility.
.Sh CAVEATS
If the basename of a file
(the last component in the pathname)
is
.Sq .\& ,
.Nm
assumes the remote (destination) name is a directory.
That is,
.Pa /tmp/.\&
means that
.Pa /tmp
should be a directory on the remote host.
.Sh BUGS
Source files must reside on the local host where
.Nm
is executed.
.Pp
Variable expansion only works for name lists;
there should be a general macro facility.
.Pp
.Nm
aborts on files which have a negative mtime (before Jan 1, 1970).
.Pp
If a hardlinked file is listed more than once in the same target,
.Nm
will report missing links.
Only one instance of a link should be listed in each target.
.Pp
The
.Ic defowner ,
.Ic defgroup ,
and
.Ic updateperm
options are extensions to the 6.1.0 protocol and will not work with earlier
versions of rdist 6.
@


1.48
log
@remove extra word; from edgar pettijohn
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.47 2015/11/30 17:03:05 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate: November 30 2015 $
d508 1
a508 1
command is used to copy out of date files and/or directories.
@


1.47
log
@change Xrs from now-defunct db(3) to dbopen(3); this wasn;t a
straight replace: thanks both to schwarze and maja for feedback
on how to rewrite parts;

i've snuck in an rcs id->openbsd id change in dev_mkdb too;
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.46 2015/07/27 17:28:39 sobrado Exp $
d33 1
a33 1
.Dd $Mdocdate: July 27 2015 $
d120 1
a120 1
run will run the command:
@


1.46
log
@use file system path (.Pa) semantic markup macros where appropriate.

ok jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.45 2014/07/10 14:29:27 tedu Exp $
d33 1
a33 1
.Dd $Mdocdate: July 10 2014 $
d348 1
a348 1
.Xr db 3 .
@


1.45
log
@fleanse out oldrdist support
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.44 2014/04/24 14:00:35 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate: April 24 2014 $
d730 1
a730 1
.It {d,D}istfile
d733 1
a733 1
.It /etc/Distfile
d737 1
a737 1
.It $TMPDIR/rdist*
@


1.44
log
@simpler description for -P, avoiding the need to discuss rsh;
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.43 2014/04/19 18:11:19 tedu Exp $
d33 1
a33 1
.Dd $Mdocdate: April 19 2014 $
a42 1
.Op Fl Server
a399 14
.It Fl Server
This option is recognized to provide partial backward compatible support
for older versions of
.Nm
which used this option to put
.Nm
into server mode.
If
.Nm
is started with the
.Fl Server
command line option, it will attempt to exec (run) the old version of
.Nm rdist ,
.Pa /usr/bin/oldrdist .
@


1.43
log
@change some rsh references to ssh. poke by jmc
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.42 2014/02/13 09:18:44 schwarze Exp $
d33 1
a33 1
.Dd $Mdocdate: February 13 2014 $
d397 2
a398 6
may be a colon separated list of possible pathnames.
In this case, the first component of the path to exist is used.
For example,
.Pa /usr/bin/ssh:/usr/bin/rsh
or
.Pa /usr/bin/ssh .
@


1.42
log
@make .Ic markup consistent; from Jan Stary <hans at stare dot cz>
while here, mark up a argument placeholders as .Ar, not .Ic
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.41 2013/10/20 07:40:42 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate: October 20 2013 $
a820 1
.Xr rsh 1 ,
@


1.41
log
@catch up with elf(5)/stab(5) removal;
ok miod
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.40 2011/09/03 22:59:07 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate: September 3 2011 $
d265 1
a265 1
.It Ic defgroup Ns Op = Ns Ic groupname
d268 3
a270 1
If groupname is not specified, the
d273 1
a273 1
.It Ic defowner Ns Op = Ns Ic owner
d276 3
a278 1
If owner is not specified, the user
d860 2
a861 2
.Sy defowner ,
.Sy defgroup ,
d863 1
a863 1
.Sy updateperm
@


1.40
log
@make -column lists pretty again;

specifically, rewrite them to permit some markup in the column headers,
and use "Ta" instead of literal tabs; mandoc does not currently match groff
100%, but a mandoc fix may be some time off, and we've gone enough releases
with poorly formatting column lists.

in some cases i have rewritten the lists as -tag, where -column made
little sense.
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.39 2011/04/23 10:14:59 sobrado Exp $
d33 1
a33 1
.Dd $Mdocdate: April 23 2011 $
d318 1
a318 3
Automatically exclude executable binary files that are in
.Xr a.out 5
or
@


1.39
log
@improve line breaking in SYNOPSIS now that semantics of the .Bk macro
has changed to conform with modern groff releases.

diff for route6d(8) written mostly by schwarze@@, with lots of useful
advice from jmc@@.

ok jmc@@, schwarze@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.38 2009/02/15 15:11:35 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate: February 15 2009 $
d514 1
a514 1
.Bl -column "except_pat" "pattern listXX" "opt_dest_name" ";" -offset indent
@


1.38
log
@exmaple -> example;
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.37 2008/02/11 07:58:28 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate: February 11 2008 $
d47 1
a47 3
.Oo
.Fl d Ar var Ns = Ns Ar value
.Oc
@


1.37
log
@bump Mdocdate for pages committed in "febuary", necessary because
of a typo in rcs.c;
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.36 2008/02/02 22:16:43 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate$
d602 1
a602 1
command can be used, for exmaple, to rebuild private databases
@


1.36
log
@document daily(8)'s running of /etc/Distfile;
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.35 2007/05/31 19:20:15 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate: May 31 2007 $
@


1.35
log
@convert to new .Dd format;
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.34 2007/03/01 23:18:47 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate$
d66 1
d87 12
a98 1
Otherwise, the argument is taken to be the name of a file to be updated
d748 1
a748 1
.Bl -tag -width "$TMPDIR/rdist*" -compact
d752 4
d825 1
@


1.34
log
@annotate EXAMPLES;
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.33 2007/03/01 23:01:18 jmc Exp $
d33 1
a33 1
.Dd May 9, 2002
@


1.33
log
@minor cleanup for the rest of this page;
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.32 2007/03/01 22:51:57 jmc Exp $
d744 2
d773 1
a773 1
${FILES} :: stamp.cory
d776 27
@


1.32
log
@tidy up the MESSAGE LOGGING section;
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.31 2007/03/01 22:36:25 jmc Exp $
a725 4
.It TMPDIR
Name of temporary directory to use.
Default is
.Pa /tmp .
d728 1
a728 1
Default is
d730 4
d737 3
a739 2
.It distfile
input command file
d741 1
a741 1
temporary file for update lists
d775 1
a775 1
.Xr csh 1 ,
d779 2
a780 2
.Xr stat 2 ,
.Xr rcmdsh 3
d786 4
a789 1
If the basename of a file  (the last component in the pathname) is ".", then
d793 1
a793 1
.Pa /tmp/ .
d798 3
a800 1
Source files must reside on the local host where rdist is executed.
d802 2
a803 2
Variable expansion only works for name lists; there should be a general macro
facility.
a808 1
then
@


1.31
log
@missed a comma;
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.30 2007/03/01 22:34:54 jmc Exp $
d633 2
a634 3
.Sy types
specifying which types of messages to send to that
.Em facility .
a635 1
.Pq Nm rdist
a636 1
.Pq Xr rdistd 1
d643 1
a643 6
option to
.Nm
tells
.Nm
what logging options to use locally.
The
d646 1
a646 7
option to
.Nm
tells
.Nm
what logging options to pass to the remote
.Em rdistd
server.
d648 1
a648 2
.Em logopts
should be of the form:
d653 1
a653 3
.Bl -tag -width Ds
.It Ic stdout
Messages to standard output.
a660 4
.It Ic syslog
Use the
.Xr syslogd 8
facility.
d673 6
d681 1
a681 1
.Em types
d687 4
a690 3
The following are the valid
.Em types :
.Bl -tag -width Ds
d694 4
d700 2
a706 4
.It Ic nerror
Normal errors that are not fatal.
.It Ic ferror
Fatal errors.
a710 4
.It Ic debug
Debugging information.
.It Ic all
All but debug messages.
@


1.30
log
@some small improvements for the DISTFILES section;
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.29 2007/02/27 08:08:40 jmc Exp $
d503 1
a503 1
format.
@


1.29
log
@some clarifications for the history, noexec, and sparse options;
help/ok otto
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.28 2007/02/26 22:16:09 jmc Exp $
d425 3
a427 3
\*(Ltvariable name\*(Gt `=' \*(Ltname list\*(Gt
[ label: ] \*(Ltsource list\*(Gt `\-\*(Gt' \*(Ltdestination list\*(Gt \*(Ltcommand list\*(Gt
[ label: ] \*(Ltsource list\*(Gt `::' \*(Lttime_stamp file\*(Gt \*(Ltcommand list\*(Gt
d435 1
a435 1
.Em source list
d439 1
a439 1
.Em destination list
d443 3
a445 4
the file is newer than the time stamp file (third format).
.Pp
Labels are optional.
They are used to identify a command for partial updates.
d458 4
d473 2
a474 3
.Bd -literal -offset indent
list '-' list
.Ed
d476 1
a476 3
.Bd -literal -compact -offset indent
list '+' list
.Ed
d478 1
a478 3
.Bd -literal -compact -offset indent
list '&' list
.Ed
d490 1
a490 1
.Xr csh 1 .
d493 1
a493 1
.Xr csh 1
d496 1
a496 1
.Fl o Ns Ar whole
d505 6
a510 6
.It `install' Ta \*(Ltoptions\*(Gt Ta opt_dest_name Ta `;'
.It `notify' Ta \*(Ltname list\*(Gt Ta "" Ta `;'
.It `except' Ta \*(Ltname list\*(Gt Ta "" Ta `;'
.It `except_pat' Ta \*(Ltpattern list\*(Gt Ta "" Ta `;'
.It `special' Ta \*(Ltname list\*(Gt Ta string Ta `;'
.It `cmdspecial' Ta \*(Ltname list\*(Gt Ta string Ta `;'
d514 1
a514 1
.Em install
d518 1
a518 1
.Em opt_dest_name
d521 1
a521 1
.Em install
d527 1
a527 1
.Fl o Ns Ar distopts
d531 1
a531 1
only apply to the files in the source list.
d537 1
a537 1
.Em notify
d545 1
a545 1
.Em except
d549 1
a549 1
.Em name list .
d553 1
a553 1
.Em except_pat
d555 1
a555 1
.Em except
d557 2
a558 2
.Em pattern list
is a list of regular expressions
d560 1
a560 1
.Xr ed 1
d567 1
a567 1
.Em pattern list
d572 1
a572 1
.Em special
d576 1
a576 1
.Em name list
d579 1
a579 1
.Em name list
d582 1
a582 1
.Em string
d589 2
a590 2
.Em special
command can be used to rebuild private databases, etc.
d593 1
a593 1
.Em special
d595 2
a596 1
.Bl -tag -width "BASEFILE"
d606 1
a606 1
.Em cmdspecial
d608 1
a608 1
.Em special
d616 8
a623 3
is separated by a `:' (colon).
.Pp
If a hostname ends in a `+' (plus sign), then the plus
d626 1
a626 1
.Fl o Ns Ar chknfs
@


1.28
log
@oops, somehow i managed to comment out an entire list;
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.27 2007/02/26 22:06:36 jmc Exp $
d281 2
a282 2
After 999 generations, the counter is reset to 001 and 001 will get
overwritten all the time.
d308 1
a308 1
Automatically exclude executable files that are in
d310 2
d335 1
a335 3
Enable checking for sparse (aka
.Dq wholely )
files.
@


1.27
log
@show how -c works;
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.26 2007/02/26 21:39:13 jmc Exp $
d507 6
a512 6
.\" .It `install' Ta \*(Ltoptions\*(Gt Ta opt_dest_name Ta `;'
.\" .It `notify' Ta \*(Ltname list\*(Gt Ta "" Ta `;'
.\" .It `except' Ta \*(Ltname list\*(Gt Ta "" Ta `;'
.\" .It `except_pat' Ta \*(Ltpattern list\*(Gt Ta "" Ta `;'
.\" .It `special' Ta \*(Ltname list\*(Gt Ta string Ta `;'
.\" .It `cmdspecial' Ta \*(Ltname list\*(Gt Ta string Ta `;'
@


1.26
log
@clean up the options description list;
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.25 2007/02/26 16:39:23 jmc Exp $
d166 7
a172 3
to interpret the remaining arguments as a small
.Pa distfile .
The equivalent distfile is as follows.
@


1.25
log
@tidy up DESCRIPTION;
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.24 2007/02/26 16:17:10 jmc Exp $
d183 1
a183 1
option is used to define or override variable definitions in the
d194 1
a194 1
Set the name of the distfile to use to be
d197 2
a198 4
.Ar distfile
is specified as
.Dq -
(dash) then read from standard input (stdin).
a200 4
.Ar logopts
is the same as for local logging except the values are passed to the remote
server,
.Xr rdistd 1 .
d202 1
a202 1
.Sy MESSAGE LOGGING
d204 1
a204 1
.Ar logopts .
d208 1
a208 1
.Sy MESSAGE LOGGING
d210 1
a210 1
.Ar logopts .
d221 1
a221 1
arguments can be given to limit updates to a subset of the hosts listed in the
d225 1
a225 2
This option is useful for debugging a
.Pa distfile .
d235 2
a236 1
Do not check or update files on target host that reside on NFS filesystems.
d238 2
a239 1
Enable check on target host to see if a file resides on a read-only filesystem.
d341 2
a342 2
Any files that are out of date will be displayed but no files will be
changed nor will any mail be sent.
d350 1
a350 1
.Pa /path/dir1/f1
d352 1
a352 1
.Pa /path/dir2/f2
d356 1
a356 1
.Pa /tmp/dir/path/dir1/f1
d358 1
a358 1
.Pa /tmp/dir/path/dir2/f2
a379 1
The
d384 2
a385 1
.Pa "/usr/bin/ssh:/usr/bin/rsh" ,
d404 3
a406 1
Set the timeout period (in seconds) for waiting for responses from the remote
@


1.24
log
@cleanup:
- remove old style groff escapes
- use mdoc escapes
- some macro cleanup
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.23 2007/02/26 15:53:12 jmc Exp $
d80 1
a80 1
.Pa Distfile
d95 1
a95 1
is used, unless overridden by the
d101 1
a101 1
.Em localhost
d113 1
a113 1
ssh host -l remuser rdistd -S
d116 4
a119 7
where
.Em host
is the name of the target host,
.Em remuser
is the name of the user to make the connection as, and
.Em rdistd
is the rdist server command on the target host as shown below.
d123 1
a123 1
will attempt to run the command
d127 7
a133 2
or
.Bd -literal -compact -offset indent
a136 3
if the
.Fl p
option was specified.
d139 1
a139 1
option is included, or the
@


1.23
log
@add STANDARDS, EXAMPLES, and CAVEATS sections;
rearrange text somewhat;
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.22 2007/02/26 15:38:04 jmc Exp $
d104 1
a104 1
will run the command
d111 1
a111 1
run will run the command
d113 1
a113 1
\fBssh \fIhost\fB -l \fIremuser \fBrdistd -S\fR
a129 1
.Pp
d131 2
a132 2
.Bd -literal -offset indent
<rdistd path> -S
d141 1
a141 1
.Ar <rdistd path>
d143 1
a143 1
.Em rdistd
d145 1
a145 1
.Em <rdistd path>
d171 2
a172 2
( \fIname\fP ... ) -> [\fIlogin\fP@@]\fIhost\fP
	install	[\fIdest\fP] ;
d206 2
a207 1
server (\fIrdistd\fR).
d390 1
a390 1
e.g.,
d425 3
a427 3
<variable name> `=' <name list>
[ label: ] <source list> `\->' <destination list> <command list>
[ label: ] <source list> `::' <time_stamp file> <command list>
d461 1
a461 1
<name>
d465 1
a465 1
`(' <zero or more names separated by whitespace> `)'
d482 1
a482 1
If additional modifications are needed (e.g.,
d506 7
a512 7
.Bl -column "except_pat" "<pattern list>" "opt_dest_name" ";" -offset indent
.It `install' Ta <options> Ta opt_dest_name Ta `;'
.It `notify' Ta <name list> Ta "" Ta `;'
.It `except' Ta <name list> Ta "" Ta `;'
.It `except_pat' Ta <pattern list> Ta "" Ta `;'
.It `special' Ta <name list> Ta string Ta `;'
.It `cmdspecial' Ta <name list> Ta string Ta `;'
d544 1
a544 1
(e.g., name1@@host, name2@@host, ...).
d632 6
a637 2
The local client (\fIrdist\fR) and the remote server (\fIrdistd\fR) each
maintain their own copy of what types of messages to log to what facilities.
d641 1
a641 1
.Em logopts
d649 1
a649 1
.Em logopts
d659 3
a661 4
should be of the form
.Bd -literal -offset indent
\fIfacility\fB=\fItypes\fB:\fIfacility\fB=\fItypes...
.Ed
d665 1
a665 1
.It Sy stdout
d667 1
a667 1
.It Sy file
d670 5
a674 4
.Dq \fBfile=\fIfilename\fB=\fItypes\fR .
e.g.,
.Dq \fBfile=\fI/tmp/rdist.log\fB=\fIall,debug\fR .
.It Sy syslog
d678 1
a678 1
.It Sy notify
d681 1
a681 1
.Sy notify
d684 1
a684 1
.Sy notify
d688 1
a688 1
.Sy notify
d701 1
a701 1
.It Sy change
d704 1
a704 1
.It Sy info
d706 1
a706 1
.It Sy notice
d711 1
a711 1
.It Sy nerror
d713 1
a713 1
.It Sy ferror
d715 1
a715 1
.It Sy warning
d717 1
a717 1
.Sy nerror
d719 1
a719 1
.It Sy debug
d721 1
a721 1
.It Sy all
d765 1
a765 1
${FILES} -> ${HOSTS}
d772 1
a772 1
/usr/src/bin -> arpa
d778 1
a778 1
/usr/local/${IMAGEN} -> arpa
d800 1
a800 1
i.e.,
@


1.22
log
@- one synopis
- sort options
- sync usage()
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.21 2004/07/13 23:18:10 jmc Exp $
a416 108
.Sh MESSAGE LOGGING
.Nm
uses a collection of predefined message
.Em facilities
that each contain a list of message
.Sy types
specifying which types of messages to send to that
.Em facility .
The local client (\fIrdist\fR) and the remote server (\fIrdistd\fR) each
maintain their own copy of what types of messages to log to what facilities.
.Pp
The
.Fl l
.Em logopts
option to
.Nm
tells
.Nm
what logging options to use locally.
The
.Fl L
.Em logopts
option to
.Nm
tells
.Nm
what logging options to pass to the remote
.Em rdistd
server.
.Pp
.Em logopts
should be of the form
.Bd -literal -offset indent
\fIfacility\fB=\fItypes\fB:\fIfacility\fB=\fItypes...
.Ed
.Pp
The valid facility names are:
.Bl -tag -width Ds
.It Sy stdout
Messages to standard output.
.It Sy file
Log to a file.
To specify the file name, use the format
.Dq \fBfile=\fIfilename\fB=\fItypes\fR .
e.g.,
.Dq \fBfile=\fI/tmp/rdist.log\fB=\fIall,debug\fR .
.It Sy syslog
Use the
.Xr syslogd 8
facility.
.It Sy notify
Use the internal
.Nm
.Sy notify
facility.
This facility is used in conjunction with the
.Sy notify
keyword in a
.Pa distfile
to specify what messages are mailed to the
.Sy notify
address.
.El
.Pp
.Em types
should be a comma separated list of message types.
Each message type specified enables that message level.
This is unlike the
.Xr syslog 3
system facility which uses an ascending order scheme.
The following are the valid
.Em types :
.Bl -tag -width Ds
.It Sy change
Things that change.
This includes files that are installed or updated in some way.
.It Sy info
General information.
.It Sy notice
General info about things that change.
This includes things like making directories which are needed in order
to install a specific target, but which are not explicitly specified in the
.Pa distfile .
.It Sy nerror
Normal errors that are not fatal.
.It Sy ferror
Fatal errors.
.It Sy warning
Warnings about errors which are not as serious as
.Sy nerror
type messages.
.It Sy debug
Debugging information.
.It Sy all
All but debug messages.
.El
.Pp
Here is a sample command line option:
.Bd -literal -offset indent
-l stdout=all:syslog=change,notice:file=/tmp/rdist.log=all
.Ed
.Pp
This entry will set local message logging to have all but debug
messages sent to standard output, change and notice messages will
be sent to
.Xr syslog 3 ,
and all messages will be written to the file
.Pa /tmp/rdist.log .
d624 29
d654 97
a750 1
The following is a small example.
a780 18
.Sh ENVIRONMENT
.Bl -tag -width "TMPDIR"
.It TMPDIR
Name of temporary directory to use.
Default is
.Pa /tmp .
.It RSH
Name of the default remote shell program to use.
Default is
.Xr ssh 1 .
.El
.Sh FILES
.Bl -tag -width "$TMPDIR/rdist*" -compact
.It distfile
input command file
.It $TMPDIR/rdist*
temporary file for update lists
.El
d788 5
a792 1
.Sh NOTES
a800 18
.Pp
The following options are still recognized for backwards compatibility:
.Pp
.Bd -filled -offset indent
.Fl v
.Fl N
.Fl O
.Fl q
.Fl b
.Fl r
.Fl R
.Fl s
.Fl w
.Fl y
.Fl h
.Fl i
.Fl x
.Ed
@


1.21
log
@bad macro here too: .I -> .Ar
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.20 2004/04/04 13:19:36 jmc Exp $
d42 2
a43 1
.Op Fl DFn
d46 4
a49 3
.Op Fl d Ar var=value
.Op Fl l Ar <local logopts>
.Op Fl L Ar <remote logopts>
d51 2
d56 2
a58 2
.Op Fl p Ar <rdistd-path>
.Op Fl P Ar <rsh-path>
a60 11
.Pp
.Nm rdist
.Fl DFn
.Fl c Ar name ...
.Ar [login@@]host[:dest]
.Pp
.Nm rdist
.Fl Server
.Pp
.Nm rdist
.Fl V
a90 28
The
.Fl c
option forces
.Nm
to interpret the remaining arguments as a small
.Pa distfile .
The equivalent distfile is as follows.
.Bd -literal -offset indent
( \fIname\fP ... ) -> [\fIlogin\fP@@]\fIhost\fP
	install	[\fIdest\fP] ;
.Ed
.Pp
The
.Fl Server
option is recognized to provide partial backward compatible support
for older versions of
.Nm
which used this option to put
.Nm
into server mode.
If
.Nm
is started with the
.Fl Server
command line option, it will attempt to exec (run) the old version of
.Nm rdist ,
.Pa /usr/bin/oldrdist .
.Pp
d165 10
d177 3
a179 1
.It Fl d Ar var=value
d203 5
a207 2
.It Fl l Ar logopts
Set local logging options.
d212 2
a213 5
.It Fl L Ar logopts
Set remote logging options.
.Ar logopts
is the same as for local logging except the values are passed to the remote
server (\fIrdistd\fR).
d218 1
a218 1
.It Fl M Ar num
d222 1
a222 1
.Ar num .
d224 1
a224 1
.It Fl m Ar machine
d234 1
a234 1
.It Fl o Ns Ar distopts
d242 1
a242 55
.It Sy verify
Verify that the files are up to date on all the hosts.
Any files that are out of date will be displayed but no files will be
changed nor will any mail be sent.
.It Sy whole
Whole mode.
The whole file name is appended to the destination directory name.
Normally, only the last component of a name is used when renaming files.
This will preserve the directory structure of the files being
copied instead of flattening the directory structure.
For example, rdisting a list of files such as
.Pa /path/dir1/f1
and
.Pa /path/dir2/f2
to
.Pa /tmp/dir
would create files
.Pa /tmp/dir/path/dir1/f1
and
.Pa /tmp/dir/path/dir2/f2
instead of
.Pa /tmp/dir/dir1/f1
and
.Pa /tmp/dir/dir2/f2 .
.It Sy noexec
Automatically exclude executable files that are in
.Xr a.out 5
format from being checked or updated.
.It Sy younger
Younger mode.
Files are normally updated if their
.Em mtime
and
.Em size
(see
.Xr stat 2 )
disagree.
This option causes
.Nm
not to update files that are younger than the master copy.
This can be used to prevent newer copies on other hosts from being replaced.
A warning message is printed for files which are newer than the master copy.
.It Sy compare
Binary comparison.
Perform a binary comparison and update files if they differ rather than
comparing dates and sizes.
.It Sy follow
Follow symbolic links.
Copy the file that the link points to rather than the link itself.
.It Sy ignlnks
Ignore unresolved links.
.Nm
will normally try to maintain the link structure of files being transferred
and warn the user if all the links cannot be found.
.It Sy chknfs
d244 1
a244 1
.It Sy chkreadonly
d247 1
a247 1
.It Sy chksym
d253 5
a257 1
.It Sy defgroup[=groupname]
d263 1
a263 1
.It Sy defowner[=owner]
d269 24
a292 16
.It Sy updateperm
Do not send the whole file when the size and the modification time match.
Instead, just update the ownership, group, and permissions as necessary.
.It Sy quiet
Quiet mode.
Files that are being modified are normally printed on standard output.
This option suppresses that.
.It Sy remove
Remove extraneous files.
If a directory is being updated, any files that exist on the remote host
that do not exist in the master directory are removed.
This is useful for maintaining truly identical copies of directories.
.It Sy nochkowner
Do not check user ownership of files that already exist.
The file ownership is only set when the file is updated.
.It Sy nochkgroup
d295 1
a295 1
.It Sy nochkmode
d298 4
a301 1
.It Sy nodescend
d309 5
a313 1
.It Sy numchkgroup
d316 1
a316 1
.It Sy numchkowner
d319 10
a328 1
.It Sy savetargets
d334 1
a334 16
.It Sy history
When
.Sy savetargets
and
.Sy history
are both defined then the target file that is updated is first renamed from
.Pa file
to
.Pa file.NNN
where NNN increases for each generation update.
The first generation is 001, and the last is 999.
After 999 generations, the counter is reset to 001 and 001 will get
overwritten all the time.
This is undesirable behavior, so some other method needs to be devised
to clean up or limit the number of generations.
.It Sy sparse
d342 41
d384 1
a384 3
.It Fl p Ar <rdistd-path>
Set the path where the rdistd server is searched for on the target host.
.It Fl P Ar <rsh-path>
d393 16
@


1.20
log
@.br workaround no longer necessary;
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.19 2003/06/10 09:12:11 jmc Exp $
d412 1
a412 1
.I rsh-path
@


1.19
log
@- section reorder
- COMPATIBILITY merge
- macro cleanup
- kill whitespace at EOL
- new sentence, new line

ssh pages ok markus@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.18 2003/06/03 02:56:14 millert Exp $
a688 1
.br
@


1.18
log
@Remove the advertising clause in the UCB license which Berkeley
rescinded 22 July 1999.  Proofed by myself and Theo.
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.17 2003/05/14 01:34:35 millert Exp $
d248 2
a249 1
Limit which machines are to be updated. Multiple
d497 1
a497 1
.Em types:
d508 1
a508 1
.Pa distfile.
d539 2
a540 1
to do the updating. Each entry has one of the following formats.
d704 1
a704 1
.Pa distfile.
d779 1
a779 1
.Pa /tmp.
d783 1
a783 1
.Pa ssh .
a792 1
.Xr sh 1 ,
d795 1
d841 3
a843 3
The 
.Sy defowner,
.Sy defgroup,
@


1.17
log
@ o Sync w/ freerdist 0.92 minus the compress option
 o KNF and ANSIfy the function headers

Sparse file support is currently a no-op since it didn't work.
Proper sparse file support will be added later.
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.16 2003/04/25 14:53:03 jmc Exp $
d14 1
a14 5
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgement:
.\"	This product includes software developed by the University of
.\"	California, Berkeley and its contributors.
.\" 4. Neither the name of the University nor the names of its contributors
@


1.16
log
@add missing .El's for .Bl macros;
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.15 2003/01/15 15:05:36 deraadt Exp $
d333 15
d386 15
d842 8
@


1.15
log
@typos; jmc@@prioris.mini.pw.edu.pl
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.14 2002/05/10 02:01:32 millert Exp $
d398 1
@


1.14
log
@Convert to mdoc, though there are still a few troff font directives left.
Examples could use updating.
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.13 2002/05/09 19:19:33 millert Exp $
d45 1
d60 1
d159 1
a159 1
is the name of the user to make the connection as and,
d367 1
a367 1
Any target file that is updates is first rename from
@


1.13
log
@Now use ssh, not rsh by default.
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.12 2000/03/14 21:31:41 aaron Exp $
d37 35
a71 74
.TH RDIST 1 "January 29, 1996"
.UC 6
.SH NAME
rdist \- remote file distribution client program
.SH SYNOPSIS
.B rdist
[
.B \-DFn
]
[
.B \-A
.I num
]
[
.B \-a
.I num
]
[
.B \-d
.I var=value
]
[
.B \-l
.I <local logopts>
]
[
.B \-L
.I <remote logopts>
]
[
.B \-f
.I distfile
]
[
.B \-M
.I maxproc
]
[
.B \-m
.I host
]
[
.B \-o
.I distopts
]
[
.B \-t
.I timeout
]
[
.B \-p
.I <rdistd-path>
]
[
.B \-P
.I <rsh-path>
]
[
.I name ...
]
.PP
.B rdist
.B \-DFn
.B -c
.I name ...
.I [login@@]host[:dest]
.PP
.B rdist
.B \-Server
.PP
.B rdist
.B \-V
.SH DESCRIPTION
.I Rdist
d75 1
a75 1
.I Rdist
d77 1
a77 1
.I distfile
d80 4
a83 2
.I distfile
is `\-', the standard input is used.
d85 6
a90 3
.B \-f
option is present, the program looks first for `distfile',
then `Distfile' to use as the input.
d92 1
a92 1
.I rdist
d94 1
a94 1
.IR distfile .
d96 4
a99 5
or the label of a command to execute. If label and file names conflict,
it is assumed to be a label.
These may be used together to update specific files
using specific commands.
.PP
d101 1
a101 1
.B \-c
d103 1
a103 1
.I rdist
d105 1
a105 1
.IR distfile .
d107 1
a107 3
.nf

.ti +.5i
d109 3
a111 5
.ti +1i
install	[\fIdest\fP] ;

.fi
.PP
d113 1
a113 1
.B \-Server
d116 1
a116 1
.I rdist
d118 1
a118 1
.I rdist
d121 1
a121 1
.I rdist
d123 1
a123 1
.B \-Server
d125 4
a128 4
.I rdist,
.I /usr/bin/oldrdist.
.PP
.I Rdist
d131 1
a131 1
.B ssh
d133 4
a136 2
.I \-P
option or the RSH environment variable.
d138 3
a140 4
.B localhost
and
the remote user name is the same as the local user name,
.I rdist
d142 6
a147 9
.nf
.sp
.RS
.B "/bin/sh -c rdistd -S"
.RE
.sp
.fi
Otherwise
.I rdist
d149 1
a149 3
.nf
.sp
.RS
d151 2
a152 3
.RE
.sp
.fi
d154 1
a154 1
.I host
d156 1
a156 1
.I remuser
d158 1
a158 1
.I rdistd
d160 1
a160 1
.PP
d162 1
a162 1
.I Rdist
d164 4
a167 7
.nf
.sp
.RS
.I "rdistd -S"
.RE
.sp
.fi
d169 4
a172 7
.nf
.sp
.RS
.I "<rdistd path> -S"
.RE
.sp
.fi
d174 1
a174 1
.I \-p
d177 3
a179 4
.B \-p
option is included,
or the
.I <rdistd path>
d181 1
a181 1
.I rdistd
d183 1
a183 1
.I <rdistd path>
d185 1
a185 1
.B $PATH
d187 1
a187 1
.B rdist
d189 4
a192 3
.SH OPTIONS
.TP
.B "\-A \fInum\fR"
d195 1
a195 1
.I rdist
d197 1
a197 2
.TP
.B "\-a \fInum\fR"
d200 1
a200 1
.I rdist
d202 1
a202 2
.TP
.B \-D
d204 1
a204 2
.TP
.B "\-d \fIvar=value\fR"
d206 1
a206 1
.I var
d208 1
a208 1
.IR value .
d211 2
a212 2
.IR distfile .
.I Value
d215 1
a215 2
.TP
.B \-F
d217 1
a217 1
.I rdist
d220 1
a220 2
.TP
.B "\-f \fIdistfile\fR"
d222 1
a222 1
.I distfile .
d224 1
a224 1
.I distfile
d226 3
a228 4
``\-'' (dash)
then read from standard input (stdin).
.TP
.B "\-l \fIlogopts\fR"
d231 1
a231 1
.B "MESSAGE LOGGING"
d233 2
a234 3
.I logopts.
.TP
.B "\-L \fIlogopts\fR"
d236 2
a237 3
.I logopts
is the same as for local logging
except the values are passed to the remote
d240 1
a240 1
.B "MESSAGE LOGGING"
d242 4
a245 6
.I logopts.
.TP
.B "\-M \fInum\fR"
Set the maximum number of simultaneously
running child
.I rdist
d247 1
a247 1
.I num.
d249 1
a249 2
.TP
.B "\-m \fImachine\fR"
d251 1
a251 1
.B \-m
d253 6
a258 8
.IR distfile .
.TP
.B \-n
Print the commands without executing them. This option is
useful for debugging
.IR distfile .
.TP
.B "\-o\fIdistopts\fR"
d260 1
a260 1
.I distopts
d263 1
a263 1
.I distopts
d265 9
a273 8
.RS
.IP \fBverify\fR
Verify that the files are up to date on all the hosts. Any files
that are out of date will be displayed but no files will be changed
nor any mail sent.
.IP \fBwhole\fR
Whole mode. The whole file name is appended to the destination directory
name.  Normally, only the last component of a name is used when renaming files.
d275 3
a277 3
copied instead of flattening the directory structure. For example,
rdisting a list of files such as
.I /path/dir1/f1
d279 1
a279 1
.I /path/dir2/f2
d281 3
a283 4
.I /tmp/dir
would create
files
.I /tmp/dir/path/dir1/f1
d285 1
a285 1
.I /tmp/dir/path/dir2/f2
d287 1
a287 1
.I /tmp/dir/dir1/f1
d289 2
a290 2
.I /tmp/dir/dir2/f2.
.IP \fBnoexec\fR
d292 1
a292 1
.I a.out(5)
d294 4
a297 3
.IP \fByounger\fR
Younger mode. Files are normally updated if their
.I mtime
d299 1
a299 1
.I size
d301 4
a304 4
.IR stat (2))
disagree. This
option causes
.I rdist
d306 1
a306 2
This can be used
to prevent newer copies on other hosts from being replaced.
d308 8
a315 7
.IP \fBcompare\fR
Binary comparison. Perform a binary comparison and update files if they differ
rather than comparing dates and sizes.
.IP \fBfollow\fR
Follow symbolic links. Copy the file that the link points to rather than the
link itself.
.IP \fBignlnks\fR
d317 1
a317 1
.I Rdist
d320 4
a323 6
.IP \fBchknfs\fR
Do not check or update files on target host that
reside on NFS filesystems.
.IP \fBchkreadonly\fR
Enable check on target host
to see if a file resides on a read-only filesystem.
d325 1
a325 1
.IP \fBchksym\fR
d329 1
a329 1
.I rdist,
d331 8
a338 7
.IP \fBquiet\fR
Quiet mode. Files that are being modified are normally
printed on standard output. This
option suppresses this.
.IP \fBremove\fR
Remove extraneous files. If a directory is being updated, any files that exist
on the remote host that do not exist in the master directory are removed.
d340 1
a340 1
.IP \fBnochkowner\fR
d343 1
a343 1
.IP \fBnochkgroup\fR
d346 1
a346 1
.IP \fBnochkmode\fR
d349 1
a349 1
.IP \fBnodescend\fR
d351 2
a352 2
Normally
.I rdist
d354 2
a355 2
If this option is enabled, then any files listed in the
file list in the distfile that are directories are not recursively scanned.
d357 1
a357 1
.IP \fBnumchkgroup\fR
d360 1
a360 1
.IP \fBnumchkowner\fR
d363 1
a363 1
.IP \fBsavetargets\fR
d366 1
a366 1
.B file
d368 7
a374 5
.B file.OLD.
.IP \fBsparse\fR
Enable checking for sparse (aka \fIwholely\fR) files.  One of the most
common types of sparse files are those produced by
.B ndbm(3).
d377 2
a378 3
.RE
.TP
.B "\-p \fI<rdistd-path>\fR"
d380 2
a381 5
.TP
.B "\-P \fI<rsh-path>\fR"
Set the path to the
.I ssh(1)
command.
d386 4
a389 5
i.e.,
.B "/usr/bin/ssh:/usr/bin/rsh",
.B /usr/bin/ssh.
.TP
.B "\-t \fItimeout\fR"
d391 1
a391 1
.I rdist
d394 1
a394 2
.TP
.B \-V
d396 2
a397 2
.SH "MESSAGE LOGGING"
.I Rdist
d399 1
a399 1
.B facilities
d401 1
a401 1
.B types
d403 1
a403 1
.I facility.
d405 2
a406 3
maintain
their own copy of what types of messages to log to what facilities.
.LP
d408 2
a409 2
.B \-l
.I logopts
d411 1
a411 1
.I rdist
d413 1
a413 1
.I rdist
d416 2
a417 2
.B \-L
.I logopts
d419 1
a419 1
.I rdist
d421 1
a421 1
.I rdist
d423 1
a423 1
.I rdistd
d425 4
a428 6
.LP
The form of
.I logopts
should be of form
.sp
.RS
d430 2
a431 2
.RE
.sp
d433 2
a434 2
.RS
.IP \fBstdout\fR
d436 4
a439 3
.IP \fBfile\fR
Log to a file.  To specify the file name, use the format
``\fBfile=\fIfilename\fB=\fItypes\fR''.
d441 2
a442 2
.B "``file=/tmp/rdist.log=all,debug''.
.IP \fBsyslog\fR
d444 1
a444 1
.I syslogd(8)
d446 1
a446 1
.IP \fBnotify\fR
d448 2
a449 2
.I rdist
.B notify
d452 1
a452 1
.B notify
d454 1
a454 1
.I distfile
d456 1
a456 1
.B notify
d458 7
a464 6
.RE
.LP
.I types
should be a comma separated list of message types.  Each message type
specified enables that message level.  This is unlike the
.I syslog(3)
d466 4
a469 5
The following
are the valid
.I types:
.RS
.IP \fBchange\fR
d472 1
a472 1
.IP \fBinfo\fR
d474 1
a474 1
.IP \fBnotice\fR
d477 3
a479 4
to install a specific target, but which are not explicitly specified in
the
.I distfile.
.IP \fBnerror\fR
d481 1
a481 1
.IP \fBferror\fR
d483 1
a483 1
.IP \fBwarning\fR
d485 1
a485 1
.B nerror
d487 1
a487 1
.IP \fBdebug\fR
d489 1
a489 1
.IP \fBall\fR
d491 2
a492 2
.RE
.LP
d494 4
a497 7
.nf
.sp
.RS
\-l stdout=all:syslog=change,notice:file=/tmp/rdist.log=all
.RE
.sp
.fi
d501 1
a501 1
.I syslog(3),
d503 2
a504 3
.B /tmp/rdist.log.
.SH DISTFILES
.PP
d506 1
a506 1
.I distfile
d510 1
a510 3
.nf

.RS
d514 2
a515 3
.RE

.fi
d520 9
a528 6
The \fIsource list\fP specifies a
list of files and/or directories on the local host which are to be used
as the master copy for distribution.
The \fIdestination list\fP is the list of hosts to which these files are to be
copied.  Each file in the source list is added to a list of changes
if the file is out of date on the host which is being updated (second format) or
d530 4
a533 3
.PP
Labels are optional. They are used to identify a command for partial updates.
.PP
d535 10
a544 5
otherwise ignored. Comments begin with `#' and end with a newline.
.PP
Variables to be expanded begin with `$' followed by one character or
a name enclosed in curly braces (see the examples at the end).
.PP
d546 1
a546 3
.nf

.ti +.5i
d548 1
d550 1
a550 1
.ti +.5i
d552 2
a553 2

.fi
d556 1
a556 3
.nf

.ti +.5i
d558 1
d560 1
a560 1
.ti +.5i
d562 1
d564 1
a564 1
.ti +.5i
d566 10
a575 6

.fi
If additional modifications are needed (e.g., ``all servers and client
machines except for the OSF/1 machines'') then the list will have
to be explicitly constructed in steps using "temporary" variables.
.PP
d578 1
a578 1
.IR csh (1).
d581 1
a581 1
.IR csh
d584 1
a584 1
.B \-o\fIwhole\fR
d589 1
a589 1
.PP
d592 9
a600 14
.nf

.RS
.ta \w'cmdspecial    'u +\w'name list    'u
`install'	<options>	opt_dest_name `;'
`notify'	<name list>	`;'
`except'	<name list>	`;'
`except_pat'	<pattern list>	`;'
`special'	<name list>	string `;'
`cmdspecial'	<name list>	string `;'
.RE

.fi
.PP
d602 1
a602 1
.I install
d606 1
a606 1
.I Opt_dest_name
d609 2
a610 3
.I install
command appears in the command list or
the destination name is not specified,
d615 5
a619 7
\fB\-o \fIdistopts\fR
option
as specified above under
.B OPTIONS,
has the same semantics as
on the command line except they only apply to the files
in the source list.
d621 3
a623 2
unless the destination name is of the format ``login@@host".
.PP
d625 1
a625 1
.I notify
d631 1
a631 1
.PP
d633 1
a633 1
.I except
d635 3
a637 2
.B except
for the files listed in \fIname list\fP.
d639 1
a639 1
.PP
d641 1
a641 1
.I except_pat
d643 4
a646 2
.I except
command except that \fIpattern list\fP is a list of regular expressions
d648 1
a648 1
.IR ed (1)
d653 7
a659 4
part of the regular expression.  Variables are expanded in \fIpattern list\fP
but not shell file pattern matching characters.  To include a `$', it
must be escaped with `\e'.
.PP
d661 1
a661 1
.I special
d663 9
a671 6
.IR sh (1)
commands that are to be executed on the
remote host after the file in \fIname list\fP is updated or installed.
If the \fIname list\fP is omitted then the shell commands will be executed
for every file updated or installed.
.I String
d673 1
a673 1
.I distfile.
d678 1
a678 1
.I special
d682 1
a682 1
.I special
d684 2
a685 1
.IP \fBFILE\fR
d687 1
a687 1
.IP \fBREMFILE\fR
d689 1
a689 1
.IP \fBBASEFILE\fR
d691 2
a692 1
.PP
d694 1
a694 1
.I cmdspecial
d696 1
a696 1
.I special
d699 3
a701 2
The list of files is placed in the environment variable
.B $FILES.
d703 1
a703 1
.B $FILES
d705 2
a706 2
.PP
If a hostname ends in a ``+'' (plus sign), then the plus
d709 1
a709 1
.B \-o\fIchknfs\fR
d711 1
a711 1
.PP
d713 1
a713 3
.nf

.RS
d720 2
a721 2
EXLIB = ( Mail.rc aliases aliases.dir aliases.pag crontab dshrc
	sendmail.cf sendmail.fc sendmail.hf sendmail.st uucp vfont )
d727 1
a727 1
	special /usr/lib/sendmail "/usr/lib/sendmail -bz" ;
d742 29
a770 29
.RE

.fi
.SH ENVIRONMENT
.IP TMPDIR
Name of temporary directory to use.  Default is
.B /tmp.
.IP RSH
Name of the default remote shell program to use.  Default is
.B ssh.
.SH FILES
.nf
.ta \w'/tmp/rdist*    'u
distfile	\- input command file
$TMPDIR/rdist*	\- temporary file for update lists
.fi
.SH "SEE ALSO"
.B sh(1),
.B csh(1),
.B rsh(1),
.B ssh(1),
.B stat(2),
.B rcmdsh(3)
.SH DIAGNOSTICS
.SH NOTES
.LP
If the basename of a file  (the last component in the pathname)
is ".", then
.B rdist
d773 1
a773 1
.B /tmp/.
d775 1
a775 1
.B /tmp
d777 1
a777 1
.LP
d779 17
a795 6
.sp
.RS
\-v \-N \-O \-q \-b \-r \-R \-s \-w \-y \-h \-i \-x
.RE
.sp
.SH BUGS
d797 1
a797 1
.PP
d800 2
a801 2
.PP
.I Rdist
d803 1
a803 1
.PP
d806 1
a806 1
.I rdist
@


1.12
log
@Suffix "i.e." and "e.g." with a comma. Just another really picky man page
commit, as we want our documentation to be as consistently formatted as
possible (it's getting there :-)).
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.11 2000/03/11 21:40:07 aaron Exp $
d164 2
a165 9
.I rdist.
This option will only work if
.I rdist
was compiled with the location of the old rdist
(usually either
.I /usr/ucb/oldrdist
or
.I /usr/old/rdist)
and that program is available at run time.
d168 7
a174 10
can use either the
.I rcmd(3)
function call or the
.I rsh(1c),
remote shell, command to access each target host.
The method used is selected at compile-time.
If the
.I rsh(1c)
method is used and
the target host is the string
d193 1
a193 1
\fBrsh \fIhost\fB -l \fIremuser \fBrdistd -S\fR
a204 14
If the
.I rcmd(3)
method is used, then
.I rdist
makes the connection to the target host itself and runs
the
.I rdistd
server program as shown below.
The default, and preferred method, is to use
.I rsh(1c)
to make the connection to target hosts.  This allows
.I rdist
to be run without being setuid to ``root''.
.PP
d445 1
a445 1
.I rsh(1c)
d452 2
a453 2
.B "/usr/ucb/rsh:/usr/bin/remsh",
.B /usr/bsd/rsh.
d813 1
a813 1
.B /usr/bin/rsh.
d823 2
d826 1
a826 2
.B rsh(1c),
.B rcmd(3)
@


1.11
log
@Various cleanups and standardizations.
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.10 2000/03/04 22:19:26 aaron Exp $
d533 1
a533 1
e.g.
@


1.10
log
@In Unix land we prefer "whitespace" to "white space" or "white-space". At
least, this is the impression I get from looking at a lot of Perl docs.
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.9 1999/06/05 04:16:04 aaron Exp $
d475 1
a475 1
i.e.
d857 1
a857 1
i.e.
@


1.9
log
@capitalize the acronym ID
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.8 1999/06/05 01:21:37 aaron Exp $
d644 1
a644 1
`(' <zero or more names separated by white-space> `)'
@


1.8
log
@- remove trailing white space
- remove arguments from .Os macros
- remove arguments from .Nm macros, where appropriate
- some more Dq/Sq/Ql insanity
- still lots to do in the usr.bin tree... :/
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.7 1998/07/24 20:49:04 deraadt Exp $
d445 1
a445 1
Use the numeric group id (gid) to check group ownership instead of
d448 1
a448 1
Use the numeric user id (uid) to check user ownership instead of
@


1.7
log
@fix spelling of separate
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.6 1998/06/26 21:21:19 millert Exp $
d43 1
a43 1
[ 
d46 6
a51 2
[ 
.B \-A 
d53 6
a58 10
] 
[ 
.B \-a 
.I num 
]
[ 
.B \-d 
.I var=value 
] 
[ 
d61 2
a62 2
] 
[ 
d65 7
a71 7
] 
[ 
.B \-f 
.I distfile 
] 
[ 
.B \-M 
a72 4
] 
[ 
.B \-m 
.I host 
d74 5
a78 1
[ 
d82 4
a85 4
[ 
.B \-t 
.I timeout 
] 
d94 1
a94 1
[ 
d100 2
a101 2
.B -c 
.I name ... 
d111 1
a111 1
is a program to maintain identical copies of files over multiple hosts. 
d161 1
a161 1
is started with the 
d165 1
a165 1
This option will only work if 
d177 1
a177 1
function call or the 
d186 1
a186 1
and 
d207 1
a207 1
where 
d216 1
a216 1
.I rcmd(3) 
d220 1
a220 1
the 
d225 1
a225 1
to make the connection to target hosts.  This allows 
d251 1
a251 1
.B \-p 
d259 1
a259 1
must be somewhere in the 
d268 1
a268 1
for 
d274 1
a274 1
for 
d294 1
a294 1
Do not fork any child 
d302 1
a302 1
If 
d310 1
a310 1
See the section 
d321 1
a321 1
See the section 
d363 1
a363 1
.I /path/dir1/f1 
d365 3
a367 3
.I /path/dir2/f2 
to 
.I /tmp/dir 
d369 7
a375 7
files 
.I /tmp/dir/path/dir1/f1 
and 
.I /tmp/dir/path/dir2/f2 
instead of 
.I /tmp/dir/dir1/f1 
and 
d378 1
a378 1
Automatically exclude executable files that are in 
d380 1
a380 1
format from being checked or updated. 
d438 1
a438 1
Normally 
d468 1
a468 1
Set the path to the 
d475 1
a475 1
i.e. 
d480 1
a480 1
Set the timeout period (in seconds) for waiting for responses from the remote 
d493 1
a493 1
specifying which types of messages to send to that 
d499 1
a499 1
The 
d507 1
a507 1
The 
d531 1
a531 1
Log to a file.  To specify the file name, use the format 
d536 1
a536 1
Use the 
d546 1
a546 1
keyword in a 
d554 1
a554 1
should be a comma separated list of message types.  Each message type 
d559 1
a559 1
are the valid 
d597 1
a597 1
be sent to 
d757 1
a757 1
for every file updated or installed.  
d768 1
a768 1
The following environment variables are set for each 
d784 1
a784 1
The list of files is placed in the environment variable 
d833 1
a833 1
Name of temporary directory to use.  Default is 
d854 2
a855 2
is ".", then 
.B rdist 
d879 2
a880 2
then 
.I rdist 
@


1.6
log
@rdist 6.1.4 + OpenBSD patches + some -Wall
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.5 1997/07/22 06:59:39 millert Exp $
d473 1
a473 1
may be a colon seperated list of possible pathnames.
@


1.5
log
@Use our rcmdsh(3) and support $RSH.
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.4 1996/06/26 05:38:16 deraadt Exp $
d34 1
@


1.4
log
@rcsid
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdist.1,v 1.3 1996/03/05 03:16:10 dm Exp $
d834 3
@


1.3
log
@rdist 6.1.2
@
text
@d1 1
a33 1
.\"	$Id: rdist.man,v 6.34 1996/01/29 22:37:19 mcooper Exp $
@


1.2
log
@rdist 6.1.1
@
text
@d33 1
a33 1
.\"	$Id: rdist.man,v 6.33 1994/04/26 16:55:07 mcooper Exp $
d36 1
a36 1
.TH RDIST 1 "March 14, 1994"
d455 6
@


1.1
log
@Initial revision
@
text
@d1 3
a3 2
.\" Copyright (c) 1985, 1990, 1993
.\"	The Regents of the University of California.  All rights reserved.
d33 2
a34 2
.\"	from: @@(#)rdist.1	8.2 (Berkeley) 12/30/93
.\"	$Id: rdist.1,v 1.6 1994/03/07 05:07:19 cgd Exp $
d36 75
a110 21
.Dd December 30, 1993
.Dt RDIST 1
.Os BSD 4.3
.Sh NAME
.Nm rdist
.Nd remote file distribution program
.Sh SYNOPSIS
.Nm rdist
.Op Fl nqbRhivwy
.Op Fl f Ar distfile
.Op Fl d Ar var=value
.Op Fl m Ar host
.Op Ar name ...
.Nm rdist
.Op Fl nqbRhivwy
.Fl c
.Ar name ...
.Oo login@@ Oc Ns Ar host Ns Op :dest
.Sh DESCRIPTION
.Nm Rdist
is a program to maintain identical copies of files over multiple hosts.
d113 1
a113 1
.Nm Rdist
d115 1
a115 1
.Ar distfile
a116 5
.Pp
Options specific to the first SYNOPSIS form:
.Pp
.Bl -tag -width indent
.It Fl
d118 6
a123 18
.Ar distfile
is
.Sq Fl ,
the standard input is used.
.It Fl f Ar distfile
Use the specified
.Ar distfile.
.El
.Pp
If either the
.Fl f
or
.Sq Fl
option is not specified, the program looks first for
.Dq Pa distfile ,
then
.Dq Pa Distfile
to use as the input.
d125 1
a125 1
.Nm rdist
d127 1
a127 1
.Ar distfile  .
d133 5
a137 7
.Pp
Options specific to the second SYNOPSIS form:
.Pp
.Bl -tag -width Fl c
.It Fl c
Forces
.Nm rdist
d139 1
a139 2
.Ar distfile  .
.Pp
d141 140
a280 20
.Pp
.Bd -filled -offset indent -compact
.Pq Ar name ...
.Li ->
.Op Ar login@@
.Ar host
.Bd -filled -offset indent -compact
.Li install
.Op Ar dest ;
.Ed
.Ed
.El
.Pp
Options common to both forms:
.Pp
.Bl -tag -width Ic
.It Fl b
Binary comparison. Perform a binary comparison and update files if they differ
rather than comparing dates and sizes.
.It Fl d Ar var=value
d282 1
a282 1
.Ar var
d284 2
a285 3
.Ar value  .
The
.Fl d
d287 2
a288 2
.Ar distfile  .
.Ar Value
d291 43
a333 9
.It Fl h
Follow symbolic links. Copy the file that the link points to rather than the
link itself.
.It Fl i
Ignore unresolved links.
.Nm Rdist
will normally try to maintain the link structure of files being transferred
and warn the user if all the links cannot be found.
.It Fl m Ar host
d335 1
a335 1
.Fl m
d337 3
a339 2
.Ar distfile  .
.It Fl n
d342 11
a352 11
.Ar distfile  .
.It Fl q
Quiet mode. Files that are being modified are normally
printed on standard output. The
.Fl q
option suppresses this.
.It Fl R
Remove extraneous files. If a directory is being updated, any files that exist
on the remote host that do not exist in the master directory are removed.
This is useful for maintaining truly identical copies of directories.
.It Fl v
d356 1
a356 1
.It Fl w
d358 1
a358 1
name. Normally, only the last component of a name is used when renaming files.
d361 20
a380 3
renaming a list of files such as ( dir1/f1 dir2/f2 ) to dir3 would create
files dir3/dir1/f1 and dir3/dir2/f2 instead of dir3/f1 and dir3/f2.
.It Fl y
d382 1
a382 1
.Ar mtime
d384 1
a384 1
.Ar size
d386 2
a387 3
.Xr stat  2  )
disagree. The
.Fl y
d389 1
a389 1
.Nm rdist
d394 204
a597 3
.El
.Pp
.Ar Distfile
d601 3
a603 2
.Pp
.Bd -literal -offset indent -compact
d605 5
a609 4
[label:]<source list> `\->' <destination list> <command list>
[label:]<source list> `::' <time_stamp file> <command list>
.Ed
.Pp
d614 1
a614 3
The
.Ar source list
specifies a
d617 1
a617 3
The
.Ar destination list
is the list of hosts to which these files are to be
d621 1
a621 1
.Pp
d623 1
a623 1
.Pp
d626 1
a626 1
.Pp
d629 1
a629 1
.Pp
d631 3
a633 1
.Bd -literal -offset indent
a634 1
.Ed
d636 1
a636 1
.Bd -literal -offset indent -compact
d638 20
a657 2
.Ed
.Pp
d660 1
a660 1
.Xr csh  1  .
d663 1
a663 1
.Xr csh 1
d666 1
a666 1
.Fl w
d671 1
a671 1
.Pp
d674 14
a687 10
.Bd -ragged -offset indent -compact
.Bl -column except_patx pattern\ listx
.It `install'	<options>	opt_dest_name `;'
.It `notify'	<name list>	`;'
.It `except'	<name list>	`;'
.It `except_pat'	<pattern list>	`;'
.It `special'	<name list>	string `;'
.El
.Ed
.Pp
d689 1
a689 1
.Ic install
d693 1
a693 1
.Ar Opt_dest_name
d696 1
a696 1
.Ic install
d702 7
a708 9
To help prevent disasters, a non-empty directory on a target host will
never be replaced with a regular file or a symbolic link.
However, under the `\-R' option a non-empty directory will be removed
if the corresponding filename is completely absent on the master host.
The
.Ar options
are `\-R', `\-h', `\-i', `\-v', `\-w', `\-y', and `\-b'
and have the same semantics as
options on the command line except they only apply to the files
d712 1
a712 1
.Pp
d714 1
a714 1
.Ic notify
d720 1
a720 1
.Pp
d722 1
a722 1
.Ic except
d724 2
a725 3
.Ic except
for the files listed in
.Ar name list  .
d727 1
a727 1
.Pp
d729 1
a729 1
.Ic except_pat
d731 2
a732 4
.Ic except
command except that
.Ar pattern list
is a list of regular expressions
d734 1
a734 1
.Xr ed  1
d739 1
a739 2
part of the regular expression.  Variables are expanded in
.Ar pattern list
d742 1
a742 1
.Pp
d744 1
a744 1
.Ic special
d746 1
a746 1
.Xr sh  1
d748 4
a751 10
remote host after the file in
.Ar name list
is updated or installed.
If the
.Ar name list
is omitted then the shell commands will be executed
for every file updated or installed.  The shell variable `FILE' is set
to the current filename before executing the commands in
.Ar string  .
.Ar String
d753 1
a753 1
.Ar distfile .
d758 1
a758 1
.Ar special
d761 33
a793 4
.Pp
The following is a small example:
.Bd -literal -offset indent
HOSTS = ( matisse root@@arpa )
d796 2
a797 2
\t/usr/include/{*.h,{stand,sys,vax*,pascal,machine}/*.h}
\t/usr/lib /usr/man/man? /usr/ucb /usr/local/rdist )
d800 1
a800 1
\tsendmail.cf sendmail.fc sendmail.hf sendmail.st uucp vfont )
d803 4
a806 4
\tinstall -R ;
\texcept /usr/lib/${EXLIB} ;
\texcept /usr/games/lib ;
\tspecial /usr/lib/sendmail "/usr/lib/sendmail -bz" ;
d810 1
a810 1
\texcept_pat ( \e\e.o\e$ /SCCS\e$ ) ;
d816 2
a817 2
\tinstall /usr/local/lib ;
\tnotify ralph ;
d820 42
a861 29
\tnotify root@@cory ;
.Ed
.Sh FILES
.Bl -tag -width /tmp/rdist* -compact
.It Pa distfile
input command file
.It Pa /tmp/rdist*
temporary file for update lists
.El
.Sh SEE ALSO
.Xr sh 1 ,
.Xr csh 1 ,
.Xr stat 2
.Sh HISTORY
The
.Nm rdist
command appeared in
.Bx 4.3 .
.Sh DIAGNOSTICS
A complaint about mismatch of rdist version numbers may really stem
from some problem with starting your shell, e.g., you are in too many groups.
.Sh BUGS
Source files must reside on the local host where
.Nm rdist
is executed.
.Pp
There is no easy way to have a special command executed after all files
in a directory have been updated.
.Pp
d864 2
a865 2
.Pp
.Nm Rdist
d867 6
a872 4
.Pp
There should be a `force' option to allow replacement of non-empty directories
by regular files or symlinks.  A means of updating file modes and owners
of otherwise identical files is also needed.
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
