head	1.12;
access;
symbols
	OPENBSD_6_2_BASE:1.12
	OPENBSD_6_1:1.12.0.8
	OPENBSD_6_1_BASE:1.12
	OPENBSD_6_0:1.12.0.4
	OPENBSD_6_0_BASE:1.12
	OPENBSD_5_9:1.12.0.2
	OPENBSD_5_9_BASE:1.12
	OPENBSD_5_8:1.11.0.24
	OPENBSD_5_8_BASE:1.11
	OPENBSD_5_7:1.11.0.16
	OPENBSD_5_7_BASE:1.11
	OPENBSD_5_6:1.11.0.20
	OPENBSD_5_6_BASE:1.11
	OPENBSD_5_5:1.11.0.18
	OPENBSD_5_5_BASE:1.11
	OPENBSD_5_4:1.11.0.14
	OPENBSD_5_4_BASE:1.11
	OPENBSD_5_3:1.11.0.12
	OPENBSD_5_3_BASE:1.11
	OPENBSD_5_2:1.11.0.10
	OPENBSD_5_2_BASE:1.11
	OPENBSD_5_1_BASE:1.11
	OPENBSD_5_1:1.11.0.8
	OPENBSD_5_0:1.11.0.6
	OPENBSD_5_0_BASE:1.11
	OPENBSD_4_9:1.11.0.4
	OPENBSD_4_9_BASE:1.11
	OPENBSD_4_8:1.11.0.2
	OPENBSD_4_8_BASE:1.11
	OPENBSD_4_7:1.10.0.26
	OPENBSD_4_7_BASE:1.10
	OPENBSD_4_6:1.10.0.28
	OPENBSD_4_6_BASE:1.10
	OPENBSD_4_5:1.10.0.24
	OPENBSD_4_5_BASE:1.10
	OPENBSD_4_4:1.10.0.22
	OPENBSD_4_4_BASE:1.10
	OPENBSD_4_3:1.10.0.20
	OPENBSD_4_3_BASE:1.10
	OPENBSD_4_2:1.10.0.18
	OPENBSD_4_2_BASE:1.10
	OPENBSD_4_1:1.10.0.16
	OPENBSD_4_1_BASE:1.10
	OPENBSD_4_0:1.10.0.14
	OPENBSD_4_0_BASE:1.10
	OPENBSD_3_9:1.10.0.12
	OPENBSD_3_9_BASE:1.10
	OPENBSD_3_8:1.10.0.10
	OPENBSD_3_8_BASE:1.10
	OPENBSD_3_7:1.10.0.8
	OPENBSD_3_7_BASE:1.10
	OPENBSD_3_6:1.10.0.6
	OPENBSD_3_6_BASE:1.10
	OPENBSD_3_5:1.10.0.4
	OPENBSD_3_5_BASE:1.10
	OPENBSD_3_4:1.10.0.2
	OPENBSD_3_4_BASE:1.10
	OPENBSD_3_3:1.9.0.2
	OPENBSD_3_3_BASE:1.9
	OPENBSD_3_2:1.7.0.2
	OPENBSD_3_2_BASE:1.7
	OPENBSD_3_1:1.3.0.22
	OPENBSD_3_1_BASE:1.3
	OPENBSD_3_0:1.3.0.20
	OPENBSD_3_0_BASE:1.3
	OPENBSD_2_9_BASE:1.3
	OPENBSD_2_9:1.3.0.18
	OPENBSD_2_8:1.3.0.16
	OPENBSD_2_8_BASE:1.3
	OPENBSD_2_7:1.3.0.14
	OPENBSD_2_7_BASE:1.3
	OPENBSD_2_6:1.3.0.12
	OPENBSD_2_6_BASE:1.3
	OPENBSD_2_5:1.3.0.10
	OPENBSD_2_5_BASE:1.3
	OPENBSD_2_4:1.3.0.8
	OPENBSD_2_4_BASE:1.3
	OPENBSD_2_3:1.3.0.6
	OPENBSD_2_3_BASE:1.3
	OPENBSD_2_2:1.3.0.4
	OPENBSD_2_2_BASE:1.3
	OPENBSD_2_1:1.3.0.2
	OPENBSD_2_1_BASE:1.3
	OPENBSD_2_0:1.2.0.2
	OPENBSD_2_0_BASE:1.2
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@ * @;


1.12
date	2015.11.13.21.34.06;	author millert;	state Exp;
branches;
next	1.11;
commitid	vZNTC7bzkunUPuVe;

1.11
date	2010.07.02.23.40.09;	author krw;	state Exp;
branches;
next	1.10;

1.10
date	2003.07.02.21.04.09;	author deraadt;	state Exp;
branches;
next	1.9;

1.9
date	2003.03.14.04.15.04;	author millert;	state Exp;
branches;
next	1.8;

1.8
date	2003.02.20.20.38.08;	author millert;	state Exp;
branches;
next	1.7;

1.7
date	2002.05.14.18.05.39;	author millert;	state Exp;
branches
	1.7.2.1;
next	1.6;

1.6
date	2002.05.13.16.12.07;	author millert;	state Exp;
branches;
next	1.5;

1.5
date	2002.05.11.23.16.44;	author millert;	state Exp;
branches;
next	1.4;

1.4
date	2002.05.11.23.02.33;	author millert;	state Exp;
branches;
next	1.3;

1.3
date	97.03.01.23.40.09;	author millert;	state Exp;
branches;
next	1.2;

1.2
date	96.06.26.05.31.28;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.44.54;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.44.54;	author deraadt;	state Exp;
branches;
next	;

1.7.2.1
date	2003.03.18.04.06.47;	author margarida;	state Exp;
branches;
next	;


desc
@@


1.12
log
@There's no need for at.c globals to be extern.
@
text
@/*	$OpenBSD: at.h,v 1.11 2010/07/02 23:40:09 krw Exp $	*/

/*
 *  at.h -  header for at(1)
 *  Copyright (C) 1993  Thomas Koenig
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. The name of the author(s) may not be used to endorse or promote
 *    products derived from this software without specific prior written
 *    permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE AUTHOR(S) ``AS IS'' AND ANY EXPRESS OR
 * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
 * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE AUTHOR(S) BE LIABLE FOR ANY DIRECT, INDIRECT,
 * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
 * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
 * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

enum { ATQ, ATRM, AT, BATCH, CAT };	/* what are we running as? */

struct atjob {
	time_t runtimer;
	time_t ctime;
	uid_t uid;
	mode_t mode;
	char queue;
};

#define DEFAULT_BATCH_QUEUE	'E'
#define DEFAULT_AT_QUEUE	'c'

time_t	parsetime(int, char **);
@


1.11
log
@'wether' -> 'whether' typo in license text.

ok deraadt@@
@
text
@d1 1
a1 1
/*	$OpenBSD: at.h,v 1.10 2003/07/02 21:04:09 deraadt Exp $	*/
a27 7
extern int fcreated;
extern int program;
extern char atfile[];
extern char vflag;
extern char force;
extern char interactive;

a40 1

a41 1

@


1.10
log
@protos
@
text
@d1 1
a1 1
/*	$OpenBSD: at.h,v 1.9 2003/03/14 04:15:04 millert Exp $	*/
d23 1
a23 1
 * THEORY OF LIABILITY, WETHER IN CONTRACT, STRICT LIABILITY, OR TORT
@


1.9
log
@This goes with the at.c change
@
text
@d1 1
a1 1
/*	$OpenBSD: at.h,v 1.8 2003/02/20 20:38:08 millert Exp $	*/
d47 4
@


1.8
log
@Sync with ISC cron-current + my at(1) integration.
The at(1) code is now more tightly integrated into the cron codebase.
@
text
@d1 1
a1 1
/*	$OpenBSD: at.h,v 1.7 2002/05/14 18:05:39 millert Exp $	*/
d40 2
@


1.7
log
@Major changes:

Job names are now "runtime.queue" where runtime is when the job will run
in Unix time format.  This is what SysV at does and allows us to nuke
the .SEQ file.

Historic BSD options for atq and atrm are now implemented;
atq and atrm get their own man pages.

At no longer does anything with the -v flag.  We print the execution
time when jobs are submitted so there is no need.

Most *scanf() usage is gone (one remains in atrun).

Better sanity checks in atrun.

Random style/cleanup.

With these changes we have the best of both worlds; POSIX compliance with
the traditional BSD features.
@
text
@d1 1
a1 2
/*	$OpenBSD: at.h,v 1.6 2002/05/13 16:12:07 millert Exp $	*/
/*	$NetBSD: at.h,v 1.2 1995/03/25 18:13:32 glass Exp $	*/
a28 1
extern char *__progname;
a41 2

#define AT_MAXJOBS	255	/* max jobs outstanding per user */
@


1.7.2.1
log
@Pull patches from current:
Fixes by millert and mpech.

o Add missing increment in newjob() when there is a time collision.
o Fix 'at -r' crash. While loop in process_job() jobs[i] will
  contain NULL. Skip mess.
o Add missing  #include <limits.h>
o Stash uid and mode in struct at so we don't need to pass around a
  struct statbuf *.  Fixes a bug where atq reports all jobs as being
  owned by the owner of the last job in the queue.

millert@@ ok
@
text
@d1 2
a2 2
/*	$OpenBSD: at.h,v 1.7 2002/05/14 18:05:39 millert Exp $	*/
/*	$OpenBSD: at.h,v 1.9 2003/03/14 04:15:04 millert Exp $	*/
a41 2
	uid_t uid;
	mode_t mode;
@


1.6
log
@Only print usage for the command that was run (at, atq, atrm, batch), not
all four.  Also differentiate between the touch(1) style time as time_arg
and the at(1) style time as timespec (which is what SUS3 does).
Instead of referring to the touch time format as POSIX time, reference
touch.  This is what SUS3 does and it is what users will know.
@
text
@d1 1
a1 1
/*	$OpenBSD: at.h,v 1.5 2002/05/11 23:16:44 millert Exp $	*/
d33 3
a35 1
extern char atverify;
d38 6
@


1.5
log
@Pass -Wall and use ANSI function headers.
@
text
@d1 1
a1 1
/*	$OpenBSD: at.h,v 1.4 2002/05/11 23:02:33 millert Exp $	*/
d31 1
d34 2
@


1.4
log
@Add POSIX -r and -t flags from FreeBSD.  The old -d option is now
deprecated and no longer documented.
Also, use __progname instead of examining argv and clean up a few minor
warnings.
@
text
@d1 1
a1 1
/*	$OpenBSD: at.h,v 1.3 1997/03/01 23:40:09 millert Exp $	*/
a34 1
#define AT_VERSION	2.9	/* our version number */
@


1.3
log
@Merge in changes from at 2.9
@
text
@d1 1
a1 1
/*	$OpenBSD: at.h,v 1.2 1996/06/26 05:31:28 deraadt Exp $	*/
d30 1
a30 1
extern char *namep;
@


1.2
log
@rcsid
@
text
@d1 1
a1 1
/*	$OpenBSD: at.h,v 1.2 1995/03/25 18:13:32 glass Exp $	*/
d5 2
a6 3
 * at.h -  header for at(1)
 * Copyright (c) 1993 by Thomas Koenig
 * All rights reserved.
d20 1
a20 1
 * IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
a26 2
 *
 *	$NetBSD: at.h,v 1.2 1995/03/25 18:13:32 glass Exp $
d35 4
@


1.1
log
@Initial revision
@
text
@d1 1
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
