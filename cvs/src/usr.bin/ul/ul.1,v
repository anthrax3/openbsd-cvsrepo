head	1.17;
access;
symbols
	OPENBSD_6_2_BASE:1.17
	OPENBSD_6_1:1.17.0.4
	OPENBSD_6_1_BASE:1.17
	OPENBSD_6_0:1.16.0.4
	OPENBSD_6_0_BASE:1.16
	OPENBSD_5_9:1.16.0.2
	OPENBSD_5_9_BASE:1.16
	OPENBSD_5_8:1.15.0.22
	OPENBSD_5_8_BASE:1.15
	OPENBSD_5_7:1.15.0.14
	OPENBSD_5_7_BASE:1.15
	OPENBSD_5_6:1.15.0.18
	OPENBSD_5_6_BASE:1.15
	OPENBSD_5_5:1.15.0.16
	OPENBSD_5_5_BASE:1.15
	OPENBSD_5_4:1.15.0.12
	OPENBSD_5_4_BASE:1.15
	OPENBSD_5_3:1.15.0.10
	OPENBSD_5_3_BASE:1.15
	OPENBSD_5_2:1.15.0.8
	OPENBSD_5_2_BASE:1.15
	OPENBSD_5_1_BASE:1.15
	OPENBSD_5_1:1.15.0.6
	OPENBSD_5_0:1.15.0.4
	OPENBSD_5_0_BASE:1.15
	OPENBSD_4_9:1.15.0.2
	OPENBSD_4_9_BASE:1.15
	OPENBSD_4_8:1.14.0.12
	OPENBSD_4_8_BASE:1.14
	OPENBSD_4_7:1.14.0.8
	OPENBSD_4_7_BASE:1.14
	OPENBSD_4_6:1.14.0.10
	OPENBSD_4_6_BASE:1.14
	OPENBSD_4_5:1.14.0.6
	OPENBSD_4_5_BASE:1.14
	OPENBSD_4_4:1.14.0.4
	OPENBSD_4_4_BASE:1.14
	OPENBSD_4_3:1.14.0.2
	OPENBSD_4_3_BASE:1.14
	OPENBSD_4_2:1.13.0.2
	OPENBSD_4_2_BASE:1.13
	OPENBSD_4_1:1.12.0.4
	OPENBSD_4_1_BASE:1.12
	OPENBSD_4_0:1.12.0.2
	OPENBSD_4_0_BASE:1.12
	OPENBSD_3_9:1.11.0.10
	OPENBSD_3_9_BASE:1.11
	OPENBSD_3_8:1.11.0.8
	OPENBSD_3_8_BASE:1.11
	OPENBSD_3_7:1.11.0.6
	OPENBSD_3_7_BASE:1.11
	OPENBSD_3_6:1.11.0.4
	OPENBSD_3_6_BASE:1.11
	OPENBSD_3_5:1.11.0.2
	OPENBSD_3_5_BASE:1.11
	OPENBSD_3_4:1.10.0.2
	OPENBSD_3_4_BASE:1.10
	OPENBSD_3_3:1.9.0.2
	OPENBSD_3_3_BASE:1.9
	OPENBSD_3_2:1.8.0.6
	OPENBSD_3_2_BASE:1.8
	OPENBSD_3_1:1.8.0.4
	OPENBSD_3_1_BASE:1.8
	OPENBSD_3_0:1.8.0.2
	OPENBSD_3_0_BASE:1.8
	OPENBSD_2_9_BASE:1.7
	OPENBSD_2_9:1.7.0.6
	OPENBSD_2_8:1.7.0.4
	OPENBSD_2_8_BASE:1.7
	OPENBSD_2_7:1.7.0.2
	OPENBSD_2_7_BASE:1.7
	OPENBSD_2_6:1.4.0.2
	OPENBSD_2_6_BASE:1.4
	OPENBSD_2_5:1.3.0.2
	OPENBSD_2_5_BASE:1.3
	OPENBSD_2_4:1.2.0.10
	OPENBSD_2_4_BASE:1.2
	OPENBSD_2_3:1.2.0.8
	OPENBSD_2_3_BASE:1.2
	OPENBSD_2_2:1.2.0.6
	OPENBSD_2_2_BASE:1.2
	OPENBSD_2_1:1.2.0.4
	OPENBSD_2_1_BASE:1.2
	OPENBSD_2_0:1.2.0.2
	OPENBSD_2_0_BASE:1.2
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@.\" @;


1.17
date	2016.10.24.13.46.58;	author schwarze;	state Exp;
branches;
next	1.16;
commitid	exLg5RWnU06ZBxJ9;

1.16
date	2016.01.18.17.34.26;	author schwarze;	state Exp;
branches;
next	1.15;
commitid	FsrqG8aKKZiWi6QR;

1.15
date	2010.10.29.08.02.05;	author jmc;	state Exp;
branches;
next	1.14;

1.14
date	2007.10.16.20.19.27;	author sobrado;	state Exp;
branches;
next	1.13;

1.13
date	2007.05.31.19.20.18;	author jmc;	state Exp;
branches;
next	1.12;

1.12
date	2006.05.26.17.26.33;	author jmc;	state Exp;
branches;
next	1.11;

1.11
date	2004.02.20.22.07.09;	author jmc;	state Exp;
branches;
next	1.10;

1.10
date	2003.06.03.02.56.20;	author millert;	state Exp;
branches;
next	1.9;

1.9
date	2003.03.10.15.37.30;	author jmc;	state Exp;
branches;
next	1.8;

1.8
date	2001.05.01.17.58.05;	author aaron;	state Exp;
branches;
next	1.7;

1.7
date	2000.03.22.21.22.26;	author aaron;	state Exp;
branches;
next	1.6;

1.6
date	2000.03.11.21.40.06;	author aaron;	state Exp;
branches;
next	1.5;

1.5
date	2000.03.05.00.28.55;	author aaron;	state Exp;
branches;
next	1.4;

1.4
date	99.06.05.01.21.45;	author aaron;	state Exp;
branches;
next	1.3;

1.3
date	98.10.30.00.24.41;	author aaron;	state Exp;
branches;
next	1.2;

1.2
date	96.06.26.05.42.04;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.46.28;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.46.28;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.17
log
@Unify wording for LC_CTYPE in ENVIRONMENT:
* Consistently use "character encoding locale" as suggested by stsp@@.
* Resolve various gratuitious wording variations.
OK jmc@@.
@
text
@.\"	$OpenBSD: ul.1,v 1.16 2016/01/18 17:34:26 schwarze Exp $
.\"	$NetBSD: ul.1,v 1.3 1994/12/07 00:28:23 jtc Exp $
.\"
.\" Copyright (c) 1980, 1991, 1993
.\"	The Regents of the University of California.  All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. Neither the name of the University nor the names of its contributors
.\"    may be used to endorse or promote products derived from this software
.\"    without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.\"     @@(#)ul.1	8.1 (Berkeley) 6/6/93
.\"
.Dd $Mdocdate: January 18 2016 $
.Dt UL 1
.Os
.Sh NAME
.Nm ul
.Nd do underlining
.Sh SYNOPSIS
.Nm ul
.Op Fl i
.Op Fl t Ar terminal
.Op Ar
.Sh DESCRIPTION
.Nm
reads the named files (or standard input if none are given)
and translates various kinds of in-band markup to forms
appropriate for the terminal in use, as specified
by the environment variable
.Ev TERM
and the
.Xr terminfo 5
database.
In particular,
.Xr man 1
.Fl T Cm ascii ,
.Fl T Cm utf8 ,
and
.Fl T Cm locale
produce output that
.Nm
can handle as input.
.Pp
The following control characters are handled in the input stream:
.Bl -tag -width Ds
.It backspace (ASCII 0x08)
Reset the output display column to the beginning of the previous
character, to prepare for overstriking.
The display width of the previous character does not matter:
backing up over a double-width character does not require two
backspace characters.
However, if a double-width character is followed by two backspace
characters, the second one is discarded, for compatibility with
.Xr fold 1 .
.It tabulator (ASCII 0x09)
Advance the output display column to the next multiple of 8.
Tabs are always expanded into blanks.
.It newline (ASCII 0x0a)
End the current output line.
.It carriage return (ASCII 0x0d)
Reset the output display column to the beginning of the line,
to prepare for overstriking.
.It shift out (ASCII 0x0e)
Switch on reverse video mode.
.It shift in (ASCII 0x0f)
Switch off reverse video mode.
.It escape 7 (ASCII 0x1b 0x37)
Full reverse line feed.
.It escape 8 (ASCII 0x1b 0x38)
Half reverse line feed.
Sometimes used for superscripts.
.It escape 9 (ASCII 0x1b 0x39)
Half forward line feed.
Sometimes used for subscripts.
.El
.Pp
The following kinds of markup are handled:
.Bl -tag -width Ds
.It underline
Requested by putting an underscore into the same display cell as
another character, by using backspace or carriage return characters.
The usual sequence to request an underlined character is "character
backspace underscore", but "underscore backspace character" works,
too.
If the terminal cannot underline, standout mode is tried as a fallback.
.It boldface
Requested by putting two copies of the same character into the same
display cell, by using backspace or carriage return characters.
The usual sequence to request a boldface character is "character
backspace character".
If the terminal does not provide boldface display, reverse video and
standout mode are tried as fallbacks.
.It reverse video
Switched on and off by the shift out and shift in control characters,
respectively.
If the terminal does not provide reverse video, standout mode is
tried as a fallback.
.El
.Pp
If the input text contains markup the terminal cannot handle and
no working fallback is available, that markup is ignored.
Non-printable characters and invalid bytes are discarded.
Unknown escape sequences cause
.Nm
to abort with an error message and a non-zero exit code.
.Pp
The options are as follows:
.Bl -tag -width Ds
.It Fl i
Markup is not applied.
Instead, after each output line containing at least one marked-up
character, an additional line is printed, containing the following
ASCII codes below each character they apply to:
.Pp
.Bl -tag -width 1n -compact
.It _
underline
.It !
boldface
.It g
inverse video
.It ^
one half line above the current line (superscript)
.It v
one half line below the current line (subscript)
.It X
more than one kind of markup
.El
.It Fl t Ar terminal
Overrides the terminal type specified in the environment with
.Ar terminal .
.El
.Sh ENVIRONMENT
.Bl -tag -width LC_CTYPE
.It Ev LC_CTYPE
The character encoding
.Xr locale 1 .
It decides which byte sequences form characters, which characters
are printable, and what their display width is.
If set to
.Qq C ,
.Qq POSIX ,
or an unsupported value, each ASCII character except the control
characters listed above is regarded as a character, and if it is
printable, of display width 1.
.It Ev TERM
Used to relate a tty device
with its device capability description (see
.Xr terminfo 5 ) .
.Ev TERM
is set at login time, either by the default terminal type
specified in
.Pa /etc/ttys
or as set during the login process by the user in their
.Pa login
file (see
.Xr environ 7 ) .
.El
.Sh EXIT STATUS
.Ex -std
.Sh SEE ALSO
.Xr man 1 ,
.Xr terminfo 5
.Sh HISTORY
The
.Nm
command appeared in
.Bx 3.0 .
.Sh BUGS
Half reverse and half forward line feeds only work on few terminals,
and full reverse line feeds aren't very portable, either.
.Pp
If more than one kind of markup is applied to the same character,
all these markups are ignored and standout mode is used instead.
@


1.16
log
@UTF-8 support:
This is the first example of a program where doing the full char *
to wchar_t * to char * double conversion is actually simpler than
our usual approach of working with char * throughout.  In part
inspired by the FreeBSD version which is in turn based on Bruno
Haible's work in util-linux, but not sharing any code and avoiding
the almost half a dozen bugs that FreeBSD has.

As a bonus reimplement overstrike() and iattr() almost from scratch,
getting rid of useless malloc(3)ed local buffers.

Add lots of missing information to the manual.

No opposition when shown on tech@@.
@
text
@d1 1
a1 1
.\"	$OpenBSD: ul.1,v 1.15 2010/10/29 08:02:05 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate: October 29 2010 $
d156 1
a156 1
The character set
d158 2
a159 2
It decides which byte sequences form characters, which characters are
printable, and how many output display columns each character occupies.
@


1.15
log
@some fixes from ingo regarding the recent groff removal;
@
text
@d1 1
a1 1
.\"	$OpenBSD: ul.1,v 1.14 2007/10/16 20:19:27 sobrado Exp $
d33 1
a33 1
.Dd $Mdocdate: October 16 2007 $
d47 2
a48 2
and translates occurrences of underscores to the sequence
which indicates underlining for the terminal in use, as specified
d50 74
a123 8
.Ev TERM .
The file
.Pa /etc/termcap
is read to determine the appropriate sequences for underlining.
If the terminal is incapable of underlining, but is capable of
a standout mode, then that is used instead.
If the terminal can overstrike,
or handles underlining automatically,
d125 1
a125 3
degenerates to
.Xr cat 1 .
If the terminal cannot underline, underlining is ignored.
d130 19
a148 3
Underlining is indicated by a separate line containing appropriate
dashes
.Pq Ql - .
d154 12
a165 1
.Bl -tag -width TERM
d169 1
a169 1
.Xr termcap 5 ) .
d179 2
d182 2
a183 1
.Xr man 1
d189 6
@


1.14
log
@sync the synopsis and usage of commands

ok jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: ul.1,v 1.13 2007/05/31 19:20:18 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate: May 31 2007 $
d68 1
a68 5
.Pq Ql - ;
this is useful when you want to look at the underlining
which is present in an
.Xr nroff 1
output stream.
d89 1
a89 3
.Xr colcrt 1 ,
.Xr man 1 ,
.Xr nroff 1
a94 5
.Sh BUGS
.Xr nroff 1
usually outputs a series of backspaces and underlines intermixed
with the text to indicate underlining.
No attempt is made to optimize the backward motion.
@


1.13
log
@convert to new .Dd format;
@
text
@d1 1
a1 1
.\"	$OpenBSD: ul.1,v 1.12 2006/05/26 17:26:33 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate$
d43 1
a43 1
.Op Ar name Ar ...
@


1.12
log
@remove references to CRTs where they no longer make sense;

tweaked by mickey/krw
ok deraadt
@
text
@d1 1
a1 1
.\"	$OpenBSD: ul.1,v 1.11 2004/02/20 22:07:09 jmc Exp $
d33 1
a33 1
.Dd June 6, 1993
@


1.11
log
@uppercase CRT;
@
text
@d1 1
a1 1
.\"	$OpenBSD: ul.1,v 1.10 2003/06/03 02:56:20 millert Exp $
d72 1
a72 1
output stream on a CRT-terminal.
@


1.10
log
@Remove the advertising clause in the UCB license which Berkeley
rescinded 22 July 1999.  Proofed by myself and Theo.
@
text
@d1 1
a1 1
.\"	$OpenBSD: ul.1,v 1.9 2003/03/10 15:37:30 jmc Exp $
d72 1
a72 1
output stream on a crt-terminal.
@


1.9
log
@these pages all had bad section numbers in the .Xr's;

lots of help and ok millert@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: ul.1,v 1.8 2001/05/01 17:58:05 aaron Exp $
d15 1
a15 5
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgement:
.\"	This product includes software developed by the University of
.\"	California, Berkeley and its contributors.
.\" 4. Neither the name of the University nor the names of its contributors
@


1.8
log
@Remove completely redundant introductory sentences in ENVIRONMENT sections.
@
text
@d1 1
a1 1
.\"	$OpenBSD: ul.1,v 1.7 2000/03/22 21:22:26 aaron Exp $
d94 1
a94 1
.Xr setenv 1 ) .
@


1.7
log
@Put BUGS section after HISTORY.
@
text
@d1 1
a1 1
.\"	$OpenBSD: ul.1,v 1.6 2000/03/11 21:40:06 aaron Exp $
a81 2
The following environment variables affect the execution of
.Nm ul :
@


1.6
log
@Various cleanups and standardizations.
@
text
@d1 1
a1 1
.\"	$OpenBSD: ul.1,v 1.5 2000/03/05 00:28:55 aaron Exp $
d102 5
a111 5
.Sh HISTORY
The
.Nm
command appeared in
.Bx 3.0 .
@


1.5
log
@Finish standardizing options list introduction.
@
text
@d1 1
a1 1
.\"	$OpenBSD: ul.1,v 1.4 1999/06/05 01:21:45 aaron Exp $
d71 3
a73 1
dashes `\-'; this is useful when you want to look at the underlining
d82 2
a83 1
The following environment variable is used:
d86 1
a86 3
The
.Ev TERM
variable is used to relate a tty device
d105 2
a106 2
with the text to indicate underlining.  No attempt is made to optimize
the backward motion.
@


1.4
log
@- remove trailing white space
- remove arguments from .Os macros
- remove arguments from .Nm macros, where appropriate
- some more Dq/Sq/Ql insanity
- still lots to do in the usr.bin tree... :/
@
text
@d1 1
a1 1
.\"	$OpenBSD: ul.1,v 1.3 1998/10/30 00:24:41 aaron Exp $
d49 1
a49 1
.Nm ul
d62 1
a62 1
.Nm ul
d67 1
a67 1
The following options are available:
@


1.3
log
@usr.bin/ man page fixes, t-z
@
text
@d1 1
a1 1
.\"	$OpenBSD: ul.1,v 1.2 1996/06/26 05:42:04 deraadt Exp $
d39 1
a39 1
.Os BSD 4
d95 1
a95 1
.Xr setenv 1 ) . 
@


1.2
log
@rcsid
@
text
@d1 1
a1 1
.\"	$OpenBSD: ul.1,v 1.3 1994/12/07 00:28:23 jtc Exp $
d49 1
a49 1
.Nm Ul
d59 1
a59 1
a standout mode then that is used instead.
d73 1
a73 1
.Xr nroff
d98 1
d100 1
a100 2
.Xr nroff 1 ,
.Xr colcrt 1
d102 1
a102 1
.Xr Nroff
@


1.1
log
@Initial revision
@
text
@d1 1
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
