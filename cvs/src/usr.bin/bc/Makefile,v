head	1.9;
access;
symbols
	OPENBSD_6_1:1.8.0.8
	OPENBSD_6_1_BASE:1.8
	OPENBSD_6_0:1.8.0.4
	OPENBSD_6_0_BASE:1.8
	OPENBSD_5_9:1.8.0.2
	OPENBSD_5_9_BASE:1.8
	OPENBSD_5_8:1.7.0.10
	OPENBSD_5_8_BASE:1.7
	OPENBSD_5_7:1.7.0.2
	OPENBSD_5_7_BASE:1.7
	OPENBSD_5_6:1.7.0.6
	OPENBSD_5_6_BASE:1.7
	OPENBSD_5_5:1.7.0.4
	OPENBSD_5_5_BASE:1.7
	OPENBSD_5_4:1.6.0.10
	OPENBSD_5_4_BASE:1.6
	OPENBSD_5_3:1.6.0.8
	OPENBSD_5_3_BASE:1.6
	OPENBSD_5_2:1.6.0.6
	OPENBSD_5_2_BASE:1.6
	OPENBSD_5_1_BASE:1.6
	OPENBSD_5_1:1.6.0.4
	OPENBSD_5_0:1.6.0.2
	OPENBSD_5_0_BASE:1.6
	OPENBSD_4_9:1.5.0.2
	OPENBSD_4_9_BASE:1.5
	OPENBSD_4_8:1.4.0.18
	OPENBSD_4_8_BASE:1.4
	OPENBSD_4_7:1.4.0.14
	OPENBSD_4_7_BASE:1.4
	OPENBSD_4_6:1.4.0.16
	OPENBSD_4_6_BASE:1.4
	OPENBSD_4_5:1.4.0.12
	OPENBSD_4_5_BASE:1.4
	OPENBSD_4_4:1.4.0.10
	OPENBSD_4_4_BASE:1.4
	OPENBSD_4_3:1.4.0.8
	OPENBSD_4_3_BASE:1.4
	OPENBSD_4_2:1.4.0.6
	OPENBSD_4_2_BASE:1.4
	OPENBSD_4_1:1.4.0.4
	OPENBSD_4_1_BASE:1.4
	OPENBSD_4_0:1.4.0.2
	OPENBSD_4_0_BASE:1.4
	OPENBSD_3_9:1.2.0.10
	OPENBSD_3_9_BASE:1.2
	OPENBSD_3_8:1.2.0.8
	OPENBSD_3_8_BASE:1.2
	OPENBSD_3_7:1.2.0.6
	OPENBSD_3_7_BASE:1.2
	OPENBSD_3_6:1.2.0.4
	OPENBSD_3_6_BASE:1.2
	OPENBSD_3_5:1.2.0.2
	OPENBSD_3_5_BASE:1.2;
locks; strict;
comment	@# @;


1.9
date	2017.07.03.00.17.52;	author espie;	state Exp;
branches;
next	1.8;
commitid	ZZ4EG87dxWxf7om2;

1.8
date	2015.10.10.19.28.54;	author deraadt;	state Exp;
branches;
next	1.7;
commitid	U920W7iXGRn2x9qj;

1.7
date	2013.09.19.16.12.00;	author otto;	state Exp;
branches;
next	1.6;

1.6
date	2011.03.07.08.11.15;	author otto;	state Exp;
branches;
next	1.5;

1.5
date	2010.10.17.22.54.37;	author schwarze;	state Exp;
branches;
next	1.4;

1.4
date	2006.06.30.19.02.28;	author otto;	state Exp;
branches;
next	1.3;

1.3
date	2006.05.27.22.53.44;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	2003.11.03.19.51.42;	author otto;	state Exp;
branches;
next	1.1;

1.1
date	2003.09.25.19.35.12;	author otto;	state Exp;
branches;
next	;


desc
@@


1.9
log
@be explicit in the lex/yacc dependencies
reluctant okay deraadt@@
@
text
@#	$OpenBSD: Makefile,v 1.8 2015/10/10 19:28:54 deraadt Exp $

PROG=		bc
SRCS=		bc.y scan.l tty.c dc.c bcode.c inout.c mem.c stack.c
CPPFLAGS+=	-I. -I${.CURDIR}
CFLAGS+=	-Wall -Wno-unused
YFLAGS+=
LDADD+=		-ledit -lcurses -lcrypto
DPADD+=		${LIBEDIT} ${LIBCURSES} ${LIBCRYPTO}

.PATH:		${.CURDIR}/../dc

bc.c y.tab.h: bc.y
	${YACC} -d ${.CURDIR}/bc.y
	mv y.tab.c bc.c

scan.o: y.tab.h

beforeinstall:
	install -c -o ${BINOWN} -g ${BINGRP} -m 444 ${.CURDIR}/bc.library \
	    ${DESTDIR}/usr/share/misc

.include <bsd.prog.mk>
@


1.8
log
@Rather than invoking fork/execve of dc(1) on a pipe, compile in the dc(1)
code directly and use it as a subfunction.  This refactoring allows use of
pledge "stdio rpath proc tty" in the main bc(1) process before fork, pledge
"stdio rpath tty" after fork, and fully reduced to "stdio" in the dc(1)
child.

This requires two recent to the kernel code (allowing sigsuspend(),
and kill() self as pid 0).
ok otto
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.7 2013/09/19 16:12:00 otto Exp $
d12 6
@


1.7
log
@separate termios.h out from scan.l, both have an ECHO define. Noted by
Joris Giovannangeli.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.6 2011/03/07 08:11:15 otto Exp $
d4 1
a4 1
SRCS=		bc.y scan.l tty.c
d8 2
a9 2
LDADD+=		-ledit -lcurses
DPADD+=		${LIBEDIT} ${LIBCURSES}
d11 1
@


1.6
log
@add editline support; from freebsd. ok deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.6 2011/03/07 08:09:25 otto Exp $
d4 1
a4 1
SRCS=		bc.y scan.l
@


1.5
log
@Stop installing me(1) and ms(1) source code.
We will soon get rid of groff in base,
so there is no longer any way to use these files with base.
No opposition on tech@@.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.4 2006/06/30 19:02:28 otto Exp $
d8 3
@


1.4
log
@CLEANFILES no longer needed since this is now done by bsd.*.mk
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.3 2006/05/27 22:53:44 deraadt Exp $
a11 5

# These get installed verbatim
.if make(install)
SUBDIR+= USD.doc
.endif
@


1.3
log
@SRCS should refer to the .l and .c files; spotted by naddy
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.2 2003/11/03 19:51:42 otto Exp $
a7 1
CLEANFILES+=	bc.c y.tab.h scan.c lex.yy.c
@


1.2
log
@Install bc(1) USD doc.

ok deraadt@@ mickey@@ jmc@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.1 2003/09/25 19:35:12 otto Exp $
d4 1
a4 1
SRCS=		bc.c scan.c
@


1.1
log
@Makefile for bc(1).

ok deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD$
d13 5
@

