head	1.12;
access;
symbols
	OPENBSD_6_2:1.12.0.8
	OPENBSD_6_2_BASE:1.12
	OPENBSD_6_1:1.12.0.6
	OPENBSD_6_1_BASE:1.12
	OPENBSD_6_0:1.12.0.2
	OPENBSD_6_0_BASE:1.12
	OPENBSD_5_9:1.11.0.2
	OPENBSD_5_9_BASE:1.11
	OPENBSD_5_8:1.10.0.8
	OPENBSD_5_8_BASE:1.10
	OPENBSD_5_7:1.10.0.2
	OPENBSD_5_7_BASE:1.10
	OPENBSD_5_6:1.10.0.4
	OPENBSD_5_6_BASE:1.10
	OPENBSD_5_5:1.9.0.16
	OPENBSD_5_5_BASE:1.9
	OPENBSD_5_4:1.9.0.12
	OPENBSD_5_4_BASE:1.9
	OPENBSD_5_3:1.9.0.10
	OPENBSD_5_3_BASE:1.9
	OPENBSD_5_2:1.9.0.8
	OPENBSD_5_2_BASE:1.9
	OPENBSD_5_1_BASE:1.9
	OPENBSD_5_1:1.9.0.6
	OPENBSD_5_0:1.9.0.4
	OPENBSD_5_0_BASE:1.9
	OPENBSD_4_9:1.9.0.2
	OPENBSD_4_9_BASE:1.9
	OPENBSD_4_8:1.8.0.16
	OPENBSD_4_8_BASE:1.8
	OPENBSD_4_7:1.8.0.12
	OPENBSD_4_7_BASE:1.8
	OPENBSD_4_6:1.8.0.14
	OPENBSD_4_6_BASE:1.8
	OPENBSD_4_5:1.8.0.10
	OPENBSD_4_5_BASE:1.8
	OPENBSD_4_4:1.8.0.8
	OPENBSD_4_4_BASE:1.8
	OPENBSD_4_3:1.8.0.6
	OPENBSD_4_3_BASE:1.8
	OPENBSD_4_2:1.8.0.4
	OPENBSD_4_2_BASE:1.8
	OPENBSD_4_1:1.8.0.2
	OPENBSD_4_1_BASE:1.8
	OPENBSD_4_0:1.7.0.14
	OPENBSD_4_0_BASE:1.7
	OPENBSD_3_9:1.7.0.12
	OPENBSD_3_9_BASE:1.7
	OPENBSD_3_8:1.7.0.10
	OPENBSD_3_8_BASE:1.7
	OPENBSD_3_7:1.7.0.8
	OPENBSD_3_7_BASE:1.7
	OPENBSD_3_6:1.7.0.6
	OPENBSD_3_6_BASE:1.7
	OPENBSD_3_5:1.7.0.4
	OPENBSD_3_5_BASE:1.7
	OPENBSD_3_4:1.7.0.2
	OPENBSD_3_4_BASE:1.7
	OPENBSD_3_3:1.6.0.6
	OPENBSD_3_3_BASE:1.6
	OPENBSD_3_2:1.6.0.4
	OPENBSD_3_2_BASE:1.6
	OPENBSD_3_1:1.6.0.2
	OPENBSD_3_1_BASE:1.6
	OPENBSD_3_0:1.3.0.2
	OPENBSD_3_0_BASE:1.3
	OPENBSD_2_9_BASE:1.2
	OPENBSD_2_9:1.2.0.20
	OPENBSD_2_8:1.2.0.18
	OPENBSD_2_8_BASE:1.2
	OPENBSD_2_7:1.2.0.16
	OPENBSD_2_7_BASE:1.2
	OPENBSD_2_6:1.2.0.14
	OPENBSD_2_6_BASE:1.2
	OPENBSD_2_5:1.2.0.12
	OPENBSD_2_5_BASE:1.2
	OPENBSD_2_4:1.2.0.10
	OPENBSD_2_4_BASE:1.2
	OPENBSD_2_3:1.2.0.8
	OPENBSD_2_3_BASE:1.2
	OPENBSD_2_2:1.2.0.6
	OPENBSD_2_2_BASE:1.2
	OPENBSD_2_1:1.2.0.4
	OPENBSD_2_1_BASE:1.2
	OPENBSD_2_0:1.2.0.2
	OPENBSD_2_0_BASE:1.2
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@ * @;


1.12
date	2016.03.15.04.19.13;	author mmcc;	state Exp;
branches;
next	1.11;
commitid	joKelboeRMdP9MD6;

1.11
date	2016.02.09.01.29.12;	author tb;	state Exp;
branches;
next	1.10;
commitid	O5foknAVRgIWY45X;

1.10
date	2014.04.19.09.28.20;	author sobrado;	state Exp;
branches;
next	1.9;

1.9
date	2010.10.12.17.23.21;	author millert;	state Exp;
branches;
next	1.8;

1.8
date	2007.01.28.16.37.09;	author miod;	state Exp;
branches;
next	1.7;

1.7
date	2003.06.03.02.56.09;	author millert;	state Exp;
branches;
next	1.6;

1.6
date	2002.04.08.15.59.05;	author millert;	state Exp;
branches;
next	1.5;

1.5
date	2002.02.16.21.27.47;	author millert;	state Exp;
branches;
next	1.4;

1.4
date	2001.12.30.08.17.32;	author pvalchev;	state Exp;
branches;
next	1.3;

1.3
date	2001.09.30.07.17.03;	author pvalchev;	state Exp;
branches;
next	1.2;

1.2
date	96.06.26.05.34.19;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.45.23;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.45.23;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.12
log
@ o clean up a little whitespace and formatting
 o move some declarations out of hexdump.h
 o mark some declarations as __dead or static

from Michal Mazurek, with input from and ok tb@@
@
text
@/*	$OpenBSD: hexdump.h,v 1.11 2016/02/09 01:29:12 tb Exp $	*/
/*	$NetBSD: hexdump.h,v 1.7 2001/12/07 15:14:29 bjh21 Exp $	*/

/*
 * Copyright (c) 1989, 1993
 *	The Regents of the University of California.  All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. Neither the name of the University nor the names of its contributors
 *    may be used to endorse or promote products derived from this software
 *    without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 *
 *	from: @@(#)hexdump.h	8.1 (Berkeley) 6/6/93
 */

typedef struct _pr {
	struct _pr *nextpr;		/* next print unit */
#define	F_ADDRESS	0x001		/* print offset */
#define	F_BPAD		0x002		/* blank pad */
#define	F_C		0x004		/* %_c */
#define	F_CHAR		0x008		/* %c */
#define	F_DBL		0x010		/* %[EefGf] */
#define	F_INT		0x020		/* %[di] */
#define	F_P		0x040		/* %_p */
#define	F_STR		0x080		/* %s */
#define	F_U		0x100		/* %_u */
#define	F_UINT		0x200		/* %[ouXx] */
#define	F_TEXT		0x400		/* no conversions */
	u_int flags;			/* flag values */
	int bcnt;			/* byte count */
	char *cchar;			/* conversion character */
	char *fmt;			/* printf format */
	char *nospace;			/* no whitespace version */
} PR;

typedef struct _fu {
	struct _fu *nextfu;		/* next format unit */
	struct _pr *nextpr;		/* next print unit */
#define	F_IGNORE	0x01		/* %_A */
#define	F_SETREP	0x02		/* rep count set, not default */
	u_int flags;			/* flag values */
	int reps;			/* repetition count */
	int bcnt;			/* byte count */
	char *fmt;			/* format string */
} FU;

typedef struct _fs {			/* format strings */
	struct _fs *nextfs;		/* linked list of format strings */
	struct _fu *nextfu;		/* linked list of format units */
	int bcnt;
} FS;

enum _vflag { ALL, DUP, FIRST, WAIT };	/* -v values */

extern int blocksize;			/* data block size */
extern int odmode;			/* od compatibility */
extern FU *endfu;			/* format at end-of-data */
extern int exitval;			/* final exit value */
extern FS *fshead;			/* head of format strings list */
extern long length;			/* max bytes to read */
extern off_t skip;			/* bytes to skip */
extern char *iobuf;			/* stdio I/O buffer */
extern size_t iobufsiz;			/* size of stdio I/O buffer */
extern enum _vflag vflag;

void	 add(const char *);
void	 addfile(char *);
void	 conv_c(PR *, u_char *);
void	 conv_u(PR *, u_char *);
void	 display(void);
void	 newsyntax(int, char ***);
int	 next(char **);
void	 oldsyntax(int, char ***);
void	 rewrite(FS *);
int	 size(FS *);
@


1.11
log
@For a long time, nomem() has been a wrapper for err(1, NULL) and
meanwhile emalloc() has turned into calloc() by doing malloc + memset.
Delete them and Use the libc functions directly instead. I've been
running with this diff for ages and was reminded of it by a similar
suggestion from mmcc@@ and by recent diffs from Michal Mazurek.

ok mmcc@@
@
text
@d1 1
a1 1
/*	$OpenBSD: hexdump.h,v 1.10 2014/04/19 09:28:20 sobrado Exp $	*/
d81 2
a82 2
extern char *iobuf;                            /* stdio I/O buffer */
extern size_t iobufsiz;                        /* size of stdio I/O buffer */
a86 5
void	 badcnt(char *);
void	 badconv(char *);
void	 badfmt(const char *);
void	 badsfmt(void);
void	 bpad(PR *);
a89 3
void	 doskip(const char *, int);
void	 escape(char *);
u_char	*get(void);
a94 2
void	 usage(void);
void	 oldusage(void);
@


1.10
log
@use an appropriate name for this variable.

ok millert@@
@
text
@d1 1
a1 1
/*	$OpenBSD: hexdump.h,v 1.9 2010/10/12 17:23:21 millert Exp $	*/
a95 2
/*void	 err(const char *, ...);*/
void	*emalloc(int);
a99 1
void	 nomem(void);
@


1.9
log
@If the input length was specified, use it to set the stdio buffer
size for fread().  Otherwise, stdio will read as much as it can
(using a very large buffer) which may cause a hang if the input
comes from a blocking device such as /dev/srandom.  OK deraadt@@
@
text
@d1 1
a1 1
/*	$OpenBSD: hexdump.h,v 1.8 2007/01/28 16:37:09 miod Exp $	*/
d75 1
a75 1
extern int deprecated;			/* od compatibility */
@


1.8
log
@Accept a leading 0x for the -n length parameter.

Correctly check for out-of-bounds values for -s skip parameter, and use
strtoll to parse it instead of strtol since this is an off_t value.
@
text
@d1 1
a1 1
/*	$OpenBSD: hexdump.h,v 1.7 2003/06/03 02:56:09 millert Exp $	*/
d81 2
@


1.7
log
@Remove the advertising clause in the UCB license which Berkeley
rescinded 22 July 1999.  Proofed by myself and Theo.
@
text
@d1 1
a1 1
/*	$OpenBSD: hexdump.h,v 1.6 2002/04/08 15:59:05 millert Exp $	*/
d79 1
a79 1
extern int length;			/* max bytes to read */
@


1.6
log
@Correct usage() for od syntax; Peter Stromberg
@
text
@d1 1
a1 1
/*	$OpenBSD: hexdump.h,v 1.5 2002/02/16 21:27:47 millert Exp $	*/
d16 1
a16 5
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 *	This product includes software developed by the University of
 *	California, Berkeley and its contributors.
 * 4. Neither the name of the University nor the names of its contributors
@


1.5
log
@Part one of userland __P removal.  Done with a simple regexp with some minor hand editing to make comments line up correctly.  Another pass is forthcoming that handles the cases that could not be done automatically.
@
text
@d1 1
a1 1
/*	$OpenBSD: hexdump.h,v 1.4 2001/12/30 08:17:32 pvalchev Exp $	*/
d109 1
@


1.4
log
@Changes come from NetBSD, Lite-2 and me.  ok deraadt
od(1):
- Enable support for printing 8-byte integers.
- Added -C option for hexadecimal+ASCII display.
- Fix od so it displays short files containing nulls.
- POSIXification: The C, S, I and L modifiers now behave correctly,
specifying output in units of a char, short, int and long (as defined by
the host system) respectively.  Support -N, equivalent to hexdump's
-n (format only COUNT bytes of input).  Add -j option which does the
same thing as -s in hexdump (skipping some of the input).
hexdump(1):
- POSIX.2 doesn't specify hexdump so it can't be compatible with it...
- add missing trailing \n in usage() printf
@
text
@d1 1
a1 1
/*	$OpenBSD: hexdump.h,v 1.3 2001/09/30 07:17:03 pvalchev Exp $	*/
d87 22
a108 22
void	 add __P((const char *));
void	 addfile __P((char *));
void	 badcnt __P((char *));
void	 badconv __P((char *));
void	 badfmt __P((const char *));
void	 badsfmt __P((void));
void	 bpad __P((PR *));
void	 conv_c __P((PR *, u_char *));
void	 conv_u __P((PR *, u_char *));
void	 display __P((void));
void	 doskip __P((const char *, int));
/*void	 err __P((const char *, ...));*/
void	*emalloc __P((int));
void	 escape __P((char *));
u_char	*get __P((void));
void	 newsyntax __P((int, char ***));
int	 next __P((char **));
void	 nomem __P((void));
void	 oldsyntax __P((int, char ***));
void	 rewrite __P((FS *));
int	 size __P((FS *));
void	 usage __P((void));
@


1.3
log
@-Wall cleanup; ok deraadt
@
text
@d1 3
a3 1
/* *	$OpenBSD: hexdump.h,v 1.2 1996/06/26 05:34:19 deraadt Exp $*/
d5 2
a6 2
 * Copyright (c) 1989 The Regents of the University of California.
 * All rights reserved.
d36 1
a36 1
 *	from: @@(#)hexdump.h	5.4 (Berkeley) 6/1/90
d76 6
d83 3
a85 3
extern int blocksize;			/* data block size */
enum _vflag { ALL, DUP, FIRST, WAIT };	/* -v values */
char *emalloc();
d87 22
a108 21
void	bpad __P((PR *));
void	conv_c __P((PR *, u_char *));
void	conv_u __P((PR *, u_char *));
int	next __P((char **));
void	doskip __P((char *, int));
void	nomem __P((void));
void	odoffset __P((int, char ***));
void	newsyntax __P((int, char ***));
void	oldsyntax __P((int, char ***));
int	size __P((FS *));
void	rewrite __P((FS *));
void	display __P((void));
void	badcnt __P((char *));
void	add __P((char *));
void	addfile __P((char *));
void	badcnt __P((char *));
void	badconv __P((char *));
void	badfmt __P((char *));
void	badsfmt __P((void));
void	escape __P((char *));
void	usage __P((void));
@


1.2
log
@rcsid
@
text
@d1 1
a1 1
/* *	$OpenBSD: hexdump.h,v 1.1.1.1 1995/10/18 08:45:23 deraadt Exp $*/
d78 22
@


1.1
log
@Initial revision
@
text
@d1 1
a34 1
 *	$Id: hexdump.h,v 1.2 1993/08/01 18:14:51 mycroft Exp $
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
