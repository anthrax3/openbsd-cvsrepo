head	1.10;
access;
symbols;
locks; strict;
comment	@# @;


1.10
date	2007.10.07.17.58.51;	author otto;	state dead;
branches;
next	1.9;

1.9
date	2007.09.19.15.21.07;	author todd;	state Exp;
branches;
next	1.8;

1.8
date	2007.09.19.13.35.53;	author otto;	state Exp;
branches;
next	1.7;

1.7
date	2007.09.18.10.12.10;	author otto;	state Exp;
branches;
next	1.6;

1.6
date	2007.09.17.07.20.49;	author todd;	state Exp;
branches;
next	1.5;

1.5
date	2007.09.16.19.16.58;	author kjell;	state Exp;
branches;
next	1.4;

1.4
date	2007.09.16.10.39.37;	author otto;	state Exp;
branches;
next	1.3;

1.3
date	2007.09.15.21.45.21;	author otto;	state Exp;
branches;
next	1.2;

1.2
date	2007.09.15.21.41.00;	author otto;	state Exp;
branches;
next	1.1;

1.1
date	2007.09.15.20.56.54;	author otto;	state Exp;
branches;
next	;


desc
@@


1.10
log
@reorg pcc tree; requested by and ok deraadt@@; ok ragge@@
@
text
@#	$OpenBSD: Makefile,v 1.9 2007/09/19 15:21:07 todd Exp $
#
# Makefile for the ccom part of pcc.
#

SUBDIR+= x86
#SUBDIR+= vax

.include <bsd.subdir.mk>
@


1.9
log
@add '-b machine' to cc for multiarch support
ok otto@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.8 2007/09/19 13:35:53 otto Exp $
@


1.8
log
@make it easier to support other archs; remoev some dependencies (also
submitted by pyr); from mickey@@ ok ragge@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.7 2007/09/18 10:12:10 otto Exp $
d3 1
a3 1
# Makefile for the cpp part of pcc.
a4 11
PROG=   	ccom
PREFIX=		/usr/local
BINDIR=		${PREFIX}/libexec
MANDIR=		${PREFIX}/man/man
TARGOS=		openbsd
.if ${MACHINE_ARCH} == "i386"
TARGMACH=	x86
.else
TARGMACH=	${MACHINE_ARCH}
.endif
CLEANFILES=	external.h external.c mkext
d6 2
a7 7
CFLAGS+=	-DPCC_DEBUG -DGCC_COMPAT
CFLAGS+=	-Wall -Wmissing-prototypes -Wstrict-prototypes -Werror
CFLAGS+=	-DLIBEXECDIR=\"${PREFIX}/libexec\"
CPPFLAGS+=	-I. -I${.CURDIR} -I${.CURDIR}/../../mip
CPPFLAGS+=	-I${.CURDIR}/../../arch/${TARGMACH}
CPPFLAGS+=	-I${.CURDIR}/../../os/${TARGOS}
CPPFLAGS+=      -Dmach_${TARGMACH}
d9 1
a9 25
.PATH:	${.CURDIR}/../../arch/${TARGMACH}
.PATH:	${.CURDIR}/../../mip

SRCS=optim.c pftn.c scan.l trees.c cgram.y inline.c symtabs.c \
	gcc_compat.c init.c local.c code.c stabs.c match.c reader.c optim2.c \
	regs.c local2.c order.c table.c common.c main.c external.c

cgram.c: cgram.y
	$(YACC) $(YFLAGS) -d $<
	mv y.tab.c cgram.c
	mv y.tab.h cgram.h

mkext: mkext.c table.c common.c
	$(CC) $(CPPFLAGS) $(CFLAGS) -DMKEXT -o mkext 		\
		${.CURDIR}/../../mip/mkext.c			\
		${.CURDIR}/../../arch/${TARGMACH}/table.c	\
		${.CURDIR}/../../mip/common.c

external.h external.c: mkext
	./mkext

cleandepend:
	rm -f .depend ${.CURDIR}/tags cgram.h

.include <bsd.prog.mk>
@


1.7
log
@mkext should be a seperate target; from mickey@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.6 2007/09/17 07:20:49 todd Exp $
d10 1
d12 3
a44 3

pass2.h: external.h
optim2.o reader.o: external.h
@


1.6
log
@rm unused -Dos_${TARGOS}
ok otto@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.5 2007/09/16 19:16:58 kjell Exp $
d33 1
a33 1
external.h external.c: mkext.c table.c common.c
d38 2
@


1.5
log
@change MANDIR to ${PREFIX}/man. ok otto@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.4 2007/09/16 10:39:37 otto Exp $
d19 1
a19 1
CPPFLAGS+=      -Dos_${TARGOS} -Dmach_${TARGMACH}
@


1.4
log
@remove cgram.h from CLEANFILES, so make depend; make; make clean; make
works; instead reomve cgram.h when doing make cleandir
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.3 2007/09/15 21:45:21 otto Exp $
d8 1
a8 1
MANDIR=		${PREFIX}/share/man/man
@


1.3
log
@cleanup some files generated in obj
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.2 2007/09/15 21:41:00 otto Exp $
d11 1
a11 1
CLEANFILES=	external.h external.c mkext cgram.h
d42 3
@


1.2
log
@fix man installation path
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.1 2007/09/15 20:56:54 otto Exp $
d11 1
@


1.1
log
@"un"configure, to make it possible to build in obj dir. No need to run
configure any more.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.in,v 1.1.1.1 2007/09/15 18:12:31 otto Exp $
d8 1
a8 1
MANDIR=		${PREFIX}/man1
@

