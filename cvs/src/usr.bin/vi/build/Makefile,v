head	1.24;
access;
symbols
	OPENBSD_6_2_BASE:1.24
	OPENBSD_6_1:1.24.0.6
	OPENBSD_6_1_BASE:1.24
	OPENBSD_6_0:1.24.0.2
	OPENBSD_6_0_BASE:1.24
	OPENBSD_5_9:1.23.0.2
	OPENBSD_5_9_BASE:1.23
	OPENBSD_5_8:1.21.0.6
	OPENBSD_5_8_BASE:1.21
	OPENBSD_5_7:1.21.0.2
	OPENBSD_5_7_BASE:1.21
	OPENBSD_5_6:1.18.0.8
	OPENBSD_5_6_BASE:1.18
	OPENBSD_5_5:1.18.0.6
	OPENBSD_5_5_BASE:1.18
	OPENBSD_5_4:1.18.0.2
	OPENBSD_5_4_BASE:1.18
	OPENBSD_5_3:1.17.0.2
	OPENBSD_5_3_BASE:1.17
	OPENBSD_5_2:1.16.0.36
	OPENBSD_5_2_BASE:1.16
	OPENBSD_5_1_BASE:1.16
	OPENBSD_5_1:1.16.0.34
	OPENBSD_5_0:1.16.0.32
	OPENBSD_5_0_BASE:1.16
	OPENBSD_4_9:1.16.0.30
	OPENBSD_4_9_BASE:1.16
	OPENBSD_4_8:1.16.0.28
	OPENBSD_4_8_BASE:1.16
	OPENBSD_4_7:1.16.0.24
	OPENBSD_4_7_BASE:1.16
	OPENBSD_4_6:1.16.0.26
	OPENBSD_4_6_BASE:1.16
	OPENBSD_4_5:1.16.0.22
	OPENBSD_4_5_BASE:1.16
	OPENBSD_4_4:1.16.0.20
	OPENBSD_4_4_BASE:1.16
	OPENBSD_4_3:1.16.0.18
	OPENBSD_4_3_BASE:1.16
	OPENBSD_4_2:1.16.0.16
	OPENBSD_4_2_BASE:1.16
	OPENBSD_4_1:1.16.0.14
	OPENBSD_4_1_BASE:1.16
	OPENBSD_4_0:1.16.0.12
	OPENBSD_4_0_BASE:1.16
	OPENBSD_3_9:1.16.0.10
	OPENBSD_3_9_BASE:1.16
	OPENBSD_3_8:1.16.0.8
	OPENBSD_3_8_BASE:1.16
	OPENBSD_3_7:1.16.0.6
	OPENBSD_3_7_BASE:1.16
	OPENBSD_3_6:1.16.0.4
	OPENBSD_3_6_BASE:1.16
	OPENBSD_3_5:1.16.0.2
	OPENBSD_3_5_BASE:1.16
	OPENBSD_3_4:1.15.0.10
	OPENBSD_3_4_BASE:1.15
	OPENBSD_3_3:1.15.0.8
	OPENBSD_3_3_BASE:1.15
	OPENBSD_3_2:1.15.0.6
	OPENBSD_3_2_BASE:1.15
	OPENBSD_3_1:1.15.0.4
	OPENBSD_3_1_BASE:1.15
	OPENBSD_3_0:1.15.0.2
	OPENBSD_3_0_BASE:1.15
	OPENBSD_2_9_BASE:1.13
	OPENBSD_2_9:1.13.0.6
	OPENBSD_2_8:1.13.0.4
	OPENBSD_2_8_BASE:1.13
	OPENBSD_2_7:1.13.0.2
	OPENBSD_2_7_BASE:1.13
	OPENBSD_2_6:1.12.0.2
	OPENBSD_2_6_BASE:1.12
	OPENBSD_2_5:1.11.0.4
	OPENBSD_2_5_BASE:1.11
	OPENBSD_2_4:1.11.0.2
	OPENBSD_2_4_BASE:1.11
	OPENBSD_2_3:1.10.0.4
	OPENBSD_2_3_BASE:1.10
	OPENBSD_2_2:1.10.0.2
	OPENBSD_2_2_BASE:1.10
	OPENBSD_2_1:1.6.0.4
	OPENBSD_2_1_BASE:1.6
	OPENBSD_2_0:1.6.0.2
	OPENBSD_2_0_BASE:1.6;
locks; strict;
comment	@# @;


1.24
date	2016.03.30.06.38.46;	author jmc;	state Exp;
branches;
next	1.23;
commitid	LN9ijdk9SEnzWAbM;

1.23
date	2016.01.06.22.34.45;	author millert;	state Exp;
branches;
next	1.22;
commitid	VgZmZkh1BVnaosCR;

1.22
date	2015.11.19.07.53.30;	author bentley;	state Exp;
branches;
next	1.21;
commitid	aNUlDSFtbBwW1Tdz;

1.21
date	2014.11.20.08.50.53;	author bentley;	state Exp;
branches;
next	1.20;
commitid	DAfFYTGOAzdEQS6z;

1.20
date	2014.11.14.20.26.12;	author tedu;	state Exp;
branches;
next	1.19;
commitid	WFlGLZb3PUIUZTHF;

1.19
date	2014.11.06.10.48.52;	author bentley;	state Exp;
branches;
next	1.18;
commitid	ELEZXFZ7jYF35pM3;

1.18
date	2013.06.22.18.52.52;	author miod;	state Exp;
branches;
next	1.17;

1.17
date	2012.12.20.20.28.12;	author naddy;	state Exp;
branches;
next	1.16;

1.16
date	2004.01.25.23.22.10;	author mickey;	state Exp;
branches;
next	1.15;

1.15
date	2001.09.11.22.31.29;	author heko;	state Exp;
branches;
next	1.14;

1.14
date	2001.07.20.18.48.03;	author deraadt;	state Exp;
branches;
next	1.13;

1.13
date	99.11.26.22.49.08;	author millert;	state Exp;
branches;
next	1.12;

1.12
date	99.05.29.03.50.24;	author aaron;	state Exp;
branches;
next	1.11;

1.11
date	98.07.24.00.07.34;	author millert;	state Exp;
branches;
next	1.10;

1.10
date	97.09.24.21.31.56;	author deraadt;	state Exp;
branches;
next	1.9;

1.9
date	97.09.23.07.12.42;	author downsj;	state Exp;
branches;
next	1.8;

1.8
date	97.07.27.23.29.12;	author downsj;	state Exp;
branches;
next	1.7;

1.7
date	97.07.27.22.27.53;	author downsj;	state Exp;
branches;
next	1.6;

1.6
date	96.09.22.01.03.19;	author downsj;	state Exp;
branches;
next	1.5;

1.5
date	96.08.16.17.58.13;	author michaels;	state Exp;
branches;
next	1.4;

1.4
date	96.07.24.16.15.02;	author mickey;	state Exp;
branches;
next	1.3;

1.3
date	96.06.02.05.54.38;	author tholo;	state Exp;
branches;
next	1.2;

1.2
date	96.05.28.02.24.56;	author dm;	state Exp;
branches;
next	1.1;

1.1
date	96.05.22.11.33.17;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.24
log
@for some time now mandoc has not required MLINKS to function
correctly - logically complete that now by removing MLINKS from base;

authors need only to ensure there is an entry in NAME for any function/
util being added. MLINKS will still work, and remain for perl to ease
upgrades;

ok nicm (curses) bcook (ssl)
ok schwarze, who provided a lot of feedback and assistance
ok tb natano jung
@
text
@#	$OpenBSD: Makefile,v 1.23 2016/01/06 22:34:45 millert Exp $
#	@@(#)Makefile.in	8.75 (Berkeley) 10/23/96

PROG=	vi

# Modern curses (ncurses)
CFLAGS+=-I${.CURDIR} -I${.CURDIR}/../include
LDADD+=-lcurses
DPADD+= ${LIBCURSES}

LDADD+=-lutil
DPADD+= ${LIBUTIL}

# incorrect code in vs_msg()
.if ${MACHINE_ARCH} == "sh"
CFLAGS+= -fno-tree-dominator-opts
.endif

SRCS=	cl_funcs.c cl_main.c cl_read.c cl_screen.c cl_term.c \
	cut.c delete.c ex.c ex_abbrev.c ex_append.c ex_args.c ex_argv.c \
	ex_at.c ex_bang.c ex_cd.c ex_cmd.c ex_delete.c \
	ex_display.c ex_edit.c ex_equal.c ex_file.c ex_filter.c \
	ex_global.c ex_init.c ex_join.c ex_map.c ex_mark.c ex_mkexrc.c \
	ex_move.c ex_open.c ex_preserve.c ex_print.c ex_put.c \
	ex_quit.c ex_read.c ex_screen.c ex_script.c ex_set.c ex_shell.c \
	ex_shift.c ex_source.c ex_stop.c ex_subst.c ex_tag.c \
	ex_txt.c ex_undo.c ex_usage.c ex_util.c ex_version.c ex_visual.c \
	ex_write.c ex_yank.c ex_z.c exf.c getc.c key.c line.c log.c main.c \
	mark.c msg.c options.c options_f.c put.c recover.c screen.c \
	search.c seq.c util.c v_at.c v_ch.c v_cmd.c v_delete.c v_ex.c \
	v_increment.c v_init.c v_itxt.c v_left.c v_mark.c v_match.c \
	v_paragraph.c v_put.c v_redraw.c v_replace.c v_right.c v_screen.c \
	v_scroll.c v_search.c v_section.c v_sentence.c v_status.c v_txt.c \
	v_ulcase.c v_undo.c v_util.c v_word.c v_xchar.c v_yank.c v_z.c \
	v_zexit.c vi.c vs_line.c vs_msg.c vs_refresh.c vs_relative.c \
	vs_smap.c vs_split.c

LINKS=	${BINDIR}/vi ${BINDIR}/ex
LINKS+=	${BINDIR}/vi ${BINDIR}/view

.PATH: ${.CURDIR}/../vi ${.CURDIR}/../ex ${.CURDIR}/../cl ${.CURDIR}/../common ${.CURDIR}/../docs/USD.doc/vi.man

.include "../../Makefile.inc"
.include <bsd.prog.mk>

afterinstall:
	${INSTALL} -m ${BINMODE} -o ${BINOWN} -g ${BINGRP} -c ${.CURDIR}/recover ${DESTDIR}/usr/libexec/vi.recover
@


1.23
log
@Remove the actual message catalogs.  From Martijn van Duren
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.22 2015/11/19 07:53:30 bentley Exp $
a39 2
MLINKS=	vi.1 ex.1
MLINKS+=	vi.1 view.1
@


1.22
log
@Remove cscope support in vi.

It makes no sense to keep support for a non-base tool in base, especially
for a feature that few if any people use.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.21 2014/11/20 08:50:53 bentley Exp $
a47 2
CATALOGS=	dutch english french german polish ru_RU.KOI8-R spanish \
		swedish uk_UA.KOI8-U
a48 2
	${INSTALL} -d ${DESTDIR}${SHAREDIR}/vi/catalog
	(cd ${.CURDIR}/../catalog && ${INSTALL} -m ${NONBINMODE} -c ${CATALOGS} ${DESTDIR}/usr/share/vi/catalog )
@


1.21
log
@Remove the vi perl api.

There have been various build errors for coming on two years now.
It doesn't work and nobody has expressed any interest in saving it.

From natano; ok millert@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.20 2014/11/14 20:26:12 tedu Exp $
d21 1
a21 1
	ex_at.c ex_bang.c ex_cd.c ex_cmd.c ex_cscope.c ex_delete.c \
@


1.20
log
@from natano:
The 'tcl' command in vi does nothing, except to print the message
"Vi was not loaded with a Tcl interpreter". Printing the standard
message for unknown commands would be equally descriptive with the
benefit of reducing code size.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.19 2014/11/06 10:48:52 bentley Exp $
a5 3
# Uncomment to build with an embedded perl interpreter
#PERLINTERP=	yes

d24 1
a24 1
	ex_move.c ex_open.c ex_perl.c ex_preserve.c ex_print.c ex_put.c \
a37 8
.ifdef PERLINTERP
SRCS+=	api.c perl.c perlsfio.c
PERLARCH!=perl -MConfig -e 'print $$Config{archlibexp}'
CFLAGS+=-DHAVE_PERL_5_003_01 -DHAVE_PERL_INTERP -I${PERLARCH}/CORE
LDADD+= -lperl ${PERLARCH}/auto/DynaLoader/DynaLoader.a
DPADD+= ${LIBPERL}
.endif

d43 1
a43 10
CLEANFILES+= VI.pm perl.c

.PATH: ${.CURDIR}/../vi ${.CURDIR}/../ex ${.CURDIR}/../cl ${.CURDIR}/../common ${.CURDIR}/../perl_api ${.CURDIR}/../docs/USD.doc/vi.man

perl.c: ${.CURDIR}/../perl_api/perl.xs ${.CURDIR}/../perl_api/typemap
	echo "#define _PATH_PERLSCRIPTS \"${SHAREDIR}/vi/perl\"" > ${.TARGET}
	perl /usr/libdata/perl5/ExtUtils/xsubpp -typemap \
	    /usr/libdata/perl5/ExtUtils/typemap ${.CURDIR}/../perl_api/perl.xs >> ${.TARGET}
	(perl  -ne 'print "sub $$1 {\$$curscr->$$1(\@@_)}\n" \
	    if /newXS\("VI::([^":]*)"/;' ${.TARGET} ; echo "1;") > VI.pm
a53 4
.ifdef PERLINTERP
	${INSTALL} -d ${DESTDIR}${SHAREDIR}/vi/perl
	(cd ${.CURDIR}/../perl_scripts; for i in *.pl; do ${INSTALL} -m ${NONBINMODE} -c $$i ${DESTDIR}/usr/share/vi/perl; done)
.endif
@


1.19
log
@Remove old curses support in vi.

ok nicm@@ millert@@ plus a comment tweak from nicm@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.18 2013/06/22 18:52:52 miod Exp $
d29 1
a29 1
	ex_shift.c ex_source.c ex_stop.c ex_subst.c ex_tag.c ex_tcl.c \
@


1.18
log
@Tweak optimization flags on landisk until I have time to investigate further.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.17 2012/12/20 20:28:12 naddy Exp $
a13 5
# Old BSD curses
#CFLAGS+=-I${.CURDIR} -I${.CURDIR}/../include -D_USE_OLD_CURSES_
#LDADD+= -locurses
#DPADD+= ${LIBOLDCURSES}

d22 1
a22 1
SRCS=	cl_bsd.c cl_funcs.c cl_main.c cl_read.c cl_screen.c cl_term.c \
@


1.17
log
@use openpty() rather than hand-rolled pty opening code; ok millert@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.16 2004/01/25 23:22:10 mickey Exp $
d21 5
@


1.16
log
@install all the catalogs; as cvs forgot to check this file in when those were added; millert@@ ok
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.15 2001/09/11 22:31:29 heko Exp $
d18 3
@


1.15
log
@locale ru_SU is obsolete, replace with ru_RU
mickey@@ ok
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.13 1999/11/26 22:49:08 millert Exp $
d65 2
a66 1
CATALOGS=	dutch english french german ru_RU.KOI8-R spanish swedish
@


1.14
log
@make this work, after espie changed other mk behaviours
@
text
@d65 1
a65 1
CATALOGS=	dutch english french german ru_SU.KOI8-R spanish swedish
@


1.13
log
@o Update README files etc. from nvi-1.79 so they have the correct info
o make port.h empty since we there is nothing we lack
o include <sys/param.h>, not <sys/types.h> in files that use MIN/MAX macros
o add perl api support since we have libperl (off by default)
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.12 1999/05/29 03:50:24 aaron Exp $
d62 1
a63 1
.include "../../Makefile.inc"
@


1.12
log
@MLINKS, not MLINK
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.11 1998/07/24 00:07:34 millert Exp $
d4 6
d14 1
a17 1
PROG=	vi
d38 8
d51 10
a60 1
.PATH: ${.CURDIR}/../vi ${.CURDIR}/../ex ${.CURDIR}/../cl ${.CURDIR}/../common ${.CURDIR}/../docs/USD.doc/vi.man
d67 7
a73 3
	install -d ${DESTDIR}/usr/share/vi/catalog
	(cd ${.CURDIR}/../catalog && install -m ${NONBINMODE} -c ${CATALOGS} ${DESTDIR}/usr/share/vi/catalog )
	install -m ${BINMODE} -o ${BINOWN} -g ${BINGRP} -c ${.CURDIR}/recover ${DESTDIR}/usr/libexec/vi.recover
@


1.11
log
@-D_USE_OLD_CURSE_ for -locurses and no more -ltermlib/termcap
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.10 1997/09/24 21:31:56 deraadt Exp $
d34 2
a35 2
MLINK=	vi.1 ex.1
MLINK+=	vi.1 view.1
@


1.10
log
@no, use new curses so that the build process works. reevaluate this later
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.9 1997/09/23 07:12:42 downsj Exp $
d5 2
a6 2
LDADD+=-lcurses -ltermlib
DPADD+= ${LIBCURSES} ${LIBTERMLIB}
d8 3
a10 3
#CFLAGS+=-I${.CURDIR} -I${.CURDIR}/../include -DUSE_OCURSES
#LDADD+= -locurses -ltermcap
#DPADD+= ${LIBOCURSES} ${LIBTERM}
@


1.9
log
@Make building with ocurses/termcap and curses/termlib conditional on
USE_OCURSES being defined, and define it for now.  This switches nvi back
to use BSD curses.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.8 1997/07/27 23:29:12 downsj Exp $
d4 3
a6 1
CFLAGS+=-I${.CURDIR} -I${.CURDIR}/../include -DUSE_OCURSES
d8 3
a10 2
LDADD+=	-locurses -ltermcap
DPADD+= ${LIBCURSES} ${LIBTERMLIB}
@


1.8
log
@move recover script ala 1.79.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.7 1997/07/27 22:27:53 downsj Exp $
d4 1
a4 1
CFLAGS+=-I${.CURDIR} -I${.CURDIR}/../include
d6 1
a6 1
LDADD+=	-lcurses -ltermlib
@


1.7
log
@Update to 1.79 and install as vi/ex/view.
@
text
@d1 1
a1 1
#	$OpenBSD$
d43 1
@


1.6
log
@vi -> nvi, ex -> nex
@
text
@d1 2
a2 3
#	$OpenBSD: Makefile,v 1.5 1996/08/16 17:58:13 michaels Exp $
#
# From	@@(#)Makefile.in	8.63 (Berkeley) 6/19/96
d6 4
a9 3
LDADD+= -lcurses -ltermlib
DPADD+=	${LIBCURSES} ${LIBTERMLIB}
PROG=	nvi
d29 4
a32 2
LINKS=  ${BINDIR}/nvi ${BINDIR}/nex
MLINKS= nvi.1 nex.1
d34 1
a34 2
.PATH: ${.CURDIR}/../vi ${.CURDIR}/../ex ${.CURDIR}/../cl ${.CURDIR}/../common ${.CURDIR}/../docs/USD.doc/vi.man \
#${.CURDIR}/../svi ${.CURDIR}/../sex 
d39 4
a42 5
#cat=	dutch english german ru_SU.KOI8-R swedish
#datadir=	${DESTDIR}/usr/share
#afterinstall:
#	install -d ${datadir}/vi/catalog
#	(cd ${.CURDIR}/../catalog && install -m $(NONBINMODE) -c $(cat) $(datadir)/vi/catalog )
@


1.5
log
@nvi 1.73
@
text
@d1 1
a1 1
#	$OpenBSD$
d9 1
a9 1
PROG=	vi
d29 2
a30 2
LINKS=  ${BINDIR}/vi ${BINDIR}/ex ${BINDIR}/vi ${BINDIR}/view
MLINKS= vi.1 ex.1 vi.1 view.1
@


1.4
log
@bring vi/ex up to 1.71
@
text
@d32 3
a34 1
.PATH: ${.CURDIR}/../vi ${.CURDIR}/../svi ${.CURDIR}/../ex ${.CURDIR}/../sex ${.CURDIR}/../cl ${.CURDIR}/../common ${.CURDIR}/../docs/USD.doc/vi.man
d38 5
a42 5
cat=	dutch english german ru_SU.KOI8-R swedish
datadir=	${DESTDIR}/usr/share
afterinstall:
	install -d ${datadir}/vi/catalog
	(cd ${.CURDIR}/../catalog && install -m $(NONBINMODE) -c $(cat) $(datadir)/vi/catalog )
@


1.3
log
@Always use -ltermlib when linking with -lcurses
Be consistent in use of LIBTERMCAP and LIBTERMLIB when depending
@
text
@d1 1
a1 1
#	$NetBSD: Makefile,v 1.2 1996/05/20 05:01:36 mrg Exp $
d3 1
a3 1
# from: @@(#)Makefile.in	8.56 (Berkeley) 5/18/96
@


1.2
log
@Install catalog files under ${DESTDIR}, and create
${DESTDIR}/usr/share/vi/catalog.
@
text
@d7 2
a8 1
LDADD+= -lcurses -ltermcap
@


1.1
log
@new vi
@
text
@d36 1
a36 1
datadir=	/usr/share
d38 1
@
