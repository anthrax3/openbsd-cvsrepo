head	1.13;
access;
symbols
	OPENBSD_4_8:1.12.0.34
	OPENBSD_4_8_BASE:1.12
	OPENBSD_4_7:1.12.0.30
	OPENBSD_4_7_BASE:1.12
	OPENBSD_4_6:1.12.0.32
	OPENBSD_4_6_BASE:1.12
	OPENBSD_4_5:1.12.0.28
	OPENBSD_4_5_BASE:1.12
	OPENBSD_4_4:1.12.0.26
	OPENBSD_4_4_BASE:1.12
	OPENBSD_4_3:1.12.0.24
	OPENBSD_4_3_BASE:1.12
	OPENBSD_4_2:1.12.0.22
	OPENBSD_4_2_BASE:1.12
	OPENBSD_4_1:1.12.0.20
	OPENBSD_4_1_BASE:1.12
	OPENBSD_4_0:1.12.0.18
	OPENBSD_4_0_BASE:1.12
	OPENBSD_3_9:1.12.0.16
	OPENBSD_3_9_BASE:1.12
	OPENBSD_3_8:1.12.0.14
	OPENBSD_3_8_BASE:1.12
	OPENBSD_3_7:1.12.0.12
	OPENBSD_3_7_BASE:1.12
	OPENBSD_3_6:1.12.0.10
	OPENBSD_3_6_BASE:1.12
	OPENBSD_3_5:1.12.0.8
	OPENBSD_3_5_BASE:1.12
	OPENBSD_3_4:1.12.0.6
	OPENBSD_3_4_BASE:1.12
	OPENBSD_3_3:1.12.0.4
	OPENBSD_3_3_BASE:1.12
	OPENBSD_3_2:1.12.0.2
	OPENBSD_3_2_BASE:1.12
	OPENBSD_3_1:1.11.0.2
	OPENBSD_3_1_BASE:1.11
	OPENBSD_3_0:1.10.0.2
	OPENBSD_3_0_BASE:1.10;
locks; strict;
comment	@ * @;


1.13
date	2010.10.17.08.43.20;	author djm;	state dead;
branches;
next	1.12;

1.12
date	2002.06.17.07.10.52;	author deraadt;	state Exp;
branches;
next	1.11;

1.11
date	2002.03.14.21.11.50;	author rees;	state Exp;
branches;
next	1.10;

1.10
date	2001.10.02.16.22.40;	author rees;	state Exp;
branches;
next	1.9;

1.9
date	2001.08.15.19.48.39;	author rees;	state Exp;
branches;
next	1.8;

1.8
date	2001.08.02.17.09.19;	author rees;	state Exp;
branches;
next	1.7;

1.7
date	2001.07.26.16.10.01;	author rees;	state Exp;
branches;
next	1.6;

1.6
date	2001.07.17.21.04.14;	author rees;	state Exp;
branches;
next	1.5;

1.5
date	2001.07.17.15.16.46;	author rees;	state Exp;
branches;
next	1.4;

1.4
date	2001.07.16.23.09.37;	author rees;	state Exp;
branches;
next	1.3;

1.3
date	2001.07.16.21.02.22;	author rees;	state Exp;
branches;
next	1.2;

1.2
date	2001.07.02.20.15.07;	author rees;	state Exp;
branches;
next	1.1;

1.1
date	2001.06.27.19.41.46;	author rees;	state Exp;
branches;
next	;


desc
@@


1.13
log
@remove sectok(1); it hasn't been updated in years and doesn't work
with the current generation of tokens; ok markus@@ deraadt@@
@
text
@/*	$OpenBSD: sc.h,v 1.12 2002/06/17 07:10:52 deraadt Exp $ */

/*
 * Smartcard commander.
 * Written by Jim Rees and others at University of Michigan.
 */

/*
 * copyright 2001
 * the regents of the university of michigan
 * all rights reserved
 *
 * permission is granted to use, copy, create derivative works
 * and redistribute this software and such derivative works
 * for any purpose, so long as the name of the university of
 * michigan is not used in any advertising or publicity
 * pertaining to the use or distribution of this software
 * without specific, written prior authorization.  if the
 * above copyright notice or any other identification of the
 * university of michigan is included in any copy of any
 * portion of this software, then the disclaimer below must
 * also be included.
 *
 * this software is provided as is, without representation
 * from the university of michigan as to its fitness for any
 * purpose, and without warranty by the university of
 * michigan of any kind, either express or implied, including
 * without limitation the implied warranties of
 * merchantability and fitness for a particular purpose. the
 * regents of the university of michigan shall not be liable
 * for any damages, including special, indirect, incidental, or
 * consequential damages, with respect to any claim arising
 * out of or in connection with the use of the software, even
 * if it has been or is hereafter advised of the possibility of
 * such damages.
 */

extern int port, fd, cla, aut0_vfyd;
extern FILE *cmdf;

extern struct dispatchtable {
	char	*cmd, *help;
	int	(*action) (int argc, char *argv[]);
} dispatch_table[];

int	dispatch(int argc, char *argv[]);
int	help(int argc, char *argv[]);
int	reset(int argc, char *argv[]);
int	dclose(int argc, char *argv[]);
int	quit(int argc, char *argv[]);
int	apdu(int argc, char *argv[]);
int	selfid(int argc, char *argv[]);
int	isearch(int argc, char *argv[]);
int	csearch(int argc, char *argv[]);
int	class(int argc, char *argv[]);
int	dread(int argc, char *argv[]);
int	dwrite(int argc, char *argv[]);
int	challenge(int argc, char *argv[]);
int	vfypin(int argc, char *argv[]);
int	chpin(int argc, char *argv[]);
int	ls(int argc, char *argv[]);
int	acl(int argc, char *argv[]);
int	jcreate(int argc, char *argv[]);
int	jdelete(int argc, char *argv[]);
int	jdefault(int argc, char *argv[]);
int	jatr(int argc, char *argv[]);
int	jdata(int argc, char *argv[]);
int	jlogin(int argc, char *argv[]);
int	jaut(int argc, char *argv[]);
int	jload(int argc, char *argv[]);
int	junload(int argc, char *argv[]);
int	jsetpass(int argc, char *argv[]);
@


1.12
log
@make this readable.  If I broke something, someone else gets to fix it now that we can read it
@
text
@d1 1
a1 1
/*	$OpenBSD: sc.h,v 1.11 2002/03/14 21:11:50 rees Exp $ */
@


1.11
log
@Add 'pin' and 'chpin' commands
@
text
@d1 1
a1 1
/* $Id: sc.h,v 1.10 2001/10/02 16:22:40 rees Exp $ */
d9 28
a36 28
copyright 2001
the regents of the university of michigan
all rights reserved

permission is granted to use, copy, create derivative works 
and redistribute this software and such derivative works 
for any purpose, so long as the name of the university of 
michigan is not used in any advertising or publicity 
pertaining to the use or distribution of this software 
without specific, written prior authorization.  if the 
above copyright notice or any other identification of the 
university of michigan is included in any copy of any 
portion of this software, then the disclaimer below must 
also be included.

this software is provided as is, without representation 
from the university of michigan as to its fitness for any 
purpose, and without warranty by the university of 
michigan of any kind, either express or implied, including 
without limitation the implied warranties of 
merchantability and fitness for a particular purpose. the 
regents of the university of michigan shall not be liable 
for any damages, including special, indirect, incidental, or 
consequential damages, with respect to any claim arising 
out of or in connection with the use of the software, even 
if it has been or is hereafter advised of the possibility of 
such damages.
*/
d42 2
a43 2
    char *cmd, *help;
    int (*action) (int ac, char *av[]);
d46 27
a72 27
int dispatch(int ac, char *av[]);
int help(int ac, char *av[]);
int reset(int ac, char *av[]);
int dclose(int ac, char *av[]);
int quit(int ac, char *av[]);
int apdu(int ac, char *av[]);
int selfid(int ac, char *av[]);
int isearch(int ac, char *av[]);
int csearch(int ac, char *av[]);
int class(int ac, char *av[]);
int dread(int ac, char *av[]);
int dwrite(int ac, char *av[]);
int challenge(int ac, char *av[]);
int vfypin(int ac, char *av[]);
int chpin(int ac, char *av[]);
int ls(int ac, char *av[]);
int acl(int ac, char *av[]);
int jcreate(int ac, char *av[]);
int jdelete(int ac, char *av[]);
int jdefault(int ac, char *av[]);
int jatr(int ac, char *av[]);
int jdata(int ac, char *av[]);
int jlogin(int ac, char *av[]);
int jaut(int ac, char *av[]);
int jload(int ac, char *av[]);
int junload(int ac, char *av[]);
int jsetpass(int ac, char *av[]);
@


1.10
log
@add csearch
call sectok_close on exit
@
text
@d1 1
a1 1
/* $Id: sc.h,v 1.4 2001/08/24 22:11:48 rees Exp $ */
d59 2
@


1.9
log
@Merge latest CITI code:
add "challenge" command
get file length in "f" and use it in "read"
PalmOS changes we don't care about
@
text
@d1 1
a1 1
/* $Id: sc.h,v 1.3 2001/08/15 19:41:05 rees Exp $ */
d54 1
@


1.8
log
@Mods for PalmOS
@
text
@d1 1
a1 1
/* $Id: sc.h,v 1.2 2001/08/01 21:53:25 rees Exp $ */
d57 1
@


1.7
log
@fid command now selects aids too
remove jselect
port numbers are now 0-based
print friendly aid names
@
text
@d1 1
a1 1
/* $Id: sc.h,v 1.6 2001/07/17 21:04:14 rees Exp $ */
d40 5
@


1.6
log
@now you can display and set acls
use sectok_apdu for "apdu" command
@
text
@d1 1
a1 1
/* $Id: sc.h,v 1.5 2001/07/17 15:16:46 rees Exp $ */
a62 2
int jselect(int ac, char *av[]);
int jdeselect(int ac, char *av[]);
@


1.5
log
@change jaut back to previous behavior; add new "login" command
@
text
@d1 1
a1 1
/* $Id: sc.h,v 1.4 2001/07/16 23:09:37 rees Exp $ */
d53 1
@


1.4
log
@add setpass command
augment jaut with "-d" (use default AUT0) and -x
@
text
@d1 1
a1 1
/* $Id: sc.h,v 1.3 2001/07/16 21:02:22 rees Exp $ */
d58 1
@


1.3
log
@add help text for each command
verify aut0 as necessary for Cyberflex commands
@
text
@d1 1
a1 1
/* $Id: sc.h,v 1.2 2001/07/02 20:15:07 rees Exp $ */
d63 1
@


1.2
log
@libsectok functions now take status word instead of bytes
add create, delete, isearch
@
text
@d1 1
a1 1
/* $Id: sc.h,v 1.1 2001/06/27 19:41:46 rees Exp $ */
d38 1
a38 1
extern int port, fd, cla;
@


1.1
log
@sectok control program
@
text
@d1 1
a1 1
/* $Id: $ */
d38 1
a38 1
extern int fd, cla;
d48 1
d53 2
@

