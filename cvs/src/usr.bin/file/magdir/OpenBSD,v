head	1.13;
access;
symbols
	OPENBSD_6_2:1.13.0.42
	OPENBSD_6_2_BASE:1.13
	OPENBSD_6_1:1.13.0.44
	OPENBSD_6_1_BASE:1.13
	OPENBSD_6_0:1.13.0.40
	OPENBSD_6_0_BASE:1.13
	OPENBSD_5_9:1.13.0.36
	OPENBSD_5_9_BASE:1.13
	OPENBSD_5_8:1.13.0.38
	OPENBSD_5_8_BASE:1.13
	OPENBSD_5_7:1.13.0.30
	OPENBSD_5_7_BASE:1.13
	OPENBSD_5_6:1.13.0.34
	OPENBSD_5_6_BASE:1.13
	OPENBSD_5_5:1.13.0.32
	OPENBSD_5_5_BASE:1.13
	OPENBSD_5_4:1.13.0.28
	OPENBSD_5_4_BASE:1.13
	OPENBSD_5_3:1.13.0.26
	OPENBSD_5_3_BASE:1.13
	OPENBSD_5_2:1.13.0.24
	OPENBSD_5_2_BASE:1.13
	OPENBSD_5_1_BASE:1.13
	OPENBSD_5_1:1.13.0.22
	OPENBSD_5_0:1.13.0.20
	OPENBSD_5_0_BASE:1.13
	OPENBSD_4_9:1.13.0.18
	OPENBSD_4_9_BASE:1.13
	OPENBSD_4_8:1.13.0.16
	OPENBSD_4_8_BASE:1.13
	OPENBSD_4_7:1.13.0.12
	OPENBSD_4_7_BASE:1.13
	OPENBSD_4_6:1.13.0.14
	OPENBSD_4_6_BASE:1.13
	OPENBSD_4_5:1.13.0.10
	OPENBSD_4_5_BASE:1.13
	OPENBSD_4_4:1.13.0.8
	OPENBSD_4_4_BASE:1.13
	OPENBSD_4_3:1.13.0.6
	OPENBSD_4_3_BASE:1.13
	OPENBSD_4_2:1.13.0.4
	OPENBSD_4_2_BASE:1.13
	OPENBSD_4_1:1.13.0.2
	OPENBSD_4_1_BASE:1.13
	OPENBSD_4_0:1.12.0.10
	OPENBSD_4_0_BASE:1.12
	OPENBSD_3_9:1.12.0.8
	OPENBSD_3_9_BASE:1.12
	OPENBSD_3_8:1.12.0.6
	OPENBSD_3_8_BASE:1.12
	OPENBSD_3_7:1.12.0.4
	OPENBSD_3_7_BASE:1.12
	OPENBSD_3_6:1.12.0.2
	OPENBSD_3_6_BASE:1.12
	OPENBSD_3_5:1.10.0.2
	OPENBSD_3_5_BASE:1.10
	OPENBSD_3_4:1.6.0.6
	OPENBSD_3_4_BASE:1.6
	OPENBSD_3_3:1.6.0.4
	OPENBSD_3_3_BASE:1.6
	OPENBSD_3_2:1.6.0.2
	OPENBSD_3_2_BASE:1.6
	OPENBSD_3_1:1.5.0.2
	OPENBSD_3_1_BASE:1.5
	OPENBSD_3_0:1.3.0.20
	OPENBSD_3_0_BASE:1.3
	OPENBSD_2_9_BASE:1.3
	OPENBSD_2_9:1.3.0.18
	OPENBSD_2_8:1.3.0.16
	OPENBSD_2_8_BASE:1.3
	OPENBSD_2_7:1.3.0.14
	OPENBSD_2_7_BASE:1.3
	OPENBSD_2_6:1.3.0.12
	OPENBSD_2_6_BASE:1.3
	OPENBSD_2_5:1.3.0.10
	OPENBSD_2_5_BASE:1.3
	OPENBSD_2_4:1.3.0.8
	OPENBSD_2_4_BASE:1.3
	OPENBSD_2_3:1.3.0.6
	OPENBSD_2_3_BASE:1.3
	OPENBSD_2_2:1.3.0.4
	OPENBSD_2_2_BASE:1.3
	OPENBSD_2_1:1.3.0.2
	OPENBSD_2_1_BASE:1.3
	OPENBSD_2_0:1.2.0.2
	OPENBSD_2_0_BASE:1.2;
locks; strict;
comment	@# @;


1.13
date	2007.02.27.21.07.10;	author miod;	state Exp;
branches;
next	1.12;

1.12
date	2004.08.10.19.32.49;	author deraadt;	state Exp;
branches;
next	1.11;

1.11
date	2004.06.03.03.14.19;	author tedu;	state Exp;
branches;
next	1.10;

1.10
date	2004.03.23.17.57.13;	author miod;	state Exp;
branches;
next	1.9;

1.9
date	2004.02.03.16.31.23;	author drahn;	state Exp;
branches;
next	1.8;

1.8
date	2003.12.07.03.42.58;	author deraadt;	state Exp;
branches;
next	1.7;

1.7
date	2003.12.07.03.40.23;	author deraadt;	state Exp;
branches;
next	1.6;

1.6
date	2002.05.14.20.21.37;	author deraadt;	state Exp;
branches;
next	1.5;

1.5
date	2002.03.28.07.01.36;	author deraadt;	state Exp;
branches;
next	1.4;

1.4
date	2001.11.10.08.50.39;	author hugh;	state Exp;
branches;
next	1.3;

1.3
date	97.02.09.22.49.04;	author millert;	state Exp;
branches;
next	1.2;

1.2
date	96.04.21.23.42.50;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	96.01.02.11.51.01;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.13
log
@Recognize OpenBSD/sh core dumps.
@
text
@#	$OpenBSD: OpenBSD,v 1.12 2004/08/10 19:32:49 deraadt Exp $

#------------------------------------------------------------------------------
# OpenBSD:  file(1) magic for OpenBSD objects
#
# All new-style magic numbers are in network byte order.
#

0	lelong			000000407	OpenBSD little-endian object file
>16	lelong			>0		not stripped
0	belong			000000407	OpenBSD big-endian object file
>16	belong			>0		not stripped

0	belong&0377777777	041400413	OpenBSD/i386 demand paged
>0	byte			&0x80		
>>20	lelong			<4096		shared library
>>20	lelong			=4096		dynamically linked executable
>>20	lelong			>4096		dynamically linked executable
>0	byte			^0x80		executable
>16	lelong			>0		not stripped
0	belong&0377777777	041400410	OpenBSD/i386 pure
>0	byte			&0x80		dynamically linked executable
>0	byte			^0x80		executable
>16	lelong			>0		not stripped
0	belong&0377777777	041400407	OpenBSD/i386
>0	byte			&0x80		dynamically linked executable
>0	byte			^0x80
>>0	byte			&0x40		position independent
>>20	lelong			!0		executable
>>20	lelong			=0		object file
>16	lelong			>0		not stripped
0	belong&0377777777	041400507	OpenBSD/i386 core
>12	string			>\0		from '%s'

0	belong&0377777777	041600413	OpenBSD/m68k demand paged
>0	byte			&0x80		
>>20	belong			<8192		shared library
>>20	belong			=8192		dynamically linked executable
>>20	belong			>8192		dynamically linked executable
>0	byte			^0x80		executable
>16	belong			>0		not stripped
0	belong&0377777777	041600410	OpenBSD/m68k pure
>0	byte			&0x80		dynamically linked executable
>0	byte			^0x80		executable
>16	belong			>0		not stripped
0	belong&0377777777	041600407	OpenBSD/m68k
>0	byte			&0x80		dynamically linked executable
>0	byte			^0x80
>>0	byte			&0x40		position independent
>>20	belong			!0		executable
>>20	belong			=0		object file
>16	belong			>0		not stripped
0	belong&0377777777	041600507	OpenBSD/m68k core
>12	string			>\0		from '%s'

0	belong&0377777777	046200413	OpenBSD/m88k demand paged
>0	byte			&0x80		
>>20	belong			<8192		shared library
>>20	belong			=8192		dynamically linked executable
>>20	belong			>8192		dynamically linked executable
>0	byte			^0x80		executable
>16	belong			>0		not stripped
0	belong&0377777777	046200410	OpenBSD/m88k pure
>0	byte			&0x80		dynamically linked executable
>0	byte			^0x80		executable
>16	belong			>0		not stripped
0	belong&0377777777	046200407	OpenBSD/m88k
>0	byte			&0x80		dynamically linked executable
>0	byte			^0x80
>>0	byte			&0x40		position independent
>>20	belong			!0		executable
>>20	belong			=0		object file
>16	belong			>0		not stripped
0	belong&0377777777	046200507	OpenBSD/m88k core
>12	string			>\0		from '%s'

0	belong&0377777777	042000413	OpenBSD/m68k4k demand paged
>0	byte			&0x80		
>>20	belong			<4096		shared library
>>20	belong			=4096		dynamically linked executable
>>20	belong			>4096		dynamically linked executable
>0	byte			^0x80		executable
>16	belong			>0		not stripped
0	belong&0377777777	042000410	OpenBSD/m68k4k pure
>0	byte			&0x80		dynamically linked executable
>0	byte			^0x80		executable
>16	belong			>0		not stripped
0	belong&0377777777	042000407	OpenBSD/m68k4k
>0	byte			&0x80		dynamically linked executable
>0	byte			^0x80
>>0	byte			&0x40		position independent
>>20	belong			!0		executable
>>20	belong			=0		object file
>16	belong			>0		not stripped
0	belong&0377777777	042000507	OpenBSD/m68k4k core
>12	string			>\0		from '%s'

0	belong&0377777777	042200413	OpenBSD/ns32532 demand paged
>0	byte			&0x80		
>>20	lelong			<4096		shared library
>>20	lelong			=4096		dynamically linked executable
>>20	lelong			>4096		dynamically linked executable
>0	byte			^0x80		executable
>16	lelong			>0		not stripped
0	belong&0377777777	042200410	OpenBSD/ns32532 pure
>0	byte			&0x80		dynamically linked executable
>0	byte			^0x80		executable
>16	lelong			>0		not stripped
0	belong&0377777777	042200407	OpenBSD/ns32532
>0	byte			&0x80		dynamically linked executable
>0	byte			^0x80
>>0	byte			&0x40		position independent
>>20	lelong			!0		executable
>>20	lelong			=0		object file
>16	lelong			>0		not stripped
0	belong&0377777777	042200507	OpenBSD/ns32532 core
>12	string			>\0		from '%s'

0	belong&0377777777	042400413	OpenBSD/sparc demand paged
>0	byte			&0x80		
>>20	belong			<8192		shared library
>>20	belong			=8192		dynamically linked executable
>>20	belong			>8192		dynamically linked executable
>0	byte			^0x80		executable
>16	belong			>0		not stripped
0	belong&0377777777	042400410	OpenBSD/sparc pure
>0	byte			&0x80		dynamically linked executable
>0	byte			^0x80		executable
>16	belong			>0		not stripped
0	belong&0377777777	042400407	OpenBSD/sparc
>0	byte			&0x80		dynamically linked executable
>0	byte			^0x80
>>0	byte			&0x40		position independent
>>20	belong			!0		executable
>>20	belong			=0		object file
>16	belong			>0		not stripped
0	belong&0377777777	042400507	OpenBSD/sparc core
>12	string			>\0		from '%s'

0	belong&0377777777	042600413	OpenBSD/pmax demand paged
>0	byte			&0x80		
>>20	lelong			<4096		shared library
>>20	lelong			=4096		dynamically linked executable
>>20	lelong			>4096		dynamically linked executable
>0	byte			^0x80		executable
>16	lelong			>0		not stripped
0	belong&0377777777	042600410	OpenBSD/pmax pure
>0	byte			&0x80		dynamically linked executable
>0	byte			^0x80		executable
>16	lelong			>0		not stripped
0	belong&0377777777	042600407	OpenBSD/pmax
>0	byte			&0x80		dynamically linked executable
>0	byte			^0x80
>>0	byte			&0x40		position independent
>>20	lelong			!0		executable
>>20	lelong			=0		object file
>16	lelong			>0		not stripped
0	belong&0377777777	042600507	OpenBSD/pmax core
>12	string			>\0		from '%s'

0	belong&0377777777	043000413	OpenBSD/vax1k demand paged
>0	byte			&0x80		
>>20	lelong			<4096		shared library
>>20	lelong			=4096		dynamically linked executable
>>20	lelong			>4096		dynamically linked executable
>0	byte			^0x80		executable
>16	lelong			>0		not stripped
0	belong&0377777777	043000410	OpenBSD/vax1k pure
>0	byte			&0x80		dynamically linked executable
>0	byte			^0x80		executable
>16	lelong			>0		not stripped
0	belong&0377777777	043000407	OpenBSD/vax1k
>0	byte			&0x80		dynamically linked executable
>0	byte			^0x80
>>0	byte			&0x40		position independent
>>20	lelong			!0		executable
>>20	lelong			=0		object file
>16	lelong			>0		not stripped
0	belong&0377777777	043000507	OpenBSD/vax1k core
>12	string			>\0		from '%s'

0	belong&0377777777	045400413	OpenBSD/vax demand paged
>0	byte			&0x80		
>>20	lelong			<4096		shared library
>>20	lelong			=4096		dynamically linked executable
>>20	lelong			>4096		dynamically linked executable
>0	byte			^0x80		executable
>16	lelong			>0		not stripped
0	belong&0377777777	045400410	OpenBSD/vax pure
>0	byte			&0x80		dynamically linked executable
>0	byte			^0x80		executable
>16	lelong			>0		not stripped
0	belong&0377777777	045400407	OpenBSD/vax
>0	byte			&0x80		dynamically linked executable
>0	byte			^0x80
>>0	byte			&0x40		position independent
>>20	lelong			!0		executable
>>20	lelong			=0		object file
>16	lelong			>0		not stripped
0	belong&0377777777	045400507	OpenBSD/vax core
>12	string			>\0		from '%s'

# OpenBSD/alpha does not support (and has never supported) a.out objects,
# so no rules are provided for them.  OpenBSD/alpha ELF objects are 
# dealt with in "elf".
0	leshort		0x00070185		ECOFF OpenBSD/alpha binary
>10	leshort		0x0001			not stripped
>10	leshort		0x0000			stripped
0	belong&0377777777	043200507	OpenBSD/alpha core
>12	string			>\0		from '%s'

# OpenBSD/powerpc core files
0	belong&0377777777	045200507	OpenBSD/powerpc core
>12	string			>\0		from '%s'

# OpenBSD/sparc64 core files
0	belong&0377777777	045600507	OpenBSD/sparc64 core
>12	string			>\0		from '%s'

# OpenBSD/hppa core files
0	belong&0377777777	046400507	OpenBSD/hppa core
>12	string			>\0		from '%s'

# OpenBSD/mips64
0	belong&0377777777	047400413	OpenBSD/mips64 demand paged
>0	byte			&0x80		
>>20	belong			<8192		shared library
>>20	belong			=8192		dynamically linked executable
>>20	belong			>8192		dynamically linked executable
>0	byte			^0x80		executable
>16	belong			>0		not stripped
0	belong&0377777777	047400410	OpenBSD/mips64 pure
>0	byte			&0x80		dynamically linked executable
>0	byte			^0x80		executable
>16	belong			>0		not stripped
0	belong&0377777777	047400407	OpenBSD/mips64
>0	byte			&0x80		dynamically linked executable
>0	byte			^0x80
>>0	byte			&0x40		position independent
>>20	belong			!0		executable
>>20	belong			=0		object file
>16	belong			>0		not stripped
0	belong&0377777777	047400507	OpenBSD/mips64 core
>12	string			>\0		from '%s'

0	belong&0377777777	043600413	OpenBSD/arm demand paged
>0	byte			&0x80
>>20	lelong			<8192		shared library
>>20	lelong			=8192		dynamically linked executable
>>20	lelong			>8192		dynamically linked executable
>0	byte			^0x80		executable
>16	lelong			>0		not stripped
0	belong&0377777777	043600410	OpenBSD/arm pure
>0	byte			&0x80		dynamically linked executable
>0	byte			^0x80		executable
>16	lelong			>0		not stripped
0	belong&0377777777	043600407	OpenBSD/arm
>0	byte			&0x80		dynamically linked executable
>0	byte			^0x80
>>0	byte			&0x40		position independent
>>20	lelong			!0		executable
>>20	lelong			=0		object file
>16	lelong			>0		not stripped
0	belong&0377777777	043600507	OpenBSD/arm core
>12	string			>\0		from '%s'
0	belong&0377777777	047200507	OpenBSD/amd64 core
>12	string			>\0		from '%s'
0	belong&0377777777	044200507	OpenBSD/sh core
>12	string			>\0		from '%s'
@


1.12
log
@put mips64 core file recognition (someone please test)
@
text
@d1 1
a1 1
#	$OpenBSD: OpenBSD,v 1.11 2004/06/03 03:14:19 tedu Exp $
d267 2
@


1.11
log
@merge in new magic from file 4.09.  Mostly from Bruno Rohee
@
text
@d1 1
a1 1
#	$OpenBSD$
d224 2
a225 2
# OpenBSD/mips
0	belong&0377777777	043400413	OpenBSD/mips demand paged
d232 1
a232 1
0	belong&0377777777	043400410	OpenBSD/mips pure
d236 1
a236 1
0	belong&0377777777	043400407	OpenBSD/mips
d243 1
a243 1
0	belong&0377777777	043400507	OpenBSD/mips core
@


1.10
log
@Recognize amd64 binaries and coredumps; ok todd@@ deraadt@@ drahn@@
@
text
@d1 1
@


1.9
log
@Recognize openbsd arm executables and corefiles. ok deraadt@@
@
text
@d265 2
@


1.8
log
@remove duplicate chunk
@
text
@d245 1
a245 1
0	belong&0377777777	043600413	OpenBSD/arm32 demand paged
d252 1
a252 1
0	belong&0377777777	043600410	OpenBSD/arm32 pure
d256 1
a256 1
0	belong&0377777777	043600407	OpenBSD/arm32
d263 1
a263 1
0	belong&0377777777	043600507	OpenBSD/arm32 core
@


1.7
log
@m88k parts
@
text
@a218 4
# OpenBSD/m88k core files
0	belong&0377777777	046200507	OpenBSD/m88k core
>12	string			>\0		from '%s'

@


1.6
log
@know powerpc core files
@
text
@d55 21
@


1.5
log
@core files from new processors
@
text
@d190 4
@


1.4
log
@Additional vax magic to cover bins with new MID and 4k page size.
Also to get Theo monkey off my back.
@
text
@d190 13
@


1.3
log
@Updated from NetBSD.
@
text
@d139 1
a139 1
0	belong&0377777777	043000413	OpenBSD/vax demand paged
d146 1
a146 1
0	belong&0377777777	043000410	OpenBSD/vax pure
d150 1
a150 1
0	belong&0377777777	043000407	OpenBSD/vax
d157 22
a178 1
0	belong&0377777777	043000507	OpenBSD/vax core
@


1.2
log
@sync to netbsd 960418
@
text
@a6 13
0	lelong			000000413	386BSD demand paged executable
>16	lelong			>0		not stripped
0	lelong			000000314	BSDI demand paged executable
>16	lelong			>0		not stripped
>32	byte			0x6a		(uses shared libs)

0       lelong&077777777        041400314       FreeBSD/i386 demand paged
>3      byte                    &0x80
>>20    lelong                  <4096           shared library
>>20    lelong                  =4096           dynamically linked executable
>>20    lelong                  >4096           dynamically linked executable
>3      byte                    ^0x80           executable
>16     lelong                  >0              not stripped
d160 9
d190 1
a190 1
0	belong&0377777777	043600413	NetBSD/arm32 demand paged
d197 1
a197 1
0	belong&0377777777	043600410	NetBSD/arm32 pure
d201 1
a201 1
0	belong&0377777777	043600407	NetBSD/arm32
d208 1
a208 1
0	belong&0377777777	043600507	NetBSD/arm32 core
@


1.1
log
@netbsd -> openbsd
@
text
@d13 7
d192 21
@
