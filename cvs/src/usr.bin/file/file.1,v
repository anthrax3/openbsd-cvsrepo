head	1.44;
access;
symbols
	OPENBSD_6_0:1.44.0.4
	OPENBSD_6_0_BASE:1.44
	OPENBSD_5_9:1.44.0.2
	OPENBSD_5_9_BASE:1.44
	OPENBSD_5_8:1.43.0.4
	OPENBSD_5_8_BASE:1.43
	OPENBSD_5_7:1.35.0.2
	OPENBSD_5_7_BASE:1.35
	OPENBSD_5_6:1.34.0.10
	OPENBSD_5_6_BASE:1.34
	OPENBSD_5_5:1.34.0.8
	OPENBSD_5_5_BASE:1.34
	OPENBSD_5_4:1.34.0.4
	OPENBSD_5_4_BASE:1.34
	OPENBSD_5_3:1.34.0.2
	OPENBSD_5_3_BASE:1.34
	OPENBSD_5_2:1.33.0.8
	OPENBSD_5_2_BASE:1.33
	OPENBSD_5_1_BASE:1.33
	OPENBSD_5_1:1.33.0.6
	OPENBSD_5_0:1.33.0.4
	OPENBSD_5_0_BASE:1.33
	OPENBSD_4_9:1.33.0.2
	OPENBSD_4_9_BASE:1.33
	OPENBSD_4_8:1.31.0.4
	OPENBSD_4_8_BASE:1.31
	OPENBSD_4_7:1.31.0.2
	OPENBSD_4_7_BASE:1.31
	OPENBSD_4_6:1.28.0.12
	OPENBSD_4_6_BASE:1.28
	OPENBSD_4_5:1.28.0.8
	OPENBSD_4_5_BASE:1.28
	OPENBSD_4_4:1.28.0.6
	OPENBSD_4_4_BASE:1.28
	OPENBSD_4_3:1.28.0.4
	OPENBSD_4_3_BASE:1.28
	OPENBSD_4_2:1.28.0.2
	OPENBSD_4_2_BASE:1.28
	OPENBSD_4_1:1.26.0.2
	OPENBSD_4_1_BASE:1.26
	OPENBSD_4_0:1.23.0.8
	OPENBSD_4_0_BASE:1.23
	OPENBSD_3_9:1.23.0.6
	OPENBSD_3_9_BASE:1.23
	OPENBSD_3_8:1.23.0.4
	OPENBSD_3_8_BASE:1.23
	OPENBSD_3_7:1.23.0.2
	OPENBSD_3_7_BASE:1.23
	OPENBSD_3_6:1.21.0.6
	OPENBSD_3_6_BASE:1.21
	OPENBSD_3_5:1.21.0.4
	OPENBSD_3_5_BASE:1.21
	OPENBSD_3_4:1.21.0.2
	OPENBSD_3_4_BASE:1.21
	OPENBSD_3_3:1.19.0.2
	OPENBSD_3_3_BASE:1.19
	OPENBSD_3_2:1.16.0.4
	OPENBSD_3_2_BASE:1.16
	OPENBSD_3_1:1.16.0.2
	OPENBSD_3_1_BASE:1.16
	OPENBSD_3_0:1.15.0.2
	OPENBSD_3_0_BASE:1.15
	OPENBSD_2_9_BASE:1.13
	OPENBSD_2_9:1.13.0.2
	OPENBSD_2_8:1.10.0.2
	OPENBSD_2_8_BASE:1.10
	OPENBSD_2_7:1.9.0.2
	OPENBSD_2_7_BASE:1.9
	OPENBSD_2_6:1.6.0.2
	OPENBSD_2_6_BASE:1.6
	OPENBSD_2_5:1.5.0.2
	OPENBSD_2_5_BASE:1.5
	OPENBSD_2_4:1.4.0.8
	OPENBSD_2_4_BASE:1.4
	OPENBSD_2_3:1.4.0.6
	OPENBSD_2_3_BASE:1.4
	OPENBSD_2_2:1.4.0.4
	OPENBSD_2_2_BASE:1.4
	OPENBSD_2_1:1.4.0.2
	OPENBSD_2_1_BASE:1.4
	OPENBSD_2_0:1.3.0.2
	OPENBSD_2_0_BASE:1.3
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@.\" @;


1.44
date	2015.12.24.11.45.34;	author jca;	state Exp;
branches;
next	1.43;
commitid	RIVtYu1RhflEh8Tu;

1.43
date	2015.07.30.11.13.24;	author jmc;	state Exp;
branches;
next	1.42;
commitid	SzlRup3sCYt52BBF;

1.42
date	2015.05.30.06.25.35;	author nicm;	state Exp;
branches;
next	1.41;
commitid	03wotVZX3iCHcRkm;

1.41
date	2015.04.27.11.12.49;	author jmc;	state Exp;
branches;
next	1.40;
commitid	2ruTvr1SLGTTqJzi;

1.40
date	2015.04.26.22.51.32;	author nicm;	state Exp;
branches;
next	1.39;
commitid	mtXIburVXEyiHueG;

1.39
date	2015.04.24.20.57.51;	author nicm;	state Exp;
branches;
next	1.38;
commitid	xEEYb3gX7Eb431jS;

1.38
date	2015.04.24.20.32.34;	author jmc;	state Exp;
branches;
next	1.37;
commitid	BTISQzFMfuLOo2eM;

1.37
date	2015.04.24.17.34.57;	author nicm;	state Exp;
branches;
next	1.36;
commitid	CaRea3jzwV1rFe2T;

1.36
date	2015.04.24.16.24.11;	author nicm;	state Exp;
branches;
next	1.35;
commitid	4VUU04TZM8ebPiy4;

1.35
date	2015.02.15.22.26.45;	author bentley;	state Exp;
branches;
next	1.34;
commitid	szmpRDHaqpG6RctM;

1.34
date	2013.01.17.21.29.14;	author jmc;	state Exp;
branches;
next	1.33;

1.33
date	2010.10.28.21.32.54;	author jmc;	state Exp;
branches;
next	1.32;

1.32
date	2010.09.03.11.09.28;	author jmc;	state Exp;
branches;
next	1.31;

1.31
date	2010.01.02.20.15.15;	author schwarze;	state Exp;
branches;
next	1.30;

1.30
date	2009.10.26.21.03.03;	author ajacoutot;	state Exp;
branches;
next	1.29;

1.29
date	2009.08.16.09.41.08;	author sobrado;	state Exp;
branches;
next	1.28;

1.28
date	2007.05.31.19.20.09;	author jmc;	state Exp;
branches;
next	1.27;

1.27
date	2007.03.29.11.34.41;	author jmc;	state Exp;
branches;
next	1.26;

1.26
date	2007.02.28.07.41.07;	author david;	state Exp;
branches;
next	1.25;

1.25
date	2007.02.24.23.52.07;	author ian;	state Exp;
branches;
next	1.24;

1.24
date	2007.02.19.13.02.08;	author tom;	state Exp;
branches;
next	1.23;

1.23
date	2004.12.04.19.55.12;	author jaredy;	state Exp;
branches;
next	1.22;

1.22
date	2004.10.14.20.56.57;	author jaredy;	state Exp;
branches;
next	1.21;

1.21
date	2003.06.13.18.31.14;	author deraadt;	state Exp;
branches;
next	1.20;

1.20
date	2003.06.10.09.12.10;	author jmc;	state Exp;
branches;
next	1.19;

1.19
date	2003.03.11.21.26.26;	author ian;	state Exp;
branches;
next	1.18;

1.18
date	2003.02.15.09.44.42;	author jmc;	state Exp;
branches;
next	1.17;

1.17
date	2002.11.29.00.27.03;	author millert;	state Exp;
branches;
next	1.16;

1.16
date	2002.01.24.19.34.48;	author mickey;	state Exp;
branches;
next	1.15;

1.15
date	2001.10.04.23.02.32;	author pjanzen;	state Exp;
branches;
next	1.14;

1.14
date	2001.05.01.17.58.02;	author aaron;	state Exp;
branches;
next	1.13;

1.13
date	2001.02.16.02.00.22;	author smart;	state Exp;
branches;
next	1.12;

1.12
date	2000.11.10.05.10.25;	author aaron;	state Exp;
branches;
next	1.11;

1.11
date	2000.11.09.17.52.08;	author aaron;	state Exp;
branches;
next	1.10;

1.10
date	2000.07.26.16.55.05;	author ian;	state Exp;
branches;
next	1.9;

1.9
date	2000.03.23.21.10.16;	author aaron;	state Exp;
branches;
next	1.8;

1.8
date	2000.03.06.02.38.19;	author aaron;	state Exp;
branches;
next	1.7;

1.7
date	2000.03.04.22.19.23;	author aaron;	state Exp;
branches;
next	1.6;

1.6
date	99.06.05.01.21.24;	author aaron;	state Exp;
branches;
next	1.5;

1.5
date	99.03.30.01.21.22;	author ian;	state Exp;
branches;
next	1.4;

1.4
date	97.02.09.23.58.20;	author millert;	state Exp;
branches;
next	1.3;

1.3
date	96.06.26.05.32.56;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	95.12.14.03.30.02;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.45.08;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.45.08;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.44
log
@Add --brief and --dereference, used by xdg-open/xdg-mime.

From Ralf Horstmann, ok tb@@ deraadt@@ nicm@@ sthen@@
@
text
@.\" $OpenBSD: file.1,v 1.43 2015/07/30 11:13:24 jmc Exp $
.\" $FreeBSD: src/usr.bin/file/file.1,v 1.16 2000/03/01 12:19:39 sheldonh Exp $
.\"
.\" Copyright (c) 2015 Nicholas Marriott <nicm@@openbsd.org>
.\" Copyright (c) Ian F. Darwin 1986-1995.
.\" Software written by Ian F. Darwin and others;
.\" maintained 1995-present by Christos Zoulas and others.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice immediately at the beginning of the file, without modification,
.\"    this list of conditions, and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED. IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE FOR
.\" ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.Dd $Mdocdate: July 30 2015 $
.Dt FILE 1
.Os
.Sh NAME
.Nm file
.Nd determine file type
.Sh SYNOPSIS
.Nm
.Op Fl bchiLsW
.Ar
.Sh DESCRIPTION
The
.Nm
utility tests each argument and attempts to determine its type.
Three sets of tests are performed:
.Bl -enum -offset Ds
.It
Filesystem tests, for example if a file is empty, or a special file such as a
socket or named pipe (FIFO).
.It
.Dq Magic
tests for data in particular fixed formats.
These are loaded from the
.Pa /etc/magic
file (or
.Pa ~/.magic
instead if it exists and
.Nm
is not running as root).
The file format is described in
.Xr magic 5 .
.It
Tests for text files such as plain ASCII or C programming language files.
.El
.Pp
The first test which succeeds causes the file type to be printed.
The type will often contain one of the words
.Em text
(contains only printing characters and is probably safe to read on an ASCII
terminal),
.Em executable
(the file contains a compiled executable program)
or
.Em data
meaning anything else.
.Pp
If
.Ar file
is a single dash
.Pq Sq - ,
.Nm
reads from the standard input.
.Pp
The options are as follows:
.Bl -tag -width indent
.It Fl b , -brief
Does not prepend filenames to output lines.
.It Fl c
Prints a summary of the parsed magic file; usually used for debugging.
.It Fl h
Causes symlinks not to be followed.
This is the default.
.It Fl i , -mime , -mime-type
Outputs MIME type strings rather than the more
traditional human-readable ones.
Thus it may say
.Dq text/plain
rather than
.Dq ASCII text .
.It Fl L , -dereference
Causes symlinks to be followed.
.It Fl s
Attempts to read block and character device files, not just regular files.
.It Fl W
Displays warnings when parsing the magic file or applying its tests.
Usually used for debugging.
.El
.Sh FILES
.Bl -tag -width /etc/magic -compact
.It Pa /etc/magic
default magic file
.El
.Sh EXIT STATUS
.Ex -std file
.Sh SEE ALSO
.Xr magic 5
.Sh AUTHORS
.An -nosplit
.Nm
commands have appeared in many previous versions of
.Ux .
This version was written by
.An Nicholas Marriott
for
.Ox 5.8
to replace the previous version originally written by
.An Ian Darwin .
.Pp
There is a large number of contributors to the magic files; many are listed in
the source files.
@


1.43
log
@note that symlinks are not followed by default;
from tilo stritzky

ok nicm and discussed with deraadt
@
text
@d1 1
a1 1
.\" $OpenBSD: file.1,v 1.42 2015/05/30 06:25:35 nicm Exp $
d31 1
a31 1
.Dd $Mdocdate: May 30 2015 $
d86 1
a86 1
.It Fl b
d100 1
a100 1
.It Fl L
@


1.42
log
@Support - to read from stdin, from Sebastien Marie.
@
text
@d1 1
a1 1
.\" $OpenBSD: file.1,v 1.41 2015/04/27 11:12:49 jmc Exp $
d31 1
a31 1
.Dd $Mdocdate: April 27 2015 $
d92 1
@


1.41
log
@remove some extraneous text; ok nicm
@
text
@d1 1
a1 1
.\" $OpenBSD: file.1,v 1.40 2015/04/26 22:51:32 nicm Exp $
d31 1
a31 1
.Dd $Mdocdate: April 26 2015 $
d76 7
@


1.40
log
@Don't support -s on FIFOs, it doesn't work well and the workarounds are
a bit horrible.
@
text
@d1 1
a1 1
.\" $OpenBSD: file.1,v 1.39 2015/04/24 20:57:51 nicm Exp $
d31 1
a31 1
.Dd $Mdocdate: April 24 2015 $
d86 1
a86 1
Causes the file command to output MIME type strings rather than the more
d95 1
a95 3
Instructs
.Nm
to attempt to read block and character device files, not only regular files.
@


1.39
log
@Document -h, and bring some consistency to the option descriptions. ok jmc
@
text
@d1 1
a1 1
.\" $OpenBSD: file.1,v 1.38 2015/04/24 20:32:34 jmc Exp $
d97 1
a97 3
to attempt to read all files, not only those which
.Xr stat 2
reports are ordinary files.
@


1.38
log
@tweaks; ok nicm
@
text
@d1 1
a1 1
.\" $OpenBSD: file.1,v 1.37 2015/04/24 17:34:57 nicm Exp $
d39 1
a39 1
.Op Fl bciLsW
d80 1
a80 1
Do not prepend filenames to output lines.
d82 3
a84 1
Print a summary of the parsed magic file; usually used for debugging.
d101 1
a101 1
Display warnings when parsing the magic file or applying its tests.
@


1.37
log
@Do not attempt to use ~/.magic if running as root (or issetugid()).
@
text
@d1 1
a1 1
.\" $OpenBSD: file.1,v 1.36 2015/04/24 16:24:11 nicm Exp $
a38 1
.Bk -words
a40 1
.Ek
d76 2
a77 1
.Sh OPTIONS
d82 1
a82 1
Print a summary of the parsed magic file, usually used for debugging.
d112 1
d116 3
a118 1
This version was written by Nicholas Marriott for
d120 2
a121 1
to replace the previous version originally written by Ian Darwin.
@


1.36
log
@New implementation of the file(1) utility. This is a simplified,
modernised version with a nearly complete magic(5) parser but omits some
of the complex builtin tests (notably ELF) and has a reduced set of
options.

ok deraadt
@
text
@d1 1
a1 1
.\" $OpenBSD: file.1,v 1.35 2015/02/15 22:26:45 bentley Exp $
d31 1
a31 1
.Dd $Mdocdate: February 15 2015 $
d59 3
a61 1
instead if it exists).
@


1.35
log
@Use "In" to mark up include files, instead of wrongly wrapping with Aq.

Aq is not the same as <> in non-ASCII situations, so this caused
incorrect output in some places. And it provided no semantics besides.

ok schwarze@@
@
text
@d1 1
a1 1
.\" $OpenBSD: file.1,v 1.34 2013/01/17 21:29:14 jmc Exp $
d4 1
d31 1
a31 1
.Dd $Mdocdate: January 17 2013 $
d40 2
a41 8
.Op Fl 0bCcehikLNnprsvz
.Op Fl -help
.Op Fl -mime-encoding
.Op Fl -mime-type
.Op Fl F Ar separator
.Op Fl f Ar namefile
.Op Fl m Ar magicfiles
.Ar file
d46 19
a64 4
utility tests each argument in an attempt to classify it.
There are three sets of tests, performed in this order:
filesystem tests, magic tests, and language tests.
The first test that succeeds causes the file type to be printed.
d66 2
a67 1
The type printed will usually contain one of the words
d69 2
a70 4
(the file contains only
printing characters and a few common control
characters and is probably safe to read on an
ASCII terminal),
d72 1
a72 4
(the file contains the result of compiling a program
in a form understandable to some
.Ux
kernel or another),
d75 1
a75 106
meaning anything else (data is usually
.Dq binary
or non-printable).
Exceptions are well-known file formats (core files, tar archives)
that are known to contain binary data.
When modifying magic files or the program itself, make sure to
.Em preserve these keywords .
Users depend on knowing that all the readable files in a directory
have the word
.Dq text
printed.
Don't do as Berkeley did and change
.Dq shell commands text
to
.Dq shell script .
.Pp
The filesystem tests are based on examining the return from a
.Xr stat 2
system call.
The program checks to see if the file is empty,
or if it's some sort of special file.
Any known file types,
such as sockets, symbolic links, and named pipes (FIFOs),
are intuited if they are defined in
the system header file
.In sys/stat.h .
.Pp
The magic tests are used to check for files with data in
particular fixed formats.
The canonical example of this is a binary executable (compiled program)
a.out file, whose format is defined in
.In elf.h ,
.In a.out.h ,
and possibly
.In exec.h
in the standard include directory.
These files have a
.Dq magic number
stored in a particular place
near the beginning of the file that tells the
.Ux
operating system
that the file is a binary executable, and which of several types thereof.
The concept of a
.Dq magic
has been applied by extension to data files.
Any file with some invariant identifier at a small fixed
offset into the file can usually be described in this way.
The information identifying these files is read from the magic file
.Pa /etc/magic .
In addition, if
.Pa $HOME/.magic.mgc
or
.Pa $HOME/.magic
exists, it will be used in preference to the system magic files.
.Pp
If a file does not match any of the entries in the magic file,
it is examined to see if it seems to be a text file.
ASCII, ISO-8859-x, non-ISO 8-bit extended-ASCII character sets
(such as those used on Macintosh and IBM PC systems),
UTF-8-encoded Unicode, UTF-16-encoded Unicode, and EBCDIC
character sets can be distinguished by the different
ranges and sequences of bytes that constitute printable text
in each set.
If a file passes any of these tests, its character set is reported.
ASCII, ISO-8859-x, UTF-8, and extended-ASCII files are identified
as
.Dq text
because they will be mostly readable on nearly any terminal;
UTF-16 and EBCDIC are only
.Dq character data
because, while
they contain text, it is text that will require translation
before it can be read.
In addition,
.Nm
will attempt to determine other characteristics of text-type files.
If the lines of a file are terminated by CR, CRLF, or NEL, instead
of the Unix-standard LF, this will be reported.
Files that contain embedded escape sequences or overstriking
will also be identified.
.Pp
Once
.Nm
has determined the character set used in a text-type file,
it will
attempt to determine in what language the file is written.
The language tests look for particular strings (cf.\&
.In names.h )
that can appear anywhere in the first few blocks of a file.
For example, the keyword
.Em .br
indicates that the file is most likely a
troff input file, just as the keyword
.Em struct
indicates a C program.
These tests are less reliable than the previous
two groups, so they are performed last.
The language test routines also test for some miscellany
(such as
.Xr tar 1
archives).
.Pp
Any file that cannot be identified as having been written
in any of the character sets listed above is simply said to be
.Dq data .
d78 7
a84 72
.It Fl 0 , -print0
Output a null character
.Sq \e0
after the end of the filename.
Nice to
.Xr cut 1
the output.
This does not affect the separator which is still printed.
.It Fl b , -brief
Do not prepend filenames to output lines (brief mode).
.It Fl C , -compile
Write a
.Pa magic.mgc
output file that contains a pre-parsed version of the magic file or directory.
.It Fl c , -checking-printout
Cause a checking printout of the parsed form of the magic file.
This is usually used in conjunction with the
.Fl m
flag to debug a new magic file before installing it.
.It Fl e , -exclude Ar testname
Exclude the test named in
.Ar testname
from the list of tests made to determine the file type.
Valid test names are:
.Bl -tag -width compress
.It apptype
Check for
.Dv EMX
application type (only on EMX).
.It ascii
Check for various types of ASCII files.
.It compress
Don't look for, or inside, compressed files.
.It elf
Don't print elf details.
.It fortran
Don't look for fortran sequences inside ASCII files.
.It soft
Don't consult magic files.
.It tar
Don't examine tar files.
.It token
Don't look for known tokens inside ASCII files.
.It troff
Don't look for troff sequences inside ASCII files.
.El
.It Fl F , -separator Ar separator
Use the specified string as the separator between the filename and the
file result returned.
Defaults to
.Sq \&: .
.It Fl f , -files-from Ar namefile
Read the names of the files to be examined from
.Ar namefile
(one per line)
before the argument list.
Either
.Ar namefile
or at least one filename argument must be present;
to test the standard input, use
.Sq -
as a filename argument.
.It Fl h , -no-dereference
Causes symlinks not to be followed.
This is the default if the environment variable
.Dv POSIXLY_CORRECT
is not defined.
.It Fl -help
Print a help message and exit.
.It Fl i , -mime
Causes the file command to output mime type strings rather than the more
traditional human readable ones.
d86 1
a86 1
.Dq text/plain charset=us-ascii
d89 4
a92 1
In order for this option to work,
d94 1
a94 55
changes the way it handles files recognized by the command itself
(such as many of the text file types, directories etc.),
and makes use of an alternative
.Dq magic
file.
See also
.Sx FILES ,
below.
.It Fl -mime-encoding , -mime-type
Like
.Fl i ,
but print only the specified element(s).
.It Fl k , -keep-going
Don't stop at the first match, keep going.
Subsequent matches will have the string
.Dq "\[rs]012\- "
prepended.
(If a newline is required, see the
.Fl r
option.)
.It Fl L , -dereference
Causes symlinks to be followed;
analogous to the option of the same name in
.Xr ls 1 .
This is the default if the environment variable
.Dv POSIXLY_CORRECT
is defined.
.It Fl m , -magic-file Ar magicfiles
Specify an alternate list of files and directories containing magic.
This can be a single item, or a colon-separated list.
If a compiled magic file is found alongside a file or directory,
it will be used instead.
.It Fl N , -no-pad
Don't pad filenames so that they align in the output.
.It Fl n , -no-buffer
Force stdout to be flushed after checking each file.
This is only useful if checking a list of files.
It is intended to be used by programs that want filetype output from a pipe.
.It Fl p , -preserve-date
On systems that support
.Xr utime 3
or
.Xr utimes 2 ,
attempt to preserve the access time of files analyzed, to pretend that
.Nm
never read them.
.It Fl r , -raw
Don't translate unprintable characters to \eooo.
Normally
.Nm
translates unprintable characters to their octal representation.
.It Fl s , -special-files
Normally,
.Nm
only attempts to read and determine the type of argument files which
d97 3
a99 18
This prevents problems, because reading special files may have peculiar
consequences.
Specifying the
.Fl s
option causes
.Nm
to also read argument files which are block or character special files.
This is useful for determining the filesystem types of the data in raw
disk partitions, which are block special files.
This option also causes
.Nm
to disregard the file size as reported by
.Xr stat 2
since on some systems it reports a zero size for raw disk partitions.
.It Fl v , -version
Print the version of the program and exit.
.It Fl z , -uncompress
Try to look inside compressed files.
a100 25
.Sh ENVIRONMENT
The environment variable
.Dv MAGIC
can be used to set the default magic file name.
If that variable is set, then
.Nm
will not attempt to open
.Pa $HOME/.magic .
.Nm
adds
.Dq .mgc
to the value of this variable as appropriate.
The environment variable
.Dv POSIXLY_CORRECT
controls whether
.Nm
will attempt to follow symlinks or not.
If set, then
.Nm
follows symlinks; otherwise it does not.
This is also controlled by the
.Fl L
and
.Fl h
options.
d104 1
a104 1
default list of magic numbers
a108 3
.Xr hexdump 1 ,
.Xr od 1 ,
.Xr strings 1 ,
d110 1
a110 36
.Sh STANDARDS CONFORMANCE
This program is believed to exceed the System V Interface Definition
of FILE(CMD), as near as one can determine from the vague language
contained therein.
Its behavior is mostly compatible with the System V program of the same name.
This version knows more magic, however, so it will produce
different (albeit more accurate) output in many cases.
.\" URL: http://www.opengroup.org/onlinepubs/009695399/utilities/file.html
.Pp
The one significant difference
between this version and System V
is that this version treats any whitespace
as a delimiter, so that spaces in pattern strings must be escaped.
For example,
.Bd -literal -offset indent
\*(Gt10	string	language impress\ 	(imPRESS data)
.Ed
.Pp
in an existing magic file would have to be changed to
.Bd -literal -offset indent
\*(Gt10	string	language\e impress	(imPRESS data)
.Ed
.Pp
In addition, in this version, if a pattern string contains a backslash,
it must be escaped.
For example
.Bd -literal -offset indent
0	string		\ebegindata	Andrew Toolkit document
.Ed
.Pp
in an existing magic file would have to be changed to
.Bd -literal -offset indent
0	string		\e\ebegindata	Andrew Toolkit document
.Ed
.Pp
SunOS releases 3.2 and later from Sun Microsystems include a
d112 5
a116 93
command derived from the System V one, but with some extensions.
This version differs from Sun's only in minor ways.
It includes the extension of the
.Sq &
operator, used as,
for example,
.Bd -literal -offset indent
\*(Gt16	long&0x7fffffff	\*(Gt0		not stripped
.Ed
.Sh HISTORY
There has been a
.Nm
command in every
.Ux
since at least Research Version 4
(man page dated November, 1973).
The System V version introduced one significant major change:
the external list of magic types.
This slowed the program down slightly but made it a lot more flexible.
.Pp
This program, based on the System V version,
was written by Ian Darwin
without looking at anybody else's source code.
.Pp
John Gilmore revised the code extensively, making it better than
the first version.
Geoff Collyer found several inadequacies
and provided some magic file entries.
Contributions by the `&' operator by Rob McMahon, 1989.
.Pp
Guy Harris, made many changes from 1993 to the present.
.Pp
Primary development and maintenance from 1990 to the present by
Christos Zoulas.
.Pp
Altered by Chris Lowth, 2000:
Handle the
.Fl i
option to output mime type strings, using an alternative
magic file and internal logic.
.Pp
Altered by Eric Fischer, July, 2000,
to identify character codes and attempt to identify the languages
of non-ASCII files.
.Pp
Altered by Reuben Thomas, 2007 to 2008, to improve MIME
support and merge MIME and non-MIME magic, support directories as well
as files of magic, apply many bug fixes and improve the build system.
.Pp
The list of contributors to the
.Dq magic
directory (magic files)
is too long to include here.
You know who you are; thank you.
Many contributors are listed in the source files.
.Sh BUGS
There must be a better way to automate the construction of the Magic
file from all the glop in Magdir.
What is it?
.Pp
.Nm
uses several algorithms that favor speed over accuracy,
thus it can be misled about the contents of
text
files.
.Pp
The support for text files (primarily for programming languages)
is simplistic, inefficient and requires recompilation to update.
.Pp
The list of keywords in
.Pa ascmagic
probably belongs in the Magic file.
This could be done by using some keyword like
.Sq *
for the offset value.
.Pp
Complain about conflicts in the magic file entries.
Make a rule that the magic entries sort based on file offset rather
than position within the magic file?
.Pp
The program should provide a way to give an estimate
of
.Dq how good
a guess is.
We end up removing guesses (e.g.
.Dq From\
as first 5 chars of file) because
they are not as good as other guesses (e.g.\&
.Dq Newsgroups:
versus
.Dq Return-Path: ) .
Still, if the others don't pan out, it should be possible to use the
first guess.
d118 2
a119 1
This manual page, and particularly this section, is too long.
@


1.34
log
@remove uesless Pp;
@
text
@d1 1
a1 1
.\" $OpenBSD: file.1,v 1.33 2010/10/28 21:32:54 jmc Exp $
d30 1
a30 1
.Dd $Mdocdate: October 28 2010 $
d94 1
a94 1
.Aq Pa sys/stat.h .
d100 2
a101 2
.Aq Pa elf.h ,
.Aq Pa a.out.h ,
d103 1
a103 1
.Aq Pa exec.h
d157 1
a157 1
.Aq Pa names.h )
@


1.33
log
@more roff adjustments;
@
text
@d1 1
a1 1
.\" $OpenBSD: file.1,v 1.32 2010/09/03 11:09:28 jmc Exp $
d30 1
a30 1
.Dd $Mdocdate: September 3 2010 $
a460 1
.Pp
@


1.32
log
@add an EXIT STATUS section for /usr/bin;
@
text
@d1 1
a1 1
.\" $OpenBSD: file.1,v 1.31 2010/01/02 20:15:15 schwarze Exp $
d30 1
a30 1
.Dd $Mdocdate: January 2 2010 $
d162 1
a162 2
.Xr troff 1
input file, just as the keyword
@


1.31
log
@Various syntax errors in list headers, found by mandoc(1),
also required to fix the mandoc build.

"fine. even if mandoc goes nowhere, it has found some bugs ;)" jmc@@
ok sobrado@@
@
text
@d1 1
a1 1
.\" $OpenBSD: file.1,v 1.30 2009/10/26 21:03:03 ajacoutot Exp $
d30 1
a30 1
.Dd $Mdocdate: October 26 2009 $
a331 2
.Pp
.Ex -std file
d362 2
@


1.30
log
@Bring man pages on par with our file(1) version (merge from upstream with
several tweaks).

As usual, several enhancements and inputs from jmc@@
Input from ian@@

ok jmc@@ ian@@
@
text
@d1 1
a1 1
.\" $OpenBSD: file.1,v 1.29 2009/08/16 09:41:08 sobrado Exp $
d30 1
a30 1
.Dd $Mdocdate: August 16 2009 $
d202 1
a202 1
.Bl -tag -width
@


1.29
log
@replace ".Ar file ..." with ".Ar" whenever possible.

ok jmc@@
@
text
@d1 1
a1 1
.\" $OpenBSD: file.1,v 1.28 2007/05/31 19:20:09 jmc Exp $
d30 1
a30 1
.Dd $Mdocdate: May 31 2007 $
d37 6
a42 2
.Nm file
.Op Fl bckLNnrsvz
d46 1
a46 2
.Bk -words
.Ar
a47 3
.Nm file
.Op Fl m Ar magicfiles
.Fl C
d51 1
a51 2
utility
tests each argument in an attempt to classify it.
d53 1
a53 1
filesystem tests, magic number tests, and language tests.
d57 1
a57 1
.Dq text
d59 1
a59 1
.Tn ASCII
d61 2
a62 3
.Tn ASCII
terminal),
.Dq executable
d68 4
a71 3
.Dq data
meaning anything else (data is usually binary or non-printable).
.Pp
d74 3
a76 6
When modifying the file
.Pa /etc/magic
or the program itself,
.Em "preserve these keywords" .
.Pp
People depend on knowing that all the readable files in a directory
d80 1
a80 1
Don't do as Berkeley did; change
d90 2
a91 3
Any known file types appropriate to the system you are running on
(sockets, symbolic links, or named pipes (FIFOs) on those systems that
implement them)
d96 1
a96 1
The magic number tests are used to check for files with data in
d99 3
a101 3
.Pa a.out
file, whose format is defined in
.Aq Pa a.out.h
d104 1
a104 2
in the standard include directory and is explained in
.Xr a.out 5 .
d112 3
a114 2
.Pp
The concept of magic number has been applied by extension to data files.
d117 1
a117 1
The information in these files is read from the magic file
d119 5
d125 33
a157 7
If an argument appears to be an
.Tn ASCII
file,
.Nm
attempts to guess its language.
The language tests look for particular strings (cf
.Pa names.h )
d164 1
a164 1
.Li struct
d171 4
a174 4
archives) and determine whether an unknown file should be
labelled as
.Dq ASCII text
or
d176 11
a186 4
.Pp
The options are as follows:
.Bl -tag -width Ds
.It Fl b
d188 2
a189 2
.It Fl C
For each magic number file, write a
d191 2
a192 2
output file that contains a preparsed (compiled) version of it.
.It Fl c
d194 1
a194 1
This is usually used in conjunction with
d196 31
a226 4
to debug a new magic file before installing it.
.It Fl F Ar separator
Use the specified string as the separator between the filename and
the file result returned.
d229 1
a229 1
.It Fl f Ar namefile
d240 29
a268 1
.It Fl k
d270 19
a288 11
.It Fl L
Cause symlinks to be followed, as the like-named option in
.Xr ls 1
(on systems that support symbolic links).
.It Fl m Ar magicfiles
Specify an alternate list,
.Ar magicfiles ,
of files containing magic numbers.
This can be a single file or a colon-separated list of files.
If a compiled magic file is found alongside, it will be used instead.
.It Fl N
d290 2
a291 4
.It Fl n
Force
.Em stdout
to be flushed after checking each file.
d293 11
a303 5
It is intended to be used by programs that want filetype output from a
pipe.
.It Fl r
Don't translate unprintable characters to
.Sq \e Ns Em ooo .
d306 2
a307 3
translates unprintable characters to their octal representation
(raw mode).
.It Fl s
d325 1
a325 1
.Xr stat 2 ,
d327 1
a327 1
.It Fl v
d329 2
a330 3
.It Fl z
Try to look inside files that have been run through
.Xr compress 1 .
d332 2
d335 7
a341 3
.Bl -tag -width indent
.It Ev MAGIC
Default magic number files, separated by colon characters.
d346 13
a358 1
.El
a364 1
.Xr compress 1 ,
a365 1
.Xr ls 1 ,
a367 1
.Xr a.out 5 ,
d373 1
a373 1
Its behaviour is mostly compatible with the System V program of the same name.
d376 1
d380 1
a380 1
is that this version treats any white space
d383 3
a385 2
.Pp
>10     string  language impress\       (imPRESS data)
d388 3
a390 2
.Pp
>10     string  language\e impress      (imPRESS data)
d395 3
a397 2
.Pp
0       string          \ebegindata     Andrew Toolkit document
d400 3
a402 2
.Pp
0       string          \e\ebegindata   Andrew Toolkit document
d405 1
a405 1
.Nm file
d407 1
a407 1
My version differs from Sun's only in minor ways.
d409 1
a409 1
.Ql &
d412 3
a414 19
.Pp
>16     long&0x7fffffff >0              not stripped
.Sh MAGIC DIRECTORY
The magic file entries have been collected from various sources,
mainly USENET, and contributed by various authors.
.An Christos Zoulas
(address below) will collect additional
or corrected magic file entries.
A consolidation of magic file entries
will be distributed periodically.
The order of entries in the magic file is significant.
Depending on what system you are using, the order that
they are put together may be incorrect.
If your old
.Nm
command uses a magic file,
keep the old magic file around for comparison purposes
(rename it to
.Pa /etc/magic.orig ) .
d423 1
a423 1
the external list of magic number types.
d426 2
a427 2
This program, based on the System V version, was written by
.An Ian F. Darwin
d430 1
a430 2
.An John Gilmore
revised the code extensively, making it better than
d432 1
a432 2
.An Geoff Collyer
found several inadequacies
d434 1
a434 5
Contributions to the
.Ql &
operator by
.An Rob McMahon ,
1989.
d436 1
a436 2
.An Guy Harris
made many changes from 1993 to the present.
d439 1
a439 1
.An Christos Zoulas Aq christos@@zoulas.com .
d441 13
a453 10
Altered by
.An Chris Lowth ,
2000, to optionally report MIME types.
This required an alternative magic file, and is not available in
.Ox .
.Pp
Altered by
.An Eric Fischer ,
July, 2000, to identify character codes and attempt to identify the
languages of non-ASCII files.
d456 3
a458 4
.Dq magdir
directory (source for the
.Pa /etc/magic
file) is too long to include here.
d460 2
a461 4
.Sh LEGAL NOTICE
Copyright (c) Ian F. Darwin, Toronto, Canada, 1986-1999.
Covered by the standard Berkeley Software Distribution copyright; see the file
LEGAL.NOTICE in the distribution.
a462 10
The files
.Pa tar.h
and
.Pa is_tar.c
were written by
.An John Gilmore
from his public-domain
.Nm tar
program, and are not covered by the above license.
.Sh BUGS
a465 7
Better yet, the magic file should be compiled into binary (say,
.Xr ndbm 3
or, better yet, fixed-length
.Tn ASCII
strings for use in heterogenous network environments) for faster startup.
Then the program would run as fast as the Version 7 program of the same name,
with the flexibility of the System V version.
d468 1
a468 1
uses several algorithms that favor speed over accuracy;
d470 1
a470 1
.Tn ASCII
d473 1
a473 3
The support for
.Tn ASCII
files (primarily for programming languages)
a475 21
There should be an
.Dq else
clause to follow a series of continuation lines.
.Pp
The magic file and keywords should have regular expression support.
Their use of
.Tn ASCII TAB
as a field delimiter is ugly and makes
it hard to edit the files, but is entrenched.
.Pp
It might be advisable to allow upper-case letters in keywords
for e.g.,
.Xr troff 1
commands vs man page macros.
Regular expression support would make this easy.
.Pp
The program doesn't grok \s-2FORTRAN\s0.
It should be able to figure \s-2FORTRAN\s0 by seeing some keywords which
appear indented at the start of line.
Regular expression support would make this easy.
.Pp
d477 1
a477 1
.Em ascmagic
d480 1
a480 1
.Ql *
a482 4
Another optimization would be to sort
the magic file so that we can just run down all the
tests for the first byte, first word, first long, etc, once we
have fetched it.
d491 2
a492 2
We end up removing guesses (e.g.,
.Dq From\ \&
d494 1
a494 1
they are not as good as other guesses (e.g.,
d497 3
a499 7
.Qq Return-Path: ) .
Still, if the others don't pan out, it should be
possible to use the first guess.
.Pp
This program is slower than some vendors'
.Nm
commands.
a501 6
.Sh AVAILABILITY
You can obtain the original author's latest version by anonymous FTP
on
.Em ftp.astron.com
in the directory
.Pa /pub/file/file-X.YY.tar.gz .
@


1.28
log
@convert to new .Dd format;
@
text
@d1 1
a1 1
.\" $OpenBSD: file.1,v 1.27 2007/03/29 11:34:41 jmc Exp $
d30 1
a30 1
.Dd $Mdocdate$
d43 1
a43 1
.Ar file ...
@


1.27
log
@let the description of -m match SYNOPSIS and usage(); from Igor Sobrado
@
text
@d1 1
a1 1
.\" $OpenBSD: file.1,v 1.26 2007/02/28 07:41:07 david Exp $
d30 1
a30 1
.Dd December 4, 2004
@


1.26
log
@spell maintenance correctly
@
text
@d1 1
a1 1
.\" $OpenBSD: file.1,v 1.25 2007/02/24 23:52:07 ian Exp $
d186 1
a186 1
.It Fl m Ar magiclist
d188 1
a188 1
.Ar magiclist ,
@


1.25
log
@Remove several incorrect and/or unmaintained emails, prompted by correction from bernd@@
@
text
@d1 1
a1 1
.\" $OpenBSD: file.1,v 1.24 2007/02/19 13:02:08 tom Exp $
d343 1
a343 1
Primary development and maintenence from 1990 to the present by
@


1.24
log
@Our version of file(1) doesn't have the MIME magic file, so remove
references to -i/--mime and no longer accept them on the command line.
Update the HISTORY section to be less confusing.

Based on a diff to tech@@ by Mikolaj Kucharski, mikolaj (dot) kucharski
(at) gmail (dot) com.

Prompted by jmc@@; input from and ok jmc@@ and otto@@
@
text
@d1 1
a1 1
.\" $OpenBSD: file.1,v 1.23 2004/12/04 19:55:12 jaredy Exp $
d325 1
a325 1
.An Ian F. Darwin Aq ian@@darwinisys.com
d337 1
a337 1
.An Rob McMahon Aq cudcv@@warwick.ac.uk ,
d340 1
a340 1
.An Guy Harris Aq guy@@auspex.com
d347 1
a347 1
.An Chris Lowth Aq chris@@lowth.com ,
d353 1
a353 1
.An Eric Fischer Aq enf@@pobox.com ,
@


1.23
log
@sync manual and usage to file-4.09; bits from and ok ian and jmc
@
text
@d1 1
a1 1
.\" $OpenBSD: file.1,v 1.22 2004/10/14 20:56:57 jaredy Exp $
d348 3
a350 4
2000: Handle the
.Fl i
option to output mime type strings and using an alternative magic file
and internal logic.
@


1.22
log
@remove spurious version number reference

problem reported by ray cyth net

ok millert
@
text
@d1 1
a1 1
.\" $OpenBSD: file.1,v 1.21 2003/06/13 18:31:14 deraadt Exp $
d30 1
a30 1
.Dd July 30, 1997
d38 2
a39 1
.Op Fl vbczL
d42 6
a47 1
.Ar file Op Ar ...
d109 2
a110 1
in the standard include directory.
a152 9
.It Fl v
Print the version of the program and exit.
.It Fl m Ar list
Specify an alternate
.Ar list
of files containing magic numbers.
This can be a single file, or a colon-separated list of files.
.It Fl z
Try to look inside compressed files.
d155 4
d164 5
d178 1
a178 1
.Dq -
d180 2
d184 1
a184 1
.Xr ls 1 .
d186 47
d237 5
a241 1
Default magic number files.
d249 1
d251 1
d254 1
d334 11
d347 5
a351 7
.An Rob McMahon Aq cudcv@@warwick.ac.uk ,
1989, to extend the
.Ql &
operator from simple
.Dq x&y != 0
to
.Dq x&y op z .
d354 10
a363 38
.An Guy Harris Aq guy@@auspex.com ,
1993, to:
.Bl -item -offset indent
.It
put the
.Dq old-style
.Ql &
operator back the way it was, because
.Bl -enum -offset indent
.It
Rob McMahon's change broke the
previous style of usage,
.It
The SunOS
.Dq new-style
.Ql &
operator, which this version of
.Nm
supports, also handles
.Dq x&y op z ,
.It
Rob's change wasn't documented in any case;
.El
.It
put in multiple levels of
.Ql > ;
.It
put in
.Dq beshort ,
.Dq leshort ,
etc. keywords to look at numbers in the
file in a specific byte order, rather than in the native byte order of
the process running
.Nm file .
.El
.Pp
Currently maintained by
.An Christos Zoulas Aq christos@@zoulas.com .
d377 1
a377 1
program.
@


1.21
log
@ian gives permission for 3/4 removal
@
text
@d1 1
a1 1
.\" $OpenBSD: file.1,v 1.20 2003/06/10 09:12:10 jmc Exp $
d43 1
a43 3
This manual page documents version 3.22 of the
.Nm
command.
d45 1
@


1.20
log
@- section reorder
- COMPATIBILITY merge
- macro cleanup
- kill whitespace at EOL
- new sentence, new line

ssh pages ok markus@@
@
text
@d1 1
a1 1
.\" $OpenBSD: file.1,v 1.19 2003/03/11 21:26:26 ian Exp $
a16 5
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgement:
.\"    This product includes software developed by Ian F. Darwin and others.
.\" 4. The name of the author may not be used to endorse or promote products
.\"    derived from this software without specific prior written permission.
@


1.19
log
@Replace TPUM license with standard BSD-style license
@
text
@d1 1
a1 1
.\" $OpenBSD: file.1,v 1.18 2003/02/15 09:44:42 jmc Exp $
d7 1
a7 1
.\" 
d22 1
a22 1
.\"  
d230 1
a230 1
.Xr file 1
d404 1
a404 1
.Dq From\ 
d423 1
a423 1
.Pa /pub/file/file-X.YY.tar.gz
@


1.18
log
@copyrights added;

file(1), magic(5): Ian F. Darwin
afterboot(8): Marshall M. Midden
x99token(1): Paul Borman
@
text
@d1 1
a1 1
.\" $OpenBSD: file.1,v 1.17 2002/11/29 00:27:03 millert Exp $
d4 30
a33 22
.\" Copyright (c) Ian F. Darwin, 1987.
.\" Written by Ian F. Darwin.
.\"
.\" This software is not subject to any license of the American Telephone
.\" and Telegraph Company or of the Regents of the University of California.
.\"
.\" Permission is granted to anyone to use this software for any purpose on
.\" any computer system, and to alter it and redistribute it freely, subject
.\" to the following restrictions:
.\"
.\" 1. The author is not responsible for the consequences of use of this
.\"    software, no matter how awful, even if they arise from flaws in it.
.\"
.\" 2. The origin of this software must not be misrepresented, either by
.\"    explicit claim or by omission.  Since few users ever read sources,
.\"    credits must appear in the documentation.
.\"
.\" 3. Altered versions must be plainly marked as such, and must not be
.\"    misrepresented as being the original software.  Since few users
.\"    ever read sources, credits must appear in the documentation.
.\"
.\" 4. This notice may not be removed or altered.
@


1.17
log
@Add -b flag (brief mode) like NetBSD and FreeBSD; Ibrahim Khalifa
@
text
@d1 1
a1 1
.\" $OpenBSD: file.1,v 1.16 2002/01/24 19:34:48 mickey Exp $
d3 24
@


1.16
log
@it was in v4 already, diff was forwarded to the current maintainer as well
@
text
@d1 1
a1 1
.\" $OpenBSD: file.1,v 1.15 2001/10/04 23:02:32 pjanzen Exp $
d11 1
a11 1
.Op Fl vczL
d129 2
@


1.15
log
@comma splice; new master site.
@
text
@d1 1
a1 1
.\" $OpenBSD: file.1,v 1.14 2001/05/01 17:58:02 aaron Exp $
d227 2
a228 2
since at least Research Version 6
(man page dated January, 1975).
@


1.14
log
@Remove completely redundant introductory sentences in ENVIRONMENT sections.
@
text
@d1 1
a1 1
.\" $OpenBSD: file.1,v 1.13 2001/02/16 02:00:22 smart Exp $
d319 1
a319 1
uses several algorithms that favor speed over accuracy,
d387 1
a387 1
.Em ftp.deshaw.com
@


1.13
log
@Missing '.It' in a list, aaron@@ ok
@
text
@d1 1
a1 1
.\" $OpenBSD: file.1,v 1.12 2000/11/10 05:10:25 aaron Exp $
a150 3
The following environment varibles affect the execution of
.Nm file :
.Pp
@


1.12
log
@- Section shuffling: comply to the section ordering outlined in mdoc(7).
- Some .Nm trimming.
- .Sh AUTHOR -> .Sh AUTHORS
- Other miscellaneous fixes here and there.
@
text
@d1 1
a1 1
.\" $OpenBSD: file.1,v 1.11 2000/11/09 17:52:08 aaron Exp $
d155 1
a155 1
.Ev MAGIC
@


1.11
log
@Change all option list specifications to ".Bl -tag -width Ds". Most man
pages just needed their -width parameter tweaked to "Ds", which provides
a nice width of 6 constant characters. For consistency more than anything.
@
text
@d1 1
a1 1
.\" $OpenBSD: file.1,v 1.10 2000/07/26 16:55:05 ian Exp $
a149 5
.Sh FILES
.Bl -tag -width /etc/magic -compact
.It Pa /etc/magic
default list of magic numbers
.El
d158 5
a392 1

@


1.10
log
@Rip out old dead legal notice, refer to BSD license. Clean up authors/history
section.
@
text
@d1 1
a1 1
.\" $OpenBSD: file.1,v 1.9 2000/03/23 21:10:16 aaron Exp $
d119 1
a119 1
.Bl -tag -width indent
@


1.9
log
@Fix some formatting problems I missed before.
@
text
@d1 1
a1 1
.\" $OpenBSD: file.1,v 1.8 2000/03/06 02:38:19 aaron Exp $
d236 2
a237 3
This program, based on the System V version,
was written by
.An Ian Darwin
a245 6
The program has undergone continued evolution since.
.Sh AUTHORS
Written by
.An Ian F. Darwin Aq ian@@sq.com ,
UUCP address {utzoo | ihnp4}!darwin!ian,
postal address: P.O. Box 603, Station F, Toronto, Ontario, CANADA M4Y 2L8.
d293 2
a294 5
Changes by
.An Ian Darwin
and various authors including
.An Christos Zoulas Aq christos@@deshaw.com ,
1990-1992.
d296 3
a298 45
Copyright (c) Ian F. Darwin, Toronto, Canada,
1986, 1987, 1988, 1989, 1990, 1991, 1992, 1993.
.Pp
This software is not subject to and may not be made subject to any
license of the American Telephone and Telegraph Company, Sun
Microsystems Inc., Digital Equipment Inc., Lotus Development Inc., the
Regents of the University of California, The X Consortium or MIT, or
The Free Software Foundation.
.Pp
This software is not subject to any export provision of the United States
Department of Commerce, and may be exported to any country or planet.
.Pp
Permission is granted to anyone to use this software for any purpose on
any computer system, and to alter it and redistribute it freely, subject
to the following restrictions:
.Bl -enum -offset indent
.It
The author is not responsible for the consequences of use of this
software, no matter how awful, even if they arise from flaws in it;
.It
The origin of this software must not be misrepresented, either by
explicit claim or by omission.
Since few users ever read sources,
credits must appear in the documentation;
.It
Altered versions must be plainly marked as such, and must not be
misrepresented as being the original software.
Since few users ever read sources, credits must appear in the documentation;
.It
This notice may not be removed or altered.
.El
.Pp
A few support files
.Pf ( Fn getopt ,
.Fn strtok )
distributed with this package
are by
.An Henry Spencer
and are subject to the same terms as above.
.Pp
A few simple support files
.Pf ( Fn strtol ,
.Fn strchr )
distributed with this package
are in the public domain; they are so marked.
d308 1
a308 1
program, and are not covered by the above restrictions.
@


1.8
log
@mdoc'ify; from FreeBSD, with many modifications by me.
@
text
@d1 1
a1 1
.\" $OpenBSD: file.1,v 1.7 2000/03/04 22:19:23 aaron Exp $
d67 1
a67 1
.Aq Pa sys/stat.h  .
d189 2
a190 1
it must be escaped.  For example
d327 2
a328 1
explicit claim or by omission.  Since few users ever read sources,
d332 2
a333 2
misrepresented as being the original software.  Since few users
ever read sources, credits must appear in the documentation;
d415 2
a416 1
have fetched it.  Complain about conflicts in the magic file entries.
@


1.7
log
@In Unix land we prefer "whitespace" to "white space" or "white-space". At
least, this is the impression I get from looking at a lot of Perl docs.
@
text
@d1 15
a15 18
.\" $OpenBSD: file.1,v 1.6 1999/06/05 01:21:24 aaron Exp $
.TH FILE 1 "Copyrighted but distributable"
.SH NAME
file
\- determine file type
.SH SYNOPSIS
.B file
[
.B \-vczL
]
[
.B \-f
namefile ]
[
.B \-m
magicfiles ]
file ...
.SH DESCRIPTION
d17 1
a17 1
.B file
d19 1
a19 1
.B File
d23 2
a24 4
The
.I first
test that succeeds causes the file type to be printed.
.PP
d26 1
a26 1
.B text
d28 1
a28 1
.SM ASCII
d30 1
a30 1
.SM ASCII
d32 1
a32 1
.B executable
d34 3
a36 1
in a form understandable to some \s-1UNIX\s0 kernel or another),
d38 3
a40 2
.B data
meaning anything else (data is usually `binary' or non-printable).
d44 1
a44 1
.I /etc/magic
d46 2
a47 1
.B "preserve these keywords" .
d49 8
a56 4
have the word ``text'' printed.
Don't do as Berkeley did \- change ``shell commands text''
to ``shell script''.
.PP
d58 1
a58 1
.BR stat (2)
d67 2
a68 2
.IR sys/stat.h  .
.PP
d72 1
a72 1
.I a.out
d74 1
a74 1
.I a.out.h
d76 1
a76 1
.I exec.h
d78 6
a83 2
These files have a `magic number' stored in a particular place
near the beginning of the file that tells the \s-1UNIX\s0 operating system
d85 2
a86 1
The concept of `magic number' has been applied by extension to data files.
d90 2
a91 2
.I /etc/magic.
.PP
d93 1
a93 1
.SM ASCII
d95 1
a95 1
.B file
d98 1
a98 1
.IR names.h )
d101 1
a101 1
.B .br
d103 1
a103 1
.BR troff (1)
d105 1
a105 1
.B struct
d111 1
a111 1
.BR tar (1)
d113 8
a120 4
labelled as `ascii text' or `data'.
.SH OPTIONS
.TP 8
.B \-v
d122 4
a125 3
.TP 8
.B \-m list
Specify an alternate list of files containing magic numbers.
d127 1
a127 2
.TP 8
.B \-z
d129 1
a129 2
.TP 8
.B \-c
d132 1
a132 1
.B \-m
d134 1
a134 2
.TP 8
.B \-f namefile
d136 1
a136 1
.I namefile
d140 1
a140 1
.I namefile
d142 6
a147 5
to test the standard input, use ``-'' as a filename argument.
.TP 8
.B \-L
option causes symlinks to be followed, as the like-named option in
.BR ls (1).
d149 20
a168 14
.SH FILES
.I /etc/magic
\- default list of magic numbers
.SH ENVIRONMENT
The environment variable
.B MAGIC
can be used to set the default magic number files.
.SH SEE ALSO
.BR magic (5)
\- description of magic file format.
.br
.BR strings (1), " od" (1)
\- tools for examining non-textfiles.
.SH STANDARDS CONFORMANCE
d175 1
a175 1
.PP
d178 1
a178 1
is that this version treats any whitespace
d181 3
a183 3
.br
>10	string	language impress\ 	(imPRESS data)
.br
d185 3
a187 3
.br
>10	string	language\e impress	(imPRESS data)
.br
d190 3
a192 3
.br
0	string		\ebegindata	Andrew Toolkit document
.br
d194 3
a196 4
.br
0	string		\e\ebegindata	Andrew Toolkit document
.br
.PP
d198 1
a198 1
.BR file (1)
d201 3
a203 1
It includes the extension of the `&' operator, used as,
d205 3
a207 3
.br
>16	long&0x7fffffff	>0		not stripped
.SH MAGIC DIRECTORY
d210 2
a211 1
Christos Zoulas (address below) will collect additional
a214 1
.PP
d219 1
a219 1
.B file
d223 2
a224 2
.IR /etc/magic.orig ).
.SH HISTORY
d226 4
a229 2
.B file
command in every \s-1UNIX\s0 since at least Research Version 6
d234 1
a234 1
.PP
d236 6
a241 3
was written by Ian Darwin without looking at anybody else's source code.
.PP
John Gilmore revised the code extensively, making it better than
d243 2
a244 1
Geoff Collyer found several inadequacies
d247 47
a293 20
.SH AUTHOR
Written by Ian F. Darwin, ian@@darwinsys.com.
.PP
Altered by Rob McMahon, cudcv@@warwick.ac.uk, 1989, to extend the `&' operator
from simple `x&y != 0' to `x&y op z'.
.PP
Altered by Guy Harris, guy@@auspex.com, 1993, to:
.RS
.PP
put the ``old-style'' `&'
operator back the way it was, because 1) Rob McMahon's change broke the
previous style of usage, 2) the SunOS ``new-style'' `&' operator,
which this version of
.B file
supports, also handles `x&y op z', and 3) Rob's change wasn't documented
in any case;
.PP
put in multiple levels of `>';
.PP
put in ``beshort'', ``leshort'', etc. keywords to look at numbers in the
d296 43
a338 10
.BR file .
.RE
.PP
Changes by Ian Darwin and various authors including
Christos Zoulas (christos@@deshaw.com), 1990-1997.
.SH LEGAL NOTICE
This program is distributed under the terms of the accompanying
license file LEGAL.NOTICE.
.PP
A few support files (\fIgetopt\fP, \fIstrtok\fP)
d340 7
a346 3
are by Henry Spencer and are subject to the same terms as above.
.PP
A few simple support files (\fIstrtol\fP, \fIstrchr\fP)
d349 1
a349 1
.PP
d351 1
a351 1
.I tar.h
d353 5
a357 3
.I is_tar.c
were written by John Gilmore from his public-domain
.B tar
d359 1
a359 1
.SH BUGS
d361 2
a362 1
file from all the glop in Magdir. What is it?
d364 1
a364 1
.BR ndbm (3)
d366 1
a366 1
.SM ASCII
d370 2
a371 2
.PP
.B File
d374 1
a374 1
.SM ASCII
d376 1
a376 1
.PP
d378 1
a378 1
.SM ASCII
d381 5
a385 3
.PP
There should be an ``else'' clause to follow a series of continuation lines.
.PP
d388 1
a388 1
.SM "ASCII TAB"
d391 1
a391 1
.PP
d394 1
a394 1
.BR troff (1)
d397 1
a397 1
.PP
d402 1
a402 1
.PP
d404 1
a404 1
.I ascmagic
d406 5
a410 3
This could be done by using some keyword like `*' for the offset value.
.PP
Another optimisation would be to sort
d416 1
a416 1
.PP
d418 11
a428 4
of ``how good'' a guess is.
We end up removing guesses (e.g. ``From '' as first 5 chars of file) because
they are not as good as other guesses (e.g. ``Newsgroups:'' versus
"Return-Path:").  Still, if the others don't pan out, it should be
d430 5
a434 3
.PP
This program is slower than some vendors' file commands.
.PP
d436 1
a436 1
.SH AVAILABILITY
d438 5
a442 4
at
.I ftp://ftp.astron.com/pub/file/
with a name like
.I file-X.YY.tar.gz .
@


1.6
log
@- remove trailing white space
- remove arguments from .Os macros
- remove arguments from .Nm macros, where appropriate
- some more Dq/Sq/Ql insanity
- still lots to do in the usr.bin tree... :/
@
text
@d1 1
a1 1
.\" $OpenBSD: file.1,v 1.5 1999/03/30 01:21:22 ian Exp $
d161 1
a161 1
is that this version treats any white space
@


1.5
log
@Finish repair of license file (old one still included here; now refer
to new one), and update my email and the current FTP addresses.
@
text
@d1 1
a1 1
.\" $OpenBSD: file.1,v 1.4 1997/02/09 23:58:20 millert Exp $
d15 1
a15 1
.B \-m 
d47 1
a47 1
or the program itself, 
d70 1
a70 1
file, whose format is defined in 
d85 1
a85 1
.SM ASCII 
d96 1
a96 1
input file, just as the keyword 
d102 1
a102 1
(such as 
d105 1
a105 1
labelled as `ascii text' or `data'. 
d120 1
a120 1
This is usually used in conjunction with 
d125 1
a125 1
Read the names of the files to be examined from 
d127 1
a127 1
(one per line) 
d129 1
a129 1
Either 
d154 1
a154 1
contained therein. 
d157 1
a157 1
different (albeit more accurate) output in many cases. 
d159 1
a159 1
The one significant difference 
d194 1
a194 1
A consolidation of magic file entries 
d204 1
a204 1
(rename it to 
d207 1
a207 1
There has been a 
d306 1
a306 1
It should be able to figure \s-2FORTRAN\s0 by seeing some keywords which 
d310 1
a310 1
The list of keywords in 
d322 1
a322 1
The program should provide a way to give an estimate 
d327 1
a327 1
possible to use the first guess.  
@


1.4
log
@Updates file(1) to version 3.22 by way to NetBSD.
@
text
@d1 1
a1 1
.\" $OpenBSD: file.1,v 1.3 1996/06/26 05:32:56 deraadt Exp $
d224 1
a224 3
Written by Ian F. Darwin, UUCP address {utzoo | ihnp4}!darwin!ian,
Internet address ian@@sq.com,
postal address: P.O. Box 603, Station F, Toronto, Ontario, CANADA M4Y 2L8.
d251 2
a252 28
Copyright (c) Ian F. Darwin, Toronto, Canada,
1986, 1987, 1988, 1989, 1990, 1991, 1992, 1993.
.PP
This software is not subject to and may not be made subject to any
license of the American Telephone and Telegraph Company, Sun
Microsystems Inc., Digital Equipment Inc., Lotus Development Inc., the
Regents of the University of California, The X Consortium or MIT, or
The Free Software Foundation.
.PP
This software is not subject to any export provision of the United States
Department of Commerce, and may be exported to any country or planet.
.PP
Permission is granted to anyone to use this software for any purpose on
any computer system, and to alter it and redistribute it freely, subject
to the following restrictions:
.PP 
1. The author is not responsible for the consequences of use of this
software, no matter how awful, even if they arise from flaws in it.
.PP
2. The origin of this software must not be misrepresented, either by
explicit claim or by omission.  Since few users ever read sources,
credits must appear in the documentation.
.PP
3. Altered versions must be plainly marked as such, and must not be
misrepresented as being the original software.  Since few users
ever read sources, credits must appear in the documentation.
.PP
4. This notice may not be removed or altered.
d334 4
a337 4
on
.B ftp.deshaw.com
in the directory
.I /pub/file/file-X.YY.tar.gz
@


1.3
log
@rcsid
@
text
@d1 2
a2 2
.\" $OpenBSD: file.1,v 1.2 1995/12/14 03:30:02 deraadt Exp $
.TH FILE 1 "Copyright but distributable"
d19 4
a22 1
.I File
d32 5
a36 2
(the file contains only ASCII characters and is 
probably safe to read on an ASCII terminal),
d55 1
a55 1
.IR stat (2)
d64 1
a64 1
.BR sys/stat.h  .
d69 1
a69 1
.B a.out
d71 1
a71 1
.B a.out.h
d73 1
a73 1
.B exec.h
d87 1
a87 1
.I file
d89 2
a90 1
The language tests look for particular strings (cf \fInames.h\fP)
d94 3
a96 2
indicates that the file is most likely a troff input file,
just as the keyword 
d103 1
a103 1
.I tar
d136 1
a136 1
.IR ls (1).
d146 1
a146 1
.IR magic (5)
d149 1
a149 1
.IR Strings (1), " od" (1)
d182 1
a182 1
.IR file (1)
d201 1
a201 1
.I file
d208 2
a209 2
.I file
command in every UNIX since at least Research Version 6
d238 1
a238 1
.I file
d247 1
a247 1
.IR file .
d251 1
a251 1
Christos Zoulas (christos@@ee.cornell.edu), 1990-1992.
d295 1
a295 1
.I tar
d301 4
a304 3
.IR ndbm (3)
or, better yet, fixed-length ASCII strings 
for use in heterogenous network environments) for faster startup.
d308 1
a308 1
.I File
d310 7
a316 3
thus it can be misled about the contents of ASCII files.
.PP
The support for ASCII files (primarily for programming languages)
d322 3
a324 1
Their use of ASCII TAB as a field delimiter is ugly and makes
d328 3
a330 1
for e.g., troff commands vs man page macros.
d363 1
a363 1
.B tesla.ee.cornell.edu
d365 1
a365 1
.BR /pub/file-X.YY.tar.gz
@


1.2
log
@update from netbsd
@
text
@d1 1
a2 1
.\" $Id: file.1,v 1.8 1995/10/27 23:33:18 christos Exp $
@


1.1
log
@Initial revision
@
text
@d2 1
a2 1
.\" $Id: file.1,v 1.7 1995/03/25 22:35:42 christos Exp $
d16 1
a16 1
magicfile ]
d103 3
a105 2
.B \-m file
Specify an alternate file of magic numbers.
d133 4
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
