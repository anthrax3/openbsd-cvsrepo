head	1.3;
access;
symbols
	OPENBSD_3_0:1.2.0.4
	OPENBSD_3_0_BASE:1.2
	OPENBSD_2_9_BASE:1.2
	OPENBSD_2_9:1.2.0.2
	OPENBSD_2_8:1.1.0.18
	OPENBSD_2_8_BASE:1.1
	OPENBSD_2_7:1.1.0.16
	OPENBSD_2_7_BASE:1.1
	OPENBSD_2_6:1.1.0.14
	OPENBSD_2_6_BASE:1.1
	OPENBSD_2_5:1.1.0.12
	OPENBSD_2_5_BASE:1.1
	OPENBSD_2_4:1.1.0.10
	OPENBSD_2_4_BASE:1.1
	OPENBSD_2_3:1.1.0.8
	OPENBSD_2_3_BASE:1.1
	OPENBSD_2_2:1.1.0.6
	OPENBSD_2_2_BASE:1.1
	OPENBSD_2_1:1.1.0.4
	OPENBSD_2_1_BASE:1.1
	OPENBSD_2_0:1.1.0.2
	OPENBSD_2_0_BASE:1.1;
locks; strict;
comment	@# @;


1.3
date	2002.02.19.23.19.39;	author ericj;	state dead;
branches;
next	1.2;

1.2
date	2001.01.29.01.58.12;	author niklas;	state Exp;
branches;
next	1.1;

1.1
date	96.09.05.08.55.41;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.3
log
@
remove more old cruft
@
text
@#! /bin/sh
#	$OpenBSD: iscan,v 1.2 2001/01/29 01:58:12 niklas Exp $

## duplicate DaveG's ident-scan thingie using netcat.  Oooh, he'll be pissed.
## args: target port [port port port ...]
## hose stdout *and* stderr together.
##
## advantages: runs slower than ident-scan, giving remote inetd less cause
## for alarm, and only hits the few known daemon ports you specify.
## disadvantages: requires numeric-only port args, the output sleazitude,
## and won't work for r-services when coming from high source ports.

case "${2}" in
  "" ) echo needs HOST and at least one PORT ; exit 1 ;;
esac

# ping 'em once and see if they *are* running identd
nc -z -w 9 "$1" 113 || { echo "oops, $1 isn't running identd" ; exit 0 ; }

# generate a randomish base port
RP=`expr $$ % 999 + 31337`

TRG="$1"
shift

while test "$1" ; do
  nc -v -w 8 -p ${RP} "$TRG" ${1} < /dev/null > /dev/null &
  PROC=$!
  sleep 3
  echo "${1},${RP}" | nc -w 4 -r "$TRG" 113 2>&1
  sleep 2
# does this look like a lamer script or what...
  kill -HUP $PROC
  RP=`expr ${RP} + 1`
  shift
done

@


1.2
log
@$OpenBSD$
@
text
@d2 1
a2 1
#	$OpenBSD$
@


1.1
log
@nc is *hobbit*'s netcat; let the sysadm have the same tools the crackers
have, so that he may learn what the network is about and protect it better.
@
text
@d2 2
@

