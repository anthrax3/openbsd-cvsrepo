head	1.49;
access;
symbols
	OPENBSD_6_2:1.49.0.2
	OPENBSD_6_2_BASE:1.49
	OPENBSD_6_1:1.48.0.10
	OPENBSD_6_1_BASE:1.48
	OPENBSD_6_0:1.48.0.8
	OPENBSD_6_0_BASE:1.48
	OPENBSD_5_9:1.48.0.4
	OPENBSD_5_9_BASE:1.48
	OPENBSD_5_8:1.48.0.2
	OPENBSD_5_8_BASE:1.48
	OPENBSD_5_7:1.46.0.2
	OPENBSD_5_7_BASE:1.46
	OPENBSD_5_6:1.45.0.4
	OPENBSD_5_6_BASE:1.45
	OPENBSD_5_5:1.44.0.4
	OPENBSD_5_5_BASE:1.44
	OPENBSD_5_4:1.43.0.8
	OPENBSD_5_4_BASE:1.43
	OPENBSD_5_3:1.43.0.6
	OPENBSD_5_3_BASE:1.43
	OPENBSD_5_2:1.43.0.4
	OPENBSD_5_2_BASE:1.43
	OPENBSD_5_1_BASE:1.43
	OPENBSD_5_1:1.43.0.2
	OPENBSD_5_0:1.42.0.12
	OPENBSD_5_0_BASE:1.42
	OPENBSD_4_9:1.42.0.10
	OPENBSD_4_9_BASE:1.42
	OPENBSD_4_8:1.42.0.8
	OPENBSD_4_8_BASE:1.42
	OPENBSD_4_7:1.42.0.4
	OPENBSD_4_7_BASE:1.42
	OPENBSD_4_6:1.42.0.6
	OPENBSD_4_6_BASE:1.42
	OPENBSD_4_5:1.42.0.2
	OPENBSD_4_5_BASE:1.42
	OPENBSD_4_4:1.41.0.8
	OPENBSD_4_4_BASE:1.41
	OPENBSD_4_3:1.41.0.6
	OPENBSD_4_3_BASE:1.41
	OPENBSD_4_2:1.41.0.4
	OPENBSD_4_2_BASE:1.41
	OPENBSD_4_1:1.41.0.2
	OPENBSD_4_1_BASE:1.41
	OPENBSD_4_0:1.40.0.4
	OPENBSD_4_0_BASE:1.40
	OPENBSD_3_9:1.39.0.6
	OPENBSD_3_9_BASE:1.39
	OPENBSD_3_8:1.39.0.4
	OPENBSD_3_8_BASE:1.39
	OPENBSD_3_7:1.39.0.2
	OPENBSD_3_7_BASE:1.39
	OPENBSD_3_6:1.38.0.2
	OPENBSD_3_6_BASE:1.38
	OPENBSD_3_5:1.37.0.2
	OPENBSD_3_5_BASE:1.37
	OPENBSD_3_4:1.36.0.2
	OPENBSD_3_4_BASE:1.36
	OPENBSD_3_3:1.33.0.4
	OPENBSD_3_3_BASE:1.33
	OPENBSD_3_2:1.33.0.2
	OPENBSD_3_2_BASE:1.33
	OPENBSD_3_1:1.32.0.2
	OPENBSD_3_1_BASE:1.32
	OPENBSD_3_0:1.29.0.2
	OPENBSD_3_0_BASE:1.29
	OPENBSD_2_9_BASE:1.23
	OPENBSD_2_9:1.23.0.2
	OPENBSD_2_8:1.11.0.2
	OPENBSD_2_8_BASE:1.11
	OPENBSD_2_7:1.7.0.2
	OPENBSD_2_7_BASE:1.7
	OPENBSD_2_6:1.2.0.2
	OPENBSD_2_6_BASE:1.2;
locks; strict;
comment	@ * @;


1.49
date	2017.04.30.23.13.25;	author djm;	state Exp;
branches;
next	1.48;
commitid	Ss7V57MvgEZubdtr;

1.48
date	2015.05.26.23.23.40;	author dtucker;	state Exp;
branches;
next	1.47;
commitid	tyWYnKYZbJa3qfav;

1.47
date	2015.04.10.05.16.50;	author dtucker;	state Exp;
branches;
next	1.46;
commitid	ik64gItc8q2DmTsj;

1.46
date	2015.01.19.20.20.20;	author markus;	state Exp;
branches;
next	1.45;
commitid	LpkFFtLiqWKzX2Ia;

1.45
date	2014.04.18.23.52.25;	author djm;	state Exp;
branches;
next	1.44;

1.44
date	2013.12.30.23.52.27;	author djm;	state Exp;
branches
	1.44.4.1;
next	1.43;

1.43
date	2011.09.23.07.45.05;	author markus;	state Exp;
branches;
next	1.42;

1.42
date	2008.09.11.14.22.37;	author markus;	state Exp;
branches;
next	1.41;

1.41
date	2006.12.12.03.58.42;	author djm;	state Exp;
branches;
next	1.40;

1.40
date	2006.03.25.22.22.43;	author djm;	state Exp;
branches;
next	1.39;

1.39
date	2005.03.01.10.09.52;	author djm;	state Exp;
branches
	1.39.4.1
	1.39.6.1;
next	1.38;

1.38
date	2004.07.11.17.48.47;	author deraadt;	state Exp;
branches
	1.38.2.1;
next	1.37;

1.37
date	2003.11.02.11.01.03;	author markus;	state Exp;
branches
	1.37.2.1;
next	1.36;

1.36
date	2003.08.29.10.03.15;	author markus;	state Exp;
branches
	1.36.2.1;
next	1.35;

1.35
date	2003.08.22.10.56.09;	author markus;	state Exp;
branches;
next	1.34;

1.34
date	2003.04.01.10.31.26;	author markus;	state Exp;
branches;
next	1.33;

1.33
date	2002.09.27.10.42.09;	author mickey;	state Exp;
branches
	1.33.2.1
	1.33.4.1;
next	1.32;

1.32
date	2002.04.10.08.21.47;	author markus;	state Exp;
branches
	1.32.2.1;
next	1.31;

1.31
date	2002.03.25.21.13.51;	author markus;	state Exp;
branches;
next	1.30;

1.30
date	2002.03.04.17.27.39;	author stevesk;	state Exp;
branches;
next	1.29;

1.29
date	2001.09.20.13.50.40;	author markus;	state Exp;
branches
	1.29.2.1;
next	1.28;

1.28
date	2001.06.26.17.27.23;	author markus;	state Exp;
branches;
next	1.27;

1.27
date	2001.06.26.06.32.50;	author itojun;	state Exp;
branches;
next	1.26;

1.26
date	2001.06.25.08.25.37;	author markus;	state Exp;
branches;
next	1.25;

1.25
date	2001.04.30.15.50.46;	author markus;	state Exp;
branches;
next	1.24;

1.24
date	2001.04.29.19.16.52;	author markus;	state Exp;
branches;
next	1.23;

1.23
date	2001.04.12.19.15.24;	author markus;	state Exp;
branches
	1.23.2.1;
next	1.22;

1.22
date	2001.04.05.11.09.17;	author markus;	state Exp;
branches;
next	1.21;

1.21
date	2001.03.27.17.46.49;	author provos;	state Exp;
branches;
next	1.20;

1.20
date	2001.03.27.10.57.00;	author markus;	state Exp;
branches;
next	1.19;

1.19
date	2001.03.23.11.04.06;	author djm;	state Exp;
branches;
next	1.18;

1.18
date	2001.03.18.23.30.55;	author deraadt;	state Exp;
branches;
next	1.17;

1.17
date	2001.03.10.15.31.00;	author deraadt;	state Exp;
branches;
next	1.16;

1.16
date	2001.03.08.21.42.32;	author markus;	state Exp;
branches;
next	1.15;

1.15
date	2001.02.19.09.53.31;	author markus;	state Exp;
branches;
next	1.14;

1.14
date	2001.01.08.22.29.05;	author markus;	state Exp;
branches;
next	1.13;

1.13
date	2000.12.06.22.58.15;	author markus;	state Exp;
branches;
next	1.12;

1.12
date	2000.12.03.11.15.03;	author markus;	state Exp;
branches;
next	1.11;

1.11
date	2000.10.14.12.16.56;	author markus;	state Exp;
branches
	1.11.2.1;
next	1.10;

1.10
date	2000.09.07.20.27.50;	author deraadt;	state Exp;
branches;
next	1.9;

1.9
date	2000.06.20.01.39.40;	author markus;	state Exp;
branches;
next	1.8;

1.8
date	2000.06.19.00.50.11;	author markus;	state Exp;
branches;
next	1.7;

1.7
date	2000.05.08.17.42.24;	author markus;	state Exp;
branches
	1.7.2.1;
next	1.6;

1.6
date	2000.04.12.07.45.44;	author markus;	state Exp;
branches;
next	1.5;

1.5
date	2000.04.03.07.07.15;	author markus;	state Exp;
branches;
next	1.4;

1.4
date	99.11.24.16.15.24;	author markus;	state Exp;
branches;
next	1.3;

1.3
date	99.11.24.00.26.01;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	99.10.16.22.29.01;	author markus;	state Exp;
branches;
next	1.1;

1.1
date	99.10.16.20.47.13;	author markus;	state Exp;
branches;
next	;

1.7.2.1
date	2000.09.01.18.23.19;	author jason;	state Exp;
branches;
next	1.7.2.2;

1.7.2.2
date	2000.11.08.21.30.39;	author jason;	state Exp;
branches;
next	1.7.2.3;

1.7.2.3
date	2001.03.12.15.44.09;	author jason;	state Exp;
branches;
next	1.7.2.4;

1.7.2.4
date	2001.03.21.18.52.42;	author jason;	state Exp;
branches;
next	;

1.11.2.1
date	2001.02.16.20.12.59;	author jason;	state Exp;
branches;
next	1.11.2.2;

1.11.2.2
date	2001.02.19.17.18.50;	author jason;	state Exp;
branches;
next	1.11.2.3;

1.11.2.3
date	2001.03.21.19.46.24;	author jason;	state Exp;
branches;
next	1.11.2.4;

1.11.2.4
date	2001.05.07.21.09.28;	author jason;	state Exp;
branches;
next	1.11.2.5;

1.11.2.5
date	2001.09.27.00.15.41;	author miod;	state Exp;
branches;
next	1.11.2.6;

1.11.2.6
date	2002.03.08.17.04.42;	author brad;	state Exp;
branches;
next	;

1.23.2.1
date	2001.09.27.19.03.54;	author jason;	state Exp;
branches;
next	1.23.2.2;

1.23.2.2
date	2002.03.09.00.20.44;	author miod;	state Exp;
branches;
next	1.23.2.3;

1.23.2.3
date	2002.06.02.22.56.10;	author miod;	state Exp;
branches;
next	;

1.29.2.1
date	2002.03.07.17.37.46;	author jason;	state Exp;
branches;
next	1.29.2.2;

1.29.2.2
date	2002.05.17.00.03.23;	author miod;	state Exp;
branches;
next	1.29.2.3;

1.29.2.3
date	2002.10.11.14.53.06;	author miod;	state Exp;
branches;
next	;

1.32.2.1
date	2002.10.11.14.51.52;	author miod;	state Exp;
branches;
next	1.32.2.2;

1.32.2.2
date	2003.04.03.22.35.17;	author miod;	state Exp;
branches;
next	;

1.33.2.1
date	2003.04.03.23.27.12;	author margarida;	state Exp;
branches;
next	1.33.2.2;

1.33.2.2
date	2003.09.16.21.20.25;	author brad;	state Exp;
branches;
next	;

1.33.4.1
date	2003.05.11.12.01.52;	author margarida;	state Exp;
branches;
next	1.33.4.2;

1.33.4.2
date	2003.09.16.20.50.43;	author brad;	state Exp;
branches;
next	1.33.4.3;

1.33.4.3
date	2004.03.04.18.18.15;	author brad;	state Exp;
branches;
next	;

1.36.2.1
date	2004.02.28.03.51.33;	author brad;	state Exp;
branches;
next	1.36.2.2;

1.36.2.2
date	2004.08.19.22.37.31;	author brad;	state Exp;
branches;
next	;

1.37.2.1
date	2004.08.19.04.13.26;	author brad;	state Exp;
branches;
next	1.37.2.2;

1.37.2.2
date	2005.03.10.17.15.04;	author brad;	state Exp;
branches;
next	;

1.38.2.1
date	2005.03.10.16.28.27;	author brad;	state Exp;
branches;
next	;

1.39.4.1
date	2006.10.06.03.19.32;	author brad;	state Exp;
branches;
next	;

1.39.6.1
date	2006.09.30.04.06.50;	author brad;	state Exp;
branches;
next	;

1.44.4.1
date	2014.04.21.00.30.48;	author djm;	state Exp;
branches;
next	;


desc
@@


1.49
log
@remove compat20/compat13/compat15 variables

ok markus@@
@
text
@/* $OpenBSD: compat.h,v 1.48 2015/05/26 23:23:40 dtucker Exp $ */

/*
 * Copyright (c) 1999, 2000, 2001 Markus Friedl.  All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 *
 * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
 * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
 * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
 * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
 * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
 * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef COMPAT_H
#define COMPAT_H

#define	SSH_PROTO_UNKNOWN	0x00
#define	SSH_PROTO_1		0x01
#define	SSH_PROTO_1_PREFERRED	0x02
#define	SSH_PROTO_2		0x04

#define SSH_BUG_SIGBLOB		0x00000001
#define SSH_BUG_PKSERVICE	0x00000002
#define SSH_BUG_HMAC		0x00000004
#define SSH_BUG_X11FWD		0x00000008
#define SSH_OLD_SESSIONID	0x00000010
#define SSH_BUG_PKAUTH		0x00000020
#define SSH_BUG_DEBUG		0x00000040
#define SSH_BUG_BANNER		0x00000080
#define SSH_BUG_IGNOREMSG	0x00000100
#define SSH_BUG_PKOK		0x00000200
#define SSH_BUG_PASSWORDPAD	0x00000400
#define SSH_BUG_SCANNER		0x00000800
#define SSH_BUG_BIGENDIANAES	0x00001000
#define SSH_BUG_RSASIGMD5	0x00002000
#define SSH_OLD_DHGEX		0x00004000
#define SSH_BUG_NOREKEY		0x00008000
#define SSH_BUG_HBSERVICE	0x00010000
#define SSH_BUG_OPENFAILURE	0x00020000
#define SSH_BUG_DERIVEKEY	0x00040000
#define SSH_BUG_DUMMYCHAN	0x00100000
#define SSH_BUG_EXTEOF		0x00200000
#define SSH_BUG_PROBE		0x00400000
#define SSH_BUG_FIRSTKEX	0x00800000
#define SSH_OLD_FORWARD_ADDR	0x01000000
#define SSH_BUG_RFWD_ADDR	0x02000000
#define SSH_NEW_OPENSSH		0x04000000
#define SSH_BUG_DYNAMIC_RPORT	0x08000000
#define SSH_BUG_CURVE25519PAD	0x10000000
#define SSH_BUG_HOSTKEYS	0x20000000
#define SSH_BUG_DHGEX_LARGE	0x40000000

u_int    compat_datafellows(const char *);
int	 proto_spec(const char *);
char	*compat_cipher_proposal(char *);
char	*compat_pkalg_proposal(char *);
char	*compat_kex_proposal(char *);

extern int datafellows;
#endif
@


1.48
log
@Cap DH-GEX group size at 4kbits for Cisco implementations.  Some of them
will choke when asked for preferred sizes >4k instead of returning the 4k
group that they do have.  bz#2209, ok djm@@
@
text
@d1 1
a1 1
/* $OpenBSD: compat.h,v 1.47 2015/04/10 05:16:50 dtucker Exp $ */
a65 2
void     enable_compat13(void);
void     enable_compat20(void);
a71 2
extern int compat13;
extern int compat20;
@


1.47
log
@Don't send hostkey advertisments (hostkeys-00@@openssh.com) to current
versions of Tera Term as they can't handle them.  Newer versions should
be OK.  Patch from Bryan Drewery and IWAMOTO Kouichi, ok djm@@
@
text
@d1 1
a1 1
/* $OpenBSD: compat.h,v 1.46 2015/01/19 20:20:20 markus Exp $ */
d64 1
@


1.46
log
@store compat flags in struct ssh; ok djm@@
@
text
@d1 1
a1 1
/* $OpenBSD: compat.h,v 1.45 2014/04/18 23:52:25 djm Exp $ */
d63 1
@


1.45
log
@OpenSSH 6.5 and 6.6 have a bug that causes ~0.2% of connections
using the curve25519-sha256@@libssh.org KEX exchange method to fail
when connecting with something that implements the spec properly.

Disable this KEX method when speaking to one of the affected
versions.

reported by Aris Adamantiadis; ok markus@@
@
text
@d1 1
a1 1
/* $OpenBSD: compat.h,v 1.44 2013/12/30 23:52:27 djm Exp $ */
d66 1
a66 1
void     compat_datafellows(const char *);
@


1.44
log
@refuse RSA keys from old proprietary clients/servers that use the
obsolete RSA+MD5 signature scheme. it will still be possible to connect
with these clients/servers but only DSA keys will be accepted, and we'll
deprecate them entirely in a future release. ok markus@@
@
text
@d1 1
a1 1
/* $OpenBSD: compat.h,v 1.43 2011/09/23 07:45:05 markus Exp $ */
d62 1
d70 1
@


1.44.4.1
log
@MFC:

reliability fix for OpenSSH using curve25519-sha256@@libssh.org key
exchange method.

revision 1.71
date: 2014/04/18 23:52:25;  author: djm;  state: Exp;  lines: +2 -2;
OpenSSH 6.5 and 6.6 have a bug that causes ~0.2% of connections
using the curve25519-sha256@@libssh.org KEX exchange method to fail
when connecting with something that implements the spec properly.

Disable this KEX method when speaking to one of the affected
versions.

revision 1.57
date: 2014/04/16 23:22:45;  author: djm;  state: Exp;  lines: +4 -1;
skip leading zero bytes in buffer_put_bignum2_from_string();
reported by jan AT mojzis.com; ok markus@@
@
text
@d1 1
a1 1
/* $OpenBSD: compat.h,v 1.44 2013/12/30 23:52:27 djm Exp $ */
a61 1
#define SSH_BUG_CURVE25519PAD	0x10000000
a68 1
char	*compat_kex_proposal(char *);
@


1.43
log
@unbreak remote portforwarding with dynamic allocated listen ports:
1) send the actual listen port in the open message (instead of 0).
   this allows multiple forwardings with a dynamic listen port
2) update the matching permit-open entry, so we can identify where
   to connect to
report: den at skbkontur.ru and P. Szczygielski
feedback and ok djm@@
@
text
@d1 1
a1 1
/* $OpenBSD: compat.h,v 1.42 2008/09/11 14:22:37 markus Exp $ */
d68 1
@


1.42
log
@only send eow and no-more-sessions requests to openssh 5 and newer;
fixes interop problems with broken ssh v2 implementations; ok djm@@
@
text
@d1 1
a1 1
/* $OpenBSD: compat.h,v 1.41 2006/12/12 03:58:42 djm Exp $ */
d61 1
@


1.41
log
@bz #1019: some ssh.com versions apparently can't cope with the remote port
forwarding bind_address being a hostname, so send them an address for cases
where they are not explicitly specified (wildcard or localhost bind).
reported by daveroth AT acm.org; ok dtucker@@ deraadt@@
@
text
@d1 1
a1 1
/* $OpenBSD: compat.h,v 1.40 2006/03/25 22:22:43 djm Exp $ */
d60 1
@


1.40
log
@standardise spacing in $OpenBSD$ tags; requested by deraadt@@
@
text
@d1 1
a1 1
/* $OpenBSD: compat.h,v 1.39 2005/03/01 10:09:52 djm Exp $ */
d59 1
@


1.39
log
@bz#413: allow optional specification of bind address for port forwardings.
Patch originally by Dan Astorian, but worked on by several people
Adds GatewayPorts=clientspecified option on server to allow remote forwards
to bind to client-specified ports.

ok markus@@
@
text
@d1 1
a1 1
/*	$OpenBSD: compat.h,v 1.38 2004/07/11 17:48:47 deraadt Exp $	*/
@


1.39.4.1
log
@upgrade to OpenSSH 4.4
@
text
@d1 1
a1 1
/* $OpenBSD: compat.h,v 1.40 2006/03/25 22:22:43 djm Exp $ */
@


1.39.6.1
log
@upgrade to OpenSSH 4.4
@
text
@d1 1
a1 1
/* $OpenBSD: compat.h,v 1.40 2006/03/25 22:22:43 djm Exp $ */
@


1.38
log
@spaces
@
text
@d1 1
a1 1
/*	$OpenBSD: compat.h,v 1.37 2003/11/02 11:01:03 markus Exp $	*/
d58 1
@


1.38.2.1
log
@upgrade to OpenSSH 4.0
@
text
@d1 1
a1 1
/*	$OpenBSD: compat.h,v 1.39 2005/03/01 10:09:52 djm Exp $	*/
a57 1
#define SSH_OLD_FORWARD_ADDR	0x01000000
@


1.37
log
@remove support for SSH_BUG_GSSAPI_BER; simon@@sxw.org.uk
@
text
@d1 1
a1 1
/*	$OpenBSD: compat.h,v 1.36 2003/08/29 10:03:15 markus Exp $	*/
d30 1
a30 1
#define	SSH_PROTO_UNKNOWN 	0x00
@


1.37.2.1
log
@upgrade to OpenSSH 3.9
@
text
@d1 1
a1 1
/*	$OpenBSD: compat.h,v 1.38 2004/07/11 17:48:47 deraadt Exp $	*/
d30 1
a30 1
#define	SSH_PROTO_UNKNOWN	0x00
@


1.37.2.2
log
@upgrade to OpenSSH 4.0
@
text
@d1 1
a1 1
/*	$OpenBSD: compat.h,v 1.39 2005/03/01 10:09:52 djm Exp $	*/
a57 1
#define SSH_OLD_FORWARD_ADDR	0x01000000
@


1.36
log
@SSH_BUG_K5USER is unused; ok henning@@
@
text
@d1 1
a1 1
/*	$OpenBSD: compat.h,v 1.35 2003/08/22 10:56:09 markus Exp $	*/
a57 1
#define SSH_BUG_GSSAPI_BER	0x01000000
@


1.36.2.1
log
@upgrade to OpenSSH 3.8
@
text
@d1 1
a1 1
/*	$OpenBSD: compat.h,v 1.37 2003/11/02 11:01:03 markus Exp $	*/
d58 1
@


1.36.2.2
log
@upgrade to OpenSSH 3.9
@
text
@d1 1
a1 1
/*	$OpenBSD: compat.h,v 1.38 2004/07/11 17:48:47 deraadt Exp $	*/
d30 1
a30 1
#define	SSH_PROTO_UNKNOWN	0x00
@


1.35
log
@support GSS API user authentication; patches from Simon Wilkinson,
stripped down and tested by Jakob and myself.
@
text
@d1 1
a1 1
/*	$OpenBSD: compat.h,v 1.34 2003/04/01 10:31:26 markus Exp $	*/
d56 3
a58 4
#define SSH_BUG_K5USER		0x00400000
#define SSH_BUG_PROBE		0x00800000
#define SSH_BUG_FIRSTKEX	0x01000000
#define SSH_BUG_GSSAPI_BER	0x02000000
@


1.34
log
@bugfix causes stalled connections for ssh.com < 3.0; noticed by ho@@; tested by ho@@ and myself
@
text
@d1 1
a1 1
/*	$OpenBSD: compat.h,v 1.33 2002/09/27 10:42:09 mickey Exp $	*/
d59 1
@


1.33
log
@add a generic match for a prober, such as sie big brother; idea from stevesk@@; markus@@ ok
@
text
@d1 1
a1 1
/*	$OpenBSD: compat.h,v 1.32 2002/04/10 08:21:47 markus Exp $	*/
d58 1
@


1.33.4.1
log
@Update OpenSSH to version 3.6.1
@
text
@d1 1
a1 1
/*	$OpenBSD: compat.h,v 1.33.2.1 2003/04/03 23:27:12 margarida Exp $	*/
a57 1
#define SSH_BUG_FIRSTKEX	0x01000000
@


1.33.4.2
log
@upgrade to OpenSSH 3.7
@
text
@d1 1
a1 1
/*	$OpenBSD: compat.h,v 1.36 2003/08/29 10:03:15 markus Exp $	*/
d56 3
a58 3
#define SSH_BUG_PROBE		0x00400000
#define SSH_BUG_FIRSTKEX	0x00800000
#define SSH_BUG_GSSAPI_BER	0x01000000
@


1.33.4.3
log
@upgrade to OpenSSH 3.8upgrade to OpenSSH 3.8upgrade to OpenSSH 3.8
@
text
@d1 1
a1 1
/*	$OpenBSD: compat.h,v 1.37 2003/11/02 11:01:03 markus Exp $	*/
d58 1
@


1.33.2.1
log
@Update to OpenSSH 3.6.1
@
text
@d1 1
a1 1
/*	$OpenBSD: compat.h,v 1.34 2003/04/01 10:31:26 markus Exp $	*/
a57 1
#define SSH_BUG_FIRSTKEX	0x01000000
@


1.33.2.2
log
@upgrade to OpenSSH 3.7
@
text
@d1 1
a1 1
/*	$OpenBSD: compat.h,v 1.36 2003/08/29 10:03:15 markus Exp $	*/
d56 3
a58 3
#define SSH_BUG_PROBE		0x00400000
#define SSH_BUG_FIRSTKEX	0x00800000
#define SSH_BUG_GSSAPI_BER	0x01000000
@


1.32
log
@strip '@@' from username only for KerbV and known broken clients, bug #204
@
text
@d1 1
a1 1
/*	$OpenBSD: compat.h,v 1.31 2002/03/25 21:13:51 markus Exp $	*/
d57 1
@


1.32.2.1
log
@Update to OpenSSH 3.5
@
text
@d1 1
a1 1
/*	$OpenBSD: compat.h,v 1.33 2002/09/27 10:42:09 mickey Exp $	*/
a56 1
#define SSH_BUG_PROBE		0x00800000
@


1.32.2.2
log
@Merge OpenSSH 3.6.1
@
text
@d1 1
a1 1
/*	$OpenBSD: compat.h,v 1.34 2003/04/01 10:31:26 markus Exp $	*/
a57 1
#define SSH_BUG_FIRSTKEX	0x01000000
@


1.31
log
@don't send stderr data after EOF, accept this from older known (broken)
sshd servers only, fixes http://bugzilla.mindrot.org/show_bug.cgi?id=179
@
text
@d1 1
a1 1
/*	$OpenBSD: compat.h,v 1.30 2002/03/04 17:27:39 stevesk Exp $	*/
d56 1
@


1.30
log
@$OpenBSD$ and RCSID() cleanup: don't use RCSID() in .h files; add
missing RCSID() to .c files and remove dup /*$OpenBSD$*/ from .c
files.  ok markus@@
@
text
@d1 1
a1 1
/*	$OpenBSD: compat.h,v 1.29 2001/09/20 13:50:40 markus Exp $	*/
d55 1
@


1.29
log
@bug compat: request a dummy channel for -N (no shell) sessions + cleanup; vinschen@@redhat.com
@
text
@d1 2
a25 1
/* RCSID("$OpenBSD: compat.h,v 1.28 2001/06/26 17:27:23 markus Exp $"); */
@


1.29.2.1
log
@Update to OpenSSH-3.1 on 3.0-stable branch
@
text
@a0 2
/*	$OpenBSD: compat.h,v 1.30 2002/03/04 17:27:39 stevesk Exp $	*/

d24 1
@


1.29.2.2
log
@Update OpenSSH to version 3.2.2.
@
text
@d1 1
a1 1
/*	$OpenBSD: compat.h,v 1.32 2002/04/10 08:21:47 markus Exp $	*/
a54 2
#define SSH_BUG_EXTEOF		0x00200000
#define SSH_BUG_K5USER		0x00400000
@


1.29.2.3
log
@Update to OpenSSH 3.5
@
text
@d1 1
a1 1
/*	$OpenBSD: compat.h,v 1.33 2002/09/27 10:42:09 mickey Exp $	*/
a56 1
#define SSH_BUG_PROBE		0x00800000
@


1.28
log
@remove comments from .h, since they are cut&paste from the .c files
and out of sync
@
text
@d24 1
a24 1
/* RCSID("$OpenBSD: compat.h,v 1.27 2001/06/26 06:32:50 itojun Exp $"); */
d53 1
@


1.27
log
@prototype pedant.  not very creative...
- () -> (void)
- no variable names
@
text
@d24 1
a24 1
/* RCSID("$OpenBSD: compat.h,v 1.26 2001/06/25 08:25:37 markus Exp $"); */
d54 4
a57 4
void    enable_compat13(void);
void    enable_compat20(void);
void    compat_datafellows(const char *);
int	proto_spec(const char *);
d59 1
@


1.26
log
@update copyright for 2001
@
text
@d24 1
a24 1
/* RCSID("$OpenBSD: compat.h,v 1.25 2001/04/30 15:50:46 markus Exp $"); */
d56 3
a58 3
void    compat_datafellows(const char *s);
int	proto_spec(const char *spec);
char	*compat_cipher_proposal(char *cipher_prop);
@


1.25
log
@allow interop with weaker key generation used by ssh-2.0.x, x < 10
@
text
@d2 1
a2 1
 * Copyright (c) 1999 Markus Friedl.  All rights reserved.
d24 1
a24 1
/* RCSID("$OpenBSD: compat.h,v 1.24 2001/04/29 19:16:52 markus Exp $"); */
@


1.24
log
@more ssh.com-2.0.x bug-compat; from per@@appgate.com
@
text
@d24 1
a24 1
/* RCSID("$OpenBSD: compat.h,v 1.23 2001/04/12 19:15:24 markus Exp $"); */
d52 1
@


1.23
log
@implement HostbasedAuthentication (= RhostRSAAuthentication for ssh v2)
similar to RhostRSAAuthentication unless you enable (the experimental)
HostbasedUsesNameFromPacketOnly option.  please test. :)
@
text
@d24 1
a24 1
/* RCSID("$OpenBSD: compat.h,v 1.22 2001/04/05 11:09:17 markus Exp $"); */
d34 18
a51 17
#define SSH_BUG_SIGBLOB		0x0001
#define SSH_BUG_PKSERVICE	0x0002
#define SSH_BUG_HMAC		0x0004
#define SSH_BUG_X11FWD		0x0008
#define SSH_OLD_SESSIONID	0x0010
#define SSH_BUG_PKAUTH		0x0020
#define SSH_BUG_DEBUG		0x0040
#define SSH_BUG_BANNER		0x0080
#define SSH_BUG_IGNOREMSG	0x0100
#define SSH_BUG_PKOK		0x0200
#define SSH_BUG_PASSWORDPAD	0x0400
#define SSH_BUG_SCANNER		0x0800
#define SSH_BUG_BIGENDIANAES	0x1000
#define SSH_BUG_RSASIGMD5	0x2000
#define SSH_OLD_DHGEX		0x4000
#define SSH_BUG_NOREKEY		0x8000
#define SSH_BUG_HBSERVICE	0x10000
@


1.23.2.1
log
@Pull in OpenSSH-2.9.9
@
text
@d2 1
a2 1
 * Copyright (c) 1999, 2000, 2001 Markus Friedl.  All rights reserved.
d24 1
a24 1
/* RCSID("$OpenBSD: compat.h,v 1.29 2001/09/20 13:50:40 markus Exp $"); */
d34 17
a50 26
#define SSH_BUG_SIGBLOB		0x00000001
#define SSH_BUG_PKSERVICE	0x00000002
#define SSH_BUG_HMAC		0x00000004
#define SSH_BUG_X11FWD		0x00000008
#define SSH_OLD_SESSIONID	0x00000010
#define SSH_BUG_PKAUTH		0x00000020
#define SSH_BUG_DEBUG		0x00000040
#define SSH_BUG_BANNER		0x00000080
#define SSH_BUG_IGNOREMSG	0x00000100
#define SSH_BUG_PKOK		0x00000200
#define SSH_BUG_PASSWORDPAD	0x00000400
#define SSH_BUG_SCANNER		0x00000800
#define SSH_BUG_BIGENDIANAES	0x00001000
#define SSH_BUG_RSASIGMD5	0x00002000
#define SSH_OLD_DHGEX		0x00004000
#define SSH_BUG_NOREKEY		0x00008000
#define SSH_BUG_HBSERVICE	0x00010000
#define SSH_BUG_OPENFAILURE	0x00020000
#define SSH_BUG_DERIVEKEY	0x00040000
#define SSH_BUG_DUMMYCHAN	0x00100000

void     enable_compat13(void);
void     enable_compat20(void);
void     compat_datafellows(const char *);
int	 proto_spec(const char *);
char	*compat_cipher_proposal(char *);
d52 5
@


1.23.2.2
log
@Merge OpenSSH 3.1, keeping /etc as configuration files directory.
(i.e. OpenSSH 3.1 + openbsd29_3.1.patch)
@
text
@a0 2
/*	$OpenBSD: compat.h,v 1.30 2002/03/04 17:27:39 stevesk Exp $	*/

d24 1
@


1.23.2.3
log
@Upgrade to OpenSSH 3.2.3.

Except for improbable compilation error fixes, this should be the last
commit made to the 2.9-STABLE branche. Have fun upgrading.
@
text
@d1 1
a1 1
/*	$OpenBSD: compat.h,v 1.32 2002/04/10 08:21:47 markus Exp $	*/
a54 2
#define SSH_BUG_EXTEOF		0x00200000
#define SSH_BUG_K5USER		0x00400000
@


1.22
log
@add SSH_BUG_NOREKEY and detect broken (=all old) openssh versions.
@
text
@d24 1
a24 1
/* RCSID("$OpenBSD: compat.h,v 1.21 2001/03/27 17:46:49 provos Exp $"); */
d50 1
@


1.21
log
@make dh group exchange more flexible, allow min and max group size,
okay markus@@, deraadt@@
@
text
@d24 1
a24 1
/* RCSID("$OpenBSD: compat.h,v 1.20 2001/03/27 10:57:00 markus Exp $"); */
d49 1
@


1.20
log
@some older systems use NID_md5 instead of NID_sha1 for RSASSA-PKCS1-v1_5
signatures in SSH protocol 2, ok djm@@
@
text
@d24 1
a24 1
/* RCSID("$OpenBSD: compat.h,v 1.19 2001/03/23 11:04:06 djm Exp $"); */
d48 1
@


1.19
log
@Compat for OpenSSH with broken Rijndael/AES. ok markus@@
@
text
@d24 1
a24 1
/* RCSID("$OpenBSD: compat.h,v 1.18 2001/03/18 23:30:55 deraadt Exp $"); */
d47 1
@


1.18
log
@specifically version match on ssh scanners.  do not log scan information
to the console, because clueless users freak out when people do completely
legal probes.  instead, generate a detailed log file entry and use british
humour to relax their sphincters a little bit.
@
text
@d24 1
a24 1
/* RCSID("$OpenBSD: compat.h,v 1.17 2001/03/10 15:31:00 deraadt Exp $"); */
d46 1
d52 1
@


1.17
log
@all known netscreen ssh versions, and older versions of OSU ssh cannot
handle password padding (newer OSU is fixed)
@
text
@d24 1
a24 1
/* RCSID("$OpenBSD: compat.h,v 1.16 2001/03/08 21:42:32 markus Exp $"); */
d45 1
@


1.16
log
@implement client side of SSH2_MSG_USERAUTH_PK_OK (test public key ->
no need to do enter passphrase or do expensive sign operations if the
server does not accept key).
@
text
@d24 1
a24 1
/* RCSID("$OpenBSD: compat.h,v 1.15 2001/02/19 09:53:31 markus Exp $"); */
d44 1
@


1.15
log
@ssh-1.2.{18-22} has broken handling of ignore messages; report from itojun@@
@
text
@d24 1
a24 1
/* RCSID("$OpenBSD: compat.h,v 1.14 2001/01/08 22:29:05 markus Exp $"); */
d43 1
@


1.14
log
@implement option 'Banner /etc/issue.net' for ssh2, move version to
2.3.1 (needed for bugcompat detection, 2.3.0 would fail if Banner
is enabled).
@
text
@d24 1
a24 1
/* RCSID("$OpenBSD: compat.h,v 1.13 2000/12/06 22:58:15 markus Exp $"); */
d34 9
a42 8
#define SSH_BUG_SIGBLOB		0x01
#define SSH_BUG_PKSERVICE	0x02
#define SSH_BUG_HMAC		0x04
#define SSH_BUG_X11FWD		0x08
#define SSH_OLD_SESSIONID	0x10
#define SSH_BUG_PKAUTH		0x20
#define SSH_BUG_DEBUG		0x40
#define SSH_BUG_BANNER		0x80
@


1.13
log
@disable debug messages for ssh.com/f-secure 2.0.1x, 2.1.0
@
text
@d24 1
a24 1
/* RCSID("$OpenBSD: compat.h,v 1.12 2000/12/03 11:15:03 markus Exp $"); */
d41 1
@


1.12
log
@support f-secure/ssh.com 2.0.12; ok niels@@
@
text
@d24 1
a24 1
/* RCSID("$OpenBSD: compat.h,v 1.11 2000/10/14 12:16:56 markus Exp $"); */
d40 1
@


1.11
log
@OpenSSH_2.3; note that is is not complete, but the version number needs to be changed for interoperability reasons
@
text
@d24 1
a24 1
/* RCSID("$OpenBSD: compat.h,v 1.10 2000/09/07 20:27:50 deraadt Exp $"); */
d35 1
a35 1
#define SSH_BUG_PUBKEYAUTH	0x02
d39 1
@


1.11.2.1
log
@Pull in OpenSSH 2.5.0
@
text
@d24 1
a24 1
/* RCSID("$OpenBSD: compat.h,v 1.14 2001/01/08 22:29:05 markus Exp $"); */
d35 1
a35 1
#define SSH_BUG_PKSERVICE	0x02
a38 3
#define SSH_BUG_PKAUTH		0x20
#define SSH_BUG_DEBUG		0x40
#define SSH_BUG_BANNER		0x80
@


1.11.2.2
log
@Pull in OpenSSH-2.5.1
@
text
@d24 1
a24 1
/* RCSID("$OpenBSD: compat.h,v 1.15 2001/02/19 09:53:31 markus Exp $"); */
d34 8
a41 9
#define SSH_BUG_SIGBLOB		0x0001
#define SSH_BUG_PKSERVICE	0x0002
#define SSH_BUG_HMAC		0x0004
#define SSH_BUG_X11FWD		0x0008
#define SSH_OLD_SESSIONID	0x0010
#define SSH_BUG_PKAUTH		0x0020
#define SSH_BUG_DEBUG		0x0040
#define SSH_BUG_BANNER		0x0080
#define SSH_BUG_IGNOREMSG	0x0100
@


1.11.2.3
log
@Pull in OpenSSH-2.5.2 for 2.8 branch.
@
text
@d24 1
a24 1
/* RCSID("$OpenBSD: compat.h,v 1.18 2001/03/18 23:30:55 deraadt Exp $"); */
a42 3
#define SSH_BUG_PKOK		0x0200
#define SSH_BUG_PASSWORDPAD	0x0400
#define SSH_BUG_SCANNER		0x0800
@


1.11.2.4
log
@Pull in OpenSSH-2.9 to 2.8 branch.
@
text
@d24 1
a24 1
/* RCSID("$OpenBSD: compat.h,v 1.23 2001/04/12 19:15:24 markus Exp $"); */
a45 5
#define SSH_BUG_BIGENDIANAES	0x1000
#define SSH_BUG_RSASIGMD5	0x2000
#define SSH_OLD_DHGEX		0x4000
#define SSH_BUG_NOREKEY		0x8000
#define SSH_BUG_HBSERVICE	0x10000
a50 1
char	*compat_cipher_proposal(char *cipher_prop);
@


1.11.2.5
log
@Pull in OpenSSH 2.9.9 to the 2.8 branch.
@
text
@d2 1
a2 1
 * Copyright (c) 1999, 2000, 2001 Markus Friedl.  All rights reserved.
d24 1
a24 1
/* RCSID("$OpenBSD: compat.h,v 1.29 2001/09/20 13:50:40 markus Exp $"); */
d34 17
a50 26
#define SSH_BUG_SIGBLOB		0x00000001
#define SSH_BUG_PKSERVICE	0x00000002
#define SSH_BUG_HMAC		0x00000004
#define SSH_BUG_X11FWD		0x00000008
#define SSH_OLD_SESSIONID	0x00000010
#define SSH_BUG_PKAUTH		0x00000020
#define SSH_BUG_DEBUG		0x00000040
#define SSH_BUG_BANNER		0x00000080
#define SSH_BUG_IGNOREMSG	0x00000100
#define SSH_BUG_PKOK		0x00000200
#define SSH_BUG_PASSWORDPAD	0x00000400
#define SSH_BUG_SCANNER		0x00000800
#define SSH_BUG_BIGENDIANAES	0x00001000
#define SSH_BUG_RSASIGMD5	0x00002000
#define SSH_OLD_DHGEX		0x00004000
#define SSH_BUG_NOREKEY		0x00008000
#define SSH_BUG_HBSERVICE	0x00010000
#define SSH_BUG_OPENFAILURE	0x00020000
#define SSH_BUG_DERIVEKEY	0x00040000
#define SSH_BUG_DUMMYCHAN	0x00100000

void     enable_compat13(void);
void     enable_compat20(void);
void     compat_datafellows(const char *);
int	 proto_spec(const char *);
char	*compat_cipher_proposal(char *);
d52 5
@


1.11.2.6
log
@Merge OpenSSH 3.1.
@
text
@a0 2
/*	$OpenBSD: compat.h,v 1.30 2002/03/04 17:27:39 stevesk Exp $	*/

d24 1
@


1.10
log
@cleanup copyright notices on all files.  I have attempted to be accurate with
the details.  everything is now under Tatu's licence (which I copied from his
readme), and/or the core-sdi bsd-ish thing for deattack, or various openbsd
developers under a 2-term bsd licence.  We're not changing any rules, just
being accurate.
@
text
@d24 1
a24 1
/* RCSID("$OpenBSD: compat.h,v 1.9 2000/06/20 01:39:40 markus Exp $"); */
d38 1
a38 1
#define SSH_COMPAT_SESSIONID_ENCODING		0x10
@


1.9
log
@OpenBSD tag
@
text
@a11 5
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 *      This product includes software developed by Markus Friedl.
 * 4. The name of the author may not be used to endorse or promote products
 *    derived from this software without specific prior written permission.
d24 1
a24 1
/* RCSID("$OpenBSD: compat.h,v 1.8 2000/06/19 00:50:11 markus Exp $"); */
@


1.8
log
@make userauth+pubkey interop with ssh.com-2.2.0
@
text
@d29 1
a29 1
/* RCSID("$Id: compat.h,v 1.7 2000/05/08 17:42:24 markus Exp $"); */
@


1.7
log
@bug compat w/ ssh-2.0.13 x11, split out bugs
@
text
@d29 1
a29 1
/* RCSID("$Id: compat.h,v 1.6 2000/04/12 07:45:44 markus Exp $"); */
d43 1
@


1.7.2.1
log
@Pull in the rest of openssh-2.2.0 to 2.7 branch (luvin' cvs...)
@
text
@d29 1
a29 1
/* RCSID("$OpenBSD: compat.h,v 1.9 2000/06/20 01:39:40 markus Exp $"); */
a42 1
#define SSH_COMPAT_SESSIONID_ENCODING		0x10
@


1.7.2.2
log
@openssh-2.3.0 (again) for 2.7 branch
@
text
@d12 5
d29 1
a29 1
/* RCSID("$OpenBSD: compat.h,v 1.11 2000/10/14 12:16:56 markus Exp $"); */
d43 1
a43 1
#define SSH_OLD_SESSIONID	0x10
@


1.7.2.3
log
@OpenSSH-2.5.1 for 2.7 patch branch
@
text
@d24 1
a24 1
/* RCSID("$OpenBSD: compat.h,v 1.15 2001/02/19 09:53:31 markus Exp $"); */
d34 5
a38 9
#define SSH_BUG_SIGBLOB		0x0001
#define SSH_BUG_PKSERVICE	0x0002
#define SSH_BUG_HMAC		0x0004
#define SSH_BUG_X11FWD		0x0008
#define SSH_OLD_SESSIONID	0x0010
#define SSH_BUG_PKAUTH		0x0020
#define SSH_BUG_DEBUG		0x0040
#define SSH_BUG_BANNER		0x0080
#define SSH_BUG_IGNOREMSG	0x0100
@


1.7.2.4
log
@Pull in OpenSSH-2.5.2 for 2.7 branch.
@
text
@d24 1
a24 1
/* RCSID("$OpenBSD: compat.h,v 1.18 2001/03/18 23:30:55 deraadt Exp $"); */
a42 3
#define SSH_BUG_PKOK		0x0200
#define SSH_BUG_PASSWORDPAD	0x0400
#define SSH_BUG_SCANNER		0x0800
@


1.6
log
@add Cipher and Protocol options to ssh/sshd, e.g.:
ssh -o 'Protocol 1,2' if you prefer proto 1, ssh -o 'Ciphers arcfour,3des-cbc'
@
text
@d29 1
a29 1
/* RCSID("$Id: compat.h,v 1.5 2000/04/03 07:07:15 markus Exp $"); */
d38 5
@


1.5
log
@channel layer support for ssh2
@
text
@d29 1
a29 1
/* RCSID("$Id: compat.h,v 1.4 1999/11/24 16:15:24 markus Exp $"); */
d33 6
d42 1
@


1.4
log
@missing copyright
@
text
@d29 1
a29 1
/* RCSID("$Id: compat.h,v 1.3 1999/11/24 00:26:01 deraadt Exp $"); */
d34 2
d37 2
@


1.3
log
@much more KNF
@
text
@d1 29
a29 1
/* RCSID("$Id: compat.h,v 1.2 1999/10/16 22:29:01 markus Exp $"); */
@


1.2
log
@add CVS tags, fix comments and whitespace
@
text
@d1 1
a1 1
/* RCSID("$Id: servconf.h,v 1.9 1999/10/12 18:11:54 markus Exp $"); */
d5 1
a5 1
void enable_compat13(void);
@


1.1
log
@support for SSH protocol 1.5 which is poorly documented, the RFC.troff lies.
interops (x11,agent,etc) with 1.2.27 and protocol 1.3
@
text
@d1 2
@

