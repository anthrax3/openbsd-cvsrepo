head	1.21;
access;
symbols
	OPENBSD_6_1:1.21.0.2
	OPENBSD_6_1_BASE:1.21
	OPENBSD_6_0:1.21.0.4
	OPENBSD_6_0_BASE:1.21
	OPENBSD_5_9:1.20.0.12
	OPENBSD_5_9_BASE:1.20
	OPENBSD_5_8:1.20.0.10
	OPENBSD_5_8_BASE:1.20
	OPENBSD_5_7:1.20.0.4
	OPENBSD_5_7_BASE:1.20
	OPENBSD_5_6:1.20.0.8
	OPENBSD_5_6_BASE:1.20
	OPENBSD_5_5:1.20.0.6
	OPENBSD_5_5_BASE:1.20
	OPENBSD_5_4:1.20.0.2
	OPENBSD_5_4_BASE:1.20
	OPENBSD_5_3:1.19.0.2
	OPENBSD_5_3_BASE:1.19
	OPENBSD_5_2:1.18.0.6
	OPENBSD_5_2_BASE:1.18
	OPENBSD_5_1_BASE:1.18
	OPENBSD_5_1:1.18.0.4
	OPENBSD_5_0:1.18.0.2
	OPENBSD_5_0_BASE:1.18
	OPENBSD_4_9:1.17.0.12
	OPENBSD_4_9_BASE:1.17
	OPENBSD_4_8:1.17.0.10
	OPENBSD_4_8_BASE:1.17
	OPENBSD_4_7:1.17.0.6
	OPENBSD_4_7_BASE:1.17
	OPENBSD_4_6:1.17.0.8
	OPENBSD_4_6_BASE:1.17
	OPENBSD_4_5:1.17.0.4
	OPENBSD_4_5_BASE:1.17
	OPENBSD_4_4:1.17.0.2
	OPENBSD_4_4_BASE:1.17
	OPENBSD_4_3:1.15.0.8
	OPENBSD_4_3_BASE:1.15
	OPENBSD_4_2:1.15.0.6
	OPENBSD_4_2_BASE:1.15
	OPENBSD_4_1:1.15.0.2
	OPENBSD_4_1_BASE:1.15
	OPENBSD_4_0:1.15.0.4
	OPENBSD_4_0_BASE:1.15
	OPENBSD_3_9:1.11.0.8
	OPENBSD_3_9_BASE:1.11
	OPENBSD_3_8:1.11.0.6
	OPENBSD_3_8_BASE:1.11
	OPENBSD_3_7:1.11.0.4
	OPENBSD_3_7_BASE:1.11
	OPENBSD_3_6:1.11.0.2
	OPENBSD_3_6_BASE:1.11
	OPENBSD_3_5:1.10.0.2
	OPENBSD_3_5_BASE:1.10
	OPENBSD_3_4:1.9.0.2
	OPENBSD_3_4_BASE:1.9
	OPENBSD_3_3:1.8.0.4
	OPENBSD_3_3_BASE:1.8
	OPENBSD_3_2:1.8.0.2
	OPENBSD_3_2_BASE:1.8
	OPENBSD_3_1:1.6.0.2
	OPENBSD_3_1_BASE:1.6
	OPENBSD_3_0:1.4.0.2
	OPENBSD_3_0_BASE:1.4
	OPENBSD_2_9_BASE:1.2
	OPENBSD_2_9:1.2.0.6
	OPENBSD_2_7:1.2.0.4
	OPENBSD_2_8:1.2.0.2;
locks; strict;
comment	@ * @;


1.21
date	2016.07.15.05.01.58;	author dtucker;	state Exp;
branches;
next	1.20;
commitid	npD1qIqfl2rHEc4G;

1.20
date	2013.04.07.02.10.33;	author dtucker;	state Exp;
branches;
next	1.19;

1.19
date	2012.09.06.04.37.39;	author dtucker;	state Exp;
branches;
next	1.18;

1.18
date	2011.06.17.21.44.30;	author djm;	state Exp;
branches;
next	1.17;

1.17
date	2008.06.13.00.12.02;	author dtucker;	state Exp;
branches;
next	1.16;

1.16
date	2008.06.10.04.50.25;	author dtucker;	state Exp;
branches;
next	1.15;

1.15
date	2006.08.18.09.13.25;	author deraadt;	state Exp;
branches;
next	1.14;

1.14
date	2006.08.03.03.34.42;	author deraadt;	state Exp;
branches;
next	1.13;

1.13
date	2006.07.10.16.37.36;	author stevesk;	state Exp;
branches;
next	1.12;

1.12
date	2006.03.25.22.22.43;	author djm;	state Exp;
branches;
next	1.11;

1.11
date	2004.06.21.22.02.58;	author djm;	state Exp;
branches
	1.11.6.1
	1.11.8.1;
next	1.10;

1.10
date	2003.09.23.20.17.11;	author markus;	state Exp;
branches
	1.10.2.1;
next	1.9;

1.9
date	2003.04.08.20.21.28;	author itojun;	state Exp;
branches
	1.9.2.1;
next	1.8;

1.8
date	2002.07.19.15.43.33;	author markus;	state Exp;
branches
	1.8.2.1
	1.8.4.1;
next	1.7;

1.7
date	2002.05.19.20.54.52;	author deraadt;	state Exp;
branches;
next	1.6;

1.6
date	2002.02.22.12.20.34;	author markus;	state Exp;
branches
	1.6.2.1;
next	1.5;

1.5
date	2002.02.04.12.15.25;	author markus;	state Exp;
branches;
next	1.4;

1.4
date	2001.06.26.17.27.24;	author markus;	state Exp;
branches
	1.4.2.1;
next	1.3;

1.3
date	2001.06.26.06.32.55;	author itojun;	state Exp;
branches;
next	1.2;

1.2
date	2001.01.29.01.58.16;	author niklas;	state Exp;
branches
	1.2.2.1
	1.2.4.1
	1.2.6.1;
next	1.1;

1.1
date	2001.01.21.19.05.51;	author markus;	state Exp;
branches;
next	;

1.2.2.1
date	2001.02.16.20.13.05;	author jason;	state Exp;
branches;
next	1.2.2.2;

1.2.2.2
date	2001.02.19.17.19.02;	author jason;	state Exp;
branches;
next	1.2.2.3;

1.2.2.3
date	2001.03.21.19.46.26;	author jason;	state Exp;
branches;
next	1.2.2.4;

1.2.2.4
date	2001.05.07.21.09.30;	author jason;	state Exp;
branches;
next	1.2.2.5;

1.2.2.5
date	2001.09.27.00.15.42;	author miod;	state Exp;
branches;
next	1.2.2.6;

1.2.2.6
date	2002.03.08.17.04.42;	author brad;	state Exp;
branches;
next	;

1.2.4.1
date	2001.03.12.15.44.11;	author jason;	state Exp;
branches;
next	1.2.4.2;

1.2.4.2
date	2001.03.21.18.52.49;	author jason;	state Exp;
branches;
next	;

1.2.6.1
date	2001.09.27.19.03.54;	author jason;	state Exp;
branches;
next	1.2.6.2;

1.2.6.2
date	2002.03.09.00.20.44;	author miod;	state Exp;
branches;
next	;

1.4.2.1
date	2002.03.07.17.37.46;	author jason;	state Exp;
branches;
next	1.4.2.2;

1.4.2.2
date	2002.06.22.07.23.17;	author miod;	state Exp;
branches;
next	1.4.2.3;

1.4.2.3
date	2002.10.11.14.53.06;	author miod;	state Exp;
branches;
next	;

1.6.2.1
date	2002.06.26.15.30.38;	author jason;	state Exp;
branches;
next	1.6.2.2;

1.6.2.2
date	2002.10.11.14.51.52;	author miod;	state Exp;
branches;
next	;

1.8.2.1
date	2003.09.16.21.20.26;	author brad;	state Exp;
branches;
next	;

1.8.4.1
date	2003.09.16.20.50.43;	author brad;	state Exp;
branches;
next	1.8.4.2;

1.8.4.2
date	2004.03.04.18.18.15;	author brad;	state Exp;
branches;
next	;

1.9.2.1
date	2004.02.28.03.51.33;	author brad;	state Exp;
branches;
next	1.9.2.2;

1.9.2.2
date	2004.08.19.22.37.31;	author brad;	state Exp;
branches;
next	;

1.10.2.1
date	2004.08.19.04.13.26;	author brad;	state Exp;
branches;
next	;

1.11.6.1
date	2006.10.06.03.19.32;	author brad;	state Exp;
branches;
next	;

1.11.8.1
date	2006.09.30.04.06.50;	author brad;	state Exp;
branches;
next	;


desc
@@


1.21
log
@Reduce the syslog level of some relatively common protocol events
from LOG_CRIT by replacing fatal() calls with logdie().  Part of
bz#2585, ok djm@@
@
text
@/* $OpenBSD: log.h,v 1.20 2013/04/07 02:10:33 dtucker Exp $ */

/*
 * Author: Tatu Ylonen <ylo@@cs.hut.fi>
 * Copyright (c) 1995 Tatu Ylonen <ylo@@cs.hut.fi>, Espoo, Finland
 *                    All rights reserved
 *
 * As far as I am concerned, the code I have written for this software
 * can be used freely for any purpose.  Any derived versions of this
 * software must be clearly marked as such, and if the derived work is
 * incompatible with the protocol description in the RFC file, it must be
 * called by a name other than "ssh" or "Secure Shell".
 */

#ifndef SSH_LOG_H
#define SSH_LOG_H

/* Supported syslog facilities and levels. */
typedef enum {
	SYSLOG_FACILITY_DAEMON,
	SYSLOG_FACILITY_USER,
	SYSLOG_FACILITY_AUTH,
	SYSLOG_FACILITY_LOCAL0,
	SYSLOG_FACILITY_LOCAL1,
	SYSLOG_FACILITY_LOCAL2,
	SYSLOG_FACILITY_LOCAL3,
	SYSLOG_FACILITY_LOCAL4,
	SYSLOG_FACILITY_LOCAL5,
	SYSLOG_FACILITY_LOCAL6,
	SYSLOG_FACILITY_LOCAL7,
	SYSLOG_FACILITY_NOT_SET = -1
}       SyslogFacility;

typedef enum {
	SYSLOG_LEVEL_QUIET,
	SYSLOG_LEVEL_FATAL,
	SYSLOG_LEVEL_ERROR,
	SYSLOG_LEVEL_INFO,
	SYSLOG_LEVEL_VERBOSE,
	SYSLOG_LEVEL_DEBUG1,
	SYSLOG_LEVEL_DEBUG2,
	SYSLOG_LEVEL_DEBUG3,
	SYSLOG_LEVEL_NOT_SET = -1
}       LogLevel;

typedef void (log_handler_fn)(LogLevel, const char *, void *);

void     log_init(char *, LogLevel, SyslogFacility, int);
void     log_change_level(LogLevel);
int      log_is_on_stderr(void);
void     log_redirect_stderr_to(const char *);

SyslogFacility	log_facility_number(char *);
const char * 	log_facility_name(SyslogFacility);
LogLevel	log_level_number(char *);
const char *	log_level_name(LogLevel);

void     fatal(const char *, ...) __attribute__((noreturn))
    __attribute__((format(printf, 1, 2)));
void     error(const char *, ...) __attribute__((format(printf, 1, 2)));
void     sigdie(const char *, ...)  __attribute__((noreturn))
    __attribute__((format(printf, 1, 2)));
void     logdie(const char *, ...) __attribute__((noreturn))
    __attribute__((format(printf, 1, 2)));
void     logit(const char *, ...) __attribute__((format(printf, 1, 2)));
void     verbose(const char *, ...) __attribute__((format(printf, 1, 2)));
void     debug(const char *, ...) __attribute__((format(printf, 1, 2)));
void     debug2(const char *, ...) __attribute__((format(printf, 1, 2)));
void     debug3(const char *, ...) __attribute__((format(printf, 1, 2)));


void	 set_log_handler(log_handler_fn *, void *);
void	 do_log2(LogLevel, const char *, ...)
    __attribute__((format(printf, 2, 3)));
void	 do_log(LogLevel, const char *, va_list);
void	 cleanup_exit(int) __attribute__((noreturn));
#endif
@


1.20
log
@Add -E option to ssh and sshd to append debugging logs to a specified file
instead of stderr or syslog.  ok markus@@, man page help jmc@@
@
text
@d1 1
a1 1
/* $OpenBSD: log.h,v 1.19 2012/09/06 04:37:39 dtucker Exp $ */
d62 2
@


1.19
log
@Add ~v and ~V escape sequences to raise and lower the logging level
respectively. Man page help from jmc, ok deraadt jmc
@
text
@d1 1
a1 1
/* $OpenBSD: log.h,v 1.18 2011/06/17 21:44:30 djm Exp $ */
d51 1
@


1.18
log
@make the pre-auth privsep slave log via a socketpair shared with the
monitor rather than /var/empty/dev/log; ok dtucker@@ deraadt@@ markus@@
@
text
@d1 1
a1 1
/* $OpenBSD: log.h,v 1.17 2008/06/13 00:12:02 dtucker Exp $ */
d49 2
@


1.17
log
@replace __dead with __attribute__((noreturn)), makes things a little easier
to port.  Also, add it to sigdie().  ok djm@@
@
text
@d1 1
a1 1
/* $OpenBSD: log.h,v 1.16 2008/06/10 04:50:25 dtucker Exp $ */
d46 2
d66 4
@


1.16
log
@Add extended test mode (-T) and connection parameters for test mode (-C).
-T causes sshd to write its effective configuration to stdout and exit.
-C causes any relevant Match rules to be applied before output.  The
combination allows tesing of the parser and config files.  ok deraadt djm
@
text
@d1 1
a1 1
/* $OpenBSD: log.h,v 1.15 2006/08/18 09:13:25 deraadt Exp $ */
d53 2
a54 1
void     fatal(const char *, ...) __dead __attribute__((format(printf, 1, 2)));
d56 2
a57 1
void     sigdie(const char *, ...) __attribute__((format(printf, 1, 2)));
d65 1
a65 1
void	 cleanup_exit(int) __dead;
@


1.15
log
@make signal handler termination path shorter; risky code pointed out by
mark dowd; ok djm markus
@
text
@d1 1
a1 1
/* $OpenBSD: log.h,v 1.14 2006/08/03 03:34:42 deraadt Exp $ */
d49 3
a51 1
LogLevel log_level_number(char *);
@


1.14
log
@almost entirely get rid of the culture of ".h files that include .h files"
ok djm, sort of ok stevesk
makes the pain stop in one easy step
@
text
@d1 1
a1 1
/* $OpenBSD: log.h,v 1.13 2006/07/10 16:37:36 stevesk Exp $ */
d53 1
@


1.13
log
@move #include <stdarg.h> out of includes.h; ok markus@@
@
text
@d1 1
a1 1
/* $OpenBSD: log.h,v 1.12 2006/03/25 22:22:43 djm Exp $ */
a16 2

#include <stdarg.h>
@


1.12
log
@standardise spacing in $OpenBSD$ tags; requested by deraadt@@
@
text
@d1 1
a1 1
/* $OpenBSD: log.h,v 1.11 2004/06/21 22:02:58 djm Exp $ */
d17 2
@


1.11
log
@mark fatal and cleanup exit as __dead; ok markus@@
@
text
@d1 1
a1 1
/*	$OpenBSD: log.h,v 1.10 2003/09/23 20:17:11 markus Exp $	*/
@


1.11.6.1
log
@upgrade to OpenSSH 4.4
@
text
@d1 1
a1 1
/* $OpenBSD: log.h,v 1.15 2006/08/18 09:13:25 deraadt Exp $ */
a52 1
void     sigdie(const char *, ...) __attribute__((format(printf, 1, 2)));
@


1.11.8.1
log
@upgrade to OpenSSH 4.4
@
text
@d1 1
a1 1
/* $OpenBSD: log.h,v 1.15 2006/08/18 09:13:25 deraadt Exp $ */
a52 1
void     sigdie(const char *, ...) __attribute__((format(printf, 1, 2)));
@


1.10
log
@replace fatal_cleanup() and linked list of fatal callbacks with static
cleanup_exit() function.  re-refine cleanup_exit() where appropriate,
allocate sshd's authctxt eary to allow simpler cleanup in sshd.
tested by many, ok deraadt@@
@
text
@d1 1
a1 1
/*	$OpenBSD: log.h,v 1.9 2003/04/08 20:21:28 itojun Exp $	*/
d51 1
a51 1
void     fatal(const char *, ...) __attribute__((format(printf, 1, 2)));
d60 1
a60 1
void	 cleanup_exit(int);
@


1.10.2.1
log
@upgrade to OpenSSH 3.9
@
text
@d1 1
a1 1
/*	$OpenBSD: log.h,v 1.11 2004/06/21 22:02:58 djm Exp $	*/
d51 1
a51 1
void     fatal(const char *, ...) __dead __attribute__((format(printf, 1, 2)));
d60 1
a60 1
void	 cleanup_exit(int) __dead;
@


1.9
log
@rename log() into logit() to avoid name conflict.  markus ok, from netbsd
@
text
@d1 1
a1 1
/*	$OpenBSD: log.h,v 1.8 2002/07/19 15:43:33 markus Exp $	*/
a58 5
void     fatal_cleanup(void);
void     fatal_add_cleanup(void (*) (void *), void *);
void     fatal_remove_cleanup(void (*) (void *), void *);
void     fatal_remove_all_cleanups(void);

d60 1
a60 1

@


1.9.2.1
log
@upgrade to OpenSSH 3.8
@
text
@d1 1
a1 1
/*	$OpenBSD: log.h,v 1.10 2003/09/23 20:17:11 markus Exp $	*/
d59 5
d65 1
a65 1
void	 cleanup_exit(int);
@


1.9.2.2
log
@upgrade to OpenSSH 3.9
@
text
@d1 1
a1 1
/*	$OpenBSD: log.h,v 1.11 2004/06/21 22:02:58 djm Exp $	*/
d51 1
a51 1
void     fatal(const char *, ...) __dead __attribute__((format(printf, 1, 2)));
d60 1
a60 1
void	 cleanup_exit(int) __dead;
@


1.8
log
@remove fatal cleanups after fork; based on discussions with and code
from solar.
@
text
@d1 1
a1 1
/*	$OpenBSD: log.h,v 1.7 2002/05/19 20:54:52 deraadt Exp $	*/
d53 1
a53 1
void     log(const char *, ...) __attribute__((format(printf, 1, 2)));
@


1.8.2.1
log
@upgrade to OpenSSH 3.7
@
text
@d1 1
a1 1
/*	$OpenBSD: log.h,v 1.9 2003/04/08 20:21:28 itojun Exp $	*/
d53 1
a53 1
void     logit(const char *, ...) __attribute__((format(printf, 1, 2)));
@


1.8.4.1
log
@upgrade to OpenSSH 3.7
@
text
@d1 1
a1 1
/*	$OpenBSD: log.h,v 1.9 2003/04/08 20:21:28 itojun Exp $	*/
d53 1
a53 1
void     logit(const char *, ...) __attribute__((format(printf, 1, 2)));
@


1.8.4.2
log
@upgrade to OpenSSH 3.8upgrade to OpenSSH 3.8upgrade to OpenSSH 3.8
@
text
@d1 1
a1 1
/*	$OpenBSD: log.h,v 1.10 2003/09/23 20:17:11 markus Exp $	*/
d59 5
d65 1
a65 1
void	 cleanup_exit(int);
@


1.7
log
@extra commas in enum not 100% portable
@
text
@d1 1
a1 1
/*	$OpenBSD: log.h,v 1.6 2002/02/22 12:20:34 markus Exp $	*/
d62 1
@


1.6
log
@overwrite fatal() in ssh-keyscan.c; fixes pr 2354; ok provos@@
@
text
@d1 1
a1 1
/*	$OpenBSD: log.h,v 1.5 2002/02/04 12:15:25 markus Exp $	*/
d31 1
a31 1
	SYSLOG_FACILITY_NOT_SET = -1,
d43 1
a43 1
	SYSLOG_LEVEL_NOT_SET = -1,
@


1.6.2.1
log
@Pull in OpenSSH-3.4
@
text
@d1 1
a1 1
/*	$OpenBSD: log.h,v 1.7 2002/05/19 20:54:52 deraadt Exp $	*/
d31 1
a31 1
	SYSLOG_FACILITY_NOT_SET = -1
d43 1
a43 1
	SYSLOG_LEVEL_NOT_SET = -1
@


1.6.2.2
log
@Update to OpenSSH 3.5
@
text
@d1 1
a1 1
/*	$OpenBSD: log.h,v 1.8 2002/07/19 15:43:33 markus Exp $	*/
a61 1
void     fatal_remove_all_cleanups(void);
@


1.5
log
@add SYSLOG_FACILITY_NOT_SET = -1, SYSLOG_LEVEL_NOT_SET = -1,
fixes arm/netbsd; based on patch from bjh21@@netbsd.org; ok djm@@
@
text
@d1 1
a1 1
/*	$OpenBSD: log.h,v 1.4 2001/06/26 17:27:24 markus Exp $	*/
d62 2
@


1.4
log
@remove comments from .h, since they are cut&paste from the .c files
and out of sync
@
text
@d1 1
a1 1
/*	$OpenBSD: log.h,v 1.3 2001/06/26 06:32:55 itojun Exp $	*/
d30 2
a31 1
	SYSLOG_FACILITY_LOCAL7
d42 2
a43 1
	SYSLOG_LEVEL_DEBUG3
@


1.4.2.1
log
@Update to OpenSSH-3.1 on 3.0-stable branch
@
text
@d1 1
a1 1
/*	$OpenBSD: log.h,v 1.6 2002/02/22 12:20:34 markus Exp $	*/
d30 1
a30 2
	SYSLOG_FACILITY_LOCAL7,
	SYSLOG_FACILITY_NOT_SET = -1,
d41 1
a41 2
	SYSLOG_LEVEL_DEBUG3,
	SYSLOG_LEVEL_NOT_SET = -1,
a59 2

void	 do_log(LogLevel, const char *, va_list);
@


1.4.2.2
log
@Update OpenSSH to version 3.3 (with local changes, configuration files still
living in /etc and privsep user being nobody).
@
text
@d1 1
a1 1
/*	$OpenBSD: log.h,v 1.4.2.1 2002/03/07 17:37:46 jason Exp $	*/
d31 1
a31 1
	SYSLOG_FACILITY_NOT_SET = -1
d43 1
a43 1
	SYSLOG_LEVEL_NOT_SET = -1
@


1.4.2.3
log
@Update to OpenSSH 3.5
@
text
@d1 1
a1 1
/*	$OpenBSD: log.h,v 1.8 2002/07/19 15:43:33 markus Exp $	*/
a61 1
void     fatal_remove_all_cleanups(void);
@


1.3
log
@prototype pedant.  not very creative...
- () -> (void)
- no variable names
@
text
@d1 1
a1 1
/*	$OpenBSD: log.h,v 1.2 2001/01/29 01:58:16 niklas Exp $	*/
a42 2
/* Initializes logging. */
void    log_init(char *, LogLevel, SyslogFacility, int);
d44 1
a44 2
/* Logging implementation, depending on server or client */
void    do_log(LogLevel, const char *, va_list);
d46 1
a46 2
/* name to facility/level */
SyslogFacility log_facility_number(char *);
d49 11
a59 21
/* Output a message to syslog or stderr */
void    fatal(const char *, ...) __attribute__((format(printf, 1, 2)));
void    error(const char *, ...) __attribute__((format(printf, 1, 2)));
void    log(const char *, ...) __attribute__((format(printf, 1, 2)));
void    verbose(const char *, ...) __attribute__((format(printf, 1, 2)));
void    debug(const char *, ...) __attribute__((format(printf, 1, 2)));
void    debug2(const char *, ...) __attribute__((format(printf, 1, 2)));
void    debug3(const char *, ...) __attribute__((format(printf, 1, 2)));

/* same as fatal() but w/o logging */
void    fatal_cleanup(void);

/*
 * Registers a cleanup function to be called by fatal()/fatal_cleanup()
 * before exiting. It is permissible to call fatal_remove_cleanup for the
 * function itself from the function.
 */
void    fatal_add_cleanup(void (*) (void *), void *);

/* Removes a cleanup function to be called at fatal(). */
void    fatal_remove_cleanup(void (*) (void *), void *);
@


1.2
log
@$OpenBSD$
@
text
@d1 1
a1 1
/*	$OpenBSD$	*/
d44 1
a44 1
void    log_init(char *av0, LogLevel level, SyslogFacility facility, int on_stderr);
d47 1
a47 1
void    do_log(LogLevel level, const char *fmt, va_list args);
d50 2
a51 2
SyslogFacility log_facility_number(char *name);
LogLevel log_level_number(char *name);
d54 7
a60 7
void    fatal(const char *fmt,...) __attribute__((format(printf, 1, 2)));
void    error(const char *fmt,...) __attribute__((format(printf, 1, 2)));
void    log(const char *fmt,...) __attribute__((format(printf, 1, 2)));
void    verbose(const char *fmt,...) __attribute__((format(printf, 1, 2)));
void    debug(const char *fmt,...) __attribute__((format(printf, 1, 2)));
void    debug2(const char *fmt,...) __attribute__((format(printf, 1, 2)));
void    debug3(const char *fmt,...) __attribute__((format(printf, 1, 2)));
d70 1
a70 1
void    fatal_add_cleanup(void (*proc) (void *context), void *context);
d73 1
a73 1
void    fatal_remove_cleanup(void (*proc) (void *context), void *context);
@


1.2.6.1
log
@Pull in OpenSSH-2.9.9
@
text
@d1 1
a1 1
/*	$OpenBSD: log.h,v 1.4 2001/06/26 17:27:24 markus Exp $	*/
d43 2
d46 2
a47 1
void     log_init(char *, LogLevel, SyslogFacility, int);
d49 12
a60 2
SyslogFacility	log_facility_number(char *);
LogLevel log_level_number(char *);
d62 12
a73 11
void     fatal(const char *, ...) __attribute__((format(printf, 1, 2)));
void     error(const char *, ...) __attribute__((format(printf, 1, 2)));
void     log(const char *, ...) __attribute__((format(printf, 1, 2)));
void     verbose(const char *, ...) __attribute__((format(printf, 1, 2)));
void     debug(const char *, ...) __attribute__((format(printf, 1, 2)));
void     debug2(const char *, ...) __attribute__((format(printf, 1, 2)));
void     debug3(const char *, ...) __attribute__((format(printf, 1, 2)));

void     fatal_cleanup(void);
void     fatal_add_cleanup(void (*) (void *), void *);
void     fatal_remove_cleanup(void (*) (void *), void *);
@


1.2.6.2
log
@Merge OpenSSH 3.1, keeping /etc as configuration files directory.
(i.e. OpenSSH 3.1 + openbsd29_3.1.patch)
@
text
@d1 1
a1 1
/*	$OpenBSD: log.h,v 1.6 2002/02/22 12:20:34 markus Exp $	*/
d30 1
a30 2
	SYSLOG_FACILITY_LOCAL7,
	SYSLOG_FACILITY_NOT_SET = -1,
d41 1
a41 2
	SYSLOG_LEVEL_DEBUG3,
	SYSLOG_LEVEL_NOT_SET = -1,
a59 2

void	 do_log(LogLevel, const char *, va_list);
@


1.2.4.1
log
@OpenSSH-2.5.1 for 2.7 patch branch
@
text
@d1 1
a1 1
/*	$OpenBSD: log.h,v 1.2 2001/01/29 01:58:16 niklas Exp $	*/
@


1.2.4.2
log
@Pull in OpenSSH-2.5.2 for 2.7 branch.
@
text
@@


1.2.2.1
log
@Pull in OpenSSH 2.5.0
@
text
@d1 1
a1 1
/*	$OpenBSD: log.h,v 1.2 2001/01/29 01:58:16 niklas Exp $	*/
@


1.2.2.2
log
@Pull in OpenSSH-2.5.1
@
text
@@


1.2.2.3
log
@Pull in OpenSSH-2.5.2 for 2.8 branch.
@
text
@@


1.2.2.4
log
@Pull in OpenSSH-2.9 to 2.8 branch.
@
text
@@


1.2.2.5
log
@Pull in OpenSSH 2.9.9 to the 2.8 branch.
@
text
@d1 1
a1 1
/*	$OpenBSD: log.h,v 1.4 2001/06/26 17:27:24 markus Exp $	*/
d43 2
d46 2
a47 1
void     log_init(char *, LogLevel, SyslogFacility, int);
d49 12
a60 2
SyslogFacility	log_facility_number(char *);
LogLevel log_level_number(char *);
d62 12
a73 11
void     fatal(const char *, ...) __attribute__((format(printf, 1, 2)));
void     error(const char *, ...) __attribute__((format(printf, 1, 2)));
void     log(const char *, ...) __attribute__((format(printf, 1, 2)));
void     verbose(const char *, ...) __attribute__((format(printf, 1, 2)));
void     debug(const char *, ...) __attribute__((format(printf, 1, 2)));
void     debug2(const char *, ...) __attribute__((format(printf, 1, 2)));
void     debug3(const char *, ...) __attribute__((format(printf, 1, 2)));

void     fatal_cleanup(void);
void     fatal_add_cleanup(void (*) (void *), void *);
void     fatal_remove_cleanup(void (*) (void *), void *);
@


1.2.2.6
log
@Merge OpenSSH 3.1.
@
text
@d1 1
a1 1
/*	$OpenBSD: log.h,v 1.6 2002/02/22 12:20:34 markus Exp $	*/
d30 1
a30 2
	SYSLOG_FACILITY_LOCAL7,
	SYSLOG_FACILITY_NOT_SET = -1,
d41 1
a41 2
	SYSLOG_LEVEL_DEBUG3,
	SYSLOG_LEVEL_NOT_SET = -1,
a59 2

void	 do_log(LogLevel, const char *, va_list);
@


1.1
log
@split ssh.h and try to cleanup the #include mess. remove unnecessary #includes.
rename util.[ch] -> misc.[ch]
@
text
@d1 2
@

