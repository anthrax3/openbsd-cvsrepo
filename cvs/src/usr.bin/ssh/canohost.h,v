head	1.12;
access;
symbols
	OPENBSD_6_2:1.12.0.2
	OPENBSD_6_2_BASE:1.12
	OPENBSD_6_1:1.12.0.6
	OPENBSD_6_1_BASE:1.12
	OPENBSD_6_0:1.12.0.4
	OPENBSD_6_0_BASE:1.12
	OPENBSD_5_9:1.11.0.28
	OPENBSD_5_9_BASE:1.11
	OPENBSD_5_8:1.11.0.26
	OPENBSD_5_8_BASE:1.11
	OPENBSD_5_7:1.11.0.20
	OPENBSD_5_7_BASE:1.11
	OPENBSD_5_6:1.11.0.24
	OPENBSD_5_6_BASE:1.11
	OPENBSD_5_5:1.11.0.22
	OPENBSD_5_5_BASE:1.11
	OPENBSD_5_4:1.11.0.18
	OPENBSD_5_4_BASE:1.11
	OPENBSD_5_3:1.11.0.16
	OPENBSD_5_3_BASE:1.11
	OPENBSD_5_2:1.11.0.14
	OPENBSD_5_2_BASE:1.11
	OPENBSD_5_1_BASE:1.11
	OPENBSD_5_1:1.11.0.12
	OPENBSD_5_0:1.11.0.10
	OPENBSD_5_0_BASE:1.11
	OPENBSD_4_9:1.11.0.8
	OPENBSD_4_9_BASE:1.11
	OPENBSD_4_8:1.11.0.6
	OPENBSD_4_8_BASE:1.11
	OPENBSD_4_7:1.11.0.2
	OPENBSD_4_7_BASE:1.11
	OPENBSD_4_6:1.11.0.4
	OPENBSD_4_6_BASE:1.11
	OPENBSD_4_5:1.10.0.2
	OPENBSD_4_5_BASE:1.10
	OPENBSD_4_4:1.9.0.10
	OPENBSD_4_4_BASE:1.9
	OPENBSD_4_3:1.9.0.8
	OPENBSD_4_3_BASE:1.9
	OPENBSD_4_2:1.9.0.6
	OPENBSD_4_2_BASE:1.9
	OPENBSD_4_1:1.9.0.2
	OPENBSD_4_1_BASE:1.9
	OPENBSD_4_0:1.9.0.4
	OPENBSD_4_0_BASE:1.9
	OPENBSD_3_9:1.8.0.20
	OPENBSD_3_9_BASE:1.8
	OPENBSD_3_8:1.8.0.18
	OPENBSD_3_8_BASE:1.8
	OPENBSD_3_7:1.8.0.16
	OPENBSD_3_7_BASE:1.8
	OPENBSD_3_6:1.8.0.14
	OPENBSD_3_6_BASE:1.8
	OPENBSD_3_5:1.8.0.12
	OPENBSD_3_5_BASE:1.8
	OPENBSD_3_4:1.8.0.10
	OPENBSD_3_4_BASE:1.8
	OPENBSD_3_3:1.8.0.8
	OPENBSD_3_3_BASE:1.8
	OPENBSD_3_2:1.8.0.6
	OPENBSD_3_2_BASE:1.8
	OPENBSD_3_1:1.8.0.4
	OPENBSD_3_1_BASE:1.8
	OPENBSD_3_0:1.8.0.2
	OPENBSD_3_0_BASE:1.8
	OPENBSD_2_9_BASE:1.6
	OPENBSD_2_9:1.6.0.2
	OPENBSD_2_7:1.4.0.4
	OPENBSD_2_8:1.4.0.2;
locks; strict;
comment	@ * @;


1.12
date	2016.03.07.19.02.43;	author djm;	state Exp;
branches;
next	1.11;
commitid	kr9hjdmg99uVnhW2;

1.11
date	2009.05.27.06.31.25;	author andreas;	state Exp;
branches;
next	1.10;

1.10
date	2009.02.12.03.00.56;	author djm;	state Exp;
branches;
next	1.9;

1.9
date	2006.03.25.22.22.42;	author djm;	state Exp;
branches;
next	1.8;

1.8
date	2001.06.26.17.27.23;	author markus;	state Exp;
branches
	1.8.18.1
	1.8.20.1;
next	1.7;

1.7
date	2001.06.26.06.32.49;	author itojun;	state Exp;
branches;
next	1.6;

1.6
date	2001.04.12.19.15.24;	author markus;	state Exp;
branches
	1.6.2.1;
next	1.5;

1.5
date	2001.04.05.15.48.19;	author stevesk;	state Exp;
branches;
next	1.4;

1.4
date	2001.02.03.10.08.37;	author markus;	state Exp;
branches
	1.4.2.1
	1.4.4.1;
next	1.3;

1.3
date	2001.01.29.19.42.35;	author markus;	state Exp;
branches;
next	1.2;

1.2
date	2001.01.29.01.58.15;	author niklas;	state Exp;
branches;
next	1.1;

1.1
date	2001.01.21.19.05.46;	author markus;	state Exp;
branches;
next	;

1.4.2.1
date	2001.02.16.20.12.56;	author jason;	state Exp;
branches;
next	1.4.2.2;

1.4.2.2
date	2001.02.19.17.18.44;	author jason;	state Exp;
branches;
next	1.4.2.3;

1.4.2.3
date	2001.03.21.19.46.23;	author jason;	state Exp;
branches;
next	1.4.2.4;

1.4.2.4
date	2001.05.07.21.09.27;	author jason;	state Exp;
branches;
next	1.4.2.5;

1.4.2.5
date	2001.09.27.00.15.41;	author miod;	state Exp;
branches;
next	;

1.4.4.1
date	2001.03.12.15.44.08;	author jason;	state Exp;
branches;
next	1.4.4.2;

1.4.4.2
date	2001.03.21.18.52.38;	author jason;	state Exp;
branches;
next	;

1.6.2.1
date	2001.09.27.19.03.54;	author jason;	state Exp;
branches;
next	1.6.2.2;

1.6.2.2
date	2002.03.09.00.20.44;	author miod;	state Exp;
branches;
next	;

1.8.18.1
date	2006.10.06.03.19.32;	author brad;	state Exp;
branches;
next	;

1.8.20.1
date	2006.09.30.04.06.50;	author brad;	state Exp;
branches;
next	;


desc
@@


1.12
log
@refactor canohost.c: move functions that cache results closer to the
places that use them (authn and session code). After this, no state is
cached in canohost.c

feedback and ok markus@@
@
text
@/* $OpenBSD: canohost.h,v 1.11 2009/05/27 06:31:25 andreas Exp $ */

/*
 * Author: Tatu Ylonen <ylo@@cs.hut.fi>
 * Copyright (c) 1995 Tatu Ylonen <ylo@@cs.hut.fi>, Espoo, Finland
 *                    All rights reserved
 *
 * As far as I am concerned, the code I have written for this software
 * can be used freely for any purpose.  Any derived versions of this
 * software must be clearly marked as such, and if the derived work is
 * incompatible with the protocol description in the RFC file, it must be
 * called by a name other than "ssh" or "Secure Shell".
 */

#ifndef _CANOHOST_H
#define _CANOHOST_H

char		*get_peer_ipaddr(int);
int		 get_peer_port(int);
char		*get_local_ipaddr(int);
char		*get_local_name(int);
int		get_local_port(int);

#endif /* _CANOHOST_H */
@


1.11
log
@Add clear_cached_addr(), needed for upcoming changes allowing the peer
address to change.
ok markus@@
@
text
@d1 1
a1 1
/* $OpenBSD: canohost.h,v 1.10 2009/02/12 03:00:56 djm Exp $ */
d15 2
a16 3
const char	*get_canonical_hostname(int);
const char	*get_remote_ipaddr(void);
const char	*get_remote_name_or_ip(u_int, int);
d22 1
d24 1
a24 4
int		 get_remote_port(void);
int		 get_local_port(void);
int		 get_sock_port(int, int);
void		 clear_cached_addr(void);
@


1.10
log
@support remote port forwarding with a zero listen port (-R0:...) to
dyamically allocate a listen port at runtime (this is actually
specified in rfc4254); bz#1003 ok markus@@
@
text
@d1 1
a1 1
/* $OpenBSD: canohost.h,v 1.9 2006/03/25 22:22:42 djm Exp $ */
d27 1
a27 1

@


1.9
log
@standardise spacing in $OpenBSD$ tags; requested by deraadt@@
@
text
@d1 1
a1 1
/* $OpenBSD: canohost.h,v 1.8 2001/06/26 17:27:23 markus Exp $ */
d26 2
@


1.8
log
@remove comments from .h, since they are cut&paste from the .c files
and out of sync
@
text
@d1 1
a1 1
/*	$OpenBSD: canohost.h,v 1.7 2001/06/26 06:32:49 itojun Exp $	*/
@


1.8.18.1
log
@upgrade to OpenSSH 4.4
@
text
@d1 1
a1 1
/* $OpenBSD: canohost.h,v 1.9 2006/03/25 22:22:42 djm Exp $ */
@


1.8.20.1
log
@upgrade to OpenSSH 4.4
@
text
@d1 1
a1 1
/* $OpenBSD: canohost.h,v 1.9 2006/03/25 22:22:42 djm Exp $ */
@


1.7
log
@prototype pedant.  not very creative...
- () -> (void)
- no variable names
@
text
@d1 1
a1 1
/*	$OpenBSD: canohost.h,v 1.6 2001/04/12 19:15:24 markus Exp $	*/
d15 8
a22 20
/*
 * Return the canonical name of the host in the other side of the current
 * connection (as returned by packet_get_connection).  The host name is
 * cached, so it is efficient to call this several times.
 */
const char *get_canonical_hostname(int);

/*
 * Returns the IP-address of the remote host as a string.  The returned
 * string is cached and must not be freed.
 */
const char *get_remote_ipaddr(void);

const char *get_remote_name_or_ip(u_int, int);

/* Returns the ipaddr/port number of the peer of the socket. */
char *	get_peer_ipaddr(int);
int     get_peer_port(int);
char *	get_local_ipaddr(int);
char *	get_local_name(int);
d24 2
a25 3
/* Returns the port number of the remote/local host. */
int     get_remote_port(void);
int	get_local_port(void);
@


1.6
log
@implement HostbasedAuthentication (= RhostRSAAuthentication for ssh v2)
similar to RhostRSAAuthentication unless you enable (the experimental)
HostbasedUsesNameFromPacketOnly option.  please test. :)
@
text
@d1 1
a1 1
/*	$OpenBSD: canohost.h,v 1.5 2001/04/05 15:48:19 stevesk Exp $	*/
d20 1
a20 1
const char *get_canonical_hostname(int reverse_mapping_check);
d28 1
a28 1
const char *get_remote_name_or_ip(u_int utmp_len, int reverse_mapping_check);
d31 4
a34 4
char *	get_peer_ipaddr(int socket);
int     get_peer_port(int sock);
char *	get_local_ipaddr(int socket);
char *	get_local_name(int socket);
@


1.6.2.1
log
@Pull in OpenSSH-2.9.9
@
text
@d1 1
a1 1
/*	$OpenBSD: canohost.h,v 1.8 2001/06/26 17:27:23 markus Exp $	*/
d15 20
a34 8
const char	*get_canonical_hostname(int);
const char	*get_remote_ipaddr(void);
const char	*get_remote_name_or_ip(u_int, int);

char		*get_peer_ipaddr(int);
int		 get_peer_port(int);
char		*get_local_ipaddr(int);
char		*get_local_name(int);
d36 3
a38 2
int		 get_remote_port(void);
int		 get_local_port(void);
@


1.6.2.2
log
@Merge OpenSSH 3.1, keeping /etc as configuration files directory.
(i.e. OpenSSH 3.1 + openbsd29_3.1.patch)
@
text
@@


1.5
log
@move get_remote_name_or_ip() to canohost.[ch]; for portable.  ok markus@@
@
text
@d1 1
a1 1
/*	$OpenBSD: canohost.h,v 1.4 2001/02/03 10:08:37 markus Exp $	*/
d33 2
@


1.4
log
@make ReverseMappingCheck optional in sshd_config; ok djm@@,dugsong@@
@
text
@d1 1
a1 1
/*	$OpenBSD: canohost.h,v 1.3 2001/01/29 19:42:35 markus Exp $	*/
d27 2
@


1.4.4.1
log
@OpenSSH-2.5.1 for 2.7 patch branch
@
text
@d1 1
a1 1
/*	$OpenBSD: canohost.h,v 1.4 2001/02/03 10:08:37 markus Exp $	*/
@


1.4.4.2
log
@Pull in OpenSSH-2.5.2 for 2.7 branch.
@
text
@@


1.4.2.1
log
@Pull in OpenSSH 2.5.0
@
text
@d1 1
a1 1
/*	$OpenBSD: canohost.h,v 1.4 2001/02/03 10:08:37 markus Exp $	*/
@


1.4.2.2
log
@Pull in OpenSSH-2.5.1
@
text
@@


1.4.2.3
log
@Pull in OpenSSH-2.5.2 for 2.8 branch.
@
text
@@


1.4.2.4
log
@Pull in OpenSSH-2.9 to 2.8 branch.
@
text
@d1 1
a1 1
/*	$OpenBSD: canohost.h,v 1.6 2001/04/12 19:15:24 markus Exp $	*/
a27 2
const char *get_remote_name_or_ip(u_int utmp_len, int reverse_mapping_check);

a30 2
char *	get_local_ipaddr(int socket);
char *	get_local_name(int socket);
@


1.4.2.5
log
@Pull in OpenSSH 2.9.9 to the 2.8 branch.
@
text
@d1 1
a1 1
/*	$OpenBSD: canohost.h,v 1.8 2001/06/26 17:27:23 markus Exp $	*/
d15 20
a34 8
const char	*get_canonical_hostname(int);
const char	*get_remote_ipaddr(void);
const char	*get_remote_name_or_ip(u_int, int);

char		*get_peer_ipaddr(int);
int		 get_peer_port(int);
char		*get_local_ipaddr(int);
char		*get_local_name(int);
d36 3
a38 2
int		 get_remote_port(void);
int		 get_local_port(void);
@


1.3
log
@add get_peer_ipaddr(socket), x11-fwd in ssh2 requires ipaddr, not DNS
@
text
@d1 1
a1 1
/*	$OpenBSD: canohost.h,v 1.2 2001/01/29 01:58:15 niklas Exp $	*/
a13 5
/*
 * Returns the name of the machine at the other end of the socket.  The
 * returned string should be freed by the caller.
 */
char   *get_remote_hostname(int socket);
d20 1
a20 1
const char *get_canonical_hostname(void);
d24 1
a24 1
 * string must not be freed.
@


1.2
log
@$OpenBSD$
@
text
@d1 1
a1 1
/*	$OpenBSD$	*/
d28 2
a29 2
 * Returns the remote IP address as an ascii string.  The value need not be
 * freed by the caller.
d33 2
a34 1
/* Returns the port number of the peer of the socket. */
@


1.1
log
@split ssh.h and try to cleanup the #include mess. remove unnecessary #includes.
rename util.[ch] -> misc.[ch]
@
text
@d1 2
@

