head	1.15;
access;
symbols
	OPENBSD_6_1:1.15.0.10
	OPENBSD_6_1_BASE:1.15
	OPENBSD_6_0:1.15.0.8
	OPENBSD_6_0_BASE:1.15
	OPENBSD_5_9:1.15.0.4
	OPENBSD_5_9_BASE:1.15
	OPENBSD_5_8:1.15.0.2
	OPENBSD_5_8_BASE:1.15
	OPENBSD_5_7:1.14.0.2
	OPENBSD_5_7_BASE:1.14
	OPENBSD_5_6:1.13.0.4
	OPENBSD_5_6_BASE:1.13
	OPENBSD_5_5:1.12.0.10
	OPENBSD_5_5_BASE:1.12
	OPENBSD_5_4:1.12.0.6
	OPENBSD_5_4_BASE:1.12
	OPENBSD_5_3:1.12.0.4
	OPENBSD_5_3_BASE:1.12
	OPENBSD_5_2:1.12.0.2
	OPENBSD_5_2_BASE:1.12
	OPENBSD_5_1_BASE:1.11
	OPENBSD_5_1:1.11.0.10
	OPENBSD_5_0:1.11.0.8
	OPENBSD_5_0_BASE:1.11
	OPENBSD_4_9:1.11.0.6
	OPENBSD_4_9_BASE:1.11
	OPENBSD_4_8:1.11.0.4
	OPENBSD_4_8_BASE:1.11
	OPENBSD_4_7:1.11.0.2
	OPENBSD_4_7_BASE:1.11
	OPENBSD_4_6:1.10.0.16
	OPENBSD_4_6_BASE:1.10
	OPENBSD_4_5:1.10.0.12
	OPENBSD_4_5_BASE:1.10
	OPENBSD_4_4:1.10.0.10
	OPENBSD_4_4_BASE:1.10
	OPENBSD_4_3:1.10.0.8
	OPENBSD_4_3_BASE:1.10
	OPENBSD_4_2:1.10.0.6
	OPENBSD_4_2_BASE:1.10
	OPENBSD_4_1:1.10.0.2
	OPENBSD_4_1_BASE:1.10
	OPENBSD_4_0:1.10.0.4
	OPENBSD_4_0_BASE:1.10
	OPENBSD_3_9:1.6.0.2
	OPENBSD_3_9_BASE:1.6
	OPENBSD_3_8:1.5.0.8
	OPENBSD_3_8_BASE:1.5
	OPENBSD_3_7:1.5.0.6
	OPENBSD_3_7_BASE:1.5
	OPENBSD_3_6:1.5.0.4
	OPENBSD_3_6_BASE:1.5
	OPENBSD_3_5:1.5.0.2
	OPENBSD_3_5_BASE:1.5
	OPENBSD_3_2:1.3.0.6
	OPENBSD_3_3:1.3.0.4
	OPENBSD_3_4:1.3.0.2
	OPENBSD_3_4_BASE:1.3;
locks; strict;
comment	@ * @;


1.15
date	2015.05.08.06.45.13;	author djm;	state Exp;
branches;
next	1.14;
commitid	7qzGw6zdRwtS8emI;

1.14
date	2015.01.15.09.40.00;	author djm;	state Exp;
branches;
next	1.13;
commitid	akRUKeZEbb3ylbKG;

1.13
date	2014.04.20.09.24.26;	author logan;	state Exp;
branches;
next	1.12;

1.12
date	2012.05.23.03.28.28;	author djm;	state Exp;
branches;
next	1.11;

1.11
date	2010.02.26.20.29.54;	author djm;	state Exp;
branches;
next	1.10;

1.10
date	2006.08.03.03.34.42;	author deraadt;	state Exp;
branches;
next	1.9;

1.9
date	2006.08.01.23.22.47;	author stevesk;	state Exp;
branches;
next	1.8;

1.8
date	2006.07.08.21.47.12;	author stevesk;	state Exp;
branches;
next	1.7;

1.7
date	2006.03.25.22.22.43;	author djm;	state Exp;
branches;
next	1.6;

1.6
date	2005.10.17.14.13.35;	author stevesk;	state Exp;
branches
	1.6.2.1;
next	1.5;

1.5
date	2003.11.12.16.39.58;	author jakob;	state Exp;
branches
	1.5.6.1
	1.5.8.1;
next	1.4;

1.4
date	2003.10.14.19.42.10;	author jakob;	state Exp;
branches;
next	1.3;

1.3
date	2003.05.14.22.56.51;	author jakob;	state Exp;
branches
	1.3.2.1
	1.3.4.1
	1.3.6.1;
next	1.2;

1.2
date	2003.05.14.22.51.57;	author jakob;	state Exp;
branches;
next	1.1;

1.1
date	2003.05.14.18.16.20;	author jakob;	state Exp;
branches;
next	;

1.3.2.1
date	2004.02.28.03.51.33;	author brad;	state Exp;
branches;
next	;

1.3.4.1
date	2003.09.16.20.50.43;	author brad;	state Exp;
branches;
next	1.3.4.2;

1.3.4.2
date	2004.03.04.18.18.15;	author brad;	state Exp;
branches;
next	;

1.3.6.1
date	2003.09.16.21.20.25;	author brad;	state Exp;
branches;
next	;

1.5.6.1
date	2006.02.03.02.53.44;	author brad;	state Exp;
branches;
next	;

1.5.8.1
date	2006.02.03.03.01.56;	author brad;	state Exp;
branches;
next	1.5.8.2;

1.5.8.2
date	2006.10.06.03.19.32;	author brad;	state Exp;
branches;
next	;

1.6.2.1
date	2006.09.30.04.06.50;	author brad;	state Exp;
branches;
next	;


desc
@@


1.15
log
@moar whitespace at eol
@
text
@/* $OpenBSD: dns.h,v 1.14 2015/01/15 09:40:00 djm Exp $ */

/*
 * Copyright (c) 2003 Wesley Griffin. All rights reserved.
 * Copyright (c) 2003 Jakob Schlyter. All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 *
 * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
 * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
 * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
 * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
 * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
 * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef DNS_H
#define DNS_H

enum sshfp_types {
	SSHFP_KEY_RESERVED = 0,
	SSHFP_KEY_RSA = 1,
	SSHFP_KEY_DSA = 2,
	SSHFP_KEY_ECDSA = 3,
	SSHFP_KEY_ED25519 = 4
};

enum sshfp_hashes {
	SSHFP_HASH_RESERVED = 0,
	SSHFP_HASH_SHA1 = 1,
	SSHFP_HASH_SHA256 = 2,
	SSHFP_HASH_MAX = 3
};

#define DNS_RDATACLASS_IN	1
#define DNS_RDATATYPE_SSHFP	44

#define DNS_VERIFY_FOUND	0x00000001
#define DNS_VERIFY_MATCH	0x00000002
#define DNS_VERIFY_SECURE	0x00000004

int	verify_host_key_dns(const char *, struct sockaddr *,
    struct sshkey *, int *);
int	export_dns_rr(const char *, struct sshkey *, FILE *, int);

#endif /* DNS_H */
@


1.14
log
@sync ssh-keysign, ssh-keygen and some dependencies to the new
buffer/key API; mostly mechanical, ok markus@@
@
text
@d1 1
a1 1
/* $OpenBSD: dns.h,v 1.13 2014/04/20 09:24:26 logan Exp $ */
d36 1
a36 1
	SSHFP_KEY_ED25519 = 4 
@


1.13
log
@Add support for SSHFP DNS records for ED25519 key types.

OK from djm@@
@
text
@d1 1
a1 1
/* $OpenBSD: dns.h,v 1.12 2012/05/23 03:28:28 djm Exp $ */
d53 3
a55 2
int	verify_host_key_dns(const char *, struct sockaddr *, Key *, int *);
int	export_dns_rr(const char *, Key *, FILE *, int);
@


1.12
log
@add support for RFC6594 SSHFP DNS records for ECDSA key types.
patch from bugzilla-m67 AT nulld.me in bz#1978; ok + tweak markus@@
@
text
@d1 1
a1 1
/* $OpenBSD: dns.h,v 1.11 2010/02/26 20:29:54 djm Exp $ */
d35 2
a36 1
	SSHFP_KEY_ECDSA = 3
@


1.11
log
@Add support for certificate key types for users and hosts.

OpenSSH certificate key types are not X.509 certificates, but a much
simpler format that encodes a public key, identity information and
some validity constraints and signs it with a CA key. CA keys are
regular SSH keys. This certificate style avoids the attack surface
of X.509 certificates and is very easy to deploy.

Certified host keys allow automatic acceptance of new host keys
when a CA certificate is marked as trusted in ~/.ssh/known_hosts.
see VERIFYING HOST KEYS in ssh(1) for details.

Certified user keys allow authentication of users when the signing
CA key is marked as trusted in authorized_keys. See "AUTHORIZED_KEYS
FILE FORMAT" in sshd(8) for details.

Certificates are minted using ssh-keygen(1), documentation is in
the "CERTIFICATES" section of that manpage.

Documentation on the format of certificates is in the file
PROTOCOL.certkeys

feedback and ok markus@@
@
text
@d1 1
a1 1
/* $OpenBSD: dns.h,v 1.10 2006/08/03 03:34:42 deraadt Exp $ */
d32 4
a35 3
	SSHFP_KEY_RESERVED,
	SSHFP_KEY_RSA,
	SSHFP_KEY_DSA
d39 4
a42 2
	SSHFP_HASH_RESERVED,
	SSHFP_HASH_SHA1
@


1.10
log
@almost entirely get rid of the culture of ".h files that include .h files"
ok djm, sort of ok stevesk
makes the pain stop in one easy step
@
text
@d1 1
a1 1
/* $OpenBSD: dns.h,v 1.9 2006/08/01 23:22:47 stevesk Exp $ */
d49 2
a50 2
int	verify_host_key_dns(const char *, struct sockaddr *, const Key *, int *);
int	export_dns_rr(const char *, const Key *, FILE *, int);
@


1.9
log
@move #include <stdio.h> out of includes.h
@
text
@d1 1
a1 1
/* $OpenBSD: dns.h,v 1.8 2006/07/08 21:47:12 stevesk Exp $ */
a26 7

#include "includes.h"

#include <sys/types.h>
#include <sys/socket.h>

#include <stdio.h>
@


1.8
log
@move #include <sys/socket.h> out of includes.h
@
text
@d1 1
a1 1
/* $OpenBSD: dns.h,v 1.7 2006/03/25 22:22:43 djm Exp $ */
d32 2
@


1.7
log
@standardise spacing in $OpenBSD$ tags; requested by deraadt@@
@
text
@d1 1
a1 1
/* $OpenBSD: dns.h,v 1.6 2005/10/17 14:13:35 stevesk Exp $ */
d29 3
@


1.6
log
@more cleanups; ok jakob@@
@
text
@d1 1
a1 1
/*	$OpenBSD: dns.h,v 1.5 2003/11/12 16:39:58 jakob Exp $	*/
@


1.6.2.1
log
@upgrade to OpenSSH 4.4
@
text
@d1 1
a1 1
/* $OpenBSD: dns.h,v 1.10 2006/08/03 03:34:42 deraadt Exp $ */
d27 2
@


1.5
log
@update SSHFP validation. ok markus@@
@
text
@d1 1
a1 1
/*	$OpenBSD: dns.h,v 1.4 2003/10/14 19:42:10 jakob Exp $	*/
a27 1

a49 1

@


1.5.8.1
log
@upgrade to OpenSSH 4.3
@
text
@d1 1
a1 1
/*	$OpenBSD: dns.h,v 1.6 2005/10/17 14:13:35 stevesk Exp $	*/
d28 1
d51 1
@


1.5.8.2
log
@upgrade to OpenSSH 4.4
@
text
@d1 1
a1 1
/* $OpenBSD: dns.h,v 1.10 2006/08/03 03:34:42 deraadt Exp $ */
d27 2
@


1.5.6.1
log
@upgrade to OpenSSH 4.3
@
text
@d1 1
a1 1
/*	$OpenBSD: dns.h,v 1.6 2005/10/17 14:13:35 stevesk Exp $	*/
d28 1
d51 1
@


1.4
log
@include SSHFP lookup code (not enabled by default). ok markus@@
@
text
@d1 1
a1 1
/*	$OpenBSD: dns.h,v 1.3 2003/05/14 22:56:51 jakob Exp $	*/
d48 3
a50 3
#define DNS_VERIFY_FAILED	-1
#define DNS_VERIFY_OK		0
#define DNS_VERIFY_ERROR	1
d52 3
a54 2
int	verify_host_key_dns(const char *, struct sockaddr *, Key *);
int	export_dns_rr(const char *, Key *, FILE *, int);
@


1.3
log
@rename enum
@
text
@d1 1
a1 1
/*	$OpenBSD: dns.h,v 1.2 2003/05/14 22:51:57 jakob Exp $	*/
a30 1
#ifdef DNS
a55 1
#endif /* DNS */
@


1.3.2.1
log
@upgrade to OpenSSH 3.8
@
text
@d1 1
a1 1
/*	$OpenBSD: dns.h,v 1.5 2003/11/12 16:39:58 jakob Exp $	*/
d31 1
d49 3
a51 3
#define DNS_VERIFY_FOUND	0x00000001
#define DNS_VERIFY_MATCH	0x00000002
#define DNS_VERIFY_SECURE	0x00000004
d53 2
a54 3

int	verify_host_key_dns(const char *, struct sockaddr *, const Key *, int *);
int	export_dns_rr(const char *, const Key *, FILE *, int);
d57 1
@


1.3.6.1
log
@upgrade to OpenSSH 3.7
@
text
@d1 1
a1 1
/*	$OpenBSD: dns.h,v 1.3 2003/05/14 22:56:51 jakob Exp $	*/
@


1.3.4.1
log
@upgrade to OpenSSH 3.7
@
text
@d1 1
a1 1
/*	$OpenBSD: dns.h,v 1.3 2003/05/14 22:56:51 jakob Exp $	*/
@


1.3.4.2
log
@upgrade to OpenSSH 3.8upgrade to OpenSSH 3.8upgrade to OpenSSH 3.8
@
text
@d1 1
a1 1
/*	$OpenBSD: dns.h,v 1.5 2003/11/12 16:39:58 jakob Exp $	*/
d31 1
d49 3
a51 3
#define DNS_VERIFY_FOUND	0x00000001
#define DNS_VERIFY_MATCH	0x00000002
#define DNS_VERIFY_SECURE	0x00000004
d53 2
a54 3

int	verify_host_key_dns(const char *, struct sockaddr *, const Key *, int *);
int	export_dns_rr(const char *, const Key *, FILE *, int);
d57 1
@


1.2
log
@update license, remove 3rd clause. ok author (me)
@
text
@d1 1
a1 1
/*	$OpenBSD: dns.h,v 1.1 2003/05/14 18:16:20 jakob Exp $	*/
d35 4
a38 4
enum dns_types {
	DNS_KEY_RESERVED,
	DNS_KEY_RSA,
	DNS_KEY_DSA
d41 3
a43 3
enum dns_hashes {
	DNS_HASH_RESERVED,
	DNS_HASH_SHA1
@


1.1
log
@add experimental support for verifying hos keys using DNS as described
in draft-ietf-secsh-dns-xx.txt. more information in README.dns.
ok markus@@ and henning@@
@
text
@d1 1
a1 1
/*	$OpenBSD: dns.h,v 1.1 2003/05/12 16:40:33 jakob Exp $	*/
a14 2
 * 3. The name of the author may not be used to endorse or promote products
 *    derived from this software without specific prior written permission.
@

