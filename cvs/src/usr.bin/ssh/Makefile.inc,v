head	1.50;
access;
symbols
	OPENBSD_6_1:1.50.0.10
	OPENBSD_6_1_BASE:1.50
	OPENBSD_6_0:1.50.0.8
	OPENBSD_6_0_BASE:1.50
	OPENBSD_5_9:1.50.0.4
	OPENBSD_5_9_BASE:1.50
	OPENBSD_5_8:1.50.0.2
	OPENBSD_5_8_BASE:1.50
	OPENBSD_5_7:1.47.0.2
	OPENBSD_5_7_BASE:1.47
	OPENBSD_5_6:1.46.0.4
	OPENBSD_5_6_BASE:1.46
	OPENBSD_5_5:1.44.0.4
	OPENBSD_5_5_BASE:1.44
	OPENBSD_5_4:1.39.0.12
	OPENBSD_5_4_BASE:1.39
	OPENBSD_5_3:1.39.0.10
	OPENBSD_5_3_BASE:1.39
	OPENBSD_5_2:1.39.0.8
	OPENBSD_5_2_BASE:1.39
	OPENBSD_5_1_BASE:1.39
	OPENBSD_5_1:1.39.0.6
	OPENBSD_5_0:1.39.0.4
	OPENBSD_5_0_BASE:1.39
	OPENBSD_4_9:1.39.0.2
	OPENBSD_4_9_BASE:1.39
	OPENBSD_4_8:1.36.0.4
	OPENBSD_4_8_BASE:1.36
	OPENBSD_4_7:1.36.0.2
	OPENBSD_4_7_BASE:1.36
	OPENBSD_4_6:1.33.0.6
	OPENBSD_4_6_BASE:1.33
	OPENBSD_4_5:1.33.0.2
	OPENBSD_4_5_BASE:1.33
	OPENBSD_4_4:1.32.0.2
	OPENBSD_4_4_BASE:1.32
	OPENBSD_4_3:1.30.0.12
	OPENBSD_4_3_BASE:1.30
	OPENBSD_4_2:1.30.0.10
	OPENBSD_4_2_BASE:1.30
	OPENBSD_4_1:1.30.0.6
	OPENBSD_4_1_BASE:1.30
	OPENBSD_4_0:1.30.0.8
	OPENBSD_4_0_BASE:1.30
	OPENBSD_3_9:1.30.0.4
	OPENBSD_3_9_BASE:1.30
	OPENBSD_3_8:1.30.0.2
	OPENBSD_3_8_BASE:1.30
	OPENBSD_3_7:1.29.0.4
	OPENBSD_3_7_BASE:1.29
	OPENBSD_3_6:1.29.0.2
	OPENBSD_3_6_BASE:1.29
	OPENBSD_3_5:1.27.0.2
	OPENBSD_3_5_BASE:1.27
	OPENBSD_3_4:1.24.0.2
	OPENBSD_3_4_BASE:1.24
	OPENBSD_3_3:1.23.0.6
	OPENBSD_3_3_BASE:1.23
	OPENBSD_3_2:1.23.0.4
	OPENBSD_3_2_BASE:1.23
	OPENBSD_3_1:1.23.0.2
	OPENBSD_3_1_BASE:1.23
	OPENBSD_3_0:1.19.0.2
	OPENBSD_3_0_BASE:1.19
	OPENBSD_2_9_BASE:1.13
	OPENBSD_2_9:1.13.0.2
	OPENBSD_2_8:1.12.0.2
	OPENBSD_2_8_BASE:1.12
	OPENBSD_2_7:1.11.0.2
	OPENBSD_2_7_BASE:1.11
	OPENBSD_2_6:1.10.0.2
	OPENBSD_2_6_BASE:1.10;
locks; strict;
comment	@# @;


1.50
date	2015.07.01.23.10.47;	author djm;	state Exp;
branches;
next	1.49;
commitid	oFn3fOB9XtGAmm7j;

1.49
date	2015.05.29.06.47.43;	author djm;	state Exp;
branches;
next	1.48;
commitid	hHReMgVdK5RwEXlT;

1.48
date	2015.03.24.01.29.19;	author djm;	state Exp;
branches;
next	1.47;
commitid	5ZpGAnzctxXyGYTk;

1.47
date	2015.03.03.21.21.13;	author djm;	state Exp;
branches;
next	1.46;
commitid	fcvr9LotYI8aCFuc;

1.46
date	2014.04.29.18.01.49;	author markus;	state Exp;
branches;
next	1.45;

1.45
date	2014.03.31.15.25.26;	author deraadt;	state Exp;
branches;
next	1.44;

1.44
date	2014.02.28.22.46.54;	author deraadt;	state Exp;
branches;
next	1.43;

1.43
date	2014.02.07.21.14.24;	author miod;	state Exp;
branches;
next	1.42;

1.42
date	2014.01.29.06.18.35;	author djm;	state Exp;
branches;
next	1.41;

1.41
date	2014.01.18.05.54.51;	author martynas;	state Exp;
branches;
next	1.40;

1.40
date	2013.12.06.13.34.54;	author markus;	state Exp;
branches;
next	1.39;

1.39
date	2010.10.01.23.10.48;	author djm;	state Exp;
branches;
next	1.38;

1.38
date	2010.10.01.23.06.06;	author djm;	state Exp;
branches;
next	1.37;

1.37
date	2010.10.01.23.05.32;	author djm;	state Exp;
branches;
next	1.36;

1.36
date	2010.02.20.20.28.11;	author markus;	state Exp;
branches;
next	1.35;

1.35
date	2010.02.09.08.55.31;	author markus;	state Exp;
branches;
next	1.34;

1.34
date	2010.02.08.10.50.20;	author markus;	state Exp;
branches;
next	1.33;

1.33
date	2008.11.04.08.22.12;	author djm;	state Exp;
branches;
next	1.32;

1.32
date	2008.06.28.14.04.30;	author djm;	state Exp;
branches;
next	1.31;

1.31
date	2008.05.08.12.21.16;	author djm;	state Exp;
branches;
next	1.30;

1.30
date	2005.06.17.02.45.19;	author djm;	state Exp;
branches;
next	1.29;

1.29
date	2004.06.21.18.34.51;	author avsm;	state Exp;
branches
	1.29.2.1
	1.29.4.1;
next	1.28;

1.28
date	2004.06.21.17.36.31;	author avsm;	state Exp;
branches;
next	1.27;

1.27
date	2003.10.14.19.42.10;	author jakob;	state Exp;
branches
	1.27.2.1;
next	1.26;

1.26
date	2003.09.23.20.17.11;	author markus;	state Exp;
branches;
next	1.25;

1.25
date	2003.09.18.08.49.45;	author markus;	state Exp;
branches;
next	1.24;

1.24
date	2003.05.14.18.16.20;	author jakob;	state Exp;
branches
	1.24.2.1;
next	1.23;

1.23
date	2002.03.06.00.23.27;	author markus;	state Exp;
branches
	1.23.4.1
	1.23.6.1;
next	1.22;

1.22
date	2002.03.06.00.20.54;	author markus;	state Exp;
branches;
next	1.21;

1.21
date	2001.10.30.20.32.31;	author markus;	state Exp;
branches;
next	1.20;

1.20
date	2001.10.30.20.29.09;	author markus;	state Exp;
branches;
next	1.19;

1.19
date	2001.07.29.14.00.07;	author markus;	state Exp;
branches
	1.19.2.1;
next	1.18;

1.18
date	2001.07.26.13.40.56;	author espie;	state Exp;
branches;
next	1.17;

1.17
date	2001.06.27.19.29.13;	author markus;	state Exp;
branches;
next	1.16;

1.16
date	2001.06.26.17.40.42;	author markus;	state Exp;
branches;
next	1.15;

1.15
date	2001.06.23.17.11.01;	author markus;	state Exp;
branches;
next	1.14;

1.14
date	2001.06.23.15.12.17;	author itojun;	state Exp;
branches;
next	1.13;

1.13
date	2001.01.29.01.58.14;	author niklas;	state Exp;
branches
	1.13.2.1;
next	1.12;

1.12
date	2000.10.15.14.15.34;	author markus;	state Exp;
branches
	1.12.2.1;
next	1.11;

1.11
date	99.10.25.20.27.26;	author markus;	state Exp;
branches
	1.11.2.1;
next	1.10;

1.10
date	99.10.07.21.45.02;	author markus;	state Exp;
branches;
next	1.9;

1.9
date	99.10.06.22.24.55;	author deraadt;	state Exp;
branches;
next	1.8;

1.8
date	99.10.04.20.45.01;	author markus;	state Exp;
branches;
next	1.7;

1.7
date	99.10.03.17.58.16;	author deraadt;	state Exp;
branches;
next	1.6;

1.6
date	99.10.03.17.56.46;	author deraadt;	state Exp;
branches;
next	1.5;

1.5
date	99.09.29.18.16.18;	author dugsong;	state Exp;
branches;
next	1.4;

1.4
date	99.09.29.00.09.50;	author deraadt;	state Exp;
branches;
next	1.3;

1.3
date	99.09.28.22.48.58;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	99.09.26.22.29.50;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	99.09.26.21.47.52;	author deraadt;	state Exp;
branches;
next	;

1.11.2.1
date	2000.11.08.21.30.14;	author jason;	state Exp;
branches;
next	1.11.2.2;

1.11.2.2
date	2001.03.12.15.44.06;	author jason;	state Exp;
branches;
next	1.11.2.3;

1.11.2.3
date	2001.03.21.18.52.30;	author jason;	state Exp;
branches;
next	;

1.12.2.1
date	2001.02.16.20.12.50;	author jason;	state Exp;
branches;
next	1.12.2.2;

1.12.2.2
date	2001.02.19.17.18.31;	author jason;	state Exp;
branches;
next	1.12.2.3;

1.12.2.3
date	2001.03.21.19.46.21;	author jason;	state Exp;
branches;
next	1.12.2.4;

1.12.2.4
date	2001.05.07.21.09.25;	author jason;	state Exp;
branches;
next	1.12.2.5;

1.12.2.5
date	2001.09.27.00.15.41;	author miod;	state Exp;
branches;
next	;

1.13.2.1
date	2001.09.27.19.03.54;	author jason;	state Exp;
branches;
next	1.13.2.2;

1.13.2.2
date	2002.03.09.00.20.43;	author miod;	state Exp;
branches;
next	;

1.19.2.1
date	2001.11.14.03.24.38;	author jason;	state Exp;
branches;
next	1.19.2.2;

1.19.2.2
date	2002.03.07.17.37.45;	author jason;	state Exp;
branches;
next	;

1.23.4.1
date	2003.09.16.21.20.23;	author brad;	state Exp;
branches;
next	;

1.23.6.1
date	2003.09.16.20.50.42;	author brad;	state Exp;
branches;
next	1.23.6.2;

1.23.6.2
date	2004.03.04.18.18.14;	author brad;	state Exp;
branches;
next	;

1.24.2.1
date	2004.02.28.03.51.32;	author brad;	state Exp;
branches;
next	1.24.2.2;

1.24.2.2
date	2004.08.19.22.37.30;	author brad;	state Exp;
branches;
next	;

1.27.2.1
date	2004.08.19.04.13.25;	author brad;	state Exp;
branches;
next	;

1.29.2.1
date	2005.09.02.03.44.59;	author brad;	state Exp;
branches;
next	;

1.29.4.1
date	2005.09.04.18.39.52;	author brad;	state Exp;
branches;
next	;


desc
@@


1.50
log
@Compile-time disable SSH v.1 again
@
text
@#	$OpenBSD: Makefile.inc,v 1.49 2015/05/29 06:47:43 djm Exp $

.include <bsd.own.mk>

CFLAGS+=	-I${.CURDIR}/..
CFLAGS+=	-fstack-protector-all

CDIAGFLAGS=	-Wall
CDIAGFLAGS+=	-Wchar-subscripts
CDIAGFLAGS+=	-Wcomment
CDIAGFLAGS+=	-Wextra
CDIAGFLAGS+=	-Wformat
CDIAGFLAGS+=	-Wformat-security
CDIAGFLAGS+=	-Wimplicit
CDIAGFLAGS+=	-Winline
CDIAGFLAGS+=	-Wmissing-declarations
CDIAGFLAGS+=	-Wmissing-prototypes
CDIAGFLAGS+=	-Wparentheses
CDIAGFLAGS+=	-Wpointer-arith
CDIAGFLAGS+=	-Wreturn-type
CDIAGFLAGS+=	-Wshadow
CDIAGFLAGS+=	-Wsign-compare
CDIAGFLAGS+=	-Wstrict-aliasing
CDIAGFLAGS+=	-Wstrict-prototypes
CDIAGFLAGS+=	-Wswitch
CDIAGFLAGS+=	-Wtrigraphs
CDIAGFLAGS+=	-Wuninitialized
CDIAGFLAGS+=	-Wunused
.if ${COMPILER_VERSION} == "gcc4"
CDIAGFLAGS+=	-Wold-style-definition
.endif
CDIAGFLAGS+=	-Wno-unused-parameter # Not clean for this yet
#CDIAGFLAGS+=	-Wwrite-strings # XXX too messy; needs libc changes
#CDIAGFLAGS+=	-Wcast-qual # XXX not clean
#CDIAGFLAGS+=	-Wcast-align # XXX can't be clean with sockaddr casts?

#CDIAGFLAGS+=	-Werror
#DEBUG=-g

WARNINGS=yes

SSH1?=		no
OPENSSL?=	yes

.if (${OPENSSL:L} == "yes")
CFLAGS+=	-DWITH_OPENSSL
.else
# SSH v.1 requires OpenSSL.
SSH1=		no
.endif

.if (${SSH1:L} == "yes")
CFLAGS+=	-DWITH_SSH1
.endif

CFLAGS+=	-DENABLE_PKCS11
.ifndef NOPIC
CFLAGS+=	-DHAVE_DLOPEN
.endif

.include <bsd.obj.mk>

.if exists(${.CURDIR}/../lib/${__objdir})
LDADD+=         -L${.CURDIR}/../lib/${__objdir} -lssh
DPADD+=         ${.CURDIR}/../lib/${__objdir}/libssh.a
.else
LDADD+=         -L${.CURDIR}/../lib -lssh
DPADD+=         ${.CURDIR}/../lib/libssh.a
.endif

LDADD+=		-lutil
@


1.49
log
@put back SSH1 for now - we want to make sure we don't regress
it for the 6.9 release; ok deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.48 2015/03/24 01:29:19 djm Exp $
d42 1
a42 1
SSH1?=		yes
@


1.48
log
@Compile-time disable SSH protocol 1. You can turn it back on using
the Makefile.inc knob if you need it to talk to ancient devices.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.47 2015/03/03 21:21:13 djm Exp $
d42 1
a42 1
SSH1?=		no
@


1.47
log
@add SSH1 Makefile knob to make it easier to build without SSH1 support;
ok markus@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.46 2014/04/29 18:01:49 markus Exp $
d42 1
a42 1
SSH1?=		yes
@


1.46
log
@make compiling against OpenSSL optional (make OPENSSL=no);
reduces algorithms to curve25519, aes-ctr, chacha, ed25519;
allows us to explore further options; with and ok djm
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.45 2014/03/31 15:25:26 deraadt Exp $
d42 1
d44 1
d46 8
a53 1
CFLAGS+=	-DWITH_OPENSSL -DWITH_SSH1
@


1.45
log
@ssh has a target painted on it's back, so use -fstack-protector-all
dtucker mentioned that -portable does this
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.44 2014/02/28 22:46:54 deraadt Exp $
d41 5
@


1.44
log
@Absolutely do not override base system build features in this file!!
Discovered by miod.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.43 2014/02/07 21:14:24 miod Exp $
d6 1
@


1.43
log
@-Wold-style-declaration is not supported by gcc 3.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.42 2014/01/29 06:18:35 djm Exp $
a39 1
INSTALL_STRIP=
@


1.42
log
@remove experimental, never-enabled JPAKE code; ok markus@@
@
text
@d1 3
a3 1
#	$OpenBSD: Makefile.inc,v 1.41 2014/01/18 05:54:51 martynas Exp $
d28 1
d30 1
a42 1
.include <bsd.own.mk>
@


1.41
log
@Remove -Wbounded:  it is now the compiler default.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.40 2013/12/06 13:34:54 markus Exp $
d6 10
a15 1
#CDIAGFLAGS+=	-Werror
d17 7
a24 2
CDIAGFLAGS+=	-Wstrict-prototypes
CDIAGFLAGS+=	-Wmissing-prototypes
d26 5
a30 2
CDIAGFLAGS+=	-Wsign-compare
CDIAGFLAGS+=	-Wshadow
d32 1
d35 2
a36 1
#CFLAGS+=	-DJPAKE
@


1.40
log
@new private key format, bcrypt as KDF by default; details in PROTOCOL.key;
feedback and lots help from djm; ok djm@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.39 2010/10/01 23:10:48 djm Exp $
a12 1
CDIAGFLAGS+=	-Wbounded
@


1.39
log
@turn off -g too
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.38 2010/10/01 23:06:06 djm Exp $
d35 2
@


1.38
log
@oops, didn't mean to turn -Werror on for everyone.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.37 2010/10/01 23:05:32 djm Exp $
d16 1
a16 1
DEBUG=-g
@


1.37
log
@adapt to API changes in openssl-1.0.0a
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.36 2010/02/20 20:28:11 markus Exp $
d6 1
a6 1
CDIAGFLAGS+=	-Werror
@


1.36
log
@unbreak build for NOPIC systems; noticed, help and ok deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.35 2010/02/09 08:55:31 markus Exp $
d6 1
a6 1
#CDIAGFLAGS+=	-Werror
d8 1
a8 1
CDIAGFLAGS+=	-Wno-uninitialized
d16 1
a16 1
#DEBUG=-g
@


1.35
log
@enable PKCS#11 code; ok djm
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.34 2010/02/08 10:50:20 markus Exp $
d21 4
@


1.34
log
@replace our obsolete smartcard code with PKCS#11.
	ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-11/v2-20/pkcs-11v2-20.pdf
ssh(1) and ssh-keygen(1) use dlopen(3) directly to talk to a PKCS#11
provider (shared library) while ssh-agent(1) delegates PKCS#11 to
a forked a ssh-pkcs11-helper process.
PKCS#11 is currently a compile time option.
feedback and ok djm@@; inspired by patches from Alon Bar-Lev
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.33 2008/11/04 08:22:12 djm Exp $
d20 1
a20 1
#CFLAGS+=	-DENABLE_PKCS11
@


1.33
log
@Add support for an experimental zero-knowledge password authentication
method using the J-PAKE protocol described in F. Hao, P. Ryan,
"Password Authenticated Key Exchange by Juggling", 16th Workshop on
Security Protocols, Cambridge, April 2008.

This method allows password-based authentication without exposing
the password to the server. Instead, the client and server exchange
cryptographic proofs to demonstrate of knowledge of the password while
revealing nothing useful to an attacker or compromised endpoint.

This is experimental, work-in-progress code and is presently
compiled-time disabled (turn on -DJPAKE in Makefile.inc).

"just commit it.  It isn't too intrusive." deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.32 2008/06/28 14:04:30 djm Exp $
d20 1
a20 2
#CFLAGS+=	-DSMARTCARD
#LDADD+=	-lsectok
@


1.32
log
@revert accidental commit (nearly 2 months ago!) that
unconditionally enabled -Werror and -g
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.30 2005/06/17 02:45:19 djm Exp $
d17 2
@


1.31
log
@Make the maximum number of sessions run-time controllable via
a sshd_config MaxSessions knob. This is useful for disabling
login/shell/subsystem access while leaving port-forwarding working
(MaxSessions 0), disabling connection multiplexing (MaxSessions 1) or
simply increasing the number of allows multiplexed sessions.

Because some bozos are sure to configure MaxSessions in excess of the
number of available file descriptors in sshd (which, at peak, might be
as many as 9*MaxSessions), audit sshd to ensure that it doesn't leak fds
on error paths, and make it fail gracefully on out-of-fd conditions -
sending channel errors instead of than exiting with fatal().

bz#1090; MaxSessions config bits and manpage from junyer AT gmail.com

ok markus@@
@
text
@d6 1
a6 1
CDIAGFLAGS+=	-Werror
d16 1
a16 1
DEBUG=-g
@


1.30
log
@turn on -Wstrict-prototypes -Wsign-compare -Wshadow now that we are clean
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.29 2004/06/21 18:34:51 avsm Exp $
d6 1
a6 1
#CDIAGFLAGS+=	-Werror
d16 1
a16 1
#DEBUG=-g
@


1.29
log
@comment out -Wshadow for now, gcc2 sucks. noticed by markus
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.28 2004/06/21 17:36:31 avsm Exp $
d9 1
a9 1
#CDIAGFLAGS+=	-Wstrict-prototypes
d12 1
a12 1
#CDIAGFLAGS+=	-Wsign-compare
d14 1
a14 1
#CDIAGFLAGS+=	-Wshadow
@


1.29.4.1
log
@upgrade to OpenSSH 4.2
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.30 2005/06/17 02:45:19 djm Exp $
d9 1
a9 1
CDIAGFLAGS+=	-Wstrict-prototypes
d12 1
a12 1
CDIAGFLAGS+=	-Wsign-compare
d14 1
a14 1
CDIAGFLAGS+=	-Wshadow
@


1.29.2.1
log
@upgrade to OpenSSH 4.2
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.30 2005/06/17 02:45:19 djm Exp $
d9 1
a9 1
CDIAGFLAGS+=	-Wstrict-prototypes
d12 1
a12 1
CDIAGFLAGS+=	-Wsign-compare
d14 1
a14 1
CDIAGFLAGS+=	-Wshadow
@


1.28
log
@make ssh -Wshadow clean, no functional changes
markus@@ ok
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.27 2003/10/14 19:42:10 jakob Exp $
d14 1
a14 1
CDIAGFLAGS+=	-Wshadow
@


1.27
log
@include SSHFP lookup code (not enabled by default). ok markus@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.26 2003/09/23 20:17:11 markus Exp $
d14 1
@


1.27.2.1
log
@upgrade to OpenSSH 3.9
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.29 2004/06/21 18:34:51 avsm Exp $
a13 1
#CDIAGFLAGS+=	-Wshadow
@


1.26
log
@replace fatal_cleanup() and linked list of fatal callbacks with static
cleanup_exit() function.  re-refine cleanup_exit() where appropriate,
allocate sshd's authctxt eary to allow simpler cleanup in sshd.
tested by many, ok deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.25 2003/09/18 08:49:45 markus Exp $
a18 2

#CFLAGS+=	-DDNS
@


1.25
log
@more buffer allocation fixes; from Solar Designer; CAN-2003-0682; ok millert@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.24 2003/05/14 18:16:20 jakob Exp $
d13 1
a13 1
#CDIAGFLAGS+=	-Wbounded
@


1.24
log
@add experimental support for verifying hos keys using DNS as described
in draft-ietf-secsh-dns-xx.txt. more information in README.dns.
ok markus@@ and henning@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.23 2002/03/06 00:23:27 markus Exp $
d12 2
@


1.24.2.1
log
@upgrade to OpenSSH 3.8
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.27 2003/10/14 19:42:10 jakob Exp $
a11 2
#CDIAGFLAGS+=	-Wsign-compare
CDIAGFLAGS+=	-Wbounded
d17 2
@


1.24.2.2
log
@upgrade to OpenSSH 3.9
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.29 2004/06/21 18:34:51 avsm Exp $
a13 1
#CDIAGFLAGS+=	-Wshadow
@


1.23
log
@undo
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.21 2001/10/30 20:32:31 markus Exp $
d17 2
@


1.23.4.1
log
@upgrade to OpenSSH 3.7
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.24 2003/05/14 18:16:20 jakob Exp $
a16 2

#CFLAGS+=	-DDNS
@


1.23.6.1
log
@upgrade to OpenSSH 3.7
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.24 2003/05/14 18:16:20 jakob Exp $
a16 2

#CFLAGS+=	-DDNS
@


1.23.6.2
log
@upgrade to OpenSSH 3.8upgrade to OpenSSH 3.8upgrade to OpenSSH 3.8
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.27 2003/10/14 19:42:10 jakob Exp $
a11 2
#CDIAGFLAGS+=	-Wsign-compare
CDIAGFLAGS+=	-Wbounded
d17 2
@


1.22
log
@compat.c
@
text
@d13 1
a13 1
DEBUG=-g
@


1.21
log
@undo (disable debug again)
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.19 2001/07/29 14:00:07 markus Exp $
d13 1
a13 1
#DEBUG=-g
@


1.20
log
@ssh.1
@
text
@d13 1
a13 1
DEBUG=-g
@


1.19
log
@typo, add -Wunused
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.18 2001/07/26 13:40:56 espie Exp $
d13 1
a13 1
#DEBUG=-g
@


1.19.2.1
log
@Pull in patches from current (Errata 002):
Update to OpenSSH-3.0.1 via errata patch (Instead of using release tarball)
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.21 2001/10/30 20:32:31 markus Exp $
@


1.19.2.2
log
@Update to OpenSSH-3.1 on 3.0-stable branch
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.23 2002/03/06 00:23:27 markus Exp $
@


1.18
log
@CDIAGFLAGS. Okay markus@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.17 2001/06/27 19:29:13 markus Exp $
d10 2
a11 1
CFDIAGLAGS+=	-Wmissing-prototypes
@


1.17
log
@move -lsectok to Makefile.inc for now
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.16 2001/06/26 17:40:42 markus Exp $
d5 6
a10 6
CFLAGS+=	-Wall
#CFLAGS+=	-Werror
CFLAGS+=	-Wpointer-arith
CFLAGS+=	-Wno-uninitialized
#CFLAGS+=	-Wstrict-prototypes
CFLAGS+=	-Wmissing-prototypes
@


1.16
log
@add smartcard support to the makefiles (commented out);
the smartcard support is based on work by itoi@@eecs.umich.edu
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.15 2001/06/23 17:11:01 markus Exp $
d13 1
d15 1
@


1.15
log
@turn off -Wstrict-prototypes (for atomicio.h)
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.14 2001/06/23 15:12:17 itojun Exp $
d13 1
@


1.14
log
@more strict prototypes.  raise warning level in Makefile.inc.  markus ok'ed
TODO; cleanup headers
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.13 2001/01/29 01:58:14 niklas Exp $
d6 7
a12 1
CFLAGS+=		-Wstrict-prototypes -Wmissing-prototypes -Wpointer-arith -Wno-uninitialized
@


1.13
log
@$OpenBSD$
@
text
@d1 1
a1 1
#	$OpenBSD$
d6 1
@


1.13.2.1
log
@Pull in OpenSSH-2.9.9
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.19 2001/07/29 14:00:07 markus Exp $
d5 1
a5 12
CDIAGFLAGS=	-Wall
#CDIAGFLAGS+=	-Werror
CDIAGFLAGS+=	-Wpointer-arith
CDIAGFLAGS+=	-Wno-uninitialized
#CDIAGFLAGS+=	-Wstrict-prototypes
CDIAGFLAGS+=	-Wmissing-prototypes
CDIAGFLAGS+=	-Wunused

#DEBUG=-g

#CFLAGS+=	-DSMARTCARD
#LDADD+=	-lsectok
@


1.13.2.2
log
@Merge OpenSSH 3.1, keeping /etc as configuration files directory.
(i.e. OpenSSH 3.1 + openbsd29_3.1.patch)
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.23 2002/03/06 00:23:27 markus Exp $
@


1.12
log
@CFLAGS+=        -Wall
@
text
@d1 2
@


1.12.2.1
log
@Pull in OpenSSH 2.5.0
@
text
@a0 2
#	$OpenBSD: Makefile.inc,v 1.13 2001/01/29 01:58:14 niklas Exp $

@


1.12.2.2
log
@Pull in OpenSSH-2.5.1
@
text
@@


1.12.2.3
log
@Pull in OpenSSH-2.5.2 for 2.8 branch.
@
text
@@


1.12.2.4
log
@Pull in OpenSSH-2.9 to 2.8 branch.
@
text
@@


1.12.2.5
log
@Pull in OpenSSH 2.9.9 to the 2.8 branch.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.19 2001/07/29 14:00:07 markus Exp $
d5 1
a5 12
CDIAGFLAGS=	-Wall
#CDIAGFLAGS+=	-Werror
CDIAGFLAGS+=	-Wpointer-arith
CDIAGFLAGS+=	-Wno-uninitialized
#CDIAGFLAGS+=	-Wstrict-prototypes
CDIAGFLAGS+=	-Wmissing-prototypes
CDIAGFLAGS+=	-Wunused

#DEBUG=-g

#CFLAGS+=	-DSMARTCARD
#LDADD+=	-lsectok
@


1.11
log
@move common files to ./lib and link libssh.a, tested with and w/o obj
@
text
@d3 2
@


1.11.2.1
log
@openssh-2.3.0 (again) for 2.7 branch
@
text
@a2 2
CFLAGS+=	-Wall

@


1.11.2.2
log
@OpenSSH-2.5.1 for 2.7 patch branch
@
text
@a0 2
#	$OpenBSD: Makefile.inc,v 1.13 2001/01/29 01:58:14 niklas Exp $

@


1.11.2.3
log
@Pull in OpenSSH-2.5.2 for 2.7 branch.
@
text
@@


1.10
log
@add skey to sshd:

1) pass *pw to auth_password() not user_name, do_authentication already
   keeps private copy of struct passwd for current user.
2) limit authentication attemps to 5, otherwise
        ssh -o 'NumberOfPasswordPrompts 100000' host
   lets you enter 100000 passwds
3) make s/key a run-time option in /etc/sshd_config
4) generate fake skeys,
   for s/key for nonexisting users, too
   limit auth-tries for nonexisting users, too.
Note that
% ssh -l nonexisting-user -o 'NumberOfPasswordPrompts 100000' host
has NO limits in ssh-1.2.27
@
text
@d2 10
@


1.9
log
@scp should not link against kerberos stuff
@
text
@d1 1
a1 1
CFLAGS+=	-I${.OBJDIR} -I${.CURDIR}/..
@


1.8
log
@nuke genminfd/AUTH_FD
@
text
@a1 13

.include <bsd.own.mk> # for KERBEROS and AFS

.if (${KERBEROS} == "yes")
CFLAGS+= -DKRB4 -I/usr/include/kerberosIV
LDADD+=	 -lkrb
DPADD+=	 ${LIBKRB}
.if (${AFS} == "yes")
CFLAGS+= -DAFS
LDADD+=  -lkafs
DPADD+=  ${LIBKRBAFS}
.endif # AFS
.endif # KERBEROS
@


1.7
log
@clean the minfd junk
@
text
@a2 2
CLEANFILES=	gen_minfd minfd.h

a14 2

USER_SHELLS = sh jsh ksh csh tcsh bash zsh ash
@


1.6
log
@AFS depends on kerberos, fixes KERBEROS=no
@
text
@d3 2
@


1.5
log
@update krb4/AFS support to ssh-1.2.27-afs-kerberos-pl1 level, clean up unused variables, update manpages
@
text
@a8 2
.endif

d11 4
a14 3
LDADD+=	 -lkafs
DPADD+=	 ${LIBKRBAFS}
.endif
@


1.4
log
@krb4 support; evanc@@concer.to
@
text
@d1 15
a15 1
CFLAGS+=	-I${.OBJDIR} -I${.CURDIR}/.. -DKRB4 -I/usr/include/kerberosIV
@


1.3
log
@+=
@
text
@d1 1
a1 1
CFLAGS+=	-I${.OBJDIR} -I${.CURDIR}/..
@


1.2
log
@distribution target
@
text
@d1 1
a1 1
CFLAGS=	-I${.OBJDIR} -I${.CURDIR}/..
@


1.1
log
@build ssh components using our build model
@
text
@a0 4
HOST_KEY_FILE   = $(etcdir)/ssh_host_key
HOST_CONFIG_FILE = $(etcdir)/ssh_config
SERVER_CONFIG_FILE = $(etcdir)/sshd_config

@

