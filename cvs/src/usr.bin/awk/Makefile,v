head	1.14;
access;
symbols
	OPENBSD_6_0:1.14.0.12
	OPENBSD_6_0_BASE:1.14
	OPENBSD_5_9:1.14.0.8
	OPENBSD_5_9_BASE:1.14
	OPENBSD_5_8:1.14.0.10
	OPENBSD_5_8_BASE:1.14
	OPENBSD_5_7:1.14.0.2
	OPENBSD_5_7_BASE:1.14
	OPENBSD_5_6:1.14.0.6
	OPENBSD_5_6_BASE:1.14
	OPENBSD_5_5:1.14.0.4
	OPENBSD_5_5_BASE:1.14
	OPENBSD_5_4:1.13.0.2
	OPENBSD_5_4_BASE:1.13
	OPENBSD_5_3:1.12.0.2
	OPENBSD_5_3_BASE:1.12
	OPENBSD_5_2:1.11.0.8
	OPENBSD_5_2_BASE:1.11
	OPENBSD_5_1_BASE:1.11
	OPENBSD_5_1:1.11.0.6
	OPENBSD_5_0:1.11.0.4
	OPENBSD_5_0_BASE:1.11
	OPENBSD_4_9:1.11.0.2
	OPENBSD_4_9_BASE:1.11
	OPENBSD_4_8:1.10.0.4
	OPENBSD_4_8_BASE:1.10
	OPENBSD_4_7:1.10.0.2
	OPENBSD_4_7_BASE:1.10
	OPENBSD_4_6:1.9.0.10
	OPENBSD_4_6_BASE:1.9
	OPENBSD_4_5:1.9.0.6
	OPENBSD_4_5_BASE:1.9
	OPENBSD_4_4:1.9.0.4
	OPENBSD_4_4_BASE:1.9
	OPENBSD_4_3:1.9.0.2
	OPENBSD_4_3_BASE:1.9
	OPENBSD_4_2:1.8.0.2
	OPENBSD_4_2_BASE:1.8
	OPENBSD_4_1:1.7.0.10
	OPENBSD_4_1_BASE:1.7
	OPENBSD_4_0:1.7.0.8
	OPENBSD_4_0_BASE:1.7
	OPENBSD_3_9:1.7.0.6
	OPENBSD_3_9_BASE:1.7
	OPENBSD_3_8:1.7.0.4
	OPENBSD_3_8_BASE:1.7
	OPENBSD_3_7:1.7.0.2
	OPENBSD_3_7_BASE:1.7
	OPENBSD_3_6:1.6.0.4
	OPENBSD_3_6_BASE:1.6
	OPENBSD_3_5:1.6.0.2
	OPENBSD_3_5_BASE:1.6
	OPENBSD_3_4:1.5.0.26
	OPENBSD_3_4_BASE:1.5
	OPENBSD_3_3:1.5.0.24
	OPENBSD_3_3_BASE:1.5
	OPENBSD_3_2:1.5.0.22
	OPENBSD_3_2_BASE:1.5
	OPENBSD_3_1:1.5.0.20
	OPENBSD_3_1_BASE:1.5
	OPENBSD_3_0:1.5.0.18
	OPENBSD_3_0_BASE:1.5
	OPENBSD_2_9_BASE:1.5
	OPENBSD_2_9:1.5.0.16
	OPENBSD_2_8:1.5.0.14
	OPENBSD_2_8_BASE:1.5
	OPENBSD_2_7:1.5.0.12
	OPENBSD_2_7_BASE:1.5
	OPENBSD_2_6:1.5.0.10
	OPENBSD_2_6_BASE:1.5
	OPENBSD_2_5:1.5.0.8
	OPENBSD_2_5_BASE:1.5
	OPENBSD_2_4:1.5.0.6
	OPENBSD_2_4_BASE:1.5
	OPENBSD_2_3:1.5.0.4
	OPENBSD_2_3_BASE:1.5
	OPENBSD_2_2:1.5.0.2
	OPENBSD_2_2_BASE:1.5
	OPENBSD_2_1:1.4.0.2
	OPENBSD_2_1_BASE:1.4
	OPENBSD_2_0:1.2.0.2
	OPENBSD_2_0_BASE:1.2;
locks; strict;
comment	@# @;


1.14
date	2013.08.18.22.06.44;	author miod;	state Exp;
branches;
next	1.13;

1.13
date	2013.07.28.18.10.16;	author miod;	state Exp;
branches;
next	1.12;

1.12
date	2012.12.21.08.50.27;	author espie;	state Exp;
branches;
next	1.11;

1.11
date	2010.08.25.19.21.04;	author deraadt;	state Exp;
branches;
next	1.10;

1.10
date	2010.01.04.17.50.39;	author deraadt;	state Exp;
branches;
next	1.9;

1.9
date	2007.11.24.15.43.08;	author espie;	state Exp;
branches;
next	1.8;

1.8
date	2007.03.18.15.37.06;	author mickey;	state Exp;
branches;
next	1.7;

1.7
date	2004.12.30.01.52.48;	author millert;	state Exp;
branches;
next	1.6;

1.6
date	2003.12.14.16.00.37;	author jmc;	state Exp;
branches;
next	1.5;

1.5
date	97.08.25.16.17.08;	author kstailey;	state Exp;
branches;
next	1.4;

1.4
date	97.01.24.23.11.29;	author millert;	state Exp;
branches;
next	1.3;

1.3
date	96.10.12.10.25.42;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	96.07.06.05.40.02;	author etheisen;	state Exp;
branches;
next	1.1;

1.1
date	96.07.04.20.34.36;	author tholo;	state Exp;
branches;
next	;


desc
@@


1.14
log
@Remove wrong workaround for the 88100 `awk bug' - it turns out compiling
with -O2 changes the alignment of code and data, which caused the awk binary
to be more prone to trigger the DAE bug which just got fixed.
@
text
@#	$OpenBSD: Makefile,v 1.13 2013/07/28 18:10:16 miod Exp $

PROG=	awk
SRCS=	ytab.c lex.c b.c main.c parse.c proctab.c tran.c lib.c run.c
LDADD=	-lm
DPADD=	${LIBM}
CLEANFILES+=proctab.c maketab ytab.c ytab.h
CFLAGS+=-I. -I${.CURDIR} -DHAS_ISBLANK -DNDEBUG
HOSTCFLAGS+=-I. -I${.CURDIR} -DHAS_ISBLANK -DNDEBUG

ytab.c ytab.h: awkgram.y
	${YACC} -d ${.CURDIR}/awkgram.y
	mv y.tab.c ytab.c
	mv y.tab.h ytab.h

proctab.c: maketab
	./maketab >proctab.c

maketab: ytab.h maketab.c
	${HOSTCC} ${HOSTCFLAGS} ${.CURDIR}/maketab.c -o $@@

.include <bsd.prog.mk>
@


1.13
log
@Build awk with -O1 on m88k for now; when built -O2, it would sporadically
exit early blaming a spurious '}' in the first few lines of input, but only
on 88100-based systems.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.12 2012/12/21 08:50:27 espie Exp $
a20 4

.if ${MACHINE_ARCH} == "m88k"
COPTS+=	-O1
.endif
@


1.12
log
@remove makefile hacks that are no longer needed with t1 t2: working properly
okay krw@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.11 2010/08/25 19:21:04 deraadt Exp $
d21 4
@


1.11
log
@get rid of the nawk hard link
ok millert guenther
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.10 2010/01/04 17:50:39 deraadt Exp $
d7 1
a7 1
CLEANFILES+=proctab.c maketab ytab.c ytab.h stamp_tabs
d11 1
a11 1
stamp_tabs: awkgram.y
a14 3
	touch $@@

ytab.c ytab.h: stamp_tabs
@


1.10
log
@Stop installing many of the incredibly dated and un-authoritative share/doc
files.  If any information found in these documents is worthwhile and you
miss it, please make the time to work it into the manual pages (which people
actually do read).
ok guenther
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.9 2007/11/24 15:43:08 espie Exp $
a3 1
LINKS=	${BINDIR}/awk ${BINDIR}/nawk
a9 1
MLINKS=	awk.1 nawk.1
@


1.9
log
@fix yacc/lex parallel file generation
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.8 2007/03/18 15:37:06 mickey Exp $
a11 5

# This just gets installed verbatim
.if make(install)
SUBDIR+= USD.doc
.endif
@


1.8
log
@allow this to build w/ cross-tools thru providing proper hostcflags; found by rainor's work
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.7 2004/12/30 01:52:48 millert Exp $
d8 1
a8 1
CLEANFILES+=proctab.c maketab ytab.c ytab.h
d18 1
a18 1
ytab.c ytab.h: awkgram.y
d22 3
@


1.7
log
@Update to version 20041222; OK deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.6 2003/12/14 16:00:37 jmc Exp $
d10 1
d27 1
a27 1
	${HOSTCC} ${CFLAGS} ${.CURDIR}/maketab.c -o $@@
@


1.6
log
@install awk USD;

i have replaced the out of date refer(1) stuff with man page references,
and updated the doc slightly to sync with current awk;

ok mickey@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.5 1997/08/25 16:17:08 kstailey Exp $
d9 1
a9 1
CFLAGS+=-I. -I${.CURDIR}
@


1.5
log
@August 1997 version of "the one true awk"
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.4 1997/01/24 23:11:29 millert Exp $
d11 5
@


1.4
log
@Basically stock AT&T resarch awk until the awk vs. flex problems
have a better resolution.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.3 1996/10/12 10:25:42 deraadt Exp $
d5 4
a8 4
SRCS=	awkgram.c lexyy.c b.c main.c parse.c proctab.c tran.c lib.c run.c
LDADD=	-ll -lm
DPADD=	${LIBL} ${LIBM}
CLEANFILES+=awkgram.c awkgram.h proctab.c maketab prevawkgram.h
d12 4
a15 5
awkgram.c awkgram.h prevawkgram.h: awkgram.y
	${YACC} -d ${.IMPSRC}
	mv y.tab.c awkgram.c
	mv y.tab.h awkgram.h
	cmp -s awkgram.h prevawkgram.h || cp awkgram.h prevawkgram.h
d20 1
a20 1
maketab: prevawkgram.h
@


1.3
log
@HOSTCC for maketab; from dale
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.2 1996/07/06 05:40:02 etheisen Exp $
d5 1
a5 1
SRCS=	awkgram.c awklex.c b.c main.c parse.c proctab.c tran.c lib.c run.c
d8 1
a8 1
CLEANFILES+=awkgram.c awkgram.h awklex.c awklex.h proctab.c maketab prevawkgram.h
a16 4

awklex.c: awklex.l
	lex ${.IMPSRC}
	mv lex.yy.c awklex.c
@


1.2
log
@Should get installed as nawk as well.
@
text
@d1 1
a1 1
#	$OpenBSD$
d25 2
a26 1
maketab.o: prevawkgram.h
@


1.1
log
@AT&T awk, by B. W. Kernighan, with fixes from 4.4BSD and by me
@
text
@d1 2
d4 1
d10 1
@
