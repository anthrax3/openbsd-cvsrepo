head	1.35;
access;
symbols
	OPENBSD_2_8:1.34.0.4
	OPENBSD_2_8_BASE:1.34
	OPENBSD_2_7:1.34.0.2
	OPENBSD_2_7_BASE:1.34
	OPENBSD_2_6:1.33.0.2
	OPENBSD_2_6_BASE:1.33
	OPENBSD_2_5:1.30.0.2
	OPENBSD_2_5_BASE:1.30
	OPENBSD_2_4:1.24.0.2
	OPENBSD_2_4_BASE:1.24
	OPENBSD_2_3:1.21.0.2
	OPENBSD_2_3_BASE:1.21
	OPENBSD_2_2:1.14.0.2
	OPENBSD_2_2_BASE:1.14
	OPENBSD_2_1:1.8.0.2
	OPENBSD_2_1_BASE:1.8;
locks; strict;
comment	@# @;


1.35
date	2001.01.29.21.25.50;	author deraadt;	state dead;
branches;
next	1.34;

1.34
date	2000.04.24.16.33.44;	author millert;	state Exp;
branches;
next	1.33;

1.33
date	99.09.03.18.55.21;	author deraadt;	state Exp;
branches;
next	1.32;

1.32
date	99.08.15.10.05.04;	author millert;	state Exp;
branches;
next	1.31;

1.31
date	99.07.30.17.16.02;	author deraadt;	state Exp;
branches;
next	1.30;

1.30
date	99.04.02.05.17.38;	author millert;	state Exp;
branches;
next	1.29;

1.29
date	99.04.01.22.10.14;	author millert;	state Exp;
branches;
next	1.28;

1.28
date	99.04.01.21.30.20;	author deraadt;	state Exp;
branches;
next	1.27;

1.27
date	98.11.09.03.58.04;	author millert;	state Exp;
branches;
next	1.26;

1.26
date	98.11.03.04.10.13;	author aaron;	state Exp;
branches;
next	1.25;

1.25
date	98.10.28.17.53.27;	author millert;	state Exp;
branches;
next	1.24;

1.24
date	98.09.24.06.39.49;	author millert;	state Exp;
branches;
next	1.23;

1.23
date	98.09.11.22.55.46;	author millert;	state Exp;
branches;
next	1.22;

1.22
date	98.09.06.08.51.08;	author deraadt;	state Exp;
branches;
next	1.21;

1.21
date	98.03.29.19.57.51;	author millert;	state Exp;
branches;
next	1.20;

1.20
date	98.03.29.00.08.06;	author millert;	state Exp;
branches;
next	1.19;

1.19
date	98.03.27.23.28.12;	author deraadt;	state Exp;
branches;
next	1.18;

1.18
date	98.03.12.08.48.52;	author deraadt;	state Exp;
branches;
next	1.17;

1.17
date	98.02.28.02.39.11;	author millert;	state Exp;
branches;
next	1.16;

1.16
date	98.02.28.02.29.30;	author angelos;	state Exp;
branches;
next	1.15;

1.15
date	97.10.30.21.14.41;	author niklas;	state Exp;
branches;
next	1.14;

1.14
date	97.10.25.04.51.14;	author deraadt;	state Exp;
branches
	1.14.2.1;
next	1.13;

1.13
date	97.10.25.04.35.41;	author deraadt;	state Exp;
branches;
next	1.12;

1.12
date	97.10.11.08.12.23;	author deraadt;	state Exp;
branches;
next	1.11;

1.11
date	97.09.30.17.52.35;	author deraadt;	state Exp;
branches;
next	1.10;

1.10
date	97.07.31.17.10.14;	author millert;	state Exp;
branches;
next	1.9;

1.9
date	97.07.09.15.11.10;	author millert;	state Exp;
branches;
next	1.8;

1.8
date	97.05.15.05.13.09;	author millert;	state Exp;
branches;
next	1.7;

1.7
date	97.05.15.03.44.10;	author millert;	state Exp;
branches;
next	1.6;

1.6
date	97.05.14.16.06.14;	author millert;	state Exp;
branches;
next	1.5;

1.5
date	97.05.11.03.54.26;	author millert;	state Exp;
branches;
next	1.4;

1.4
date	97.05.09.17.59.37;	author millert;	state Exp;
branches;
next	1.3;

1.3
date	97.05.09.02.25.08;	author millert;	state Exp;
branches;
next	1.2;

1.2
date	97.05.08.12.49.55;	author niklas;	state Exp;
branches;
next	1.1;

1.1
date	97.05.07.12.46.56;	author niklas;	state Exp;
branches;
next	;

1.14.2.1
date	97.10.30.21.16.00;	author niklas;	state Exp;
branches;
next	;


desc
@@


1.35
log
@three floppies, and a bsd.rd for the CD
@
text
@#       $OpenBSD: install.md,v 1.34 2000/04/24 16:33:44 millert Exp $
#
# Copyright (c) 1996 The NetBSD Foundation, Inc.
# All rights reserved.
#
# This code is derived from software contributed to The NetBSD Foundation
# by Jason R. Thorpe.
#
# Redistribution and use in source and binary forms, with or without
# modification, are permitted provided that the following conditions
# are met:
# 1. Redistributions of source code must retain the above copyright
#    notice, this list of conditions and the following disclaimer.
# 2. Redistributions in binary form must reproduce the above copyright
#    notice, this list of conditions and the following disclaimer in the
#    documentation and/or other materials provided with the distribution.
# 3. All advertising materials mentioning features or use of this software
#    must display the following acknowledgement:
#        This product includes software developed by the NetBSD
#        Foundation, Inc. and its contributors.
# 4. Neither the name of The NetBSD Foundation nor the names of its
#    contributors may be used to endorse or promote products derived
#    from this software without specific prior written permission.
#
# THIS SOFTWARE IS PROVIDED BY THE NETBSD FOUNDATION, INC. AND CONTRIBUTORS
# ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED
# TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
# PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE
# LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
# CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
# SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
# INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
# CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
# ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
# POSSIBILITY OF SUCH DAMAGE.
#

#
# machine dependent section of installation/upgrade script.
#

TMPWRITEABLE=/tmp/writeable
KERNFSMOUNTED=/tmp/kernfsmounted

# Machine-dependent install sets
MDSETS=kernel

md_machine_arch() {
	cat /kern/machine
}

md_set_term() {
	test -n "$TERM" && return
	echo -n "Specify terminal type [sun]: "
	getresp sun
	TERM=$resp
	export TERM
}

md_get_msgbuf() {
	# Only want to see one boot's worth of info
	sed -n -f /dev/stdin /kern/msgbuf <<- OOF
		/^OpenBSD /h
		/^OpenBSD /!H
		\${
			g
			p
		}
	OOF
}

md_get_diskdevs() {
	md_get_msgbuf | egrep "^[sw]d[0-9]+ " | cutword 1
}

md_get_cddevs() {
	md_get_msgbuf | egrep "^cd[0-9]+ " | cutword 1
}

md_get_partition_range() {
	# return range of valid partition letters
	echo [a-p]
}

md_questions() {
	:
}

md_installboot() {
	local _rawdev

	if [ -z "$1" ]; then
		echo No disk device specified, you must run installboot manually.
		return
	fi
	_rawdev=/dev/r${1}c

	# use extracted mdec if it exists (may be newer)
	if [ -d /mnt/usr/mdec ]; then
		cp /mnt/usr/mdec/boot /mnt/boot
		/mnt/usr/mdec/installboot -v /mnt/boot /mnt/usr/mdec/bootxx $_rawdev
	elif [ -d /usr/mdec ]; then
		cp /usr/mdec/boot /mnt/boot
		/usr/mdec/installboot -v /mnt/boot /usr/mdec/bootxx $_rawdev
	else
		echo No boot block prototypes found, you must run installboot manually.
	fi
}

md_checkfordisklabel() {
	# $1 is the disk to check
	local rval

	disklabel $1 >> /dev/null 2> /tmp/checkfordisklabel
	if grep "no disk label" /tmp/checkfordisklabel; then
		rval=1
	elif grep "disk label corrupted" /tmp/checkfordisklabel; then
		rval=2
	else
		rval=0
	fi

	rm -f /tmp/checkfordisklabel
	return $rval
}

md_prep_disklabel()
{
	local _disk=$1

	md_checkfordisklabel $_disk
	case $? in
	0)
		;;
	1)
		echo WARNING: Disk $_disk has no label. You will be creating a new one.
		echo
		;;
	2)
		echo WARNING: Label on disk $_disk is corrupted. You will be repairing.
		echo
		;;
	esac

	# display example
	cat << __EOT

If you are unsure of how to use multiple partitions properly
(ie. separating /, /usr, /tmp, /var, /usr/local, and other things)
just split the space into a root and swap partition for now.
__EOT

	disklabel -W ${_disk}
	disklabel -f /tmp/fstab.${_disk} -E ${_disk}
}

md_welcome_banner() {
{
	if [ "$MODE" = install ]; then
		cat << __EOT
Welcome to the OpenBSD/alpha ${VERSION_MAJOR}.${VERSION_MINOR} installation program.

This program is designed to help you put OpenBSD on your system in a
simple and rational way.

__EOT
	else
		cat << __EOT
Welcome to the OpenBSD/alpha ${VERSION_MAJOR}.${VERSION_MINOR} upgrade program.

This program is designed to help you upgrade your OpenBSD system in a
simple and rational way.

As a reminder, installing the 'etc' binary set is NOT recommended.
Once the rest of your system has been upgraded, you should manually
merge any changes to files in the 'etc' set into those files which
already exist on your system.

__EOT
	fi

cat << __EOT

As with anything which modifies your disk's contents, this program can
cause SIGNIFICANT data loss, and you are advised to make sure your
data is backed up before beginning the installation process.

Default answers are displayed in brackets after the questions.  You
can hit Control-C at any time to quit, but if you do so at a prompt,
you may have to hit return.  Also, quitting in the middle of
installation may leave your system in an inconsistent state.

__EOT
} | more
}

md_not_going_to_install() {
	cat << __EOT

OK, then.  Enter 'halt' at the prompt to halt the machine.  Once the
machine has halted, power-cycle the system to load new boot code.

__EOT
}

md_congrats() {
	local what;
	if [ "$MODE" = install ]; then
		what=installed
	else
		what=upgraded
	fi
	cat << __EOT

CONGRATULATIONS!  You have successfully $what OpenBSD!
To boot the installed system, enter halt at the command prompt. Once the
system has halted, reset the machine and boot from the disk.

__EOT
}

md_native_fstype() {
	:
}
md_native_fsopts() {
	:
}

md_makerootwritable() {
	# 2048 is the size in DEV_BIZE blocks

	if [ -e ${TMPWRITEABLE} ]; then
		md_mountkernfs
		return
	fi
	umount /tmp >> /dev/null 2>&1
	if ! mount -t ffs  -u /dev/rd0a / ; then
		cat << __EOT

FATAL ERROR: Can't mount the ram filesystem.

__EOT
		exit
	fi

	# Bleh.  Give mount_mfs a chance to DTRT.
	sleep 2
	> ${TMPWRITEABLE}

	md_mountkernfs
}
md_mountkernfs() {
	test -e $KERNFSMOUNTED && return
	if ! mount -t kernfs /kern /kern; then
		cat << __EOT
FATAL ERROR: Can't mount kernfs filesystem
__EOT
		exit
	fi
	> $KERNFSMOUNTED
}

hostname() {
	case $# in
		0)	cat /kern/hostname ;;
		1)	echo "$1" > /kern/hostname ;;
		*)	echo usage: hostname [name-of-host]
	esac
}
@


1.34
log
@Treat the beginning of the current dmesg output as starting at
/^OpenBSD /, not /^Copyright / (the latter doesn't show up in dmesg).
@
text
@d1 1
a1 1
#       $OpenBSD: install.md,v 1.33 1999/09/03 18:55:21 deraadt Exp $
@


1.33
log
@md_questions() interface allows asking questions before sets
@
text
@d1 1
a1 1
#       $OpenBSD: install.md,v 1.32 1999/08/15 10:05:04 millert Exp $
d63 2
a64 2
		/^Copyright (c)/h
		/^Copyright (c)/!H
@


1.32
log
@Kill md_copy_kernel()
@
text
@d1 1
a1 1
#       $OpenBSD: install.md,v 1.31 1999/07/30 17:16:02 deraadt Exp $
d83 4
@


1.31
log
@acd went away
@
text
@d1 1
a1 1
#       $OpenBSD: install.md,v 1.30 1999/04/02 05:17:38 millert Exp $
a49 4
}

md_copy_kernel() {
	check_kernel
@


1.30
log
@Fix "no closing quote" problem.
@
text
@d1 1
a1 1
#       $OpenBSD: install.md,v 1.29 1999/04/01 22:10:14 millert Exp $
d81 1
a81 1
	md_get_msgbuf | egrep "^a?cd[0-9]+ " | cutword 1
@


1.29
log
@shave a few bytes
@
text
@d1 1
a1 1
#       $OpenBSD: install.md,v 1.28 1999/04/01 21:30:20 deraadt Exp $
d174 1
a174 1
As a reminder, installing the `etc' binary set is NOT recommended.
d176 1
a176 1
merge any changes to files in the `etc' set into those files which
d200 1
a200 1
OK, then.  Enter `halt' at the prompt to halt the machine.  Once the
@


1.28
log
@disklabel -f use, for fstab tweaking
@
text
@d1 1
a1 1
#       $OpenBSD: install.md,v 1.27 1998/11/09 03:58:04 millert Exp $
d46 1
a46 1
MDSETS="kernel"
d57 1
a57 3
	if [ ! -z "$TERM" ]; then
		return
	fi
d59 2
a60 2
	getresp "sun"
	TERM="$resp"
d86 1
a86 1
	echo "[a-p]"
d92 2
a93 2
	if [ "X${1}" = X"" ]; then
		echo "No disk device specified, you must run installboot manually."
d106 1
a106 1
		echo "No boot block prototypes found, you must run installboot manually."
d129 1
a129 1
	local _disk
a130 1
	_disk=$1
d136 1
a136 1
		echo "WARNING: Disk $_disk has no label. You will be creating a new one."
d140 1
a140 1
		echo "WARNING: Label on disk $_disk is corrupted. You will be repairing."
d146 1
a146 1
	cat << \__md_prep_disklabel_1
d151 1
a151 1
__md_prep_disklabel_1
d159 3
a161 3
	if [ "$MODE" = "install" ]; then
		echo "Welcome to the OpenBSD/alpha ${VERSION_MAJOR}.${VERSION_MINOR} installation program."
		cat << \__welcome_banner_1
a164 1
__welcome_banner_1
d166 1
d168 2
a169 2
		echo "Welcome to the OpenBSD/alpha ${VERSION_MAJOR}.${VERSION_MINOR} upgrade program."
		cat << \__welcome_banner_2
d179 1
a179 1
__welcome_banner_2
d182 1
a182 1
cat << \__welcome_banner_3
d193 1
a193 1
__welcome_banner_3
d198 1
a198 1
	cat << \__not_going_to_install_1
d203 1
a203 1
__not_going_to_install_1
d208 2
a209 2
	if [ "$MODE" = "install" ]; then
		what="installed";
d211 1
a211 1
		what="upgraded";
d213 1
a213 1
	cat << __congratulations_1
d219 1
a219 1
__congratulations_1
d223 1
d226 1
d232 1
a232 2
	if [ -e ${TMPWRITEABLE} ]
	then
d238 1
a238 1
		cat << \__rd0_failed_1
d242 1
a242 1
__rd0_failed_1
d253 3
a255 7
	if [ -e ${KERNFSMOUNTED} ]
	then
		return
	fi
	if ! mount -t kernfs /kern /kern
	then
		cat << \__kernfs_failed_1
d257 1
a257 1
__kernfs_failed_1
d260 1
a260 1
	> ${KERNFSMOUNTED}
d267 1
a267 1
		*)	echo "usage: hostname [name-of-host]"
@


1.27
log
@md_labeldisk is not used any more
@
text
@d1 1
a1 1
#       $OpenBSD: install.md,v 1.26 1998/11/03 04:10:13 aaron Exp $
d157 1
a157 1
	disklabel -E ${_disk}
@


1.26
log
@seperating -> separating
@
text
@d1 1
a1 1
#       $OpenBSD: install.md,v 1.25 1998/10/28 17:53:27 millert Exp $
a109 3
}
md_labeldisk() {
	echo "huh"
@


1.25
log
@call check_kernel instead of having the same code in all the .md files
@
text
@d1 1
a1 1
#       $OpenBSD: install.md,v 1.24 1998/09/24 06:39:49 millert Exp $
d155 1
a155 1
(ie. seperating /, /usr, /tmp, /var, /usr/local, and other things)
@


1.24
log
@use cutword, not sed, in msgbuf munging
@
text
@d1 1
a1 1
#       $OpenBSD: install.md,v 1.23 1998/09/11 22:55:46 millert Exp $
d53 1
a53 17
	if [ ! -s /mnt/bsd ]; then
		echo	""
		echo	"Warning, no kernel installed!"
		echo	"You did not unpack a file set containing a kernel."
		echo	"This is needed to boot.  Please note that the install"
		echo	"install kernel is not suitable for general use."
		echo -n	"Escape to shell add /mnt/bsd by hand? [y] "
		getresp "y"
		case "$resp" in
			y*|Y*)
				echo "Type 'exit' to return to install."
				sh
				;;
			*)
				;;
		esac
	fi
@


1.23
log
@kill md_get_ifdevs, miniroot/install.sub uses mi version now
@
text
@d1 1
a1 1
#       $OpenBSD: install.md,v 1.22 1998/09/06 08:51:08 deraadt Exp $
d95 1
a95 1
	md_get_msgbuf | egrep "^[sw]d[0-9]+ " | sed 's/ .*//'
d99 1
a99 1
	md_get_msgbuf | egrep "^a?cd[0-9]+ " | sed 's/ .*//'
@


1.22
log
@add xl
@
text
@d1 1
a1 1
#       $OpenBSD: install.md,v 1.21 1998/03/29 19:57:51 millert Exp $
a99 5
}

md_get_ifdevs() {
        # return available network devices
	md_get_msgbuf | egrep "(^e[dp][0-9] |^xl[0-9] |^[dl]e[0-9] |fxp[0-9])" | sed -e 's/^ *//' -e 's/ .*//'
@


1.21
log
@Make welcome message line up with other text
@
text
@d1 1
a1 1
#       $OpenBSD: install.md,v 1.20 1998/03/29 00:08:06 millert Exp $
d104 1
a104 1
	md_get_msgbuf | egrep "(^e[dp][0-9] |^[dl]e[0-9] |fxp[0-9])" | sed -e 's/^ *//' -e 's/ .*//'
@


1.20
log
@Fix welcome in "upgrade" case.
@
text
@d1 1
a1 1
#       $OpenBSD: install.md,v 1.19 1998/03/27 23:28:12 deraadt Exp $
d190 2
a191 2
This program is designed to help you put OpenBSD on your system in a simple and
rational way.
@


1.19
log
@simplify a message
@
text
@d1 2
a2 1
#       $OpenBSD: install.md,v 1.18 1998/03/12 08:48:52 deraadt Exp $
d190 1
a190 1
This program is designed to help you put OpenBSD on your disk in a simple and
d195 1
a195 2
		echo ""
		echo "Welcome to the OpenBSD/alpha ${VERSION} upgrade program."
@


1.18
log
@banner fixups
@
text
@d1 1
a1 1
#       $OpenBSD: install.md,v 1.17 1998/02/28 02:39:11 millert Exp $
d189 2
a190 4
This program is designed to help you put OpenBSD on your disk, in a
simple and rational way.  You'll be asked several questions, and it
would probably be useful to have your disk's hardware manual, the
installation notes, and a calculator handy.
@


1.17
log
@Alpha does atapi cdrom too.  Also deal with sd/wd > 9.
@
text
@d1 1
a1 1
#       $OpenBSD: install.md,v 1.15 1997/10/30 21:14:41 niklas Exp $
a185 1
		echo ""
@


1.16
log
@non-scsi disks are ok too
@
text
@d94 1
a94 1
	md_get_msgbuf | egrep "^[sw]d[0-9] "
d98 1
a98 1
	md_get_msgbuf | egrep "^cd[0-9] "
@


1.15
log
@recognize ep* interfaces, fix greeting.
@
text
@d1 1
a1 1
#       $OpenBSD: install.md,v 1.14 1997/10/25 04:51:14 deraadt Exp $
d94 1
a94 1
	md_get_msgbuf | egrep "^sd[0-9] "
@


1.14
log
@indent
@
text
@d1 1
a1 1
#       $OpenBSD: install.md,v 1.13 1997/10/25 04:35:41 deraadt Exp $
d103 1
a103 1
	md_get_msgbuf | egrep "(^ed[0-9] |^[dl]e[0-9] |fxp[0-9])" | sed -e 's/^ *//' -e 's/ .*//'
d187 1
a187 1
		echo "Welcome to the OpenBSD/alpha ${VERSION} installation program."
@


1.14.2.1
log
@Merge in 1.14 to 1.15 from the trunk;
recognize ep* interfaces, fix greeting.
@
text
@d1 1
a1 1
#       $OpenBSD: install.md,v 1.15 1997/10/30 21:14:41 niklas Exp $
d103 1
a103 1
	md_get_msgbuf | egrep "(^e[dp][0-9] |^[dl]e[0-9] |fxp[0-9])" | sed -e 's/^ *//' -e 's/ .*//'
d187 1
a187 1
		echo "Welcome to the OpenBSD/alpha ${VERSION_MAJOR}.${VERSION_MINOR} installation program."
@


1.13
log
@clarify
@
text
@d1 1
a1 1
#       $OpenBSD: install.md,v 1.12 1997/10/11 08:12:23 deraadt Exp $
d173 3
a175 2
If you are unsure of how to use multiple partitions
properly (ie. seperating /,  /usr, /tmp, /var, /usr/local, and other things)
d177 1
a178 1
__md_prep_disklabel_1
@


1.12
log
@support fxp? devices
@
text
@d1 1
a1 1
#       $OpenBSD: install.md,v 1.11 1997/09/30 17:52:35 deraadt Exp $
a157 1
	echo "Note: your disklabel editor is $EDITOR"
a159 1
		echo -n "Do you wish to edit the disklabel on $_disk? [y] "
d162 2
a163 2
		echo "WARNING: Disk $_disk has no label"
		echo -n "Do you want to create one with the disklabel editor? [y] "
d166 2
a167 2
		echo "WARNING: Label on disk $_disk is corrupted"
		echo -n "Do you want to try and repair the damage using the disklabel editor? [y] "
a170 6
	getresp "y"
	case "$resp" in
	y*|Y*) ;;
	*)	return ;;
	esac

d173 3
a175 19

Here is an example of what the partition information will look like once
you have entered the disklabel editor. Disk partition sizes and offsets
are in sector (most likely 512 bytes) units. Make sure these size/offset
pairs are on cylinder boundaries (the number of sector per cylinder is
given in the `sectors/cylinder' entry, which is not shown here).

Do not change any parameters except the partition layout and the label name.
It's probably also wisest not to touch the `8 partitions:' line, even
in case you have defined less than eight partitions.

[Example]
8 partitions:
#        size   offset    fstype   [fsize bsize   cpg]
  a:    50176        0    4.2BSD     1024  8192    16   # (Cyl.    0 - 111)
  b:    64512    50176      swap                        # (Cyl.  112 - 255)
  c:   640192        0   unknown                        # (Cyl.    0 - 1428)
  d:   525504   114688    4.2BSD     1024  8192    16   # (Cyl.  256 - 1428)
[End of example]
a177 2
	echo -n "Press [Enter] to continue "
	getresp ""
d189 4
a192 4
This program is designed to help you put OpenBSD on your disk,
in a simple and rational way.  You'll be asked several questions,
and it would probably be useful to have your disk's hardware
manual, the installation notes, and a calculator handy.
d207 1
d213 7
a219 8
As with anything which modifies your disk's contents, this
program can cause SIGNIFICANT data loss, and you are advised
to make sure your data is backed up before beginning the
installation process.

Default answers are displayed in brackets after the questions.
You can hit Control-C at any time to quit, but if you do so at a
prompt, you may have to hit return.  Also, quitting in the middle of
@


1.11
log
@use new fdisk & disklabel
@
text
@d1 1
a1 1
#       $OpenBSD: install.md,v 1.10 1997/07/31 17:10:14 millert Exp $
d103 1
a103 1
	md_get_msgbuf | egrep "(^ed[0-9] |^[dl]e[0-9] )" | sed -e 's/^ *//' -e 's/ .*//'
@


1.10
log
@Make default termtype sun, not ansi-mini
@
text
@d1 1
a1 1
#       $OpenBSD: install.md,v 1.9 1997/07/09 15:11:10 millert Exp $
d205 1
a205 1
	disklabel -e ${_disk}
@


1.9
log
@Don't use sync(1)
@
text
@d1 1
a1 1
#       $OpenBSD: install.md,v 1.8 1997/05/15 05:13:09 millert Exp $
d75 2
a76 2
	echo -n "Specify terminal type [ansi-mini]: "
	getresp "ansi-mini"
@


1.8
log
@Bitch if md_installboot called with no args.
@
text
@d1 1
a1 1
#       $OpenBSD: install.md,v 1.7 1997/05/15 03:44:10 millert Exp $
a122 1
		sync
a125 1
		sync
@


1.7
log
@Add md_machine_arch.  This should've gotten committed with the other
changes.
@
text
@d1 1
a1 1
#       $OpenBSD: install.md,v 1.6 1997/05/14 16:06:14 millert Exp $
d114 4
@


1.6
log
@Tell the use what $EDITOR is before editing disklabel so they
don't freak when they find themselves in ed(1) :-)
@
text
@d1 1
a1 1
#       $OpenBSD: install.md,v 1.5 1997/05/11 03:54:26 millert Exp $
d46 4
@


1.5
log
@Use the common distrib/miniroot{install.sh,install.sub}.
@
text
@d1 1
a1 1
#       $OpenBSD: install.md,v 1.4 1997/05/09 17:59:37 millert Exp $
d152 1
@


1.4
log
@Nuke sort and hostname, add md_installboot and hostname functions.
@
text
@d1 1
a1 1
#       $OpenBSD: install.md,v 1.3 1997/05/09 02:25:08 millert Exp $
a39 1
#
d44 3
d48 17
a64 1
	echo "This must be done later by hand"
d71 2
a72 2
	echo -n "Specify terminal type [xterm]: "
	getresp "xterm"
@


1.3
log
@We only want to look at boot messages from *this* boot.  Sed
out the others.
@
text
@d1 1
a1 1
#       $OpenBSD: install.md,v 1.2 1997/05/08 12:49:55 niklas Exp $
d81 1
a81 1
	md_get_msgbuf | egrep "(^ed[0-9] |^[dl]e[0-9] )" | cut -d" " -f1 | sort -u
d90 16
a105 1
	echo "This must be done later by hand"
d294 8
@


1.2
log
@s/powerpc/alpha/
@
text
@d1 1
a1 1
#       $OpenBSD: install.md,v 1.1 1997/05/07 12:46:56 niklas Exp $
d59 12
d72 1
a72 1
	egrep "^sd[0-9] " < /kern/msgbuf
d76 1
a76 1
	egrep "^cd[0-9] " < /kern/msgbuf
d79 3
a81 3
md_get_ifdevs() {                                                         
        # return available network devices                               
	egrep "(^ed[0-9] |^[dl]e[0-9] )"< /kern/msgbuf  | cut -d" " -f1 | sort -u
d278 1
a278 1
	> ${KERNFSMOUNTED} 
@


1.1
log
@*Very* rough cut at a ramdisk-kernel that fits onto a floppy.
The ecoffrdsetroot support is from millert@@openbsd.org.  Mostly copied from
the powerpc ports, thus a lot of powerpc specific stuff remains.
Needs a lot of work, hopefully done in the next few days.
@
text
@d1 1
a1 1
#       $OpenBSD: install.md,v 1.3 1997/02/21 17:42:07 rahnds Exp $
d160 1
a160 1
		echo "Welcome to the OpenBSD/powerpc ${VERSION} installation program."
d171 1
a171 1
		echo "Welcome to the OpenBSD/powerpc ${VERSION} upgrade program."
@

