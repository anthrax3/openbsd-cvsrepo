head	1.49;
access;
symbols
	OPENBSD_6_1_BASE:1.49
	OPENBSD_6_0:1.46.0.2
	OPENBSD_6_0_BASE:1.46
	OPENBSD_5_9:1.45.0.2
	OPENBSD_5_9_BASE:1.45
	OPENBSD_5_8:1.45.0.4
	OPENBSD_5_8_BASE:1.45
	OPENBSD_5_7:1.42.0.2
	OPENBSD_5_7_BASE:1.42
	OPENBSD_5_6:1.40.0.4
	OPENBSD_5_6_BASE:1.40
	OPENBSD_5_5:1.39.0.2
	OPENBSD_5_5_BASE:1.39
	OPENBSD_5_4:1.32.0.4
	OPENBSD_5_4_BASE:1.32
	OPENBSD_5_3:1.32.0.2
	OPENBSD_5_3_BASE:1.32
	OPENBSD_5_2:1.31.0.8
	OPENBSD_5_2_BASE:1.31
	OPENBSD_5_1_BASE:1.31
	OPENBSD_5_1:1.31.0.6
	OPENBSD_5_0:1.31.0.4
	OPENBSD_5_0_BASE:1.31
	OPENBSD_4_9:1.31.0.2
	OPENBSD_4_9_BASE:1.31
	OPENBSD_4_8:1.30.0.2
	OPENBSD_4_8_BASE:1.30
	OPENBSD_4_7:1.29.0.2
	OPENBSD_4_7_BASE:1.29
	OPENBSD_4_6:1.28.0.4
	OPENBSD_4_6_BASE:1.28
	OPENBSD_4_5:1.23.0.2
	OPENBSD_4_5_BASE:1.23
	OPENBSD_4_4:1.21.0.4
	OPENBSD_4_4_BASE:1.21
	OPENBSD_4_3:1.21.0.6
	OPENBSD_4_3_BASE:1.21
	OPENBSD_4_2:1.21.0.2
	OPENBSD_4_2_BASE:1.21
	OPENBSD_4_1:1.20.0.2
	OPENBSD_4_1_BASE:1.20
	OPENBSD_4_0:1.19.0.2
	OPENBSD_4_0_BASE:1.19
	OPENBSD_3_9:1.18.0.4
	OPENBSD_3_9_BASE:1.18
	OPENBSD_3_8:1.18.0.2
	OPENBSD_3_8_BASE:1.18
	OPENBSD_3_7:1.16.0.2
	OPENBSD_3_7_BASE:1.16
	OPENBSD_3_6:1.11.0.6
	OPENBSD_3_6_BASE:1.11
	OPENBSD_3_5:1.11.0.4
	OPENBSD_3_5_BASE:1.11
	OPENBSD_3_4:1.11.0.2
	OPENBSD_3_4_BASE:1.11
	OPENBSD_3_3:1.9.0.4
	OPENBSD_3_3_BASE:1.9
	OPENBSD_3_2:1.9.0.2
	OPENBSD_3_2_BASE:1.9
	OPENBSD_3_1:1.3.0.4
	OPENBSD_3_1_BASE:1.3
	OPENBSD_3_0:1.3.0.2
	OPENBSD_3_0_BASE:1.3
	OPENBSD_2_9:1.1.0.2
	OPENBSD_2_9_BASE:1.1;
locks; strict;
comment	@# @;


1.49
date	2016.09.13.22.27.50;	author rpe;	state Exp;
branches;
next	1.48;
commitid	GBnmSiVk0pmscj9y;

1.48
date	2016.09.04.09.54.22;	author rpe;	state Exp;
branches;
next	1.47;
commitid	GShD1XwYMI1YRfdA;

1.47
date	2016.09.03.10.57.11;	author rpe;	state Exp;
branches;
next	1.46;
commitid	pFfkafQ0XO5kSNdx;

1.46
date	2016.04.02.12.23.46;	author rpe;	state Exp;
branches;
next	1.45;
commitid	RiZ3BjQb9aPCOLdl;

1.45
date	2015.04.13.21.27.05;	author deraadt;	state Exp;
branches;
next	1.44;
commitid	XlnjSM8QPyxXBJUX;

1.44
date	2015.04.02.16.13.20;	author deraadt;	state Exp;
branches;
next	1.43;
commitid	xCtdNbyuk86cJEuz;

1.43
date	2015.03.11.15.27.31;	author deraadt;	state Exp;
branches;
next	1.42;
commitid	CiK8k4NfUdHOtlhW;

1.42
date	2014.12.28.04.40.18;	author deraadt;	state Exp;
branches;
next	1.41;
commitid	0Q152diy3j6ZcHnS;

1.41
date	2014.12.27.06.02.00;	author deraadt;	state Exp;
branches;
next	1.40;
commitid	ynzGEyGPUs5Lc7eO;

1.40
date	2014.07.20.02.37.35;	author deraadt;	state Exp;
branches;
next	1.39;
commitid	Js54FgDjh3ceuvNj;

1.39
date	2014.03.03.07.40.34;	author deraadt;	state Exp;
branches;
next	1.38;

1.38
date	2014.01.11.05.40.15;	author deraadt;	state Exp;
branches;
next	1.37;

1.37
date	2014.01.10.07.57.24;	author deraadt;	state Exp;
branches;
next	1.36;

1.36
date	2014.01.09.19.02.02;	author deraadt;	state Exp;
branches;
next	1.35;

1.35
date	2014.01.08.21.53.34;	author deraadt;	state Exp;
branches;
next	1.34;

1.34
date	2014.01.08.06.17.21;	author deraadt;	state Exp;
branches;
next	1.33;

1.33
date	2014.01.07.02.27.53;	author deraadt;	state Exp;
branches;
next	1.32;

1.32
date	2012.10.16.16.45.04;	author deraadt;	state Exp;
branches;
next	1.31;

1.31
date	2010.10.18.04.07.49;	author deraadt;	state Exp;
branches;
next	1.30;

1.30
date	2010.03.31.17.51.42;	author deraadt;	state Exp;
branches;
next	1.29;

1.29
date	2010.01.01.05.47.00;	author deraadt;	state Exp;
branches;
next	1.28;

1.28
date	2009.06.12.16.47.15;	author deraadt;	state Exp;
branches;
next	1.27;

1.27
date	2009.05.06.01.30.39;	author deraadt;	state Exp;
branches;
next	1.26;

1.26
date	2009.05.03.00.25.30;	author deraadt;	state Exp;
branches;
next	1.25;

1.25
date	2009.04.19.00.59.39;	author deraadt;	state Exp;
branches;
next	1.24;

1.24
date	2009.04.17.07.18.55;	author deraadt;	state Exp;
branches;
next	1.23;

1.23
date	2009.02.19.23.43.54;	author krw;	state Exp;
branches;
next	1.22;

1.22
date	2009.02.15.15.56.45;	author krw;	state Exp;
branches;
next	1.21;

1.21
date	2007.07.11.01.50.40;	author deraadt;	state Exp;
branches;
next	1.20;

1.20
date	2007.02.14.23.38.20;	author deraadt;	state Exp;
branches;
next	1.19;

1.19
date	2006.03.12.12.30.30;	author deraadt;	state Exp;
branches;
next	1.18;

1.18
date	2005.05.04.17.15.36;	author miod;	state Exp;
branches;
next	1.17;

1.17
date	2005.05.04.17.08.04;	author miod;	state Exp;
branches;
next	1.16;

1.16
date	2005.01.12.18.25.26;	author deraadt;	state Exp;
branches;
next	1.15;

1.15
date	2005.01.11.19.21.07;	author deraadt;	state Exp;
branches;
next	1.14;

1.14
date	2004.12.29.00.45.30;	author deraadt;	state Exp;
branches;
next	1.13;

1.13
date	2004.11.08.21.17.50;	author deraadt;	state Exp;
branches;
next	1.12;

1.12
date	2004.10.02.14.47.12;	author krw;	state Exp;
branches;
next	1.11;

1.11
date	2003.06.11.03.49.34;	author miod;	state Exp;
branches;
next	1.10;

1.10
date	2003.04.17.23.03.08;	author deraadt;	state Exp;
branches;
next	1.9;

1.9
date	2002.05.01.19.21.27;	author mickey;	state Exp;
branches;
next	1.8;

1.8
date	2002.05.01.01.15.53;	author millert;	state Exp;
branches;
next	1.7;

1.7
date	2002.04.30.03.47.03;	author deraadt;	state Exp;
branches;
next	1.6;

1.6
date	2002.04.30.01.31.19;	author deraadt;	state Exp;
branches;
next	1.5;

1.5
date	2002.04.22.02.43.16;	author deraadt;	state Exp;
branches;
next	1.4;

1.4
date	2002.04.21.07.09.36;	author deraadt;	state Exp;
branches;
next	1.3;

1.3
date	2001.08.29.15.01.17;	author krw;	state Exp;
branches;
next	1.2;

1.2
date	2001.06.23.19.44.34;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	2001.01.29.21.25.46;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.49
log
@Provide a stripped down group file for the install media.
Saves precious 896 bytes as a side effect.

OK deraadt
@
text
@#	$OpenBSD: list,v 1.48 2016/09/04 09:54:22 rpe Exp $

SRCDIRS distrib/special

# copy the crunched binary, link to it, and kill it
COPY	${OBJDIR}/instbin			instbin
LINK	instbin					bin/arch
LINK	instbin					bin/cat
LINK	instbin					bin/chmod bin/chgrp sbin/chown
LINK	instbin					bin/cp
LINK	instbin					bin/date
LINK	instbin					bin/dd
LINK	instbin					bin/df
LINK	instbin					bin/ed
LINK	instbin					bin/hostname
LINK	instbin					bin/ksh bin/sh
ARGVLINK ksh					-sh
LINK	instbin					bin/ln
LINK	instbin					bin/ls
LINK	instbin					bin/md5 bin/sha256 bin/sha512
SPECIAL	rm bin/md5
LINK	instbin					bin/mkdir
LINK	instbin					bin/mv
LINK	instbin					bin/pax bin/tar
LINK	instbin					bin/rm
LINK	instbin					bin/sleep
LINK	instbin					bin/stty
LINK	instbin					bin/sync
LINK	instbin					sbin/disklabel
LINK	instbin					sbin/dmesg
LINK	instbin					sbin/fsck
LINK	instbin					sbin/fsck_ffs
LINK	instbin					sbin/ifconfig
LINK	instbin					sbin/init
LINK	instbin					sbin/mknod
LINK	instbin					sbin/mount
LINK	instbin					sbin/mount_ffs
LINK	instbin					sbin/newfs
LINK	instbin					sbin/reboot sbin/halt
LINK	instbin					sbin/route
LINK	instbin					sbin/sysctl
LINK	instbin					sbin/umount
LINK	instbin					usr/bin/doas
LINK	instbin					usr/bin/encrypt
LINK	instbin					usr/bin/ftp
LINK	instbin					usr/bin/grep usr/bin/egrep usr/bin/fgrep
LINK	instbin					usr/bin/gzip usr/bin/gunzip usr/bin/gzcat
LINK	instbin					usr/bin/more usr/bin/less
LINK	instbin					usr/bin/sed
LINK	instbin					usr/bin/signify
LINK	instbin					usr/sbin/chroot
LINK	instbin					usr/sbin/pwd_mkdb

# copy the MAKEDEV script and make some devices
SCRIPT	${DESTDIR}/dev/MAKEDEV			dev/MAKEDEV
SPECIAL	cd dev; sh MAKEDEV ramdisk

# various files that we need in /etc for the install
COPY	${CURDIR}/../../miniroot/group		etc/group
COPY	${CURDIR}/../../miniroot/master.passwd	etc/master.passwd
SPECIAL	pwd_mkdb -p -d etc master.passwd; rm etc/master.passwd
COPY	${DESTDIR}/etc/signify/openbsd-${REV}-base.pub	etc/signify/openbsd-${REV}-base.pub
COPY	${CURDIR}/../../miniroot/protocols	etc/protocols
COPY	${CURDIR}/../../miniroot/services	etc/services
TERMCAP	vt100,vt220,dumb			usr/share/misc/termcap

SYMLINK	/tmp/i/resolv.conf.shadow		etc/resolv.conf

# and the installation tools
SCRIPT	${CURDIR}/../../miniroot/dot.profile	.profile
SCRIPT	${CURDIR}/../../miniroot/install.sub	install.sub
SCRIPT	${CURDIR}/../common/install.md		install.md
SPECIAL	chmod 755 install.sub
SYMLINK	install.sub				autoinstall
SYMLINK	install.sub				install
SYMLINK	install.sub				upgrade
@


1.48
log
@Move files created by root during install/upgrade in a subdir of
/tmp with proper permissions so that unprivileged programs can not
tamper with them.

positive feedback from deraadt
OK halex
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.47 2016/09/03 10:57:11 rpe Exp $
d59 1
a59 1
COPY	${DESTDIR}/etc/group			etc/group
@


1.47
log
@Enable a stripped down version of doas(1) on the install media.

OK halex, tb, deraadt
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.46 2016/04/02 12:23:46 rpe Exp $
d67 1
a67 1
SYMLINK	/tmp/resolv.conf.shadow			etc/resolv.conf
@


1.46
log
@- merge install.sh into install.sub as do_install()
- merge upgrade.sh into install.sub as do_upgrade()
- delete install.sh and upgrade.sh
- make install.sub executable
- turn install and upgrade into symbolic links to install.sub
- add autoinstall symbolic link to install.sub
- change dot.profile to use these symlinks
- introduce a -m option to set MODE in install.sub
- alternativly set MODE and AUTO depending on PROGNAME
- execute the do_{install,upgrade) functions depending on $MODE

OK halex@@, krw@@
'go for it' deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.45 2015/04/13 21:27:05 deraadt Exp $
d43 1
@


1.45
log
@pwd_mkdb now fits onto the install media.  no more chroot games.
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.44 2015/04/02 16:13:20 deraadt Exp $
a70 2
SCRIPT	${CURDIR}/../../miniroot/install.sh	install
SCRIPT	${CURDIR}/../../miniroot/upgrade.sh	upgrade
d72 4
a75 1
SPECIAL	chmod 755 install upgrade
@


1.44
log
@more -> less; not less -> more
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.43 2015/03/11 15:27:31 deraadt Exp $
d51 1
@


1.43
log
@adjust for removal of expr (and while here, sort all these lists, with the
goal of eventually refactoring them)
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.42 2014/12/28 04:40:18 deraadt Exp $
d47 1
a47 1
LINK	instbin					usr/bin/less usr/bin/more
@


1.42
log
@Build special/encrypt into instbin, to prepare for dropping use of the
version in just installed base.
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.41 2014/12/27 06:02:00 deraadt Exp $
a8 1
LINK	instbin					bin/date
d11 1
d15 1
d28 1
a32 1
LINK	instbin					sbin/hostname
d47 1
a47 1
LINK	instbin					usr/bin/more usr/bin/less
d50 1
@


1.41
log
@SRCDIRS must now always come from distrib/special.  A few systems
still MD installboot, and we will need to repair those before
release, or force them pure -static use by both base and instbin.
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.40 2014/07/20 02:37:35 deraadt Exp $
d42 1
@


1.40
log
@place sysctl in sorted order; Jean-Philippe Ouellet
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.39 2014/03/03 07:40:34 deraadt Exp $
a3 1
SRCDIRS bin sbin
@


1.39
log
@use official 5.5 key
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.38 2014/01/11 05:40:15 deraadt Exp $
d41 1
a47 1
LINK	instbin					sbin/sysctl
@


1.38
log
@No need for a bin/cpio link on the media, because the pax|tar binary does
not support cpio anymore.
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.37 2014/01/10 07:57:24 deraadt Exp $
d58 1
a58 1
COPY	${DESTDIR}/etc/signify/${REV}base.pub	etc/signify/${REV}base.pub
@


1.37
log
@remove md5 after installing it (with the links to the sha256/512 commands).
this is because the md5/sha256/sha512 are in the same binary, found in the
md5 directory, but the version on the media lacks md5 support.  Understand?
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.36 2014/01/09 19:02:02 deraadt Exp $
d24 1
a24 1
LINK	instbin					bin/pax bin/tar bin/cpio
@


1.36
log
@copy the relevant key for the release onto the media
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.35 2014/01/08 21:53:34 deraadt Exp $
d21 1
@


1.35
log
@Switch to using the base sha256 command, rather than some customized
abomination.
install.sub chunk tested by rpe
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.34 2014/01/08 06:17:21 deraadt Exp $
d55 3
a59 2
COPY	${CURDIR}/../../miniroot/master.passwd	etc/master.passwd
SPECIAL	pwd_mkdb -p -d etc master.passwd; rm etc/master.passwd
@


1.34
log
@always include dd
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.33 2014/01/07 02:27:53 deraadt Exp $
d20 1
d47 1
@


1.33
log
@SRCDRS usr.bin usr.sbin is a bad idea (because of PIE).  The places we
pick binaries up must be compiled -static or at least in some safe
model for reuse.  Since we now use distrib/special for those, we can
safely remove usr.bin and usr.sbin from this list.
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.32 2012/10/16 16:45:04 deraadt Exp $
d13 1
a13 1
#LINK	instbin					bin/dd
@


1.32
log
@use the baseXX /usr/mdec stuff post-install to put boot media on the
disk, rather than including it in the ramdisk
tested by landry
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.31 2010/10/18 04:07:49 deraadt Exp $
d4 1
a4 1
SRCDIRS bin sbin usr.bin usr.sbin
@


1.31
log
@Place a smaller spwd.db onto the install media.  Be consistant with the naming
of the "additional" list files (for architectures which split the list)
Then... cleanup some TZ which it is clear should not have been placed onto
certain media which don't have the space for them.
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.30 2010/03/31 17:51:42 deraadt Exp $
a4 1
SRCDIRS sys/arch/alpha/stand
a45 1
#LINK	instbin					usr/mdec/installboot
a49 4

# we need the contents of /usr/mdec XXX - no it's not necessary and won't fit.
#COPY	${DESTDIR}/usr/mdec/boot		usr/mdec/boot
#COPY	${DESTDIR}/usr/mdec/bootxx		usr/mdec/bootxx
@


1.30
log
@put date(1) onto the media, it fits
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.29 2010/01/01 05:47:00 deraadt Exp $
d61 2
a62 1
COPY	${DESTDIR}/etc/spwd.db			etc/spwd.db
@


1.29
log
@add arch(1) to the ramdisk, it is tiny and we will soon need it
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.28 2009/06/12 16:47:15 deraadt Exp $
d11 1
@


1.28
log
@the TZ list cannot fit onto the floppies
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.27 2009/05/06 01:30:39 deraadt Exp $
d9 1
@


1.27
log
@Put the tzdir onto some of the media we think it will fit onto
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.26 2009/05/03 00:25:30 deraadt Exp $
a70 1
TZ
@


1.26
log
@We will need bin/sleep on all ramdisks.
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.25 2009/04/19 00:59:39 deraadt Exp $
d71 1
@


1.25
log
@Use sysctl -n hw.disknames instead of the custom disknames program
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.24 2009/04/17 07:18:55 deraadt Exp $
d23 1
@


1.24
log
@er, wrong path
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.23 2009/02/19 23:43:54 krw Exp $
d43 1
a43 1
LINK	instbin					usr/bin/disknames
@


1.23
log
@Don't create links to non-existant disktab files on the install
media.

The Alpha disktab was an empty (comment only) file.

ok deraadt@@ miod@@
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.22 2009/02/15 15:56:45 krw Exp $
d61 1
a61 2
# so DNS can work
SYMLINK /tmp/resolv.conf.shadow			etc/resolv.conf
@


1.22
log
@Build install media with disktab.shadow already in /tmp, rather
than have the install script copy it there. Shrinks install script,
removes an extra copy of disktab.

ok deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.21 2007/07/11 01:50:40 deraadt Exp $
a65 1
SCRIPT	${CURDIR}/../common/disktab.shadow	tmp/disktab.shadow
@


1.21
log
@do not put mt/eject onto small media; ok krw
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.20 2007/02/14 23:38:20 deraadt Exp $
d66 1
a66 1
SCRIPT	${CURDIR}/../common/disktab.shadow	etc/disktab.shadow
@


1.20
log
@put the disknames command on all install media (hope i did not miss any) ok krw@@
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.19 2006/03/12 12:30:30 deraadt Exp $
a20 1
LINK	instbin					bin/mt bin/eject
@


1.19
log
@mt/eject fits here, i was unsure..
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.18 2005/05/04 17:15:36 miod Exp $
d44 1
@


1.18
log
@grep -> egrep/fgrep, gzip -> gunzip/gzcat where missing.
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.17 2005/05/04 17:08:04 miod Exp $
d21 1
@


1.17
log
@Put pax/tar/cpio at the same location in all installation media.
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.16 2005/01/12 18:25:26 deraadt Exp $
d40 1
a40 1
LINK	instbin					usr/bin/gzip
@


1.16
log
@remove some differences
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.15 2005/01/11 19:21:07 deraadt Exp $
d21 1
a41 1
LINK	instbin					usr/bin/pax bin/cpio bin/tar
@


1.15
log
@put a seperate and real fsck on the media
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.14 2004/12/29 00:45:30 deraadt Exp $
d15 2
a20 2
LINK	instbin					bin/ksh bin/sh
ARGVLINK ksh					-sh
a24 1
LINK	instbin					sbin/hostname
d27 1
d41 1
a42 1
LINK	instbin					usr/bin/pax bin/cpio bin/tar
@


1.14
log
@nothing uses a SRCDIR of gnu anymore, proposed by mickey, tested by me
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.13 2004/11/08 21:17:50 deraadt Exp $
d26 2
a27 1
LINK	instbin					sbin/fsck_ffs sbin/fsck
@


1.13
log
@remove dd from all media, add back in for bsd.rd (the fatty)
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.12 2004/10/02 14:47:12 krw Exp $
d4 1
a4 1
SRCDIRS bin sbin gnu/usr.bin usr.bin usr.sbin
@


1.12
log
@Last use of sleep(1) in install scripts was eliminated by recent
re-write of install_cd() so remove sleep(1) from install media.

"sure!" deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.11 2003/06/11 03:49:34 miod Exp $
d12 1
a12 1
LINK	instbin					bin/dd
a30 1
#LINK	instbin					sbin/mount_cd9660
@


1.11
log
@The upgrade script depends upon that, if mount_foo is present on the ramdisk
filesystem, option FOO is in the kernel.
Ensure this for mount_mfs/option MFS as well, to prevent failing upgrades
on some architectures.

ok krw@@ millert@@
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.10 2003/04/17 23:03:08 deraadt Exp $
a22 1
LINK	instbin					bin/sleep
@


1.10
log
@more not less
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.9 2002/05/01 19:21:27 mickey Exp $
d34 1
a34 1
LINK	instbin					sbin/newfs sbin/mount_mfs
@


1.9
log
@when filtering termcap selecet vt220, not vt200, since that's what we gonna use later, plus a few rcsid vicinity cleanups; millert@@ ok
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.8 2002/05/01 01:15:53 millert Exp $
d41 1
a41 1
LINK	instbin					usr/bin/less usr/bin/more
@


1.8
log
@We only need fsck_ffs, not the fsck front end.
Make all fsck list file entries simply be:
LINK	instbin			sbin/fsck_ffs sbin/fsck
@
text
@d1 1
a1 3
#
#	$OpenBSD: list,v 1.7 2002/04/30 03:47:03 deraadt Exp $
#
d59 1
a59 1
TERMCAP	vt100,vt200,dumb			usr/share/misc/termcap
@


1.7
log
@use makeconf.awk, and also simplify list management
@
text
@d2 1
a2 1
#	$OpenBSD: list,v 1.25 2002/04/30 01:31:19 deraadt Exp $
d29 1
a29 1
LINK	instbin					sbin/fsck
@


1.6
log
@use SCRIPT command
@
text
@d1 64
a64 1
#	$OpenBSD: list,v 1.5 2002/04/22 02:43:16 deraadt Exp $
@


1.5
log
@use one common dot.profile for all
@
text
@d1 1
a1 6
#	$OpenBSD: list,v 1.4 2002/04/21 07:09:36 deraadt Exp $

# we strip comments from files since we need the space...

# the disktab explanation file
#SPECIAL sed -e '/^#[ 	].*$/d' < ${CURDIR}/../common/disktab.preinstall > etc/disktab.preinstall
d4 6
a9 6
SPECIAL	sed -e '/^[ 	]*#[ 	].*$/d' -e '/^[ 	]*#$/d' < ${CURDIR}/../../miniroot/dot.profile > .profile
SPECIAL	sed -e '/^[ 	]*#[ 	].*$/d' -e '/^[ 	]*#$/d' < ${CURDIR}/../common/disktab.shadow > etc/disktab.shadow
SPECIAL	sed -e '/^[ 	]*#[ 	].*$/d' -e '/^[ 	]*#$/d' -e "/^VERSION=/s/=.*/=${REV}/" < ${CURDIR}/../../miniroot/install.sub > install.sub
SPECIAL	sed -e '/^[ 	]*#[ 	].*$/d' -e '/^[ 	]*#$/d' < ${CURDIR}/../../miniroot/install.sh > install
SPECIAL	sed -e '/^[ 	]*#[ 	].*$/d' -e '/^[ 	]*#$/d' < ${CURDIR}/../../miniroot/upgrade.sh > upgrade
SPECIAL sed -e '/^[ 	]*#[ 	].*$/d' -e '/^[ 	]*#$/d' -e "s/^ARCH=ARCH$/ARCH=`arch -ks`/" < ${CURDIR}/../common/install.md > install.md
@


1.4
log
@strip more carefully; guess what -- upgrade fits now
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.3 2001/08/29 15:01:17 krw Exp $
d9 1
a9 1
SPECIAL	sed -e '/^[ 	]*#[ 	].*$/d' -e '/^[ 	]*#$/d' < ${CURDIR}/../common/dot.profile > .profile
@


1.3
log
@Apply recent changes in the i386 comment eradication code to all
architectures using a list2sh.awk and related 'list' files (alpha,
hp300, mac68k, mvme68k, mvme88k, mvmeppc, powerpc and vax).

list2sh.awk is modified so that in handling SPECIAL lines the tabs in
regular expressions are not lost to awk field parsing.

Any 'list' file trying to eliminate comments, using SPECIAL lines and
sed, now eliminates lines that

a) have '#' as the first non-blank, non-tab character, with at least
one blank or tab following the '#'.

b) have '#' as the first non-blank, non-tab character, with a newline
immediately following the '#'.

Previous b) was not being done, and only leading/following blanks were
being looked for due to the loss of tab characters in list2sh.awk.
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.2 2001/06/23 19:44:34 deraadt Exp $
d13 3
a15 3
SPECIAL sed -e '/^[ 	]*#[ 	].*$/d' -e '/^[ 	]*#$/d' -e "s/^ARCH=ARCH$/ARCH=`arch -s`/" < ${CURDIR}/../common/install.md > install.md
SPECIAL	chmod 755 install
#SPECIAL chmod 755 upgrade
@


1.2
log
@argh.  stop using kernfs, using dmesg using sysctl.  encode ARCH into
install.md at build time.  remove some crud.  and the icing on the cake:
skip testing all this until next week
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.1 2001/01/29 21:25:46 deraadt Exp $
d9 5
a13 5
SPECIAL	sed -e '/^#[ 	].*$/d' < ${CURDIR}/../common/dot.profile > .profile
SPECIAL	sed -e '/^#[ 	].*$/d' < ${CURDIR}/../common/disktab.shadow > etc/disktab.shadow
SPECIAL	sed -e "/^VERSION=/s/=.*/=${REV}/" -e '/^#[ 	].*$/d' < ${CURDIR}/../../miniroot/install.sub > install.sub
SPECIAL	sed -e '/^#[ 	].*$/d' < ${CURDIR}/../../miniroot/install.sh > install
SPECIAL sed -e '/^#[ 	].*$/d' -e "s/^ARCH=ARCH$/ARCH=`arch -s`/" < ${CURDIR}/../common/install.md > install.md
@


1.1
log
@three floppies, and a bsd.rd for the CD
@
text
@d1 1
a1 1
#	$OpenBSD: list,v 1.8 2001/01/23 20:54:41 art Exp $
d13 1
a13 2
#SPECIAL	sed -e '/^#[ 	].*$/d' < ${CURDIR}/../../miniroot/upgrade.sh > upgrade
SPECIAL	sed -e '/^#[ 	].*$/d' < ${CURDIR}/../common/install.md > install.md
@

