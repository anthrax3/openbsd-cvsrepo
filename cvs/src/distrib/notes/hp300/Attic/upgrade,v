head	1.13;
access;
symbols
	OPENBSD_5_5:1.12.0.6
	OPENBSD_5_5_BASE:1.12
	OPENBSD_5_4:1.12.0.4
	OPENBSD_5_4_BASE:1.12
	OPENBSD_5_3:1.12.0.2
	OPENBSD_5_3_BASE:1.12
	OPENBSD_5_2:1.11.0.46
	OPENBSD_5_2_BASE:1.11
	OPENBSD_5_1_BASE:1.11
	OPENBSD_5_1:1.11.0.42
	OPENBSD_5_0:1.11.0.44
	OPENBSD_5_0_BASE:1.11
	OPENBSD_4_9:1.11.0.40
	OPENBSD_4_9_BASE:1.11
	OPENBSD_4_8:1.11.0.38
	OPENBSD_4_8_BASE:1.11
	OPENBSD_4_7:1.11.0.34
	OPENBSD_4_7_BASE:1.11
	OPENBSD_4_6:1.11.0.36
	OPENBSD_4_6_BASE:1.11
	OPENBSD_4_5:1.11.0.32
	OPENBSD_4_5_BASE:1.11
	OPENBSD_4_4:1.11.0.28
	OPENBSD_4_4_BASE:1.11
	OPENBSD_4_3:1.11.0.30
	OPENBSD_4_3_BASE:1.11
	OPENBSD_4_2:1.11.0.26
	OPENBSD_4_2_BASE:1.11
	OPENBSD_4_1:1.11.0.24
	OPENBSD_4_1_BASE:1.11
	OPENBSD_4_0:1.11.0.22
	OPENBSD_4_0_BASE:1.11
	OPENBSD_3_9:1.11.0.20
	OPENBSD_3_9_BASE:1.11
	OPENBSD_3_8:1.11.0.18
	OPENBSD_3_8_BASE:1.11
	OPENBSD_3_7:1.11.0.16
	OPENBSD_3_7_BASE:1.11
	OPENBSD_3_6:1.11.0.14
	OPENBSD_3_6_BASE:1.11
	OPENBSD_3_5:1.11.0.12
	OPENBSD_3_5_BASE:1.11
	OPENBSD_3_4:1.11.0.10
	OPENBSD_3_4_BASE:1.11
	OPENBSD_3_3:1.11.0.8
	OPENBSD_3_3_BASE:1.11
	OPENBSD_3_2:1.11.0.6
	OPENBSD_3_2_BASE:1.11
	OPENBSD_3_1:1.11.0.4
	OPENBSD_3_1_BASE:1.11
	OPENBSD_3_0:1.11.0.2
	OPENBSD_3_0_BASE:1.11
	OPENBSD_2_9:1.10.0.2
	OPENBSD_2_9_BASE:1.10
	OPENBSD_2_8:1.9.0.2
	OPENBSD_2_8_BASE:1.9
	OPENBSD_2_7:1.8.0.12
	OPENBSD_2_7_BASE:1.8
	OPENBSD_2_6:1.8.0.10
	OPENBSD_2_6_BASE:1.8
	OPENBSD_2_5:1.8.0.8
	OPENBSD_2_5_BASE:1.8
	OPENBSD_2_4:1.8.0.6
	OPENBSD_2_4_BASE:1.8
	OPENBSD_2_3:1.8.0.4
	OPENBSD_2_3_BASE:1.8
	OPENBSD_2_2:1.8.0.2
	OPENBSD_2_2_BASE:1.8
	OPENBSD_2_1:1.7.0.2
	OPENBSD_2_1_BASE:1.7
	OPENBSD_2_0:1.6.0.2
	OPENBSD_2_0_BASE:1.6
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@# @;


1.13
date	2014.03.18.22.36.28;	author miod;	state dead;
branches;
next	1.12;

1.12
date	2013.02.09.19.51.00;	author miod;	state Exp;
branches;
next	1.11;

1.11
date	2001.10.02.23.04.27;	author miod;	state Exp;
branches;
next	1.10;

1.10
date	2001.04.24.23.06.53;	author miod;	state Exp;
branches;
next	1.9;

1.9
date	2000.10.18.21.51.46;	author miod;	state Exp;
branches;
next	1.8;

1.8
date	97.10.20.06.46.26;	author downsj;	state Exp;
branches;
next	1.7;

1.7
date	97.04.30.20.27.30;	author deraadt;	state Exp;
branches;
next	1.6;

1.6
date	96.10.03.00.47.25;	author deraadt;	state Exp;
branches;
next	1.5;

1.5
date	96.10.03.00.39.58;	author deraadt;	state Exp;
branches;
next	1.4;

1.4
date	96.06.29.05.54.17;	author tholo;	state Exp;
branches;
next	1.3;

1.3
date	96.04.25.21.29.20;	author niklas;	state Exp;
branches;
next	1.2;

1.2
date	95.11.16.14.19.46;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.37.39;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.37.39;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.13
log
@Retire hp300, mvme68k and mvme88k ports. These ports have no users, keeping
this hardware alive is becoming increasingly difficult, and I should heed the
message sent by the three disks which have died on me over the last few days.

Noone sane will mourn these ports anyway. So long, and thanks for the fish.
@
text
@dnl $OpenBSD: upgrade,v 1.12 2013/02/09 19:51:00 miod Exp $
dnl Restore this line...
dnl OpenBSDUpgrade({:-bsd.rd-:})
dnl ... for the 5.5 release notes, where it can be assumed that the system
dnl being upgraded is not older than 5.3 and thus fully ELF.
dnl In the meantime, we'll stick to the variant below.
Warning! Upgrades to OpenBSD OSREV are currently only supported from the
immediately previous release.  The upgrade process will also work with older
releases, but might not execute some migration tasks that would be necessary
for a proper upgrade.

The best solution, whenever possible, is to backup your data and reinstall
from scratch. As a minimum, if the toolchain (the ``comp'' set) was installed,
you should remove all files within /usr/{:-include-:} before attempting to
upgrade.

To upgrade OpenBSD OSREV from a previous version, start with the general
instructions in the section "Installing OpenBSD".

IMPORTANT NOTE: if you intend to boot from bsd.rd, it is very likely that
  your boot blocks do not support ELF kernels. Before attempting to boot
  bsd.rd, upgrade the boot blocks by copying the provided ``SYS_UBOOT'' file
  to /usr/mdec/sdboot (or /usr/mdec/hdboot if your boot disk is an HP-IB disk),
  and run, as root:
	/sbin/disklabel -B sd0
  (replacing `sd0' with the name of your boot disk).
  You will then be able to boot bsd.rd.

Boot from bsd.rd.
When prompted, select the (U)pgrade option rather than the (I)nstall
option at the prompt in the install process.

You will be presented with a welcome message and asked if you really wish
to upgrade.

The upgrade script will ask you for the existing root partition, and
will use the existing filesystems defined in /etc/fstab to install the
new system in.  It will also use your existing network parameters.

From then, the upgrade procedure is very close to the installation
procedure described earlier in this document.  Note that the upgrade
procedure will not let you pick neither the ``etc{:--:}OSrev.tgz'' nor the
``xetc{:--:}OSrev.tgz'' sets, so as to preserve your files in `/etc' which
you are likely to have customized since a previous installation.

However, it is strongly advised that you unpack the etc{:--:}OSrev.tgz and
xetc{:--:}OSrev.tgz sets in a temporary directory and merge changes by hand, or
with the help of the sysmerge(8) helper script, since all components of
your system may not function correctly until your files in `/etc' are
updated.
@


1.12
log
@Teach people they will need to upgrade their boot blocks, and how to do this,
if they want to upgrade with bsd.rd, since older boot blocks can't boot ELF
kernels.
@
text
@d1 1
a1 1
dnl $OpenBSD$
@


1.11
log
@Sync with OpenBSDUpgrade macro change. Explicitely provide all the media
able to start an upgrade procedure.
@
text
@d1 50
a50 1
OpenBSDUpgrade({:-the miniroot-:})
@


1.10
log
@Update supported hardware list, fix typos, use m4.common macros
whenever possible, remove obsolete information, etc.

ok fries@@
@
text
@d1 1
a1 1
OpenBSDUpgrade
@


1.9
log
@This is not the first release of OpenBSD/hp300 anymore, provide simple
upgrade instructions. ericj@@ ok
@
text
@d1 1
a1 10
To upgrade to OpenBSD OSREV from a previous version start with the general
instructions in the section "Installing OpenBSD".

After booting with the miniroot, select the (U)pdate option rather than
the (I)nstall option at the prompt in the install process.

The upgrade script will use the existing disk partitions to install the
new system in, and also preserves files in `/etc' which you are likely
to have customized since a previous installation.

@


1.8
log
@First cut at an updated INSTALL.
@
text
@d1 9
a9 3
There is no upgrade mechanism supported by this release of OpenBSD/hp300,
since it is the first official release for this architecture, and is not
compatible with other operating systems.
a10 2
Be sure to back up any important data from your system, and then do an
install from scratch.
@


1.7
log
@nix --unlink
@
text
@d1 3
a3 5
It is possible to easily upgrade your existing OpenBSD/hp300 system
using the upgrade program in the miniroot.  If you wish to upgrade
your system by this method, simply select the `upgrade' option once
the miniroot has booted.  The upgrade program with then guide you
through the procedure.  The upgrade program will:
d5 2
a6 84
	* Enable the network based on your system's current
	  network configuration.

	* Mount your existing filesystems.

	* Extract binary sets from the media of your choice.

	* Fixup your system's existing /etc/fstab, changing the
	  occurrences of `ufs' to `ffs' and let you edit the
	  resulting file.

	* Make new device nodes in your root filesystem.

	* Copy a new kernel onto your root partition.
	  NOTE: the existing kernel WILL NOT be backed up; doing
	  so would be pointless, since a OpenBSD 1.0 kernel will
	  not run OpenBSD 2.0 executables.

	* Install a new boot block.

	* Check your filesystems for integrity.

While using the miniroot's upgrade program is the preferred method
of upgrading your system, it is possible to upgrade your system
manually.  To do this, follow the following procedure:

	* Place _at least_ the `base' binary set in a filesystem
	  accessible to the target machine.  A local filesystem
	  is preferred, since there may be incompatibilities
	  between the OpenBSD 2.0 kernel and older route(8)
	  binaries.

	* Back up your pre-existing kernel and copy the 2.0
	  kernel into your root partition.

	* Reboot with the 2.0 kernel into single-user mode.

	* Check all filesystems:

		/sbin/fsck -p

	* Mount all local filesystems:

		/sbin/mount -a -t nonfs

	* If you keep /usr or /usr/share on an NFS server, you
	  will want to mount those filesystems as well.  To do
	  this, you will need to enable the network:

		sh /etc/netstart

	  NOTE: the route(8) commands may fail due to potential
	  incompatibilities between route(8) and the OpenBSD 2.0
	  kernel.  Once you have enabled the network, mount the
	  NFS filesystems.  If you use amd(8), you may or may not
	  have to mount these filesystems manually.  Your mileage
	  may vary.

	* Make sure you are in the root filesystem and extract
	  the `base' binary set:

		cd /
		tar -xzvpf /path/to/base20.tar.gz

	* Install a new boot block:

		cd /usr/mdec
		disklabel -B <root disk, e.g. sd0>

	* Sync the filesystems:

		sync

	* At this point you may extract any other binary sets
	  you may have placed on local filesystems, or you may
	  wish to extract additional sets at a later time.
	  To extract these sets, use the following commands:

		cd /
		tar -xzvpf <path to set>

NOTE: you SHOULD NOT extract the `etc' set if upgrading.  Instead, you
should extract that set into another area and carefully merge the changes
by hand.
@


1.6
log
@another update...
@
text
@a70 2
	  NOTE: the `--unlink' option is _very_ important!

@


1.5
log
@sync pass 2
@
text
@d39 1
a39 1
	* Back up your pre-existing kernel and copy the 1.1
d59 1
a59 1
	  incompatibilities between route(8) and the OpenBSD 1.1
d69 1
a69 1
		tar -xzvpf /path/to/base11.tar.gz
@


1.4
log
@Update for removal of GNU tar(1)
@
text
@d23 1
a23 1
	  not run OpenBSD 1.1 executables.
d36 1
a36 1
	  between the OpenBSD 1.1 kernel and older route(8)
d42 1
a42 1
	* Reboot with the 1.1 kernel into single-user mode.
@


1.3
log
@Did some s/NetBSD/OpenBSD/, s/netbsd/bsd/ and $OpenBSD$ additions.
However this stuff is largely related to NetBSD and must be completely
redone, if we will make real relases sometime
@
text
@d69 1
a69 1
		tar --unlink -zxvpf /path/to/base11.tar.gz
d88 1
a88 1
		tar --unlink -zxvpf <path to set>
@


1.2
log
@update from netbsd
@
text
@d1 1
a1 1
It is possible to easily upgrade your existing NetBSD/hp300 system
d22 2
a23 2
	  so would be pointless, since a NetBSD 1.0 kernel will
	  not run NetBSD 1.1 executables.
d36 1
a36 1
	  between the NetBSD 1.1 kernel and older route(8)
d59 1
a59 1
	  incompatibilities between route(8) and the NetBSD 1.1
@


1.1
log
@Initial revision
@
text
@d1 92
a92 1
There is no previous release of NetBSD/hp300 to upgrade.
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
