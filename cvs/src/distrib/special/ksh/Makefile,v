head	1.5;
access;
symbols
	OPENBSD_6_1:1.4.0.6
	OPENBSD_6_1_BASE:1.4
	OPENBSD_6_0:1.4.0.2
	OPENBSD_6_0_BASE:1.4
	OPENBSD_5_9:1.2.0.2
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.1.0.6
	OPENBSD_5_8_BASE:1.1
	OPENBSD_5_7:1.1.0.2
	OPENBSD_5_7_BASE:1.1;
locks; strict;
comment	@# @;


1.5
date	2017.08.01.14.30.07;	author deraadt;	state Exp;
branches;
next	1.4;
commitid	BIAC2bWaDnF38LwT;

1.4
date	2016.03.30.06.38.40;	author jmc;	state Exp;
branches;
next	1.3;
commitid	LN9ijdk9SEnzWAbM;

1.3
date	2016.03.04.15.11.07;	author deraadt;	state Exp;
branches;
next	1.2;
commitid	lvfr78VLuzkoupSX;

1.2
date	2015.10.10.00.10.07;	author deraadt;	state Exp;
branches;
next	1.1;
commitid	xaTgTtwXn5YGjAmi;

1.1
date	2014.12.23.17.16.02;	author deraadt;	state Exp;
branches;
next	;
commitid	T61appZAd8QZxNl5;


desc
@@


1.5
log
@Disable ksh VI-editing mode on the install media.  We need the space
savings.
@
text
@#	$OpenBSD: Makefile,v 1.4 2016/03/30 06:38:40 jmc Exp $

PROG=	ksh
SRCS=	alloc.c c_ksh.c c_sh.c c_test.c c_ulimit.c edit.c emacs.c eval.c \
	exec.c expr.c history.c io.c jobs.c lex.c mail.c main.c \
	misc.c path.c shf.c syn.c table.c trap.c tree.c tty.c var.c \
	version.c vi.c

DEFS=	-Wall -DEMACS -DSMALL
CFLAGS+=${DEFS} -I. -I${.CURDIR}/../../../bin/ksh -I${.CURDIR}/../../../lib/libc/gen
MAN=	ksh.1 sh.1

LINKS=	${BINDIR}/ksh ${BINDIR}/rksh
LINKS+=	${BINDIR}/ksh ${BINDIR}/sh

.PATH:  ${.CURDIR}/../../../bin/ksh
.include <bsd.prog.mk>
@


1.4
log
@for some time now mandoc has not required MLINKS to function
correctly - logically complete that now by removing MLINKS from base;

authors need only to ensure there is an entry in NAME for any function/
util being added. MLINKS will still work, and remain for perl to ease
upgrades;

ok nicm (curses) bcook (ssl)
ok schwarze, who provided a lot of feedback and assistance
ok tb natano jung
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.3 2016/03/04 15:11:07 deraadt Exp $
d9 1
a9 1
DEFS=	-Wall
@


1.3
log
@remove CSRG BSD-licensed mknod builtin code which was previously used to
accelerate install/upgrade time MAKEDEV runs.  That allows ramdisk ksh
to be pledged, without needing "dpath".  We'll solve the performance issues
a different way (soon).
ok otto espie natano tb tobiasu rpe
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.2 2015/10/10 00:10:07 deraadt Exp $
a14 1
MLINKS=	ksh.1 rksh.1
@


1.2
log
@ksh can run with pledge "stdio rpath wpath cpath getpw fattr proc exec tty"
if the mknod builtin is disabled.  It looks like a lot of abilities, but
hey, this is a shell.  can't open sockets or do other nasty stuff though.
(we'll leave the mknod builtin enabled on the install media for now; there
is work happening to regain the MAKEDEV performance in a different way)
discussions with otto & millert in particular
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.1 2014/12/23 17:16:02 deraadt Exp $
d5 1
a5 1
	exec.c expr.c history.c io.c jobs.c lex.c mail.c main.c mknod.c \
d9 1
a9 1
DEFS=	-Wall -DMKNOD
@


1.1
log
@/bin and /sbin are moving towards static PIE, so on many architectures
the PIC .o files are unsuitable for static "instbin".  This adds more
work at build time, but the result will be optimized for size.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.29 2013/12/02 20:41:01 millert Exp $
d9 1
a9 1
DEFS=	-Wall
@

