head	1.43;
access;
symbols
	OPENBSD_6_1:1.43.0.4
	OPENBSD_6_1_BASE:1.43
	OPENBSD_6_0:1.39.0.6
	OPENBSD_6_0_BASE:1.39
	OPENBSD_5_9:1.39.0.2
	OPENBSD_5_9_BASE:1.39
	OPENBSD_5_8:1.39.0.4
	OPENBSD_5_8_BASE:1.39
	OPENBSD_5_7:1.36.0.2
	OPENBSD_5_7_BASE:1.36
	OPENBSD_5_6:1.33.0.4
	OPENBSD_5_6_BASE:1.33
	OPENBSD_5_5:1.32.0.2
	OPENBSD_5_5_BASE:1.32
	OPENBSD_5_4:1.25.0.4
	OPENBSD_5_4_BASE:1.25
	OPENBSD_5_3:1.25.0.2
	OPENBSD_5_3_BASE:1.25
	OPENBSD_5_2:1.24.0.4
	OPENBSD_5_2_BASE:1.24
	OPENBSD_5_1_BASE:1.24
	OPENBSD_5_1:1.24.0.2
	OPENBSD_5_0:1.22.0.6
	OPENBSD_5_0_BASE:1.22
	OPENBSD_4_9:1.22.0.4
	OPENBSD_4_9_BASE:1.22
	OPENBSD_4_8:1.22.0.2
	OPENBSD_4_8_BASE:1.22
	OPENBSD_4_7:1.21.0.2
	OPENBSD_4_7_BASE:1.21
	OPENBSD_4_6:1.20.0.4
	OPENBSD_4_6_BASE:1.20
	OPENBSD_4_5:1.17.0.6
	OPENBSD_4_5_BASE:1.17
	OPENBSD_4_4:1.17.0.4
	OPENBSD_4_4_BASE:1.17
	OPENBSD_4_3:1.17.0.2
	OPENBSD_4_3_BASE:1.17
	OPENBSD_4_2:1.16.0.4
	OPENBSD_4_2_BASE:1.16
	OPENBSD_4_1:1.16.0.2
	OPENBSD_4_1_BASE:1.16
	OPENBSD_4_0:1.14.0.6
	OPENBSD_4_0_BASE:1.14
	OPENBSD_3_9:1.14.0.4
	OPENBSD_3_9_BASE:1.14
	OPENBSD_3_8:1.14.0.2
	OPENBSD_3_8_BASE:1.14
	OPENBSD_3_7:1.12.0.2
	OPENBSD_3_7_BASE:1.12
	OPENBSD_3_6:1.11.0.4
	OPENBSD_3_6_BASE:1.11
	OPENBSD_3_5:1.11.0.2
	OPENBSD_3_5_BASE:1.11
	OPENBSD_3_4:1.10.0.2
	OPENBSD_3_4_BASE:1.10
	OPENBSD_3_3:1.7.0.6
	OPENBSD_3_3_BASE:1.7
	OPENBSD_3_2:1.7.0.4
	OPENBSD_3_2_BASE:1.7
	OPENBSD_3_1:1.7.0.2
	OPENBSD_3_1_BASE:1.7
	OPENBSD_3_0:1.5.0.2
	OPENBSD_3_0_BASE:1.5
	OPENBSD_2_9:1.4.0.4
	OPENBSD_2_9_BASE:1.4
	OPENBSD_2_8:1.4.0.2
	OPENBSD_2_8_BASE:1.4
	OPENBSD_2_7:1.3.0.8
	OPENBSD_2_7_BASE:1.3
	OPENBSD_2_6:1.3.0.6
	OPENBSD_2_6_BASE:1.3
	OPENBSD_2_5:1.3.0.4
	OPENBSD_2_5_BASE:1.3
	OPENBSD_2_4:1.3.0.2
	OPENBSD_2_4_BASE:1.3
	OPENBSD_2_3:1.2.0.4
	OPENBSD_2_3_BASE:1.2
	OPENBSD_2_2:1.2.0.2
	OPENBSD_2_2_BASE:1.2;
locks; strict;
comment	@# @;


1.43
date	2016.12.30.22.26.57;	author deraadt;	state Exp;
branches;
next	1.42;
commitid	TT8Jk128AOme7nle;

1.42
date	2016.09.17.15.03.39;	author florian;	state Exp;
branches;
next	1.41;
commitid	4iDaUFNgyRvNiP2A;

1.41
date	2016.09.03.13.37.40;	author guenther;	state Exp;
branches;
next	1.40;
commitid	6T3r4QcMFKe3Fo5T;

1.40
date	2016.08.16.04.55.33;	author tedu;	state Exp;
branches;
next	1.39;
commitid	E80rvArPYqmIr8fM;

1.39
date	2015.04.13.21.27.07;	author deraadt;	state Exp;
branches;
next	1.38;
commitid	XlnjSM8QPyxXBJUX;

1.38
date	2015.04.02.16.13.25;	author deraadt;	state Exp;
branches;
next	1.37;
commitid	xCtdNbyuk86cJEuz;

1.37
date	2015.03.11.15.23.10;	author deraadt;	state Exp;
branches;
next	1.36;
commitid	kYVTQVHqneEmqJ6K;

1.36
date	2015.02.10.01.43.37;	author deraadt;	state Exp;
branches;
next	1.35;
commitid	44XGo8W4B4GNmM2u;

1.35
date	2014.12.27.20.21.09;	author deraadt;	state Exp;
branches;
next	1.34;
commitid	83DyJLOMux1TuHqa;

1.34
date	2014.12.23.17.16.00;	author deraadt;	state Exp;
branches;
next	1.33;
commitid	T61appZAd8QZxNl5;

1.33
date	2014.07.24.19.21.48;	author miod;	state Exp;
branches;
next	1.32;
commitid	VTYgUOARdhWUoS51;

1.32
date	2014.02.21.19.01.02;	author deraadt;	state Exp;
branches;
next	1.31;

1.31
date	2014.01.19.05.25.59;	author deraadt;	state Exp;
branches;
next	1.30;

1.30
date	2014.01.11.05.37.16;	author deraadt;	state Exp;
branches;
next	1.29;

1.29
date	2014.01.09.15.02.50;	author deraadt;	state Exp;
branches;
next	1.28;

1.28
date	2014.01.08.21.53.35;	author deraadt;	state Exp;
branches;
next	1.27;

1.27
date	2014.01.08.14.20.52;	author deraadt;	state Exp;
branches;
next	1.26;

1.26
date	2014.01.06.22.28.45;	author deraadt;	state Exp;
branches;
next	1.25;

1.25
date	2012.08.21.08.12.47;	author pascal;	state Exp;
branches;
next	1.24;

1.24
date	2011.10.06.15.29.45;	author deraadt;	state Exp;
branches;
next	1.23;

1.23
date	2011.09.17.14.05.27;	author haesbaert;	state Exp;
branches;
next	1.22;

1.22
date	2010.03.31.17.51.24;	author deraadt;	state Exp;
branches;
next	1.21;

1.21
date	2009.10.28.05.17.55;	author deraadt;	state Exp;
branches;
next	1.20;

1.20
date	2009.04.19.03.33.19;	author deraadt;	state Exp;
branches;
next	1.19;

1.19
date	2009.04.19.00.59.39;	author deraadt;	state Exp;
branches;
next	1.18;

1.18
date	2009.04.17.03.48.33;	author deraadt;	state Exp;
branches;
next	1.17;

1.17
date	2007.11.26.15.36.38;	author deraadt;	state Exp;
branches;
next	1.16;

1.16
date	2007.02.14.23.38.21;	author deraadt;	state Exp;
branches;
next	1.15;

1.15
date	2006.11.10.19.37.19;	author deraadt;	state Exp;
branches;
next	1.14;

1.14
date	2005.08.04.16.35.03;	author espie;	state Exp;
branches;
next	1.13;

1.13
date	2005.08.02.11.16.44;	author espie;	state Exp;
branches;
next	1.12;

1.12
date	2004.12.25.11.22.18;	author deraadt;	state Exp;
branches;
next	1.11;

1.11
date	2004.01.03.00.19.30;	author deraadt;	state Exp;
branches;
next	1.10;

1.10
date	2003.06.22.22.25.21;	author deraadt;	state Exp;
branches;
next	1.9;

1.9
date	2003.04.25.20.54.44;	author deraadt;	state Exp;
branches;
next	1.8;

1.8
date	2003.04.16.19.25.17;	author drahn;	state Exp;
branches;
next	1.7;

1.7
date	2002.04.12.02.15.30;	author deraadt;	state Exp;
branches;
next	1.6;

1.6
date	2002.02.08.20.12.37;	author deraadt;	state Exp;
branches;
next	1.5;

1.5
date	2001.06.22.23.24.25;	author deraadt;	state Exp;
branches;
next	1.4;

1.4
date	2000.08.06.00.22.03;	author millert;	state Exp;
branches;
next	1.3;

1.3
date	98.09.15.21.43.05;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	97.09.21.11.46.04;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	97.09.17.14.19.47;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.43
log
@enter ftp-ssl also
@
text
@#	$OpenBSD: Makefile,v 1.42 2016/09/17 15:03:39 florian Exp $

SUBDIR=	libstubs \
	arch bioctl cat chmod chroot cp date dd df dhclient disklabel dmesg \
	doas ed eeprom encrypt fdisk fsck fsck_ext2fs fsck_ffs fsck_msdos ftp \
	ftp-ssl grep gzip hostname ifconfig init installboot kbd ksh ln ls md5 \
	mkdir mknod mkuboot more mount mount_cd9660 mount_ext2fs \
	mount_ffs mount_msdos mount_nfs mount_udf mt mv newfs newfs_ext2fs \
	newfs_msdos pax pdisk ping pwd_mkdb reboot restore rm route sed \
	signify sleep stty sync sysctl umount

install:

.include <bsd.subdir.mk>


@


1.42
log
@ping6(8) is now a hardlink to ping(8).
The instbin stuff looks good to deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.41 2016/09/03 13:37:40 guenther Exp $
d6 1
a6 1
	grep gzip hostname ifconfig init installboot kbd ksh ln ls md5 \
@


1.41
log
@Retire zaurus, as it hasn't made the EABI jump and will be permanently broken
shortly when we use the hardware thread register in userland
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.40 2016/08/16 04:55:33 tedu Exp $
d9 1
a9 1
	newfs_msdos pax pdisk ping ping6 pwd_mkdb reboot restore rm route sed \
@


1.40
log
@add a special edition doas that only lets root drop privs.
maybe the installer can use something like this, wink wink.
ok deraadt
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.39 2015/04/13 21:27:07 deraadt Exp $
d10 1
a10 1
	signify sleep stty sync sysctl umount ztsscale
@


1.39
log
@pwd_mkdb now fits onto the install media.  no more chroot games.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.38 2015/04/02 16:13:25 deraadt Exp $
d5 1
a5 1
	ed eeprom encrypt fdisk fsck fsck_ext2fs fsck_ffs fsck_msdos ftp \
@


1.38
log
@more -> less; not less -> more
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.37 2015/03/11 15:23:10 deraadt Exp $
d9 1
a9 1
	newfs_msdos pax pdisk ping ping6 reboot restore rm route sed \
@


1.37
log
@expr no longer needed on media, because the scripts always use ksh builtins.
halex, rpe, and todd cleared the way for this.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.36 2015/02/10 01:43:37 deraadt Exp $
d6 1
a6 1
	grep gzip hostname ifconfig init installboot kbd ksh less ln ls md5 \
@


1.36
log
@enter chroot
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.35 2014/12/27 20:21:09 deraadt Exp $
d5 1
a5 1
	ed eeprom expr encrypt fdisk fsck fsck_ext2fs fsck_ffs fsck_msdos ftp \
@


1.35
log
@encrypt should easily fit onto the media now.  this will be done step by step.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.34 2014/12/23 17:16:00 deraadt Exp $
d4 3
a6 3
	arch bioctl cat chmod cp date dd df dhclient disklabel dmesg ed \
	eeprom expr encrypt fdisk fsck fsck_ext2fs fsck_ffs fsck_msdos ftp grep \
	gzip hostname ifconfig init installboot kbd ksh less ln ls md5 \
@


1.34
log
@/bin and /sbin are moving towards static PIE, so on many architectures
the PIC .o files are unsuitable for static "instbin".  This adds more
work at build time, but the result will be optimized for size.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.33 2014/07/24 19:21:48 miod Exp $
d5 1
a5 1
	eeprom expr fdisk fsck fsck_ext2fs fsck_ffs fsck_msdos ftp grep \
@


1.33
log
@+ eeprom
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.32 2014/02/21 19:01:02 deraadt Exp $
d4 7
a10 3
	arch date dd dhclient dmesg ed eeprom ftp grep gzip ifconfig init \
	installboot kbd less md5 more mt newfs pax ping restore \
	sed sysctl signify ztsscale umount
d15 2
@


1.32
log
@build a non-portmap/mountd speaking umount, which shrinks the libc
requirements on non-NFS install media
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.31 2014/01/19 05:25:59 deraadt Exp $
d4 1
a4 1
	arch date dd dhclient dmesg ed ftp grep gzip ifconfig init \
@


1.31
log
@enter installboot
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.30 2014/01/11 05:37:16 deraadt Exp $
d6 1
a6 1
	sed sysctl signify ztsscale
@


1.30
log
@Butcher a smaller tar/pax here, which has no cpio support
ok guenther
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.29 2014/01/09 15:02:50 deraadt Exp $
d5 2
a6 2
	kbd less md5 more mt newfs pax ping restore sed sysctl signify \
	ztsscale
@


1.29
log
@we need to build a ztscale stub for zaurus media.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.28 2014/01/08 21:53:35 deraadt Exp $
d5 1
a5 1
	kbd less md5 more mt newfs ping restore sed sysctl signify \
@


1.28
log
@Switch to using the base sha256 command, rather than some customized
abomination.
install.sub chunk tested by rpe
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.27 2014/01/08 14:20:52 deraadt Exp $
d5 2
a6 1
	kbd less md5 more mt newfs ping restore sed sysctl signify
@


1.27
log
@enter md5 directory
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.26 2014/01/06 22:28:45 deraadt Exp $
d5 1
a5 1
	kbd less md5 more mt newfs ping restore sed sha256 sysctl
@


1.26
log
@In the new PIE world, all dynamic binaries (for instance those found
in usr.bin and usr.sbin on the install media) must be re-compiled non-PIE
(here, in the special directory) so that crunchgen can reuse them.  This
issue is most acute on i386, which has register pressure, and does weird
things for PIE.
thanks for matthew for helping figure this out.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.25 2012/08/21 08:12:47 pascal Exp $
d5 1
a5 1
	kbd less more mt newfs ping restore sed sha256 sysctl 
@


1.25
log
@Build sed in distrib/ just like everything else.  Simplifies PIE work since
we can now use NOPIE= for it.  Note that NOPIE= is still a no-op atm.

ok deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.24 2011/10/06 15:29:45 deraadt Exp $
d4 1
a4 1
	date dd dhclient dmesg ed ftp grep gzip ifconfig init \
@


1.24
log
@Get rid of special binaries which are no longer necesssary.
Note: more stays, though we currently use less on the media -- that is
because if less grows too fat in the future, we would be able to switch
to more.
Discussed with nicm.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.23 2011/09/17 14:05:27 haesbaert Exp $
d5 1
a5 1
	kbd less more mt newfs ping restore sha256 sysctl 
@


1.23
log
@Add SMALL infrastructure to ping.

ok mcbride@@ sthen@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.22 2010/03/31 17:51:24 deraadt Exp $
d4 2
a5 2
	ccdconfig date dd dhclient dmesg ed ftp grep gzip ifconfig init \
	kbd less more mt newfs ping pppd restore rsh sha256 sysctl 
@


1.22
log
@Make a -DSMALL version of date(1) for the media
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.21 2009/10/28 05:17:55 deraadt Exp $
d5 1
a5 1
	kbd less more mt newfs pppd restore rsh sha256 sysctl
@


1.21
log
@use the special versions of ed(1), mt(1), and restore(8) which are a lot
smaller
ok guenther
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.20 2009/04/19 03:33:19 deraadt Exp $
d4 1
a4 1
	ccdconfig dd dhclient dmesg ed ftp grep gzip ifconfig init \
@


1.20
log
@sort list
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.19 2009/04/19 00:59:39 deraadt Exp $
d4 2
a5 2
	ccdconfig dd dhclient dmesg ftp grep gzip ifconfig init \
	kbd less more newfs pppd rsh sha256 sysctl
@


1.19
log
@Use sysctl -n hw.disknames instead of the custom disknames program
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.18 2009/04/17 03:48:33 deraadt Exp $
d3 3
a5 2
SUBDIR=	dd ftp pppd rsh dhclient init sysctl dmesg grep kbd \
	newfs less more gzip ccdconfig ifconfig sha256 libstubs
@


1.18
log
@A very small sha256 program for the base media.  Use it by piping data
through it... input | sha256 outfile | output, then check the contents
of outfile after.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.17 2007/11/26 15:36:38 deraadt Exp $
d3 1
a3 1
SUBDIR=	dd ftp pppd rsh dhclient init disknames dmesg grep kbd \
@


1.17
log
@build our own newfs binary for the media -- without MFS support -- to
save space.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.16 2007/02/14 23:38:21 deraadt Exp $
d3 2
a4 2
SUBDIR=	dd ftp pppd rsh dhclient init disknames dmesg grep kbd newfs less \
	more gzip ccdconfig ifconfig libstubs
@


1.16
log
@put the disknames command on all install media (hope i did not miss any) ok krw@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.15 2006/11/10 19:37:19 deraadt Exp $
d3 1
a3 1
SUBDIR=	dd ftp pppd rsh dhclient init disknames dmesg grep kbd less \
@


1.15
log
@fake no-op install target
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.14 2005/08/04 16:35:03 espie Exp $
d3 2
a4 2
SUBDIR=	dd ftp pppd rsh dhclient init dmesg grep kbd less more \
	gzip ccdconfig ifconfig libstubs
@


1.14
log
@activate libstubs (setlocale + dbopen)

okay deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.13 2005/08/02 11:16:44 espie Exp $
d5 2
@


1.13
log
@replace dd with NO_CONV version.
okay deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.12 2004/12/25 11:22:18 deraadt Exp $
d4 1
a4 1
	gzip ccdconfig ifconfig
@


1.12
log
@enter ifconfig
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.11 2004/01/03 00:19:30 deraadt Exp $
d3 1
a3 1
SUBDIR=	ftp pppd rsh dhclient init dmesg grep kbd less more \
@


1.11
log
@Todd forgot to make obj there
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.10 2003/06/22 22:25:21 deraadt Exp $
d3 2
a4 1
SUBDIR=	ftp pppd rsh dhclient init dmesg grep kbd less more gzip ccdconfig
@


1.10
log
@special/gzip is smart enough to grovel in usr.bin/compress for what it
needs.  This is better than putting a compress link on each media; saves
us a few bytes
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.9 2003/04/25 20:54:44 deraadt Exp $
d3 1
a3 1
SUBDIR=	ftp pppd rsh dhclient init dmesg grep kbd less more gzip
@


1.9
log
@enter more
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.8 2003/04/16 19:25:17 drahn Exp $
d3 1
a3 1
SUBDIR=	ftp pppd rsh dhclient init dmesg grep kbd less more
@


1.8
log
@Add less to list so clean/obj work correctly.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.7 2002/04/12 02:15:30 deraadt Exp $
d3 1
a3 1
SUBDIR=	ftp pppd rsh dhclient init dmesg grep kbd less
@


1.7
log
@kbd setting code for the installer.  smat@@acm.org, miod, and krw.  Minimal
last minute tweaks to it by me, but you can trust me, right?
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.6 2002/02/08 20:12:37 deraadt Exp $
d3 1
a3 1
SUBDIR=	ftp pppd rsh dhclient init dmesg grep kbd
@


1.6
log
@new grep, smaller, makes for better floppies, i hope?
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.5 2001/06/22 23:24:25 deraadt Exp $
d3 1
a3 1
SUBDIR=	ftp pppd rsh dhclient init dmesg grep
@


1.5
log
@smaller dmesg
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.4 2000/08/06 00:22:03 millert Exp $
d3 1
a3 1
SUBDIR=	ftp pppd rsh dhclient init dmesg
@


1.4
log
@Add special init
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.3 1998/09/15 21:43:05 deraadt Exp $
d3 1
a3 1
SUBDIR=	ftp pppd rsh dhclient init
@


1.3
log
@dhclient for the install floppy
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.2 1997/09/21 11:46:04 deraadt Exp $
d3 1
a3 1
SUBDIR=	ftp pppd rsh dhclient
@


1.2
log
@$OpenBSD$
@
text
@d1 1
a1 1
#	$OpenBSD$
d3 1
a3 1
SUBDIR=	ftp pppd rsh
@


1.1
log
@generalize Todd's work for ftp/pppd/rsh to ramdisks and miniroots on all
architectures.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.1 1997/09/07 19:59:04 millert Exp $
@
