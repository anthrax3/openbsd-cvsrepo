head	1.13;
access;
symbols
	OPENBSD_6_1:1.12.0.12
	OPENBSD_6_1_BASE:1.12
	OPENBSD_6_0:1.12.0.8
	OPENBSD_6_0_BASE:1.12
	OPENBSD_5_9:1.12.0.4
	OPENBSD_5_9_BASE:1.12
	OPENBSD_5_8:1.12.0.6
	OPENBSD_5_8_BASE:1.12
	OPENBSD_5_7:1.12.0.2
	OPENBSD_5_7_BASE:1.12
	OPENBSD_5_6:1.11.0.24
	OPENBSD_5_6_BASE:1.11
	OPENBSD_5_5:1.11.0.20
	OPENBSD_5_5_BASE:1.11
	OPENBSD_5_4:1.11.0.18
	OPENBSD_5_4_BASE:1.11
	OPENBSD_5_3:1.11.0.16
	OPENBSD_5_3_BASE:1.11
	OPENBSD_5_2:1.11.0.14
	OPENBSD_5_2_BASE:1.11
	OPENBSD_5_1_BASE:1.11
	OPENBSD_5_1:1.11.0.12
	OPENBSD_5_0:1.11.0.10
	OPENBSD_5_0_BASE:1.11
	OPENBSD_4_9:1.11.0.8
	OPENBSD_4_9_BASE:1.11
	OPENBSD_4_8:1.11.0.6
	OPENBSD_4_8_BASE:1.11
	OPENBSD_4_7:1.11.0.2
	OPENBSD_4_7_BASE:1.11
	OPENBSD_4_6:1.11.0.4
	OPENBSD_4_6_BASE:1.11
	OPENBSD_4_5:1.10.0.22
	OPENBSD_4_5_BASE:1.10
	OPENBSD_4_4:1.10.0.20
	OPENBSD_4_4_BASE:1.10
	OPENBSD_4_3:1.10.0.18
	OPENBSD_4_3_BASE:1.10
	OPENBSD_4_2:1.10.0.16
	OPENBSD_4_2_BASE:1.10
	OPENBSD_4_1:1.10.0.14
	OPENBSD_4_1_BASE:1.10
	OPENBSD_4_0:1.10.0.12
	OPENBSD_4_0_BASE:1.10
	OPENBSD_3_9:1.10.0.10
	OPENBSD_3_9_BASE:1.10
	OPENBSD_3_8:1.10.0.8
	OPENBSD_3_8_BASE:1.10
	OPENBSD_3_7:1.10.0.6
	OPENBSD_3_7_BASE:1.10
	OPENBSD_3_6:1.10.0.4
	OPENBSD_3_6_BASE:1.10
	OPENBSD_3_5:1.10.0.2
	OPENBSD_3_5_BASE:1.10
	OPENBSD_3_4:1.8.0.2
	OPENBSD_3_4_BASE:1.8
	OPENBSD_3_3:1.4.0.6
	OPENBSD_3_3_BASE:1.4
	OPENBSD_3_2:1.4.0.4
	OPENBSD_3_2_BASE:1.4
	OPENBSD_3_1:1.4.0.2
	OPENBSD_3_1_BASE:1.4
	OPENBSD_3_0:1.3.0.8
	OPENBSD_3_0_BASE:1.3
	OPENBSD_2_9:1.3.0.6
	OPENBSD_2_9_BASE:1.3
	OPENBSD_2_8:1.3.0.4
	OPENBSD_2_8_BASE:1.3
	OPENBSD_2_7:1.3.0.2
	OPENBSD_2_7_BASE:1.3
	OPENBSD_2_6:1.2.0.14
	OPENBSD_2_6_BASE:1.2
	OPENBSD_2_5:1.2.0.12
	OPENBSD_2_5_BASE:1.2
	OPENBSD_2_4:1.2.0.10
	OPENBSD_2_4_BASE:1.2
	OPENBSD_2_3:1.2.0.8
	OPENBSD_2_3_BASE:1.2
	OPENBSD_2_2:1.2.0.6
	OPENBSD_2_2_BASE:1.2
	OPENBSD_2_1:1.2.0.4
	OPENBSD_2_1_BASE:1.2
	OPENBSD_2_0:1.2.0.2
	OPENBSD_2_0_BASE:1.2
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@# @;


1.13
date	2017.04.17.19.44.59;	author deraadt;	state Exp;
branches;
next	1.12;
commitid	joReXAt0JS3LJumP;

1.12
date	2014.08.26.20.19.26;	author rpe;	state Exp;
branches;
next	1.11;
commitid	2uCZGoLImpFRV5IL;

1.11
date	2009.04.17.03.58.54;	author deraadt;	state Exp;
branches;
next	1.10;

1.10
date	2003.12.11.00.13.27;	author deraadt;	state Exp;
branches;
next	1.9;

1.9
date	2003.12.06.19.58.18;	author deraadt;	state Exp;
branches;
next	1.8;

1.8
date	2003.07.02.02.08.02;	author avsm;	state Exp;
branches;
next	1.7;

1.7
date	2003.06.02.04.04.32;	author deraadt;	state Exp;
branches;
next	1.6;

1.6
date	2003.03.28.22.19.52;	author mickey;	state Exp;
branches;
next	1.5;

1.5
date	2003.03.28.01.14.56;	author deraadt;	state Exp;
branches;
next	1.4;

1.4
date	2001.12.25.01.30.22;	author deraadt;	state Exp;
branches;
next	1.3;

1.3
date	2000.03.01.22.10.08;	author todd;	state Exp;
branches;
next	1.2;

1.2
date	96.09.26.09.07.40;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.37.44;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.37.44;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.13
log
@create a gross mechanism that can handle gcc-only, clang-only,
and gcc+clang architectures
with kettenis
@
text
@#!/bin/sh
#	$OpenBSD: checkflist,v 1.12 2014/08/26 20:19:26 rpe Exp $
#
# Copyright (c) 2001 Theo de Raadt
# All rights reserved.
#
# Redistribution and use in source and binary forms, with or without
# modification, are permitted provided that the following conditions
# are met:
# 1. Redistributions of source code must retain the above copyright
#    notice, this list of conditions and the following disclaimer.
# 2. Redistributions in binary form must reproduce the above copyright
#    notice, this list of conditions and the following disclaimer in the
#    documentation and/or other materials provided with the distribution.
#
# THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
# IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
# OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
# IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
# INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
# NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
# DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
# THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
# (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
# THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

if [ "X${DESTDIR}" = "X" ]; then
	echo DESTDIR must be set
	exit 1
fi

TMP1=`mktemp /tmp/_ckr.XXXXXXXXXX` || exit 1

trap '[ -f "$TMP1" ] && rm -f $TMP1' EXIT
trap 'exit' HUP TERM

arch=`machine`

for i in base comp etc game man; do
	cat ./lists/$i/mi ./lists/$i/md.${arch}
	if [ $i = comp ]; then
		[ -f ./lists/comp/gcc.${arch} ] && \
		    cat ./lists/comp/gcc.${arch}
		[ -f ./lists/comp/clang.${arch} ] && \
		    cat ./lists/comp/clang.${arch}
	fi
done | sort >$TMP1

( cd $DESTDIR ; find . \( -type d -o -type f -o -type l \) ) | \
    fgrep -vx '.' | sort -H | diff $TMP1 -
@


1.12
log
@Create etc set during 'make build' and embed it in base set to make
it available during a regular install or upgrade so that it doesn't
need to be independently fetched.

Idea, directions and OK deraadt@@
Feedback and Ok halex@@ and aja@@
@
text
@d2 1
a2 1
#	$OpenBSD: checkflist,v 1.11 2009/04/17 03:58:54 deraadt Exp $
d41 6
@


1.11
log
@For SHA256 hashes to be ready to go onto the install media, we must
build the sets before we build the media.  While there we can get rid
of DESTDIR/snapshot too, and simply install straight into RELEASEDIR.
(This also ends up saving an astounding amount of traffic/latency in a nfs
environment)
@
text
@d1 2
a2 2
#!/bin/sh -x
#	$OpenBSD: checkflist,v 1.10 2003/12/11 00:13:27 deraadt Exp $
d32 10
a41 2
TMP=`mktemp /tmp/_ckr.XXXXXXXXXX` || exit 1
trap 'rm -f $TMP' 0 1 15
a42 1
sh makeflist > $TMP
d44 1
a44 1
    grep -v -e '^.$' | sort -H | diff $TMP - 
@


1.10
log
@do not whine about .
@
text
@d2 1
a2 1
#	$OpenBSD: checkflist,v 1.9 2003/12/06 19:58:18 deraadt Exp $
d37 1
a37 1
    grep -v -e '^\./snapshot' -e '^.$' | sort -H | diff $TMP - 
@


1.9
log
@ignore snapshot directory
@
text
@d2 1
a2 1
#	$OpenBSD: checkflist,v 1.8 2003/07/02 02:08:02 avsm Exp $
d37 1
a37 1
    grep -v '^\./snapshot' | sort -H | diff $TMP - 
@


1.8
log
@bump mktemp randomness from 6 to 10 X's; deraadt@@ ok
@
text
@d2 1
a2 1
#	$OpenBSD: checkflist,v 1.7 2003/06/02 04:04:32 deraadt Exp $
d36 2
a37 2
( cd $DESTDIR ; find . \( -type d -o -type f -o -type l \) ) | sort -H | \
    diff $TMP -
@


1.7
log
@typos
@
text
@d2 1
a2 1
#	$OpenBSD: checkflist,v 1.6 2003/03/28 22:19:52 mickey Exp $
d32 1
a32 1
TMP=`mktemp /tmp/_ckr.XXXXXX` || exit 1
@


1.6
log
@use sort -H; millert@@ deradt@@ ok
@
text
@d2 1
a2 1
#	$OpenBSD: checkflist,v 1.5 2003/03/28 01:14:56 deraadt Exp $
a14 1
#    derived from this software without specific prior written permission.
@


1.5
log
@I rewrote these a while back; copyright to me
@
text
@d2 1
a2 1
#	$OpenBSD: checkflist,v 1.5 2003/03/28 00:42:45 deraadt Exp $
d37 1
a37 1
( cd $DESTDIR ; find . \( -type d -o -type f -o -type l \) ) | sort | \
@


1.4
log
@convert mkr/ckr to shell scripts, use mktemp(1)
@
text
@d2 25
a26 1
#	$OpenBSD: checkflist,v 1.3 2000/03/01 22:10:08 todd Exp $
@


1.3
log
@$OpenBSD$
@
text
@d1 2
a2 2
#!/bin/csh -f
#	$OpenBSD$
d4 1
a4 2

if (! $?DESTDIR) then
d7 1
a7 1
endif
d9 2
a10 1
set fsdir=$DESTDIR
d12 3
a14 4
csh makeflist >! /tmp/_CHECK.$$
( cd $fsdir ; find . \( -type d -o -type f -o -type l \) ) | sort | \
    diff /tmp/_CHECK.$$ -
/bin/rm -f /tmp/_CHECK.$$
@


1.2
log
@first cut at syncing the sets
@
text
@d2 2
@


1.1
log
@Initial revision
@
text
@d10 1
a10 1
./makeflist >! /tmp/_CHECK.$$
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
