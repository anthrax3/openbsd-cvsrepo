head	1.9;
access;
symbols
	OPENBSD_6_0:1.9.0.30
	OPENBSD_6_0_BASE:1.9
	OPENBSD_5_9:1.9.0.26
	OPENBSD_5_9_BASE:1.9
	OPENBSD_5_8:1.9.0.28
	OPENBSD_5_8_BASE:1.9
	OPENBSD_5_7:1.9.0.22
	OPENBSD_5_7_BASE:1.9
	OPENBSD_5_6:1.9.0.24
	OPENBSD_5_6_BASE:1.9
	OPENBSD_5_5:1.9.0.20
	OPENBSD_5_5_BASE:1.9
	OPENBSD_5_4:1.9.0.18
	OPENBSD_5_4_BASE:1.9
	OPENBSD_5_3:1.9.0.16
	OPENBSD_5_3_BASE:1.9
	OPENBSD_5_2:1.9.0.14
	OPENBSD_5_2_BASE:1.9
	OPENBSD_5_1_BASE:1.9
	OPENBSD_5_1:1.9.0.12
	OPENBSD_5_0:1.9.0.10
	OPENBSD_5_0_BASE:1.9
	OPENBSD_4_9:1.9.0.8
	OPENBSD_4_9_BASE:1.9
	OPENBSD_4_8:1.9.0.6
	OPENBSD_4_8_BASE:1.9
	OPENBSD_4_7:1.9.0.2
	OPENBSD_4_7_BASE:1.9
	OPENBSD_4_6:1.9.0.4
	OPENBSD_4_6_BASE:1.9
	OPENBSD_4_5:1.7.0.18
	OPENBSD_4_5_BASE:1.7
	OPENBSD_4_4:1.7.0.16
	OPENBSD_4_4_BASE:1.7
	OPENBSD_4_3:1.7.0.14
	OPENBSD_4_3_BASE:1.7
	OPENBSD_4_2:1.7.0.12
	OPENBSD_4_2_BASE:1.7
	OPENBSD_4_1:1.7.0.10
	OPENBSD_4_1_BASE:1.7
	OPENBSD_4_0:1.7.0.8
	OPENBSD_4_0_BASE:1.7
	OPENBSD_3_9:1.7.0.6
	OPENBSD_3_9_BASE:1.7
	OPENBSD_3_8:1.7.0.4
	OPENBSD_3_8_BASE:1.7
	OPENBSD_3_7:1.7.0.2
	OPENBSD_3_7_BASE:1.7
	OPENBSD_3_6:1.6.0.2
	OPENBSD_3_6_BASE:1.6
	OPENBSD_3_5:1.4.0.2
	OPENBSD_3_5_BASE:1.4
	OPENBSD_3_4:1.3.0.4
	OPENBSD_3_4_BASE:1.3
	OPENBSD_3_3:1.3.0.2
	OPENBSD_3_3_BASE:1.3;
locks; strict;
comment	@# @;


1.9
date	2009.04.17.15.59.48;	author deraadt;	state Exp;
branches;
next	1.8;

1.8
date	2009.04.17.03.58.54;	author deraadt;	state Exp;
branches;
next	1.7;

1.7
date	2005.03.11.15.40.58;	author deraadt;	state Exp;
branches;
next	1.6;

1.6
date	2004.08.24.20.37.15;	author deraadt;	state Exp;
branches;
next	1.5;

1.5
date	2004.08.11.06.51.13;	author deraadt;	state Exp;
branches;
next	1.4;

1.4
date	2004.03.11.22.16.50;	author deraadt;	state Exp;
branches;
next	1.3;

1.3
date	2003.03.04.20.24.49;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	2003.03.04.18.07.46;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	2003.03.04.09.28.19;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.9
log
@further minor unification
@
text
@#	$OpenBSD: Makefile,v 1.8 2009/04/17 03:58:54 deraadt Exp $

TOP=	${.CURDIR}/..

.include "${TOP}/Makefile.inc"

BSDRD=	bsd.rd
CDROM=	cd${REV}.iso

all: ${CDROM}

${CDROM}:
	-rm -rf ${.OBJDIR}/cd-dir
	mkdir -p ${.OBJDIR}/cd-dir/${OSREV}/i386
	mkdir -p ${.OBJDIR}/cd-dir/etc
	echo "set image /${OSREV}/i386/bsd.rd" > ${.OBJDIR}/cd-dir/etc/boot.conf
	cp ${.OBJDIR}/../ramdisk_cd/${BSDRD} ${.OBJDIR}/cd-dir/${OSREV}/i386
	cp ${DESTDIR}/usr/mdec/cdbr ${.OBJDIR}/cd-dir/${OSREV}/i386
	cp ${DESTDIR}/usr/mdec/cdboot ${.OBJDIR}/cd-dir/${OSREV}/i386/cdboot
	mkhybrid -a -R -T -L -l -d -D -N -o ${.OBJDIR}/${CDROM} -v -v \
	    -A "OpenBSD ${OSREV} i386 bootonly CD" \
	    -P "Copyright (c) `date +%Y` Theo de Raadt, The OpenBSD project" \
	    -p "Theo de Raadt <deraadt@@openbsd.org>" \
	    -V "OpenBSD/i386    ${OSREV} boot-only CD" \
	    -b ${OSREV}/i386/cdbr -c ${OSREV}/i386/boot.catalog \
	    ${.OBJDIR}/cd-dir

.ifdef RELEASEDIR
install:
	cp ${CDROM} ${RELEASEDIR}
.endif	# RELEASEDIR

clean cleandir:
	/bin/rm -f ${CDROM}
	rm -rf cd-dir

.include <bsd.obj.mk>
.include <bsd.subdir.mk>
@


1.8
log
@For SHA256 hashes to be ready to go onto the install media, we must
build the sets before we build the media.  While there we can get rid
of DESTDIR/snapshot too, and simply install straight into RELEASEDIR.
(This also ends up saving an astounding amount of traffic/latency in a nfs
environment)
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.7 2005/03/11 15:40:58 deraadt Exp $
d31 1
a31 1
.endif	# RELEASEDIR check
@


1.7
log
@never worry about the copyright date on the CD layout again, problem
noticed by drahn
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.6 2004/08/24 20:37:15 deraadt Exp $
d28 1
d30 2
a31 1
	cp ${CDROM} ${DESTDIR}/snapshot
@


1.6
log
@move cdboot to ${OSREV}/${ARCH/
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.5 2004/08/11 06:51:13 deraadt Exp $
d22 1
a22 1
	    -P "Copyright (c) 2004 Theo de Raadt, The OpenBSD project" \
@


1.5
log
@Use a no-emulation boot sector instead of a floppy emulation image.  Work at
the hackathon by Tom and Toby, finally making it to the real world.   Now
we can tweak sizes of the media all we want, if we need to.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.4 2004/03/11 22:16:50 deraadt Exp $
d19 1
a19 1
	cp ${DESTDIR}/usr/mdec/cdboot ${.OBJDIR}/cd-dir/cdboot
@


1.4
log
@change copyrights on iso images, spotted by miod
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.3 2003/03/04 20:24:49 deraadt Exp $
d7 1
a7 1
CDFS=	cdrom${REV}.fs
d15 6
a20 2
	cp ${.OBJDIR}/../ramdisk_cd/${CDFS} ${.OBJDIR}/cd-dir/${OSREV}/i386
	mkhybrid -a -R -T -L -d -D -N -o ${.OBJDIR}/${CDROM} -v -v \
d25 1
a25 1
	    -b ${OSREV}/i386/${CDFS} -c ${OSREV}/i386/boot.catalog \
@


1.3
log
@better mkhybrid -V message
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.2 2003/03/04 18:07:46 deraadt Exp $
d18 1
a18 1
	    -P "Copyright (c) 2003 Theo de Raadt, The OpenBSD project" \
@


1.2
log
@remove extra -V
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.1 2003/03/04 09:28:19 deraadt Exp $
d20 1
a20 1
	    -V "OpenBSD${OSREV} CD boot-only CD " \
@


1.1
log
@Provide a ~2MB ISO file which contains *JUST* $REV/i386/cdrom{Rev}.fs,
which can then be burnt onto a CD, and then you can do an ftp install
from that.  This will suffice for people without floppies in upcoming
machines.  No, I am not going to put the sets on that CD.  We've been
over this before.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.5 2003/03/02 03:27:24 brad Exp $
d20 1
a20 2
	    -V "OpenBSD${OSREV} CD boot-only CD      " \
            -V "OpenBSD3.3 CD 1 www.OpenBSD.org " \
@

