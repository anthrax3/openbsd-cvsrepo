head	1.3;
access;
symbols
	OPENBSD_6_2:1.3.0.6
	OPENBSD_6_2_BASE:1.3
	OPENBSD_6_1:1.3.0.4
	OPENBSD_6_1_BASE:1.3
	OPENBSD_6_0:1.1.0.2
	OPENBSD_6_0_BASE:1.1;
locks; strict;
comment	@:: @;


1.3
date	2017.01.24.05.29.22;	author jsg;	state Exp;
branches;
next	1.2;
commitid	IPWbxkNqTxjjTKEA;

1.2
date	2017.01.19.06.55.58;	author jsg;	state Exp;
branches;
next	1.1;
commitid	cgY8YNkks4bPtjuz;

1.1
date	2016.05.22.02.41.45;	author jsg;	state Exp;
branches;
next	;
commitid	06QUiqGKiGxwMYin;


desc
@@


1.3
log
@There are two u-boot targets which should work with the sabre lite
boards.  mx6qsabrelite (which sets fdt_addr) and nitrogen6q
(which sets fdtaddr).  The difference seems to be the mx6qsabrelite
target uses a small loader in SPI connected flash which will load
the rest of u-boot from an SD card.  The nitrogen6q target normally
loads all of u-boot from an image in flash and then searches for a
6x_bootscript file with u-boot commands on MMC and SATA.

While neither of them supports "Generic Distro Configuration" which
would automatically search for an EFI image, if they did fdt_addr
is intended to be used for a DTB in ROM, while fdt_addr_r is intended
to be used for a DTB in RAM.

Change the 6x_bootscript u-boot commands to load the DTB to
fdtaddr instead of fdt_addr as matthieu@@ reported fdt_addr was not
present in the u-boot environment on his system.
@
text
@setenv fdtfile imx6q-sabrelite.dtb ;
load ${dtype} ${disk}:1 ${fdtaddr} ${fdtfile} ;
load ${dtype} ${disk}:1 ${loadaddr} efi/boot/bootarm.efi ;
bootefi ${loadaddr} ${fdtaddr} ;
@


1.2
log
@Mainline u-boot on SABRE Lite/BD-SL-i.MX6 does not have the generic
distro hooks that automatically load an efi file if found.

Instead it looks for a '6x_bootscript' u-boot script as the original
boundary devices u-boot did.

Create a script in the nitrogen miniroot and on install that will
load a dtb and bootarm.efi then call bootefi.  Based on notes
from matthieu@@
@
text
@d2 1
a2 1
load ${dtype} ${disk}:1 ${fdt_addr} ${fdtfile} ;
d4 1
a4 1
bootefi ${loadaddr} ${fdt_addr} ;
@


1.1
log
@use a simple u-boot script for all the miniroots that loads with fdt
ok patrick@@ kettenis@@
@
text
@d1 4
a4 4
run findfdt ;
load mmc ${mmcdev}:1 ${loadaddr} bsd.umg ;
load mmc ${mmcdev}:1 ${fdt_addr_r} ${fdtfile} ;
bootm ${loadaddr} - ${fdt_addr_r} ;
@

