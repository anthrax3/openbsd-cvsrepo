head	1.33;
access;
symbols
	OPENBSD_6_1:1.33.0.2
	OPENBSD_6_1_BASE:1.33
	OPENBSD_6_0:1.30.0.12
	OPENBSD_6_0_BASE:1.30
	OPENBSD_5_9:1.30.0.8
	OPENBSD_5_9_BASE:1.30
	OPENBSD_5_8:1.30.0.10
	OPENBSD_5_8_BASE:1.30
	OPENBSD_5_7:1.30.0.4
	OPENBSD_5_7_BASE:1.30
	OPENBSD_5_6:1.30.0.6
	OPENBSD_5_6_BASE:1.30
	OPENBSD_5_5:1.30.0.2
	OPENBSD_5_5_BASE:1.30
	OPENBSD_5_4:1.28.0.10
	OPENBSD_5_4_BASE:1.28
	OPENBSD_5_3:1.28.0.8
	OPENBSD_5_3_BASE:1.28
	OPENBSD_5_2:1.28.0.6
	OPENBSD_5_2_BASE:1.28
	OPENBSD_5_1_BASE:1.28
	OPENBSD_5_1:1.28.0.4
	OPENBSD_5_0:1.28.0.2
	OPENBSD_5_0_BASE:1.28
	OPENBSD_4_9:1.23.0.8
	OPENBSD_4_9_BASE:1.23
	OPENBSD_4_8:1.23.0.6
	OPENBSD_4_8_BASE:1.23
	OPENBSD_4_7:1.23.0.2
	OPENBSD_4_7_BASE:1.23
	OPENBSD_4_6:1.23.0.4
	OPENBSD_4_6_BASE:1.23
	OPENBSD_4_5:1.22.0.2
	OPENBSD_4_5_BASE:1.22
	OPENBSD_4_4:1.20.0.4
	OPENBSD_4_4_BASE:1.20
	OPENBSD_4_3:1.20.0.2
	OPENBSD_4_3_BASE:1.20
	OPENBSD_4_2:1.19.0.2
	OPENBSD_4_2_BASE:1.19
	OPENBSD_4_1:1.16.0.10
	OPENBSD_4_1_BASE:1.16
	OPENBSD_4_0:1.16.0.8
	OPENBSD_4_0_BASE:1.16
	OPENBSD_3_9:1.16.0.6
	OPENBSD_3_9_BASE:1.16
	OPENBSD_3_8:1.16.0.4
	OPENBSD_3_8_BASE:1.16
	OPENBSD_3_7:1.16.0.2
	OPENBSD_3_7_BASE:1.16
	OPENBSD_3_6:1.15.0.4
	OPENBSD_3_6_BASE:1.15
	OPENBSD_3_5:1.15.0.2
	OPENBSD_3_5_BASE:1.15
	OPENBSD_3_4:1.14.0.4
	OPENBSD_3_4_BASE:1.14
	OPENBSD_3_3:1.14.0.2
	OPENBSD_3_3_BASE:1.14
	OPENBSD_3_2:1.10.0.2
	OPENBSD_3_2_BASE:1.10
	OPENBSD_3_1:1.5.0.4
	OPENBSD_3_1_BASE:1.5
	OPENBSD_3_0:1.5.0.2
	OPENBSD_3_0_BASE:1.5;
locks; strict;
comment	@# @;


1.33
date	2016.12.30.22.34.20;	author deraadt;	state Exp;
branches;
next	1.32;
commitid	6Icfy5C5S5JmllX6;

1.32
date	2016.11.30.15.46.45;	author natano;	state Exp;
branches;
next	1.31;
commitid	LWJ8qwxBylyYGvab;

1.31
date	2016.10.14.18.44.20;	author deraadt;	state Exp;
branches;
next	1.30;
commitid	SCMr9f2ZDRZiobIN;

1.30
date	2013.10.15.22.46.51;	author deraadt;	state Exp;
branches;
next	1.29;

1.29
date	2013.10.14.00.00.10;	author guenther;	state Exp;
branches;
next	1.28;

1.28
date	2011.07.09.00.42.49;	author drahn;	state Exp;
branches;
next	1.27;

1.27
date	2011.07.08.21.39.32;	author drahn;	state Exp;
branches;
next	1.26;

1.26
date	2011.04.18.16.52.09;	author thib;	state Exp;
branches;
next	1.25;

1.25
date	2011.04.15.03.11.22;	author deraadt;	state Exp;
branches;
next	1.24;

1.24
date	2011.03.14.19.07.46;	author deraadt;	state Exp;
branches;
next	1.23;

1.23
date	2009.04.17.03.58.54;	author deraadt;	state Exp;
branches;
next	1.22;

1.22
date	2008.12.02.03.20.57;	author deraadt;	state Exp;
branches;
next	1.21;

1.21
date	2008.12.02.01.01.07;	author deraadt;	state Exp;
branches;
next	1.20;

1.20
date	2008.01.11.10.16.40;	author espie;	state Exp;
branches;
next	1.19;

1.19
date	2007.06.17.00.28.21;	author deraadt;	state Exp;
branches;
next	1.18;

1.18
date	2007.04.13.17.34.40;	author millert;	state Exp;
branches;
next	1.17;

1.17
date	2007.04.09.14.55.11;	author millert;	state Exp;
branches;
next	1.16;

1.16
date	2005.03.11.15.40.59;	author deraadt;	state Exp;
branches;
next	1.15;

1.15
date	2004.03.11.22.16.50;	author deraadt;	state Exp;
branches;
next	1.14;

1.14
date	2003.03.24.18.56.18;	author drahn;	state Exp;
branches;
next	1.13;

1.13
date	2003.03.05.01.43.45;	author deraadt;	state Exp;
branches;
next	1.12;

1.12
date	2003.03.04.20.24.49;	author deraadt;	state Exp;
branches;
next	1.11;

1.11
date	2003.03.04.18.08.01;	author deraadt;	state Exp;
branches;
next	1.10;

1.10
date	2002.06.09.05.53.54;	author todd;	state Exp;
branches;
next	1.9;

1.9
date	2002.04.30.17.59.35;	author drahn;	state Exp;
branches;
next	1.8;

1.8
date	2002.04.30.09.18.20;	author deraadt;	state Exp;
branches;
next	1.7;

1.7
date	2002.04.28.18.28.34;	author deraadt;	state Exp;
branches;
next	1.6;

1.6
date	2002.04.25.22.10.28;	author deraadt;	state Exp;
branches;
next	1.5;

1.5
date	2001.09.21.02.38.17;	author miod;	state Exp;
branches;
next	1.4;

1.4
date	2001.09.18.17.59.41;	author drahn;	state Exp;
branches;
next	1.3;

1.3
date	2001.09.17.22.38.26;	author drahn;	state Exp;
branches;
next	1.2;

1.2
date	2001.09.02.04.54.40;	author drahn;	state Exp;
branches;
next	1.1;

1.1
date	2001.09.01.16.47.03;	author drahn;	state Exp;
branches;
next	;


desc
@@


1.33
log
@Install cert.pem + ftp(1) binary that supports SSL, so the install script
can perform https fetches.  While non-critical for sets (which are verified
using signify), it is an uplift for communication towards the ftp.openbsd.org
cgi which provides mirror proposals, entropy seeds, and current time.
[The install script changes are not included in this commit]
ok beck jsing rpe
@
text
@#	$OpenBSD: Makefile,v 1.32 2016/11/30 15:46:45 natano Exp $

REV=	${OSrev}

TOP=		${.CURDIR}/..

BSD_RD=		bsd.rd
IMAGE=		mr.fs
CBIN?=		instbin
CRUNCHCONF?=	${CBIN}.conf
CRUNCHCONFS?=	${.CURDIR}/../common/crunch.conf
LISTS=		${.CURDIR}/list
UTILS?=		${.CURDIR}/../../miniroot

MTREE=		${UTILS}/mtree.conf

DISKTYPE=	rdroot
MAKEFSARGS_RD=	-o disklabel=${DISKTYPE},minfree=0,density=4096

.ifndef DESTDIR
all ${IMAGE}:
	@@echo setenv DESTDIR before making a ramdisk!
	@@false
.else

# mix config is not needed.
all:	${BSD_RD} cd

${BSD_RD}: ${IMAGE} bsd rdsetroot
	cp bsd ${BSD_RD}
	${.OBJDIR}/rdsetroot ${BSD_RD} ${IMAGE}

cd: ${BSD_RD}
	-rm -rf ${.OBJDIR}/cd-dir/
	-@@mkdir -p ${.OBJDIR}/cd-dir/${OSREV}/macppc/
	cp bsd.rd ${.OBJDIR}/cd-dir/${OSREV}/macppc/bsd.rd
	strip ${.OBJDIR}/cd-dir/${OSREV}/macppc/bsd.rd
	gzip -9n ${.OBJDIR}/cd-dir/${OSREV}/macppc/bsd.rd
	mv ${.OBJDIR}/cd-dir/${OSREV}/macppc/bsd.rd.gz ${.OBJDIR}/cd-dir/${OSREV}/macppc/bsd.rd
	# On HFS, doing the following means COPIES of the files.. therefore
	# we skip doing so.
	# ln ${.OBJDIR}/cd-dir/${OSREV}/macppc/bsd.rd ${.OBJDIR}/cd-dir/bsd.rd
	# ln ${.OBJDIR}/cd-dir/bsd.rd ${.OBJDIR}/cd-dir/bsd
	cp ${.CURDIR}/../../../sys/arch/macppc/stand/tbxidata/bsd.tbxi \
	    ${.OBJDIR}/cd-dir/${OSREV}/macppc
	cp ${DESTDIR}/usr/mdec/ofwboot ${.OBJDIR}/cd-dir/
	mkhybrid -v -v -r -part -hfs \
	    -hfs-bless ${.OBJDIR}/cd-dir/${OSREV}/macppc \
	    -map ${.CURDIR}/../../../gnu/usr.sbin/mkhybrid/src/more.mapping \
	    -A "OpenBSD ${OSREV} macppc bootonly CD" \
	    -P "Copyright (c) `date +%Y` Theo de Raadt, The OpenBSD project" \
	    -p "Theo de Raadt <deraadt@@openbsd.org>" \
	    -V "OpenBSD/macppc  ${OSREV} boot-only CD" \
	    -o ${.OBJDIR}/cd${OSrev}.iso ${.OBJDIR}/cd-dir

${IMAGE}: ${CBIN}
	rm -rf $@@.d
	install -d -o root -g wheel $@@.d
	mtree -def ${MTREE} -p $@@.d -u
	TOPDIR=${TOP} CURDIR=${.CURDIR} OBJDIR=${.OBJDIR} REV=${REV} \
	    TARGDIR=$@@.d UTILS=${UTILS} RELEASEDIR=${RELEASEDIR} \
	    sh ${UTILS}/runlist.sh ${LISTS}
	rm $@@.d/${CBIN}
	makefs ${MAKEFSARGS_RD} $@@ $@@.d
	vnconfig -v -c vnd0 mr.fs
	df -i /dev/vnd0a
	vnconfig -u vnd0

.endif

bsd:
	cd ${TOP}/../../sys/arch/macppc/compile/RAMDISK && \
	    su ${BUILDUSER} -c '${MAKE} config && ${MAKE} clean && exec ${MAKE}'
	cp -p ${TOP}/../../sys/arch/macppc/compile/RAMDISK/obj/bsd bsd

rdsetroot:	${TOP}/../common/elfrdsetroot.c
	${HOSTCC} ${HOSTCFLAGS} -o rdsetroot \
	    ${TOP}/../common/elfrdsetroot.c ${TOP}/../common/elf32.c \
	    ${TOP}/../common/elf64.c

${CBIN}.mk ${CBIN}.cache ${CBIN}.c: ${CRUNCHCONF}
	crunchgen -E -D ${.CURDIR}/../../.. -L ${DESTDIR}/usr/lib ${.ALLSRC}

${CBIN}: ${CBIN}.mk ${CBIN}.cache ${CBIN}.c
	${MAKE} -f ${CBIN}.mk SRCLIBDIR=${.CURDIR}/../../../lib all

${CRUNCHCONF}: ${LISTS}
	awk -f ${UTILS}/makeconf.awk CBIN=${CBIN} ${LISTS} > ${CBIN}.conf

clean cleandir:
	/bin/rm -f *.core ${IMAGE} ${CBIN} ${CBIN}.mk ${CBIN}.cache \
	    lib*.a lib*.olist ${CBIN}.map \
	    *.o *.lo *.c bsd ${BSD_RD} cd${REV}.iso rdsetroot
	rm -rf cd-dir ${IMAGE}.d

.ifdef RELEASEDIR
install:
	cp ${BSD_RD} cd${REV}.iso ${RELEASEDIR}
.endif

.include <bsd.obj.mk>
.include <bsd.subdir.mk>
@


1.32
log
@Use makefs to build bsd.rd on armv7 and macppc.
ok deraadt
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.31 2016/10/14 18:44:20 deraadt Exp $
d65 3
@


1.31
log
@Use new kernel compile method for ramdisks, de-escalating to $BUILDUSER
as required.
much help from natano and tb.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.30 2013/10/15 22:46:51 deraadt Exp $
a14 1
MOUNT_POINT=	/mnt
d17 2
a18 11
VND?=		vnd0
VND_DEV=	/dev/${VND}a
VND_RDEV=	/dev/r${VND}a
VND_CRDEV=	/dev/r${VND}c
PID!=		echo $$$$


DISKTYPE=       rdroot
NBLKS=          8192
# minfree, opt, b/i  trks, sects, cpg
NEWFSARGS= -m 0 -o space -i 4096
d29 1
a29 1
${BSD_RD}: ${CBIN} ${IMAGE} bsd rdsetroot
d56 9
a64 1
${IMAGE}: rd_setup do_files rd_teardown
a72 13
rd_setup:
	dd if=/dev/zero of=${IMAGE} bs=512 count=${NBLKS}
	vnconfig -v -c ${VND} ${IMAGE}
	disklabel -w ${VND} ${DISKTYPE}
	newfs ${NEWFSARGS} ${VND_RDEV}
	fsck ${VND_RDEV}
	mount ${VND_DEV} ${MOUNT_POINT}

rd_teardown:
	@@df -i ${MOUNT_POINT}
	-umount ${MOUNT_POINT}
	-vnconfig -u ${VND}

a77 6
unconfig:
	-umount -f ${MOUNT_POINT}
	-vnconfig -u ${VND}

.PRECIOUS:	${IMAGE}

a86 7
do_files:
	mtree -def ${MTREE} -p ${MOUNT_POINT}/ -u
	TOPDIR=${TOP} CURDIR=${.CURDIR} OBJDIR=${.OBJDIR} \
	    REV=${REV} TARGDIR=${MOUNT_POINT} UTILS=${UTILS} \
	    RELEASEDIR=${RELEASEDIR} sh ${UTILS}/runlist.sh ${LISTS}
	rm ${MOUNT_POINT}/${CBIN}

d91 1
a91 1
	rm -rf cd-dir
@


1.30
log
@We do not produce "core" files, so they do not need to be deleted.  they
have been *.core files for a very long time.  That's a lot of unlink()
calls saved.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.29 2013/10/14 00:00:10 guenther Exp $
a70 1
	cd ${TOP}/../../sys/arch/macppc/conf && config RAMDISK
d72 2
a73 2
	    ${MAKE} clean && exec ${MAKE}
	cp ${TOP}/../../sys/arch/macppc/compile/RAMDISK/bsd bsd
@


1.29
log
@Turn on the distrib lib bits in crunchgen by setting SRCLIBDIR.
Add the new files to the clean target's rm list.

"why not get it tested?" deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.28 2011/07/09 00:42:49 drahn Exp $
d117 1
a117 1
	/bin/rm -f core ${IMAGE} ${CBIN} ${CBIN}.mk ${CBIN}.cache \
@


1.28
log
@Unbreak most archs for the last commit. cut and paste changed rdsetroot
to elfrdsetroot. Does not yet fix sparc
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.27 2011/07/08 21:39:32 drahn Exp $
d104 1
a104 1
	${MAKE} -f ${CBIN}.mk all
d118 1
@


1.27
log
@Allow the elf rdsetroot operation to function on 32 bit and 64 bit binaries.
Enables developers to build arm ramdisk kernels on amd64 archs
OK deraadt@@ 'looked fine' miod@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.26 2011/04/18 16:52:09 thib Exp $
d90 1
a90 1
	${HOSTCC} ${HOSTCFLAGS} -o elfrdsetroot \
@


1.26
log
@Deprecate vnds in favour of svnds.

In effect, this removes the "old" vndX nodes, and renames
the svndX nodes to vndX.

Old svndX nodes will still continue to work though, for now.

Cleanup accordingly.

ok deraadt@@, todd@@
comments and ok on the man page bits from jmc@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.25 2011/04/15 03:11:22 deraadt Exp $
d90 3
a92 1
	${HOSTCC} -o rdsetroot ${TOP}/../common/elfrdsetroot.c
@


1.25
log
@No need to make depend kernels; ok guenther
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.24 2011/03/14 19:07:46 deraadt Exp $
d18 1
a18 1
VND?=		svnd0
@


1.24
log
@unify a chunk
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.23 2009/04/17 03:58:54 deraadt Exp $
d73 1
a73 1
	    ${MAKE} clean && ${MAKE} depend && ${MAKE}
@


1.23
log
@For SHA256 hashes to be ready to go onto the install media, we must
build the sets before we build the media.  While there we can get rid
of DESTDIR/snapshot too, and simply install straight into RELEASEDIR.
(This also ends up saving an astounding amount of traffic/latency in a nfs
environment)
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.22 2008/12/02 03:20:57 deraadt Exp $
d116 1
a116 2
	*.o *.lo *.c bsd ${BSD_RD} cd${REV}.iso \
	rdsetroot
@


1.22
log
@commit with rdsetroot now accepting the filesystem as a 2nd arg
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.21 2008/12/02 01:01:07 deraadt Exp $
a97 3
install:
	cp ${BSD_RD} cd${REV}.iso ${DESTDIR}/snapshot/

d111 1
a111 1
	    sh ${TOP}/../miniroot/runlist.sh ${LISTS}
d120 4
a123 2
beforeinstall:
	cp ${BSD.RD} cd${REV}.iso ${DESTDIR}/snapshot
@


1.21
log
@no longer need to compile rdsetroot with DEBUG
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.20 2008/01/11 10:16:40 espie Exp $
d41 1
a41 1
	${.OBJDIR}/rdsetroot ${BSD_RD} < ${IMAGE}
@


1.20
log
@cleanup: make -> ${MAKE} consistenly.
zap extra subshells.

okay miod@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.19 2007/06/17 00:28:21 deraadt Exp $
d90 1
a90 1
	${HOSTCC} -DDEBUG -o rdsetroot ${TOP}/../common/elfrdsetroot.c
@


1.19
log
@Stop using disklabel -r.  The disklabel code does not know all the semantics
for pushing disklabels onto the disk (and besides that, it is buggy and
unreadable crap); thanks for help from krw
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.18 2007/04/13 17:34:40 millert Exp $
d73 1
a73 1
	    make clean && make depend && make
d105 1
a105 1
	make -f ${CBIN}.mk all
@


1.18
log
@Update install media generation to the new semantics of the -c flag.
Also replace "newfs -O" with "newfs -O 0" now that -O takes an option.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.17 2007/04/09 14:55:11 millert Exp $
d79 1
a79 1
	disklabel -w -r ${VND} ${DISKTYPE}
@


1.17
log
@Add -n to gzip flags.  Save a few bytes since we no longer save
the uncompressed filename in the gzip header.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.16 2005/03/11 15:40:59 deraadt Exp $
d28 1
a28 1
NEWFSARGS= -m 0 -o space -c 16 -i 4096
@


1.16
log
@never worry about the copyright date on the CD layout again, problem
noticed by drahn
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.15 2004/03/11 22:16:50 deraadt Exp $
d48 1
a48 1
	gzip -9 ${.OBJDIR}/cd-dir/${OSREV}/macppc/bsd.rd
@


1.15
log
@change copyrights on iso images, spotted by miod
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.14 2003/03/24 18:56:18 drahn Exp $
d61 1
a61 1
	    -P "Copyright (c) 2004 Theo de Raadt, The OpenBSD project" \
@


1.14
log
@Enable 'snag' boot on macppc boot iso. ok miod@@ deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.13 2003/03/05 01:43:45 deraadt Exp $
d61 1
a61 1
	    -P "Copyright (c) 2003 Theo de Raadt, The OpenBSD project" \
@


1.13
log
@document why no extra /bsd or /bsd.rd on the iso, only 3.3/macppc/bsd.rd...
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.12 2003/03/04 20:24:49 deraadt Exp $
d54 2
d58 2
@


1.12
log
@better mkhybrid -V message
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.11 2003/03/04 18:08:01 deraadt Exp $
d50 4
d55 1
a55 1
	mkhybrid -r -part -hfs \
@


1.11
log
@call it cd${Rev}.iso
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.10 2002/06/09 05:53:54 todd Exp $
d55 1
a55 1
	    -V "OpenBSD${OSREV} CD boot-only CD " \
@


1.10
log
@knf
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.9 2002/04/30 17:59:35 drahn Exp $
d51 6
a56 2
	mkhybrid -r -part -hfs -o ${.OBJDIR}/cd${OSrev}.fs ${.OBJDIR}/cd-dir

d91 1
a91 1
	cp ${BSD_RD} cd${REV}.fs ${DESTDIR}/snapshot/
d111 1
a111 1
	*.o *.lo *.c bsd ${BSD_RD} cd${REV}.fs \
d116 1
a116 1
	cp ${BSD.RD} cd${REV}.fs ${DESTDIR}/snapshot
@


1.9
log
@Parital sync to i386 common/Makefile.inc, enough to build ramdisk at least.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.8 2002/04/30 09:18:20 deraadt Exp $
d64 1
a64 1
rd_setup: 
@


1.8
log
@use makeconf.awk throughout, delete instbin in Makefile
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.7 2002/04/28 18:28:34 deraadt Exp $
d10 2
d89 1
a89 1
${CBIN}.mk ${CBIN}.cache ${CBIN}.c: ${CBIN}.conf
d94 3
@


1.7
log
@use single shared mtree.conf
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.6 2002/04/25 22:10:28 deraadt Exp $
d98 1
@


1.6
log
@runlist.sh & list2sh.awk unification
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.5 2001/09/21 02:38:17 miod Exp $
d14 1
a14 1
MTREE=		${.CURDIR}/mtree.conf
@


1.5
log
@Fix rdsetroot dependency.
@
text
@d1 3
a3 1
#	$OpenBSD: Makefile,v 1.4 2001/09/18 17:59:41 drahn Exp $
a6 1
.include "${TOP}/Makefile.inc"
d96 2
a97 1
	    REV=${REV} TARGDIR=${MOUNT_POINT} sh ${TOP}/runlist.sh ${LISTS}
@


1.4
log
@Remove rdsetroot from here and use the one in distrib/common (elf version)
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.3 2001/09/17 22:38:26 drahn Exp $
d74 1
a74 1
rdsetroot:	${TOP}/common/rdsetroot.c
@


1.3
log
@Clean up the cd-dir directory and the cdxx.fs file.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.2 2001/09/02 04:54:40 drahn Exp $
d75 1
a75 1
	${HOSTCC} -DDEBUG -o rdsetroot ${TOP}/common/rdsetroot.c
@


1.2
log
@powerpc -> macppc changes which were missed previously.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.1 2001/09/01 16:47:03 drahn Exp $
d99 1
a99 1
	*.o *.lo *.c bsd ${BSD_RD} \
d101 1
@


1.1
log
@Move the powerpc ramdisk building support from powerpc to macppc.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.18 2001/07/11 05:23:58 drahn Exp $
d42 5
a46 5
	-@@mkdir -p ${.OBJDIR}/cd-dir/${OSREV}/powerpc/
	cp bsd.rd ${.OBJDIR}/cd-dir/${OSREV}/powerpc/bsd.rd
	strip ${.OBJDIR}/cd-dir/${OSREV}/powerpc/bsd.rd
	gzip -9 ${.OBJDIR}/cd-dir/${OSREV}/powerpc/bsd.rd
	mv ${.OBJDIR}/cd-dir/${OSREV}/powerpc/bsd.rd.gz ${.OBJDIR}/cd-dir/${OSREV}/powerpc/bsd.rd
d56 2
a57 2
	cd ${TOP}/../../sys/arch/powerpc/conf && config RAMDISK
	cd ${TOP}/../../sys/arch/powerpc/compile/RAMDISK && \
d59 1
a59 1
	cp ${TOP}/../../sys/arch/powerpc/compile/RAMDISK/bsd bsd
@

