head	1.21;
access;
symbols
	OPENBSD_6_0:1.20.0.20
	OPENBSD_6_0_BASE:1.20
	OPENBSD_5_9:1.20.0.16
	OPENBSD_5_9_BASE:1.20
	OPENBSD_5_8:1.20.0.18
	OPENBSD_5_8_BASE:1.20
	OPENBSD_5_7:1.20.0.10
	OPENBSD_5_7_BASE:1.20
	OPENBSD_5_6:1.20.0.14
	OPENBSD_5_6_BASE:1.20
	OPENBSD_5_5:1.20.0.12
	OPENBSD_5_5_BASE:1.20
	OPENBSD_5_4:1.20.0.8
	OPENBSD_5_4_BASE:1.20
	OPENBSD_5_3:1.20.0.6
	OPENBSD_5_3_BASE:1.20
	OPENBSD_5_2:1.20.0.4
	OPENBSD_5_2_BASE:1.20
	OPENBSD_5_1_BASE:1.20
	OPENBSD_5_1:1.20.0.2
	OPENBSD_5_0:1.18.0.2
	OPENBSD_5_0_BASE:1.18
	OPENBSD_4_9:1.17.0.2
	OPENBSD_4_9_BASE:1.17
	OPENBSD_4_8:1.15.0.10
	OPENBSD_4_8_BASE:1.15
	OPENBSD_4_7:1.15.0.6
	OPENBSD_4_7_BASE:1.15
	OPENBSD_4_6:1.15.0.8
	OPENBSD_4_6_BASE:1.15
	OPENBSD_4_5:1.15.0.4
	OPENBSD_4_5_BASE:1.15
	OPENBSD_4_4:1.15.0.2
	OPENBSD_4_4_BASE:1.15
	OPENBSD_4_3:1.14.0.4
	OPENBSD_4_3_BASE:1.14
	OPENBSD_4_2:1.14.0.2
	OPENBSD_4_2_BASE:1.14
	OPENBSD_4_1:1.13.0.12
	OPENBSD_4_1_BASE:1.13
	OPENBSD_4_0:1.13.0.10
	OPENBSD_4_0_BASE:1.13
	OPENBSD_3_9:1.13.0.8
	OPENBSD_3_9_BASE:1.13
	OPENBSD_3_8:1.13.0.6
	OPENBSD_3_8_BASE:1.13
	OPENBSD_3_7:1.13.0.4
	OPENBSD_3_7_BASE:1.13
	OPENBSD_3_6:1.13.0.2
	OPENBSD_3_6_BASE:1.13
	OPENBSD_3_5:1.12.0.4
	OPENBSD_3_5_BASE:1.12
	OPENBSD_3_4:1.12.0.2
	OPENBSD_3_4_BASE:1.12
	OPENBSD_3_3:1.10.0.2
	OPENBSD_3_3_BASE:1.10
	OPENBSD_3_2:1.9.0.10
	OPENBSD_3_2_BASE:1.9
	OPENBSD_3_1:1.9.0.8
	OPENBSD_3_1_BASE:1.9
	OPENBSD_3_0:1.9.0.6
	OPENBSD_3_0_BASE:1.9
	OPENBSD_2_9:1.9.0.4
	OPENBSD_2_9_BASE:1.9
	OPENBSD_2_8:1.9.0.2
	OPENBSD_2_8_BASE:1.9
	OPENBSD_2_7:1.8.0.2
	OPENBSD_2_7_BASE:1.8
	OPENBSD_2_6:1.5.0.2
	OPENBSD_2_6_BASE:1.5
	OPENBSD_2_5:1.3.0.2
	OPENBSD_2_5_BASE:1.3
	OPENBSD_2_4:1.2.0.4
	OPENBSD_2_4_BASE:1.2
	OPENBSD_2_3:1.2.0.2
	OPENBSD_2_3_BASE:1.2;
locks; strict;
comment	@# @;


1.21
date	2016.08.22.19.41.18;	author schwarze;	state dead;
branches;
next	1.20;
commitid	ey7eLp6W2n4XJ7B4;

1.20
date	2012.01.22.13.45.22;	author schwarze;	state Exp;
branches;
next	1.19;

1.19
date	2011.12.03.23.01.21;	author schwarze;	state Exp;
branches;
next	1.18;

1.18
date	2011.03.02.07.48.22;	author jmc;	state Exp;
branches;
next	1.17;

1.17
date	2011.02.22.00.23.14;	author espie;	state Exp;
branches;
next	1.16;

1.16
date	2010.10.29.12.06.45;	author jmc;	state Exp;
branches;
next	1.15;

1.15
date	2008.06.26.05.42.05;	author ray;	state Exp;
branches;
next	1.14;

1.14
date	2007.05.31.19.19.40;	author jmc;	state Exp;
branches;
next	1.13;

1.13
date	2004.07.06.14.20.19;	author jmc;	state Exp;
branches;
next	1.12;

1.12
date	2003.07.09.10.00.09;	author espie;	state Exp;
branches;
next	1.11;

1.11
date	2003.06.02.13.59.56;	author jmc;	state Exp;
branches;
next	1.10;

1.10
date	2003.02.07.07.45.13;	author jmc;	state Exp;
branches;
next	1.9;

1.9
date	2000.10.30.17.46.08;	author aaron;	state Exp;
branches;
next	1.8;

1.8
date	2000.04.23.22.14.27;	author espie;	state Exp;
branches;
next	1.7;

1.7
date	2000.04.12.21.48.04;	author aaron;	state Exp;
branches;
next	1.6;

1.6
date	2000.02.04.01.02.47;	author espie;	state Exp;
branches;
next	1.5;

1.5
date	99.09.19.23.15.02;	author alex;	state Exp;
branches;
next	1.4;

1.4
date	99.07.07.10.50.11;	author aaron;	state Exp;
branches;
next	1.3;

1.3
date	98.12.16.03.05.34;	author aaron;	state Exp;
branches;
next	1.2;

1.2
date	97.11.13.04.40.14;	author millert;	state Exp;
branches;
next	1.1;

1.1
date	97.11.05.19.20.47;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.21
log
@This code served us well for many years,
but we are unlikely to reactivate it; espie@@ agrees.
The new code is in /usr/src/usr.bin/mandoc/mandocdb.c.
@
text
@.\"	$OpenBSD: makewhatis.8,v 1.20 2012/01/22 13:45:22 schwarze Exp $
.\"	$NetBSD: makewhatis.8,v 1.2.2.1 1997/11/10 19:57:45 thorpej Exp $
.\"
.\" Copyright (c) 1997 The NetBSD Foundation, Inc.
.\" All rights reserved.
.\"
.\" This code is derived from software contributed to The NetBSD Foundation
.\" by Robert Dobbs <banshee@@gabriella.resort.com>.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE NETBSD FOUNDATION, INC. AND CONTRIBUTORS
.\" ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED
.\" TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
.\" PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE FOUNDATION OR CONTRIBUTORS
.\" BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
.\" CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
.\" SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
.\" INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
.\" CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
.\" ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
.\" POSSIBILITY OF SUCH DAMAGE.
.\"
.Dd $Mdocdate: January 22 2012 $
.Dt MAKEWHATIS 8
.Os
.Sh NAME
.Nm makewhatis
.Nd create a whatis.db database
.Sh SYNOPSIS
.Nm makewhatis
.Op Fl pv
.Op Ar manpath ...
.Nm makewhatis
.Op Fl pv
.Fl d Ar manpath
.Ar files ...
.Nm makewhatis
.Op Fl pv
.Fl u Ar manpath
.Ar files ...
.Nm makewhatis
.Op Fl pv
.Fl t
.Ar files
.Sh DESCRIPTION
.Nm
extracts the NAME lines from compiled or raw
.Xr man 1
pages and creates
a whatis.db database (that is, a subject index)
for use with
.Xr apropos 1 ,
.Xr whatis 1 ,
and
.Xr man 1 Ns 's
.Fl k
option.
If
.Ar manpath
is unspecified,
.Nm
by default creates databases for each directory prefixed by
the _whatdb keyword in
.Pa /etc/man.conf .
Man pages compressed with
.Xr compress 1
and
.Xr gzip 1
are uncompressed before processing.
.Pp
If the
.Fl d
option is used,
.Nm
merges the description of
.Ar files
with an existing
.Pa whatis.db
database in
.Ar manpath .
.Pp
If the
.Fl u
option is used,
.Nm
removes the description of
.Ar files
from an existing
.Pa whatis.db
database in
.Ar manpath .
.Pp
By default,
.Nm
is relatively silent.
If the
.Fl v
is used,
.Nm
will be more verbose about manpages with problems.
If the
.Fl p
option is used,
.Nm
is less forgiving and warns about incorrect man pages.
.Pp
The
.Fl t
option can be used to check a set of potential man pages without
changing any
.Pa whatis.db
database.
.Sh FILES
.Bl -tag -width /etc/man.conf -compact
.It Pa whatis.db
index to man pages in directory
.It Pa /etc/man.conf
man configuration information
.El
.Sh SEE ALSO
.Xr apropos 1 ,
.Xr man 1 ,
.Xr whatis 1 ,
.Xr man.conf 5
.Sh HISTORY
A
.Nm
utility first appeared in
.Bx 2 .
It was rewritten in
.Xr perl 1
for
.Ox 2.7 .
.Pp
The
.Ar dir
argument first appeared in
.Nx 1.0 ;
the options
.Fl dptu
in
.Ox 2.7 ;
and the option
.Fl v
in
.Ox 4.9 .
.Sh AUTHORS
.An Bill Joy
wrote the original
.Bx
.Nm
in February 1979.
.An Marc Espie
started the Perl version in 2000.
.Sh BUGS
.Nm
should parse
.Pa /etc/man.conf
and deal with extra configuration information.
.Pp
The use of heuristics to retrieve subjects
from most man pages is not 100% accurate.
@


1.20
log
@Bring in corrections and improvements that were committed to the new
suite of tools now being disabled, as far as they apply to the current
tools as well.
@
text
@d1 1
a1 1
.\"	$OpenBSD: makewhatis.8,v 1.19 2011/12/03 23:01:21 schwarze Exp $
d31 1
a31 1
.Dd $Mdocdate: December 3 2011 $
@


1.19
log
@Remove an OpenBSD-specific tweak regarding .Xr spacing
and make it compatible with bsd.lv mandoc and with groff-1.21.
This tweak was originally added for compatibility with groff-1.15,
which is no longer needed.

ok jmc@@ kristaps@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: makewhatis.8,v 1.18 2011/03/02 07:48:22 jmc Exp $
d31 1
a31 1
.Dd $Mdocdate: March 2 2011 $
d133 30
@


1.18
log
@zap trailing whitespace;
@
text
@d1 1
a1 1
.\"	$OpenBSD: makewhatis.8,v 1.17 2011/02/22 00:23:14 espie Exp $
d31 1
a31 1
.Dd $Mdocdate: February 22 2011 $
d63 1
a63 1
.Xr man 1 's
@


1.17
log
@shut up unless -v, and a few minor enhancements.
okay miod@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: makewhatis.8,v 1.16 2010/10/29 12:06:45 jmc Exp $
d31 1
a31 1
.Dd $Mdocdate: October 29 2010 $
d101 2
a102 2
By default, 
.Nm 
@


1.16
log
@more nroff removal, with tweaks from (and ok) schwarze;
@
text
@d1 1
a1 1
.\"	$OpenBSD: makewhatis.8,v 1.15 2008/06/26 05:42:05 ray Exp $
d31 1
a31 1
.Dd $Mdocdate: June 26 2008 $
d39 1
a39 1
.Op Fl p
d42 1
a42 1
.Op Fl p
d46 1
a46 1
.Op Fl p
d50 1
a50 1
.Op Fl p
d101 8
@


1.15
log
@First pass at removing clauses 3 and 4 from NetBSD licenses.

Not sure what's more surprising: how long it took for NetBSD to
catch up to the rest of the BSDs (including UCB), or the amount of
code that NetBSD has claimed for itself without attributing to the
actual authors.

OK deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: makewhatis.8,v 1.14 2007/05/31 19:19:40 jmc Exp $
d31 1
a31 1
.Dd $Mdocdate: May 31 2007 $
d55 1
a55 1
strips the NAME lines from compiled or raw
a122 1
.Xr nroff 1 ,
d130 3
a132 6
In particular, it does not handle
.Xr nroff 1
.Cm me
format.
Likewise, its use of
heuristics to retrieve subjects from most man pages is not 100% accurate.
@


1.14
log
@convert to new .Dd format;
@
text
@d1 1
a1 1
.\"	$OpenBSD: makewhatis.8,v 1.13 2004/07/06 14:20:19 jmc Exp $
a17 7
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgement:
.\"        This product includes software developed by the NetBSD
.\"        Foundation, Inc. and its contributors.
.\" 4. Neither the name of The NetBSD Foundation nor the names of its
.\"    contributors may be used to endorse or promote products derived
.\"    from this software without specific prior written permission.
d31 1
a31 1
.Dd $Mdocdate$
@


1.13
log
@the whatis.db database is also used by whatis(1), so note that;
add apropos(1) and whatis(1) to SEE ALSO;
@
text
@d1 1
a1 1
.\"	$OpenBSD: makewhatis.8,v 1.12 2003/07/09 10:00:09 espie Exp $
d38 1
a38 1
.Dd October 17, 1997
@


1.12
log
@-u option, remove manpages, symetrical to -d.
ok millert@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: makewhatis.8,v 1.11 2003/06/02 13:59:56 jmc Exp $
d66 4
a69 3
for use in
.Xr apropos 1
or with
d128 1
d131 1
@


1.11
log
@- section reorder
- whitespace at EOL
@
text
@d1 1
a1 1
.\"	$OpenBSD: makewhatis.8,v 1.10 2003/02/07 07:45:13 jmc Exp $
d54 4
d92 11
@


1.10
log
@typos;
@
text
@d1 1
a1 1
.\"	$OpenBSD: makewhatis.8,v 1.9 2000/10/30 17:46:08 aaron Exp $
d92 1
a92 1
If the 
d101 1
a101 1
changing any 
d111 4
d117 1
a117 1
should parse 
a125 4
.Sh SEE ALSO
.Xr man 1 ,
.Xr nroff 1 ,
.Xr man.conf 5
@


1.9
log
@libexec man page fleshing. again, bored on the plane home.
@
text
@d1 1
a1 1
.\"	$OpenBSD: makewhatis.8,v 1.8 2000/04/23 22:14:27 espie Exp $
d107 1
a107 1
index to man pages in directory,
d109 1
a109 1
man configuration information.
d118 2
a119 1
me format.
a122 1
.Xr nroff 1 , 
d124 2
a125 1
.Xr man.conf 5 .
@


1.8
log
@With perl 5.6.0, GetOpt::Std is functional, use it.
Add -p (prick) and -t (test) option.
reword error handling as follows:
makewhatis tries harder to find section and/or subject lines in man pages,
even when the formatting is slightly incorrect.
-p mode diagnoses problems.
-t can be used to quickly test a new man page.
Approved by millert@@.  aaron@@ would like `The options are as follows...'
style, but:
- I don't think this would be as clear,
- he hasn't come up with actual replacement text yet...

At least this is accurate documentation.
@
text
@d1 1
a1 1
.\"	$OpenBSD: makewhatis.8,v 1.7 2000/04/12 21:48:04 aaron Exp $
d115 2
a116 2
and deal with extra configuration information. In particular, it does not
handle
@


1.7
log
@Trailing whitespace begone!
@
text
@d1 1
a1 1
.\"	$OpenBSD: makewhatis.8,v 1.6 2000/02/04 01:02:47 espie Exp $
d46 1
d49 1
d52 4
d79 1
a79 3
are uncompressed before processing, unformatted man pages
will be processed by
.Xr getNAME 8 .
d91 13
d105 1
a105 1
.Bl -tag -width whatis.db -compact
d107 3
a109 1
index to man pages in directory.
d111 10
d122 1
d124 1
a124 2
.Xr man.conf 5 ,
.Xr getNAME 8
@


1.6
log
@Document new stuff...
@
text
@d1 1
a1 1
.\"	$OpenBSD: makewhatis.8,v 1.5 1999/09/19 23:15:02 alex Exp $
d78 1
a78 1
.Fl d 
d81 1
a81 1
merges the description of 
d83 2
a84 2
with an existing 
.Pa whatis.db 
@


1.5
log
@When invoked without arguments, extract manpaths from /etc/man.conf.
Allow multiple paths to be specified on the command line.  millert@@ ok
@
text
@d1 1
a1 1
.\"	$OpenBSD: makewhatis.8,v 1.4 1999/07/07 10:50:11 aaron Exp $
d47 3
d55 1
a55 1
a whatis.db database
d76 16
@


1.4
log
@The proper order of the ``introductory'' macros in a man page is .Dd/.Dt/.Os.
Out of the approximately 1450 man pages, only about 90 of them were wrong.
Thanks to kwesterback@@home.com for coming up with a script and patch to repair
this. The patch also inserted a .Os macro in the few man pages that were
missing one.
@
text
@d1 1
a1 1
.\"	$OpenBSD: makewhatis.8,v 1.3 1998/12/16 03:05:34 aaron Exp $
d46 1
a46 1
.Op Ar manpath
d63 3
a65 2
by default creates a database for
.Pa /usr/share/man .
a72 4
.Sh BUGS
.Nm
should find its search paths using
.Pa /etc/man.conf .
@


1.3
log
@even more .Nm fixes
@
text
@d1 1
a1 1
.\"	$OpenBSD: makewhatis.8,v 1.2 1997/11/13 04:40:14 millert Exp $
d40 1
@


1.2
log
@From NetBSD:
    makewhatis.sh rewrite by mrg@@netbsd.org that uses getNAME(8).
    Much faster for unformatted man pages now that there is no need
    to format them on the fly.  Removes duplicate inode entries, so
    files with multiple hard links are only parsed once.
OpenBSD changes:
    set $PATH to a reasonable value
    avoid /tmp races via mktemp(1)
    obey $TMPDIR
@
text
@d1 1
a1 1
.\"	$OpenBSD: makewhatis.8,v 1.1 1997/11/05 19:20:47 deraadt Exp $
d44 1
a44 1
.Nm /usr/libexec/makewhatis
d62 2
a63 1
by default creates a database for /usr/share/man.
d73 2
a74 1
should find its search paths using /etc/man.conf
@


1.1
log
@man page from netbsd
@
text
@d1 2
a2 2
.\"	$OpenBSD$
.\"	$NetBSD: makewhatis.8,v 1.2 1997/10/20 02:41:18 enami Exp $
d29 1
a29 1
.\" PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE FOUNDATION OR CONTRIBUTORS 
d56 2
a57 1
-k option.
d68 2
a69 1
will be formatted on the fly.
d75 2
a76 3
.Xr man.conf 5
.Sh AUTHOR
J.T. Conklin (jtc@@netbsd.org)
@
