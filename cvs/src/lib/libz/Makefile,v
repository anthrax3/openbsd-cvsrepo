head	1.20;
access;
symbols
	OPENBSD_6_2_BASE:1.20
	OPENBSD_6_1:1.20.0.4
	OPENBSD_6_1_BASE:1.20
	OPENBSD_6_0:1.18.0.2
	OPENBSD_6_0_BASE:1.18
	OPENBSD_5_9:1.17.0.12
	OPENBSD_5_9_BASE:1.17
	OPENBSD_5_8:1.17.0.14
	OPENBSD_5_8_BASE:1.17
	OPENBSD_5_7:1.17.0.6
	OPENBSD_5_7_BASE:1.17
	OPENBSD_5_6:1.17.0.10
	OPENBSD_5_6_BASE:1.17
	OPENBSD_5_5:1.17.0.8
	OPENBSD_5_5_BASE:1.17
	OPENBSD_5_4:1.17.0.4
	OPENBSD_5_4_BASE:1.17
	OPENBSD_5_3:1.17.0.2
	OPENBSD_5_3_BASE:1.17
	OPENBSD_5_2:1.16.0.6
	OPENBSD_5_2_BASE:1.16
	OPENBSD_5_1_BASE:1.16
	OPENBSD_5_1:1.16.0.4
	OPENBSD_5_0:1.16.0.2
	OPENBSD_5_0_BASE:1.16
	OPENBSD_4_9:1.14.0.22
	OPENBSD_4_9_BASE:1.14
	OPENBSD_4_8:1.14.0.20
	OPENBSD_4_8_BASE:1.14
	OPENBSD_4_7:1.14.0.16
	OPENBSD_4_7_BASE:1.14
	OPENBSD_4_6:1.14.0.18
	OPENBSD_4_6_BASE:1.14
	OPENBSD_4_5:1.14.0.14
	OPENBSD_4_5_BASE:1.14
	OPENBSD_4_4:1.14.0.12
	OPENBSD_4_4_BASE:1.14
	OPENBSD_4_3:1.14.0.10
	OPENBSD_4_3_BASE:1.14
	OPENBSD_4_2:1.14.0.8
	OPENBSD_4_2_BASE:1.14
	OPENBSD_4_1:1.14.0.6
	OPENBSD_4_1_BASE:1.14
	OPENBSD_4_0:1.14.0.4
	OPENBSD_4_0_BASE:1.14
	OPENBSD_3_9:1.14.0.2
	OPENBSD_3_9_BASE:1.14
	OPENBSD_3_8:1.13.0.2
	OPENBSD_3_8_BASE:1.13
	OPENBSD_3_7:1.12.0.6
	OPENBSD_3_7_BASE:1.12
	OPENBSD_3_6:1.12.0.4
	OPENBSD_3_6_BASE:1.12
	OPENBSD_3_5:1.12.0.2
	OPENBSD_3_5_BASE:1.12
	OPENBSD_3_4:1.7.0.4
	OPENBSD_3_4_BASE:1.7
	OPENBSD_3_3:1.7.0.2
	OPENBSD_3_3_BASE:1.7
	OPENBSD_3_2:1.5.0.18
	OPENBSD_3_2_BASE:1.5
	OPENBSD_3_1:1.5.0.16
	OPENBSD_3_1_BASE:1.5
	OPENBSD_3_0:1.5.0.14
	OPENBSD_3_0_BASE:1.5
	OPENBSD_2_9:1.5.0.12
	OPENBSD_2_9_BASE:1.5
	OPENBSD_2_8:1.5.0.10
	OPENBSD_2_8_BASE:1.5
	OPENBSD_2_7:1.5.0.8
	OPENBSD_2_7_BASE:1.5
	OPENBSD_2_6:1.5.0.6
	OPENBSD_2_6_BASE:1.5
	OPENBSD_2_5:1.5.0.4
	OPENBSD_2_5_BASE:1.5
	OPENBSD_2_4:1.5.0.2
	OPENBSD_2_4_BASE:1.5
	OPENBSD_2_3:1.4.0.6
	OPENBSD_2_3_BASE:1.4
	OPENBSD_2_2:1.4.0.4
	OPENBSD_2_2_BASE:1.4
	OPENBSD_2_1:1.4.0.2
	OPENBSD_2_1_BASE:1.4
	OPENBSD_2_0:1.2.0.2
	OPENBSD_2_0_BASE:1.2;
locks; strict;
comment	@# @;


1.20
date	2016.09.14.06.26.03;	author natano;	state Exp;
branches;
next	1.19;
commitid	NbvBwJJcB21JqIOO;

1.19
date	2016.09.04.09.54.25;	author natano;	state Exp;
branches;
next	1.18;
commitid	j8zuNlBiRSrQjS9G;

1.18
date	2016.03.30.06.38.43;	author jmc;	state Exp;
branches;
next	1.17;
commitid	LN9ijdk9SEnzWAbM;

1.17
date	2012.08.02.13.38.39;	author okan;	state Exp;
branches;
next	1.16;

1.16
date	2011.05.26.13.52.55;	author jasper;	state Exp;
branches;
next	1.15;

1.15
date	2011.05.04.07.36.38;	author jasper;	state Exp;
branches;
next	1.14;

1.14
date	2005.11.24.20.49.23;	author deraadt;	state Exp;
branches;
next	1.13;

1.13
date	2005.07.20.21.29.00;	author jmc;	state Exp;
branches;
next	1.12;

1.12
date	2003.12.17.14.06.45;	author jmc;	state Exp;
branches;
next	1.11;

1.11
date	2003.12.17.01.15.25;	author millert;	state Exp;
branches;
next	1.10;

1.10
date	2003.12.16.22.33.02;	author henning;	state Exp;
branches;
next	1.9;

1.9
date	2003.10.01.09.07.14;	author jmc;	state Exp;
branches;
next	1.8;

1.8
date	2003.09.25.09.12.09;	author jmc;	state Exp;
branches;
next	1.7;

1.7
date	2003.02.26.18.13.22;	author millert;	state Exp;
branches;
next	1.6;

1.6
date	2003.02.23.23.17.01;	author deraadt;	state Exp;
branches;
next	1.5;

1.5
date	98.08.08.20.57.04;	author millert;	state Exp;
branches
	1.5.18.1;
next	1.4;

1.4
date	97.04.27.20.56.20;	author millert;	state Exp;
branches;
next	1.3;

1.3
date	96.12.08.15.22.35;	author downsj;	state Exp;
branches;
next	1.2;

1.2
date	96.07.27.22.26.38;	author tholo;	state Exp;
branches;
next	1.1;

1.1
date	96.07.27.02.39.42;	author tholo;	state Exp;
branches;
next	;

1.5.18.1
date	2003.03.05.03.51.31;	author margarida;	state Exp;
branches;
next	;


desc
@@


1.20
log
@Generate pkg-config files at build time like everything else. This
avoids permission problems due to the build and install stages being run
by different users.

ok deraadt jasper
@
text
@#	$OpenBSD: Makefile,v 1.19 2016/09/04 09:54:25 natano Exp $

LIB=	z
HDRS=	zconf.h zlib.h
SRCS=	adler32.c compress.c crc32.c deflate.c gzio.c infback.c \
	inffast.c inflate.c inftrees.c trees.c uncompr.c zutil.c
MAN=	compress.3
CFLAGS+=-DHAVE_STRERROR -DHAVE_MEMCPY -DHAS_vsnprintf -DHAS_snprintf

PC_FILES=zlib.pc
CLEANFILES+=${PC_FILES}

includes:
	@@cd ${.CURDIR}; for i in $(HDRS); do \
		j="cmp -s $$i ${DESTDIR}/usr/include/$$i || \
		    ${INSTALL} ${INSTALL_COPY} -o ${BINOWN} -g ${BINGRP} -m 444 \
		    $$i ${DESTDIR}/usr/include"; \
		echo $$j; \
		eval "$$j"; \
	done

all: ${PC_FILES}
${PC_FILES}: zlib.h
	/bin/sh ${.CURDIR}/generate_pkgconfig.sh -c ${.CURDIR} -o ${.OBJDIR}

beforeinstall:
	${INSTALL} ${INSTALL_COPY} -o root -g ${SHAREGRP} \
	    -m ${SHAREMODE} ${.OBJDIR}/${PC_FILES} ${DESTDIR}/usr/lib/pkgconfig/

.include <bsd.lib.mk>
@


1.19
log
@only regen pkg-config files when required; ok jasper
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.18 2016/03/30 06:38:43 jmc Exp $
d22 1
d26 1
a26 1
beforeinstall: ${PC_FILES}
@


1.18
log
@for some time now mandoc has not required MLINKS to function
correctly - logically complete that now by removing MLINKS from base;

authors need only to ensure there is an entry in NAME for any function/
util being added. MLINKS will still work, and remain for perl to ease
upgrades;

ok nicm (curses) bcook (ssl)
ok schwarze, who provided a lot of feedback and assistance
ok tb natano jung
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.17 2012/08/02 13:38:39 okan Exp $
d22 1
a22 1
beforeinstall:
d24 2
@


1.17
log
@remove leftover NOLINT, WANTLINT, LINTFLAGS, LOBJ vars and lint targets.

ok guenther@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.16 2011/05/26 13:52:55 jasper Exp $
a7 30
MLINKS=	compress.3 zlibVersion.3 compress.3 deflateInit.3 \
	compress.3 deflate.3 compress.3 deflateEnd.3 \
	compress.3 inflateInit.3 compress.3 inflate.3 \
	compress.3 inflateEnd.3 compress.3 deflateInit2.3 \
	compress.3 deflateSetDictionary.3 \
	compress.3 deflateCopy.3 compress.3 deflateReset.3 \
	compress.3 deflateParams.3 compress.3 deflateTune.3 \
	compress.3 deflateBound.3 \
	compress.3 deflatePrime.3 compress.3 deflateSetHeader.3 \
	compress.3 inflateInit2.3 \
	compress.3 inflateSetDictionary.3 compress.3 inflateSync.3 \
	compress.3 inflateCopy.3 compress.3 inflateReset.3 \
	compress.3 inflatePrime.3 compress.3 inflateGetHeader.3 \
	compress.3 inflateBackInit.3 compress.3 inflateBack.3 \
	compress.3 inflateBackEnd.3 compress.3 zlibCompileFlags.3 \
	compress.3 compress2.3 compress.3 compressBound.3 \
	compress.3 uncompress.3 compress.3 gzopen.3 \
	compress.3 gzdopen.3 compress.3 gzsetparams.3 \
	compress.3 gzread.3 compress.3 gzwrite.3 \
	compress.3 gzprintf.3 compress.3 gzputs.3 \
	compress.3 gzgets.3 compress.3 gzputc.3 \
	compress.3 gzgetc.3 compress.3 gzungetc.3 \
	compress.3 gzflush.3 \
	compress.3 gzseek.3 compress.3 gzrewind.3 \
	compress.3 gztell.3 compress.3 gzeof.3 \
	compress.3 gzdirect.3 \
	compress.3 gzclose.3 compress.3 gzerror.3 \
	compress.3 gzclearerr.3 \
	compress.3 adler32.3 compress.3 adler32_combine.3 \
	compress.3 crc32.3 compress.3 crc32_combine.3
@


1.16
log
@remove hack to test and create /usr/lib/pkgconfig/ if needed, it's been six
months since it was introduced so it's safe to assume people have this dir now.

    ok deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.15 2011/05/04 07:36:38 jasper Exp $
a3 1
WANTLINT=
@


1.15
log
@Add a zlib.pc pkg-config file, based what newer zlibs ship.
tested by landry@@ in a bulk.
ok miod@@ sthen@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.14 2005/11/24 20:49:23 deraadt Exp $
a54 2
	[ -d ${DESTDIR}/usr/lib/pkgconfig/ ] || \
		${INSTALL} -o root -g ${SHAREGRP} -d ${DESTDIR}/usr/lib/pkgconfig/
@


1.14
log
@use WANTLINT= (on all architectures)
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.13 2005/07/20 21:29:00 jmc Exp $
d41 3
d52 7
@


1.13
log
@add MLINKS for new(ly documented) functions;
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.12 2003/12/17 14:06:45 jmc Exp $
d4 1
@


1.12
log
@add MLINKS for new functions;
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.11 2003/12/17 01:15:25 millert Exp $
d14 4
a17 2
	compress.3 deflateParams.3 compress.3 deflateBound.3 \
	compress.3 deflatePrime.3 compress.3 inflateInit2.3 \
d20 1
d33 1
d36 2
a37 1
	compress.3 adler32.3 compress.3 crc32.3
@


1.11
log
@HAVE_UNISTD_H is unused; nuke it
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.10 2003/12/16 22:33:02 henning Exp $
d14 2
a15 1
	compress.3 deflateParams.3 compress.3 inflateInit2.3 \
d17 4
a20 1
	compress.3 inflateReset.3 compress.3 compress2.3 \
d26 2
a27 1
	compress.3 gzgetc.3 compress.3 gzflush.3 \
d31 2
a32 1
	compress.3 adler32.3 compress.3 crc32.3 
@


1.10
log
@update to zlib 1.2.1

ok millert@@ deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.9 2003/10/01 09:07:14 jmc Exp $
d27 1
a27 2
CFLAGS+=-DHAVE_UNISTD_H -DHAVE_STRERROR -DHAVE_MEMCPY -DHAS_vsnprintf \
	-DHAS_snprintf
@


1.9
log
@oops, didn't change the Makefile.
add MLINKS to compress.3.

rescued by deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.8 2003/09/25 09:12:09 jmc Exp $
d5 2
a6 3
SRCS=	adler32.c compress.c crc32.c deflate.c gzio.c infblock.c \
	infcodes.c inffast.c inflate.c inftrees.c infutil.c trees.c \
	uncompr.c zutil.c
@


1.8
log
@add man page for zlib(3). This is basically an mdoc version of <zlib.h>.
ok henning@@ deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.7 2003/02/26 18:13:22 millert Exp $
d8 20
a27 1
MAN=	zlib.3
@


1.7
log
@Define HAS_snprintf too; deraadt@@ OK
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.6 2003/02/23 23:17:01 deraadt Exp $
d8 1
a8 1
NOMAN=	noman
@


1.6
log
@define HAS_vsnprintf
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.5 1998/08/08 20:57:04 millert Exp $
d9 2
a10 1
CFLAGS+=-DHAVE_UNISTD_H -DHAVE_STRERROR -DHAVE_MEMCPY -DHAS_vsnprintf
@


1.5
log
@zlib 1.1.3
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.4 1997/04/27 20:56:20 millert Exp $
d9 1
a9 1
CFLAGS+=-DHAVE_UNISTD_H -DHAVE_STRERROR -DHAVE_MEMCPY
@


1.5.18.1
log
@Pull patch from current:
define HAS_vsnprintf and HAS_snprintf.

deraadt@@ millert@@ ok
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.5 1998/08/08 20:57:04 millert Exp $
d9 1
a9 2
CFLAGS+=-DHAVE_UNISTD_H -DHAVE_STRERROR -DHAVE_MEMCPY -DHAS_vsnprintf \
	-DHAS_snprintf
@


1.4
log
@COPY -> INSTALL_COPY and STRIP -> INSTALL_STRIP
This fixes namespace problems where STRIP is sometimes used as
the name of the strip(1) to use and other times used as
the flag to send install(1) when stripping (or not).
COPY doesn't have this problem (yet) but was poorly named.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.3 1996/12/08 15:22:35 downsj Exp $
d9 1
@


1.3
log
@install -> ${INSTALL}, -c -> ${COPY}
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.2 1996/07/27 22:26:38 tholo Exp $
d13 2
a14 2
		    ${INSTALL} ${COPY} -o ${BINOWN} -g ${BINGRP} -m 444 $$i \
		    ${DESTDIR}/usr/include"; \
@


1.2
log
@Fix typos on install of include files
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.1 1996/07/27 02:39:42 tholo Exp $
d13 1
a13 1
		    install -c -o ${BINOWN} -g ${BINGRP} -m 444 $$i \
@


1.1
log
@Integrate zlib v1.0.3
@
text
@d1 1
a1 1
#	$OpenBSD$
d13 1
a13 1
		    install -c -o ${BINOWN} -g ${BINGRP} 0m 444 $$i \
d15 1
a15 1
		echo $$jl \
@
