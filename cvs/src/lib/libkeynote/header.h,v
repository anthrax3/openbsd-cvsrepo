head	1.10;
access;
symbols
	OPENBSD_6_1:1.10.0.52
	OPENBSD_6_1_BASE:1.10
	OPENBSD_6_0:1.10.0.50
	OPENBSD_6_0_BASE:1.10
	OPENBSD_5_9:1.10.0.46
	OPENBSD_5_9_BASE:1.10
	OPENBSD_5_8:1.10.0.48
	OPENBSD_5_8_BASE:1.10
	OPENBSD_5_7:1.10.0.40
	OPENBSD_5_7_BASE:1.10
	OPENBSD_5_6:1.10.0.44
	OPENBSD_5_6_BASE:1.10
	OPENBSD_5_5:1.10.0.42
	OPENBSD_5_5_BASE:1.10
	OPENBSD_5_4:1.10.0.38
	OPENBSD_5_4_BASE:1.10
	OPENBSD_5_3:1.10.0.36
	OPENBSD_5_3_BASE:1.10
	OPENBSD_5_2:1.10.0.34
	OPENBSD_5_2_BASE:1.10
	OPENBSD_5_1_BASE:1.10
	OPENBSD_5_1:1.10.0.32
	OPENBSD_5_0:1.10.0.30
	OPENBSD_5_0_BASE:1.10
	OPENBSD_4_9:1.10.0.28
	OPENBSD_4_9_BASE:1.10
	OPENBSD_4_8:1.10.0.26
	OPENBSD_4_8_BASE:1.10
	OPENBSD_4_7:1.10.0.22
	OPENBSD_4_7_BASE:1.10
	OPENBSD_4_6:1.10.0.24
	OPENBSD_4_6_BASE:1.10
	OPENBSD_4_5:1.10.0.20
	OPENBSD_4_5_BASE:1.10
	OPENBSD_4_4:1.10.0.18
	OPENBSD_4_4_BASE:1.10
	OPENBSD_4_3:1.10.0.16
	OPENBSD_4_3_BASE:1.10
	OPENBSD_4_2:1.10.0.14
	OPENBSD_4_2_BASE:1.10
	OPENBSD_4_1:1.10.0.12
	OPENBSD_4_1_BASE:1.10
	OPENBSD_4_0:1.10.0.10
	OPENBSD_4_0_BASE:1.10
	OPENBSD_3_9:1.10.0.8
	OPENBSD_3_9_BASE:1.10
	OPENBSD_3_8:1.10.0.6
	OPENBSD_3_8_BASE:1.10
	OPENBSD_3_7:1.10.0.4
	OPENBSD_3_7_BASE:1.10
	OPENBSD_3_6:1.10.0.2
	OPENBSD_3_6_BASE:1.10
	OPENBSD_3_5:1.8.0.4
	OPENBSD_3_5_BASE:1.8
	OPENBSD_3_4:1.8.0.2
	OPENBSD_3_4_BASE:1.8
	OPENBSD_3_3:1.7.0.8
	OPENBSD_3_3_BASE:1.7
	OPENBSD_3_2:1.7.0.6
	OPENBSD_3_2_BASE:1.7
	OPENBSD_3_1:1.7.0.4
	OPENBSD_3_1_BASE:1.7
	OPENBSD_3_0:1.7.0.2
	OPENBSD_3_0_BASE:1.7
	OPENBSD_2_9:1.6.0.4
	OPENBSD_2_9_BASE:1.6
	OPENBSD_2_8:1.6.0.2
	OPENBSD_2_8_BASE:1.6
	OPENBSD_2_7:1.5.0.2
	OPENBSD_2_7_BASE:1.5
	OPENBSD_2_6:1.4.0.2
	OPENBSD_2_6_BASE:1.4;
locks; strict;
comment	@ * @;


1.10
date	2004.06.29.11.35.56;	author msf;	state Exp;
branches;
next	1.9;

1.9
date	2004.06.25.05.06.49;	author msf;	state Exp;
branches;
next	1.8;

1.8
date	2003.06.26.23.19.53;	author deraadt;	state Exp;
branches;
next	1.7;

1.7
date	2001.09.03.20.14.51;	author deraadt;	state Exp;
branches;
next	1.6;

1.6
date	2000.09.26.23.28.46;	author angelos;	state Exp;
branches;
next	1.5;

1.5
date	99.10.26.22.31.38;	author angelos;	state Exp;
branches;
next	1.4;

1.4
date	99.10.09.19.47.31;	author angelos;	state Exp;
branches;
next	1.3;

1.3
date	99.10.09.06.59.37;	author angelos;	state Exp;
branches;
next	1.2;

1.2
date	99.10.01.01.08.30;	author angelos;	state Exp;
branches;
next	1.1;

1.1
date	99.05.31.20.09.59;	author angelos;	state Exp;
branches;
next	;


desc
@@


1.10
log
@Header cleanup.
ok hshoexer@@
@
text
@/* $OpenBSD: header.h,v 1.9 2004/06/25 05:06:49 msf Exp $ */
/*
 * The author of this code is Angelos D. Keromytis (angelos@@dsl.cis.upenn.edu)
 *
 * This code was written by Angelos D. Keromytis in Philadelphia, PA, USA,
 * in April-May 1998
 *
 * Copyright (C) 1998, 1999 by Angelos D. Keromytis.
 *	
 * Permission to use, copy, and modify this software with or without fee
 * is hereby granted, provided that this entire notice is included in
 * all copies of any software which is or includes a copy or
 * modification of this software. 
 *
 * THIS SOFTWARE IS BEING PROVIDED "AS IS", WITHOUT ANY EXPRESS OR
 * IMPLIED WARRANTY. IN PARTICULAR, THE AUTHORS MAKES NO
 * REPRESENTATION OR WARRANTY OF ANY KIND CONCERNING THE
 * MERCHANTABILITY OF THIS SOFTWARE OR ITS FITNESS FOR ANY PARTICULAR
 * PURPOSE.
 */

#ifndef _HEADER_H_
#define _HEADER_H_

/* Functions */
extern void keynote_sign(int, char **), keynote_sigver(int, char **);
extern void keynote_verify(int, char **), keynote_keygen(int, char **);
extern void print_key(FILE *, char *, char *, int, int);
extern void print_space(FILE *, int);
extern int read_environment(char *);
extern void parse_key(char *);
extern int kvparse(void), kvlex(void);
extern void kverror(char *);

/* Variables */
int sessid;

/* Defines */
#define SEED_LEN        40
#define DEFAULT_PUBLIC  0x10001

#define KEY_PRINT_OFFSET      12
#define KEY_PRINT_LENGTH      50

#define SIG_PRINT_OFFSET      12
#define SIG_PRINT_LENGTH      50
#endif /* _HEADER_H_ */
@


1.9
log
@Make crufty configure stuff go away. Remove all unused code paths.
No change in binaries.

ok millert@@ deraadt@@ hshoexer@@
@
text
@d1 1
a1 1
/* $OpenBSD: header.h,v 1.8 2003/06/26 23:19:53 deraadt Exp $ */
a46 14

/* Includes */
#include <sys/types.h>

#include <regex.h>
#include <openssl/crypto.h>
#include <openssl/dsa.h>
#include <openssl/rsa.h>
#include <openssl/sha.h>
#include <openssl/md5.h>
#include <openssl/err.h>
#include <openssl/rand.h>
#include <openssl/x509.h>
#include <openssl/pem.h>
@


1.8
log
@simple protos
@
text
@d1 1
a1 1
/* $OpenBSD: header.h,v 1.7 2001/09/03 20:14:51 deraadt Exp $ */
a47 20
#if !defined(HAVE_STRCASECMP) && defined(HAVE_STRICMP)
#define strcasecmp stricmp
#endif /* !HAVE_STRCASECMP && HAVE_STRICMP */

#if !defined(HAVE_STRNCASECMP) && defined(HAVE_STRNICMP)
#define strncasecmp strnicmp
#endif /* !HAVE_STRNCASECMP && HAVE_STRNICMP */

#if !defined(HAVE_OPEN) && defined(HAVE__OPEN)
#define open _open
#endif /* !HAVE_OPEN && HAVE__OPEN */

#if !defined(HAVE_READ) && defined(HAVE__READ)
#define read _read
#endif /* !HAVE_READ && HAVE__OPEN */

#if !defined(HAVE_CLOSE) && defined(HAVE__CLOSE)
#define close _close
#endif /* !HAVE_CLOSE && HAVE__CLOSE */

a48 1
#if HAVE_REGEX_H
d50 1
a51 4
#endif /* HAVE_REGEX_H */

#if defined(CRYPTO)
#if defined(HAVE_OPENSSL_CRYPTO_H)
a60 25
#elif defined(HAVE_SSL_CRYPTO_H)
#include <ssl/crypto.h>
#include <ssl/dsa.h>
#include <ssl/rsa.h>
#include <ssl/sha.h>
#include <ssl/md5.h>
#include <ssl/err.h>
#include <ssl/rand.h>
#include <ssl/x509.h>
#include <ssl/pem.h>
#elif defined(HAVE_CRYPTO_H)
#include <crypto.h>
#include <dsa.h>
#include <rsa.h>
#include <sha.h>
#include <md5.h>
#include <err.h>
#include <rand.h>
#include <x509.h>
#include <pem.h>
#else /* HAVE_OPENSSL_CRYPTO_H */
#error "SSLeay or OpenSSL not detected!"
#endif /* HAVE_OPENSSL_CRYPTO_H */
#endif /* CRYPTO */

@


1.7
log
@with or without fee; received mail permitting this change from angelos
@
text
@d1 1
a1 1
/* $OpenBSD: header.h,v 1.6 2000/09/26 23:28:46 angelos Exp $ */
d32 1
a32 1
extern int kvparse(), kvlex();
@


1.6
log
@Sync.
@
text
@d1 1
a1 1
/* $OpenBSD$ */
d10 1
a10 1
 * Permission to use, copy, and modify this software without fee
@


1.5
log
@sync
@
text
@a39 1
#define RND_BYTES       1024
a66 8

#if defined(CRYPTO)
#if HAVE__DEV_URANDOM
#define KEYNOTERNDFILENAME "/dev/urandom"
#else /* HAVE__DEV_URANDOM */
#error "You need a random device!"
#endif /* HAVE__DEV_URANDOM */
#endif /* CRYPTO */
@


1.4
log
@Roll back yesterday's commit, will wait until after 2.6.
@
text
@d1 1
a1 1
/* $OpenBSD: header.h,v 1.2 1999/10/01 01:08:30 angelos Exp $ */
a28 1
extern void mystrncpy(char *, char *, int);
d41 1
a41 1
#define DEFAULT_PUBLIC    0x10001
d48 71
@


1.3
log
@Move all ifdefs in header.h (instead of keynote.h), include header.h
in all files including keynote.h, update manpage.
@
text
@d1 1
a1 1
/* $OpenBSD$ */
d29 1
d42 1
a42 1
#define DEFAULT_PUBLIC  0x10001
a48 61

#if !defined(HAVE_STRCASECMP) && defined(HAVE_STRICMP)
#define strcasecmp stricmp
#endif /* !HAVE_STRCASECMP && HAVE_STRICMP */

#if !defined(HAVE_STRNCASECMP) && defined(HAVE_STRNICMP)
#define strncasecmp strnicmp
#endif /* !HAVE_STRNCASECMP && HAVE_STRNICMP */

#if !defined(HAVE_OPEN) && defined(HAVE__OPEN)
#define open _open
#endif /* !HAVE_OPEN && HAVE__OPEN */

#if !defined(HAVE_READ) && defined(HAVE__READ)
#define read _read
#endif /* !HAVE_READ && HAVE__OPEN */

#if !defined(HAVE_CLOSE) && defined(HAVE__CLOSE)
#define close _close
#endif /* !HAVE_CLOSE && HAVE__CLOSE */

#if defined(CRYPTO)
#if HAVE__DEV_URANDOM
#define KEYNOTERNDFILENAME "/dev/urandom"
#else /* HAVE__DEV_URANDOM */
#error "You need a random device!"
#endif /* HAVE__DEV_URANDOM */
#endif /* CRYPTO */

/* Includes */
#if HAVE_REGEX_H
#include <sys/types.h>
#include <regex.h>
#endif /* HAVE_REGEX_H */

#if defined(CRYPTO)
#if HAVE_OPENSSL_CRYPTO_H
#include <openssl/crypto.h>
#include <openssl/dsa.h>
#include <openssl/rsa.h>
#include <openssl/sha.h>
#include <openssl/md5.h>
#include <openssl/err.h>
#include <openssl/rand.h>
#include <openssl/x509.h>
#include <openssl/pem.h>
#elif HAVE_SSL_CRYPTO_H
#include <ssl/crypto.h>
#include <ssl/dsa.h>
#include <ssl/rsa.h>
#include <ssl/sha.h>
#include <ssl/md5.h>
#include <ssl/err.h>
#include <ssl/rand.h>
#include <ssl/x509.h>
#include <ssl/pem.h>
#else /* HAVE_OPENSSL_CRYPTO_H */
#error "SSLeay or OpenSSL not detected!"
#endif /* HAVE_OPENSSL_CRYPTO_H */
#endif /* CRYPTO */

@


1.2
log
@Update for version 2.0
@
text
@a28 1
extern void mystrncpy(char *, char *, int);
d41 1
a41 1
#define DEFAULT_PUBLIC    0x10001
d48 61
@


1.1
log
@Sanitize prototypes and variable extern definitions, remove
unnecessary header file, add prototypes header file for utility building.
@
text
@d26 2
a27 2
extern int keynote_sign(int, char **), keynote_sigver(int, char **);
extern int keynote_verify(int, char **), keynote_keygen(int, char **);
@

