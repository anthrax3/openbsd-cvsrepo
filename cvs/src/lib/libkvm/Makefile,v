head	1.18;
access;
symbols
	OPENBSD_6_2:1.18.0.8
	OPENBSD_6_2_BASE:1.18
	OPENBSD_6_1:1.18.0.6
	OPENBSD_6_1_BASE:1.18
	OPENBSD_6_0:1.18.0.2
	OPENBSD_6_0_BASE:1.18
	OPENBSD_5_9:1.17.0.8
	OPENBSD_5_9_BASE:1.17
	OPENBSD_5_8:1.17.0.10
	OPENBSD_5_8_BASE:1.17
	OPENBSD_5_7:1.17.0.2
	OPENBSD_5_7_BASE:1.17
	OPENBSD_5_6:1.17.0.6
	OPENBSD_5_6_BASE:1.17
	OPENBSD_5_5:1.17.0.4
	OPENBSD_5_5_BASE:1.17
	OPENBSD_5_4:1.16.0.4
	OPENBSD_5_4_BASE:1.16
	OPENBSD_5_3:1.16.0.2
	OPENBSD_5_3_BASE:1.16
	OPENBSD_5_2:1.15.0.4
	OPENBSD_5_2_BASE:1.15
	OPENBSD_5_1_BASE:1.15
	OPENBSD_5_1:1.15.0.2
	OPENBSD_5_0:1.14.0.8
	OPENBSD_5_0_BASE:1.14
	OPENBSD_4_9:1.14.0.6
	OPENBSD_4_9_BASE:1.14
	OPENBSD_4_8:1.14.0.4
	OPENBSD_4_8_BASE:1.14
	OPENBSD_4_7:1.14.0.2
	OPENBSD_4_7_BASE:1.14
	OPENBSD_4_6:1.11.0.4
	OPENBSD_4_6_BASE:1.11
	OPENBSD_4_5:1.8.0.14
	OPENBSD_4_5_BASE:1.8
	OPENBSD_4_4:1.8.0.12
	OPENBSD_4_4_BASE:1.8
	OPENBSD_4_3:1.8.0.10
	OPENBSD_4_3_BASE:1.8
	OPENBSD_4_2:1.8.0.8
	OPENBSD_4_2_BASE:1.8
	OPENBSD_4_1:1.8.0.6
	OPENBSD_4_1_BASE:1.8
	OPENBSD_4_0:1.8.0.4
	OPENBSD_4_0_BASE:1.8
	OPENBSD_3_9:1.8.0.2
	OPENBSD_3_9_BASE:1.8
	OPENBSD_3_8:1.7.0.8
	OPENBSD_3_8_BASE:1.7
	OPENBSD_3_7:1.7.0.6
	OPENBSD_3_7_BASE:1.7
	OPENBSD_3_6:1.7.0.4
	OPENBSD_3_6_BASE:1.7
	OPENBSD_3_5:1.7.0.2
	OPENBSD_3_5_BASE:1.7
	OPENBSD_3_4:1.6.0.10
	OPENBSD_3_4_BASE:1.6
	OPENBSD_3_3:1.6.0.8
	OPENBSD_3_3_BASE:1.6
	OPENBSD_3_2:1.6.0.6
	OPENBSD_3_2_BASE:1.6
	OPENBSD_3_1:1.6.0.4
	OPENBSD_3_1_BASE:1.6
	OPENBSD_3_0:1.6.0.2
	OPENBSD_3_0_BASE:1.6
	OPENBSD_2_9:1.5.0.4
	OPENBSD_2_9_BASE:1.5
	OPENBSD_2_8:1.5.0.2
	OPENBSD_2_8_BASE:1.5
	OPENBSD_2_7:1.4.0.4
	OPENBSD_2_7_BASE:1.4
	OPENBSD_2_6:1.4.0.2
	OPENBSD_2_6_BASE:1.4
	OPENBSD_2_5:1.2.0.12
	OPENBSD_2_5_BASE:1.2
	OPENBSD_2_4:1.2.0.10
	OPENBSD_2_4_BASE:1.2
	OPENBSD_2_3:1.2.0.8
	OPENBSD_2_3_BASE:1.2
	OPENBSD_2_2:1.2.0.6
	OPENBSD_2_2_BASE:1.2
	OPENBSD_2_1:1.2.0.4
	OPENBSD_2_1_BASE:1.2
	OPENBSD_2_0:1.2.0.2
	OPENBSD_2_0_BASE:1.2
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@# @;


1.18
date	2016.03.30.06.38.42;	author jmc;	state Exp;
branches;
next	1.17;
commitid	LN9ijdk9SEnzWAbM;

1.17
date	2013.10.22.16.40.26;	author guenther;	state Exp;
branches;
next	1.16;

1.16
date	2012.08.02.13.38.38;	author okan;	state Exp;
branches;
next	1.15;

1.15
date	2012.01.07.05.38.12;	author guenther;	state Exp;
branches;
next	1.14;

1.14
date	2010.02.03.20.49.00;	author miod;	state Exp;
branches;
next	1.13;

1.13
date	2010.01.10.03.37.50;	author guenther;	state Exp;
branches;
next	1.12;

1.12
date	2009.10.28.00.04.26;	author deraadt;	state Exp;
branches;
next	1.11;

1.11
date	2009.06.24.13.04.24;	author millert;	state Exp;
branches;
next	1.10;

1.10
date	2009.06.20.19.50.05;	author millert;	state Exp;
branches;
next	1.9;

1.9
date	2009.06.07.03.09.34;	author millert;	state Exp;
branches;
next	1.8;

1.8
date	2005.11.24.20.49.18;	author deraadt;	state Exp;
branches;
next	1.7;

1.7
date	2004.01.08.04.59.10;	author millert;	state Exp;
branches;
next	1.6;

1.6
date	2001.06.27.06.16.45;	author art;	state Exp;
branches;
next	1.5;

1.5
date	2000.09.03.18.41.13;	author espie;	state Exp;
branches;
next	1.4;

1.4
date	99.06.22.14.40.50;	author art;	state Exp;
branches;
next	1.3;

1.3
date	99.06.22.12.54.45;	author art;	state Exp;
branches;
next	1.2;

1.2
date	96.05.05.14.56.34;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.42.43;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.42.43;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.18
log
@for some time now mandoc has not required MLINKS to function
correctly - logically complete that now by removing MLINKS from base;

authors need only to ensure there is an entry in NAME for any function/
util being added. MLINKS will still work, and remain for perl to ease
upgrades;

ok nicm (curses) bcook (ssl)
ok schwarze, who provided a lot of feedback and assistance
ok tb natano jung
@
text
@#	$OpenBSD: Makefile,v 1.17 2013/10/22 16:40:26 guenther Exp $
#	$NetBSD: Makefile,v 1.11 1996/03/18 22:33:07 thorpej Exp $
#	from: @@(#)Makefile	8.1 (Berkeley) 6/4/93

LIB=	kvm

# Try most specific name first.
.if	exists(kvm_${MACHINE}.c)
SRCS=	kvm_${MACHINE}.c
.else
# Less specific name (i.e. m68k)
.if	exists(kvm_${MACHINE_ARCH}.c)
SRCS=	kvm_${MACHINE_ARCH}.c
.else
# Even less specific name (i.e. mips64)
CFLAGS+=-D${MACHINE_CPU}
SRCS=	kvm_${MACHINE_CPU}.c
.endif
.endif

CFLAGS+= -D_LIBKVM
SRCS+=	kvm.c kvm_file2.c kvm_getloadavg.c kvm_proc.c kvm_proc2.c \
	kvm_cd9660.c kvm_udf.c kvm_ntfs.c

MAN=	kvm.3 kvm_dump.3 kvm_geterr.3 kvm_getfiles.3 kvm_getloadavg.3 \
	kvm_getprocs.3 kvm_nlist.3 kvm_open.3 kvm_read.3

.include <bsd.lib.mk>
@


1.17
log
@- add UNIX-domain socket info to struct kinfo_file2
- convert netstat from kvm_getfiles() to kvm_getfile2() using that
- delete kvm_getfiles() and KERN_FILE as no longer used (bump libkvm's major)
- rename kvm_getfile2() to kvm_getfiles(), kinfo_file2 to kinfo_file
  and KERN_FILE2 to KERN_FILE.

ok deraadt@@, millert@@
ports scan sthen@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.16 2012/08/02 13:38:38 okan Exp $
a26 6

MLINKS+=kvm_getprocs.3 kvm_getargv.3 kvm_getprocs.3 kvm_getenvv.3
MLINKS+=kvm_open.3 kvm_openfiles.3 kvm_open.3 kvm_close.3
MLINKS+=kvm_read.3 kvm_write.3
MLINKS+=kvm_dump.3 kvm_dump_mkheader.3 kvm_dump.3 kvm_dump_wrtheader.3
MLINKS+=kvm_dump.3 kvm_dump_inval.3
@


1.16
log
@remove leftover NOLINT, WANTLINT, LINTFLAGS, LOBJ vars and lint targets.

ok guenther@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.15 2012/01/07 05:38:12 guenther Exp $
d22 1
a22 1
SRCS+=	kvm.c kvm_file.c kvm_file2.c kvm_getloadavg.c kvm_proc.c kvm_proc2.c \
a28 1
MLINKS+=kvm_getfiles.3 kvm_getfile2.3
@


1.15
log
@Add rtable id and thread id to struct kinfo_proc (and fix process id)
and add an 'rtableid' keyword to ps.

Add rtable id, thread id, and socket splice info to struct kinfo_file2
and make fstat display socket splice information.

Remove old KVM_PROC2 and kinfo_proc2 interfaces; bump libkvm major

Socket splice info and corrections from bluhm@@  "Lovely" deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.14 2010/02/03 20:49:00 miod Exp $
a5 1
WANTLINT=
@


1.14
log
@Use MACHINE_CPU instead of MACHINE_ARCH to pick the correct machine dependent
files or directories when applicable.
The inspiration and name of MACHINE_CPU come from NetBSD, although the way to
provide it to Makefiles is completely different.
ok kettenis@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.13 2010/01/10 03:37:50 guenther Exp $
a29 2
MLINKS+=kvm_getprocs.3 kvm_getproc2.3
MLINKS+=kvm_getprocs.3 kvm_getargv2.3 kvm_getprocs.3 kvm_getenvv2.3
@


1.13
log
@Reimplement kvm_getproc2()'s support for reading crash dumps and
/dev/mem to be direct instead of going through kvm_getprocs(), as
that function is going to get more an more broken as we move stuff
from struct proc to struct process for rthreads.  To minimize the
code copying, put the common logic of filling in a kinfo_proc2
structure into a macro FILL_KPROC2() in <sys/sysctl.h> for use from
both the kernel and user-space.  This also hides the KERN_PROC
#define behind "#if defined(_KERNEL)||defined(_LIBKVM)", as it's
deprecated.

Positive feedback from millert and blambert; so committing to unblock
further rthreads work.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.12 2009/10/28 00:04:26 deraadt Exp $
d13 1
a13 1
CFLAGS+=-D${MACHINE}
d15 5
@


1.12
log
@Do not need -DLIBC_SCCS anymore
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.11 2009/06/24 13:04:24 millert Exp $
d17 2
a18 1
SRCS+=	kvm.c kvm_file.c kvm_file2.c kvm_getloadavg.c kvm_proc.c \
@


1.11
log
@Install ntfs includes and add libkvm (fstat) support.  ntfs bits
adapted from NetBSD fstat.  OK deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.10 2009/06/20 19:50:05 millert Exp $
a6 1
CFLAGS+=-DLIBC_SCCS
@


1.10
log
@Split out cd9660 bits into their own .c file to avoid #define collisions
with ufs and add also udf support.  OK miod@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.9 2009/06/07 03:09:34 millert Exp $
d19 1
a19 1
	kvm_cd9660.c kvm_udf.c
@


1.9
log
@Add kvm_getfile2 which uses KERN_FILE2 when possible, falling
back on kmem grovelling for non-live kernels.  OK deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.8 2005/11/24 20:49:18 deraadt Exp $
d18 2
a19 1
SRCS+=	kvm.c kvm_file.c kvm_file2.c kvm_getloadavg.c kvm_proc.c
@


1.8
log
@use WANTLINT= (on all architectures)
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.7 2004/01/08 04:59:10 millert Exp $
d18 1
a18 1
SRCS+=	kvm.c kvm_file.c kvm_getloadavg.c kvm_proc.c
d26 1
@


1.7
log
@Add MLINKs for kvm_getproc2() and friends.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.6 2001/06/27 06:16:45 art Exp $
d6 1
@


1.6
log
@UVM is no longer an option
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.5 2000/09/03 18:41:13 espie Exp $
d23 2
@


1.5
log
@Boring...  Add :L modifier to all tweakable variables tests.

Closes PR 1246
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.4 1999/06/22 14:40:50 art Exp $
a28 4

.if (${UVM:L} == "yes")
CFLAGS+=-DUVM
.endif
@


1.4
log
@do it right this time
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.3 1999/06/22 12:54:45 art Exp $
d30 1
a30 1
.if (${UVM} == "yes")
@


1.3
log
@UVM support + some cleanup
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.2 1996/05/05 14:56:34 deraadt Exp $
d30 1
a30 1
.if defined(UVM)
d32 1
a32 1
.endif@


1.2
log
@sync with 0430
@
text
@d1 1
a1 1
#	$OpenBSD$
d29 4
@


1.1
log
@Initial revision
@
text
@d1 2
a3 1
#	$Id: Makefile,v 1.9 1994/12/22 09:58:28 cgd Exp $
d19 2
a20 2
MAN=	kvm.3 kvm_geterr.3 kvm_getfiles.3 kvm_getloadavg.3 kvm_getprocs.3 \
	kvm_nlist.3 kvm_open.3 kvm_read.3
d25 2
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
