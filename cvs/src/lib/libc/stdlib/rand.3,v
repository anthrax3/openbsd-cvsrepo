head	1.19;
access;
symbols
	OPENBSD_6_2:1.19.0.14
	OPENBSD_6_2_BASE:1.19
	OPENBSD_6_1:1.19.0.12
	OPENBSD_6_1_BASE:1.19
	OPENBSD_6_0:1.19.0.8
	OPENBSD_6_0_BASE:1.19
	OPENBSD_5_9:1.19.0.4
	OPENBSD_5_9_BASE:1.19
	OPENBSD_5_8:1.19.0.6
	OPENBSD_5_8_BASE:1.19
	OPENBSD_5_7:1.19.0.2
	OPENBSD_5_7_BASE:1.19
	OPENBSD_5_6:1.16.0.4
	OPENBSD_5_6_BASE:1.16
	OPENBSD_5_5:1.14.0.4
	OPENBSD_5_5_BASE:1.14
	OPENBSD_5_4:1.13.0.2
	OPENBSD_5_4_BASE:1.13
	OPENBSD_5_3:1.11.0.4
	OPENBSD_5_3_BASE:1.11
	OPENBSD_5_2:1.11.0.2
	OPENBSD_5_2_BASE:1.11
	OPENBSD_5_1_BASE:1.10
	OPENBSD_5_1:1.10.0.20
	OPENBSD_5_0:1.10.0.18
	OPENBSD_5_0_BASE:1.10
	OPENBSD_4_9:1.10.0.16
	OPENBSD_4_9_BASE:1.10
	OPENBSD_4_8:1.10.0.14
	OPENBSD_4_8_BASE:1.10
	OPENBSD_4_7:1.10.0.10
	OPENBSD_4_7_BASE:1.10
	OPENBSD_4_6:1.10.0.12
	OPENBSD_4_6_BASE:1.10
	OPENBSD_4_5:1.10.0.8
	OPENBSD_4_5_BASE:1.10
	OPENBSD_4_4:1.10.0.6
	OPENBSD_4_4_BASE:1.10
	OPENBSD_4_3:1.10.0.4
	OPENBSD_4_3_BASE:1.10
	OPENBSD_4_2:1.10.0.2
	OPENBSD_4_2_BASE:1.10
	OPENBSD_4_1:1.9.0.16
	OPENBSD_4_1_BASE:1.9
	OPENBSD_4_0:1.9.0.14
	OPENBSD_4_0_BASE:1.9
	OPENBSD_3_9:1.9.0.12
	OPENBSD_3_9_BASE:1.9
	OPENBSD_3_8:1.9.0.10
	OPENBSD_3_8_BASE:1.9
	OPENBSD_3_7:1.9.0.8
	OPENBSD_3_7_BASE:1.9
	OPENBSD_3_6:1.9.0.6
	OPENBSD_3_6_BASE:1.9
	OPENBSD_3_5:1.9.0.4
	OPENBSD_3_5_BASE:1.9
	OPENBSD_3_4:1.9.0.2
	OPENBSD_3_4_BASE:1.9
	OPENBSD_3_3:1.8.0.8
	OPENBSD_3_3_BASE:1.8
	OPENBSD_3_2:1.8.0.6
	OPENBSD_3_2_BASE:1.8
	OPENBSD_3_1:1.8.0.4
	OPENBSD_3_1_BASE:1.8
	OPENBSD_3_0:1.8.0.2
	OPENBSD_3_0_BASE:1.8
	OPENBSD_2_9:1.7.0.6
	OPENBSD_2_9_BASE:1.7
	OPENBSD_2_8:1.7.0.4
	OPENBSD_2_8_BASE:1.7
	OPENBSD_2_7:1.7.0.2
	OPENBSD_2_7_BASE:1.7
	OPENBSD_2_6:1.6.0.2
	OPENBSD_2_6_BASE:1.6
	OPENBSD_2_5:1.5.0.2
	OPENBSD_2_5_BASE:1.5
	OPENBSD_2_4:1.4.0.2
	OPENBSD_2_4_BASE:1.4
	OPENBSD_2_3:1.2.0.8
	OPENBSD_2_3_BASE:1.2
	OPENBSD_2_2:1.2.0.6
	OPENBSD_2_2_BASE:1.2
	OPENBSD_2_1:1.2.0.4
	OPENBSD_2_1_BASE:1.2
	OPENBSD_2_0:1.2.0.2
	OPENBSD_2_0_BASE:1.2
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@.\" @;


1.19
date	2014.12.09.21.55.39;	author jmc;	state Exp;
branches;
next	1.18;
commitid	go4TdFkYZaqGALfz;

1.18
date	2014.12.08.21.45.20;	author deraadt;	state Exp;
branches;
next	1.17;
commitid	HpI1xDivwwEoN4ET;

1.17
date	2014.11.25.17.41.12;	author millert;	state Exp;
branches;
next	1.16;
commitid	HmxH8NnWRJNHnrRz;

1.16
date	2014.07.17.23.12.28;	author deraadt;	state Exp;
branches;
next	1.15;
commitid	BMHVMIsKmkHiEHKs;

1.15
date	2014.04.07.17.57.56;	author schwarze;	state Exp;
branches;
next	1.14;

1.14
date	2014.01.21.03.15.45;	author schwarze;	state Exp;
branches;
next	1.13;

1.13
date	2013.07.18.10.14.50;	author schwarze;	state Exp;
branches;
next	1.12;

1.12
date	2013.06.05.03.39.23;	author tedu;	state Exp;
branches;
next	1.11;

1.11
date	2012.06.02.00.14.16;	author guenther;	state Exp;
branches;
next	1.10;

1.10
date	2007.05.31.19.19.31;	author jmc;	state Exp;
branches;
next	1.9;

1.9
date	2003.06.02.20.18.38;	author millert;	state Exp;
branches;
next	1.8;

1.8
date	2001.05.13.23.38.02;	author millert;	state Exp;
branches;
next	1.7;

1.7
date	2000.04.20.13.50.02;	author aaron;	state Exp;
branches;
next	1.6;

1.6
date	99.06.29.18.36.22;	author aaron;	state Exp;
branches;
next	1.5;

1.5
date	98.11.20.11.18.50;	author d;	state Exp;
branches;
next	1.4;

1.4
date	98.07.05.19.54.22;	author millert;	state Exp;
branches;
next	1.3;

1.3
date	98.04.28.07.36.49;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	96.08.19.08.33.44;	author tholo;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.42.19;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.42.19;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.19
log
@Xr and Ox fixes;
@
text
@.\" Copyright (c) 1990, 1991 The Regents of the University of California.
.\" All rights reserved.
.\"
.\" This code is derived from software contributed to Berkeley by
.\" the American National Standards Committee X3, on Information
.\" Processing Systems.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. Neither the name of the University nor the names of its contributors
.\"    may be used to endorse or promote products derived from this software
.\"    without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.\"	$OpenBSD: rand.3,v 1.18 2014/12/08 21:45:20 deraadt Exp $
.\"
.Dd $Mdocdate: December 8 2014 $
.Dt RAND 3
.Os
.Sh NAME
.Nm rand ,
.Nm rand_r ,
.Nm srand ,
.Nm srand_deterministic
.Nd bad pseudo-random number generator
.Sh SYNOPSIS
.In stdlib.h
.Ft void
.Fn srand "unsigned int seed"
.Ft void
.Fn srand_deterministic "unsigned int seed"
.Ft int
.Fn rand void
.Ft int
.Fn rand_r "unsigned int *seed"
.Sh DESCRIPTION
.Bf -symbolic
Standards insist that this interface return deterministic results.
Unsafe usage is very common, so
.Ox
changed the subsystem to return non-deterministic results by default.
.Ef
.Pp
To satisfy portable code,
.Fn srand
may be called to initialize the subsystem.
In
.Ox
the
.Ar seed
variable is ignored, and strong random number results will be provided from
.Xr arc4random 3 .
In other systems, the
.Ar seed
variable primes a simplistic deterministic algorithm.
.Pp
If the standardized behavior is required
.Fn srand_deterministic
can be substituted for
.Fn srand ,
then subsequent
.Fn rand
calls will return results using the deterministic algorithm.
.Pp
The
.Fn rand
function returns a result in the range of 0 to
.Dv RAND_MAX .
By default, this result comes from
.Xr arc4random 3 .
If
.Fn srand_deterministic
was called, the result will be computed using the deterministic algorithm.
.Pp
The
.Fn rand_r
is a thread-safe version of
.Fn rand .
Storage for the seed must be provided through the
.Fa seed
argument, and needs to have been initialized by the caller.
It always operates using the deterministic algorithm.
.Sh SEE ALSO
.Xr arc4random 3 ,
.Xr rand48 3 ,
.Xr random 3
.Sh STANDARDS
The
.Fn rand
function conforms to
.St -ansiC .
.Pp
The
.Fn rand_r
function conforms to
.St -p1003.1-2008 .
.Pp
The
.Fn srand
function does not conform to
.St -ansiC ,
intentionally.
.Pp
The
.Fn srand_deterministic
function is an
.Ox
extension.
.Sh HISTORY
The functions
.Fn rand
and
.Fn srand
first appeared in
.At v3 .
@


1.18
log
@Change rand(), random(), drand48(), lrand48(), mrand48(), and srand48()
to returning strong random by default, source from arc4random(3).
Parameters to the seeding functions are ignored, and the subsystems remain
in strong random mode.  If you wish the standardized deterministic mode,
call srand_deterministic(), srandom_determistic(), srand48_deterministic(),
seed48_deterministic() or lcong48_deterministic() instead.
The re-entrant functions rand_r(), erand48(), nrand48(), jrand48() are
unaffected by this change and remain in deterministic mode (for now).

Verified as a good roadmap forward by auditing 8800 pieces of software.
Roughly 60 pieces of software will need adaptation to request the
deterministic mode.

Violates POSIX and C89, which violate best practice in this century.
ok guenther tedu millert
@
text
@d32 1
a32 1
.\"	$OpenBSD: rand.3,v 1.17 2014/11/25 17:41:12 millert Exp $
d34 1
a34 1
.Dd $Mdocdate: November 25 2014 $
d69 1
a69 1
.Xr arc4random 3.
d123 3
a125 1
function is an OpenBSD extension.
@


1.17
log
@rand() is a pseudo-random number generator
@
text
@d32 1
a32 1
.\"	$OpenBSD: rand.3,v 1.16 2014/07/17 23:12:28 deraadt Exp $
d34 1
a34 1
.Dd $Mdocdate: July 17 2014 $
d40 2
a41 1
.Nm srand
d47 2
d55 4
a58 5
These interfaces are obsoleted by
.Xr random 3 ,
which is also unsafe.
Consider using
.Xr arc4random 3 .
d61 18
a78 1
The
d80 1
a80 5
function computes a sequence of pseudo-random integers in the range
of 0 to
.Dv RAND_MAX
(as defined by the header file
.In stdlib.h ) .
d83 8
a90 10
.Fn srand
function sets its argument as the seed for a new sequence of
pseudo-random numbers to be returned by
.Fn rand .
These sequences are repeatable by calling
.Fn srand
with the same seed value.
.Pp
If no seed value is provided, the functions are automatically
seeded with a value of 1.
d99 1
d107 1
a107 3
and
.Fn srand
functions conform to
d114 10
@


1.16
log
@it is 2014, and we still need to encourage people away from srand()
and random().  Sigh.
@
text
@d32 1
a32 1
.\"	$OpenBSD: rand.3,v 1.15 2014/04/07 17:57:56 schwarze Exp $
d34 1
a34 1
.Dd $Mdocdate: April 7 2014 $
d41 1
a41 1
.Nd bad random number generator
@


1.15
log
@Add some missing names to the NAME sections.
For inet(3), go the other way, remove some bogus symlinks.
Found while testing the new makewhatis(8).
ok jmc@@
@
text
@d32 1
a32 1
.\"	$OpenBSD: rand.3,v 1.14 2014/01/21 03:15:45 schwarze Exp $
d34 1
a34 1
.Dd $Mdocdate: January 21 2014 $
d53 4
a56 1
.Xr random 3 .
@


1.14
log
@obvious .Pa fixes; found with mandocdb(8)
@
text
@d32 1
a32 1
.\"	$OpenBSD: rand.3,v 1.13 2013/07/18 10:14:50 schwarze Exp $
d34 1
a34 1
.Dd $Mdocdate: July 18 2013 $
d39 1
@


1.13
log
@HISTORY; tweaks and ok  sobrado@@ jmc@@
@
text
@d32 1
a32 1
.\"	$OpenBSD: rand.3,v 1.12 2013/06/05 03:39:23 tedu Exp $
d34 1
a34 1
.Dd $Mdocdate: June 5 2013 $
d61 1
a61 1
.Aq Pa stdlib.h ) .
@


1.12
log
@Use the fancy .In macro for includes. From Jan Klemkow. ok jmc schwarze
@
text
@d32 1
a32 1
.\"	$OpenBSD: rand.3,v 1.11 2012/06/02 00:14:16 guenther Exp $
d34 1
a34 1
.Dd $Mdocdate: June 2 2012 $
d98 7
@


1.11
log
@Update STANDARDS section for a few <stdlib.h> functions
Update SYNOPSIS for setkey() to show it's in <stdlib.h>

ok jmc@@, millert@@
@
text
@d32 1
a32 1
.\"	$OpenBSD: rand.3,v 1.10 2007/05/31 19:19:31 jmc Exp $
d34 1
a34 1
.Dd $Mdocdate: May 31 2007 $
d42 1
a42 1
.Fd #include <stdlib.h>
@


1.10
log
@convert to new .Dd format;
@
text
@d32 1
a32 1
.\"	$OpenBSD: rand.3,v 1.9 2003/06/02 20:18:38 millert Exp $
d34 1
a34 1
.Dd $Mdocdate$
d96 2
a97 3
function conforms to ISO/IEC 9945-1 ANSI/IEEE
.Pq Dq Tn POSIX
Std 1003.1c Draft 10.
@


1.9
log
@Remove the advertising clause in the UCB license which Berkeley
rescinded 22 July 1999.  Proofed by myself and Theo.
@
text
@d32 1
a32 1
.\"	$OpenBSD: rand.3,v 1.8 2001/05/13 23:38:02 millert Exp $
d34 1
a34 1
.Dd June 29, 1991
@


1.8
log
@unsigned -> unsigned int; grange@@rt.mipt.ru
@
text
@d16 1
a16 5
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgement:
.\"	This product includes software developed by the University of
.\"	California, Berkeley and its contributors.
.\" 4. Neither the name of the University nor the names of its contributors
d32 1
a32 1
.\"	$OpenBSD: rand.3,v 1.7 2000/04/20 13:50:02 aaron Exp $
@


1.7
log
@Flesh out stdlib function man pages.
@
text
@d36 1
a36 1
.\"	$OpenBSD: rand.3,v 1.6 1999/06/29 18:36:22 aaron Exp $
d48 1
a48 1
.Fn srand "unsigned seed"
@


1.6
log
@first round of repairs on stdlib
@
text
@d36 1
a36 1
.\"	$OpenBSD: rand.3,v 1.5 1998/11/20 11:18:50 d Exp $
d95 1
a95 2
functions
conform to
d100 1
a100 2
function
conforms to ISO/IEC 9945-1 ANSI/IEEE
@


1.5
log
@Add thread-safety to libc, so that libc_r will build (on i386 at least).
All POSIX libc api now there (to P1003.1c/D10)
  (more md stuff is needed for other libc/arch/*)
  (setlogin is no longer a special syscall)
Add -pthread option to gcc (that makes it use -lc_r and -D_POSIX_THREADS).
Doc some re-entrant routines
Add libc_r to intro(3)
dig() uses some libc srcs and an extra -I was needed there.
Add more md stuff to libc_r.
Update includes for the pthreads api
Update libc_r TODO
@
text
@d36 1
a36 1
.\"	$OpenBSD: rand.3,v 1.4 1998/07/05 19:54:22 millert Exp $
d84 1
a84 1
.Ar seed
@


1.4
log
@add .Xr's for all the random functions in libc
@
text
@d36 1
a36 1
.\"	$OpenBSD: rand.3,v 1.3 1998/04/28 07:36:49 deraadt Exp $
d51 2
d78 8
d98 7
@


1.3
log
@use Xr more often
@
text
@d36 1
a36 1
.\"	$OpenBSD: rand.3,v 1.2 1996/08/19 08:33:44 tholo Exp $
d77 2
@


1.2
log
@Fix RCS ids
Make sure everything uses {SYS,}LIBC_SCCS properly
@
text
@d36 1
a36 1
.\"	$OpenBSD: rand.3,v 1.1.1.1 1995/10/18 08:42:19 deraadt Exp $
d53 2
a54 1
These interfaces are obsoleted by random(3).
@


1.1
log
@Initial revision
@
text
@d36 1
a36 2
.\"     from: @@(#)rand.3	6.7 (Berkeley) 6/29/91
.\"	$Id: rand.3,v 1.2 1993/08/01 07:44:20 mycroft Exp $
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
