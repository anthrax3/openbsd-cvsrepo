head	1.30;
access;
symbols
	OPENBSD_6_1:1.30.0.6
	OPENBSD_6_1_BASE:1.30
	OPENBSD_6_0:1.30.0.4
	OPENBSD_6_0_BASE:1.30
	OPENBSD_5_9:1.30.0.2
	OPENBSD_5_9_BASE:1.30
	OPENBSD_5_8:1.29.0.12
	OPENBSD_5_8_BASE:1.29
	OPENBSD_5_7:1.29.0.4
	OPENBSD_5_7_BASE:1.29
	OPENBSD_5_6:1.29.0.8
	OPENBSD_5_6_BASE:1.29
	OPENBSD_5_5:1.29.0.6
	OPENBSD_5_5_BASE:1.29
	OPENBSD_5_4:1.29.0.2
	OPENBSD_5_4_BASE:1.29
	OPENBSD_5_3:1.28.0.2
	OPENBSD_5_3_BASE:1.28
	OPENBSD_5_2:1.27.0.10
	OPENBSD_5_2_BASE:1.27
	OPENBSD_5_1_BASE:1.27
	OPENBSD_5_1:1.27.0.8
	OPENBSD_5_0:1.27.0.6
	OPENBSD_5_0_BASE:1.27
	OPENBSD_4_9:1.27.0.4
	OPENBSD_4_9_BASE:1.27
	OPENBSD_4_8:1.27.0.2
	OPENBSD_4_8_BASE:1.27
	OPENBSD_4_7:1.25.0.2
	OPENBSD_4_7_BASE:1.25
	OPENBSD_4_6:1.24.0.12
	OPENBSD_4_6_BASE:1.24
	OPENBSD_4_5:1.24.0.8
	OPENBSD_4_5_BASE:1.24
	OPENBSD_4_4:1.24.0.6
	OPENBSD_4_4_BASE:1.24
	OPENBSD_4_3:1.24.0.4
	OPENBSD_4_3_BASE:1.24
	OPENBSD_4_2:1.24.0.2
	OPENBSD_4_2_BASE:1.24
	OPENBSD_4_1:1.23.0.6
	OPENBSD_4_1_BASE:1.23
	OPENBSD_4_0:1.23.0.4
	OPENBSD_4_0_BASE:1.23
	OPENBSD_3_9:1.23.0.2
	OPENBSD_3_9_BASE:1.23
	OPENBSD_3_8:1.22.0.10
	OPENBSD_3_8_BASE:1.22
	OPENBSD_3_7:1.22.0.8
	OPENBSD_3_7_BASE:1.22
	OPENBSD_3_6:1.22.0.6
	OPENBSD_3_6_BASE:1.22
	OPENBSD_3_5:1.22.0.4
	OPENBSD_3_5_BASE:1.22
	OPENBSD_3_4:1.22.0.2
	OPENBSD_3_4_BASE:1.22
	OPENBSD_3_3:1.19.0.2
	OPENBSD_3_3_BASE:1.19
	OPENBSD_3_2:1.16.0.6
	OPENBSD_3_2_BASE:1.16
	OPENBSD_3_1:1.16.0.4
	OPENBSD_3_1_BASE:1.16
	OPENBSD_3_0:1.16.0.2
	OPENBSD_3_0_BASE:1.16
	OPENBSD_2_9:1.14.0.4
	OPENBSD_2_9_BASE:1.14
	OPENBSD_2_8:1.14.0.2
	OPENBSD_2_8_BASE:1.14
	OPENBSD_2_7:1.13.0.2
	OPENBSD_2_7_BASE:1.13
	OPENBSD_2_6:1.12.0.2
	OPENBSD_2_6_BASE:1.12
	OPENBSD_2_5:1.8.0.2
	OPENBSD_2_5_BASE:1.8
	OPENBSD_2_4:1.5.0.2
	OPENBSD_2_4_BASE:1.5
	OPENBSD_2_3:1.3.0.4
	OPENBSD_2_3_BASE:1.3
	OPENBSD_2_2:1.3.0.2
	OPENBSD_2_2_BASE:1.3
	OPENBSD_2_1:1.2.0.4
	OPENBSD_2_1_BASE:1.2
	OPENBSD_2_0:1.2.0.2
	OPENBSD_2_0_BASE:1.2
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@.\" @;


1.30
date	2015.09.10.17.55.21;	author schwarze;	state Exp;
branches;
next	1.29;
commitid	PeV7Ql0T6htfMjhP;

1.29
date	2013.03.31.22.11.26;	author guenther;	state Exp;
branches;
next	1.28;

1.28
date	2012.10.12.20.45.49;	author guenther;	state Exp;
branches;
next	1.27;

1.27
date	2010.07.01.20.48.37;	author jmc;	state Exp;
branches;
next	1.26;

1.26
date	2010.07.01.19.15.30;	author deraadt;	state Exp;
branches;
next	1.25;

1.25
date	2009.12.29.10.25.43;	author sobrado;	state Exp;
branches;
next	1.24;

1.24
date	2007.05.31.19.19.32;	author jmc;	state Exp;
branches;
next	1.23;

1.23
date	2005.10.19.18.27.05;	author jaredy;	state Exp;
branches;
next	1.22;

1.22
date	2003.06.02.20.18.39;	author millert;	state Exp;
branches;
next	1.21;

1.21
date	2003.06.01.20.25.23;	author jmc;	state Exp;
branches;
next	1.20;

1.20
date	2003.05.20.04.15.47;	author pjanzen;	state Exp;
branches;
next	1.19;

1.19
date	2003.03.18.00.55.50;	author millert;	state Exp;
branches;
next	1.18;

1.18
date	2003.02.21.09.14.37;	author jmc;	state Exp;
branches;
next	1.17;

1.17
date	2003.01.05.20.07.44;	author deraadt;	state Exp;
branches;
next	1.16;

1.16
date	2001.08.06.10.42.26;	author mpech;	state Exp;
branches;
next	1.15;

1.15
date	2001.06.26.19.56.52;	author dugsong;	state Exp;
branches;
next	1.14;

1.14
date	2000.10.18.05.12.09;	author aaron;	state Exp;
branches;
next	1.13;

1.13
date	2000.01.22.12.00.43;	author aaron;	state Exp;
branches;
next	1.12;

1.12
date	99.07.21.07.18.27;	author kjell;	state Exp;
branches;
next	1.11;

1.11
date	99.07.21.05.39.55;	author kjell;	state Exp;
branches;
next	1.10;

1.10
date	99.06.29.14.10.02;	author aaron;	state Exp;
branches;
next	1.9;

1.9
date	99.05.23.14.10.54;	author aaron;	state Exp;
branches;
next	1.8;

1.8
date	99.02.27.21.56.23;	author deraadt;	state Exp;
branches;
next	1.7;

1.7
date	99.02.15.21.48.57;	author millert;	state Exp;
branches;
next	1.6;

1.6
date	99.02.15.19.04.20;	author millert;	state Exp;
branches;
next	1.5;

1.5
date	98.07.06.18.27.37;	author deraadt;	state Exp;
branches;
next	1.4;

1.4
date	98.06.08.17.23.59;	author deraadt;	state Exp;
branches;
next	1.3;

1.3
date	97.06.13.10.08.33;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	95.12.14.02.21.13;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.42.26;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.42.26;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.30
log
@use .In rather than .Fd #include
@
text
@.\"	$OpenBSD: getsockname.2,v 1.29 2013/03/31 22:11:26 guenther Exp $
.\"	$NetBSD: getsockname.2,v 1.6 1995/10/12 15:41:00 jtc Exp $
.\"
.\" Copyright (c) 1983, 1991, 1993
.\"	The Regents of the University of California.  All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. Neither the name of the University nor the names of its contributors
.\"    may be used to endorse or promote products derived from this software
.\"    without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.\"     @@(#)getsockname.2	8.1 (Berkeley) 6/4/93
.\"
.Dd $Mdocdate: March 31 2013 $
.Dt GETSOCKNAME 2
.Os
.Sh NAME
.Nm getsockname
.Nd get socket name
.Sh SYNOPSIS
.In sys/socket.h
.Ft int
.Fn getsockname "int s" "struct sockaddr *name" "socklen_t *namelen"
.Sh DESCRIPTION
.Fn getsockname
returns the locally bound address information for a specified socket.
.Pp
Common uses of this function are as follows:
.Bl -bullet
.It
When
.Xr bind 2
is called with a port number of 0 (indicating the kernel should pick
an ephemeral port)
.Fn getsockname
is used to retrieve the kernel-assigned port number.
.It
When a process calls
.Xr bind 2
on a wildcard IP address,
.Fn getsockname
is used to retrieve the local IP address for the connection.
.It
When a function wishes to know the address family of a socket,
.Fn getsockname
can be used.
.El
.Pp
.Fn getsockname
takes three parameters:
.Pp
.Fa s
contains the file descriptor for the socket to be looked up.
.Pp
.Fa name
points to a
.Li sockaddr
structure which will hold the resulting address information.
Normal use requires one to use a structure
specific to the protocol family in use, such as
.Li sockaddr_in
(IPv4) or
.Li sockaddr_in6
(IPv6), cast to a (struct sockaddr *).
.Pp
For greater portability (such as newer protocol families) the new
structure sockaddr_storage exists.
.Li sockaddr_storage
is large enough to hold any of the other sockaddr_* variants.
On return, it should be cast to the correct sockaddr type,
according to the current protocol family.
.Pp
.Fa namelen
indicates the amount of space pointed to by
.Fa name ,
in bytes.
Upon return,
.Fa namelen
is set to the actual size of the returned address information.
.Pp
If the address of the destination socket for a given socket connection is
needed, the
.Xr getpeername 2
function should be used instead.
.Pp
If
.Fa name
does not point to enough space to hold the entire socket address, the
result will be truncated to
.Fa namelen
bytes.
.Sh RETURN VALUES
On success,
.Fn getsockname
returns a 0, and
.Fa namelen
is set to the actual size of the socket address returned in
.Fa name .
Otherwise,
.Va errno
is set, and a value of \-1 is returned.
.Sh ERRORS
If
.Fn getsockname
fails,
.Va errno
is set to one of the following:
.Bl -tag -width Er
.It Bq Er EBADF
The argument
.Fa s
is not a valid descriptor.
.It Bq Er ENOTSOCK
The argument
.Fa s
is a file, not a socket.
.It Bq Er ENOBUFS
Insufficient resources were available in the system
to perform the operation.
.It Bq Er EFAULT
The
.Fa name
or
.Fa namelen
parameter points to memory not in a valid part of the
process address space.
.El
.Sh SEE ALSO
.Xr accept 2 ,
.Xr bind 2 ,
.Xr getpeername 2 ,
.Xr socket 2 ,
.Xr getpeereid 3
.Sh STANDARDS
The
.Fn getsockname
function conforms to
.St -p1003.1-2008 .
.Sh HISTORY
The
.Fn getsockname
function call appeared in
.Bx 4.2 .
@


1.29
log
@More SYNOPSIS, ERRORS, and STANDARDS updates
@
text
@d1 1
a1 1
.\"	$OpenBSD: getsockname.2,v 1.28 2012/10/12 20:45:49 guenther Exp $
d33 1
a33 1
.Dd $Mdocdate: October 12 2012 $
d40 1
a40 1
.Fd #include <sys/socket.h>
@


1.28
log
@For consistency with other OSes and ease of porting, make
get{sock,peer}name() behave like accept() when the involved UNIX-domain
socket isn't bound to an address, returning an AF_UNIX sockaddr
with zero-length sun_path.  Based on diff from robert@@ and mikeb@@

ok robert@@ deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: getsockname.2,v 1.27 2010/07/01 20:48:37 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate: July 1 2010 $
a39 1
.Fd #include <sys/types.h>
d153 5
@


1.27
log
@sort SEE ALSO;
@
text
@d1 1
a1 1
.\"	$OpenBSD: getsockname.2,v 1.26 2010/07/01 19:15:30 deraadt Exp $
a158 6
.Sh BUGS
Names bound to sockets in the
.Ux Ns -domain
are inaccessible;
.Nm getsockname
returns a zero length name.
@


1.26
log
@getpeereid() can now be a library routine using getsockopt() with
SOL_SOCKET and SO_PEERCRED, only issue being that it cannot return
EFAULT for a page fault.  The kernel code will soon be put into
compat, and then in 10 years or so tedu will delete it.
ok guenther millert
@
text
@d1 1
a1 1
.\"	$OpenBSD: getsockname.2,v 1.25 2009/12/29 10:25:43 sobrado Exp $
d33 1
a33 1
.Dd $Mdocdate: December 29 2009 $
a150 1
.Xr getpeereid 3 ,
d152 2
a153 1
.Xr socket 2
@


1.25
log
@replace a few remaining UNIX terms with .Ux macros; this diff
completes the changes from Oct 22.
@
text
@d1 1
a1 1
.\"	$OpenBSD: getsockname.2,v 1.24 2007/05/31 19:19:32 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate: May 31 2007 $
d151 1
a151 1
.Xr getpeereid 2 ,
@


1.24
log
@convert to new .Dd format;
@
text
@d1 1
a1 1
.\"	$OpenBSD: getsockname.2,v 1.23 2005/10/19 18:27:05 jaredy Exp $
d33 1
a33 1
.Dd $Mdocdate$
d160 3
a162 1
Names bound to sockets in the UNIX domain are inaccessible;
@


1.23
log
@EFAULT corrections; ok millert and otto
@
text
@d1 1
a1 1
.\"	$OpenBSD: getsockname.2,v 1.22 2003/06/02 20:18:39 millert Exp $
d33 1
a33 1
.Dd July 17, 1999
@


1.22
log
@Remove the advertising clause in the UCB license which Berkeley
rescinded 22 July 1999.  Proofed by myself and Theo.
@
text
@d1 1
a1 1
.\"	$OpenBSD: getsockname.2,v 1.21 2003/06/01 20:25:23 jmc Exp $
d143 2
@


1.21
log
@- section reorder
- merge COMPATIBILITY
- kill whitespace at EOL
@
text
@d1 1
a1 1
.\"	$OpenBSD: getsockname.2,v 1.20 2003/05/20 04:15:47 pjanzen Exp $
d15 1
a15 5
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgement:
.\"	This product includes software developed by the University of
.\"	California, Berkeley and its contributors.
.\" 4. Neither the name of the University nor the names of its contributors
@


1.20
log
@consistent non-capitalization of words not beginning sentences
@
text
@d1 1
a1 1
.\"	$OpenBSD: getsockname.2,v 1.19 2003/03/18 00:55:50 millert Exp $
a155 4
.Sh BUGS
Names bound to sockets in the UNIX domain are inaccessible;
.Nm getsockname
returns a zero length name.
d161 4
@


1.19
log
@Do not capitalize "Indicates" as it does not start the sentence
@
text
@d1 1
a1 1
.\"	$OpenBSD: getsockname.2,v 1.18 2003/02/21 09:14:37 jmc Exp $
d77 1
a77 1
Contains the file descriptor for the socket to be looked up.
d80 1
a80 1
Points to a
@


1.18
log
@typos;
@
text
@d1 1
a1 1
.\"	$OpenBSD: getsockname.2,v 1.17 2003/01/05 20:07:44 deraadt Exp $
d98 1
a98 1
Indicates the amount of space pointed to by
@


1.17
log
@spelling
@
text
@d1 1
a1 1
.\"	$OpenBSD: getsockname.2,v 1.16 2001/08/06 10:42:26 mpech Exp $
d76 1
a76 1
.Fa s ,
d80 1
a80 1
points to a
d153 1
a154 1
.Xr getpeereid 2 ,
@


1.16
log
@o) We always close .Bl and .Bd tags;
o) .Sh AUTHOR -> .Sh AUTHORS;
o) We don't like .Pp before/after .Sh;
o) We don't like .Pp before/after .Rs/.Re;
o) NetBSD -> .Nx;
o) OpenBSD -> .Ox;

millert@@ ok
@
text
@d1 1
a1 1
.\"	$OpenBSD: getsockname.2,v 1.15 2001/06/26 19:56:52 dugsong Exp $
d77 1
a77 1
Contains the file desriptor for the socket to be looked up.
@


1.15
log
@implement djb's getpeereid(2), to allow local-domain servers to determine client credentials. mostly from superscript.com. deraadt@@ ok
@
text
@d1 1
a1 1
.\"	$OpenBSD: getsockname.2,v 1.14 2000/10/18 05:12:09 aaron Exp $
a115 1
.Pp
@


1.14
log
@Another round of man page cleanup, this time to remove more hard sentence
breaks and getting rid of short lines, making these files easier to work with.
@
text
@d1 1
a1 1
.\"	$OpenBSD: getsockname.2,v 1.13 2000/01/22 12:00:43 aaron Exp $
d155 1
@


1.13
log
@Use .Va macro when referring to the global variable errno.
@
text
@d1 1
a1 1
.\"	$OpenBSD: getsockname.2,v 1.12 1999/07/21 07:18:27 kjell Exp $
d80 9
a88 4
points to a sockaddr structure which will hold the resulting
address information.  Normal use requires one to use a structure
specific to the protocol family in use, such as sockaddr_in (IPv4)
or sockaddr_in6 (IPv6), cast to a (struct sockaddr *).
d91 3
a93 2
structure sockaddr_storage exists. sockaddr_storage is
large enough to hold any of the other sockaddr_* variants.
d100 2
a101 1
in bytes. Upon return,
@


1.12
log
@Remove PARAMETERS section. Different bad. Kjell bad.
Add references to sockaddr_storage.
@
text
@d1 1
a1 1
.\"	$OpenBSD: getsockname.2,v 1.11 1999/07/21 05:39:55 kjell Exp $
d117 3
a119 1
Otherwise, errno is set, and a value of \-1 is returned.
d123 3
a125 1
fails, errno is set to one of the following:
@


1.11
log
@Updated man pages to be useful. Include description of typical uses.
@
text
@d1 1
a1 1
.\"	$OpenBSD: getsockname.2,v 1.10 1999/06/29 14:10:02 aaron Exp $
a47 14
.Sh PARAMETERS
.Bl -tag -width namelen
.It s
Contains the file desriptor for the socket to be looked up.
.It name
Points to a sockaddr structure to hold the resulting address information.
The format of this socket depends on the protocol family in use. See
.Xr socket 2
for details.
.It namelen
Indicates the amount of space pointed to by
.Fa name ,
in bytes.
.El
d52 1
a52 1
This function is useful in a number of circumstances. For instance:
d72 25
@


1.10
log
@- change references to nil to null; tschroed@@acm.org
- remove trailing spaces from end of lines
- add some .Dv
- change -1 to \-1, so `-' is taken as a negative sign
- other misc formatting fixes
@
text
@d1 1
a1 1
.\"	$OpenBSD: getsockname.2,v 1.9 1999/05/23 14:10:54 aaron Exp $
d37 1
a37 1
.Dd February 15, 1999
d48 14
d64 29
a92 1
returns the current
d94 2
a95 1
for the specified socket.  The
d97 8
a104 2
parameter should be initialized to indicate
the amount of space pointed to by
d106 1
a106 4
On return it contains the actual size of the name
returned (in bytes).
.Sh RETURN VALUES
A 0 is returned if the call succeeds, \-1 if it fails.
d108 3
a110 1
The call succeeds unless:
d130 1
d132 1
@


1.9
log
@remove argument from .Os macros so value in /usr/share/tmac/mdoc/doc-common
is used instead; kwesterback@@home.com
@
text
@d1 1
a1 1
.\"	$OpenBSD: getsockname.2,v 1.8 1999/02/27 21:56:23 deraadt Exp $
d50 1
a50 1
returns the current 
d60 1
a60 1
A 0 is returned if the call succeeds, -1 if it fails.
d76 1
a76 1
The 
@


1.8
log
@make function names the correct case
@
text
@d1 1
a1 1
.\"	$OpenBSD: getsockname.2,v 1.7 1999/02/15 21:48:57 millert Exp $
d39 1
a39 1
.Os BSD 4.2
@


1.7
log
@must include <sys/types.h> before <sys.socket.h>
@
text
@d1 1
a1 1
.\"	$OpenBSD: getsockname.2,v 1.6 1999/02/15 19:04:20 millert Exp $
d49 1
a49 1
.Fn Getsockname
@


1.6
log
@Use and document socklen_t
@
text
@d1 1
a1 1
.\"	$OpenBSD: getsockname.2,v 1.5 1998/07/06 18:27:37 deraadt Exp $
d44 1
@


1.5
log
@fix openbsd tag
@
text
@d1 1
a1 1
.\"	$OpenBSD: getsockname.2,v 1.6 1995/10/12 15:41:00 jtc Exp $
d37 1
a37 1
.Dd June 4, 1993
d46 1
a46 1
.Fn getsockname "int s" "struct sockaddr *name" "int *namelen"
@


1.4
log
@clean; kleink
@
text
@d1 1
@


1.3
log
@fix lots of .Xr and other minor things
@
text
@d57 1
a57 1
.Sh DIAGNOSTICS
@


1.2
log
@from netbsd:
add & fix a bunch of system call pages
@
text
@d84 1
a84 1
.Xr getsockname
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
.\"	$NetBSD: getsockname.2,v 1.5 1995/02/27 12:33:26 cgd Exp $
d43 1
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
