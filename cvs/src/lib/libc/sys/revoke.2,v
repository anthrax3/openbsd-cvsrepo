head	1.14;
access;
symbols
	OPENBSD_6_2:1.14.0.10
	OPENBSD_6_2_BASE:1.14
	OPENBSD_6_1:1.14.0.8
	OPENBSD_6_1_BASE:1.14
	OPENBSD_6_0:1.14.0.4
	OPENBSD_6_0_BASE:1.14
	OPENBSD_5_9:1.14.0.2
	OPENBSD_5_9_BASE:1.14
	OPENBSD_5_8:1.12.0.4
	OPENBSD_5_8_BASE:1.12
	OPENBSD_5_7:1.11.0.2
	OPENBSD_5_7_BASE:1.11
	OPENBSD_5_6:1.9.0.32
	OPENBSD_5_6_BASE:1.9
	OPENBSD_5_5:1.9.0.30
	OPENBSD_5_5_BASE:1.9
	OPENBSD_5_4:1.9.0.26
	OPENBSD_5_4_BASE:1.9
	OPENBSD_5_3:1.9.0.24
	OPENBSD_5_3_BASE:1.9
	OPENBSD_5_2:1.9.0.22
	OPENBSD_5_2_BASE:1.9
	OPENBSD_5_1_BASE:1.9
	OPENBSD_5_1:1.9.0.20
	OPENBSD_5_0:1.9.0.18
	OPENBSD_5_0_BASE:1.9
	OPENBSD_4_9:1.9.0.16
	OPENBSD_4_9_BASE:1.9
	OPENBSD_4_8:1.9.0.14
	OPENBSD_4_8_BASE:1.9
	OPENBSD_4_7:1.9.0.10
	OPENBSD_4_7_BASE:1.9
	OPENBSD_4_6:1.9.0.12
	OPENBSD_4_6_BASE:1.9
	OPENBSD_4_5:1.9.0.8
	OPENBSD_4_5_BASE:1.9
	OPENBSD_4_4:1.9.0.6
	OPENBSD_4_4_BASE:1.9
	OPENBSD_4_3:1.9.0.4
	OPENBSD_4_3_BASE:1.9
	OPENBSD_4_2:1.9.0.2
	OPENBSD_4_2_BASE:1.9
	OPENBSD_4_1:1.8.0.16
	OPENBSD_4_1_BASE:1.8
	OPENBSD_4_0:1.8.0.14
	OPENBSD_4_0_BASE:1.8
	OPENBSD_3_9:1.8.0.12
	OPENBSD_3_9_BASE:1.8
	OPENBSD_3_8:1.8.0.10
	OPENBSD_3_8_BASE:1.8
	OPENBSD_3_7:1.8.0.8
	OPENBSD_3_7_BASE:1.8
	OPENBSD_3_6:1.8.0.6
	OPENBSD_3_6_BASE:1.8
	OPENBSD_3_5:1.8.0.4
	OPENBSD_3_5_BASE:1.8
	OPENBSD_3_4:1.8.0.2
	OPENBSD_3_4_BASE:1.8
	OPENBSD_3_3:1.7.0.12
	OPENBSD_3_3_BASE:1.7
	OPENBSD_3_2:1.7.0.10
	OPENBSD_3_2_BASE:1.7
	OPENBSD_3_1:1.7.0.8
	OPENBSD_3_1_BASE:1.7
	OPENBSD_3_0:1.7.0.6
	OPENBSD_3_0_BASE:1.7
	OPENBSD_2_9:1.7.0.4
	OPENBSD_2_9_BASE:1.7
	OPENBSD_2_8:1.7.0.2
	OPENBSD_2_8_BASE:1.7
	OPENBSD_2_7:1.6.0.4
	OPENBSD_2_7_BASE:1.6
	OPENBSD_2_6:1.6.0.2
	OPENBSD_2_6_BASE:1.6
	OPENBSD_2_5:1.4.0.2
	OPENBSD_2_5_BASE:1.4
	OPENBSD_2_4:1.3.0.2
	OPENBSD_2_4_BASE:1.3
	OPENBSD_2_3:1.2.0.8
	OPENBSD_2_3_BASE:1.2
	OPENBSD_2_2:1.2.0.6
	OPENBSD_2_2_BASE:1.2
	OPENBSD_2_1:1.2.0.4
	OPENBSD_2_1_BASE:1.2
	OPENBSD_2_0:1.2.0.2
	OPENBSD_2_0_BASE:1.2
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@.\" @;


1.14
date	2015.11.16.19.26.21;	author jmc;	state Exp;
branches;
next	1.13;
commitid	WKpFZ9zmOfNxtdfb;

1.13
date	2015.11.16.18.25.18;	author deraadt;	state Exp;
branches;
next	1.12;
commitid	RK8KWmucfXbJMP5B;

1.12
date	2015.05.31.23.54.25;	author schwarze;	state Exp;
branches;
next	1.11;
commitid	zjg8ueH5pm88cPnS;

1.11
date	2015.01.19.15.54.11;	author millert;	state Exp;
branches;
next	1.10;
commitid	nJ2wjGsUe8RwMTRS;

1.10
date	2014.12.10.19.19.00;	author schwarze;	state Exp;
branches;
next	1.9;
commitid	sADK4BTCz4ZrHHo9;

1.9
date	2007.05.31.19.19.33;	author jmc;	state Exp;
branches;
next	1.8;

1.8
date	2003.06.02.20.18.39;	author millert;	state Exp;
branches;
next	1.7;

1.7
date	2000.10.18.05.12.11;	author aaron;	state Exp;
branches;
next	1.6;

1.6
date	99.07.07.17.06.08;	author art;	state Exp;
branches;
next	1.5;

1.5
date	99.07.07.17.02.42;	author art;	state Exp;
branches;
next	1.4;

1.4
date	99.02.27.21.56.43;	author deraadt;	state Exp;
branches;
next	1.3;

1.3
date	98.07.06.18.28.20;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	95.12.14.02.21.19;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.42.28;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.42.28;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.14
log
@minor tweaks;
@
text
@.\"	$OpenBSD: revoke.2,v 1.13 2015/11/16 18:25:18 deraadt Exp $
.\"	$NetBSD: revoke.2,v 1.3 1995/10/12 15:41:11 jtc Exp $
.\"
.\" Copyright (c) 1993
.\"	The Regents of the University of California.  All rights reserved.
.\"
.\" This code is derived from software contributed to Berkeley by
.\" Berkeley Software Design, Inc.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. Neither the name of the University nor the names of its contributors
.\"    may be used to endorse or promote products derived from this software
.\"    without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.\"     @@(#)revoke.2	8.1 (Berkeley) 6/4/93
.\"
.Dd $Mdocdate: November 16 2015 $
.Dt REVOKE 2
.Os
.Sh NAME
.Nm revoke
.Nd revoke file access
.Sh SYNOPSIS
.In unistd.h
.Ft int
.Fn revoke "const char *path"
.Sh DESCRIPTION
The
.Fn revoke
function invalidates all current open file descriptors in the system
for the tty device named by
.Fa path .
Subsequent operations on any such descriptors
fail, with the exceptions that a
.Fn read
from a tty which has been revoked returns a count of zero (end of file),
and a
.Fn close
call will succeed.
If the file is a special file for a device which is open,
the device close function
is called as if all open references to the file had been closed.
.Pp
Access to a file may be revoked only by its owner or the superuser.
The
.Fn revoke
function is used to prepare a terminal device for a new login session,
preventing any access by a previous user of the terminal.
The
.Xr pty 4
subsystem has this as an implicit operation, but hardwired
.Xr tty 4
require the operation.
.Sh RETURN VALUES
.Rv -std
.Sh ERRORS
Access to the named file is revoked unless one of the following:
.Bl -tag -width Er
.It Bq Er ENOTDIR
A component of the path prefix is not a directory.
.It Bq Er ENAMETOOLONG
A component of a pathname exceeded
.Dv NAME_MAX
characters, or an entire pathname (including the terminating NUL)
exceeded
.Dv PATH_MAX
bytes.
.It Bq Er ENOENT
The named file or a component of the path name does not exist.
.It Bq Er ENOTTY
.Ar path
is not associated with a tty special device.
.It Bq Er EACCES
Search permission is denied for a component of the path prefix.
.It Bq Er ELOOP
Too many symbolic links were encountered in translating the pathname.
.It Bq Er EFAULT
.Fa path
points outside the process's allocated address space.
.It Bq Er EPERM
The caller is neither the owner of the file nor the superuser.
.El
.Sh SEE ALSO
.Xr close 2
.Sh HISTORY
The
.Fn revoke
function was introduced in
.Bx 4.3 Reno .
@


1.13
log
@Only perform revoke(2) on tty cdevs.  Others paths return ENOTTY.
ok millert semarie tedu guenther
@
text
@d1 1
a1 1
.\"	$OpenBSD: revoke.2,v 1.12 2015/05/31 23:54:25 schwarze Exp $
d36 1
a36 1
.Dd $Mdocdate: May 31 2015 $
d71 1
a71 1
. Xr tty 4
@


1.12
log
@Simple macro fixes (Fd -> In, Nm -> Fn) from Kaspars at Bankovskis dot net.
No content change.
@
text
@d1 1
a1 1
.\"	$OpenBSD: revoke.2,v 1.11 2015/01/19 15:54:11 millert Exp $
d36 1
a36 1
.Dd $Mdocdate: January 19 2015 $
d50 1
a50 1
for the file named by
d55 1
a55 2
from a character device file which has been revoked
returns a count of zero (end of file),
d66 1
a66 1
function is normally used to prepare a terminal device for a new login session,
d68 5
d89 3
@


1.11
log
@Explicitly mention that PATH_MAX includes the NUL in the ENAMETOOLONG
description.
@
text
@d1 1
a1 1
.\"	$OpenBSD: revoke.2,v 1.10 2014/12/10 19:19:00 schwarze Exp $
d36 1
a36 1
.Dd $Mdocdate: December 10 2014 $
d43 1
a43 1
.Fd #include <unistd.h>
d48 1
a48 1
.Nm revoke
d66 1
a66 1
.Nm revoke
d99 1
a99 1
.Nm revoke
@


1.10
log
@use .Rv; no change of meaning; from Kaspars at Bankovskis dot net
@
text
@d1 1
a1 1
.\"	$OpenBSD: revoke.2,v 1.9 2007/05/31 19:19:33 jmc Exp $
d36 1
a36 1
.Dd $Mdocdate: May 31 2007 $
d77 6
a82 2
A component of a pathname exceeded 255 characters,
or an entire path name exceeded 1024 characters.
@


1.9
log
@convert to new .Dd format;
@
text
@d1 1
a1 1
.\"	$OpenBSD: revoke.2,v 1.8 2003/06/02 20:18:39 millert Exp $
d36 1
a36 1
.Dd $Mdocdate$
d70 1
a70 4
A 0 value indicated that the call succeeded.
A \-1 return value indicates an error occurred and
.Va errno
is set to indicated the reason.
@


1.8
log
@Remove the advertising clause in the UCB license which Berkeley
rescinded 22 July 1999.  Proofed by myself and Theo.
@
text
@d1 1
a1 1
.\"	$OpenBSD: revoke.2,v 1.7 2000/10/18 05:12:11 aaron Exp $
d36 1
a36 1
.Dd June 4, 1993
@


1.7
log
@Another round of man page cleanup, this time to remove more hard sentence
breaks and getting rid of short lines, making these files easier to work with.
@
text
@d1 1
a1 1
.\"	$OpenBSD: revoke.2,v 1.6 1999/07/07 17:06:08 art Exp $
d18 1
a18 5
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgement:
.\"	This product includes software developed by the University of
.\"	California, Berkeley and its contributors.
.\" 4. Neither the name of the University nor the names of its contributors
@


1.6
log
@I don't see how revoke can return EINVAL.
@
text
@d1 1
a1 1
.\"	$OpenBSD: revoke.2,v 1.5 1999/07/07 17:02:42 art Exp $
d68 1
a68 1
Access to a file may be revoked only by its owner or the super user.
d74 2
a75 2
A 0 value indicated that the call succeeded.  A \-1 return value
indicates an error occurred and
d96 1
a96 1
The caller is neither the owner of the file nor the super user.
@


1.5
log
@revoke(2) works on more than just char and block devices
@
text
@d1 1
a1 1
.\"	$OpenBSD: revoke.2,v 1.4 1999/02/27 21:56:43 deraadt Exp $
a94 3
.It Bq Er EINVAL
The named file is neither a character special or block
special file.
@


1.4
log
@make function names the correct case
@
text
@d1 1
a1 1
.\"	$OpenBSD: revoke.2,v 1.3 1998/07/06 18:28:20 deraadt Exp $
d71 1
a71 3
function is currently supported only for block and character special
device files.
It is normally used to prepare a terminal device for a new login session,
@


1.3
log
@fix openbsd tag
@
text
@d1 1
a1 1
.\"	$OpenBSD: revoke.2,v 1.3 1995/10/12 15:41:11 jtc Exp $
d95 1
a95 1
.Fa Path
@


1.2
log
@from netbsd:
add & fix a bunch of system call pages
@
text
@d1 1
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
.\"	$NetBSD: revoke.2,v 1.2 1995/02/27 12:36:23 cgd Exp $
d46 1
d48 1
a48 1
.Fn revoke "char *path"
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
