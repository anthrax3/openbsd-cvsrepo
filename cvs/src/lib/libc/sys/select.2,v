head	1.42;
access;
symbols
	OPENBSD_6_1:1.42.0.4
	OPENBSD_6_1_BASE:1.42
	OPENBSD_6_0:1.41.0.2
	OPENBSD_6_0_BASE:1.41
	OPENBSD_5_9:1.40.0.2
	OPENBSD_5_9_BASE:1.40
	OPENBSD_5_8:1.38.0.6
	OPENBSD_5_8_BASE:1.38
	OPENBSD_5_7:1.38.0.2
	OPENBSD_5_7_BASE:1.38
	OPENBSD_5_6:1.37.0.4
	OPENBSD_5_6_BASE:1.37
	OPENBSD_5_5:1.36.0.4
	OPENBSD_5_5_BASE:1.36
	OPENBSD_5_4:1.31.0.2
	OPENBSD_5_4_BASE:1.31
	OPENBSD_5_3:1.28.0.24
	OPENBSD_5_3_BASE:1.28
	OPENBSD_5_2:1.28.0.22
	OPENBSD_5_2_BASE:1.28
	OPENBSD_5_1_BASE:1.28
	OPENBSD_5_1:1.28.0.20
	OPENBSD_5_0:1.28.0.18
	OPENBSD_5_0_BASE:1.28
	OPENBSD_4_9:1.28.0.16
	OPENBSD_4_9_BASE:1.28
	OPENBSD_4_8:1.28.0.14
	OPENBSD_4_8_BASE:1.28
	OPENBSD_4_7:1.28.0.10
	OPENBSD_4_7_BASE:1.28
	OPENBSD_4_6:1.28.0.12
	OPENBSD_4_6_BASE:1.28
	OPENBSD_4_5:1.28.0.8
	OPENBSD_4_5_BASE:1.28
	OPENBSD_4_4:1.28.0.6
	OPENBSD_4_4_BASE:1.28
	OPENBSD_4_3:1.28.0.4
	OPENBSD_4_3_BASE:1.28
	OPENBSD_4_2:1.28.0.2
	OPENBSD_4_2_BASE:1.28
	OPENBSD_4_1:1.27.0.12
	OPENBSD_4_1_BASE:1.27
	OPENBSD_4_0:1.27.0.10
	OPENBSD_4_0_BASE:1.27
	OPENBSD_3_9:1.27.0.8
	OPENBSD_3_9_BASE:1.27
	OPENBSD_3_8:1.27.0.6
	OPENBSD_3_8_BASE:1.27
	OPENBSD_3_7:1.27.0.4
	OPENBSD_3_7_BASE:1.27
	OPENBSD_3_6:1.27.0.2
	OPENBSD_3_6_BASE:1.27
	OPENBSD_3_5:1.26.0.2
	OPENBSD_3_5_BASE:1.26
	OPENBSD_3_4:1.24.0.2
	OPENBSD_3_4_BASE:1.24
	OPENBSD_3_3:1.21.0.2
	OPENBSD_3_3_BASE:1.21
	OPENBSD_3_2:1.20.0.6
	OPENBSD_3_2_BASE:1.20
	OPENBSD_3_1:1.20.0.4
	OPENBSD_3_1_BASE:1.20
	OPENBSD_3_0:1.20.0.2
	OPENBSD_3_0_BASE:1.20
	OPENBSD_2_9:1.19.0.2
	OPENBSD_2_9_BASE:1.19
	OPENBSD_2_8:1.18.0.2
	OPENBSD_2_8_BASE:1.18
	OPENBSD_2_7:1.17.0.2
	OPENBSD_2_7_BASE:1.17
	OPENBSD_2_6:1.15.0.2
	OPENBSD_2_6_BASE:1.15
	OPENBSD_2_5:1.11.0.2
	OPENBSD_2_5_BASE:1.11
	OPENBSD_2_4:1.8.0.2
	OPENBSD_2_4_BASE:1.8
	OPENBSD_2_3:1.6.0.4
	OPENBSD_2_3_BASE:1.6
	OPENBSD_2_2:1.6.0.2
	OPENBSD_2_2_BASE:1.6
	OPENBSD_2_1:1.5.0.2
	OPENBSD_2_1_BASE:1.5
	OPENBSD_2_0:1.2.0.2
	OPENBSD_2_0_BASE:1.2
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@.\" @;


1.42
date	2016.09.17.01.01.42;	author guenther;	state Exp;
branches;
next	1.41;
commitid	XAaA6WzzWng2gOy8;

1.41
date	2016.06.07.16.18.56;	author tedu;	state Exp;
branches;
next	1.40;
commitid	zErgpwYZ9LaIS7qF;

1.40
date	2015.11.10.23.48.18;	author jmc;	state Exp;
branches;
next	1.39;
commitid	QU70QaxjyBAtj4Rv;

1.39
date	2015.09.21.06.06.54;	author guenther;	state Exp;
branches;
next	1.38;
commitid	Lh74zyoQscO2TWOq;

1.38
date	2015.03.02.21.15.34;	author millert;	state Exp;
branches;
next	1.37;
commitid	1I7g3zGtBTsQKleb;

1.37
date	2014.03.13.10.12.11;	author florian;	state Exp;
branches;
next	1.36;

1.36
date	2014.01.29.14.00.07;	author jmc;	state Exp;
branches;
next	1.35;

1.35
date	2013.12.04.07.39.25;	author jmc;	state Exp;
branches;
next	1.34;

1.34
date	2013.12.04.07.28.53;	author jmc;	state Exp;
branches;
next	1.33;

1.33
date	2013.12.03.23.00.51;	author naddy;	state Exp;
branches;
next	1.32;

1.32
date	2013.11.02.17.25.34;	author espie;	state Exp;
branches;
next	1.31;

1.31
date	2013.07.17.05.42.11;	author schwarze;	state Exp;
branches;
next	1.30;

1.30
date	2013.05.05.01.07.46;	author tedu;	state Exp;
branches;
next	1.29;

1.29
date	2013.04.29.17.06.20;	author matthew;	state Exp;
branches;
next	1.28;

1.28
date	2007.05.31.19.19.33;	author jmc;	state Exp;
branches;
next	1.27;

1.27
date	2004.04.15.19.52.18;	author jmc;	state Exp;
branches;
next	1.26;

1.26
date	2004.02.08.19.20.23;	author otto;	state Exp;
branches;
next	1.25;

1.25
date	2004.01.23.23.08.46;	author jmc;	state Exp;
branches;
next	1.24;

1.24
date	2003.07.30.13.03.07;	author henning;	state Exp;
branches;
next	1.23;

1.23
date	2003.06.02.20.18.39;	author millert;	state Exp;
branches;
next	1.22;

1.22
date	2003.06.01.21.23.15;	author jmc;	state Exp;
branches;
next	1.21;

1.21
date	2002.11.19.20.57.13;	author millert;	state Exp;
branches;
next	1.20;

1.20
date	2001.09.04.08.04.08;	author deraadt;	state Exp;
branches;
next	1.19;

1.19
date	2001.03.03.21.32.35;	author deraadt;	state Exp;
branches;
next	1.18;

1.18
date	2000.10.18.05.12.11;	author aaron;	state Exp;
branches;
next	1.17;

1.17
date	2000.04.15.02.15.24;	author aaron;	state Exp;
branches;
next	1.16;

1.16
date	2000.01.22.02.17.55;	author aaron;	state Exp;
branches;
next	1.15;

1.15
date	99.09.23.04.12.00;	author alex;	state Exp;
branches;
next	1.14;

1.14
date	99.06.29.14.10.17;	author aaron;	state Exp;
branches;
next	1.13;

1.13
date	99.05.23.14.10.55;	author aaron;	state Exp;
branches;
next	1.12;

1.12
date	99.05.16.19.55.35;	author alex;	state Exp;
branches;
next	1.11;

1.11
date	99.03.11.01.35.01;	author pjanzen;	state Exp;
branches;
next	1.10;

1.10
date	99.03.02.10.32.31;	author deraadt;	state Exp;
branches;
next	1.9;

1.9
date	99.02.27.21.56.44;	author deraadt;	state Exp;
branches;
next	1.8;

1.8
date	98.07.06.18.28.24;	author deraadt;	state Exp;
branches;
next	1.7;

1.7
date	98.06.08.17.17.19;	author deraadt;	state Exp;
branches;
next	1.6;

1.6
date	97.07.17.07.38.22;	author deraadt;	state Exp;
branches;
next	1.5;

1.5
date	97.04.08.22.47.56;	author deraadt;	state Exp;
branches;
next	1.4;

1.4
date	96.12.11.17.29.46;	author deraadt;	state Exp;
branches;
next	1.3;

1.3
date	96.12.10.15.00.57;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	96.09.01.20.14.30;	author millert;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.42.28;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.42.28;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.42
log
@Restore warnings about multiple process waiting on same fd

requested by mpf@@
ok deraadt tedu@@
@
text
@.\"	$OpenBSD: select.2,v 1.41 2016/06/07 16:18:56 tedu Exp $
.\"	$NetBSD: select.2,v 1.5 1995/06/27 22:32:28 cgd Exp $
.\"
.\" Copyright (c) 1983, 1991, 1993
.\"	The Regents of the University of California.  All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. Neither the name of the University nor the names of its contributors
.\"    may be used to endorse or promote products derived from this software
.\"    without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.\"     @@(#)select.2	8.2 (Berkeley) 3/25/94
.\"
.Dd $Mdocdate: June 7 2016 $
.Dt SELECT 2
.Os
.Sh NAME
.Nm select ,
.Nm pselect ,
.Nm FD_SET ,
.Nm FD_CLR ,
.Nm FD_ISSET ,
.Nm FD_ZERO
.Nd synchronous I/O multiplexing
.Sh SYNOPSIS
.In sys/select.h
.Ft int
.Fn select "int nfds" "fd_set *readfds" "fd_set *writefds" "fd_set *exceptfds" "struct timeval *timeout"
.Ft int
.Fn pselect "int nfds" "fd_set *readfds" "fd_set *writefds" "fd_set *exceptfds" "const struct timespec *timeout" "const sigset_t *mask"
.Fn FD_SET fd &fdset
.Fn FD_CLR fd &fdset
.Fn FD_ISSET fd &fdset
.Fn FD_ZERO &fdset
.Sh DESCRIPTION
.Fn select
examines the I/O descriptor sets whose addresses are passed in
.Fa readfds ,
.Fa writefds ,
and
.Fa exceptfds
to see if some of their descriptors
are ready for reading, are ready for writing, or have an exceptional
condition pending, respectively.
Exceptional conditions include the presence of out-of-band data
on a socket.
The first
.Fa nfds
descriptors are checked in each set;
i.e., the descriptors from 0 through
.Fa nfds Ns -1
in the descriptor sets are examined.
On return,
.Fn select
replaces the given descriptor sets
with subsets consisting of those descriptors that are ready
for the requested operation.
.Fn select
returns the total number of ready descriptors in all the sets.
.Pp
The descriptor sets are stored as bit fields in arrays of integers.
The following macros are provided for manipulating such descriptor sets:
.Fn FD_ZERO &fdset
initializes a descriptor set
.Fa fdset
to the null set.
.Fn FD_SET fd &fdset
includes a particular descriptor
.Fa fd
in
.Fa fdset .
.Fn FD_CLR fd &fdset
removes
.Fa fd
from
.Fa fdset .
.Fn FD_ISSET fd &fdset
is non-zero if
.Fa fd
is a member of
.Fa fdset ,
zero otherwise.
The behavior of these macros is undefined if
a descriptor value is less than zero or greater than or equal to
.Dv FD_SETSIZE ,
which is normally at least equal
to the maximum number of descriptors supported by the system.
.Pp
If
.Fa timeout
is a non-null pointer, it specifies a maximum interval to wait for the
selection to complete.
If
.Fa timeout
is a null pointer, the select blocks indefinitely.
To effect a poll, the
.Fa timeout
argument should be non-null, pointing to a zero-valued timeval structure.
.Fa timeout
is not changed by
.Fn select ,
and may be reused on subsequent calls; however, it is good style to
re-initialize it before each invocation of
.Fn select .
.Pp
Any of
.Fa readfds ,
.Fa writefds ,
and
.Fa exceptfds
may be given as null pointers if no descriptors are of interest.
.Pp
The
.Fn pselect
function is similar to
.Fn select
except that it specifies the timeout using a timespec structure.
Also, if
.Fa mask
is a non-null pointer,
.Fn pselect
atomically sets the calling thread's signal mask to the signal set
pointed to by
.Fa mask
for the duration of the function call.
In this case, the original signal mask will be restored before
.Fn pselect
returns.
.Sh RETURN VALUES
If successful,
.Fn select
and
.Fn pselect
return the number of ready descriptors that are contained in
the descriptor sets.
If a descriptor is included in multiple descriptor sets,
each inclusion is counted separately.
If the time limit expires before any descriptors become ready,
they return 0.
.Pp
Otherwise, if
.Fn select
or
.Fn pselect
return with an error, including one due to an interrupted call,
they return \-1,
and the descriptor sets will be unmodified.
.Sh ERRORS
An error return from
.Fn select
or
.Fn pselect
indicates:
.Bl -tag -width Er
.It Bq Er EFAULT
One or more of
.Fa readfds ,
.Fa writefds ,
or
.Fa exceptfds
points outside the process's allocated address space.
.It Bq Er EBADF
One of the descriptor sets specified an invalid descriptor.
.It Bq Er EINTR
A signal was delivered before the time limit expired and
before any of the selected descriptors became ready.
.It Bq Er EINVAL
The specified time limit is invalid.
One of its components is negative or too large.
.It Bq Er EINVAL
.Fa nfds
was less than 0.
.El
.Sh SEE ALSO
.Xr accept 2 ,
.Xr clock_gettime 2 ,
.Xr connect 2 ,
.Xr gettimeofday 2 ,
.Xr poll 2 ,
.Xr read 2 ,
.Xr recv 2 ,
.Xr send 2 ,
.Xr write 2 ,
.Xr getdtablesize 3
.Sh STANDARDS
The
.Fn select
and
.Fn pselect
functions conform to
.St -p1003.1-2008 .
.Sh HISTORY
The
.Fn select
system call first appeared in
.Bx 4.1c .
The
.Fn pselect
system call has been available since
.Ox 5.4 .
.Sh BUGS
Although the provision of
.Xr getdtablesize 3
was intended to allow user programs to be written independent
of the kernel limit on the number of open files, the dimension
of a sufficiently large bit field for select remains a problem.
The default bit size of
.Ft fd_set
is based on the symbol
.Dv FD_SETSIZE
(currently 1024),
but that is somewhat smaller than the current kernel limit
to the number of open files.
However, in order to accommodate programs which might potentially
use a larger number of open files with select, it is possible
to increase this size within a program by providing
a larger definition of
.Dv FD_SETSIZE
before the inclusion of any headers.
The kernel will cope, and the userland libraries provided with the
system are also ready for large numbers of file descriptors.
.Pp
Alternatively, to be really safe, it is possible to allocate
.Ft fd_set
bit-arrays dynamically.
The idea is to permit a program to work properly even if it is
.Xr execve 2 Ns 'd
with 4000 file descriptors pre-allocated.
The following illustrates the technique which is used by
userland libraries:
.Bd -literal -offset indent
fd_set *fdsr;
int max = fd;

fdsr = calloc(howmany(max+1, NFDBITS), sizeof(fd_mask));
if (fdsr == NULL) {
	...
	return (-1);
}
FD_SET(fd, fdsr);
n = select(max+1, fdsr, NULL, NULL, &tv);
\&...
free(fdsr);
.Ed
.Pp
Alternatively, it is possible to use the
.Xr poll 2
interface.
.Xr poll 2
is more efficient when the size of
.Fn select Ns 's
.Ft fd_set
bit-arrays are very large, and for fixed numbers of
file descriptors one need not size and dynamically allocate a
memory object.
.Pp
.Fn select
should probably have been designed to return the time remaining from the
original timeout, if any, by modifying the time value in place.
Even though some systems stupidly act in this different way, it is
unlikely this semantic will ever be commonly implemented, as the
change causes massive source code compatibility problems.
Furthermore, recent new standards have dictated the current behaviour.
In general, due to the existence of those brain-damaged
non-conforming systems, it is unwise to assume that the timeout
value will be unmodified by the
.Fn select
call, and the caller should reinitialize it on each invocation.
Calculating the delta is easily done by calling
.Xr gettimeofday 2
before and after the call to
.Fn select ,
and using
.Fn timersub
(as described in
.Xr getitimer 2 ) .
.Pp
Internally to the kernel,
.Fn select
and
.Fn pselect
work poorly if multiple processes wait on the same file descriptor.
@


1.41
log
@remove historic note about multiple processes. mostly irrelevant today.
ok deraadt millert
@
text
@d1 1
a1 1
.\"	$OpenBSD: select.2,v 1.40 2015/11/10 23:48:18 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate: November 10 2015 $
d296 6
@


1.40
log
@update NAME section to include all documented functions,
or otherwise change Dt to reflect the name of an existing function;

feedback/ok schwarze
@
text
@d1 1
a1 1
.\"	$OpenBSD: select.2,v 1.39 2015/09/21 06:06:54 guenther Exp $
d33 1
a33 1
.Dd $Mdocdate: September 21 2015 $
a295 8
.Pp
Internally to the kernel,
.Fn select
and
.Fn pselect
work poorly if multiple processes wait on the same file descriptor.
Given that, it is rather surprising to see that many daemons are
written that way.
@


1.39
log
@Add STANDARDS section and another EINVAL reason
@
text
@d1 1
a1 1
.\"	$OpenBSD: select.2,v 1.38 2015/03/02 21:15:34 millert Exp $
d33 1
a33 1
.Dd $Mdocdate: March 2 2015 $
d38 5
a42 1
.Nm pselect
@


1.38
log
@Document out-of-band data on a socket as an example of an exceptional
condition.
@
text
@d1 1
a1 1
.\"	$OpenBSD: select.2,v 1.37 2014/03/13 10:12:11 florian Exp $
d33 1
a33 1
.Dd $Mdocdate: March 13 2014 $
d185 3
d200 7
@


1.37
log
@Unhook httpd(8) from build; man page bits
tweaks jmc@@
OK krw@@, gilles@@, lteo@@, tedu@@, todd@@, benno@@, sthen@@
"The time is right." and much help getting the show on the
road deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: select.2,v 1.36 2014/01/29 14:00:07 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate: January 29 2014 $
d60 2
@


1.36
log
@e.g. not i.e.
From: Ross L Richardson
@
text
@d1 1
a1 1
.\"	$OpenBSD: select.2,v 1.35 2013/12/04 07:39:25 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate: December 4 2013 $
d287 1
a287 2
written that way (e.g.,
.Xr httpd 8 ) .
@


1.35
log
@tweak from deraadt;
@
text
@d1 1
a1 1
.\"	$OpenBSD: select.2,v 1.34 2013/12/04 07:28:53 jmc Exp $
d287 1
a287 1
written that way (i.e.,
@


1.34
log
@update BUGS to reflect previous; as advised by
guenther and deraadt
@
text
@d1 1
a1 1
.\"	$OpenBSD: select.2,v 1.33 2013/12/03 23:00:51 naddy Exp $
d33 1
a33 1
.Dd $Mdocdate: December 3 2013 $
d222 1
a222 1
before the inclusion of any system headers.
@


1.33
log
@Remove string.h dependency from sys/select.h; from FreeBSD, tweaked
by deraadt@@.  Sync man page.

ok guenther@@, deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: select.2,v 1.32 2013/11/02 17:25:34 espie Exp $
d33 1
a33 1
.Dd $Mdocdate: November 2 2013 $
d222 1
a222 2
before the inclusion of
.Aq Pa sys/types.h .
@


1.32
log
@.Xr clock_gettime
okay deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: select.2,v 1.31 2013/07/17 05:42:11 schwarze Exp $
d33 1
a33 1
.Dd $Mdocdate: July 17 2013 $
d41 1
a41 4
.Fd #include <sys/types.h>
.Fd #include <sys/time.h>
.Fd #include <string.h>
.Fd #include <unistd.h>
@


1.31
log
@more library history
facts checked by sobrado@@
style tweaks and ok jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: select.2,v 1.30 2013/05/05 01:07:46 tedu Exp $
d33 1
a33 1
.Dd $Mdocdate: May 5 2013 $
d189 1
@


1.30
log
@no need to cast calloc
@
text
@d1 1
a1 1
.\"	$OpenBSD: select.2,v 1.29 2013/04/29 17:06:20 matthew Exp $
d33 1
a33 1
.Dd $Mdocdate: April 29 2013 $
d200 2
a201 2
function appeared in
.Bx 4.2 .
d204 1
a204 1
function appeared in
@


1.29
log
@Extend P_SIGSUSPEND handling in userret() to properly restore the
sigmask even if there are no pending signals under the temporary
sigmask.

Refactor existing select() and poll() system calls to introduce the
pselect() and ppoll() system calls.

Add rthread wrappers for pselect() and ppoll().  While there, update
cancellation point comments to reflect recent fdatasync() addition.

Minor bumps for libc and librthread due to new symbols.

ok guenther, millert, deraadt, jmc
@
text
@d1 1
a1 1
.\"	$OpenBSD: select.2,v 1.28 2007/05/31 19:19:33 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate: May 31 2007 $
d241 1
a241 2
fdsr = (fd_set *)calloc(howmany(max+1, NFDBITS),
    sizeof(fd_mask));
@


1.28
log
@convert to new .Dd format;
@
text
@d1 1
a1 1
.\"	$OpenBSD: select.2,v 1.27 2004/04/15 19:52:18 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate$
d37 2
a38 1
.Nm select
d47 2
d128 17
d146 1
d148 10
a157 3
returns the number of ready descriptors that are contained in
the descriptor sets, or \-1 if an error occurred.
If the time limit expires,
d159 5
a163 5
returns 0.
If
.Fn select
returns with an error, including one due to an interrupted call,
the descriptor sets will be unmodified.
d167 2
d182 1
a182 1
before any of the selected events occurred.
d200 1
a200 1
function call appeared in
d202 4
d287 3
a289 1
works poorly if multiple processes wait on the same file descriptor.
@


1.27
log
@various improvements to lists and displays:

.Pp removal
-compact removal for displays
other list/display errors
@
text
@d1 1
a1 1
.\"	$OpenBSD: select.2,v 1.26 2004/02/08 19:20:23 otto Exp $
d33 1
a33 1
.Dd March 25, 1994
@


1.26
log
@FD_SETSIZE has been cranked up to 1024
ok deraadt@@ millert@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: select.2,v 1.25 2004/01/23 23:08:46 jmc Exp $
d203 3
a205 4
.Pp
.Bd -literal -offset indent -compact
	fd_set *fdsr;
	int max = fd;
d207 3
a209 8
	fdsr = (fd_set *)calloc(howmany(max+1, NFDBITS),
	    sizeof(fd_mask));
	if (fdsr == NULL) {
		...
		return (-1);
	}
	FD_SET(fd, fdsr);
	n = select(max+1, fdsr, NULL, NULL, &tv);
d211 6
a216 1
	free(fdsr);
@


1.25
log
@`Ns' implies `No', so `Ns No' -> `Ns'; (even simpler in adduser(8))
discussed with todd@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: select.2,v 1.24 2003/07/30 13:03:07 henning Exp $
d182 1
a182 1
(currently 256),
@


1.24
log
@missing #include
Claudio Jeker, PR3382
@
text
@d1 1
a1 1
.\"	$OpenBSD: select.2,v 1.23 2003/06/02 20:18:39 millert Exp $
d64 1
a64 1
.Fa nfds Ns No -1
@


1.23
log
@Remove the advertising clause in the UCB license which Berkeley
rescinded 22 July 1999.  Proofed by myself and Theo.
@
text
@d1 1
a1 1
.\"	$OpenBSD: select.2,v 1.22 2003/06/01 21:23:15 jmc Exp $
d42 1
@


1.22
log
@- section reorder
- macro cleanup
@
text
@d1 1
a1 1
.\"	$OpenBSD: select.2,v 1.21 2002/11/19 20:57:13 millert Exp $
d15 1
a15 5
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgement:
.\"	This product includes software developed by the University of
.\"	California, Berkeley and its contributors.
.\" 4. Neither the name of the University nor the names of its contributors
@


1.21
log
@typo; Stefan Berg
@
text
@d1 1
a1 1
.\"	$OpenBSD: select.2,v 1.20 2001/09/04 08:04:08 deraadt Exp $
d170 5
d249 1
a249 1
.Fn select Ns ,
a260 5
.Sh HISTORY
The
.Fn select
function call appeared in
.Bx 4.2 .
@


1.20
log
@clarify fd_set size definition
@
text
@d1 1
a1 1
.\"	$OpenBSD: select.2,v 1.19 2001/03/03 21:32:35 deraadt Exp $
d131 1
a131 1
the descriptor sets, or \-1 is an error occurred.
@


1.19
log
@typo
@
text
@d1 1
a1 1
.\"	$OpenBSD: select.2,v 1.18 2000/10/18 05:12:11 aaron Exp $
d176 3
a178 1
The default size
d180 3
a182 2
(currently 256) is somewhat smaller than
the current kernel limit to the number of open files.
@


1.18
log
@Another round of man page cleanup, this time to remove more hard sentence
breaks and getting rid of short lines, making these files easier to work with.
@
text
@d1 1
a1 1
.\"	$OpenBSD: select.2,v 1.17 2000/04/15 02:15:24 aaron Exp $
d203 1
a203 1
	fsdr = (fd_set *)calloc(howmany(max+1, NFDBITS),
@


1.17
log
@Mostly punctuation fixes.
@
text
@d1 1
a1 1
.\"	$OpenBSD: select.2,v 1.16 2000/01/22 02:17:55 aaron Exp $
d108 2
a109 1
selection to complete.  If
d111 2
a112 1
is a null pointer, the select blocks indefinitely.  To effect a poll, the
d131 1
a131 2
the descriptor sets,
or \-1 if an error occurred.
d137 1
a137 2
returns with an error,
including one due to an interrupted call,
d157 2
a158 2
The specified time limit is invalid.  One of its components is
negative or too large.
d192 2
a193 2
bit-arrays dynamically.  The idea is to permit a program to
work properly even if it is
@


1.16
log
@ie. -> i.e.,
@
text
@d1 1
a1 1
.\"	$OpenBSD: select.2,v 1.15 1999/09/23 04:12:00 alex Exp $
d245 1
a245 1
.Xr getitimer 2 Ns ).
d252 1
a252 1
.Xr httpd 8 ).
@


1.15
log
@Typo fixes.
@
text
@d1 1
a1 1
.\"	$OpenBSD: select.2,v 1.14 1999/06/29 14:10:17 aaron Exp $
d251 1
a251 1
written that way (ie.
@


1.14
log
@- change references to nil to null; tschroed@@acm.org
- remove trailing spaces from end of lines
- add some .Dv
- change -1 to \-1, so `-' is taken as a negative sign
- other misc formatting fixes
@
text
@d1 1
a1 1
.\"	$OpenBSD: select.2,v 1.13 1999/05/23 14:10:55 aaron Exp $
d233 1
a233 1
In general, due to the existance of those brain-damaged
@


1.13
log
@remove argument from .Os macros so value in /usr/share/tmac/mdoc/doc-common
is used instead; kwesterback@@home.com
@
text
@d1 1
a1 1
.\"	$OpenBSD: select.2,v 1.12 1999/05/16 19:55:35 alex Exp $
d107 2
a108 2
is a non-nil pointer, it specifies a maximum interval to wait for the
selection to complete.  If 
d110 1
a110 1
is a nil pointer, the select blocks indefinitely.  To effect a poll, the
d112 1
a112 1
argument should be non-nil, pointing to a zero-valued timeval structure.
d125 1
a125 1
may be given as nil pointers if no descriptors are of interest.
d130 1
a130 1
or -1 if an error occurred.
@


1.12
log
@Cleanup xrefs under SEE ALSO.  Specifically:

  - Sort xrefs by section, and then alphabetically.
  - Add missing commas between xref items.
  - Remove commas from the last xref entry.
  - Remove duplicate entries.
@
text
@d1 1
a1 1
.\"	$OpenBSD: select.2,v 1.11 1999/03/11 01:35:01 pjanzen Exp $
d39 1
a39 1
.Os BSD 4.2
@


1.11
log
@fix more comma splices that involve misuse of conjunctive adverbs
@
text
@d1 1
a1 1
.\"	$OpenBSD: select.2,v 1.10 1999/03/02 10:32:31 deraadt Exp $
a162 1
.Xr getdtablesize 3 ,
d168 2
a169 1
.Xr write 2
@


1.10
log
@describe some additional things many people do not know
@
text
@d1 1
a1 1
.\"	$OpenBSD: select.2,v 1.9 1999/02/27 21:56:44 deraadt Exp $
d116 2
a117 2
and may be reused on subsequent calls, however it is good style to re-initialize
it before each invocation of
@


1.9
log
@make function names the correct case
@
text
@d1 1
a1 1
.\"	$OpenBSD: select.2,v 1.8 1998/07/06 18:28:24 deraadt Exp $
d187 38
d229 7
a235 4
However, it is unlikely this semantic will ever be implemented, as the
change would cause source code compatibility problems.
In general it is unwise to assume that the timeout value will be
unmodified by the
d238 15
@


1.8
log
@fix openbsd tag
@
text
@d1 1
a1 1
.\"	$OpenBSD: select.2,v 1.5 1995/06/27 22:32:28 cgd Exp $
d113 1
a113 1
.Fa Timeout
@


1.7
log
@do not needlessly uppercase function names
@
text
@d1 1
@


1.6
log
@fix Xr
@
text
@d53 1
a53 1
.Fn Select
d73 1
a73 1
.Fn Select
d126 1
a126 1
.Fn Select
d187 1
a187 1
.Fn Select
@


1.5
log
@doc EFAULT and xref poll(2)
@
text
@d162 1
a162 1
.Xr getdtablesize 2 ,
d171 1
a171 1
.Xr getdtablesize 2
@


1.4
log
@clarify how timeout behaves
@
text
@d143 7
d164 1
@


1.3
log
@effect, danny@@panda.hilink.com.au
@
text
@d112 6
d180 6
a185 5
should probably return the time remaining from the original timeout,
if any, by modifying the time value in place.
This may be implemented in future versions of the system.
Thus, it is unwise to assume that the timeout value will be unmodified
by the
d187 1
a187 1
call.
@


1.2
log
@larger -> smaller.
@
text
@d109 1
a109 1
is a nil pointer, the select blocks indefinitely.  To affect a poll, the
@


1.1
log
@Initial revision
@
text
@d163 1
a163 1
(currently 256) is somewhat larger than
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
