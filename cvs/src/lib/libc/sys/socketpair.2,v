head	1.20;
access;
symbols
	OPENBSD_6_0:1.20.0.2
	OPENBSD_6_0_BASE:1.20
	OPENBSD_5_9:1.18.0.4
	OPENBSD_5_9_BASE:1.18
	OPENBSD_5_8:1.18.0.6
	OPENBSD_5_8_BASE:1.18
	OPENBSD_5_7:1.18.0.2
	OPENBSD_5_7_BASE:1.18
	OPENBSD_5_6:1.15.0.8
	OPENBSD_5_6_BASE:1.15
	OPENBSD_5_5:1.15.0.6
	OPENBSD_5_5_BASE:1.15
	OPENBSD_5_4:1.15.0.2
	OPENBSD_5_4_BASE:1.15
	OPENBSD_5_3:1.14.0.6
	OPENBSD_5_3_BASE:1.14
	OPENBSD_5_2:1.14.0.4
	OPENBSD_5_2_BASE:1.14
	OPENBSD_5_1_BASE:1.14
	OPENBSD_5_1:1.14.0.2
	OPENBSD_5_0:1.13.0.18
	OPENBSD_5_0_BASE:1.13
	OPENBSD_4_9:1.13.0.16
	OPENBSD_4_9_BASE:1.13
	OPENBSD_4_8:1.13.0.14
	OPENBSD_4_8_BASE:1.13
	OPENBSD_4_7:1.13.0.10
	OPENBSD_4_7_BASE:1.13
	OPENBSD_4_6:1.13.0.12
	OPENBSD_4_6_BASE:1.13
	OPENBSD_4_5:1.13.0.8
	OPENBSD_4_5_BASE:1.13
	OPENBSD_4_4:1.13.0.6
	OPENBSD_4_4_BASE:1.13
	OPENBSD_4_3:1.13.0.4
	OPENBSD_4_3_BASE:1.13
	OPENBSD_4_2:1.13.0.2
	OPENBSD_4_2_BASE:1.13
	OPENBSD_4_1:1.12.0.16
	OPENBSD_4_1_BASE:1.12
	OPENBSD_4_0:1.12.0.14
	OPENBSD_4_0_BASE:1.12
	OPENBSD_3_9:1.12.0.12
	OPENBSD_3_9_BASE:1.12
	OPENBSD_3_8:1.12.0.10
	OPENBSD_3_8_BASE:1.12
	OPENBSD_3_7:1.12.0.8
	OPENBSD_3_7_BASE:1.12
	OPENBSD_3_6:1.12.0.6
	OPENBSD_3_6_BASE:1.12
	OPENBSD_3_5:1.12.0.4
	OPENBSD_3_5_BASE:1.12
	OPENBSD_3_4:1.12.0.2
	OPENBSD_3_4_BASE:1.12
	OPENBSD_3_3:1.10.0.16
	OPENBSD_3_3_BASE:1.10
	OPENBSD_3_2:1.10.0.14
	OPENBSD_3_2_BASE:1.10
	OPENBSD_3_1:1.10.0.12
	OPENBSD_3_1_BASE:1.10
	OPENBSD_3_0:1.10.0.10
	OPENBSD_3_0_BASE:1.10
	OPENBSD_2_9:1.10.0.8
	OPENBSD_2_9_BASE:1.10
	OPENBSD_2_8:1.10.0.6
	OPENBSD_2_8_BASE:1.10
	OPENBSD_2_7:1.10.0.4
	OPENBSD_2_7_BASE:1.10
	OPENBSD_2_6:1.10.0.2
	OPENBSD_2_6_BASE:1.10
	OPENBSD_2_5:1.4.0.4
	OPENBSD_2_5_BASE:1.4
	OPENBSD_2_4:1.4.0.2
	OPENBSD_2_4_BASE:1.4
	OPENBSD_2_3:1.1.1.1.0.8
	OPENBSD_2_3_BASE:1.1.1.1
	OPENBSD_2_2:1.1.1.1.0.6
	OPENBSD_2_2_BASE:1.1.1.1
	OPENBSD_2_1:1.1.1.1.0.4
	OPENBSD_2_1_BASE:1.1.1.1
	OPENBSD_2_0:1.1.1.1.0.2
	OPENBSD_2_0_BASE:1.1.1.1
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@.\" @;


1.20
date	2016.05.29.06.01.24;	author guenther;	state Exp;
branches;
next	1.19;
commitid	4lz2RlpD7rt4WGS8;

1.19
date	2016.03.19.22.10.49;	author guenther;	state Exp;
branches;
next	1.18;
commitid	XtVrZ6zBlSAffki3;

1.18
date	2014.12.14.07.42.50;	author schwarze;	state Exp;
branches;
next	1.17;
commitid	4RSteAc4BFbAOGs6;

1.17
date	2014.12.10.19.19.00;	author schwarze;	state Exp;
branches;
next	1.16;
commitid	sADK4BTCz4ZrHHo9;

1.16
date	2014.08.31.01.42.36;	author guenther;	state Exp;
branches;
next	1.15;
commitid	zF5A8BuuSSyqaDyM;

1.15
date	2013.04.08.19.49.55;	author guenther;	state Exp;
branches;
next	1.14;

1.14
date	2011.11.06.12.07.42;	author deraadt;	state Exp;
branches;
next	1.13;

1.13
date	2007.05.31.19.19.34;	author jmc;	state Exp;
branches;
next	1.12;

1.12
date	2003.06.02.20.18.39;	author millert;	state Exp;
branches;
next	1.11;

1.11
date	2003.06.01.21.23.15;	author jmc;	state Exp;
branches;
next	1.10;

1.10
date	99.07.06.18.21.04;	author deraadt;	state Exp;
branches;
next	1.9;

1.9
date	99.06.29.14.10.24;	author aaron;	state Exp;
branches;
next	1.8;

1.8
date	99.05.27.16.54.24;	author aaron;	state Exp;
branches;
next	1.7;

1.7
date	99.05.23.14.10.56;	author aaron;	state Exp;
branches;
next	1.6;

1.6
date	99.05.16.19.55.40;	author alex;	state Exp;
branches;
next	1.5;

1.5
date	99.04.28.20.59.35;	author aaron;	state Exp;
branches;
next	1.4;

1.4
date	98.06.08.17.24.01;	author deraadt;	state Exp;
branches;
next	1.3;

1.3
date	98.04.27.16.11.58;	author millert;	state Exp;
branches;
next	1.2;

1.2
date	98.04.26.22.40.41;	author millert;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.42.29;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.42.29;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.20
log
@Prefer AF_* over PF_* and 'address family' over 'protocol family'

ok jung@@
@
text
@.\"	$OpenBSD: socketpair.2,v 1.19 2016/03/19 22:10:49 guenther Exp $
.\"	$NetBSD: socketpair.2,v 1.5 1995/02/27 12:38:00 cgd Exp $
.\"
.\" Copyright (c) 1983, 1991, 1993
.\"	The Regents of the University of California.  All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. Neither the name of the University nor the names of its contributors
.\"    may be used to endorse or promote products derived from this software
.\"    without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.\"     @@(#)socketpair.2	8.1 (Berkeley) 6/4/93
.\"
.Dd $Mdocdate: March 19 2016 $
.Dt SOCKETPAIR 2
.Os
.Sh NAME
.Nm socketpair
.Nd create a pair of connected sockets
.Sh SYNOPSIS
.In sys/socket.h
.Ft int
.Fn socketpair "int d" "int type" "int protocol" "int sv[2]"
.Sh DESCRIPTION
The
.Fn socketpair
call creates an unnamed pair of connected sockets in
the specified domain
.Fa d ,
of the specified
.Fa type ,
and using the optionally specified
.Fa protocol .
The descriptors used in referencing the new sockets
are returned in
.Fa sv Ns [0]
and
.Fa sv Ns [1] .
The two sockets are indistinguishable.
.Pp
Any combination of the following flags may additionally be used in the
.Fa type
argument:
.Pp
.Bl -tag -width "SOCK_NONBLOCKX" -offset indent -compact
.It SOCK_CLOEXEC
Set close-on-exec flag on both the new descriptors.
.It SOCK_NONBLOCK
Set non-blocking I/O mode on both the new sockets.
.El
.Sh RETURN VALUES
.Rv -std
.Sh ERRORS
The call succeeds unless:
.Bl -tag -width Er
.It Bq Er EAFNOSUPPORT
The specified address family is not supported on this machine.
.It Bq Er EPROTONOSUPPORT
The specified protocol is not supported on this machine.
.It Bq Er EOPNOTSUPP
The specified protocol does not support creation of socket pairs.
.It Bq Er EPROTOTYPE
The combination of the specified protocol and type is not supported.
.It Bq Er EMFILE
The per-process descriptor table is full.
.It Bq Er ENFILE
The system file table is full.
.It Bq Er ENOBUFS
Insufficient resources were available in the system
to perform the operation.
.It Bq Er EFAULT
The address
.Fa sv
does not specify a valid part of the
process address space.
.El
.Sh SEE ALSO
.Xr pipe 2 ,
.Xr read 2 ,
.Xr socket 2 ,
.Xr write 2
.Sh STANDARDS
The
.Fn socketpair
function conforms to
.St -p1003.1-2008 .
The
.Dv SOCK_CLOEXEC
and
.Dv SOCK_NONBLOCK
flags are expected to conform to a future revision of that standard.
.Sh HISTORY
The
.Fn socketpair
function call appeared in
.Bx 4.2 .
Support for the
.Dv SOCK_CLOEXEC
and
.Dv SOCK_NONBLOCK
flags appeared in
.Ox 5.7 .
.Sh BUGS
This call is currently implemented only for the LOCAL domain.
Many operating systems only accept a
.Fa protocol
of
.Dv AF_UNSPEC ,
so that should be used instead of
.Dv AF_LOCAL
for maximal portability.
@


1.19
log
@Add STANDARDS and HISTORY blurbs for SOCK_{NONBLOCK,CLOEXEC,DNS}
@
text
@d1 1
a1 1
.\"	$OpenBSD: socketpair.2,v 1.18 2014/12/14 07:42:50 schwarze Exp $
d33 1
a33 1
.Dd $Mdocdate: December 14 2014 $
d127 1
a127 1
.Dv PF_UNSPEC ,
d129 1
a129 1
.Dv PF_LOCAL
@


1.18
log
@macro cleanup; from Kaspars at Bankovskis dot net
@
text
@d1 1
a1 1
.\"	$OpenBSD: socketpair.2,v 1.17 2014/12/10 19:19:00 schwarze Exp $
d33 1
a33 1
.Dd $Mdocdate: December 10 2014 $
d106 5
d116 6
@


1.17
log
@use .Rv; no change of meaning; from Kaspars at Bankovskis dot net
@
text
@d1 1
a1 1
.\"	$OpenBSD: socketpair.2,v 1.16 2014/08/31 01:42:36 guenther Exp $
d33 1
a33 1
.Dd $Mdocdate: August 31 2014 $
d112 1
a112 3
This call is currently implemented only for the
.Tn LOCAL
domain.
d114 1
a114 1
.Ar protocol
@


1.16
log
@Add additional kernel interfaces for setting close-on-exec on fds
when creating them: pipe2(), dup3(), accept4(), MSG_CMSG_CLOEXEC,
SOCK_CLOEXEC.  Includes SOCK_NONBLOCK support.

ok matthew@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: socketpair.2,v 1.15 2013/04/08 19:49:55 guenther Exp $
d33 1
a33 1
.Dd $Mdocdate: April 8 2013 $
d71 1
a71 1
A 0 is returned if the call succeeds, \-1 if it fails.
@


1.15
log
@Updates to SYNOPSIS, ERRORS, and STANDARDS.
@
text
@d1 1
a1 1
.\"	$OpenBSD: socketpair.2,v 1.14 2011/11/06 12:07:42 deraadt Exp $
d33 1
a33 1
.Dd $Mdocdate: November 6 2011 $
d40 1
a40 1
.Fd #include <sys/socket.h>
d59 11
@


1.14
log
@.Ev -> .Dv
@
text
@d1 1
a1 1
.\"	$OpenBSD: socketpair.2,v 1.13 2007/05/31 19:19:34 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate: May 31 2007 $
a39 1
.Fd #include <sys/types.h>
d42 1
a42 1
.Fn socketpair "int d" "int type" "int protocol" "int *sv"
a63 2
.It Bq Er EMFILE
Too many descriptors are in use by this process.
d70 9
a83 2
.It Bq Er ENFILE
The system file table is full.
d88 1
d94 1
a94 1
.St -xpg4.2 .
@


1.13
log
@convert to new .Dd format;
@
text
@d1 1
a1 1
.\"	$OpenBSD: socketpair.2,v 1.12 2003/06/02 20:18:39 millert Exp $
d33 1
a33 1
.Dd $Mdocdate$
d102 1
a102 1
.Ev PF_UNSPEC ,
d104 1
a104 1
.Ev PF_LOCAL
@


1.12
log
@Remove the advertising clause in the UCB license which Berkeley
rescinded 22 July 1999.  Proofed by myself and Theo.
@
text
@d1 1
a1 1
.\"	$OpenBSD: socketpair.2,v 1.11 2003/06/01 21:23:15 jmc Exp $
d33 1
a33 1
.Dd June 4, 1993
@


1.11
log
@- section reorder
- macro cleanup
@
text
@d1 1
a1 1
.\"	$OpenBSD: socketpair.2,v 1.10 1999/07/06 18:21:04 deraadt Exp $
d15 1
a15 5
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgement:
.\"	This product includes software developed by the University of
.\"	California, Berkeley and its contributors.
.\" 4. Neither the name of the University nor the names of its contributors
@


1.10
log
@these can also return ENFILE
@
text
@d1 1
a1 1
.\"	$OpenBSD: socketpair.2,v 1.9 1999/06/29 14:10:24 aaron Exp $
d89 10
a109 10
.Sh STANDARDS
The
.Fn socketpair
function conforms to
.St -xpg4.2 .
.Sh HISTORY
The
.Fn socketpair
function call appeared in
.Bx 4.2 .
@


1.9
log
@- change references to nil to null; tschroed@@acm.org
- remove trailing spaces from end of lines
- add some .Dv
- change -1 to \-1, so `-' is taken as a negative sign
- other misc formatting fixes
@
text
@d1 1
a1 1
.\"	$OpenBSD: socketpair.2,v 1.8 1999/05/27 16:54:24 aaron Exp $
d82 2
@


1.8
log
@add missing .El macros (which properly terminate .Bl macro lists)
@
text
@d1 1
a1 1
.\"	$OpenBSD: socketpair.2,v 1.7 1999/05/23 14:10:56 aaron Exp $
d65 1
a65 1
A 0 is returned if the call succeeds, -1 if it fails.
@


1.7
log
@remove argument from .Os macros so value in /usr/share/tmac/mdoc/doc-common
is used instead; kwesterback@@home.com
@
text
@d1 1
a1 1
.\"	$OpenBSD: socketpair.2,v 1.6 1999/05/16 19:55:40 alex Exp $
d82 1
@


1.6
log
@Cleanup xrefs under SEE ALSO.  Specifically:

  - Sort xrefs by section, and then alphabetically.
  - Add missing commas between xref items.
  - Remove commas from the last xref entry.
  - Remove duplicate entries.
@
text
@d1 1
a1 1
.\"	$OpenBSD: socketpair.2,v 1.5 1999/04/28 20:59:35 aaron Exp $
d39 1
a39 1
.Os BSD 4.2
@


1.5
log
@no such errno EOPNOSUPPORT, make it EOPNOTSUPP as it ought to be
@
text
@d1 1
a1 1
.\"	$OpenBSD: socketpair.2,v 1.4 1998/06/08 17:24:01 deraadt Exp $
d83 1
a84 1
.Xr pipe 2 ,
@


1.4
log
@clean; kleink
@
text
@d1 1
a1 1
.\"	$OpenBSD: socketpair.2,v 1.3 1998/04/27 16:11:58 millert Exp $
d75 1
a75 1
.It Bq Er EOPNOSUPPORT
d84 2
a85 2
.Xr write 2 ,
.Xr pipe 2
@


1.3
log
@fix .Ev usage
@
text
@d1 1
a1 1
.\"	$OpenBSD: socketpair.2,v 1.2 1998/04/26 22:40:41 millert Exp $
d64 1
a64 1
.Sh DIAGNOSTICS
@


1.2
log
@Allow PF_LOCAL as the proto arg in socketpair(2).  Previously, only
PF_UNSPEC would work.  Needed for general sanity as well as XPG4.2.
@
text
@d1 1
a1 1
.\"	$OpenBSD$
d93 1
a93 2
.Ev
PF_UNSPEC ,
d95 1
a95 2
.Ev
PF_LOCAL
@


1.1
log
@Initial revision
@
text
@d1 1
d88 1
a88 1
.Tn UNIX
d90 14
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
