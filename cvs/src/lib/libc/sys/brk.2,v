head	1.22;
access;
symbols
	OPENBSD_6_1:1.22.0.6
	OPENBSD_6_1_BASE:1.22
	OPENBSD_6_0:1.22.0.4
	OPENBSD_6_0_BASE:1.22
	OPENBSD_5_9:1.22.0.2
	OPENBSD_5_9_BASE:1.22
	OPENBSD_5_8:1.20.0.4
	OPENBSD_5_8_BASE:1.20
	OPENBSD_5_7:1.19.0.2
	OPENBSD_5_7_BASE:1.19
	OPENBSD_5_6:1.18.0.28
	OPENBSD_5_6_BASE:1.18
	OPENBSD_5_5:1.18.0.26
	OPENBSD_5_5_BASE:1.18
	OPENBSD_5_4:1.18.0.22
	OPENBSD_5_4_BASE:1.18
	OPENBSD_5_3:1.18.0.20
	OPENBSD_5_3_BASE:1.18
	OPENBSD_5_2:1.18.0.18
	OPENBSD_5_2_BASE:1.18
	OPENBSD_5_1_BASE:1.18
	OPENBSD_5_1:1.18.0.16
	OPENBSD_5_0:1.18.0.14
	OPENBSD_5_0_BASE:1.18
	OPENBSD_4_9:1.18.0.12
	OPENBSD_4_9_BASE:1.18
	OPENBSD_4_8:1.18.0.10
	OPENBSD_4_8_BASE:1.18
	OPENBSD_4_7:1.18.0.6
	OPENBSD_4_7_BASE:1.18
	OPENBSD_4_6:1.18.0.8
	OPENBSD_4_6_BASE:1.18
	OPENBSD_4_5:1.18.0.4
	OPENBSD_4_5_BASE:1.18
	OPENBSD_4_4:1.18.0.2
	OPENBSD_4_4_BASE:1.18
	OPENBSD_4_3:1.17.0.4
	OPENBSD_4_3_BASE:1.17
	OPENBSD_4_2:1.17.0.2
	OPENBSD_4_2_BASE:1.17
	OPENBSD_4_1:1.16.0.6
	OPENBSD_4_1_BASE:1.16
	OPENBSD_4_0:1.16.0.4
	OPENBSD_4_0_BASE:1.16
	OPENBSD_3_9:1.16.0.2
	OPENBSD_3_9_BASE:1.16
	OPENBSD_3_8:1.15.0.2
	OPENBSD_3_8_BASE:1.15
	OPENBSD_3_7:1.14.0.8
	OPENBSD_3_7_BASE:1.14
	OPENBSD_3_6:1.14.0.6
	OPENBSD_3_6_BASE:1.14
	OPENBSD_3_5:1.14.0.4
	OPENBSD_3_5_BASE:1.14
	OPENBSD_3_4:1.14.0.2
	OPENBSD_3_4_BASE:1.14
	OPENBSD_3_3:1.12.0.12
	OPENBSD_3_3_BASE:1.12
	OPENBSD_3_2:1.12.0.10
	OPENBSD_3_2_BASE:1.12
	OPENBSD_3_1:1.12.0.8
	OPENBSD_3_1_BASE:1.12
	OPENBSD_3_0:1.12.0.6
	OPENBSD_3_0_BASE:1.12
	OPENBSD_2_9:1.12.0.4
	OPENBSD_2_9_BASE:1.12
	OPENBSD_2_8:1.12.0.2
	OPENBSD_2_8_BASE:1.12
	OPENBSD_2_7:1.11.0.2
	OPENBSD_2_7_BASE:1.11
	OPENBSD_2_6:1.9.0.2
	OPENBSD_2_6_BASE:1.9
	OPENBSD_2_5:1.6.0.4
	OPENBSD_2_5_BASE:1.6
	OPENBSD_2_4:1.6.0.2
	OPENBSD_2_4_BASE:1.6
	OPENBSD_2_3:1.4.0.4
	OPENBSD_2_3_BASE:1.4
	OPENBSD_2_2:1.4.0.2
	OPENBSD_2_2_BASE:1.4
	OPENBSD_2_1:1.2.0.2
	OPENBSD_2_1_BASE:1.2
	OPENBSD_2_0:1.1.1.1.0.2
	OPENBSD_2_0_BASE:1.1.1.1
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@.\" @;


1.22
date	2015.10.11.07.53.49;	author guenther;	state Exp;
branches;
next	1.21;
commitid	IaeylBmMgjVh99i0;

1.21
date	2015.09.10.17.55.21;	author schwarze;	state Exp;
branches;
next	1.20;
commitid	PeV7Ql0T6htfMjhP;

1.20
date	2015.03.26.00.48.51;	author bentley;	state Exp;
branches;
next	1.19;
commitid	CZYTfxTXW0Voh0G2;

1.19
date	2014.12.10.19.19.00;	author schwarze;	state Exp;
branches;
next	1.18;
commitid	sADK4BTCz4ZrHHo9;

1.18
date	2008.04.24.20.43.20;	author kurt;	state Exp;
branches;
next	1.17;

1.17
date	2007.05.31.19.19.32;	author jmc;	state Exp;
branches;
next	1.16;

1.16
date	2005.11.20.02.24.59;	author millert;	state Exp;
branches;
next	1.15;

1.15
date	2005.08.10.01.06.13;	author jaredy;	state Exp;
branches;
next	1.14;

1.14
date	2003.06.02.20.18.38;	author millert;	state Exp;
branches;
next	1.13;

1.13
date	2003.06.01.20.02.39;	author jmc;	state Exp;
branches;
next	1.12;

1.12
date	2000.10.18.05.12.08;	author aaron;	state Exp;
branches;
next	1.11;

1.11
date	2000.04.15.02.15.24;	author aaron;	state Exp;
branches;
next	1.10;

1.10
date	2000.03.14.21.31.40;	author aaron;	state Exp;
branches;
next	1.9;

1.9
date	99.06.29.14.09.50;	author aaron;	state Exp;
branches;
next	1.8;

1.8
date	99.05.23.14.10.50;	author aaron;	state Exp;
branches;
next	1.7;

1.7
date	99.05.16.19.55.19;	author alex;	state Exp;
branches;
next	1.6;

1.6
date	98.07.06.18.27.07;	author deraadt;	state Exp;
branches;
next	1.5;

1.5
date	98.06.08.17.17.12;	author deraadt;	state Exp;
branches;
next	1.4;

1.4
date	97.09.26.01.22.39;	author millert;	state Exp;
branches;
next	1.3;

1.3
date	97.06.13.10.08.29;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	97.02.02.00.16.32;	author tholo;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.42.24;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.42.24;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.22
log
@Prefer .Fa over .Em for struct members

ok jmc@@
@
text
@.\"	$OpenBSD: brk.2,v 1.21 2015/09/10 17:55:21 schwarze Exp $
.\"	$NetBSD: brk.2,v 1.7 1995/02/27 12:31:57 cgd Exp $
.\"
.\" Copyright (c) 1980, 1991, 1993
.\"	The Regents of the University of California.  All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. Neither the name of the University nor the names of its contributors
.\"    may be used to endorse or promote products derived from this software
.\"    without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.\"     @@(#)brk.2	8.2 (Berkeley) 12/11/93
.\"
.Dd $Mdocdate: September 10 2015 $
.Dt BRK 2
.Os
.Sh NAME
.Nm brk ,
.Nm sbrk
.Nd change data segment size
.Sh SYNOPSIS
.In unistd.h
.Ft int
.Fn brk "void *addr"
.Ft void *
.Fn sbrk "int incr"
.Sh DESCRIPTION
.Bf -symbolic
The
.Fn brk
and
.Fn sbrk
functions are historical curiosities
left over from earlier days before the advent of virtual memory management.
.Ef
The
.Fn brk
function sets the break or lowest address
of a process's data segment (uninitialized data) to
.Fa addr
(immediately above bss).
Data addressing is restricted between
.Fa addr
and the lowest stack pointer to the stack segment.
Memory is allocated by
.Fn brk
in page size pieces;
if
.Fa addr
is not evenly divisible by the system page size, it is
increased to the next page boundary.
.Pp
.\" The
.\" .Nm sbrk
.\" function
.\" allocates chunks of
.\" .Fa incr
.\" bytes
.\" to the process's data space
.\" and returns an address pointer.
.\" The
.\" .Xr malloc 3
.\" function utilizes
.\" .Nm sbrk .
.\" .Pp
The current value of the program break is reliably returned by
.Dq Li sbrk(0)
(see also
.Xr end 3 ) .
The
.Xr getrlimit 2
system call may be used to determine
the maximum permissible size of the
.Em data
segment;
it will not be possible to set the break
beyond the
.Fa rlim_max
value returned from a call to
.Xr getrlimit 2 ,
e.g.,
.Ql etext + rlp->rlim_max
(see
.Xr end 3
for the definition of
.Em etext ) .
.Sh RETURN VALUES
.Rv -std brk
.Pp
The
.Fn sbrk
function returns a pointer to the base of the new storage if successful;
otherwise \-1 with
.Va errno
set to indicate why the allocation failed.
.Sh ERRORS
.Fn sbrk
will fail and no additional memory will be allocated if
one of the following are true:
.Bl -tag -width Er
.It Bq Er ENOMEM
The limit, as set by
.Xr setrlimit 2 ,
was exceeded.
.It Bq Er ENOMEM
The maximum possible size of a data segment (compiled into the
system) was exceeded.
.It Bq Er ENOMEM
Insufficient space existed in the swap area
to support the expansion.
.El
.Sh SEE ALSO
.Xr execve 2 ,
.Xr getrlimit 2 ,
.Xr mmap 2 ,
.Xr end 3 ,
.Xr malloc 3
.Sh HISTORY
A
.Fn brk
function call appeared in
.At v7 .
.Sh BUGS
Setting the break may fail due to a temporary lack of swap space.
It is not possible to distinguish this from a failure caused by exceeding
the maximum size of the data segment without consulting
.Xr getrlimit 2 .
@


1.21
log
@use .In rather than .Fd #include
@
text
@d1 1
a1 1
.\"	$OpenBSD: brk.2,v 1.20 2015/03/26 00:48:51 bentley Exp $
d33 1
a33 1
.Dd $Mdocdate: March 26 2015 $
d97 1
a97 1
.Em rlim_max
@


1.20
log
@Use -> instead of a right arrow when referring to C's -> operator.

with input from jmc@@ schwarze@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: brk.2,v 1.19 2014/12/10 19:19:00 schwarze Exp $
d33 1
a33 1
.Dd $Mdocdate: December 10 2014 $
d41 1
a41 1
.Fd #include <unistd.h>
@


1.19
log
@use .Rv; no change of meaning; from Kaspars at Bankovskis dot net
@
text
@d1 1
a1 1
.\"	$OpenBSD: brk.2,v 1.18 2008/04/24 20:43:20 kurt Exp $
d33 1
a33 1
.Dd $Mdocdate: April 24 2008 $
d101 1
a101 1
.Dq etext + rlp\(->rlim_max
@


1.18
log
@- correct brk(2) prototype and man page to match implementation and POSIX.
brk(2) returns an int value not a void *. brk(2) returns 0 upon success not
a pointer to the new end of memory. okay millert@@, kettenis@@, deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: brk.2,v 1.17 2007/05/31 19:19:32 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate$
d107 2
a108 5
.Fn brk
returns 0 if successful;
otherwise \-1 with
.Va errno
set to indicate why the allocation failed.
@


1.17
log
@convert to new .Dd format;
@
text
@d1 1
a1 1
.\"	$OpenBSD: brk.2,v 1.16 2005/11/20 02:24:59 millert Exp $
d42 1
a42 1
.Ft void *
d108 1
a108 1
returns a pointer to the new end of memory if successful;
@


1.16
log
@brk() and sbrk() should use void *, not char *.  Note that sbrk()
should take intptr_t, not int, but we don't presently have intptr_t
available from unistd.h.  OK marco@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: brk.2,v 1.15 2005/08/10 01:06:13 jaredy Exp $
d33 1
a33 1
.Dd December 11, 1993
@


1.15
log
@- punctuation fixes
- refer to formal parameters consistently.

ok jmc
@
text
@d1 1
a1 1
.\"	$OpenBSD: brk.2,v 1.14 2003/06/02 20:18:38 millert Exp $
d42 3
a44 3
.Ft char *
.Fn brk "const char *addr"
.Ft char *
@


1.14
log
@Remove the advertising clause in the UCB license which Berkeley
rescinded 22 July 1999.  Proofed by myself and Theo.
@
text
@d1 1
a1 1
.\"	$OpenBSD: brk.2,v 1.13 2003/06/01 20:02:39 jmc Exp $
d101 1
a101 1
.Dq etext + rlp\(->rlim_max .
@


1.13
log
@- section reorder
- merge COMPATIBILITY
- kill whitespace at EOL
- tidy up macros
@
text
@d1 1
a1 1
.\"	$OpenBSD: brk.2,v 1.12 2000/10/18 05:12:08 aaron Exp $
d15 1
a15 5
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgement:
.\"	This product includes software developed by the University of
.\"	California, Berkeley and its contributors.
.\" 4. Neither the name of the University nor the names of its contributors
@


1.12
log
@Another round of man page cleanup, this time to remove more hard sentence
breaks and getting rid of short lines, making these files easier to work with.
@
text
@d1 1
a1 1
.\"	$OpenBSD: brk.2,v 1.11 2000/04/15 02:15:24 aaron Exp $
d103 1
a103 1
.Xr getrlimit ,
a143 5
.Sh BUGS
Setting the break may fail due to a temporary lack of swap space.
It is not possible to distinguish this from a failure caused by exceeding
the maximum size of the data segment without consulting
.Xr getrlimit .
d149 5
@


1.11
log
@Mostly punctuation fixes.
@
text
@d1 1
a1 1
.\"	$OpenBSD: brk.2,v 1.10 2000/03/14 21:31:40 aaron Exp $
d61 1
a61 2
function
sets the break or lowest address
d145 3
a147 4
Setting the break may fail due to a temporary lack of
swap space.  It is not possible to distinguish this
from a failure caused by exceeding the maximum size of
the data segment without consulting
@


1.10
log
@Suffix "i.e." and "e.g." with a comma. Just another really picky man page
commit, as we want our documentation to be as consistently formatted as
possible (it's getting there :-)).
@
text
@d1 1
a1 1
.\"	$OpenBSD: brk.2,v 1.9 1999/06/29 14:09:50 aaron Exp $
d106 1
a106 1
.Dq etext + rlp\(->rlim_max.
@


1.9
log
@- change references to nil to null; tschroed@@acm.org
- remove trailing spaces from end of lines
- add some .Dv
- change -1 to \-1, so `-' is taken as a negative sign
- other misc formatting fixes
@
text
@d1 1
a1 1
.\"	$OpenBSD: brk.2,v 1.8 1999/05/23 14:10:50 aaron Exp $
d105 1
a105 1
e.g.
@


1.8
log
@remove argument from .Os macros so value in /usr/share/tmac/mdoc/doc-common
is used instead; kwesterback@@home.com
@
text
@d1 1
a1 1
.\"	$OpenBSD: brk.2,v 1.7 1999/05/16 19:55:19 alex Exp $
d52 5
a56 1
The brk and sbrk functions are historical curiosities
d70 1
a70 1
.Fa brk
d92 1
a92 1
(see also 
d112 1
a112 1
.Nm brk
d114 1
a114 1
otherwise -1 with
d118 1
a118 1
.Nm sbrk
d120 1
a120 1
otherwise -1 with
d124 1
a124 1
.Nm sbrk
d149 1
a149 1
the data segment without consulting 
d154 1
a154 1
function call appeared in 
@


1.7
log
@Cleanup xrefs under SEE ALSO.  Specifically:

  - Sort xrefs by section, and then alphabetically.
  - Add missing commas between xref items.
  - Remove commas from the last xref entry.
  - Remove duplicate entries.
@
text
@d1 1
a1 1
.\"	$OpenBSD: brk.2,v 1.6 1998/07/06 18:27:07 deraadt Exp $
d39 1
a39 1
.Os BSD 4
@


1.6
log
@fix openbsd tag
@
text
@d1 1
a1 1
.\"	$OpenBSD: brk.2,v 1.7 1995/02/27 12:31:57 cgd Exp $
a137 1
.Xr malloc 3 ,
d139 2
a140 1
.Xr end 3
@


1.5
log
@do not needlessly uppercase function names
@
text
@d1 1
@


1.4
log
@Fix typo.  From maximum entropy <entropy@@tardis.bernstein.com>
@
text
@d107 1
a107 1
.Nm Brk
d119 1
a119 1
.Nm Sbrk
@


1.3
log
@fix lots of .Xr and other minor things
@
text
@d101 1
a101 1
.Dq qetext + rlp\(->rlim_max.
@


1.2
log
@Correct type of brk(), use <unistd.h>, reference mmap(2); from NetBSD
@
text
@d119 1
a119 1
.Xr Sbrk
@


1.1
log
@Initial revision
@
text
@d44 2
a45 2
.Fd #include <sys/types.h>
.Ft int
d138 1
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
