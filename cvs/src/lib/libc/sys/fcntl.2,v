head	1.31;
access;
symbols
	OPENBSD_6_2:1.31.0.10
	OPENBSD_6_2_BASE:1.31
	OPENBSD_6_1:1.31.0.12
	OPENBSD_6_1_BASE:1.31
	OPENBSD_6_0:1.31.0.8
	OPENBSD_6_0_BASE:1.31
	OPENBSD_5_9:1.31.0.4
	OPENBSD_5_9_BASE:1.31
	OPENBSD_5_8:1.31.0.6
	OPENBSD_5_8_BASE:1.31
	OPENBSD_5_7:1.31.0.2
	OPENBSD_5_7_BASE:1.31
	OPENBSD_5_6:1.30.0.8
	OPENBSD_5_6_BASE:1.30
	OPENBSD_5_5:1.30.0.6
	OPENBSD_5_5_BASE:1.30
	OPENBSD_5_4:1.30.0.2
	OPENBSD_5_4_BASE:1.30
	OPENBSD_5_3:1.29.0.2
	OPENBSD_5_3_BASE:1.29
	OPENBSD_5_2:1.28.0.22
	OPENBSD_5_2_BASE:1.28
	OPENBSD_5_1_BASE:1.28
	OPENBSD_5_1:1.28.0.20
	OPENBSD_5_0:1.28.0.18
	OPENBSD_5_0_BASE:1.28
	OPENBSD_4_9:1.28.0.16
	OPENBSD_4_9_BASE:1.28
	OPENBSD_4_8:1.28.0.14
	OPENBSD_4_8_BASE:1.28
	OPENBSD_4_7:1.28.0.10
	OPENBSD_4_7_BASE:1.28
	OPENBSD_4_6:1.28.0.12
	OPENBSD_4_6_BASE:1.28
	OPENBSD_4_5:1.28.0.8
	OPENBSD_4_5_BASE:1.28
	OPENBSD_4_4:1.28.0.6
	OPENBSD_4_4_BASE:1.28
	OPENBSD_4_3:1.28.0.4
	OPENBSD_4_3_BASE:1.28
	OPENBSD_4_2:1.28.0.2
	OPENBSD_4_2_BASE:1.28
	OPENBSD_4_1:1.27.0.8
	OPENBSD_4_1_BASE:1.27
	OPENBSD_4_0:1.27.0.6
	OPENBSD_4_0_BASE:1.27
	OPENBSD_3_9:1.27.0.4
	OPENBSD_3_9_BASE:1.27
	OPENBSD_3_8:1.27.0.2
	OPENBSD_3_8_BASE:1.27
	OPENBSD_3_7:1.25.0.4
	OPENBSD_3_7_BASE:1.25
	OPENBSD_3_6:1.25.0.2
	OPENBSD_3_6_BASE:1.25
	OPENBSD_3_5:1.23.0.4
	OPENBSD_3_5_BASE:1.23
	OPENBSD_3_4:1.23.0.2
	OPENBSD_3_4_BASE:1.23
	OPENBSD_3_3:1.20.0.2
	OPENBSD_3_3_BASE:1.20
	OPENBSD_3_2:1.19.0.2
	OPENBSD_3_2_BASE:1.19
	OPENBSD_3_1:1.18.0.8
	OPENBSD_3_1_BASE:1.18
	OPENBSD_3_0:1.18.0.6
	OPENBSD_3_0_BASE:1.18
	OPENBSD_2_9:1.18.0.4
	OPENBSD_2_9_BASE:1.18
	OPENBSD_2_8:1.18.0.2
	OPENBSD_2_8_BASE:1.18
	OPENBSD_2_7:1.17.0.4
	OPENBSD_2_7_BASE:1.17
	OPENBSD_2_6:1.17.0.2
	OPENBSD_2_6_BASE:1.17
	OPENBSD_2_5:1.9.0.2
	OPENBSD_2_5_BASE:1.9
	OPENBSD_2_4:1.8.0.2
	OPENBSD_2_4_BASE:1.8
	OPENBSD_2_3:1.6.0.2
	OPENBSD_2_3_BASE:1.6
	OPENBSD_2_2:1.4.0.2
	OPENBSD_2_2_BASE:1.4
	OPENBSD_2_1:1.1.1.1.0.4
	OPENBSD_2_1_BASE:1.1.1.1
	OPENBSD_2_0:1.1.1.1.0.2
	OPENBSD_2_0_BASE:1.1.1.1
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@.\" @;


1.31
date	2014.12.16.00.06.49;	author schwarze;	state Exp;
branches;
next	1.30;
commitid	V04BuZyu1wULJQGU;

1.30
date	2013.03.31.08.35.46;	author guenther;	state Exp;
branches;
next	1.29;

1.29
date	2013.01.19.21.57.57;	author millert;	state Exp;
branches;
next	1.28;

1.28
date	2007.05.31.19.19.32;	author jmc;	state Exp;
branches;
next	1.27;

1.27
date	2005.08.10.01.29.26;	author jaredy;	state Exp;
branches;
next	1.26;

1.26
date	2005.05.25.05.23.24;	author pascoe;	state Exp;
branches;
next	1.25;

1.25
date	2004.05.06.19.08.53;	author millert;	state Exp;
branches;
next	1.24;

1.24
date	2004.05.05.20.47.23;	author millert;	state Exp;
branches;
next	1.23;

1.23
date	2003.06.02.20.18.39;	author millert;	state Exp;
branches;
next	1.22;

1.22
date	2003.06.01.20.02.40;	author jmc;	state Exp;
branches;
next	1.21;

1.21
date	2003.03.28.20.05.11;	author millert;	state Exp;
branches;
next	1.20;

1.20
date	2003.03.06.20.04.06;	author jmc;	state Exp;
branches;
next	1.19;

1.19
date	2002.09.19.17.19.08;	author millert;	state Exp;
branches;
next	1.18;

1.18
date	2000.10.18.05.12.09;	author aaron;	state Exp;
branches;
next	1.17;

1.17
date	99.07.05.06.08.05;	author aaron;	state Exp;
branches;
next	1.16;

1.16
date	99.07.04.18.59.43;	author aaron;	state Exp;
branches;
next	1.15;

1.15
date	99.06.29.14.23.28;	author aaron;	state Exp;
branches;
next	1.14;

1.14
date	99.06.29.14.09.54;	author aaron;	state Exp;
branches;
next	1.13;

1.13
date	99.05.25.22.38.01;	author aaron;	state Exp;
branches;
next	1.12;

1.12
date	99.05.23.14.10.51;	author aaron;	state Exp;
branches;
next	1.11;

1.11
date	99.05.16.19.55.23;	author alex;	state Exp;
branches;
next	1.10;

1.10
date	99.05.10.17.56.29;	author aaron;	state Exp;
branches;
next	1.9;

1.9
date	99.02.27.21.56.14;	author deraadt;	state Exp;
branches;
next	1.8;

1.8
date	98.07.24.00.43.47;	author espie;	state Exp;
branches;
next	1.7;

1.7
date	98.07.06.18.27.17;	author deraadt;	state Exp;
branches;
next	1.6;

1.6
date	97.11.24.07.24.54;	author deraadt;	state Exp;
branches;
next	1.5;

1.5
date	97.11.12.21.50.22;	author deraadt;	state Exp;
branches;
next	1.4;

1.4
date	97.08.18.15.38.14;	author deraadt;	state Exp;
branches;
next	1.3;

1.3
date	97.07.17.07.38.17;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	97.06.13.10.08.31;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.42.25;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.42.25;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.31
log
@use .In and delete .Tn; from Kaspars at Bankovskis dot net
@
text
@.\"	$OpenBSD: fcntl.2,v 1.30 2013/03/31 08:35:46 guenther Exp $
.\"	$NetBSD: fcntl.2,v 1.6 1995/02/27 12:32:29 cgd Exp $
.\"
.\" Copyright (c) 1983, 1993
.\"	The Regents of the University of California.  All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. Neither the name of the University nor the names of its contributors
.\"    may be used to endorse or promote products derived from this software
.\"    without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.\"     @@(#)fcntl.2	8.2 (Berkeley) 1/12/94
.\"
.Dd $Mdocdate: March 31 2013 $
.Dt FCNTL 2
.Os
.Sh NAME
.Nm fcntl
.Nd file control
.Sh SYNOPSIS
.In fcntl.h
.Ft int
.Fn fcntl "int fd" "int cmd" "..."
.Sh DESCRIPTION
The
.Fn fcntl
provides control over the properties of a file that is already open.
The argument
.Fa fd
is a descriptor to be operated on by
.Fa cmd
as described below.
The third parameter is called
.Fa arg
and is technically a pointer to
.Fa void ,
but is interpreted as an
.Li int
by some commands, a pointer to a
.Li struct flock
by others (see below), and ignored by the rest.
.Pp
The commands are:
.Bl -tag -width F_DUPFD_CLOEXEC
.It Dv F_DUPFD
Return a new descriptor as follows:
.Pp
.Bl -bullet -compact
.It
Lowest numbered available descriptor greater than or equal to
.Fa arg
(interpreted as an
.Li int ) .
.It
Same object references as the original descriptor.
.It
New descriptor shares the same file offset if the object
was a file.
.It
Same access mode (read, write or read/write).
.It
Same file status flags (i.e., both file descriptors
share the same file status flags).
.It
The close-on-exec flag associated with the new file descriptor
is set to remain open across
.Xr execve 2
calls.
.El
.It Dv F_DUPFD_CLOEXEC
Like
.Dv F_DUPFD ,
but the
.Dv FD_CLOEXEC
flag associated with the new file descriptor is set, so the file descriptor
is closed when
.Xr execve 2
is called.
.It Dv F_GETFD
Get the close-on-exec flag associated with the file descriptor
.Fa fd
as
.Dv FD_CLOEXEC .
If the returned value ANDed with
.Dv FD_CLOEXEC
is 0,
the file will remain open across
.Fn exec ,
otherwise the file will be closed upon execution of
.Fn exec
.Fa ( arg
is ignored).
.It Dv F_SETFD
Set the close-on-exec flag associated with
.Fa fd
to
.Fa arg ,
where
.Fa arg
(interpreted as an
.Li int )
is either 0 or
.Dv FD_CLOEXEC ,
as described above.
.It Dv F_GETFL
Get file status flags associated with the file descriptor
.Fa fd ,
as described below
.Fa ( arg
is ignored).
.It Dv F_SETFL
Set file status flags associated with the file descriptor
.Fa fd
to
.Fa arg
(interpreted as an
.Li int ) .
.It Dv F_GETOWN
Get the process ID or process group
currently receiving
.Dv SIGIO
and
.Dv SIGURG
signals; process groups are returned
as negative values
.Fa ( arg
is ignored).
.It Dv F_SETOWN
Set the process or process group
to receive
.Dv SIGIO
and
.Dv SIGURG
signals;
process groups are specified by supplying
.Fa arg
(interpreted as an
.Li int )
as negative, otherwise
.Fa arg
is taken as a process ID.
.El
.Pp
The flags for the
.Dv F_GETFL
and
.Dv F_SETFL
commands are as follows:
.Bl -tag -width O_NONBLOCKX
.It Dv O_NONBLOCK
Non-blocking I/O; if no data is available to a
.Xr read 2
call, or if a
.Xr write 2
operation would block,
the read or write call returns \-1 with the error
.Er EAGAIN .
.It Dv O_APPEND
Force each write to append at the end of file;
corresponds to the
.Dv O_APPEND
flag of
.Xr open 2 .
.It Dv O_ASYNC
Enable the
.Dv SIGIO
signal to be sent to the process group when I/O is possible, e.g.,
upon availability of data to be read.
.It Dv O_SYNC
Cause writes to be synchronous.
Data will be written to the physical device instead of
just being stored in the buffer cache; corresponds to the
.Dv O_SYNC
flag of
.Xr open 2 .
.El
.Pp
Several commands are available for doing advisory file locking;
they all operate on the following structure:
.Bd -literal
struct flock {
	off_t	l_start;	/* starting offset */
	off_t	l_len;		/* len = 0 means until end of file */
	pid_t	l_pid;		/* lock owner */
	short	l_type;		/* lock type: read/write, etc. */
	short	l_whence;	/* type of l_start */
};
.Ed
.Pp
The commands available for advisory record locking are as follows:
.Bl -tag -width F_SETLKWX
.It Dv F_GETLK
Get the first lock that blocks the lock description pointed to by the
third argument,
.Fa arg ,
taken as a pointer to a
.Fa "struct flock"
(see above).
The information retrieved overwrites the information passed to
.Fn fcntl
in the
.Fa flock
structure.
If no lock is found that would prevent this lock from being created,
the structure is left unchanged by this function call except for the
lock type which is set to
.Dv F_UNLCK .
.It Dv F_SETLK
Set or clear a file segment lock according to the lock description
pointed to by the third argument,
.Fa arg ,
taken as a pointer to a
.Fa "struct flock"
(see above).
.Dv F_SETLK
is used to establish shared (or read) locks
.Pq Dv F_RDLCK
or exclusive (or write) locks
.Pq Dv F_WRLCK ,
as well as remove either type of lock
.Pq Dv F_UNLCK .
If a shared or exclusive lock cannot be set,
.Fn fcntl
returns immediately with
.Er EAGAIN .
.It Dv F_SETLKW
This command is the same as
.Dv F_SETLK
except that if a shared or exclusive lock is blocked by other locks,
the process waits until the request can be satisfied.
If a signal that is to be caught is received while
.Fn fcntl
is waiting for a region, the
.Fn fcntl
will be interrupted if the signal handler has not specified the
.Dv SA_RESTART
(see
.Xr sigaction 2 ) .
.El
.Pp
When a shared lock has been set on a segment of a file,
other processes can set shared locks on that segment
or a portion of it.
A shared lock prevents any other process from setting an exclusive
lock on any portion of the protected area.
A request for a shared lock fails if the file descriptor was not
opened with read access.
.Pp
An exclusive lock prevents any other process from setting a shared lock or
an exclusive lock on any portion of the protected area.
A request for an exclusive lock fails if the file was not
opened with write access.
.Pp
The value of
.Fa l_whence
is
.Dv SEEK_SET ,
.Dv SEEK_CUR ,
or
.Dv SEEK_END
to indicate that the relative offset,
.Fa l_start
bytes, will be measured from the start of the file,
current position, or end of the file, respectively.
The value of
.Fa l_len
is the number of consecutive bytes to be locked.
If
.Fa l_len
is negative, the result is undefined.
The
.Fa l_pid
field is only used with
.Dv F_GETLK
to return the process ID of the process holding a blocking lock.
After a successful
.Dv F_GETLK
request, the value of
.Fa l_whence
is
.Dv SEEK_SET .
.Pp
Locks may start and extend beyond the current end of a file,
but may not start or extend before the beginning of the file.
A lock is set to extend to the largest possible value of the
file offset for that file if
.Fa l_len
is set to zero.
If
.Fa l_whence
and
.Fa l_start
point to the beginning of the file, and
.Fa l_len
is zero, the entire file is locked.
If an application wishes only to do entire file locking, the
.Xr flock 2
system call is much more efficient.
.Pp
There is at most one type of lock set for each byte in the file.
Before a successful return from an
.Dv F_SETLK
or an
.Dv F_SETLKW
request when the calling process has previously existing locks
on bytes in the region specified by the request,
the previous lock type for each byte in the specified
region is replaced by the new lock type.
As specified above under the descriptions
of shared locks and exclusive locks, an
.Dv F_SETLK
or an
.Dv F_SETLKW
request fails or blocks respectively when another process has existing
locks on bytes in the specified region and the type of any of those
locks conflicts with the type specified in the request.
.Pp
This interface follows the completely stupid semantics of System V and
.St -p1003.1-88
that require that all locks associated with a file for a given process are
removed when
.Em any
file descriptor for that file is closed by that process.
This semantic means that applications must be aware of any files that
a subroutine library may access.
For example if an application for updating the password file locks the
password file database while making the update, and then calls
.Xr getpwnam 3
to retrieve a record,
the lock will be lost because
.Xr getpwnam 3
opens, reads, and closes the password database.
The database close will release all locks that the process has
associated with the database, even if the library routine never
requested a lock on the database.
Another minor semantic problem with this interface is that
locks are not inherited by a child process created using the
.Xr fork 2
function.
The
.Xr flock 2
interface has much more rational last close semantics and
allows locks to be inherited by child processes.
.Xr flock 2
is recommended for applications that want to ensure the integrity
of their locks when using library routines or wish to pass locks
to their children.
Note that
.Xr flock 2
and
.Fn fcntl
locks may be safely used concurrently.
.Pp
All locks associated with a file for a given process are
removed when the process terminates.
.Pp
A potential for deadlock occurs if a process controlling a locked region
is put to sleep by attempting to lock the locked region of another process.
This implementation detects that sleeping until a locked region is unlocked
would cause a deadlock and fails with an
.Er EDEADLK
error.
.Sh RETURN VALUES
Upon successful completion, the value returned depends on
.Fa cmd
as follows:
.Bl -tag -width F_DUPFD_CLOEXEC -offset indent
.It Dv F_DUPFD
A new file descriptor.
.It Dv F_DUPFD_CLOEXEC
A new file descriptor.
.It Dv F_GETFD
Value of flag (only the low-order bit is defined).
.It Dv F_GETFL
Value of flags.
.It Dv F_GETOWN
Value of file descriptor owner.
.It other
Value other than \-1.
.El
.Pp
Otherwise, a value of \-1 is returned and
.Va errno
is set to indicate the error.
.Sh ERRORS
.Fn fcntl
will fail if:
.Bl -tag -width Er
.It Bq Er EAGAIN
The argument
.Fa cmd
is
.Dv F_SETLK ,
the type of lock
.Pq Fa l_type
is a shared lock
.Pq Dv F_RDLCK
or exclusive lock
.Pq Dv F_WRLCK ,
and the segment of a file to be locked is already
exclusive-locked by another process;
or the type is an exclusive lock and some portion of the
segment of a file to be locked is already shared-locked or
exclusive-locked by another process.
.It Bq Er EBADF
.Fa fd
is not a valid open file descriptor.
.Pp
The argument
.Fa cmd
is
.Dv F_SETLK
or
.Dv F_SETLKW ,
the type of lock
.Pq Fa l_type
is a shared lock
.Pq Dv F_RDLCK ,
and
.Fa fd
is not a valid file descriptor open for reading.
.Pp
The argument
.Fa cmd
is
.Dv F_SETLK
or
.Dv F_SETLKW ,
the type of lock
.Pq Fa l_type
is an exclusive lock
.Pq Dv F_WRLCK ,
and
.Fa fd
is not a valid file descriptor open for writing.
.It Bq Er EDEADLK
The argument
.Fa cmd
is
.Dv F_SETLKW ,
and a deadlock condition was detected.
.It Bq Er EINTR
The argument
.Fa cmd
is invalid.
.Pp
The argument
.Fa cmd
is
.Dv F_SETLKW ,
and the function was interrupted by a signal.
.It Bq Er EINVAL
.Fa cmd
is
.Dv F_DUPFD
and
.Fa arg
is negative or greater than the maximum allowable number
(see
.Xr getdtablesize 3 ) .
.Pp
The argument
.Fa cmd
is
.Dv F_GETLK ,
.Dv F_SETLK ,
or
.Dv F_SETLKW
and the data to which
.Fa arg
points is not valid, or
.Fa fd
refers to a file that does not support locking.
.It Bq Er EMFILE
The argument
.Fa cmd
is
.Dv F_DUPFD
and the maximum number of open file descriptors permitted for the
process are already in use,
or no file descriptors greater than or equal to
.Fa arg
are available.
.It Bq Er ENOLCK
The argument
.Fa cmd
is
.Dv F_SETLK
or
.Dv F_SETLKW ,
and satisfying the lock or unlock request would result in the
number of locked regions in the system exceeding a system-imposed limit.
.It Bq Er ESRCH
.Fa cmd
is
.Dv F_SETOWN
and the process ID given in
.Fa arg
is not in use.
.El
.Sh SEE ALSO
.Xr close 2 ,
.Xr execve 2 ,
.Xr flock 2 ,
.Xr open 2 ,
.Xr sigaction 2 ,
.Xr getdtablesize 3
.Sh STANDARDS
The
.Fn fcntl
function conforms to
.St -p1003.1-2008 .
.Sh HISTORY
The
.Fn fcntl
function call appeared in
.Bx 4.2 .
@


1.30
log
@Updates to RETURN VALUES, ERRORS, and STANDARDS

ok jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: fcntl.2,v 1.29 2013/01/19 21:57:57 millert Exp $
d33 1
a33 1
.Dd $Mdocdate: January 19 2013 $
d40 1
a40 1
.Fd #include <fcntl.h>
d170 1
a170 3
Non-blocking
.Tn I/O ;
if no data is available to a
d186 1
a186 4
signal to be sent to the process group
when
.Tn I/O
is possible, e.g.,
@


1.29
log
@Document F_DUPFD_CLOEXEC; adapted from FreeBSD
OK miod@@ espie@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: fcntl.2,v 1.28 2007/05/31 19:19:32 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate: May 31 2007 $
d391 1
a391 1
.Bl -tag -width F_GETOWNX -offset indent
d394 2
d469 4
d532 5
@


1.28
log
@convert to new .Dd format;
@
text
@d1 1
a1 1
.\"	$OpenBSD: fcntl.2,v 1.27 2005/08/10 01:29:26 jaredy Exp $
d33 1
a33 1
.Dd $Mdocdate$
d63 1
a63 1
.Bl -tag -width F_GETOWNX
d86 1
a86 1
.Xr execv 3
d89 9
@


1.27
log
@- layout, macro, and punctuation tweaks
- refer to formal parameters consistently
- kill a duplicate description of EMFILE in ERRORS

ok jmc
@
text
@d1 1
a1 1
.\"	$OpenBSD: fcntl.2,v 1.26 2005/05/25 05:23:24 pascoe Exp $
d33 1
a33 1
.Dd January 12, 1994
@


1.26
log
@Minor wordink fix

ok dlg@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: fcntl.2,v 1.25 2004/05/06 19:08:53 millert Exp $
d67 1
a67 1
.Bl -bullet -compact -offset 4n
d232 3
a234 3
.Dv (F_RDLCK)
or exclusive (or write) locks,
.Dv (F_WRLCK) ,
d236 1
a236 1
.Dv (F_UNLCK) .
d336 3
a338 1
removed when \fIany\fP file descriptor for that file is closed by that process.
d408 1
a408 1
.Fa (l_type)
d410 1
a410 1
.Dv (F_RDLCK)
d412 1
a412 1
.Dv (F_WRLCK) ,
d419 1
a419 1
.Fa fildes
d429 1
a429 1
.Fa (l_type)
d431 1
a431 1
.Dv (F_RDLCK) ,
d433 1
a433 1
.Fa fildes
d443 1
a443 1
.Fa (l_type)
d445 1
a445 1
.Dv (F_WRLCK) ,
d447 1
a447 1
.Fa fildes
a448 6
.It Bq Er EMFILE
.Fa cmd
is
.Dv F_DUPFD
and the maximum allowed number of file descriptors are currently
open.
d481 1
a481 1
.Fa fildes
d488 1
a488 1
and the maximum number of file descriptors permitted for the
d506 3
a508 2
and
the process ID given as argument is not in use.
@


1.25
log
@Tyop; noted by jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: fcntl.2,v 1.24 2004/05/05 20:47:23 millert Exp $
d158 1
a158 1
flags are as follows:
@


1.24
log
@O_SYNC is valid for F_GETFL/F_SETFL too
@
text
@d1 1
a1 1
.\"	$OpenBSD: fcntl.2,v 1.23 2003/06/02 20:18:39 millert Exp $
d185 1
a185 1
Cause writes to be syncronous.
@


1.23
log
@Remove the advertising clause in the UCB license which Berkeley
rescinded 22 July 1999.  Proofed by myself and Theo.
@
text
@d1 1
a1 1
.\"	$OpenBSD: fcntl.2,v 1.22 2003/06/01 20:02:40 jmc Exp $
d184 7
@


1.22
log
@- section reorder
- merge COMPATIBILITY
- kill whitespace at EOL
- tidy up macros
@
text
@d1 1
a1 1
.\"	$OpenBSD: fcntl.2,v 1.21 2003/03/28 20:05:11 millert Exp $
d15 1
a15 5
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgement:
.\"	This product includes software developed by the University of
.\"	California, Berkeley and its contributors.
.\" 4. Neither the name of the University nor the names of its contributors
@


1.21
log
@F_[GS]ETFL deal with file status flags, not descriptor status flags.
Closes PR 3172
@
text
@d1 1
a1 1
.\"	$OpenBSD: fcntl.2,v 1.20 2003/03/06 20:04:06 jmc Exp $
d361 1
a361 1
.Xr fcntl 2
@


1.20
log
@.Xr typos;

ok deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: fcntl.2,v 1.19 2002/09/19 17:19:08 millert Exp $
d120 3
a122 1
Get descriptor status flags, as described below
d126 3
a128 1
Set descriptor status flags to
@


1.19
log
@Document FD_CLOEXEC; from FreeBSD (Peter Jeremy)
@
text
@d1 1
a1 1
.\"	$OpenBSD: fcntl.2,v 1.18 2000/10/18 05:12:09 aaron Exp $
d334 1
a334 1
.Xr getpwname 3
d337 1
a337 1
.Xr getpwname 3
@


1.18
log
@Another round of man page cleanup, this time to remove more hard sentence
breaks and getting rid of short lines, making these files easier to work with.
@
text
@d1 1
a1 1
.\"	$OpenBSD: fcntl.2,v 1.17 1999/07/05 06:08:05 aaron Exp $
d95 6
a100 2
.Fa fd .
If the low-order bit of the returned value is 0,
d110 3
a112 1
to the low-order bit of
d115 4
a118 3
.Li int ) .
The flag should be specified as 0 (do not close-on-exec) or
1 (do close-on-exec).
@


1.17
log
@use .Li to refer to data types
@
text
@d1 1
a1 1
.\"	$OpenBSD: fcntl.2,v 1.16 1999/07/04 18:59:43 aaron Exp $
d289 2
a290 1
is set to zero. If
@


1.16
log
@trash some old leftover macros and replace them with -mdoc macros
@
text
@d1 1
a1 1
.\"	$OpenBSD: fcntl.2,v 1.15 1999/06/29 14:23:28 aaron Exp $
d63 1
a63 1
.Fa struct flock
@


1.15
log
@.Fa int -> .Li int (should use literal macro to refer to data types)
@
text
@d1 1
a1 1
.\"	$OpenBSD: fcntl.2,v 1.14 1999/06/29 14:09:54 aaron Exp $
a180 1
.ne 7v
@


1.14
log
@- change references to nil to null; tschroed@@acm.org
- remove trailing spaces from end of lines
- add some .Dv
- change -1 to \-1, so `-' is taken as a negative sign
- other misc formatting fixes
@
text
@d1 1
a1 1
.\"	$OpenBSD: fcntl.2,v 1.13 1999/05/25 22:38:01 aaron Exp $
d61 1
a61 1
.Fa int
d76 1
a76 1
.Fa int ) .
d109 1
a109 1
.Fa int ) .
d120 1
a120 1
.Fa int ) .
d141 1
a141 1
.Fa int )
@


1.13
log
@explain the third argument more thoroughly; some cmds take it as an int,
others a pointer to a struct flock (record locking), and the rest ignore it
@
text
@d1 1
a1 1
.\"	$OpenBSD: fcntl.2,v 1.12 1999/05/23 14:10:51 aaron Exp $
d142 1
a142 1
as negative, otherwise 
d161 1
a161 1
the read or write call returns -1 with the error
d329 1
a329 1
the lock will be lost because 
d347 1
a347 1
Note that 
d349 1
a349 1
and 
d376 1
a376 1
Value other than -1.
d379 1
a379 1
Otherwise, a value of -1 is returned and
@


1.12
log
@remove argument from .Os macros so value in /usr/share/tmac/mdoc/doc-common
is used instead; kwesterback@@home.com
@
text
@d1 1
a1 1
.\"	$OpenBSD: fcntl.2,v 1.11 1999/05/16 19:55:23 alex Exp $
d46 1
a46 1
.Fn fcntl "int fd" "int cmd" "int arg"
d48 1
d50 1
a50 1
provides for control over descriptors.
d55 12
a66 1
as follows:
d74 3
a76 1
.Fa arg .
d106 1
a106 1
to the low order bit of
d108 4
a111 1
(0 or 1 as above).
d118 3
a120 1
.Fa arg .
d140 2
d144 1
a144 1
is interpreted as a process ID.
d154 3
a156 1
Non-blocking I/O; if no data is available to a
d173 3
a175 1
when I/O is possible, e.g.,
d202 1
a202 1
.Nm fcntl
d225 1
a225 1
.Nm fcntl
d234 1
a234 1
.Nm fcntl
d236 1
a236 1
.Nm fcntl
@


1.11
log
@Cleanup xrefs under SEE ALSO.  Specifically:

  - Sort xrefs by section, and then alphabetically.
  - Add missing commas between xref items.
  - Remove commas from the last xref entry.
  - Remove duplicate entries.
@
text
@d1 1
a1 1
.\"	$OpenBSD: fcntl.2,v 1.10 1999/05/10 17:56:29 aaron Exp $
d39 1
a39 1
.Os BSD 4.2
@


1.10
log
@correct some Xr's which referred to the wrong man page sections
@
text
@d1 1
a1 1
.\"	$OpenBSD: fcntl.2,v 1.9 1999/02/27 21:56:14 deraadt Exp $
a477 1
.Xr getdtablesize 3 ,
d479 2
a480 1
.Xr sigaction 2
@


1.9
log
@make function names the correct case
@
text
@d1 1
a1 1
.\"	$OpenBSD: fcntl.2,v 1.8 1998/07/24 00:43:47 espie Exp $
d76 2
a77 2
.Xr execv 2
system calls.
@


1.8
log
@
Man pages Xrefs.
@
text
@d1 1
a1 1
.\"	$OpenBSD: fcntl.2,v 1.7 1998/07/06 18:27:17 deraadt Exp $
d48 1
a48 1
.Fn Fcntl
d318 1
a318 1
.Xr Flock 2
d358 1
a358 1
.Fn Fcntl
d378 1
a378 1
.Fa Fildes
d409 1
a409 1
.Fa Cmd
d427 1
a427 1
.Fa Cmd
d468 1
a468 1
.Fa Cmd
@


1.7
log
@fix openbsd tag
@
text
@d1 1
a1 1
.\"	$OpenBSD: fcntl.2,v 1.6 1995/02/27 12:32:29 cgd Exp $
d480 1
a480 1
.Xr sigaction 3
@


1.6
log
@missing blank lines
@
text
@d1 1
@


1.5
log
@lock failure returns EAGAIN in our world, XPG4/POSIX say either EAGAIN or EACCESS is ok, but EAGAIN is what our kernel does
@
text
@d165 1
@


1.4
log
@typo; entropy@@tardis.bernstein.com
@
text
@d200 1
a200 1
.Er EACCES .
d359 1
a359 1
.It Bq Er EACCES
d361 1
a361 1
.Fa arg
@


1.3
log
@fix Xr
@
text
@d450 1
a450 1
.Dv F_DUPED
@


1.2
log
@fix lots of .Xr and other minor things
@
text
@d432 1
a432 1
.Xr getdtablesize 2 ) .
d476 1
a476 1
.Xr getdtablesize 2 ,
@


1.1
log
@Initial revision
@
text
@d133 1
a133 1
.Xr read
d135 1
a135 1
.Xr write
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
