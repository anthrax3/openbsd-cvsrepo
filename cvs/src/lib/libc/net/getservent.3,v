head	1.21;
access;
symbols
	OPENBSD_6_0:1.21.0.14
	OPENBSD_6_0_BASE:1.21
	OPENBSD_5_9:1.21.0.10
	OPENBSD_5_9_BASE:1.21
	OPENBSD_5_8:1.21.0.12
	OPENBSD_5_8_BASE:1.21
	OPENBSD_5_7:1.21.0.4
	OPENBSD_5_7_BASE:1.21
	OPENBSD_5_6:1.21.0.8
	OPENBSD_5_6_BASE:1.21
	OPENBSD_5_5:1.21.0.6
	OPENBSD_5_5_BASE:1.21
	OPENBSD_5_4:1.21.0.2
	OPENBSD_5_4_BASE:1.21
	OPENBSD_5_3:1.20.0.24
	OPENBSD_5_3_BASE:1.20
	OPENBSD_5_2:1.20.0.22
	OPENBSD_5_2_BASE:1.20
	OPENBSD_5_1_BASE:1.20
	OPENBSD_5_1:1.20.0.20
	OPENBSD_5_0:1.20.0.18
	OPENBSD_5_0_BASE:1.20
	OPENBSD_4_9:1.20.0.16
	OPENBSD_4_9_BASE:1.20
	OPENBSD_4_8:1.20.0.14
	OPENBSD_4_8_BASE:1.20
	OPENBSD_4_7:1.20.0.10
	OPENBSD_4_7_BASE:1.20
	OPENBSD_4_6:1.20.0.12
	OPENBSD_4_6_BASE:1.20
	OPENBSD_4_5:1.20.0.8
	OPENBSD_4_5_BASE:1.20
	OPENBSD_4_4:1.20.0.6
	OPENBSD_4_4_BASE:1.20
	OPENBSD_4_3:1.20.0.4
	OPENBSD_4_3_BASE:1.20
	OPENBSD_4_2:1.20.0.2
	OPENBSD_4_2_BASE:1.20
	OPENBSD_4_1:1.19.0.8
	OPENBSD_4_1_BASE:1.19
	OPENBSD_4_0:1.19.0.6
	OPENBSD_4_0_BASE:1.19
	OPENBSD_3_9:1.19.0.4
	OPENBSD_3_9_BASE:1.19
	OPENBSD_3_8:1.19.0.2
	OPENBSD_3_8_BASE:1.19
	OPENBSD_3_7:1.16.0.2
	OPENBSD_3_7_BASE:1.16
	OPENBSD_3_6:1.13.0.4
	OPENBSD_3_6_BASE:1.13
	OPENBSD_3_5:1.13.0.2
	OPENBSD_3_5_BASE:1.13
	OPENBSD_3_4:1.12.0.2
	OPENBSD_3_4_BASE:1.12
	OPENBSD_3_3:1.11.0.10
	OPENBSD_3_3_BASE:1.11
	OPENBSD_3_2:1.11.0.8
	OPENBSD_3_2_BASE:1.11
	OPENBSD_3_1:1.11.0.6
	OPENBSD_3_1_BASE:1.11
	OPENBSD_3_0:1.11.0.4
	OPENBSD_3_0_BASE:1.11
	OPENBSD_2_9:1.11.0.2
	OPENBSD_2_9_BASE:1.11
	OPENBSD_2_8:1.9.0.4
	OPENBSD_2_8_BASE:1.9
	OPENBSD_2_7:1.9.0.2
	OPENBSD_2_7_BASE:1.9
	OPENBSD_2_6:1.8.0.2
	OPENBSD_2_6_BASE:1.8
	OPENBSD_2_5:1.4.0.2
	OPENBSD_2_5_BASE:1.4
	OPENBSD_2_4:1.3.0.10
	OPENBSD_2_4_BASE:1.3
	OPENBSD_2_3:1.3.0.8
	OPENBSD_2_3_BASE:1.3
	OPENBSD_2_2:1.3.0.6
	OPENBSD_2_2_BASE:1.3
	OPENBSD_2_1:1.3.0.4
	OPENBSD_2_1_BASE:1.3
	OPENBSD_2_0:1.3.0.2
	OPENBSD_2_0_BASE:1.3
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@.\" @;


1.21
date	2013.06.05.03.39.23;	author tedu;	state Exp;
branches;
next	1.20;

1.20
date	2007.05.31.19.19.30;	author jmc;	state Exp;
branches;
next	1.19;

1.19
date	2005.07.22.04.50.51;	author jaredy;	state Exp;
branches;
next	1.18;

1.18
date	2005.06.05.19.44.16;	author jmc;	state Exp;
branches;
next	1.17;

1.17
date	2005.06.05.19.40.21;	author jmc;	state Exp;
branches;
next	1.16;

1.16
date	2004.10.26.15.52.50;	author millert;	state Exp;
branches;
next	1.15;

1.15
date	2004.10.25.03.09.01;	author millert;	state Exp;
branches;
next	1.14;

1.14
date	2004.10.17.20.24.23;	author millert;	state Exp;
branches;
next	1.13;

1.13
date	2003.12.30.10.35.36;	author jmc;	state Exp;
branches;
next	1.12;

1.12
date	2003.06.02.20.18.35;	author millert;	state Exp;
branches;
next	1.11;

1.11
date	2000.12.24.00.30.56;	author aaron;	state Exp;
branches;
next	1.10;

1.10
date	2000.12.17.21.30.38;	author millert;	state Exp;
branches;
next	1.9;

1.9
date	2000.04.18.03.01.32;	author aaron;	state Exp;
branches;
next	1.8;

1.8
date	99.07.05.04.40.59;	author aaron;	state Exp;
branches;
next	1.7;

1.7
date	99.07.04.18.59.43;	author aaron;	state Exp;
branches;
next	1.6;

1.6
date	99.05.25.01.50.58;	author aaron;	state Exp;
branches;
next	1.5;

1.5
date	99.05.23.14.11.01;	author aaron;	state Exp;
branches;
next	1.4;

1.4
date	99.03.02.03.47.46;	author deraadt;	state Exp;
branches;
next	1.3;

1.3
date	96.08.30.02.00.11;	author millert;	state Exp;
branches;
next	1.2;

1.2
date	96.08.19.08.28.58;	author tholo;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.42.02;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.42.02;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.21
log
@Use the fancy .In macro for includes. From Jan Klemkow. ok jmc schwarze
@
text
@.\"	$OpenBSD: getservent.3,v 1.20 2007/05/31 19:19:30 jmc Exp $
.\"
.\" Copyright (c) 1983, 1991, 1993
.\"	The Regents of the University of California.  All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. Neither the name of the University nor the names of its contributors
.\"    may be used to endorse or promote products derived from this software
.\"    without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.Dd $Mdocdate: May 31 2007 $
.Dt GETSERVENT 3
.Os
.Sh NAME
.Nm getservent ,
.Nm getservent_r ,
.Nm getservbyport ,
.Nm getservbyport_r ,
.Nm getservbyname ,
.Nm getservbyname_r ,
.Nm setservent ,
.Nm setservent_r ,
.Nm endservent ,
.Nm endservent_r
.Nd get service entry
.Sh SYNOPSIS
.In netdb.h
.Ft struct servent *
.Fn getservent "void"
.Ft int
.Fn getservent_r "struct servent *servent" "struct servent_data *servent_data"
.Ft struct servent *
.Fn getservbyname "const char *name" "const char *proto"
.Ft int
.Fn getservbyname_r "const char *name" "const char *proto" "struct servent *servent" "struct servent_data *servent_data"
.Ft struct servent *
.Fn getservbyport "int port" "const char *proto"
.Ft int
.Fn getservbyport_r "int port" "const char *proto" "struct servent *servent" "struct servent_data *servent_data"
.Ft void
.Fn setservent "int stayopen"
.Ft void
.Fn setservent_r "int stayopen" "struct servent_data *servent_data"
.Ft void
.Fn endservent "void"
.Ft void
.Fn endservent_r "struct servent_data *servent_data"
.Sh DESCRIPTION
The
.Fn getservent ,
.Fn getservbyname ,
and
.Fn getservbyport
functions each return a pointer to an object with the following structure
containing the broken-out fields of a line in the network services database,
.Pa /etc/services .
.Bd -literal -offset indent
struct	servent {
	char	*s_name;	/* official name of service */
	char	**s_aliases;	/* alias list */
	int	s_port;		/* port service resides at */
	char	*s_proto;	/* protocol to use */
};
.Ed
.Pp
The members of this structure are:
.Bl -tag -width s_aliases
.It Fa s_name
The official name of the service.
.It Fa s_aliases
A null-terminated list of alternate names for the service.
.It Fa s_port
The port number at which the service resides.
Port numbers are returned in network byte order.
.It Fa s_proto
The name of the protocol to use when contacting the service.
.El
.Pp
The
.Fn getservent
function reads the next line of the file, opening the file if necessary.
.Pp
The
.Fn setservent
function opens and rewinds the file.
If the
.Fa stayopen
flag is non-zero,
the services database will not be closed after each call to
.Fn getservbyname
or
.Fn getservbyport .
.Pp
The
.Fn endservent
function closes the file.
.Pp
The
.Fn getservbyname
and
.Fn getservbyport
functions sequentially search from the beginning of the file until a
matching protocol name or port number (specified in network byte order)
is found, or until
.Dv EOF
is encountered.
If a protocol name is also supplied (non-null),
searches must also match the protocol.
.Pp
The
.Fn getservent_r ,
.Fn getservbyport_r ,
.Fn getservbyname_r ,
.Fn setservent_r ,
and
.Fn endservent_r
functions are reentrant versions of the above functions that take a
pointer to a
.Fa servent_data
structure which is used to store state information.
The structure must be zero-filled before it is used
and should be considered opaque for the sake of portability.
.Pp
The
.Fn getservent_r ,
.Fn getservbyport_r ,
and
.Fn getservbyname_r
functions
also take a pointer to a
.Fa servent
structure which is used to store the results of the database lookup.
.Sh RETURN VALUES
The
.Fn getservent ,
.Fn getservbyport ,
and
.Fn getservbyname
functions return a pointer to a
.Fa servent
structure on success or a null pointer if end-of-file
is reached or an error occurs.
.Pp
The
.Fn getservent_r ,
.Fn getservbyport_r ,
and
.Fn getservbyname_r
functions return 0 on success or \-1 if end-of-file
is reached or an error occurs.
.Sh FILES
.Bl -tag -width /etc/services -compact
.It Pa /etc/services
.El
.Sh SEE ALSO
.Xr getprotoent 3 ,
.Xr services 5
.Sh STANDARDS
The
.Fn getservent ,
.Fn getservbynumber ,
.Fn getservbyname ,
.Fn setservent ,
and
.Fn endservent
functions conform to
.St -p1003.1-2004 .
.Pp
The
.Fn getservent_r ,
.Fn getservbyport_r ,
.Fn getservbyname_r ,
.Fn setservent_r ,
and
.Fn endservent_r
functions are not currently standardized.
This implementation follows the API used by HP, IBM, and Digital.
.Sh HISTORY
The
.Fn getservent ,
.Fn getservbyport ,
.Fn getservbyname ,
.Fn setservent ,
and
.Fn endservent
functions appeared in
.Bx 4.2 .
.Pp
The
.Fn getservent_r ,
.Fn getservbyport_r ,
.Fn getservbyname_r ,
.Fn setservent_r ,
and
.Fn endservent_r
functions appeared in
.Ox 3.7 .
.Sh BUGS
The non-reentrant functions use static data storage; if the data is needed
for future use, it should be copied before any subsequent calls overwrite it.
Expecting port numbers to fit in a 32-bit quantity is probably naive.
@


1.20
log
@convert to new .Dd format;
@
text
@d1 1
a1 1
.\"	$OpenBSD: getservent.3,v 1.19 2005/07/22 04:50:51 jaredy Exp $
d30 1
a30 1
.Dd $Mdocdate$
d46 1
a46 1
.Fd #include <netdb.h>
@


1.19
log
@- sync prototypes and header file excerpts
- typos/spelling, punctuation, rewording, macro, and layout fixes.

help & ok jmc
@
text
@d1 1
a1 1
.\"	$OpenBSD: getservent.3,v 1.18 2005/06/05 19:44:16 jmc Exp $
d30 1
a30 1
.Dd October 13, 2004
@


1.18
log
@sort sections;
@
text
@d1 1
a1 1
.\"	$OpenBSD: getservent.3,v 1.17 2005/06/05 19:40:21 jmc Exp $
d90 1
a90 1
A zero-terminated list of alternate names for the service.
d108 1
a108 1
the net database will not be closed after each call to
d196 1
a196 1
This implementation follows the API used by HP, IBM and Digital.
d206 1
a207 1
.Bx 4.2 .
@


1.17
log
@s/-p1003.1-2003/-p1003.1-2004/g
@
text
@d1 1
a1 1
.\"	$OpenBSD: getservent.3,v 1.16 2004/10/26 15:52:50 millert Exp $
a151 4
.Sh FILES
.Bl -tag -width /etc/services -compact
.It Pa /etc/services
.El
d170 4
@


1.16
log
@Add STANDARDS section
@
text
@d1 1
a1 1
.\"	$OpenBSD: getservent.3,v 1.15 2004/10/25 03:09:01 millert Exp $
d186 1
a186 1
.St -p1003.1-2003 .
@


1.15
log
@Change return value of reentrant getproto* and getserv* to match the
IBM/Digital API.
@
text
@d1 1
a1 1
.\"	$OpenBSD: getservent.3,v 1.14 2004/10/17 20:24:23 millert Exp $
d177 20
@


1.14
log
@Reentrant versions of getprotoent(3) and getservent(3).  Adapted from
changes in NetBSD by Christos.  OK otto@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: getservent.3,v 1.13 2003/12/30 10:35:36 jmc Exp $
d49 1
a49 1
.Ft struct servent *
d53 1
a53 1
.Ft struct servent *
d57 1
a57 1
.Ft struct servent *
d156 18
a173 4
.Sh DIAGNOSTICS
Null pointer (0) returned on
.Dv EOF
or error.
@


1.13
log
@sync protos with <netdb.h>;
from Andrey Matveev;
@
text
@d1 1
a1 1
.\"	$OpenBSD: getservent.3,v 1.12 2003/06/02 20:18:35 millert Exp $
d30 1
a30 1
.Dd January 12, 1994
d35 1
d37 1
d39 1
d41 3
a43 1
.Nm endservent
d50 2
d54 2
d57 2
d62 2
d65 2
d128 24
d172 1
d174 9
d184 2
a185 2
These functions use static data storage; if the data is needed for future use,
it should be copied before any subsequent calls overwrite it.
@


1.12
log
@Remove the advertising clause in the UCB license which Berkeley
rescinded 22 July 1999.  Proofed by myself and Theo.
@
text
@d1 1
a1 1
.\"	$OpenBSD: getservent.3,v 1.11 2000/12/24 00:30:56 aaron Exp $
d45 1
a45 1
.Fn getservbyname "char *name" "char *proto"
d47 1
a47 1
.Fn getservbyport "int port" "char *proto"
@


1.11
log
@Various repairs, mostly to get rid of short lines.
@
text
@d1 1
a1 1
.\"	$OpenBSD: getservent.3,v 1.10 2000/12/17 21:30:38 millert Exp $
d14 1
a14 5
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgement:
.\"	This product includes software developed by the University of
.\"	California, Berkeley and its contributors.
.\" 4. Neither the name of the University nor the names of its contributors
@


1.10
log
@data base -> database
@
text
@d1 1
a1 1
.\"	$OpenBSD: getservent.3,v 1.9 2000/04/18 03:01:32 aaron Exp $
d62 2
a63 5
functions
each return a pointer to an object with the
following structure
containing the broken-out
fields of a line in the network services database,
d84 1
a84 2
The name of the protocol to use when contacting the
service.
d89 1
a89 2
function
reads the next line of the file, opening the file if necessary.
d93 1
a93 2
function
opens and rewinds the file.
d104 1
a104 2
function
closes the file.
d110 3
a112 6
functions
sequentially search from the beginning
of the file until a matching
protocol name or
port number (specified in network byte order) is found,
or until
d122 1
a122 2
Null pointer
(0) returned on
d139 2
a140 3
These functions use static data storage;
if the data is needed for future use, it should be
copied before any subsequent calls overwrite it.
@


1.9
log
@Repairs, mostly removing hard sentence breaks.
@
text
@d1 1
a1 1
.\"	$OpenBSD: getservent.3,v 1.8 1999/07/05 04:40:59 aaron Exp $
d66 1
a66 1
fields of a line in the network services data base,
d103 1
a103 1
the net data base will not be closed after each call to
@


1.8
log
@repairs; better English, formatting, etc.
@
text
@d1 1
a1 1
.\"	$OpenBSD: getservent.3,v 1.7 1999/07/04 18:59:43 aaron Exp $
d99 2
a100 1
opens and rewinds the file.  If the
@


1.7
log
@trash some old leftover macros and replace them with -mdoc macros
@
text
@d1 1
a1 1
.\"	$OpenBSD: getservent.3,v 1.6 1999/05/25 01:50:58 aaron Exp $
d82 1
a82 1
A zero terminated list of alternate names for the service.
d102 1
a102 1
the net data base will not be closed after each call to 
d124 1
a124 2
If a protocol name is also supplied (non-
.Dv NULL ) , 
d146 1
a146 1
functions appeared in 
d152 1
a152 2
Expecting port numbers to fit in a 32 bit
quantity is probably naive.
@


1.6
log
@all functions need a return type and at least one arg, even if it's void
@
text
@d1 1
a1 1
.\"	$OpenBSD: getservent.3,v 1.5 1999/05/23 14:11:01 aaron Exp $
a126 1
.ne 1i
@


1.5
log
@remove argument from .Os macros so value in /usr/share/tmac/mdoc/doc-common
is used instead; kwesterback@@home.com
@
text
@d1 1
a1 1
.\"	$OpenBSD: getservent.3,v 1.4 1999/03/02 03:47:46 deraadt Exp $
d47 1
a47 1
.Fn getservent 
d55 1
a55 1
.Fn endservent void
@


1.4
log
@getservbyport() takes a network byte order port #
@
text
@d1 1
a1 1
.\"	$OpenBSD: getservent.3,v 1.3 1996/08/30 02:00:11 millert Exp $
d36 1
a36 1
.Os BSD 4.2
@


1.3
log
@added a missing type
@
text
@d1 1
a1 1
.\"	$OpenBSD: getservent.3,v 1.2 1996/08/19 08:28:58 tholo Exp $
d120 1
a120 1
port number is found,
@


1.2
log
@Fix RCS ids
Make sure everything uses {SYS,}LIBC_SCCS properly
@
text
@d1 1
a1 1
.\"	$OpenBSD: getservent.3,v 1.3 1995/02/25 06:20:38 cgd Exp $
d51 1
a51 1
.Fn getservbyport "int port" proto
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
.\"	$NetBSD: getservent.3,v 1.3 1995/02/25 06:20:38 cgd Exp $
a32 2
.\"
.\"     @@(#)getservent.3	8.3 (Berkeley) 1/12/94
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
