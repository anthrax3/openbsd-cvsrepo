head	1.20;
access;
symbols
	OPENBSD_6_2:1.20.0.14
	OPENBSD_6_2_BASE:1.20
	OPENBSD_6_1:1.20.0.12
	OPENBSD_6_1_BASE:1.20
	OPENBSD_6_0:1.20.0.8
	OPENBSD_6_0_BASE:1.20
	OPENBSD_5_9:1.20.0.4
	OPENBSD_5_9_BASE:1.20
	OPENBSD_5_8:1.20.0.6
	OPENBSD_5_8_BASE:1.20
	OPENBSD_5_7:1.20.0.2
	OPENBSD_5_7_BASE:1.20
	OPENBSD_5_6:1.18.0.8
	OPENBSD_5_6_BASE:1.18
	OPENBSD_5_5:1.18.0.6
	OPENBSD_5_5_BASE:1.18
	OPENBSD_5_4:1.18.0.2
	OPENBSD_5_4_BASE:1.18
	OPENBSD_5_3:1.15.0.24
	OPENBSD_5_3_BASE:1.15
	OPENBSD_5_2:1.15.0.22
	OPENBSD_5_2_BASE:1.15
	OPENBSD_5_1_BASE:1.15
	OPENBSD_5_1:1.15.0.20
	OPENBSD_5_0:1.15.0.18
	OPENBSD_5_0_BASE:1.15
	OPENBSD_4_9:1.15.0.16
	OPENBSD_4_9_BASE:1.15
	OPENBSD_4_8:1.15.0.14
	OPENBSD_4_8_BASE:1.15
	OPENBSD_4_7:1.15.0.10
	OPENBSD_4_7_BASE:1.15
	OPENBSD_4_6:1.15.0.12
	OPENBSD_4_6_BASE:1.15
	OPENBSD_4_5:1.15.0.8
	OPENBSD_4_5_BASE:1.15
	OPENBSD_4_4:1.15.0.6
	OPENBSD_4_4_BASE:1.15
	OPENBSD_4_3:1.15.0.4
	OPENBSD_4_3_BASE:1.15
	OPENBSD_4_2:1.15.0.2
	OPENBSD_4_2_BASE:1.15
	OPENBSD_4_1:1.14.0.8
	OPENBSD_4_1_BASE:1.14
	OPENBSD_4_0:1.14.0.6
	OPENBSD_4_0_BASE:1.14
	OPENBSD_3_9:1.14.0.4
	OPENBSD_3_9_BASE:1.14
	OPENBSD_3_8:1.14.0.2
	OPENBSD_3_8_BASE:1.14
	OPENBSD_3_7:1.13.0.2
	OPENBSD_3_7_BASE:1.13
	OPENBSD_3_6:1.12.0.2
	OPENBSD_3_6_BASE:1.12
	OPENBSD_3_5:1.11.0.4
	OPENBSD_3_5_BASE:1.11
	OPENBSD_3_4:1.11.0.2
	OPENBSD_3_4_BASE:1.11
	OPENBSD_3_3:1.9.0.2
	OPENBSD_3_3_BASE:1.9
	OPENBSD_3_2:1.7.0.2
	OPENBSD_3_2_BASE:1.7
	OPENBSD_3_1:1.4.0.4
	OPENBSD_3_1_BASE:1.4
	OPENBSD_3_0:1.4.0.2
	OPENBSD_3_0_BASE:1.4;
locks; strict;
comment	@.\" @;


1.20
date	2014.11.05.15.12.23;	author jmc;	state Exp;
branches;
next	1.19;
commitid	Z2ytGEu53RqQzsLT;

1.19
date	2014.08.23.07.25.54;	author jmc;	state Exp;
branches;
next	1.18;
commitid	8CxL8ey38kykYzgb;

1.18
date	2013.07.16.15.21.11;	author schwarze;	state Exp;
branches;
next	1.17;

1.17
date	2013.07.16.10.44.51;	author jmc;	state Exp;
branches;
next	1.16;

1.16
date	2013.06.05.03.39.23;	author tedu;	state Exp;
branches;
next	1.15;

1.15
date	2007.05.31.19.19.30;	author jmc;	state Exp;
branches;
next	1.14;

1.14
date	2005.07.22.04.50.51;	author jaredy;	state Exp;
branches;
next	1.13;

1.13
date	2005.02.25.03.12.43;	author cloder;	state Exp;
branches;
next	1.12;

1.12
date	2004.07.10.05.34.21;	author jakob;	state Exp;
branches;
next	1.11;

1.11
date	2003.05.30.21.37.59;	author jmc;	state Exp;
branches;
next	1.10;

1.10
date	2003.05.01.19.04.02;	author jmc;	state Exp;
branches;
next	1.9;

1.9
date	2003.03.06.19.54.52;	author jmc;	state Exp;
branches;
next	1.8;

1.8
date	2003.03.06.04.07.37;	author david;	state Exp;
branches;
next	1.7;

1.7
date	2002.06.09.05.03.59;	author deraadt;	state Exp;
branches;
next	1.6;

1.6
date	2002.05.01.08.03.29;	author mpech;	state Exp;
branches;
next	1.5;

1.5
date	2002.04.30.16.31.42;	author mpech;	state Exp;
branches;
next	1.4;

1.4
date	2001.08.08.16.28.43;	author jakob;	state Exp;
branches;
next	1.3;

1.3
date	2001.08.06.15.10.23;	author jakob;	state Exp;
branches;
next	1.2;

1.2
date	2001.08.06.15.00.48;	author jakob;	state Exp;
branches;
next	1.1;

1.1
date	2001.08.06.14.40.47;	author jakob;	state Exp;
branches;
next	;


desc
@@


1.20
log
@edns0 is not currently supported: confirmed by sthen and eric

diff From: Mike Burns
(though my fix differs a bit)
@
text
@.\" $OpenBSD: getrrsetbyname.3,v 1.19 2014/08/23 07:25:54 jmc Exp $
.\"
.\" Copyright (C) 2000, 2001  Internet Software Consortium.
.\"
.\" Permission to use, copy, modify, and distribute this software for any
.\" purpose with or without fee is hereby granted, provided that the above
.\" copyright notice and this permission notice appear in all copies.
.\"
.\" THE SOFTWARE IS PROVIDED "AS IS" AND INTERNET SOFTWARE CONSORTIUM
.\" DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE INCLUDING ALL
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL
.\" INTERNET SOFTWARE CONSORTIUM BE LIABLE FOR ANY SPECIAL, DIRECT,
.\" INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING
.\" FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT,
.\" NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION
.\" WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
.\"
.Dd $Mdocdate: August 23 2014 $
.Dt GETRRSETBYNAME 3
.Os
.Sh NAME
.Nm freerrset ,
.Nm getrrsetbyname
.Nd retrieve DNS records
.Sh SYNOPSIS
.In netdb.h
.Ft int
.Fn getrrsetbyname "const char *hostname" "unsigned int rdclass" \
"unsigned int rdtype" "unsigned int flags" "struct rrsetinfo **res"
.Ft void
.Fn freerrset "struct rrsetinfo *rrset"
.Sh DESCRIPTION
.Fn getrrsetbyname
gets a set of resource records associated with a
.Fa hostname ,
.Fa rdclass ,
and
.Fa rdtype .
.Fa hostname
is a pointer to a NUL-terminated string.
The
.Fa flags
field is currently unused and must be zero.
.Pp
After a successful call to
.Fn getrrsetbyname ,
.Fa *res
is a pointer to an
.Li rrsetinfo
structure, containing a list of one or more
.Li rdatainfo
structures containing resource records and potentially another list of
.Li rdatainfo
structures containing SIG resource records associated with those records.
The members
.Li rri_rdclass
and
.Li rri_rdtype
are copied from the parameters.
.Li rri_ttl
and
.Li rri_name
are properties of the obtained rrset.
The resource records contained in
.Li rri_rdatas
and
.Li rri_sigs
are in uncompressed DNS wire format.
Properties of the rdataset are represented in the
.Li rri_flags
bitfield.
If the
.Dv RRSET_VALIDATED
bit is set, the data has been DNSSEC
validated and the signatures verified.
.Pp
The following structures are used:
.Bd -literal -offset indent
struct  rdatainfo {
	unsigned int	rdi_length;	/* length of data */
	unsigned char	*rdi_data;	/* record data */
};

struct  rrsetinfo {
	unsigned int	 rri_flags;	/* RRSET_VALIDATED ... */
	unsigned int	 rri_rdclass;	/* class number */
	unsigned int	 rri_rdtype;	/* RR type number */
	unsigned int	 rri_ttl;	/* time to live */
	unsigned int	 rri_nrdatas;	/* size of rdatas array */
	unsigned int	 rri_nsigs;	/* size of sigs array */
	char		 *rri_name;	/* canonical name */
	struct rdatainfo *rri_rdatas;	/* individual records */
	struct rdatainfo *rri_sigs;	/* individual signatures */
};
.Ed
.Pp
All of the information returned by
.Fn getrrsetbyname
is dynamically allocated: the
.Li rrsetinfo
and
.Li rdatainfo
structures,
and the canonical host name strings pointed to by the
.Li rrsetinfo
structure.
Memory allocated for the dynamically allocated structures created by
a successful call to
.Fn getrrsetbyname
is released by
.Fn freerrset .
.Li rrset
is a pointer to a
.Li struct rrsetinfo
created by a call to
.Fn getrrsetbyname .
.\" .Pp
.\" If the EDNS0 option is activated in
.\" .Xr resolv.conf 5 ,
.\" .Fn getrrsetbyname
.\" will request DNSSEC authentication using the EDNS0 DNSSEC OK (DO) bit.
.Sh RETURN VALUES
.Fn getrrsetbyname
returns zero on success, and one of the following error
codes if an error occurred:
.Bl -tag -width ERRSET_NOMEMORY
.It Bq Er ERRSET_NONAME
The name does not exist.
.It Bq Er ERRSET_NODATA
The name exists, but does not have data of the desired type.
.It Bq Er ERRSET_NOMEMORY
Memory could not be allocated.
.It Bq Er ERRSET_INVAL
A parameter is invalid.
.It Bq Er ERRSET_FAIL
Other failure.
.El
.Sh SEE ALSO
.Xr resolver 3 ,
.Xr resolv.conf 5
.Sh HISTORY
.Fn getrrsetbyname
first appeared in
.Ox 3.0 .
The API first appeared in ISC BIND version 9.
.Sh AUTHORS
.An Jakob Schlyter Aq Mt jakob@@openbsd.org
.Sh CAVEATS
The
.Dv RRSET_VALIDATED
flag in
.Li rri_flags
is set if the AD (authenticated data) bit in the DNS answer is
set.
This flag
.Em should not
be trusted unless the transport between the nameserver and the resolver
is secure (e.g. IPsec, trusted network, loopback communication).
.Sh BUGS
The data in
.Li *rdi_data
should be returned in uncompressed wire format.
Currently, the data is in compressed format and the caller can't
uncompress since it doesn't have the full message.
@


1.19
log
@unbind;
@
text
@d1 1
a1 1
.\" $OpenBSD: getrrsetbyname.3,v 1.18 2013/07/16 15:21:11 schwarze Exp $
d18 1
a18 1
.Dd $Mdocdate: July 16 2013 $
d117 5
a121 5
.Pp
If the EDNS0 option is activated in
.Xr resolv.conf 5 ,
.Fn getrrsetbyname
will request DNSSEC authentication using the EDNS0 DNSSEC OK (DO) bit.
@


1.18
log
@use .Mt for email addresses; from Jan Stary <hans at stare dot cz>; ok jmc@@
@
text
@d1 1
a1 1
.\" $OpenBSD: getrrsetbyname.3,v 1.17 2013/07/16 10:44:51 jmc Exp $
d140 1
a140 2
.Xr resolv.conf 5 ,
.Xr named 8
@


1.17
log
@more macro simplification; from Jan Stary
@
text
@d1 1
a1 1
.\" $OpenBSD: getrrsetbyname.3,v 1.16 2013/06/05 03:39:23 tedu Exp $
d18 1
a18 1
.Dd $Mdocdate: June 5 2013 $
d148 1
a148 1
.An Jakob Schlyter Aq jakob@@openbsd.org
@


1.16
log
@Use the fancy .In macro for includes. From Jan Klemkow. ok jmc schwarze
@
text
@d1 1
a1 1
.\" $OpenBSD: getrrsetbyname.3,v 1.15 2007/05/31 19:19:30 jmc Exp $
d18 1
a18 1
.Dd $Mdocdate: May 31 2007 $
a125 1
.Pp
@


1.15
log
@convert to new .Dd format;
@
text
@d1 1
a1 1
.\" $OpenBSD: getrrsetbyname.3,v 1.14 2005/07/22 04:50:51 jaredy Exp $
d18 1
a18 1
.Dd $Mdocdate$
d26 1
a26 1
.Fd #include <netdb.h>
@


1.14
log
@- sync prototypes and header file excerpts
- typos/spelling, punctuation, rewording, macro, and layout fixes.

help & ok jmc
@
text
@d1 1
a1 1
.\" $OpenBSD: getrrsetbyname.3,v 1.13 2005/02/25 03:12:43 cloder Exp $
d18 1
a18 1
.Dd October 18, 2000
@


1.13
log
@Be correct in our man pages when talking about NUL termination (that is,
termination with '\0') vs. null termination.
Input from krw@@, jaredy@@, jmc@@.  OK deraadt@@
@
text
@d1 1
a1 1
.\" $OpenBSD: getrrsetbyname.3,v 1.12 2004/07/10 05:34:21 jakob Exp $
d22 1
d36 1
a36 1
.Fa rdclass
d78 1
a78 1
.Bd -literal -offset
d80 2
a81 2
        unsigned int            rdi_length;     /* length of data */
        unsigned char           *rdi_data;      /* record data */
d85 9
a93 9
        unsigned int            rri_flags;      /* RRSET_VALIDATED ... */
        unsigned int            rri_rdclass;    /* class number */
        unsigned int            rri_rdtype;     /* RR type number */
        unsigned int            rri_ttl;        /* time to live */
        unsigned int            rri_nrdatas;    /* size of rdatas array */
        unsigned int            rri_nsigs;      /* size of sigs array */
        char                    *rri_name;      /* canonical name */
        struct rdatainfo        *rri_rdatas;    /* individual records */
        struct rdatainfo        *rri_sigs;      /* individual signatures */
d114 1
a114 1
.Li struct rrset
d127 11
a137 11
.Bl -tag -width ERRSET_NOMEMORY -compact
.It Dv ERRSET_NONAME
the name does not exist
.It Dv ERRSET_NODATA
the name exists, but does not have data of the desired type
.It Dv ERRSET_NOMEMORY
memory could not be allocated
.It Dv ERRSET_INVAL
a parameter is invalid
.It Dv ERRSET_FAIL
other failure
@


1.12
log
@typo; from patrick latifi
@
text
@d1 1
a1 1
.\" $OpenBSD: getrrsetbyname.3,v 1.11 2003/05/30 21:37:59 jmc Exp $
d39 1
a39 1
is a pointer a to null-terminated string.
@


1.11
log
@- section reorder
- macro cleanup
@
text
@d1 1
a1 1
.\" $OpenBSD: getrrsetbyname.3,v 1.10 2003/05/01 19:04:02 jmc Exp $
d29 2
a30 2
.Ft int
.Fn freerrset "struct rrsetinfo **rrset"
d35 1
a35 1
.Fa class
d37 1
a37 1
.Fa type .
@


1.10
log
@typos;
ok jakob@@
@
text
@d1 1
a1 1
.\" $OpenBSD: getrrsetbyname.3,v 1.9 2003/03/06 19:54:52 jmc Exp $
d121 1
a121 1
.Sh "RETURN VALUES"
a141 3
.Sh AUTHORS
Jakob Schlyter
.Aq jakob@@openbsd.org
d147 2
a148 6
.Sh BUGS
The data in
.Li *rdi_data
should be returned in uncompressed wire format.
Currently, the data is in compressed format and the caller can't
uncompress since it doesn't have the full message.
d160 6
@


1.9
log
@.Xr's;
typos in man page section

ok deraadt@@
@
text
@d1 1
a1 1
.\" $OpenBSD: getrrsetbyname.3,v 1.8 2003/03/06 04:07:37 david Exp $
a104 1
u lib/libc/sys/lseek.2
d161 3
a163 2
is set if the AD (autenticated data) bit in the DNS answer is
set. This flag
@


1.8
log
@date should be written formally: .Dd Month day, year
ok henning@@ jmc@@
@
text
@d1 1
a1 1
.\" $OpenBSD: getrrsetbyname.3,v 1.7 2002/06/09 05:03:59 deraadt Exp $
d119 1
a119 1
.Xr resolv.conf 3 ,
@


1.7
log
@spelling; moritz@@jodeit.org
@
text
@d1 1
a1 1
.\" $OpenBSD: getrrsetbyname.3,v 1.6 2002/05/01 08:03:29 mpech Exp $
d18 1
a18 1
.Dd Oct 18, 2000
@


1.6
log
@o) start new sentence on a new line;
o) always close .Bl tags;
o) fix usage of .Xr;

millert@@ ok
@
text
@d1 1
a1 1
.\" $OpenBSD: getrrsetbyname.3,v 1.5 2002/04/30 16:31:42 mpech Exp $
d104 3
a106 1
.Li rrsetinfostructure.
@


1.5
log
@Initial cleanup:
o) remove extra space in the end of line;
o) remove extra blank lines in the end of file;
o) remove .Pp before .Ss;
o) CAVEAT -> CAVEATS;
o) fix usage of .Fa;
o) <blank-line> -> .Pp;
o) wrap long lines;

millert@@ ok
@
text
@d1 1
a1 1
.\" $OpenBSD: getrrsetbyname.3,v 1.4 2001/08/08 16:28:43 jakob Exp $
d70 2
a71 1
bitfield. If the
@


1.4
log
@add CAVEATS section that talks about trust and the AD-bit
@
text
@d1 1
a1 1
.\" $OpenBSD: getrrsetbyname.3,v 1.3 2001/08/06 15:10:23 jakob Exp $
d73 1
a73 1
validated and the signatures verified. 
@


1.3
log
@add AUTHORS and update HISTORY
@
text
@d1 1
a1 1
.\" $OpenBSD: getrrsetbyname.3,v 1.7 2001/07/30 10:58:26 jakob Exp $
d154 10
@


1.2
log
@OpenBSD id-tags
@
text
@d1 1
a1 1
.\" $OpenBSD: getrrsetbyname.3,v 1.1 2001/08/06 14:40:47 jakob Exp $
d140 3
d144 1
a144 1
.Nm
d147 1
@


1.1
log
@add getrrsetbyname(3) - API to retrieve arbitrary DNS records
@
text
@d1 1
a1 1
.\" $Id: getrrsetbyname.3,v 1.7 2001/07/30 10:58:26 jakob Exp $
@

