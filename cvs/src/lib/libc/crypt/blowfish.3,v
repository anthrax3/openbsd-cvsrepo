head	1.23;
access;
symbols
	OPENBSD_6_2:1.23.0.10
	OPENBSD_6_2_BASE:1.23
	OPENBSD_6_1:1.23.0.8
	OPENBSD_6_1_BASE:1.23
	OPENBSD_6_0:1.23.0.4
	OPENBSD_6_0_BASE:1.23
	OPENBSD_5_9:1.23.0.2
	OPENBSD_5_9_BASE:1.23
	OPENBSD_5_8:1.22.0.12
	OPENBSD_5_8_BASE:1.22
	OPENBSD_5_7:1.22.0.4
	OPENBSD_5_7_BASE:1.22
	OPENBSD_5_6:1.22.0.8
	OPENBSD_5_6_BASE:1.22
	OPENBSD_5_5:1.22.0.6
	OPENBSD_5_5_BASE:1.22
	OPENBSD_5_4:1.22.0.2
	OPENBSD_5_4_BASE:1.22
	OPENBSD_5_3:1.20.0.24
	OPENBSD_5_3_BASE:1.20
	OPENBSD_5_2:1.20.0.22
	OPENBSD_5_2_BASE:1.20
	OPENBSD_5_1_BASE:1.20
	OPENBSD_5_1:1.20.0.20
	OPENBSD_5_0:1.20.0.18
	OPENBSD_5_0_BASE:1.20
	OPENBSD_4_9:1.20.0.16
	OPENBSD_4_9_BASE:1.20
	OPENBSD_4_8:1.20.0.14
	OPENBSD_4_8_BASE:1.20
	OPENBSD_4_7:1.20.0.10
	OPENBSD_4_7_BASE:1.20
	OPENBSD_4_6:1.20.0.12
	OPENBSD_4_6_BASE:1.20
	OPENBSD_4_5:1.20.0.8
	OPENBSD_4_5_BASE:1.20
	OPENBSD_4_4:1.20.0.6
	OPENBSD_4_4_BASE:1.20
	OPENBSD_4_3:1.20.0.4
	OPENBSD_4_3_BASE:1.20
	OPENBSD_4_2:1.20.0.2
	OPENBSD_4_2_BASE:1.20
	OPENBSD_4_1:1.19.0.4
	OPENBSD_4_1_BASE:1.19
	OPENBSD_4_0:1.19.0.2
	OPENBSD_4_0_BASE:1.19
	OPENBSD_3_9:1.14.0.2
	OPENBSD_3_9_BASE:1.14
	OPENBSD_3_8:1.13.0.2
	OPENBSD_3_8_BASE:1.13
	OPENBSD_3_7:1.12.0.8
	OPENBSD_3_7_BASE:1.12
	OPENBSD_3_6:1.12.0.6
	OPENBSD_3_6_BASE:1.12
	OPENBSD_3_5:1.12.0.4
	OPENBSD_3_5_BASE:1.12
	OPENBSD_3_4:1.12.0.2
	OPENBSD_3_4_BASE:1.12
	OPENBSD_3_3:1.10.0.8
	OPENBSD_3_3_BASE:1.10
	OPENBSD_3_2:1.10.0.6
	OPENBSD_3_2_BASE:1.10
	OPENBSD_3_1:1.10.0.4
	OPENBSD_3_1_BASE:1.10
	OPENBSD_3_0:1.10.0.2
	OPENBSD_3_0_BASE:1.10
	OPENBSD_2_9:1.9.0.6
	OPENBSD_2_9_BASE:1.9
	OPENBSD_2_8:1.9.0.4
	OPENBSD_2_8_BASE:1.9
	OPENBSD_2_7:1.9.0.2
	OPENBSD_2_7_BASE:1.9
	OPENBSD_2_6:1.6.0.2
	OPENBSD_2_6_BASE:1.6
	OPENBSD_2_5:1.2.0.4
	OPENBSD_2_5_BASE:1.2
	OPENBSD_2_4:1.2.0.2
	OPENBSD_2_4_BASE:1.2
	OPENBSD_2_3:1.1.0.6
	OPENBSD_2_3_BASE:1.1
	OPENBSD_2_2:1.1.0.4
	OPENBSD_2_2_BASE:1.1
	OPENBSD_2_1:1.1.0.2
	OPENBSD_2_1_BASE:1.1;
locks; strict;
comment	@# @;


1.23
date	2015.11.10.23.48.17;	author jmc;	state Exp;
branches;
next	1.22;
commitid	QU70QaxjyBAtj4Rv;

1.22
date	2013.07.16.15.21.11;	author schwarze;	state Exp;
branches;
next	1.21;

1.21
date	2013.06.05.03.39.22;	author tedu;	state Exp;
branches;
next	1.20;

1.20
date	2007.05.31.19.19.27;	author jmc;	state Exp;
branches;
next	1.19;

1.19
date	2006.08.05.06.50.22;	author jmc;	state Exp;
branches;
next	1.18;

1.18
date	2006.07.26.12.48.35;	author jmc;	state Exp;
branches;
next	1.17;

1.17
date	2006.07.26.12.45.53;	author jmc;	state Exp;
branches;
next	1.16;

1.16
date	2006.07.26.12.43.02;	author jmc;	state Exp;
branches;
next	1.15;

1.15
date	2006.07.25.12.41.06;	author jmc;	state Exp;
branches;
next	1.14;

1.14
date	2005.10.02.08.12.16;	author jmc;	state Exp;
branches;
next	1.13;

1.13
date	2005.07.17.08.50.55;	author jaredy;	state Exp;
branches;
next	1.12;

1.12
date	2003.08.28.12.35.00;	author jmc;	state Exp;
branches;
next	1.11;

1.11
date	2003.05.30.13.06.02;	author jmc;	state Exp;
branches;
next	1.10;

1.10
date	2001.08.06.10.42.25;	author mpech;	state Exp;
branches;
next	1.9;

1.9
date	2000.04.18.02.31.34;	author aaron;	state Exp;
branches;
next	1.8;

1.8
date	2000.04.15.02.15.22;	author aaron;	state Exp;
branches;
next	1.7;

1.7
date	2000.03.14.21.31.44;	author aaron;	state Exp;
branches;
next	1.6;

1.6
date	99.09.23.04.12.00;	author alex;	state Exp;
branches;
next	1.5;

1.5
date	99.07.09.13.35.15;	author aaron;	state Exp;
branches;
next	1.4;

1.4
date	99.05.23.14.10.58;	author aaron;	state Exp;
branches;
next	1.3;

1.3
date	99.05.16.19.54.46;	author alex;	state Exp;
branches;
next	1.2;

1.2
date	98.08.10.18.40.58;	author provos;	state Exp;
branches;
next	1.1;

1.1
date	97.02.16.20.58.16;	author provos;	state Exp;
branches;
next	;


desc
@@


1.23
log
@update NAME section to include all documented functions,
or otherwise change Dt to reflect the name of an existing function;

feedback/ok schwarze
@
text
@.\" $OpenBSD: blowfish.3,v 1.22 2013/07/16 15:21:11 schwarze Exp $
.\"
.\" Copyright 1997 Niels Provos <provos@@physnet.uni-hamburg.de>
.\" All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgement:
.\"      This product includes software developed by Niels Provos.
.\" 4. The name of the author may not be used to endorse or promote products
.\"    derived from this software without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
.\" IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
.\" OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
.\" IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
.\" INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
.\" NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
.\" DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
.\" THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
.\" (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
.\" THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
.\"
.\" Manual page, using -mandoc macros
.\"
.Dd $Mdocdate: July 16 2013 $
.Dt BLF_KEY 3
.Os
.Sh NAME
.Nm blf_key ,
.Nm blf_enc ,
.Nm blf_dec ,
.Nm blf_ecb_encrypt ,
.Nm blf_ecb_decrypt ,
.Nm blf_cbc_encrypt ,
.Nm blf_cbc_decrypt
.Nd Blowfish encryption
.Sh SYNOPSIS
.In blf.h
.Ft void
.Fn blf_key "blf_ctx *state" "const u_int8_t *key" "u_int16_t keylen"
.Ft void
.Fn blf_enc "blf_ctx *state" "u_int32_t *data" "u_int16_t blocks"
.Ft void
.Fn blf_dec "blf_ctx *state" "u_int32_t *data" "u_int16_t blocks"
.Ft void
.Fn blf_ecb_encrypt "blf_ctx *state" "u_int8_t *data" "u_int32_t datalen"
.Ft void
.Fn blf_ecb_decrypt "blf_ctx *state" "u_int8_t *data" "u_int32_t datalen"
.Ft void
.Fn blf_cbc_encrypt "blf_ctx *state" "u_int8_t *iv" "u_int8_t *data" "u_int32_t datalen"
.Ft void
.Fn blf_cbc_decrypt "blf_ctx *state" "u_int8_t *iv" "u_int8_t *data" "u_int32_t datalen"
.Sh DESCRIPTION
.Em Blowfish
is a fast unpatented block cipher designed by Bruce Schneier.
It basically consists of a 16-round Feistel network.
The block size is 64 bits and the maximum key size is 448 bits.
.Pp
The
.Fn blf_key
function initializes the 4 8-bit S-boxes and the 18 Subkeys with
the hexadecimal digits of Pi.
The key is used for further randomization.
The first argument to
.Fn blf_enc
is the initialized state derived from
.Fn blf_key .
The stream of 32-bit words is encrypted in Electronic Codebook
Mode (ECB) and
.Fa blocks
is the number of 64-bit blocks in the stream.
.Fn blf_dec
is used for decrypting Blowfish encrypted blocks.
.Pp
The functions
.Fn blf_ecb_encrypt
and
.Fn blf_ecb_decrypt
are used for encrypting and decrypting octet streams in ECB mode.
The functions
.Fn blf_cbc_encrypt
and
.Fn blf_cbc_decrypt
are used for encrypting and decrypting octet streams in
Cipherblock Chaining Mode (CBC).
For these functions
.Fa datalen
specifies the number of octets of data to encrypt or decrypt.
It must be a multiple of 8 (64-bit block).
The initialisation vector
.Fa iv
points to an 8-byte buffer.
.Sh SEE ALSO
.Xr passwd 1 ,
.Xr crypt 3 ,
.Xr passwd 5
.Sh AUTHORS
.An Niels Provos Aq Mt provos@@physnet.uni-hamburg.de
@


1.22
log
@use .Mt for email addresses; from Jan Stary <hans at stare dot cz>; ok jmc@@
@
text
@d1 1
a1 1
.\" $OpenBSD: blowfish.3,v 1.21 2013/06/05 03:39:22 tedu Exp $
d33 2
a34 2
.Dd $Mdocdate: June 5 2013 $
.Dt BLOWFISH 3
@


1.21
log
@Use the fancy .In macro for includes. From Jan Klemkow. ok jmc schwarze
@
text
@d1 1
a1 1
.\" $OpenBSD: blowfish.3,v 1.20 2007/05/31 19:19:27 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate: May 31 2007 $
d106 1
a106 1
.An Niels Provos Aq provos@@physnet.uni-hamburg.de
@


1.20
log
@convert to new .Dd format;
@
text
@d1 1
a1 1
.\" $OpenBSD: blowfish.3,v 1.19 2006/08/05 06:50:22 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate$
d46 1
a46 1
.Fd #include <blf.h>
@


1.19
log
@no point mentioning functions if we have nothing useful to say
about them;

ok djm
@
text
@d1 1
a1 1
.\" $OpenBSD: blowfish.3,v 1.18 2006/07/26 12:48:35 jmc Exp $
d33 1
a33 1
.Dd February 13, 1997
@


1.18
log
@wording/grammar tweaks;
@
text
@d1 1
a1 1
.\" $OpenBSD: blowfish.3,v 1.17 2006/07/26 12:45:53 jmc Exp $
a100 12
.Pp
The functions
.Fn Blowfish_initstate ,
.Fn Blowfish_expand0state ,
.Fn Blowfish_expandstate ,
.Fn Blowfish_encipher ,
and
.Fn Blowfish_decipher
are used for customization of the
.Em Blowfish
cipher,
for example for the blowfish password hashing function.
@


1.17
log
@better macros;
@
text
@d1 1
a1 1
.\" $OpenBSD: blowfish.3,v 1.16 2006/07/26 12:43:02 jmc Exp $
d106 1
a106 1
.Fn Blowfish_encipher
d111 2
a112 1
cipher, e.g., for the blowfish password hashing function.
@


1.16
log
@document `iv';

from eren elci; tweaked by djm
ok djm
@
text
@d1 1
a1 1
.\" $OpenBSD: blowfish.3,v 1.15 2006/07/25 12:41:06 jmc Exp $
d62 1
a62 1
.Pa Blowfish
d78 1
a78 1
.Pa blocks
d95 1
a95 1
.Pa datalen
d99 1
a99 1
.Pa iv
d110 1
a110 1
.Pa Blowfish
@


1.15
log
@updates from nicholas marriott;
re-worded and ok djm
@
text
@d1 1
a1 1
.\" $OpenBSD: blowfish.3,v 1.14 2005/10/02 08:12:16 jmc Exp $
d98 3
@


1.14
log
@add bf_{ecb,cbc}_{en,de}crypt to the .Nm list;
@
text
@d1 1
a1 1
.\" $OpenBSD: blowfish.3,v 1.13 2005/07/17 08:50:55 jaredy Exp $
d50 1
a50 1
.Fn blf_enc "blf_ctx *state" "u_int32_t *data" "u_int16_t datalen"
d52 1
a52 1
.Fn blf_dec "blf_ctx *state" "u_int32_t *data" "u_int16_t datalen"
d78 2
a79 2
.Pa datalen
must be even.
d94 4
@


1.13
log
@punctuation and minor rewording, ok jmc
@
text
@d1 1
a1 1
.\" $OpenBSD: blowfish.3,v 1.12 2003/08/28 12:35:00 jmc Exp $
d39 5
a43 1
.Nm blf_dec
@


1.12
log
@wording improvement from Michael Knudsen;
@
text
@d1 1
a1 1
.\" $OpenBSD: blowfish.3,v 1.11 2003/05/30 13:06:02 jmc Exp $
d60 2
a61 2
It basically consists of a 16 times iterated Feistel network.
The block size is 64 bit and the maximum key size is 448 bit.
d65 1
a65 1
function initializes the 4 8bit S-boxes and the 18 Subkeys with
@


1.11
log
@- section reorder in crypt(3)
- use .An/.Aq for authors
@
text
@d1 1
a1 1
.\" $OpenBSD: blowfish.3,v 1.10 2001/08/06 10:42:25 mpech Exp $
d61 1
a61 1
The block size is 64 bit and the key size is maximal 448 bit.
@


1.10
log
@o) We always close .Bl and .Bd tags;
o) .Sh AUTHOR -> .Sh AUTHORS;
o) We don't like .Pp before/after .Sh;
o) We don't like .Pp before/after .Rs/.Re;
o) NetBSD -> .Nx;
o) OpenBSD -> .Ox;

millert@@ ok
@
text
@d1 1
a1 1
.\" $OpenBSD: blowfish.3,v 1.9 2000/04/18 02:31:34 aaron Exp $
d106 1
a106 1
Niels Provos <provos@@physnet.uni-hamburg.de>
@


1.9
log
@Repairs.
@
text
@d1 1
a1 1
.\" $OpenBSD: blowfish.3,v 1.8 2000/04/15 02:15:22 aaron Exp $
d105 1
a105 1
.Sh AUTHOR
@


1.8
log
@Mostly punctuation fixes.
@
text
@d1 1
a1 1
.\" $OpenBSD: blowfish.3,v 1.7 2000/03/14 21:31:44 aaron Exp $
d66 2
a67 1
the hexadecimal digits of Pi. The key is used for further randomization.
@


1.7
log
@Suffix "i.e." and "e.g." with a comma. Just another really picky man page
commit, as we want our documentation to be as consistently formatted as
possible (it's getting there :-)).
@
text
@d1 2
a2 1
.\" $OpenBSD: blowfish.3,v 1.6 1999/09/23 04:12:00 alex Exp $
d37 2
a38 2
.Nm blf_key,
.Nm blf_enc,
@


1.6
log
@Typo fixes.
@
text
@d1 1
a1 1
.\" $OpenBSD: blowfish.3,v 1.5 1999/07/09 13:35:15 aaron Exp $
d98 1
a98 1
cipher, e.g. for the blowfish password hashing function.
@


1.5
log
@- remove all trailing whitespace
     * except when it is escaped with a `\' at the end of the line
- fix remaining .Nm usage as well
- this is from a patch I received from kwesterback@@home.com, who has been
  working on some scripts for fixing formatting errors in mdoc'd man pages

Ok, so there could be a cost/benefit debate with this commit, but since I have
the patch we might as well commit it...
@
text
@d1 1
a1 1
.\" $OpenBSD: blowfish.3,v 1.4 1999/05/23 14:10:58 aaron Exp $
d68 1
a68 1
is the initalized state derived from
@


1.4
log
@remove argument from .Os macros so value in /usr/share/tmac/mdoc/doc-common
is used instead; kwesterback@@home.com
@
text
@d1 1
a1 1
.\" $OpenBSD: blowfish.3,v 1.3 1999/05/16 19:54:46 alex Exp $
d77 1
a77 1
The functions 
d80 1
a80 1
.Fn blf_ecb_decrypt 
d82 1
a82 1
The functions 
d85 1
a85 1
.Fn blf_cbc_decrypt 
@


1.3
log
@Cleanup xrefs under SEE ALSO.  Specifically:

  - Sort xrefs by section, and then alphabetically.
  - Add missing commas between xref items.
  - Remove commas from the last xref entry.
  - Remove duplicate entries.
@
text
@d1 1
a1 1
.\" $OpenBSD: blowfish.3,v 1.2 1998/08/10 18:40:58 provos Exp $
d34 1
a34 1
.Os "OpenBSD 2.0"
@


1.2
log
@add ECB and CBC encryption for octet streams
@
text
@d1 1
a1 1
.\" $OpenBSD: blowfish.3,v 1.1 1997/02/16 20:58:16 provos Exp $
d100 1
a101 1
.Xr passwd 1 ,
@


1.1
log
@prelim manpage, cleanup, fixed crippled plaintext: sed does a nice
job on replacing everything, just wouldnt skip it
@
text
@d1 1
a1 1
.\" $OpenBSD$
d48 8
d70 2
a71 1
The stream of data is encrypted in Electronic Cookbook Mode (ECB) and
d77 12
d98 1
a98 2
cipher, i.e. for the blowfish password hashing function or for
implementation of Cipher Block Chaining Mode (CBC).
@

