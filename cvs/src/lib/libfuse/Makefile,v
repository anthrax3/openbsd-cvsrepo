head	1.10;
access;
symbols
	OPENBSD_6_1:1.10.0.2
	OPENBSD_6_1_BASE:1.10
	OPENBSD_6_0:1.8.0.2
	OPENBSD_6_0_BASE:1.8
	OPENBSD_5_9:1.7.0.2
	OPENBSD_5_9_BASE:1.7
	OPENBSD_5_8:1.7.0.4
	OPENBSD_5_8_BASE:1.7
	OPENBSD_5_7:1.6.0.2
	OPENBSD_5_7_BASE:1.6
	OPENBSD_5_6:1.6.0.6
	OPENBSD_5_6_BASE:1.6
	OPENBSD_5_5:1.6.0.4
	OPENBSD_5_5_BASE:1.6
	OPENBSD_5_4:1.5.0.2
	OPENBSD_5_4_BASE:1.5;
locks; strict;
comment	@# @;


1.10
date	2016.09.14.06.26.02;	author natano;	state Exp;
branches;
next	1.9;
commitid	NbvBwJJcB21JqIOO;

1.9
date	2016.09.04.09.54.25;	author natano;	state Exp;
branches;
next	1.8;
commitid	j8zuNlBiRSrQjS9G;

1.8
date	2016.03.30.06.38.42;	author jmc;	state Exp;
branches;
next	1.7;
commitid	LN9ijdk9SEnzWAbM;

1.7
date	2015.06.03.19.57.53;	author reyk;	state Exp;
branches;
next	1.6;
commitid	v5uhOGzG5E87qsy6;

1.6
date	2013.08.08.06.41.05;	author jmc;	state Exp;
branches;
next	1.5;

1.5
date	2013.07.05.11.08.15;	author syl;	state Exp;
branches;
next	1.4;

1.4
date	2013.06.14.20.49.06;	author syl;	state Exp;
branches;
next	1.3;

1.3
date	2013.06.14.20.40.41;	author syl;	state Exp;
branches;
next	1.2;

1.2
date	2013.06.12.22.36.06;	author tedu;	state Exp;
branches;
next	1.1;

1.1
date	2013.06.03.16.00.50;	author tedu;	state Exp;
branches;
next	;


desc
@@


1.10
log
@Generate pkg-config files at build time like everything else. This
avoids permission problems due to the build and install stages being run
by different users.

ok deraadt jasper
@
text
@#	$OpenBSD: Makefile,v 1.9 2016/09/04 09:54:25 natano Exp $

LIB=	fuse
MAN=	fuse_main.3

CFLAGS+=	-Wall -g -Wshadow -Wmissing-prototypes
CFLAGS+=	-Wstrict-prototypes -Wsign-compare

CDIAGFLAGS+=	-Wno-long-long -Wall -W -Wnested-externs -Wformat=2
CDIAGFLAGS+=	-Wmissing-prototypes -Wstrict-prototypes -Wmissing-declarations
CDIAGFLAGS+=	-Wwrite-strings -Wshadow -Wpointer-arith -Wsign-compare
CDIAGFLAGS+=	-Wundef -Wbad-function-cast -Winline -Wcast-align

# XXX Shouldn't we use a common fuse.h with proper ifdef _KERNEL part?
CFLAGS+=	-I${.CURDIR} -DDEBUG

SRCS=	debug.c dict.c fuse.c fuse_ops.c fuse_opt.c fuse_subr.c tree.c
HDRS=	fuse.h fuse_opt.h

PC_FILES=fuse.pc
CLEANFILES+=${PC_FILES}

includes:
	@@cd ${.CURDIR}; for i in ${HDRS}; do \
		j="cmp -s $$i ${DESTDIR}/usr/include/$$i || \
		    ${INSTALL} ${INSTALL_COPY} -o ${BINOWN} -g ${BINGRP} -m 444 \
	            $$i ${DESTDIR}/usr/include"; \
	        echo $$j; \
	        eval "$$j"; \
	done

all: ${PC_FILES}
${PC_FILES}: fuse_private.h
	/bin/sh ${.CURDIR}/generate_pkgconfig.sh -c ${.CURDIR} -o ${.OBJDIR}

beforeinstall:
	${INSTALL} ${INSTALL_COPY} -o root -g ${SHAREGRP} \
	    -m ${SHAREMODE} ${.OBJDIR}/${PC_FILES} ${DESTDIR}/usr/lib/pkgconfig/

.include <bsd.lib.mk>
@


1.9
log
@only regen pkg-config files when required; ok jasper
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.8 2016/03/30 06:38:42 jmc Exp $
d32 1
d36 1
a36 1
beforeinstall: ${PC_FILES}
@


1.8
log
@for some time now mandoc has not required MLINKS to function
correctly - logically complete that now by removing MLINKS from base;

authors need only to ensure there is an entry in NAME for any function/
util being added. MLINKS will still work, and remain for perl to ease
upgrades;

ok nicm (curses) bcook (ssl)
ok schwarze, who provided a lot of feedback and assistance
ok tb natano jung
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.7 2015/06/03 19:57:53 reyk Exp $
d32 1
a32 1
beforeinstall:
d34 2
@


1.7
log
@Remove -Werror from the Makefile: as it happened with asprintf, it
breaks the tree if any new compiler warnings get enabled, especially
with -Wall.  We do not want to use it in the tree, except for some
very special places.

As discussed with deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.6 2013/08/08 06:41:05 jmc Exp $
a4 17

MLINKS=	fuse_main.3 fuse_version.3 \
	fuse_main.3 fuse_new.3 \
	fuse_main.3 fuse_parse_cmdline.3 \
	fuse_main.3 fuse_mount.3 \
	fuse_main.3 fuse_remove_signal_handlers.3 \
	fuse_main.3 fuse_set_signal_handlers.3 \
	fuse_main.3 fuse_get_session.3 \
	fuse_main.3 fuse_get_context.3 \
	fuse_main.3 fuse_is_lib_option.3 \
	fuse_main.3 fuse_loop.3 \
	fuse_main.3 fuse_loop_mt.3 \
	fuse_main.3 fuse_chan_fd.3 \
	fuse_main.3 fuse_unmount.3 \
	fuse_main.3 fuse_daemonize.3 \
	fuse_main.3 fuse_destroy.3 \
	fuse_main.3 fuse_teardown.3
@


1.6
log
@rename fuse docs after existent functions;
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.5 2013/07/05 11:08:15 syl Exp $
d23 1
a23 1
CFLAGS+=	-Wall -g -Werror -Wshadow -Wmissing-prototypes
@


1.5
log
@Add support for fuse_teardown(3). This function
is needed by zipfs.

ok tedu@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.4 2013/06/14 20:49:06 syl Exp $
d4 1
a4 1
MAN=	fuse.3
d6 16
a21 17
MLINKS=	fuse.3 fuse_version.3 \
	fuse.3 fuse_main.3 \
	fuse.3 fuse_new.3 \
	fuse.3 fuse_parse_cmdline.3 \
	fuse.3 fuse_mount.3 \
	fuse.3 fuse_remove_signal_handlers.3 \
	fuse.3 fuse_set_signal_handlers.3 \
	fuse.3 fuse_get_session.3 \
	fuse.3 fuse_get_context.3 \
	fuse.3 fuse_is_lib_option.3 \
	fuse.3 fuse_loop.3 \
	fuse.3 fuse_loop_mt.3 \
	fuse.3 fuse_chan_fd.3 \
	fuse.3 fuse_unmount.3 \
	fuse.3 fuse_daemonize.3 \
	fuse.3 fuse_destroy.3 \
	fuse.3 fuse_teardown.3
@


1.4
log
@Add support for fuse_get_context(3) needed by ntfs-3g.

OK pirofti@@ and beck@@ "assuming I am getting to setting
the initial pid/gid/uid values correctly soon".
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.3 2013/06/14 20:40:41 syl Exp $
d21 2
a22 1
	fuse.3 fuse_destroy.3
@


1.3
log
@add support for fuse_version(3). Needed by ntfs-3g.

Ok beck@@ and pirofti@@.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.2 2013/06/12 22:36:06 tedu Exp $
d14 1
@


1.2
log
@fuse_opt support from Sylvestre
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.1 2013/06/03 16:00:50 tedu Exp $
d6 2
a7 1
MLINKS=	fuse.3 fuse_main.3 \
@


1.1
log
@add userland fuse library. ok beck deraadt
from Sylvestre Gallon ccna.syl gmail.com
@
text
@d1 1
a1 1
#	$OpenBSD$
d32 2
a33 2
SRCS=	debug.c dict.c fuse.c fuse_ops.c fuse_subr.c tree.c
HDRS=	fuse.h
@

