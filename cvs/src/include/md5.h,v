head	1.17;
access;
symbols
	OPENBSD_6_0:1.17.0.16
	OPENBSD_6_0_BASE:1.17
	OPENBSD_5_9:1.17.0.12
	OPENBSD_5_9_BASE:1.17
	OPENBSD_5_8:1.17.0.14
	OPENBSD_5_8_BASE:1.17
	OPENBSD_5_7:1.17.0.6
	OPENBSD_5_7_BASE:1.17
	OPENBSD_5_6:1.17.0.10
	OPENBSD_5_6_BASE:1.17
	OPENBSD_5_5:1.17.0.8
	OPENBSD_5_5_BASE:1.17
	OPENBSD_5_4:1.17.0.4
	OPENBSD_5_4_BASE:1.17
	OPENBSD_5_3:1.17.0.2
	OPENBSD_5_3_BASE:1.17
	OPENBSD_5_2:1.16.0.34
	OPENBSD_5_2_BASE:1.16
	OPENBSD_5_1_BASE:1.16
	OPENBSD_5_1:1.16.0.32
	OPENBSD_5_0:1.16.0.30
	OPENBSD_5_0_BASE:1.16
	OPENBSD_4_9:1.16.0.28
	OPENBSD_4_9_BASE:1.16
	OPENBSD_4_8:1.16.0.26
	OPENBSD_4_8_BASE:1.16
	OPENBSD_4_7:1.16.0.22
	OPENBSD_4_7_BASE:1.16
	OPENBSD_4_6:1.16.0.24
	OPENBSD_4_6_BASE:1.16
	OPENBSD_4_5:1.16.0.20
	OPENBSD_4_5_BASE:1.16
	OPENBSD_4_4:1.16.0.18
	OPENBSD_4_4_BASE:1.16
	OPENBSD_4_3:1.16.0.16
	OPENBSD_4_3_BASE:1.16
	OPENBSD_4_2:1.16.0.14
	OPENBSD_4_2_BASE:1.16
	OPENBSD_4_1:1.16.0.12
	OPENBSD_4_1_BASE:1.16
	OPENBSD_4_0:1.16.0.10
	OPENBSD_4_0_BASE:1.16
	OPENBSD_3_9:1.16.0.8
	OPENBSD_3_9_BASE:1.16
	OPENBSD_3_8:1.16.0.6
	OPENBSD_3_8_BASE:1.16
	OPENBSD_3_7:1.16.0.4
	OPENBSD_3_7_BASE:1.16
	OPENBSD_3_6:1.16.0.2
	OPENBSD_3_6_BASE:1.16
	OPENBSD_3_5:1.11.0.2
	OPENBSD_3_5_BASE:1.11
	OPENBSD_3_4:1.10.0.2
	OPENBSD_3_4_BASE:1.10
	OPENBSD_3_3:1.7.0.2
	OPENBSD_3_3_BASE:1.7
	OPENBSD_3_2:1.6.0.4
	OPENBSD_3_2_BASE:1.6
	OPENBSD_3_1:1.6.0.2
	OPENBSD_3_1_BASE:1.6
	OPENBSD_3_0:1.5.0.8
	OPENBSD_3_0_BASE:1.5
	OPENBSD_2_9:1.5.0.6
	OPENBSD_2_9_BASE:1.5
	OPENBSD_2_8:1.5.0.4
	OPENBSD_2_8_BASE:1.5
	OPENBSD_2_7:1.5.0.2
	OPENBSD_2_7_BASE:1.5
	OPENBSD_2_6:1.4.0.12
	OPENBSD_2_6_BASE:1.4
	OPENBSD_2_5:1.4.0.10
	OPENBSD_2_5_BASE:1.4
	OPENBSD_2_4:1.4.0.8
	OPENBSD_2_4_BASE:1.4
	OPENBSD_2_3:1.4.0.6
	OPENBSD_2_3_BASE:1.4
	OPENBSD_2_2:1.4.0.4
	OPENBSD_2_2_BASE:1.4
	OPENBSD_2_1:1.4.0.2
	OPENBSD_2_1_BASE:1.4
	OPENBSD_2_0:1.3.0.2
	OPENBSD_2_0_BASE:1.3;
locks; strict;
comment	@ * @;


1.17
date	2012.12.05.23.19.57;	author deraadt;	state Exp;
branches;
next	1.16;

1.16
date	2004.06.22.01.57.30;	author jfb;	state Exp;
branches;
next	1.15;

1.15
date	2004.05.03.17.30.14;	author millert;	state Exp;
branches;
next	1.14;

1.14
date	2004.04.29.15.51.16;	author millert;	state Exp;
branches;
next	1.13;

1.13
date	2004.04.28.16.52.08;	author millert;	state Exp;
branches;
next	1.12;

1.12
date	2004.04.28.16.46.02;	author millert;	state Exp;
branches;
next	1.11;

1.11
date	2003.10.07.22.17.27;	author avsm;	state Exp;
branches;
next	1.10;

1.10
date	2003.08.01.17.38.33;	author avsm;	state Exp;
branches;
next	1.9;

1.9
date	2003.06.26.19.34.17;	author avsm;	state Exp;
branches;
next	1.8;

1.8
date	2003.06.26.18.35.13;	author avsm;	state Exp;
branches;
next	1.7;

1.7
date	2002.12.23.04.33.31;	author millert;	state Exp;
branches;
next	1.6;

1.6
date	2002.02.16.21.27.17;	author millert;	state Exp;
branches;
next	1.5;

1.5
date	2000.03.28.17.35.08;	author millert;	state Exp;
branches;
next	1.4;

1.4
date	96.11.24.02.25.57;	author niklas;	state Exp;
branches;
next	1.3;

1.3
date	96.09.30.03.55.48;	author millert;	state Exp;
branches;
next	1.2;

1.2
date	96.09.29.14.53.10;	author millert;	state Exp;
branches;
next	1.1;

1.1
date	96.06.03.22.25.55;	author niklas;	state Exp;
branches;
next	;


desc
@@


1.17
log
@Remove excessive sys/cdefs.h inclusion
ok guenther millert kettenis
@
text
@/*	$OpenBSD: md5.h,v 1.16 2004/06/22 01:57:30 jfb Exp $	*/

/*
 * This code implements the MD5 message-digest algorithm.
 * The algorithm is due to Ron Rivest.  This code was
 * written by Colin Plumb in 1993, no copyright is claimed.
 * This code is in the public domain; do with it what you wish.
 *
 * Equivalent code is available from RSA Data Security, Inc.
 * This code has been tested against that, and is equivalent,
 * except that you don't need to include two pages of legalese
 * with every copy.
 */

#ifndef _MD5_H_
#define _MD5_H_

#define	MD5_BLOCK_LENGTH		64
#define	MD5_DIGEST_LENGTH		16
#define	MD5_DIGEST_STRING_LENGTH	(MD5_DIGEST_LENGTH * 2 + 1)

typedef struct MD5Context {
	u_int32_t state[4];			/* state */
	u_int64_t count;			/* number of bits, mod 2^64 */
	u_int8_t buffer[MD5_BLOCK_LENGTH];	/* input buffer */
} MD5_CTX;

__BEGIN_DECLS
void	 MD5Init(MD5_CTX *);
void	 MD5Update(MD5_CTX *, const u_int8_t *, size_t)
		__attribute__((__bounded__(__string__,2,3)));
void	 MD5Pad(MD5_CTX *);
void	 MD5Final(u_int8_t [MD5_DIGEST_LENGTH], MD5_CTX *)
		__attribute__((__bounded__(__minbytes__,1,MD5_DIGEST_LENGTH)));
void	 MD5Transform(u_int32_t [4], const u_int8_t [MD5_BLOCK_LENGTH])
		__attribute__((__bounded__(__minbytes__,1,4)))
		__attribute__((__bounded__(__minbytes__,2,MD5_BLOCK_LENGTH)));
char	*MD5End(MD5_CTX *, char *)
		__attribute__((__bounded__(__minbytes__,2,MD5_DIGEST_STRING_LENGTH)));
char	*MD5File(const char *, char *)
		__attribute__((__bounded__(__minbytes__,2,MD5_DIGEST_STRING_LENGTH)));
char	*MD5FileChunk(const char *, char *, off_t, off_t)
		__attribute__((__bounded__(__minbytes__,2,MD5_DIGEST_STRING_LENGTH)));
char	*MD5Data(const u_int8_t *, size_t, char *)
		__attribute__((__bounded__(__string__,1,2)))
		__attribute__((__bounded__(__minbytes__,3,MD5_DIGEST_STRING_LENGTH)));
__END_DECLS

#endif /* _MD5_H_ */
@


1.16
log
@Make the `filename' parameter to HASHFile() and HASHFileChunk() const
ok pedro@@, millert@@
@
text
@d1 1
a1 1
/*	$OpenBSD: md5.h,v 1.15 2004/05/03 17:30:14 millert Exp $	*/
a26 2

#include <sys/cdefs.h>
@


1.15
log
@Add Pad and FileChunk functions for each family of hash functions.
The Pad function does padding like in Final but does not finish processing.
The FileChunk function creates a digest from a portion of a file.
Also made the length parameters consistent (and size_t).
@
text
@d1 1
a1 1
/*	$OpenBSD: md5.h,v 1.14 2004/04/29 15:51:16 millert Exp $	*/
d42 1
a42 1
char	*MD5File(char *, char *)
d44 1
a44 1
char	*MD5FileChunk(char *, char *, off_t, off_t)
@


1.14
log
@Undo some recent prototype changes; it is legal to pass the helper
functions can take a NULL buf pointer.  They will malloc memory as
needed in this case.
@
text
@d1 1
a1 1
/*	$OpenBSD: md5.h,v 1.13 2004/04/28 16:52:08 millert Exp $	*/
d34 1
d43 2
@


1.13
log
@Rename members of struct MD5Context to match other hash routines.
Add constants for buffer lengths and use them.
Make bit count 64bit based on changes by niklas@@ long ago.
Conver htole32n() to macros and unroll loops.
@
text
@d1 1
a1 1
/*	$OpenBSD: md5.h,v 1.11 2003/10/07 22:17:27 avsm Exp $	*/
d39 1
a39 1
char	*MD5End(MD5_CTX *, char [MD5_DIGEST_STRING_LENGTH])
d41 1
a41 1
char	*MD5File(char *, char [MD5_DIGEST_STRING_LENGTH])
d43 1
a43 1
char	*MD5Data(const u_int8_t *, size_t, char [MD5_DIGEST_STRING_LENGTH])
@


1.12
log
@PD version of md5(3) based on code written by Colin Plumb.
@
text
@d18 4
d23 3
a25 3
	u_int32_t buf[4];			/* state */
	u_int32_t bits[2];			/* number of bits, mod 2^64 */
	unsigned char in[64];	/* input buffer */
d34 3
a36 3
void	 MD5Final(u_int8_t [16], MD5_CTX *)
		__attribute__((__bounded__(__minbytes__,1,16)));
void	 MD5Transform(u_int32_t [4], const u_int8_t [64])
d38 6
a43 6
		__attribute__((__bounded__(__minbytes__,2,64)));
char	*MD5End(MD5_CTX *, char [33])
		__attribute__((__bounded__(__minbytes__,2,33)));
char	*MD5File(char *, char [33])
		__attribute__((__bounded__(__minbytes__,2,33)));
char	*MD5Data(const u_int8_t *, size_t, char [33])
d45 1
a45 1
		__attribute__((__bounded__(__minbytes__,3,33)));
@


1.11
log
@corrent __bounded__ attribute for the *Data functions, and add
__minbytes__ checks where appropriate.  tested by itojun@@

fixes PR 3505 from Janjaap van Velthooven
@
text
@d1 1
a1 21
/* MD5.H - header file for MD5C.C
 * $OpenBSD: md5.h,v 1.10 2003/08/01 17:38:33 avsm Exp $
 */

/* Copyright (C) 1991-2, RSA Data Security, Inc. Created 1991. All
rights reserved.

License to copy and use this software is granted provided that it
is identified as the "RSA Data Security, Inc. MD5 Message-Digest
Algorithm" in all material mentioning or referencing this software
or this function.

License is also granted to make and use derivative works provided
that such works are identified as "derived from the RSA Data
Security, Inc. MD5 Message-Digest Algorithm" in all material
mentioning or referencing the derived work.

RSA Data Security, Inc. makes no representations concerning either
the merchantability of this software or the suitability of this
software for any particular purpose. It is provided "as is"
without express or implied warranty of any kind.
d3 10
a12 2
These notices must be retained in any copies of any part of this
documentation and/or software.
a17 1
/* MD5 context. */
d19 3
a21 3
    u_int32_t state[4];		/* state (ABCD) */
    u_int64_t count;		/* number of bits, modulo 2^64 */
    unsigned char buffer[64];	/* input buffer */
d27 2
a28 2
void   MD5Init(MD5_CTX *);
void   MD5Update(MD5_CTX *, const unsigned char *, size_t)
d30 1
a30 1
void   MD5Final(unsigned char [16], MD5_CTX *)
d32 1
a32 1
void   MD5Transform(u_int32_t [4], const unsigned char [64])
d35 1
a35 1
char * MD5End(MD5_CTX *, char *)
d37 1
a37 1
char * MD5File(char *, char *)
d39 1
a39 1
char * MD5Data(const unsigned char *, size_t, char *)
@


1.10
log
@add __bounded__ attributes for userland headers; enabled with -Wbounded
ok deraadt@@
@
text
@d2 1
a2 1
 * $OpenBSD: md5.h,v 1.9 2003/06/26 19:34:17 avsm Exp $
d41 11
a51 5
void   MD5Update(MD5_CTX *, const unsigned char *, size_t);
void   MD5Final(unsigned char [16], MD5_CTX *);
void   MD5Transform(u_int32_t [4], const unsigned char [64]);
char * MD5End(MD5_CTX *, char *);
char * MD5File(char *, char *);
d53 2
a54 1
		__attribute__ ((__bounded__(__string__,3,2)));
@


1.9
log
@backout the __bounded__ attributes for a while; requested by deraadt@@
@
text
@d2 1
a2 1
 * $OpenBSD: md5.h,v 1.7 2002/12/23 04:33:31 millert Exp $
d46 2
a47 1
char * MD5Data(const unsigned char *, size_t, char *);
@


1.8
log
@Mark various standard library functions with the __bounded__ attribute.
You must have an up-to-date gcc for this!
deraadt@@ ok
@
text
@d46 1
a46 2
char * MD5Data(const unsigned char *, size_t, char *)
		__attribute__ ((__bounded__(__string__,3,2)));
@


1.7
log
@o Ansi function headers
o Add __BEGIN_DECLS/__END_DECLS to include files
o Safe macros
o Remove useless variable assignment in the End function of *hl.c
o Some minor KNF, needs more
From Dan Weeks
@
text
@d2 1
a2 1
 * $OpenBSD: md5.h,v 1.6 2002/02/16 21:27:17 millert Exp $
d46 2
a47 1
char * MD5Data(const unsigned char *, size_t, char *);
@


1.6
log
@Part one of userland __P removal.  Done with a simple regexp with some minor hand editing to make comments line up correctly.  Another pass is forthcoming that handles the cases that could not be done automatically.
@
text
@d2 1
a2 1
 * $OpenBSD: md5.h,v 1.5 2000/03/28 17:35:08 millert Exp $
d37 3
d47 1
@


1.5
log
@Expose MDXTransform functions to be consistent with sha1 and rmd160.
@
text
@d2 1
a2 1
 * $OpenBSD: md5.h,v 1.4 1996/11/24 02:25:57 niklas Exp $
d37 7
a43 7
void   MD5Init __P((MD5_CTX *));
void   MD5Update __P((MD5_CTX *, const unsigned char *, size_t));
void   MD5Final __P((unsigned char [16], MD5_CTX *));
void   MD5Transform __P ((u_int32_t [4], const unsigned char [64]));
char * MD5End __P((MD5_CTX *, char *));
char * MD5File __P((char *, char *));
char * MD5Data __P((const unsigned char *, size_t, char *));
@


1.4
log
@64-bit cleanup + pedantic -W flags
@
text
@d2 1
a2 1
 * $OpenBSD: md5.h,v 1.3 1996/09/30 03:55:48 millert Exp $
d40 1
@


1.3
log
@Protect prototypes with __P.
@
text
@d2 1
a2 1
 * $OpenBSD: md5.h,v 1.2 1996/09/29 14:53:10 millert Exp $
d33 1
a33 1
    u_int32_t count[2];		/* number of bits, modulo 2^64 (lsb first) */
d38 1
a38 1
void   MD5Update __P((MD5_CTX *, const unsigned char *, unsigned int));
d42 1
a42 1
char * MD5Data __P((const unsigned char *, unsigned int, char *));
@


1.2
log
@Use bittypes so we work on 64-bit machines.
@
text
@d2 1
a2 1
 * $OpenBSD: md5.h,v 1.1 1996/06/03 22:25:55 niklas Exp $
d29 1
d32 3
a34 3
  u_int32_t state[4];		/* state (ABCD) */
  u_int32_t count[2];		/* number of bits, modulo 2^64 (lsb first) */
  unsigned char buffer[64];	/* input buffer */
d37 7
a43 6
void   MD5Init (MD5_CTX *);
void   MD5Update (MD5_CTX *, const unsigned char *, unsigned int);
void   MD5Final (unsigned char [16], MD5_CTX *);
char * MD5End(MD5_CTX *, char *);
char * MD5File(char *, char *);
char * MD5Data(const unsigned char *, unsigned int, char *);
@


1.1
log
@Add md[245].h include files for use with the md support in libc, from FreeBSD
@
text
@d2 1
a2 1
 * $OpenBSD$
d31 2
a32 2
  unsigned long state[4];	/* state (ABCD) */
  unsigned long count[2];	/* number of bits, modulo 2^64 (lsb first) */
@
