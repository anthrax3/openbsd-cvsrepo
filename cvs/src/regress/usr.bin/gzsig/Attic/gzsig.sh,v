head	1.4;
access;
symbols
	OPENBSD_5_6:1.3.0.40
	OPENBSD_5_6_BASE:1.3
	OPENBSD_5_5:1.3.0.38
	OPENBSD_5_5_BASE:1.3
	OPENBSD_5_4:1.3.0.34
	OPENBSD_5_4_BASE:1.3
	OPENBSD_5_3:1.3.0.32
	OPENBSD_5_3_BASE:1.3
	OPENBSD_5_2:1.3.0.30
	OPENBSD_5_2_BASE:1.3
	OPENBSD_5_1_BASE:1.3
	OPENBSD_5_1:1.3.0.28
	OPENBSD_5_0:1.3.0.26
	OPENBSD_5_0_BASE:1.3
	OPENBSD_4_9:1.3.0.24
	OPENBSD_4_9_BASE:1.3
	OPENBSD_4_8:1.3.0.22
	OPENBSD_4_8_BASE:1.3
	OPENBSD_4_7:1.3.0.18
	OPENBSD_4_7_BASE:1.3
	OPENBSD_4_6:1.3.0.20
	OPENBSD_4_6_BASE:1.3
	OPENBSD_4_5:1.3.0.16
	OPENBSD_4_5_BASE:1.3
	OPENBSD_4_4:1.3.0.14
	OPENBSD_4_4_BASE:1.3
	OPENBSD_4_3:1.3.0.12
	OPENBSD_4_3_BASE:1.3
	OPENBSD_4_2:1.3.0.10
	OPENBSD_4_2_BASE:1.3
	OPENBSD_4_1:1.3.0.8
	OPENBSD_4_1_BASE:1.3
	OPENBSD_4_0:1.3.0.6
	OPENBSD_4_0_BASE:1.3
	OPENBSD_3_9:1.3.0.4
	OPENBSD_3_9_BASE:1.3
	OPENBSD_3_8:1.3.0.2
	OPENBSD_3_8_BASE:1.3
	marius_20050527:1.1.1.1
	marius:1.1.1;
locks; strict;
comment	@# @;


1.4
date	2014.10.09.03.31.34;	author lteo;	state dead;
branches;
next	1.3;
commitid	tzr9wLQv7cJdwUv0;

1.3
date	2005.05.29.08.54.59;	author djm;	state Exp;
branches;
next	1.2;

1.2
date	2005.05.29.02.41.42;	author marius;	state Exp;
branches;
next	1.1;

1.1
date	2005.05.28.01.58.12;	author marius;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2005.05.28.01.58.12;	author marius;	state Exp;
branches;
next	;


desc
@@


1.4
log
@remove gzsig regression tests since gzsig is gone

ok tedu@@
@
text
@#!/bin/sh
# 
# $OpenBSD: gzsig.sh,v 1.3 2005/05/29 08:54:59 djm Exp $

set -e

# TODO: add ssh2

# Location of keys, etc for regress is passed in by make target usually
if [ -z "$1" ] ; then
	SRCDIR="."
else
	SRCDIR="$1"
fi

KEYS="ssh-rsa ssh2-rsa ssh2-dsa x509-dsa x509-rsa"
KEYS_ENC="ssh-rsa-pass ssh2-rsa-pass ssh2-dsa-pass x509-dsa-pass x509-rsa-pass"

# Clean up from last time.
gunzip *.gz >/dev/null 2>&1 || true

for key in ${KEYS}; do
    echo "===> $key" >&2
    for x in ${SRCDIR}/file*[0-9] ; do gzip -f < $x > `basename ${x}`-t.gz ; done
    gzsig sign -v ${SRCDIR}/$key file*-t.gz
    gzsig verify -v ${SRCDIR}/$key.pub file*-t.gz
    gzcat file*-t.gz >/dev/null
done

for key in ${KEYS_ENC}; do
    echo "===> $key" >&2
    for x in ${SRCDIR}/file*[0-9] ; do gzip -f < $x > `basename ${x}`-t.gz ; done
    # SSH2 keys require longer passwords
    if [ "$key" != "${key#ssh2}" ]; then
        pass=pass.ssh2
    else
	pass=pass.ssh
    fi
    gzsig sign -v -f ${SRCDIR}/$pass ${SRCDIR}/$key file*-t.gz
    gzsig verify -v ${SRCDIR}/$key.pub file*-t.gz
    gzcat file*-t.gz >/dev/null
done

echo -n "Generating random data..."
dd if=/dev/arandom of=masterrand bs=1024k count=2 > /dev/null 2>&1
echo "done."

for key in ${KEYS}; do
    echo "===> $key" >&2
    cp masterrand rand
    gzip -f rand
    gzsig sign -v ${SRCDIR}/$key < rand.gz > rand2.gz
    gzsig verify -v ${SRCDIR}/$key.pub < rand2.gz
    gzcat rand*.gz > /dev/null
    rm -f rand*
done

rm -f masterrand rand file*-t* *.gz
@


1.3
log
@sync with -p -> -f change, make it work with obj/ ; ok marius@@
@
text
@d3 1
a3 1
# $OpenBSD: gzsig.sh,v 1.2 2005/05/29 02:41:42 marius Exp $
@


1.2
log
@add back support for SSH1 keys.  it is being used in practice.

ok markus@@
@
text
@d3 1
a3 1
# $OpenBSD: gzsig.sh,v 1.1.1.1 2005/05/28 01:58:12 marius Exp $
d9 7
d24 4
a27 4
    gzip -f file*
    gzsig sign -v $key *.gz
    gzsig verify -v $key.pub *.gz
    gunzip *.gz
d32 1
a32 1
    gzip -f file*
d35 1
a35 1
        pass=asdfg
d37 1
a37 1
	pass=asdf
d39 3
a41 3
    gzsig sign -v -p $pass $key *.gz
    gzsig verify -v $key.pub *.gz
    gunzip *.gz
d45 1
a45 1
dd if=/dev/urandom of=rand bs=1024k count=2 > /dev/null 2>&1
d50 1
d52 4
a55 4
    gzsig sign -v $key < rand.gz > rand2.gz
    gzsig verify -v $key.pub < rand2.gz
    rm -f rand2.gz
    gunzip *.gz
d58 1
a58 1
rm -f rand
@


1.1
log
@Initial revision
@
text
@d3 1
a3 1
# $OpenBSD$
d9 2
a10 2
KEYS="ssh2-rsa ssh2-dsa x509-dsa x509-rsa"
KEYS_ENC="ssh2-rsa-pass ssh2-dsa-pass x509-dsa-pass x509-rsa-pass"
@


1.1.1.1
log
@import regression tests for gzsig.
@
text
@@
