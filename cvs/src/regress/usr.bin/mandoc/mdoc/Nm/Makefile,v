head	1.17;
access;
symbols
	OPENBSD_6_2:1.17.0.4
	OPENBSD_6_2_BASE:1.17
	OPENBSD_6_1:1.16.0.4
	OPENBSD_6_1_BASE:1.16
	OPENBSD_6_0:1.12.0.8
	OPENBSD_6_0_BASE:1.12
	OPENBSD_5_9:1.12.0.2
	OPENBSD_5_9_BASE:1.12
	OPENBSD_5_8:1.12.0.6
	OPENBSD_5_8_BASE:1.12
	OPENBSD_5_7:1.12.0.4
	OPENBSD_5_7_BASE:1.12
	OPENBSD_5_6:1.7.0.4
	OPENBSD_5_6_BASE:1.7
	OPENBSD_5_5:1.5.0.10
	OPENBSD_5_5_BASE:1.5
	OPENBSD_5_4:1.5.0.6
	OPENBSD_5_4_BASE:1.5
	OPENBSD_5_3:1.5.0.4
	OPENBSD_5_3_BASE:1.5
	OPENBSD_5_2:1.5.0.2
	OPENBSD_5_2_BASE:1.5
	OPENBSD_5_1_BASE:1.2
	OPENBSD_5_1:1.2.0.2
	OPENBSD_5_0:1.1.0.4
	OPENBSD_5_0_BASE:1.1
	OPENBSD_4_9:1.1.0.2
	OPENBSD_4_9_BASE:1.1;
locks; strict;
comment	@# @;


1.17
date	2017.06.10.01.48.31;	author schwarze;	state Exp;
branches;
next	1.16;
commitid	GnqehULkzSOZe9a6;

1.16
date	2017.03.08.22.53.35;	author schwarze;	state Exp;
branches;
next	1.15;
commitid	S0sHiOvvLc7ECRCI;

1.15
date	2017.03.05.19.59.26;	author schwarze;	state Exp;
branches;
next	1.14;
commitid	oe0SPH5Gl3TsCzFo;

1.14
date	2017.02.11.20.22.17;	author schwarze;	state Exp;
branches;
next	1.13;
commitid	ivIhpwuH93gYPo1z;

1.13
date	2017.02.06.03.44.37;	author schwarze;	state Exp;
branches;
next	1.12;
commitid	211QABBVsBkM0LzO;

1.12
date	2015.02.03.00.48.27;	author schwarze;	state Exp;
branches;
next	1.11;
commitid	YfyANUxCvB10IMDY;

1.11
date	2015.02.02.04.04.18;	author schwarze;	state Exp;
branches;
next	1.10;
commitid	kb4plLn1cByoPbSP;

1.10
date	2014.08.21.12.56.24;	author schwarze;	state Exp;
branches;
next	1.9;
commitid	Y0pln4y7V0yebwer;

1.9
date	2014.08.17.18.42.07;	author schwarze;	state Exp;
branches;
next	1.8;
commitid	sx8BHByh8NPOG90r;

1.8
date	2014.08.11.04.18.18;	author schwarze;	state Exp;
branches;
next	1.7;
commitid	OrK7ZCs0XQIBx79v;

1.7
date	2014.06.20.18.32.51;	author schwarze;	state Exp;
branches;
next	1.6;
commitid	jjzTl6WbjEdf57ey;

1.6
date	2014.04.08.04.45.50;	author schwarze;	state Exp;
branches;
next	1.5;

1.5
date	2012.07.12.15.31.49;	author schwarze;	state Exp;
branches;
next	1.4;

1.4
date	2012.07.09.17.52.09;	author schwarze;	state Exp;
branches;
next	1.3;

1.3
date	2012.07.07.14.10.55;	author schwarze;	state Exp;
branches;
next	1.2;

1.2
date	2011.11.17.16.28.45;	author schwarze;	state Exp;
branches;
next	1.1;

1.1
date	2010.12.04.14.49.40;	author schwarze;	state Exp;
branches;
next	;


desc
@@


1.17
log
@style message about missing blank before trailing delimiter;
inspired by mdoclint(1), and jmc@@ considers it useful
@
text
@# $OpenBSD: Makefile,v 1.16 2017/03/08 22:53:35 schwarze Exp $

REGRESS_TARGETS	 = badNAME badNAMEuse break broken
REGRESS_TARGETS	+= empty emptyNAME emptyNAMEuse
REGRESS_TARGETS	+= font long par parns punct

LINT_TARGETS	 = badNAME badNAMEuse break broken punct

# groff-1.22.3/mandoc differences:
# - When the head of an Nm block in the SYNOPSIS is broken by an
#   explicit block end macro on the same line, formatting differs,
#   but doesn't make sense either way.
# - Groff doesn't support the nS register.

SKIP_GROFF	 = broken parns
SKIP_TMAN	 = broken par parns

# groff-1.22.3 defect:
# When a SYNOPSIS Nm block head breaks a sub block, all the
# remaining content in the document gets lost.

SKIP_GROFF	+= break

SKIP_MARKDOWN	?= badNAME badNAMEuse emptyNAME emptyNAMEuse

.include <bsd.regress.mk>
@


1.16
log
@Now that markdown output is tested for almost everything, test all
input files in -T markdown output mode by default and only mark
those files with SKIP_MARKDOWN that are not to be tested.
Much easier to read, and almost minus 40 lines of Makefile code.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2017/03/05 19:59:26 schwarze Exp $
d7 1
a7 1
LINT_TARGETS	 = badNAME badNAMEuse break broken
@


1.15
log
@first batch of -T markdown tests
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2017/02/11 20:22:17 schwarze Exp $
a8 3
MARKDOWN_TARGETS  = break broken empty
MARKDOWN_TARGETS += font long par parns punct

d23 2
@


1.14
log
@new regression tests for mdoc_macro.c revs. 1.167-1.172
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2017/02/06 03:44:37 schwarze Exp $
d8 3
@


1.13
log
@one less groff-mandoc difference after mdoc_validate.c rev. 1.234
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2015/02/03 00:48:27 schwarze Exp $
d7 1
a7 1
LINT_TARGETS	 = badNAME badNAMEuse break
@


1.12
log
@Bring .Pp/.Lp handling inside .Nm blocks closer to groff;
as a bonus, get rid of another call to rew_sub().
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2015/02/02 04:04:18 schwarze Exp $
a9 3
# - When the first Nm does not have an argument but a later one has,
#   mandoc retroactively uses the later name for the earlier instances
#   of Nm, too, while groff does not.
d15 1
a15 1
SKIP_GROFF	 = badNAMEuse emptyNAMEuse broken parns
@


1.11
log
@When a full block macro gets closed out by a mismatching
block closure macro it calls, do not attempt to open its body.
This can for example happen for (nonsensical) constructions like
.Fo
.Nm Fc
in the SYNOPSIS.  Fixing an assertion failure jsg@@ found with afl
some time ago (test case number 731).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2014/08/21 12:56:24 schwarze Exp $
d5 1
a5 1
REGRESS_TARGETS	+= font long punct
d16 1
d18 2
a19 2
SKIP_GROFF	 = badNAMEuse emptyNAMEuse broken
SKIP_TMAN	 = broken SILENT
@


1.10
log
@Right after .Fl, a middle delimiter triggers an empty scope,
just like a closing delimiter.  This didn't work in groff-1.15,
but it now works in groff-1.22.

After being closed by delimiters, .Nm scopes do not reopen.

Do not suppress white space after .Fl if the next node is a text node
on the same input line; that can happen for middle delimiters.

Fixing an issue reported by jmc@@.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2014/08/17 18:42:07 schwarze Exp $
d3 2
a4 1
REGRESS_TARGETS	 = badNAME badNAMEuse break empty emptyNAME emptyNAMEuse
d9 7
a15 4
# groff-1.22.2/mandoc difference:
# When the first Nm does not have an argument but a later one has,
# mandoc retroactively uses the later name for the earlier instances
# of Nm, too, while groff does not.
d17 2
a18 1
SKIP_GROFF	 = badNAMEuse emptyNAMEuse
d20 1
a20 1
# groff-1.22.2 defect:
@


1.9
log
@Segfault fixes from kristaps@@.
Note that .It and .Nm blocks without bodies cannot be generated by
valid mdoc(7) syntax but are a adequate representations of invalid
mdoc(7) constructs like Bl -hang It Bo Sh and Sh SYNOPSIS Nm Bo Sh.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2014/08/11 04:18:18 schwarze Exp $
d4 1
a4 1
REGRESS_TARGETS	+= font long
@


1.8
log
@start catching up with recent code changes, but no new files yet
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2014/06/20 18:32:51 schwarze Exp $
d3 2
a4 1
REGRESS_TARGETS = empty font emptyNAME emptyNAMEuse badNAME badNAMEuse long
d6 1
a6 1
LINT_TARGETS = badNAME badNAMEuse
d8 12
a19 1
SKIP_GROFF = emptyNAMEuse badNAMEuse
@


1.7
log
@regression tests for prologue warnings
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2014/04/08 04:45:50 schwarze Exp $
d7 1
a7 1
SKIP_GROFF = emptyNAME emptyNAMEuse badNAME badNAMEuse
@


1.6
log
@more tests for excessively long text in TERMP_NOBREAK mode
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2012/07/12 15:31:49 schwarze Exp $
d4 2
@


1.5
log
@regression tests related to mdoc_validate rev. 1.105
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2012/07/09 17:52:09 schwarze Exp $
d3 1
a3 1
REGRESS_TARGETS = empty font emptyNAME emptyNAMEuse badNAME badNAMEuse
@


1.4
log
@fix -Tman font handling for:
.Ad .Ar .Cd .Cm .Dv .Em .Er .Ev .Fa .Fl .Fn .Fo .Ft
.Ic .In .Lk .Li .Ms .Mt .Nm .Pa .Sx .Sy .Tn .Va .Vt
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2012/07/07 14:10:55 schwarze Exp $
d3 3
a5 1
REGRESS_TARGETS = empty font
@


1.3
log
@after several improvements to -Tman went in,
enable lots of related regression tests
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2011/11/17 16:28:45 schwarze Exp $
d3 1
a3 1
REGRESS_TARGETS=empty
@


1.2
log
@Complete overhaul of the mandoc(1) test suite.
* Test the recently introduced -Tman output mode, too.
* Specify date and OS arguments in all tests.
* Remove the kludge of sed(1)ing away the page footer lines.
* New make(1) variables SKIP_TMAN, SKIP_GROFF.
* Drop obsolete, clumsy make(1) variable GROFF_TARGETS.
* Delete obsolete mdoc/Bl/E*.sh error reporting tests.
* Silence char/N/basic.
* New targets:
- ascii, ascii-clean - to run -Tascii tests only
- tman, tman-clean - to run the new -Tman tests only
- obj-clean - maintainer only, needed before groff-clean and groff
- groff-clean - maintainer only, affects checked-in files
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1 2010/12/04 14:49:40 schwarze Exp $
a3 2

SKIP_TMAN ?= empty
@


1.1
log
@add a few simple tests found in my tree
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1 2009/10/28 03:20:42 schwarze Exp $
d4 2
a5 1
GROFF_TARGETS=empty
@

