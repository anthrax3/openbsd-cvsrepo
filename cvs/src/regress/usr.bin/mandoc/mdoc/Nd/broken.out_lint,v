head	1.5;
access;
symbols
	OPENBSD_6_1:1.5.0.4
	OPENBSD_6_1_BASE:1.5
	OPENBSD_6_0:1.2.0.8
	OPENBSD_6_0_BASE:1.2
	OPENBSD_5_9:1.2.0.2
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.2.0.6
	OPENBSD_5_8_BASE:1.2
	OPENBSD_5_7:1.2.0.4
	OPENBSD_5_7_BASE:1.2;
locks; strict;
comment	@# @;


1.5
date	2017.03.06.17.25.24;	author schwarze;	state Exp;
branches;
next	1.4;
commitid	T3Lyz7zZ1p6Y3Qbz;

1.4
date	2017.02.11.20.22.17;	author schwarze;	state Exp;
branches;
next	1.3;
commitid	ivIhpwuH93gYPo1z;

1.3
date	2017.01.08.00.10.22;	author schwarze;	state Exp;
branches;
next	1.2;
commitid	W4clzDItIfTolc66;

1.2
date	2015.02.23.13.30.02;	author schwarze;	state Exp;
branches;
next	1.1;
commitid	0JG7TLVmNW4cori6;

1.1
date	2015.02.11.13.37.31;	author schwarze;	state Exp;
branches;
next	;
commitid	VGYKVVAdlQgUdM8r;


desc
@@


1.5
log
@Using .Nd only makes sense in the NAME section.
Warn if that macro occurs elsewhere.
Triggered by a question from Dag-Erling Smoergrav <des @@ FreeBSD>.
@
text
@mandoc: broken.in:28:11: WARNING: blocks badly nested: Bo breaks Pq
mandoc: broken.in:5:2: WARNING: bad NAME section content: Oo
mandoc: broken.in:9:1: WARNING: bad NAME section content: text
mandoc: broken.in:4:2: WARNING: NAME section without Nm before Nd
mandoc: broken.in:4:2: WARNING: NAME section without description
mandoc: broken.in:16:2: WARNING: description line outside NAME section: Nd
mandoc: broken.in:13:2: WARNING: moving content out of list: Bl
mandoc: broken.in:18:1: WARNING: moving content out of list: text
mandoc: broken.in:27:2: WARNING: description line outside NAME section: Nd
@


1.4
log
@new regression tests for mdoc_macro.c revs. 1.167-1.172
@
text
@d6 1
d9 1
@


1.3
log
@Stricter validation of the NAME section, in particular:
- require a comma between names
- reject all other text nodes
- reject all empty Nm below NAME, not only in the leading position
- reject Nm after Nd
@
text
@d1 1
@


1.2
log
@improve NAME section diagnostics;
confusing messages reported by Jan Stary <hans at stare dot cz>
@
text
@d3 1
a3 1
mandoc: broken.in:4:2: WARNING: NAME section without name
@


1.1
log
@explicit blocks close out .Nd; fixing data structure corruption
eventually leading to NULL pointer access;
found by jsg@@ with afl, text case #455.
@
text
@d1 4
a4 2
mandoc: broken.in:5:2: WARNING: bad NAME section contents: Oo
mandoc: broken.in:9:1: WARNING: bad NAME section contents: text
@

