head	1.3;
access;
symbols
	OPENBSD_6_0:1.2.0.8
	OPENBSD_6_0_BASE:1.2
	OPENBSD_5_9:1.2.0.2
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.2.0.6
	OPENBSD_5_8_BASE:1.2
	OPENBSD_5_7:1.2.0.4
	OPENBSD_5_7_BASE:1.2;
locks; strict;
comment	@# @;


1.3
date	2017.02.16.09.47.10;	author schwarze;	state Exp;
branches;
next	1.2;
commitid	CGH7SijTvfRoSBIL;

1.2
date	2015.02.12.13.52.12;	author schwarze;	state Exp;
branches;
next	1.1;
commitid	YdleMpqIEn5SQL56;

1.1
date	2014.12.22.23.26.20;	author schwarze;	state Exp;
branches;
next	;
commitid	7lnT7ht5X6HoJfAt;


desc
@@


1.3
log
@Fix block scoping error if an explicit block is broken by two
implicit blocks (.Aq Bq Po .Pc) that left the outer breaker open
and could in exceptional cases, like between .Bl and .It, cause
tree corruption leading to NULL dereference.
Found by tb@@ with afl(1).

While here, do not mark intermediate ENDBODY markers as broken.
@
text
@.Dd February 16, 2017
.Dt BREAK-TWICE 1
.Os OpenBSD
.Sh NAME
.Nm break-twice
.Nd breaking the same block twice
.Sh DESCRIPTION
Standard case, fully explicit:
.Bo bo
.Bro bro
.Ao ao brc
.Brc bc
.Bc ac
.Ac
.Pp
Standard case, implicit broken block:
.Bo bo
.Bro bro
.Aq aq brc Brc bc Bc eol
.Pp
Two of the same kind, fully explicit:
.Bo bo
.Bo bo
.Ao ao bc
.Bc bc
.Bc ac
.Ac
.Pp
Two of the same kind, implicit broken block:
.Bo bo
.Bo bo
.Aq aq bc Bc bc Bc eol
.Pp
Two implicit breakers:
.Bl -dash
.Aq aq Bq bq Po po
pc
.Pc
.It
it
.El
@


1.2
log
@After almost five years and 92 revisions, mdoc_macro.c rev. 1.139
finally fixed the four issues explained in the mdoc_macro.c rev. 1.47
commit message.
@
text
@d1 1
a1 1
.Dd February 12, 2015
d8 1
a8 1
Standard case, explicit:
d16 1
a16 1
Standard case, implicit:
d21 1
a21 1
Two of the same kind, explicit:
d29 1
a29 1
Two of the same kind, implicit:
d33 9
@


1.1
log
@The code already pays attention not to close the same block twice.
Similarly, avoid having the same block break two other blocks.
In some situations, this could lead to an endless loop in rew_sub()
found by jsg@@ with afl.
Minimal example:  .Po Ao Pc Bo Pc Ac Bc
@
text
@d1 1
a1 1
.Dd December 23, 2014
d6 1
a6 1
.Nd the same block breaking two other blocks
d8 25
a32 7
.Po po
.Ao ao pc
.Pc
.Bo bo pc
.Pc ac
.Ac bc
.Bc
@

