head	1.2;
access;
symbols
	OPENBSD_5_0:1.1.0.8
	OPENBSD_5_0_BASE:1.1
	OPENBSD_4_9:1.1.0.6
	OPENBSD_4_9_BASE:1.1
	OPENBSD_4_8:1.1.0.4
	OPENBSD_4_8_BASE:1.1
	OPENBSD_4_7:1.1.0.2
	OPENBSD_4_7_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2011.11.17.16.28.45;	author schwarze;	state dead;
branches;
next	1.1;

1.1
date	2009.10.28.03.20.42;	author schwarze;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Complete overhaul of the mandoc(1) test suite.
* Test the recently introduced -Tman output mode, too.
* Specify date and OS arguments in all tests.
* Remove the kludge of sed(1)ing away the page footer lines.
* New make(1) variables SKIP_TMAN, SKIP_GROFF.
* Drop obsolete, clumsy make(1) variable GROFF_TARGETS.
* Delete obsolete mdoc/Bl/E*.sh error reporting tests.
* Silence char/N/basic.
* New targets:
- ascii, ascii-clean - to run -Tascii tests only
- tman, tman-clean - to run the new -Tman tests only
- obj-clean - maintainer only, needed before groff-clean and groff
- groff-clean - maintainer only, affects checked-in files
@
text
@#!/bin/sh

trap 'rm -f *.*_tmp' EXIT

ltypes="bullet dash enum hyphen item tag diag hang ohang inset column"
atypes="compact width offset"
for list in $ltypes; do
  for arg in $atypes; do
    [ "X$arg" = "Xcompact" ] && arg2="" || arg2="Ds"
    ${MANDOC} ${MANDOCOPTS} > ENOTYPE.out_tmp 2> ENOTYPE.err_tmp << __EOF__;
.Dd \$Mdocdate: October 28 2009 $
.Dt ENOTYPE 1
.Os
.Sh NAME
.Nm ENOTYPE
.Nd list argument before list type
.Sh DESCRIPTION
.Bl -${arg} ${arg2} -${list}
.El
__EOF__
    if [ $? -ne 0 ]; then
      echo ".Bl -$arg -$list failed"
      cat ENOTYPE.err_tmp
      exit 1
    fi
    if ! grep -q 'list arguments preceding type' ENOTYPE.err_tmp; then
      echo ".Bl -$arg -$list did not throw ENOTYPE"
      exit 1
    fi
  done
done

exit 0
@


1.1
log
@Add the first batch of mandoc(1) regression tests, testing for a few bugs
fixed in 1.9.9 and some older, rather subtle issues in list displays.

Directory layout and naming scheme was chosen such that later inclusion
of tests for -man and -Thtml will not force us to rename everything,
even though the layout might still seem a bit sparse right now.
More tests will slowly be added while investigating and fixing issues.
@
text
@d11 1
a11 1
.Dd \$Mdocdate: October 21 2009 $
@

