head	1.17;
access;
symbols
	OPENBSD_6_1_BASE:1.17
	OPENBSD_6_0:1.17.0.6
	OPENBSD_6_0_BASE:1.17
	OPENBSD_5_9:1.17.0.2
	OPENBSD_5_9_BASE:1.17
	OPENBSD_5_8:1.17.0.4
	OPENBSD_5_8_BASE:1.17
	OPENBSD_5_7:1.16.0.4
	OPENBSD_5_7_BASE:1.16
	OPENBSD_5_6:1.14.0.4
	OPENBSD_5_6_BASE:1.14
	OPENBSD_5_5:1.13.0.4
	OPENBSD_5_5_BASE:1.13
	OPENBSD_5_4:1.12.0.4
	OPENBSD_5_4_BASE:1.12
	OPENBSD_5_3:1.12.0.2
	OPENBSD_5_3_BASE:1.12
	OPENBSD_5_2:1.11.0.2
	OPENBSD_5_2_BASE:1.11
	OPENBSD_5_1_BASE:1.6
	OPENBSD_5_1:1.6.0.2
	OPENBSD_5_0:1.5.0.2
	OPENBSD_5_0_BASE:1.5
	OPENBSD_4_9:1.4.0.2
	OPENBSD_4_9_BASE:1.4;
locks; strict;
comment	@# @;


1.17
date	2015.03.20.16.09.25;	author schwarze;	state Exp;
branches;
next	1.16;
commitid	Y1cTaTQTnOYfmvkx;

1.16
date	2015.02.06.11.54.03;	author schwarze;	state Exp;
branches;
next	1.15;
commitid	Wgxy0y7jtcdh0XG7;

1.15
date	2014.08.14.02.00.52;	author schwarze;	state Exp;
branches;
next	1.14;
commitid	pqgg86JpQ4OXDxJ3;

1.14
date	2014.06.20.18.27.51;	author schwarze;	state Exp;
branches;
next	1.13;
commitid	mLT3bl90uvOuwvq2;

1.13
date	2013.10.17.20.51.28;	author schwarze;	state Exp;
branches;
next	1.12;

1.12
date	2012.11.18.00.23.56;	author schwarze;	state Exp;
branches;
next	1.11;

1.11
date	2012.07.18.16.55.54;	author schwarze;	state Exp;
branches;
next	1.10;

1.10
date	2012.07.14.10.43.48;	author schwarze;	state Exp;
branches;
next	1.9;

1.9
date	2012.07.10.19.53.12;	author schwarze;	state Exp;
branches;
next	1.8;

1.8
date	2012.07.07.17.47.58;	author schwarze;	state Exp;
branches;
next	1.7;

1.7
date	2012.06.02.20.07.09;	author schwarze;	state Exp;
branches;
next	1.6;

1.6
date	2011.11.17.16.28.45;	author schwarze;	state Exp;
branches;
next	1.5;

1.5
date	2011.07.24.20.26.52;	author schwarze;	state Exp;
branches;
next	1.4;

1.4
date	2011.02.06.13.40.06;	author schwarze;	state Exp;
branches;
next	1.3;

1.3
date	2011.01.17.00.15.19;	author schwarze;	state Exp;
branches;
next	1.2;

1.2
date	2011.01.09.17.55.20;	author schwarze;	state Exp;
branches;
next	1.1;

1.1
date	2011.01.04.01.15.39;	author schwarze;	state Exp;
branches;
next	;


desc
@@


1.17
log
@more tests regarding empty header lines
@
text
@# $OpenBSD: Makefile,v 1.16 2015/02/06 11:54:03 schwarze Exp $

SUBDIR = B BI EX HP IP OP PD PP RS SH SS TH TP TS UR nf blank

.include "../Makefile.sub"
.include <bsd.subdir.mk>
@


1.16
log
@better error reporting regarding .OP .RS .UR .TH arguments
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2014/08/14 02:00:52 schwarze Exp $
d3 1
a3 1
SUBDIR = B BI EX HP IP OP PD PP RS SH TH TP TS UR nf blank
@


1.15
log
@new regression tests collected during recent work
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2014/06/20 18:27:51 schwarze Exp $
d3 1
a3 1
SUBDIR = B BI EX HP IP PD PP RS SH TH TP TS UR nf blank
@


1.14
log
@Infrastructure for regression tests of mandoc messages.
Even though messages are not going to be as stable as formatted output,
that is, even though the *.out_lint files are expected to change now and then,
from now on, i want to be able to catch unintended changes in messages.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2013/10/17 20:51:28 schwarze Exp $
d3 1
a3 1
SUBDIR = BI EX HP IP PD PP RS TH TP TS UR nf blank
@


1.13
log
@Implement the .UR/.UE block (uniform resource identifier) introduced in the
man-ext macros by Eric S. Raymond, enabled by default in groff_man(7).
Usual disclaimer: You don't write new man(7) code, so you are not going
to use these, either.
Improves e.g. the bzr(1) and etherape(1) manuals.
Thanks to naddy@@ for bringing these to my attention.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2012/11/18 00:23:56 schwarze Exp $
d5 1
a5 2
ascii groff groff-clean obj-clean tman: _SUBDIRUSE

@


1.12
log
@Test paragraph distance (.PD) implementation;
related to man_term.c rev. 1.88, man_validate.c rev. 1.56.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2012/07/18 16:55:54 schwarze Exp $
d3 1
a3 1
SUBDIR = BI EX HP IP PD PP RS TH TP TS nf blank
@


1.11
log
@enable more tests, some were forgotten along the way
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2012/07/14 10:43:48 schwarze Exp $
d3 1
a3 1
SUBDIR = BI EX HP IP PP RS TH TP TS nf blank
@


1.10
log
@Translate blank input lines to .sp just like in mdoc(7),
and ignore .sp after .PP.  This fixes vertical spacing
for blank lines after .PP and for .sp after .PP.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2012/07/10 19:53:12 schwarze Exp $
d3 1
a3 1
SUBDIR = nf BI EX HP IP PP RS TH TP blank
@


1.9
log
@multiple fixes to -Tascii .HP rendering:
* do not add an excessive blank line before the block
* in literal mode, start a new line after the tag

getting this to work requires some general (print_man_node) fixes:
* in literal mode, break the output line at the end of each
input line, not just after those input lines ending in text
* but don't break it when there was no output on the line
* and adjust the margins after the .HP tag

these general fixes require an adjustment to -Tascii .TP rendering:
* set up NOBREAK mode before the body, not after the head

finally, based on all this, implement -Tman .Bl -hang in terms of .HP
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2012/07/07 17:47:58 schwarze Exp $
d3 1
a3 1
SUBDIR = nf BI EX HP IP PP RS TH TP
@


1.8
log
@Add a test for RS breaking some other block.
Unfortunately, the code triggering the assert fixed in man_macro.c rev. 1.37
must be commented out because groff misformats the invalid input
so badly that imitating it really makes no sense.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2012/06/02 20:07:09 schwarze Exp $
d3 1
a3 1
SUBDIR= nf BI EX IP PP RS TH TP
@


1.7
log
@Minimal implementation of .EX and .EE for GNU compatibility.
Do not use this, it is not portable and only defined in esr's man-ext.
For example, sox(1) wants these macros.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2011/11/17 16:28:45 schwarze Exp $
d3 1
a3 1
SUBDIR= nf BI EX IP PP TH TP
@


1.6
log
@Complete overhaul of the mandoc(1) test suite.
* Test the recently introduced -Tman output mode, too.
* Specify date and OS arguments in all tests.
* Remove the kludge of sed(1)ing away the page footer lines.
* New make(1) variables SKIP_TMAN, SKIP_GROFF.
* Drop obsolete, clumsy make(1) variable GROFF_TARGETS.
* Delete obsolete mdoc/Bl/E*.sh error reporting tests.
* Silence char/N/basic.
* New targets:
- ascii, ascii-clean - to run -Tascii tests only
- tman, tman-clean - to run the new -Tman tests only
- obj-clean - maintainer only, needed before groff-clean and groff
- groff-clean - maintainer only, affects checked-in files
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2011/07/24 20:26:52 schwarze Exp $
d3 1
a3 1
SUBDIR= nf BI IP PP TH TP
@


1.5
log
@Theo reported that make cleandir deleted too much, triggering this cleanup:

Since quite some time, the groff output files are checked into CVS.
* thus, no longer provide a "groff-clean" target to delete them
* from official targets, no longer call the "groff" target generating them
* do not reimplement "clean" and "cleandir", simply use the official targets
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2011/02/06 13:40:06 schwarze Exp $
d5 1
a5 1
groff: _SUBDIRUSE
@


1.4
log
@another test found in yet another tree;
no more working, but uncommitted tests lying around now
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2011/01/17 00:15:19 schwarze Exp $
d5 1
a5 1
groff groff-clean: _SUBDIRUSE
@


1.3
log
@Refrain from throwing fatal errors for
* .br .sp .nf .fi .na with arguments - just skip the arguments
* .TH lacking arguments - use empty strings instead like groff
* .TH with excessive arguments - skip those
Reminded by Joerg Sonnenberger, ok kristaps@@.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2011/01/09 17:55:20 schwarze Exp $
d3 1
a3 1
SUBDIR= nf BI IP TH TP
@


1.2
log
@test font-alternating blocks in literal context;
related to usr.bin/mandoc/man_term.c rev. 1.51
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1 2011/01/04 01:15:39 schwarze Exp $
d3 1
a3 1
SUBDIR= nf BI IP TP
@


1.1
log
@Multiple man(7) .IP and .TP fixes started during p2k10:

Affecting both -Tascii and -Thtml:
* The .IP HEAD uses the second argument as the width, not the last one.
* Only print the first .IP HEAD argument, not all but the last.

Affecting only -Tascii:
* The .IP and .TP HEADs must be printed without literal mode,
  but literal mode must be restored afterwards.
* After the .IP and .TP bodies, we only want term_newln(), not
  term_flushln(), or we would get two blank lines in literal mode.
* The .TP HEAD does not use TWOSPACE, just like .IP doesn't either.
* In literal mode, clear NOLPAD after each line, or subsequent lines
  would get no indentation whatsoever.

Affecting only -Thtml:
* Only print next-line .TP children, instead of all but the first.

OK kristaps@@ on the -Tascii part; and:
"Can you work this into man_html.c, too?"
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2010/12/19 12:10:33 schwarze Exp $
d3 1
a3 1
SUBDIR= nf IP TP
@

