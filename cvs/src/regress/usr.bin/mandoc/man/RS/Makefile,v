head	1.11;
access;
symbols
	OPENBSD_6_1:1.11.0.10
	OPENBSD_6_1_BASE:1.11
	OPENBSD_6_0:1.11.0.6
	OPENBSD_6_0_BASE:1.11
	OPENBSD_5_9:1.11.0.2
	OPENBSD_5_9_BASE:1.11
	OPENBSD_5_8:1.11.0.4
	OPENBSD_5_8_BASE:1.11
	OPENBSD_5_7:1.10.0.4
	OPENBSD_5_7_BASE:1.10
	OPENBSD_5_6:1.7.0.4
	OPENBSD_5_6_BASE:1.7
	OPENBSD_5_5:1.6.0.4
	OPENBSD_5_5_BASE:1.6
	OPENBSD_5_4:1.4.0.4
	OPENBSD_5_4_BASE:1.4
	OPENBSD_5_3:1.4.0.2
	OPENBSD_5_3_BASE:1.4
	OPENBSD_5_2:1.2.0.2
	OPENBSD_5_2_BASE:1.2;
locks; strict;
comment	@# @;


1.11
date	2015.04.06.13.34.54;	author schwarze;	state Exp;
branches;
next	1.10;
commitid	SwGL2xbaNtOipjxw;

1.10
date	2015.02.06.07.12.34;	author schwarze;	state Exp;
branches;
next	1.9;
commitid	QDbepmLqTNee3zgJ;

1.9
date	2015.01.24.01.59.40;	author schwarze;	state Exp;
branches;
next	1.8;
commitid	pxeX1HXdNjYPBYKE;

1.8
date	2014.08.18.16.26.13;	author schwarze;	state Exp;
branches;
next	1.7;
commitid	ytc98H3JPc5RCcXi;

1.7
date	2014.07.07.21.35.42;	author schwarze;	state Exp;
branches;
next	1.6;
commitid	O2S43bw50KTGcriR;

1.6
date	2014.02.16.12.30.52;	author schwarze;	state Exp;
branches;
next	1.5;

1.5
date	2013.11.11.00.35.51;	author schwarze;	state Exp;
branches;
next	1.4;

1.4
date	2013.01.05.22.18.59;	author schwarze;	state Exp;
branches;
next	1.3;

1.3
date	2012.11.18.17.59.03;	author schwarze;	state Exp;
branches;
next	1.2;

1.2
date	2012.07.18.16.55.54;	author schwarze;	state Exp;
branches;
next	1.1;

1.1
date	2012.07.07.17.47.59;	author schwarze;	state Exp;
branches;
next	;


desc
@@


1.11
log
@Use the default width for .RS without arguments.
Reduces groff-mandoc differences in base and Xenocara by about 4%.
Found while looking at wpa_supplicant(8).
@
text
@# $OpenBSD: Makefile,v 1.10 2015/02/06 07:12:34 schwarze Exp $

REGRESS_TARGETS	 = breaking broken empty literal lonelyRE
REGRESS_TARGETS	+= nested noRE nowidth REarg width
LINT_TARGETS	 = empty lonelyRE noRE REarg

.include <bsd.regress.mk>
@


1.10
log
@Delete the legacy generic warning type MANDOCERR_ARGCWARN,
replacing the last instances by more specific warnings.
Improved functionality, minus 50 lines of code.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2015/01/24 01:59:40 schwarze Exp $
d4 1
a4 1
REGRESS_TARGETS	+= nested noRE REarg width
@


1.9
log
@Support .RE with an argument; needed for audio/pms(1).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2014/08/18 16:26:13 schwarze Exp $
d5 1
a5 1
LINT_TARGETS	 = lonelyRE noRE REarg
@


1.8
log
@When the first child of the node being validated gets deleted during
validation, man_node_unlink() switches to MAN_NEXT_CHILD.  After
that, we have to switch back to MAN_NEXT_SIBLING after completing
validation, or subsequent parsing would add content into an already
closed node, clobbering potentially existing children, causing
information loss and a memory leak.  Bug found by kristaps@@ with
valgrind in groff(7) on Mac OS X.

Note that the switch back must be conditional, for if the node being
validated itself gets deleted, we must *not* go to MAN_NEXT_SIBLING,
which would not only yield wrong results in general but also crash
in malformed manuals having an empty paragraph before the first .SH,
for example OpenBSD c++filt(1).

While here, add the missing <sys/types.h> as required before mandoc.h.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2014/07/07 21:35:42 schwarze Exp $
d3 3
a5 7
REGRESS_TARGETS	 = breaking broken empty literal lonelyRE nested noRE width
LINT_TARGETS	 = broken lonelyRE noRE

# groff-1.22.2/mandoc difference:
# RS PP RE gives a blank line in groff, none in mandoc.

SKIP_GROFF	 = broken
@


1.7
log
@Clean up ERROR messages related to document structure and macros:
Hierarchical naming and mention macro names in messages.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2014/02/16 12:30:52 schwarze Exp $
d3 7
a9 2
REGRESS_TARGETS	= breaking empty literal lonelyRE nested noRE width
LINT_TARGETS	= lonelyRE noRE
@


1.6
log
@when indenting, extend the right margin accordingly, when needed;
fixes a crash reported by blambert@@ and a few other, similar ones
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2013/11/11 00:35:51 schwarze Exp $
d3 2
a4 1
REGRESS_TARGETS = breaking empty literal lonelyRE nested width
@


1.5
log
@In the parser, when closing an explicit block that is not open,
close below-subsection implicit scopes that may still be open.
In the formatter, make sure indentation is reset when leaving a scope,
not only when entering the next one.

Improves the formatting of gpg(1); issue reported by jca on ports.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2013/01/05 22:18:59 schwarze Exp $
d3 1
a3 1
REGRESS_TARGETS = breaking empty literal lonelyRE nested
@


1.4
log
@In literal mode (.nf), each input line must be kept together
on the same output line, even if it is longer than the output width.
This commit fixes a bug allowing an overly long last line of an
indented block (.RS) to be broken even in literal mode.

The bug was found using the sudo_plugin(4) manual provided by millert@@.

I introduced the bug in rev. 1.84 during the g2k12 Budapest hackathon.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2012/11/18 17:59:03 schwarze Exp $
d3 1
a3 1
REGRESS_TARGETS = breaking empty literal nested
@


1.3
log
@Correct indentation for lists and displays inside lists.

Inspired by a diff from millert@@, but implemented rather
differently and with slightly better functionality.
In particular, this one respects -offset and -width
arguments found in the input file.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2012/07/18 16:55:54 schwarze Exp $
d3 1
a3 1
REGRESS_TARGETS = breaking empty nested
@


1.2
log
@enable more tests, some were forgotten along the way
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1 2012/07/07 17:47:59 schwarze Exp $
d3 1
a3 1
REGRESS_TARGETS = breaking empty
@


1.1
log
@Add a test for RS breaking some other block.
Unfortunately, the code triggering the assert fixed in man_macro.c rev. 1.37
must be commented out because groff misformats the invalid input
so badly that imitating it really makes no sense.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2011/11/17 16:28:45 schwarze Exp $
d3 1
a3 1
REGRESS_TARGETS = breaking
@

