head	1.5;
access;
symbols
	OPENBSD_6_1:1.5.0.4
	OPENBSD_6_1_BASE:1.5
	OPENBSD_6_0:1.2.0.4
	OPENBSD_6_0_BASE:1.2
	OPENBSD_5_9:1.2.0.2
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.1.0.6
	OPENBSD_5_8_BASE:1.1
	OPENBSD_5_7:1.1.0.4
	OPENBSD_5_7_BASE:1.1;
locks; strict;
comment	@# @;


1.5
date	2017.01.26.18.28.05;	author schwarze;	state Exp;
branches;
next	1.4;
commitid	Yxdf4tUMRu7gtmiH;

1.4
date	2017.01.19.01.00.11;	author schwarze;	state Exp;
branches;
next	1.3;
commitid	JaaPsBMnLuMI8auG;

1.3
date	2017.01.18.19.22.18;	author schwarze;	state Exp;
branches;
next	1.2;
commitid	rkOTHV44amzifb9Y;

1.2
date	2015.09.08.22.57.28;	author schwarze;	state Exp;
branches;
next	1.1;
commitid	sGR3KrRS7sfcRrYc;

1.1
date	2014.10.28.02.49.48;	author schwarze;	state Exp;
branches;
next	;
commitid	rG053fgO7c4o4wul;


desc
@@


1.5
log
@Fix -man -Thtml formatting after .nf (which has nothing to do
with "literal", by the way, it means "no fill"):

* Use <pre> such that whitespace is preserved.
* Preserve lines breaks.
* For font alternating macros, avoid node recursion which required
scary juggling with the fill state.  Instead, simply print the text
children directly.

Missing feature first noticed by kristaps@@ in 2011,
the again reported by afresh1@@ in 2016,
and finally reported here: https://github.com/Debian/debiman/issues/21 ,
which i only found because of Shane Kerr's comment here:
https://plus.google.com/110314300533310775053/posts/H1eaw9Yskoc
@
text
@BEGINTEST
&#162;&#162;	CENT SIGN
&#164;&#164;	CURRENCY SIGN
&#165;&#165;	YEN SIGN
&#166;&#166;	BROKEN BAR
&#168;&#168;	DIAERESIS
&#169;&#169;	COPYRIGHT SIGN
&#170;	FEMININE ORDINAL INDICATOR
&#171;&#171;	LEFT-POINTING DOUBLE ANGLE QUOTATION MARK
&#172;&#172;&#172;	NOT SIGN
&#173;    SOFT HYPHEN
&#174;&#174;	REGISTERED SIGN
&#177;&#177;&#177;	PLUS-MINUS SIGN
&#178;	SUPERSCRIPT TWO
&#179;	SUPERSCRIPT THREE
&#180;&#180;&#180;	ACUTE ACCENT
&#181;&#181;	MICRO SIGN
&#183;&#183;	MIDDLE DOT
&#184;&#184;	CEDILLA
&#185;	SUPERSCRIPT ONE
&#186;	MASCULINE ORDINAL INDICATOR
&#187;&#187;	RIGHT-POINTING DOUBLE ANGLE QUOTATION MARK
&#188;&#188;	VULGAR FRACTION ONE QUARTER
&#189;&#189;	VULGAR FRACTION ONE HALF
&#190;&#190;	VULGAR FRACTION THREE QUARTERS
&#192;&#192;	LATIN CAPITAL LETTER A WITH GRAVE
&#193;&#193;	LATIN CAPITAL LETTER A WITH ACUTE
&#194;&#194;	LATIN CAPITAL LETTER A WITH CIRCUMFLEX
&#195;&#195;	LATIN CAPITAL LETTER A WITH TILDE
&#196;&#196;	LATIN CAPITAL LETTER A WITH DIAERESIS
&#197;&#197;	LATIN CAPITAL LETTER A WITH RING ABOVE
&#198;&#198;	LATIN CAPITAL LETTER AE
&#199;&#199;	LATIN CAPITAL LETTER C WITH CEDILLA
&#200;&#200;	LATIN CAPITAL LETTER E WITH GRAVE
&#201;&#201;	LATIN CAPITAL LETTER E WITH ACUTE
&#202;&#202;	LATIN CAPITAL LETTER E WITH CIRCUMFLEX
&#203;&#203;	LATIN CAPITAL LETTER E WITH DIAERESIS
&#204;&#204;	LATIN CAPITAL LETTER I WITH GRAVE
&#205;&#205;	LATIN CAPITAL LETTER I WITH ACUTE
&#206;&#206;	LATIN CAPITAL LETTER I WITH CIRCUMFLEX
&#207;&#207;	LATIN CAPITAL LETTER I WITH DIAERESIS
&#208;&#208;	LATIN CAPITAL LETTER ETH
&#209;&#209;	LATIN CAPITAL LETTER N WITH TILDE
&#210;&#210;	LATIN CAPITAL LETTER O WITH GRAVE
&#211;&#211;	LATIN CAPITAL LETTER O WITH ACUTE
&#212;&#212;	LATIN CAPITAL LETTER O WITH CIRCUMFLEX
&#213;&#213;	LATIN CAPITAL LETTER O WITH TILDE
&#214;&#214;	LATIN CAPITAL LETTER O WITH DIAERESIS
&#215;&#215;&#215;	MULTIPLICATION SIGN
&#216;&#216;	LATIN CAPITAL LETTER O WITH STROKE
&#217;&#217;	LATIN CAPITAL LETTER U WITH GRAVE
&#218;&#218;	LATIN CAPITAL LETTER U WITH ACUTE
&#219;&#219;	LATIN CAPITAL LETTER U WITH CIRCUMFLEX
&#220;&#220;	LATIN CAPITAL LETTER U WITH DIAERESIS
&#221;	LATIN CAPITAL LETTER Y WITH ACUTE
&#224;&#224;	LATIN SMALL LETTER A WITH GRAVE
&#225;&#225;	LATIN SMALL LETTER A WITH ACUTE
&#226;&#226;	LATIN SMALL LETTER A WITH CIRCUMFLEX
&#227;&#227;	LATIN SMALL LETTER A WITH TILDE
&#228;&#228;	LATIN SMALL LETTER A WITH DIAERESIS
&#229;&#229;	LATIN SMALL LETTER A WITH RING ABOVE
&#230;&#230;	LATIN SMALL LETTER AE
&#231;&#231;	LATIN SMALL LETTER C WITH CEDILLA
&#232;&#232;	LATIN SMALL LETTER E WITH GRAVE
&#233;&#233;	LATIN SMALL LETTER E WITH ACUTE
&#234;&#234;	LATIN SMALL LETTER E WITH CIRCUMFLEX
&#235;&#235;	LATIN SMALL LETTER E WITH DIAERESIS
&#236;&#236;	LATIN SMALL LETTER I WITH GRAVE
&#237;&#237;	LATIN SMALL LETTER I WITH ACUTE
&#238;&#238;	LATIN SMALL LETTER I WITH CIRCUMFLEX
&#239;&#239;	LATIN SMALL LETTER I WITH DIAERESIS
&#241;&#241;	LATIN SMALL LETTER N WITH TILDE
&#242;&#242;	LATIN SMALL LETTER O WITH GRAVE
&#243;&#243;	LATIN SMALL LETTER O WITH ACUTE
&#244;&#244;	LATIN SMALL LETTER O WITH CIRCUMFLEX
&#245;&#245;	LATIN SMALL LETTER O WITH TILDE
&#246;&#246;	LATIN SMALL LETTER O WITH DIAERESIS
&#247;&#247;&#247;	DIVISION SIGN
&#248;&#248;	LATIN SMALL LETTER O WITH STROKE
&#249;&#249;	LATIN SMALL LETTER U WITH GRAVE
&#250;&#250;	LATIN SMALL LETTER U WITH ACUTE
&#251;&#251;	LATIN SMALL LETTER U WITH CIRCUMFLEX
&#252;&#252;	LATIN SMALL LETTER U WITH DIAERESIS
&#253;	LATIN SMALL LETTER Y WITH ACUTE
&#255;&#255;	LATIN SMALL LETTER Y WITH DIAERESIS
ENDTEST
@


1.4
log
@Implement line breaking of the generated HTML code at space characters
in filled text.  This does not affect HTML semantics, but makes the
HTML code even more humanly readable.

While here,
- collapse multiple consecutive space characters in filled text
- and insert a blank between style entries.
@
text
@a1 1
<br/>
a2 1
<br/>
a3 1
<br/>
a4 1
<br/>
a5 1
<br/>
a6 1
<br/>
a7 1
<br/>
a8 1
<br/>
a9 1
<br/>
d11 1
a11 3
<br/>
&#173; SOFT HYPHEN
<br/>
a12 1
<br/>
a13 1
<br/>
a14 1
<br/>
a15 1
<br/>
a16 1
<br/>
a17 1
<br/>
a18 1
<br/>
a19 1
<br/>
a20 1
<br/>
a21 1
<br/>
a22 1
<br/>
a23 1
<br/>
a24 1
<br/>
a25 1
<br/>
a26 1
<br/>
a27 1
<br/>
a28 1
<br/>
a29 1
<br/>
a30 1
<br/>
a31 1
<br/>
a32 1
<br/>
a33 1
<br/>
a34 1
<br/>
a35 1
<br/>
a36 1
<br/>
a37 1
<br/>
a38 1
<br/>
a39 1
<br/>
a40 1
<br/>
a41 1
<br/>
a42 1
<br/>
a43 1
<br/>
a44 1
<br/>
a45 1
<br/>
a46 1
<br/>
a47 1
<br/>
a48 1
<br/>
a49 1
<br/>
a50 1
<br/>
a51 1
<br/>
a52 1
<br/>
a53 1
<br/>
a54 1
<br/>
a55 1
<br/>
a56 1
<br/>
a57 1
<br/>
a58 1
<br/>
a59 1
<br/>
a60 1
<br/>
a61 1
<br/>
a62 1
<br/>
a63 1
<br/>
a64 1
<br/>
a65 1
<br/>
a66 1
<br/>
a67 1
<br/>
a68 1
<br/>
a69 1
<br/>
a70 1
<br/>
a71 1
<br/>
a72 1
<br/>
a73 1
<br/>
a74 1
<br/>
a75 1
<br/>
a76 1
<br/>
a77 1
<br/>
a78 1
<br/>
a79 1
<br/>
a80 1
<br/>
a81 1
<br/>
a82 1
<br/>
a83 1
<br/>
a84 1
<br/>
a85 1
<br/>
@


1.3
log
@Make HTML output more human readable by overhauling line break logic
around tags and by introducing some simple indentation.
No change of HTML semantics intended.
@
text
@d21 1
a21 1
&#173;    SOFT HYPHEN
@


1.2
log
@Apparently, some recent update of Unicode data in the base system
changed the output of wcwidth(3) for some weird Unicode characters,
causing harmless whitespace changes in mandoc(1) output; fix up the
regression suite accordingly.
The processing of the characters themselves still works correctly,
as it did before, and that's what these tests are intended to make
sure.  They were never intended to check for whitespace issues.
Problem reported by jsg@@.
@
text
@d1 171
a171 86
BEGINTEST<br/>
&#162;&#162;	CENT SIGN<br/>
&#164;&#164;	CURRENCY SIGN<br/>
&#165;&#165;	YEN SIGN<br/>
&#166;&#166;	BROKEN BAR<br/>
&#168;&#168;	DIAERESIS<br/>
&#169;&#169;	COPYRIGHT SIGN<br/>
&#170;	FEMININE ORDINAL INDICATOR<br/>
&#171;&#171;	LEFT-POINTING DOUBLE ANGLE QUOTATION MARK<br/>
&#172;&#172;&#172;	NOT SIGN<br/>
&#173;    SOFT HYPHEN<br/>
&#174;&#174;	REGISTERED SIGN<br/>
&#177;&#177;&#177;	PLUS-MINUS SIGN<br/>
&#178;	SUPERSCRIPT TWO<br/>
&#179;	SUPERSCRIPT THREE<br/>
&#180;&#180;&#180;	ACUTE ACCENT<br/>
&#181;&#181;	MICRO SIGN<br/>
&#183;&#183;	MIDDLE DOT<br/>
&#184;&#184;	CEDILLA<br/>
&#185;	SUPERSCRIPT ONE<br/>
&#186;	MASCULINE ORDINAL INDICATOR<br/>
&#187;&#187;	RIGHT-POINTING DOUBLE ANGLE QUOTATION MARK<br/>
&#188;&#188;	VULGAR FRACTION ONE QUARTER<br/>
&#189;&#189;	VULGAR FRACTION ONE HALF<br/>
&#190;&#190;	VULGAR FRACTION THREE QUARTERS<br/>
&#192;&#192;	LATIN CAPITAL LETTER A WITH GRAVE<br/>
&#193;&#193;	LATIN CAPITAL LETTER A WITH ACUTE<br/>
&#194;&#194;	LATIN CAPITAL LETTER A WITH CIRCUMFLEX<br/>
&#195;&#195;	LATIN CAPITAL LETTER A WITH TILDE<br/>
&#196;&#196;	LATIN CAPITAL LETTER A WITH DIAERESIS<br/>
&#197;&#197;	LATIN CAPITAL LETTER A WITH RING ABOVE<br/>
&#198;&#198;	LATIN CAPITAL LETTER AE<br/>
&#199;&#199;	LATIN CAPITAL LETTER C WITH CEDILLA<br/>
&#200;&#200;	LATIN CAPITAL LETTER E WITH GRAVE<br/>
&#201;&#201;	LATIN CAPITAL LETTER E WITH ACUTE<br/>
&#202;&#202;	LATIN CAPITAL LETTER E WITH CIRCUMFLEX<br/>
&#203;&#203;	LATIN CAPITAL LETTER E WITH DIAERESIS<br/>
&#204;&#204;	LATIN CAPITAL LETTER I WITH GRAVE<br/>
&#205;&#205;	LATIN CAPITAL LETTER I WITH ACUTE<br/>
&#206;&#206;	LATIN CAPITAL LETTER I WITH CIRCUMFLEX<br/>
&#207;&#207;	LATIN CAPITAL LETTER I WITH DIAERESIS<br/>
&#208;&#208;	LATIN CAPITAL LETTER ETH<br/>
&#209;&#209;	LATIN CAPITAL LETTER N WITH TILDE<br/>
&#210;&#210;	LATIN CAPITAL LETTER O WITH GRAVE<br/>
&#211;&#211;	LATIN CAPITAL LETTER O WITH ACUTE<br/>
&#212;&#212;	LATIN CAPITAL LETTER O WITH CIRCUMFLEX<br/>
&#213;&#213;	LATIN CAPITAL LETTER O WITH TILDE<br/>
&#214;&#214;	LATIN CAPITAL LETTER O WITH DIAERESIS<br/>
&#215;&#215;&#215;	MULTIPLICATION SIGN<br/>
&#216;&#216;	LATIN CAPITAL LETTER O WITH STROKE<br/>
&#217;&#217;	LATIN CAPITAL LETTER U WITH GRAVE<br/>
&#218;&#218;	LATIN CAPITAL LETTER U WITH ACUTE<br/>
&#219;&#219;	LATIN CAPITAL LETTER U WITH CIRCUMFLEX<br/>
&#220;&#220;	LATIN CAPITAL LETTER U WITH DIAERESIS<br/>
&#221;	LATIN CAPITAL LETTER Y WITH ACUTE<br/>
&#224;&#224;	LATIN SMALL LETTER A WITH GRAVE<br/>
&#225;&#225;	LATIN SMALL LETTER A WITH ACUTE<br/>
&#226;&#226;	LATIN SMALL LETTER A WITH CIRCUMFLEX<br/>
&#227;&#227;	LATIN SMALL LETTER A WITH TILDE<br/>
&#228;&#228;	LATIN SMALL LETTER A WITH DIAERESIS<br/>
&#229;&#229;	LATIN SMALL LETTER A WITH RING ABOVE<br/>
&#230;&#230;	LATIN SMALL LETTER AE<br/>
&#231;&#231;	LATIN SMALL LETTER C WITH CEDILLA<br/>
&#232;&#232;	LATIN SMALL LETTER E WITH GRAVE<br/>
&#233;&#233;	LATIN SMALL LETTER E WITH ACUTE<br/>
&#234;&#234;	LATIN SMALL LETTER E WITH CIRCUMFLEX<br/>
&#235;&#235;	LATIN SMALL LETTER E WITH DIAERESIS<br/>
&#236;&#236;	LATIN SMALL LETTER I WITH GRAVE<br/>
&#237;&#237;	LATIN SMALL LETTER I WITH ACUTE<br/>
&#238;&#238;	LATIN SMALL LETTER I WITH CIRCUMFLEX<br/>
&#239;&#239;	LATIN SMALL LETTER I WITH DIAERESIS<br/>
&#241;&#241;	LATIN SMALL LETTER N WITH TILDE<br/>
&#242;&#242;	LATIN SMALL LETTER O WITH GRAVE<br/>
&#243;&#243;	LATIN SMALL LETTER O WITH ACUTE<br/>
&#244;&#244;	LATIN SMALL LETTER O WITH CIRCUMFLEX<br/>
&#245;&#245;	LATIN SMALL LETTER O WITH TILDE<br/>
&#246;&#246;	LATIN SMALL LETTER O WITH DIAERESIS<br/>
&#247;&#247;&#247;	DIVISION SIGN<br/>
&#248;&#248;	LATIN SMALL LETTER O WITH STROKE<br/>
&#249;&#249;	LATIN SMALL LETTER U WITH GRAVE<br/>
&#250;&#250;	LATIN SMALL LETTER U WITH ACUTE<br/>
&#251;&#251;	LATIN SMALL LETTER U WITH CIRCUMFLEX<br/>
&#252;&#252;	LATIN SMALL LETTER U WITH DIAERESIS<br/>
&#253;	LATIN SMALL LETTER Y WITH ACUTE<br/>
&#255;&#255;	LATIN SMALL LETTER Y WITH DIAERESIS<br/>
ENDTEST<br/>
@


1.1
log
@some new and/or updated regression tests for -Tascii, -Tutf8
and -Thtml rendering of character escape sequences
@
text
@d11 1
a11 1
&#173;	SOFT HYPHEN<br/>
@

