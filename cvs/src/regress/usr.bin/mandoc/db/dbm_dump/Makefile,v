head	1.4;
access;
symbols
	OPENBSD_6_2_BASE:1.4
	OPENBSD_6_1:1.4.0.4
	OPENBSD_6_1_BASE:1.4;
locks; strict;
comment	@# @;


1.4
date	2016.09.23.15.08.10;	author bluhm;	state Exp;
branches;
next	1.3;
commitid	DKpU8dTsECo4p2mp;

1.3
date	2016.09.04.11.51.38;	author bluhm;	state Exp;
branches;
next	1.2;
commitid	1w6Sj0VxXqPq5MgQ;

1.2
date	2016.09.01.17.42.08;	author schwarze;	state Exp;
branches;
next	1.1;
commitid	I3UKhqAVqUlEzK2c;

1.1
date	2016.07.30.10.56.13;	author schwarze;	state Exp;
branches;
next	;
commitid	o23p1rq9Y9q750Ix;


desc
@@


1.4
log
@Add dependencies to build the required test tools for mandoc on
demand.  This is necessary to run make regress without make all or
make build.
@
text
@# $OpenBSD: Makefile,v 1.3 2016/09/04 11:51:38 bluhm Exp $

PROG =		dbm_dump
CPPFLAGS +=	-I${BSDSRCDIR}/usr.bin/mandoc
MOBJS =		dbm.o dbm_map.o
LDADD +=	${MOBJS}
CLEANFILES =	${MOBJS}

dbm_dump: ${MOBJS}

${MOBJS}:
	cd ${BSDSRCDIR}/usr.bin/mandoc && make $@@
	ln -sf ${.OBJDIR}/../../../../../usr.bin/mandoc/$@@ .

.include <bsd.prog.mk>
@


1.3
log
@Mandoc db dump regress depends on objects existing in usr.bin/mandoc.
Build them there if they are missing.  This allows to run the tests
without runnning a make build before.
OK schwarze@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2016/09/01 17:42:08 schwarze Exp $
a8 2
regress: dbm_dump

d12 2
a13 4
	@@cd ${BSDSRCDIR}/usr.bin/mandoc && make depend
	@@cd ${BSDSRCDIR}/usr.bin/mandoc && make ${MOBJS}
	@@cp ${BSDOBJDIR}/usr.bin/mandoc/$@@ . || \
		cp ${BSDSRCDIR}/usr.bin/mandoc/$@@ .
@


1.2
log
@Make this work both with and without "make obj" in src/usr.bin/mandoc;
suggested by bluhm@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1 2016/07/30 10:56:13 schwarze Exp $
d14 2
@


1.1
log
@test suite for the new mandoc.db(5) format;
will be enabled after committing in src/usr.bin/mandoc
@
text
@d1 1
a1 1
# $OpenBSD$
d5 11
a15 2
LDADD +=	${BSDOBJDIR}/usr.bin/mandoc/dbm.o
LDADD +=	${BSDOBJDIR}/usr.bin/mandoc/dbm_map.o
@

