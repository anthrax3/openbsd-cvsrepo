head	1.35;
access;
symbols
	OPENBSD_6_0:1.31.0.2
	OPENBSD_6_0_BASE:1.31
	OPENBSD_5_9:1.30.0.2
	OPENBSD_5_9_BASE:1.30
	OPENBSD_5_8:1.29.0.8
	OPENBSD_5_8_BASE:1.29
	OPENBSD_5_7:1.29.0.6
	OPENBSD_5_7_BASE:1.29
	OPENBSD_5_6:1.29.0.4
	OPENBSD_5_6_BASE:1.29
	OPENBSD_5_5:1.27.0.10
	OPENBSD_5_5_BASE:1.27
	OPENBSD_5_4:1.27.0.6
	OPENBSD_5_4_BASE:1.27
	OPENBSD_5_3:1.27.0.4
	OPENBSD_5_3_BASE:1.27
	OPENBSD_5_2:1.27.0.2
	OPENBSD_5_2_BASE:1.27
	OPENBSD_5_1_BASE:1.26
	OPENBSD_5_1:1.26.0.4
	OPENBSD_5_0:1.26.0.2
	OPENBSD_5_0_BASE:1.26
	OPENBSD_4_9:1.25.0.6
	OPENBSD_4_9_BASE:1.25
	OPENBSD_4_8:1.25.0.4
	OPENBSD_4_8_BASE:1.25
	OPENBSD_4_7:1.25.0.2
	OPENBSD_4_7_BASE:1.25
	OPENBSD_4_6:1.24.0.8
	OPENBSD_4_6_BASE:1.24
	OPENBSD_4_5:1.24.0.4
	OPENBSD_4_5_BASE:1.24
	OPENBSD_4_4:1.24.0.2
	OPENBSD_4_4_BASE:1.24
	OPENBSD_4_3:1.23.0.4
	OPENBSD_4_3_BASE:1.23
	OPENBSD_4_2:1.23.0.2
	OPENBSD_4_2_BASE:1.23
	OPENBSD_4_1:1.22.0.2
	OPENBSD_4_1_BASE:1.22
	OPENBSD_4_0:1.21.0.6
	OPENBSD_4_0_BASE:1.21
	OPENBSD_3_9:1.21.0.4
	OPENBSD_3_9_BASE:1.21
	OPENBSD_3_8:1.21.0.2
	OPENBSD_3_8_BASE:1.21
	OPENBSD_3_7:1.20.0.2
	OPENBSD_3_7_BASE:1.20
	OPENBSD_3_6:1.18.0.2
	OPENBSD_3_6_BASE:1.18
	OPENBSD_3_5:1.16.0.2
	OPENBSD_3_5_BASE:1.16
	OPENBSD_3_4:1.15.0.2
	OPENBSD_3_4_BASE:1.15
	OPENBSD_3_3:1.14.0.2
	OPENBSD_3_3_BASE:1.14
	OPENBSD_3_2:1.13.0.2
	OPENBSD_3_2_BASE:1.13
	OPENBSD_3_1:1.12.0.2
	OPENBSD_3_1_BASE:1.12
	OPENBSD_3_0:1.5.0.2
	OPENBSD_3_0_BASE:1.5;
locks; strict;
comment	@# @;


1.35
date	2016.09.03.13.37.41;	author guenther;	state Exp;
branches;
next	1.34;
commitid	6T3r4QcMFKe3Fo5T;

1.34
date	2016.09.01.10.13.05;	author tedu;	state Exp;
branches;
next	1.33;
commitid	xDf2xxgel5NzPmiC;

1.33
date	2016.09.01.10.12.34;	author tedu;	state Exp;
branches;
next	1.32;
commitid	2lceGrvBe2E5rzGa;

1.32
date	2016.08.10.14.27.16;	author deraadt;	state Exp;
branches;
next	1.31;
commitid	nJ2GKPOeS3xtih2N;

1.31
date	2016.05.11.21.52.49;	author deraadt;	state Exp;
branches;
next	1.30;
commitid	VpgRpYXqYSJy4P7J;

1.30
date	2015.12.01.07.50.05;	author deraadt;	state Exp;
branches;
next	1.29;
commitid	Rh8AZFtVMVCiwPts;

1.29
date	2014.04.18.14.34.24;	author henning;	state Exp;
branches;
next	1.28;

1.28
date	2014.03.18.22.36.30;	author miod;	state Exp;
branches;
next	1.27;

1.27
date	2012.06.20.18.45.44;	author matthew;	state Exp;
branches;
next	1.26;

1.26
date	2011.07.07.19.39.23;	author deraadt;	state Exp;
branches;
next	1.25;

1.25
date	2010.02.14.12.30.27;	author miod;	state Exp;
branches;
next	1.24;

1.24
date	2008.05.13.20.44.56;	author miod;	state Exp;
branches;
next	1.23;

1.23
date	2007.08.01.21.23.26;	author miod;	state Exp;
branches;
next	1.22;

1.22
date	2006.12.15.19.15.04;	author miod;	state Exp;
branches;
next	1.21;

1.21
date	2005.04.03.07.44.40;	author miod;	state Exp;
branches;
next	1.20;

1.20
date	2004.12.31.00.07.51;	author miod;	state Exp;
branches;
next	1.19;

1.19
date	2004.12.29.04.39.16;	author david;	state Exp;
branches;
next	1.18;

1.18
date	2004.05.03.15.18.19;	author drahn;	state Exp;
branches;
next	1.17;

1.17
date	2004.04.21.18.33.18;	author miod;	state Exp;
branches;
next	1.16;

1.16
date	2004.02.15.23.03.21;	author miod;	state Exp;
branches;
next	1.15;

1.15
date	2003.04.08.20.42.43;	author millert;	state Exp;
branches;
next	1.14;

1.14
date	2002.12.31.16.22.25;	author miod;	state Exp;
branches;
next	1.13;

1.13
date	2002.09.02.20.01.43;	author avsm;	state Exp;
branches;
next	1.12;

1.12
date	2002.02.21.14.34.28;	author todd;	state Exp;
branches;
next	1.11;

1.11
date	2002.02.21.03.57.41;	author todd;	state Exp;
branches;
next	1.10;

1.10
date	2002.02.18.10.43.48;	author art;	state Exp;
branches;
next	1.9;

1.9
date	2002.02.15.21.21.55;	author todd;	state Exp;
branches;
next	1.8;

1.8
date	2002.01.03.01.03.49;	author art;	state Exp;
branches;
next	1.7;

1.7
date	2002.01.01.23.00.51;	author art;	state Exp;
branches;
next	1.6;

1.6
date	2001.11.13.18.05.37;	author deraadt;	state Exp;
branches;
next	1.5;

1.5
date	2001.09.07.17.49.16;	author todd;	state Exp;
branches;
next	1.4;

1.4
date	2001.09.07.17.17.44;	author todd;	state Exp;
branches;
next	1.3;

1.3
date	2001.09.07.17.04.31;	author todd;	state Exp;
branches;
next	1.2;

1.2
date	2001.09.06.21.37.19;	author todd;	state Exp;
branches;
next	1.1;

1.1
date	2001.09.06.20.55.02;	author todd;	state Exp;
branches;
next	;


desc
@@


1.35
log
@Retire zaurus, as it hasn't made the EABI jump and will be permanently broken
shortly when we use the hardware thread register in userland
@
text
@
# $OpenBSD: Makefile,v 1.34 2016/09/01 10:13:05 tedu Exp $

MAKEDEVARCHS+=alpha amd64 armv7 hppa i386 landisk
MAKEDEVARCHS+=loongson luna88k macppc
MAKEDEVARCHS+=sgi socppc sparc64

MAKEDEVTARGS?=all ramdisk

ETCSRCDIR?=	/usr/src/etc

REGRESS_SLOW_TARGETS=${REGRESS_TARGETS}

# test separate targets, all, ramdisk/raminst, std, etc
# t1 = all
# t2 = ramdisk

REGRESS_TARGETS+= ${MAKEDEVARCHS}
REGRESS_ROOT_TARGETS=${REGRESS_TARGETS}

${REGRESS_TARGETS}:
. for _T in ${MAKEDEVTARGS}
	@@echo "====> ${_T}.${.TARGET}"
	@@exec ${SUDO} rm -rf test.${_T}.${.TARGET}
	@@exec mkdir -p -m 700 test.${_T}.${.TARGET}
	@@exec cp ${ETCSRCDIR}/etc.${.TARGET}/MAKEDEV test.${_T}.${.TARGET}
	@@exec ${SUDO} chown root:wheel test.${_T}.${.TARGET}
	@@cd test.${_T}.${.TARGET}; \
	time ${SUDO} sh ./MAKEDEV ${_T} || true; \
	time ${SUDO} sh ./MAKEDEV ${_T} || true; \
	( ls -ln; ls -ln fd/ ) 2> /dev/null | \
		awk '/^[bcps]/ {printf "%s %x.%x %x,%x%s\n",$$1,$$3,$$4,$$5,$$6,$$10} \
		     /^l/      {printf "%s %s.%s%s>%s\n",$$1,$$3,$$4,$$9,$$11}' | \
		sort +5 -n | \
		sed -e 's/rwx/7/g;s/rw-/6/g;s/r-x/5/g;s/r--/4/g' \
		    -e 's/-wx/3/g;s/-w-/2/g;s/--x/1/g;s/---/0/g' \
		    -e 's/^\([bcpsl]\)\([0-9][0-9]*\) /\2\1/' \
		> ../t1.${_T}.${.TARGET}.out
.endfor

clean:
	for f in ${MAKEDEVARCHS}; do rm -rf test.$$f; done
	rm -f ${CLEANFILES}

.PHONY: ${MAKEDEVARCHS}
CLEANFILES+=t1.*.out

.include <bsd.regress.mk>
@


1.34
log
@rm vax
@
text
@d2 1
a2 1
# $OpenBSD: Makefile,v 1.33 2016/09/01 10:12:34 tedu Exp $
d6 1
a6 1
MAKEDEVARCHS+=sgi socppc sparc64 zaurus
@


1.33
log
@remove references to sparc (and even a vax ref that escaped notice)
@
text
@d2 1
a2 1
# $OpenBSD: Makefile,v 1.32 2016/08/10 14:27:16 deraadt Exp $
d6 1
a6 1
MAKEDEVARCHS+=sgi socppc sparc64 vax zaurus
@


1.32
log
@armish handled some early-gen arm machines, which required tons of
workarounds.  Some of them will soon stand in the way of armv7.
Off to the attic you go.
@
text
@d2 1
a2 1
# $OpenBSD: Makefile,v 1.31 2016/05/11 21:52:49 deraadt Exp $
d6 1
a6 1
MAKEDEVARCHS+=sgi socppc sparc sparc64 vax zaurus
@


1.31
log
@remove hppa64 port, which we never got going beyond broken single users.
hppa reverse-stack gives us a valuable test case, but most developers don't
have a 2nd one to proceed further with this.
ok kettenis
@
text
@d2 1
a2 1
# $OpenBSD: Makefile,v 1.30 2015/12/01 07:50:05 deraadt Exp $
d4 1
a4 1
MAKEDEVARCHS+=alpha amd64 armish hppa i386 landisk
@


1.30
log
@Send Aviion to same place as Nova II
discussed with jsg
@
text
@d2 1
a2 1
# $OpenBSD: Makefile,v 1.29 2014/04/18 14:34:24 henning Exp $
d4 1
a4 1
MAKEDEVARCHS+=alpha amd64 armish hppa hppa64 i386 landisk
@


1.29
log
@cut altq here
@
text
@d2 1
a2 1
# $OpenBSD: Makefile,v 1.27 2012/06/20 18:45:44 matthew Exp $
d4 1
a4 1
MAKEDEVARCHS+=alpha amd64 armish aviion hppa hppa64 i386 landisk
@


1.28
log
@Retire hp300, mvme68k and mvme88k ports. These ports have no users, keeping
this hardware alive is becoming increasingly difficult, and I should heed the
message sent by the three disks which have died on me over the last few days.

Noone sane will mourn these ports anyway. So long, and thanks for the fish.
@
text
@d31 1
a31 1
	( ls -ln; ls -ln fd/; ls -ln altq/ ) 2> /dev/null | \
@


1.27
log
@more mac68k bits for the attic
@
text
@d2 1
a2 1
# $OpenBSD: Makefile,v 1.26 2011/07/07 19:39:23 deraadt Exp $
d4 3
a6 3
MAKEDEVARCHS+=alpha amd64 armish aviion hp300 hppa hppa64 i386 landisk
MAKEDEVARCHS+=loongson luna88k macppc mvme68k
MAKEDEVARCHS+=mvme88k sgi socppc sparc sparc64 vax zaurus
@


1.26
log
@remove mvmeppc; it is really rough shape.  ok drahn miod
@
text
@d2 1
a2 1
# $OpenBSD: Makefile,v 1.25 2010/02/14 12:30:27 miod Exp $
d5 1
a5 1
MAKEDEVARCHS+=loongson luna88k mac68k macppc mvme68k
@


1.25
log
@Sync with current state of the tree.
@
text
@d2 1
a2 1
# $OpenBSD: Makefile,v 1.24 2008/05/13 20:44:56 miod Exp $
a5 1
#MAKEDEVARCHS+=mvmeppc
@


1.24
log
@Plumb socppc in MAKEDEV machinery.
@
text
@d2 1
a2 1
# $OpenBSD: Makefile,v 1.23 2007/08/01 21:23:26 miod Exp $
d5 1
a5 1
MAKEDEVARCHS+=luna88k mac68k macppc mvme68k
@


1.23
log
@Retire OpenBSD/cats. Hardware is nice but prone to catch fire, and the firmware
is anything but useful. Nevertheless this was a very good platform to use as
an OpenBSD/*arm* starting point, but nowadays this platform is not necessary
anymore.

Somehow these CATS motherboard are just like AUI hubs, with the difference that,
when my AUI hub caught fire, 10base5 support was not removed from the networking
code.
@
text
@d2 1
a2 1
# $OpenBSD: Makefile,v 1.22 2006/12/15 19:15:04 miod Exp $
d7 1
a7 1
MAKEDEVARCHS+=mvme88k sgi sparc sparc64 vax zaurus
@


1.22
log
@Sync arch list
@
text
@d2 1
a2 1
# $OpenBSD: Makefile,v 1.21 2005/04/03 07:44:40 miod Exp $
d4 1
a4 1
MAKEDEVARCHS+=alpha amd64 armish aviion cats hp300 hppa hppa64 i386 landisk
@


1.21
log
@hppa64
@
text
@d2 1
a2 1
# $OpenBSD: Makefile,v 1.20 2004/12/31 00:07:51 miod Exp $
d4 2
a5 2
MAKEDEVARCHS+=alpha amd64 cats hp300 hppa hppa64 i386 luna88k
MAKEDEVARCHS+=mac68k macppc mvme68k
d7 1
a7 1
MAKEDEVARCHS+=mvme88k sparc sparc64 vax zaurus
@


1.20
log
@+zaurus
@
text
@d2 1
a2 1
# $OpenBSD: Makefile,v 1.19 2004/12/29 04:39:16 david Exp $
d4 2
a5 1
MAKEDEVARCHS+=alpha amd64 cats hp300 hppa i386 luna88k mac68k macppc mvme68k
@


1.19
log
@define REGRESS_ROOT_TARGETS for tests that require root privileges
@
text
@d2 1
a2 1
# $OpenBSD: Makefile,v 1.18 2004/05/03 15:18:19 drahn Exp $
d6 1
a6 1
MAKEDEVARCHS+=mvme88k sparc sparc64 vax
@


1.18
log
@Remove OpenBSD/pegaos, this has been announced before but delayed until
the tree was stable. No point in code supporting a company which screws
its employees being in the OpenBSD tree.
@
text
@d2 1
a2 1
# $OpenBSD: Makefile,v 1.16 2004/02/15 23:03:21 miod Exp $
d19 1
@


1.17
log
@luna88k can play here too
@
text
@d6 1
a6 1
MAKEDEVARCHS+=mvme88k pegasos sparc sparc64 vax
@


1.16
log
@Sync arch list with etc/
@
text
@d2 1
a2 1
# $OpenBSD: Makefile,v 1.15 2003/04/08 20:42:43 millert Exp $
d4 1
a4 1
MAKEDEVARCHS+=alpha amd64 cats hp300 hppa i386 mac68k macppc mvme68k mvme88k
d6 1
a6 1
MAKEDEVARCHS+=pegasos sparc sparc64 vax
@


1.15
log
@Use POSIX chown semantics (user:group); noted by Leandro Costa
@
text
@d2 1
a2 1
# $OpenBSD: Makefile,v 1.14 2002/12/31 16:22:25 miod Exp $
d4 3
a6 2
MAKEDEVARCHS+=alpha hp300 hppa i386 mac68k macppc mvme68k mvme88k
MAKEDEVARCHS+=mvmeppc sparc sparc64 vax
@


1.14
log
@Prepare for the removal of amiga and sun3 platforms from the tree.
There has not been enough activity and interest towards these platform
to keep them lying in the tree.
@
text
@d2 1
a2 1
# $OpenBSD: Makefile,v 1.13 2002/09/02 20:01:43 avsm Exp $
d25 1
a25 1
	@@exec ${SUDO} chown root.wheel test.${_T}.${.TARGET}
@


1.13
log
@Rename a bunch of the old bsd.regress.mk variables into the new ones.

ok art@@
@
text
@d2 1
a2 1
# $OpenBSD: Makefile,v 1.12 2002/02/21 14:34:28 todd Exp $
d4 2
a5 2
MAKEDEVARCHS+=alpha amiga hp300 hppa i386 mac68k macppc mvme68k mvme88k
MAKEDEVARCHS+=mvmeppc sparc sparc64 sun3 vax
@


1.12
log
@allow over-ride of MAKEDEVTARGS
@
text
@d2 1
a2 1
# $OpenBSD: Makefile,v 1.11 2002/02/21 03:57:41 todd Exp $
d11 1
a11 1
REGRESSSLOWTARGETS=${REGRESSTARGETS}
d17 1
a17 1
REGRESSTARGETS+= ${MAKEDEVARCHS}
d19 1
a19 1
${REGRESSTARGETS}:
@


1.11
log
@test ramdisk targets too
@
text
@d2 1
a2 1
# $OpenBSD: Makefile,v 1.10 2002/02/18 10:43:48 art Exp $
d7 1
a7 1
MAKEDEVTARGS+=all ramdisk
@


1.10
log
@Looks like too much cut 'n paste.
@
text
@d2 1
a2 1
# $OpenBSD: Makefile,v 1.9 2002/02/15 21:21:55 todd Exp $
d7 2
d11 2
d14 2
d17 1
a17 2
REGRESSTARGETS=${MAKEDEVARCHS}
REGRESSSLOWTARGETS=${REGRESSTARGETS}
d19 11
a29 9
${MAKEDEVARCHS}:
	@@echo "====> ${.TARGET}"
	@@exec ${SUDO} rm -rf test.${.TARGET}
	@@exec mkdir -p -m 700 test.${.TARGET}
	@@exec cp ${ETCSRCDIR}/etc.${.TARGET}/MAKEDEV test.${.TARGET}
	@@exec ${SUDO} chown root.wheel test.${.TARGET}
	@@cd test.${.TARGET}; time ${SUDO} sh ./MAKEDEV all || true; \
	time ${SUDO} sh ./MAKEDEV all || true; \
	( ls -ln; ls -ln fd/; ls -ln altq/ ) | \
d36 2
a37 1
		> ../t1.${.TARGET}.out
@


1.9
log
@more compact .out file
@
text
@d2 1
a2 1
# $OpenBSD: Makefile,v 1.8 2002/01/03 01:03:49 art Exp $
d35 1
a35 1
.PHONY: t1 t2 t3 t4 t5 t6 t7 regress ${MAKEDEVARCHS}
@


1.8
log
@all MAKEDEV tests are slow.
@
text
@d2 1
a2 1
# $OpenBSD: Makefile,v 1.7 2002/01/01 23:00:51 art Exp $
d22 8
a29 4
	( ls -l; ls -l fd/; ls -l altq/ ) | \
		awk '/^[bcps]/ {print $$1,$$2,$$3,$$4,$$5,$$6,$$10} \
		     /^l/      {print $$1,$$2,$$3,$$4,$$5,$$9,$$10,$$11}' |\
		sort +4 -n > ../t1.${.TARGET}.out
@


1.7
log
@trivial conversions to bsd.regress.mk
@
text
@d2 1
a2 1
# $OpenBSD: Makefile,v 1.6 2001/11/13 18:05:37 deraadt Exp $
d12 1
@


1.6
log
@use a close directory for play
@
text
@a0 1
# $OpenBSD: Makefile,v 1.5 2001/09/07 17:49:16 todd Exp $
d2 1
a2 4
NOMAN=
NOPROG=
        
regress: t1
d11 1
a11 1
t1: ${MAKEDEVARCHS}
d28 1
d33 1
a33 1
.include <bsd.prog.mk>
@


1.5
log
@presume 'make clean' is already running as root, don't duplicate ${SUDO},
found by naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2001/09/07 17:17:44 todd Exp $
d20 1
a20 1
	@@exec mkdir -p test.${.TARGET}
@


1.4
log
@run each 'MAKEDEV all' twice, to catch things that are not rm'ed
(like vme* links for miod)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2001/09/07 17:04:31 todd Exp $
d13 2
d31 1
a31 1
	for f in ${MAKEDEVARCHS}; do ${SUDO} rm -rf test.$$f; done
@


1.3
log
@everyone has altq/, right?
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2001/09/06 21:37:19 todd Exp $
d22 1
@


1.2
log
@sort by major not minor number, correctly list symbollic links
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1 2001/09/06 20:55:02 todd Exp $
d22 1
a22 1
	( ls -l; ls -l fd/ ) | \
@


1.1
log
@add MAKEDEV regress
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1 2001/06/04 23:08:18 millert Exp $
d23 3
a25 2
		awk '/^[lbcps]/ {print $$1,$$2,$$3,$$4,$$5,$$6,$$10}' |\
		sort +5 -n > ../t1.${.TARGET}.out
@

