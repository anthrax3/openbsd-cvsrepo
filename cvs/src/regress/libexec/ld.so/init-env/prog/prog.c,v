head	1.1;
access;
symbols
	OPENBSD_6_2_BASE:1.1
	OPENBSD_6_1:1.1.0.6
	OPENBSD_6_1_BASE:1.1
	OPENBSD_6_0:1.1.0.2
	OPENBSD_6_0_BASE:1.1;
locks; strict;
comment	@ * @;


1.1
date	2016.03.20.05.13.22;	author guenther;	state Exp;
branches;
next	;
commitid	i4JvbPVpAyREGhYo;


desc
@@


1.1
log
@Add regress for environ and __progname vs load-time .init functions
@
text
@/*
 * Public Domain 2016 Philip Guenther <guenther@@openbsd.org>
 *
 * $OpenBSD$
 */

#include <stdio.h>
#include <stdlib.h>

extern char **environ;

int
main(int argc, char **argv, char **env)
{
	int ret = 0;

	if (env == environ)
		printf("OK: main's 3rd arg == environ\n");
	else {
		ret = 1;
		printf("FAILED: main's 3rd arg isn't environ\n");
	}
	if (getenv("INIT_ENV_REGRESS_TEST") != NULL)
		printf("OK: env var set by .so init function set\n");
	else {
		ret = 1;
		printf("FAILED: env var set by .so init function not set\n");
	}

	return ret;
}
@
