head	1.3;
access;
symbols
	OPENBSD_6_2_BASE:1.3
	OPENBSD_6_1:1.3.0.4
	OPENBSD_6_1_BASE:1.3
	OPENBSD_6_0:1.1.0.12
	OPENBSD_6_0_BASE:1.1
	OPENBSD_5_9:1.1.0.2
	OPENBSD_5_9_BASE:1.1
	OPENBSD_5_8:1.1.0.10
	OPENBSD_5_8_BASE:1.1
	OPENBSD_5_7:1.1.0.8
	OPENBSD_5_7_BASE:1.1
	OPENBSD_5_6:1.1.0.6
	OPENBSD_5_6_BASE:1.1
	OPENBSD_5_5:1.1.0.4
	OPENBSD_5_5_BASE:1.1;
locks; strict;
comment	@# @;


1.3
date	2017.01.14.17.32.16;	author florian;	state Exp;
branches;
next	1.2;
commitid	dIbrhAAkYGur28ME;

1.2
date	2017.01.14.17.31.24;	author florian;	state Exp;
branches;
next	1.1;
commitid	68yc3LbOlyEzPKBI;

1.1
date	2013.09.13.14.51.51;	author florian;	state Exp;
branches;
next	;


desc
@@


1.3
log
@It's not longer a syntax error to provide a flowdst without a port
number. Drop argument altogether to provoke a syntax error.
@
text
@#! /bin/sh

echo '#### up'
ifconfig pflow0 up; ifconfig pflow0 | grep -v '^[[:space:]]index'
echo '#### flowdst syntax error'
ifconfig pflow0 flowdst; ifconfig pflow0 | grep -v '^[[:space:]]index'
echo '#### invalid flowdst port'
ifconfig pflow0 flowdst 127.0.0.1:0; ifconfig pflow0 | grep -v \
	'^[[:space:]]index'
echo '#### flowdst set, invalid flowsrc'
ifconfig pflow0 flowdst 127.0.0.1:9996; ifconfig pflow0 | grep -v \
	'^[[:space:]]index'
echo '#### flowsrc and flowdst set'
ifconfig pflow0 flowsrc 127.0.0.1; ifconfig pflow0 | grep -v '^[[:space:]]index'
echo '#### unset flowdst'
ifconfig pflow0 -flowdst; ifconfig pflow0 | grep -v '^[[:space:]]index'
echo '#### unset flowsrc'
ifconfig pflow0 -flowsrc; ifconfig pflow0 | grep -v '^[[:space:]]index'
echo '#### flowsrc and flowdst set one command'
ifconfig pflow0 flowsrc 127.0.0.1 flowdst 127.0.0.1:9996; ifconfig pflow0 | \
	grep -v '^[[:space:]]index'
echo '#### proto 9'
ifconfig pflow0 pflowproto 9; ifconfig pflow0 | grep -v '^[[:space:]]index'
echo '#### proto 10'
ifconfig pflow0 pflowproto 10; ifconfig pflow0 | grep -v '^[[:space:]]index'
echo '#### proto 5'
ifconfig pflow0 pflowproto 5; ifconfig pflow0 | grep -v '^[[:space:]]index'
echo '#### syntax error proto'
ifconfig pflow0 pflowproto 23; ifconfig pflow0 | grep -v '^[[:space:]]index'
echo '#### flowdst 0.0.0.0:0; INVALID:INVALID'
ifconfig pflow0 flowdst 0.0.0.0:0; ifconfig pflow0 | grep -v '^[[:space:]]index'
echo '#### flowdst 0.0.0.0:1234; INVALID:1234'
ifconfig pflow0 flowdst 0.0.0.0:1234; ifconfig pflow0 | grep -v \
	'^[[:space:]]index'
echo '#### flowsrc 0.0.0.0; INVALID'
ifconfig pflow0 flowsrc 0.0.0.0; ifconfig pflow0 | grep -v '^[[:space:]]index'
echo '#### destroy'
ifconfig pflow0 destroy; ifconfig pflow0 | grep -v '^[[:space:]]index'
@


1.2
log
@Remove priority line, ifconfig(8) prints the interface index on the
same line and that changes on every interface creation, messing up the
diff to ifconfig.ok
@
text
@d6 1
a6 1
ifconfig pflow0 flowdst 127.0.0.1; ifconfig pflow0 | grep -v '^[[:space:]]index'
@


1.1
log
@Test various combinations of flowdst, flowsrc and proto.
@
text
@d4 1
a4 1
ifconfig pflow0 up; ifconfig pflow0
d6 1
a6 1
ifconfig pflow0 flowdst 127.0.0.1;  ifconfig pflow0
d8 2
a9 1
ifconfig pflow0 flowdst 127.0.0.1:0;  ifconfig pflow0
d11 2
a12 1
ifconfig pflow0 flowdst 127.0.0.1:9996;  ifconfig pflow0
d14 1
a14 1
ifconfig pflow0 flowsrc 127.0.0.1; ifconfig pflow0
d16 1
a16 1
ifconfig pflow0 -flowdst; ifconfig pflow0
d18 1
a18 1
ifconfig pflow0 -flowsrc; ifconfig pflow0
d20 2
a21 1
ifconfig pflow0 flowsrc 127.0.0.1 flowdst 127.0.0.1:9996; ifconfig pflow0
d23 1
a23 1
ifconfig pflow0 pflowproto 9; ifconfig pflow0
d25 1
a25 1
ifconfig pflow0 pflowproto 10; ifconfig pflow0
d27 1
a27 1
ifconfig pflow0 pflowproto 5; ifconfig pflow0
d29 1
a29 1
ifconfig pflow0 pflowproto 23; ifconfig pflow0
d31 1
a31 1
ifconfig pflow0 flowdst 0.0.0.0:0; ifconfig pflow0
d33 2
a34 1
ifconfig pflow0 flowdst 0.0.0.0:1234; ifconfig pflow0
d36 1
a36 1
ifconfig pflow0 flowsrc 0.0.0.0; ifconfig pflow0
d38 1
a38 1
ifconfig pflow0 destroy;  ifconfig pflow0
@

