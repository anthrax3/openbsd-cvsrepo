head	1.4;
access;
symbols
	OPENBSD_6_1:1.4.0.4
	OPENBSD_6_1_BASE:1.4
	OPENBSD_6_0:1.2.0.10
	OPENBSD_6_0_BASE:1.2
	OPENBSD_5_9:1.2.0.2
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.2.0.8
	OPENBSD_5_8_BASE:1.2
	OPENBSD_5_7:1.2.0.6
	OPENBSD_5_7_BASE:1.2
	OPENBSD_5_6:1.2.0.4
	OPENBSD_5_6_BASE:1.2
	OPENBSD_5_5:1.1.0.4
	OPENBSD_5_5_BASE:1.1;
locks; strict;
comment	@# @;


1.4
date	2017.01.14.17.32.16;	author florian;	state Exp;
branches;
next	1.3;
commitid	dIbrhAAkYGur28ME;

1.3
date	2017.01.14.17.31.24;	author florian;	state Exp;
branches;
next	1.2;
commitid	68yc3LbOlyEzPKBI;

1.2
date	2014.03.29.11.49.41;	author florian;	state Exp;
branches;
next	1.1;

1.1
date	2013.09.13.14.51.51;	author florian;	state Exp;
branches;
next	;


desc
@@


1.4
log
@It's not longer a syntax error to provide a flowdst without a port
number. Drop argument altogether to provoke a syntax error.
@
text
@#### up
pflow0: flags=1<UP> mtu 1492
	pflow: receiver: INVALID:INVALID version: 5
	groups: pflow
#### flowdst syntax error
ifconfig: 'flowdst' requires argument
pflow0: flags=1<UP> mtu 1492
	pflow: receiver: INVALID:INVALID version: 5
	groups: pflow
#### invalid flowdst port
pflow0: flags=1<UP> mtu 1492
	pflow: receiver: 127.0.0.1:INVALID version: 5
	groups: pflow
#### flowdst set, invalid flowsrc
pflow0: flags=41<UP,RUNNING> mtu 1492
	pflow: receiver: 127.0.0.1:9996 version: 5
	groups: pflow
#### flowsrc and flowdst set
pflow0: flags=41<UP,RUNNING> mtu 1492
	pflow: sender: 127.0.0.1 receiver: 127.0.0.1:9996 version: 5
	groups: pflow
#### unset flowdst
pflow0: flags=1<UP> mtu 1492
	pflow: sender: 127.0.0.1 receiver: INVALID:INVALID version: 5
	groups: pflow
#### unset flowsrc
pflow0: flags=1<UP> mtu 1492
	pflow: receiver: INVALID:INVALID version: 5
	groups: pflow
#### flowsrc and flowdst set one command
pflow0: flags=41<UP,RUNNING> mtu 1492
	pflow: sender: 127.0.0.1 receiver: 127.0.0.1:9996 version: 5
	groups: pflow
#### proto 9
ifconfig: Invalid pflow protocol: 9
pflow0: flags=41<UP,RUNNING> mtu 1492
	pflow: sender: 127.0.0.1 receiver: 127.0.0.1:9996 version: 5
	groups: pflow
#### proto 10
pflow0: flags=41<UP,RUNNING> mtu 1448
	pflow: sender: 127.0.0.1 receiver: 127.0.0.1:9996 version: 10
	groups: pflow
#### proto 5
pflow0: flags=41<UP,RUNNING> mtu 1492
	pflow: sender: 127.0.0.1 receiver: 127.0.0.1:9996 version: 5
	groups: pflow
#### syntax error proto
ifconfig: Invalid pflow protocol: 23
pflow0: flags=41<UP,RUNNING> mtu 1492
	pflow: sender: 127.0.0.1 receiver: 127.0.0.1:9996 version: 5
	groups: pflow
#### flowdst 0.0.0.0:0; INVALID:INVALID
pflow0: flags=1<UP> mtu 1492
	pflow: sender: 127.0.0.1 receiver: INVALID:INVALID version: 5
	groups: pflow
#### flowdst 0.0.0.0:1234; INVALID:1234
pflow0: flags=1<UP> mtu 1492
	pflow: sender: 127.0.0.1 receiver: INVALID:1234 version: 5
	groups: pflow
#### flowsrc 0.0.0.0; INVALID
pflow0: flags=1<UP> mtu 1492
	pflow: receiver: INVALID:1234 version: 5
	groups: pflow
#### destroy
pflow0: no such interface
@


1.3
log
@Remove priority line, ifconfig(8) prints the interface index on the
same line and that changes on every interface creation, messing up the
diff to ifconfig.ok
@
text
@d6 1
a6 1
ifconfig: 127.0.0.1 bad value
@


1.2
log
@pflowproto 9 is no more.
While there fix regression for inaddr_any flowsrc.
@
text
@a2 1
	priority: 0
a7 1
	priority: 0
a11 1
	priority: 0
a15 1
	priority: 0
a19 1
	priority: 0
a23 1
	priority: 0
a27 1
	priority: 0
a31 1
	priority: 0
a36 1
	priority: 0
a40 1
	priority: 0
a44 1
	priority: 0
a49 1
	priority: 0
a53 1
	priority: 0
a57 1
	priority: 0
a61 1
	priority: 0
@


1.1
log
@Test various combinations of flowdst, flowsrc and proto.
@
text
@d4 1
a4 1
	pflow: sender: INVALID receiver: INVALID:INVALID version: 5
d10 1
a10 1
	pflow: sender: INVALID receiver: INVALID:INVALID version: 5
d15 1
a15 1
	pflow: sender: INVALID receiver: 127.0.0.1:INVALID version: 5
d18 1
a18 1
pflow0: flags=1<UP> mtu 1492
d20 1
a20 1
	pflow: sender: INVALID receiver: 127.0.0.1:9996 version: 5
d35 1
a35 1
	pflow: sender: INVALID receiver: INVALID:INVALID version: 5
d43 2
a44 1
pflow0: flags=41<UP,RUNNING> mtu 1428
d46 1
a46 1
	pflow: sender: 127.0.0.1 receiver: 127.0.0.1:9996 version: 9
d77 1
a77 1
	pflow: sender: INVALID receiver: INVALID:1234 version: 5
@

