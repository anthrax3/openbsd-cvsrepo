head	1.2;
access;
symbols
	OPENBSD_6_1:1.2.0.4
	OPENBSD_6_1_BASE:1.2;
locks; strict;
comment	@# @;


1.2
date	2017.02.21.16.31.58;	author bluhm;	state Exp;
branches;
next	1.1;
commitid	lkJNFx2hymDnFfca;

1.1
date	2017.01.26.04.58.08;	author benno;	state Exp;
branches;
next	;
commitid	TE9nK3TPDs0dmTsi;


desc
@@


1.2
log
@Remove SUDO=doas in regress Makefile.  The test developer must not
set the SUDO variable.  The tester may decide wether he runs doas,
sudo or the whole test as root.
discussed with tb@@ semarie@@ benno@@
@
text
@#	$OpenBSD: Makefile,v 1.1 2017/01/26 04:58:08 benno Exp $
TEST_CASES_OK+=		pfioctl1
TEST_CASES_FAILED+=	pfioctl2

REGRESS_TARGETS=	tests_ok tests_failed do-unfdpass1
WARNINGS=		Yes
CFLAGS+=		-Wall -Wundef -Werror
CLEANFILES+=		${TEST_CASES_OK} ${TEST_CASES_FAILED} *.core \
			file1 file2 file3 output test-sock unfdpass

tests_ok: ${TEST_CASES_OK}
	@@for test in $>; do \
		${SUDO} ./$$test; \
	done

tests_failed: ${TEST_CASES_FAILED}
	@@for test in $>; do \
		rm -f ./$$test.core; \
		if ${SUDO} ./$$test; then false; else true; fi; \
		rm -f ./$$test.core; \
	done

do-unfdpass1: unfdpass
	${SUDO} ./unfdpass > output
	cmp -s ${.CURDIR}/expected output
#	${SUDO} ./unfdpass -f > output
#	cmp -s ${.CURDIR}/expectedfail output

.include <bsd.regress.mk>
@


1.1
log
@add check for pledge(pf), and pledge(pf) + fd passing
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.7 2016/04/25 19:30:10 tedu Exp $
a9 1
SUDO=			doas
@

