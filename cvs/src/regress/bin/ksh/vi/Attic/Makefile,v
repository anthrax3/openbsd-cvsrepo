head	1.3;
access;
symbols
	OPENBSD_6_1:1.2.0.4
	OPENBSD_6_1_BASE:1.2
	OPENBSD_6_0:1.1.0.4
	OPENBSD_6_0_BASE:1.1
	OPENBSD_5_9:1.1.0.2
	OPENBSD_5_9_BASE:1.1;
locks; strict;
comment	@# @;


1.3
date	2017.06.05.13.54.39;	author anton;	state dead;
branches;
next	1.2;
commitid	sBhoqMopGPfhiNEd;

1.2
date	2016.09.27.11.08.32;	author otto;	state Exp;
branches;
next	1.1;
commitid	Hd66R0WkEGibnkxb;

1.1
date	2016.01.12.09.00.39;	author schwarze;	state Exp;
branches;
next	;
commitid	u0ghwKJEyD1nxk41;


desc
@@


1.3
log
@Rewrite ksh edit mode regression tests.

Instead of calling x_vi() directly, run ksh in a pseudo tty.
This makes the process of adding tests for emacs mode simpler since the code can
be shared.

With feedback and help from millert@@ and schwarze@@
@
text
@# $OpenBSD: Makefile,v 1.2 2016/09/27 11:08:32 otto Exp $
#
# Author: Ingo Schwarze <schwarze@@openbsd.org>, 2016.  Public Domain.

REGRESS_TARGETS = check
PROG = test_vi
SRCS = vi.c test_vi.c
CPPFLAGS = -iquote ${.CURDIR}
CLEANFILES = vi.c

check test: test_vi
	sh ${.CURDIR}/vi.sh

vi.c: ${.CURDIR}/../../../../bin/ksh/vi.c
	cp ${.CURDIR}/../../../../bin/ksh/vi.c .

.include <bsd.regress.mk>
@


1.2
log
@fix dependency, fixing regress if make regress is called with a clean obj
(like the parent does).
When make is called in the parent dir, both make regress and make all
are called for the vi subdir. Need to figure out how to avoid that.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1 2016/01/12 09:00:39 schwarze Exp $
@


1.1
log
@The ksh(1) vi editing mode code is much harder to understand than
the emacs editing mode code, so add a testsuite before touching it.
To avoid having to deal with the horrendous low-level terminal
handling and high-level command execution code, write the tests in
unit test style rather than in integration test style, by providing
minimal glue to run vi.c stand-alone.  In case relevant internal
interfaces in sh.c, edit.c, and friends are changed, the glue may
need adjustment.
Not testing completion and history at this time, only line editing.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2013/12/02 20:39:44 millert Exp $
d11 1
a11 1
check test:
@

