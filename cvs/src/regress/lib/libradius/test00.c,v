head	1.1;
access;
symbols
	OPENBSD_6_2:1.1.0.8
	OPENBSD_6_2_BASE:1.1
	OPENBSD_6_1:1.1.0.10
	OPENBSD_6_1_BASE:1.1
	OPENBSD_6_0:1.1.0.6
	OPENBSD_6_0_BASE:1.1
	OPENBSD_5_9:1.1.0.2
	OPENBSD_5_9_BASE:1.1
	OPENBSD_5_8:1.1.0.4
	OPENBSD_5_8_BASE:1.1;
locks; strict;
comment	@ * @;


1.1
date	2015.07.20.23.52.29;	author yasuoka;	state Exp;
branches;
next	;
commitid	q7mg0LgasdXqIt1u;


desc
@@


1.1
log
@Add radius(3) library.  This will be used by RADIUS server and client
programs to manipulate RADIUS packets.  Mainly written by UMEZAWA
Takeshi.

fix and suggestion deraadt
ok deraadt
@
text
@#include "incs.h"

/*
 * basic header operation
 */

void test00(void)
{
	RADIUS_PACKET *packet;
	uint8_t code;
	uint8_t id;
	const uint8_t *pdata;
	uint8_t authenticator[16];

	code = random();
	id = random();
	packet = radius_new_request_packet(code);
	radius_set_id(packet, id);
	pdata = (const uint8_t *)radius_get_data(packet);
	CHECK(pdata[0] == code);
	CHECK(radius_get_code(packet) == code);
	CHECK(pdata[1] == id);
	CHECK(radius_get_id(packet) == id);
	CHECK(((pdata[2] << 8) | pdata[3]) == 20);
	CHECK(radius_get_length(packet) == 20);

	CHECK(radius_get_authenticator_retval(packet) == pdata + 4);
	radius_get_authenticator(packet, authenticator);
	CHECK(memcmp(authenticator, radius_get_authenticator_retval(packet), 16) == 0);
}

ADD_TEST(test00)
@
