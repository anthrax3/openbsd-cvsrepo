head	1.2;
access;
symbols
	OPENBSD_6_2:1.2.0.6
	OPENBSD_6_2_BASE:1.2
	OPENBSD_6_1:1.2.0.4
	OPENBSD_6_1_BASE:1.2;
locks; strict;
comment	@# @;


1.2
date	2016.09.10.07.26.30;	author landry;	state Exp;
branches;
next	1.1;
commitid	tFtqfMJJ6u0oZgIB;

1.1
date	2016.09.01.14.59.52;	author landry;	state Exp;
branches;
next	;
commitid	oylhQRvIFkmVfvOa;


desc
@@


1.2
log
@Cleanup commented lines, and only print the DN of entries
@
text
@#!/usr/bin/perl

use strict;
use warnings;
use 5.010;

use Net::LDAP;
use Net::LDAP::LDIF;
use Net::LDAP::Entry;
use Data::Dumper;

my $ldap;
my $base="dc=bar,dc=quux";
$base="dc=example,dc=com";

BEGIN {
        $ldap = Net::LDAP->new('ldapi://%2ftmp%2fldapi');
        my $mesg = $ldap->bind;
        $mesg->code && die $mesg->error;
}

END {
	$ldap->unbind;
}

        my $mesg = $ldap->search(base => $base, scope => "sub", filter => "(objectClass=inetOrgPerson)");
        $mesg->code && die $mesg->error;
        say $mesg->count." ldap entries";
        for (my $i=0 ; $i < $mesg->count ; $i++) {
                say $mesg->entry($i)->dn();
        }
@


1.1
log
@Add basic regress tests for ldapd.

- first pass of tests adding a DIT, then searching in it
- second pass of tests runs Net::LDAP regress suite against ldapd (not
  all tests are passing, and that requires Net::LDAP installed and
distfiles present on the system)
@
text
@a27 1
        # empty the ldap hash
d30 1
a30 3
                # store entry by mail
                say Dumper($mesg->entry($i));
                        #$log->debug("adding entry without mail for ".$entry->dn. " with modifyTimestamp = ".$entry->get_value('modifyTimestamp'));
@

