head	1.4;
access;
symbols
	OPENBSD_6_1:1.4.0.12
	OPENBSD_6_1_BASE:1.4
	OPENBSD_6_0:1.4.0.10
	OPENBSD_6_0_BASE:1.4
	OPENBSD_5_9:1.4.0.2
	OPENBSD_5_9_BASE:1.4
	OPENBSD_5_8:1.4.0.8
	OPENBSD_5_8_BASE:1.4
	OPENBSD_5_7:1.4.0.6
	OPENBSD_5_7_BASE:1.4
	OPENBSD_5_6:1.4.0.4
	OPENBSD_5_6_BASE:1.4
	OPENBSD_5_5:1.1.0.12
	OPENBSD_5_5_BASE:1.1
	OPENBSD_5_4:1.1.0.8
	OPENBSD_5_4_BASE:1.1
	OPENBSD_5_3:1.1.0.6
	OPENBSD_5_3_BASE:1.1
	OPENBSD_5_2:1.1.0.4
	OPENBSD_5_2_BASE:1.1
	OPENBSD_5_1_BASE:1.1
	OPENBSD_5_1:1.1.0.2;
locks; strict;
comment	@# @;


1.4
date	2014.07.14.00.14.43;	author bluhm;	state Exp;
branches;
next	1.3;
commitid	mEPzXsagGtO8U4PV;

1.3
date	2014.07.11.15.38.44;	author bluhm;	state Exp;
branches;
next	1.2;
commitid	4Fj6TMeFzFnCmKj8;

1.2
date	2014.07.09.16.48.55;	author reyk;	state Exp;
branches;
next	1.1;
commitid	tyiEIIip8IP7h6pK;

1.1
date	2011.09.02.21.05.41;	author bluhm;	state Exp;
branches;
next	;


desc
@@


1.4
log
@Now that the relayd timeouts have been fixed, make the http timeout
test more strict again.  Backout rev 1.2 of args-timeout-http.pl.
@
text
@# test that 3 seconds timeout occurs within 4 seconds idle in http

use strict;
use warnings;

our %args = (
    client => {
	func => \&http_client,
	len => 5,
	timefile => "",
    },
    relayd => {
	protocol => [ "http" ],
	relay => [ "session timeout 3" ],
    },
    server => {
	func => sub {
	    errignore();
	    http_server(@@_);
	    sleep 4;
	    write_char(@@_, 4);
	},
	sleep => 1,
	down => "Broken pipe",
	nocheck => 1,
    },
    len => 5,
);

1;
@


1.3
log
@Add a time.log file that accumulates timing information about the
executed tests.  This allows to micro benchmark relayd.
based on a diff from andre@@; OK reyk@@
@
text
@d20 2
a21 2
	    sleep 5;
	    write_char(@@_, 5);
@


1.2
log
@Update and extend the regress tests to use the new grammar of the
filtering rules.  Some of the filenames are based on the old grammar,
we keep them for now and just update the contents to have a
before/after comparison of the features.

Most of the work was done by Andre de Oliveira (andre@@)

OK bluhm@@ benno@@
@
text
@d10 1
@


1.1
log
@Add tests for relayd session timeout.
@
text
@d19 2
a20 2
	    sleep 4;
	    write_char(@@_, 4);
@

