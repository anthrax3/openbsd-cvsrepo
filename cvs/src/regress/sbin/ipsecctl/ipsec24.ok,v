head	1.2;
access;
symbols
	OPENBSD_6_2:1.2.0.40
	OPENBSD_6_2_BASE:1.2
	OPENBSD_6_1:1.2.0.38
	OPENBSD_6_1_BASE:1.2
	OPENBSD_6_0:1.2.0.34
	OPENBSD_6_0_BASE:1.2
	OPENBSD_5_9:1.2.0.24
	OPENBSD_5_9_BASE:1.2
	OPENBSD_5_8:1.2.0.32
	OPENBSD_5_8_BASE:1.2
	OPENBSD_5_7:1.2.0.30
	OPENBSD_5_7_BASE:1.2
	OPENBSD_5_6:1.2.0.28
	OPENBSD_5_6_BASE:1.2
	OPENBSD_5_5:1.2.0.26
	OPENBSD_5_5_BASE:1.2
	OPENBSD_5_4:1.2.0.22
	OPENBSD_5_4_BASE:1.2
	OPENBSD_5_3:1.2.0.20
	OPENBSD_5_3_BASE:1.2
	OPENBSD_5_2:1.2.0.18
	OPENBSD_5_2_BASE:1.2
	OPENBSD_5_1_BASE:1.2
	OPENBSD_5_1:1.2.0.16
	OPENBSD_5_0:1.2.0.14
	OPENBSD_5_0_BASE:1.2
	OPENBSD_4_9:1.2.0.12
	OPENBSD_4_9_BASE:1.2
	OPENBSD_4_8:1.2.0.10
	OPENBSD_4_8_BASE:1.2
	OPENBSD_4_7:1.2.0.6
	OPENBSD_4_7_BASE:1.2
	OPENBSD_4_6:1.2.0.8
	OPENBSD_4_6_BASE:1.2
	OPENBSD_4_5:1.2.0.4
	OPENBSD_4_5_BASE:1.2
	OPENBSD_4_4:1.2.0.2
	OPENBSD_4_4_BASE:1.2
	OPENBSD_4_3:1.1.0.8
	OPENBSD_4_3_BASE:1.1
	OPENBSD_4_2:1.1.0.6
	OPENBSD_4_2_BASE:1.1
	OPENBSD_4_1:1.1.0.4
	OPENBSD_4_1_BASE:1.1
	OPENBSD_4_0:1.1.0.2
	OPENBSD_4_0_BASE:1.1;
locks; strict;
comment	@# @;


1.2
date	2008.07.01.14.08.39;	author bluhm;	state Exp;
branches;
next	1.1;

1.1
date	2006.05.30.19.25.23;	author hshoexer;	state Exp;
branches;
next	;


desc
@@


1.2
log
@If multiple to addresses but no peer are given in an ike or flow
rule, the current to address is taken as peer during expansion.
This makes the broken regress test ikefail7 obsolete as address
family mismatch cannot happen anymore.
ok hshoexer
@
text
@FROM = "{ 1.1.1.1, 2.2.2.2, 3.3.3.3 }"
TO = "{ 4.4.4.4, 5.5.5.5, 6.6.6.6 }"
flow esp out from 1.1.1.1 to 4.4.4.4 peer 4.4.4.4 type require
flow esp in from 4.4.4.4 to 1.1.1.1 peer 4.4.4.4 type require
flow esp out from 1.1.1.1 to 5.5.5.5 peer 5.5.5.5 type require
flow esp in from 5.5.5.5 to 1.1.1.1 peer 5.5.5.5 type require
flow esp out from 1.1.1.1 to 6.6.6.6 peer 6.6.6.6 type require
flow esp in from 6.6.6.6 to 1.1.1.1 peer 6.6.6.6 type require
flow esp out from 2.2.2.2 to 4.4.4.4 peer 4.4.4.4 type require
flow esp in from 4.4.4.4 to 2.2.2.2 peer 4.4.4.4 type require
flow esp out from 2.2.2.2 to 5.5.5.5 peer 5.5.5.5 type require
flow esp in from 5.5.5.5 to 2.2.2.2 peer 5.5.5.5 type require
flow esp out from 2.2.2.2 to 6.6.6.6 peer 6.6.6.6 type require
flow esp in from 6.6.6.6 to 2.2.2.2 peer 6.6.6.6 type require
flow esp out from 3.3.3.3 to 4.4.4.4 peer 4.4.4.4 type require
flow esp in from 4.4.4.4 to 3.3.3.3 peer 4.4.4.4 type require
flow esp out from 3.3.3.3 to 5.5.5.5 peer 5.5.5.5 type require
flow esp in from 5.5.5.5 to 3.3.3.3 peer 5.5.5.5 type require
flow esp out from 3.3.3.3 to 6.6.6.6 peer 6.6.6.6 type require
flow esp in from 6.6.6.6 to 3.3.3.3 peer 6.6.6.6 type require
@


1.1
log
@tests for rule expansion
@
text
@d5 4
a8 4
flow esp out from 1.1.1.1 to 5.5.5.5 peer 4.4.4.4 type require
flow esp in from 5.5.5.5 to 1.1.1.1 peer 4.4.4.4 type require
flow esp out from 1.1.1.1 to 6.6.6.6 peer 4.4.4.4 type require
flow esp in from 6.6.6.6 to 1.1.1.1 peer 4.4.4.4 type require
d11 4
a14 4
flow esp out from 2.2.2.2 to 5.5.5.5 peer 4.4.4.4 type require
flow esp in from 5.5.5.5 to 2.2.2.2 peer 4.4.4.4 type require
flow esp out from 2.2.2.2 to 6.6.6.6 peer 4.4.4.4 type require
flow esp in from 6.6.6.6 to 2.2.2.2 peer 4.4.4.4 type require
d17 4
a20 4
flow esp out from 3.3.3.3 to 5.5.5.5 peer 4.4.4.4 type require
flow esp in from 5.5.5.5 to 3.3.3.3 peer 4.4.4.4 type require
flow esp out from 3.3.3.3 to 6.6.6.6 peer 4.4.4.4 type require
flow esp in from 6.6.6.6 to 3.3.3.3 peer 4.4.4.4 type require
@

