head	1.4;
access;
symbols
	OPENBSD_6_2:1.4.0.2
	OPENBSD_6_2_BASE:1.4
	OPENBSD_6_1:1.4.0.4
	OPENBSD_6_1_BASE:1.4
	OPENBSD_6_0:1.3.0.12
	OPENBSD_6_0_BASE:1.3
	OPENBSD_5_9:1.3.0.2
	OPENBSD_5_9_BASE:1.3
	OPENBSD_5_8:1.3.0.10
	OPENBSD_5_8_BASE:1.3
	OPENBSD_5_7:1.3.0.8
	OPENBSD_5_7_BASE:1.3
	OPENBSD_5_6:1.3.0.6
	OPENBSD_5_6_BASE:1.3
	OPENBSD_5_5:1.3.0.4
	OPENBSD_5_5_BASE:1.3
	OPENBSD_5_4:1.2.0.4
	OPENBSD_5_4_BASE:1.2
	OPENBSD_5_3:1.2.0.2
	OPENBSD_5_3_BASE:1.2
	OPENBSD_5_2:1.1.0.16
	OPENBSD_5_2_BASE:1.1
	OPENBSD_5_1_BASE:1.1
	OPENBSD_5_1:1.1.0.14
	OPENBSD_5_0:1.1.0.12
	OPENBSD_5_0_BASE:1.1
	OPENBSD_4_9:1.1.0.10
	OPENBSD_4_9_BASE:1.1
	OPENBSD_4_8:1.1.0.8
	OPENBSD_4_8_BASE:1.1
	OPENBSD_4_7:1.1.0.4
	OPENBSD_4_7_BASE:1.1
	OPENBSD_4_6:1.1.0.6
	OPENBSD_4_6_BASE:1.1
	OPENBSD_4_5:1.1.0.2
	OPENBSD_4_5_BASE:1.1;
locks; strict;
comment	@# @;


1.4
date	2016.09.02.10.58.24;	author mikeb;	state Exp;
branches;
next	1.3;
commitid	jqCbTLl2PBbT3NdL;

1.3
date	2013.08.25.23.26.47;	author mikeb;	state Exp;
branches;
next	1.2;

1.2
date	2012.09.15.13.18.34;	author markus;	state Exp;
branches;
next	1.1;

1.1
date	2009.01.30.14.24.52;	author bluhm;	state Exp;
branches;
next	;


desc
@@


1.4
log
@Adjust for the new default MODP group
@
text
@stdin: 10: default peer local mismatch
stdin: 10: default peer psk mismatch
stdin: 10: default peer phase 1 mode mismatch
stdin: 10: default peer srcid mismatch
stdin: 10: default peer dstid mismatch
stdin: 11: default peer local mismatch
stdin: 11: default peer phase 1 auth mismatch
stdin: 11: default peer srcid mismatch
stdin: 11: default peer dstid mismatch
C set [Phase 1]:Default=peer-default force
C set [peer-default]:Phase=1 force
C set [peer-default]:Local-address=1.1.1.1 force
C set [peer-default]:Authentication=secret force
C set [peer-default]:Configuration=phase1-peer-default force
C set [phase1-peer-default]:EXCHANGE_TYPE=ID_PROT force
C add [phase1-peer-default]:Transforms=phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_3072 force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_3072]:AUTHENTICATION_METHOD=PRE_SHARED force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_3072]:HASH_ALGORITHM=SHA force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_3072]:ENCRYPTION_ALGORITHM=AES_CBC force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_3072]:KEY_LENGTH=128,128:256 force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_3072]:GROUP_DESCRIPTION=MODP_3072 force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_3072]:Life=LIFE_MAIN_MODE force
C set [peer-default]:ID=id-src.id force
C set [id-src.id]:ID-type=FQDN force
C set [id-src.id]:Name=src.id force
C set [peer-default]:Remote-ID=id-dst.id force
C set [id-dst.id]:ID-type=FQDN force
C set [id-dst.id]:Name=dst.id force
C set [from-0.0.0.0/0-to-0.0.0.0/0]:Phase=2 force
C set [from-0.0.0.0/0-to-0.0.0.0/0]:ISAKMP-peer=peer-default force
C set [from-0.0.0.0/0-to-0.0.0.0/0]:Configuration=phase2-from-0.0.0.0/0-to-0.0.0.0/0 force
C set [from-0.0.0.0/0-to-0.0.0.0/0]:Local-ID=from-0.0.0.0/0 force
C set [from-0.0.0.0/0-to-0.0.0.0/0]:Remote-ID=to-0.0.0.0/0 force
C set [phase2-from-0.0.0.0/0-to-0.0.0.0/0]:EXCHANGE_TYPE=QUICK_MODE force
C set [phase2-from-0.0.0.0/0-to-0.0.0.0/0]:Suites=phase2-suite-from-0.0.0.0/0-to-0.0.0.0/0 force
C set [phase2-suite-from-0.0.0.0/0-to-0.0.0.0/0]:Protocols=phase2-protocol-from-0.0.0.0/0-to-0.0.0.0/0 force
C set [phase2-protocol-from-0.0.0.0/0-to-0.0.0.0/0]:PROTOCOL_ID=IPSEC_ESP force
C set [phase2-protocol-from-0.0.0.0/0-to-0.0.0.0/0]:Transforms=phase2-transform-from-0.0.0.0/0-to-0.0.0.0/0-AES128-SHA2_256-MODP_3072-TUNNEL force
C set [phase2-transform-from-0.0.0.0/0-to-0.0.0.0/0-AES128-SHA2_256-MODP_3072-TUNNEL]:TRANSFORM_ID=AES force
C set [phase2-transform-from-0.0.0.0/0-to-0.0.0.0/0-AES128-SHA2_256-MODP_3072-TUNNEL]:KEY_LENGTH=128,128:256 force
C set [phase2-transform-from-0.0.0.0/0-to-0.0.0.0/0-AES128-SHA2_256-MODP_3072-TUNNEL]:ENCAPSULATION_MODE=TUNNEL force
C set [phase2-transform-from-0.0.0.0/0-to-0.0.0.0/0-AES128-SHA2_256-MODP_3072-TUNNEL]:AUTHENTICATION_ALGORITHM=HMAC_SHA2_256 force
C set [phase2-transform-from-0.0.0.0/0-to-0.0.0.0/0-AES128-SHA2_256-MODP_3072-TUNNEL]:GROUP_DESCRIPTION=MODP_3072 force
C set [phase2-transform-from-0.0.0.0/0-to-0.0.0.0/0-AES128-SHA2_256-MODP_3072-TUNNEL]:Life=LIFE_QUICK_MODE force
C set [from-0.0.0.0/0]:ID-type=IPV4_ADDR_SUBNET force
C set [from-0.0.0.0/0]:Network=0.0.0.0 force
C set [from-0.0.0.0/0]:Netmask=0.0.0.0 force
C set [to-0.0.0.0/0]:ID-type=IPV4_ADDR_SUBNET force
C set [to-0.0.0.0/0]:Network=0.0.0.0 force
C set [to-0.0.0.0/0]:Netmask=0.0.0.0 force
C add [Phase 2]:Connections=from-0.0.0.0/0-to-0.0.0.0/0
C set [Phase 1]:Default=peer-default force
C set [peer-default]:Phase=1 force
C set [peer-default]:Local-address=1.1.1.1 force
C set [peer-default]:Authentication=secret force
C set [peer-default]:Configuration=phase1-peer-default force
C set [phase1-peer-default]:EXCHANGE_TYPE=ID_PROT force
C add [phase1-peer-default]:Transforms=phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_3072 force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_3072]:AUTHENTICATION_METHOD=PRE_SHARED force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_3072]:HASH_ALGORITHM=SHA force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_3072]:ENCRYPTION_ALGORITHM=AES_CBC force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_3072]:KEY_LENGTH=128,128:256 force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_3072]:GROUP_DESCRIPTION=MODP_3072 force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_3072]:Life=LIFE_MAIN_MODE force
C set [peer-default]:ID=id-src.id force
C set [id-src.id]:ID-type=FQDN force
C set [id-src.id]:Name=src.id force
C set [peer-default]:Remote-ID=id-dst.id force
C set [id-dst.id]:ID-type=FQDN force
C set [id-dst.id]:Name=dst.id force
C set [from-::/0-to-::/0]:Phase=2 force
C set [from-::/0-to-::/0]:ISAKMP-peer=peer-default force
C set [from-::/0-to-::/0]:Configuration=phase2-from-::/0-to-::/0 force
C set [from-::/0-to-::/0]:Local-ID=from-::/0 force
C set [from-::/0-to-::/0]:Remote-ID=to-::/0 force
C set [phase2-from-::/0-to-::/0]:EXCHANGE_TYPE=QUICK_MODE force
C set [phase2-from-::/0-to-::/0]:Suites=phase2-suite-from-::/0-to-::/0 force
C set [phase2-suite-from-::/0-to-::/0]:Protocols=phase2-protocol-from-::/0-to-::/0 force
C set [phase2-protocol-from-::/0-to-::/0]:PROTOCOL_ID=IPSEC_ESP force
C set [phase2-protocol-from-::/0-to-::/0]:Transforms=phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_3072-TUNNEL force
C set [phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_3072-TUNNEL]:TRANSFORM_ID=AES force
C set [phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_3072-TUNNEL]:KEY_LENGTH=128,128:256 force
C set [phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_3072-TUNNEL]:ENCAPSULATION_MODE=TUNNEL force
C set [phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_3072-TUNNEL]:AUTHENTICATION_ALGORITHM=HMAC_SHA2_256 force
C set [phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_3072-TUNNEL]:GROUP_DESCRIPTION=MODP_3072 force
C set [phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_3072-TUNNEL]:Life=LIFE_QUICK_MODE force
C set [from-::/0]:ID-type=IPV6_ADDR_SUBNET force
C set [from-::/0]:Network=:: force
C set [from-::/0]:Netmask=:: force
C set [to-::/0]:ID-type=IPV6_ADDR_SUBNET force
C set [to-::/0]:Network=:: force
C set [to-::/0]:Netmask=:: force
C add [Phase 2]:Connections=from-::/0-to-::/0
C set [Phase 1]:Default=peer-default force
C set [peer-default]:Phase=1 force
C set [peer-default]:Local-address=2.2.2.2 force
C set [peer-default]:Authentication=insecure force
C set [peer-default]:Configuration=phase1-peer-default force
C set [phase1-peer-default]:EXCHANGE_TYPE=AGGRESSIVE force
C add [phase1-peer-default]:Transforms=phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_3072 force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_3072]:AUTHENTICATION_METHOD=PRE_SHARED force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_3072]:HASH_ALGORITHM=SHA force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_3072]:ENCRYPTION_ALGORITHM=AES_CBC force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_3072]:KEY_LENGTH=128,128:256 force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_3072]:GROUP_DESCRIPTION=MODP_3072 force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_3072]:Life=LIFE_MAIN_MODE force
C set [peer-default]:ID=id-src.wrong force
C set [id-src.wrong]:ID-type=FQDN force
C set [id-src.wrong]:Name=src.wrong force
C set [peer-default]:Remote-ID=id-dst.wrong force
C set [id-dst.wrong]:ID-type=FQDN force
C set [id-dst.wrong]:Name=dst.wrong force
C set [from-::/0-to-::/0]:Phase=2 force
C set [from-::/0-to-::/0]:ISAKMP-peer=peer-default force
C set [from-::/0-to-::/0]:Configuration=phase2-from-::/0-to-::/0 force
C set [from-::/0-to-::/0]:Local-ID=from-::/0 force
C set [from-::/0-to-::/0]:Remote-ID=to-::/0 force
C set [phase2-from-::/0-to-::/0]:EXCHANGE_TYPE=QUICK_MODE force
C set [phase2-from-::/0-to-::/0]:Suites=phase2-suite-from-::/0-to-::/0 force
C set [phase2-suite-from-::/0-to-::/0]:Protocols=phase2-protocol-from-::/0-to-::/0 force
C set [phase2-protocol-from-::/0-to-::/0]:PROTOCOL_ID=IPSEC_ESP force
C set [phase2-protocol-from-::/0-to-::/0]:Transforms=phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_3072-TUNNEL force
C set [phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_3072-TUNNEL]:TRANSFORM_ID=AES force
C set [phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_3072-TUNNEL]:KEY_LENGTH=128,128:256 force
C set [phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_3072-TUNNEL]:ENCAPSULATION_MODE=TUNNEL force
C set [phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_3072-TUNNEL]:AUTHENTICATION_ALGORITHM=HMAC_SHA2_256 force
C set [phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_3072-TUNNEL]:GROUP_DESCRIPTION=MODP_3072 force
C set [phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_3072-TUNNEL]:Life=LIFE_QUICK_MODE force
C set [from-::/0]:ID-type=IPV6_ADDR_SUBNET force
C set [from-::/0]:Network=:: force
C set [from-::/0]:Netmask=:: force
C set [to-::/0]:ID-type=IPV6_ADDR_SUBNET force
C set [to-::/0]:Network=:: force
C set [to-::/0]:Netmask=:: force
C add [Phase 2]:Connections=from-::/0-to-::/0
C set [Phase 1]:Default=peer-default force
C set [peer-default]:Phase=1 force
C set [peer-default]:Configuration=phase1-peer-default force
C set [phase1-peer-default]:EXCHANGE_TYPE=ID_PROT force
C add [phase1-peer-default]:Transforms=phase1-transform-peer-default-RSA_SIG-SHA-AES128-MODP_3072 force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES128-MODP_3072]:AUTHENTICATION_METHOD=RSA_SIG force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES128-MODP_3072]:HASH_ALGORITHM=SHA force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES128-MODP_3072]:ENCRYPTION_ALGORITHM=AES_CBC force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES128-MODP_3072]:KEY_LENGTH=128,128:256 force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES128-MODP_3072]:GROUP_DESCRIPTION=MODP_3072 force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES128-MODP_3072]:Life=LIFE_MAIN_MODE force
C set [from-::/0-to-::/0]:Phase=2 force
C set [from-::/0-to-::/0]:ISAKMP-peer=peer-default force
C set [from-::/0-to-::/0]:Configuration=phase2-from-::/0-to-::/0 force
C set [from-::/0-to-::/0]:Local-ID=from-::/0 force
C set [from-::/0-to-::/0]:Remote-ID=to-::/0 force
C set [phase2-from-::/0-to-::/0]:EXCHANGE_TYPE=QUICK_MODE force
C set [phase2-from-::/0-to-::/0]:Suites=phase2-suite-from-::/0-to-::/0 force
C set [phase2-suite-from-::/0-to-::/0]:Protocols=phase2-protocol-from-::/0-to-::/0 force
C set [phase2-protocol-from-::/0-to-::/0]:PROTOCOL_ID=IPSEC_ESP force
C set [phase2-protocol-from-::/0-to-::/0]:Transforms=phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_3072-TUNNEL force
C set [phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_3072-TUNNEL]:TRANSFORM_ID=AES force
C set [phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_3072-TUNNEL]:KEY_LENGTH=128,128:256 force
C set [phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_3072-TUNNEL]:ENCAPSULATION_MODE=TUNNEL force
C set [phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_3072-TUNNEL]:AUTHENTICATION_ALGORITHM=HMAC_SHA2_256 force
C set [phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_3072-TUNNEL]:GROUP_DESCRIPTION=MODP_3072 force
C set [phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_3072-TUNNEL]:Life=LIFE_QUICK_MODE force
C set [from-::/0]:ID-type=IPV6_ADDR_SUBNET force
C set [from-::/0]:Network=:: force
C set [from-::/0]:Netmask=:: force
C set [to-::/0]:ID-type=IPV6_ADDR_SUBNET force
C set [to-::/0]:Network=:: force
C set [to-::/0]:Netmask=:: force
C add [Phase 2]:Connections=from-::/0-to-::/0
@


1.3
log
@transform names cannot have commas
@
text
@d16 7
a22 7
C add [phase1-peer-default]:Transforms=phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_1024 force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_1024]:AUTHENTICATION_METHOD=PRE_SHARED force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_1024]:HASH_ALGORITHM=SHA force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_1024]:ENCRYPTION_ALGORITHM=AES_CBC force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_1024]:KEY_LENGTH=128,128:256 force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_1024]:GROUP_DESCRIPTION=MODP_1024 force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_1024]:Life=LIFE_MAIN_MODE force
d38 7
a44 7
C set [phase2-protocol-from-0.0.0.0/0-to-0.0.0.0/0]:Transforms=phase2-transform-from-0.0.0.0/0-to-0.0.0.0/0-AES128-SHA2_256-MODP_1024-TUNNEL force
C set [phase2-transform-from-0.0.0.0/0-to-0.0.0.0/0-AES128-SHA2_256-MODP_1024-TUNNEL]:TRANSFORM_ID=AES force
C set [phase2-transform-from-0.0.0.0/0-to-0.0.0.0/0-AES128-SHA2_256-MODP_1024-TUNNEL]:KEY_LENGTH=128,128:256 force
C set [phase2-transform-from-0.0.0.0/0-to-0.0.0.0/0-AES128-SHA2_256-MODP_1024-TUNNEL]:ENCAPSULATION_MODE=TUNNEL force
C set [phase2-transform-from-0.0.0.0/0-to-0.0.0.0/0-AES128-SHA2_256-MODP_1024-TUNNEL]:AUTHENTICATION_ALGORITHM=HMAC_SHA2_256 force
C set [phase2-transform-from-0.0.0.0/0-to-0.0.0.0/0-AES128-SHA2_256-MODP_1024-TUNNEL]:GROUP_DESCRIPTION=MODP_1024 force
C set [phase2-transform-from-0.0.0.0/0-to-0.0.0.0/0-AES128-SHA2_256-MODP_1024-TUNNEL]:Life=LIFE_QUICK_MODE force
d58 7
a64 7
C add [phase1-peer-default]:Transforms=phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_1024 force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_1024]:AUTHENTICATION_METHOD=PRE_SHARED force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_1024]:HASH_ALGORITHM=SHA force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_1024]:ENCRYPTION_ALGORITHM=AES_CBC force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_1024]:KEY_LENGTH=128,128:256 force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_1024]:GROUP_DESCRIPTION=MODP_1024 force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_1024]:Life=LIFE_MAIN_MODE force
d80 7
a86 7
C set [phase2-protocol-from-::/0-to-::/0]:Transforms=phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_1024-TUNNEL force
C set [phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_1024-TUNNEL]:TRANSFORM_ID=AES force
C set [phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_1024-TUNNEL]:KEY_LENGTH=128,128:256 force
C set [phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_1024-TUNNEL]:ENCAPSULATION_MODE=TUNNEL force
C set [phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_1024-TUNNEL]:AUTHENTICATION_ALGORITHM=HMAC_SHA2_256 force
C set [phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_1024-TUNNEL]:GROUP_DESCRIPTION=MODP_1024 force
C set [phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_1024-TUNNEL]:Life=LIFE_QUICK_MODE force
d100 7
a106 7
C add [phase1-peer-default]:Transforms=phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_1024 force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_1024]:AUTHENTICATION_METHOD=PRE_SHARED force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_1024]:HASH_ALGORITHM=SHA force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_1024]:ENCRYPTION_ALGORITHM=AES_CBC force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_1024]:KEY_LENGTH=128,128:256 force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_1024]:GROUP_DESCRIPTION=MODP_1024 force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128-MODP_1024]:Life=LIFE_MAIN_MODE force
d122 7
a128 7
C set [phase2-protocol-from-::/0-to-::/0]:Transforms=phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_1024-TUNNEL force
C set [phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_1024-TUNNEL]:TRANSFORM_ID=AES force
C set [phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_1024-TUNNEL]:KEY_LENGTH=128,128:256 force
C set [phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_1024-TUNNEL]:ENCAPSULATION_MODE=TUNNEL force
C set [phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_1024-TUNNEL]:AUTHENTICATION_ALGORITHM=HMAC_SHA2_256 force
C set [phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_1024-TUNNEL]:GROUP_DESCRIPTION=MODP_1024 force
C set [phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_1024-TUNNEL]:Life=LIFE_QUICK_MODE force
d140 7
a146 7
C add [phase1-peer-default]:Transforms=phase1-transform-peer-default-RSA_SIG-SHA-AES128-MODP_1024 force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES128-MODP_1024]:AUTHENTICATION_METHOD=RSA_SIG force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES128-MODP_1024]:HASH_ALGORITHM=SHA force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES128-MODP_1024]:ENCRYPTION_ALGORITHM=AES_CBC force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES128-MODP_1024]:KEY_LENGTH=128,128:256 force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES128-MODP_1024]:GROUP_DESCRIPTION=MODP_1024 force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES128-MODP_1024]:Life=LIFE_MAIN_MODE force
d156 7
a162 7
C set [phase2-protocol-from-::/0-to-::/0]:Transforms=phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_1024-TUNNEL force
C set [phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_1024-TUNNEL]:TRANSFORM_ID=AES force
C set [phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_1024-TUNNEL]:KEY_LENGTH=128,128:256 force
C set [phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_1024-TUNNEL]:ENCAPSULATION_MODE=TUNNEL force
C set [phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_1024-TUNNEL]:AUTHENTICATION_ALGORITHM=HMAC_SHA2_256 force
C set [phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_1024-TUNNEL]:GROUP_DESCRIPTION=MODP_1024 force
C set [phase2-transform-from-::/0-to-::/0-AES128-SHA2_256-MODP_1024-TUNNEL]:Life=LIFE_QUICK_MODE force
@


1.2
log
@sync with recent ipsecctl changes/fixes
@
text
@d16 7
a22 7
C add [phase1-peer-default]:Transforms=phase1-transform-peer-default-PRE_SHARED-SHA-AES128,128:256-MODP_1024 force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128,128:256-MODP_1024]:AUTHENTICATION_METHOD=PRE_SHARED force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128,128:256-MODP_1024]:HASH_ALGORITHM=SHA force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128,128:256-MODP_1024]:ENCRYPTION_ALGORITHM=AES_CBC force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128,128:256-MODP_1024]:KEY_LENGTH=128,128:256 force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128,128:256-MODP_1024]:GROUP_DESCRIPTION=MODP_1024 force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128,128:256-MODP_1024]:Life=LIFE_MAIN_MODE force
d38 7
a44 7
C set [phase2-protocol-from-0.0.0.0/0-to-0.0.0.0/0]:Transforms=phase2-transform-from-0.0.0.0/0-to-0.0.0.0/0-AES128,128:256-SHA2_256-MODP_1024-TUNNEL force
C set [phase2-transform-from-0.0.0.0/0-to-0.0.0.0/0-AES128,128:256-SHA2_256-MODP_1024-TUNNEL]:TRANSFORM_ID=AES force
C set [phase2-transform-from-0.0.0.0/0-to-0.0.0.0/0-AES128,128:256-SHA2_256-MODP_1024-TUNNEL]:KEY_LENGTH=128,128:256 force
C set [phase2-transform-from-0.0.0.0/0-to-0.0.0.0/0-AES128,128:256-SHA2_256-MODP_1024-TUNNEL]:ENCAPSULATION_MODE=TUNNEL force
C set [phase2-transform-from-0.0.0.0/0-to-0.0.0.0/0-AES128,128:256-SHA2_256-MODP_1024-TUNNEL]:AUTHENTICATION_ALGORITHM=HMAC_SHA2_256 force
C set [phase2-transform-from-0.0.0.0/0-to-0.0.0.0/0-AES128,128:256-SHA2_256-MODP_1024-TUNNEL]:GROUP_DESCRIPTION=MODP_1024 force
C set [phase2-transform-from-0.0.0.0/0-to-0.0.0.0/0-AES128,128:256-SHA2_256-MODP_1024-TUNNEL]:Life=LIFE_QUICK_MODE force
d58 7
a64 7
C add [phase1-peer-default]:Transforms=phase1-transform-peer-default-PRE_SHARED-SHA-AES128,128:256-MODP_1024 force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128,128:256-MODP_1024]:AUTHENTICATION_METHOD=PRE_SHARED force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128,128:256-MODP_1024]:HASH_ALGORITHM=SHA force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128,128:256-MODP_1024]:ENCRYPTION_ALGORITHM=AES_CBC force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128,128:256-MODP_1024]:KEY_LENGTH=128,128:256 force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128,128:256-MODP_1024]:GROUP_DESCRIPTION=MODP_1024 force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128,128:256-MODP_1024]:Life=LIFE_MAIN_MODE force
d80 7
a86 7
C set [phase2-protocol-from-::/0-to-::/0]:Transforms=phase2-transform-from-::/0-to-::/0-AES128,128:256-SHA2_256-MODP_1024-TUNNEL force
C set [phase2-transform-from-::/0-to-::/0-AES128,128:256-SHA2_256-MODP_1024-TUNNEL]:TRANSFORM_ID=AES force
C set [phase2-transform-from-::/0-to-::/0-AES128,128:256-SHA2_256-MODP_1024-TUNNEL]:KEY_LENGTH=128,128:256 force
C set [phase2-transform-from-::/0-to-::/0-AES128,128:256-SHA2_256-MODP_1024-TUNNEL]:ENCAPSULATION_MODE=TUNNEL force
C set [phase2-transform-from-::/0-to-::/0-AES128,128:256-SHA2_256-MODP_1024-TUNNEL]:AUTHENTICATION_ALGORITHM=HMAC_SHA2_256 force
C set [phase2-transform-from-::/0-to-::/0-AES128,128:256-SHA2_256-MODP_1024-TUNNEL]:GROUP_DESCRIPTION=MODP_1024 force
C set [phase2-transform-from-::/0-to-::/0-AES128,128:256-SHA2_256-MODP_1024-TUNNEL]:Life=LIFE_QUICK_MODE force
d100 7
a106 7
C add [phase1-peer-default]:Transforms=phase1-transform-peer-default-PRE_SHARED-SHA-AES128,128:256-MODP_1024 force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128,128:256-MODP_1024]:AUTHENTICATION_METHOD=PRE_SHARED force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128,128:256-MODP_1024]:HASH_ALGORITHM=SHA force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128,128:256-MODP_1024]:ENCRYPTION_ALGORITHM=AES_CBC force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128,128:256-MODP_1024]:KEY_LENGTH=128,128:256 force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128,128:256-MODP_1024]:GROUP_DESCRIPTION=MODP_1024 force
C set [phase1-transform-peer-default-PRE_SHARED-SHA-AES128,128:256-MODP_1024]:Life=LIFE_MAIN_MODE force
d122 7
a128 7
C set [phase2-protocol-from-::/0-to-::/0]:Transforms=phase2-transform-from-::/0-to-::/0-AES128,128:256-SHA2_256-MODP_1024-TUNNEL force
C set [phase2-transform-from-::/0-to-::/0-AES128,128:256-SHA2_256-MODP_1024-TUNNEL]:TRANSFORM_ID=AES force
C set [phase2-transform-from-::/0-to-::/0-AES128,128:256-SHA2_256-MODP_1024-TUNNEL]:KEY_LENGTH=128,128:256 force
C set [phase2-transform-from-::/0-to-::/0-AES128,128:256-SHA2_256-MODP_1024-TUNNEL]:ENCAPSULATION_MODE=TUNNEL force
C set [phase2-transform-from-::/0-to-::/0-AES128,128:256-SHA2_256-MODP_1024-TUNNEL]:AUTHENTICATION_ALGORITHM=HMAC_SHA2_256 force
C set [phase2-transform-from-::/0-to-::/0-AES128,128:256-SHA2_256-MODP_1024-TUNNEL]:GROUP_DESCRIPTION=MODP_1024 force
C set [phase2-transform-from-::/0-to-::/0-AES128,128:256-SHA2_256-MODP_1024-TUNNEL]:Life=LIFE_QUICK_MODE force
d140 7
a146 7
C add [phase1-peer-default]:Transforms=phase1-transform-peer-default-RSA_SIG-SHA-AES128,128:256-MODP_1024 force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES128,128:256-MODP_1024]:AUTHENTICATION_METHOD=RSA_SIG force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES128,128:256-MODP_1024]:HASH_ALGORITHM=SHA force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES128,128:256-MODP_1024]:ENCRYPTION_ALGORITHM=AES_CBC force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES128,128:256-MODP_1024]:KEY_LENGTH=128,128:256 force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES128,128:256-MODP_1024]:GROUP_DESCRIPTION=MODP_1024 force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES128,128:256-MODP_1024]:Life=LIFE_MAIN_MODE force
d156 7
a162 7
C set [phase2-protocol-from-::/0-to-::/0]:Transforms=phase2-transform-from-::/0-to-::/0-AES128,128:256-SHA2_256-MODP_1024-TUNNEL force
C set [phase2-transform-from-::/0-to-::/0-AES128,128:256-SHA2_256-MODP_1024-TUNNEL]:TRANSFORM_ID=AES force
C set [phase2-transform-from-::/0-to-::/0-AES128,128:256-SHA2_256-MODP_1024-TUNNEL]:KEY_LENGTH=128,128:256 force
C set [phase2-transform-from-::/0-to-::/0-AES128,128:256-SHA2_256-MODP_1024-TUNNEL]:ENCAPSULATION_MODE=TUNNEL force
C set [phase2-transform-from-::/0-to-::/0-AES128,128:256-SHA2_256-MODP_1024-TUNNEL]:AUTHENTICATION_ALGORITHM=HMAC_SHA2_256 force
C set [phase2-transform-from-::/0-to-::/0-AES128,128:256-SHA2_256-MODP_1024-TUNNEL]:GROUP_DESCRIPTION=MODP_1024 force
C set [phase2-transform-from-::/0-to-::/0-AES128,128:256-SHA2_256-MODP_1024-TUNNEL]:Life=LIFE_QUICK_MODE force
@


1.1
log
@If the "peer" address is not specified or derived from "to" for
"ike" rules in ipsec.conf, the default peer is used.  In theory
ipsecctl -f ipsec.conf can configure the default peer for each "ike"
entry.  As isakmpd only supports one default peer, the last "ike"
rule that uses a default peer wins.  This configuration is then
significant for all "ike" rules that use the default peer.

Now a warning is printed if a later rule in ipsec.conf changes the
configuration of the original default peer.  This should be an error
but that would break existing user configs.  So only a warning is
printed.

ok hshoexer@@, todd@@
@
text
@d16 7
a22 1
C add [phase1-peer-default]:Transforms=AES-SHA force
d35 10
a44 1
C set [phase2-from-0.0.0.0/0-to-0.0.0.0/0]:Suites=QM-ESP-AES-SHA2-256-PFS-SUITE force
d58 7
a64 1
C add [phase1-peer-default]:Transforms=AES-SHA force
d77 10
a86 1
C set [phase2-from-::/0-to-::/0]:Suites=QM-ESP-AES-SHA2-256-PFS-SUITE force
d100 7
a106 1
C add [phase1-peer-default]:Transforms=AES-SHA force
d119 10
a128 1
C set [phase2-from-::/0-to-::/0]:Suites=QM-ESP-AES-SHA2-256-PFS-SUITE force
d140 7
a146 1
C add [phase1-peer-default]:Transforms=AES-SHA-RSA_SIG force
d153 10
a162 1
C set [phase2-from-::/0-to-::/0]:Suites=QM-ESP-AES-SHA2-256-PFS-SUITE force
@

