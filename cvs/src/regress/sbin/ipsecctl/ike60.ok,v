head	1.5;
access;
symbols
	OPENBSD_6_1:1.5.0.2
	OPENBSD_6_1_BASE:1.5
	OPENBSD_6_0:1.4.0.16
	OPENBSD_6_0_BASE:1.4
	OPENBSD_5_9:1.4.0.6
	OPENBSD_5_9_BASE:1.4
	OPENBSD_5_8:1.4.0.14
	OPENBSD_5_8_BASE:1.4
	OPENBSD_5_7:1.4.0.12
	OPENBSD_5_7_BASE:1.4
	OPENBSD_5_6:1.4.0.10
	OPENBSD_5_6_BASE:1.4
	OPENBSD_5_5:1.4.0.8
	OPENBSD_5_5_BASE:1.4
	OPENBSD_5_4:1.4.0.4
	OPENBSD_5_4_BASE:1.4
	OPENBSD_5_3:1.4.0.2
	OPENBSD_5_3_BASE:1.4
	OPENBSD_5_2:1.2.0.16
	OPENBSD_5_2_BASE:1.2
	OPENBSD_5_1_BASE:1.2
	OPENBSD_5_1:1.2.0.14
	OPENBSD_5_0:1.2.0.12
	OPENBSD_5_0_BASE:1.2
	OPENBSD_4_9:1.2.0.10
	OPENBSD_4_9_BASE:1.2
	OPENBSD_4_8:1.2.0.8
	OPENBSD_4_8_BASE:1.2
	OPENBSD_4_7:1.2.0.4
	OPENBSD_4_7_BASE:1.2
	OPENBSD_4_6:1.2.0.6
	OPENBSD_4_6_BASE:1.2
	OPENBSD_4_5:1.2.0.2
	OPENBSD_4_5_BASE:1.2;
locks; strict;
comment	@# @;


1.5
date	2016.09.02.10.58.24;	author mikeb;	state Exp;
branches;
next	1.4;
commitid	jqCbTLl2PBbT3NdL;

1.4
date	2012.09.17.20.40.49;	author markus;	state Exp;
branches;
next	1.3;

1.3
date	2012.09.15.13.18.34;	author markus;	state Exp;
branches;
next	1.2;

1.2
date	2009.01.19.13.44.36;	author hshoexer;	state Exp;
branches;
next	1.1;

1.1
date	2008.12.22.14.08.45;	author hshoexer;	state Exp;
branches;
next	;


desc
@@


1.5
log
@Adjust for the new default MODP group
@
text
@C set [Phase 1]:Default=peer-default force
C set [peer-default]:Phase=1 force
C set [peer-default]:Configuration=phase1-peer-default force
C set [phase1-peer-default]:EXCHANGE_TYPE=ID_PROT force
C add [phase1-peer-default]:Transforms=phase1-transform-peer-default-RSA_SIG-SHA-AES128-MODP_3072 force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES128-MODP_3072]:AUTHENTICATION_METHOD=RSA_SIG force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES128-MODP_3072]:HASH_ALGORITHM=SHA force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES128-MODP_3072]:ENCRYPTION_ALGORITHM=AES_CBC force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES128-MODP_3072]:KEY_LENGTH=128,128:128 force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES128-MODP_3072]:GROUP_DESCRIPTION=MODP_3072 force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES128-MODP_3072]:Life=LIFE_MAIN_MODE force
C set [from-10.0.0.1-to-0.0.0.0/0]:Phase=2 force
C set [from-10.0.0.1-to-0.0.0.0/0]:ISAKMP-peer=peer-default force
C set [from-10.0.0.1-to-0.0.0.0/0]:Configuration=phase2-from-10.0.0.1-to-0.0.0.0/0 force
C set [from-10.0.0.1-to-0.0.0.0/0]:Local-ID=from-10.0.0.1 force
C set [from-10.0.0.1-to-0.0.0.0/0]:Remote-ID=to-0.0.0.0/0 force
C set [phase2-from-10.0.0.1-to-0.0.0.0/0]:EXCHANGE_TYPE=QUICK_MODE force
C set [phase2-from-10.0.0.1-to-0.0.0.0/0]:Suites=phase2-suite-from-10.0.0.1-to-0.0.0.0/0 force
C set [phase2-suite-from-10.0.0.1-to-0.0.0.0/0]:Protocols=phase2-protocol-from-10.0.0.1-to-0.0.0.0/0 force
C set [phase2-protocol-from-10.0.0.1-to-0.0.0.0/0]:PROTOCOL_ID=IPSEC_ESP force
C set [phase2-protocol-from-10.0.0.1-to-0.0.0.0/0]:Transforms=phase2-transform-from-10.0.0.1-to-0.0.0.0/0-AES128-SHA2_256-MODP_3072-TUNNEL force
C set [phase2-transform-from-10.0.0.1-to-0.0.0.0/0-AES128-SHA2_256-MODP_3072-TUNNEL]:TRANSFORM_ID=AES force
C set [phase2-transform-from-10.0.0.1-to-0.0.0.0/0-AES128-SHA2_256-MODP_3072-TUNNEL]:KEY_LENGTH=128,128:128 force
C set [phase2-transform-from-10.0.0.1-to-0.0.0.0/0-AES128-SHA2_256-MODP_3072-TUNNEL]:ENCAPSULATION_MODE=TUNNEL force
C set [phase2-transform-from-10.0.0.1-to-0.0.0.0/0-AES128-SHA2_256-MODP_3072-TUNNEL]:AUTHENTICATION_ALGORITHM=HMAC_SHA2_256 force
C set [phase2-transform-from-10.0.0.1-to-0.0.0.0/0-AES128-SHA2_256-MODP_3072-TUNNEL]:GROUP_DESCRIPTION=MODP_3072 force
C set [phase2-transform-from-10.0.0.1-to-0.0.0.0/0-AES128-SHA2_256-MODP_3072-TUNNEL]:Life=LIFE_QUICK_MODE force
C set [from-10.0.0.1]:ID-type=IPV4_ADDR force
C set [from-10.0.0.1]:Address=10.0.0.1 force
C set [to-0.0.0.0/0]:ID-type=IPV4_ADDR_SUBNET force
C set [to-0.0.0.0/0]:Network=0.0.0.0 force
C set [to-0.0.0.0/0]:Netmask=0.0.0.0 force
C add [Phase 2]:Connections=from-10.0.0.1-to-0.0.0.0/0
C set [Phase 1]:Default=peer-default force
C set [peer-default]:Phase=1 force
C set [peer-default]:Configuration=phase1-peer-default force
C set [phase1-peer-default]:EXCHANGE_TYPE=ID_PROT force
C add [phase1-peer-default]:Transforms=phase1-transform-peer-default-RSA_SIG-SHA-AES192-MODP_3072 force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES192-MODP_3072]:AUTHENTICATION_METHOD=RSA_SIG force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES192-MODP_3072]:HASH_ALGORITHM=SHA force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES192-MODP_3072]:ENCRYPTION_ALGORITHM=AES_CBC force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES192-MODP_3072]:KEY_LENGTH=192,192:192 force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES192-MODP_3072]:GROUP_DESCRIPTION=MODP_3072 force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES192-MODP_3072]:Life=LIFE_MAIN_MODE force
C set [from-10.0.0.2-to-0.0.0.0/0]:Phase=2 force
C set [from-10.0.0.2-to-0.0.0.0/0]:ISAKMP-peer=peer-default force
C set [from-10.0.0.2-to-0.0.0.0/0]:Configuration=phase2-from-10.0.0.2-to-0.0.0.0/0 force
C set [from-10.0.0.2-to-0.0.0.0/0]:Local-ID=from-10.0.0.2 force
C set [from-10.0.0.2-to-0.0.0.0/0]:Remote-ID=to-0.0.0.0/0 force
C set [phase2-from-10.0.0.2-to-0.0.0.0/0]:EXCHANGE_TYPE=QUICK_MODE force
C set [phase2-from-10.0.0.2-to-0.0.0.0/0]:Suites=phase2-suite-from-10.0.0.2-to-0.0.0.0/0 force
C set [phase2-suite-from-10.0.0.2-to-0.0.0.0/0]:Protocols=phase2-protocol-from-10.0.0.2-to-0.0.0.0/0 force
C set [phase2-protocol-from-10.0.0.2-to-0.0.0.0/0]:PROTOCOL_ID=IPSEC_ESP force
C set [phase2-protocol-from-10.0.0.2-to-0.0.0.0/0]:Transforms=phase2-transform-from-10.0.0.2-to-0.0.0.0/0-AES192-SHA2_256-MODP_3072-TUNNEL force
C set [phase2-transform-from-10.0.0.2-to-0.0.0.0/0-AES192-SHA2_256-MODP_3072-TUNNEL]:TRANSFORM_ID=AES force
C set [phase2-transform-from-10.0.0.2-to-0.0.0.0/0-AES192-SHA2_256-MODP_3072-TUNNEL]:KEY_LENGTH=192,192:192 force
C set [phase2-transform-from-10.0.0.2-to-0.0.0.0/0-AES192-SHA2_256-MODP_3072-TUNNEL]:ENCAPSULATION_MODE=TUNNEL force
C set [phase2-transform-from-10.0.0.2-to-0.0.0.0/0-AES192-SHA2_256-MODP_3072-TUNNEL]:AUTHENTICATION_ALGORITHM=HMAC_SHA2_256 force
C set [phase2-transform-from-10.0.0.2-to-0.0.0.0/0-AES192-SHA2_256-MODP_3072-TUNNEL]:GROUP_DESCRIPTION=MODP_3072 force
C set [phase2-transform-from-10.0.0.2-to-0.0.0.0/0-AES192-SHA2_256-MODP_3072-TUNNEL]:Life=LIFE_QUICK_MODE force
C set [from-10.0.0.2]:ID-type=IPV4_ADDR force
C set [from-10.0.0.2]:Address=10.0.0.2 force
C set [to-0.0.0.0/0]:ID-type=IPV4_ADDR_SUBNET force
C set [to-0.0.0.0/0]:Network=0.0.0.0 force
C set [to-0.0.0.0/0]:Netmask=0.0.0.0 force
C add [Phase 2]:Connections=from-10.0.0.2-to-0.0.0.0/0
C set [Phase 1]:Default=peer-default force
C set [peer-default]:Phase=1 force
C set [peer-default]:Configuration=phase1-peer-default force
C set [phase1-peer-default]:EXCHANGE_TYPE=ID_PROT force
C add [phase1-peer-default]:Transforms=phase1-transform-peer-default-RSA_SIG-SHA-AES256-MODP_3072 force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES256-MODP_3072]:AUTHENTICATION_METHOD=RSA_SIG force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES256-MODP_3072]:HASH_ALGORITHM=SHA force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES256-MODP_3072]:ENCRYPTION_ALGORITHM=AES_CBC force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES256-MODP_3072]:KEY_LENGTH=256,256:256 force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES256-MODP_3072]:GROUP_DESCRIPTION=MODP_3072 force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES256-MODP_3072]:Life=LIFE_MAIN_MODE force
C set [from-10.0.0.3-to-0.0.0.0/0]:Phase=2 force
C set [from-10.0.0.3-to-0.0.0.0/0]:ISAKMP-peer=peer-default force
C set [from-10.0.0.3-to-0.0.0.0/0]:Configuration=phase2-from-10.0.0.3-to-0.0.0.0/0 force
C set [from-10.0.0.3-to-0.0.0.0/0]:Local-ID=from-10.0.0.3 force
C set [from-10.0.0.3-to-0.0.0.0/0]:Remote-ID=to-0.0.0.0/0 force
C set [phase2-from-10.0.0.3-to-0.0.0.0/0]:EXCHANGE_TYPE=QUICK_MODE force
C set [phase2-from-10.0.0.3-to-0.0.0.0/0]:Suites=phase2-suite-from-10.0.0.3-to-0.0.0.0/0 force
C set [phase2-suite-from-10.0.0.3-to-0.0.0.0/0]:Protocols=phase2-protocol-from-10.0.0.3-to-0.0.0.0/0 force
C set [phase2-protocol-from-10.0.0.3-to-0.0.0.0/0]:PROTOCOL_ID=IPSEC_ESP force
C set [phase2-protocol-from-10.0.0.3-to-0.0.0.0/0]:Transforms=phase2-transform-from-10.0.0.3-to-0.0.0.0/0-AES256-SHA2_256-MODP_3072-TUNNEL force
C set [phase2-transform-from-10.0.0.3-to-0.0.0.0/0-AES256-SHA2_256-MODP_3072-TUNNEL]:TRANSFORM_ID=AES force
C set [phase2-transform-from-10.0.0.3-to-0.0.0.0/0-AES256-SHA2_256-MODP_3072-TUNNEL]:KEY_LENGTH=256,256:256 force
C set [phase2-transform-from-10.0.0.3-to-0.0.0.0/0-AES256-SHA2_256-MODP_3072-TUNNEL]:ENCAPSULATION_MODE=TUNNEL force
C set [phase2-transform-from-10.0.0.3-to-0.0.0.0/0-AES256-SHA2_256-MODP_3072-TUNNEL]:AUTHENTICATION_ALGORITHM=HMAC_SHA2_256 force
C set [phase2-transform-from-10.0.0.3-to-0.0.0.0/0-AES256-SHA2_256-MODP_3072-TUNNEL]:GROUP_DESCRIPTION=MODP_3072 force
C set [phase2-transform-from-10.0.0.3-to-0.0.0.0/0-AES256-SHA2_256-MODP_3072-TUNNEL]:Life=LIFE_QUICK_MODE force
C set [from-10.0.0.3]:ID-type=IPV4_ADDR force
C set [from-10.0.0.3]:Address=10.0.0.3 force
C set [to-0.0.0.0/0]:ID-type=IPV4_ADDR_SUBNET force
C set [to-0.0.0.0/0]:Network=0.0.0.0 force
C set [to-0.0.0.0/0]:Netmask=0.0.0.0 force
C add [Phase 2]:Connections=from-10.0.0.3-to-0.0.0.0/0
@


1.4
log
@sync with transform-name-fix
@
text
@d5 7
a11 7
C add [phase1-peer-default]:Transforms=phase1-transform-peer-default-RSA_SIG-SHA-AES128-MODP_1024 force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES128-MODP_1024]:AUTHENTICATION_METHOD=RSA_SIG force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES128-MODP_1024]:HASH_ALGORITHM=SHA force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES128-MODP_1024]:ENCRYPTION_ALGORITHM=AES_CBC force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES128-MODP_1024]:KEY_LENGTH=128,128:128 force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES128-MODP_1024]:GROUP_DESCRIPTION=MODP_1024 force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES128-MODP_1024]:Life=LIFE_MAIN_MODE force
d21 7
a27 7
C set [phase2-protocol-from-10.0.0.1-to-0.0.0.0/0]:Transforms=phase2-transform-from-10.0.0.1-to-0.0.0.0/0-AES128-SHA2_256-MODP_1024-TUNNEL force
C set [phase2-transform-from-10.0.0.1-to-0.0.0.0/0-AES128-SHA2_256-MODP_1024-TUNNEL]:TRANSFORM_ID=AES force
C set [phase2-transform-from-10.0.0.1-to-0.0.0.0/0-AES128-SHA2_256-MODP_1024-TUNNEL]:KEY_LENGTH=128,128:128 force
C set [phase2-transform-from-10.0.0.1-to-0.0.0.0/0-AES128-SHA2_256-MODP_1024-TUNNEL]:ENCAPSULATION_MODE=TUNNEL force
C set [phase2-transform-from-10.0.0.1-to-0.0.0.0/0-AES128-SHA2_256-MODP_1024-TUNNEL]:AUTHENTICATION_ALGORITHM=HMAC_SHA2_256 force
C set [phase2-transform-from-10.0.0.1-to-0.0.0.0/0-AES128-SHA2_256-MODP_1024-TUNNEL]:GROUP_DESCRIPTION=MODP_1024 force
C set [phase2-transform-from-10.0.0.1-to-0.0.0.0/0-AES128-SHA2_256-MODP_1024-TUNNEL]:Life=LIFE_QUICK_MODE force
d38 7
a44 7
C add [phase1-peer-default]:Transforms=phase1-transform-peer-default-RSA_SIG-SHA-AES192-MODP_1024 force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES192-MODP_1024]:AUTHENTICATION_METHOD=RSA_SIG force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES192-MODP_1024]:HASH_ALGORITHM=SHA force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES192-MODP_1024]:ENCRYPTION_ALGORITHM=AES_CBC force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES192-MODP_1024]:KEY_LENGTH=192,192:192 force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES192-MODP_1024]:GROUP_DESCRIPTION=MODP_1024 force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES192-MODP_1024]:Life=LIFE_MAIN_MODE force
d54 7
a60 7
C set [phase2-protocol-from-10.0.0.2-to-0.0.0.0/0]:Transforms=phase2-transform-from-10.0.0.2-to-0.0.0.0/0-AES192-SHA2_256-MODP_1024-TUNNEL force
C set [phase2-transform-from-10.0.0.2-to-0.0.0.0/0-AES192-SHA2_256-MODP_1024-TUNNEL]:TRANSFORM_ID=AES force
C set [phase2-transform-from-10.0.0.2-to-0.0.0.0/0-AES192-SHA2_256-MODP_1024-TUNNEL]:KEY_LENGTH=192,192:192 force
C set [phase2-transform-from-10.0.0.2-to-0.0.0.0/0-AES192-SHA2_256-MODP_1024-TUNNEL]:ENCAPSULATION_MODE=TUNNEL force
C set [phase2-transform-from-10.0.0.2-to-0.0.0.0/0-AES192-SHA2_256-MODP_1024-TUNNEL]:AUTHENTICATION_ALGORITHM=HMAC_SHA2_256 force
C set [phase2-transform-from-10.0.0.2-to-0.0.0.0/0-AES192-SHA2_256-MODP_1024-TUNNEL]:GROUP_DESCRIPTION=MODP_1024 force
C set [phase2-transform-from-10.0.0.2-to-0.0.0.0/0-AES192-SHA2_256-MODP_1024-TUNNEL]:Life=LIFE_QUICK_MODE force
d71 7
a77 7
C add [phase1-peer-default]:Transforms=phase1-transform-peer-default-RSA_SIG-SHA-AES256-MODP_1024 force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES256-MODP_1024]:AUTHENTICATION_METHOD=RSA_SIG force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES256-MODP_1024]:HASH_ALGORITHM=SHA force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES256-MODP_1024]:ENCRYPTION_ALGORITHM=AES_CBC force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES256-MODP_1024]:KEY_LENGTH=256,256:256 force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES256-MODP_1024]:GROUP_DESCRIPTION=MODP_1024 force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES256-MODP_1024]:Life=LIFE_MAIN_MODE force
d87 7
a93 7
C set [phase2-protocol-from-10.0.0.3-to-0.0.0.0/0]:Transforms=phase2-transform-from-10.0.0.3-to-0.0.0.0/0-AES256-SHA2_256-MODP_1024-TUNNEL force
C set [phase2-transform-from-10.0.0.3-to-0.0.0.0/0-AES256-SHA2_256-MODP_1024-TUNNEL]:TRANSFORM_ID=AES force
C set [phase2-transform-from-10.0.0.3-to-0.0.0.0/0-AES256-SHA2_256-MODP_1024-TUNNEL]:KEY_LENGTH=256,256:256 force
C set [phase2-transform-from-10.0.0.3-to-0.0.0.0/0-AES256-SHA2_256-MODP_1024-TUNNEL]:ENCAPSULATION_MODE=TUNNEL force
C set [phase2-transform-from-10.0.0.3-to-0.0.0.0/0-AES256-SHA2_256-MODP_1024-TUNNEL]:AUTHENTICATION_ALGORITHM=HMAC_SHA2_256 force
C set [phase2-transform-from-10.0.0.3-to-0.0.0.0/0-AES256-SHA2_256-MODP_1024-TUNNEL]:GROUP_DESCRIPTION=MODP_1024 force
C set [phase2-transform-from-10.0.0.3-to-0.0.0.0/0-AES256-SHA2_256-MODP_1024-TUNNEL]:Life=LIFE_QUICK_MODE force
@


1.3
log
@sync with recent ipsecctl changes/fixes
@
text
@d5 7
a11 7
C add [phase1-peer-default]:Transforms=phase1-transform-peer-default-RSA_SIG-SHA-AES128,128:128-MODP_1024 force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES128,128:128-MODP_1024]:AUTHENTICATION_METHOD=RSA_SIG force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES128,128:128-MODP_1024]:HASH_ALGORITHM=SHA force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES128,128:128-MODP_1024]:ENCRYPTION_ALGORITHM=AES_CBC force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES128,128:128-MODP_1024]:KEY_LENGTH=128,128:128 force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES128,128:128-MODP_1024]:GROUP_DESCRIPTION=MODP_1024 force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES128,128:128-MODP_1024]:Life=LIFE_MAIN_MODE force
d21 7
a27 7
C set [phase2-protocol-from-10.0.0.1-to-0.0.0.0/0]:Transforms=phase2-transform-from-10.0.0.1-to-0.0.0.0/0-AES128,128:128-SHA2_256-MODP_1024-TUNNEL force
C set [phase2-transform-from-10.0.0.1-to-0.0.0.0/0-AES128,128:128-SHA2_256-MODP_1024-TUNNEL]:TRANSFORM_ID=AES force
C set [phase2-transform-from-10.0.0.1-to-0.0.0.0/0-AES128,128:128-SHA2_256-MODP_1024-TUNNEL]:KEY_LENGTH=128,128:128 force
C set [phase2-transform-from-10.0.0.1-to-0.0.0.0/0-AES128,128:128-SHA2_256-MODP_1024-TUNNEL]:ENCAPSULATION_MODE=TUNNEL force
C set [phase2-transform-from-10.0.0.1-to-0.0.0.0/0-AES128,128:128-SHA2_256-MODP_1024-TUNNEL]:AUTHENTICATION_ALGORITHM=HMAC_SHA2_256 force
C set [phase2-transform-from-10.0.0.1-to-0.0.0.0/0-AES128,128:128-SHA2_256-MODP_1024-TUNNEL]:GROUP_DESCRIPTION=MODP_1024 force
C set [phase2-transform-from-10.0.0.1-to-0.0.0.0/0-AES128,128:128-SHA2_256-MODP_1024-TUNNEL]:Life=LIFE_QUICK_MODE force
d38 7
a44 7
C add [phase1-peer-default]:Transforms=phase1-transform-peer-default-RSA_SIG-SHA-AES192,192:192-MODP_1024 force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES192,192:192-MODP_1024]:AUTHENTICATION_METHOD=RSA_SIG force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES192,192:192-MODP_1024]:HASH_ALGORITHM=SHA force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES192,192:192-MODP_1024]:ENCRYPTION_ALGORITHM=AES_CBC force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES192,192:192-MODP_1024]:KEY_LENGTH=192,192:192 force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES192,192:192-MODP_1024]:GROUP_DESCRIPTION=MODP_1024 force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES192,192:192-MODP_1024]:Life=LIFE_MAIN_MODE force
d54 7
a60 7
C set [phase2-protocol-from-10.0.0.2-to-0.0.0.0/0]:Transforms=phase2-transform-from-10.0.0.2-to-0.0.0.0/0-AES192,192:192-SHA2_256-MODP_1024-TUNNEL force
C set [phase2-transform-from-10.0.0.2-to-0.0.0.0/0-AES192,192:192-SHA2_256-MODP_1024-TUNNEL]:TRANSFORM_ID=AES force
C set [phase2-transform-from-10.0.0.2-to-0.0.0.0/0-AES192,192:192-SHA2_256-MODP_1024-TUNNEL]:KEY_LENGTH=192,192:192 force
C set [phase2-transform-from-10.0.0.2-to-0.0.0.0/0-AES192,192:192-SHA2_256-MODP_1024-TUNNEL]:ENCAPSULATION_MODE=TUNNEL force
C set [phase2-transform-from-10.0.0.2-to-0.0.0.0/0-AES192,192:192-SHA2_256-MODP_1024-TUNNEL]:AUTHENTICATION_ALGORITHM=HMAC_SHA2_256 force
C set [phase2-transform-from-10.0.0.2-to-0.0.0.0/0-AES192,192:192-SHA2_256-MODP_1024-TUNNEL]:GROUP_DESCRIPTION=MODP_1024 force
C set [phase2-transform-from-10.0.0.2-to-0.0.0.0/0-AES192,192:192-SHA2_256-MODP_1024-TUNNEL]:Life=LIFE_QUICK_MODE force
d71 7
a77 7
C add [phase1-peer-default]:Transforms=phase1-transform-peer-default-RSA_SIG-SHA-AES256,256:256-MODP_1024 force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES256,256:256-MODP_1024]:AUTHENTICATION_METHOD=RSA_SIG force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES256,256:256-MODP_1024]:HASH_ALGORITHM=SHA force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES256,256:256-MODP_1024]:ENCRYPTION_ALGORITHM=AES_CBC force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES256,256:256-MODP_1024]:KEY_LENGTH=256,256:256 force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES256,256:256-MODP_1024]:GROUP_DESCRIPTION=MODP_1024 force
C set [phase1-transform-peer-default-RSA_SIG-SHA-AES256,256:256-MODP_1024]:Life=LIFE_MAIN_MODE force
d87 7
a93 7
C set [phase2-protocol-from-10.0.0.3-to-0.0.0.0/0]:Transforms=phase2-transform-from-10.0.0.3-to-0.0.0.0/0-AES256,256:256-SHA2_256-MODP_1024-TUNNEL force
C set [phase2-transform-from-10.0.0.3-to-0.0.0.0/0-AES256,256:256-SHA2_256-MODP_1024-TUNNEL]:TRANSFORM_ID=AES force
C set [phase2-transform-from-10.0.0.3-to-0.0.0.0/0-AES256,256:256-SHA2_256-MODP_1024-TUNNEL]:KEY_LENGTH=256,256:256 force
C set [phase2-transform-from-10.0.0.3-to-0.0.0.0/0-AES256,256:256-SHA2_256-MODP_1024-TUNNEL]:ENCAPSULATION_MODE=TUNNEL force
C set [phase2-transform-from-10.0.0.3-to-0.0.0.0/0-AES256,256:256-SHA2_256-MODP_1024-TUNNEL]:AUTHENTICATION_ALGORITHM=HMAC_SHA2_256 force
C set [phase2-transform-from-10.0.0.3-to-0.0.0.0/0-AES256,256:256-SHA2_256-MODP_1024-TUNNEL]:GROUP_DESCRIPTION=MODP_1024 force
C set [phase2-transform-from-10.0.0.3-to-0.0.0.0/0-AES256,256:256-SHA2_256-MODP_1024-TUNNEL]:Life=LIFE_QUICK_MODE force
@


1.2
log
@Do not use "egress" keyword as it expands to an actual interface,
which might be different on different machines.  Use some fixed
addresses instead.

pointed out and ok david@@
@
text
@d5 7
a11 1
C add [phase1-peer-default]:Transforms=AES-128-SHA-RSA_SIG force
d18 10
a27 1
C set [phase2-from-10.0.0.1-to-0.0.0.0/0]:Suites=QM-ESP-AES-128-SHA2-256-PFS-SUITE force
d38 7
a44 1
C add [phase1-peer-default]:Transforms=AES-192-SHA-RSA_SIG force
d51 10
a60 1
C set [phase2-from-10.0.0.2-to-0.0.0.0/0]:Suites=QM-ESP-AES-192-SHA2-256-PFS-SUITE force
d71 7
a77 1
C add [phase1-peer-default]:Transforms=AES-256-SHA-RSA_SIG force
d84 10
a93 1
C set [phase2-from-10.0.0.3-to-0.0.0.0/0]:Suites=QM-ESP-AES-256-SHA2-256-PFS-SUITE force
@


1.1
log
@add regression test for aes-{128,192,256} being used with main and quick
mode.
@
text
@d6 9
a14 9
C set [from-sk0-to-0.0.0.0/0]:Phase=2 force
C set [from-sk0-to-0.0.0.0/0]:ISAKMP-peer=peer-default force
C set [from-sk0-to-0.0.0.0/0]:Configuration=phase2-from-sk0-to-0.0.0.0/0 force
C set [from-sk0-to-0.0.0.0/0]:Local-ID=from-sk0 force
C set [from-sk0-to-0.0.0.0/0]:Remote-ID=to-0.0.0.0/0 force
C set [phase2-from-sk0-to-0.0.0.0/0]:EXCHANGE_TYPE=QUICK_MODE force
C set [phase2-from-sk0-to-0.0.0.0/0]:Suites=QM-ESP-AES-128-SHA2-256-PFS-SUITE force
C set [from-sk0]:ID-type=IPV4_ADDR force
C set [from-sk0]:Address=sk0 force
d18 1
a18 19
C add [Phase 2]:Connections=from-sk0-to-0.0.0.0/0
C set [Phase 1]:Default=peer-default force
C set [peer-default]:Phase=1 force
C set [peer-default]:Configuration=phase1-peer-default force
C set [phase1-peer-default]:EXCHANGE_TYPE=ID_PROT force
C add [phase1-peer-default]:Transforms=AES-128-SHA-RSA_SIG force
C set [from-sk0-to-0.0.0.0/0]:Phase=2 force
C set [from-sk0-to-0.0.0.0/0]:ISAKMP-peer=peer-default force
C set [from-sk0-to-0.0.0.0/0]:Configuration=phase2-from-sk0-to-0.0.0.0/0 force
C set [from-sk0-to-0.0.0.0/0]:Local-ID=from-sk0 force
C set [from-sk0-to-0.0.0.0/0]:Remote-ID=to-0.0.0.0/0 force
C set [phase2-from-sk0-to-0.0.0.0/0]:EXCHANGE_TYPE=QUICK_MODE force
C set [phase2-from-sk0-to-0.0.0.0/0]:Suites=QM-ESP-AES-128-SHA2-256-PFS-SUITE force
C set [from-sk0]:ID-type=IPV4_ADDR force
C set [from-sk0]:Address=sk0 force
C set [to-0.0.0.0/0]:ID-type=IPV4_ADDR_SUBNET force
C set [to-0.0.0.0/0]:Network=0.0.0.0 force
C set [to-0.0.0.0/0]:Netmask=0.0.0.0 force
C add [Phase 2]:Connections=from-sk0-to-0.0.0.0/0
d24 9
a32 45
C set [from-sk0-to-0.0.0.0/0]:Phase=2 force
C set [from-sk0-to-0.0.0.0/0]:ISAKMP-peer=peer-default force
C set [from-sk0-to-0.0.0.0/0]:Configuration=phase2-from-sk0-to-0.0.0.0/0 force
C set [from-sk0-to-0.0.0.0/0]:Local-ID=from-sk0 force
C set [from-sk0-to-0.0.0.0/0]:Remote-ID=to-0.0.0.0/0 force
C set [phase2-from-sk0-to-0.0.0.0/0]:EXCHANGE_TYPE=QUICK_MODE force
C set [phase2-from-sk0-to-0.0.0.0/0]:Suites=QM-ESP-AES-192-SHA2-256-PFS-SUITE force
C set [from-sk0]:ID-type=IPV4_ADDR force
C set [from-sk0]:Address=sk0 force
C set [to-0.0.0.0/0]:ID-type=IPV4_ADDR_SUBNET force
C set [to-0.0.0.0/0]:Network=0.0.0.0 force
C set [to-0.0.0.0/0]:Netmask=0.0.0.0 force
C add [Phase 2]:Connections=from-sk0-to-0.0.0.0/0
C set [Phase 1]:Default=peer-default force
C set [peer-default]:Phase=1 force
C set [peer-default]:Configuration=phase1-peer-default force
C set [phase1-peer-default]:EXCHANGE_TYPE=ID_PROT force
C add [phase1-peer-default]:Transforms=AES-192-SHA-RSA_SIG force
C set [from-sk0-to-0.0.0.0/0]:Phase=2 force
C set [from-sk0-to-0.0.0.0/0]:ISAKMP-peer=peer-default force
C set [from-sk0-to-0.0.0.0/0]:Configuration=phase2-from-sk0-to-0.0.0.0/0 force
C set [from-sk0-to-0.0.0.0/0]:Local-ID=from-sk0 force
C set [from-sk0-to-0.0.0.0/0]:Remote-ID=to-0.0.0.0/0 force
C set [phase2-from-sk0-to-0.0.0.0/0]:EXCHANGE_TYPE=QUICK_MODE force
C set [phase2-from-sk0-to-0.0.0.0/0]:Suites=QM-ESP-AES-192-SHA2-256-PFS-SUITE force
C set [from-sk0]:ID-type=IPV4_ADDR force
C set [from-sk0]:Address=sk0 force
C set [to-0.0.0.0/0]:ID-type=IPV4_ADDR_SUBNET force
C set [to-0.0.0.0/0]:Network=0.0.0.0 force
C set [to-0.0.0.0/0]:Netmask=0.0.0.0 force
C add [Phase 2]:Connections=from-sk0-to-0.0.0.0/0
C set [Phase 1]:Default=peer-default force
C set [peer-default]:Phase=1 force
C set [peer-default]:Configuration=phase1-peer-default force
C set [phase1-peer-default]:EXCHANGE_TYPE=ID_PROT force
C add [phase1-peer-default]:Transforms=AES-256-SHA-RSA_SIG force
C set [from-sk0-to-0.0.0.0/0]:Phase=2 force
C set [from-sk0-to-0.0.0.0/0]:ISAKMP-peer=peer-default force
C set [from-sk0-to-0.0.0.0/0]:Configuration=phase2-from-sk0-to-0.0.0.0/0 force
C set [from-sk0-to-0.0.0.0/0]:Local-ID=from-sk0 force
C set [from-sk0-to-0.0.0.0/0]:Remote-ID=to-0.0.0.0/0 force
C set [phase2-from-sk0-to-0.0.0.0/0]:EXCHANGE_TYPE=QUICK_MODE force
C set [phase2-from-sk0-to-0.0.0.0/0]:Suites=QM-ESP-AES-256-SHA2-256-PFS-SUITE force
C set [from-sk0]:ID-type=IPV4_ADDR force
C set [from-sk0]:Address=sk0 force
d36 1
a36 1
C add [Phase 2]:Connections=from-sk0-to-0.0.0.0/0
d42 9
a50 9
C set [from-sk0-to-0.0.0.0/0]:Phase=2 force
C set [from-sk0-to-0.0.0.0/0]:ISAKMP-peer=peer-default force
C set [from-sk0-to-0.0.0.0/0]:Configuration=phase2-from-sk0-to-0.0.0.0/0 force
C set [from-sk0-to-0.0.0.0/0]:Local-ID=from-sk0 force
C set [from-sk0-to-0.0.0.0/0]:Remote-ID=to-0.0.0.0/0 force
C set [phase2-from-sk0-to-0.0.0.0/0]:EXCHANGE_TYPE=QUICK_MODE force
C set [phase2-from-sk0-to-0.0.0.0/0]:Suites=QM-ESP-AES-256-SHA2-256-PFS-SUITE force
C set [from-sk0]:ID-type=IPV4_ADDR force
C set [from-sk0]:Address=sk0 force
d54 1
a54 1
C add [Phase 2]:Connections=from-sk0-to-0.0.0.0/0
@

