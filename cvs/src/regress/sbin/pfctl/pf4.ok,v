head	1.13;
access;
symbols
	OPENBSD_6_1:1.13.0.24
	OPENBSD_6_1_BASE:1.13
	OPENBSD_6_0:1.13.0.20
	OPENBSD_6_0_BASE:1.13
	OPENBSD_5_9:1.13.0.10
	OPENBSD_5_9_BASE:1.13
	OPENBSD_5_8:1.13.0.18
	OPENBSD_5_8_BASE:1.13
	OPENBSD_5_7:1.13.0.16
	OPENBSD_5_7_BASE:1.13
	OPENBSD_5_6:1.13.0.14
	OPENBSD_5_6_BASE:1.13
	OPENBSD_5_5:1.13.0.12
	OPENBSD_5_5_BASE:1.13
	OPENBSD_5_4:1.13.0.8
	OPENBSD_5_4_BASE:1.13
	OPENBSD_5_3:1.13.0.6
	OPENBSD_5_3_BASE:1.13
	OPENBSD_5_2:1.13.0.4
	OPENBSD_5_2_BASE:1.13
	OPENBSD_5_1_BASE:1.13
	OPENBSD_5_1:1.13.0.2
	OPENBSD_5_0:1.12.0.2
	OPENBSD_5_0_BASE:1.12
	OPENBSD_4_9:1.11.0.30
	OPENBSD_4_9_BASE:1.11
	OPENBSD_4_8:1.11.0.28
	OPENBSD_4_8_BASE:1.11
	OPENBSD_4_7:1.11.0.24
	OPENBSD_4_7_BASE:1.11
	OPENBSD_4_6:1.11.0.26
	OPENBSD_4_6_BASE:1.11
	OPENBSD_4_5:1.11.0.22
	OPENBSD_4_5_BASE:1.11
	OPENBSD_4_4:1.11.0.20
	OPENBSD_4_4_BASE:1.11
	OPENBSD_4_3:1.11.0.18
	OPENBSD_4_3_BASE:1.11
	OPENBSD_4_2:1.11.0.16
	OPENBSD_4_2_BASE:1.11
	OPENBSD_4_1:1.11.0.14
	OPENBSD_4_1_BASE:1.11
	OPENBSD_4_0:1.11.0.12
	OPENBSD_4_0_BASE:1.11
	OPENBSD_3_9:1.11.0.10
	OPENBSD_3_9_BASE:1.11
	OPENBSD_3_8:1.11.0.8
	OPENBSD_3_8_BASE:1.11
	OPENBSD_3_7:1.11.0.6
	OPENBSD_3_7_BASE:1.11
	OPENBSD_3_6:1.11.0.4
	OPENBSD_3_6_BASE:1.11
	OPENBSD_3_5:1.11.0.2
	OPENBSD_3_5_BASE:1.11
	OPENBSD_3_4:1.10.0.2
	OPENBSD_3_4_BASE:1.10
	OPENBSD_3_3:1.9.0.2
	OPENBSD_3_3_BASE:1.9
	OPENBSD_3_2:1.6.0.2
	OPENBSD_3_2_BASE:1.6
	OPENBSD_3_1:1.4.0.2
	OPENBSD_3_1_BASE:1.4
	OPENBSD_3_0:1.3.0.2
	OPENBSD_3_0_BASE:1.3;
locks; strict;
comment	@# @;


1.13
date	2011.11.27.10.33.37;	author henning;	state Exp;
branches;
next	1.12;

1.12
date	2011.07.08.06.17.58;	author mcbride;	state Exp;
branches;
next	1.11;

1.11
date	2003.12.15.18.07.15;	author mcbride;	state Exp;
branches;
next	1.10;

1.10
date	2003.07.29.20.28.34;	author cedric;	state Exp;
branches;
next	1.9;

1.9
date	2002.12.06.11.09.48;	author henning;	state Exp;
branches;
next	1.8;

1.8
date	2002.12.05.14.13.37;	author henning;	state Exp;
branches;
next	1.7;

1.7
date	2002.10.05.22.25.33;	author dhartmei;	state Exp;
branches;
next	1.6;

1.6
date	2002.07.15.13.37.11;	author henning;	state Exp;
branches;
next	1.5;

1.5
date	2002.04.24.18.10.25;	author dhartmei;	state Exp;
branches;
next	1.4;

1.4
date	2002.02.27.18.23.39;	author dhartmei;	state Exp;
branches;
next	1.3;

1.3
date	2001.09.15.21.53.09;	author dhartmei;	state Exp;
branches;
next	1.2;

1.2
date	2001.09.03.08.16.01;	author markus;	state Exp;
branches;
next	1.1;

1.1
date	2001.08.19.16.31.06;	author dhartmei;	state Exp;
branches;
next	;


desc
@@


1.13
log
@adjust for port numbers instead of names by default
From: Lawrence Teo <lteo at devio at us>
@
text
@block drop in all
block drop in proto tcp all
block drop in proto tcp all
block drop in proto udp all
block drop in all
block drop in inet from 10.0.0.0/8 to any
block drop in inet from ! 10.0.0.0/8 to any
block drop in inet from 10.0.0.0/8 to any
block drop in inet from 172.16.0.0/12 to any
block drop in proto tcp from any port = 22 to any
block drop in proto tcp from any port = 22 to any port 1024:2048
block drop in proto tcp from any port 21 >< 2048 to any port 1024:2048
block drop in proto tcp from any port != 1234 to any port 1024:2048
block drop in proto tcp from any port >= 80 to any port 1024:2048
block drop in inet proto tcp from 10.0.0.0/8 port = 22 to 192.168.0.0/16 port = 6667
block drop in inet proto tcp from 10.0.0.0/8 port = 22 to 192.168.0.0/16 port = 6668
block drop in inet proto tcp from 10.0.0.0/8 port = 22 to 192.168.0.0/16 port 6669:65535
block drop in inet proto tcp from 10.0.0.0/8 port = 21 to 192.168.0.0/16 port = 6667
block drop in inet proto tcp from 10.0.0.0/8 port = 21 to 192.168.0.0/16 port = 6668
block drop in inet proto tcp from 10.0.0.0/8 port = 21 to 192.168.0.0/16 port 6669:65535
block drop in inet proto tcp from 10.0.0.0/8 port = 22 to 12.34.56.78 port = 6667
block drop in inet proto tcp from 10.0.0.0/8 port = 22 to 12.34.56.78 port = 6668
block drop in inet proto tcp from 10.0.0.0/8 port = 22 to 12.34.56.78 port 6669:65535
block drop in inet proto tcp from 10.0.0.0/8 port = 21 to 12.34.56.78 port = 6667
block drop in inet proto tcp from 10.0.0.0/8 port = 21 to 12.34.56.78 port = 6668
block drop in inet proto tcp from 10.0.0.0/8 port = 21 to 12.34.56.78 port 6669:65535
block drop in inet proto tcp from 172.16.0.0/12 port = 22 to 192.168.0.0/16 port = 6667
block drop in inet proto tcp from 172.16.0.0/12 port = 22 to 192.168.0.0/16 port = 6668
block drop in inet proto tcp from 172.16.0.0/12 port = 22 to 192.168.0.0/16 port 6669:65535
block drop in inet proto tcp from 172.16.0.0/12 port = 21 to 192.168.0.0/16 port = 6667
block drop in inet proto tcp from 172.16.0.0/12 port = 21 to 192.168.0.0/16 port = 6668
block drop in inet proto tcp from 172.16.0.0/12 port = 21 to 192.168.0.0/16 port 6669:65535
block drop in inet proto tcp from 172.16.0.0/12 port = 22 to 12.34.56.78 port = 6667
block drop in inet proto tcp from 172.16.0.0/12 port = 22 to 12.34.56.78 port = 6668
block drop in inet proto tcp from 172.16.0.0/12 port = 22 to 12.34.56.78 port 6669:65535
block drop in inet proto tcp from 172.16.0.0/12 port = 21 to 12.34.56.78 port = 6667
block drop in inet proto tcp from 172.16.0.0/12 port = 21 to 12.34.56.78 port = 6668
block drop in inet proto tcp from 172.16.0.0/12 port = 21 to 12.34.56.78 port 6669:65535
block drop in inet proto udp from 10.0.0.0/8 port = 22 to 192.168.0.0/16 port = 6667
block drop in inet proto udp from 10.0.0.0/8 port = 22 to 192.168.0.0/16 port = 6668
block drop in inet proto udp from 10.0.0.0/8 port = 22 to 192.168.0.0/16 port 6669:65535
block drop in inet proto udp from 10.0.0.0/8 port = 21 to 192.168.0.0/16 port = 6667
block drop in inet proto udp from 10.0.0.0/8 port = 21 to 192.168.0.0/16 port = 6668
block drop in inet proto udp from 10.0.0.0/8 port = 21 to 192.168.0.0/16 port 6669:65535
block drop in inet proto udp from 10.0.0.0/8 port = 22 to 12.34.56.78 port = 6667
block drop in inet proto udp from 10.0.0.0/8 port = 22 to 12.34.56.78 port = 6668
block drop in inet proto udp from 10.0.0.0/8 port = 22 to 12.34.56.78 port 6669:65535
block drop in inet proto udp from 10.0.0.0/8 port = 21 to 12.34.56.78 port = 6667
block drop in inet proto udp from 10.0.0.0/8 port = 21 to 12.34.56.78 port = 6668
block drop in inet proto udp from 10.0.0.0/8 port = 21 to 12.34.56.78 port 6669:65535
block drop in inet proto udp from 172.16.0.0/12 port = 22 to 192.168.0.0/16 port = 6667
block drop in inet proto udp from 172.16.0.0/12 port = 22 to 192.168.0.0/16 port = 6668
block drop in inet proto udp from 172.16.0.0/12 port = 22 to 192.168.0.0/16 port 6669:65535
block drop in inet proto udp from 172.16.0.0/12 port = 21 to 192.168.0.0/16 port = 6667
block drop in inet proto udp from 172.16.0.0/12 port = 21 to 192.168.0.0/16 port = 6668
block drop in inet proto udp from 172.16.0.0/12 port = 21 to 192.168.0.0/16 port 6669:65535
block drop in inet proto udp from 172.16.0.0/12 port = 22 to 12.34.56.78 port = 6667
block drop in inet proto udp from 172.16.0.0/12 port = 22 to 12.34.56.78 port = 6668
block drop in inet proto udp from 172.16.0.0/12 port = 22 to 12.34.56.78 port 6669:65535
block drop in inet proto udp from 172.16.0.0/12 port = 21 to 12.34.56.78 port = 6667
block drop in inet proto udp from 172.16.0.0/12 port = 21 to 12.34.56.78 port = 6668
block drop in inet proto udp from 172.16.0.0/12 port = 21 to 12.34.56.78 port 6669:65535
@


1.12
log
@Update regress tests for the following changes:
- if_addr RB_TREE (Address sort differently on an interface)
- skip steps changes
	- RDOMAIN
	- reordering of address/port tests
- fastroute is gone
- keep state is no longer printed by default
- lo0 now has link-local scope address in addition to ::1
@
text
@d10 2
a11 2
block drop in proto tcp from any port = ssh to any
block drop in proto tcp from any port = ssh to any port 1024:2048
d15 27
a41 27
block drop in inet proto tcp from 10.0.0.0/8 port = ssh to 192.168.0.0/16 port = 6667
block drop in inet proto tcp from 10.0.0.0/8 port = ssh to 192.168.0.0/16 port = 6668
block drop in inet proto tcp from 10.0.0.0/8 port = ssh to 192.168.0.0/16 port 6669:65535
block drop in inet proto tcp from 10.0.0.0/8 port = ftp to 192.168.0.0/16 port = 6667
block drop in inet proto tcp from 10.0.0.0/8 port = ftp to 192.168.0.0/16 port = 6668
block drop in inet proto tcp from 10.0.0.0/8 port = ftp to 192.168.0.0/16 port 6669:65535
block drop in inet proto tcp from 10.0.0.0/8 port = ssh to 12.34.56.78 port = 6667
block drop in inet proto tcp from 10.0.0.0/8 port = ssh to 12.34.56.78 port = 6668
block drop in inet proto tcp from 10.0.0.0/8 port = ssh to 12.34.56.78 port 6669:65535
block drop in inet proto tcp from 10.0.0.0/8 port = ftp to 12.34.56.78 port = 6667
block drop in inet proto tcp from 10.0.0.0/8 port = ftp to 12.34.56.78 port = 6668
block drop in inet proto tcp from 10.0.0.0/8 port = ftp to 12.34.56.78 port 6669:65535
block drop in inet proto tcp from 172.16.0.0/12 port = ssh to 192.168.0.0/16 port = 6667
block drop in inet proto tcp from 172.16.0.0/12 port = ssh to 192.168.0.0/16 port = 6668
block drop in inet proto tcp from 172.16.0.0/12 port = ssh to 192.168.0.0/16 port 6669:65535
block drop in inet proto tcp from 172.16.0.0/12 port = ftp to 192.168.0.0/16 port = 6667
block drop in inet proto tcp from 172.16.0.0/12 port = ftp to 192.168.0.0/16 port = 6668
block drop in inet proto tcp from 172.16.0.0/12 port = ftp to 192.168.0.0/16 port 6669:65535
block drop in inet proto tcp from 172.16.0.0/12 port = ssh to 12.34.56.78 port = 6667
block drop in inet proto tcp from 172.16.0.0/12 port = ssh to 12.34.56.78 port = 6668
block drop in inet proto tcp from 172.16.0.0/12 port = ssh to 12.34.56.78 port 6669:65535
block drop in inet proto tcp from 172.16.0.0/12 port = ftp to 12.34.56.78 port = 6667
block drop in inet proto tcp from 172.16.0.0/12 port = ftp to 12.34.56.78 port = 6668
block drop in inet proto tcp from 172.16.0.0/12 port = ftp to 12.34.56.78 port 6669:65535
block drop in inet proto udp from 10.0.0.0/8 port = ssh to 192.168.0.0/16 port = 6667
block drop in inet proto udp from 10.0.0.0/8 port = ssh to 192.168.0.0/16 port = 6668
block drop in inet proto udp from 10.0.0.0/8 port = ssh to 192.168.0.0/16 port 6669:65535
d45 3
a47 3
block drop in inet proto udp from 10.0.0.0/8 port = ssh to 12.34.56.78 port = 6667
block drop in inet proto udp from 10.0.0.0/8 port = ssh to 12.34.56.78 port = 6668
block drop in inet proto udp from 10.0.0.0/8 port = ssh to 12.34.56.78 port 6669:65535
d51 3
a53 3
block drop in inet proto udp from 172.16.0.0/12 port = ssh to 192.168.0.0/16 port = 6667
block drop in inet proto udp from 172.16.0.0/12 port = ssh to 192.168.0.0/16 port = 6668
block drop in inet proto udp from 172.16.0.0/12 port = ssh to 192.168.0.0/16 port 6669:65535
d57 3
a59 3
block drop in inet proto udp from 172.16.0.0/12 port = ssh to 12.34.56.78 port = 6667
block drop in inet proto udp from 172.16.0.0/12 port = ssh to 12.34.56.78 port = 6668
block drop in inet proto udp from 172.16.0.0/12 port = ssh to 12.34.56.78 port 6669:65535
@


1.11
log
@Test for <port_a>:<port_b> syntax outside of rdr.
@
text
@d18 3
a23 3
block drop in inet proto tcp from 10.0.0.0/8 port = ftp to 192.168.0.0/16 port = 6667
block drop in inet proto tcp from 10.0.0.0/8 port = ftp to 192.168.0.0/16 port = 6668
block drop in inet proto tcp from 10.0.0.0/8 port = ftp to 192.168.0.0/16 port 6669:65535
d30 3
a35 3
block drop in inet proto tcp from 172.16.0.0/12 port = ftp to 192.168.0.0/16 port = 6667
block drop in inet proto tcp from 172.16.0.0/12 port = ftp to 192.168.0.0/16 port = 6668
block drop in inet proto tcp from 172.16.0.0/12 port = ftp to 192.168.0.0/16 port 6669:65535
d42 3
a47 3
block drop in inet proto udp from 10.0.0.0/8 port = 21 to 192.168.0.0/16 port = 6667
block drop in inet proto udp from 10.0.0.0/8 port = 21 to 192.168.0.0/16 port = 6668
block drop in inet proto udp from 10.0.0.0/8 port = 21 to 192.168.0.0/16 port 6669:65535
d54 3
a59 3
block drop in inet proto udp from 172.16.0.0/12 port = 21 to 192.168.0.0/16 port = 6667
block drop in inet proto udp from 172.16.0.0/12 port = 21 to 192.168.0.0/16 port = 6668
block drop in inet proto udp from 172.16.0.0/12 port = 21 to 192.168.0.0/16 port 6669:65535
@


1.10
log
@Big Sync
@
text
@d11 4
a14 4
block drop in proto tcp from any port = ssh to any
block drop in proto tcp from any port 21 >< 2048 to any
block drop in proto tcp from any port != 1234 to any
block drop in proto tcp from any port >= 80 to any
d17 1
d20 1
d23 1
d26 1
d29 1
d32 1
d35 1
d38 1
d41 1
d44 1
d47 1
d50 1
d53 1
d56 1
d59 1
d62 1
@


1.9
log
@block -> block drop
@
text
@d1 46
a46 46
block drop in all 
block drop in proto tcp all 
block drop in proto tcp all 
block drop in proto udp all 
block drop in all 
block drop in inet from 10.0.0.0/8 to any 
block drop in inet from ! 10.0.0.0/8 to any 
block drop in inet from 10.0.0.0/8 to any 
block drop in inet from 172.16.0.0/12 to any 
block drop in proto tcp from any port = ssh to any 
block drop in proto tcp from any port = ssh to any 
block drop in proto tcp from any port 21 >< 2048 to any 
block drop in proto tcp from any port != 1234 to any 
block drop in proto tcp from any port >= 80 to any 
block drop in inet proto tcp from 10.0.0.0/8 port = ssh to 192.168.0.0/16 port = 6667 
block drop in inet proto tcp from 10.0.0.0/8 port = ssh to 192.168.0.0/16 port = 6668 
block drop in inet proto tcp from 10.0.0.0/8 port = ssh to 12.34.56.78 port = 6667 
block drop in inet proto tcp from 10.0.0.0/8 port = ssh to 12.34.56.78 port = 6668 
block drop in inet proto tcp from 10.0.0.0/8 port = ftp to 192.168.0.0/16 port = 6667 
block drop in inet proto tcp from 10.0.0.0/8 port = ftp to 192.168.0.0/16 port = 6668 
block drop in inet proto tcp from 10.0.0.0/8 port = ftp to 12.34.56.78 port = 6667 
block drop in inet proto tcp from 10.0.0.0/8 port = ftp to 12.34.56.78 port = 6668 
block drop in inet proto tcp from 172.16.0.0/12 port = ssh to 192.168.0.0/16 port = 6667 
block drop in inet proto tcp from 172.16.0.0/12 port = ssh to 192.168.0.0/16 port = 6668 
block drop in inet proto tcp from 172.16.0.0/12 port = ssh to 12.34.56.78 port = 6667 
block drop in inet proto tcp from 172.16.0.0/12 port = ssh to 12.34.56.78 port = 6668 
block drop in inet proto tcp from 172.16.0.0/12 port = ftp to 192.168.0.0/16 port = 6667 
block drop in inet proto tcp from 172.16.0.0/12 port = ftp to 192.168.0.0/16 port = 6668 
block drop in inet proto tcp from 172.16.0.0/12 port = ftp to 12.34.56.78 port = 6667 
block drop in inet proto tcp from 172.16.0.0/12 port = ftp to 12.34.56.78 port = 6668 
block drop in inet proto udp from 10.0.0.0/8 port = ssh to 192.168.0.0/16 port = 6667 
block drop in inet proto udp from 10.0.0.0/8 port = ssh to 192.168.0.0/16 port = 6668 
block drop in inet proto udp from 10.0.0.0/8 port = ssh to 12.34.56.78 port = 6667 
block drop in inet proto udp from 10.0.0.0/8 port = ssh to 12.34.56.78 port = 6668 
block drop in inet proto udp from 10.0.0.0/8 port = 21 to 192.168.0.0/16 port = 6667 
block drop in inet proto udp from 10.0.0.0/8 port = 21 to 192.168.0.0/16 port = 6668 
block drop in inet proto udp from 10.0.0.0/8 port = 21 to 12.34.56.78 port = 6667 
block drop in inet proto udp from 10.0.0.0/8 port = 21 to 12.34.56.78 port = 6668 
block drop in inet proto udp from 172.16.0.0/12 port = ssh to 192.168.0.0/16 port = 6667 
block drop in inet proto udp from 172.16.0.0/12 port = ssh to 192.168.0.0/16 port = 6668 
block drop in inet proto udp from 172.16.0.0/12 port = ssh to 12.34.56.78 port = 6667 
block drop in inet proto udp from 172.16.0.0/12 port = ssh to 12.34.56.78 port = 6668 
block drop in inet proto udp from 172.16.0.0/12 port = 21 to 192.168.0.0/16 port = 6667 
block drop in inet proto udp from 172.16.0.0/12 port = 21 to 192.168.0.0/16 port = 6668 
block drop in inet proto udp from 172.16.0.0/12 port = 21 to 12.34.56.78 port = 6667 
block drop in inet proto udp from 172.16.0.0/12 port = 21 to 12.34.56.78 port = 6668 
@


1.8
log
@no more rule numbers in output
@
text
@d1 46
a46 46
block in all 
block in proto tcp all 
block in proto tcp all 
block in proto udp all 
block in all 
block in inet from 10.0.0.0/8 to any 
block in inet from ! 10.0.0.0/8 to any 
block in inet from 10.0.0.0/8 to any 
block in inet from 172.16.0.0/12 to any 
block in proto tcp from any port = ssh to any 
block in proto tcp from any port = ssh to any 
block in proto tcp from any port 21 >< 2048 to any 
block in proto tcp from any port != 1234 to any 
block in proto tcp from any port >= 80 to any 
block in inet proto tcp from 10.0.0.0/8 port = ssh to 192.168.0.0/16 port = 6667 
block in inet proto tcp from 10.0.0.0/8 port = ssh to 192.168.0.0/16 port = 6668 
block in inet proto tcp from 10.0.0.0/8 port = ssh to 12.34.56.78 port = 6667 
block in inet proto tcp from 10.0.0.0/8 port = ssh to 12.34.56.78 port = 6668 
block in inet proto tcp from 10.0.0.0/8 port = ftp to 192.168.0.0/16 port = 6667 
block in inet proto tcp from 10.0.0.0/8 port = ftp to 192.168.0.0/16 port = 6668 
block in inet proto tcp from 10.0.0.0/8 port = ftp to 12.34.56.78 port = 6667 
block in inet proto tcp from 10.0.0.0/8 port = ftp to 12.34.56.78 port = 6668 
block in inet proto tcp from 172.16.0.0/12 port = ssh to 192.168.0.0/16 port = 6667 
block in inet proto tcp from 172.16.0.0/12 port = ssh to 192.168.0.0/16 port = 6668 
block in inet proto tcp from 172.16.0.0/12 port = ssh to 12.34.56.78 port = 6667 
block in inet proto tcp from 172.16.0.0/12 port = ssh to 12.34.56.78 port = 6668 
block in inet proto tcp from 172.16.0.0/12 port = ftp to 192.168.0.0/16 port = 6667 
block in inet proto tcp from 172.16.0.0/12 port = ftp to 192.168.0.0/16 port = 6668 
block in inet proto tcp from 172.16.0.0/12 port = ftp to 12.34.56.78 port = 6667 
block in inet proto tcp from 172.16.0.0/12 port = ftp to 12.34.56.78 port = 6668 
block in inet proto udp from 10.0.0.0/8 port = ssh to 192.168.0.0/16 port = 6667 
block in inet proto udp from 10.0.0.0/8 port = ssh to 192.168.0.0/16 port = 6668 
block in inet proto udp from 10.0.0.0/8 port = ssh to 12.34.56.78 port = 6667 
block in inet proto udp from 10.0.0.0/8 port = ssh to 12.34.56.78 port = 6668 
block in inet proto udp from 10.0.0.0/8 port = 21 to 192.168.0.0/16 port = 6667 
block in inet proto udp from 10.0.0.0/8 port = 21 to 192.168.0.0/16 port = 6668 
block in inet proto udp from 10.0.0.0/8 port = 21 to 12.34.56.78 port = 6667 
block in inet proto udp from 10.0.0.0/8 port = 21 to 12.34.56.78 port = 6668 
block in inet proto udp from 172.16.0.0/12 port = ssh to 192.168.0.0/16 port = 6667 
block in inet proto udp from 172.16.0.0/12 port = ssh to 192.168.0.0/16 port = 6668 
block in inet proto udp from 172.16.0.0/12 port = ssh to 12.34.56.78 port = 6667 
block in inet proto udp from 172.16.0.0/12 port = ssh to 12.34.56.78 port = 6668 
block in inet proto udp from 172.16.0.0/12 port = 21 to 192.168.0.0/16 port = 6667 
block in inet proto udp from 172.16.0.0/12 port = 21 to 192.168.0.0/16 port = 6668 
block in inet proto udp from 172.16.0.0/12 port = 21 to 12.34.56.78 port = 6667 
block in inet proto udp from 172.16.0.0/12 port = 21 to 12.34.56.78 port = 6668 
@


1.7
log
@Expand {} lists from left to right, so 'pass in from { a, b } to any'
becomes '@@0 pass in from a to any @@1 pass in from b to any' instead of
the other way around. Patch from Camiel Dobbelaar.
@
text
@d1 46
a46 46
@@0 block in all 
@@1 block in proto tcp all 
@@2 block in proto tcp all 
@@3 block in proto udp all 
@@4 block in all 
@@5 block in inet from 10.0.0.0/8 to any 
@@6 block in inet from ! 10.0.0.0/8 to any 
@@7 block in inet from 10.0.0.0/8 to any 
@@8 block in inet from 172.16.0.0/12 to any 
@@9 block in proto tcp from any port = ssh to any 
@@10 block in proto tcp from any port = ssh to any 
@@11 block in proto tcp from any port 21 >< 2048 to any 
@@12 block in proto tcp from any port != 1234 to any 
@@13 block in proto tcp from any port >= 80 to any 
@@14 block in inet proto tcp from 10.0.0.0/8 port = ssh to 192.168.0.0/16 port = 6667 
@@15 block in inet proto tcp from 10.0.0.0/8 port = ssh to 192.168.0.0/16 port = 6668 
@@16 block in inet proto tcp from 10.0.0.0/8 port = ssh to 12.34.56.78 port = 6667 
@@17 block in inet proto tcp from 10.0.0.0/8 port = ssh to 12.34.56.78 port = 6668 
@@18 block in inet proto tcp from 10.0.0.0/8 port = ftp to 192.168.0.0/16 port = 6667 
@@19 block in inet proto tcp from 10.0.0.0/8 port = ftp to 192.168.0.0/16 port = 6668 
@@20 block in inet proto tcp from 10.0.0.0/8 port = ftp to 12.34.56.78 port = 6667 
@@21 block in inet proto tcp from 10.0.0.0/8 port = ftp to 12.34.56.78 port = 6668 
@@22 block in inet proto tcp from 172.16.0.0/12 port = ssh to 192.168.0.0/16 port = 6667 
@@23 block in inet proto tcp from 172.16.0.0/12 port = ssh to 192.168.0.0/16 port = 6668 
@@24 block in inet proto tcp from 172.16.0.0/12 port = ssh to 12.34.56.78 port = 6667 
@@25 block in inet proto tcp from 172.16.0.0/12 port = ssh to 12.34.56.78 port = 6668 
@@26 block in inet proto tcp from 172.16.0.0/12 port = ftp to 192.168.0.0/16 port = 6667 
@@27 block in inet proto tcp from 172.16.0.0/12 port = ftp to 192.168.0.0/16 port = 6668 
@@28 block in inet proto tcp from 172.16.0.0/12 port = ftp to 12.34.56.78 port = 6667 
@@29 block in inet proto tcp from 172.16.0.0/12 port = ftp to 12.34.56.78 port = 6668 
@@30 block in inet proto udp from 10.0.0.0/8 port = ssh to 192.168.0.0/16 port = 6667 
@@31 block in inet proto udp from 10.0.0.0/8 port = ssh to 192.168.0.0/16 port = 6668 
@@32 block in inet proto udp from 10.0.0.0/8 port = ssh to 12.34.56.78 port = 6667 
@@33 block in inet proto udp from 10.0.0.0/8 port = ssh to 12.34.56.78 port = 6668 
@@34 block in inet proto udp from 10.0.0.0/8 port = 21 to 192.168.0.0/16 port = 6667 
@@35 block in inet proto udp from 10.0.0.0/8 port = 21 to 192.168.0.0/16 port = 6668 
@@36 block in inet proto udp from 10.0.0.0/8 port = 21 to 12.34.56.78 port = 6667 
@@37 block in inet proto udp from 10.0.0.0/8 port = 21 to 12.34.56.78 port = 6668 
@@38 block in inet proto udp from 172.16.0.0/12 port = ssh to 192.168.0.0/16 port = 6667 
@@39 block in inet proto udp from 172.16.0.0/12 port = ssh to 192.168.0.0/16 port = 6668 
@@40 block in inet proto udp from 172.16.0.0/12 port = ssh to 12.34.56.78 port = 6667 
@@41 block in inet proto udp from 172.16.0.0/12 port = ssh to 12.34.56.78 port = 6668 
@@42 block in inet proto udp from 172.16.0.0/12 port = 21 to 192.168.0.0/16 port = 6667 
@@43 block in inet proto udp from 172.16.0.0/12 port = 21 to 192.168.0.0/16 port = 6668 
@@44 block in inet proto udp from 172.16.0.0/12 port = 21 to 12.34.56.78 port = 6667 
@@45 block in inet proto udp from 172.16.0.0/12 port = 21 to 12.34.56.78 port = 6668 
@


1.6
log
@o don't use keep state on block rules
o don't use return-rst on not-tcp rules
@
text
@d3 2
a4 2
@@2 block in proto udp all 
@@3 block in proto tcp all 
d8 2
a9 2
@@7 block in inet from 172.16.0.0/12 to any 
@@8 block in inet from 10.0.0.0/8 to any 
d11 36
a46 36
@@10 block in proto tcp from any port >= 80 to any 
@@11 block in proto tcp from any port != 1234 to any 
@@12 block in proto tcp from any port 21 >< 2048 to any 
@@13 block in proto tcp from any port = ssh to any 
@@14 block in inet proto udp from 172.16.0.0/12 port = 21 to 12.34.56.78 port = 6668 
@@15 block in inet proto udp from 172.16.0.0/12 port = 21 to 12.34.56.78 port = 6667 
@@16 block in inet proto udp from 172.16.0.0/12 port = 21 to 192.168.0.0/16 port = 6668 
@@17 block in inet proto udp from 172.16.0.0/12 port = 21 to 192.168.0.0/16 port = 6667 
@@18 block in inet proto udp from 172.16.0.0/12 port = ssh to 12.34.56.78 port = 6668 
@@19 block in inet proto udp from 172.16.0.0/12 port = ssh to 12.34.56.78 port = 6667 
@@20 block in inet proto udp from 172.16.0.0/12 port = ssh to 192.168.0.0/16 port = 6668 
@@21 block in inet proto udp from 172.16.0.0/12 port = ssh to 192.168.0.0/16 port = 6667 
@@22 block in inet proto udp from 10.0.0.0/8 port = 21 to 12.34.56.78 port = 6668 
@@23 block in inet proto udp from 10.0.0.0/8 port = 21 to 12.34.56.78 port = 6667 
@@24 block in inet proto udp from 10.0.0.0/8 port = 21 to 192.168.0.0/16 port = 6668 
@@25 block in inet proto udp from 10.0.0.0/8 port = 21 to 192.168.0.0/16 port = 6667 
@@26 block in inet proto udp from 10.0.0.0/8 port = ssh to 12.34.56.78 port = 6668 
@@27 block in inet proto udp from 10.0.0.0/8 port = ssh to 12.34.56.78 port = 6667 
@@28 block in inet proto udp from 10.0.0.0/8 port = ssh to 192.168.0.0/16 port = 6668 
@@29 block in inet proto udp from 10.0.0.0/8 port = ssh to 192.168.0.0/16 port = 6667 
@@30 block in inet proto tcp from 172.16.0.0/12 port = ftp to 12.34.56.78 port = 6668 
@@31 block in inet proto tcp from 172.16.0.0/12 port = ftp to 12.34.56.78 port = 6667 
@@32 block in inet proto tcp from 172.16.0.0/12 port = ftp to 192.168.0.0/16 port = 6668 
@@33 block in inet proto tcp from 172.16.0.0/12 port = ftp to 192.168.0.0/16 port = 6667 
@@34 block in inet proto tcp from 172.16.0.0/12 port = ssh to 12.34.56.78 port = 6668 
@@35 block in inet proto tcp from 172.16.0.0/12 port = ssh to 12.34.56.78 port = 6667 
@@36 block in inet proto tcp from 172.16.0.0/12 port = ssh to 192.168.0.0/16 port = 6668 
@@37 block in inet proto tcp from 172.16.0.0/12 port = ssh to 192.168.0.0/16 port = 6667 
@@38 block in inet proto tcp from 10.0.0.0/8 port = ftp to 12.34.56.78 port = 6668 
@@39 block in inet proto tcp from 10.0.0.0/8 port = ftp to 12.34.56.78 port = 6667 
@@40 block in inet proto tcp from 10.0.0.0/8 port = ftp to 192.168.0.0/16 port = 6668 
@@41 block in inet proto tcp from 10.0.0.0/8 port = ftp to 192.168.0.0/16 port = 6667 
@@42 block in inet proto tcp from 10.0.0.0/8 port = ssh to 12.34.56.78 port = 6668 
@@43 block in inet proto tcp from 10.0.0.0/8 port = ssh to 12.34.56.78 port = 6667 
@@44 block in inet proto tcp from 10.0.0.0/8 port = ssh to 192.168.0.0/16 port = 6668 
@@45 block in inet proto tcp from 10.0.0.0/8 port = ssh to 192.168.0.0/16 port = 6667 
@


1.5
log
@Add dynamic (in-kernel) interface name -> address translation. Instead of
using just the interface name instead of an address and reloading the rule
set whenever the interface changes its address, the interface name can be
put in parentheses, and the kernel will keep track of changes and update
rules. There is no additional cost for evaluating rules (per packet),
the cost occurs when an interface changes address (and the rules are
traversed and updated where necessary).
@
text
@d15 32
a46 32
@@14 block in inet proto udp from 172.16.0.0/12 port = 21 to 12.34.56.78 port = 6668 keep state 
@@15 block in inet proto udp from 172.16.0.0/12 port = 21 to 12.34.56.78 port = 6667 keep state 
@@16 block in inet proto udp from 172.16.0.0/12 port = 21 to 192.168.0.0/16 port = 6668 keep state 
@@17 block in inet proto udp from 172.16.0.0/12 port = 21 to 192.168.0.0/16 port = 6667 keep state 
@@18 block in inet proto udp from 172.16.0.0/12 port = ssh to 12.34.56.78 port = 6668 keep state 
@@19 block in inet proto udp from 172.16.0.0/12 port = ssh to 12.34.56.78 port = 6667 keep state 
@@20 block in inet proto udp from 172.16.0.0/12 port = ssh to 192.168.0.0/16 port = 6668 keep state 
@@21 block in inet proto udp from 172.16.0.0/12 port = ssh to 192.168.0.0/16 port = 6667 keep state 
@@22 block in inet proto udp from 10.0.0.0/8 port = 21 to 12.34.56.78 port = 6668 keep state 
@@23 block in inet proto udp from 10.0.0.0/8 port = 21 to 12.34.56.78 port = 6667 keep state 
@@24 block in inet proto udp from 10.0.0.0/8 port = 21 to 192.168.0.0/16 port = 6668 keep state 
@@25 block in inet proto udp from 10.0.0.0/8 port = 21 to 192.168.0.0/16 port = 6667 keep state 
@@26 block in inet proto udp from 10.0.0.0/8 port = ssh to 12.34.56.78 port = 6668 keep state 
@@27 block in inet proto udp from 10.0.0.0/8 port = ssh to 12.34.56.78 port = 6667 keep state 
@@28 block in inet proto udp from 10.0.0.0/8 port = ssh to 192.168.0.0/16 port = 6668 keep state 
@@29 block in inet proto udp from 10.0.0.0/8 port = ssh to 192.168.0.0/16 port = 6667 keep state 
@@30 block in inet proto tcp from 172.16.0.0/12 port = ftp to 12.34.56.78 port = 6668 keep state 
@@31 block in inet proto tcp from 172.16.0.0/12 port = ftp to 12.34.56.78 port = 6667 keep state 
@@32 block in inet proto tcp from 172.16.0.0/12 port = ftp to 192.168.0.0/16 port = 6668 keep state 
@@33 block in inet proto tcp from 172.16.0.0/12 port = ftp to 192.168.0.0/16 port = 6667 keep state 
@@34 block in inet proto tcp from 172.16.0.0/12 port = ssh to 12.34.56.78 port = 6668 keep state 
@@35 block in inet proto tcp from 172.16.0.0/12 port = ssh to 12.34.56.78 port = 6667 keep state 
@@36 block in inet proto tcp from 172.16.0.0/12 port = ssh to 192.168.0.0/16 port = 6668 keep state 
@@37 block in inet proto tcp from 172.16.0.0/12 port = ssh to 192.168.0.0/16 port = 6667 keep state 
@@38 block in inet proto tcp from 10.0.0.0/8 port = ftp to 12.34.56.78 port = 6668 keep state 
@@39 block in inet proto tcp from 10.0.0.0/8 port = ftp to 12.34.56.78 port = 6667 keep state 
@@40 block in inet proto tcp from 10.0.0.0/8 port = ftp to 192.168.0.0/16 port = 6668 keep state 
@@41 block in inet proto tcp from 10.0.0.0/8 port = ftp to 192.168.0.0/16 port = 6667 keep state 
@@42 block in inet proto tcp from 10.0.0.0/8 port = ssh to 12.34.56.78 port = 6668 keep state 
@@43 block in inet proto tcp from 10.0.0.0/8 port = ssh to 12.34.56.78 port = 6667 keep state 
@@44 block in inet proto tcp from 10.0.0.0/8 port = ssh to 192.168.0.0/16 port = 6668 keep state 
@@45 block in inet proto tcp from 10.0.0.0/8 port = ssh to 192.168.0.0/16 port = 6667 keep state 
@


1.4
log
@And adjust regress tests to match the rule number output.
@
text
@d15 2
a16 2
@@14 block in inet proto udp from 172.16.0.0/12 port = 21 to 12.34.56.78/32 port = 6668 keep state 
@@15 block in inet proto udp from 172.16.0.0/12 port = 21 to 12.34.56.78/32 port = 6667 keep state 
d19 2
a20 2
@@18 block in inet proto udp from 172.16.0.0/12 port = ssh to 12.34.56.78/32 port = 6668 keep state 
@@19 block in inet proto udp from 172.16.0.0/12 port = ssh to 12.34.56.78/32 port = 6667 keep state 
d23 2
a24 2
@@22 block in inet proto udp from 10.0.0.0/8 port = 21 to 12.34.56.78/32 port = 6668 keep state 
@@23 block in inet proto udp from 10.0.0.0/8 port = 21 to 12.34.56.78/32 port = 6667 keep state 
d27 2
a28 2
@@26 block in inet proto udp from 10.0.0.0/8 port = ssh to 12.34.56.78/32 port = 6668 keep state 
@@27 block in inet proto udp from 10.0.0.0/8 port = ssh to 12.34.56.78/32 port = 6667 keep state 
d31 2
a32 2
@@30 block in inet proto tcp from 172.16.0.0/12 port = ftp to 12.34.56.78/32 port = 6668 keep state 
@@31 block in inet proto tcp from 172.16.0.0/12 port = ftp to 12.34.56.78/32 port = 6667 keep state 
d35 2
a36 2
@@34 block in inet proto tcp from 172.16.0.0/12 port = ssh to 12.34.56.78/32 port = 6668 keep state 
@@35 block in inet proto tcp from 172.16.0.0/12 port = ssh to 12.34.56.78/32 port = 6667 keep state 
d39 2
a40 2
@@38 block in inet proto tcp from 10.0.0.0/8 port = ftp to 12.34.56.78/32 port = 6668 keep state 
@@39 block in inet proto tcp from 10.0.0.0/8 port = ftp to 12.34.56.78/32 port = 6667 keep state 
d43 2
a44 2
@@42 block in inet proto tcp from 10.0.0.0/8 port = ssh to 12.34.56.78/32 port = 6668 keep state 
@@43 block in inet proto tcp from 10.0.0.0/8 port = ssh to 12.34.56.78/32 port = 6667 keep state 
@


1.3
log
@Update regress tests. Some input syntax has changed (inet/inet6) as well
as some output format (netmasks, inet/inet6, return-icmp).
@
text
@d2 45
a46 45
@@0 block in proto tcp all 
@@0 block in proto udp all 
@@0 block in proto tcp all 
@@0 block in all 
@@0 block in inet from 10.0.0.0/8 to any 
@@0 block in inet from ! 10.0.0.0/8 to any 
@@0 block in inet from 172.16.0.0/12 to any 
@@0 block in inet from 10.0.0.0/8 to any 
@@0 block in proto tcp from any port = ssh to any 
@@0 block in proto tcp from any port >= 80 to any 
@@0 block in proto tcp from any port != 1234 to any 
@@0 block in proto tcp from any port 21 >< 2048 to any 
@@0 block in proto tcp from any port = ssh to any 
@@0 block in inet proto udp from 172.16.0.0/12 port = 21 to 12.34.56.78/32 port = 6668 keep state 
@@0 block in inet proto udp from 172.16.0.0/12 port = 21 to 12.34.56.78/32 port = 6667 keep state 
@@0 block in inet proto udp from 172.16.0.0/12 port = 21 to 192.168.0.0/16 port = 6668 keep state 
@@0 block in inet proto udp from 172.16.0.0/12 port = 21 to 192.168.0.0/16 port = 6667 keep state 
@@0 block in inet proto udp from 172.16.0.0/12 port = ssh to 12.34.56.78/32 port = 6668 keep state 
@@0 block in inet proto udp from 172.16.0.0/12 port = ssh to 12.34.56.78/32 port = 6667 keep state 
@@0 block in inet proto udp from 172.16.0.0/12 port = ssh to 192.168.0.0/16 port = 6668 keep state 
@@0 block in inet proto udp from 172.16.0.0/12 port = ssh to 192.168.0.0/16 port = 6667 keep state 
@@0 block in inet proto udp from 10.0.0.0/8 port = 21 to 12.34.56.78/32 port = 6668 keep state 
@@0 block in inet proto udp from 10.0.0.0/8 port = 21 to 12.34.56.78/32 port = 6667 keep state 
@@0 block in inet proto udp from 10.0.0.0/8 port = 21 to 192.168.0.0/16 port = 6668 keep state 
@@0 block in inet proto udp from 10.0.0.0/8 port = 21 to 192.168.0.0/16 port = 6667 keep state 
@@0 block in inet proto udp from 10.0.0.0/8 port = ssh to 12.34.56.78/32 port = 6668 keep state 
@@0 block in inet proto udp from 10.0.0.0/8 port = ssh to 12.34.56.78/32 port = 6667 keep state 
@@0 block in inet proto udp from 10.0.0.0/8 port = ssh to 192.168.0.0/16 port = 6668 keep state 
@@0 block in inet proto udp from 10.0.0.0/8 port = ssh to 192.168.0.0/16 port = 6667 keep state 
@@0 block in inet proto tcp from 172.16.0.0/12 port = ftp to 12.34.56.78/32 port = 6668 keep state 
@@0 block in inet proto tcp from 172.16.0.0/12 port = ftp to 12.34.56.78/32 port = 6667 keep state 
@@0 block in inet proto tcp from 172.16.0.0/12 port = ftp to 192.168.0.0/16 port = 6668 keep state 
@@0 block in inet proto tcp from 172.16.0.0/12 port = ftp to 192.168.0.0/16 port = 6667 keep state 
@@0 block in inet proto tcp from 172.16.0.0/12 port = ssh to 12.34.56.78/32 port = 6668 keep state 
@@0 block in inet proto tcp from 172.16.0.0/12 port = ssh to 12.34.56.78/32 port = 6667 keep state 
@@0 block in inet proto tcp from 172.16.0.0/12 port = ssh to 192.168.0.0/16 port = 6668 keep state 
@@0 block in inet proto tcp from 172.16.0.0/12 port = ssh to 192.168.0.0/16 port = 6667 keep state 
@@0 block in inet proto tcp from 10.0.0.0/8 port = ftp to 12.34.56.78/32 port = 6668 keep state 
@@0 block in inet proto tcp from 10.0.0.0/8 port = ftp to 12.34.56.78/32 port = 6667 keep state 
@@0 block in inet proto tcp from 10.0.0.0/8 port = ftp to 192.168.0.0/16 port = 6668 keep state 
@@0 block in inet proto tcp from 10.0.0.0/8 port = ftp to 192.168.0.0/16 port = 6667 keep state 
@@0 block in inet proto tcp from 10.0.0.0/8 port = ssh to 12.34.56.78/32 port = 6668 keep state 
@@0 block in inet proto tcp from 10.0.0.0/8 port = ssh to 12.34.56.78/32 port = 6667 keep state 
@@0 block in inet proto tcp from 10.0.0.0/8 port = ssh to 192.168.0.0/16 port = 6668 keep state 
@@0 block in inet proto tcp from 10.0.0.0/8 port = ssh to 192.168.0.0/16 port = 6667 keep state 
@


1.2
log
@sync with output format changes (pfctl)
@
text
@d6 4
a9 4
@@0 block in from 10.0.0.0/255.0.0.0 to any 
@@0 block in from ! 10.0.0.0/255.0.0.0 to any 
@@0 block in from 172.16.0.0/255.240.0.0 to any 
@@0 block in from 10.0.0.0/255.0.0.0 to any 
d15 32
a46 32
@@0 block in proto udp from 172.16.0.0/255.240.0.0 port = 21 to 12.34.56.78 port = 6668 keep state 
@@0 block in proto udp from 172.16.0.0/255.240.0.0 port = 21 to 12.34.56.78 port = 6667 keep state 
@@0 block in proto udp from 172.16.0.0/255.240.0.0 port = 21 to 192.168.0.0/255.255.0.0 port = 6668 keep state 
@@0 block in proto udp from 172.16.0.0/255.240.0.0 port = 21 to 192.168.0.0/255.255.0.0 port = 6667 keep state 
@@0 block in proto udp from 172.16.0.0/255.240.0.0 port = ssh to 12.34.56.78 port = 6668 keep state 
@@0 block in proto udp from 172.16.0.0/255.240.0.0 port = ssh to 12.34.56.78 port = 6667 keep state 
@@0 block in proto udp from 172.16.0.0/255.240.0.0 port = ssh to 192.168.0.0/255.255.0.0 port = 6668 keep state 
@@0 block in proto udp from 172.16.0.0/255.240.0.0 port = ssh to 192.168.0.0/255.255.0.0 port = 6667 keep state 
@@0 block in proto udp from 10.0.0.0/255.0.0.0 port = 21 to 12.34.56.78 port = 6668 keep state 
@@0 block in proto udp from 10.0.0.0/255.0.0.0 port = 21 to 12.34.56.78 port = 6667 keep state 
@@0 block in proto udp from 10.0.0.0/255.0.0.0 port = 21 to 192.168.0.0/255.255.0.0 port = 6668 keep state 
@@0 block in proto udp from 10.0.0.0/255.0.0.0 port = 21 to 192.168.0.0/255.255.0.0 port = 6667 keep state 
@@0 block in proto udp from 10.0.0.0/255.0.0.0 port = ssh to 12.34.56.78 port = 6668 keep state 
@@0 block in proto udp from 10.0.0.0/255.0.0.0 port = ssh to 12.34.56.78 port = 6667 keep state 
@@0 block in proto udp from 10.0.0.0/255.0.0.0 port = ssh to 192.168.0.0/255.255.0.0 port = 6668 keep state 
@@0 block in proto udp from 10.0.0.0/255.0.0.0 port = ssh to 192.168.0.0/255.255.0.0 port = 6667 keep state 
@@0 block in proto tcp from 172.16.0.0/255.240.0.0 port = ftp to 12.34.56.78 port = 6668 keep state 
@@0 block in proto tcp from 172.16.0.0/255.240.0.0 port = ftp to 12.34.56.78 port = 6667 keep state 
@@0 block in proto tcp from 172.16.0.0/255.240.0.0 port = ftp to 192.168.0.0/255.255.0.0 port = 6668 keep state 
@@0 block in proto tcp from 172.16.0.0/255.240.0.0 port = ftp to 192.168.0.0/255.255.0.0 port = 6667 keep state 
@@0 block in proto tcp from 172.16.0.0/255.240.0.0 port = ssh to 12.34.56.78 port = 6668 keep state 
@@0 block in proto tcp from 172.16.0.0/255.240.0.0 port = ssh to 12.34.56.78 port = 6667 keep state 
@@0 block in proto tcp from 172.16.0.0/255.240.0.0 port = ssh to 192.168.0.0/255.255.0.0 port = 6668 keep state 
@@0 block in proto tcp from 172.16.0.0/255.240.0.0 port = ssh to 192.168.0.0/255.255.0.0 port = 6667 keep state 
@@0 block in proto tcp from 10.0.0.0/255.0.0.0 port = ftp to 12.34.56.78 port = 6668 keep state 
@@0 block in proto tcp from 10.0.0.0/255.0.0.0 port = ftp to 12.34.56.78 port = 6667 keep state 
@@0 block in proto tcp from 10.0.0.0/255.0.0.0 port = ftp to 192.168.0.0/255.255.0.0 port = 6668 keep state 
@@0 block in proto tcp from 10.0.0.0/255.0.0.0 port = ftp to 192.168.0.0/255.255.0.0 port = 6667 keep state 
@@0 block in proto tcp from 10.0.0.0/255.0.0.0 port = ssh to 12.34.56.78 port = 6668 keep state 
@@0 block in proto tcp from 10.0.0.0/255.0.0.0 port = ssh to 12.34.56.78 port = 6667 keep state 
@@0 block in proto tcp from 10.0.0.0/255.0.0.0 port = ssh to 192.168.0.0/255.255.0.0 port = 6668 keep state 
@@0 block in proto tcp from 10.0.0.0/255.0.0.0 port = ssh to 192.168.0.0/255.255.0.0 port = 6667 keep state 
@


1.1
log
@Regress test for parameter list expansion syntax.
@
text
@d1 46
a46 46
@@1 block in all 
@@1 block in proto tcp all 
@@1 block in proto udp all 
@@1 block in proto tcp all 
@@1 block in all 
@@1 block in from 10.0.0.0/255.0.0.0 to any 
@@1 block in from ! 10.0.0.0/255.0.0.0 to any 
@@1 block in from 172.16.0.0/255.240.0.0 to any 
@@1 block in from 10.0.0.0/255.0.0.0 to any 
@@1 block in proto tcp from any port = ssh to any 
@@1 block in proto tcp from any port >= 80 to any 
@@1 block in proto tcp from any port != 1234 to any 
@@1 block in proto tcp from any port 21 >< 2048 to any 
@@1 block in proto tcp from any port = ssh to any 
@@1 block in proto udp from 172.16.0.0/255.240.0.0 port = 21 to 12.34.56.78 port = 6668 keep state 
@@1 block in proto udp from 172.16.0.0/255.240.0.0 port = 21 to 12.34.56.78 port = 6667 keep state 
@@1 block in proto udp from 172.16.0.0/255.240.0.0 port = 21 to 192.168.0.0/255.255.0.0 port = 6668 keep state 
@@1 block in proto udp from 172.16.0.0/255.240.0.0 port = 21 to 192.168.0.0/255.255.0.0 port = 6667 keep state 
@@1 block in proto udp from 172.16.0.0/255.240.0.0 port = ssh to 12.34.56.78 port = 6668 keep state 
@@1 block in proto udp from 172.16.0.0/255.240.0.0 port = ssh to 12.34.56.78 port = 6667 keep state 
@@1 block in proto udp from 172.16.0.0/255.240.0.0 port = ssh to 192.168.0.0/255.255.0.0 port = 6668 keep state 
@@1 block in proto udp from 172.16.0.0/255.240.0.0 port = ssh to 192.168.0.0/255.255.0.0 port = 6667 keep state 
@@1 block in proto udp from 10.0.0.0/255.0.0.0 port = 21 to 12.34.56.78 port = 6668 keep state 
@@1 block in proto udp from 10.0.0.0/255.0.0.0 port = 21 to 12.34.56.78 port = 6667 keep state 
@@1 block in proto udp from 10.0.0.0/255.0.0.0 port = 21 to 192.168.0.0/255.255.0.0 port = 6668 keep state 
@@1 block in proto udp from 10.0.0.0/255.0.0.0 port = 21 to 192.168.0.0/255.255.0.0 port = 6667 keep state 
@@1 block in proto udp from 10.0.0.0/255.0.0.0 port = ssh to 12.34.56.78 port = 6668 keep state 
@@1 block in proto udp from 10.0.0.0/255.0.0.0 port = ssh to 12.34.56.78 port = 6667 keep state 
@@1 block in proto udp from 10.0.0.0/255.0.0.0 port = ssh to 192.168.0.0/255.255.0.0 port = 6668 keep state 
@@1 block in proto udp from 10.0.0.0/255.0.0.0 port = ssh to 192.168.0.0/255.255.0.0 port = 6667 keep state 
@@1 block in proto tcp from 172.16.0.0/255.240.0.0 port = ftp to 12.34.56.78 port = 6668 keep state 
@@1 block in proto tcp from 172.16.0.0/255.240.0.0 port = ftp to 12.34.56.78 port = 6667 keep state 
@@1 block in proto tcp from 172.16.0.0/255.240.0.0 port = ftp to 192.168.0.0/255.255.0.0 port = 6668 keep state 
@@1 block in proto tcp from 172.16.0.0/255.240.0.0 port = ftp to 192.168.0.0/255.255.0.0 port = 6667 keep state 
@@1 block in proto tcp from 172.16.0.0/255.240.0.0 port = ssh to 12.34.56.78 port = 6668 keep state 
@@1 block in proto tcp from 172.16.0.0/255.240.0.0 port = ssh to 12.34.56.78 port = 6667 keep state 
@@1 block in proto tcp from 172.16.0.0/255.240.0.0 port = ssh to 192.168.0.0/255.255.0.0 port = 6668 keep state 
@@1 block in proto tcp from 172.16.0.0/255.240.0.0 port = ssh to 192.168.0.0/255.255.0.0 port = 6667 keep state 
@@1 block in proto tcp from 10.0.0.0/255.0.0.0 port = ftp to 12.34.56.78 port = 6668 keep state 
@@1 block in proto tcp from 10.0.0.0/255.0.0.0 port = ftp to 12.34.56.78 port = 6667 keep state 
@@1 block in proto tcp from 10.0.0.0/255.0.0.0 port = ftp to 192.168.0.0/255.255.0.0 port = 6668 keep state 
@@1 block in proto tcp from 10.0.0.0/255.0.0.0 port = ftp to 192.168.0.0/255.255.0.0 port = 6667 keep state 
@@1 block in proto tcp from 10.0.0.0/255.0.0.0 port = ssh to 12.34.56.78 port = 6668 keep state 
@@1 block in proto tcp from 10.0.0.0/255.0.0.0 port = ssh to 12.34.56.78 port = 6667 keep state 
@@1 block in proto tcp from 10.0.0.0/255.0.0.0 port = ssh to 192.168.0.0/255.255.0.0 port = 6668 keep state 
@@1 block in proto tcp from 10.0.0.0/255.0.0.0 port = ssh to 192.168.0.0/255.255.0.0 port = 6667 keep state 
@

