head	1.8;
access;
symbols
	OPENBSD_6_2:1.8.0.22
	OPENBSD_6_2_BASE:1.8
	OPENBSD_6_1:1.8.0.24
	OPENBSD_6_1_BASE:1.8
	OPENBSD_6_0:1.8.0.20
	OPENBSD_6_0_BASE:1.8
	OPENBSD_5_9:1.8.0.10
	OPENBSD_5_9_BASE:1.8
	OPENBSD_5_8:1.8.0.18
	OPENBSD_5_8_BASE:1.8
	OPENBSD_5_7:1.8.0.16
	OPENBSD_5_7_BASE:1.8
	OPENBSD_5_6:1.8.0.14
	OPENBSD_5_6_BASE:1.8
	OPENBSD_5_5:1.8.0.12
	OPENBSD_5_5_BASE:1.8
	OPENBSD_5_4:1.8.0.8
	OPENBSD_5_4_BASE:1.8
	OPENBSD_5_3:1.8.0.6
	OPENBSD_5_3_BASE:1.8
	OPENBSD_5_2:1.8.0.4
	OPENBSD_5_2_BASE:1.8
	OPENBSD_5_1_BASE:1.8
	OPENBSD_5_1:1.8.0.2
	OPENBSD_5_0:1.7.0.2
	OPENBSD_5_0_BASE:1.7
	OPENBSD_4_9:1.6.0.8
	OPENBSD_4_9_BASE:1.6
	OPENBSD_4_8:1.6.0.6
	OPENBSD_4_8_BASE:1.6
	OPENBSD_4_7:1.6.0.2
	OPENBSD_4_7_BASE:1.6
	OPENBSD_4_6:1.6.0.4
	OPENBSD_4_6_BASE:1.6
	OPENBSD_4_5:1.5.0.10
	OPENBSD_4_5_BASE:1.5
	OPENBSD_4_4:1.5.0.8
	OPENBSD_4_4_BASE:1.5
	OPENBSD_4_3:1.5.0.6
	OPENBSD_4_3_BASE:1.5
	OPENBSD_4_2:1.5.0.4
	OPENBSD_4_2_BASE:1.5
	OPENBSD_4_1:1.5.0.2
	OPENBSD_4_1_BASE:1.5
	OPENBSD_4_0:1.3.0.14
	OPENBSD_4_0_BASE:1.3
	OPENBSD_3_9:1.3.0.12
	OPENBSD_3_9_BASE:1.3
	OPENBSD_3_8:1.3.0.10
	OPENBSD_3_8_BASE:1.3
	OPENBSD_3_7:1.3.0.8
	OPENBSD_3_7_BASE:1.3
	OPENBSD_3_6:1.3.0.6
	OPENBSD_3_6_BASE:1.3
	OPENBSD_3_5:1.3.0.4
	OPENBSD_3_5_BASE:1.3
	OPENBSD_3_4:1.3.0.2
	OPENBSD_3_4_BASE:1.3
	OPENBSD_3_3:1.2.0.2
	OPENBSD_3_3_BASE:1.2;
locks; strict;
comment	@# @;


1.8
date	2011.11.27.10.33.37;	author henning;	state Exp;
branches;
next	1.7;

1.7
date	2011.07.08.06.17.58;	author mcbride;	state Exp;
branches;
next	1.6;

1.6
date	2009.04.06.12.41.48;	author henning;	state Exp;
branches;
next	1.5;

1.5
date	2006.10.17.08.15.32;	author mcbride;	state Exp;
branches;
next	1.4;

1.4
date	2006.10.06.17.09.41;	author mcbride;	state Exp;
branches;
next	1.3;

1.3
date	2003.07.29.20.28.34;	author cedric;	state Exp;
branches;
next	1.2;

1.2
date	2002.12.07.23.19.53;	author dhartmei;	state Exp;
branches;
next	1.1;

1.1
date	2002.12.06.14.29.55;	author dhartmei;	state Exp;
branches;
next	;


desc
@@


1.8
log
@adjust for port numbers instead of names by default
From: Lawrence Teo <lteo at devio at us>
@
text
@block drop all
block return all
block return-rst proto tcp all
pass all flags S/SA
pass in all no state
pass out all no state
pass all no state
block drop in all
block drop out all
block drop all
pass in all flags S/SA
pass out all flags S/SA
block drop on lo0 all
pass on lo0 all flags S/SA
block drop on lo0 all
pass proto tcp all flags S/SA
pass proto udp all
pass in proto udp all
pass out proto udp all
pass out on lo0 proto tcp from any to any port = 25 flags S/SA
@


1.7
log
@Update regress tests for the following changes:
- if_addr RB_TREE (Address sort differently on an interface)
- skip steps changes
	- RDOMAIN
	- reordering of address/port tests
- fastroute is gone
- keep state is no longer printed by default
- lo0 now has link-local scope address in addition to ::1
@
text
@d20 1
a20 1
pass out on lo0 proto tcp from any to any port = smtp flags S/SA
@


1.6
log
@scrub gone
@
text
@d4 1
a4 1
pass all flags S/SA keep state
d11 2
a12 2
pass in all flags S/SA keep state
pass out all flags S/SA keep state
d14 1
a14 1
pass on lo0 all flags S/SA keep state
d16 5
a20 5
pass proto tcp all flags S/SA keep state
pass proto udp all keep state
pass in proto udp all keep state
pass out proto udp all keep state
pass out on lo0 proto tcp from any to any port = smtp flags S/SA keep state
@


1.5
log
@'flags S/SA' not implicit if the rule is stateless.
@
text
@a0 6
scrub all fragment reassemble
scrub all fragment reassemble
scrub in all fragment reassemble
scrub out all fragment reassemble
scrub in all fragment reassemble
scrub all fragment reassemble
@


1.4
log
@Handle default 'flags S/SA keep state', 'no state' and 'flags any'.
@
text
@d11 3
a13 3
pass in all flags S/SA no state
pass out all flags S/SA no state
pass all flags S/SA no state
@


1.3
log
@Big Sync
@
text
@d10 4
a13 4
pass all
pass in all
pass out all
pass all
d17 2
a18 2
pass in all
pass out all
d20 1
a20 1
pass on lo0 all
d22 1
a22 1
pass proto tcp all flags S/SA
d26 1
a26 1
pass out on lo0 proto tcp from any to any port = smtp keep state
@


1.2
log
@fromto is optional now, "from any to any" equals "all" equals omitted.
A single rule "block" is not valid, and does the same as "block in all,
block out all".
@
text
@d1 26
a26 26
scrub all fragment reassemble 
scrub all fragment reassemble 
scrub in all fragment reassemble 
scrub out all fragment reassemble 
scrub in all fragment reassemble 
scrub all fragment reassemble 
block drop all 
block return all 
block return-rst proto tcp all 
pass all 
pass in all 
pass out all 
pass all 
block drop in all 
block drop out all 
block drop all 
pass in all 
pass out all 
block drop on lo0 all 
pass on lo0 all 
block drop on lo0 all 
pass proto tcp all flags S/SA 
pass proto udp all keep state 
pass in proto udp all keep state 
pass out proto udp all keep state 
pass out on lo0 proto tcp from any to any port = smtp keep state 
@


1.1
log
@Direction (in/out) is now optional in filter rules, 'block all' is valid,
for instance. Add a regress test for those.
@
text
@d2 3
d7 6
d19 1
d22 2
@

