head	1.6;
access;
symbols
	OPENBSD_6_2:1.6.0.24
	OPENBSD_6_2_BASE:1.6
	OPENBSD_6_1:1.6.0.26
	OPENBSD_6_1_BASE:1.6
	OPENBSD_6_0:1.6.0.22
	OPENBSD_6_0_BASE:1.6
	OPENBSD_5_9:1.6.0.12
	OPENBSD_5_9_BASE:1.6
	OPENBSD_5_8:1.6.0.20
	OPENBSD_5_8_BASE:1.6
	OPENBSD_5_7:1.6.0.18
	OPENBSD_5_7_BASE:1.6
	OPENBSD_5_6:1.6.0.16
	OPENBSD_5_6_BASE:1.6
	OPENBSD_5_5:1.6.0.14
	OPENBSD_5_5_BASE:1.6
	OPENBSD_5_4:1.6.0.10
	OPENBSD_5_4_BASE:1.6
	OPENBSD_5_3:1.6.0.8
	OPENBSD_5_3_BASE:1.6
	OPENBSD_5_2:1.6.0.6
	OPENBSD_5_2_BASE:1.6
	OPENBSD_5_1_BASE:1.6
	OPENBSD_5_1:1.6.0.4
	OPENBSD_5_0:1.6.0.2
	OPENBSD_5_0_BASE:1.6
	OPENBSD_4_9:1.3.0.30
	OPENBSD_4_9_BASE:1.3
	OPENBSD_4_8:1.3.0.28
	OPENBSD_4_8_BASE:1.3
	OPENBSD_4_7:1.3.0.24
	OPENBSD_4_7_BASE:1.3
	OPENBSD_4_6:1.3.0.26
	OPENBSD_4_6_BASE:1.3
	OPENBSD_4_5:1.3.0.22
	OPENBSD_4_5_BASE:1.3
	OPENBSD_4_4:1.3.0.20
	OPENBSD_4_4_BASE:1.3
	OPENBSD_4_3:1.3.0.18
	OPENBSD_4_3_BASE:1.3
	OPENBSD_4_2:1.3.0.16
	OPENBSD_4_2_BASE:1.3
	OPENBSD_4_1:1.3.0.14
	OPENBSD_4_1_BASE:1.3
	OPENBSD_4_0:1.3.0.12
	OPENBSD_4_0_BASE:1.3
	OPENBSD_3_9:1.3.0.10
	OPENBSD_3_9_BASE:1.3
	OPENBSD_3_8:1.3.0.8
	OPENBSD_3_8_BASE:1.3
	OPENBSD_3_7:1.3.0.6
	OPENBSD_3_7_BASE:1.3
	OPENBSD_3_6:1.3.0.4
	OPENBSD_3_6_BASE:1.3
	OPENBSD_3_5:1.3.0.2
	OPENBSD_3_5_BASE:1.3
	OPENBSD_3_4:1.2.0.2
	OPENBSD_3_4_BASE:1.2
	OPENBSD_3_3:1.1.0.2
	OPENBSD_3_3_BASE:1.1;
locks; strict;
comment	@# @;


1.6
date	2011.07.27.10.40.05;	author mcbride;	state Exp;
branches;
next	1.5;

1.5
date	2011.07.24.02.22.52;	author mcbride;	state Exp;
branches;
next	1.4;

1.4
date	2011.07.24.01.22.11;	author mcbride;	state Exp;
branches;
next	1.3;

1.3
date	2004.03.07.20.50.49;	author henning;	state Exp;
branches;
next	1.2;

1.2
date	2003.06.08.10.39.02;	author cedric;	state Exp;
branches;
next	1.1;

1.1
date	2003.02.25.09.06.32;	author cedric;	state Exp;
branches;
next	;


desc
@@


1.6
log
@Update regress tests for weighted round-robin (and recent pool bugfix)
@
text
@# create
# pass load table <regress> persist file "DIR/pfr.addrs1"
# pass show 
   1.1.1.1
   2.2.2.2
   10.0.0.0/8
   127.0.0.0/24
   127.0.0.0/8
   127.0.0.1
   172.16.0.0/12
   192.168.0.0/16
   ::/24
   ::1
   ::5
   2000::1
   fe80::/24
   fe80::/16
   fe80::1
# pass load table <regress> persist file "DIR/pfr.addrs1" file "DIR/pfr.addrs2"
# pass show 
   1.1.0.0
   1.1.0.1
   1.1.0.2
   1.1.0.3
   1.1.0.4
   1.1.0.5
   1.1.0.6
   1.1.0.7
   1.1.0.8
   1.1.0.9
   1.1.1.0
   1.1.1.1
   1.1.1.2
   1.1.1.3
   1.1.1.4
   1.1.1.5
   1.1.1.6
   1.1.1.7
   1.1.1.8
   1.1.1.9
   1.1.2.0
   1.1.2.1
   1.1.2.2
   1.1.2.3
   1.1.2.4
   1.1.2.5
   1.1.2.6
   1.1.2.7
   1.1.2.8
   1.1.2.9
   1.1.3.0
   1.1.3.1
   1.1.3.2
   1.1.3.3
   1.1.3.4
   1.1.3.5
   1.1.3.6
   1.1.3.7
   1.1.3.8
   1.1.3.9
   1.1.4.0
   1.1.4.1
   1.1.4.2
   1.1.4.3
   1.1.4.4
   1.1.4.5
   1.1.4.6
   1.1.4.7
   1.1.4.8
   1.1.4.9
   1.1.5.0
   1.1.5.1
   1.1.5.2
   1.1.5.3
   1.1.5.4
   1.1.5.5
   1.1.5.6
   1.1.5.7
   1.1.5.8
   1.1.5.9
   1.1.6.0
   1.1.6.1
   1.1.6.2
   1.1.6.3
   1.1.6.4
   1.1.6.5
   1.1.6.6
   1.1.6.7
   1.1.6.8
   1.1.6.9
   1.1.7.0
   1.1.7.1
   1.1.7.2
   1.1.7.3
   1.1.7.4
   1.1.7.5
   1.1.7.6
   1.1.7.7
   1.1.7.8
   1.1.7.9
   1.1.8.0
   1.1.8.1
   1.1.8.2
   1.1.8.3
   1.1.8.4
   1.1.8.5
   1.1.8.6
   1.1.8.7
   1.1.8.8
   1.1.8.9
   1.1.9.0
   1.1.9.1
   1.1.9.2
   1.1.9.3
   1.1.9.4
   1.1.9.5
   1.1.9.6
   1.1.9.7
   1.1.9.8
   1.1.9.9
   1.2.0.0
   1.2.0.1
   1.2.0.2
   1.2.0.3
   1.2.0.4
   1.2.0.5
   1.2.0.6
   1.2.0.7
   1.2.0.8
   1.2.0.9
   1.2.1.0
   1.2.1.1
   1.2.1.2
   1.2.1.3
   1.2.1.4
   1.2.1.5
   1.2.1.6
   1.2.1.7
   1.2.1.8
   1.2.1.9
   1.2.2.0
   1.2.2.1
   1.2.2.2
   1.2.2.3
   1.2.2.4
   1.2.2.5
   1.2.2.6
   1.2.2.7
   1.2.2.8
   1.2.2.9
   1.2.3.0
   1.2.3.1
   1.2.3.2
   1.2.3.3
   1.2.3.4
   1.2.3.5
   1.2.3.6
   1.2.3.7
   1.2.3.8
   1.2.3.9
   1.2.4.0
   1.2.4.1
   1.2.4.2
   1.2.4.3
   1.2.4.4
   1.2.4.5
   1.2.4.6
   1.2.4.7
   1.2.4.8
   1.2.4.9
   1.2.5.0
   1.2.5.1
   1.2.5.2
   1.2.5.3
   1.2.5.4
   1.2.5.5
   1.2.5.6
   1.2.5.7
   1.2.5.8
   1.2.5.9
   1.2.6.0
   1.2.6.1
   1.2.6.2
   1.2.6.3
   1.2.6.4
   1.2.6.5
   1.2.6.6
   1.2.6.7
   1.2.6.8
   1.2.6.9
   1.2.7.0
   1.2.7.1
   1.2.7.2
   1.2.7.3
   1.2.7.4
   1.2.7.5
   1.2.7.6
   1.2.7.7
   1.2.7.8
   1.2.7.9
   1.2.8.0
   1.2.8.1
   1.2.8.2
   1.2.8.3
   1.2.8.4
   1.2.8.5
   1.2.8.6
   1.2.8.7
   1.2.8.8
   1.2.8.9
   1.2.9.0
   1.2.9.1
   1.2.9.2
   1.2.9.3
   1.2.9.4
   1.2.9.5
   1.2.9.6
   1.2.9.7
   1.2.9.8
   1.2.9.9
   1.3.0.0
   1.3.0.1
   1.3.0.2
   1.3.0.3
   1.3.0.4
   1.3.0.5
   1.3.0.6
   1.3.0.7
   1.3.0.8
   1.3.0.9
   1.3.1.0
   1.3.1.1
   1.3.1.2
   1.3.1.3
   1.3.1.4
   1.3.1.5
   1.3.1.6
   1.3.1.7
   1.3.1.8
   1.3.1.9
   1.3.2.0
   1.3.2.1
   1.3.2.2
   1.3.2.3
   1.3.2.4
   1.3.2.5
   1.3.2.6
   1.3.2.7
   1.3.2.8
   1.3.2.9
   1.3.3.0
   1.3.3.1
   1.3.3.2
   1.3.3.3
   1.3.3.4
   1.3.3.5
   1.3.3.6
   1.3.3.7
   1.3.3.8
   1.3.3.9
   1.3.4.0
   1.3.4.1
   1.3.4.2
   1.3.4.3
   1.3.4.4
   1.3.4.5
   1.3.4.6
   1.3.4.7
   1.3.4.8
   1.3.4.9
   1.3.5.0
   1.3.5.1
   1.3.5.2
   1.3.5.3
   1.3.5.4
   1.3.5.5
   1.3.5.6
   1.3.5.7
   1.3.5.8
   1.3.5.9
   1.3.6.0
   1.3.6.1
   1.3.6.2
   1.3.6.3
   1.3.6.4
   1.3.6.5
   1.3.6.6
   1.3.6.7
   1.3.6.8
   1.3.6.9
   1.3.7.0
   1.3.7.1
   1.3.7.2
   1.3.7.3
   1.3.7.4
   1.3.7.5
   1.3.7.6
   1.3.7.7
   1.3.7.8
   1.3.7.9
   1.3.8.0
   1.3.8.1
   1.3.8.2
   1.3.8.3
   1.3.8.4
   1.3.8.5
   1.3.8.6
   1.3.8.7
   1.3.8.8
   1.3.8.9
   1.3.9.0
   1.3.9.1
   1.3.9.2
   1.3.9.3
   1.3.9.4
   1.3.9.5
   1.3.9.6
   1.3.9.7
   1.3.9.8
   1.3.9.9
   2.2.2.2
   10.0.0.0/8
   127.0.0.0/24
   127.0.0.0/8
   127.0.0.1
   172.16.0.0/12
   192.168.0.0/16
   ::/24
   ::1
   ::5
   2000::1
   fe80::/24
   fe80::/16
   fe80::1
# pass load table <regress> persist file "DIR/pfr.addrs3"
# pass show 
   1.1.1.1
   2.2.2.2
   3.3.3.3
	Weight:             6
   10.0.0.0/8
   127.0.0.0/24
   127.0.0.0/8
   127.0.0.1
   172.16.0.0/12
   192.168.0.0/16
   ::/24
   ::1
   ::4
	Weight:             6
   ::5
   2000::1
   fe80::/24
   fe80::/16
   fe80::1
# pass load table <regress> persist file "DIR/pfr.addrs1" file "DIR/pfr.addrs3"
# pass show 
   1.1.1.1
   2.2.2.2
   3.3.3.3
	Weight:             6
   10.0.0.0/8
   127.0.0.0/24
   127.0.0.0/8
   127.0.0.1
   172.16.0.0/12
   192.168.0.0/16
   ::/24
   ::1
   ::4
	Weight:             6
   ::5
   2000::1
   fe80::/24
   fe80::/16
   fe80::1
# pass load table <regress> persist { !127.0.0.1 } file "DIR/pfr.addrs1"
# pass show 
   1.1.1.1
   2.2.2.2
   10.0.0.0/8
   127.0.0.0/24
   127.0.0.0/8
   127.0.0.1
   172.16.0.0/12
   192.168.0.0/16
   ::/24
   ::1
   ::5
   2000::1
   fe80::/24
   fe80::/16
   fe80::1
# pass load table <regress> persist file "DIR/pfr.addrs1" { 3.3.3.3 }
# pass show 
   1.1.1.1
   2.2.2.2
   3.3.3.3
   10.0.0.0/8
   127.0.0.0/24
   127.0.0.0/8
   127.0.0.1
   172.16.0.0/12
   192.168.0.0/16
   ::/24
   ::1
   ::5
   2000::1
   fe80::/24
   fe80::/16
   fe80::1
# pass load table <regress> persist { 11/8 } file "DIR/pfr.addrs3" { !12/8 }
# pass show 
   1.1.1.1
   2.2.2.2
   3.3.3.3
   10.0.0.0/8
   11.0.0.0/8
  !12.0.0.0/8
   127.0.0.0/24
   127.0.0.0/8
   127.0.0.1
   172.16.0.0/12
   192.168.0.0/16
   ::/24
   ::1
   ::4
	Weight:             6
   ::5
   2000::1
   fe80::/24
   fe80::/16
   fe80::1
# kill
1 tables deleted.
rules cleared
ktable: 10 allocated, 10 released, 0 leaked.
pfrke_plain: 397 allocated, 397 released, 0 leaked.
pfrke_route: 0 allocated, 0 released, 0 leaked.
pfrke_cost: 16 allocated, 16 released, 0 leaked.
@


1.5
log
@Handle 'show' specially to prepare for regress tests on pfrke_route
and pfrke_cost entries. Output becomes sorted in table order.
@
text
@d335 42
d412 1
a412 1
# pass load table <regress> persist { 11/8 } file "DIR/pfr.addrs1" { !12/8 }
d416 1
d427 2
d437 2
a438 2
ktable: 8 allocated, 8 released, 0 leaked.
pfrke_plain: 377 allocated, 377 released, 0 leaked.
d440 1
a440 1
pfrke_cost: 0 allocated, 0 released, 0 leaked.
@


1.4
log
@Update PF table regress tests to work with -current.
@
text
@d5 1
a11 2
   2.2.2.2
   2000::1
d15 2
a17 1
   fe80::/24
d321 1
a327 2
   2.2.2.2
   2000::1
d331 2
a333 1
   fe80::/24
d338 1
a344 2
   2.2.2.2
   2000::1
d348 2
a350 1
   fe80::/24
d355 2
a362 3
   2.2.2.2
   2000::1
   3.3.3.3
d366 2
a368 1
   fe80::/24
d373 1
d376 1
a381 2
   2.2.2.2
   2000::1
d385 2
a387 1
   fe80::/24
a388 1
  !12.0.0.0/8
@


1.3
log
@syn with reality, ryan ok
@
text
@d341 1
a351 1
  !127.0.0.1
a391 1
nat cleared
d393 3
a395 1
kentry: 377 allocated, 377 released, 0 leaked.
@


1.2
log
@Sync with recent anchor changes.
Execute all table regress tests inside 'regress:regress' ruleset.
@
text
@d370 1
a370 1
# pass load table <regress> persist { 11 } file "DIR/pfr.addrs1" { !12 }
@


1.1
log
@Add regress tests for the 'table <foo> file "filename"' syntax.
Syntax checks only in pfsimple2, real tests in pfr13.
@
text
@d390 4
a393 2
1 table deleted.
ktable: 7 allocated, 7 released, 0 leaked.
@

