head	1.8;
access;
symbols
	OPENBSD_2_5:1.7.0.6
	OPENBSD_2_5_BASE:1.7
	OPENBSD_2_4:1.7.0.4
	OPENBSD_2_4_BASE:1.7
	OPENBSD_2_3:1.7.0.2
	OPENBSD_2_3_BASE:1.7
	OPENBSD_2_2:1.3.0.6
	OPENBSD_2_2_BASE:1.3
	OPENBSD_2_1:1.3.0.4
	OPENBSD_2_1_BASE:1.3
	OPENBSD_2_0:1.3.0.2
	OPENBSD_2_0_BASE:1.3;
locks; strict;
comment	@# @;


1.8
date	99.05.26.16.36.57;	author espie;	state dead;
branches;
next	1.7;

1.7
date	98.03.19.17.13.20;	author niklas;	state Exp;
branches;
next	1.6;

1.6
date	98.03.08.21.09.24;	author millert;	state Exp;
branches;
next	1.5;

1.5
date	98.03.07.19.14.30;	author millert;	state Exp;
branches;
next	1.4;

1.4
date	98.03.03.21.41.37;	author millert;	state Exp;
branches;
next	1.3;

1.3
date	96.04.17.08.01.41;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	96.03.27.23.00.04;	author niklas;	state Exp;
branches;
next	1.1;

1.1
date	96.03.16.05.18.51;	author etheisen;	state Exp;
branches;
next	;


desc
@@


1.8
log
@old libg++, replaced by part of egcs.
@
text
@#	$OpenBSD: Makefile.bsd-wrapper,v 1.7 1998/03/19 17:13:20 niklas Exp $

LIBIO=		io
LIBIOSTREAM=	iostream
LIB=		$(LIBIO)
CXXFLAGS+=	-fno-implicit-templates
CPPFLAGS+=	-I$(.CURDIR) -I$(.OBJDIR)
VERSION=	2.8.0

IO_SRCS=	filedoalloc.c floatconv.c genops.c fileops.c iovfprintf.c \
		iovfscanf.c ioignore.c iopadn.c iofgetpos.c iofread.c \
		iofscanf.c iofsetpos.c iogetdelim.c iogetline.c ioprintf.c \
		ioseekoff.c ioseekpos.c outfloat.c strops.c iofclose.c \
		iopopen.c ioungetc.c peekc.c iogetc.c ioputc.c iofeof.c \
		ioferror.c
STDIO_SRCS=	stdfiles.c
STDIO_WRAP_SRCS=iofdopen.c iofflush.c iofgets.c iofopen.c iofprintf.c \
		iofputs.c iofwrite.c iogets.c ioperror.c ioputs.c ioscanf.c \
		iosetbuffer.c iosetvbuf.c  iosprintf.c iosscanf.c ioftell.c \
		iovsscanf.c iovsprintf.c
IOSTREAM_SRCS=	builtinbuf.cc filebuf.cc fstream.cc indstream.cc ioassign.cc \
		ioextend.cc iomanip.cc iostream.cc isgetline.cc isgetsb.cc \
		isscan.cc osform.cc procbuf.cc sbform.cc sbgetline.cc \
		sbscan.cc stdiostream.cc stdstrbufs.cc stdstreams.cc \
		stream.cc streambuf.cc strstream.cc PlotFile.cc SFile.cc \
		parsestream.cc pfstream.cc editbuf.cc
OSPRIM_SRCS=	ioprims.c iostrerror.c cleanup.c
LIBIO_SRCS=	$(IO_SRCS) $(STDIO_WRAP_SRCS) $(OSPRIM_SRCS) $(STDIO_SRCS)
LIBIOSTREAM_SRCS= $(IO_SRCS) $(IOSTREAM_SRCS) $(OSPRIM_SRCS)

SRCS=		$(LIBIO_SRCS)

CLEANFILES+=	_G_config.h iostream.list dummy.h

FILES=		*.h

all: _G_config.h iostream.list $(LIBIOSTREAM)

beforedepend:	_G_config.h

$(LIBIOSTREAM):
	@@if [ -z "$(MAKE_IOSTREAM)" ] ; then \
		cd $(.CURDIR); $(MAKE) -f $(.CURDIR)/Makefile.bsd-wrapper LIB=$(LIBIOSTREAM) SRCS='$$(LIBIOSTREAM_SRCS)' MAKE_IOSTREAM=true ; \
		exit ; \
	fi

_G_config.h: gen-params
	@@echo Building $(.TARGET)
	@@rootme=`pwd`/ ; export rootme; \
	CC="$(CC)"; export CC; \
	CXX="$(CXX) $(CXXFLAGS)"; export CXX; \
	CONFIG_NM="nm"; export CONFIG_NM; \
	sh $(.CURDIR)/gen-params LIB_VERSION=$(VERSION) $(G_CONFIG_ARGS) >tmp-params.h
	@@mv tmp-params.h _G_config.h

iostream.list: _G_config.h
	@@echo Generating $(.TARGET)
	@@echo "$(LIBIOSTREAM_SRCS:N*.h:R:S/$/.o/g)" > iostream.list
clean:
	rm -f a.out [Ee]rrs mklog core *.core $(CLEANFILES)
	rm -f lib$(LIBIO).a $(LIBIO_SRCS:.c=.o)
	rm -f lib$(LIBIO)_p.a $(LIBIO_SRCS:.c=.po)
	rm -f lib$(LIBIO)_pic.a lib$(LIBIO).so.*.* $(LIBIO_SRCS:.c=.so)
	rm -f llib-lib$(LIBIO).ln $(LIBIO_SRCS:.c=.ln)
	rm -f lib$(LIBIOSTREAM).a $(IOSTREAM_SRCS:.cc=.o)
	rm -f lib$(LIBIOSTREAM)_p.a $(IOSTREAM_SRCS:.cc=.po)
	rm -f lib$(LIBIOSTREAM)_pic.a lib$(LIBIOSTREAM).so.*.* \
		 $(IOSTREAM_SRCS:.cc=.so)
	rm -f llib-lib$(LIBIOSTREAM).ln $(IOSTREAM_SRCS:.cc=.ln)

includes:
	install -d -m 755 -o $(BINOWN) -g $(BINGRP) $(DESTDIR)/usr/include/g++
	@@-cd $(.CURDIR); for i in $(FILES); do \
		if [ -e $$i ]; then \
			cmp -s $$i $(DESTDIR)/usr/include/g++/$$i || \
			install -c -o $(BINOWN) -g $(BINGRP) -m $(NONBINMODE) \
			    $$i $(DESTDIR)/usr/include/g++/$$i; \
		fi \
	done
	@@-for i in $(FILES); do \
		if [ -e $$i ]; then \
			cmp -s $$i $(DESTDIR)/usr/include/g++/$$i || \
			install -c -o $(BINOWN) -g $(BINGRP) -m $(NONBINMODE) \
			    $$i $(DESTDIR)/usr/include/g++/$$i; \
		fi \
	done

install:
	@@-cd $(.CURDIR); for i in iostream.info* ; do \
		cmp -s $$i $(DESTDIR)/usr/share/info/$$i || \
	install -c -o $(BINOWN) -g $(BINGRP) -m $(NONBINMODE) \
		 $$i $(DESTDIR)/usr/share/info/$$i; \
	done

.include <bsd.lib.mk>
@


1.7
log
@Make Makefile.bsd=wrapper match Makefile.in
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.bsd-wrapper,v 1.6 1998/03/08 21:09:24 millert Exp $
@


1.6
log
@In "make includes" don't try to install a file called '*.h'
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.bsd-wrapper,v 1.5 1998/03/07 19:14:30 millert Exp $
d14 7
a20 1
		iopopen.c ioungetc.c
a26 4
STDIO_WRAP_SRCS=iofdopen.c iofflush.c iofgets.c iofopen.c iofprintf.c \
		iofputs.c iofwrite.c iogets.c ioperror.c ioputs.c ioscanf.c \
		iosetbuffer.c iosetvbuf.c  iosprintf.c iosscanf.c ioftell.c \
		iovsprintf.c iovsscanf.c
d28 1
a28 1
LIBIO_SRCS=	$(IO_SRCS) $(STDIO_WRAP_SRCS) $(OSPRIM_SRCS) stdfiles.c
@


1.5
log
@add dummy.h to CLEANFILES
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.bsd-wrapper,v 1.4 1998/03/03 21:41:37 millert Exp $
d72 5
a76 3
		cmp -s $$i $(DESTDIR)/usr/include/g++/$$i || \
	install -c -o $(BINOWN) -g $(BINGRP) -m $(NONBINMODE) \
		 $$i $(DESTDIR)/usr/include/g++/$$i; \
d79 5
a83 3
		cmp -s $$i $(DESTDIR)/usr/include/g++/$$i || \
	install -c -o $(BINOWN) -g $(BINGRP) -m $(NONBINMODE) \
		 $$i $(DESTDIR)/usr/include/g++/$$i; \
@


1.4
log
@libg++ 2.8.0 from FSF + changes to build in an OpenBSD environment
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.bsd-wrapper,v 1.3 1996/04/17 08:01:41 deraadt Exp $
d31 1
a31 1
CLEANFILES+=	_G_config.h iostream.list
@


1.3
log
@use sh, not $SHELL.. because the latter might be something like csh
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.bsd-wrapper,v 1.2 1996/03/27 23:00:04 niklas Exp $
d6 1
a6 1
CXXFLAGS+=	-fno-implicit-templates -nostdinc++
d8 1
a8 1
VERSION=	2.7.1
d69 1
a69 1
install: _G_config.h
d81 2
@


1.2
log
@Misc. cleanup, esp. for obj-dirs, DESTDIR compilations and missing
dependencies.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.bsd-wrapper,v 1.1 1996/03/16 05:18:51 etheisen Exp $
d51 1
a51 1
	$(SHELL) $(.CURDIR)/gen-params LIB_VERSION=$(VERSION) $(G_CONFIG_ARGS) >tmp-params.h
@


1.1
log
@Allow native BSD build of libg++ 2.7.1.  This is a complete replacement of
the GNU build procedure, not a wrapper.  Generates standard, profiled,
shared object, and shared library versions of libiberty, libstdc++, and
libg++.  libiberty version 0.0, libstdc++ version 27.1, and libg++ version
27.1.  Requires modification of bsd.subdir.mk pmake include.  Targets
linked with the shared libraries libstdc++ and libg++ will, by default,
automatically be run time linked with libm and libcurses.
@
text
@d1 1
a1 1
#	$OpenBSD$
d70 1
a70 1
	install -d -m 755 -o $(BINOWN) -g $(BINGRP) /usr/include/g++
@

