head	1.2;
access;
symbols
	OPENBSD_2_5:1.1.1.1.0.12
	OPENBSD_2_5_BASE:1.1.1.1
	OPENBSD_2_4:1.1.1.1.0.10
	OPENBSD_2_4_BASE:1.1.1.1
	OPENBSD_2_3:1.1.1.1.0.8
	OPENBSD_2_3_BASE:1.1.1.1
	FSF_2_8_0:1.1.1.1
	OPENBSD_2_2:1.1.1.1.0.6
	OPENBSD_2_2_BASE:1.1.1.1
	OPENBSD_2_1:1.1.1.1.0.4
	OPENBSD_2_1_BASE:1.1.1.1
	OPENBSD_2_0:1.1.1.1.0.2
	OPENBSD_2_0_BASE:1.1.1.1
	FSF_2_7_1:1.1.1.1
	FSF:1.1.1;
locks; strict;
comment	@ * @;


1.2
date	99.05.26.16.34.26;	author espie;	state dead;
branches;
next	1.1;

1.1
date	96.03.15.22.18.01;	author niklas;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	96.03.15.22.18.01;	author niklas;	state Exp;
branches;
next	;


desc
@@


1.2
log
@old libg++, replaced by part of egcs.
@
text
@// This may look like C code, but it is really -*- C++ -*-

/* Manipulate directory entries of a particular file class. */
#ifndef entry_h
#define entry_h 1
#include <std.h>
#include <new.h>
#include "screen.h"

/* Defined in sort.cc. */
void sort (char **base_ptr, int total_elems);

class Entry_Handler
{
  
private:
  /* Initial number of file entries per class. */
  static const int    default_entries;  

               int    max_entry_length; /* Size of largest filename. */
               int    total_entries;    /* Total number of filenames. */
               int    entries;          /* Current number of filenames. */
               char **buf;              /* Buffer containing filenames for this file class. */
  
public:
                      Entry_Handler (void);                     /* Initialize a new file class. */
  int                 entry_number (void);                      /* Current number of entries. */
  void                add_entry (char *entry_name, int length); /* Add an entry to the class. */
  void                sort_entries (void);                      /* Sort entries by filename. */
  void                print_entries (char *class_name);         /* Print file entries. */
};

/* See comments in the .cc file for the following inline functions */

#ifdef __OPTIMIZE__
inline 
Entry_Handler::Entry_Handler (void)
{
  entries = max_entry_length = 0;
  total_entries = default_entries;
  buf = new char *[default_entries];
}

inline int 
Entry_Handler::entry_number (void)
{
  return entries;
}

inline void *
operator new (size_t size, void *orig, int number)
{
  return realloc (orig, size * number);
}

inline void 
Entry_Handler::add_entry (char *entry_name, int length)
{
  if (entries >= total_entries)
#ifdef _G_OLD_PLACEMENT
    buf = new {buf, total_entries *= 2} char *;
#else
    buf = new (buf, total_entries *= 2) char *;
#endif
#if defined (__GNUG__) && ! defined (__STRICT_ANSI__)
  max_entry_length >?= length;
#else
  if (length > max_entry_length)
    max_entry_length = length;
#endif
  buf[entries++] = strcpy (new char[length + 1], entry_name);
}

inline void 
Entry_Handler::sort_entries (void)
{
  sort (buf, entries);
}

#endif // __OPTIMIZE__
#endif
@


1.1
log
@Initial revision
@
text
@@


1.1.1.1
log
@Import of GNU libg++ 2.7.1 port (prepared by Erik Theisen)
@
text
@@

