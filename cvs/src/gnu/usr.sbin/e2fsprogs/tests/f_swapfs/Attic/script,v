head	1.2;
access;
symbols
	OPENBSD_2_3:1.1.1.1.0.4
	OPENBSD_2_3_BASE:1.1.1.1
	OPENBSD_2_2:1.1.1.1.0.2
	OPENBSD_2_2_BASE:1.1.1.1
	E2FSPROGS110:1.1.1.1
	E2FSPROGS:1.1.1;
locks; strict;
comment	@# @;


1.2
date	98.07.07.18.32.02;	author art;	state dead;
branches;
next	1.1;

1.1
date	97.06.14.07.18.53;	author downsj;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	97.06.14.07.18.53;	author downsj;	state Exp;
branches;
next	;


desc
@@


1.2
log
@old, big, not compiled and not used, die
@
text
@IMAGE=$test_dir/image.gz
VERIFY_FSCK_OPT=-yf
SWAP_FSCK_OPT=-Sy
NATIVE_FSCK_OPT=-sy
OUT=$test_name.log
EXP=$test_dir/expect

gunzip < $IMAGE > $TMPFILE

echo "Swapfs test" > $OUT

echo e2fsck $VERIFY_FSCK_OPT -N test_filesys > $OUT.new
$FSCK $VERIFY_FSCK_OPT -N test_filesys $TMPFILE >> $OUT.new 2>&1
status=$?
echo Exit status is $status >> $OUT.new
sed -e '2d' $OUT.new >> $OUT

echo e2fsck $SWAP_FSCK_OPT -N test_filesys > $OUT.new
$FSCK $SWAP_FSCK_OPT -N test_filesys $TMPFILE >> $OUT.new 2>&1
status=$?
echo Exit status is $status >> $OUT.new
sed -e '2d' $OUT.new >> $OUT

echo Running debugfs.... >> $OUT
$DEBUGFS -f $test_dir/debugfs.cmd $TMPFILE >> $OUT 2>&1
status=$?
echo Exit status is $status >> $OUT

echo e2fsck $VERIFY_FSCK_OPT -N test_filesys > $OUT.new
$FSCK $VERIFY_FSCK_OPT -N test_filesys $TMPFILE >> $OUT.new 2>&1
status=$?
echo Exit status is $status >> $OUT.new
sed -e '2d' $OUT.new >> $OUT

echo e2fsck $NATIVE_FSCK_OPT -N test_filesys > $OUT.new
$FSCK $NATIVE_FSCK_OPT -N test_filesys $TMPFILE >> $OUT.new 2>&1
status=$?
echo Exit status is $status >> $OUT.new
sed -e '2d' $OUT.new >> $OUT

echo Running debugfs.... >> $OUT
$DEBUGFS -f $test_dir/debugfs.cmd $TMPFILE >> $OUT 2>&1
status=$?
echo Exit status is $status >> $OUT

echo e2fsck $VERIFY_FSCK_OPT -N test_filesys > $OUT.new
$FSCK $VERIFY_FSCK_OPT -N test_filesys $TMPFILE >> $OUT.new 2>&1
status=$?
echo Exit status is $status >> $OUT.new
sed -e '2d' $OUT.new >> $OUT
rm -f $OUT.new

rm $TMPFILE

#
# Do the verification
#

rm -f $test_name.ok $test_name.failed
cmp -s $OUT $EXP
status=$?

if [ "$status" = 0 ] ; then
	echo "ok"
	touch $test_name.ok
else
	echo "failed"
	diff -c $EXP $OUT > $test_name.failed
fi

unset IMAGE VERIFY_FSCK_OPT SWAP_FSCK_OPT NATIVE_FSCK_OPT OUT EXP 
@


1.1
log
@Initial revision
@
text
@@


1.1.1.1
log
@Initial import of (unmodifed) e2fsprogs 1.10.
@
text
@@
