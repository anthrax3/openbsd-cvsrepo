head	1.7;
access;
symbols
	OPENBSD_5_6:1.6.0.6
	OPENBSD_5_6_BASE:1.6
	OPENBSD_5_5:1.6.0.4
	OPENBSD_5_5_BASE:1.6
	OPENBSD_5_4:1.5.0.28
	OPENBSD_5_4_BASE:1.5
	OPENBSD_5_3:1.5.0.26
	OPENBSD_5_3_BASE:1.5
	OPENBSD_5_2:1.5.0.24
	OPENBSD_5_2_BASE:1.5
	OPENBSD_5_1_BASE:1.5
	OPENBSD_5_1:1.5.0.22
	OPENBSD_5_0:1.5.0.20
	OPENBSD_5_0_BASE:1.5
	OPENBSD_4_9:1.5.0.18
	OPENBSD_4_9_BASE:1.5
	OPENBSD_4_8:1.5.0.16
	OPENBSD_4_8_BASE:1.5
	OPENBSD_4_7:1.5.0.12
	OPENBSD_4_7_BASE:1.5
	OPENBSD_4_6:1.5.0.14
	OPENBSD_4_6_BASE:1.5
	OPENBSD_4_5:1.5.0.10
	OPENBSD_4_5_BASE:1.5
	OPENBSD_4_4:1.5.0.8
	OPENBSD_4_4_BASE:1.5
	OPENBSD_4_3:1.5.0.6
	OPENBSD_4_3_BASE:1.5
	OPENBSD_4_2:1.5.0.4
	OPENBSD_4_2_BASE:1.5
	OPENBSD_4_1:1.5.0.2
	OPENBSD_4_1_BASE:1.5
	OPENBSD_4_0:1.4.0.10
	OPENBSD_4_0_BASE:1.4
	OPENBSD_3_9:1.4.0.8
	OPENBSD_3_9_BASE:1.4
	OPENBSD_3_8:1.4.0.6
	OPENBSD_3_8_BASE:1.4
	OPENBSD_3_7:1.4.0.4
	OPENBSD_3_7_BASE:1.4
	OPENBSD_3_6:1.4.0.2
	OPENBSD_3_6_BASE:1.4
	OPENBSD_3_5:1.3.0.6
	OPENBSD_3_5_BASE:1.3
	OPENBSD_3_4:1.3.0.4
	OPENBSD_3_4_BASE:1.3
	OPENBSD_3_3:1.3.0.2
	OPENBSD_3_3_BASE:1.3
	OPENBSD_3_2:1.2.0.2
	OPENBSD_3_2_BASE:1.2
	OPENBSD_3_1:1.1.1.1.0.4
	OPENBSD_3_1_BASE:1.1.1.1
	OPENBSD_3_0:1.1.1.1.0.2
	OPENBSD_3_0_BASE:1.1.1.1
	SENDMAIL_8_12_0:1.1.1.1
	SENDMAIL_INC:1.1.1;
locks; strict;
comment	@# @;
expand	@o@;


1.7
date	2014.09.17.18.49.50;	author matthieu;	state dead;
branches;
next	1.6;
commitid	M7i5giHIoz3DMlTU;

1.6
date	2014.02.07.21.24.59;	author millert;	state Exp;
branches;
next	1.5;

1.5
date	2007.02.04.13.17.35;	author millert;	state Exp;
branches;
next	1.4;

1.4
date	2004.06.24.03.59.25;	author millert;	state Exp;
branches;
next	1.3;

1.3
date	2003.03.29.19.44.00;	author millert;	state Exp;
branches;
next	1.2;

1.2
date	2002.04.18.00.49.27;	author millert;	state Exp;
branches;
next	1.1;

1.1
date	2001.09.11.18.55.52;	author millert;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2001.09.11.18.55.52;	author millert;	state Exp;
branches;
next	;


desc
@@


1.7
log
@Bye.
@
text
@<HTML>
<HEAD><TITLE>Installation and Configuration</TITLE>
</HEAD>
<BODY>
<!--
$Sendmail: installation.html,v 1.24 2013/11/22 20:51:39 ca Exp $
-->
<H1>Installation</H1>
<H2>Contents</H2>
<UL>
    <LI><A href="#compile">Compiling and Installing Your Filter</A>
    <LI><A href="#config">Configuring Sendmail</A>
</UL>

<H2><A name="compile">Compiling and Installing Your Filter</A></H2>

To compile a filter, modify the Makefile provided with the sample program, or:
<UL>
    <LI>Put the include and Sendmail directories in your include path
    (e.g. -I/path/to/include -I/path/to/sendmail).  

    <LI>Make sure libmilter.a is in your library path, and link your
    application with it (e.g. "-lmilter").

    <LI>Compile with pthreads, either by using -pthread for gcc, or
    linking with a pthreads support library (-lpthread).
</UL>
Your compile command line will look like
<PRE>
cc -I/path/to/include -I/path/to/sendmail -c myfile.c
</PRE>
and your linking command line will look something like
<PRE>
cc -o myfilter [object-files] -L[library-location] -lmilter -pthread
</PRE>

<H2><A name="config">Configuring Sendmail</A></H2>

If you use a sendmail version older than 8.13 please see
the instructions for your version.
The default compilation options for sendmail enable support
for milters since 8.13.

<P>
Next, you must add the desired filters to your sendmail configuration
(.mc) file.
Mail filters have three equates:
The required <CODE>S=</CODE> equate specifies the socket where
sendmail should look for the filter; the optional <CODE>F=</CODE> and
<CODE>T=</CODE> equates specify flags and timeouts, respectively.
All equates names, equate field names, and flag values are case sensitive.

<P>
The current flags (<CODE>F=</CODE>) are:
<P>
<TABLE cellspacing="1" cellpadding=4 border=1>
<TR bgcolor="#dddddd" align=left valign=top>
<TH>Flag</TH>   <TH align="center">Meaning</TH>
</TR>
<TR align="left" valign=top>
<TD>R</TD>      <TD>Reject connection if filter unavailable</TD>
</TR>
<TR align="left" valign=top>
<TD>T</TD>      <TD>Temporary fail connection if filter unavailable</TD>
</TR>
</TABLE>

If a filter is unavailable or unresponsive and no flags have been
specified, the MTA will continue normal handling of the current
connection.
The MTA will try to contact the filter again on each new connection.

<P>
There are three fields inside of the <CODE>T=</CODE> equate: S, R, and E.
Note the separator between each is a ";" (semicolon), as ","
(comma) already separates equates.
The value of each field is a decimal number followed by a single letter
designating the units ("s" for seconds, "m" for minutes).
The fields have the following meanings:
<P>
<TABLE cellspacing="1" cellpadding=4 border=1>
<TR bgcolor="#dddddd" align=left valign=top>
<TH>Flag</TH>   <TH align="center">Meaning</TH>
</TR>
<TR align="left" valign=top>
<TD>C</TD>      <TD>Timeout for connecting to a filter.  If set to 0, the
		system's <CODE>connect(2)</CODE> timeout will be used.
		Default: 5m</TD>
</TR>
<TR align="left" valign=top>
<TD>S</TD>      <TD>Timeout for sending information from the MTA to a
                filter.  Default: 10s</TD>
</TR>
<TR align="left" valign=top>
<TD>R</TD>      <TD>Timeout for reading reply from the filter.  Default: 10s</TD>
</TR>
<TR align="left" valign=top>
<TD>E</TD>      <TD>Overall timeout between sending end-of-message to
                filter and waiting for the final acknowledgment.  Default: 5m</TD>
</TR>
</TABLE>

<P>
The following sendmail.mc example specifies three filters.
The first two rendezvous on Unix-domain sockets in the /var/run directory;
the third uses an IP socket on port 999.
<PRE>
	INPUT_MAIL_FILTER(`filter1', `S=unix:/var/run/f1.sock, F=R')
	INPUT_MAIL_FILTER(`filter2', `S=unix:/var/run/f2.sock, F=T, T=S:1s;R:1s;E:5m')
	INPUT_MAIL_FILTER(`filter3', `S=inet:999@@localhost, T=C:2m')

	define(`confINPUT_MAIL_FILTERS', `filter2,filter1,filter3')
<HR width="30%">
	m4 ../m4/cf.m4 myconfig.mc &gt; myconfig.cf
</PRE>
By default, the filters would be run in the order declared,
i.e. "filter1, filter2, filter3"; however, since
<CODE>confINPUT_MAIL_FILTERS</CODE> is defined, the filters will be
run "filter2, filter1, filter3".
Also note that a filter can be defined
without adding it to the input filter list by using
MAIL_FILTER() instead of INPUT_MAIL_FILTER().

<P>
The above macros will result in the following lines being added to
your .cf file:
<PRE>
        Xfilter1, S=unix:/var/run/f1.sock, F=R
        Xfilter2, S=unix:/var/run/f2.sock, F=T, T=S:1s;R:1s;E:5m
        Xfilter3, S=inet:999@@localhost, T=C:2m

        O InputMailFilters=filter2,filter1,filter3
</PRE>
<P>
Finally, the sendmail macros accessible via
<A HREF="smfi_getsymval.html">smfi_getsymval</A> can be configured by
defining the following m4 variables (or cf options):
<TABLE cellspacing="1" cellpadding=4 border=1>
<TR bgcolor="#dddddd" align=left valign=top>
<TH align="center">In .mc file</TH>   <TH align="center">In .cf file</TH>
<TH align="center">Default Value</TH>
</TR>
<TR><TD>confMILTER_MACROS_CONNECT</TD><TD>Milter.macros.connect</TD>
<TD><CODE>j, _, {daemon_name}, {if_name}, {if_addr}</CODE></TD></TR>
<TR><TD>confMILTER_MACROS_HELO</TD><TD>Milter.macros.helo</TD>
<TD><CODE>{tls_version}, {cipher}, {cipher_bits}, {cert_subject},
{cert_issuer}</CODE></TD></TR>
<TR><TD>confMILTER_MACROS_ENVFROM</TD><TD>Milter.macros.envfrom</TD>
<TD><CODE>i, {auth_type}, {auth_authen}, {auth_ssf}, {auth_author},
{mail_mailer}, {mail_host}, {mail_addr}</CODE></TD></TR>
<TR><TD>confMILTER_MACROS_ENVRCPT</TD><TD>Milter.macros.envrcpt</TD>
<TD><CODE>{rcpt_mailer}, {rcpt_host}, {rcpt_addr}</CODE></TD></TR>
</TABLE>
For information about available macros and their meanings, please
consult the sendmail documentation.
<HR size="1">
<FONT size="-1">
Copyright (c) 2000-2003, 2006 Proofpoint, Inc. and its suppliers.
All rights reserved.
<BR>
By using this file, you agree to the terms and conditions set
forth in the LICENSE.
</FONT>
</BODY>
</HTML>
@


1.6
log
@Update to sendmail 8.14.8.  This touches a lot of files due to the
Sendmail, Inc -> Proofpoint name change.  See RELEASE_NOTES for
actual changes.
@
text
@@


1.5
log
@Update to sendmail-8.14.0.  OK mbalmer@@
@
text
@d6 1
a6 1
$Sendmail: installation.html,v 1.23 2006/08/31 17:16:03 ca Exp $
d158 1
a158 1
Copyright (c) 2000-2003, 2006 Sendmail, Inc. and its suppliers.
@


1.4
log
@Update to sendmail.8.13.0
@
text
@d1 4
a4 4
<html>
<head><title>Installation and Configuration</title>
</head>
<body>
d6 1
a6 1
$Sendmail: installation.html,v 1.20 2003/03/05 19:57:54 ca Exp $
d8 6
a13 6
<h1>Installation</h1>
<h2>Contents</h2>
<ul>
    <li><a href="#compile">Compiling and Installing Your Filter</a>
    <li><a href="#config">Configuring Sendmail</a>
</ul>
d15 1
a15 1
<h2><a name="compile">Compiling and Installing Your Filter</A></h2>
d18 2
a19 2
<ul>
    <li>Put the include and Sendmail directories in your include path
d22 1
a22 1
    <li>Make sure libmilter.a is in your library path, and link your
d25 1
a25 1
    <li>Compile with pthreads, either by using -pthread for gcc, or
d27 1
a27 1
</ul>
d29 1
a29 1
<pre>
d31 1
a31 1
</pre>
d33 1
a33 1
<pre>
d35 1
a35 1
</pre>
d37 1
a37 1
<H2><a name="config">Configuring Sendmail</A></H2>
d39 1
a39 2
First, you must compile sendmail with MILTER defined.
If you use a sendmail version older than 8.12 please see
d41 2
a42 7
To do this, add the following lines to your build
configuration file (devtools/Site/config.site.m4)
<pre>
APPENDDEF(`conf_sendmail_ENVDEF', `-DMILTER')
</pre>

then type <code>./Build -c</code> in your sendmail directory.
d48 4
a51 4
The required <code>S=</code> equate specifies the socket where
sendmail should look for the filter; The optional <code>F=</code> and
<code>T=</code> equates specify flags and timeouts, respectively.  All
equates names, equate field names, and flag values are case sensitive.
d54 5
a58 5
The current flags (<code>F=</code>) are:
<p>
<table cellspacing="1" cellpadding=4 border=1>
<tr bgcolor="#dddddd" align=left valign=top>
<th>Flag</TH>   <th align="center">Meaning</TH>
d60 1
a60 1
<tr align="left" valign=top>
d63 1
a63 1
<tr align="left" valign=top>
a69 1
connection.  The MTA will try to contact the filter again on each new
d71 1
d74 7
a80 7
There are three fields inside of the <code>T=</code> equate: S, R, and
E.  Note the separator between each is a ";" (semicolon), as ","
(comma) already separates equates.  The value of each field is a
decimal number followed by a single letter designating the units ("s"
for seconds, "m" for minutes).  The fields have the following
meanings:
<p>
d87 1
a87 1
		system's <CODE>connect()</CODE> timeout will be used.
d103 5
a107 5
<p>
The following sendmail.mc example specifies three filters.  The first
two rendezvous on Unix-domain sockets in the /var/run directory; the
third uses an IP socket on port 999.
<pre>
d113 1
a113 1
<hr width="30%">
d115 1
a115 1
</pre>
d118 4
a121 3
<code>confINPUT_MAIL_FILTERS</code> is defined, the filters will be
run "filter2, filter1, filter3".  Also note that a filter can be
defined without adding it to the input filter list by using
d124 1
a124 1
<p>
d134 3
a136 3
<p>
Finally, the sendmail macros accessible via <a
href="smfi_getsymval.html">smfi_getsymval</a> can be configured by
d138 16
a153 16
<table cellspacing="1" cellpadding=4 border=1>
<tr bgcolor="#dddddd" align=left valign=top>
<th align="center">In .mc file</th>   <th align="center">In .cf file</TH>
<th align="center">Default Value</th>
</tr>
<tr><td>confMILTER_MACROS_CONNECT</td><td>Milter.macros.connect</td>
<td><code>j, _, {daemon_name}, {if_name}, {if_addr}</code></td></tr>
<tr><td>confMILTER_MACROS_HELO</td><td>Milter.macros.helo</td>
<td><code>{tls_version}, {cipher}, {cipher_bits}, {cert_subject},
{cert_issuer}</code></td></tr>
<tr><td>confMILTER_MACROS_ENVFROM</td><td>Milter.macros.envfrom</td>
<td><code>i, {auth_type}, {auth_authen}, {auth_ssf}, {auth_author},
{mail_mailer}, {mail_host}, {mail_addr}</code></td></tr>
<tr><td>confMILTER_MACROS_ENVRCPT</td><td>Milter.macros.envrcpt</td>
<td><code>{rcpt_mailer}, {rcpt_host}, {rcpt_addr}</code></td></tr>
</table>
d156 3
a158 3
<hr size="1">
<font size="-1">
Copyright (c) 2000-2003 Sendmail, Inc. and its suppliers.
d160 1
a160 1
<br>
d163 3
a165 2
</font>
</body> </html>
@


1.3
log
@Update to sendmail 8.12.9; fixes a buffer overflow in address parsing
due to a char to int conversion problem which is potentially remotely
exploitable.
@
text
@d5 3
@


1.2
log
@update to sendmail 8.12.3
@
text
@d19 1
a19 1
    <li>Make sure libmilter.so is in your library path, and link your
a33 4
<p>
To run the filter, the Milter shared library must be available to the
run-time linker.

d160 1
a160 1
Copyright (c) 2000-2002 Sendmail, Inc. and its suppliers.
d164 1
a164 1
forth in the <a href="LICENSE.txt">LICENSE</a>.
@


1.1
log
@Initial revision
@
text
@d40 4
a43 2
First, you must compile sendmail versions before 8.12 with _FFR_MILTER
defined.  To do this, add the following lines to your build
d46 1
a46 2
APPENDDEF(`conf_sendmail_ENVDEF', `-D_FFR_MILTER=1')
APPENDDEF(`conf_libmilter_ENVDEF', `-D_FFR_MILTER=1') 
d53 2
a54 2
(.mc) file.  With versions before 8.12, the file must then be
processed with _FFR_MILTER defined.  Mail filters have three equates:
d121 1
a121 1
	m4 <b>-D_FFR_MILTER</b> ../m4/cf.m4 myconfig.mc &gt; myconfig.cf
d164 1
a164 1
Copyright (c) 2000-2001 Sendmail, Inc. and its suppliers.
@


1.1.1.1
log
@sendmail 8.12.0 with $Id tags converted to $Sendmail
@
text
@@
