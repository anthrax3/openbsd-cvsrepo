head	1.6;
access;
symbols
	OPENBSD_5_6:1.5.0.6
	OPENBSD_5_6_BASE:1.5
	OPENBSD_5_5:1.5.0.4
	OPENBSD_5_5_BASE:1.5
	OPENBSD_5_4:1.4.0.36
	OPENBSD_5_4_BASE:1.4
	OPENBSD_5_3:1.4.0.34
	OPENBSD_5_3_BASE:1.4
	OPENBSD_5_2:1.4.0.32
	OPENBSD_5_2_BASE:1.4
	OPENBSD_5_1_BASE:1.4
	OPENBSD_5_1:1.4.0.30
	OPENBSD_5_0:1.4.0.28
	OPENBSD_5_0_BASE:1.4
	OPENBSD_4_9:1.4.0.26
	OPENBSD_4_9_BASE:1.4
	OPENBSD_4_8:1.4.0.24
	OPENBSD_4_8_BASE:1.4
	OPENBSD_4_7:1.4.0.20
	OPENBSD_4_7_BASE:1.4
	OPENBSD_4_6:1.4.0.22
	OPENBSD_4_6_BASE:1.4
	OPENBSD_4_5:1.4.0.18
	OPENBSD_4_5_BASE:1.4
	OPENBSD_4_4:1.4.0.16
	OPENBSD_4_4_BASE:1.4
	OPENBSD_4_3:1.4.0.14
	OPENBSD_4_3_BASE:1.4
	OPENBSD_4_2:1.4.0.12
	OPENBSD_4_2_BASE:1.4
	OPENBSD_4_1:1.4.0.10
	OPENBSD_4_1_BASE:1.4
	OPENBSD_4_0:1.4.0.8
	OPENBSD_4_0_BASE:1.4
	OPENBSD_3_9:1.4.0.6
	OPENBSD_3_9_BASE:1.4
	OPENBSD_3_8:1.4.0.4
	OPENBSD_3_8_BASE:1.4
	OPENBSD_3_7:1.4.0.2
	OPENBSD_3_7_BASE:1.4
	OPENBSD_3_6:1.3.0.14
	OPENBSD_3_6_BASE:1.3
	OPENBSD_3_5:1.3.0.12
	OPENBSD_3_5_BASE:1.3
	OPENBSD_3_4:1.3.0.8
	OPENBSD_3_4_BASE:1.3
	OPENBSD_3_3:1.3.0.10
	OPENBSD_3_3_BASE:1.3
	OPENBSD_3_2:1.3.0.6
	OPENBSD_3_2_BASE:1.3
	OPENBSD_3_1:1.3.0.4
	OPENBSD_3_1_BASE:1.3
	OPENBSD_3_0:1.3.0.2
	OPENBSD_3_0_BASE:1.3
	SENDMAIL_8_12_0:1.1.1.3
	OPENBSD_2_9:1.2.0.2
	OPENBSD_2_9_BASE:1.2
	SENDMAIL_8_11_2:1.1.1.2
	OPENBSD_2_8:1.1.1.1.0.4
	OPENBSD_2_8_BASE:1.1.1.1
	OPENBSD_2_7:1.1.1.1.0.2
	OPENBSD_2_7_BASE:1.1.1.1
	SENDMAIL_8_10_0:1.1.1.1
	SENDMAIL_INC:1.1.1;
locks; strict;
comment	@# @;


1.6
date	2014.09.17.18.49.49;	author matthieu;	state dead;
branches;
next	1.5;
commitid	M7i5giHIoz3DMlTU;

1.5
date	2014.02.07.21.24.58;	author millert;	state Exp;
branches;
next	1.4;

1.4
date	2004.12.16.00.21.29;	author millert;	state Exp;
branches;
next	1.3;

1.3
date	2001.09.11.19.02.48;	author millert;	state Exp;
branches;
next	1.2;

1.2
date	2001.01.15.21.08.57;	author millert;	state Exp;
branches;
next	1.1;

1.1
date	2000.04.02.19.05.56;	author millert;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2000.04.02.19.05.56;	author millert;	state Exp;
branches
	1.1.1.1.4.1;
next	1.1.1.2;

1.1.1.2
date	2001.01.15.20.52.33;	author millert;	state Exp;
branches;
next	1.1.1.3;

1.1.1.3
date	2001.09.11.18.55.52;	author millert;	state Exp;
branches;
next	;

1.1.1.1.4.1
date	2001.05.31.00.26.20;	author miod;	state Exp;
branches;
next	;


desc
@@


1.6
log
@Bye.
@
text
@PUSHDIVERT(-1)
#
# Copyright (c) 1998-2000, 2004 Proofpoint, Inc. and its suppliers.
#	All rights reserved.
# Copyright (c) 1983 Eric P. Allman.  All rights reserved.
# Copyright (c) 1988, 1993
#	The Regents of the University of California.  All rights reserved.
#
# By using this file, you agree to the terms and conditions set
# forth in the LICENSE file which can be found at the top level of
# the sendmail distribution.
#
#
_DEFIFNOT(`_DEF_LOCAL_MAILER_FLAGS', `lsDFMAw5:/|@@q')
_DEFIFNOT(`LOCAL_MAILER_FLAGS', `Prmn9')
ifdef(`LOCAL_MAILER_PATH',, `define(`LOCAL_MAILER_PATH', /bin/mail)')
ifdef(`LOCAL_MAILER_ARGS',, `define(`LOCAL_MAILER_ARGS', `mail -d $u')')
ifdef(`LOCAL_MAILER_DSN_DIAGNOSTIC_CODE',, `define(`LOCAL_MAILER_DSN_DIAGNOSTIC_CODE', `X-Unix')')
_DEFIFNOT(`_DEF_LOCAL_SHELL_FLAGS', `lsDFMoq')
_DEFIFNOT(`LOCAL_SHELL_FLAGS', `eu9')
ifdef(`LOCAL_SHELL_PATH',, `define(`LOCAL_SHELL_PATH', /bin/sh)')
ifdef(`LOCAL_SHELL_ARGS',, `define(`LOCAL_SHELL_ARGS', `sh -c $u')')
ifdef(`LOCAL_SHELL_DIR',, `define(`LOCAL_SHELL_DIR', `$z:/')')
define(`LOCAL_RWR', `ifdef(`_LOCAL_LMTP_',
`S=EnvFromSMTP/HdrFromL, R=EnvToL/HdrToL',
`S=EnvFromL/HdrFromL, R=EnvToL/HdrToL')')
define(`_LOCAL_QGRP', `ifelse(defn(`LOCAL_MAILER_QGRP'),`',`', ` Q=LOCAL_MAILER_QGRP,')')dnl
define(`_PROG_QGRP', `ifelse(defn(`LOCAL_PROG_QGRP'),`',`', ` Q=LOCAL_PROG_QGRP,')')dnl
POPDIVERT

##################################################
###   Local and Program Mailer specification   ###
##################################################

VERSIONID(`$Sendmail: local.m4,v 8.60 2013/11/22 20:51:14 ca Exp $')

#
#  Envelope sender rewriting
#
SEnvFromL
R<@@>			$n			errors to mailer-daemon
R@@ <@@ $*>		$n			temporarily bypass Sun bogosity
R$+			$: $>AddDomain $1	add local domain if needed
ifdef(`_LOCAL_NO_MASQUERADE_', `dnl', `dnl
R$*			$: $>MasqEnv $1		do masquerading')

#
#  Envelope recipient rewriting
#
SEnvToL
R$+ < @@ $* >		$: $1			strip host part
ifdef(`confUSERDB_SPEC', `dnl', `dnl
R$+ + $*		$: < $&{addr_type} > $1 + $2	mark with addr type
R<e s> $+ + $*		$: $1			remove +detail for sender
R< $* > $+		$: $2			else remove mark')

#
#  Header sender rewriting
#
SHdrFromL
R<@@>			$n			errors to mailer-daemon
R@@ <@@ $*>		$n			temporarily bypass Sun bogosity
R$+			$: $>AddDomain $1	add local domain if needed
ifdef(`_LOCAL_NO_MASQUERADE_', `dnl', `dnl
R$*			$: $>MasqHdr $1		do masquerading')

#
#  Header recipient rewriting
#
SHdrToL
R$+			$: $>AddDomain $1	add local domain if needed
ifdef(`_ALL_MASQUERADE_', `dnl
ifdef(`_LOCAL_NO_MASQUERADE_', `dnl', `dnl
R$*			$: $>MasqHdr $1		do all-masquerading')',
`R$* < @@ *LOCAL* > $*	$: $1 < @@ $j . > $2')

#
#  Common code to add local domain name (only if always-add-domain)
#
SAddDomain
ifdef(`_ALWAYS_ADD_DOMAIN_', `dnl
R$* < @@ $* > $* 	$@@ $1 < @@ $2 > $3	already fully qualified
ifelse(len(X`'_ALWAYS_ADD_DOMAIN_),`1',`
R$+			$@@ $1 < @@ *LOCAL* >	add local qualification',
`R$+			$@@ $1 < @@ _ALWAYS_ADD_DOMAIN_ >	add qualification')',
`dnl')

Mlocal,		P=LOCAL_MAILER_PATH, F=_MODMF_(CONCAT(_DEF_LOCAL_MAILER_FLAGS, LOCAL_MAILER_FLAGS), `LOCAL'), LOCAL_RWR,_OPTINS(`LOCAL_MAILER_EOL', ` E=', `, ')
		_OPTINS(`LOCAL_MAILER_MAX', `M=', `, ')_OPTINS(`LOCAL_MAILER_MAXMSGS', `m=', `, ')_OPTINS(`LOCAL_MAILER_MAXRCPTS', `r=', `, ')_OPTINS(`LOCAL_MAILER_CHARSET', `C=', `, ')T=DNS/RFC822/LOCAL_MAILER_DSN_DIAGNOSTIC_CODE,_LOCAL_QGRP
		A=LOCAL_MAILER_ARGS
Mprog,		P=LOCAL_SHELL_PATH, F=_MODMF_(CONCAT(_DEF_LOCAL_SHELL_FLAGS, LOCAL_SHELL_FLAGS), `SHELL'), S=EnvFromL/HdrFromL, R=EnvToL/HdrToL, D=LOCAL_SHELL_DIR,
		_OPTINS(`LOCAL_MAILER_MAX', `M=', `, ')T=X-Unix/X-Unix/X-Unix,_PROG_QGRP
		A=LOCAL_SHELL_ARGS
@


1.5
log
@Update to sendmail 8.14.8.  This touches a lot of files due to the
Sendmail, Inc -> Proofpoint name change.  See RELEASE_NOTES for
actual changes.
@
text
@@


1.4
log
@Update to sendmail-8.13.2
@
text
@d3 1
a3 1
# Copyright (c) 1998-2000, 2004 Sendmail, Inc. and its suppliers.
d35 1
a35 1
VERSIONID(`$Sendmail: local.m4,v 8.59 2004/11/23 00:37:25 ca Exp $')
@


1.3
log
@merge in sendmail 8.12.0 with BSD Makefiles and mdoc man pages
@
text
@d3 1
a3 1
# Copyright (c) 1998-2000 Sendmail, Inc. and its suppliers.
d35 1
a35 1
VERSIONID(`$Sendmail: local.m4,v 8.58 2000/10/26 01:58:29 ca Exp $')
d91 1
a91 1
Mprog,		P=LOCAL_SHELL_PATH, F=CONCAT(_DEF_LOCAL_SHELL_FLAGS, LOCAL_SHELL_FLAGS), S=EnvFromL/HdrFromL, R=EnvToL/HdrToL, D=LOCAL_SHELL_DIR,
@


1.2
log
@sendmail 8.11.2 with BSD Makefiles
@
text
@d24 5
d35 1
a35 1
VERSIONID(`$Sendmail: local.m4,v 8.50.16.2 2000/09/17 17:04:22 gshapiro Exp $')
d40 1
a40 1
SEnvFromL=10
d44 2
a45 1
R$*			$: $>MasqEnv $1		do masquerading
d50 1
a50 1
SEnvToL=20
d52 1
a52 3
ifdef(`_FFR_ADDR_TYPE', `dnl
ifdef(`confUSERDB_SPEC', `dnl',
`dnl Do not forget to bump V9 to V10 before removing _FFR_ADDR_TYPE check
d55 1
a55 1
R< $* > $+		$: $2			else remove mark')', `dnl')
d60 1
a60 1
SHdrFromL=30
d64 2
a65 1
R$*			$: $>MasqHdr $1		do masquerading
d70 1
a70 1
SHdrToL=40
d72 3
a74 2
ifdef(`_ALL_MASQUERADE_',
`R$*			$: $>MasqHdr $1		do all-masquerading',
d80 1
a80 1
SAddDomain=50
d83 1
d85 1
d88 2
a89 2
Mlocal,		P=LOCAL_MAILER_PATH, F=_MODMF_(CONCAT(_DEF_LOCAL_MAILER_FLAGS, LOCAL_MAILER_FLAGS), `LOCAL'), S=EnvFromL/HdrFromL, R=EnvToL/HdrToL,_OPTINS(`LOCAL_MAILER_EOL', ` E=', `, ')
		_OPTINS(`LOCAL_MAILER_MAX', `M=', `, ')_OPTINS(`LOCAL_MAILER_MAXMSGS', `m=', `, ')_OPTINS(`LOCAL_MAILER_MAXRCPTS', `r=', `, ')_OPTINS(`LOCAL_MAILER_CHARSET', `C=', `, ')T=DNS/RFC822/LOCAL_MAILER_DSN_DIAGNOSTIC_CODE,
d92 1
a92 1
		_OPTINS(`LOCAL_MAILER_MAX', `M=', `, ')T=X-Unix/X-Unix/X-Unix,
@


1.1
log
@Initial revision
@
text
@d3 1
a3 1
# Copyright (c) 1998, 1999 Sendmail, Inc. and its suppliers.
d30 1
a30 1
VERSIONID(`$Sendmail: local.m4,v 8.50 1999/11/21 19:02:08 ca Exp $')
d81 1
a81 1
		_OPTINS(`LOCAL_MAILER_MAX', `M=', `, ')_OPTINS(`LOCAL_MAILER_MAXMSGS', `m=', `, ')_OPTINS(`LOCAL_MAILER_CHARSET', `C=', `, ')T=DNS/RFC822/LOCAL_MAILER_DSN_DIAGNOSTIC_CODE,
@


1.1.1.1
log
@stock sendmail 8.10.0 with $Id -> $Sendmail
@
text
@@


1.1.1.1.4.1
log
@Pull in patch from current:
Errata(028):
The signal handlers in sendmail contain code that is unsafe in the
context of a signal handler.  This leads to potentially serious race
conditions.  At the moment this is a theoretical attack only and can
only be exploited on the local host (if at all).
Fix(millert):
Update to sendmail 8.11.4:
8.11.4 revamps signal handling within the MTA in order to reduce
the likelihood of a race condition that can lead to heap
corruption as described in Michal Zalewski's advisory.  The
problems discussed in the advisory are not currently known to
be exploitable but we recommend upgrading to 8.11.4 in case a
method is found to exploit the signal handling race condition.
8.11.4 also fixes other bugs found since the release of 8.11.3.

See the RELEASE_NOTES file for more details.
@
text
@d3 1
a3 1
# Copyright (c) 1998-2000 Sendmail, Inc. and its suppliers.
d30 1
a30 1
VERSIONID(`$Sendmail: local.m4,v 8.50.16.2 2000/09/17 17:04:22 gshapiro Exp $')
d81 1
a81 1
		_OPTINS(`LOCAL_MAILER_MAX', `M=', `, ')_OPTINS(`LOCAL_MAILER_MAXMSGS', `m=', `, ')_OPTINS(`LOCAL_MAILER_MAXRCPTS', `r=', `, ')_OPTINS(`LOCAL_MAILER_CHARSET', `C=', `, ')T=DNS/RFC822/LOCAL_MAILER_DSN_DIAGNOSTIC_CODE,
@


1.1.1.2
log
@sendmail 8.11.2
@
text
@d3 1
a3 1
# Copyright (c) 1998-2000 Sendmail, Inc. and its suppliers.
d30 1
a30 1
VERSIONID(`$Id: local.m4,v 8.50.16.2 2000/09/17 17:04:22 gshapiro Exp $')
d81 1
a81 1
		_OPTINS(`LOCAL_MAILER_MAX', `M=', `, ')_OPTINS(`LOCAL_MAILER_MAXMSGS', `m=', `, ')_OPTINS(`LOCAL_MAILER_MAXRCPTS', `r=', `, ')_OPTINS(`LOCAL_MAILER_CHARSET', `C=', `, ')T=DNS/RFC822/LOCAL_MAILER_DSN_DIAGNOSTIC_CODE,
@


1.1.1.3
log
@sendmail 8.12.0 with $Id tags converted to $Sendmail
@
text
@a23 5
define(`LOCAL_RWR', `ifdef(`_LOCAL_LMTP_',
`S=EnvFromSMTP/HdrFromL, R=EnvToL/HdrToL',
`S=EnvFromL/HdrFromL, R=EnvToL/HdrToL')')
define(`_LOCAL_QGRP', `ifelse(defn(`LOCAL_MAILER_QGRP'),`',`', ` Q=LOCAL_MAILER_QGRP,')')dnl
define(`_PROG_QGRP', `ifelse(defn(`LOCAL_PROG_QGRP'),`',`', ` Q=LOCAL_PROG_QGRP,')')dnl
d30 1
a30 1
VERSIONID(`$Sendmail: local.m4,v 8.58 2000/10/26 01:58:29 ca Exp $')
d35 1
a35 1
SEnvFromL
d39 1
a39 2
ifdef(`_LOCAL_NO_MASQUERADE_', `dnl', `dnl
R$*			$: $>MasqEnv $1		do masquerading')
d44 1
a44 1
SEnvToL
d46 3
a48 1
ifdef(`confUSERDB_SPEC', `dnl', `dnl
d51 1
a51 1
R< $* > $+		$: $2			else remove mark')
d56 1
a56 1
SHdrFromL
d60 1
a60 2
ifdef(`_LOCAL_NO_MASQUERADE_', `dnl', `dnl
R$*			$: $>MasqHdr $1		do masquerading')
d65 1
a65 1
SHdrToL
d67 2
a68 3
ifdef(`_ALL_MASQUERADE_', `dnl
ifdef(`_LOCAL_NO_MASQUERADE_', `dnl', `dnl
R$*			$: $>MasqHdr $1		do all-masquerading')',
d74 1
a74 1
SAddDomain
a76 1
ifelse(len(X`'_ALWAYS_ADD_DOMAIN_),`1',`
a77 1
`R$+			$@@ $1 < @@ _ALWAYS_ADD_DOMAIN_ >	add qualification')',
d80 2
a81 2
Mlocal,		P=LOCAL_MAILER_PATH, F=_MODMF_(CONCAT(_DEF_LOCAL_MAILER_FLAGS, LOCAL_MAILER_FLAGS), `LOCAL'), LOCAL_RWR,_OPTINS(`LOCAL_MAILER_EOL', ` E=', `, ')
		_OPTINS(`LOCAL_MAILER_MAX', `M=', `, ')_OPTINS(`LOCAL_MAILER_MAXMSGS', `m=', `, ')_OPTINS(`LOCAL_MAILER_MAXRCPTS', `r=', `, ')_OPTINS(`LOCAL_MAILER_CHARSET', `C=', `, ')T=DNS/RFC822/LOCAL_MAILER_DSN_DIAGNOSTIC_CODE,_LOCAL_QGRP
d84 1
a84 1
		_OPTINS(`LOCAL_MAILER_MAX', `M=', `, ')T=X-Unix/X-Unix/X-Unix,_PROG_QGRP
@


