head     1.1;
branch   1.1.1;
access   ;
symbols  LLVM_5_0_0:1.1.1.1 LLVM:1.1.1;
locks    ; strict;
comment  @ * @;
expand   @o@;


1.1
date     2017.10.04.20.27.36;  author patrick;  state Exp;
branches 1.1.1.1;
next     ;
commitid        ufzi3t8MqoilCPqO;

1.1.1.1
date     2017.10.04.20.27.36;  author patrick;  state Exp;
branches ;
next     ;
commitid        ufzi3t8MqoilCPqO;


desc
@@



1.1
log
@Initial revision
@
text
@//===-- MachVMMemory.h ------------------------------------------*- C++ -*-===//
//
//                     The LLVM Compiler Infrastructure
//
// This file is distributed under the University of Illinois Open Source
// License. See LICENSE.TXT for details.
//
//===----------------------------------------------------------------------===//
//
//  Created by Greg Clayton on 6/26/07.
//
//===----------------------------------------------------------------------===//

#ifndef __MachVMMemory_h__
#define __MachVMMemory_h__

#include "DNBDefs.h"
#include "DNBError.h"
#include <mach/mach.h>

class MachVMMemory {
public:
  MachVMMemory();
  ~MachVMMemory();
  nub_size_t Read(task_t task, nub_addr_t address, void *data,
                  nub_size_t data_count);
  nub_size_t Write(task_t task, nub_addr_t address, const void *data,
                   nub_size_t data_count);
  nub_size_t PageSize(task_t task);
  nub_bool_t GetMemoryRegionInfo(task_t task, nub_addr_t address,
                                 DNBRegionInfo *region_info);
#if defined(HOST_VM_INFO64_COUNT)
  nub_bool_t GetMemoryProfile(DNBProfileDataScanType scanType, task_t task,
                              struct task_basic_info ti, cpu_type_t cputype,
                              nub_process_t pid, vm_statistics64_data_t &vminfo,
                              uint64_t &physical_memory, mach_vm_size_t &rprvt,
                              mach_vm_size_t &rsize, mach_vm_size_t &vprvt,
                              mach_vm_size_t &vsize, mach_vm_size_t &dirty_size,
                              mach_vm_size_t &purgeable,
                              mach_vm_size_t &anonymous);
#else
  nub_bool_t GetMemoryProfile(DNBProfileDataScanType scanType, task_t task,
                              struct task_basic_info ti, cpu_type_t cputype,
                              nub_process_t pid, vm_statistics_data_t &vminfo,
                              uint64_t &physical_memory, mach_vm_size_t &rprvt,
                              mach_vm_size_t &rsize, mach_vm_size_t &vprvt,
                              mach_vm_size_t &vsize, mach_vm_size_t &dirty_size,
                              mach_vm_size_t &purgeable,
                              mach_vm_size_t &anonymous);
#endif

protected:
  nub_size_t MaxBytesLeftInPage(task_t task, nub_addr_t addr, nub_size_t count);

  uint64_t GetStolenPages(task_t task);
  void GetRegionSizes(task_t task, mach_vm_size_t &rsize,
                      mach_vm_size_t &dirty_size);
  void GetMemorySizes(task_t task, cpu_type_t cputype, nub_process_t pid,
                      mach_vm_size_t &rprvt, mach_vm_size_t &vprvt);

  nub_size_t WriteRegion(task_t task, const nub_addr_t address,
                         const void *data, const nub_size_t data_count);

  vm_size_t m_page_size;
  DNBError m_err;
};

#endif //    #ifndef __MachVMMemory_h__
@


1.1.1.1
log
@Import LLVM 5.0.0 release including clang, lld and lldb.
@
text
@@
