head	1.1;
branch	1.1.1;
access;
symbols
	OPENBSD_6_1:1.1.1.1.0.54
	OPENBSD_6_1_BASE:1.1.1.1
	OPENBSD_6_0:1.1.1.1.0.52
	OPENBSD_6_0_BASE:1.1.1.1
	OPENBSD_5_9:1.1.1.1.0.48
	OPENBSD_5_9_BASE:1.1.1.1
	OPENBSD_5_8:1.1.1.1.0.50
	OPENBSD_5_8_BASE:1.1.1.1
	OPENBSD_5_7:1.1.1.1.0.42
	OPENBSD_5_7_BASE:1.1.1.1
	OPENBSD_5_6:1.1.1.1.0.46
	OPENBSD_5_6_BASE:1.1.1.1
	OPENBSD_5_5:1.1.1.1.0.44
	OPENBSD_5_5_BASE:1.1.1.1
	OPENBSD_5_4:1.1.1.1.0.40
	OPENBSD_5_4_BASE:1.1.1.1
	OPENBSD_5_3:1.1.1.1.0.38
	OPENBSD_5_3_BASE:1.1.1.1
	gcc-3_3_6:1.1.1.1
	OPENBSD_5_2:1.1.1.1.0.36
	OPENBSD_5_2_BASE:1.1.1.1
	OPENBSD_5_1_BASE:1.1.1.1
	OPENBSD_5_1:1.1.1.1.0.34
	OPENBSD_5_0:1.1.1.1.0.32
	OPENBSD_5_0_BASE:1.1.1.1
	OPENBSD_4_9:1.1.1.1.0.30
	OPENBSD_4_9_BASE:1.1.1.1
	OPENBSD_4_8:1.1.1.1.0.28
	OPENBSD_4_8_BASE:1.1.1.1
	OPENBSD_4_7:1.1.1.1.0.24
	OPENBSD_4_7_BASE:1.1.1.1
	OPENBSD_4_6:1.1.1.1.0.26
	OPENBSD_4_6_BASE:1.1.1.1
	OPENBSD_4_5:1.1.1.1.0.22
	OPENBSD_4_5_BASE:1.1.1.1
	OPENBSD_4_4:1.1.1.1.0.20
	OPENBSD_4_4_BASE:1.1.1.1
	OPENBSD_4_3:1.1.1.1.0.18
	OPENBSD_4_3_BASE:1.1.1.1
	OPENBSD_4_2:1.1.1.1.0.16
	OPENBSD_4_2_BASE:1.1.1.1
	OPENBSD_4_1:1.1.1.1.0.14
	OPENBSD_4_1_BASE:1.1.1.1
	OPENBSD_4_0:1.1.1.1.0.12
	OPENBSD_4_0_BASE:1.1.1.1
	OPENBSD_3_9:1.1.1.1.0.10
	OPENBSD_3_9_BASE:1.1.1.1
	OPENBSD_3_8:1.1.1.1.0.8
	OPENBSD_3_8_BASE:1.1.1.1
	OPENBSD_3_7:1.1.1.1.0.6
	OPENBSD_3_7_BASE:1.1.1.1
	gcc-3_3_5:1.1.1.1
	OPENBSD_3_6:1.1.1.1.0.4
	OPENBSD_3_6_BASE:1.1.1.1
	OPENBSD_3_5:1.1.1.1.0.2
	OPENBSD_3_5_BASE:1.1.1.1
	gcc-3_3_2:1.1.1.1
	FSF:1.1.1;
locks; strict;
comment	@ * @;


1.1
date	2003.11.29.12.37.52;	author espie;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2003.11.29.12.37.52;	author espie;	state Exp;
branches;
next	;


desc
@@


1.1
log
@Initial revision
@
text
@/* Test for C99 designated initializers */
/* Origin: Jakub Jelinek <jakub@@redhat.com> */
/* { dg-do run } */
/* { dg-options "-std=iso9899:1999 -pedantic-errors" } */

typedef __SIZE_TYPE__ size_t;
typedef __WCHAR_TYPE__ wchar_t;
extern int memcmp (const void *, const void *, size_t);
extern void abort (void);
extern void exit (int);

int a[10] = { 10, 0, 12, 13, 14, 0, 0, 17, 0, 0 };
int b[10] = { 10, [4] = 15, [2] = 12, [4] = 14, [7] = 17 };
int c[10] = { 10, [4] = 15, [2] = 12, [3] = 13, 14, [7] = 17 };
struct A {
  int B;
  short C[2];
};
struct A d[] = { { 0, { 1, 2 } }, { 0, { 0, 0 } }, { 10, { 11, 12 } } };
struct A e[] = { 0, 1, 2, [2] = 10, 11, 12 };
struct A f[] = { 0, 1, 2, [2].C = 11, 12, 13 };
struct A g[] = { 0, 1, 2, [2].C[1] = 12, 13, 14 };
struct A h[] = { 0, 1, 2, [2] = { .C[1] = 12 }, 13, 14 };
struct A i[] = { 0, 1, 2, [2] = { .C = { [1] = 12 } }, 13, 14 };
union D {
  int E;
  double F;
  struct A G;
};
union D j[] = { [4] = 1, [4].F = 1.0, [1].G.C[1] = 4 };
struct H {
  char I[6];
  int J;
} k[] = { { { "foo" }, 1 }, [0].I[0] = 'b' };
struct K {
  wchar_t L[6];
  int M;
} l[] = { { { L"foo" }, 1 }, [0].L[2] = L'x', [0].L[4] = L'y' };
struct H m[] = { { { "foo" }, 1 }, [0] = { .I[0] = 'b' } };
struct H n[] = { { { "foo" }, 1 }, [0].I = { "a" }, [0].J = 2 };
int o = { 22 };

int main (void)
{
  if (b[3])
    abort ();
  b[3] = 13;
  if (memcmp (a, b, sizeof (a)) || memcmp (a, c, sizeof (a)))
    abort ();
  if (memcmp (d, e, sizeof (d)) || sizeof (d) != sizeof (e))
    abort ();
  if (f[2].B != 0 || g[2].B != 0 || g[2].C[0] != 0)
    abort ();
  if (memcmp (g, h, sizeof (g)) || memcmp (g, i, sizeof (g)))
    abort ();
  f[2].B = 10;
  g[2].B = 10;
  g[2].C[0] = 11;
  if (memcmp (d, f, sizeof (d)) || memcmp (d, g, sizeof (d)))
    abort ();
  if (f[3].B != 13 || g[3].B != 13 || g[3].C[0] != 14)
    abort ();
  if (j[0].E || j[1].G.B || j[1].G.C[0] || j[1].G.C[1] != 4)
    abort ();
  if (j[2].E || j[3].E || j[4].F != 1.0)
    abort ();
  if (memcmp (k[0].I, "boo\0\0", 6) || k[0].J != 1)
    abort ();
  if (memcmp (l[0].L, L"fox\0y", 6 * sizeof(wchar_t)) || l[0].M != 1)
    abort ();
  if (memcmp (m[0].I, "b\0\0\0\0", 6) || m[0].J)
    abort ();
  if (memcmp (n[0].I, "a\0\0\0\0", 6) || n[0].J != 2)
    abort ();
  if (o != 22)
    abort ();
  exit (0);
}
@


1.1.1.1
log
@Import gcc-3.3.2. Only the compiler. ada frontend removed for space 
considerations.
@
text
@@
