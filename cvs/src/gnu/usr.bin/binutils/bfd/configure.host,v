head	1.9;
access;
symbols
	OPENBSD_6_2:1.9.0.54
	OPENBSD_6_2_BASE:1.9
	OPENBSD_6_1:1.9.0.52
	OPENBSD_6_1_BASE:1.9
	OPENBSD_6_0:1.9.0.48
	OPENBSD_6_0_BASE:1.9
	OPENBSD_5_9:1.9.0.44
	OPENBSD_5_9_BASE:1.9
	OPENBSD_5_8:1.9.0.46
	OPENBSD_5_8_BASE:1.9
	OPENBSD_5_7:1.9.0.38
	OPENBSD_5_7_BASE:1.9
	OPENBSD_5_6:1.9.0.42
	OPENBSD_5_6_BASE:1.9
	OPENBSD_5_5:1.9.0.40
	OPENBSD_5_5_BASE:1.9
	OPENBSD_5_4:1.9.0.36
	OPENBSD_5_4_BASE:1.9
	OPENBSD_5_3:1.9.0.34
	OPENBSD_5_3_BASE:1.9
	OPENBSD_5_2:1.9.0.32
	OPENBSD_5_2_BASE:1.9
	OPENBSD_5_1_BASE:1.9
	OPENBSD_5_1:1.9.0.30
	OPENBSD_5_0:1.9.0.28
	OPENBSD_5_0_BASE:1.9
	OPENBSD_4_9:1.9.0.26
	OPENBSD_4_9_BASE:1.9
	OPENBSD_4_8:1.9.0.24
	OPENBSD_4_8_BASE:1.9
	OPENBSD_4_7:1.9.0.20
	OPENBSD_4_7_BASE:1.9
	OPENBSD_4_6:1.9.0.22
	OPENBSD_4_6_BASE:1.9
	OPENBSD_4_5:1.9.0.18
	OPENBSD_4_5_BASE:1.9
	OPENBSD_4_4:1.9.0.16
	OPENBSD_4_4_BASE:1.9
	OPENBSD_4_3:1.9.0.14
	OPENBSD_4_3_BASE:1.9
	OPENBSD_4_2:1.9.0.12
	OPENBSD_4_2_BASE:1.9
	OPENBSD_4_1:1.9.0.10
	OPENBSD_4_1_BASE:1.9
	OPENBSD_4_0:1.9.0.8
	OPENBSD_4_0_BASE:1.9
	OPENBSD_3_9:1.9.0.6
	OPENBSD_3_9_BASE:1.9
	OPENBSD_3_8:1.9.0.4
	OPENBSD_3_8_BASE:1.9
	OPENBSD_3_7:1.9.0.2
	OPENBSD_3_7_BASE:1.9
	BINUTILS_2_15:1.1.1.9
	OPENBSD_3_6:1.8.0.2
	OPENBSD_3_6_BASE:1.8
	BINUTILS-2_14:1.1.1.8
	OPENBSD_3_5:1.7.0.8
	OPENBSD_3_5_BASE:1.7
	OPENBSD_3_4:1.7.0.6
	OPENBSD_3_4_BASE:1.7
	OPENBSD_3_3:1.7.0.4
	OPENBSD_3_3_BASE:1.7
	OPENBSD_3_2:1.7.0.2
	OPENBSD_3_2_BASE:1.7
	binutils-2_11_2:1.1.1.7
	OPENBSD_3_1:1.6.0.8
	OPENBSD_3_1_BASE:1.6
	OPENBSD_3_0:1.6.0.6
	OPENBSD_3_0_BASE:1.6
	BINUTILS-2_10_1:1.1.1.6
	OPENBSD_2_9:1.6.0.4
	OPENBSD_2_9_BASE:1.6
	OPENBSD_2_8:1.6.0.2
	OPENBSD_2_8_BASE:1.6
	BINUTILS-2_10:1.1.1.6
	OPENBSD_2_7:1.5.0.16
	OPENBSD_2_7_BASE:1.5
	new-binutils:1.5.0.14
	OPENBSD_2_6:1.5.0.12
	OPENBSD_2_6_BASE:1.5
	OPENBSD_2_5:1.5.0.10
	OPENBSD_2_5_BASE:1.5
	OPENBSD_2_4:1.5.0.8
	OPENBSD_2_4_BASE:1.5
	OPENBSD_2_3:1.5.0.6
	OPENBSD_2_3_BASE:1.5
	OPENBSD_2_2:1.5.0.4
	OPENBSD_2_2_BASE:1.5
	BINUTILS-2_8_1:1.1.1.5
	OPENBSD_2_1:1.5.0.2
	OPENBSD_2_1_BASE:1.5
	CYGNUS-961112:1.1.1.4
	OPENBSD_2_0:1.4.0.2
	OPENBSD_2_0_BASE:1.4
	CYGNUS-960904:1.1.1.3
	CYGNUS-960609:1.1.1.2
	CYGNUS-960607:1.1.1.2
	CYGNUS:1.1.1
	FSF_2_6:1.1.1.1
	FSF:1.1.1;
locks; strict;
comment	@# @;


1.9
date	2004.11.02.20.45.05;	author miod;	state Exp;
branches;
next	1.8;

1.8
date	2004.05.17.21.54.21;	author drahn;	state Exp;
branches;
next	1.7;

1.7
date	2002.05.13.17.07.29;	author fgsch;	state Exp;
branches;
next	1.6;

1.6
date	2000.09.12.19.11.10;	author espie;	state Exp;
branches;
next	1.5;

1.5
date	96.11.23.03.32.56;	author niklas;	state Exp;
branches;
next	1.4;

1.4
date	96.09.04.19.00.10;	author niklas;	state Exp;
branches;
next	1.3;

1.3
date	96.06.07.21.09.14;	author niklas;	state Exp;
branches;
next	1.2;

1.2
date	96.01.08.22.16.12;	author niklas;	state Exp;
branches;
next	1.1;

1.1
date	96.01.08.11.04.37;	author niklas;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	96.01.08.11.04.37;	author niklas;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	96.06.07.11.05.18;	author niklas;	state Exp;
branches;
next	1.1.1.3;

1.1.1.3
date	96.09.04.17.37.29;	author niklas;	state Exp;
branches;
next	1.1.1.4;

1.1.1.4
date	96.11.19.14.12.17;	author niklas;	state Exp;
branches;
next	1.1.1.5;

1.1.1.5
date	97.05.29.09.18.33;	author niklas;	state Exp;
branches;
next	1.1.1.6;

1.1.1.6
date	2000.09.12.14.45.32;	author espie;	state Exp;
branches;
next	1.1.1.7;

1.1.1.7
date	2002.05.13.13.22.12;	author fgsch;	state Exp;
branches;
next	1.1.1.8;

1.1.1.8
date	2004.05.17.20.42.12;	author drahn;	state Exp;
branches;
next	1.1.1.9;

1.1.1.9
date	2004.11.02.20.22.18;	author miod;	state Exp;
branches;
next	;


desc
@@


1.9
log
@Merge conflicts, bringing our changes back in:
- extra $(SHELL) and sugar for make (so that files not mode +x still work)
- safer temp file handling
- our W^X binary layout changes in ld
- OpenBSD policy for library file selection in ld
- arm and m88k changes which were not merged in time for official 2.15
- bfd core file handling
- a couple typos

New for 2.15:
- ld(1) and as(1) manpages now generated at build time
- binutils/stabs.c reverted to use our in-tree libiberty for now
- we still use our VIA C3 crypto code over stock binutils, as it recognizes
  more instructions
- new emulations for OpenBSD on mips64 machines, to help OpenBSD/sgi
- relaxed %f# handling in gas on OpenBSD/sparc64 (same as was in 2.14)

Tested on all platforms by various people; special thanks to sturm@@ and
otto@@.
@
text
@# This file is a shell script that overrides some of the tools and
# flags used on a host specific basis.

# Since the "bfd/hosts" directory is shared by the bfd, opcodes, and
# binutils directories (at least), the index to it is also shared.
# This is that index.  Each configure.in file should source this file
# in its per-host part.

# This sets the following shell variables:
#  HDEFINES		host specific compiler options
#  host64		set to true if 64 bit types are as fast as 32 bit
#  HOST_64BIT_TYPE	host 64 bit type
#  HOST_U_64BIT_TYPE	unsigned 64 bit type (not needed if 64BIT_TYPE is long)

HDEFINES=
host64=false
HOST_64BIT_TYPE=
HOST_U_64BIT_TYPE=

case "${host}" in

hppa*-*-hpux*)		# HP/UX's ftello64 et.al. declarations are only
			# visible when _LARGEFILE64_SOURCE is defined.
			# Without those declarations, real_ftell et.al.
			# get mis-compiled.
			HDEFINES="-DHOST_HPPAHPUX -D_LARGEFILE64_SOURCE" ;;
hppa*-*-hiux*)		HDEFINES=-DHOST_HPPAHPUX ;;
hppa*-*-mpeix*)		HDEFINES=-DHOST_HPPAMPEIX ;;
hppa*-*-bsd*)		HDEFINES=-DHOST_HPPABSD ;;
hppa*-*-osf*)		HDEFINES=-DHOST_HPPAOSF ;;

ia64-*-*)		host64=true;;

# Workaround for limitations on win9x where file contents are
# not zero'd out if you seek past the end and then write.
i[3-7]86-*-mingw32*)	HDEFINES=-D__USE_MINGW_FSEEK;;

i[3-7]86-sequent-bsd*)	HDEFINES=-Dshared=genshared ;;
i[3-7]86-sequent-sysv4*) ;;
i[3-7]86-sequent-sysv*)	HDEFINES=-Dshared=genshared ;;

mips*-*-netbsd*)	;;
mips*-*-openbsd*)	;;
mips*-dec-*)		HDEFINES="-G 4"	;;
mips*-sgi-irix3*)	HDEFINES="-G 4" ;;
mips*-sgi-irix4*)	HDEFINES="-G 4" ;;
mips*-sgi-irix6*)	host64=true;;
mips64*-*-linux*)	host64=true;;
mips*-*-sysv4*)		;;
mips*-*-sysv*)		HDEFINES="-G 4" ;;
mips*-*-riscos*)	HDEFINES="-G 4" ;;

m68*-hp-hpux*)		HDEFINES=-DHOST_HP300HPUX ;;

*-*-windows*)
			HOST_64BIT_TYPE=__int64
			HOST_U_64BIT_TYPE="unsigned __int64"
# The following krock is necessary because we can't run the build compiler
# (MSVC) on the configure host, so we have to explicitly set the values here.
# Note that this file is never run through autoconf, so we can't use any
# autoconf macros here.  Because of this, we have to muck with autoconf
# variables explicitly.
			ac_cv_func_mmap_fixed_mapped=no
			ac_cv_header_time=no
			ac_cv_func_getpagesize=no
			ac_cv_func_madvise=no
			ac_cv_func_mprotect=no
			ac_cv_func_getuid=no
			ac_cv_func_getgid=no
			ac_cv_header_sys_file_h=no
			ac_cv_header_sys_time_h=no
			ac_cv_header_unistd_h=no
			;;
esac
@


1.8
log
@Resolve merge conflicts, adjust method of W^X handing (.sh files)
remove testsuites (not useable) remove mmalloc (not part of new binutils).
@
text
@d22 5
a26 5
alpha*-*-*)		host64=true; HOST_64BIT_TYPE=long ;;

hppa*64*-*-hpux*)	HDEFINES=-DHOST_HPPAHPUX;
			host64=true; HOST_64BIT_TYPE=long ;;
hppa*-*-hpux*)		HDEFINES=-DHOST_HPPAHPUX ;;
a27 1
hppa*64*-*-linux*)	host64=true; HOST_64BIT_TYPE=long ;;
d32 1
a32 6
ia64-*-linux*)		host64=true; HOST_64BIT_TYPE=long ;;
ia64-*-aix*)		host64=true; HOST_64BIT_TYPE=long ;;
ia64-*-hpux*)		host64=true
			HOST_64BIT_TYPE="long long";
			HOST_U_64BIT_TYPE="unsigned long long";
			;;
d34 7
a40 3
i[3456]86-sequent-bsd*)	HDEFINES=-Dshared=genshared ;;
i[3456]86-sequent-sysv4*) ;;
i[3456]86-sequent-sysv*)	HDEFINES=-Dshared=genshared ;;
d47 2
a48 8
mips*-sgi-irix6*)	host64=true
			HOST_64BIT_TYPE="long long";
			HOST_U_64BIT_TYPE="unsigned long long";
			;;
mips64*-*-linux*)	host64=true
			HOST_64BIT_TYPE="long long";
			HOST_U_64BIT_TYPE="unsigned long long";
			;;
a53 8

*-*-aix*)		HOST_64BIT_TYPE="long long"
			HOST_U_64BIT_TYPE="unsigned long long"
			;;

*-*-solaris*)		HOST_64BIT_TYPE="long long"
			HOST_U_64BIT_TYPE="unsigned long long"
			;;
@


1.7
log
@resolve conflicts.
@
text
@d24 2
d28 1
d34 5
d44 1
a44 1
mips*-dec-netbsd*)	;;
d50 4
@


1.6
log
@Help stupid cvs fixing basic conflicts.
@
text
@d30 2
d50 4
@


1.5
log
@Merge to Cygnus 961112 + add some support (not ready) for shared libs
@
text
@d11 1
a11 1
#  host64		set to true if this is a 64 bit host
a13 9
#  SHLIB_CC		compiler to use when building shared library
#  SHLIB_CFLAGS		flags to use when building shared library
#  PICFLAG		may be set to flag to use to compile PIC
#  SHLINK		may be set to the name to link the shared library to
#  ALLLIBS		may be set to libraries to build
#  HLDFLAGS		LDFLAGS specific to the host
#  HLDENV		environment variable to set when linking for the host
#  RPATH_ENVVAR		environment variable used to find shared libraries
#  INSTALL_SHLIB	install a shared library
d18 1
d22 1
a22 1
alpha-*-*)		host64=true; HOST_64BIT_TYPE=long ;;
d26 1
d34 8
a41 10
mips-dec-netbsd*)	;;
mips-dec-openbsd*)	;;
mips-dec-*)		HDEFINES="-G 4"	;;
mips-sgi-irix3*)	HDEFINES="-G 4" ;;
mips-sgi-irix4*)	HDEFINES="-G 4" ;;
mips-sgi-irix6*)	# We can use __int64_t here because bfd.h
			# includes obstack.h which includes stddef.h.
			host64=true
			HOST_64BIT_TYPE=__int64_t
			HOST_U_64BIT_TYPE=__uint64_t
d43 3
a45 3
mips-*-sysv4*)		;;
mips-*-sysv*)		HDEFINES="-G 4" ;;
mips-*-riscos*)		HDEFINES="-G 4" ;;
a53 1
			host64=true
d61 1
a61 1
			ac_cv_func_mmap=no
d66 2
a71 89
esac

# If we are configuring with --enable-shared, adjust the shared
# library support based on the host.  This support must work for both
# the BFD and the opcodes libraries.
HLDFLAGS=
HLDENV=
RPATH_ENVVAR=LD_LIBRARY_PATH
SHLIB_CC='$(CC)'
SHLIB_CFLAGS='-shared'
INSTALL_SHLIB='$(INSTALL_PROGRAM) $$f $(libdir)/$$tf;'
if [ "${shared}" = "true" ]; then
  case "${host}" in
  hppa*-*-*)		picfrag=${srcdir}/../config/mh-papic ;;
  i[34566]86-*-*)	picfrag=${srcdir}/../config/mh-x86pic ;;
  *-*-*)		picfrag=${srcdir}/../config/mh-${host_cpu}pic ;;
  esac
  if [ -f "${picfrag}" ]; then
    pic=`sed -n -e 's/^PICFLAG[ 	]*=[ 	]*\(.*\)$/\1/p' ${picfrag}`
    if [ -n "${pic}" ]; then
      PICFLAG=${pic}
    fi
  fi

  case "${host}" in
  *-dec-osf*)
    # -fpic is not needed on the Alpha.
    PICFLAG=
    HLDFLAGS='-rpath $(libdir)'
    SHLIB_CFLAGS='-shared -Wl,-soname,$(SONAME)'
    ;;
  *-*-hpux*)
    # HP/UX uses .sl for shared libraries.
    SHLINK=`echo ${SHLINK} | sed -e 's/so$/sl/'`
    SHLIB_CFLAGS='-shared $(PICFLAG)'
    HLDFLAGS='-Wl,+s,+b,$(libdir)'
    RPATH_ENVVAR=SHLIB_PATH
    INSTALL_SHLIB='$(INSTALL_PROGRAM) $$f $(libdir)/$$tf; chmod -w $(libdir)/$$tf;'
    ;;
  *-*-irix[56]*)
    # -fpic is not needed on Irix 5 or 6.
    PICFLAG=
    SHLIB_CFLAGS='-shared -Wl,-soname,$(SONAME)'
    HLDFLAGS='-Wl,-rpath,$(libdir)'
    ;;
  *-*-linux*aout*)
    ;;
  *-*-linux*)
    SHLIB_CFLAGS='-shared -Wl,-soname,$(SONAME)'
    case "${libdir}" in
      /lib | /usr/lib) ;;
      *) HLDFLAGS='-Wl,-rpath,$(libdir)' ;;
    esac
    ;;
  *-*-solaris*)
    SHLIB_CFLAGS='-shared -h $(SONAME)'
    HLDFLAGS='-R $(libdir)'
    ;;
  *-*-sysv4*)
    SHLIB_CFLAGS='-shared -h $(SONAME)'
    HLDENV='if test -z "$${LD_RUN_PATH}"; then LD_RUN_PATH=$(libdir); else LD_RUN_PATH=$${LD_RUN_PATH}:$(libdir); fi; export LD_RUN_PATH;'
    ;;
  *-*-sunos*)
    # Build a libTARGET-bfd.so.VERSION symlink in the object directory.
    ALLLIBS=`echo ${ALLLIBS} | sed -e 's/\$(SHLINK)/stamp-tshlink/'`
    ;;
  esac
fi

# On SunOS, if the linker supports the -rpath option, use it to
# prevent ../bfd and ../opcodes from being included in the run time
# search path.
case "${host}" in
  *-*-sunos*)
    echo 'main () { }' > conftest.c
    ${CC} -o conftest -Wl,-rpath= conftest.c >/dev/null 2>conftest.t
    if grep 'unrecognized' conftest.t >/dev/null 2>&1; then
      :
    elif grep 'No such file' conftest.t >/dev/null 2>&1; then
      :
    elif grep 'do not mix' conftest.t >/dev/null 2>&1; then
      :
    elif [ "${shared}" = "true" ]; then
      HLDFLAGS='-Wl,-rpath=$(libdir)'
    else
      HLDFLAGS='-Wl,-rpath='
    fi
    rm -f conftest.t conftest.c conftest
    ;;
@


1.4
log
@Merge the Cygnus 960904 sources
@
text
@d58 22
@


1.3
log
@Resolved conflicts with latest Cygnus import and our local changes
@
text
@d13 1
d20 1
d22 1
d37 3
a39 3
i[345]86-sequent-bsd*)	HDEFINES=-Dshared=genshared ;;
i[345]86-sequent-sysv4*) ;;
i[345]86-sequent-sysv*)	HDEFINES=-Dshared=genshared ;;
d46 6
d64 1
d68 1
d72 1
a72 1
  i[3456]86-*-*)	picfrag=${srcdir}/../config/mh-x86pic ;;
d95 1
d97 2
a98 2
  *-*-irix5*)
    # -fpic is not needed on Irix 5.
d112 1
a112 1
  *-*-sysv4* | *-*-solaris*)
d115 4
@


1.2
log
@Add OpenBSD configuration, it's exactly like NetBSD.
@
text
@a9 5
#  CC			compiler to use (only if needed and not already set)
#  CFLAGS		override CFLAGS (only if needed and not already set)
#  LDFLAGS		override LDFLAGS (only if needed and not already set)
#  AR			archiver to use (only if needed and not already set)
#  RANLIB		ranlib to use (only if needed and not already set)
d13 7
a25 7
# WHEN ADDING ENTRIES TO THIS MATRIX:
#  Make sure that the left side always has two dashes.  Otherwise you
#  can get spurious matches.  Even for unambiguous cases, do this as a
#  convention, else the table becomes a real mess to understand and maintain.
#
# Note that these entries cannot be fully alphabetical.  Don't try.
# The order of matching is critical when multiple lines could match.
a28 2
a29k-*-*)		CC=${CC-u3cc}; AR=${AR-u3ar} ;;

a36 11
i[345]86-ncr*-sysv4*)	CC=${CC-/usr/ccs/ATT/cc}
			test -z "$CFLAGS" && CFLAGS=" "
			;;
i[345]86-*-go32*)	test -z "$CC" && CC="i386-go32-gcc -fno-omit-frame-pointer -O2 -Wl,-S"
			AR=${AR-i386-go32-ar}
			RANLIB=${RANLIB-i386-go32-ranlib}
			;;
i[345]86-*-win32)	test -z "$CC" && CC="i386-win32-gcc -O2"
			AR=${AR-i386-win32-ar}
			RANLIB=${RANLIB-i386-win32-ranlib}
			;;
d41 2
a42 6
mips-sgi-irix3*)	HDEFINES="-G 4"
			test -z "$LDFLAGS" && LDFLAGS=-lmalloc
			;;
mips-sgi-irix4*)	HDEFINES="-G 4"
			test -z "$LDFLAGS" && LDFLAGS=-lmalloc
			;;
a46 4
m68*-apollo*-sysv*)	# sef@@cygnus.com says this is how to compile
			# on an apollo in the SysV environment.
			test -z "$CC" && CC="cc -A nansi -A cpu,3000 -A runtype,any -A systype,any -DSHORT_ENUM_BUG -DUSG -U__STDC__ -Dm68000=mc68000"
			;;
d49 1
a49 11
m88*-*-dgux*)		test -z "$CC" && CC="gcc -Wall -ansi -D__using_DGUX"
			;;

romp-*-*)		# hc/pcc just can't cut it
			CC=${CC-gcc}
			;;

rs6000-*-aix4)		HDEFINES=-DHOST_AIX ;;
rs6000-*-*)		HDEFINES=-DHOST_AIX ;;
powerpc-*-aix4*)	HDEFINES=-DHOST_AIX ;;
powerpc-*-aix*)		HDEFINES=-DHOST_AIX ;;
d51 80
@


1.1
log
@Initial revision
@
text
@d57 1
@


1.1.1.1
log
@Initial GNU binutils 2.6 import
@
text
@@


1.1.1.2
log
@(Correct) Import of Cygnus binutils snapshot taken 960607
@
text
@d10 5
a17 7
#  SHLIB_CC		compiler to use when building shared library
#  SHLIB_CFLAGS		flags to use when building shared library
#  PICFLAG		may be set to flag to use to compile PIC
#  SHLINK		may be set to the name to link the shared library to
#  ALLLIBS		may be set to libraries to build
#  HLDFLAGS		LDFLAGS specific to the host
#  RPATH_ENVVAR		environment variable used to find shared libraries
d24 7
d34 2
d44 11
d58 6
a63 2
mips-sgi-irix3*)	HDEFINES="-G 4" ;;
mips-sgi-irix4*)	HDEFINES="-G 4" ;;
d68 4
d74 11
a84 1
esac
a85 80
# If we are configuring with --enable-shared, adjust the shared
# library support based on the host.  This support must work for both
# the BFD and the opcodes libraries.
HLDFLAGS=
RPATH_ENVVAR=LD_LIBRARY_PATH
SHLIB_CC='$(CC)'
SHLIB_CFLAGS='-shared'
if [ "${shared}" = "true" ]; then
  case "${host}" in
  hppa*-*-*)		picfrag=${srcdir}/../config/mh-papic ;;
  i[3456]86-*-*)	picfrag=${srcdir}/../config/mh-x86pic ;;
  *-*-*)		picfrag=${srcdir}/../config/mh-${host_cpu}pic ;;
  esac
  if [ -f "${picfrag}" ]; then
    pic=`sed -n -e 's/^PICFLAG[ 	]*=[ 	]*\(.*\)$/\1/p' ${picfrag}`
    if [ -n "${pic}" ]; then
      PICFLAG=${pic}
    fi
  fi

  case "${host}" in
  *-dec-osf*)
    # -fpic is not needed on the Alpha.
    PICFLAG=
    HLDFLAGS='-rpath $(libdir)'
    SHLIB_CFLAGS='-shared -Wl,-soname,$(SONAME)'
    ;;
  *-*-hpux*)
    # HP/UX uses .sl for shared libraries.
    SHLINK=`echo ${SHLINK} | sed -e 's/so$/sl/'`
    SHLIB_CFLAGS='-shared $(PICFLAG)'
    HLDFLAGS='-Wl,+s,+b,$(libdir)'
    RPATH_ENVVAR=SHLIB_PATH
    ;;
  *-*-irix5*)
    # -fpic is not needed on Irix 5.
    PICFLAG=
    SHLIB_CFLAGS='-shared -Wl,-soname,$(SONAME)'
    HLDFLAGS='-Wl,-rpath,$(libdir)'
    ;;
  *-*-linux*aout*)
    ;;
  *-*-linux*)
    SHLIB_CFLAGS='-shared -Wl,-soname,$(SONAME)'
    case "${libdir}" in
      /lib | /usr/lib) ;;
      *) HLDFLAGS='-Wl,-rpath,$(libdir)' ;;
    esac
    ;;
  *-*-sysv4* | *-*-solaris*)
    SHLIB_CFLAGS='-shared -h $(SONAME)'
    HLDFLAGS='-R $(libdir)'
    ;;
  *-*-sunos*)
    # Build a libTARGET-bfd.so.VERSION symlink in the object directory.
    ALLLIBS=`echo ${ALLLIBS} | sed -e 's/\$(SHLINK)/stamp-tshlink/'`
    ;;
  esac
fi

# On SunOS, if the linker supports the -rpath option, use it to
# prevent ../bfd and ../opcodes from being included in the run time
# search path.
case "${host}" in
  *-*-sunos*)
    echo 'main () { }' > conftest.c
    ${CC} -o conftest -Wl,-rpath= conftest.c >/dev/null 2>conftest.t
    if grep 'unrecognized' conftest.t >/dev/null 2>&1; then
      :
    elif grep 'No such file' conftest.t >/dev/null 2>&1; then
      :
    elif grep 'do not mix' conftest.t >/dev/null 2>&1; then
      :
    elif [ "${shared}" = "true" ]; then
      HLDFLAGS='-Wl,-rpath=$(libdir)'
    else
      HLDFLAGS='-Wl,-rpath='
    fi
    rm -f conftest.t conftest.c conftest
    ;;
@


1.1.1.3
log
@Import of binutils, gas, ld & gprof from Cygnus 960904 tree
@
text
@a12 1
#  HOST_U_64BIT_TYPE	unsigned 64 bit type (not needed if 64BIT_TYPE is long)
a18 1
#  HLDENV		environment variable to set when linking for the host
a19 1
#  INSTALL_SHLIB	install a shared library
d34 3
a36 3
i[3456]86-sequent-bsd*)	HDEFINES=-Dshared=genshared ;;
i[3456]86-sequent-sysv4*) ;;
i[3456]86-sequent-sysv*)	HDEFINES=-Dshared=genshared ;;
a41 6
mips-sgi-irix6*)	# We can use __int64_t here because bfd.h
			# includes obstack.h which includes stddef.h.
			host64=true
			HOST_64BIT_TYPE=__int64_t
			HOST_U_64BIT_TYPE=__uint64_t
			;;
a53 1
HLDENV=
a56 1
INSTALL_SHLIB='$(INSTALL_PROGRAM) $$f $(libdir)/$$tf;'
d60 1
a60 1
  i[34566]86-*-*)	picfrag=${srcdir}/../config/mh-x86pic ;;
a82 1
    INSTALL_SHLIB='$(INSTALL_PROGRAM) $$f $(libdir)/$$tf; chmod -w $(libdir)/$$tf;'
d84 2
a85 2
  *-*-irix[56]*)
    # -fpic is not needed on Irix 5 or 6.
d99 1
a99 1
  *-*-solaris*)
a101 4
    ;;
  *-*-sysv4*)
    SHLIB_CFLAGS='-shared -h $(SONAME)'
    HLDENV='if test -z "$${LD_RUN_PATH}"; then LD_RUN_PATH=$(libdir); else LD_RUN_PATH=$${LD_RUN_PATH}:$(libdir); fi; export LD_RUN_PATH;'
@


1.1.1.4
log
@Import of 961112 Cygnus binutils+gas+ld+gdb+gprof
@
text
@a56 22
*-*-solaris*)		HOST_64BIT_TYPE="long long"
			HOST_U_64BIT_TYPE="unsigned long long"
			;;

*-*-windows*)
			host64=true
			HOST_64BIT_TYPE=__int64
			HOST_U_64BIT_TYPE="unsigned __int64"
# The following krock is necessary because we can't run the build compiler
# (MSVC) on the configure host, so we have to explicitly set the values here.
# Note that this file is never run through autoconf, so we can't use any
# autoconf macros here.  Because of this, we have to muck with autoconf
# variables explicitly.
			ac_cv_func_mmap=no
			ac_cv_header_time=no
			ac_cv_func_getpagesize=no
			ac_cv_func_madvise=no
			ac_cv_func_mprotect=no
			ac_cv_header_sys_file_h=no
			ac_cv_header_sys_time_h=no
			ac_cv_header_unistd_h=no
			;;
@


1.1.1.5
log
@Import of binutils-2.8.1 from Cygnus/FSF
@
text
@d11 1
a11 1
#  host64		set to true if 64 bit types are as fast as 32 bit
a15 1
#  SHLIB_LIBS		libraries to use when building shared library
d41 9
a49 8
mips*-dec-netbsd*)	;;
mips*-*-openbsd*)	;;
mips*-dec-*)		HDEFINES="-G 4"	;;
mips*-sgi-irix3*)	HDEFINES="-G 4" ;;
mips*-sgi-irix4*)	HDEFINES="-G 4" ;;
mips*-sgi-irix6*)	host64=true
			HOST_64BIT_TYPE="long long";
			HOST_U_64BIT_TYPE="unsigned long long";
d51 3
a53 3
mips*-*-sysv4*)		;;
mips*-*-sysv*)		HDEFINES="-G 4" ;;
mips*-*-riscos*)	HDEFINES="-G 4" ;;
d62 1
d70 1
a70 1
			ac_cv_func_mmap_fixed_mapped=no
a88 1
SHLIB_LIBS=
a131 3
    # On Linux, apparently, linking against -lc lets ldconfig figure
    # out which version of libc should be used.
    SHLIB_LIBS=-lc
@


1.1.1.6
log
@Import binutils-2.10
- only the binutils package (no gdb here)
- don't import libiberty and texinfo, they are elsewhere
- remove all .info* generated files
@
text
@d14 10
a27 1
HOST_U_64BIT_TYPE=
d31 1
a31 1
alpha*-*-*)		host64=true; HOST_64BIT_TYPE=long ;;
a34 1
hppa*-*-mpeix*)		HDEFINES=-DHOST_HPPAMPEIX ;;
a73 2
			ac_cv_func_getuid=no
			ac_cv_func_getgid=no
d78 93
@


1.1.1.7
log
@Import binutils-2.11.2
- only the binutils package (no gdb here)
- don't import libiberty and texinfo, they are elsewhere
- remove all .info* generated files
@
text
@a29 2
ia64-*-linux*)		host64=true; HOST_64BIT_TYPE=long ;;

a47 4

*-*-aix*)		HOST_64BIT_TYPE="long long"
			HOST_U_64BIT_TYPE="unsigned long long"
			;;
@


1.1.1.8
log
@import binutils 2.14 (excluding testsuites, .info files, and .po files)
@
text
@a23 2
hppa*64*-*-hpux*)	HDEFINES=-DHOST_HPPAHPUX;
			host64=true; HOST_64BIT_TYPE=long ;;
a25 1
hppa*64*-*-linux*)	host64=true; HOST_64BIT_TYPE=long ;;
a30 5
ia64-*-aix*)		host64=true; HOST_64BIT_TYPE=long ;;
ia64-*-hpux*)		host64=true
			HOST_64BIT_TYPE="long long";
			HOST_U_64BIT_TYPE="unsigned long long";
			;;
d36 1
a36 1
mips*-*-netbsd*)	;;
a41 4
			HOST_64BIT_TYPE="long long";
			HOST_U_64BIT_TYPE="unsigned long long";
			;;
mips64*-*-linux*)	host64=true
@


1.1.1.9
log
@Binutils 2.15, with testsuites removed, and without gdb and libiberty.
@
text
@d22 5
a26 5
hppa*-*-hpux*)		# HP/UX's ftello64 et.al. declarations are only
			# visible when _LARGEFILE64_SOURCE is defined.
			# Without those declarations, real_ftell et.al.
			# get mis-compiled.
			HDEFINES="-DHOST_HPPAHPUX -D_LARGEFILE64_SOURCE" ;;
d28 1
d33 6
a38 1
ia64-*-*)		host64=true;;
d40 3
a42 7
# Workaround for limitations on win9x where file contents are
# not zero'd out if you seek past the end and then write.
i[3-7]86-*-mingw32*)	HDEFINES=-D__USE_MINGW_FSEEK;;

i[3-7]86-sequent-bsd*)	HDEFINES=-Dshared=genshared ;;
i[3-7]86-sequent-sysv4*) ;;
i[3-7]86-sequent-sysv*)	HDEFINES=-Dshared=genshared ;;
d49 8
a56 2
mips*-sgi-irix6*)	host64=true;;
mips64*-*-linux*)	host64=true;;
d62 8
@


