head	1.20;
access;
symbols
	OPENBSD_3_3:1.13.0.2
	OPENBSD_3_3_BASE:1.13
	OPENBSD_3_2:1.12.0.16
	OPENBSD_3_2_BASE:1.12
	OPENBSD_3_1:1.12.0.14
	OPENBSD_3_1_BASE:1.12
	OPENBSD_3_0:1.12.0.12
	OPENBSD_3_0_BASE:1.12
	OPENBSD_2_9:1.12.0.10
	OPENBSD_2_9_BASE:1.12
	OPENBSD_2_8:1.12.0.8
	OPENBSD_2_8_BASE:1.12
	OPENBSD_2_7:1.12.0.6
	OPENBSD_2_7_BASE:1.12
	OPENBSD_2_6:1.12.0.4
	OPENBSD_2_6_BASE:1.12
	OPENBSD_2_5:1.12.0.2
	OPENBSD_2_5_BASE:1.12
	OPENBSD_2_4:1.9.0.6
	OPENBSD_2_4_BASE:1.9
	OPENBSD_2_3:1.9.0.4
	OPENBSD_2_3_BASE:1.9
	OPENBSD_2_2:1.9.0.2
	OPENBSD_2_2_BASE:1.9
	OPENBSD_2_1:1.7.0.2
	OPENBSD_2_1_BASE:1.7
	OPENBSD_2_0:1.5.0.2
	OPENBSD_2_0_BASE:1.5
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@# @;


1.20
date	2003.08.03.01.28.38;	author deraadt;	state dead;
branches;
next	1.19;

1.19
date	2003.07.31.07.44.45;	author otto;	state Exp;
branches;
next	1.18;

1.18
date	2003.07.29.11.54.33;	author otto;	state Exp;
branches;
next	1.17;

1.17
date	2003.07.12.16.02.25;	author millert;	state Exp;
branches;
next	1.16;

1.16
date	2003.06.23.19.11.54;	author deraadt;	state Exp;
branches;
next	1.15;

1.15
date	2003.06.22.22.18.42;	author deraadt;	state Exp;
branches;
next	1.14;

1.14
date	2003.04.17.03.47.05;	author drahn;	state Exp;
branches;
next	1.13;

1.13
date	2002.12.09.23.46.38;	author millert;	state Exp;
branches;
next	1.12;

1.12
date	99.02.25.04.24.28;	author millert;	state Exp;
branches;
next	1.11;

1.11
date	99.02.24.23.33.11;	author deraadt;	state Exp;
branches;
next	1.10;

1.10
date	99.01.28.23.45.52;	author espie;	state Exp;
branches;
next	1.9;

1.9
date	97.07.06.21.05.10;	author mickey;	state Exp;
branches;
next	1.8;

1.8
date	97.06.03.21.32.56;	author grr;	state Exp;
branches;
next	1.7;

1.7
date	97.04.27.20.55.56;	author millert;	state Exp;
branches;
next	1.6;

1.6
date	97.01.26.09.53.18;	author downsj;	state Exp;
branches;
next	1.5;

1.5
date	96.09.16.10.21.32;	author downsj;	state Exp;
branches;
next	1.4;

1.4
date	96.08.22.01.36.51;	author deraadt;	state Exp;
branches;
next	1.3;

1.3
date	96.08.20.05.14.09;	author tholo;	state Exp;
branches;
next	1.2;

1.2
date	95.12.14.03.43.12;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.40.51;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.40.51;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.20
log
@gnu gzip dir is now bye bye
@
text
@#	$OpenBSD: Makefile,v 1.19 2003/07/31 07:44:45 otto Exp $
#	$NetBSD: Makefile,v 1.17 1995/10/24 22:18:34 jtc Exp $

MAN=	znew.1

afterinstall:
	install -c -o ${BINOWN} -g ${BINGRP} -m ${BINMODE} \
	   ${.CURDIR}/znew \
	   ${DESTDIR}${BINDIR}

.include <bsd.prog.mk>
@


1.19
log
@Bye bye GNU gzexe(1).

ok deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.18 2003/07/29 11:54:33 otto Exp $
@


1.18
log
@Bye bye GNU zforce(1), welcome BSD zforce(1).
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.17 2003/07/12 16:02:25 millert Exp $
d4 1
a4 1
MAN=	gzexe.1 znew.1
d8 1
a8 1
	   ${.CURDIR}/gzexe ${.CURDIR}/znew \
@


1.17
log
@remove zdiff now that compress has its own
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.16 2003/06/23 19:11:54 deraadt Exp $
d4 1
a4 1
MAN=	gzexe.1 zforce.1 znew.1
d8 1
a8 1
	   ${.CURDIR}/zforce ${.CURDIR}/gzexe ${.CURDIR}/znew \
@


1.16
log
@this zmore no longer used
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.15 2003/06/22 22:18:42 deraadt Exp $
d4 1
a4 3
MAN=	gzexe.1 zdiff.1 zforce.1 znew.1
MLINKS+= zdiff.1 zcmp.1
LINKS+=	${BINDIR}/zdiff ${BINDIR}/zcmp
d9 1
a9 1
	   ${.CURDIR}/zdiff ${DESTDIR}${BINDIR}
@


1.15
log
@bye bye gnu gzip.  The only parts we keep using are the scripts of
questionable license.  These will be rewritten soon I hope.  Our compress,
linked against libz, now does everything gzip does.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.14 2003/04/17 03:47:05 drahn Exp $
d4 1
a4 1
MAN=	gzexe.1 zdiff.1 zforce.1 zmore.1 znew.1
d11 1
a11 2
	   ${.CURDIR}/zmore ${.CURDIR}/zdiff \
	   ${DESTDIR}${BINDIR}
@


1.14
log
@Underlying code supported 'ELF' symbols, however '-DNO_UNDERLINE' has
to be passed to cpp when processing the .S files.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.13 2002/12/09 23:46:38 millert Exp $
d4 1
a4 23
PROG=	gzip
SRCS=	gzip.c zip.c deflate.c trees.c bits.c unzip.c inflate.c util.c \
	crypt.c lzw.c unlzw.c unlzh.c unpack.c
MAN=	gzexe.1 gzip.1 zdiff.1 zforce.1 zgrep.1 zmore.1 znew.1
CFLAGS+=-DSTDC_HEADERS=1 -DHAVE_UNISTD_H=1 -DDIRENT=1

.if (${MACHINE_ARCH} == "m68k" || ${MACHINE_ARCH} == "i386")
SRCS+=	match.S
CFLAGS+=-DASMV 
.else
CFLAGS+=-DDYN_ALLOC
.endif
.if (${MACHINE_ARCH} == "i386")
UNDERLINE=-DNO_UNDERLINE
.endif

CLEANFILES+=	gzip.info

LDSTATIC= ${STATIC}

MAKEINFO=	makeinfo

MLINKS+= gzip.1 gunzip.1 gzip.1 gzcat.1
a5 4
MLINKS+= zgrep.1 zegrep.1 zgrep.1 zfgrep.1
#MLINKS+= gzip.1 uncompress.1
LINKS+= ${BINDIR}/gzip ${BINDIR}/gunzip
LINKS+= ${BINDIR}/gzip ${BINDIR}/gzcat
a6 12
LINKS+=	${BINDIR}/zgrep ${BINDIR}/zegrep
LINKS+=	${BINDIR}/zgrep ${BINDIR}/zfgrep
#LINKS+= ${BINDIR}/gzip ${BINDIR}/uncompress

all:	gzip.info

gzip.info:	gzip.texi
	${MAKEINFO} -I${.CURDIR} ${.CURDIR}/gzip.texi

beforeinstall:
	${INSTALL} ${INSTALL_COPY} -m 444 -o ${BINOWN} -g ${BINGRP} *.info* \
		${DESTDIR}/usr/share/info
d11 1
a11 1
	   ${.CURDIR}/zmore ${.CURDIR}/zdiff ${.CURDIR}/zgrep \
a12 8

.if (${MACHINE_ARCH} == "m68k" || ${MACHINE_ARCH} == "i386")
match.o: ${.CURDIR}/match.S
	$(CPP) -D__OpenBSD__ ${UNDERLINE} -D${MACHINE_ARCH} ${.CURDIR}/match.S >_match.s
	$(CC) -c _match.s
	mv _match.o match.o
	rm -f _match.s
.endif
@


1.13
log
@We now have getopt_long() in libc, no need to build a private copy.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.12 1999/02/25 04:24:28 millert Exp $
d16 3
d54 1
a54 1
	$(CPP) -D__OpenBSD__ -D${MACHINE_ARCH} ${.CURDIR}/match.S >_match.s
@


1.12
log
@kill extra gzip.1 in MLINKS and add LINKS and MLINKS for zegrep and zfgrep instead of making extra copies of that script
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.11 1999/02/24 23:33:11 deraadt Exp $
d6 1
a6 1
	crypt.c lzw.c unlzw.c unlzh.c unpack.c getopt.c
@


1.11
log
@put zegrep and zfgrep in the tree
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.10 1999/01/28 23:45:52 espie Exp $
d23 1
a23 1
MLINKS+= gzip.1 gunzip.1 gzip.1 gzcat.1 gzip.1
d25 1
d30 2
a47 4
	install -c -o ${BINOWN} -g ${BINGRP} -m ${BINMODE} \
	   ${.CURDIR}/zgrep ${DESTDIR}${BINDIR}/zegrep
	install -c -o ${BINOWN} -g ${BINGRP} -m ${BINMODE} \
	   ${.CURDIR}/zgrep ${DESTDIR}${BINDIR}/zfgrep
@


1.10
log
@Ensure i386 or m68k is defined (posixly-correct gcc will only define
__i386 or __m68k)
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.9 1997/07/06 21:05:10 mickey Exp $
d45 4
@


1.9
log
@zcat is now in compress
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.8 1997/06/03 21:32:56 grr Exp $
d12 1
a12 1
CFLAGS+=-DASMV
d48 1
a48 1
	$(CPP) -D__OpenBSD__ ${.CURDIR}/match.S >_match.s
@


1.8
log
@Build gzip with "DYN_ALLOC" set for architectures other than the ones that
use the assembly language match routine.  This makes g*zip malloc its big
buffers and saves about 300KB of bss allocation when used in instbin and
is otherwise harmless.  The assembly routines could be tweaked to work
this way too, but it would require a bit of head-scratching to find a free
register for working with a pointer rather than an offset.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.7 1997/04/27 20:55:56 millert Exp $
d23 1
a23 1
MLINKS+= gzip.1 gunzip.1 gzip.1 gzcat.1 gzip.1 zcat.1
a27 1
LINKS+= ${BINDIR}/gzip ${BINDIR}/zcat
@


1.7
log
@COPY -> INSTALL_COPY and STRIP -> INSTALL_STRIP
This fixes namespace problems where STRIP is sometimes used as
the name of the strip(1) to use and other times used as
the flag to send install(1) when stripping (or not).
COPY doesn't have this problem (yet) but was poorly named.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.6 1997/01/26 09:53:18 downsj Exp $
d13 2
@


1.6
log
@Add missing documentation; build and install it.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.5 1996/09/16 10:21:32 downsj Exp $
d36 1
a36 1
	${INSTALL} ${COPY} -m 444 -o ${BINOWN} -g ${BINGRP} *.info* \
@


1.5
log
@Use $STATIC
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.4 1996/08/22 01:36:51 deraadt Exp $
d15 2
d19 2
d29 9
@


1.4
log
@__OpenBSD__
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.3 1996/08/20 05:14:09 tholo Exp $
d15 1
a15 1
LDSTATIC= -static
@


1.3
log
@R.I.P.
@
text
@d1 1
a1 1
#	$OpenBSD$
d34 1
a34 1
	$(CPP) -D__NetBSD__ ${.CURDIR}/match.S >_match.s
@


1.2
log
@update from netbsd; parallel make stuff
@
text
@d1 1
a15 2
LDADD+=	-lgnumalloc
DPADD+=	/usr/lib/libgnumalloc.a
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
#	$NetBSD: Makefile,v 1.16 1995/04/23 07:58:45 cgd Exp $
d18 2
a19 1
MLINKS= gzip.1 gunzip.1 gzip.1 gzcat.1 gzip.1 zcat.1
d23 2
a25 1
LINKS+= ${BINDIR}/gzip ${BINDIR}/zcat
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
