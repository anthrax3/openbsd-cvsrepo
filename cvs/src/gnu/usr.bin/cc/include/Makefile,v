head	1.13;
access;
symbols
	OPENBSD_6_0:1.10.0.8
	OPENBSD_6_0_BASE:1.10
	OPENBSD_5_9:1.10.0.4
	OPENBSD_5_9_BASE:1.10
	OPENBSD_5_8:1.10.0.6
	OPENBSD_5_8_BASE:1.10
	OPENBSD_5_7:1.10.0.2
	OPENBSD_5_7_BASE:1.10
	OPENBSD_5_6:1.9.0.20
	OPENBSD_5_6_BASE:1.9
	OPENBSD_5_5:1.9.0.18
	OPENBSD_5_5_BASE:1.9
	OPENBSD_5_4:1.9.0.14
	OPENBSD_5_4_BASE:1.9
	OPENBSD_5_3:1.9.0.12
	OPENBSD_5_3_BASE:1.9
	OPENBSD_5_2:1.9.0.10
	OPENBSD_5_2_BASE:1.9
	OPENBSD_5_1_BASE:1.9
	OPENBSD_5_1:1.9.0.8
	OPENBSD_5_0:1.9.0.6
	OPENBSD_5_0_BASE:1.9
	OPENBSD_4_9:1.9.0.4
	OPENBSD_4_9_BASE:1.9
	OPENBSD_4_8:1.9.0.2
	OPENBSD_4_8_BASE:1.9
	OPENBSD_4_7:1.2.0.2
	OPENBSD_4_7_BASE:1.2
	robert_20091015:1.1.1.1
	robert:1.1.1;
locks; strict;
comment	@# @;


1.13
date	2016.11.08.17.39.12;	author tb;	state Exp;
branches;
next	1.12;
commitid	W1UPKCW8N0De6000;

1.12
date	2016.10.16.19.28.44;	author tb;	state Exp;
branches;
next	1.11;
commitid	uHRFWpwUBjIz0UuR;

1.11
date	2016.09.01.11.03.09;	author patrick;	state Exp;
branches;
next	1.10;
commitid	Td6N3CR7rD3d852C;

1.10
date	2014.09.10.04.40.02;	author jsg;	state Exp;
branches;
next	1.9;
commitid	OSFqZwp8DVDhsWk7;

1.9
date	2010.05.17.18.17.55;	author naddy;	state Exp;
branches;
next	1.8;

1.8
date	2010.05.16.07.28.15;	author espie;	state Exp;
branches;
next	1.7;

1.7
date	2010.05.10.18.20.31;	author drahn;	state Exp;
branches;
next	1.6;

1.6
date	2010.05.10.14.17.52;	author marco;	state Exp;
branches;
next	1.5;

1.5
date	2010.05.06.16.49.47;	author robert;	state Exp;
branches;
next	1.4;

1.4
date	2010.05.04.18.37.00;	author naddy;	state Exp;
branches;
next	1.3;

1.3
date	2010.04.25.21.04.27;	author kettenis;	state Exp;
branches;
next	1.2;

1.2
date	2009.11.17.18.53.43;	author robert;	state Exp;
branches;
next	1.1;

1.1
date	2009.10.15.20.50.20;	author robert;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2009.10.15.20.50.20;	author robert;	state Exp;
branches;
next	;


desc
@@


1.13
log
@Set the permissions of the specs file explicitly so that they don't
depend on the umask.  Install headers and info files with group bin
like all the other headers and info files.

ok stefan
@
text
@# $FreeBSD: src/gnu/usr.bin/cc/include/Makefile,v 1.9.8.1 2009/04/15 03:14:26 kensmith Exp $
# $OpenBSD: Makefile,v 1.12 2016/10/16 19:28:44 tb Exp $

.include <bsd.own.mk>

.include "${.CURDIR}/../Makefile.inc"
.include "${.CURDIR}/../Makefile.ver"

.PATH: ${GCCDIR}/config/${GCC_CPU}

INCS?=
.if ${TARGET_ARCH} == "i386" || ${TARGET_ARCH} == "amd64"
INCS=	cpuid.h emmintrin.h mmintrin.h pmmintrin.h xmmintrin.h mm_malloc.h
.elif ${TARGET_ARCH} == "arm"
INCS=	mmintrin.h
.elif ${TARGET_ARCH} == "powerpc"
INCS=	ppc-asm.h altivec.h spe.h
.endif
INCS += unwind.h

mm_malloc.h: pmm_malloc.h
	@@rm -rf ${.TARGET}
	@@cp ${.ALLSRC} ${.TARGET}
CLEANFILES+=	mm_malloc.h

.if ${TARGET_ARCH} == "arm"
unwind.h: ${GCCDIR}/config/arm/unwind-arm.h
	@@rm -rf ${.TARGET}
	@@cp ${.ALLSRC} ${.TARGET}
.else
unwind.h: ${GCCDIR}/unwind-generic.h
	@@rm -rf ${.TARGET}
	@@cp ${.ALLSRC} ${.TARGET}
.endif
CLEANFILES+=	unwind.h

all:	${INCS}

clean: _SUBDIRUSE
	rm -f ${CLEANFILES}

cleandir: _SUBDIRUSE clean

depend:
	# Nothing here so far...

.if ${TARGET_ARCH} == "i386" || ${TARGET_ARCH} == "amd64"
prereq: mm_malloc.h unwind.h
.else
prereq: unwind.h
.endif

.if !empty(INCS)
install includes: ${INCS}
	${INSTALL} -C -o ${BINOWN} -g ${BINGRP} -m ${NONBINMODE} ${.ALLSRC} \
		${DESTDIR}/usr/include
.else
install includes:
	# Nothing here so far...
.endif

tags:
	# Nothing here so far...

.include <bsd.obj.mk>
@


1.12
log
@Move libcrypto, librpcsvc and gnu/usr.bin/cc/include from RDIRS to PRDIRS,
and add prereq targets, so some header files are generated by BUILDUSER
during 'make prereq' instead of by root during 'make includes'.

Switch the order of 'make cleandir' and 'make includes' during 'make build'
so we don't generate many files twice.

Except for some machine@@ symlinks from ${MACHINE}/stand, /usr/obj is now
clean from files generated by root during 'make build'. Those will be
cleaned up in a second step.

help, testing & ok deraadt, input from natano, further testing rpe
@
text
@d2 1
a2 1
# $OpenBSD: Makefile,v 1.11 2016/09/01 11:03:09 patrick Exp $
d55 1
a55 1
	${INSTALL} -C -o ${BINOWN} -g ${LOCALEGRP} -m ${NONBINMODE} ${.ALLSRC} \
@


1.11
log
@Switch OpenBSD/armv7 to ARM EABI (soft-float).  This is a complete ABI
break which cannot be easily crossed.

ok kettenis@@ jsg@@
@
text
@d2 1
a2 1
# $OpenBSD: Makefile,v 1.10 2014/09/10 04:40:02 jsg Exp $
d46 6
@


1.10
log
@Add cpuid.h from clang r197399 with additional feature bits,
and defines for compatibility with the equivalent gcc header.

cpuid.h was introduced in gcc 4.3 and a compatible header has
been included with recent versions of clang.

Earlier version ok miod@@.  Tested in a ports bulk build by landry@@.
@
text
@d2 1
a2 1
# $OpenBSD: Makefile,v 1.9 2010/05/17 18:17:55 naddy Exp $
d26 5
d34 1
@


1.9
log
@always provide "includes" target
@
text
@d2 1
a2 1
# $OpenBSD: Makefile,v 1.8 2010/05/16 07:28:15 espie Exp $
d13 1
a13 1
INCS=	emmintrin.h mmintrin.h pmmintrin.h xmmintrin.h mm_malloc.h
@


1.8
log
@install unwind.h, like for gcc3.
problem spotted by matthieu/naddy
okay kettenis@@, matthieu@@
@
text
@d2 1
a2 1
# $OpenBSD: Makefile,v 1.7 2010/05/10 18:20:31 drahn Exp $
d46 1
a46 1
install:
@


1.7
log
@Switch to using COMPILER_VERSION instead of USE_GCC3, allows for more flexible
complier picking, eg supporting gcc2, gcc3, and gcc4. based on diff by Marco,
with fixes from espie@@.
ok espie@@ general mumbling of approval of others.
@
text
@d2 1
a2 1
# $OpenBSD: Makefile,v 1.6 2010/05/10 14:17:52 marco Exp $
d19 1
d25 5
@


1.6
log
@Fix tags target

ok oga kettenis

committed in the skys over the continental us :-)
@
text
@d2 1
a2 1
# $OpenBSD: Makefile,v 1.5 2010/05/06 16:49:47 robert Exp $
d36 1
a36 1
install: ${INCS}
@


1.5
log
@Add missing cleandir target
@
text
@d2 1
a2 1
# $OpenBSD: Makefile,v 1.4 2010/05/04 18:37:00 naddy Exp $
d43 3
@


1.4
log
@add infrastructure to build GCC 4.2.1 for OpenBSD/alpha; ok kettenis@@
@
text
@d2 1
a2 1
# $OpenBSD: Makefile,v 1.3 2010/04/25 21:04:27 kettenis Exp $
d29 2
@


1.3
log
@Add infrastructure to build GCC 4.2.1 for OpenBSD/hppa.
@
text
@d2 1
a2 1
# $OpenBSD: Makefile,v 1.2 2009/11/17 18:53:43 robert Exp $
d11 1
d33 1
a33 1
.if ${TARGET_ARCH} != "hppa" && ${TARGET_ARCH} != "sparc64"
@


1.2
log
@make this build on sparc64
@
text
@d2 1
a2 1
# $OpenBSD: Makefile,v 1.1.1.1 2009/10/15 20:50:20 robert Exp $
d32 1
a32 1
.if ${TARGET_ARCH} != "sparc64"
@


1.1
log
@Initial revision
@
text
@d2 1
a2 1
# $OpenBSD$
d32 1
d36 4
@


1.1.1.1
log
@Import a BSD make based infrastructure for building gcc, based on the
same solution from FreeBSD.
Don't even try to build it at the moment. This is commited so people can
work on it in tree.
@
text
@@
