head	1.7;
access;
symbols
	OPENBSD_6_1:1.7.0.4
	OPENBSD_6_1_BASE:1.7;
locks; strict;
comment	@# @;


1.7
date	2017.03.27.15.32.38;	author kettenis;	state Exp;
branches;
next	1.6;
commitid	Egec5yAzKmYIwmzS;

1.6
date	2017.01.24.08.44.47;	author patrick;	state Exp;
branches;
next	1.5;
commitid	nAFx1y3cdFPkOgnP;

1.5
date	2017.01.22.07.16.36;	author patrick;	state Exp;
branches;
next	1.4;
commitid	tdgosXE0zTP9WsIu;

1.4
date	2017.01.22.06.07.21;	author patrick;	state Exp;
branches;
next	1.3;
commitid	Mc2ACRXnOpgZLC4u;

1.3
date	2017.01.22.06.00.14;	author patrick;	state Exp;
branches;
next	1.2;
commitid	jqG9weJJTkAGxCJz;

1.2
date	2017.01.22.03.56.33;	author jsg;	state Exp;
branches;
next	1.1;
commitid	TxnimS7C0HXYAyJh;

1.1
date	2017.01.22.03.13.07;	author patrick;	state Exp;
branches;
next	;
commitid	2ASnr5EjM0FoVttJ;


desc
@@


1.7
log
@Do not clobber the default compiler/linker links unless COMPILER_VERSION is
set to clang.

ok jsg@@
@
text
@# $OpenBSD: Makefile,v 1.6 2017/01/24 08:44:47 patrick Exp $

.include <bsd.own.mk>

PROG=	ld.lld
BINDIR=	/usr/bin
SRCS=	lld.cpp
NOMAN=

LDADD+=	-ltermlib
DPADD+=	${LIBTERMLIB}

.if ${COMPILER_VERSION:L} == "clang"
LINKS=	${BINDIR}/ld.lld ${BINDIR}/ld
.endif

CPPFLAGS+=	${CLANG_INCLUDES}
CPPFLAGS+=	-I${.CURDIR}/../../../llvm/tools/lld/include

.PATH:	${.CURDIR}/../../../llvm/tools/lld/tools/lld

depend:
	# Nothing here so far ...

LLVM_LIBDEPS=	lldELF \
		lldConfig \
		lldCore \
		LLVMLTO \
		LLVMPasses \
		LLVMOption \
		LLVMObjCARCOpts \
		LLVMipo \
		LLVMVectorize \
		LLVMLinker \
		LLVMIRReader \
		LLVMAsmParser \
		${BACKEND_ASMPARSER} \
		${BACKEND_CODEGEN} \
		LLVMSelectionDAG \
		LLVMAsmPrinter \
		LLVMCodeGen \
		LLVMTarget \
		LLVMScalarOpts \
		LLVMInstCombine \
		LLVMInstrumentation \
		LLVMProfileData \
		LLVMCoverage \
		LLVMDebugInfoCodeView \
		LLVMDebugInfoDWARF \
		LLVMDebugInfoMSF \
		LLVMGlobalISel \
		LLVMTransformUtils \
		LLVMCoroutines \
		LLVMDemangle \
		LLVMBitWriter \
		LLVMAnalysis \
		${BACKEND_DESC} \
		LLVMObject \
		LLVMMCParser \
		LLVMBitReader \
		LLVMMCDisassembler \
		${BACKEND_INFO} \
		${BACKEND_ASMPRINTER} \
		LLVMMC \
		${BACKEND_UTILS} \
		LLVMCore \
		LLVMSupport

.include <bsd.prog.mk>
@


1.6
log
@Update clang build infrastructure for LLVM 4.0.0

Discussed with kettenis@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2017/01/22 07:16:36 patrick Exp $
d13 1
d15 1
@


1.5
log
@Always provide clang as cc, c++ and cpp, and lld as ld.

Per discussion with deraadt@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2017/01/22 06:07:21 patrick Exp $
d23 1
a23 2
LLVM_LIBDEPS=	lldCore \
		lldELF \
d25 1
d47 2
d51 2
@


1.4
log
@On clang architectures cc, c++ and cpp are provided by clang.  Also,
ld is provided by lld.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2017/01/22 06:00:14 patrick Exp $
a12 1
.if ${COMPILER_VERSION:L} == "clang"
a13 1
.endif
@


1.3
log
@Compile and install lld as ld.lld, since that's what the ecosystem
is expecting.

Prompted and ok by kettenis@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2017/01/22 03:56:33 jsg Exp $
d12 4
@


1.2
log
@Include bsd.own.mk in a few more places to pick up mk.conf overrides.
ok patrick@@ tb@@ kettenis@@ phessler@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1 2017/01/22 03:13:07 patrick Exp $
d5 1
a5 1
PROG=	lld
@


1.1
log
@Add build infrastructure for lld.

ok kettenis@@
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.2 2017/01/14 20:12:41 patrick Exp $
@

