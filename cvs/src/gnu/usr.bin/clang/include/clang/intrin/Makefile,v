head	1.12;
access;
symbols
	OPENBSD_6_2:1.12.0.2
	OPENBSD_6_2_BASE:1.12
	OPENBSD_6_1:1.6.0.4
	OPENBSD_6_1_BASE:1.6;
locks; strict;
comment	@# @;


1.12
date	2017.07.09.15.28.34;	author espie;	state Exp;
branches;
next	1.11;
commitid	AZstanCImDR1vYEO;

1.11
date	2017.04.28.11.28.20;	author kettenis;	state Exp;
branches;
next	1.10;
commitid	NdPHNawqZUFfU8r6;

1.10
date	2017.04.20.10.32.23;	author kettenis;	state Exp;
branches;
next	1.9;
commitid	SEbGeMzNJHByswBx;

1.9
date	2017.04.12.08.02.10;	author jsg;	state Exp;
branches;
next	1.8;
commitid	ojRLX4ZdmUMX8nnw;

1.8
date	2017.04.12.07.57.06;	author jsg;	state Exp;
branches;
next	1.7;
commitid	pY7L56jGhDxRK402;

1.7
date	2017.04.10.13.36.04;	author kettenis;	state Exp;
branches;
next	1.6;
commitid	hJBciTSf2j5WbdHq;

1.6
date	2017.01.24.08.44.47;	author patrick;	state Exp;
branches;
next	1.5;
commitid	nAFx1y3cdFPkOgnP;

1.5
date	2017.01.14.20.12.41;	author patrick;	state Exp;
branches;
next	1.4;
commitid	kbn8tb0boeY90was;

1.4
date	2017.01.07.09.50.08;	author kettenis;	state Exp;
branches;
next	1.3;
commitid	u6lWxPwF1HsjrPZV;

1.3
date	2017.01.06.14.44.34;	author kettenis;	state Exp;
branches;
next	1.2;
commitid	sa15KxQ1czW3Z0Yu;

1.2
date	2016.09.08.18.05.30;	author pascal;	state Exp;
branches;
next	1.1;
commitid	RnjtRta5I7had33R;

1.1
date	2016.09.05.10.56.48;	author pascal;	state Exp;
branches;
next	;
commitid	p5QyrbFA5GyiOio3;


desc
@@


1.12
log
@zap empty depends/silence empty installs.
okay millert@@
@
text
@# $OpenBSD: Makefile,v 1.11 2017/04/28 11:28:20 kettenis Exp $

.include <bsd.own.mk>

LLVM_V=			4.0.0
CLANG_INTR_INCDIR=	/usr/lib/clang/${LLVM_V}/include

TBLGEN= ${.OBJDIR}/../../../clang-tblgen/clang-tblgen
CLANG_INC=${.CURDIR}/../../../../../llvm/tools/clang/include

.PATH:	${.CURDIR}/../../../../../llvm/tools/clang/lib/Headers

GEN=
HEADERS=	stdalign.h \
		stdatomic.h \
		stdnoreturn.h \
		tgmath.h \
		unwind.h \
		varargs.h \
		module.modulemap \

.if ${MACHINE_ARCH} == "aarch64" || ${MACHINE_ARCH} == "arm"
GEN+=		arm_neon.h
HEADERS+=	arm_acle.h ${GEN}
.elif ${MACHINE_ARCH} == "amd64" || ${MACHINE_ARCH} == "i386"
HEADERS+=	adxintrin.h \
		ammintrin.h \
		avx2intrin.h \
		avx512bwintrin.h \
		avx512cdintrin.h \
		avx512dqintrin.h \
		avx512erintrin.h \
		avx512fintrin.h \
		avx512ifmaintrin.h \
		avx512ifmavlintrin.h \
		avx512pfintrin.h \
		avx512vbmiintrin.h \
		avx512vbmivlintrin.h \
		avx512vlbwintrin.h \
		avx512vlcdintrin.h \
		avx512vldqintrin.h \
		avx512vlintrin.h \
		avxintrin.h \
		bmi2intrin.h \
		bmiintrin.h \
		cpuid.h \
		clflushoptintrin.h \
		emmintrin.h \
		f16cintrin.h \
		fma4intrin.h \
		fmaintrin.h \
		fxsrintrin.h \
		ia32intrin.h \
		immintrin.h \
		lzcntintrin.h \
		mm3dnow.h \
		mmintrin.h \
		mm_malloc.h \
		mwaitxintrin.h \
		nmmintrin.h \
		pkuintrin.h \
		pmmintrin.h \
		popcntintrin.h \
		prfchwintrin.h \
		rdseedintrin.h \
		rtmintrin.h \
		shaintrin.h \
		smmintrin.h \
		tbmintrin.h \
		tmmintrin.h \
		wmmintrin.h \
		__wmmintrin_aes.h \
		__wmmintrin_pclmul.h \
		x86intrin.h \
		xmmintrin.h \
		xopintrin.h \
		xsaveintrin.h \
		xsaveoptintrin.h \
		xsavecintrin.h \
		xsavesintrin.h \
		xtestintrin.h
.elif ${MACHINE_ARCH} == "powerpc"
HEADERS+=	altivec.h \
		htmintrin.h \
		htmxlintrin.h
.endif

all:	${HEADERS}

clean cleandir:
	rm -f ${GEN}

install includes: ${HEADERS}
.for dir in /usr/lib/clang /usr/lib/clang/${LLVM_V} ${CLANG_INTR_INCDIR}
	${INSTALL} -d -o ${BINOWN} -g ${BINGRP} -m ${DIRMODE} \
	    ${DESTDIR}${dir}
.endfor
	${INSTALL} ${INSTALL_COPY} -o ${BINOWN} -g ${BINGRP} -m 444 \
	    ${.ALLSRC} ${DESTDIR}${CLANG_INTR_INCDIR}

arm_neon.h: ${CLANG_INC}/clang/Basic/arm_neon.td
	${TBLGEN} -gen-arm-neon -o ${.TARGET} ${.ALLSRC}

.include <bsd.obj.mk>
@


1.11
log
@Install a few more x86 intrinsics header files.

spotted by espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2017/04/20 10:32:23 kettenis Exp $
a88 3

depend:
	# Nothing here so far ...
@


1.10
log
@Install clflushoptintrin.h and move pkuintrin.h such that the list is
properly sorted.

pointed out by espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2017/04/12 08:02:10 jsg Exp $
d31 1
d34 5
d40 2
a42 2
		avx512dqintrin.h \
		avx512vldqintrin.h \
d59 1
d71 1
a72 1
		wmmintrin.h \
@


1.9
log
@explicitly set the ownership on installed include files as well
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2017/04/12 07:57:06 jsg Exp $
a36 1
		pkuintrin.h \
d41 1
d54 1
@


1.8
log
@Invoke install -d for each directory in the /usr/lib/clang hierarchy
as they aren't in mtree.  Problem with wrong ownership and permission
of directories reported by sthen@@.

ok deraadt@@ sthen@@ tb@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2017/04/10 13:36:04 kettenis Exp $
d91 1
a91 1
		${DESTDIR}${dir}
d93 2
a94 2
	${INSTALL} ${INSTALL_COPY} -m 444 ${.ALLSRC} \
		${DESTDIR}${CLANG_INTR_INCDIR}
@


1.7
log
@Generate and install arm_neon.h on arm and arm64.

ok jsg@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2017/01/24 08:44:47 patrick Exp $
d89 4
a92 2
	${INSTALL} -d -o ${SHAREOWN} -g ${SHAREGRP} -m ${DIRMODE} \
		${DESTDIR}${CLANG_INTR_INCDIR}
@


1.6
log
@Update clang build infrastructure for LLVM 4.0.0

Discussed with kettenis@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2017/01/14 20:12:41 patrick Exp $
d8 3
d13 1
d23 2
a24 1
HEADERS+=	arm_acle.h
d86 1
a86 1
	# Nothing here so far ...
d93 3
@


1.5
log
@Update clang build infrastructure for LLVM 3.9.1

"go ahead" kettenis@@
"just go ahead" deraadt@@
"sounds good to me" stefan@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2017/01/07 09:50:08 kettenis Exp $
d5 1
a5 1
LLVM_V=			3.9.1
@


1.4
log
@Only install header files relevant for the architecture we're targeting.

ok patrick@@, jsg@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2017/01/06 14:44:34 kettenis Exp $
d5 1
a5 1
LLVM_V=			3.8.1
@


1.3
log
@Don't install standard C headers for which we already have a proper system
version.  Also don't install vadefs.h which is a microsoft invention.

ok patrick@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2016/09/08 18:05:30 pascal Exp $
d10 64
a73 64
HEADERS=adxintrin.h \
	altivec.h \
	ammintrin.h \
	arm_acle.h \
	avx2intrin.h \
	avx512bwintrin.h \
	avx512cdintrin.h \
	avx512erintrin.h \
	avx512fintrin.h \
	avx512vlbwintrin.h \
	avx512vlintrin.h \
	avx512dqintrin.h \
	avx512vldqintrin.h \
	pkuintrin.h \
	avxintrin.h \
	bmi2intrin.h \
	bmiintrin.h \
	__clang_cuda_runtime_wrapper.h \
	cpuid.h \
	cuda_builtin_vars.h \
	emmintrin.h \
	f16cintrin.h \
	fma4intrin.h \
	fmaintrin.h \
	fxsrintrin.h \
	htmintrin.h \
	htmxlintrin.h \
	ia32intrin.h \
	immintrin.h \
	Intrin.h \
	lzcntintrin.h \
	mm3dnow.h \
	mmintrin.h \
	mm_malloc.h \
	module.modulemap \
	nmmintrin.h \
	pmmintrin.h \
	popcntintrin.h \
	prfchwintrin.h \
	rdseedintrin.h \
	rtmintrin.h \
	s390intrin.h \
	shaintrin.h \
	smmintrin.h \
	stdalign.h \
	stdatomic.h \
	stdnoreturn.h \
	tbmintrin.h \
	tgmath.h \
	tmmintrin.h \
	unwind.h \
	varargs.h \
	vecintrin.h \
	__wmmintrin_aes.h \
	wmmintrin.h \
	__wmmintrin_pclmul.h \
	x86intrin.h \
	xmmintrin.h \
	xopintrin.h \
	xsaveintrin.h \
	xsaveoptintrin.h \
	xsavecintrin.h \
	xsavesintrin.h \
	xtestintrin.h
@


1.2
log
@Have "make cleandir" work everywhere in the clang tree.

noticed by and ok jsg@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1 2016/09/05 10:56:48 pascal Exp $
a31 1
	float.h \
a39 3
	inttypes.h \
	iso646.h \
	limits.h \
a54 1
	stdarg.h \
a55 4
	stdbool.h \
	stddef.h \
	__stddef_max_align_t.h \
	stdint.h \
a60 1
	vadefs.h \
@


1.1
log
@LLVM/Clang build system.  This only builds the bare minimum of what is needed
to get a working "clang" binary.

Note that you need GCC from ports to bootstrap clang.

looks good to patrick@@, ok jsg@@ kettenis@@
@
text
@d1 1
a1 1
# $OpenBSD$
d90 1
a90 1
clean:
@

