head	1.10;
access;
symbols
	OPENBSD_5_2:1.9.0.28
	OPENBSD_5_2_BASE:1.9
	OPENBSD_5_1_BASE:1.9
	OPENBSD_5_1:1.9.0.26
	OPENBSD_5_0:1.9.0.24
	OPENBSD_5_0_BASE:1.9
	OPENBSD_4_9:1.9.0.22
	OPENBSD_4_9_BASE:1.9
	OPENBSD_4_8:1.9.0.20
	OPENBSD_4_8_BASE:1.9
	OPENBSD_4_7:1.9.0.16
	OPENBSD_4_7_BASE:1.9
	OPENBSD_4_6:1.9.0.18
	OPENBSD_4_6_BASE:1.9
	OPENBSD_4_5:1.9.0.14
	OPENBSD_4_5_BASE:1.9
	OPENBSD_4_4:1.9.0.12
	OPENBSD_4_4_BASE:1.9
	OPENBSD_4_3:1.9.0.10
	OPENBSD_4_3_BASE:1.9
	OPENBSD_4_2:1.9.0.8
	OPENBSD_4_2_BASE:1.9
	OPENBSD_4_1:1.9.0.6
	OPENBSD_4_1_BASE:1.9
	OPENBSD_4_0:1.9.0.4
	OPENBSD_4_0_BASE:1.9
	OPENBSD_3_9:1.9.0.2
	OPENBSD_3_9_BASE:1.9
	OPENBSD_3_8:1.8.0.12
	OPENBSD_3_8_BASE:1.8
	OPENBSD_3_7:1.8.0.10
	OPENBSD_3_7_BASE:1.8
	OPENBSD_3_6:1.8.0.8
	OPENBSD_3_6_BASE:1.8
	OPENBSD_3_5:1.8.0.6
	OPENBSD_3_5_BASE:1.8
	OPENBSD_3_4:1.8.0.4
	OPENBSD_3_4_BASE:1.8
	OPENBSD_3_3:1.8.0.2
	OPENBSD_3_3_BASE:1.8
	OPENBSD_3_2:1.7.0.2
	OPENBSD_3_2_BASE:1.7
	OPENBSD_3_1:1.6.0.4
	OPENBSD_3_1_BASE:1.6
	OPENBSD_3_0:1.6.0.2
	OPENBSD_3_0_BASE:1.6
	OPENBSD_2_9:1.5.0.4
	OPENBSD_2_9_BASE:1.5
	OPENBSD_2_8:1.5.0.2
	OPENBSD_2_8_BASE:1.5
	OPENBSD_2_7:1.4.0.10
	OPENBSD_2_7_BASE:1.4
	OPENBSD_2_6:1.4.0.8
	OPENBSD_2_6_BASE:1.4
	OPENBSD_2_5:1.4.0.6
	OPENBSD_2_5_BASE:1.4
	OPENBSD_2_4:1.4.0.4
	OPENBSD_2_4_BASE:1.4
	OPENBSD_2_3:1.4.0.2
	OPENBSD_2_3_BASE:1.4
	OPENBSD_2_2:1.3.0.6
	OPENBSD_2_2_BASE:1.3
	OPENBSD_2_1:1.3.0.4
	OPENBSD_2_1_BASE:1.3
	OPENBSD_2_0:1.3.0.2
	OPENBSD_2_0_BASE:1.3
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@# @;


1.10
date	2013.02.02.13.47.17;	author miod;	state dead;
branches;
next	1.9;

1.9
date	2005.09.28.23.54.03;	author deraadt;	state Exp;
branches;
next	1.8;

1.8
date	2002.12.12.09.54.46;	author markus;	state Exp;
branches;
next	1.7;

1.7
date	2002.05.11.00.20.18;	author espie;	state Exp;
branches;
next	1.6;

1.6
date	2001.09.06.19.09.29;	author espie;	state Exp;
branches;
next	1.5;

1.5
date	2000.05.25.21.49.02;	author deraadt;	state Exp;
branches;
next	1.4;

1.4
date	98.03.26.19.47.20;	author niklas;	state Exp;
branches;
next	1.3;

1.3
date	96.09.15.09.55.40;	author niklas;	state Exp;
branches;
next	1.2;

1.2
date	95.12.25.22.35.15;	author niklas;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.40.58;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.40.58;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.10
log
@The a.out rtld is no longer used.
@
text
@#	$OpenBSD: Makefile,v 1.9 2005/09/28 23:54:03 deraadt Exp $
#	$NetBSD: Makefile,v 1.11 1995/10/09 00:11:24 pk Exp $

.include <bsd.own.mk>

TARGET_MACHINE_ARCH?=	$(MACHINE_ARCH)

.if !defined(NOPIC) && ($(TARGET_MACHINE_ARCH) == $(MACHINE_ARCH))
PROG=	ld.so
SRCS=	mdprologue.S rtld.c malloc.c shlib.c etc.c md.c vfprintf.c
LDDIR?= $(.CURDIR)/..
LIBCRT0=
#PICFLAG=-pic
# As there is relocation going on behind GCC's back, don't cache function addresses.
PICFLAG=-fpic -fno-function-cse
CFLAGS+=-I$(LDDIR) -I$(.CURDIR) -I$(LDDIR)/$(MACHINE_ARCH) $(PICFLAG) -DRTLD -DLIBC_SCCS
LDFLAGS+=-nostartfiles -nostdlib -Wl,-Bshareable,-Bsymbolic,-assert,nosymbolic
ASFLAGS+=-k
DPADD+= ${LIBC}
LDADD+=	-lc_pic
BINDIR= /usr/libexec

.else
NOPROG=
.endif

MAN= ld.so.1

.PATH: $(LDDIR) $(LDDIR)/$(MACHINE_ARCH) ${.CURDIR}/../../../../lib/libc/stdio

.S.o:
	${CPP} ${.IMPSRC} | ${AS} ${ASFLAGS} -o ${.TARGET} -

.include <bsd.prog.mk>
@


1.9
log
@enter rtld, to install the man page at least
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.8 2002/12/12 09:54:46 markus Exp $
@


1.8
log
@don't link LIBCRT0 into ld.so (for DESTDIR builds); PR2928; ok fgsch@@, millert@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.7 2002/05/11 00:20:18 espie Exp $
d4 5
a10 2
#NOMAN=	noman
MAN= ld.so.1
d22 6
@


1.7
log
@Add missing libraries to bsd.prog.mk (mostly kerberosV)
Use them in DPADD throughout the tree.
Fix a few mispells (LIBMATH -> LIBM...)
Wipe obsolete lib (LIBRESOLV)
Sort added missing libraries, move obsolete stuff apart.
Synch documentation in bsd.README

ok deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.6 2001/09/06 19:09:29 espie Exp $
d9 1
@


1.6
log
@Use ${CC} to link ld.so, so that it will grok whatever you throw at
it in COPTS/DEBUG.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.5 2000/05/25 21:49:02 deraadt Exp $
d15 1
@


1.5
log
@rename rtld(1) to ld.so(1)
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.4 1998/03/26 19:47:20 niklas Exp $
d13 1
a13 1
LDFLAGS+=-Bshareable -Bsymbolic -assert nosymbolic
a18 8

.if defined(DESTDIR)
$(PROG):
	$(LD) -o $(PROG) $(LDFLAGS) -nostdlib -L${DESTDIR}/usr/lib $(OBJS) $(LDADD)
.else
$(PROG):
	$(LD) -o $(PROG) $(LDFLAGS) $(OBJS) $(LDADD)
.endif
@


1.4
log
@RCS id cleanup
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.11 1995/10/09 00:11:24 pk Exp $
d7 1
a7 1
MAN= rtld.1
a16 1
MLINKS=	rtld.1 ld.so.1
@


1.3
log
@Build correctly when DESTDIR set
@
text
@d1 1
@


1.2
log
@As ld.so does relocation behind the compiler's back don't cache
function addresses in registers.
@
text
@d20 4
d26 1
@


1.1
log
@Initial revision
@
text
@d9 2
a10 1
PICFLAG=-fpic
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
