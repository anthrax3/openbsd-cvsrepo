head	1.26;
access;
symbols
	OPENBSD_5_5:1.23.0.4
	OPENBSD_5_5_BASE:1.23
	OPENBSD_5_4:1.22.0.4
	OPENBSD_5_4_BASE:1.22
	OPENBSD_5_3:1.22.0.2
	OPENBSD_5_3_BASE:1.22
	OPENBSD_5_2:1.20.0.6
	OPENBSD_5_2_BASE:1.20
	OPENBSD_5_1_BASE:1.20
	OPENBSD_5_1:1.20.0.4
	OPENBSD_5_0:1.20.0.2
	OPENBSD_5_0_BASE:1.20
	OPENBSD_4_9:1.19.0.2
	OPENBSD_4_9_BASE:1.19
	OPENBSD_4_8:1.18.0.4
	OPENBSD_4_8_BASE:1.18
	OPENBSD_4_7:1.18.0.2
	OPENBSD_4_7_BASE:1.18
	OPENBSD_4_6:1.17.0.4
	OPENBSD_4_6_BASE:1.17
	OPENBSD_4_5:1.16.0.20
	OPENBSD_4_5_BASE:1.16
	OPENBSD_4_4:1.16.0.18
	OPENBSD_4_4_BASE:1.16
	OPENBSD_4_3:1.16.0.16
	OPENBSD_4_3_BASE:1.16
	OPENBSD_4_2:1.16.0.14
	OPENBSD_4_2_BASE:1.16
	OPENBSD_4_1:1.16.0.12
	OPENBSD_4_1_BASE:1.16
	OPENBSD_4_0:1.16.0.10
	OPENBSD_4_0_BASE:1.16
	OPENBSD_3_9:1.16.0.8
	OPENBSD_3_9_BASE:1.16
	OPENBSD_3_8:1.16.0.6
	OPENBSD_3_8_BASE:1.16
	OPENBSD_3_7:1.16.0.4
	OPENBSD_3_7_BASE:1.16
	OPENBSD_3_6:1.16.0.2
	OPENBSD_3_6_BASE:1.16
	OPENBSD_3_5:1.12.0.4
	OPENBSD_3_5_BASE:1.12
	OPENBSD_3_4:1.12.0.2
	OPENBSD_3_4_BASE:1.12
	OPENBSD_3_3:1.11.0.12
	OPENBSD_3_3_BASE:1.11
	OPENBSD_3_2:1.11.0.10
	OPENBSD_3_2_BASE:1.11
	OPENBSD_3_1:1.11.0.8
	OPENBSD_3_1_BASE:1.11
	OPENBSD_3_0:1.11.0.6
	OPENBSD_3_0_BASE:1.11
	OPENBSD_2_9:1.11.0.4
	OPENBSD_2_9_BASE:1.11
	OPENBSD_2_8:1.11.0.2
	OPENBSD_2_8_BASE:1.11
	OPENBSD_2_7:1.9.0.2
	OPENBSD_2_7_BASE:1.9
	OPENBSD_2_6:1.5.0.2
	OPENBSD_2_6_BASE:1.5
	OPENBSD_2_5:1.4.0.2
	OPENBSD_2_5_BASE:1.4
	OPENBSD_2_4:1.3.0.2
	OPENBSD_2_4_BASE:1.3
	OPENBSD_2_3:1.2.0.2
	OPENBSD_2_3_BASE:1.2;
locks; strict;
comment	@# @;


1.26
date	2014.07.23.19.13.23;	author deraadt;	state dead;
branches;
next	1.25;
commitid	EcR8E7r0stjLUV4p;

1.25
date	2014.07.11.19.35.54;	author daniel;	state Exp;
branches;
next	1.24;
commitid	JIFCnbOkk3pDkk7h;

1.24
date	2014.04.15.20.55.42;	author miod;	state Exp;
branches;
next	1.23;

1.23
date	2013.08.06.19.05.57;	author miod;	state Exp;
branches;
next	1.22;

1.22
date	2013.02.19.05.42.50;	author brad;	state Exp;
branches;
next	1.21;

1.21
date	2012.11.04.13.40.51;	author miod;	state Exp;
branches;
next	1.20;

1.20
date	2011.06.23.22.46.12;	author schwarze;	state Exp;
branches;
next	1.19;

1.19
date	2010.09.06.17.35.57;	author naddy;	state Exp;
branches;
next	1.18;

1.18
date	2009.08.08.12.20.30;	author fgsch;	state Exp;
branches;
next	1.17;

1.17
date	2009.05.31.09.16.50;	author avsm;	state Exp;
branches;
next	1.16;

1.16
date	2004.07.05.08.33.54;	author miod;	state Exp;
branches;
next	1.15;

1.15
date	2004.06.24.20.44.06;	author deraadt;	state Exp;
branches;
next	1.14;

1.14
date	2004.06.21.19.13.21;	author deraadt;	state Exp;
branches;
next	1.13;

1.13
date	2004.06.21.16.53.11;	author avsm;	state Exp;
branches;
next	1.12;

1.12
date	2003.05.01.18.59.36;	author avsm;	state Exp;
branches;
next	1.11;

1.11
date	2000.07.31.20.54.57;	author espie;	state Exp;
branches;
next	1.10;

1.10
date	2000.06.28.18.53.46;	author deraadt;	state Exp;
branches;
next	1.9;

1.9
date	2000.04.30.21.45.01;	author maja;	state Exp;
branches;
next	1.8;

1.8
date	2000.04.21.18.53.15;	author deraadt;	state Exp;
branches;
next	1.7;

1.7
date	2000.03.25.18.16.42;	author maja;	state Exp;
branches;
next	1.6;

1.6
date	99.12.21.04.07.23;	author fgsch;	state Exp;
branches;
next	1.5;

1.5
date	99.06.07.00.45.37;	author deraadt;	state Exp;
branches;
next	1.4;

1.4
date	98.12.05.19.43.46;	author kstailey;	state Exp;
branches;
next	1.3;

1.3
date	98.10.18.20.02.35;	author millert;	state Exp;
branches;
next	1.2;

1.2
date	98.03.14.17.16.06;	author maja;	state Exp;
branches;
next	1.1;

1.1
date	98.03.11.20.06.32;	author maja;	state Exp;
branches;
next	;


desc
@@


1.26
log
@delinked from tree, now it goes to the bit bucket
@
text
@#	$OpenBSD: Makefile.bsd-wrapper,v 1.25 2014/07/11 19:35:54 daniel Exp $

MAN=	lynx.1
CLEANFILES+= lynx.1
DPADD=	${LIBSSL} ${LIBCRYPTO}

GNUCFLAGS=	CC="${CC}" CFLAGS="${CFLAGS} ${COPTS} ${OPT}" LDFLAGS="${LDFLAGS}"
CONFIGURE_ARGS= --with-ssl=/usr --enable-widec --enable-ipv6 --enable-debug \
		--disable-bibp-urls --disable-finger

HTMLDIR=	/usr/share/doc/html
HELPFILES=	keystrokes/alt_edit_help.html keystrokes/bookmark_help.html \
		keystrokes/cookie_help.html keystrokes/dired_help.html \
		keystrokes/edit_help.html keystrokes/environments.html \
		keystrokes/follow_help.html keystrokes/gopher_types_help.html \
		keystrokes/history_help.html keystrokes/keystroke_help.html \
		keystrokes/movement_help.html keystrokes/option_help.html \
		keystrokes/other_help.html keystrokes/print_help.html \
		keystrokes/scrolling_help.html keystrokes/test_display.html \
		keystrokes/visited_help.html keystrokes/xterm_help.html \
		keystrokes/bashlike_edit_help.html Lynx_users_guide.html \
		about_lynx.html lynx-dev.html lynx_help_main.html lynx_url_support.html

.include <bsd.own.mk>

all:	config.status
	${MAKE}

.FORCE:	.IGNORE

.ifdef GLOBAL_AUTOCONF_CACHE
CF=	--cache-file=${GLOBAL_AUTOCONF_CACHE}
.else
CF=
.endif

config: .FORCE
.ifndef GLOBAL_AUTOCONF_CACHE
	-rm -f config.cache
.endif
	PATH="/bin:/usr/bin:/sbin:/usr/sbin" \
	${GNUCFLAGS} \
	INSTALL_PROGRAM="${INSTALL} ${INSTALL_COPY} ${INSTALL_STRIP}" \
	TELNET=/usr/bin/false \
	RLOGIN=/usr/bin/false \
	TN3270=/usr/bin/false \
	sh ${.CURDIR}/configure --prefix=/usr --sysconfdir=/etc --disable-color-style ${CONFIGURE_ARGS}

config.status:
	PATH="/bin:/usr/bin:/sbin:/usr/sbin" \
	${GNUCFLAGS} \
	INSTALL_PROGRAM="${INSTALL} ${INSTALL_COPY} ${INSTALL_STRIP}" \
	TELNET=/usr/bin/false \
	RLOGIN=/usr/bin/false \
	TN3270=/usr/bin/false \
	sh ${.CURDIR}/configure --prefix=/usr --sysconfdir=/etc --disable-color-style ${CONFIGURE_ARGS} ${CF}

lynx.1:	${.CURDIR}/lynx.man
	-cp -p ${.ALLSRC} ${.TARGET}

.ifdef NOMAN
maninstall: 
	@@echo NOMAN is set
.endif

helpinstall:
	@@-for i in ${HELPFILES}; do \
		j=`dirname $$i`; \
		echo "Installing ${DESTDIR}${HTMLDIR}/lynx_help/$$i"; \
		${INSTALL} ${INSTALL_COPY} -g ${BINGRP} -m 444 \
		${.CURDIR}/lynx_help/$$i ${DESTDIR}${HTMLDIR}/lynx_help/$$j/; \
	done

install: maninstall helpinstall
	${INSTALL} ${INSTALL_COPY} ${INSTALL_STRIP} -o ${BINOWN} \
	    -g ${BINGRP} -m ${BINMODE} lynx ${DESTDIR}/usr/bin/lynx

distribution:
	${INSTALL} ${INSTALL_COPY} -o ${BINOWN} -g ${BINGRP} -m ${NONBINMODE} \
            ${.CURDIR}/lynx.cfg ${DESTDIR}/etc/lynx.cfg

clean cleandir:
	-@@if [ -e makefile ]; then ${MAKE} distclean; fi
	rm -f ${CLEANFILES}

depend:
	# Nothing here so far...

lint:
	# Nothing here so far...

tags:
	# Nothing here so far...

.include <bsd.obj.mk>
.include <bsd.subdir.mk>
.ifndef NOMAN
.include <bsd.man.mk>
.endif
@


1.25
log
@start reducing the attack surface of lynx.

leave gopher, news, and dired in place for now. but we will soon catch up
to the security level of internet explorer 7 by removing these too.

ok's for the version of this diff that removes even more protocols from
deraadt@@, tedu@@. general support from other devs.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.bsd-wrapper,v 1.24 2014/04/15 20:55:42 miod Exp $
@


1.24
log
@Remove workarounds for ld reaching MAXDSIZ on vax, now that MAXDSIZ is
more comfortable.
Reminded by brad@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.bsd-wrapper,v 1.23 2013/08/06 19:05:57 miod Exp $
d8 3
a10 1
CONFIGURE_ARGS= --with-ssl=/usr --enable-widec --enable-ipv6 --enable-debug
d44 3
d53 3
@


1.23
log
@Switch vax to gcc 3.3.6.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.bsd-wrapper,v 1.22 2013/02/19 05:42:50 brad Exp $
a5 4

.if (${MACHINE} == "vax")
LDFLAGS+=	-Wl,--no-keep-memory
.endif
@


1.22
log
@Remove m68k optimizer workaround.

ok miod@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.bsd-wrapper,v 1.21 2012/11/04 13:40:51 miod Exp $
d8 1
a8 1
OPT=-O0
d11 1
a11 1
GNUCFLAGS=	CC="${CC}" CFLAGS="${CFLAGS} ${COPTS} ${OPT}"
@


1.21
log
@Less pessimistic OPT value for m68k.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.bsd-wrapper,v 1.20 2011/06/23 22:46:12 schwarze Exp $
a8 2
.elif (${MACHINE_ARCH} == "m68k")
OPT=-O2 -fno-rerun-loop-opt
@


1.20
log
@switch to installing source manuals (base part)
discussed with lots of people, tested by naddy@@,
"move fast" deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.bsd-wrapper,v 1.19 2010/09/06 17:35:57 naddy Exp $
d10 1
a10 1
OPT=-O1
@


1.19
log
@enable wide character support; ok nicm@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.bsd-wrapper,v 1.18 2009/08/08 12:20:30 fgsch Exp $
d4 1
a4 1
CLEANFILES=	lynx.cat1 lynx.1
d30 1
a30 7
.ifdef NOMAN
LYNX_CAT1=
.else
LYNX_CAT1=lynx.cat1
.endif

all:	config.status ${LYNX_CAT1}
@


1.18
log
@Actually, add --enable-debug to configure so -g is not stripped if specified
and remove the patch from configure so we don't need to worry in the future.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.bsd-wrapper,v 1.17 2009/05/31 09:16:50 avsm Exp $
d14 1
a14 1
CONFIGURE_ARGS= --with-ssl=/usr --enable-ipv6 --enable-debug
@


1.17
log
@Update to lynx-2.8.6.rel5, with our local patches maintained where relevant.
tests from miod@@ sthen@@ jmc@@ jsing@@
two additional fixes from miod:
- fix uninitialized stack variable use, leading to occasional crash.
- modify the socklen_t test to include <sys/types.h>, fixes gcc2 build failures
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.bsd-wrapper,v 1.16 2004/07/05 08:33:54 miod Exp $
d14 1
a14 1
CONFIGURE_ARGS= --with-ssl=/usr --enable-ipv6
@


1.16
log
@Compile at -O1 on m68k, sig11 in LYMainLoop at -O2.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.bsd-wrapper,v 1.15 2004/06/24 20:44:06 deraadt Exp $
d54 1
a54 1
	sh ${.CURDIR}/configure --prefix=/usr --libdir=/etc ${CONFIGURE_ARGS}
d60 1
a60 1
	sh ${.CURDIR}/configure --prefix=/usr --libdir=/etc ${CONFIGURE_ARGS} ${CF}
@


1.15
log
@let vax build lynx (workaround); miod ok
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.bsd-wrapper,v 1.14 2004/06/21 19:13:21 deraadt Exp $
d9 2
@


1.14
log
@back out CPP change; obviously not tested.  On at least arm, kills at
least ANSI_VARARGS deep inside the configure.  Sorry -- try again.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.bsd-wrapper,v 1.12 2003/05/01 18:59:36 avsm Exp $
d6 6
a11 1
GNUCFLAGS=	CC="${CC}" CFLAGS="${CFLAGS} ${COPTS}"
@


1.13
log
@propagate CPP to build system as well, millert@@ ok
@
text
@d6 1
a6 1
GNUCFLAGS=	CC="${CC}" CFLAGS="${CFLAGS} ${COPTS}" CPP="${CPP}"
@


1.12
log
@Update to lynx-2.8.4-rel1, patchset d, now with IPv6 as well

Local patches we maintain to the distribution are:
- replace unbounded fscanf with fgets (avsm)
- spelling fixes (deraadt)
- hppa -O0 workaround (mickey)
- default to ftp passive (deraadt)
- work with non-exec scripts (deraadt,hin,maja)
- be more careful with rlogin username (art)
- default to our webpage (deraadt)
- install helpfiles locally (maja)
- mkdtemp temp space directory (art)
- install more recent config.guess (avsm)

Tested by beck,millert,grange,fries,miod and others, deraadt@@ ok
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.bsd-wrapper,v 1.11 2000/07/31 20:54:57 espie Exp $
d6 1
a6 1
GNUCFLAGS=	CC="${CC}" CFLAGS="${CFLAGS} ${COPTS}"
@


1.11
log
@Don't try to pass GNUCFLAGS over to submakes, wrecks havok with POSIX make
rules.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.bsd-wrapper,v 1.10 2000/06/28 18:53:46 deraadt Exp $
d4 1
a4 1
CLEANFILES=	lynx.1
d6 2
a7 2
LDADD=	-lssl -lcrypto
GNUCFLAGS=	CC="${CC}" CFLAGS="${CFLAGS} -DUSE_SSL ${COPTS}"
d18 2
a19 2
		Lynx_users_guide.html about_lynx.html lynx-dev.html \
		lynx_help_main.html lynx_url_support.html
d47 1
a47 1
	sh ${.CURDIR}/configure --prefix=/usr --libdir=/etc 
d53 1
a53 1
	sh ${.CURDIR}/configure --prefix=/usr --libdir=/etc ${CF}
@


1.10
log
@integrate USE_SSL into real settings; wd@@ics.nara-wu.ac.jp
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.bsd-wrapper,v 1.9 2000/04/30 21:45:01 maja Exp $
d30 1
a30 1
	${MAKE} ${GNUCFLAGS}
@


1.9
log
@disable GLOBAL_AUTOCONF_CACHE for the moment, since it doesn't work. Noticed by millert@@. -moj
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.bsd-wrapper,v 1.8 2000/04/21 18:53:15 deraadt Exp $
a3 1
COPTS+=	-DUSE_SSL
d7 1
a7 1
GNUCFLAGS=	CC="${CC}" CFLAGS="${CFLAGS} ${COPTS}"
@


1.8
log
@a little bit of glue to call openssl; mark@@moxienet.com
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.bsd-wrapper,v 1.7 2000/03/25 18:16:42 maja Exp $
d48 1
a48 1
	sh ${.CURDIR}/configure --prefix=/usr --libdir=/etc ${CF}
@


1.7
log
@Upgrade to Lynx 2.8.2. -moj
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.bsd-wrapper,v 1.6 1999/12/21 04:07:23 fgsch Exp $
d4 1
d6 2
@


1.6
log
@strip lynx before installation.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.bsd-wrapper,v 1.5 1999/06/07 00:45:37 deraadt Exp $
d7 3
a9 2
HELPFILES=	keystrokes/bookmark_help.html keystrokes/cookie_help.html \
		keystrokes/dired_help.html keystrokes/edit_help.html \
d14 4
a17 4
		keystrokes/scrolling_help.html keystrokes/visited_help.html \
		keystrokes/xterm_help.html Lynx_users_guide.html \
		about_lynx.html lynx-dev.html lynx_help_main.html \
		lynx_url_support.html
@


1.5
log
@move CC, CCX, and COPTS forward; wd@@ics.nara-wu.ac.jp
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.bsd-wrapper,v 1.4 1998/12/05 19:43:46 kstailey Exp $
d69 2
a70 2
	${INSTALL} ${INSTALL_COPY} -o ${BINOWN} -g ${BINGRP} -m ${BINMODE} \
	    lynx ${DESTDIR}/usr/bin/lynx
@


1.4
log
@NOMAN fixes
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.bsd-wrapper,v 1.3 1998/10/18 20:02:35 millert Exp $
d5 1
a5 1
GNUCFLAGS=	CFLAGS="${CFLAGS}"
d42 1
d48 1
@


1.3
log
@set PATH before running configure since we can't rely on the user's path being sane
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.bsd-wrapper,v 1.2 1998/03/14 17:16:06 maja Exp $
d18 9
a26 1
all:	config.status lynx.cat1
a29 2

.include <bsd.own.mk>
@


1.2
log
@install helpfiles in locally. -moj
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.bsd-wrapper,v 1.1 1998/03/11 20:06:32 maja Exp $
d35 1
d40 1
@


1.1
log
@make it work in our world... -moj
@
text
@d1 1
a1 1
#	$OpenBSD$
d5 12
a16 2
LDFLAGS+=	-s ${LDSTATIC}
GNUCFLAGS=	CFLAGS="${CFLAGS}" LDFLAGS="${LDFLAGS}"
d50 9
a58 1
install: maninstall
@

