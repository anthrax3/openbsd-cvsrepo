head	1.3;
access;
symbols
	OPENBSD_3_2:1.2.0.12
	OPENBSD_3_2_BASE:1.2
	OPENBSD_3_1:1.2.0.10
	OPENBSD_3_1_BASE:1.2
	OPENBSD_3_0:1.2.0.8
	OPENBSD_3_0_BASE:1.2
	PERL_5_6_1:1.1.1.2
	OPENBSD_2_9:1.2.0.6
	OPENBSD_2_9_BASE:1.2
	OPENBSD_2_8:1.2.0.4
	OPENBSD_2_8_BASE:1.2
	OPENBSD_2_7:1.2.0.2
	OPENBSD_2_7_BASE:1.2
	PERL_5_6_0:1.1.1.2
	OPENBSD_2_6:1.1.0.8
	OPENBSD_2_6_BASE:1.1
	PERL_500503:1.1.1.1
	CPAN:1.1.1
	OPENBSD_2_5:1.1.0.6
	OPENBSD_2_5_BASE:1.1
	OPENBSD_2_4:1.1.0.4
	OPENBSD_2_4_BASE:1.1
	OPENBSD_2_3:1.1.0.2
	OPENBSD_2_3_BASE:1.1;
locks; strict;
comment	@# @;


1.3
date	2002.10.27.22.25.39;	author millert;	state dead;
branches;
next	1.2;

1.2
date	2000.04.06.17.08.50;	author millert;	state Exp;
branches;
next	1.1;

1.1
date	97.11.30.08.06.25;	author millert;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	99.04.29.22.42.08;	author millert;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	2000.04.06.16.11.01;	author millert;	state Exp;
branches;
next	;


desc
@perl 5.004_04
@


1.3
log
@Resolve conflicts, remove old files, merge local changes
@
text
@package vmsish;

=head1 NAME

vmsish - Perl pragma to control VMS-specific language features

=head1 SYNOPSIS

    use vmsish;

    use vmsish 'status';	# or '$?'
    use vmsish 'exit';
    use vmsish 'time';
    use vmsish 'hushed';

    use vmsish;
    no vmsish 'time';

=head1 DESCRIPTION

If no import list is supplied, all possible VMS-specific features are
assumed.  Currently, there are four VMS-specific features available:
'status' (a.k.a '$?'), 'exit', 'time' and 'hushed'.

=over 6

=item C<vmsish status>

This makes C<$?> and C<system> return the native VMS exit status
instead of emulating the POSIX exit status.

=item C<vmsish exit>

This makes C<exit 1> produce a successful exit (with status SS$_NORMAL),
instead of emulating UNIX exit(), which considers C<exit 1> to indicate
an error.  As with the CRTL's exit() function, C<exit 0> is also mapped
to an exit status of SS$_NORMAL, and any other argument to exit() is
used directly as Perl's exit status.

=item C<vmsish time>

This makes all times relative to the local time zone, instead of the
default of Universal Time (a.k.a Greenwich Mean Time, or GMT).

=item C<vmsish hushed>

This supresses printing of VMS status messages to SYS$OUTPUT and SYS$ERROR
if Perl terminates with an error status.  This primarily effects error
exits from things like compiler errors or "standard Perl" runtime errors,
where text error messages are also generated by Perl.

The error exits from inside VMS.C are generally more serious, and are
not supressed.

=back

See L<perlmod/Pragmatic Modules>.

=cut

if ($^O ne 'VMS') {
    require Carp;
    Carp::croak("This isn't VMS");
}

sub bits {
    my $bits = 0;
    my $sememe;
    foreach $sememe (@@_) {
        $bits |= 0x20000000, next if $sememe eq 'hushed';
        $bits |= 0x40000000, next if $sememe eq 'status' || $sememe eq '$?';
	$bits |= 0x80000000, next if $sememe eq 'time';
    }
    $bits;
}

sub import {
    shift;
    $^H |= bits(@@_ ? @@_ : qw(status time hushed));
    my $sememe;

    foreach $sememe (@@_ ? @@_ : qw(exit)) {
        $^H{'vmsish_exit'}   = 1 if $sememe eq 'exit';
    }
}

sub unimport {
    shift;
    $^H &= ~ bits(@@_ ? @@_ : qw(status time hushed));
    my $sememe;

    foreach $sememe (@@_ ? @@_ : qw(exit)) {
        $^H{'vmsish_exit'}   = 0 if $sememe eq 'exit';
    }
}

1;
@


1.2
log
@perl-5.6.0 + local changes
@
text
@@


1.1
log
@perl 5.004_04
@
text
@d14 1
d22 2
a23 2
assumed.  Currently, there are three VMS-specific features available:
'status' (a.k.a '$?'), 'exit', and 'time'.
d45 10
d70 3
a72 3
	$bits |= 0x01000000, next if $sememe eq 'status' || $sememe eq '$?';
	$bits |= 0x02000000, next if $sememe eq 'exit';
	$bits |= 0x04000000, next if $sememe eq 'time';
d79 6
a84 1
    $^H |= bits(@@_ ? @@_ : qw(status exit time));
d89 6
a94 1
    $^H &= ~ bits(@@_ ? @@_ : qw(status exit time));
@


1.1.1.1
log
@perl5.005_03
@
text
@@


1.1.1.2
log
@virgin perl 5.6.0
@
text
@a13 1
    use vmsish 'hushed';
d21 2
a22 2
assumed.  Currently, there are four VMS-specific features available:
'status' (a.k.a '$?'), 'exit', 'time' and 'hushed'.
a43 10
=item C<vmsish hushed>

This supresses printing of VMS status messages to SYS$OUTPUT and SYS$ERROR
if Perl terminates with an error status.  This primarily effects error
exits from things like compiler errors or "standard Perl" runtime errors,
where text error messages are also generated by Perl.

The error exits from inside VMS.C are generally more serious, and are
not supressed.

d59 3
a61 3
        $bits |= 0x20000000, next if $sememe eq 'hushed';
        $bits |= 0x40000000, next if $sememe eq 'status' || $sememe eq '$?';
	$bits |= 0x80000000, next if $sememe eq 'time';
d68 1
a68 6
    $^H |= bits(@@_ ? @@_ : qw(status time hushed));
    my $sememe;

    foreach $sememe (@@_ ? @@_ : qw(exit)) {
        $^H{'vmsish_exit'}   = 1 if $sememe eq 'exit';
    }
d73 1
a73 6
    $^H &= ~ bits(@@_ ? @@_ : qw(status time hushed));
    my $sememe;

    foreach $sememe (@@_ ? @@_ : qw(exit)) {
        $^H{'vmsish_exit'}   = 0 if $sememe eq 'exit';
    }
@


