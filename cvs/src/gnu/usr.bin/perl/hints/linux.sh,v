head	1.17;
access;
symbols
	OPENBSD_6_0:1.16.0.10
	OPENBSD_6_0_BASE:1.16
	OPENBSD_5_9:1.16.0.4
	OPENBSD_5_9_BASE:1.16
	OPENBSD_5_8:1.16.0.6
	OPENBSD_5_8_BASE:1.16
	PERL_5_20_2:1.1.1.15
	OPENBSD_5_7:1.16.0.2
	OPENBSD_5_7_BASE:1.16
	PERL_5_20_1:1.1.1.15
	OPENBSD_5_6:1.15.0.4
	OPENBSD_5_6_BASE:1.15
	PERL_5_18_2:1.1.1.14
	PERL:1.1.1
	OPENBSD_5_5:1.14.0.6
	OPENBSD_5_5_BASE:1.14
	OPENBSD_5_4:1.14.0.2
	OPENBSD_5_4_BASE:1.14
	PERL_5_16_3:1.1.1.13
	OPENBSD_5_3:1.13.0.10
	OPENBSD_5_3_BASE:1.13
	OPENBSD_5_2:1.13.0.8
	OPENBSD_5_2_BASE:1.13
	OPENBSD_5_1_BASE:1.13
	OPENBSD_5_1:1.13.0.6
	OPENBSD_5_0:1.13.0.4
	OPENBSD_5_0_BASE:1.13
	OPENBSD_4_9:1.13.0.2
	OPENBSD_4_9_BASE:1.13
	PERL_5_12_2:1.1.1.12
	OPENBSD_4_8:1.12.0.4
	OPENBSD_4_8_BASE:1.12
	OPENBSD_4_7:1.12.0.2
	OPENBSD_4_7_BASE:1.12
	PERL_5_10_1:1.1.1.11
	OPENBSD_4_6:1.11.0.6
	OPENBSD_4_6_BASE:1.11
	OPENBSD_4_5:1.11.0.2
	OPENBSD_4_5_BASE:1.11
	PERL_5_10_0:1.1.1.10
	OPENBSD_4_4:1.10.0.10
	OPENBSD_4_4_BASE:1.10
	OPENBSD_4_3:1.10.0.8
	OPENBSD_4_3_BASE:1.10
	OPENBSD_4_2:1.10.0.6
	OPENBSD_4_2_BASE:1.10
	OPENBSD_4_1:1.10.0.4
	OPENBSD_4_1_BASE:1.10
	OPENBSD_4_0:1.10.0.2
	OPENBSD_4_0_BASE:1.10
	PERL_5_8_8:1.1.1.9
	OPENBSD_3_9:1.9.0.8
	OPENBSD_3_9_BASE:1.9
	OPENBSD_3_8:1.9.0.6
	OPENBSD_3_8_BASE:1.9
	OPENBSD_3_7:1.9.0.4
	OPENBSD_3_7_BASE:1.9
	PERL_5_8_6:1.1.1.8
	OPENBSD_3_6:1.9.0.2
	OPENBSD_3_6_BASE:1.9
	PERL_5_8_5:1.1.1.8
	PERL_5_8_3:1.1.1.7
	OPENBSD_3_5:1.7.0.2
	OPENBSD_3_5_BASE:1.7
	PERL_5_8_2:1.1.1.6
	OPENBSD_3_4:1.6.0.4
	OPENBSD_3_4_BASE:1.6
	OPENBSD_3_3:1.6.0.2
	OPENBSD_3_3_BASE:1.6
	PERL_5_8_0:1.1.1.5
	OPENBSD_3_2:1.5.0.6
	OPENBSD_3_2_BASE:1.5
	OPENBSD_3_1:1.5.0.4
	OPENBSD_3_1_BASE:1.5
	OPENBSD_3_0:1.5.0.2
	OPENBSD_3_0_BASE:1.5
	PERL_5_6_1:1.1.1.4
	OPENBSD_2_9:1.4.0.6
	OPENBSD_2_9_BASE:1.4
	OPENBSD_2_8:1.4.0.4
	OPENBSD_2_8_BASE:1.4
	OPENBSD_2_7:1.4.0.2
	OPENBSD_2_7_BASE:1.4
	PERL_5_6_0:1.1.1.3
	OPENBSD_2_6:1.3.0.2
	OPENBSD_2_6_BASE:1.3
	PERL_500503:1.1.1.2
	CPAN:1.1.1
	OPENBSD_2_5:1.2.0.6
	OPENBSD_2_5_BASE:1.2
	OPENBSD_2_4:1.2.0.4
	OPENBSD_2_4_BASE:1.2
	OPENBSD_2_3:1.2.0.2
	OPENBSD_2_3_BASE:1.2
	OPENBSD_2_2:1.1.1.1.0.6
	OPENBSD_2_2_BASE:1.1.1.1
	OPENBSD_2_1:1.1.1.1.0.4
	OPENBSD_2_1_BASE:1.1.1.1
	OPENBSD_2_0:1.1.1.1.0.2
	OPENBSD_2_0_BASE:1.1.1.1
	perl5003:1.1.1.1
	lwall:1.1.1;
locks; strict;
comment	@# @;
expand	@o@;


1.17
date	2017.02.05.00.32.14;	author afresh1;	state Exp;
branches;
next	1.16;
commitid	cxJ08BvJA9Pt2PTM;

1.16
date	2014.11.17.20.57.06;	author afresh1;	state Exp;
branches;
next	1.15;
commitid	QP75iYx42Uo7mMxO;

1.15
date	2014.03.24.15.05.27;	author afresh1;	state Exp;
branches;
next	1.14;

1.14
date	2013.03.25.20.40.55;	author sthen;	state Exp;
branches;
next	1.13;

1.13
date	2010.09.24.15.06.58;	author millert;	state Exp;
branches;
next	1.12;

1.12
date	2009.10.12.18.24.37;	author millert;	state Exp;
branches;
next	1.11;

1.11
date	2008.09.29.17.36.07;	author millert;	state Exp;
branches;
next	1.10;

1.10
date	2006.03.28.19.23.04;	author millert;	state Exp;
branches;
next	1.9;

1.9
date	2004.08.09.18.09.26;	author millert;	state Exp;
branches;
next	1.8;

1.8
date	2004.04.07.21.33.04;	author millert;	state Exp;
branches;
next	1.7;

1.7
date	2003.12.03.03.02.34;	author millert;	state Exp;
branches;
next	1.6;

1.6
date	2002.10.27.22.25.25;	author millert;	state Exp;
branches;
next	1.5;

1.5
date	2001.05.24.18.35.19;	author millert;	state Exp;
branches;
next	1.4;

1.4
date	2000.04.06.17.05.47;	author millert;	state Exp;
branches;
next	1.3;

1.3
date	99.04.29.22.51.39;	author millert;	state Exp;
branches;
next	1.2;

1.2
date	97.11.30.07.56.17;	author millert;	state Exp;
branches;
next	1.1;

1.1
date	96.08.19.10.12.24;	author downsj;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	96.08.19.10.12.24;	author downsj;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	99.04.29.22.39.32;	author millert;	state Exp;
branches;
next	1.1.1.3;

1.1.1.3
date	2000.04.06.16.09.28;	author millert;	state Exp;
branches;
next	1.1.1.4;

1.1.1.4
date	2001.05.24.18.23.11;	author millert;	state Exp;
branches;
next	1.1.1.5;

1.1.1.5
date	2002.10.27.22.14.56;	author millert;	state Exp;
branches;
next	1.1.1.6;

1.1.1.6
date	2003.12.03.02.43.56;	author millert;	state Exp;
branches;
next	1.1.1.7;

1.1.1.7
date	2004.04.07.21.13.10;	author millert;	state Exp;
branches;
next	1.1.1.8;

1.1.1.8
date	2004.08.09.17.47.57;	author millert;	state Exp;
branches;
next	1.1.1.9;

1.1.1.9
date	2006.03.28.18.48.28;	author millert;	state Exp;
branches;
next	1.1.1.10;

1.1.1.10
date	2008.09.29.17.18.27;	author millert;	state Exp;
branches;
next	1.1.1.11;

1.1.1.11
date	2009.10.12.18.10.46;	author millert;	state Exp;
branches;
next	1.1.1.12;

1.1.1.12
date	2010.09.24.14.48.55;	author millert;	state Exp;
branches;
next	1.1.1.13;

1.1.1.13
date	2013.03.25.20.08.48;	author sthen;	state Exp;
branches;
next	1.1.1.14;

1.1.1.14
date	2014.03.24.14.59.02;	author afresh1;	state Exp;
branches;
next	1.1.1.15;

1.1.1.15
date	2014.11.17.20.53.07;	author afresh1;	state Exp;
branches;
next	;
commitid	B31cAbBIXiCqnL97;


desc
@@


1.17
log
@Fix merge issues, remove excess files - match perl-5.24.1 dist
@
text
@# hints/linux.sh
# Original version by rsanders
# Additional support by Kenneth Albanowski <kjahds@@kjahds.com>
#
# ELF support by H.J. Lu <hjl@@nynexst.com>
# Additional info from Nigel Head <nhead@@ESOC.bitnet>
# and Kenneth Albanowski <kjahds@@kjahds.com>
#
# Consolidated by Andy Dougherty <doughera@@lafayette.edu>
#
# Updated Thu Feb  8 11:56:10 EST 1996

# Updated Thu May 30 10:50:22 EDT 1996 by <doughera@@lafayette.edu>

# Updated Fri Jun 21 11:07:54 EDT 1996
# NDBM support for ELF re-enabled by <kjahds@@kjahds.com>

# No version of Linux supports setuid scripts.
d_suidsafe='undef'

# No version of Linux needs libutil for perl.
i_libutil='undef'

# Debian and Red Hat, and perhaps other vendors, provide both runtime and
# development packages for some libraries.  The runtime packages contain shared
# libraries with version information in their names (e.g., libgdbm.so.1.7.3);
# the development packages supplement this with versionless shared libraries
# (e.g., libgdbm.so).
#
# If you want to link against such a library, you must install the development
# version of the package.
#
# These packages use a -dev naming convention in both Debian and Red Hat:
#   libgdbmg1  (non-development version of GNU libc 2-linked GDBM library)
#   libgdbmg1-dev (development version of GNU libc 2-linked GDBM library)
# So make sure that for any libraries you wish to link Perl with under
# Debian or Red Hat you have the -dev packages installed.

# SuSE Linux can be used as cross-compilation host for Cray XT4 Catamount/Qk.
if test -d /opt/xt-pe
then
  case "`${cc:-cc} -V 2>&1`" in
  *catamount*) . hints/catamount.sh; return ;;
  esac
fi

# Some operating systems (e.g., Solaris 2.6) will link to a versioned shared
# library implicitly.  For example, on Solaris, `ld foo.o -lgdbm' will find an
# appropriate version of libgdbm, if one is available; Linux, however, doesn't
# do the implicit mapping.
ignore_versioned_solibs='y'

# BSD compatibility library no longer needed
# 'kaffe' has a /usr/lib/libnet.so which is not at all relevant for perl.
# bind causes issues with several reentrant functions
set `echo X "$libswanted "| sed -e 's/ bsd / /' -e 's/ net / /' -e 's/ bind / /'`
shift
libswanted="$*"

# Debian 4.0 puts ndbm in the -lgdbm_compat library.
echo $libs
if echo " $libswanted " | grep -q ' gdbm '; then
    # Only add if gdbm is in libswanted.
    libswanted="$libswanted gdbm_compat"
fi

# Configure may fail to find lstat() since it's a static/inline
# function in <sys/stat.h>.
d_lstat=define

# malloc wrap works
case "$usemallocwrap" in
'') usemallocwrap='define' ;;
esac

# The system malloc() is about as fast and as frugal as perl's.
# Since the system malloc() has been the default since at least
# 5.001, we might as well leave it that way.  --AD  10 Jan 2002
case "$usemymalloc" in
'') usemymalloc='n' ;;
esac

uname_minus_m="`$run uname -m 2>/dev/null`"
uname_minus_m="${uname_minus_m:-"$targetarch"}"

# Check if we're about to use Intel's ICC compiler
case "`${cc:-cc} -V 2>&1`" in
*"Intel(R) C++ Compiler"*|*"Intel(R) C Compiler"*)
    # record the version, formats:
    # icc (ICC) 10.1 20080801
    # icpc (ICC) 10.1 20080801
    # followed by a copyright on the second line
    ccversion=`${cc:-cc} --version | sed -n -e 's/^icp\?c \((ICC) \)\?//p'`
    # This is needed for Configure's prototype checks to work correctly
    # The -mp flag is needed to pass various floating point related tests
    # The -no-gcc flag is needed otherwise, icc pretends (poorly) to be gcc
    ccflags="-we147 -mp -no-gcc $ccflags"
    # Prevent relocation errors on 64bits arch
    case "$uname_minus_m" in
	*ia64*|*x86_64*)
	    cccdlflags='-fPIC'
	;;
    esac
    # If we're using ICC, we usually want the best performance
    case "$optimize" in
    '') optimize='-O3' ;;
    esac
    ;;
*" Sun "*"C"*)
    # Sun's C compiler, which might have a 'tag' name between
    # 'Sun' and the 'C':  Examples:
    # cc: Sun C 5.9 Linux_i386 Patch 124871-01 2007/07/31
    # cc: Sun Ceres C 5.10 Linux_i386 2008/07/10
    test "$optimize" || optimize='-xO2'
    cccdlflags='-KPIC'
    lddlflags='-G -Bdynamic'
    # Sun C doesn't support gcc attributes, but, in many cases, doesn't
    # complain either.  Not all cases, though.
    d_attribute_format='undef'
    d_attribute_malloc='undef'
    d_attribute_nonnull='undef'
    d_attribute_noreturn='undef'
    d_attribute_pure='undef'
    d_attribute_unused='undef'
    d_attribute_warn_unused_result='undef'
    ;;
esac

case "$optimize" in
# use -O2 by default ; -O3 doesn't seem to bring significant benefits with gcc
'')
    optimize='-O2'
    case "$uname_minus_m" in
        ppc*)
            # on ppc, it seems that gcc (at least gcc 3.3.2) isn't happy
            # with -O2 ; so downgrade to -O1.
            optimize='-O1'
        ;;
        ia64*)
            # This architecture has had various problems with gcc's
            # in the 3.2, 3.3, and 3.4 releases when optimized to -O2.  See
            # RT #37156 for a discussion of the problem.
            case "`${cc:-gcc} -v 2>&1`" in
            *"version 3.2"*|*"version 3.3"*|*"version 3.4"*)
                ccflags="-fno-delete-null-pointer-checks $ccflags"
            ;;
            esac
        ;;
    esac
    ;;
esac

# Ubuntu 11.04 (and later, presumably) doesn't keep most libraries
# (such as -lm) in /lib or /usr/lib.  So we have to ask gcc to tell us
# where to look.  We don't want gcc's own libraries, however, so we
# filter those out.
# This could be conditional on Unbuntu, but other distributions may
# follow suit, and this scheme seems to work even on rather old gcc's.
# This unconditionally uses gcc because even if the user is using another
# compiler, we still need to find the math library and friends, and I don't
# know how other compilers will cope with that situation.
# Morever, if the user has their own gcc earlier in $PATH than the system gcc,
# we don't want its libraries. So we try to prefer the system gcc
# Still, as an escape hatch, allow Configure command line overrides to
# plibpth to bypass this check.
if [ -x /usr/bin/gcc ] ; then
    gcc=/usr/bin/gcc
else
    gcc=gcc
fi

case "$plibpth" in
'') plibpth=`LANG=C LC_ALL=C $gcc $ccflags $ldflags -print-search-dirs | grep libraries |
	cut -f2- -d= | tr ':' $trnl | grep -v 'gcc' | sed -e 's:/$::'`
    set X $plibpth # Collapse all entries on one line
    shift
    plibpth="$*"
    ;;
esac

# libquadmath is sometimes installed as gcc internal library,
# so contrary to our usual policy of *not* looking at gcc internal
# directories we now *do* look at them, in case they contain
# the quadmath library.
# XXX This may apply to other gcc internal libraries, if such exist.
# XXX This could be at Configure level, but then the $gcc is messy.
case "$usequadmath" in
"$define")
  for d in `LANG=C LC_ALL=C $gcc $ccflags $ldflags -print-search-dirs | grep libraries | cut -f2- -d= | tr ':' $trnl | grep 'gcc' | sed -e 's:/$::'`
  do
    case `ls $d/*libquadmath*$so* 2>/dev/null` in
    $d/*libquadmath*$so*) xlibpth="$xlibpth $d" ;;
    esac
  done
  ;;
esac

case "$libc" in
'')
# If you have glibc, then report the version for ./myconfig bug reporting.
# (Configure doesn't need to know the specific version since it just uses
# gcc to load the library for all tests.)
# We don't use __GLIBC__ and  __GLIBC_MINOR__ because they
# are insufficiently precise to distinguish things like
# libc-2.0.6 and libc-2.0.7.
    for p in $plibpth
    do
        for trylib in libc.so.6 libc.so
        do
            if $test -e $p/$trylib; then
                libc=`ls -l $p/$trylib | awk '{print $NF}'`
                if $test "X$libc" != X; then
                    break
                fi
            fi
        done
        if $test "X$libc" != X; then
            break
        fi
    done
    ;;
esac

# Are we using ELF?  Thanks to Kenneth Albanowski <kjahds@@kjahds.com>
# for this test.
cat >try.c <<'EOM'
/* Test for whether ELF binaries are produced */
#include <fcntl.h>
#include <stdlib.h>
#include <unistd.h>
main() {
	char buffer[4];
	int i=open("a.out",O_RDONLY);
	if(i==-1)
		exit(1); /* fail */
	if(read(i,&buffer[0],4)<4)
		exit(1); /* fail */
	if(buffer[0] != 127 || buffer[1] != 'E' ||
           buffer[2] != 'L' || buffer[3] != 'F')
		exit(1); /* fail */
	exit(0); /* succeed (yes, it's ELF) */
}
EOM
if ${cc:-gcc} $ccflags $ldflags try.c >/dev/null 2>&1 && $run ./a.out; then
    cat <<'EOM' >&4

You appear to have ELF support.  I'll try to use it for dynamic loading.
If dynamic loading doesn't work, read hints/linux.sh for further information.
EOM

else
    cat <<'EOM' >&4

You don't have an ELF gcc.  I will use dld if possible.  If you are
using a version of DLD earlier than 3.2.6, or don't have it at all, you
should probably upgrade. If you are forced to use 3.2.4, you should
uncomment a couple of lines in hints/linux.sh and restart Configure so
that shared libraries will be disallowed.

EOM
    lddlflags="-r $lddlflags"
    # These empty values are so that Configure doesn't put in the
    # Linux ELF values.
    ccdlflags=' '
    cccdlflags=' '
    ccflags="-DOVR_DBL_DIG=14 $ccflags"
    so='sa'
    dlext='o'
    nm_so_opt=' '
    ## If you are using DLD 3.2.4 which does not support shared libs,
    ## uncomment the next two lines:
    #ldflags="-static"
    #so='none'

	# In addition, on some systems there is a problem with perl and NDBM
	# which causes AnyDBM and NDBM_File to lock up. This is evidenced
	# in the tests as AnyDBM just freezing.  Apparently, this only
	# happens on a.out systems, so we disable NDBM for all a.out linux
	# systems.  If someone can suggest a more robust test
	#  that would be appreciated.
	#
	# More info:
	# Date: Wed, 7 Feb 1996 03:21:04 +0900
	# From: Jeffrey Friedl <jfriedl@@nff.ncl.omron.co.jp>
	#
	# I tried compiling with DBM support and sure enough things locked up
	# just as advertised. Checking into it, I found that the lockup was
	# during the call to dbm_open. Not *in* dbm_open -- but between the call
	# to and the jump into.
	#
	# To make a long story short, making sure that the *.a and *.sa pairs of
	#   /usr/lib/lib{m,db,gdbm}.{a,sa}
	# were perfectly in sync took care of it.
	#
	# This will generate a harmless Whoa There! message
	case "$d_dbm_open" in
	'')	cat <<'EOM' >&4

Disabling ndbm.  This will generate a Whoa There message in Configure.
Read hints/linux.sh for further information.
EOM
		# You can override this with Configure -Dd_dbm_open
		d_dbm_open=undef
		;;
	esac
fi

rm -f try.c a.out

if ${sh:-/bin/sh} -c exit; then
  echo ''
  echo 'You appear to have a working bash.  Good.'
else
  cat << 'EOM' >&4

*********************** Warning! *********************
It would appear you have a defective bash shell installed. This is likely to
give you a failure of op/exec test #5 during the test phase of the build,
Upgrading to a recent version (1.14.4 or later) should fix the problem.
******************************************************
EOM

fi

# On SPARClinux,
# The following csh consistently coredumped in the test directory
# "/home/mikedlr/perl5.003_94/t", though not most other directories.

#Name        : csh                    Distribution: Red Hat Linux (Rembrandt)
#Version     : 5.2.6                        Vendor: Red Hat Software
#Release     : 3                        Build Date: Fri May 24 19:42:14 1996
#Install date: Thu Jul 11 16:20:14 1996 Build Host: itchy.redhat.com
#Group       : Shells                   Source RPM: csh-5.2.6-3.src.rpm
#Size        : 184417
#Description : BSD c-shell

# For this reason I suggest using the much bug-fixed tcsh for globbing
# where available.

# November 2001:  That warning's pretty old now and probably not so
# relevant, especially since perl now uses File::Glob for globbing.
# We'll still look for tcsh, but tone down the warnings.
# Andy Dougherty, Nov. 6, 2001
if $csh -c 'echo $version' >/dev/null 2>&1; then
    echo 'Your csh is really tcsh.  Good.'
else
    if xxx=`./UU/loc tcsh blurfl $pth`; $test -f "$xxx"; then
	echo "Found tcsh.  I'll use it for globbing."
	# We can't change Configure's setting of $csh, due to the way
	# Configure handles $d_portable and commands found in $loclist.
	# We can set the value for CSH in config.h by setting full_csh.
	full_csh=$xxx
    elif [ -f "$csh" ]; then
	echo "Couldn't find tcsh.  Csh-based globbing might be broken."
    fi
fi

# Shimpei Yamashita <shimpei@@socrates.patnet.caltech.edu>
# Message-Id: <33EF1634.B36B6500@@pobox.com>
#
# The DR2 of MkLinux (osname=linux,archname=ppc-linux) may need
# special flags passed in order for dynamic loading to work.
# instead of the recommended:
#
# ccdlflags='-rdynamic'
#
# it should be:
# ccdlflags='-Wl,-E'
#
# So if your DR2 (DR3 came out summer 1998, consider upgrading)
# has problems with dynamic loading, uncomment the
# following three lines, make distclean, and re-Configure:
#case "`uname -r | sed 's/^[0-9.-]*//'``arch`" in
#'osfmach3ppc') ccdlflags='-Wl,-E' ;;
#esac

case "$uname_minus_m" in
sparc*)
	case "$cccdlflags" in
	*-fpic*) cccdlflags="`echo $cccdlflags|sed 's/-fpic/-fPIC/'`" ;;
	*-fPIC*) ;;
	*)	 cccdlflags="$cccdlflags -fPIC" ;;
	esac
	;;
esac

# SuSE8.2 has /usr/lib/libndbm* which are ld scripts rather than
# true libraries. The scripts cause binding against static
# version of -lgdbm which is a bad idea. So if we have 'nm'
# make sure it can read the file
# NI-S 2003/08/07
case "$nm" in
    '') ;;
    *)
    for p in $plibpth
    do
        if $test -r $p/libndbm.so; then
            if $nm $p/libndbm.so >/dev/null 2>&1 ; then
                echo 'Your shared -lndbm seems to be a real library.'
                _libndbm_real=1
                break
            fi
        fi
    done
    if $test "X$_libndbm_real" = X; then
        echo 'Your shared -lndbm is not a real library.'
        set `echo X "$libswanted "| sed -e 's/ ndbm / /'`
        shift
        libswanted="$*"
    fi
    ;;
esac

# Linux on Synology.
if [ -f /etc/synoinfo.conf -a -d /usr/syno ]; then
    # Tested on Synology DS213 and DS413
    #  OS version info in /etc.defaults/VERSION
    #  http://forum.synology.com/wiki/index.php/What_kind_of_CPU_does_my_NAS_have
    # Synology DS213 running DSM 4.3-3810-0 (2013-11-06)
    #  CPU model Marvell Kirkwood mv6282 ARMv5te
    #  Linux 2.6.32.12 #3810 Wed Nov 6 05:13:41 CST 2013 armv5tel GNU/Linux
    # Synology DS413 running DSM 4.3-3810-0 (2013-11-06)
    #  CPU model Freescale QorIQ P1022 ppc (e500v2)
    #  linux 2.6.32.12 #3810 ppc GNU/Linux
    # All development stuff installed with ipkg is in /opt
    if [ "$LANG" = "" -o "$LANG" = "C" ]; then
	echo 'Your LANG is safe'
    else
	echo 'Please set $LANG to "C". All other $LANG settings will cause havoc' >&4
	LANG=C
    fi
    echo 'Setting up to use /opt/*' >&4
    locincpth="/opt/include $locincpth"
    libpth="/opt/lib $libpth"
    libspth="/opt/lib $libspth"
    loclibpth="/opt/lib $loclibpth"
    # POSIX will not link without the pthread lib
    libswanted="$libswanted pthread"
    echo "$libswanted" >&4
fi

# This script UU/usethreads.cbu will get 'called-back' by Configure
# after it has prompted the user for whether to use threads.
cat > UU/usethreads.cbu <<'EOCBU'
case "$usethreads" in
$define|true|[yY]*)
        ccflags="-D_REENTRANT -D_GNU_SOURCE $ccflags"
        if echo $libswanted | grep -v pthread >/dev/null
        then
            set `echo X "$libswanted "| sed -e 's/ c / pthread c /'`
            shift
            libswanted="$*"
        fi

	# Somehow at least in Debian 2.2 these manage to escape
	# the #define forest of <features.h> and <time.h> so that
	# the hasproto macro of Configure doesn't see these protos,
	# even with the -D_GNU_SOURCE.

	d_asctime_r_proto="$define"
	d_crypt_r_proto="$define"
	d_ctime_r_proto="$define"
	d_gmtime_r_proto="$define"
	d_localtime_r_proto="$define"
	d_random_r_proto="$define"

	;;
esac
EOCBU

cat > UU/uselargefiles.cbu <<'EOCBU'
# This script UU/uselargefiles.cbu will get 'called-back' by Configure
# after it has prompted the user for whether to use large files.
case "$uselargefiles" in
''|$define|true|[yY]*)
# Keep this in the left margin.
ccflags_uselargefiles="-D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64"

	ccflags="$ccflags $ccflags_uselargefiles"
	;;
esac
EOCBU

# Purify fails to link Perl if a "-lc" is passed into its linker
# due to duplicate symbols.
case "$PURIFY" in
$define|true|[yY]*)
    set `echo X "$libswanted "| sed -e 's/ c / /'`
    shift
    libswanted="$*"
    ;;
esac

# If using g++, the Configure scan for dlopen() and (especially)
# dlerror() might fail, easier just to forcibly hint them in.
case "$cc" in
*g++*)
  d_dlopen='define'
  d_dlerror='define'
  ;;
esac

# Under some circumstances libdb can get built in such a way as to
# need pthread explicitly linked.

libdb_needs_pthread="N"

if echo " $libswanted " | grep -v " pthread " >/dev/null
then
   if echo " $libswanted " | grep " db " >/dev/null
   then
     for DBDIR in $glibpth
     do
       DBLIB="$DBDIR/libdb.so"
       if [ -f $DBLIB ]
       then
         if ${nm:-nm} -u $DBLIB 2>/dev/null | grep pthread >/dev/null
         then
           if ldd $DBLIB | grep pthread >/dev/null
           then
             libdb_needs_pthread="N"
           else
             libdb_needs_pthread="Y"
           fi
         fi
       fi
     done
   fi
fi

case "$libdb_needs_pthread" in
  "Y")
    libswanted="$libswanted pthread"
    ;;
esac
@


1.16
log
@Fix merge conflicts, remove extra files, match upstream perl-5.20.1

ok deraadt@@ sthen@@ espie@@ miod@@
@
text
@d181 17
d517 1
a517 1
         if ${nm:-nm} -u $DBLIB | grep pthread >/dev/null
@


1.15
log
@Merge perl-5.18.2 plus local patches, remove old files

OK espie@@ sthen@@ deraadt@@
@
text
@d42 1
a42 1
  case "`cc -V 2>&1`" in
d61 4
a64 11
libswanted="$libswanted gdbm_compat"

# If you have glibc, then report the version for ./myconfig bug reporting.
# (Configure doesn't need to know the specific version since it just uses
# gcc to load the library for all tests.)
# We don't use __GLIBC__ and  __GLIBC_MINOR__ because they
# are insufficiently precise to distinguish things like
# libc-2.0.6 and libc-2.0.7.
if test -L /lib/libc.so.6; then
    libc=`ls -l /lib/libc.so.6 | awk '{print $NF}'`
    libc=/lib/$libc
d83 3
d99 1
a99 1
    case "`uname -m`" in
d133 1
a133 1
    case "`uname -m`" in
d173 1
a173 1
'') plibpth=`LANG=C LC_ALL=C $gcc -print-search-dirs | grep libraries |
d181 26
d227 1
a227 1
if ${cc:-gcc} try.c >/dev/null 2>&1 && $run ./a.out; then
d293 1
a293 1
if /bin/sh -c exit; then
d360 1
a360 1
case "`uname -m`" in
d375 48
a422 9
if [ -r /usr/lib/libndbm.so  -a  -x /usr/bin/nm ] ; then
   if /usr/bin/nm /usr/lib/libndbm.so >/dev/null 2>&1 ; then
    echo 'Your shared -lndbm seems to be a real library.'
   else
    echo 'Your shared -lndbm is not a real library.'
    set `echo X "$libswanted "| sed -e 's/ ndbm / /'`
    shift
    libswanted="$*"
   fi
a424 1

d500 1
a500 1
         if nm -u $DBLIB | grep pthread >/dev/null
@


1.14
log
@merge/resolve conflicts
(some more to do after this one)
@
text
@a416 10
# If we are using g++ we must use nm and force ourselves to use
# the /usr/lib/libc.a (resetting the libc below to an empty string
# makes Configure to look for the right one) because the symbol
# scanning tricks of Configure will crash and burn horribly.
case "$cc" in
*g++*) usenm=true
       libc=''
       ;;
esac

@


1.13
log
@merge in perl 5.12.2 plus local changes
@
text
@d16 1
a16 1
# NDBM support for ELF renabled by <kjahds@@kjahds.com>
d21 3
d157 28
a367 6
if getconf GNU_LIBPTHREAD_VERSION | grep NPTL >/dev/null 2>/dev/null
then
    threadshavepids=""
else
    threadshavepids="-DTHREADS_HAVE_PIDS"
fi
d370 1
a370 1
        ccflags="-D_REENTRANT -D_GNU_SOURCE $threadshavepids $ccflags"
@


1.12
log
@Merge in perl 5.10.1
@
text
@d90 5
@


1.11
log
@fix conflicts and merge in local changes to perl 5.10.0
@
text
@d57 3
d94 6
d105 6
a110 2
*"Sun C"*)
    optimize='-xO2'
@


1.10
log
@merge in perl 5.8.8
@
text
@d35 9
a43 1
#
d88 3
a90 1
    ccflags="-we147 $ccflags"
d100 9
d119 1
a119 1
	    # with -O2 ; so downgrade to -O1.
d122 10
d142 1
d293 1
d319 6
d327 7
a333 4
        ccflags="-D_REENTRANT -D_GNU_SOURCE -DTHREADS_HAVE_PIDS $ccflags"
        set `echo X "$libswanted "| sed -e 's/ c / pthread c /'`
        shift
        libswanted="$*"
d371 53
@


1.9
log
@merge 5.8.5 into HEAD
remove now-unused files
crank libperl shared library major number
update Makefile.bsd-wrapper
tweak openbsd hints file for arm and m68k
@
text
@d42 4
a45 3
# BSD compatability library no longer needed
# 'kaffe' has a /usr/lib/libnet.so which is not at all relevent for perl.
set `echo X "$libswanted "| sed -e 's/ bsd / /' -e 's/ net / /'`
d78 1
a78 1
*"Intel(R) C++ Compiler"*)
d86 5
d323 10
@


1.8
log
@merge local changes into perl-5.8.3
@
text
@d63 5
d88 8
a95 7
'') # If we have modern enough gcc and well-supported enough CPU,
    # crank up the optimization level.
    case "`${cc:-gcc} -v 2>&1`" in
    *"gcc version 2.95"*|*"gcc version 3."*)
        case "`arch 2>&1`" in
        i?86|ppc) optimize='-O3' ;;
        esac
a96 3
    esac
    case "$optimize" in
    '') optimize='-O2' ;;
@


1.7
log
@Resolve conflicts for perl 5.8.2, remove old files, and add OpenBSD-specific scaffolding
@
text
@d250 2
a251 2
case "`uname -r`" in
sparc-linux)
@


1.6
log
@Resolve conflicts, remove old files, merge local changes
@
text
@d51 1
a51 1
# We don't use __GLIBC__ and  __GLIBC_MINOR__ because they 
d63 1
a63 1
# The system malloc() is about as fast and as frugal as perl's. 
d70 12
d149 2
a150 2
	# which causes AnyDBM and NDBM_File to lock up. This is evidenced 
	# in the tests as AnyDBM just freezing.  Apparently, this only 
d163 1
a163 1
	# 
d233 1
a233 1
# 
d239 1
a239 1
# 
d259 18
a276 1
# This script UU/usethreads.cbu will get 'called-back' by Configure 
d281 1
a281 1
        ccflags="-D_REENTRANT -D_GNU_SOURCE $ccflags"
d303 1
a303 1
# This script UU/uselargefiles.cbu will get 'called-back' by Configure 
@


1.5
log
@merge in perl 5.6.1 with our local changes
@
text
@d9 1
a9 1
# Consolidated by Andy Dougherty <doughera@@lafcol.lafayette.edu>
d13 1
a13 1
# Updated Thu May 30 10:50:22 EDT 1996 by <doughera@@lafcol.lafayette.edu>
a41 29
# perl goes into the /usr tree.  See the Filesystem Standard
# available via anonymous FTP at tsx-11.mit.edu in
# /pub/linux/docs/linux-standards/fsstnd.
# Allow a command line override, e.g. Configure -Dprefix=/foo/bar
#
#  Addendum for 5.005_57 and beyond:
#
# However, most Linux users probably already have a /usr/bin/perl.
# We can't know whether the current user is intending to *replace*
# that /usr/bin/perl or whether the user is intending to install
# a *different* installation.
#
# Here is what we used to do:
# Allow a command line override, e.g. Configure -Dprefix=/foo/bar
# case "$prefix" in
# '') prefix='/usr' ;;
# esac
#
# For now, let's assume that most Linux users get their /usr/bin/perl
# from some packaging system, so that those compiling from source are
# probably the more experimental folks and hence probably aren't
# intending to replace /usr/bin/perl (at least just yet).
# This change makes linux consistent with most other unix platforms
# in having a default of prefix=/usr/local.
# These notes can probably safely be removed in 5.005_50 and beyond.
#
#	9 April 1999  Andy Dougherty  <doughera@@lafayette.edu>
#

a50 2
# Is this sufficiently robust for libc5 systems as well as
# glibc-2.1.x systems?
d63 3
a65 1
# Explanation?
d71 13
a83 1
'') optimize='-O2' ;;
d105 1
a105 1
if ${cc:-gcc} try.c >/dev/null 2>&1 && ./a.out; then
a111 4
#For RedHat Linux 3.0.3, you may need to fetch
# ftp://ftp.redhat.com/pub/redhat-3.0.3/i386/updates/RPMS/ld.so-1.7.14-3.i386.rpm
#

d201 7
a207 4
if [  ! "`csh -c 'echo $version' 2>/dev/null`"  ] 
then
    echo 'Real csh found (might break); looking for tcsh ...'
    # Use ./UU/loc to find tcsh.  (We no longer run in the hints/ directory)
d214 2
a215 2
    else
	echo "Couldn't find tcsh.  BEWARE:  GLOBBING MIGHT BE BROKEN."
a216 2
else
    echo 'Your csh is really tcsh.  Good.'
d252 1
a252 1
        ccflags="-D_REENTRANT $ccflags"
d256 13
@


1.4
log
@perl-5.6.0 + local changes
@
text
@d192 1
a192 1
if /bin/bash -c exit; then
d285 4
a288 1
	ccflags="$ccflags -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64"
@


1.3
log
@perl5.005_03 (stock)
@
text
@d46 24
a69 6
case "$prefix" in
'') prefix='/usr' ;;
esac

# gcc-2.6.3 defines _G_HAVE_BOOL to 1, but doesn't actually supply bool.
ccflags="-Dbool=char -DHAS_BOOL $ccflags"
d77 13
d258 9
d276 10
@


1.2
log
@perl 5.004_04
@
text
@d21 21
a52 8
# libc6, aka glibc2, seems to need STRUCT_TM_HASZONE defined.
# Thanks to Bart Schuller <schuller@@Lunatech.com>
# See Message-ID: <19971009002636.50729@@tanglefoot>
# This is currently commented out for maintenance releases
# but should probably be uncommented for 5.005 or after
# more widespread testing.
#POSIX_cflags='ccflags="$ccflags -DSTRUCT_TM_HASZONE"'

d54 2
a55 1
set `echo X "$libswanted "| sed -e 's/ bsd / /'`
d194 2
a195 2
    # Use ../UU/loc to find tcsh.  (We run in the hints/ directory.)
    if xxx=`../UU/loc tcsh blurfl $pth`; $test -f "$xxx"; then
d211 2
a212 2
# MkLinux (osname=linux,archname=ppc-linux), which differs slightly from other
# linuces, needs special flags passed in order for dynamic loading to work.
d214 1
d219 20
a238 1

@


1.1
log
@Initial revision
@
text
@d18 3
d32 8
d148 2
a149 2
  echo
  echo You appear to have a working bash. Good.
d162 39
a200 9
# Avoid some troublesome gcvt() functions.  With some libc versions, 
# perl -e '$x=1e5; print "$x\n";' prints 1e+5.  We'd like it
# to print 100000 instead, consistent with the integer value given
# on other platforms.  This isn't a bug in gcvt, really; more in our
# expectations for it.  We'd like it to behave exactly as
# sprintf %.16g, but it isn't documented to do that.
#
# We'll use sprintf() instead, since we can control the output more
# precisely.
d202 2
a203 2
# The next version of Configure will check for this automatically.
d_Gconvert='sprintf((b),"%.*g",(n),(x))'
@


1.1.1.1
log
@Import of Perl 5.003 into the tree.  Makefile.bsd-wrapper and
config.sh.OpenBSD are the only local changes.
@
text
@@


1.1.1.2
log
@perl5.005_03
@
text
@a17 24
# No version of Linux supports setuid scripts.
d_suidsafe='undef'

# Debian and Red Hat, and perhaps other vendors, provide both runtime and
# development packages for some libraries.  The runtime packages contain shared
# libraries with version information in their names (e.g., libgdbm.so.1.7.3);
# the development packages supplement this with versionless shared libraries
# (e.g., libgdbm.so).
#
# If you want to link against such a library, you must install the development
# version of the package.
#
# These packages use a -dev naming convention in both Debian and Red Hat:
#   libgdbmg1  (non-development version of GNU libc 2-linked GDBM library)
#   libgdbmg1-dev (development version of GNU libc 2-linked GDBM library)
# So make sure that for any libraries you wish to link Perl with under
# Debian or Red Hat you have the -dev packages installed.
#
# Some operating systems (e.g., Solaris 2.6) will link to a versioned shared
# library implicitly.  For example, on Solaris, `ld foo.o -lgdbm' will find an
# appropriate version of libgdbm, if one is available; Linux, however, doesn't
# do the implicit mapping.
ignore_versioned_solibs='y'

d30 1
a30 2
# 'kaffe' has a /usr/lib/libnet.so which is not at all relevent for perl.
set `echo X "$libswanted "| sed -e 's/ bsd / /' -e 's/ net / /'`
d137 2
a138 2
  echo ''
  echo 'You appear to have a working bash.  Good.'
d151 6
a156 38
# On SPARClinux,
# The following csh consistently coredumped in the test directory
# "/home/mikedlr/perl5.003_94/t", though not most other directories.

#Name        : csh                    Distribution: Red Hat Linux (Rembrandt)
#Version     : 5.2.6                        Vendor: Red Hat Software
#Release     : 3                        Build Date: Fri May 24 19:42:14 1996
#Install date: Thu Jul 11 16:20:14 1996 Build Host: itchy.redhat.com
#Group       : Shells                   Source RPM: csh-5.2.6-3.src.rpm
#Size        : 184417
#Description : BSD c-shell

# For this reason I suggest using the much bug-fixed tcsh for globbing
# where available.

if [  ! "`csh -c 'echo $version' 2>/dev/null`"  ] 
then
    echo 'Real csh found (might break); looking for tcsh ...'
    # Use ./UU/loc to find tcsh.  (We no longer run in the hints/ directory)
    if xxx=`./UU/loc tcsh blurfl $pth`; $test -f "$xxx"; then
	echo "Found tcsh.  I'll use it for globbing."
	# We can't change Configure's setting of $csh, due to the way
	# Configure handles $d_portable and commands found in $loclist.
	# We can set the value for CSH in config.h by setting full_csh.
	full_csh=$xxx
    else
	echo "Couldn't find tcsh.  BEWARE:  GLOBBING MIGHT BE BROKEN."
    fi
else
    echo 'Your csh is really tcsh.  Good.'
fi

# Shimpei Yamashita <shimpei@@socrates.patnet.caltech.edu>
# Message-Id: <33EF1634.B36B6500@@pobox.com>
# 
# The DR2 of MkLinux (osname=linux,archname=ppc-linux) may need
# special flags passed in order for dynamic loading to work.
# instead of the recommended:
d158 2
a159 1
# ccdlflags='-rdynamic'
d161 3
a163 22
# it should be:
# ccdlflags='-Wl,-E'
#
# So if your DR2 (DR3 came out summer 1998, consider upgrading)
# has problems with dynamic loading, uncomment the
# following three lines, make distclean, and re-Configure:
#case "`uname -r | sed 's/^[0-9.-]*//'``arch`" in
#'osfmach3ppc') ccdlflags='-Wl,-E' ;;
#esac

# This script UU/usethreads.cbu will get 'called-back' by Configure 
# after it has prompted the user for whether to use threads.
cat > UU/usethreads.cbu <<'EOCBU'
case "$usethreads" in
$define|true|[yY]*)
        ccflags="-D_REENTRANT $ccflags"
        set `echo X "$libswanted "| sed -e 's/ c / pthread c /'`
        shift
        libswanted="$*"
	;;
esac
EOCBU
@


1.1.1.3
log
@virgin perl 5.6.0
@
text
@d46 6
a51 24
#
#  Addendum for 5.005_57 and beyond:
#
# However, most Linux users probably already have a /usr/bin/perl.
# We can't know whether the current user is intending to *replace*
# that /usr/bin/perl or whether the user is intending to install
# a *different* installation.
#
# Here is what we used to do:
# Allow a command line override, e.g. Configure -Dprefix=/foo/bar
# case "$prefix" in
# '') prefix='/usr' ;;
# esac
#
# For now, let's assume that most Linux users get their /usr/bin/perl
# from some packaging system, so that those compiling from source are
# probably the more experimental folks and hence probably aren't
# intending to replace /usr/bin/perl (at least just yet).
# This change makes linux consistent with most other unix platforms
# in having a default of prefix=/usr/local.
# These notes can probably safely be removed in 5.005_50 and beyond.
#
#	9 April 1999  Andy Dougherty  <doughera@@lafayette.edu>
#
a58 13
# If you have glibc, then report the version for ./myconfig bug reporting.
# (Configure doesn't need to know the specific version since it just uses
# gcc to load the library for all tests.)
# Is this sufficiently robust for libc5 systems as well as
# glibc-2.1.x systems?
# We don't use __GLIBC__ and  __GLIBC_MINOR__ because they 
# are insufficiently precise to distinguish things like
# libc-2.0.6 and libc-2.0.7.
if test -L /lib/libc.so.6; then
    libc=`ls -l /lib/libc.so.6 | awk '{print $NF}'`
    libc=/lib/$libc
fi

a226 9
case "`uname -r`" in
sparc-linux)
	case "$cccdlflags" in
	*-fpic*) cccdlflags="`echo $cccdlflags|sed 's/-fpic/-fPIC/'`" ;;
	*)	 cccdlflags="$cccdlflags -fPIC" ;;
	esac
	;;
esac

a235 10
	;;
esac
EOCBU

cat > UU/uselargefiles.cbu <<'EOCBU'
# This script UU/uselargefiles.cbu will get 'called-back' by Configure 
# after it has prompted the user for whether to use large files.
case "$uselargefiles" in
''|$define|true|[yY]*)
	ccflags="$ccflags -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64"
@


1.1.1.4
log
@stock perl 5.6.1
@
text
@d192 1
a192 1
if /bin/sh -c exit; then
d285 1
a285 4
# Keep this in the left margin.
ccflags_uselargefiles="-D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64"

	ccflags="$ccflags $ccflags_uselargefiles"
@


1.1.1.5
log
@stock perl 5.8.0 from CPAN
@
text
@d9 1
a9 1
# Consolidated by Andy Dougherty <doughera@@lafayette.edu>
d13 1
a13 1
# Updated Thu May 30 10:50:22 EDT 1996 by <doughera@@lafayette.edu>
d42 29
d80 2
d94 1
a94 3
# The system malloc() is about as fast and as frugal as perl's. 
# Since the system malloc() has been the default since at least
# 5.001, we might as well leave it that way.  --AD  10 Jan 2002
d100 1
a100 13
'') # If we have modern enough gcc and well-supported enough CPU,
    # crank up the optimization level.
    case "`${cc:-gcc} -v 2>&1`" in
    *"gcc version 2.95"*|*"gcc version 3."*)
        case "`arch 2>&1`" in
        i?86|ppc) optimize='-O3' ;;
        esac
        ;;
    esac
    case "$optimize" in
    '') optimize='-O2' ;;
    esac
    ;;
d122 1
a122 1
if ${cc:-gcc} try.c >/dev/null 2>&1 && $run ./a.out; then
d129 4
d222 4
a225 7
# November 2001:  That warning's pretty old now and probably not so
# relevant, especially since perl now uses File::Glob for globbing.
# We'll still look for tcsh, but tone down the warnings.
# Andy Dougherty, Nov. 6, 2001
if $csh -c 'echo $version' >/dev/null 2>&1; then
    echo 'Your csh is really tcsh.  Good.'
else
d232 2
a233 2
    elif [ -f "$csh" ]; then
	echo "Couldn't find tcsh.  Csh-based globbing might be broken."
d235 2
d272 1
a272 1
        ccflags="-D_REENTRANT -D_GNU_SOURCE $ccflags"
a275 13

	# Somehow at least in Debian 2.2 these manage to escape
	# the #define forest of <features.h> and <time.h> so that
	# the hasproto macro of Configure doesn't see these protos,
	# even with the -D_GNU_SOURCE.

	d_asctime_r_proto="$define"
	d_crypt_r_proto="$define"
	d_ctime_r_proto="$define"
	d_gmtime_r_proto="$define"
	d_localtime_r_proto="$define"
	d_random_r_proto="$define"

@


1.1.1.6
log
@perl 5.8.2 from CPAN
@
text
@d51 1
a51 1
# We don't use __GLIBC__ and  __GLIBC_MINOR__ because they
d63 1
a63 1
# The system malloc() is about as fast and as frugal as perl's.
a69 12
# Check if we're about to use Intel's ICC compiler
case "`${cc:-cc} -V 2>&1`" in
*"Intel(R) C++ Compiler"*)
    # This is needed for Configure's prototype checks to work correctly
    ccflags="-we147 $ccflags"
    # If we're using ICC, we usually want the best performance
    case "$optimize" in
    '') optimize='-O3' ;;
    esac
    ;;
esac

d137 2
a138 2
	# which causes AnyDBM and NDBM_File to lock up. This is evidenced
	# in the tests as AnyDBM just freezing.  Apparently, this only
d151 1
a151 1
	#
d221 1
a221 1
#
d227 1
a227 1
#
d247 1
a247 18
# SuSE8.2 has /usr/lib/libndbm* which are ld scripts rather than
# true libraries. The scripts cause binding against static
# version of -lgdbm which is a bad idea. So if we have 'nm'
# make sure it can read the file
# NI-S 2003/08/07
if [ -r /usr/lib/libndbm.so  -a  -x /usr/bin/nm ] ; then
   if /usr/bin/nm /usr/lib/libndbm.so >/dev/null 2>&1 ; then
    echo 'Your shared -lndbm seems to be a real library.'
   else
    echo 'Your shared -lndbm is not a real library.'
    set `echo X "$libswanted "| sed -e 's/ ndbm / /'`
    shift
    libswanted="$*"
   fi
fi


# This script UU/usethreads.cbu will get 'called-back' by Configure
d252 1
a252 1
        ccflags="-D_REENTRANT -D_GNU_SOURCE -DTHREADS_HAVE_PIDS $ccflags"
d274 1
a274 1
# This script UU/uselargefiles.cbu will get 'called-back' by Configure
@


1.1.1.7
log
@perl 5.8.3 from CPAN
@
text
@d250 2
a251 2
case "`uname -m`" in
sparc*)
@


1.1.1.8
log
@Import of stock perl 5.8.5
@
text
@a62 5
# malloc wrap works
case "$usemallocwrap" in
'') usemallocwrap='define' ;;
esac

d83 7
a89 8
# use -O2 by default ; -O3 doesn't seem to bring significant benefits with gcc
'')
    optimize='-O2'
    case "`uname -m`" in
        ppc*)
            # on ppc, it seems that gcc (at least gcc 3.3.2) isn't happy
	    # with -O2 ; so downgrade to -O1.
            optimize='-O1'
d91 3
@


1.1.1.9
log
@perl 5.8.8 import
@
text
@d42 3
a44 4
# BSD compatibility library no longer needed
# 'kaffe' has a /usr/lib/libnet.so which is not at all relevant for perl.
# bind causes issues with several reentrant functions
set `echo X "$libswanted "| sed -e 's/ bsd / /' -e 's/ net / /' -e 's/ bind / /'`
d77 1
a77 1
*"Intel(R) C++ Compiler"*|*"Intel(R) C Compiler"*)
a84 5
*"Sun C"*)
    optimize='-xO2'
    cccdlflags='-KPIC'
    lddlflags='-G -Bdynamic'
    ;;
a316 10

# Purify fails to link Perl if a "-lc" is passed into its linker
# due to duplicate symbols.
case "$PURIFY" in
$define|true|[yY]*)
    set `echo X "$libswanted "| sed -e 's/ c / /'`
    shift
    libswanted="$*"
    ;;
esac
@


1.1.1.10
log
@import perl 5.10.0 from CPAN
@
text
@d35 1
a35 9

# SuSE Linux can be used as cross-compilation host for Cray XT4 Catamount/Qk.
if test -d /opt/xt-pe
then
  case "`cc -V 2>&1`" in
  *catamount*) . hints/catamount.sh; return ;;
  esac
fi

d80 1
a80 3
    # The -mp flag is needed to pass various floating point related tests
    # The -no-gcc flag is needed otherwise, icc pretends (poorly) to be gcc
    ccflags="-we147 -mp -no-gcc $ccflags"
a89 9
    # Sun C doesn't support gcc attributes, but, in many cases, doesn't
    # complain either.  Not all cases, though.
    d_attribute_format='undef'
    d_attribute_malloc='undef'
    d_attribute_nonnull='undef'
    d_attribute_noreturn='undef'
    d_attribute_pure='undef'
    d_attribute_unused='undef'
    d_attribute_warn_unused_result='undef'
d100 1
a100 1
            # with -O2 ; so downgrade to -O1.
a102 10
        ia64*)
            # This architecture has had various problems with gcc's
            # in the 3.2, 3.3, and 3.4 releases when optimized to -O2.  See
            # RT #37156 for a discussion of the problem.
            case "`${cc:-gcc} -v 2>&1`" in
            *"version 3.2"*|*"version 3.3"*|*"version 3.4"*)
                ccflags="-fno-delete-null-pointer-checks $ccflags"
            ;;
            esac
        ;;
a112 1
#include <unistd.h>
a262 1
	*-fPIC*) ;;
a287 6
if getconf GNU_LIBPTHREAD_VERSION | grep NPTL >/dev/null 2>/dev/null
then
    threadshavepids=""
else
    threadshavepids="-DTHREADS_HAVE_PIDS"
fi
d290 4
a293 7
        ccflags="-D_REENTRANT -D_GNU_SOURCE $threadshavepids $ccflags"
        if echo $libswanted | grep -v pthread >/dev/null
        then
            set `echo X "$libswanted "| sed -e 's/ c / pthread c /'`
            shift
            libswanted="$*"
        fi
a330 53
    ;;
esac

# If we are using g++ we must use nm and force ourselves to use
# the /usr/lib/libc.a (resetting the libc below to an empty string
# makes Configure to look for the right one) because the symbol
# scanning tricks of Configure will crash and burn horribly.
case "$cc" in
*g++*) usenm=true
       libc=''
       ;;
esac

# If using g++, the Configure scan for dlopen() and (especially)
# dlerror() might fail, easier just to forcibly hint them in.
case "$cc" in
*g++*)
  d_dlopen='define'
  d_dlerror='define'
  ;;
esac

# Under some circumstances libdb can get built in such a way as to
# need pthread explicitly linked.

libdb_needs_pthread="N"

if echo " $libswanted " | grep -v " pthread " >/dev/null
then
   if echo " $libswanted " | grep " db " >/dev/null
   then
     for DBDIR in $glibpth
     do
       DBLIB="$DBDIR/libdb.so"
       if [ -f $DBLIB ]
       then
         if nm -u $DBLIB | grep pthread >/dev/null
         then
           if ldd $DBLIB | grep pthread >/dev/null
           then
             libdb_needs_pthread="N"
           else
             libdb_needs_pthread="Y"
           fi
         fi
       fi
     done
   fi
fi

case "$libdb_needs_pthread" in
  "Y")
    libswanted="$libswanted pthread"
@


1.1.1.11
log
@import perl 5.10.1
@
text
@a56 3
# Debian 4.0 puts ndbm in the -lgdbm_compat library.
libswanted="$libswanted gdbm_compat"

a90 6
    # Prevent relocation errors on 64bits arch
    case "`uname -m`" in
	*ia64*|*x86_64*)
	    cccdlflags='-fPIC'
	;;
    esac
d96 2
a97 6
*" Sun "*"C"*)
    # Sun's C compiler, which might have a 'tag' name between
    # 'Sun' and the 'C':  Examples:
    # cc: Sun C 5.9 Linux_i386 Patch 124871-01 2007/07/31
    # cc: Sun Ceres C 5.10 Linux_i386 2008/07/10
    test "$optimize" || optimize='-xO2'
@


1.1.1.12
log
@Perl 5.12.2 from CPAN
@
text
@a89 5
    # record the version, formats:
    # icc (ICC) 10.1 20080801
    # icpc (ICC) 10.1 20080801
    # followed by a copyright on the second line
    ccversion=`${cc:-cc} --version | sed -n -e 's/^icp\?c \((ICC) \)\?//p'`
@


1.1.1.13
log
@import perl 5.16.3 from CPAN - worked on by Andrew Fresh and myself
@
text
@d16 1
a16 1
# NDBM support for ELF re-enabled by <kjahds@@kjahds.com>
a20 3
# No version of Linux needs libutil for perl.
i_libutil='undef'

a153 28
# Ubuntu 11.04 (and later, presumably) doesn't keep most libraries
# (such as -lm) in /lib or /usr/lib.  So we have to ask gcc to tell us
# where to look.  We don't want gcc's own libraries, however, so we
# filter those out.
# This could be conditional on Unbuntu, but other distributions may
# follow suit, and this scheme seems to work even on rather old gcc's.
# This unconditionally uses gcc because even if the user is using another
# compiler, we still need to find the math library and friends, and I don't
# know how other compilers will cope with that situation.
# Morever, if the user has their own gcc earlier in $PATH than the system gcc,
# we don't want its libraries. So we try to prefer the system gcc
# Still, as an escape hatch, allow Configure command line overrides to
# plibpth to bypass this check.
if [ -x /usr/bin/gcc ] ; then
    gcc=/usr/bin/gcc
else
    gcc=gcc
fi

case "$plibpth" in
'') plibpth=`LANG=C LC_ALL=C $gcc -print-search-dirs | grep libraries |
	cut -f2- -d= | tr ':' $trnl | grep -v 'gcc' | sed -e 's:/$::'`
    set X $plibpth # Collapse all entries on one line
    shift
    plibpth="$*"
    ;;
esac

d337 6
d345 1
a345 1
        ccflags="-D_REENTRANT -D_GNU_SOURCE $ccflags"
@


1.1.1.14
log
@Import perl-5.18.2

OK espie@@ sthen@@ deraadt@@
@
text
@d417 10
@


1.1.1.15
log
@Import perl-5.20.1
@
text
@d42 1
a42 1
  case "`${cc:-cc} -V 2>&1`" in
d61 11
a71 4
echo $libs
if echo " $libswanted " | grep -q ' gdbm '; then
    # Only add if gdbm is in libswanted.
    libswanted="$libswanted gdbm_compat"
a89 3
uname_minus_m="`$run uname -m 2>/dev/null`"
uname_minus_m="${uname_minus_m:-"$targetarch"}"

d103 1
a103 1
    case "$uname_minus_m" in
d137 1
a137 1
    case "$uname_minus_m" in
d177 1
a177 1
'') plibpth=`LANG=C LC_ALL=C $gcc $ccflags $ldflags -print-search-dirs | grep libraries |
a184 26
case "$libc" in
'')
# If you have glibc, then report the version for ./myconfig bug reporting.
# (Configure doesn't need to know the specific version since it just uses
# gcc to load the library for all tests.)
# We don't use __GLIBC__ and  __GLIBC_MINOR__ because they
# are insufficiently precise to distinguish things like
# libc-2.0.6 and libc-2.0.7.
    for p in $plibpth
    do
        for trylib in libc.so.6 libc.so
        do
            if $test -e $p/$trylib; then
                libc=`ls -l $p/$trylib | awk '{print $NF}'`
                if $test "X$libc" != X; then
                    break
                fi
            fi
        done
        if $test "X$libc" != X; then
            break
        fi
    done
    ;;
esac

d205 1
a205 1
if ${cc:-gcc} $ccflags $ldflags try.c >/dev/null 2>&1 && $run ./a.out; then
d271 1
a271 1
if ${sh:-/bin/sh} -c exit; then
d338 1
a338 1
case "$uname_minus_m" in
d353 10
a362 21
case "$nm" in
    '') ;;
    *)
    for p in $plibpth
    do
        if $test -r $p/libndbm.so; then
            if $nm $p/libndbm.so >/dev/null 2>&1 ; then
                echo 'Your shared -lndbm seems to be a real library.'
                _libndbm_real=1
                break
            fi
        fi
    done
    if $test "X$_libndbm_real" = X; then
        echo 'Your shared -lndbm is not a real library.'
        set `echo X "$libswanted "| sed -e 's/ ndbm / /'`
        shift
        libswanted="$*"
    fi
    ;;
esac
a363 27
# Linux on Synology.
if [ -f /etc/synoinfo.conf -a -d /usr/syno ]; then
    # Tested on Synology DS213 and DS413
    #  OS version info in /etc.defaults/VERSION
    #  http://forum.synology.com/wiki/index.php/What_kind_of_CPU_does_my_NAS_have
    # Synology DS213 running DSM 4.3-3810-0 (2013-11-06)
    #  CPU model Marvell Kirkwood mv6282 ARMv5te
    #  Linux 2.6.32.12 #3810 Wed Nov 6 05:13:41 CST 2013 armv5tel GNU/Linux
    # Synology DS413 running DSM 4.3-3810-0 (2013-11-06)
    #  CPU model Freescale QorIQ P1022 ppc (e500v2)
    #  linux 2.6.32.12 #3810 ppc GNU/Linux
    # All development stuff installed with ipkg is in /opt
    if [ "$LANG" = "" -o "$LANG" = "C" ]; then
	echo 'Your LANG is safe'
    else
	echo 'Please set $LANG to "C". All other $LANG settings will cause havoc' >&4
	LANG=C
    fi
    echo 'Setting up to use /opt/*' >&4
    locincpth="/opt/include $locincpth"
    libpth="/opt/lib $libpth"
    libspth="/opt/lib $libspth"
    loclibpth="/opt/lib $loclibpth"
    # POSIX will not link without the pthread lib
    libswanted="$libswanted pthread"
    echo "$libswanted" >&4
fi
d440 1
a440 1
         if ${nm:-nm} -u $DBLIB | grep pthread >/dev/null
@


