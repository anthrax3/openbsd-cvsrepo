head	1.6;
access;
symbols
	OPENBSD_3_2:1.5.0.6
	OPENBSD_3_2_BASE:1.5
	OPENBSD_3_1:1.5.0.4
	OPENBSD_3_1_BASE:1.5
	OPENBSD_3_0:1.5.0.2
	OPENBSD_3_0_BASE:1.5
	PERL_5_6_1:1.1.1.1
	OPENBSD_2_9:1.4.0.6
	OPENBSD_2_9_BASE:1.4
	OPENBSD_2_8:1.4.0.4
	OPENBSD_2_8_BASE:1.4
	OPENBSD_2_7:1.4.0.2
	OPENBSD_2_7_BASE:1.4
	PERL_5_6_0:1.1.1.1
	OPENBSD_2_6:1.3.0.2
	OPENBSD_2_6_BASE:1.3
	PERL_500503:1.1.1.1
	CPAN:1.1.1
	OPENBSD_2_5:1.2.0.6
	OPENBSD_2_5_BASE:1.2
	OPENBSD_2_4:1.2.0.4
	OPENBSD_2_4_BASE:1.2
	OPENBSD_2_3:1.2.0.2
	OPENBSD_2_3_BASE:1.2
	OPENBSD_2_2:1.1.1.1.0.6
	OPENBSD_2_2_BASE:1.1.1.1
	OPENBSD_2_1:1.1.1.1.0.4
	OPENBSD_2_1_BASE:1.1.1.1
	OPENBSD_2_0:1.1.1.1.0.2
	OPENBSD_2_0_BASE:1.1.1.1
	perl5003:1.1.1.1
	lwall:1.1.1;
locks; strict;
comment	@# @;


1.6
date	2002.10.27.22.25.21;	author millert;	state dead;
branches;
next	1.5;

1.5
date	2001.05.24.18.35.05;	author millert;	state Exp;
branches;
next	1.4;

1.4
date	2000.04.06.17.04.55;	author millert;	state Exp;
branches;
next	1.3;

1.3
date	99.04.29.22.51.20;	author millert;	state Exp;
branches;
next	1.2;

1.2
date	97.11.30.07.54.51;	author millert;	state Exp;
branches;
next	1.1;

1.1
date	96.08.19.10.11.56;	author downsj;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	96.08.19.10.11.56;	author downsj;	state Exp;
branches;
next	;


desc
@@


1.6
log
@Resolve conflicts, remove old files, merge local changes
@
text
@#!/usr/bin/perl -P

# $RCSfile: scan_last,v $$Revision: 1.5 $$Date: 2001/05/24 18:35:05 $

# This reports who was logged on at weird hours

($dy, $mo, $lastdt) = split(/ +/,`date`);

open(Last, 'exec last 2>&1 |') || die "scan_last: can't run last";

while (<Last>) {
#if defined(mc300) || defined(mc500) || defined(mc700)
    $_ = substr($_,0,19) . substr($_,23,100);
#endif
    next if /^$/;
    (print),next if m|^/|;
    $login  = substr($_,0,8);
    $tty    = substr($_,10,7);
    $from   = substr($_,19,15);
    $day    = substr($_,36,3);
    $mo     = substr($_,40,3);
    $dt     = substr($_,44,2);
    $hr     = substr($_,47,2);
    $min    = substr($_,50,2);
    $dash   = substr($_,53,1);
    $tohr   = substr($_,55,2);
    $tomin  = substr($_,58,2);
    $durhr  = substr($_,63,2);
    $durmin = substr($_,66,2);
    
    next unless $hr;
    next if $login eq 'reboot  ';
    next if $login eq 'shutdown';

    if ($dt != $lastdt) {
	if ($lastdt < $dt) {
	    $seen += $dt - $lastdt;
	}
	else {
	    $seen++;
	}
	$lastdt = $dt;
    }

    $inat = $hr + $min / 60;
    if ($tohr =~ /^[a-z]/) {
	$outat = 12;		# something innocuous
    } else {
	$outat = $tohr + $tomin / 60;
    }

  last if $seen + ($inat < 8) > 1;

    if ($inat < 5 || $inat > 21 || $outat < 6 || $outat > 23) {
	print;
    }
}
@


1.5
log
@merge in perl 5.6.1 with our local changes
@
text
@d3 1
a3 1
# $RCSfile: scan_last,v $$Revision: 4.1 $$Date: 92/08/07 17:20:35 $
@


1.4
log
@perl-5.6.0 + local changes
@
text
@@


1.3
log
@perl5.005_03 (stock)
@
text
@@


1.2
log
@perl 5.004_04
@
text
@@


1.1
log
@Initial revision
@
text
@@


1.1.1.1
log
@Import of Perl 5.003 into the tree.  Makefile.bsd-wrapper and
config.sh.OpenBSD are the only local changes.
@
text
@@
