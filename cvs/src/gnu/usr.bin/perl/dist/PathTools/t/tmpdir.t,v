head	1.1;
branch	1.1.1;
access;
symbols
	OPENBSD_6_2:1.1.1.1.0.14
	OPENBSD_6_2_BASE:1.1.1.1
	PERL_5_24_2:1.1.1.1
	OPENBSD_6_1:1.1.1.1.0.12
	OPENBSD_6_1_BASE:1.1.1.1
	OPENBSD_6_0:1.1.1.1.0.10
	OPENBSD_6_0_BASE:1.1.1.1
	OPENBSD_5_9:1.1.1.1.0.4
	OPENBSD_5_9_BASE:1.1.1.1
	OPENBSD_5_8:1.1.1.1.0.6
	OPENBSD_5_8_BASE:1.1.1.1
	PERL_5_20_2:1.1.1.1
	OPENBSD_5_7:1.1.1.1.0.2
	OPENBSD_5_7_BASE:1.1.1.1
	PERL_5_20_1:1.1.1.1
	PERL:1.1.1;
locks; strict;
comment	@# @;
expand	@b@;


1.1
date	2014.11.17.20.53.04;	author afresh1;	state Exp;
branches
	1.1.1.1;
next	;
commitid	B31cAbBIXiCqnL97;

1.1.1.1
date	2014.11.17.20.53.04;	author afresh1;	state Exp;
branches;
next	;
commitid	B31cAbBIXiCqnL97;


desc
@@


1.1
log
@Initial revision
@
text
@use strict;
use Test::More tests => 8;

# Grab all of the plain routines from File::Spec
use File::Spec;
use File::Spec::Win32;

require_ok($_) foreach qw(File::Spec File::Spec::Win32);


if ($^O eq 'VMS') {
    # hack:
    # Need to cause the %ENV to get populated or you only get the builtins at
    # first, and then something else can cause the hash to get populated.
    my %look_env = %ENV;
}
my $num_keys = keys %ENV;
File::Spec->tmpdir;
is scalar keys %ENV, $num_keys, "tmpdir() shouldn't change the contents of %ENV";

SKIP: {
    skip("Can't make list assignment to %ENV on this system", 1)
	if $^O eq 'VMS';

    local %ENV;
    File::Spec::Win32->tmpdir;
    is(scalar keys %ENV, 0, "Win32->tmpdir() shouldn't change the contents of %ENV");
}

File::Spec::Win32->tmpdir;
is(scalar keys %ENV, $num_keys, "Win32->tmpdir() shouldn't change the contents of %ENV");

# Changing tmpdir dynamically
for ('File::Spec', "File::Spec::Win32") {
  SKIP: {
    skip('sys$scratch: takes precedence over env on vms', 1)
	if $^O eq 'VMS';
    local $ENV{TMPDIR} = $_->catfile($_->curdir, 'lib');
    -d $ENV{TMPDIR} && -w _
       or skip "Can't create usable TMPDIR env var", 1;
    my $tmpdir1 = $_->tmpdir;
    $ENV{TMPDIR} = $_->catfile($_->curdir, 't');
    -d $ENV{TMPDIR} && -w _
       or skip "Can't create usable TMPDIR env var", 1;
    my $tmpdir2 = $_->tmpdir;
    isn't $tmpdir2, $tmpdir1, "$_->tmpdir works with changing env";
  }
}

ok(
    File::Spec->file_name_is_absolute(File::Spec->tmpdir()),
    "tmpdir() always returns an absolute path"
);
@


1.1.1.1
log
@Import perl-5.20.1
@
text
@@
