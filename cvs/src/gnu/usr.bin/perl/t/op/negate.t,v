head	1.2;
access;
symbols
	OPENBSD_6_0:1.1.1.3.0.12
	OPENBSD_6_0_BASE:1.1.1.3
	OPENBSD_5_9:1.1.1.3.0.6
	OPENBSD_5_9_BASE:1.1.1.3
	OPENBSD_5_8:1.1.1.3.0.8
	OPENBSD_5_8_BASE:1.1.1.3
	PERL_5_20_2:1.1.1.3
	OPENBSD_5_7:1.1.1.3.0.2
	OPENBSD_5_7_BASE:1.1.1.3
	PERL_5_20_1:1.1.1.3
	OPENBSD_5_6:1.1.1.3.0.4
	OPENBSD_5_6_BASE:1.1.1.3
	PERL_5_18_2:1.1.1.3
	PERL:1.1.1
	OPENBSD_5_5:1.1.1.2.0.6
	OPENBSD_5_5_BASE:1.1.1.2
	OPENBSD_5_4:1.1.1.2.0.2
	OPENBSD_5_4_BASE:1.1.1.2
	PERL_5_16_3:1.1.1.2
	OPENBSD_5_3:1.1.1.1.0.28
	OPENBSD_5_3_BASE:1.1.1.1
	OPENBSD_5_2:1.1.1.1.0.26
	OPENBSD_5_2_BASE:1.1.1.1
	OPENBSD_5_1_BASE:1.1.1.1
	OPENBSD_5_1:1.1.1.1.0.24
	OPENBSD_5_0:1.1.1.1.0.22
	OPENBSD_5_0_BASE:1.1.1.1
	OPENBSD_4_9:1.1.1.1.0.20
	OPENBSD_4_9_BASE:1.1.1.1
	PERL_5_12_2:1.1.1.1
	OPENBSD_4_8:1.1.1.1.0.18
	OPENBSD_4_8_BASE:1.1.1.1
	OPENBSD_4_7:1.1.1.1.0.14
	OPENBSD_4_7_BASE:1.1.1.1
	PERL_5_10_1:1.1.1.1
	OPENBSD_4_6:1.1.1.1.0.16
	OPENBSD_4_6_BASE:1.1.1.1
	OPENBSD_4_5:1.1.1.1.0.12
	OPENBSD_4_5_BASE:1.1.1.1
	PERL_5_10_0:1.1.1.1
	OPENBSD_4_4:1.1.1.1.0.10
	OPENBSD_4_4_BASE:1.1.1.1
	OPENBSD_4_3:1.1.1.1.0.8
	OPENBSD_4_3_BASE:1.1.1.1
	OPENBSD_4_2:1.1.1.1.0.6
	OPENBSD_4_2_BASE:1.1.1.1
	OPENBSD_4_1:1.1.1.1.0.4
	OPENBSD_4_1_BASE:1.1.1.1
	OPENBSD_4_0:1.1.1.1.0.2
	OPENBSD_4_0_BASE:1.1.1.1
	PERL_5_8_8:1.1.1.1
	CPAN:1.1.1;
locks; strict;
comment	@# @;
expand	@o@;


1.2
date	2017.02.05.00.32.20;	author afresh1;	state Exp;
branches;
next	1.1;
commitid	cxJ08BvJA9Pt2PTM;

1.1
date	2006.03.28.18.49.45;	author millert;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2006.03.28.18.49.45;	author millert;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	2013.03.25.20.09.36;	author sthen;	state Exp;
branches;
next	1.1.1.3;

1.1.1.3
date	2014.03.24.14.59.10;	author afresh1;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Fix merge issues, remove excess files - match perl-5.24.1 dist
@
text
@#!./perl -w

BEGIN {
    chdir 't' if -d 't';
    @@INC = '../lib';
    require './test.pl';
}

plan tests => 48;

# Some of these will cause warnings if left on.  Here we're checking the
# functionality, not the warnings.
no warnings "numeric";

# test cases based on [perl #36675] -'-10' eq '+10'
is(- 10, -10, "Simple numeric negation to negative");
is(- -10, 10, "Simple numeric negation to positive");
is(-"10", -10, "Negation of a positive string to negative");
is(-"10.0", -10, "Negation of a positive decimal sting to negative");
is(-"10foo", -10, "Negation of a numeric-lead string returns negation of numeric");
is(-"-10", 10, 'Negation of string starting with "-" returns a positive number - integer');
"-10" =~ /(.*)/;
is(-$1, 10, 'Negation of magical string starting with "-" - integer');
is(-"-10.0", 10.0, 'Negation of string starting with "-" returns a positive number - decimal');
"-10.0" =~ /(.*)/;
is(-$1, 10.0, 'Negation of magical string starting with "-" - decimal');
is(-"-10foo", "+10foo", 'Negation of string starting with "-" returns a string starting with "+" - non-numeric');
is(-"xyz", "-xyz", 'Negation of a negative string adds "-" to the front');
is(-"-xyz", "+xyz", "Negation of a negative string to positive");
is(-"+xyz", "-xyz", "Negation of a positive string to negative");
is(-bareword, "-bareword", "Negation of bareword treated like a string");
is(- -bareword, "+bareword", "Negation of -bareword returns string +bareword");
is(-" -10", 10, "Negation of a whitespace-lead numeric string");
is(-" -10.0", 10, "Negation of a whitespace-lead decimal string");
is(-" -10foo", 10,
    "Negation of a whitespace-lead sting starting with a numeric");
is(-"-e1", "+e1", "Negation of e1");

$x = "dogs";
()=0+$x;
is -$x, '-dogs', 'cached numeric value does not sabotage string negation';

is(-"97656250000000000", -97656250000000000, '-bigint vs -"bigint"');
"9765625000000000" =~ /(\d+)/;
is -$1, -"$1", '-$1 vs -"$1" with big int';

$a = "%apples";
chop($au = "%apples\x{100}");
is(-$au, -$a, 'utf8 flag makes no difference for string negation');
is -"\x{100}", 0, '-(non-ASCII) is equivalent to -(punct)';

sub TIESCALAR { bless[] }
sub STORE { $_[0][0] = $_[1] }
sub FETCH { $_[0][0] }

tie $t, "";
$a = "97656250000000000";
() = 0+$a;
$t = $a;
is -$t, -97656250000000000, 'magic str+int dualvar';

{ # Repeat most of the tests under use integer
    use integer;
    is(- 10, -10, "Simple numeric negation to negative");
    is(- -10, 10, "Simple numeric negation to positive");
    is(-"10", -10, "Negation of a positive string to negative");
    is(-"10.0", -10, "Negation of a positive decimal sting to negative");
    is(-"10foo", -10,
        "Negation of a numeric-lead string returns negation of numeric");
    is(-"-10", 10,
        'Negation of string starting with "-" returns a positive number -'
       .' integer');
    "-10" =~ /(.*)/;
    is(-$1, 10, 'Negation of magical string starting with "-" - integer');
    is(-"-10.0", 10,
        'Negation of string starting with "-" returns a positive number - '
       .'decimal');
    "-10.0" =~ /(.*)/;
    is(-$1, 10, 'Negation of magical string starting with "-" - decimal');
    is(-"-10foo", "+10foo",
       'Negation of string starting with "-" returns a string starting '
      .'with "+" - non-numeric');
    is(-"xyz", "-xyz",
       'Negation of a negative string adds "-" to the front');
    is(-"-xyz", "+xyz", "Negation of a negative string to positive");
    is(-"+xyz", "-xyz", "Negation of a positive string to negative");
    is(-bareword, "-bareword",
        "Negation of bareword treated like a string");
    is(- -bareword, "+bareword",
        "Negation of -bareword returns string +bareword");
    is(-" -10", 10, "Negation of a whitespace-lead numeric string");
    is(-" -10.0", 10, "Negation of a whitespace-lead decimal string");
    is(-" -10foo", 10,
        "Negation of a whitespace-lead sting starting with a numeric");
    is(-"-e1", "+e1", "Negation of e1 (use integer)");

    $x = "dogs";
    ()=0+$x;
    is -$x, '-dogs',
        'cached numeric value does not sabotage string negation';

    $a = "%apples";
    chop($au = "%apples\x{100}");
    is(-$au, -$a, 'utf8 flag makes no difference for string negation');
    is -"\x{100}", 0, '-(non-ASCII) is equivalent to -(punct)';
}

# [perl #120288] use integer should not stop barewords from being quoted
{
    use strict;
    use integer;
    is eval "return -a"||$@@, "-a", '-bareword under strict+integer';
}
@


1.1
log
@Initial revision
@
text
@d9 1
a9 1
plan tests => 16;
d21 6
a26 2
is(-"-10", "+10", 'Negation of string starting with "-" returns a string starting with "+" - numeric');
is(-"-10.0", "+10.0", 'Negation of string starting with "-" returns a string starting with "+" - decimal');
d35 79
a113 1
is(-" -10foo", 10, "Negation of a whitespace-lead sting starting with a numeric")
@


1.1.1.1
log
@perl 5.8.8 import
@
text
@@


1.1.1.2
log
@import perl 5.16.3 from CPAN - worked on by Andrew Fresh and myself
@
text
@d21 2
a22 2
is(-"-10", 10, 'Negation of string starting with "-" returns a positive number - integer');
is(-"-10.0", 10.0, 'Negation of string starting with "-" returns a positive number - decimal');
@


1.1.1.3
log
@Import perl-5.18.2

OK espie@@ sthen@@ deraadt@@
@
text
@d9 1
a9 1
plan tests => 46;
a21 2
"-10" =~ /(.*)/;
is(-$1, 10, 'Negation of magical string starting with "-" - integer');
a22 2
"-10.0" =~ /(.*)/;
is(-$1, 10.0, 'Negation of magical string starting with "-" - decimal');
d31 1
a31 77
is(-" -10foo", 10,
    "Negation of a whitespace-lead sting starting with a numeric");

$x = "dogs";
()=0+$x;
is -$x, '-dogs', 'cached numeric value does not sabotage string negation';

is(-"97656250000000000", -97656250000000000, '-bigint vs -"bigint"');
"9765625000000000" =~ /(\d+)/;
is -$1, -"$1", '-$1 vs -"$1" with big int';

$a = "%apples";
chop($au = "%apples\x{100}");
is(-$au, -$a, 'utf8 flag makes no difference for string negation');
is -"\x{100}", 0, '-(non-ASCII) is equivalent to -(punct)';

sub TIESCALAR { bless[] }
sub STORE { $_[0][0] = $_[1] }
sub FETCH { $_[0][0] }

tie $t, "";
$a = "97656250000000000";
() = 0+$a;
$t = $a;
is -$t, -97656250000000000, 'magic str+int dualvar';

{ # Repeat most of the tests under use integer
    use integer;
    is(- 10, -10, "Simple numeric negation to negative");
    is(- -10, 10, "Simple numeric negation to positive");
    is(-"10", -10, "Negation of a positive string to negative");
    is(-"10.0", -10, "Negation of a positive decimal sting to negative");
    is(-"10foo", -10,
        "Negation of a numeric-lead string returns negation of numeric");
    is(-"-10", 10,
        'Negation of string starting with "-" returns a positive number -'
       .' integer');
    "-10" =~ /(.*)/;
    is(-$1, 10, 'Negation of magical string starting with "-" - integer');
    is(-"-10.0", 10,
        'Negation of string starting with "-" returns a positive number - '
       .'decimal');
    "-10.0" =~ /(.*)/;
    is(-$1, 10, 'Negation of magical string starting with "-" - decimal');
    is(-"-10foo", "+10foo",
       'Negation of string starting with "-" returns a string starting '
      .'with "+" - non-numeric');
    is(-"xyz", "-xyz",
       'Negation of a negative string adds "-" to the front');
    is(-"-xyz", "+xyz", "Negation of a negative string to positive");
    is(-"+xyz", "-xyz", "Negation of a positive string to negative");
    is(-bareword, "-bareword",
        "Negation of bareword treated like a string");
    is(- -bareword, "+bareword",
        "Negation of -bareword returns string +bareword");
    is(-" -10", 10, "Negation of a whitespace-lead numeric string");
    is(-" -10.0", 10, "Negation of a whitespace-lead decimal string");
    is(-" -10foo", 10,
        "Negation of a whitespace-lead sting starting with a numeric");

    $x = "dogs";
    ()=0+$x;
    is -$x, '-dogs',
        'cached numeric value does not sabotage string negation';

    $a = "%apples";
    chop($au = "%apples\x{100}");
    is(-$au, -$a, 'utf8 flag makes no difference for string negation');
    is -"\x{100}", 0, '-(non-ASCII) is equivalent to -(punct)';
}

# [perl #120288] use integer should not stop barewords from being quoted
{
    use strict;
    use integer;
    is eval "return -a"||$@@, "-a", '-bareword under strict+integer';
}
@


