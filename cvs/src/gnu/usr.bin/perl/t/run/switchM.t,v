head	1.2;
access;
symbols
	PERL_5_24_2:1.1.1.3
	OPENBSD_6_1:1.2.0.4
	OPENBSD_6_1_BASE:1.2
	OPENBSD_6_0:1.1.1.2.0.10
	OPENBSD_6_0_BASE:1.1.1.2
	OPENBSD_5_9:1.1.1.2.0.4
	OPENBSD_5_9_BASE:1.1.1.2
	OPENBSD_5_8:1.1.1.2.0.6
	OPENBSD_5_8_BASE:1.1.1.2
	PERL_5_20_2:1.1.1.2
	OPENBSD_5_7:1.1.1.2.0.2
	OPENBSD_5_7_BASE:1.1.1.2
	PERL_5_20_1:1.1.1.2
	OPENBSD_5_6:1.1.1.1.0.4
	OPENBSD_5_6_BASE:1.1.1.1
	PERL_5_18_2:1.1.1.1
	PERL:1.1.1;
locks; strict;
comment	@# @;
expand	@b@;


1.2
date	2017.02.05.00.32.21;	author afresh1;	state Exp;
branches;
next	1.1;
commitid	cxJ08BvJA9Pt2PTM;

1.1
date	2014.03.24.14.59.11;	author afresh1;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2014.03.24.14.59.11;	author afresh1;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	2014.11.17.20.53.19;	author afresh1;	state Exp;
branches;
next	1.1.1.3;
commitid	B31cAbBIXiCqnL97;

1.1.1.3
date	2017.08.14.13.46.25;	author afresh1;	state Exp;
branches;
next	;
commitid	fAzrs78vdW2Yfc6A;


desc
@@


1.2
log
@Fix merge issues, remove excess files - match perl-5.24.1 dist
@
text
@#!./perl

BEGIN {
    chdir 't' if -d 't';
    @@INC = '../lib';
    require Config;
    import Config;

}
use strict;

require './test.pl';

plan(4);

like(runperl(switches => ['-Irun/flib', '-Mbroken'], stderr => 1),
     qr/^Global symbol "\$x" requires explicit package name \(did you (?x:
        )forget to declare "my \$x"\?\) at run\/flib\/broken.pm line 6\./,
     "Ensure -Irun/flib produces correct filename in warnings");

like(runperl(switches => ['-Irun/flib/', '-Mbroken'], stderr => 1),
     qr/^Global symbol "\$x" requires explicit package name \(did you (?x:
        )forget to declare "my \$x"\?\) at run\/flib\/broken.pm line 6\./,
     "Ensure -Irun/flib/ produces correct filename in warnings");

SKIP: {
    my $no_pmc;
    foreach(Config::non_bincompat_options()) {
	if($_ eq "PERL_DISABLE_PMC"){
	    $no_pmc = 1;
	    last;
	}
    }

    if ( $no_pmc ) {
        skip('Tests fail without PMC support', 2);
    }

    like(runperl(switches => ['-Irun/flib', '-Mt2'], prog => 'print t2::id()', stderr => 1),
         qr/^t2pmc$/,
         "Ensure -Irun/flib loads pmc");

    like(runperl(switches => ['-Irun/flib/', '-Mt2'], prog => 'print t2::id()', stderr => 1),
         qr/^t2pmc$/,
         "Ensure -Irun/flib/ loads pmc");
}
@


1.1
log
@Initial revision
@
text
@d6 3
d14 1
a14 1
plan(2);
d17 2
a18 1
     qr/^Global symbol "\$x" requires explicit package name at run\/flib\/broken.pm line 6\./,
d22 2
a23 1
     qr/^Global symbol "\$x" requires explicit package name at run\/flib\/broken.pm line 6\./,
d25 22
@


1.1.1.1
log
@Import perl-5.18.2

OK espie@@ sthen@@ deraadt@@
@
text
@@


1.1.1.2
log
@Import perl-5.20.1
@
text
@a5 3
    require Config;
    import Config;

d11 1
a11 1
plan(4);
a19 14

SKIP: {
    if ( $Config{ccflags} =~ /(?:^|\s)-DPERL_DISABLE_PMC\b/ ) {
        skip('Tests fail without PMC support', 2);
    }

    like(runperl(switches => ['-Irun/flib', '-Mt2'], prog => 'print t2::id()', stderr => 1),
         qr/^t2pmc$/,
         "Ensure -Irun/flib loads pmc");

    like(runperl(switches => ['-Irun/flib/', '-Mt2'], prog => 'print t2::id()', stderr => 1),
         qr/^t2pmc$/,
         "Ensure -Irun/flib/ loads pmc");
}
@


1.1.1.3
log
@Import perl-5.24.2
@
text
@d17 1
a17 2
     qr/^Global symbol "\$x" requires explicit package name \(did you (?x:
        )forget to declare "my \$x"\?\) at run\/flib\/broken.pm line 6\./,
d21 1
a21 2
     qr/^Global symbol "\$x" requires explicit package name \(did you (?x:
        )forget to declare "my \$x"\?\) at run\/flib\/broken.pm line 6\./,
d25 1
a25 9
    my $no_pmc;
    foreach(Config::non_bincompat_options()) {
	if($_ eq "PERL_DISABLE_PMC"){
	    $no_pmc = 1;
	    last;
	}
    }

    if ( $no_pmc ) {
@


