head	1.2;
access;
symbols
	OPENBSD_6_2_BASE:1.2
	PERL_5_24_2:1.1.1.2
	OPENBSD_6_1:1.2.0.4
	OPENBSD_6_1_BASE:1.2
	OPENBSD_6_0:1.1.1.1.0.16
	OPENBSD_6_0_BASE:1.1.1.1
	OPENBSD_5_9:1.1.1.1.0.10
	OPENBSD_5_9_BASE:1.1.1.1
	OPENBSD_5_8:1.1.1.1.0.12
	OPENBSD_5_8_BASE:1.1.1.1
	PERL_5_20_2:1.1.1.1
	OPENBSD_5_7:1.1.1.1.0.4
	OPENBSD_5_7_BASE:1.1.1.1
	PERL_5_20_1:1.1.1.1
	OPENBSD_5_6:1.1.1.1.0.8
	OPENBSD_5_6_BASE:1.1.1.1
	PERL_5_18_2:1.1.1.1
	PERL:1.1.1
	OPENBSD_5_5:1.1.1.1.0.6
	OPENBSD_5_5_BASE:1.1.1.1
	OPENBSD_5_4:1.1.1.1.0.2
	OPENBSD_5_4_BASE:1.1.1.1
	PERL_5_16_3:1.1.1.1
	CPAN:1.1.1;
locks; strict;
comment	@# @;
expand	@o@;


1.2
date	2017.02.05.00.32.03;	author afresh1;	state Exp;
branches;
next	1.1;
commitid	cxJ08BvJA9Pt2PTM;

1.1
date	2013.03.25.20.08.06;	author sthen;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2013.03.25.20.08.06;	author sthen;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	2017.08.14.13.46.01;	author afresh1;	state Exp;
branches;
next	;
commitid	fAzrs78vdW2Yfc6A;


desc
@@


1.2
log
@Fix merge issues, remove excess files - match perl-5.24.1 dist
@
text
@use Test::More;
use strict;
use warnings;

{
package Local::ToMan;
use parent 'Pod::Perldoc::ToMan';
use vars qw( $stty_text $is_linux $warning );
no warnings 'redefine';
no strict 'refs';
sub _get_stty { $stty_text }
sub is_linux { $is_linux }
sub warn { shift; $warning = join '', @@_ }
}

BEGIN {
our @@columns = qw( EXPECTED IS_LINUX MANWIDTH MANWIDTH_EXPECTED STTY STTY_EXPECTED );
foreach my $i ( 0 .. $#columns ) {
	no strict 'refs';
	*{"$columns[$i]"} = sub () { $i };
	}
}

my @@tests = (
    # for linux, choose between manwidth and stty
	[ 62, 1, undef,  0, "; 62 columns;", 62 ],
	[ 63, 1, undef,  0, "columns 63",    63 ],	
	[ 57, 1, 57,    57, "columns 63",    63 ],
	[ 73, 1, undef,  0, " ",              0 ],

    # for not linux, the same
	[ 62, 0, undef,  0, "; 62 columns;", 62 ],
	[ 63, 0, undef,  0, "columns 63",    63 ],	
	[ 57, 0, 57,    57, "columns 63",    63 ],
	[ 73, 0, undef,  0, " ",              0 ],

	# bad manwidths	
	[ 62, 1, -1,     0, "; 62 columns;", 62 ],
	[ 63, 1, 'abc',  0, "columns 63",    63 ],	
	[ 64, 1, '',     0, "columns 64",    64 ],
	[ 73, 1, undef,  0, " ",              0 ],
	);

plan tests => 3 * @@tests;


foreach my $test ( @@tests ) {
	local $ENV{MANWIDTH}               = $test->[MANWIDTH];
	local $Local::ToMan::stty_text     = $test->[STTY];
	local $Local::ToMan::is_linux      = $test->[IS_LINUX];

	{
	no warnings 'uninitialized';
	diag( sprintf 
		"MANWIDTH: %s STTY: %s LINUX: %s",
		defined $ENV{MANWIDTH} ? $ENV{MANWIDTH} : "(undef)",
		$Local::ToMan::stty_text,
		$Local::ToMan::is_linux,
		) if $ENV{PERLDOCDEBUG};
	}

	is( Local::ToMan->_get_columns_from_manwidth(), $test->[MANWIDTH_EXPECTED],
		"_get_columns_from_manwidth returns the right number" );
	is( Local::ToMan->_get_columns_from_stty(),     $test->[STTY_EXPECTED],
	    "_get_columns_from_stty returns the right number" );
	is( Local::ToMan->_get_columns,                 $test->[EXPECTED],
	    "_get_columns returns the right number" );
	}
@


1.1
log
@Initial revision
@
text
@d7 1
a7 1
use base 'Pod::Perldoc::ToMan';
@


1.1.1.1
log
@import perl 5.16.3 from CPAN - worked on by Andrew Fresh and myself
@
text
@@


1.1.1.2
log
@Import perl-5.24.2
@
text
@d7 1
a7 1
use parent 'Pod::Perldoc::ToMan';
@

