head	1.17;
access;
symbols
	OPENBSD_6_1:1.16.0.26
	OPENBSD_6_1_BASE:1.16
	OPENBSD_6_0:1.16.0.24
	OPENBSD_6_0_BASE:1.16
	OPENBSD_5_9:1.16.0.18
	OPENBSD_5_9_BASE:1.16
	OPENBSD_5_8:1.16.0.20
	OPENBSD_5_8_BASE:1.16
	OPENBSD_5_7:1.16.0.12
	OPENBSD_5_7_BASE:1.16
	OPENBSD_5_6:1.16.0.16
	OPENBSD_5_6_BASE:1.16
	OPENBSD_5_5:1.16.0.14
	OPENBSD_5_5_BASE:1.16
	OPENBSD_5_4:1.16.0.10
	OPENBSD_5_4_BASE:1.16
	OPENBSD_5_3:1.16.0.8
	OPENBSD_5_3_BASE:1.16
	OPENBSD_5_2:1.16.0.6
	OPENBSD_5_2_BASE:1.16
	OPENBSD_5_1_BASE:1.16
	OPENBSD_5_1:1.16.0.4
	OPENBSD_5_0:1.16.0.2
	OPENBSD_5_0_BASE:1.16
	OPENBSD_4_9:1.14.0.2
	OPENBSD_4_9_BASE:1.14
	OPENBSD_4_8:1.12.0.6
	OPENBSD_4_8_BASE:1.12
	OPENBSD_4_7:1.12.0.2
	OPENBSD_4_7_BASE:1.12
	OPENBSD_4_6:1.12.0.4
	OPENBSD_4_6_BASE:1.12
	OPENBSD_4_5:1.10.0.4
	OPENBSD_4_5_BASE:1.10
	OPENBSD_4_4:1.10.0.2
	OPENBSD_4_4_BASE:1.10
	OPENBSD_4_3:1.9.0.6
	OPENBSD_4_3_BASE:1.9
	OPENBSD_4_2:1.9.0.4
	OPENBSD_4_2_BASE:1.9
	OPENBSD_4_1:1.9.0.2
	OPENBSD_4_1_BASE:1.9
	OPENBSD_4_0:1.8.0.2
	OPENBSD_4_0_BASE:1.8
	OPENBSD_3_9:1.7.0.14
	OPENBSD_3_9_BASE:1.7
	OPENBSD_3_8:1.7.0.12
	OPENBSD_3_8_BASE:1.7
	OPENBSD_3_7:1.7.0.10
	OPENBSD_3_7_BASE:1.7
	OPENBSD_3_6:1.7.0.8
	OPENBSD_3_6_BASE:1.7
	OPENBSD_3_5:1.7.0.6
	OPENBSD_3_5_BASE:1.7
	OPENBSD_3_4:1.7.0.4
	OPENBSD_3_4_BASE:1.7
	OPENBSD_3_3:1.7.0.2
	OPENBSD_3_3_BASE:1.7
	OPENBSD_3_2:1.6.0.2
	OPENBSD_3_2_BASE:1.6
	OPENBSD_3_1:1.2.0.4
	OPENBSD_3_1_BASE:1.2
	OPENBSD_3_0:1.2.0.2
	OPENBSD_3_0_BASE:1.2;
locks; strict;
comment	@# @;


1.17
date	2017.04.04.00.03.12;	author deraadt;	state Exp;
branches;
next	1.16;
commitid	61pPYoYUL03WPhGd;

1.16
date	2011.07.22.09.30.54;	author espie;	state Exp;
branches;
next	1.15;

1.15
date	2011.04.15.03.11.38;	author deraadt;	state Exp;
branches;
next	1.14;

1.14
date	2011.01.14.17.18.50;	author deraadt;	state Exp;
branches;
next	1.13;

1.13
date	2010.08.17.19.17.14;	author deraadt;	state Exp;
branches;
next	1.12;

1.12
date	2009.04.21.09.12.27;	author deraadt;	state Exp;
branches;
next	1.11;

1.11
date	2009.04.17.03.58.54;	author deraadt;	state Exp;
branches;
next	1.10;

1.10
date	2008.04.25.04.04.15;	author deraadt;	state Exp;
branches;
next	1.9;

1.9
date	2007.01.29.21.28.33;	author martin;	state Exp;
branches;
next	1.8;

1.8
date	2006.07.27.02.53.55;	author deraadt;	state Exp;
branches;
next	1.7;

1.7
date	2003.03.24.18.57.21;	author drahn;	state Exp;
branches;
next	1.6;

1.6
date	2002.06.27.15.02.12;	author drahn;	state Exp;
branches;
next	1.5;

1.5
date	2002.06.09.06.15.14;	author todd;	state Exp;
branches;
next	1.4;

1.4
date	2002.05.13.07.22.43;	author espie;	state Exp;
branches;
next	1.3;

1.3
date	2002.04.22.01.50.51;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	2001.10.03.17.11.32;	author drahn;	state Exp;
branches;
next	1.1;

1.1
date	2001.09.01.16.13.48;	author drahn;	state Exp;
branches;
next	;


desc
@@


1.17
log
@cp -p the bootblocks to RELEASEDIR; ok tb
@
text
@#	$OpenBSD: Makefile.inc,v 1.16 2011/07/22 09:30:54 espie Exp $

KERNELS += GENERIC.MP bsd.mp

bootblocks:
	cp -p ${DESTDIR}/usr/mdec/ofwboot ${RELEASEDIR}/ofwboot
	cp -p ${DESTDIR}/usr/mdec/bsd.tbxi ${RELEASEDIR}/bsd.tbxi
	cp -p ${DESTDIR}/usr/mdec/boot.mac ${RELEASEDIR}/boot.mac

MDEXT=	bsd.rd cd${OSrev}.iso ofwboot bsd.tbxi boot.mac
@


1.16
log
@unify kernel building on various platforms.
feedback from miod@@ and deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.15 2011/04/15 03:11:38 deraadt Exp $
d6 3
a8 3
	cp ${DESTDIR}/usr/mdec/ofwboot ${RELEASEDIR}/ofwboot
	cp ${DESTDIR}/usr/mdec/bsd.tbxi ${RELEASEDIR}/bsd.tbxi
	cp ${DESTDIR}/usr/mdec/boot.mac ${RELEASEDIR}/boot.mac
@


1.15
log
@No need to make depend kernels
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.14 2011/01/14 17:18:50 deraadt Exp $
d3 1
a3 15
kernels: bsd bsd.mp bootblocks
	cp ${.CURDIR}/../sys/arch/macppc/compile/GENERIC/bsd \
	    ${RELEASEDIR}/bsd
	cp ${.CURDIR}/../sys/arch/macppc/compile/GENERIC.MP/bsd \
	    ${RELEASEDIR}/bsd.mp

bsd:
	cd ${.CURDIR}/../sys/arch/macppc/conf && config GENERIC
	cd ${.CURDIR}/../sys/arch/macppc/compile/GENERIC && \
	    ${MAKE} clean && exec ${MAKE}

bsd.mp:
	cd ${.CURDIR}/../sys/arch/macppc/conf && config GENERIC.MP
	cd ${.CURDIR}/../sys/arch/macppc/compile/GENERIC.MP && \
	    ${MAKE} clean && exec ${MAKE}
d10 1
a10 5
MDEXT=	bsd bsd.mp bsd.rd cd${OSrev}.iso \
	ofwboot bsd.tbxi boot.mac

.PHONY: bsd bsd.mp bootblocks

@


1.14
log
@We should not sum the install*.iso file, since it is not created at build
time.  We've been summing the one from the previous build (then additional
goo I run has been cleaning it up..)
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.13 2010/08/17 19:17:14 deraadt Exp $
d12 1
a12 1
	    ${MAKE} clean && ${MAKE} depend && exec ${MAKE}
d17 1
a17 1
	    ${MAKE} clean && ${MAKE} depend && exec ${MAKE}
@


1.13
log
@MDEXT missed some files (result was they are not listed in the build-time
SHA256 file).  Issue spotted by claudio.
ok miod
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.12 2009/04/21 09:12:27 deraadt Exp $
d24 1
a24 1
MDEXT=	bsd bsd.mp bsd.rd cd${OSrev}.iso install${OSrev}.iso \
@


1.12
log
@move bsd and bsd.rd and all such other MD "sets" into the MD files,
since we perhaps cannot assume that is what kernels will be in the
pathetically stupid world that SGI created
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.11 2009/04/17 03:58:54 deraadt Exp $
d24 1
a24 1
MDEXT=	bsd bsd.mp bsd.rd cd${OSrev}.iso \
@


1.11
log
@For SHA256 hashes to be ready to go onto the install media, we must
build the sets before we build the media.  While there we can get rid
of DESTDIR/snapshot too, and simply install straight into RELEASEDIR.
(This also ends up saving an astounding amount of traffic/latency in a nfs
environment)
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.10 2008/04/25 04:04:15 deraadt Exp $
d24 1
a24 1
MDEXT=	bsd.mp cd${OSrev}.iso \
@


1.10
log
@express hope
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.9 2007/01/29 21:28:33 martin Exp $
d3 1
a3 2
.ifdef DESTDIR
snap_md: bsd bsd.mp bootblocks distrib gzip_bsd.rd
d5 1
a5 1
	    ${DESTDIR}/snapshot/bsd
d7 1
a7 1
	    ${DESTDIR}/snapshot/bsd.mp
d20 3
a22 3
	cp ${DESTDIR}/usr/mdec/ofwboot ${DESTDIR}/snapshot/ofwboot
	cp ${DESTDIR}/usr/mdec/bsd.tbxi ${DESTDIR}/snapshot/bsd.tbxi
	cp ${DESTDIR}/usr/mdec/boot.mac ${DESTDIR}/snapshot/boot.mac
d24 2
a25 3
gzip_bsd.rd:
	gzip -9 ${DESTDIR}/snapshot/bsd.rd
	mv ${DESTDIR}/snapshot/bsd.rd.gz ${DESTDIR}/snapshot/bsd.rd
d27 1
a27 1
.PHONY: bootblocks bsd gzip_bsd.rd
a28 1
.endif	# DESTDIR check
@


1.9
log
@put boot.mac into snapshots, needed for booting old-world macs

ok drahn@@ gwk@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.8 2006/07/27 02:53:55 deraadt Exp $
d4 1
a4 1
snap_md: bsd bootblocks distrib gzip_bsd.rd
d7 2
d13 5
@


1.8
log
@unify these damnit!
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.7 2003/03/24 18:57:21 drahn Exp $
d16 1
@


1.7
log
@Remove unused boot.fs file from macppc distrib. ok miod@@ deraadt@@
@
text
@d1 1
a1 2
#	$OpenBSD: Makefile.inc,v 1.6 2002/06/27 15:02:12 drahn Exp $
#	etc.macppc/Makefile.inc -- macppc-specific etc Makefile targets
d4 1
a4 1
snap_md: bsd distrib1
d13 1
a13 2
# knows about bsd.rd
distrib1:
d16 2
a17 1
	${MAKE} distrib
d21 1
a21 1
.PHONY: bsd distrib1
@


1.6
log
@Use mkhybrid, mkisofs is no longer installed.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.5 2002/06/09 06:15:14 todd Exp $
a18 8
	mkdir ${DESTDIR}/snapshot/boot
	cp ${DESTDIR}/snapshot/bsd.rd ${DESTDIR}/snapshot/boot/bsd.rd
	strip ${DESTDIR}/snapshot/boot/bsd.rd
	gzip -9 ${DESTDIR}/snapshot/boot/bsd.rd
	mv ${DESTDIR}/snapshot/boot/bsd.rd.gz ${DESTDIR}/snapshot/boot/bsd
	cp ${DESTDIR}/usr/mdec/ofwboot ${DESTDIR}/snapshot/boot
	mkhybrid -r ${DESTDIR}/snapshot/boot > ${DESTDIR}/snapshot/boot.fs
	rm -rf ${DESTDIR}/snapshot/boot
@


1.5
log
@rm trailing whitespace
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.4 2002/05/13 07:22:43 espie Exp $
d25 1
a25 1
	mkisofs -r ${DESTDIR}/snapshot/boot > ${DESTDIR}/snapshot/boot.fs
@


1.4
log
@move common distrib rules to main Makefile,
make -> ${MAKE}
add phony targets
remove unnecessary subshells
install kernel in a separate target from building.
some SUDO.

okay deraadt@@

(checked bootstrap on i386, should be safe elsewhere, and trivial to fix
anyways)
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.3 2002/04/22 01:50:51 deraadt Exp $
d14 1
a14 1
# knows about bsd.rd 
@


1.3
log
@minor cleanups
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.2 2001/10/03 17:11:32 drahn Exp $
d5 3
a7 1
snap_md: bsd distrib
d12 1
a12 3
	    make clean && make depend && make
	cp ${.CURDIR}/../sys/arch/macppc/compile/GENERIC/bsd \
	    ${DESTDIR}/snapshot/bsd
d15 1
a15 1
distrib:
d18 1
a18 2
	cd ${.CURDIR}/../distrib && make cleandir && \
	    make && make install
d29 2
@


1.2
log
@copy bsd.tbxi into the snapshot directory so it will be included in
the release directory.
cleanup, do not mention bsdofw.rd.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.1 2001/09/01 16:13:48 drahn Exp $
d14 1
a14 1
# knows about  bsd.rd 
d19 1
a19 1
		make && make install
a27 3
	#
	# compress the bsd.rd files but keep original naming,
	# bootloader can deal with it.
a29 1

@


1.1
log
@The "powerpc" port which has supported the newer Apple Macintosh powerpc based
is being renamed to macppc. This is to allow sharing of common code
between different powerpc base platforms.

Files moved from etc/etc.powerpc to etc/etc.macppc
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.16 2000/08/08 01:08:07 deraadt Exp $
d14 1
a14 1
# knows about  bsd.rd and bsdofw.rd
d17 1
@

