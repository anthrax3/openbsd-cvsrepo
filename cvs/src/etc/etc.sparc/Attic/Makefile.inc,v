head	1.22;
access;
symbols
	OPENBSD_6_0:1.21.0.24
	OPENBSD_6_0_BASE:1.21
	OPENBSD_5_9:1.21.0.18
	OPENBSD_5_9_BASE:1.21
	OPENBSD_5_8:1.21.0.20
	OPENBSD_5_8_BASE:1.21
	OPENBSD_5_7:1.21.0.12
	OPENBSD_5_7_BASE:1.21
	OPENBSD_5_6:1.21.0.16
	OPENBSD_5_6_BASE:1.21
	OPENBSD_5_5:1.21.0.14
	OPENBSD_5_5_BASE:1.21
	OPENBSD_5_4:1.21.0.10
	OPENBSD_5_4_BASE:1.21
	OPENBSD_5_3:1.21.0.8
	OPENBSD_5_3_BASE:1.21
	OPENBSD_5_2:1.21.0.6
	OPENBSD_5_2_BASE:1.21
	OPENBSD_5_1_BASE:1.21
	OPENBSD_5_1:1.21.0.4
	OPENBSD_5_0:1.21.0.2
	OPENBSD_5_0_BASE:1.21
	OPENBSD_4_9:1.18.0.2
	OPENBSD_4_9_BASE:1.18
	OPENBSD_4_8:1.16.0.6
	OPENBSD_4_8_BASE:1.16
	OPENBSD_4_7:1.16.0.2
	OPENBSD_4_7_BASE:1.16
	OPENBSD_4_6:1.16.0.4
	OPENBSD_4_6_BASE:1.16
	OPENBSD_4_5:1.14.0.12
	OPENBSD_4_5_BASE:1.14
	OPENBSD_4_4:1.14.0.10
	OPENBSD_4_4_BASE:1.14
	OPENBSD_4_3:1.14.0.8
	OPENBSD_4_3_BASE:1.14
	OPENBSD_4_2:1.14.0.6
	OPENBSD_4_2_BASE:1.14
	OPENBSD_4_1:1.14.0.4
	OPENBSD_4_1_BASE:1.14
	OPENBSD_4_0:1.14.0.2
	OPENBSD_4_0_BASE:1.14
	OPENBSD_3_9:1.13.0.4
	OPENBSD_3_9_BASE:1.13
	OPENBSD_3_8:1.13.0.2
	OPENBSD_3_8_BASE:1.13
	OPENBSD_3_7:1.12.0.2
	OPENBSD_3_7_BASE:1.12
	OPENBSD_3_6:1.11.0.10
	OPENBSD_3_6_BASE:1.11
	OPENBSD_3_5:1.11.0.8
	OPENBSD_3_5_BASE:1.11
	OPENBSD_3_4:1.11.0.6
	OPENBSD_3_4_BASE:1.11
	OPENBSD_3_3:1.11.0.4
	OPENBSD_3_3_BASE:1.11
	OPENBSD_3_2:1.11.0.2
	OPENBSD_3_2_BASE:1.11
	OPENBSD_3_1:1.9.0.16
	OPENBSD_3_1_BASE:1.9
	OPENBSD_3_0:1.9.0.14
	OPENBSD_3_0_BASE:1.9
	OPENBSD_2_9:1.9.0.12
	OPENBSD_2_9_BASE:1.9
	OPENBSD_2_8:1.9.0.10
	OPENBSD_2_8_BASE:1.9
	OPENBSD_2_7:1.9.0.8
	OPENBSD_2_7_BASE:1.9
	OPENBSD_2_6:1.9.0.6
	OPENBSD_2_6_BASE:1.9
	OPENBSD_2_5:1.9.0.4
	OPENBSD_2_5_BASE:1.9
	OPENBSD_2_4:1.9.0.2
	OPENBSD_2_4_BASE:1.9
	OPENBSD_2_3:1.8.0.4
	OPENBSD_2_3_BASE:1.8
	OPENBSD_2_2:1.8.0.2
	OPENBSD_2_2_BASE:1.8
	OPENBSD_2_1:1.6.0.2
	OPENBSD_2_1_BASE:1.6
	OPENBSD_2_0:1.2.0.2
	OPENBSD_2_0_BASE:1.2
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@# @;


1.22
date	2016.09.01.09.54.17;	author deraadt;	state dead;
branches;
next	1.21;
commitid	UDb5g1CK90e9N52n;

1.21
date	2011.07.22.09.30.54;	author espie;	state Exp;
branches;
next	1.20;

1.20
date	2011.06.15.21.36.50;	author miod;	state Exp;
branches;
next	1.19;

1.19
date	2011.04.15.03.11.38;	author deraadt;	state Exp;
branches;
next	1.18;

1.18
date	2011.01.14.17.18.50;	author deraadt;	state Exp;
branches;
next	1.17;

1.17
date	2010.08.17.19.17.14;	author deraadt;	state Exp;
branches;
next	1.16;

1.16
date	2009.04.21.09.12.29;	author deraadt;	state Exp;
branches;
next	1.15;

1.15
date	2009.04.17.03.58.54;	author deraadt;	state Exp;
branches;
next	1.14;

1.14
date	2006.07.27.01.58.21;	author deraadt;	state Exp;
branches;
next	1.13;

1.13
date	2005.04.28.22.28.14;	author deraadt;	state Exp;
branches;
next	1.12;

1.12
date	2004.11.29.22.09.15;	author miod;	state Exp;
branches;
next	1.11;

1.11
date	2002.05.13.07.22.43;	author espie;	state Exp;
branches;
next	1.10;

1.10
date	2002.04.26.18.57.11;	author deraadt;	state Exp;
branches;
next	1.9;

1.9
date	98.09.23.07.27.06;	author todd;	state Exp;
branches;
next	1.8;

1.8
date	97.09.21.11.50.38;	author deraadt;	state Exp;
branches;
next	1.7;

1.7
date	97.09.18.17.17.40;	author deraadt;	state Exp;
branches;
next	1.6;

1.6
date	97.05.14.22.06.41;	author deraadt;	state Exp;
branches;
next	1.5;

1.5
date	97.05.13.08.00.58;	author deraadt;	state Exp;
branches;
next	1.4;

1.4
date	97.05.01.08.56.46;	author deraadt;	state Exp;
branches;
next	1.3;

1.3
date	97.04.20.09.26.11;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	95.10.27.23.04.51;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.38.01;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.38.01;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.22
log
@remove sparc pieces
@
text
@#	$OpenBSD: Makefile.inc,v 1.21 2011/07/22 09:30:54 espie Exp $

bootblocks:
	cp ${DESTDIR}/usr/mdec/*boot* ${RELEASEDIR}
	${DESTDIR}/usr/mdec/binstall net /tmp && \
	    mv /tmp/boot.sparc.openbsd ${RELEASEDIR}/boot.net

MDEXT=	bsd.rd cd${OSrev}.iso \
	floppy${OSrev}.fs miniroot${OSrev}.fs \
	boot boot.net bootxx installboot
@


1.21
log
@unify kernel building on various platforms.
feedback from miod@@ and deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.20 2011/06/15 21:36:50 miod Exp $
@


1.20
log
@Stop providing a bsd.scsi3 kernel on sparc. If you have a system with multiple
disks and scsi id#3 as the boot device, by all means, use DUIDs to mount your
filesystems and it won't matter what sd unit number the boot disk attaches with.
@
text
@d1 1
a1 10
#	$OpenBSD: Makefile.inc,v 1.19 2011/04/15 03:11:38 deraadt Exp $

kernels: bsd bootblocks
	cp ${.CURDIR}/../sys/arch/sparc/compile/GENERIC/bsd \
	    ${RELEASEDIR}/bsd

bsd:
	cd ${.CURDIR}/../sys/arch/sparc/conf && config GENERIC
	cd ${.CURDIR}/../sys/arch/sparc/compile/GENERIC && \
	    ${MAKE} clean && exec ${MAKE}
d8 1
a8 1
MDEXT=	bsd bsd.rd cd${OSrev}.iso \
a10 2

.PHONY: bsd bootblocks
@


1.19
log
@No need to make depend kernels
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.18 2011/01/14 17:18:50 deraadt Exp $
a5 4
	s=`printf "find sd\nexit" | config -e ${RELEASEDIR}/bsd | \
	    grep scsibus | awk '{print $$1}'`; \
	    printf "add sd0\n%s\n%s\nchange %s\ny\n3\n\n\nquit\n" $$s $$s $$s | \
	    config -e -o ${RELEASEDIR}/bsd.scsi3 ${RELEASEDIR}/bsd
d17 1
a17 1
MDEXT=	bsd bsd.rd bsd.scsi3 cd${OSrev}.iso \
@


1.18
log
@We should not sum the install*.iso file, since it is not created at build
time.  We've been summing the one from the previous build (then additional
goo I run has been cleaning it up..)
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.17 2010/08/17 19:17:14 deraadt Exp $
d14 1
a14 1
	    ${MAKE} clean && ${MAKE} depend && exec ${MAKE}
@


1.17
log
@MDEXT missed some files (result was they are not listed in the build-time
SHA256 file).  Issue spotted by claudio.
ok miod
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.16 2009/04/21 09:12:29 deraadt Exp $
d21 1
a21 1
MDEXT=	bsd bsd.rd bsd.scsi3 cd${OSrev}.iso install${OSrev}.iso \
@


1.16
log
@move bsd and bsd.rd and all such other MD "sets" into the MD files,
since we perhaps cannot assume that is what kernels will be in the
pathetically stupid world that SGI created
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.15 2009/04/17 03:58:54 deraadt Exp $
d21 3
a23 1
MDEXT=	bsd bsd.rd bsd.scsi3 boot boot.net bootxx installboot
@


1.15
log
@For SHA256 hashes to be ready to go onto the install media, we must
build the sets before we build the media.  While there we can get rid
of DESTDIR/snapshot too, and simply install straight into RELEASEDIR.
(This also ends up saving an astounding amount of traffic/latency in a nfs
environment)
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.14 2006/07/27 01:58:21 deraadt Exp $
d21 1
a21 1
MDEXT=	bsd.scsi3 boot boot.net bootxx installboot
@


1.14
log
@make these more similar (few steps to that)
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.13 2005/04/28 22:28:14 deraadt Exp $
d3 1
a3 2
.ifdef DESTDIR
snap_md: bsd bootblocks distrib
d5 2
a6 2
	    ${DESTDIR}/snapshot/bsd
	s=`printf "find sd\nexit" | config -e ${DESTDIR}/snapshot/bsd | \
d9 1
a9 1
	    config -e -o ${DESTDIR}/snapshot/bsd.scsi3 ${DESTDIR}/snapshot/bsd
d17 1
a17 1
	cp ${DESTDIR}/usr/mdec/*boot* ${DESTDIR}/snapshot
d19 3
a21 1
	  mv /tmp/boot.sparc.openbsd ${DESTDIR}/snapshot/boot.net
a23 2

.endif	# DESTDIR check
@


1.13
log
@handle new config -e non-tty input case
@
text
@d1 1
a1 2
#	$OpenBSD: Makefile.inc,v 1.12 2004/11/29 22:09:15 miod Exp $
#	etc.sparc/Makefile.inc -- sparc-specific etc Makefile targets
@


1.12
log
@Save an useless use of grep while cooking bsd.scsi3

ok deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.11 2002/05/13 07:22:43 espie Exp $
d9 1
a9 1
	    awk '/ukc/ {print $$2}'`; \
@


1.11
log
@move common distrib rules to main Makefile,
make -> ${MAKE}
add phony targets
remove unnecessary subshells
install kernel in a separate target from building.
some SUDO.

okay deraadt@@

(checked bootstrap on i386, should be safe elsewhere, and trivial to fix
anyways)
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.10 2002/04/26 18:57:11 deraadt Exp $
d9 1
a9 1
	    grep "ukc>  " | awk '{print $$2}'`; \
@


1.10
log
@build release bsd.scsi3 from regular bsd file, by using config -e to
clone sd0 out of sd*.  my idea, initial hack by miod, my makefile hackery
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.9 1998/09/23 07:27:06 todd Exp $
a5 5

bsd:
	cd ${.CURDIR}/../sys/arch/sparc/conf && config GENERIC
	cd ${.CURDIR}/../sys/arch/sparc/compile/GENERIC && \
	    make clean && make depend && make
d13 5
d23 1
a23 3
distrib:
	cd ${.CURDIR}/../distrib && make cleandir && \
	    make && make install
@


1.9
log
@boot.net for sparc
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.8 1997/09/21 11:50:38 deraadt Exp $
d5 1
a5 5
snap_md: bsd bsd.scsi3 bootblocks distrib
	cp ${.CURDIR}/../sys/arch/sparc/compile/GENERIC/bsd \
	    ${DESTDIR}/snapshot/bsd
	cp ${.CURDIR}/../sys/arch/sparc/compile/GENERIC_SCSI3/bsd \
	    ${DESTDIR}/snapshot/bsd.scsi3
d11 6
a16 5

bsd.scsi3:
	cd ${.CURDIR}/../sys/arch/sparc/conf && config GENERIC_SCSI3
	cd ${.CURDIR}/../sys/arch/sparc/compile/GENERIC_SCSI3 && \
	    make clean && make depend && make
@


1.8
log
@$OpenBSD
@
text
@d1 1
a1 1
#	$OpenBSD$
d23 2
@


1.7
log
@for architectures which go into src/distrib automatically, start at the
top level there...
@
text
@d1 1
a1 1
#
a2 2
#
#	$Id: Makefile.inc,v 1.6 1997/05/14 22:06:41 deraadt Exp $
@


1.6
log
@build a bsd.rd too
@
text
@d4 1
a4 1
#	$Id: Makefile.inc,v 1.5 1997/05/13 08:00:58 deraadt Exp $
d7 1
a7 1
snap_md: bsd bsd.scsi3 floppies miniroot bootblocks ramdisk
d23 2
a24 7
floppies:
	cd ${.CURDIR}/../distrib/sparc/floppies && make cleandir && \
	    make && make install

miniroot:
	cd ${.CURDIR}/../distrib/miniroot && make cleandir && \
	    make && make install
d26 2
a27 2
ramdisk:
	cd ${.CURDIR}/../distrib/ramdisk && make cleandir && \
a28 3

bootblocks:
	cp ${DESTDIR}/usr/mdec/*boot* ${DESTDIR}/snapshot
@


1.5
log
@copy bootblocks too, tell you why later
@
text
@d4 1
a4 1
#	$Id: Makefile.inc,v 1.4 1997/05/01 08:56:46 deraadt Exp $
d7 1
a7 1
snap_md: bsd bsd.scsi3 floppies miniroot bootblocks
d29 4
@


1.4
log
@do not ship this silly old docs
@
text
@d4 1
a4 1
#	$Id: Makefile.inc,v 1.3 1997/04/20 09:26:11 deraadt Exp $
d7 1
a7 1
snap_md: bsd bsd.scsi3 floppies miniroot
d30 3
@


1.3
log
@build it all
@
text
@d4 1
a4 1
#	$Id: Makefile.inc,v 1.2 1995/10/27 23:04:51 deraadt Exp $
d7 1
a7 1
snap_md: bsd bsd.scsi3 floppies miniroot docs
a29 4

docs:
	cp ${.CURDIR}/etc.sparc/README ${DESTDIR}/snapshot/README
	cp ${.CURDIR}/etc.sparc/install.sh ${DESTDIR}/snapshot/install.sh
@


1.2
log
@kernel name is bsd
@
text
@d4 1
a4 1
#	$Id: Makefile.inc,v 1.1.1.1 1995/10/18 08:38:01 deraadt Exp $
d7 1
a7 1
snap_md: bsd bsd.scsi3 inst
d23 9
a31 1
inst:
@


1.1
log
@Initial revision
@
text
@d4 1
a4 1
#	$Id: Makefile.inc,v 1.7 1995/05/12 08:51:55 pk Exp $
d7 5
a11 5
snap_md: netbsd netbsd.scsi3 inst
	cp ${.CURDIR}/../sys/arch/sparc/compile/GENERIC/netbsd \
	    ${DESTDIR}/snapshot/netbsd
	cp ${.CURDIR}/../sys/arch/sparc/compile/GENERIC_SCSI3/netbsd \
	    ${DESTDIR}/snapshot/netbsd.scsi3
d13 1
a13 1
netbsd:
d18 1
a18 1
netbsd.scsi3:
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
