head	1.7;
access;
symbols
	OPENBSD_6_2:1.7.0.6
	OPENBSD_6_2_BASE:1.7
	OPENBSD_6_1:1.7.0.4
	OPENBSD_6_1_BASE:1.7
	OPENBSD_6_0:1.4.0.6
	OPENBSD_6_0_BASE:1.4
	OPENBSD_5_9:1.4.0.2
	OPENBSD_5_9_BASE:1.4;
locks; strict;
comment	@# @;


1.7
date	2017.03.25.16.28.25;	author reyk;	state Exp;
branches;
next	1.6;
commitid	s82EA2LBuZtftmLN;

1.6
date	2016.10.05.18.01.52;	author reyk;	state Exp;
branches;
next	1.5;
commitid	WKwjnMLluPMMmYfT;

1.5
date	2016.10.05.17.30.13;	author reyk;	state Exp;
branches;
next	1.4;
commitid	c3mC9fNmRbfUPluH;

1.4
date	2016.01.06.09.59.30;	author reyk;	state Exp;
branches;
next	1.3;
commitid	Bp5qgug0Zi6encUT;

1.3
date	2015.12.07.17.12.16;	author reyk;	state Exp;
branches;
next	1.2;
commitid	qMcVeaedIDXvynOT;

1.2
date	2015.12.07.16.40.41;	author reyk;	state Exp;
branches;
next	1.1;
commitid	bbNslPJLEBB9S5nu;

1.1
date	2015.12.07.13.58.48;	author reyk;	state Exp;
branches;
next	;
commitid	vbiT7yIXOvXDyYm3;


desc
@@


1.7
log
@Boot using BIOS from /etc/firmware/vmm-bios by default.

Instead of using the internal "vmboot", VMs will now be booted using
the external BIOS firmware in /etc/firmware/vmm-bios (which is subject
to a LGPLv3 license).  Direct booting of OpenBSD kernels or
non-default BIOS images is still supported for now using the -b/boot
option that is replacing the -k/kernel option.

As requested by Theo, vmd(8) fails if neither the default BIOS is
found nor a kernel has been specified in the VM configuration.  The
"vmm" BIOS has to be installed using fw_update(1), which will be done
automatically in most cases where the OpenBSD can fetch it after
install/upgrade.

OK mlarkin@@
@
text
@# $OpenBSD: vm.conf,v 1.6 2016/10/05 18:01:52 reyk Exp $

#
# Macros
#
sets="/var/www/htdocs/pub/OpenBSD/snapshots/amd64/"

#
# Virtual machines
#

switch "uplink" {
	# This interface will default to bridge0, but switch(4) is supported
	#interface switch0

	# Add additional members
	add em0
}

switch "local" {
	add vether0
	down
}

# OpenBSD snapshot install test
vm "openbsd.vm" {
	boot $sets "bsd.rd"

	# First disk from 'vmctl create "/home/vm/OpenBSD.img" -s 4G'
	disk "/home/vm/OpenBSD.img"

	# Second disk from OpenBSD contains the install sets
	disk $sets "install60.fs"

	# Interface will show up as tap(4) on the host and as vio(4) in the VM
	interface { switch "uplink" }
	interface { switch "local" }
}

# Another VM that is disabled on startup
vm "vm1.example.com" {
	disable
	memory 1G
	disk "/home/vm/vm1-disk.img"

	# Use a specific tap(4) interface with a hardcoded MAC address
	interface tap3 {
		lladdr 00:11:22:aa:bb:cc
		down
	}
}
@


1.6
log
@Change switch "wireless" to another example - bridging from VM to
wireless in station mode is not supported.
@
text
@d1 1
a1 1
# $OpenBSD: vm.conf,v 1.5 2016/10/05 17:30:13 reyk Exp $
d27 1
a27 2
	memory 512M
	kernel $sets "bsd.rd"
a43 1
	kernel "/bsd"
@


1.5
log
@Add support for enhanced networking configuration and virtual switches.
See vm.conf(5) for more details.

OK mlarkin@@
@
text
@d1 1
a1 1
# $OpenBSD: vm.conf,v 1.4 2016/01/06 09:59:30 reyk Exp $
d12 1
a12 1
switch "wired" {
a17 1
	down
d20 3
a22 2
switch "wireless" {
	add iwm0
d37 2
a38 2
	interface { switch "wireless" }
	interface { switch "wired" }
@


1.4
log
@This is just an example and we don't have to bump the set's version
number all the time, but let's use install59.fs as it will be the
first release that includes vmm.
@
text
@d1 1
a1 1
# $OpenBSD: vm.conf,v 1.3 2015/12/07 17:12:16 reyk Exp $
d12 13
d34 1
a34 1
	disk $sets "install59.fs"
d37 2
a38 1
	interfaces 1
a44 1
	interfaces 2
d47 6
@


1.3
log
@Previously forgot another /var in the comment
@
text
@d1 1
a1 1
# $OpenBSD: vm.conf,v 1.2 2015/12/07 16:40:41 reyk Exp $
d21 1
a21 1
	disk $sets "install58.fs"
@


1.2
log
@/var/vm is a terrible idea, the images are filled on demand, they are
not backed by blocks until used.

So I'll use /home/vm instead.

Pointed out by deraadt@@
@
text
@d1 1
a1 1
# $OpenBSD: vm.conf,v 1.1 2015/12/07 13:58:48 reyk Exp $
d17 1
a17 1
	# First disk from 'vmctl create "/var/vm/OpenBSD.img" -s 4G'
@


1.1
log
@Add initial vm.conf(5) example.  But please note that the grammar is
not fixed yet.
@
text
@d1 1
a1 1
# $OpenBSD$
d18 1
a18 1
	disk "/var/vm/OpenBSD.img"
d33 1
a33 1
	disk "/var/vm/vm1-disk.img"
@

