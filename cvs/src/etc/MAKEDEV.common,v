head	1.95;
access;
symbols
	OPENBSD_6_1:1.94.0.4
	OPENBSD_6_1_BASE:1.94
	OPENBSD_6_0:1.89.0.4
	OPENBSD_6_0_BASE:1.89
	OPENBSD_5_9:1.85.0.2
	OPENBSD_5_9_BASE:1.85
	OPENBSD_5_8:1.78.0.6
	OPENBSD_5_8_BASE:1.78
	OPENBSD_5_7:1.78.0.2
	OPENBSD_5_7_BASE:1.78
	OPENBSD_5_6:1.75.0.4
	OPENBSD_5_6_BASE:1.75
	OPENBSD_5_5:1.73.0.4
	OPENBSD_5_5_BASE:1.73
	OPENBSD_5_4:1.68.0.2
	OPENBSD_5_4_BASE:1.68
	OPENBSD_5_3:1.61.0.2
	OPENBSD_5_3_BASE:1.61
	OPENBSD_5_2:1.59.0.2
	OPENBSD_5_2_BASE:1.59
	OPENBSD_5_1_BASE:1.58
	OPENBSD_5_1:1.58.0.2
	OPENBSD_5_0:1.56.0.2
	OPENBSD_5_0_BASE:1.56
	OPENBSD_4_9:1.53.0.2
	OPENBSD_4_9_BASE:1.53
	OPENBSD_4_8:1.51.0.2
	OPENBSD_4_8_BASE:1.51
	OPENBSD_4_7:1.46.0.2
	OPENBSD_4_7_BASE:1.46
	OPENBSD_4_6:1.43.0.4
	OPENBSD_4_6_BASE:1.43
	OPENBSD_4_5:1.41.0.2
	OPENBSD_4_5_BASE:1.41
	OPENBSD_4_4:1.39.0.2
	OPENBSD_4_4_BASE:1.39
	OPENBSD_4_3:1.36.0.4
	OPENBSD_4_3_BASE:1.36
	OPENBSD_4_2:1.36.0.2
	OPENBSD_4_2_BASE:1.36
	OPENBSD_4_1:1.33.0.2
	OPENBSD_4_1_BASE:1.33
	OPENBSD_4_0:1.29.0.2
	OPENBSD_4_0_BASE:1.29
	OPENBSD_3_9:1.23.0.2
	OPENBSD_3_9_BASE:1.23
	OPENBSD_3_8:1.20.0.2
	OPENBSD_3_8_BASE:1.20
	OPENBSD_3_7:1.16.0.2
	OPENBSD_3_7_BASE:1.16
	OPENBSD_3_6:1.12.0.2
	OPENBSD_3_6_BASE:1.12
	OPENBSD_3_5:1.5.0.2
	OPENBSD_3_5_BASE:1.5;
locks; strict;
comment	@# @;


1.95
date	2017.07.21.19.15.07;	author mikeb;	state Exp;
branches;
next	1.94;
commitid	jdXmlBCzlBY74ghh;

1.94
date	2016.09.11.19.59.51;	author deraadt;	state Exp;
branches;
next	1.93;
commitid	0aq6Bbi73npPzcGi;

1.93
date	2016.09.11.03.06.31;	author deraadt;	state Exp;
branches;
next	1.92;
commitid	z5CDCcIc9a3mbShW;

1.92
date	2016.09.08.20.39.28;	author ratchov;	state Exp;
branches;
next	1.91;
commitid	5Zm7w2aE9QiIkzq3;

1.91
date	2016.09.04.15.38.59;	author naddy;	state Exp;
branches;
next	1.90;
commitid	bTdHSwWuJ3mVUZAv;

1.90
date	2016.09.02.17.06.13;	author goda;	state Exp;
branches;
next	1.89;
commitid	J1JzeTsS8K8zyH3c;

1.89
date	2016.05.26.16.29.51;	author deraadt;	state Exp;
branches;
next	1.88;
commitid	Mb7C6XnYoQIeDqBg;

1.88
date	2016.05.21.15.17.49;	author deraadt;	state Exp;
branches;
next	1.87;
commitid	5U5bqN6eZQeDJSHy;

1.87
date	2016.04.28.18.17.30;	author natano;	state Exp;
branches;
next	1.86;
commitid	yJ7nITWQGOm5qxNW;

1.86
date	2016.04.25.20.39.42;	author tedu;	state Exp;
branches;
next	1.85;
commitid	CofwhugVKIoIiTVo;

1.85
date	2016.02.05.06.29.45;	author uebayasi;	state Exp;
branches;
next	1.84;
commitid	IYIHhWidvnMxuRWr;

1.84
date	2016.01.27.09.09.28;	author reyk;	state Exp;
branches;
next	1.83;
commitid	jV6pvRaAVSTloN7E;

1.83
date	2015.12.21.22.15.53;	author sf;	state Exp;
branches;
next	1.82;
commitid	cGnF71DnMad8EDT2;

1.82
date	2015.12.09.04.11.58;	author deraadt;	state Exp;
branches;
next	1.81;
commitid	JzfkkWvh4OOC4ajk;

1.81
date	2015.11.10.21.49.18;	author sthen;	state Exp;
branches;
next	1.80;
commitid	qMNpRm5wlRIDwS5K;

1.80
date	2015.11.10.21.42.28;	author sthen;	state Exp;
branches;
next	1.79;
commitid	ypJttw6nV7wqm3ib;

1.79
date	2015.10.23.15.14.11;	author claudio;	state Exp;
branches;
next	1.78;
commitid	frFnB4auqmT4nKdF;

1.78
date	2014.12.11.19.46.15;	author tedu;	state Exp;
branches;
next	1.77;
commitid	FihaMqRXEdv4tZvv;

1.77
date	2014.10.09.04.33.50;	author tedu;	state Exp;
branches;
next	1.76;
commitid	F3oJ0CVRqZ4auEuG;

1.76
date	2014.08.20.11.23.40;	author mikeb;	state Exp;
branches;
next	1.75;
commitid	vzc4wz1s3pDevb7K;

1.75
date	2014.07.15.17.36.13;	author miod;	state Exp;
branches;
next	1.74;
commitid	XoOhjVqAE5RLFUsM;

1.74
date	2014.07.11.21.58.32;	author tedu;	state Exp;
branches;
next	1.73;
commitid	BbyGKSMEs3F3mgfk;

1.73
date	2013.11.21.11.04.44;	author kettenis;	state Exp;
branches;
next	1.72;

1.72
date	2013.11.05.16.05.30;	author deraadt;	state Exp;
branches;
next	1.71;

1.71
date	2013.09.16.08.17.02;	author dcoppa;	state Exp;
branches;
next	1.70;

1.70
date	2013.09.05.06.36.16;	author jmc;	state Exp;
branches;
next	1.69;

1.69
date	2013.08.20.14.27.24;	author ajacoutot;	state Exp;
branches;
next	1.68;

1.68
date	2013.07.06.17.33.44;	author naddy;	state Exp;
branches;
next	1.67;

1.67
date	2013.07.06.16.14.38;	author naddy;	state Exp;
branches;
next	1.66;

1.66
date	2013.06.21.21.30.38;	author syl;	state Exp;
branches;
next	1.65;

1.65
date	2013.06.15.23.09.36;	author halex;	state Exp;
branches;
next	1.64;

1.64
date	2013.06.03.16.06.42;	author tedu;	state Exp;
branches;
next	1.63;

1.63
date	2013.03.28.21.20.46;	author jmc;	state Exp;
branches;
next	1.62;

1.62
date	2013.03.15.09.10.52;	author ratchov;	state Exp;
branches;
next	1.61;

1.61
date	2013.01.30.01.59.20;	author yasuoka;	state Exp;
branches;
next	1.60;

1.60
date	2012.08.23.06.15.28;	author deraadt;	state Exp;
branches;
next	1.59;

1.59
date	2012.04.06.15.18.41;	author jsing;	state Exp;
branches;
next	1.58;

1.58
date	2011.10.22.19.31.20;	author miod;	state Exp;
branches;
next	1.57;

1.57
date	2011.10.06.20.49.25;	author deraadt;	state Exp;
branches;
next	1.56;

1.56
date	2011.07.06.18.34.20;	author miod;	state Exp;
branches;
next	1.55;

1.55
date	2011.06.26.23.28.23;	author tedu;	state Exp;
branches;
next	1.54;

1.54
date	2011.04.18.16.52.10;	author thib;	state Exp;
branches;
next	1.53;

1.53
date	2010.09.30.15.27.54;	author claudio;	state Exp;
branches;
next	1.52;

1.52
date	2010.09.30.15.26.06;	author claudio;	state Exp;
branches;
next	1.51;

1.51
date	2010.08.03.20.12.01;	author miod;	state Exp;
branches;
next	1.50;

1.50
date	2010.07.23.14.35.56;	author mglocker;	state Exp;
branches;
next	1.49;

1.49
date	2010.07.21.23.40.26;	author nicm;	state Exp;
branches;
next	1.48;

1.48
date	2010.06.14.14.07.49;	author todd;	state Exp;
branches;
next	1.47;

1.47
date	2010.06.09.16.10.24;	author todd;	state Exp;
branches;
next	1.46;

1.46
date	2009.09.23.15.39.56;	author miod;	state Exp;
branches;
next	1.45;

1.45
date	2009.08.13.15.12.36;	author deraadt;	state Exp;
branches;
next	1.44;

1.44
date	2009.07.22.17.43.16;	author ratchov;	state Exp;
branches;
next	1.43;

1.43
date	2009.06.03.14.45.39;	author jj;	state Exp;
branches;
next	1.42;

1.42
date	2009.04.05.17.49.14;	author jmc;	state Exp;
branches;
next	1.41;

1.41
date	2008.11.30.03.33.09;	author jakemsr;	state Exp;
branches;
next	1.40;

1.40
date	2008.10.10.20.15.23;	author deraadt;	state Exp;
branches;
next	1.39;

1.39
date	2008.07.14.16.22.23;	author miod;	state Exp;
branches;
next	1.38;

1.38
date	2008.06.12.22.38.14;	author todd;	state Exp;
branches;
next	1.37;

1.37
date	2008.06.10.07.12.24;	author mglocker;	state Exp;
branches;
next	1.36;

1.36
date	2007.07.23.23.21.25;	author todd;	state Exp;
branches;
next	1.35;

1.35
date	2007.05.28.22.37.14;	author todd;	state Exp;
branches;
next	1.34;

1.34
date	2007.05.18.14.05.33;	author jmc;	state Exp;
branches;
next	1.33;

1.33
date	2007.03.07.02.51.17;	author krw;	state Exp;
branches;
next	1.32;

1.32
date	2007.02.16.02.16.20;	author deraadt;	state Exp;
branches;
next	1.31;

1.31
date	2006.12.15.20.42.19;	author kettenis;	state Exp;
branches;
next	1.30;

1.30
date	2006.10.10.12.33.41;	author todd;	state Exp;
branches;
next	1.29;

1.29
date	2006.08.28.21.04.04;	author tsi;	state Exp;
branches;
next	1.28;

1.28
date	2006.06.11.10.58.57;	author mk;	state Exp;
branches;
next	1.27;

1.27
date	2006.04.16.11.34.01;	author todd;	state Exp;
branches;
next	1.26;

1.26
date	2006.04.16.02.49.52;	author todd;	state Exp;
branches;
next	1.25;

1.25
date	2006.04.15.18.19.12;	author todd;	state Exp;
branches;
next	1.24;

1.24
date	2006.04.15.18.17.11;	author todd;	state Exp;
branches;
next	1.23;

1.23
date	2005.12.27.19.02.42;	author miod;	state Exp;
branches;
next	1.22;

1.22
date	2005.12.06.20.18.56;	author pedro;	state Exp;
branches;
next	1.21;

1.21
date	2005.10.06.06.43.19;	author otto;	state Exp;
branches;
next	1.20;

1.20
date	2005.08.01.22.22.12;	author deraadt;	state Exp;
branches;
next	1.19;

1.19
date	2005.06.29.18.23.26;	author todd;	state Exp;
branches;
next	1.18;

1.18
date	2005.06.02.20.09.38;	author tholo;	state Exp;
branches;
next	1.17;

1.17
date	2005.03.29.16.40.08;	author miod;	state Exp;
branches;
next	1.16;

1.16
date	2005.03.01.13.35.59;	author otto;	state Exp;
branches;
next	1.15;

1.15
date	2005.01.28.18.56.27;	author danh;	state Exp;
branches;
next	1.14;

1.14
date	2005.01.14.22.39.11;	author miod;	state Exp;
branches;
next	1.13;

1.13
date	2005.01.10.07.53.57;	author dlg;	state Exp;
branches;
next	1.12;

1.12
date	2004.08.19.07.05.20;	author miod;	state Exp;
branches;
next	1.11;

1.11
date	2004.08.17.20.58.05;	author miod;	state Exp;
branches;
next	1.10;

1.10
date	2004.06.03.18.36.59;	author grange;	state Exp;
branches;
next	1.9;

1.9
date	2004.05.30.08.17.17;	author grange;	state Exp;
branches;
next	1.8;

1.8
date	2004.05.29.04.07.30;	author deraadt;	state Exp;
branches;
next	1.7;

1.7
date	2004.04.11.18.14.59;	author millert;	state Exp;
branches;
next	1.6;

1.6
date	2004.04.11.18.05.22;	author millert;	state Exp;
branches;
next	1.5;

1.5
date	2004.03.12.18.25.15;	author miod;	state Exp;
branches;
next	1.4;

1.4
date	2004.03.12.04.54.04;	author deraadt;	state Exp;
branches;
next	1.3;

1.3
date	2004.02.20.19.13.01;	author miod;	state Exp;
branches;
next	1.2;

1.2
date	2004.02.17.11.18.03;	author miod;	state Exp;
branches;
next	1.1;

1.1
date	2004.02.16.18.58.54;	author miod;	state Exp;
branches;
next	;


desc
@@


1.95
log
@Multiple virtualization layers may be available at the same time
reachable through different pvbus device nodes.

Suggestion and OK deraadt, OK reyk
@
text
@vers(a, {-$OpenBSD: MAKEDEV.common,v 1.94 2016/09/11 19:59:51 deraadt Exp $-})dnl
dnl
dnl Copyright (c) 2001-2006 Todd T. Fries <todd@@OpenBSD.org>
dnl
dnl Permission to use, copy, modify, and distribute this software for any
dnl purpose with or without fee is hereby granted, provided that the above
dnl copyright notice and this permission notice appear in all copies.
dnl
dnl THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
dnl WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
dnl MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
dnl ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
dnl WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
dnl ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
dnl OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
dnl
dnl Common device definitions.
dnl
dnl This file contains the MI device definitions (as well as some MD
dnl definitions not cleaned up yet...)
dnl
dnl Diversions:  (upon termination, concatenated output queues)
dnl
dnl 0 - very top
dnl 1 - descriptions of devices
dnl 2 - init of script, function definitions, etc
dnl 3 - beginning of global recursive R() function
dnl 7 - body of MAKEDEV, device creations, etc
dnl 9 - end
dnl
dnl Diversions 2, 3 and 7 are not filled when generating the manual page.
dnl
dnl HOW TO ADD A DEVICE:
dnl
dnl In this file, you must use at least two macros:
dnl
dnl  Use '__devitem(uniqueid, name-pattern, description)' to create an entry
dnl  in the description at the top of the generated MAKEDEV file:
dnl
dnl    __devitem(sca, sca*, Sugar Generic device)dnl
dnl    __devitem(cry, crypto, hardware crypto access driver)dnl
dnl
dnl  This is ultimately shown as:
dnl
dnl    #  sca*   Sugar Generic device
dnl    #  crypto hardware crypto access driver
dnl
dnl  Use '_mkdev(uniqueid, shell-pattern, {-shell-script-})dnl' to create
dnl  a shell script fragment used to 'create' the device (be sure to match
dnl  the uniqueid from above):
dnl
dnl    _mkdev(sca, sca*, {-M sca$U c major_sca_c $U
dnl           M rsca$U b major_sca_b Add($U, 128)-})dnl
dnl    _mkdev(cry, crypto, {-M crypto c major_cry_c 0-})dnl
dnl
dnl  This is ultimately expanded into:
dnl
dnl    sca*)
dnl           M sca$U c 24 $U
dnl           M sca$U b 42 $(($U+128))
dnl           ;;
dnl
dnl    crypto)
dnl           M crypto c 47 0
dnl           ;;
dnl
dnl In the MAKEDEV.md file, add a '_DEV(uniqueid, charmajor, blockmajor)'
dnl entry:
dnl
dnl   _DEV(sca, 24, 42)
dnl   _DEV(cry, 47)
dnl
dnl Final step is to use the 'target/twrget' macros to have the 'all)' target
dnl generate one or more device(s).  Usage of 'target/twrget' is:
dnl      target(target_name, device_name [, append_string ] .. )
dnl      twrget(target_name, uniqueid, device_name, [, append_string ] .. )
dnl
dnl        target_name   a unique name that later is used as an argument to
dnl                      'show_target()' (which expands all devices for a
dnl                      given 'target_name').
dnl        uniqueid      same as 'uniqueid' above
dnl        device_name   string representing the device to be mknod'ed
dnl        append_string for each append_string, `device_name' is prepended
dnl
dnl Note: 'target(a,b,c)' is equivalent to 'twrget(a,b,b,c)'
dnl
dnl
dnl For a short example:
dnl
dnl   target(all, std)dnl
dnl   target(all, sca, 0, 1, 2, 3)dnl
dnl   twrget(all, cry, crypto)dnl
dnl
dnl would expand to:
dnl
dnl   all)
dnl        R std sca0 sca1 sca2 sca3 crypto
dnl        ;;
dnl
dnl presuming '_DEV(sca, ?, ?)' and '_DEV(std)' were in the MAKEDEV.md file.
dnl
dnl
dnl Everything is 'automatically' added to 'MAKEDEV' based on whether or
dnl not the '_DEV()' entry has a corresponding _mkdev() and __devitem()
dnl entry in MAKEDEV.mi (this file).
dnl
dnl Note: be very wary of adding whitespace, carriage returns, or not
dnl finishing a macro with ')dnl' .. otherwise, extra blank lines show up
dnl in the output.
dnl
dnl TODO:
dnl
dnl make a 'disktgt' macro that automatically does:
dnl disktgt(rd, {-rd-})
dnl
dnl	target(all,rd,0)
dnl	target(ramd,rd,0)
dnl	disk_q(rd)
dnl	__devitem(rd, {-rd*-}, {-rd-})dnl
dnl
dnl  Note: not all devices are generated in 'all)' below. MAKEDEV.md contains
dnl        its own extra list.
dnl
divert(1)dnl
twrget(all, fdesc, fd)dnl
target(all, st, 0, 1)dnl
target(all, std)dnl
target(all, ra, 0, 1, 2, 3)dnl
target(all, rx, 0, 1)dnl
target(all, wd, 0, 1, 2, 3)dnl
target(all, xd, 0, 1, 2, 3)dnl
target(all, pctr)dnl
target(all, pctr0)dnl
target(all, pf)dnl
target(all, apm)dnl
target(all, acpi)dnl
twrget(all, tth, ttyh, 0, 1)dnl
target(all, ttyA, 0, 1)dnl
target(all, ttyB, 0, 1, 2, 3, 4, 5)dnl
twrget(all, attyB, ttyB, 0, 1, 2, 3, 4)dnl
twrget(all, mac_tty0, tty0, 0, 1)dnl
twrget(all, tzs, tty, a, b, c, d)dnl
twrget(all, czs, cua, a, b, c, d)dnl
target(all, ttyc, 0, 1, 2, 3, 4, 5, 6, 7)dnl
twrget(all, com, tty0, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, a, b)dnl
twrget(all, mmcl, mmclock)dnl
target(all, lpt, 0, 1, 2)dnl
twrget(all, lpt, lpa, 0, 1, 2)dnl
target(all, joy, 0, 1)dnl
twrget(all, rnd, random)dnl
target(all, uk, 0)dnl
twrget(all, vi, video, 0, 1)dnl
twrget(all, speak, speaker)dnl
target(all, asc, 0)dnl
target(all, radio, 0)dnl
target(all, tuner, 0)dnl
target(all, rmidi, 0, 1, 2, 3, 4, 5, 6, 7)dnl
target(all, uall)dnl
target(all, pci, 0, 1, 2, 3)dnl
twrget(all, wsmouse, wscons)dnl
target(all, par, 0)dnl
target(all, apci, 0)dnl
target(all, local)dnl
target(all, gpr, 0)dnl
target(all, ptm)dnl
target(all, hotplug)dnl
target(all, pppx)dnl
target(all, fuse)dnl
target(all, vmm)dnl
target(all, pvbus, 0, 1)dnl
target(all, bpf)dnl
dnl
_mkdev(all, {-all-}, {-dnl
show_target(all)dnl
-})dnl
dnl
dnl XXX some arches use ramd, others ramdisk - needs to be fixed eventually
__devitem(ramdisk, ramdisk, Ramdisk kernel devices,nothing)dnl
dnl
target(usb, usb, 0, 1, 2, 3, 4, 5, 6, 7)dnl
target(usb, uhid, 0, 1, 2, 3)dnl
target(usb, ulpt, 0, 1)dnl
target(usb, ugen, 0, 1, 2, 3, 4, 5, 6, 7)dnl
target(usb, ttyU, 0, 1, 2, 3)dnl
dnl
__devitem({-uall-}, uall, All USB devices,usb)dnl
_mkdev(uall, uall, {-dnl
show_target({-usb-})dnl
-})dnl
__devtitle(tap, Tapes)dnl
__devitem(st, {-st*-}, SCSI tape drives)dnl
_mkdev(st, st*, {-n=Mult($U, 16)
	for pre in " " n e en
	do
		M ${pre}rst$U	c major_st_c $n 660 operator
		n=Add($n, 1)
	done-})dnl
__devtitle(dis, Disks)dnl
__devitem(sd, {-sd*-}, {-SCSI disks{-,-} including flopticals-})dnl
__devitem(cd, {-cd*-}, ATAPI and SCSI CD-ROM drives)dnl
_mkdev(cd, cd*, {-dodisk2 cd $U major_cd_b major_cd_c $U 0{--}ifstep(cd)-})dnl
__devitem(fuse, fuse, Userland Filesystem, fuse 4)dnl
_mcdev(fuse, fuse, fuse, {-major_fuse_c-}, 600)dnl
__devitem(ch, {-ch*-}, SCSI media changers)dnl
_mcdev(ch, ch*, ch, {-major_ch_c-}, 660, operator)dnl
__devitem(uk, uk*, Unknown SCSI devices)dnl
_mcdev(uk, uk*, uk, {-major_uk_c-}, 640, operator)dnl
dnl XXX see ramdisk above
__devitem(ramd, ramdisk, Ramdisk kernel devices,nothing)dnl
dnl
_mkdev(ramd, ramdisk, {-dnl
show_target(ramd)dnl
-})dnl
dnl
target(ramd, std)dnl
target(ramd, bpf)dnl
twrget(ramd, com, tty0, 0, 1)dnl
target(ramd, sd, 0, 1, 2, 3, 4)dnl
target(ramd, wd, 0, 1, 2, 3, 4)dnl
target(ramd, st, 0, 1)dnl
target(ramd, cd, 0, 1)dnl
target(ramd, rd, 0)dnl
dnl
__devitem(rd, {-rd*-}, quote(rd)pseudo-disks)dnl
_mkdev(rd, rd*, {-dodisk2 rd $U major_rd_b major_rd_c $U 0{--}ifstep(rd)-})dnl
__devitem(xd, xd*, Xylogic 753/7053 disks)dnl
__devitem(xy, xy*, {-	Xylogic 450/451 disks-})dnl
__devitem(flo, {-fd*-}, {-Floppy disk drives (3 1/2"{-,-} 5 1/4")-},fd)dnl
_mkdev(flo, fd*,
{-typnam=$U${i#fd[01]*}
	case $typnam in
	0|1)	typnum=0;; # no type specified, assume A
	*A)	typnum=0; typnam=0;;
	*B)	typnum=1;;
	*C)	typnum=2;;
	*D)	typnum=3;;
	*E)	typnum=4;;
	*F)	typnum=5;;
	*G)	typnum=6;;
	*H)	typnum=7;;
	*)	echo bad type $typnam for $i; exit 1;;
	esac
	case $U in
	0|1)	blk=major_flo_b; chr=major_flo_c;;
	*)	echo bad unit $U for $i; exit 1;;
	esac
	nam=fd${typnam}
	n=Add(Mult($U, 128), Mult($typnum, 16))
	M ${nam}a	b $blk $n 640 operator
	M ${nam}b	b $blk Add($n, 1) 640 operator
	M ${nam}c	b $blk Add($n, 2) 640 operator
	M ${nam}i	b $blk Add($n, 8) 640 operator
	M r${nam}a	c $chr $n 640 operator
	M r${nam}b	c $chr Add($n, 1) 640 operator
	M r${nam}c	c $chr Add($n, 2) 640 operator
	M r${nam}i	c $chr Add($n, 8) 640 operator-}, 664)dnl
__devitem(wd, {-wd*-}, {-quote(winchester)disk drives (ST506{-,-} IDE{-,-} ESDI{-,-} RLL{-,-} ...)-})dnl
__devitem(vnd, vnd*, quote(file)pseudo-disk devices)dnl
_mkdev(vnd, vnd*, {-dodisk vnd $U major_vnd_b major_vnd_c $U 0{--}ifstep(vnd)-})dnl
__devitem(ra, ra*, {-MSCP disks-})dnl
__devitem(rx, rx*, {-RX02 floppy disks-})dnl
dnl
dnl For normal disk devices, add a disk_q entry; anything else define like
dnl the rest (such as vnd above).
dnl
disk_q({-hd-})dnl
disk_q({-ra-})dnl
disk_q({-rx-})dnl
disk_q({-sd-})dnl
disk_q({-xy-})dnl
disk_q({-xd-})dnl
disk_q({-wd-})dnl
_mkdev({-disks-}, {-undefine({-C_ase-})show_disks()undefine({-C_ase-})-},
{-case $i in
show_disks2()dnl
	esac-})dnl
__mkdev({-disks-}){--}dnl
dnl
__devtitle(cons, Console ports)dnl
__devitem(wscons, wscons, Minimal wscons devices)dnl
twrget(wscons, wscons, ttyC, cfg, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, a, b)dnl
target(wscons, wsmux)dnl
target(wscons, wskbd, 0, 1, 2, 3)dnl
target(wscons, wsmouse, 0, 1, 2, 3)dnl
_mkdev({-wscons-}, {-wscons-}, {-dnl
show_target(wscons)dnl
-})dnl
__devitem(wsdisp, ttyC-J*, wscons display devices,wsdisplay)dnl
_mkdev({-wsdisp-}, tty[C-J]*, {-U=${i##tty[C-J]}
	case $i in
	ttyC*) n=C m=expr(0*256);;
	ttyD*) n=D m=expr(1*256);;
	ttyE*) n=E m=expr(2*256);;
	ttyF*) n=F m=expr(3*256);;
	ttyG*) n=G m=expr(4*256);;
	ttyH*) n=H m=expr(5*256);;
	ttyI*) n=I m=expr(6*256);;
	ttyJ*) n=J m=expr(7*256);;
	esac
	case $U in
	[0-9a-f]) M tty$n$U c major_wsdisp_c Add(16#$U, $m) 600;;
	cfg) M tty${n}cfg c major_wsdisp_c Add(255,$m) 600;;
	*) echo bad unit $U for $i; exit 1;;
	esac-})dnl
__devitem(wskbd, wskbd*, wscons keyboards)dnl
dnl XXX wskbd[0-9]* instead of wskbd* in case this appears before
dnl XXX ``wsmux|wsmouse|wskbd'' in the final MAKEDEV.
_mkdev(wskbd, wskbd[0-9]*, {-M wskbd$U c major_wskbd_c $U 600-})dnl
__devitem(wsmux, wsmux, wscons keyboard/mouse mux devices)dnl
_mkdev(wsmux, wsmux|wsmouse|wskbd, {-M wsmouse c major_wsmux_c 0 600
	M wskbd c major_wsmux_c 1 600-})dnl
__devitem(pcons, console, PROM console)dnl
__devtitle(point, Pointing devices)dnl
__devitem(wsmouse, wsmouse*, wscons mice)dnl
dnl XXX wsmouse[0-9]* instead of wsmouse* in case this appears before
dnl XXX ``wsmux|wsmouse|wskbd'' in the final MAKEDEV.
_mkdev(wsmouse, wsmouse[0-9]*, {-M wsmouse$U c major_wsmouse_c $U 600-})dnl
__devtitle(pty, Pseudo terminals)dnl
__devitem(ptm, ptm, pty master device)dnl
_mkdev(ptm, ptm, {-M ptm c major_ptm_c 0 666-})dnl
__devitem(tty, tty*, Set of 62 slave pseudo terminals)dnl
__devitem(pty, pty*, Set of 62 master pseudo terminals)dnl
_mkdev(pty, pty*, {-if [ $U -gt 15 ]; then
		echo bad unit for pty in: $i
		continue
	fi
	set -A letters p q r s t u v w x y z P Q R S T
	set -A suffixes 0 1 2 3 4 5 6 7 8 9 a b c d e f g h i j k l m n o p q \
	    r s t u v w x y z A B C D E F G H I J K L M N O P Q R S T U V W X \
	    Y Z

	name=${letters[$U]}
	n=0
	while [ $n -lt 62 ]
	do
		nam=$name${suffixes[$n]}
		off=Mult($U, 62)
		M tty$nam c major_tty_c Add($off, $n)
		M pty$nam c major_pty_c Add($off, $n)
		n=Add($n, 1)
	done-})dnl
__devitem(dc, dc*, {-4 channel serial interface (keyboard{-,-} mouse{-,-}modem{-,-} printer)-})dnl
__devitem(drm, drm*, {-Direct Rendering Manager-})dnl
_mcdev({-drm-}, drm*, {-drm-}, {-major_drm_c-}, 600)dnl
__devtitle(prn, Printers)dnl
__devitem(lpt, lpt*, IEEE 1284 centronics printer)dnl
_mkdev(lpt, lpt*|lpa*,
{-case $i in
	lpt*) n=lpt f=0;;
	lpa*) n=lpa f=128;;
	esac
	M $n$U c major_lpt_c Add($U, $f) 600-})dnl
__devitem(lpa, lpa*, Polled printer port,lpt)dnl
__devtitle({-usb-}, USB devices)dnl
__devitem({-usb-}, usb*, Bus control devices used by usbd for attach/detach)dnl
_mkdev({-usb-}, usb*, {-[ "$i" = "usb" ] && u= || u=$U
	M usb$u c major_usb_c $U 660-})dnl
__devitem(uhid, uhid*, Generic HID devices)dnl
_mcdev({-uhid-}, uhid*, {-uhid-}, {-major_uhid_c-}, 660)dnl
__devitem(ulpt, ulpt*, Printer devices)dnl
_mcdev({-ulpt-}, ulpt*, {-ulpt-}, {-major_ulpt_c-}, 660)dnl
__devitem(ttyU, ttyU*, USB serial ports,ucom)dnl
_mkdev({-ttyU-}, {-ttyU[0-9a-zA-Z]-}, {-U=${i#ttyU*}
	o=$(alph2d $U)
	M ttyU$U c major_ttyU_c $o 660 dialer root
	M cuaU$U c major_ttyU_c Add($o, 128) 660 dialer root-})dnl
__devitem(ugen, ugen*, Generic USB devices)dnl
_mkdev(ugen, ugen*, {-n=Mult($U, 16)
	for j in 0{0,1,2,3,4,5,6,7,8,9} 1{0,1,2,3,4,5}
	do
		M ugen$U.$j c major_ugen_c Add($n, 10#$j) 660
	done-})dnl
__devtitle(call, Call units)dnl
__devtitle(term, Terminal ports)dnl
__devitem(dca, dca*, HP200/300 single port serial interface)dnl
__devitem(dcm, dcm*, HP200/300 4 port serial mux interface)dnl
__devitem(apci, apci*, HP400 4 port serial mux interface)dnl
__devitem({-com-}, {-tty[0-7][0-9a-f]-}, NS16x50 serial ports)dnl
_mkdev(com, {-tty[0-7][0-9a-f]-}, {-U=${i#tty*}
	o=$(h2d $U)
	M tty$U c major_com_c $o 660 dialer root
	M cua$U c major_com_c Add($o, 128) 660 dialer root-})dnl
__devitem(ttyc, ttyc*, Cyclades serial ports,cy)dnl
__devitem(ttyVI, ttyVI*, Virtio serial ports,viocon)dnl
_mkdev(ttyVI, ttyVI*, {-M ttyVI$U c major_ttyVI_c $U 660 dialer root-})dnl
__devitem(tzs, tty[a-z]*, Zilog 8530 Serial Port,zs)dnl
_mkdev(tzs, {-tty[a-z]-}, {-u=${i#tty*}
	case $u in
	a) n=0 ;;
	b) n=1 ;;
	c) n=4 ;;
	d) n=5 ;;
	*) echo unknown tty device $i ;;
	esac
	M tty$u c major_tzs_c $n 660 dialer root-})dnl
__devitem(tth, ttyh*, Sab82532 serial devices,sab)dnl
_mkdev(tth, ttyh*, {-M ttyh$U c major_tth_c $U 660 dialer root-})dnl
__devitem(czs, cua[a-z]*, Zilog 8530 Serial Port,zs)dnl
_mkdev(czs, cua[a-z], {-u=${i#cua*}
	case $u in
	a) n=0 ;;
	b) n=1 ;;
	c) n=4 ;;
	d) n=5 ;;
	*) echo unknown cua device $i ;;
	esac
	M cua$u c major_czs_c Add($n, 128) 660 dialer root-})dnl
__devitem(tty0, tty00, Standard serial port,com)dnl
__devitem(mac_tty0, tty00, Standard serial port,zsc)dnl
__devitem(ttyz, tty[a-d], On-board zs serial ports,zs)dnl
__devitem(cuaz, cua[a-d], On-board zs serial ports,zs)dnl
__devitem(ttyB, ttyB?, DEC 3000 ZS8530 ("scc") serial ports,scc)dnl
__devitem(scc, scc*, 82530 serial interface,scc)dnl
__devtitle(spec, Special purpose devices)dnl
_mkdev(apm, apm*, {-M apm	c major_apm_c 0 644
	M apmctl	c major_apm_c 8 644-})dnl
_mkdev(acpi, acpi*, {-M acpi	c major_acpi_c 0 644-})dnl
__devitem(pctr, pctr*, PC Performance Tuning Register access device)dnl
_mkdev(pctr, pctr, {-M pctr c major_pctr_c 0 644-})dnl
__devitem(au, audio*, Audio devices,audio)dnl
_mkdev(au, audio*, {-M audio$U	c major_au_c $U
	M mixer$U	c major_au_c Add($U, 16)
	M audioctl$U	c major_au_c Add($U, 192)
	MKlist[${#MKlist[*]}]=";[ -e audio ] || ln -s audio$U audio"
	MKlist[${#MKlist[*]}]=";[ -e mixer ] || ln -s mixer$U mixer"
	MKlist[${#MKlist[*]}]=";[ -e audioctl ] || ln -s audioctl$U audioctl"-})dnl
__devitem(vi, video*, Video V4L2 devices,video)dnl
_mkdev(vi, video*, {-M video$U  c major_vi_c $U 600
	MKlist[${#MKlist[*]}]=";[ -e video ] || ln -s video$U video"-})dnl
__devitem(asc, asc*, ASC Audio device)dnl
_mkdev(asc, asc*, {-M asc$U major_asc_c 0-})dnl
__devitem(bio, bio, {-ioctl tunnel pseudo-device-})dnl
_mkdev(bio, bio, {-M bio c major_bio_c 0 600-})dnl
__devitem(radio, radio*, FM tuner devices)dnl
_mkdev(radio, radio*, {-M radio$U	c major_radio_c $U
	MKlist[${#MKlist[*]}]=";[ -e radio ] || ln -s radio$U radio"-})dnl
__devitem(fdesc, fd, fd/* nodes, fd)dnl
_mkdev(fdesc, fd, {-RMlist[${#RMlist[*]}]=";mkdir -p fd;rm -f" n=0
	while [ $n -lt 64 ];do M fd/$n c major_fdesc_c $n;n=Add($n, 1);done
	MKlist[${#MKlist[*]}]=";chmod 555 fd"-})dnl
__devitem(oppr, openprom,PROM settings,openprom)dnl
_cdev(oppr, openprom, 70, 0)dnl
__devitem(pf, pf*, Packet Filter)dnl
_mkdev(pf, {-pf*-}, {-M pf c major_pf_c 0 600-})dnl
__devitem(bpf, bpf, Berkeley Packet Filter)dnl
_mkdev(bpf, bpf, {-M bpf c major_bpf_c 0 600
	M bpf0 c major_bpf_c 0 600-})dnl
_mkdev(tun, {-tun*-}, {-M tun$U c major_tun_c $U 600-}, 600)dnl
_mkdev(tap, {-tap*-}, {-M tap$U c major_tap_c $U 600-}, 600)dnl
_mkdev(switch, {-switch*-}, {-M switch$U c major_switch_c $U 600-}, 600)dnl
__devitem(speak, speaker, PC speaker,spkr)dnl
_mkdev(speak, speaker, {-M speaker c major_speak_c 0 600-})dnl
__devitem(tun, tun*, Network tunnel driver)dnl
__devitem(tap, tap*, Ethernet tunnel driver)dnl
__devitem(switch, switch*, Switch driver)dnl
__devitem(rnd, *random, In-kernel random data source,random)dnl
_mkdev(rnd, *random, {-n=0
	for pre in " " s u a
	do
		M ${pre}random c major_rnd_c $n 644
		n=Add($n, 1)
	done-}, 644)dnl
__devitem(joy, joy*, Joystick driver)dnl
_mcdev(joy, joy*, joy, {-major_joy_c-}, 666)dnl
__devitem(mag, magma*, Magma multiport cards,magma)dnl
__devitem(bppmag, bppmag[mno], Magma parallel port,magma)dnl
__devitem(spif, spif*, quote(spif)multiport cards)dnl
__devitem(bppsp, bpp[jkl], quote(spif)parallel port,spif)dnl
_mkdev(mag, magma*, {-case $U in
	0)	offset=0  nam=m;;
	1)	offset=16 nam=n;;
	2)	offset=32 nam=o;;
	*)	echo "bad unit for $i: $U"; exit 127;;
	esac
	offset=Mult($U, 64)
	n=0
	while [ $n -lt 16 ]
	do
		name=${nam}`hex $n`
		M tty$name c major_mag_c Add($offset, $n) 660 dialer root
		n=Add($n, 1)
	done
	M bpp${nam}0 c major_bppmag_c Add($offset, 0) 600
	M bpp${nam}1 c major_bppmag_c Add($offset, 1) 600-})dnl
_mkdev(spif, spif*, {-case $U in
	0)	offset=0  nam=j;;
	1)	offset=16 nam=k;;
	2)	offset=32 nam=l;;
	*)	echo "bad unit for $i: $U"; exit 127;;
	esac
	offset=Mult($U, 64)
	n=0
	while [ $n -lt 8 ]
	do
		name=${nam}`hex $n`
		M tty$name c major_spif_c Add($offset, $n) 660 dialer root
		n=Add($n, 1)
	done
	M bpp${nam}0 c major_bppsp_c Add($offset, 0) 600-})dnl
__devitem(bpp, bpp*, Parallel port)dnl
_mkdev(bpp, {-bpp*-}, {-M bpp$U c major_bpp_c $U 600-}, 600)dnl
__devitem(vscsi, vscsi*, Virtual SCSI controller, vscsi 4)dnl
_mcdev(vscsi, vscsi*, vscsi, {-major_vscsi_c-}, 600)dnl
__devitem(rmidi, rmidi*, Raw MIDI devices,midi)dnl
_mcdev(rmidi, rmidi*, rmidi, {-major_rmidi_c-}, 666)dnl
__devitem(diskmap, diskmap, Disk mapper, diskmap)dnl
_mkdev(diskmap, diskmap, {-M diskmap c major_diskmap_c 0 640 operator-})dnl
__devitem(pppx, pppx*, PPP Multiplexer, pppx 4)dnl
_mcdev(pppx, pppx*, pppx, {-major_pppx_c-}, 600)dnl
__devtitle(plat, Platform-specific devices)dnl
__devitem(bktr, bktr*, Video frame grabbers)dnl
_mcdev(bktr, bktr*, bktr, {-major_bktr_c-}, 644)dnl
__devitem(tuner, tuner*, Tuner devices, bktr)dnl
_mkdev(tuner, tuner*, {-M tuner$U c major_bktr_c Add(Mult($U, 2), 16) 644-}, 644)dnl
__devitem(pci, pci*, PCI bus devices)dnl
_mkdev(pci, pci*, {-M pci$U	c major_pci_c $U 600
	MKlist[${#MKlist[*]}]=";[ -h pci ] || ln -sf pci0 pci"-})dnl
__devitem(pdc, pdc, PDC device)dnl
__devitem(gpr, gpr*, GPR400 smartcard reader)dnl
_mcdev(gpr, gpr*, gpr, {-major_gpr_c-})dnl
__devitem(hotplug, hotplug, devices hot plugging)dnl
_mkdev(hotplug, hotplug, {-M hotplug c major_hotplug_c $U 400-})dnl
__devitem(ipmi, ipmi*, IPMI BMC access)dnl
_mkdev(ipmi, ipmi*, {-M ipmi$U c major_ipmi_c $U 600-})dnl
__devitem(gpio, gpio*, General Purpose Input/Output)dnl
_mcdev(gpio, gpio*, gpio, {-major_gpio_c-}, 600)dnl
__devitem(vmm, vmm, Virtual Machine Monitor)dnl
_mkdev(vmm, vmm, {-M vmm c major_vmm_c 0 600-})dnl
__devitem(pvbus, pvbus*, paravirtual device tree root)dnl
_mkdev(pvbus, {-pvbus*-}, {-M pvbus$U c major_pvbus_c $U 640-}, 640)dnl
_mkdev(local, local, {-test -s $T.local && sh $T.local-})dnl
@


1.94
log
@cua/tty nodes only need group dialer, the initial uid does not
matter much -- and "uucp" is just stupid in 2016.
ok rpe
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.93 2016/09/11 03:06:31 deraadt Exp $-})dnl
d170 1
a170 1
target(all, pvbus, 0)dnl
@


1.93
log
@extra spaces
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.92 2016/09/08 20:39:28 ratchov Exp $-})dnl
d365 2
a366 2
	M ttyU$U c major_ttyU_c $o 660 dialer uucp
	M cuaU$U c major_ttyU_c Add($o, 128) 660 dialer uucp-})dnl
d381 2
a382 2
	M tty$U c major_com_c $o 660 dialer uucp
	M cua$U c major_com_c Add($o, 128) 660 dialer uucp-})dnl
d385 1
a385 1
_mkdev(ttyVI, ttyVI*, {-M ttyVI$U c major_ttyVI_c $U 660 dialer uucp-})dnl
d395 1
a395 1
	M tty$u c major_tzs_c $n 660 dialer uucp-})dnl
d397 1
a397 1
_mkdev(tth, ttyh*, {-M ttyh$U c major_tth_c $U 660 dialer uucp-})dnl
d407 1
a407 1
	M cua$u c major_czs_c Add($n, 128) 660 dialer uucp-})dnl
d480 1
a480 1
		M tty$name c major_mag_c Add($offset, $n) 660 dialer uucp
d496 1
a496 1
		M tty$name c major_spif_c Add($offset, $n) 660 dialer uucp
@


1.92
log
@Remove /dev/sound* as they are not used and they are identical
to /dev/audio*. No port is using them (thanks to sthen@@ for checking).

ok sthen@@
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.91 2016/09/04 15:38:59 naddy Exp $-})dnl
d435 1
a435 1
_mkdev(radio, radio*, {-M radio$U     c major_radio_c $U
@


1.91
log
@Remove the tape block device nodes.
While here, also remove two forgotten descriptions for long obsolete
devices.
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.90 2016/09/02 17:06:13 goda Exp $-})dnl
d421 1
a421 1
_mkdev(au, audio*, {-M sound$U	c major_au_c $U
a422 1
	M audio$U	c major_au_c Add($U, 128)
a425 1
	MKlist[${#MKlist[*]}]=";[ -e sound ] || ln -s sound$U sound"
@


1.90
log
@Add switch(4) cdev entry

ok deraadt@@ yasuoka@@ reyk@@
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.89 2016/05/26 16:29:51 deraadt Exp $-})dnl
a190 1
__devitem(tz, tz*, {-DEC TK50 cartridge tape drives-})dnl
a194 1
		M ${pre}st$U	b major_st_b $n 660 operator
a197 1
__devitem(mt, mt*, (Magnetic) 9-track reel tape drives)dnl
@


1.89
log
@whitespace found during review
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.88 2016/05/21 15:17:49 deraadt Exp $-})dnl
d455 1
d460 1
@


1.88
log
@Default /dev/video node to root.wheel 600 because this should not be
available wide open.  there should be some access model either via a
group or fbtab.  This will cause a decision to be made.
ok millert
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.87 2016/04/28 18:17:30 natano Exp $-})dnl
d433 1
a433 1
_mkdev(vi, video*, {-M video$U  c major_vi_c $U 600 
@


1.87
log
@Replace /dev/bpf[0-9] with /dev/bpf and /dev/bpf0. The /dev/bpf node is
unused for now, but I plan to convert all programs in base to use it in
a future diff. /dev/bpf0 is for compatibility with existing binaries
and is to be removed after a transition period.

ok rpe krw, for the installer part
"Let's see it hit the tree." deraadt
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.86 2016/04/25 20:39:42 tedu Exp $-})dnl
d433 1
a433 1
_mkdev(vi, video*, {-M video$U  c major_vi_c $U
@


1.86
log
@rm systrace
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.85 2016/02/05 06:29:45 uebayasi Exp $-})dnl
d171 1
d219 1
a219 1
target(ramd, bpf, 0)dnl
d450 3
a452 2
__devitem(bpf, bpf*, Berkeley Packet Filter)dnl
_mkdev(bpf, {-bpf*-}, {-M bpf$U c major_bpf_c $U 600-}, 600)dnl
@


1.85
log
@Add ipmi(4) cdev entry on amd64 and i386
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.84 2016/01/27 09:09:28 reyk Exp $-})dnl
a131 1
target(all, systrace)dnl
a421 2
__devitem(systrace, systrace*, System call tracing device)dnl
_mkdev(systrace, systrace, {-M systrace c major_systrace_c 0 644-})dnl
@


1.84
log
@Add /dev/pvbus0 (mode 0640) to MAKEDEV on i386 and amd64.
Needed for the key-value interface that has been added to pvbus(4).

OK mikeb@@
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.83 2015/12/21 22:15:53 sf Exp $-})dnl
d527 2
@


1.83
log
@add virtio-console driver

This patch adds a new driver for use of virtio-console devices as
ttys.  It's still in an early state and not compiled by default, yet.
Currently it is only wired into amd64. i386 is still missing.

Discussed with uebayasi@@, deraadt@@
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.82 2015/12/09 04:11:58 deraadt Exp $-})dnl
d171 1
d531 2
@


1.82
log
@vmm node only needs mode 600
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.81 2015/11/10 21:49:18 sthen Exp $-})dnl
d386 2
@


1.81
log
@remove stray { }
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.80 2015/11/10 21:42:28 sthen Exp $-})dnl
d527 1
a527 1
_mkdev(vmm, vmm, {-M vmm c major_vmm_c 0 640-})dnl
@


1.80
log
@add /dev/vmm, req'd by and ok mlarkin@@
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.79 2015/10/23 15:14:11 claudio Exp $-})dnl
d526 1
a526 1
__devitem(vmm, vmm, {Virtual Machine Monitor})dnl
@


1.79
log
@MAKEDEV bits for tap(4)
OK dlg@@ mpi@@
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.78 2014/12/11 19:46:15 tedu Exp $-})dnl
d170 1
d526 2
@


1.78
log
@remove urio
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.77 2014/10/09 04:33:50 tedu Exp $-})dnl
d451 1
d455 1
@


1.77
log
@remove lkm
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.76 2014/08/20 11:23:40 mikeb Exp $-})dnl
a178 1
target(usb, urio, 0)dnl
a367 2
__devitem(urio, urio*, Diamond Multimedia Rio 500)dnl
_mcdev({-urio-}, urio*, {-urio-}, {-major_urio_c-}, 660)dnl
@


1.76
log
@Remove userland bits related to the crypto(4) interface;  ok deraadt
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.75 2014/07/15 17:36:13 miod Exp $-})dnl
a146 1
target(all, lkm)dnl
a455 2
__devitem(lkm, lkm, Loadable kernel modules interface)dnl
_cdev(lkm, lkm, {-major_lkm_c-}, 0, 640, _lkm)dnl
@


1.75
log
@Remove ppi (hp300 leftover)
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.74 2014/07/11 21:58:32 tedu Exp $-})dnl
a135 1
twrget(all, cry, crypto)dnl
a449 2
__devitem(cry, crypto, Hardware crypto access driver,crypto)dnl
_mkdev(cry, crypto, {-M crypto c major_cry_c-} 0)dnl
@


1.74
log
@remove bluetooth bits
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.73 2013/11/21 11:04:44 kettenis Exp $-})dnl
a165 1
target(all, ppi, 0)dnl
a357 1
__devitem(ppi, ppi*, HP-IB plotters)dnl
@


1.73
log
@Change /dev/drm* permissions to 0600.

ok deraadt@@, naddy@@, ajacoutot@@
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.72 2013/11/05 16:05:30 deraadt Exp $-})dnl
a206 2
__devitem(bthub, {-bthub*-}, Bluetooth Hubs,nothing)dnl
_mcdev(bthub, bthub*, bthub, {-major_bthub_c-})dnl
@


1.72
log
@kill iop(4); spotted by jmc
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.71 2013/09/16 08:17:02 dcoppa Exp $-})dnl
d351 1
a351 1
_mcdev({-drm-}, drm*, {-drm-}, {-major_drm_c-}, 660)dnl
@


1.71
log
@Increase default number of ugen device files: two are too few for
modern standards, with people having usb cameras, music players,
smartcard readers, UPSs, wifi scanners, rocket launchers and so
on...

OK sthen@@, djm@@
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.70 2013/09/05 06:36:16 jmc Exp $-})dnl
a161 1
target(all, iop, 0, 1)dnl
a263 2
__devitem(iop, iop*, I2O controller devices)dnl
_mcdev(iop, iop*, iop, {-major_iop_c-}, 660)dnl
@


1.70
log
@no bthub(4) page;
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.69 2013/08/20 14:27:24 ajacoutot Exp $-})dnl
d186 1
a186 1
target(usb, ugen, 0, 1)dnl
@


1.69
log
@Remove uscanner(4). It was disabled in GENERIC more than 2.5 years ago.
No regression has been reported since libusb became the prefered
solution to work with USB scanners.

req. by mpi@@
ok ian@@ mpi@@ miod@@
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.68 2013/07/06 17:33:44 naddy Exp $-})dnl
d208 1
a208 1
__devitem(bthub, {-bthub*-}, Bluetooth Hubs)dnl
@


1.68
log
@create 12 com(4) device nodes by default; requested by deraadt@@
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.67 2013/07/06 16:14:38 naddy Exp $-})dnl
a183 1
twrget(usb, uscan, uscanner, 0)dnl
a379 2
__devitem(uscan, uscanner*, Scanners,uscanner)dnl
_mcdev({-uscan-}, uscanner*, {-uscanner-}, {-major_uscan_c-}, 660)dnl
@


1.67
log
@create more com(4) entries by default since puc(4)s are now guaranteed
to show up at com4 or higher on x86; ok kettenis@@ krw@@
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.66 2013/06/21 21:30:38 syl Exp $-})dnl
d147 1
a147 1
twrget(all, com, tty0, 0, 1, 2, 3, 4, 5, 6, 7)dnl
@


1.66
log
@Make fuse device clonable.

ok tedu@@
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.65 2013/06/15 23:09:36 halex Exp $-})dnl
d147 1
a147 1
twrget(all, com, tty0, 0, 1, 2, 3)dnl
@


1.65
log
@allow creation of more fuse devices, and create 4 of them by default

ok syl@@ todd@@
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.64 2013/06/03 16:06:42 tedu Exp $-})dnl
d173 1
a173 1
target(all, fuse, 0, 1, 2, 3)dnl
d211 2
a212 2
__devitem(fuse, fuse*, Userland Filesystem, fuse 4)dnl
_mcdev(fuse, fuse*, fuse, {-major_fuse_c-}, 600)dnl
@


1.64
log
@userland fuse support, but not attaching libfuse yet. ok beck deraadt
from Sylvestre Gallon ccna.syl gmail.com
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.63 2013/03/28 21:20:46 jmc Exp $-})dnl
d173 1
a173 1
target(all, fuse)dnl
d211 2
a212 2
__devitem(fuse, fuse, Userland Filesystem, fuse 4)dnl
_mcdev(fuse, fuse, fuse, {-major_fuse_c-}, 600)dnl
@


1.63
log
@vscsi(8) -> vscsi(4);
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.62 2013/03/15 09:10:52 ratchov Exp $-})dnl
d173 1
d211 2
@


1.62
log
@Delete the sequencer(4) driver, since its not used any longer. Diff
mostly from armani.
ok miod, mpi, jsg and help from sthen
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.61 2013/01/30 01:59:20 yasuoka Exp $-})dnl
d516 1
a516 1
__devitem(vscsi, vscsi*, Virtual SCSI controller, vscsi 8)dnl
@


1.61
log
@Create /dev/pppx by default.
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.60 2012/08/23 06:15:28 deraadt Exp $-})dnl
a157 1
target(all, music, 0)dnl
a448 5
__devitem(music, music*, MIDI sequencer,music)dnl
_mkdev(music, music*, {-M music$U     c major_music_c $U
	M sequencer$U c major_music_c Add($U, 128)
	MKlist[${#MKlist[*]}]=";[ -e music ] || ln -s music$U music"
	MKlist[${#MKlist[*]}]=";[ -e sequencer ] || ln -s sequencer$U sequencer"-})dnl
@


1.60
log
@get rid of the nnpfs nodes
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.59 2012/04/06 15:18:41 jsing Exp $-})dnl
d173 1
@


1.59
log
@Remove raidframe device nodes.
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.57 2011/10/06 20:49:25 deraadt Exp $-})dnl
a520 2
__devitem(nnpfs, nnpfs*, NNPFS filesystem node, mount_nnpfs 8)dnl
_mcdev(nnpfs, nnpfs*, nnpfs, {-major_nnpfs_c-}, 600)dnl
@


1.58
log
@Move the audio* device creation stanzas from MI to MD, and reduce the
number of audio* nodes from 3 to 1 on vax, since none of the audio-capable
vax can receive another audio device as expansion (until we get TURBOchannel
support with DMA on VS4k/90).
ok deraadt@@ todd@@
@
text
@a127 1
target(all, raid, 0, 1, 2, 3)dnl
a265 1
__devitem(raid, raid*, RAIDframe disk devices)dnl
a275 1
disk_q({-raid-})dnl
@


1.57
log
@ccd goes to the attic
discussed with jsing and millert
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.56 2011/07/06 18:34:20 miod Exp $-})dnl
d121 2
a122 2
dnl  Note: not all disks are generated in 'all)'. (e.g. vax has a lot of
dnl        disks that are not generated by 'all)')
a155 1
twrget(all, au, audio, 0, 1, 2)dnl
@


1.56
log
@Remove obsolete drivers descriptions; no change in generated files on all
plotfarms.
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.55 2011/06/26 23:28:23 tedu Exp $-})dnl
a267 1
__devitem(ccd, ccd*, Concatenated disk devices)dnl
a276 1
disk_q({-ccd-})dnl
@


1.55
log
@remove mcd
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.54 2011/04/18 16:52:10 thib Exp $-})dnl
a128 2
target(all, rz, 0, 1, 2, 3, 4)dnl
target(all, hp, 0, 1, 2, 3)dnl
a164 1
target(all, adb)dnl
a167 1
twrget(all, grf_mac, grf, 0, 1, 2, 3)dnl
a168 2
twrget(all, amouse, mouse, 0, 1)dnl
twrget(all, akbd, kbd)dnl
a170 1
target(all, view0, 0, 1, 2, 3, 4, 5)dnl
a205 4
__devitem(ht, ht*, MASSBUS TM03 and TU?? devices)dnl
__devitem(tm, tm*, UNIBUS TM11 and TE10 emulations (e.g. Emulex TC-11))dnl
__devitem(ts, ts*, UNIBUS TS11)dnl
__devitem(ut, ut*, UNIBUS TU45 emulations (e.g. 9700))dnl
a272 4
__devitem(hp, hp*, {-MASSBUS disks-})dnl
__devitem(hk, hk*, {-UNIBUS RK06 and RK07 disks-})dnl
__devitem(up, up*, {-Other UNIBUS devices-})dnl
__devitem(rb, rb*, {-730 IDC w/ RB80 and/or RB02-})dnl
a273 1
__devitem(rl, rl*, {-UNIBUS RL02-})dnl
a279 2
disk_q({-hk-})dnl
disk_q({-hp-})dnl
a281 2
disk_q({-rb-})dnl
disk_q({-rl-})dnl
a285 1
disk_q({-up-})dnl
a286 1
disk_q({-rz-})dnl
a466 1
__devitem(grf_mac, grf*, Raw interface to the mac68k graphics devices,grf)dnl
a544 2
__devitem(adb, adb, Apple Desktop bus event interface)dnl
_mkdev(adb, adb, {-M adb c major_adb_c 0-})dnl
@


1.54
log
@Deprecate vnds in favour of svnds.

In effect, this removes the "old" vndX nodes, and renames
the svndX nodes to vndX.

Old svndX nodes will still continue to work though, for now.

Cleanup accordingly.

ok deraadt@@, todd@@
comments and ok on the man page bits from jmc@@
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.53 2010/09/30 15:27:54 claudio Exp $-})dnl
a124 1
target(all, mcd, 0)dnl
a220 3
__devitem(mcd, mcd*, Mitsumi CD-ROM drives)dnl
_mkdev(mcd, mcd*, {-dodisk2 mcd $U major_mcd_b major_mcd_c $U 0{--}ifstep(mcd)dnl
-})dnl
@


1.53
log
@Add pppx(4) to MAKEDEV but do not create the device unless requested
explicitly. OK dlg@@ & todd@@
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.52 2010/09/30 15:26:06 claudio Exp $-})dnl
d286 1
a286 2
_mkdev(vnd, vnd*, {-dodisk vnd $U major_vnd_b major_vnd_c $U 0{--}ifstep(vnd)
	dodisk svnd $U major_vnd_b major_vnd_c $U 2048{--}ifstep(vnd)-})dnl
@


1.52
log
@Move the vscsi __devitem() so that it is before the _mcdev() line like
for all other definitions. Both dlg@@ and todd@@ wanted that to be a
seperate commit.
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.51 2010/08/03 20:12:01 miod Exp $-})dnl
d563 2
@


1.51
log
@Create two more usb device nodes by default, as modern Apple hardware
(among others) attaches *eight* uhub devices.
From remco at d-compu, dyndns org; ok deraadt@@
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.50 2010/07/23 14:35:56 mglocker Exp $-})dnl
d556 1
a557 1
_mcdev(nnpfs, nnpfs*, nnpfs, {-major_nnpfs_c-}, 600)dnl
@


1.50
log
@Create video1 by default.  Can be useful e.g. on many laptops with
integrated cams where you want to use an external cam.  Suggested by Brad.

OK todd@@, jakemsr@@
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.49 2010/07/21 23:40:26 nicm Exp $-})dnl
d191 1
a191 1
target(usb, usb, 0, 1, 2, 3, 4, 5)dnl
@


1.49
log
@Some ss(4) bits escaped the purge, eliminate them.

ok todd krw
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.48 2010/06/14 14:07:49 todd Exp $-})dnl
d160 1
a160 1
twrget(all, vi, video, 0)dnl
@


1.48
log
@to assist diskmap testing, lets make the character dev a character dev, doh!
ok jsing@@
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.47 2010/06/09 16:10:24 todd Exp $-})dnl
a230 6
__devitem(ss, ss*, SCSI scanners)dnl
_mkdev(ss, ss*, {-M ss$U c major_ss_c Mult($U,16) 640 operator
	M nss$U c major_ss_c Add(Mult($U,16),1) 640 operator
	M enss$U c major_ss_c Add(Mult($U,16),3) 640 operator
	RMlist[${#RMlist[*]}]="scan$U"
	MKlist[${#MKlist[*]}]=";umask 77;ln -s ss$U scan$U"-})dnl
@


1.47
log
@add diskmap entries, not on ramdisks yet
get it in! jsing@@
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.46 2009/09/23 15:39:56 miod Exp $-})dnl
d568 1
a568 1
_mkdev(diskmap, diskmap, {-M diskmap b major_diskmap_c 0 640 operator-})dnl
@


1.46
log
@Stricter patterns for numbered wsmouse and wskbd devices, so that
`wsmouse' and `wskbd' without suffixes match the wsmux rule.
Reported by Vadim Zhukov (persgray on gmail)
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.45 2009/08/13 15:12:36 deraadt Exp $-})dnl
d567 2
@


1.45
log
@Add nodes for vscsi0; ok dlg
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.44 2009/07/22 17:43:16 ratchov Exp $-})dnl
d353 3
a355 1
_mkdev(wskbd, wskbd*, {-M wskbd$U c major_wskbd_c $U 600-})dnl
d362 3
a364 1
_mkdev(wsmouse, wsmouse*, {-M wsmouse$U c major_wsmouse_c $U 600-})dnl
@


1.44
log
@add missing /dev/{rmidi,sequencer,music} bits in MAKEDEV for
armish, landisk and zaurus. Also fix corresponding .Xr in MAKEDEV.8
ok miod@@, todd@@
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.43 2009/06/03 14:45:39 jj Exp $-})dnl
d558 1
d560 1
@


1.43
log
@Arla client rename from xfs to nnpfs for later upgrades. Tested on various arches. ok todd@@ beck@@
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.42 2009/04/05 17:49:14 jmc Exp $-})dnl
d484 1
a484 1
__devitem(music, music*, MIDI devices,midi)dnl
@


1.42
log
@video(4) devices use v4l2 api; from J.C. Roberts
ok miod
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.41 2008/11/30 03:33:09 jakemsr Exp $-})dnl
d557 2
a558 2
__devitem(xfs, xfs*, XFS filesystem node, mount_xfs 8)dnl
_mcdev(xfs, xfs*, xfs, {-major_xfs_c-}, 600)dnl
@


1.41
log
@make 'MAKEDEV all' create device nodes for 3 separate audio devices
instead of just 1.

ok todd@@
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.40 2008/10/10 20:15:23 deraadt Exp $-})dnl
d477 1
a477 1
__devitem(vi, video*, Video V4L devices,video)dnl
@


1.40
log
@skip making /dev/prandom.  as a side effect, /dev/arandom becomes minor 3.
but that is OK because both minor 3 and 4 now do the same thing.  eventually,
2 releases from now, everyone will have forgotten about minor 4 and we can
delete the support code for it from sys/dev/rnd.c
various versions of this looked at by millert and todd
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.39 2008/07/14 16:22:23 miod Exp $-})dnl
d159 1
a159 1
twrget(all, au, audio, 0)dnl
@


1.39
log
@/dev/tuner description should point out to bktr(4), spotted by jmc.
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.38 2008/06/12 22:38:14 todd Exp $-})dnl
d513 1
a513 1
	for pre in " " s u p a
@


1.38
log
@make /dev/drm0 to go with oga@@'s libdrm commit moments ago
ok oga@@
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.37 2008/06/10 07:12:24 mglocker Exp $-})dnl
d564 1
a564 1
__devitem(tuner, tuner*, Tuner devices)dnl
@


1.37
log
@Add /dev/video* for amd64.

Help and OK todd@@, OK robert@@
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.36 2007/07/23 23:21:25 todd Exp $-})dnl
d386 2
@


1.36
log
@+bthub
ok mk@@
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.35 2007/05/28 22:37:14 todd Exp $-})dnl
d160 1
d475 3
@


1.35
log
@remove wt tape drives. prodded by krw@@
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.34 2007/05/18 14:05:33 jmc Exp $-})dnl
d224 2
@


1.34
log
@MASSBUSS -> MASSBUS; ok miod
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.33 2007/03/07 02:51:17 krw Exp $-})dnl
a158 1
target(all, wt, 0)dnl
a202 8
__devitem(wt, {-wt*-}, Archive/Wangtek QIC-cartridge tape drives)dnl
_mkdev(wt, wt*,
{-name=wt
	n=Mult($U, 8) m=Add($n, 4)
	M $name$U	b major_wt_b $n 640 operator
	M r$name$U	c major_wt_c $n 640 operator
	M n$name$U	b major_wt_b $m 640 operator
	M nr$name$U	c major_wt_c $m 640 operator-})dnl
a247 1
target(ramd, wt, 0)dnl
@


1.33
log
@Forcibly change /dev/pci to a symbolic link if it isn't one.

Feedback from drahn@@, millert@@, marco@@. "then get it in" deraadt@@.
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.32 2007/02/16 02:16:20 deraadt Exp $-})dnl
d302 1
a302 1
__devitem(hp, hp*, {-MASSBUSS disks-})dnl
@


1.32
log
@create "i" partitions for floppies too, in case we need them
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.31 2006/12/15 20:42:19 kettenis Exp $-})dnl
d570 1
a570 1
	MKlist[${#MKlist[*]}]=";[ -e pci ] || ln -s pci0 pci"-})dnl
@


1.31
log
@Create /dev/pci[0-3].

ok miod@@, deraadt@@
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.30 2006/10/10 12:33:41 todd Exp $-})dnl
d288 1
d291 2
a292 1
	M r${nam}c	c $chr Add($n, 2) 640 operator-}, 664)dnl
@


1.30
log
@4 usb tty devices by default; ok msf@@ marco@@
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.29 2006/08/28 21:04:04 tsi Exp $-})dnl
d170 1
a170 1
target(all, pci)dnl
d566 3
a568 2
__devitem(pci, pci, PCI bus device)dnl
_mkdev(pci, pci, {-M pci c major_pci_c 0 600-}, 600)dnl
@


1.29
log
@Extend /dev/tty[C-F]* to /dev/tty[C-J]* on sparc64, and to /dev/tty[C-I]* on
sparc.

ok miod@@
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.28 2006/06/11 10:58:57 mk Exp $-})dnl
d197 1
a197 1
target(usb, ttyU, 0, 1)dnl
@


1.28
log
@Remove wdt char device stuff from here too.

ok todd
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.27 2006/04/16 11:34:01 todd Exp $-})dnl
d340 2
a341 2
__devitem(wsdisp, ttyC-F*, wscons display devices,wsdisplay)dnl
_mkdev({-wsdisp-}, tty[C-F]*, {-U=${i##tty[C-F]}
d347 4
@


1.27
log
@remove some rather deceptively unused lines; no change to generated MAKEDEV's
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.26 2006/04/16 02:49:52 todd Exp $-})dnl
a159 1
target(all, wdt, 0)dnl
a292 2
__devitem(wdt, wdt0, Watchdog timer)dnl
_mcdev(wdt, wdt0, wdt, {-major_wdt_c-}, 440, operator)dnl
@


1.26
log
@shuffle ramdisk device targets to MAKEDEV.common to avoid duplication and
pave the way for future work; ok since this does not change the generated
MAKEDEV
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.25 2006/04/15 18:19:12 todd Exp $-})dnl
a146 1
target(all, tty0, 0, 1, 2, 3)dnl
@


1.25
log
@add 'com' serial port as a common ramdisk device
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.24 2006/04/15 18:17:11 todd Exp $-})dnl
d255 6
@


1.24
log
@add forgotten copyright; ok deraadt@@
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.23 2005/12/27 19:02:42 miod Exp $-})dnl
d247 1
d251 1
a252 1
target(ramd, random)dnl
d254 2
@


1.23
log
@Target for basic wscons devices is `wscons', not `ttyC0'; also fix the
dev/fd comment and point to fd(4).
@
text
@d1 15
a15 2
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.22 2005/12/06 20:18:56 pedro Exp $-})dnl
divert(1)dnl
d124 1
@


1.22
log
@Remove fdescfs
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.21 2005/10/06 06:43:19 otto Exp $-})dnl
d313 1
a313 1
__devitem(wscons, ttyC0, Minimal wscons devices)dnl
d469 1
a469 1
__devitem(fdesc, fd, fd/* nodes for the file descriptor pseudo-device)dnl
@


1.21
log
@Greatly speedup MAKEDEV by using arrays instead of very long strings
that get copied around a lot. Needs sh(1) max array index bump I
committed earlier. ok todd@@ deraadt@@
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.20 2005/08/01 22:22:12 deraadt Exp $-})dnl
d469 1
a469 1
__devitem(fdesc, fd, fd/* nodes for fdescfs,mount_fdesc 8)dnl
@


1.20
log
@old ses device goes away
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.19 2005/06/29 18:23:26 todd Exp $-})dnl
d229 2
a230 2
	RMlist="$RMlist scan$U"
	MKlist="$MKlist;umask 77;ln -s ss$U scan$U"-})dnl
d453 4
a456 4
	MKlist="$MKlist;[ -e audio ] || ln -s audio$U audio"
	MKlist="$MKlist;[ -e mixer ] || ln -s mixer$U mixer"
	MKlist="$MKlist;[ -e sound ] || ln -s sound$U sound"
	MKlist="$MKlist;[ -e audioctl ] || ln -s audioctl$U audioctl"-})dnl
d464 2
a465 2
	MKlist="$MKlist;[ -e music ] || ln -s music$U music"
	MKlist="$MKlist;[ -e sequencer ] || ln -s sequencer$U sequencer"-})dnl
d468 1
a468 1
	MKlist="$MKlist;[ -e radio ] || ln -s radio$U radio"-})dnl
d470 1
a470 1
_mkdev(fdesc, fd, {-RMlist="mkdir -p fd;$RMlist" n=0
d472 1
a472 1
	MKlist="$MKlist;chmod 555 fd"-})dnl
@


1.19
log
@add bio
prompted by deraadt@@ and henning@@, ok marco@@
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.18 2005/06/02 20:09:38 tholo Exp $-})dnl
a230 2
__devitem(ses, ses*, SES/SAF-TE SCSI devices)dnl
_mkdev(ses, ses*, {-M ses$U c major_ses_c $U 640 operator-})dnl
@


1.18
log
@Start on a basic ACPI framework -- does not do much more than read out the
ACPI tables into kernel memory and attach ACPI and HPET timers currently.

In order to test this code, enabling the devices in GENERIC as well as
the ACPI_ENABLE option is needed.  This code does not do any thermal
control yet, so this should be done with care depending on the platform.

In the tree so more people can contribute to making this more fully
featured.

Ok niklas@@ grange@@ tedu@@
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.17 2005/03/29 16:40:08 miod Exp $-})dnl
d461 2
@


1.17
log
@Move the apm description out of MAKEDEV.common, so that sparc can declare it
with a specific manpage reference.
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.16 2005/03/01 13:35:59 otto Exp $-})dnl
d128 1
d445 1
@


1.16
log
@Increase the default number of usb dev nodes to 6. Some new machines
(like the Mac mini) have that many usb devs on board.

ok drahn@@ dlg@@ miod@@
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.15 2005/01/28 18:56:27 danh Exp $-})dnl
a441 1
__devitem(apm, apm, Power management device)dnl
@


1.15
log
@use Add() consistently and make sure we use decimal numbers for addition
in the case of ugen devices.

suggestions and ok todd@@
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.14 2005/01/14 22:39:11 miod Exp $-})dnl
d178 1
a178 1
target(usb, usb, 0, 1, 2, 3)dnl
@


1.14
log
@Switch OpenBSD/hp300 to wscons, still using on-board ROM fonts for now.

Main features:
- MI hil drivers, allowing live plug/unplug of devices, and the keyboard
  does not need to be at id 1 anymore.
- SGC bus support on 4xx models. SGC frame buffers are supported too, but
  not as console, though you can use them as a regular glass terminal if
  you run a getty on ttyC0. Currently not compiled-in, awaiting for an sti(4)
  fix to be commited.
- HP-UX compatibility interfaces are removed. grfinfo and hilinfo are removed.

X11 support is currently broken by these changes; X.org X11R6 support will
be available very soon.

Tested on hyperion and 4 different flavours of catseye/topcat/kathmandu; other,
older frame buffers (davinci, gatorbox and renaissance) could not been tested
but should work; please report any regression.
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.13 2005/01/10 07:53:57 dlg Exp $-})dnl
d331 1
a331 1
	[0-9a-f]) M tty$n$U c major_wsdisp_c {-$(( 16#$U + $m ))-} 600;;
d398 1
a398 1
	for j in 00 01 02 03 04 05 06 07 08 09 10 11 12 13 14 15
d400 1
a400 1
		M ugen$U.$j c major_ugen_c Add($n, $j) 660
@


1.13
log
@add calling units (cuaU*) for use by devices supported by ucom
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.12 2004/08/19 07:05:20 miod Exp $-})dnl
a472 2
__devitem(ite, ite*, Terminal emulator interface to HP300 graphics devices)dnl
__devitem({-hil-}, {-hil-}, HP-HIL input devices)dnl
a534 1
__devitem(hil, hil, HP-HIL input devices)dnl
@


1.12
log
@``SCSI unknown devices'' -> ``Unknown SCSI devices'', requested long ago by
jmc@@.
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.11 2004/08/17 20:58:05 miod Exp $-})dnl
d390 2
a391 1
	M ttyU$U c major_ttyU_c $o 660 dialer uucp-})dnl
@


1.11
log
@Describe the oppr ({ee,open}prom) target, and add it to sparc64 (despite it
being handmade in std).

spotted by jmc@@, ok deraadt@@
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.10 2004/06/03 18:36:59 grange Exp $-})dnl
d222 1
a222 1
__devitem(uk, uk*, SCSI unknown devices)dnl
@


1.10
log
@Add gpio device nodes.

ok deraadt@@
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.9 2004/05/30 08:17:17 grange Exp $-})dnl
d474 1
a474 1
__devitem(oppr, openprom,,openprom)dnl
@


1.9
log
@Add hotplug device.
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.8 2004/05/29 04:07:30 deraadt Exp $-})dnl
d553 2
@


1.8
log
@usb2 & usb3 more needed on modern machines
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.7 2004/04/11 18:14:59 millert Exp $-})dnl
d169 1
d551 2
@


1.7
log
@Add back a lie about tty* do that MAKEDEV works again.  todd@@ can fix...
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.6 2004/04/11 18:05:22 millert Exp $-})dnl
d177 1
a177 1
target(usb, usb, 0, 1)dnl
@


1.6
log
@Update for pty changes (62 per letter instead of just 16)
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.5 2004/03/12 18:25:15 miod Exp $-})dnl
d346 2
a347 1
__devitem(pty, pty*, Set of 62 pseudo terminals)dnl
@


1.5
log
@Cause ct to be escaped in nroff output; spotted by jmc.
No regen necessary except for hp300 MAKEDEV.8
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.4 2004/03/12 04:54:04 deraadt Exp $-})dnl
d346 1
a346 2
__devitem(tty, tty*, Set of 16 slave pseudo terminals)dnl
__devitem(pty, pty*, Set of 16 master pseudo terminals)dnl
d351 6
a356 2
	set -A tbl p q r s t u v w x y z P Q R S T
	name=${tbl[$U]}
d358 1
a358 1
	while [ $n -lt 16 ]
d360 2
a361 2
		nam=$name$(hex $n)
		off=Mult($U, 16)
@


1.4
log
@replace usbs with uall to avoid matching balony
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.3 2004/02/20 19:13:01 miod Exp $-})dnl
a206 1
__devitem(ct, ct*, HP300 HP-IB cartridge tape drives)dnl
@


1.3
log
@MAKEDEV.8 improvement pack:
- refer to the section 4 manual page for every device target, whenever
possible
- repair a few minor quoting errors
- repair a few sorting errors
- fix a few device descriptions (ideally they would be synched with the
  .Nd line of their manpages, but we are not there... yet)
- minor mdoc fixes

Thanks to jmc@@ for review and a lot of constructive criticism.
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.2 2004/02/17 11:18:03 miod Exp $-})dnl
d154 1
a154 1
target(all, usbs)dnl
d185 2
a186 2
__devitem({-usbs-}, usbs, All USB devices,usb)dnl
_mkdev(usbs, usbs, {-dnl
@


1.2
log
@Move conflicting hd(4) definitions to MD files.
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD: MAKEDEV.common,v 1.1 2004/02/16 18:58:54 miod Exp $-})dnl
d175 1
a175 1
__devitem(ramdisk, ramdisk, Ramdisk kernel devices)dnl
d185 1
a185 1
__devitem({-usbs-}, usbs, All USB devices)dnl
d190 1
a190 1
__devitem(wt, {-wt*	-}, Archive/Wangtek QIC-cartridge tape drives)dnl
d214 2
a215 4
dnl REMOVE __devitem(rz, rz*, SCSI disks)dnl
__devitem(sd, {-sd*-}, {-SCSI disks, includes flopticals-})dnl
__devitem(cd, {-cd*-}, SCSI cdrom drives)dnl
__devitem(acd, acd*, ATAPI cdrom drives)dnl
d217 1
a217 1
__devitem(mcd, mcd*, Mitsumi cdrom drives)dnl
d233 1
a233 1
__devitem(ramd, ramdisk, Ramdisk kernel devices)dnl
d244 1
a244 1
__devitem(flo, {-fd*-}, {-Floppy disk drives (3 1/2"{-,-} 5 1/4")-})dnl
d275 1
a275 1
__devitem(wd, {-wd*-}, {-quote(winchester)disk drives (ST506, IDE, ESDI, RLL, ...)-})dnl
d322 1
a322 1
__devitem(wsdisp, ttyC-F*, wscons display devices)dnl
a365 1
__devitem(par, par*, On-board parallel port)dnl
d373 1
a373 1
__devitem(lpa, lpa*, Polled printer port)dnl
d383 1
a383 1
__devitem(ttyU, ttyU*, USB serial ports)dnl
d389 1
a389 1
__devitem(uscan, uscanner*, Scanners)dnl
d407 2
a408 2
__devitem(ttyc, ttyc*, Cyclades serial ports)dnl
__devitem(tzs, tty[a-z]*, Zilog 8530 Serial Port)dnl
d418 1
a418 1
__devitem(tth, ttyh*, Sab82532 serial devices)dnl
d420 1
a420 1
__devitem(czs, cua[a-z]*, Zilog 8530 Serial Port)dnl
d430 6
a435 6
__devitem(tty0, tty00, Standard serial port)dnl
__devitem(mac_tty0, tty00, Standard serial port)dnl
__devitem(ttyz, tty[a-d], On-board zs serial ports)dnl
__devitem(cuaz, cua[a-d], On-board zs serial ports)dnl
__devitem(ttyB, ttyB?, DEC 3000 ZS8530 ("scc") serial ports)dnl
__devitem(scc, scc*, 82530 serial interface)dnl
d444 1
a444 1
__devitem(au, audio*, Audio devices)dnl
d455 1
a455 1
__devitem(music, music*, MIDI devices)dnl
d463 1
a463 1
__devitem(fdesc, fd, fd/* nodes for fdescfs)dnl
d467 1
a467 1
__devitem(grf_mac, grf*, Raw interface to the mac68k graphics devices)dnl
d470 1
a470 1
__devitem(oppr, openprom)dnl
d472 1
a472 1
__devitem(cry, crypto, Hardware crypto access driver)dnl
d479 1
a479 1
__devitem(speak, speaker, PC speaker)dnl
a482 1
__devitem(mmcl, mmclock, Memory mapped clock)dnl
d484 1
a484 1
__devitem(rnd, *random, In-kernel random data source)dnl
d493 2
a494 2
__devitem(mag, magma*, Magma multiport cards)dnl
__devitem(bppmag, bppmag[mno], Magma parallel port)dnl
d496 1
a496 1
__devitem(bppsp, bpp[jkl], quote(spif)parallel port)dnl
d530 1
a530 1
__devitem(xfs, xfs*, XFS filesystem node)dnl
d533 1
a533 1
__devitem(rmidi, rmidi*, Raw MIDI devices)dnl
@


1.1
log
@Move the real knowledge of MI devices to a specific file, MAKEDEV.common.
While there, allow the comment char and the divert section for md script
fragments to be overriden.
No functional change (yet).

disabused ok deraadt@@
@
text
@d1 1
a1 1
vers(a, {-$OpenBSD$-})dnl
a215 1
__devitem(hd, {-hd*-}, HP300 HP-IB disks)dnl
a289 1
__devitem(hd, hd*, {-HDC9224 disks-})dnl
@

