head	1.6;
access;
symbols
	OPENBSD_6_2:1.6.0.10
	OPENBSD_6_2_BASE:1.6
	OPENBSD_6_1:1.6.0.8
	OPENBSD_6_1_BASE:1.6
	OPENBSD_6_0:1.6.0.6
	OPENBSD_6_0_BASE:1.6
	OPENBSD_5_9:1.6.0.2
	OPENBSD_5_9_BASE:1.6
	OPENBSD_5_8:1.4.0.14
	OPENBSD_5_8_BASE:1.4
	OPENBSD_5_7:1.4.0.6
	OPENBSD_5_7_BASE:1.4
	OPENBSD_5_6:1.4.0.10
	OPENBSD_5_6_BASE:1.4
	OPENBSD_5_5:1.4.0.8
	OPENBSD_5_5_BASE:1.4
	OPENBSD_5_4:1.4.0.4
	OPENBSD_5_4_BASE:1.4
	OPENBSD_5_3:1.4.0.2
	OPENBSD_5_3_BASE:1.4
	OPENBSD_5_2:1.2.0.6
	OPENBSD_5_2_BASE:1.2
	OPENBSD_5_1_BASE:1.2
	OPENBSD_5_1:1.2.0.4
	OPENBSD_5_0:1.2.0.2
	OPENBSD_5_0_BASE:1.2;
locks; strict;
comment	@# @;


1.6
date	2015.12.26.09.55.15;	author ajacoutot;	state Exp;
branches;
next	1.5;
commitid	kt1ZdinO017eYHUZ;

1.5
date	2015.12.26.02.52.53;	author krw;	state Exp;
branches;
next	1.4;
commitid	BN6SDtAOhYvgG2Mj;

1.4
date	2013.01.26.08.00.11;	author ajacoutot;	state Exp;
branches;
next	1.3;

1.3
date	2012.08.14.07.43.57;	author ajacoutot;	state Exp;
branches;
next	1.2;

1.2
date	2011.08.02.11.59.25;	author robert;	state Exp;
branches;
next	1.1;

1.1
date	2011.07.08.00.54.04;	author ajacoutot;	state Exp;
branches;
next	;


desc
@@


1.6
log
@Remove blank line for consistency with other rc.d scripts; no change in
behavior.
@
text
@#!/bin/sh
#
# $OpenBSD: mountd,v 1.5 2015/12/26 02:52:53 krw Exp $

daemon="/sbin/mountd"

. /etc/rc.d/rc.subr

pexp="mountd: \[priv\]"
rc_stop=NO

rc_pre() {
	[ -s /etc/exports ] && grep -qv '^#' /etc/exports && \
		rm -f /var/db/mountdtab && \
		echo -n > /var/db/mountdtab
}

rc_cmd $1
@


1.5
log
@mountd(8) changes require a pexp.

ok deraadt@@
@
text
@d3 1
a3 1
# $OpenBSD: mountd,v 1.4 2013/01/26 08:00:11 ajacoutot Exp $
a9 1

@


1.4
log
@Do not allow stopping/restarting mountd using the rc.d(8) framework;
if there is need to send a SIGTERM to mountd(8), it should be done
manually as there is too much involved with RPC daemons to make it
automagic.

ok beck@@
@
text
@d3 1
a3 1
# $OpenBSD: mountd,v 1.3 2012/08/14 07:43:57 ajacoutot Exp $
d8 2
@


1.3
log
@Optimize checks for /etc/exports.

from robert at peichaer dot org
discussed with and ok halex@@
@
text
@d3 1
a3 1
# $OpenBSD: mountd,v 1.2 2011/08/02 11:59:25 robert Exp $
d8 2
@


1.2
log
@handle /var/db/mountdtab in the mountd script and not in nfsd
@
text
@d3 1
a3 1
# $OpenBSD: mountd,v 1.1 2011/07/08 00:54:04 ajacoutot Exp $
d10 1
a10 1
	[ -s /etc/exports -a `sed -e '/^#/d' < /etc/exports | wc -l` -ne 0 ] &&
@


1.1
log
@Add the nfs startup scripts.

ok robert@@
@
text
@d3 1
a3 1
# $OpenBSD$
d8 6
@

