head	1.25;
access;
symbols
	OPENBSD_6_1_BASE:1.25
	OPENBSD_6_0:1.25.0.6
	OPENBSD_6_0_BASE:1.25
	OPENBSD_5_9:1.25.0.2
	OPENBSD_5_9_BASE:1.25
	OPENBSD_5_8:1.24.0.6
	OPENBSD_5_8_BASE:1.24
	OPENBSD_5_7:1.24.0.2
	OPENBSD_5_7_BASE:1.24
	OPENBSD_5_6:1.23.0.6
	OPENBSD_5_6_BASE:1.23
	OPENBSD_5_5:1.23.0.4
	OPENBSD_5_5_BASE:1.23
	OPENBSD_5_4:1.22.0.2
	OPENBSD_5_4_BASE:1.22
	OPENBSD_5_3:1.21.0.8
	OPENBSD_5_3_BASE:1.21
	OPENBSD_5_2:1.21.0.6
	OPENBSD_5_2_BASE:1.21
	OPENBSD_5_1_BASE:1.21
	OPENBSD_5_1:1.21.0.4
	OPENBSD_5_0:1.21.0.2
	OPENBSD_5_0_BASE:1.21
	OPENBSD_4_9:1.19.0.2
	OPENBSD_4_9_BASE:1.19
	OPENBSD_4_8:1.17.0.6
	OPENBSD_4_8_BASE:1.17
	OPENBSD_4_7:1.17.0.2
	OPENBSD_4_7_BASE:1.17
	OPENBSD_4_6:1.17.0.4
	OPENBSD_4_6_BASE:1.17
	OPENBSD_4_5:1.15.0.12
	OPENBSD_4_5_BASE:1.15
	OPENBSD_4_4:1.15.0.8
	OPENBSD_4_4_BASE:1.15
	OPENBSD_4_3:1.15.0.10
	OPENBSD_4_3_BASE:1.15
	OPENBSD_4_2:1.15.0.6
	OPENBSD_4_2_BASE:1.15
	OPENBSD_4_1:1.15.0.4
	OPENBSD_4_1_BASE:1.15
	OPENBSD_4_0:1.15.0.2
	OPENBSD_4_0_BASE:1.15
	OPENBSD_3_9:1.13.0.16
	OPENBSD_3_9_BASE:1.13
	OPENBSD_3_8:1.13.0.14
	OPENBSD_3_8_BASE:1.13
	OPENBSD_3_7:1.13.0.12
	OPENBSD_3_7_BASE:1.13
	OPENBSD_3_6:1.13.0.10
	OPENBSD_3_6_BASE:1.13
	OPENBSD_3_5:1.13.0.8
	OPENBSD_3_5_BASE:1.13
	OPENBSD_3_4:1.13.0.6
	OPENBSD_3_4_BASE:1.13
	OPENBSD_3_3:1.13.0.4
	OPENBSD_3_3_BASE:1.13
	OPENBSD_3_2:1.13.0.2
	OPENBSD_3_2_BASE:1.13
	OPENBSD_3_1:1.12.0.6
	OPENBSD_3_1_BASE:1.12
	OPENBSD_3_0:1.12.0.4
	OPENBSD_3_0_BASE:1.12
	OPENBSD_2_9:1.12.0.2
	OPENBSD_2_9_BASE:1.12
	OPENBSD_2_8:1.10.0.12
	OPENBSD_2_8_BASE:1.10
	OPENBSD_2_7:1.10.0.10
	OPENBSD_2_7_BASE:1.10
	OPENBSD_2_6:1.10.0.8
	OPENBSD_2_6_BASE:1.10
	OPENBSD_2_5:1.10.0.6
	OPENBSD_2_5_BASE:1.10
	OPENBSD_2_4:1.10.0.4
	OPENBSD_2_4_BASE:1.10
	OPENBSD_2_3:1.10.0.2
	OPENBSD_2_3_BASE:1.10
	OPENBSD_2_2:1.9.0.2
	OPENBSD_2_2_BASE:1.9
	OPENBSD_2_1:1.7.0.2
	OPENBSD_2_1_BASE:1.7;
locks; strict;
comment	@# @;


1.25
date	2015.08.29.17.22.41;	author deraadt;	state Exp;
branches;
next	1.24;
commitid	hcLt8Arp1K76Dbp4;

1.24
date	2014.12.13.14.45.57;	author miod;	state Exp;
branches;
next	1.23;
commitid	YctlkOSO4Sb2LdDi;

1.23
date	2014.02.03.05.35.40;	author miod;	state Exp;
branches;
next	1.22;

1.22
date	2013.03.09.17.25.25;	author deraadt;	state Exp;
branches;
next	1.21;

1.21
date	2011.07.22.09.30.54;	author espie;	state Exp;
branches;
next	1.20;

1.20
date	2011.04.15.03.11.38;	author deraadt;	state Exp;
branches;
next	1.19;

1.19
date	2011.01.14.17.18.49;	author deraadt;	state Exp;
branches;
next	1.18;

1.18
date	2010.08.17.19.17.12;	author deraadt;	state Exp;
branches;
next	1.17;

1.17
date	2009.04.21.09.12.26;	author deraadt;	state Exp;
branches;
next	1.16;

1.16
date	2009.04.17.03.58.53;	author deraadt;	state Exp;
branches;
next	1.15;

1.15
date	2006.07.27.03.11.23;	author deraadt;	state Exp;
branches;
next	1.14;

1.14
date	2006.07.27.02.53.55;	author deraadt;	state Exp;
branches;
next	1.13;

1.13
date	2002.05.13.07.22.42;	author espie;	state Exp;
branches;
next	1.12;

1.12
date	2001.03.05.14.32.10;	author deraadt;	state Exp;
branches;
next	1.11;

1.11
date	2001.01.23.09.04.11;	author art;	state Exp;
branches;
next	1.10;

1.10
date	97.10.31.22.20.45;	author deraadt;	state Exp;
branches;
next	1.9;

1.9
date	97.09.21.11.50.13;	author deraadt;	state Exp;
branches
	1.9.2.1;
next	1.8;

1.8
date	97.09.18.17.17.32;	author deraadt;	state Exp;
branches;
next	1.7;

1.7
date	97.05.24.21.39.06;	author graichen;	state Exp;
branches;
next	1.6;

1.6
date	97.05.14.10.00.28;	author graichen;	state Exp;
branches;
next	1.5;

1.5
date	97.05.14.09.55.32;	author graichen;	state Exp;
branches;
next	1.4;

1.4
date	97.05.10.03.44.13;	author millert;	state Exp;
branches;
next	1.3;

1.3
date	97.05.05.15.14.41;	author graichen;	state Exp;
branches;
next	1.2;

1.2
date	97.01.21.12.02.52;	author graichen;	state Exp;
branches;
next	1.1;

1.1
date	97.01.19.22.29.23;	author graichen;	state Exp;
branches;
next	;

1.9.2.1
date	97.10.31.22.21.20;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.25
log
@handle miniroot
@
text
@#	$OpenBSD: Makefile.inc,v 1.24 2014/12/13 14:45:57 miod Exp $

KERNELS += GENERIC.MP bsd.mp

KERNELS += GENERIC.MP bsd.mp

bootblocks:
	cp ${DESTDIR}/usr/mdec/boot ${RELEASEDIR}
	cp ${DESTDIR}/usr/mdec/bootxx ${RELEASEDIR}
	cp ${DESTDIR}/usr/mdec/netboot ${RELEASEDIR}
	cp ${DESTDIR}/usr/mdec/netboot.mop ${RELEASEDIR}

MDEXT=	bsd.rd cd${OSrev}.iso \
	miniroot${OSrev}.fs \
	floppy${OSrev}.fs floppyB${OSrev}.fs floppyC${OSrev}.fs \
	boot bootxx netboot netboot.mop
@


1.24
log
@Install netboot.mop
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.23 2014/02/03 05:35:40 miod Exp $
d14 1
@


1.23
log
@Build and document bsd.mp on alpha.
@
text
@d1 3
a3 1
#	$OpenBSD: Makefile.inc,v 1.22 2013/03/09 17:25:25 deraadt Exp $
d11 1
d15 1
a15 1
	boot bootxx netboot
@


1.22
log
@RAMDISKC wil be needed for alphabook1
@
text
@d1 3
a3 1
#	$OpenBSD: Makefile.inc,v 1.21 2011/07/22 09:30:54 espie Exp $
@


1.21
log
@unify kernel building on various platforms.
feedback from miod@@ and deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.20 2011/04/15 03:11:38 deraadt Exp $
d9 1
a9 1
	floppy${OSrev}.fs floppyB${OSrev}.fs \
@


1.20
log
@No need to make depend kernels
@
text
@d1 1
a1 10
#	$OpenBSD: Makefile.inc,v 1.19 2011/01/14 17:18:49 deraadt Exp $

kernels: bsd bootblocks
	cp ${.CURDIR}/../sys/arch/alpha/compile/GENERIC/bsd \
	    ${RELEASEDIR}/bsd

bsd:
	cd ${.CURDIR}/../sys/arch/alpha/conf && config GENERIC
	cd ${.CURDIR}/../sys/arch/alpha/compile/GENERIC && \
	    ${MAKE} clean && exec ${MAKE}
d8 1
a8 1
MDEXT=	bsd bsd.rd cd${OSrev}.iso \
a10 2

.PHONY: bsd bootblocks
@


1.19
log
@We should not sum the install*.iso file, since it is not created at build
time.  We've been summing the one from the previous build (then additional
goo I run has been cleaning it up..)
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.18 2010/08/17 19:17:12 deraadt Exp $
d10 1
a10 1
	    ${MAKE} clean && ${MAKE} depend && exec ${MAKE}
@


1.18
log
@MDEXT missed some files (result was they are not listed in the build-time
SHA256 file).  Issue spotted by claudio.
ok miod
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.17 2009/04/21 09:12:26 deraadt Exp $
d17 1
a17 1
MDEXT=	bsd bsd.rd cd${OSrev}.iso install${OSrev}.iso \
@


1.17
log
@move bsd and bsd.rd and all such other MD "sets" into the MD files,
since we perhaps cannot assume that is what kernels will be in the
pathetically stupid world that SGI created
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.16 2009/04/17 03:58:53 deraadt Exp $
d17 2
a18 1
MDEXT=	bsd bsd.rd cd${OSrev}.iso floppy${OSrev}.fs floppyB${OSrev}.fs \
@


1.16
log
@For SHA256 hashes to be ready to go onto the install media, we must
build the sets before we build the media.  While there we can get rid
of DESTDIR/snapshot too, and simply install straight into RELEASEDIR.
(This also ends up saving an astounding amount of traffic/latency in a nfs
environment)
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.15 2006/07/27 03:11:23 deraadt Exp $
d17 1
a17 1
MDEXT=	cd${OSrev}.iso floppy${OSrev}.fs floppyB${OSrev}.fs \
@


1.15
log
@typo
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.14 2006/07/27 02:53:55 deraadt Exp $
d3 1
a3 2
.ifdef DESTDIR
snap_md: bsd bootblocks distrib
d5 1
a5 1
	    ${DESTDIR}/snapshot/bsd
d13 6
a18 3
	cp ${DESTDIR}/usr/mdec/boot ${DESTDIR}/snapshot
	cp ${DESTDIR}/usr/mdec/bootxx ${DESTDIR}/snapshot
	cp ${DESTDIR}/usr/mdec/netboot ${DESTDIR}/snapshot
a20 2

.endif	# DESTDIR check
@


1.14
log
@unify these damnit!
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.13 2002/05/13 07:22:42 espie Exp $
d4 1
a4 1
snap_md: bsd bootlocks distrib
@


1.13
log
@move common distrib rules to main Makefile,
make -> ${MAKE}
add phony targets
remove unnecessary subshells
install kernel in a separate target from building.
some SUDO.

okay deraadt@@

(checked bootstrap on i386, should be safe elsewhere, and trivial to fix
anyways)
@
text
@d1 1
a1 2
#	$OpenBSD: Makefile.inc,v 1.12 2001/03/05 14:32:10 deraadt Exp $
#	etc.alpha/Makefile.inc -- alpha-specific etc Makefile targets
d4 1
a4 2

snap_md: bsd distrib boot
d13 1
a13 2

boot:
d18 1
a18 1
.PHONY: bsd boot
@


1.12
log
@no longer need binutils.tar.gz file
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.11 2001/01/23 09:04:11 art Exp $
d7 2
d13 1
a13 3
	    make clean && make depend && make
	cp ${.CURDIR}/../sys/arch/alpha/compile/GENERIC/bsd \
	    ${DESTDIR}/snapshot/bsd
a14 3
distrib:
	cd ${.CURDIR}/../distrib && \
	    make cleandir && make && make install
d20 2
@


1.11
log
@Install more bootblocks.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.10 1997/10/31 22:20:45 deraadt Exp $
d6 1
a6 5
snap_md: binutils bsd distrib boot

binutils:
	cd ${DESTDIR} && tar cf - usr/*openbsd* \
	    | ${GZIP} ${GZIPFLAGS} > snapshot/usr.binutils.tar${GZIPEXT}
@


1.10
log
@install bootblocks too
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.9 1997/09/21 11:50:13 deraadt Exp $
d25 2
@


1.9
log
@$OpenBSD
@
text
@d1 1
a1 1
#	$OpenBSD$
d6 1
a6 1
snap_md: binutils bsd distrib
d22 3
@


1.9.2.1
log
@merge to trunk: install bootblocks too
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.10 1997/10/31 22:20:45 deraadt Exp $
d6 1
a6 1
snap_md: binutils bsd distrib boot
a21 3

boot:
	cp ${DESTDIR}/usr/mdec/boot ${DESTDIR}/snapshot
@


1.8
log
@for architectures which go into src/distrib automatically, start at the
top level there...
@
text
@d1 1
a1 1
#
a2 2
#
#	$Id: Makefile.inc,v 1.7 1997/05/24 21:39:06 graichen Exp $
@


1.7
log
@remove boot here - it has gone a while ago
@
text
@d4 1
a4 1
#	$Id: Makefile.inc,v 1.6 1997/05/14 10:00:28 graichen Exp $
d8 1
a8 1
snap_md: binutils bsd floppy
d21 2
a22 2
floppy:
	cd ${.CURDIR}/../distrib/alpha/ramdisk && \
@


1.6
log
@undo my last change - don't copy /boot to the snapshot area - it is'nt
really required there
@
text
@d4 1
a4 1
#	$Id: Makefile.inc,v 1.5 1997/05/14 09:55:32 graichen Exp $
d8 1
a8 1
snap_md: binutils bsd boot floppy
@


1.5
log
@copy /boot into the snapshot area too
@
text
@d4 1
a4 1
#	$Id: Makefile.inc,v 1.4 1997/05/10 03:44:13 millert Exp $
a19 3

boot:
	cp ${DESTDIR}/usr/mdec/boot ${DESTDIR}/snapshot/boot
@


1.4
log
@Add floppy target and make it a dependency for snap_md
@
text
@d4 1
a4 1
#	$Id: Makefile.inc,v 1.3 1997/05/05 15:14:41 graichen Exp $
d8 1
a8 1
snap_md: binutils bsd floppy
d20 3
@


1.3
log
@also install kernel into snapshot area
@
text
@d4 1
a4 1
#	$Id: Makefile.inc,v 1.2 1997/01/21 12:02:52 graichen Exp $
d8 1
a8 1
snap_md: binutils bsd
d20 4
@


1.2
log
@changing SNAP_GZIP_CMD to GZIP + GZIPEXT etc.
@
text
@d4 1
a4 1
#	$Id: Makefile.inc,v 1.1 1997/01/19 22:29:15 graichen Exp $
d7 2
a8 2
# XXX - bsd will come then we have a GENERIC kernel
snap_md: binutils
@


1.1
log
@add Makefile.inc for tar'ing also the binutils tree (/usr/*-openbsd-*)
then making a snapshot - also add a target for creating and copying
the GENERIC kernel
@
text
@d4 1
a4 1
#	$Id: Makefile.inc,v 1.3 1996/06/11 10:20:33 deraadt Exp $
d12 1
a12 1
	    | ${SNAP_GZIP_CMD} > snapshot/usr.binutils.tar${SNAP_GZIP_EXT}
@
