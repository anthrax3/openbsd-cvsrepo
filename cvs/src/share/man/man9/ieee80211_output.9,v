head	1.6;
access;
symbols
	OPENBSD_6_2:1.6.0.10
	OPENBSD_6_2_BASE:1.6
	OPENBSD_6_1:1.6.0.8
	OPENBSD_6_1_BASE:1.6
	OPENBSD_6_0:1.6.0.4
	OPENBSD_6_0_BASE:1.6
	OPENBSD_5_9:1.6.0.2
	OPENBSD_5_9_BASE:1.6
	OPENBSD_5_8:1.5.0.12
	OPENBSD_5_8_BASE:1.5
	OPENBSD_5_7:1.5.0.4
	OPENBSD_5_7_BASE:1.5
	OPENBSD_5_6:1.5.0.8
	OPENBSD_5_6_BASE:1.5
	OPENBSD_5_5:1.5.0.6
	OPENBSD_5_5_BASE:1.5
	OPENBSD_5_4:1.5.0.2
	OPENBSD_5_4_BASE:1.5
	OPENBSD_5_3:1.4.0.24
	OPENBSD_5_3_BASE:1.4
	OPENBSD_5_2:1.4.0.22
	OPENBSD_5_2_BASE:1.4
	OPENBSD_5_1_BASE:1.4
	OPENBSD_5_1:1.4.0.20
	OPENBSD_5_0:1.4.0.18
	OPENBSD_5_0_BASE:1.4
	OPENBSD_4_9:1.4.0.16
	OPENBSD_4_9_BASE:1.4
	OPENBSD_4_8:1.4.0.14
	OPENBSD_4_8_BASE:1.4
	OPENBSD_4_7:1.4.0.10
	OPENBSD_4_7_BASE:1.4
	OPENBSD_4_6:1.4.0.12
	OPENBSD_4_6_BASE:1.4
	OPENBSD_4_5:1.4.0.8
	OPENBSD_4_5_BASE:1.4
	OPENBSD_4_4:1.4.0.6
	OPENBSD_4_4_BASE:1.4
	OPENBSD_4_3:1.4.0.4
	OPENBSD_4_3_BASE:1.4
	OPENBSD_4_2:1.4.0.2
	OPENBSD_4_2_BASE:1.4
	OPENBSD_4_1:1.2.0.6
	OPENBSD_4_1_BASE:1.2
	OPENBSD_4_0:1.2.0.4
	OPENBSD_4_0_BASE:1.2
	OPENBSD_3_9:1.2.0.2
	OPENBSD_3_9_BASE:1.2
	OPENBSD_3_8:1.1.0.2
	OPENBSD_3_8_BASE:1.1;
locks; strict;
comment	@.\" @;


1.6
date	2015.11.23.17.53.57;	author jmc;	state Exp;
branches;
next	1.5;
commitid	GVTTSAMZ93Lz4hmE;

1.5
date	2013.07.17.20.21.53;	author schwarze;	state Exp;
branches;
next	1.4;

1.4
date	2007.06.07.20.20.15;	author damien;	state Exp;
branches;
next	1.3;

1.3
date	2007.05.31.19.20.00;	author jmc;	state Exp;
branches;
next	1.2;

1.2
date	2005.09.30.20.34.25;	author jaredy;	state Exp;
branches;
next	1.1;

1.1
date	2005.04.04.12.48.42;	author jsg;	state Exp;
branches;
next	;


desc
@@


1.6
log
@add missing NAME entries;
feedback/ok schwarze
@
text
@.\"	$OpenBSD: ieee80211_output.9,v 1.5 2013/07/17 20:21:53 schwarze Exp $
.\"
.\" Copyright (c) 2004 Bruce M. Simpson <bms@@spc.org>
.\" Copyright (c) 2004 Darron Broad <darron@@kewl.org>
.\" All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.\" $FreeBSD: src/share/man/man9/ieee80211_output.9,v 1.2 2004/07/07 12:59:39 ru Exp $
.\" $Id: ieee80211_output.9,v 1.5 2013/07/17 20:21:53 schwarze Exp $
.\"
.Dd $Mdocdate: July 17 2013 $
.Dt IEEE80211_ENCAP 9
.Os
.Sh NAME
.Nm ieee80211_encap , ieee80211_add_rates ,
.Nm ieee80211_add_xrates ,
.Nm ieee80211_send_mgmt
.Nd software 802.11 stack output functions
.Sh SYNOPSIS
.In net80211/ieee80211_var.h
.In net80211/ieee80211_proto.h
.Ft struct mbuf *
.Fo ieee80211_encap
.Fa "struct ifnet *ifp" "struct mbuf *m" "struct ieee80211_node **pni"
.Fc
.Ft u_int8_t *
.Fn ieee80211_add_rates "u_int8_t *frm" "const struct ieee80211_rateset *rs"
.Ft u_int8_t *
.Fn ieee80211_add_xrates "u_int8_t *frm" "const struct ieee80211_rateset *rs"
.Ft int
.Fo ieee80211_send_mgmt
.Fa "struct ieee80211com *ic" "struct ieee80211_node *ni" "int type" "int arg"
.Fc
.Sh DESCRIPTION
These functions handle the encapsulation and transmission of 802.11 frames
within the software 802.11 stack.
.Pp
The
.Fn ieee80211_encap
function encapsulates an outbound data frame contained within the
mbuf chain
.Fa m
from the interface
.Fa ifp .
The argument
.Fa *pni
is a reference to the destination node.
.Pp
If the function is successful, the mbuf chain is updated with the
802.11 frame header prepended, and a pointer to the head of the chain
is returned.
If an error occurs,
.Dv NULL
will be returned, and
.Fa *pni
is also set to
.Dv NULL .
The caller is responsible for freeing the node reference if
.Fa *pni
is
.Pf non- Dv NULL
on return.
The convention is that
.Va ic_bss
is not reference counted; the caller is responsible for maintaining this
reference count.
.Pp
.\"
The
.Fn ieee80211_add_rates
utility function is used to add the rate set element
.Fa *rs
to the frame
.Fa frm .
A pointer to the location in the buffer after the addition of the rate set
is returned.
It is typically used when constructing management frames from within the
software 802.11 stack.
.Pp
.\"
The
.Fn ieee80211_add_xrates
utility function is used to add the extended rate set element
.Fa *rs
to the frame
.Fa frm .
A pointer to the location in the buffer after the addition of the rate set
is returned.
It is typically used when constructing management frames from within the
software 802.11 stack in 802.11g mode.
.Pp
.\"
The
.Fn ieee80211_send_mgmt
function transmits a management frame on the interface
.Fa ic
to the destination node
.Fa ni
of type
.Fa type .
.Pp
The argument
.Fa arg
specifies either a sequence number for authentication operations,
a status code for [re]association operations,
or a reason for deauthentication and deassociation operations.
.Pp
Nodes other than
.Va ic_bss
have their reference count incremented to reflect their use for an
indeterminate amount of time.
This reference is freed when the function returns.
.Pp
The function returns 0 if successful; if temporary buffer space is not
available, the function returns
.Er ENOMEM .
.\"
.Sh SEE ALSO
.Xr ieee80211 9
.Sh HISTORY
The
.Nm ieee80211
series of functions first appeared in
.Nx 1.5 ,
and were later ported to
.Fx 4.6
and
.Ox 3.6 .
.Sh AUTHORS
.An -nosplit
This man page was written by
.An Bruce M. Simpson Aq Mt bms@@FreeBSD.org
and
.An Darron Broad Aq Mt darron@@kewl.org .
@


1.5
log
@use .Mt for AUTHORS email; from Jan Stary <hans at stare dot cz>; ok jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: ieee80211_output.9,v 1.4 2007/06/07 20:20:15 damien Exp $
d29 1
a29 1
.\" $Id: ieee80211_output.9,v 1.4 2007/06/07 20:20:15 damien Exp $
d31 2
a32 2
.Dd $Mdocdate: June 7 2007 $
.Dt IEEE80211_OUTPUT 9
@


1.4
log
@move ieee80211_compute_duration() and ieee80211_compute_duration1()
functions into the two drivers that use them (atw and rtw.)
this code is not generic enough to be used by other drivers and
there is no chance that it will ever be used in newer driver since
it supports 802.11b only.
plus, it hurts my eyes each time i look into ieee80211_output.c.

"fine with me as long as the logic doesn't change in the functions" jsg@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: ieee80211_output.9,v 1.3 2007/05/31 19:20:00 jmc Exp $
d29 1
a29 1
.\" $Id: ieee80211_output.9,v 1.3 2007/05/31 19:20:00 jmc Exp $
d31 1
a31 1
.Dd $Mdocdate: May 31 2007 $
d152 1
a152 1
.An Bruce M. Simpson Aq bms@@FreeBSD.org
d154 1
a154 1
.An Darron Broad Aq darron@@kewl.org .
@


1.3
log
@convert to new .Dd format;
@
text
@d1 1
a1 1
.\"	$OpenBSD: ieee80211_output.9,v 1.2 2005/09/30 20:34:25 jaredy Exp $
d29 1
a29 1
.\" $Id: ieee80211_output.9,v 1.2 2005/09/30 20:34:25 jaredy Exp $
d31 1
a31 1
.Dd $Mdocdate$
d36 1
a36 1
.Nm ieee80211_add_xrates , ieee80211_compute_duration
a50 12
.Fo ieee80211_compute_duration
.Fa "struct ieee80211_frame *wh"
.Fa "int len"
.Fa "uint32_t flags"
.Fa "int fraglen"
.Fa "int rate"
.Fa "struct ieee80211_duration *d0"
.Fa "struct ieee80211_duration *dn"
.Fa "int *npktp"
.Fa "int debug"
.Fc
.Ft int
a110 6
.Pp
.\"
The
.Fn ieee80211_compute_duration
function computes for any packet the appropriate 802.11 Duration field,
the PLCP Length field, as well as the Duration and Length fields for an RTS frame.
@


1.2
log
@deploy .An -nosplit; ok jmc
@
text
@d1 1
a1 1
.\"	$OpenBSD: ieee80211_output.9,v 1.1 2005/04/04 12:48:42 jsg Exp $
d29 1
a29 1
.\" $Id: ieee80211_output.9,v 1.1 2005/04/04 12:48:42 jsg Exp $
d31 1
a31 1
.Dd March 2, 2004
@


1.1
log
@Some documentation for the 802.11 stack written by
Bruce M. Simpson and Darron Broad for FreeBSD, adapted to reflect
the state of our stack.  Help from and ok jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD$
d29 1
a29 1
.\" $Id: ieee80211_output.9,v 1.5 2004/03/04 12:31:18 bruce Exp $
d168 1
@

