head	1.17;
access;
symbols
	OPENBSD_6_2:1.17.0.10
	OPENBSD_6_2_BASE:1.17
	OPENBSD_6_1:1.17.0.8
	OPENBSD_6_1_BASE:1.17
	OPENBSD_6_0:1.17.0.4
	OPENBSD_6_0_BASE:1.17
	OPENBSD_5_9:1.17.0.2
	OPENBSD_5_9_BASE:1.17
	OPENBSD_5_8:1.16.0.12
	OPENBSD_5_8_BASE:1.16
	OPENBSD_5_7:1.16.0.4
	OPENBSD_5_7_BASE:1.16
	OPENBSD_5_6:1.16.0.8
	OPENBSD_5_6_BASE:1.16
	OPENBSD_5_5:1.16.0.6
	OPENBSD_5_5_BASE:1.16
	OPENBSD_5_4:1.16.0.2
	OPENBSD_5_4_BASE:1.16
	OPENBSD_5_3:1.15.0.4
	OPENBSD_5_3_BASE:1.15
	OPENBSD_5_2:1.15.0.2
	OPENBSD_5_2_BASE:1.15
	OPENBSD_5_1_BASE:1.14
	OPENBSD_5_1:1.14.0.20
	OPENBSD_5_0:1.14.0.18
	OPENBSD_5_0_BASE:1.14
	OPENBSD_4_9:1.14.0.16
	OPENBSD_4_9_BASE:1.14
	OPENBSD_4_8:1.14.0.14
	OPENBSD_4_8_BASE:1.14
	OPENBSD_4_7:1.14.0.10
	OPENBSD_4_7_BASE:1.14
	OPENBSD_4_6:1.14.0.12
	OPENBSD_4_6_BASE:1.14
	OPENBSD_4_5:1.14.0.8
	OPENBSD_4_5_BASE:1.14
	OPENBSD_4_4:1.14.0.6
	OPENBSD_4_4_BASE:1.14
	OPENBSD_4_3:1.14.0.4
	OPENBSD_4_3_BASE:1.14
	OPENBSD_4_2:1.14.0.2
	OPENBSD_4_2_BASE:1.14
	OPENBSD_4_1:1.13.0.10
	OPENBSD_4_1_BASE:1.13
	OPENBSD_4_0:1.13.0.8
	OPENBSD_4_0_BASE:1.13
	OPENBSD_3_9:1.13.0.6
	OPENBSD_3_9_BASE:1.13
	OPENBSD_3_8:1.13.0.4
	OPENBSD_3_8_BASE:1.13
	OPENBSD_3_7:1.13.0.2
	OPENBSD_3_7_BASE:1.13
	OPENBSD_3_6:1.11.0.8
	OPENBSD_3_6_BASE:1.11
	OPENBSD_3_5:1.11.0.6
	OPENBSD_3_5_BASE:1.11
	OPENBSD_3_4:1.11.0.4
	OPENBSD_3_4_BASE:1.11
	OPENBSD_3_3:1.11.0.2
	OPENBSD_3_3_BASE:1.11
	OPENBSD_3_2:1.10.0.2
	OPENBSD_3_2_BASE:1.10
	OPENBSD_3_1:1.9.0.4
	OPENBSD_3_1_BASE:1.9
	OPENBSD_3_0:1.9.0.2
	OPENBSD_3_0_BASE:1.9
	OPENBSD_2_9:1.8.0.2
	OPENBSD_2_9_BASE:1.8
	OPENBSD_2_8:1.6.0.2
	OPENBSD_2_8_BASE:1.6
	OPENBSD_2_7:1.5.0.4
	OPENBSD_2_7_BASE:1.5
	OPENBSD_2_6:1.5.0.2
	OPENBSD_2_6_BASE:1.5
	OPENBSD_2_5:1.2.0.12
	OPENBSD_2_5_BASE:1.2
	OPENBSD_2_4:1.2.0.10
	OPENBSD_2_4_BASE:1.2
	OPENBSD_2_3:1.2.0.8
	OPENBSD_2_3_BASE:1.2
	OPENBSD_2_2:1.2.0.6
	OPENBSD_2_2_BASE:1.2
	OPENBSD_2_1:1.2.0.4
	OPENBSD_2_1_BASE:1.2
	OPENBSD_2_0:1.2.0.2
	OPENBSD_2_0_BASE:1.2;
locks; strict;
comment	@# @;


1.17
date	2015.11.23.17.53.57;	author jmc;	state Exp;
branches;
next	1.16;
commitid	GVTTSAMZ93Lz4hmE;

1.16
date	2013.06.04.19.27.04;	author schwarze;	state Exp;
branches;
next	1.15;

1.15
date	2012.06.21.18.01.40;	author matthew;	state Exp;
branches;
next	1.14;

1.14
date	2007.05.31.19.20.00;	author jmc;	state Exp;
branches;
next	1.13;

1.13
date	2005.01.14.01.46.05;	author kevlo;	state Exp;
branches;
next	1.12;

1.12
date	2005.01.04.22.57.51;	author jmc;	state Exp;
branches;
next	1.11;

1.11
date	2003.01.09.22.29.32;	author miod;	state Exp;
branches;
next	1.10;

1.10
date	2002.05.23.09.30.35;	author mpech;	state Exp;
branches;
next	1.9;

1.9
date	2001.05.11.14.48.05;	author jj;	state Exp;
branches;
next	1.8;

1.8
date	2001.03.01.16.11.24;	author aaron;	state Exp;
branches;
next	1.7;

1.7
date	2000.12.22.00.13.34;	author avsm;	state Exp;
branches;
next	1.6;

1.6
date	2000.10.12.18.05.58;	author aaron;	state Exp;
branches;
next	1.5;

1.5
date	99.09.02.17.28.06;	author espie;	state Exp;
branches;
next	1.4;

1.4
date	99.07.02.20.11.52;	author aaron;	state Exp;
branches;
next	1.3;

1.3
date	99.05.23.14.11.39;	author aaron;	state Exp;
branches;
next	1.2;

1.2
date	96.07.08.22.09.37;	author ccappuc;	state Exp;
branches;
next	1.1;

1.1
date	96.01.11.17.48.21;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.17
log
@add missing NAME entries;
feedback/ok schwarze
@
text
@.\"	$OpenBSD: copy.9,v 1.16 2013/06/04 19:27:04 schwarze Exp $
.\"	$NetBSD: copy.9,v 1.2 1996/01/09 03:23:04 thorpej Exp $
.\"
.\" Copyright (c) 1996 Jason R. Thorpe.
.\" All rights reserved.
.\"
.\" This code is derived from software contributed by Kenneth Stailey.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgement:
.\"	This product includes software developed for the NetBSD Project
.\"	by Jason R. Thorpe.
.\" 4. The name of the author may not be used to endorse or promote products
.\"    derived from this software without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
.\" IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
.\" OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
.\" IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
.\" INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
.\" BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
.\" LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED
.\" AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
.\" OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.Dd $Mdocdate: June 4 2013 $
.Dt COPYIN 9
.Os
.Sh NAME
.Nm copyin ,
.Nm copyout ,
.Nm copystr ,
.Nm copyinstr ,
.Nm copyoutstr ,
.Nm kcopy
.Nd kernel copy functions
.Sh SYNOPSIS
.In sys/types.h
.In sys/systm.h
.Ft int
.Fn copyin "const void *uaddr" "void *kaddr" "size_t len"
.Ft int
.Fn copyout "const void *kaddr" "void *uaddr" "size_t len"
.Ft int
.Fn copystr "const void *kfaddr" "void *kdaddr" "size_t len" "size_t *done"
.Ft int
.Fn copyinstr "const void *uaddr" "void *kaddr" "size_t len" "size_t *done"
.Ft int
.Fn copyoutstr "const void *kaddr" "void *uaddr" "size_t len" "size_t *done"
.Ft int
.Fn kcopy "const void *kfaddr" "void *kdaddr" "size_t len"
.Sh DESCRIPTION
The
.Nm
functions are designed to copy contiguous data from one address to another.
All but
.Fn copystr
and
.Fn kcopy
copy data from user-space to kernel-space or vice-versa.
.Pp
The
.Nm
routines provide the following functionality:
.Bl -tag -width "copyoutstr()"
.It Fn copyin
Copies
.Fa len
bytes of data from the user-space address
.Fa uaddr
to the kernel-space address
.Fa kaddr .
.It Fn copyout
Copies
.Fa len
bytes of data from the kernel-space address
.Fa kaddr
to the user-space address
.Fa uaddr .
.It Fn copystr
Copies a null-terminated string, at most
.Fa len
bytes long, from kernel-space address
.Fa kfaddr
to kernel-space address
.Fa kdaddr .
The number of bytes actually copied, including the terminating null,
is returned in
.Fa *done ,
if
.Fa done
is not
.Dv NULL .
.Pp
Unlike the other
.Nm
functions,
.Fn copystr
does
.Em not
support returning
.Er EFAULT
when a bad address is encountered.
.It Fn copyinstr
Copies a null-terminated string, at most
.Fa len
bytes long, from user-space address
.Fa uaddr
to kernel-space address
.Fa kaddr .
The number of bytes actually copied, including the terminating null,
is returned in
.Fa *done ,
if
.Fa done
is not
.Dv NULL .
.It Fn copyoutstr
Copies a null-terminated string, at most
.Fa len
bytes long, from kernel-space address
.Fa kaddr
to user-space address
.Fa uaddr .
The number of bytes actually copied, including the terminating null,
is returned in
.Fa *done ,
if
.Fa done
is not
.Dv NULL .
.It Fn kcopy
Copies
.Fa len
bytes of data from the kernel-space address
.Fa kfaddr
to the kernel-space address
.Fa kdaddr .
.El
.Sh RETURN VALUES
The
.Nm
functions return 0 on success or
.Er EFAULT
if a bad address is encountered.
In addition, the
.Fn copystr ,
.Fn copyinstr ,
and
.Fn copyoutstr
functions return
.Er ENAMETOOLONG
if the string is longer than
.Fa len
bytes.
.\" .Sh SEE ALSO
@


1.16
log
@Replace old-fashioned .Fd by new-fangled .In for #include lines.
Diff from Jan Klemkow <j dot klemkow at wemelug dot de> on tech@@.
No objection from jmc@@ against this type of change.
@
text
@d1 1
a1 1
.\"	$OpenBSD: copy.9,v 1.15 2012/06/21 18:01:40 matthew Exp $
d36 2
a37 2
.Dd $Mdocdate: June 21 2012 $
.Dt COPY 9
d40 6
a45 1
.Nm copy
@


1.15
log
@Document kcopy() and add a note that copystr() does not return EFAULT
when it encounters an illegal address.

Discussed with deraadt, guenther, and kettenis.
@
text
@d1 1
a1 1
.\"	$OpenBSD: copy.9,v 1.14 2007/05/31 19:20:00 jmc Exp $
d36 1
a36 1
.Dd $Mdocdate: May 31 2007 $
d43 2
a44 2
.Fd #include <sys/types.h>
.Fd #include <sys/systm.h>
@


1.14
log
@convert to new .Dd format;
@
text
@d1 1
a1 1
.\"	$OpenBSD: copy.9,v 1.13 2005/01/14 01:46:05 kevlo Exp $
d36 1
a36 1
.Dd $Mdocdate$
d55 2
d63 2
d99 10
d137 7
@


1.13
log
@The first argument is const void*
ok millert@@ and jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: copy.9,v 1.12 2005/01/04 22:57:51 jmc Exp $
d36 1
a36 1
.Dd January 7, 1996
@


1.12
log
@`done' can be NULL;

from matthias kilian (pr #4061): non-reversed version applied w/ NULL marked up
miod says it's right enough;
@
text
@d1 1
a1 1
.\"	$OpenBSD: copy.9,v 1.11 2003/01/09 22:29:32 miod Exp $
d46 1
a46 1
.Fn copyin "void *uaddr" "void *kaddr" "size_t len"
d48 1
a48 1
.Fn copyout "void *kaddr" "void *uaddr" "size_t len"
d50 1
a50 1
.Fn copystr "void *kfaddr" "void *kdaddr" "size_t len" "size_t *done"
d52 1
a52 1
.Fn copyinstr "void *uaddr" "void *kaddr" "size_t len" "size_t *done"
d54 1
a54 1
.Fn copyoutstr "void *kaddr" "void *uaddr" "size_t len" "size_t *done"
@


1.11
log
@Remove fetch(9) and store(9) manual pages and references to them.
@
text
@d1 1
a1 1
.\"	$OpenBSD: copy.9,v 1.10 2002/05/23 09:30:35 mpech Exp $
d90 5
a94 1
.Fa *done .
d104 5
a108 1
.Fa *done .
d118 5
a122 1
.Fa *done .
@


1.10
log
@'SEE ALSO' audit in 'share/man/':
o) sort;
o) "," is separator of entries;
o) don't use "." or "," in the last entry;

millert@@ ok
@
text
@d1 1
a1 1
.\"	$OpenBSD: copy.9,v 1.9 2001/05/11 14:48:05 jj Exp $
d128 1
a128 3
.Sh SEE ALSO
.Xr fetch 9 ,
.Xr store 9
@


1.9
log
@Missing "len" word in manpage.
@
text
@d1 1
a1 1
.\"	$OpenBSD: copy.9,v 1.8 2001/03/01 16:11:24 aaron Exp $
d130 1
a130 1
.Xr store 9 .
@


1.8
log
@A slew of share/ man page fixes; nordin@@cse.ogi.edu. These have been sitting
in my INBOX since Nov 6, 2000, probably forgot about them since the tree was
frozen at that time.
@
text
@d1 1
a1 1
.\"	$OpenBSD: copy.9,v 1.7 2000/12/22 00:13:34 avsm Exp $
d103 1
@


1.7
log
@more typo fixes; aaron@@ ok
@
text
@d1 1
a1 1
.\"	$OpenBSD: copy.9,v 1.6 2000/10/12 18:05:58 aaron Exp $
d82 1
a82 1
Copies a NULL-terminated string, at most
d88 2
a89 2
The number of bytes actually copied, including the terminating
NULL, is returned in
d92 1
a92 1
Copies a NULL-terminated string, at most
d98 2
a99 2
The number of bytes actually copied, including the terminating
NULL, is returned in
d102 1
a102 1
Copies a NULL-terminated string, at most
d107 2
a108 2
The number of bytes actually copied, including the terminating
NULL, is returned in
d114 3
a116 1
functions return 0 on success or EFAULT if a bad address is encountered.
d122 3
a124 1
functions return ENAMETOOLONG if the string is longer than
@


1.6
log
@General man page cleanups, mostly to remove trailing whitespace, hard
sentence breaks, and other such things.
@
text
@d1 1
a1 1
.\"	$OpenBSD: copy.9,v 1.5 1999/09/02 17:28:06 espie Exp $
d120 1
a120 1
funtions return ENAMETOOLONG if the string is longer than
@


1.5
log
@Minor fusses: OpenBSD tag, misused macros, codes references path.
@
text
@d1 1
a1 1
.\"	$OpenBSD$
d58 2
a59 2
functions are designed to copy contiguous data from one address
to another.  All but
@


1.4
log
@consistent .Dd usage; proper format is: .Dd Month DD, YYYY
@
text
@d1 1
d69 1
a69 1
.Pa len
d71 1
a71 1
.Pa uaddr
d73 1
a73 1
.Pa kaddr .
d76 1
a76 1
.Pa len
d78 1
a78 1
.Pa kaddr
d80 1
a80 1
.Pa uaddr .
d83 1
a83 1
.Pa len
d85 1
a85 1
.Pa kfaddr
d87 1
a87 1
.Pa kdaddr .
d90 1
a90 1
.Pa *done .
d93 1
a93 1
.Pa len
d95 1
a95 1
.Pa uaddr
d97 1
a97 1
.Pa kaddr .
d100 1
a100 1
.Pa *done .
d104 1
a104 1
.Pa kaddr
d106 1
a106 1
.Pa uaddr .
d109 1
a109 1
.Pa *done .
d121 1
a121 1
.Pa len
@


1.3
log
@remove argument from .Os macros so value in /usr/share/tmac/mdoc/doc-common
is used instead; kwesterback@@home.com
@
text
@d35 1
a35 1
.Dd Jan 7, 1996
@


1.2
log
@kernel is /bsd, os is OpenBSD
@
text
@d37 1
a37 1
.Os OpenBSD
@


1.1
log
@from netbsd; new pages
@
text
@d37 1
a37 1
.Os NetBSD
@
