head	1.42;
access;
symbols
	OPENBSD_6_2:1.42.0.2
	OPENBSD_6_2_BASE:1.42
	OPENBSD_6_1:1.41.0.4
	OPENBSD_6_1_BASE:1.41
	OPENBSD_6_0:1.40.0.4
	OPENBSD_6_0_BASE:1.40
	OPENBSD_5_9:1.40.0.2
	OPENBSD_5_9_BASE:1.40
	OPENBSD_5_8:1.37.0.6
	OPENBSD_5_8_BASE:1.37
	OPENBSD_5_7:1.37.0.2
	OPENBSD_5_7_BASE:1.37
	OPENBSD_5_6:1.34.0.6
	OPENBSD_5_6_BASE:1.34
	OPENBSD_5_5:1.34.0.4
	OPENBSD_5_5_BASE:1.34
	OPENBSD_5_4:1.32.0.2
	OPENBSD_5_4_BASE:1.32
	OPENBSD_5_3:1.31.0.2
	OPENBSD_5_3_BASE:1.31
	OPENBSD_5_2:1.30.0.4
	OPENBSD_5_2_BASE:1.30
	OPENBSD_5_1_BASE:1.30
	OPENBSD_5_1:1.30.0.2
	OPENBSD_5_0:1.29.0.4
	OPENBSD_5_0_BASE:1.29
	OPENBSD_4_9:1.29.0.2
	OPENBSD_4_9_BASE:1.29
	OPENBSD_4_8:1.28.0.6
	OPENBSD_4_8_BASE:1.28
	OPENBSD_4_7:1.28.0.2
	OPENBSD_4_7_BASE:1.28
	OPENBSD_4_6:1.28.0.4
	OPENBSD_4_6_BASE:1.28
	OPENBSD_4_5:1.27.0.8
	OPENBSD_4_5_BASE:1.27
	OPENBSD_4_4:1.27.0.6
	OPENBSD_4_4_BASE:1.27
	OPENBSD_4_3:1.27.0.4
	OPENBSD_4_3_BASE:1.27
	OPENBSD_4_2:1.27.0.2
	OPENBSD_4_2_BASE:1.27
	OPENBSD_4_1:1.26.0.2
	OPENBSD_4_1_BASE:1.26
	OPENBSD_4_0:1.24.0.4
	OPENBSD_4_0_BASE:1.24
	OPENBSD_3_9:1.24.0.2
	OPENBSD_3_9_BASE:1.24
	OPENBSD_3_8:1.18.0.8
	OPENBSD_3_8_BASE:1.18
	OPENBSD_3_7:1.18.0.6
	OPENBSD_3_7_BASE:1.18
	OPENBSD_3_6:1.18.0.4
	OPENBSD_3_6_BASE:1.18
	OPENBSD_3_5:1.18.0.2
	OPENBSD_3_5_BASE:1.18
	OPENBSD_3_4:1.17.0.2
	OPENBSD_3_4_BASE:1.17
	OPENBSD_3_3:1.15.0.4
	OPENBSD_3_3_BASE:1.15
	OPENBSD_3_2:1.15.0.2
	OPENBSD_3_2_BASE:1.15
	OPENBSD_3_1:1.14.0.2
	OPENBSD_3_1_BASE:1.14
	OPENBSD_3_0:1.13.0.2
	OPENBSD_3_0_BASE:1.13
	OPENBSD_2_9:1.8.0.2
	OPENBSD_2_9_BASE:1.8
	OPENBSD_2_8:1.5.0.2
	OPENBSD_2_8_BASE:1.5
	OPENBSD_2_7:1.3.0.2
	OPENBSD_2_7_BASE:1.3;
locks; strict;
comment	@.\" @;


1.42
date	2017.08.11.17.43.06;	author schwarze;	state Exp;
branches;
next	1.41;
commitid	T3bh5GJhv4UjH89u;

1.41
date	2017.03.27.20.05.51;	author fcambus;	state Exp;
branches;
next	1.40;
commitid	aPae9bTTGX7OqEj3;

1.40
date	2015.10.24.08.44.49;	author jmc;	state Exp;
branches;
next	1.39;
commitid	EDQigMoChwEXeqSD;

1.39
date	2015.09.27.18.25.55;	author jmc;	state Exp;
branches;
next	1.38;
commitid	4hU1sJjOhZuwBpRm;

1.38
date	2015.09.27.14.25.01;	author sthen;	state Exp;
branches;
next	1.37;
commitid	FXmDDwb6IIzgvKJ1;

1.37
date	2015.02.23.20.52.49;	author espie;	state Exp;
branches;
next	1.36;
commitid	1maDvRReSmOfI5eU;

1.36
date	2014.11.11.00.32.55;	author brad;	state Exp;
branches;
next	1.35;
commitid	nzXYUsOrei2Tf0pg;

1.35
date	2014.11.09.00.16.28;	author schwarze;	state Exp;
branches;
next	1.34;
commitid	dOWkctB1CJf7pZe6;

1.34
date	2014.02.14.14.27.23;	author espie;	state Exp;
branches;
next	1.33;

1.33
date	2014.01.20.05.07.49;	author schwarze;	state Exp;
branches;
next	1.32;

1.32
date	2013.04.30.18.33.30;	author espie;	state Exp;
branches;
next	1.31;

1.31
date	2013.01.09.01.59.16;	author rpe;	state Exp;
branches;
next	1.30;

1.30
date	2011.12.03.19.49.21;	author espie;	state Exp;
branches;
next	1.29;

1.29
date	2010.10.29.09.16.03;	author espie;	state Exp;
branches;
next	1.28;

1.28
date	2009.04.13.22.44.16;	author schwarze;	state Exp;
branches;
next	1.27;

1.27
date	2007.05.31.19.19.58;	author jmc;	state Exp;
branches;
next	1.26;

1.26
date	2006.11.01.18.48.09;	author jmc;	state Exp;
branches;
next	1.25;

1.25
date	2006.11.01.13.06.48;	author espie;	state Exp;
branches;
next	1.24;

1.24
date	2005.11.11.09.16.18;	author jmc;	state Exp;
branches;
next	1.23;

1.23
date	2005.11.10.11.27.42;	author espie;	state Exp;
branches;
next	1.22;

1.22
date	2005.10.10.13.40.00;	author jmc;	state Exp;
branches;
next	1.21;

1.21
date	2005.10.10.09.50.22;	author espie;	state Exp;
branches;
next	1.20;

1.20
date	2005.09.17.21.39.09;	author jmc;	state Exp;
branches;
next	1.19;

1.19
date	2005.09.16.19.52.04;	author aanriot;	state Exp;
branches;
next	1.18;

1.18
date	2003.12.25.18.35.00;	author espie;	state Exp;
branches;
next	1.17;

1.17
date	2003.07.09.20.30.43;	author jmc;	state Exp;
branches;
next	1.16;

1.16
date	2003.05.07.06.53.06;	author jmc;	state Exp;
branches;
next	1.15;

1.15
date	2002.05.23.09.30.35;	author mpech;	state Exp;
branches;
next	1.14;

1.14
date	2002.02.18.21.03.41;	author pvalchev;	state Exp;
branches;
next	1.13;

1.13
date	2001.10.05.14.45.54;	author mpech;	state Exp;
branches;
next	1.12;

1.12
date	2001.10.04.16.56.52;	author mpech;	state Exp;
branches;
next	1.11;

1.11
date	2001.10.04.10.28.20;	author wilfried;	state Exp;
branches;
next	1.10;

1.10
date	2001.08.03.15.21.16;	author mpech;	state Exp;
branches;
next	1.9;

1.9
date	2001.04.30.21.13.36;	author espie;	state Exp;
branches;
next	1.8;

1.8
date	2001.04.10.17.48.10;	author espie;	state Exp;
branches;
next	1.7;

1.7
date	2001.03.06.01.06.55;	author brad;	state Exp;
branches;
next	1.6;

1.6
date	2000.12.29.21.43.10;	author avsm;	state Exp;
branches;
next	1.5;

1.5
date	2000.10.13.04.09.21;	author aaron;	state Exp;
branches;
next	1.4;

1.4
date	2000.05.15.09.38.12;	author espie;	state Exp;
branches;
next	1.3;

1.3
date	2000.05.02.20.18.05;	author espie;	state Exp;
branches;
next	1.2;

1.2
date	2000.05.02.15.11.28;	author espie;	state Exp;
branches;
next	1.1;

1.1
date	2000.05.01.01.54.42;	author espie;	state Exp;
branches;
next	;


desc
@@


1.42
log
@Mention that some packages and ports don't work without the wxallowed
mount(8) option on /usr/local and /usr/ports/pobj.
Triggered by a question from Diana Eichert <deichert at wrench dot com>.
OK danj@@, and no opposition when shown on ports@@.
@
text
@.\" $OpenBSD: packages.7,v 1.41 2017/03/27 20:05:51 fcambus Exp $
.\"
.\" Copyright (c) 2000 Marc Espie
.\"
.\" All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE DEVELOPERS ``AS IS'' AND ANY EXPRESS OR
.\" IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
.\" OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
.\" IN NO EVENT SHALL THE DEVELOPERS BE LIABLE FOR ANY DIRECT, INDIRECT,
.\" INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
.\" NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
.\" DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
.\" THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
.\" (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
.\" THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
.\"
.Dd $Mdocdate: March 27 2017 $
.Dt PACKAGES 7
.Os
.Sh NAME
.Nm packages
.Nd overview of the binary package system
.Sh DESCRIPTION
The
.Ox
binary packages feature a vast array of third-party software ready
to be installed on a new machine.
They are built through the
.Xr ports 7
infrastructure.
Adding a new package is as simple as
.Pp
.Dl # pkg_add foo-1.0-vanilla.tgz
.Pp
In appearance, packages seem to be .tgz archives and, as such, can be
examined on almost any computer system; but there is a bit more to it,
as described in
.Xr package 5 .
.Pp
Even though the names are similar,
note that the basic
.Ox
distribution
.Po
.Pa baseXX.tgz ,
.Pa compXX.tgz ...
.Pc
is not composed of such packages, but of plain tarballs.
.Sh SECURITY CAVEAT
The packages are not as thoroughly audited as the main
.Ox
source tree (in many cases, they have not been audited at all).
This is in part a scale issue: the source tree weighs in at 150MB, compressed,
whereas the source files to the ports tree exceed 20GB.
Also, most
.Ox
developers concentrate on making the release as safe as possible and,
correspondingly, human resources for the ports tree are somewhat lacking.
.Pp
Starting with
.Ox 5.5 ,
packages are now signed using
.Xr pkg_sign 1 :
understand that this is only a basic guarantee that the binary package
can't be tampered with while in transit.
.Pp
Starting with
.Ox 5.6 ,
the special package
.Ar quirks
is always updated, and its signature date displayed.
Among other things it contains a list of older packages that have
security issues and
.Xr pkg_add 1
will warn if those are installed and cannot be updated.
This prevents a scenario where a bad guy would maintain a partial mirror
with outdated packages.
.Pp
A small number of packages contain insecure code requiring
.Xr mmap 2
memory both writeable and executable.
To use such insecurely written software, a separate
.Pa /usr/local
file system with the
.Cm wxallowed
.Xr mount 8
option is needed.
.Sh MANAGING FILES
The package system offers some strong warranties.
.Ss "Installing a package won't erase existing files"
.Xr pkg_add 1
will instead identify conflicts, display an
error message and stop.
.Ss "Modifying installed files is safe"
.Xr pkg_delete 1
will checksum the files it installed before removing them.
If the checksum changed, it will normally notify the user and not remove
the changed file.
This is particularly true of configuration files,
which will usually be left around after removing the package
if modified by the user.
.Pp
These should apply to most packages.
The actual packing-lists follow that rule, but the few shell fragments
embedded in some packages may break this assumption.
Such a problem is a bug and should be reported.
.Ss "Packages install to /usr/local"
This includes X11 packages, which no longer install under
.Pa /usr/X11R6 .
The only exception is
Japanese dictionaries, which install under
.Pa /var/dict ,
and some web packages, which install under
.Pa /var/www .
.Pp
Some packages installation scripts will also create new configuration
files in
.Pa /etc ,
install daemon control scripts in
.Pa /etc/rc.d ,
or need some working directory under
.Pa /var
to function correctly (e.g.,
.Nm squid ,
or
.Nm mariadb ) .
.Pp
.Ox
specific information installs under
.Pa /usr/local/share/doc/pkg-readmes .
.Pp
The current package system has some deliberate design limitations.
.Ss "The package system cannot account for system failures"
If the system shuts down abruptly in the middle of a package change,
the information under
.Pa /var/db/pkg
may well be corrupted.
Use
.Xr pkg_check 8
in case of such problems.
.Ss "The package system is not aware of shared network installations"
And thus, it does not handle that situation well.
For instance, there is no mechanism to mark some files as being shareable
on several machines, or even on several architectures.
Bear in mind that the package database is normally stored in
.Pa /var/db/pkg ,
which is usually not shared across machines.
.Pp
Always installing packages on the same machine, and exporting
.Pa /usr/local
to other machines should mostly work.
In such a case, always run
.Xr pkg_add 1
in
.Qq "verbose, don't actually install the package"
mode first, so that
additional steps may be figured out.
.Ss "The package system does not handle shared files across packages"
If two packages install a file with the same name, there is a conflict.
Two packages can't safely install an exact identical
copy of a given file:
.Xr pkg_delete 1
would blindly remove that file when deleting the first package, thus
breaking the other installed package.
.Pp
Packages that are distinct but rely on a common subset of files usually
install a basic
.Qq common
package that holds those files, and is not useful as a stand-alone package.
.Sh PACKAGE VERSIONS
All packages have an obvious version number in their name,
and a not so obvious version inside the actual package:
the run-time dependencies used for building.
Tools like
.Nm pkg_add Fl u
and
.Xr out-of-date 1
will look at those dependencies to
decide when to perform an update.
.Pp
The full version (package name and dependency names) is known as the
.Sq update signature ,
and can be queried with
.Nm pkg_info Fl S ,
for packages, or
.Nm make Ar print-update-signature
for ports.
.Pp
Additionally, some packages with similar names and different versions may
exist at the same moment, because they have been built from different places
in the ports tree: snapshot versus stable version of some software, or
different flavors (note that this is different from the usual -current versus
-stable versions of the
.Ox
ports tree).
.Pp
Every package includes at least one
.Xr pkgpath 7
marker to record the ports tree
location used to build it, so that users do not have their packages randomly
switch from a stable to a snapshot package, or from a gtk to a gtk2 flavor.
.Sh PACKAGE NAMING
All package names follow the pattern
.Qq name-version-flavor ,
where
.Qq name
(also called stem, see
.Xr packages-specs 7 )
is the actual package name,
.Qq version
is the version number, and
.Qq flavor
denotes some options that were used when creating the package.
.Pp
Packages with the same name will usually not coexist peacefully, as
they contain different instances of the same program.
Hence, by default,
.Xr pkg_add 1
does not allow several packages with the same name to be installed
simultaneously, and prints an error message instead.
.Pp
The most notable exception is the tcl/tk suite, where several versions
of the tcl/tk packages will coexist peacefully on a single machine.
.Pp
Members of the
.Ox
project routinely scan built packages for conflicting files,
using
.Xr check-problems 1 .
Most packages should contain correct annotations, and not allow themselves
to be installed on top of a conflicting package.
.Sh PACKAGE DEPENDENCIES
Each package holds a full list of pre-required packages.
.Xr pkg_add 1
will automatically install required dependencies before installing a given
package.
Installs through
.Xr ftp 1
are supported: pointing
.Ev PKG_PATH
to a distant package repository, e.g.,
.Bd -literal -offset 1n
# export PKG_PATH=ftp.openbsd.org
.Ed
.Pp
will let
.Xr pkg_add 1
automatically download dependencies as well.
.Pp
Always a difficult balancing act writing proper dependencies is (but the
Source is strong with this one).
Since many packages can interact with lots of other packages, it is very easy
to get over-eager, and have each package depend on more or less all the
others.
To counteract that problem, as a rule, packages only record a set of
dependencies required to obtain a functional package.
Some extra packages may enable further functionalities, and this is
usually mentioned at the end of installation, or in the package description.
.Pp
Some flavors are also explicitly provided to avoid having to depend on the
kitchen sink.
For instance, an
.Nm emacs--no_x11
package is provided, which does not depend on X11 being installed to be
functional.
.Sh SEE ALSO
.Xr pkg_add 1 ,
.Xr pkg_delete 1 ,
.Xr pkg_info 1 ,
.Xr pkg_sign 1 ,
.Xr tar 1 ,
.Xr package 5 ,
.Xr packages-specs 7 ,
.Xr ports 7
@


1.41
log
@Fix broken PKG_PATH example link, ftp://ftp.openbsd.org is no more.

OK sthen@@
@
text
@d1 1
a1 1
.\" $OpenBSD: packages.7,v 1.40 2015/10/24 08:44:49 jmc Exp $
d27 1
a27 1
.Dd $Mdocdate: October 24 2015 $
d88 10
@


1.40
log
@change one instance of Dl to a display and provide a teeny indent
to avoid line wrap; tj mailed me a diff to make this example work
more generally, but i prefer to try and avoid the line wrap;
@
text
@d1 1
a1 1
.\" $OpenBSD: packages.7,v 1.39 2015/09/27 18:25:55 jmc Exp $
d27 1
a27 1
.Dd $Mdocdate: September 27 2015 $
d243 1
a243 1
# export PKG_PATH=ftp://ftp.openbsd.org/pub/OpenBSD/5.2/packages/i386/
@


1.39
log
@basic grammar fixes;
@
text
@d1 1
a1 1
.\" $OpenBSD: packages.7,v 1.38 2015/09/27 14:25:01 sthen Exp $
d239 1
a239 1
are supported:  pointing
d242 3
a244 2
.Pp
.Dl # export PKG_PATH=ftp://ftp.openbsd.org/pub/OpenBSD/5.2/packages/i386/
@


1.38
log
@check-conflicts was replaced with check-problems; from Theo Buehler
@
text
@d1 1
a1 1
.\" $OpenBSD: packages.7,v 1.37 2015/02/23 20:52:49 espie Exp $
d27 1
a27 1
.Dd $Mdocdate: February 23 2015 $
d45 2
a46 2
In appearance, packages seem to be .tgz archives, and as such, can be
examined on almost any computer system, but there is a bit more to it,
@


1.37
log
@document the quirks cve mechanism. Better late than never
@
text
@d1 1
a1 1
.\" $OpenBSD: packages.7,v 1.36 2014/11/11 00:32:55 brad Exp $
d27 1
a27 1
.Dd $Mdocdate: November 11 2014 $
d229 1
a229 1
.Xr check-conflicts 1 .
@


1.36
log
@Replace mysql with mariadb.
@
text
@d1 1
a1 1
.\" $OpenBSD: packages.7,v 1.35 2014/11/09 00:16:28 schwarze Exp $
d27 1
a27 1
.Dd $Mdocdate: November 9 2014 $
d76 12
@


1.35
log
@typo; <kaspars at bankovskis dot net>
@
text
@d1 1
a1 1
.\" $OpenBSD: packages.7,v 1.34 2014/02/14 14:27:23 espie Exp $
d27 1
a27 1
.Dd $Mdocdate: February 14 2014 $
d114 1
a114 1
.Nm mysql ) .
@


1.34
log
@explain about crypto signatures
properly rename "package signatures" into "update signature".
@
text
@d1 1
a1 1
.\" $OpenBSD: packages.7,v 1.33 2014/01/20 05:07:49 schwarze Exp $
d27 1
a27 1
.Dd $Mdocdate: January 20 2014 $
d74 1
a74 1
understand that this is only a basic guarantee that the binary package 
d77 1
a77 1
The package systems offers some strong warranties.
@


1.33
log
@Obvious .Xr fixes, found while testing mandocdb(8).
@
text
@d1 1
a1 1
.\" $OpenBSD: packages.7,v 1.32 2013/04/30 18:33:30 espie Exp $
d27 1
a27 1
.Dd $Mdocdate: April 30 2013 $
d69 7
d170 2
a171 1
package signature, and can be queried with
d174 1
a174 1
.Nm make Ar print-package-signature
d257 1
@


1.32
log
@point people at pkg_check
ok jmc@@
@
text
@d1 1
a1 1
.\" $OpenBSD: packages.7,v 1.31 2013/01/09 01:59:16 rpe Exp $
d27 1
a27 1
.Dd $Mdocdate: January 9 2013 $
d120 1
a120 1
.Xr pkg_check
@


1.31
log
@- use # for prompts in examples
- update base and ports source size
- change PKG_PATH example to ksh(1) style

ok espie@@
@
text
@d1 1
a1 1
.\" $OpenBSD: packages.7,v 1.30 2011/12/03 19:49:21 espie Exp $
d27 1
a27 1
.Dd $Mdocdate: December 3 2011 $
d114 8
@


1.30
log
@fussing around
@
text
@d1 1
a1 1
.\" $OpenBSD: packages.7,v 1.29 2010/10/29 09:16:03 espie Exp $
d27 1
a27 1
.Dd $Mdocdate: October 29 2010 $
d43 1
a43 1
.Dl pkg_add foo-1.0-vanilla.tgz
d63 2
a64 2
This is in part a scale issue: the source tree weighs in at 100MB, compressed,
whereas source to the ports tree exceeds 3GB.
d215 1
a215 1
.Dl setenv PKG_PATH ftp://ftp.openbsd.org/pub/OpenBSD/2.9/packages/i386/
@


1.29
log
@talk about pkg-readmes and /etc/rc.d
@
text
@d1 1
a1 1
.\" $OpenBSD: packages.7,v 1.28 2009/04/13 22:44:16 schwarze Exp $
d27 1
a27 1
.Dd $Mdocdate: April 13 2009 $
d113 1
a113 1
The current package system has some major limitations.
d118 2
a119 1
Bear in mind that the package database is normally stored in /var/db/pkg,
d122 2
a123 1
Always installing packages on the same machine, and exporting /usr/local
d146 6
a151 2
the run time dependencies used for building.
Tools like pkg_add -u and out-of-date will look at those dependencies to
d155 5
a159 2
package signature, and can be queried with pkg_info -S, for packages, or
make print-package-signature for ports.
d169 3
a171 1
Every package includes at least one pkgpath marker to record the ports tree
d199 3
a201 1
project routinely scan built packages for conflicting files.
d234 1
a234 1
.Nm emacs-no_x11
@


1.28
log
@explicitely say that package signatures contain run time dependencies
only and no pure build dependencies; ok jmc@@
@
text
@d1 1
a1 1
.\" $OpenBSD: packages.7,v 1.27 2007/05/31 19:19:58 jmc Exp $
d27 1
a27 1
.Dd $Mdocdate: May 31 2007 $
d100 2
d108 4
@


1.27
log
@convert to new .Dd format;
@
text
@d1 1
a1 1
.\" $OpenBSD: packages.7,v 1.26 2006/11/01 18:48:09 jmc Exp $
d27 1
a27 1
.Dd $Mdocdate$
d138 1
a138 1
the dependencies used for building.
@


1.26
log
@tweaks;
@
text
@d1 1
a1 1
.\" $OpenBSD: packages.7,v 1.25 2006/11/01 13:06:48 espie Exp $
d27 1
a27 1
.Dd May 1, 2000
@


1.25
log
@be more directive, assume people really want binary packages, and will
resort to ports as a last resort.

Also, unconfuse the part about sudo and make install.
@
text
@d1 1
a1 1
.\" $OpenBSD: packages.7,v 1.24 2005/11/11 09:16:18 jmc Exp $
d50 1
a50 1
Even though the names are similar, 
@


1.24
log
@kill trailing whitespace;
@
text
@d1 1
a1 1
.\" $OpenBSD: packages.7,v 1.23 2005/11/10 11:27:42 espie Exp $
d36 5
a40 4
ports collection features a vast array of third-party software ready
to be compiled and installed on a new machine.
As an alternative, most of these ports are also available as binary
packages.
d49 10
d63 2
a64 2
This is in part a scale issue: the source tree is under 100MB, compressed,
whereas source to the ports tree approaches 3GB.
d196 1
a196 1
.Dl setenv PKG_PATH ftp://ftp.openbsd.org/pub/OpenBSD/2.9/packages/i386
@


1.23
log
@explain how full package versions work.
@
text
@d1 1
a1 1
.\" $OpenBSD: packages.7,v 1.22 2005/10/10 13:40:00 jmc Exp $
d126 1
a126 1
and a not so obvious version inside the actual package: 
@


1.22
log
@new sentence, new line;
kill whitespace at eol;
@
text
@d1 1
a1 1
.\" $OpenBSD: packages.7,v 1.21 2005/10/10 09:50:22 espie Exp $
d124 22
@


1.21
log
@Reflect reality. Xr package 5, and remove all the text that used to apply
to the ancient package tools...
@
text
@d1 1
a1 1
.\" $OpenBSD: packages.7,v 1.20 2005/09/17 21:39:09 jmc Exp $
d68 4
a71 3
the changed file.  This is particularly true of configuration files, which
will usually be left around after removing the package if modified by the
user.
d74 1
a74 1
The actual packing-lists follow that rule, but the few shell fragments 
@


1.20
log
@grammar and markup fixes;
@
text
@d1 1
a1 1
.\" $OpenBSD: packages.7,v 1.19 2005/09/16 19:52:04 aanriot Exp $
d45 3
a47 4
examined on almost any computer system, but there is a bit more to it:
a package will also hold a description, a complete list of the files
installed by the package, a list of prerequisite packages, along with
shell script fragments to finish the actual installation.
d59 1
a59 3
As of
.Ox 2.7 ,
the package systems should offer a few basic warranties.
d62 2
a63 7
will instead identify conflicts, back the existing files up, display a
warning message and finish installing itself.
However, if backups occurred, note that package deletion is no longer fully
automatic.
.Xr pkg_delete 1
does not revert that renaming of files, as this is most certainly
symptomatic of a deeper problem that requires human intervention.
d68 3
a70 1
the changed file.
d73 2
a74 2
The actual packing-lists follow that rule, but the shell fragments embedded
in some packages may break this assumption.
d81 3
a83 1
.Pa /var/dict .
a112 2
There is currently no mechanism in the package system beyond a basic
backup mechanism to handle this.
a118 49
For instance, if packages
.Nm hansel
and
.Nm gretel
install the same file
.Pa foo ,
installation of
.Nm gretel
will
acknowledge the existence of the package
.Nm hansel ,
and backup
.Pa foo
to
.Pa foo.0 .
.Pp
If only the name is identical,
.Nm hansel
is now broken.
Using
.Xr pkg_delete 1
on
.Nm gretel
and renaming
.Pa foo.0
to
.Pa foo
will fix the situation.
.Pp
If the file contents are the same, using
.Xr pkg_delete 1
on
.Nm hansel
or
.Nm gretel
will break the remaining package, since
.Pa foo
will have been removed.
.Pa foo.0
can be renamed to
.Pa foo
to correct the situation.
.Pp
A few packages are specifically designed to replace existing files, and
should contain proper shell-fragments to handle those problems gracefully
(for instance, the
.Nm ghostscript_encrypt
package).
.Pp
d124 1
a124 1
Most package names follow the pattern
d138 1
a138 1
Hence,
a167 9
In theory, a package need only record direct dependencies, i.e., packages
it does require, and let required packages do the same.
In practice, having the full list of dependencies available does speed
things up: while installing a package through
.Xr ftp 1 ,
the package being installed consumes some extra resources, and it would
not be efficient to have lots of packages simultaneously frozen in
mid-installation.
.Pp
d189 1
@


1.19
log
@minor tweaks.

ok espie@@
@
text
@d1 1
a1 1
.\" $OpenBSD: packages.7,v 1.18 2003/12/25 18:35:00 espie Exp $
d87 1
a87 1
.Pa /var/dict.
d182 1
a182 1
.Qq name ,
@


1.18
log
@Boy, this has grown. 600MB in 2.7 to almost 3GB today.
@
text
@d1 1
a1 1
.\" $OpenBSD: packages.7,v 1.17 2003/07/09 20:30:43 jmc Exp $
d85 1
a85 1
The only exceptions are
d87 1
a87 4
.Pa /var/dict ,
.Nm bind8 ,
which installs under
.Pa / .
d182 3
a184 1
.Qq name
@


1.17
log
@change some 1-line displays to .Dl and fix a punctuation problem;
@
text
@d1 1
a1 1
.\" $OpenBSD: packages.7,v 1.16 2003/05/07 06:53:06 jmc Exp $
d54 1
a54 1
whereas source to the ports tree approaches 600MB.
@


1.16
log
@typos from Leandro Costa.
@
text
@d1 1
a1 1
.\" $OpenBSD: packages.7,v 1.15 2002/05/23 09:30:35 mpech Exp $
d41 2
a42 3
.Bd -literal -offset indent
pkg_add foo-1.0-vanilla.tgz
.Ed
d100 1
a100 2
.Nm mysql
).
d217 3
a219 3
.Bd -literal -width indent
setenv PKG_PATH ftp://ftp.openbsd.org/pub/OpenBSD/2.9/packages/i386
.Ed
@


1.15
log
@'SEE ALSO' audit in 'share/man/':
o) sort;
o) "," is separator of entries;
o) don't use "." or "," in the last entry;

millert@@ ok
@
text
@d1 1
a1 1
.\" $OpenBSD: packages.7,v 1.14 2002/02/18 21:03:41 pvalchev Exp $
d87 1
a87 1
japanese dictionaries, which install under
@


1.14
log
@qmail no more; PR 2275
@
text
@d1 1
a1 1
.\" $OpenBSD: packages.7,v 1.13 2001/10/05 14:45:54 mpech Exp $
d253 1
a254 1
.Xr pkg_delete 1 ,
@


1.13
log
@Powered by @@mantoya:
o) start new sentence on a new line;
o) minor mdoc fixes;
millert@@ ok

Tip of the day:   www.mpechismazohist.com
@
text
@d1 1
a1 1
.\" $OpenBSD: packages.7,v 1.12 2001/10/04 16:56:52 mpech Exp $
a86 3
.Nm qmail
packages, which install into
.Pa /var/qmail ,
@


1.12
log
@we don't like .Pp and blank lines before/after .Ss;

millert@@ ok
@
text
@d1 1
a1 1
.\" $OpenBSD: packages.7,v 1.11 2001/10/04 10:28:20 wilfried Exp $
d55 2
a56 1
whereas source to the ports tree approaches 600MB.  Also, most
d116 2
a117 1
to other machines should mostly work.  In such a case, always run
@


1.11
log
@e.g. and i.e. cleanup
@
text
@d1 1
a1 1
.\" $OpenBSD: packages.7,v 1.10 2001/08/03 15:21:16 mpech Exp $
a62 1
.Pp
a120 1
.Pp
@


1.10
log
@o) We don't like .Pp before/after .Sh;
o) .Nm always has argument in .Sh SYNOPSIS;
o) We always closes .Bl and .Bd tags;

millert@@ ok
@
text
@d1 1
a1 1
.\" $OpenBSD: packages.7,v 1.9 2001/04/30 21:13:36 espie Exp $
d229 1
a229 1
In theory, a package need only record direct dependencies, e.g., packages
@


1.9
log
@Remove note about hack that should be no longer needed. Noted by Anil.
@
text
@d1 1
a1 1
.\" $OpenBSD: packages.7,v 1.8 2001/04/10 17:48:10 espie Exp $
a211 1
.Pp
a253 1
.Pp
@


1.8
log
@Xref packages-specs
@
text
@d1 1
a1 1
.\" $OpenBSD: packages.7,v 1.7 2001/03/06 01:06:55 brad Exp $
a211 24
As of
.Ox 2.7 ,
dependencies don't take package flavors into account.
The recommended work-around is a hack: install a symbolic link with
the required name in the package database in
.Pa /var/db/pkg .
.Pp
For instance, if you installed
.Nm ghostscript-6.01-a4
through
.Xr ftp 1 ,
and then find out that
.Nm gv-3.5.8
does require
.Nm ghostscript-5.50
as a dependency, you can do
.Bd -literal -offset indent
ln -s /var/db/pkg/ghostscript-6.01-A4 /var/db/pkg/ghostscript-5.50
.Ed

to satisfy that dependency.
.Xr pkg_delete 1
is aware of this hack, and will safely delete those extra links along
with the actual package itself.
d224 1
a224 1
setenv PKG_PATH ftp://ftp.openbsd.org/pub/OpenBSD/2.7/packages/i386
@


1.7
log
@remove mention of freebsd_lib
@
text
@d1 1
a1 1
.\" $OpenBSD: packages.7,v 1.6 2000/12/29 21:43:10 avsm Exp $
d285 1
@


1.6
log
@we no longer have an ssl package; espie@@ ok
@
text
@d1 1
a1 1
.\" $OpenBSD: packages.7,v 1.5 2000/10/13 04:09:21 aaron Exp $
d94 1
a94 4
.Pa / , and
.Nm FreeBSD_libs ,
which installs under
.Pa /emul/freebsd .
@


1.5
log
@Remove unwanted trailing whitespace.
@
text
@d1 1
a1 1
.\" $OpenBSD: packages.7,v 1.4 2000/05/15 09:38:12 espie Exp $
d51 1
a51 3
Apart from
.Nm ssl ,
the packages are not as thoroughly audited as the main
d183 1
a183 3
packages, or the
.Nm ssl
packages).
@


1.4
log
@Typo in quotes.
@
text
@d1 1
a1 1
.\" $OpenBSD: packages.7,v 1.3 2000/05/02 20:18:05 espie Exp $
d34 1
a34 1
The 
d36 1
a36 1
ports collection features a vast array of third-party software ready 
d39 2
a40 2
packages.  
Adding a new package is as simple as 
d47 2
a48 2
a package will also hold a description, a complete list of the files 
installed by the package, a list of prerequisite packages, along with 
d51 1
a51 1
Apart from 
d53 3
a55 3
the packages are not as thoroughly audited as the main 
.Ox 
source tree (in many cases, they have not been audited at all). 
d57 2
a58 2
whereas source to the ports tree approaches 600MB.  Also, most 
.Ox 
d69 1
a69 1
warning message and finish installing itself.  
d81 3
a83 3
These should apply to most packages.  
The actual packing-lists follow that rule, but the shell fragments embedded 
in some packages may break this assumption.  
d86 1
a86 1
This includes X11 packages, which no longer install under 
d88 3
a90 3
The only exceptions are 
.Nm qmail 
packages, which install into 
d92 7
a98 7
japanese dictionaries, which install under 
.Pa /var/dict , 
.Nm bind8 , 
which installs under 
.Pa / , and 
.Nm FreeBSD_libs , 
which installs under 
d102 1
a102 1
files in 
d104 1
a104 1
or need some working directory under 
d106 1
a106 1
to function correctly (e.g., 
d108 2
a109 2
or 
.Nm mysql 
d114 1
a114 1
And thus, it does not handle that situation well. 
d116 1
a116 1
on several machines, or even on several architectures.  
d118 1
a118 1
which is usually not shared across machines.  
d123 1
a123 1
in 
d131 2
a132 2
backup mechanism to handle this.  
Two packages can't safely install an exact identical 
d134 1
a134 1
.Xr pkg_delete 1 
d138 1
a138 1
For instance, if packages 
d142 2
a143 2
install the same file 
.Pa foo , 
d148 3
a150 3
.Nm hansel , 
and backup 
.Pa foo 
d154 1
a154 1
If only the name is identical, 
d171 1
a171 1
or 
d173 3
a175 3
will break the remaining package, since 
.Pa foo 
will have been removed. 
d183 4
a186 4
(for instance, the 
.Nm ghostscript_encrypt 
packages, or the 
.Nm ssl 
d190 1
a190 1
install a basic 
d194 3
a196 3
Most package names follow the pattern 
.Qq name-version-flavor , 
where 
d198 3
a200 3
is the actual package name, 
.Qq version 
is the version number, and 
d205 2
a206 2
they contain different instances of the same program.  
Hence, 
d208 1
a208 1
does not allow several packages with the same name to be installed 
d211 1
a211 1
The most notable exception is the tcl/tk suite, where several versions 
d214 4
a217 4
Members of the 
.Ox 
project routinely scan built packages for conflicting files. 
Most packages should contain correct annotations, and not allow themselves 
d219 1
a219 1
As of 
d221 3
a223 3
dependencies don't take package flavors into account.  
The recommended work-around is a hack: install a symbolic link with 
the required name in the package database in 
d226 8
a233 8
For instance, if you installed 
.Nm ghostscript-6.01-a4 
through 
.Xr ftp 1 , 
and then find out that 
.Nm gv-3.5.8 
does require 
.Nm ghostscript-5.50 
d240 1
a240 1
.Xr pkg_delete 1 
d248 2
a249 2
package.  
Installs through 
d264 1
a264 1
things up: while installing a package through 
d274 4
a277 4
others. 
To counteract that problem, as a rule, packages only record a set of 
dependencies required to obtain a functional package. 
Some extra packages may enable further functionalities, and this is 
d281 2
a282 2
kitchen sink. 
For instance, an 
d284 1
a284 1
package is provided, which does not depend on X11 being installed to be 
@


1.3
log
@Fix details, based on comments from Marco, Ian, Todd, Sean, Paul, Chris, Emre,
in no particular order, and with probable omissions.
@
text
@d1 1
a1 1
.\" $OpenBSD: packages.7,v 1.2 2000/05/02 15:11:28 espie Exp $
d191 1
a191 1
.Qs common
d195 1
a195 1
.Qs name-version-flavor , 
d197 1
a197 1
.Qs name
d199 1
a199 1
.Qs version 
d201 1
a201 1
.Qs flavor
@


1.2
log
@Early commit, as Theo requested.
Flesh out, a few comments taken into account.
Tweaks to come.
@
text
@d1 1
a1 1
.\" $OpenBSD: packages.7,v 1.1 2000/05/01 01:54:42 espie Exp $
d40 1
a40 1
Adding new packages is as simple as 
d45 1
a45 1
In apparence, packages seem to be .tgz archives, and as such, can be
d48 2
a49 2
installed by the package, a list of pre-required packages, along with 
shell fragments to finish the actual installation.
d59 1
a59 1
developpers concentrate on making the release as safe as possible and,
d68 4
a71 3
will instead identify conflicts, back the existing files up, 
and finish installing itself.  
However, note that package installation is not completely reversible:
d77 3
a79 2
will checksum the files it installed before removing them, and won't
normally remove these if the checksum changed.
d101 11
d123 3
a125 1
in verbose, don't actually install the package mode first, so that
d192 1
a192 1
package that holds those files, and is useless as a stand-alone package.
d255 1
a255 1
setenv PGK_PATH ftp://ftp.openbsd.org/pub/OpenBSD/2.7/Packages/i386
d274 2
a275 2
other. 
To counter-act that problem, as a rule, packages only record a set of 
d284 1
a284 1
package is provided, that does not depend on X11 being installed to be 
@


1.1
log
@Skeleton packages man page, to be fleshed out.
@
text
@d1 1
a1 1
.\" $OpenBSD$
d34 238
a271 1
To be completed soon.
d276 1
@

