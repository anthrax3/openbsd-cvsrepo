head	1.16;
access;
symbols
	OPENBSD_6_2:1.16.0.4
	OPENBSD_6_2_BASE:1.16
	OPENBSD_6_1:1.15.0.8
	OPENBSD_6_1_BASE:1.15
	OPENBSD_6_0:1.15.0.4
	OPENBSD_6_0_BASE:1.15
	OPENBSD_5_9:1.15.0.2
	OPENBSD_5_9_BASE:1.15
	OPENBSD_5_8:1.14.0.6
	OPENBSD_5_8_BASE:1.14
	OPENBSD_5_7:1.14.0.2
	OPENBSD_5_7_BASE:1.14
	OPENBSD_5_6:1.13.0.18
	OPENBSD_5_6_BASE:1.13
	OPENBSD_5_5:1.13.0.16
	OPENBSD_5_5_BASE:1.13
	OPENBSD_5_4:1.13.0.12
	OPENBSD_5_4_BASE:1.13
	OPENBSD_5_3:1.13.0.10
	OPENBSD_5_3_BASE:1.13
	OPENBSD_5_2:1.13.0.8
	OPENBSD_5_2_BASE:1.13
	OPENBSD_5_1_BASE:1.13
	OPENBSD_5_1:1.13.0.6
	OPENBSD_5_0:1.13.0.4
	OPENBSD_5_0_BASE:1.13
	OPENBSD_4_9:1.13.0.2
	OPENBSD_4_9_BASE:1.13
	OPENBSD_4_8:1.12.0.14
	OPENBSD_4_8_BASE:1.12
	OPENBSD_4_7:1.12.0.10
	OPENBSD_4_7_BASE:1.12
	OPENBSD_4_6:1.12.0.12
	OPENBSD_4_6_BASE:1.12
	OPENBSD_4_5:1.12.0.8
	OPENBSD_4_5_BASE:1.12
	OPENBSD_4_4:1.12.0.6
	OPENBSD_4_4_BASE:1.12
	OPENBSD_4_3:1.12.0.4
	OPENBSD_4_3_BASE:1.12
	OPENBSD_4_2:1.12.0.2
	OPENBSD_4_2_BASE:1.12
	OPENBSD_4_1:1.11.0.6
	OPENBSD_4_1_BASE:1.11
	OPENBSD_4_0:1.11.0.4
	OPENBSD_4_0_BASE:1.11
	OPENBSD_3_9:1.11.0.2
	OPENBSD_3_9_BASE:1.11
	OPENBSD_3_8:1.10.0.10
	OPENBSD_3_8_BASE:1.10
	OPENBSD_3_7:1.10.0.8
	OPENBSD_3_7_BASE:1.10
	OPENBSD_3_6:1.10.0.6
	OPENBSD_3_6_BASE:1.10
	OPENBSD_3_5:1.10.0.4
	OPENBSD_3_5_BASE:1.10
	OPENBSD_3_4:1.10.0.2
	OPENBSD_3_4_BASE:1.10
	OPENBSD_3_3:1.8.0.12
	OPENBSD_3_3_BASE:1.8
	OPENBSD_3_2:1.8.0.10
	OPENBSD_3_2_BASE:1.8
	OPENBSD_3_1:1.8.0.8
	OPENBSD_3_1_BASE:1.8
	OPENBSD_3_0:1.8.0.6
	OPENBSD_3_0_BASE:1.8
	OPENBSD_2_9:1.8.0.4
	OPENBSD_2_9_BASE:1.8
	OPENBSD_2_8:1.8.0.2
	OPENBSD_2_8_BASE:1.8
	OPENBSD_2_7:1.7.0.2
	OPENBSD_2_7_BASE:1.7
	OPENBSD_2_6:1.5.0.4
	OPENBSD_2_6_BASE:1.5
	OPENBSD_2_5:1.5.0.2
	OPENBSD_2_5_BASE:1.5
	OPENBSD_2_4:1.4.0.2
	OPENBSD_2_4_BASE:1.4
	OPENBSD_2_3:1.2.0.8
	OPENBSD_2_3_BASE:1.2
	OPENBSD_2_2:1.2.0.6
	OPENBSD_2_2_BASE:1.2
	OPENBSD_2_1:1.2.0.4
	OPENBSD_2_1_BASE:1.2
	OPENBSD_2_0:1.2.0.2
	OPENBSD_2_0_BASE:1.2
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@.\" @;


1.16
date	2017.06.08.17.14.02;	author bluhm;	state Exp;
branches;
next	1.15;
commitid	Tn39fPOY4RhDBu57;

1.15
date	2015.09.10.17.55.21;	author schwarze;	state Exp;
branches;
next	1.14;
commitid	PeV7Ql0T6htfMjhP;

1.14
date	2014.11.15.14.41.02;	author bentley;	state Exp;
branches;
next	1.13;
commitid	HuCemPIiOkto0SJD;

1.13
date	2010.11.01.22.07.08;	author jmc;	state Exp;
branches;
next	1.12;

1.12
date	2007.05.31.19.19.58;	author jmc;	state Exp;
branches;
next	1.11;

1.11
date	2005.11.20.10.00.02;	author jmc;	state Exp;
branches;
next	1.10;

1.10
date	2003.06.06.13.28.13;	author jmc;	state Exp;
branches;
next	1.9;

1.9
date	2003.06.02.23.30.14;	author millert;	state Exp;
branches;
next	1.8;

1.8
date	2000.10.26.00.37.04;	author aaron;	state Exp;
branches;
next	1.7;

1.7
date	2000.04.15.11.45.52;	author aaron;	state Exp;
branches;
next	1.6;

1.6
date	2000.03.19.19.25.26;	author aaron;	state Exp;
branches;
next	1.5;

1.5
date	98.11.26.04.25.58;	author aaron;	state Exp;
branches;
next	1.4;

1.4
date	98.09.07.16.44.36;	author aaron;	state Exp;
branches;
next	1.3;

1.3
date	98.06.29.13.06.24;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	95.12.14.05.41.51;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.44.37;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.44.37;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.16
log
@ASLR, W^X, and guard pages trigger processor traps that result in
SIGILL, SIGBUS, SIGSEGV signals.  Make such memory violations visible
in lastcomm(1).  This also works if a programm tries to hide them
with a signal handler.  Manual kill -SEGV does not generate false
positives.
OK deraadt@@
@
text
@.\"	$OpenBSD: acct.5,v 1.15 2015/09/10 17:55:21 schwarze Exp $
.\"	$NetBSD: acct.5,v 1.4 1995/10/22 01:40:10 ghudson Exp $
.\"
.\" Copyright (c) 1991, 1993
.\"	The Regents of the University of California.  All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. Neither the name of the University nor the names of its contributors
.\"    may be used to endorse or promote products derived from this software
.\"    without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.\"     @@(#)acct.5	8.1 (Berkeley) 6/5/93
.\"
.Dd $Mdocdate: September 10 2015 $
.Dt ACCT 5
.Os
.Sh NAME
.Nm acct
.Nd execution accounting file
.Sh SYNOPSIS
.In sys/acct.h
.Sh DESCRIPTION
The kernel maintains the following
.Fa acct
information structure for all
processes.
If a process terminates, and accounting is enabled, the kernel calls the
.Xr acct 2
function call to prepare and append the record
to the accounting file.
.Bd -literal
/*
 * Accounting structures; these use a comp_t type which is a 3 bits base 8
 * exponent, 13 bit fraction floating point number.  Units are 1/AHZ
 * seconds.
 */
typedef u_int16_t comp_t;

struct acct {
	char	  ac_comm[10];	/* command name */
	comp_t	  ac_utime;	/* user time */
	comp_t	  ac_stime;	/* system time */
	comp_t	  ac_etime;	/* elapsed time */
	time_t	  ac_btime;	/* starting time */
	uid_t	  ac_uid;	/* user id */
	gid_t	  ac_gid;	/* group id */
	u_int16_t ac_mem;	/* average memory usage */
	comp_t	  ac_io;	/* count of IO blocks */
	dev_t	  ac_tty;	/* controlling tty */

#define	AFORK	0x01		/* fork'd but not exec'd */
#define	ASU	0x02		/* used super-user permissions */
#define	ACOMPAT	0x04		/* used compatibility mode */
#define	ACORE	0x08		/* dumped core */
#define	AXSIG	0x10		/* killed by a signal */
#define	APLEDGE	0x20		/* killed due to pledge violation */
#define	ATRAP	0x40		/* memory access violation */
	u_int8_t  ac_flag;	/* accounting flags */
};

/*
 * 1/AHZ is the granularity of the data encoded in the comp_t fields.
 * This is not necessarily equal to hz.
 */
#define	AHZ	64

#ifdef _KERNEL
int	acct_process(struct proc *p);
#endif
.Ed
.Pp
If a terminated process was created by an
.Xr execve 2 ,
the name of the executed file (at most ten characters of it)
is saved in the field
.Fa ac_comm
and its status is saved by setting one or more of the following flags in
.Fa ac_flag :
.Dv AFORK ,
.Dv ASU ,
.Dv ACOMPAT ,
.Dv ACORE ,
and
.Dv AXSIG .
.Sh SEE ALSO
.Xr lastcomm 1 ,
.Xr acct 2 ,
.Xr execve 2 ,
.Xr accton 8 ,
.Xr sa 8
.Sh HISTORY
An
.Nm
file format first appeared in
.At v7 .
@


1.15
log
@use .In rather than .Fd #include
@
text
@d1 1
a1 1
.\"	$OpenBSD: acct.5,v 1.14 2014/11/15 14:41:02 bentley Exp $
d33 1
a33 1
.Dd $Mdocdate: November 15 2014 $
d75 2
@


1.14
log
@Reduce instances of `` '' in manuals.

troff displays these as typographic quotes, but nroff implementations
almost always print them literally, which rarely has the intended effect
with modern fonts, even in stock xterm.

These uses of `` '' can be replaced either with more semantic alternatives
or with Dq, which prints typographic quotes in a UTF-8 locale (but will
automatically fall back to `` '' in an ASCII locale).

improvements and ok schwarze@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: acct.5,v 1.13 2010/11/01 22:07:08 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate: November 1 2010 $
d40 1
a40 1
.Fd #include <sys/acct.h>
@


1.13
log
@typo fix lifted from the last tmux commit ("one of more");
@
text
@d1 1
a1 1
.\"	$OpenBSD: acct.5,v 1.12 2007/05/31 19:19:58 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate: May 31 2007 $
d53 1
a53 1
 * exponent, 13 bit fraction ``floating point'' number.  Units are 1/AHZ
@


1.12
log
@convert to new .Dd format;
@
text
@d1 1
a1 1
.\"	$OpenBSD: acct.5,v 1.11 2005/11/20 10:00:02 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate$
d94 1
a94 1
and its status is saved by setting one of more of the following flags in
@


1.11
log
@sync this w/ the header file;
ok otto@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: acct.5,v 1.10 2003/06/06 13:28:13 jmc Exp $
d33 1
a33 1
.Dd June 5, 1993
@


1.10
log
@- section reorder
- macro fixes
- kill whitespace at EOL
@
text
@d1 1
a1 1
.\"	$OpenBSD: acct.5,v 1.9 2003/06/02 23:30:14 millert Exp $
d56 1
a56 1
typedef u_short comp_t;
d59 13
a71 12
	char	ac_comm[10];	/* name of command */
	comp_t	ac_utime;	/* user time */
	comp_t	ac_stime;	/* system time */
	comp_t	ac_etime;	/* elapsed time */
	time_t	ac_btime;	/* starting time */
	uid_t	ac_uid;		/* user id */
	gid_t	ac_gid;		/* group id */
	short	ac_mem;		/* memory usage average */
	comp_t	ac_io;		/* count of IO blocks */
	dev_t	ac_tty;		/* controlling tty */
#define	AFORK	0x01		/* forked but not exec'ed */
#define	ASU	0x02		/* used superuser permissions */
d75 1
a75 1
	char	ac_flag;	/* accounting flags */
d84 2
a85 2
#ifdef KERNEL
struct vnode	*acctp;
d101 1
a101 1
.Dv ASIG .
d111 1
a111 1
file format appeared in
@


1.9
log
@Remove the advertising clause in the UCB license which Berkeley
rescinded 22 July 1999.  Proofed by myself and Theo.
@
text
@d1 1
a1 1
.\"	$OpenBSD: acct.5,v 1.8 2000/10/26 00:37:04 aaron Exp $
d94 1
a94 1
.Fa ac_flag:
@


1.8
log
@Some share/man fleshing.
@
text
@d1 1
a1 1
.\"	$OpenBSD: acct.5,v 1.7 2000/04/15 11:45:52 aaron Exp $
d15 1
a15 5
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgement:
.\"	This product includes software developed by the University of
.\"	California, Berkeley and its contributors.
.\" 4. Neither the name of the University nor the names of its contributors
@


1.7
log
@- For consistency, `super-user' -> `superuser' in all cases.
- Some punctuation fixes.
- Some `id' -> `ID'.
@
text
@d1 1
a1 1
.\"	$OpenBSD: acct.5,v 1.6 2000/03/19 19:25:26 aaron Exp $
d102 1
a102 1
.Dv ACORE
@


1.6
log
@Various cleanups.
@
text
@d1 1
a1 1
.\"	$OpenBSD: acct.5,v 1.5 1998/11/26 04:25:58 aaron Exp $
d74 1
a74 1
#define	ASU	0x02		/* used super-user permissions */
@


1.5
log
@share/man/man5/ man page repairs
@
text
@d1 1
a1 1
.\"	$OpenBSD$
d49 2
a50 2
processes. If a process terminates, and accounting is enabled,
the kernel calls the
@


1.4
log
@More man page fixes. Particularly fix uses of it's/its, affect/effect,
then/than and such. Other miscellaneous problems fixed across these source
files.
@
text
@d1 1
d106 1
d108 1
a109 2
.Xr execve 2 ,
.Xr lastcomm 1 ,
@


1.3
log
@various cleanups; hoek
@
text
@d111 1
a111 1
A
@


1.2
log
@update from netbsd
@
text
@d72 1
a72 1
#define	AFORK	0x01		/* forked but not execed */
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
.\"	$NetBSD: acct.5,v 1.3 1994/11/30 19:31:10 jtc Exp $
d106 1
d108 1
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
