head	1.18;
access;
symbols
	OPENBSD_6_2_BASE:1.18
	OPENBSD_6_1:1.18.0.12
	OPENBSD_6_1_BASE:1.18
	OPENBSD_6_0:1.18.0.8
	OPENBSD_6_0_BASE:1.18
	OPENBSD_5_9:1.18.0.4
	OPENBSD_5_9_BASE:1.18
	OPENBSD_5_8:1.18.0.6
	OPENBSD_5_8_BASE:1.18
	OPENBSD_5_7:1.18.0.2
	OPENBSD_5_7_BASE:1.18
	OPENBSD_5_6:1.17.0.10
	OPENBSD_5_6_BASE:1.17
	OPENBSD_5_5:1.17.0.8
	OPENBSD_5_5_BASE:1.17
	OPENBSD_5_4:1.17.0.4
	OPENBSD_5_4_BASE:1.17
	OPENBSD_5_3:1.17.0.2
	OPENBSD_5_3_BASE:1.17
	OPENBSD_5_2:1.16.0.4
	OPENBSD_5_2_BASE:1.16
	OPENBSD_5_1_BASE:1.16
	OPENBSD_5_1:1.16.0.2
	OPENBSD_5_0:1.15.0.4
	OPENBSD_5_0_BASE:1.15
	OPENBSD_4_9:1.15.0.2
	OPENBSD_4_9_BASE:1.15
	OPENBSD_4_8:1.14.0.4
	OPENBSD_4_8_BASE:1.14
	OPENBSD_4_7:1.14.0.2
	OPENBSD_4_7_BASE:1.14
	OPENBSD_4_6:1.13.0.8
	OPENBSD_4_6_BASE:1.13
	OPENBSD_4_5:1.13.0.4
	OPENBSD_4_5_BASE:1.13
	OPENBSD_4_4:1.13.0.2
	OPENBSD_4_4_BASE:1.13
	OPENBSD_4_3:1.11.0.4
	OPENBSD_4_3_BASE:1.11
	OPENBSD_4_2:1.11.0.2
	OPENBSD_4_2_BASE:1.11
	OPENBSD_4_1:1.10.0.10
	OPENBSD_4_1_BASE:1.10
	OPENBSD_4_0:1.10.0.8
	OPENBSD_4_0_BASE:1.10
	OPENBSD_3_9:1.10.0.6
	OPENBSD_3_9_BASE:1.10
	OPENBSD_3_8:1.10.0.4
	OPENBSD_3_8_BASE:1.10
	OPENBSD_3_7:1.10.0.2
	OPENBSD_3_7_BASE:1.10
	OPENBSD_3_6:1.8.0.6
	OPENBSD_3_6_BASE:1.8
	OPENBSD_3_5:1.8.0.4
	OPENBSD_3_5_BASE:1.8
	OPENBSD_3_4:1.8.0.2
	OPENBSD_3_4_BASE:1.8
	OPENBSD_3_3:1.7.0.2
	OPENBSD_3_3_BASE:1.7
	OPENBSD_3_2:1.6.0.2
	OPENBSD_3_2_BASE:1.6
	OPENBSD_3_1:1.3.0.4
	OPENBSD_3_1_BASE:1.3
	OPENBSD_3_0:1.3.0.2
	OPENBSD_3_0_BASE:1.3;
locks; strict;
comment	@.\" @;


1.18
date	2014.11.19.04.19.54;	author schwarze;	state Exp;
branches;
next	1.17;
commitid	g0uCmqlQTAO3ZfJb;

1.17
date	2012.09.26.17.34.38;	author jmc;	state Exp;
branches;
next	1.16;

1.16
date	2011.11.28.08.46.27;	author eric;	state Exp;
branches;
next	1.15;

1.15
date	2010.10.14.20.41.28;	author jmc;	state Exp;
branches;
next	1.14;

1.14
date	2009.10.28.08.56.54;	author sobrado;	state Exp;
branches;
next	1.13;

1.13
date	2008.06.26.06.59.39;	author jmc;	state Exp;
branches;
next	1.12;

1.12
date	2008.06.26.05.57.54;	author djm;	state Exp;
branches;
next	1.11;

1.11
date	2007.05.31.19.19.58;	author jmc;	state Exp;
branches;
next	1.10;

1.10
date	2005.02.21.10.22.04;	author djm;	state Exp;
branches;
next	1.9;

1.9
date	2005.01.17.03.06.07;	author djm;	state Exp;
branches;
next	1.8;

1.8
date	2003.07.04.08.03.13;	author markus;	state Exp;
branches;
next	1.7;

1.7
date	2003.03.06.20.48.35;	author jmc;	state Exp;
branches;
next	1.6;

1.6
date	2002.09.18.07.36.32;	author deraadt;	state Exp;
branches;
next	1.5;

1.5
date	2002.09.06.21.36.52;	author deraadt;	state Exp;
branches;
next	1.4;

1.4
date	2002.08.29.07.34.31;	author wcobb;	state Exp;
branches;
next	1.3;

1.3
date	2001.06.24.18.50.52;	author provos;	state Exp;
branches;
next	1.2;

1.2
date	2001.06.24.18.45.35;	author itojun;	state Exp;
branches;
next	1.1;

1.1
date	2001.06.22.21.36.52;	author provos;	state Exp;
branches;
next	;


desc
@@


1.18
log
@remove duplicate publication year; carsten dot kunze at arcor dot de
@
text
@.\"	$OpenBSD: moduli.5,v 1.17 2012/09/26 17:34:38 jmc Exp $
.\"
.\" Copyright (c) 2008 Damien Miller <djm@@mindrot.org>
.\"
.\" Permission to use, copy, modify, and distribute this software for any
.\" purpose with or without fee is hereby granted, provided that the above
.\" copyright notice and this permission notice appear in all copies.
.\"
.\" THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
.\" WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
.\" MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
.\" ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
.\" WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
.\" ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
.\" OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
.Dd $Mdocdate: September 26 2012 $
.Dt MODULI 5
.Os
.Sh NAME
.Nm moduli
.Nd Diffie-Hellman moduli
.Sh DESCRIPTION
The
.Pa /etc/moduli
file contains prime numbers and generators for use by
.Xr sshd 8
in the Diffie-Hellman Group Exchange key exchange method.
.Pp
New moduli may be generated with
.Xr ssh-keygen 1
using a two-step process.
An initial
.Em candidate generation
pass, using
.Ic ssh-keygen -G ,
calculates numbers that are likely to be useful.
A second
.Em primality testing
pass, using
.Ic ssh-keygen -T ,
provides a high degree of assurance that the numbers are prime and are
safe for use in Diffie-Hellman operations by
.Xr sshd 8 .
This
.Nm
format is used as the output from each pass.
.Pp
The file consists of newline-separated records, one per modulus,
containing seven space-separated fields.
These fields are as follows:
.Bl -tag -width Description -offset indent
.It timestamp
The time that the modulus was last processed as YYYYMMDDHHMMSS.
.It type
Decimal number specifying the internal structure of the prime modulus.
Supported types are:
.Pp
.Bl -tag -width 0x00 -compact
.It 0
Unknown, not tested.
.It 2
"Safe" prime; (p-1)/2 is also prime.
.It 4
Sophie Germain; 2p+1 is also prime.
.El
.Pp
Moduli candidates initially produced by
.Xr ssh-keygen 1
are Sophie Germain primes (type 4).
Further primality testing with
.Xr ssh-keygen 1
produces safe prime moduli (type 2) that are ready for use in
.Xr sshd 8 .
Other types are not used by OpenSSH.
.It tests
Decimal number indicating the type of primality tests that the number
has been subjected to represented as a bitmask of the following values:
.Pp
.Bl -tag -width 0x00 -compact
.It 0x00
Not tested.
.It 0x01
Composite number \(en not prime.
.It 0x02
Sieve of Eratosthenes.
.It 0x04
Probabilistic Miller-Rabin primality tests.
.El
.Pp
The
.Xr ssh-keygen 1
moduli candidate generation uses the Sieve of Eratosthenes (flag 0x02).
Subsequent
.Xr ssh-keygen 1
primality tests are Miller-Rabin tests (flag 0x04).
.It trials
Decimal number indicating the number of primality trials
that have been performed on the modulus.
.It size
Decimal number indicating the size of the prime in bits.
.It generator
The recommended generator for use with this modulus (hexadecimal).
.It modulus
The modulus itself in hexadecimal.
.El
.Pp
When performing Diffie-Hellman Group Exchange,
.Xr sshd 8
first estimates the size of the modulus required to produce enough
Diffie-Hellman output to sufficiently key the selected symmetric cipher.
.Xr sshd 8
then randomly selects a modulus from
.Fa /etc/moduli
that best meets the size requirement.
.Sh SEE ALSO
.Xr ssh-keygen 1 ,
.Xr sshd 8
.Sh STANDARDS
.Rs
.%A M. Friedl
.%A N. Provos
.%A W. Simpson
.%D March 2006
.%R RFC 4419
.%T Diffie-Hellman Group Exchange for the Secure Shell (SSH) Transport Layer Protocol
.Re
@


1.17
log
@last stage of rfc changes, using consistent Rs/Re blocks, and moving the
references into a STANDARDS section;
@
text
@d1 1
a1 1
.\"	$OpenBSD: moduli.5,v 1.16 2011/11/28 08:46:27 eric Exp $
d16 1
a16 1
.Dd $Mdocdate: November 28 2011 $
a125 1
.%D 2006
@


1.16
log
@fix formula

ok djm@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: moduli.5,v 1.15 2010/10/14 20:41:28 jmc Exp $
d16 1
a16 1
.Dd $Mdocdate: October 14 2010 $
d118 1
d120 4
d125 1
a125 1
.%T "Diffie-Hellman Group Exchange for the Secure Shell (SSH) Transport Layer Protocol"
@


1.15
log
@probabalistic -> probabilistic; from naddy
@
text
@d1 1
a1 1
.\"	$OpenBSD: moduli.5,v 1.14 2009/10/28 08:56:54 sobrado Exp $
d16 1
a16 1
.Dd $Mdocdate: October 28 2009 $
d64 1
a64 1
Sophie Germain; (p+1)*2 is also prime.
@


1.14
log
@"Diffie-Hellman" is the usual spelling for the cryptographic protocol
first published by Whitfield Diffie and Martin Hellman in 1976.

ok jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: moduli.5,v 1.13 2008/06/26 06:59:39 jmc Exp $
d16 1
a16 1
.Dd $Mdocdate: June 26 2008 $
d87 1
a87 1
Probabalistic Miller-Rabin primality tests.
@


1.13
log
@tweak previous;
@
text
@d1 1
a1 1
.\"	$OpenBSD: moduli.5,v 1.12 2008/06/26 05:57:54 djm Exp $
d21 1
a21 1
.Nd Diffie Hellman moduli
d42 1
a42 1
safe for use in Diffie Hellman operations by
d107 1
a107 1
When performing Diffie Hellman Group Exchange,
d110 1
a110 1
Diffie Hellman output to sufficiently key the selected symmetric cipher.
@


1.12
log
@rewrite moduli(5). The old one contained quite a bit of historical and
irrelevant information. It also included an advertising clause in
its license which dtucker tried unsuccessfully to have rescinded, and we
want OpenSSH and its related documentation to be as free as possible.

feedback & ok deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD$
d16 1
a16 1
.Dd $Mdocdate$
d25 1
a25 1
file contains prime numbers and generators for use by 
d34 1
a34 1
pass, using 
d40 1
a40 1
.Ic ssh-keygen -T
d49 1
a49 1
containing seven space separated fields.
a50 1
.Pp
d60 1
a60 1
Unknown, not tested
d70 1
a70 1
Futher primality testing with
d81 1
a81 1
Not tested
d83 1
a83 1
Composite number - not prime.
d85 1
a85 1
Sieve of Eratosthenes
d97 2
a98 2
Decimal number indicating of primaility trials that have been performed
on the modulus.
a114 1
.Pp
d117 1
a117 1
.Xr sshd 8 ,
@


1.11
log
@convert to new .Dd format;
@
text
@d1 1
a1 1
.\" $OpenBSD: moduli.5,v 1.10 2005/02/21 10:22:04 djm Exp $
d3 1
a3 2
.\" Copyright 1997, 2000 William Allen Simpson <wsimpson@@greendragon.com>
.\" All rights reserved.
d5 3
a7 26
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgement:
.\"      This product includes software designed by William Allen Simpson.
.\" 4. The name of the author may not be used to endorse or promote products
.\"    derived from this software without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
.\" IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
.\" OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
.\" IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
.\" INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
.\" NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
.\" DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
.\" THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
.\" (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
.\" THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
.\"
.\" Manual page, using -mandoc macros
d9 7
d21 1
a21 1
.Nd system moduli file
d25 18
a42 1
file contains the system-wide Diffie-Hellman prime moduli for
d44 22
a65 32
.Pp
Each line in this file contains the following fields:
Time, Type, Tests, Tries, Size, Generator, Modulus.
The fields are separated by white space (tab or blank).
.Pp
.Fa Time : yyyymmddhhmmss .
Specifies the system time that the line was appended to the file.
The value 00000000000000 means unknown (historic).
.\"The file is sorted in ascending order.
.Pp
.Fa Type : decimal .
Specifies the internal structure of the prime modulus.
.Pp
.Bl -tag -width indent -offset indent -compact
.It 0 :
unknown;
often learned from peer during protocol operation,
and saved for later analysis.
.It 1 :
unstructured;
a common large number.
.It 2 :
safe (p = 2q + 1);
meets basic structural requirements.
.It 3 :
Schnorr.
.It 4 :
Sophie-Germain (q = (p-1)/2);
usually generated in the process of testing safe or strong primes.
.It 5 :
strong;
useful for RSA public key generation.
d68 21
a88 22
.Fa Tests : decimal (bit field) .
Specifies the methods used in checking for primality.
Usually, more than one test is used.
.Pp
.Bl -tag -width indent -offset indent -compact
.It 0 :
not tested;
often learned from peer during protocol operation,
and saved for later analysis.
.It 1 :
composite;
failed one or more tests.
In this case, the highest bit specifies the test that failed.
.It 2 :
sieve;
checked for division by a range of smaller primes.
.It 4 :
Miller-Rabin.
.It 8 :
Jacobi.
.It 16 :
Elliptic Curve.
d91 15
a105 27
.Fa Tries : decimal .
Depends on the value of the highest valid Test bit,
where the method specified is:
.Pp
.Bl -tag -width indent -offset indent -compact
.It 0 :
not tested
(always zero).
.It 1 :
composite
(irrelevant).
.It 2 :
sieve;
number of primes sieved.
Commonly on the order of 32,000,000.
.It 4 :
Miller-Rabin;
number of M-R iterations.
Commonly on the order of 32 to 64.
.It 8 :
Jacobi;
unknown
(always zero).
.It 16 :
Elliptic Curve;
unused
(always zero).
d108 8
a115 2
.Fa Size : decimal .
Specifies the number of the most significant bit (0 to M).
a116 21
.Fa Generator : hex string .
Specifies the best generator for a Diffie-Hellman exchange.
0 = unknown or variable,
2, 3, 5, etc.
.Pp
.Fa Modulus : hex string .
The prime modulus.
.Pp
The file is searched for moduli that meet the appropriate
Time, Size and Generator criteria.
When more than one meet the criteria,
the selection should be weighted toward newer moduli,
without completely disqualifying older moduli.
.Pp
New moduli may be generated using the
.Xr ssh-keygen 1
tool.
.Sh FILES
.Bl -tag -width /etc/moduli -compact
.It Pa /etc/moduli
.El
d119 6
a124 1
.Xr sshd 8
@


1.10
log
@mention ssh-keygen(1) as a means to generate moduli; ok markus@@ dtucker@@
@
text
@d1 1
a1 1
.\" $OpenBSD: moduli.5,v 1.9 2005/01/17 03:06:07 djm Exp $
d33 1
a33 1
.Dd July 28, 1997
@


1.9
log
@Sophie Germain is the correct name of the French mathematician,
"Sophie Germaine" isn't; from Luc.Maisonobe@@c-s.fr
@
text
@d1 1
a1 1
.\" $OpenBSD: moduli.5,v 1.8 2003/07/04 08:03:13 markus Exp $
d147 4
d156 1
@


1.8
log
@off byone; netbsd pr 22012
@
text
@d1 1
a1 1
.\" $OpenBSD: moduli.5,v 1.7 2003/03/06 20:48:35 jmc Exp $
d71 1
a71 1
Sophie-Germaine (q = (p-1)/2);
@


1.7
log
@.Xr typos;
@
text
@d1 1
a1 1
.\" $OpenBSD: moduli.5,v 1.6 2002/09/18 07:36:32 deraadt Exp $
d132 1
a132 1
Specifies the number of significant bits.
@


1.6
log
@no photurisd
@
text
@d1 1
a1 1
.\" $OpenBSD: moduli.5,v 1.5 2002/09/06 21:36:52 deraadt Exp $
d43 1
a43 1
.Xr sshd .
@


1.5
log
@remove Xr to photuris
@
text
@d1 1
a1 1
.\" $OpenBSD: moduli.5,v 1.4 2002/08/29 07:34:31 wcobb Exp $
a151 1
.Xr photurisd 8 ,
@


1.4
log
@- replace empty lines by .Pp where appropriate.
- no empty lines at end of file.
ok mpech@@
@
text
@d1 1
a1 1
.\" $OpenBSD: moduli.5,v 1.3 2001/06/24 18:50:52 provos Exp $
d42 2
a43 5
file contains the system-wide Diffie-Hellman prime moduli for the
.Xr photurisd 8
and
.Xr sshd 8
programs.
@


1.3
log
@remove misleading history
@
text
@d1 1
a1 1
.\" $OpenBSD: moduli.5,v 1.2 2001/06/24 18:45:35 itojun Exp $
a156 1

@


1.2
log
@mdoc fixes.  from netbsd-current by wiz@@netbsd
@
text
@d1 1
a1 1
.\" $OpenBSD: moduli.5,v 1.1 2001/06/22 21:36:52 provos Exp $
a156 5
.Sh HISTORY
The
.Nm
file appeared in
.Ox 2.8 .
@


1.1
log
@switch from primes to moduli
@
text
@d1 1
a1 1
.\" $OpenBSD: primes.5,v 1.1 2001/06/14 13:53:50 provos Exp $
d47 2
a48 2

Each line in this file contains the following fields: 
d52 1
a52 1
.Fa Time : yyyymmddhhmmss.
d57 1
a57 1
.Fa Type : decimal.
d61 1
a61 1
.It 0: 
d65 1
a65 1
.It 1:
d68 1
a68 1
.It 2:
d71 1
a71 1
.It 3:
d73 1
a73 1
.It 4:
d76 1
a76 1
.It 5:
d81 1
a81 1
.Fa Tests : decimal (bit field).
d86 1
a86 1
.It 0: 
d90 1
a90 1
.It 1:
d94 1
a94 1
.It 2:
d97 1
a97 1
.It 4:
d99 1
a99 1
.It 8:
d101 1
a101 1
.It 16:
d105 1
a105 1
.Fa Tries : decimal.
d110 1
a110 1
.It 0: 
d113 1
a113 1
.It 1:
d116 1
a116 1
.It 2:
d120 1
a120 1
.It 4:
d124 1
a124 1
.It 8:
d128 1
a128 1
.It 16:
d134 1
a134 1
.Fa Size : decimal.
d137 1
a137 1
.Fa Generator : hex string.
d142 1
a142 1
.Fa Modulus : hex string.
d145 1
a145 1
The file is searched for moduli that meet the appropriate 
@

