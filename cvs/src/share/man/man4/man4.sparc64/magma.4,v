head	1.13;
access;
symbols
	OPENBSD_6_1_BASE:1.13
	OPENBSD_6_0:1.13.0.16
	OPENBSD_6_0_BASE:1.13
	OPENBSD_5_9:1.13.0.4
	OPENBSD_5_9_BASE:1.13
	OPENBSD_5_8:1.13.0.12
	OPENBSD_5_8_BASE:1.13
	OPENBSD_5_7:1.13.0.10
	OPENBSD_5_7_BASE:1.13
	OPENBSD_5_6:1.13.0.8
	OPENBSD_5_6_BASE:1.13
	OPENBSD_5_5:1.13.0.6
	OPENBSD_5_5_BASE:1.13
	OPENBSD_5_4:1.13.0.2
	OPENBSD_5_4_BASE:1.13
	OPENBSD_5_3:1.11.0.18
	OPENBSD_5_3_BASE:1.11
	OPENBSD_5_2:1.11.0.16
	OPENBSD_5_2_BASE:1.11
	OPENBSD_5_1_BASE:1.11
	OPENBSD_5_1:1.11.0.14
	OPENBSD_5_0:1.11.0.12
	OPENBSD_5_0_BASE:1.11
	OPENBSD_4_9:1.11.0.10
	OPENBSD_4_9_BASE:1.11
	OPENBSD_4_8:1.11.0.8
	OPENBSD_4_8_BASE:1.11
	OPENBSD_4_7:1.11.0.4
	OPENBSD_4_7_BASE:1.11
	OPENBSD_4_6:1.11.0.6
	OPENBSD_4_6_BASE:1.11
	OPENBSD_4_5:1.11.0.2
	OPENBSD_4_5_BASE:1.11
	OPENBSD_4_4:1.10.0.6
	OPENBSD_4_4_BASE:1.10
	OPENBSD_4_3:1.10.0.4
	OPENBSD_4_3_BASE:1.10
	OPENBSD_4_2:1.10.0.2
	OPENBSD_4_2_BASE:1.10
	OPENBSD_4_1:1.9.0.10
	OPENBSD_4_1_BASE:1.9
	OPENBSD_4_0:1.9.0.8
	OPENBSD_4_0_BASE:1.9
	OPENBSD_3_9:1.9.0.6
	OPENBSD_3_9_BASE:1.9
	OPENBSD_3_8:1.9.0.4
	OPENBSD_3_8_BASE:1.9
	OPENBSD_3_7:1.9.0.2
	OPENBSD_3_7_BASE:1.9
	OPENBSD_3_6:1.8.0.4
	OPENBSD_3_6_BASE:1.8
	OPENBSD_3_5:1.8.0.2
	OPENBSD_3_5_BASE:1.8
	OPENBSD_3_4:1.7.0.2
	OPENBSD_3_4_BASE:1.7
	OPENBSD_3_3:1.5.0.4
	OPENBSD_3_3_BASE:1.5
	OPENBSD_3_2:1.5.0.2
	OPENBSD_3_2_BASE:1.5
	OPENBSD_3_1:1.4.0.2
	OPENBSD_3_1_BASE:1.4;
locks; strict;
comment	@.\" @;


1.13
date	2013.07.16.16.05.50;	author schwarze;	state Exp;
branches;
next	1.12;

1.12
date	2013.06.02.20.42.27;	author tedu;	state Exp;
branches;
next	1.11;

1.11
date	2008.11.29.01.55.06;	author ray;	state Exp;
branches;
next	1.10;

1.10
date	2007.05.31.19.19.57;	author jmc;	state Exp;
branches;
next	1.9;

1.9
date	2004.09.30.19.59.28;	author mickey;	state Exp;
branches;
next	1.8;

1.8
date	2003.11.09.16.06.07;	author jmc;	state Exp;
branches;
next	1.7;

1.7
date	2003.06.06.10.29.42;	author jmc;	state Exp;
branches;
next	1.6;

1.6
date	2003.05.07.08.13.20;	author jmc;	state Exp;
branches;
next	1.5;

1.5
date	2002.10.01.21.03.27;	author miod;	state Exp;
branches;
next	1.4;

1.4
date	2002.02.19.06.59.13;	author jason;	state Exp;
branches;
next	1.3;

1.3
date	2002.01.25.02.40.21;	author jason;	state Exp;
branches;
next	1.2;

1.2
date	2002.01.24.18.13.56;	author mpech;	state Exp;
branches;
next	1.1;

1.1
date	2002.01.12.21.48.48;	author jason;	state Exp;
branches;
next	;


desc
@@


1.13
log
@use .Mt for email addresses; from Jan Stary <hans at stare dot cz>; ok jmc@@
@
text
@.\"	$OpenBSD: magma.4,v 1.12 2013/06/02 20:42:27 tedu Exp $
.\"
.\"
.\" Copyright (c) 1998 Iain Hibbert
.\" All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
.\" IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
.\" OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
.\" IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
.\" INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
.\" NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
.\" DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
.\" THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
.\" (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
.\" THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
.\"
.Dd $Mdocdate: June 2 2013 $
.Dt MAGMA 4 sparc64
.Os
.Sh NAME
.Nm magma
.Nd Magma Sp Serial/Parallel board device driver
.Sh SYNOPSIS
.Cd "magma? at sbus?"
.Cd "mtty? at magma?"
.Cd "mbpp? at magma?"
.Sh DESCRIPTION
This driver provides an interface to Magma LC2+1Sp, 2+1Sp, 4+1Sp, 8+2Sp,
4Sp, 8Sp, 12Sp, 16Sp, 1P, 2P, and 2+1HS boards.
These boards are based around the Cirrus Logic CD1400 serial/parallel
communications engine and the Cirrus Logic CD1190 parallel communications
engine.
.Pp
The device minor numbers for this driver are encoded as follows:
.Bd -literal
    +---+---+---+---+---+---+---+---+
    | 7 | 6 | 5 | 4 | 3 | 2 | 1 | 0 |
    +---+---+---+---+---+---+---+---+
      |   |   |   |   |   |   |   |
      |   |   |   |   +---+---+---+---> port number
      |   |   |   |
      |   |   |   +-------------------> dial-out (on tty ports)
      |   |   |
      |   |   +-----------------------> unused
      |   |
      +---+---------------------------> card number
.Ed
.Pp
Up to four cards are supported in the system.
.Pp
All tty ports have full automatic hardware (RTS/CTS) flow control available
and a 12 byte FIFO on the chip in each direction so errors should be minimal.
.Sh FILES
.Bl -tag -width /dev/bpp[0-3][0-1] -compact
.It /dev/tty[mno][0-f]
Serial ports
.It /dev/bpp[mno][0-1]
Parallel ports
.El
.Sh DIAGNOSTICS
.Bl -diag
.It "mtty0X: ring buffer overflow"
Incoming characters have been discarded due to a buffer overflow.
This is caused by the process in control of the device not reading characters
fast enough.
If need be you can make the ring buffer bigger by changing the
.Dv MAGMA_RBUF_SIZE
#define to something bigger, but it should be a multiple of two.
.It "mtty0X: fifo overflow"
Incoming characters have been discarded due to a CD1400 channel overrun.
This is caused by interrupts not being serviced sufficiently quickly to prevent
the 12 byte receive FIFO on a serial channel from overflowing.
Reducing the value of either the
.Dv MTTY_RX_FIFO_THRESHOLD
or
.Dv MTTY_RX_DTR_THRESHOLD
#define's to something smaller may help slow machines avoid this problem.
.El
.Sh SEE ALSO
.Xr intro 4 ,
.Xr sbus 4 ,
.Xr tty 4
.Sh HISTORY
The driver was loosely based upon the
.Xr cy 4
Cyclades Cyclom device driver written
by Andrew Herbert and Timo Rossi.
.Sh AUTHORS
The driver was written by
.An Iain Hibbert Aq Mt plunky@@skate.demon.co.uk
.Sh TODO
CD1190 parallel support.
.Pp
bpp input.
.Pp
Dial-out (cua) devices are not yet supported.
.Pp
mdmbuf is unsupported.
.Pp
Automatic XON/XOFF handshaking could be implemented fairly easily.
.Pp
It would be good if the tty port waited for the FIFO to empty before allowing
a close, so that I could turn off the channel interrupts at that time.
It can be done.
@


1.12
log
@first stab are replacing format strings in MD pages
@
text
@d1 1
a1 1
.\"	$OpenBSD: magma.4,v 1.11 2008/11/29 01:55:06 ray Exp $
d27 1
a27 1
.Dd $Mdocdate: November 29 2008 $
d100 1
a100 1
.An Iain Hibbert Aq plunky@@skate.demon.co.uk
@


1.11
log
@Iain Hibbert (plunky@@netbsd) removed clauses 3 and 4 from his
licenses as well. Thanks!

"Groovy" deraadt
@
text
@d1 1
a1 1
.\"	$OpenBSD: magma.4,v 1.10 2007/05/31 19:19:57 jmc Exp $
d27 1
a27 1
.Dd $Mdocdate: May 31 2007 $
d72 1
a72 1
.It "mtty%d%x: ring buffer overflow"
d79 1
a79 1
.It "mtty%d%x: fifo overflow"
@


1.10
log
@convert to new .Dd format;
@
text
@d1 1
a1 1
.\"	$OpenBSD: magma.4,v 1.9 2004/09/30 19:59:28 mickey Exp $
d6 1
a14 5
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgement:
.\"	This product includes software developed by Iain Hibbert
.\" 4. The name of the author may not be used to endorse or promote products
.\"    derived from this software without specific prior written permission.
d27 1
a27 1
.Dd $Mdocdate$
@


1.9
log
@kill default locators
@
text
@d1 1
a1 1
.\"	$OpenBSD: magma.4,v 1.8 2003/11/09 16:06:07 jmc Exp $
d31 1
a31 1
.Dd January 12, 2002
@


1.8
log
@remove .Pp's before lists and displays;
@
text
@d1 1
a1 1
.\"	$OpenBSD: magma.4,v 1.7 2003/06/06 10:29:42 jmc Exp $
d38 1
a38 1
.Cd "magma? at sbus? slot ? offset ?"
@


1.7
log
@- section reorder
- some macro fixes
- kill whitespace at EOL
@
text
@d1 1
a1 1
.\"	$OpenBSD: magma.4,v 1.6 2003/05/07 08:13:20 jmc Exp $
a48 1
.Pp
@


1.6
log
@dialout -> dial-out

all our docs use dial-in, not dialin. before this we had a mix of
dialout and dial-out.

from wiz@@netbsd
ok miod@@

also added some punctuation to TODO section.
@
text
@d1 1
a1 1
.\"	$OpenBSD: magma.4,v 1.5 2002/10/01 21:03:27 miod Exp $
d68 7
d82 2
a83 2
\fIMAGMA_RBUF_SIZE\fR #define to something bigger, but it should be a multiple
of two.
d88 5
a92 10
Reducing the value of either the \fIMTTY_RX_FIFO_THRESHOLD\fR or
\fIMTTY_RX_DTR_THRESHOLD\fR #define's to something smaller may help slow
machines avoid this problem.
.El
.Sh FILES
.Bl -tag -width /dev/bpp[0-3][0-1] -compact
.It /dev/tty[mno][0-f]
Serial ports
.It /dev/bpp[mno][0-1]
Parallel ports
a97 3
.Sh AUTHORS
The driver was written by
.An Iain Hibbert Aq plunky@@skate.demon.co.uk
d103 3
@


1.5
log
@Last minute cleaning:
- .Xr .Cd police
- esp(4) layout glitch
- intro(4) sorted and augmented
- in pcons(4), mention that this is a last-chance driver that should
generally not be used. even if the earth stops spinning.

ok deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: magma.4,v 1.4 2002/02/19 06:59:13 jason Exp $
d57 1
a57 1
      |   |   |   +-------------------> dialout (on tty ports)
d105 1
a105 1
CD1190 parallel support
d107 1
a107 1
bpp input
d109 1
a109 1
Dialout (cua) devices are not yet supported.
d111 1
a111 1
mdmbuf is unsupported
d113 1
a113 1
automatic XON/XOFF handshaking could be implemented fairly easily.
d115 1
a115 1
it would be good if the tty port waited for the FIFO to empty before allowing
@


1.4
log
@Xr sbus 4
@
text
@d1 1
a1 1
.\"	$OpenBSD: magma.4,v 1.3 2002/01/25 02:40:21 jason Exp $
d93 1
a93 1
.Xr read 2 ,
a94 1
.Xr termios 4 ,
@


1.3
log
@add 2+1HS
@
text
@d1 1
a1 1
.\"	$OpenBSD: magma.4,v 1.2 2002/01/24 18:13:56 mpech Exp $
d94 1
@


1.2
log
@clean. minor -mdoc fixes.

jason@@ ok
@
text
@d1 1
a1 1
.\"	$OpenBSD: magma.4,v 1.1 2002/01/12 21:48:48 jason Exp $
d43 1
a43 1
4Sp, 8Sp, 12Sp, 16Sp, 1P and 2P boards.
@


1.1
log
@magma man pages (wholly stolen from sparc)
@
text
@d1 1
a1 1
.\"	$OpenBSD: magma.4,v 1.6 2001/10/05 14:45:54 mpech Exp $
d97 2
a98 1
The driver was written by Iain Hibbert <plunky@@skate.demon.co.uk>
@

