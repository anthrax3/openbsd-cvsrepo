head	1.17;
access;
symbols
	OPENBSD_6_2:1.17.0.12
	OPENBSD_6_2_BASE:1.17
	OPENBSD_6_1:1.17.0.16
	OPENBSD_6_1_BASE:1.17
	OPENBSD_6_0:1.17.0.14
	OPENBSD_6_0_BASE:1.17
	OPENBSD_5_9:1.17.0.2
	OPENBSD_5_9_BASE:1.17
	OPENBSD_5_8:1.17.0.10
	OPENBSD_5_8_BASE:1.17
	OPENBSD_5_7:1.17.0.8
	OPENBSD_5_7_BASE:1.17
	OPENBSD_5_6:1.17.0.6
	OPENBSD_5_6_BASE:1.17
	OPENBSD_5_5:1.17.0.4
	OPENBSD_5_5_BASE:1.17
	OPENBSD_5_4:1.16.0.22
	OPENBSD_5_4_BASE:1.16
	OPENBSD_5_3:1.16.0.20
	OPENBSD_5_3_BASE:1.16
	OPENBSD_5_2:1.16.0.18
	OPENBSD_5_2_BASE:1.16
	OPENBSD_5_1_BASE:1.16
	OPENBSD_5_1:1.16.0.16
	OPENBSD_5_0:1.16.0.14
	OPENBSD_5_0_BASE:1.16
	OPENBSD_4_9:1.16.0.12
	OPENBSD_4_9_BASE:1.16
	OPENBSD_4_8:1.16.0.10
	OPENBSD_4_8_BASE:1.16
	OPENBSD_4_7:1.16.0.6
	OPENBSD_4_7_BASE:1.16
	OPENBSD_4_6:1.16.0.8
	OPENBSD_4_6_BASE:1.16
	OPENBSD_4_5:1.16.0.4
	OPENBSD_4_5_BASE:1.16
	OPENBSD_4_4:1.16.0.2
	OPENBSD_4_4_BASE:1.16
	OPENBSD_4_3:1.15.0.2
	OPENBSD_4_3_BASE:1.15
	OPENBSD_4_2:1.14.0.2
	OPENBSD_4_2_BASE:1.14
	OPENBSD_4_1:1.13.0.4
	OPENBSD_4_1_BASE:1.13
	OPENBSD_4_0:1.13.0.2
	OPENBSD_4_0_BASE:1.13
	OPENBSD_3_9:1.10.0.4
	OPENBSD_3_9_BASE:1.10
	OPENBSD_3_8:1.10.0.2
	OPENBSD_3_8_BASE:1.10
	OPENBSD_3_7:1.9.0.2
	OPENBSD_3_7_BASE:1.9
	OPENBSD_3_6:1.8.0.8
	OPENBSD_3_6_BASE:1.8
	OPENBSD_3_5:1.8.0.6
	OPENBSD_3_5_BASE:1.8
	OPENBSD_3_4:1.8.0.4
	OPENBSD_3_4_BASE:1.8
	OPENBSD_3_3:1.8.0.2
	OPENBSD_3_3_BASE:1.8
	OPENBSD_3_2:1.6.0.2
	OPENBSD_3_2_BASE:1.6
	OPENBSD_3_1:1.3.0.6
	OPENBSD_3_1_BASE:1.3
	OPENBSD_3_0:1.3.0.4
	OPENBSD_3_0_BASE:1.3
	OPENBSD_2_9:1.3.0.2
	OPENBSD_2_9_BASE:1.3;
locks; strict;
comment	@.\" @;


1.17
date	2013.10.19.14.32.45;	author miod;	state Exp;
branches;
next	1.16;

1.16
date	2008.03.16.22.23.51;	author jmc;	state Exp;
branches;
next	1.15;

1.15
date	2007.11.25.17.11.12;	author oga;	state Exp;
branches;
next	1.14;

1.14
date	2007.05.31.19.19.53;	author jmc;	state Exp;
branches;
next	1.13;

1.13
date	2006.03.23.10.47.34;	author jmc;	state Exp;
branches;
next	1.12;

1.12
date	2006.03.16.21.33.17;	author deraadt;	state Exp;
branches;
next	1.11;

1.11
date	2006.03.16.21.24.33;	author dim;	state Exp;
branches;
next	1.10;

1.10
date	2005.05.04.05.05.32;	author jaredy;	state Exp;
branches;
next	1.9;

1.9
date	2004.09.30.19.59.26;	author mickey;	state Exp;
branches;
next	1.8;

1.8
date	2003.03.18.12.53.57;	author david;	state Exp;
branches;
next	1.7;

1.7
date	2003.02.19.09.01.47;	author jmc;	state Exp;
branches;
next	1.6;

1.6
date	2002.09.26.22.09.53;	author miod;	state Exp;
branches;
next	1.5;

1.5
date	2002.07.12.21.44.48;	author mickey;	state Exp;
branches;
next	1.4;

1.4
date	2002.06.30.21.45.25;	author deraadt;	state Exp;
branches;
next	1.3;

1.3
date	2001.03.27.22.44.54;	author aaron;	state Exp;
branches;
next	1.2;

1.2
date	2000.12.21.21.01.21;	author aaron;	state Exp;
branches;
next	1.1;

1.1
date	2000.11.15.21.03.00;	author aaron;	state Exp;
branches;
next	;


desc
@@


1.17
log
@Remove never enabled WSCONS_SUPPORT_PCVTFONTS code.
@
text
@.\" $OpenBSD: vga.4,v 1.16 2008/03/16 22:23:51 jmc Exp $
.\" $NetBSD: vga.4,v 1.2.4.1 2000/08/09 07:48:40 drochner Exp $
.\"
.\" Copyright (c) 1999, 2000
.\" 	Matthias Drochner.  All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.Dd $Mdocdate: March 16 2008 $
.Dt VGA 4
.Os
.Sh NAME
.Nm vga
.Nd VGA graphics driver for wscons
.Sh SYNOPSIS
.Cd "vga0 at isa?"
.Cd "vga* at pci?"
.Cd "wsdisplay* at vga?"
.Cd "agp* at vga?"
.Sh DESCRIPTION
This driver handles VGA graphics hardware within the
.Xr wscons 4
console framework.
It doesn't provide direct device driver entry points but makes its
functions available via the internal
.Xr wsdisplay 4
interface.
.Pp
The
.Nm
driver supports multiple virtual screens on one physical display.
The screens allocated on one display can be of different
.Dq types ,
where a type refers to various display properties.
The type is determined at the time the virtual screen is created and can't
be changed later.
Screens are either created at kernel startup (then the default type is used)
or later with help of the
.Xr wsconscfg 8
utility.
.Pp
Currently, the following screen types are supported:
.Bl -hang
.It 80x25
This is the standard VGA text mode with 80 columns and 25 rows.
16 different colors can be displayed at the same time.
Characters are 8 x 16 pixels large, and a font consists of 256 characters.
A built-in font of this size is always present on a VGA card.
It's also possible to use a downloaded font instead.
.It 80x25bf
A modified version of the previous.
It only allows 8 colors to be displayed.
In exchange, it can access two fonts at the same time, so that 512
different characters can be displayed.
.It 80x40
A text mode with 80 columns and 40 rows.
Similar to the standard mode, 16 colors and 256 characters are available.
Characters are 8 x 10 pixels large.
For this mode to be useful, a font of that character size must be downloaded.
.It 80x40bf
A modified version of the previous.
It only allows 8 colors to be displayed.
In exchange, it can access two fonts at the same time, so that 512
different characters can be displayed.
.It 80x50
A text mode with 80 columns and 50 rows.
Similar to the standard mode, 16 colors and 256 characters are available.
Characters are 8 x 8 pixels large.
For this mode to be useful, a font of that character size must be downloaded.
.It 80x50bf
A modified version of the previous.
It only allows 8 colors to be displayed.
In exchange, it can access two fonts at the same time, so that 512
different characters can be displayed.
.It 80x24
A variant of the
.Dq 80x25
screen type which displays 24 lines only.
It uses the standard 8x16 VGA font.
This mode might be useful for applications which depend on closer
DEC VT100 compatibility.
.It 80x24bf
A modified version of the previous.
It only allows 8 colors to be displayed.
In exchange, it can access two fonts at the same time, so that 512
different characters can be displayed.
.El
.Pp
The
.Nm
driver can display fonts of the original IBM type and ISO-8859-1 encoded fonts.
.Sh SEE ALSO
.Xr agp 4 ,
.Xr intro 4 ,
.Xr isa 4 ,
.Xr pcdisplay 4 ,
.Xr pci 4 ,
.Xr wscons 4 ,
.Xr wsdisplay 4 ,
.Xr wsconscfg 8 ,
.Xr wsfontload 8
.Sh BUGS
Only a subset of the possible text modes is supported.
.Pp
VGA cards are supposed to emulate an MDA if a monochrome display is connected.
In this case, the device will naturally not support colors at all, but
offer the capability to display underlined characters instead.
The
.Dq 80x25bf ,
.Dq 80x40bf ,
.Dq 80x50bf ,
and
.Dq 80x24bf
screen types will not be available.
This mode of operation is not tested.
@


1.16
log
@some more agp/vga bits;
@
text
@d1 1
a1 1
.\" $OpenBSD: vga.4,v 1.15 2007/11/25 17:11:12 oga Exp $
d28 1
a28 1
.Dd $Mdocdate: November 25 2007 $
a110 11
As an experimental feature, the
.Dq higher half
fonts of the former
.Ox Ns /i386
pcvt driver distribution can be used too if
.Ic option WSCONS_SUPPORT_PCVTFONTS
was set at kernel compile time.
This is only useful with the
.Dq *bf
screen types; a font containing the ASCII
range of characters must be available too on this screen.
@


1.15
log
@Make agp attach as a device. This means that many more agp bridges
actually get detected and attached. Also adds a kernel api for
manipulating agp.

Enable this on i386 and amd64.

"I think you should commit it" deraadt@@, ok matthieu. Looked over by
several others.
@
text
@d1 1
a1 1
.\" $OpenBSD: vga.4,v 1.14 2007/05/31 19:19:53 jmc Exp $
d28 1
a28 1
.Dd $Mdocdate: May 31 2007 $
d38 1
d123 1
@


1.14
log
@convert to new .Dd format;
@
text
@d1 1
a1 1
.\" $OpenBSD: vga.4,v 1.13 2006/03/23 10:47:34 jmc Exp $
d28 1
a28 1
.Dd $Mdocdate$
a37 1
.Cd "option PCIAGP"
a120 102
.Sh AGP SUPPORT
.Ic option PCIAGP
enables support for programming the AGP GART through
.Xr ioctl 2 ,
which is used by the X server on some architectures.
.Pp
The following
.Xr ioctl 2
operations can be performed on
.Pa /dev/ttyC0 ,
and are defined in
.Aq Pa sys/agpio.h :
.Bl -tag -width indent
.It Dv AGPIOC_INFO
Returns information about the AGP subsystem.
The result is a pointer to the following structure:
.Bd -literal
typedef struct _agp_info {
	agp_version version;  /* version of driver (unused)   */
	u_int32_t bridge_id;  /* bridge vendor/device         */
	u_int32_t agp_mode;   /* mode info of bridge          */
	off_t aper_base;      /* base of aperture             */
	size_t aper_size;     /* size of aperture             */
	size_t pg_total;      /* max pages (swap + system)    */
	size_t pg_system;     /* max pages (system)           */
	size_t pg_used;       /* current pages used           */
} agp_info;
.Ed
.It Dv AGPIOC_ACQUIRE
Acquire control of the AGP chipset for use by this client.
Returns
.Er EBUSY
if the AGP chipset is already acquired by another client.
.It Dv AGPIOC_RELEASE
Release control of the AGP chipset.
This does not unbind or free any allocated memory, which is the
responsibility of the client to handle if necessary.
.It Dv AGPIOC_SETUP
Enable the AGP hardware with the relevant mode.
This
.Xr ioctl 2
takes the following structure:
.Bd -literal
typedef struct _agp_setup {
	u_int32_t agp_mode;   /* mode info of bridge */
} agp_setup;
.Ed
.Pp
The mode bits are defined in
.Aq Pa sys/agpio.h .
.It Dv AGPIOC_ALLOCATE
Allocate physical memory suitable for mapping into the AGP aperture.
This
.Xr ioctl 2
takes the following structure:
.Bd -literal
typedef struct _agp_allocate {
	int key;              /* tag of allocation            */
	size_t pg_count;      /* number of pages              */
	u_int32_t type;       /* 0 == normal, other devspec   */
	u_int32_t physical;   /* device specific (some devices
			       * need a phys address of the
			       * actual page behind the gatt
			       * table)                       */
} agp_allocate;
.Ed
.Pp
It returns a handle to the allocated memory.
.It Dv AGPIOC_DEALLOCATE
Free the previously allocated memory associated with the handle passed.
.It Dv AGPIOC_BIND
Bind the allocated memory at given offset with the AGP aperture.
Returns
.Er EINVAL
if the memory is already bound or the offset is not at AGP page boundary.
This
.Xr ioctl 2
takes the following structure:
.Bd -literal
typedef struct _agp_bind {
	int key;         /* tag of allocation            */
	off_t pg_start;  /* starting page to populate    */
} agp_bind;
.Ed
.Pp
The tag of allocation is the handle returned by
.Dv AGPIOC_ALLOCATE .
.It Dv AGPIOC_UNBIND
Unbind memory from the AGP aperture.
Returns
.Er EINVAL
if the memory is not bound.
This
.Xr ioctl 2
takes the following structure:
.Bd -literal
typedef struct _agp_unbind {
	int key;                /* tag of allocation         */
	u_int32_t priority;     /* priority for paging out   */
} agp_unbind;
.Ed
.El
a121 1
.Xr ioctl 2 ,
@


1.13
log
@tweaks;
@
text
@d1 1
a1 1
.\" $OpenBSD: vga.4,v 1.12 2006/03/16 21:33:17 deraadt Exp $
d28 1
a28 1
.Dd March 20, 1999
@


1.12
log
@some clarifications on the AGP support
@
text
@d1 1
a1 1
.\" $OpenBSD: vga.4,v 1.10 2005/05/04 05:05:32 jaredy Exp $
a121 1
.Pp
a122 1
The
d132 2
a133 2
which are defined in
.In sys/agpio.h :
d171 1
a171 1
.In sys/agpio.h .
d189 1
a189 1
Returns a handle to the allocated memory.
d225 1
d233 1
a233 2
.Xr wsfontload 8 ,
.Xr ioctl 2
@


1.11
log
@Document the APGIOC_XXX ioctls and associated structures.

ok matthieu@@
@
text
@d124 1
d128 1
a128 3
which is used by
.Xr Xorg 1
on some architectures.
@


1.10
log
@- change XFree86 -> X.Org
- minor mdoc nits

ok matthieu, jmc
@
text
@d1 1
a1 1
.\" $OpenBSD: vga.4,v 1.9 2004/09/30 19:59:26 mickey Exp $
d123 1
d125 1
a125 1
enables support for the AGP GART programming through
d127 1
a127 1
for use by
d130 97
d235 2
a236 1
.Xr wsfontload 8
@


1.9
log
@kill default locators
@
text
@d1 1
a1 1
.\" $OpenBSD: vga.4,v 1.8 2003/03/18 12:53:57 david Exp $
d113 4
a116 2
fonts of the former OpenBSD/i386 pcvt driver distribution can be used too if
.Em option WSCONS_SUPPORT_PCVTFONTS
d123 2
a124 2
.Em option PCIAGP
enables support for the AGP GART programming through the
d126 2
a127 2
for use by the
.Xr XFree86 1
@


1.8
log
@spelling typos/errors
ok miod@@ jmc@@
@
text
@d1 1
a1 1
.\" $OpenBSD: vga.4,v 1.7 2003/02/19 09:01:47 jmc Exp $
d37 1
a37 1
.Cd "wsdisplay* at vga? console ?"
@


1.7
log
@copyrights added;

these are all Matthias Drochner, except:

gsckbd(4): miod@@ + Drochner
wsdisplay(4): Harris + Drochner
@
text
@d1 1
a1 1
.\" $OpenBSD: vga.4,v 1.6 2002/09/26 22:09:53 miod Exp $
d75 1
a75 1
A text mode with 80 colums and 40 rows.
d85 1
a85 1
A text mode with 80 colums and 50 rows.
@


1.6
log
@Second part of the man4 mi cleanup.
- more/better xrefs
- sync .Cd lines with actual configuration files
- intro(4) reference police
- huge usb(4) update
- follow mdoc.samples suggested man page section ordering when necessary
- add netintro(4) and hostname.if(5) xrefs to all ethernet drivers

ok deraadt@@ mickey@@
@
text
@d1 1
a1 1
.\" $OpenBSD: vga.4,v 1.5 2002/07/12 21:44:48 mickey Exp $
d3 24
@


1.5
log
@pciagp option description
@
text
@d1 1
a1 1
.\" $OpenBSD: vga.4,v 1.4 2002/06/30 21:45:25 deraadt Exp $
d104 1
d109 1
@


1.4
log
@Xr cleanup; seb@@todesplanet.de
@
text
@d1 1
a1 1
.\" $OpenBSD: vga.4,v 1.3 2001/03/27 22:44:54 aaron Exp $
d14 1
d96 7
@


1.3
log
@Rearrange title macros into the correct order.
@
text
@d1 1
a1 1
.\" $OpenBSD: vga.4,v 1.2 2000/12/21 21:01:21 aaron Exp $
d88 1
a88 3
fonts of the former OpenBSD/i386
.Xr pcvt 4
driver distribution can be used too if
@


1.2
log
@Various repairs, $Id$ tags added, etc.
@
text
@d1 1
a1 1
.\" $OpenBSD: vga.4,v 1.1 2000/11/15 21:03:00 aaron Exp $
d5 1
a6 1
.Dt VGA 4
@


1.1
log
@Manual page for vga(4); from NetBSD.
@
text
@d1 1
a1 1
.\" $OpenBSD$
d3 1
@

