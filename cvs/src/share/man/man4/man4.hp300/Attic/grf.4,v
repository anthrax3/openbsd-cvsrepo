head	1.15;
access;
symbols
	OPENBSD_3_6:1.13.0.6
	OPENBSD_3_6_BASE:1.13
	OPENBSD_3_5:1.13.0.4
	OPENBSD_3_5_BASE:1.13
	OPENBSD_3_4:1.13.0.2
	OPENBSD_3_4_BASE:1.13
	OPENBSD_3_3:1.9.0.2
	OPENBSD_3_3_BASE:1.9
	OPENBSD_3_2:1.7.0.2
	OPENBSD_3_2_BASE:1.7
	OPENBSD_3_1:1.6.0.4
	OPENBSD_3_1_BASE:1.6
	OPENBSD_3_0:1.6.0.2
	OPENBSD_3_0_BASE:1.6
	OPENBSD_2_9:1.4.0.2
	OPENBSD_2_9_BASE:1.4
	OPENBSD_2_8:1.3.0.4
	OPENBSD_2_8_BASE:1.3
	OPENBSD_2_7:1.3.0.2
	OPENBSD_2_7_BASE:1.3
	OPENBSD_2_6:1.2.0.2
	OPENBSD_2_6_BASE:1.2
	OPENBSD_2_5:1.1.1.1.0.12
	OPENBSD_2_5_BASE:1.1.1.1
	OPENBSD_2_4:1.1.1.1.0.10
	OPENBSD_2_4_BASE:1.1.1.1
	OPENBSD_2_3:1.1.1.1.0.8
	OPENBSD_2_3_BASE:1.1.1.1
	OPENBSD_2_2:1.1.1.1.0.6
	OPENBSD_2_2_BASE:1.1.1.1
	OPENBSD_2_1:1.1.1.1.0.4
	OPENBSD_2_1_BASE:1.1.1.1
	OPENBSD_2_0:1.1.1.1.0.2
	OPENBSD_2_0_BASE:1.1.1.1
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@.\" @;


1.15
date	2005.01.14.22.39.21;	author miod;	state dead;
branches;
next	1.14;

1.14
date	2005.01.08.19.47.38;	author miod;	state Exp;
branches;
next	1.13;

1.13
date	2003.09.04.22.14.42;	author jmc;	state Exp;
branches;
next	1.12;

1.12
date	2003.06.02.23.30.13;	author millert;	state Exp;
branches;
next	1.11;

1.11
date	2003.05.17.21.34.45;	author jmc;	state Exp;
branches;
next	1.10;

1.10
date	2003.04.03.06.47.58;	author jmc;	state Exp;
branches;
next	1.9;

1.9
date	2003.03.19.11.14.25;	author miod;	state Exp;
branches;
next	1.8;

1.8
date	2003.03.16.20.12.50;	author miod;	state Exp;
branches;
next	1.7;

1.7
date	2002.10.01.07.12.30;	author miod;	state Exp;
branches;
next	1.6;

1.6
date	2001.10.05.14.45.53;	author mpech;	state Exp;
branches;
next	1.5;

1.5
date	2001.05.11.01.24.20;	author millert;	state Exp;
branches;
next	1.4;

1.4
date	2000.12.15.14.31.20;	author aaron;	state Exp;
branches;
next	1.3;

1.3
date	2000.03.02.14.46.46;	author todd;	state Exp;
branches;
next	1.2;

1.2
date	99.05.16.19.56.54;	author alex;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.44.28;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.44.28;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.15
log
@Switch OpenBSD/hp300 to wscons, still using on-board ROM fonts for now.

Main features:
- MI hil drivers, allowing live plug/unplug of devices, and the keyboard
  does not need to be at id 1 anymore.
- SGC bus support on 4xx models. SGC frame buffers are supported too, but
  not as console, though you can use them as a regular glass terminal if
  you run a getty on ttyC0. Currently not compiled-in, awaiting for an sti(4)
  fix to be commited.
- HP-UX compatibility interfaces are removed. grfinfo and hilinfo are removed.

X11 support is currently broken by these changes; X.org X11R6 support will
be available very soon.

Tested on hyperion and 4 different flavours of catseye/topcat/kathmandu; other,
older frame buffers (davinci, gatorbox and renaissance) could not been tested
but should work; please report any regression.
@
text
@.\"	$OpenBSD: grf.4,v 1.14 2005/01/08 19:47:38 miod Exp $
.\"
.\" Copyright (c) 1990, 1991, 1993
.\"	The Regents of the University of California.  All rights reserved.
.\"
.\" This code is derived from software contributed to Berkeley by
.\" the Systems Programming Group of the University of Utah Computer
.\" Science Department.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. Neither the name of the University nor the names of its contributors
.\"    may be used to endorse or promote products derived from this software
.\"    without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.\"     from: @@(#)grf.4	8.1 (Berkeley) 6/9/93
.\"
.Dd June 9, 1993
.Dt GRF 4 hp300
.Os
.Sh NAME
.Nm grf
.Nd
.Tn HP
graphics frame buffer device interface
.Sh SYNOPSIS
.Cd "grf* at dvbox?"
.Cd "grf* at gbox?"
.Cd "grf* at hyper?"
.Cd "grf* at rbox?"
.Cd "grf* at topcat?"
.Cd ""
.Cd "ite* at grf?"
.Sh DESCRIPTION
This is a generic description of the frame buffer device interface.
.Pp
The devices to which this applies are the 98544, 98545 and 98547
Topcat graphics cards (also known as
.Tn HP300H
devices),
the 98548, 98549 and 98550
Catseye graphics cards,
the A1416A
Kathmandu graphics cards,
the 98700
Gatorbox graphics box,
the 98720
Renaissance graphics box,
the 98730
DaVinci graphics box,
and the A1096A
Hyperion graphics cards.
.Pp
The basic programming of the
.Nm grf Ns ?\&
devices involves opening the device
file, mapping the control registers and frame buffer addresses into user
space, and then manipulating the device as the application requires.
The address mapping is controlled by an
.Xr ioctl 2
call to map the device into user space, and an unmap call when finished.
.Pp
The ioctls supported by
.Ox
are:
.Bl -tag -width GRFIOCGINFO
.It Dv GRFIOCGINFO
Get Graphics Info
.Pp
Get info about device, setting the entries in the
.Em grfinfo
structure, as defined in
.Aq Pa machine/grfioctl.h :
.Bd -literal
struct	grfinfo {
	int	gd_id;		/* HP-UX identifier */
	caddr_t	gd_regaddr;	/* control registers physaddr */
	int	gd_regsize;	/* control registers size */
	caddr_t	gd_fbaddr;	/* frame buffer physaddr */
	int	gd_fbsize;	/* frame buffer size */
	short	gd_colors;	/* number of colors */
	short	gd_planes;	/* number of planes */
/* new stuff */
	int	gd_fbwidth;	/* frame buffer width */
	int	gd_fbheight;	/* frame buffer height */
	int	gd_dwidth;	/* displayed part width */
	int	gd_dheight;	/* displayed part height */
	int	gd_pad[6];	/* for future expansion */
};
.Ed
.It Dv GRFIOCON
Graphics On
.Pp
Turn graphics on by enabling
.Tn CRT
output.
The screen will come on, displaying whatever is in the frame buffer, using
whatever colormap is in place.
.It Dv GRFIOCOFF
Graphics Off
.Pp
Turn graphics off by disabling output to the
.Tn CRT .
The frame buffer contents
are not affected.
.It Dv GRFIOCMAP
Map Device to user space
.Pp
Map in control registers and frame buffer space.
Once the device file is mapped, the frame buffer memory and registers
are accessible.
.It Dv GRFIOCUNMAP
Unmap Device
.Pp
Unmap control registers and frame buffer space.
.El
.Sh FILES
.Bl -tag -width /dev/XXXX -compact
.It Pa /dev/grf?
.Ox
interface special files
.El
.Sh EXAMPLES
This short code fragment is an example of opening some graphics device and
mapping in the control and frame buffer space:
.Bd -literal
#define GRF_DEV <some_graphics_device>  /* /dev/grfN */

struct fbstruct *regs;  /*  fbstruct = gboxfb, rboxfb, etc. */
u_char *Addr, frame_buffer;
struct grfinfo gi;
int disp_fd;

disp_fd = open(GRF_DEV, O_WRONLY);
if (ioctl(disp_fd, GRFIOCGINFO, &gi) < 0) return -1;
ioctl(disp_fd, GRFIOCON, 0);

if (ioctl(disp_fd, GRFIOCMAP, &Addr) < 0) {
	ioctl(disp_fd, GRFIOCOFF, 0);
	return -1;
}
regs = (fbstruct *)Addr;               /* Control Registers   */
frame_buffer = (u_char *)Addr + gi.gd_regsize; /* Frame buffer mem */
.Ed
.Sh DIAGNOSTICS
None under
.Ox .
.Pp
.Tn HP-UX
The
.Tn CE.utilities/Crtadjust
programs, running in
.Tn HP-UX
compatibility mode,
can be used for each specific device.
.Sh SEE ALSO
.Xr ioctl 2 ,
.Xr dvbox 4 ,
.Xr gbox 4 ,
.Xr hil 4 ,
.Xr hyper 4 ,
.Xr intro 4 ,
.Xr ite 4 ,
.Xr rbox 4 ,
.Xr topcat 4
@


1.14
log
@Kill useless cons.4 manpage.
@
text
@d1 1
a1 1
.\"	$OpenBSD: grf.4,v 1.13 2003/09/04 22:14:42 jmc Exp $
@


1.13
log
@put escapes in the right place;
(i.e. stuff I got wrong the first time, or missed)

this includes some .Cd's with missing quotes and .Nm abuse in man4;
@
text
@d1 1
a1 1
.\"	$OpenBSD: grf.4,v 1.12 2003/06/02 23:30:13 millert Exp $
a175 1
.Xr cons 4 ,
@


1.12
log
@Remove the advertising clause in the UCB license which Berkeley
rescinded 22 July 1999.  Proofed by myself and Theo.
@
text
@d1 1
a1 1
.\"	$OpenBSD: grf.4,v 1.11 2003/05/17 21:34:45 jmc Exp $
d73 1
a73 1
.Nm grf Ns ?
@


1.11
log
@whitespace at EOL;
@
text
@d1 1
a1 1
.\"	$OpenBSD: grf.4,v 1.10 2003/04/03 06:47:58 jmc Exp $
d18 1
a18 5
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgement:
.\"	This product includes software developed by the University of
.\"	California, Berkeley and its contributors.
.\" 4. Neither the name of the University nor the names of its contributors
@


1.10
log
@HPUX, HP/UX -> HP-UX

ok mickey@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: grf.4,v 1.9 2003/03/19 11:14:25 miod Exp $
d118 2
a119 2
output.  
The screen will come on, displaying whatever is in the frame buffer, using 
@


1.9
log
@Mention the Kathmandu frame buffer as being supported as one of the best
felines.
@
text
@d1 1
a1 1
.\"	$OpenBSD: grf.4,v 1.8 2003/03/16 20:12:50 miod Exp $
d98 1
a98 1
	int	gd_id;		/* HPUX identifier */
@


1.8
log
@Your average hp300 manual page overhaul for the release:
- clean/rewrite frame buffer manual page, with correct names, and add hyper.
- add missing manual pages, mostly from NetBSD
- harmonize texts, rebalance .Bl lists, sprinkle useful .Xr
@
text
@d1 1
a1 1
.\"	$OpenBSD: grf.4,v 1.7 2002/10/01 07:12:30 miod Exp $
d65 2
@


1.7
log
@More manpage cleaning:
- coherent .Xr
- fix or add .Cd lines, fix device nodes names, etc.
- put sections in right order
- coherent ``frame buffer'' spelling
- KNF code examples (open("foo",1) my ass)
- provide an hp300 specific sd(4) as hp300 does not use the regular scsi
  subsystem (...yet).
- .Bx -> .Ox whenever appropriate
- other various random sweeping

ok deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: grf.4,v 1.6 2001/10/05 14:45:53 mpech Exp $
d54 1
a54 1
.Pp
d58 1
d60 1
a60 1
Topcat display cards (also known as
d64 1
a64 1
Catseye display cards,
d69 4
a72 2
and the 98730
DaVinci graphics box.
d82 1
d86 1
a86 1
.Bl -tag -width indent
d130 2
a131 1
Once the device file is mapped, the frame buffer structure is accessible.
a136 2
.Pp
For further information about the use of ioctl see the man page.
d168 1
d172 4
a175 1
programs must be used for each specific device.
d179 2
a180 2
.Xr dv 4 ,
.Xr gb 4 ,
d182 1
a182 1
.\" .Xr hyper 4 ,
d185 2
a186 2
.Xr rb 4 ,
.Xr tc 4
@


1.6
log
@Powered by @@mantoya:
o) start new sentence on a new line;
o) minor mdoc fixes;
millert@@ ok

Tip of the day:   www.mpechismazohist.com
@
text
@d1 1
a1 1
.\"	$OpenBSD: grf.4,v 1.5 2001/05/11 01:24:20 millert Exp $
d48 8
a70 32
Use of the devices can be effectively approached from two directions.
The first is through
.Tn HP-UX
.Em Starbase
routines, the second is by direct control in the
.Bx
environment.
In order to use the Starbase libraries,
code must be compiled in an
.Tn HP-UX
environment, either by doing so on an
.Tn HP-UX
machine and transferring the binaries to the
.Bx
machine, or by compilation
with the use of the
.Xr hpux 1
command.
Applications using Starbase libraries have been run successfully
on
.Bx
machines using both of these compilation techniques.
.Pp
Direct compilation,
such as that used for the X Window System servers, has also been successful.
Examples of some frame buffer operations can be found in
the device dependent X Window system sources, for example the
.Pa /usr/src/new/X/libhp.fb
directory.
These files contain examples of device dependent color map initialization, 
frame buffer operations, bit moving routines etc.
.Pp
d80 1
a80 1
.Bx
d88 2
a89 1
structure, as defined in <hpdev/grfioctl.h>:
d125 1
a125 1
Map in control registers and framebuffer space.
d130 1
a130 1
Unmap control registers and framebuffer space.
d134 6
a144 5
{
	struct fbstruct *regs;  /*  fbstruct = gboxfb, rboxfb, etc. */
	u_char *Addr, frame_buffer;
	struct grfinfo gi;
	int disp_fd;
d146 4
a149 3
	disp_fd = open(GRF_DEV,1);
	if (ioctl (disp_fd, GRFIOCGINFO, &gi) < 0) return -1;
	(void) ioctl (disp_fd, GRFIOCON, 0);
d151 7
a157 7
	Addr = (u_char *) 0;
	if (ioctl (disp_fd, GRFIOCMAP, &Addr) < 0) {
		(void) ioctl (disp_fd, GRFIOCOFF, 0);
		return -1;
	}
	regs = (fbstruct *) Addr;               /* Control Registers   */
	frame_buffer = (u_char *) Addr + gi.gd_regsize; /* Frame buffer mem */
d159 2
a161 10
.Sh FILES
.Bl -tag -width /dev/*crt*? -compact
.It Pa /dev/grf?
.Bx
interface special files
.It Pa /dev/*crt*
.Tn HP-UX
.Em starbase
interface special files
.El
d164 1
a164 1
.Bx .
a168 9
.Sh ERRORS
.Bl -tag -width [EINVAL]
.It Bq Er ENODEV
no such device.
.It Bq Er EBUSY
Another process has the device open.
.It Bq Er EINVAL
Invalid ioctl specification.
.El
d171 1
d175 3
@


1.5
log
@o Minor updates from 4.4BSD
o Renamed rd.4 -> hd.4 since OpenBSD calls this device hd, not rd
o Fixed up device sections to matchg config.new
o Added /dev/cua* to FILES sections where sensible
o We don't have an RMP option since rbootd uses bpf
o A few other minor wording fixes
@
text
@d1 1
a1 1
.\"	$OpenBSD: grf.4,v 1.4 2000/12/15 14:31:20 aaron Exp $
d91 3
a93 2
directory.  These files contain examples of device dependent color map
initialization, frame buffer operations, bit moving routines etc.
d135 3
a137 2
output.  The screen will come on, displaying
whatever is in the frame buffer, using whatever colormap is in place.
d148 2
a149 2
Map in control registers and framebuffer space. Once the device file is
mapped, the frame buffer structure is accessible.
@


1.4
log
@.Sh EXAMPLE -> .Sh EXAMPLES. Even if there's only one example, at least
this is consistent.
@
text
@d1 1
a1 1
.\"	$OpenBSD: grf.4,v 1.3 2000/03/02 14:46:46 todd Exp $
d3 2
a4 2
.\" Copyright (c) 1990, 1991 The Regents of the University of California.
.\" All rights reserved.
d9 1
d38 1
a38 1
.\"     from: @@(#)grf.4	5.3 (Berkeley) 7/31/91
d40 1
a40 1
.Dd July 31, 1991
a211 5
.Sh HISTORY
The
.Nm
driver
.Ud
@


1.3
log
@$OpenBSD$
@
text
@d1 2
a2 1
.\"	$OpenBSD: grf.4,v 1.2 1999/05/16 19:56:54 alex Exp $
d154 1
a154 1
.Sh EXAMPLE
@


1.2
log
@Cleanup xrefs under SEE ALSO.  Specifically:

  - Sort xrefs by section, and then alphabetically.
  - Add missing commas between xref items.
  - Remove commas from the last xref entry.
  - Remove duplicate entries.
@
text
@d1 1
a36 1
.\"	$Id: grf.4,v 1.1.1.1 1995/10/18 08:44:28 deraadt Exp $
@


1.1
log
@Initial revision
@
text
@d36 1
a36 1
.\"	$Id: grf.4,v 1.2 1993/08/01 07:56:31 mycroft Exp $
d207 1
d209 1
a209 2
.Xr tc 4 ,
.Xr hil 4
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
