head	1.19;
access;
symbols
	OPENBSD_6_0:1.19.0.8
	OPENBSD_6_0_BASE:1.19
	OPENBSD_5_9:1.19.0.2
	OPENBSD_5_9_BASE:1.19
	OPENBSD_5_8:1.19.0.4
	OPENBSD_5_8_BASE:1.19
	OPENBSD_5_7:1.18.0.4
	OPENBSD_5_7_BASE:1.18
	OPENBSD_5_6:1.17.0.26
	OPENBSD_5_6_BASE:1.17
	OPENBSD_5_5:1.17.0.24
	OPENBSD_5_5_BASE:1.17
	OPENBSD_5_4:1.17.0.20
	OPENBSD_5_4_BASE:1.17
	OPENBSD_5_3:1.17.0.18
	OPENBSD_5_3_BASE:1.17
	OPENBSD_5_2:1.17.0.16
	OPENBSD_5_2_BASE:1.17
	OPENBSD_5_1_BASE:1.17
	OPENBSD_5_1:1.17.0.14
	OPENBSD_5_0:1.17.0.12
	OPENBSD_5_0_BASE:1.17
	OPENBSD_4_9:1.17.0.10
	OPENBSD_4_9_BASE:1.17
	OPENBSD_4_8:1.17.0.8
	OPENBSD_4_8_BASE:1.17
	OPENBSD_4_7:1.17.0.4
	OPENBSD_4_7_BASE:1.17
	OPENBSD_4_6:1.17.0.6
	OPENBSD_4_6_BASE:1.17
	OPENBSD_4_5:1.17.0.2
	OPENBSD_4_5_BASE:1.17
	OPENBSD_4_4:1.16.0.4
	OPENBSD_4_4_BASE:1.16
	OPENBSD_4_3:1.16.0.2
	OPENBSD_4_3_BASE:1.16
	OPENBSD_4_2:1.15.0.2
	OPENBSD_4_2_BASE:1.15
	OPENBSD_4_1:1.12.0.4
	OPENBSD_4_1_BASE:1.12
	OPENBSD_4_0:1.12.0.2
	OPENBSD_4_0_BASE:1.12
	OPENBSD_3_9:1.10.0.4
	OPENBSD_3_9_BASE:1.10
	OPENBSD_3_8:1.10.0.2
	OPENBSD_3_8_BASE:1.10
	OPENBSD_3_7:1.9.0.4
	OPENBSD_3_7_BASE:1.9
	OPENBSD_3_6:1.9.0.2
	OPENBSD_3_6_BASE:1.9
	OPENBSD_3_5:1.8.0.2
	OPENBSD_3_5_BASE:1.8
	OPENBSD_3_4:1.6.0.2
	OPENBSD_3_4_BASE:1.6
	OPENBSD_3_3:1.4.0.4
	OPENBSD_3_3_BASE:1.4
	OPENBSD_3_2:1.4.0.2
	OPENBSD_3_2_BASE:1.4
	OPENBSD_3_1:1.3.0.2
	OPENBSD_3_1_BASE:1.3;
locks; strict;
comment	@.\" @;


1.19
date	2015.05.28.20.53.05;	author jcs;	state Exp;
branches;
next	1.18;
commitid	mm0ThjDof6ifWCwA;

1.18
date	2015.01.15.20.37.36;	author schwarze;	state Exp;
branches;
next	1.17;
commitid	VwT6DmpwXYKHzEuv;

1.17
date	2008.11.01.22.36.05;	author jmc;	state Exp;
branches;
next	1.16;

1.16
date	2008.01.18.08.50.01;	author sthen;	state Exp;
branches;
next	1.15;

1.15
date	2007.08.01.21.23.27;	author miod;	state Exp;
branches;
next	1.14;

1.14
date	2007.05.31.19.19.53;	author jmc;	state Exp;
branches;
next	1.13;

1.13
date	2007.05.23.20.28.20;	author jmc;	state Exp;
branches;
next	1.12;

1.12
date	2006.03.23.10.49.05;	author jmc;	state Exp;
branches;
next	1.11;

1.11
date	2006.03.15.21.04.15;	author deraadt;	state Exp;
branches;
next	1.10;

1.10
date	2005.04.20.01.30.26;	author jaredy;	state Exp;
branches;
next	1.9;

1.9
date	2004.05.03.15.18.19;	author drahn;	state Exp;
branches;
next	1.8;

1.8
date	2004.03.22.20.31.37;	author miod;	state Exp;
branches;
next	1.7;

1.7
date	2004.02.07.20.08.53;	author miod;	state Exp;
branches;
next	1.6;

1.6
date	2003.06.06.10.29.41;	author jmc;	state Exp;
branches;
next	1.5;

1.5
date	2003.04.11.04.32.28;	author jmc;	state Exp;
branches;
next	1.4;

1.4
date	2002.08.24.17.21.44;	author matthieu;	state Exp;
branches;
next	1.3;

1.3
date	2002.03.27.15.21.22;	author jason;	state Exp;
branches;
next	1.2;

1.2
date	2002.03.27.15.19.13;	author jason;	state Exp;
branches;
next	1.1;

1.1
date	2002.02.23.18.30.13;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.19
log
@when machdep.allowaperture sysctl is set to 3, allow concurrent access
@
text
@.\"	$OpenBSD: xf86.4,v 1.18 2015/01/15 20:37:36 schwarze Exp $
.\"
.\" Copyright (c) 1998 Matthieu Herrb
.\" All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. The name of the author may not be used to endorse or promote products
.\"    derived from this software without specific prior written permission
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
.\" IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
.\" OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
.\" IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
.\" INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
.\" NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
.\" DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
.\" THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
.\" (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
.\" THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
.\"
.Dd $Mdocdate: January 15 2015 $
.Dt XF86 4
.Os
.Sh NAME
.Nm xf86
.Nd X Window System aperture driver
.Sh SYNOPSIS
.Cd "option APERTURE"
.Sh DESCRIPTION
On
the alpha, amd64, i386, macppc, and sparc64 architectures,
the
.Pa /dev/xf86
driver provides access to the memory and I/O ports of a VGA board
and to the PCI configuration registers
for use by the X servers
when running with a kernel security level greater than 0.
.Pp
The X servers require the use of this driver for
.Xr isa 4
or
.Xr pci 4
video cards on
.Ar alpha ,
.Ar amd64 ,
.Ar i386 ,
.Ar macppc ,
and
.Ar sparc64 .
.Sh ACCESS CONTROL
Access to the
.Pa /dev/xf86
device is allowed when the
.Xr sysctl 8
variable
.Va machdep.allowaperture
is greater than or equal to 1.
This variable (which has a default value of 0)
can only be raised when the security level
is less than or equal to 0, so it should be
set in
.Pa /etc/sysctl.conf .
The possible values for
.Va machdep.allowaperture
are:
.Bl -tag -width Ds
.It 0
the aperture driver is disabled.
Opening it returns
.Dv EPERM .
.It 1
the aperture driver allows access to standard VGA framebuffer and BIOS.
Access to
.Xr pci 4
configuration registers is also allowed.
.It 2
in addition to allowing access to
.Xr pci 4
configuration registers,
the aperture driver allows access to the whole first megabyte of physical
memory, permitting use of the int10 emulation in X.Org 6.8 and later.
Note that this can cause some security problems, since the process that
has access to the aperture driver can also access part of the kernel
memory.
This mode is not supported on alpha or sparc64.
.It 3
the aperture driver allows multiple processes to concurrently access
.Xr pci 4
configuration registers and the whole first megabyte of physical memory.
.El
.Sh SEE ALSO
.Xr Xorg 1 ,
.Xr options 4 ,
.Xr pci 4 ,
.Xr sysctl.conf 5 ,
.Xr securelevel 7 ,
.Xr config 8 ,
.Xr sysctl 8
.Sh HISTORY
.Pa /dev/xf86
was integrated as an in-kernel device on
.Ox 2.3 .
It is required in order to allow access to I/O ports for all X servers since
.Ox 2.4 .
.Sh AUTHORS
The aperture driver was written by
.An Matthieu Herrb .
.Sh BUGS
This driver allows access to all addresses above
.Va physmem .
It should be restricted to the actual address range of the video
memory.
@


1.18
log
@Use .An in the AUTHORS section where appropriate;
from Kaspars at Bankovskis dot net
@
text
@d1 1
a1 1
.\"	$OpenBSD: xf86.4,v 1.17 2008/11/01 22:36:05 jmc Exp $
d28 1
a28 1
.Dd $Mdocdate: November 1 2008 $
d93 4
@


1.17
log
@no such pages as XF86_Accel(1) or XF86_SVGA(1), so kill refs to them;
@
text
@d1 1
a1 1
.\"	$OpenBSD: xf86.4,v 1.16 2008/01/18 08:50:01 sthen Exp $
d28 1
a28 1
.Dd $Mdocdate: January 18 2008 $
d109 2
a110 1
The aperture driver was written by Matthieu Herrb.
@


1.16
log
@macpppc -> macppc

ok jmc
@
text
@d1 1
a1 1
.\"	$OpenBSD: xf86.4,v 1.15 2007/08/01 21:23:27 miod Exp $
d28 1
a28 1
.Dd $Mdocdate: August 1 2007 $
a95 2
.Xr XF86_Accel 1 ,
.Xr XF86_SVGA 1 ,
@


1.15
log
@Retire OpenBSD/cats. Hardware is nice but prone to catch fire, and the firmware
is anything but useful. Nevertheless this was a very good platform to use as
an OpenBSD/*arm* starting point, but nowadays this platform is not necessary
anymore.

Somehow these CATS motherboard are just like AUI hubs, with the difference that,
when my AUI hub caught fire, 10base5 support was not removed from the networking
code.
@
text
@d1 1
a1 1
.\"	$OpenBSD: xf86.4,v 1.14 2007/05/31 19:19:53 jmc Exp $
d28 1
a28 1
.Dd $Mdocdate: May 31 2007 $
d54 1
a54 1
.Ar macpppc ,
@


1.14
log
@convert to new .Dd format;
@
text
@d1 1
a1 1
.\"	$OpenBSD: xf86.4,v 1.13 2007/05/23 20:28:20 jmc Exp $
d28 1
a28 1
.Dd $Mdocdate$
d38 1
a38 1
the alpha, amd64, cats, i386, macppc, and sparc64 architectures,
@


1.13
log
@"X Window System", in line with the rest of our docs;
@
text
@d1 1
a1 1
.\"	$OpenBSD: xf86.4,v 1.12 2006/03/23 10:49:05 jmc Exp $
d28 1
a28 1
.Dd February 20, 1998
@


1.12
log
@deprive theo of his love for `Ns';
@
text
@d1 1
a1 1
.\"	$OpenBSD: xf86.4,v 1.11 2006/03/15 21:04:15 deraadt Exp $
d33 1
a33 1
.Nd X window system aperture driver
@


1.11
log
@mention machdep.allowaperture can be lowered
(and remove mention of XFree86 snuck in here by someone who did NOT
understand how wrong that is)
@
text
@d1 1
a1 1
.\"	$OpenBSD: xf86.4,v 1.10 2005/04/20 01:30:26 jaredy Exp $
d56 1
a56 1
.Ar sparc64 Ns .
@


1.10
log
@update to reflect that this is also used for X.Org

and do some minor cleaning while here.

bits from matthieu, ok jmc
@
text
@d1 1
a1 1
.\"	$OpenBSD: xf86.4,v 1.9 2004/05/03 15:18:19 drahn Exp $
d46 11
a56 1
The XFree86 and X.Org X servers require the use of this driver.
d66 1
a66 1
can only be manipulated when the security level
d88 1
a88 2
memory, permitting use of the int10 emulation in XFree86 4.x and X.Org 6.8
and later.
d106 1
a106 4
was introduced as a loadable kernel module for
.Nx 0.9 c
with XFree86 3.1.
It was integrated as an in-kernel device on
@


1.9
log
@Remove OpenBSD/pegaos, this has been announced before but delayed until
the tree was stable. No point in code supporting a company which screws
its employees being in the OpenBSD tree.
@
text
@d1 1
a1 1
.\"	$OpenBSD: xf86.4,v 1.7 2004/02/07 20:08:53 miod Exp $
d33 1
a33 1
.Nd XFree86 aperture driver
d38 1
a38 7
.Va alpha ,
.Va amd64 ,
.Va cats ,
.Va i386 ,
.Va macppc ,
and
.Va sparc64
d43 2
a44 2
for use by the XFree86 X servers
when running with a kernel security level > 0.
d46 1
a46 1
The X servers require the use of this driver.
d50 3
a52 1
device is allowed when the sysctl variable
d54 1
a54 1
>= 1.
d56 2
a57 1
can only be manipulated when the security level is <= 0, so it should be
d77 3
a79 2
the aperture driver allows access to the whole 1st megabyte of physical
memory, permitting use of the int10 emulation in XFree86 4.0.x.
d86 1
d92 1
@


1.8
log
@A potpourri of Xr and layout fixes.

ok deraadt@@
@
text
@a42 1
.Va pegasos
@


1.7
log
@amd64/cats MI touches, as well as a few pegasos mentions forgotten.
@
text
@d1 1
a1 1
.\"	$OpenBSD: xf86.4,v 1.6 2003/06/06 10:29:41 jmc Exp $
d39 2
@


1.6
log
@- section reorder
- some macro fixes
- kill whitespace at EOL
@
text
@d1 1
a1 1
.\"	$OpenBSD: xf86.4,v 1.5 2003/04/11 04:32:28 jmc Exp $
d40 2
a41 1
.Va macppc
@


1.5
log
@typos;

wscons(4): ok miod@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: xf86.4,v 1.4 2002/08/24 17:21:44 matthieu Exp $
d38 2
a39 2
.Va alpha Ns ,
.Va i386 Ns ,
d68 1
a68 1
.Dv EPERM.
@


1.4
log
@aperture driver for alpha. It works here the same as on i386
to allow access to VGA card's memory by mmapping /dev/xf86.
The macdep.allowaperture does also control /dev/pci access.
Ok miod@@, deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: xf86.4,v 1.3 2002/03/27 15:21:22 jason Exp $
d45 2
a46 2
driver provides access to the memory and I/O ports of a VGA board 
and to the PCI configuration registers 
d57 1
a57 1
This variable (which default value is 0)
d61 2
a62 2
The possible values for 
.Va machdep.allowaperture 
d68 1
a68 1
.Dv EPERM. 
@


1.3
log
@.Xr pci 4
@
text
@d1 1
a1 1
.\"	$OpenBSD: xf86.4,v 1.2 2002/03/27 15:19:13 jason Exp $
d38 1
d40 1
a40 1
.Va macppc Ns ,
d42 1
a42 1
.Va sparc64 Ns ,
d45 3
a47 2
driver provides access to the memory and I/O ports of a VGA board for
use by the XFree86 X servers
d83 1
a83 1
This mode is not supported on sparc64.
@


1.2
log
@sparc64 caveats
@
text
@d1 1
a1 1
.\"	$OpenBSD: xf86.4,v 1.1 2002/02/23 18:30:13 deraadt Exp $
d69 3
a71 1
Access to PCI configuration registers is also allowed.
d73 3
a75 1
in addition to allowing access to PCI configuration registers,
d87 1
@


1.1
log
@xf86 becomes a MI manpage
@
text
@d1 1
a1 1
.\"	$OpenBSD: xf86.4,v 1.16 2001/10/05 14:45:54 mpech Exp $
d37 3
a39 2
On the
.Va i386
d41 1
a41 1
.Va macppc Ns ,
d68 2
a69 2
the aperture driver allows access to standard VGA framebuffer and
BIOS.
d71 1
d76 2
a77 1
memory. 
@

