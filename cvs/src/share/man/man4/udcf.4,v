head	1.27;
access;
symbols
	OPENBSD_6_1:1.27.0.6
	OPENBSD_6_1_BASE:1.27
	OPENBSD_6_0:1.27.0.8
	OPENBSD_6_0_BASE:1.27
	OPENBSD_5_9:1.27.0.2
	OPENBSD_5_9_BASE:1.27
	OPENBSD_5_8:1.27.0.4
	OPENBSD_5_8_BASE:1.27
	OPENBSD_5_7:1.26.0.10
	OPENBSD_5_7_BASE:1.26
	OPENBSD_5_6:1.26.0.8
	OPENBSD_5_6_BASE:1.26
	OPENBSD_5_5:1.26.0.6
	OPENBSD_5_5_BASE:1.26
	OPENBSD_5_4:1.26.0.2
	OPENBSD_5_4_BASE:1.26
	OPENBSD_5_3:1.25.0.20
	OPENBSD_5_3_BASE:1.25
	OPENBSD_5_2:1.25.0.18
	OPENBSD_5_2_BASE:1.25
	OPENBSD_5_1_BASE:1.25
	OPENBSD_5_1:1.25.0.16
	OPENBSD_5_0:1.25.0.14
	OPENBSD_5_0_BASE:1.25
	OPENBSD_4_9:1.25.0.12
	OPENBSD_4_9_BASE:1.25
	OPENBSD_4_8:1.25.0.10
	OPENBSD_4_8_BASE:1.25
	OPENBSD_4_7:1.25.0.6
	OPENBSD_4_7_BASE:1.25
	OPENBSD_4_6:1.25.0.8
	OPENBSD_4_6_BASE:1.25
	OPENBSD_4_5:1.25.0.4
	OPENBSD_4_5_BASE:1.25
	OPENBSD_4_4:1.25.0.2
	OPENBSD_4_4_BASE:1.25
	OPENBSD_4_3:1.24.0.4
	OPENBSD_4_3_BASE:1.24
	OPENBSD_4_2:1.24.0.2
	OPENBSD_4_2_BASE:1.24
	OPENBSD_4_1:1.22.0.2
	OPENBSD_4_1_BASE:1.22
	OPENBSD_4_0:1.11.0.2
	OPENBSD_4_0_BASE:1.11;
locks; strict;
comment	@.\" @;


1.27
date	2015.06.07.20.13.13;	author claudio;	state Exp;
branches;
next	1.26;
commitid	7k4h3ygRQGKUJ4se;

1.26
date	2013.07.16.16.05.49;	author schwarze;	state Exp;
branches;
next	1.25;

1.25
date	2008.07.05.12.18.27;	author mbalmer;	state Exp;
branches;
next	1.24;

1.24
date	2007.05.31.19.19.52;	author jmc;	state Exp;
branches;
next	1.23;

1.23
date	2007.03.30.07.42.01;	author mbalmer;	state Exp;
branches;
next	1.22;

1.22
date	2006.12.17.09.58.28;	author mbalmer;	state Exp;
branches;
next	1.21;

1.21
date	2006.12.16.20.35.09;	author mbalmer;	state Exp;
branches;
next	1.20;

1.20
date	2006.12.09.14.52.21;	author mbalmer;	state Exp;
branches;
next	1.19;

1.19
date	2006.12.09.14.47.01;	author mbalmer;	state Exp;
branches;
next	1.18;

1.18
date	2006.12.09.13.29.12;	author mbalmer;	state Exp;
branches;
next	1.17;

1.17
date	2006.12.09.13.27.05;	author mbalmer;	state Exp;
branches;
next	1.16;

1.16
date	2006.12.09.13.13.55;	author jmc;	state Exp;
branches;
next	1.15;

1.15
date	2006.12.09.13.10.17;	author jmc;	state Exp;
branches;
next	1.14;

1.14
date	2006.12.08.21.19.34;	author deraadt;	state Exp;
branches;
next	1.13;

1.13
date	2006.10.27.11.29.06;	author mbalmer;	state Exp;
branches;
next	1.12;

1.12
date	2006.10.11.13.23.45;	author mbalmer;	state Exp;
branches;
next	1.11;

1.11
date	2006.06.12.09.44.52;	author mbalmer;	state Exp;
branches;
next	1.10;

1.10
date	2006.06.04.09.52.40;	author mbalmer;	state Exp;
branches;
next	1.9;

1.9
date	2006.05.28.18.52.16;	author mbalmer;	state Exp;
branches;
next	1.8;

1.8
date	2006.05.28.17.29.01;	author jmc;	state Exp;
branches;
next	1.7;

1.7
date	2006.04.27.14.19.30;	author jmc;	state Exp;
branches;
next	1.6;

1.6
date	2006.04.27.08.23.30;	author mbalmer;	state Exp;
branches;
next	1.5;

1.5
date	2006.04.21.16.46.34;	author mbalmer;	state Exp;
branches;
next	1.4;

1.4
date	2006.04.20.08.11.53;	author jmc;	state Exp;
branches;
next	1.3;

1.3
date	2006.04.19.22.11.24;	author miod;	state Exp;
branches;
next	1.2;

1.2
date	2006.04.19.21.57.32;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	2006.04.19.21.12.49;	author mbalmer;	state Exp;
branches;
next	;


desc
@@


1.27
log
@HBG is no more so no need to mention it in the man pages.
OK jmc@@
@
text
@.\" $OpenBSD: udcf.4,v 1.26 2013/07/16 16:05:49 schwarze Exp $
.\"
.\" Copyright (c) 2006 - 2008 Marc Balmer <mbalmer@@openbsd.org>
.\"
.\" Permission to use, copy, modify, and distribute this software for any
.\" purpose with or without fee is hereby granted, provided that the above
.\" copyright notice and this permission notice appear in all copies.
.\"
.\" THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
.\" WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
.\" MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
.\" ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
.\" WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
.\" ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
.\" OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
.\"
.Dd $Mdocdate: July 16 2013 $
.Dt UDCF 4
.Os
.Sh NAME
.Nm udcf
.Nd Gude ADS Expert mouseCLOCK USB timedelta sensor
.Sh SYNOPSIS
.Cd "udcf* at uhub?"
.Sh DESCRIPTION
The
.Nm
driver provides support for the Gude ADS Expert mouseCLOCK USB and
the Expert mouseCLOCK USB II, receivers for the German DCF77.
While receivers for the British MSF time signal station are also
being made,
.Nm
lacks support for them.
.Pp
.Nm
implements a timedelta sensor and the delta (in nanoseconds) between the
received time information and the local time can be accessed through the
.Xr sysctl 8
interface.
The clock type is indicated in the sensor description:
.Bl -tag -width "CRITICALXX" -offset indent
.It DCF77
German DCF77 time signal station
(77.5 kHz longwave transmitter located in Mainflingen near Frankfurt).
.El
.Pp
The quality of the timedelta is reported as the sensor status:
.Bl -tag -width "CRITICALXX" -offset indent
.It UNKNOWN
No valid time information has been received yet.
.It OK
The time information is valid and the timedelta is safe to use for
applications like
.Xr ntpd 8 .
.It WARN
The time information is still valid, but no new time information has been
decoded for at least 5 minutes due to a reception or parity error.
The timedelta should be used with care.
.It CRITICAL
No valid time information has been received for more than 15 minutes since
the sensor state degraded from OK to WARN.
This is an indication that hardware should be checked
to see if it is still functional.
The timedelta will eventually degrade to a lie
as all computer internal clocks have a drift.
.El
.Sh SEE ALSO
.Xr intro 4 ,
.Xr uhub 4 ,
.Xr usb 4 ,
.Xr ntpd 8 ,
.Xr sysctl 8
.Sh HISTORY
The
.Nm
driver first appeared in
.Ox 4.0 .
.Sh AUTHORS
.An -nosplit
The
.Nm
driver was written by
.An Marc Balmer Aq Mt mbalmer@@openbsd.org .
.Sh CAVEATS
DCF77 uses a 77.5 kHz long wave radio signal transmitted from near Frankfurt,
Germany.
Up to about 900 km, the radio signal can travel directly to the receiver,
providing a linearly increasing time offset based on distance.
Due to the curvature of the Earth, beyond this distance the signal must
bounce off the lower ionosphere (residing at approximately 70 km elevation
during the day, and 90 km at night), thus causing a non-linearly increasing
time offset which can only be roughly calculated using trigonometry.
Since the distance and transmission geometry is not known,
the clock receivers and
.Nm
driver currently make no effort to calculate this offset.
We simply assume that the offset is small.
.Pp
In Germany, the train system uses DCF77 clocks.
As the distance from Frankfurt increases,
trains can be expected to run later.
@


1.26
log
@use .Mt for email addresses; from Jan Stary <hans at stare dot cz>; ok jmc@@
@
text
@d1 1
a1 1
.\" $OpenBSD: udcf.4,v 1.25 2008/07/05 12:18:27 mbalmer Exp $
d17 1
a17 1
.Dd $Mdocdate: July 5 2008 $
d29 1
a29 2
the Expert mouseCLOCK USB II, receivers for the German DCF77 and the
Swiss HBG time signal stations.
a44 5
.It HBG
Swiss HBG time signal station
(75 kHz longwave transmitter located in Prangins near Geneva).
.It Unknown
The clock type has not been determined.
@


1.25
log
@Mention support for the Expert mouseCLOCK USB II and the lack of MSF
support.
@
text
@d1 1
a1 1
.\" $OpenBSD: udcf.4,v 1.24 2007/05/31 19:19:52 jmc Exp $
d17 1
a17 1
.Dd $Mdocdate: May 31 2007 $
d89 1
a89 1
.An Marc Balmer Aq mbalmer@@openbsd.org .
@


1.24
log
@convert to new .Dd format;
@
text
@d1 1
a1 1
.\" $OpenBSD: udcf.4,v 1.23 2007/03/30 07:42:01 mbalmer Exp $
d3 1
a3 1
.\" Copyright (c) 2006 Marc Balmer <mbalmer@@openbsd.org>
d17 1
a17 1
.Dd $Mdocdate$
d28 8
a35 2
driver provides support for the Gude ADS Expert mouseCLOCK USB, a receiver for
the German DCF77 and the Swiss HBG time signal stations.
@


1.23
log
@Shorten the description and mention "timedelta sensor" in it, so users
can find all timedelta sensor related man pages (and thus a list of
supported devices) using 'man -k timedelta' or 'apropos timedelta'.

Discussed with jmc.
@
text
@d1 1
a1 1
.\" $OpenBSD: udcf.4,v 1.22 2006/12/17 09:58:28 mbalmer Exp $
d17 1
a17 1
.Dd January 12, 2006
@


1.22
log
@Shorten .Nd.
@
text
@d1 1
a1 1
.\" $OpenBSD: udcf.4,v 1.21 2006/12/16 20:35:09 mbalmer Exp $
d22 1
a22 1
.Nd Gude ADS Expert mouseCLOCK USB time signal station receiver
@


1.21
log
@Quothe the argument to the .Nd command, else the last word gets suppressed.
@
text
@d1 1
a1 1
.\" $OpenBSD: udcf.4,v 1.20 2006/12/09 14:52:21 mbalmer Exp $
d22 1
a22 1
.Nd "Gude ADS Expert mouseCLOCK USB DCF77/HBG time signal station receiver"
@


1.20
log
@Improvements, from jmc.
@
text
@d1 1
a1 1
.\" $OpenBSD: udcf.4,v 1.19 2006/12/09 14:47:01 mbalmer Exp $
d22 1
a22 1
.Nd Gude ADS Expert mouseCLOCK USB DCF77/HBG time signal station receiver
@


1.19
log
@Shorten.  And use the correct device name.
@
text
@d1 1
a1 1
.\" $OpenBSD: udcf.4,v 1.18 2006/12/09 13:29:12 mbalmer Exp $
d35 1
a35 1
The clock type (DCF77 or HBG) is indicated in the sensor description:
@


1.18
log
@The call sign is DCF77, not just DCF.
@
text
@d1 1
a1 1
.\" $OpenBSD: udcf.4,v 1.17 2006/12/09 13:27:05 mbalmer Exp $
d22 1
a22 1
.Nd Gude ADS Expert mouseCLOCK DCF77/HBG time signal station receiver
d28 2
a29 2
driver provides support for the Gude ADS Expert mouseCLOCK, a receiver for the
German DCF77 and the Swiss HBG time signal stations.
d35 1
a35 8
.Pp
The
.Nm
driver automatically detects if it is receiving the German DCF77 timecode
or the Swiss HBG timecode and indicates the clock type in the sensor
description.
This value will not be changed once set, even when the receiver
module is changed at runtime.
d44 1
a44 1
The clock type has not yet been determined.
@


1.17
log
@Be consistent with writing frequencies, it's n kHz, not nKHz.  The DCF77
transmitter uses 77.5 kHz.
@
text
@d1 1
a1 1
.\" $OpenBSD: udcf.4,v 1.16 2006/12/09 13:13:55 jmc Exp $
d92 1
a92 1
DCF uses a 77.5 kHz long wave radio signal transmitted from near Frankfurt,
@


1.16
log
@some indent and a little cleanup;
@
text
@d1 1
a1 1
.\" $OpenBSD: udcf.4,v 1.15 2006/12/09 13:10:17 jmc Exp $
d92 1
a92 1
DCF uses a 77KHz long wave radio signal transmitted from near Frankfurt,
d94 1
a94 1
Up to about 900km, the radio signal can travel directly to the receiver,
d97 2
a98 2
bounce off the lower ionosphere (residing at approximately 70km elevation
during the day, and 90km at night), thus causing a non-linearly increasing
d106 1
a106 1
In Germany, the train system uses DCF clocks.
@


1.15
log
@standardise section headers;
ok deraadt mbalmer
@
text
@d1 1
a1 1
.\" $OpenBSD: udcf.4,v 1.14 2006/12/08 21:19:34 deraadt Exp $
d43 1
a43 1
.Bl -tag -width "DCFXX"
d46 1
a46 1
(77.5 kHz longwave transmitter located in Mainflingen near Frankfurt)
d49 1
a49 1
(75 kHz longwave transmitter located in Prangins near Geneva)
d55 1
a55 1
.Bl -tag -width "CRITICALXX"
@


1.14
log
@explain why german trains run late; help from jmc
@
text
@d1 1
a1 1
.\" $OpenBSD: udcf.4,v 1.13 2006/10/27 11:29:06 mbalmer Exp $
d35 4
a38 2
.Sh CLOCK TYPE
The driver automatically detects if it is receiving the German DCF77 timecode
d53 1
a53 1
.Sh SENSOR STATES
a73 16
.Sh NOTES
DCF uses a 77KHz long wave radio signal transmitted from near Frankfurt, Germany.
Up to about 900km, the radio signal can travel directly to the receiver,
providing a linearly increasing time offset based on distance.
Due to the curvature of the Earth, beyond this distance the signal must
bounce off the lower ionosphere (residing at approximately 70km elevation
during the day, and 90km at night), thus causing a non-linearly increasing
time offset which can only be roughly calculated using trigonometry.
Since the distance and transmission geometry is not known,
the clock receivers and
.Nm
driver currently make no effort to calculate this offset.
We simply assume that the offset is small.
.Pp
In Germany, the train system uses DCF clocks.
As the distance from Frankfurt increases, trains can be expected to run late.
d91 18
@


1.13
log
@Reflect recent changes in udcf(4).
@
text
@d1 1
a1 1
.\" $OpenBSD: udcf.4,v 1.12 2006/10/11 13:23:45 mbalmer Exp $
d72 16
@


1.12
log
@Reflect recent changes in the driver.
@
text
@d1 1
a1 1
.\" $OpenBSD: udcf.4,v 1.11 2006/06/12 09:44:52 mbalmer Exp $
d57 2
a58 3
The time information is valid and the receiver is fully synchronized to the
time signal station.
The timedelta is safe to use for applications like
d61 2
a62 2
The time information is valid, but there has been a reception or parity error.
The sensor value is adjusted using the local clock for at most 15 minutes.
d65 2
a66 1
No valid time information has been received for more than 15 minutes.
@


1.11
log
@time delta -> timedelta

discussed and ok jmc
@
text
@d1 1
a1 1
.\" $OpenBSD: udcf.4,v 1.10 2006/06/04 09:52:40 mbalmer Exp $
d48 2
d54 2
@


1.10
log
@- ntpd no longer needs the NTP identifier as part of a timedelta sensor
  description.
- create the timedelta sensors as early as possible, but mark them invalid
  as long as there is no real data.
- update docs accordingly
@
text
@d1 1
a1 1
.\" $OpenBSD: udcf.4,v 1.9 2006/05/28 18:52:16 mbalmer Exp $
d31 1
a31 1
implements a time delta sensor and the delta (in nanoseconds) between the
d50 1
a50 1
The quality of the time delta is reported as the sensor status:
d55 1
a55 1
The time delta is safe to use for applications like
d60 1
a60 1
The time delta should be used with care.
d65 1
a65 1
The time delta will eventually degrade to a lie
@


1.9
log
@Change the timedelta sensor descritpion so that the first four bytes contain
the NTP identifier (filled with spaces), followed by a space and the station
name (which might be the same as the NTP identifier).

All timedelta sensor have to follow this scheme as OpenNTPD needs it.

Requested by henning.
@
text
@d1 1
a1 1
.\" $OpenBSD: udcf.4,v 1.8 2006/05/28 17:29:01 jmc Exp $
a38 2
The first four bytes of the description are the NTP identifier followed
by a space and the station name (which might be the same).
d41 2
a42 2
.Bl -tag -width "DCF  DCFXX"
.It DCF  DCF77
d45 1
a45 1
.It HBG  HBG
@


1.8
log
@+.Xr ntpd 8 ,

ok henning mbalmer
@
text
@d1 1
a1 1
.\" $OpenBSD: udcf.4,v 1.7 2006/04/27 14:19:30 jmc Exp $
d39 2
d43 2
a44 2
.Bl -tag -width "DCFXX"
.It DCF77
d47 1
a47 1
.It HBG
@


1.7
log
@new sentence, new line;
@
text
@d1 1
a1 1
.\" $OpenBSD: udcf.4,v 1.6 2006/04/27 08:23:30 mbalmer Exp $
d72 1
@


1.6
log
@Keep up with recent changes in udcf and make it less of an insult.
@
text
@d1 1
a1 1
.\" $OpenBSD: udcf.4,v 1.5 2006/04/21 16:46:34 mbalmer Exp $
d38 2
a39 1
description.  This value will not be changed once set, even when the receiver
@


1.5
log
@Document that udcf is a time delta sensor who's value is the delta between
the time received and the local time in msec.  The value can be accessed
throught the sysctl(8) interface.
@
text
@d1 1
a1 1
.\" $OpenBSD: udcf.4,v 1.4 2006/04/20 08:11:53 jmc Exp $
d22 1
a22 1
.Nd Gude ADS Expert mouseCLOCK DCF77 time signal receiver
d29 1
a29 1
German DCF77 time signal station.
d31 2
a32 2
implements a time delta sensor and the delta (in msec) between the received
time information and the local time can be accessed through the
d35 32
d77 6
@


1.4
log
@kill trailing space;
@
text
@d1 1
a1 1
.\" $OpenBSD: udcf.4,v 1.3 2006/04/19 22:11:24 miod Exp $
d30 5
d38 2
a39 1
.Xr usb 4
@


1.3
log
@Remove trailing comma in SEE ALSO.
@
text
@d1 1
a1 1
.\" $OpenBSD: udcf.4,v 1.2 2006/04/19 21:57:32 deraadt Exp $
d29 1
a29 1
German DCF77 time signal station. 
@


1.2
log
@winner for the most useless .Nd line in a man page
@
text
@d1 1
a1 1
.\" $OpenBSD: udcf.4,v 1.1 2006/04/19 21:12:49 mbalmer Exp $
d33 1
a33 1
.Xr usb 4 ,
@


1.1
log
@Driver to decode the DCF77 time code using a USB attached Gude Expert
mouseCLOCK device; without a mechanism to pass data out.

ok deraadt
@
text
@d1 1
a1 1
.\" $OpenBSD$
d22 1
a22 1
.Nd USB support for the Gude ADS Expert mouseCLOCK
@

