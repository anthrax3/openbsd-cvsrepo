head	1.25;
access;
symbols
	OPENBSD_6_1:1.25.0.8
	OPENBSD_6_1_BASE:1.25
	OPENBSD_6_0:1.25.0.6
	OPENBSD_6_0_BASE:1.25
	OPENBSD_5_9:1.25.0.2
	OPENBSD_5_9_BASE:1.25
	OPENBSD_5_8:1.24.0.8
	OPENBSD_5_8_BASE:1.24
	OPENBSD_5_7:1.24.0.6
	OPENBSD_5_7_BASE:1.24
	OPENBSD_5_6:1.24.0.4
	OPENBSD_5_6_BASE:1.24
	OPENBSD_5_5:1.21.0.4
	OPENBSD_5_5_BASE:1.21
	OPENBSD_5_4:1.20.0.26
	OPENBSD_5_4_BASE:1.20
	OPENBSD_5_3:1.20.0.24
	OPENBSD_5_3_BASE:1.20
	OPENBSD_5_2:1.20.0.22
	OPENBSD_5_2_BASE:1.20
	OPENBSD_5_1_BASE:1.20
	OPENBSD_5_1:1.20.0.20
	OPENBSD_5_0:1.20.0.18
	OPENBSD_5_0_BASE:1.20
	OPENBSD_4_9:1.20.0.16
	OPENBSD_4_9_BASE:1.20
	OPENBSD_4_8:1.20.0.14
	OPENBSD_4_8_BASE:1.20
	OPENBSD_4_7:1.20.0.10
	OPENBSD_4_7_BASE:1.20
	OPENBSD_4_6:1.20.0.12
	OPENBSD_4_6_BASE:1.20
	OPENBSD_4_5:1.20.0.8
	OPENBSD_4_5_BASE:1.20
	OPENBSD_4_4:1.20.0.6
	OPENBSD_4_4_BASE:1.20
	OPENBSD_4_3:1.20.0.4
	OPENBSD_4_3_BASE:1.20
	OPENBSD_4_2:1.20.0.2
	OPENBSD_4_2_BASE:1.20
	OPENBSD_4_1:1.18.0.8
	OPENBSD_4_1_BASE:1.18
	OPENBSD_4_0:1.18.0.6
	OPENBSD_4_0_BASE:1.18
	OPENBSD_3_9:1.18.0.4
	OPENBSD_3_9_BASE:1.18
	OPENBSD_3_8:1.18.0.2
	OPENBSD_3_8_BASE:1.18
	OPENBSD_3_7:1.17.0.2
	OPENBSD_3_7_BASE:1.17
	OPENBSD_3_6:1.15.0.2
	OPENBSD_3_6_BASE:1.15
	OPENBSD_3_5:1.14.0.2
	OPENBSD_3_5_BASE:1.14
	OPENBSD_3_4:1.11.0.2
	OPENBSD_3_4_BASE:1.11
	OPENBSD_3_3:1.10.0.4
	OPENBSD_3_3_BASE:1.10
	OPENBSD_3_2:1.10.0.2
	OPENBSD_3_2_BASE:1.10
	OPENBSD_3_1:1.9.0.4
	OPENBSD_3_1_BASE:1.9
	OPENBSD_3_0:1.9.0.2
	OPENBSD_3_0_BASE:1.9
	OPENBSD_2_9:1.8.0.2
	OPENBSD_2_9_BASE:1.8
	OPENBSD_2_8:1.7.0.4
	OPENBSD_2_8_BASE:1.7
	OPENBSD_2_7:1.7.0.2
	OPENBSD_2_7_BASE:1.7
	OPENBSD_2_6:1.6.0.2
	OPENBSD_2_6_BASE:1.6
	OPENBSD_2_5:1.3.0.4
	OPENBSD_2_5_BASE:1.3
	OPENBSD_2_4:1.3.0.2
	OPENBSD_2_4_BASE:1.3
	OPENBSD_2_3:1.1.0.6
	OPENBSD_2_3_BASE:1.1
	OPENBSD_2_2:1.1.0.4
	OPENBSD_2_2_BASE:1.1
	OPENBSD_2_1:1.1.0.2
	OPENBSD_2_1_BASE:1.1;
locks; strict;
comment	@# @;


1.25
date	2015.08.27.18.58.05;	author jmc;	state Exp;
branches;
next	1.24;
commitid	9uKdDjQPCI9ppfVY;

1.24
date	2014.07.02.22.35.42;	author matthew;	state Exp;
branches;
next	1.23;
commitid	UVfZngFEO8Tf2HEx;

1.23
date	2014.06.28.07.08.14;	author jmc;	state Exp;
branches;
next	1.22;
commitid	gY9hIpzFLLknCFgq;

1.22
date	2014.06.28.06.18.26;	author matthew;	state Exp;
branches;
next	1.21;
commitid	246JFW0oVphokrT1;

1.21
date	2014.01.21.03.15.46;	author schwarze;	state Exp;
branches;
next	1.20;

1.20
date	2007.06.01.22.30.48;	author deraadt;	state Exp;
branches;
next	1.19;

1.19
date	2007.05.31.19.19.49;	author jmc;	state Exp;
branches;
next	1.18;

1.18
date	2005.04.25.18.26.44;	author drahn;	state Exp;
branches;
next	1.17;

1.17
date	2004.12.09.17.41.00;	author miod;	state Exp;
branches;
next	1.16;

1.16
date	2004.09.30.19.59.24;	author mickey;	state Exp;
branches;
next	1.15;

1.15
date	2004.08.03.08.58.02;	author jmc;	state Exp;
branches;
next	1.14;

1.14
date	2004.03.20.22.05.55;	author miod;	state Exp;
branches;
next	1.13;

1.13
date	2003.12.02.06.06.26;	author jmc;	state Exp;
branches;
next	1.12;

1.12
date	2003.11.09.16.06.07;	author jmc;	state Exp;
branches;
next	1.11;

1.11
date	2003.09.05.22.44.34;	author jmc;	state Exp;
branches;
next	1.10;

1.10
date	2002.09.26.07.55.39;	author miod;	state Exp;
branches;
next	1.9;

1.9
date	2001.06.22.12.15.44;	author mpech;	state Exp;
branches;
next	1.8;

1.8
date	2000.12.21.05.32.52;	author aaron;	state Exp;
branches;
next	1.7;

1.7
date	99.11.13.04.07.56;	author angelos;	state Exp;
branches;
next	1.6;

1.6
date	99.09.24.19.47.59;	author deraadt;	state Exp;
branches;
next	1.5;

1.5
date	99.07.09.13.35.48;	author aaron;	state Exp;
branches;
next	1.4;

1.4
date	99.07.03.02.11.12;	author aaron;	state Exp;
branches;
next	1.3;

1.3
date	98.09.05.17.41.48;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	98.07.03.07.23.26;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	97.03.28.22.53.39;	author millert;	state Exp;
branches;
next	;


desc
@@


1.25
log
@document CDIOREADTOCENTRIES, rather than the misspelled (but equivalent)
CDIOREADTOCENTRYS;

from martijn van duren
@
text
@.\"	$OpenBSD: cd.4,v 1.24 2014/07/02 22:35:42 matthew Exp $
.\"	$NetBSD: cd.4,v 1.3 1996/10/20 23:15:21 explorer Exp $
.\"
.\" Copyright (c) 1996
.\"     Julian Elischer <julian@@freebsd.org>.  All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\"
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.Dd $Mdocdate: July 2 2014 $
.Dt CD 4
.Os
.Sh NAME
.Nm cd
.Nd ATAPI and SCSI CD-ROM driver
.Sh SYNOPSIS
.Cd "cd* at scsibus?"
.Cd "#cd0 at scsibus0 target 6 lun 0" Pq fixed-configuration example
.Sh DESCRIPTION
The
.Nm
driver provides support for ATAPI and SCSI CD-ROM
.Pq Compact Disc Read-Only Memory
drives, via
.Xr scsibus 4 .
In an attempt to look like a regular disk, the
.Nm
driver synthesizes a partition table, with one partition covering the entire
CD-ROM.
It is possible to modify this partition table using
.Xr disklabel 8 ,
but it will only last until the CD-ROM is unmounted.
In general the interfaces are similar to those described by
.Xr wd 4
and
.Xr sd 4 .
.Pp
As the SCSI adapter is probed during boot, the SCSI bus is scanned for devices.
Any devices found which answer as
.Dq Read-only
and
.Dq removable
CD-ROM or WORM devices will be
.Dq attached
to the
.Nm
driver.
.Pp
The system utility
.Xr disklabel 8
may be used to read the synthesized
disk label
structure, which will contain correct figures for the size of the
CD-ROM should that information be required.
.Sh IOCTLS
The following
.Xr ioctl 2
calls which apply to CD-ROM drives are defined in the header files
.In sys/cdio.h
and
.In sys/dkio.h .
.Bl -tag -width Ds
.It Dv DIOCGDINFO , DIOCSDINFO Fa "struct disklabel *"
Read or write the in-core copy of the disklabel for the drive.
The disklabel is initialized with information read from the SCSI inquiry
commands, and should be the same as the information printed at boot.
This structure is defined in
.Xr disklabel 5 .
.\".It Dv CDIOCCAPABILITY
.\".Pq Li "struct ioc_capability"
.\"Retrieve information from the drive on what features it supports.  The
.\"information is returned in the following structure:
.\".Bd -literal -offset indent
.\"struct ioc_capability {
.\"	u_long	play_function;
.\"#define CDDOPLAYTRK	0x00000001
.\"	/* Can play tracks/index */
.\"#define	CDDOPLAYMSF	0x00000002
.\"	/* Can play msf to msf */
.\"#define	CDDOPLAYBLOCKS	0x00000004
.\"	/* Can play range of blocks */
.\"#define	CDDOPAUSE	0x00000100
.\"	/* Output can be paused */
.\"#define	CDDORESUME	0x00000200
.\"	/* Output can be resumed */
.\"#define	CDDORESET	0x00000400
.\"	/* Drive can be completely reset */
.\"#define	CDDOSTART	0x00000800
.\"	/* Audio can be started */
.\"#define CDDOSTOP	0x00001000
.\"	/* Audio can be stopped */
.\"#define CDDOPITCH	0x00002000
.\"	/* Audio pitch can be changed */
.\"
.\"	u_long	routing_function;
.\"#define CDREADVOLUME	0x00000001
.\"	/* Volume settings can be read */
.\"#define CDSETVOLUME	0x00000002
.\"	/* Volume settings can be set */
.\"#define	CDSETMONO	0x00000100
.\"	/* Output can be set to mono */
.\"#define CDSETSTEREO	0x00000200
.\"	/* Output can be set to stereo (def) */
.\"#define	CDSETLEFT	0x00000400
.\"	/* Output can be set to left only */
.\"#define	CDSETRIGHT	0x00000800
.\"	/* Output can be set to right only */
.\"#define	CDSETMUTE	0x00001000
.\"	/* Output can be muted */
.\"#define CDSETPATCH	0x00008000
.\"	/* Direct routing control allowed */
.\"
.\"	u_long	special_function;
.\"#define	CDDOEJECT	0x00000001
.\"	/* The tray can be opened */
.\"#define	CDDOCLOSE	0x00000002
.\"	/* The tray can be closed */
.\"#define	CDDOLOCK	0x00000004
.\"	/* The tray can be locked */
.\"#define CDREADHEADER	0x00000100
.\"	/* Can read Table of Contents */
.\"#define	CDREADENTRIES	0x00000200
.\"	/* Can read TOC Entries */
.\"#define	CDREADSUBQ	0x00000200
.\"	/* Can read Subchannel info */
.\"#define CDREADRW	0x00000400
.\"	/* Can read subcodes R-W */
.\"#define	CDHASDEBUG	0x00004000
.\"	/* The tray has dynamic debugging */
.\"};
.\".Ed
.It Dv CDIOCPLAYTRACKS Fa "struct ioc_play_track *"
Start audio playback given a track address and length.
The structure is defined as follows:
.Bd -literal -offset indent
struct ioc_play_track {
	u_char	start_track;
	u_char	start_index;
	u_char	end_track;
	u_char	end_index;
};
.Ed
.It Dv CDIOCPLAYBLOCKS Fa "struct ioc_play_blocks *"
Start audio playback given a block address and length.
The structure is defined as follows:
.Bd -literal -offset indent
struct ioc_play_blocks {
	int	blk;
	int	len;
};
.Ed
.It Dv CDIOCPLAYMSF Fa "struct ioc_play_msf *"
Start audio playback given a
.Dq minutes-seconds-frames
address and length.
The structure is defined as follows:
.Bd -literal -offset indent
struct ioc_play_msf {
	u_char	start_m;
	u_char	start_s;
	u_char	start_f;
	u_char	end_m;
	u_char	end_s;
	u_char	end_f;
};
.Ed
.It Dv CDIOCREADSUBCHANNEL Fa "struct ioc_read_subchannel *"
Read information from the subchannel at the location specified by this
structure:
.Bd -literal -offset indent
struct ioc_read_subchannel {
	u_char address_format;
#define CD_LBA_FORMAT	1
#define CD_MSF_FORMAT	2
	u_char data_format;
#define CD_SUBQ_DATA		0
#define CD_CURRENT_POSITION	1
#define CD_MEDIA_CATALOG	2
#define CD_TRACK_INFO		3
	u_char track;
	int	data_len;
	struct  cd_sub_channel_info *data;
};
.Ed
.It Dv CDIOREADTOCHEADER Fa "struct ioc_toc_header *"
Return summary information about the table of contents for the
mounted CD-ROM.
The information is returned into the following structure:
.Bd -literal -offset indent
struct ioc_toc_header {
	u_short len;
	u_char  starting_track;
	u_char  ending_track;
};
.Ed
.It Dv CDIOREADTOCENTRIES Fa "struct ioc_read_toc_entry *"
Return information from the table of contents entries mentioned.
The argument structure is defined as follows:
.Bd -literal -offset indent
struct ioc_read_toc_entry {
	u_char	address_format;
	u_char	starting_track;
	u_short	data_len;
	struct  cd_toc_entry *data;
};
.Ed
.Pp
The requested data is written into an area of size
.Li data_len
and pointed to by
.Li data .
.It Dv CDIOCSETPATCH Fa "struct ioc_patch *"
Attach various audio channels to various output channels.
The argument structure is defined thusly:
.Bd -literal -offset indent
struct ioc_patch {
	u_char	patch[4];
	/* one for each channel */
};
.Ed
.It Dv CDIOCGETVOL , CDIOCSETVOL Fa "struct ioc_vol *"
Get (set) information about the volume settings of the output channels.
The argument structure is as follows:
.Bd -literal -offset indent
struct	ioc_vol {
	u_char	vol[4];
	/* one for each channel */
};
.Ed
.It Dv CDIOCSETMONO
Patch all output channels to all source channels.
.It Dv CDIOCSETSTEREO
Patch left source channel to the left output channel and the right
source channel to the right output channel.
.It Dv CDIOCSETMUTE
Mute output without changing the volume settings.
.It Dv CDIOCSETLEFT , CDIOCSETRIGHT
Attach both output channels to the left (right) source channel.
.It Dv CDIOCSETDEBUG , CDIOCCLRDEBUG
Turn on (off) debugging for the appropriate device.
.It Dv CDIOCPAUSE , CDIOCRESUME
Pause (resume) audio play, without resetting the location of the read-head.
.It Dv CDIOCRESET
Reset the drive.
.It Dv CDIOCSTART , CDIOCSTOP
Tell the drive to spin-up (-down) the CD-ROM.
.It Dv CDIOCALLOW , CDIOCPREVENT
Tell the drive to allow (prevent) manual ejection of the CD-ROM disc.
Not all drives support this feature.
.It Dv CDIOCEJECT
Eject the CD-ROM.
.\".It Dv CDIOCCLOSE
.\"Tell the drive to close its door and load the media.  Not all drives
.\"support this feature.
.\"
.\".It Dv CDIOCPITCH
.\".Pq Li "struct ioc_pitch"
.\"For drives that support it, this command instructs the drive to play
.\"the audio at a faster or slower rate than normal.  Values of
.\".Li speed
.\"between -32767 and -1 result in slower playback; a zero value
.\"indicates normal speed; and values from 1 to 32767 give faster
.\"playback.  Drives with less than 16 bits of resolution will silently
.\"ignore less-significant bits.  The structure is defined thusly:
.\".Bd -literal -offset indent
.\"struct	ioc_pitch {
.\"	short	speed;
.\"};
.\".Ed
.El
.Pp
In addition the general
.Xr scsi 4
ioctls may be used with the
.Nm
driver, if used against the `whole disk' partition (i.e.,
.Pa /dev/rcd0c ) .
.Sh NOTES
When a CD-ROM is changed in a drive controlled by the
.Nm
driver, then the act of changing the media will invalidate the
disklabel and information held within the kernel.
To stop corruption, all accesses to the device will be discarded until
there are no more open file descriptors referencing the device.
During this period, all new open attempts will be rejected.
When no more open file descriptors reference the device, the first next open
will load a new set of parameters (including disklabel) for the drive.
.Pp
The audio code in the
.Nm
driver only supports SCSI-2 standard audio commands.
Because many CD-ROM manufacturers have not followed the standard, there are
many CD-ROM drives for which audio will not work.
Some work is planned to support some of the more common
.Dq broken
CD-ROM drives; however, this is not yet under way.
.Sh FILES
.Bl -tag -width /dev/rcd[0-9][a-p] -compact
.It Pa /dev/cd[0-9][a-p]
block mode CD-ROM devices
.It Pa /dev/rcd[0-9][a-p]
raw mode CD-ROM devices
.El
.Sh DIAGNOSTICS
None.
.Sh SEE ALSO
.Xr cdio 1 ,
.Xr eject 1 ,
.Xr ioctl 2 ,
.Xr intro 4 ,
.Xr scsi 4 ,
.Xr scsibus 4 ,
.Xr sd 4 ,
.Xr wd 4 ,
.Xr disklabel 5 ,
.Xr disklabel 8
.Sh HISTORY
The
.Nm
driver appeared in 386BSD 0.1.
.Sh BUGS
The names of the structures used for the third argument to
.Fn ioctl
were poorly chosen, and a number of spelling errors have survived in
the names of the
.Fn ioctl
commands.
@


1.24
log
@Document the ioctl() argument types for sd(4)'s ioctls

Also, cleanup some lies about which header defines these ioctls
@
text
@d1 1
a1 1
.\"	$OpenBSD: cd.4,v 1.23 2014/06/28 07:08:14 jmc Exp $
d29 1
a29 1
.Dd $Mdocdate: June 28 2014 $
d215 1
a215 1
.It Dv CDIOREADTOCENTRYS Fa "struct ioc_read_toc_entry *"
a216 1
(Yes, this command name is misspelled.)
@


1.23
log
@Dv blah , Dv bleh
is more simply written as
Dv blah , bleh
@
text
@d1 1
a1 1
.\"	$OpenBSD: cd.4,v 1.22 2014/06/28 06:18:26 matthew Exp $
d80 1
a80 1
.In sys/disklabel.h .
@


1.22
log
@Cleanup documentation for SCSI device driver ioctl()s.
@
text
@d1 1
a1 1
.\"	$OpenBSD: cd.4,v 1.21 2014/01/21 03:15:46 schwarze Exp $
d29 1
a29 1
.Dd $Mdocdate: January 21 2014 $
d82 1
a82 1
.It Dv DIOCGDINFO , Dv DIOCSDINFO Fa "struct disklabel *"
d241 1
a241 1
.It Dv CDIOCGETVOL , Dv CDIOCSETVOL Fa "struct ioc_vol *"
d257 1
a257 1
.It Dv CDIOCSETLEFT , Dv CDIOCSETRIGHT
d259 1
a259 1
.It Dv CDIOCSETDEBUG , Dv CDIOCCLRDEBUG
d261 1
a261 1
.It Dv CDIOCPAUSE , Dv CDIOCRESUME
d265 1
a265 1
.It Dv CDIOCSTART , Dv CDIOCSTOP
d267 1
a267 1
.It Dv CDIOCALLOW , Dv CDIOCPREVENT
@


1.21
log
@obvious .Pa fixes; found with mandocdb(8)
@
text
@d1 1
a1 1
.\"	$OpenBSD: cd.4,v 1.20 2007/06/01 22:30:48 deraadt Exp $
d29 1
a29 1
.Dd $Mdocdate: June 1 2007 $
d82 1
a82 2
.It Dv DIOCGDINFO , Dv DIOCSDINFO
.Pq Li "struct disklabel"
d151 1
a151 2
.It Dv CDIOCPLAYTRACKS
.Pq Li "struct ioc_play_track"
d162 1
a162 2
.It Dv CDIOCPLAYBLOCKS
.Pq Li "struct ioc_play_blocks"
d171 1
a171 2
.It Dv CDIOCPLAYMSF
.Pq Li "struct ioc_play_msf"
d186 1
a186 2
.It Dv CDIOCREADSUBCHANNEL
.Pq Li "struct ioc_read_subchannel"
d204 1
a204 2
.It Dv CDIOREADTOCHEADER
.Pq Li "struct ioc_toc_header"
d215 1
a215 2
.It Dv CDIOREADTOCENTRYS
.Pq Li "struct ioc_read_toc_entry"
d227 1
d232 1
a232 2
.It Dv CDIOCSETPATCH
.Pq Li "struct ioc_patch"
d241 1
a241 2
.It Dv CDIOCGETVOL , Dv CDIOCSETVOL
.Pq Li "struct ioc_vol"
@


1.20
log
@FIBMAP is used by nothing; checked by miod and pvalchev
@
text
@d1 1
a1 1
.\"	$OpenBSD: cd.4,v 1.19 2007/05/31 19:19:49 jmc Exp $
d29 1
a29 1
.Dd $Mdocdate: May 31 2007 $
d78 1
a78 1
.Aq Pa sys/cdio.h
d80 1
a80 1
.Aq Pa sys/disklabel.h .
@


1.19
log
@convert to new .Dd format;
@
text
@d1 1
a1 1
.\"	$OpenBSD: cd.4,v 1.18 2005/04/25 18:26:44 drahn Exp $
d29 1
a29 1
.Dd $Mdocdate$
a297 6
.It Dv FIBMAP
Return the physical block number (in 512-byte sectors) given the
logical block number.
The argument is a pointer to an integer.
On invocation, it should contain the logical block.
On return, it contains the physical block number.
@


1.18
log
@Reduce the chances of someone asking how to eject a cd. ok brad, mickey
@
text
@d1 1
a1 1
.\"	$OpenBSD: cd.4,v 1.17 2004/12/09 17:41:00 miod Exp $
d29 1
a29 1
.Dd January 16, 1996
@


1.17
log
@Remove old FreeBSDisms:
- drop the "KERNEL CONFIGURATION" section which is confusing (these are
  not pseudo-devices!) except for st.4 where might be worth keeping.
- drop the "DISCLAIMER" section in ch.4.
- mention cdio and chio in cd.4 and ch.4 respectively.
@
text
@d1 1
a1 1
.\"	$OpenBSD: cd.4,v 1.16 2004/09/30 19:59:24 mickey Exp $
d342 1
@


1.16
log
@kill default locators
@
text
@d1 1
a1 1
.\"	$OpenBSD: cd.4,v 1.15 2004/08/03 08:58:02 jmc Exp $
a73 3
.Sh KERNEL CONFIGURATION
Any number of CD-ROM devices may be attached to the system regardless of system
configuration as all resources are dynamically allocated.
d341 1
@


1.15
log
@Xrs from Alexey E. Suslikov;
@
text
@d1 1
a1 1
.\"	$OpenBSD: cd.4,v 1.14 2004/03/20 22:05:55 miod Exp $
d36 1
a36 1
.Cd "cd* at scsibus? target ? lun ?"
@


1.14
log
@Clarify which devices will get recognized as ``cd'' devices.
@
text
@d1 1
a1 1
.\"	$OpenBSD: cd.4,v 1.13 2003/12/02 06:06:26 jmc Exp $
d344 1
d347 1
d349 1
@


1.13
log
@typo from Daniel Cavanagh;
@
text
@d1 1
a1 1
.\"	$OpenBSD: cd.4,v 1.12 2003/11/09 16:06:07 jmc Exp $
d60 3
a62 1
type devices will be
@


1.12
log
@remove .Pp's before lists and displays;
@
text
@d1 1
a1 1
.\"	$OpenBSD: cd.4,v 1.11 2003/09/05 22:44:34 jmc Exp $
d249 1
a249 1
.It Dv CDIOCGETVOL , Dv CDIOSETVOL
@


1.11
log
@cd(4) supports ATAPI as well as SCSI devices; from fgs@@
ok henning@@ millert@@ miod@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: cd.4,v 1.10 2002/09/26 07:55:39 miod Exp $
a81 1
.Pp
@


1.10
log
@Incomplete section 4 mi manual page cleanup.
- make configuration lines match GENERIC files
- more Xr (hopefully usefule Xr)
- never mention intro(4) on non-physical devices (i.e. protocols), always
mention it for physical devices
- random text style and quoting fixes
- drivers ported from FreeBSD did mention rc.conf instead of hostname.if as
the place to put mediaopt
- some .Tn UNIX -> .Ox replacements
- etc, etc...

reviewd in part by deraadt@@ (until he got bored of this)
@
text
@d1 1
a1 1
.\"	$OpenBSD: cd.4,v 1.9 2001/06/22 12:15:44 mpech Exp $
d34 1
a34 1
.Nd SCSI CD-ROM driver
d41 4
a44 2
driver provides support for a SCSI CD-ROM (Compact Disc-Read Only Memory)
drive.
d78 1
a78 1
calls which apply to SCSI CD-ROM drives are defined in the header files
@


1.9
log
@o) remove unnecessary .Pp;
o) remove unnecessary .Nm args;
o) closes .Bl;
o) .Sh AUTHOR -> .Sh AUTHORS;
o) sort SEE ALSO;
o) better -mdoc style;
o) typos;

aaron@@ ok.
@
text
@d1 1
a1 1
.\"	$OpenBSD: cd.4,v 1.8 2000/12/21 05:32:52 aaron Exp $
d36 2
a37 2
.Cd cd* at scsibus? target ? lun ?
.Cd cd1 at scsibus0 target 4 lun 0
d332 2
a333 2
.Bl -tag -width /dev/rcd[0-9][a-h] -compact
.It Pa /dev/cd[0-9][a-h]
d335 1
a335 1
.It Pa /dev/rcd[0-9][a-h]
d341 1
@


1.8
log
@Various repairs.
@
text
@d1 1
a1 1
.\"	$OpenBSD: cd.4,v 1.7 1999/11/13 04:07:56 angelos Exp $
d40 1
a40 1
.Nm cd
@


1.7
log
@Add FIBMAP ioctl.
@
text
@d1 1
a1 1
.\"	$OpenBSD: cd.4,v 1.6 1999/09/24 19:47:59 deraadt Exp $
d41 2
a42 4
driver provides support for a
.Tn SCSI
.Tn CD-ROM
(Compact Disc-Read Only Memory) drive.
d46 1
a46 1
.Tn CD-ROM .
d49 1
a49 3
but it will only last until the
.Tn CD-ROM
is unmounted.
d55 6
a60 6
As the
.Tn SCSI
adapter is probed during boot, the
.Tn SCSI
bus is scanned for devices. Any devices found which answer as `Read-only'
type devices will be `attached' to the
d69 1
a69 2
.Tn CD-ROM
should that information be required.
d71 1
a71 3
Any number of
.Tn CD-ROM
devices may be attached to the system regardless of system
d76 1
a76 5
calls which apply to
.Tn SCSI
.Tn CD-ROM
drives are defined
in the header files
d81 2
a82 3
.Bl -tag -width CDIOCREADSUBCHANNEL -compact
.It Dv DIOCGDINFO
.It Dv DIOCSDINFO
d84 4
a87 6
Read or write the in-core copy of the disklabel for the
drive.  The disklabel is initialized with information
read from the
.Tn SCSI
inquiry commands, and should be the same as
the information printed at boot.  This structure is defined in
a88 1

d154 2
a155 2
Start audio playback given a track address and length.  The structure
is defined as follows:
a163 1

d166 2
a167 2
Start audio playback given a block address and length.  The structure
is defined as follows:
a173 1

d176 4
a179 2
Start audio playback given a `minutes-seconds-frames' address and
length.  The structure is defined as follows:
a189 1

a208 1

d211 2
a212 2
Return summary information about the table of contents for the mounted
.Tn CD-ROM .
a220 1

d223 3
a225 2
Return information from the table of contents entries mentioned.  (Yes, this
command name is misspelled.)  The argument structure is defined as follows:
a237 1

d240 2
a241 2
Attach various audio channels to various output channels.  The
argument structure is defined thusly:
d248 1
a248 3

.It Dv CDIOCGETVOL
.It Dv CDIOCSETVOL
d250 2
a251 2
Get (set) information about the volume settings of the output channels.  The
argument structure is as follows:
a257 1

a259 1

a262 1

d265 1
a265 3

.It Dv CDIOCSETLEFT
.It Dv CDIOCSETRIGHT
d267 1
a267 3

.It Dv CDIOCSETDEBUG
.It Dv CDIOCCLRDEBUG
d269 1
a269 3

.It Dv CDIOCPAUSE
.It Dv CDIOCRESUME
a270 1

d273 5
a277 12

.It Dv CDIOCSTART
.It Dv CDIOCSTOP
Tell the drive to spin-up (-down) the
.Tn CD-ROM .

.It Dv CDIOCALLOW
.It Dv CDIOCPREVENT
Tell the drive to allow (prevent) manual ejection of the
.Tn CD-ROM
disc.  Not all drives support this feature.

d279 1
a279 3
Eject the
.Tn CD-ROM .

a297 1

d300 4
a303 3
logical block number.  The argument is a pointer to an integer.  On
invocation, it should contain the logical block.  On return, it
contains the physical block number.
d310 1
a310 1
driver, if used against the `whole disk' partition (i.e.
d313 1
a313 3
When a
.Tn CD-ROM
is changed in a drive controlled by the
d316 6
a321 6
disklabel and information held within the kernel.  To stop corruption,
all accesses to the device will be discarded until there are no more
open file descriptors referencing the device.  During this period, all
new open attempts will be rejected.  When no more open file descriptors
reference the device, the first next open will load a new set of
parameters (including disklabel) for the drive.
d325 6
a330 10
driver only supports
.Tn SCSI-2
standard audio commands. Because many
.Tn CD-ROM
manufacturers have not followed the standard, there are many
.Tn CD-ROM
drives for which audio will not work. Some work is planned to support
some of the more common `broken'
.Tn CD-ROM
drives; however, this is not yet under way.
d334 1
a334 3
block mode
.Tn CD-ROM
devices
d336 1
a336 3
raw mode
.Tn CD-ROM
devices
d345 4
a355 4
.Sh HISTORY
The
.Nm
driver appeared in 386BSD 0.1.
@


1.6
log
@pretty
@
text
@d1 1
a1 1
.\"	$OpenBSD: cd.4,v 1.5 1999/07/09 13:35:48 aaron Exp $
d337 6
@


1.5
log
@- remove all trailing whitespace
     * except when it is escaped with a `\' at the end of the line
- fix remaining .Nm usage as well
- this is from a patch I received from kwesterback@@home.com, who has been
  working on some scripts for fixing formatting errors in mdoc'd man pages

Ok, so there could be a cost/benefit debate with this commit, but since I have
the patch we might as well commit it...
@
text
@d1 1
a1 1
.\"	$OpenBSD: cd.4,v 1.4 1999/07/03 02:11:12 aaron Exp $
d172 1
a172 2
struct ioc_play_track
{
d185 1
a185 2
struct ioc_play_blocks
{
d196 1
a196 2
struct ioc_play_msf
{
d273 1
a273 2
struct	ioc_vol
{
d333 1
a333 2
.\"struct	ioc_pitch
.\"{
@


1.4
log
@remove redundant .Pp macros
@
text
@d1 1
a1 1
.\"	$OpenBSD: cd.4,v 1.3 1998/09/05 17:41:48 deraadt Exp $
d41 1
a41 1
driver provides support for a 
d45 1
a45 1
In an attempt to look like a regular disk, the 
d51 1
a51 1
but it will only last until the 
d54 2
a55 2
In general the interfaces are similar to those described by 
.Xr wd 4 
d61 1
a61 1
adapter is probed during boot, the 
d64 1
a64 1
type devices will be `attached' to the 
d72 1
a72 1
structure, which will contain correct figures for the size of the 
d81 1
a81 1
The following 
d167 1
a167 1
.It Dv CDIOCPLAYTRACKS	
d193 1
a193 1
.It Dv CDIOCPLAYMSF	
d209 1
a209 1
.It Dv CDIOCREADSUBCHANNEL 
d231 1
a231 1
Return summary information about the table of contents for the mounted 
d242 1
a242 1
.It Dv CDIOREADTOCENTRYS 
d283 1
a283 1
.It Dv CDIOCSETMONO	
d290 1
a290 1
.It Dv CDIOCSETMUTE	
d297 2
a298 2
.It Dv CDIOCSETDEBUG	
.It Dv CDIOCCLRDEBUG	
d301 2
a302 2
.It Dv CDIOCPAUSE	
.It Dv CDIOCRESUME	
d305 1
a305 1
.It Dv CDIOCRESET	
d308 2
a309 2
.It Dv CDIOCSTART	
.It Dv CDIOCSTOP	
d315 1
a315 1
Tell the drive to allow (prevent) manual ejection of the 
d319 2
a320 2
.It Dv CDIOCEJECT	
Eject the 
d344 1
a344 1
In addition the general 
d346 1
a346 1
ioctls may be used with the 
d348 1
a348 1
driver, if used against the `whole disk' partition (i.e. 
d351 1
a351 1
When a 
d367 1
a367 1
standard audio commands. Because many 
d372 1
a372 1
some of the more common `broken' 
d392 1
a392 1
.Xr disklabel 8 
@


1.3
log
@more man page repairs; aaron@@ug.cs.dal.ca
@
text
@d1 1
a1 1
.\"	$OpenBSD: cd.4,v 1.2 1998/07/03 07:23:26 deraadt Exp $
a74 1
.Pp
@


1.2
log
@clean
@
text
@d1 1
a1 1
.\"	$OpenBSD: cd.4,v 1.1 1997/03/28 22:53:39 millert Exp $
d366 1
a366 1
driver only support
@


1.1
log
@Move ncr.4 out of man4.i386/ncr.4 and update it from NetBSD.
Remove one of the tekram cards from man4.i386/aha.4 that is really
ncr-based and add cd.4, fpa.4, sd.4, st.4, uk.4 from NetBSD
(some originally from FreeBSD).
@
text
@d1 1
a1 1
.\"	$OpenBSD$
d99 3
a101 1
read from the scsi inquiry commands, and should be the same as
@

