head	1.11;
access;
symbols
	OPENBSD_6_2:1.10.0.4
	OPENBSD_6_2_BASE:1.10
	OPENBSD_6_1:1.5.0.4
	OPENBSD_6_1_BASE:1.5;
locks; strict;
comment	@.\" @;


1.11
date	2017.10.05.15.13.43;	author jmc;	state Exp;
branches;
next	1.10;
commitid	Qp3Gx0RdtrzfycJK;

1.10
date	2017.09.13.14.19.57;	author anton;	state Exp;
branches;
next	1.9;
commitid	Sc9TAIV7Fttpmg3i;

1.9
date	2017.07.29.21.01.13;	author kettenis;	state Exp;
branches;
next	1.8;
commitid	z6xg0HFOqSB2mU4k;

1.8
date	2017.07.29.20.49.32;	author kettenis;	state Exp;
branches;
next	1.7;
commitid	hRahALqHHH7HaAdd;

1.7
date	2017.06.23.06.07.51;	author tedu;	state Exp;
branches;
next	1.6;
commitid	0kPDFMxttfPeJXCR;

1.6
date	2017.06.06.09.42.09;	author jsg;	state Exp;
branches;
next	1.5;
commitid	z4s5l5suphuyG6lX;

1.5
date	2017.03.12.01.21.32;	author jsg;	state Exp;
branches;
next	1.4;
commitid	LZVmqo2MLi3GANR3;

1.4
date	2017.02.14.12.50.15;	author jmc;	state Exp;
branches;
next	1.3;
commitid	TJ6szOJPRlfOval9;

1.3
date	2017.02.12.09.55.15;	author jsg;	state Exp;
branches;
next	1.2;
commitid	V7xFpniUScMK2IiP;

1.2
date	2016.09.27.19.33.57;	author pascal;	state Exp;
branches;
next	1.1;
commitid	u1fKd9vNUR7OQ1XJ;

1.1
date	2016.09.27.18.13.27;	author pascal;	state Exp;
branches;
next	;
commitid	pBzjzoYJqttwwGY2;


desc
@@


1.11
log
@clang does not search /usr/local;

from janne johansson
ok patrick
@
text
@.\" $OpenBSD: clang-local.1,v 1.10 2017/09/13 14:19:57 anton Exp $
.\"
.\" Copyright (c) 2016 Pascal Stumpf <pascal@@stumpf.co>
.\"
.\" Permission to use, copy, modify, and distribute this software for any
.\" purpose with or without fee is hereby granted, provided that the above
.\" copyright notice and this permission notice appear in all copies.
.\"
.\" THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
.\" WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
.\" MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
.\" ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
.\" WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
.\" ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
.\" OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
.\"
.\"
.Dd $Mdocdate: September 13 2017 $
.Dt CLANG-LOCAL 1
.Os
.Sh NAME
.Nm clang-local
.Nd OpenBSD-specific behavior of LLVM/clang
.Sh DESCRIPTION
On
.Ox ,
the LLVM/clang compiler exhibits the following characteristics:
.Bl -dash
.It
.Nm clang
does not search under
.Pa /usr/local
for include files or libraries:
as a system compiler, it only searches the system paths by default.
.It
.Nm clang
comes with stack protection enabled by default, equivalent to the
.Fl fstack-protector-strong
option on other systems.
The system will report any violation of the stack protector cookie along
with the function name via
.Xr syslog 3
at
.Dv LOG_CRIT
priority.
.It
.Nm clang
will generate PIE code by default, allowing the system to load the resulting
binary at a random location.
This behavior can be turned off by passing
.Fl fno-pie
to the compiler and
.Fl nopie
to the linker.
.It
The
.Fl fstrict-aliasing
option is turned off by default unless
.Fl Ofast
has been selected.
.It
.Nm clang
does not store its version string in objects.
There is no option to control this.
.It
The
.Fl pg
flag is an alias of
.Fl p .
.It
.Nm clang
does not warn for passing pointer arguments or assignment with
different signedness outside of
.Fl pedantic .
This can be
re-enabled with the
.Fl Wpointer-sign
flag.
.It
The warning option
.Fl Waddress-of-packed-member
is disabled by default.
.It
Color diagnostic messages are disabled by default and can be re-enabled with
.Fl fdiagnostics-color .
.It
The
.Fl fwrapv
option to treat signed integer overflows as defined is enabled by default to
prevent dangerous optimizations which could remove security critical overflow
checks.
.It
The
.Xr malloc 3 ,
.Xr calloc 3 ,
.Xr realloc 3 ,
.Xr strdup 3 ,
.Xr strndup 3 ,
.Xr valloc 3
and
.Xr free 3
builtins are disabled to prevent undesirable optimizations of calls to
these functions.
.El
.Sh SEE ALSO
.Xr clang 1
@


1.10
log
@Fix typo; ok benno@@ jmc@@ sthen@@ tb@@
@
text
@d1 1
a1 1
.\" $OpenBSD: clang-local.1,v 1.9 2017/07/29 21:01:13 kettenis Exp $
d18 1
a18 1
.Dd $Mdocdate: July 29 2017 $
d29 6
@


1.9
log
@Document that builtins for certain malloc(3)-like and free(3)-like
functions are disabled.
@
text
@d1 1
a1 1
.\" $OpenBSD: clang-local.1,v 1.8 2017/07/29 20:49:32 kettenis Exp $
d96 1
a96 1
builtins are disabled to prevent undesriable optimizations of calls to
@


1.8
log
@Document that -Waddress-of-packed-member is disabled by default.
@
text
@d1 1
a1 1
.\" $OpenBSD: clang-local.1,v 1.7 2017/06/23 06:07:51 tedu Exp $
d18 1
a18 1
.Dd $Mdocdate: June 23 2017 $
d86 12
@


1.7
log
@i didn't know we had clang-local until reminded by jsg.
mention the disabling of ident strings.
@
text
@d1 1
a1 1
.\" $OpenBSD: clang-local.1,v 1.6 2017/06/06 09:42:09 jsg Exp $
d18 1
a18 1
.Dd $Mdocdate: June 6 2017 $
d73 4
@


1.6
log
@mention -fwrapv being on by default
@
text
@d1 1
a1 1
.\" $OpenBSD: clang-local.1,v 1.5 2017/03/12 01:21:32 jsg Exp $
d18 1
a18 1
.Dd $Mdocdate: March 12 2017 $
d55 4
@


1.5
log
@Colour diagnostic messages are now disabled by default.
@
text
@d1 1
a1 1
.\" $OpenBSD: clang-local.1,v 1.4 2017/02/14 12:50:15 jmc Exp $
d18 1
a18 1
.Dd $Mdocdate: February 14 2017 $
d72 6
@


1.4
log
@tweak previous; ok jsg, who reminded me the same text in
gcc-local needed bumped too;
@
text
@d1 1
a1 1
.\" $OpenBSD: clang-local.1,v 1.3 2017/02/12 09:55:15 jsg Exp $
d18 1
a18 1
.Dd $Mdocdate: February 12 2017 $
d69 3
@


1.3
log
@mention -Wpointer-sign being off by default
@
text
@d1 1
a1 1
.\" $OpenBSD: clang-local.1,v 1.2 2016/09/27 19:33:57 pascal Exp $
d18 1
a18 1
.Dd $Mdocdate: September 27 2016 $
d62 1
a62 1
does not warn for pointer arguments passing or assignment with
@


1.2
log
@Small nit from kettenis@@: -fstrict-aliasing is turned on if -Ofast.
@
text
@d1 1
a1 1
.\" $OpenBSD: clang-local.1,v 1.1 2016/09/27 18:13:27 pascal Exp $
d4 1
a4 1
.\" 
d8 1
a8 1
.\" 
d16 2
a17 2
.\" 
.\" 
d60 9
@


1.1
log
@Add a clang-local(1) man page, similar to gcc-local(1).  This documents
OpenBSD-specific quirks for LLVM/clang.  To be expanded as we go along.

idea from kettenis@@, ok deraadt@@
@
text
@d1 1
a1 1
.\" $OpenBSD$
d18 1
a18 1
.Dd $Mdocdate$
d52 3
a54 1
option is turned off by default.
@

