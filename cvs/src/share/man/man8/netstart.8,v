head	1.21;
access;
symbols
	OPENBSD_6_1:1.21.0.4
	OPENBSD_6_1_BASE:1.21
	OPENBSD_6_0:1.20.0.4
	OPENBSD_6_0_BASE:1.20
	OPENBSD_5_9:1.20.0.2
	OPENBSD_5_9_BASE:1.20
	OPENBSD_5_8:1.19.0.18
	OPENBSD_5_8_BASE:1.19
	OPENBSD_5_7:1.19.0.10
	OPENBSD_5_7_BASE:1.19
	OPENBSD_5_6:1.19.0.14
	OPENBSD_5_6_BASE:1.19
	OPENBSD_5_5:1.19.0.12
	OPENBSD_5_5_BASE:1.19
	OPENBSD_5_4:1.19.0.8
	OPENBSD_5_4_BASE:1.19
	OPENBSD_5_3:1.19.0.6
	OPENBSD_5_3_BASE:1.19
	OPENBSD_5_2:1.19.0.4
	OPENBSD_5_2_BASE:1.19
	OPENBSD_5_1_BASE:1.19
	OPENBSD_5_1:1.19.0.2
	OPENBSD_5_0:1.17.0.4
	OPENBSD_5_0_BASE:1.17
	OPENBSD_4_9:1.17.0.2
	OPENBSD_4_9_BASE:1.17
	OPENBSD_4_8:1.16.0.14
	OPENBSD_4_8_BASE:1.16
	OPENBSD_4_7:1.16.0.10
	OPENBSD_4_7_BASE:1.16
	OPENBSD_4_6:1.16.0.12
	OPENBSD_4_6_BASE:1.16
	OPENBSD_4_5:1.16.0.8
	OPENBSD_4_5_BASE:1.16
	OPENBSD_4_4:1.16.0.6
	OPENBSD_4_4_BASE:1.16
	OPENBSD_4_3:1.16.0.4
	OPENBSD_4_3_BASE:1.16
	OPENBSD_4_2:1.16.0.2
	OPENBSD_4_2_BASE:1.16
	OPENBSD_4_1:1.15.0.2
	OPENBSD_4_1_BASE:1.15
	OPENBSD_4_0:1.11.0.4
	OPENBSD_4_0_BASE:1.11
	OPENBSD_3_9:1.11.0.2
	OPENBSD_3_9_BASE:1.11
	OPENBSD_3_8:1.9.0.6
	OPENBSD_3_8_BASE:1.9
	OPENBSD_3_7:1.9.0.4
	OPENBSD_3_7_BASE:1.9
	OPENBSD_3_6:1.9.0.2
	OPENBSD_3_6_BASE:1.9
	OPENBSD_3_5:1.8.0.2
	OPENBSD_3_5_BASE:1.8
	OPENBSD_3_4:1.7.0.2
	OPENBSD_3_4_BASE:1.7
	OPENBSD_3_3:1.4.0.2
	OPENBSD_3_3_BASE:1.4
	OPENBSD_3_2:1.3.0.2
	OPENBSD_3_2_BASE:1.3
	OPENBSD_3_1:1.2.0.2
	OPENBSD_3_1_BASE:1.2;
locks; strict;
comment	@.\" @;


1.21
date	2016.09.05.12.58.17;	author jmc;	state Exp;
branches;
next	1.20;
commitid	lU2HmDLaVz3pdCg9;

1.20
date	2015.12.05.18.43.12;	author mpi;	state Exp;
branches;
next	1.19;
commitid	Hwe4NrlSqy1olQ0E;

1.19
date	2011.11.13.12.43.49;	author ajacoutot;	state Exp;
branches;
next	1.18;

1.18
date	2011.08.22.12.52.54;	author jmc;	state Exp;
branches;
next	1.17;

1.17
date	2011.02.10.09.11.24;	author sobrado;	state Exp;
branches;
next	1.16;

1.16
date	2007.05.31.19.19.59;	author jmc;	state Exp;
branches;
next	1.15;

1.15
date	2006.12.31.10.41.52;	author jmc;	state Exp;
branches;
next	1.14;

1.14
date	2006.11.16.12.27.44;	author jmc;	state Exp;
branches;
next	1.13;

1.13
date	2006.11.16.12.22.21;	author jmc;	state Exp;
branches;
next	1.12;

1.12
date	2006.11.16.11.24.20;	author jmc;	state Exp;
branches;
next	1.11;

1.11
date	2005.11.10.10.36.59;	author jmc;	state Exp;
branches;
next	1.10;

1.10
date	2005.10.15.11.49.11;	author jmc;	state Exp;
branches;
next	1.9;

1.9
date	2004.07.23.17.27.40;	author jaredy;	state Exp;
branches;
next	1.8;

1.8
date	2004.02.13.23.45.46;	author miod;	state Exp;
branches;
next	1.7;

1.7
date	2003.07.29.13.17.00;	author jmc;	state Exp;
branches;
next	1.6;

1.6
date	2003.06.06.19.28.06;	author jmc;	state Exp;
branches;
next	1.5;

1.5
date	2003.06.02.16.16.26;	author miod;	state Exp;
branches;
next	1.4;

1.4
date	2003.02.07.07.45.13;	author jmc;	state Exp;
branches;
next	1.3;

1.3
date	2002.05.23.09.30.35;	author mpech;	state Exp;
branches;
next	1.2;

1.2
date	2002.02.22.02.02.25;	author miod;	state Exp;
branches;
next	1.1;

1.1
date	2002.02.21.02.36.09;	author miod;	state Exp;
branches;
next	;


desc
@@


1.21
log
@for consistency, hyphenate "single-user";
from rob pierce
@
text
@.\"	$OpenBSD: netstart.8,v 1.20 2015/12/05 18:43:12 mpi Exp $
.\"
.\" Copyright (c) 2002, Miodrag Vallat.
.\" All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
.\" IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
.\" OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
.\" IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
.\" INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
.\" NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
.\" DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
.\" THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
.\" (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
.\" THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
.\"
.\"     @@(#)rc.8	8.2 (Berkeley) 12/11/93
.\"
.Dd $Mdocdate: December 5 2015 $
.Dt NETSTART 8
.Os
.Sh NAME
.Nm netstart
.Nd command script for network startup
.Sh SYNOPSIS
.Nm /etc/netstart
.Op Ar interface ...
.Sh DESCRIPTION
.Nm
is the command script that is invoked by
.Xr rc 8
during an automatic reboot and after single-user mode is exited;
it performs network initialization.
.Pp
The
.Nm
script can also be used to start newly created bridges or interfaces,
or reset existing interfaces to their default state.
The behaviour of this script is (or can be) controlled to some
extent by variables defined in
.Xr rc.conf 8 ,
which specifies which daemons and services are to be run.
.Pp
During the system boot,
.Nm
is executed.
.Nm
performs the following operations, in the sequence given:
.Pp
.Bl -bullet -compact -offset indent
.It
Set the machine's name.
.It
Configure the loopback interface.
.It
Configure all the physical interfaces.
.It
Configure the following non-physical interfaces:
.Xr trunk 4 ,
.Xr vlan 4 ,
.Xr pfsync 4 ,
and
.Xr carp 4 .
.It
Initialize the routing table and set up the default routes.
.It
Configure the remaining non-physical interfaces:
.Xr pppoe 4 ,
.Xr gif 4 ,
and
.Xr gre 4 .
.It
Configure all
.Xr bridge 4
interfaces.
.El
.Pp
After the system is completely initialized, it is possible to start a
newly created interface or
.Xr bridge 4 ,
or reset an existing interface to its default state, by invoking
the following, where
.Ar foo0
is the interface or bridge name:
.Pp
.D1 # sh /etc/netstart foo0
.Sh MULTICAST ROUTING
To enable
.Xr multicast 4
routing, the
.Va net.inet.ip.mforwarding
and/or
.Va net.inet6.ip6.mforwarding
.Xr sysctl 8
variables should be set to 1.
Multicast routing is only enabled if
.Va multicast
is set to
.Qq YES
in
.Xr rc.conf.local 8 .
Other cases are configuration errors
and will cause multicast routing not to be enabled.
.Sh SEE ALSO
.Xr multicast 4 ,
.Xr defaultdomain 5 ,
.Xr hostname.if 5 ,
.Xr myname 5 ,
.Xr ifconfig 8 ,
.Xr rc 8 ,
.Xr rc.conf 8
.Sh HISTORY
The
.Nm
command first appeared in
.Bx 4.0 .
@


1.20
log
@It does not make sense to insert a specific route for 224/4 when the
default one is good enough.

So merge rc.conf(8)'s 'multicast_router' and 'multicast_host' into a
single 'multicast'.  If set to YES the reject route for 224/4 is not
inserted by netstart(8).

Manual bits from jmc@@

ok henning@@, ajacoutot@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: netstart.8,v 1.19 2011/11/13 12:43:49 ajacoutot Exp $
d28 1
a28 1
.Dd $Mdocdate: November 13 2011 $
d41 1
a41 1
during an automatic reboot and after single user mode is exited;
@


1.19
log
@/etc/rc.conf -> rc.conf(8)

ok jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: netstart.8,v 1.18 2011/08/22 12:52:54 jmc Exp $
d28 1
a28 1
.Dd $Mdocdate: August 22 2011 $
d105 8
a112 42
Routing to the 224.0.0.0/4 net is set up using values from
.Xr rc.conf 8
according to these rules:
.Bl -bullet
.It
The default.
If the multicast settings are as follows
then multicast routing will not be enabled.
.Bd -literal -offset indent
multicast_host=NO
multicast_router=NO
.Ed
.It
If the multicast settings are as follows
then multicast routing will be enabled,
but no multicast route will be set up.
It is expected that a routing daemon, such as
.Xr mrouted 8 ,
will be started as well.
.Bd -literal -offset indent
multicast_host=NO
multicast_router=YES
.Ed
.It
If the multicast settings are as follows
then multicast routing will be enabled,
using the default interface,
or the interface name specified by
.Va multicast_host .
.Bd -literal -offset indent
multicast_host=YES
multicast_router=NO
.Ed
or:
.Bd -literal -offset indent -compact
multicast_host=foo0	# interface name
multicast_router=NO
.Ed
.It
Other cases are configuration errors and will cause multicast routing not to be
enabled.
.El
@


1.18
log
@correct sysctl name; from Thomas Pfaff
@
text
@d1 1
a1 1
.\"	$OpenBSD: netstart.8,v 1.17 2011/02/10 09:11:24 sobrado Exp $
d28 1
a28 1
.Dd $Mdocdate: February 10 2011 $
d50 1
a50 1
.Pa /etc/rc.conf ,
d106 1
a106 1
.Pa /etc/rc.conf
@


1.17
log
@fix manual page description; replace .Pa -> .Nm in synopsis.

ok schwarze@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: netstart.8,v 1.16 2007/05/31 19:19:59 jmc Exp $
d28 1
a28 1
.Dd $Mdocdate: May 31 2007 $
d102 1
a102 1
.Va net.inet.ip6.mforwarding
@


1.16
log
@convert to new .Dd format;
@
text
@d1 1
a1 1
.\"	$OpenBSD: netstart.8,v 1.15 2006/12/31 10:41:52 jmc Exp $
d28 1
a28 1
.Dd $Mdocdate$
d33 1
a33 1
.Nd command scripts for network startup
d35 1
a35 1
.Pa /etc/netstart
@


1.15
log
@- newly-created -> newly created
- hostname.if(5) and bridgename.if(5) are the same files, so don;t list
them both in SEE ALSO
- +.Xr ifconfig 8
@
text
@d1 1
a1 1
.\"	$OpenBSD: netstart.8,v 1.14 2006/11/16 12:27:44 jmc Exp $
d28 1
a28 1
.Dd February 20, 2002
@


1.14
log
@trim SEE ALSO;
@
text
@d1 1
a1 1
.\"	$OpenBSD: netstart.8,v 1.13 2006/11/16 12:22:21 jmc Exp $
d46 1
a46 1
script can also be used to start newly-created bridges or interfaces,
d88 1
a88 1
newly-created interface or
a148 1
.Xr bridgename.if 5 ,
d152 1
@


1.13
log
@document multicast sysctls; ok mcbride
@
text
@d1 1
a1 1
.\"	$OpenBSD: netstart.8,v 1.12 2006/11/16 11:24:20 jmc Exp $
a147 4
.Xr bridge 4 ,
.Xr carp 4 ,
.Xr gif 4 ,
.Xr gre 4 ,
a148 4
.Xr pfsync 4 ,
.Xr pppoe 4 ,
.Xr trunk 4 ,
.Xr vlan 4 ,
a152 2
.Xr dhcp 8 ,
.Xr mrouted 8 ,
@


1.12
log
@better text layout;
@
text
@d1 1
a1 1
.\"	$OpenBSD: netstart.8,v 1.11 2005/11/10 10:36:59 jmc Exp $
d97 8
d110 1
d152 1
@


1.11
log
@- update the section on what netstart actually does
- couple tweaks whilst here

help/ok todd@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: netstart.8,v 1.10 2005/10/15 11:49:11 jmc Exp $
d102 2
a103 1
If the multicast settings are as follows:
a107 2
.Pp
then multicast routing will not be enabled.
d109 6
a114 1
If the multicast settings are as follows:
a118 5
.Pp
then multicast routing will be enabled, but no multicast route will be set up.
It is expected that a routing daemon, such as
.Xr mrouted 8 ,
will be started as well.
d120 5
a124 1
If the multicast settings are as follows:
a133 4
.Pp
then multicast routing will be enabled, using the default interface,
or the interface name specified by
.Va multicast_host .
@


1.10
log
@remove Xr to mygate(5): we already Xr myname(5), which is the
same file, and there is no point sending people to read the
same file twice;
@
text
@d1 1
a1 1
.\"	$OpenBSD: netstart.8,v 1.9 2004/07/23 17:27:40 jaredy Exp $
d57 1
a57 1
will perform the following operations:
d59 1
a59 1
.Bl -bullet -compact
d67 7
d76 3
a78 2
Configure all the
.Xr gif 4
d80 4
a83 1
.Xr gre 4
a84 2
.It
Configure all the bridges.
d91 3
d95 1
a95 5
.D1 sh /etc/netstart foo0
.Pp
where
.Ar foo0
is the interface or bridge name.
d141 1
d144 4
d159 1
a159 1
command appeared in
@


1.9
log
@add a manpage for /etc/defaultdomain

help and ok jmc, miod, millert, and others
@
text
@d1 1
a1 1
.\"	$OpenBSD: netstart.8,v 1.8 2004/02/13 23:45:46 miod Exp $
a137 1
.Xr mygate 5 ,
@


1.8
log
@Use .Pa, not .Nm, for filenames; spotted by Jared Yanovich.
@
text
@d1 1
a1 1
.\"	$OpenBSD: netstart.8,v 1.7 2003/07/29 13:17:00 jmc Exp $
d136 1
d138 2
@


1.7
log
@remove -compact and add a bit of spacing;
ok miod@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: netstart.8,v 1.6 2003/06/06 19:28:06 jmc Exp $
d35 1
a35 1
.Nm /etc/netstart
d38 1
a38 1
.Nm netstart
d45 1
a45 1
.Nm netstart
d50 1
a50 1
.Nm rc.conf ,
d56 1
a56 1
.Nm netstart
@


1.6
log
@- section reorder
- macro fixes
- kill whitespace at EOL
@
text
@d1 1
a1 1
.\"	$OpenBSD: netstart.8,v 1.5 2003/06/02 16:16:26 miod Exp $
d36 1
a36 1
.Op interface ...
d58 1
d82 3
a84 3
.Bd -literal -offset indent -compact
sh /etc/netstart foo0
.Ed
d92 1
a92 1
.Bl -bullet -compact
d95 1
a95 1
.Bd -literal -offset indent -compact
d99 1
d103 1
a103 1
.Bd -literal -offset indent -compact
d107 1
d114 1
a114 1
.Bd -literal -offset indent -compact
d123 1
@


1.5
log
@Relax licence by removing the 3rd clause on all files whereI was still
using a 3 clause licence.
@
text
@d1 1
a1 1
.\"	$OpenBSD: netstart.8,v 1.4 2003/02/07 07:45:13 jmc Exp $
d54 1
a54 1
.Nm 
@


1.4
log
@typos;
@
text
@d1 1
a1 1
.\"	$OpenBSD: netstart.8,v 1.3 2002/05/23 09:30:35 mpech Exp $
a13 2
.\" 3. The name of the author may not be used to endorse or promote products
.\"    derived from this software without specific prior written permission.
@


1.3
log
@'SEE ALSO' audit in 'share/man/':
o) sort;
o) "," is separator of entries;
o) don't use "." or "," in the last entry;

millert@@ ok
@
text
@d1 1
a1 1
.\"	$OpenBSD: netstart.8,v 1.2 2002/02/22 02:02:25 miod Exp $
d68 1
a68 1
Initialize the routing table and setup the default routes.
d90 1
a90 1
Routing to the 224.0.0.0/4 net is setup using values from
d137 2
a138 2
.Xr rc.conf 8 ,
.Xr rc 8
@


1.2
log
@Attempt to document the multicast routing configuration here, rather than
having people read the comments in /etc/netstart.
Add more Xr in the way.
@
text
@d1 1
a1 1
.\"	$OpenBSD: netstart.8,v 1.1 2002/02/21 02:36:09 miod Exp $
a130 2
.Xr bridgename.if 5 ,
.Xr dhcp 8 ,
d133 1
d135 1
@


1.1
log
@With the recent changes to /etc/netstart, split the part of rc.8 covering
it into a full-blown manual page, and document the new behaviour, in
particular, what I forgot to add in the previous commit message.

Add more Xrefs to network-related configuration files in netstart.8.

There is still room for improvement: multicast routing ought to be documented
in netstart.8 now, and afterboot.8 modified accordingly.

ok chris@@
@
text
@d1 1
a1 1
.\"	$OpenBSD$
d83 1
a83 1
.Bd -literal -compact
d89 40
d132 1
d136 1
@

