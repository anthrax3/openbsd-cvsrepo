head	1.15;
access;
symbols
	OPENBSD_6_2_BASE:1.15
	OPENBSD_6_1:1.14.0.14
	OPENBSD_6_1_BASE:1.14
	OPENBSD_6_0:1.14.0.10
	OPENBSD_6_0_BASE:1.14
	OPENBSD_5_9:1.14.0.6
	OPENBSD_5_9_BASE:1.14
	OPENBSD_5_8:1.14.0.8
	OPENBSD_5_8_BASE:1.14
	OPENBSD_5_7:1.14.0.2
	OPENBSD_5_7_BASE:1.14
	OPENBSD_5_6:1.14.0.4
	OPENBSD_5_6_BASE:1.14
	OPENBSD_5_5:1.13.0.14
	OPENBSD_5_5_BASE:1.13
	OPENBSD_5_4:1.13.0.10
	OPENBSD_5_4_BASE:1.13
	OPENBSD_5_3:1.13.0.8
	OPENBSD_5_3_BASE:1.13
	OPENBSD_5_2:1.13.0.6
	OPENBSD_5_2_BASE:1.13
	OPENBSD_5_1_BASE:1.13
	OPENBSD_5_1:1.13.0.4
	OPENBSD_5_0:1.13.0.2
	OPENBSD_5_0_BASE:1.13
	OPENBSD_4_9:1.10.0.2
	OPENBSD_4_9_BASE:1.10
	OPENBSD_4_8:1.8.0.14
	OPENBSD_4_8_BASE:1.8
	OPENBSD_4_7:1.8.0.10
	OPENBSD_4_7_BASE:1.8
	OPENBSD_4_6:1.8.0.12
	OPENBSD_4_6_BASE:1.8
	OPENBSD_4_5:1.8.0.8
	OPENBSD_4_5_BASE:1.8
	OPENBSD_4_4:1.8.0.6
	OPENBSD_4_4_BASE:1.8
	OPENBSD_4_3:1.8.0.4
	OPENBSD_4_3_BASE:1.8
	OPENBSD_4_2:1.8.0.2
	OPENBSD_4_2_BASE:1.8
	OPENBSD_4_1:1.7.0.4
	OPENBSD_4_1_BASE:1.7
	OPENBSD_4_0:1.7.0.2
	OPENBSD_4_0_BASE:1.7
	OPENBSD_3_9:1.6.0.10
	OPENBSD_3_9_BASE:1.6
	OPENBSD_3_8:1.6.0.8
	OPENBSD_3_8_BASE:1.6
	OPENBSD_3_7:1.6.0.6
	OPENBSD_3_7_BASE:1.6
	OPENBSD_3_6:1.6.0.4
	OPENBSD_3_6_BASE:1.6
	OPENBSD_3_5:1.6.0.2
	OPENBSD_3_5_BASE:1.6
	OPENBSD_3_4:1.5.0.2
	OPENBSD_3_4_BASE:1.5
	OPENBSD_3_3:1.4.0.2
	OPENBSD_3_3_BASE:1.4
	OPENBSD_3_2:1.3.0.6
	OPENBSD_3_2_BASE:1.3
	OPENBSD_3_1:1.3.0.4
	OPENBSD_3_1_BASE:1.3
	OPENBSD_3_0:1.3.0.2
	OPENBSD_3_0_BASE:1.3
	OPENBSD_2_9:1.2.0.8
	OPENBSD_2_9_BASE:1.2
	OPENBSD_2_8:1.2.0.6
	OPENBSD_2_8_BASE:1.2
	OPENBSD_2_7:1.2.0.4
	OPENBSD_2_7_BASE:1.2
	OPENBSD_2_6:1.2.0.2
	OPENBSD_2_6_BASE:1.2;
locks; strict;
comment	@.\" @;


1.15
date	2017.07.13.19.16.33;	author jmc;	state Exp;
branches;
next	1.14;
commitid	JpuOPPFrvYnLU8Rv;

1.14
date	2014.07.14.09.14.11;	author ajacoutot;	state Exp;
branches;
next	1.13;
commitid	htlk0ixWqRYelMA2;

1.13
date	2011.07.08.02.14.13;	author ajacoutot;	state Exp;
branches;
next	1.12;

1.12
date	2011.05.22.06.27.27;	author jmc;	state Exp;
branches;
next	1.11;

1.11
date	2011.04.22.14.11.08;	author ajacoutot;	state Exp;
branches;
next	1.10;

1.10
date	2011.02.12.11.22.31;	author ajacoutot;	state Exp;
branches;
next	1.9;

1.9
date	2011.01.16.14.20.54;	author robert;	state Exp;
branches;
next	1.8;

1.8
date	2007.05.31.19.19.59;	author jmc;	state Exp;
branches;
next	1.7;

1.7
date	2006.04.08.08.53.07;	author jmc;	state Exp;
branches;
next	1.6;

1.6
date	2003.10.24.08.15.43;	author jmc;	state Exp;
branches;
next	1.5;

1.5
date	2003.06.04.19.36.33;	author deraadt;	state Exp;
branches;
next	1.4;

1.4
date	2003.02.15.09.32.30;	author jmc;	state Exp;
branches;
next	1.3;

1.3
date	2001.10.05.14.45.54;	author mpech;	state Exp;
branches;
next	1.2;

1.2
date	99.09.03.22.14.08;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	99.07.20.18.35.35;	author aaron;	state Exp;
branches;
next	;


desc
@@


1.15
log
@man pages with pseudo synopses which list filenames end up creating
very ugly output in man -k; after some discussion with ingo, we feel
the simplest fix is to remove such SYNOPSIS sections: the info is hardly
helpful at page top, is contained already in FILES, and there are
sufficiently few that just zapping them is simple;

ok schwarze, who also helpfully ran things through a build to check
output;
@
text
@.\"	$OpenBSD: rc.shutdown.8,v 1.14 2014/07/14 09:14:11 ajacoutot Exp $
.\"
.\" Copyright (c) 1999 Aaron Campbell
.\" All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\"
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
.\" IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
.\" OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
.\" IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
.\" INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
.\" NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
.\" DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
.\" THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
.\" (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
.\" THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
.\"
.Dd $Mdocdate: July 14 2014 $
.Dt RC.SHUTDOWN 8
.Os
.Sh NAME
.Nm rc.shutdown
.Nd command script run at system shutdown
.Sh DESCRIPTION
When the system is shut down using the
.Xr reboot 8
or
.Xr halt 8
commands,
or when
.Xr init 8
is signalled to do so,
or when a keyboard-requested halt is issued (if the architecture supports it),
.Xr rc 8
is invoked with the argument
.Dq shutdown .
This document details the actions taken by
.Xr rc 8
in such an instance.
.Pp
Firstly it saves random data for reseeding the kernel random number
generator during the next boot.
It then stops any daemons
defined in the
.Va pkg_scripts
variable in
.Xr rc.conf.local 8 ,
by passing them the
.Cm stop
argument.
.Pp
.Xr rc 8
then runs
.Nm .
The administrator should place in this file
any commands they wish to have executed during shutdown.
.Pp
Finally, all
.Xr carp 4
interfaces are brought down and then the system shuts down.
.Pp
If
.Xr init 8
is exiting single-user mode it will also run the first part of shutdown
(saving random data),
though not the latter.
.Sh FILES
.Bl -tag -width "/etc/rc.shutdown"
.It Pa /etc/rc.shutdown
Command script run at system shutdown.
.El
.Sh SEE ALSO
.Xr init 8 ,
.Xr rc 8 ,
.Xr rc.conf 8 ,
.Xr reboot 8
@


1.14
log
@powerdown is gone.
@
text
@d1 1
a1 1
.\"	$OpenBSD: rc.shutdown.8,v 1.13 2011/07/08 02:14:13 ajacoutot Exp $
d27 1
a27 1
.Dd $Mdocdate: July 8 2011 $
a32 2
.Sh SYNOPSIS
.Nm /etc/rc.shutdown
d76 5
@


1.13
log
@Rename 'rc_scripts' to 'pkg_scripts' to make it clear this variable is for
packages _only_. One is not supposed to add any base scripts in it.

naddy@@ doesn't care (I think he does care but he won't admit it)
ok robert@@

(I'll add something to current.html in a few)
@
text
@d1 1
a1 1
.\"	$OpenBSD: rc.shutdown.8,v 1.12 2011/05/22 06:27:27 jmc Exp $
d27 1
a27 1
.Dd $Mdocdate: May 22 2011 $
a71 7
If
.Nm
has the variable
.Va powerdown
set to
.Dq YES ,
the machine will attempt to power off after it has halted.
@


1.12
log
@better document what happens at system shutdown;
much discussion/help/ok ajacoutot schwarze
@
text
@d1 1
a1 1
.\"	$OpenBSD: rc.shutdown.8,v 1.11 2011/04/22 14:11:08 ajacoutot Exp $
d27 1
a27 1
.Dd $Mdocdate: April 22 2011 $
d56 1
a56 1
.Va rc_scripts
@


1.11
log
@Move things around after recent rc(8) changes.

ok robert@@ jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: rc.shutdown.8,v 1.10 2011/02/12 11:22:31 ajacoutot Exp $
d27 1
a27 1
.Dd $Mdocdate: February 12 2011 $
d33 2
d36 1
a36 1
When the system is administratively shut down using either the
d40 5
a44 1
command,
d47 15
a61 7
.Dq shutdown ,
which checks for the existence of a
.Pa /etc/rc.shutdown
script to run before halting the system.
This script, like
.Xr rc.local 8 ,
is entirely for commands added by the system administrator.
d63 5
a67 5
The
.Nm
script is also executed by
.Xr init 8
if a keyboard-requested halt is issued (for architectures that support this).
d69 3
d74 1
a74 1
sets the variable
d76 1
a76 1
to
d78 7
a84 2
.Xr halt 8
will attempt to power down the machine after it has halted.
a85 1
.Xr halt 8 ,
@


1.10
log
@Extend rc_scripts documentation.

prodded by espie@@
ok jmc@@ (with tweaks), ok miod@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: rc.shutdown.8,v 1.9 2011/01/16 14:20:54 robert Exp $
d27 1
a27 1
.Dd $Mdocdate: January 16 2011 $
d47 1
a47 9
executes the
.Xr rc.d 8
scripts specified by the
.Va rc_scripts
variable defined in
.Xr rc.conf 8
in a reverse order.
.Pa /etc/rc.shutdown
is also for commands added by the system administrator.
a67 1
.Xr rc.d 8 ,
@


1.9
log
@hook rc.subr.8 to the build and create a link to rc.d.8 and
document the missing pieces in rc(8) and rc.shutdown(8)
@
text
@d1 1
a1 1
.\"	$OpenBSD: rc.shutdown.8,v 1.8 2007/05/31 19:19:59 jmc Exp $
d27 1
a27 1
.Dd $Mdocdate: May 31 2007 $
d49 5
a53 1
scripts specified by the rc_scripts variable in a reversed order.
d75 1
@


1.8
log
@convert to new .Dd format;
@
text
@d1 1
a1 1
.\"	$OpenBSD: rc.shutdown.8,v 1.7 2006/04/08 08:53:07 jmc Exp $
d27 1
a27 1
.Dd $Mdocdate$
d47 5
a51 1
is entirely for commands added by the system administrator.
d71 1
@


1.7
log
@document "powerdown" in rc.shutdown;
based on diffs from henning, and ok him too...
@
text
@d1 1
a1 1
.\"	$OpenBSD: rc.shutdown.8,v 1.6 2003/10/24 08:15:43 jmc Exp $
d27 1
a27 1
.Dd July 20, 1999
@


1.6
log
@.Nm /etc/rc.shutdown -> .Nm rc.shutdown, in line with the rest of the
rc* pages;

suggested by Jared Yanovich, though I did not include his FILES addition;
@
text
@d1 1
a1 1
.\"	$OpenBSD: rc.shutdown.8,v 1.5 2003/06/04 19:36:33 deraadt Exp $
d38 5
a42 1
command, either of these programs checks for the existence of a
d45 7
a51 1
It will also be executed by
d55 1
a55 1
The
d57 6
a62 3
script, like
.Xr rc.local 8 ,
is entirely for commands added by the system administrator.
@


1.5
log
@3/4 cleanup for aaron
@
text
@d1 1
a1 1
.\"	$OpenBSD: rc.shutdown.8,v 1.4 2003/02/15 09:32:30 jmc Exp $
d31 1
a31 1
.Nm /etc/rc.shutdown
@


1.4
log
@copyrights added;

these are all (c) aaron@@
ok aaron@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: rc.shutdown.8,v 1.3 2001/10/05 14:45:54 mpech Exp $
a14 5
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgement:
.\"	This product includes software developed by Aaron Campbell.
.\" 4. The name of the author may not be used to endorse or promote products
.\"    derived from this software without specific prior written permission.
@


1.3
log
@Powered by @@mantoya:
o) start new sentence on a new line;
o) minor mdoc fixes;
millert@@ ok

Tip of the day:   www.mpechismazohist.com
@
text
@d1 31
a31 1
.\"	$OpenBSD: rc.shutdown.8,v 1.2 1999/09/03 22:14:08 deraadt Exp $
@


1.2
log
@entropy saving moved to rc
@
text
@d1 1
a1 1
.\"	$OpenBSD: rc.shutdown.8,v 1.1 1999/07/20 18:35:35 aaron Exp $
d15 2
a16 1
script to run before halting the system. It will also be executed by
@


1.1
log
@add an rc.shutdown(8) man page
@
text
@d1 1
a1 1
.\"	$OpenBSD$
d19 1
a19 1
Currently, the
d21 3
a23 2
script does nothing but save part of the entropy pool for reuse on reboot, but
extra commands may be added by the system administrator.
@

