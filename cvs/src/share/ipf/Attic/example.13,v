head	1.4;
access;
symbols
	OPENBSD_2_9:1.3.0.6
	OPENBSD_2_9_BASE:1.3
	OPENBSD_2_8:1.3.0.4
	OPENBSD_2_8_BASE:1.3
	OPENBSD_2_7:1.3.0.2
	OPENBSD_2_7_BASE:1.3
	OPENBSD_2_6:1.2.0.14
	OPENBSD_2_6_BASE:1.2
	OPENBSD_2_5:1.2.0.12
	OPENBSD_2_5_BASE:1.2
	OPENBSD_2_4:1.2.0.10
	OPENBSD_2_4_BASE:1.2
	OPENBSD_2_3:1.2.0.8
	OPENBSD_2_3_BASE:1.2
	OPENBSD_2_2:1.2.0.6
	OPENBSD_2_2_BASE:1.2
	OPENBSD_2_1:1.2.0.4
	OPENBSD_2_1_BASE:1.2
	OPENBSD_2_0:1.2.0.2
	OPENBSD_2_0_BASE:1.2;
locks; strict;
comment	@# @;


1.4
date	2001.05.30.02.12.00;	author deraadt;	state dead;
branches;
next	1.3;

1.3
date	2000.01.17.17.40.27;	author kjell;	state Exp;
branches;
next	1.2;

1.2
date	96.07.18.05.57.21;	author dm;	state Exp;
branches;
next	1.1;

1.1
date	96.01.09.09.29.39;	author dm;	state Exp;
branches;
next	;


desc
@@


1.4
log
@Remove ipf.  Darren Reed has interpreted his (old, new, whichever)
licence in a way that makes ipf not free according to the rules we
established over 5 years ago, at www.openbsd.org/goals.html (and those
same basic rules govern the other *BSD projects too).  Specifically,
Darren says that modified versions are not permitted.  But software
which OpenBSD uses and redistributes must be free to all (be they
people or companies), for any purpose they wish to use it, including
modification, use, peeing on, or even integration into baby mulching
machines or atomic bombs to be dropped on Australia.  Furthermore, we
know of a number of companies using ipf with modification like us, who
are now in the same situation, and we hope that some of them will work
with us to fill this gap that now exists in OpenBSD (temporarily, we
hope).
@
text
@#
# Log all short TCP packets to qe3, with 10.3.3.3 as the intended
# destination for the packet.
#
block in on qe0 to qe3:10.3.3.3 proto tcp all with short
#
# Log all connection attempts for TCP
#
pass in on le0 dup-to le1:10.3.3.3 proto tcp all flags S/SA
#
# Route all UDP packets through transparently.
#
pass in on ppp0 fastroute proto udp all
#
# Route all ICMP packets to network 10 out through le1, to 10.3.3.1
#
pass in on le0 to le1:10.3.3.1 proto icmp all
@


1.3
log
@Update the examples to those included with ipf 3.3.6. Add several new ones.
@
text
@@


1.2
log
@added my two firewall examples, plus the stuff from the distribution
@
text
@d2 1
a2 1
# Log all short TCP packets to qe3, with "packetlog" as the intended
d5 1
a5 1
block in to qe3:packetlog proto tcp all with short
d9 1
a9 1
pass in dup-to le0:packetlog proto tcp all flags S/SA
d13 1
a13 1
pass in fastroute proto udp all
d15 1
a15 1
# Route all ICMP packets to network 10 out through le1, to "router"
d17 1
a17 1
pass in to le1:router proto icmp all
@


1.1
log
@added IP filter to netstat/rc and put examples in /usr/share/ipf
@
text
@d2 2
a3 1
# log all inbound packet on le0 which has IP options present
d5 1
a5 1
log in on le0 from any to any with ipopts
d7 1
a7 4
# block any inbound packets on le0 which are fragmented and "too short" to
# do any meaningful comparison on.  This actually only applies to TCP
# packets which can be missing the flags/ports (depending on which part
# of the fragment you see).
d9 1
a9 1
block in log quick on le0 from any to any with short frag
d11 1
a11 4
# log all inbound TCP packets with the SYN flag (only) set
#  (NOTE: if it were an inbound TCP packet with the SYN flag set and it
#         had IP options present, this rule and the above would cause it
#         to be logged twice).
d13 1
a13 1
log in on le0 proto tcp from any to any flags S/SA
d15 1
a15 1
# block and log any inbound ICMP unreachables
d17 1
a17 40
block in log on le0 proto icmp from any to any icmp-type unreach
#
# block and log any inbound UDP packets on le0 which are going to port 2049
# (the NFS port).
#
block in log on le0 proto udp from any to any port = 2049
#
# quickly allow any packets to/from a particular pair of hosts
#
pass in quick from any to 10.1.3.2/32
pass in quick from any to 10.1.0.13/32
pass in quick from 10.1.3.2/32 to any
pass in quick from 10.1.0.13/32 to any
#
# block (and stop matching) any packet with IP options present.
#
block in quick on le0 from any to any with ipopts
#
# allow any packet through
#
pass in from any to any
#
# block any inbound UDP packets destined for these subnets.
#
block in on le0 proto udp from any to 10.1.3.0/24
block in on le0 proto udp from any to 10.1.1.0/24
block in on le0 proto udp from any to 10.1.2.0/24
#
# block any inbound TCP packets with only the SYN flag set that are
# destined for these subnets.
#
block in on le0 proto tcp from any to 10.1.3.0/24 flags S/SA
block in on le0 proto tcp from any to 10.1.2.0/24 flags S/SA
block in on le0 proto tcp from any to 10.1.1.0/24 flags S/SA
#
# block any inbound ICMP packets destined for these subnets.
#
block in on le0 proto icmp from any to 10.1.3.0/24
block in on le0 proto icmp from any to 10.1.1.0/24
block in on le0 proto icmp from any to 10.1.2.0/24
@
