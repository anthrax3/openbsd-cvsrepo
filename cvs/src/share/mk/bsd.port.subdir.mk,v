head	1.9;
access;
symbols
	OPENBSD_6_2:1.9.0.22
	OPENBSD_6_2_BASE:1.9
	OPENBSD_6_1:1.9.0.24
	OPENBSD_6_1_BASE:1.9
	OPENBSD_6_0:1.9.0.20
	OPENBSD_6_0_BASE:1.9
	OPENBSD_5_9:1.9.0.16
	OPENBSD_5_9_BASE:1.9
	OPENBSD_5_8:1.9.0.18
	OPENBSD_5_8_BASE:1.9
	OPENBSD_5_7:1.9.0.10
	OPENBSD_5_7_BASE:1.9
	OPENBSD_5_6:1.9.0.14
	OPENBSD_5_6_BASE:1.9
	OPENBSD_5_5:1.9.0.12
	OPENBSD_5_5_BASE:1.9
	OPENBSD_5_4:1.9.0.8
	OPENBSD_5_4_BASE:1.9
	OPENBSD_5_3:1.9.0.6
	OPENBSD_5_3_BASE:1.9
	OPENBSD_5_2:1.9.0.4
	OPENBSD_5_2_BASE:1.9
	OPENBSD_5_1_BASE:1.9
	OPENBSD_5_1:1.9.0.2
	OPENBSD_5_0:1.8.0.48
	OPENBSD_5_0_BASE:1.8
	OPENBSD_4_9:1.8.0.46
	OPENBSD_4_9_BASE:1.8
	OPENBSD_4_8:1.8.0.44
	OPENBSD_4_8_BASE:1.8
	OPENBSD_4_7:1.8.0.40
	OPENBSD_4_7_BASE:1.8
	OPENBSD_4_6:1.8.0.42
	OPENBSD_4_6_BASE:1.8
	OPENBSD_4_5:1.8.0.38
	OPENBSD_4_5_BASE:1.8
	OPENBSD_4_4:1.8.0.36
	OPENBSD_4_4_BASE:1.8
	OPENBSD_4_3:1.8.0.34
	OPENBSD_4_3_BASE:1.8
	OPENBSD_4_2:1.8.0.32
	OPENBSD_4_2_BASE:1.8
	OPENBSD_4_1:1.8.0.30
	OPENBSD_4_1_BASE:1.8
	OPENBSD_4_0:1.8.0.28
	OPENBSD_4_0_BASE:1.8
	OPENBSD_3_9:1.8.0.26
	OPENBSD_3_9_BASE:1.8
	OPENBSD_3_8:1.8.0.24
	OPENBSD_3_8_BASE:1.8
	OPENBSD_3_7:1.8.0.22
	OPENBSD_3_7_BASE:1.8
	OPENBSD_3_6:1.8.0.20
	OPENBSD_3_6_BASE:1.8
	OPENBSD_3_5:1.8.0.18
	OPENBSD_3_5_BASE:1.8
	OPENBSD_3_4:1.8.0.16
	OPENBSD_3_4_BASE:1.8
	OPENBSD_3_3:1.8.0.14
	OPENBSD_3_3_BASE:1.8
	OPENBSD_3_2:1.8.0.12
	OPENBSD_3_2_BASE:1.8
	OPENBSD_3_1:1.8.0.10
	OPENBSD_3_1_BASE:1.8
	OPENBSD_3_0:1.8.0.8
	OPENBSD_3_0_BASE:1.8
	OPENBSD_2_9:1.8.0.6
	OPENBSD_2_9_BASE:1.8
	OPENBSD_2_8:1.8.0.4
	OPENBSD_2_8_BASE:1.8
	OPENBSD_2_7:1.8.0.2
	OPENBSD_2_7_BASE:1.8
	OPENBSD_2_6:1.7.0.2
	OPENBSD_2_6_BASE:1.7
	OPENBSD_2_5:1.6.0.2
	OPENBSD_2_5_BASE:1.6
	OPENBSD_2_4:1.3.0.6
	OPENBSD_2_4_BASE:1.3
	OPENBSD_2_3:1.3.0.4
	OPENBSD_2_3_BASE:1.3
	OPENBSD_2_2:1.3.0.2
	OPENBSD_2_2_BASE:1.3
	OPENBSD_2_1:1.2.0.2
	OPENBSD_2_1_BASE:1.2
	OPENBSD_2_0:1.1.0.2
	OPENBSD_2_0_BASE:1.1;
locks; strict;
comment	@# @;


1.9
date	2011.09.24.07.26.01;	author espie;	state Exp;
branches;
next	1.8;

1.8
date	2000.03.31.18.43.25;	author espie;	state Exp;
branches;
next	1.7;

1.7
date	99.05.25.20.44.24;	author espie;	state Exp;
branches;
next	1.6;

1.6
date	99.04.02.06.55.56;	author marc;	state Exp;
branches;
next	1.5;

1.5
date	99.03.30.07.12.05;	author marc;	state Exp;
branches;
next	1.4;

1.4
date	98.12.16.19.26.31;	author marc;	state Exp;
branches;
next	1.3;

1.3
date	97.09.09.15.11.29;	author imp;	state Exp;
branches;
next	1.2;

1.2
date	96.10.22.14.01.20;	author niklas;	state Exp;
branches;
next	1.1;

1.1
date	96.06.03.22.47.11;	author niklas;	state Exp;
branches;
next	;


desc
@@


1.9
log
@create a new "bounce" file for ports infrastructure.
clean up ancient comments in the existing ones, and use bsd.own.mk's guard
against multiple includes.
@
text
@.if !defined(BSD_OWN_MK)
.  include <bsd.own.mk>
.endif
PORTSDIR?=	/usr/ports
.include	"${PORTSDIR}/infrastructure/mk/bsd.port.subdir.mk"
@


1.8
log
@include bsd.own.mk there (allows for PORTSDIR in /etc/mk.conf)

(This whole series of patches approved by millert@@, btw)
@
text
@d1 3
a3 1
.include <bsd.own.mk>
a5 2

# if you can't find this file, cvs update your ports tree as well.
@


1.7
log
@Stub out src/   ports makefile fragments, so that everything is under
ports/ (simpler to keep synchronized).
@
text
@d1 1
@


1.6
log
@add list-distfiles target to help me build/update the LICENSE file
@
text
@d1 2
a2 34
#	from: @@(#)bsd.subdir.mk	5.9 (Berkeley) 2/1/91
#	$OpenBSD: bsd.port.subdir.mk,v 1.5 1999/03/30 07:12:05 marc Exp $
#	FreeBSD Id: bsd.port.subdir.mk,v 1.20 1997/08/22 11:16:15 asami Exp
#
# The include file <bsd.port.subdir.mk> contains the default targets
# for building ports subdirectories. 
#
#
# +++ variables +++
#
# STRIP		The flag passed to the install program to cause the binary
#		to be stripped.  This is to be used when building your
#		own install script so that the entire system can be made
#		stripped/not-stripped using a single knob. [-s]
#
# ECHO_MSG	Used to print all the '===>' style prompts - override this
#		to turn them off [echo].
#
# OPSYS		Get the operating system type [`uname -s`]
#
# SUBDIR	A list of subdirectories that should be built as well.
#		Each of the targets will execute the same target in the
#		subdirectories.
#
#
# +++ targets +++
#
#	README.html:
#		Creating README.html for package.
#
#	afterinstall, all, beforeinstall, build, checksum, clean,
#	configure, depend, describe, extract, fetch, fetch-list,
#	install, package, readmes, realinstall, reinstall, tags
#
d4 1
a4 112

.MAIN: all

.if !defined(DEBUG_FLAGS)
STRIP?=	-s
.endif

.if !defined(OPSYS)	# XXX !!
OPSYS!=	uname -s
.endif

ECHO_MSG?=	echo

_SUBDIRUSE: .USE
	@@for entry in ${SUBDIR}; do \
		OK=""; \
		for dud in $$DUDS; do \
			if [ $${dud} = $${entry} ]; then \
				OK="false"; \
				${ECHO_MSG} "===> ${DIRPRFX}$${entry} skipped"; \
			fi; \
		done; \
		if test -d ${.CURDIR}/$${entry}.${MACHINE}; then \
			edir=$${entry}.${MACHINE}; \
		elif test -d ${.CURDIR}/$${entry}; then \
			edir=$${entry}; \
		else \
			OK="false"; \
			${ECHO_MSG} "===> ${DIRPRFX}$${entry} non-existent"; \
		fi; \
		if [ "$$OK" = "" ]; then \
			${ECHO_MSG} "===> ${DIRPRFX}$${edir}"; \
			cd ${.CURDIR}/$${edir}; \
			${MAKE} ${.TARGET:realinstall=install} \
				DIRPRFX=${DIRPRFX}$$edir/; \
		fi; \
	done

${SUBDIR}::
	@@if test -d ${.TARGET}.${MACHINE}; then \
		cd ${.CURDIR}/${.TARGET}.${MACHINE}; \
	else \
		cd ${.CURDIR}/${.TARGET}; \
	fi; \
	${MAKE} all

.for __target in all fetch fetch-list package extract configure \
		 build clean depend describe distclean reinstall \
		 tags checksum mirror-distfiles list-distfiles obj
.if !target(__target)
${__target}: _SUBDIRUSE
.endif
.endfor

.if !target(install)
.if !target(beforeinstall)
beforeinstall:
.endif
.if !target(afterinstall)
afterinstall:
.endif
install: afterinstall
afterinstall: realinstall
realinstall: beforeinstall _SUBDIRUSE
.endif

.if !target(readmes)
readmes: readme _SUBDIRUSE
.endif

.if !target(readme)
readme:
	@@rm -f README.html
	@@make README.html
.endif

.if (${OPSYS} == "NetBSD")
PORTSDIR ?= /usr/opt
.else
PORTSDIR ?= /usr/ports
.endif
TEMPLATES ?= ${PORTSDIR}/templates
.if defined(PORTSTOP)
README=	${TEMPLATES}/README.top
.else
README=	${TEMPLATES}/README.category
.endif

README.html:
	@@echo "===>  Creating README.html"
	@@> $@@.tmp
.for entry in ${SUBDIR}
.if defined(PORTSTOP)
	@@echo -n '<a href="'${entry}/README.html'">${entry}</a>: ' >> $@@.tmp
.else
	@@echo -n '<a href="'${entry}/README.html'">'"`cd ${entry}; make package-name`</a>: " >> $@@.tmp
.endif
.if exists(${entry}/pkg/COMMENT)
	@@cat ${entry}/pkg/COMMENT >> $@@.tmp
.else
	@@echo "(no description)" >> $@@.tmp
.endif
.endfor
	@@sort -t '>' +1 -2 $@@.tmp > $@@.tmp2
	@@cat ${README} | \
		sed -e 's%%CATEGORY%%'`echo ${.CURDIR} | sed -e 's.*/\([^/]*\)$$\1'`'g' \
			-e '/%%DESCR%%/r${.CURDIR}/pkg/DESCR' \
			-e '/%%DESCR%%/d' \
			-e '/%%SUBDIR%%/r$@@.tmp2' \
			-e '/%%SUBDIR%%/d' \
		> $@@
	@@rm -f $@@.tmp $@@.tmp2
@


1.5
log
@add obj target that works in conjuction with WRKOBJDIR;
code from op21@@squish.org
@
text
@d2 1
a2 1
#	$OpenBSD: bsd.port.subdir.mk,v 1.4 1998/12/16 19:26:31 marc Exp $
d84 1
a84 1
		 tags checksum mirror-distfiles obj
@


1.4
log
@add mirror-distfiles as a known target
@
text
@d2 1
a2 1
#	$OpenBSD: bsd.port.subdir.mk,v 1.3 1997/09/09 15:11:29 imp Exp $
d84 1
a84 1
		 tags checksum mirror-distfiles
@


1.3
log
@Merge 1.264 and 1.20 from FreeBSD's bsd.port.mk and bsd.port.subdir.mk respectively
@
text
@d2 1
a2 1
#	$OpenBSD: bsd.port.subdir.mk,v 1.1 1996/06/03 22:47:11 niklas Exp $
d83 2
a84 1
		 build clean depend describe distclean reinstall tags checksum
@


1.2
log
@Sync with FreeBSD
@
text
@d1 1
d3 33
a35 1
#	FreeBSD Id: bsd.port.subdir.mk,v 1.14 1996/04/09 22:54:13 wosch Exp $
d43 3
d58 8
d67 2
a68 9
			if test -d ${.CURDIR}/$${entry}.${MACHINE}; then \
				${ECHO_MSG} "===> ${DIRPRFX}$${entry}.${MACHINE}"; \
				edir=$${entry}.${MACHINE}; \
				cd ${.CURDIR}/$${edir}; \
			else \
				${ECHO_MSG} "===> ${DIRPRFX}$$entry"; \
				edir=$${entry}; \
				cd ${.CURDIR}/$${edir}; \
			fi; \
d83 1
a83 1
		 build clean depend describe reinstall tags checksum
d111 3
d115 1
@


1.1
log
@Initial import of "ports" mk-files from FreeBSD, probably needs work
@
text
@d1 2
a2 1
#	$OpenBSD: bsd.port.subdir.mk,v 1.14 1996/04/09 22:54:13 wosch Exp $
@
