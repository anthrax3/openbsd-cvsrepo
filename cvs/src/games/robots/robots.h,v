head	1.14;
access;
symbols
	OPENBSD_6_2:1.14.0.10
	OPENBSD_6_2_BASE:1.14
	OPENBSD_6_1:1.14.0.8
	OPENBSD_6_1_BASE:1.14
	OPENBSD_6_0:1.14.0.4
	OPENBSD_6_0_BASE:1.14
	OPENBSD_5_9:1.14.0.2
	OPENBSD_5_9_BASE:1.14
	OPENBSD_5_8:1.8.0.6
	OPENBSD_5_8_BASE:1.8
	OPENBSD_5_7:1.8.0.2
	OPENBSD_5_7_BASE:1.8
	OPENBSD_5_6:1.6.0.48
	OPENBSD_5_6_BASE:1.6
	OPENBSD_5_5:1.6.0.46
	OPENBSD_5_5_BASE:1.6
	OPENBSD_5_4:1.6.0.42
	OPENBSD_5_4_BASE:1.6
	OPENBSD_5_3:1.6.0.40
	OPENBSD_5_3_BASE:1.6
	OPENBSD_5_2:1.6.0.38
	OPENBSD_5_2_BASE:1.6
	OPENBSD_5_1_BASE:1.6
	OPENBSD_5_1:1.6.0.36
	OPENBSD_5_0:1.6.0.34
	OPENBSD_5_0_BASE:1.6
	OPENBSD_4_9:1.6.0.32
	OPENBSD_4_9_BASE:1.6
	OPENBSD_4_8:1.6.0.30
	OPENBSD_4_8_BASE:1.6
	OPENBSD_4_7:1.6.0.26
	OPENBSD_4_7_BASE:1.6
	OPENBSD_4_6:1.6.0.28
	OPENBSD_4_6_BASE:1.6
	OPENBSD_4_5:1.6.0.24
	OPENBSD_4_5_BASE:1.6
	OPENBSD_4_4:1.6.0.22
	OPENBSD_4_4_BASE:1.6
	OPENBSD_4_3:1.6.0.20
	OPENBSD_4_3_BASE:1.6
	OPENBSD_4_2:1.6.0.18
	OPENBSD_4_2_BASE:1.6
	OPENBSD_4_1:1.6.0.16
	OPENBSD_4_1_BASE:1.6
	OPENBSD_4_0:1.6.0.14
	OPENBSD_4_0_BASE:1.6
	OPENBSD_3_9:1.6.0.12
	OPENBSD_3_9_BASE:1.6
	OPENBSD_3_8:1.6.0.10
	OPENBSD_3_8_BASE:1.6
	OPENBSD_3_7:1.6.0.8
	OPENBSD_3_7_BASE:1.6
	OPENBSD_3_6:1.6.0.6
	OPENBSD_3_6_BASE:1.6
	OPENBSD_3_5:1.6.0.4
	OPENBSD_3_5_BASE:1.6
	OPENBSD_3_4:1.6.0.2
	OPENBSD_3_4_BASE:1.6
	OPENBSD_3_3:1.5.0.6
	OPENBSD_3_3_BASE:1.5
	OPENBSD_3_2:1.5.0.4
	OPENBSD_3_2_BASE:1.5
	OPENBSD_3_1:1.5.0.2
	OPENBSD_3_1_BASE:1.5
	OPENBSD_3_0:1.4.0.8
	OPENBSD_3_0_BASE:1.4
	OPENBSD_2_9:1.4.0.6
	OPENBSD_2_9_BASE:1.4
	OPENBSD_2_8:1.4.0.4
	OPENBSD_2_8_BASE:1.4
	OPENBSD_2_7:1.4.0.2
	OPENBSD_2_7_BASE:1.4
	OPENBSD_2_6:1.3.0.6
	OPENBSD_2_6_BASE:1.3
	OPENBSD_2_5:1.3.0.4
	OPENBSD_2_5_BASE:1.3
	OPENBSD_2_4:1.3.0.2
	OPENBSD_2_4_BASE:1.3
	OPENBSD_2_3:1.1.1.1.0.8
	OPENBSD_2_3_BASE:1.1.1.1
	OPENBSD_2_2:1.1.1.1.0.6
	OPENBSD_2_2_BASE:1.1.1.1
	OPENBSD_2_1:1.1.1.1.0.4
	OPENBSD_2_1_BASE:1.1.1.1
	OPENBSD_2_0:1.1.1.1.0.2
	OPENBSD_2_0_BASE:1.1.1.1
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@ * @;


1.14
date	2016.01.04.17.33.24;	author mestre;	state Exp;
branches;
next	1.13;
commitid	b21xvsfCGMtCOVrz;

1.13
date	2015.12.26.00.26.39;	author mestre;	state Exp;
branches;
next	1.12;
commitid	NcBz9zfScw6TwPoT;

1.12
date	2015.12.25.20.59.09;	author mestre;	state Exp;
branches;
next	1.11;
commitid	5J5Os05YMVA0ZKC5;

1.11
date	2015.12.04.16.40.09;	author tb;	state Exp;
branches;
next	1.10;
commitid	tL2RUU4SGRJ3N3qd;

1.10
date	2015.11.29.15.13.19;	author tb;	state Exp;
branches;
next	1.9;
commitid	GuIaxansCepwBVFg;

1.9
date	2015.08.26.00.29.24;	author rzalamena;	state Exp;
branches;
next	1.8;
commitid	vzOZPbMh8g7a1MuE;

1.8
date	2014.11.16.04.49.48;	author guenther;	state Exp;
branches;
next	1.7;
commitid	8XNajyb9IqHkZEKg;

1.7
date	2014.11.03.22.14.54;	author deraadt;	state Exp;
branches;
next	1.6;
commitid	as6i62fI9q0ursQL;

1.6
date	2003.06.03.03.01.41;	author millert;	state Exp;
branches;
next	1.5;

1.5
date	2002.02.16.21.27.11;	author millert;	state Exp;
branches;
next	1.4;

1.4
date	99.12.18.11.18.13;	author pjanzen;	state Exp;
branches;
next	1.3;

1.3
date	98.08.22.08.56.00;	author pjanzen;	state Exp;
branches;
next	1.2;

1.2
date	98.07.09.04.34.24;	author pjanzen;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.49.17;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.49.17;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.14
log
@More cleanup and sorting on header section

OK tb@@ and he also pointed out that for consistency with rest of the tree we
should include termios.h instead of sys/ttydefaults.h, where applicable
@
text
@/*	$OpenBSD: robots.h,v 1.13 2015/12/26 00:26:39 mestre Exp $	*/
/*	$NetBSD: robots.h,v 1.5 1995/04/24 12:24:54 cgd Exp $	*/

/*
 * Copyright (c) 1980, 1993
 *	The Regents of the University of California.  All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. Neither the name of the University nor the names of its contributors
 *    may be used to endorse or promote products derived from this software
 *    without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 *
 *	@@(#)robots.h	8.1 (Berkeley) 5/31/93
 */

#include <curses.h>
#include <limits.h>

/*
 * miscellaneous constants
 */

#define	Y_FIELDSIZE	23
#define	X_FIELDSIZE	60
#define	Y_SIZE		24
#define	X_SIZE		80
#define	MAXLEVELS	4
#define	MAXROBOTS	(MAXLEVELS * 10)
#define	ROB_SCORE	10
#define	S_BONUS		(60 * ROB_SCORE)
#define	Y_SCORE		21
#define	X_SCORE		(X_FIELDSIZE + 9)
#define	Y_PROMPT	(Y_FIELDSIZE - 1)
#define	X_PROMPT	(X_FIELDSIZE + 2)
#define	MAXSCORES	(Y_SIZE - 2)

/*
 * characters on screen
 */

#define	ROBOT	'+'
#define	HEAP	'*'
#define	PLAYER	'@@'

/*
 * type definitions
 */

typedef struct {
	int	y, x;
} COORD;

typedef struct {
	uid_t	s_uid;
	int	s_score;
	char	s_name[LOGIN_NAME_MAX];
} SCORE;

/*
 * global variables
 */

extern bool	Dead, Full_clear, Jump, Newscore, Real_time, Running,
		Teleport, Waiting, Was_bonus;

#ifdef	FANCY
extern bool	Pattern_roll, Stand_still;
#endif

extern char	Cnt_move, Field[Y_FIELDSIZE][X_FIELDSIZE], *Next_move,
		*Move_list, Run_ch;

extern int	Count, Level, Num_robots, Num_scores, Score,
		Start_level, Wait_bonus;

extern struct timespec	tv;

extern COORD	Max, Min, My_pos, Robots[];


/*
 * functions types
 */

void	add_score(int);
bool	another(void);
int	cmp_sc(const void *, const void *);
bool	do_move(int, int);
bool	eaten(COORD *);
void	get_move(void);
void	init_field(void);
bool	jumping(void);
void	make_level(void);
void	move_robots(void);
bool	must_telep(void);
void	play_level(void);
int	query(char *);
__dead void	quit(int);
void	reset_count(void);
int	rnd(int);
COORD	*rnd_pos(void);
void	score(int);
void	set_name(SCORE *);
void	show_score(void);
int	sign(int);
__dead void	usage(void);
@


1.13
log
@Set as __dead a few more functions, that don't return, on games/

With precious tip, help and also OK from tb@@
@
text
@d1 1
a1 1
/*	$OpenBSD: robots.h,v 1.12 2015/12/25 20:59:09 mestre Exp $	*/
d35 2
a36 14
#include	<sys/types.h>
#include	<sys/time.h>
#include	<ctype.h>
#include	<curses.h>
#include	<err.h>
#include	<errno.h>
#include	<fcntl.h>
#include	<limits.h>
#include	<signal.h>
#include	<string.h>
#include	<stdlib.h>
#include	<termios.h>
#include	<unistd.h>
#include	<poll.h>
@


1.12
log
@Declare usage() functions as __dead void, if they don't return, on games section.

Found another one in arithmetic(6) which also didn't return, and removed a function from number(6) which is not used anymore.

OK tb@@
@
text
@d1 1
a1 1
/*	$OpenBSD: robots.h,v 1.11 2015/12/04 16:40:09 tb Exp $	*/
d129 1
a129 1
void	quit(int);
@


1.11
log
@Drop pledge("getpw") and pwd.h and use the now usual
LOGNAME -> USER -> getlogin() -> ??? fallback
in the score file, as requested by tedu@@

Man page bits adapted from jmc@@'s tweaks to snake.6
@
text
@d1 1
a1 1
/*	$OpenBSD: robots.h,v 1.10 2015/11/29 15:13:19 tb Exp $	*/
d137 1
a137 1
void	usage(void);
@


1.10
log
@Move scorefile to $HOME.  The nice implementation of the score file
depends on getpwuid(), so add "getpw" to the rest of the required
pledges: "stdio rpath wpath cpath tty".
@
text
@d1 1
a1 1
/*	$OpenBSD: robots.h,v 1.9 2015/08/26 00:29:24 rzalamena Exp $	*/
a42 1
#include	<pwd.h>
@


1.9
log
@Improve robots(6) by using timespec*() functions, replacing gettimeofday()
with clock_gettime(MONOTONIC) to avoid clock changes and replacing poll()
with ppoll() to deal better with timespec.

ok guenther@@.
@
text
@d1 1
a1 1
/*	$OpenBSD: robots.h,v 1.8 2014/11/16 04:49:48 guenther Exp $	*/
a89 2

typedef struct passwd	PASSWD;
@


1.8
log
@Eliminate pointless use of <sys/param.h>, <sys/file.h>, <sys/sockio.h>,
    and <sys/ttydefaults.h>
Replace MAXPATHLEN with PATH_MAX and MAXLOGNAME with LOGIN_NAME_MAX
Pull in <limits.h> where needed
Prefer sizeof(var) over MAXFOO or FOO_MAX

ok deraadt@@
@
text
@d1 1
a1 1
/*	$OpenBSD: robots.h,v 1.7 2014/11/03 22:14:54 deraadt Exp $	*/
d110 1
a110 1
extern struct timeval	tv;
@


1.7
log
@select() to poll() conversions
ok tedu (... other games maintainer absent)
@
text
@d1 1
a1 1
/*	$OpenBSD: robots.h,v 1.6 2003/06/03 03:01:41 millert Exp $	*/
a34 1
#include	<sys/param.h>
d42 1
d88 1
a88 1
	char	s_name[MAXLOGNAME];
@


1.6
log
@Remove the advertising clause in the UCB license which Berkeley
rescinded 22 July 1999.  Proofed by myself and Theo.
@
text
@d1 1
a1 1
/*	$OpenBSD: robots.h,v 1.5 2002/02/16 21:27:11 millert Exp $	*/
d49 1
a109 1
extern fd_set	rset;
@


1.5
log
@Part one of userland __P removal.  Done with a simple regexp with some minor hand editing to make comments line up correctly.  Another pass is forthcoming that handles the cases that could not be done automatically.
@
text
@d1 1
a1 1
/*	$OpenBSD: robots.h,v 1.4 1999/12/18 11:18:13 pjanzen Exp $	*/
d16 1
a16 5
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 *	This product includes software developed by the University of
 *	California, Berkeley and its contributors.
 * 4. Neither the name of the University nor the names of its contributors
@


1.4
log
@Enable realtime mode, use native curses functions when available, tidy man
page, and use MAXLOGNAME for scorefile (this makes new scorefiles incompatible
with old ones).  Realtime idea and some code from d@@.
@
text
@d1 1
a1 1
/*	$OpenBSD: robots.h,v 1.3 1998/08/22 08:56:00 pjanzen Exp $	*/
d123 22
a144 22
void	add_score __P((int));
bool	another __P((void));
int	cmp_sc __P((const void *, const void *));
bool	do_move __P((int, int));
bool	eaten __P((COORD *));
void	get_move __P((void));
void	init_field __P((void));
bool	jumping __P((void));
void	make_level __P((void));
void	move_robots __P((void));
bool	must_telep __P((void));
void	play_level __P((void));
int	query __P((char *));
void	quit __P((int));
void	reset_count __P((void));
int	rnd __P((int));
COORD	*rnd_pos __P((void));
void	score __P((int));
void	set_name __P((SCORE *));
void	show_score __P((void));
int	sign __P((int));
void	usage __P((void));
@


1.3
log
@More largely NetBSD-inspired code cleanup
@
text
@d1 1
a1 1
/*	$OpenBSD: robots.h,v 1.2 1998/07/09 04:34:24 pjanzen Exp $	*/
d39 1
a39 1
#include	<sys/ttydefaults.h>
d41 1
a47 1
#include	<setjmp.h>
a70 2
#define	MAXNAME		16
#define	MS_NAME		"Ten"
d91 1
a91 1
	char	s_name[MAXNAME];
d113 3
a117 1
extern jmp_buf	End_move;
a127 1
void	flush_in __P((void));
d132 1
a132 1
void	move_robots __P((int));
d144 1
@


1.2
log
@Scorefile bugfix and minor code cleaning, some from NetBSD
@
text
@d1 1
a1 1
/*	$OpenBSD$	*/
d131 1
a131 1
bool jumping __P((void));
@


1.1
log
@Initial revision
@
text
@d1 1
d39 14
a52 3
# include	<curses.h>
# include	<setjmp.h>
# include	<string.h>
d58 15
a72 15
# define	Y_FIELDSIZE	23
# define	X_FIELDSIZE	60
# define	Y_SIZE		24
# define	X_SIZE		80
# define	MAXLEVELS	4
# define	MAXROBOTS	(MAXLEVELS * 10)
# define	ROB_SCORE	10
# define	S_BONUS		(60 * ROB_SCORE)
# define	Y_SCORE		21
# define	X_SCORE		(X_FIELDSIZE + 9)
# define	Y_PROMPT	(Y_FIELDSIZE - 1)
# define	X_PROMPT	(X_FIELDSIZE + 2)
# define	MAXSCORES	(Y_SIZE - 2)
# define	MAXNAME		16
# define	MS_NAME		"Ten"
d78 3
a80 3
# define	ROBOT	'+'
# define	HEAP	'*'
# define	PLAYER	'@@'
d90 8
d123 22
a144 8
int	cmp_sc();
void	move_robots();

COORD	*rnd_pos();




@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
