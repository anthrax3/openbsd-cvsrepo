head	1.64;
access;
symbols
	OPENBSD_6_0:1.61.0.2
	OPENBSD_6_0_BASE:1.61
	OPENBSD_5_9:1.60.0.2
	OPENBSD_5_9_BASE:1.60
	OPENBSD_5_8:1.56.0.8
	OPENBSD_5_8_BASE:1.56
	OPENBSD_5_7:1.56.0.2
	OPENBSD_5_7_BASE:1.56
	OPENBSD_5_6:1.56.0.4
	OPENBSD_5_6_BASE:1.56
	OPENBSD_5_5:1.54.0.4
	OPENBSD_5_5_BASE:1.54
	OPENBSD_5_4:1.53.0.10
	OPENBSD_5_4_BASE:1.53
	OPENBSD_5_3:1.53.0.8
	OPENBSD_5_3_BASE:1.53
	OPENBSD_5_2:1.53.0.6
	OPENBSD_5_2_BASE:1.53
	OPENBSD_5_1_BASE:1.53
	OPENBSD_5_1:1.53.0.4
	OPENBSD_5_0:1.53.0.2
	OPENBSD_5_0_BASE:1.53
	OPENBSD_4_9:1.51.0.4
	OPENBSD_4_9_BASE:1.51
	OPENBSD_4_8:1.51.0.2
	OPENBSD_4_8_BASE:1.51
	OPENBSD_4_7:1.50.0.2
	OPENBSD_4_7_BASE:1.50
	OPENBSD_4_6:1.50.0.4
	OPENBSD_4_6_BASE:1.50
	OPENBSD_4_5:1.49.0.2
	OPENBSD_4_5_BASE:1.49
	OPENBSD_4_4:1.48.0.2
	OPENBSD_4_4_BASE:1.48
	OPENBSD_4_3:1.47.0.4
	OPENBSD_4_3_BASE:1.47
	OPENBSD_4_2:1.47.0.2
	OPENBSD_4_2_BASE:1.47
	OPENBSD_4_1:1.42.0.2
	OPENBSD_4_1_BASE:1.42
	OPENBSD_4_0:1.41.0.2
	OPENBSD_4_0_BASE:1.41
	OPENBSD_3_9:1.39.0.4
	OPENBSD_3_9_BASE:1.39
	OPENBSD_3_8:1.39.0.2
	OPENBSD_3_8_BASE:1.39
	OPENBSD_3_7:1.37.0.2
	OPENBSD_3_7_BASE:1.37
	OPENBSD_3_6:1.33.0.2
	OPENBSD_3_6_BASE:1.33
	OPENBSD_3_5:1.32.0.2
	OPENBSD_3_5_BASE:1.32
	OPENBSD_3_4:1.29.0.6
	OPENBSD_3_4_BASE:1.29
	OPENBSD_3_3:1.29.0.4
	OPENBSD_3_3_BASE:1.29
	OPENBSD_3_2:1.29.0.2
	OPENBSD_3_2_BASE:1.29
	OPENBSD_3_1:1.27.0.2
	OPENBSD_3_1_BASE:1.27
	OPENBSD_3_0:1.26.0.2
	OPENBSD_3_0_BASE:1.26
	OPENBSD_2_9:1.25.0.2
	OPENBSD_2_9_BASE:1.25
	OPENBSD_2_8:1.21.0.6
	OPENBSD_2_8_BASE:1.21
	OPENBSD_2_7:1.21.0.4
	OPENBSD_2_7_BASE:1.21
	OPENBSD_2_6:1.21.0.2
	OPENBSD_2_6_BASE:1.21
	OPENBSD_2_5:1.20.0.2
	OPENBSD_2_5_BASE:1.20
	OPENBSD_2_4:1.19.0.2
	OPENBSD_2_4_BASE:1.19
	OPENBSD_2_3:1.16.0.4
	OPENBSD_2_3_BASE:1.16
	OPENBSD_2_2:1.16.0.2
	OPENBSD_2_2_BASE:1.16
	OPENBSD_2_1:1.8.0.2
	OPENBSD_2_1_BASE:1.8
	OPENBSD_2_0:1.7.0.2
	OPENBSD_2_0_BASE:1.7
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@# @;


1.64
date	2016.09.21.20.12.27;	author fcambus;	state Exp;
branches;
next	1.63;
commitid	ls7edYALXopdvRiH;

1.63
date	2016.09.01.09.46.42;	author tedu;	state Exp;
branches;
next	1.62;
commitid	2IuVNKwpZd3jQtHH;

1.62
date	2016.08.10.14.27.16;	author deraadt;	state Exp;
branches;
next	1.61;
commitid	nJ2GKPOeS3xtih2N;

1.61
date	2016.03.09.16.28.47;	author deraadt;	state Exp;
branches;
next	1.60;
commitid	OSDG2O3Cgeifnf1W;

1.60
date	2015.12.01.08.13.30;	author deraadt;	state Exp;
branches;
next	1.59;
commitid	pJfT5kYsmeGT25jh;

1.59
date	2015.10.15.19.31.15;	author miod;	state Exp;
branches;
next	1.58;
commitid	cIMgSVEQ53BJoP4V;

1.58
date	2015.10.05.04.43.03;	author miod;	state Exp;
branches;
next	1.57;
commitid	1JeHEEtiqibcet7M;

1.57
date	2015.09.24.19.36.10;	author krw;	state Exp;
branches;
next	1.56;
commitid	sVI0A00UH4gO2uHX;

1.56
date	2014.04.13.15.29.21;	author schwarze;	state Exp;
branches;
next	1.55;

1.55
date	2014.03.18.22.36.30;	author miod;	state Exp;
branches;
next	1.54;

1.54
date	2013.10.31.22.37.17;	author schwarze;	state Exp;
branches;
next	1.53;

1.53
date	2011.06.23.22.46.12;	author schwarze;	state Exp;
branches;
next	1.52;

1.52
date	2011.05.24.15.27.56;	author otto;	state Exp;
branches;
next	1.51;

1.51
date	2010.03.18.12.27.13;	author otto;	state Exp;
branches;
next	1.50;

1.50
date	2009.06.04.21.13.03;	author deraadt;	state Exp;
branches;
next	1.49;

1.49
date	2009.01.11.19.44.57;	author miod;	state Exp;
branches;
next	1.48;

1.48
date	2008.05.13.21.14.15;	author miod;	state Exp;
branches;
next	1.47;

1.47
date	2007.08.01.21.34.01;	author deraadt;	state Exp;
branches;
next	1.46;

1.46
date	2007.06.18.07.37.24;	author deraadt;	state Exp;
branches;
next	1.45;

1.45
date	2007.06.17.00.32.21;	author deraadt;	state Exp;
branches;
next	1.44;

1.44
date	2007.06.16.17.32.13;	author deraadt;	state Exp;
branches;
next	1.43;

1.43
date	2007.06.16.17.24.04;	author deraadt;	state Exp;
branches;
next	1.42;

1.42
date	2006.10.12.04.37.38;	author drahn;	state Exp;
branches;
next	1.41;

1.41
date	2006.07.11.19.03.27;	author miod;	state Exp;
branches;
next	1.40;

1.40
date	2006.04.26.17.09.34;	author deraadt;	state Exp;
branches;
next	1.39;

1.39
date	2005.08.30.05.02.40;	author uwe;	state Exp;
branches;
next	1.38;

1.38
date	2005.04.01.16.00.09;	author deraadt;	state Exp;
branches;
next	1.37;

1.37
date	2005.02.16.20.39.37;	author millert;	state Exp;
branches;
next	1.36;

1.36
date	2005.01.13.19.32.01;	author deraadt;	state Exp;
branches;
next	1.35;

1.35
date	2004.11.06.20.03.08;	author otto;	state Exp;
branches;
next	1.34;

1.34
date	2004.11.06.18.57.59;	author otto;	state Exp;
branches;
next	1.33;

1.33
date	2004.05.03.15.18.19;	author drahn;	state Exp;
branches;
next	1.32;

1.32
date	2004.02.25.05.09.11;	author deraadt;	state Exp;
branches;
next	1.31;

1.31
date	2004.01.28.17.45.22;	author deraadt;	state Exp;
branches;
next	1.30;

1.30
date	2003.10.31.04.05.29;	author drahn;	state Exp;
branches;
next	1.29;

1.29
date	2002.08.08.00.35.50;	author mickey;	state Exp;
branches;
next	1.28;

1.28
date	2002.06.26.18.34.27;	author wcobb;	state Exp;
branches;
next	1.27;

1.27
date	2002.02.20.01.55.49;	author miod;	state Exp;
branches;
next	1.26;

1.26
date	2001.09.01.16.21.16;	author drahn;	state Exp;
branches;
next	1.25;

1.25
date	2001.04.05.17.03.37;	author deraadt;	state Exp;
branches;
next	1.24;

1.24
date	2001.02.05.10.16.18;	author art;	state Exp;
branches;
next	1.23;

1.23
date	2001.01.18.15.05.20;	author art;	state Exp;
branches;
next	1.22;

1.22
date	2001.01.17.04.23.45;	author d;	state Exp;
branches;
next	1.21;

1.21
date	99.07.14.23.16.26;	author deraadt;	state Exp;
branches;
next	1.20;

1.20
date	99.02.01.16.43.20;	author pefo;	state Exp;
branches;
next	1.19;

1.19
date	98.05.16.17.33.31;	author deraadt;	state Exp;
branches;
next	1.18;

1.18
date	98.05.07.06.27.32;	author millert;	state Exp;
branches;
next	1.17;

1.17
date	98.04.25.07.04.45;	author deraadt;	state Exp;
branches;
next	1.16;

1.16
date	97.10.24.02.44.07;	author millert;	state Exp;
branches;
next	1.15;

1.15
date	97.10.16.10.54.27;	author deraadt;	state Exp;
branches;
next	1.14;

1.14
date	97.10.16.10.42.45;	author deraadt;	state Exp;
branches;
next	1.13;

1.13
date	97.10.16.10.40.09;	author deraadt;	state Exp;
branches;
next	1.12;

1.12
date	97.10.13.15.02.14;	author pefo;	state Exp;
branches;
next	1.11;

1.11
date	97.09.30.17.54.16;	author millert;	state Exp;
branches;
next	1.10;

1.10
date	97.09.21.11.36.12;	author deraadt;	state Exp;
branches;
next	1.9;

1.9
date	97.09.03.22.39.11;	author mickey;	state Exp;
branches;
next	1.8;

1.8
date	97.04.20.08.59.36;	author deraadt;	state Exp;
branches;
next	1.7;

1.7
date	96.09.24.04.35.17;	author deraadt;	state Exp;
branches;
next	1.6;

1.6
date	96.09.20.08.25.01;	author deraadt;	state Exp;
branches;
next	1.5;

1.5
date	96.06.17.06.57.05;	author downsj;	state Exp;
branches;
next	1.4;

1.4
date	96.06.12.08.02.43;	author downsj;	state Exp;
branches;
next	1.3;

1.3
date	96.05.16.11.08.53;	author pefo;	state Exp;
branches;
next	1.2;

1.2
date	95.12.14.05.39.09;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.43.27;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.43.27;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.64
log
@Remove reference to zaurus

OK sthen@@
@
text
@#	$OpenBSD: Makefile,v 1.63 2016/09/01 09:46:42 tedu Exp $

PROG=	disklabel
SRCS=	disklabel.c dkcksum.c editor.c manual.c
DPADD=	${LIBUTIL}
LDADD=	-lutil
MAN=	disklabel.8 disklabel.5

CLEANFILES += disklabel.cat8 manual.c

.include <bsd.own.mk>

.ifdef NOMAN
manual.c:
	(echo 'const unsigned char manpage[] = {'; \
	echo 'no manual' | gzip -9c | hexdump -ve '"0x" 1/1 "%02x,"'; \
	echo '};'; echo 'const int manpage_sz = sizeof(manpage);') > manual.c
.else
disklabel.cat8:	disklabel.8
	mandoc -Tascii ${.ALLSRC} > ${.TARGET}

manual.c:	disklabel.cat8
	(echo 'const unsigned char manpage[] = {'; \
	cat disklabel.cat8 | gzip -9c | hexdump -ve '"0x" 1/1 "%02x,"'; \
	echo '};'; echo 'const int manpage_sz = sizeof(manpage);') > manual.c
.endif

.if (${MACHINE} == "alpha")
CFLAGS+= -DSEEALSO="\"fdisk(8), installboot(8)\""
.endif

.if (${MACHINE} == "amd64") || (${MACHINE} == "i386")
CFLAGS+= -DSEEALSO="\"fdisk(8), installboot(8)\""
.endif

.if (${MACHINE} == "armv7") || (${MACHINE} == "loongson")
CFLAGS+= -DSEEALSO="\"fdisk(8)\""
.endif

.if (${MACHINE} == "landisk")
CFLAGS+= -DSEEALSO="\"fdisk(8), installboot(8)\""
.endif

.if (${MACHINE} == "macppc" || ${MACHINE} == "socppc")
CFLAGS+= -DSEEALSO="\"fdisk(8), pdisk(8)\""
.endif

.if (${MACHINE} == "sparc64")
CFLAGS+= -DSEEALSO="\"installboot(8)\"" -DSUN_CYLCHECK -DSUN_AAT0
.endif

.ifdef NOPIC
CFLAGS+= -DSTATICLINKING
.endif

.include <bsd.prog.mk>
@


1.63
log
@remove references to sparc
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.62 2016/08/10 14:27:16 deraadt Exp $
a49 4
.endif

.if (${MACHINE} == "zaurus")
CFLAGS+= -DSEEALSO="\"fdisk(8)\""
@


1.62
log
@armish handled some early-gen arm machines, which required tons of
workarounds.  Some of them will soon stand in the way of armv7.
Off to the attic you go.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.61 2016/03/09 16:28:47 deraadt Exp $
d48 1
a48 1
.if (${MACHINE} == "sparc") || (${MACHINE} == "sparc64")
@


1.61
log
@We are done providing support for the vax.
lots of agreement.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.60 2015/12/01 08:13:30 deraadt Exp $
d36 1
a36 1
.if (${MACHINE} == "armish") || (${MACHINE} == "loongson")
@


1.60
log
@Send solbourne to where the ...........
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.59 2015/10/15 19:31:15 miod Exp $
a37 4
.endif

.if (${MACHINE} == "vax")
CFLAGS+= -DSEEALSO="\"installboot(8)\""
@


1.59
log
@Remove disklabel -B (NUMBOOT) support. All the platforms which used to need
it are now using MI installboot for that purpose.

ok krw@@ deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.58 2015/10/05 04:43:03 miod Exp $
d52 1
a52 2
.if (${MACHINE} == "solbourne") || (${MACHINE} == "sparc") || \
    (${MACHINE} == "sparc64")
@


1.58
log
@Remove disklabel -B support on landisk - superseded by MI installboot.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.57 2015/09/24 19:36:10 krw Exp $
d41 1
a41 1
CFLAGS+= -DNUMBOOT=1
@


1.57
log
@hppa/hppa64 use installboot(8) now, not -B/-b.

Only vax and landisk left using -B/-b.

ok jsing@@ miod@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.56 2014/04/13 15:29:21 schwarze Exp $
d45 1
a45 2
CFLAGS+= -DNUMBOOT=1
CFLAGS+= -DSEEALSO="\"fdisk(8)\""
@


1.56
log
@At some point, we are going to switch the mandoc(1) default
from -Tascii to -Tlocale, even though not quite yet because
there are more important things to do first.
But let's already make -Tascii explicit in the build system
right now, it is safer anyway.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.55 2014/03/18 22:36:30 miod Exp $
d40 1
a40 1
.if (${MACHINE} == "hppa") || (${MACHINE} == "hppa64") || (${MACHINE} == "vax")
@


1.55
log
@Retire hp300, mvme68k and mvme88k ports. These ports have no users, keeping
this hardware alive is becoming increasingly difficult, and I should heed the
message sent by the three disks which have died on me over the last few days.

Noone sane will mourn these ports anyway. So long, and thanks for the fish.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.54 2013/10/31 22:37:17 schwarze Exp $
d20 1
a20 1
	mandoc ${.ALLSRC} > ${.TARGET}
@


1.54
log
@List all generated files in CLEANFILES.
Issue mentioned by fgs@@ on ICB.
ok fgs@@ bluhm@@ krw@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.53 2011/06/23 22:46:12 schwarze Exp $
d40 1
a40 2
.if (${MACHINE} == "hp300") || (${MACHINE} == "hppa") || \
    (${MACHINE} == "hppa64") || (${MACHINE} == "vax")
a50 4
.endif

.if (${MACHINE} == "mvme68k") || (${MACHINE} == "mvme88k")
CFLAGS+= -DSEEALSO="\"installboot(8)\""
@


1.53
log
@switch to installing source manuals (base part)
discussed with lots of people, tested by naddy@@,
"move fast" deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.52 2011/05/24 15:27:56 otto Exp $
d9 1
a9 2

CLEANFILES+=manual.c
@


1.52
log
@Allow for more room for /usr/obj on static linking only archs; ok krw@@ deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.51 2010/03/18 12:27:13 otto Exp $
d20 3
@


1.51
log
@loongson needs fdisk in -DSEEALSO
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.50 2009/06/04 21:13:03 deraadt Exp $
d63 4
@


1.50
log
@Recycle four ancient fields in the disklabel structure, replacing them with
bounds information, ie. the zone of the disk that OpenBSD can use.  Have each
pre-disklabel parser (MBR, DPME, or per-arch MD disklabel parsers) figure out
this area and pass it up to userland.  Then, delete all the same disk parsing
code from disklabel(8) since the kernel passes it up.  Lots and lots of - signs
in the disklabel(8) code.
Tested on as many platforms as possible, the fallout will be repaired as time
goes on.  To test, use disklabel -d <drive> and validate that the bounds do not
overlap any boot blocks.  This same information is used by disklabel -A...
OK for the concept from krw, miod, and drahn
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.49 2009/01/11 19:44:57 miod Exp $
d34 1
a34 1
.if (${MACHINE} == "armish")
@


1.49
log
@On *ppc disks shared with MacOS, walk the Apple partition map to find out
the bounds of the OpenBSD area. Should prevent users from shooting themselves
in the feet.

ok krw@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.48 2008/05/13 21:14:15 miod Exp $
a30 1
CFLAGS+= -DDOSLABEL
a34 1
CFLAGS+= -DDOSLABEL
d44 1
a44 1
CFLAGS+= -DNUMBOOT=1 -DDOSLABEL
a48 1
CFLAGS+= -DDOSLABEL -DDPMELABEL
a61 1
CFLAGS+= -DDOSLABEL
@


1.48
log
@Make socppc on par with macppc for now.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.47 2007/08/01 21:34:01 deraadt Exp $
d51 2
a52 2
CFLAGS+= -DDOSLABEL
CFLAGS+= -DSEEALSO="\"fdisk(8)\""
@


1.47
log
@cats went away
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.46 2007/06/18 07:37:24 deraadt Exp $
d50 1
a50 1
.if (${MACHINE} == "macppc")
@


1.46
log
@typo
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.45 2007/06/17 00:32:21 deraadt Exp $
d35 1
a35 1
.if (${MACHINE} == "armish") || (${MACHINE} == "cats")
@


1.45
log
@On Sun machines, disklabels coming from the kernel will now have a d_flags
bit D_VENDOR if they face the Sun cylinder / start-at-zero semantics.  Other
disklabels found on these architectures do not have these issues, and do
not need to be constrained.  checked by otto
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.44 2007/06/16 17:32:13 deraadt Exp $
d46 1
a46 1
CFLAGS+= NUMBOOT=1 -DDOSLABEL
@


1.44
log
@OK, landisk needs NUMBOOT=1
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.43 2007/06/16 17:24:04 deraadt Exp $
d61 1
a61 1
CFLAGS+= -DSEEALSO="\"installboot(8)\"" -DCYLCHECK -DAAT0
@


1.43
log
@i386/amd64/zaurus/landisk are not NUMBOOT=1 or NUMBOOT=2 architectures.
the result was occasional disklabel trashing as a result of disklabel -r,
and perhaps other requests to the command; ok krw
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.42 2006/10/12 04:37:38 drahn Exp $
d46 1
a46 1
CFLAGS+= -DDOSLABEL
@


1.42
log
@Should be correct for landisk.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.42 2006/10/12 04:37:42 drahn Exp $
d31 1
a31 1
CFLAGS+= -DNUMBOOT=2 -DDOSLABEL
d46 1
a46 1
CFLAGS+= -DNUMBOOT=1 -DDOSLABEL
d65 1
a65 1
CFLAGS+= -DNUMBOOT=2 -DDOSLABEL
@


1.41
log
@Let armish and cats recognize MBR partitioning, to come up with proper
disklabel bounds in disklabel -E; while there, sort of sort the architectures.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.40 2006/04/26 17:09:34 deraadt Exp $
d43 5
@


1.40
log
@man page is gzip'd, should store as unsigned char array.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.39 2005/08/30 05:02:40 uwe Exp $
d30 1
a30 5
.if (${MACHINE} == "cats")
CFLAGS+= -DSEEALSO="\"fdisk(8)\""
.endif

.if (${MACHINE} == "i386") || (${MACHINE} == "amd64")
d35 2
a36 2
.if (${MACHINE} == "zaurus")
CFLAGS+= -DNUMBOOT=2 -DDOSLABEL
d40 2
a41 3

.if (${MACHINE} == "hp300") || (${MACHINE} == "vax") || \
    (${MACHINE} == "hppa") || (${MACHINE} == "hppa64")
d45 3
a47 3
.if (${MACHINE} == "sun3") || (${MACHINE} == "sparc") || \
    (${MACHINE} == "sparc64")
CFLAGS+= -DSEEALSO="\"installboot(8)\"" -DCYLCHECK -DAAT0
d54 7
a60 2
.if (${MACHINE} == "macppc")
CFLAGS+= -DDOSLABEL
@


1.39
log
@Get the start of the A6 partition from fdisk.  Fixes wrong suggestion of
offset 0 for the start of slice a.
ok deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.38 2005/04/01 16:00:09 deraadt Exp $
d16 1
a16 1
	(echo 'const char manpage[] = {'; \
d21 1
a21 1
	(echo 'const char manpage[] = {'; \
@


1.38
log
@will do disklabels like hppa
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.37 2005/02/16 20:39:37 millert Exp $
d30 1
a30 1
.if (${MACHINE} == "cats") || (${MACHINE} == "zaurus")
d37 5
@


1.37
log
@Prevent gzip from storing mtime and filename in the header so we
get identical binaries.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.36 2005/01/13 19:32:01 deraadt Exp $
d40 2
a41 1
.if (${MACHINE} == "hp300") || (${MACHINE} == "vax") || (${MACHINE} == "hppa")
@


1.36
log
@be aware of zaurus
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.35 2004/11/06 20:03:08 otto Exp $
d22 1
a22 1
	gzip -9c disklabel.cat8 | hexdump -ve '"0x" 1/1 "%02x,"'; \
@


1.35
log
@update -DSEEALSO for alpha and cats, remove arc and amiga. ok miod@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.34 2004/11/06 18:57:59 otto Exp $
d30 1
a30 1
.if (${MACHINE} == "cats")
@


1.34
log
@gzip embedded man pages, and pipe through gunzip when viewing.
ok deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.33 2004/05/03 15:18:19 drahn Exp $
d26 6
a31 2
.if (${MACHINE} == "amiga")
CFLAGS+= -D${MACHINE}
a38 4
.if (${MACHINE} == "arc")
CFLAGS+= -DDOSLABEL -DNUMBOOT=1
CFLAGS+= -DSEEALSO="\"fdisk(8)\""
.endif
@


1.33
log
@Remove OpenBSD/pegaos, this has been announced before but delayed until
the tree was stable. No point in code supporting a company which screws
its employees being in the OpenBSD tree.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.31 2004/01/28 17:45:22 deraadt Exp $
d16 3
a18 3
	(echo 'char manpage[] = "\\'; \
	echo "no manual\\"; \
	echo '";' ) > manual.c
d21 3
a23 3
	(echo 'char manpage[] = "\\'; \
	sed -e 's/[\\"]/\\&/g' -e 's/$$/\\n\\/' disklabel.cat8; \
	echo '";' ) > manual.c
@


1.32
log
@correct NOMAN= case
@
text
@d53 1
a53 1
.if (${MACHINE} == "macppc") || (${MACHINE} == "pegasos")
@


1.31
log
@Repair build links for pegosos, and also build for amd64
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.30 2003/10/31 04:05:29 drahn Exp $
d17 1
a17 1
	echo "no manual"; \
@


1.30
log
@These should build on pegasos
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.29.8.1 2003/10/10 17:04:13 drahn Exp $
d30 1
a30 1
.if (${MACHINE} == "i386")
@


1.29
log
@add a hppa case
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.28 2002/06/26 18:34:27 wcobb Exp $
d53 1
a53 1
.if (${MACHINE} == "macppc")
@


1.28
log
@include <bsd.own.mk> before using NOMAN; ok millert@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.27 2002/02/20 01:55:49 miod Exp $
d40 1
a40 1
.if (${MACHINE} == "hp300") || (${MACHINE} == "vax")
@


1.27
log
@Tweak mvme88k and sparc64 specific settings.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.26 2001/09/01 16:21:16 drahn Exp $
d11 2
@


1.26
log
@Changes to build platform specific files properly with the powerpc -> macppc
port rename. This adds support for some of these to mvmeppc when it
becomes MACHINE_ARCH=powerpc, as MACHINE_ARCH is tested in some instances.
ancontrol and wicontrol are MACHINE_ARCH changes.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.25 2001/04/05 17:03:37 deraadt Exp $
d42 2
a43 1
.if (${MACHINE} == "sun3") || (${MACHINE} == "sparc")
d47 1
a47 1
.if (${MACHINE} == "mvme68k") || (${MACHINE} == "mvme68k")
@


1.25
log
@permit tree build with NOMAN is set
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.24 2001/02/05 10:16:18 art Exp $
d50 1
a50 1
.if (${MACHINE} == "powerpc")
@


1.24
log
@Remove the NOMAN hack. This is not the way we want to do this.
(and the original problem is gone anyway).
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.23 2001/01/18 15:05:20 art Exp $
d11 7
d22 1
@


1.23
log
@Fix NOMAN builds.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.22 2001/01/17 04:23:45 d Exp $
a10 4
.if defined(NOMAN)
manual.c:
	echo 'char manpage[] = "Sorry. No man page.";' > manual.c
.else
a14 1
.endif
@


1.22
log
@don't nroff twice, and escape protect possible bad chars
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.21 1999/07/14 23:16:26 deraadt Exp $
d9 1
d11 4
d19 1
@


1.21
log
@put in a check for architectures that demand that partition A start at sector 0
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.20 1999/02/01 16:43:20 pefo Exp $
d10 1
a10 1
manual.c:	disklabel.8
d12 1
a12 1
	nroff -mandoc ${.CURDIR}/disklabel.8 | sed -e 's/$$/\\n\\/' ; \
@


1.20
log
@Allow for arc machines to install boot blocks
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.19 1998/05/16 17:33:31 deraadt Exp $
d34 1
a34 1
CFLAGS+= -DSEEALSO="\"installboot(8)\"" -DCYLCHECK
@


1.19
log
@oops; d
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.18 1998/05/07 06:27:32 millert Exp $
d25 1
a25 1
CFLAGS+= -DDOSLABEL
@


1.18
log
@get rid of #ifdef OLD_SCSI stuff.  It is not useful
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.17 1998/04/25 07:04:45 deraadt Exp $
d10 1
a10 1
manual.c:	disklabel.cat8
@


1.17
log
@build if NOMAN= is globally set; problem spotted by rahnds
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.16 1997/10/24 02:44:07 millert Exp $
a16 4
.endif

.if (${MACHINE} == "hp300") || (${MACHINE} == "pmax")
CFLAGS+= -DOLD_SCSI
@


1.16
log
@Warn that geom may be wrong for ports with old scsi.
For ports where boot blocks sit in the first cylinder, don't suggest an
    offset that would clobber them.
Mention the 'b' command when the user tries to go past end of the OpenBSD part.
In 'b' command, don't suggest size that extends beyond the disk.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.15 1997/10/16 10:54:27 deraadt Exp $
d12 1
a12 1
	sed -e 's/$$/\\n\\/' ${.OBJDIR}/disklabel.cat8; \
@


1.15
log
@ensure man pages exist first
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.14 1997/10/16 10:42:45 deraadt Exp $
d15 1
a15 1
.if ${MACHINE} == "amiga"
d17 4
@


1.14
log
@CLEANFILES+=manual.c
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.13 1997/10/16 10:40:09 deraadt Exp $
d7 1
a7 1
MAN=	disklabel.5 disklabel.8
d10 1
a10 1
manual.c:	${.OBJDIR}/disklabel.cat8
@


1.13
log
@new command: M (shows linked-in manpage)
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.12 1997/10/13 15:02:14 pefo Exp $
d9 1
@


1.12
log
@Well, ppc has to work....
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.11 1997/09/30 17:54:16 millert Exp $
d4 1
a4 1
SRCS=	disklabel.c dkcksum.c editor.c
d8 5
@


1.11
log
@Implement "disklabel -E" -- a simple interactive label editor for
installs and new labels.  Documentation to follow :-) Also, give
the user the option of writing the fictitious label if no on-disk
label exists with the -e, -E, and -w options.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.10 1997/09/21 11:36:12 deraadt Exp $
d33 5
@


1.10
log
@$OpenBSD$
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.9 1997/09/03 22:39:11 mickey Exp $
d4 1
a4 1
SRCS=	disklabel.c dkcksum.c
@


1.9
log
@add xr installboot for i386
change msg to accomodate multiple man pages in SEEALSO
@
text
@d1 1
a1 3
#	$OpenBSD: Makefile,v 1.8 1997/04/20 08:59:36 deraadt Exp $
#	$NetBSD: Makefile,v 1.18 1995/10/17 16:34:04 cgd Exp $
#	@@(#)Makefile	8.2 (Berkeley) 3/17/94
@


1.8
log
@sparc/sun3 labels want cyl-alignment; grr
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.7 1996/09/24 04:35:17 deraadt Exp $
d17 1
a17 1
CFLAGS+= -DSEEALSO="\"fdisk(8)\""
@


1.7
log
@flags: add -n: do nothing, -v: verbose; delete -d flag.  on DOSLABEL systems,
ensure the OpenBSD disklabel/bootblocks are written inside 165 partition
(RAW_PART must start at block 0 of unit) -- this makes the kernel algorithm
and userland algorithms the same. unify & pretty the usage message
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.6 1996/09/20 08:25:01 deraadt Exp $
d30 1
a30 1
CFLAGS+= -DSEEALSO="\"installboot(8)\""
@


1.6
log
@arc, not pica
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.5 1996/06/17 06:57:05 downsj Exp $
d17 1
d22 1
d27 8
@


1.5
log
@Switch over to generic opendev(3).
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.4 1996/06/12 08:02:43 downsj Exp $
d19 1
a19 1
.if (${MACHINE} == "pica")
@


1.4
log
@kill RAWPARTITION, use RAW_PART
@
text
@d1 1
a1 1
#	$OpenBSD$
d7 2
@


1.3
log
@Introduced DOSLABEL to control Dos label handling instead of associate with i386.
@
text
@d1 1
a22 4
.endif

.if ${MACHINE} == "i386"
CFLAGS+= -DRAWPARTITION=\'d\'
@


1.2
log
@from netbsd; alpha has 2-leval boot
@
text
@d13 5
a17 1
CFLAGS+= -DNUMBOOT=2
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
#	$NetBSD: Makefile,v 1.17 1995/04/23 19:27:59 ragge Exp $
d12 1
a12 1
.if (${MACHINE} == "i386") || (${MACHINE} == "alpha")
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
