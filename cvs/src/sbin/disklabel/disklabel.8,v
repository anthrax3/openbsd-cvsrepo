head	1.121;
access;
symbols
	OPENBSD_6_0:1.118.0.4
	OPENBSD_6_0_BASE:1.118
	OPENBSD_5_9:1.118.0.2
	OPENBSD_5_9_BASE:1.118
	OPENBSD_5_8:1.115.0.4
	OPENBSD_5_8_BASE:1.115
	OPENBSD_5_7:1.112.0.2
	OPENBSD_5_7_BASE:1.112
	OPENBSD_5_6:1.111.0.4
	OPENBSD_5_6_BASE:1.111
	OPENBSD_5_5:1.108.0.4
	OPENBSD_5_5_BASE:1.108
	OPENBSD_5_4:1.107.0.8
	OPENBSD_5_4_BASE:1.107
	OPENBSD_5_3:1.107.0.6
	OPENBSD_5_3_BASE:1.107
	OPENBSD_5_2:1.107.0.4
	OPENBSD_5_2_BASE:1.107
	OPENBSD_5_1_BASE:1.107
	OPENBSD_5_1:1.107.0.2
	OPENBSD_5_0:1.103.0.2
	OPENBSD_5_0_BASE:1.103
	OPENBSD_4_9:1.94.0.2
	OPENBSD_4_9_BASE:1.94
	OPENBSD_4_8:1.93.0.2
	OPENBSD_4_8_BASE:1.93
	OPENBSD_4_7:1.86.0.2
	OPENBSD_4_7_BASE:1.86
	OPENBSD_4_6:1.85.0.4
	OPENBSD_4_6_BASE:1.85
	OPENBSD_4_5:1.71.0.2
	OPENBSD_4_5_BASE:1.71
	OPENBSD_4_4:1.69.0.2
	OPENBSD_4_4_BASE:1.69
	OPENBSD_4_3:1.66.0.2
	OPENBSD_4_3_BASE:1.66
	OPENBSD_4_2:1.63.0.2
	OPENBSD_4_2_BASE:1.63
	OPENBSD_4_1:1.60.0.4
	OPENBSD_4_1_BASE:1.60
	OPENBSD_4_0:1.60.0.2
	OPENBSD_4_0_BASE:1.60
	OPENBSD_3_9:1.59.0.6
	OPENBSD_3_9_BASE:1.59
	OPENBSD_3_8:1.59.0.4
	OPENBSD_3_8_BASE:1.59
	OPENBSD_3_7:1.59.0.2
	OPENBSD_3_7_BASE:1.59
	OPENBSD_3_6:1.57.0.4
	OPENBSD_3_6_BASE:1.57
	OPENBSD_3_5:1.57.0.2
	OPENBSD_3_5_BASE:1.57
	OPENBSD_3_4:1.54.0.2
	OPENBSD_3_4_BASE:1.54
	OPENBSD_3_3:1.50.0.2
	OPENBSD_3_3_BASE:1.50
	OPENBSD_3_2:1.45.0.2
	OPENBSD_3_2_BASE:1.45
	OPENBSD_3_1:1.43.0.2
	OPENBSD_3_1_BASE:1.43
	OPENBSD_3_0:1.42.0.2
	OPENBSD_3_0_BASE:1.42
	OPENBSD_2_9:1.40.0.2
	OPENBSD_2_9_BASE:1.40
	OPENBSD_2_8:1.37.0.2
	OPENBSD_2_8_BASE:1.37
	OPENBSD_2_7:1.36.0.2
	OPENBSD_2_7_BASE:1.36
	OPENBSD_2_6:1.34.0.2
	OPENBSD_2_6_BASE:1.34
	OPENBSD_2_5:1.29.0.2
	OPENBSD_2_5_BASE:1.29
	OPENBSD_2_4:1.20.0.2
	OPENBSD_2_4_BASE:1.20
	OPENBSD_2_3:1.16.0.2
	OPENBSD_2_3_BASE:1.16
	OPENBSD_2_2:1.10.0.2
	OPENBSD_2_2_BASE:1.10
	OPENBSD_2_1:1.3.0.2
	OPENBSD_2_1_BASE:1.3
	OPENBSD_2_0:1.2.0.2
	OPENBSD_2_0_BASE:1.2
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@.\" @;


1.121
date	2016.12.08.23.56.47;	author jmc;	state Exp;
branches;
next	1.120;
commitid	0ZUJ1szU7dRMT9kv;

1.120
date	2016.12.03.07.34.39;	author jmc;	state Exp;
branches;
next	1.119;
commitid	NPOGjbeFd67PVR3N;

1.119
date	2016.09.01.12.19.35;	author jmc;	state Exp;
branches;
next	1.118;
commitid	4d2DXaCPC8RwwdmO;

1.118
date	2015.12.24.13.47.08;	author otto;	state Exp;
branches;
next	1.117;
commitid	8AMZ53BX36iKoGxw;

1.117
date	2015.10.16.04.20.54;	author miod;	state Exp;
branches;
next	1.116;
commitid	4N8eOqa8YEI8LTjT;

1.116
date	2015.10.15.19.31.15;	author miod;	state Exp;
branches;
next	1.115;
commitid	cIMgSVEQ53BJoP4V;

1.115
date	2015.05.19.18.50.39;	author sobrado;	state Exp;
branches;
next	1.114;
commitid	kCVpzykGB9MIohXM;

1.114
date	2015.04.29.16.56.31;	author henning;	state Exp;
branches;
next	1.113;
commitid	UAIjeVKl6GkJq4ts;

1.113
date	2015.04.29.09.58.16;	author henning;	state Exp;
branches;
next	1.112;
commitid	4ecfLcgizo5sIt85;

1.112
date	2015.02.28.21.51.57;	author bentley;	state Exp;
branches;
next	1.111;
commitid	NNu2UZnsd5zmNVYD;

1.111
date	2014.07.16.13.46.30;	author deraadt;	state Exp;
branches;
next	1.110;
commitid	UXzlfXGqVwYywL9M;

1.110
date	2014.05.07.18.55.52;	author krw;	state Exp;
branches;
next	1.109;

1.109
date	2014.05.05.16.33.34;	author krw;	state Exp;
branches;
next	1.108;

1.108
date	2013.08.14.08.39.30;	author jmc;	state Exp;
branches;
next	1.107;

1.107
date	2012.01.02.04.38.00;	author krw;	state Exp;
branches;
next	1.106;

1.106
date	2012.01.02.03.40.31;	author krw;	state Exp;
branches;
next	1.105;

1.105
date	2012.01.02.00.59.33;	author krw;	state Exp;
branches;
next	1.104;

1.104
date	2011.09.04.08.29.46;	author jmc;	state Exp;
branches;
next	1.103;

1.103
date	2011.06.05.11.57.17;	author krw;	state Exp;
branches;
next	1.102;

1.102
date	2011.05.23.08.40.56;	author otto;	state Exp;
branches;
next	1.101;

1.101
date	2011.05.22.17.47.44;	author otto;	state Exp;
branches;
next	1.100;

1.100
date	2011.04.30.14.48.39;	author jmc;	state Exp;
branches;
next	1.99;

1.99
date	2011.04.19.14.20.37;	author halex;	state Exp;
branches;
next	1.98;

1.98
date	2011.04.16.23.07.19;	author krw;	state Exp;
branches;
next	1.97;

1.97
date	2011.04.16.16.05.53;	author krw;	state Exp;
branches;
next	1.96;

1.96
date	2011.04.16.14.51.00;	author krw;	state Exp;
branches;
next	1.95;

1.95
date	2011.04.16.11.44.41;	author krw;	state Exp;
branches;
next	1.94;

1.94
date	2010.09.23.17.16.01;	author jmc;	state Exp;
branches;
next	1.93;

1.93
date	2010.04.28.17.26.46;	author jsing;	state Exp;
branches;
next	1.92;

1.92
date	2010.04.21.06.56.57;	author jmc;	state Exp;
branches;
next	1.91;

1.91
date	2010.04.21.03.35.41;	author lum;	state Exp;
branches;
next	1.90;

1.90
date	2010.04.14.20.15.11;	author jmc;	state Exp;
branches;
next	1.89;

1.89
date	2010.04.14.15.19.27;	author lum;	state Exp;
branches;
next	1.88;

1.88
date	2010.03.23.18.43.06;	author jmc;	state Exp;
branches;
next	1.87;

1.87
date	2010.03.23.14.32.34;	author otto;	state Exp;
branches;
next	1.86;

1.86
date	2009.07.27.12.39.50;	author jmc;	state Exp;
branches;
next	1.85;

1.85
date	2009.06.02.16.23.45;	author krw;	state Exp;
branches;
next	1.84;

1.84
date	2009.05.31.00.14.55;	author krw;	state Exp;
branches;
next	1.83;

1.83
date	2009.04.10.20.54.08;	author krw;	state Exp;
branches;
next	1.82;

1.82
date	2009.04.01.06.44.01;	author jmc;	state Exp;
branches;
next	1.81;

1.81
date	2009.03.31.11.33.47;	author krw;	state Exp;
branches;
next	1.80;

1.80
date	2009.03.31.00.32.25;	author krw;	state Exp;
branches;
next	1.79;

1.79
date	2009.03.30.10.40.41;	author krw;	state Exp;
branches;
next	1.78;

1.78
date	2009.03.28.23.47.31;	author krw;	state Exp;
branches;
next	1.77;

1.77
date	2009.03.28.14.40.20;	author deraadt;	state Exp;
branches;
next	1.76;

1.76
date	2009.03.28.14.03.21;	author deraadt;	state Exp;
branches;
next	1.75;

1.75
date	2009.03.28.13.54.15;	author krw;	state Exp;
branches;
next	1.74;

1.74
date	2009.03.23.16.36.38;	author jmc;	state Exp;
branches;
next	1.73;

1.73
date	2009.03.22.20.51.58;	author jmc;	state Exp;
branches;
next	1.72;

1.72
date	2009.03.22.19.01.32;	author krw;	state Exp;
branches;
next	1.71;

1.71
date	2008.08.10.13.00.25;	author sobrado;	state Exp;
branches;
next	1.70;

1.70
date	2008.08.10.11.22.40;	author sobrado;	state Exp;
branches;
next	1.69;

1.69
date	2008.06.25.18.31.07;	author otto;	state Exp;
branches;
next	1.68;

1.68
date	2008.04.06.20.18.54;	author krw;	state Exp;
branches;
next	1.67;

1.67
date	2008.03.23.19.42.17;	author krw;	state Exp;
branches;
next	1.66;

1.66
date	2008.01.25.15.30.11;	author otto;	state Exp;
branches;
next	1.65;

1.65
date	2008.01.08.23.46.54;	author krw;	state Exp;
branches;
next	1.64;

1.64
date	2007.12.16.14.58.27;	author sobrado;	state Exp;
branches;
next	1.63;

1.63
date	2007.06.02.08.02.51;	author jmc;	state Exp;
branches;
next	1.62;

1.62
date	2007.05.31.19.19.43;	author jmc;	state Exp;
branches;
next	1.61;

1.61
date	2007.04.26.22.42.11;	author krw;	state Exp;
branches;
next	1.60;

1.60
date	2006.05.16.05.41.25;	author stevesk;	state Exp;
branches;
next	1.59;

1.59
date	2005.03.07.23.41.53;	author jmc;	state Exp;
branches;
next	1.58;

1.58
date	2004.10.25.08.14.46;	author otto;	state Exp;
branches;
next	1.57;

1.57
date	2003.12.30.10.54.33;	author jmc;	state Exp;
branches;
next	1.56;

1.56
date	2003.12.29.19.51.34;	author millert;	state Exp;
branches;
next	1.55;

1.55
date	2003.12.20.09.29.27;	author jmc;	state Exp;
branches;
next	1.54;

1.54
date	2003.09.02.18.30.27;	author jmc;	state Exp;
branches;
next	1.53;

1.53
date	2003.06.21.23.14.23;	author jmc;	state Exp;
branches;
next	1.52;

1.52
date	2003.06.03.13.16.08;	author jmc;	state Exp;
branches;
next	1.51;

1.51
date	2003.06.02.20.06.14;	author millert;	state Exp;
branches;
next	1.50;

1.50
date	2003.03.12.20.12.36;	author deraadt;	state Exp;
branches;
next	1.49;

1.49
date	2003.02.13.00.10.39;	author tedu;	state Exp;
branches;
next	1.48;

1.48
date	2003.02.01.16.29.52;	author jmc;	state Exp;
branches;
next	1.47;

1.47
date	2002.12.31.16.22.25;	author miod;	state Exp;
branches;
next	1.46;

1.46
date	2002.11.14.02.57.27;	author deraadt;	state Exp;
branches;
next	1.45;

1.45
date	2002.09.18.07.33.47;	author deraadt;	state Exp;
branches;
next	1.44;

1.44
date	2002.07.27.13.31.30;	author aaron;	state Exp;
branches;
next	1.43;

1.43
date	2001.12.13.20.16.48;	author mpech;	state Exp;
branches;
next	1.42;

1.42
date	2001.08.17.11.13.57;	author mpech;	state Exp;
branches;
next	1.41;

1.41
date	2001.08.07.01.46.12;	author millert;	state Exp;
branches;
next	1.40;

1.40
date	2001.02.04.15.06.05;	author deraadt;	state Exp;
branches;
next	1.39;

1.39
date	2001.01.24.09.52.24;	author deraadt;	state Exp;
branches;
next	1.38;

1.38
date	2000.11.09.17.52.53;	author aaron;	state Exp;
branches;
next	1.37;

1.37
date	2000.06.04.18.19.45;	author millert;	state Exp;
branches;
next	1.36;

1.36
date	2000.04.04.16.29.27;	author millert;	state Exp;
branches;
next	1.35;

1.35
date	2000.03.18.22.55.55;	author aaron;	state Exp;
branches;
next	1.34;

1.34
date	99.10.10.16.49.28;	author aaron;	state Exp;
branches;
next	1.33;

1.33
date	99.10.09.21.05.57;	author angelos;	state Exp;
branches;
next	1.32;

1.32
date	99.08.14.15.11.11;	author millert;	state Exp;
branches;
next	1.31;

1.31
date	99.07.04.18.59.38;	author aaron;	state Exp;
branches;
next	1.30;

1.30
date	99.05.23.14.11.14;	author aaron;	state Exp;
branches;
next	1.29;

1.29
date	99.04.07.22.57.25;	author millert;	state Exp;
branches;
next	1.28;

1.28
date	99.03.25.15.34.54;	author espie;	state Exp;
branches;
next	1.27;

1.27
date	99.03.23.05.18.49;	author millert;	state Exp;
branches;
next	1.26;

1.26
date	99.03.16.04.47.15;	author millert;	state Exp;
branches;
next	1.25;

1.25
date	99.03.13.19.07.35;	author millert;	state Exp;
branches;
next	1.24;

1.24
date	99.03.01.01.50.45;	author millert;	state Exp;
branches;
next	1.23;

1.23
date	98.12.15.01.20.28;	author aaron;	state Exp;
branches;
next	1.22;

1.22
date	98.11.28.19.56.17;	author aaron;	state Exp;
branches;
next	1.21;

1.21
date	98.11.11.22.19.56;	author aaron;	state Exp;
branches;
next	1.20;

1.20
date	98.09.23.01.20.22;	author aaron;	state Exp;
branches;
next	1.19;

1.19
date	98.09.17.04.14.51;	author aaron;	state Exp;
branches;
next	1.18;

1.18
date	98.08.06.18.08.09;	author millert;	state Exp;
branches;
next	1.17;

1.17
date	98.07.24.17.40.43;	author millert;	state Exp;
branches;
next	1.16;

1.16
date	98.04.08.03.00.44;	author millert;	state Exp;
branches;
next	1.15;

1.15
date	98.03.01.06.43.27;	author johns;	state Exp;
branches;
next	1.14;

1.14
date	98.02.20.20.57.50;	author deraadt;	state Exp;
branches;
next	1.13;

1.13
date	98.02.20.10.29.00;	author deraadt;	state Exp;
branches;
next	1.12;

1.12
date	97.12.20.22.35.19;	author rees;	state Exp;
branches;
next	1.11;

1.11
date	97.11.25.00.36.23;	author millert;	state Exp;
branches;
next	1.10;

1.10
date	97.10.28.06.01.09;	author millert;	state Exp;
branches;
next	1.9;

1.9
date	97.10.28.05.58.17;	author millert;	state Exp;
branches;
next	1.8;

1.8
date	97.10.28.05.52.26;	author millert;	state Exp;
branches;
next	1.7;

1.7
date	97.10.28.05.22.51;	author millert;	state Exp;
branches;
next	1.6;

1.6
date	97.10.15.09.08.26;	author deraadt;	state Exp;
branches;
next	1.5;

1.5
date	97.10.02.00.09.06;	author millert;	state Exp;
branches;
next	1.4;

1.4
date	97.05.30.07.48.44;	author deraadt;	state Exp;
branches;
next	1.3;

1.3
date	97.02.11.21.50.16;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	96.06.23.14.30.05;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.43.27;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.43.27;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.121
log
@move the text describing the % and & units to a better place;
diff from jerome frgacic, tweaked by myself

ok krw millert
@
text
@.\"	$OpenBSD: disklabel.8,v 1.120 2016/12/03 07:34:39 jmc Exp $
.\"	$NetBSD: disklabel.8,v 1.9 1995/03/18 14:54:38 cgd Exp $
.\"
.\" Copyright (c) 1987, 1988, 1991, 1993
.\"	The Regents of the University of California.  All rights reserved.
.\"
.\" This code is derived from software contributed to Berkeley by
.\" Symmetric Computer Systems.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. Neither the name of the University nor the names of its contributors
.\"    may be used to endorse or promote products derived from this software
.\"    without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.\"	@@(#)disklabel.8	8.2 (Berkeley) 4/19/94
.\"
.Dd $Mdocdate: December 3 2016 $
.Dt DISKLABEL 8
.Os
.Sh NAME
.Nm disklabel
.Nd read and write disk pack label
.Sh SYNOPSIS
.Nm disklabel
.Op Fl Acdtv
.Op Fl h | p Ar unit
.Op Fl T Ar file
.Ar disk
.Nm disklabel
.Fl w
.Op Fl Acdnv
.Op Fl T Ar file
.Ar disk Ar disktype
.Op Ar packid
.Nm disklabel
.Fl e
.Op Fl Acdnv
.Op Fl T Ar file
.Ar disk
.Nm disklabel
.Fl E
.Op Fl Acdnv
.Op Fl F Ns | Ns Fl f Ar file
.Op Fl T Ar file
.Ar disk
.Nm disklabel
.Fl R
.Op Fl nv
.Op Fl F Ns | Ns Fl f Ar file
.Ar disk Ar protofile
.Sh DESCRIPTION
The
.Nm
utility can be used to install, examine, or modify the label on a disk drive or
pack.
The disk label contains information about disk characteristics
.Pq size, type, etc.
and the partition layout, stored on the disk itself.
It is used by the operating system to optimize disk I/O and
locate the filesystems resident on the disk.
.Pp
.Nm
supports 15 configurable partitions,
.Sq a
through
.Sq p ,
excluding
.Sq c .
The
.Sq c
partition describes the entire physical disk, is automatically created
by the kernel, and cannot be modified or deleted by
.Nm .
By convention, the
.Sq a
partition of the boot disk is the root partition, and the
.Sq b
partition of the boot disk is the swap partition,
but all other letters can be used in any order for any other
partitions as desired.
.Pp
The options are as follows:
.Bl -tag -width Ds
.It Fl A
Automatically allocate all the disk space in the
.Ox
portion of the disk in the recommended manner.
See
.Sx AUTOMATIC DISK ALLOCATION ,
below.
.It Fl c
Clear the system's in-core copy of the label and update it based on
the on-disk label.
.It Fl d
Use the
.Em default
label.
This ignores any existing
.Ox
disk label on the disk.
.It Fl E
Use the built-in command-driven label editor described below.
.It Fl e
Edit an existing disk label using the editor specified in the
.Ev EDITOR
environment variable, or
.Xr vi 1
if none is specified.
.It Fl F Ar file
Write entries to
.Ar file
in
.Xr fstab 5
format for any partitions for which mount point information is known.
The entries will be written using disklabel UIDs.
The
.Fl F
flag is only valid when used in conjunction with the
.Fl E
or
.Fl R
flags.
If
.Ar file
already exists, it will be overwritten.
.It Fl f Ar file
The same as
.Fl F
except that entries will be written using disk device names.
.It Fl h
Print partition sizes in human readable format.
.It Fl n
Make no permanent changes to the disklabel
.Pq useful for debugging purposes .
.It Fl p Ar unit
Print partition sizes in
.Ar unit
instead of sectors.
Valid units are b(ytes), c(ylinders), k(ilobytes), m(egabytes), g(igabytes)
and t(erabytes).
.It Fl R
Restore a disk label that was formatted in a prior operation and
saved in an
.Tn ASCII
file.
.It Fl T Ar file
Read the template for automatic allocation from
.Ar file
instead of using the builtin one.
See
.Sx AUTOMATIC DISK ALLOCATION
below for the format.
.It Fl t
Format the label as a
.Xr disktab 5
entry.
.It Fl v
Print additional information during operation
.Pq verbose mode .
.It Fl w
Write a standard label on the designated drive.
.It Ar disk
Specify the
.Ar disk
to operate on.
It can be specified by its full pathname, by an abbreviated disk form,
or by its disklabel UID.
In its abbreviated form, the path to the device, the
.Sq r
denoting
.Qq raw device ,
and the partition letter, can all be omitted.
For example, the first IDE disk can be specified as either
.Pa /dev/rwd0c ,
.Pa /dev/wd0c ,
or
.Ar wd0 .
.It Ar disktype
Specify a
.Ar disktype
entry from the
.Xr disktab 5
database.
.It Ar packid
Specify a pack identification string for the device
.Pq see below .
.It Ar protofile
Used with the restore option
.Pq Fl R
to specify a file to read an ASCII label from.
.El
.Pp
The first form of the command
.Pq read
is used to examine the label on the named disk drive.
It will display all of the parameters associated with the drive
and its partition layout.
The kernel's in-core copy of the label is displayed; if
the disk has no label, or the partition types on the disk are
incorrect, the kernel may have constructed or modified the label.
.Pp
The second form of the command
.Pq write
is used to write a standard label on the designated drive.
The drive parameters and partitions are taken from that file.
If different disks of the same physical type are
to have different partitions, it will be necessary to have separate
disktab entries describing each, or to edit the label after
installation as described below.
The optional argument is a pack
identification string, up to 16 characters long.
The pack ID must be quoted if it contains blanks.
The existing label will be updated via the in-core
copy and any bootstrap code will be unaffected.
.Pp
In the third form of the command
.Pq edit ,
the label is read from the in-core kernel copy
and then supplied to an editor for changes.
If no editor is specified in an
.Ev EDITOR
environment variable,
.Xr vi 1
is used.
When the editor terminates, the formatted label is reread and
used to rewrite the disk label.
Existing bootstrap code is unchanged.
.Pp
The built-in label editor
.Pq fourth form
provides a simple interactive label editor.
Some commands or prompts take an optional unit.
Available units are
.Sq b
for bytes,
.Sq c
for cylinders,
.Sq k
for kilobytes,
.Sq m
for megabytes,
.Sq g
for gigabytes,
and
.Sq t
for terabytes.
If no unit is given, the default is to use sectors
(usually 512 bytes).
.Pp
Quantities are rounded to the nearest
cylinder when units are specified for sizes
.Pq or offsets .
At prompts that request a size,
.Ql *
may be entered to indicate the rest of the available space,
.Sq %
for percentage of total, and
.Sq &
for percentage free.
Commands may be aborted by entering
.Ql ^D
.Pq Control-D .
Entering
.Ql ^D
at the main
.Ql >
prompt will exit the editor.
.Pp
The editor commands are as follows:
.Bl -tag -width "p [unit] "
.It Cm \&? | h
Display help message with all available commands.
There is also
.Pq simple
context-sensitive help available at most prompts.
.It Cm A
Allocate all the disk space in the recommended manner.
See
.Sx AUTOMATIC DISK ALLOCATION ,
below.
.It Cm a Op Ar part
Add new partition.
This option adds a new partition to the disk label.
If no partition letter is specified
.Pq a\-p ,
the user will be prompted for one.
.It Cm b
Set
.Ox
disk boundaries.
This option tells
.Nm
which parts of the disk it is allowed to modify.
This option is probably only useful for ports with
.Xr fdisk 8
partition tables where the ending sector in the MBR is incorrect.
The user may enter
.Ql *
at the
.Dq Size
prompt to indicate the entire size of the disk
.Pq minus the starting sector .
This is useful for disks where the
fdisk partition table is incapable of storing the real size.
Note: data may become corrupted if boundaries are extended such
that they overlap with other resident operating systems.
.It Cm c Op Ar part
Change the size of an existing partition.
If no partition is specified, the user will be prompted for one.
The new size may be
in terms of the aforementioned units and may also be prefixed with
.Ql +
or
.Ql -
to change the size by a relative amount.
.It Cm D
Sets the disk label to the default values as reported by the kernel.
This simulates the case where there is no disk label.
.It Cm d Op Ar part
Delete an existing partition (or
.Ql *
to delete all partitions).
If no partition is specified, the user will be prompted for one.
.It Cm e
Edit drive parameters.
This option is used to set the following parameters:
disk type, a descriptive label string, sectors/track,
tracks/cylinder, sectors/cylinder, number of cylinders,
total sectors, rpm, and interleave.
.It Xo
.Cm g
.Op Ar d | u
.Xc
Set disk geometry based on what the
.Em disk
or
.Em user
thinks (the
.Em user
geometry is simply what the label said before
.Nm
made any changes).
.It Cm i
Change the disklabel UID, specified as a 16-character hexadecimal string.
If set to all zeros, a new UID will automatically be allocated when the
disklabel is written to disk.
.It Cm l Op Ar unit
Print the disk label header.
.It Cm M
Display this manual page.
The manual page is piped through the pager specified by the
.Ev PAGER
environment variable or 'less' if
.Ev PAGER
is not set.
.It Cm m Op Ar part
Modify parameters for an existing partition.
If no partition is specified, the user will be prompted for one.
This option allows
the user to change the filesystem type, starting offset, partition size,
and mount point for the specified partition.
If expert mode is enabled (see
.Cm X
below), then block fragment size, block size, and cylinders per group
can also be modified.
Note that not all parameters are configurable for
.Pf non- Bx
partitions.
.It Cm n Op Ar part
Name the mount point for an existing partition.
If no partition is specified, the user will be prompted for one.
This option is only valid if
.Nm
was invoked with the
.Fl f
flag.
.It Cm p Op Ar unit
Print the current partition list.
If a
.Em unit
is given, the size and offsets are displayed in terms of the
specified unit.
If the unit is
.Sq *
it is automatically determined by the size of the smallest
partition.
.It Cm q
Quit the editor.
If any changes have been made, the user will be
asked whether or not to save the changes to the on-disk label.
.It Cm R Op Ar part
Resize a partition in an automatically allocated label,
compacting unused space between partitions with a higher offset.
The last partition will be shrunk if necessary.
Works only for automatically allocated labels with no spoofed partitions.
.It Cm r
Recalculate free space.
This command displays all the free areas on the disk and the total
number of free sectors.
.It Cm s Op Ar path
Save the label to a file in
.Tn ASCII
format (suitable for loading via the
.Fl R
option).
If no path is specified, the user will be prompted for one.
.It Cm U
Undo all changes made since entering the editor.
.It Cm u
Undo
.Pq or redo
last change.
Entering
.Em u
once will undo the last change.
Entering it again will restore the change.
.It Cm w
Write the label to disk.
This option will commit any changes to the on-disk label.
.It Cm X
Toggle
.Dq expert mode .
By default, some settings are reserved for experts only
(such as the block and fragment size on ffs partitions).
.It Cm x
Exit the editor without saving any changes to the on-disk label.
.It Cm z
Zero out the existing partition table and mountpoint information,
leaving only the 'c' partition.
The drive parameters are not changed.
.El
.Pp
In the restore form of the command
.Pq fifth form ,
the prototype file used to create the label should be in the same format
as that produced when reading or editing a label.
Comments are delimited by
.Ar #
and newline.
Any existing bootstrap code will be unaffected.
.Pp
The final three forms of
.Nm
are used to install bootstrap code on machines where the bootstrap is
part of the label.
.Pp
Note that when a disk has no real
.Bx
disklabel, the kernel creates a
default label so that the disk can be used.
This default label will include other partitions found on the disk if
they are supported on your architecture.
For example, on systems that support
.Xr fdisk 8
partitions the default label will also include DOS and Linux partitions.
However, these entries are not dynamic, they are fixed at the time
.Nm
is run.
That means that subsequent changes that affect
.Pf non- Ox
partitions will not be present in the default label,
though they may be updated by hand.
To see the default label, run
.Nm
with the
.Fl d
flag.
.Nm
can then be run with the
.Fl e
flag and any entries pasted as desired from the default label into the real one.
.Sh AUTOMATIC DISK ALLOCATION
The
.Fl A
option and the editor command
.Cm A
automatically create a disklabel with a set of partitions
suitable for a majority of
.Ox
installations.
Any existing
.Ox
disklabel on the disk is ignored, but native partitions
that would normally be spoofed are preserved in the disklabel,
and are not modified during the allocation process.
.Pp
Disk size determines the set of partitions which are created.
Each partition is allocated space between a specified minimum
and maximum.
Initially, each partition is allocated its minimum space;
remaining space is split between the partitions according to the
given percentages,
up to their maximum allowed space.
Space left after all partitions have reached their maximum size
is left unallocated.
The sizes below are approximations,
and may vary from architecture to architecture.
.Pp
.Sy Disks \*(Gt 7 Gigabytes
.Bd -literal -offset indent -compact
/		 5% of disk.  80M \(en 1G
swap		 5% of disk.  80M \(en 2x max physical memory
/tmp		 8% of disk. 120M \(en 4G
/var		13% of disk.  80M \(en 2x size of crash dump
/usr		 5% of disk. 900M \(en 2G
/usr/X11R6	 3% of disk. 512M \(en 1G
/usr/local	10% of disk.   2G \(en 10G
/usr/src	 2% of disk.   1G \(en 2G
/usr/obj	 4% of disk. 1.3G \(en 2G
/home		45% of disk.   1G \(en 300G
.Ed
.Pp
.Sy Disks \*(Gt 2 Gigabytes
.Bd -literal -offset indent -compact
/		 5% of disk. 800M \(en 2G
swap		10% of disk.  80M \(en 2x max physical memory
/usr		78% of disk. 900M \(en 3G
/home		 7% of disk. 256M \(en 2G
.Ed
.Pp
.Sy Disks \*(Gt 700 Megabytes
.Bd -literal -offset indent -compact
/		95% of disk. 700M \(en 4G
swap		 5% of disk.   1M \(en 2x max physical memory
.Ed
.Pp
A template for the automatic allocation can be passed to disklabel using
the
.Fl T
option.
The template consists of one line per partition, with each line giving
mountpoint, min-max size range, and percentage of disk, space-separated.
Max can be unlimited by specifying '*'.
If only mountpoint and min size are given, the partition is created with that
exact size.
.Pp
.Bd -literal -offset indent -compact
/		250M
swap		80M-256M 10%
/tmp		120M-4G	8%
/var		80M-4G	13%
/usr		900M-2G	5%
/usr/X11R6	512M-1G	3%
/usr/local	2G-10G	10%
/usr/src	1G-2G	2%
/usr/obj	1.3G-2G	4%
/home		1G-*	45%
.Ed
.Sh FILES
.Bl -tag -width Pa -compact
.It Pa /etc/disktab
Disk description file.
.It Pa /usr/mdec/ Ns Em xx Ns boot
Primary bootstrap.
.It Pa /usr/mdec/boot Ns Em xx
Secondary bootstrap.
.El
.Sh EXAMPLES
Display the in-core label for sd0 as obtained via
.Pa /dev/rsd0c :
.Pp
.Dl # disklabel sd0
.Pp
Create a label for sd0 based on information for
.Dq sd2212
found in
.Pa /etc/disktab .
Any existing bootstrap code will be clobbered.
.Pp
.Dl # disklabel -w /dev/rsd0c sd2212 foo
.Pp
Read the on-disk label from a disk with DUID 3eb7f9da875cb9ee,
edit it and reinstall in-core as well as on-disk.
Existing bootstrap code is unaffected.
.Pp
.Dl # disklabel -E 3eb7f9da875cb9ee
.Pp
Restore the on-disk and in-core label for sd0 from information in
.Pa mylabel .
Existing bootstrap code is unaffected.
.Pp
.Dl # disklabel -R sd0 mylabel
.Sh DIAGNOSTICS
The kernel device drivers will not allow the size of a disk partition
to be decreased or the offset of a partition to be changed while
it is open.
Some device drivers create a label containing only a
single large partition if a disk is unlabeled; thus, the label must
be written to the
.Sq a
partition of the disk while it is open.
This sometimes requires the desired label to be set in two steps,
the first one creating at least one other partition, and the second
setting the label on the new partition while shrinking the
.Sq a
partition.
.Pp
On some machines the bootstrap code may not fit entirely in the
area allocated for it by some filesystems.
As a result, it may
not be possible to have filesystems on some partitions of a
.Dq bootable
disk.
When installing bootstrap code,
.Nm
checks for these cases.
If the installed boot code would overlap a partition of type
.Dv FS_UNUSED
it is marked as type
.Dv FS_BOOT .
The
.Xr newfs 8
utility will disallow creation of filesystems on
.Dv FS_BOOT
partitions.
Conversely, if a partition has a type other than
.Dv FS_UNUSED
or
.Dv FS_BOOT ,
.Nm
will not install bootstrap code that overlaps it.
.Sh SEE ALSO
.Xr disklabel 5 ,
.Xr disktab 5 ,
.Xr scan_ffs 8
.Sh CAVEATS
The maximum disk and partition size is 64PB.
.Pp
On some machines, such as Sparc64, partition tables
may not exhibit the full functionality described above.
@


1.120
log
@provide missing unit suffixes; from ross l richardson
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.119 2016/09/01 12:19:35 jmc Exp $
d36 1
a36 1
.Dd $Mdocdate: September 1 2016 $
a159 5
For operations other than displaying a partition the
.Ql %
(percent of total) and
.Ql &
(percent of free) units are also accepted.
d268 2
a269 1
Quantities will be rounded to the nearest
d272 7
d287 1
a287 3
At prompts that request a size,
.Ql *
may be entered to indicate the rest of the available space.
@


1.119
log
@remove sparc reference;
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.118 2015/12/24 13:47:08 otto Exp $
d36 1
a36 1
.Dd $Mdocdate: December 24 2015 $
d557 1
a557 1
swap		80-256M	10%
d563 1
a563 1
/usr/src	1-2G	2%
@


1.118
log
@tweak auto-allocation description, with and ok jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.117 2015/10/16 04:20:54 miod Exp $
d36 1
a36 1
.Dd $Mdocdate: October 16 2015 $
d647 1
a647 1
On some machines, such as Sparc and Sparc64, partition tables
@


1.117
log
@Remove -B from EXAMPLES; reminded by jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.116 2015/10/15 19:31:15 miod Exp $
d36 1
a36 1
.Dd $Mdocdate: October 15 2015 $
d508 4
a511 3
Each partition is allocated its minimum and remaining space
is split between the partitions up to their maximum allowed space,
which is a fixed percentage.
@


1.116
log
@Remove disklabel -B (NUMBOOT) support. All the platforms which used to need
it are now using MI installboot for that purpose.

ok krw@@ deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.115 2015/05/19 18:50:39 sobrado Exp $
d36 1
a36 1
.Dd $Mdocdate: May 19 2015 $
a599 21
.Pp
Install a new bootstrap on sd0.
The boot code comes from
.Pa /usr/mdec/sdboot
and possibly
.Pa /usr/mdec/bootsd .
On-disk and in-core labels are unchanged, but on some systems other
information may be destroyed.
Use with care.
.Pp
.Dl # disklabel -B sd0
.Pp
Install a new label and bootstrap.
The label is derived from disktab information for
.Dq sd2212
and installed both in-core and
on-disk.
The bootstrap code comes from the file
.Pa /usr/mdec/newboot .
.Pp
.Dl # disklabel -w -B /dev/rsd0c -b newboot sd2212
@


1.115
log
@improve spacing in disklabel template.
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.114 2015/04/29 16:56:31 henning Exp $
d36 1
a36 1
.Dd $Mdocdate: April 29 2015 $
a69 20
.Pp
.Nm disklabel
.Fl B\ \&
.Op Fl nv
.Op Fl b Ar boot1
.Ar disk
.Op Ar disktype
.Nm disklabel
.Fl Bw
.Op Fl nv
.Op Fl b Ar boot1
.Ar disk Ar disktype
.Op Ar packid
.Nm disklabel
.Fl BR
.Op Fl nv
.Op Fl b Ar boot1
.Op Fl F Ns | Ns Fl f Ar file
.Ar disk Ar protofile
.Op Ar disktype
a109 9
.It Fl B
Install bootstrap code.
Some architectures instead require bootstrap code installation to be
done using an
.Xr installboot 8
type program, as described in
.Xr boot 8 .
.It Fl b Ar boot1
Specify the primary boot program.
a463 32
.Pp
When installing bootstrap code with the
.Fl B
flag, if the boot program name is not explicitly given with
.Fl b Ar boot1 ,
a standard boot program
will be used.
The standard boot programs are located in
.Pa /usr/mdec .
The name of the program is taken from the
.Dq b0
parameter of the
.Xr disktab 5
entry for the disk if
.Ar disktype
was given and its disktab entry exists and includes a b0 field.
Otherwise, the boot program name is derived from the name of the
disk.
These names are of the form
.Pa basename Ns boot .
For example,
.Pa /usr/mdec/sdboot
if the disk device is
.Em sd0 .
.Pp
The first of the three boot-installation forms is used to install
bootstrap code without changing the existing label.
It is essentially a read command with respect to the disk label itself
and all options are related to the specification of the boot program
as described previously.
The final two forms are analogous to the basic write and restore versions
except that they will install bootstrap code in addition to a new label.
@


1.114
log
@some fine-tuning in SYNOPSIS, usage, and order of options, with jmc
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.113 2015/04/29 09:58:16 henning Exp $
d620 1
a620 1
/usr		900M-2G 5%
@


1.113
log
@support passing a template file for the auto-allocation to disklabel.
template gives mountpoints, min-max size ranges and percentage of disk
foremost intended for autoinstalls, installer bits to follow soon.
with input from many, ok theo
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.112 2015/02/28 21:51:57 bentley Exp $
d36 1
a36 1
.Dd $Mdocdate: February 28 2015 $
d45 1
a46 1
.Op Fl h | p Ar unit
d62 1
a63 1
.Op Fl F Ns | Ns Fl f Ar file
a198 4
.It Fl t
Format the label as a
.Xr disktab 5
entry.
d206 4
@


1.112
log
@Reduce usage of predefined strings in manpages.

Predefined strings are not very portable across troff implementations,
and they make the source much harder to read. Usually the intended
character can be written directly.

No output changes, except for two instances where the incorrect escape
was used in the first place.

tweaks + ok schwarze@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.111 2014/07/16 13:46:30 deraadt Exp $
d36 1
a36 1
.Dd $Mdocdate: July 16 2014 $
d45 1
d51 1
d57 1
d62 1
d203 7
d603 23
@


1.111
log
@Yes /etc/disklabels/ is a good practice for placing labels of disks
in case of catastropy.  But it is so poorly documented that any admin
is more likely to store the labels elsewhere, so let's stop bothering
with providing the directory.  Discussed a bit, no objections.
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.110 2014/05/07 18:55:52 krw Exp $
d36 1
a36 1
.Dd $Mdocdate: May 7 2014 $
d307 1
a307 1
.It Cm \&? \*(Ba h
@


1.110
log
@jmc@@ points out '-F/-f' are available only in conjunction with
'-E' and '-R'.
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.109 2014/05/05 16:33:34 krw Exp $
d36 1
a36 1
.Dd $Mdocdate: May 5 2014 $
a594 2
.It Pa /etc/disklabels
Directory for backup labels.
@


1.109
log
@Enhance reading of saved ascii labels (-R) to process mountpoint
information if present. Can be used with -F/-f options to create
an fstab from the saved label.

ok otto@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.108 2013/08/14 08:39:30 jmc Exp $
d36 1
a36 1
.Dd $Mdocdate: August 14 2013 $
a162 1
.Fl A ,
@


1.108
log
@some Bx/Ox conversion;
From: Jan Stary
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.107 2012/01/02 04:38:00 krw Exp $
d36 1
a36 1
.Dd $Mdocdate: January 2 2012 $
d64 1
d83 1
d163 1
d166 1
a166 1
.Fl A
@


1.107
log
@Remove more mentions of two stage boot loaders from man page.
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.106 2012/01/02 03:40:31 krw Exp $
d400 3
a402 1
Note that not all parameters are configurable for non-BSD partitions.
d513 3
a515 1
Note that when a disk has no real BSD disklabel, the kernel creates a
d525 2
a526 1
That means that subsequent changes that affect non-OpenBSD
@


1.106
log
@Tweak usage and man page into agreement.

There's nothing special about -c and -d requiring them to be
separated from other flags or specified as mutually exclusive. So
just show a single block of flags. Some flag combos are silly
but harmless.

Move all -B options inside NUMBOOT #if, eliminating confusing
duplication of -w and -R usage lines. And some string
declaration dancing.

Since we only have NUMBOOT = 1, no need to try and finesse
output for different values of NUMBOOT.

Line shit up.
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.105 2012/01/02 00:59:33 krw Exp $
a477 2
The bootstrap code is comprised of one or two boot programs,
depending on the machine.
d481 3
a483 1
flag, if the names are not explicitly given, standard boot programs
d485 1
a485 1
The boot programs are located in
d487 1
a487 1
The names of the programs are taken from the
d489 1
a489 3
and
.Dq b1
parameters of the
d493 2
a494 2
was given and its disktab entry exists and includes those parameters.
Otherwise, boot program names are derived from the name of the
d497 2
a498 6
.Pa basename Ns boot
for the primary
.Pq or only
bootstrap, and
.Pf boot Pa basename
for the secondary bootstrap; for example,
a499 2
and
.Pa /usr/mdec/bootsd
@


1.105
log
@'-s' hasn't done anything for a couple of years. Garbage collect
it and the associated 'bootxx' variable. Update man page accordingly.
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.104 2011/09/04 08:29:46 jmc Exp $
d36 1
a36 1
.Dd $Mdocdate: September 4 2011 $
d44 1
a44 2
.Op Fl c | d | t
.Op Fl Av
d49 1
a49 2
.Op Fl c | d
.Op Fl Anv
d54 1
a54 2
.Op Fl c | d
.Op Fl Anv
d58 1
a58 2
.Op Fl c | d
.Op Fl Anv
@


1.104
log
@grammar fix; from Martin Pelikan
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.103 2011/06/05 11:57:17 krw Exp $
d36 1
a36 1
.Dd $Mdocdate: June 5 2011 $
a73 1
.Op Fl s Ar boot2
a79 1
.Op Fl s Ar boot2
a85 1
.Op Fl s Ar boot2
d136 1
a136 3
Specify the single level boot program, or the primary boot program,
depending on the system boot architecture
.Pq single or two-level .
a196 4
.It Fl s Ar boot2
On machines with a two-level bootstrap
.Pq such as i386-based systems ,
specify the secondary boot program.
@


1.103
log
@Nuke uses of and references to DIOCWLABEL, and the related 'W' and
'N' command line options.

ok matthew@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.102 2011/05/23 08:40:56 otto Exp $
d36 1
a36 1
.Dd $Mdocdate: May 23 2011 $
d166 1
a166 1
The entries will written using disklabel UIDs.
@


1.102
log
@sync auto-allocation table
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.101 2011/05/22 17:47:44 otto Exp $
d36 1
a36 1
.Dd $Mdocdate: May 22 2011 $
a68 4
.Nm disklabel
.Fl N | W
.Op Fl nv
.Ar disk
a182 2
.It Fl N
Disallow writing of the pack label area on the selected disk.
a212 2
.It Fl W
Allow writing of the pack label area on the selected disk.
a485 11
.Pp
The sixth form of the command
.Pq protect
is used to control write access to the label area of a disk
so that the label cannot be inadvertently overwritten.
The
.Fl N
and
.Fl W
options are only available on architectures that support this feature,
such as vax, hp300 and some sparc models.
@


1.101
log
@sync auto-allocation table with code
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.100 2011/04/30 14:48:39 jmc Exp $
d36 1
a36 1
.Dd $Mdocdate: April 30 2011 $
d608 2
a609 2
/usr/src	 3% of disk.   1G \(en 2G
/usr/obj	 3% of disk.   1G \(en 2G
@


1.100
log
@change one of our current examples to use duids; ken suggested we use
-E rather than -e as it's more likely;

ok krw
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.99 2011/04/19 14:20:37 halex Exp $
d36 1
a36 1
.Dd $Mdocdate: April 19 2011 $
d599 1
a599 1
.Sy Disks \*(Gt 6.5 Gigabytes
d605 1
a605 1
/usr		 2% of disk. 600M \(en 2G
d607 1
a607 1
/usr/local	 5% of disk.   2G \(en 6G
d610 1
a610 1
/home		53% of disk.   1G \(en 300G
@


1.99
log
@Rename the argument for -f and -F from 'tempfile' to 'file'

ok krw@@ and looks correct to jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.98 2011/04/16 23:07:19 krw Exp $
d36 1
a36 1
.Dd $Mdocdate: April 16 2011 $
d651 2
a652 2
Read the on-disk label for sd0, edit it and reinstall in-core as
well as on-disk.
d655 1
a655 1
.Dl # disklabel -e sd0
@


1.98
log
@Tweak description of -F to eliminate implication that mount points
must be input by user to get into the -F|-f output. Any known
mount point - user entered, read from fstab or static ('none' for
swap partitions) - will get into the tempfile.
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.97 2011/04/16 16:05:53 krw Exp $
d63 1
a63 1
.Op Fl F Ns | Ns Fl f Ar tempfile
d164 1
a164 1
.It Fl F Ar tempfile
d166 1
a166 1
.Ar tempfile
d179 1
a179 1
.Ar tempfile
d181 1
a181 1
.It Fl f Ar tempfile
@


1.97
log
@jmc@@ is merciless. But fair.
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.96 2011/04/16 14:51:00 krw Exp $
d169 1
a169 2
format for any partitions for which mount point information has been
specified.
@


1.96
log
@Tweak man page and usage string with jmc@@ suggestions.
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.95 2011/04/16 11:44:41 krw Exp $
d63 1
a63 1
.Op Fl F|-f Ar tempfile
@


1.95
log
@Add '-F'. Same as '-f' but uses DUIDs when writing the mount point
information to the specified file. After every label write, read the
label to get current UID info.

Some internal code cleanup with no intended functional change.

ok deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.94 2010/09/23 17:16:01 jmc Exp $
d36 1
a36 1
.Dd $Mdocdate: September 23 2010 $
d63 1
a63 1
.Op Fl f | F Ar tempfile
d164 1
a164 1
.It Fl f Ar tempfile
d171 1
d173 1
a173 1
.Fl f
d182 1
a182 1
.It Fl F Ar tempfile
d184 2
a185 2
.Fl f
except that UIDs are written instead of disk device names.
@


1.94
log
@tweak the disklabel uid stuff; ok jsing
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.93 2010/04/28 17:26:46 jsing Exp $
d36 1
a36 1
.Dd $Mdocdate: April 28 2010 $
d63 1
a63 1
.Op Fl f Ar tempfile
d175 3
a177 1
flag.
d181 4
@


1.93
log
@Add a new 'i' command to the disklabel interactive editor, allowing the
disklabel UID to be changed.

ok krw@@ marco@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.91 2010/04/21 03:35:41 lum Exp $
d36 1
a36 1
.Dd $Mdocdate: April 21 2010 $
d221 2
a222 1
It can be specified either by its full pathname or an abbreviated disk form.
d393 1
a393 1
Change the disklabel UID, specified as a 16 character hexadecimal string.
@


1.92
log
@zap trailing whitespace;
@
text
@d391 4
@


1.91
log
@Remove interactive help for individual disklabel editor commands.
These were in effect a duplication of the man page contents. The man page
has been updated to include any small ommissions that were in the
interactive help. Man page tweaks/suggestions from jmc@@ and deraadt@@.
ok jmc@@ deraadt@@ krw@@ otto@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.90 2010/04/14 20:15:11 jmc Exp $
d36 1
a36 1
.Dd $Mdocdate: April 14 2010 $
d319 1
a319 1
.It Cm \&? \*(Ba h  
d353 1
a353 1
Note: data may become corrupted if boundaries are extended such 
d395 1
a395 1
The manual page is piped through the pager specified by the 
d398 1
a398 1
.Ev PAGER 
@


1.90
log
@neccessary -> necessary;
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.89 2010/04/14 15:19:27 lum Exp $
d296 2
d299 4
a302 2
.Sq g
for gigabytes.
d319 1
a319 1
.It Cm ?\& Op Ar command
a320 3
A
.Em command
may be specified to get more detailed help.
d331 1
a331 1
This option adds a new BSD partition.
d353 2
d395 5
d468 1
a468 1
Exit the editor without saving any changes to the label.
d470 2
a471 1
Zero out the existing partition table and mountpoint information.
@


1.89
log
@Remove reference to a limitation of 8GB that does not exist anymore.
ok krw@@ otto@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.88 2010/03/23 18:43:06 jmc Exp $
d36 1
a36 1
.Dd $Mdocdate: March 23 2010 $
d428 1
a428 1
The last partition will be shrunk if neccessary.
@


1.88
log
@tweak previous; ok otto
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.87 2010/03/23 14:32:34 otto Exp $
d350 1
a350 1
This is useful for disks larger than 8 gigabytes where the
@


1.87
log
@introducing 'R': interactive command to customize auto allocated labels,
by growing or shrinking them as desired. can use some tweaks, but
committing now to be able to work in-tree; ok krw@@ lum@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.86 2009/07/27 12:39:50 jmc Exp $
d36 1
a36 1
.Dd $Mdocdate: July 27 2009 $
d426 1
a426 1
Resize a partition in an auto allocated label,
d428 2
a429 2
The last partition will be shrunk if needed.
Works only for auto allocated labels with no spoofed partitions.
@


1.86
log
@add a section on automatic disk allocation, to give an idea of
how -A and A will carve up your disk;

help/ok krw deraadt
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.85 2009/06/02 16:23:45 krw Exp $
d36 1
a36 1
.Dd $Mdocdate: June 2 2009 $
d425 5
@


1.85
log
@Add '-h' flag, and '*' as a unit specifier for 'p' Editor command.
Both cause partition sizes to be displayed using a human readable
format with the units automatically chosen by looking at the smallest
partition in the disk label. Remove forceable humanization in 'A'
code and use '-h' in install scripts.

Prodded & ok deraadt@@, verbiage tweaks from jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.84 2009/05/31 00:14:55 krw Exp $
d36 1
a36 1
.Dd $Mdocdate: May 31 2009 $
d132 3
d325 3
d548 53
@


1.84
log
@'-d' works everywhere now. And it ignores the OpenBSD disk label,
not OpenBSD partitions.
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.83 2009/04/10 20:54:08 krw Exp $
d36 1
a36 1
.Dd $Mdocdate: April 10 2009 $
d46 1
a46 1
.Op Fl p Ar unit
d176 2
d184 1
a184 1
Print partition sizes and offsets in
d411 4
@


1.83
log
@Re-work '-A' so that it sets a flag that -E and -w use, and which will
just display the auto-allocation plan otherwise. Don't overwrite any
spoofed partitions, insert auto allocated partitions where we can.

This is much more install script and weird architecture friendly. I'm
talking about you, macppc.

Many suggestions and code from otto@@, feedback from many, cattle
prod applied by deraadt@@.

ok deraadt@@
"if it works for >8GB ... put it in" miod@@
"to be clear, ok" todd@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.82 2009/04/01 06:44:01 jmc Exp $
d36 1
a36 1
.Dd $Mdocdate: April 1 2009 $
d152 1
a152 3
partitions on the disk.
Note that this option will only work for disks
that are capable of reporting their geometry, such as SCSI, IDE, and ESDI.
@


1.82
log
@the note explaining partition letters is not a caveat, it is integral to
the way disklabel works; move it into DESCRIPTION

ok krw
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.81 2009/03/31 11:33:47 krw Exp $
d36 1
a36 1
.Dd $Mdocdate: March 31 2009 $
d45 1
a45 1
.Op Fl v
d51 1
a51 1
.Op Fl nv
d57 1
a57 1
.Op Fl nv
d129 3
a131 2
If no disklabel is found,
allocate all the disk space in the recommended manner.
@


1.81
log
@Beef up description of 'c' partition in CAVEATS and remove mentions of
'c' from descriptions of d(elete) and z(ero) commands.

Feedback from jmc@@

Slightly different version ok jmc@@ deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.80 2009/03/31 00:32:25 krw Exp $
d106 20
a637 20
.Nm
supports 15 configurable partitions,
.Sq a
through
.Sq p ,
excluding
.Sq c .
The
.Sq c
partition describes the entire physical disk, is automatically created
by the kernel, and cannot be modified or deleted by
.Nm .
By convention, the
.Sq a
partition of the boot disk is the root partition, and the
.Sq b
partition of the boot disk is the swap partition,
but all other letters can be used in any order for any other
partitions as desired.
.Pp
@


1.80
log
@Remove lies about and tweak descriptions of built-in label editor,
a.k.a. '-E'.

Feedback from otto@@ jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.79 2009/03/30 10:40:41 krw Exp $
d36 1
a36 1
.Dd $Mdocdate: March 30 2009 $
a341 3
The
.Ql c
partition cannot be deleted.
d426 1
a426 3
Zeroes out the existing partition table, leaving only the
.Sq c
partition.
d627 3
a629 1
partition is reserved for the entire physical disk.
@


1.79
log
@Document new 'U' editor command.

Prodded by & ok jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.78 2009/03/28 23:47:31 krw Exp $
d36 1
a36 1
.Dd $Mdocdate: March 28 2009 $
d135 1
a135 2
Use a simple initial label editor, using the command-driven built-in
editor described below.
d259 1
a259 1
The initial label editor mode
d261 1
a261 2
is only intended for new disks as it will move partitions around as necessary
to maintain a contiguous pool of free blocks.
@


1.78
log
@Verbiage tweaks from jmc@@ and millert@@.
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.77 2009/03/28 14:40:20 deraadt Exp $
d410 2
@


1.77
log
@the CAVEAT about -B is described earlier; ok jmc
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.76 2009/03/28 14:03:21 deraadt Exp $
d643 2
a644 2
On some machines, such as the sparc, partition tables
may not exhibit the full functionality that is described above.
@


1.76
log
@point out that -B does not exist on some machines, and installboot(8) is
used instead, ok krw jmc
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.75 2009/03/28 13:54:15 krw Exp $
a622 10
On architectures which have it,
.Xr installboot 8
is normally used to install boot code.
The
.Fl B
option to
.Nm
can still be used to install old style boot code,
but this usage is deprecated.
.Pp
@


1.75
log
@As Tobias Ulmer pointed out on tech@@, Tahoe behaviour no longer is
of concern so BUGS need not mention it. The other BUGS are also now
irrelevant or not bugs at all. So delete entire BUGS section. Also
tweak a bit of verbiage.

ok deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.74 2009/03/23 16:36:38 jmc Exp $
d36 1
a36 1
.Dd $Mdocdate: March 23 2009 $
d113 5
@


1.74
log
@tweak the description of -A a little more;
feedback/ok krw
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.73 2009/03/22 20:51:58 jmc Exp $
d36 1
a36 1
.Dd $Mdocdate: March 22 2009 $
a627 3
On some machines, such as the sparc, partition tables
may not exhibit the full functionality that is described above.
.Pp
d629 1
a629 1
only supports up to a maximum of 15 partitions,
d647 3
a649 19
.Sh BUGS
When a disk name is given without a full pathname, the constructed
device name uses the
.Sq a
partition on the tahoe, the
.Sq c
partition on all others.
In
.Fl E
mode,
.Nm
is far too quick to shuffle partitions around; it should keep a
free block list and only move partitions around with the user's
permission.
Also, in
.Fl E
mode, partitions outside the
.Ox
portion of the disk should be changeable.
@


1.73
log
@tweak previous;
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.72 2009/03/22 19:01:32 krw Exp $
d109 2
a110 3
If no disklabel is found on entering the Editor, prime label as if the
.Cm A
command had been entered.
@


1.72
log
@Add 'A' command to Editor mode, and -A flag to automatically execute it
on disks without an existing label. The 'A' command allocates all space
on the disk into a reasonable partition scheme for a root disk.

Feedback from several, time to work on it in-tree.

Prodded (repeatedly) by and ok deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.71 2008/08/10 13:00:25 sobrado Exp $
d36 1
a36 1
.Dd $Mdocdate: August 10 2008 $
a60 1
.Op Fl A
d62 1
a62 1
.Op Fl nv
d110 2
a111 1
'A' command had been entered.
@


1.71
log
@spacing; remove non-existent flag from synopsis.
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.70 2008/08/10 11:22:40 sobrado Exp $
d61 1
d109 3
d297 2
@


1.70
log
@add missing space.

ok krw@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.69 2008/06/25 18:31:07 otto Exp $
d36 1
a36 1
.Dd $Mdocdate: June 25 2008 $
d67 1
a67 1
.Op Fl nrv
@


1.69
log
@In interactive mode, always suggest offsets and sizes inside the
OpenBSD area and change the 'p' command to only print the boundaries
and size of the OpenBSD area and the free space within that area.
Introduce a 'l' command to print the header only. With krw@@; ok krw@@
deraadt@@; jmc@@ for the man page bits
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.68 2008/04/06 20:18:54 krw Exp $
d36 1
a36 1
.Dd $Mdocdate: April 6 2008 $
a344 1
.Sm off
a345 1
.Sm on
@


1.68
log
@Remove stray '-r' reference that survived the nuke of -r.
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.67 2008/03/23 19:42:17 krw Exp $
d36 1
a36 1
.Dd $Mdocdate: March 23 2008 $
d358 2
d382 1
a382 1
Print the current disk label.
@


1.67
log
@Nuke disklabel -r. All labels come from the kernel via ioctl.

"make sense" miod@@ ok deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.66 2008/01/25 15:30:11 otto Exp $
d36 1
a36 1
.Dd $Mdocdate: January 25 2008 $
a109 5
The
.Fl r
flag is implied by
.Fl B
and never needs to be specified.
@


1.66
log
@document maximum partition size; ok jmc@@ krw@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.65 2008/01/08 23:46:54 krw Exp $
d36 1
a36 1
.Dd $Mdocdate: January 8 2008 $
d44 1
a44 1
.Op Fl c | d | r | t
d50 1
a50 1
.Op Fl c | d | r
d56 1
a56 1
.Op Fl c | d | r
d61 1
a61 1
.Op Fl c | d | r
a121 3
May not be used in conjunction with the
.Fl r
flag.
a130 3
May not be used in conjunction with the
.Fl r
flag.
a175 9
.It Fl r
Causes the label to be read from or written to the disk directly,
rather than going through the system's in-core copy of the label.
This option may allow a label to be installed on a disk without kernel
support for a label, such as when labels are first installed on a
system.
This flag does not work on a number of architectures, thus it is
not considered the right way to put a new label on a disk.
Its use is discouraged.
d226 1
a226 3
Unless the
.Fl r
flag is given, the kernel's in-core copy of the label is displayed; if
d241 1
a241 9
If the
.Fl r
flag is given, the disk sectors containing the label and bootstrap
will be written directly.
A side-effect of this is that any existing
bootstrap code will be overwritten and the disk rendered unbootable.
If
.Fl r
is not specified, the existing label will be updated via the in-core
a242 4
If the disk does not already have a label, the
.Fl r
flag must be used.
In either case, the kernel's in-core label is replaced.
d246 2
a247 4
the label is read from the in-core kernel copy, or directly from the disk if the
.Fl r
flag is also given.
The label is formatted and then supplied to an editor for changes.
d255 1
a255 3
Existing bootstrap code is unchanged regardless of whether
.Fl r
was specified.
d437 1
a437 5
As with
.Fl w ,
any existing bootstrap code will be clobbered if
.Fl r
is specified and will be unaffected otherwise.
a538 3
(Normally you do not want to use the
.Fl r
flag though.)
d540 1
a540 1
.Dl # disklabel -w -r /dev/rsd0c sd2212 foo
a543 4
(Normally you do not want to use the
.Fl r
flag
though.)
d546 1
a546 1
.Dl # disklabel -e -r sd0
@


1.65
log
@Beef up the (r)ecalculate command in -E mode by having it display the
details of the free space it calculates. Gives an easy way to see all
the chunks of free sectors on the disk.

ok beck@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.64 2007/12/16 14:58:27 sobrado Exp $
d36 1
a36 1
.Dd $Mdocdate: December 16 2007 $
d170 2
a171 1
Valid units are b(ytes), c(ylinders), k(ilobytes), m(egabytes) and g(igabytes).
d692 2
@


1.64
log
@add missing arguments to "-b" and "-s"

ok jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.63 2007/06/02 08:02:51 jmc Exp $
d36 1
a36 1
.Dd $Mdocdate: June 2 2007 $
d428 2
a429 1
This option should really not be necessary under normal circumstances.
@


1.63
log
@installboot not just for i386; ok krw
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.62 2007/05/31 19:19:43 jmc Exp $
d36 1
a36 1
.Dd $Mdocdate: May 31 2007 $
d115 1
a115 1
.It Fl b
d190 1
a190 1
.It Fl s
@


1.62
log
@convert to new .Dd format;
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.61 2007/04/26 22:42:11 krw Exp $
d36 1
a36 1
.Dd $Mdocdate$
d660 1
a660 1
On i386 machines,
@


1.61
log
@Eliminate CPU_BIOS from userland and wd(4) by always using the BIOS
geometry in the disklabel when there is a BIOS geometry to provide.
This removes the option to set a disklabel to 'BIOS' geometry via the
'g b' command in the editor.

Makes reported geometry more consistant and moves MD code to MD land
where it should be.

Doc help from jmc@@, Feedback from millert@@, marco@@, weingart@@,
kettenis@@.

ok deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.60 2006/05/16 05:41:25 stevesk Exp $
d36 1
a36 1
.Dd October 27, 1997
@


1.60
log
@change only use of slice to 'partition letter' to be consistent with
use of partition everywhere else; ok jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.59 2005/03/07 23:41:53 jmc Exp $
d383 1
a383 1
.Op Ar b | d | u
d387 1
a387 2
.Em BIOS ,
.Em disk ,
@


1.59
log
@more macro simplification;
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.58 2004/10/25 08:14:46 otto Exp $
d214 1
a214 1
and the slice, can all be omitted.
@


1.58
log
@typo, from Nathan Rickerby
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.57 2003/12/30 10:54:33 jmc Exp $
d53 1
a53 1
.Oo Ar packid Oc
d80 1
a80 1
.Oo Ar disktype Oc
@


1.57
log
@s/inadvertantly/inadvertently;
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.56 2003/12/29 19:51:34 millert Exp $
d212 1
a212 1
donating
@


1.56
log
@Add support for % and & units to indicate percent of total space and
percent of available space respectively.  From Sebastian Horzela.
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.55 2003/12/20 09:29:27 jmc Exp $
d478 1
a478 1
so that the label cannot be inadvertantly overwritten.
@


1.55
log
@make disklabel docs more readable: more logical SYNOPSIS; sort options;
make internal editor help and usage() match the docs; make sure all the
forms described in SYNOPSIS are explained; various other tweaks.

input from millert@@; ok deraadt;
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.54 2003/09/02 18:30:27 jmc Exp $
d171 5
@


1.54
log
@escape punctuation;
ok deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.53 2003/06/21 23:14:23 jmc Exp $
d44 2
a45 2
.Op Fl n
.Op Fl cd Li \&| Fl r
a46 2
.Op Fl t
.Op Fl v
d50 2
a51 3
.Op Fl n
.Op Fl cd Li \&| Fl r
.Op Fl v
d56 2
a57 3
.Op Fl n
.Op Fl cd Li \&| Fl r
.Op Fl v
d61 2
a63 3
.Op Fl n
.Op Fl cd Li \&| Fl r
.Op Fl v
d67 1
a67 3
.Op Fl r
.Op Fl n
.Op Fl v
d70 2
a71 3
.Op Fl NW
.Op Fl n
.Op Fl v
d75 3
a77 5
.Fl B
.Op Fl n
.Op Fl v
.Oo
.Fl b Ar boot1
a78 1
.Oc
d82 3
a84 6
.Fl w
.Fl B
.Op Fl n
.Op Fl v
.Oo
.Fl b Ar boot1
a85 1
.Oc
d87 1
a87 1
.Oo Ar packid Oc
d89 3
a91 6
.Fl R
.Fl B
.Op Fl n
.Op Fl v
.Oo
.Fl b Ar boot1
a92 1
.Oc
d94 1
a94 1
.Oo Ar disktype Oc
d100 3
a102 3
The disk label contains information about disk characteristics (size,
type, etc.) and the partition layout, stored on the disk
itself.
a107 14
.It Fl n
Make no permanent changes to the disklabel (useful for debugging
purposes).
.It Fl v
Print additional information during operation (verbose mode).
.It Fl r
Causes the label to be read from or written to the disk directly,
rather than going through the system's in-core copy of the label.
This option may allow a label to be installed on a disk without kernel
support for a label, such as when labels are first installed on a
system.
This flag does not work on a number of architectures, thus it is
not considered the right way to put a new label on a disk.
Its use is discouraged.
d117 8
a124 4
depending on the system boot architecture (single or two-level).
.It Fl s
On machines with a two-level bootstrap (such as i386-based systems),
specify the secondary boot program.
d137 9
a145 6
.It Fl c
Clear the system's in-core copy of the label and update it based on
the on-disk label.
May not be used in conjunction with the
.Fl r
flag.
d161 5
d170 1
a170 17
Valid units are b(ytes), c(ylinders), k(ilobytes), m(egabytes) and
g(igabytes).
.It Fl t
Format the label as a
.Xr disktab 5
entry.
.It Fl w
Write a standard label on the designated drive.
.It Fl e
Edit an existing disk label using the editor specified in the
.Ev EDITOR
environment variable, or
.Xr vi 1
if none is specified.
.It Fl E
Use a simple initial label editor, using the command-driven built-in
editor described below.
d176 20
a195 2
.It Fl N
Disallow writing of the pack label area on the selected disk.
d198 30
d230 3
a232 3
The first form of the command (read) is used to examine the label on
the named disk drive (e.g., sd0 or
.Pa /dev/rsd0c ) .
d241 3
a243 2
The second form of the command (write) is used to write a standard
label on the designated drive.
d267 3
a269 2
In the third form of the command (edit), the label is read from the
in-core kernel copy, or directly from the disk if the
d284 4
a287 3
The initial label editor mode is only intended for new disks as it
will move partitions around as necessary to maintain a contiguous pool
of free blocks.
d302 2
a303 1
cylinder when units are specified for sizes (or offsets).
d306 1
a306 1
(Control-D).
d317 1
a317 1
.It \&? Op command
d319 1
a319 1
You may specify a
d321 11
a331 23
for which to get more detailed help.
There is also (simple) context-sensitive help available at most prompts.
.It M
Display this manual page.
.It u
Undo (or redo) last change.
Entering
.Em u
once will undo your last change.
Entering it again will restore the change.
.It p Op unit
Print the current disk label.
If a
.Em unit
is given, the size and offsets are displayed in terms of the
specified unit.
.It e
Edit drive parameters.
This option is used to set the following
parameters: sectors/track, tracks/cylinder, sectors/cylinder,
number of cylinders on the disk, total sectors on the disk, rpm,
interleave, disk type, and a descriptive label string.
.It b
d338 3
a340 3
This option is
probably only useful for ports with fdisk partition tables where the
ending sector in the MBR is incorrect.
d345 5
a349 14
prompt to indicate the entire size of the disk (minus
the starting sector).
This is useful for disks larger than 8
gigabytes where the fdisk partition table is incapable of storing
the real size.
.It r
Recalculate free space.
This option should really not be necessary under normal circumstances.
.It a Op part
Add new partition.
This option adds a new BSD partition.
If no partition letter is specified (a-p), the user will be prompted for
one.
.It c Op part
d358 4
a361 1
.It d Op part
d366 1
a366 1
You may not delete the
d368 13
a380 2
partition.
.It g Op d|b|u
d382 1
a383 1
.Em BIOS ,
d391 3
a393 4
.It D
Sets the disk label to the default values as reported by the kernel.
This simulates the case where there is no disk label.
.It m Op part
d397 8
a404 5
the user to change the filesystem type, starting offset, partition
size, block fragment size, block size, and cylinders per group for
the specified partition (not all parameters are configurable for
non-BSD partitions).
.It n Op part
d412 14
a425 1
.It s Op path
d428 1
a428 2
format (suitable for loading via
the
d432 9
a440 1
.It w
d443 1
a443 7
.It q
Quit the editor.
If any changes have been made, the user will be
asked whether or not to save the changes to the on-disk label.
.It x
Exit the editor without saving any changes to the label.
.It X
d446 5
a450 3
By default, some settings are reserved for experts only (such as the
block and fragment size on ffs partitions).
.It z
d452 1
a452 1
.Dq c
d457 4
a460 3
In the restore form of the command, the prototype file used to create
the label should be in the same format as that produced when reading
or editing a label.
d462 1
a462 1
.Ar \&#
d470 11
d485 2
a486 2
The bootstrap code is comprised of one or two boot
programs depending on the machine.
d507 3
a509 1
for the primary (or only) bootstrap, and
d520 5
a524 7
It is essentially
a read command with respect to the disk label itself and all options
are related to the specification of the boot program as described
previously.
The final two forms are analogous to the basic write and
restore versions except that they will install bootstrap code in
addition to a new label.
d526 1
a526 1
Note that when a disk has no real BSD disklabel the kernel creates a
d537 2
a538 2
partitions will not be present in the default label, though you
may update them by hand.
a543 1
You can then run
d545 1
a545 1
with the
d547 1
a547 2
flag and paste any entries you want from the default label into the real
one.
d550 2
d553 1
d555 1
d557 1
a559 2
.Li # disklabel sd0
.Pp
d561 1
a561 1
.Pa /dev/rsd0c .
d563 1
a563 1
.Li # disklabel -w -r /dev/rsd0c sd2212 foo
d574 1
a574 1
.Li # disklabel -e -r sd0
d584 1
a584 1
.Li # disklabel -R sd0 mylabel
d590 1
a590 1
.Li # disklabel -B sd0
d601 1
a601 1
.Li # disklabel -w -B /dev/rsd0c -b newboot sd2212
d610 2
d655 1
a655 1
.Sh NOTES
d668 1
a668 1
.Sh CAVEATS
@


1.53
log
@add CAVEATS: disklabel only supports 15 partitions, excluding `c';
from a thread on misc@@;

wording, help, and ok nick@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.52 2003/06/03 13:16:08 jmc Exp $
d302 1
a302 1
.It ? Op command
@


1.52
log
@- section reorder
- some mdoc fixes
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.51 2003/06/02 20:06:14 millert Exp $
d627 18
@


1.51
log
@Remove the advertising clause in the UCB license which Berkeley
rescinded 22 July 1999.  Proofed by myself and Theo.
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.50 2003/03/12 20:12:36 deraadt Exp $
d221 1
a221 1
.Pa /dev/rsd0c Ns ).
d512 6
a570 10
.Sh FILES
.Bl -tag -width Pa -compact
.It Pa /etc/disktab
.It Pa /usr/mdec/ Ns Em xx Ns boot
.It Pa /usr/mdec/boot Ns Em xx
.El
.Sh SEE ALSO
.Xr disklabel 5 ,
.Xr disktab 5 ,
.Xr scan_ffs 8
d610 4
@


1.50
log
@more .Li
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.49 2003/02/13 00:10:39 tedu Exp $
d18 1
a18 5
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgement:
.\"	This product includes software developed by the University of
.\"	California, Berkeley and its contributors.
.\" 4. Neither the name of the University nor the names of its contributors
@


1.49
log
@add support for printing disklabels in units other than sectors from
the cmdline
based on a patch by mho at mho.nu
ok and input by millert@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.48 2003/02/01 16:29:52 jmc Exp $
d517 1
a517 1
.Cm # disklabel sd0
d522 1
a522 1
.Cm # disklabel -w -r /dev/rsd0c sd2212 foo
d533 1
a533 1
.Cm # disklabel -e -r sd0
d543 1
a543 1
.Cm # disklabel -R sd0 mylabel
d549 1
a549 1
.Cm # disklabel -B sd0
d560 1
a560 1
.Cm # disklabel -w -B /dev/rsd0c -b newboot sd2212
@


1.48
log
@typos;
chat(8): removed reference to uucico(8)

ok deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.47 2002/12/31 16:22:25 miod Exp $
d50 1
d191 6
@


1.47
log
@Prepare for the removal of amiga and sun3 platforms from the tree.
There has not been enough activity and interest towards these platform
to keep them lying in the tree.
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.46 2002/11/14 02:57:27 deraadt Exp $
d488 1
a488 1
they are supported on your architechture.
@


1.46
log
@use $ or # before commands in examples
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.45 2002/09/18 07:33:47 deraadt Exp $
d622 1
a622 1
On some machines, such as the sparc and amiga, partition tables
@


1.45
log
@fix Xr refs; frisco@@blackant.net
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.44 2002/07/27 13:31:30 aaron Exp $
d510 1
a510 1
.Dl disklabel sd0
d515 1
a515 1
.Dl disklabel -w -r /dev/rsd0c sd2212 foo
d526 1
a526 1
.Dl disklabel -e -r sd0
d536 1
a536 1
.Dl disklabel -R sd0 mylabel
d542 1
a542 1
.Dl disklabel -B sd0
d553 1
a553 1
.Dl disklabel -w -B /dev/rsd0c -b newboot sd2212
@


1.44
log
@Typo; similates -> simulates
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.43 2001/12/13 20:16:48 mpech Exp $
d571 1
a571 1
.Xr scan_ffs 5
@


1.43
log
@o) start new sentence on a new line;
o) wrap long lines;
o) fix bogus .Xr usage;
o) we don't like blank lines;
o) always close .Bl tags;
o) OpenBSD -> .Ox;
o) don't like .Pp before .Ss;

millert@@ ok;
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.42 2001/08/17 11:13:57 mpech Exp $
d382 1
a382 1
This similates the case where there is no disk label.
@


1.42
log
@o) {Open,Net,Free}BSD -> .{O,N,F}x;
o) "start sentence on new line" issues;
o) minimal -mdoc improvements;

millert@@ ok
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.41 2001/08/07 01:46:12 millert Exp $
d424 2
a425 1
partition.  The drive parameters are not changed.
@


1.41
log
@o Fix a typo (heko@@iki.fi)
o Add text about default labels
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.40 2001/02/04 15:06:05 deraadt Exp $
d326 3
a328 1
Set OpenBSD disk boundaries.
d639 3
a641 2
mode, partitions outside the OpenBSD portion of the disk should
be changeable.
@


1.40
log
@mention scan_ffs; map@@infinitum.ch
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.39 2001/01/24 09:52:24 deraadt Exp $
d444 1
a444 1
When installting bootstrap code with the
d481 25
@


1.39
log
@mention that sparc & amiga have weird partition tables
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.38 2000/11/09 17:52:53 aaron Exp $
d542 2
a543 1
.Xr disktab 5
@


1.38
log
@Change all option list specifications to ".Bl -tag -width Ds". Most man
pages just needed their -width parameter tweaked to "Ds", which provides
a nice width of 6 constant characters. For consistency more than anything.
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.37 2000/06/04 18:19:45 millert Exp $
d592 3
@


1.37
log
@Add 'D' and 'z' commands to editor to use the default partition and
to zero out the partition table respectively.
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.36 2000/04/04 16:29:27 millert Exp $
d129 1
a129 1
.Bl -tag -width -indent
@


1.36
log
@Add "expert mode" and don't prompt for fsize/bsize/cpg unless an expert

next_offset() now takes a pointer to the partition size as its second
argument instead of a pointer to the partition.  This allows us to
get the offset earlier on and sort_partitions() will not try and
include the partition we are trying to create in its list.

In free_chunks() start looking for things at starting_sector, not 0,
to avoid getting starting offsets that precede the start of the OpenBSD
part of the disk.
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.35 2000/03/18 22:55:55 aaron Exp $
d378 3
d419 4
@


1.35
log
@Remove hard sentence breaks, and some other cleanup along the way.
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.34 1999/10/10 16:49:28 aaron Exp $
d411 5
@


1.34
log
@Tweak.
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.33 1999/10/09 21:05:57 angelos Exp $
d121 2
a122 1
pack. The disk label contains information about disk characteristics (size,
d124 2
a125 1
itself. It is used by the operating system to optimize disk I/O and
d137 2
a138 2
rather than going through the system's in-core copy of the label. This
option may allow a label to be installed on a disk without kernel
d140 4
a143 3
system. This flag does not work on a number of architectures, thus it is
not considered the right way to put a new label on a disk. Its use is
discouraged.
d145 2
a146 1
Install bootstrap code. The
d160 2
a161 1
label.  This ignores any existing
d163 4
a166 3
partitions on the disk. Note that this option will only work for disks
that are capable of reporting their geometry, such as SCSI, IDE, and
ESDI. May not be used in conjunction with the
d171 2
a172 1
the on-disk label. May not be used in conjunction with the
d181 2
a182 1
specified. The
d186 2
a187 1
flag. If
d216 1
a216 1
The first form  of the command (read) is used to examine the label on
d228 3
a230 2
label on the designated drive. The drive parameters and partitions are
taken from that file. If different disks of the same physical type are
d233 5
a237 3
installation as described below. The optional argument is a pack
identification string, up to 16 characters long. The pack ID must be
quoted if it contains blanks. If the
d240 2
a241 1
will be written directly. A side-effect of this is that any existing
d246 2
a247 2
copy and any bootstrap code will be unaffected. If the disk does not
already have a label, the
d249 2
a250 2
flag must be used. In either case, the kernel's in-core label is
replaced.
d255 3
a257 2
flag is also given. The label is formatted and then supplied to an
editor for changes. If no editor is specified in an
d261 4
a264 3
is used. When the editor terminates, the formatted label is reread and
used to rewrite the disk label. Existing bootstrap code is unchanged
regardless of whether
d270 2
a271 1
of free blocks. Some commands or prompts take an optional unit.
d283 4
a286 3
for gigabytes.  Quantities will be rounded to the nearest
cylinder when units are specified for sizes (or offsets).  Commands
may be aborted by entering
d293 2
a294 1
prompt will exit the editor.  At prompts that request a size,
d300 2
a301 1
Display help message with all available commands.  You may specify a
d303 2
a304 2
for which to get more detailed help.  There is also (simple)
context-sensitive help available at most prompts.
d308 2
a309 1
Undo (or redo) last change.  Entering
d311 2
a312 1
once will undo your last change.  Entering it again will restore the change.
d314 2
a315 1
Print the current disk label.  If a
d320 3
a322 2
Edit drive parameters.  This option is used to set the following
parameters:  sectors/track, tracks/cylinder, sectors/cylinder,
d326 2
a327 1
Set OpenBSD disk boundaries.  This option tells
d329 2
a330 1
which parts of the disk it is allowed to modify.  This option is
d332 2
a333 1
ending sector in the MBR is incorrect.  The user may enter
d338 2
a339 1
the starting sector).  This is useful for disks larger than 8
d343 2
a344 2
Recalculate free space.  This option should really not be necessary
under normal circumstances.
d346 3
a348 2
Add new partition.  This option adds a new BSD partition.  If no
partition letter is specified (a-p), the user will be prompted for
d351 3
a353 2
Change the size of an existing partition.  If no partition is
specified, the user will be prompted for one.  The new size may be
d362 3
a364 2
to delete all partitions).  If no partition is specified, the
user will be prompted for one.  You may not delete the
d379 3
a381 2
Modify parameters for an existing partition.  If no partition is
specified, the user will be prompted for one.  This option allows
d387 3
a389 3
Name the mount point for an existing partition.  If no partition is
specified, the user will be prompted for one.  This option is only
valid if
d400 2
a401 2
option).  If no path is specified, the user will be prompted for
one.
d403 2
a404 2
Write the label to disk.  This option will commit any changes to
the on-disk label.
d406 2
a407 1
Quit the editor.  If any changes have been made, the user will be
d415 2
a416 1
or editing a label. Comments are delimited by
d418 2
a419 1
and newline. As with
d428 2
a429 1
part of the label. The bootstrap code is comprised of one or two boot
d435 2
a436 1
will be used. The boot programs are located in
d448 2
a449 1
disk.  These names are of the form
d461 2
a462 1
bootstrap code without changing the existing label. It is essentially
d465 2
a466 1
previously. The final two forms are analogous to the basic write and
a468 6
.Sh FILES
.Bl -tag -width Pa -compact
.It Pa /etc/disktab
.It Pa /usr/mdec/ Ns Em xx Ns boot
.It Pa /usr/mdec/boot Ns Em xx
.El
d481 2
a482 2
Any existing bootstrap code will be clobbered.  (Normally you do
not want to use the
d489 2
a490 1
well as on-disk.  (Normally you do not want to use the
d493 2
a494 1
though.)  Existing bootstrap code is unaffected.
d504 2
a505 1
Install a new bootstrap on sd0.  The boot code comes from
d510 2
a511 1
information may be destroyed.  Use with care.
d515 2
a516 2
Install a new label and bootstrap.  The label is derived from
disktab information for
d519 2
a520 1
on-disk.  The bootstrap code comes from the file
d522 6
d534 2
a535 1
it is open.  Some device drivers create a label containing only a
d547 2
a548 1
area allocated for it by some filesystems.  As a result, it may
d551 2
a552 1
disk.  When installing bootstrap code,
d554 2
a555 2
checks for these cases.  If the installed boot code would overlap
a partition of type
d573 2
a574 1
is normally used to install boot code.  The
d586 2
a587 1
partition on all others.  In
d593 2
a594 1
permission.  Also, in
@


1.33
log
@Reformat. Aaron will probably change this three-times over, but it's a
start.
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.32 1999/08/14 15:11:11 millert Exp $
d118 1
d120 5
a124 5
can be used to install, examine, or modify the label on a disk drive or
pack. The disk label is information about disk characteristics (size,
type, etc.) and partition layout of the disk, stored on the disk
itself. It is used by the operating system to optimize disk I/O, and
to locate the filesystems resident on the disk.
d126 1
a126 1
The following options are available:
d138 2
a139 2
system. This flag does not work on a number of architecture, thus it is
not considered the right wa to put a new label on a disk. Its use is
@


1.32
log
@Add -c flag that uses DIOCRLDINFO to clear (and update) the in-core label.
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.31 1999/07/04 18:59:38 aaron Exp $
d119 23
a141 18
can be used to install, examine or modify the label on a disk drive or pack.
When writing the label, it can be used
to change the drive identification,
the disk partitions on the drive,
or to replace a damaged label.
On some systems,
.Nm
can be used to install bootstrap code as well.
There are several forms of the command that read (display), install or edit
the label on a disk.
Each form has an additional option,
.Fl r ,
which causes the label to be read from or written to the disk directly,
rather than going through the system's in-core copy of the label.
This option may allow a label to be installed on a disk
without kernel support for a label, such as when labels are first installed
on a system; it must be used when first installing a label on a disk.
The specific effect of
d143 1
a143 2
is described under each command.
The read and install forms also support the
d145 9
a153 15
option to install bootstrap code.
These variants are described later.
.Pp
In all cases you can specify
.Fl n
to operate in no change mode to avoid committing any permanent changes.
The
.Fl v
flag can be used to make
.Nm
be more verbose about what it is doing.
.Pp
When reading or editing a label, you may also specify the
.Fl d
option to use the
d157 8
a164 11
partitions on the disk.  Note that this option will only work for
disks that are capable of reporting their geometry, such as SCSI,
IDE, and ESDI.
Additionally, the
.Fl c
flag may be used to clear the system's in-core copy of the label
and update it based on the on-disk label.  Note that the
.Fl d
and
.Fl c
flags may not be used in conjuction with the
d167 38
d206 2
a207 2
The first form of the command (read) is used to examine the label on the named
disk drive (e.g. sd0 or
d213 12
a224 31
flag is given,
the kernel's in-core copy of the label is displayed;
if the disk has no label, or the partition types on the disk are incorrect,
the kernel may have constructed or modified the label.
If the
.Fl r
flag is given, the label from the raw disk will be displayed rather
than the in-core label.
If the
.Fl t
flag is given, then the label will be formatted as a
.Xr disktab 5
entry.
.Pp
The second form of the command, with the
.Fl w
flag, is used to write a standard label on the designated drive.
The required arguments to
.Nm
are the drive to be labeled (e.g. sd0), and
the drive type as described in the
.Xr disktab 5
file.
The drive parameters and partitions are taken from that file.
If different disks of the same physical type are to have different
partitions, it will be necessary to have separate disktab entries
describing each, or to edit the label after installation as described below.
The optional argument is a pack identification string,
up to 16 characters long.
The pack ID must be quoted if it contains blanks.
If the
d227 2
a228 3
will be written directly.
A side-effect of this is that any existing bootstrap code will be overwritten
and the disk rendered unbootable.
d231 3
a233 4
is not specified,
the existing label will be updated via the in-core copy and any bootstrap
code will be unaffected.
If the disk does not already have a label, the
d235 2
a236 2
flag must be used.
In either case, the kernel's in-core label is replaced.
d238 2
a239 5
An existing disk label may be edited by using the
.Fl e
flag.
The label is read from the in-core kernel copy,
or directly from the disk if the
d241 2
a242 3
flag is also given.
The label is formatted and then supplied to an editor for changes.
If no editor is specified in an
d246 3
a248 4
is used.
When the editor terminates, the formatted label is reread
and used to rewrite the disk label.
Existing bootstrap code is unchanged regardless of whether
d252 4
a255 34
With the
.Fl R
flag,
.Nm
is capable of restoring a disk label that was formatted
in a prior operation and saved in an
.Tn ASCII
file.
The prototype file used to create the label should be in the same format
as that produced when reading or editing a label.
Comments are delimited by
.Ar \&#
and newline.
As with
.Fl w ,
any existing bootstrap code will be clobbered if
.Fl r
is specified and will be unaffected otherwise.
.Pp
The
.Fl NW
flags for
.Nm
explicitly disallow and
allow, respectively, writing of the pack label area on the selected disk.
.Pp
The
.Fl E
flag to
.Nm
will drop you into a simple initial label editor.  This mode is
only intended for new disks as it will move partitions around as
necessary to maintain a contiguous pool of free blocks.  Some commands
or prompts take an optional unit.  Available units are
d380 9
a388 16
The
.Fl f Ar tempfile
flag to
.Nm
is only valid when used in conjunction with the
.Fl E
flag.  When the
.Fl f
flag is specified,
.Nm
will write entries to
.Ar tempfile
in
.Xr fstab 5
format for any partitions for which mount point information has been
specified.
d392 5
a396 3
are used to install bootstrap code on machines where the bootstrap
is part of the label.  The bootstrap code is comprised of one or
two boot programs depending on the machine.  The
d398 2
a399 19
option is used to denote that bootstrap code is to be installed.
The
.Fl r
flag is implied by
.Fl B
and never needs to be specified.  The name of the boot program(s)
to be installed can be selected in a variety of ways.  First, the
names can be specified explicitly via the
.Fl b
and
.Fl s
flags.  On machines with only a single level of boot program,
.Fl b
is the name of that program.  For machines with a two-level bootstrap,
.Fl b
indicates the primary boot program and
.Fl s
the secondary boot program.  If the names are not explicitly given,
standard boot programs will be used.  The boot programs are located in
d423 1
a423 1
bootstrap code without changing the existing label.  It is essentially
d426 3
a428 3
previously.  The final two forms are analogous to the basic write
and restore versions except that they will install bootstrap code
in addition to a new label.
@


1.31
log
@trash some old leftover macros and replace them with -mdoc macros
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.30 1999/05/23 14:11:14 aaron Exp $
d49 1
a49 1
.Op Fl d Li \&| Fl r
d56 1
a56 1
.Op Fl d Li \&| Fl r
d63 1
a63 1
.Op Fl d Li \&| Fl r
d70 1
a70 1
.Op Fl d Li \&| Fl r
d161 5
a165 1
IDE, and ESDI.  Also note that the
d167 3
a169 1
flag may not be used in conjuction with the
@


1.30
log
@remove argument from .Os macros so value in /usr/share/tmac/mdoc/doc-common
is used instead; kwesterback@@home.com
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.29 1999/04/07 22:57:25 millert Exp $
d84 1
a84 1
.sp
d244 3
a246 1
in a prior operation and saved in an ASCII file.
d273 1
a273 1
.Dq b
d275 1
a275 1
.Dq c
d277 1
a277 1
.Dq k
d279 1
a279 1
.Dq m
d282 1
a282 1
.Dq g
d285 7
a291 2
may be aborted by entering ^D (Control-D).  Entering ^D at the main
.Dq \&>
d293 1
a293 1
.Dq \&*
d324 1
a324 1
.Dq \&*
d342 1
a342 1
.Dq +
d344 1
a344 1
.Dq -
d348 1
a348 1
.Dq *
d351 1
a351 1
.Dq c
d380 3
a382 1
Save the label to a file in ASCII format (suitable for loading via
d531 1
a531 1
.Dq a
d536 1
a536 1
.Dq a
d546 5
a550 1
a partition of type FS_UNUSED it is marked as type FS_BOOT.  The
d552 7
a558 3
utility will disallow creation of filesystems on FS_BOOT partitions.
Conversely, if a partition has a type other than FS_UNUSED or
FS_BOOT,
d573 1
a573 1
.Dq a
d575 1
a575 1
.Dq c
@


1.29
log
@Kill -F option, it is not needed and just plain wrong anyway
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.28 1999/03/25 15:34:54 espie Exp $
d42 1
a42 1
.Os BSD 4.2
@


1.28
log
@typo
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.27 1999/03/23 05:18:49 millert Exp $
a68 1
.Op Fl F
a388 2
.Fl F
and
d390 1
a390 1
flags to
d392 1
a392 1
are only valid when used in conjunction with the
d403 1
a403 4
specified.  The
.Fl F
flag indicates that the entire disk is to be used for
.Ox .
@


1.27
log
@Rename -F option to -f and add a new -F (full disk) option to use in -E mode.
When checking for an MBR, only say we have an mbr if there is a signature *or*
there is an fdisk partition with an {Open,Free,Net}BSD ID.
When setting the bounds in -E mode add hueristics to deal with disks
bigger than the BIOS geometry would indicate.
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.26 1999/03/16 04:47:15 millert Exp $
d285 1
a285 1
.Dq \&<
@


1.26
log
@Add -F flag to cause editor to prompt for mount points and save the resulting info in fstab format.  To be used by the install script.
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.25 1999/03/13 19:07:35 millert Exp $
d68 2
a69 1
.Op Fl F Ar tempfile
d347 11
d371 1
a371 1
.Fl F
d390 4
a393 2
.Fl F Ar tempfile
flag to
d395 1
a395 1
is only valid in conjunction with the
d397 3
a399 1
flag.  When specified,
d406 4
a409 1
specified.
@


1.25
log
@Add support for delete "*"
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.24 1999/03/01 01:50:45 millert Exp $
d68 1
d353 8
d376 15
@


1.24
log
@Change undocumented '-p' flag to '-d' and document.  Also document '-v'.
Make 'disklabel -ed' not overwrite your label if you make no changes
in the editor (added a cmplabel function to compare two labels).
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.23 1998/12/15 01:20:28 aaron Exp $
d339 3
a341 1
Delete an existing partition.  If no partition is specified, the
@


1.23
log
@always give .Nm macros an argument in SYNOPSIS sections; krw@@tcn.net
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.22 1998/11/28 19:56:17 aaron Exp $
a47 1
.Op Fl r
d49 1
d51 1
a54 1
.Op Fl r
d56 2
a61 1
.Op Fl r
d63 2
a67 1
.Op Fl r
d69 2
d76 1
d81 1
d87 1
d98 1
d109 1
d146 19
@


1.22
log
@kill redundant .Nm macro arguments; other misc fixes
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.21 1998/11/11 22:19:56 aaron Exp $
d47 1
a47 1
.Nm
d52 1
a52 1
.Nm
d58 1
a58 1
.Nm
d63 1
a63 1
.Nm
d68 1
a68 1
.Nm
d73 1
a73 1
.Nm
d78 1
a78 1
.Nm
d87 1
a87 1
.Nm
d97 1
a97 1
.Nm
@


1.21
log
@more `` '' -> .Dq sillyness; remove redundant .Pp macros; other misc fixes
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.20 1998/09/23 01:20:22 aaron Exp $
d47 1
a47 1
.Nm disklabel
d52 1
a52 1
.Nm disklabel
d58 1
a58 1
.Nm disklabel
d63 1
a63 1
.Nm disklabel
d68 1
a68 1
.Nm disklabel
d73 1
a73 1
.Nm disklabel
d78 1
a78 1
.Nm disklabel
d87 1
a87 1
.Nm disklabel
d97 1
a97 1
.Nm disklabel
d108 1
a108 1
.Nm disklabel
d115 1
a115 1
.Nm disklabel
d163 1
a163 1
.Nm disklabel
d213 1
a213 1
.Nm disklabel
d230 1
a230 1
.Nm disklabel
d237 1
a237 1
.Nm disklabel
d284 1
a284 1
.Nm disklabel
d339 1
a339 1
.Nm disklabel
d468 1
a468 1
.Nm disklabel
d475 1
a475 1
.Nm disklabel
d483 1
a483 1
.Nm disklabel
d495 1
a495 1
.Nm disklabel
@


1.20
log
@alphabetize SEE ALSO entries and order them numerically according to section
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.19 1998/09/17 04:14:51 aaron Exp $
d139 2
a140 1
disk drive (e.g. sd0 or /dev/rsd0c).
d241 11
a251 2
or prompts take an optional unit.  Available units are 'b' for
bytes, 'c' for cylinders, 'k' for kilobytes, 'm' for megabytes, 'g'
d254 4
a257 2
may be aborted by entering ^D (Control-D).  Entering ^D at the main '<'
prompt will exit the editor.  At prompts that request a size, '*'
d287 5
a291 2
ending sector in the MBR is incorrect.  The user may enter '*' at
the ``Size'' prompt to indicate the entire size of the disk (minus
d306 4
a309 1
\'+' or '-' to change the size by a relative amount.
d312 3
a314 1
user will be prompted for one.  You may not delete the ``c'' partition.
d364 4
a367 1
The names of the programs are taken from the ``b0'' and ``b1''
d406 3
a408 2
Create a label for sd0 based on information for ``sd2212'' found
in
d441 3
a443 1
disktab information for ``sd2212'' and installed both in-core and
d454 3
a456 1
be written to the ``a'' partition of the disk while it is open.
d459 2
a460 1
setting the label on the new partition while shrinking the ``a''
d466 2
a467 1
``bootable'' disk.  When installing bootstrap code,
d488 4
a491 1
device name uses the ``a'' partition on the tahoe, the ``c''
@


1.19
log
@sbin/ man page fixes
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.18 1998/08/06 18:08:09 millert Exp $
d421 2
a422 2
.Xr disktab 5 ,
.Xr disklabel 5
@


1.18
log
@Mention new extened help and some minor cleanups
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.17 1998/07/24 17:40:43 millert Exp $
d108 1
a108 1
.Nm Disklabel
d173 1
a173 1
The pack id must be quoted if it contains blanks.
d214 1
a214 1
in a prior operation and saved in an ascii file.
d303 1
a303 1
Save the label to a file in ascii format (suitable for loading via
d305 1
a305 1
.Op -R
d312 1
a312 1
Quit the editor.  If any changes have been made the user will be
d387 3
a389 1
not want to use the -r flag though.)
d394 3
a396 1
well as on-disk.  (Normally you do not want to use the -r flag
d465 1
a465 1
permission.  Also in
d468 1
a468 1
be changeable..
@


1.17
log
@fix typos; Aaron Campbell <aaron@@ug.cs.dal.ca>
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.16 1998/04/08 03:00:44 millert Exp $
d249 4
a252 2
.It ?
Display help message with all available commands.  There is (simple)
d257 3
a259 3
Undo (or redo) last change.  Undo will reset the disklabel to the
state before the last command that modified it.
.\" bad sentence!
d267 3
a269 3
parameters:  bytes/sector, sectors/track, tracks/cylinder,
sectors/cylinder, number of cylinders, total sectors on the disk,
rpm, disk type, and a descriptive label string.
d277 3
a279 3
the starting sector).  This is useful for large disks where the
fdisk partition table is incapable of storing the real size.
.\" What is this limit?  [somewhere between 8 and 9 gig]
d294 1
a294 1
user will be prompted for one.
@


1.16
log
@mention 'r' in -E mode
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.15 1998/03/01 06:43:27 johns Exp $
d163 1
a163 1
are the drive to be labelled (e.g. sd0), and
d239 1
a239 1
necessary to maintain a contiguous pool of free blocks.  Some command
d271 1
a271 1
which parts of the disk it is allow to modify.  This option is
d276 1
a276 1
fdisk partition table is incapable if storing the real size.
d283 1
a283 1
partion letter is specified (a-p), the user will be prompted for
d286 1
a286 1
Change the size of an existing partition.  If no parition is
d291 1
a291 1
Delete an existing partition.  If no parition is specified, the
d294 1
a294 1
Modify parameters for an existing partition.  If no parition is
d296 1
a296 1
the user to change the filesystem type, starting offset, parition
d318 1
a318 1
are used to install boostrap code on machines where the bootstrap
d462 1
a462 1
be changable.
@


1.15
log
@disklabel.8 man page fixes submitted by Aaron Jackson,
jackson@@msrce.howard.edu
2 formatting changes, and 2 grammar changes.
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.14 1998/02/20 20:57:50 deraadt Exp $
d278 3
@


1.14
log
@' is special in column 0
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.13 1998/02/20 10:29:00 deraadt Exp $
d241 2
a242 2
bytes, 'c' for cylinders, 'k' for kilobytes, 'm' for megabytes,
'g' for gigabytes.  Quantities will be rounded to the nearest
d244 3
a246 3
may be aborted by entering ^D (Control-D).  Entering ^D at the main
'<' prompt will exit the editor.  At prompts that request a size,
'*' may be entered to indicate the rest of the available space.
d272 1
a272 1
probably only useful ports with fdisk partition tables where the
d305 1
a305 1
the label to the on-disk label.
@


1.13
log
@grammar
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.12 1997/12/20 22:35:19 rees Exp $
d286 1
a286 1
'+' or '-' to change the size by a relative amount.
@


1.12
log
@Refer i386 users to installboot(8).
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.11 1997/11/25 00:36:23 millert Exp $
d285 1
a285 1
in terms the aforementioned units and may also be prefixed with
@


1.11
log
@Add -t flag to output in disktab format.  From Christos Zoulas
<christos@@deshaw.com> plus correct code for outputing d_drivedata.
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.10 1997/10/28 06:01:09 millert Exp $
d438 9
@


1.10
log
@Replace a set of "'s with `` '' so that manual.c will build.
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.9 1997/10/28 05:58:17 millert Exp $
d50 1
d152 5
@


1.9
log
@Document -E bugs
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.8 1997/10/28 05:52:26 millert Exp $
d268 1
a268 1
the "Size" prompt to indicate the entire size of the disk (minus
@


1.8
log
@Fix a few typos.
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.6 1997/10/15 09:08:26 deraadt Exp $
d435 10
a444 1
partition on all others.
@


1.7
log
@First cut at -E docs.  Perhaps this should go at the end?
@
text
@d40 1
a40 1
.Dd April, 19, 1994
d157 1
a157 1
are the drive to be labeled (e.g. sd0), and
d274 1
a274 1
partition letter is specified (a-p), the user will be prompted for
d277 1
a277 1
Change the size of an existing partition.  If no partition is
d282 1
a282 1
Delete an existing partition.  If no partition is specified, the
d285 1
a285 1
Modify parameters for an existing partition.  If no partition is
d287 1
a287 1
the user to change the filesystem type, starting offset, partition
d309 1
a309 1
are used to install bootstrap code on machines where the bootstrap
d331 1
a331 2
standard boot programs will be used.  The boot programs are located
in
d382 1
a382 1
though.) Existing bootstrap code is unaffected.
@


1.6
log
@provide a few hints to indicate that -r is evil
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.5 1997/10/02 00:09:06 millert Exp $
d63 5
d157 1
a157 1
are the drive to be labelled (e.g. sd0), and
d227 80
d309 3
a311 5
are used to install boostrap code on machines where the bootstrap is part
of the label.
The bootstrap code is comprised of one or two boot programs depending on
the machine.
The
d318 3
a320 4
and never needs to be specified.
The name of the boot program(s) to be installed can be selected in a
variety of ways.
First, the names can be specified explicitly via the
d324 1
a324 2
flags.
On machines with only a single level of boot program,
d326 1
a326 2
is the name of that program.
For machines with a two-level bootstrap,
d330 3
a332 3
the secondary boot program.
If the names are not explicitly given, standard boot programs will be used.
The boot programs are located in
d334 2
a335 2
The names of the programs are taken from the ``b0'' and ``b1'' parameters
of the
d340 2
a341 2
Otherwise, boot program names are derived from the name of the disk.
These names are of the form
d345 1
a345 2
for the secondary bootstrap;
for example,
d353 6
a358 6
bootstrap code without changing the existing label.
It is essentially a read command with respect to the disk label
itself and all options are related to the specification of the boot
program as described previously.
The final two forms are analogous to the basic write and restore versions
except that they will install bootstrap code in addition to a new label.
d373 2
a374 1
Create a label for sd0 based on information for ``sd2212'' found in
d376 2
a377 2
Any existing bootstrap code will be clobbered.  (Normally you do not
want to use the -r flag though.)
d381 3
a383 5
Read the on-disk label for sd0, edit it and reinstall in-core as well
as on-disk.
(Normally you do not
want to use the -r flag though.)
Existing bootstrap code is unaffected.
d393 1
a393 2
Install a new bootstrap on sd0.
The boot code comes from
d397 2
a398 3
On-disk and in-core labels are unchanged, but on some systems other information
may be destroyed.
Use with care.
d402 3
a404 4
Install a new label and bootstrap.
The label is derived from disktab information for ``sd2212'' and
installed both in-core and on-disk.
The bootstrap code comes from the file
d411 4
a414 4
to be decreased or the offset of a partition to be changed while it is open.
Some device drivers create a label containing only a single large partition
if a disk is unlabeled; thus, the label must be written to the ``a''
partition of the disk while it is open.
d416 11
a426 14
the first one creating at least one other partition,
and the second setting the label on the new partition
while shrinking the ``a'' partition.
.Pp
On some machines the bootstrap code may not fit entirely in the area
allocated for it by some filesystems.
As a result, it may not be possible to have filesystems on some partitions
of a ``bootable'' disk.
When installing bootstrap code,
.Nm disklabel
checks for these cases.
If the installed boot code would overlap a partition of type FS_UNUSED
it is marked as type FS_BOOT.
The
d429 2
a430 1
Conversely, if a partition has a type other than FS_UNUSED or FS_BOOT,
d434 3
a436 3
When a disk name is given without a full pathname,
the constructed device name uses the ``a'' partition on the tahoe,
the ``c'' partition on all others.
@


1.5
log
@document disklabel -n
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.4 1997/05/30 07:48:44 deraadt Exp $
d296 2
a297 1
Any existing bootstrap code will be clobbered.
d303 2
@


1.4
log
@for i in `find . -name \*.[123456789] -exec grep '^.Dd ' {} /dev/null \; | \
	grep '"' | cut -d':' -f1`; do
sed -e '/^.Dd /s/"//g' -e '/^.Dd /s/\(^.Dd [A-Za-z]*\) \(.*\)$/\1, \2/' <$i >x
cat x > $i
done
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.3 1997/02/11 21:50:16 deraadt Exp $
d49 1
d54 1
d60 1
d65 1
d69 1
d74 1
d84 1
d94 1
d127 4
@


1.3
log
@document that -B may blow away important bits (on i386 it blows away MBR)
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.2 1996/06/23 14:30:05 deraadt Exp $
d40 1
a40 1
.Dd "April 19, 1994"
@


1.2
log
@update rcsid
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.9 1995/03/18 14:54:38 cgd Exp $
d305 3
a307 1
On-disk and in-core labels are unchanged.
@


1.1
log
@Initial revision
@
text
@d1 1
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@

