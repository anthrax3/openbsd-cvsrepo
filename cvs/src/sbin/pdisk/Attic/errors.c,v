head	1.12;
access;
symbols
	OPENBSD_5_8:1.7.0.24
	OPENBSD_5_8_BASE:1.7
	OPENBSD_5_7:1.7.0.16
	OPENBSD_5_7_BASE:1.7
	OPENBSD_5_6:1.7.0.20
	OPENBSD_5_6_BASE:1.7
	OPENBSD_5_5:1.7.0.18
	OPENBSD_5_5_BASE:1.7
	OPENBSD_5_4:1.7.0.14
	OPENBSD_5_4_BASE:1.7
	OPENBSD_5_3:1.7.0.12
	OPENBSD_5_3_BASE:1.7
	OPENBSD_5_2:1.7.0.10
	OPENBSD_5_2_BASE:1.7
	OPENBSD_5_1_BASE:1.7
	OPENBSD_5_1:1.7.0.8
	OPENBSD_5_0:1.7.0.6
	OPENBSD_5_0_BASE:1.7
	OPENBSD_4_9:1.7.0.4
	OPENBSD_4_9_BASE:1.7
	OPENBSD_4_8:1.7.0.2
	OPENBSD_4_8_BASE:1.7
	OPENBSD_4_7:1.6.0.14
	OPENBSD_4_7_BASE:1.6
	OPENBSD_4_6:1.6.0.16
	OPENBSD_4_6_BASE:1.6
	OPENBSD_4_5:1.6.0.12
	OPENBSD_4_5_BASE:1.6
	OPENBSD_4_4:1.6.0.10
	OPENBSD_4_4_BASE:1.6
	OPENBSD_4_3:1.6.0.8
	OPENBSD_4_3_BASE:1.6
	OPENBSD_4_2:1.6.0.6
	OPENBSD_4_2_BASE:1.6
	OPENBSD_4_1:1.6.0.4
	OPENBSD_4_1_BASE:1.6
	OPENBSD_4_0:1.6.0.2
	OPENBSD_4_0_BASE:1.6
	OPENBSD_3_9:1.3.0.16
	OPENBSD_3_9_BASE:1.3
	OPENBSD_3_8:1.3.0.14
	OPENBSD_3_8_BASE:1.3
	OPENBSD_3_7:1.3.0.12
	OPENBSD_3_7_BASE:1.3
	OPENBSD_3_6:1.3.0.10
	OPENBSD_3_6_BASE:1.3
	OPENBSD_3_5:1.3.0.8
	OPENBSD_3_5_BASE:1.3
	OPENBSD_3_4:1.3.0.6
	OPENBSD_3_4_BASE:1.3
	OPENBSD_3_3:1.3.0.4
	OPENBSD_3_3_BASE:1.3
	OPENBSD_3_2:1.3.0.2
	OPENBSD_3_2_BASE:1.3
	OPENBSD_3_1:1.2.0.6
	OPENBSD_3_1_BASE:1.2
	OPENBSD_3_0:1.2.0.4
	OPENBSD_3_0_BASE:1.2
	OPENBSD_2_9:1.2.0.2
	OPENBSD_2_9_BASE:1.2
	ver1:1.1.1.1
	apple19980218:1.1.1;
locks; strict;
comment	@ * @;


1.12
date	2016.01.12.20.14.38;	author krw;	state dead;
branches;
next	1.11;
commitid	JWQVepgnwVund2cm;

1.11
date	2016.01.12.15.32.08;	author krw;	state Exp;
branches;
next	1.10;
commitid	jkbr5rI0RhKaoKmr;

1.10
date	2016.01.11.23.56.45;	author krw;	state Exp;
branches;
next	1.9;
commitid	pus6iKESUy41gLNI;

1.9
date	2016.01.11.07.54.07;	author jasper;	state Exp;
branches;
next	1.8;
commitid	DI30r1mqHPQNkhTm;

1.8
date	2015.12.06.12.00.16;	author tobias;	state Exp;
branches;
next	1.7;
commitid	CoyY8UEEpJPwBza5;

1.7
date	2010.05.25.19.01.32;	author deraadt;	state Exp;
branches;
next	1.6;

1.6
date	2006.05.11.17.20.40;	author martin;	state Exp;
branches;
next	1.5;

1.5
date	2006.04.29.00.43.41;	author martin;	state Exp;
branches;
next	1.4;

1.4
date	2006.04.27.19.52.21;	author martin;	state Exp;
branches;
next	1.3;

1.3
date	2002.06.09.08.13.08;	author todd;	state Exp;
branches;
next	1.2;

1.2
date	2001.03.24.00.20.59;	author drahn;	state Exp;
branches;
next	1.1;

1.1
date	2001.03.24.00.14.03;	author drahn;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2001.03.24.00.14.03;	author drahn;	state Exp;
branches;
next	;


desc
@@


1.12
log
@Move unused files to attic.
@
text
@/*	$OpenBSD: errors.c,v 1.11 2016/01/12 15:32:08 krw Exp $	*/

//
// errors.c - error & help routines
//
// Written by Eryk Vershen
//

/*
 * Copyright 1996,1997,1998 by Apple Computer, Inc.
 *              All Rights Reserved
 *
 * Permission to use, copy, modify, and distribute this software and
 * its documentation for any purpose and without fee is hereby granted,
 * provided that the above copyright notice appears in all copies and
 * that both the copyright notice and this permission notice appear in
 * supporting documentation.
 *
 * APPLE COMPUTER DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE
 * INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
 * FOR A PARTICULAR PURPOSE.
 *
 * IN NO EVENT SHALL APPLE COMPUTER BE LIABLE FOR ANY SPECIAL, INDIRECT, OR
 * CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
 * LOSS OF USE, DATA OR PROFITS, WHETHER IN ACTION OF CONTRACT,
 * NEGLIGENCE, OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION
 * WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 */

// for *printf()
#include <stdio.h>
#include <errno.h>

// for exit()
#include <stdlib.h>
// for strrchr
#include <string.h>

// for va_start(), etc.
#include <stdarg.h>

#include "errors.h"


//
// Defines
//


//
// Types
//


//
// Global Constants
//


//
// Global Variables
//
extern char *__progname;


//
// Forward declarations
//


//
// Routines
//
void
do_help()
{
    printf("usage: %s [-hlr] disk\n", __progname);
/*
	{"debug",	no_argument,		0,	'd'},
	{"abbr",	no_argument,		0,	'a'},
	{"fs",		no_argument,		0,	'f'},
	{"logical",	no_argument,		0,	kLogicalOption},
	{"compute_size", no_argument,		0,	'c'},
*/
}


void
usage(const char *kind)
{
    error(-1, "bad usage - %s\n", kind);
    hflag = 1;
}


//
// Print a message on standard error and exit with value.
// Values in the range of system error numbers will add
// the perror(3) message.
//
void
fatal(int value, const char *fmt, ...)
{
    va_list ap;

    fprintf(stderr, "%s: ", __progname);
    va_start(ap, fmt);
    vfprintf(stderr, fmt, ap);
    va_end(ap);

    if (value > 0 && value < sys_nerr) {
	fprintf(stderr, "  (%s)\n", sys_errlist[value]);
    } else {
	fprintf(stderr, "\n");
    }
    exit(value);
}


//
// Print a message on standard error.
// Values in the range of system error numbers will add
// the perror(3) message.
//
void
error(int value, const char *fmt, ...)
{
    va_list ap;

    fprintf(stderr, "%s: ", __progname);
    va_start(ap, fmt);
    vfprintf(stderr, fmt, ap);
    va_end(ap);

    if (value > 0 && value < sys_nerr) {
	fprintf(stderr, "  (%s)\n", sys_errlist[value]);
    } else {
	fprintf(stderr, "\n");
    }
}
@


1.11
log
@Retire '-i', a poorly documented interactive mode that tries to
mimic the 20th century MacOS version of pdisk more closely than the
usual interactive editor. One set of commands is enough for anyone.

ok jasper@@
@
text
@d1 1
a1 1
/*	$OpenBSD: errors.c,v 1.10 2016/01/11 23:56:45 krw Exp $	*/
@


1.10
log
@More '-v' leftovers (usage).
@
text
@d1 1
a1 1
/*	$OpenBSD: errors.c,v 1.9 2016/01/11 07:54:07 jasper Exp $	*/
d77 1
a77 1
    printf("usage: %s [-hilr] disk\n", __progname);
@


1.9
log
@add rcs ids
@
text
@d1 1
a1 1
/*	$OpenBSD$	*/
d77 1
a77 1
    printf("usage: %s [-hilrv] disk\n", __progname);
@


1.8
log
@Use __progname instead of manually handling argv[0].

ok deraadt, mmcc, tedu
@
text
@d1 2
@


1.7
log
@use opendev(), as requested in 6373.  document this using text borrowed from
disklabel(8), and while at it, fix the usage code to not be utterly distasteful
ok drahn
@
text
@d61 1
a61 1
char *program_name;
a72 11
init_program_name(char **argv)
{
    if ((program_name = strrchr(argv[0], '/')) != (char *)NULL) {
	program_name++;
    } else {
	program_name = argv[0];
    }
}


void
d75 1
a75 1
    printf("usage: %s [-hilrv] disk\n", program_name);
d104 1
a104 1
    fprintf(stderr, "%s: ", program_name);
d128 1
a128 1
    fprintf(stderr, "%s: ", program_name);
@


1.6
log
@remove a bunch of linux and NeXT defines and, in turn, -D__unix__
@
text
@d86 1
a86 6
    printf("\t%s [-h]\n", program_name);
    printf("\t%s [-v]\n", program_name);
    printf("\t%s [-l] name [...]\n", program_name);
    printf("\t%s [-r] name ...\n", program_name);
    printf("\t%s [-i]\n", program_name);
    printf("\t%s name [...]\n", program_name);
@


1.5
log
@With last pdisk and full functionality for mac68k now in place, start
cleaning the maze of ifdef's not relevant for us.

This round wipes most linux and/or MacOS-only bits, more to come.
@
text
@a61 5
#ifdef NeXT
extern int errno;
extern int sys_nerr;
extern const char * const sys_errlist[];
#endif
a74 1
#if defined(__linux__) || defined(__unix__)
a79 3
#else
    program_name = "pdisk";
#endif
a124 1
#if defined(__linux__) || defined(NeXT) || defined(__unix__)
a129 4
#else
    fprintf(stderr, "\n");
    printf("Processing stopped: Choose 'Quit' from the file menu to quit.\n\n");
#endif
a148 1
#if defined(__linux__) || defined(NeXT) || defined(__unix__)
a153 3
#else
    fprintf(stderr, "\n");
#endif
@


1.4
log
@update for pdisk 0.8a2, from NetBSD, retaining our local changes;
summing it up:

- Clean up sources - fix naming, delete old email addresses
- Added support for display of Mac volume names
- Fix block 0 display to show logical offset of drivers
- Require confirmation of quit without write
- Fix iteration to not complain about missing devices
- Warn when creating/writing a map with more than 15 entries

and, most important, add do_update_dpme() which allows us to partition
OpenBSD slices without previous MacOS setup.

Tested with shared MacOS install on macppc, procedure there remains the
same.

grammer and spelling help and ok jmc@@

ok miod@@
@
text
@a32 1
#ifndef __linux__
a33 1
#endif
@


1.3
log
@rm trailing whitespace
@
text
@d4 1
a4 1
// Written by Eryk Vershen (eryk@@apple.com)
d30 1
d82 1
a82 1
#if defined(__linux__) || defined(__OpenBSD__)
a96 7
#ifndef __OpenBSD__
    printf("\t%s [-h|--help]\n", program_name);
    printf("\t%s [-v|--version]\n", program_name);
    printf("\t%s [-l|--list [name ...]]\n", program_name);
    printf("\t%s [-r|--readonly] name ...\n", program_name);
    printf("\t%s [-i|--interactive]\n", program_name);
#else
d99 1
a99 1
    printf("\t%s [-l [name ...]]\n", program_name);
d102 8
a109 2
#endif
    printf("\t%s name ...\n", program_name);
d114 1
a114 1
usage(char *kind)
d127 1
a127 1
fatal(int value, char *fmt, ...)
d136 1
a136 1
#if defined(__linux__) || defined(NeXT) || defined(__OpenBSD__)
a143 3
#endif

#if !defined(__linux__) && !defined(__OpenBSD__)
d156 1
a156 1
error(int value, char *fmt, ...)
d165 1
a165 1
#if defined(__linux__) || defined(NeXT) || defined(__OpenBSD__)
@


1.2
log
@Make the apple code compile for OpenBSD. These changes are mostly from maja.
@
text
@d9 17
a25 17
 *              All Rights Reserved 
 *  
 * Permission to use, copy, modify, and distribute this software and 
 * its documentation for any purpose and without fee is hereby granted, 
 * provided that the above copyright notice appears in all copies and 
 * that both the copyright notice and this permission notice appear in 
 * supporting documentation. 
 *  
 * APPLE COMPUTER DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE 
 * INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS 
 * FOR A PARTICULAR PURPOSE. 
 *  
 * IN NO EVENT SHALL APPLE COMPUTER BE LIABLE FOR ANY SPECIAL, INDIRECT, OR 
 * CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM 
 * LOSS OF USE, DATA OR PROFITS, WHETHER IN ACTION OF CONTRACT, 
 * NEGLIGENCE, OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION 
 * WITH THE USE OR PERFORMANCE OF THIS SOFTWARE. 
@


1.1
log
@Initial revision
@
text
@d81 1
a81 1
#ifdef __linux__
d96 1
d102 7
d136 1
a136 1
#if defined(__linux__) || defined(NeXT)
d146 1
a146 1
#ifndef __linux__
d168 1
a168 1
#if defined(__linux__) || defined(NeXT)
@


1.1.1.1
log
@Import of pdisk from apple, BSD licensed code. Archive dated Feb 18 1998 
This is a HFS partition editing tool.
@
text
@@
