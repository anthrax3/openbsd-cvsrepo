head	1.17;
access;
symbols
	OPENBSD_6_1_BASE:1.17
	OPENBSD_6_0:1.17.0.4
	OPENBSD_6_0_BASE:1.17
	OPENBSD_5_9:1.17.0.2
	OPENBSD_5_9_BASE:1.17
	OPENBSD_5_8:1.4.0.34
	OPENBSD_5_8_BASE:1.4
	OPENBSD_5_7:1.4.0.26
	OPENBSD_5_7_BASE:1.4
	OPENBSD_5_6:1.4.0.30
	OPENBSD_5_6_BASE:1.4
	OPENBSD_5_5:1.4.0.28
	OPENBSD_5_5_BASE:1.4
	OPENBSD_5_4:1.4.0.24
	OPENBSD_5_4_BASE:1.4
	OPENBSD_5_3:1.4.0.22
	OPENBSD_5_3_BASE:1.4
	OPENBSD_5_2:1.4.0.20
	OPENBSD_5_2_BASE:1.4
	OPENBSD_5_1_BASE:1.4
	OPENBSD_5_1:1.4.0.18
	OPENBSD_5_0:1.4.0.16
	OPENBSD_5_0_BASE:1.4
	OPENBSD_4_9:1.4.0.14
	OPENBSD_4_9_BASE:1.4
	OPENBSD_4_8:1.4.0.12
	OPENBSD_4_8_BASE:1.4
	OPENBSD_4_7:1.4.0.8
	OPENBSD_4_7_BASE:1.4
	OPENBSD_4_6:1.4.0.10
	OPENBSD_4_6_BASE:1.4
	OPENBSD_4_5:1.4.0.6
	OPENBSD_4_5_BASE:1.4
	OPENBSD_4_4:1.4.0.4
	OPENBSD_4_4_BASE:1.4
	OPENBSD_4_3:1.4.0.2
	OPENBSD_4_3_BASE:1.4
	OPENBSD_4_2:1.3.0.6
	OPENBSD_4_2_BASE:1.3
	OPENBSD_4_1:1.3.0.4
	OPENBSD_4_1_BASE:1.3
	OPENBSD_4_0:1.3.0.2
	OPENBSD_4_0_BASE:1.3
	OPENBSD_3_9:1.2.0.16
	OPENBSD_3_9_BASE:1.2
	OPENBSD_3_8:1.2.0.14
	OPENBSD_3_8_BASE:1.2
	OPENBSD_3_7:1.2.0.12
	OPENBSD_3_7_BASE:1.2
	OPENBSD_3_6:1.2.0.10
	OPENBSD_3_6_BASE:1.2
	OPENBSD_3_5:1.2.0.8
	OPENBSD_3_5_BASE:1.2
	OPENBSD_3_4:1.2.0.6
	OPENBSD_3_4_BASE:1.2
	OPENBSD_3_3:1.2.0.4
	OPENBSD_3_3_BASE:1.2
	OPENBSD_3_2:1.2.0.2
	OPENBSD_3_2_BASE:1.2
	OPENBSD_3_1:1.1.1.1.0.6
	OPENBSD_3_1_BASE:1.1.1.1
	OPENBSD_3_0:1.1.1.1.0.4
	OPENBSD_3_0_BASE:1.1.1.1
	OPENBSD_2_9:1.1.1.1.0.2
	OPENBSD_2_9_BASE:1.1.1.1
	ver1:1.1.1.1
	apple19980218:1.1.1;
locks; strict;
comment	@ * @;


1.17
date	2016.01.31.14.55.41;	author krw;	state Exp;
branches;
next	1.16;
commitid	ZjbTHa9TF7xtCAJm;

1.16
date	2016.01.29.14.54.38;	author krw;	state Exp;
branches;
next	1.15;
commitid	JxW4PE5GwpjH1Ttx;

1.15
date	2016.01.24.01.38.32;	author krw;	state Exp;
branches;
next	1.14;
commitid	g7Azk2rL78IOOfnI;

1.14
date	2016.01.23.23.25.58;	author krw;	state Exp;
branches;
next	1.13;
commitid	PPThwZCvKA3Y8sbd;

1.13
date	2016.01.22.00.38.53;	author krw;	state Exp;
branches;
next	1.12;
commitid	x0tMj8kuzhFIVdU1;

1.12
date	2016.01.19.14.50.40;	author krw;	state Exp;
branches;
next	1.11;
commitid	YKGwNSU9QoLkwIWa;

1.11
date	2016.01.18.21.50.53;	author krw;	state Exp;
branches;
next	1.10;
commitid	iCfrmMnzqdydi4ac;

1.10
date	2016.01.17.23.18.19;	author krw;	state Exp;
branches;
next	1.9;
commitid	vC4VO4mr30PnBRSq;

1.9
date	2016.01.17.19.39.20;	author krw;	state Exp;
branches;
next	1.8;
commitid	slCzBfkhwAcLWsXe;

1.8
date	2016.01.17.18.57.52;	author krw;	state Exp;
branches;
next	1.7;
commitid	Rl8zxjpMi2a93hiE;

1.7
date	2016.01.17.17.44.05;	author krw;	state Exp;
branches;
next	1.6;
commitid	ie6tS8cTDeRCB9yd;

1.6
date	2016.01.14.04.02.05;	author krw;	state Exp;
branches;
next	1.5;
commitid	oNnNZxQ1fbZJJMcx;

1.5
date	2016.01.11.07.54.07;	author jasper;	state Exp;
branches;
next	1.4;
commitid	DI30r1mqHPQNkhTm;

1.4
date	2007.12.09.23.35.22;	author chl;	state Exp;
branches;
next	1.3;

1.3
date	2006.04.27.19.52.21;	author martin;	state Exp;
branches;
next	1.2;

1.2
date	2002.06.09.08.13.08;	author todd;	state Exp;
branches;
next	1.1;

1.1
date	2001.03.24.00.14.03;	author drahn;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2001.03.24.00.14.03;	author drahn;	state Exp;
branches;
next	;


desc
@@


1.17
log
@Move dump_block() declaration from io.h to io.c since it is not
used anywhere else.

Remove declarations of non-existant kPatchType and init_partition_map().
@
text
@/*	$OpenBSD: dump.h,v 1.16 2016/01/29 14:54:38 krw Exp $	*/

/*
 * dump.h - dumping partition maps
 *
 * Written by Eryk Vershen
 */

/*
 * Copyright 1996,1997 by Apple Computer, Inc.
 *              All Rights Reserved
 *
 * Permission to use, copy, modify, and distribute this software and
 * its documentation for any purpose and without fee is hereby granted,
 * provided that the above copyright notice appears in all copies and
 * that both the copyright notice and this permission notice appear in
 * supporting documentation.
 *
 * APPLE COMPUTER DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE
 * INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
 * FOR A PARTICULAR PURPOSE.
 *
 * IN NO EVENT SHALL APPLE COMPUTER BE LIABLE FOR ANY SPECIAL, INDIRECT, OR
 * CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
 * LOSS OF USE, DATA OR PROFITS, WHETHER IN ACTION OF CONTRACT,
 * NEGLIGENCE, OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION
 * WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 */

#ifndef __dump__
#define __dump__

void	dump_partition_map(struct partition_map *);
void	full_dump_partition_entry(struct partition_map *, int);
void	full_dump_block_zero(struct partition_map *);
void	show_data_structures(struct partition_map *);

#endif /* __dump__ */
@


1.16
log
@Rename struct partition_map_header to struct partition_map. No change to
.o files.
@
text
@d1 1
a1 1
/*	$OpenBSD: dump.h,v 1.15 2016/01/24 01:38:32 krw Exp $	*/
a32 1
void	dump_block(unsigned char *, int);
@


1.15
log
@Whitespace fixes.
@
text
@d1 1
a1 1
/*	$OpenBSD: dump.h,v 1.14 2016/01/23 23:25:58 krw Exp $	*/
d34 4
a37 4
void	dump_partition_map(struct partition_map_header *);
void	full_dump_partition_entry(struct partition_map_header *, int);
void	full_dump_block_zero(struct partition_map_header *);
void	show_data_structures(struct partition_map_header *);
@


1.14
log
@Nuke unused kPatchType. Nuke kStringNot and use " not' where needed.
Nuke kStringEmpty and use "" where needed. Nuke unused static 'g'.

Eliminate #include's in *.h files.

Some whitespace fixes.
@
text
@d1 1
a1 1
/*	$OpenBSD: dump.h,v 1.13 2016/01/22 00:38:53 krw Exp $	*/
d33 5
a37 5
void dump_block(unsigned char *, int);
void dump_partition_map(struct partition_map_header *);
void full_dump_partition_entry(struct partition_map_header *, int);
void full_dump_block_zero(struct partition_map_header *);
void show_data_structures(struct partition_map_header *);
@


1.13
log
@Nuke 'expert' mode and the enabling, undocumented, '-d' flag by
just making all the commands available all the time. Document the
newly available commands.

Remove the former 'P' command (list partitions in base address
order) and use 'P' from expert mode (show map data structures).

Stop accepting uppercase aliases for commands documented as lower
case.

Bring the 'h' help text and man pages into agreement.

ok jasper@@ millert@@
@
text
@d1 1
a1 1
/*	$OpenBSD: dump.h,v 1.12 2016/01/19 14:50:40 krw Exp $	*/
a31 2

#include "partition_map.h"
@


1.12
log
@Bring code into line with man page and usage() by only allowing one
disk to be specified on the command line. Nuke dump() function and
hoist its few lines into main() as a result.
@
text
@d1 1
a1 1
/*	$OpenBSD: dump.h,v 1.11 2016/01/18 21:50:53 krw Exp $	*/
d36 1
a36 1
void dump_partition_map(struct partition_map_header *, int);
@


1.11
log
@The contents of the Apple_Patches partition is none of our business.
Stop pretending we care or know what's in there. Remove 'debugging'
mode command to examine the partition contents and the supporting
code.

ok deraadt@@ jasper@@
@
text
@d1 1
a1 1
/*	$OpenBSD: dump.h,v 1.10 2016/01/17 23:18:19 krw Exp $	*/
a34 1
int dump(char *);
@


1.10
log
@Change "//" comments to "/**/". Nuke really stupid ones.
@
text
@d1 1
a1 1
/*	$OpenBSD: dump.h,v 1.9 2016/01/17 19:39:20 krw Exp $	*/
a34 1
void display_patches(struct partition_map *);
@


1.9
log
@Reduce namespace pollution by eliminating parameter names from forward
declarations.
@
text
@d1 1
a1 1
/*	$OpenBSD: dump.h,v 1.8 2016/01/17 18:57:52 krw Exp $	*/
d3 5
a7 5
//
// dump.h - dumping partition maps
//
// Written by Eryk Vershen
//
@


1.8
log
@Remove a bunch of ridiculous and uninformative comments like "// Defines".
@
text
@d1 1
a1 1
/*	$OpenBSD: dump.h,v 1.7 2016/01/17 17:44:05 krw Exp $	*/
d35 4
a38 4
void display_patches(struct partition_map *entry);
int dump(char *name);
void dump_block(unsigned char *addr, int len);
void dump_partition_map(struct partition_map_header *map, int disk_order);
d40 2
a41 2
void full_dump_block_zero(struct partition_map_header *map);
void show_data_structures(struct partition_map_header *map);
@


1.7
log
@The great de-typedef'ification continues.

partition_map -> struct partition_map
partition_map_header -> struct partition_map_header
@
text
@d1 1
a1 1
/*	$OpenBSD: dump.h,v 1.6 2016/01/14 04:02:05 krw Exp $	*/
a34 24

//
// Defines
//


//
// Types
//


//
// Global Constants
//


//
// Global Variables
//


//
// Forward declarations
//
@


1.6
log
@Remove code supporting undocumented and inaccessible flags 'a'
(abbreviate partition type names), 'f' (print HFS partition names)
and 'kLogicalOption' (obviously a getopt_long() conversion error).
@
text
@d1 1
a1 1
/*	$OpenBSD: dump.h,v 1.5 2016/01/11 07:54:07 jasper Exp $	*/
d59 1
a59 1
void display_patches(partition_map *entry);
d62 4
a65 4
void dump_partition_map(partition_map_header *map, int disk_order);
void full_dump_partition_entry(partition_map_header *, int);
void full_dump_block_zero(partition_map_header *map);
void show_data_structures(partition_map_header *map);
@


1.5
log
@add rcs ids
@
text
@d1 1
a1 1
/*	$OpenBSD$	*/
a38 3
#define AFLAG_DEFAULT	0
#define PFLAG_DEFAULT	1
#define FFLAG_DEFAULT	0
a53 3
extern int aflag;
extern int pflag;
extern int fflag;
@


1.4
log
@remove unused functions

initially from tobias@@, but I removed some other unused one

ok martin@@ tobias@@
@
text
@d1 2
@


1.3
log
@update for pdisk 0.8a2, from NetBSD, retaining our local changes;
summing it up:

- Clean up sources - fix naming, delete old email addresses
- Added support for display of Mac volume names
- Fix block 0 display to show logical offset of drivers
- Require confirmation of quit without write
- Fix iteration to not complain about missing devices
- Warn when creating/writing a map with more than 15 entries

and, most important, add do_update_dpme() which allows us to partition
OpenBSD slices without previous MacOS setup.

Tested with shared MacOS install on macppc, procedure there remains the
same.

grammer and spelling help and ok jmc@@

ok miod@@
@
text
@a68 1
void list_all_disks(void);
@


1.2
log
@rm trailing whitespace
@
text
@d4 1
a4 1
// Written by Eryk Vershen (eryk@@apple.com)
d39 1
d57 1
d67 1
a67 1
void full_dump_partition_entry(partition_map_header *map, int index);
d69 1
a69 1
void list_all_disks();
@


1.1
log
@Initial revision
@
text
@d9 17
a25 17
 *              All Rights Reserved 
 *  
 * Permission to use, copy, modify, and distribute this software and 
 * its documentation for any purpose and without fee is hereby granted, 
 * provided that the above copyright notice appears in all copies and 
 * that both the copyright notice and this permission notice appear in 
 * supporting documentation. 
 *  
 * APPLE COMPUTER DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE 
 * INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS 
 * FOR A PARTICULAR PURPOSE. 
 *  
 * IN NO EVENT SHALL APPLE COMPUTER BE LIABLE FOR ANY SPECIAL, INDIRECT, OR 
 * CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM 
 * LOSS OF USE, DATA OR PROFITS, WHETHER IN ACTION OF CONTRACT, 
 * NEGLIGENCE, OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION 
 * WITH THE USE OR PERFORMANCE OF THIS SOFTWARE. 
@


1.1.1.1
log
@Import of pdisk from apple, BSD licensed code. Archive dated Feb 18 1998 
This is a HFS partition editing tool.
@
text
@@
