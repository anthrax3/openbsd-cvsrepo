head	1.16;
access;
symbols
	OPENBSD_6_1_BASE:1.16
	OPENBSD_6_0:1.16.0.34
	OPENBSD_6_0_BASE:1.16
	OPENBSD_5_9:1.16.0.30
	OPENBSD_5_9_BASE:1.16
	OPENBSD_5_8:1.16.0.32
	OPENBSD_5_8_BASE:1.16
	OPENBSD_5_7:1.16.0.24
	OPENBSD_5_7_BASE:1.16
	OPENBSD_5_6:1.16.0.28
	OPENBSD_5_6_BASE:1.16
	OPENBSD_5_5:1.16.0.26
	OPENBSD_5_5_BASE:1.16
	OPENBSD_5_4:1.16.0.22
	OPENBSD_5_4_BASE:1.16
	OPENBSD_5_3:1.16.0.20
	OPENBSD_5_3_BASE:1.16
	OPENBSD_5_2:1.16.0.18
	OPENBSD_5_2_BASE:1.16
	OPENBSD_5_1_BASE:1.16
	OPENBSD_5_1:1.16.0.16
	OPENBSD_5_0:1.16.0.14
	OPENBSD_5_0_BASE:1.16
	OPENBSD_4_9:1.16.0.12
	OPENBSD_4_9_BASE:1.16
	OPENBSD_4_8:1.16.0.10
	OPENBSD_4_8_BASE:1.16
	OPENBSD_4_7:1.16.0.6
	OPENBSD_4_7_BASE:1.16
	OPENBSD_4_6:1.16.0.8
	OPENBSD_4_6_BASE:1.16
	OPENBSD_4_5:1.16.0.4
	OPENBSD_4_5_BASE:1.16
	OPENBSD_4_4:1.16.0.2
	OPENBSD_4_4_BASE:1.16
	OPENBSD_4_3:1.15.0.4
	OPENBSD_4_3_BASE:1.15
	OPENBSD_4_2:1.15.0.2
	OPENBSD_4_2_BASE:1.15
	OPENBSD_4_1:1.14.0.4
	OPENBSD_4_1_BASE:1.14
	OPENBSD_4_0:1.14.0.2
	OPENBSD_4_0_BASE:1.14
	OPENBSD_3_9:1.13.0.6
	OPENBSD_3_9_BASE:1.13
	OPENBSD_3_8:1.13.0.4
	OPENBSD_3_8_BASE:1.13
	OPENBSD_3_7:1.13.0.2
	OPENBSD_3_7_BASE:1.13
	OPENBSD_3_6:1.12.0.6
	OPENBSD_3_6_BASE:1.12
	OPENBSD_3_5:1.12.0.4
	OPENBSD_3_5_BASE:1.12
	OPENBSD_3_4:1.12.0.2
	OPENBSD_3_4_BASE:1.12
	OPENBSD_3_3:1.11.0.10
	OPENBSD_3_3_BASE:1.11
	OPENBSD_3_2:1.11.0.8
	OPENBSD_3_2_BASE:1.11
	OPENBSD_3_1:1.11.0.6
	OPENBSD_3_1_BASE:1.11
	OPENBSD_3_0:1.11.0.4
	OPENBSD_3_0_BASE:1.11
	OPENBSD_2_9:1.11.0.2
	OPENBSD_2_9_BASE:1.11
	OPENBSD_2_8:1.10.0.4
	OPENBSD_2_8_BASE:1.10
	OPENBSD_2_7:1.10.0.2
	OPENBSD_2_7_BASE:1.10
	OPENBSD_2_6:1.8.0.2
	OPENBSD_2_6_BASE:1.8
	OPENBSD_2_5:1.6.0.2
	OPENBSD_2_5_BASE:1.6
	OPENBSD_2_4:1.4.0.2
	OPENBSD_2_4_BASE:1.4
	OPENBSD_2_3:1.1.0.2
	OPENBSD_2_3_BASE:1.1;
locks; strict;
comment	@# @;


1.16
date	2008.03.23.23.28.46;	author krw;	state Exp;
branches;
next	1.15;

1.15
date	2007.05.31.19.19.47;	author jmc;	state Exp;
branches;
next	1.14;

1.14
date	2006.09.11.07.24.33;	author jmc;	state Exp;
branches;
next	1.13;

1.13
date	2004.12.14.00.04.21;	author jmc;	state Exp;
branches;
next	1.12;

1.12
date	2003.06.03.00.33.34;	author weingart;	state Exp;
branches;
next	1.11;

1.11
date	2000.11.09.17.53.07;	author aaron;	state Exp;
branches;
next	1.10;

1.10
date	2000.03.18.22.56.04;	author aaron;	state Exp;
branches;
next	1.9;

1.9
date	2000.03.05.00.28.50;	author aaron;	state Exp;
branches;
next	1.8;

1.8
date	99.07.03.02.11.08;	author aaron;	state Exp;
branches;
next	1.7;

1.7
date	99.05.23.14.11.21;	author aaron;	state Exp;
branches;
next	1.6;

1.6
date	98.12.15.01.20.44;	author aaron;	state Exp;
branches;
next	1.5;

1.5
date	98.11.11.22.20.01;	author aaron;	state Exp;
branches;
next	1.4;

1.4
date	98.09.17.04.15.02;	author aaron;	state Exp;
branches;
next	1.3;

1.3
date	98.09.07.16.44.34;	author aaron;	state Exp;
branches;
next	1.2;

1.2
date	98.04.28.07.37.25;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	98.02.05.17.15.51;	author weingart;	state Exp;
branches;
next	;


desc
@@


1.16
log
@Remove two stray references to the departed -r argument to disklabel.

Pointed out by jmc@@
@
text
@.\"	$OpenBSD: scan_ffs.8,v 1.15 2007/05/31 19:19:47 jmc Exp $
.\"
.\" Copyright (c) 1997 Niklas Hallqvist, Tobias Weingartner
.\" All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
.\" IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
.\" OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
.\" IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
.\" INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
.\" NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
.\" DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
.\" THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
.\" (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
.\" THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
.\"
.\" .TH scan_ffs 8
.Dd $Mdocdate: May 31 2007 $
.Dt SCAN_FFS 8
.Os
.Sh NAME
.Nm scan_ffs
.Nd find UFS/FFS partitions on a disk
.Sh SYNOPSIS
.Nm scan_ffs
.Op Fl lsv
.Op Fl b Ar begin
.Op Fl e Ar end
.Ar device
.Sh DESCRIPTION
This is the life-saver of typos.
If you have ever been working too long,
and just happened to type 'disklabel -w sd0 floppy', instead of 'disklabel
-w fd0 floppy', you know what I am talking about.
.Pp
This little program will take a raw disk device (which you might have to
create) that covers the whole disk, and finds all probable UFS/FFS partitions
on the disk.
It has various options to make it go faster, and to print out
information to help in the reconstruction of the disklabel.
.Pp
The options are as follows:
.Bl -tag -width Ds
.It Fl b Ar begin
Tell
.Nm
where to begin searching for filesystems.
This makes it easier to skip swap
partitions, or other large non-UFS/FFS partitions.
.It Fl e Ar end
Ditto for telling
.Nm
where to stop.
.It Fl l
This will make
.Nm
print out a string looking much like the input to disklabel.
With a little massaging, this output can usually be used in the disklabel edit.
.It Fl s
This tells
.Nm
to be smart about skipping partitions (when it thinks it found a valid one).
By not scanning partitions for superblocks, the program completes a couple of
orders of magnitude faster.
However, sometimes being smart is too good for
its own good,
especially if your disk has had a different layout previously, or contains
other non-UFS/FFS filesystems.
.It Fl v
Tell
.Nm
to be verbose about what it is doing, and what it has found.
.It Ar device
This specifies which device
.Nm
should use to scan for filesystems.
Usually this device should cover the whole disk in question.
.El
.Pp
The basic operation of this program is as follows:
.Bl -enum -width "1111"
.It
Panic.
You usually do so anyways, so you might as well get it over with.
Just don't do anything stupid.
Panic away from your machine.
Then relax, and see if the steps below won't help you out.
.It
Try to find your old disklabel by any other means possible.
This includes
printouts, backups
(look in
.Pa /var/backups/ ) ,
screendumps, and whatever other method you can think of.
The more information you have, the better your chances are in recovering the
disklabel of the disk.
.It
Create a disklabel on the affected disk, which covers the whole disk, and has
at least one partition which covers the whole disk.
As the
.Dq c
partition
usually covers the whole disk anyways, this sounds like a good place to start.
.It
Run
.Nm
over this partition.
If you have any information about the disklabel
which used to exist on the disk, keep that in mind while
.Nm
spews out its things.
.It
Use
.Xr disklabel 8
to reconstruct the disklabel on the affected disk, using
all the information you gathered from
.Nm
and other sources.
.El
.Pp
Last but certainly not least, we wish you good luck.
The UFS/FFS filesystems are pretty sturdy.
I've seen them reconstructed after some pretty weird and
awesome fumbles.
If you can't have backups, at least have funky tools to help
you out of a jam when they happen.
.Sh SEE ALSO
.Xr disklabel 8
.Sh BUGS
It is not perfect, and could do a lot more things with date/time information
in the superblocks it finds, but this program has saved more than one butt,
more than once.
@


1.15
log
@convert to new .Dd format;
@
text
@d1 1
a1 1
.\"	$OpenBSD: scan_ffs.8,v 1.14 2006/09/11 07:24:33 jmc Exp $
d27 1
a27 1
.Dd $Mdocdate$
d42 2
a43 2
and just happened to type 'disklabel -rw sd0 floppy', instead of 'disklabel
-rw fd0 floppy', you know what I am talking about.
@


1.14
log
@- sort options
- no need for .Pp between list items
@
text
@d1 1
a1 1
.\"	$OpenBSD: scan_ffs.8,v 1.13 2004/12/14 00:04:21 jmc Exp $
d27 1
a27 1
.Dd January 31, 1998
@


1.13
log
@mention /var/backups;
ok otto@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: scan_ffs.8,v 1.12 2003/06/03 00:33:34 weingart Exp $
d53 10
a67 1
.Pp
a77 1
.Pp
a81 13
.Pp
.It Fl b Ar begin
Tell
.Nm
where to begin searching for filesystems.
This makes it easier to skip swap
partitions, or other large non-UFS/FFS partitions.
.Pp
.It Fl e Ar end
Ditto for telling
.Nm
where to stop.
.Pp
a86 1
.Pp
a105 1
.Pp
a112 1
.Pp
a120 1
.Pp
a127 1
.Pp
@


1.12
log
@Kill clause 3 & 4 on some of my code.
@
text
@d1 1
a1 1
.\"	$OpenBSD: scan_ffs.8,v 1.11 2000/11/09 17:53:07 aaron Exp $
d106 4
a109 1
printouts, backups, screendumps, and whatever other method you can think of.
@


1.11
log
@Change all option list specifications to ".Bl -tag -width Ds". Most man
pages just needed their -width parameter tweaked to "Ds", which provides
a nice width of 6 constant characters. For consistency more than anything.
@
text
@d1 1
a1 1
.\"	$OpenBSD: scan_ffs.8,v 1.10 2000/03/18 22:56:04 aaron Exp $
a13 5
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgement:
.\"    This product includes software developed by Tobias Weingartner.
.\" 4. The name of the author may not be used to endorse or promote products
.\"    derived from this software without specific prior written permission.
@


1.10
log
@Remove hard sentence breaks, and some other cleanup along the way.
@
text
@d1 1
a1 1
.\"	$OpenBSD: scan_ffs.8,v 1.9 2000/03/05 00:28:50 aaron Exp $
d57 1
a57 1
.Bl -tag -width "-b begin"
@


1.9
log
@Finish standardizing options list introduction.
@
text
@d1 1
a1 1
.\"	$OpenBSD: scan_ffs.8,v 1.8 1999/07/03 02:11:08 aaron Exp $
d45 2
a46 1
This is the life-saver of typos.  If you have ever been working too long,
d52 2
a53 1
on the disk.  It has various options to make it go faster, and to print out
d61 2
a62 2
print out a string looking much like the input to disklabel.  With a little
massaging, this output can usually be used in the disklabel edit.
d69 2
a70 1
orders of magnitude faster.  However, sometimes being smart is too good for
d83 2
a84 1
where to begin searching for filesystems.  This makes it easier to skip swap
d95 2
a96 2
should use to scan for filesystems.  Usually this device should cover the
whole disk in question.
d103 5
a107 3
Panic.  You usually do so anyways, so you might as well get it over with.
Just don't do anything stupid.  Panic away from your machine.  Then relax,
and see if the steps below won't help you out.
d109 2
a110 1
Try to find your old disklabel by any other means possible.  This includes
d117 2
a118 1
at least one partition which covers the whole disk.  As the
d126 2
a127 1
over this partition.  If you have any information about the disklabel
d142 5
a146 3
Last but certainly not least, we wish you good luck.  The UFS/FFS filesystems
are pretty sturdy.  I've seen them reconstructed after some pretty weird and
awesome fumbles.  If you can't have backups, at least have funky tools to help
a153 1

@


1.8
log
@remove redundant .Pp macros
@
text
@d1 1
a1 1
.\"	$OpenBSD: scan_ffs.8,v 1.7 1999/05/23 14:11:21 aaron Exp $
d54 1
a54 1
The following options are available:
@


1.7
log
@remove argument from .Os macros so value in /usr/share/tmac/mdoc/doc-common
is used instead; kwesterback@@home.com
@
text
@d1 1
a1 1
.\"	$OpenBSD: scan_ffs.8,v 1.6 1998/12/15 01:20:44 aaron Exp $
a136 1
.Pp
@


1.6
log
@always give .Nm macros an argument in SYNOPSIS sections; krw@@tcn.net
@
text
@d1 1
a1 1
.\"	$OpenBSD: scan_ffs.8,v 1.5 1998/11/11 22:20:01 aaron Exp $
d34 1
a34 1
.Os OpenBSD
@


1.5
log
@more `` '' -> .Dq sillyness; remove redundant .Pp macros; other misc fixes
@
text
@d1 1
a1 1
.\"	$OpenBSD: scan_ffs.8,v 1.4 1998/09/17 04:15:02 aaron Exp $
d39 1
a39 1
.Nm
@


1.4
log
@sbin/ man page fixes
@
text
@d1 1
a1 1
.\"	$OpenBSD: scan_ffs.8,v 1.3 1998/09/07 16:44:34 aaron Exp $
a54 1
.Pp
a96 1
.Pp
d110 3
a112 1
at least one partition which covers the whole disk.  As the ``c'' partition
@


1.3
log
@More man page fixes. Particularly fix uses of it's/its, affect/effect,
then/than and such. Other miscellaneous problems fixed across these source
files.
@
text
@d1 1
a1 1
.\"	$OpenBSD: scan_ffs.8,v 1.2 1998/04/28 07:37:25 deraadt Exp $
d112 1
a112 1
at least one partition which covers the whole disk.  As the 'c' partition
@


1.2
log
@use Xr more often
@
text
@d1 1
a1 1
.\"	$OpenBSD: scan_ffs.8,v 1.1 1998/02/05 17:15:51 weingart Exp $
d45 1
a45 1
This is the life-saver of typo's.  If you have ever been working too long,
d69 1
a69 1
it's own good,
@


1.1
log
@Add man page.  I don't know which revision this one is, I might have
a newer version of this utility to commit later...
@
text
@d1 1
a1 1
.\"	$OpenBSD$
d124 3
a126 1
Use disklabel(8) to reconstruct the disklabel on the affected disk, using
@

