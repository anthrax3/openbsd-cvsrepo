head	1.12;
access;
symbols
	OPENBSD_3_2:1.11.0.2
	OPENBSD_3_2_BASE:1.11
	OPENBSD_3_1:1.10.0.2
	OPENBSD_3_1_BASE:1.10
	OPENBSD_3_0:1.9.0.2
	OPENBSD_3_0_BASE:1.9
	OPENBSD_2_9:1.8.0.2
	OPENBSD_2_9_BASE:1.8
	OPENBSD_2_8:1.7.0.4
	OPENBSD_2_8_BASE:1.7
	OPENBSD_2_7:1.7.0.2
	OPENBSD_2_7_BASE:1.7
	OPENBSD_2_6:1.6.0.2
	OPENBSD_2_6_BASE:1.6
	OPENBSD_2_5:1.3.0.2
	OPENBSD_2_5_BASE:1.3;
locks; strict;
comment	@.\" @;


1.12
date	2003.03.13.00.33.47;	author deraadt;	state dead;
branches;
next	1.11;

1.11
date	2002.07.01.15.52.37;	author deraadt;	state Exp;
branches;
next	1.10;

1.10
date	2001.12.21.11.41.50;	author mpech;	state Exp;
branches;
next	1.9;

1.9
date	2001.06.27.03.31.48;	author angelos;	state Exp;
branches;
next	1.8;

1.8
date	2000.12.11.20.32.15;	author provos;	state Exp;
branches;
next	1.7;

1.7
date	2000.03.18.22.56.02;	author aaron;	state Exp;
branches;
next	1.6;

1.6
date	99.09.23.04.12.02;	author alex;	state Exp;
branches;
next	1.5;

1.5
date	99.07.03.02.11.08;	author aaron;	state Exp;
branches;
next	1.4;

1.4
date	99.06.04.02.45.25;	author aaron;	state Exp;
branches;
next	1.3;

1.3
date	98.12.15.01.20.46;	author aaron;	state Exp;
branches;
next	1.2;

1.2
date	98.11.28.19.56.37;	author aaron;	state Exp;
branches;
next	1.1;

1.1
date	98.11.14.23.37.27;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.12
log
@thought we had already deleted this
@
text
@.\" $OpenBSD: photurisd.8,v 1.11 2002/07/01 15:52:37 deraadt Exp $
.\"
.\" Copyright 1997 Niels Provos <provos@@physnet.uni-hamburg.de>
.\" All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgement:
.\"      This product includes software developed by Niels Provos.
.\" 4. The name of the author may not be used to endorse or promote products
.\"    derived from this software without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
.\" IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
.\" OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
.\" IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
.\" INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
.\" NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
.\" DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
.\" THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
.\" (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
.\" THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
.\"
.\" Manual page, using -mandoc macros
.\"
.Dd July 18, 1997
.Dt PHOTURISD 8
.Os
.Sh NAME
.Nm photurisd
.Nd IPsec key management daemon
.Sh SYNOPSIS
.Nm photurisd
.Op Fl ci
.Op Fl d Ar directory
.Op Fl p Ar port
.Sh DESCRIPTION
The
.Nm
daemon establishes security associations for encrypted
and/or authenticated network traffic.
.Pp
The daemon listens to a named pipe
.Pa photuris.pipe
for user requests and on a
.Dv PF_ENCAP
socket for kernel requests.
.Pp
The options are as follows:
.Bl -tag -width Ds
.It Fl c
The
.Fl c
option is used to force a primality check of the bootstrapped moduli.
.It Fl i
The
.Fl i
option can be used to ignore the
.Pa photuris.startup
file.
Otherwise the exchanges in that file will be initiated on startup.
.It Fl d Ar directory
The
.Fl d
option specifies the
.Ar directory
in which
.Nm
looks for its startup files.
The default is
.Pa /etc/photuris/ .
.It Fl p Ar port
The
.Fl p
option specifies the local
.Ar port
the daemon shall bind to.
.El
.Pp
The file
.Pa photuris.conf
contains the moduli for the DH exchange and the actual exchange
schemes used to establish a shared secret.
The following keywords are understood:
.Bl -tag -width exchange -offset indent
.It Ic modulus
This keyword is followed by the numeric generator and modulus.
Those two values describe the group in which exchange values for the
.Dq Diffie-Hellmann
key exchange are generated.
The modulus needs to be a
.Dq safe prime .
.It Ic exchange
This keyword is used to specify the supported exchange schemes.
The scheme is
followed by either zero or the number of bits of the modulus to be used
with this scheme.
If zero is specified the given scheme acts as modifier to the base
scheme.
The base scheme is
.Dq DH_G_2_MD5
(generator of two and MD5 identification).
Extended schemes are
.Dq DH_G_2_DES_MD5
and
.Dq DH_G_2_3DES_SHA1 .
An exchange can only be configured if an apropriate modulus has be given
before.
.It Ic config
This is used to configure the LifeTimes of SPIs and exchanges.
The configurable values are:
.Ic exchange_max_retries ,
.Ic exchange_retransmit_timeout ,
.Ic exchange_timeout ,
.Ic exchange_lifetime
and
.Ic spi_lifetime .
They are followed by an integer.
.El
.Pp
The file
.Pa attributes.conf
contains the attributes, i.e., different choices of encryption
and authentication, offered to the other peer.
If a line starts with an ip
address and a space separated netmask the following attributes are only
offered to hosts lying in that net range.
Only one attribute per line is allowed.
An attribute can either be an already defined tag or
a new definition of an attribute.
In that case the line is followed by a comma-separated list:
.Ar attribute name ,
.Ar Photuris ID ,
.Ar type of attribute
and
.Ar key length .
The name is only used as reference.
A list of possible Photuris IDs can be found in
.Pa /usr/share/ipsec/attributes.conf .
The attribute type is one of the following:
.Dq enc ,
.Dq ident ,
.Dq auth
or
.Dq ident|auth .
The key length is so far only used by the encryption attributes and
specifies the number of keying bytes the daemon has to generate.
Predefined attributes are:
.Bl -tag -width AT_ESP_ATTRIB -offset indent
.It AT_AH_ATTRIB
Starts the list of authentication attributes.
.It AT_ESP_ATTRIB
Starts the list of encryption attributes.
.El
.Pp
The file
.Pa secrets.conf
contains the party preconfigured symmetric secrets for the
identity exchange.
.Bl -tag -width identity_pair_local -offset indent
.It Ic identity local
Defines the identity the local daemon will assume and the according
password.
Both name and secret are braced by quotation marks and follow the
.Ic identity local
directive.
.It Ic identity remote
Defines the parties the daemon can communicate with and their secrets.
Both name and secret are braced by quotation marks and follow the
.Ic identity remote
directive.
The name and secret are the same as the identity local on the remote site.
.It Ic identity pair local
If the identity of the remote site is already known,
.Ic identity pair local
enables the daemon to assume an identity and secret based on
the remote identity.
The directive is followed by the
remote identity, a new local identity and an according secret.
In that way the secrets are not shared with all other parties.
.El
.Pp
Once DNSSEC or other public key infrastructures are available, those will
be supported also.
.Pp
Finally the file
.Pa photuris.startup
contains parameters for exchanges which are created during
startup.
.Pp
The keywords
.Ic dst ,
.Ic port ,
.Ic options ,
.Ic tsrc ,
.Ic tdst ,
.Ic exchange_lifetime ,
.Ic spi_lifetime
and
.Ic user
are understood in the
.Pa photuris.startup
file.
The values are as follows:
.Bl -tag -width exchange_lifetime -offset indent
.It Ic dst
The destination IP address with which the exchange is to be established.
.It Ic port
The port number of the destination
.Nm
daemon.
.It Ic options
The options to be used in the exchange.
Possible values are
.Dq enc
and
.Dq auth .
.It Ic exchange_lifetime
Determines the lifetime of the exchange.
After an exchange expires
no new SPIs are created, which means the transport or tunnel is torn down
as soon as the current SPI times out (see
.Ic spi_lifetime
below).
The default value is gotten from the
.Ic exchange_lifetime
parameter given in
.Pa photuris.conf .
If it is not given there the default is 1800 seconds.
.It Ic spi_lifetime
Determines the lifetime of each created SPI in the exchange.
.It Ic user
The user name for whom the keying shall be done.
Preconfigured secrets are taken from the users secret file.
.El
.Pp
Exchanges are separated by newlines.
.Sh EXAMPLES
A sample
.Pa photuris.startup
entry:
.Pp
.Bd -literal
dst=134.100.106.2 port=468 options=auth
.Ed
.Sh SEE ALSO
.Xr ipsec 4 ,
.Xr vpn 8
.Sh HISTORY
The photuris keymanagement protocol is described in the internet draft
.%T draft-simpson-photuris
by the authors Phil Karn and William Allen Simpson.
This implementation was done 1997 by Niels Provos and appeared in
.Ox 2.1 .
@


1.11
log
@do not Xr startkey
@
text
@d1 1
a1 1
.\" $OpenBSD: photurisd.8,v 1.10 2001/12/21 11:41:50 mpech Exp $
@


1.10
log
@Initial patch for a new mdoc issue.
Powered by @@mantoya:
o) kill extra line in the end of file;
o) kill extra space in the end of line;
o) replace blank lines with .Pp;

millert@@ ok
@
text
@d1 1
a1 1
.\" $OpenBSD: photurisd.8,v 1.9 2001/06/27 03:31:48 angelos Exp $
a253 1
.Xr startkey 1 ,
@


1.9
log
@Consistently use "IPsec" capitalization (jsyn@@nthought.com)
@
text
@d1 1
a1 1
.\" $OpenBSD: photurisd.8,v 1.8 2000/12/11 20:32:15 provos Exp $
a262 1

@


1.8
log
@remove lots of unnecssary code, on the way to new spd framework.
@
text
@d1 1
a1 1
.\" $OpenBSD: photurisd.8,v 1.7 2000/03/18 22:56:02 aaron Exp $
d38 1
a38 1
.Nd IPSec key management daemon
@


1.7
log
@Remove hard sentence breaks, and some other cleanup along the way.
@
text
@d1 1
a1 1
.\" $OpenBSD: photurisd.8,v 1.6 1999/09/23 04:12:02 alex Exp $
d41 1
a41 1
.Op Fl cvi
a61 7
.It Fl v
The
.Fl v
options is used to start
.Xr photurisd 8
in VPN (Virtual Private Network) mode, see
.Xr vpn 8 .
a224 26
.It Ic tsrc
If both
.Ic tsrc
and
.Ic tdst
(see below) are specified, a tunnel (IP over IP) is setup.
The
.Ic tsrc
option is a network address with netmask used for matching the source
IP address of a packet.
When both the source and the destination
addresses match their respective options the packet will be routed into the
tunnel.
.It Ic tdst
If both
.Ic tsrc
(see above) and
.Ic tdst
are specified, a tunnel (IP over IP) is setup.
The
.Ic tdst
option is a network address with netmask used for matching the destination
IP address of a packet.
When both the source and the destination
addresses match their respective options the packet will be routed into the
tunnel.
a251 2
tsrc=134.100.104.0/255.255.255.255
tdst=134.100.106.0/255.255.255.255
@


1.6
log
@Typo fixes.
@
text
@d1 2
a2 1
.\" $OpenBSD: photurisd.8,v 1.5 1999/07/03 02:11:08 aaron Exp $
d74 2
a75 2
file. Otherwise the exchanges in that file will be initiated
on startup.
d83 2
a84 1
looks for its startup files. The default is
d97 2
a98 2
schemes used to establish a shared secret. The following keywords are
understood:
d101 2
a102 2
This keyword is followed by the numeric generator and modulus. Those two
values describe the group in which exchange values for the
d104 2
a105 1
key exchange are generated. The modulus needs to be a
d108 2
a109 1
This keyword is used to specify the supported exchange schemes. The scheme is
d113 2
a114 1
scheme. The base scheme is
d116 2
a117 1
(generator of two and MD5 identification). Extended schemes are
d124 2
a125 2
This is used to configure the LifeTimes of SPIs and exchanges. The configurable
values are:
d138 2
a139 1
and authentication, offered to the other peer. If a line starts with an ip
d141 5
a145 4
offered to hosts lying in that net range. Only one attribute per line
is allowed. An attribute can either be an already defined tag or
a new definition of an attribute. In that case the line is followed by a
comma separated list:
d151 2
a152 2
The name is only used as reference. A list of possible Photuris IDs can
be found in
d177 2
a178 2
password. Both name and secret are braced by quotation marks and follow
the
d185 2
a186 2
directive. The name and secret are the same as the identity local
on the remote site.
d191 2
a192 1
the remote identity. The directive is followed by the
d217 2
a218 1
file. The values are as follows:
d227 2
a228 1
The options to be used in the exchange. Possible values are
d237 2
a238 1
(see below) are specified, a tunnel (IP over IP) is setup.  The
d241 2
a242 1
IP address of a packet.  When both the source and the destination
d250 2
a251 1
are specified, a tunnel (IP over IP) is setup.  The
d254 2
a255 1
IP address of a packet.  When both the source and the destination
d259 2
a260 1
Determines the lifetime of the exchange. After an exchange expires
d264 2
a265 1
below).  The default value is gotten from the
d273 2
a274 2
The user name for whom the keying shall be done. Preconfigured
secrets are taken from the users secret file.
@


1.5
log
@remove redundant .Pp macros
@
text
@d1 1
a1 1
.\" $OpenBSD: photurisd.8,v 1.4 1999/06/04 02:45:25 aaron Exp $
d132 1
a132 1
and authenication, offered to the other peer. If a line starts with an ip
@


1.4
log
@start to remove non-escaped trailing whitespace, it can confuse troff; pjanzen@@
@
text
@d1 1
a1 1
.\" $OpenBSD: photurisd.8,v 1.3 1998/12/15 01:20:46 aaron Exp $
d261 1
a261 2
.Pp
.Sh EXAMPLE
a270 1
.Pp
@


1.3
log
@always give .Nm macros an argument in SYNOPSIS sections; krw@@tcn.net
@
text
@d1 1
a1 1
.\" $OpenBSD: photurisd.8,v 1.2 1998/11/28 19:56:37 aaron Exp $
d47 1
a47 1
and/or authenticated network traffic. 
d49 1
a49 1
The daemon listens to a named pipe 
d62 1
a62 1
The 
d71 1
a71 1
option can be used to ignore the 
d95 1
a95 1
schemes used to establish a shared secret. The following keywords are 
d100 1
a100 1
values describe the group in which exchange values for the 
d102 1
a102 1
key exchange are generated. The modulus needs to be a 
d105 1
a105 1
This keyword is used to specify the supported exchange schemes. The scheme is 
d108 1
a108 1
If zero is specified the given scheme acts as modifier to the base 
d123 1
a123 1
.Ic exchange_lifetime 
d136 1
a136 1
a new definition of an attribute. In that case the line is followed by a 
d165 1
a165 1
identity exchange. 
d170 1
a170 1
the 
d196 1
a196 1
The keywords 
d206 1
a206 1
are understood in the 
d279 1
a279 1
.%T draft-simpson-photuris 
d281 1
a281 1
This implementation was done 1997 by Niels Provos and appeared in 
@


1.2
log
@kill redundant .Nm macro arguments; other misc fixes
@
text
@d1 1
a1 1
.\" $OpenBSD: photurisd.8,v 1.1 1998/11/14 23:37:27 deraadt Exp $
d39 1
a39 1
.Nm
@


1.1
log
@move ipsec tools into .
@
text
@d1 1
a1 1
.\" $OpenBSD: photurisd.8,v 1.8 1998/07/24 20:49:06 deraadt Exp $
d39 1
a39 1
.Nm photurisd
d45 1
a45 1
.Nm photuris
d52 1
a52 1
.Nm PF_ENCAP
d75 1
a75 1
.It Fl d
d78 4
a81 2
option specifies the directory in which
.Nm photurisd
d84 1
a84 1
.It Fl p
d87 3
a89 1
option specifies the local port the daemon shall bind to.
d98 1
a98 1
.It modulus
d101 1
a101 1
.Nm Diffie-Hellmann
d103 3
a105 5
.Nm safe prime .
.It exchange
The 
.Nm exchange
keyword is used to specify the supported exchange schemes. The scheme is 
d110 1
a110 1
.Nm DH_G_2_MD5
d112 1
a112 1
.Nm DH_G_2_DES_MD5
d114 1
a114 1
.Nm DH_G_2_3DES_SHA1 .
d117 1
a117 1
.It config
d120 4
a123 4
.Nm exchange_max_retries ,
.Nm exchange_retransmit_timeout ,
.Nm exchange_timeout ,
.Nm exchange_lifetime 
d125 1
a125 1
.Nm spi_lifetime .
d131 1
a131 1
contains the attributes, i.e. different choices of encryption
d136 1
a136 1
an new definition of an attribute. In that case the line is followed by a 
d138 3
a140 3
.Nm attribute name ,
.Nm Photuris id ,
.Nm type of attribute
d142 2
a143 2
.Nm key length .
The name is only used as reference. A list of possible Photuris ids can
d147 3
a149 3
.Nm enc ,
.Nm ident ,
.Nm auth
d151 1
a151 1
.Nm ident|auth .
d167 1
a167 1
.It identity local
d171 1
a171 1
.Nm identity local
d173 1
a173 1
.It identity remote
d176 1
a176 1
.Nm identity remote
d179 1
a179 1
.It identity pair local
d181 1
a181 1
.Nm identity pair local
d197 7
a203 7
.Nm dst ,
.Nm port ,
.Nm options ,
.Nm tsrc ,
.Nm tdst ,
.Nm exchange_lifetime ,
.Nm spi_lifetime
d205 1
a205 1
.Nm user
d210 1
a210 1
.It dst
d212 1
a212 1
.It port
d214 1
a214 1
.Nm photuris
d216 1
a216 1
.It options
d218 1
a218 1
.Nm enc
d220 2
a221 2
.Nm auth .
.It tsrc
d223 1
a223 1
.Nm tsrc
d225 1
a225 1
.Nm tdst
d227 1
a227 1
.Nm tsrc
d232 1
a232 1
.It tdst
d234 1
a234 1
.Nm tsrc
d236 1
a236 1
.Nm tdst
d238 1
a238 1
.Nm tdst
d243 1
a243 1
.It exchange_lifetime
d247 1
a247 1
.Nm spi_lifetime
d249 1
a249 1
.Nm exchange_lifetime
d253 1
a253 1
.It spi_lifetime
d255 1
a255 1
.It user
d276 1
a276 1
.Xr vpn 8 .
d279 1
a279 1
.Nm draft-simpson-photuris 
@

