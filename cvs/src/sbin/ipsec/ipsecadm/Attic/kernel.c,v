head	1.5;
access;
symbols
	OPENBSD_2_4:1.4.0.2
	OPENBSD_2_4_BASE:1.4
	OPENBSD_2_3:1.2.0.4
	OPENBSD_2_3_BASE:1.2
	OPENBSD_2_2:1.2.0.2
	OPENBSD_2_2_BASE:1.2
	OPENBSD_2_1:1.1.0.2
	OPENBSD_2_1_BASE:1.1;
locks; strict;
comment	@ * @;


1.5
date	98.11.14.23.37.01;	author deraadt;	state dead;
branches;
next	1.4;

1.4
date	98.08.01.06.23.48;	author angelos;	state Exp;
branches;
next	1.3;

1.3
date	98.05.24.13.29.02;	author provos;	state Exp;
branches;
next	1.2;

1.2
date	97.08.26.12.04.36;	author provos;	state Exp;
branches;
next	1.1;

1.1
date	97.03.01.15.08.25;	author provos;	state Exp;
branches;
next	;


desc
@@


1.5
log
@move ipsec tools into .
@
text
@/* $OpenBSD: kernel.c,v 1.4 1998/08/01 06:23:48 angelos Exp $ */
/*
 * The authors of this code are John Ioannidis (ji@@tla.org),
 * Angelos D. Keromytis (kermit@@csd.uch.gr) and 
 * Niels Provos (provos@@physnet.uni-hamburg.de).
 *
 * This code was written by John Ioannidis for BSD/OS in Athens, Greece, 
 * in November 1995.
 *
 * Ported to OpenBSD and NetBSD, with additional transforms, in December 1996,
 * by Angelos D. Keromytis.
 *
 * Additional transforms and features in 1997 and 1998 by Angelos D. Keromytis
 * and Niels Provos.
 *
 * Copyright (C) 1995, 1996, 1997, 1998 by John Ioannidis, Angelos D. Keromytis
 * and Niels Provos.
 *	
 * Permission to use, copy, and modify this software without fee
 * is hereby granted, provided that this entire notice is included in
 * all copies of any software which is or includes a copy or
 * modification of this software. 
 * You may use this code under the GNU public license if you so wish. Please
 * contribute changes back to the authors under this freer than GPL license
 * so that we may further the use of strong encryption without limitations to
 * all.
 *
 * THIS SOFTWARE IS BEING PROVIDED "AS IS", WITHOUT ANY EXPRESS OR
 * IMPLIED WARRANTY. IN PARTICULAR, NONE OF THE AUTHORS MAKES ANY
 * REPRESENTATION OR WARRANTY OF ANY KIND CONCERNING THE
 * MERCHANTABILITY OF THIS SOFTWARE OR ITS FITNESS FOR ANY PARTICULAR
 * PURPOSE.
 */

#include <sys/param.h>
#include <sys/file.h>
#include <sys/socket.h>
#include <sys/ioctl.h>
#include <sys/mbuf.h>
#include <sys/sysctl.h>

#include <net/if.h>
#include <net/route.h>
#include <net/if_dl.h>
#include <netinet/in.h>
#include <netns/ns.h>
#include <netiso/iso.h>
#include <netccitt/x25.h>
#include <arpa/inet.h>
#include <netdb.h>

#include <errno.h>
#include <unistd.h>
#include <stdio.h>
#include <ctype.h>
#include <stdlib.h>
#include <string.h>
#include <paths.h>
#include "net/encap.h"

int
xf_set(em)
	struct encap_msghdr *em;
{
	int sd;

	sd = socket(AF_ENCAP, SOCK_RAW, AF_UNSPEC);
	if (sd < 0) {
	  perror("socket");
	  return 0;
	}
	
	if (write(sd, (char *)em, em->em_msglen) != em->em_msglen) {
	  perror("write");
	  return 0;
	}

	close(sd);
	return 1;
}
@


1.4
log
@close socket. Not really necessary, but good form.
@
text
@d1 1
a1 1
/* $OpenBSD: kernel.c,v 1.3 1998/05/24 13:29:02 provos Exp $ */
@


1.3
log
@incorporate functionality of rt and rtdelete commands into ipsecadm,
some improvements to manpage, stricter option checking, -Wall.
@
text
@d1 1
a1 1
/* $OpenBSD: kernel.c,v 1.2 1997/08/26 12:04:36 provos Exp $ */
d77 2
@


1.2
log
@made hopefully more user friendly + support for new esp.
@
text
@d1 1
a1 1
/* $OpenBSD: kernel.c,v 1.1 1997/03/01 15:08:25 provos Exp $ */
d3 3
a5 2
 * The author of this code is John Ioannidis, ji@@tla.org,
 * 	(except when noted otherwise).
d7 2
a8 1
 * This code was written for BSD/OS in Athens, Greece, in November 1995.
d11 1
a11 2
 * by Angelos D. Keromytis, kermit@@forthnet.gr. Additional code written by
 * Niels Provos in Germany.
d13 5
a17 2
 * Copyright (C) 1995, 1996, 1997 by John Ioannidis, Angelos D. Keromytis and
 * Niels Provos.
d22 5
a26 1
 * modification of this software.
d29 1
a29 1
 * IMPLIED WARRANTY. IN PARTICULAR, NEITHER AUTHOR MAKES ANY
@


1.1
log
@Unified ipsec prgs in ipsecadm
@
text
@d1 1
a1 1
/* $OpenBSD$ */
d9 2
a10 1
 * by Angelos D. Keromytis, kermit@@forthnet.gr.
d12 2
a13 1
 * Copyright (C) 1995, 1996, 1997 by John Ioannidis and Angelos D. Keromytis.
@
