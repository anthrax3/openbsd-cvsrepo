head	1.18;
access;
symbols
	OPENBSD_6_2:1.18.0.10
	OPENBSD_6_2_BASE:1.18
	OPENBSD_6_1:1.18.0.12
	OPENBSD_6_1_BASE:1.18
	OPENBSD_6_0:1.18.0.8
	OPENBSD_6_0_BASE:1.18
	OPENBSD_5_9:1.18.0.4
	OPENBSD_5_9_BASE:1.18
	OPENBSD_5_8:1.18.0.6
	OPENBSD_5_8_BASE:1.18
	OPENBSD_5_7:1.18.0.2
	OPENBSD_5_7_BASE:1.18
	OPENBSD_5_6:1.16.0.20
	OPENBSD_5_6_BASE:1.16
	OPENBSD_5_5:1.16.0.18
	OPENBSD_5_5_BASE:1.16
	OPENBSD_5_4:1.16.0.14
	OPENBSD_5_4_BASE:1.16
	OPENBSD_5_3:1.16.0.12
	OPENBSD_5_3_BASE:1.16
	OPENBSD_5_2:1.16.0.10
	OPENBSD_5_2_BASE:1.16
	OPENBSD_5_1_BASE:1.16
	OPENBSD_5_1:1.16.0.8
	OPENBSD_5_0:1.16.0.6
	OPENBSD_5_0_BASE:1.16
	OPENBSD_4_9:1.16.0.4
	OPENBSD_4_9_BASE:1.16
	OPENBSD_4_8:1.16.0.2
	OPENBSD_4_8_BASE:1.16
	OPENBSD_4_7:1.14.0.2
	OPENBSD_4_7_BASE:1.14
	OPENBSD_4_6:1.14.0.4
	OPENBSD_4_6_BASE:1.14
	OPENBSD_4_5:1.12.0.4
	OPENBSD_4_5_BASE:1.12
	OPENBSD_4_4:1.12.0.2
	OPENBSD_4_4_BASE:1.12
	OPENBSD_4_3:1.10.0.2
	OPENBSD_4_3_BASE:1.10
	ldattach_20071103:1.1.1.1
	mbalmer:1.1.1;
locks; strict;
comment	@.\" @;


1.18
date	2014.10.02.09.28.03;	author jmc;	state Exp;
branches;
next	1.17;
commitid	jzYXolENnnkgxtki;

1.17
date	2014.10.01.10.02.16;	author mpi;	state Exp;
branches;
next	1.16;
commitid	edzZ1vk1hTCTDLTB;

1.16
date	2010.04.06.06.31.30;	author jmc;	state Exp;
branches;
next	1.15;

1.15
date	2010.04.05.21.34.51;	author deraadt;	state Exp;
branches;
next	1.14;

1.14
date	2009.05.06.20.14.18;	author stevesk;	state Exp;
branches;
next	1.13;

1.13
date	2009.05.06.18.21.23;	author stevesk;	state Exp;
branches;
next	1.12;

1.12
date	2008.06.09.22.57.49;	author jmc;	state Exp;
branches;
next	1.11;

1.11
date	2008.06.09.21.06.10;	author mbalmer;	state Exp;
branches;
next	1.10;

1.10
date	2008.02.28.11.22.12;	author mbalmer;	state Exp;
branches;
next	1.9;

1.9
date	2008.01.05.17.33.28;	author mbalmer;	state Exp;
branches;
next	1.8;

1.8
date	2007.11.13.21.44.55;	author jmc;	state Exp;
branches;
next	1.7;

1.7
date	2007.11.13.19.32.34;	author mbalmer;	state Exp;
branches;
next	1.6;

1.6
date	2007.11.03.17.18.50;	author jmc;	state Exp;
branches;
next	1.5;

1.5
date	2007.11.03.16.59.34;	author deraadt;	state Exp;
branches;
next	1.4;

1.4
date	2007.11.03.16.20.33;	author jmc;	state Exp;
branches;
next	1.3;

1.3
date	2007.11.03.15.47.48;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	2007.11.03.15.35.01;	author mbalmer;	state Exp;
branches;
next	1.1;

1.1
date	2007.11.03.15.22.54;	author mbalmer;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2007.11.03.15.22.54;	author mbalmer;	state Exp;
branches;
next	;


desc
@@


1.18
log
@no more sl(4);
@
text
@.\"	$OpenBSD: ldattach.8,v 1.17 2014/10/01 10:02:16 mpi Exp $
.\"
.\" Copyright (c) 2007, 2008 Marc Balmer <mbalmer@@openbsd.org>
.\"
.\" Permission to use, copy, modify, and distribute this software for any
.\" purpose with or without fee is hereby granted, provided that the above
.\" copyright notice and this permission notice appear in all copies.
.\"
.\" THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
.\" WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
.\" MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
.\" ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
.\" WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
.\" ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
.\" OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
.\"
.Dd $Mdocdate: October 1 2014 $
.Dt LDATTACH 8
.Os
.Sh NAME
.Nm ldattach
.Nd attach a line discipline to a serial line
.Sh SYNOPSIS
.Nm ldattach
.Op Fl 27dehmop
.Op Fl s Ar baudrate
.Op Fl t Ar cond
.Ar discipline
.Ar device
.Sh DESCRIPTION
.Nm
is used to attach a line discipline to a serial line to allow for in-kernel
processing of the received and/or sent data.
Depending on the line discipline being attached, one or more options may be
applied.
.Pp
.Nm
can be run from the command line or at system startup by having
.Xr init 8
read
.Xr ttys 5
entries to attach line disciplines.
.Pp
The following options are available:
.Bl -tag -width Ds
.It Fl 2
Use 2 stopbits instead of 1.
.It Fl 7
Use 7 databits instead of 8.
.It Fl d
Do not daemonize.
.It Fl e
Use even parity.
.It Fl h
Turn on RTS/CTS flow control.
By default, no flow control is done.
.It Fl m
Maintain modem control signals after closing the line.
Specifically, this disables HUPCL.
.It Fl o
Use odd parity.
.It Fl p
Pass the data received from
.Ar device
to the master device of a
.Xr pty 4
pair and vice versa.
The name of the slave device is written to standard output.
.It Fl s Ar baudrate
Specifies the speed of the connection.
If not specified, the default of 9600 baud is used
(4800 baud for
.Xr nmea 4 ) .
.It Fl t Ar cond
.Xr nmea 4 ,
.Xr msts 4
and
.Xr endrun 4
line disciplines only.
Chooses the condition which will cause the current system time to be
immediately copied to the terminal timestamp storage for subsequent use by
.Xr nmea 4 ,
.Xr msts 4
or
.Xr endrun 4 .
Only one can be used.
.Pp
.Bl -tag -width DCDXX -offset indent -compact
.It dcd
Copy the timestamp when DCD is asserted.
.It !dcd
Copy the timestamp when DCD is deasserted.
.It cts
Copy the timestamp when CTS is asserted.
.It !cts
Copy the timestamp when CTS is deasserted.
.El
.Pp
If no condition is specified, the
.Xr nmea 4
line discipline will timestamp on receiving the leading
.Sq $
character of each block of NMEA sentences.
.It Ar discipline
Specifies the name of the line discipline to be attached.
.Pp
.Bl -tag -width nmeaXX -offset indent -compact
.It endrun
Attach the
.Xr endrun 4
line discipline.
.It msts
Attach the
.Xr msts 4
line discipline.
.It nmea
Attach the
.Xr nmea 4
line discipline.
.El
.It Ar device
Specifies the name of the serial line.
.Ar device
should be a string of the form
.Dq cuaXX
or
.Dq /dev/cuaXX .
.Pp
.Xr cua 4
devices should be used when
.Nm
is started from the command line;
when started using
.Xr init 8 ,
.Xr tty 4
devices should be used.
.El
.Pp
If
.Nm
was not started by
.Xr init 8 ,
the line discipline can be detached by
killing off the
.Nm
process.
.Sh EXAMPLES
To start
.Nm
using
.Xr init 8
to attach the
.Xr nmea 4
line discipline to
.Pa /dev/tty01
at 4800 baud using a device without a carrier (DCD) line,
add a line of the following form to
.Pa /etc/ttys :
.Bd -literal -offset indent
tty01	"/sbin/ldattach nmea"	unknown	on softcar
.Ed
.Sh SEE ALSO
.Xr endrun 4 ,
.Xr msts 4 ,
.Xr nmea 4 ,
.Xr pty 4 ,
.Xr tty 4 ,
.Xr ttys 5 ,
.Xr init 8
.Sh HISTORY
The
.Nm
command first appeared in
.Ox 4.3 .
@


1.17
log
@Remove some sl(4) references.
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldattach.8,v 1.16 2010/04/06 06:31:30 jmc Exp $
d17 1
a17 1
.Dd $Mdocdate: April 6 2010 $
a166 1
.Xr sl 4 ,
@


1.16
log
@list offset should be "indent", not "-indent";
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldattach.8,v 1.15 2010/04/05 21:34:51 deraadt Exp $
d17 1
a17 1
.Dd $Mdocdate: April 5 2010 $
a118 4
line discipline.
.It slip
Attach the
.Xr sl 4
@


1.15
log
@-indet is not a valid .Bl option, it should be -indent.  But what mandoc(1)
did was spit that out on the next line of output, without warning, which
is a bug in mandoc(1)...
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldattach.8,v 1.14 2009/05/06 20:14:18 stevesk Exp $
d17 1
a17 1
.Dd $Mdocdate: May 6 2009 $
d107 1
a107 1
.Bl -tag -width nmeaXX -offset -indent -compact
@


1.14
log
@.Xr endrun 4
spotted by jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldattach.8,v 1.13 2009/05/06 18:21:23 stevesk Exp $
d107 1
a107 1
.Bl -tag -width nmeaXX -offset -indet -compact
@


1.13
log
@endrun(4) - EndRun Technologies native time-of-day message timedelta
sensor.  Based on msts(4).  Tested with Praecis Ct
(http://www.endruntechnologies.com/network-time-source.htm).

help and feedback mbalmer
'no problem with this sensor going in' deraadt
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldattach.8,v 1.12 2008/06/09 22:57:49 jmc Exp $
d17 1
a17 1
.Dd $Mdocdate: June 9 2008 $
d167 1
@


1.12
log
@zap trailing whitespace;
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldattach.8,v 1.11 2008/06/09 21:06:10 mbalmer Exp $
d75 2
a76 1
.Xr nmea 4
d78 1
a78 1
.Xr msts 4
d82 2
a83 1
.Xr nmea 4
d85 1
a85 1
.Xr msts 4 .
d108 4
@


1.11
log
@Add the '-p' option to ldattach(8) to pass data received from the device
to the master device of a pty(4) pair.  The name of the slave device is
written to standard output.

This is useful for applications like e.g. gpsd from the misc/gpsd port
that also use the serial data stream (e.g. nmea(4) as a time source and
gpsd to get at positional data).

help and ok deraadt, makes ckuethe happy.
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldattach.8,v 1.10 2008/02/28 11:22:12 mbalmer Exp $
d17 1
a17 1
.Dd $Mdocdate: February 28 2008 $
d62 1
a62 1
.It Fl p 
d65 1
a65 1
to the master device of a 
@


1.10
log
@Log an error if a device can not be opened, only log line discipline attachment
when the line discipline has really been attached.  And a few manual tweaks.
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldattach.8,v 1.9 2008/01/05 17:33:28 mbalmer Exp $
d17 1
a17 1
.Dd $Mdocdate: January 5 2008 $
d25 1
a25 1
.Op Fl 27dehmo
d62 7
d163 1
@


1.9
log
@Add support for the Meinberg Standard Time String format that all Meinberg
radio clocks can transmit over serial ports.  This is implemented as a
line discipline similar to nmea(4) and provides a timedelta sensor.

See http://www.meinberg.de/english/specs/timestr.htm for details on the
MSTS format.

ldattach(8) is extended to support the "msts" line discipline and two stopbits
(which some radio clocks, e.g. the C51 use).  Do a "make includes" before your
next system build.

Initially from Maurice Janssen based on nmea(4).  "go for it" deraadt
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldattach.8,v 1.8 2007/11/13 21:44:55 jmc Exp $
d17 1
a17 1
.Dd $Mdocdate: November 13 2007 $
d74 3
a76 1
.Xr nmea 4 .
@


1.8
log
@zap trailing whitespace;
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldattach.8,v 1.7 2007/11/13 19:32:34 mbalmer Exp $
d3 1
a3 1
.\" Copyright (c) 2007 Marc Balmer <mbalmer@@openbsd.org>
d25 1
a25 1
.Op Fl 7dehmo
d46 2
d69 3
a71 1
line discipline only.
d97 4
d152 1
@


1.7
log
@Do not set explicit com parameters for the tty, instead use the exisiting
ones and onl change what the user requests.  Do not artifically limit the
baudrates.

prodding and ok by deraadt.
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldattach.8,v 1.6 2007/11/03 17:18:50 jmc Exp $
d17 1
a17 1
.Dd $Mdocdate: November 3 2007 $
d63 1
a63 1
(4800 baud for 
@


1.6
log
@document different types for "device" and improve startup description;
this is really an mbalmer diff, tweaked by myself

ok deraadt mbalmer
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldattach.8,v 1.5 2007/11/03 16:59:34 deraadt Exp $
a51 5
If both
.Fl e
and
.Fl o
are given, then no parity is used (the default).
a59 5
If both
.Fl e
and
.Fl o
are given, then no parity is used (the default).
d62 3
a64 1
If not specified, the default of 4800 baud is used.
d137 1
a137 1
at 4800 baud,
d141 1
a141 1
tty01	"/sbin/ldattach nmea"	unknown	on
@


1.5
log
@4800
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldattach.8,v 1.4 2007/11/03 16:20:33 jmc Exp $
d38 3
a40 1
can be used from the command line or in
d42 1
a42 5
entries to attach line disciplines at system startup time by having
.Xr init 8
start
.Nm
on the designated interface.
d117 9
d155 2
a156 1
.Xr ttys 5
@


1.4
log
@tweaks;
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldattach.8,v 1.3 2007/11/03 15:47:48 deraadt Exp $
d138 1
a138 1
at 9600 baud,
@


1.3
log
@use tty01 and mention the baud rate issue
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldattach.8,v 1.2 2007/11/03 15:35:01 mbalmer Exp $
d116 1
a116 1
.Dq cuaXX ,
d132 1
a132 1
by using
@


1.2
log
@Correct bad example, in /etc/ttys use the _tty_ not _cua_, of course.

spottet by deraadt.
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldattach.8,v 1.1.1.1 2007/11/03 15:22:54 mbalmer Exp $
d137 2
a138 1
.Pa /dev/tty00 ,
d142 1
a142 1
tty00	"/sbin/ldattach nmea"	unknown	on
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
.\"	$OpenBSD$
d17 1
a17 1
.Dd $Mdocdate$
d137 1
a137 1
.Pa /dev/cua00 ,
d141 1
a141 1
cua00	"/sbin/ldattach nmea"	unknown	on
@


1.1.1.1
log
@ldattach(8) is a command to attach line discipline to a tty line.  It can
be used from the command line or from init(8) by adding an entry to the
/etc/ttys file.  ldattach(8) can be extended to support new line disciplines.

feedback many, ok deraadt, mikeb
@
text
@@
