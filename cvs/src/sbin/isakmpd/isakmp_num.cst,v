head	1.13;
access;
symbols
	OPENBSD_6_1:1.13.0.48
	OPENBSD_6_1_BASE:1.13
	OPENBSD_6_0:1.13.0.46
	OPENBSD_6_0_BASE:1.13
	OPENBSD_5_9:1.13.0.42
	OPENBSD_5_9_BASE:1.13
	OPENBSD_5_8:1.13.0.44
	OPENBSD_5_8_BASE:1.13
	OPENBSD_5_7:1.13.0.36
	OPENBSD_5_7_BASE:1.13
	OPENBSD_5_6:1.13.0.40
	OPENBSD_5_6_BASE:1.13
	OPENBSD_5_5:1.13.0.38
	OPENBSD_5_5_BASE:1.13
	OPENBSD_5_4:1.13.0.34
	OPENBSD_5_4_BASE:1.13
	OPENBSD_5_3:1.13.0.32
	OPENBSD_5_3_BASE:1.13
	OPENBSD_5_2:1.13.0.30
	OPENBSD_5_2_BASE:1.13
	OPENBSD_5_1_BASE:1.13
	OPENBSD_5_1:1.13.0.28
	OPENBSD_5_0:1.13.0.26
	OPENBSD_5_0_BASE:1.13
	OPENBSD_4_9:1.13.0.24
	OPENBSD_4_9_BASE:1.13
	OPENBSD_4_8:1.13.0.22
	OPENBSD_4_8_BASE:1.13
	OPENBSD_4_7:1.13.0.18
	OPENBSD_4_7_BASE:1.13
	OPENBSD_4_6:1.13.0.20
	OPENBSD_4_6_BASE:1.13
	OPENBSD_4_5:1.13.0.16
	OPENBSD_4_5_BASE:1.13
	OPENBSD_4_4:1.13.0.14
	OPENBSD_4_4_BASE:1.13
	OPENBSD_4_3:1.13.0.12
	OPENBSD_4_3_BASE:1.13
	OPENBSD_4_2:1.13.0.10
	OPENBSD_4_2_BASE:1.13
	OPENBSD_4_1:1.13.0.8
	OPENBSD_4_1_BASE:1.13
	OPENBSD_4_0:1.13.0.6
	OPENBSD_4_0_BASE:1.13
	OPENBSD_3_9:1.13.0.4
	OPENBSD_3_9_BASE:1.13
	OPENBSD_3_8:1.13.0.2
	OPENBSD_3_8_BASE:1.13
	OPENBSD_3_7:1.10.0.4
	OPENBSD_3_7_BASE:1.10
	OPENBSD_3_6:1.10.0.2
	OPENBSD_3_6_BASE:1.10
	OPENBSD_3_5:1.7.0.4
	OPENBSD_3_5_BASE:1.7
	OPENBSD_3_4:1.7.0.2
	OPENBSD_3_4_BASE:1.7
	OPENBSD_3_3:1.5.0.8
	OPENBSD_3_3_BASE:1.5
	OPENBSD_3_2:1.5.0.6
	OPENBSD_3_2_BASE:1.5
	OPENBSD_3_1:1.5.0.4
	OPENBSD_3_1_BASE:1.5
	OPENBSD_3_0:1.5.0.2
	OPENBSD_3_0_BASE:1.5
	OPENBSD_2_9:1.4.0.4
	OPENBSD_2_9_BASE:1.4
	OPENBSD_2_8:1.4.0.2
	OPENBSD_2_8_BASE:1.4
	OPENBSD_2_7:1.3.0.6
	OPENBSD_2_7_BASE:1.3
	OPENBSD_2_6:1.3.0.4
	OPENBSD_2_6_BASE:1.3
	OPENBSD_2_5:1.3.0.2
	OPENBSD_2_5_BASE:1.3
	NIKLAS_981114:1.1.1.1
	NIKLAS:1.1.1;
locks; strict;
comment	@# @;


1.13
date	2005.06.25.23.03.38;	author hshoexer;	state Exp;
branches;
next	1.12;

1.12
date	2005.05.26.05.17.42;	author hshoexer;	state Exp;
branches;
next	1.11;

1.11
date	2005.05.18.20.04.50;	author hshoexer;	state Exp;
branches;
next	1.10;

1.10
date	2004.08.10.15.59.10;	author ho;	state Exp;
branches;
next	1.9;

1.9
date	2004.06.20.15.20.07;	author ho;	state Exp;
branches;
next	1.8;

1.8
date	2004.04.28.14.40.00;	author ho;	state Exp;
branches;
next	1.7;

1.7
date	2003.06.03.14.28.16;	author ho;	state Exp;
branches;
next	1.6;

1.6
date	2003.05.12.21.48.08;	author ho;	state Exp;
branches;
next	1.5;

1.5
date	2001.07.01.20.43.39;	author niklas;	state Exp;
branches;
next	1.4;

1.4
date	2000.06.08.20.49.37;	author niklas;	state Exp;
branches;
next	1.3;

1.3
date	98.11.17.11.10.15;	author niklas;	state Exp;
branches;
next	1.2;

1.2
date	98.11.15.00.43.57;	author niklas;	state Exp;
branches;
next	1.1;

1.1
date	98.11.15.00.03.48;	author niklas;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	98.11.15.00.03.48;	author niklas;	state Exp;
branches;
next	;


desc
@@


1.13
log
@typo in comment
@
text
@#	$OpenBSD: isakmp_num.cst,v 1.12 2005/05/26 05:17:42 hshoexer Exp $
#	$EOM: isakmp_num.cst,v 1.3 2000/05/17 03:09:50 angelos Exp $

#
# Copyright (c) 1998, 2001 Niklas Hallqvist.  All rights reserved.
#
# Redistribution and use in source and binary forms, with or without
# modification, are permitted provided that the following conditions
# are met:
# 1. Redistributions of source code must retain the above copyright
#    notice, this list of conditions and the following disclaimer.
# 2. Redistributions in binary form must reproduce the above copyright
#    notice, this list of conditions and the following disclaimer in the
#    documentation and/or other materials provided with the distribution.
#
# THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
# IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
# OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
# IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
# INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
# NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
# DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
# THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
# (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
# THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
#

#
# This code was written under funding by Ericsson Radio Systems.
#

# XXX Please fill in references to the drafts, chapter & verse for each
# constant group below.
# Also think about ranges, can they be specified differently?  Can we use
# these constants for validity checks?

# ISAKMP payload type.
# see http://www.iana.org/assignments/isakmp-registry
ISAKMP_PAYLOAD
  NONE				0
  SA				1
  PROPOSAL			2
  TRANSFORM			3
  KEY_EXCH			4
  ID				5
  CERT				6
  CERT_REQ			7
  HASH				8
  SIG				9
  NONCE				10
  NOTIFY			11
  DELETE			12
  VENDOR			13
  ATTRIBUTE			14	# IKE Mode-Config attribute
  SAK				15	# RFC 3547, SA KEK Payload
  SAT				16	# RFC 3547, SA TEK Payload
  KD				17	# RFC 3547, Key Download
  SEQ				18	# RFC 3547, Sequence Number
  POP				19	# RFC 3547, Proof of possession
  NAT_D				20	# RFC 3947, NAT Discovery payload
  NAT_OA			21	# RFC 3947, NAT Original Address payload
  RESERVED_MIN			22
  RESERVED_MAX			127
  PRIVATE_MIN			128
# values from draft-ietf-ipsec-nat-t-ike-01,02,03.
  NAT_D_DRAFT			130	# NAT Discovery payload
  NAT_OA_DRAFT			131	# NAT Original Address payload
  PRIVATE_MAX			255
  MAX				255
.

# ISAKMP exchange types.
ISAKMP_EXCH
  NONE				0
  BASE				1
  ID_PROT			2
  AUTH_ONLY			3
  AGGRESSIVE			4
  INFO				5
# XXX the following are not quite legitimate according to the IETF process
  TRANSACTION			6
  FUTURE_MIN			7
  FUTURE_MAX			31
  DOI_MIN			32
  DOI_MAX			255
.

# ISAKMP flags.
ISAKMP_FLAGS
  ENC				1
  COMMIT			2
  AUTH_ONLY			4
.

# ISAKMP certificate encoding.
ISAKMP_CERTENC
  NONE				0
  PKCS				1
  PGP				2
  DNS				3
  X509_SIG			4
  X509_KE			5
  KERBEROS			6
  CRL				7
  ARL				8
  SPKI				9
  X509_ATTR			10
  KEYNOTE			11
  HASH_URL_PKIX_CERT		12
  HASH_URL_PKIX_BUNDLE		13
  RESERVED_MIN			14
  RESERVED_MAX			255
.

# ISAKMP Notify message types.
ISAKMP_NOTIFY
  INVALID_PAYLOAD_TYPE		1
  DOI_NOT_SUPPORTED		2
  SITUATION_NOT_SUPPORTED	3
  INVALID_COOKIE		4
  INVALID_MAJOR_VERSION		5
  INVALID_MINOR_VERSION		6
  INVALID_EXCHANGE_TYPE		7
  INVALID_FLAGS			8
  INVALID_MESSAGE_ID		9
  INVALID_PROTOCOL_ID		10
  INVALID_SPI			11
  INVALID_TRANSFORM_ID		12
  ATTRIBUTES_NOT_SUPPORTED	13
  NO_PROPOSAL_CHOSEN		14
  BAD_PROPOSAL_SYNTAX		15
  PAYLOAD_MALFORMED		16
  INVALID_KEY_INFORMATION	17
  INVALID_ID_INFORMATION	18
  INVALID_CERT_ENCODING		19
  INVALID_CERTIFICATE		20
  CERT_TYPE_UNSUPPORTED		21
  INVALID_CERT_AUTHORITY	22
  INVALID_HASH_INFORMATION	23
  AUTHENTICATION_FAILED		24
  INVALID_SIGNATURE		25
  ADDRESS_NOTIFICATION		26
  NOTIFY_SA_LIFETIME		27
  CERTIFICATE_UNAVAILABLE	28
  UNSUPPORTED_EXCHANGE_TYPE	29
  UNEQUAL_PAYLOAD_LENGTHS	30
  RESERVED_MIN			31
  RESERVED_MAX			8191
  PRIVATE_MIN			8192
  PRIVATE_MAX			16383
  STATUS_CONNECTED		16384
  STATUS_RESERVED1_MIN		16385
  STATUS_RESERVED1_MAX		24575
  STATUS_DOI_MIN		24576
  STATUS_DOI_MAX		32767
  STATUS_PRIVATE_MIN		32768
  STATUS_DPD_R_U_THERE		36136
  STATUS_DPD_R_U_THERE_ACK	36137
  STATUS_PRIVATE_MAX		40959
  STATUS_RESERVED2_MIN		40960
  STATUS_RESERVED2_MAX		65535
.

# ISAKMP V2 Notify payload types
ISAKMP_V2_NOTIFY
  UNSUPPORTED_CRITICAL_PAYLOAD		1
  INVALID_IKE_SPI			4
  INVALID_MAJOR_VERSION			5
  INVALID_SYNTAX			7
  INVALID_MESSAGE_ID			9
  INVALID_SPI				11
  NO_PROPOSAL_CHOSEN			14
  AUTHENTICATION_FAILED			24
  SINGLE_PAIR_REQUIRED			34
  NO_ADDITIONAL_SAS			35
  INTERNAL_ADDRESS_FAILURE		36
  FAILED_CP_REQUIRED			37
  TS_UNACCEPTABLE			38
  RESERVED_MIN				39
  RESERVED_MAX				8191
  PRIVATE_MIN				8192
  PRIVATE_MAX				16383
  STATUS_RESERVED1_MIN			16384
  STATUS_RESERVED1_MAX			24577
  STATUS_INITIAL_CONTACT		24578
  STATUS_SET_WINDOW_SIZE		24579
  STATUS_ADDITIONAL_IS_POSSIBLE		24580
  STATUS_IPCOMP_SUPPORTED		24581
  STATUS_NAT_DETECTION_SOURCE_IP	24582
  STATUS_NAT_DETECTION_DESTINATION_IP	24583
  STATUS_COOKIE				24584
  STATUS_USE_TRANSPORT_MODE		24585
  STATUS_HTTP_CERT_LOOKUP_SUPPORTED	24586
  STATUS_RESERVED2_MIN			24587
  STATUS_RESERVED2_MAX			40959
  STATUS_PRIVATE_MIN			40960
  STATUS_PRIVATE_MAX			65535
.

# ISAKMP DOI Identifier.
ISAKMP_DOI
  ISAKMP		0
.

# ISAKMP Protocol ID.
ISAKMP_PROTO
  ISAKMP		1
.

# ISAKMP transaction message type.
ISAKMP_CFG
  REQUEST		1
  REPLY			2
  SET			3
  ACK			4
  FUTURE_MIN		5
  FUTURE_MAX		127
  PRIVATE_MIN		128
  PRIVATE_MAX		255
.

# ISAKMP configuration attributes.
ISAKMP_CFG_ATTR
  INTERNAL_IP4_ADDRESS		1
  INTERNAL_IP4_NETMASK		2
  INTERNAL_IP4_DNS		3
  INTERNAL_IP4_NBNS		4
  INTERNAL_ADDRESS_EXPIRY	5
  INTERNAL_IP4_DHCP		6
  APPLICATION_VERSION		7
  INTERNAL_IP6_ADDRESS		8
  INTERNAL_IP6_NETMASK		9
  INTERNAL_IP6_DNS		10
  INTERNAL_IP6_NBNS		11
  INTERNAL_IP6_DHCP		12
  INTERNAL_IP4_SUBNET		13
  SUPPORTED_ATTRIBUTES		14
  INTERNAL_IP6_SUBNET		15
  FUTURE_MIN			16
  FUTURE_MAX			16383
  PRIVATE_MIN			16384
  PRIVATE_MAX			32767
.

# ISAKMP EAP
ISAKMP_EAP_CODE
  REQUEST			1
  RESPONSE			2
  SUCCESS			3
  FAILURE			4
.

# ISAKMP EAP Types (RFC2284)
ISAKMP_EAP_TYPE
  IDENTITY			1
  NOTIFICATION			2
  NAK				3	# Response only
  MD5_CHALLENGE			4
  OTP				5
  TOKEN				6	# Generic token card
.

@


1.12
log
@introduce ISAKMP_PAYLOAD_MAX
@
text
@d1 1
a1 1
#	$OpenBSD: isakmp_num.cst,v 1.11 2005/05/18 20:04:50 hshoexer Exp $
d61 1
a61 1
  NAT_OA			21	# RFC 394y, NAT Original Address payload
@


1.11
log
@allow payload types 20 and 21 for nat-t

ok ho
@
text
@d1 1
a1 1
#	$OpenBSD: isakmp_num.cst,v 1.10 2004/08/10 15:59:10 ho Exp $
d69 1
@


1.10
log
@Better implementation of the Dead Peer Detection protocol, RFC 3706.
hshoexer@@ ok.
@
text
@d1 1
a1 1
#	$OpenBSD: isakmp_num.cst,v 1.9 2004/06/20 15:20:07 ho Exp $
d38 1
a53 1
# XXX the following are not quite legitimate according to the IETF process
d60 3
a62 1
  RESERVED_MIN			20
d65 3
a67 5
# XXX values from draft-ietf-ipsec-nat-t-ike-01,02,03. Later drafts specify
# XXX NAT_D as payload 15 and NAT_OA as 16, but these are allocated by RFC
# XXX 3547 as seen above.
  NAT_D				130	# NAT Discovery payload
  NAT_OA			131	# NAT Original Address payload
@


1.9
log
@A start towards Dead Peer Detection (DPD) support, as specified in RFC 3706
@
text
@d1 1
a1 1
#	$OpenBSD: isakmp_num.cst,v 1.8 2004/04/28 14:40:00 ho Exp $
d81 1
a81 2
  DPD				7
  FUTURE_MIN			8
@


1.8
log
@Reserve some payload numbers for RFC 3547 and the earlier NAT-T drafts. hshoexer@@ ok.
@
text
@d1 1
a1 1
#	$OpenBSD: isakmp_num.cst,v 1.7 2003/06/03 14:28:16 ho Exp $
d34 2
a35 2
# Also think about ranges, can they be specified diferently?  Can we use
# these constants for vlidity checks?
d53 1
a53 1
# XXX the following is not quite legitimate according to the IETF process
a54 1
  RESERVED_MIN			15	# XXX For now
d60 1
d63 3
d79 1
a79 1
# XXX the following is not quite legitimate according to the IETF process
d81 2
a82 1
  FUTURE_MIN			7
d157 2
@


1.7
log
@Remove clauses 3 and 4. With approval from Niklas Hallqvist and
Niels Provos.
@
text
@d1 1
a1 1
#	$OpenBSD: isakmp_num.cst,v 1.6 2003/05/12 21:48:08 ho Exp $
d55 6
a60 3
  NAT_D				15	# NAT Discovery payload
  NAT_OA			16	# NAT Original Address payload
  RESERVED_MIN			15	# XXX Change to 17 to accept NAT-T
d63 2
@


1.6
log
@Update with some data for NAT-T specific payload types, IKEv2
notifications, ISAKMP EAP code and types, plus fix an old typo.
@
text
@d1 1
a1 1
#	$OpenBSD: isakmp_num.cst,v 1.5 2001/07/01 20:43:39 niklas Exp $
a14 5
# 3. All advertising materials mentioning features or use of this software
#    must display the following acknowledgement:
#	This product includes software developed by Ericsson Radio Systems.
# 4. The name of the author may not be used to endorse or promote products
#    derived from this software without specific prior written permission.
@


1.5
log
@ISAKMP configuration, a.k.a IKECFG or "mode-config", protocol implementation.
Disabled, has no configuration mechanism yet.  This will be used for roaming
users, who are going to get parameters like IP-address and nameserver from its
peer, very much like DHCP, but securily inside an ISAKMP connection and still
in time before negotiation of IPsec connections.  You may see stylistic fixes
in this commit too.  Add some not yet used Makefile magic to deal with DNSSEC-
enabled OpenSSL too.  The IKECFG code work was sponsered by Gatespace Inc.
Thank you!  Configuration will come very soon, btw.
@
text
@d1 1
a1 1
#	$OpenBSD: isakmp_num.cst,v 1.4 2000/06/08 20:49:37 niklas Exp $
d59 4
a62 2
  ATTRIBUTE			14
  RESERVED_MIN			15
d105 3
a107 1
  RESERVED_MIN			12
d150 1
a150 1
  STATUS_DOI_MIN		12576
d158 36
d238 19
@


1.4
log
@Merge with EOM 1.3

author: angelos
Add CERTENC_KEYNOTE.
@
text
@d1 1
a1 1
#	$OpenBSD: isakmp_num.cst,v 1.3 1998/11/17 11:10:15 niklas Exp $
d5 1
a5 1
# Copyright (c) 1998 Niklas Hallqvist.  All rights reserved.
d58 3
a60 1
  RESERVED_MIN			14
d74 3
a76 1
  FUTURE_MIN			6
d162 35
@


1.3
log
@Add RCS Ids from the EOM repository
@
text
@d1 2
a2 2
#	$OpenBSD: isakmp_num.cst,v 1.2 1998/11/15 00:43:57 niklas Exp $
#	$EOM: isakmp_num.cst,v 1.2 1998/07/27 21:34:11 niklas Exp $
d98 2
a99 1
  RESERVED_MIN			11
@


1.2
log
@openBSD RCS IDs
@
text
@d1 2
a2 1
#	$OpenBSD: isakmp_num.cst,v 1.1.1.1 1998/11/15 00:03:48 niklas Exp $
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
#	$Id: isakmp_num.cst,v 1.2 1998/07/27 21:34:11 niklas Exp $
@


1.1.1.1
log
@Initial import of isakmpd, an IKE (ISAKMP/Oakley) implementation for the
OpenBSD IPSEC stack by me, Niklas Hallqvist and Niels Provos, funded by
Ericsson Radio Systems.  It is not yet complete or usable in a real scenario
but the missing pieces will soon be there.  The early commit is for people
who wants early access and who are not afraid of looking at source.
isakmpd interops with Cisco, Timestep, SSH & Pluto (Linux FreeS/WAN) so
far, so it is not that incomplete.  It is really mostly configuration that
is lacking.
@
text
@@
