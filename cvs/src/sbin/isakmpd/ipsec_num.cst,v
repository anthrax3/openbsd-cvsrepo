head	1.19;
access;
symbols
	OPENBSD_6_0:1.19.0.18
	OPENBSD_6_0_BASE:1.19
	OPENBSD_5_9:1.19.0.14
	OPENBSD_5_9_BASE:1.19
	OPENBSD_5_8:1.19.0.16
	OPENBSD_5_8_BASE:1.19
	OPENBSD_5_7:1.19.0.8
	OPENBSD_5_7_BASE:1.19
	OPENBSD_5_6:1.19.0.12
	OPENBSD_5_6_BASE:1.19
	OPENBSD_5_5:1.19.0.10
	OPENBSD_5_5_BASE:1.19
	OPENBSD_5_4:1.19.0.6
	OPENBSD_5_4_BASE:1.19
	OPENBSD_5_3:1.19.0.4
	OPENBSD_5_3_BASE:1.19
	OPENBSD_5_2:1.19.0.2
	OPENBSD_5_2_BASE:1.19
	OPENBSD_5_1_BASE:1.18
	OPENBSD_5_1:1.18.0.4
	OPENBSD_5_0:1.18.0.2
	OPENBSD_5_0_BASE:1.18
	OPENBSD_4_9:1.17.0.2
	OPENBSD_4_9_BASE:1.17
	OPENBSD_4_8:1.16.0.22
	OPENBSD_4_8_BASE:1.16
	OPENBSD_4_7:1.16.0.18
	OPENBSD_4_7_BASE:1.16
	OPENBSD_4_6:1.16.0.20
	OPENBSD_4_6_BASE:1.16
	OPENBSD_4_5:1.16.0.16
	OPENBSD_4_5_BASE:1.16
	OPENBSD_4_4:1.16.0.14
	OPENBSD_4_4_BASE:1.16
	OPENBSD_4_3:1.16.0.12
	OPENBSD_4_3_BASE:1.16
	OPENBSD_4_2:1.16.0.10
	OPENBSD_4_2_BASE:1.16
	OPENBSD_4_1:1.16.0.8
	OPENBSD_4_1_BASE:1.16
	OPENBSD_4_0:1.16.0.6
	OPENBSD_4_0_BASE:1.16
	OPENBSD_3_9:1.16.0.4
	OPENBSD_3_9_BASE:1.16
	OPENBSD_3_8:1.16.0.2
	OPENBSD_3_8_BASE:1.16
	OPENBSD_3_7:1.15.0.4
	OPENBSD_3_7_BASE:1.15
	OPENBSD_3_6:1.15.0.2
	OPENBSD_3_6_BASE:1.15
	OPENBSD_3_5:1.14.0.2
	OPENBSD_3_5_BASE:1.14
	OPENBSD_3_4:1.13.0.2
	OPENBSD_3_4_BASE:1.13
	OPENBSD_3_3:1.10.0.4
	OPENBSD_3_3_BASE:1.10
	OPENBSD_3_2:1.10.0.2
	OPENBSD_3_2_BASE:1.10
	OPENBSD_3_1:1.8.0.2
	OPENBSD_3_1_BASE:1.8
	OPENBSD_3_0:1.7.0.6
	OPENBSD_3_0_BASE:1.7
	OPENBSD_2_9:1.7.0.4
	OPENBSD_2_9_BASE:1.7
	OPENBSD_2_8:1.7.0.2
	OPENBSD_2_8_BASE:1.7
	OPENBSD_2_7:1.5.0.4
	OPENBSD_2_7_BASE:1.5
	OPENBSD_2_6:1.5.0.2
	OPENBSD_2_6_BASE:1.5
	OPENBSD_2_5:1.4.0.2
	OPENBSD_2_5_BASE:1.4
	NIKLAS_981114:1.1.1.1
	NIKLAS:1.1.1;
locks; strict;
comment	@# @;


1.19
date	2012.06.30.14.51.31;	author naddy;	state Exp;
branches;
next	1.18;

1.18
date	2011.05.13.07.41.20;	author markus;	state Exp;
branches;
next	1.17;

1.17
date	2010.09.22.13.45.16;	author mikeb;	state Exp;
branches;
next	1.16;

1.16
date	2005.06.14.10.50.47;	author hshoexer;	state Exp;
branches;
next	1.15;

1.15
date	2004.04.28.14.40.00;	author ho;	state Exp;
branches;
next	1.14;

1.14
date	2003.12.15.10.06.42;	author hshoexer;	state Exp;
branches;
next	1.13;

1.13
date	2003.06.03.14.28.16;	author ho;	state Exp;
branches;
next	1.12;

1.12
date	2003.05.14.17.37.22;	author ho;	state Exp;
branches;
next	1.11;

1.11
date	2003.05.12.21.42.11;	author ho;	state Exp;
branches;
next	1.10;

1.10
date	2002.06.14.12.43.11;	author ho;	state Exp;
branches;
next	1.9;

1.9
date	2002.06.07.20.50.12;	author ho;	state Exp;
branches;
next	1.8;

1.8
date	2002.01.27.01.56.31;	author ho;	state Exp;
branches;
next	1.7;

1.7
date	2000.10.16.23.27.55;	author niklas;	state Exp;
branches
	1.7.6.1;
next	1.6;

1.6
date	2000.10.09.23.27.31;	author niklas;	state Exp;
branches;
next	1.5;

1.5
date	99.06.02.06.32.06;	author niklas;	state Exp;
branches;
next	1.4;

1.4
date	98.11.20.07.34.07;	author niklas;	state Exp;
branches;
next	1.3;

1.3
date	98.11.17.11.10.14;	author niklas;	state Exp;
branches;
next	1.2;

1.2
date	98.11.15.00.43.56;	author niklas;	state Exp;
branches;
next	1.1;

1.1
date	98.11.15.00.03.48;	author niklas;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	98.11.15.00.03.48;	author niklas;	state Exp;
branches;
next	;

1.7.6.1
date	2002.02.21.04.18.57;	author jason;	state Exp;
branches;
next	;


desc
@@


1.19
log
@enable use of AES-{192,256}-CTR, and explicitly of AES-128-CTR, for IPsec ESP
ok mikeb@@
@
text
@#	$OpenBSD: ipsec_num.cst,v 1.18 2011/05/13 07:41:20 markus Exp $
#	$EOM: ipsec_num.cst,v 1.5 2000/10/13 17:56:52 angelos Exp $

#
# Copyright (c) 1998 Niklas Hallqvist.  All rights reserved.
# Copyright (c) 2003 Håkan Olsson.  All rights reserved.
#
# Redistribution and use in source and binary forms, with or without
# modification, are permitted provided that the following conditions
# are met:
# 1. Redistributions of source code must retain the above copyright
#    notice, this list of conditions and the following disclaimer.
# 2. Redistributions in binary form must reproduce the above copyright
#    notice, this list of conditions and the following disclaimer in the
#    documentation and/or other materials provided with the distribution.
#
# THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
# IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
# OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
# IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
# INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
# NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
# DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
# THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
# (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
# THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
#

#
# This code was written under funding by Ericsson Radio Systems.
#

# XXX Please fill in references to the drafts, chapter & verse for each
# constant group below.

# IPSEC DOI Identifier.
IPSEC_DOI
  IPSEC 1
.

# IPSEC SA attributes
IPSEC_ATTR
  SA_LIFE_TYPE				1
  SA_LIFE_DURATION			2
  GROUP_DESCRIPTION			3
  ENCAPSULATION_MODE			4
  AUTHENTICATION_ALGORITHM		5
  KEY_LENGTH				6
  KEY_ROUNDS				7
  COMPRESS_DICTIONARY_SIZE		8
  COMPRESS_PRIVATE_ALGORITHM		9
  ECN_TUNNEL				10
.

# IPSEC SA duration.
IPSEC_DURATION
  SECONDS				1
  KILOBYTES				2
.

# IPSEC encapsulation mode.
IPSEC_ENCAP
  TUNNEL				1
  TRANSPORT				2
  UDP_ENCAP_TUNNEL			3
  UDP_ENCAP_TRANSPORT			4
  UDP_ENCAP_TUNNEL_DRAFT		61443	# draft-ietf-ipsec-nat-t-ike
  UDP_ENCAP_TRANSPORT_DRAFT		61444	# draft-ietf-ipsec-nat-t-ike
.

# IPSEC authentication algorithm.
IPSEC_AUTH
  HMAC_MD5				1
  HMAC_SHA				2
  DES_MAC				3
  KPDK					4
  HMAC_SHA2_256                         5
  HMAC_SHA2_384                         6
  HMAC_SHA2_512                         7
  HMAC_RIPEMD                           8
.

# IPSEC ID types.
IPSEC_ID
  IPV4_ADDR				1
  FQDN					2
  USER_FQDN				3
  IPV4_ADDR_SUBNET			4
  IPV6_ADDR				5
  IPV6_ADDR_SUBNET			6
  IPV4_RANGE				7
  IPV6_RANGE				8
  DER_ASN1_DN				9
  DER_ASN1_GN				10
  KEY_ID				11
.

# IKE SA attributes
IKE_ATTR
  ENCRYPTION_ALGORITHM			1	ike_encrypt_cst
  HASH_ALGORITHM			2	ike_hash_cst
  AUTHENTICATION_METHOD			3	ike_auth_cst
  GROUP_DESCRIPTION			4	ike_group_desc_cst
  GROUP_TYPE				5	ike_group_cst
  GROUP_PRIME				6
  GROUP_GENERATOR_1			7
  GROUP_GENERATOR_2			8
  GROUP_CURVE_A				9
  GROUP_CURVE_B				10
  LIFE_TYPE				11	ike_duration_cst
  LIFE_DURATION				12
  PRF					13	ike_prf_cst
  KEY_LENGTH				14
  FIELD_SIZE				15
  GROUP_ORDER				16
  BLOCK_SIZE				17
.

# XXX Fill in reserved ranges for the attributes below.

# IKE encryption algorithm.
IKE_ENCRYPT
  DES_CBC				1
  IDEA_CBC				2
  BLOWFISH_CBC				3
  RC5_R16_B64_CBC			4
  3DES_CBC				5
  CAST_CBC				6
  AES_CBC                               7
.

# IKE hash algorithm.
IKE_HASH
  MD5					1
  SHA					2
  TIGER					3
  SHA2_256                              4
  SHA2_384                              5
  SHA2_512                              6
.

# IKE authentication method.
IKE_AUTH
  PRE_SHARED				1
  DSS					2
  RSA_SIG				3
  RSA_ENC				4
  RSA_ENC_REV				5
  EL_GAMAL_ENC				6
  EL_GAMAL_ENC_REV			7
  ECDSA_SIG				8
.

# IKE group description.
IKE_GROUP_DESC
  MODP_768				1
  MODP_1024				2
  EC2N_155				3
  EC2N_185				4
  MODP_1536				5
  EC2N_163sect				6
  EC2N_163K				7
  EC2N_283sect				8
  EC2N_283K				9
  EC2N_409sect				10
  EC2N_409K				11
  EC2N_571sect				12
  EC2N_571K				13
  MODP_2048				14
  MODP_3072				15
  MODP_4096				16
  MODP_6144				17
  MODP_8192				18
.

# IKE Group type.
IKE_GROUP
  MODP					1
  ECP					2
  EC2N					3
.

# IKE SA duration.
IKE_DURATION
  SECONDS				1
  KILOBYTES				2
.

# IKE Pseudo random function.  No defined so far.
IKE_PRF
.

# IPSEC Situation bits.
IPSEC_SIT
  IDENTITY_ONLY				1
  SECRECY				2
  INTEGRITY				4
.

# IPSEC security protocol IDs.
IPSEC_PROTO
  IPSEC_AH				2
  IPSEC_ESP				3
  IPCOMP				4
.

# IPSEC ISAKMP transform IDs.
IPSEC_TRANSFORM
  KEY_IKE				1
.

# IPSEC AH transform IDs.
IPSEC_AH
  MD5					2
  SHA					3
  DES					4
  SHA2_256                              5
  SHA2_384                              6
  SHA2_512                              7
  RIPEMD                                8
.

# IPSEC ESP transform IDs.
IPSEC_ESP
  DES_IV64				1
  DES					2
  3DES					3
  RC5					4
  IDEA					5
  CAST					6
  BLOWFISH				7
  3IDEA					8
  DES_IV32				9
  RC4					10
  NULL					11
  AES					12
  AES_CTR				13
  AES_GCM_16				20
  AES_GMAC				23
  AES_MARS				249
  AES_RC6				250
  AES_RIJNDAEL				251
  AES_SERPENT				252
  AES_TWOFISH				253
.

# IPSEC IPCOMP transform IDs
IPSEC_IPCOMP
  OUI					1
  DEFLATE				2
  LZS					3
  V42BIS				4
.

# IPSEC notify message types.
IPSEC_NOTIFY
  RESPONDER_LIFETIME			24576
  REPLAY_STATUS				24577
  INITIAL_CONTACT			24578
.

# IKE exchange types.
IKE_EXCH
  QUICK_MODE				32
  NEW_GROUP_MODE			33
.
@


1.18
log
@wrong id for UDP_ENCAP_TRANSPORT_DRAFT; ok mikeb@@
@
text
@d1 1
a1 1
#	$OpenBSD: ipsec_num.cst,v 1.17 2010/09/22 13:45:16 mikeb Exp $
d237 1
a237 1
  AES_128_CTR				13
@


1.17
log
@Support for use of AES-GCM-16 (as AESGCM) and ENCR_NULL_AUTH_AES_GMAC
(as AESGMAC) ciphers in the ISAKMP Phase 2 (aka Quick Mode).

Thoroughly tested by me and naddy.  Works fine with Linux.

Requires updated pfkeyv2.h include file.

ok naddy
@
text
@d1 1
a1 1
#	$OpenBSD: ipsec_num.cst,v 1.16 2005/06/14 10:50:47 hshoexer Exp $
d68 1
a68 1
  UDP_ENCAP_TRANSPORT_DRAFT		61443	# draft-ietf-ipsec-nat-t-ike
@


1.16
log
@add ENCAP_UDP_{TUNNEL,TRANSPORT} types according to rfc 3947

ok markus
@
text
@d1 1
a1 1
#	$OpenBSD: ipsec_num.cst,v 1.15 2004/04/28 14:40:00 ho Exp $
d238 2
@


1.15
log
@Reserve some payload numbers for RFC 3547 and the earlier NAT-T drafts. hshoexer@@ ok.
@
text
@d1 1
a1 1
#	$OpenBSD: ipsec_num.cst,v 1.14 2003/12/15 10:06:42 hshoexer Exp $
d65 4
a68 4
  FUTURE_UDP_ENCAP_TUNNEL		3	# XXX Not yet assigned
  FUTURE_UDP_ENCAP_TRANSPORT		4	# XXX Not yet assigned
  UDP_ENCAP_TUNNEL			61443	# draft-ietf-ipsec-nat-t-ike
  UDP_ENCAP_TRANSPORT			61443	# draft-ietf-ipsec-nat-t-ike
@


1.14
log
@Support for groups modp2048, modp3072, modp4096, modp6144 and modp8192 (IDs 14
to 18).

ok ho@@
@
text
@d1 1
a1 1
#	$OpenBSD: ipsec_num.cst,v 1.13 2003/06/03 14:28:16 ho Exp $
d65 4
a68 2
  UDP_ENCAP_TUNNEL			3
  UDP_ENCAP_TRANSPORT			4
@


1.13
log
@Remove clauses 3 and 4. With approval from Niklas Hallqvist and
Niels Provos.
@
text
@d1 1
a1 1
#	$OpenBSD: ipsec_num.cst,v 1.12 2003/05/14 17:37:22 ho Exp $
d167 5
@


1.12
log
@I did not test this enough. Unbreak.
@
text
@d1 1
a1 1
#	$OpenBSD: ipsec_num.cst,v 1.11 2003/05/12 21:42:11 ho Exp $
a15 5
# 3. All advertising materials mentioning features or use of this software
#    must display the following acknowledgement:
#	This product includes software developed by Ericsson Radio Systems.
# 4. The name of the author may not be used to endorse or promote products
#    derived from this software without specific prior written permission.
@


1.11
log
@Add two more encapsulation types (UDP encap, potential future NAT-T)
Add BLOCK_SIZE attribute
Rename IPSEC_ESP_AES -> IPSEC_ESP_AES_128_CBC.
@
text
@d1 1
a1 1
#	$OpenBSD: ipsec_num.cst,v 1.10 2002/06/14 12:43:11 ho Exp $
d234 1
a234 1
  AES_128_CBC				12
@


1.10
log
@Recognize the ECN_TUNNEL attribute.
@
text
@d1 1
a1 1
#	$OpenBSD: ipsec_num.cst,v 1.9 2002/06/07 20:50:12 ho Exp $
d6 1
d70 2
d119 1
d234 2
a235 1
  AES                                   12
@


1.9
log
@Extend as per current IANA assignments
@
text
@d1 1
a1 1
#	$OpenBSD: ipsec_num.cst,v 1.8 2002/01/27 01:56:31 ho Exp $
d56 1
@


1.8
log
@Add the (former) AES candidate ESP ciphers for IKE, as of
http://csrc.nist.gov/ipsec/papers/aes-draft.00.txt
In particular, recognize a Twofish proposal with cipher number 253, as used
by the SSH Sentinel.
@
text
@d1 1
a1 1
#	$OpenBSD: ipsec_num.cst,v 1.7 2000/10/16 23:27:55 niklas Exp $
d147 3
d159 8
@


1.7
log
@ipsec_num.cst: Merge with EOM 1.5
isakmpd.policy.5: Merge with EOM 1.22

author: angelos
Add RIPEMD negotiation/configuration.
@
text
@d1 1
a1 1
#	$OpenBSD: ipsec_num.cst,v 1.6 2000/10/09 23:27:31 niklas Exp $
d219 5
@


1.7.6.1
log
@Pull in patch from current:
Fix (ho):
Add the (former) AES candidate ESP ciphers for IKE, as of
http://csrc.nist.gov/ipsec/papers/aes-draft.00.txt
In particular, recognize a Twofish proposal with cipher number 253, as
used by the SSH Sentinel.
@
text
@d1 1
a1 1
#	$OpenBSD: ipsec_num.cst,v 1.7 2000/10/16 23:27:55 niklas Exp $
a218 5
  AES_MARS				249
  AES_RC6				250
  AES_RIJNDAEL				251
  AES_SERPENT				252
  AES_TWOFISH				253
@


1.6
log
@samples/VPN-3way-template.conf: Merge with EOM 1.8
samples/VPN-east.conf: Merge with EOM 1.12
samples/VPN-west.conf: Merge with EOM 1.13
samples/policy: Merge with EOM 1.6
samples/singlehost-west.conf: Merge with EOM 1.9
samples/singlehost-east.conf: Merge with EOM 1.9
conf.c: Merge with EOM 1.37
ipsec.c: Merge with EOM 1.133
ipsec_num.cst: Merge with EOM 1.4
isakmpd.conf.5: Merge with EOM 1.48
isakmpd.policy.5: Merge with EOM 1.21
policy.c: Merge with EOM 1.46

author: angelos
AES support.
@
text
@d1 2
a2 2
#	$OpenBSD: ipsec_num.cst,v 1.5 1999/06/02 06:32:06 niklas Exp $
#	$EOM: ipsec_num.cst,v 1.4 2000/10/09 22:08:29 angelos Exp $
d76 4
d202 1
@


1.5
log
@Merge with EOM 1.3

author: niklas
Initial stab at Oakley group 5, still an XXX though.
@
text
@d1 2
a2 2
#	$OpenBSD: ipsec_num.cst,v 1.4 1998/11/20 07:34:07 niklas Exp $
#	$EOM: ipsec_num.cst,v 1.3 1999/05/27 15:17:54 niklas Exp $
d123 1
d131 3
d195 3
d213 1
@


1.4
log
@Add submaps to constant maps, and add a mechanism to the constant
description language to link maps.
@
text
@d1 2
a2 2
#	$OpenBSD: ipsec_num.cst,v 1.3 1998/11/17 11:10:14 niklas Exp $
#	$EOM: ipsec_num.cst,v 1.2 1998/11/20 07:17:03 niklas Exp $
d147 1
@


1.3
log
@Add RCS Ids from the EOM repository
@
text
@d1 2
a2 2
#	$OpenBSD: ipsec_num.cst,v 1.2 1998/11/15 00:43:56 niklas Exp $
#	$EOM: ipsec_num.cst,v 1.1 1998/07/25 11:19:11 niklas Exp $
d95 5
a99 5
  ENCRYPTION_ALGORITHM			1
  HASH_ALGORITHM			2
  AUTHENTICATION_METHOD			3
  GROUP_DESCRIPTION			4
  GROUP_TYPE				5
d105 1
a105 1
  LIFE_TYPE				11
d107 1
a107 1
  PRF					13
@


1.2
log
@openBSD RCS IDs
@
text
@d1 2
a2 1
#	$OpenBSD: ipsec_num.cst,v 1.1.1.1 1998/11/15 00:03:48 niklas Exp $
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
#	$Id: ipsec_num.cst,v 1.1 1998/07/25 11:19:11 niklas Exp $
@


1.1.1.1
log
@Initial import of isakmpd, an IKE (ISAKMP/Oakley) implementation for the
OpenBSD IPSEC stack by me, Niklas Hallqvist and Niels Provos, funded by
Ericsson Radio Systems.  It is not yet complete or usable in a real scenario
but the missing pieces will soon be there.  The early commit is for people
who wants early access and who are not afraid of looking at source.
isakmpd interops with Cisco, Timestep, SSH & Pluto (Linux FreeS/WAN) so
far, so it is not that incomplete.  It is really mostly configuration that
is lacking.
@
text
@@
