head	1.8;
access;
symbols
	OPENBSD_3_7:1.7.0.24
	OPENBSD_3_7_BASE:1.7
	OPENBSD_3_6:1.7.0.22
	OPENBSD_3_6_BASE:1.7
	OPENBSD_3_5:1.7.0.20
	OPENBSD_3_5_BASE:1.7
	OPENBSD_3_4:1.7.0.18
	OPENBSD_3_4_BASE:1.7
	OPENBSD_3_3:1.7.0.16
	OPENBSD_3_3_BASE:1.7
	OPENBSD_3_2:1.7.0.14
	OPENBSD_3_2_BASE:1.7
	OPENBSD_3_1:1.7.0.12
	OPENBSD_3_1_BASE:1.7
	OPENBSD_3_0:1.7.0.10
	OPENBSD_3_0_BASE:1.7
	OPENBSD_2_9:1.7.0.8
	OPENBSD_2_9_BASE:1.7
	OPENBSD_2_8:1.7.0.6
	OPENBSD_2_8_BASE:1.7
	OPENBSD_2_7:1.7.0.4
	OPENBSD_2_7_BASE:1.7
	OPENBSD_2_6:1.7.0.2
	OPENBSD_2_6_BASE:1.7;
locks; strict;
comment	@# @;


1.8
date	2005.06.01.11.11.02;	author hshoexer;	state dead;
branches;
next	1.7;

1.7
date	99.10.01.14.10.45;	author niklas;	state Exp;
branches;
next	1.6;

1.6
date	99.08.26.22.30.46;	author niklas;	state Exp;
branches;
next	1.5;

1.5
date	99.08.05.22.41.47;	author niklas;	state Exp;
branches;
next	1.4;

1.4
date	99.07.18.09.43.09;	author niklas;	state Exp;
branches;
next	1.3;

1.3
date	99.07.18.09.33.33;	author niklas;	state Exp;
branches;
next	1.2;

1.2
date	99.07.17.22.00.19;	author niklas;	state Exp;
branches;
next	1.1;

1.1
date	99.07.17.21.54.39;	author niklas;	state Exp;
branches;
next	;


desc
@@


1.8
log
@This file is outdated, everything needed for setting up PKI is in the man pages
now.  noticed by david@@

ok ho markus
@
text
@$OpenBSD: README.PKI,v 1.7 1999/10/01 14:10:45 niklas Exp $
$EOM: README.PKI,v 1.7 1999/09/30 13:40:38 niklas Exp $

1	Make sure you have an RSA-enabled isakmpd.  An easy way to do this
	is to install a dynamically linkable version of libcrypto from
	OpenSSL and install it where the run-time linker can find it.

2	Create your own CA as root.

	openssl genrsa -out /etc/ssl/private/ca.key 1024
	openssl req -new -key /etc/ssl/private/ca.key \
		-out /etc/ssl/private/ca.csr

	You are now being asked to enter information that will be incorporated
	into your certificate request.  What you are about to enter is what is
	called a Distinguished Name or a DN.  There are quite a few fields but
	you can leave some blank.  For some fields there will be a default
	value, if you enter '.', the field will be left blank.

	openssl x509 -req -days 365 -in /etc/ssl/private/ca.csr \
		-signkey /etc/ssl/private/ca.key \
		-out /etc/ssl/ca.crt

3	Create keys and certificates for your isakmpd peers.  This step as well
	as the next one, needs to be done for every peer.  Furthermore the
	last step will need to be done once for each ID you want the peer
	to have.  The 10.0.0.1 below symbolizes that ID, and should be
	changed for each invocation.  You will be asked for a DN for each
	run too.  See to encode the ID in the common name too, so it gets
	unique.

	openssl genrsa -out /etc/isakmpd/private/local.key 1024
	openssl req -new -key /etc/isakmpd/private/local.key \
		-out /etc/isakmpd/private/10.0.0.1.csr

	Now take these certificate signing requests to your CA and process
	them like below.  You have to add some extensions to the certificate
	in order to make it usable for isakmpd, which is why you will need
	to run certpatch.  Replace 10.0.0.1 with the IP-address which isakmpd
	will be using for identity.

	openssl x509 -req -days 365 -in 10.0.0.1.csr -CA /etc/ssl/ca.crt \
		-CAkey /etc/ssl/private/ca.key -CAcreateserial \
		-out 10.0.0.1.crt
	certpatch -i 10.0.0.1 -k /etc/ssl/private/ca.key \
		10.0.0.1.crt 10.0.0.1.crt

	Put the certificate (the file ending in .crt) in /etc/isakmpd/certs/
	on your local system.  Also carry over the CA cert /etc/ssl/ca.crt
	and put it in /etc/isakmpd/ca/.

4	See to that your config files will point out the directories where
	you keep certificates.  I.e. add something like this to
	/etc/isakmpd/isakmpd.conf:

	# Certificates stored in PEM format
	[X509-certificates]
	CA-directory=		/etc/isakmpd/ca/
	Cert-directory=		/etc/isakmpd/certs/
	Private-key=		/etc/isakmpd/private/local.key
@


1.7
log
@regress/x509/x509test.c: Merge with EOM 1.8
README.PKI: Merge with EOM 1.7

author: niklas
OpenSSL 0.9.4 support
@
text
@d1 1
a1 1
$OpenBSD: README.PKI,v 1.6 1999/08/26 22:30:46 niklas Exp $
@


1.6
log
@regress/rsakeygen/rsakeygen.c: Merge with EOM 1.9
regress/x509/x509test.c: Merge with EOM 1.7
DESIGN-NOTES: Merge with EOM 1.48
README.PKI: Merge with EOM 1.6
TO-DO: Merge with EOM 1.44
cert.c: Merge with EOM 1.12

author: niklas
Add support for dynamic loading of optional facilities, libcrypto first.
@
text
@d1 2
a2 2
$OpenBSD: README.PKI,v 1.5 1999/08/05 22:41:47 niklas Exp $
$EOM: README.PKI,v 1.6 1999/08/12 22:34:26 niklas Exp $
d5 2
a6 3
	is to find a dynamically linkable version of libcrypto from SSLeay
	or perhaps OpenSSL (not tested by me) and install it where the
	run-time linker can find it.
d10 2
a11 2
	ssleay genrsa -out /etc/ssl/private/ca.key 1024
	ssleay req -new -key /etc/ssl/private/ca.key \
d20 1
a20 1
	ssleay x509 -req -days 365 -in /etc/ssl/private/ca.csr \
d32 2
a33 2
	ssleay genrsa -out /etc/isakmpd/private/local.key 1024
	ssleay req -new -key /etc/isakmpd/private/local.key \
d42 1
a42 1
	ssleay x509 -req -days 365 -in 10.0.0.1.csr -CA /etc/ssl/ca.crt \
@


1.5
log
@Merge with EOM 1.5

author: niklas
typo
@
text
@d1 2
a2 2
$OpenBSD: README.PKI,v 1.4 1999/07/18 09:43:09 niklas Exp $
$EOM: README.PKI,v 1.5 1999/07/18 21:46:07 niklas Exp $
d4 6
a9 1
1	Create your own CA as root.
d25 1
a25 1
2	Create keys and certificates for your isakmpd peers.  This step as well
d53 1
a53 1
3	See to that your config files will point out the directories where
@


1.4
log
@Merge with EOM 1.4

author: niklas
Remove obsolete mkdirs
@
text
@d1 2
a2 2
$OpenBSD: README.PKI,v 1.3 1999/07/18 09:33:33 niklas Exp $
$EOM: README.PKI,v 1.4 1999/07/18 09:44:58 niklas Exp $
d50 1
a50 1
	/etc/isakmp/conf:
@


1.3
log
@samples/VPN-east.conf: Merge with EOM 1.7
samples/VPN-west.conf: Merge with EOM 1.7
samples/singlehost-west.conf: Merge with EOM 1.4
samples/singlehost-east.conf: Merge with EOM 1.4
README.PKI: Merge with EOM 1.3
ike_auth.c: Merge with EOM 1.33
isakmpd.conf.5: Merge with EOM 1.28

author: niklas
Moving the PRIVKEY tag into the X509-certificates section, renaming it to
Private-key.  Also rename the keynote policy file.
@
text
@d1 2
a2 2
$OpenBSD: README.PKI,v 1.2 1999/07/17 22:00:19 niklas Exp $
$EOM: README.PKI,v 1.3 1999/07/18 09:25:33 niklas Exp $
a27 2
	mkdir -p /etc/isakmpd/private /etc/isakmpd/ca /etc/isakmpd/certs
	chmod 600 /etc/isakmpd/private
@


1.2
log
@Merge with EOM 1.2

author: niklas
RCD Id
@
text
@d1 2
a2 2
$OpenBSD: README.PKI,v 1.1 1999/07/17 21:54:39 niklas Exp $
$EOM: README.PKI,v 1.2 1999/07/17 21:29:47 niklas Exp $
d58 1
a58 3

	[RSA_SIG]
	PRIVKEY=		/etc/isakmpd/private/local.key
@


1.1
log
@regress/rsakeygen/Makefile: Merge with EOM 1.4
regress/rsakeygen/rsakeygen.c: Merge with EOM 1.8
regress/x509/Makefile: Merge with EOM 1.6
regress/x509/x509test.c: Merge with EOM 1.6
regress/Makefile: Merge with EOM 1.8
samples/VPN-east.conf: Merge with EOM 1.6
samples/VPN-west.conf: Merge with EOM 1.6
samples/singlehost-east.conf: Merge with EOM 1.3
samples/singlehost-west.conf: Merge with EOM 1.3
sysdep/openbsd/Makefile.sysdep: Merge with EOM 1.5
x509.h: Merge with EOM 1.6
x509.c: Merge with EOM 1.17
DESIGN-NOTES: Merge with EOM 1.46
Makefile: Merge with EOM 1.55
cert.c: Merge with EOM 1.11
cert.h: Merge with EOM 1.6
exchange.c: Merge with EOM 1.109
exchange.h: Merge with EOM 1.26
ike_auth.c: Merge with EOM 1.32
ike_phase_1.c: Merge with EOM 1.7
init.c: Merge with EOM 1.16
isakmpd.conf.5: Merge with EOM 1.27
README.PKI: Merge with EOM 1.1

author: niklas
From Niels Provos, edited by me: certificate support using SSLeay
@
text
@d1 2
a2 1
$OpenBSD$
@

