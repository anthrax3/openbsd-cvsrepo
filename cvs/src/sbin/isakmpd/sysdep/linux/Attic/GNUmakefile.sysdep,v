head	1.13;
access;
symbols
	OPENBSD_3_7:1.11.0.2
	OPENBSD_3_7_BASE:1.11
	OPENBSD_3_6:1.9.0.2
	OPENBSD_3_6_BASE:1.9
	OPENBSD_3_5:1.7.0.4
	OPENBSD_3_5_BASE:1.7
	OPENBSD_3_4:1.7.0.2
	OPENBSD_3_4_BASE:1.7
	OPENBSD_3_3:1.4.0.4
	OPENBSD_3_3_BASE:1.4
	OPENBSD_3_2:1.4.0.2
	OPENBSD_3_2_BASE:1.4
	OPENBSD_3_1:1.3.0.6
	OPENBSD_3_1_BASE:1.3
	OPENBSD_3_0:1.3.0.4
	OPENBSD_3_0_BASE:1.3
	OPENBSD_2_9:1.3.0.2
	OPENBSD_2_9_BASE:1.3;
locks; strict;
comment	@# @;


1.13
date	2005.04.08.15.49.59;	author deraadt;	state dead;
branches;
next	1.12;

1.12
date	2005.04.05.22.53.50;	author cloder;	state Exp;
branches;
next	1.11;

1.11
date	2005.02.10.15.00.36;	author ho;	state Exp;
branches;
next	1.10;

1.10
date	2005.02.10.13.07.23;	author ho;	state Exp;
branches;
next	1.9;

1.9
date	2004.08.10.09.49.51;	author ho;	state Exp;
branches;
next	1.8;

1.8
date	2004.06.26.03.40.57;	author mcbride;	state Exp;
branches;
next	1.7;

1.7
date	2003.06.03.15.20.41;	author ho;	state Exp;
branches;
next	1.6;

1.6
date	2003.05.18.18.16.34;	author ho;	state Exp;
branches;
next	1.5;

1.5
date	2003.05.14.20.49.37;	author ho;	state dead;
branches;
next	1.4;

1.4
date	2002.06.10.18.08.59;	author ho;	state Exp;
branches;
next	1.3;

1.3
date	2001.02.24.04.42.48;	author angelos;	state Exp;
branches;
next	1.2;

1.2
date	2001.01.28.22.38.48;	author niklas;	state Exp;
branches;
next	1.1;

1.1
date	2001.01.26.11.34.04;	author niklas;	state Exp;
branches;
next	;


desc
@@


1.13
log
@if someone wants a portable, create a -p project.  clutter stops quality
@
text
@#	$OpenBSD: GNUmakefile.sysdep,v 1.12 2005/04/05 22:53:50 cloder Exp $

#
# Copyright (c) 1999 Niklas Hallqvist.  All rights reserved.
# Copyright (c) 2003 Thomas Walpuski.  All rights reserved.
#
# Redistribution and use in source and binary forms, with or without
# modification, are permitted provided that the following conditions
# are met:
# 1. Redistributions of source code must retain the above copyright
#    notice, this list of conditions and the following disclaimer.
# 2. Redistributions in binary form must reproduce the above copyright
#    notice, this list of conditions and the following disclaimer in the
#    documentation and/or other materials provided with the distribution.
#
# THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
# IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
# OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
# IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
# INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
# NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
# DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
# THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
# (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
# THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
#

LIBGMP:=	/usr/lib/libgmp.a
LIBCRYPTO:=	/usr/lib/libcrypto.a
LIBSYSDEPDIR:=	${.CURDIR}/sysdep/common/libsysdep
LIBSYSDEP:=	${LIBSYSDEPDIR}/libsysdep.a

LDADD+=		-lgmp ${LIBSYSDEP} ${LIBCRYPTO}
DPADD+=		${LIBGMP} ${LIBSYSDEP}

CFLAGS+=	-DUSE_OLD_SOCKADDR -DHAVE_PCAP \
		-DNEED_SYSDEP_APP -DMP_FLAVOUR=MP_FLAVOUR_GMP \
		-I/usr/src/linux/include -I${.CURDIR}/sysdep/common \
		-I/usr/include/openssl

FEATURES=	debug tripledes blowfish cast ec aggressive x509 policy
FEATURES+=	des aes nat_traversal dpd

IPSEC_SRCS=	pf_key_v2.c
IPSEC_CFLAGS=	-DUSE_PF_KEY_V2

USE_LIBCRYPO=	defined
USE_KEYNOTE=	defined

# hack libsysdep.a dependenc
${LIBSYSDEPDIR}/.depend ${LIBSYSDEP}:
	cd ${LIBSYSDEPDIR} && \
		${MAKE} --no-print-directory ${MAKEFLAGS} \
			CFLAGS="${CFLAGS}" MKDEP="${MKDEP}" ${MAKECMDGOALS}

ifeq ($(findstring clean,$(MAKECMDGOALS)),clean)
SUBDIR+=	sysdep/common/libsysdep
MAKEFLAGS+=	--no-print-directory
endif
@


1.12
log
@Now that X509 is de-featurized, no need for USE_X509 in regress tests.
Start compiling the X509 regress test again, for the first time since
2002 when DLOPEN stuff was removed.  Kill remnants of DLOPEN defines
left around in other Makefiles.  Allow isakmpd to compile if USE_KEYNOTE
is not defined.
@
text
@d1 1
a1 1
#	$OpenBSD: GNUmakefile.sysdep,v 1.11 2005/02/10 15:00:36 ho Exp $
@


1.11
log
@Also add DPD.
@
text
@d1 1
a1 1
#	$OpenBSD: GNUmakefile.sysdep,v 1.10 2005/02/10 13:07:23 ho Exp $
a47 1
HAVE_DLOPEN=	defined
@


1.10
log
@Add NAT-T here too.
@
text
@d1 1
a1 1
#	$OpenBSD: GNUmakefile.sysdep,v 1.9 2004/08/10 09:49:51 ho Exp $
d42 1
a42 1
FEATURES+=	des aes nat_traversal
@


1.9
log
@Linux has AES (and DES). From Benjamin Pineau.
@
text
@d1 1
a1 1
#	$OpenBSD: GNUmakefile.sysdep,v 1.8 2004/06/26 03:40:57 mcbride Exp $
d42 1
a42 1
FEATURES+=	des aes
@


1.8
log
@Remove -DHAVE_GETNAMEINFO frome makefiles.

Pointed out by ho@@
@
text
@d1 1
a1 1
#	$OpenBSD: GNUmakefile.sysdep,v 1.7 2003/06/03 15:20:41 ho Exp $
d42 1
@


1.7
log
@Remove clause 3. Approved by niklas@@ and Thomas Walpuski.
@
text
@d1 1
a1 1
#	$OpenBSD: GNUmakefile.sysdep,v 1.6 2003/05/18 18:16:34 ho Exp $
d36 1
a36 1
CFLAGS+=	-DHAVE_GETNAMEINFO -DUSE_OLD_SOCKADDR -DHAVE_PCAP \
@


1.6
log
@Sysdep for native Linux IPSec, 2.5 and later. From Thomas Walpuski, with
various tweaks by me. niklas@@ ok.
@
text
@d1 1
a1 1
#	$OpenBSD$
a14 2
# 3. The name of the author may not be used to endorse or promote products
#    derived from this software without specific prior written permission.
@


1.5
log
@Call the FreeS/WAN sysdep 'freeswan'. The 'linux' sysdep will be native Linux IPSec.
@
text
@d1 1
a1 1
#	$OpenBSD: GNUmakefile.sysdep,v 1.4 2002/06/10 18:08:59 ho Exp $
d5 1
d15 1
a15 4
# 3. All advertising materials mentioning features or use of this software
#    must display the following acknowledgement:
#	This product includes software developed by Ericsson Radio Systems.
# 4. The name of the author may not be used to endorse or promote products
d30 27
a56 40
#
# This code was written under funding by Ericsson Radio Systems.
#

# In order for this to work, invocations need to set FREESWAN to the
# directory where FreeS/WAN is installed.

ifndef FREESWAN
FREESWAN=	/usr/src/freeswan
endif

BINDIR=		/usr/local/sbin
# Partly good for RedHat 5.2, but man(1) does not find them so I have it
# disabled for now.
#MANDIR=		/var/catman/cat
#MAN5=		isakmpd.conf.0
#MAN8=		isakmpd.0
NOMAN=

LIBGMP= -lgmp
LIBDES=		${FREESWAN}/libdes/libdes.a
LIBSYSDEPDIR=	${.CURDIR}/sysdep/common/libsysdep
LIBSYSDEP=	${LIBSYSDEPDIR}/libsysdep.a

FEATURES=	tripledes blowfish cast ec aggressive debug

SRCS+=		klips.c

LDADD+=		${LIBSYSDEP} ${LIBGMP} ${LIBDES} -ldl
DPADD+=		${LIBSYSDEP} ${LIBGMP} ${LIBDES}

CFLAGS+=	-I${FREESWAN}/gmp -I${FREESWAN}/libdes \
		-I${FREESWAN}/klips -I${FREESWAN}/lib -DUSE_OLD_SOCKADDR \
		-I${.CURDIR}/sysdep/common -DSYMBOL_PREFIX='"_"'
CFLAGS+=        -DMP_FLAVOUR=MP_FLAVOUR_GMP
CFLAGS+=	-D'SALEN(x)=8'

${LIBSYSDEP}:
	cd ${LIBSYSDEPDIR}; \
		${MAKE} --no-print-directory ${MAKEFLAGS} CFLAGS="${CFLAGS}" MKDEP="${MKDEP}"
d58 1
a58 1
ifneq ($(findstring install,$(MAKECMDGOALS)),install)
d60 1
a60 2
# The regress/ subdir is completely broken in the linux environment
SUBDIR:=	$(filter-out regress,${SUBDIR})
@


1.4
log
@The dlopen() stuff goes away.
@
text
@d1 1
a1 1
#	$OpenBSD: GNUmakefile.sysdep,v 1.3 2001/02/24 04:42:48 angelos Exp $
@


1.3
log
@Make DES a feature, so isakmpd can compile on Linux (most of the fixed
by newsham@@lava.net)
@
text
@d1 1
a1 1
#	$OpenBSD: GNUmakefile.sysdep,v 1.2 2001/01/28 22:38:48 niklas Exp $
a67 2

HAVE_DLOPEN=	defined
@


1.2
log
@$OpenBSD$
@
text
@d1 1
a1 1
#	$OpenBSD: GNUmakefile.sysdep,v 1.1 2001/01/26 11:34:04 niklas Exp $
d51 1
a51 1
LIBGMP=		${FREESWAN}/gmp/libgmp.a
d66 2
@


1.1
log
@Move in foreign OS support.  The OpenBSD repository is now the official
isakmpd home.
@
text
@d1 1
a1 1
#	$Id: GNUmakefile.sysdep,v 1.9 2000/05/04 20:57:41 provos Exp $
@

