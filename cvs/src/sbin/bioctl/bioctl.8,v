head	1.103;
access;
symbols
	OPENBSD_6_1:1.103.0.4
	OPENBSD_6_1_BASE:1.103
	OPENBSD_6_0:1.99.0.2
	OPENBSD_6_0_BASE:1.99
	OPENBSD_5_9:1.98.0.2
	OPENBSD_5_9_BASE:1.98
	OPENBSD_5_8:1.96.0.4
	OPENBSD_5_8_BASE:1.96
	OPENBSD_5_7:1.94.0.2
	OPENBSD_5_7_BASE:1.94
	OPENBSD_5_6:1.93.0.6
	OPENBSD_5_6_BASE:1.93
	OPENBSD_5_5:1.93.0.4
	OPENBSD_5_5_BASE:1.93
	OPENBSD_5_4:1.91.0.2
	OPENBSD_5_4_BASE:1.91
	OPENBSD_5_3:1.90.0.2
	OPENBSD_5_3_BASE:1.90
	OPENBSD_5_2:1.89.0.4
	OPENBSD_5_2_BASE:1.89
	OPENBSD_5_1_BASE:1.89
	OPENBSD_5_1:1.89.0.2
	OPENBSD_5_0:1.84.0.4
	OPENBSD_5_0_BASE:1.84
	OPENBSD_4_9:1.84.0.2
	OPENBSD_4_9_BASE:1.84
	OPENBSD_4_8:1.80.0.4
	OPENBSD_4_8_BASE:1.80
	OPENBSD_4_7:1.80.0.2
	OPENBSD_4_7_BASE:1.80
	OPENBSD_4_6:1.70.0.4
	OPENBSD_4_6_BASE:1.70
	OPENBSD_4_5:1.64.0.2
	OPENBSD_4_5_BASE:1.64
	OPENBSD_4_4:1.57.0.2
	OPENBSD_4_4_BASE:1.57
	OPENBSD_4_3:1.51.0.2
	OPENBSD_4_3_BASE:1.51
	OPENBSD_4_2:1.49.0.2
	OPENBSD_4_2_BASE:1.49
	OPENBSD_4_1:1.41.0.4
	OPENBSD_4_1_BASE:1.41
	OPENBSD_4_0:1.41.0.2
	OPENBSD_4_0_BASE:1.41
	OPENBSD_3_9:1.39.0.2
	OPENBSD_3_9_BASE:1.39
	OPENBSD_3_8:1.38.0.2
	OPENBSD_3_8_BASE:1.38;
locks; strict;
comment	@.\" @;


1.103
date	2016.11.27.18.04.18;	author stsp;	state Exp;
branches;
next	1.102;
commitid	ObUkFSkJNCNTOFDI;

1.102
date	2016.09.21.17.57.33;	author jsing;	state Exp;
branches;
next	1.101;
commitid	BvGmKgXHHwTyVJep;

1.101
date	2016.09.21.17.08.04;	author jsing;	state Exp;
branches;
next	1.100;
commitid	KXOLqRoRfpcNAx9Q;

1.100
date	2016.09.19.18.02.20;	author jsing;	state Exp;
branches;
next	1.99;
commitid	mGXcKJY0eIvfR32z;

1.99
date	2016.04.04.18.53.31;	author krw;	state Exp;
branches;
next	1.98;
commitid	0qBygIBczTYB3OoC;

1.98
date	2015.10.22.08.35.18;	author jmc;	state Exp;
branches;
next	1.97;
commitid	QJxw4ThuqeXyKV34;

1.97
date	2015.09.12.14.21.25;	author schwarze;	state Exp;
branches;
next	1.96;
commitid	0FWtA0mDtKz2vrJC;

1.96
date	2015.05.29.00.33.37;	author uebayasi;	state Exp;
branches;
next	1.95;
commitid	k9pN2wgTn5cUwDek;

1.95
date	2015.04.11.16.37.34;	author jsing;	state Exp;
branches;
next	1.94;
commitid	TtCayghEi4w23TkX;

1.94
date	2015.02.28.21.51.57;	author bentley;	state Exp;
branches;
next	1.93;
commitid	NNu2UZnsd5zmNVYD;

1.93
date	2014.01.18.09.11.12;	author jsing;	state Exp;
branches;
next	1.92;

1.92
date	2013.08.11.05.54.09;	author brad;	state Exp;
branches;
next	1.91;

1.91
date	2013.07.16.09.45.27;	author schwarze;	state Exp;
branches;
next	1.90;

1.90
date	2012.09.22.20.09.43;	author jmc;	state Exp;
branches;
next	1.89;

1.89
date	2012.01.29.17.26.13;	author jmc;	state Exp;
branches;
next	1.88;

1.88
date	2012.01.29.16.51.52;	author krw;	state Exp;
branches;
next	1.87;

1.87
date	2012.01.07.13.59.46;	author jsing;	state Exp;
branches;
next	1.86;

1.86
date	2012.01.07.12.16.46;	author jsing;	state Exp;
branches;
next	1.85;

1.85
date	2011.12.31.17.06.09;	author jsing;	state Exp;
branches;
next	1.84;

1.84
date	2010.12.22.16.25.32;	author jmc;	state Exp;
branches;
next	1.83;

1.83
date	2010.12.01.19.40.18;	author ckuethe;	state Exp;
branches;
next	1.82;

1.82
date	2010.11.20.17.46.24;	author stsp;	state Exp;
branches;
next	1.81;

1.81
date	2010.09.13.18.45.58;	author jmc;	state Exp;
branches;
next	1.80;

1.80
date	2009.12.31.14.00.45;	author jsing;	state Exp;
branches;
next	1.79;

1.79
date	2009.12.19.16.27.54;	author jsing;	state Exp;
branches;
next	1.78;

1.78
date	2009.11.25.18.51.58;	author jsing;	state Exp;
branches;
next	1.77;

1.77
date	2009.11.24.06.06.06;	author jmc;	state Exp;
branches;
next	1.76;

1.76
date	2009.11.24.02.19.35;	author jsing;	state Exp;
branches;
next	1.75;

1.75
date	2009.10.22.15.27.15;	author jmc;	state Exp;
branches;
next	1.74;

1.74
date	2009.10.21.22.35.27;	author marco;	state Exp;
branches;
next	1.73;

1.73
date	2009.10.21.22.31.17;	author marco;	state Exp;
branches;
next	1.72;

1.72
date	2009.07.31.05.58.51;	author jmc;	state Exp;
branches;
next	1.71;

1.71
date	2009.07.30.18.18.10;	author cnst;	state Exp;
branches;
next	1.70;

1.70
date	2009.06.23.18.47.15;	author jmc;	state Exp;
branches;
next	1.69;

1.69
date	2009.06.17.23.00.03;	author marco;	state Exp;
branches;
next	1.68;

1.68
date	2009.06.13.21.14.38;	author halex;	state Exp;
branches;
next	1.67;

1.67
date	2009.05.09.13.42.03;	author sthen;	state Exp;
branches;
next	1.66;

1.66
date	2009.03.19.15.11.59;	author jmc;	state Exp;
branches;
next	1.65;

1.65
date	2009.03.19.13.44.46;	author grunk;	state Exp;
branches;
next	1.64;

1.64
date	2009.02.22.07.46.55;	author jmc;	state Exp;
branches;
next	1.63;

1.63
date	2009.02.09.20.39.56;	author grange;	state Exp;
branches;
next	1.62;

1.62
date	2009.02.09.16.41.08;	author marco;	state Exp;
branches;
next	1.61;

1.61
date	2008.08.22.06.41.36;	author jmc;	state Exp;
branches;
next	1.60;

1.60
date	2008.08.22.02.00.12;	author marco;	state Exp;
branches;
next	1.59;

1.59
date	2008.08.11.17.28.24;	author marco;	state Exp;
branches;
next	1.58;

1.58
date	2008.08.11.17.22.54;	author marco;	state Exp;
branches;
next	1.57;

1.57
date	2008.07.21.21.37.30;	author jmc;	state Exp;
branches;
next	1.56;

1.56
date	2008.06.24.13.52.35;	author jmc;	state Exp;
branches;
next	1.55;

1.55
date	2008.06.14.17.04.50;	author djm;	state Exp;
branches;
next	1.54;

1.54
date	2008.06.14.00.16.38;	author hshoexer;	state Exp;
branches;
next	1.53;

1.53
date	2008.06.12.16.08.48;	author jmc;	state Exp;
branches;
next	1.52;

1.52
date	2008.06.12.00.25.33;	author marco;	state Exp;
branches;
next	1.51;

1.51
date	2007.11.21.13.06.42;	author jmc;	state Exp;
branches;
next	1.50;

1.50
date	2007.11.21.09.04.37;	author jmc;	state Exp;
branches;
next	1.49;

1.49
date	2007.07.11.07.40.11;	author jmc;	state Exp;
branches;
next	1.48;

1.48
date	2007.07.10.15.46.54;	author henning;	state Exp;
branches;
next	1.47;

1.47
date	2007.06.04.11.26.53;	author jmc;	state Exp;
branches;
next	1.46;

1.46
date	2007.06.04.05.28.43;	author todd;	state Exp;
branches;
next	1.45;

1.45
date	2007.05.31.19.19.43;	author jmc;	state Exp;
branches;
next	1.44;

1.44
date	2007.04.23.16.38.55;	author deraadt;	state Exp;
branches;
next	1.43;

1.43
date	2007.03.20.06.12.11;	author jmc;	state Exp;
branches;
next	1.42;

1.42
date	2007.03.20.03.40.38;	author todd;	state Exp;
branches;
next	1.41;

1.41
date	2006.09.03.18.37.44;	author marco;	state Exp;
branches;
next	1.40;

1.40
date	2006.06.30.08.13.40;	author jmc;	state Exp;
branches;
next	1.39;

1.39
date	2005.10.04.20.11.27;	author jmc;	state Exp;
branches;
next	1.38;

1.38
date	2005.08.23.23.20.23;	author deraadt;	state Exp;
branches;
next	1.37;

1.37
date	2005.08.22.14.11.12;	author jmc;	state Exp;
branches;
next	1.36;

1.36
date	2005.08.22.04.27.17;	author david;	state Exp;
branches;
next	1.35;

1.35
date	2005.08.21.23.36.32;	author deraadt;	state Exp;
branches;
next	1.34;

1.34
date	2005.08.19.06.18.51;	author deraadt;	state Exp;
branches;
next	1.33;

1.33
date	2005.08.19.05.23.53;	author jmc;	state Exp;
branches;
next	1.32;

1.32
date	2005.08.18.22.14.43;	author deraadt;	state Exp;
branches;
next	1.31;

1.31
date	2005.08.18.13.32.59;	author deraadt;	state Exp;
branches;
next	1.30;

1.30
date	2005.08.18.13.31.37;	author jmc;	state Exp;
branches;
next	1.29;

1.29
date	2005.08.18.12.53.22;	author deraadt;	state Exp;
branches;
next	1.28;

1.28
date	2005.08.18.12.19.08;	author dlg;	state Exp;
branches;
next	1.27;

1.27
date	2005.08.18.09.16.16;	author jmc;	state Exp;
branches;
next	1.26;

1.26
date	2005.08.18.04.49.52;	author marco;	state Exp;
branches;
next	1.25;

1.25
date	2005.08.09.08.11.33;	author jmc;	state Exp;
branches;
next	1.24;

1.24
date	2005.08.09.01.43.33;	author deraadt;	state Exp;
branches;
next	1.23;

1.23
date	2005.08.08.04.04.13;	author deraadt;	state Exp;
branches;
next	1.22;

1.22
date	2005.08.05.02.40.30;	author deraadt;	state Exp;
branches;
next	1.21;

1.21
date	2005.08.03.21.15.01;	author deraadt;	state Exp;
branches;
next	1.20;

1.20
date	2005.08.03.16.15.07;	author deraadt;	state Exp;
branches;
next	1.19;

1.19
date	2005.08.03.15.20.55;	author mickey;	state Exp;
branches;
next	1.18;

1.18
date	2005.08.03.02.39.55;	author deraadt;	state Exp;
branches;
next	1.17;

1.17
date	2005.08.02.20.27.13;	author jmc;	state Exp;
branches;
next	1.16;

1.16
date	2005.08.02.16.47.30;	author jmc;	state Exp;
branches;
next	1.15;

1.15
date	2005.08.02.11.53.28;	author marco;	state Exp;
branches;
next	1.14;

1.14
date	2005.07.29.16.59.13;	author jmc;	state Exp;
branches;
next	1.13;

1.13
date	2005.07.29.16.01.18;	author marco;	state Exp;
branches;
next	1.12;

1.12
date	2005.07.18.15.10.56;	author dlg;	state Exp;
branches;
next	1.11;

1.11
date	2005.07.18.14.34.41;	author jmc;	state Exp;
branches;
next	1.10;

1.10
date	2005.07.18.01.58.01;	author marco;	state Exp;
branches;
next	1.9;

1.9
date	2005.07.01.21.53.40;	author marco;	state Exp;
branches;
next	1.8;

1.8
date	2005.05.05.02.18.50;	author marco;	state Exp;
branches;
next	1.7;

1.7
date	2005.04.06.02.36.34;	author marco;	state Exp;
branches;
next	1.6;

1.6
date	2005.04.05.06.32.16;	author jmc;	state Exp;
branches;
next	1.5;

1.5
date	2005.04.04.22.43.07;	author marco;	state Exp;
branches;
next	1.4;

1.4
date	2005.04.01.15.59.20;	author jmc;	state Exp;
branches;
next	1.3;

1.3
date	2005.03.30.08.06.03;	author dlg;	state Exp;
branches;
next	1.2;

1.2
date	2005.03.30.07.18.55;	author jmc;	state Exp;
branches;
next	1.1;

1.1
date	2005.03.29.22.04.21;	author marco;	state Exp;
branches;
next	;


desc
@@


1.103
log
@Document bioctl -d as a "detach" rather than a "delete" operation.
ok tb@@ danj@@ deraadt@@
@
text
@.\"	$OpenBSD: bioctl.8,v 1.102 2016/09/21 17:57:33 jsing Exp $
.\"
.\" Copyright (c) 2004, 2005 Marco Peereboom
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE AUTHORS AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED. IN NO EVENT SHALL THE AUTHORS OR CONTRIBUTORS BE LIABLE FOR
.\" ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.Dd $Mdocdate: September 21 2016 $
.Dt BIOCTL 8
.Os
.Sh NAME
.Nm bioctl
.Nd RAID management interface
.Sh SYNOPSIS
.Nm bioctl
.Op Fl hiqv
.Op Fl a Ar alarm-function
.Op Fl b Ar channel : Ns Ar target Ns Op Pf . Ar lun
.Op Fl H Ar channel : Ns Ar target Ns Op Pf . Ar lun
.Op Fl R Ar device | channel : Ns Ar target Ns Op Pf . Ar lun
.Op Fl t Ar patrol-function
.Op Fl u Ar channel : Ns Ar target Ns Op Pf . Ar lun
.Ar device
.Pp
.Nm bioctl
.Op Fl dhiPqsv
.Op Fl C Ar flag Ns Op Pf , Ar flag Ns Op Pf , Ar ...
.Op Fl c Ar raidlevel
.Op Fl k Ar keydisk
.Op Fl l Ar special Ns Op Pf , Ar special Ns Op Pf , Ar ...
.Op Fl O Ar device | channel : Ns Ar target Ns Op Pf . Ar lun
.Op Fl p Ar passfile
.Op Fl R Ar device | channel : Ns Ar target Ns Op Pf . Ar lun
.Op Fl r Ar rounds
.Ar device
.Sh DESCRIPTION
RAID device drivers which support management functionality can
register their services with the
.Xr bio 4
driver.
.Nm bioctl
then can be used to maintain RAID volumes.
.Pp
In the first synopsis,
RAID controllers are managed.
.Ar device
specifies either a drive (e.g. sd0) or a RAID controller (e.g. ami0).
For operations which will be performed against
.Xr ses 4
or
.Xr safte 4
enclosures, it is also possible to directly specify the enclosure name
(e.g. safte0).
.Pp
In the second synopsis,
.Xr softraid 4
devices are managed.
.Ar device
specifies either a drive (e.g. sd0) or a
.Xr softraid 4
device (e.g. softraid0).
.Pp
The options for RAID controllers are as follows:
.Bl -tag -width Ds
.It Fl a Ar alarm-function
Control the RAID card's alarm functionality, if supported.
.Ar alarm-function
may be one of:
.Pp
.Bl -tag -width disable -compact
.It Cm disable
Disable the alarm on the RAID controller.
.It Cm enable
Enable the alarm on the RAID controller.
.It Cm get
Retrieve the current alarm state (enabled or disabled).
.It Cm silence | quiet
Silence the alarm if it is currently beeping.
.El
.Pp
The
.Ar alarm-function
may be specified as given above,
or by the first letter only
(e.g. -a e).
.It Fl b Ar channel : Ns Ar target Ns Op Pf . Ar lun
Instruct the device at
.Ar channel : Ns Ar target Ns Op Pf . Ar lun
to start blinking, if there is
.Xr ses 4
or
.Xr safte 4
support in the enclosure.
.It Fl H Ar channel : Ns Ar target Ns Op Pf . Ar lun
If the device at
.Ar channel : Ns Ar target Ns Op Pf . Ar lun
is currently marked
.Dq Unused ,
promote it to being a
.Dq Hot Spare .
.It Fl h
Where necessary, produce
.Dq human-readable
output.
Use unit suffixes: Byte, Kilobyte, Megabyte,
Gigabyte, Terabyte, Petabyte, Exabyte in order to reduce the number of
digits to four or less.
.It Fl i
Enumerate the selected RAID devices.
This is the default if no other option is given.
.It Fl q
Show vendor, product, revision, and serial number for the given disk.
.It Fl R Ar device | channel : Ns Ar target Ns Op Pf . Ar lun
Manually kick off a rebuild of a RAID volume, using
.Ar device
or
.Ar channel : Ns Ar target Ns Op Pf . Ar lun
as a new chunk (with
.Xr softraid 4 ,
a partition of fstype
.Dq RAID )
in the volume.
.Ar device
must be specified as a full path to the chunk device file (e.g. /dev/wd0d).
A RAID volume rather than a RAID controller is expected as the final argument.
.It Fl t Ar patrol-function
Control the RAID card's patrol functionality, if supported.
.Ar patrol-function
may be one of:
.Pp
.Bl -tag -width disable -compact
.It Cm stop
Stop the patrol on the RAID controller.
.It Cm start
Start the patrol on the RAID controller.
.It Cm get
Retrieve the current patrol configuration.
.It Cm disable
Disable the patrol functionality.
.It Cm manual
Enable the patrol functionality to start/stop manually.
.It Cm auto Ns Op Pf . Ar interval Ns Op Pf . Ar start
Enable the patrol functionality to start/stop automatically in every
.Ar interval
seconds, starting the first iteration after
.Ar start
seconds.
.El
.It Fl u Ar channel : Ns Ar target Ns Op Pf . Ar lun
Instruct the device at
.Ar channel : Ns Ar target Ns Op Pf . Ar lun
to cease blinking, if there is
.Xr ses 4
or
.Xr safte 4
support in the enclosure.
.It Fl v
Be more verbose in output.
.El
.Pp
In addition to the relevant options listed above,
the options for
.Xr softraid 4
devices are as follows:
.Bl -tag -width Ds
.It Fl C Ar flag Ns Op Pf , Ar flag Ns Op Pf , Ar ...
Pass
.Ar flag
to
.Nm .
May be one of:
.Pp
.Bl -tag -width disable -compact
.It Cm force
Force the operation;
for example, force the creation of volumes
with unclean data in the metadata areas.
.It Cm noauto
Do not automatically assemble this volume at boot time.
.El
.It Fl c Ar raidlevel
Create a
.Xr softraid 4
device of level
.Ar raidlevel .
The device must begin with
.Dq softraid
followed by a number.
.Pp
Valid raidlevels are:
.Pp
.Bl -tag -width 2n -offset 3n -compact
.It Cm 0
RAID 0:
A striping discipline.
.It Cm 1
RAID 1:
A mirroring discipline.
.It Cm 5
RAID 5:
A striping discipline with floating parity chunk.
.It Cm C
CRYPTO:
An encrypting discipline.
.It Cm c
CONCAT:
A concatenating discipline.
.El
.Pp
The RAID 0, RAID 1 and CONCAT disciplines require a minimum of two devices to
be provided via
.Fl l .
RAID 5 requires at least three devices
and the CRYPTO discipline requires exactly one.
.It Fl d
Detach volume specified by device.
.It Fl k Ar keydisk
Use special device
.Ar keydisk
as a key disk for a crypto volume.
.It Fl l Ar special Ns Op Pf , Ar special Ns Op Pf , Ar ...
Use
.Ar special
device list to create within the
.Xr softraid 4
framework.
Requires
.Fl c .
.It Fl O Ar device | channel : Ns Ar target Ns Op Pf . Ar lun
Set the state of
.Ar device
or
.Ar channel : Ns Ar target Ns Op Pf . Ar lun
to offline.
The state of the RAID volume will change in the same way that it would if the
disk physically went offline.
.Ar device
must be specified as a full path to the chunk device file (e.g. /dev/wd0d).
A RAID volume rather than a RAID controller is expected as the final argument.
.It Fl P
Change the passphrase on the selected crypto volume.
.It Fl p Ar passfile
Passphrase file used when crypto volumes are brought up.
This file must be root owned and have 0600 permissions.
.It Fl r Ar rounds
The number of iterations for the KDF algorithm to use when converting a
passphrase into a key, in order to create a new encrypted volume or change the
passphrase of an existing encrypted volume.
A larger number of iterations takes more time, but offers increased resistance
against passphrase guessing attacks.
If
.Ar rounds
is specified as "auto", the number of rounds will be automatically determined
based on system performance.
Otherwise the minimum is 4 rounds and the default is 16.
.It Fl s
Read the passphrase for the selected crypto volume from
.Pa /dev/stdin
rather than
.Pa /dev/tty .
This option cannot be used during the initial creation of the crypto volume.
.El
.Sh EXAMPLES
The following command, executed from the command line, would configure
the device softraid0 with 4 special devices
(/dev/sd2e, /dev/sd3e, /dev/sd4e, /dev/sd5e) and
a RAID level of 1:
.Bd -literal -offset 3n
# bioctl -c 1 -l /dev/sd2e,/dev/sd3e,/dev/sd4e,/dev/sd5e softraid0
.Ed
.Pp
The following command, executed from the command line, would configure the
device softraid0 with one special device (/dev/sd2e) and an encrypting
volume:
.Bd -literal -offset 3n
# bioctl -c C -l /dev/sd2e softraid0
.Ed
.Pp
.Nm
will ask for a passphrase, which will be needed to unlock the encrypted
disk.
After creating a newly encrypted disk, the first megabyte of it should be
zeroed, so tools like
.Xr fdisk 8
or
.Xr disklabel 8
don't get confused by the random data that appears on the new disk.
This can be done with the following command (assuming the new disk is sd3):
.Bd -literal -offset 3n
# dd if=/dev/zero of=/dev/rsd3c bs=1m count=1
.Ed
.Pp
Detaching a softraid volume requires the exact volume name.
For example:
.Bd -literal -offset 3n
# bioctl -d sd2
.Ed
.Pp
The following command starts a rebuild of the degraded softraid volume sd0
using a new chunk on wd0d:
.Bd -literal -offset 3n
# bioctl -R /dev/wd0d sd0
.Ed
.Sh SEE ALSO
.Xr bio 4 ,
.Xr scsi 4 ,
.Xr softraid 4
.Sh HISTORY
The
.Nm
command first appeared in
.Ox 3.8 .
.Sh AUTHORS
The
.Nm
interface was written by
.An Marco Peereboom Aq Mt marco@@openbsd.org .
@


1.102
log
@Document auto rounds.
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.101 2016/09/21 17:08:04 jsing Exp $
d234 1
a234 1
Delete volume specified by device.
d311 1
a311 1
Deleting a softraid volume requires the exact volume name.
@


1.101
log
@Be clearer with the description of bioctl(8)'s -r option.

ok jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.99 2016/04/04 18:53:31 krw Exp $
d26 1
a26 1
.Dd $Mdocdate: April 4 2016 $
d269 5
a273 1
The minimum is 4 rounds and the default is 16.
@


1.100
log
@Update for bcrypt pbkdf.
@
text
@d264 5
a268 4
When creating an encrypted volume, specifies the number of iterations of
the PBKDF algorithm used to convert a passphrase into a key.
Higher iteration counts take more time, but offer more resistance to key
guessing attacks.
@


1.99
log
@Remove caveat about only supporting 512-byte sectors.
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.98 2015/10/22 08:35:18 jmc Exp $
d26 1
a26 1
.Dd $Mdocdate: October 22 2015 $
d265 1
a265 1
the PBKDF2 algorithm used to convert a passphrase into a key.
d268 1
a268 1
The minimum is 1000 rounds and the default is 8192.
a320 7
.Sh STANDARDS
.Rs
.%A B. Kaliski
.%D September 2000
.%R RFC 2898
.%T PKCS #5: Password-Based Cryptography Specification Version 2.0
.Re
@


1.98
log
@halex removed the -p restriction, so do not document it;
from kirill bychkov
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.97 2015/09/12 14:21:25 schwarze Exp $
d26 1
a26 1
.Dd $Mdocdate: September 12 2015 $
a337 2
.Sh CAVEATS
Only devices with 512-byte sectors are supported.
@


1.97
log
@obvious macros fixes:
* use .Cm for fixed argument strings
* properly use .Ar on individual arguments
* drop redundant .Bk
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.96 2015/05/29 00:33:37 uebayasi Exp $
d26 1
a26 1
.Dd $Mdocdate: May 29 2015 $
a262 1
This option cannot be used during the initial creation of the crypto volume.
@


1.96
log
@Initial addition of ``Patrol Read'' support in bio(4), biocto(8), and
mfi(4).  Based on FreeBSD, but done without mfiutil(8).

OK deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD$
d26 1
a26 1
.Dd $Mdocdate$
a33 1
.Bk -words
d36 3
a38 3
.Op Fl b Ar channel:target[.lun]
.Op Fl H Ar channel:target[.lun]
.Op Fl R Ar device | channel:target[.lun]
d40 1
a40 1
.Op Fl u Ar channel:target[.lun]
a41 1
.Ek
a43 1
.Bk -words
d45 1
a45 1
.Op Fl C Ar flag[,flag,...]
d48 2
a49 2
.Op Fl l Ar special[,special,...]
.Op Fl O Ar device | channel:target[.lun]
d51 1
a51 1
.Op Fl R Ar device | channel:target[.lun]
a53 1
.Ek
d89 1
a89 1
.It Ar disable
d91 1
a91 1
.It Ar enable
d93 1
a93 1
.It Ar get
d95 1
a95 1
.It Ar silence | Ar quiet
d104 1
a104 1
.It Fl b Ar channel:target[.lun]
d106 1
a106 1
.Ar channel:target[.lun]
d112 1
a112 1
.It Fl H Ar channel:target[.lun]
d114 1
a114 1
.Ar channel:target[.lun]
d131 1
a131 1
.It Fl R Ar device | channel:target[.lun]
d135 1
a135 1
.Ar channel:target[.lun]
d150 1
a150 1
.It Ar stop
d152 1
a152 1
.It Ar start
d154 1
a154 1
.It Ar get
d156 1
a156 1
.It Ar disable
d158 1
a158 1
.It Ar manual
d160 1
a160 1
.It Ar auto[.interval[.start]]
d167 1
a167 1
.It Fl u Ar channel:target[.lun]
d169 1
a169 1
.Ar channel:target[.lun]
d184 1
a184 1
.It Fl C Ar flag[,flag,...]
d192 1
a192 1
.It Ar force
d196 1
a196 1
.It Ar noauto
d210 2
a211 2
.Bl -tag -width Ds -offset indent -compact
.It 0
d214 1
a214 1
.It 1
d217 1
a217 1
.It 5
d220 1
a220 1
.It C
d223 1
a223 1
.It c
d239 1
a239 1
.It Fl l Ar special[,special,...]
d247 1
a247 1
.It Fl O Ar device | channel:target[.lun]
d251 1
a251 1
.Ar channel:target[.lun]
@


1.95
log
@Re-enable the RAID 5 discipline for softraid(4).

The RAID 5 implementation has been largely rewritten during the last two
hackathons in Dunedin - it now needs further testing and usage.
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.94 2015/02/28 21:51:57 bentley Exp $
d26 1
a26 1
.Dd $Mdocdate: February 28 2015 $
d40 1
d148 23
@


1.94
log
@Reduce usage of predefined strings in manpages.

Predefined strings are not very portable across troff implementations,
and they make the source much harder to read. Usually the intended
character can be written directly.

No output changes, except for two instances where the incorrect escape
was used in the first place.

tweaks + ok schwarze@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.93 2014/01/18 09:11:12 jsing Exp $
d26 1
a26 1
.Dd $Mdocdate: January 18 2014 $
d197 3
a199 3
.\" .It 5
.\" RAID 5:
.\" A striping discipline with floating parity chunk.
d210 2
a211 2
.Fl l
.\" RAID 5 requires at least three devices,
@


1.93
log
@Disable the RAID 5 discipline in bioctl, as the current softraid RAID 5
discipline will more than likely eat data if a drive is lost.

Discussed with krw@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.92 2013/08/11 05:54:09 brad Exp $
d26 1
a26 1
.Dd $Mdocdate: August 11 2013 $
d39 1
a39 1
.Op Fl R Ar device \*(Ba channel:target[.lun]
d51 1
a51 1
.Op Fl O Ar device \*(Ba channel:target[.lun]
d53 1
a53 1
.Op Fl R Ar device \*(Ba channel:target[.lun]
d134 1
a134 1
.It Fl R Ar device \*(Ba channel:target[.lun]
d227 1
a227 1
.It Fl O Ar device \*(Ba channel:target[.lun]
@


1.92
log
@capitalize RAID in one spot.
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.91 2013/07/16 09:45:27 schwarze Exp $
d26 1
a26 1
.Dd $Mdocdate: July 16 2013 $
d197 3
a199 6
.It 4
RAID 4:
A striping discipline with fixed parity chunk.
.It 5
RAID 5:
A striping discipline with floating parity chunk.
d210 2
a211 2
.Fl l ,
RAID 4 and RAID 5 require at least three devices,
a320 2
.Pp
Use of the CRYPTO & RAID 4/5 disciplines are currently considered experimental.
@


1.91
log
@Add missing .Mt macros for AUTHORS email addresses.
From Jan Stary <hans at stare dot cz>.
ok jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.90 2012/09/22 20:09:43 jmc Exp $
d26 1
a26 1
.Dd $Mdocdate: September 22 2012 $
d264 1
a264 1
a raid level of 1:
@


1.90
log
@last stage of rfc changes, using consistent Rs/Re blocks, and moving the
references into a STANDARDS section;
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.89 2012/01/29 17:26:13 jmc Exp $
d26 1
a26 1
.Dd $Mdocdate: January 29 2012 $
d321 1
a321 1
.An Marco Peereboom Aq marco@@openbsd.org .
@


1.89
log
@use Pp, not blank lines;
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.88 2012/01/29 16:51:52 krw Exp $
d305 1
d307 2
d310 1
a310 2
.%T "PKCS #5: Password-Based Cryptography Specification Version 2.0"
.%D 2000
@


1.88
log
@Add CAVEAT that only 512-byte sector devices are supported.

ok jsing@@ jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.87 2012/01/07 13:59:46 jsing Exp $
d26 1
a26 1
.Dd $Mdocdate: January 7 2012 $
d322 1
a322 1

@


1.87
log
@Move -O to the correct section.

Spotted by jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.86 2012/01/07 12:16:46 jsing Exp $
d321 2
@


1.86
log
@Provide a bioctl(8) option that changes the state of a chunk to offline.

man page part with todd@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.83 2010/12/01 19:40:18 ckuethe Exp $
d26 1
a26 1
.Dd $Mdocdate: December 1 2010 $
a131 11
.It Fl O Ar device \*(Ba channel:target[.lun]
Set the state of
.Ar device
or
.Ar channel:target[.lun]
to offline.
The state of the RAID volume will change in the same way that it would if the
disk physically went offline.
.Ar device
must be specified as a full path to the chunk device file (e.g. /dev/wd0d).
A RAID volume rather than a RAID controller is expected as the final argument.
d230 11
@


1.85
log
@Implement a concatenating discipline for softraid.

Many thanks to Marco Peereboom for his assistance with testing and
debugging. Thanks also to Josh Grosse and Chris Jackman for testing.
@
text
@d51 1
d132 11
d157 1
a157 2
A RAID volume rather than a RAID controller is expected as the
final argument.
@


1.84
log
@-s carries the same caveat as -p; from Jiri B.
ok krw
@
text
@d206 3
d211 2
a212 1
The RAID 0 and RAID 1 disciplines requires a minimum of two devices passed to
@


1.83
log
@Allow add a -s switch to make bioctl read the passphrase from stdin. Handy
for scripting a big batch of remote unlocks. ok marco
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.82 2010/11/20 17:46:24 stsp Exp $
d26 1
a26 1
.Dd $Mdocdate: November 20 2010 $
d231 1
a231 1
It cannot be used during the initial creation of the crypto volume.
d243 1
@


1.82
log
@Explain how to start a rebuild in a more obvious way and add an example.
help and ok marco@@ jsing@@ jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.81 2010/09/13 18:45:58 jmc Exp $
d26 1
a26 1
.Dd $Mdocdate: September 13 2010 $
d46 1
a46 1
.Op Fl dhiPqv
d238 5
@


1.81
log
@various tweaks, based on a diff from Chris Palmer;
ok marco
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.80 2009/12/31 14:00:45 jsing Exp $
d26 1
a26 1
.Dd $Mdocdate: December 31 2009 $
d134 1
a134 1
Manually kick off a rebuild using
d138 9
a146 3
on the provided drive name.
This command requires a drive by name (e.g. sd1) instead of a controller
by name (e.g. softraid0).
d273 6
@


1.80
log
@Add support for key disks. This allows a crypto volume to be constructed
without using a passphrase - instead the encryption mask key is stored on
the specified key disk partition (ideally being one on a removable device).
This also enables automatic assembly of crypto volumes at boot time.

ok marco@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.79 2009/12/19 16:27:54 jsing Exp $
d26 1
a26 1
.Dd $Mdocdate: December 19 2009 $
d122 3
a124 1
Where necessary, produce "human-readable" output.
d228 1
a228 1
the algorithm used to convert a passphrase into a key.
d250 1
a250 1
will ask for a passphrase, that will be needed to unlock the encrypted
d272 5
d288 1
a288 1
Use of the crypto & RAID 4/5 disciplines are currently considered experimental.
@


1.79
log
@Explain what 'noauto' really does.

ok marco@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.77 2009/11/24 06:06:06 jmc Exp $
d26 1
a26 1
.Dd $Mdocdate: November 24 2009 $
d49 1
d206 4
@


1.78
log
@Move the -p option to the correct place.

ok jmc@@
@
text
@d168 1
a168 1
Ignore this RAID volume upon reboot.
@


1.77
log
@put -P in the right place;
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.76 2009/11/24 02:19:35 jsing Exp $
a127 4
.It Fl p Ar passfile
Passphrase file used when crypto volumes are brought up.
This file must be root owned and have 0600 permissions.
It cannot be used during the initial creation of the crypto volume.
d215 4
@


1.76
log
@Allow the passphrase to be changed on softraid crypto volumes. Ensure that
you backup your data and lock up your pets prior to using this.

Tested by todd@@

ok marco@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.74 2009/10/21 22:35:27 marco Exp $
d26 1
a26 1
.Dd $Mdocdate: October 21 2009 $
d46 1
a46 1
.Op Fl Pdhiqv
@


1.75
log
@tweak previous; ok marco
@
text
@d46 1
a46 1
.Op Fl dhiqv
d217 2
@


1.74
log
@Add delete example since it has come up several times.
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.73 2009/10/21 22:31:17 marco Exp $
d129 1
a129 1
Passphrase file used for crypto volume bring-up.
d131 1
a131 1
This can not be used during the initial creation of the crypto volume.
@


1.73
log
@Add passphrase file for crypto volume bring-up.  Proded and ok deraadt
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.72 2009/07/31 05:58:51 jmc Exp $
d26 1
a26 1
.Dd $Mdocdate: July 31 2009 $
d252 6
@


1.72
log
@bioctl.8 should not try to keep track of all devices which can use it;
ok marco cnst
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.71 2009/07/30 18:18:10 cnst Exp $
d26 1
a26 1
.Dd $Mdocdate: July 30 2009 $
d50 1
d128 4
@


1.71
log
@Xr cac(4) && mpi(4);  ok marco
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.70 2009/06/23 18:47:15 jmc Exp $
d26 1
a26 1
.Dd $Mdocdate: June 23 2009 $
a248 2
.Xr ami 4 ,
.Xr arc 4 ,
a249 6
.Xr cac 4 ,
.Xr ciss 4 ,
.Xr ips 4 ,
.Xr mfi 4 ,
.Xr mpi 4 ,
.Xr safte 4 ,
a250 1
.Xr ses 4 ,
@


1.70
log
@tweak previous;
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.69 2009/06/17 23:00:03 marco Exp $
d26 1
a26 1
.Dd $Mdocdate: June 17 2009 $
d252 1
d256 1
@


1.69
log
@Bring bioctl back to reality by adding rebuild and documenting RAID 4 & 5.
ok jordan
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.68 2009/06/13 21:14:38 halex Exp $
d26 1
a26 1
.Dd $Mdocdate: June 13 2009 $
d188 1
a188 1
RAID 4
d191 1
a191 1
RAID 5
d200 2
a201 2
RAID 4 & 5 require at least three devices and the CRYPTO discipline requires
exactly one.
@


1.68
log
@mention the number of special devices required
for the different disciplines.
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.67 2009/05/09 13:42:03 sthen Exp $
d26 1
a26 1
.Dd $Mdocdate: May 9 2009 $
d187 6
d200 2
a201 1
while the CRYPTO discipline requires exactly one.
d270 1
a270 3
Use of the crypto discipline is currently considered experimental.
.Pp
Manual rebuild is currently not implemented for softraid.
@


1.67
log
@fix example dd invocation; multipliers (e.g. bs=1m) use lower-case.
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.66 2009/03/19 15:11:59 jmc Exp $
d26 1
a26 1
.Dd $Mdocdate: March 19 2009 $
d191 4
@


1.66
log
@minor tweaks (sorry grunk!);
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.65 2009/03/19 13:44:46 grunk Exp $
d235 1
a235 1
# dd if=/dev/zero of=/dev/rsd3c bs=1M count=1
@


1.65
log
@correct an example in the manpage:  after creating a new crypto volume,
it is sufficient to zero the first megabyte of the disk, not the whole
disk.

ok marco@@ mpf@@ rainer@@ jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.64 2009/02/22 07:46:55 jmc Exp $
d26 1
a26 1
.Dd $Mdocdate: February 22 2009 $
d227 1
a227 1
After creating a new encrypted disk, the first megabyte of it should be
d232 1
a232 1
don't get confused by the random data that now appears on the new disk.
@


1.64
log
@split synopsis and the options list according to functionality;
diff from Mitja Mu?eni?

ok marco
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.63 2009/02/09 20:39:56 grange Exp $
d26 1
a26 1
.Dd $Mdocdate: February 9 2009 $
d227 7
a233 2
After creating a new encrypted disk, it should be zeroed with the
following command (assuming the new disk is sd3):
d235 1
a235 1
# dd if=/dev/zero of=/dev/rsd3c
@


1.63
log
@Document that ips has bio support now.
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.62 2009/02/09 16:41:08 marco Exp $
d35 1
a35 1
.Op Fl dhiqv
d38 9
a48 1
.Op Fl H Ar channel:target[.lun]
d50 1
a50 1
.Op Fl R Ar device\*(Bachannel:target[.lun]
a51 1
.Op Fl u Ar channel:target[.lun]
d62 20
a81 1
The options are as follows:
d112 42
d155 3
a157 1
Pass flags when doing operations with
d163 3
a165 2
Force the operation, e.g. to force creation of volumes
with unclean data in the metatdata areas.
a192 14
.It Fl H Ar channel:target[.lun]
If the device at
.Ar channel:target[.lun]
is currently marked
.Dq Unused ,
promote it to being a
.Dq Hot Spare .
.It Fl h
Where necessary, produce "human-readable" output.
Use unit suffixes: Byte, Kilobyte, Megabyte,
Gigabyte, Terabyte, Petabyte, Exabyte in order to reduce the number of
digits to four or less.
.It Fl i
Enumerate the selected RAID devices.
a200 10
.It Fl q
Show vendor, product, revision, and serial number for the given disk.
.It Fl R Ar device\*(Bachannel:target[.lun]
Manually kick off a rebuild using
.Ar device
or
.Ar channel:target[.lun]
on the provided drive name.
This command requires a drive by name (e.g. sd1) instead of a controller
by name (e.g. softraid0).
a206 18
.It Fl u Ar channel:target[.lun]
Instruct the device at
.Ar channel:target[.lun]
to cease blinking, if there is
.Xr ses 4
or
.Xr safte 4
support in the enclosure.
.It Fl v
Be more verbose in output.
.It Ar device
Select a drive by name (e.g. sd0) or a RAID controller by name (e.g. ami0).
For operations which will be performed against
.Xr ses 4
or
.Xr safte 4
enclosures, it is also possible to directly specify the enclosure name
(e.g. safte0).
@


1.62
log
@Add caveat that rebuild is not currently implemented on softraid.
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.61 2008/08/22 06:41:36 jmc Exp $
d26 1
a26 1
.Dd $Mdocdate: August 22 2008 $
d208 1
@


1.61
log
@- -R before -r in SYNOPSIS/usage()
- avoid marking up `|'
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.60 2008/08/22 02:00:12 marco Exp $
d225 2
@


1.60
log
@Add a hack to manually kick off rebuilds.  This will need some love in the
near future.

ok deraadt
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.59 2008/08/11 17:28:24 marco Exp $
d26 1
a26 1
.Dd $Mdocdate: August 11 2008 $
d42 1
a43 1
.Op Fl R Ar device|channel:target[.lun]
d146 8
a159 6
.It Fl R Ar device|channel:target[.lun]
Manually kick off a rebuild using device or
.Ar channel:target[.lun]
on the provided drive name.
This command requires a drive by name (e.g. sd1) instead of a controller
by name (e.g. softraid0).
@


1.59
log
@Undo last commit; deraadt didn't like it.
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.58 2008/08/11 17:22:54 marco Exp $
d43 1
d152 6
@


1.58
log
@Add infrastructure to manually kick off rebuilds.
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.57 2008/07/21 21:37:30 jmc Exp $
d26 1
a26 1
.Dd $Mdocdate: July 21 2008 $
a42 1
.Op Fl R Ar device|channel:target[.lun]
a150 6
.It Fl R Ar device|channel:target[.lun]
Manually kick off a rebuild using device or
.Ar channel:target[.lun]
on the provided drive name.
This command requires a drive by name (e.g. sd1) instead of a controller
by name (e.g. softraid0).
@


1.57
log
@spelling fix from Mark Pecaut;
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.56 2008/06/24 13:52:35 jmc Exp $
d26 1
a26 1
.Dd $Mdocdate: June 24 2008 $
d43 1
d152 6
@


1.56
log
@- document the raidlevels
- tweak CAVEATS, as requested by marco

ok hshoexer marco
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.55 2008/06/14 17:04:50 djm Exp $
d26 1
a26 1
.Dd $Mdocdate: June 14 2008 $
d215 1
a215 1
Use of the crypto dicipline is currently considered experimental.
@


1.55
log
@add a -r option to specify the number of PKCS5 PBKDF2 iterations used
to derive the password (minimum: 1000, maximum: more than you want)
ok hshoexer@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.54 2008/06/14 00:16:38 hshoexer Exp $
d105 14
d215 1
a215 1
Currently, the use of the encrypting volume is considered experimental.
@


1.54
log
@Update bioctl(8) and softraid(4) to recent changes and enable softraid
crypto.  It's still considered experimental!

ok djm marco
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.53 2008/06/12 16:08:48 jmc Exp $
d26 1
a26 1
.Dd $Mdocdate: June 12 2008 $
d42 1
d131 6
@


1.53
log
@-d tweaks;
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.52 2008/06/12 00:25:33 marco Exp $
d157 16
d193 2
@


1.52
log
@Add blurb for delete volume
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.51 2007/11/21 13:06:42 jmc Exp $
d26 1
a26 1
.Dd $Mdocdate: November 21 2007 $
d35 1
a35 1
.Op Fl hdiqv
@


1.51
log
@back out previous: henning says it's wrong;
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.50 2007/11/21 09:04:37 jmc Exp $
d35 1
a35 1
.Op Fl hiqv
d104 2
@


1.50
log
@note that -q is the default if no other options are specified; ok dlg
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.49 2007/07/11 07:40:11 jmc Exp $
d26 1
a26 1
.Dd $Mdocdate: July 11 2007 $
a127 2
This is the default
if no other options are specified.
@


1.49
log
@put -q in the right place;
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.48 2007/07/10 15:46:54 henning Exp $
d26 1
a26 1
.Dd $Mdocdate: May 31 2007 $
d128 2
@


1.48
log
@implement -q to query a scsi disk for its inquiry data (vendor, model,
revision, serial #) and print that.
when the default bio ioctl fails with ENOTTY because the given disk is not
on a bio-supported raid controller, fall back to -q.
use strnvis to sanitize inquiry data so it is safe to use in scripts.
ok deraadt
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.47 2007/06/04 11:26:53 jmc Exp $
d126 2
a135 2
.It Fl q
Show vendor, product, revision and serial number for the given disk.
@


1.47
log
@- remove an extraneous .Bl
- -C before -c
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.46 2007/06/04 05:28:43 todd Exp $
d35 1
a35 1
.Op Fl hiv
d134 2
@


1.46
log
@document -C option of bioctl
use a simpler form of options with variable number of args
suggestions jmc@@ ok marco@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.45 2007/05/31 19:19:43 jmc Exp $
a83 8
.It Fl c Ar raidlevel
Create a
.Xr softraid 4
device of level
.Ar raidlevel .
The device must begin with
.Dq softraid
followed by a number.
a84 1
.Bl -tag -width Ds
d96 8
@


1.45
log
@convert to new .Dd format;
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.44 2007/04/23 16:38:55 deraadt Exp $
d26 1
a26 1
.Dd $Mdocdate$
d38 1
d41 1
a41 1
.Op Fl l Ar special[,special[,...]]
d92 13
d119 1
a119 1
.It Fl l Ar special[,special[,...]]
@


1.44
log
@remove -D stuff which is just silly, imagine if ls had a debug mode; ok marco
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.43 2007/03/20 06:12:11 jmc Exp $
d26 1
a26 1
.Dd December 27, 2004
@


1.43
log
@tweaks;
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.42 2007/03/20 03:40:38 todd Exp $
d35 1
a35 1
.Op Fl Dhiv
a90 2
.It Fl D
Enable debug output.
@


1.42
log
@document softraid and bioctl creation of softraid
ok marco@@, help from jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.41 2006/09/03 18:37:44 marco Exp $
d88 3
a90 1
The device must begin with 'softraid' followed by a number.
d111 4
a114 2
.Xr softraid 4 framework.  Requires
.Fl -c .
d138 2
a139 2
a raid level of 1.
.Bd -literal -offset indent
d151 1
a151 1
.Xr softraid 4 .
@


1.41
log
@Add drivers

ok jmc miod
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.40 2006/06/30 08:13:40 jmc Exp $
d38 1
d40 1
d83 6
d105 6
d130 8
d146 2
a147 1
.Xr ses 4
@


1.40
log
@-.Xr mpt 4 ,
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.39 2005/10/04 20:11:27 jmc Exp $
d118 1
d121 1
@


1.39
log
@wording from simon kuhnle (pr #4530);
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.38 2005/08/23 23:20:23 deraadt Exp $
a119 1
.Xr mpt 4 ,
@


1.38
log
@disable -B support for now; ok dlg
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.37 2005/08/22 14:11:12 jmc Exp $
d127 1
a127 1
command appeared in
@


1.37
log
@fix Xr;
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.36 2005/08/22 04:27:17 david Exp $
a36 1
.Op Fl B Ar channel:target[.lun]
a72 8
.It Fl B Ar channel:target[.lun]
Instruct the device at
.Ar channel:target[.lun]
to start blinking  with the alarm LED, if there is
.Xr ses 4
or
.Xr safte 4
support in the enclosure.
@


1.36
log
@spelling
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.35 2005/08/21 23:36:32 deraadt Exp $
d119 2
a120 1
.Xr ses 4 or
@


1.35
log
@device may be {ses,safte}# as well, for slot-operations
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.34 2005/08/19 06:18:51 deraadt Exp $
d100 1
a100 1
Where neccessary, produce "human-readable" output.
@


1.34
log
@if Unused is .Dq, then so is Hot Spare..
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.33 2005/08/19 05:23:53 jmc Exp $
d118 5
@


1.33
log
@- sort options
- tighten up a list
- reference ses(4) and safte(4) in SEE ALSO
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.32 2005/08/18 22:14:43 deraadt Exp $
d98 1
a98 1
.Em Hot Spare .
@


1.32
log
@sync with new functionality, and add a bit more meat
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.31 2005/08/18 13:32:59 deraadt Exp $
d37 1
a38 1
.Op Fl B Ar channel:target[.lun]
d57 6
a62 1
.Bl -tag -width Ds
d64 1
a64 5
Retrieve the current alarm state (enabled or disabled)
.It Ar enable
Enable the alarm on the RAID controller
.It Ar disable
Disable the alarm on the RAID controller
d66 1
a66 1
Silence the alarm if it is currently beeping
d74 1
a74 1
.It Fl b Ar channel:target[.lun]
d77 1
a77 1
to start blinking, if there is
d82 1
a82 1
.It Fl B Ar channel:target[.lun]
d85 1
a85 1
to start blinking  with the alarm LED, if there is
d96 1
a96 1
.Va Unused ,
d98 1
a98 1
.Va Hot Spare.
d124 3
a126 1
.Xr scsi 4
@


1.31
log
@if you show an example, BE CORRECT DAMNIT
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.30 2005/08/18 13:31:37 jmc Exp $
d38 1
d40 1
d44 6
a49 2
.Nm
provides a generic interface for RAID management.
d55 1
a55 1
.Ar function
d74 15
a88 1
Instruct a particular device to blink.
d92 1
a92 1
Make a hot spare out of disk
d94 4
a97 2
on the specified controller
(e.g. bioctl -H 0:15 ami0).
d105 8
@


1.30
log
@tweak SYNOPSIS;
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.29 2005/08/18 12:53:22 deraadt Exp $
d75 1
a75 1
(e.g. bioctl -H 0:15).
@


1.29
log
@a step towards where dlg is heading next + knf
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.28 2005/08/18 12:19:08 dlg Exp $
d37 2
a38 1
.Op Op Fl bH Ar channel:target[.lun]
@


1.28
log
@very basic blink support.

some manpage tweaks from jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.27 2005/08/18 09:16:16 jmc Exp $
d37 1
a37 2
.Op Fl b Ar target
.Op Fl H Ar channel:target[.lun]
d66 2
a67 6
.It Fl b Ar target
Instructs the slot in the enclosure containing the device specified by
.Ar target
to blink.
.Ar device
is the enclosure.
@


1.27
log
@- mark up argument
- missing full stop at end of sentence
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.26 2005/08/18 04:49:52 marco Exp $
d37 1
d67 6
@


1.26
log
@Add "create hot spare" ok dlg@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.25 2005/08/09 08:11:33 jmc Exp $
d69 4
a72 2
Make a hot spare out of disk channel:target[.lun] on the specified controller
(e.g. bioctl -H 0:15)
@


1.25
log
@sort options;
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.24 2005/08/09 01:43:33 deraadt Exp $
d37 1
d68 3
@


1.24
log
@verbose output option
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.23 2005/08/08 04:04:13 deraadt Exp $
d74 2
a77 2
.It Fl v
Be more verbose in output.
@


1.23
log
@lots of cleanup, print lots of information based on new linkages between
devices provided by marco; ok marco
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.22 2005/08/05 02:40:30 deraadt Exp $
d35 1
a35 1
.Op Fl Dhi
d76 2
@


1.22
log
@flash up the man page
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.21 2005/08/03 21:15:01 deraadt Exp $
d35 1
a35 1
.Op Fl Di
d67 5
@


1.21
log
@device is not optional; spotted by jmc
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.20 2005/08/03 16:15:07 deraadt Exp $
d36 1
a36 1
.Op Fl a Ar function
d45 2
a46 3
.It Fl a Ar function
Control the RAID card's alarm functionality,
if it supports it.
d49 10
a58 10
.Dq get
(retrieve the current state of the alarm (enabled or disabled)),
.Dq enable
(enable the alarm on the RAID controller),
.Dq disable
(disable the alarm on the RAID controller),
.Dq silence
or
.Dq quiet
(silence the alarm if it is currently beeping).
d60 2
a61 1
.Ar function
@


1.20
log
@clarify device vs drive; marco ok
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.19 2005/08/03 15:20:55 mickey Exp $
d37 1
a37 1
.Op Ar device
@


1.19
log
@link back to ciss from here as well
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.18 2005/08/03 02:39:55 deraadt Exp $
d37 1
a37 1
.Op Ar device | drive
d70 1
a70 6
Select RAID controller e.g. ami0.
Use the
.Fl d
option for controller operations that impact all disk devices.
.It Ar drive
Select RAID disk e.g. sd0.
a75 1
.Xr gdt 4 ,
@


1.18
log
@various cleanups, the way i like it, ok marco
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.17 2005/08/02 20:27:13 jmc Exp $
d80 1
@


1.17
log
@add -a properly to SYNOPSIS; sync usage();
ok marco@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.16 2005/08/02 16:47:30 jmc Exp $
d35 1
a35 1
.Op Fl Dhi
d37 1
a37 2
.Fl d Ar device |
.Fl f Ar device
d67 3
a69 1
.It Fl d Ar device
d74 1
a74 1
.It Fl f Ar device
a75 8
.It Fl h
Online help.
.It Fl i
Depending on whether
.Fl d
or
.Fl f
was specified, enumerate all or only selected RAID device(s), respectively.
@


1.16
log
@sort SEE ALSO;
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.15 2005/08/02 11:53:28 marco Exp $
d35 2
a36 1
.Op Fl aDhi
@


1.15
log
@Reflect new reality.  Lots of help and ok jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.14 2005/07/29 16:59:13 jmc Exp $
d85 1
a87 1
.Xr bio 4 ,
@


1.14
log
@add some tweaks that were lost...
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.13 2005/07/29 16:01:18 marco Exp $
d35 1
a35 1
.Op Fl Dhi
d45 20
d85 2
@


1.13
log
@Redo bioctl because initial implementation was too complex.

tested and ok dlg@@ beck@@
get it in @@deraadt
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.10 2005/07/18 01:58:01 marco Exp $
d48 4
a51 2
Select RAID controller e.g ami0.
Use the -d option for controller operations that impact all disk devices.
d53 1
a53 1
Select RAID disk e.g sd0.
d57 5
a61 1
Depending on -d or -f enumerate all or only selected RAID device(s).
d64 1
a65 1
.Xr ami 4 ,
@


1.12
log
@revert marcos bio changes, mickey not ok
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.9 2005/07/01 21:53:40 marco Exp $
d35 3
a37 6
.Op Fl Dehpt
.Op Fl a Ar function
.Op Fl b Ar function
.Op Fl l Ar device-list
.Op Fl u Ar function
.Fl d Ar device
a44 8
.It Fl a Ar function
Get or set alarm state.
Supported functions are: silence/quiet, enable, disable, get, and test.
Or use the first letter of the function.
.It Fl b Ar function
Blink or unblink hard drive LED, if supported by the enclosure.
Supported functions are: blink, alarm (fault LED) and unblink.
Or use the first letter of the function.
d49 3
a51 7
Use the -d option for controller operations.
.It Fl e
Enumerate drives.
.It Fl f Ar disk
Select disk device e.g sd0.
Use the -f option for disk operations.
Either -f or -d must be selected.
d54 2
a55 16
.It Fl l Ar device-list
Device list to what the operation/function applies to.
The format is channel:target,channel:target etc. e.g. 0:1,1:3
.It Fl p
Verify that adapter accepts bioctl commands.
This is a sort of a "device ping".
.It Fl t
Issue a pass-through function to
.Aq device-list .
Supported functions are:
read capacity, inquiry, and test unit ready (TUR).
Or use the first letter of the function name.
.It Fl u Ar function
Start or stop physical disk.
Supported functions are: go and stop.
Or use the first letter of the function.
d59 1
@


1.11
log
@tweaks;
ok marco@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.10 2005/07/18 01:58:01 marco Exp $
d35 6
a40 3
.Op Fl Dhi
.Fl d Ar device |
.Fl f Ar device
d48 8
d59 8
a66 4
Select the RAID controller e.g. ami0.
Use this option for controller operations that impact all disk devices.
.It Fl f Ar device
Select the RAID disk e.g. sd0.
d69 16
a84 7
.It Fl i
Depending on whether the
.Fl d
or
.Fl f
option was selected,
enumerate all or only the selected RAID device(s).
a86 1
.Xr ami 4 ,
@


1.10
log
@Reflect new reality.
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.9 2005/07/01 21:53:40 marco Exp $
d48 2
a49 2
Select RAID controller e.g ami0.
Use the -d option for controller operations that impact all disk devices.
d51 1
a51 1
Select RAID disk e.g sd0.
d55 6
a60 1
Depending on -d or -f enumerate all or only selected RAID device(s).
d63 1
a64 1
.Xr ami 4 ,
@


1.9
log
@Add -f option for disk operations.  Idea by deraadt.

This is not fully functional yet.
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.8 2005/05/05 02:18:50 marco Exp $
d35 3
a37 6
.Op Fl Dehpt
.Op Fl a Ar function
.Op Fl b Ar function
.Op Fl l Ar device-list
.Op Fl u Ar function
.Fl d Ar device
a44 8
.It Fl a Ar function
Get or set alarm state.
Supported functions are: silence/quiet, enable, disable, get, and test.
Or use the first letter of the function.
.It Fl b Ar function
Blink or unblink hard drive LED, if supported by the enclosure.
Supported functions are: blink, alarm (fault LED) and unblink.
Or use the first letter of the function.
d49 3
a51 7
Use the -d option for controller operations.
.It Fl e
Enumerate drives.
.It Fl f Ar disk
Select disk device e.g sd0.
Use the -f option for disk operations.
Either -f or -d must be selected.
d54 2
a55 16
.It Fl l Ar device-list
Device list to what the operation/function applies to.
The format is channel:target,channel:target etc. e.g. 0:1,1:3
.It Fl p
Verify that adapter accepts bioctl commands.
This is a sort of a "device ping".
.It Fl t
Issue a pass-through function to
.Aq device-list .
Supported functions are:
read capacity, inquiry, and test unit ready (TUR).
Or use the first letter of the function name.
.It Fl u Ar function
Start or stop physical disk.
Supported functions are: go and stop.
Or use the first letter of the function.
d59 1
@


1.8
log
@Remove REGENTS in license.  Spotted miod@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.7 2005/04/06 02:36:34 marco Exp $
d59 2
a60 1
Select RAID device.
d63 4
@


1.7
log
@Add ses blink crud.  Not fully functional yet.
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.6 2005/04/05 06:32:16 jmc Exp $
d14 1
a14 1
.\" THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
d17 2
a18 2
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
@


1.6
log
@add -b to synopsis;
use .Bk/.Ek to avoid line split;
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.5 2005/04/04 22:43:07 marco Exp $
d54 1
a54 1
Supported functions are: blink and unblink.
@


1.5
log
@Add initial blink/unblink harness.
Fix INQUIRY namespace polution.
Little clean up and new debug messages.
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.4 2005/04/01 15:59:20 jmc Exp $
d34 1
d37 1
d41 1
@


1.4
log
@.Ox 3.8, not 3.7;
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.3 2005/03/30 08:06:03 dlg Exp $
d48 4
@


1.3
log
@update copyright for marco who says i can have the free commit
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.2 2005/03/30 07:18:55 jmc Exp $
d81 1
a81 1
.Ox 3.7 .
@


1.2
log
@fix .Dd;
fix SEE ALSO;
new sentence, new line;
sort options list;
@
text
@d1 1
a1 1
.\"	$OpenBSD: bioctl.8,v 1.1 2005/03/29 22:04:21 marco Exp $
d3 1
a3 1
.\" Copyright (c) 2004 Marco Peereboom
@


1.1
log
@adding initial bioctl code

ok mickey@@
@
text
@d1 1
a1 1
.\"	$OpenBSD$
d26 1
a26 1
.Dd Dec 27, 2004
d31 1
a31 1
.Nd "RAID management interface"
d45 4
d51 2
d57 3
d61 2
a62 1
Verify that adapter accepts bioctl commands.  This is a sort of a "device ping".
d64 5
a68 11
Issue a pass-through function to <device-list>.  Supported functions are: read
capacity, inquiry and test unit ready (TUR).  Or use the first letter of the
function name.
.It Fl a Ar function
Get or set alarm state.  Supported functions are: silence/quiet, enable,
disable, get and test.  Or use the first letter of the function.
.It Fl d Ar device
Select RAID device.
.It Fl l Ar device-list
Device list to what the operation/function applies to.  The format is
channel:target,channel:target etc.  i.e. 0:1,1:3
d70 3
a72 2
Start or stop physical disk.  Supported functions are: go and stop.  Or use the
first letter of the function.
d75 1
a75 1
.Xr bio 4
@

