head	1.83;
access;
symbols
	OPENBSD_6_2:1.83.0.2
	OPENBSD_6_2_BASE:1.83
	OPENBSD_6_1:1.79.0.4
	OPENBSD_6_1_BASE:1.79
	OPENBSD_6_0:1.78.0.4
	OPENBSD_6_0_BASE:1.78
	OPENBSD_5_9:1.78.0.2
	OPENBSD_5_9_BASE:1.78
	OPENBSD_5_8:1.77.0.4
	OPENBSD_5_8_BASE:1.77
	OPENBSD_5_7:1.74.0.2
	OPENBSD_5_7_BASE:1.74
	OPENBSD_5_6:1.73.0.6
	OPENBSD_5_6_BASE:1.73
	OPENBSD_5_5:1.73.0.4
	OPENBSD_5_5_BASE:1.73
	OPENBSD_5_4:1.71.0.2
	OPENBSD_5_4_BASE:1.71
	OPENBSD_5_3:1.70.0.4
	OPENBSD_5_3_BASE:1.70
	OPENBSD_5_2:1.70.0.2
	OPENBSD_5_2_BASE:1.70
	OPENBSD_5_1_BASE:1.69
	OPENBSD_5_1:1.69.0.2
	OPENBSD_5_0:1.68.0.2
	OPENBSD_5_0_BASE:1.68
	OPENBSD_4_9:1.66.0.2
	OPENBSD_4_9_BASE:1.66
	OPENBSD_4_8:1.64.0.4
	OPENBSD_4_8_BASE:1.64
	OPENBSD_4_7:1.64.0.2
	OPENBSD_4_7_BASE:1.64
	OPENBSD_4_6:1.59.0.4
	OPENBSD_4_6_BASE:1.59
	OPENBSD_4_5:1.56.0.4
	OPENBSD_4_5_BASE:1.56
	OPENBSD_4_4:1.56.0.2
	OPENBSD_4_4_BASE:1.56
	OPENBSD_4_3:1.55.0.4
	OPENBSD_4_3_BASE:1.55
	OPENBSD_4_2:1.55.0.2
	OPENBSD_4_2_BASE:1.55
	OPENBSD_4_1:1.50.0.2
	OPENBSD_4_1_BASE:1.50
	OPENBSD_4_0:1.44.0.2
	OPENBSD_4_0_BASE:1.44
	OPENBSD_3_9:1.43.0.4
	OPENBSD_3_9_BASE:1.43
	OPENBSD_3_8:1.43.0.2
	OPENBSD_3_8_BASE:1.43
	OPENBSD_3_7:1.41.0.4
	OPENBSD_3_7_BASE:1.41
	OPENBSD_3_6:1.41.0.2
	OPENBSD_3_6_BASE:1.41
	OPENBSD_3_5:1.30.0.4
	OPENBSD_3_5_BASE:1.30
	OPENBSD_3_4:1.30.0.2
	OPENBSD_3_4_BASE:1.30
	OPENBSD_3_3:1.28.0.2
	OPENBSD_3_3_BASE:1.28
	OPENBSD_3_2:1.27.0.2
	OPENBSD_3_2_BASE:1.27
	OPENBSD_3_1:1.26.0.6
	OPENBSD_3_1_BASE:1.26
	OPENBSD_3_0:1.26.0.4
	OPENBSD_3_0_BASE:1.26
	OPENBSD_2_9:1.26.0.2
	OPENBSD_2_9_BASE:1.26
	OPENBSD_2_8:1.25.0.2
	OPENBSD_2_8_BASE:1.25
	OPENBSD_2_7:1.24.0.2
	OPENBSD_2_7_BASE:1.24
	OPENBSD_2_6:1.18.0.2
	OPENBSD_2_6_BASE:1.18
	OPENBSD_2_5:1.14.0.2
	OPENBSD_2_5_BASE:1.14
	OPENBSD_2_4:1.9.0.2
	OPENBSD_2_4_BASE:1.9
	OPENBSD_2_3:1.7.0.2
	OPENBSD_2_3_BASE:1.7
	OPENBSD_2_2:1.6.0.2
	OPENBSD_2_2_BASE:1.6
	OPENBSD_2_1:1.5.0.2
	OPENBSD_2_1_BASE:1.5
	OPENBSD_2_0:1.3.0.2
	OPENBSD_2_0_BASE:1.3
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@.\" @;


1.83
date	2017.09.06.20.21.22;	author benno;	state Exp;
branches;
next	1.82;
commitid	tmOwKGIJNivYnWg0;

1.82
date	2017.08.11.10.28.55;	author jmc;	state Exp;
branches;
next	1.81;
commitid	JUnqjTBH3UeMB9Y5;

1.81
date	2017.08.10.17.47.31;	author benno;	state Exp;
branches;
next	1.80;
commitid	AAhoKQx3MtnsgQQu;

1.80
date	2017.08.10.16.05.23;	author benno;	state Exp;
branches;
next	1.79;
commitid	uxFSVUiwpkxiEYvp;

1.79
date	2017.01.01.01.08.11;	author tb;	state Exp;
branches;
next	1.78;
commitid	wnNuSAo7K6MoaRxC;

1.78
date	2015.09.11.20.08.40;	author mpi;	state Exp;
branches;
next	1.77;
commitid	5Sr0XPH2svtKebAw;

1.77
date	2015.07.18.00.05.02;	author phessler;	state Exp;
branches;
next	1.76;
commitid	w4H9LC8cbuDZ9nOJ;

1.76
date	2015.05.17.00.08.35;	author deraadt;	state Exp;
branches;
next	1.75;
commitid	iow9jGfRfepBECXM;

1.75
date	2015.05.06.07.55.42;	author mpi;	state Exp;
branches;
next	1.74;
commitid	oN5QjSq0hZ1CQSoA;

1.74
date	2015.02.06.03.22.00;	author reyk;	state Exp;
branches;
next	1.73;
commitid	2ShTul7wSa8iiu5L;

1.73
date	2014.02.26.21.10.03;	author claudio;	state Exp;
branches;
next	1.72;

1.72
date	2014.01.22.06.23.37;	author claudio;	state Exp;
branches;
next	1.71;

1.71
date	2013.05.27.14.07.25;	author sthen;	state Exp;
branches;
next	1.70;

1.70
date	2012.07.13.10.15.53;	author benno;	state Exp;
branches;
next	1.69;

1.69
date	2011.09.03.22.59.08;	author jmc;	state Exp;
branches;
next	1.68;

1.68
date	2011.07.05.05.44.05;	author jmc;	state Exp;
branches;
next	1.67;

1.67
date	2011.07.05.05.06.25;	author claudio;	state Exp;
branches;
next	1.66;

1.66
date	2010.09.21.14.46.40;	author jmc;	state Exp;
branches;
next	1.65;

1.65
date	2010.09.21.10.58.23;	author krw;	state Exp;
branches;
next	1.64;

1.64
date	2009.12.20.15.35.13;	author deraadt;	state Exp;
branches;
next	1.63;

1.63
date	2009.12.11.21.37.08;	author jmc;	state Exp;
branches;
next	1.62;

1.62
date	2009.12.01.16.21.46;	author reyk;	state Exp;
branches;
next	1.61;

1.61
date	2009.11.04.08.27.21;	author jmc;	state Exp;
branches;
next	1.60;

1.60
date	2009.11.03.22.37.59;	author claudio;	state Exp;
branches;
next	1.59;

1.59
date	2009.06.25.10.22.54;	author michele;	state Exp;
branches;
next	1.58;

1.58
date	2009.05.30.21.06.34;	author claudio;	state Exp;
branches;
next	1.57;

1.57
date	2009.05.30.19.50.28;	author claudio;	state Exp;
branches;
next	1.56;

1.56
date	2008.05.07.06.29.48;	author claudio;	state Exp;
branches;
next	1.55;

1.55
date	2007.06.04.12.23.43;	author henning;	state Exp;
branches;
next	1.54;

1.54
date	2007.05.31.19.19.47;	author jmc;	state Exp;
branches;
next	1.53;

1.53
date	2007.03.25.16.10.35;	author claudio;	state Exp;
branches;
next	1.52;

1.52
date	2007.03.23.20.29.35;	author jmc;	state Exp;
branches;
next	1.51;

1.51
date	2007.03.23.16.02.26;	author pyr;	state Exp;
branches;
next	1.50;

1.50
date	2007.01.19.20.49.30;	author jmc;	state Exp;
branches;
next	1.49;

1.49
date	2007.01.15.22.50.05;	author stevesk;	state Exp;
branches;
next	1.48;

1.48
date	2006.11.29.14.42.22;	author jmc;	state Exp;
branches;
next	1.47;

1.47
date	2006.11.28.21.37.22;	author jmc;	state Exp;
branches;
next	1.46;

1.46
date	2006.11.28.16.48.13;	author henning;	state Exp;
branches;
next	1.45;

1.45
date	2006.10.16.08.44.56;	author mcbride;	state Exp;
branches;
next	1.44;

1.44
date	2006.03.30.12.41.06;	author hshoexer;	state Exp;
branches;
next	1.43;

1.43
date	2005.03.30.08.52.35;	author henning;	state Exp;
branches;
next	1.42;

1.42
date	2005.03.30.05.20.18;	author henning;	state Exp;
branches;
next	1.41;

1.41
date	2004.08.10.20.02.04;	author jaredy;	state Exp;
branches;
next	1.40;

1.40
date	2004.08.03.13.39.52;	author henning;	state Exp;
branches;
next	1.39;

1.39
date	2004.07.15.23.40.39;	author jmc;	state Exp;
branches;
next	1.38;

1.38
date	2004.06.28.21.27.40;	author jmc;	state Exp;
branches;
next	1.37;

1.37
date	2004.06.26.13.53.55;	author jmc;	state Exp;
branches;
next	1.36;

1.36
date	2004.06.26.10.16.49;	author jmc;	state Exp;
branches;
next	1.35;

1.35
date	2004.06.25.01.26.01;	author henning;	state Exp;
branches;
next	1.34;

1.34
date	2004.06.19.19.55.53;	author cedric;	state Exp;
branches;
next	1.33;

1.33
date	2004.06.18.17.04.15;	author millert;	state Exp;
branches;
next	1.32;

1.32
date	2004.06.06.22.17.28;	author jmc;	state Exp;
branches;
next	1.31;

1.31
date	2004.06.06.17.08.23;	author cedric;	state Exp;
branches;
next	1.30;

1.30
date	2003.08.31.07.03.29;	author jmc;	state Exp;
branches;
next	1.29;

1.29
date	2003.06.02.20.06.16;	author millert;	state Exp;
branches;
next	1.28;

1.28
date	2003.02.11.07.26.20;	author jmc;	state Exp;
branches;
next	1.27;

1.27
date	2002.06.08.18.53.42;	author itojun;	state Exp;
branches;
next	1.26;

1.26
date	2000.12.20.21.18.39;	author deraadt;	state Exp;
branches;
next	1.25;

1.25
date	2000.07.27.20.12.25;	author angelos;	state Exp;
branches;
next	1.24;

1.24
date	2000.04.15.11.45.58;	author aaron;	state Exp;
branches;
next	1.23;

1.23
date	2000.04.15.02.15.17;	author aaron;	state Exp;
branches;
next	1.22;

1.22
date	2000.04.12.21.48.00;	author aaron;	state Exp;
branches;
next	1.21;

1.21
date	2000.03.18.22.56.04;	author aaron;	state Exp;
branches;
next	1.20;

1.20
date	2000.03.14.21.31.35;	author aaron;	state Exp;
branches;
next	1.19;

1.19
date	99.12.08.07.55.54;	author itojun;	state Exp;
branches;
next	1.18;

1.18
date	99.07.29.22.14.33;	author ho;	state Exp;
branches;
next	1.17;

1.17
date	99.06.04.02.45.23;	author aaron;	state Exp;
branches;
next	1.16;

1.16
date	99.05.23.14.11.20;	author aaron;	state Exp;
branches;
next	1.15;

1.15
date	99.05.12.13.26.49;	author aaron;	state Exp;
branches;
next	1.14;

1.14
date	99.03.16.02.46.51;	author deraadt;	state Exp;
branches;
next	1.13;

1.13
date	98.12.15.14.31.23;	author deraadt;	state Exp;
branches;
next	1.12;

1.12
date	98.12.15.01.20.43;	author aaron;	state Exp;
branches;
next	1.11;

1.11
date	98.11.28.19.56.33;	author aaron;	state Exp;
branches;
next	1.10;

1.10
date	98.11.11.22.20.00;	author aaron;	state Exp;
branches;
next	1.9;

1.9
date	98.09.23.01.20.25;	author aaron;	state Exp;
branches;
next	1.8;

1.8
date	98.09.17.04.15.01;	author aaron;	state Exp;
branches;
next	1.7;

1.7
date	98.01.15.17.22.32;	author niklas;	state Exp;
branches;
next	1.6;

1.6
date	97.07.13.23.12.08;	author angelos;	state Exp;
branches;
next	1.5;

1.5
date	97.04.10.10.09.01;	author deraadt;	state Exp;
branches;
next	1.4;

1.4
date	96.12.14.17.23.53;	author deraadt;	state Exp;
branches;
next	1.3;

1.3
date	96.08.16.09.26.10;	author mickey;	state Exp;
branches;
next	1.2;

1.2
date	96.06.23.14.32.22;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.43.47;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.43.47;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.83
log
@backout previous diff:
    autodetect AF when setting inet6 default route
    From Denis Fondras, thanks!
    ok phessler@@ bluhm@@
it breaks with ipv6 link-local routes, e.g.
/sbin/route -inet6 default -ifp pppoe0 fe80::%pppoe0
found by jmc@@
ok florian
@
text
@.\"	$OpenBSD: route.8,v 1.79 2017/01/01 01:08:11 tb Exp $
.\"	$NetBSD: route.8,v 1.6 1995/03/18 15:00:13 cgd Exp $
.\"
.\" Copyright (c) 1983, 1991, 1993
.\"	The Regents of the University of California.  All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. Neither the name of the University nor the names of its contributors
.\"    may be used to endorse or promote products derived from this software
.\"    without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.\"	@@(#)route.8	8.3 (Berkeley) 3/19/94
.\"
.Dd $Mdocdate: August 11 2017 $
.Dt ROUTE 8
.Os
.Sh NAME
.Nm route
.Nd manually manipulate the routing tables
.Sh SYNOPSIS
.Nm route
.Op Fl dnqtv
.Op Fl T Ar tableid
.Ar command
.Oo
.Op Ar modifiers
.Ar args
.Oc
.Sh DESCRIPTION
.Nm
is a utility used to manually view and manipulate the network routing tables.
Except for setting up the default route, it normally is not needed to
manipulate routes, as a
system routing table management daemon, such as
.Xr ripd 8 ,
.Xr ospfd 8 ,
or
.Xr bgpd 8 ,
should tend to this task.
.Pp
.Nm
can be used to modify nearly any aspect of the routing policy,
except packet forwarding, which can be manipulated through the
.Xr sysctl 8
command.
.Pp
The
.Nm
utility supports a limited number of general options,
but a rich command language enables the user to specify
any arbitrary request that could be delivered via the
programmatic interface discussed in
.Xr route 4 .
.Pp
The options are as follows:
.Bl -tag -width Ds
.It Fl d
Run in debug-only mode, i.e., don't actually modify the routing table.
.It Fl n
Bypass attempts to print host and network names symbolically
when reporting actions.
(The process of translating between symbolic
names and numerical equivalents can be quite time consuming, and
may require correct operation of the network; thus it may be expedient
to forgo this, especially when attempting to repair networking operations.)
.It Fl q
Suppress all output.
.It Fl T Ar tableid
Select an alternate routing table to modify or query.
The default is to use the current routing table.
.It Fl t
Write routing messages to a fake device
.Pa ( /dev/null )
instead of a real routing socket to test route manipulation.
.It Fl v
(verbose) Print additional details.
.El
.Pp
The
.Nm
utility provides the following simple commands:
.Bl -tag -width Fl
.It Xo
.Nm route
.Op Fl T Ar tableid
.Cm exec
.Op Ar command ...
.Xc
Execute a command forcing the process and its children to use the
routing table and appropriate routing domain as specified with the
.Fl T Ar tableid
option.
.It Xo
.Nm route
.Op Fl nqv
.Op Fl T Ar tableid
.Cm flush
.Op Ar modifiers
.Xc
Delete all gateway entries from the routing table.
When the address family is specified by any one of the
.Ar family
modifiers (listed below), only routes having destinations with addresses
in the delineated family will be deleted.
Also, only routes matching a specific interface or priority can be flushed
by using the
.Fl iface
or
.Fl priority
modifiers.
.It Xo
.Nm route
.Op Fl nv
.Op Fl T Ar tableid
.Cm get
.Op Ar modifiers
.Ar address
.Xc
Extract a routing entry from the kernel.
If
.Fl gateway
is specified, only routes whose gateway are in the
same address family as the destination are shown.
.It Xo
.Nm
.Op Fl n
.Cm monitor
.Op Ar modifiers
.Xc
Continuously report any changes to the routing information base,
routing lookup misses, or suspected network partitionings.
.Pp
When the address family is specified by any one of the
.Ar family
modifiers (listed below), only routes having destinations with addresses
in the delineated family will be shown.
If the
.Fl iface
modifier is used only interface specific messages (link state changes)
are shown.
.It Xo
.Nm route
.Op Fl nv
.Op Fl T Ar tableid
.Cm show
.Op Ar family
.Op Fl gateway
.Op Fl label Ar label
.Op Fl priority Ar priority
.Xc
Print out the route table similar to "netstat -r" (see
.Xr netstat 1 ) .
.Pp
If
.Fl gateway
is specified, only routes whose gateway are in the
same address family as the destination are shown.
.Pp
If
.Fl label
is specified, only routes with the specified label are shown.
.Pp
If
.Fl priority
is specified, only routes with the specified (numeric) priority are shown.
Some well-known priorities can be given by name.
If the priority is negative, then routes that do not match the numeric
priority are shown.
.El
.Pp
The other commands relating to adding, changing, or deleting routes
have the syntax:
.Pp
.Bl -tag -width Fl -compact
.It Xo
.Nm route
.Op Fl dnqtv
.Op Fl T Ar tableid
.Cm add
.Op Ar modifiers
.Ar destination gateway
.Xc
.It Xo
.Nm route
.Op Fl dnqtv
.Op Fl T Ar tableid
.Cm change
.Op Ar modifiers
.Ar destination gateway
.Xc
.It Xo
.Nm route
.Op Fl dnqtv
.Op Fl T Ar tableid
.Cm del Ns Op Cm ete
.Op Ar modifiers
.Ar destination gateway
.Xc
.El
.Pp
.Ar destination
is the destination host or network;
.Ar gateway
is the next-hop intermediary via which packets should be routed.
Routes to a particular host may be distinguished from those to
a network by interpreting the Internet address specified as the
.Ar destination
argument.
The optional modifiers
.Fl net
and
.Fl host
cause the destination to be interpreted as a network or a host, respectively.
Otherwise, type is chosen based on the following rules:
.Pp
The route is assumed to be to a network if any of the following apply to
.Ar destination :
.Pp
.Bl -bullet -compact
.It
it is the word "default", equivalent to 0/0
.It
it is an IPv4 address with less than 3 dots
.It
it is an IPv4 address with a
.Dq / Ns Em XX
suffix (where
.Em XX
is the number of bits in the network portion of the address
and is less than 32)
.It
it is an IPv6 address with a
.Dq / Ns Em XX
suffix (where
.Em XX
is the number of bits in the network portion of the address
and is less than 128)
.It
it is the symbolic name of a network.
.El
.Pp
If
.Ar destination
is a valid IP address or host name, it is presumed to be a route to a host.
.Pp
For example,
.Li 192.168.1.1
is interpreted as
.Fl host Li 192.168.1.1
and
.Li 192.168.1
is interpreted as
.Fl net Li 192.168.1 .
Note, however, that
.Li 192.168.2.0
will be interpreted as
.Fl host Li 192.168.2.0
since it is a complete IP address with 3 dots.
In this case the number of bits in the network portion of the address must
be explicitly listed, for example
.Li 192.168.2.0/24 ,
.Li 192.168.2/24 ,
or alternately
.Li 192.168.2 .
.Pp
If the destination is directly reachable
via an interface requiring
no intermediary system to act as a gateway, the
.Fl iface
modifier should be specified;
the gateway given is the address of this host on the common network,
indicating the interface to be used for transmission.
.Pp
To allow addresses to be interpreted as belonging to a particular address
family (as well as for use in the
.Ar family
arguments to some commands), the following modifiers may be used:
.Pp
.Bl -tag -width -inet6 -compact
.It Fl inet
Internet Protocol version 4 (IPv4) addresses
(see
.Xr ip 4 )
.It Fl inet6
Internet Protocol version 6 (IPv6) addresses
(see
.Xr ip6 4 )
.It Fl link
Hardware (link-level) addresses
.It Fl mpls
MPLS addresses
.It Fl sa
Actual
.Vt sockaddr
data, in hexadecimal format
.El
.Pp
In the absence of modifiers, an address is assumed to be IPv4,
unless containing a
.Sq :\&
character, when it is treated as IPv6.
.Pp
The optional modifier
.Fl link
specifies that all subsequent addresses are specified as link-level addresses,
and the names must be numeric specifications rather than
symbolic names.
.Pp
The optional
.Fl netmask
qualifier is intended to manually add subnet routes with
netmasks different from that of the implied network interface
(as would otherwise be communicated using a routing protocol).
One specifies an additional ensuing address parameter
(to be interpreted as a network mask).
The implicit network mask generated in the
.Dv AF_INET
case
can be overridden by making sure this option follows the
.Ar destination
parameter.
.Fl prefixlen
is also available for a similar purpose, for IPv6/v4.
.Pp
A specific routing priority can be specified with the optional
.Fl priority
qualifier.
If no priority is specified the kernel will set a priority depending on the
RTF_STATIC flag to either RTP_STATIC or RTP_DEFAULT.
Note that priority 1 is reserved for kernel use.
.Pp
The optional
.Fl mpath
modifier needs to be specified with the
.Cm add
command to be able to enter multiple gateways for the same destination address
(multipath).
When multiple routes exist for a destination, one route is selected based
on the source address of the packet.
The
.Xr sysctl 8
variables
.Va net.inet.ip.multipath
and
.Va net.inet6.ip6.multipath
are used to control multipath routing.
If set to 1,
multiple routes with the same priority are used equally;
if set to 0,
the first route selected will be used for subsequent packets to that
destination regardless of source.
.Pp
When inserting MPLS routes,
particular modifiers must be used.
The
.Fl mplslabel
modifier needs to be specified in an ingress LSR to associate a particular
label to an IPv4/IPv6 route.
The MPLS traffic
.Fl in
and
.Fl out
modifiers are intended to identify the ingress label and, optionally,
the outgoing one.
Additionally, one of the following operations must be used:
.Fl push ,
.Fl pop
and
.Fl swap .
Route's nexthop can be specified with the modifier
.Fl inet .
.Pp
Routes have associated flags which influence operation of the protocols
when sending to destinations matched by the routes.
These flags may be set (or sometimes cleared)
by indicating the following corresponding modifiers:
.Bl -column "-blackhole" "RTF_BLACKHOLE" "description"
.It Fl blackhole Ta Dv RTF_BLACKHOLE Ta "silently discard pkts (during updates)"
.It Fl cloning   Ta Dv RTF_CLONING   Ta "generates a new route on use"
.It Fl iface     Ta Dv ~RTF_GATEWAY  Ta "destination is directly reachable"
.It Fl llinfo    Ta Dv RTF_LLINFO    Ta "validly translates proto addr to link addr"
.It Fl mpath     Ta Dv RTF_MPATH     Ta "multiple gateways for a destination exist"
.It Fl nostatic  Ta Dv ~RTF_STATIC   Ta "pretend route added by kernel or daemon"
.It Fl proto1    Ta Dv RTF_PROTO1    Ta "set protocol specific routing flag #1"
.It Fl proto2    Ta Dv RTF_PROTO2    Ta "set protocol specific routing flag #2"
.It Fl reject    Ta Dv RTF_REJECT    Ta "emit an ICMP unreachable when matched"
.It Fl static    Ta Dv RTF_STATIC    Ta "manually added route"
.El
.Pp
The optional modifiers
.Fl expire
and
.Fl mtu
provide initial values to quantities maintained in the routing entry
by transport level protocols, such as TCP (see
.Xr tcp 4 ) .
They have the following meanings:
.Pp
.Bl -tag -width "-priority n" -compact
.It Fl expire Ar n
Lifetime for route (e.g., if generated by a redirect).
.It Fl mtu Ar n
Maximum transmission unit (MTU) size for this path.
.El
.Pp
These may be individually locked by preceding each such modifier to
be locked by
the
.Fl lock
meta-modifier, or one can
specify that all ensuing metrics may be locked by the
.Fl lockrest
meta-modifier.
.Pp
In a
.Cm change
or
.Cm add
command where the destination and gateway are not sufficient to specify
the route, the
.Fl ifp
or
.Fl ifa
modifiers may be used to determine the interface name or interface address.
.Pp
The optional
.Fl label
modifier specifies on route addition or modification that the route
should have the given
.Em label
associated with it.
Route labels can be used to attach arbitrary information to a route.
.Pp
All symbolic names specified for a
.Ar destination
or
.Ar gateway
are looked up first as a network name using
.Xr getnetbyname 3 .
If this lookup fails,
.Xr gethostbyname 3
is then used to interpret the name as a valid host name.
.Pp
.Nm
uses a routing socket (see
.Xr route 4 )
and the message types
.Dv RTM_ADD ,
.Dv RTM_DELETE ,
.Dv RTM_GET ,
and
.Dv RTM_CHANGE .
As such, only the superuser may modify
the routing tables.
.Sh FILES
.Bl -tag -width "/etc/networks" -compact
.It Pa /etc/hosts
host name database
.It Pa /etc/mygate
default gateway address
.It Pa /etc/networks
network name database
.El
.Sh EXAMPLES
Add a static
.Xr inet 4
route to the 192.168.5.0/24 network via the 192.168.0.1 gateway:
.Pp
.Dl # route add -inet 192.168.5.0/24 192.168.0.1
.Pp
Amend the
.Xr inet 4
route to the 192.168.5.0/24 network to use the 192.168.0.2 gateway:
.Pp
.Dl # route change -inet 192.168.5.0/24 192.168.0.2
.Pp
Delete the
.Xr inet 4
route to the 192.168.5.0/24 network:
.Pp
.Dl # route delete -inet 192.168.5.0/24
.Sh DIAGNOSTICS
.Bl -diag
.It "%s: gateway %s flags %x"
The specified route is being added to or deleted from the tables.
If the gateway address used was not the primary address of the gateway
(the first one returned by
.Xr gethostbyname 3 ) ,
the gateway address is printed numerically as well as symbolically.
.It "%s %s done"
When the
.Cm flush
command is specified, each routing table entry deleted
is indicated with a message of this form.
.It "Network is unreachable"
An attempt to add a route failed because the gateway listed was not
on a directly connected network.
The next-hop gateway must be given.
.It "not in table"
A
.Cm delete
operation was attempted for an entry which
wasn't present in the tables.
.It "routing table overflow"
An
.Cm add
operation was attempted, but the system was
low on resources and was unable to allocate memory
to create the new entry.
.El
.Sh SEE ALSO
.Xr netstat 1 ,
.Xr gethostbyname 3 ,
.Xr getnetbyname 3 ,
.Xr netintro 4 ,
.Xr route 4 ,
.Xr tcp 4 ,
.Xr hosts 5 ,
.Xr mygate 5 ,
.Xr networks 5 ,
.Xr bgpd 8 ,
.Xr ospfd 8 ,
.Xr ripd 8 ,
.Xr sysctl 8
.Sh HISTORY
The
.Nm
command appeared in
.Bx 4.2 .
IPv6 support was added by WIDE/KAME project.
.Pp
The
.Fl recvpipe ,
.Fl hopcount ,
.Fl sendpipe ,
.Fl ssthres ,
.Fl rtt ,
and
.Fl rttvar
modifiers used to be used to initialize various quantities in routing
table entries.
The routing system no longer uses these values and the modifiers
exist now only for compatibility with other operating systems.
.Sh BUGS
Some uses of the
.Fl ifa
or
.Fl ifp
modifiers with the
.Cm add
command will incorrectly fail with a
.Dq Network is unreachable
message if there is no default route.
See case
.Dv RTM_ADD
in
.Fn route_output
from
.Pa sys/net/rtsock.c
for details.
@


1.82
log
@new sentence, new line;
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.81 2017/08/10 17:47:31 benno Exp $
d33 1
a33 1
.Dd $Mdocdate: August 10 2017 $
a320 2
When using the "default" keyword,
the address family used is that of the gateway.
@


1.81
log
@document use of del as short form for delete, from jca
ok schwarze@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.80 2017/08/10 16:05:23 benno Exp $
d320 2
a321 1
character, when it is treated as IPv6. When using the "default" keyword,
d424 1
a424 3
Maximum transmission unit
.Tn ( MTU )
size for this path.
@


1.80
log
@autodetect AF when setting inet6 default route
From Denis Fondras, thanks!
ok phessler@@ bluhm@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.79 2017/01/01 01:08:11 tb Exp $
d33 1
a33 1
.Dd $Mdocdate: January 1 2017 $
d214 1
a214 1
.Cm delete
@


1.79
log
@Hyphenate compound adjectives 'up-to-date', 'out-of-date' and 'well-known'
if they precede the noun and omit hyphens otherwise.

ok tj
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.78 2015/09/11 20:08:40 mpi Exp $
d33 1
a33 1
.Dd $Mdocdate: September 11 2015 $
d320 2
a321 1
character, when it is treated as IPv6.
@


1.78
log
@Remove RTF_XRESOLVE support.
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.77 2015/07/18 00:05:02 phessler Exp $
d33 1
a33 1
.Dd $Mdocdate: July 18 2015 $
d185 1
a185 1
Some well known priorities can be given by name.
@


1.77
log
@On systems with a full routing table (550k+), we often want to be able to
look at the routes with a priority, or to display all routes that do not
have a specific priority (normally, don't show bgp).

We are intentionally not updating netstat -r yet, as we do not have a
good flag to use.

first version from, and OK benno@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.76 2015/05/17 00:08:35 deraadt Exp $
d33 1
a33 1
.Dd $Mdocdate: May 17 2015 $
a406 1
.It Fl xresolve  Ta Dv RTF_XRESOLVE  Ta "emit mesg on use (for external lookup)"
@


1.76
log
@nope, ioctl has not been used for a while
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.76 2015/05/17 00:04:08 deraadt Exp $
d168 1
d181 7
@


1.75
log
@Document that priority 1 is reserved for kernel use.
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.74 2015/02/06 03:22:00 reyk Exp $
d33 1
a33 1
.Dd $Mdocdate: February 6 2015 $
a499 3
The values printed are from the routing table entry supplied in the
.Xr ioctl 2
call.
@


1.74
log
@Remove route/netstat -f encap in favor of ipsecctl -s flow.

OK deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.73 2014/02/26 21:10:03 claudio Exp $
d33 1
a33 1
.Dd $Mdocdate: February 26 2014 $
d341 1
@


1.73
log
@Try to be more precise about rtable and rdomains.
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.72 2014/01/22 06:23:37 claudio Exp $
d33 1
a33 1
.Dd $Mdocdate: January 22 2014 $
a298 4
.It Fl encap
IPsec
(see
.Xr ipsec 4 )
@


1.72
log
@Remove genmask support from route(8). It still will show them in monitor
or get but you can no longer set it. genmask will die soon since nobody
needs it. OK benno@@ and agreed by dlg@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.71 2013/05/27 14:07:25 sthen Exp $
d33 1
a33 1
.Dd $Mdocdate: May 27 2013 $
d89 1
a89 1
Table 0 is the default table.
d108 2
a109 2
Execute a command forcing the process and its children into the
routing domain as specified with the
@


1.71
log
@autodetect ipv6 addresses for route(8). ok benno@@ bluhm@@, manpage help jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.70 2012/07/13 10:15:53 benno Exp $
d33 1
a33 1
.Dd $Mdocdate: July 13 2012 $
a441 9
.Pp
The optional
.Fl genmask
modifier specifies that a cloning mask is present.
This specifies the mask applied when determining if a child route should
be created.
It is only applicable to network routes with the
.Dv RTF_CLONING
flag set.
@


1.70
log
@allow destination/prefixlen syntax for ipv6 routes.
from Florian Obser, florian -AT- narrans -DOT- de

ok sthen@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.69 2011/09/03 22:59:08 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate: September 3 2011 $
d312 5
@


1.69
log
@make -column lists pretty again;

specifically, rewrite them to permit some markup in the column headers,
and use "Ta" instead of literal tabs; mandoc does not currently match groff
100%, but a mandoc fix may be some time off, and we've gone enough releases
with poorly formatting column lists.

in some cases i have rewritten the lists as -tag, where -column made
little sense.
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.68 2011/07/05 05:44:05 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate: July 5 2011 $
d242 7
@


1.68
log
@kill a useless Pp;
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.67 2011/07/05 05:06:25 claudio Exp $
d379 1
a379 1
.Bl -column blackhole RTF_BLACKHOLE
@


1.67
log
@Flip one .Fl interface to .Fl iface since iface is used everywhere else
even though -interface is the same as -iface.
OK jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.66 2010/09/21 14:46:40 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate: September 21 2010 $
a100 1
.Pp
@


1.66
log
@15 months later, there is still no mpls(4) man page: .Xr mpls 4 -> MPLS
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.65 2010/09/21 10:58:23 krw Exp $
d274 1
a274 1
.Fl interface
@


1.65
log
@Add '-label' to specify that you only want to see routes having the
given label. No change to existing functionality.

ok henning@@ claudio@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.64 2009/12/20 15:35:13 deraadt Exp $
d33 1
a33 1
.Dd $Mdocdate: December 20 2009 $
d300 1
a300 2
.Xr mpls 4
addresses
d356 2
a357 3
When inserting
.Xr mpls 4
routes, particular modifiers must be used.
d362 1
a362 3
The
.Xr mpls 4
traffic
@


1.64
log
@First shot at making this manual page not look like a black sheep.  Been
looking at it with claudio since I started doing more routing stuff.
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.63 2009/12/11 21:37:08 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate: December 11 2009 $
d168 1
d177 4
@


1.63
log
@be a little more specific about -ifp; from Doran Mori
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.62 2009/12/01 16:21:46 reyk Exp $
d33 1
a33 1
.Dd $Mdocdate: December 1 2009 $
d100 1
a100 1
utility provides several commands:
d102 15
a116 36
.Bl -tag -width Fl -compact
.It Cm add
Add a route.
.It Cm change
Change aspects of a route (such as its gateway).
.It Cm delete
Delete a specific route.
.It Cm exec
Execute a command in the specified routing domain.
.It Cm flush
Remove all routes.
.It Cm get
Lookup and display the route for a destination.
.It Cm monitor
Continuously report any changes to the routing information base,
routing lookup misses, or suspected network partitionings.
.It Cm show
Print out the route table similar to "netstat -r" (see
.Xr netstat 1 ) .
.El
.Pp
The
.Cm get
command has the syntax:
.Bd -filled -offset indent
.Nm route Op Fl nv
.Cm get
.Op Ar modifiers
.Ar address
.Ed
.Pp
The
.Cm flush
command has the syntax:
.Bd -filled -offset indent
.Nm route Op Fl dnqtv
d119 2
a120 9
.Ed
.Pp
If the
.Cm flush
command is specified,
.Nm
will
.Dq flush
the routing tables of all gateway entries.
d131 14
a144 13
.Pp
The
.Cm exec
command has the syntax:
.Bd -filled -offset indent
.Nm route Op Fl T Ar tableid
.Cm exec
.Op Ar command ...
.Ed
.Pp
If the
.Cm exec
command is specified,
d146 1
a146 10
will execute a command forcing the process and its children into the
routing domain as specified with the
.Fl T Ar tableid
option.
.Pp
The
.Cm monitor
command has the syntax:
.Bd -filled -offset indent
.Nm route Op Fl \&dn
d149 3
a151 1
.Ed
d161 4
a164 6
.Pp
The
.Cm show
command has the syntax:
.Bd -filled -offset indent
.Nm route Op Fl n
d168 3
a170 1
.Ed
d176 4
d181 22
a202 4
The other commands have the syntax:
.Bd -filled -offset indent
.Nm route Op Fl dnqtv
.Ar command
d205 2
a206 1
.Ed
a244 4
.Pp
If none of the above apply,
.Nm
prints an error message and exits.
@


1.62
log
@Add the new exec command to run a process and its children in a
non-default rdomain/rtable.  route will change the default rdomain
using the new setrdomain() syscall and execute the supplied command,
eg. "route -T1 exec /usr/sbin/named".

Tested by many including michele@@, phessler@@
ok claudio@@, deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.61 2009/11/04 08:27:21 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate: November 4 2009 $
d444 1
a444 1
modifiers may be used to determine the interface or interface address.
@


1.61
log
@tweak previous;
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.60 2009/11/03 22:37:59 claudio Exp $
d33 1
a33 1
.Dd $Mdocdate: November 3 2009 $
d109 2
d159 18
@


1.60
log
@Lies. We no longer support this magic netmask at the end of the line
compatibility.
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.59 2009/06/25 10:22:54 michele Exp $
d33 1
a33 1
.Dd $Mdocdate: June 25 2009 $
d200 1
a200 1
is the destination host or network,
@


1.59
log
@Document how to add static MPLS labels.

input jmc@@, ok claudio@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.58 2009/05/30 21:06:34 claudio Exp $
d33 1
a33 1
.Dd $Mdocdate: May 30 2009 $
d196 1
a196 1
.Ar destination gateway Op Ar netmask
d202 1
a202 6
is the next-hop intermediary via which packets should be routed,
and
.Ar netmask
behaves the same as the argument to the
.Fl netmask
modifier and is described below.
@


1.58
log
@Make it possible to filter monitor output on AF or show only interface
specific changes. OK henning@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.57 2009/05/30 19:50:28 claudio Exp $
d294 3
d351 23
@


1.57
log
@Make route flush more powerful by allowing -iface/-interface or -priority
to be specified. So only routes matching these conditions will be flushed.
This will help making dhclient less dumb when fiddeling with routes.
OK henning@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.56 2008/05/07 06:29:48 claudio Exp $
d33 1
a33 1
.Dd $Mdocdate: May 7 2008 $
d150 1
a150 2
in the
delineated family will be deleted.
d164 1
d166 9
@


1.56
log
@Document -priority. looks good norby@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.55 2007/06/04 12:23:43 henning Exp $
d33 1
a33 1
.Dd $Mdocdate: June 4 2007 $
d137 1
a137 1
.Op Ar family
d152 6
@


1.55
log
@remove IPX, agreed by many
libc and kernel side awaiting a libc major bump to piggyback to
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.54 2007/05/31 19:19:47 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate: May 31 2007 $
d307 6
d329 1
a329 1
multiple routes are used equally;
d353 2
a355 2
and
.Fl expire
d361 1
a361 1
.Bl -tag -width "-ssthresh n" -compact
@


1.54
log
@convert to new .Dd format;
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.53 2007/03/25 16:10:35 claudio Exp $
d33 1
a33 1
.Dd $Mdocdate$
a276 2
.It Fl ipx
Novell's Internet Packet Exchange (IPX) addresses
@


1.53
log
@Instead of using the global -F flag that only works with show, switch to a
show specific modifier -gateway to show only routes whose gateway are in the
same AF as the destination.
Requested by deraadt@@, OK pyr@@, reyk@@, michele@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.52 2007/03/23 20:29:35 jmc Exp $
d33 1
a33 1
.Dd March 19, 1994
@


1.52
log
@add -F to SYNOPSIS;
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.51 2007/03/23 16:02:26 pyr Exp $
d41 1
a41 1
.Op Fl dFnqtv
a77 3
.It Fl F
When showing routes, only show routes whose gateway are in the
same address family as the destination.
d168 1
d170 5
@


1.51
log
@Add a new flag -F to netstat restricting route display in conjuction
with -r to routes in the same address family as the destination.
ok henning@@, claudio@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.50 2007/01/19 20:49:30 jmc Exp $
d41 1
a41 1
.Op Fl dnqtv
@


1.50
log
@add an EXAMPLES section;

from mark lumsden via otto, tidied up somewhat by myself;
ok otto claudio
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.49 2007/01/15 22:50:05 stevesk Exp $
d78 3
@


1.49
log
@reference ripd(8) vs. routed(8) and remove routed statement in BUGS
that no longer applies because it is not referenced.  ok claudio@@ jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.48 2006/11/29 14:42:22 jmc Exp $
d427 18
@


1.48
log
@tweak; ok henning
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.47 2006/11/28 21:37:22 jmc Exp $
d54 1
a54 1
.Xr routed 8 ,
d471 1
a471 1
.Xr routed 8 ,
a492 4
The first paragraph may have slightly exaggerated
.Xr routed 8 Ns 's
abilities.
.Pp
@


1.47
log
@add -T to synopsis;
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.46 2006/11/28 16:48:13 henning Exp $
d88 1
a88 1
Select an alternate routing table to work against.
@


1.46
log
@-T in synopsis and briefly in manpage
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.45 2006/10/16 08:44:56 mcbride Exp $
d42 1
@


1.45
log
@More details on multipath.

ok henning + style suggestions from jmc
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.44 2006/03/30 12:41:06 hshoexer Exp $
d86 3
@


1.44
log
@document -encap.  ok claudio@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.43 2005/03/30 08:52:35 henning Exp $
d305 14
@


1.43
log
@mention ospfd as well
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.42 2005/03/30 05:20:18 henning Exp $
d263 4
@


1.42
log
@remove ccitt x.25 traces, ok theo
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.41 2004/08/10 20:02:04 jaredy Exp $
d53 2
a54 1
.Xr routed 8
d448 1
@


1.41
log
@update to reality
- fix syntax usage
- remove source routing stuff
- mention bgpd
- document -t, -genmask (from FreeBSD), and -label
- move -rtt, -rttvar, -recvpipe ... into HISTORY
- remove ISO mention
mdoc fixes
sort list of and add syntax usage for sub-commands
list supported address families in a separate table
consistency and reorganizational fixes
elaborate on some topics (some from NetBSD)
punctuation, grammar, and rewording fixes
add some FILES and cross-refs

requested by, help, and ok henning
help and ok jmc
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.40 2004/08/03 13:39:52 henning Exp $
a269 2
.It Fl x25
CCITT X.25 addresses
@


1.40
log
@-src/-srcmask are no more
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.39 2004/07/15 23:40:39 jmc Exp $
d41 1
a41 1
.Op Fl dnqSv
d49 3
a51 2
is a utility used to manually manipulate the network routing tables.
It normally is not needed, as a
d53 3
a55 1
.Xr routed 8 ,
d58 6
d71 2
d85 4
a88 4
.It Fl S
Make the
.Cm show
command display the source selector part of the routes.
d100 4
a105 4
.It Cm delete
Delete a specific route.
.It Cm change
Change aspects of a route (such as its gateway).
d108 3
a113 3
.It Cm monitor
Continuously report any changes to the routing information base,
routing lookup misses, or suspected network partitionings.
d117 2
a118 2
.Cm monitor
command has the syntax
d120 4
a123 2
.Nm route Op Fl n
.Cm monitor
d128 1
a128 1
command has the syntax
d130 1
a130 1
.Nm route Op Fl n
d142 4
a145 8
When the address family is specified by any of the
.Fl ipx ,
.Fl link ,
.Fl x25 ,
.Fl inet ,
or
.Fl inet6
modifiers, only routes having destinations with addresses in the
d148 11
a158 1
The other commands have the following syntax:
d161 7
d169 2
a170 2
.Op Fl net No \&| Fl host
.Ar destination gateway
a172 1
where
d174 1
a174 1
is the destination host or network and
d176 6
a181 1
is the next-hop intermediary via which packets should be routed.
d195 1
d203 4
a206 2
.Dq /XX
suffix (where XX is the number of bits in the network portion of the address
d214 1
a214 1
is a valid IP address or host name it is presumed to be a route to a host.
d236 1
a236 1
.Li 192.168.2/24
d248 26
d284 1
a284 1
(as would otherwise be communicated using the OSPF or ISIS routing protocols).
d296 1
a296 1
The
d307 13
a319 12
.Bd -literal
-cloning   RTF_CLONING    - generates a new route on use
-xresolve  RTF_XRESOLVE   - emit mesg on use (for external lookup)
-iface    ~RTF_GATEWAY    - destination is directly reachable
-static    RTF_STATIC     - manually added route
-nostatic ~RTF_STATIC     - pretend route added by kernel or daemon
-reject    RTF_REJECT     - emit an ICMP unreachable when matched
-blackhole RTF_BLACKHOLE  - silently discard pkts (during updates)
-proto1    RTF_PROTO1     - set protocol specific routing flag #1
-proto2    RTF_PROTO2     - set protocol specific routing flag #2
-llinfo    RTF_LLINFO     - validly translates proto addr to link addr
.Ed
d322 1
a322 7
.Fl rtt ,
.Fl rttvar ,
.Fl sendpipe ,
.Fl recvpipe ,
.Fl mtu ,
.Fl hopcount ,
.Fl expire ,
d324 1
a324 1
.Fl ssthresh
d326 13
a338 1
by transport level protocols, such as TCP or TP4.
d359 17
d387 3
a389 1
uses a routing socket and the new message types
d398 3
a400 1
.Bl -tag -width "/etc/mygate" -compact
d402 3
a404 1
Default gateway address.
d439 3
d444 2
d447 4
a450 1
.Xr routed 8
d457 13
d472 1
a472 1
.Xr routed Ns 's
@


1.39
log
@remove references to removed pages: clnp(4), esis(4), and iso(4);
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.38 2004/06/28 21:27:40 jmc Exp $
a280 19
.Pp
The
.Fl src
and
.Fl srcmask
modifiers can be used to specify the source selector of the route,
which will match the source IP address of outgoing packets.
.Fl src
and
.Fl srcmask
work in a similar way to
.Fl dst
and
.Fl netmask .
For example:
.Bd -literal -offset indent
# route add -src 180.83.46.98 180.83.46.97
# route add -src 192.168.10/24 -dst 10.5.1/24 180.83.46.97
.Ed
@


1.38
log
@- repair examples which i damaged in previous commit
- tidy up DIAGNOSTICS, and use -diag
- wording

from jared yanovich;
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.37 2004/06/26 13:53:55 jmc Exp $
a368 1
.Xr esis 4 ,
@


1.37
log
@grammar, formatting, consistency, spelling, etc. from jared yanovich;
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.36 2004/06/26 10:16:49 jmc Exp $
d297 2
a298 2
# route add src 180.83.46.98 180.83.46.97
# route add src 192.168.10/24 dst 10.5.1/24 180.83.46.97
d337 3
a339 3
.Bl -tag -width Ds
.It Sy "add [host \&| network ] %s: gateway %s flags %x"
The specified route is being added to the tables.
d347 1
a347 3
.It Sy "delete [ host &| network ] %s: gateway %s flags %x"
As above, but when deleting an entry.
.It Sy "%s %s done"
d352 1
a352 1
.It Sy "Network is unreachable"
d356 1
a356 1
.It Sy "not in table"
d361 1
a361 1
.It Sy "routing table overflow"
d397 3
a399 1
.Pa sys/net/rtsock.c:route_output
@


1.36
log
@grammar;
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.35 2004/06/25 01:26:01 henning Exp $
d41 1
a41 1
.Op Fl dnqv
d66 1
a66 1
Bypasses attempts to print host and network names symbolically
a71 2
.It Fl v
(verbose) Print additional details.
d75 1
a75 1
Makes the
d78 2
d98 1
a98 1
Print out the route table similar to "netstat \-r" (see
d105 3
a107 1
The monitor command has the syntax
d113 3
a115 1
The flush command has the syntax
d161 1
a161 1
Otherwise, type is chosen based on the following rules.
d183 1
a183 1
If none of the above apply
d231 3
a233 1
can be overridden by making sure this option follows the destination parameter.
d296 3
a298 15
.Bd -filled -offset indent
.Nm route
.Cm add
.Fl src
180.83.46.98
180.83.46.97
.Ed
.Bd -filled -offset indent -compact
.Nm route
.Cm add
.Fl src
192.168.10/24
.Fl dst
10.5.1/24
180.83.46.97
d320 1
a320 1
is then used to interpret the name a valid host name.
d324 3
a326 3
RTM_ADD,
RTM_DELETE,
RTM_GET,
d328 1
a328 1
RTM_CHANGE.
@


1.35
log
@remove netiso and netns code
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.34 2004/06/19 19:55:53 cedric Exp $
d213 1
a213 1
specify that all subsequent addresses are specified as link-level addresses,
d233 1
a233 1
modifier need to be specified with the
@


1.34
log
@require RTF_MPATH to enter a multipath route with RTM_ADD.
route(8) takes a new -mpath modifier to enter a multipath route.
requested deraadt@@, ok itojun@@ mcbride@@ millert@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.33 2004/06/18 17:04:15 millert Exp $
a125 2
.Fl osi ,
.Fl xns ,
d211 1
a211 4
The optional modifiers
.Fl xns ,
.Fl osi ,
and
d213 1
a213 5
specify that all subsequent addresses are in the
.Tn XNS
.Tn OSI
address families,
or are specified as link-level addresses,
d219 1
a219 6
qualifier is intended
to achieve the effect of an
.Tn OSI
.Tn ESIS
redirect with the netmask option,
or to manually add subnet routes with
d312 1
a312 4
the route (as in the
.Tn ISO
case where several interfaces may have the
same address), the
@


1.33
log
@Make this better reflect reality; OK and with help from Cedric
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.32 2004/06/06 22:17:28 jmc Exp $
d244 7
@


1.32
log
@- wording
- simplify some displays
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.31 2004/06/06 17:08:23 cedric Exp $
d158 20
a177 2
force the destination to be interpreted as a network or a host, respectively.
Otherwise, if the
d179 5
a183 9
has a
.Dq local address part
of
.Dv INADDR_ANY ,
or if the
.Ar destination
is the symbolic name of a network, then the route is
assumed to be to a network; otherwise, it is presumed to be a
route to a host.
d186 1
a186 7
.Li 128.32
is interpreted as
.Fl host Li 128.0.0.32 ;
.Li 128.32.130
is interpreted as
.Fl host Li 128.32.0.130 ;
.Fl net Li 128.32
d188 1
a188 1
.Li 128.32.0.0 ;
d190 1
a190 1
.Fl net Li 128.32.130
d192 12
a203 11
.Li 128.32.130.0 .
A more detailed syntax is also available, for example
.Fl net Li 192.168.64.0/20
is interpreted to specify that the high 20 bits of the address
192.168.64.0 are the requested network.
.Pp
As a special case, the default route can be accessed using an
argument of
.Dq default
for
.Ar destination .
d308 1
a308 1
192.168.10.0/24
d310 1
a310 1
10.5.1.0/24
d332 2
a333 2
are looked up first as a host name using
.Xr gethostbyname 3 .
d335 2
a336 2
.Xr getnetbyname 3
is then used to interpret the name as that of a network.
@


1.31
log
@add new "-src" and "-srcmask" modifiers to make it possible to add a source
selector part to the routing table entry. complements existing "-dst" and
"-dstmask". typical use:

   route add -src 20.20.20.22 20.20.20.21
   route add -src 192.168.1.0/24 -dst 192.168.2.0/24 20.20.20.21

useful for example to implement symetrical routing on multihomed boxes,
or to better select which packets to send to gif/tun/... tunnels.
new '-S' flag similar to netstat one. ok deraadt@@ mcbride@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.30 2003/08/31 07:03:29 jmc Exp $
d106 1
a106 2
.Pp
.Bd -filled -offset indent -compact
d112 1
a112 2
.Pp
.Bd -filled -offset indent -compact
d138 1
a138 2
.Pp
.Bd -filled -offset indent -compact
d283 1
a283 1
work in a similar way than
d288 1
a288 2
.Pp
.Bd -filled -offset indent -compact
@


1.30
log
@add references to /etc/mygate in FILES and SEE ALSO;
from Han Boetes.
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.29 2003/06/02 20:06:16 millert Exp $
d76 4
d276 32
@


1.29
log
@Remove the advertising clause in the UCB license which Berkeley
rescinded 22 July 1999.  Proofed by myself and Theo.
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.28 2003/02/11 07:26:20 jmc Exp $
d306 5
d349 1
@


1.28
log
@typos;

raidctl(8) ok millert@@
mknetid(8) help maja@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.27 2002/06/08 18:53:42 itojun Exp $
d15 1
a15 5
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgement:
.\"	This product includes software developed by the University of
.\"	California, Berkeley and its contributors.
.\" 4. Neither the name of the University nor the names of its contributors
@


1.27
log
@support IPv4 in -prefixlen.
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.26 2000/12/20 21:18:39 deraadt Exp $
d55 1
a55 1
system routing table management daemon such as
d189 1
a189 1
.Li net 192.168.64.0/20
d237 1
a237 1
is also available for similar purpose, in IPv6/v4 case.
d364 3
a366 1
modifiers with the add command will incorrectly fail with a
@


1.26
log
@document "default" argument
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.26 2000/12/20 21:11:37 deraadt Exp $
d237 1
a237 1
is also available for similar purpose, in IPv6 case.
@


1.25
log
@Don't show or delete IPsec flows with the route command -- this was a
kludge to begin with, and it's about time we get rid of it.
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.24 2000/04/15 11:45:58 aaron Exp $
d192 6
@


1.24
log
@- For consistency, `super-user' -> `superuser' in all cases.
- Some punctuation fixes.
- Some `id' -> `ID'.
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.23 2000/04/15 02:15:17 aaron Exp $
d126 1
a126 4
the routing tables of all gateway entries expect
the
.Dq encap
family entries (IPsec routing flows).
a131 1
.Fl encap ,
a339 1
.Xr ipsecadm 1 ,
@


1.23
log
@Mostly punctuation fixes.
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.22 2000/04/12 21:48:00 aaron Exp $
d306 1
a306 1
As such, only the super-user may modify
@


1.22
log
@Trailing whitespace begone!
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.21 2000/03/18 22:56:04 aaron Exp $
d99 1
a99 1
.Xr netstat 1 ).
d134 1
a134 1
.Fl link,
d187 1
a187 1
.Li 128.32.0.0;
@


1.21
log
@Remove hard sentence breaks, and some other cleanup along the way.
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.20 2000/03/14 21:31:35 aaron Exp $
d127 1
a127 1
the 
@


1.20
log
@Suffix "i.e." and "e.g." with a comma. Just another really picky man page
commit, as we want our documentation to be as consistently formatted as
possible (it's getting there :-)).
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.19 1999/12/08 07:55:54 itojun Exp $
d53 2
a54 2
is a utility used to manually manipulate the network
routing tables.  It normally is not needed, as a
d71 2
a72 1
when reporting actions.  (The process of translating between symbolic
d311 2
a312 3
The specified route is being added to the tables.  The
values printed are from the routing table entry supplied
in the
@


1.19
log
@ipv6 support from KAME (needs no libc upgrade).  regen keywords.[ch].
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.18 1999/07/29 22:14:33 ho Exp $
d68 1
a68 1
Run in debug-only mode, i.e. don't actually modify the routing table.
@


1.18
log
@Modified 'route flush' default behaviour to skip '-encap' (PF_KEY) flows,
as deleting these will leave the SPIs behind. 'route flush -encap' will
still delete the flows. 'ipsecadm' should do this, and properly.

PF_KEY/AF_KEY nitpick. Sync man page. Add ref to ipsecadm(1).
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.17 1999/06/04 02:45:23 aaron Exp $
d136 1
d138 1
a138 1
.Fl inet
d233 2
d353 1
d358 13
@


1.17
log
@start to remove non-escaped trailing whitespace, it can confuse troff; pjanzen@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.16 1999/05/23 14:11:20 aaron Exp $
d125 5
a129 2
the routing tables of all gateway entries.
When the address family may is specified by any of the
d132 2
d135 1
d341 1
@


1.16
log
@remove argument from .Os macros so value in /usr/share/tmac/mdoc/doc-common
is used instead; kwesterback@@home.com
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.15 1999/05/12 13:26:49 aaron Exp $
d64 1
a64 1
programmatic interface discussed in 
d119 1
a119 1
If the 
d121 1
a121 1
command is specified, 
d158 1
a158 1
Otherwise, if the 
d180 1
a180 1
and 
d191 1
a191 1
no intermediary system to act as a gateway, the 
d201 1
a201 1
.Fl link 
d260 1
a260 1
meta-modifier, or one can 
d281 1
a281 1
or 
d303 1
a303 1
in the 
d310 1
a310 1
.It Sy "delete [ host &| network ] %s: gateway %s flags %x" 
d313 1
a313 1
When the 
@


1.15
log
@grammar police: do not hyphenate compound words that act as adjectives if the
first word ends in -ly

i.e., fully-qualified, newly-created, globally-visible, etc. are wrong
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.14 1999/03/16 02:46:51 deraadt Exp $
d39 1
a39 1
.Os BSD 4.4
@


1.14
log
@fix Xr; msfriedl@@fau.de
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.13 1998/12/15 14:31:23 deraadt Exp $
d319 1
a319 1
on a directly-connected network.
@


1.13
log
@clean; form
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.12 1998/12/15 01:20:43 aaron Exp $
d98 1
a98 1
.Xr netstat 8 ).
@


1.12
log
@always give .Nm macros an argument in SYNOPSIS sections; krw@@tcn.net
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.11 1998/11/28 19:56:33 aaron Exp $
d337 1
a337 3
.Xr routed 8 ,
.Xr IPXrouted 8 ,
.Xr XNSrouted 8
@


1.11
log
@kill redundant .Nm macro arguments; other misc fixes
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.10 1998/11/11 22:20:00 aaron Exp $
d44 1
a44 1
.Nm
@


1.10
log
@more `` '' -> .Dq sillyness; remove redundant .Pp macros; other misc fixes
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.9 1998/09/23 01:20:25 aaron Exp $
d44 1
a44 1
.Nm route
d52 1
a52 1
.Nm route
d60 1
a60 1
.Nm route
d82 1
a82 1
.Nm route
d122 1
a122 1
.Nm route
d289 1
a289 1
.Nm route
@


1.9
log
@alphabetize SEE ALSO entries and order them numerically according to section
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.8 1998/09/17 04:15:01 aaron Exp $
a65 1
.Pp
d123 3
a125 1
will ``flush'' the routing tables of all gateway entries.
d160 4
a163 2
has a ``local address part'' of
INADDR_ANY,
d222 3
a224 1
The implicit network mask generated in the AF_INET case
@


1.8
log
@sbin/ man page fixes
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.7 1998/01/15 17:22:32 niklas Exp $
d329 1
a331 1
.Xr esis 4 ,
d333 2
a334 2
.Xr XNSrouted 8 ,
.Xr IPXrouted 8
@


1.7
log
@document -d
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.6 1997/07/13 23:12:08 angelos Exp $
d42 1
a42 1
.Nd manually manipulate the routing tables.
d52 1
a52 1
.Nm Route
d60 1
a60 1
.Nm route :
d62 1
a62 1
but a rich command language, enabling the user to specify
d75 1
a75 1
to forgo this, especially when attempting to repair networking operations).
d83 1
a83 1
.Nm route :
d145 1
a145 1
is the destination host or network,
d150 2
a151 1
.Ar destination argument.
d160 1
a160 1
INADDR_ANY ,
d284 1
a284 1
.Nm Route
d317 3
a319 1
A delete operation was attempted for an entry which
d322 3
a324 1
An add operation was attempted, but the system was
d333 1
a333 1
.Xr XNSrouted 8
@


1.6
log
@Added -encap flag for flushing, added a missing break; in flushing X25
entries.
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.5 1997/04/10 10:09:01 deraadt Exp $
d45 1
a45 1
.Op Fl nqv
d68 2
d75 1
a75 1
to forgo this, especially when attempting to repair networking operations),
@


1.5
log
@allow syntax of the form "route add -net 192.168.64.0/20 <destaddr>";
phk@@freebsd, man page changes done by me 'cause i'm a bit bored
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.4 1996/12/14 17:23:53 deraadt Exp $
d126 1
@


1.4
log
@merge netbsd changes for show command
yet more buf oflows (provided by netbsd!)
an attempt at 64 bit cleanliness
-Wall
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.3 1996/08/16 09:26:10 mickey Exp $
d177 4
@


1.3
log
@ipx.
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.2 1996/06/23 14:32:22 deraadt Exp $
d82 1
a82 1
utility provides six commands:
d95 3
@


1.2
log
@update rcsid
@
text
@d1 1
a1 1
.\"	$OpenBSD: route.8,v 1.6 1995/03/18 15:00:13 cgd Exp $
d319 1
@


1.1
log
@Initial revision
@
text
@d1 1
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
