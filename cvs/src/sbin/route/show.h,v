head	1.12;
access;
symbols
	OPENBSD_6_1:1.12.0.4
	OPENBSD_6_1_BASE:1.12
	OPENBSD_6_0:1.11.0.6
	OPENBSD_6_0_BASE:1.11
	OPENBSD_5_9:1.11.0.2
	OPENBSD_5_9_BASE:1.11
	OPENBSD_5_8:1.11.0.4
	OPENBSD_5_8_BASE:1.11
	OPENBSD_5_7:1.10.0.2
	OPENBSD_5_7_BASE:1.10
	OPENBSD_5_6:1.10.0.4
	OPENBSD_5_6_BASE:1.10
	OPENBSD_5_5:1.9.0.16
	OPENBSD_5_5_BASE:1.9
	OPENBSD_5_4:1.9.0.12
	OPENBSD_5_4_BASE:1.9
	OPENBSD_5_3:1.9.0.10
	OPENBSD_5_3_BASE:1.9
	OPENBSD_5_2:1.9.0.8
	OPENBSD_5_2_BASE:1.9
	OPENBSD_5_1_BASE:1.9
	OPENBSD_5_1:1.9.0.6
	OPENBSD_5_0:1.9.0.4
	OPENBSD_5_0_BASE:1.9
	OPENBSD_4_9:1.9.0.2
	OPENBSD_4_9_BASE:1.9
	OPENBSD_4_8:1.7.0.2
	OPENBSD_4_8_BASE:1.7
	OPENBSD_4_7:1.6.0.14
	OPENBSD_4_7_BASE:1.6
	OPENBSD_4_6:1.6.0.16
	OPENBSD_4_6_BASE:1.6
	OPENBSD_4_5:1.6.0.12
	OPENBSD_4_5_BASE:1.6
	OPENBSD_4_4:1.6.0.10
	OPENBSD_4_4_BASE:1.6
	OPENBSD_4_3:1.6.0.8
	OPENBSD_4_3_BASE:1.6
	OPENBSD_4_2:1.6.0.6
	OPENBSD_4_2_BASE:1.6
	OPENBSD_4_1:1.6.0.4
	OPENBSD_4_1_BASE:1.6
	OPENBSD_4_0:1.6.0.2
	OPENBSD_4_0_BASE:1.6
	OPENBSD_3_9:1.4.0.4
	OPENBSD_3_9_BASE:1.4
	OPENBSD_3_8:1.4.0.2
	OPENBSD_3_8_BASE:1.4
	OPENBSD_3_7:1.3.0.2
	OPENBSD_3_7_BASE:1.3
	OPENBSD_3_6:1.1.0.2
	OPENBSD_3_6_BASE:1.1;
locks; strict;
comment	@ * @;


1.12
date	2016.12.13.08.40.54;	author mpi;	state Exp;
branches;
next	1.11;
commitid	FpLOfKi5ERXgAXWf;

1.11
date	2015.07.18.00.05.02;	author phessler;	state Exp;
branches;
next	1.10;
commitid	w4H9LC8cbuDZ9nOJ;

1.10
date	2014.04.17.15.35.35;	author claudio;	state Exp;
branches;
next	1.9;

1.9
date	2010.10.11.11.45.00;	author claudio;	state Exp;
branches;
next	1.8;

1.8
date	2010.09.21.10.58.23;	author krw;	state Exp;
branches;
next	1.7;

1.7
date	2010.03.23.15.01.50;	author claudio;	state Exp;
branches;
next	1.6;

1.6
date	2006.06.16.17.46.43;	author henning;	state Exp;
branches;
next	1.5;

1.5
date	2006.05.27.18.26.45;	author claudio;	state Exp;
branches;
next	1.4;

1.4
date	2005.03.30.05.40.55;	author henning;	state Exp;
branches;
next	1.3;

1.3
date	2005.02.18.04.00.21;	author jaredy;	state Exp;
branches;
next	1.2;

1.2
date	2004.09.22.01.07.10;	author jaredy;	state Exp;
branches;
next	1.1;

1.1
date	2004.06.12.09.40.49;	author claudio;	state Exp;
branches;
next	;


desc
@@


1.12
log
@Print the correct netmask instead of /0 when flushing routes to networks.

Issue reported by jsing@@, ok stsp@@
@
text
@/*	$OpenBSD: show.h,v 1.11 2015/07/18 00:05:02 phessler Exp $ */

/*
 * Copyright (c) 2004 Claudio Jeker <claudio@@openbsd.org>
 *
 * Permission to use, copy, modify, and distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 */

#ifndef __SHOW_H__
#define __SHOW_H__

union sockunion {
	struct sockaddr		sa;
	struct sockaddr_in	sin;
	struct sockaddr_in6	sin6;
	struct sockaddr_dl	sdl;
	struct sockaddr_rtlabel	rtlabel;
	struct sockaddr_mpls	smpls;
};

void	 get_rtaddrs(int, struct sockaddr *, struct sockaddr **);
void	 p_rttables(int, u_int, int, char);
void	 p_sockaddr(struct sockaddr *, struct sockaddr *, int, int);
char	*routename(struct sockaddr *);
char	*netname(struct sockaddr *, struct sockaddr *);
char	*mpls_op(u_int32_t);

extern int nflag;
extern int Fflag;
extern int verbose;
extern union sockunion so_label;

#define PLEN  (LONG_BIT / 4 + 2)

#endif /* __SHOW_H__ */
@


1.11
log
@On systems with a full routing table (550k+), we often want to be able to
look at the routes with a priority, or to display all routes that do not
have a specific priority (normally, don't show bgp).

We are intentionally not updating netstat -r yet, as we do not have a
good flag to use.

first version from, and OK benno@@
@
text
@d1 1
a1 1
/*	$OpenBSD: show.h,v 1.10 2014/04/17 15:35:35 claudio Exp $ */
d31 1
d33 1
@


1.10
log
@Sync show.c to what we have in netstat.c (at least steal some good idioms
from there). OK sthen@@ mpi@@ jca@@
@
text
@d1 1
a1 1
/*	$OpenBSD: show.h,v 1.9 2010/10/11 11:45:00 claudio Exp $ */
d31 1
a31 1
void	 p_rttables(int, u_int, int);
@


1.9
log
@Make route(8) use the ROUTE_TABLEFILTER and change the code so that
route(8) will default to the process rtableid.
route -T 1 exec route add default 192.168.1.1
route -T 1 exec route -n show
These commands will now operate outmatically on rtable 1 and not on
rtable 0 as it was done before.
OK henning@@
@
text
@d1 1
a1 1
/*	$OpenBSD: show.h,v 1.8 2010/09/21 10:58:23 krw Exp $ */
d35 7
@


1.8
log
@Add '-label' to specify that you only want to see routes having the
given label. No change to existing functionality.

ok henning@@ claudio@@
@
text
@d1 1
a1 1
/*	$OpenBSD: show.h,v 1.7 2010/03/23 15:01:50 claudio Exp $ */
d31 1
a31 1
void	 p_rttables(int, u_int);
@


1.7
log
@Print MPLS information in route -n get and do some cleanup in the show code.
OK michele@@
@
text
@d1 1
a1 1
/*	$OpenBSD: show.h,v 1.6 2006/06/16 17:46:43 henning Exp $ */
d21 9
@


1.6
log
@make route show work on secondary tables, using the just committed
extension to the syctl NET_RT_DUMP interface, claudio ok
@
text
@d1 1
a1 1
/*	$OpenBSD: show.h,v 1.5 2006/05/27 18:26:45 claudio Exp $ */
d25 1
@


1.5
log
@Kill unused Aflag support that sneeked in via netstat code.
@
text
@d1 1
a1 1
/*	$OpenBSD: show.h,v 1.4 2005/03/30 05:40:55 henning Exp $ */
d22 1
a22 1
void	 p_rttables(int);
@


1.4
log
@more bitrot bites the dust
@
text
@d1 1
a1 1
/*	$OpenBSD: show.h,v 1.3 2005/02/18 04:00:21 jaredy Exp $ */
d22 1
a22 1
void	 p_rttables(int, int);
@


1.3
log
@ansi, knf, and other style nits; ok henning
@
text
@d1 1
a1 1
/*	$OpenBSD: show.h,v 1.2 2004/09/22 01:07:10 jaredy Exp $ */
a24 6
char	*any_ntoa(const struct sockaddr *);
char	*ns_print(struct sockaddr *);
char	*ipx_print(struct sockaddr *);
char	*link_print(struct sockaddr *);

extern int nflag;
@


1.2
log
@remove -S, -src, -srcmask, and other source routing stuff.  ok henning
@
text
@d1 1
a1 1
/*	$OpenBSD: show.h,v 1.1 2004/06/12 09:40:49 claudio Exp $ */
d19 2
a20 2
#ifndef __UTILS_H__
#define __UTILS_H__
d32 1
a32 1
#endif
@


1.1
log
@Make route show output similar to netstat -r output.
OK cedric@@ millert@@
@
text
@d1 1
a1 1
/*	$OpenBSD$ */
d22 1
a22 1
void	 p_rttables(int, int, int);
@

