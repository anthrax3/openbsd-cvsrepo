head	1.17;
access;
symbols
	OPENBSD_6_0:1.17.0.6
	OPENBSD_6_0_BASE:1.17
	OPENBSD_5_9:1.17.0.2
	OPENBSD_5_9_BASE:1.17
	OPENBSD_5_8:1.17.0.4
	OPENBSD_5_8_BASE:1.17
	OPENBSD_5_7:1.16.0.2
	OPENBSD_5_7_BASE:1.16
	OPENBSD_5_6:1.16.0.6
	OPENBSD_5_6_BASE:1.16
	OPENBSD_5_5:1.16.0.4
	OPENBSD_5_5_BASE:1.16
	OPENBSD_5_4:1.14.0.2
	OPENBSD_5_4_BASE:1.14
	OPENBSD_5_3:1.13.0.2
	OPENBSD_5_3_BASE:1.13
	OPENBSD_5_2:1.12.0.22
	OPENBSD_5_2_BASE:1.12
	OPENBSD_5_1_BASE:1.12
	OPENBSD_5_1:1.12.0.20
	OPENBSD_5_0:1.12.0.18
	OPENBSD_5_0_BASE:1.12
	OPENBSD_4_9:1.12.0.16
	OPENBSD_4_9_BASE:1.12
	OPENBSD_4_8:1.12.0.14
	OPENBSD_4_8_BASE:1.12
	OPENBSD_4_7:1.12.0.10
	OPENBSD_4_7_BASE:1.12
	OPENBSD_4_6:1.12.0.12
	OPENBSD_4_6_BASE:1.12
	OPENBSD_4_5:1.12.0.8
	OPENBSD_4_5_BASE:1.12
	OPENBSD_4_4:1.12.0.6
	OPENBSD_4_4_BASE:1.12
	OPENBSD_4_3:1.12.0.4
	OPENBSD_4_3_BASE:1.12
	OPENBSD_4_2:1.12.0.2
	OPENBSD_4_2_BASE:1.12
	OPENBSD_4_1:1.11.0.12
	OPENBSD_4_1_BASE:1.11
	OPENBSD_4_0:1.11.0.10
	OPENBSD_4_0_BASE:1.11
	OPENBSD_3_9:1.11.0.8
	OPENBSD_3_9_BASE:1.11
	OPENBSD_3_8:1.11.0.6
	OPENBSD_3_8_BASE:1.11
	OPENBSD_3_7:1.11.0.4
	OPENBSD_3_7_BASE:1.11
	OPENBSD_3_6:1.11.0.2
	OPENBSD_3_6_BASE:1.11
	SMP_SYNC_A:1.9
	SMP_SYNC_B:1.9
	OPENBSD_3_5:1.8.0.4
	OPENBSD_3_5_BASE:1.8
	OPENBSD_3_4:1.8.0.2
	OPENBSD_3_4_BASE:1.8
	UBC_SYNC_A:1.7
	OPENBSD_3_3:1.7.0.16
	OPENBSD_3_3_BASE:1.7
	OPENBSD_3_2:1.7.0.14
	OPENBSD_3_2_BASE:1.7
	OPENBSD_3_1:1.7.0.12
	OPENBSD_3_1_BASE:1.7
	UBC_SYNC_B:1.7
	UBC:1.7.0.10
	UBC_BASE:1.7
	OPENBSD_3_0:1.7.0.8
	OPENBSD_3_0_BASE:1.7
	OPENBSD_2_9_BASE:1.7
	OPENBSD_2_9:1.7.0.6
	OPENBSD_2_8:1.7.0.4
	OPENBSD_2_8_BASE:1.7
	OPENBSD_2_7:1.7.0.2
	OPENBSD_2_7_BASE:1.7
	SMP:1.5.0.16
	SMP_BASE:1.5
	kame_19991208:1.5
	OPENBSD_2_6:1.5.0.14
	OPENBSD_2_6_BASE:1.5
	OPENBSD_2_5:1.5.0.12
	OPENBSD_2_5_BASE:1.5
	OPENBSD_2_4:1.5.0.10
	OPENBSD_2_4_BASE:1.5
	OPENBSD_2_3:1.5.0.8
	OPENBSD_2_3_BASE:1.5
	OPENBSD_2_2:1.5.0.6
	OPENBSD_2_2_BASE:1.5
	OPENBSD_2_1:1.5.0.4
	OPENBSD_2_1_BASE:1.5
	OPENBSD_2_0:1.5.0.2
	OPENBSD_2_0_BASE:1.5
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@ * @;


1.17
date	2015.07.20.23.47.20;	author uebayasi;	state Exp;
branches;
next	1.16;
commitid	CJFzTqJwP65tMk7k;

1.16
date	2014.01.30.21.01.59;	author kettenis;	state Exp;
branches;
next	1.15;

1.15
date	2013.10.06.01.27.49;	author guenther;	state Exp;
branches;
next	1.14;

1.14
date	2013.06.03.16.55.22;	author guenther;	state Exp;
branches;
next	1.13;

1.13
date	2012.11.05.19.39.35;	author miod;	state Exp;
branches;
next	1.12;

1.12
date	2007.05.16.17.27.30;	author art;	state Exp;
branches;
next	1.11;

1.11
date	2004.07.28.17.15.12;	author tholo;	state Exp;
branches;
next	1.10;

1.10
date	2004.06.13.21.49.28;	author niklas;	state Exp;
branches;
next	1.9;

1.9
date	2004.06.09.20.18.28;	author art;	state Exp;
branches;
next	1.8;

1.8
date	2003.06.02.23.28.21;	author millert;	state Exp;
branches;
next	1.7;

1.7
date	2000.04.19.12.30.30;	author art;	state Exp;
branches;
next	1.6;

1.6
date	2000.03.03.16.49.24;	author art;	state Exp;
branches;
next	1.5;

1.5
date	96.08.11.20.39.07;	author niklas;	state Exp;
branches
	1.5.16.1;
next	1.4;

1.4
date	96.04.17.04.58.36;	author mickey;	state Exp;
branches;
next	1.3;

1.3
date	96.03.03.12.11.53;	author niklas;	state Exp;
branches;
next	1.2;

1.2
date	96.01.30.07.27.58;	author tholo;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.53.27;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.53.27;	author deraadt;	state Exp;
branches;
next	;

1.5.16.1
date	2000.03.24.09.09.44;	author niklas;	state Exp;
branches;
next	1.5.16.2;

1.5.16.2
date	2001.05.14.22.45.02;	author niklas;	state Exp;
branches;
next	1.5.16.3;

1.5.16.3
date	2003.06.07.11.09.07;	author ho;	state Exp;
branches;
next	1.5.16.4;

1.5.16.4
date	2004.06.05.17.19.55;	author niklas;	state Exp;
branches;
next	1.5.16.5;

1.5.16.5
date	2004.06.10.11.40.35;	author niklas;	state Exp;
branches;
next	;


desc
@@


1.17
log
@Move `ticks' declaration to sys/kernel.h.
@
text
@/*	$OpenBSD$	*/
/*	$NetBSD: kernel.h,v 1.11 1995/03/03 01:24:16 cgd Exp $	*/

/*-
 * Copyright (c) 1990, 1993
 *	The Regents of the University of California.  All rights reserved.
 * (c) UNIX System Laboratories, Inc.
 * All or some portions of this file are derived from material licensed
 * to the University of California by American Telephone and Telegraph
 * Co. or Unix System Laboratories, Inc. and are reproduced herein with
 * the permission of UNIX System Laboratories, Inc.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. Neither the name of the University nor the names of its contributors
 *    may be used to endorse or promote products derived from this software
 *    without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 *
 *	@@(#)kernel.h	8.3 (Berkeley) 1/21/94
 */

/* Global variables for the kernel. */

/* 1.1 */
extern long hostid;
extern char hostname[MAXHOSTNAMELEN];
extern int hostnamelen;
extern char domainname[MAXHOSTNAMELEN];
extern int domainnamelen;

/* 1.2 */
extern struct timespec boottime;
extern struct timezone tz;			/* XXX */

extern int tick;		/* usec per tick (1000000 / hz) */
extern int tickfix;		/* periodic tick adj. tick not integral */
extern int tickfixinterval;	/* interval at which to apply adjustment */
extern int tickadj;		/* "standard" clock skew, us./tick */
extern int ticks;		/* # of hardclock ticks */
extern int hz;			/* system clock's frequency */
extern int stathz;		/* statistics clock's frequency */
extern int profhz;		/* profiling clock's frequency */
extern int lbolt;		/* once a second sleep address */
extern int tickdelta;
extern long timedelta;

extern int64_t adjtimedelta;	/* unapplied time correction */
extern struct bintime naptime;	/* time spent suspended */
@


1.16
log
@Simplyfy adjtime(2) by keeping track of the adjustment as a number of
microsecond in a 64-bit integer.  Fixes the issue where ntpd loses sync
because the struct timeval currently used to hold the adjustment is not
properly normalized after the changes guenther@@ made.

ok guenther@@, millert@@
@
text
@d1 1
a1 1
/*	$OpenBSD: kernel.h,v 1.15 2013/10/06 01:27:49 guenther Exp $	*/
d57 1
@


1.15
log
@Add CLOCK_UPTIME, a clock which measures time-running-not-suspended, so
that mlarkin@@ can fix programs that report rates-over-uptime.

ok kettenis@@
manpage corrections jmc@@ (which I've probably broken again)
@
text
@d1 1
a1 1
/*	$OpenBSD: kernel.h,v 1.14 2013/06/03 16:55:22 guenther Exp $	*/
d64 2
a65 2
extern struct timeval adjtimedelta;	/* unapplied time correction */
extern struct bintime naptime;		/* time spent suspended */
@


1.14
log
@Convert some internal APIs to use timespecs instead of timevals

ok matthew@@ deraadt@@
@
text
@d1 1
a1 1
/*	$OpenBSD: kernel.h,v 1.13 2012/11/05 19:39:35 miod Exp $	*/
d64 2
@


1.13
log
@unifdef -D __HAVE_TIMECOUNTER
@
text
@d1 1
a1 1
/*	$OpenBSD: kernel.h,v 1.12 2007/05/16 17:27:30 art Exp $	*/
d50 1
a50 1
extern struct timeval boottime;
@


1.12
log
@The world of __HAVEs and __HAVE_NOTs is reducing. All architectures
have cpu_info now, so kill the option.

eyeballed by jsg@@ and grange@@
@
text
@d1 1
a1 1
/*	$OpenBSD: kernel.h,v 1.11 2004/07/28 17:15:12 tholo Exp $	*/
a50 4
#ifndef __HAVE_TIMECOUNTER
extern volatile struct timeval mono_time;
extern volatile struct timeval time;
#endif
@


1.11
log
@This touches only MI code, and adds new time keeping code.  The
code is all conditionalized on __HAVE_TIMECOUNTER, and not
enabled on any platforms.

adjtime(2) support exists, courtesy of nordin@@, sysctl(2) support
and a concept of quality for each time source attached exists.

High quality time sources exists for PIIX4 ACPI timer as well as
some AMD power management chips.  This will have to be redone
once we actually add ACPI support (at that time we need to use
the ACPI interfaces to get at these clocks).

ok art@@ ken@@ miod@@ jmc@@ and many more
@
text
@d1 1
a1 1
/*	$OpenBSD: kernel.h,v 1.10 2004/06/13 21:49:28 niklas Exp $	*/
a50 3
#ifndef __HAVE_CPUINFO
extern struct timeval runtime;
#endif
@


1.10
log
@debranch SMP, have fun
@
text
@d1 1
a1 1
/*	$OpenBSD$	*/
a49 1
extern volatile struct timeval mono_time;
d54 2
d57 1
@


1.9
log
@Merge in a piece of the SMP branch into HEAD.

Introduce the cpu_info structure, p_cpu field in struct proc and global
scheduling context and various changed code to deal with this. At the
moment no architecture uses this stuff yet, but it will allow us slow and
controlled migration to the new APIs.

All new code is ifdef:ed out.

ok deraadt@@ niklas@@
@
text
@d1 1
a1 1
/*	$OpenBSD: kernel.h,v 1.8 2003/06/02 23:28:21 millert Exp $	*/
d52 1
a52 1
#ifndef __HAVE_CURCPU
@


1.8
log
@Remove the advertising clause in the UCB license which Berkeley
rescinded 22 July 1999.  Proofed by myself and Theo.
@
text
@d1 1
a1 1
/*	$OpenBSD: kernel.h,v 1.7 2000/04/19 12:30:30 art Exp $	*/
d52 1
d54 1
@


1.7
log
@Remove roundrobin_attempts.
@
text
@d1 1
a1 1
/*	$OpenBSD: kernel.h,v 1.6 2000/03/03 16:49:24 art Exp $	*/
d21 1
a21 5
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 *	This product includes software developed by the University of
 *	California, Berkeley and its contributors.
 * 4. Neither the name of the University nor the names of its contributors
@


1.6
log
@Keep track of the number of times we trigger a reschedule before the
context switch actually happens.
@
text
@d1 1
a1 1
/*	$OpenBSD: kernel.h,v 1.5 1996/08/11 20:39:07 niklas Exp $	*/
a69 1
extern int roundrobin_attempts;	/* number switch attempts before switch */
@


1.5
log
@Move MD5 protos to a more sensible place
@
text
@d1 1
a1 1
/*	$OpenBSD: kernel.h,v 1.4 1996/04/17 04:58:36 mickey Exp $	*/
d70 1
a70 1

@


1.5.16.1
log
@Sync with -current
@
text
@d1 1
a1 1
/*	$OpenBSD$	*/
d70 1
a70 1
extern int roundrobin_attempts;	/* number switch attempts before switch */
@


1.5.16.2
log
@merge in approximately 2.9 into SMP branch
@
text
@d1 1
a1 1
/*	$OpenBSD: kernel.h,v 1.7 2000/04/19 12:30:30 art Exp $	*/
d70 1
@


1.5.16.3
log
@Sync SMP branch to -current
@
text
@d1 1
a1 1
/*	$OpenBSD: kernel.h,v 1.5.16.2 2001/05/14 22:45:02 niklas Exp $	*/
d21 5
a25 1
 * 3. Neither the name of the University nor the names of its contributors
@


1.5.16.4
log
@Make a few scheduling globals per-cpu, mostly NetBSD code
@
text
@d1 1
a1 1
/*	$OpenBSD: kernel.h,v 1.5.16.3 2003/06/07 11:09:07 ho Exp $	*/
a51 1
#ifndef MULTIPROCESSOR
a52 1
#endif
@


1.5.16.5
log
@sync with head, make i386 __HAVE_CPUINFO
@
text
@d1 1
a1 1
/*	$OpenBSD$	*/
d52 1
a52 1
#ifndef __HAVE_CPUINFO
@


1.4
log
@Add prototypes for MD5 routines.
@
text
@d1 1
a1 1
/*	$OpenBSD: kernel.h,v 1.3 1996/03/03 12:11:53 niklas Exp $	*/
a69 3

void	MD5Init __P((u_int32_t[4]));
void	MD5Transform __P((u_int32_t[4], u_int32_t const [16]));
@


1.3
log
@From NetBSD: 960217 merge
@
text
@d1 1
a1 1
/*	$OpenBSD$	*/
d70 5
@


1.2
log
@Add extern declarations of new globals used by kernel PLL clock
@
text
@d1 1
@


1.1
log
@Initial revision
@
text
@d67 2
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
