head	1.9;
access;
symbols
	OPENBSD_6_2:1.9.0.40
	OPENBSD_6_2_BASE:1.9
	OPENBSD_6_1:1.9.0.42
	OPENBSD_6_1_BASE:1.9
	OPENBSD_6_0:1.9.0.38
	OPENBSD_6_0_BASE:1.9
	OPENBSD_5_9:1.9.0.34
	OPENBSD_5_9_BASE:1.9
	OPENBSD_5_8:1.9.0.36
	OPENBSD_5_8_BASE:1.9
	OPENBSD_5_7:1.9.0.28
	OPENBSD_5_7_BASE:1.9
	OPENBSD_5_6:1.9.0.32
	OPENBSD_5_6_BASE:1.9
	OPENBSD_5_5:1.9.0.30
	OPENBSD_5_5_BASE:1.9
	OPENBSD_5_4:1.9.0.26
	OPENBSD_5_4_BASE:1.9
	OPENBSD_5_3:1.9.0.24
	OPENBSD_5_3_BASE:1.9
	OPENBSD_5_2:1.9.0.22
	OPENBSD_5_2_BASE:1.9
	OPENBSD_5_1_BASE:1.9
	OPENBSD_5_1:1.9.0.20
	OPENBSD_5_0:1.9.0.18
	OPENBSD_5_0_BASE:1.9
	OPENBSD_4_9:1.9.0.16
	OPENBSD_4_9_BASE:1.9
	OPENBSD_4_8:1.9.0.14
	OPENBSD_4_8_BASE:1.9
	OPENBSD_4_7:1.9.0.10
	OPENBSD_4_7_BASE:1.9
	OPENBSD_4_6:1.9.0.12
	OPENBSD_4_6_BASE:1.9
	OPENBSD_4_5:1.9.0.8
	OPENBSD_4_5_BASE:1.9
	OPENBSD_4_4:1.9.0.6
	OPENBSD_4_4_BASE:1.9
	OPENBSD_4_3:1.9.0.4
	OPENBSD_4_3_BASE:1.9
	OPENBSD_4_2:1.9.0.2
	OPENBSD_4_2_BASE:1.9
	OPENBSD_4_1:1.8.0.2
	OPENBSD_4_1_BASE:1.8
	OPENBSD_4_0:1.7.0.2
	OPENBSD_4_0_BASE:1.7
	OPENBSD_3_9:1.6.0.12
	OPENBSD_3_9_BASE:1.6
	OPENBSD_3_8:1.6.0.10
	OPENBSD_3_8_BASE:1.6
	OPENBSD_3_7:1.6.0.8
	OPENBSD_3_7_BASE:1.6
	OPENBSD_3_6:1.6.0.6
	OPENBSD_3_6_BASE:1.6
	SMP_SYNC_A:1.6
	SMP_SYNC_B:1.6
	OPENBSD_3_5:1.6.0.4
	OPENBSD_3_5_BASE:1.6
	OPENBSD_3_4:1.6.0.2
	OPENBSD_3_4_BASE:1.6
	UBC_SYNC_A:1.5
	OPENBSD_3_3:1.5.0.24
	OPENBSD_3_3_BASE:1.5
	OPENBSD_3_2:1.5.0.22
	OPENBSD_3_2_BASE:1.5
	OPENBSD_3_1:1.5.0.20
	OPENBSD_3_1_BASE:1.5
	UBC_SYNC_B:1.5
	UBC:1.5.0.18
	UBC_BASE:1.5
	OPENBSD_3_0:1.5.0.16
	OPENBSD_3_0_BASE:1.5
	OPENBSD_2_9_BASE:1.5
	OPENBSD_2_9:1.5.0.14
	OPENBSD_2_8:1.5.0.12
	OPENBSD_2_8_BASE:1.5
	OPENBSD_2_7:1.5.0.10
	OPENBSD_2_7_BASE:1.5
	SMP:1.5.0.8
	SMP_BASE:1.5
	kame_19991208:1.5
	OPENBSD_2_6:1.5.0.6
	OPENBSD_2_6_BASE:1.5
	OPENBSD_2_5:1.5.0.4
	OPENBSD_2_5_BASE:1.5
	OPENBSD_2_4:1.5.0.2
	OPENBSD_2_4_BASE:1.5
	OPENBSD_2_3:1.4.0.6
	OPENBSD_2_3_BASE:1.4
	OPENBSD_2_2:1.4.0.4
	OPENBSD_2_2_BASE:1.4
	OPENBSD_2_1:1.4.0.2
	OPENBSD_2_1_BASE:1.4
	OPENBSD_2_0:1.3.0.2
	OPENBSD_2_0_BASE:1.3
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@ * @;


1.9
date	2007.06.01.18.44.48;	author krw;	state Exp;
branches;
next	1.8;

1.8
date	2007.01.05.00.42.47;	author krw;	state Exp;
branches;
next	1.7;

1.7
date	2006.06.01.05.42.01;	author krw;	state Exp;
branches;
next	1.6;

1.6
date	2003.06.02.23.28.21;	author millert;	state Exp;
branches;
next	1.5;

1.5
date	98.07.23.08.46.34;	author deraadt;	state Exp;
branches
	1.5.8.1;
next	1.4;

1.4
date	97.04.16.04.19.09;	author millert;	state Exp;
branches;
next	1.3;

1.3
date	96.04.17.17.05.49;	author dm;	state Exp;
branches;
next	1.2;

1.2
date	96.03.03.12.12.04;	author niklas;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.53.28;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.53.28;	author deraadt;	state Exp;
branches;
next	;

1.5.8.1
date	2003.06.07.11.09.07;	author ho;	state Exp;
branches;
next	;


desc
@@


1.9
log
@No need for tape fields to be daddr_t. int will do.

ok beck@@ deraadt@@
@
text
@/*	$OpenBSD: mtio.h,v 1.8 2007/01/05 00:42:47 krw Exp $	*/
/*	$NetBSD: mtio.h,v 1.14 1997/04/15 06:50:19 lukem Exp $	*/

/*
 * Copyright (c) 1982, 1986, 1993
 *	The Regents of the University of California.  All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. Neither the name of the University nor the names of its contributors
 *    may be used to endorse or promote products derived from this software
 *    without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 *
 *	@@(#)mtio.h	8.1 (Berkeley) 6/2/93
 */

#ifndef _SYS_MTIO_H_
#define _SYS_MTIO_H_

/*
 * Structures and definitions for mag tape io control commands
 */

/* structure for MTIOCTOP - mag tape op command */
struct mtop {
	short	mt_op;		/* operations defined below */
	int	mt_count;	/* how many of them */
};

/* operations */
#define MTWEOF		0	/* write an end-of-file record */
#define MTFSF		1	/* forward space file */
#define MTBSF		2	/* backward space file */
#define MTFSR		3	/* forward space record */
#define MTBSR		4	/* backward space record */
#define MTREW		5	/* rewind */
#define MTOFFL		6	/* rewind and put the drive offline */
#define MTNOP		7	/* no operation, sets status only */
#define MTRETEN		8	/* retension */
#define MTERASE		9	/* erase entire tape */
#define MTEOM		10	/* forward to end of media */
#define MTNBSF		11	/* backward space to beginning of file */
#define MTCACHE		12	/* enable controller cache */
#define MTNOCACHE	13	/* disable controller cache */
#define MTSETBSIZ	14	/* set block size; 0 for variable */
#define MTSETDNSTY	15	/* set density code for current mode */

/* structure for MTIOCGET - mag tape get status command */

struct mtget {
	short	mt_type;	/* type of magtape device */
/* the following two registers are grossly device dependent */
	short	mt_dsreg;	/* ``drive status'' register */
	short	mt_erreg;	/* ``error'' register */
/* end device-dependent registers */
	short	mt_resid;	/* residual count */
	int	mt_fileno;	/* current file number relative to BOT. */ 
	int	mt_blkno;	/* current block number relative to BOF. */
	int	mt_blksiz;	/* current block size */
	int	mt_density;	/* current density code */
	int	mt_mblksiz;	/* default block size */
	int	mt_mdensity;	/* default density code */
};

/*
 * Constants for mt_type byte.  These are the same
 * for controllers compatible with the types listed.
 */
#define	MT_ISTS		0x01		/* TS-11 */
#define	MT_ISHT		0x02		/* TM03 Massbus: TE16, TU45, TU77 */
#define	MT_ISTM		0x03		/* TM11/TE10 Unibus */
#define	MT_ISMT		0x04		/* TM78/TU78 Massbus */
#define	MT_ISUT		0x05		/* SI TU-45 emulation on Unibus */
#define	MT_ISCPC	0x06		/* SUN */
#define	MT_ISAR		0x07		/* SUN */
#define	MT_ISTMSCP	0x08		/* DEC TMSCP protocol (TU81, TK50) */
#define MT_ISCY		0x09		/* CCI Cipher */
#define MT_ISCT		0x0a		/* HP 1/4 tape */
#define MT_ISFHP	0x0b		/* HP 7980 1/2 tape */
#define MT_ISEXABYTE	0x0c		/* Exabyte */
#define MT_ISEXA8200	0x0c		/* Exabyte EXB-8200 */
#define MT_ISEXA8500	0x0d		/* Exabyte EXB-8500 */
#define MT_ISVIPER1	0x0e		/* Archive Viper-150 */
#define MT_ISPYTHON	0x0f		/* Archive Python (DAT) */
#define MT_ISHPDAT	0x10		/* HP 35450A DAT drive */
#define MT_ISWANGTEK	0x11		/* WANGTEK 5150ES */
#define MT_ISCALIPER	0x12		/* Caliper CP150 */
#define MT_ISWTEK5099	0x13		/* WANGTEK 5099ES */
#define MT_ISVIPER2525	0x14		/* Archive Viper 2525 */
#define MT_ISMFOUR	0x11		/* M4 Data 1/2 9track drive */
#define MT_ISTK50	0x12		/* DEC SCSI TK50 */
#define MT_ISMT02	0x13		/* Emulex MT02 SCSI tape controller */

/* bits defined for the mt_dsreg field */
#define MT_DS_RDONLY	0x10		/* tape mounted readonly */
#define MT_DS_MOUNTED	0x03		/* tape mounted (for control opens) */

/* mag tape io control commands */
#define	MTIOCTOP	_IOW('m', 1, struct mtop)	/* do a mag tape op */
#define	MTIOCGET	_IOR('m', 2, struct mtget)	/* get tape status */
#define MTIOCIEOT	_IO('m', 3)			/* ignore EOT error */
#define MTIOCEEOT	_IO('m', 4)			/* enable EOT error */

/*
 * When more SCSI-3 SSC (streaming device) devices are out there
 * that support the full 32 byte type 2 structure, we'll have to
 * rethink these ioctls to support all the entities they haul into
 * the picture (64 bit blocks, logical file record numbers, etc..).
 */
#define MTIOCRDSPOS	_IOR('m', 5, u_int32_t)	/* get logical blk addr */
#define MTIOCRDHPOS	_IOR('m', 6, u_int32_t)	/* get hardware blk addr */
#define MTIOCSLOCATE	_IOW('m', 5, u_int32_t)	/* seek to logical blk addr */
#define MTIOCHLOCATE	_IOW('m', 6, u_int32_t)	/* seek to hardware blk addr */

#ifdef	_KERNEL
/*
 * minor device number
 */

#define	T_UNIT		003		/* unit selection */
#define	T_NOREWIND	004		/* no rewind on close */
#define	T_DENSEL	030		/* density select */
#define	T_800BPI	000		/* select  800 bpi */
#define	T_1600BPI	010		/* select 1600 bpi */
#define	T_6250BPI	020		/* select 6250 bpi */
#define	T_BADBPI	030		/* undefined selection */
#endif /* _KERNEL */

#endif /* !_SYS_MTIO_H_ */
@


1.8
log
@As first brought to my attention by Russel Sutherland, our deletion of
the mt_fileno and mt_blkno fields from the mtget struct was too hasty.

Subsequent discussions with Kern Sibbold of the Bacula project
revealed these are widely used by tape backup software on many
unicies. The de facto standard is to return -1 if you can't determine
the value.

So add them back and always return -1 as their value. Should allow
Bacula and similar software to at least compile while we investigate
providing meaningful values.

ok beck@@
@
text
@d1 1
a1 1
/*	$OpenBSD: mtio.h,v 1.7 2006/06/01 05:42:01 krw Exp $	*/
d45 1
a45 1
	daddr_t	mt_count;	/* how many of them */
d75 6
a80 6
	daddr_t mt_fileno;	/* current file number relative to BOT. */ 
	daddr_t mt_blkno;	/* current block number relative to BOF. */
	daddr_t	mt_blksiz;	/* current block size */
	daddr_t	mt_density;	/* current density code */
	daddr_t	mt_mblksiz;	/* default block size */
	daddr_t mt_mdensity;	/* default density code */
@


1.7
log
@We do not create st devices with different density modes. i.e. with device
minor numbers having bits 2 or 3 set.

Eliminate the quirks, etc. used to store info on these non-existant modes.
Also eliminate a couple of 'unimplemented' fields in the ioctl request
structure.

ok beck@@ deraadt@@
@
text
@d1 1
a1 1
/*	$OpenBSD: mtio.h,v 1.6 2003/06/02 23:28:21 millert Exp $	*/
d75 2
@


1.6
log
@Remove the advertising clause in the UCB license which Berkeley
rescinded 22 July 1999.  Proofed by myself and Theo.
@
text
@d1 1
a1 1
/*	$OpenBSD: mtio.h,v 1.5 1998/07/23 08:46:34 deraadt Exp $	*/
a74 4
/* the following two are not yet implemented */
	daddr_t	mt_fileno;	/* file number of current position */
	daddr_t	mt_blkno;	/* block number of current position */
/* end not yet implemented */
d77 2
a78 2
	daddr_t	mt_mblksiz[4];	/* block size for different modes */
	daddr_t mt_mdensity[4];	/* density codes for different modes */
@


1.5
log
@add new non-functional ioctl values from netbsd
@
text
@d1 1
a1 1
/*	$OpenBSD: mtio.h,v 1.4 1997/04/16 04:19:09 millert Exp $	*/
d16 1
a16 5
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 *	This product includes software developed by the University of
 *	California, Berkeley and its contributors.
 * 4. Neither the name of the University nor the names of its contributors
@


1.5.8.1
log
@Sync SMP branch to -current
@
text
@d1 1
a1 1
/*	$OpenBSD: mtio.h,v 1.5 1998/07/23 08:46:34 deraadt Exp $	*/
d16 5
a20 1
 * 3. Neither the name of the University nor the names of its contributors
@


1.4
log
@Use _PATH_DEFTAPE not DEFTAPE in mt(1)
Remove DEFTAPE from <sys/mtio.h> and guard against multiple inclusion.
@
text
@d1 1
a1 1
/*	$OpenBSD: mtio.h,v 1.3 1996/04/17 17:05:49 dm Exp $	*/
d118 4
d127 11
@


1.3
log
@Changed DEFTAPE from rst0 to nrst0.  It is only used by mt, and running
mt on /dev/rst0 can be dangerous because you think it's repositioning the
tape when in fact it rewinds right after positioning.
@
text
@d1 2
a2 2
/*	$OpenBSD: mtio.h,v 1.2 1996/03/03 12:12:04 niklas Exp $	*/
/*	$NetBSD: mtio.h,v 1.12 1995/03/29 22:10:07 briggs Exp $	*/
d39 3
a123 4
#ifndef _KERNEL
#define	DEFTAPE	"/dev/nrst0"
#endif

d136 3
a138 1
#endif
@


1.2
log
@From NetBSD: 960217 merge
@
text
@d1 1
a1 1
/*	$OpenBSD$	*/
d122 1
a122 1
#define	DEFTAPE	"/dev/rst0"
@


1.1
log
@Initial revision
@
text
@d1 1
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
