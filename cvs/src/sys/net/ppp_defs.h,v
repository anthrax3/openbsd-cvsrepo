head	1.13;
access;
symbols
	OPENBSD_6_1_BASE:1.13
	OPENBSD_6_0:1.13.0.60
	OPENBSD_6_0_BASE:1.13
	OPENBSD_5_9:1.13.0.54
	OPENBSD_5_9_BASE:1.13
	OPENBSD_5_8:1.13.0.56
	OPENBSD_5_8_BASE:1.13
	OPENBSD_5_7:1.13.0.48
	OPENBSD_5_7_BASE:1.13
	OPENBSD_5_6:1.13.0.52
	OPENBSD_5_6_BASE:1.13
	OPENBSD_5_5:1.13.0.50
	OPENBSD_5_5_BASE:1.13
	OPENBSD_5_4:1.13.0.46
	OPENBSD_5_4_BASE:1.13
	OPENBSD_5_3:1.13.0.44
	OPENBSD_5_3_BASE:1.13
	OPENBSD_5_2:1.13.0.42
	OPENBSD_5_2_BASE:1.13
	OPENBSD_5_1_BASE:1.13
	OPENBSD_5_1:1.13.0.40
	OPENBSD_5_0:1.13.0.38
	OPENBSD_5_0_BASE:1.13
	OPENBSD_4_9:1.13.0.36
	OPENBSD_4_9_BASE:1.13
	OPENBSD_4_8:1.13.0.34
	OPENBSD_4_8_BASE:1.13
	OPENBSD_4_7:1.13.0.30
	OPENBSD_4_7_BASE:1.13
	OPENBSD_4_6:1.13.0.32
	OPENBSD_4_6_BASE:1.13
	OPENBSD_4_5:1.13.0.28
	OPENBSD_4_5_BASE:1.13
	OPENBSD_4_4:1.13.0.26
	OPENBSD_4_4_BASE:1.13
	OPENBSD_4_3:1.13.0.24
	OPENBSD_4_3_BASE:1.13
	OPENBSD_4_2:1.13.0.22
	OPENBSD_4_2_BASE:1.13
	OPENBSD_4_1:1.13.0.20
	OPENBSD_4_1_BASE:1.13
	OPENBSD_4_0:1.13.0.18
	OPENBSD_4_0_BASE:1.13
	OPENBSD_3_9:1.13.0.16
	OPENBSD_3_9_BASE:1.13
	OPENBSD_3_8:1.13.0.14
	OPENBSD_3_8_BASE:1.13
	OPENBSD_3_7:1.13.0.12
	OPENBSD_3_7_BASE:1.13
	OPENBSD_3_6:1.13.0.10
	OPENBSD_3_6_BASE:1.13
	SMP_SYNC_A:1.13
	SMP_SYNC_B:1.13
	OPENBSD_3_5:1.13.0.8
	OPENBSD_3_5_BASE:1.13
	OPENBSD_3_4:1.13.0.6
	OPENBSD_3_4_BASE:1.13
	UBC_SYNC_A:1.13
	OPENBSD_3_3:1.13.0.4
	OPENBSD_3_3_BASE:1.13
	OPENBSD_3_2:1.13.0.2
	OPENBSD_3_2_BASE:1.13
	OPENBSD_3_1:1.12.0.2
	OPENBSD_3_1_BASE:1.12
	UBC_SYNC_B:1.13
	UBC:1.11.0.4
	UBC_BASE:1.11
	OPENBSD_3_0:1.11.0.2
	OPENBSD_3_0_BASE:1.11
	OPENBSD_2_9_BASE:1.10
	OPENBSD_2_9:1.10.0.8
	OPENBSD_2_8:1.10.0.6
	OPENBSD_2_8_BASE:1.10
	OPENBSD_2_7:1.10.0.4
	OPENBSD_2_7_BASE:1.10
	SMP:1.10.0.2
	SMP_BASE:1.10
	kame_19991208:1.10
	OPENBSD_2_6:1.9.0.4
	OPENBSD_2_6_BASE:1.9
	OPENBSD_2_5:1.9.0.2
	OPENBSD_2_5_BASE:1.9
	OPENBSD_2_4:1.7.0.2
	OPENBSD_2_4_BASE:1.7
	OPENBSD_2_3:1.4.0.6
	OPENBSD_2_3_BASE:1.4
	OPENBSD_2_2:1.4.0.4
	OPENBSD_2_2_BASE:1.4
	OPENBSD_2_1:1.4.0.2
	OPENBSD_2_1_BASE:1.4
	OPENBSD_2_0:1.2.0.2
	OPENBSD_2_0_BASE:1.2
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@ * @;


1.13
date	2002.09.13.00.12.07;	author deraadt;	state Exp;
branches;
next	1.12;

1.12
date	2002.03.14.03.16.10;	author millert;	state Exp;
branches;
next	1.11;

1.11
date	2001.06.09.06.16.39;	author angelos;	state Exp;
branches
	1.11.4.1;
next	1.10;

1.10
date	99.12.08.06.50.18;	author itojun;	state Exp;
branches
	1.10.2.1;
next	1.9;

1.9
date	99.02.11.19.52.11;	author mickey;	state Exp;
branches;
next	1.8;

1.8
date	99.02.11.19.38.54;	author mickey;	state Exp;
branches;
next	1.7;

1.7
date	98.07.12.04.33.22;	author angelos;	state Exp;
branches;
next	1.6;

1.6
date	98.06.30.21.37.51;	author angelos;	state Exp;
branches;
next	1.5;

1.5
date	98.05.08.05.01.59;	author millert;	state Exp;
branches;
next	1.4;

1.4
date	97.02.24.13.34.04;	author niklas;	state Exp;
branches;
next	1.3;

1.3
date	96.12.19.13.45.17;	author mickey;	state Exp;
branches;
next	1.2;

1.2
date	96.04.28.14.37.09;	author mickey;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.53.07;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.53.07;	author deraadt;	state Exp;
branches;
next	;

1.10.2.1
date	2001.07.04.10.54.17;	author niklas;	state Exp;
branches;
next	1.10.2.2;

1.10.2.2
date	2002.03.28.14.57.37;	author niklas;	state Exp;
branches;
next	1.10.2.3;

1.10.2.3
date	2003.03.28.00.41.29;	author niklas;	state Exp;
branches;
next	;

1.11.4.1
date	2002.06.11.03.30.46;	author art;	state Exp;
branches;
next	1.11.4.2;

1.11.4.2
date	2002.10.29.00.36.46;	author art;	state Exp;
branches;
next	;


desc
@@


1.13
log
@Paul Mackerras and the Australian National University have worked things
out, and as a result, Paul now owns copyright on all these files, with the
proper terms.
@
text
@/*	$OpenBSD: ppp_defs.h,v 1.12 2002/03/14 03:16:10 millert Exp $	*/
/*	$NetBSD: ppp_defs.h,v 1.1 1995/07/04 06:28:26 paulus Exp $	*/

/*
 * ppp_defs.h - PPP definitions.
 *
 * Copyright (c) 1989-2002 Paul Mackerras. All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 *
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 *
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in
 *    the documentation and/or other materials provided with the
 *    distribution.
 *
 * 3. The name(s) of the authors of this software must not be used to
 *    endorse or promote products derived from this software without
 *    prior written permission.
 *
 * 4. Redistributions of any form whatsoever must retain the following
 *    acknowledgment:
 *    "This product includes software developed by Paul Mackerras
 *     <paulus@@samba.org>".
 *
 * THE AUTHORS OF THIS SOFTWARE DISCLAIM ALL WARRANTIES WITH REGARD TO
 * THIS SOFTWARE, INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
 * AND FITNESS, IN NO EVENT SHALL THE AUTHORS BE LIABLE FOR ANY
 * SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN
 * AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING
 * OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 */

#ifndef _PPP_DEFS_H_
#define _PPP_DEFS_H_

/*
 * The basic PPP frame.
 */
#define PPP_HDRLEN	4	/* octets for standard ppp header */
#define PPP_FCSLEN	2	/* octets for FCS */
#define PPP_MRU		1500	/* default MRU = max length of info field */

#define PPP_ADDRESS(p)	(((u_char *)(p))[0])
#define PPP_CONTROL(p)	(((u_char *)(p))[1])
#define PPP_PROTOCOL(p)	((((u_char *)(p))[2] << 8) + ((u_char *)(p))[3])

/*
 * Significant octet values.
 */
#define PPP_ALLSTATIONS	0xff	/* All-Stations broadcast address */
#define PPP_UI		0x03	/* Unnumbered Information */
#define PPP_FLAG	0x7e	/* Flag Sequence */
#define PPP_ESCAPE	0x7d	/* Asynchronous Control Escape */
#define PPP_TRANS	0x20	/* Asynchronous transparency modifier */

/*
 * Protocol field values.
 */
#define PPP_IP		0x21	/* Internet Protocol */
#define PPP_XNS		0x25	/* Xerox NS */
#define PPP_AT		0x29	/* AppleTalk Protocol */
#define PPP_IPX		0x2b	/* Internetwork Packet Exchange */
#define PPP_VJC_COMP	0x2d	/* VJ compressed TCP */
#define PPP_VJC_UNCOMP	0x2f	/* VJ uncompressed TCP */
#define PPP_IPV6	0x57	/* Internet Protocol Version 6 */
#define PPP_COMP	0xfd	/* compressed packet */
#define PPP_IPCP	0x8021	/* IP Control Protocol */
#define PPP_ATCP	0x8029	/* AppleTalk Control Protocol */
#define PPP_IPXCP	0x802b	/* IPX Control Protocol */
#define PPP_IPV6CP	0x8057	/* IPv6 Control Protocol */
#define PPP_CCP		0x80fd	/* Compression Control Protocol */
#define PPP_LCP		0xc021	/* Link Control Protocol */
#define PPP_PAP		0xc023	/* Password Authentication Protocol */
#define PPP_LQR		0xc025	/* Link Quality Report protocol */
#define PPP_CHAP	0xc223	/* Cryptographic Handshake Auth. Protocol */
#define PPP_CBCP	0xc029	/* Callback Control Protocol */

/*
 * Values for FCS calculations.
 */
#define PPP_INITFCS	0xffff	/* Initial FCS value */
#define PPP_GOODFCS	0xf0b8	/* Good final FCS value */
#define PPP_FCS(fcs, c)	(((fcs) >> 8) ^ fcstab[((fcs) ^ (c)) & 0xff])

/*
 * A 32-bit unsigned integral type.
 */
#ifndef __BIT_TYPES_DEFINED__
#ifdef	UINT32_T
typedef UINT32_T	u_int32_t;
#else
typedef unsigned int	u_int32_t;
typedef unsigned short	u_int16_t;
#endif
#endif

/*
 * Extended asyncmap - allows any character to be escaped.
 */
typedef u_int32_t	ext_accm[8];

/*
 * What to do with network protocol (NP) packets.
 */
enum NPmode {
    NPMODE_PASS,		/* pass the packet through */
    NPMODE_DROP,		/* silently drop the packet */
    NPMODE_ERROR,		/* return an error */
    NPMODE_QUEUE		/* save it up for later. */
};

/*
 * Statistics.
 */
struct pppstat	{
    u_int	ppp_ibytes;	/* bytes received */
    u_int	ppp_ipackets;	/* packets received */
    u_int	ppp_ierrors;	/* receive errors */
    u_int	ppp_obytes;	/* bytes sent */
    u_int	ppp_opackets;	/* packets sent */
    u_int	ppp_oerrors;	/* transmit errors */
};

struct vjstat {
    u_int	vjs_packets;	/* outbound packets */
    u_int	vjs_compressed;	/* outbound compressed packets */
    u_int	vjs_searches;	/* searches for connection state */
    u_int	vjs_misses;	/* times couldn't find conn. state */
    u_int	vjs_uncompressedin; /* inbound uncompressed packets */
    u_int	vjs_compressedin;   /* inbound compressed packets */
    u_int	vjs_errorin;	/* inbound unknown type packets */
    u_int	vjs_tossed;	/* inbound packets tossed because of error */
};

struct ppp_stats {
    struct pppstat	p;	/* basic PPP statistics */
    struct vjstat	vj;	/* VJ header compression statistics */
};

struct compstat {
    u_int	unc_bytes;	/* total uncompressed bytes */
    u_int	unc_packets;	/* total uncompressed packets */
    u_int	comp_bytes;	/* compressed bytes */
    u_int	comp_packets;	/* compressed packets */
    u_int	inc_bytes;	/* incompressible bytes */
    u_int	inc_packets;	/* incompressible packets */
    u_int	ratio;		/* recent compression ratio << 8 */
};

struct ppp_comp_stats {
    struct compstat	c;	/* packet compression statistics */
    struct compstat	d;	/* packet decompression statistics */
};

/*
 * The following structure records the time in seconds since
 * the last NP packet was sent or received.
 */
struct ppp_idle {
    time_t xmit_idle;		/* time since last NP packet sent */
    time_t recv_idle;		/* time since last NP packet received */
};

#endif /* _PPP_DEFS_H_ */
@


1.12
log
@Final __P removal plus some cosmetic fixups
@
text
@d1 1
a1 1
/*	$OpenBSD: ppp_defs.h,v 1.11 2001/06/09 06:16:39 angelos Exp $	*/
d7 1
a7 2
 * Copyright (c) 1994 The Australian National University.
 * All rights reserved.
d9 28
a36 19
 * Permission to use, copy, modify, and distribute this software and its
 * documentation is hereby granted, provided that the above copyright
 * notice appears in all copies.  This software is provided without any
 * warranty, express or implied. The Australian National University
 * makes no representations about the suitability of this software for
 * any purpose.
 *
 * IN NO EVENT SHALL THE AUSTRALIAN NATIONAL UNIVERSITY BE LIABLE TO ANY
 * PARTY FOR DIRECT, INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES
 * ARISING OUT OF THE USE OF THIS SOFTWARE AND ITS DOCUMENTATION, EVEN IF
 * THE AUSTRALIAN NATIONAL UNIVERSITY HAVE BEEN ADVISED OF THE POSSIBILITY
 * OF SUCH DAMAGE.
 *
 * THE AUSTRALIAN NATIONAL UNIVERSITY SPECIFICALLY DISCLAIMS ANY WARRANTIES,
 * INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY
 * AND FITNESS FOR A PARTICULAR PURPOSE.  THE SOFTWARE PROVIDED HEREUNDER IS
 * ON AN "AS IS" BASIS, AND THE AUSTRALIAN NATIONAL UNIVERSITY HAS NO
 * OBLIGATION TO PROVIDE MAINTENANCE, SUPPORT, UPDATES, ENHANCEMENTS,
 * OR MODIFICATIONS.
@


1.11
log
@By popular demand, protect from multiple inclusion, and fix to use the
same naming style.
@
text
@d1 1
a1 1
/*	$OpenBSD: ppp_defs.h,v 1.10 1999/12/08 06:50:18 itojun Exp $	*/
a161 7
#ifndef __P
#ifdef __STDC__
#define __P(x)	x
#else
#define __P(x)	()
#endif
#endif
@


1.11.4.1
log
@Sync UBC branch to -current
@
text
@d1 1
a1 1
/*	$OpenBSD: ppp_defs.h,v 1.11 2001/06/09 06:16:39 angelos Exp $	*/
d162 7
@


1.11.4.2
log
@sync to -current
@
text
@d1 1
a1 1
/*	$OpenBSD: ppp_defs.h,v 1.11.4.1 2002/06/11 03:30:46 art Exp $	*/
d7 2
a8 1
 * Copyright (c) 1989-2002 Paul Mackerras. All rights reserved.
d10 19
a28 28
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 *
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 *
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in
 *    the documentation and/or other materials provided with the
 *    distribution.
 *
 * 3. The name(s) of the authors of this software must not be used to
 *    endorse or promote products derived from this software without
 *    prior written permission.
 *
 * 4. Redistributions of any form whatsoever must retain the following
 *    acknowledgment:
 *    "This product includes software developed by Paul Mackerras
 *     <paulus@@samba.org>".
 *
 * THE AUTHORS OF THIS SOFTWARE DISCLAIM ALL WARRANTIES WITH REGARD TO
 * THIS SOFTWARE, INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
 * AND FITNESS, IN NO EVENT SHALL THE AUTHORS BE LIABLE FOR ANY
 * SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN
 * AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING
 * OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
@


1.10
log
@bring in KAME IPv6 code, dated 19991208.
replaces NRL IPv6 layer.  reuses NRL pcb layer.  no IPsec-on-v6 support.
see sys/netinet6/{TODO,IMPLEMENTATION} for more details.

GENERIC configuration should work fine as before.  GENERIC.v6 works fine
as well, but you'll need KAME userland tools to play with IPv6 (will be
bringed into soon).
@
text
@d1 1
a1 1
/*	$OpenBSD: ppp_defs.h,v 1.9 1999/02/11 19:52:11 mickey Exp $	*/
a168 1

@


1.10.2.1
log
@Merge in -current from two days ago in the SMP branch.
As usual with merges, they do not indicate progress, so do not hold
your breath for working SMP, and do not mail me and ask about the
state of it.  It has not changed.  There is work ongoing, but very, very
slowly.  The commit is done in parts as to not lock up the tree in too
big chunks at a time.
@
text
@d1 1
a1 1
/*	$OpenBSD: ppp_defs.h,v 1.10 1999/12/08 06:50:18 itojun Exp $	*/
d169 1
@


1.10.2.2
log
@Merge in -current from roughly a week ago
@
text
@d1 1
a1 1
/*	$OpenBSD$	*/
d162 7
@


1.10.2.3
log
@Sync the SMP branch with 3.3
@
text
@d7 2
a8 1
 * Copyright (c) 1989-2002 Paul Mackerras. All rights reserved.
d10 19
a28 28
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 *
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 *
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in
 *    the documentation and/or other materials provided with the
 *    distribution.
 *
 * 3. The name(s) of the authors of this software must not be used to
 *    endorse or promote products derived from this software without
 *    prior written permission.
 *
 * 4. Redistributions of any form whatsoever must retain the following
 *    acknowledgment:
 *    "This product includes software developed by Paul Mackerras
 *     <paulus@@samba.org>".
 *
 * THE AUTHORS OF THIS SOFTWARE DISCLAIM ALL WARRANTIES WITH REGARD TO
 * THIS SOFTWARE, INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
 * AND FITNESS, IN NO EVENT SHALL THE AUTHORS BE LIABLE FOR ANY
 * SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN
 * AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING
 * OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
@


1.9
log
@fix tabs to spaces between #define and NAME, to match the rest of the file
@
text
@d1 1
a1 1
/*	$OpenBSD: ppp_defs.h,v 1.8 1999/02/11 19:38:54 mickey Exp $	*/
d68 1
@


1.8
log
@oops, PPP_XNS protocol type for NS from freebsd
@
text
@d1 1
a1 1
/*	$OpenBSD: ppp_defs.h,v 1.7 1998/07/12 04:33:22 angelos Exp $	*/
d48 5
a52 5
#define	PPP_ALLSTATIONS	0xff	/* All-Stations broadcast address */
#define	PPP_UI		0x03	/* Unnumbered Information */
#define	PPP_FLAG	0x7e	/* Flag Sequence */
#define	PPP_ESCAPE	0x7d	/* Asynchronous Control Escape */
#define	PPP_TRANS	0x20	/* Asynchronous transparency modifier */
d58 1
a58 1
#define	PPP_XNS		0x25	/* Xerox NS */
d60 3
a62 3
#define	PPP_IPX		0x2b	/* Internetwork Packet Exchange */
#define	PPP_VJC_COMP	0x2d	/* VJ compressed TCP */
#define	PPP_VJC_UNCOMP	0x2f	/* VJ uncompressed TCP */
d67 1
a67 1
#define	PPP_IPXCP	0x802b	/* IPX Control Protocol */
@


1.7
log
@Remove the NPMODE_KEEPLAST defs; they're not really necessary. Also,
sync with NetBSD (the recent splhigh->splimp changes).
@
text
@d1 1
a1 1
/*	$OpenBSD: ppp_defs.h,v 1.6 1998/06/30 21:37:51 angelos Exp $	*/
d58 1
@


1.6
log
@Add an NPMODE_KEEPLAST
@
text
@d1 1
a1 1
/*	$OpenBSD: ppp_defs.h,v 1.5 1998/05/08 05:01:59 millert Exp $	*/
d105 1
a105 2
    NPMODE_QUEUE,		/* save it up for later. */
    NPMODE_KEEPLAST		/* keep the last packet received in the queue */
@


1.5
log
@Add support for RFC-comliant deflate protocol
@
text
@d1 1
a1 1
/*	$OpenBSD: ppp_defs.h,v 1.4 1997/02/24 13:34:04 niklas Exp $	*/
d105 2
a106 1
    NPMODE_QUEUE		/* save it up for later. */
@


1.4
log
@OpenBSD tags + some prototyping police
@
text
@d1 1
a1 1
/*	$OpenBSD: ppp_defs.h,v 1.1 1995/07/04 06:28:26 paulus Exp $	*/
d58 1
d62 1
d65 1
d89 1
@


1.3
log
@sync to 2.3b3
@
text
@d1 1
@


1.2
log
@IPX additions and fixes.
ether -- missed the input for IPX.
fddi -- just added.
ppp -- field codes added.
loop -- minor fix.
@
text
@d68 1
@


1.1
log
@Initial revision
@
text
@d57 1
d62 1
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
