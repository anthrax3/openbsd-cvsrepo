head	1.6;
access;
symbols
	OPENBSD_6_1:1.6.0.2
	OPENBSD_6_1_BASE:1.6
	OPENBSD_6_0:1.5.0.4
	OPENBSD_6_0_BASE:1.5
	OPENBSD_5_9:1.5.0.2
	OPENBSD_5_9_BASE:1.5
	OPENBSD_5_8:1.4.0.8
	OPENBSD_5_8_BASE:1.4
	OPENBSD_5_7:1.4.0.2
	OPENBSD_5_7_BASE:1.4
	OPENBSD_5_6:1.4.0.4
	OPENBSD_5_6_BASE:1.4
	OPENBSD_5_5:1.2.0.6
	OPENBSD_5_5_BASE:1.2
	OPENBSD_5_4:1.2.0.2
	OPENBSD_5_4_BASE:1.2;
locks; strict;
comment	@# @;


1.6
date	2016.11.06.16.42.00;	author tb;	state Exp;
branches;
next	1.5;
commitid	peo8JdlgBE9dXbST;

1.5
date	2015.11.16.19.33.52;	author miod;	state Exp;
branches;
next	1.4;
commitid	5gnqUR6VheSiU9SF;

1.4
date	2014.07.13.09.26.08;	author jasper;	state Exp;
branches;
next	1.3;
commitid	Cnjup0HpCIRrcQ6o;

1.3
date	2014.07.12.21.54.58;	author jasper;	state Exp;
branches;
next	1.2;
commitid	3HeD4LaLGiS22I3y;

1.2
date	2013.06.05.01.32.11;	author jasper;	state Exp;
branches;
next	1.1;

1.1
date	2013.06.05.01.02.29;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.6
log
@Do not create machine@@ symlinks in obj as root during includes:, but
defer their creation to later, so that they are owned by BUILDUSER.
This eliminates the last root-owned files in obj/ from 'make build'.
In addition, place a MACHINE == hppa test in hppa/stand/Makefile.inc
to avoid creating bogus symlinks on all other archs.

joint work with & ok natano, "let's try it" deraadt
@
text
@#	$OpenBSD: Makefile,v 1.5 2015/11/16 19:33:52 miod Exp $

.include "${.CURDIR}/../Makefile.inc"

LIB=	sa

.PATH:	${.CURDIR}/../../../../lib/libsa

CLEANFILES += machine mips64

CFLAGS+= ${CEXTRAFLAGS} ${SAABI} -nostdinc -mno-abicalls -D_NO_ABICALLS \
	-fno-pie \
	-I${.CURDIR} -I${.CURDIR}/../include -I${.CURDIR}/../.. \
	-I${.CURDIR}/../../.. -I${.CURDIR}/../../../.. \
	-I${.CURDIR}/../../../../lib/libsa \
	-I${.OBJDIR}

# stand routines
SRCS=	alloc.c cons.c ctime.c exit.c getchar.c getfile.c getln.c globals.c \
	memcmp.c memcpy.c memset.c printf.c putchar.c \
	snprintf.c strchr.c strcmp.c strerror.c strncmp.c strncpy.c strtol.c

# io routines
SRCS+=	close.c closeall.c dev.c disklabel.c dkcksum.c fstat.c ioctl.c \
	lseek.c open.c read.c readdir.c stat.c write.c

#SRCS+=	cread.c
#CPPFLAGS+= -D__INTERNAL_LIBSA_CREAD

# boot filesystems
SRCS+=	ufs.c cd9660.c

CFLAGS+=-DNO_NET

SRCS+=	loadfile.c

${OBJS}:	${.CURDIR}/../Makefile.inc

NOPROFILE=
NOPIC=

.if !make(clean) && !make(cleandir) && !make(includes) && !make(obj)
.BEGIN:
	@@([ -h machine ] || ln -s ${.CURDIR}/../../include machine)
	@@([ -h mips64 ] || ln -s ${.CURDIR}/../../../mips64/include mips64)
CLEANFILES+=	machine mips64
.endif

install:

.include <bsd.lib.mk>
@


1.5
log
@Replace unbounded gets() in libsa with getln() which takes a buffer size,
and convert all gets() users.
ok deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.4 2014/07/13 09:26:08 jasper Exp $
d42 1
a42 1
.if !make(obj)
@


1.4
log
@move putchar() into libsa

"sure" miod@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.3 2014/07/12 21:54:58 jasper Exp $
d19 1
a19 1
SRCS=	alloc.c cons.c ctime.c exit.c getchar.c getfile.c gets.c globals.c \
@


1.3
log
@move getchar() into libsa where applicable

ok miod@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.2 2013/06/05 01:32:11 jasper Exp $
d20 1
a20 1
	memcmp.c memcpy.c memset.c printf.c \
@


1.2
log
@- add missing SUBDIR
- remove commented and unneeded SRCS
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.1 2013/06/05 01:02:29 jasper Exp $
d19 1
a19 1
SRCS=	alloc.c cons.c ctime.c exit.c getfile.c gets.c globals.c \
@


1.1
log
@add WIP second stage bootloader for octeon; far from working and contains many stubs still.
committing it now so I can work on this in tree.
@
text
@d1 1
a1 1
#	$OpenBSD$
a25 1
#SRCS+=	nullfs.c
@

