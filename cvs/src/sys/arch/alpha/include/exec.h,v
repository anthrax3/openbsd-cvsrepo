head	1.17;
access;
symbols
	OPENBSD_6_2:1.17.0.6
	OPENBSD_6_2_BASE:1.17
	OPENBSD_6_1:1.17.0.4
	OPENBSD_6_1_BASE:1.17
	OPENBSD_6_0:1.16.0.4
	OPENBSD_6_0_BASE:1.16
	OPENBSD_5_9:1.16.0.2
	OPENBSD_5_9_BASE:1.16
	OPENBSD_5_8:1.15.0.4
	OPENBSD_5_8_BASE:1.15
	OPENBSD_5_7:1.14.0.2
	OPENBSD_5_7_BASE:1.14
	OPENBSD_5_6:1.14.0.6
	OPENBSD_5_6_BASE:1.14
	OPENBSD_5_5:1.14.0.4
	OPENBSD_5_5_BASE:1.14
	OPENBSD_5_4:1.13.0.4
	OPENBSD_5_4_BASE:1.13
	OPENBSD_5_3:1.13.0.2
	OPENBSD_5_3_BASE:1.13
	OPENBSD_5_2:1.11.0.6
	OPENBSD_5_2_BASE:1.11
	OPENBSD_5_1_BASE:1.11
	OPENBSD_5_1:1.11.0.4
	OPENBSD_5_0:1.11.0.2
	OPENBSD_5_0_BASE:1.11
	OPENBSD_4_9:1.10.0.4
	OPENBSD_4_9_BASE:1.10
	OPENBSD_4_8:1.10.0.2
	OPENBSD_4_8_BASE:1.10
	OPENBSD_4_7:1.9.0.12
	OPENBSD_4_7_BASE:1.9
	OPENBSD_4_6:1.9.0.14
	OPENBSD_4_6_BASE:1.9
	OPENBSD_4_5:1.9.0.10
	OPENBSD_4_5_BASE:1.9
	OPENBSD_4_4:1.9.0.8
	OPENBSD_4_4_BASE:1.9
	OPENBSD_4_3:1.9.0.6
	OPENBSD_4_3_BASE:1.9
	OPENBSD_4_2:1.9.0.4
	OPENBSD_4_2_BASE:1.9
	OPENBSD_4_1:1.9.0.2
	OPENBSD_4_1_BASE:1.9
	OPENBSD_4_0:1.8.0.10
	OPENBSD_4_0_BASE:1.8
	OPENBSD_3_9:1.8.0.8
	OPENBSD_3_9_BASE:1.8
	OPENBSD_3_8:1.8.0.6
	OPENBSD_3_8_BASE:1.8
	OPENBSD_3_7:1.8.0.4
	OPENBSD_3_7_BASE:1.8
	OPENBSD_3_6:1.8.0.2
	OPENBSD_3_6_BASE:1.8
	SMP_SYNC_A:1.7
	SMP_SYNC_B:1.7
	OPENBSD_3_5:1.7.0.16
	OPENBSD_3_5_BASE:1.7
	OPENBSD_3_4:1.7.0.14
	OPENBSD_3_4_BASE:1.7
	UBC_SYNC_A:1.7
	OPENBSD_3_3:1.7.0.12
	OPENBSD_3_3_BASE:1.7
	OPENBSD_3_2:1.7.0.10
	OPENBSD_3_2_BASE:1.7
	OPENBSD_3_1:1.7.0.8
	OPENBSD_3_1_BASE:1.7
	UBC_SYNC_B:1.7
	UBC:1.7.0.6
	UBC_BASE:1.7
	OPENBSD_3_0:1.7.0.4
	OPENBSD_3_0_BASE:1.7
	OPENBSD_2_9:1.7.0.2
	OPENBSD_2_9_BASE:1.7
	OPENBSD_2_8:1.5.0.8
	OPENBSD_2_8_BASE:1.5
	OPENBSD_2_7:1.5.0.6
	OPENBSD_2_7_BASE:1.5
	SMP:1.5.0.4
	SMP_BASE:1.5
	kame_19991208:1.5
	OPENBSD_2_6:1.5.0.2
	OPENBSD_2_6_BASE:1.5
	OPENBSD_2_5:1.4.0.10
	OPENBSD_2_5_BASE:1.4
	OPENBSD_2_4:1.4.0.8
	OPENBSD_2_4_BASE:1.4
	OPENBSD_2_3:1.4.0.6
	OPENBSD_2_3_BASE:1.4
	OPENBSD_2_2:1.4.0.4
	OPENBSD_2_2_BASE:1.4
	OPENBSD_2_1:1.4.0.2
	OPENBSD_2_1_BASE:1.4
	OPENBSD_2_0:1.3.0.2
	OPENBSD_2_0_BASE:1.3
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@ * @;


1.17
date	2017.02.08.05.09.25;	author guenther;	state Exp;
branches;
next	1.16;
commitid	V3fgN8BO1mri8xSU;

1.16
date	2015.08.29.01.58.39;	author guenther;	state Exp;
branches;
next	1.15;
commitid	tXJb6vLxru5vPZNh;

1.15
date	2015.05.29.19.12.26;	author miod;	state Exp;
branches;
next	1.14;
commitid	NxuNAiDufiij8H5G;

1.14
date	2013.10.17.08.02.14;	author deraadt;	state Exp;
branches;
next	1.13;

1.13
date	2013.02.09.19.20.39;	author miod;	state Exp;
branches;
next	1.12;

1.12
date	2012.09.11.15.44.15;	author deraadt;	state Exp;
branches;
next	1.11;

1.11
date	2011.03.23.16.54.34;	author pirofti;	state Exp;
branches;
next	1.10;

1.10
date	2010.06.30.20.38.49;	author tedu;	state Exp;
branches;
next	1.9;

1.9
date	2007.02.13.20.07.10;	author miod;	state Exp;
branches;
next	1.8;

1.8
date	2004.07.04.01.13.07;	author deraadt;	state Exp;
branches;
next	1.7;

1.7
date	2001.01.22.14.51.02;	author art;	state Exp;
branches;
next	1.6;

1.6
date	2000.12.14.16.53.27;	author art;	state Exp;
branches;
next	1.5;

1.5
date	99.09.10.12.24.27;	author kstailey;	state Exp;
branches
	1.5.4.1;
next	1.4;

1.4
date	96.12.23.02.42.24;	author deraadt;	state Exp;
branches;
next	1.3;

1.3
date	96.07.29.22.58.42;	author niklas;	state Exp;
branches;
next	1.2;

1.2
date	96.05.29.03.04.55;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.49.42;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.49.42;	author deraadt;	state Exp;
branches;
next	;

1.5.4.1
date	2001.04.18.16.00.53;	author niklas;	state Exp;
branches;
next	;


desc
@@


1.17
log
@In exec_elf.c: expand ELFNAME(), ELFNAME2(), and ELFNAMEEND() except
leaving out the size, so that
	ELFNAME2(exec,makecmds)
becomes
	exec_elf_makecmds
instead of
	exec_elf{32,64}_makecmds
and then delete the ELFNAME2() and ELFNAMEEND() macros.

Move the prototypes for functions local to exec_elf.c to there from
exec_elf.h.

Simplify the SMALL_KERNEL conditionals around the ELF coredump code.

Change exec_conf.c to use the size-generic names and macros

Remove exec_elf{32,64}.c and just build exec_elf.c; delete the
_KERN_DO_ELF and _KERN_DO_ELF64 #defines.

ok jca@@, encouragement from deraadt@@ and tom@@
@
text
@/*	$OpenBSD: exec.h,v 1.16 2015/08/29 01:58:39 guenther Exp $	*/
/*	$NetBSD: exec.h,v 1.1 1995/02/13 23:07:37 cgd Exp $	*/

/*
 * Copyright (c) 1994, 1995 Carnegie-Mellon University.
 * All rights reserved.
 *
 * Author: Chris G. Demetriou
 * 
 * Permission to use, copy, modify and distribute this software and
 * its documentation is hereby granted, provided that both the copyright
 * notice and this permission notice appear in all copies of the
 * software, derivative works or modified versions, and any portions
 * thereof, and that both notices appear in supporting documentation.
 * 
 * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS" 
 * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND 
 * FOR ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
 * 
 * Carnegie Mellon requests users of this software to return to
 *
 *  Software Distribution Coordinator  or  Software.Distribution@@CS.CMU.EDU
 *  School of Computer Science
 *  Carnegie Mellon University
 *  Pittsburgh PA 15213-3890
 *
 * any improvements or extensions that they make and grant Carnegie the
 * rights to redistribute these changes.
 */

#ifndef _MACHINE_EXEC_H_
#define	_MACHINE_EXEC_H_

/* Size of a page in an object file. */
#define	__LDPGSZ	8192

#define ARCH_ELFSIZE		64

#define ELF_TARG_CLASS		ELFCLASS64
#define ELF_TARG_DATA		ELFDATA2LSB
#define ELF_TARG_MACH		EM_ALPHA_EXP

/* Processor specific dynamic tag values.  */
#define	DT_ALPHA_PLTRO		0x70000000

#define	DT_PROCNUM		(DT_ALPHA_PLTRO + 1 - DT_LOPROC)

#endif /* !_MACHINE_EXEC_H_ */
@


1.16
log
@_NLIST_DO_ELF is no longer needed: it's the only option

ok deraadt@@
@
text
@d1 1
a1 1
/*	$OpenBSD: exec.h,v 1.15 2015/05/29 19:12:26 miod Exp $	*/
a41 2

#define _KERN_DO_ELF64
@


1.15
log
@Make ld.so on alpha cope with binaries built with secureplt (where secure here
means read-only, which our ld.so already enforced, but a smaller plt section).
@
text
@d1 1
a1 1
/*	$OpenBSD: exec.h,v 1.14 2013/10/17 08:02:14 deraadt Exp $	*/
a42 1
#define _NLIST_DO_ELF
@


1.14
log
@Remove support for a.out and ecoff.  We only do elf now.
ok miod
@
text
@d1 1
a1 1
/*	$OpenBSD: exec.h,v 1.13 2013/02/09 19:20:39 miod Exp $	*/
d45 5
@


1.13
log
@Do not bother defining cpu_exec_aout_makecmds() on platforms where we no longer
(or never did) support a.out binaries (i.e. where _KERN_DO_AOUT is not defined).
@
text
@d1 1
a1 1
/*	$OpenBSD: exec.h,v 1.12 2012/09/11 15:44:15 deraadt Exp $	*/
a42 1
#define _NLIST_DO_ECOFF
a43 1

@


1.12
log
@Remove the 'OLF method' used for the transition from a.out to ELF and
for all the compat layers which are now gone.  Linux compat still works
because it always used another method in any case, and nothing looks at
p_os anymore.
ok jsing
@
text
@d1 1
a1 1
/*	$OpenBSD: exec.h,v 1.11 2011/03/23 16:54:34 pirofti Exp $	*/
a32 2

#define cpu_exec_aout_makecmds(p, epp)	ENOEXEC
@


1.11
log
@Normalize sentinel. Use _MACHINE_*_H_ and _<ARCH>_*_H_ properly and consitently.

Discussed and okay drahn@@. Okay deraadt@@.
@
text
@d1 1
a1 1
/*	$OpenBSD: exec.h,v 1.10 2010/06/30 20:38:49 tedu Exp $	*/
a37 2

#define NATIVE_EXEC_ELF
@


1.10
log
@remove compat_osf1 support from the kernel
ok deraadt miod
@
text
@d1 1
a1 1
/*	$OpenBSD: exec.h,v 1.9 2007/02/13 20:07:10 miod Exp $	*/
d31 2
a32 2
#ifndef _ALPHA_EXEC_H_
#define	_ALPHA_EXEC_H_
d52 1
a52 1
#endif /* !_ALPHA_EXEC_H_ */
@


1.9
log
@Remove a.out nlist support (COFF nlist is kept in case kernel has COMPAT_OSF1)
@
text
@d1 1
a1 1
/*	$OpenBSD: exec.h,v 1.8 2004/07/04 01:13:07 deraadt Exp $	*/
a49 3
#ifdef COMPAT_OSF1
#define _KERN_DO_ECOFF
#endif
@


1.8
log
@turn off _KERN_DO_ECOFF unless COMPAT_OSF1 is enabled.  This shrinks the
ramdisks, too.
@
text
@d1 1
a1 1
/*	$OpenBSD: exec.h,v 1.7 2001/01/22 14:51:02 art Exp $	*/
a46 1
#define _NLIST_DO_AOUT
@


1.7
log
@Define ARCH_ELFSIZE that is the default elf size on this arch.
@
text
@d1 1
a1 1
/*	$OpenBSD: exec.h,v 1.6 2000/12/14 16:53:27 art Exp $	*/
d51 1
a51 1
#define _KERN_DO_AOUT
d53 1
@


1.6
log
@native ELF and ELF for nlist
@
text
@d1 1
a1 1
/*	$OpenBSD: exec.h,v 1.5 1999/09/10 12:24:27 kstailey Exp $	*/
d40 2
@


1.5
log
@ELF64
@
text
@d1 1
a1 1
/*	$OpenBSD: exec.h,v 1.4 1996/12/23 02:42:24 deraadt Exp $	*/
d39 2
d47 1
@


1.5.4.1
log
@Update the SMP branch to -current, this breaks the SMP branch though.
But it will be fixed soonish.  Note, nothing new has happened, this is just
a merge of the trunk into this branch.
@
text
@d1 1
a1 1
/*	$OpenBSD: exec.h,v 1.7 2001/01/22 14:51:02 art Exp $	*/
a38 4
#define NATIVE_EXEC_ELF

#define ARCH_ELFSIZE		64

a44 1
#define _NLIST_DO_ELF
@


1.4
log
@use _{NLIST,KERN}_DO_{AOUT,ELF,ECOFF} to select binary types
@
text
@d1 1
a1 1
/*	$OpenBSD: exec.h,v 1.3 1996/07/29 22:58:42 niklas Exp $	*/
d41 1
a41 1
#define ELF_TARG_MACH		EM_ALPHA
d48 1
@


1.3
log
@Add OpenBSD tags.  Adapt to OpenBSD *_intr_establish calling convention
@
text
@d1 1
a1 1
/*	$OpenBSD: exec.h,v 1.1 1995/02/13 23:07:37 cgd Exp $	*/
d43 5
a47 2
#define DO_AOUT			/* support a.out */
#define DO_ECOFF		/* support ECOFF */
@


1.2
log
@enable ELF/a.out/ECOFF in machine/exec.h
@
text
@d1 1
@


1.1
log
@Initial revision
@
text
@d38 7
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
