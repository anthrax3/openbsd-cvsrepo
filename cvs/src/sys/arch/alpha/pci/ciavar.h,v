head	1.13;
access;
symbols
	OPENBSD_6_1:1.13.0.46
	OPENBSD_6_1_BASE:1.13
	OPENBSD_6_0:1.13.0.42
	OPENBSD_6_0_BASE:1.13
	OPENBSD_5_9:1.13.0.38
	OPENBSD_5_9_BASE:1.13
	OPENBSD_5_8:1.13.0.40
	OPENBSD_5_8_BASE:1.13
	OPENBSD_5_7:1.13.0.32
	OPENBSD_5_7_BASE:1.13
	OPENBSD_5_6:1.13.0.36
	OPENBSD_5_6_BASE:1.13
	OPENBSD_5_5:1.13.0.34
	OPENBSD_5_5_BASE:1.13
	OPENBSD_5_4:1.13.0.30
	OPENBSD_5_4_BASE:1.13
	OPENBSD_5_3:1.13.0.28
	OPENBSD_5_3_BASE:1.13
	OPENBSD_5_2:1.13.0.26
	OPENBSD_5_2_BASE:1.13
	OPENBSD_5_1_BASE:1.13
	OPENBSD_5_1:1.13.0.24
	OPENBSD_5_0:1.13.0.22
	OPENBSD_5_0_BASE:1.13
	OPENBSD_4_9:1.13.0.20
	OPENBSD_4_9_BASE:1.13
	OPENBSD_4_8:1.13.0.18
	OPENBSD_4_8_BASE:1.13
	OPENBSD_4_7:1.13.0.14
	OPENBSD_4_7_BASE:1.13
	OPENBSD_4_6:1.13.0.16
	OPENBSD_4_6_BASE:1.13
	OPENBSD_4_5:1.13.0.12
	OPENBSD_4_5_BASE:1.13
	OPENBSD_4_4:1.13.0.10
	OPENBSD_4_4_BASE:1.13
	OPENBSD_4_3:1.13.0.8
	OPENBSD_4_3_BASE:1.13
	OPENBSD_4_2:1.13.0.6
	OPENBSD_4_2_BASE:1.13
	OPENBSD_4_1:1.13.0.4
	OPENBSD_4_1_BASE:1.13
	OPENBSD_4_0:1.13.0.2
	OPENBSD_4_0_BASE:1.13
	OPENBSD_3_9:1.12.0.18
	OPENBSD_3_9_BASE:1.12
	OPENBSD_3_8:1.12.0.16
	OPENBSD_3_8_BASE:1.12
	OPENBSD_3_7:1.12.0.14
	OPENBSD_3_7_BASE:1.12
	OPENBSD_3_6:1.12.0.12
	OPENBSD_3_6_BASE:1.12
	SMP_SYNC_A:1.12
	SMP_SYNC_B:1.12
	OPENBSD_3_5:1.12.0.10
	OPENBSD_3_5_BASE:1.12
	OPENBSD_3_4:1.12.0.8
	OPENBSD_3_4_BASE:1.12
	UBC_SYNC_A:1.12
	OPENBSD_3_3:1.12.0.6
	OPENBSD_3_3_BASE:1.12
	OPENBSD_3_2:1.12.0.4
	OPENBSD_3_2_BASE:1.12
	OPENBSD_3_1:1.12.0.2
	OPENBSD_3_1_BASE:1.12
	UBC_SYNC_B:1.12
	UBC:1.11.0.2
	UBC_BASE:1.11
	OPENBSD_3_0:1.10.0.4
	OPENBSD_3_0_BASE:1.10
	OPENBSD_2_9:1.10.0.2
	OPENBSD_2_9_BASE:1.10
	OPENBSD_2_8:1.8.0.12
	OPENBSD_2_8_BASE:1.8
	OPENBSD_2_7:1.8.0.10
	OPENBSD_2_7_BASE:1.8
	SMP:1.8.0.8
	SMP_BASE:1.8
	kame_19991208:1.8
	OPENBSD_2_6:1.8.0.6
	OPENBSD_2_6_BASE:1.8
	OPENBSD_2_5:1.8.0.4
	OPENBSD_2_5_BASE:1.8
	OPENBSD_2_4:1.8.0.2
	OPENBSD_2_4_BASE:1.8
	OPENBSD_2_3:1.6.0.6
	OPENBSD_2_3_BASE:1.6
	OPENBSD_2_2:1.6.0.4
	OPENBSD_2_2_BASE:1.6
	OPENBSD_2_1:1.6.0.2
	OPENBSD_2_1_BASE:1.6
	OPENBSD_2_0:1.3.0.2
	OPENBSD_2_0_BASE:1.3;
locks; strict;
comment	@ * @;


1.13
date	2006.03.16.22.32.44;	author miod;	state Exp;
branches;
next	1.12;

1.12
date	2002.03.14.01.26.27;	author millert;	state Exp;
branches;
next	1.11;

1.11
date	2001.12.14.00.44.59;	author nate;	state Exp;
branches
	1.11.2.1;
next	1.10;

1.10
date	2000.11.08.20.59.25;	author ericj;	state Exp;
branches;
next	1.9;

1.9
date	2000.11.08.16.01.18;	author art;	state Exp;
branches;
next	1.8;

1.8
date	98.06.28.02.43.23;	author angelos;	state Exp;
branches
	1.8.8.1;
next	1.7;

1.7
date	98.06.28.02.39.25;	author angelos;	state Exp;
branches;
next	1.6;

1.6
date	97.01.24.19.57.40;	author niklas;	state Exp;
branches;
next	1.5;

1.5
date	96.12.08.00.20.37;	author niklas;	state Exp;
branches;
next	1.4;

1.4
date	96.10.30.22.39.58;	author niklas;	state Exp;
branches;
next	1.3;

1.3
date	96.07.29.23.00.24;	author niklas;	state Exp;
branches;
next	1.2;

1.2
date	96.06.18.09.44.12;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	95.12.14.03.53.24;	author deraadt;	state Exp;
branches;
next	;

1.8.8.1
date	2001.04.18.16.01.12;	author niklas;	state Exp;
branches;
next	1.8.8.2;

1.8.8.2
date	2002.03.06.00.47.44;	author niklas;	state Exp;
branches;
next	1.8.8.3;

1.8.8.3
date	2002.03.28.10.06.13;	author niklas;	state Exp;
branches;
next	;

1.11.2.1
date	2002.06.11.03.33.40;	author art;	state Exp;
branches;
next	;


desc
@@


1.13
log
@Get rid of specific softc structure for pci host bridges, as it is never
used. No functional change.
@
text
@/* $OpenBSD: ciavar.h,v 1.12 2002/03/14 01:26:27 millert Exp $ */
/* $NetBSD: ciavar.h,v 1.17 2000/03/19 01:43:25 thorpej Exp $ */

/*
 * Copyright (c) 1995, 1996 Carnegie-Mellon University.
 * All rights reserved.
 *
 * Author: Chris G. Demetriou
 * 
 * Permission to use, copy, modify and distribute this software and
 * its documentation is hereby granted, provided that both the copyright
 * notice and this permission notice appear in all copies of the
 * software, derivative works or modified versions, and any portions
 * thereof, and that both notices appear in supporting documentation.
 * 
 * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS" 
 * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND 
 * FOR ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
 * 
 * Carnegie Mellon requests users of this software to return to
 *
 *  Software Distribution Coordinator  or  Software.Distribution@@CS.CMU.EDU
 *  School of Computer Science
 *  Carnegie Mellon University
 *  Pittsburgh PA 15213-3890
 *
 * any improvements or extensions that they make and grant Carnegie the
 * rights to redistribute these changes.
 */

#include <dev/isa/isavar.h>
#include <dev/pci/pcivar.h>
#include <alpha/pci/pci_sgmap_pte64.h>

/*
 * A 21171 chipset's configuration.
 *
 * All of the information that the chipset-specific functions need to
 * do their dirty work (and more!).
 */
struct cia_config {
	int	cc_initted;

	struct alpha_bus_space cc_iot, cc_memt;
	struct alpha_pci_chipset cc_pc;

	struct alpha_bus_dma_tag cc_dmat_direct;
	struct alpha_bus_dma_tag cc_dmat_sgmap;

	struct alpha_sgmap cc_sgmap;

	u_int32_t cc_hae_mem;
	u_int32_t cc_hae_io;

	u_int32_t cc_rev;
	u_int32_t cc_cnfg;

	int	cc_flags;

#define	CCF_ISPYXIS	0x01		/* chip is a 21174 Pyxis */
#define	CCF_PYXISBUG	0x02
#define	CCF_PCI_USE_BWX	0x04		/* use BWX for PCI config space */
#define	CCF_BUS_USE_BWX	0x08		/* use BWX for bus space */

	struct extent *cc_io_ex, *cc_d_mem_ex, *cc_s_mem_ex;
	int	cc_mallocsafe;
};

void	cia_init(struct cia_config *, int);
void	cia_pci_init(pci_chipset_tag_t, void *);
void	cia_dma_init(struct cia_config *);

void	cia_bwx_bus_io_init(bus_space_tag_t, void *);
void	cia_bwx_bus_mem_init(bus_space_tag_t, void *);

void	cia_bus_io_init(bus_space_tag_t, void *);
void	cia_bus_mem_init(bus_space_tag_t, void *);

void	cia_pyxis_intr_enable(int, int);
@


1.12
log
@First round of __P removal in sys
@
text
@d1 1
a1 1
/* $OpenBSD: ciavar.h,v 1.11 2001/12/14 00:44:59 nate Exp $ */
a66 6
};

struct cia_softc {
	struct	device sc_dev;

	struct	cia_config *sc_ccp;
@


1.11
log
@Don't use a single static struct alpha_bus_space since there are machines
that can have more than one system bus attached to mainbus
@
text
@d1 1
a1 1
/* $OpenBSD: ciavar.h,v 1.10 2000/11/08 20:59:25 ericj Exp $ */
d75 3
a77 3
void	cia_init __P((struct cia_config *, int));
void	cia_pci_init __P((pci_chipset_tag_t, void *));
void	cia_dma_init __P((struct cia_config *));
d79 2
a80 2
void	cia_bwx_bus_io_init __P((bus_space_tag_t, void *));
void	cia_bwx_bus_mem_init __P((bus_space_tag_t, void *));
d82 2
a83 2
void	cia_bus_io_init __P((bus_space_tag_t, void *));
void	cia_bus_mem_init __P((bus_space_tag_t, void *));
d85 1
a85 1
void	cia_pyxis_intr_enable __P((int, int));
@


1.11.2.1
log
@Sync UBC branch to -current
@
text
@d1 1
a1 1
/* $OpenBSD: ciavar.h,v 1.11 2001/12/14 00:44:59 nate Exp $ */
d75 3
a77 3
void	cia_init(struct cia_config *, int);
void	cia_pci_init(pci_chipset_tag_t, void *);
void	cia_dma_init(struct cia_config *);
d79 2
a80 2
void	cia_bwx_bus_io_init(bus_space_tag_t, void *);
void	cia_bwx_bus_mem_init(bus_space_tag_t, void *);
d82 2
a83 2
void	cia_bus_io_init(bus_space_tag_t, void *);
void	cia_bus_mem_init(bus_space_tag_t, void *);
d85 1
a85 1
void	cia_pyxis_intr_enable(int, int);
@


1.10
log
@add tags
@
text
@d1 1
a1 1
/* $OpenBSD$ */
d44 1
a44 1
	bus_space_tag_t cc_iot, cc_memt;
d79 2
a80 2
bus_space_tag_t	cia_bwx_bus_io_init __P((void *));
bus_space_tag_t	cia_bwx_bus_mem_init __P((void *));
d82 2
a83 2
bus_space_tag_t	cia_bus_io_init __P((void *));
bus_space_tag_t	cia_bus_mem_init __P((void *));
@


1.9
log
@Merge in big portions of the improvements NetBSD did to their alpha port.
Highlights: UVM, PMAP_NEW, bus_dma (only on some buses for now), new hardware
support, possiblity for ELF, etc, etc. Too much to mention.

This is still work in progress. video consoles might be broken, otherwise
we have basically the same functionality as before plus more.
@
text
@d1 1
@


1.8
log
@Oops, cut and pasted a bit too much.
@
text
@d1 1
a1 2
/*	$OpenBSD: ciavar.h,v 1.7 1998/06/28 02:39:25 angelos Exp $	*/
/*	$NetBSD: ciavar.h,v 1.6 1996/11/25 03:49:11 cgd Exp $	*/
d32 1
d46 5
d54 9
a62 7
        u_int32_t cc_rev;
        u_int32_t cc_cnfg;
        
        int     cc_flags;
        
#define CCF_ISPYXIS     0x01            /* chip is a 21174 Pyxis */
#define CCF_USEBWX      0x02            /* use BWX when possible */
a71 1
	/* XXX SGMAP info */
d76 4
d83 2
@


1.8.8.1
log
@Update the SMP branch to -current, this breaks the SMP branch though.
But it will be fixed soonish.  Note, nothing new has happened, this is just
a merge of the trunk into this branch.
@
text
@d1 2
a2 2
/* $OpenBSD: ciavar.h,v 1.10 2000/11/08 20:59:25 ericj Exp $ */
/* $NetBSD: ciavar.h,v 1.17 2000/03/19 01:43:25 thorpej Exp $ */
a32 1
#include <alpha/pci/pci_sgmap_pte64.h>
a45 5
	struct alpha_bus_dma_tag cc_dmat_direct;
	struct alpha_bus_dma_tag cc_dmat_sgmap;

	struct alpha_sgmap cc_sgmap;

d49 7
a55 9
	u_int32_t cc_rev;
	u_int32_t cc_cnfg;

	int	cc_flags;

#define	CCF_ISPYXIS	0x01		/* chip is a 21174 Pyxis */
#define	CCF_PYXISBUG	0x02
#define	CCF_PCI_USE_BWX	0x04		/* use BWX for PCI config space */
#define	CCF_BUS_USE_BWX	0x08		/* use BWX for bus space */
d65 1
a69 4
void	cia_dma_init __P((struct cia_config *));

bus_space_tag_t	cia_bwx_bus_io_init __P((void *));
bus_space_tag_t	cia_bwx_bus_mem_init __P((void *));
a72 2

void	cia_pyxis_intr_enable __P((int, int));
@


1.8.8.2
log
@Merge in trunk
@
text
@d1 1
a1 1
/* $OpenBSD$ */
d44 1
a44 1
	struct alpha_bus_space cc_iot, cc_memt;
d79 2
a80 2
void	cia_bwx_bus_io_init __P((bus_space_tag_t, void *));
void	cia_bwx_bus_mem_init __P((bus_space_tag_t, void *));
d82 2
a83 2
void	cia_bus_io_init __P((bus_space_tag_t, void *));
void	cia_bus_mem_init __P((bus_space_tag_t, void *));
@


1.8.8.3
log
@Merge in -current from about a week ago
@
text
@d75 3
a77 3
void	cia_init(struct cia_config *, int);
void	cia_pci_init(pci_chipset_tag_t, void *);
void	cia_dma_init(struct cia_config *);
d79 2
a80 2
void	cia_bwx_bus_io_init(bus_space_tag_t, void *);
void	cia_bwx_bus_mem_init(bus_space_tag_t, void *);
d82 2
a83 2
void	cia_bus_io_init(bus_space_tag_t, void *);
void	cia_bus_mem_init(bus_space_tag_t, void *);
d85 1
a85 1
void	cia_pyxis_intr_enable(int, int);
@


1.7
log
@Extend struct cia_config, needed for the EB164LX/SX support (and other
things to come), from NetBSD.
@
text
@d1 1
a1 1
/*	$OpenBSD: ciavar.h,v 1.6 1997/01/24 19:57:40 niklas Exp $	*/
a47 3

        u_int32_t cc_hae_mem;
        u_int32_t cc_hae_io;
@


1.6
log
@Sync with NetBSD 961207
@
text
@d1 1
a1 1
/*	$OpenBSD: ciavar.h,v 1.5 1996/12/08 00:20:37 niklas Exp $	*/
d48 11
@


1.5
log
@Merge to NetBSD 961107, i.e. mostly new bus.h
@
text
@d1 2
a2 2
/*	$OpenBSD: ciavar.h,v 1.4 1996/10/30 22:39:58 niklas Exp $	*/
/*	$NetBSD: ciavar.h,v 1.5 1996/10/23 04:12:24 cgd Exp $	*/
d41 2
d48 3
d60 1
a60 1
void	cia_init __P((struct cia_config *));
d63 2
a64 2
bus_space_tag_t	cia_bus_io_init __P((void *iov));
bus_space_tag_t	cia_bus_mem_init __P((void *memv));
@


1.4
log
@Merge to NetBSD 961020.  Retained our kernel APIs where NetBSD has changed.
-Wall -Wstrict-prototypes -Wmissing-prototypes too.
@
text
@d1 2
a2 2
/*	$OpenBSD: ciavar.h,v 1.4 1996/06/10 00:03:59 cgd Exp $	*/
/*	$NetBSD: ciavar.h,v 1.4 1996/06/10 00:03:59 cgd Exp $	*/
d41 1
a41 1
	struct alpha_bus_chipset cc_bc;
d58 2
a59 2
void	cia_bus_mem_init __P((bus_chipset_tag_t bc, void *memv));
void	cia_bus_io_init __P((bus_chipset_tag_t bc, void *iov));
@


1.3
log
@Add OpenBSD tags.  Adapt to OpenBSD *_intr_establish calling convention
@
text
@d1 2
a2 2
/*	$OpenBSD: ciavar.h,v 1.3.4.1 1996/06/10 00:04:12 cgd Exp $	*/
/*	$NetBSD: ciavar.h,v 1.3.4.1 1996/06/10 00:04:12 cgd Exp $	*/
@


1.2
log
@sync to 0616, retaining local diffs
@
text
@d1 1
@


1.1
log
@update to netbsd
@
text
@d1 1
a1 1
/*	$NetBSD: ciavar.h,v 1.1 1995/11/23 02:37:35 cgd Exp $	*/
d4 1
a4 1
 * Copyright (c) 1995 Carnegie-Mellon University.
d40 2
a41 2
	__const struct pci_conf_fns	*cc_conffns;
	void				*cc_confarg;
d43 2
a44 11
	__const struct pci_dma_fns	*cc_dmafns;
	void				*cc_dmaarg;

	__const struct pci_intr_fns	*cc_intrfns;
	void				*cc_intrarg;

	__const struct pci_mem_fns	*cc_memfns;
	void				*cc_memarg;

	__const struct pci_pio_fns	*cc_piofns;
	void				*cc_pioarg;
d54 2
a55 5
extern __const struct pci_conf_fns	cia_conf_fns;
extern __const struct pci_dma_fns	cia_dma_fns;
/* pci interrupt functions handled elsewhere */
extern __const struct pci_mem_fns	cia_mem_fns;
extern __const struct pci_pio_fns	cia_pio_fns;
d57 2
a58 1
void	cia_init __P((struct cia_config *));
@
