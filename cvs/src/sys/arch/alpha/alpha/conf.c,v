head	1.83;
access;
symbols
	OPENBSD_6_1:1.83.0.2
	OPENBSD_6_1_BASE:1.83
	OPENBSD_6_0:1.81.0.2
	OPENBSD_6_0_BASE:1.81
	OPENBSD_5_9:1.79.0.2
	OPENBSD_5_9_BASE:1.79
	OPENBSD_5_8:1.78.0.6
	OPENBSD_5_8_BASE:1.78
	OPENBSD_5_7:1.78.0.2
	OPENBSD_5_7_BASE:1.78
	OPENBSD_5_6:1.74.0.6
	OPENBSD_5_6_BASE:1.74
	OPENBSD_5_5:1.74.0.4
	OPENBSD_5_5_BASE:1.74
	OPENBSD_5_4:1.71.0.2
	OPENBSD_5_4_BASE:1.71
	OPENBSD_5_3:1.69.0.2
	OPENBSD_5_3_BASE:1.69
	OPENBSD_5_2:1.68.0.2
	OPENBSD_5_2_BASE:1.68
	OPENBSD_5_1_BASE:1.67
	OPENBSD_5_1:1.67.0.2
	OPENBSD_5_0:1.66.0.4
	OPENBSD_5_0_BASE:1.66
	OPENBSD_4_9:1.66.0.2
	OPENBSD_4_9_BASE:1.66
	OPENBSD_4_8:1.63.0.2
	OPENBSD_4_8_BASE:1.63
	OPENBSD_4_7:1.60.0.2
	OPENBSD_4_7_BASE:1.60
	OPENBSD_4_6:1.59.0.4
	OPENBSD_4_6_BASE:1.59
	OPENBSD_4_5:1.58.0.2
	OPENBSD_4_5_BASE:1.58
	OPENBSD_4_4:1.57.0.2
	OPENBSD_4_4_BASE:1.57
	OPENBSD_4_3:1.55.0.4
	OPENBSD_4_3_BASE:1.55
	OPENBSD_4_2:1.55.0.2
	OPENBSD_4_2_BASE:1.55
	OPENBSD_4_1:1.51.0.6
	OPENBSD_4_1_BASE:1.51
	OPENBSD_4_0:1.51.0.4
	OPENBSD_4_0_BASE:1.51
	OPENBSD_3_9:1.51.0.2
	OPENBSD_3_9_BASE:1.51
	OPENBSD_3_8:1.50.0.6
	OPENBSD_3_8_BASE:1.50
	OPENBSD_3_7:1.50.0.4
	OPENBSD_3_7_BASE:1.50
	OPENBSD_3_6:1.50.0.2
	OPENBSD_3_6_BASE:1.50
	SMP_SYNC_A:1.49
	SMP_SYNC_B:1.49
	OPENBSD_3_5:1.48.0.2
	OPENBSD_3_5_BASE:1.48
	OPENBSD_3_4:1.47.0.2
	OPENBSD_3_4_BASE:1.47
	UBC_SYNC_A:1.46
	OPENBSD_3_3:1.45.0.2
	OPENBSD_3_3_BASE:1.45
	OPENBSD_3_2:1.44.0.2
	OPENBSD_3_2_BASE:1.44
	OPENBSD_3_1:1.37.0.2
	OPENBSD_3_1_BASE:1.37
	UBC_SYNC_B:1.44
	UBC:1.35.0.2
	UBC_BASE:1.35
	OPENBSD_3_0:1.32.0.2
	OPENBSD_3_0_BASE:1.32
	OPENBSD_2_9:1.23.0.2
	OPENBSD_2_9_BASE:1.23
	OPENBSD_2_8:1.22.0.2
	OPENBSD_2_8_BASE:1.22
	OPENBSD_2_7:1.20.0.6
	OPENBSD_2_7_BASE:1.20
	SMP:1.20.0.4
	SMP_BASE:1.20
	kame_19991208:1.20
	OPENBSD_2_6:1.20.0.2
	OPENBSD_2_6_BASE:1.20
	OPENBSD_2_5:1.18.0.4
	OPENBSD_2_5_BASE:1.18
	OPENBSD_2_4:1.18.0.2
	OPENBSD_2_4_BASE:1.18
	OPENBSD_2_3:1.14.0.2
	OPENBSD_2_3_BASE:1.14
	OPENBSD_2_2:1.13.0.2
	OPENBSD_2_2_BASE:1.13
	OPENBSD_2_1:1.11.0.2
	OPENBSD_2_1_BASE:1.11
	OPENBSD_2_0:1.6.0.2
	OPENBSD_2_0_BASE:1.6
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@ * @;


1.83
date	2016.09.04.10.51.23;	author naddy;	state Exp;
branches;
next	1.82;
commitid	4OWaAfwqMvhOCLOI;

1.82
date	2016.09.02.17.06.12;	author goda;	state Exp;
branches;
next	1.81;
commitid	J1JzeTsS8K8zyH3c;

1.81
date	2016.04.25.20.09.14;	author tedu;	state Exp;
branches;
next	1.80;
commitid	43yo2G4zZOY9ab4i;

1.80
date	2016.02.26.09.10.04;	author natano;	state Exp;
branches;
next	1.79;
commitid	NHDvdrxPpwDqGtpK;

1.79
date	2015.10.23.15.10.52;	author claudio;	state Exp;
branches;
next	1.78;
commitid	g17gxjQh9N9egLbB;

1.78
date	2014.12.11.19.44.16;	author tedu;	state Exp;
branches;
next	1.77;
commitid	jUSAZlQ30WF1ESM9;

1.77
date	2014.10.09.04.10.03;	author tedu;	state Exp;
branches;
next	1.76;
commitid	Db8IHIncfKM3SDX9;

1.76
date	2014.10.09.03.59.58;	author tedu;	state Exp;
branches;
next	1.75;
commitid	I0KLtD9aVxAdm6aW;

1.75
date	2014.08.20.06.14.42;	author mikeb;	state Exp;
branches;
next	1.74;
commitid	qXFkosC6o9cv78HT;

1.74
date	2013.11.04.17.14.26;	author deraadt;	state Exp;
branches;
next	1.73;

1.73
date	2013.11.04.14.11.27;	author deraadt;	state Exp;
branches;
next	1.72;

1.72
date	2013.08.20.14.27.24;	author ajacoutot;	state Exp;
branches;
next	1.71;

1.71
date	2013.06.03.15.54.47;	author tedu;	state Exp;
branches;
next	1.70;

1.70
date	2013.03.15.09.10.52;	author ratchov;	state Exp;
branches;
next	1.69;

1.69
date	2012.08.23.06.12.49;	author deraadt;	state Exp;
branches;
next	1.68;

1.68
date	2012.04.06.15.10.39;	author jsing;	state Exp;
branches;
next	1.67;

1.67
date	2011.10.06.20.49.27;	author deraadt;	state Exp;
branches;
next	1.66;

1.66
date	2011.01.14.19.04.08;	author jasper;	state Exp;
branches;
next	1.65;

1.65
date	2010.11.19.20.55.48;	author miod;	state Exp;
branches;
next	1.64;

1.64
date	2010.09.23.05.02.14;	author claudio;	state Exp;
branches;
next	1.63;

1.63
date	2010.07.03.03.59.16;	author krw;	state Exp;
branches;
next	1.62;

1.62
date	2010.06.09.15.25.32;	author jsing;	state Exp;
branches;
next	1.61;

1.61
date	2010.03.30.19.16.09;	author matthieu;	state Exp;
branches;
next	1.60;

1.60
date	2009.08.13.15.04.20;	author dlg;	state Exp;
branches;
next	1.59;

1.59
date	2009.06.03.14.45.50;	author jj;	state Exp;
branches;
next	1.58;

1.58
date	2009.01.25.17.30.48;	author miod;	state Exp;
branches;
next	1.57;

1.57
date	2008.06.12.20.03.48;	author mglocker;	state Exp;
branches;
next	1.56;

1.56
date	2008.04.08.14.31.54;	author claudio;	state Exp;
branches;
next	1.55;

1.55
date	2007.06.20.18.28.56;	author miod;	state Exp;
branches;
next	1.54;

1.54
date	2007.05.28.22.26.03;	author todd;	state Exp;
branches;
next	1.53;

1.53
date	2007.05.27.01.50.36;	author todd;	state Exp;
branches;
next	1.52;

1.52
date	2007.05.26.19.54.24;	author todd;	state Exp;
branches;
next	1.51;

1.51
date	2005.11.15.14.36.48;	author robert;	state Exp;
branches;
next	1.50;

1.50
date	2004.06.18.20.35.50;	author miod;	state Exp;
branches;
next	1.49;

1.49
date	2004.05.30.08.11.25;	author grange;	state Exp;
branches;
next	1.48;

1.48
date	2004.02.10.01.31.20;	author millert;	state Exp;
branches;
next	1.47;

1.47
date	2003.06.02.23.27.43;	author millert;	state Exp;
branches;
next	1.46;

1.46
date	2003.05.14.00.20.37;	author tedu;	state Exp;
branches;
next	1.45;

1.45
date	2002.12.05.02.49.55;	author kjc;	state Exp;
branches;
next	1.44;

1.44
date	2002.07.10.22.08.47;	author mickey;	state Exp;
branches;
next	1.43;

1.43
date	2002.06.24.19.00.33;	author mickey;	state Exp;
branches;
next	1.42;

1.42
date	2002.06.19.02.52.23;	author mickey;	state Exp;
branches;
next	1.41;

1.41
date	2002.06.11.05.15.17;	author miod;	state Exp;
branches;
next	1.40;

1.40
date	2002.06.11.04.53.39;	author miod;	state Exp;
branches;
next	1.39;

1.39
date	2002.06.11.03.30.15;	author miod;	state Exp;
branches;
next	1.38;

1.38
date	2002.05.16.21.11.10;	author miod;	state Exp;
branches;
next	1.37;

1.37
date	2002.01.23.05.21.03;	author ericj;	state Exp;
branches;
next	1.36;

1.36
date	2002.01.23.05.06.39;	author ericj;	state Exp;
branches;
next	1.35;

1.35
date	2001.12.11.23.18.59;	author miod;	state Exp;
branches
	1.35.2.1;
next	1.34;

1.34
date	2001.10.26.01.28.06;	author nate;	state Exp;
branches;
next	1.33;

1.33
date	2001.10.26.00.41.46;	author nate;	state Exp;
branches;
next	1.32;

1.32
date	2001.09.28.03.33.39;	author mickey;	state Exp;
branches;
next	1.31;

1.31
date	2001.09.28.02.53.13;	author mickey;	state Exp;
branches;
next	1.30;

1.30
date	2001.08.06.22.34.43;	author mickey;	state Exp;
branches;
next	1.29;

1.29
date	2001.07.05.02.40.43;	author mickey;	state Exp;
branches;
next	1.28;

1.28
date	2001.06.27.06.16.39;	author angelos;	state Exp;
branches;
next	1.27;

1.27
date	2001.06.27.05.50.03;	author kjc;	state Exp;
branches;
next	1.26;

1.26
date	2001.06.26.20.24.10;	author art;	state Exp;
branches;
next	1.25;

1.25
date	2001.06.25.03.19.39;	author kjell;	state Exp;
branches;
next	1.24;

1.24
date	2001.06.24.21.19.08;	author art;	state Exp;
branches;
next	1.23;

1.23
date	2001.03.08.02.36.01;	author ericj;	state Exp;
branches;
next	1.22;

1.22
date	2000.09.26.14.03.51;	author art;	state Exp;
branches;
next	1.21;

1.21
date	2000.07.03.19.30.13;	author mickey;	state Exp;
branches;
next	1.20;

1.20
date	99.07.30.19.05.49;	author deraadt;	state Exp;
branches
	1.20.4.1;
next	1.19;

1.19
date	99.07.25.04.38.25;	author csapuntz;	state Exp;
branches;
next	1.18;

1.18
date	98.09.25.09.20.52;	author todd;	state Exp;
branches;
next	1.17;

1.17
date	98.08.24.05.29.46;	author millert;	state Exp;
branches;
next	1.16;

1.16
date	98.07.07.06.55.54;	author deraadt;	state Exp;
branches;
next	1.15;

1.15
date	98.07.07.03.02.29;	author deraadt;	state Exp;
branches;
next	1.14;

1.14
date	97.11.23.05.21.53;	author mickey;	state Exp;
branches;
next	1.13;

1.13
date	97.08.04.10.01.43;	author dgregor;	state Exp;
branches;
next	1.12;

1.12
date	97.07.06.18.12.01;	author niklas;	state Exp;
branches;
next	1.11;

1.11
date	97.05.06.19.47.12;	author niklas;	state Exp;
branches;
next	1.10;

1.10
date	96.11.11.19.43.27;	author kstailey;	state Exp;
branches;
next	1.9;

1.9
date	96.11.06.02.01.08;	author deraadt;	state Exp;
branches;
next	1.8;

1.8
date	96.10.30.22.38.00;	author niklas;	state Exp;
branches;
next	1.7;

1.7
date	96.10.19.13.26.03;	author mickey;	state Exp;
branches;
next	1.6;

1.6
date	96.08.29.09.25.48;	author deraadt;	state Exp;
branches;
next	1.5;

1.5
date	96.07.29.22.57.17;	author niklas;	state Exp;
branches;
next	1.4;

1.4
date	96.07.15.14.56.59;	author mickey;	state Exp;
branches;
next	1.3;

1.3
date	96.06.18.09.42.06;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	96.05.04.18.50.28;	author mickey;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.49.39;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.49.39;	author deraadt;	state Exp;
branches;
next	;

1.20.4.1
date	2001.04.18.16.00.09;	author niklas;	state Exp;
branches;
next	1.20.4.2;

1.20.4.2
date	2001.07.04.10.14.19;	author niklas;	state Exp;
branches;
next	1.20.4.3;

1.20.4.3
date	2001.10.31.02.52.43;	author nate;	state Exp;
branches;
next	1.20.4.4;

1.20.4.4
date	2002.03.06.00.24.08;	author niklas;	state Exp;
branches;
next	1.20.4.5;

1.20.4.5
date	2003.03.27.22.29.47;	author niklas;	state Exp;
branches;
next	1.20.4.6;

1.20.4.6
date	2003.05.16.00.29.38;	author niklas;	state Exp;
branches;
next	1.20.4.7;

1.20.4.7
date	2003.06.07.11.11.33;	author ho;	state Exp;
branches;
next	1.20.4.8;

1.20.4.8
date	2004.06.05.23.10.42;	author niklas;	state Exp;
branches;
next	;

1.35.2.1
date	2002.01.31.22.55.04;	author niklas;	state Exp;
branches;
next	1.35.2.2;

1.35.2.2
date	2002.06.11.03.33.39;	author art;	state Exp;
branches;
next	1.35.2.3;

1.35.2.3
date	2002.10.29.00.28.00;	author art;	state Exp;
branches;
next	1.35.2.4;

1.35.2.4
date	2003.05.19.21.38.52;	author tedu;	state Exp;
branches;
next	;


desc
@@


1.83
log
@Remove support for tape block devices. Nobody mount(8)s tapes any longer.
ok deraadt@@ guenther@@
@
text
@/*	$OpenBSD: conf.c,v 1.82 2016/09/02 17:06:12 goda Exp $	*/
/*	$NetBSD: conf.c,v 1.16 1996/10/18 21:26:57 cgd Exp $	*/

/*-
 * Copyright (c) 1991 The Regents of the University of California.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. Neither the name of the University nor the names of its contributors
 *    may be used to endorse or promote products derived from this software
 *    without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 *
 *      @@(#)conf.c	7.9 (Berkeley) 5/28/91
 */

#include <sys/param.h>
#include <sys/systm.h>
#include <sys/buf.h>
#include <sys/ioctl.h>
#include <sys/tty.h>
#include <sys/conf.h>
#include <sys/vnode.h>

#include "wd.h"
bdev_decl(wd);
#include "fd.h"
bdev_decl(fd);
#include "st.h"
#include "cd.h"
#include "sd.h"
#include "uk.h"
#include "vnd.h"
#include "rd.h"
#include "bktr.h"
#include "radio.h"

struct bdevsw	bdevsw[] =
{
	bdev_disk_init(NWD,wd),	        /* 0: ST506/ESDI/IDE disk */
	bdev_swap_init(1,sw),		/* 1: swap pseudo-device */
	bdev_notdef(),			/* 2: was: SCSI tape */
	bdev_disk_init(NCD,cd),		/* 3: SCSI CD-ROM */
	bdev_disk_init(NFD,fd),		/* 4: Floppy disk */
	bdev_notdef(),			/* 5 */
	bdev_disk_init(NRD,rd),		/* 6: ram disk driver */
	bdev_notdef(),			/* 7: was: concatenated disk driver */
	bdev_disk_init(NSD,sd),		/* 8: SCSI disk */
	bdev_disk_init(NVND,vnd),	/* 9: vnode disk driver */
	bdev_notdef(),			/* 10 */
	bdev_notdef(),			/* 11 */
	bdev_notdef(),			/* 12 */
	bdev_notdef(),			/* 13 */
	bdev_notdef(),			/* 14 */
	bdev_notdef(),			/* 15 */
	bdev_notdef(),			/* 16 was: RAIDframe disk driver */
};
int	nblkdev = nitems(bdevsw);

#define	mmread  mmrw
#define	mmwrite mmrw
cdev_decl(mm);
#include "pty.h"
#include "tun.h"
#include "bpfilter.h"
#include "ch.h"
#include "scc.h"
cdev_decl(scc);
#include "audio.h"
#include "video.h"
#include "com.h"
cdev_decl(com);
#include "wsdisplay.h"
#include "wskbd.h"
#include "wsmouse.h"
#include "wsmux.h"
#include "midi.h"
cdev_decl(midi);

#include "spkr.h"
cdev_decl(spkr);

#include "bio.h"
#include "lpt.h"
cdev_decl(lpt);
cdev_decl(prom);			/* XXX XXX XXX */
cdev_decl(wd);
cdev_decl(fd);
#include "cy.h"
cdev_decl(cy);
#include "ksyms.h"

/* USB Devices */
#include "usb.h"
#include "uhid.h"
#include "ugen.h"
#include "ulpt.h"
#include "ucom.h"
#include "pf.h"
#ifdef USER_PCICONF
#include "pci.h"
cdev_decl(pci);
#endif

#include "hotplug.h"
#include "vscsi.h"
#include "pppx.h"
#include "fuse.h"
#include "switch.h"

struct cdevsw	cdevsw[] =
{
	cdev_cn_init(1,cn),		/* 0: virtual console */
	cdev_ctty_init(1,ctty),		/* 1: controlling terminal */
	cdev_mm_init(1,mm),		/* 2: /dev/{null,mem,kmem,...} */
	cdev_notdef(),			/* 3 was /dev/drum */
	cdev_tty_init(NPTY,pts),	/* 4: pseudo-tty slave */
	cdev_ptc_init(NPTY,ptc),	/* 5: pseudo-tty master */
	cdev_log_init(1,log),		/* 6: /dev/klog */
	cdev_tun_init(NTUN,tun),	/* 7: network tunnel */
	cdev_disk_init(NSD,sd),		/* 8: SCSI disk */
	cdev_disk_init(NVND,vnd),	/* 9: vnode disk driver */
	cdev_fd_init(1,filedesc),	/* 10: file descriptor pseudo-dev */
	cdev_bpf_init(NBPFILTER,bpf),	/* 11: Berkeley packet filter */
	cdev_tape_init(NST,st),		/* 12: SCSI tape */
	cdev_disk_init(NCD,cd),		/* 13: SCSI CD-ROM */
	cdev_ch_init(NCH,ch),		/* 14: SCSI autochanger */
	cdev_tty_init(NSCC,scc),	/* 15: scc 8530 serial interface */
	cdev_notdef(),			/* 16 was lkm */
	cdev_notdef(),			/* 17 */
	cdev_notdef(),			/* 18 */
	cdev_notdef(),			/* 19 */
	cdev_notdef(),			/* 20 */
	cdev_notdef(),			/* 21 */
	cdev_notdef(),			/* 22 */
	cdev_tty_init(1,prom),          /* 23: XXX prom console */
	cdev_audio_init(NAUDIO,audio),	/* 24: generic audio I/O */
	cdev_wsdisplay_init(NWSDISPLAY,wsdisplay), /* 25: workstation console */
	cdev_tty_init(NCOM,com),	/* 26: ns16550 UART */
	cdev_notdef(),			/* 27: was: concatenated disk driver */
	cdev_disk_init(NRD,rd),		/* 28: ram disk driver */
	cdev_mouse_init(NWSKBD,wskbd),	/* 29: /dev/kbd XXX */
	cdev_mouse_init(NWSMOUSE,wsmouse),	/* 30: /dev/mouse XXX */
	cdev_lpt_init(NLPT,lpt),	/* 31: parallel printer */
	cdev_notdef(),			/* 32: */
	cdev_uk_init(NUK,uk),		/* 33: SCSI unknown */
	cdev_random_init(1,random),	/* 34: random data source */
	cdev_pf_init(NPF, pf),		/* 35: packet filter */
	cdev_disk_init(NWD,wd), 	/* 36: ST506/ESDI/IDE disk */
	cdev_disk_init(NFD,fd),		/* 37: Floppy disk */
        cdev_tty_init(NCY,cy),          /* 38: Cyclom serial port */
	cdev_ksyms_init(NKSYMS,ksyms),	/* 39: Kernel symbols device */
	cdev_spkr_init(NSPKR,spkr),	/* 40: PC speaker */
	cdev_midi_init(NMIDI,midi),     /* 41: MIDI I/O */
        cdev_notdef(),   		/* 42 was: sequencer I/O */
	cdev_notdef(),			/* 43 was: RAIDframe disk driver */
	cdev_video_init(NVIDEO,video),	/* 44: generic video I/O */
	cdev_usb_init(NUSB,usb),	/* 45: USB controller */
	cdev_usbdev_init(NUHID,uhid),	/* 46: USB generic HID */
	cdev_ulpt_init(NULPT,ulpt),	/* 47: USB printer */
	cdev_usbdev_init(NUGEN,ugen),	/* 48: USB generic driver */
	cdev_tty_init(NUCOM, ucom),	/* 49: USB tty */
	cdev_notdef(),			/* 50 */
	cdev_notdef(),			/* 51 */
#ifdef USER_PCICONF
	cdev_pci_init(NPCI,pci),	/* 52: PCI user */
#else
	cdev_notdef(),
#endif
	cdev_bio_init(NBIO,bio),	/* 53: ioctl tunnel */
	cdev_notdef(),
	cdev_ptm_init(NPTY,ptm),	/* 55: pseudo-tty ptm device */
	cdev_hotplug_init(NHOTPLUG,hotplug), /* 56: devices hot plugging */
	cdev_notdef(),			/* 57: was: /dev/crypto */
	cdev_bktr_init(NBKTR,bktr),	/* 58: Bt848 video capture device */
	cdev_radio_init(NRADIO,radio), /* 59: generic radio I/O */
	cdev_mouse_init(NWSMUX, wsmux),	/* 60: ws multiplexor */
	cdev_vscsi_init(NVSCSI, vscsi),	/* 61: vscsi */
	cdev_notdef(),
	cdev_disk_init(1,diskmap),	/* 63: disk mapper */
	cdev_pppx_init(NPPPX,pppx),	/* 64: pppx */
	cdev_notdef(),			/* 65: was urio */
	cdev_notdef(),			/* 66: was USB scanners */
	cdev_fuse_init(NFUSE,fuse),	/* 67: fuse */
	cdev_tun_init(NTUN,tap),	/* 68: Ethernet network tunnel */
	cdev_switch_init(NSWITCH,switch), /* 69: switch(4) control interface */
};
int	nchrdev = nitems(cdevsw);

int	mem_no = 2; 	/* major device number of memory special file */

/*
 * Swapdev is a fake device implemented
 * in sw.c used only internally to get to swstrategy.
 * It cannot be provided to the users, because the
 * swstrategy routine munches the b_dev and b_blkno entries
 * before calling the appropriate driver.  This would horribly
 * confuse, e.g. the hashing routines. Instead, /dev/drum is
 * provided as a character (raw) device.
 */
dev_t	swapdev = makedev(1, 0);

/*
 * Returns true if dev is /dev/mem or /dev/kmem.
 */
int
iskmemdev(dev)
	dev_t dev;
{

	return (major(dev) == mem_no && minor(dev) < 2);
}

/*
 * Returns true if dev is /dev/zero.
 */
int
iszerodev(dev)
	dev_t dev;
{

	return (major(dev) == mem_no && minor(dev) == 12);
}

dev_t
getnulldev()
{
	return makedev(mem_no, 2);
}

int chrtoblktbl[] = {
	/*VCHR*/	/*VBLK*/
	/*  0 */	NODEV,
	/*  1 */	NODEV,
	/*  2 */	NODEV,
	/*  3 */	NODEV,
	/*  4 */	NODEV,
	/*  5 */	NODEV,
	/*  6 */	NODEV,
	/*  7 */	NODEV,
	/*  8 */	8,		/* sd */
	/*  9 */	9,		/* vnd */
	/* 10 */	NODEV,
	/* 11 */	NODEV,
	/* 12 */	NODEV,
	/* 13 */	3,		/* cd */
	/* 14 */	NODEV,
	/* 15 */	NODEV,
	/* 16 */	NODEV,
	/* 17 */	NODEV,
	/* 18 */	NODEV,
	/* 19 */	NODEV,
	/* 20 */	NODEV,
	/* 21 */	NODEV,
	/* 22 */	NODEV,
	/* 23 */	NODEV,
	/* 24 */	NODEV,
	/* 25 */	NODEV,
	/* 26 */	NODEV,
	/* 27 */	NODEV,
	/* 28 */	6,		/* rd */
	/* 29 */	NODEV,
	/* 30 */	NODEV,
	/* 31 */	NODEV,
	/* 32 */	NODEV,
	/* 33 */	NODEV,
	/* 34 */	NODEV,
	/* 35 */	NODEV,
	/* 36 */	0,
	/* 37 */	4,		/* fd */
};
int nchrtoblktbl = nitems(chrtoblktbl);
@


1.82
log
@Add switch(4) cdev entry

ok deraadt@@ yasuoka@@ reyk@@
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.81 2016/04/25 20:09:14 tedu Exp $	*/
d60 1
a60 1
	bdev_tape_init(NST,st),		/* 2: SCSI tape */
d263 1
a263 1
	/* 12 */	2,		/* st */
@


1.81
log
@remove systrace
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.80 2016/02/26 09:10:04 natano Exp $	*/
d127 1
d204 1
@


1.80
log
@Remove stale RAIDframe entries from chrtoblktbl.

While there truncate the tables to the minimum required size; chrtoblk()
and blktochr() are designed to handle a table shorter than cdevsw.

"Looks good to me" deraadt@@
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.79 2015/10/23 15:10:52 claudio Exp $	*/
a122 1
#include "systrace.h"
d180 1
a180 1
	cdev_systrace_init(NSYSTRACE,systrace),	/* 50 system call tracing */
@


1.79
log
@Allocate a new major for tap(4) also note that pseudo-device tun is for tap
as well. OK dlg@@ mpi@@
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.78 2014/12/11 19:44:16 tedu Exp $	*/
a287 14
	/* 38 */	NODEV,
	/* 39 */	NODEV,
	/* 40 */	NODEV,
	/* 41 */	NODEV,
	/* 42 */	NODEV,
	/* 43 */	16,		/* raid */
	/* 44 */	NODEV,
	/* 45 */	NODEV,
	/* 46 */	NODEV,
	/* 47 */	NODEV,
	/* 48 */	NODEV,
	/* 49 */	NODEV,
	/* 50 */	NODEV,
	/* 51 */	NODEV,
@


1.78
log
@dragonflybsd has added a urio driver. conservation of urios requires
that we delete ours, which isn't actually useful.
ok mpi sthen
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.77 2014/10/09 04:10:03 tedu Exp $	*/
d203 1
@


1.77
log
@mechanical translation of dev_lkm_dummy() to dev_notdef()
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.76 2014/10/09 03:59:58 tedu Exp $	*/
a115 1
#include "urio.h"
d200 1
a200 1
	cdev_urio_init(NURIO,urio),	/* 65: USB Diamond Rio 500 */
@


1.76
log
@remove LKM devices
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.75 2014/08/20 06:14:42 mikeb Exp $	*/
d68 6
a73 6
	bdev_lkm_dummy(),		/* 10 */
	bdev_lkm_dummy(),		/* 11 */
	bdev_lkm_dummy(),		/* 12 */
	bdev_lkm_dummy(),		/* 13 */
	bdev_lkm_dummy(),		/* 14 */
	bdev_lkm_dummy(),		/* 15 */
d149 6
a154 6
	cdev_lkm_dummy(),		/* 17 */
	cdev_lkm_dummy(),		/* 18 */
	cdev_lkm_dummy(),		/* 19 */
	cdev_lkm_dummy(),		/* 20 */
	cdev_lkm_dummy(),		/* 21 */
	cdev_lkm_dummy(),		/* 22 */
@


1.75
log
@unlink crypto(4) pseudo device from the architecture dependant character
device tables and kernel config files.  ok deraadt
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.74 2013/11/04 17:14:26 deraadt Exp $	*/
d148 1
a148 1
	cdev_lkm_init(NLKM,lkm),	/* 16: loadable module driver */
a248 1
	/* XXXX This needs to be dynamic for LKMs. */
@


1.74
log
@more iop.h left; Mark Patruck
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.73 2013/11/04 14:11:27 deraadt Exp $	*/
a42 2
#include "inet.h"

d193 1
a193 1
	cdev_crypto_init(NCRYPTO,crypto), /* 57: /dev/crypto */
@


1.73
log
@remove iop(4) driver.  it is entirely unmaintained and supports something
which basically doesn't exist at all.
reminded about it by brad
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.72 2013/08/20 14:27:24 ajacoutot Exp $	*/
a85 1
#include "iop.h"
@


1.72
log
@Remove uscanner(4). It was disabled in GENERIC more than 2.5 years ago.
No regression has been reported since libusb became the prefered
solution to work with USB scanners.

req. by mpi@@
ok ian@@ mpi@@ miod@@
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.71 2013/06/03 15:54:47 tedu Exp $	*/
a125 1
#include "bthub.h"
d193 1
a193 1
	cdev_iop_init(NIOP, iop),	/* 54: I2O IOP control interface */
d201 1
a201 1
	cdev_bthub_init(NBTHUB, bthub), /* 62: bthub */
@


1.71
log
@changes for isc fuse support. not enabled. ok beck deraadt.
from Sylvestre Gallon ccna.syl gmail.com
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.70 2013/03/15 09:10:52 ratchov Exp $	*/
a120 1
#include "uscanner.h"
d206 1
a206 1
	cdev_usbdev_init(NUSCANNER,uscanner),	/* 66: USB scanners */
@


1.70
log
@Delete the sequencer(4) driver, since its not used any longer. Diff
mostly from armani.
ok miod, mpi, jsg and help from sthen
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.69 2012/08/23 06:12:49 deraadt Exp $	*/
d133 1
d208 1
@


1.69
log
@kill nnpfs dead
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.68 2012/04/06 15:10:39 jsing Exp $	*/
a99 2
#include "sequencer.h"
cdev_decl(music);
d178 1
a178 1
        cdev_midi_init(NSEQUENCER,sequencer),   /* 42: sequencer I/O */
@


1.68
log
@tedu the raidframe.

ok deraadt@@
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.66 2011/01/14 19:04:08 jasper Exp $	*/
a113 4
#ifdef NNPFS
#include <nnpfs/nnnpfs.h>
cdev_decl(nnpfs_dev);
#endif
a188 3
#ifdef NNPFS
	cdev_nnpfs_init(NNNPFS,nnpfs_dev),/* 51: nnpfs communication device */
#else
a189 1
#endif
@


1.67
log
@ccd goes to the attic
discussed with jsing and millert
@
text
@a53 1
#include "raid.h"
d76 1
a76 1
	bdev_disk_init(NRAID,raid),	/* 16 */
d185 1
a185 1
	cdev_disk_init(NRAID,raid),	/* 43: RAIDframe disk driver */
@


1.66
log
@- use nitems()

"doesn't hurt" deraadt@@
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.65 2010/11/19 20:55:48 miod Exp $	*/
a54 1
#include "ccd.h"
d68 1
a68 1
	bdev_disk_init(NCCD,ccd),	/* 7: concatenated disk driver */
d170 1
a170 1
	cdev_disk_init(NCCD,ccd),	/* 27: concatenated disk driver */
d292 1
a292 1
	/* 27 */	7,		/* ccd */
@


1.65
log
@Sync MAKEDEV against conf.c, and both against GENERIC.
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.64 2010/09/23 05:02:14 claudio Exp $	*/
d80 1
a80 1
int	nblkdev = sizeof (bdevsw) / sizeof (bdevsw[0]);
d220 1
a220 1
int	nchrdev = sizeof (cdevsw) / sizeof (cdevsw[0]);
d319 1
a319 1
int nchrtoblktbl = sizeof(chrtoblktbl) / sizeof(chrtoblktbl[0]);
@


1.64
log
@Add pppx(4) to the cdevs of the remaining archs.
OK dlg@@
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.63 2010/07/03 03:59:16 krw Exp $	*/
d127 1
d129 1
d217 2
@


1.63
log
@No more ss(4) or usscanner(4). Unused, unloved and unmaintained.
General huzzahs.

"go for it" deraadt@@
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.62 2010/06/09 15:25:32 jsing Exp $	*/
d138 1
d214 1
@


1.62
log
@Wire up device nodes for disk mapper.

ok deraadt@@
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.60 2009/08/13 15:04:20 dlg Exp $	*/
a51 1
#include "ss.h"
d173 1
a173 1
	cdev_scanner_init(NSS,ss),	/* 32: SCSI scanner */
@


1.61
log
@Add missing bthub device entries on arches that support bluetooth.
ok miod@@, deraadt@@, todd@@.
@
text
@d213 1
@


1.60
log
@wire vscsi up to a cdev

for claudio@@ ok deraadt@@
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.59 2009/06/03 14:45:50 jj Exp $	*/
d134 1
d212 1
@


1.59
log
@Arla client rename from xfs to nnpfs for later upgrades. Tested on various arches. ok todd@@ beck@@
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.58 2009/01/25 17:30:48 miod Exp $	*/
d137 1
d210 1
@


1.58
log
@Remove /dev/drum and related code.
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.57 2008/06/12 20:03:48 mglocker Exp $	*/
d117 3
a119 3
#ifdef XFS
#include <xfs/nxfs.h>
cdev_decl(xfs_dev);
d191 2
a192 2
#ifdef XFS
	cdev_xfs_init(NXFS,xfs_dev),	/* 51: xfs communication device */
@


1.57
log
@Enable /dev/video* for all USB capable archs.  MAKEDEV bits will follow
shortly.

OK todd@@
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.56 2008/04/08 14:31:54 claudio Exp $	*/
d143 1
a143 1
	cdev_swap_init(1,sw),		/* 3: /dev/drum (swap pseudo-device) */
@


1.56
log
@Split the cdev makro for bpftun into two seperate definitions. tun(4) and
bpf(4) are different enough so that the split makes sense -- this is necessary
to make bpf(4) cloneable.
requested deraadt@@, OK thib@@
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.55 2007/06/20 18:28:56 miod Exp $	*/
d94 1
d184 1
a184 1
	cdev_notdef(),			/* 44 */
@


1.55
log
@alpha kernel have wsmux but not the actual devices; PR #5469 from janjaap
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.54 2007/05/28 22:26:03 todd Exp $	*/
d146 1
a146 1
	cdev_bpftun_init(NTUN,tun),	/* 7: network tunnel */
d150 1
a150 1
	cdev_bpftun_init(NBPFILTER,bpf),/* 11: Berkeley packet filter */
@


1.54
log
@bio for all archs, ok krw@@ kettenis@@ sounds good marco@@ go for it deraadt@@
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.53 2007/05/27 01:50:36 todd Exp $	*/
d99 1
d207 1
@


1.53
log
@back out bio, breaks dlg's sparc64 v215
prompted by/ok dlg@@ deraadt@@
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.52 2007/05/26 19:54:24 todd Exp $	*/
d107 1
d199 1
a199 1
	cdev_notdef(),			/* 53: ALTQ (deprecated) */
@


1.52
log
@prodded by marco, enable bio everywhere
grudgingly ok deraadt@@
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.51 2005/11/15 14:36:48 robert Exp $	*/
a106 1
#include "bio.h"
d181 1
a181 1
	cdev_bio_init(NBIO,bio),	/* 44: ioctl tunnel */
@


1.51
log
@enable bktr(4) and radio(4) on alpha

ok deraadt@@ mickey@@
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.50 2004/06/18 20:35:50 miod Exp $	*/
d107 1
d182 1
a182 1
	cdev_notdef(),			/* 44 */
@


1.50
log
@Add /dev/crypto support.
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.49 2004/05/30 08:11:25 grange Exp $	*/
d58 2
d203 2
@


1.49
log
@Devices hot plugging support.
The hotplug pseudo-device passes device attachment and detachment events
to userland.  When a device attaches or detaches, the corresponding event
is queued.  The events can then be obtained from the queue through the
read(2) call on the /dev/hotplug device file. Each event consists of
event type (attach/detach), device class (DV_*) and device name (sd1 e.g.).

We have hotplug pseudo-device on alpha, amd64, i386, macppc and sparc64.
Since it was tested only on i386 other archs has it commented out
in GENERIC until tested.

The idea liked peter@@ tedu@@ drahn@@ millert@@ marco@@ henning@@.
Ok deraadt@@.
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.48 2004/02/10 01:31:20 millert Exp $	*/
d43 2
d200 1
@


1.48
log
@Add the ptm device to pty(4).  By opening /dev/ptm and using the PTMGET
ioctl(2), an unprivileged process may allocate a pty and have its owner
and mode set appropriately.  This means that programs such as xterm and
screen no longer need to be setuid.  Programs using the openpty()
function require zero changes and will "just work".

Designed by beck@@ and deraadt@@; changes by beck@@ with cleanup (and
a rewrite of the vnode bits) by art@@ and tweaks/bugfixes by me.
Tested by many.
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.47 2003/06/02 23:27:43 millert Exp $	*/
d129 1
d197 1
@


1.47
log
@Remove the advertising clause in the UCB license which Berkeley
rescinded 22 July 1999.  Proofed by myself and Theo.
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.46 2003/05/14 00:20:37 tedu Exp $	*/
d195 1
@


1.46
log
@add {b,c}devsw_lookup convenience functions.
move chrtoblk and blktochr into MI code.
tested on several archs and ok deraadt@@
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.45 2002/12/05 02:49:55 kjc Exp $	*/
d16 1
a16 5
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 *	This product includes software developed by the University of
 *	California, Berkeley and its contributors.
 * 4. Neither the name of the University nor the names of its contributors
@


1.45
log
@remove altq entries.
altq is merged into pf and handled through pf.
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.44 2002/07/10 22:08:47 mickey Exp $	*/
d243 1
a243 1
static int chrtoblktbl[] = {
d299 1
a299 36

/*
 * Convert a character device number to a block device number.
 */
dev_t
chrtoblk(dev)
	dev_t dev;
{
	int blkmaj;

	if (major(dev) >= nchrdev ||
	    major(dev) > sizeof(chrtoblktbl)/sizeof(chrtoblktbl[0]))
		return (NODEV);
	blkmaj = chrtoblktbl[major(dev)];
	if (blkmaj == NODEV)
		return (NODEV);
	return (makedev(blkmaj, minor(dev)));
}

/*
 * Convert a block device number to a character device number.
 */
dev_t
blktochr(dev)
	dev_t dev;
{
	int blkmaj = major(dev);
	int i;

	if (blkmaj >= nblkdev)
		return (NODEV);
	for (i = 0; i < sizeof(chrtoblktbl)/sizeof(chrtoblktbl[0]); i++)
		if (blkmaj == chrtoblktbl[i])
			return (makedev(i, minor(dev)));
	return (NODEV);
}
@


1.44
log
@proper cdev_decl(ksyms), fix ksyms's broken functions
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.43 2002/06/24 19:00:33 mickey Exp $	*/
a131 2
#include <altq/altqconf.h>

d197 1
a197 1
	cdev_altq_init(NALTQ, altq),	/* 53: ALTQ control interface */
@


1.43
log
@move cdev_decl() for usb devices into one place.
usage of cdev_decl() in the driver code is more tricky since i have
kqueue mods here and there and will fix that on that way through.
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.42 2002/06/19 02:52:23 mickey Exp $	*/
a118 1
cdev_decl(ksyms);
@


1.42
log
@using cdev_ugen_init for all sorts of usb devices is just one pint less wrong than using cdev_decl_random for the same purpose
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.41 2002/06/11 05:15:17 miod Exp $	*/
a122 1
cdev_decl(usb);
a123 1
cdev_decl(uhid);
a124 1
cdev_decl(ugen);
a125 1
cdev_decl(ulpt);
a126 1
cdev_decl(ucom);
@


1.41
log
@Move cdev_lpt_init() to a common location.
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.40 2002/06/11 04:53:39 miod Exp $	*/
d192 1
a192 1
	cdev_ugen_init(NUGEN,ugen),	/* 48: USB generic driver */
@


1.40
log
@No need to cdev_decl(ugen) twice.
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.39 2002/06/11 03:30:15 miod Exp $	*/
a81 6

/* open, close, write, ioctl */
#define cdev_lpt_init(c,n) { \
	dev_init(c,n,open), dev_init(c,n,close), (dev_type_read((*))) enodev, \
	dev_init(c,n,write), dev_init(c,n,ioctl), (dev_type_stop((*))) enodev, \
	0, seltrue, (dev_type_mmap((*))) enodev }
@


1.39
log
@Setup the ulpt device structures with cdev_ulpt_init, not cdev_lpt_init.
And yes, they are different macros with different results.
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.38 2002/05/16 21:11:10 miod Exp $	*/
a137 2
#include "ugen.h"
cdev_decl(ugen);
@


1.38
log
@Add systrace support to all the remaining architectures.

Tested by various people on various platforms, I'm willing to fix any
breakage this causes.

ok niels@@ deraadt@@ and mickey@@ (after his comments were applied)
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.37 2002/01/23 05:21:03 ericj Exp $	*/
d199 1
a199 1
	cdev_lpt_init(NULPT,ulpt),	/* 47: USB printer */
@


1.37
log
@
add midi and sequencer devices
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.36 2002/01/23 05:06:39 ericj Exp $	*/
d148 2
d202 1
a202 1
	cdev_notdef(),			/* 50 */
@


1.36
log
@
enable spkr, isabeep devices
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.35 2001/12/11 23:18:59 miod Exp $	*/
d105 4
d190 3
a192 3
	cdev_notdef(),			/* 40 */
	cdev_spkr_init(NSPKR,spkr),	/* 41: PC speaker */
	cdev_notdef(),			/* 42 */
@


1.35
log
@Remove declarations that already exist in <sys/conf.h>
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.34 2001/10/26 01:28:06 nate Exp $	*/
d105 4
d187 1
a187 1
	cdev_notdef(),			/* 41 */
@


1.35.2.1
log
@Merge in -current, builds on i386, otherwise untested
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.37 2002/01/23 05:21:03 ericj Exp $	*/
a104 8
#include "midi.h"
cdev_decl(midi);
#include "sequencer.h"
cdev_decl(music);

#include "spkr.h"
cdev_decl(spkr);

d182 3
a184 3
	cdev_spkr_init(NSPKR,spkr),	/* 40: PC speaker */
	cdev_midi_init(NMIDI,midi),     /* 41: MIDI I/O */
        cdev_midi_init(NSEQUENCER,sequencer),   /* 42: sequencer I/O */
@


1.35.2.2
log
@Sync UBC branch to -current
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.35.2.1 2002/01/31 22:55:04 niklas Exp $	*/
a147 2
#include "systrace.h"

d200 1
a200 1
	cdev_systrace_init(NSYSTRACE,systrace),	/* 50 system call tracing */
@


1.35.2.3
log
@sync to -current
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.35.2.2 2002/06/11 03:33:39 art Exp $	*/
d83 6
d125 1
d129 1
d131 1
d133 1
d135 1
d137 3
d199 2
a200 2
	cdev_ulpt_init(NULPT,ulpt),	/* 47: USB printer */
	cdev_usbdev_init(NUGEN,ugen),	/* 48: USB generic driver */
@


1.35.2.4
log
@sync
@
text
@d1 1
a1 1
/*	$OpenBSD$	*/
d132 2
d199 1
a199 1
	cdev_notdef(),			/* 53: ALTQ (deprecated) */
d245 1
a245 1
int chrtoblktbl[] = {
d301 36
a336 1
int nchrtoblktbl = sizeof(chrtoblktbl) / sizeof(chrtoblktbl[0]);
@


1.34
log
@First cut at a port of isadma and floppy driver.  ok art@@
From NetBSD via jay@@rootaction.net
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.33 2001/10/26 00:41:46 nate Exp $	*/
a93 1
dev_type_open(filedescopen);
d295 1
a295 1
	/* 43 */	16,
@


1.33
log
@fix comment
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.32 2001/09/28 03:33:39 mickey Exp $	*/
d49 2
d67 1
a67 1
	bdev_notdef(),			/* 4 */
d110 1
d180 1
a180 1
	cdev_notdef(),			/* 37 */
d290 1
a290 1
	/* 37 */	4,
@


1.32
log
@remove dups w/ conf.h
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.31 2001/09/28 02:53:13 mickey Exp $	*/
d323 1
a323 1
 * Convert a character device number to a block device number.
@


1.31
log
@move cdev_decl(pf) into it's proper place, kill cdev_decl(ipl) at the same time
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.30 2001/08/06 22:34:43 mickey Exp $	*/
a55 1
bdev_decl(raid);
a57 1
bdev_decl(rd);
a98 1
cdev_decl(audio);
a105 1
cdev_decl(rd);
@


1.30
log
@remove vm_conf.h; art@@ ok
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.29 2001/07/05 02:40:43 mickey Exp $	*/
a134 1
cdev_decl(pf);
@


1.29
log
@add iop
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.28 2001/06/27 06:16:39 angelos Exp $	*/
a48 1
bdev_decl(sw);
a91 1
cdev_decl(sw);
@


1.28
log
@Remove IPF references; openbsd@@davidkrause.com
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.27 2001/06/27 05:50:03 kjc Exp $	*/
d98 1
a111 1
cdev_decl(raid);
d209 1
@


1.27
log
@ALTQ base modifications to the kernel.
 - ALTQ introduces a set of new queue macros that coexist with the
   traditional IF_XXX macros.
 - "struct ifaltq" replaces "struct ifqueue" in "struct ifnet".
 - assign cdev major 74 for i386 and 54 for alpha as ALTQ control interface.
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.26 2001/06/26 20:24:10 art Exp $	*/
a111 5
#ifdef IPFILTER
#define NIPF 1
#else
#define NIPF 0
#endif
@


1.26
log
@USER_PCICONF
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.25 2001/06/25 03:19:39 kjell Exp $	*/
d148 2
d213 1
@


1.25
log
@add pf device on all architectures.
fix my previously bogus MAKEDEVs.
If you used pf on a non-i386. the major device number has changed,
and you'll need to recreate /dev/pf
ok theo
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.24 2001/06/24 21:19:08 art Exp $	*/
d143 4
d205 5
@


1.24
log
@Add pf.
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.23 2001/03/08 02:36:01 ericj Exp $	*/
d181 1
a181 1
	cdev_gen_ipf(NIPF,ipl),		/* 35: IP filter log */
a201 1
	cdev_pf_init(NPF, pf),		/* 52: packet filter */
@


1.23
log
@
configure usb devices and raid
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.22 2000/09/26 14:03:51 art Exp $	*/
d141 2
d202 1
@


1.22
log
@Implement getnulldev that returns the dev_t for "/dev/null".
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.21 2000/07/03 19:30:13 mickey Exp $	*/
d56 2
d80 1
d111 1
d128 14
d187 1
a187 1
	cdev_notdef(),			/* 43 */
d189 5
a193 5
	cdev_notdef(),			/* 45 */
	cdev_notdef(),			/* 46 */
	cdev_notdef(),			/* 47 */
	cdev_notdef(),			/* 48 */
	cdev_notdef(),			/* 49 */
d285 14
@


1.21
log
@closer approximation to an alpha using new wscons.
tga moved to dev/pci.
by request from alpha people.
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.20 1999/07/30 19:05:49 deraadt Exp $	*/
d218 6
@


1.20
log
@acd goes away
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.19 1999/07/25 04:38:25 csapuntz Exp $	*/
a80 6
/* open, close, read, write, ioctl, tty, mmap */
#define cdev_wscons_init(c,n) { \
	dev_init(c,n,open), dev_init(c,n,close), dev_init(c,n,read), \
	dev_init(c,n,write), dev_init(c,n,ioctl), dev_init(c,n,stop), \
	dev_init(c,n,tty), ttselect /* ttpoll */, dev_init(c,n,mmap), D_TTY }

a99 2
#include "wscons.h"
cdev_decl(wscons);
d102 3
a104 2
cdev_decl(kbd);
cdev_decl(ms);
d151 1
a151 1
	cdev_wscons_init(NWSCONS,wscons), /* 25: workstation console */
d155 2
a156 2
	cdev_mouse_init(NWSCONS,kbd),	/* 29: /dev/kbd XXX */
	cdev_mouse_init(NWSCONS,ms),	/* 30: /dev/mouse XXX */
@


1.20.4.1
log
@Update the SMP branch to -current, this breaks the SMP branch though.
But it will be fixed soonish.  Note, nothing new has happened, this is just
a merge of the trunk into this branch.
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.23 2001/03/08 02:36:01 ericj Exp $	*/
a55 2
#include "raid.h"
bdev_decl(raid);
a77 1
	bdev_disk_init(NRAID,raid),	/* 16 */
d81 6
d106 2
d110 2
a111 3
#include "wsdisplay.h"
#include "wskbd.h"
#include "wsmouse.h"
a114 1
cdev_decl(raid);
a130 14
/* USB Devices */
#include "usb.h"
cdev_decl(usb);
#include "uhid.h"
cdev_decl(uhid);
#include "ugen.h"
cdev_decl(ugen);
#include "ulpt.h"
cdev_decl(ulpt);
#include "ucom.h"
cdev_decl(ucom);
#include "ugen.h"
cdev_decl(ugen);

d158 1
a158 1
	cdev_wsdisplay_init(NWSDISPLAY,wsdisplay), /* 25: workstation console */
d162 2
a163 2
	cdev_mouse_init(NWSKBD,wskbd),	/* 29: /dev/kbd XXX */
	cdev_mouse_init(NWSMOUSE,wsmouse),	/* 30: /dev/mouse XXX */
d176 1
a176 1
	cdev_disk_init(NRAID,raid),	/* 43: RAIDframe disk driver */
d178 5
a182 5
	cdev_usb_init(NUSB,usb),	/* 45: USB controller */
	cdev_usbdev_init(NUHID,uhid),	/* 46: USB generic HID */
	cdev_lpt_init(NULPT,ulpt),	/* 47: USB printer */
	cdev_ugen_init(NUGEN,ugen),	/* 48: USB generic driver */
	cdev_tty_init(NUCOM, ucom),	/* 49: USB tty */
a226 6
dev_t
getnulldev()
{
	return makedev(mem_no, 2);
}

a267 14
	/* 38 */	NODEV,
	/* 39 */	NODEV,
	/* 40 */	NODEV,
	/* 41 */	NODEV,
	/* 42 */	NODEV,
	/* 43 */	16,
	/* 44 */	NODEV,
	/* 45 */	NODEV,
	/* 46 */	NODEV,
	/* 47 */	NODEV,
	/* 48 */	NODEV,
	/* 49 */	NODEV,
	/* 50 */	NODEV,
	/* 51 */	NODEV,
@


1.20.4.2
log
@Merge in -current from two days ago in the SMP branch.
As usual with merges, they do not indicate progress, so do not hold
your breath for working SMP, and do not mail me and ask about the
state of it.  It has not changed.  There is work ongoing, but very, very
slowly.  The commit is done in parts as to not lock up the tree in too
big chunks at a time.
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.20.4.1 2001/04/18 16:00:09 niklas Exp $	*/
d112 5
a140 8
#include "pf.h"
cdev_decl(pf);
#ifdef USER_PCICONF
#include "pci.h"
cdev_decl(pci);
#endif

#include <altq/altqconf.h>
d179 1
a179 1
	cdev_pf_init(NPF, pf),		/* 35: packet filter */
a199 6
#ifdef USER_PCICONF
	cdev_pci_init(NPCI,pci),	/* 52: PCI user */
#else
	cdev_notdef(),
#endif
	cdev_altq_init(NALTQ, altq),	/* 53: ALTQ control interface */
@


1.20.4.3
log
@Sync the SMP branch to something just after 3.0
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.20.4.2 2001/07/04 10:14:19 niklas Exp $	*/
d49 1
a49 2
#include "fd.h"
bdev_decl(fd);
d57 1
d60 1
d68 1
a68 1
	bdev_disk_init(NFD,fd),		/* 4: Floppy disk */
d93 1
a97 1
#include "iop.h"
d102 1
d110 2
a113 1
cdev_decl(fd);
d137 1
d184 1
a184 1
	cdev_disk_init(NFD,fd),		/* 37: Floppy disk */
a208 1
	cdev_iop_init(NIOP, iop),	/* 54: I2O IOP control interface */
d293 1
a293 1
	/* 37 */	4,		/* fd */
d329 1
a329 1
 * Convert a block device number to a character device number.
@


1.20.4.4
log
@Merge in trunk
@
text
@d1 1
a1 1
/*	$OpenBSD$	*/
d94 1
a105 8
#include "midi.h"
cdev_decl(midi);
#include "sequencer.h"
cdev_decl(music);

#include "spkr.h"
cdev_decl(spkr);

d183 3
a185 3
	cdev_spkr_init(NSPKR,spkr),	/* 40: PC speaker */
	cdev_midi_init(NMIDI,midi),     /* 41: MIDI I/O */
        cdev_midi_init(NSEQUENCER,sequencer),   /* 42: sequencer I/O */
d296 1
a296 1
	/* 43 */	16,		/* raid */
@


1.20.4.5
log
@Sync the SMP branch with 3.3
@
text
@d83 6
d125 1
d129 1
d131 1
d133 1
d135 1
d137 3
d146 1
a146 1
#include "systrace.h"
d197 2
a198 2
	cdev_ulpt_init(NULPT,ulpt),	/* 47: USB printer */
	cdev_usbdev_init(NUGEN,ugen),	/* 48: USB generic driver */
d200 1
a200 1
	cdev_systrace_init(NSYSTRACE,systrace),	/* 50 system call tracing */
d211 1
a211 1
	cdev_notdef(),			/* 53: ALTQ (deprecated) */
@


1.20.4.6
log
@merge the trunk so we will get the genfs and locking fixes
@
text
@d243 1
a243 1
int chrtoblktbl[] = {
d299 36
a334 1
int nchrtoblktbl = sizeof(chrtoblktbl) / sizeof(chrtoblktbl[0]);
@


1.20.4.7
log
@Sync SMP branch to -current
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.20.4.6 2003/05/16 00:29:38 niklas Exp $	*/
d16 5
a20 1
 * 3. Neither the name of the University nor the names of its contributors
@


1.20.4.8
log
@Merge with the trunk
@
text
@d1 1
a1 1
/*	$OpenBSD$	*/
a128 1
#include "hotplug.h"
a194 2
	cdev_ptm_init(NPTY,ptm),	/* 55: pseudo-tty ptm device */
	cdev_hotplug_init(NHOTPLUG,hotplug), /* 56: devices hot plugging */
@


1.19
log
@

Enable new ATA/ATAPISCSI functionality as default.
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.18 1998/09/25 09:20:52 todd Exp $	*/
a51 2
#include "acd.h"
bdev_decl(acd);
d66 1
a66 1
	bdev_disk_init(NACD,acd),	/* 4: ATAPI CD-ROM */
a121 1
cdev_decl(acd);
d170 1
a170 1
	cdev_disk_init(NACD,acd),	/* 37: ATAPI CD-ROM */
@


1.18
log
@o xfs is in the house (thanks art, for getting me started)
o all but vax are major 51
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.17 1998/08/24 05:29:46 millert Exp $	*/
d47 1
a47 1
#include "wdc.h"
d64 1
a64 1
	bdev_disk_init(NWDC,wd),	/* 0: ST506/ESDI/IDE disk */
d172 1
a172 1
	cdev_disk_init(NWDC,wd),	/* 36: ST506/ESDI/IDE disk */
@


1.17
log
@Add support for /dev/ksyms to arch-specific files
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.16 1998/07/07 06:55:54 deraadt Exp $	*/
d127 4
d176 16
@


1.16
log
@oops, i did not handle nchrdev correctly
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.15 1998/07/07 03:02:29 deraadt Exp $	*/
d127 2
d171 1
@


1.15
log
@fix chrtoblk() so that it returne ENODEV for entries beyond the end of the table
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.14 1997/11/23 05:21:53 mickey Exp $	*/
d259 1
a259 1
	if (major(dev) >= MAXDEV ||
@


1.14
log
@use MI cdev_decl(ipl)
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.13 1997/08/04 10:01:43 dgregor Exp $	*/
a247 1
	/* 38 */	NODEV,
d259 2
a260 1
	if (major(dev) >= nchrdev)
@


1.13
log
@Add Cyclades serial driver as character major number 38.
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.12 1997/07/06 18:12:01 niklas Exp $	*/
a116 1
cdev_decl(ipl);
@


1.12
log
@wd and acd support
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.11 1997/05/06 19:47:12 niklas Exp $	*/
d126 2
d169 1
d249 1
@


1.11
log
@Add IP filter log into cdevsw
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.10 1996/11/11 19:43:27 kstailey Exp $	*/
d47 2
d52 2
d64 1
a64 1
	bdev_notdef(),			/* 0 */
d68 1
a68 1
	bdev_notdef(),			/* 4 */
a122 1

d124 2
a125 1

d165 2
d244 2
@


1.10
log
@Updates for SCSI scanner and SCSI unknown devices.
Removed MI *dev_decl() stuff that is now in sys/conf.h
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.9 1996/11/06 02:01:08 deraadt Exp $	*/
d113 6
a118 1

d160 1
d237 1
@


1.9
log
@add blktochr()
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.8 1996/10/30 22:38:00 niklas Exp $	*/
a48 1
bdev_decl(st);
a49 1
bdev_decl(cd);
d51 2
a52 1
bdev_decl(sd);
a53 1
bdev_decl(vnd);
a54 1
bdev_decl(ccd);
a90 2
cdev_decl(cn);
cdev_decl(ctty);
a94 1
cdev_decl(random);
a95 7
#define	ptstty		ptytty
#define	ptsioctl	ptyioctl
cdev_decl(pts);
#define	ptctty		ptytty
#define	ptcioctl	ptyioctl
cdev_decl(ptc);
cdev_decl(log);
a96 4
cdev_decl(tun);
cdev_decl(sd);
cdev_decl(vnd);
cdev_decl(ccd);
a98 3
cdev_decl(bpf);
cdev_decl(st);
cdev_decl(cd);
a99 1
cdev_decl(ch);
d113 1
a113 4
#include "ss.h"
cdev_decl(ss);
#include "uk.h"
cdev_decl(uk);
@


1.8
log
@Merge to NetBSD 961020.  Retained our kernel APIs where NetBSD has changed.
-Wall -Wstrict-prototypes -Wmissing-prototypes too.
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.16 1996/10/18 21:26:57 cgd Exp $	*/
d272 18
@


1.7
log
@random device is permanent now.
@
text
@d1 2
a2 2
/*	$OpenBSD: conf.c,v 1.6 1996/08/29 09:25:48 deraadt Exp $	*/
/*	$NetBSD: conf.c,v 1.11 1996/04/12 02:07:23 cgd Exp $	*/
a46 8
int	ttselect	__P((dev_t, int, struct proc *));

#ifndef LKM
#define	lkmenodev	enodev
#else
int	lkmenodev();
#endif

d58 2
d69 1
a69 1
	bdev_notdef(),			/* 6 */
d86 1
a86 1
	dev_init(c,n,tty), ttselect, dev_init(c,n,mmap), D_TTY }
a122 6
#ifdef LKM
#define	NLKM	1
#else
#define	NLKM	0
#endif
cdev_decl(lkm);
d133 3
d172 1
a172 1
	cdev_notdef(),			/* 28 */
d176 3
a178 2
	cdev_uk_init(NUK,uk),		/* 32: unknown SCSI */
	cdev_random_init(1,random), /* 33: random data source */
d198 1
d209 1
d228 2
a229 2
	/*  8 */	8,
	/*  9 */	9,
d232 2
a233 2
	/* 12 */	NODEV,
	/* 13 */	3,
d247 2
a248 2
	/* 27 */	7,
	/* 28 */	NODEV,
d252 3
d260 1
@


1.6
log
@rnd -> random
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.5 1996/07/29 22:57:17 niklas Exp $	*/
d106 1
a144 2
#include "random.h"
cdev_decl(random);
d186 1
a186 1
	cdev_random_init(NRANDOM,random), /* 33: random data source */
@


1.5
log
@Add OpenBSD tags.  Adapt to OpenBSD *_intr_establish calling convention
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.11 1996/04/12 02:07:23 cgd Exp $	*/
d144 2
a145 2
#include "rnd.h"
cdev_decl(rnd);
d187 1
a187 1
	cdev_rnd_init(NRND,rnd),	/* 33: random data source */
@


1.4
log
@add rnd driver
@
text
@d1 1
@


1.3
log
@sync to 0616, retaining local diffs
@
text
@d143 4
d185 2
@


1.2
log
@remove #ifndef LKM, since that stuff already in sys/conf.h,
add lkmenodev prototype.
@
text
@d1 1
a1 1
/*	$NetBSD: conf.c,v 1.9 1995/08/17 17:40:42 thorpej Exp $	*/
d48 6
d87 12
d118 1
a118 1
dev_type_open(fdopen);
d135 2
a136 2
#include "wsc.h"
cdev_decl(wsc);
d139 4
d146 1
d159 1
a159 1
	cdev_fd_init(1,fd),		/* 10: file descriptor pseudo-dev */
d174 1
a174 1
	cdev_tty_init(NWSC,wsc),	/* 25: workstation console */
d177 4
d248 4
@


1.1
log
@Initial revision
@
text
@a47 6
#ifndef LKM
#define	lkmenodev	enodev
#else
int	lkmenodev();
#endif

@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
