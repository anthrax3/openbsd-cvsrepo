head	1.16;
access;
symbols
	OPENBSD_5_5:1.15.0.26
	OPENBSD_5_5_BASE:1.15
	OPENBSD_5_4:1.15.0.22
	OPENBSD_5_4_BASE:1.15
	OPENBSD_5_3:1.15.0.20
	OPENBSD_5_3_BASE:1.15
	OPENBSD_5_2:1.15.0.18
	OPENBSD_5_2_BASE:1.15
	OPENBSD_5_1_BASE:1.15
	OPENBSD_5_1:1.15.0.16
	OPENBSD_5_0:1.15.0.14
	OPENBSD_5_0_BASE:1.15
	OPENBSD_4_9:1.15.0.12
	OPENBSD_4_9_BASE:1.15
	OPENBSD_4_8:1.15.0.10
	OPENBSD_4_8_BASE:1.15
	OPENBSD_4_7:1.15.0.6
	OPENBSD_4_7_BASE:1.15
	OPENBSD_4_6:1.15.0.8
	OPENBSD_4_6_BASE:1.15
	OPENBSD_4_5:1.15.0.4
	OPENBSD_4_5_BASE:1.15
	OPENBSD_4_4:1.15.0.2
	OPENBSD_4_4_BASE:1.15
	OPENBSD_4_3:1.14.0.10
	OPENBSD_4_3_BASE:1.14
	OPENBSD_4_2:1.14.0.8
	OPENBSD_4_2_BASE:1.14
	OPENBSD_4_1:1.14.0.6
	OPENBSD_4_1_BASE:1.14
	OPENBSD_4_0:1.14.0.4
	OPENBSD_4_0_BASE:1.14
	OPENBSD_3_9:1.14.0.2
	OPENBSD_3_9_BASE:1.14
	OPENBSD_3_8:1.11.0.4
	OPENBSD_3_8_BASE:1.11
	OPENBSD_3_7:1.11.0.2
	OPENBSD_3_7_BASE:1.11
	OPENBSD_3_6:1.8.0.12
	OPENBSD_3_6_BASE:1.8
	SMP_SYNC_A:1.8
	SMP_SYNC_B:1.8
	OPENBSD_3_5:1.8.0.10
	OPENBSD_3_5_BASE:1.8
	OPENBSD_3_4:1.8.0.8
	OPENBSD_3_4_BASE:1.8
	UBC_SYNC_A:1.8
	OPENBSD_3_3:1.8.0.6
	OPENBSD_3_3_BASE:1.8
	OPENBSD_3_2:1.8.0.4
	OPENBSD_3_2_BASE:1.8
	OPENBSD_3_1:1.8.0.2
	OPENBSD_3_1_BASE:1.8
	UBC_SYNC_B:1.8
	UBC:1.6.0.4
	UBC_BASE:1.6
	OPENBSD_3_0:1.6.0.2
	OPENBSD_3_0_BASE:1.6
	OPENBSD_2_9:1.4.0.20
	OPENBSD_2_9_BASE:1.4
	OPENBSD_2_8:1.4.0.18
	OPENBSD_2_8_BASE:1.4
	OPENBSD_2_7:1.4.0.16
	OPENBSD_2_7_BASE:1.4
	SMP:1.4.0.14
	SMP_BASE:1.4
	kame_19991208:1.4
	OPENBSD_2_6:1.4.0.12
	OPENBSD_2_6_BASE:1.4
	OPENBSD_2_5:1.4.0.10
	OPENBSD_2_5_BASE:1.4
	OPENBSD_2_4:1.4.0.8
	OPENBSD_2_4_BASE:1.4
	OPENBSD_2_3:1.4.0.6
	OPENBSD_2_3_BASE:1.4
	OPENBSD_2_2:1.4.0.4
	OPENBSD_2_2_BASE:1.4
	OPENBSD_2_1:1.4.0.2
	OPENBSD_2_1_BASE:1.4
	OPENBSD_2_0:1.1.0.2
	OPENBSD_2_0_BASE:1.1;
locks; strict;
comment	@ * @;


1.16
date	2014.03.18.22.36.32;	author miod;	state dead;
branches;
next	1.15;

1.15
date	2008.06.26.05.42.10;	author ray;	state Exp;
branches;
next	1.14;

1.14
date	2005.12.31.18.13.45;	author miod;	state Exp;
branches;
next	1.13;

1.13
date	2005.12.30.18.14.12;	author miod;	state Exp;
branches;
next	1.12;

1.12
date	2005.12.30.18.00.23;	author miod;	state Exp;
branches;
next	1.11;

1.11
date	2005.02.27.22.08.43;	author miod;	state Exp;
branches;
next	1.10;

1.10
date	2005.02.12.18.00.54;	author miod;	state Exp;
branches;
next	1.9;

1.9
date	2005.01.14.22.39.29;	author miod;	state Exp;
branches;
next	1.8;

1.8
date	2002.03.14.03.15.52;	author millert;	state Exp;
branches;
next	1.7;

1.7
date	2002.03.14.01.26.31;	author millert;	state Exp;
branches;
next	1.6;

1.6
date	2001.09.01.05.48.18;	author jason;	state Exp;
branches
	1.6.4.1;
next	1.5;

1.5
date	2001.05.05.22.33.37;	author art;	state Exp;
branches;
next	1.4;

1.4
date	97.04.16.11.56.33;	author downsj;	state Exp;
branches
	1.4.14.1;
next	1.3;

1.3
date	97.02.03.04.48.00;	author downsj;	state Exp;
branches;
next	1.2;

1.2
date	97.01.12.15.13.31;	author downsj;	state Exp;
branches;
next	1.1;

1.1
date	96.05.04.16.47.18;	author mickey;	state Exp;
branches;
next	;

1.4.14.1
date	2001.07.04.10.15.51;	author niklas;	state Exp;
branches;
next	1.4.14.2;

1.4.14.2
date	2001.10.31.02.52.46;	author nate;	state Exp;
branches;
next	1.4.14.3;

1.4.14.3
date	2002.03.28.10.07.18;	author niklas;	state Exp;
branches;
next	;

1.6.4.1
date	2002.06.11.03.35.20;	author art;	state Exp;
branches;
next	;


desc
@@


1.16
log
@Retire hp300, mvme68k and mvme88k ports. These ports have no users, keeping
this hardware alive is becoming increasingly difficult, and I should heed the
message sent by the three disks which have died on me over the last few days.

Noone sane will mourn these ports anyway. So long, and thanks for the fish.
@
text
@/*	$OpenBSD: autoconf.h,v 1.15 2008/06/26 05:42:10 ray Exp $	*/
/*	$NetBSD: autoconf.h,v 1.4 1997/04/01 03:03:56 scottr Exp $	*/

/*-
 * Copyright (c) 1996 The NetBSD Foundation, Inc.
 * All rights reserved.
 *
 * This code is derived from software contributed to The NetBSD Foundation
 * by Jason R. Thorpe.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 *
 * THIS SOFTWARE IS PROVIDED BY THE NETBSD FOUNDATION, INC. AND CONTRIBUTORS
 * ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED
 * TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 * POSSIBILITY OF SUCH DAMAGE.
 */

#ifdef _KERNEL
extern	int conscode;			/* select code of console device */
#define	CONSCODE_INTERNAL	(-1)
#define	CONSCODE_INVALID	(-2)
extern	caddr_t conaddr;		/* KVA of console device */
extern	int convasize;			/* size of mapping at conaddr */
extern	int consolepass;		/* console initialization pass */

void	hp300_cninit(void);
void	console_scan(int (*)(int, caddr_t, void *), void *);
caddr_t	iomap(caddr_t, int);
void	iounmap(caddr_t, int);
#endif /* _KERNEL */
@


1.15
log
@First pass at removing clauses 3 and 4 from NetBSD licenses.

Not sure what's more surprising: how long it took for NetBSD to
catch up to the rest of the BSDs (including UCB), or the amount of
code that NetBSD has claimed for itself without attributing to the
actual authors.

OK deraadt@@
@
text
@d1 1
a1 1
/*	$OpenBSD: autoconf.h,v 1.14 2005/12/31 18:13:45 miod Exp $	*/
@


1.14
log
@Rework (once again) the console code, in order to match the PROM's logic better.
When not running on serial console, the PROM will pick the ``internal''
graphics device, and if it does not exist, the DIO device with the lowest
select code, and will resort to SGC devices if no internal or DIO device
was found.

However, the current logic would search for a certain frame buffer type first,
then for its best hardware location, following the order they are listed
in conf.c.

By replacing gazillions of almost-exactly-duplicated frame buffer code with
one single instance, which is device type-agnostic, we can match the PROM
(and the bootblocks) logic again. Plus this saves a few KB of code!
@
text
@d1 1
a1 1
/*	$OpenBSD: autoconf.h,v 1.13 2005/12/30 18:14:12 miod Exp $	*/
a18 7
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 *        This product includes software developed by the NetBSD
 *        Foundation, Inc. and its contributors.
 * 4. Neither the name of The NetBSD Foundation nor the names of its
 *    contributors may be used to endorse or promote products derived
 *    from this software without specific prior written permission.
@


1.13
log
@Kill conforced, and have console devices use CN_FORCED priority instead.
This means we are no longer aborting the console scans even if the final
console has been found, but on the other hand makes some logic simpler;
plus it will be necessary for upcoming scode vs device loop order reversal.
No user-visible change.
@
text
@d1 1
a1 1
/*	$OpenBSD: autoconf.h,v 1.12 2005/12/30 18:00:23 miod Exp $	*/
d49 1
a49 1
void	console_scan(int (*)(int, caddr_t, void *), void *, int);
@


1.12
log
@Introduce symbolic constants for the magic conscode values.
No functional change.
@
text
@d1 1
a1 1
/*	$OpenBSD: autoconf.h,v 1.11 2005/02/27 22:08:43 miod Exp $	*/
a45 1
extern	int conforced;			/* console has been forced */
@


1.11
log
@Invoke hp300_cninit() twice, with a global variable letting the
console-dependent routines know which pass they are being invoked in.

The first pass is the usual console detection code. The second pass runs
after uvm is initialized, and will allow devices which need VM services to
run to claim the console.
@
text
@d1 1
a1 1
/*	$OpenBSD: autoconf.h,v 1.10 2005/02/12 18:00:54 miod Exp $	*/
d42 2
@


1.10
log
@consinit_active is not used anymore.
@
text
@d1 1
a1 1
/*	$OpenBSD: autoconf.h,v 1.9 2005/01/14 22:39:29 miod Exp $	*/
d45 1
@


1.9
log
@Switch OpenBSD/hp300 to wscons, still using on-board ROM fonts for now.

Main features:
- MI hil drivers, allowing live plug/unplug of devices, and the keyboard
  does not need to be at id 1 anymore.
- SGC bus support on 4xx models. SGC frame buffers are supported too, but
  not as console, though you can use them as a regular glass terminal if
  you run a getty on ttyC0. Currently not compiled-in, awaiting for an sti(4)
  fix to be commited.
- HP-UX compatibility interfaces are removed. grfinfo and hilinfo are removed.

X11 support is currently broken by these changes; X.org X11R6 support will
be available very soon.

Tested on hyperion and 4 different flavours of catseye/topcat/kathmandu; other,
older frame buffers (davinci, gatorbox and renaissance) could not been tested
but should work; please report any regression.
@
text
@d1 1
a1 1
/*	$OpenBSD: autoconf.h,v 1.8 2002/03/14 03:15:52 millert Exp $	*/
a41 1
extern	int consinit_active;		/* hint for drivers */
@


1.8
log
@Final __P removal plus some cosmetic fixups
@
text
@d1 1
a1 1
/*	$OpenBSD: autoconf.h,v 1.7 2002/03/14 01:26:31 millert Exp $	*/
d48 1
a48 1
void	console_scan(int (*)(int, caddr_t, void *), void *);
@


1.7
log
@First round of __P removal in sys
@
text
@d1 1
a1 1
/*	$OpenBSD: autoconf.h,v 1.6 2001/09/01 05:48:18 jason Exp $	*/
d48 1
a48 1
void	console_scan __P((int (*)(int, caddr_t, void *), void *));
@


1.6
log
@Add __HAVE_DEVICE_REGISTER to hp300/alpha (sparc64 already had it) and
clean up the arch specific #ifdef's in subr_autoconf.c; from NetBSD.
(tested by me on alpha/sparc64 and miod on hp300)
@
text
@d1 1
a1 1
/*	$OpenBSD: autoconf.h,v 1.5 2001/05/05 22:33:37 art Exp $	*/
d47 1
a47 1
void	hp300_cninit __P((void));
d49 2
a50 2
caddr_t	iomap __P((caddr_t, int));
void	iounmap __P((caddr_t, int));
@


1.6.4.1
log
@Sync UBC branch to -current
@
text
@d1 1
a1 1
/*	$OpenBSD: autoconf.h,v 1.6 2001/09/01 05:48:18 jason Exp $	*/
d47 4
a50 4
void	hp300_cninit(void);
void	console_scan(int (*)(int, caddr_t, void *), void *);
caddr_t	iomap(caddr_t, int);
void	iounmap(caddr_t, int);
@


1.5
log
@Rename configure() to cpu_configure().
Move it from cpu_startup() to main().
@
text
@d1 1
a1 1
/*	$OpenBSD: autoconf.h,v 1.4 1997/04/16 11:56:33 downsj Exp $	*/
a50 3

struct device;
void	device_register __P((struct device *, void *));
@


1.4
log
@Merge portions of NetBSD up to 970415.

This includes:
	* All of the prototyping and KNF changes.
	* The new interrupt system.
	* Portions of the Domain Keyboard support from Mike Smith.

This does not include:
	* m68k changes, namely generic dumps.

Various sundry changes and fixes by me.
@
text
@d1 1
a1 1
/*	$OpenBSD: autoconf.h,v 1.3 1997/02/03 04:48:00 downsj Exp $	*/
a46 1
void	configure __P((void));
@


1.4.14.1
log
@Merge in -current from two days ago in the SMP branch.
As usual with merges, they do not indicate progress, so do not hold
your breath for working SMP, and do not mail me and ask about the
state of it.  It has not changed.  There is work ongoing, but very, very
slowly.  The commit is done in parts as to not lock up the tree in too
big chunks at a time.
@
text
@d1 1
a1 1
/*	$OpenBSD: autoconf.h,v 1.4 1997/04/16 11:56:33 downsj Exp $	*/
d47 1
@


1.4.14.2
log
@Sync the SMP branch to something just after 3.0
@
text
@d1 1
a1 1
/*	$OpenBSD: autoconf.h,v 1.4.14.1 2001/07/04 10:15:51 niklas Exp $	*/
d51 3
@


1.4.14.3
log
@Merge in -current from about a week ago
@
text
@d1 1
a1 1
/*	$OpenBSD$	*/
d47 4
a50 4
void	hp300_cninit(void);
void	console_scan(int (*)(int, caddr_t, void *), void *);
caddr_t	iomap(caddr_t, int);
void	iounmap(caddr_t, int);
@


1.3
log
@Merge new config(8) support from NetBSD, by Jason Thorpe.
Also add siginfo glue, BOOT_CONFIG, and various other changes.
@
text
@d1 2
a2 2
/*	$OpenBSD: autoconf.h,v 1.2 1997/01/12 15:13:31 downsj Exp $	*/
/*	$NetBSD: autoconf.h,v 1.3 1996/03/03 16:49:17 thorpej Exp $	*/
d47 1
@


1.2
log
@Mostly sync to NetBSD-current of 011196.  Compiles, links, boots to single
user.

KNOWN NOT WORKING:
	* DIO-II devices
	* Dynamic executables

NOT EVEN TRIED:
	* New config support
@
text
@d1 1
a1 1
/*	$OpenBSD$	*/
d51 3
@


1.1
log
@add files missed from 0418 sync.
@
text
@d1 1
@
