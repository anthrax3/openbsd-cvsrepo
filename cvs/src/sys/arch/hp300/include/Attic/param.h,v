head	1.27;
access;
symbols
	OPENBSD_5_5:1.26.0.6
	OPENBSD_5_5_BASE:1.26
	OPENBSD_5_4:1.26.0.2
	OPENBSD_5_4_BASE:1.26
	OPENBSD_5_3:1.25.0.28
	OPENBSD_5_3_BASE:1.25
	OPENBSD_5_2:1.25.0.26
	OPENBSD_5_2_BASE:1.25
	OPENBSD_5_1_BASE:1.25
	OPENBSD_5_1:1.25.0.24
	OPENBSD_5_0:1.25.0.22
	OPENBSD_5_0_BASE:1.25
	OPENBSD_4_9:1.25.0.20
	OPENBSD_4_9_BASE:1.25
	OPENBSD_4_8:1.25.0.18
	OPENBSD_4_8_BASE:1.25
	OPENBSD_4_7:1.25.0.14
	OPENBSD_4_7_BASE:1.25
	OPENBSD_4_6:1.25.0.16
	OPENBSD_4_6_BASE:1.25
	OPENBSD_4_5:1.25.0.12
	OPENBSD_4_5_BASE:1.25
	OPENBSD_4_4:1.25.0.10
	OPENBSD_4_4_BASE:1.25
	OPENBSD_4_3:1.25.0.8
	OPENBSD_4_3_BASE:1.25
	OPENBSD_4_2:1.25.0.6
	OPENBSD_4_2_BASE:1.25
	OPENBSD_4_1:1.25.0.4
	OPENBSD_4_1_BASE:1.25
	OPENBSD_4_0:1.25.0.2
	OPENBSD_4_0_BASE:1.25
	OPENBSD_3_9:1.24.0.2
	OPENBSD_3_9_BASE:1.24
	OPENBSD_3_8:1.23.0.10
	OPENBSD_3_8_BASE:1.23
	OPENBSD_3_7:1.23.0.8
	OPENBSD_3_7_BASE:1.23
	OPENBSD_3_6:1.23.0.6
	OPENBSD_3_6_BASE:1.23
	SMP_SYNC_A:1.23
	SMP_SYNC_B:1.23
	OPENBSD_3_5:1.23.0.4
	OPENBSD_3_5_BASE:1.23
	OPENBSD_3_4:1.23.0.2
	OPENBSD_3_4_BASE:1.23
	UBC_SYNC_A:1.22
	OPENBSD_3_3:1.21.0.6
	OPENBSD_3_3_BASE:1.21
	OPENBSD_3_2:1.21.0.4
	OPENBSD_3_2_BASE:1.21
	OPENBSD_3_1:1.21.0.2
	OPENBSD_3_1_BASE:1.21
	UBC_SYNC_B:1.21
	UBC:1.18.0.2
	UBC_BASE:1.18
	OPENBSD_3_0:1.16.0.2
	OPENBSD_3_0_BASE:1.16
	OPENBSD_2_9:1.10.0.6
	OPENBSD_2_9_BASE:1.10
	OPENBSD_2_8:1.10.0.4
	OPENBSD_2_8_BASE:1.10
	OPENBSD_2_7:1.10.0.2
	OPENBSD_2_7_BASE:1.10
	SMP:1.9.0.12
	SMP_BASE:1.9
	kame_19991208:1.9
	OPENBSD_2_6:1.9.0.10
	OPENBSD_2_6_BASE:1.9
	OPENBSD_2_5:1.9.0.8
	OPENBSD_2_5_BASE:1.9
	OPENBSD_2_4:1.9.0.6
	OPENBSD_2_4_BASE:1.9
	OPENBSD_2_3:1.9.0.4
	OPENBSD_2_3_BASE:1.9
	OPENBSD_2_2:1.9.0.2
	OPENBSD_2_2_BASE:1.9
	OPENBSD_2_1:1.7.0.2
	OPENBSD_2_1_BASE:1.7
	OPENBSD_2_0:1.4.0.2
	OPENBSD_2_0_BASE:1.4
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@ * @;


1.27
date	2014.03.18.22.36.32;	author miod;	state dead;
branches;
next	1.26;

1.26
date	2013.03.23.16.12.22;	author deraadt;	state Exp;
branches;
next	1.25;

1.25
date	2006.06.11.20.48.11;	author miod;	state Exp;
branches;
next	1.24;

1.24
date	2005.09.12.23.05.05;	author miod;	state Exp;
branches;
next	1.23;

1.23
date	2003.06.02.23.27.45;	author millert;	state Exp;
branches;
next	1.22;

1.22
date	2003.04.03.17.01.29;	author millert;	state Exp;
branches;
next	1.21;

1.21
date	2002.03.14.01.26.31;	author millert;	state Exp;
branches;
next	1.20;

1.20
date	2002.01.10.21.10.46;	author miod;	state Exp;
branches;
next	1.19;

1.19
date	2001.12.20.19.02.27;	author miod;	state Exp;
branches;
next	1.18;

1.18
date	2001.12.05.01.57.14;	author provos;	state Exp;
branches
	1.18.2.1;
next	1.17;

1.17
date	2001.11.30.20.58.18;	author miod;	state Exp;
branches;
next	1.16;

1.16
date	2001.07.18.10.47.04;	author art;	state Exp;
branches;
next	1.15;

1.15
date	2001.06.27.04.05.45;	author art;	state Exp;
branches;
next	1.14;

1.14
date	2001.05.16.17.40.41;	author millert;	state Exp;
branches;
next	1.13;

1.13
date	2001.05.13.02.37.29;	author millert;	state Exp;
branches;
next	1.12;

1.12
date	2001.05.10.22.46.32;	author miod;	state Exp;
branches;
next	1.11;

1.11
date	2001.05.05.20.56.35;	author art;	state Exp;
branches;
next	1.10;

1.10
date	2000.02.22.19.27.46;	author deraadt;	state Exp;
branches;
next	1.9;

1.9
date	97.07.13.09.48.02;	author downsj;	state Exp;
branches
	1.9.12.1;
next	1.8;

1.8
date	97.07.06.08.02.13;	author downsj;	state Exp;
branches;
next	1.7;

1.7
date	97.04.16.11.56.35;	author downsj;	state Exp;
branches;
next	1.6;

1.6
date	97.02.04.06.21.33;	author downsj;	state Exp;
branches;
next	1.5;

1.5
date	97.01.12.15.13.38;	author downsj;	state Exp;
branches;
next	1.4;

1.4
date	96.06.25.20.56.19;	author deraadt;	state Exp;
branches;
next	1.3;

1.3
date	96.06.23.11.47.20;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	96.04.25.06.37.12;	author mickey;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.50.25;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.50.25;	author deraadt;	state Exp;
branches;
next	;

1.9.12.1
date	2000.03.02.07.04.27;	author niklas;	state Exp;
branches;
next	1.9.12.2;

1.9.12.2
date	2001.07.04.10.15.52;	author niklas;	state Exp;
branches;
next	1.9.12.3;

1.9.12.3
date	2001.10.31.02.52.46;	author nate;	state Exp;
branches;
next	1.9.12.4;

1.9.12.4
date	2001.12.05.00.39.09;	author niklas;	state Exp;
branches;
next	1.9.12.5;

1.9.12.5
date	2002.03.06.00.57.22;	author niklas;	state Exp;
branches;
next	1.9.12.6;

1.9.12.6
date	2002.03.28.10.07.18;	author niklas;	state Exp;
branches;
next	1.9.12.7;

1.9.12.7
date	2003.05.13.19.41.03;	author ho;	state Exp;
branches;
next	1.9.12.8;

1.9.12.8
date	2003.06.07.11.11.35;	author ho;	state Exp;
branches;
next	;

1.18.2.1
date	2002.01.31.22.55.08;	author niklas;	state Exp;
branches;
next	1.18.2.2;

1.18.2.2
date	2002.06.11.03.35.20;	author art;	state Exp;
branches;
next	1.18.2.3;

1.18.2.3
date	2003.05.19.21.39.16;	author tedu;	state Exp;
branches;
next	;


desc
@@


1.27
log
@Retire hp300, mvme68k and mvme88k ports. These ports have no users, keeping
this hardware alive is becoming increasingly difficult, and I should heed the
message sent by the three disks which have died on me over the last few days.

Noone sane will mourn these ports anyway. So long, and thanks for the fish.
@
text
@/*	$OpenBSD: param.h,v 1.26 2013/03/23 16:12:22 deraadt Exp $	*/

/*
 * Copyright (c) 1988 University of Utah.
 * Copyright (c) 1982, 1986, 1990, 1993
 *	The Regents of the University of California.  All rights reserved.
 *
 * This code is derived from software contributed to Berkeley by
 * the Systems Programming Group of the University of Utah Computer
 * Science Department.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. Neither the name of the University nor the names of its contributors
 *    may be used to endorse or promote products derived from this software
 *    without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 */

#ifndef	_MACHINE_PARAM_H_
#define	_MACHINE_PARAM_H_

#define	_MACHINE	hp300
#define	MACHINE		"hp300"

#define	PAGE_SHIFT	12

#define	KERNBASE	0x00000000	/* start of kernel virtual */

#include <m68k/param.h>

#define	MSGBUFSIZE	4096

#if defined(_KERNEL) && !defined(_LOCORE)
#define	delay(us)	_delay((us) << 8)
#define DELAY(us)	delay(us)

void	_delay(u_int);
#endif /* _KERNEL && !_LOCORE */

#endif /* _MACHINE_PARAM_H_ */
@


1.26
log
@refactor sys/param.h and machine/param.h.  A lot of #ifdef _KERNEL is added
to keep definitions our of user space.  The MD files now follow a consistant
order -- all namespace intrusion is at the tail can be cleaned up
independently.  locore, bootblocks, and libkvm still see enough visibility to
build.  Checked on 90% of platforms...
@
text
@d1 1
a1 1
/*	$OpenBSD: param.h,v 1.25 2006/06/11 20:48:11 miod Exp $	*/
@


1.25
log
@Move common prototypes to <m68k/{cpu,param}.h> instead of incomplete
declarations in <machine/{cpu,param}.h> and elsewhere.
@
text
@d1 1
a1 2
/*	$OpenBSD: param.h,v 1.24 2005/09/12 23:05:05 miod Exp $	*/
/*	$NetBSD: param.h,v 1.35 1997/07/10 08:22:38 veego Exp $	*/
a34 4
 *
 * from: Utah $Hdr: machparam.h 1.16 92/12/20$
 *
 *	@@(#)param.h	8.1 (Berkeley) 6/10/93
a39 3
/*
 * Machine dependent constants for HP 9000 series 300.
 */
d49 1
a49 1
#define MSGBUFSIZE 4096
d58 1
a58 1
#endif	/* !_MACHINE_PARAM_H_ */
@


1.24
log
@Change the NKMEMPAGES range to 4-64MB for 32bit arches, and 8-128MB for 64bit
arches; except on sparc where the range is 4-8 for !sun4m and 4-64 for sun4m,
selected at runtime.
@
text
@d1 1
a1 1
/*	$OpenBSD: param.h,v 1.23 2003/06/02 23:27:45 millert Exp $	*/
a50 7
/*
 * Interrupt glue.
 */
#include <machine/intr.h>

#define	PGSHIFT		12		/* LOG2(NBPG) */

a51 2
#define	PAGE_SIZE	(1 << PAGE_SHIFT)
#define	PAGE_MASK	(PAGE_SIZE - 1)
a55 2

#define	NPTEPG		(NBPG/(sizeof (pt_entry_t)))
@


1.23
log
@Remove the advertising clause in the UCB license which Berkeley
rescinded 22 July 1999.  Proofed by myself and Theo.
@
text
@d1 1
a1 1
/*	$OpenBSD: param.h,v 1.22 2003/04/03 17:01:29 millert Exp $	*/
a66 7

/*
 * Minimum and maximum sizes of the kernel malloc arena in PAGE_SIZE-sized
 * logical pages.
 */
#define	NKMEMPAGES_MIN_DEFAULT	((2 * 1024 * 1024) >> PAGE_SHIFT)
#define	NKMEMPAGES_MAX_DEFAULT	((2 * 1024 * 1024) >> PAGE_SHIFT)
@


1.22
log
@HP 9000/xxx not HP9000/xxx; from Paul Weissmann
@
text
@d1 1
a1 1
/*	$OpenBSD: param.h,v 1.21 2002/03/14 01:26:31 millert Exp $	*/
d21 1
a21 5
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 *	This product includes software developed by the University of
 *	California, Berkeley and its contributors.
 * 4. Neither the name of the University nor the names of its contributors
@


1.21
log
@First round of __P removal in sys
@
text
@d1 1
a1 1
/*	$OpenBSD: param.h,v 1.20 2002/01/10 21:10:46 miod Exp $	*/
d50 1
a50 1
 * Machine dependent constants for HP9000 series 300.
@


1.20
log
@Switch m68k arches that do not exist in 68060 models back to pmap_motorola.
Others will be switched after more 060 tests.

This time: hp300
@
text
@d1 1
a1 1
/*	$OpenBSD: param.h,v 1.19 2001/12/20 19:02:27 miod Exp $	*/
d85 1
a85 1
void	_delay __P((u_int));
@


1.19
log
@Temporarily revert the pmap_motorola changes, as they may account for
some problems as well.
Requested by deraadt@@
@
text
@d1 1
a1 1
/*	$OpenBSD: param.h,v 1.18 2001/12/05 01:57:14 provos Exp $	*/
a67 6
#define	SEGSHIFT	22		/* LOG2(NBSEG) */
#define NBSEG		(1 << SEGSHIFT)	/* bytes/segment */
#define	SEGOFSET	(NBSEG-1)	/* byte offset into segment */

#define	UPAGES		2		/* pages of u-area */

a86 14

#ifdef COMPAT_HPUX
/*
 * Constants/macros for HPUX multiple mapping of user address space.
 * Pages in the first 256Mb are mapped in at every 256Mb segment.
 */
#define HPMMMASK	0xF0000000
#define ISHPMMADDR(v) \
	((curproc->p_md.md_flags & MDP_HPUXMMAP) && \
	 ((unsigned)(v) & HPMMMASK) && \
	 ((unsigned)(v) & HPMMMASK) != HPMMMASK)
#define HPMMBASEADDR(v) \
	((unsigned)(v) & ~HPMMMASK)
#endif
@


1.18
log
@make nkmempages dynamic based on memory. okay art@@ from netbsd:
date: 2000/02/11 19:22:52;  author: thorpej;
Add some very simple code to auto-size the kmem_map.  We take the
amount of physical memory, divide it by 4, and then allow machine
dependent code to place upper and lower bounds on the size.  Export
the computed value to userspace via the new "vm.nkmempages" sysctl.

NKMEMCLUSTERS is now deprecated and will generate an error if you
attempt to use it.  The new option, should you choose to use it,
is called NKMEMPAGES, and two new options NKMEMPAGES_MIN and
NKMEMPAGES_MAX allow the user to configure the bounds in the kernel
config file.
@
text
@d1 1
a1 1
/*	$OpenBSD: param.h,v 1.17 2001/11/30 20:58:18 miod Exp $	*/
d68 6
d93 14
@


1.18.2.1
log
@Merge in -current, builds on i386, otherwise untested
@
text
@d1 1
a1 1
/*	$OpenBSD: param.h,v 1.20 2002/01/10 21:10:46 miod Exp $	*/
@


1.18.2.2
log
@Sync UBC branch to -current
@
text
@d1 1
a1 1
/*	$OpenBSD: param.h,v 1.18.2.1 2002/01/31 22:55:08 niklas Exp $	*/
d85 1
a85 1
void	_delay(u_int);
@


1.18.2.3
log
@sync
@
text
@d1 1
a1 1
/*	$OpenBSD$	*/
d50 1
a50 1
 * Machine dependent constants for HP 9000 series 300.
@


1.17
log
@Switch to pmap_motorola.
@
text
@d1 1
a1 1
/*	$OpenBSD: param.h,v 1.16 2001/07/18 10:47:04 art Exp $	*/
d73 5
a77 5
 * Size of kernel malloc arena in logical pages
 */ 
#ifndef NKMEMCLUSTERS
# define	NKMEMCLUSTERS	(2048 * 1024 / PAGE_SIZE)
#endif
@


1.16
log
@Get rid of the PMAP_NEW option by making it mandatory for all archs.
The archs that didn't have a proper PMAP_NEW now have a dummy implementation
with wrappers around the old functions.
@
text
@d1 1
a1 1
/*	$OpenBSD: param.h,v 1.15 2001/06/27 04:05:45 art Exp $	*/
a67 6
#define	SEGSHIFT	22		/* LOG2(NBSEG) */
#define NBSEG		(1 << SEGSHIFT)	/* bytes/segment */
#define	SEGOFSET	(NBSEG-1)	/* byte offset into segment */

#define	UPAGES		2		/* pages of u-area */

a86 14

#ifdef COMPAT_HPUX
/*
 * Constants/macros for HPUX multiple mapping of user address space.
 * Pages in the first 256Mb are mapped in at every 256Mb segment.
 */
#define HPMMMASK	0xF0000000
#define ISHPMMADDR(v) \
	((curproc->p_md.md_flags & MDP_HPUXMMAP) && \
	 ((unsigned)(v) & HPMMMASK) && \
	 ((unsigned)(v) & HPMMMASK) != HPMMMASK)
#define HPMMBASEADDR(v) \
	((unsigned)(v) & ~HPMMMASK)
#endif
@


1.15
log
@no more old VM
@
text
@d1 1
a1 1
/*	$OpenBSD: param.h,v 1.14 2001/05/16 17:40:41 millert Exp $	*/
a106 2

#define PMAP_NEW
@


1.14
log
@Use PMAP_NEW if UVM is defined.
@
text
@d1 1
a1 1
/*	$OpenBSD: param.h,v 1.13 2001/05/13 02:37:29 millert Exp $	*/
a107 1
#ifdef UVM
a108 1
#endif
@


1.13
log
@PAGE_MASK is (PAGE_SIZE - 1), *not* (PAGE_SHIFT - 1)
@
text
@d1 1
a1 1
/*	$OpenBSD: param.h,v 1.12 2001/05/10 22:46:32 miod Exp $	*/
d106 4
@


1.12
log
@Provide PAGE_{MASK,SHIFT,SIZE} constants.
@
text
@d1 1
a1 1
/*	$OpenBSD: param.h,v 1.11 2001/05/05 20:56:35 art Exp $	*/
d64 1
a64 1
#define	PAGE_MASK	(PAGE_SHIFT - 1)
@


1.11
log
@Get rid of CLSIZE and all related stuff.
CLSIZE -> 1
CLBYTES -> PAGE_SIZE
OLOFSET -> PAGE_MASK
etc.
At the same time some archs needed some cleaning in vmparam.h so that
goes in at the same time.
@
text
@d1 1
a1 1
/*	$OpenBSD: param.h,v 1.10 2000/02/22 19:27:46 deraadt Exp $	*/
d61 5
@


1.10
log
@enlarge msgbuf, somewhat line netbsd did
@
text
@d1 1
a1 1
/*	$OpenBSD: param.h,v 1.9 1997/07/13 09:48:02 downsj Exp $	*/
d74 1
a74 1
 * Size of kernel malloc arena in CLBYTES-sized logical pages
d77 1
a77 1
# define	NKMEMCLUSTERS	(2048 * 1024 / CLBYTES)
@


1.9
log
@sync to NETBSD_CURRENT_970711.
@
text
@d1 1
a1 1
/*	$OpenBSD: param.h,v 1.8 1997/07/06 08:02:13 downsj Exp $	*/
d79 2
@


1.9.12.1
log
@Sync with -current
@
text
@d1 1
a1 1
/*	$OpenBSD$	*/
a78 2

#define MSGBUFSIZE 4096
@


1.9.12.2
log
@Merge in -current from two days ago in the SMP branch.
As usual with merges, they do not indicate progress, so do not hold
your breath for working SMP, and do not mail me and ask about the
state of it.  It has not changed.  There is work ongoing, but very, very
slowly.  The commit is done in parts as to not lock up the tree in too
big chunks at a time.
@
text
@d1 1
a1 1
/*	$OpenBSD: param.h,v 1.9.12.1 2000/03/02 07:04:27 niklas Exp $	*/
a60 5

#define	PAGE_SHIFT	12
#define	PAGE_SIZE	(1 << PAGE_SHIFT)
#define	PAGE_MASK	(PAGE_SIZE - 1)

d74 1
a74 1
 * Size of kernel malloc arena in logical pages
d77 1
a77 1
# define	NKMEMCLUSTERS	(2048 * 1024 / PAGE_SIZE)
a101 2

#define PMAP_NEW
@


1.9.12.3
log
@Sync the SMP branch to something just after 3.0
@
text
@d1 1
a1 1
/*	$OpenBSD: param.h,v 1.9.12.2 2001/07/04 10:15:52 niklas Exp $	*/
d107 2
@


1.9.12.4
log
@Merge in -current
@
text
@d1 1
a1 1
/*	$OpenBSD: param.h,v 1.9.12.3 2001/10/31 02:52:46 nate Exp $	*/
d68 6
d93 14
@


1.9.12.5
log
@Merge in trunk
@
text
@d1 1
a1 1
/*	$OpenBSD$	*/
d73 5
a77 5
 * Minimum and maximum sizes of the kernel malloc arena in PAGE_SIZE-sized
 * logical pages.
 */
#define	NKMEMPAGES_MIN_DEFAULT	((2 * 1024 * 1024) >> PAGE_SHIFT)
#define	NKMEMPAGES_MAX_DEFAULT	((2 * 1024 * 1024) >> PAGE_SHIFT)
@


1.9.12.6
log
@Merge in -current from about a week ago
@
text
@d85 1
a85 1
void	_delay(u_int);
@


1.9.12.7
log
@Sync the SMP branch to -current.
@
text
@d1 1
a1 1
/*	$OpenBSD: param.h,v 1.9.12.6 2002/03/28 10:07:18 niklas Exp $	*/
d50 1
a50 1
 * Machine dependent constants for HP 9000 series 300.
@


1.9.12.8
log
@Sync SMP branch to -current
@
text
@d1 1
a1 1
/*	$OpenBSD: param.h,v 1.9.12.7 2003/05/13 19:41:03 ho Exp $	*/
d21 5
a25 1
 * 3. Neither the name of the University nor the names of its contributors
@


1.8
log
@Sync with changes from NetBSD, up to 970705.

This includes all of the new frodo drivers, from Michael Smith, hacked up
by Jason R. Thorpe; other changes, mostly configuration and/or m68k
abstraction related, from Thorpe.  A few others of my own.

This compiles and runs, have not yet tested Domain kbd or apci ports.
@
text
@d1 2
a2 2
/*	$OpenBSD: param.h,v 1.7 1997/04/16 11:56:35 downsj Exp $	*/
/*	$NetBSD: param.h,v 1.34 1997/06/10 18:59:12 veego Exp $	*/
d67 2
d70 2
@


1.7
log
@Merge portions of NetBSD up to 970415.

This includes:
	* All of the prototyping and KNF changes.
	* The new interrupt system.
	* Portions of the Domain Keyboard support from Mike Smith.

This does not include:
	* m68k changes, namely generic dumps.

Various sundry changes and fixes by me.
@
text
@d1 2
a2 2
/*	$OpenBSD: param.h,v 1.6 1997/02/04 06:21:33 downsj Exp $	*/
/*	$NetBSD: param.h,v 1.32 1997/04/14 02:28:51 thorpej Exp $	*/
d46 3
a53 3
#define	_MACHINE_ARCH	m68k
#define	MACHINE_ARCH	"m68k"
#define	MID_MACHINE	MID_M68K
a59 8
/*
 * Round p (pointer or byte index) up to a correctly-aligned value for all
 * data types (int, long, ...).   The result is u_int and must be cast to
 * any desired pointer type.
 */
#define	ALIGNBYTES	(sizeof(int) - 1)
#define	ALIGN(p)	(((u_int)(p) + ALIGNBYTES) &~ ALIGNBYTES)

d61 1
a61 3
#define	NBPG		(1 << PGSHIFT)	/* bytes/page */
#define	PGOFSET		(NBPG-1)	/* byte offset into page */
#define	NPTEPG		(NBPG/(sizeof (pt_entry_t)))
d67 1
a67 36
#define	KERNBASE	0x00000000	/* start of kernel virtual */
#define	BTOPKERNBASE	((u_long)KERNBASE >> PGSHIFT)

#define	DEV_BSHIFT	9		/* log2(DEV_BSIZE) */
#define	DEV_BSIZE	(1 << DEV_BSHIFT)
#define BLKDEV_IOSIZE	2048
#define	MAXPHYS		(64 * 1024)	/* max raw I/O transfer size */

#define	CLSIZELOG2	0
#define	CLSIZE		(1 << CLSIZELOG2)

/* NOTE: SSIZE, SINCR and UPAGES must be multiples of CLSIZE */
#define	SSIZE		1		/* initial stack size/NBPG */
#define	SINCR		1		/* increment of stack/NBPG */
#define	UPAGES		2		/* pages of u-area */
#define	USPACE		(UPAGES * NBPG)	/* total size of u-area */

/*
 * Constants related to network buffer management.
 * MCLBYTES must be no larger than CLBYTES (the software page size), and,
 * on machines that exchange pages of input or output buffers with mbuf
 * clusters (MAPPED_MBUFS), MCLBYTES must also be an integral multiple
 * of the hardware page size.
 */
#define	MSIZE		128		/* size of an mbuf */
#define	MCLSHIFT	11
#define	MCLBYTES	(1 << MCLSHIFT)	/* large enough for ether MTU */
#define	MCLOFSET	(MCLBYTES - 1)

#ifndef NMBCLUSTERS
#ifdef GATEWAY
#define	NMBCLUSTERS	512		/* map size, max cluster allocation */
#else
#define	NMBCLUSTERS	256		/* map size, max cluster allocation */
#endif
#endif
d73 1
a73 1
#define	NKMEMCLUSTERS	(2048 * 1024 / CLBYTES)
a75 28
/* pages ("clicks") to disk blocks */
#define	ctod(x)		((x) << (PGSHIFT - DEV_BSHIFT))
#define	dtoc(x)		((x) >> (PGSHIFT - DEV_BSHIFT))

/* pages to bytes */
#define	ctob(x)		((x) << PGSHIFT)
#define	btoc(x)		(((x) + PGOFSET) >> PGSHIFT)

/* bytes to disk blocks */
#define	dbtob(x)	((x) << DEV_BSHIFT)
#define	btodb(x)	((x) >> DEV_BSHIFT)

/*
 * Map a ``block device block'' to a file system block.
 * This should be device dependent, and should use the bsize
 * field from the disk label.
 * For now though just use DEV_BSIZE.
 */
#define	bdbtofsb(bn)	((bn) / (BLKDEV_IOSIZE / DEV_BSIZE))

/*
 * Mach derived conversion macros
 */
#define hp300_round_page(x)	((((unsigned)(x)) + PGOFSET) & ~PGOFSET)
#define hp300_trunc_page(x)	((unsigned)(x) & ~PGOFSET)
#define hp300_btop(x)		((unsigned)(x) >> PGSHIFT)
#define hp300_ptob(x)		((unsigned)(x) << PGSHIFT)

d96 2
@


1.6
log
@checkpoint:  pull in spl() changes from NetBSD, and more siginfo.
@
text
@d1 2
a2 2
/*	$OpenBSD: param.h,v 1.5 1997/01/12 15:13:38 downsj Exp $	*/
/*	$NetBSD: param.h,v 1.28 1997/02/02 09:34:26 thorpej Exp $	*/
d56 5
a148 33
/*
 * spl functions; all but spl0 are done in-line
 */
#include <machine/psl.h>

#define _spl(s) \
({ \
        register int _spl_r; \
\
        __asm __volatile ("clrl %0; movew sr,%0; movew %1,sr" : \
                "&=d" (_spl_r) : "di" (s)); \
        _spl_r; \
})

#define	_splraise(s) \
({ \
	register int _spl_r; \
\
	__asm __volatile ("clrl %0; movew sr,%0;" : "&=d" (_spl_r) : ); \
	if ((_spl_r & PSL_IPL) < ((s) & PSL_IPL)) \
		__asm __volatile ("movew %0,sr;" : : "di" (s)); \
	_spl_r; \
})

/* spl0 requires checking for software interrupts */
#define spl1()  _spl(PSL_S|PSL_IPL1)
#define spl2()  _spl(PSL_S|PSL_IPL2)
#define spl3()  _spl(PSL_S|PSL_IPL3)
#define spl4()  _spl(PSL_S|PSL_IPL4)
#define spl5()  _spl(PSL_S|PSL_IPL5)
#define spl6()  _spl(PSL_S|PSL_IPL6)
#define spl7()  _spl(PSL_S|PSL_IPL7)

a149 32
/*
 * These four globals contain the appropriate PSL_S|PSL_IPL? values
 * to raise interrupt priority to the requested level.
 */
extern	unsigned short hp300_bioipl;
extern	unsigned short hp300_netipl;
extern	unsigned short hp300_ttyipl;
extern	unsigned short hp300_impipl;
#endif /* _KERNEL && !_LOCORE */

/* These spl calls are _not_ to be used by machine-independent code. */
#define splhil()	_splraise(PSL_S|PSL_IPL1)
#define splkbd()	splhil()

/* These spl calls are used by machine-independent code. */
#define splsoftclock()	spl1()
#define splsoftnet()	spl1()
#define splbio()	_splraise(hp300_bioipl)
#define splnet()	_splraise(hp300_netipl)
#define spltty()	_splraise(hp300_ttyipl)
#define splimp()	_splraise(hp300_impipl)
#define splclock()	spl6()
#define splstatclock()	spl6()
#define splvm()		spl6()
#define splhigh()	spl7()
#define splsched()	spl7()

/* watch out for side effects */
#define splx(s)         (s & PSL_IPL ? _spl(s) : spl0())

#if defined(_KERNEL) && !defined(_LOCORE)
extern void _delay __P((u_int));
d152 2
@


1.5
log
@Mostly sync to NetBSD-current of 011196.  Compiles, links, boots to single
user.

KNOWN NOT WORKING:
	* DIO-II devices
	* Dynamic executables

NOT EVEN TRIED:
	* New config support
@
text
@d1 2
a2 2
/*	$OpenBSD$	*/
/*	$NetBSD: param.h,v 1.27 1996/12/09 03:04:48 thorpej Exp $	*/
d158 10
d188 5
d195 4
a198 4
#define splbio()	_spl(hp300_bioipl)
#define splnet()	_spl(hp300_netipl)
#define spltty()	_spl(hp300_ttyipl)
#define splimp()	_spl(hp300_impipl)
@


1.4
log
@MID_M68K is the default now (with backwards compat for MID_M68K4K
@
text
@d1 2
a2 1
/*	$NetBSD: param.h,v 1.26 1996/05/17 15:38:08 thorpej Exp $	*/
d167 11
d180 4
a183 4
#define splbio()	spl5()
#define splnet()	spl5()
#define spltty()	spl5()
#define splimp()	spl5()
@


1.3
log
@sync to 0622
@
text
@d52 1
a52 1
#define	MID_MACHINE	MID_M68K4K
@


1.2
log
@sync w/ Net 960424
@
text
@d1 1
a1 1
/*	$NetBSD: param.h,v 1.25 1996/03/04 05:04:23 cgd Exp $	*/
d181 5
a185 6
#ifdef _KERNEL
#ifndef LOCORE
int	cpuspeed;
#define	DELAY(n)	{ register int N = cpuspeed * (n); while (--N > 0); }
#endif
#endif
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
/*	$NetBSD: param.h,v 1.23 1995/08/13 00:22:40 mycroft Exp $	*/
d48 1
d50 1
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
