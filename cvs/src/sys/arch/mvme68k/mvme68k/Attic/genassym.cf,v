head	1.24;
access;
symbols
	OPENBSD_5_5:1.23.0.22
	OPENBSD_5_5_BASE:1.23
	OPENBSD_5_4:1.23.0.18
	OPENBSD_5_4_BASE:1.23
	OPENBSD_5_3:1.23.0.16
	OPENBSD_5_3_BASE:1.23
	OPENBSD_5_2:1.23.0.14
	OPENBSD_5_2_BASE:1.23
	OPENBSD_5_1_BASE:1.23
	OPENBSD_5_1:1.23.0.12
	OPENBSD_5_0:1.23.0.10
	OPENBSD_5_0_BASE:1.23
	OPENBSD_4_9:1.23.0.8
	OPENBSD_4_9_BASE:1.23
	OPENBSD_4_8:1.23.0.6
	OPENBSD_4_8_BASE:1.23
	OPENBSD_4_7:1.23.0.2
	OPENBSD_4_7_BASE:1.23
	OPENBSD_4_6:1.23.0.4
	OPENBSD_4_6_BASE:1.23
	OPENBSD_4_5:1.21.0.2
	OPENBSD_4_5_BASE:1.21
	OPENBSD_4_4:1.20.0.16
	OPENBSD_4_4_BASE:1.20
	OPENBSD_4_3:1.20.0.14
	OPENBSD_4_3_BASE:1.20
	OPENBSD_4_2:1.20.0.12
	OPENBSD_4_2_BASE:1.20
	OPENBSD_4_1:1.20.0.10
	OPENBSD_4_1_BASE:1.20
	OPENBSD_4_0:1.20.0.8
	OPENBSD_4_0_BASE:1.20
	OPENBSD_3_9:1.20.0.6
	OPENBSD_3_9_BASE:1.20
	OPENBSD_3_8:1.20.0.4
	OPENBSD_3_8_BASE:1.20
	OPENBSD_3_7:1.20.0.2
	OPENBSD_3_7_BASE:1.20
	OPENBSD_3_6:1.19.0.2
	OPENBSD_3_6_BASE:1.19
	SMP_SYNC_A:1.18
	SMP_SYNC_B:1.18
	OPENBSD_3_5:1.18.0.4
	OPENBSD_3_5_BASE:1.18
	OPENBSD_3_4:1.18.0.2
	OPENBSD_3_4_BASE:1.18
	UBC_SYNC_A:1.16
	OPENBSD_3_3:1.16.0.4
	OPENBSD_3_3_BASE:1.16
	OPENBSD_3_2:1.16.0.2
	OPENBSD_3_2_BASE:1.16
	OPENBSD_3_1:1.14.0.4
	OPENBSD_3_1_BASE:1.14
	UBC_SYNC_B:1.16
	UBC:1.14.0.2
	UBC_BASE:1.14
	OPENBSD_3_0:1.12.0.2
	OPENBSD_3_0_BASE:1.12
	OPENBSD_2_9:1.6.0.2
	OPENBSD_2_9_BASE:1.6
	OPENBSD_2_8:1.4.0.2
	OPENBSD_2_8_BASE:1.4
	OPENBSD_2_7:1.3.0.4
	OPENBSD_2_7_BASE:1.3
	SMP:1.3.0.2
	SMP_BASE:1.3
	kame_19991208:1.2
	OPENBSD_2_6:1.2.0.8
	OPENBSD_2_6_BASE:1.2
	OPENBSD_2_5:1.2.0.6
	OPENBSD_2_5_BASE:1.2
	OPENBSD_2_4:1.2.0.4
	OPENBSD_2_4_BASE:1.2
	OPENBSD_2_3:1.2.0.2
	OPENBSD_2_3_BASE:1.2
	OPENBSD_2_2:1.1.0.4
	OPENBSD_2_2_BASE:1.1
	OPENBSD_2_1:1.1.0.2
	OPENBSD_2_1_BASE:1.1;
locks; strict;
comment	@# @;


1.24
date	2014.03.18.22.36.34;	author miod;	state dead;
branches;
next	1.23;

1.23
date	2009.03.01.22.08.13;	author miod;	state Exp;
branches;
next	1.22;

1.22
date	2009.03.01.21.40.49;	author miod;	state Exp;
branches;
next	1.21;

1.21
date	2009.02.18.20.48.02;	author miod;	state Exp;
branches;
next	1.20;

1.20
date	2004.09.29.07.34.42;	author miod;	state Exp;
branches;
next	1.19;

1.19
date	2004.07.30.09.50.17;	author miod;	state Exp;
branches;
next	1.18;

1.18
date	2003.06.02.23.27.51;	author millert;	state Exp;
branches;
next	1.17;

1.17
date	2003.06.02.05.09.14;	author deraadt;	state Exp;
branches;
next	1.16;

1.16
date	2002.04.25.22.32.02;	author miod;	state Exp;
branches;
next	1.15;

1.15
date	2002.04.18.21.41.01;	author miod;	state Exp;
branches;
next	1.14;

1.14
date	2001.11.17.21.35.12;	author mickey;	state Exp;
branches
	1.14.2.1;
next	1.13;

1.13
date	2001.11.06.19.53.15;	author miod;	state Exp;
branches;
next	1.12;

1.12
date	2001.09.16.14.28.04;	author miod;	state Exp;
branches;
next	1.11;

1.11
date	2001.08.31.00.37.20;	author miod;	state Exp;
branches;
next	1.10;

1.10
date	2001.08.30.22.10.50;	author miod;	state Exp;
branches;
next	1.9;

1.9
date	2001.08.21.00.26.28;	author miod;	state Exp;
branches;
next	1.8;

1.8
date	2001.06.27.04.19.17;	author art;	state Exp;
branches;
next	1.7;

1.7
date	2001.06.26.21.35.41;	author miod;	state Exp;
branches;
next	1.6;

1.6
date	2001.04.05.20.39.38;	author deraadt;	state Exp;
branches;
next	1.5;

1.5
date	2001.03.12.07.38.29;	author smurph;	state Exp;
branches;
next	1.4;

1.4
date	2000.07.06.12.56.18;	author art;	state Exp;
branches;
next	1.3;

1.3
date	2000.01.06.03.21.43;	author smurph;	state Exp;
branches
	1.3.2.1;
next	1.2;

1.2
date	97.11.20.20.35.17;	author etheisen;	state Exp;
branches;
next	1.1;

1.1
date	97.03.31.00.24.11;	author downsj;	state Exp;
branches;
next	;

1.3.2.1
date	2001.04.18.16.10.38;	author niklas;	state Exp;
branches;
next	1.3.2.2;

1.3.2.2
date	2001.07.04.10.19.35;	author niklas;	state Exp;
branches;
next	1.3.2.3;

1.3.2.3
date	2001.10.31.03.01.17;	author nate;	state Exp;
branches;
next	1.3.2.4;

1.3.2.4
date	2001.11.13.21.04.14;	author niklas;	state Exp;
branches;
next	1.3.2.5;

1.3.2.5
date	2001.12.05.00.39.11;	author niklas;	state Exp;
branches;
next	1.3.2.6;

1.3.2.6
date	2003.03.27.23.32.17;	author niklas;	state Exp;
branches;
next	1.3.2.7;

1.3.2.7
date	2003.06.07.11.13.15;	author ho;	state Exp;
branches;
next	;

1.14.2.1
date	2002.06.11.03.36.50;	author art;	state Exp;
branches;
next	;


desc
@@


1.24
log
@Retire hp300, mvme68k and mvme88k ports. These ports have no users, keeping
this hardware alive is becoming increasingly difficult, and I should heed the
message sent by the three disks which have died on me over the last few days.

Noone sane will mourn these ports anyway. So long, and thanks for the fish.
@
text
@#	$OpenBSD: genassym.cf,v 1.23 2009/03/01 22:08:13 miod Exp $

#
# Copyright (c) 1995 Theo de Raadt
# 
# Redistribution and use in source and binary forms, with or without
# modification, are permitted provided that the following conditions
# are met:
# 1. Redistributions of source code must retain the above copyright
#    notice, this list of conditions and the following disclaimer.
# 2. Redistributions in binary form must reproduce the above copyright
#    notice, this list of conditions and the following disclaimer in the
#    documentation and/or other materials provided with the distribution.
#
# THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS
# OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
# WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
# ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY
# DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
# DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
# OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
# HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
# LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
# OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
# SUCH DAMAGE.
#
# Copyright (c) 1982, 1990, 1993
#	The Regents of the University of California.  All rights reserved.
#
# Redistribution and use in source and binary forms, with or without
# modification, are permitted provided that the following conditions
# are met:
# 1. Redistributions of source code must retain the above copyright
#    notice, this list of conditions and the following disclaimer.
# 2. Redistributions in binary form must reproduce the above copyright
#    notice, this list of conditions and the following disclaimer in the
#    documentation and/or other materials provided with the distribution.
# 3. Neither the name of the University nor the names of its contributors
#    may be used to endorse or promote products derived from this software
#    without specific prior written permission.
#
# THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
# ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
# IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
# ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
# FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
# DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
# OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
# HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
# LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
# OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
# SUCH DAMAGE.
#
#	@@(#)genassym.c	8.3 (Berkeley) 1/4/94
#

include <sys/param.h>
include <sys/buf.h>
include <sys/proc.h>
include <sys/mbuf.h>
include <sys/msgbuf.h>
include <sys/syscall.h>
include <sys/types.h>
include <sys/user.h>

include <uvm/uvm_extern.h>

include <machine/cpu.h>
include <machine/psl.h>
include <machine/nvram.h>
include <machine/reg.h>
include <machine/autoconf.h>
include <machine/prom.h>
include <machine/pte.h>

# general constants
export	USPACE
export	PGSHIFT
export	USRSTACK

# proc fields and values
struct	proc
member	P_MD_FLAGS		p_md.md_flags
member	P_MD_REGS		p_md.md_regs

# PSL values
export	PSL_S
export	PSL_IPL7
export	PSL_LOWIPL	
export	PSL_USER
define	SPL1			PSL_S | PSL_IPL1

# pte/ste bits
export	PG_FRAME

# pcb fields
struct	pcb
member	pcb_ps
member	pcb_usp
member	pcb_regs
member	PCB_FPCTX		pcb_fpregs
define	SIZEOF_PCB		sizeof(struct pcb)

# exception frame size
define	FR_SIZE			sizeof(struct trapframe)

define	SIZEOF_MVMEPROM_BRDID	sizeof(struct mvmeprom_brdid)
define	MVMEPROM_BRDID_MODEL	offsetof(struct mvmeprom_brdid, model)

struct	nvram_147		NVRAM_147_
member	ether
member	emem

export	INTIOBASE_141
export	INTIOBASE_147
export	INTIOBASE_162
export	INTIOBASE_165
export	INTIOSIZE_141
export	INTIOSIZE_147
export	INTIOSIZE_162
export	INTIOSIZE_165

export	CPU_141
export	CPU_147
export	CPU_162
export	CPU_165
export	CPU_166
export	CPU_167
export	CPU_172
export	CPU_176
export	CPU_177

export	BUS_LRC
export	BUS_MC
export	BUS_OFOBIO
export	BUS_PCC
export	BUS_PCCTWO

struct	prom_netctrl		NETCTRL_
member	dev
member	ctrl
member	cmd
member	addr
member	len
@


1.23
log
@Support for MVME141 boards. Tested with both VME and VSB memory boards
(and MVME327 SCSI and MVME376 Ethernet, to provide a complete system).
@
text
@d1 1
a1 1
#	$OpenBSD: genassym.cf,v 1.22 2009/03/01 21:40:49 miod Exp $
@


1.22
log
@Support for MVME165 board - code written in april 2006, eventually debugged
last month.
@
text
@d1 1
a1 1
#	$OpenBSD: genassym.cf,v 1.21 2009/02/18 20:48:02 miod Exp $
d114 1
d118 1
d123 1
d135 1
@


1.21
log
@delay() would only work as intended after clock0 attached. Initialize the
delay strategy variable in locore now; this fixes the occasional console
output artefacts on MVME177.
@
text
@d1 1
a1 1
#	$OpenBSD: genassym.cf,v 1.20 2004/09/29 07:34:42 miod Exp $
d116 1
d119 1
d123 1
d127 1
d130 1
@


1.20
log
@Do not count 060SP traps; there are too many of them, better handle them
as fast as possible.
@
text
@d1 1
a1 1
#	$OpenBSD: genassym.cf,v 1.19 2004/07/30 09:50:17 miod Exp $
d125 4
@


1.19
log
@Switch mvme68k to evcount interrupt counters.
@
text
@d1 1
a1 1
#	$OpenBSD: genassym.cf,v 1.18 2003/06/02 23:27:51 millert Exp $
a64 1
include <sys/evcount.h>
a131 3

struct	evcount
member	ec_count32
@


1.18
log
@Remove the advertising clause in the UCB license which Berkeley
rescinded 22 July 1999.  Proofed by myself and Theo.
@
text
@d1 1
a1 1
#	$OpenBSD: genassym.cf,v 1.17 2003/06/02 05:09:14 deraadt Exp $
d65 1
d133 3
@


1.17
log
@license cleanup of my files
@
text
@d1 1
a1 1
#	$OpenBSD: genassym.cf,v 1.16 2002/04/25 22:32:02 miod Exp $
d38 1
a38 5
# 3. All advertising materials mentioning features or use of this software
#    must display the following acknowledgement:
#	This product includes software developed by the University of
#	California, Berkeley and its contributors.
# 4. Neither the name of the University nor the names of its contributors
@


1.16
log
@Factorize more common m68k definitions.
@
text
@d1 1
a1 1
#	$OpenBSD: genassym.cf,v 1.15 2002/04/18 21:41:01 miod Exp $
a13 6
# 3. All advertising materials mentioning features or use of this software
#    must display the following acknowledgement:
#	This product includes software developed under OpenBSD by
#	Theo de Raadt for Willowglen Singapore.
# 4. The name of the author may not be used to endorse or promote products
#    derived from this software without specific prior written permission.
@


1.15
log
@- use a define instead of a hardcoded value for 68040 cache control
- 68060 FPU operations should test fputype, not mmutype, for 060 land,
  if only for consistency reasons.
Tested by deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: genassym.cf,v 1.14 2001/11/17 21:35:12 mickey Exp $
a102 11
# magic
export	CACHE_ON
export	CACHE_OFF
export	CACHE_CLR
export	IC_CLEAR
export	DC_CLEAR
export	CACHE40_ON
export	CACHE60_ON
export	IC60_CUBC
export	IC60_CABC

a134 12

export	MMU_68030
export	MMU_68040
export	MMU_68060

export	CPU_68030
export	CPU_68040
export	CPU_68060

export	FPU_68881
export	FPU_68040
export	FPU_68060
@


1.14
log
@put more common stuff into m68k/genassym.cf; miod@@ ok
@
text
@d1 1
a1 1
#	$OpenBSD: genassym.cf,v 1.13 2001/11/06 19:53:15 miod Exp $
d109 1
@


1.14.2.1
log
@Sync UBC branch to -current
@
text
@d1 1
a1 1
#	$OpenBSD: genassym.cf,v 1.14 2001/11/17 21:35:12 mickey Exp $
d103 10
d145 12
@


1.13
log
@Replace inclusion of <vm/foo.h> with the correct <uvm/bar.h> when necessary.
(Look ma, I might have broken the tree)
@
text
@d1 1
a1 1
#	$OpenBSD: genassym.cf,v 1.12 2001/09/16 14:28:04 miod Exp $
a92 1
member	p_addr
a94 4

# interrupt/fault metering
struct	uvmexp			UVMEXP_
member	intrs
@


1.12
log
@Make use of "export", "struct" and "member" keywords to be easier to read
and simpler.
@
text
@d1 1
a1 1
#	$OpenBSD: genassym.cf,v 1.11 2001/08/31 00:37:20 miod Exp $
a74 2

include <vm/vm.h>
@


1.11
log
@The fact that my tree builds should not prevent the official tree to
build as well... Right now, .s files can't include unmodified <machine/psl.h>
@
text
@d1 1
a1 1
#	$OpenBSD: genassym.cf,v 1.10 2001/08/30 22:10:50 miod Exp $
d89 3
a91 3
define	USPACE			USPACE
define	PGSHIFT			PGSHIFT
define	USRSTACK		USRSTACK
d94 4
a97 3
define	P_ADDR			offsetof(struct proc, p_addr)
define	P_MD_FLAGS		offsetof(struct proc, p_md.md_flags)
define	P_MD_REGS		offsetof(struct proc, p_md.md_regs)
d100 2
a101 1
define	UVMEXP_INTRS		offsetof(struct uvmexp, intrs)
d104 4
a107 4
define	PSL_S			PSL_S
define	PSL_IPL7		PSL_IPL7
define	PSL_LOWIPL		PSL_LOWIPL
define	PSL_USER		PSL_USER
d111 8
a118 8
define	CACHE_ON		CACHE_ON
define	CACHE_OFF		CACHE_OFF
define	CACHE_CLR		CACHE_CLR
define	IC_CLEAR		IC_CLEAR
define	DC_CLEAR		DC_CLEAR
define	CACHE60_ON		CACHE60_ON
define	IC60_CUBC		IC60_CUBC
define	IC60_CABC		IC60_CABC
d121 1
a121 1
define	PG_FRAME		PG_FRAME
d124 5
a128 4
define	PCB_PS			offsetof(struct pcb, pcb_ps)
define	PCB_USP			offsetof(struct pcb, pcb_usp)
define	PCB_REGS		offsetof(struct pcb, pcb_regs)
define	PCB_FPCTX		offsetof(struct pcb, pcb_fpregs)
a133 1

d137 34
a170 32
define	NVRAM_147_ETHER		offsetof(struct nvram_147, ether)
define	NVRAM_147_EMEM		offsetof(struct nvram_147, emem)

define	INTIOBASE_147		INTIOBASE_147
define	INTIOBASE_162		INTIOBASE_162
define	INTIOSIZE_147		INTIOSIZE_147
define	INTIOSIZE_162		INTIOSIZE_162

define	CPU_147			CPU_147
define	CPU_162			CPU_162
define	CPU_166			CPU_166
define	CPU_167			CPU_167
define	CPU_172			CPU_172
define	CPU_177			CPU_177

define	MMU_68030		MMU_68030
define	MMU_68040		MMU_68040
define	MMU_68060		MMU_68060

define	CPU_68030		CPU_68030
define	CPU_68040		CPU_68040
define	CPU_68060		CPU_68060

define	FPU_68881		FPU_68881
define	FPU_68040		FPU_68040
define	FPU_68060		FPU_68060

define	NETCTRL_DEV		offsetof(struct prom_netctrl, dev)
define	NETCTRL_CTRL		offsetof(struct prom_netctrl, ctrl)
define	NETCTRL_CMD		offsetof(struct prom_netctrl, cmd)
define	NETCTRL_ADDR		offsetof(struct prom_netctrl, addr)
define	NETCTRL_LEN		offsetof(struct prom_netctrl, len)
@


1.10
log
@Remove duplicates with m68k/m68k/genassym.cf
@
text
@d1 1
a1 1
#	$OpenBSD: genassym.cf,v 1.9 2001/08/21 00:26:28 miod Exp $
d81 1
d102 4
@


1.9
log
@Remove some bloat.
@
text
@d1 1
a1 1
#	$OpenBSD: genassym.cf,v 1.8 2001/06/27 04:19:17 art Exp $
a80 2
include <machine/trap.h>
include <machine/psl.h>
a88 1
define	NBPG			NBPG
a92 2
define	P_FORW			offsetof(struct proc, p_forw)
define	P_BACK			offsetof(struct proc, p_back)
a93 3
define	P_PRIORITY		offsetof(struct proc, p_priority)
define	P_STAT			offsetof(struct proc, p_stat)
define	P_WCHAN			offsetof(struct proc, p_wchan)
a96 2
define	SRUN			SRUN

d100 1
a100 25
# trap types (should just include trap.h?)
define	T_BUSERR		T_BUSERR
define	T_ADDRERR		T_ADDRERR
define	T_ILLINST		T_ILLINST
define	T_ZERODIV		T_ZERODIV
define	T_CHKINST		T_CHKINST
define	T_TRAPVINST		T_TRAPVINST
define	T_PRIVINST		T_PRIVINST
define	T_TRACE			T_TRACE
define	T_MMUFLT		T_MMUFLT
define	T_SSIR			T_SSIR
define	T_FMTERR		T_FMTERR
define	T_COPERR		T_COPERR
define	T_FPERR			T_FPERR
define	T_ASTFLT		T_ASTFLT
define	T_TRAP15		T_TRAP15
define	T_FPEMULI		T_FPEMULI
define	T_FPEMULD		T_FPEMULD

# PSL values (should just include psl.h?)
define	PSL_S			PSL_S
define	PSL_IPL7		PSL_IPL7
define	PSL_LOWIPL		PSL_LOWIPL
define	PSL_HIGHIPL		PSL_HIGHIPL
define	PSL_USER		PSL_USER
a103 1
define	FC_USERD		FC_USERD
a119 1
define	PCB_ONFAULT		offsetof(struct pcb, pcb_onfault)
d123 1
a123 4
# exception frame offset/sizes
define	FR_SP			offsetof(struct frame, f_regs[15])
define	FR_HW			offsetof(struct frame, f_sr)
define	FR_ADJ			offsetof(struct frame, f_stackadj)
a125 6
# system calls
define	SYS_sigreturn		SYS_sigreturn

# errno
define	EFAULT			EFAULT
define	ENAMETOOLONG		ENAMETOOLONG
@


1.8
log
@zap old vm
@
text
@d1 1
a1 1
#	$OpenBSD: genassym.cf,v 1.7 2001/06/26 21:35:41 miod Exp $
a68 1
include <sys/map.h>
d73 1
d76 4
a87 24
include <vm/vm.h>

include <uvm/uvm_extern.h>

define	__XXX_BUG_FODDER	0

# CPU options
ifdef M68020
define	M68020			1
endif
ifdef M68030
define	M68030			1
endif
ifdef M68040
define	M68040			1
endif
ifdef M68060
define	M68060			1
endif

# MMU options
ifdef M68K_MMU_MOTOROLA
define	M68K_MMU_MOTOROLA	1
endif
a89 1
define	UPAGES			UPAGES
a97 1
define	P_VMSPACE		offsetof(struct proc, p_vmspace)
a101 1
define	P_FLAG			offsetof(struct proc, p_flag)
a104 1
define	SSLEEP			SSLEEP
a135 5
define	SPL2			PSL_S | PSL_IPL2
define	SPL3			PSL_S | PSL_IPL3
define	SPL4			PSL_S | PSL_IPL4
define	SPL5			PSL_S | PSL_IPL5
define	SPL6			PSL_S | PSL_IPL6
a138 1
define	EIOMAPSIZE		EIOMAPSIZE
a144 1
define	CACHE60_OFF		CACHE60_OFF
a148 6
define	PG_V			PG_V
define	PG_NV			PG_NV
define	PG_RO			PG_RO
define	PG_RW			PG_RW
define	PG_CI			PG_CI
define	PG_PROT			PG_PROT
a149 5
define	SG_V			SG_V
define	SG_NV			SG_NV
define	SG_RW			SG_RW
define	SG_FRAME		SG_FRAME
define	SG_ISHIFT		SG_ISHIFT
a157 1
define	SIZEOF_TRAPFRAME	sizeof(struct trapframe)
a165 2
define	SYS_exit		SYS_exit
define	SYS_execve		SYS_execve
a177 2
define	NVRAM_16X_ETHER		offsetof(struct nvram_16x, conf.ether)

a189 1
define	MMU_68851		MMU_68851
a193 1
define	CPU_68020		CPU_68020
a198 1
define	FPU_68882		FPU_68882
@


1.7
log
@A few changes to mvme68k:
+ switch to UVM
+ fix the system trace problem
+ big cleanup of locore.s (macro for BUG calls, use more common m68k
  code whenever possible, and the macros in <m68k/asm.h>)
+ better indentation on some parts (old KNF)
+ call doshutdownhooks() at shutdown
+ use <net/netisr_dispatch.h>
+ upgrade pmap.c to something very close to our current hp300 pmap.c,
  minus support for PMAP_NEW and for HP MMU
+ various tidbits I forget to mention here

work and tests by smurph@@ and me.
@
text
@d1 1
a1 1
#	$OpenBSD: genassym.cf,v 1.6 2001/04/05 20:39:38 deraadt Exp $
a85 1
ifdef UVM
a86 1
endif
a131 1
ifdef UVM	
a132 3
else
define	V_INTR			offsetof(struct vmmeter, v_intr)
endif
@


1.6
log
@undo changes which did not even compile
@
text
@d1 1
a1 1
#	$OpenBSD: genassym.cf,v 1.4 2000/07/06 12:56:18 art Exp $
d86 4
d134 3
a136 1
define	V_SWTCH			offsetof(struct vmmeter, v_swtch)
d138 1
d212 1
@


1.5
log
@Initial code for UVM.  not tested yet...
@
text
@a85 4
ifdef UVM
include <uvm/uvm_extern.h>
endif

a130 4

ifdef UVM	
define	UVMEXP_INTRS		offsetof(struct uvmexp, intrs)
else
a131 1
endif
@


1.4
log
@Fix pmap_activate and activation of the
correct pmap.
@
text
@d1 1
a1 1
#	$OpenBSD: genassym.cf,v 1.3 2000/01/06 03:21:43 smurph Exp $
d86 4
d135 4
d140 1
@


1.3
log
@Added support for MVME177 (mc68060)
@
text
@d1 1
a1 1
#	$OpenBSD: genassym.cf,v 1.2 1997/11/20 20:35:17 etheisen Exp $
a128 4
# VM structure fields
define	VM_PMAP			offsetof(struct vmspace, vm_pmap)
define	PM_STCHG		offsetof(struct pmap, pm_stchanged)

a193 1
define	PCB_USTP		offsetof(struct pcb, pcb_ustp)
@


1.3.2.1
log
@Update the SMP branch to -current, this breaks the SMP branch though.
But it will be fixed soonish.  Note, nothing new has happened, this is just
a merge of the trunk into this branch.
@
text
@d1 1
a1 1
#	$OpenBSD: genassym.cf,v 1.6 2001/04/05 20:39:38 deraadt Exp $
d129 4
d198 1
@


1.3.2.2
log
@Merge in -current from two days ago in the SMP branch.
As usual with merges, they do not indicate progress, so do not hold
your breath for working SMP, and do not mail me and ask about the
state of it.  It has not changed.  There is work ongoing, but very, very
slowly.  The commit is done in parts as to not lock up the tree in too
big chunks at a time.
@
text
@d1 1
a1 1
#	$OpenBSD: genassym.cf,v 1.3.2.1 2001/04/18 16:10:38 niklas Exp $
a85 2
include <uvm/uvm_extern.h>

d130 2
a131 1
define	UVMEXP_INTRS		offsetof(struct uvmexp, intrs)
a204 1
define	FR_SIZE			sizeof(struct trapframe)
@


1.3.2.3
log
@Sync the SMP branch to something just after 3.0
@
text
@d1 1
a1 1
#	$OpenBSD: genassym.cf,v 1.3.2.2 2001/07/04 10:19:35 niklas Exp $
d69 1
a73 1
include <sys/types.h>
a75 4
include <vm/vm.h>

include <uvm/uvm_extern.h>

d77 1
d84 24
d110 5
a114 3
export	USPACE
export	PGSHIFT
export	USRSTACK
d117 13
a129 4
struct	proc
member	p_addr
member	P_MD_FLAGS		p_md.md_flags
member	P_MD_REGS		p_md.md_regs
d132 1
a132 2
struct	uvmexp			UVMEXP_
member	intrs
d134 25
a158 5
# PSL values
export	PSL_S
export	PSL_IPL7
export	PSL_LOWIPL	
export	PSL_USER
d160 5
d167 11
a177 8
export	CACHE_ON
export	CACHE_OFF
export	CACHE_CLR
export	IC_CLEAR
export	DC_CLEAR
export	CACHE60_ON
export	IC60_CUBC
export	IC60_CABC
d180 12
a191 1
export	PG_FRAME
d194 5
a198 5
struct	pcb
member	pcb_ps
member	pcb_usp
member	pcb_regs
member	PCB_FPCTX		pcb_fpregs
d200 1
d202 4
a205 1
# exception frame size
d208 9
d220 37
a256 34
struct	nvram_147		NVRAM_147_
member	ether
member	emem

export	INTIOBASE_147
export	INTIOBASE_162
export	INTIOSIZE_147
export	INTIOSIZE_162

export	CPU_147
export	CPU_162
export	CPU_166
export	CPU_167
export	CPU_172
export	CPU_177

export	MMU_68030
export	MMU_68040
export	MMU_68060

export	CPU_68030
export	CPU_68040
export	CPU_68060

export	FPU_68881
export	FPU_68040
export	FPU_68060

struct	prom_netctrl		NETCTRL_
member	dev
member	ctrl
member	cmd
member	addr
member	len
@


1.3.2.4
log
@Merge in -current
@
text
@d1 1
a1 1
#	$OpenBSD$
d75 2
@


1.3.2.5
log
@Merge in -current
@
text
@d1 1
a1 1
#	$OpenBSD: genassym.cf,v 1.3.2.4 2001/11/13 21:04:14 niklas Exp $
d93 1
d96 4
@


1.3.2.6
log
@Sync the SMP branch with 3.3
@
text
@d1 1
a1 1
#	$OpenBSD$
d103 10
d145 12
@


1.3.2.7
log
@Sync SMP branch to -current
@
text
@d1 1
a1 1
#	$OpenBSD: genassym.cf,v 1.3.2.6 2003/03/27 23:32:17 niklas Exp $
d14 6
d44 5
a48 1
# 3. Neither the name of the University nor the names of its contributors
@


1.2
log
@define MMU_68060
@
text
@d1 1
a1 1
#	$OpenBSD: genassym.c,v 1.4 1997/02/10 17:49:11 deraadt Exp $
d177 4
@


1.1
log
@Modernize OpenBSD/mvme68k to match various changes in m68k and hp300 code.

Compiles, but untested for lack of hardware.
@
text
@d239 1
@
