head	1.19;
access;
symbols
	OPENBSD_5_5:1.18.0.14
	OPENBSD_5_5_BASE:1.18
	OPENBSD_5_4:1.18.0.10
	OPENBSD_5_4_BASE:1.18
	OPENBSD_5_3:1.18.0.8
	OPENBSD_5_3_BASE:1.18
	OPENBSD_5_2:1.18.0.6
	OPENBSD_5_2_BASE:1.18
	OPENBSD_5_1_BASE:1.18
	OPENBSD_5_1:1.18.0.4
	OPENBSD_5_0:1.18.0.2
	OPENBSD_5_0_BASE:1.18
	OPENBSD_4_9:1.17.0.4
	OPENBSD_4_9_BASE:1.17
	OPENBSD_4_8:1.17.0.2
	OPENBSD_4_8_BASE:1.17
	OPENBSD_4_7:1.14.0.4
	OPENBSD_4_7_BASE:1.14
	OPENBSD_4_6:1.14.0.6
	OPENBSD_4_6_BASE:1.14
	OPENBSD_4_5:1.14.0.2
	OPENBSD_4_5_BASE:1.14
	OPENBSD_4_4:1.13.0.10
	OPENBSD_4_4_BASE:1.13
	OPENBSD_4_3:1.13.0.8
	OPENBSD_4_3_BASE:1.13
	OPENBSD_4_2:1.13.0.6
	OPENBSD_4_2_BASE:1.13
	OPENBSD_4_1:1.13.0.4
	OPENBSD_4_1_BASE:1.13
	OPENBSD_4_0:1.13.0.2
	OPENBSD_4_0_BASE:1.13
	OPENBSD_3_9:1.11.0.2
	OPENBSD_3_9_BASE:1.11
	OPENBSD_3_8:1.10.0.4
	OPENBSD_3_8_BASE:1.10
	OPENBSD_3_7:1.10.0.2
	OPENBSD_3_7_BASE:1.10
	OPENBSD_3_6:1.9.0.14
	OPENBSD_3_6_BASE:1.9
	SMP_SYNC_A:1.9
	SMP_SYNC_B:1.9
	OPENBSD_3_5:1.9.0.12
	OPENBSD_3_5_BASE:1.9
	OPENBSD_3_4:1.9.0.10
	OPENBSD_3_4_BASE:1.9
	UBC_SYNC_A:1.9
	OPENBSD_3_3:1.9.0.8
	OPENBSD_3_3_BASE:1.9
	OPENBSD_3_2:1.9.0.6
	OPENBSD_3_2_BASE:1.9
	OPENBSD_3_1:1.9.0.4
	OPENBSD_3_1_BASE:1.9
	UBC_SYNC_B:1.9
	UBC:1.9.0.2
	UBC_BASE:1.9
	OPENBSD_3_0:1.8.0.2
	OPENBSD_3_0_BASE:1.8
	OPENBSD_2_9:1.4.0.2
	OPENBSD_2_9_BASE:1.4
	OPENBSD_2_8:1.3.0.6
	OPENBSD_2_8_BASE:1.3
	OPENBSD_2_7:1.3.0.4
	OPENBSD_2_7_BASE:1.3
	SMP:1.3.0.2
	SMP_BASE:1.3;
locks; strict;
comment	@# @;


1.19
date	2014.03.18.22.36.34;	author miod;	state dead;
branches;
next	1.18;

1.18
date	2011.06.29.20.52.09;	author matthew;	state Exp;
branches;
next	1.17;

1.17
date	2010.07.03.03.59.17;	author krw;	state Exp;
branches;
next	1.16;

1.16
date	2010.07.02.19.57.14;	author tedu;	state Exp;
branches;
next	1.15;

1.15
date	2010.06.29.20.30.33;	author guenther;	state Exp;
branches;
next	1.14;

1.14
date	2009.02.17.22.28.38;	author miod;	state Exp;
branches;
next	1.13;

1.13
date	2006.06.24.14.07.06;	author miod;	state Exp;
branches;
next	1.12;

1.12
date	2006.04.21.22.21.53;	author miod;	state Exp;
branches;
next	1.11;

1.11
date	2005.11.27.14.19.07;	author miod;	state Exp;
branches;
next	1.10;

1.10
date	2004.09.16.09.14.03;	author mickey;	state Exp;
branches;
next	1.9;

1.9
date	2001.11.08.23.53.10;	author miod;	state Exp;
branches;
next	1.8;

1.8
date	2001.08.03.21.16.04;	author miod;	state Exp;
branches;
next	1.7;

1.7
date	2001.06.27.05.46.20;	author art;	state Exp;
branches;
next	1.6;

1.6
date	2001.06.26.21.35.25;	author miod;	state Exp;
branches;
next	1.5;

1.5
date	2001.06.12.22.51.43;	author miod;	state Exp;
branches;
next	1.4;

1.4
date	2001.02.18.17.41.02;	author deraadt;	state Exp;
branches;
next	1.3;

1.3
date	2000.01.27.03.14.29;	author smurph;	state Exp;
branches
	1.3.2.1;
next	1.2;

1.2
date	2000.01.25.04.18.17;	author smurph;	state Exp;
branches;
next	1.1;

1.1
date	2000.01.06.03.28.24;	author smurph;	state Exp;
branches;
next	;

1.3.2.1
date	2001.04.18.16.10.20;	author niklas;	state Exp;
branches;
next	1.3.2.2;

1.3.2.2
date	2001.07.04.10.19.21;	author niklas;	state Exp;
branches;
next	1.3.2.3;

1.3.2.3
date	2001.10.31.03.01.17;	author nate;	state Exp;
branches;
next	1.3.2.4;

1.3.2.4
date	2001.11.13.21.04.14;	author niklas;	state Exp;
branches;
next	;


desc
@@


1.19
log
@Retire hp300, mvme68k and mvme88k ports. These ports have no users, keeping
this hardware alive is becoming increasingly difficult, and I should heed the
message sent by the three disks which have died on me over the last few days.

Noone sane will mourn these ports anyway. So long, and thanks for the fish.
@
text
@#	$OpenBSD: MVME177,v 1.18 2011/06/29 20:52:09 matthew Exp $

machine		mvme68k m68k

include "../../../conf/GENERIC"

option		M68060		# support for 060
option		M060SP		# ...and MC68060 support package

option		MVME177		# (requires M68060, 060SP, FPSP)

maxusers	32

config		bsd		swap generic

mainbus0 at root

# MVME166/167/177
pcctwo0 at mainbus0 addr 0xfff00000
clock0	at pcctwo0 ipl 5
nvram0	at pcctwo0 offset 0xc0000
ie0	at pcctwo0 offset 0x46000 ipl 3
osiop0	at pcctwo0 offset 0x47000 ipl 2
cl0	at pcctwo0 offset 0x45000 ipl 3
vme0	at pcctwo0 offset 0x40000
#lptwo0	at pcctwo0 ipl 1
memc0	at pcctwo0 offset 0x43000
memc1	at pcctwo0 offset 0x43100
sram0	at mainbus0 addr 0xffe00000

vmes0	at vme0

# MVME327
vsbic*	at vmes0 addr 0xffffa600 ipl 2 vec 0x8c
vsbic*	at vmes0 addr 0xffffa700 ipl 2 vec 0x8d
# MVME328, MVME328XT
vs*	at vmes0 addr 0xffff9000 ipl 2 vec 0x80
vs*	at vmes0 addr 0xffff9800 ipl 2 vec 0x82
vs*	at vmes0 addr 0xffff4800 ipl 2 vec 0x84
vs*	at vmes0 addr 0xffff5800 ipl 2 vec 0x86
vs*	at vmes0 addr 0xffff7000 ipl 2 vec 0x88
vs*	at vmes0 addr 0xffff7800 ipl 2 vec 0x8a
# MVME376
le*	at vmes0 addr 0xffff1200 ipl 3 vec 0x74
le*	at vmes0 addr 0xffff1400 ipl 3 vec 0x75
le*	at vmes0 addr 0xffff1600 ipl 3 vec 0x76

vmel0	at vme0


scsibus* at scsi?
sd*	at scsibus?
st*	at scsibus?
cd*	at scsibus?
ch*	at scsibus?
safte*	at scsibus?
ses*	at scsibus?
uk*	at scsibus?
@


1.18
log
@Replace all instances of "scsibus* at hba?" with a single "scsibus* at
scsi?" rule, similar to how ethernet PHY drivers attach at mii.

Discussed on icb.
@
text
@d1 1
a1 1
#	$OpenBSD: MVME177,v 1.17 2010/07/03 03:59:17 krw Exp $
@


1.17
log
@No more ss(4) or usscanner(4). Unused, unloved and unmaintained.
General huzzahs.

"go for it" deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: MVME177,v 1.16 2010/07/02 19:57:14 tedu Exp $
a49 3
scsibus* at osiop?
scsibus* at vs?
scsibus* at vsbic?
d51 1
@


1.16
log
@remove support for compat_sunos (and m68k4k).  ok deraadt guenther
@
text
@d1 1
a1 1
#	$OpenBSD: MVME177,v 1.15 2010/06/29 20:30:33 guenther Exp $
a57 1
ss*	at scsibus?
@


1.15
log
@Remove COMPAT_HPUX.  No one wanted to support it and its fewmets were
blocking other cleanups
ok miod@@
@
text
@d1 1
a1 1
#	$OpenBSD: MVME177,v 1.14 2009/02/17 22:28:38 miod Exp $
a10 3

option		COMPAT_SUNOS
option		COMPAT_M68K4K
@


1.14
log
@Add real bus_space and bus_dma to mvme68k, so that it can benefit from
recent driver work; this gives us better osiop and vs drivers, vsbic
(although currently disabled on 68060 boards until more bugs are fixed),
and the ability to boot and root off vs and vsbic.

Existing code is not modified and still uses memory mapped structures;
this might change eventually as more code gets factorized and moved to
MI land.
@
text
@d1 1
a1 1
#	$OpenBSD: MVME177,v 1.13 2006/06/24 14:07:06 miod Exp $
a12 1
option		COMPAT_HPUX
@


1.13
log
@Configure network devices at ipl 3, not ipl 1.
@
text
@d1 1
a1 1
#	$OpenBSD: MVME177,v 1.12 2006/04/21 22:21:53 miod Exp $
d27 1
a27 1
ssh0	at pcctwo0 offset 0x47000 ipl 2
d37 4
d47 1
a47 1

d54 1
a54 1
scsibus* at ssh?
d56 1
d63 2
@


1.12
log
@Since bugtty (and BUG routines in general) can only work if we keep the BUG
mapped, and we don't, do not bother carrying this code around - it can not
be used anyway.
@
text
@d1 1
a1 1
#	$OpenBSD: MVME177,v 1.11 2005/11/27 14:19:07 miod Exp $
d26 1
a26 1
ie0	at pcctwo0 offset 0x46000 ipl 1
d44 3
a46 3
le*	at vmes0 addr 0xffff1200 ipl 1 vec 0x74
le*	at vmes0 addr 0xffff1400 ipl 1 vec 0x75
le*	at vmes0 addr 0xffff1600 ipl 1 vec 0x76
@


1.11
log
@Get rid of the `len' locator for VME devices, since mappings have a page
granularity anyway; devices who would want more than one page mapped in
order to probe for the hardware can take appropriate action in their cfmatch
routine anyway.
@
text
@d1 1
a1 1
#	$OpenBSD: MVME177,v 1.10 2004/09/16 09:14:03 mickey Exp $
a34 2
bugtty0 at mainbus0

a58 4

#si0	at vmes0 addr 0xff200000 ipl 2 vec 0x40
#nxdc0	at vmes0 addr 0xff00ee80 ipl 2 vec 0x44
#xd*	at xdc?
@


1.10
log
@cleanup deafult locators (blah ?); please check that your most hated architecture is still fluffy (;
@
text
@d1 1
a1 1
#	$OpenBSD: MVME177,v 1.9 2001/11/08 23:53:10 miod Exp $
d39 10
a48 10
vs*	at vmes0 addr 0xffff9000 ipl 2 vec 0x80 len 0x800
vs*	at vmes0 addr 0xffff9800 ipl 2 vec 0x82 len 0x800
vs*	at vmes0 addr 0xffff4800 ipl 2 vec 0x84 len 0x800
vs*	at vmes0 addr 0xffff5800 ipl 2 vec 0x86 len 0x800
vs*	at vmes0 addr 0xffff7000 ipl 2 vec 0x88 len 0x800
vs*	at vmes0 addr 0xffff7800 ipl 2 vec 0x8a len 0x800

le*	at vmes0 addr 0xffff1200 ipl 1 vec 0x74 len 0x100
le*	at vmes0 addr 0xffff1400 ipl 1 vec 0x75 len 0x100
le*	at vmes0 addr 0xffff1600 ipl 1 vec 0x76 len 0x100
@


1.9
log
@There is no point keeping ramdisk support in non-RAMDISK kernels.
@
text
@d1 1
a1 1
#	$OpenBSD: MVME177,v 1.8 2001/08/03 21:16:04 miod Exp $
d55 6
a60 6
sd*	at scsibus? target ? lun ?
st*	at scsibus? target ? lun ?
cd*	at scsibus? target ? lun ?
ch*	at scsibus? target ? lun ?
ss*	at scsibus? target ? lun ?
uk*	at scsibus? target ? lun ?
d64 1
a64 1
#xd*	at xdc? target ?
@


1.8
log
@Make all the low-profile configurations include conf/GENERIC, and
harmonize a bit.
@
text
@d1 1
a1 1
#	$OpenBSD$
a60 2

pseudo-device	rd 2
@


1.7
log
@UVM is no longer an option.
@
text
@d1 1
a1 1
#	$OpenBSD: MVME177,v 1.6 2001/06/26 21:35:25 miod Exp $
a6 2
#option		M68030		# support for 030
#option		M68040		# support for 040
a7 2

option		FPSP		# MC68040 floating point support
a8 1
option		FPU_EMULATE	# FPU emulation
a9 4
#option		MVME147		# (requires M68030)
#option		MVME162		# (requires M68040, FPSP)
#option		MVME167		# includes 166 (requires M68040, FPSP)
#option		MVME172		# (requires M68060, 060SP, FPSP)
@


1.6
log
@A few changes to mvme68k:
+ switch to UVM
+ fix the system trace problem
+ big cleanup of locore.s (macro for BUG calls, use more common m68k
  code whenever possible, and the macros in <m68k/asm.h>)
+ better indentation on some parts (old KNF)
+ call doshutdownhooks() at shutdown
+ use <net/netisr_dispatch.h>
+ upgrade pmap.c to something very close to our current hp300 pmap.c,
  minus support for PMAP_NEW and for HP MMU
+ various tidbits I forget to mention here

work and tests by smurph@@ and me.
@
text
@d1 1
a1 1
#	$OpenBSD: MVME177,v 1.5 2001/06/12 22:51:43 miod Exp $
a5 1
option		UVM
@


1.5
log
@Add ``scsibus* at vs?'', except on model 147, for which the vs driver
has issues.
@
text
@d1 1
a1 1
#	$OpenBSD: MVME177,v 1.4 2001/02/18 17:41:02 deraadt Exp $
d6 1
@


1.4
log
@two siop drivers conflict.  rename to ssh -- short for Symbios Scripts Hardware
@
text
@d1 1
a1 1
#	$OpenBSD: MVME177,v 1.3 2000/01/27 03:14:29 smurph Exp $
d62 1
@


1.3
log
@Took out le* at 0xffffd200.  It conflicts with GCSR on some boards.
@
text
@d1 1
a1 1
#	$OpenBSD: MVME177,v 1.2 2000/01/25 04:18:17 smurph Exp $
d36 1
a36 1
siop0	at pcctwo0 offset 0x47000 ipl 2
d61 1
a61 1
scsibus* at siop?
@


1.3.2.1
log
@Update the SMP branch to -current, this breaks the SMP branch though.
But it will be fixed soonish.  Note, nothing new has happened, this is just
a merge of the trunk into this branch.
@
text
@d1 1
a1 1
#	$OpenBSD: MVME177,v 1.4 2001/02/18 17:41:02 deraadt Exp $
d36 1
a36 1
ssh0	at pcctwo0 offset 0x47000 ipl 2
d61 1
a61 1
scsibus* at ssh?
@


1.3.2.2
log
@Merge in -current from two days ago in the SMP branch.
As usual with merges, they do not indicate progress, so do not hold
your breath for working SMP, and do not mail me and ask about the
state of it.  It has not changed.  There is work ongoing, but very, very
slowly.  The commit is done in parts as to not lock up the tree in too
big chunks at a time.
@
text
@d1 1
a1 1
#	$OpenBSD: MVME177,v 1.3.2.1 2001/04/18 16:10:20 niklas Exp $
a61 1
scsibus* at vs?
@


1.3.2.3
log
@Sync the SMP branch to something just after 3.0
@
text
@d1 1
a1 1
#	$OpenBSD: MVME177,v 1.3.2.2 2001/07/04 10:19:21 niklas Exp $
d7 2
d10 2
d13 1
d15 4
@


1.3.2.4
log
@Merge in -current
@
text
@d1 1
a1 1
#	$OpenBSD$
d61 2
@


1.2
log
@Added support for MVME328 SCSI VME board.
@
text
@d1 1
a1 1
#	$OpenBSD: MVME177,v 1.1 2000/01/06 03:28:24 smurph Exp $
a57 1
le*	at vmes0 addr 0xffffd200 ipl 1 vec 0x77 len 0x100
@


1.1
log
@Add support for MVME177
@
text
@d1 1
a1 1
#	$OpenBSD: GENERIC,v 1.9 1997/03/31 00:23:50 downsj Exp $
d47 13
@

