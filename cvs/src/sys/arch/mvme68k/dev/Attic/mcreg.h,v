head	1.12;
access;
symbols
	OPENBSD_5_5:1.11.0.4
	OPENBSD_5_5_BASE:1.11
	OPENBSD_5_4:1.10.0.4
	OPENBSD_5_4_BASE:1.10
	OPENBSD_5_3:1.10.0.2
	OPENBSD_5_3_BASE:1.10
	OPENBSD_5_2:1.9.0.34
	OPENBSD_5_2_BASE:1.9
	OPENBSD_5_1_BASE:1.9
	OPENBSD_5_1:1.9.0.32
	OPENBSD_5_0:1.9.0.30
	OPENBSD_5_0_BASE:1.9
	OPENBSD_4_9:1.9.0.28
	OPENBSD_4_9_BASE:1.9
	OPENBSD_4_8:1.9.0.26
	OPENBSD_4_8_BASE:1.9
	OPENBSD_4_7:1.9.0.22
	OPENBSD_4_7_BASE:1.9
	OPENBSD_4_6:1.9.0.24
	OPENBSD_4_6_BASE:1.9
	OPENBSD_4_5:1.9.0.20
	OPENBSD_4_5_BASE:1.9
	OPENBSD_4_4:1.9.0.18
	OPENBSD_4_4_BASE:1.9
	OPENBSD_4_3:1.9.0.16
	OPENBSD_4_3_BASE:1.9
	OPENBSD_4_2:1.9.0.14
	OPENBSD_4_2_BASE:1.9
	OPENBSD_4_1:1.9.0.12
	OPENBSD_4_1_BASE:1.9
	OPENBSD_4_0:1.9.0.10
	OPENBSD_4_0_BASE:1.9
	OPENBSD_3_9:1.9.0.8
	OPENBSD_3_9_BASE:1.9
	OPENBSD_3_8:1.9.0.6
	OPENBSD_3_8_BASE:1.9
	OPENBSD_3_7:1.9.0.4
	OPENBSD_3_7_BASE:1.9
	OPENBSD_3_6:1.9.0.2
	OPENBSD_3_6_BASE:1.9
	SMP_SYNC_A:1.8
	SMP_SYNC_B:1.8
	OPENBSD_3_5:1.8.0.4
	OPENBSD_3_5_BASE:1.8
	OPENBSD_3_4:1.8.0.2
	OPENBSD_3_4_BASE:1.8
	UBC_SYNC_A:1.7
	OPENBSD_3_3:1.7.0.4
	OPENBSD_3_3_BASE:1.7
	OPENBSD_3_2:1.7.0.2
	OPENBSD_3_2_BASE:1.7
	OPENBSD_3_1:1.6.0.2
	OPENBSD_3_1_BASE:1.6
	UBC_SYNC_B:1.7
	UBC:1.5.0.12
	UBC_BASE:1.5
	OPENBSD_3_0:1.5.0.10
	OPENBSD_3_0_BASE:1.5
	OPENBSD_2_9:1.5.0.8
	OPENBSD_2_9_BASE:1.5
	OPENBSD_2_8:1.5.0.6
	OPENBSD_2_8_BASE:1.5
	OPENBSD_2_7:1.5.0.4
	OPENBSD_2_7_BASE:1.5
	SMP:1.5.0.2
	SMP_BASE:1.5
	kame_19991208:1.3
	OPENBSD_2_6:1.3.0.14
	OPENBSD_2_6_BASE:1.3
	OPENBSD_2_5:1.3.0.12
	OPENBSD_2_5_BASE:1.3
	OPENBSD_2_4:1.3.0.10
	OPENBSD_2_4_BASE:1.3
	OPENBSD_2_3:1.3.0.8
	OPENBSD_2_3_BASE:1.3
	OPENBSD_2_2:1.3.0.6
	OPENBSD_2_2_BASE:1.3
	OPENBSD_2_1:1.3.0.4
	OPENBSD_2_1_BASE:1.3
	OPENBSD_2_0:1.3.0.2
	OPENBSD_2_0_BASE:1.3
	theo-1:1.1.1.1;
locks; strict;
comment	@ * @;


1.12
date	2014.03.18.22.36.34;	author miod;	state dead;
branches;
next	1.11;

1.11
date	2013.12.01.21.56.42;	author miod;	state Exp;
branches;
next	1.10;

1.10
date	2012.11.04.13.33.32;	author miod;	state Exp;
branches;
next	1.9;

1.9
date	2004.07.30.22.29.45;	author miod;	state Exp;
branches;
next	1.8;

1.8
date	2003.06.02.05.09.14;	author deraadt;	state Exp;
branches;
next	1.7;

1.7
date	2002.04.27.23.21.05;	author miod;	state Exp;
branches;
next	1.6;

1.6
date	2002.03.14.01.26.37;	author millert;	state Exp;
branches;
next	1.5;

1.5
date	2000.01.29.04.11.25;	author smurph;	state Exp;
branches
	1.5.2.1
	1.5.12.1;
next	1.4;

1.4
date	2000.01.06.03.21.42;	author smurph;	state Exp;
branches;
next	1.3;

1.3
date	96.04.28.11.03.24;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	95.11.07.08.49.10;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.10.43.05;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.10.43.05;	author deraadt;	state Exp;
branches;
next	;

1.5.2.1
date	2002.03.28.10.34.05;	author niklas;	state Exp;
branches;
next	1.5.2.2;

1.5.2.2
date	2003.03.27.23.32.16;	author niklas;	state Exp;
branches;
next	1.5.2.3;

1.5.2.3
date	2003.06.07.11.13.15;	author ho;	state Exp;
branches;
next	;

1.5.12.1
date	2002.06.11.03.36.49;	author art;	state Exp;
branches;
next	;


desc
@@


1.12
log
@Retire hp300, mvme68k and mvme88k ports. These ports have no users, keeping
this hardware alive is becoming increasingly difficult, and I should heed the
message sent by the three disks which have died on me over the last few days.

Noone sane will mourn these ports anyway. So long, and thanks for the fish.
@
text
@/*	$OpenBSD: mcreg.h,v 1.11 2013/12/01 21:56:42 miod Exp $ */

/*
 * Copyright (c) 1995 Theo de Raadt
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 *
 * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
 * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
 * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
 * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
 * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
 * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

/*
 * VME162 MCchip
 */
struct mcreg {
/*0x00*/ 	volatile u_char		mc_chipid;
/*0x01*/ 	volatile u_char		mc_chiprev;
/*0x02*/   	volatile u_char		mc_genctl;
/*0x03*/   	volatile u_char		mc_vecbase;
/*0x04*/   	volatile u_long		mc_t1cmp;
/*0x08*/   	volatile u_long		mc_t1count;
/*0x0C*/   	volatile u_long		mc_t2cmp;
/*0x10*/   	volatile u_long		mc_t2count;
/*0x14*/   	volatile u_char		mc_lsbprescale;
/*0x15*/   	volatile u_char		mc_adjprescale;
/*0x16*/   	volatile u_char		mc_t2ctl;
/*0x17*/   	volatile u_char		mc_t1ctl;
/*0x18*/   	volatile u_char		mc_t4irq;
/*0x19*/   	volatile u_char		mc_t3irq;
/*0x1A*/   	volatile u_char		mc_t2irq;
/*0x1B*/   	volatile u_char		mc_t1irq;
/*0x1C*/   	volatile u_char		mc_parity;
/*0x1D*/   	volatile u_char		mc_zsirq;
/*0x1E*/   	volatile u_char		mc_t4ctl;
/*0x1F*/   	volatile u_char		mc_t3ctl;
/*0x20*/   	volatile u_short	mc_drambase;
/*0x22*/   	volatile u_short	mc_srambase;
/*0x24*/   	volatile u_char		mc_dramsize;
/*0x25*/   	volatile u_char		mc_memoptions;
   #define MC_MEMOPTIONS_SRAMMASK	0x18
   #define MC_MEMOPTIONS_SRAM128K	0x00
   #define MC_MEMOPTIONS_SRAM512K	0x08
   #define MC_MEMOPTIONS_SRAM1M	0x10
   #define MC_MEMOPTIONS_SRAM2M	0x18
   #define MC_MEMOPTIONS_DRAMMASK	0x07
   #define MC_MEMOPTIONS_DRAM1M	0x00
   #define MC_MEMOPTIONS_DRAM2M	0x01
   #define MC_MEMOPTIONS_DRAM4M	0x03
   #define MC_MEMOPTIONS_DRAM4M2	0x04
   #define MC_MEMOPTIONS_DRAM8M	0x05
   #define MC_MEMOPTIONS_DRAM16M	0x07
/*0x26*/   	volatile u_char		mc_sramsize;
/*0x27*/   	volatile u_char		mc_resv1;
/*0x28*/   	volatile u_char		mc_ieerr;
/*0x29*/   	volatile u_char		mc_resv2;
/*0x2A*/   	volatile u_char		mc_ieirq;
/*0x2B*/   	volatile u_char		mc_iefailirq;
/*0x2C*/   	volatile u_char		mc_ncrerr;
/*0x2D*/   	volatile u_char		mc_input;
	#define MC_INPUT_USR1 	0x80
	#define MC_INPUT_USR2 	0x40
	#define MC_INPUT_USR3 	0x20
	#define MC_INPUT_USR4 	0x10
	#define MC_INPUT_PROM 	0x08
	#define MC_INPUT_BUG3 	0x04
	#define MC_INPUT_BUG2 	0x02
	#define MC_INPUT_BUG1 	0x01
/*0x2E*/   	volatile u_char		mc_ver;
/*0x01*/   	volatile u_char		mc_ncrirq;
/*0x01*/   	volatile u_long		mc_t3cmp;
/*0x01*/   	volatile u_long		mc_t3count;
/*0x01*/   	volatile u_long		mc_t4cmp;
/*0x01*/   	volatile u_long		mc_t4count;
/*0x01*/   	volatile u_char		mc_busclock;
/*0x01*/   	volatile u_char		mc_promtime;
/*0x01*/   	volatile u_char		mc_flashctl;
	#define MC_FLASHCTL_WRITE	0x08
/*0x01*/   	volatile u_char		mc_abortirq;
/*0x01*/   	volatile u_char		mc_resetctl;
/*0x01*/   	volatile u_char		mc_watchdogctl;
/*0x01*/   	volatile u_char		mc_watchdogtime;
/*0x01*/   	volatile u_char		mc_resv3;
/*0x01*/   	volatile u_char		mc_dramctl;
/*0x01*/   	volatile u_char		mc_resv4;
/*0x01*/   	volatile u_char		mc_mpustat;
/*0x01*/   	volatile u_char		mc_resv5;
/*0x01*/   	volatile u_long		mc_prescale;
};
#define MC_MCCHIP_OFF		0x42000
#define MC_CHIPID		0x84

/*
 * points to system's MCchip registers
 */
extern struct mcreg *sys_mc;

/*
 * for the console we need zs phys addr
 */
#define ZS0_PHYS_162	(0xfff45000)
#define ZS1_PHYS_162	(0xfff45800)

/*
 * We lock off our interrupt vector at 0x50.
 */
#define MC_VECBASE	0x50
#define MC_NVEC		16

#define MCV_ZS		0x00
#define MCV_TIMER4	0x03
#define MCV_TIMER3	0x04
#define MCV_NCR		0x05
#define MCV_IEFAIL	0x06
#define MCV_IE		0x07
#define MCV_TIMER2	0x08
#define MCV_TIMER1	0x09
#define MCV_PARITY	0x0b
#define MCV_ABORT	0x0e

#define MC_TCTL_CEN	0x01
#define MC_TCTL_COC	0x02
#define MC_TCTL_COVF	0x04
#define MC_TCTL_OVF	0xf0
#define MC_TCTL_OVF_SHIFT	4

#define	MC_ABORT_ABS	0x40

#define mc_timer_us2lim(us)	(us)		/* timer increments in "us" */

#define MC_IRQ_IPL	0x07
#define MC_IRQ_ICLR	0x08
#define MC_IRQ_IEN	0x10
#define MC_IRQ_INT	0x20

#define MC_GENCTL_IEN	0x02

#define MC_IEERR_SCLR	0x01

#define MC_SC_INHIBIT	(0 << 6)
#define MC_SC_SNOOP	(1 << 6)
#define MC_SC_INVAL	(2 << 6)
#define MC_SC_RESV	(3 << 6)

#define MC_VER_ISLX	0x40
#define MC_VER_REAL040	0x10
#define MC_VER_NOIE	0x08
#define MC_VER_NONCR	0x04
#define MC_VER_NOVME	0x02
#define MC_VER_33MHZ	0x01

void mc_enableflashwrite(int on);
#define MC_ENAFLASHWRITE_OFFSET	0xcc000
#define MC_DISFLASHWRITE_OFFSET	0xc8000
int mc_hasflash(void);

int  mcintr_establish(int, struct intrhand *, const char *);
@


1.11
log
@switch mvme68k to the MI zs(4) driver.
@
text
@d1 1
a1 1
/*	$OpenBSD: mcreg.h,v 1.10 2012/11/04 13:33:32 miod Exp $ */
@


1.10
log
@Switch mvme68k to timecounters.
@
text
@d1 1
a1 1
/*	$OpenBSD: mcreg.h,v 1.9 2004/07/30 22:29:45 miod Exp $ */
d117 1
a117 1
#define ZS1_PHYS_162	(0xfff45801)
@


1.9
log
@Move struct evcount inside struct intrhand, and modernize intrhand
usage; similar to (and from) mvme88k.

Also remove unused haltvec structures and related code.
@
text
@d1 1
a1 1
/*	$OpenBSD: mcreg.h,v 1.8 2003/06/02 05:09:14 deraadt Exp $ */
d140 1
@


1.8
log
@license cleanup of my files
@
text
@d1 1
a1 1
/*	$OpenBSD: mcreg.h,v 1.7 2002/04/27 23:21:05 miod Exp $ */
d171 1
a171 1
int  mcintr_establish(int, struct intrhand *);
@


1.7
log
@Jumbo commit to fix all compilation warnings on mvme68k (add prototypes,
add casts, fix a few errors and typos in the process, etc)
@
text
@d1 1
a1 1
/*	$OpenBSD: mcreg.h,v 1.6 2002/03/14 01:26:37 millert Exp $ */
a14 6
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 *      This product includes software developed under OpenBSD by
 *	Theo de Raadt for Willowglen Singapore.
 * 4. The name of the author may not be used to endorse or promote products
 *    derived from this software without specific prior written permission.
@


1.6
log
@First round of __P removal in sys
@
text
@d1 1
a1 1
/*	$OpenBSD: mcreg.h,v 1.5 2000/01/29 04:11:25 smurph Exp $ */
d177 1
@


1.5
log
@Updated flash and ipic device compatability with MC rev 0x01.  zs mods to work with LX style 162 boards.
@
text
@d1 1
a1 1
/*	$OpenBSD: mcreg.h,v 1.4 2000/01/06 03:21:42 smurph Exp $ */
d172 1
a172 1
void mc_enableflashwrite __P((int on));
d175 1
a175 1
int mc_hasflash __P((void));
@


1.5.12.1
log
@Sync UBC branch to -current
@
text
@d1 1
a1 1
/*	$OpenBSD: mcreg.h,v 1.5 2000/01/29 04:11:25 smurph Exp $ */
d172 1
a172 1
void mc_enableflashwrite(int on);
d175 1
a175 1
int mc_hasflash(void);
a176 1
int  mcintr_establish(int, struct intrhand *);
@


1.5.2.1
log
@Merge in -current from about a week ago
@
text
@d1 1
a1 1
/*	$OpenBSD$ */
d172 1
a172 1
void mc_enableflashwrite(int on);
d175 1
a175 1
int mc_hasflash(void);
@


1.5.2.2
log
@Sync the SMP branch with 3.3
@
text
@a176 1
int  mcintr_establish(int, struct intrhand *);
@


1.5.2.3
log
@Sync SMP branch to -current
@
text
@d1 1
a1 1
/*	$OpenBSD: mcreg.h,v 1.5.2.2 2003/03/27 23:32:16 niklas Exp $ */
d15 6
@


1.4
log
@Added support for MVME177 (mc68060)
@
text
@d1 1
a1 1
/*	$OpenBSD: mcreg.h,v 1.3 1996/04/28 11:03:24 deraadt Exp $ */
d74 17
a90 9
/*0x01*/   	volatile u_char		mc_sramsize;
/*0x01*/   	volatile u_char		mc_resv1;
/*0x01*/   	volatile u_char		mc_ieerr;
/*0x01*/   	volatile u_char		mc_resv2;
/*0x01*/   	volatile u_char		mc_ieirq;
/*0x01*/   	volatile u_char		mc_iefailirq;
/*0x01*/   	volatile u_char		mc_ncrerr;
/*0x01*/   	volatile u_char		mc_input;
/*0x01*/   	volatile u_char		mc_ver;
d99 1
d175 2
@


1.3
log
@add OpenBSD header
@
text
@d1 1
a1 1
/*	$OpenBSD$ */
d38 63
a100 63
	volatile u_char		mc_chipid;
	volatile u_char		mc_chiprev;
	volatile u_char		mc_genctl;
	volatile u_char		mc_vecbase;
	volatile u_long		mc_t1cmp;
	volatile u_long		mc_t1count;
	volatile u_long		mc_t2cmp;
	volatile u_long		mc_t2count;
	volatile u_char		mc_lsbprescale;
	volatile u_char		mc_adjprescale;
	volatile u_char		mc_t2ctl;
	volatile u_char		mc_t1ctl;
	volatile u_char		mc_t4irq;
	volatile u_char		mc_t3irq;
	volatile u_char		mc_t2irq;
	volatile u_char		mc_t1irq;
	volatile u_char		mc_parity;
	volatile u_char		mc_zsirq;
	volatile u_char		mc_t4ctl;
	volatile u_char		mc_t3ctl;
	volatile u_short	mc_drambase;
	volatile u_short	mc_srambase;
	volatile u_char		mc_dramsize;
	volatile u_char		mc_memoptions;
#define MC_MEMOPTIONS_SRAMMASK	0x18
#define MC_MEMOPTIONS_SRAM128K	0x00
#define MC_MEMOPTIONS_SRAM512K	0x08
#define MC_MEMOPTIONS_SRAM1M	0x10
#define MC_MEMOPTIONS_SRAM2M	0x18
#define MC_MEMOPTIONS_DRAMMASK	0x07
#define MC_MEMOPTIONS_DRAM1M	0x00
#define MC_MEMOPTIONS_DRAM2M	0x01
#define MC_MEMOPTIONS_DRAM4M	0x03
#define MC_MEMOPTIONS_DRAM4M2	0x04
#define MC_MEMOPTIONS_DRAM8M	0x05
#define MC_MEMOPTIONS_DRAM16M	0x07
	volatile u_char		mc_sramsize;
	volatile u_char		mc_resv1;
	volatile u_char		mc_ieerr;
	volatile u_char		mc_resv2;
	volatile u_char		mc_ieirq;
	volatile u_char		mc_iefailirq;
	volatile u_char		mc_ncrerr;
	volatile u_char		mc_input;
	volatile u_char		mc_ver;
	volatile u_char		mc_ncrirq;
	volatile u_long		mc_t3cmp;
	volatile u_long		mc_t3count;
	volatile u_long		mc_t4cmp;
	volatile u_long		mc_t4count;
	volatile u_char		mc_busclock;
	volatile u_char		mc_promtime;
	volatile u_char		mc_flashctl;
	volatile u_char		mc_abortirq;
	volatile u_char		mc_resetctl;
	volatile u_char		mc_watchdogctl;
	volatile u_char		mc_watchdogtime;
	volatile u_char		mc_resv3;
	volatile u_char		mc_dramctl;
	volatile u_char		mc_resv4;
	volatile u_char		mc_mpustat;
	volatile u_char		mc_resv5;
	volatile u_long		mc_prescale;
@


1.2
log
@$Id$ throughout
update many copyrights
@
text
@d1 1
a1 1
/*	$Id$ */
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
/*	$NetBSD$ */
d17 2
a18 1
 *      This product includes software developed by Theo de Raadt
@


1.1.1.1
log
@mvme68k port by me. some parts by dale rahn.
@
text
@@
