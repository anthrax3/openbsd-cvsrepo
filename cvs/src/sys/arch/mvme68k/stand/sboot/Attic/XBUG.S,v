head	1.9;
access;
symbols
	OPENBSD_5_5:1.8.0.8
	OPENBSD_5_5_BASE:1.8
	OPENBSD_5_4:1.8.0.4
	OPENBSD_5_4_BASE:1.8
	OPENBSD_5_3:1.8.0.2
	OPENBSD_5_3_BASE:1.8
	OPENBSD_5_2:1.7.0.38
	OPENBSD_5_2_BASE:1.7
	OPENBSD_5_1_BASE:1.7
	OPENBSD_5_1:1.7.0.36
	OPENBSD_5_0:1.7.0.34
	OPENBSD_5_0_BASE:1.7
	OPENBSD_4_9:1.7.0.32
	OPENBSD_4_9_BASE:1.7
	OPENBSD_4_8:1.7.0.30
	OPENBSD_4_8_BASE:1.7
	OPENBSD_4_7:1.7.0.26
	OPENBSD_4_7_BASE:1.7
	OPENBSD_4_6:1.7.0.28
	OPENBSD_4_6_BASE:1.7
	OPENBSD_4_5:1.7.0.24
	OPENBSD_4_5_BASE:1.7
	OPENBSD_4_4:1.7.0.22
	OPENBSD_4_4_BASE:1.7
	OPENBSD_4_3:1.7.0.20
	OPENBSD_4_3_BASE:1.7
	OPENBSD_4_2:1.7.0.18
	OPENBSD_4_2_BASE:1.7
	OPENBSD_4_1:1.7.0.16
	OPENBSD_4_1_BASE:1.7
	OPENBSD_4_0:1.7.0.14
	OPENBSD_4_0_BASE:1.7
	OPENBSD_3_9:1.7.0.12
	OPENBSD_3_9_BASE:1.7
	OPENBSD_3_8:1.7.0.10
	OPENBSD_3_8_BASE:1.7
	OPENBSD_3_7:1.7.0.8
	OPENBSD_3_7_BASE:1.7
	OPENBSD_3_6:1.7.0.6
	OPENBSD_3_6_BASE:1.7
	SMP_SYNC_A:1.7
	SMP_SYNC_B:1.7
	OPENBSD_3_5:1.7.0.4
	OPENBSD_3_5_BASE:1.7
	OPENBSD_3_4:1.7.0.2
	OPENBSD_3_4_BASE:1.7
	UBC_SYNC_A:1.6
	OPENBSD_3_3:1.6.0.4
	OPENBSD_3_3_BASE:1.6
	OPENBSD_3_2:1.6.0.2
	OPENBSD_3_2_BASE:1.6
	OPENBSD_3_1:1.5.0.6
	OPENBSD_3_1_BASE:1.5
	UBC_SYNC_B:1.6
	UBC:1.5.0.4
	UBC_BASE:1.5
	OPENBSD_3_0:1.5.0.2
	OPENBSD_3_0_BASE:1.5
	OPENBSD_2_9:1.4.0.16
	OPENBSD_2_9_BASE:1.4
	OPENBSD_2_8:1.4.0.14
	OPENBSD_2_8_BASE:1.4
	OPENBSD_2_7:1.4.0.12
	OPENBSD_2_7_BASE:1.4
	SMP:1.4.0.10
	SMP_BASE:1.4
	kame_19991208:1.4
	OPENBSD_2_6:1.4.0.8
	OPENBSD_2_6_BASE:1.4
	OPENBSD_2_5:1.4.0.6
	OPENBSD_2_5_BASE:1.4
	OPENBSD_2_4:1.4.0.4
	OPENBSD_2_4_BASE:1.4
	OPENBSD_2_3:1.4.0.2
	OPENBSD_2_3_BASE:1.4
	OPENBSD_2_2:1.3.0.6
	OPENBSD_2_2_BASE:1.3
	OPENBSD_2_1:1.3.0.4
	OPENBSD_2_1_BASE:1.3
	OPENBSD_2_0:1.3.0.2
	OPENBSD_2_0_BASE:1.3
	theo-1:1.1.1.1;
locks; strict;
comment	@# @;


1.9
date	2014.03.18.22.36.35;	author miod;	state dead;
branches;
next	1.8;

1.8
date	2013.02.02.13.36.06;	author miod;	state Exp;
branches;
next	1.7;

1.7
date	2003.06.04.16.36.14;	author deraadt;	state Exp;
branches;
next	1.6;

1.6
date	2002.07.10.20.30.14;	author jsyn;	state Exp;
branches;
next	1.5;

1.5
date	2001.04.30.00.13.35;	author deraadt;	state Exp;
branches
	1.5.4.1;
next	1.4;

1.4
date	98.04.02.10.49.05;	author deraadt;	state Exp;
branches
	1.4.10.1;
next	1.3;

1.3
date	96.04.28.10.49.32;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	95.11.07.08.51.07;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.10.44.11;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.10.44.11;	author deraadt;	state Exp;
branches;
next	;

1.4.10.1
date	2001.07.04.10.19.46;	author niklas;	state Exp;
branches;
next	1.4.10.2;

1.4.10.2
date	2003.03.27.23.32.17;	author niklas;	state Exp;
branches;
next	1.4.10.3;

1.4.10.3
date	2003.06.07.11.13.16;	author ho;	state Exp;
branches;
next	;

1.5.4.1
date	2002.10.29.00.28.07;	author art;	state Exp;
branches;
next	;


desc
@@


1.9
log
@Retire hp300, mvme68k and mvme88k ports. These ports have no users, keeping
this hardware alive is becoming increasingly difficult, and I should heed the
message sent by the three disks which have died on me over the last few days.

Noone sane will mourn these ports anyway. So long, and thanks for the fish.
@
text
@/*	$OpenBSD: XBUG.S,v 1.8 2013/02/02 13:36:06 miod Exp $ */

/*
 * Copyright (c) 1989,1990,1995 Theo de Raadt
 * 
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 *
 * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS
 * OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY
 * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 */

/*
 * Theo says: I wrote a bootrom for the MVME147 *years* ago. To write
 * this ROM I copied a few chunks from the old bootrom, like this piece:
 * 
 * "watch this, the moto bastard struck here, shouldn't have hired people
 * from intel I tried to tell them...
 *       "BOOT"
 *       offset from baseaddr to entry point.
 *       offset from baseaddr to first word after checksum
 *       garbage
 *       checksum made with CS command
 * No need to change any of this unless you try to take our names out
 * of there. Ie. don't touch."
 */

		.text
bootlabel:	.ascii	"BOOT"
		.long	bootstart-0xffa00000	| for rom install
		.long	bootlabelend - bootlabel
		.asciz	"VME147 rboot Copyright (c) 1995 Theo de Raadt"
		.align	2
bootstart:	jmp	bssclr
		.word	0x229c			| XXX bitching cksum!
bootlabelend:
		.word	0

		| clear bss and the kernel location
bssclr:		movl	#edata,%a0
		movl	#end,%d0
		subl	#edata,%d0
1:		clrb	%a0@@+
		subql	#1,%d0
		bpl	1b

		| rip the data segment from ROM into ram..
		movl	#etext,%a2		| start of data
		movl	#0x4000,%a1		| shovel address
		movl	#edata,%d0
		subl	#etext,%d0
1:		movb	%a2@@+,%a1@@+
		subql	#1,%d0
		bpl	1b

		bra	__start
@


1.8
log
@mvme68k ELF bits. Boot block updates heavily based upon the recent mvme88k
a.out->ELF transition.
@
text
@d1 1
a1 1
/*	$OpenBSD: XBUG.S,v 1.7 2003/06/04 16:36:14 deraadt Exp $ */
@


1.7
log
@more term 3 & 4 from various developers, with permission of course
@
text
@d1 1
a1 1
/*	$OpenBSD: XBUG.S,v 1.6 2002/07/10 20:30:14 jsyn Exp $ */
d55 5
a59 5
bssclr:		movl	#_edata,a0
		movl	#_end,d0
		subl	#_edata,d0
1:		clrb	a0@@+
		subql	#1,d0
d63 6
a68 6
		movl	#_etext,a2		| start of data
		movl	#0x4000,a1		| shovel address
		movl	#_edata,d0
		subl	#_etext,d0
1:		movb	a2@@+,a1@@+
		subql	#1,d0
d71 1
a71 1
		bra	start
@


1.6
log
@'sez' is not an english word; ok deraadt@@
@
text
@d1 1
a1 1
/*	$OpenBSD: XBUG.S,v 1.5 2001/04/30 00:13:35 deraadt Exp $ */
a13 6
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 *	This product includes software developed under OpenBSD by
 *	Theo de Raadt for Willowglen Singapore.
 * 4. The name of the author may not be used to endorse or promote products
 *    derived from this software without specific prior written permission.
@


1.5
log
@correct copyright.  i wrote some of this in 1989, wow.. i am old...
@
text
@d1 1
a1 1
/*	$OpenBSD: XBUG.S,v 1.4 1998/04/02 10:49:05 deraadt Exp $ */
d35 1
a35 1
 * Theo sez: I wrote a bootrom for the MVME147 *years* ago. To write
@


1.5.4.1
log
@sync to -current
@
text
@d1 1
a1 1
/*	$OpenBSD: XBUG.S,v 1.5 2001/04/30 00:13:35 deraadt Exp $ */
d35 1
a35 1
 * Theo says: I wrote a bootrom for the MVME147 *years* ago. To write
@


1.4
log
@use movl/subl instead of #sym-sym; pleases new gas
@
text
@d1 1
a1 1
/*	$OpenBSD$ */
d4 1
a4 1
 * Copyright (c) 1995 Theo de Raadt
@


1.4.10.1
log
@Merge in -current from two days ago in the SMP branch.
As usual with merges, they do not indicate progress, so do not hold
your breath for working SMP, and do not mail me and ask about the
state of it.  It has not changed.  There is work ongoing, but very, very
slowly.  The commit is done in parts as to not lock up the tree in too
big chunks at a time.
@
text
@d1 1
a1 1
/*	$OpenBSD: XBUG.S,v 1.4 1998/04/02 10:49:05 deraadt Exp $ */
d4 1
a4 1
 * Copyright (c) 1989,1990,1995 Theo de Raadt
@


1.4.10.2
log
@Sync the SMP branch with 3.3
@
text
@d1 1
a1 1
/*	$OpenBSD$ */
d35 1
a35 1
 * Theo says: I wrote a bootrom for the MVME147 *years* ago. To write
@


1.4.10.3
log
@Sync SMP branch to -current
@
text
@d1 1
a1 1
/*	$OpenBSD: XBUG.S,v 1.4.10.2 2003/03/27 23:32:17 niklas Exp $ */
d14 6
@


1.3
log
@add OpenBSD header
@
text
@d62 2
a63 1
		movl	#_end - _edata,d0
d71 2
a72 1
		movl	#_edata - _etext,d0
@


1.2
log
@$Id$ throughout
update many copyrights
@
text
@d1 2
@


1.1
log
@Initial revision
@
text
@d3 1
a3 2
 * All rights reserved.
 *
d14 2
a15 1
 *      This product includes software developed Theo de Raadt
d19 11
a29 10
 * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
 * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
 * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
 * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
 * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
 * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
@


1.1.1.1
log
@mvme68k port by me. some parts by dale rahn.
@
text
@@
