head	1.24;
access;
symbols
	OPENBSD_5_5:1.23.0.8
	OPENBSD_5_5_BASE:1.23
	OPENBSD_5_4:1.23.0.4
	OPENBSD_5_4_BASE:1.23
	OPENBSD_5_3:1.23.0.2
	OPENBSD_5_3_BASE:1.23
	OPENBSD_5_2:1.21.0.20
	OPENBSD_5_2_BASE:1.21
	OPENBSD_5_1_BASE:1.21
	OPENBSD_5_1:1.21.0.18
	OPENBSD_5_0:1.21.0.16
	OPENBSD_5_0_BASE:1.21
	OPENBSD_4_9:1.21.0.14
	OPENBSD_4_9_BASE:1.21
	OPENBSD_4_8:1.21.0.12
	OPENBSD_4_8_BASE:1.21
	OPENBSD_4_7:1.21.0.8
	OPENBSD_4_7_BASE:1.21
	OPENBSD_4_6:1.21.0.10
	OPENBSD_4_6_BASE:1.21
	OPENBSD_4_5:1.21.0.6
	OPENBSD_4_5_BASE:1.21
	OPENBSD_4_4:1.21.0.4
	OPENBSD_4_4_BASE:1.21
	OPENBSD_4_3:1.21.0.2
	OPENBSD_4_3_BASE:1.21
	OPENBSD_4_2:1.17.0.12
	OPENBSD_4_2_BASE:1.17
	OPENBSD_4_1:1.17.0.10
	OPENBSD_4_1_BASE:1.17
	OPENBSD_4_0:1.17.0.8
	OPENBSD_4_0_BASE:1.17
	OPENBSD_3_9:1.17.0.6
	OPENBSD_3_9_BASE:1.17
	OPENBSD_3_8:1.17.0.4
	OPENBSD_3_8_BASE:1.17
	OPENBSD_3_7:1.17.0.2
	OPENBSD_3_7_BASE:1.17
	OPENBSD_3_6:1.16.0.6
	OPENBSD_3_6_BASE:1.16
	SMP_SYNC_A:1.16
	SMP_SYNC_B:1.16
	OPENBSD_3_5:1.16.0.4
	OPENBSD_3_5_BASE:1.16
	OPENBSD_3_4:1.16.0.2
	OPENBSD_3_4_BASE:1.16
	UBC_SYNC_A:1.15
	OPENBSD_3_3:1.15.0.18
	OPENBSD_3_3_BASE:1.15
	OPENBSD_3_2:1.15.0.16
	OPENBSD_3_2_BASE:1.15
	OPENBSD_3_1:1.15.0.14
	OPENBSD_3_1_BASE:1.15
	UBC_SYNC_B:1.15
	UBC:1.15.0.12
	UBC_BASE:1.15
	OPENBSD_3_0:1.15.0.10
	OPENBSD_3_0_BASE:1.15
	OPENBSD_2_9:1.15.0.8
	OPENBSD_2_9_BASE:1.15
	OPENBSD_2_8:1.15.0.6
	OPENBSD_2_8_BASE:1.15
	OPENBSD_2_7:1.15.0.4
	OPENBSD_2_7_BASE:1.15
	SMP:1.15.0.2
	SMP_BASE:1.15
	kame_19991208:1.13
	OPENBSD_2_6:1.13.0.12
	OPENBSD_2_6_BASE:1.13
	OPENBSD_2_5:1.13.0.10
	OPENBSD_2_5_BASE:1.13
	OPENBSD_2_4:1.13.0.8
	OPENBSD_2_4_BASE:1.13
	OPENBSD_2_3:1.13.0.6
	OPENBSD_2_3_BASE:1.13
	OPENBSD_2_2:1.13.0.4
	OPENBSD_2_2_BASE:1.13
	OPENBSD_2_1:1.13.0.2
	OPENBSD_2_1_BASE:1.13
	OPENBSD_2_0:1.10.0.2
	OPENBSD_2_0_BASE:1.10
	theo-1:1.1.1.2
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@# @;


1.24
date	2014.03.18.22.36.35;	author miod;	state dead;
branches;
next	1.23;

1.23
date	2012.12.31.21.35.32;	author miod;	state Exp;
branches;
next	1.22;

1.22
date	2012.08.21.14.46.19;	author pascal;	state Exp;
branches;
next	1.21;

1.21
date	2008.03.11.20.07.53;	author deraadt;	state Exp;
branches;
next	1.20;

1.20
date	2007.12.28.18.56.09;	author miod;	state Exp;
branches;
next	1.19;

1.19
date	2007.11.26.10.26.02;	author deraadt;	state Exp;
branches;
next	1.18;

1.18
date	2007.11.26.10.01.42;	author deraadt;	state Exp;
branches;
next	1.17;

1.17
date	2005.02.20.15.34.06;	author miod;	state Exp;
branches;
next	1.16;

1.16
date	2003.06.02.09.10.34;	author miod;	state Exp;
branches;
next	1.15;

1.15
date	2000.01.24.05.20.55;	author smurph;	state Exp;
branches
	1.15.2.1;
next	1.14;

1.14
date	2000.01.06.03.21.43;	author smurph;	state Exp;
branches;
next	1.13;

1.13
date	97.04.22.16.07.57;	author gvf;	state Exp;
branches;
next	1.12;

1.12
date	97.02.20.21.05.38;	author gvf;	state Exp;
branches;
next	1.11;

1.11
date	96.10.16.13.49.49;	author mickey;	state Exp;
branches;
next	1.10;

1.10
date	96.05.16.02.30.38;	author chuck;	state Exp;
branches;
next	1.9;

1.9
date	96.05.10.20.03.49;	author deraadt;	state Exp;
branches;
next	1.8;

1.8
date	96.04.28.10.48.52;	author deraadt;	state Exp;
branches;
next	1.7;

1.7
date	95.12.26.17.46.28;	author deraadt;	state Exp;
branches;
next	1.6;

1.6
date	95.12.07.03.28.33;	author deraadt;	state Exp;
branches;
next	1.5;

1.5
date	95.12.06.10.53.00;	author deraadt;	state Exp;
branches;
next	1.4;

1.4
date	95.11.22.11.17.17;	author deraadt;	state Exp;
branches;
next	1.3;

1.3
date	95.11.07.08.50.40;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	95.11.06.23.44.14;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.51.14;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.51.14;	author deraadt;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	95.10.18.10.44.13;	author deraadt;	state Exp;
branches;
next	;

1.15.2.1
date	2003.06.07.11.13.16;	author ho;	state Exp;
branches;
next	;


desc
@@


1.24
log
@Retire hp300, mvme68k and mvme88k ports. These ports have no users, keeping
this hardware alive is becoming increasingly difficult, and I should heed the
message sent by the three disks which have died on me over the last few days.

Noone sane will mourn these ports anyway. So long, and thanks for the fish.
@
text
@#	$OpenBSD: Makefile,v 1.23 2012/12/31 21:35:32 miod Exp $

LIB=sa

CLEANFILES+=SRT0.o

NOPIC=nopic
NOPROFILE=noprofile
NOPIE=

# Logically src/sys
S=${.CURDIR}/../../../..

SRCS+=	bugdev.c clock.c parse_args.c exec_mvme.c

.PATH:  ${S}/lib/libsa
SRCS+=	alloc.c memcpy.c exit.c getfile.c gets.c globals.c \
	printf.c strerror.c memset.c memcmp.c strncpy.c strcmp.c strlen.c \
	strlcpy.c strlcat.c snprintf.c \
	close.c closeall.c dev.c dkcksum.c \
	lseek.c open.c nullfs.c read.c fstat.c \
	ufs.c cread.c
SRCS+=	arp.c ether.c in_cksum.c net.c netif.c rpc.c nfs.c \
	rarp.c bootparam.c
SRCS+=	loadfile.c

.PATH:	${S}/lib/libkern
SRCS+=	ashrdi3.c muldi3.c

# DBG= -DDEBUG -DNETIF_DEBUG -DNFS_DEBUG -DRPC_DEBUG \
# 	-DNET_DEBUG -DRARP_DEBUG -DETHER_DEBUG

#DEFS= -DCOMPAT_UFS
DEFS= -D__INTERNAL_LIBSA_CREAD -D_STANDALONE
#DEFS+=-DNETIF_DEBUG
INCL= -I${.CURDIR} -I${.CURDIR}/../libbug -I${S}/lib/libsa -I${S}
CFLAGS+= ${XCFLAGS} -O2 ${COPTS} ${DEFS} ${DBG} ${INCL}

all: libsa.a SRT0.o

install:

.include <bsd.lib.mk>
@


1.23
log
@Switch mvme68k boot blocks to use the MI libsa loadfile routines to load
kernel images, instead of their own; gives us the ability to load ELF kernels
for free.

Fix many warnings, and generally make the code closer to the current mvme88k
boot blocks to help diffability.

Rewrite bugcrt and bugexec() as a short assembly shim around a
compiler-independent C block; this will allow compilers other than gcc2 to be
used, and removes the need for bugcrt to be compiled without optimization.

Crank all bootblocks versions.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.22 2012/08/21 14:46:19 pascal Exp $
@


1.22
log
@Add NOPIE= bits for sys/arch/*/stand to ensure that bootblocks will always be
built with -fno-pie.  This gets the hairiest part of PIE out of the way ...

ok deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.21 2008/03/11 20:07:53 deraadt Exp $
d16 10
a25 6
.PATH:  $S/lib/libsa
SRCS+=	alloc.c memcpy.c exit.c getfile.c gets.c globals.c printf.c \
	strerror.c memset.c memcmp.c strncpy.c strcmp.c strlen.c \
	snprintf.c close.c closeall.c dev.c dkcksum.c lseek.c open.c \
	nullfs.c read.c fstat.c ufs.c cread.c
SRCS+=	arp.c ether.c in_cksum.c net.c netif.c rpc.c nfs.c rarp.c bootparam.c
d34 2
a35 1
DEFS= -D__INTERNAL_LIBSA_CREAD
@


1.21
log
@use muldi3.c to avoid putting instructions 68060 does not support into the
boot media; from miod, tested by martin, this is just making release.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.20 2007/12/28 18:56:09 miod Exp $
d9 1
@


1.20
log
@Repair fallout from libkern changes.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.19 2007/11/26 10:26:02 deraadt Exp $
d23 1
a23 1
SRCS+=	ashrdi3.c
@


1.19
log
@few more dribbles of LIBKERN cleanup
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.18 2007/11/26 10:01:42 deraadt Exp $
d16 1
a16 1
SRCs+=	alloc.c memcpy.c exit.c getfile.c gets.c globals.c printf.c \
d22 1
a22 1
.PATH:	${S}/lib/libkern/arch/m68k ${S}/lib/libkern
@


1.18
log
@More LIBKERN bits that go away
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.17 2005/02/20 15:34:06 miod Exp $
d5 1
a5 1
CLEANFILES+=SRT0.o 
d13 1
a13 2
SRC_net= arp.c ether.c in_cksum.c net.c netif.c rpc.c nfs.c \
	 rarp.c bootparam.c 
d16 5
a20 6
SRC_sa=	alloc.c memcpy.c exit.c getfile.c gets.c globals.c \
	printf.c strerror.c memset.c memcmp.c strncpy.c strcmp.c strlen.c \
	snprintf.c \
	close.c closeall.c dev.c dkcksum.c \
	lseek.c open.c nullfs.c read.c fstat.c \
	ufs.c cread.c
d23 1
a23 7
SRC_kern= ashrdi3.c

SRC_mvme= exec_mvme.c

SRC_here= bugdev.c clock.c parse_args.c

SRCS= ${SRC_net} ${SRC_sa} ${SRC_mvme} ${SRC_here} ${SRC_kern}
d33 1
a33 1
all: libsa.a SRT0.o 
@


1.17
log
@Do not pass 68060-specific compiler flags anymore.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.16 2003/06/02 09:10:34 miod Exp $
a11 2
DIR_SA=$S/lib/libsa
DIR_KERN=$S/lib/libkern
d16 1
d24 1
a39 2

.PATH:  ${DIR_SA} ${DIR_KERN} 
@


1.16
log
@Need snprintf here.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.15 2000/01/24 05:20:55 smurph Exp $
a38 1
COPTS= -m68060 -Wa,-m68030
@


1.15
log
@Fixed bug in disksubr.c relating to disklabels.  Added MVME376 support to le.  Made installboot insert M68K for volume ID, not M88K.  Correctly documented installboot.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.14 2000/01/06 03:21:43 smurph Exp $
d20 1
@


1.15.2.1
log
@Sync SMP branch to -current
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.15 2000/01/24 05:20:55 smurph Exp $
a19 1
	snprintf.c \
@


1.14
log
@Added support for MVME177 (mc68060)
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.13 1997/04/22 16:07:57 gvf Exp $
d38 1
a38 1
COPTS= #-fno-defer-pop -m68060
@


1.13
log
@Reorg to look more like sys/lib/libsa/Makefile
Reduce dependency on libkern.
Add libz.
Support passing thru CFLAGS from other Makefiles.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.12 1997/02/20 21:05:38 gvf Exp $
d38 1
a38 1
COPTS= #-fno-defer-pop
@


1.12
log
@strncpy needed for ufs.c
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.11 1996/10/16 13:49:49 mickey Exp $
d15 2
a16 2
SRC_net= nfs.c rpc.c net.c ether.c arp.c in_cksum.c netif.c \
	 bootparam.c rarp.c
d18 5
d24 1
a24 5
SRC_sa = alloc.c memset.c memcpy.c close.c exit.c getfile.c gets.c open.c \
	 printf.c read.c strerror.c ufs.c globals.c lseek.c \
	 closeall.c dev.c dkcksum.c nullfs.c fstat.c memcmp.c

SRC_kern= ashrdi3.c bcmp.c bzero.c strcmp.c strncpy.c strlen.c
d28 1
a28 1
SRC_here= clock.c bugdev.c parse_args.c
d30 1
a30 1
SRCS= ${SRC_net} ${SRC_sa} ${SRC_kern} ${SRC_mvme} ${SRC_here}
d36 2
a37 1
INCL= -I. -I${.CURDIR}/../libbug -I${S}/lib/libsa -I${S}
d39 1
a39 1
CFLAGS= -O2 ${COPTS} ${DEFS} ${DBG} ${INCL}
@


1.11
log
@iupdate according to the libsa changes
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.10 1996/05/16 02:30:38 chuck Exp $
d23 1
a23 1
SRC_kern= ashrdi3.c bcmp.c bzero.c strcmp.c strlen.c
@


1.10
log
@sync with sun3 port.
major reorg. & cleanup.
new SRT that works with bugcrt.
common parse_arg.
@
text
@d1 1
a1 1
#	$OpenBSD$
d19 1
a19 1
SRC_sa = alloc.c bcopy.c memcpy.c close.c exit.c getfile.c gets.c open.c \
d21 1
a21 1
	 closeall.c dev.c dkcksum.c nullfs.c fstat.c
@


1.9
log
@machine@@
@
text
@d5 1
a5 1
CLEANFILES+=SRT0.o SRT1.o machine
d19 1
a19 1
SRC_sa = alloc.c bcopy.c memcpy.c close.c getfile.c open.c \
d25 1
a25 1
SRC_sun3= exec_sun.c
d27 1
a27 3
SRC_here= clock.c devopen.c dvma.c \
	 gets.c panic.c \
	 promboot.c promcons.c
d29 1
a29 1
SRCS= ${SRC_net} ${SRC_sa} ${SRC_kern} ${SRC_sun3} ${SRC_here}
d35 1
a35 1
INCL= -I${.CURDIR} -I${S} -I${S}/lib/libsa -I${.OBJDIR}
d39 1
a39 1
.PATH:  ${DIR_SA} ${DIR_KERN} ../../sun3
d41 1
a41 1
all: machine libsa.a SRT0.o SRT1.o
a43 3

machine:
	rm -f machine; ln -s ${.CURDIR}/../../include machine
@


1.8
log
@add OpenBSD header
@
text
@d5 1
a5 1
CLEANFILES+=SRT0.o SRT1.o
d37 1
a37 1
INCL= -I. -I${S}/lib/libsa -I${S}
d43 1
a43 1
all: libsa.a SRT0.o SRT1.o
d46 3
@


1.7
log
@put memcpy into libsa
@
text
@d1 1
a1 1
#	$Id: Makefile,v 1.6 1995/12/07 03:28:33 deraadt Exp $
@


1.6
log
@update to use new files in libsa
@
text
@d1 1
a1 1
#	$Id: Makefile,v 1.5 1995/12/06 10:53:00 deraadt Exp $
d19 1
a19 1
SRC_sa = alloc.c bcopy.c close.c getfile.c open.c \
@


1.5
log
@optimize further
@
text
@d1 1
a1 1
#	$Id: Makefile,v 1.4 1995/11/22 11:17:17 deraadt Exp $
d20 2
a21 1
	 printf.c read.c strerror.c ufs.c globals.c lseek.c
@


1.4
log
@do not need to load off 4.3 filesystems
@
text
@d1 1
a1 1
#	$Id: Makefile,v 1.3 1995/11/07 08:50:40 deraadt Exp $
d28 1
a28 1
	 promboot.c promcons.c bug.c
d38 1
a38 1
CFLAGS= -O ${COPTS} ${DEFS} ${DBG} ${INCL}
@


1.3
log
@$Id$ throughout
update many copyrights
@
text
@d1 1
a1 1
#	$Id$
d35 1
a35 1
DEFS= -DCOMPAT_UFS
@


1.2
log
@clean two more .o files
@
text
@d1 1
a1 1
#	$NetBSD: Makefile,v 1.6 1995/06/27 15:57:13 gwr Exp $
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
#	$NetBSD: Makefile,v 1.1.1.1 1995/07/25 23:12:21 chuck Exp $
d5 2
d15 1
a15 1
SRC_net= nfs.c rpc.c net.c ether.c arp.c in_cksum.c \
d18 1
d20 1
a20 1
	 printf.c read.c strerror.c ufs.c 
d24 5
a28 3
SRC_here= clock.c devopen.c \
	 exec.c gets.c netif.c panic.c \
	 machdep.c
d30 1
a30 1
SRCS= ${SRC_net} ${SRC_sa} ${SRC_kern} ${SRC_here}
d37 1
a37 1
COPTS= -msoft-float -fno-defer-pop -fno-omit-frame-pointer
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@


1.1.1.2
log
@mvme68k port by me. some parts by dale rahn.
@
text
@d1 1
a1 1
#	$NetBSD: Makefile,v 1.6 1995/06/27 15:57:13 gwr Exp $
d13 1
a13 1
SRC_net= nfs.c rpc.c net.c ether.c arp.c in_cksum.c netif.c \
a15 1

d17 1
a17 1
	 printf.c read.c strerror.c ufs.c globals.c lseek.c
d21 3
a23 5
SRC_sun3= exec_sun.c

SRC_here= clock.c devopen.c dvma.c \
	 gets.c panic.c \
	 promboot.c promcons.c bug.c
d25 1
a25 1
SRCS= ${SRC_net} ${SRC_sa} ${SRC_kern} ${SRC_sun3} ${SRC_here}
d32 1
a32 1
COPTS= #-fno-defer-pop
@
