head	1.7;
access;
symbols
	OPENBSD_6_0:1.7.0.4
	OPENBSD_6_0_BASE:1.7
	OPENBSD_5_9:1.7.0.2
	OPENBSD_5_9_BASE:1.7
	OPENBSD_5_8:1.6.0.4
	OPENBSD_5_8_BASE:1.6
	OPENBSD_5_7:1.5.0.2
	OPENBSD_5_7_BASE:1.5
	OPENBSD_5_6:1.4.0.10
	OPENBSD_5_6_BASE:1.4
	OPENBSD_5_5:1.4.0.8
	OPENBSD_5_5_BASE:1.4
	OPENBSD_5_4:1.4.0.4
	OPENBSD_5_4_BASE:1.4
	OPENBSD_5_3:1.4.0.2
	OPENBSD_5_3_BASE:1.4
	OPENBSD_5_2:1.2.0.18
	OPENBSD_5_2_BASE:1.2
	OPENBSD_5_1_BASE:1.2
	OPENBSD_5_1:1.2.0.16
	OPENBSD_5_0:1.2.0.14
	OPENBSD_5_0_BASE:1.2
	OPENBSD_4_9:1.2.0.12
	OPENBSD_4_9_BASE:1.2
	OPENBSD_4_8:1.2.0.10
	OPENBSD_4_8_BASE:1.2
	OPENBSD_4_7:1.2.0.6
	OPENBSD_4_7_BASE:1.2
	OPENBSD_4_6:1.2.0.8
	OPENBSD_4_6_BASE:1.2
	OPENBSD_4_5:1.2.0.4
	OPENBSD_4_5_BASE:1.2
	OPENBSD_4_4:1.2.0.2
	OPENBSD_4_4_BASE:1.2;
locks; strict;
comment	@.\" @;


1.7
date	2015.09.10.15.16.43;	author schwarze;	state Exp;
branches;
next	1.6;
commitid	yPhLfPulVSum2r0H;

1.6
date	2015.06.22.18.31.49;	author jmc;	state Exp;
branches;
next	1.5;
commitid	lYMtLLSloWsX2kyP;

1.5
date	2015.01.24.20.47.19;	author naddy;	state Exp;
branches;
next	1.4;
commitid	KSjr9JLiwftpQ0il;

1.4
date	2012.09.27.12.26.28;	author jmc;	state Exp;
branches;
next	1.3;

1.3
date	2012.08.15.19.02.01;	author jmc;	state Exp;
branches;
next	1.2;

1.2
date	2008.05.28.21.26.09;	author miod;	state Exp;
branches;
next	1.1;

1.1
date	2008.05.28.21.16.43;	author miod;	state Exp;
branches;
next	;


desc
@@


1.7
log
@reduce .Nd to one line and kill .Tn while here
@
text
@.\"	$OpenBSD: boot.8,v 1.6 2015/06/22 18:31:49 jmc Exp $
.\"
.\" Copyright (c) 1997-2001 Michael Shalayeff
.\" All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
.\" IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
.\" OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
.\" IN NO EVENT SHALL THE AUTHOR OR HIS RELATIVES BE LIABLE FOR ANY DIRECT,
.\" INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
.\" (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
.\" SERVICES; LOSS OF MIND, USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
.\" STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING
.\" IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF
.\" THE POSSIBILITY OF SUCH DAMAGE.
.\"
.\"
.Dd $Mdocdate: June 22 2015 $
.Dt BOOT 8 landisk
.Os
.Sh NAME
.Nm boot ,
.Nm boot.conf
.Nd landisk-specific second-stage bootstrap
.Sh DESCRIPTION
The main purpose of this program is to load the system kernel from the
root file system of the machine.
.Pp
As described in
.Xr boot_landisk 8 ,
this program is loaded by the
.Xr xxboot 8
primary bootstrap loader and provides a convenient way to load the kernel.
This program acts as an enhanced boot monitor for landisk systems, providing
a common interface for the kernel to start from.
.Pp
Basic operations include:
.Pp
.Bl -bullet -compact
.It
Loading kernels from any device supported by your system firmware.
.It
Loading kernels compressed by
.Xr gzip 1 .
.It
Providing an interactive command line.
.El
.Pp
The sequence of its operation is as follows: initialization,
parsing the configuration file, then an interactive command line.
While at the command line you have 5 seconds to type any commands, if needed.
If time expires, the kernel will be loaded according to
the current variable settings (see the
.Nm set
command).
Each time a kernel load fails, the timeout is increased by one second.
The sequence of
.Nm
operations is as follows:
.Bl -enum
.It
If the file
.Pa /etc/boot.conf
exists on the filesystem
.Nm
was loaded from, open and parse it.
Lines beginning with the
.Sq #
character,
as well as whitespace at the beginning of lines,
are ignored.
The file may contain any commands
.Nm
accepts at the interactive prompt.
Though default settings usually suffice, they can be changed here.
.\" XXX CHECK_SKIP_CONF is not defined...
.\" .Pa boot.conf
.\" processing can be skipped by holding down either Control key as
.\" .Nm
.\" starts.
.It
The header line
.Pp
.Dl >> OpenBSD/landisk BOOT [x.xx]
.Pp
is displayed to the active console, where
.Ar x.xx
is the version number of the
.Nm
program, followed by the
.Pp
.Dl boot>
.Pp
prompt, which means you are in interactive mode and may enter commands.
If you do not,
.Nm
will proceed to load the kernel with the current parameters after the
timeout period has expired.
.El
.Pp
By default,
.Nm
attempts to load the kernel executable
.Pa /bsd .
If it fails to find the kernel and no alternative kernel image has
been specified, the system will be unable to boot.
.Sh COMMANDS
The following commands are accepted at the
.Nm
prompt:
.Bl -tag -width shorten
.It boot Oo Oo Ar device : Oc Ns Ar image Oc Op Fl acds
Boots the specified kernel image
with any options given.
If
.Ar device
or
.Ar image
are omitted, values from
.Nm
variables will be used.
.Pp
The only bootable device, at the moment, is the internal IDE device (either a
compactflash media or an ATA disk drive), and is named
.Sq cf .
Therefore, to boot kernel
.Pa /bsd
from
.\" XXX no support for partition different from `a' yet...
.\" slice
.\" .Sq a
.\" on
the internal drive, specify
.Dq boot cf:/bsd .
.Bl -tag -width _a_
.It Fl a
Causes the kernel to ask for the
.Nm root
device to use.
.It Fl c
Causes the kernel to go into
.Xr boot_config 8
before performing
.Xr autoconf 4
procedures.
.It Fl d
Causes the kernel to drop into
.Xr ddb 4
at the earliest convenient point.
.It Fl s
Causes the kernel to boot single-user.
.El
.It echo Op Ar args
Displays
.Ar args
on the console device.
.It help
Prints a list of available commands.
.It ls Op Ar directory
Prints contents of the specified
.Ar directory
in long format including: attributes and file type, owner, group,
size, filename.
.It reboot
Reboots the machine by initiating a warm boot procedure.
.It set Op Ar varname Op Ar value
If invoked without arguments, prints a list of variables and their values.
If only
.Ar varname
is specified, displays contents of that variable.
If
.Ar varname
and
.Ar value
are both specified, sets that variable to the given value.
Variables include:
.Pp
.Bl -tag -compact -width boothow
.It Nm addr
Address at which to load the kernel.
.It Nm debug
Debug flag if
.Nm
was compiled with DEBUG defined.
.\" XXX Useless until partitions are supported.
.\" .It Nm device
.\" Boot device name (e.g.,
.\" .Li cf0a ,
.\" .Li cf0d ) .
.It Nm howto
Options to pass to the loaded kernel.
.It Nm image
File name containing the kernel image.
.It Nm timeout
Number of seconds boot will wait for human intervention before
booting the default kernel image.
.\" .It Nm tty
.\" Active console device name (e.g.,
.\" .Li scif0 ) .
.El
.\" XXX although implemented, better leave it undocumented for now -- miod
.\" .It stty Op Ar device Op Ar speed
.\" Displays or sets the
.\" .Ar speed
.\" for a console
.\" .Ar device .
.\" If changing the baudrate for the currently active console,
.\" .Nm
.\" offers you five seconds of grace time before committing the change
.\" to allow you to change your terminal's speed to match.
.\" If changing speed
.\" .Em not
.\" for the active console, the baudrate is set for the
.\" .Em next
.\" time you switch to a serial console.
.\" .Pp
.\" The default baudrate is 9600bps.
.It time
Displays system time and date.
.El
.Sh FILES
.Bl -tag -width /usr/mdec/xxboot -compact
.It Pa /boot
system bootstrap
.It Pa /etc/boot.conf
system bootstrap's startup file
.It Pa /bsd
kernel image
.It Pa /bsd.rd
kernel image for installation/recovery
.It Pa /usr/mdec/xxboot
first stage bootstrap
.El
.Sh EXAMPLES
Boot the default kernel:
.Pp
.Dl boot> boot
.Pp
Remove the 5 second pause at boot-time permanently, causing
.Nm
to load the kernel immediately without prompting:
.Pp
.Dl # echo \&"boot\&" > /etc/boot.conf
.Pp
Boot the kernel named
.Pa /bsd.rd
in
.Dq User Kernel Configuration
mode (see
.Xr boot_config 8 ) .
This mechanism allows for the explicit enabling and disabling of devices
during the current boot sequence, as well as the modification
of device parameters.
Once booted, such changes can be made permanent by using
.Xr config 8 Ns 's
.Fl e
option.
.Pp
.Dl boot> boot cf:/bsd.rd -c
.Sh SEE ALSO
.Xr gzip 1 ,
.Xr autoconf 4 ,
.Xr ddb 4 ,
.Xr boot_config 8 ,
.Xr boot_landisk 8 ,
.Xr fdisk 8 ,
.Xr reboot 8 ,
.Xr xxboot 8
.Sh HISTORY
This program was written by Michael Shalayeff for
.Ox 4.1 .
@


1.6
log
@document that boot.conf can contain comments;
from tilo stritzky

thanks miod for help with the diff, and who also noted that
leading whitespace gets stripped too;
@
text
@d1 1
a1 1
.\"	$OpenBSD: boot.8,v 1.5 2015/01/24 20:47:19 naddy Exp $
d28 1
a28 1
.Dd $Mdocdate: January 24 2015 $
d34 1
a34 2
.Nd
landisk-specific second-stage bootstrap
@


1.5
log
@correct the syntax description of the boot command; ok jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: boot.8,v 1.4 2012/09/27 12:26:28 jmc Exp $
d28 1
a28 1
.Dd $Mdocdate: September 27 2012 $
d78 6
a83 1
This file may contain any commands
@


1.4
log
@remove the zlib rfc text: these pages already point to gzip(1), which
has the references, and the rfc is not that relevant anyway;
@
text
@d1 1
a1 1
.\"	$OpenBSD: boot.8,v 1.3 2012/08/15 19:02:01 jmc Exp $
d28 1
a28 1
.Dd $Mdocdate: August 15 2012 $
d118 6
a123 2
.It boot Op Ar image Op Fl acds
Boots the kernel image specified by
d125 1
a125 5
with any options given.
Image specification consists of a pair
.Ar device : Ns Ar filename ;
either or both can be omitted (`:' is not needed if both are omitted),
in which case values from
@


1.3
log
@use Lk for links;
@
text
@d1 1
a1 1
.\"	$OpenBSD: boot.8,v 1.2 2008/05/28 21:26:09 miod Exp $
d28 1
a28 1
.Dd $Mdocdate: May 28 2008 $
a274 6
.Pp
RFC 1950 describes the zlib library interface.
.Pp
The official home page for the version of zlib used in this
operating system is at
.Lk http://www.gzip.org/zlib/ .
@


1.2
log
@Don't document ``device foo'' yet either.
@
text
@d1 1
a1 1
.\"	$OpenBSD: boot.8,v 1.1 2008/05/28 21:16:43 miod Exp $
d279 2
a280 1
operating system is at http://www.gzip.org/zlib/.
@


1.1
log
@Add a boot.8 manual page (adapted from other platforms which use the MI
secondary boot loader).  This will in turn act as a reminder to write
boot_landisk.8 (soon).
@
text
@d1 1
a1 1
.\"	$OpenBSD: boot.8,v 1.47 2007/05/31 19:20:03 jmc Exp $
d28 1
a28 1
.Dd $Mdocdate$
d191 5
a195 4
.It Nm device
Boot device name (e.g.,
.Li fd0a ,
.Li hd0a ) .
@

