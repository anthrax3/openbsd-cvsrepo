head	1.38;
access;
symbols
	OPENBSD_6_1:1.38.0.4
	OPENBSD_6_1_BASE:1.38
	OPENBSD_6_0:1.35.0.2
	OPENBSD_6_0_BASE:1.35
	OPENBSD_5_9:1.32.0.2
	OPENBSD_5_9_BASE:1.32
	OPENBSD_5_8:1.31.0.6
	OPENBSD_5_8_BASE:1.31
	OPENBSD_5_7:1.31.0.2
	OPENBSD_5_7_BASE:1.31
	OPENBSD_5_6:1.27.0.6
	OPENBSD_5_6_BASE:1.27
	OPENBSD_5_5:1.27.0.4
	OPENBSD_5_5_BASE:1.27
	OPENBSD_5_4:1.25.0.2
	OPENBSD_5_4_BASE:1.25
	OPENBSD_5_3:1.23.0.2
	OPENBSD_5_3_BASE:1.23
	OPENBSD_5_2:1.22.0.2
	OPENBSD_5_2_BASE:1.22
	OPENBSD_5_1_BASE:1.21
	OPENBSD_5_1:1.21.0.2
	OPENBSD_5_0:1.19.0.4
	OPENBSD_5_0_BASE:1.19
	OPENBSD_4_9:1.19.0.2
	OPENBSD_4_9_BASE:1.19
	OPENBSD_4_8:1.16.0.2
	OPENBSD_4_8_BASE:1.16
	OPENBSD_4_7:1.13.0.2
	OPENBSD_4_7_BASE:1.13
	OPENBSD_4_6:1.12.0.4
	OPENBSD_4_6_BASE:1.12
	OPENBSD_4_5:1.10.0.2
	OPENBSD_4_5_BASE:1.10
	OPENBSD_4_4:1.9.0.2
	OPENBSD_4_4_BASE:1.9
	OPENBSD_4_3:1.6.0.4
	OPENBSD_4_3_BASE:1.6
	OPENBSD_4_2:1.6.0.2
	OPENBSD_4_2_BASE:1.6
	OPENBSD_4_1:1.3.0.2
	OPENBSD_4_1_BASE:1.3;
locks; strict;
comment	@ * @;


1.38
date	2017.01.23.08.37.08;	author deraadt;	state Exp;
branches;
next	1.37;
commitid	8anb8Ophv7ljB5nz;

1.37
date	2016.09.04.10.51.23;	author naddy;	state Exp;
branches;
next	1.36;
commitid	4OWaAfwqMvhOCLOI;

1.36
date	2016.09.02.17.06.12;	author goda;	state Exp;
branches;
next	1.35;
commitid	J1JzeTsS8K8zyH3c;

1.35
date	2016.04.25.20.09.14;	author tedu;	state Exp;
branches;
next	1.34;
commitid	43yo2G4zZOY9ab4i;

1.34
date	2016.03.05.17.16.33;	author tobiasu;	state Exp;
branches;
next	1.33;
commitid	tnf9BWAlxRCsKh8M;

1.33
date	2016.02.26.09.10.05;	author natano;	state Exp;
branches;
next	1.32;
commitid	NHDvdrxPpwDqGtpK;

1.32
date	2015.10.23.15.10.52;	author claudio;	state Exp;
branches;
next	1.31;
commitid	g17gxjQh9N9egLbB;

1.31
date	2014.12.11.19.44.17;	author tedu;	state Exp;
branches;
next	1.30;
commitid	jUSAZlQ30WF1ESM9;

1.30
date	2014.10.09.04.10.03;	author tedu;	state Exp;
branches;
next	1.29;
commitid	Db8IHIncfKM3SDX9;

1.29
date	2014.10.09.03.59.59;	author tedu;	state Exp;
branches;
next	1.28;
commitid	I0KLtD9aVxAdm6aW;

1.28
date	2014.08.20.06.14.42;	author mikeb;	state Exp;
branches;
next	1.27;
commitid	qXFkosC6o9cv78HT;

1.27
date	2013.11.04.14.11.29;	author deraadt;	state Exp;
branches;
next	1.26;

1.26
date	2013.08.20.14.27.28;	author ajacoutot;	state Exp;
branches;
next	1.25;

1.25
date	2013.06.03.15.54.47;	author tedu;	state Exp;
branches;
next	1.24;

1.24
date	2013.03.15.09.10.52;	author ratchov;	state Exp;
branches;
next	1.23;

1.23
date	2012.08.23.06.12.49;	author deraadt;	state Exp;
branches;
next	1.22;

1.22
date	2012.04.06.15.10.40;	author jsing;	state Exp;
branches;
next	1.21;

1.21
date	2011.10.06.20.49.28;	author deraadt;	state Exp;
branches;
next	1.20;

1.20
date	2011.09.16.21.01.45;	author miod;	state Exp;
branches;
next	1.19;

1.19
date	2011.01.14.19.04.08;	author jasper;	state Exp;
branches;
next	1.18;

1.18
date	2010.11.19.20.55.48;	author miod;	state Exp;
branches;
next	1.17;

1.17
date	2010.09.23.05.02.14;	author claudio;	state Exp;
branches;
next	1.16;

1.16
date	2010.07.03.03.59.16;	author krw;	state Exp;
branches;
next	1.15;

1.15
date	2010.06.09.15.25.32;	author jsing;	state Exp;
branches;
next	1.14;

1.14
date	2010.03.30.19.16.09;	author matthieu;	state Exp;
branches;
next	1.13;

1.13
date	2009.08.13.15.04.20;	author dlg;	state Exp;
branches;
next	1.12;

1.12
date	2009.06.03.14.45.52;	author jj;	state Exp;
branches;
next	1.11;

1.11
date	2009.05.15.16.21.25;	author deraadt;	state Exp;
branches;
next	1.10;

1.10
date	2009.01.25.17.30.48;	author miod;	state Exp;
branches;
next	1.9;

1.9
date	2008.06.12.20.03.48;	author mglocker;	state Exp;
branches;
next	1.8;

1.8
date	2008.05.14.20.49.48;	author miod;	state Exp;
branches;
next	1.7;

1.7
date	2008.04.08.14.31.54;	author claudio;	state Exp;
branches;
next	1.6;

1.6
date	2007.05.28.22.26.03;	author todd;	state Exp;
branches;
next	1.5;

1.5
date	2007.05.27.01.50.36;	author todd;	state Exp;
branches;
next	1.4;

1.4
date	2007.05.26.19.54.24;	author todd;	state Exp;
branches;
next	1.3;

1.3
date	2006.11.03.20.21.23;	author mickey;	state Exp;
branches;
next	1.2;

1.2
date	2006.11.03.19.54.02;	author mickey;	state Exp;
branches;
next	1.1;

1.1
date	2006.10.06.21.48.50;	author mickey;	state Exp;
branches;
next	;


desc
@@


1.38
log
@remove #defines present in MI conf.h; ok kettenis
@
text
@/*	$OpenBSD: conf.c,v 1.37 2016/09/04 10:51:23 naddy Exp $	*/

/*
 * Copyright (c) 1994-1998 Mark Brinicombe.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 *	This product includes software developed by Mark Brinicombe
 *	for the NetBSD Project.
 * 4. The name of the company nor the name of the author may be used to
 *    endorse or promote products derived from this software without specific
 *    prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR IMPLIED
 * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
 * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 *
 * RiscBSD kernel project
 *
 * conf.c
 *
 * Character and Block Device configuration
 * Console configuration
 *
 * Defines the structures [bc]devsw
 *
 * Created      : 17/09/94
 */

#include <sys/param.h>
#include <sys/systm.h>
#include <sys/buf.h>
#include <sys/ioctl.h>
#include <sys/tty.h>
#include <sys/conf.h>
#include <sys/vnode.h>

#include <machine/conf.h>

/*
 * From this point, these need to be MI foo.h files.
 */

/*
 * Standard MI devices (e.g. ones in dev/ic)
 */
#include "com.h"		/* NS164x0 serial ports */

/*
 * Standard pseudo-devices
 */
#include "bpfilter.h"
#include "pf.h"
#include "bio.h"
#include "pty.h"
#include "tun.h"
#include "ksyms.h"

/*
 * Disk/Filesystem pseudo-devices
 */
#include "rd.h"				/* memory disk driver */
#include "vnd.h"			/* vnode disk driver */

/*
 * WD/ATA devices
 */
#include "wd.h"
bdev_decl(wd);

#ifdef USER_PCICONF
#include "pci.h"
cdev_decl(pci);
#endif

/*
 * SCSI/ATAPI devices
 */
#include "sd.h"
#include "st.h"
#include "cd.h"
#include "ch.h"
#include "uk.h"

/*
 * Audio devices
 */
#include "audio.h"
#include "video.h"
#include "midi.h"

/*
 * USB devices
 */
#include "usb.h"
#include "ucom.h"
#include "ugen.h"
#include "uhid.h"
#include "ulpt.h"

/*
 * WSCONS devices
 */
#include "wsdisplay.h"
/*
#include "wsfont.h"
*/
#include "wskbd.h"
#include "wsmouse.h"
#include "wsmux.h"
cdev_decl(wskbd);
cdev_decl(wsmouse);

#include "lpt.h"
#include "radio.h"
cdev_decl(radio);

/* Block devices */

struct bdevsw bdevsw[] = {
	bdev_notdef(),			/*  0: */
	bdev_swap_init(1, sw),		/*  1: swap pseudo-device */
	bdev_notdef(),			/*  2: */
	bdev_notdef(),			/*  3: */
	bdev_notdef(),			/*  4: */
	bdev_notdef(),			/*  5: */
	bdev_notdef(),			/*  6: */
	bdev_notdef(),			/*  7: */
	bdev_notdef(),			/*  8: */
	bdev_notdef(),			/*  9: */
	bdev_notdef(),			/* 10: */
	bdev_notdef(),			/* 11: */
	bdev_notdef(),			/* 12: */
	bdev_notdef(),			/* 13: */
	bdev_notdef(),			/* 14: */
	bdev_notdef(),			/* 15: */
	bdev_disk_init(NWD,wd),		/* 16: Internal IDE disk */
	bdev_notdef(),			/* 17: */
	bdev_disk_init(NRD,rd),		/* 18: memory disk */
	bdev_disk_init(NVND,vnd),	/* 19: vnode disk driver */
	bdev_notdef(),			/* 20: */
 	bdev_notdef(),			/* 21: was: concatenated disk driver */
	bdev_notdef(),			/* 22: */
	bdev_notdef(),			/* 23: */
	bdev_disk_init(NSD,sd),		/* 24: SCSI disk */
	bdev_notdef(),			/* 25: was: SCSI tape */
	bdev_disk_init(NCD,cd),		/* 26: SCSI cdrom */
	bdev_notdef(),			/* 27: */
	bdev_notdef(),			/* 28: */
	bdev_notdef(),			/* 29: */
	bdev_notdef(),			/* 30: */
	bdev_notdef(),			/* 31: */
	bdev_notdef(),			/* 32: */
	bdev_notdef(),			/* 33: */
	bdev_notdef(),			/* 34: */
	bdev_notdef(),			/* 35: */
	bdev_notdef(),			/* 36: */
	bdev_notdef(),			/* 37: */
	bdev_notdef(),			/* 38: */
	bdev_notdef(),			/* 39: */
	bdev_notdef(),			/* 40: */
	bdev_notdef(),			/* 41: */
	bdev_notdef(),			/* 42: */
	bdev_notdef(),			/* 43: */
	bdev_notdef(),			/* 44: */
	bdev_notdef(),			/* 45: */
	bdev_notdef(),			/* 46: */
	bdev_notdef(),			/* 47: */
	bdev_notdef(),			/* 48: */
	bdev_notdef(),			/* 49: */
	bdev_notdef(),			/* 50: */
	bdev_notdef(),			/* 51: */
	bdev_notdef(),			/* 52: */
	bdev_notdef(),			/* 53: */
	bdev_notdef(),			/* 54: */
	bdev_notdef(),			/* 55: */
	bdev_notdef(),			/* 56: */
	bdev_notdef(),			/* 57: */
	bdev_notdef(),			/* 58: */
	bdev_notdef(),			/* 59: */
	bdev_notdef(),			/* 60: */
	bdev_notdef(),			/* 61: */
	bdev_notdef(),			/* 62: */
	bdev_notdef(),			/* 63: */
	bdev_notdef(),			/* 64: */
	bdev_notdef(),			/* 65: */
	bdev_notdef(),			/* 66: */
	bdev_notdef(),			/* 67: */
	bdev_notdef(),			/* 68: */
	bdev_notdef(),			/* 69: */
	bdev_notdef(),			/* 70: */
	bdev_notdef(),			/* 71 was: RAIDframe disk driver */
	bdev_notdef(),			/* 72: */
	bdev_notdef(),			/* 73: */
	bdev_notdef(),			/* 74: */
	bdev_notdef(),			/* 75: */
	bdev_notdef(),			/* 76: */
	bdev_notdef(),			/* 77: */
	bdev_notdef(),			/* 78: */
	bdev_notdef(),			/* 79: */
	bdev_notdef(),			/* 80: */
	bdev_notdef(),			/* 81: */
	bdev_notdef(),			/* 82: */
	bdev_notdef(),			/* 83: */
	bdev_notdef(),			/* 84: */
	bdev_notdef(),			/* 85: */
	bdev_notdef(),			/* 86: */
	bdev_notdef(),			/* 87: */
	bdev_notdef(),			/* 88: */
	bdev_notdef(),			/* 89: */
	bdev_notdef(),			/* 90: */
	bdev_notdef(),			/* 91: */
	bdev_notdef(),			/* 93: */
	bdev_notdef(),			/* 94: */
	bdev_notdef(),			/* 95: */
	bdev_notdef(),			/* 96: */
	bdev_notdef(),			/* 97: */
};

#include "hotplug.h"
#include "scif.h"
#include "vscsi.h"
#include "pppx.h"
#include "fuse.h"
#include "switch.h"

struct cdevsw cdevsw[] = {
	cdev_cn_init(1,cn),			/*  0: virtual console */
	cdev_ctty_init(1,ctty),			/*  1: controlling terminal */
	cdev_mm_init(1,mm),			/*  2: /dev/{null,mem,kmem,...} */
	cdev_notdef(),				/*  3 was /dev/drum */
	cdev_tty_init(NPTY,pts),		/*  4: pseudo-tty slave */
	cdev_ptc_init(NPTY,ptc),		/*  5: pseudo-tty master */
	cdev_log_init(1,log),			/*  6: /dev/klog */
	cdev_fd_init(1,filedesc),		/*  7: file descriptor pseudo-device */
	cdev_ksyms_init(NKSYMS,ksyms),		/*  8: Kernel symbols device */
	cdev_notdef(),				/*  9: */
	cdev_notdef(),				/* 10: */
	cdev_tty_init(NSCIF,scif),		/* 11: scif */
	cdev_tty_init(NCOM,com),		/* 12: serial port */
	cdev_notdef(),				/* 13: */
	cdev_notdef(),				/* 14: */
	cdev_notdef(),				/* 15: */
	cdev_disk_init(NWD,wd),			/* 16: ST506/ESDI/IDE disk */
	cdev_notdef(),				/* 17: */
	cdev_disk_init(NRD,rd),			/* 18: ram disk driver */
	cdev_disk_init(NVND,vnd),		/* 19: vnode disk driver */
	cdev_notdef(),				/* 20: */
	cdev_notdef(),				/* 21: was: concatenated disk driver */
	cdev_bpf_init(NBPFILTER,bpf),		/* 22: Berkeley packet filter */
	cdev_notdef(),				/* 23: */
	cdev_disk_init(NSD,sd),			/* 24: SCSI disk */
	cdev_tape_init(NST,st),			/* 25: SCSI tape */
	cdev_disk_init(NCD,cd),			/* 26: SCSI CD-ROM */
	cdev_ch_init(NCH,ch),	 		/* 27: SCSI autochanger */
	cdev_uk_init(NUK,uk),	 		/* 28: SCSI unknown */
	cdev_notdef(),				/* 29: */
	cdev_notdef(),				/* 30: */
	cdev_notdef(),				/* 31: */
	cdev_notdef(),				/* 32: */
	cdev_tun_init(NTUN,tun),		/* 33: network tunnel */
	cdev_notdef(),				/* 34: */
	cdev_notdef(),				/* 35: was LKM */
	cdev_audio_init(NAUDIO,audio),		/* 36: generic audio I/O */
	cdev_hotplug_init(NHOTPLUG,hotplug),	/* 37: devices hot plugging*/
	cdev_bio_init(NBIO,bio),		/* 38: ioctl tunnel */
	cdev_notdef(),				/* 39: reserved */
	cdev_random_init(1,random),		/* 40: random generator */
	cdev_notdef(),				/* 41: reserved */
	cdev_notdef(),				/* 42: reserved */
	cdev_notdef(),				/* 43: reserved */
	cdev_notdef(),				/* 44: reserved */
	cdev_notdef(),				/* 45: reserved */
	cdev_pf_init(NPF,pf),           	/* 46: packet filter */
	cdev_notdef(),				/* 47: was /dev/crypto */
	cdev_notdef(),				/* 48: reserved */
	cdev_notdef(),				/* 49: reserved */
	cdev_notdef(),				/* 50: reserved */
	cdev_notdef(),				/* 51: reserved */
	cdev_notdef(),				/* 52: reserved */
	cdev_notdef(),				/* 53: reserved */
	cdev_notdef(),				/* 54: reserved */
	cdev_notdef(),				/* 55: Reserved for bypass device */	
	cdev_notdef(),				/* 56: reserved */
	cdev_midi_init(NMIDI,midi),		/* 57: MIDI I/O */
	cdev_notdef(),				/* 58 was: sequencer I/O */
	cdev_notdef(),				/* 59: reserved */
	cdev_wsdisplay_init(NWSDISPLAY,wsdisplay), /* 60: frame buffers, etc.*/
	cdev_mouse_init(NWSKBD,wskbd),		/* 61: keyboards */
	cdev_mouse_init(NWSMOUSE,wsmouse),	/* 62: mice */
	cdev_mouse_init(NWSMUX,wsmux),		/* 63: ws multiplexor */
	cdev_usb_init(NUSB,usb),		/* 64: USB controller */
	cdev_usbdev_init(NUHID,uhid),		/* 65: USB generic HID */
	cdev_ulpt_init(NULPT,ulpt),		/* 66: USB printer */
	cdev_notdef(),				/* 67: was urio */
	cdev_tty_init(NUCOM,ucom),		/* 68: USB tty */
	cdev_notdef(),				/* 69: was USB scanners */
	cdev_usbdev_init(NUGEN,ugen),		/* 70: USB generic driver */
	cdev_notdef(),		    		/* 71 was: RAIDframe disk driver */
	cdev_notdef(),				/* 72: reserved */
	cdev_notdef(),				/* 73: reserved */
	cdev_notdef(),				/* 74: reserved */
	cdev_notdef(),				/* 75: reserved */
	cdev_notdef(),				/* 76: reserved */
	cdev_video_init(NVIDEO,video),		/* 77: generic video I/O */
	cdev_notdef(),                          /* 78: removed device */
	cdev_notdef(),                          /* 79: removed device */
	cdev_notdef(),                          /* 80: removed device */
	cdev_notdef(),                          /* 81: removed device */
	cdev_notdef(),                          /* 82: removed device */
	cdev_notdef(),                          /* 83: removed device */
	cdev_notdef(),                          /* 84: removed device */
	cdev_notdef(),                          /* 85: removed device */
	cdev_notdef(),                          /* 86: removed device */
	cdev_notdef(),                          /* 87: removed device */
#ifdef USER_PCICONF
	cdev_pci_init(NPCI,pci),		/* 88: PCI user */
#else
	cdev_notdef(),
#endif
	cdev_notdef(),                          /* 89: removed device */
	cdev_notdef(),                          /* 90: removed device */
	cdev_notdef(),                          /* 91: removed device */
	cdev_notdef(),                          /* 92: removed device */
	cdev_notdef(),                          /* 93: removed device */
	cdev_notdef(),                          /* 94: removed device */
	cdev_notdef(),                          /* 95: removed device */
	cdev_notdef(),                          /* 96: removed device */
	cdev_radio_init(NRADIO,radio),		/* 97: generic radio I/O */
	cdev_ptm_init(NPTY,ptm),		/* 98: pseudo-tty ptm device */
	cdev_vscsi_init(NVSCSI,vscsi),		/* 99: vscsi */
	cdev_notdef(),
	cdev_disk_init(1,diskmap),		/* 101: disk mapper */
	cdev_pppx_init(NPPPX,pppx),		/* 102: pppx */
	cdev_fuse_init(NFUSE,fuse),		/* 103: fuse */
	cdev_tun_init(NTUN,tap),		/* 104: Ethernet network tap */
	cdev_switch_init(NSWITCH,switch),	/* 105: switch(4) control interface */
};

int nblkdev = nitems(bdevsw);
int nchrdev = nitems(cdevsw);

int mem_no = 2; 	/* major device number of memory special file */

/*
 * Swapdev is a fake device implemented
 * in sw.c used only internally to get to swstrategy.
 * It cannot be provided to the users, because the
 * swstrategy routine munches the b_dev and b_blkno entries
 * before calling the appropriate driver.  This would horribly
 * confuse, e.g. the hashing routines. Instead, /dev/drum is
 * provided as a character (raw) device.
 */
dev_t	swapdev = makedev(1, 0);

/*
 * Returns true if dev is /dev/mem or /dev/kmem.
 */
int
iskmemdev(dev)
	dev_t dev;
{
	return (major(dev) == mem_no && minor(dev) < 2);
}

/*
 * Returns true if dev is /dev/zero.
 */
int
iszerodev(dev)
	dev_t dev;
{
	return (major(dev) == mem_no && minor(dev) == 3);
}


int chrtoblktbl[] = {
    /*VCHR*/        /*VBLK*/
    /*  0 */        NODEV,
    /*  1 */        NODEV,
    /*  2 */        NODEV,
    /*  3 */        NODEV,
    /*  4 */        NODEV,
    /*  5 */        NODEV,
    /*  6 */        NODEV,
    /*  7 */        NODEV,
    /*  8 */        NODEV,
    /*  9 */        NODEV,
    /* 10 */        NODEV,
    /* 11 */        NODEV,
    /* 12 */        NODEV,
    /* 13 */        NODEV,
    /* 14 */        NODEV,
    /* 15 */        NODEV,
    /* 16 */        16,			/* wd */
    /* 17 */        NODEV,
    /* 18 */        18,			/* rd */
    /* 19 */        19,			/* vnd */
    /* 20 */        NODEV,
    /* 21 */        NODEV,
    /* 22 */        NODEV,
    /* 23 */        NODEV,
    /* 24 */        24,			/* sd */
    /* 25 */        NODEV,
    /* 26 */        26,			/* cd */
};
int nchrtoblktbl = nitems(chrtoblktbl);


dev_t
getnulldev(void)
{
	return makedev(mem_no, 2);
}
@


1.37
log
@Remove support for tape block devices. Nobody mount(8)s tapes any longer.
ok deraadt@@ guenther@@
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.36 2016/09/02 17:06:12 goda Exp $	*/
a235 6

/* Character devices */
#define ptstty          ptytty
#define ptsioctl        ptyioctl
#define ptctty          ptytty
#define ptcioctl        ptyioctl
@


1.36
log
@Add switch(4) cdev entry

ok deraadt@@ yasuoka@@ reyk@@
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.35 2016/04/25 20:09:14 tedu Exp $	*/
d163 1
a163 1
	bdev_tape_init(NST,st),		/* 25: SCSI tape */
d427 1
a427 1
    /* 25 */        25,			/* st */
@


1.35
log
@remove systrace
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.34 2016/03/05 17:16:33 tobiasu Exp $	*/
d248 1
d360 1
@


1.34
log
@Sync no-argument function declaration and definition by adding (void).
Covers all of landisk/sh, per naddy's suggestion.

ok on previous diff deraadt@@ naddy@@
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.33 2016/02/26 09:10:05 natano Exp $	*/
a242 2
#include "systrace.h"

d300 1
a300 1
	cdev_systrace_init(NSYSTRACE,systrace),	/* 50: system call tracing */
@


1.33
log
@Remove stale RAIDframe entries from chrtoblktbl.

While there truncate the tables to the minimum required size; chrtoblk()
and blktochr() are designed to handle a table shorter than cdevsw.

"Looks good to me" deraadt@@
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.32 2015/10/23 15:10:52 claudio Exp $	*/
d434 1
a434 1
getnulldev()
@


1.32
log
@Allocate a new major for tap(4) also note that pseudo-device tun is for tap
as well. OK dlg@@ mpi@@
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.31 2014/12/11 19:44:17 tedu Exp $	*/
a428 45
    /* 27 */        NODEV,
    /* 28 */        NODEV,
    /* 29 */        NODEV,
    /* 30 */        NODEV,
    /* 31 */        NODEV,
    /* 32 */        NODEV,
    /* 33 */        NODEV,
    /* 34 */        NODEV,
    /* 35 */        NODEV,
    /* 36 */        NODEV,
    /* 37 */        NODEV,
    /* 38 */        NODEV,
    /* 39 */        NODEV,
    /* 40 */        NODEV,
    /* 41 */        NODEV,
    /* 42 */        NODEV,
    /* 43 */        NODEV,
    /* 44 */        NODEV,
    /* 45 */        NODEV,
    /* 46 */        NODEV,
    /* 47 */        NODEV,
    /* 48 */        NODEV,
    /* 49 */        NODEV,
    /* 50 */        NODEV,
    /* 51 */        NODEV,
    /* 52 */        NODEV,
    /* 53 */        NODEV,
    /* 54 */        NODEV,
    /* 55 */        NODEV,
    /* 56 */	    NODEV,
    /* 57 */	    NODEV,
    /* 58 */	    NODEV,
    /* 59 */        NODEV,
    /* 60 */        NODEV,
    /* 61 */        NODEV,
    /* 62 */        NODEV,
    /* 63 */        NODEV,
    /* 64 */        NODEV,
    /* 65 */        NODEV,
    /* 66 */	    NODEV,
    /* 67 */	    NODEV,
    /* 68 */	    NODEV,
    /* 69 */	    NODEV,
    /* 70 */	    NODEV,
    /* 71 */	    71,			/* raid */
@


1.31
log
@dragonflybsd has added a urio driver. conservation of urios requires
that we delete ours, which isn't actually useful.
ok mpi sthen
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.30 2014/10/09 04:10:03 tedu Exp $	*/
d360 1
@


1.30
log
@mechanical translation of dev_lkm_dummy() to dev_notdef()
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.29 2014/10/09 03:59:59 tedu Exp $	*/
a116 1
#include "urio.h"
d319 1
a319 1
	cdev_urio_init(NURIO,urio),		/* 67: Diamond Rio 500 */
@


1.29
log
@remove LKM devices
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.28 2014/08/20 06:14:42 mikeb Exp $	*/
d139 1
a139 1
	bdev_lkm_dummy(),		/*  0: */
d141 14
a154 14
	bdev_lkm_dummy(),		/*  2: */
	bdev_lkm_dummy(),		/*  3: */
	bdev_lkm_dummy(),		/*  4: */
	bdev_lkm_dummy(),		/*  5: */
	bdev_lkm_dummy(),		/*  6: */
	bdev_lkm_dummy(),		/*  7: */
	bdev_lkm_dummy(),		/*  8: */
	bdev_lkm_dummy(),		/*  9: */
	bdev_lkm_dummy(),		/* 10: */
	bdev_lkm_dummy(),		/* 11: */
	bdev_lkm_dummy(),		/* 12: */
	bdev_lkm_dummy(),		/* 13: */
	bdev_lkm_dummy(),		/* 14: */
	bdev_lkm_dummy(),		/* 15: */
d156 1
a156 1
	bdev_lkm_dummy(),		/* 17: */
d159 1
a159 1
	bdev_lkm_dummy(),		/* 20: */
d161 2
a162 2
	bdev_lkm_dummy(),		/* 22: */
	bdev_lkm_dummy(),		/* 23: */
d166 44
a209 44
	bdev_lkm_dummy(),		/* 27: */
	bdev_lkm_dummy(),		/* 28: */
	bdev_lkm_dummy(),		/* 29: */
	bdev_lkm_dummy(),		/* 30: */
	bdev_lkm_dummy(),		/* 31: */
	bdev_lkm_dummy(),		/* 32: */
	bdev_lkm_dummy(),		/* 33: */
	bdev_lkm_dummy(),		/* 34: */
	bdev_lkm_dummy(),		/* 35: */
	bdev_lkm_dummy(),		/* 36: */
	bdev_lkm_dummy(),		/* 37: */
	bdev_lkm_dummy(),		/* 38: */
	bdev_lkm_dummy(),		/* 39: */
	bdev_lkm_dummy(),		/* 40: */
	bdev_lkm_dummy(),		/* 41: */
	bdev_lkm_dummy(),		/* 42: */
	bdev_lkm_dummy(),		/* 43: */
	bdev_lkm_dummy(),		/* 44: */
	bdev_lkm_dummy(),		/* 45: */
	bdev_lkm_dummy(),		/* 46: */
	bdev_lkm_dummy(),		/* 47: */
	bdev_lkm_dummy(),		/* 48: */
	bdev_lkm_dummy(),		/* 49: */
	bdev_lkm_dummy(),		/* 50: */
	bdev_lkm_dummy(),		/* 51: */
	bdev_lkm_dummy(),		/* 52: */
	bdev_lkm_dummy(),		/* 53: */
	bdev_lkm_dummy(),		/* 54: */
	bdev_lkm_dummy(),		/* 55: */
	bdev_lkm_dummy(),		/* 56: */
	bdev_lkm_dummy(),		/* 57: */
	bdev_lkm_dummy(),		/* 58: */
	bdev_lkm_dummy(),		/* 59: */
	bdev_lkm_dummy(),		/* 60: */
	bdev_lkm_dummy(),		/* 61: */
	bdev_lkm_dummy(),		/* 62: */
	bdev_lkm_dummy(),		/* 63: */
	bdev_lkm_dummy(),		/* 64: */
	bdev_lkm_dummy(),		/* 65: */
	bdev_lkm_dummy(),		/* 66: */
	bdev_lkm_dummy(),		/* 67: */
	bdev_lkm_dummy(),		/* 68: */
	bdev_lkm_dummy(),		/* 69: */
	bdev_lkm_dummy(),		/* 70: */
d211 25
a235 25
	bdev_lkm_dummy(),		/* 72: */
	bdev_lkm_dummy(),		/* 73: */
	bdev_lkm_dummy(),		/* 74: */
	bdev_lkm_dummy(),		/* 75: */
	bdev_lkm_dummy(),		/* 76: */
	bdev_lkm_dummy(),		/* 77: */
	bdev_lkm_dummy(),		/* 78: */
	bdev_lkm_dummy(),		/* 79: */
	bdev_lkm_dummy(),		/* 80: */
	bdev_lkm_dummy(),		/* 81: */
	bdev_lkm_dummy(),		/* 82: */
	bdev_lkm_dummy(),		/* 83: */
	bdev_lkm_dummy(),		/* 84: */
	bdev_lkm_dummy(),		/* 85: */
	bdev_lkm_dummy(),		/* 86: */
	bdev_lkm_dummy(),		/* 87: */
	bdev_lkm_dummy(),		/* 88: */
	bdev_lkm_dummy(),		/* 89: */
	bdev_lkm_dummy(),		/* 90: */
	bdev_lkm_dummy(),		/* 91: */
	bdev_lkm_dummy(),		/* 93: */
	bdev_lkm_dummy(),		/* 94: */
	bdev_lkm_dummy(),		/* 95: */
	bdev_lkm_dummy(),		/* 96: */
	bdev_lkm_dummy(),		/* 97: */
d262 2
a263 2
	cdev_lkm_dummy(),			/*  9: */
	cdev_lkm_dummy(),			/* 10: */
d266 3
a268 3
	cdev_lkm_dummy(),			/* 13: */
	cdev_lkm_dummy(),			/* 14: */
	cdev_lkm_dummy(),			/* 15: */
d270 1
a270 1
	cdev_lkm_dummy(),			/* 17: */
d273 1
a273 1
	cdev_lkm_dummy(),			/* 20: */
d276 1
a276 1
	cdev_lkm_dummy(),			/* 23: */
d283 3
a285 3
	cdev_lkm_dummy(),			/* 30: */
	cdev_lkm_dummy(),			/* 31: */
	cdev_lkm_dummy(),			/* 32: */
d287 1
a287 1
	cdev_lkm_dummy(),			/* 34: */
d292 1
a292 1
	cdev_lkm_dummy(),			/* 39: reserved */
d294 5
a298 5
	cdev_lkm_dummy(),			/* 41: reserved */
	cdev_lkm_dummy(),			/* 42: reserved */
	cdev_lkm_dummy(),			/* 43: reserved */
	cdev_lkm_dummy(),			/* 44: reserved */
	cdev_lkm_dummy(),			/* 45: reserved */
d301 2
a302 2
	cdev_lkm_dummy(),			/* 48: reserved */
	cdev_lkm_dummy(),			/* 49: reserved */
d308 1
a308 1
	cdev_lkm_dummy(),			/* 55: Reserved for bypass device */	
d325 5
a329 5
	cdev_lkm_dummy(),			/* 72: reserved */
	cdev_lkm_dummy(),			/* 73: reserved */
	cdev_lkm_dummy(),			/* 74: reserved */
	cdev_lkm_dummy(),			/* 75: reserved */
	cdev_lkm_dummy(),			/* 76: reserved */
@


1.28
log
@unlink crypto(4) pseudo device from the architecture dependant character
device tables and kernel config files.  ok deraadt
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.27 2013/11/04 14:11:29 deraadt Exp $	*/
d288 1
a288 1
	cdev_lkm_init(NLKM,lkm),		/* 35: loadable module driver */
a400 1
/* XXXX This needs to be dynamic for LKMs. */
@


1.27
log
@remove iop(4) driver.  it is entirely unmaintained and supports something
which basically doesn't exist at all.
reminded about it by brad
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.26 2013/08/20 14:27:28 ajacoutot Exp $	*/
a56 2
#include "inet.h"

d300 1
a300 1
	cdev_crypto_init(NCRYPTO,crypto), 	/* 47: /dev/crypto */
@


1.26
log
@Remove uscanner(4). It was disabled in GENERIC more than 2.5 years ago.
No regression has been reported since libusb became the prefered
solution to work with USB scanners.

req. by mpi@@
ok ian@@ mpi@@ miod@@
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.25 2013/06/03 15:54:47 tedu Exp $	*/
a121 5
 * Bluetooth devices
 */
#include "bthub.h"

/*
d359 1
a359 1
	cdev_bthub_init(NBTHUB,bthub),		/* 100: bthub */
@


1.25
log
@changes for isc fuse support. not enabled. ok beck deraadt.
from Sylvestre Gallon ccna.syl gmail.com
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.24 2013/03/15 09:10:52 ratchov Exp $	*/
a119 1
#include "uscanner.h"
d329 1
a329 1
	cdev_usbdev_init(NUSCANNER,uscanner),	/* 69: USB scanner */
@


1.24
log
@Delete the sequencer(4) driver, since its not used any longer. Diff
mostly from armani.
ok miod, mpi, jsg and help from sthen
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.23 2012/08/23 06:12:49 deraadt Exp $	*/
d258 1
d368 1
@


1.23
log
@kill nnpfs dead
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.22 2012/04/06 15:10:40 jsing Exp $	*/
a109 1
#include "sequencer.h"
d318 1
a318 1
	cdev_midi_init(NSEQUENCER,sequencer),	/* 58: sequencer I/O */
@


1.22
log
@tedu the raidframe.

ok deraadt@@
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.20 2011/09/16 21:01:45 miod Exp $	*/
a252 4
#ifdef NNPFS
#include <nnpfs/nnnpfs.h>
cdev_decl(nnpfs_dev);
#endif
a311 3
#ifdef NNPFS
	cdev_nnpfs_init(NNNPFS,nnpfs_dev),		/* 51: nnpfs communication device */
#else
a312 1
#endif
@


1.21
log
@ccd goes to the attic
discussed with jsing and millert
@
text
@a81 1
#include "raid.h"			/* RAIDframe */
d219 1
a219 1
	bdev_disk_init(NRAID,raid),	/* 71: RAIDframe disk driver */
d340 1
a340 1
	cdev_disk_init(NRAID,raid),    		/* 71: RAIDframe disk driver */
@


1.20
log
@Use cdev_ulpt_init() to setup ulpt(4) instead of cdev_lpt_init, for
consistency.
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.19 2011/01/14 19:04:08 jasper Exp $	*/
a80 1
#include "ccd.h"			/* concatenated disk driver */
d170 1
a170 1
 	bdev_disk_init(NCCD,ccd),	/* 21: concatenated disk driver */
d287 1
a287 1
	cdev_disk_init(NCCD,ccd),		/* 21: concatenated disk driver */
d440 1
a440 1
    /* 21 */        21,			/* ccd */
@


1.19
log
@- use nitems()

"doesn't hurt" deraadt@@
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.18 2010/11/19 20:55:48 miod Exp $	*/
d337 1
a337 1
	cdev_lpt_init(NULPT,ulpt),		/* 66: USB printer */
@


1.18
log
@Sync MAKEDEV against conf.c, and both against GENERIC.
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.17 2010/09/23 05:02:14 claudio Exp $	*/
d380 2
a381 2
int nblkdev = sizeof(bdevsw) / sizeof(bdevsw[0]);
int nchrdev = sizeof(cdevsw) / sizeof(cdevsw[0]);
d493 1
a493 1
int nchrtoblktbl = sizeof(chrtoblktbl) / sizeof(chrtoblktbl[0]);
@


1.17
log
@Add pppx(4) to the cdevs of the remaining archs.
OK dlg@@
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.16 2010/07/03 03:59:16 krw Exp $	*/
d42 1
a42 1
 * Defines the structures cdevsw and constab
a78 9
 * APM interface
 */
#ifdef CONF_HAVE_APM
#include "apm.h"
#else
#define NAPM	0
#endif

/*
a265 6
#ifdef CONF_HAVE_GPIO
#include "gpio.h"
#else
#define	NGPIO 0
#endif

d280 1
a280 1
	cdev_gpio_init(NGPIO,gpio),     	/* 13: GPIO interface */
d301 1
a301 1
	cdev_apm_init(NAPM,apm),		/* 34: APM interface */
@


1.16
log
@No more ss(4) or usscanner(4). Unused, unloved and unmaintained.
General huzzahs.

"go for it" deraadt@@
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.15 2010/06/09 15:25:32 jsing Exp $	*/
d273 1
d392 1
@


1.15
log
@Wire up device nodes for disk mapper.

ok deraadt@@
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.13 2009/08/13 15:04:20 dlg Exp $	*/
a113 1
#include "ss.h"
d310 1
a310 1
	cdev_scanner_init(NSS,ss),		/* 29: SCSI scanner */
@


1.14
log
@Add missing bthub device entries on arches that support bluetooth.
ok miod@@, deraadt@@, todd@@.
@
text
@d391 1
@


1.13
log
@wire vscsi up to a cdev

for claudio@@ ok deraadt@@
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.12 2009/06/03 14:45:52 jj Exp $	*/
d136 5
d390 1
@


1.12
log
@Arla client rename from xfs to nnpfs for later upgrades. Tested on various arches. ok todd@@ beck@@
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.11 2009/05/15 16:21:25 deraadt Exp $	*/
d268 1
d384 1
@


1.11
log
@do not fake out some config-supplied foo.h / NFOO files
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.10 2009/01/25 17:30:48 miod Exp $	*/
d260 3
a262 3
#ifdef XFS
#include <xfs/nxfs.h>
cdev_decl(xfs_dev);
d327 2
a328 2
#ifdef XFS
	cdev_xfs_init(NXFS,xfs_dev),		/* 51: xfs communication device */
@


1.10
log
@Remove /dev/drum and related code.
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.9 2008/06/12 20:03:48 mglocker Exp $	*/
a137 1
#if 0
a144 6
#else
#define	NWSDISPLAY	0
#define	NWSMOUSE	0
#define	NWSKBD	0
#define	NWSMUX	0
#endif
@


1.9
log
@Enable /dev/video* for all USB capable archs.  MAKEDEV bits will follow
shortly.

OK todd@@
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.8 2008/05/14 20:49:48 miod Exp $	*/
a99 1
bdev_decl(sw);
d286 1
a286 1
	cdev_swap_init(1,sw),			/*  3: /dev/drum (swap pseudo-device) */
@


1.8
log
@Fix more chrtoblktbl[] sloppyness, and add proper block st nodes to *ppc and
sgi.
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.7 2008/04/08 14:31:54 claudio Exp $	*/
d121 1
d365 1
a365 1
	cdev_notdef(),                          /* 77: removed device */
@


1.7
log
@Split the cdev makro for bpftun into two seperate definitions. tun(4) and
bpf(4) are different enough so that the split makes sense -- this is necessary
to make bpf(4) cloneable.
requested deraadt@@, OK thib@@
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.6 2007/05/28 22:26:03 todd Exp $	*/
d433 1
a433 1
    /*  1 */        1,
d448 4
a451 4
    /* 16 */        16,
    /* 17 */        17,
    /* 18 */        18,
    /* 19 */        19,
d453 1
a453 1
    /* 21 */        21,
d456 3
a458 3
    /* 24 */        24,
    /* 25 */        25,
    /* 26 */        26,
d503 1
a503 27
    /* 71 */	    71,
    /* 72 */	    NODEV,
    /* 73 */	    NODEV,
    /* 74 */	    NODEV,
    /* 75 */	    NODEV,
    /* 76 */	    NODEV,
    /* 77 */	    NODEV,
    /* 78 */	    NODEV,
    /* 79 */	    NODEV,
    /* 80 */	    NODEV,
    /* 81 */	    NODEV,
    /* 82 */	    NODEV,
    /* 83 */	    NODEV,
    /* 84 */	    NODEV,
    /* 85 */	    NODEV,
    /* 86 */	    NODEV,
    /* 87 */	    NODEV,
    /* 88 */	    NODEV,
    /* 89 */	    NODEV,
    /* 90 */	    NODEV,
    /* 91 */	    NODEV,
    /* 92 */	    92,
    /* 93 */	    NODEV,
    /* 94 */	    NODEV,
    /* 95 */	    NODEV,
    /* 96 */	    NODEV,
    /* 97 */	    NODEV,
@


1.6
log
@bio for all archs, ok krw@@ kettenis@@ sounds good marco@@ go for it deraadt@@
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.5 2007/05/27 01:50:36 todd Exp $	*/
d305 1
a305 1
	cdev_bpftun_init(NBPFILTER,bpf),	/* 22: Berkeley packet filter */
d316 1
a316 1
	cdev_bpftun_init(NTUN,tun),		/* 33: network tunnel */
@


1.5
log
@back out bio, breaks dlg's sparc64 v215
prompted by/ok dlg@@ deraadt@@
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.4 2007/05/26 19:54:24 todd Exp $	*/
d73 1
d321 1
a321 1
	cdev_notdef(),				/* 38: removed cpu device */
@


1.4
log
@prodded by marco, enable bio everywhere
grudgingly ok deraadt@@
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.3 2006/11/03 20:21:23 mickey Exp $	*/
a72 1
#include "bio.h"
d320 1
a320 1
	cdev_bio_init(NBIO,bio),		/* 38: removed cpu device */
@


1.3
log
@cleanup some devices
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.2 2006/11/03 19:54:02 mickey Exp $	*/
d73 1
d321 1
a321 1
	cdev_notdef(),				/* 38: removed cpu device */
@


1.2
log
@need an entry for scif
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.1 2006/10/06 21:48:50 mickey Exp $	*/
a154 6
#ifdef CONF_HAVE_FCOM
#include "fcom.h"
#else
#define NFCOM	0
#endif

d291 1
a291 1
	cdev_lpt_init(NLPT,lpt),		/*  9: parallel printer */
d340 1
a340 1
	cdev_tty_init(NFCOM,fcom),		/* 54: FOOTBRIDGE console */
@


1.1
log
@w/ help of netbsd srcs and some mother unzel made it lift off
@
text
@d1 1
a1 1
/*	$OpenBSD$	*/
d279 1
d299 1
a299 1
	cdev_lkm_dummy(),			/* 11: */
@

