head	1.54;
access;
symbols
	OPENBSD_6_2_BASE:1.54
	OPENBSD_6_1:1.54.0.6
	OPENBSD_6_1_BASE:1.54
	OPENBSD_6_0:1.54.0.2
	OPENBSD_6_0_BASE:1.54
	OPENBSD_5_9:1.53.0.2
	OPENBSD_5_9_BASE:1.53
	OPENBSD_5_8:1.52.0.4
	OPENBSD_5_8_BASE:1.52
	OPENBSD_5_7:1.50.0.2
	OPENBSD_5_7_BASE:1.50
	OPENBSD_5_6:1.48.0.8
	OPENBSD_5_6_BASE:1.48
	OPENBSD_5_5:1.48.0.6
	OPENBSD_5_5_BASE:1.48
	OPENBSD_5_4:1.48.0.2
	OPENBSD_5_4_BASE:1.48
	OPENBSD_5_3:1.47.0.14
	OPENBSD_5_3_BASE:1.47
	OPENBSD_5_2:1.47.0.12
	OPENBSD_5_2_BASE:1.47
	OPENBSD_5_1_BASE:1.47
	OPENBSD_5_1:1.47.0.10
	OPENBSD_5_0:1.47.0.8
	OPENBSD_5_0_BASE:1.47
	OPENBSD_4_9:1.47.0.6
	OPENBSD_4_9_BASE:1.47
	OPENBSD_4_8:1.47.0.4
	OPENBSD_4_8_BASE:1.47
	OPENBSD_4_7:1.47.0.2
	OPENBSD_4_7_BASE:1.47
	OPENBSD_4_6:1.46.0.8
	OPENBSD_4_6_BASE:1.46
	OPENBSD_4_5:1.46.0.4
	OPENBSD_4_5_BASE:1.46
	OPENBSD_4_4:1.46.0.2
	OPENBSD_4_4_BASE:1.46
	OPENBSD_4_3:1.45.0.2
	OPENBSD_4_3_BASE:1.45
	OPENBSD_4_2:1.42.0.2
	OPENBSD_4_2_BASE:1.42
	OPENBSD_4_1:1.41.0.6
	OPENBSD_4_1_BASE:1.41
	OPENBSD_4_0:1.41.0.4
	OPENBSD_4_0_BASE:1.41
	OPENBSD_3_9:1.41.0.2
	OPENBSD_3_9_BASE:1.41
	OPENBSD_3_8:1.40.0.2
	OPENBSD_3_8_BASE:1.40
	OPENBSD_3_7:1.38.0.2
	OPENBSD_3_7_BASE:1.38
	OPENBSD_3_6:1.37.0.8
	OPENBSD_3_6_BASE:1.37
	SMP_SYNC_A:1.37
	SMP_SYNC_B:1.37
	OPENBSD_3_5:1.37.0.6
	OPENBSD_3_5_BASE:1.37
	OPENBSD_3_4:1.37.0.4
	OPENBSD_3_4_BASE:1.37
	UBC_SYNC_A:1.37
	OPENBSD_3_3:1.37.0.2
	OPENBSD_3_3_BASE:1.37
	OPENBSD_3_2:1.36.0.2
	OPENBSD_3_2_BASE:1.36
	OPENBSD_3_1:1.35.0.2
	OPENBSD_3_1_BASE:1.35
	UBC_SYNC_B:1.36
	UBC:1.34.0.4
	UBC_BASE:1.34
	OPENBSD_3_0:1.34.0.2
	OPENBSD_3_0_BASE:1.34
	OPENBSD_2_9:1.25.0.2
	OPENBSD_2_9_BASE:1.25
	OPENBSD_2_8:1.22.0.2
	OPENBSD_2_8_BASE:1.22
	OPENBSD_2_7:1.19.0.2
	OPENBSD_2_7_BASE:1.19
	SMP:1.15.0.2
	SMP_BASE:1.15
	kame_19991208:1.15
	OPENBSD_2_6:1.11.0.2
	OPENBSD_2_6_BASE:1.11
	OPENBSD_2_5:1.10.0.2
	OPENBSD_2_5_BASE:1.10
	OPENBSD_2_4:1.9.0.2
	OPENBSD_2_4_BASE:1.9
	OPENBSD_2_3:1.5.0.2
	OPENBSD_2_3_BASE:1.5
	OPENBSD_2_2:1.4.0.2
	OPENBSD_2_2_BASE:1.4
	OPENBSD_2_1:1.3.0.2
	OPENBSD_2_1_BASE:1.3
	powerpc_1:1.1.1.1;
locks; strict;
comment	@# @;


1.54
date	2016.03.05.17.41.55;	author mpi;	state Exp;
branches;
next	1.53;
commitid	5025CzLISD0jU2OS;

1.53
date	2015.08.14.06.14.19;	author dlg;	state Exp;
branches;
next	1.52;
commitid	fjF8E1NC4JOIKQOD;

1.52
date	2015.07.17.22.52.29;	author tedu;	state Exp;
branches;
next	1.51;
commitid	OOrGfFHYAn65M2qc;

1.51
date	2015.06.26.11.15.32;	author dlg;	state Exp;
branches;
next	1.50;
commitid	mhhlde0dPvyGCPxF;

1.50
date	2015.01.20.18.34.00;	author mpi;	state Exp;
branches;
next	1.49;
commitid	EdxyRml3kMx5DGKk;

1.49
date	2015.01.20.17.08.35;	author mpi;	state Exp;
branches;
next	1.48;
commitid	9SVbxff6jAFsGD1m;

1.48
date	2013.06.13.04.34.32;	author deraadt;	state Exp;
branches;
next	1.47;

1.47
date	2009.10.01.20.19.19;	author kettenis;	state Exp;
branches;
next	1.46;

1.46
date	2008.04.25.14.51.35;	author jmc;	state Exp;
branches;
next	1.45;

1.45
date	2007.11.25.18.25.29;	author deraadt;	state Exp;
branches;
next	1.44;

1.44
date	2007.11.14.20.33.32;	author thib;	state Exp;
branches;
next	1.43;

1.43
date	2007.10.10.15.53.52;	author art;	state Exp;
branches;
next	1.42;

1.42
date	2007.03.22.19.26.27;	author kettenis;	state Exp;
branches;
next	1.41;

1.41
date	2005.11.08.20.30.47;	author kettenis;	state Exp;
branches;
next	1.40;

1.40
date	2005.05.02.02.39.45;	author brad;	state Exp;
branches;
next	1.39;

1.39
date	2005.05.01.21.36.57;	author brad;	state Exp;
branches;
next	1.38;

1.38
date	2005.03.08.20.00.23;	author tdeval;	state Exp;
branches;
next	1.37;

1.37
date	2003.01.09.22.27.10;	author miod;	state Exp;
branches;
next	1.36;

1.36
date	2002.06.08.16.02.14;	author miod;	state Exp;
branches;
next	1.35;

1.35
date	2002.03.13.18.27.36;	author drahn;	state Exp;
branches;
next	1.34;

1.34
date	2001.09.01.15.59.31;	author drahn;	state Exp;
branches
	1.34.4.1;
next	1.33;

1.33
date	2001.07.04.08.38.48;	author niklas;	state Exp;
branches;
next	1.32;

1.32
date	2001.06.26.21.26.44;	author drahn;	state Exp;
branches;
next	1.31;

1.31
date	2001.06.26.02.33.39;	author mickey;	state Exp;
branches;
next	1.30;

1.30
date	2001.06.25.19.15.43;	author deraadt;	state Exp;
branches;
next	1.29;

1.29
date	2001.06.25.18.14.12;	author drahn;	state Exp;
branches;
next	1.28;

1.28
date	2001.05.29.01.20.43;	author drahn;	state Exp;
branches;
next	1.27;

1.27
date	2001.05.11.07.13.16;	author deraadt;	state Exp;
branches;
next	1.26;

1.26
date	2001.05.11.06.41.47;	author deraadt;	state Exp;
branches;
next	1.25;

1.25
date	2001.03.29.19.36.55;	author drahn;	state Exp;
branches;
next	1.24;

1.24
date	2001.03.01.23.19.33;	author drahn;	state Exp;
branches;
next	1.23;

1.23
date	2001.01.30.03.05.12;	author drahn;	state Exp;
branches;
next	1.22;

1.22
date	2000.10.16.00.18.01;	author drahn;	state Exp;
branches;
next	1.21;

1.21
date	2000.09.06.02.34.31;	author rahnds;	state Exp;
branches;
next	1.20;

1.20
date	2000.07.07.13.34.29;	author rahnds;	state Exp;
branches;
next	1.19;

1.19
date	2000.03.31.04.44.39;	author rahnds;	state Exp;
branches;
next	1.18;

1.18
date	2000.03.25.15.26.27;	author rahnds;	state Exp;
branches;
next	1.17;

1.17
date	2000.03.23.04.08.42;	author rahnds;	state Exp;
branches;
next	1.16;

1.16
date	2000.03.20.07.15.00;	author rahnds;	state Exp;
branches;
next	1.15;

1.15
date	99.11.25.05.55.26;	author rahnds;	state Exp;
branches
	1.15.2.1;
next	1.14;

1.14
date	99.11.25.05.50.59;	author rahnds;	state Exp;
branches;
next	1.13;

1.13
date	99.11.08.23.53.56;	author rahnds;	state Exp;
branches;
next	1.12;

1.12
date	99.11.08.15.36.10;	author mickey;	state Exp;
branches;
next	1.11;

1.11
date	99.07.30.19.41.43;	author deraadt;	state Exp;
branches;
next	1.10;

1.10
date	99.01.23.19.41.31;	author rahnds;	state Exp;
branches;
next	1.9;

1.9
date	98.09.27.03.55.59;	author rahnds;	state Exp;
branches;
next	1.8;

1.8
date	98.09.09.04.29.27;	author rahnds;	state Exp;
branches;
next	1.7;

1.7
date	98.08.22.18.31.36;	author rahnds;	state Exp;
branches;
next	1.6;

1.6
date	98.05.29.04.15.30;	author rahnds;	state Exp;
branches;
next	1.5;

1.5
date	98.04.06.17.29.26;	author pefo;	state Exp;
branches;
next	1.4;

1.4
date	97.10.13.09.39.34;	author pefo;	state Exp;
branches;
next	1.3;

1.3
date	97.02.06.04.36.40;	author rahnds;	state Exp;
branches;
next	1.2;

1.2
date	96.12.28.06.09.10;	author rahnds;	state Exp;
branches;
next	1.1;

1.1
date	96.12.21.20.35.52;	author rahnds;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	96.12.21.20.35.52;	author rahnds;	state Exp;
branches;
next	;

1.15.2.1
date	2000.03.24.09.08.37;	author niklas;	state Exp;
branches;
next	1.15.2.2;

1.15.2.2
date	2001.04.18.16.12.57;	author niklas;	state Exp;
branches;
next	1.15.2.3;

1.15.2.3
date	2001.07.04.10.22.16;	author niklas;	state Exp;
branches;
next	1.15.2.4;

1.15.2.4
date	2001.10.31.03.07.54;	author nate;	state Exp;
branches;
next	1.15.2.5;

1.15.2.5
date	2001.11.13.22.14.34;	author niklas;	state dead;
branches;
next	1.15.2.6;

1.15.2.6
date	2002.03.29.08.09.54;	author niklas;	state Exp;
branches;
next	1.15.2.7;

1.15.2.7
date	2003.03.27.23.42.34;	author niklas;	state Exp;
branches;
next	;

1.34.4.1
date	2002.06.11.03.37.28;	author art;	state Exp;
branches;
next	1.34.4.2;

1.34.4.2
date	2003.05.19.21.49.44;	author tedu;	state Exp;
branches;
next	;


desc
@@


1.54
log
@One ddb interface is enough for ppc.
@
text
@#	$OpenBSD: files.powerpc,v 1.53 2015/08/14 06:14:19 dlg Exp $
#

file	arch/powerpc/powerpc/setjmp.S			ddb
file	arch/powerpc/powerpc/copystr.c
file	arch/powerpc/powerpc/cpu_subr.c
file	arch/powerpc/powerpc/fpu.c
file	arch/powerpc/powerpc/in_cksum.c
file	arch/powerpc/powerpc/bus_dma.c
file	arch/powerpc/powerpc/bus_space.c
file	arch/powerpc/powerpc/pmap.c
file	arch/powerpc/powerpc/process_machdep.c
file	arch/powerpc/powerpc/sys_machdep.c
file	arch/powerpc/powerpc/trap.c
file	arch/powerpc/powerpc/vm_machdep.c
file	arch/powerpc/powerpc/mutex.c
file	arch/powerpc/powerpc/lock_machdep.c		multiprocessor
file	arch/powerpc/powerpc/intr.c
file	arch/powerpc/powerpc/softintr.c

file	arch/powerpc/ddb/db_memrw.c			ddb
file	arch/powerpc/ddb/db_disasm.c			ddb
file	arch/powerpc/ddb/db_trace.c			ddb
file	arch/powerpc/ddb/db_interface.c			ddb

# quad support is necessary for 32 bit architectures
file	lib/libkern/adddi3.c
file	lib/libkern/anddi3.c
file	lib/libkern/ashldi3.c
file	lib/libkern/ashrdi3.c
file	lib/libkern/cmpdi2.c
file	lib/libkern/divdi3.c
file	lib/libkern/iordi3.c
file	lib/libkern/lshldi3.c
file	lib/libkern/lshrdi3.c
file	lib/libkern/moddi3.c
file	lib/libkern/muldi3.c
file	lib/libkern/negdi2.c
file	lib/libkern/notdi2.c
file	lib/libkern/qdivrem.c
file	lib/libkern/subdi3.c
file	lib/libkern/ucmpdi2.c
file	lib/libkern/udivdi3.c
file	lib/libkern/umoddi3.c
file	lib/libkern/xordi3.c
@


1.53
log
@replace the asm mutexes with a c implementation.

there's no real functional advantage to this, except that it will
make it easier to add deadlock detection to the code.

this is modelled on the c mutex implementation thats on alpha,
mips64, and hppa.

ok mpi@@ kettenis@@
@
text
@d1 1
a1 1
#	$OpenBSD: files.powerpc,v 1.52 2015/07/17 22:52:29 tedu Exp $
d24 1
@


1.52
log
@remove obsolete INET kernel option
@
text
@d1 1
a1 1
#	$OpenBSD: files.powerpc,v 1.51 2015/06/26 11:15:32 dlg Exp $
d16 1
a17 1
file	arch/powerpc/powerpc/mutex.S
@


1.51
log
@move the ppc mplock implementation from macppc to powerpc.

ok mpi@@
@
text
@d1 1
a1 1
#	$OpenBSD: files.powerpc,v 1.50 2015/01/20 18:34:00 mpi Exp $
d8 1
a8 1
file	arch/powerpc/powerpc/in_cksum.c			inet
@


1.50
log
@Merge two copies of the (almost) identical bus space code into one file.

This brings bus_space_mmap(9) to socppc and change its bus_space_map(9)
implementation to use kernel_map instead of phys_map like macppc and
everybody else.
@
text
@d1 1
a1 1
#	$OpenBSD: files.powerpc,v 1.49 2015/01/20 17:08:35 mpi Exp $
d16 1
@


1.49
log
@Merge two copies of the same dma code into one file and sync the headers.

ok kettenis@@
@
text
@d1 1
a1 1
#	$OpenBSD: files.powerpc,v 1.48 2013/06/13 04:34:32 deraadt Exp $
d10 1
@


1.48
log
@don't use a ridiculous private copy of bcopy which is just like libc.
At least try to do a better job in libkern (not yet, but one day soon)
@
text
@d1 1
a1 1
#	$OpenBSD: files.powerpc,v 1.47 2009/10/01 20:19:19 kettenis Exp $
d9 1
@


1.47
log
@Generic soft interrupts for macppc.  Tested by mk@@, deraadt@@
ok miod@@
@
text
@d1 1
a1 1
#	$OpenBSD: files.powerpc,v 1.46 2008/04/25 14:51:35 jmc Exp $
a4 1
file	arch/powerpc/powerpc/bcopy.c
@


1.46
log
@neccessary -> necessary; from Pierre Riteau
@
text
@d1 1
a1 1
#	$OpenBSD: files.powerpc,v 1.45 2007/11/25 18:25:29 deraadt Exp $
d17 1
@


1.45
log
@libkern, begone.  Move to a new mechanism where config(8)'s "file"
directive can select between MI and MD versions of these files.  At
the same time, adjust the boot programs to pick exactly what they need,
instead of the 7 or 8 mechanisms previously used.

There will be some fallout from this, but testing it all by myself is a
ridiculously slow process; it will be finished in-tree.

Various developers were very nice and avoided making fun of me when I
was gibbering in the corner..
@
text
@d1 1
a1 1
#	$OpenBSD: files.powerpc,v 1.44 2007/11/14 20:33:32 thib Exp $
d22 1
a22 1
# quad support is neccessary for 32 bit architectures
@


1.44
log
@Turn the spl* macros into functions.
Shaves a few bytes of the kernel.
No measurable performance loss.

ok drahn@@, kettenis@@
@
text
@d1 1
a1 1
#	$OpenBSD: files.powerpc,v 1.43 2007/10/10 15:53:52 art Exp $
d21 21
@


1.43
log
@Make context switching much more MI:
 - Move the functionality of choosing a process from cpu_switch into
   a much simpler function: cpu_switchto. Instead of having the locore
   code walk the run queues, let the MI code choose the process we
   want to run and only implement the context switching itself in MD
   code.
 - Let MD context switching run without worrying about spls or locks.
 - Instead of having the idle loop implemented with special contexts
   in MD code, implement one idle proc for each cpu. make the idle
   loop MI with MD hooks.
 - Change the proc lists from the old style vax queues to TAILQs.
 - Change the sleep queue from vax queues to TAILQs. This makes
   wakeup() go from O(n^2) to O(n)

there will be some MD fallout, but it will be fixed shortly.
There's also a few cleanups to be done after this.

deraadt@@, kettenis@@ ok
@
text
@d1 1
a1 1
#	$OpenBSD: files.powerpc,v 1.42 2007/03/22 19:26:27 kettenis Exp $
d16 1
@


1.42
log
@Move powerpc to __HAVE_MUTEX.  With help from drahn@@.  Tested by nick@@, xsa@@,
deraadt@@.

"reads right" deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: files.powerpc,v 1.41 2005/11/08 20:30:47 kettenis Exp $
a4 1
file	arch/powerpc/powerpc/Locore.c
@


1.41
log
@Add support for 64-bit SPRs.
ok drahn@@
@
text
@d1 1
a1 1
#	$OpenBSD: files.powerpc,v 1.40 2005/05/02 02:39:45 brad Exp $
d16 1
@


1.40
log
@New in{,4}_cksum that is between 1.5 and 5 times faster than the
old version depending on CPU type.

From NetBSD

ok drahn@@
@
text
@d1 1
a1 1
#	$OpenBSD: files.powerpc,v 1.39 2005/05/01 21:36:57 brad Exp $
d8 1
@


1.39
log
@To allow for MD override of in4_cksum()...

ok deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: files.powerpc,v 1.38 2005/03/08 20:00:23 tdeval Exp $
a9 1
file	netinet/in4_cksum.c				inet
@


1.38
log
@Cosmetics...
Mainly remove space between locators parens, replace spaces with tabs
where appropriate and consistently align dependencies.
@
text
@d1 1
a1 1
#	$OpenBSD: files.powerpc,v 1.37 2003/01/09 22:27:10 miod Exp $
d9 2
a10 1
file	arch/powerpc/powerpc/in_cksum.c
@


1.37
log
@Remove fetch(9) and store(9) functions from the kernel, and replace the few
remaining instances of them with appropriate copy(9) usage.

ok art@@, tested on all arches unless my memory is non-ECC
@
text
@d1 1
a1 1
#	$OpenBSD: files.powerpc,v 1.36 2002/06/08 16:02:14 miod Exp $
d4 1
a4 1
file    arch/powerpc/powerpc/setjmp.S			ddb
@


1.36
log
@One ddb to rule them all.

Move the ddb files form macppc/macppc to powerpc/ddb, so that mvmeppc
can benefit from the better ddb that was in macppc.
db_interface.c is left as an md part.
@
text
@d1 1
a1 1
#	$OpenBSD: files.powerpc,v 1.35 2002/03/13 18:27:36 drahn Exp $
a8 2
file	arch/powerpc/powerpc/fubyte.c
file	arch/powerpc/powerpc/fuswintr.c
a11 3
file	arch/powerpc/powerpc/subyte.c
file	arch/powerpc/powerpc/suword.c
file	arch/powerpc/powerpc/suswintr.c
@


1.35
log
@Complete rewrite of the powerpc pmap handling, Instead of keeping
the spill list for each PTEG, the V->P translations are stored in
trees for each pmap. All valid kernel mappings are preallocated
in 1-1 memory so that tlb spill/loads for kernel accesses can be
looked up while physical, user mappings are not guaranteed to
be 1-1 mapped, thus the kernel must go virtual to look up user
mappings. While this is more expensive, the tree search is much
lower cost than the long linked list search. Also on each pmap_remove()
it was necessary to search the linked lists for each possible mapping,
now it just looks up the entry in the tree.
This change gives a 25-36% speedup in 'make build' time. What was
around 2:50 is now around 1:55 on a 733MHz G4.

This change causes a likely existing bug to appear quite often,
it deals with the segment register invalidation in kernel mode.
Because of that problem, currently this change limits the physical
memory used to 256MB. This limitation will be fixed soon, it is not
an error in the pmap code.

 * Effort sponsored in part by the Defense Advanced Research Projects
 * Agency (DARPA) and Air Force Research Laboratory, Air Force
 * Materiel Command, USAF, under agreement number F30602-01-2-0537.
@
text
@d1 1
a1 1
#	$OpenBSD: files.powerpc,v 1.34 2001/09/01 15:59:31 drahn Exp $
d20 4
@


1.34
log
@The "powerpc" port which has supported the newer Apple Macintosh powerpc based
is being renamed to macppc. This is to allow sharing of common code
between different powerpc base platforms.

Most of the work involved in the renaming process was performed by miod@@

Files moved from powerpc/conf to macppc/conf

files.powerpc was modified to keep powerpc common files.
@
text
@d1 1
a1 1
#	$OpenBSD$
a6 2
file	arch/powerpc/powerpc/copyinstr.c
file	arch/powerpc/powerpc/copyoutstr.c
@


1.34.4.1
log
@Sync UBC branch to -current
@
text
@d1 1
a1 1
#	$OpenBSD: files.powerpc,v 1.34 2001/09/01 15:59:31 drahn Exp $
d7 2
a21 4

file	arch/powerpc/ddb/db_memrw.c			ddb
file	arch/powerpc/ddb/db_disasm.c			ddb
file	arch/powerpc/ddb/db_trace.c			ddb
@


1.34.4.2
log
@sync
@
text
@d1 1
a1 1
#	$OpenBSD$
d9 2
d14 3
@


1.33
log
@$OpenBSD$
@
text
@a1 3

#
# powerpc-specific configuration info
a2 3
maxpartitions 16

maxusers 2 8 64
d4 1
a5 1
file	arch/powerpc/powerpc/autoconf.c
a6 2
file	arch/powerpc/powerpc/clock.c
file	arch/powerpc/powerpc/conf.c
a9 1
file	arch/powerpc/powerpc/disksubr.c			disk
a13 7
file	arch/powerpc/powerpc/ipkdb_glue.c		ipkdb
file	arch/powerpc/powerpc/machdep.c
file	arch/powerpc/powerpc/wscons_machdep.c
file	arch/powerpc/powerpc/mem.c
file	arch/powerpc/powerpc/dma.c
file	arch/powerpc/powerpc/ofw_machdep.c
file	arch/powerpc/powerpc/openfirm.c
a21 222
file	dev/cons.c
file	dev/cninit.c
file	arch/powerpc/powerpc/setjmp.S			ddb
file	arch/powerpc/powerpc/db_memrw.c			ddb
file	arch/powerpc/powerpc/db_disasm.c		ddb
file	arch/powerpc/powerpc/db_interface.c		ddb
file	arch/powerpc/powerpc/db_trace.c			ddb
file	arch/powerpc/powerpc/ofwreal.S

#
# Media Indepedent Interface (mii)
#
include "../../../dev/mii/files.mii"

#
# MAC generic
#
file	arch/powerpc/mac/dbdma.c

#
# Openfirmware support
#

define	mainbus {}
device	mainbus
attach	mainbus at root
file	arch/powerpc/powerpc/mainbus.c			mainbus

device	cpu
attach	cpu at mainbus
file	arch/powerpc/powerpc/cpu.c

include "../../../dev/ofw/files.ofw"
file	arch/powerpc/powerpc/opendev.c
major	{ ofdisk = 4 }


device	memc {}
attach	memc at mainbus
file	arch/powerpc/mac/uni_n.c			memc

major	{rd = 17}
major	{sd = 2}
major	{cd = 3}

include "../../../scsi/files.scsi"

#
# I2O
#
include "../../../dev/i2o/files.i2o"

include "dev/pci/files.pci"
file	arch/powerpc/pci/pciide_machdep.c	pciide

device	mpcpcibr {} : pcibus
attach	mpcpcibr at mainbus
file	arch/powerpc/pci/mpcpcibus.c			mpcpcibr
#file	arch/powerpc/pci/pci_addr_fixup.c		mpcpcibr

#
# "workstation console" routines
#

include "dev/wscons/files.wscons"


#device	ofb: wsemuldisplaydev, wsrasteremulops
device	ofb
attach	ofb at pci
file	arch/powerpc/mac/ofb.c				ofb needs-flag


#
# mac peripheral pieces.
#

#file	arch/powerpc/pci/bandit.c			pci

#PCI-Host bridge chipsets
device	pchb
attach	pchb at pci
file	arch/powerpc/pci/pchb.c				pchb


#
# Machine-independent ATAPI drivers
#

include "../../../dev/atapiscsi/files.atapiscsi"
include "../../../dev/ata/files.ata"

# MAC periph

device	macobio {}
attach	macobio at pci
file	arch/powerpc/pci/macobio.c			macobio

#device	esp: scsi, ncr53c9x
#attach	esp at macobio
#file	arch/powerpc/mac/esp.c				esp

device	mesh: scsi
attach	mesh at macobio
file	arch/powerpc/mac/mesh.c				mesh

device	mc: ifnet, ether
attach	mc at macobio
file	arch/powerpc/mac/if_mc.c			mc
file	arch/powerpc/mac/am79c950.c			mc

device	bm: ether, ifnet, ifmedia
attach	bm at macobio
file	arch/powerpc/mac/if_bm.c			bm

device	gm: ether, ifnet, ifmedia, mii
attach	gm at pci
file	arch/powerpc/mac/if_gm.c			gm needs-flag

device	macintr {}
attach	macintr at macobio
file	arch/powerpc/mac/macintr.c			macintr

device	openpic {}
attach	openpic at macobio
file	arch/powerpc/mac/openpic.c			openpic

device	zsc {channel = -1}
attach	zsc at macobio
file	arch/powerpc/mac/zs.c				zsc needs-flag
file	dev/ic/z8530sc.c				zsc

device	zstty: tty
attach	zstty at zsc
file	dev/ic/z8530tty.c				zstty needs-flag

device	adb {}
attach	adb at macobio
file	arch/powerpc/mac/adb.c				adb needs-flag
file	arch/powerpc/mac/adb_direct.c			adb
file	arch/powerpc/mac/pm_direct.c			adb

device	aed
attach	aed at adb
file	arch/powerpc/mac/aed.c				aed needs-flag

#??
#define wskbddev {[console = -1]}
#define wsmousedev {}
#??

device	akbd: wskbddev
attach	akbd at adb
file	arch/powerpc/mac/akbd.c				akbd needs-flag

device	ams: wsmousedev
attach	ams at adb
file	arch/powerpc/mac/ams.c				ams

device	abtn
attach	abtn at adb
file	arch/powerpc/mac/abtn.c				abtn

device	awacs: audio, auconv, mulaw
attach	awacs at macobio
file	arch/powerpc/mac/awacs.c			awacs

device	nvram
attach	nvram at macobio
file	arch/powerpc/mac/nvram.c			nvram needs-flag

device	gpio {}
attach	gpio at macobio with gpio_obio
attach	gpio at gpio with gpio_gpio
file	arch/powerpc/mac/gpio.c				gpio

attach	wdc at macobio with wdc_obio
file	arch/powerpc/mac/wdc_obio.c			wdc_obio

attach	wi at macobio with wi_obio
file	arch/powerpc/mac/if_wi_obio.c			wi_obio

define	grfdev {}

device	grfati: grfdev
attach	grfati at pci
file	arch/powerpc/mac/grf_ati.c			grfati needs-flag

device	grf {}
attach	grf at grfdev
file	arch/powerpc/mac/grf.c				grf needs-flag
file	arch/powerpc/mac/grf_subr.c			grf

device	ite: tty
attach	ite at grf
file	arch/powerpc/mac/ite.c				ite needs-flag


# VGA framebuffer
device	vgafb: wsemuldisplaydev, wsrasteremulops
file	arch/powerpc/pci/vgafb.c			vgafb & vgafb_pci

# Generic VGA Framebuffer version
attach	vgafb at pci with vgafb_pci
file	arch/powerpc/pci/vgafb_pci.c			vgafb_pci needs-flag


#
# CARDBUS
#
include	"dev/cardbus/files.cardbus"
#file	arch/powerpc/powerpc/rbus_machdep.c		cardbus

#
# Machine-independent PCMCIA drivers
#
include "dev/pcmcia/files.pcmcia"

#
# Machine-independent USB drivers
#
include "dev/usb/files.usb"
@


1.32
log
@Add pciide support for powerpc.
Yes Theo, you found my bug, but the tree broke
because you referenced devices that were not enabled, yet.
@
text
@d1 2
@


1.31
log
@accomodate for i2o addition
@
text
@d89 1
@


1.30
log
@obio -> macobio, and cleanups
@
text
@a72 7
include "dev/pci/files.pci"

device	mpcpcibr {} : pcibus
attach	mpcpcibr at mainbus
file	arch/powerpc/pci/mpcpcibus.c			mpcpcibr
#file	arch/powerpc/pci/pci_addr_fixup.c		mpcpcibr

d82 12
@


1.29
log
@Add support for airport cards on powerpc.
Only tested on Ti, but may/should work on
other systems.
@
text
@d16 1
a16 1
file	arch/powerpc/powerpc/disksubr.c		disk
d21 1
a21 1
file	arch/powerpc/powerpc/ipkdb_glue.c	ipkdb
d38 6
a43 7
file    arch/powerpc/powerpc/setjmp.S                   ddb
file    arch/powerpc/powerpc/db_memrw.c                 ddb
file    arch/powerpc/powerpc/db_disasm.c                ddb
file    arch/powerpc/powerpc/db_interface.c             ddb
file    arch/powerpc/powerpc/db_trace.c                 ddb

file    arch/powerpc/powerpc/ofwreal.S
d62 1
a62 1
file	arch/powerpc/powerpc/mainbus.c	mainbus
d69 1
a69 1
file	arch/powerpc/powerpc/opendev.c 
d77 2
a78 2
file	arch/powerpc/pci/mpcpcibus.c		mpcpcibr
#file	arch/powerpc/pci/pci_addr_fixup.c	mpcpcibr
d82 1
a82 1
file	arch/powerpc/mac/uni_n.c	memc
d84 2
a85 2
major   {rd = 17}
major	{sd = 2}		# hey this was 0 but at slot 2 in bdevsw XXX
d97 4
a100 4
#device ofb: wsemuldisplaydev, wsrasteremulops
device ofb
attach ofb at pci
file arch/powerpc/mac/ofb.c				ofb needs-flag
d107 1
a107 3
#file arch/powerpc/pci/bandit.c			pci

# PCI bus support
d110 3
a112 3
device pchb
attach pchb at pci
file arch/powerpc/pci/pchb.c			pchb
d122 1
a122 1
# MAC periph 
d124 51
a174 51
device obio {}
attach obio at pci
file arch/powerpc/pci/macobio.c			obio

#device esp: scsi, ncr53c9x
#attach esp at obio
#file arch/powerpc/mac/esp.c			esp

device mesh: scsi
attach mesh at obio
file arch/powerpc/mac/mesh.c			mesh

device mc: ifnet, ether
attach mc at obio
file arch/powerpc/mac/if_mc.c			mc
file arch/powerpc/mac/am79c950.c		mc

device bm: ether, ifnet, ifmedia
attach bm at obio
file arch/powerpc/mac/if_bm.c			bm

device gm: ether, ifnet, ifmedia, mii
attach gm at pci
file arch/powerpc/mac/if_gm.c			gm needs-flag

device macintr {}
attach macintr at obio
file	arch/powerpc/mac/macintr.c		macintr

device openpic {}
attach openpic at obio
file	arch/powerpc/mac/openpic.c		openpic

device zsc {channel = -1}
attach zsc at obio
file arch/powerpc/mac/zs.c			zsc needs-flag
file dev/ic/z8530sc.c				zsc

device zstty: tty
attach zstty at zsc
file dev/ic/z8530tty.c                 zstty needs-flag

device adb {}
attach adb at obio
file arch/powerpc/mac/adb.c                      adb needs-flag
file arch/powerpc/mac/adb_direct.c               adb
file arch/powerpc/mac/pm_direct.c                adb

device aed
attach aed at adb
file arch/powerpc/mac/aed.c                      aed needs-flag
d177 1
a177 1
#define wskbddev	{[console = -1]}
d181 45
a225 45
device akbd: wskbddev
attach akbd at adb
file arch/powerpc/mac/akbd.c                     akbd needs-flag

device ams: wsmousedev
attach ams at adb
file arch/powerpc/mac/ams.c                      ams

device abtn
attach abtn at adb
file arch/powerpc/mac/abtn.c			abtn

device awacs: audio, auconv, mulaw
attach awacs at obio
file arch/powerpc/mac/awacs.c			awacs

device nvram
attach nvram at obio
file arch/powerpc/mac/nvram.c			nvram needs-flag

device gpio {}
attach gpio at obio with gpio_obio
attach gpio at gpio with gpio_gpio
file arch/powerpc/mac/gpio.c			gpio

attach wdc at obio with wdc_obio
file arch/powerpc/mac/wdc_obio.c		wdc_obio

attach wi at obio with wi_obio
file	arch/powerpc/mac/if_wi_obio.c		wi_obio

define grfdev {}

device grfati: grfdev
attach grfati at pci
file arch/powerpc/mac/grf_ati.c                  grfati needs-flag

device grf {}
attach grf at grfdev
file arch/powerpc/mac/grf.c                      grf needs-flag
file arch/powerpc/mac/grf_subr.c                 grf

device ite: tty
attach ite at grf
file arch/powerpc/mac/ite.c                      ite needs-flag
d229 2
a230 2
device        vgafb: wsemuldisplaydev, wsrasteremulops
file  arch/powerpc/pci/vgafb.c          	vgafb & vgafb_pci
d233 2
a234 2
attach  vgafb at pci with vgafb_pci
file    arch/powerpc/pci/vgafb_pci.c             vgafb_pci       needs-flag
d241 1
a241 1
#file	arch/powerpc/powerpc/rbus_machdep.c	cardbus
@


1.28
log
@Hardware clock support, via adb.
This reduces the dependancy on openfirmware somewhat.
Since Openfirmware is not actually used for anything,
it is no longer necessary to configure it. so several lines of
useless dmesg are now gone.

This does not have clock setting code enabled yet.
All of the code is in place, but needs further testing before
it is trusted.

I wish Apple would store UTC not localtime in the hardware clock,
besides the fact that the clock base is 1904.

Need to keep the clock sane for dual boot machines.
@
text
@d212 3
@


1.27
log
@unify rd(4) even more
@
text
@d70 1
a70 1
file	arch/powerpc/powerpc/opendev.c ofcons | ofnet | ofdisk | ofrtc
a72 1
file	arch/powerpc/mac/uni_n.c ofbus
d80 4
@


1.26
log
@unify
@
text
@a74 3
file	dev/rd.c				ramdisk_hooks
major   {rd = 17}

d82 1
a82 1

d85 1
@


1.25
log
@Add support for new gpio, abtn, and awacs devices.
Some cleanup, hints at future direction.
@
text
@d75 1
a75 1
file	arch/powerpc/powerpc/rd_root.c			ramdisk_hooks
@


1.24
log
@Fix (or a least hack around) console configuration changes to wscons.
Needs to be looked at closer, but seems to work. Mostly copied from i386.
@
text
@d82 2
a83 1
file	arch/powerpc/pci/mpcpcibus.c	mpcpcibr
d191 8
d201 1
a201 1
file arch/powerpc/mac/nvram.c                    nvram needs-flag
d203 4
d209 1
a209 1
file arch/powerpc/mac/wdc_obio.c                 wdc_obio
d235 11
@


1.23
log
@Missed this file in adding ADB keyboard and mouse files for powerpc.
@
text
@d23 1
@


1.22
log
@configuration changes to enable the uni-north memory controller to enable
the ethernet pci bus. Allows the gm ethernet controller to configure.
@
text
@d181 3
a183 3
#device akbd: wskbddev
#attach akbd at adb
#file arch/powerpc/mac/akbd.c                     akbd needs-flag
d185 3
a187 3
#device ams: wsmousedev
#attach ams at adb
#file arch/powerpc/mac/ams.c                      ams
@


1.21
log
@Remove isa pieces, add vgafb as a powerpc specific device.
@
text
@d72 2
@


1.20
log
@esp files commented out for now, since the MI esp driver was added.
the mac esp driver was not yet ported, when that is done, this will
be readded appropriately.
@
text
@d81 1
a81 4
device	isabr {} : isabus
attach	isabr at mainbus, pci
file	arch/powerpc/isa/isabus.c	isabr
include "../../../scsi/files.scsi"
d84 1
a84 19

define	pcmcia {}			# XXX dummy decl...
include	"../../../dev/isa/files.isa"
#major	{ wd = 5 }		# Not even in bdevsw XXX

device	pckbc { } 
attach	pckbc at isa
file	arch/powerpc/isa/pcppi.c	pckbc

device	pckbd
attach	pckbd at pckbc
file	arch/powerpc/isa/pckbd.c	pckbd

device	pms
attach	pms at pckbc
file	arch/powerpc/isa/pms.c		pms

include "../../../dev/isa/files.isapnp"
file    arch/powerpc/isa/isapnp_machdep.c   isapnp   
d209 10
@


1.19
log
@Add pchb PCi Host Bridge dummy device to print devices nicely, instead of
"not configured"
@
text
@d147 3
a149 3
device esp: scsi, ncr53c9x
attach esp at obio
file arch/powerpc/mac/esp.c			esp
@


1.18
log
@if_gm attaches on pci, not macobio.
@
text
@d166 1
a166 1
file arch/powerpc/mac/if_gm.c			gm
@


1.17
log
@add mii and if_gm ethernet.
@
text
@d165 1
a165 1
attach gm at obio
@


1.16
log
@early support for busdma added, allows USBMAC config to attach ohci USB,
however, it claims "legacy support: unsupported" which then causes
the imac to not config USB further.

Changes to *MAC to support openpic interrupt controller, G4 (uninorth)
is almost supported, but hangs during root mount.
@
text
@d46 5
d163 4
@


1.15
log
@Properly fix the last checkin, the pseudo device rd is now a mi device and
is not to be specified in files.<arch> but if the arch has rd_attach_hook
and rd_open_hook, the file that these are in need to be included in
that files.<arch> file.
@
text
@d24 1
a48 2
define macintr
file	arch/powerpc/mac/macintr.c			macintr
d138 1
a138 1
device obio {} : macintr
d140 1
a140 1
file arch/powerpc/pci/macobio.c                     obio
d144 1
a144 1
file arch/powerpc/mac/esp.c                      esp
d148 1
a148 1
file arch/powerpc/mac/mesh.c                     mesh
d152 2
a153 2
file arch/powerpc/mac/if_mc.c                    mc
file arch/powerpc/mac/am79c950.c                 mc
d157 9
a165 1
file arch/powerpc/mac/if_bm.c                    bm
d169 2
a170 2
file arch/powerpc/mac/zs.c                       zsc needs-flag
file dev/ic/z8530sc.c                           zsc
d174 1
a174 1
file arch/powerpc/mac/z8530tty.c                 zstty needs-flag
@


1.15.2.1
log
@Sync with -current
@
text
@a23 1
file	arch/powerpc/powerpc/dma.c
a44 5
# Media Indepedent Interface (mii)
#
include "../../../dev/mii/files.mii"

#
d48 2
d139 1
a139 1
device obio {}
d141 1
a141 1
file arch/powerpc/pci/macobio.c			obio
d145 1
a145 1
file arch/powerpc/mac/esp.c			esp
d149 1
a149 1
file arch/powerpc/mac/mesh.c			mesh
d153 2
a154 2
file arch/powerpc/mac/if_mc.c			mc
file arch/powerpc/mac/am79c950.c		mc
d158 1
a158 13
file arch/powerpc/mac/if_bm.c			bm

device gm: ether, ifnet, ifmedia, mii
attach gm at obio
file arch/powerpc/mac/if_gm.c			gm

device macintr {}
attach macintr at obio
file	arch/powerpc/mac/macintr.c		macintr

device openpic {}
attach openpic at obio
file	arch/powerpc/mac/openpic.c		openpic
d162 2
a163 2
file arch/powerpc/mac/zs.c			zsc needs-flag
file dev/ic/z8530sc.c				zsc
d167 1
a167 1
file dev/ic/z8530tty.c                 zstty needs-flag
@


1.15.2.2
log
@Update the SMP branch to -current, this breaks the SMP branch though.
But it will be fixed soonish.  Note, nothing new has happened, this is just
a merge of the trunk into this branch.
@
text
@a22 1
file	arch/powerpc/powerpc/wscons_machdep.c
a71 2
file	arch/powerpc/mac/uni_n.c ofbus

d79 1
a79 3
file	arch/powerpc/pci/mpcpcibus.c		mpcpcibr
#file	arch/powerpc/pci/pci_addr_fixup.c	mpcpcibr

d81 4
d87 19
a105 1
include "../../../scsi/files.scsi"
d147 3
a149 3
#device esp: scsi, ncr53c9x
#attach esp at obio
#file arch/powerpc/mac/esp.c			esp
d165 2
a166 2
attach gm at pci
file arch/powerpc/mac/if_gm.c			gm needs-flag
d200 7
a206 15
device akbd: wskbddev
attach akbd at adb
file arch/powerpc/mac/akbd.c                     akbd needs-flag

device ams: wsmousedev
attach ams at adb
file arch/powerpc/mac/ams.c                      ams

device abtn
attach abtn at adb
file arch/powerpc/mac/abtn.c			abtn

device awacs: audio, auconv, mulaw
attach awacs at obio
file arch/powerpc/mac/awacs.c			awacs
d210 1
a210 1
file arch/powerpc/mac/nvram.c			nvram needs-flag
a211 4
device gpio {}
attach gpio at obio with gpio_obio
attach gpio at gpio with gpio_gpio
file arch/powerpc/mac/gpio.c			gpio
d214 1
a214 1
file arch/powerpc/mac/wdc_obio.c		wdc_obio
a229 21


# VGA framebuffer
device        vgafb: wsemuldisplaydev, wsrasteremulops
file  arch/powerpc/pci/vgafb.c          	vgafb & vgafb_pci

# Generic VGA Framebuffer version
attach  vgafb at pci with vgafb_pci
file    arch/powerpc/pci/vgafb_pci.c             vgafb_pci       needs-flag


#
# CARDBUS
#
include	"dev/cardbus/files.cardbus"
#file	arch/powerpc/powerpc/rbus_machdep.c	cardbus

#
# Machine-independent PCMCIA drivers
#
include "dev/pcmcia/files.pcmcia"
@


1.15.2.3
log
@Merge in -current from two days ago in the SMP branch.
As usual with merges, they do not indicate progress, so do not hold
your breath for working SMP, and do not mail me and ask about the
state of it.  It has not changed.  There is work ongoing, but very, very
slowly.  The commit is done in parts as to not lock up the tree in too
big chunks at a time.
@
text
@d16 1
a16 1
file	arch/powerpc/powerpc/disksubr.c			disk
d21 1
a21 1
file	arch/powerpc/powerpc/ipkdb_glue.c		ipkdb
d38 7
a44 6
file	arch/powerpc/powerpc/setjmp.S			ddb
file	arch/powerpc/powerpc/db_memrw.c			ddb
file	arch/powerpc/powerpc/db_disasm.c		ddb
file	arch/powerpc/powerpc/db_interface.c		ddb
file	arch/powerpc/powerpc/db_trace.c			ddb
file	arch/powerpc/powerpc/ofwreal.S
d63 1
a63 1
file	arch/powerpc/powerpc/mainbus.c			mainbus
d70 1
a70 1
file	arch/powerpc/powerpc/opendev.c
d73 1
d75 2
a76 14
device	memc {}
attach	memc at mainbus
file	arch/powerpc/mac/uni_n.c			memc

major	{rd = 17}
major	{sd = 2}
major	{cd = 3}

include "../../../scsi/files.scsi"

#
# I2O
#
include "../../../dev/i2o/files.i2o"
a78 1
file	arch/powerpc/pci/pciide_machdep.c	pciide
d82 7
a88 2
file	arch/powerpc/pci/mpcpcibus.c			mpcpcibr
#file	arch/powerpc/pci/pci_addr_fixup.c		mpcpcibr
d97 4
a100 4
#device	ofb: wsemuldisplaydev, wsrasteremulops
device	ofb
attach	ofb at pci
file	arch/powerpc/mac/ofb.c				ofb needs-flag
d107 3
a109 1
#file	arch/powerpc/pci/bandit.c			pci
d112 3
a114 3
device	pchb
attach	pchb at pci
file	arch/powerpc/pci/pchb.c				pchb
d124 1
a124 1
# MAC periph
d126 51
a176 51
device	macobio {}
attach	macobio at pci
file	arch/powerpc/pci/macobio.c			macobio

#device	esp: scsi, ncr53c9x
#attach	esp at macobio
#file	arch/powerpc/mac/esp.c				esp

device	mesh: scsi
attach	mesh at macobio
file	arch/powerpc/mac/mesh.c				mesh

device	mc: ifnet, ether
attach	mc at macobio
file	arch/powerpc/mac/if_mc.c			mc
file	arch/powerpc/mac/am79c950.c			mc

device	bm: ether, ifnet, ifmedia
attach	bm at macobio
file	arch/powerpc/mac/if_bm.c			bm

device	gm: ether, ifnet, ifmedia, mii
attach	gm at pci
file	arch/powerpc/mac/if_gm.c			gm needs-flag

device	macintr {}
attach	macintr at macobio
file	arch/powerpc/mac/macintr.c			macintr

device	openpic {}
attach	openpic at macobio
file	arch/powerpc/mac/openpic.c			openpic

device	zsc {channel = -1}
attach	zsc at macobio
file	arch/powerpc/mac/zs.c				zsc needs-flag
file	dev/ic/z8530sc.c				zsc

device	zstty: tty
attach	zstty at zsc
file	dev/ic/z8530tty.c				zstty needs-flag

device	adb {}
attach	adb at macobio
file	arch/powerpc/mac/adb.c				adb needs-flag
file	arch/powerpc/mac/adb_direct.c			adb
file	arch/powerpc/mac/pm_direct.c			adb

device	aed
attach	aed at adb
file	arch/powerpc/mac/aed.c				aed needs-flag
d179 1
a179 1
#define wskbddev {[console = -1]}
d183 42
a224 45
device	akbd: wskbddev
attach	akbd at adb
file	arch/powerpc/mac/akbd.c				akbd needs-flag

device	ams: wsmousedev
attach	ams at adb
file	arch/powerpc/mac/ams.c				ams

device	abtn
attach	abtn at adb
file	arch/powerpc/mac/abtn.c				abtn

device	awacs: audio, auconv, mulaw
attach	awacs at macobio
file	arch/powerpc/mac/awacs.c			awacs

device	nvram
attach	nvram at macobio
file	arch/powerpc/mac/nvram.c			nvram needs-flag

device	gpio {}
attach	gpio at macobio with gpio_obio
attach	gpio at gpio with gpio_gpio
file	arch/powerpc/mac/gpio.c				gpio

attach	wdc at macobio with wdc_obio
file	arch/powerpc/mac/wdc_obio.c			wdc_obio

attach	wi at macobio with wi_obio
file	arch/powerpc/mac/if_wi_obio.c			wi_obio

define	grfdev {}

device	grfati: grfdev
attach	grfati at pci
file	arch/powerpc/mac/grf_ati.c			grfati needs-flag

device	grf {}
attach	grf at grfdev
file	arch/powerpc/mac/grf.c				grf needs-flag
file	arch/powerpc/mac/grf_subr.c			grf

device	ite: tty
attach	ite at grf
file	arch/powerpc/mac/ite.c				ite needs-flag
d228 2
a229 2
device	vgafb: wsemuldisplaydev, wsrasteremulops
file	arch/powerpc/pci/vgafb.c			vgafb & vgafb_pci
d232 2
a233 2
attach	vgafb at pci with vgafb_pci
file	arch/powerpc/pci/vgafb_pci.c			vgafb_pci needs-flag
d240 1
a240 1
#file	arch/powerpc/powerpc/rbus_machdep.c		cardbus
@


1.15.2.4
log
@Sync the SMP branch to something just after 3.0
@
text
@a0 1
#	$OpenBSD$
d2 5
a7 1
file    arch/powerpc/powerpc/setjmp.S			ddb
d9 1
d11 2
d16 1
d21 7
d36 222
@


1.15.2.5
log
@repair
@
text
@d1 1
a1 1
#	$OpenBSD: files.powerpc,v 1.15.2.4 2001/10/31 03:07:54 nate Exp $
@


1.15.2.6
log
@Re-add missing pieces
@
text
@d1 1
a1 1
#	$OpenBSD: files.powerpc,v 1.35 2002/03/13 18:27:36 drahn Exp $
d7 2
@


1.15.2.7
log
@Sync the SMP branch with 3.3
@
text
@d1 1
a1 1
#	$OpenBSD$
d9 2
d14 3
a19 4

file	arch/powerpc/ddb/db_memrw.c			ddb
file	arch/powerpc/ddb/db_disasm.c			ddb
file	arch/powerpc/ddb/db_trace.c			ddb
@


1.14
log
@Add back rd_ md hooks that was incorrectly removed with the recent rd changes.
@
text
@a67 1
#pseudo-device rd
@


1.13
log
@Support for imac drivers, Additional configurations for mac kernels.
Some mac drivers mentioned in the config files may not be be currently
supported.
@
text
@d68 2
a69 1
pseudo-device rd
@


1.12
log
@move MI definition of rd into it's MI place also fixing
attributes, allowing kernels to exist w/ rd as the only disk device.
tested on a few archs; niels@@ & millert@@ ok
@
text
@d45 7
d71 1
a71 1
include	"../../../dev/pci/files.pci"
d86 1
a86 1
major	{ wd = 5 }		# Not even in bdevsw XXX
d104 1
a104 1
# "wprkstation cpnsole" routines
d108 111
@


1.11
log
@acd goes away
@
text
@a61 2
file dev/ramdisk.c			rd needs-flag
file arch/powerpc/powerpc/rd_root.c	ramdisk_hooks
@


1.10
log
@Fixes to update to that the powerpc port builds again.
These change were necessary due to the following changes:
The change/import of the "generic" isa/pcppi driver. The powerpc
port currently has it's own copy of that driver. The two versions
need to be merged.
The parameter changes to cpu_set_kpc. The powerpc change was not quite correct.
@
text
@a7 4
# need some decl. from here...
include	"../../../dev/atapi/files.atapi"                          
major	{ acd = 5 }

@


1.9
log
@add wscons support to powerpc port.
This contains several pieces of the port
MI:
    vgafb, on powerpc under openfirmware the vga card comes up in gfx mode.
    instead of resetting it to text mode, vgafb treats this as a raster
    display. The mechanism used may not have been the best, it's
    interface to wscons is as a text display, and it does the character
    plotting itself.
    font_8x16.c was stolen from the atari port for use.

MD:
    ppcppi support stolen from alpha
    pms.c, pckbd.c and the rest of the support files were
    used nearly directly.

    powerpc
      conf.c to support wscon, vga/kbd
      machdep.c hack to get around a bus_space_set_region,bus_space_copy error.
      ofw_machdep.c some hack code on the road to supporting wscons as console.
@
text
@d87 3
a89 3
device	pcppi { }
attach	pcppi at isa
file	arch/powerpc/isa/pcppi.c	pcppi
d92 1
a92 1
attach	pckbd at pcppi
d96 1
a96 1
attach	pms at pcppi
@


1.8
log
@Fix openfirmware attachment for openfirmware only systems.
if only ofrtc, still need the openfirmware support files.
@
text
@d87 12
d100 7
a106 1
file    arch/arc/isa/isapnp_machdep.c   isapnp   
@


1.7
log
@Various changes to allow mixing of ofw drivers and real drivers.
NCR driver seems to work.
Major changes are isa can be child of pci or mainbus.
ofroot is child of mainbus not root.
ofw bus configured before pci bus
Note that if a pci device configures accessing of driver will crash
the system. they need to be exclusive.
@
text
@d62 1
a62 1
file	arch/powerpc/powerpc/opendev.c ofcons | ofnet | ofdisk
a88 1

@


1.6
log
@Major changes here and there, tweaks elsewhere.
Support for Openfirmware drivers was reintroduced so that more systems
were supported. This should work with the real driver configurations
as well.

Bootloader files were deleted/replaced with the newer versions in the
subdirectory. Some effort has been made to be closer to support booting
(at least the bootloader) on the Mac.

Config files that end with OFW are the openfirmware versions of the kernels
without have native drivers.

Native driver support has not been changed, presumably it still works.
I couldn't test that.
@
text
@d48 4
d61 4
d70 2
d77 1
a77 1
attach	isabr at mainbus
a83 1
include	"../../../dev/pci/files.pci"
a89 7
#
# Openfirmware support
#

include "../../../dev/ofw/files.ofw"
file	arch/powerpc/powerpc/opendev.c ofcons | ofnet | ofdisk
major	{ ofdisk = 4 }
@


1.5
log
@New config stuff + Makefile fix to make gcc 2.8.1 work. Thanks to Dale Rahn!
@
text
@d2 1
a2 1
# V.I. powerpc-specific configuration info
d64 1
a64 1
file	arch/powerpc/pci/mpcpcibus.c
d70 1
a70 1
major	{sd = 0}
d76 1
a76 1
major	{ wd = 4 }
d80 8
@


1.4
log
@Monolithic PowerPC kernel configuration files
@
text
@d77 3
@


1.3
log
@PowerPC pieces for ramdisk (rd) changes this is adds majors,
rd_root pieces, config file to generate MINIROOT with rdroot and
MAKEDEV changes as well as adding the rd device to known device types.
@
text
@d2 1
a2 1
# First try for powerpc-specific configuration info
d8 3
a10 5
#
# Openfirmware support
#
include "../../../dev/ofw/files.ofw"
major	{ofdisk = 0}
d46 11
d58 2
a59 2
file dev/ramdisk.c                      rd needs-flag
file arch/powerpc/powerpc/rd_root.c           ramdisk_hooks
d62 7
a68 10
# FirePower specific code
#device firepower: openfirm
#attach firepower at root

#file	arch/powerpc/firepower/firedep.c	firepower needs-flag
#file	arch/powerpc/firepower/fireirq.c	firepower

# FirePower OpenFirmware Bug Workarounds
file	arch/powerpc/powerpc/ofwreal.S		firepowerbugs

d70 2
d73 4
@


1.2
log
@Changes necessary to make the kernel compile and boot.
Some merging with NetBSD port.
@
text
@d48 5
@


1.1
log
@Initial revision
@
text
@d42 5
a46 5
file    arch/ppc/ppc/setjmp.S                   ddb
file    arch/ppc/ppc/db_memrw.c                 ddb
file    arch/ppc/ppc/db_disasm.c                ddb
file    arch/ppc/ppc/db_interface.c             ddb
file    arch/ppc/ppc/db_trace.c                 ddb
@


1.1.1.1
log
@Check-in of powerpc kernel support.
NOTE: This will not work until the other pieces are checked in.
This is primarily the NetBSD powerpc port, with modifications
to support ELF. 
@
text
@@
