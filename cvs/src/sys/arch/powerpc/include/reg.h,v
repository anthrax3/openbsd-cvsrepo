head	1.11;
access;
symbols
	OPENBSD_6_1:1.11.0.12
	OPENBSD_6_1_BASE:1.11
	OPENBSD_6_0:1.11.0.8
	OPENBSD_6_0_BASE:1.11
	OPENBSD_5_9:1.11.0.4
	OPENBSD_5_9_BASE:1.11
	OPENBSD_5_8:1.11.0.6
	OPENBSD_5_8_BASE:1.11
	OPENBSD_5_7:1.11.0.2
	OPENBSD_5_7_BASE:1.11
	OPENBSD_5_6:1.10.0.36
	OPENBSD_5_6_BASE:1.10
	OPENBSD_5_5:1.10.0.34
	OPENBSD_5_5_BASE:1.10
	OPENBSD_5_4:1.10.0.30
	OPENBSD_5_4_BASE:1.10
	OPENBSD_5_3:1.10.0.28
	OPENBSD_5_3_BASE:1.10
	OPENBSD_5_2:1.10.0.26
	OPENBSD_5_2_BASE:1.10
	OPENBSD_5_1_BASE:1.10
	OPENBSD_5_1:1.10.0.24
	OPENBSD_5_0:1.10.0.22
	OPENBSD_5_0_BASE:1.10
	OPENBSD_4_9:1.10.0.20
	OPENBSD_4_9_BASE:1.10
	OPENBSD_4_8:1.10.0.18
	OPENBSD_4_8_BASE:1.10
	OPENBSD_4_7:1.10.0.14
	OPENBSD_4_7_BASE:1.10
	OPENBSD_4_6:1.10.0.16
	OPENBSD_4_6_BASE:1.10
	OPENBSD_4_5:1.10.0.12
	OPENBSD_4_5_BASE:1.10
	OPENBSD_4_4:1.10.0.10
	OPENBSD_4_4_BASE:1.10
	OPENBSD_4_3:1.10.0.8
	OPENBSD_4_3_BASE:1.10
	OPENBSD_4_2:1.10.0.6
	OPENBSD_4_2_BASE:1.10
	OPENBSD_4_1:1.10.0.4
	OPENBSD_4_1_BASE:1.10
	OPENBSD_4_0:1.10.0.2
	OPENBSD_4_0_BASE:1.10
	OPENBSD_3_9:1.9.0.12
	OPENBSD_3_9_BASE:1.9
	OPENBSD_3_8:1.9.0.10
	OPENBSD_3_8_BASE:1.9
	OPENBSD_3_7:1.9.0.8
	OPENBSD_3_7_BASE:1.9
	OPENBSD_3_6:1.9.0.6
	OPENBSD_3_6_BASE:1.9
	SMP_SYNC_A:1.9
	SMP_SYNC_B:1.9
	OPENBSD_3_5:1.9.0.4
	OPENBSD_3_5_BASE:1.9
	OPENBSD_3_4:1.9.0.2
	OPENBSD_3_4_BASE:1.9
	UBC_SYNC_A:1.8
	OPENBSD_3_3:1.8.0.4
	OPENBSD_3_3_BASE:1.8
	OPENBSD_3_2:1.8.0.2
	OPENBSD_3_2_BASE:1.8
	OPENBSD_3_1:1.6.0.2
	OPENBSD_3_1_BASE:1.6
	UBC_SYNC_B:1.8
	UBC:1.5.0.2
	UBC_BASE:1.5
	OPENBSD_3_0:1.3.0.2
	OPENBSD_3_0_BASE:1.3
	OPENBSD_2_9:1.2.0.14
	OPENBSD_2_9_BASE:1.2
	OPENBSD_2_8:1.2.0.12
	OPENBSD_2_8_BASE:1.2
	OPENBSD_2_7:1.2.0.10
	OPENBSD_2_7_BASE:1.2
	SMP:1.2.0.8
	SMP_BASE:1.2
	kame_19991208:1.2
	OPENBSD_2_6:1.2.0.6
	OPENBSD_2_6_BASE:1.2
	OPENBSD_2_5:1.2.0.4
	OPENBSD_2_5_BASE:1.2
	OPENBSD_2_4:1.2.0.2
	OPENBSD_2_4_BASE:1.2
	OPENBSD_2_3:1.1.0.6
	OPENBSD_2_3_BASE:1.1
	OPENBSD_2_2:1.1.0.4
	OPENBSD_2_2_BASE:1.1
	OPENBSD_2_1:1.1.0.2
	OPENBSD_2_1_BASE:1.1;
locks; strict;
comment	@ * @;


1.11
date	2014.09.08.01.47.06;	author guenther;	state Exp;
branches;
next	1.10;
commitid	QKTb36RFnfteZJPE;

1.10
date	2006.05.16.08.00.33;	author kettenis;	state Exp;
branches;
next	1.9;

1.9
date	2003.06.02.23.27.53;	author millert;	state Exp;
branches;
next	1.8;

1.8
date	2002.09.15.09.01.59;	author deraadt;	state Exp;
branches;
next	1.7;

1.7
date	2002.09.15.02.02.44;	author deraadt;	state Exp;
branches;
next	1.6;

1.6
date	2002.03.14.23.51.47;	author drahn;	state Exp;
branches;
next	1.5;

1.5
date	2001.12.17.03.19.01;	author drahn;	state Exp;
branches
	1.5.2.1;
next	1.4;

1.4
date	2001.11.13.14.31.52;	author drahn;	state Exp;
branches;
next	1.3;

1.3
date	2001.06.29.06.07.09;	author drahn;	state Exp;
branches;
next	1.2;

1.2
date	98.08.07.02.22.06;	author rahnds;	state Exp;
branches
	1.2.8.1;
next	1.1;

1.1
date	97.01.02.02.55.47;	author rahnds;	state Exp;
branches;
next	;

1.2.8.1
date	2001.07.04.10.22.28;	author niklas;	state Exp;
branches;
next	1.2.8.2;

1.2.8.2
date	2001.11.13.22.14.34;	author niklas;	state dead;
branches;
next	1.2.8.3;

1.2.8.3
date	2002.03.29.16.11.59;	author niklas;	state Exp;
branches;
next	1.2.8.4;

1.2.8.4
date	2003.06.07.11.13.18;	author ho;	state Exp;
branches;
next	;

1.5.2.1
date	2002.06.11.03.37.28;	author art;	state Exp;
branches;
next	1.5.2.2;

1.5.2.2
date	2002.10.29.00.28.08;	author art;	state Exp;
branches;
next	;


desc
@@


1.11
log
@Delete procfs; it's always had races and is now unused: no one noticed for
months that I broke it before the 5.5 release.

confirmed as not being required by ports by sthen@@, ajacoutot@@, dcoppa@@
@
text
@/*	$OpenBSD: reg.h,v 1.10 2006/05/16 08:00:33 kettenis Exp $	*/

/*-
 * Copyright (c) 1990 The Regents of the University of California.
 * All rights reserved.
 *
 * This code is derived from software contributed to Berkeley by
 * William Jolitz.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. Neither the name of the University nor the names of its contributors
 *    may be used to endorse or promote products derived from this software
 *    without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 *
 *	@@(#)reg.h	5.5 (Berkeley) 1/18/91
 */

#ifndef _POWERPC_REG_H_
#define _POWERPC_REG_H_

/*
 * Struct reg, used for ptrace and in signal contexts
 * Note that in signal contexts, it's represented as an array.
 * That array has to look exactly like 'struct reg' though.
 */

struct reg {
	u_int32_t gpr[32];
	u_int64_t fpr[32];
	u_int32_t pc;
	u_int32_t ps;
	u_int32_t cnd;
	u_int32_t lr;
	u_int32_t cnt;
	u_int32_t xer;
	u_int32_t mq;
};

struct fpreg {
	u_int64_t fpr[32];
	u_int32_t fpscr;
};

struct vreg {
        u_int32_t vreg[32][4];
	u_int64_t vscr;
	u_int32_t vrsave;
	u_int32_t pad;
};

#ifdef _KERNEL
void save_vec(struct proc *);
void enable_vec(struct proc *);
extern struct proc *ppc_vecproc;
extern struct pool ppc_vecpl;
#endif /* _KERNEL */
#endif /* !_POWERPC_REG_H_ */
@


1.10
log
@Add struct fpreg.
@
text
@d1 1
a1 1
/*	$OpenBSD: reg.h,v 1.9 2003/06/02 23:27:53 millert Exp $	*/
d41 1
a41 1
 * Struct reg, used for procfs and in signal contexts
@


1.9
log
@Remove the advertising clause in the UCB license which Berkeley
rescinded 22 July 1999.  Proofed by myself and Theo.
@
text
@d1 1
a1 1
/*	$OpenBSD: reg.h,v 1.8 2002/09/15 09:01:59 deraadt Exp $	*/
a45 1
/* this table is set up to match what gdb expects */
d56 5
@


1.8
log
@backout premature
@
text
@d1 1
a1 1
/*	$OpenBSD: reg.h,v 1.6 2002/03/14 23:51:47 drahn Exp $	*/
d18 1
a18 5
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 *	This product includes software developed by the University of
 *	California, Berkeley and its contributors.
 * 4. Neither the name of the University nor the names of its contributors
@


1.7
log
@KNF
@
text
@d64 1
a64 1
	u_int32_t vreg[32][4];
@


1.6
log
@Improved altivec support for powerpc/macppc.
Fix bug where altivec context was not freed on process exit.
Fix bug where vscr was not correctly saved/restored.
replace asm statement was macros which expand to the same
asm code or to .long XXX which evaluates to the same instruction
since in-tree gas does not support altivec.
Enable ALTIVEC support by default on macppc, still conditional
for other powerpc ports.
@
text
@d1 1
a1 1
/*	$OpenBSD: reg.h,v 1.5 2001/12/17 03:19:01 drahn Exp $	*/
d64 1
a64 1
        u_int32_t vreg[32][4];
@


1.5
log
@Move the process_read_reg prototype to the correct file, it is specified
in ptrace.h, not in md header files.
Protect vector functions/variables with _KERNEL.
@
text
@d1 1
a1 1
/*	$OpenBSD: reg.h,v 1.4 2001/11/13 14:31:52 drahn Exp $	*/
d65 1
a65 1
	u_int32_t vscr;
d67 1
a70 1
#ifdef PPC_VECTOR_SUPPORTED
a74 1
#endif /* PPC_VECTOR_SUPPORTED */
@


1.5.2.1
log
@Sync UBC branch to -current
@
text
@d1 1
a1 1
/*	$OpenBSD: reg.h,v 1.5 2001/12/17 03:19:01 drahn Exp $	*/
d65 1
a65 1
	u_int64_t vscr;
a66 1
	u_int32_t pad;
d70 1
d75 1
@


1.5.2.2
log
@sync to -current
@
text
@d1 1
a1 1
/*	$OpenBSD: reg.h,v 1.5.2.1 2002/06/11 03:37:28 art Exp $	*/
@


1.4
log
@Add AltiVec support to powerpc/macppc. This is not currently enabled because
the 'as' in openbsd source tree does not yet support altivec instructions.
The pieces to enable it have been put in macppc/conf/GENERIC and
macppc/conf/Makefile.macppc in comments.
Once 'as' is updated the kernel option should be removed.
@
text
@d1 1
a1 1
/*	$OpenBSD: reg.h,v 1.3 2001/06/29 06:07:09 drahn Exp $	*/
d69 1
a69 1
int process_read_regs __P((struct proc *p, struct reg *regs));
d76 1
@


1.3
log
@header file include/define cleanup. commit N of many.
@
text
@d1 1
a1 1
/*	$OpenBSD: reg.h,v 1.2 1998/08/07 02:22:06 rahnds Exp $	*/
d62 7
d70 6
@


1.2
log
@Add kernel support for debugging with gdb. This also make /proc allow
access to the registers. The format of the registers returned in ptrace,
/proc and in the coredump header match what gdb was expecting.
Floating point registers are not yet copied into the structure.
The location of the fpr needs to be found and copied. <- TODO

Changes to trap.c was to add some interm debugging. code is commented out.

powerpc does not currently have a MID_* type, since it uses ELF instead
of a.out, one was never added. Currently the coredump is done in form
of MID_NONE. What is the correct approach for this?? Elf format coredumps...
maybe?
@
text
@d1 1
a1 1
/*	$OpenBSD: reg.h,v 1.1 1997/01/02 02:55:47 rahnds Exp $	*/
d62 1
@


1.2.8.1
log
@Merge in -current from two days ago in the SMP branch.
As usual with merges, they do not indicate progress, so do not hold
your breath for working SMP, and do not mail me and ask about the
state of it.  It has not changed.  There is work ongoing, but very, very
slowly.  The commit is done in parts as to not lock up the tree in too
big chunks at a time.
@
text
@d1 1
a1 1
/*	$OpenBSD: reg.h,v 1.2 1998/08/07 02:22:06 rahnds Exp $	*/
a61 1
int process_read_regs __P((struct proc *p, struct reg *regs));
@


1.2.8.2
log
@repair
@
text
@d1 1
a1 1
/*	$OpenBSD: reg.h,v 1.2.8.1 2001/07/04 10:22:28 niklas Exp $	*/
@


1.2.8.3
log
@Re-add missing pieces
@
text
@d1 1
a1 1
/*	$OpenBSD: reg.h,v 1.6 2002/03/14 23:51:47 drahn Exp $	*/
d62 1
a62 14

struct vreg {
        u_int32_t vreg[32][4];
	u_int64_t vscr;
	u_int32_t vrsave;
	u_int32_t pad;
};

#ifdef _KERNEL
void save_vec(struct proc *);
void enable_vec(struct proc *);
extern struct proc *ppc_vecproc;
extern struct pool ppc_vecpl;
#endif /* _KERNEL */
@


1.2.8.4
log
@Sync SMP branch to -current
@
text
@d1 1
a1 1
/*	$OpenBSD: reg.h,v 1.2.8.3 2002/03/29 16:11:59 niklas Exp $	*/
d18 5
a22 1
 * 3. Neither the name of the University nor the names of its contributors
@


1.1
log
@adding files previously missing.
The reg.h file may not be complete, currently the port does not support
ptrace.
@
text
@d1 1
a1 1
/*	$OpenBSD: reg.h,v 1.14 1995/10/11 04:20:24 mycroft Exp $	*/
d44 18
a61 1
/* not supported yet */
@

