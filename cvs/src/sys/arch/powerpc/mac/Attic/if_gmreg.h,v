head	1.5;
access;
symbols
	SMP_SYNC_A:1.5
	SMP_SYNC_B:1.5
	UBC_SYNC_A:1.5
	UBC_SYNC_B:1.5
	OPENBSD_2_9_BASE:1.2
	OPENBSD_2_9:1.2.0.4
	OPENBSD_2_8:1.2.0.2
	OPENBSD_2_8_BASE:1.2
	OPENBSD_2_7:1.1.0.4
	OPENBSD_2_7_BASE:1.1
	SMP:1.1.0.2;
locks; strict;
comment	@ * @;


1.5
date	2001.09.01.15.50.00;	author drahn;	state dead;
branches;
next	1.4;

1.4
date	2001.07.04.08.38.51;	author niklas;	state Exp;
branches;
next	1.3;

1.3
date	2001.06.24.20.26.14;	author drahn;	state Exp;
branches;
next	1.2;

1.2
date	2000.07.07.13.32.46;	author rahnds;	state Exp;
branches;
next	1.1;

1.1
date	2000.03.23.04.06.56;	author rahnds;	state Exp;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2000.03.24.09.08.40;	author niklas;	state Exp;
branches;
next	1.1.2.2;

1.1.2.2
date	2001.05.14.21.36.48;	author niklas;	state Exp;
branches;
next	1.1.2.3;

1.1.2.3
date	2001.07.04.10.22.37;	author niklas;	state Exp;
branches;
next	1.1.2.4;

1.1.2.4
date	2001.10.31.03.07.55;	author nate;	state dead;
branches;
next	;


desc
@@


1.5
log
@The "powerpc" port which has supported the newer Apple Macintosh powerpc based
is being renamed to macppc. This is to allow sharing of common code
between different powerpc base platforms.

Most of the work involved in the renaming process was performed by miod@@

Files moved from powerpc/mac to macppc/dev
@
text
@/*	$OpenBSD: if_gmreg.h,v 1.4 2001/07/04 08:38:51 niklas Exp $	*/
/*	$NetBSD: if_gmreg.h,v 1.1 2000/02/27 18:00:55 tsubai Exp $	*/

/*-
 * Copyright (c) 2000 Tsubai Masanari.  All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. The name of the author may not be used to endorse or promote products
 *    derived from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
 * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
 * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
 * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
 * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

struct gmac_dma {
	u_int32_t cmd;
	u_int32_t cmd_hi;
	u_int32_t address;
	u_int32_t address_hi;
};

#define GMAC_OWN	0x80000000
#define GMAC_SOP	0x40000000	/* start of packet? */
#define GMAC_LEN_MASK	0x00003fff

#define GMAC_INT_TXEMPTY	0x02 /* TX ring empty */
#define GMAC_INT_TXDONE		0x04
#define GMAC_INT_RXDONE		0x10

#define GMAC_RXMAC_PR	0x08		/* enable promiscuous mode */
#define GMAC_RXMAC_HEN	0x10		/* enable the hash filter */

/*
 * register offset
 */
#define GMAC_STATUS		0x000c
#define GMAC_INTMASK		0x0010
#define GMAC_SOFTWARERESET	0x1010

#define GMAC_TXDMAKICK		0x2000
#define GMAC_TXDMACONFIG	0x2004
#define GMAC_TXDMADESCBASELO	0x2008
#define GMAC_TXDMADESCBASEHI	0x200c
#define GMAC_TXDMACOMPLETE	0x2100

#define GMAC_RXDMACONFIG	0x4000
#define GMAC_RXDMADESCBASELO	0x4004
#define GMAC_RXDMADESCBASEHI	0x4008
#define GMAC_RXDMAKICK		0x4100

#define GMAC_MACPAUSE		0x6008
#define GMAC_MACPAUSE		0x6008
#define GMAC_TXMACSTATUS	0x6010
#define GMAC_TXMACCONFIG	0x6030
#define GMAC_RXMACCONFIG	0x6034
#define GMAC_MACCTRLCONFIG	0x6038
#define GMAC_XIFCONFIG		0x603c
#define GMAC_INTERPACKETGAP0	0x6040
#define GMAC_INTERPACKETGAP1	0x6044
#define GMAC_INTERPACKETGAP2	0x6048
#define GMAC_SLOTTIME		0x604c
#define GMAC_MINFRAMESIZE	0x6050
#define GMAC_MAXFRAMESIZE	0x6054
#define GMAC_PASIZE		0x6058
#define GMAC_JAMSIZE		0x605c
#define GMAC_ATTEMPTLIMIT	0x6060		/* atemptlimit */
#define GMAC_MACCNTLTYPE	0x6064
#define GMAC_MACADDRESS0	0x6080
#define GMAC_MACADDRESS1	0x6084
#define GMAC_MACADDRESS2	0x6088
#define GMAC_MACADDRESS3	0x608c
#define GMAC_MACADDRESS4	0x6090
#define GMAC_MACADDRESS5	0x6094
#define GMAC_MACADDRESS6	0x6098
#define GMAC_MACADDRESS7	0x609c
#define GMAC_MACADDRESS8	0x60a0
#define GMAC_MACADDRFILT0	0x60a4
#define GMAC_MACADDRFILT1	0x60a8
#define GMAC_MACADDRFILT2	0x60ac
#define GMAC_MACADDRFILT2_1MASK	0x60b0		/* macaddressfilter2&1mask */
#define GMAC_MACADDRFILT0MASK	0x60b4		/* macaddressfilter0mask */
#define GMAC_HASHTABLE0		0x60c0

#define GMAC_RANDOMSEED		0x6130
#define GMAC_MIFFRAMEOUTPUT	0x620c
#define GMAC_DATAPATHMODE	0x9050

#ifndef ETHER_MAX_LEN
#define ETHER_MAX_LEN           1518
#endif
#ifndef ETHER_MIN_LEN
#define ETHER_MIN_LEN           64
#endif

@


1.4
log
@$OpenBSD$
@
text
@d1 1
a1 1
/*	$OpenBSD: if_gmreg.h,v 1.1 2000/02/27 18:00:55 tsubai Exp $	*/
@


1.3
log
@Add gmac_setladrf functionality from netbsd, this was missed in a previous
merge.
IP6 now works configures.
@
text
@d1 1
@


1.2
log
@Updates from a newer version of the NetBSD driver.
Use the interrupt line as configured by pci, now that
the bridge will walk the openfirmware device tree and properly
initialize that field.
@
text
@d44 2
a45 1
#define GMAC_RXMAC_PR	0x08
@


1.1
log
@NetBSD gm ethernet driver ported from NetBSD. compiles, but does not yet
configure. mii code is very suspect. Additional debugging will be done
after configuration issues are addressed.
@
text
@d40 3
a42 2
#define GMAC_INT_TXDONE	0x04
#define GMAC_INT_RXDONE	0x10
@


1.1.2.1
log
@Sync with -current
@
text
@@


1.1.2.2
log
@Continue the aborted merge of current just before 2.9 was cut into the
SMP branch.  Note that this will not make any progress of SMP functionality,
it is just merging of new code from the trunk into the old branch.
Please do not ask me questions about SMP status because of this mail,
instead go read the archives of smp@@openbsd.org, where I mailed about
these commits some week ago.  Another note: I am doing this in chunks now,
so as to not lock too much of the tree for long times
@
text
@d40 2
a41 3
#define GMAC_INT_TXEMPTY	0x02 /* TX ring empty */
#define GMAC_INT_TXDONE		0x04
#define GMAC_INT_RXDONE		0x10
@


1.1.2.3
log
@Merge in -current from two days ago in the SMP branch.
As usual with merges, they do not indicate progress, so do not hold
your breath for working SMP, and do not mail me and ask about the
state of it.  It has not changed.  There is work ongoing, but very, very
slowly.  The commit is done in parts as to not lock up the tree in too
big chunks at a time.
@
text
@d44 1
a44 2
#define GMAC_RXMAC_PR	0x08		/* enable promiscuous mode */
#define GMAC_RXMAC_HEN	0x10		/* enable the hash filter */
@


1.1.2.4
log
@Sync the SMP branch to something just after 3.0
@
text
@@


