head	1.9;
access;
symbols
	OPENBSD_6_1_BASE:1.9
	OPENBSD_6_0:1.9.0.22
	OPENBSD_6_0_BASE:1.9
	OPENBSD_5_9:1.9.0.18
	OPENBSD_5_9_BASE:1.9
	OPENBSD_5_8:1.9.0.20
	OPENBSD_5_8_BASE:1.9
	OPENBSD_5_7:1.9.0.12
	OPENBSD_5_7_BASE:1.9
	OPENBSD_5_6:1.9.0.16
	OPENBSD_5_6_BASE:1.9
	OPENBSD_5_5:1.9.0.14
	OPENBSD_5_5_BASE:1.9
	OPENBSD_5_4:1.9.0.10
	OPENBSD_5_4_BASE:1.9
	OPENBSD_5_3:1.9.0.8
	OPENBSD_5_3_BASE:1.9
	OPENBSD_5_2:1.9.0.6
	OPENBSD_5_2_BASE:1.9
	OPENBSD_5_1_BASE:1.9
	OPENBSD_5_1:1.9.0.4
	OPENBSD_5_0:1.9.0.2
	OPENBSD_5_0_BASE:1.9
	OPENBSD_4_9:1.8.0.6
	OPENBSD_4_9_BASE:1.8
	OPENBSD_4_8:1.8.0.4
	OPENBSD_4_8_BASE:1.8
	OPENBSD_4_7:1.8.0.2
	OPENBSD_4_7_BASE:1.8
	OPENBSD_4_6:1.6.0.8
	OPENBSD_4_6_BASE:1.6
	OPENBSD_4_5:1.6.0.4
	OPENBSD_4_5_BASE:1.6
	OPENBSD_4_4:1.6.0.2
	OPENBSD_4_4_BASE:1.6
	OPENBSD_4_3:1.5.0.2
	OPENBSD_4_3_BASE:1.5
	OPENBSD_4_2:1.4.0.14
	OPENBSD_4_2_BASE:1.4
	OPENBSD_4_1:1.4.0.12
	OPENBSD_4_1_BASE:1.4
	OPENBSD_4_0:1.4.0.10
	OPENBSD_4_0_BASE:1.4
	OPENBSD_3_9:1.4.0.8
	OPENBSD_3_9_BASE:1.4
	OPENBSD_3_8:1.4.0.6
	OPENBSD_3_8_BASE:1.4
	OPENBSD_3_7:1.4.0.4
	OPENBSD_3_7_BASE:1.4
	OPENBSD_3_6:1.4.0.2
	OPENBSD_3_6_BASE:1.4
	SMP_SYNC_A:1.4
	SMP_SYNC_B:1.4
	OPENBSD_3_5:1.3.0.8
	OPENBSD_3_5_BASE:1.3
	OPENBSD_3_4:1.3.0.6
	OPENBSD_3_4_BASE:1.3
	UBC_SYNC_A:1.3
	OPENBSD_3_3:1.3.0.4
	OPENBSD_3_3_BASE:1.3
	OPENBSD_3_2:1.3.0.2
	OPENBSD_3_2_BASE:1.3
	OPENBSD_3_1:1.2.0.2
	OPENBSD_3_1_BASE:1.2
	UBC_SYNC_B:1.3
	UBC:1.1.0.12
	UBC_BASE:1.1
	OPENBSD_3_0:1.1.0.10
	OPENBSD_3_0_BASE:1.1
	OPENBSD_2_9:1.1.0.8
	OPENBSD_2_9_BASE:1.1
	SMP:1.1.0.6
	OPENBSD_2_8:1.1.0.4
	OPENBSD_2_8_BASE:1.1
	OPENBSD_2_7:1.1.0.2
	OPENBSD_2_7_BASE:1.1;
locks; strict;
comment	@ * @;


1.9
date	2011.03.23.16.54.35;	author pirofti;	state Exp;
branches;
next	1.8;

1.8
date	2010.01.13.09.10.33;	author jsg;	state Exp;
branches;
next	1.7;

1.7
date	2009.07.21.21.20.05;	author miod;	state Exp;
branches;
next	1.6;

1.6
date	2008.07.02.03.00.00;	author fgsch;	state Exp;
branches;
next	1.5;

1.5
date	2007.12.09.16.53.36;	author kettenis;	state Exp;
branches;
next	1.4;

1.4
date	2004.05.04.17.06.33;	author grange;	state Exp;
branches;
next	1.3;

1.3
date	2002.07.23.17.53.24;	author drahn;	state Exp;
branches;
next	1.2;

1.2
date	2002.03.14.01.26.33;	author millert;	state Exp;
branches;
next	1.1;

1.1
date	2000.04.08.05.50.50;	author aaron;	state Exp;
branches
	1.1.6.1
	1.1.12.1;
next	;

1.1.6.1
date	2001.04.18.16.07.43;	author niklas;	state Exp;
branches;
next	1.1.6.2;

1.1.6.2
date	2002.03.28.10.31.04;	author niklas;	state Exp;
branches;
next	1.1.6.3;

1.1.6.3
date	2003.03.27.23.26.55;	author niklas;	state Exp;
branches;
next	1.1.6.4;

1.1.6.4
date	2004.06.05.23.09.00;	author niklas;	state Exp;
branches;
next	;

1.1.12.1
date	2002.06.11.03.35.54;	author art;	state Exp;
branches;
next	1.1.12.2;

1.1.12.2
date	2002.10.29.00.28.04;	author art;	state Exp;
branches;
next	;


desc
@@


1.9
log
@Normalize sentinel. Use _MACHINE_*_H_ and _<ARCH>_*_H_ properly and consitently.

Discussed and okay drahn@@. Okay deraadt@@.
@
text
@/*	$OpenBSD: rbus_machdep.h,v 1.8 2010/01/13 09:10:33 jsg Exp $	*/
/*	$NetBSD: rbus_machdep.h,v 1.2 1999/10/15 06:43:05 haya Exp $	*/

/*
 * Copyright (c) 1999
 *     HAYAKAWA Koichi.  All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 *
 * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
 * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
 * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
 * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
 * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
 * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef _MACHINE_RBUS_MACHDEP_H_
#define _MACHINE_RBUS_MACHDEP_H_

struct pci_attach_args;		/* XXX */

#define md_space_map(rbt, physaddr, size, flags, bshp) \
	_bus_space_map((rbt)->rb_bt, (physaddr), (size), (flags), (bshp))

#define md_space_unmap(rbt, bsh, size, adrp) \
	_bus_space_unmap((rbt)->rb_bt, (bsh), (size), (adrp))

rbus_tag_t	rbus_pccbb_parent_io(struct device *,
		    struct pci_attach_args *);
rbus_tag_t	rbus_pccbb_parent_mem(struct device *,
		    struct pci_attach_args *);

bus_addr_t	rbus_min_start_hint(void);

void		pccbb_attach_hook(struct device *, struct device *,
		    struct pci_attach_args *);

#endif /* _MACHINE_RBUS_MACHDEP_H_ */
@


1.8
log
@As per NetBSD move HAYAKAWA Koichi's licenses to two clause.
@
text
@d1 1
a1 1
/*	$OpenBSD: rbus_machdep.h,v 1.7 2009/07/21 21:20:05 miod Exp $	*/
d29 2
a30 2
#ifndef _I386_RBUS_MACHDEP_H_
#define _I386_RBUS_MACHDEP_H_
d50 1
a50 1
#endif /* _I386_RBUS_MACHDEP_H_ */
@


1.7
log
@Change the rbus md_space_{map,unmap} signature to take a rbus_tag_t instead
of the bus_space_tag_t it contains; an upcoming implementation will need
to know the rbus_tag_t for which it works at this point.

All callers updated accordingly; no functional change intended.
@
text
@d1 1
a1 1
/*	$OpenBSD: rbus_machdep.h,v 1.6 2008/07/02 03:00:00 fgsch Exp $	*/
a15 5
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 *	This product includes software developed by HAYAKAWA Koichi.
 * 4. The name of the author may not be used to endorse or promote products
 *    derived from this software without specific prior written permission.
@


1.6
log
@* Dynamically set the rbus start address. from netbsd.
* For amd64, remove pcibios traces.
* make RBUS_IO_START, RBUS_IO_SIZE, RBUS_MIN_START and RBUS_MEM_SIZE
  (on i386) configurable via kernel options.
* Remove unneeded headers.
* Some cleanups.

originally reported in pr/5829 and tested by viq <viq at viq dot ath dot cx>.
fixes ian@@ laptop too.
kettenis@@ and miod@@ agrees that although not perfect, this is the right
direction.
@
text
@d1 1
a1 1
/*	$OpenBSD: rbus_machdep.h,v 1.5 2007/12/09 16:53:36 kettenis Exp $	*/
d39 2
a40 2
#define md_space_map(bt, physaddr, size, flags, bshp) \
	_bus_space_map((bt), (physaddr), (size), (flags), (bshp))
d42 2
a43 2
#define md_space_unmap(bt, bsh, size, adrp) \
	_bus_space_unmap((bt), (bsh), (size), (adrp))
@


1.5
log
@Add an empty pccbb_attach_hook.
@
text
@d1 1
a1 1
/*	$OpenBSD: rbus_machdep.h,v 1.4 2004/05/04 17:06:33 grange Exp $ */
d34 2
a35 3

#if !defined _ARCH_I386_I386_RBUS_MACHDEP_H_
#define _ARCH_I386_I386_RBUS_MACHDEP_H_
d45 4
d50 1
a50 4
rbus_tag_t rbus_pccbb_parent_io(struct device *self,
    struct pci_attach_args *pa);
rbus_tag_t rbus_pccbb_parent_mem(struct device *self,
    struct pci_attach_args *pa);
d52 2
a53 2
void	pccbb_attach_hook(struct device *, struct device *,
	    struct pci_attach_args *);
d55 1
a55 1
#endif /* _ARCH_I386_I386_RBUS_MACHDEP_H_ */
@


1.4
log
@Move _bus_space_unmap() to machdep.c so it can be used not
only by the rbus code. Also knf it and sync with bus_space_unmap().

ok millert@@
@
text
@d1 1
a1 1
/*	$OpenBSD: rbus_machdep.h,v 1.3 2002/07/23 17:53:24 drahn Exp $ */
d51 3
@


1.3
log
@Cardbus/pcmcia support for macppc. parts borrowed from NetBSD, and other
portions of the tree.
@
text
@d1 1
a1 1
/*	$OpenBSD: rbus_machdep.h,v 1.2 2002/03/14 01:26:33 millert Exp $ */
a38 3

void _bus_space_unmap(bus_space_tag_t, bus_space_handle_t,
			     bus_size_t, bus_addr_t *);
@


1.2
log
@First round of __P removal in sys
@
text
@d1 1
a1 1
/*	$OpenBSD: rbus_machdep.h,v 1.1 2000/04/08 05:50:50 aaron Exp $ */
d50 4
a53 2
rbus_tag_t rbus_pccbb_parent_io(struct pci_attach_args *pa);
rbus_tag_t rbus_pccbb_parent_mem(struct pci_attach_args *pa);
@


1.1
log
@Initial check-in for support of 32-bit CardBus PC Cards; from NetBSD. On many
machines, this code needs the new PCIBIOS* options enabled in the kernel config
file to work, but your mileage may vary. Included is a working 3c575 driver for
3Com 10/100 CardBus PC Card NICs (tested only with the 'C' revision). The 3c575
is the pccard version of the PCI EtherLink XL cards, and thus the xl driver has
been split into /sys/dev/ic.
@
text
@d1 1
a1 1
/*	$OpenBSD$ */
d40 2
a41 2
void _bus_space_unmap  __P((bus_space_tag_t, bus_space_handle_t,
			     bus_size_t, bus_addr_t *));
d50 2
a51 2
rbus_tag_t rbus_pccbb_parent_io __P((struct pci_attach_args *pa));
rbus_tag_t rbus_pccbb_parent_mem __P((struct pci_attach_args *pa));
@


1.1.12.1
log
@Sync UBC branch to -current
@
text
@d1 1
a1 1
/*	$OpenBSD: rbus_machdep.h,v 1.1 2000/04/08 05:50:50 aaron Exp $ */
d40 2
a41 2
void _bus_space_unmap(bus_space_tag_t, bus_space_handle_t,
			     bus_size_t, bus_addr_t *);
d50 2
a51 2
rbus_tag_t rbus_pccbb_parent_io(struct pci_attach_args *pa);
rbus_tag_t rbus_pccbb_parent_mem(struct pci_attach_args *pa);
@


1.1.12.2
log
@sync to -current
@
text
@d1 1
a1 1
/*	$OpenBSD: rbus_machdep.h,v 1.1.12.1 2002/06/11 03:35:54 art Exp $ */
d50 2
a51 4
rbus_tag_t rbus_pccbb_parent_io(struct device *self,
    struct pci_attach_args *pa);
rbus_tag_t rbus_pccbb_parent_mem(struct device *self,
    struct pci_attach_args *pa);
@


1.1.6.1
log
@Update the SMP branch to -current, this breaks the SMP branch though.
But it will be fixed soonish.  Note, nothing new has happened, this is just
a merge of the trunk into this branch.
@
text
@d1 1
a1 1
/*	$OpenBSD: rbus_machdep.h,v 1.1 2000/04/08 05:50:50 aaron Exp $ */
@


1.1.6.2
log
@Merge in -current from about a week ago
@
text
@d1 1
a1 1
/*	$OpenBSD$ */
d40 2
a41 2
void _bus_space_unmap(bus_space_tag_t, bus_space_handle_t,
			     bus_size_t, bus_addr_t *);
d50 2
a51 2
rbus_tag_t rbus_pccbb_parent_io(struct pci_attach_args *pa);
rbus_tag_t rbus_pccbb_parent_mem(struct pci_attach_args *pa);
@


1.1.6.3
log
@Sync the SMP branch with 3.3
@
text
@d50 2
a51 4
rbus_tag_t rbus_pccbb_parent_io(struct device *self,
    struct pci_attach_args *pa);
rbus_tag_t rbus_pccbb_parent_mem(struct device *self,
    struct pci_attach_args *pa);
@


1.1.6.4
log
@Merge with the trunk
@
text
@d40 3
@


