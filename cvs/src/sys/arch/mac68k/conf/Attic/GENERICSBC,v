head	1.21;
access;
symbols
	OPENBSD_3_6:1.17.0.2
	OPENBSD_3_6_BASE:1.17
	SMP_SYNC_A:1.16
	SMP_SYNC_B:1.16
	OPENBSD_3_5:1.15.0.4
	OPENBSD_3_5_BASE:1.15
	OPENBSD_3_4:1.15.0.2
	OPENBSD_3_4_BASE:1.15
	UBC_SYNC_A:1.15
	OPENBSD_3_3:1.14.0.4
	OPENBSD_3_3_BASE:1.14
	OPENBSD_3_2:1.14.0.2
	OPENBSD_3_2_BASE:1.14
	OPENBSD_3_1:1.12.0.6
	OPENBSD_3_1_BASE:1.12
	UBC_SYNC_B:1.14
	UBC:1.12.0.4
	UBC_BASE:1.12
	OPENBSD_3_0:1.12.0.2
	OPENBSD_3_0_BASE:1.12
	OPENBSD_2_9:1.10.0.16
	OPENBSD_2_9_BASE:1.10
	NIKLAS_UNDEAD:1.10.0.14
	OPENBSD_2_8:1.10.0.12
	OPENBSD_2_8_BASE:1.10
	OPENBSD_2_7:1.10.0.10
	OPENBSD_2_7_BASE:1.10
	SMP:1.10.0.8
	SMP_BASE:1.10
	kame_19991208:1.10
	OPENBSD_2_6:1.10.0.6
	OPENBSD_2_6_BASE:1.10
	OPENBSD_2_5:1.10.0.4
	OPENBSD_2_5_BASE:1.10
	OPENBSD_2_4:1.10.0.2
	OPENBSD_2_4_BASE:1.10
	OPENBSD_2_3:1.9.0.4
	OPENBSD_2_3_BASE:1.9
	OPENBSD_2_2:1.9.0.2
	OPENBSD_2_2_BASE:1.9
	OPENBSD_2_1:1.6.0.2
	OPENBSD_2_1_BASE:1.6;
locks; strict;
comment	@# @;


1.21
date	2004.12.03.06.37.51;	author miod;	state dead;
branches;
next	1.20;

1.20
date	2004.12.02.20.17.49;	author miod;	state Exp;
branches;
next	1.19;

1.19
date	2004.11.25.18.32.06;	author miod;	state Exp;
branches;
next	1.18;

1.18
date	2004.09.16.09.14.03;	author mickey;	state Exp;
branches;
next	1.17;

1.17
date	2004.08.04.20.14.40;	author miod;	state Exp;
branches;
next	1.16;

1.16
date	2004.04.01.22.15.55;	author xsa;	state Exp;
branches;
next	1.15;

1.15
date	2003.05.05.13.59.38;	author miod;	state Exp;
branches;
next	1.14;

1.14
date	2002.06.03.12.04.08;	author deraadt;	state Exp;
branches;
next	1.13;

1.13
date	2002.04.16.15.32.55;	author miod;	state Exp;
branches;
next	1.12;

1.12
date	2001.06.27.05.46.17;	author art;	state Exp;
branches
	1.12.4.1;
next	1.11;

1.11
date	2001.05.08.17.30.39;	author aaron;	state Exp;
branches;
next	1.10;

1.10
date	98.05.08.22.21.35;	author gene;	state Exp;
branches
	1.10.8.1;
next	1.9;

1.9
date	97.10.19.23.40.44;	author briggs;	state Exp;
branches;
next	1.8;

1.8
date	97.06.23.02.26.36;	author gene;	state Exp;
branches;
next	1.7;

1.7
date	97.06.05.18.52.41;	author gene;	state Exp;
branches;
next	1.6;

1.6
date	97.04.14.18.47.50;	author gene;	state Exp;
branches;
next	1.5;

1.5
date	97.04.14.00.27.29;	author briggs;	state Exp;
branches;
next	1.4;

1.4
date	97.04.03.03.53.26;	author briggs;	state Exp;
branches;
next	1.3;

1.3
date	97.03.12.15.59.01;	author briggs;	state Exp;
branches;
next	1.2;

1.2
date	97.03.12.13.24.15;	author briggs;	state Exp;
branches;
next	1.1;

1.1
date	97.03.08.16.16.46;	author briggs;	state Exp;
branches;
next	;

1.10.8.1
date	2001.07.04.10.18.23;	author niklas;	state Exp;
branches;
next	1.10.8.2;

1.10.8.2
date	2003.03.27.23.28.43;	author niklas;	state Exp;
branches;
next	1.10.8.3;

1.10.8.3
date	2003.05.13.19.41.05;	author ho;	state Exp;
branches;
next	1.10.8.4;

1.10.8.4
date	2004.06.05.23.10.51;	author niklas;	state Exp;
branches;
next	;

1.12.4.1
date	2002.06.11.03.36.18;	author art;	state Exp;
branches;
next	1.12.4.2;

1.12.4.2
date	2003.05.19.21.49.42;	author tedu;	state Exp;
branches;
next	;


desc
@@


1.21
log
@Kill mac68k *SBC kernels. Instead, build kernels with both sbc scsi flavours
compiled in, but one disabled, and use config -e to swap them and build
the other kernels; saves valuable compile time.

Add ramdisks into the build (at release time). Since we are moving to a
bsd.rd installation, it is not necessary to put kernels in .tgz files
anymore, so don't bother, and adjust installation script sets information
accordingly.
@
text
@#	$OpenBSD: GENERICSBC,v 1.20 2004/12/02 20:17:49 miod Exp $
#	$NetBSD: GENERIC,v 1.52 1997/01/13 23:34:07 scottr Exp $
#
# GENERICSBC --- our generic kernel using the SBC SCSI driver

machine	mac68k m68k
include "conf/GENERIC"

# Mac-specific options
option		HZ=60		# Macs like 60Hz
option		M68040
option		M68030
option		M68020		# Must have 68851 PMMU
option		FPSP
option		FPU_EMULATE
option		COMPAT_SUNOS	# SunOS m68k binary compatibility
option		DISABLE_ADB_WITH_SERIAL_CONSOLE
#option		MRG_ADB		  # Use ROM-based ADB driver

config		bsd	swap generic
maxusers	32

mainbus0 at root

# on-board I/O
obio0 at mainbus?

adb0	at obio?
asc0	at obio?		# ASC/EASC audio
esp0	at obio?		# SCSI NCR 53C9x
esp1	at obio?		# SCSI NCR 53C9x
intvid0	at obio?		# Internal video hardware
mc*	at obio?		# MACE ethernet on Centris/Quadra 660av
sn*	at obio?		# Internal ethernet
zsc0	at obio?		# Zilog serial chip
zstty*	at zsc?

nubus0		at mainbus?

ae*		at nubus?	# Most Apple Ethernet Cards
macvid*		at nubus?	# NuBus video cards
sn*		at nubus?	# SONIC-based ethernet cards

# Attach grf semantics to all video hardware as it is found
grf*		at intvid?
grf*		at macvid?

# Attach ite semantics to the appropriate grf device
ite0		at grf?

# Use only one of ncrscsi or sbc
#ncrscsi0	at obio?		# SCSI NCR 5380
sbc0		at obio? flags 0x1	# MI NCR 5380 SCSI Bus Controller

scsibus*	at esp?
#scsibus*	at ncrscsi?
scsibus*	at sbc?

sd*	at scsibus?		# SCSI disk drives
st*	at scsibus?		# SCSI tape drives
cd*	at scsibus?		# SCSI CD-ROM drives
ch*	at scsibus?		# SCSI autochangers
ss*	at scsibus?		# SCSI scanners
uk*	at scsibus?		# SCSI unknown
@


1.20
log
@option DISABLE_EXT_CACHE is not used anymore.
@
text
@d1 1
a1 1
#	$OpenBSD: GENERICSBC,v 1.19 2004/11/25 18:32:06 miod Exp $
@


1.19
log
@Move towards a more flexible and generic interrupt system, as well as better
zs behaviour.

From NetBSD; integration work by Martin Reindl
@
text
@d1 1
a1 1
#	$OpenBSD: GENERICSBC,v 1.18 2004/09/16 09:14:03 mickey Exp $
a16 1
option		DISABLE_EXT_CACHE # Don't use IIci external cache
@


1.18
log
@cleanup deafult locators (blah ?); please check that your most hated architecture is still fluffy (;
@
text
@d1 1
a1 1
#	$OpenBSD: GENERICSBC,v 1.17 2004/08/04 20:14:40 miod Exp $
a16 1
option		ZS_CONSOLE_ABORT
@


1.17
log
@Crank maxusers to 32 on m68k GENERIC kernels, and to 16 on m68k installation
media.

The latter is to work around a pmap issue on 680[46]0, for which either
a kluge or a real fix look very ugly.
@
text
@d1 1
a1 1
#	$OpenBSD: GENERICSBC,v 1.16 2004/04/01 22:15:55 xsa Exp $
d38 1
a38 1
zstty*	at zsc? channel ?
d61 6
a66 6
sd*	at scsibus? target ? lun ?	# SCSI disk drives
st*	at scsibus? target ? lun ?	# SCSI tape drives
cd*	at scsibus? target ? lun ?	# SCSI CD-ROM drives
ch*	at scsibus? target ? lun ?	# SCSI autochangers
ss*	at scsibus? target ? lun ?	# SCSI scanners
uk*	at scsibus? target ? lun ?	# SCSI unknown
@


1.16
log
@
typos in comments: hz -> Hz
initial hint from Martin Reindl <mreindl at catai.org>
ok miod@@ jmc@@.
@
text
@d1 1
a1 1
#	$OpenBSD: GENERICSBC,v 1.15 2003/05/05 13:59:38 miod Exp $
d23 1
a23 1
maxusers	16
@


1.15
log
@Write explicit scsibus at controller attachment, rather than scsibus at scsi
attribute.
@
text
@d1 1
a1 1
#	$OpenBSD: GENERICSBC,v 1.14 2002/06/03 12:04:08 deraadt Exp $
d10 1
a10 1
option		HZ=60		# Macs like 60hz
@


1.14
log
@compatiblity -> compatibility
decriptor -> descriptor
authentciated -> authenticated
transmition -> transmission
@
text
@d1 1
a1 1
#	$OpenBSD: GENERICSBC,v 1.13 2002/04/16 15:32:55 miod Exp $
d57 4
a60 1
scsibus*	at scsi?
@


1.13
log
@Using a dull device to probe the FPU is ridiculous, replace it with an early
initialization.
While there, rework the cpu_model string creation so that it gets a more
useful content.
@
text
@d1 1
a1 1
#	$OpenBSD: GENERICSBC,v 1.12 2001/06/27 05:46:17 art Exp $
d16 1
a16 1
option		COMPAT_SUNOS	# SunOS m68k binary compatiblity
@


1.12
log
@UVM is no longer an option.
@
text
@d1 1
a1 1
#	$OpenBSD: GENERICSBC,v 1.11 2001/05/08 17:30:39 aaron Exp $
a25 1
fpu0 at mainbus?
@


1.12.4.1
log
@Sync UBC branch to -current
@
text
@d1 1
a1 1
#	$OpenBSD: GENERICSBC,v 1.12 2001/06/27 05:46:17 art Exp $
d16 1
a16 1
option		COMPAT_SUNOS	# SunOS m68k binary compatibility
d26 1
@


1.12.4.2
log
@sync
@
text
@d1 1
a1 1
#	$OpenBSD$
d57 1
a57 4
scsibus*	at esp?
#scsibus*	at ncrscsi?
scsibus*	at sbc?

@


1.11
log
@Substantial update from NetBSD, most notably gives us UVM support; deraadt@@ ok
@
text
@d1 1
a1 1
#	$OpenBSD: GENERICSBC,v 1.10 1998/05/08 22:21:35 gene Exp $
a20 2

option		UVM		# use the UVM virtual memory system
@


1.10
log
@Add the new mc driver.
@
text
@d1 1
a1 1
#	$OpenBSD: GENERICSBC,v 1.9 1997/10/19 23:40:44 briggs Exp $
d21 2
@


1.10.8.1
log
@Merge in -current from two days ago in the SMP branch.
As usual with merges, they do not indicate progress, so do not hold
your breath for working SMP, and do not mail me and ask about the
state of it.  It has not changed.  There is work ongoing, but very, very
slowly.  The commit is done in parts as to not lock up the tree in too
big chunks at a time.
@
text
@d1 1
a1 1
#	$OpenBSD: GENERICSBC,v 1.10 1998/05/08 22:21:35 gene Exp $
@


1.10.8.2
log
@Sync the SMP branch with 3.3
@
text
@d1 1
a1 1
#	$OpenBSD$
d16 1
a16 1
option		COMPAT_SUNOS	# SunOS m68k binary compatibility
d26 1
@


1.10.8.3
log
@Sync the SMP branch to -current.
@
text
@d1 1
a1 1
#	$OpenBSD: GENERICSBC,v 1.10.8.2 2003/03/27 23:28:43 niklas Exp $
d57 1
a57 4
scsibus*	at esp?
#scsibus*	at ncrscsi?
scsibus*	at sbc?

@


1.10.8.4
log
@Merge with the trunk
@
text
@d1 1
a1 1
#	$OpenBSD$
d10 1
a10 1
option		HZ=60		# Macs like 60Hz
@


1.9
log
@Remove some old, out of date kernel configurations.
Add HZ=60 to GENERIC and GENERICSBC configurations.  Make sure clockreg.h
does not compile unless HZ is defined.  We can't just define it here since
param.c needs to agree with whatever clockreg.h uses.  This has been broken
since June.  Only effect is that the clocks would lose time badly.
@
text
@d1 1
a1 1
#	$OpenBSD: GENERICSBC,v 1.8 1997/06/23 02:26:36 gene Exp $
d36 1
@


1.8
log
@regen: Depend GENERIC* kernels on /sys/conf/GENERIC and move busification
options out of std.mac68k.  This means that people will have to add them to
their local kernel config files.
Please test.
@
text
@d1 1
a1 1
#	$OpenBSD: GENERICSBC,v 1.7 1997/06/05 18:52:41 gene Exp $
d10 1
@


1.7
log
@Since we all seem to be on this kick lately: s/options/option/g.
Also, add some description as to what these are for.
@
text
@d1 1
a1 1
#	$OpenBSD: GENERICSBC,v 1.6 1997/04/14 18:47:50 gene Exp $
d6 2
a7 1
include	"arch/mac68k/conf/std.mac68k"
d9 1
a9 46
maxusers	16

# Standard system option
option		DIAGNOSTIC		# DEBUG for extra kernel debugging
option		KTRACE			# system call tracing support
#option	KGDB			# support for kernel gdb
#option	GDB			# support for normal gdb
#option	KGDBDEV=0xc01, KGDBRATE=38400	# device & baud rate

# Filesystem option
option		FIFO		# POSIX fifo support (in all filesystems)
option		DDB
option		FFS
option		QUOTA		# fast filesystem with user and group quotas
option		MFS		# memory-based filesystem
#option	NFSSERVER	# Sun NFS-compatible filesystem
option		NFSCLIENT	# Sun NFS-compatible filesystem
option		NULLFS		# Null (formerly loop-back) filesystem
option		CD9660		# ISO-9660 w/ RockRidge
option		KERNFS		# kernel data-structure filesystem
option		FDESC		# user file descriptor filesystem
#option	UMAPFS		# uid/gid remapping filesystem
#option	LFS		# Log-based filesystem (still experimental)
#option	PORTAL		# portal filesystem (still experimental)
option		PROCFS		# Process filesystem

option		LKM		# loadable kernel modules

option		SCSI
#option	SCSIDEBUG

# Networking option
option		INET
option		TCP_COMPAT_42	# compatibility with 4.2BSD TCP/IP
option		GATEWAY		# IP packet forwarding
option		IPFILTER
#option	ISO		# OSI networking
#option	TPIP
#option	EON
option		COMPAT_43
option		NS
option		MAPMEM
option		SYSVSHM,SYSVSEM,SYSVMSG
option		PPP_BSDCOMP,PPP_DEFLATE

# Mac-specific option
d15 1
a15 2
option		COMPAT_NOMID
option		COMPAT_SUNOS
d19 1
a19 1
#option	MRG_ADB		  # Use ROM-based ADB driver
d22 1
a22 1
option		GENERIC
d24 2
a25 1
sn*		at obio?	# Internal ethernet
d27 11
a37 2
asc0		at obio?	# ASC/EASC audio
intvid0		at obio?	# Internal video hardware
d41 3
a43 3
ae*		at nubus?
sn*		at obio?
macvid*		at nubus?
a55 3
esp0		at obio?		# SCSI NCR 53C9x
esp1		at obio?		# SCSI NCR 53C9x

a62 9

pseudo-device	pty		16
pseudo-device	bpfilter	12
pseudo-device	vnd		2
pseudo-device	ccd		2
pseudo-device	ppp		2
pseudo-device	loop
pseudo-device	sl
#pseudo-device	ipfilter
@


1.6
log
@Bring our incarnation of John Wittowski's direct adb driver into compatible
state with NetBSD's.  The direct-to-ADB code is now enabled by default.
Using 'options MRG_ADB' will cause the kernel to revert to the 'old standby'
code.
@
text
@d1 1
a1 1
#	$OpenBSD: GENERICSBC,v 1.5 1997/04/14 00:27:29 briggs Exp $
d4 1
a4 1
# GENERIC
d10 55
a64 55
# Standard system options
options		DIAGNOSTIC		# DEBUG for extra kernel debugging
options		KTRACE			# system call tracing support
#options	KGDB			# support for kernel gdb
#options	GDB			# support for normal gdb
#options	KGDBDEV=0xc01, KGDBRATE=38400	# device & baud rate

# Filesystem options
options		FIFO		# POSIX fifo support (in all filesystems)
options		DDB
options		FFS
options		QUOTA		# fast filesystem with user and group quotas
options		MFS		# memory-based filesystem
#options	NFSSERVER	# Sun NFS-compatible filesystem
options		NFSCLIENT	# Sun NFS-compatible filesystem
options		NULLFS		# Null (formerly loop-back) filesystem
options		CD9660		# ISO-9660 w/ RockRidge
options		KERNFS		# kernel data-structure filesystem
options		FDESC		# user file descriptor filesystem
#options	UMAPFS		# uid/gid remapping filesystem
#options	LFS		# Log-based filesystem (still experimental)
#options	PORTAL		# portal filesystem (still experimental)
options		PROCFS		# Process filesystem

options		LKM		# loadable kernel modules

options		SCSI
#options	SCSIDEBUG

# Networking options
options		INET
options		TCP_COMPAT_42	# compatibility with 4.2BSD TCP/IP
options		GATEWAY		# IP packet forwarding
options		IPFILTER
#options	ISO		# OSI networking
#options	TPIP
#options	EON
options		COMPAT_43
options		NS
options		MAPMEM
options		SYSVSHM,SYSVSEM,SYSVMSG
options		PPP_BSDCOMP,PPP_DEFLATE

# Mac-specific options
options		M68040
options		M68030
options		M68020		# Must have 68851 PMMU
options		FPSP
options		FPU_EMULATE
options		COMPAT_NOMID
options		COMPAT_SUNOS
options		ZS_CONSOLE_ABORT
options		DISABLE_EXT_CACHE # Don't use IIci external cache
options		DISABLE_ADB_WITH_SERIAL_CONSOLE
#options	MRG_ADB		  # Use ROM-based ADB driver
d67 1
a67 1
options		GENERIC
@


1.5
log
@options IPFILTER
@
text
@d1 1
a1 1
#	$OpenBSD: GENERICSBC,v 1.4 1997/04/03 03:53:26 briggs Exp $
d64 1
a64 1
options		HWDIRECT
@


1.4
log
@PR#141 from David Leonard <d@@occult.fnarg.net.au> with some small mods by
me.
- Provide option (enabled in GENERIC and GENERICSBC) to disable ADB
  configuration when serial console is enabled.  Old behavior allows
  booting even if ADB probe hangs (Apple had several ways to access
  ADB).
- Configure ite0 differently--don't assume that it's only extant if it
  is the console.
@
text
@d1 1
a1 1
#	$OpenBSD: GENERICSBC,v 1.3 1997/03/12 15:59:01 briggs Exp $
d43 1
@


1.3
log
@Add options LKM.
@
text
@d1 1
a1 1
#	$OpenBSD: GENERICSBC,v 1.2 1997/03/12 13:24:15 briggs Exp $
d62 1
@


1.2
log
@New sn arrangements.
@
text
@d1 1
a1 1
#	$OpenBSD: GENERICSBC,v 1.1 1997/03/08 16:16:46 briggs Exp $
d33 2
@


1.1
log
@Sync with NetBSD of about 4 March.
@
text
@d1 1
a1 1
#	$OpenBSD: GENERIC,v 1.14 1997/01/24 01:35:24 briggs Exp $
d65 1
a65 1
sn0		at obio?	# SONIC ethernet (68040)
d73 1
@
