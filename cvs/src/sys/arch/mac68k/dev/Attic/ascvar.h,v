head	1.8;
access;
symbols
	OPENBSD_5_1_BASE:1.7
	OPENBSD_5_1:1.7.0.28
	OPENBSD_5_0:1.7.0.26
	OPENBSD_5_0_BASE:1.7
	OPENBSD_4_9:1.7.0.24
	OPENBSD_4_9_BASE:1.7
	OPENBSD_4_8:1.7.0.22
	OPENBSD_4_8_BASE:1.7
	OPENBSD_4_7:1.7.0.18
	OPENBSD_4_7_BASE:1.7
	OPENBSD_4_6:1.7.0.20
	OPENBSD_4_6_BASE:1.7
	OPENBSD_4_5:1.7.0.16
	OPENBSD_4_5_BASE:1.7
	OPENBSD_4_4:1.7.0.14
	OPENBSD_4_4_BASE:1.7
	OPENBSD_4_3:1.7.0.12
	OPENBSD_4_3_BASE:1.7
	OPENBSD_4_2:1.7.0.10
	OPENBSD_4_2_BASE:1.7
	OPENBSD_4_1:1.7.0.8
	OPENBSD_4_1_BASE:1.7
	OPENBSD_4_0:1.7.0.6
	OPENBSD_4_0_BASE:1.7
	OPENBSD_3_9:1.7.0.4
	OPENBSD_3_9_BASE:1.7
	OPENBSD_3_8:1.7.0.2
	OPENBSD_3_8_BASE:1.7
	OPENBSD_3_7:1.6.0.6
	OPENBSD_3_7_BASE:1.6
	OPENBSD_3_6:1.6.0.4
	OPENBSD_3_6_BASE:1.6
	SMP_SYNC_A:1.6
	SMP_SYNC_B:1.6
	OPENBSD_3_5:1.6.0.2
	OPENBSD_3_5_BASE:1.6
	OPENBSD_3_4:1.5.0.8
	OPENBSD_3_4_BASE:1.5
	UBC_SYNC_A:1.5
	OPENBSD_3_3:1.5.0.6
	OPENBSD_3_3_BASE:1.5
	OPENBSD_3_2:1.5.0.4
	OPENBSD_3_2_BASE:1.5
	OPENBSD_3_1:1.5.0.2
	OPENBSD_3_1_BASE:1.5
	UBC_SYNC_B:1.5
	UBC:1.4.0.2
	UBC_BASE:1.4
	OPENBSD_3_0:1.3.0.2
	OPENBSD_3_0_BASE:1.3
	OPENBSD_2_9:1.2.0.22
	OPENBSD_2_9_BASE:1.2
	NIKLAS_UNDEAD:1.2.0.20
	OPENBSD_2_8:1.2.0.18
	OPENBSD_2_8_BASE:1.2
	OPENBSD_2_7:1.2.0.16
	OPENBSD_2_7_BASE:1.2
	SMP:1.2.0.14
	SMP_BASE:1.2
	kame_19991208:1.2
	OPENBSD_2_6:1.2.0.12
	OPENBSD_2_6_BASE:1.2
	OPENBSD_2_5:1.2.0.10
	OPENBSD_2_5_BASE:1.2
	OPENBSD_2_4:1.2.0.8
	OPENBSD_2_4_BASE:1.2
	OPENBSD_2_3:1.2.0.6
	OPENBSD_2_3_BASE:1.2
	OPENBSD_2_2:1.2.0.4
	OPENBSD_2_2_BASE:1.2
	OPENBSD_2_1:1.2.0.2
	OPENBSD_2_1_BASE:1.2
	OPENBSD_2_0:1.1.0.2
	OPENBSD_2_0_BASE:1.1;
locks; strict;
comment	@ * @;


1.8
date	2012.06.20.18.23.51;	author matthew;	state dead;
branches;
next	1.7;

1.7
date	2005.04.24.22.25.13;	author martin;	state Exp;
branches;
next	1.6;

1.6
date	2003.09.23.16.51.11;	author millert;	state Exp;
branches;
next	1.5;

1.5
date	2002.03.14.01.26.35;	author millert;	state Exp;
branches;
next	1.4;

1.4
date	2001.11.01.12.13.46;	author art;	state Exp;
branches
	1.4.2.1;
next	1.3;

1.3
date	2001.08.23.08.17.40;	author miod;	state Exp;
branches;
next	1.2;

1.2
date	97.03.08.16.16.49;	author briggs;	state Exp;
branches
	1.2.14.1;
next	1.1;

1.1
date	96.05.26.19.02.05;	author briggs;	state Exp;
branches;
next	;

1.2.14.1
date	2001.10.31.03.01.14;	author nate;	state Exp;
branches;
next	1.2.14.2;

1.2.14.2
date	2001.11.13.21.00.52;	author niklas;	state Exp;
branches;
next	1.2.14.3;

1.2.14.3
date	2002.03.28.10.34.04;	author niklas;	state Exp;
branches;
next	1.2.14.4;

1.2.14.4
date	2004.02.19.10.49.02;	author niklas;	state Exp;
branches;
next	;

1.4.2.1
date	2002.06.11.03.36.18;	author art;	state Exp;
branches;
next	;


desc
@@


1.8
log
@RIP mac68k.  No one loves you anymore.
@
text
@/*	$OpenBSD: ascvar.h,v 1.7 2005/04/24 22:25:13 martin Exp $	*/
/*	$NetBSD: ascvar.h,v 1.3 1997/02/24 05:47:34 scottr Exp $	*/

/*
 * Copyright (C) 1997 Scott Reynolds.  All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. The name of the author may not be used to endorse or promote products
 *    derived from this software without specific prior written permission
 *
 * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
 * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
 * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
 * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
 * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
 * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#define ASCUNIT(d)	((d) & 0x7)

struct asc_softc {
	struct device		sc_dev;
	bus_space_tag_t		sc_tag;
	bus_space_handle_t	sc_handle;
	int			sc_open;
	int			sc_ringing;
	struct timeout		sc_bell_tmo;
};

int	ascopen(dev_t dev, int flag, int mode, struct proc *p);
int	ascclose(dev_t dev, int flag, int mode, struct proc *p);
int	ascread(dev_t, struct uio *, int);
int	ascwrite(dev_t, struct uio *, int);
int	ascioctl(dev_t, int, caddr_t, int, struct proc *p);
int	ascpoll(dev_t dev, int rw, struct proc *p);
paddr_t	ascmmap(dev_t dev, off_t off, int prot);
@


1.7
log
@- switch Scott Reynold's copyright to 3-clause BSD
- do not attach on the MacTV, fix base address on the IIfx (untested)
- no need to count sc->sc_ringing up, just set to 1 if ringing; timeout fix

ok miod@@

from NetBSD
@
text
@d1 1
a1 1
/*	$OpenBSD: ascvar.h,v 1.6 2003/09/23 16:51:11 millert Exp $	*/
@


1.6
log
@Replace select backends with poll backends.  selscan() and pollscan()
now call the poll backend.  With this change we implement greater
poll(2) functionality instead of emulating it via the select backend.
Adapted from NetBSD and including some changes from FreeBSD.
Tested by many, deraadt@@ OK
@
text
@d1 1
a1 1
/*	$OpenBSD: ascvar.h,v 1.5 2002/03/14 01:26:35 millert Exp $	*/
d15 1
a15 5
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 *      This product includes software developed by Scott Reynolds for
 *      the NetBSD Project.
 * 4. The name of the author may not be used to endorse or promote products
@


1.5
log
@First round of __P removal in sys
@
text
@d1 1
a1 1
/*	$OpenBSD: ascvar.h,v 1.4 2001/11/01 12:13:46 art Exp $	*/
d50 1
a50 1
int	ascselect(dev_t dev, int rw, struct proc *p);
@


1.4
log
@Change d_mmap in struct cdevsw from:
        int     (*d_mmap)       __P((dev_t, int, int));
to:
	paddr_t	(*d_mmap)	__P((dev_t, off_t, int));

This allows us to mmap devices past 4GB offsets.
@
text
@d1 1
a1 1
/*	$OpenBSD: ascvar.h,v 1.3 2001/08/23 08:17:40 miod Exp $	*/
d45 7
a51 7
int	ascopen __P((dev_t dev, int flag, int mode, struct proc *p));
int	ascclose __P((dev_t dev, int flag, int mode, struct proc *p));
int	ascread __P((dev_t, struct uio *, int));
int	ascwrite __P((dev_t, struct uio *, int));
int	ascioctl __P((dev_t, int, caddr_t, int, struct proc *p));
int	ascselect __P((dev_t dev, int rw, struct proc *p));
paddr_t	ascmmap __P((dev_t dev, off_t off, int prot));
@


1.4.2.1
log
@Sync UBC branch to -current
@
text
@d1 1
a1 1
/*	$OpenBSD: ascvar.h,v 1.4 2001/11/01 12:13:46 art Exp $	*/
d45 7
a51 7
int	ascopen(dev_t dev, int flag, int mode, struct proc *p);
int	ascclose(dev_t dev, int flag, int mode, struct proc *p);
int	ascread(dev_t, struct uio *, int);
int	ascwrite(dev_t, struct uio *, int);
int	ascioctl(dev_t, int, caddr_t, int, struct proc *p);
int	ascselect(dev_t dev, int rw, struct proc *p);
paddr_t	ascmmap(dev_t dev, off_t off, int prot);
@


1.3
log
@Convert the last old-timeout, tested by beck@@
@
text
@d1 1
a1 1
/*	$OpenBSD: ascvar.h,v 1.2 1997/03/08 16:16:49 briggs Exp $	*/
d51 1
a51 1
int	ascmmap __P((dev_t dev, int off, int prot));
@


1.2
log
@Sync with NetBSD of about 4 March.
@
text
@d1 1
a1 1
/*	$OpenBSD: ascvar.h,v 1.1 1996/05/26 19:02:05 briggs Exp $	*/
d42 1
@


1.2.14.1
log
@Sync the SMP branch to something just after 3.0
@
text
@d1 1
a1 1
/*	$OpenBSD: ascvar.h,v 1.2 1997/03/08 16:16:49 briggs Exp $	*/
a41 1
	struct timeout		sc_bell_tmo;
@


1.2.14.2
log
@Merge in -current
@
text
@d1 1
a1 1
/*	$OpenBSD$	*/
d51 1
a51 1
paddr_t	ascmmap __P((dev_t dev, off_t off, int prot));
@


1.2.14.3
log
@Merge in -current from about a week ago
@
text
@d45 7
a51 7
int	ascopen(dev_t dev, int flag, int mode, struct proc *p);
int	ascclose(dev_t dev, int flag, int mode, struct proc *p);
int	ascread(dev_t, struct uio *, int);
int	ascwrite(dev_t, struct uio *, int);
int	ascioctl(dev_t, int, caddr_t, int, struct proc *p);
int	ascselect(dev_t dev, int rw, struct proc *p);
paddr_t	ascmmap(dev_t dev, off_t off, int prot);
@


1.2.14.4
log
@Merge of current from two weeks agointo the SMP branch
@
text
@d50 1
a50 1
int	ascpoll(dev_t dev, int rw, struct proc *p);
@


1.1
log
@Missed a few files in the previous updates.
@
text
@d1 2
a2 2
/*	$OpenBSD$	*/
/*	$NetBSD: ascvar.h,v 1.1 1996/05/05 06:16:28 briggs Exp $	*/
d5 1
a5 1
 * Copyright (c) 1995 Allen Briggs.  All rights reserved.
d17 2
a18 1
 *	This product includes software developed by Allen Briggs.
d20 1
a20 1
 *    derived from this software without specific prior written permission.
d34 17
a50 4
int	asc_setbellparams __P((int freq, int length, int volume));
int	asc_getbellparams __P((int *freq, int *length, int *volume));
void	asc_bellstop __P((int param));
int	asc_ringbell __P((void));
@
