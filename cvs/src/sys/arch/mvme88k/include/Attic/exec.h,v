head	1.14;
access;
symbols
	OPENBSD_5_5:1.13.0.42
	OPENBSD_5_5_BASE:1.13
	OPENBSD_5_4:1.13.0.38
	OPENBSD_5_4_BASE:1.13
	OPENBSD_5_3:1.13.0.36
	OPENBSD_5_3_BASE:1.13
	OPENBSD_5_2:1.13.0.34
	OPENBSD_5_2_BASE:1.13
	OPENBSD_5_1_BASE:1.13
	OPENBSD_5_1:1.13.0.32
	OPENBSD_5_0:1.13.0.30
	OPENBSD_5_0_BASE:1.13
	OPENBSD_4_9:1.13.0.28
	OPENBSD_4_9_BASE:1.13
	OPENBSD_4_8:1.13.0.26
	OPENBSD_4_8_BASE:1.13
	OPENBSD_4_7:1.13.0.22
	OPENBSD_4_7_BASE:1.13
	OPENBSD_4_6:1.13.0.24
	OPENBSD_4_6_BASE:1.13
	OPENBSD_4_5:1.13.0.20
	OPENBSD_4_5_BASE:1.13
	OPENBSD_4_4:1.13.0.18
	OPENBSD_4_4_BASE:1.13
	OPENBSD_4_3:1.13.0.16
	OPENBSD_4_3_BASE:1.13
	OPENBSD_4_2:1.13.0.14
	OPENBSD_4_2_BASE:1.13
	OPENBSD_4_1:1.13.0.12
	OPENBSD_4_1_BASE:1.13
	OPENBSD_4_0:1.13.0.10
	OPENBSD_4_0_BASE:1.13
	OPENBSD_3_9:1.13.0.8
	OPENBSD_3_9_BASE:1.13
	OPENBSD_3_8:1.13.0.6
	OPENBSD_3_8_BASE:1.13
	OPENBSD_3_7:1.13.0.4
	OPENBSD_3_7_BASE:1.13
	OPENBSD_3_6:1.13.0.2
	OPENBSD_3_6_BASE:1.13
	SMP_SYNC_A:1.13
	SMP_SYNC_B:1.13
	OPENBSD_3_5:1.11.0.2
	OPENBSD_3_5_BASE:1.11
	OPENBSD_3_4:1.10.0.12
	OPENBSD_3_4_BASE:1.10
	UBC_SYNC_A:1.10
	OPENBSD_3_3:1.10.0.10
	OPENBSD_3_3_BASE:1.10
	OPENBSD_3_2:1.10.0.8
	OPENBSD_3_2_BASE:1.10
	OPENBSD_3_1:1.10.0.6
	OPENBSD_3_1_BASE:1.10
	UBC_SYNC_B:1.10
	UBC:1.10.0.4
	UBC_BASE:1.10
	OPENBSD_3_0:1.10.0.2
	OPENBSD_3_0_BASE:1.10
	OPENBSD_2_9:1.9.0.2
	OPENBSD_2_9_BASE:1.9
	OPENBSD_2_8:1.7.0.8
	OPENBSD_2_8_BASE:1.7
	OPENBSD_2_7:1.7.0.6
	OPENBSD_2_7_BASE:1.7
	SMP:1.7.0.4
	SMP_BASE:1.7
	kame_19991208:1.7
	OPENBSD_2_6:1.7.0.2
	OPENBSD_2_6_BASE:1.7
	OPENBSD_2_5:1.6.0.2
	OPENBSD_2_5_BASE:1.6
	OPENBSD_2_4:1.5.0.8
	OPENBSD_2_4_BASE:1.5
	OPENBSD_2_3:1.5.0.6
	OPENBSD_2_3_BASE:1.5
	OPENBSD_2_2:1.5.0.4
	OPENBSD_2_2_BASE:1.5
	OPENBSD_2_1:1.5.0.2
	OPENBSD_2_1_BASE:1.5
	mvme88kport:1.1.1.2
	OPENBSD_2_0:1.2.0.2
	OPENBSD_2_0_BASE:1.2
	first_1:1.1.1.1;
locks; strict;
comment	@ * @;


1.14
date	2014.03.18.22.36.36;	author miod;	state dead;
branches;
next	1.13;

1.13
date	2004.04.26.14.31.11;	author miod;	state Exp;
branches;
next	1.12;

1.12
date	2004.04.26.12.34.05;	author miod;	state Exp;
branches;
next	1.11;

1.11
date	2003.10.11.22.08.57;	author miod;	state Exp;
branches;
next	1.10;

1.10
date	2001.08.12.12.03.02;	author heko;	state Exp;
branches;
next	1.9;

1.9
date	2001.01.22.14.51.05;	author art;	state Exp;
branches;
next	1.8;

1.8
date	2001.01.14.20.25.24;	author smurph;	state Exp;
branches;
next	1.7;

1.7
date	99.05.29.04.41.45;	author smurph;	state Exp;
branches
	1.7.4.1;
next	1.6;

1.6
date	99.02.09.06.36.26;	author smurph;	state Exp;
branches;
next	1.5;

1.5
date	97.03.03.20.21.00;	author rahnds;	state Exp;
branches;
next	1.4;

1.4
date	97.03.03.19.07.30;	author rahnds;	state dead;
branches;
next	1.3;

1.3
date	96.12.23.02.42.32;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	96.05.29.03.05.02;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.10.54.21;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.10.54.21;	author deraadt;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	97.03.03.19.31.49;	author rahnds;	state Exp;
branches;
next	;

1.7.4.1
date	2001.04.18.16.11.17;	author niklas;	state Exp;
branches;
next	1.7.4.2;

1.7.4.2
date	2001.10.31.03.01.18;	author nate;	state Exp;
branches;
next	1.7.4.3;

1.7.4.3
date	2004.02.19.10.49.07;	author niklas;	state Exp;
branches;
next	1.7.4.4;

1.7.4.4
date	2004.06.05.23.09.50;	author niklas;	state Exp;
branches;
next	;


desc
@@


1.14
log
@Retire hp300, mvme68k and mvme88k ports. These ports have no users, keeping
this hardware alive is becoming increasingly difficult, and I should heed the
message sent by the three disks which have died on me over the last few days.

Noone sane will mourn these ports anyway. So long, and thanks for the fish.
@
text
@/* $OpenBSD: exec.h,v 1.13 2004/04/26 14:31:11 miod Exp $ */
/* public domain */
#include <m88k/exec.h>
@


1.13
log
@Fix RCSID
@
text
@d1 1
a1 1
/* $OpenBSD$ */
@


1.12
log
@Start factorizing luna88k and mvme88k common parts.
For now, include files only.
@
text
@d1 1
a1 1
/* $OpenBSD */
@


1.11
log
@Nuke trailing whitespace.
@
text
@d1 3
a3 32
/*	$OpenBSD: exec.h,v 1.10 2001/08/12 12:03:02 heko Exp $ */
#ifndef __MACHINE_EXEC_H__
#define __MACHINE_EXEC_H__

#define __LDPGSZ        4096

struct relocation_info_m88k {
        unsigned int r_address;         /* offset in text or data segment */
        unsigned int r_symbolnum : 24,  /* ordinal number of add symbol */
                        r_extern :  1,  /* 1 if need to add symbol to value */
                        r_baserel : 1,
                        r_pcrel : 1,
                        r_jmptable : 1,
                        r_type : 4;

        int r_addend;
};
#define relocation_info relocation_info_m88k

#define ARCH_ELFSIZE		32

#define ELF_TARG_CLASS		ELFCLASS32
#define ELF_TARG_DATA		ELFDATA2MSB
#define ELF_TARG_MACH		EM_88K

#define _NLIST_DO_AOUT
#define _NLIST_DO_ELF

#define _KERN_DO_AOUT
#define _KERN_DO_ELF

#endif /* __MACHINE_EXEC_H__ */
@


1.10
log
@#(endif|else) foo is incorrect, make it #endif /* foo */
deraadt@@ ok
@
text
@d1 1
a1 1
/*	$OpenBSD: exec.h,v 1.9 2001/01/22 14:51:05 art Exp $ */
d7 1
a7 1
struct relocation_info_m88k { 
@


1.9
log
@Define ARCH_ELFSIZE that is the default elf size on this arch.
@
text
@d1 1
a1 1
/*	$OpenBSD: exec.h,v 1.8 2001/01/14 20:25:24 smurph Exp $ */
d32 1
a32 1
#endif __MACHINE_EXEC_H__
@


1.8
log
@Complete move to UVM virtual memory system.  More header fixes.
@
text
@d1 1
a1 1
/*	$OpenBSD: exec.h,v 1.7 1999/05/29 04:41:45 smurph Exp $ */
d19 2
@


1.7
log
@Added vme bus device drivers. MVME328, MVME376, MVME332
@
text
@d1 3
a3 3
/*	$OpenBSD: exec.h,v 1.6 1999/02/09 06:36:26 smurph Exp $ */
#ifndef _MACHINE_EXEC_H_
#define _MACHINE_EXEC_H_ 
d30 1
a30 1
#endif _MACHINE_EXEC_H_ 
@


1.7.4.1
log
@Update the SMP branch to -current, this breaks the SMP branch though.
But it will be fixed soonish.  Note, nothing new has happened, this is just
a merge of the trunk into this branch.
@
text
@d1 3
a3 3
/*	$OpenBSD: exec.h,v 1.9 2001/01/22 14:51:05 art Exp $ */
#ifndef __MACHINE_EXEC_H__
#define __MACHINE_EXEC_H__
a19 2
#define ARCH_ELFSIZE		32

d30 1
a30 1
#endif __MACHINE_EXEC_H__
@


1.7.4.2
log
@Sync the SMP branch to something just after 3.0
@
text
@d1 1
a1 1
/*	$OpenBSD: exec.h,v 1.7.4.1 2001/04/18 16:11:17 niklas Exp $ */
d32 1
a32 1
#endif /* __MACHINE_EXEC_H__ */
@


1.7.4.3
log
@Merge of current from two weeks agointo the SMP branch
@
text
@d1 1
a1 1
/*	$OpenBSD$ */
d7 1
a7 1
struct relocation_info_m88k {
@


1.7.4.4
log
@Merge with the trunk
@
text
@d1 32
a32 3
/* $OpenBSD$ */
/* public domain */
#include <m88k/exec.h>
@


1.6
log
@Added kernel support for user debugging.  Fixed file ID's
@
text
@d1 1
a1 1
/*	$OpenBSD: exec.h,v 1.1 1998/12/15 04:45:50 smurph Exp $ */
d20 3
a22 1
#define	_NLIST_DO_AOUT
d24 5
a28 1
#define	_KERN_DO_AOUT
@


1.5
log
@Cleanup after import. This also seems to bring up the current version.
@
text
@d1 1
@


1.4
log
@This is a remove to get rid of the old mvme88k port which was incomplete
to replace it with a working version. The kernel compiles and works
at least.  The new version will be imported shortly.
@
text
@d1 2
a2 2
#ifndef __A_OUT_GNU_H__
#define __A_OUT_GNU_H__
d4 1
a4 1
#include <machine/endian.h>
d6 8
a13 3
#ifdef	__cplusplus
extern "C" {
#endif
d15 1
a15 61
#define __GNU_EXEC_MACROS__

#ifndef __STRUCT_EXEC_OVERRIDE__

struct exec
{
  unsigned a_midmag;		/* Use macros N_MAGIC, etc for access */
#define a_info a_midmag
  unsigned a_text;		/* size of text, in bytes */
  unsigned a_data;		/* size of data, in bytes */
  unsigned a_bss;		/* size of uninitialized data area, in bytes */
  unsigned a_syms;		/* length of symbol table data, in bytes */
  unsigned a_entry;		/* start address */
  unsigned a_trsize;		/* size of reloc info for text, in bytes */
  unsigned a_drsize;		/* size of reloc info for data, in bytes */
};

#endif /* __STRUCT_EXEC_OVERRIDE__ */

#define	MID_ZERO	0	/* unknown - implementation dependent */
#define	MID_SUN010	1	/* sun 68010/68020 binary */
#define	MID_SUN020	2	/* sun 68020-only binary */
#define	MID_PC386	100	/* 386 PC binary. (so quoth BFD) */
#define	MID_HP200	200	/* hp200 (68010) BSD binary */
#define	MID_I386	134	/* i386 BSD binary */
#define	MID_M68K	135	/* m68k BSD binary with 8K page sizes */
#define	MID_M68K4K	136	/* m68k BSD binary with 4K page sizes */
#define	MID_NS32532	137	/* ns32532 */
#define	MID_SPARC	138	/* sparc */
#define	MID_PMAX	139	/* pmax */
#define	MID_VAX		140	/* vax */
#define	MID_ALPHA	141	/* Alpha BSD binary */
#define	MID_M88K	151	/* m88k BSD binary */
#define	MID_HP300	300	/* hp300 (68020+68881) BSD binary */
#define	MID_HPUX	0x20C	/* hp200/300 HP-UX binary */

/* these go in the N_MACHTYPE field */
enum machine_type {
#if defined (M_OLDSUN2)
  M__OLDSUN2 = M_OLDSUN2,
#else
  M_OLDSUN2 = 0,
#endif
#if defined (M_68010)
  M__68010 = M_68010,
#else
  M_68010 = 1,
#endif
#if defined (M_68020)
  M__68020 = M_68020,
#else
  M_68020 = 2,
#endif
#if defined (M_SPARC)
  M__SPARC = M_SPARC,
#else
  M_SPARC = 3,
#endif
  /* skip a bunch so we don't run into any of sun's numbers */
  M_386 = 100,
  M_88K	= 151
d17 1
d19 1
a19 260
#define	N_GETMAGIC(ex) \
    ((ex).a_midmag & 0xffff)

#define N_GETMID(ex) \
	(((ex).a_midmag >> 16)&0xff)
#if !defined (N_MAGIC)
#define N_MAGIC(exec) ((exec).a_info & 0xffff)
#endif
#define N_MACHTYPE(exec) ((enum machine_type)(((exec).a_info >> 16) & 0xff))
#define N_FLAGS(exec) (((exec).a_info >> 24) & 0xff)
#define N_SET_INFO(exec, magic, type, flags) \
	((exec).a_info = ((magic) & 0xffff) \
	 | (((int)(type) & 0xff) << 16) \
	 | (((flags) & 0xff) << 24))
#define N_SET_MAGIC(exec, magic) \
	((exec).a_info = (((exec).a_info & 0xffff0000) | ((magic) & 0xffff)))

#define N_SET_MACHTYPE(exec, machtype) \
	((exec).a_info = \
	 ((exec).a_info&0xff00ffff) | ((((int)(machtype))&0xff) << 16))

#define N_SET_FLAGS(exec, flags) \
	((exec).a_info = \
	 ((exec).a_info&0x00ffffff) | (((flags) & 0xff) << 24))

#ifndef OMAGIC
/* Code indicating object file or impure executable.  */
#define OMAGIC 0407
/* Code indicating pure executable.  */
#define NMAGIC 0410
/* Code indicating demand-paged executable.  */
#define ZMAGIC 0413
#define	QMAGIC		0314	/* "compact" demand load format; deprecated */
#endif /* not OMAGIC */

#if !defined (N_BADMAG)
#define N_BADMAG(x)					\
 (N_MAGIC(x) != OMAGIC && N_MAGIC(x) != NMAGIC		\
  && N_MAGIC(x) != ZMAGIC)
#endif

#define _N_BADMAG(x)					\
 (N_MAGIC(x) != OMAGIC && N_MAGIC(x) != NMAGIC		\
  && N_MAGIC(x) != ZMAGIC)

#if !defined(sparc) && !defined(m88k)
#define _N_HDROFF(x) (SEGMENT_SIZE - sizeof (struct exec))
#else
#define _N_HDROFF(x) (- sizeof (struct exec))
#endif

#if !defined (N_TXTOFF)
#define N_TXTOFF(x) \
 (N_MAGIC(x) == ZMAGIC ? _N_HDROFF((x)) + sizeof (struct exec) : sizeof (struct exec))
#endif

#if !defined (N_DATOFF)
#define N_DATOFF(x) (N_TXTOFF(x) + (x).a_text)
#endif

#if !defined (N_TRELOFF)
#define N_TRELOFF(x) (N_DATOFF(x) + (x).a_data)
#endif

#if !defined (N_DRELOFF)
#define N_DRELOFF(x) (N_TRELOFF(x) + (x).a_trsize)
#endif

#if !defined (N_SYMOFF)
#define N_SYMOFF(x) (N_DRELOFF(x) + (x).a_drsize)
#endif

#if !defined (N_STROFF)
#define N_STROFF(x) (N_SYMOFF(x) + (x).a_syms)
#endif

/* Address of text segment in memory after it is loaded.  */
#if !defined (N_TXTADDR)
#define N_TXTADDR(x) 0
#endif

/* Address of data segment in memory after it is loaded.
   Note that it is up to you to define SEGMENT_SIZE
   on machines not listed here.  */
#if	defined (hp300) || defined (mips) || defined(m88k)
#ifndef PAGE_SIZE
#define	PAGE_SIZE	4096
#endif /* PAGE_SIZE */
#endif
#if	defined (sparc) || defined (NeXT)
#define	PAGE_SIZE	0x2000
#endif
#if	defined (sony) || (defined (sun) && defined (mc68000))
#define	SEGMENT_SIZE	0x2000
#endif	/* Sony or 68k Sun.  */
#ifdef is68k
#define SEGMENT_SIZE 0x20000
#endif
#if defined(m68k) && defined(PORTAR)
#define PAGE_SIZE 0x400
#endif
#ifndef	SEGMENT_SIZE
/* This used to be first in this paragraph and under:
   if (defined(vax) || defined(hp300) || defined(pyr) || defined(sparc) \
     || (defined(m68k) && defined(PORTAR)) \
     || defined (NeXT) || defined (mips)) */
#define SEGMENT_SIZE PAGE_SIZE
#endif
#ifndef	PAGE_SIZE
/* This value is for i386-minix, but that has no predefine.
   Making it default will only cause confusion on machines
   which have no proper value defined.  */
#define	PAGE_SIZE 16
#endif

#define	PAGSIZ	PAGE_SIZE
#define	SEGSIZ	SEGMENT_SIZE
#if !defined(__LDPGSZ)
#define __LDPGSZ	PAGE_SIZE
#endif /* __LDPGSZ */

#define _N_SEGMENT_ROUND(x) (((x) + SEGMENT_SIZE - 1) & ~(SEGMENT_SIZE - 1))

#define _N_TXTENDADDR(x) (N_TXTADDR(x)+(x).a_text)

#ifndef N_DATADDR
#define N_DATADDR(x) \
    (N_MAGIC(x)==OMAGIC? (_N_TXTENDADDR(x)) \
     : (_N_SEGMENT_ROUND (_N_TXTENDADDR(x))))
#endif

/* Address of bss segment in memory after it is loaded.  */
#if !defined (N_BSSADDR)
#define N_BSSADDR(x) (N_DATADDR(x) + (x).a_data)
#endif

#if 0
#if !defined (N_NLIST_DECLARED)
struct nlist {
  union {
    char *n_name;
    struct nlist *n_next;
    long n_strx;
  } n_un;
  unsigned char n_type;
  char n_other;
  short n_desc;
  unsigned long n_value;
};
#endif /* no N_NLIST_DECLARED.  */
#endif /* 0 */

#if !defined (N_UNDF)
#define N_UNDF 0
#endif
#if !defined (N_ABS)
#define N_ABS 2
#endif
#if !defined (N_TEXT)
#define N_TEXT 4
#endif
#if !defined (N_DATA)
#define N_DATA 6
#endif
#if !defined (N_BSS)
#define N_BSS 8
#endif
#if !defined (N_COMM)
#define N_COMM 18
#endif
#if !defined (N_FN)
#define N_FN 15
#endif

#if !defined (N_EXT)
#define N_EXT 1
#endif
#if !defined (N_TYPE)
#define N_TYPE 036
#endif
#if !defined (N_STAB)
#define N_STAB 0340
#endif

/* The following type indicates the definition of a symbol as being
   an indirect reference to another symbol.  The other symbol
   appears as an undefined reference, immediately following this symbol.

   Indirection is asymmetrical.  The other symbol's value will be used
   to satisfy requests for the indirect symbol, but not vice versa.
   If the other symbol does not have a definition, libraries will
   be searched to find a definition.  */
#define N_INDR 0xa

/* The following symbols refer to set elements.
   All the N_SET[ATDB] symbols with the same name form one set.
   Space is allocated for the set in the text section, and each set
   element's value is stored into one word of the space.
   The first word of the space is the length of the set (number of elements).

   The address of the set is made into an N_SETV symbol
   whose name is the same as the name of the set.
   This symbol acts like a N_DATA global symbol
   in that it can satisfy undefined external references.  */

/* These appear as input to LD, in a .o file.  */
#define	N_SETA	0x14		/* Absolute set element symbol */
#define	N_SETT	0x16		/* Text set element symbol */
#define	N_SETD	0x18		/* Data set element symbol */
#define	N_SETB	0x1A		/* Bss set element symbol */

/* This is output from LD.  */
#define N_SETV	0x1C		/* Pointer to set vector in data area.  */

#if !defined (N_RELOCATION_INFO_DECLARED)
/* This structure describes a single relocation to be performed.
   The text-relocation section of the file is a vector of these structures,
   all of which apply to the text section.
   Likewise, the data-relocation section applies to the data section.  */

struct relocation_info
{
  /* Address (within segment) to be relocated.  */
  int r_address;
  /* The meaning of r_symbolnum depends on r_extern.  */
  unsigned int r_symbolnum:24;
  /* Nonzero means value is a pc-relative offset
     and it should be relocated for changes in its own address
     as well as for changes in the symbol or section specified.  */
  unsigned int r_pcrel:1;
  /* Length (as exponent of 2) of the field to be relocated.
     Thus, a value of 2 indicates 1<<2 bytes.  */
  unsigned int r_length:2;
  /* 1 => relocate with value of symbol.
          r_symbolnum is the index of the symbol
	  in file's the symbol table.
     0 => relocate with the address of a segment.
          r_symbolnum is N_TEXT, N_DATA, N_BSS or N_ABS
	  (the N_EXT bit may be set also, but signifies nothing).  */
  unsigned int r_extern:1;
  /* Four bits that aren't used, but when writing an object file
     it is desirable to clear them.  */
  unsigned int r_pad:4;
};
#endif /* no N_RELOCATION_INFO_DECLARED.  */
#define M_32_SWAP(x)	(x)
#define M_16_SWAP(x)	(x)
#define M_8_SWAP(x)	(x)


#ifdef	__cplusplus
}
#endif

#define ELF_TARG_CLASS		ELFCLASS32
#define ELF_TARG_DATA		ELFDATA2MSB
#define ELF_TARG_MACH		EM_88K

#define _NLIST_DO_AOUT
#define _NLIST_DO_ELF
d21 1
a21 2
#define _KERN_DO_AOUT
#define _KERN_DO_ELF
d23 1
a23 1
#endif /* __A_OUT_GNU_H__ */
@


1.3
log
@use _{NLIST,KERN}_DO_{AOUT,ELF,ECOFF} to select binary types
@
text
@@


1.2
log
@enable ELF/a.out/ECOFF in machine/exec.h
@
text
@d331 5
a335 2
#define DO_AOUT			/* support a.out */
#define DO_ELF			/* support ELF */
@


1.1
log
@Initial revision
@
text
@d327 7
@


1.1.1.1
log
@initial 88k import; code by nivas and based on mach luna88k
@
text
@@


1.1.1.2
log
@Third try at importing the mvme88k port. This is a working kernel
from nivas.
Userland and compiler still need to be worked on.
Make certain what directory the import is done from.
@
text
@d1 2
a2 2
#ifndef _MACHINE_EXEC_H_
#define _MACHINE_EXEC_H_ 
d4 1
a4 1
#define __LDPGSZ        4096
d6 3
a8 8
struct relocation_info_m88k { 
        unsigned int r_address;         /* offset in text or data segment */
        unsigned int r_symbolnum : 24,  /* ordinal number of add symbol */
                        r_extern :  1,  /* 1 if need to add symbol to value */
                        r_baserel : 1,
                        r_pcrel : 1,
                        r_jmptable : 1,
                        r_type : 4;
d10 306
a315 1
        int r_addend;
d317 4
a320 1
#define relocation_info relocation_info_m88k
a321 1
#define	_NLIST_DO_AOUT
d323 3
a325 1
#define	_KERN_DO_AOUT
d327 1
a327 1
#endif _MACHINE_EXEC_H_ 
@
