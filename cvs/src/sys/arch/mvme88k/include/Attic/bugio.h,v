head	1.19;
access;
symbols
	OPENBSD_5_5:1.18.0.6
	OPENBSD_5_5_BASE:1.18
	OPENBSD_5_4:1.18.0.2
	OPENBSD_5_4_BASE:1.18
	OPENBSD_5_3:1.17.0.8
	OPENBSD_5_3_BASE:1.17
	OPENBSD_5_2:1.17.0.6
	OPENBSD_5_2_BASE:1.17
	OPENBSD_5_1_BASE:1.17
	OPENBSD_5_1:1.17.0.4
	OPENBSD_5_0:1.17.0.2
	OPENBSD_5_0_BASE:1.17
	OPENBSD_4_9:1.16.0.20
	OPENBSD_4_9_BASE:1.16
	OPENBSD_4_8:1.16.0.18
	OPENBSD_4_8_BASE:1.16
	OPENBSD_4_7:1.16.0.14
	OPENBSD_4_7_BASE:1.16
	OPENBSD_4_6:1.16.0.16
	OPENBSD_4_6_BASE:1.16
	OPENBSD_4_5:1.16.0.12
	OPENBSD_4_5_BASE:1.16
	OPENBSD_4_4:1.16.0.10
	OPENBSD_4_4_BASE:1.16
	OPENBSD_4_3:1.16.0.8
	OPENBSD_4_3_BASE:1.16
	OPENBSD_4_2:1.16.0.6
	OPENBSD_4_2_BASE:1.16
	OPENBSD_4_1:1.16.0.4
	OPENBSD_4_1_BASE:1.16
	OPENBSD_4_0:1.16.0.2
	OPENBSD_4_0_BASE:1.16
	OPENBSD_3_9:1.15.0.2
	OPENBSD_3_9_BASE:1.15
	OPENBSD_3_8:1.14.0.8
	OPENBSD_3_8_BASE:1.14
	OPENBSD_3_7:1.14.0.6
	OPENBSD_3_7_BASE:1.14
	OPENBSD_3_6:1.14.0.4
	OPENBSD_3_6_BASE:1.14
	SMP_SYNC_A:1.14
	SMP_SYNC_B:1.14
	OPENBSD_3_5:1.14.0.2
	OPENBSD_3_5_BASE:1.14
	OPENBSD_3_4:1.13.0.8
	OPENBSD_3_4_BASE:1.13
	UBC_SYNC_A:1.13
	OPENBSD_3_3:1.13.0.6
	OPENBSD_3_3_BASE:1.13
	OPENBSD_3_2:1.13.0.4
	OPENBSD_3_2_BASE:1.13
	OPENBSD_3_1:1.13.0.2
	OPENBSD_3_1_BASE:1.13
	UBC_SYNC_B:1.13
	UBC:1.11.0.4
	UBC_BASE:1.11
	OPENBSD_3_0:1.11.0.2
	OPENBSD_3_0_BASE:1.11
	OPENBSD_2_9:1.8.0.2
	OPENBSD_2_9_BASE:1.8
	OPENBSD_2_8:1.6.0.10
	OPENBSD_2_8_BASE:1.6
	OPENBSD_2_7:1.6.0.8
	OPENBSD_2_7_BASE:1.6
	SMP:1.6.0.6
	SMP_BASE:1.6
	kame_19991208:1.6
	OPENBSD_2_6:1.6.0.4
	OPENBSD_2_6_BASE:1.6
	OPENBSD_2_5:1.6.0.2
	OPENBSD_2_5_BASE:1.6
	OPENBSD_2_4:1.3.0.8
	OPENBSD_2_4_BASE:1.3
	OPENBSD_2_3:1.3.0.6
	OPENBSD_2_3_BASE:1.3
	OPENBSD_2_2:1.3.0.4
	OPENBSD_2_2_BASE:1.3
	OPENBSD_2_1:1.3.0.2
	OPENBSD_2_1_BASE:1.3
	mvme88kport:1.1.1.2
	OPENBSD_2_0:1.1.1.1.0.2
	OPENBSD_2_0_BASE:1.1.1.1
	first_1:1.1.1.1;
locks; strict;
comment	@ * @;


1.19
date	2014.03.18.22.36.36;	author miod;	state dead;
branches;
next	1.18;

1.18
date	2013.05.14.20.30.47;	author miod;	state Exp;
branches;
next	1.17;

1.17
date	2011.03.23.16.54.36;	author pirofti;	state Exp;
branches;
next	1.16;

1.16
date	2006.05.02.21.43.08;	author miod;	state Exp;
branches;
next	1.15;

1.15
date	2005.12.11.21.45.31;	author miod;	state Exp;
branches;
next	1.14;

1.14
date	2004.01.04.01.14.06;	author miod;	state Exp;
branches;
next	1.13;

1.13
date	2002.03.14.01.26.39;	author millert;	state Exp;
branches;
next	1.12;

1.12
date	2002.03.05.22.11.40;	author miod;	state Exp;
branches;
next	1.11;

1.11
date	2001.09.28.20.45.48;	author miod;	state Exp;
branches
	1.11.4.1;
next	1.10;

1.10
date	2001.08.24.22.46.25;	author miod;	state Exp;
branches;
next	1.9;

1.9
date	2001.08.12.12.03.02;	author heko;	state Exp;
branches;
next	1.8;

1.8
date	2001.03.09.05.44.40;	author smurph;	state Exp;
branches;
next	1.7;

1.7
date	2001.01.14.20.25.23;	author smurph;	state Exp;
branches;
next	1.6;

1.6
date	99.04.11.03.26.28;	author smurph;	state Exp;
branches
	1.6.6.1;
next	1.5;

1.5
date	99.02.09.06.36.25;	author smurph;	state Exp;
branches;
next	1.4;

1.4
date	98.12.15.04.45.49;	author smurph;	state Exp;
branches;
next	1.3;

1.3
date	97.03.03.20.20.51;	author rahnds;	state Exp;
branches;
next	1.2;

1.2
date	97.03.03.19.07.23;	author rahnds;	state dead;
branches;
next	1.1;

1.1
date	95.10.18.10.54.24;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.10.54.24;	author deraadt;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	97.03.03.19.31.42;	author rahnds;	state Exp;
branches;
next	;

1.6.6.1
date	2001.04.18.16.11.14;	author niklas;	state Exp;
branches;
next	1.6.6.2;

1.6.6.2
date	2001.10.31.03.01.18;	author nate;	state Exp;
branches;
next	1.6.6.3;

1.6.6.3
date	2002.03.06.02.04.44;	author niklas;	state Exp;
branches;
next	1.6.6.4;

1.6.6.4
date	2002.03.28.10.36.02;	author niklas;	state Exp;
branches;
next	1.6.6.5;

1.6.6.5
date	2004.02.19.10.49.07;	author niklas;	state Exp;
branches;
next	;

1.11.4.1
date	2002.06.11.03.37.10;	author art;	state Exp;
branches;
next	;


desc
@@


1.19
log
@Retire hp300, mvme68k and mvme88k ports. These ports have no users, keeping
this hardware alive is becoming increasingly difficult, and I should heed the
message sent by the three disks which have died on me over the last few days.

Noone sane will mourn these ports anyway. So long, and thanks for the fish.
@
text
@/*	$OpenBSD: bugio.h,v 1.18 2013/05/14 20:30:47 miod Exp $ */

#ifndef _MACHINE_BUGIO_H_
#define _MACHINE_BUGIO_H_

#include <machine/prom.h>

void	buginit(void);
char	buginchr(void);
void	bugoutchr(int);
void	bugreturn(void);
void	bugbrdid(struct mvmeprom_brdid *);
void	bugdiskrd(struct mvmeprom_dskio *);
int	spin_cpu(cpuid_t, vaddr_t);

#endif /* _MACHINE_BUGIO_H_ */
@


1.18
log
@Older BUG version do not implement the `out cr/lf' BUG system call, and, worse,
do not return from it, for extra fun. The good thing is that the existing
kernel console code logic issueing \n as \r\n works nicely with the regular
BUG output routines, so there was no reason to use this particular BUG routine
in the first place.
@
text
@d1 1
a1 1
/*	$OpenBSD: bugio.h,v 1.17 2011/03/23 16:54:36 pirofti Exp $ */
@


1.17
log
@Normalize sentinel. Use _MACHINE_*_H_ and _<ARCH>_*_H_ properly and consitently.

Discussed and okay drahn@@. Okay deraadt@@.
@
text
@d1 1
a1 1
/*	$OpenBSD: bugio.h,v 1.16 2006/05/02 21:43:08 miod Exp $ */
a9 1
void	bugpcrlf(void);
@


1.16
log
@Wave goodbye to bugtty on mvme88k as well.
@
text
@d1 1
a1 1
/*	$OpenBSD: bugio.h,v 1.15 2005/12/11 21:45:31 miod Exp $ */
d3 2
a4 2
#ifndef __MACHINE_BUGIO_H__
#define __MACHINE_BUGIO_H__
d17 1
a17 1
#endif /* __MACHINE_BUGIO_H__ */
@


1.15
log
@Work in progress SMP code; mvme88k boards can spin up secondary CPUs,
kernel boots single user. Still a lot of polishing and bugfixing to do.
@
text
@d1 1
a1 1
/*	$OpenBSD: bugio.h,v 1.14 2004/01/04 01:14:06 miod Exp $ */
a5 2
#include <sys/cdefs.h>

d8 8
a15 10
void buginit(void);
int buginstat(void);
char buginchr(void);
void bugoutchr(unsigned char);
void bugoutstr(char *, char *);
void bugrtcrd(struct mvmeprom_time *);
void bugreturn(void);
void bugbrdid(struct mvmeprom_brdid *);
void bugdiskrd(struct mvmeprom_dskio *);
int spin_cpu(cpuid_t, vaddr_t);
@


1.14
log
@Working kluge to ``enable'' the on-board SCSI controller on 187 and 197, if
it is not the boot device and has not been expliictely ``enabled'' in the
BUG.

Will definitely help netboot installations...
@
text
@d1 1
a1 1
/*	$OpenBSD: bugio.h,v 1.13 2002/03/14 01:26:39 millert Exp $ */
d19 1
@


1.13
log
@First round of __P removal in sys
@
text
@d1 1
a1 1
/*	$OpenBSD: bugio.h,v 1.12 2002/03/05 22:11:40 miod Exp $ */
d18 1
@


1.12
log
@Kill prom stuff duplicates from bugio.[ch].
@
text
@d1 1
a1 1
/*	$OpenBSD: bugio.h,v 1.11 2001/09/28 20:45:48 miod Exp $ */
d10 8
a17 8
void buginit	__P((void));
int buginstat	__P((void));
char buginchr	__P((void));
void bugoutchr	__P((unsigned char));
void bugoutstr	__P((char *, char *));
void bugrtcrd	__P((struct mvmeprom_time *));
void bugreturn	__P((void));
void bugbrdid	__P((struct mvmeprom_brdid *));
@


1.11
log
@"sys/foo.h" -> <sys/foo.h>
@
text
@d1 1
a1 1
/*	$OpenBSD: bugio.h,v 1.10 2001/08/24 22:46:25 miod Exp $ */
d8 1
a8 116
struct bugdisk_io {
	char	clun;
	char	dlun;
	short	status;
	void	*addr;
	int	blkno;
#define	fileno	blkno
	short	nblks;
	char	flag;
#define	FILEMARKFLAG	0x80
#define	IGNOREFILENO	0x02
#define	ENDOFFILE	0x01
	char	am;
};	

/* values are in BCD {upper nibble+lower nibble} */

struct bugrtc {
	unsigned char	Y;
	unsigned char	M;
	unsigned char	D;
	unsigned char	d;
	unsigned char	H;
	unsigned char	m;
	unsigned char	s;
	unsigned char	c;
};

/* Board ID - lots of info */

struct bugbrdid {
	unsigned char	eye[4];
	char	rev;
	char	month;
	char	day;
	char	year;
	short	packetsize;
	short	dummy;
	short	brdno;
	unsigned char	brdsuf[2];
	char	options[3];
	char	family:4;
	char	cpu:4;
	short	clun;
	short	dlun;
	short	type;
	short	dev;
	int	option;
	char	version[4];
	char	serial[12];			/* SBC serial number */
	char	id[16];				/* SBC id */
	char	pwa[16];				/* printed wiring assembly number */
	char	speed[4];			/* cpu speed */
	char	etheraddr[6];		/* mac address, all zero if no ether */
	char	fill[2];		
	char	scsiid[2];			/* local SCSI id */
	char	sysid[8];			/* system id - nothing on mvme187 */
	char	brd1_pwb[8];		/* memory board 1 pwb */
	char	brd1_serial[8];	/* memory board 1 serial */
	char	brd2_pwb[8];		/* memory board 2 pwb */
	char	brd2_serial[8];	/* memory board 2 serial */
	char	reserved[153];
	char	cksum[1];
};

struct bugniocall {
	unsigned char clun;
	unsigned char dlun;
	unsigned char ci;
	unsigned char cd;
#define	NETCTRL_INITDEVICE	0
#define	NETCTRL_GETHDW		1
#define	NETCTRL_TX		2
#define	NETCTRL_RX		3
#define	NETCTRL_FLUSH		4
#define	NETCTRL_RESET		5
	unsigned long cid;
	unsigned long memaddr;
	unsigned long nbytes;
	unsigned long csword;
};

typedef struct netcnfgp {
	unsigned int magic;
	unsigned int nodemem;
	unsigned int bfla;
	unsigned int bfea;
	unsigned int bfed;
	unsigned int bfl;
	unsigned int bfbo;
	unsigned int tbuffer;
	unsigned char cipa[4];
	unsigned char sipa[4];
	unsigned char netmask[4];
	unsigned char broadcast[4];
	unsigned char gipa[4];
	unsigned char bootp_retry;
	unsigned char tftp_retry;
	unsigned char bootp_ctl;
	unsigned char cnfgp_ctl;
	unsigned char filename[64];
	unsigned char argfname[64];
} NETCNFGP;

struct bugniotcall {
	unsigned char clun;
	unsigned char dlun;
	unsigned char ci;
	unsigned char cd;
	NETCNFGP * netcfngp_p;
	void * unused;
#define NIOT_READ  (1<<0)
#define NIOT_WRITE (1<<1)
#define NIOT_NVRAM (1<<2)    
	unsigned long cntrlflag;
};
d15 1
a15 4
void bugpcrlf	__P((void));
int bugdskrd	__P((struct bugdisk_io *));
int bugdskwr	__P((struct bugdisk_io *));
void bugrtcrd	__P((struct bugrtc *));
d17 1
a17 5
int bugfork	__P((int cpu, unsigned address));
void bugbrdid	__P((struct bugbrdid *));
void bugnetctrl	__P((struct bugniocall *));
void bugdelay	__P((int));
int bugnetcfg	__P((struct bugniotcall *));
@


1.11.4.1
log
@Sync UBC branch to -current
@
text
@d1 1
a1 1
/*	$OpenBSD: bugio.h,v 1.11 2001/09/28 20:45:48 miod Exp $ */
d8 14
a21 1
#include <machine/prom.h>
d23 117
a139 8
void buginit(void);
int buginstat(void);
char buginchr(void);
void bugoutchr(unsigned char);
void bugoutstr(char *, char *);
void bugrtcrd(struct mvmeprom_time *);
void bugreturn(void);
void bugbrdid(struct mvmeprom_brdid *);
@


1.10
log
@There is no need to hide potentially useful stuff in .c files.
@
text
@d1 2
a2 1
/*	$OpenBSD: bugio.h,v 1.9 2001/08/12 12:03:02 heko Exp $ */
d5 2
a6 1
#include "sys/cdefs.h"
@


1.9
log
@#(endif|else) foo is incorrect, make it #endif /* foo */
deraadt@@ ok
@
text
@d1 1
a1 1
/*	$OpenBSD: bugio.h,v 1.8 2001/03/09 05:44:40 smurph Exp $ */
d87 36
d136 3
a139 1

@


1.8
log
@kernel will compile with -Werror.  Added intr.h
@
text
@d1 1
a1 1
/*	$OpenBSD: bugio.h,v 1.7 2001/01/14 20:25:23 smurph Exp $ */
d100 1
a100 1
#endif __MACHINE_BUGIO_H__
@


1.7
log
@Complete move to UVM virtual memory system.  More header fixes.
@
text
@d1 1
a1 1
/*	$OpenBSD: bugio.h,v 1.6 1999/04/11 03:26:28 smurph Exp $ */
d77 5
a81 5
#define	NETCTRL_GETHDW			1
#define	NETCTRL_TX				2
#define	NETCTRL_RX				3
#define	NETCTRL_FLUSH			4
#define	NETCTRL_RESET			5
d87 2
a88 1

d90 3
a92 4
int buginstat	__P((void));
int bugoutchr	__P((unsigned char));
int bugoutstr	__P((char *, char *));
int bugpcrlf	__P((void));
d95 5
a99 4
int bugrtcrd	__P((struct bugrtc *));
int bugreturn	__P((void));
int bugbrdid	__P((struct bugbrdid *));
int bugnetctrl	__P((struct bugniocall *));
@


1.6
log
@Fix for 25 Mhz.
@
text
@d1 3
a3 1
/*	$OpenBSD: bugio.h,v 1.5 1999/02/09 06:36:25 smurph Exp $ */
d99 2
@


1.6.6.1
log
@Update the SMP branch to -current, this breaks the SMP branch though.
But it will be fixed soonish.  Note, nothing new has happened, this is just
a merge of the trunk into this branch.
@
text
@d1 1
a1 3
/*	$OpenBSD: bugio.h,v 1.8 2001/03/09 05:44:40 smurph Exp $ */
#ifndef __MACHINE_BUGIO_H__
#define __MACHINE_BUGIO_H__
d75 5
a79 5
#define	NETCTRL_GETHDW		1
#define	NETCTRL_TX		2
#define	NETCTRL_RX		3
#define	NETCTRL_FLUSH		4
#define	NETCTRL_RESET		5
d85 2
a86 1
void buginit	__P((void));
d88 3
a90 4
char buginchr	__P((void));
void bugoutchr	__P((unsigned char));
void bugoutstr	__P((char *, char *));
void bugpcrlf	__P((void));
d93 4
a96 7
void bugrtcrd	__P((struct bugrtc *));
void bugreturn	__P((void));
int bugfork	__P((int cpu, unsigned address));
void bugbrdid	__P((struct bugbrdid *));
void bugnetctrl	__P((struct bugniocall *));
#endif __MACHINE_BUGIO_H__

@


1.6.6.2
log
@Sync the SMP branch to something just after 3.0
@
text
@d1 1
a1 2
/*	$OpenBSD: bugio.h,v 1.6.6.1 2001/04/18 16:11:14 niklas Exp $ */

d4 1
a4 2

#include <sys/cdefs.h>
a86 36

typedef struct netcnfgp {
	unsigned int magic;
	unsigned int nodemem;
	unsigned int bfla;
	unsigned int bfea;
	unsigned int bfed;
	unsigned int bfl;
	unsigned int bfbo;
	unsigned int tbuffer;
	unsigned char cipa[4];
	unsigned char sipa[4];
	unsigned char netmask[4];
	unsigned char broadcast[4];
	unsigned char gipa[4];
	unsigned char bootp_retry;
	unsigned char tftp_retry;
	unsigned char bootp_ctl;
	unsigned char cnfgp_ctl;
	unsigned char filename[64];
	unsigned char argfname[64];
} NETCNFGP;

struct bugniotcall {
	unsigned char clun;
	unsigned char dlun;
	unsigned char ci;
	unsigned char cd;
	NETCNFGP * netcfngp_p;
	void * unused;
#define NIOT_READ  (1<<0)
#define NIOT_WRITE (1<<1)
#define NIOT_NVRAM (1<<2)    
	unsigned long cntrlflag;
};

d100 1
a100 2
void bugdelay	__P((int));
int bugnetcfg	__P((struct bugniotcall *));
a101 1
#endif /* __MACHINE_BUGIO_H__ */
@


1.6.6.3
log
@Merge in trunk
@
text
@d1 1
a1 1
/*	$OpenBSD$ */
d8 116
a123 1
#include <machine/prom.h>
d130 4
a133 1
void bugrtcrd	__P((struct mvmeprom_time *));
d135 5
a139 1
void bugbrdid	__P((struct mvmeprom_brdid *));
@


1.6.6.4
log
@Merge in -current from about a week ago
@
text
@d10 8
a17 8
void buginit(void);
int buginstat(void);
char buginchr(void);
void bugoutchr(unsigned char);
void bugoutstr(char *, char *);
void bugrtcrd(struct mvmeprom_time *);
void bugreturn(void);
void bugbrdid(struct mvmeprom_brdid *);
@


1.6.6.5
log
@Merge of current from two weeks agointo the SMP branch
@
text
@a17 1
void bugdiskrd(struct mvmeprom_dskio *);
@


1.5
log
@Added kernel support for user debugging.  Fixed file ID's
@
text
@d1 1
a1 1
/*	$OpenBSD: bugio.h,v 1.1 1998/12/15 04:45:50 smurph Exp $ */
d52 15
d75 5
a79 5
#define	NETCTRL_GETHDW		1
#define	NETCTRL_TX		2
#define	NETCTRL_RX		3
#define	NETCTRL_FLUSH		4
#define	NETCTRL_RESET		5
@


1.4
log
@Commit for the first real OpenBSD mvme88k kernel.
@
text
@d1 1
@


1.3
log
@Cleanup after import. This also seems to bring up the current version.
@
text
@d64 4
a67 4
	unsigned int  cid;
	unsigned int  memaddr;
	unsigned int  nbytes;
	unsigned int  csword;
@


1.2
log
@This is a remove to get rid of the old mvme88k port which was incomplete
to replace it with a working version. The kernel compiles and works
at least.  The new version will be imported shortly.
@
text
@d53 17
d80 1
@


1.1
log
@Initial revision
@
text
@@


1.1.1.1
log
@initial 88k import; code by nivas and based on mach luna88k
@
text
@@


1.1.1.2
log
@Third try at importing the mvme88k port. This is a working kernel
from nivas.
Userland and compiler still need to be worked on.
Make certain what directory the import is done from.
@
text
@a52 17
struct bugniocall {
	unsigned char clun;
	unsigned char dlun;
	unsigned char ci;
	unsigned char cd;
#define	NETCTRL_INITDEVICE	0
#define	NETCTRL_GETHDW		1
#define	NETCTRL_TX		2
#define	NETCTRL_RX		3
#define	NETCTRL_FLUSH		4
#define	NETCTRL_RESET		5
	unsigned int  cid;
	unsigned int  memaddr;
	unsigned int  nbytes;
	unsigned int  csword;
};

a62 1
int bugnetctrl	__P((struct bugniocall *));
@
