head	1.16;
access;
symbols
	OPENBSD_5_5:1.15.0.6
	OPENBSD_5_5_BASE:1.15
	OPENBSD_5_4:1.15.0.2
	OPENBSD_5_4_BASE:1.15
	OPENBSD_5_3:1.14.0.2
	OPENBSD_5_3_BASE:1.14
	OPENBSD_5_2:1.13.0.16
	OPENBSD_5_2_BASE:1.13
	OPENBSD_5_1_BASE:1.13
	OPENBSD_5_1:1.13.0.14
	OPENBSD_5_0:1.13.0.12
	OPENBSD_5_0_BASE:1.13
	OPENBSD_4_9:1.13.0.10
	OPENBSD_4_9_BASE:1.13
	OPENBSD_4_8:1.13.0.8
	OPENBSD_4_8_BASE:1.13
	OPENBSD_4_7:1.13.0.4
	OPENBSD_4_7_BASE:1.13
	OPENBSD_4_6:1.13.0.6
	OPENBSD_4_6_BASE:1.13
	OPENBSD_4_5:1.13.0.2
	OPENBSD_4_5_BASE:1.13
	OPENBSD_4_4:1.12.0.2
	OPENBSD_4_4_BASE:1.12
	OPENBSD_4_3:1.9.0.2
	OPENBSD_4_3_BASE:1.9
	OPENBSD_4_2:1.7.0.6
	OPENBSD_4_2_BASE:1.7
	OPENBSD_4_1:1.7.0.4
	OPENBSD_4_1_BASE:1.7
	OPENBSD_4_0:1.7.0.2
	OPENBSD_4_0_BASE:1.7
	OPENBSD_3_9:1.6.0.10
	OPENBSD_3_9_BASE:1.6
	OPENBSD_3_8:1.6.0.8
	OPENBSD_3_8_BASE:1.6
	OPENBSD_3_7:1.6.0.6
	OPENBSD_3_7_BASE:1.6
	OPENBSD_3_6:1.6.0.4
	OPENBSD_3_6_BASE:1.6
	SMP_SYNC_A:1.6
	SMP_SYNC_B:1.6
	OPENBSD_3_5:1.6.0.2
	OPENBSD_3_5_BASE:1.6
	OPENBSD_3_4:1.4.0.2
	OPENBSD_3_4_BASE:1.4
	UBC_SYNC_A:1.3
	OPENBSD_3_3:1.3.0.20
	OPENBSD_3_3_BASE:1.3
	OPENBSD_3_2:1.3.0.18
	OPENBSD_3_2_BASE:1.3
	OPENBSD_3_1:1.3.0.16
	OPENBSD_3_1_BASE:1.3
	UBC_SYNC_B:1.3
	UBC:1.3.0.14
	UBC_BASE:1.3
	OPENBSD_3_0:1.3.0.12
	OPENBSD_3_0_BASE:1.3
	OPENBSD_2_9:1.3.0.10
	OPENBSD_2_9_BASE:1.3
	OPENBSD_2_8:1.3.0.8
	OPENBSD_2_8_BASE:1.3
	OPENBSD_2_7:1.3.0.6
	OPENBSD_2_7_BASE:1.3
	SMP:1.3.0.4
	SMP_BASE:1.3
	kame_19991208:1.3
	OPENBSD_2_6:1.3.0.2
	OPENBSD_2_6_BASE:1.3
	OPENBSD_2_5:1.2.0.4
	OPENBSD_2_5_BASE:1.2
	OPENBSD_2_4:1.2.0.2
	OPENBSD_2_4_BASE:1.2
	OPENBSD_2_3:1.1.1.1.0.6
	OPENBSD_2_3_BASE:1.1.1.1
	OPENBSD_2_2:1.1.1.1.0.4
	OPENBSD_2_2_BASE:1.1.1.1
	OPENBSD_2_1:1.1.1.1.0.2
	OPENBSD_2_1_BASE:1.1.1.1
	mvme88kport:1.1.1.1;
locks; strict;
comment	@# @;


1.16
date	2014.03.18.22.36.37;	author miod;	state dead;
branches;
next	1.15;

1.15
date	2013.05.12.10.43.45;	author miod;	state Exp;
branches;
next	1.14;

1.14
date	2012.08.21.14.46.19;	author pascal;	state Exp;
branches;
next	1.13;

1.13
date	2008.09.19.20.18.03;	author miod;	state Exp;
branches;
next	1.12;

1.12
date	2008.04.02.21.53.18;	author miod;	state Exp;
branches;
next	1.11;

1.11
date	2008.03.31.22.14.43;	author miod;	state Exp;
branches;
next	1.10;

1.10
date	2008.03.31.22.11.37;	author miod;	state Exp;
branches;
next	1.9;

1.9
date	2007.11.26.10.26.02;	author deraadt;	state Exp;
branches;
next	1.8;

1.8
date	2007.11.26.10.01.42;	author deraadt;	state Exp;
branches;
next	1.7;

1.7
date	2006.05.16.22.51.30;	author miod;	state Exp;
branches;
next	1.6;

1.6
date	2004.01.26.19.48.34;	author miod;	state Exp;
branches;
next	1.5;

1.5
date	2003.10.01.20.39.41;	author miod;	state Exp;
branches;
next	1.4;

1.4
date	2003.06.02.09.33.38;	author miod;	state Exp;
branches;
next	1.3;

1.3
date	99.09.27.19.30.00;	author smurph;	state Exp;
branches
	1.3.4.1;
next	1.2;

1.2
date	98.08.22.08.07.49;	author smurph;	state Exp;
branches;
next	1.1;

1.1
date	97.03.03.19.30.35;	author rahnds;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	97.03.03.19.30.35;	author rahnds;	state Exp;
branches;
next	;

1.3.4.1
date	2003.06.07.11.13.17;	author ho;	state Exp;
branches;
next	1.3.4.2;

1.3.4.2
date	2004.02.19.10.49.09;	author niklas;	state Exp;
branches;
next	;


desc
@@


1.16
log
@Retire hp300, mvme68k and mvme88k ports. These ports have no users, keeping
this hardware alive is becoming increasingly difficult, and I should heed the
message sent by the three disks which have died on me over the last few days.

Noone sane will mourn these ports anyway. So long, and thanks for the fish.
@
text
@#	$OpenBSD: Makefile,v 1.15 2013/05/12 10:43:45 miod Exp $

LIB=sa

NOPIC=nopic
NOPROFILE=noprofile
NOPIE=

# Logically src/sys
S=${.CURDIR}/../../../..

SRCS=	board.c bugdev.c clock.c exec_mvme.c fault.c parse_args.c setjmp.S

.PATH:	${S}/lib/libsa
SRCS+=	alloc.c memcpy.c exit.c getfile.c gets.c globals.c \
	printf.c strerror.c memset.c memcmp.c strncpy.c strcmp.c strlen.c \
	strlcpy.c strlcat.c snprintf.c strchr.c \
	close.c closeall.c dev.c dkcksum.c \
	lseek.c open.c nullfs.c read.c fstat.c \
	ufs.c cread.c
SRCS+=	arp.c ether.c in_cksum.c net.c rpc.c nfs.c \
	rarp.c bootparam.c
SRCS+=	loadfile.c

.PATH:	${S}/lib/libkern/arch/m88k ${S}/lib/libkern
SRCS+=	ashrdi3.c bzero.c __main.c

# DBG= -DDEBUG -DNETIF_DEBUG -DNFS_DEBUG -DRPC_DEBUG \
# 	-DNET_DEBUG -DRARP_DEBUG -DETHER_DEBUG

#DEFS= -DCOMPAT_UFS
DEFS= -D__INTERNAL_LIBSA_CREAD -D_STANDALONE
#DEFS+=-DNETIF_DEBUG
INCL= -I${.CURDIR} -I${.CURDIR}/../libbug -I${S}/lib/libsa -I${S} -I.
CFLAGS+= ${XCFLAGS} ${COPTS} ${DEFS} ${DBG} ${INCL}

all: libsa.a

install:

.include <bsd.lib.mk>

.if !make(obj)
.BEGIN:
	@@([ -h dev ] || ln -s ${.CURDIR}/../../../${MACHINE}/dev dev)
	@@([ -h machine ] || ln -s ${.CURDIR}/../../../${MACHINE}/include machine)
	@@([ -h m88k ] || ln -s ${.CURDIR}/../../../m88k/include m88k)
.NOPATH: dev machine m88k
CLEANFILES+=	dev machine m88k
.endif
@


1.15
log
@S-Records boot code for mvme88k, finally. Allows a kernel to be loaded from
network, using either the on-board interface (on MVME187 and MVME197) or
any MVME376.

While there, add MVME376 support to netboot.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.14 2012/08/21 14:46:19 pascal Exp $
@


1.14
log
@Add NOPIE= bits for sys/arch/*/stand to ensure that bootblocks will always be
built with -fno-pie.  This gets the hairiest part of PIE out of the way ...

ok deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.13 2008/09/19 20:18:03 miod Exp $
d12 1
a12 1
SRCS=	board.c bugdev.c clock.c parse_args.c exec_mvme.c
d17 1
a17 1
	strlcpy.c strlcat.c snprintf.c \
d21 1
a21 1
SRCS+=	arp.c ether.c in_cksum.c net.c netif.c rpc.c nfs.c \
@


1.13
log
@Perform the mvme197 latency timer reprogramming in the boot blocks, in
addition to the kernel, and unconditionnaly handle all busswitch revision 1
based boards as horribly broken, even with 50MHz clocks.

Based on an report of an early 50MHz 197LE board being unable to boot,
due to memory corruption.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.12 2008/04/02 21:53:18 miod Exp $
d7 1
@


1.12
log
@Rewrite the startup code for the mvme88k bootblocks, once again. Some of
them (especially the netboot ones) will now self-relocate, which makes
BUG configuration much simpler.

WARNING: for disk-based systems, you need to update bootxx and bootsd at the
same time. New bootsd will not run when loaded from an older bootxx.
This doesn't matter much since you need both with installboot.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.11 2008/03/31 22:14:43 miod Exp $
d11 1
a11 1
SRCS=	bugdev.c clock.c parse_args.c exec_mvme.c
d44 1
d47 2
a48 2
.NOPATH: machine m88k
CLEANFILES+=	machine m88k
@


1.11
log
@Switch bootloaders to mi loadfile().
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.10 2008/03/31 22:11:37 miod Exp $
d25 1
a25 1
SRCS+=	ashrdi3.c bzero.c
@


1.10
log
@Compile libsa with -D_STANDALONE.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.9 2007/11/26 10:26:02 deraadt Exp $
d22 1
d33 1
a33 1
INCL= -I${.CURDIR} -I${.CURDIR}/../libbug -I${S}/lib/libsa -I${S}
d41 8
@


1.9
log
@few more dribbles of LIBKERN cleanup
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.8 2007/11/26 10:01:42 deraadt Exp $
d30 1
a30 1
DEFS= -D__INTERNAL_LIBSA_CREAD
@


1.8
log
@More LIBKERN bits that go away
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.7 2006/05/16 22:51:30 miod Exp $
d11 1
a11 2
SRC_net= arp.c ether.c in_cksum.c net.c netif.c rpc.c nfs.c \
	 rarp.c bootparam.c
d14 1
a14 1
SRC_sa=	alloc.c memcpy.c exit.c getfile.c gets.c globals.c \
d20 2
d24 1
a24 7
SRC_kern= ashrdi3.c bzero.c

SRC_mvme= exec_mvme.c

SRC_here= bugdev.c clock.c parse_args.c

SRCS= ${SRC_net} ${SRC_sa} ${SRC_mvme} ${SRC_here} ${SRC_kern}
@


1.7
log
@Cleanup of mvme88k standalone code, with rewritten startup code with
fewer assembly statements and much less magic, a few display artefacts
removed, and private definitions moved out of the main prom.h.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.6 2004/01/26 19:48:34 miod Exp $
a9 2
DIR_SA=$S/lib/libsa
DIR_KERN=$S/lib/libkern
d14 1
d22 1
a38 2

.PATH:  ${DIR_SA} ${DIR_KERN}
@


1.6
log
@tftp-only netboot code, inspired from mvmeppc, and stripped down; it will
become necessary to boot from unsupported (as far as mvme88k/stand/ is
concerned) network cards, such as the MVME374 and the MVME376.

Not enabled in the build yet, because there are a few issues left, but
it is nonetheless usable...
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.5 2003/10/01 20:39:41 miod Exp $
a4 2
CLEANFILES+=SRT0.o SRT1.o

d14 1
a14 1
	 rarp.c bootparam.c 
d35 2
a36 2
DEFS= -D__INTERNAL_LIBSA_CREAD 
#-DNETIF_DEBUG
d40 1
a40 1
.PATH:  ${DIR_SA} ${DIR_KERN} 
d42 1
a42 1
all: libsa.a SRT0.o SRT1.o
@


1.5
log
@Compile kernel and bootblocks with -mmemcpy, to get rid of libgcc dependancy.
Also, honor default compilation options in stand/ whenever possible.

This requires an up-to-date compiler, but it's not exactly like many people
are going to be affected by this change...
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.4 2003/06/02 09:33:38 miod Exp $
d20 1
a20 1
	snprintf.c \
@


1.4
log
@snprintf here too.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.3 1999/09/27 19:30:00 smurph Exp $
d40 1
a40 2
COPTS= #-fno-defer-pop
CFLAGS+= ${XCFLAGS} ${COPTS} ${DEFS} ${DBG} ${INCL} -O2
@


1.3
log
@changed loader load address.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.2 1998/08/22 08:07:49 smurph Exp $
d20 1
@


1.3.4.1
log
@Sync SMP branch to -current
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.3 1999/09/27 19:30:00 smurph Exp $
a19 1
	snprintf.c \
@


1.3.4.2
log
@Merge of current from two weeks agointo the SMP branch
@
text
@d1 1
a1 1
#	$OpenBSD$
d20 1
a20 1
	strlcpy.c strlcat.c snprintf.c \
d40 2
a41 1
CFLAGS+= ${XCFLAGS} ${COPTS} ${DEFS} ${DBG} ${INCL}
@


1.2
log
@New libsa.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.13 1997/04/22 16:07:57 gvf Exp $
d40 1
a40 1
CFLAGS+= ${XCFLAGS} -O2 ${COPTS} ${DEFS} ${DBG} ${INCL}
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
#	$Id: Makefile,v 1.1 1996/02/03 01:43:48 build Exp build $
d15 2
a16 2
SRC_net= nfs.c rpc.c net.c ether.c arp.c in_cksum.c netif.c \
	 bootparam.c rarp.c
d18 5
d24 1
a24 3
#SRC_sa = alloc.c bcopy.c memcpy.c close.c getfile.c open.c \
#	 printf.c read.c strerror.c ufs.c globals.c lseek.c \
#	 closeall.c dev.c dkcksum.c nullfs.c fstat.c
d26 1
a26 3
SRC_sa = alloc.c bcopy.c close.c getfile.c open.c \
	 printf.c read.c strerror.c ufs.c globals.c lseek.c \
	 dev.c
d28 1
a28 1
SRC_kern= ashrdi3.c bcmp.c bzero.c strcmp.c strlen.c
d30 1
a30 5
SRC_here= clock.c devopen.c dvma.c \
	 gets.c panic.c \
	 promboot.c promcons.c

SRCS= ${SRC_net} ${SRC_sa} ${SRC_kern} ${SRC_here}
d36 3
a38 1
INCL= -I. -I${S}/lib/libsa -I${S}
d40 1
a40 1
CFLAGS= ${COPTS} ${DEFS} ${DBG} ${INCL}
d42 1
a42 1
.PATH:  ${DIR_SA} ${DIR_KERN} ../../sun3
@


1.1.1.1
log
@Third try at importing the mvme88k port. This is a working kernel
from nivas.
Userland and compiler still need to be worked on.
Make certain what directory the import is done from.
@
text
@@
