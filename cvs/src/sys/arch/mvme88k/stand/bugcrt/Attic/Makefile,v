head	1.16;
access;
symbols
	OPENBSD_5_5:1.15.0.6
	OPENBSD_5_5_BASE:1.15
	OPENBSD_5_4:1.15.0.2
	OPENBSD_5_4_BASE:1.15
	OPENBSD_5_3:1.14.0.2
	OPENBSD_5_3_BASE:1.14
	OPENBSD_5_2:1.12.0.18
	OPENBSD_5_2_BASE:1.12
	OPENBSD_5_1_BASE:1.12
	OPENBSD_5_1:1.12.0.16
	OPENBSD_5_0:1.12.0.14
	OPENBSD_5_0_BASE:1.12
	OPENBSD_4_9:1.12.0.12
	OPENBSD_4_9_BASE:1.12
	OPENBSD_4_8:1.12.0.10
	OPENBSD_4_8_BASE:1.12
	OPENBSD_4_7:1.12.0.6
	OPENBSD_4_7_BASE:1.12
	OPENBSD_4_6:1.12.0.8
	OPENBSD_4_6_BASE:1.12
	OPENBSD_4_5:1.12.0.4
	OPENBSD_4_5_BASE:1.12
	OPENBSD_4_4:1.12.0.2
	OPENBSD_4_4_BASE:1.12
	OPENBSD_4_3:1.11.0.2
	OPENBSD_4_3_BASE:1.11
	OPENBSD_4_2:1.10.0.16
	OPENBSD_4_2_BASE:1.10
	OPENBSD_4_1:1.10.0.14
	OPENBSD_4_1_BASE:1.10
	OPENBSD_4_0:1.10.0.12
	OPENBSD_4_0_BASE:1.10
	OPENBSD_3_9:1.10.0.10
	OPENBSD_3_9_BASE:1.10
	OPENBSD_3_8:1.10.0.8
	OPENBSD_3_8_BASE:1.10
	OPENBSD_3_7:1.10.0.6
	OPENBSD_3_7_BASE:1.10
	OPENBSD_3_6:1.10.0.4
	OPENBSD_3_6_BASE:1.10
	SMP_SYNC_A:1.10
	SMP_SYNC_B:1.10
	OPENBSD_3_5:1.10.0.2
	OPENBSD_3_5_BASE:1.10
	OPENBSD_3_4:1.8.0.14
	OPENBSD_3_4_BASE:1.8
	UBC_SYNC_A:1.8
	OPENBSD_3_3:1.8.0.12
	OPENBSD_3_3_BASE:1.8
	OPENBSD_3_2:1.8.0.10
	OPENBSD_3_2_BASE:1.8
	OPENBSD_3_1:1.8.0.8
	OPENBSD_3_1_BASE:1.8
	UBC_SYNC_B:1.8
	UBC:1.8.0.6
	UBC_BASE:1.8
	OPENBSD_3_0:1.8.0.4
	OPENBSD_3_0_BASE:1.8
	OPENBSD_2_9:1.8.0.2
	OPENBSD_2_9_BASE:1.8
	OPENBSD_2_8:1.6.0.8
	OPENBSD_2_8_BASE:1.6
	OPENBSD_2_7:1.6.0.6
	OPENBSD_2_7_BASE:1.6
	SMP:1.6.0.4
	SMP_BASE:1.6
	kame_19991208:1.6
	OPENBSD_2_6:1.6.0.2
	OPENBSD_2_6_BASE:1.6
	OPENBSD_2_5:1.5.0.2
	OPENBSD_2_5_BASE:1.5
	OPENBSD_2_4:1.4.0.2
	OPENBSD_2_4_BASE:1.4
	OPENBSD_2_3:1.3.0.6
	OPENBSD_2_3_BASE:1.3
	OPENBSD_2_2:1.3.0.4
	OPENBSD_2_2_BASE:1.3
	OPENBSD_2_1:1.3.0.2
	OPENBSD_2_1_BASE:1.3
	mvme88kport:1.1.1.2
	OPENBSD_2_0:1.1.1.1.0.2
	OPENBSD_2_0_BASE:1.1.1.1
	first_1:1.1.1.1;
locks; strict;
comment	@# @;


1.16
date	2014.03.18.22.36.36;	author miod;	state dead;
branches;
next	1.15;

1.15
date	2013.05.12.10.43.45;	author miod;	state Exp;
branches;
next	1.14;

1.14
date	2013.01.05.11.20.56;	author miod;	state Exp;
branches;
next	1.13;

1.13
date	2012.08.21.14.46.19;	author pascal;	state Exp;
branches;
next	1.12;

1.12
date	2008.04.02.21.53.17;	author miod;	state Exp;
branches;
next	1.11;

1.11
date	2007.10.30.06.03.16;	author deraadt;	state Exp;
branches;
next	1.10;

1.10
date	2003.10.02.13.24.39;	author miod;	state Exp;
branches;
next	1.9;

1.9
date	2003.10.01.20.39.41;	author miod;	state Exp;
branches;
next	1.8;

1.8
date	2001.02.01.03.38.22;	author smurph;	state Exp;
branches;
next	1.7;

1.7
date	2001.01.13.05.19.01;	author smurph;	state Exp;
branches;
next	1.6;

1.6
date	99.09.27.19.30.00;	author smurph;	state Exp;
branches
	1.6.4.1;
next	1.5;

1.5
date	98.12.15.06.12.50;	author smurph;	state Exp;
branches;
next	1.4;

1.4
date	98.08.22.09.16.45;	author smurph;	state Exp;
branches;
next	1.3;

1.3
date	97.03.03.20.22.14;	author rahnds;	state Exp;
branches;
next	1.2;

1.2
date	97.03.03.19.08.29;	author rahnds;	state dead;
branches;
next	1.1;

1.1
date	95.10.18.10.54.21;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.10.54.21;	author deraadt;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	97.03.03.19.30.31;	author rahnds;	state Exp;
branches;
next	;

1.6.4.1
date	2001.04.18.16.11.47;	author niklas;	state Exp;
branches;
next	1.6.4.2;

1.6.4.2
date	2004.02.19.10.49.09;	author niklas;	state Exp;
branches;
next	;


desc
@@


1.16
log
@Retire hp300, mvme68k and mvme88k ports. These ports have no users, keeping
this hardware alive is becoming increasingly difficult, and I should heed the
message sent by the three disks which have died on me over the last few days.

Noone sane will mourn these ports anyway. So long, and thanks for the fish.
@
text
@#	$OpenBSD: Makefile,v 1.15 2013/05/12 10:43:45 miod Exp $

S=${.CURDIR}/../../../..

CFLAGS+=-I${.CURDIR}/../../include -I${.CURDIR}/../libbug -I${S}/lib/libsa
STAGE1_CFLAGS=	-DLOAD_FROM_VID
STAGE2_CFLAGS=	-DLOAD_FROM_BOOTXX
NETBOOT_CFLAGS=	-DNETBOOT
SREC_CFLAGS=	-DSREC
SRCS=crt0.S
OBJS=stage1crt.o stage2crt.o netcrt.o sreccrt.o
NOPIE=

all:	${OBJS}

stage1crt.o: crt0.S
	${CC} ${CFLAGS} ${STAGE1_CFLAGS} -c ${.CURDIR}/crt0.S -o ${.TARGET}

stage2crt.o: crt0.S
	${CC} ${CFLAGS} ${STAGE2_CFLAGS} -c ${.CURDIR}/crt0.S -o ${.TARGET}

netcrt.o: crt0.S
	${CC} ${CFLAGS} ${NETBOOT_CFLAGS} -c ${.CURDIR}/crt0.S -o ${.TARGET}

sreccrt.o: crt0.S
	${CC} ${CFLAGS} ${SREC_CFLAGS} -c ${.CURDIR}/crt0.S -o ${.TARGET}

install:

lint tags:

.include <bsd.prog.mk>
@


1.15
log
@S-Records boot code for mvme88k, finally. Allows a kernel to be loaded from
network, using either the on-board interface (on MVME187 and MVME197) or
any MVME376.

While there, add MVME376 support to netboot.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.14 2013/01/05 11:20:56 miod Exp $
@


1.14
log
@Switch m88k ports to ELF.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.13 2012/08/21 14:46:19 pascal Exp $
d6 4
a9 3
STAGE1_CFLAGS=-DSTAGE1
STAGE2_CFLAGS=-DSTAGE2
NETBOOT_CFLAGS=-DNETBOOT
d11 1
a11 1
OBJS=stage1crt.o stage2crt.o netcrt.o
a13 2
CLEANFILES+=stage1crt.out stage2crt.out netcrt.out ${OBJS}

d24 3
@


1.13
log
@Add NOPIE= bits for sys/arch/*/stand to ensure that bootblocks will always be
built with -fno-pie.  This gets the hairiest part of PIE out of the way ...

ok deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.12 2008/04/02 21:53:17 miod Exp $
a18 2
	${LD} -x -r ${.TARGET} -o ${.TARGET}ut
	mv ${.TARGET}ut ${.TARGET}
a21 2
	${LD} -x -r ${.TARGET} -o ${.TARGET}ut
	mv ${.TARGET}ut ${.TARGET}
a24 2
	${LD} -x -r ${.TARGET} -o ${.TARGET}ut
	mv ${.TARGET}ut ${.TARGET}
@


1.12
log
@Rewrite the startup code for the mvme88k bootblocks, once again. Some of
them (especially the netboot ones) will now self-relocate, which makes
BUG configuration much simpler.

WARNING: for disk-based systems, you need to update bootxx and bootsd at the
same time. New bootsd will not run when loaded from an older bootxx.
This doesn't matter much since you need both with installboot.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.11 2007/10/30 06:03:16 deraadt Exp $
d11 1
@


1.11
log
@avoid intermediate files with same name (ie. a.out) for parallel make
ok miod
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.10 2003/10/02 13:24:39 miod Exp $
d6 5
a10 5
STAGE1_CFLAGS=-DSTACK_ASM_OP="\".long ${STAGE1_RELOC}\"" -DSTAGE1
STAGE2_CFLAGS=-DSTACK_ASM_OP="\".long ${STAGE2_RELOC}\""
SINGLE_CFLAGS=-DSTACK_ASM_OP="\".long ${STAGE2_RELOC}\"" -DSTAGE1
SRCS=crt.c
OBJS=stage1crt.o stage2crt.o singlecrt.o
d12 1
a12 1
CLEANFILES+=stage1crt.out stage2crt.out singlecrt.out ${OBJS}
d16 2
a17 2
stage1crt.o: crt.c
	${CC} ${CFLAGS} ${STAGE1_CFLAGS} -c ${.CURDIR}/crt.c -o ${.TARGET}
d21 2
a22 2
stage2crt.o: crt.c
	${CC} ${CFLAGS} ${STAGE2_CFLAGS} -c ${.CURDIR}/crt.c -o ${.TARGET}
d26 2
a27 2
singlecrt.o: crt.c
	${CC} ${CFLAGS} ${SINGLE_CFLAGS} -c ${.CURDIR}/crt.c -o ${.TARGET}
@


1.10
log
@Upon invoking the freshly loaded binary, populate registers via embedded asm
statements, and be sure of what we get, rather than use "hinted" register
local variables; bugcrt can now be compiled with compiler optimization enabled.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.9 2003/10/01 20:39:41 miod Exp $
d12 1
a12 1
CLEANFILES+=a.out ${OBJS}
d18 2
a19 2
	${LD} -x -r ${.TARGET}
	mv a.out ${.TARGET}
d23 2
a24 2
	${LD} -x -r ${.TARGET}
	mv a.out ${.TARGET}
d28 2
a29 2
	${LD} -x -r ${.TARGET}
	mv a.out ${.TARGET}
@


1.9
log
@Compile kernel and bootblocks with -mmemcpy, to get rid of libgcc dependancy.
Also, honor default compilation options in stand/ whenever possible.

This requires an up-to-date compiler, but it's not exactly like many people
are going to be affected by this change...
@
text
@d1 2
a2 5
#	$OpenBSD: Makefile,v 1.8 2001/02/01 03:38:22 smurph Exp $
#
# DO NOT OPTIMIZE bugcrt (i.e. no "-O2")
# ...until it is fixed (-:
#
d5 1
a5 3
#CFLAGS+=-I${.CURDIR}/../../include -I${.CURDIR}/../libbug -I${S}/lib/libsa
CFLAGS=-I${.CURDIR}/../../include -I${.CURDIR}/../libbug -I${S}/lib/libsa \
    -fomit-frame-pointer
@


1.8
log
@Major changes to get MVME188 working.  More header and code cleanups.  The
kernel is tested on MVME188A/2P256 and MVME188A/1P64.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.7 2001/01/13 05:19:01 smurph Exp $
d3 2
a4 1
# DO NOT OPTMIZE bugcrt (i.e. no "-O2")
d8 1
d10 1
a10 1
	-fomit-frame-pointer -save-temps
d17 1
a17 1
CLEANFILES+=a.out ${OBJS} *.i *.s
@


1.7
log
@Booting kernel with MACHINE_NEW_NONCONTIG.  UVM code added but not working.
New stand config.  Lots of header fixes.  Can now cross-compile i386->m88k.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.6 1999/09/27 19:30:00 smurph Exp $
d25 1
a25 1
	${CC} ${CFLAGS} ${STAGE1_CFLAGS} -c ${.CURDIR}/crt.c -o ${.TARGET}
@


1.6
log
@changed loader load address.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.5 1998/12/15 06:12:50 smurph Exp $
d6 1
d9 5
d15 1
a15 1
OBJS=bugcrt.o sdcrt.o
d17 1
a17 1
CLEANFILES+=a.out ${OBJS}
d19 4
a22 1
all:	${OBJS}
d24 2
a25 2
bugcrt.o: bugcrt.c
	${COMPILE.c} -c $<
d29 2
a30 2
sdcrt.o: sdcrt.c
	${COMPILE.c} -c $<
@


1.6.4.1
log
@Update the SMP branch to -current, this breaks the SMP branch though.
But it will be fixed soonish.  Note, nothing new has happened, this is just
a merge of the trunk into this branch.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.8 2001/02/01 03:38:22 smurph Exp $
a5 1

a7 5
STAGE1_CFLAGS=-DSTACK_ASM_OP="\".long ${STAGE1_RELOC}\"" -DSTAGE1
STAGE2_CFLAGS=-DSTACK_ASM_OP="\".long ${STAGE2_RELOC}\""
SINGLE_CFLAGS=-DSTACK_ASM_OP="\".long ${STAGE2_RELOC}\"" -DSTAGE1
SRCS=crt.c
OBJS=stage1crt.o stage2crt.o singlecrt.o
d9 3
a11 1
CLEANFILES+=a.out ${OBJS} *.i *.s
d15 2
a16 7
stage1crt.o: crt.c
	${CC} ${CFLAGS} ${STAGE1_CFLAGS} -c ${.CURDIR}/crt.c -o ${.TARGET}
	${LD} -x -r ${.TARGET}
	mv a.out ${.TARGET}

stage2crt.o: crt.c
	${CC} ${CFLAGS} ${STAGE2_CFLAGS} -c ${.CURDIR}/crt.c -o ${.TARGET}
d20 2
a21 2
singlecrt.o: crt.c
	${CC} ${CFLAGS} ${SINGLE_CFLAGS} -c ${.CURDIR}/crt.c -o ${.TARGET}
@


1.6.4.2
log
@Merge of current from two weeks agointo the SMP branch
@
text
@d1 4
a4 2
#	$OpenBSD$

d7 2
a8 1
CFLAGS+=-I${.CURDIR}/../../include -I${.CURDIR}/../libbug -I${S}/lib/libsa
d15 1
a15 1
CLEANFILES+=a.out ${OBJS}
@


1.5
log
@Added sdcrt.c to make bootxx and bootsd work.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.4 1998/08/22 09:16:45 smurph Exp $
d7 1
a7 1
	-fomit-frame-pointer
@


1.4
log
@fixed bugargs and lots of stuff regaurding netboot.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.7 1997/04/22 16:05:38 gvf Exp $
d9 1
a9 1
OBJS=bugcrt.o
d11 1
a11 1
CLEANFILES+=a.out
d16 5
@


1.3
log
@Cleanup after import. This also seems to bring up the current version.
@
text
@d1 7
a7 7
#    $Id: Makefile,v 1.1.1.2 1997/03/03 19:30:31 rahnds Exp $

CFLAGS+=-I${.CURDIR}/../../include 

.include "${MACHINE_ARCH}/Makefile.inc"

.PATH:  ${.CURDIR}/${MACHINE_ARCH}
d16 1
a16 1
	${CC} ${CFLAGS} -c ${.ALLSRC}
@


1.2
log
@This is a remove to get rid of the old mvme88k port which was incomplete
to replace it with a working version. The kernel compiles and works
at least.  The new version will be imported shortly.
@
text
@d1 1
a1 5
OBJ=bugcrt.o
CFLAGS+=-I${.CURDIR}/../include
CFLAGS+=-I${.CURDIR}/../..
CFLAGS+=-I/usr/src/sys
CFLAGS+=-fwritable-strings
d3 20
a22 2
SRCS=bugcrt.c
all:	bugcrt.o
@


1.1
log
@Initial revision
@
text
@@


1.1.1.1
log
@initial 88k import; code by nivas and based on mach luna88k
@
text
@@


1.1.1.2
log
@Third try at importing the mvme88k port. This is a working kernel
from nivas.
Userland and compiler still need to be worked on.
Make certain what directory the import is done from.
@
text
@d1 5
a5 1
#    $Id: Makefile,v 1.1 1996/02/04 03:36:28 build Exp build $
d7 2
a8 20
CFLAGS+=-I${.CURDIR}/../../include 

.include "${MACHINE_ARCH}/Makefile.inc"

.PATH:  ${.CURDIR}/${MACHINE_ARCH}

OBJS=bugcrt.o

CLEANFILES+=a.out

all:	${OBJS}

bugcrt.o: bugcrt.c
	${CC} ${CFLAGS} -c ${.ALLSRC}
	${LD} -x -r ${.TARGET}
	mv a.out ${.TARGET}

install:

lint tags:
@
