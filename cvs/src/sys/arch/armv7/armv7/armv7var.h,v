head	1.15;
access;
symbols
	OPENBSD_6_2:1.15.0.6
	OPENBSD_6_2_BASE:1.15
	OPENBSD_6_1:1.15.0.4
	OPENBSD_6_1_BASE:1.15
	OPENBSD_6_0:1.12.0.2
	OPENBSD_6_0_BASE:1.12
	OPENBSD_5_9:1.9.0.2
	OPENBSD_5_9_BASE:1.9
	OPENBSD_5_8:1.9.0.4
	OPENBSD_5_8_BASE:1.9
	OPENBSD_5_7:1.2.0.2
	OPENBSD_5_7_BASE:1.2
	OPENBSD_5_6:1.1.0.6
	OPENBSD_5_6_BASE:1.1
	OPENBSD_5_5:1.1.0.4
	OPENBSD_5_5_BASE:1.1;
locks; strict;
comment	@ * @;


1.15
date	2016.10.23.19.05.09;	author kettenis;	state Exp;
branches;
next	1.14;
commitid	pFUf6av8L32Curw8;

1.14
date	2016.10.09.01.40.43;	author jsg;	state Exp;
branches;
next	1.13;
commitid	Of2rCa9qI1b33BPT;

1.13
date	2016.10.05.22.06.48;	author kettenis;	state Exp;
branches;
next	1.12;
commitid	WddFsarPAXG7fLxc;

1.12
date	2016.06.04.18.09.16;	author jsg;	state Exp;
branches;
next	1.11;
commitid	tYyT96DOGdhLjy9v;

1.11
date	2016.05.19.09.54.18;	author jsg;	state Exp;
branches;
next	1.10;
commitid	YOVLhJEd9hDJJgxl;

1.10
date	2016.05.01.21.07.40;	author patrick;	state Exp;
branches;
next	1.9;
commitid	9HmqUIjyMkt9s5Iw;

1.9
date	2015.06.08.06.33.16;	author jsg;	state Exp;
branches;
next	1.8;
commitid	TKnNVNES86I6ApFq;

1.8
date	2015.06.07.16.54.16;	author jsg;	state Exp;
branches;
next	1.7;
commitid	PdAY9TkBu3RC2njV;

1.7
date	2015.05.24.11.06.16;	author jsg;	state Exp;
branches;
next	1.6;
commitid	VVW9uLn2fmZlspyH;

1.6
date	2015.05.19.03.30.54;	author jsg;	state Exp;
branches;
next	1.5;
commitid	l6xI4SC4UUe6il2U;

1.5
date	2015.05.15.15.35.43;	author jsg;	state Exp;
branches;
next	1.4;
commitid	AFNG6oUBgS2y44wd;

1.4
date	2015.05.08.03.38.26;	author jsg;	state Exp;
branches;
next	1.3;
commitid	zVOTE2eSG0EuTsRj;

1.3
date	2015.03.29.03.24.17;	author jsg;	state Exp;
branches;
next	1.2;
commitid	hHVsAs6xtkSH9CXS;

1.2
date	2015.01.02.01.57.33;	author jsg;	state Exp;
branches;
next	1.1;
commitid	HaF7XDn04ChceeoJ;

1.1
date	2013.11.06.19.08.06;	author syl;	state Exp;
branches;
next	;


desc
@@


1.15
log
@Remove sunxi board IDs.
@
text
@/* $OpenBSD: armv7var.h,v 1.14 2016/10/09 01:40:43 jsg Exp $ */
/*
 * Copyright (c) 2005,2008 Dale Rahn <drahn@@openbsd.com>
 * Copyright (c) 2012-2013 Patrick Wildt <patrick@@blueri.se>
 *
 * Permission to use, copy, modify, and distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 */

#ifndef __ARMV7VAR_H__
#define __ARMV7VAR_H__

/* Boards device list */
struct board_dev {
	char	*name;
	int	unit;
};

struct armv7_board {
	uint32_t		board_id;
	struct board_dev	*devs;
	void			(*init)(void);
};

/* Needed by omap, sunxi */
struct armv7_softc {
	struct device sc_dv;

	struct board_dev *sc_board_devs;
};

/* Physical memory range for on-chip devices. */

struct armv7mem {
	bus_addr_t	addr;
	bus_size_t	size;
};

#define ARMV7_DEV_NMEM 6
#define ARMV7_DEV_NIRQ 4
#define ARMV7_DEV_NDMA 4

/* Descriptor for all on-chip devices. */
struct armv7_dev {
	char	*name;			/* driver name or made up name */
	int	unit;			/* driver instance number or -1 */
	struct	armv7mem mem[ARMV7_DEV_NMEM]; /* memory ranges */
	int	irq[ARMV7_DEV_NIRQ];	/* IRQ number(s) */
	int	dma[ARMV7_DEV_NDMA];	/* DMA chan number(s) */
};

/* Passed as third arg to attach functions. */
struct armv7_attach_args {
	struct armv7_dev	*aa_dev;
	bus_space_tag_t		aa_iot;
	bus_dma_tag_t		aa_dmat;
};

extern struct armv7_dev *armv7_devs;

void	armv7_set_devs(struct armv7_dev *);
struct	armv7_dev *armv7_find_dev(const char *, int);
void	armv7_attach(struct device *, struct device *, void *);
int	armv7_submatch(struct device *, void *, void *);

/* board identification - from uboot */
#define BOARD_ID_OMAP3_BEAGLE 1546
#define BOARD_ID_OMAP3_OVERO 1798
#define BOARD_ID_OMAP4_PANDA 2791
#define BOARD_ID_EXYNOS4_SMDKC210 2838
#define BOARD_ID_EXYNOS4_NURI 3379
#define BOARD_ID_AM335X_BEAGLEBONE 3589
#define BOARD_ID_EXYNOS5_CHROMEBOOK 3774
extern uint32_t board_id;

#endif /* __ARMV7VAR_H__ */

@


1.14
log
@Remove the vexpress platform abstraction and board id.  All the devices
that attached to vexpress have been converted to fdt so this is no
longer required.
@
text
@d1 1
a1 1
/* $OpenBSD: armv7var.h,v 1.13 2016/10/05 22:06:48 kettenis Exp $ */
a82 2
#define BOARD_ID_SUN4I_A10 4104
#define BOARD_ID_SUN7I_A20 4283
@


1.13
log
@Make imxdog(4) set cpuresetfn, and remove all the imx platform that is no
longer needed, including the imx board IDs.

ok patrick@@, jsg@@
@
text
@d1 1
a1 1
/* $OpenBSD: armv7var.h,v 1.12 2016/06/04 18:09:16 jsg Exp $ */
a77 1
#define BOARD_ID_VEXPRESS 2272
@


1.12
log
@Remove model specific strings keyed off the board id.
We now pull the model string from fdt.
@
text
@d1 1
a1 1
/* $OpenBSD: armv7var.h,v 1.11 2016/05/19 09:54:18 jsg Exp $ */
d34 1
a34 1
/* Needed by omap, imx, sunxi */
a82 1
#define BOARD_ID_IMX6_SABRELITE 3769
a83 1
#define BOARD_ID_IMX6_SABRESD 3980
a84 2
#define BOARD_ID_IMX6_NOVENA 4269
#define BOARD_ID_IMX6_UTILITE 4273
a85 4
#define BOARD_ID_IMX6_WANDBOARD 4412
#define BOARD_ID_IMX6_HUMMINGBOARD 4773
#define BOARD_ID_IMX6_UDOO 4800
#define BOARD_ID_IMX6_CUBOXI 4821
@


1.11
log
@Remove the PHYTEC phyFLEX support code, patrick says he no longer
has the hardware for the eval kit.

ok patrick@@
@
text
@d1 1
a1 1
/* $OpenBSD: armv7var.h,v 1.10 2016/05/01 21:07:40 patrick Exp $ */
a29 1
	const char		*name;
@


1.10
log
@Remove unused match function.  The armv7 platforms implement their own,
which are more specific.

ok kettenis@@
@
text
@d1 1
a1 1
/* $OpenBSD: armv7var.h,v 1.9 2015/06/08 06:33:16 jsg Exp $ */
a82 1
#define BOARD_ID_IMX6_PHYFLEX 3529
@


1.9
log
@Add initial support for the ARM Versatile Express boards as emulated by
qemu with virtio memory ranges.

Unfortunately the vexpress-a9 and vexpress-a15 boards/targets have
different load addresses and memory maps.

Code for the PL011 UART and mmio virtio attachment from Patrick Wildt
in bitrig.
@
text
@d1 1
a1 1
/* $OpenBSD: armv7var.h,v 1.8 2015/06/07 16:54:16 jsg Exp $ */
a72 1
int	armv7_match(struct device *, void *, void *);
@


1.8
log
@Initial exynos4 bits.  Among other things the gic isn't mapped correctly
on exynos4/5 yet as it isn't at the usual offset from periphbase.
ok bmercer@@
@
text
@d1 1
a1 1
/* $OpenBSD: armv7var.h,v 1.7 2015/05/24 11:06:16 jsg Exp $ */
d80 1
@


1.7
log
@add the chromebook board id the exynos code uses
@
text
@d1 1
a1 1
/* $OpenBSD: armv7var.h,v 1.6 2015/05/19 03:30:54 jsg Exp $ */
d81 2
@


1.6
log
@Abstract the soc_machdep.c functions to allow a kernel to be built for
multiple socs.

From Patrick Wildt in bitrig with some additional changes.
@
text
@d1 1
a1 1
/* $OpenBSD: armv7var.h,v 1.5 2015/05/15 15:35:43 jsg Exp $ */
d84 1
@


1.5
log
@Make board attaching table driven and move it out into the soc
directories.  Move the device tables while here as was done in bitrig.
With these changes the only use of the board id defines is in the soc
directories.

Tested by matthieu and djm on imx and myself on omap and sunxi (qemu).
ok djm@@, ok jasper@@ on an earlier version
@
text
@d1 1
a1 1
/* $OpenBSD: armv7var.h,v 1.4 2015/05/08 03:38:26 jsg Exp $ */
a93 12

/* different arch init */
void am335x_init(void);
void imx6_init(void);
void omap3_init(void);
void omap4_init(void);
void sxia1x_init(void);
void sxia20_init(void);

struct board_dev *imx_board_attach(void);
struct board_dev *omap_board_attach(void);
struct board_dev *sunxi_board_attach(void);
@


1.4
log
@Add initial board specific parts of novena support, tested by djm@@
While novena has it's own board id it's u-boot does not set it.
"setenv machid 10ad" in u-boot will set the novena board id (0x10ad/4269).
@
text
@d1 1
a1 1
/* $OpenBSD: armv7var.h,v 1.3 2015/03/29 03:24:17 jsg Exp $ */
d28 7
d102 4
@


1.3
log
@initial support for the SABRE SD board
from Patrick Wildt in Bitrig
@
text
@d1 1
a1 1
/* $OpenBSD: armv7var.h,v 1.2 2015/01/02 01:57:33 jsg Exp $ */
d79 1
@


1.2
log
@Add some additional i.MX6 board types from Bitrig.
CompuLab Utilite, SolidRun HummingBoard/CuBox-i and UDOO.
@
text
@d1 1
a1 1
/* $OpenBSD: armv7var.h,v 1.1 2013/11/06 19:08:06 syl Exp $ */
d77 1
@


1.1
log
@forgot armv7/armv7 files...
@
text
@d1 1
a1 1
/* $OpenBSD$ */
d76 1
d78 1
a78 1
#define BOARD_ID_IMX6_SABRELITE 3769
d81 3
@

