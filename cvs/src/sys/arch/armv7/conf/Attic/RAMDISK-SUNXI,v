head	1.14;
access;
symbols
	OPENBSD_5_7:1.12.0.2
	OPENBSD_5_7_BASE:1.12
	OPENBSD_5_6:1.8.0.4
	OPENBSD_5_6_BASE:1.8
	OPENBSD_5_5:1.5.0.4
	OPENBSD_5_5_BASE:1.5;
locks; strict;
comment	@# @;


1.14
date	2015.05.20.01.44.20;	author jsg;	state dead;
branches;
next	1.13;
commitid	AyYz7FgJK6jKwvRv;

1.13
date	2015.05.19.00.05.59;	author jsg;	state Exp;
branches;
next	1.12;
commitid	bo8vCG1OOftVcP5V;

1.12
date	2014.11.24.02.03.37;	author brad;	state Exp;
branches;
next	1.11;
commitid	Wmnzf8bGQILqXRTG;

1.11
date	2014.11.04.12.34.06;	author jsg;	state Exp;
branches;
next	1.10;
commitid	TLiAKzppDQ3B6yXy;

1.10
date	2014.10.10.05.43.35;	author deraadt;	state Exp;
branches;
next	1.9;
commitid	eyBTAcDp3o260Uyq;

1.9
date	2014.08.22.20.03.56;	author deraadt;	state Exp;
branches;
next	1.8;
commitid	v3mi9m9bp9Skjxm7;

1.8
date	2014.07.12.21.56.56;	author tedu;	state Exp;
branches;
next	1.7;
commitid	6Bshd6p5VmKoCOQI;

1.7
date	2014.04.07.08.27.23;	author brad;	state Exp;
branches;
next	1.6;

1.6
date	2014.03.05.19.48.22;	author miod;	state Exp;
branches;
next	1.5;

1.5
date	2013.12.08.09.09.47;	author martynas;	state Exp;
branches;
next	1.4;

1.4
date	2013.11.15.19.42.20;	author sasano;	state Exp;
branches;
next	1.3;

1.3
date	2013.11.01.20.26.51;	author jasper;	state Exp;
branches;
next	1.2;

1.2
date	2013.10.31.17.17.03;	author jasper;	state Exp;
branches;
next	1.1;

1.1
date	2013.10.23.17.08.47;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.14
log
@Now all the socs use the same va entry point and don't have any
conflicting symbols we can combine the configs.

Multiple umg files are still required however.  The bsd.umg target in
the kernel is replaced by targets for bsd.IMX.umg, bsd.OMAP.umg and
bsd.SUNXI.umg.
@
text
@#	$OpenBSD: RAMDISK-SUNXI,v 1.13 2015/05/19 00:05:59 jsg Exp $

machine		armv7 arm
maxusers	4

option		TIMEZONE=0
option		DST=0
option		SMALL_KERNEL
option		NO_PROPOLICE
option		BOOT_CONFIG

option		MINIROOTSIZE=10240
option		RAMDISK_HOOKS

option		USBVERBOSE

option		FFS
option		MSDOSFS
option		INET
option		INET6

makeoptions	KERNEL_BASE_PHYS="0x40300000"
makeoptions	KERNEL_BASE_VIRT="0xc0300000"
option		CPU_ARMv7	# Support the ARMv7

config		bsd root on rd0a swap on rd0b

mainbus0	at root
cpu0		at mainbus?

sunxi0		at mainbus?
a1xintc*	at sunxi?		# A1x interrupt controller

cortex0		at mainbus?		# A20
ampintc*	at cortex?
#agtimer*	at cortex?

sxipio*		at sunxi?		# GPIO pins for leds & PHYs
sxiccmu*	at sunxi?		# Clock Control Module/Unit
sxitimer*	at sunxi?
sxidog*		at sunxi?		# watchdog timer
sxirtc*		at sunxi?		# Real Time Clock
sxiuart*	at sunxi?		# onboard uarts
sxie*		at sunxi?
ahci*		at sunxi?		# AHCI/SATA (shim)
ehci*		at sunxi?
#ohci*		at sunxi?
#usbotg0	at sunxi?

usb*		at ehci?	#flags 0x1
#usb*		at ohci?

uhub*		at usb?
uhub*		at uhub?
umass*		at uhub?
scsibus*	at umass?
uhidev*		at uhub?		# Human Interface Devices
ukbd*		at uhidev?		# USB keyboard
wskbd*		at ukbd? mux 1
uhid*		at uhidev?		# USB generic HID support
rum*		at uhub?		# Ralink RT2501USB/RT2601USB

ukphy*		at mii?			# "unknown" PHYs
rlphy*		at mii?			# Realtek 8139 internal PHYs
rgephy*		at mii?			# Realtek 8169S/8110S PHY

scsibus*	at scsi?
sd*		at scsibus?
cd*		at scsibus?

pseudo-device	loop 1
pseudo-device	bpfilter 1
pseudo-device	rd 1
@


1.13
log
@use the same va entry point on all armv7 socs
Similiar changes were made in bitrig by Patrick Wildt.

As part of this change the physical load address for imx and sunxi have
changed.  Any u-boot settings that include it will need to be modified.

imx: 0x10800000 -> 0x10300000
sunxi: 0x40800000 -> 0x40300000

Tested by bmercer, canacar and myself.
ok bmercer@@
@
text
@d1 1
a1 1
#	$OpenBSD: RAMDISK-SUNXI,v 1.12 2014/11/24 02:03:37 brad Exp $
@


1.12
log
@use the correct capitalization for Realtek.
@
text
@d1 1
a1 1
#	$OpenBSD: RAMDISK-SUNXI,v 1.11 2014/11/04 12:34:06 jsg Exp $
d22 2
a23 5
makeoptions	KERNEL_BASE_PHYS="0x40800000"
makeoptions	KERNEL_BASE_VIRT="0xc0800000"
option		BUILD_STARTUP_PAGETABLE
option		STARTUP_PAGETABLE_ADDR=0x40200000
option		SDRAM_START="0x40000000"
@


1.11
log
@Add rgephy(4) for the RTL8211E phy in the LeMaker Banana Pi and Banana Pro.
@
text
@d1 1
a1 1
#	$OpenBSD: RAMDISK-SUNXI,v 1.10 2014/10/10 05:43:35 deraadt Exp $
d67 1
a67 1
rlphy*		at mii?			# RealTek 8139 internal PHYs
@


1.10
log
@Significant unification of RAMDISK* config files, making them diffable.
This makes it easier to remove components not required to do an install,
and subsequently add other desireable components ...
In snapshots (in various forks) for about a week.
Do some upgrades and installs, please.
@
text
@d1 1
a1 1
#	$OpenBSD: RAMDISK-SUNXI,v 1.9 2014/08/22 20:03:56 deraadt Exp $
d68 1
@


1.9
log
@pseudo-device crypto was accidentally left for some architectures.
@
text
@d1 1
a1 33
# $OpenBSD: RAMDISK-SUNXI,v 1.8 2014/07/12 21:56:56 tedu Exp $
#
# GENERIC machine description file
#
# This machine description file is used to generate the default OpenBSD
# kernel.  The generic kernel does not include all options, subsystems
# and device drivers, but should be useful for most applications.
#
# The machine description file can be customised for your specific
# machine to reduce the kernel size and improve its performance.
#
# For further information on compiling OpenBSD kernels, see the config(8)
# man page.
#
# For further information on hardware support for this architecture, see
# the intro(4) man page.  For further information about kernel options
# for this architecture, see the options(4) man page.  For an explanation
# of each device driver in this file see the section 4 man page for the
# device.

machine	armv7	arm

options	TIMEZONE=0	# time zone to adjust RTC time by
options	DST=0		# daylight saving time used by RTC
options	FFS		# UFS
#options	CD9660		# ISO 9660 + Rock Ridge file system
options	MSDOSFS		# MS-DOS file system
options	INET		# IP + ICMP + TCP + UDP
options	INET6		# IPv6 (needs INET)
options	DDB		# kernel debugger
options	DIAGNOSTIC
options	FIFO		# FIFOs; RECOMMENDED
#options	NFSCLIENT	# NFS 
d3 2
a4 5
makeoptions	KERNEL_BASE_PHYS="0x40800000"
makeoptions	KERNEL_BASE_VIRT="0xc0800000"
options	BUILD_STARTUP_PAGETABLE
options	STARTUP_PAGETABLE_ADDR=0x40200000
options	SDRAM_START="0x40000000"
d6 5
a10 1
# estimated number of users
d12 2
a13 1
maxusers	32
d15 1
a15 2
# CPU options
options	CPU_ARMv7	# Support the ARMv7
d17 4
a20 4
#option WSDISPLAY_COMPAT_USL		# VT handling
#option WSDISPLAY_COMPAT_RAWKBD		# can get raw scancodes
option WSDISPLAY_DEFAULTSCREENS=1
#option WSDISPLAY_COMPAT_PCVT		# emulate some ioctls
d22 6
a27 1
option		USBVERBOSE
d29 1
a29 1
config		bsd	root on rd0a swap on rd0b
a30 1
# The main bus device
d34 2
a35 5
# Sunxi A1x/A20 SoC
sunxi0	at mainbus?

# A1x only
a1xintc*	at sunxi?		# interrupt controller
d37 1
a37 2
# A20 only
cortex0		at mainbus?
a40 1
# Sunxi on-chip devices
d49 2
a50 2
ehci*		at sunxi?		# EHCI (shim)
#ohci*		at sunxi?		# OHCI (shim)
a52 1
# USB bus support
d56 3
a58 22
uhub*		at usb?			# USB Hubs
uhub*		at uhub?		# USB Hubs
# umodem*		at uhub?		# USB Modems/Serial
# ucom*		at umodem?
# uvisor*		at uhub?		# Handspring Visor
# ucom*		at uvisor?
# uvscom*		at uhub?		# SUNTAC Slipper U VS-10U serial
# ucom*		at uvscom?
# ubsa*		at uhub?		# Belkin serial adapter
# ucom*		at ubsa?
# uftdi*		at uhub?		# FTDI FT8U100AX serial adapter
# ucom*		at uftdi?
# uplcom* 	at uhub?		# I/O DATA USB-RSAQ2 serial adapter
# ucom*		at uplcom?
# umct*		at uhub?		# MCT USB-RS232 serial adapter
# ucom*		at umct?
# uaudio* 	at uhub?		# USB Audio
# audio*		at uaudio?
# umidi*		at uhub?		# USB MIDI
# midi*		at umidi?
# ulpt*		at uhub?		# USB Printers
umass*		at uhub?		# USB Mass Storage devices
a60 2
ums*		at uhidev?		# USB mouse
wsmouse*	at ums? mux 0
a63 18
# aue*		at uhub?		# ADMtek AN986 Pegasus Ethernet
# atu*		at uhub?		# Atmel AT76c50x based 802.11b
# axe*		at uhub?		# ASIX Electronics AX88172 USB Ethernet
# axen*		at uhub?		# ASIX Electronics AX88179 USB Ethernet
# cue*		at uhub?		# CATC USB-EL1201A based Ethernet
# kue*		at uhub?		# Kawasaki KL5KUSB101B based Ethernet
# smsc*		at uhub?		# SMSC LAN95xx Ethernet
# cdce*		at uhub?		# CDC Ethernet
# upl*		at uhub?		# Prolific PL2301/PL2302 host-to-host `network'
# ugl*		at uhub?		# Genesys Logic GL620USB-A host-to-host `network'
# udav*		at uhub?		# Davicom DM9601 based Ethernet
# url*		at uhub?		# Realtek RTL8150L based adapters
# wi*		at uhub?		# WaveLAN IEEE 802.11DS
# urio*		at uhub?		# Diamond Multimedia Rio 500
# udsbr*		at uhub?		# D-Link DSB-R100 radio
# radio*		at udsbr?		# USB radio
# #ubt*		at uhub? disable	# USB Bluetooth
ugen*		at uhub?		# USB Generic driver
a64 1
# XXX missing usable drivers, like run(4).
a70 1
st*		at scsibus?
a71 2
ch*		at scsibus?
uk*		at scsibus?
d73 3
a75 10
# Pseudo-Devices
#pseudo-device	wsmux		2	# mouse & keyboard multiplexor
pseudo-device	loop		1	# network loopback
pseudo-device   bpfilter        1       # packet filter
pseudo-device   rd              1       # ram disk
pseudo-device	hotplug		1	# devices hot plugging

# RAMDISK stuff
options	MINIROOTSIZE=10240
options	RAMDISK_HOOKS
@


1.8
log
@"Dr. Jones. Again we see there is nothing you can possess which I cannot
take away."

remove uyap. no effect except on hppa where it was strangely enabled.
@
text
@d1 1
a1 1
# $OpenBSD: RAMDISK-SUNXI,v 1.7 2014/04/07 08:27:23 brad Exp $
a150 1
#pseudo-device	crypto		1
@


1.7
log
@Add axen(4) wherever axe(4) is.

ok mpi@@ yuo@@
@
text
@d1 1
a1 1
# $OpenBSD: RAMDISK-SUNXI,v 1.6 2014/03/05 19:48:22 miod Exp $
a131 1
# #uyap*		at uhub?		# Y@@P firmware loader
@


1.6
log
@Remove TIMEZONE and DST options from GENERIC-* kernels.
Remove APERTURE, DDB_SAFE_CONSOLE and *_DEBUG from RAMDISK-* kernels.
Add option USBVERBOSE to all kernels.
@
text
@d1 1
a1 1
# $OpenBSD: RAMDISK-SUNXI,v 1.5 2013/12/08 09:09:47 martynas Exp $
d121 1
@


1.5
log
@Enable rum(4) for armv7.  Committing through it on pandaboard.
OK rapha@@, jasper@@.
@
text
@d1 1
a1 1
# $OpenBSD: RAMDISK-SUNXI,v 1.4 2013/11/15 19:42:20 sasano Exp $
a31 1
option	DDB_SAFE_CONSOLE
a40 2
options		APERTURE

d52 2
@


1.4
log
@Added dev/usb/if_ugl.c, a driver for Genesys Logic GL620USB-A
USB host-to-host link cable. This driver is derived from upl(4).
@
text
@d1 1
a1 1
# $OpenBSD: RAMDISK-SUNXI,v 1.3 2013/11/01 20:26:51 jasper Exp $
d137 1
@


1.3
log
@crank MINIROOTSIZE needed so the ramdisks will fit again

ok patrick@@
@
text
@d1 1
a1 1
# $OpenBSD: RAMDISK-SUNXI,v 1.2 2013/10/31 17:17:03 jasper Exp $
d127 1
@


1.2
log
@remove commented gpio(4) entry which makes no sense to have on the ramdisk

ok aalm@@
@
text
@d1 1
a1 1
# $OpenBSD: RAMDISK-SUNXI,v 1.1 2013/10/23 17:08:47 jasper Exp $
d157 1
a157 1
options	MINIROOTSIZE=5120
@


1.1
log
@rename 'allwinner' to 'sunxi' to actually match the SoC name instead of using
the vendor to follow our naming convention.

ok aalm@@ patrick@@
@
text
@d1 1
a1 1
# $OpenBSD: RAMDISK-ALLWINNER,v 1.1 2013/10/22 13:22:20 jasper Exp $
a84 2

#gpio*		at awpio?
@

