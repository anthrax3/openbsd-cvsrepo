head	1.6;
access;
symbols
	OPENBSD_6_1:1.6.0.2
	OPENBSD_6_1_BASE:1.6
	OPENBSD_6_0:1.2.0.2
	OPENBSD_6_0_BASE:1.2;
locks; strict;
comment	@ * @;


1.6
date	2016.10.23.19.06.08;	author kettenis;	state Exp;
branches;
next	1.5;
commitid	Jm2RcEnymdSNb8Fg;

1.5
date	2016.10.06.18.15.44;	author kettenis;	state Exp;
branches;
next	1.4;
commitid	BQmlDk49Vlbp1uQn;

1.4
date	2016.09.24.13.40.12;	author kettenis;	state Exp;
branches;
next	1.3;
commitid	wtbC8osG5m0rEk4i;

1.3
date	2016.09.13.18.27.49;	author jasper;	state Exp;
branches;
next	1.2;
commitid	PHzGPdVfpKxkA6ei;

1.2
date	2016.05.14.20.00.24;	author kettenis;	state Exp;
branches;
next	1.1;
commitid	tHmXcV1FdW3Zog5T;

1.1
date	2016.05.14.17.55.15;	author kettenis;	state Exp;
branches;
next	;
commitid	IdQZw2Pw0GuFYXCI;


desc
@@


1.6
log
@Remove sunxi board IDs.
@
text
@/*	$OpenBSD: conf.c,v 1.5 2016/10/06 18:15:44 kettenis Exp $	*/

/*
 * Copyright (c) 1996 Michael Shalayeff
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 *
 * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
 * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 */

#include <sys/param.h>
#include <sys/types.h>
#include <lib/libsa/stand.h>
#include <lib/libsa/ufs.h>
#include <dev/cons.h>

#include "efiboot.h"
#include "efidev.h"

const char version[] = "0.5";
int	debug = 0;

struct fs_ops file_system[] = {
	{ ufs_open,    ufs_close,    ufs_read,    ufs_write,    ufs_seek,
	  ufs_stat,    ufs_readdir    },
};
int nfsys = nitems(file_system);

struct devsw	devsw[] = {
	{ "sd", efistrategy, efiopen, eficlose, efiioctl },
};
int ndevs = nitems(devsw);

struct consdev constab[] = {
	{ efi_cons_probe, efi_cons_init, efi_cons_getc, efi_cons_putc },
	{ NULL }
};
struct consdev *cn_tab;
@


1.5
log
@Remove board IDs for the i.MX platform.  The kernel doesn't need them anymore.
Make sure we pass 0 as the board ID instead of random garbage if we don't
find a matching compatible string.

ok jsg@@
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.4 2016/09/24 13:40:12 kettenis Exp $	*/
d38 1
a38 1
const char version[] = "0.4";
@


1.4
log
@Pass esym to the kernel in r0.  Since u-boot passes 0 in this register, we
can easily determine that the value passed is valid and use it to initialize
the kernel symbol tableo.

ok tom@@, patrick@@
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.3 2016/09/13 18:27:49 jasper Exp $	*/
d38 1
a38 1
const char version[] = "0.3";
@


1.3
log
@crank bootloader version after .SUNW_ctf change

as discussed with jsing@@ it's easier this way to ensure people have
bootblocks capable of loading the section
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.2 2016/05/14 20:00:24 kettenis Exp $	*/
d38 1
a38 1
const char version[] = "0.2";
@


1.2
log
@Handle boot options, and pass the boot device to the kernel.  The boot device
is currently hardcoded to be sd0.  Still need to figure out how we will do
proper boot device selection when we start using the FDT.
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.1 2016/05/14 17:55:15 kettenis Exp $	*/
d38 1
a38 1
const char version[] = "0.1";
@


1.1
log
@Initial stab at an EFI bootloader for armv7.  Bits and pieces from FreeBSD
and our amd64 EFI bootloader.  The current code works on a 2GB CuBox-i,
but probably not on anything else.  It needs a u-boot with EFI loader
support.
@
text
@d1 1
a1 1
/*	$OpenBSD$	*/
d48 1
a48 1
	{ "efi", efistrategy, efiopen, eficlose, efiioctl },
@

