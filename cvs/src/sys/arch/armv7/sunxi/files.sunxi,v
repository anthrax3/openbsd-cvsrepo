head	1.18;
access;
symbols
	OPENBSD_6_1:1.18.0.4
	OPENBSD_6_1_BASE:1.18
	OPENBSD_6_0:1.6.0.2
	OPENBSD_6_0_BASE:1.6
	OPENBSD_5_9:1.3.0.2
	OPENBSD_5_9_BASE:1.3
	OPENBSD_5_8:1.3.0.4
	OPENBSD_5_8_BASE:1.3
	OPENBSD_5_7:1.2.0.2
	OPENBSD_5_7_BASE:1.2
	OPENBSD_5_6:1.2.0.6
	OPENBSD_5_6_BASE:1.2
	OPENBSD_5_5:1.2.0.4
	OPENBSD_5_5_BASE:1.2;
locks; strict;
comment	@# @;


1.18
date	2017.01.21.08.26.49;	author patrick;	state Exp;
branches;
next	1.17;
commitid	dvP7gLmLqGu2JY3W;

1.17
date	2016.10.23.18.50.34;	author kettenis;	state Exp;
branches;
next	1.16;
commitid	mOwNztTM0fyFumab;

1.16
date	2016.10.22.15.16.25;	author kettenis;	state Exp;
branches;
next	1.15;
commitid	mjaDtGaGcrXazKVz;

1.15
date	2016.10.09.11.14.22;	author kettenis;	state Exp;
branches;
next	1.14;
commitid	aiJLMeOtKpZ2nF7H;

1.14
date	2016.10.08.09.50.14;	author kettenis;	state Exp;
branches;
next	1.13;
commitid	FICmyJkPAYUIRIay;

1.13
date	2016.08.20.13.24.38;	author patrick;	state Exp;
branches;
next	1.12;
commitid	fTfCppDRiD8lCmCR;

1.12
date	2016.08.15.21.03.27;	author kettenis;	state Exp;
branches;
next	1.11;
commitid	aZ1jcd7QtoXbdGyj;

1.11
date	2016.08.13.22.07.01;	author kettenis;	state Exp;
branches;
next	1.10;
commitid	XVm4E4Xrhg4vkNT2;

1.10
date	2016.08.05.21.45.37;	author kettenis;	state Exp;
branches;
next	1.9;
commitid	cC1sDGu6YTDVjn44;

1.9
date	2016.08.05.21.29.23;	author kettenis;	state Exp;
branches;
next	1.8;
commitid	Xq7LuNuhuMX8kXoV;

1.8
date	2016.08.05.20.38.17;	author kettenis;	state Exp;
branches;
next	1.7;
commitid	0UKrx15wJC7DcQ7u;

1.7
date	2016.08.05.19.00.25;	author kettenis;	state Exp;
branches;
next	1.6;
commitid	PWnrMbYWs67oDQuR;

1.6
date	2016.06.11.07.07.59;	author jsg;	state Exp;
branches;
next	1.5;
commitid	Zr64rpowLR8WCMql;

1.5
date	2016.06.11.06.42.16;	author jsg;	state Exp;
branches;
next	1.4;
commitid	P3TWFuwvfad353N2;

1.4
date	2016.05.02.08.15.55;	author patrick;	state Exp;
branches;
next	1.3;
commitid	SxPSz6lxaCE62Tnc;

1.3
date	2015.05.15.15.35.43;	author jsg;	state Exp;
branches;
next	1.2;
commitid	AFNG6oUBgS2y44wd;

1.2
date	2013.11.06.19.03.07;	author syl;	state Exp;
branches;
next	1.1;

1.1
date	2013.10.23.17.08.47;	author jasper;	state Exp;
branches;
next	;


desc
@@


1.18
log
@Move Allwinner drivers that will soon be used by OpenBSD/arm64
to the new MI FDT driver directory.

"go ahead" kettenis@@
@
text
@#	$OpenBSD: files.sunxi,v 1.17 2016/10/23 18:50:34 kettenis Exp $

device	sxiintc
attach	sxiintc at fdt
file	arch/armv7/sunxi/sxiintc.c		sxiintc

device	sxitimer
attach	sxitimer at fdt
file	arch/armv7/sunxi/sxitimer.c		sxitimer

device	sxidog
attach	sxidog at fdt
file	arch/armv7/sunxi/sxidog.c		sxidog

device	sxiahci: scsi, atascsi
attach	sxiahci at fdt
file	arch/armv7/sunxi/sxiahci.c		sxiahci

#attach ohci at sunxi with sxiohci
#file	arch/armv7/sunxi/sxiohci.c		sxiohci

device	sxie: ether, ifnet, mii, ifmedia
attach	sxie at fdt
file	arch/armv7/sunxi/sxie.c			sxie

attach	dwge at fdt with dwge_fdt
file	arch/armv7/sunxi/if_dwge_fdt.c		dwge_fdt
@


1.17
log
@De-platformize sunxi.  This removes the board initialization code that sets up
SRAM for the EMAC.  Instead we rely on u-boot setting this up for us.

ok jsg@@, patrick@@
@
text
@d1 1
a1 9
#	$OpenBSD: files.sunxi,v 1.16 2016/10/22 15:16:25 kettenis Exp $

device	sxiccmu
attach	sxiccmu at fdt
file	arch/armv7/sunxi/sxiccmu.c		sxiccmu

device	sxipio {}: gpiobus
attach	sxipio at fdt
file	arch/armv7/sunxi/sxipio.c		sxipio
a14 4
device	sxirtc
attach	sxirtc at fdt
file	arch/armv7/sunxi/sxirtc.c		sxirtc

a18 4
device	sximmc: sdmmcbus
attach	sximmc at fdt
file	arch/armv7/sunxi/sximmc.c		sximmc

a20 3

attach	ehci at fdt with sxiehci
file	arch/armv7/sunxi/sxiehci.c		sxiehci
@


1.16
log
@Attach sxitimer(4) using the fdt.
@
text
@d1 1
a1 9
#	$OpenBSD: files.sunxi,v 1.15 2016/10/09 11:14:22 kettenis Exp $

define	sunxi {}
device	sunxi: sunxi
attach	sunxi at fdt
file	arch/armv7/sunxi/sunxi_machdep.c	sunxi	needs-flag
file	arch/armv7/sunxi/sunxi.c		sunxi
file	arch/armv7/sunxi/sun4i.c
file	arch/armv7/sunxi/sun7i.c
@


1.15
log
@Attach sxiccmu(4) using the fdt.

ok jsg@@
@
text
@d1 1
a1 1
#	$OpenBSD: files.sunxi,v 1.14 2016/10/08 09:50:14 kettenis Exp $
d24 1
a24 1
attach	sxitimer at sunxi
@


1.14
log
@Attach sxipio(4) using the fdt.

ok jsg@@, patrick@@
@
text
@d1 1
a1 1
#	$OpenBSD: files.sunxi,v 1.13 2016/08/20 13:24:38 patrick Exp $
d12 1
a12 1
attach	sxiccmu at sunxi
@


1.13
log
@sxiuart(4) has been replaced with com(4).

ok kettenis@@
@
text
@d1 1
a1 1
#	$OpenBSD: files.sunxi,v 1.12 2016/08/15 21:03:27 kettenis Exp $
d16 1
a16 1
attach	sxipio at sunxi
@


1.12
log
@First stab at porting the awinmmc(4) driver from NetBSD.  The driver will
be known as sximmc(4) and is somewhat functional.  Still needs proper clock
support and some further cleanup.
@
text
@d1 1
a1 1
#	$OpenBSD: files.sunxi,v 1.11 2016/08/13 22:07:01 kettenis Exp $
a47 4

device	sxiuart
attach	sxiuart at fdt
file	arch/armv7/sunxi/sxiuart.c		sxiuart
@


1.11
log
@Add the shim to make dwge(4) attach to simplebus(4).  This brings us
working gigabit on the Allwinner A20.  Probably won't work yet on other
Allwinner SoCs due to differences in how the clocks get set up.

Based on an earlier diff from patrick@@.
@
text
@d1 1
a1 1
#	$OpenBSD: files.sunxi,v 1.10 2016/08/05 21:45:37 kettenis Exp $
d38 4
@


1.10
log
@Dynamically attach sxidog(4).
@
text
@d1 1
a1 1
#	$OpenBSD: files.sunxi,v 1.9 2016/08/05 21:29:23 kettenis Exp $
d52 3
@


1.9
log
@Dynamically attach sxirtc(4); another board_id check bites the dust.
@
text
@d1 1
a1 1
#	$OpenBSD: files.sunxi,v 1.8 2016/08/05 20:38:17 kettenis Exp $
d28 1
a28 1
attach	sxidog at sunxi
@


1.8
log
@We don't want drivers with numbers in their names.

Requested by deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: files.sunxi,v 1.7 2016/08/05 19:00:25 kettenis Exp $
d32 1
a32 1
attach	sxirtc at sunxi
@


1.7
log
@Switch the sunxi platform over to the new interrupt establish API.  This
involves turning sxiahci(4) into a real driver that dynamically attaches.
ehci(4) now also attaches dynamically.

ok jsg@@, patrick@@
@
text
@d1 1
a1 1
#	$OpenBSD: files.sunxi,v 1.6 2016/06/11 07:07:59 jsg Exp $
d19 3
a21 3
device	a1xintc
attach	a1xintc at fdt
file	arch/armv7/sunxi/a1xintc.c		a1xintc
@


1.6
log
@dynamically attach sxiuart using the FDT
@
text
@d1 1
a1 1
#	$OpenBSD: files.sunxi,v 1.5 2016/06/11 06:42:16 jsg Exp $
d20 1
a20 1
attach	a1xintc at sunxi
d35 2
a36 1
attach	ahci at sunxi with sxiahci
d42 1
a42 1
attach	ehci at sunxi with sxiehci
@


1.5
log
@dynamically attach sxie(4) using the FDT
@
text
@d1 1
a1 1
#	$OpenBSD: files.sunxi,v 1.4 2016/05/02 08:15:55 patrick Exp $
d45 1
a45 1
attach	sxiuart at sunxi
@


1.4
log
@Rework mainbus and implement simplebus to be able to span a tree-like
topology based on device tree information.  Introduce a common attach
args structure to be used for all fdt-capable bus devices.

ok jsg@@ kettenis@@
@
text
@d1 1
a1 1
#	$OpenBSD: files.sunxi,v 1.3 2015/05/15 15:35:43 jsg Exp $
d49 1
a49 1
attach	sxie at sunxi
@


1.3
log
@Make board attaching table driven and move it out into the soc
directories.  Move the device tables while here as was done in bitrig.
With these changes the only use of the board id defines is in the soc
directories.

Tested by matthieu and djm on imx and myself on omap and sunxi (qemu).
ok djm@@, ok jasper@@ on an earlier version
@
text
@d1 1
a1 1
#	$OpenBSD: files.sunxi,v 1.2 2013/11/06 19:03:07 syl Exp $
d5 1
a5 1
attach	sunxi at mainbus
@


1.2
log
@After factorizing armv7_machdep code here is an effort to factorize all
the code present in omap/omap.c imx/imx.c and sunxi/sunxi.c

All this code looks quite the same, so we move it in a generic armv7/armv7.c

This is a step closer to only one kernel for all armv7 boards.

ok patrick@@, rapha@@
@
text
@d1 1
a1 1
#	$OpenBSD: files.sunxi,v 1.1 2013/10/23 17:08:47 jasper Exp $
d6 1
a6 1
file	arch/armv7/sunxi/sunxi_machdep.c	sunxi
@


1.1
log
@rename 'allwinner' to 'sunxi' to actually match the SoC name instead of using
the vendor to follow our naming convention.

ok aalm@@ patrick@@
@
text
@d1 1
a1 1
#	$OpenBSD: files.sunxi,v 1.1 2013/10/22 13:22:20 jasper Exp $
d7 3
a9 3
file	arch/armv7/sunxi/sunxi.c	sunxi
file	arch/armv7/sunxi/sun4i.c		sunxi
file	arch/armv7/sunxi/sun7i.c		sunxi
@

