head	1.22;
access;
symbols
	SMP_SYNC_A:1.22
	SMP_SYNC_B:1.22
	UBC_SYNC_A:1.22
	OPENBSD_3_2:1.21.0.2
	OPENBSD_3_2_BASE:1.21
	OPENBSD_3_1:1.20.0.6
	OPENBSD_3_1_BASE:1.20
	UBC_SYNC_B:1.21
	UBC:1.20.0.4
	UBC_BASE:1.20
	OPENBSD_3_0:1.20.0.2
	OPENBSD_3_0_BASE:1.20
	OPENBSD_2_9_BASE:1.17
	OPENBSD_2_9:1.17.0.2
	OPENBSD_2_8:1.16.0.2
	OPENBSD_2_8_BASE:1.16
	OPENBSD_2_7:1.13.0.2
	OPENBSD_2_7_BASE:1.13
	SMP:1.12.0.12
	SMP_BASE:1.12
	kame_19991208:1.12
	OPENBSD_2_6:1.12.0.10
	OPENBSD_2_6_BASE:1.12
	OPENBSD_2_5:1.12.0.8
	OPENBSD_2_5_BASE:1.12
	OPENBSD_2_4:1.12.0.6
	OPENBSD_2_4_BASE:1.12
	OPENBSD_2_3:1.12.0.4
	OPENBSD_2_3_BASE:1.12
	OPENBSD_2_2:1.12.0.2
	OPENBSD_2_2_BASE:1.12
	OPENBSD_2_1:1.11.0.2
	OPENBSD_2_1_BASE:1.11
	OPENBSD_2_0:1.6.0.2
	OPENBSD_2_0_BASE:1.6
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@# @;


1.22
date	2002.12.31.16.35.40;	author miod;	state dead;
branches;
next	1.21;

1.21
date	2002.07.28.01.39.14;	author krw;	state Exp;
branches;
next	1.20;

1.20
date	2001.10.10.23.43.42;	author millert;	state Exp;
branches
	1.20.4.1;
next	1.19;

1.19
date	2001.09.22.20.44.48;	author deraadt;	state Exp;
branches;
next	1.18;

1.18
date	2001.06.23.19.46.59;	author deraadt;	state Exp;
branches;
next	1.17;

1.17
date	2001.01.03.02.03.28;	author miod;	state Exp;
branches;
next	1.16;

1.16
date	2000.06.19.01.22.34;	author miod;	state Exp;
branches;
next	1.15;

1.15
date	2000.05.26.00.44.21;	author miod;	state Exp;
branches;
next	1.14;

1.14
date	2000.05.26.00.07.27;	author miod;	state Exp;
branches;
next	1.13;

1.13
date	2000.04.30.15.27.57;	author miod;	state Exp;
branches;
next	1.12;

1.12
date	97.06.09.12.14.42;	author kstailey;	state Exp;
branches
	1.12.12.1;
next	1.11;

1.11
date	97.02.11.17.41.17;	author kstailey;	state Exp;
branches;
next	1.10;

1.10
date	96.11.23.18.05.35;	author kstailey;	state Exp;
branches;
next	1.9;

1.9
date	96.11.23.07.54.49;	author kstailey;	state Exp;
branches;
next	1.8;

1.8
date	96.11.13.12.12.19;	author mickey;	state Exp;
branches;
next	1.7;

1.7
date	96.10.11.23.05.47;	author deraadt;	state Exp;
branches;
next	1.6;

1.6
date	96.09.20.06.45.25;	author deraadt;	state Exp;
branches;
next	1.5;

1.5
date	96.08.31.02.09.41;	author deraadt;	state Exp;
branches;
next	1.4;

1.4
date	96.05.03.15.18.25;	author mickey;	state Exp;
branches;
next	1.3;

1.3
date	95.12.14.05.26.36;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	95.11.19.13.52.04;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.51.50;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.51.50;	author deraadt;	state Exp;
branches;
next	;

1.12.12.1
date	2001.05.14.21.37.24;	author niklas;	state Exp;
branches;
next	1.12.12.2;

1.12.12.2
date	2001.07.04.10.23.52;	author niklas;	state Exp;
branches;
next	1.12.12.3;

1.12.12.3
date	2001.10.31.03.07.59;	author nate;	state Exp;
branches;
next	1.12.12.4;

1.12.12.4
date	2003.03.27.23.52.17;	author niklas;	state dead;
branches;
next	;

1.20.4.1
date	2002.10.29.00.28.12;	author art;	state Exp;
branches;
next	1.20.4.2;

1.20.4.2
date	2003.05.19.21.49.44;	author tedu;	state dead;
branches;
next	;


desc
@@


1.22
log
@amiga and sun3 turned out to not be y2k+3 compliant here. Remove them, as
well as the few userland tools which were only used on these platforms.
@
text
@#	$OpenBSD: RAMDISK,v 1.21 2002/07/28 01:39:14 krw Exp $
#	$NetBSD: RAMDISK,v 1.3.4.1 1996/08/19 23:35:10 gwr Exp $

# Machine architecture; required by config(8)
machine		sun3 m68k

# maxusers means mostly "let's get small" in terms of kernel malloc's
maxusers	2
# force default minimum number of buffers and dependents
option		NBUF=16

# Enable the hooks used for initializing the ram-disk.
option	 	RAMDISK_HOOKS
option	 	MINIROOTSIZE=3000

#option		DDB

option		TIMEZONE=0
option		DST=0

option		DIAGNOSTIC
option		FFS
#option		NFSCLIENT
#option		CD9660
option		INET
option		BOOT_CONFIG

# XXX - Work-around for root on slow SunOS/Sun3 servers (sigh...)
option	 	NFS_BOOT_RWSIZE=1024

# Machines to be supported by this kernel
option	 	FPU_EMULATE		# XXX - Should not be needed!
option	 	HAVECACHE		# Sun3/260 VAC

# Generic swap; second partition of root disk or network.
config		bsd root on rd0a swap on rd0b

# The root node:
mainbus0 at root

# device space
obio0  at mainbus?
# main memory
obmem0 at mainbus?
# VME D16 space
vmes0 at mainbus?
# VME D32 space
vmel0 at mainbus?

# Devices that should be present in any Sun3 kernel.

# OBIO
zsc0    at obio0 addr 0x000000
zsc1    at obio0 addr 0x020000
eeprom0 at obio0 addr 0x040000
clock0  at obio0 addr 0x060000
memerr0 at obio0 addr 0x080000
intreg0 at obio0 addr 0x0A0000

#
# Serial ports
#
zstty0 at zsc1 channel 0	# ttya
zstty1 at zsc1 channel 1	# ttyb

kbd0   at zsc0 channel 0	# keyboard
ms0    at zsc0 channel 1	# mouse

#
# Network devices
#

# Intel Ethernet (onboard, or VME)
ie0 at obio0 addr   0x0C0000 level 3
ie1 at vmes0 addr 0xffe88000 level 3 vect 0x75

# Lance Ethernet (only onboard)
le0 at obio0 addr   0x120000 level 3
# All Sun3 machines with an "le" (3/50, 3/60) should be
# presumed to have the old, buggy LANCE chip. (Rev. C)
options 	LANCE_REVC_BUG

#
# Disk and tape devices
#

# Sun3 "si" SCSI controller (NCR 5380)
si0 at obio0 addr   0x140000 level 2 flags 0x07
si0 at vmes0 addr 0xff200000 level 2 vect 0x40 flags 0x07
si1 at vmes0 addr 0xff204000 level 2 vect 0x41 flags 0x07

# Xylogics 7053 controllers
# xdc0 at vmel0 addr 0xffffee80 level 2 vect 0x44
# xdc1 at vmel0 addr 0xffffee90 level 2 vect 0x45
# xd* at xdc? drive ?

# Xylogics 450/451 controllers
# xyc0 at vmes0 addr 0xffffee40 level 2 vect 0x48
# xyc1 at vmes0 addr 0xffffee48 level 2 vect 0x49
# xy* at xyc? drive ?

# Xylogics 472 tape controllers?

#
# Frame buffer devices
# (Not needed for the RAMDISK installation kernel)

#
# SCSI infrastructure
#
scsibus* at scsi?

sd* at scsibus? target ? lun ?
st* at scsibus? target ? lun ?
cd* at scsibus? target ? lun ?

# RAM-disk (root for install tape)
pseudo-device	rd		2	# RAM-disk
pseudo-device	loop		1	# network loopback
@


1.21
log
@Add 'option NFSCLIENT' to macppc RAMDISK.

Delete (comment out) 'option NFSCLIENT' in sparc, sparc64, and sun3
RAMDISKs.

This brings the presence of /sbin/mount_nfs in the boot image and the
presence of NFSCLIENT in the RAMDISK kernel into alignment. Except for
sparc64 which will now have mount_nfs removed from the boot image to
save space.

mvme88k RAMDISK did not need to be adjusted as it only *looks* like it
does not have NFSCLIENT. It actually includes the system GENERIC.

Investigation for inconsistancies prompted by todd@@.

This solution recommended by deraadt@@.
@
text
@d1 1
a1 1
#	$OpenBSD: RAMDISK,v 1.20 2001/10/10 23:43:42 millert Exp $
@


1.20
log
@gc SWAPPAGER and DEVPAGER options
@
text
@d1 1
a1 1
#	$OpenBSD: RAMDISK,v 1.19 2001/09/22 20:44:48 deraadt Exp $
d23 1
a23 1
option		NFSCLIENT
@


1.20.4.1
log
@sync to -current
@
text
@d1 1
a1 1
#	$OpenBSD: RAMDISK,v 1.20 2001/10/10 23:43:42 millert Exp $
d23 1
a23 1
#option		NFSCLIENT
@


1.20.4.2
log
@sync
@
text
@d1 1
a1 1
#	$OpenBSD: RAMDISK,v 1.20.4.1 2002/10/29 00:28:12 art Exp $
@


1.19
log
@pty cleanup
@
text
@d1 1
a1 1
#	$OpenBSD: RAMDISK,v 1.18 2001/06/23 19:46:59 deraadt Exp $
a26 2
option		SWAPPAGER
option		DEVPAGER
@


1.18
log
@no more kernfs
@
text
@d1 1
a1 1
#	$OpenBSD: RAMDISK,v 1.17 2001/01/03 02:03:28 miod Exp $
a121 1
pseudo-device	pty		4	# pseudo-terminals
@


1.17
log
@Sync with GENERIC, minor cleanups.
@
text
@d1 1
a1 1
#	$OpenBSD: RAMDISK,v 1.16 2000/06/19 01:22:34 miod Exp $
a24 1
option		KERNFS
@


1.16
log
@Small, usable, and it even boots on 4Mb machines
@
text
@d1 1
a1 1
#	$OpenBSD: RAMDISK,v 1.15 2000/05/26 00:44:21 miod Exp $
a115 5
# Sun compatible scsi device mappings
sd0 at scsibus? target 0 lun 0
sd1 at scsibus? target 0 lun 1
sd2 at scsibus? target 1 lun 0
sd3 at scsibus? target 1 lun 1
a116 3

st0 at scsibus? target 4 lun 0
st1 at scsibus? target 5 lun 0
d118 1
a118 3

#cd0 at scsibus? target 6 lun 0
#cd* at scsibus? target ? lun ?
@


1.15
log
@Use ../../../conf/GENERIC for standard set of options; general cleanup
@
text
@d1 1
a1 1
#	$OpenBSD: RAMDISK,v 1.14 2000/05/26 00:07:27 miod Exp $
d4 29
a32 7
#
# RAMDISK: Root/swap on ramdisk
# This kernel is used to:
#	format the disk (not yet implemented)
#	partition the disk (disklabel)
#	install the miniroot in the swap partition
#
d34 3
d38 2
a39 1
machine	sun3 m68k
a62 48
# All Sun3 machines with an "le" (3/50, 3/60) should be
# presumed to have the old, buggy LANCE chip. (Rev. C)
options 	LANCE_REVC_BUG

# Machines to be supported by this kernel
option	 	FPU_EMULATE		# XXX - Should not be needed!
option	 	HAVECACHE		# Sun3/260 VAC

# Needs to be set per system.  i.e change these as you see fit
maxusers	2

# Debugging options.  Uncomment either this:
#option 	DDB
# ... or these two: (for KGDB on another machine)
#makeoptions DEBUG="-g"			# symbols for kgdb + nm
#option	 	KGDB

# Enable the hooks used for initializing the ram-disk.
option	 	RAMDISK_HOOKS
option	 	MINIROOTSIZE=512	# 256K

# Filesystem options
# May need NFSCLIENT to get miniroot image
option	 	NFSCLIENT	# nfs client support
# Need FFS for the ramdisk image
option	 	FFS		# ufs file system
option	 	FIFO		# FIFOs; RECOMMENDED

# Networking options
option	 	INET		# IP prototol stack support
#option	 	TCP_COMPAT_42	# TCP bug compatibility with 4.2BSD
# XXX - Work-around for root on slow SunOS/Sun3 servers (sigh...)
option	 	NFS_BOOT_RWSIZE=1024

# Compatability options
#option 	COMPAT_SUNOS	# can run SunOS 4.1.1 executables
#option 	COMPAT_43	# and 4.3BSD and ...
#option 	COMPAT_10	# NetBSD 1.0
option	 	COMPAT_11	# NetBSD 1.1
option	 	COMPAT_12	# NetBSD 1.2

# Sun3-specific debugging options
option	 	DIAGNOSTIC

# The config program assumes all devices have partions...
# Is it OK to put swap on a non-existent partition?
config		bsd root on rd0a swap on rd0b

d77 1
a77 1
ie0 at obio0 addr ? level ?
d81 4
a84 1
le0 at obio0 addr ? level ?
d91 3
a93 3
si0 at obio0 addr ? level ?
si0 at vmes0 addr 0xff200000 level 2 vect 0x40
si1 at vmes0 addr 0xff204000 level 2 vect 0x41
d127 2
a128 4
cd0 at scsibus? target 6 lun 0
cd* at scsibus? target ? lun ?

#ch* at scsibus? target ? lun ?
a131 1

d133 1
a133 13
pseudo-device	bpfilter 	8	# packet filter
pseudo-device	sl		2	# CSLIP
pseudo-device	ppp		2	# PPP
pseudo-device	tun		2	# network tunneling over tty
pseudo-device	enc		4	# encryption device

pseudo-device	pty		64	# pseudo-terminals
#pseudo-device	vnd		4	# paging to files
pseudo-device	ksyms		1	# kernel symbols device

# for IPv6
pseudo-device	gif		4
#pseudo-device	faith		1
@


1.14
log
@Disable TCP 4.2 compatibility bugs by default
@
text
@d1 1
a1 1
#	$OpenBSD: RAMDISK,v 1.13 2000/04/30 15:27:57 miod Exp $
d12 28
a39 1
include "arch/sun3/conf/std.sun3"
@


1.13
log
@Add $OpenBSD$, update pseudo-device settings
@
text
@d1 1
a1 1
#	$OpenBSD$
d40 1
a40 1
option	 	TCP_COMPAT_42	# TCP bug compatibility with 4.2BSD
@


1.12
log
@s/options/option/
@
text
@d1 1
d125 1
a125 1
pseudo-device	rd	2		# RAM-disk
d127 14
a140 4
# Misc.
pseudo-device	loop	1		# network loopback
pseudo-device	sl	2		# CSLIP
pseudo-device	ppp	2		# PPP
@


1.12.12.1
log
@Continue the aborted merge of current just before 2.9 was cut into the
SMP branch.  Note that this will not make any progress of SMP functionality,
it is just merging of new code from the trunk into the old branch.
Please do not ask me questions about SMP status because of this mail,
instead go read the archives of smp@@openbsd.org, where I mailed about
these commits some week ago.  Another note: I am doing this in chunks now,
so as to not lock too much of the tree for long times
@
text
@a0 1
#	$OpenBSD: RAMDISK,v 1.17 2001/01/03 02:03:28 miod Exp $
d3 9
a11 2
# Machine architecture; required by config(8)
machine		sun3 m68k
d13 5
a17 1
# maxusers means mostly "let's get small" in terms of kernel malloc's
d19 6
a24 2
# force default minimum number of buffers and dependents
option		NBUF=16
d28 1
a28 16
option	 	MINIROOTSIZE=3000

#option		DDB

option		TIMEZONE=0
option		DST=0

option		DIAGNOSTIC
option		FFS
option		NFSCLIENT
#option		CD9660
option		KERNFS
option		INET
option		BOOT_CONFIG
option		SWAPPAGER
option		DEVPAGER
d30 10
d43 9
a51 3
# Machines to be supported by this kernel
option	 	FPU_EMULATE		# XXX - Should not be needed!
option	 	HAVECACHE		# Sun3/260 VAC
d53 2
a54 1
# Generic swap; second partition of root disk or network.
a56 22
# The root node:
mainbus0 at root

# device space
obio0  at mainbus?
# main memory
obmem0 at mainbus?
# VME D16 space
vmes0 at mainbus?
# VME D32 space
vmel0 at mainbus?

# Devices that should be present in any Sun3 kernel.

# OBIO
zsc0    at obio0 addr 0x000000
zsc1    at obio0 addr 0x020000
eeprom0 at obio0 addr 0x040000
clock0  at obio0 addr 0x060000
memerr0 at obio0 addr 0x080000
intreg0 at obio0 addr 0x0A0000

d71 1
a71 1
ie0 at obio0 addr   0x0C0000 level 3
d75 1
a75 4
le0 at obio0 addr   0x120000 level 3
# All Sun3 machines with an "le" (3/50, 3/60) should be
# presumed to have the old, buggy LANCE chip. (Rev. C)
options 	LANCE_REVC_BUG
d82 3
a84 3
si0 at obio0 addr   0x140000 level 2 flags 0x07
si0 at vmes0 addr 0xff200000 level 2 vect 0x40 flags 0x07
si1 at vmes0 addr 0xff204000 level 2 vect 0x41 flags 0x07
d107 5
d113 3
d117 2
d121 2
d124 6
a129 3
pseudo-device	rd		2	# RAM-disk
pseudo-device	loop		1	# network loopback
pseudo-device	pty		4	# pseudo-terminals
@


1.12.12.2
log
@Merge in -current from two days ago in the SMP branch.
As usual with merges, they do not indicate progress, so do not hold
your breath for working SMP, and do not mail me and ask about the
state of it.  It has not changed.  There is work ongoing, but very, very
slowly.  The commit is done in parts as to not lock up the tree in too
big chunks at a time.
@
text
@d1 1
a1 1
#	$OpenBSD: RAMDISK,v 1.12.12.1 2001/05/14 21:37:24 niklas Exp $
d25 1
@


1.12.12.3
log
@Sync the SMP branch to something just after 3.0
@
text
@d1 1
a1 1
#	$OpenBSD: RAMDISK,v 1.12.12.2 2001/07/04 10:23:52 niklas Exp $
d27 2
d122 1
@


1.12.12.4
log
@Sync the SMP branch with 3.3
@
text
@d1 1
a1 1
#	$OpenBSD: RAMDISK,v 1.12.12.3 2001/10/31 03:07:59 nate Exp $
@


1.11
log
@no more VNODEPAGER #define
@
text
@d14 2
a15 2
options 	FPU_EMULATE		# XXX - Should not be needed!
options 	HAVECACHE		# Sun3/260 VAC
d21 1
a21 1
#options 	DDB
d23 2
a24 2
makeoptions DEBUG="-g"			# symbols for kgdb + nm
options 	KGDB
d27 2
a28 2
options 	RAMDISK_HOOKS
options 	MINIROOTSIZE=512	# 256K
d32 1
a32 1
options 	NFSCLIENT	# nfs client support
d34 2
a35 2
options 	FFS		# ufs file system
options 	FIFO		# FIFOs; RECOMMENDED
d38 2
a39 2
options 	INET		# IP prototol stack support
options 	TCP_COMPAT_42	# TCP bug compatibility with 4.2BSD
d41 1
a41 1
options 	NFS_BOOT_RWSIZE=1024
d44 5
a48 5
#options 	COMPAT_SUNOS	# can run SunOS 4.1.1 executables
#options 	COMPAT_43	# and 4.3BSD and ...
#options 	COMPAT_10	# NetBSD 1.0
options 	COMPAT_11	# NetBSD 1.1
options 	COMPAT_12	# NetBSD 1.2
d51 1
a51 1
options 	DIAGNOSTIC
a129 1

@


1.10
log
@include "std.sun3" -> include "arch/sun3/conf/std.sun3"
@
text
@a48 1
options 	UCONSOLE	# Allow non-root TIOCCONS
@


1.9
log
@sync with NetBSD
@
text
@d11 1
a11 1
include "std.sun3"
@


1.8
log
@kernel is bsd
@
text
@a19 3
# Standard system options
options 	SWAPPAGER, VNODEPAGER, DEVPAGER	# paging

@


1.7
log
@sync + our changes
@
text
@d59 1
a59 1
config		netbsd root on rd0a swap on rd0b
@


1.6
log
@do not fool people into thinking VNODEPAGER is an option; netbsd pr#2757, erik@@aarhus1.uni-c.dk
@
text
@d1 1
a1 1
#	$NetBSD: RAMDISK,v 1.3 1996/03/26 15:15:53 gwr Exp $
d14 1
d21 3
a23 2
options		SWAPPAGER			# paging
#makeoptions	DEBUG="-g"			# symbols for kgdb + nm
d25 3
d35 1
a35 1
options 	NFSCLIENT			# nfs client support
d37 2
a38 2
options 	FFS				# ufs file system
options		FIFO		# FIFOs; RECOMMENDED
d41 2
a42 1
options		INET				# IP prototol stack support
d48 5
a52 6
#options 	COMPAT_09	# NetBSD 0.9,
options 	COMPAT_10	# NetBSD 1.0,
options 	COMPAT_11	# NetBSD 1.1,
options 	COMPAT_43	# and 4.3BSD
#options 	TCP_COMPAT_42	# TCP bug compatibility with 4.2BSD
#options 	UCONSOLE	# Allow non-root TIOCCONS
d59 1
a59 1
config		bsd root on rd0a swap on rd0b
@


1.5
log
@disable TCP_COMPAT_42
@
text
@d20 1
a20 1
options		SWAPPAGER, VNODEPAGER, DEVPAGER	# paging
@


1.4
log
@sync with 0430
@
text
@d46 1
a46 1
options 	TCP_COMPAT_42	# TCP bug compatibility with 4.2BSD
@


1.3
log
@update from netbsd (verbatim)
@
text
@d1 1
a1 1
#	$NetBSD: RAMDISK,v 1.2 1995/11/17 23:31:15 gwr Exp $
d37 2
d40 1
a40 1
# Compatability options (XXX - Need these?)
d44 1
d47 1
d54 10
a63 1
config		netbsd root on rd0a swap on rd0b
d81 3
a83 3
ncr_si0 at obio0 addr ? level ?
ncr_si0 at vmes0 addr 0xff200000 level 2 vect 0x40
ncr_si1 at vmes0 addr 0xff204000 level 2 vect 0x41
d122 2
a123 3

# RAM Disk (root for install tape)
rd0 at mainbus?
@


1.2
log
@from netbsd; Switch to ncr_si (will just do PIO for now) and cleanup
@
text
@d1 1
a1 1
#	$NetBSD: RAMDISK,v 1.1.2.1 1995/11/18 07:16:14 gwr Exp $
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
#	$NetBSD: RAMDISK,v 1.1 1995/10/08 23:38:44 gwr Exp $
a15 4
# Enable the hooks used for initializing the ram-disk.
options 	RAMDISK_HOOKS
options 	MINIROOTSIZE=512	# 256K

d21 6
a36 2
# XXX - Work-around for slow SunOS/Sun3 servers (sigh...)
options 	NFS_BOOT_RWSIZE=1024
a45 1
# options 	DDB
d52 3
a54 6
# Devices

# RAM Disk (root for install tape)
rd0 at mainbus?

# No frame-buffer devices.
d56 1
d60 1
d63 24
a86 2
si0 at obio0 addr ? level ?
si0 at vmes0 addr 0xff200000 level 2 vect 0x40
d88 3
d109 5
d115 2
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
