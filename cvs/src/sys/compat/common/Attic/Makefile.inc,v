head	1.8;
access;
symbols
	OPENBSD_4_2:1.7.0.22
	OPENBSD_4_2_BASE:1.7
	OPENBSD_4_1:1.7.0.20
	OPENBSD_4_1_BASE:1.7
	OPENBSD_4_0:1.7.0.18
	OPENBSD_4_0_BASE:1.7
	OPENBSD_3_9:1.7.0.16
	OPENBSD_3_9_BASE:1.7
	OPENBSD_3_8:1.7.0.14
	OPENBSD_3_8_BASE:1.7
	OPENBSD_3_7:1.7.0.12
	OPENBSD_3_7_BASE:1.7
	OPENBSD_3_6:1.7.0.10
	OPENBSD_3_6_BASE:1.7
	SMP_SYNC_A:1.7
	SMP_SYNC_B:1.7
	OPENBSD_3_5:1.7.0.8
	OPENBSD_3_5_BASE:1.7
	OPENBSD_3_4:1.7.0.6
	OPENBSD_3_4_BASE:1.7
	UBC_SYNC_A:1.7
	OPENBSD_3_3:1.7.0.4
	OPENBSD_3_3_BASE:1.7
	OPENBSD_3_2:1.7.0.2
	OPENBSD_3_2_BASE:1.7
	OPENBSD_3_1:1.6.0.24
	OPENBSD_3_1_BASE:1.6
	UBC_SYNC_B:1.7
	UBC:1.6.0.22
	UBC_BASE:1.6
	OPENBSD_3_0:1.6.0.20
	OPENBSD_3_0_BASE:1.6
	OPENBSD_2_9_BASE:1.6
	OPENBSD_2_9:1.6.0.18
	OPENBSD_2_8:1.6.0.16
	OPENBSD_2_8_BASE:1.6
	OPENBSD_2_7:1.6.0.14
	OPENBSD_2_7_BASE:1.6
	SMP:1.6.0.12
	SMP_BASE:1.6
	kame_19991208:1.6
	OPENBSD_2_6:1.6.0.10
	OPENBSD_2_6_BASE:1.6
	OPENBSD_2_5:1.6.0.8
	OPENBSD_2_5_BASE:1.6
	OPENBSD_2_4:1.6.0.6
	OPENBSD_2_4_BASE:1.6
	OPENBSD_2_3:1.6.0.4
	OPENBSD_2_3_BASE:1.6
	OPENBSD_2_2:1.6.0.2
	OPENBSD_2_2_BASE:1.6
	OPENBSD_2_1:1.5.0.4
	OPENBSD_2_1_BASE:1.5
	OPENBSD_2_0:1.5.0.2
	OPENBSD_2_0_BASE:1.5
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@# @;


1.8
date	2007.11.25.11.23.33;	author deraadt;	state dead;
branches;
next	1.7;

1.7
date	2002.07.14.09.20.24;	author mdw;	state Exp;
branches;
next	1.6;

1.6
date	97.05.30.09.40.57;	author niklas;	state Exp;
branches
	1.6.12.1
	1.6.22.1;
next	1.5;

1.5
date	96.05.23.08.32.21;	author deraadt;	state Exp;
branches;
next	1.4;

1.4
date	96.05.22.12.01.44;	author deraadt;	state Exp;
branches;
next	1.3;

1.3
date	96.03.03.05.26.22;	author mickey;	state Exp;
branches;
next	1.2;

1.2
date	96.02.26.23.26.49;	author niklas;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.52.12;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.52.12;	author deraadt;	state Exp;
branches;
next	;

1.6.12.1
date	2003.03.27.23.53.47;	author niklas;	state Exp;
branches;
next	;

1.6.22.1
date	2002.10.29.00.30.51;	author art;	state Exp;
branches;
next	;


desc
@@


1.8
log
@Get rid of the kernel 'libcompat' framework, and instead use conf/files to
decide which files must be pulled into the kernel.  Also conditionalize
the pulling of those files based on the COMPAT_* options.
@
text
@#	$OpenBSD: Makefile.inc,v 1.7 2002/07/14 09:20:24 mdw Exp $
#	$NetBSD: Makefile.inc,v 1.5 1996/05/20 17:23:59 mrg Exp $
#
#	NOTE: $S must correspond to the top of the 'sys' tree

PWD!=		pwd
COMPATDIR!=	cd $S/compat/common; pwd
COMPATDST?=	lib/compat
COMPATLIB=	${COMPATDST}/libcompat.a
COMPATLIB_PROF=	${COMPATDST}/libcompat_p.a

COMPATMAKE= \
	cd ${COMPATDST} && ${MAKE} -f ${COMPATDIR}/Makefile \
	    CC="${CC}" CFLAGS="${CFLAGS:S/-I./-I${PWD}\/./g}" \
	    LD="${LD}" AR="${AR}" RANLIB="${RANLIB}" LORDER="${LORDER}" \
	    NM="${NM}" \
	    XMACHINE='${MACHINE}' XMACHINE_ARCH='${MACHINE_ARCH}' \
	    CPPFLAGS="${CPPFLAGS:S/-I./-I${PWD}\/./g}" \
	    COMPATDIR="${COMPATDIR}"

${COMPATLIB}:		.NOTMAIN __always_make_compatlib
	@@echo making sure the compat library is up to date...
	@@${COMPATMAKE} libcompat.a

${COMPATLIB_PROF}:	.NOTMAIN __always_make_compatlib
	@@echo making sure the profiled compat library is up to date...
	@@${COMPATMAKE} libcompat_p.a

clean:: 		.NOTMAIN __always_make_compatlib
	@@echo cleaning the compat library objects
	@@${COMPATMAKE} clean

depend:: 		.NOTMAIN __always_make_compatlib
	@@echo depending the compat library objects
	@@${COMPATMAKE} depend

__always_make_compatlib:	.NOTMAIN
	@@mkdir -p ${COMPATDST}
@


1.7
log
@More glue needed for cross-compilation
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.6 1997/05/30 09:40:57 niklas Exp $
@


1.6
log
@Build nicely when $S is absolute
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.5 1996/05/23 08:32:21 deraadt Exp $
d17 1
@


1.6.12.1
log
@Sync the SMP branch with 3.3
@
text
@d1 1
a1 1
#	$OpenBSD$
a16 1
	    XMACHINE='${MACHINE}' XMACHINE_ARCH='${MACHINE_ARCH}' \
@


1.6.22.1
log
@sync to -current
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.6 1997/05/30 09:40:57 niklas Exp $
a16 1
	    XMACHINE='${MACHINE}' XMACHINE_ARCH='${MACHINE_ARCH}' \
@


1.5
log
@sync
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.4 1996/05/22 12:01:44 deraadt Exp $
d6 2
a7 2
COMPATDIR=	$S/compat/common

a8 1
COMPATREL?=	../../
d13 5
a17 5
	cd ${COMPATDST} && ${MAKE} -f ${COMPATREL}${COMPATDIR}/Makefile \
	    CC="${CC}" CFLAGS="${CFLAGS:S/-I./-I${COMPATREL}./g}" \
	    LD="${LD}" \
	    COMPATCPPFLAGS="${CPPFLAGS}" \
	    COMPATREL="${COMPATREL}" \
@


1.4
log
@sync
@
text
@d1 2
a2 2
#	$OpenBSD: Makefile.inc,v 1.2 1996/02/26 23:26:49 niklas Exp $
#	$NetBSD: Makefile.inc,v 1.4 1996/05/11 16:13:31 mycroft Exp $
@


1.3
log
@Makefiles seemed to be broken a bit, i don't even
know how it happens to work still ... probably nobody rebuilt libcompat.a.
Fron NetBSD: kern_info_*.c, seemed to be a bug fix.
@
text
@d2 1
a2 1
#	$NetBSD: Makefile.inc,v 1.3 1996/02/02 20:34:44 mycroft Exp $
d32 4
@


1.2
log
@From NetBSD: update to 960217 sources
@
text
@d1 1
a1 1
#	$OpenBSD$
d15 1
a15 1
	    CC="${CC}" CFLAGS="${CFLAGS}" \
@


1.1
log
@Initial revision
@
text
@d1 2
a2 1
#	$NetBSD: Makefile.inc,v 1.2 1995/06/26 03:27:15 christos Exp $
d8 2
a9 2
COMPATDST?=      lib/compat
COMPATREL?=      ../../
d13 8
d23 1
a23 5
	@@(cd ${COMPATDST} && ${MAKE} -f ${COMPATREL}${COMPATDIR}/Makefile \
	  COMPATCC="${CC}" \
	  COMPATCFLAGS="${CFLAGS}" \
	  COMPATREL="${COMPATREL}" \
	  COMPATDIR="${COMPATDIR}" libcompat.a)
d27 1
a27 5
	@@(cd ${COMPATDST} && ${MAKE} -f ${COMPATREL}${COMPATDIR}/Makefile \
	  COMPATCC="${CC}" \
	  COMPATCFLAGS="${CFLAGS}" \
	  COMPATREL="${COMPATREL}" \
	  COMPATDIR="${COMPATDIR}" libcompat_p.a)
d31 1
a31 5
	@@(cd ${COMPATDST} && ${MAKE} -f ${COMPATREL}${COMPATDIR}/Makefile \
	  COMPATCC="${CC}" \
	  COMPATCFLAGS="${CFLAGS}" \
	  COMPATREL="${COMPATREL}" \
	  COMPATDIR="${COMPATDIR}" clean)
d34 1
a34 1
	@@([ -d ${COMPATDST} ] || mkdir -p ${COMPATDST})
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
