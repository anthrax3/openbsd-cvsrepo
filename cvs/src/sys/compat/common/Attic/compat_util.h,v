head	1.10;
access;
symbols
	OPENBSD_5_9:1.9.0.6
	OPENBSD_5_9_BASE:1.9
	OPENBSD_5_8:1.9.0.8
	OPENBSD_5_8_BASE:1.9
	OPENBSD_5_7:1.9.0.2
	OPENBSD_5_7_BASE:1.9
	OPENBSD_5_6:1.9.0.4
	OPENBSD_5_6_BASE:1.9
	OPENBSD_5_5:1.8.0.4
	OPENBSD_5_5_BASE:1.8
	OPENBSD_5_4:1.7.0.48
	OPENBSD_5_4_BASE:1.7
	OPENBSD_5_3:1.7.0.46
	OPENBSD_5_3_BASE:1.7
	OPENBSD_5_2:1.7.0.44
	OPENBSD_5_2_BASE:1.7
	OPENBSD_5_1_BASE:1.7
	OPENBSD_5_1:1.7.0.42
	OPENBSD_5_0:1.7.0.40
	OPENBSD_5_0_BASE:1.7
	OPENBSD_4_9:1.7.0.38
	OPENBSD_4_9_BASE:1.7
	OPENBSD_4_8:1.7.0.36
	OPENBSD_4_8_BASE:1.7
	OPENBSD_4_7:1.7.0.32
	OPENBSD_4_7_BASE:1.7
	OPENBSD_4_6:1.7.0.34
	OPENBSD_4_6_BASE:1.7
	OPENBSD_4_5:1.7.0.30
	OPENBSD_4_5_BASE:1.7
	OPENBSD_4_4:1.7.0.28
	OPENBSD_4_4_BASE:1.7
	OPENBSD_4_3:1.7.0.26
	OPENBSD_4_3_BASE:1.7
	OPENBSD_4_2:1.7.0.24
	OPENBSD_4_2_BASE:1.7
	OPENBSD_4_1:1.7.0.22
	OPENBSD_4_1_BASE:1.7
	OPENBSD_4_0:1.7.0.20
	OPENBSD_4_0_BASE:1.7
	OPENBSD_3_9:1.7.0.18
	OPENBSD_3_9_BASE:1.7
	OPENBSD_3_8:1.7.0.16
	OPENBSD_3_8_BASE:1.7
	OPENBSD_3_7:1.7.0.14
	OPENBSD_3_7_BASE:1.7
	OPENBSD_3_6:1.7.0.12
	OPENBSD_3_6_BASE:1.7
	SMP_SYNC_A:1.7
	SMP_SYNC_B:1.7
	OPENBSD_3_5:1.7.0.10
	OPENBSD_3_5_BASE:1.7
	OPENBSD_3_4:1.7.0.8
	OPENBSD_3_4_BASE:1.7
	UBC_SYNC_A:1.7
	OPENBSD_3_3:1.7.0.6
	OPENBSD_3_3_BASE:1.7
	OPENBSD_3_2:1.7.0.4
	OPENBSD_3_2_BASE:1.7
	OPENBSD_3_1:1.7.0.2
	OPENBSD_3_1_BASE:1.7
	UBC_SYNC_B:1.7
	UBC:1.6.0.2
	UBC_BASE:1.6
	OPENBSD_3_0:1.5.0.2
	OPENBSD_3_0_BASE:1.5
	OPENBSD_2_9_BASE:1.4
	OPENBSD_2_9:1.4.0.4
	OPENBSD_2_8:1.4.0.2
	OPENBSD_2_8_BASE:1.4
	OPENBSD_2_7:1.3.0.6
	OPENBSD_2_7_BASE:1.3
	SMP:1.3.0.4
	SMP_BASE:1.3
	kame_19991208:1.3
	OPENBSD_2_6:1.3.0.2
	OPENBSD_2_6_BASE:1.3
	OPENBSD_2_5:1.2.0.12
	OPENBSD_2_5_BASE:1.2
	OPENBSD_2_4:1.2.0.10
	OPENBSD_2_4_BASE:1.2
	OPENBSD_2_3:1.2.0.8
	OPENBSD_2_3_BASE:1.2
	OPENBSD_2_2:1.2.0.6
	OPENBSD_2_2_BASE:1.2
	OPENBSD_2_1:1.2.0.4
	OPENBSD_2_1_BASE:1.2
	OPENBSD_2_0:1.2.0.2
	OPENBSD_2_0_BASE:1.2
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@ * @;


1.10
date	2016.03.02.15.41.47;	author naddy;	state dead;
branches;
next	1.9;
commitid	ZfNt0OHZhMg52abA;

1.9
date	2014.03.26.05.23.42;	author guenther;	state Exp;
branches;
next	1.8;

1.8
date	2014.01.15.05.31.51;	author deraadt;	state Exp;
branches;
next	1.7;

1.7
date	2002.03.14.01.26.49;	author millert;	state Exp;
branches;
next	1.6;

1.6
date	2001.11.06.19.53.17;	author miod;	state Exp;
branches
	1.6.2.1;
next	1.5;

1.5
date	2001.08.12.20.33.50;	author mickey;	state Exp;
branches;
next	1.4;

1.4
date	2000.07.27.18.32.35;	author ericj;	state Exp;
branches;
next	1.3;

1.3
date	99.09.17.09.39.21;	author deraadt;	state Exp;
branches
	1.3.4.1;
next	1.2;

1.2
date	96.08.02.20.34.41;	author niklas;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.52.12;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.52.12;	author deraadt;	state Exp;
branches;
next	;

1.3.4.1
date	2001.05.14.22.04.18;	author niklas;	state Exp;
branches;
next	1.3.4.2;

1.3.4.2
date	2001.10.31.03.11.45;	author nate;	state Exp;
branches;
next	1.3.4.3;

1.3.4.3
date	2001.11.13.21.05.47;	author niklas;	state Exp;
branches;
next	1.3.4.4;

1.3.4.4
date	2002.03.28.11.28.05;	author niklas;	state Exp;
branches;
next	;

1.6.2.1
date	2002.06.11.03.28.07;	author art;	state Exp;
branches;
next	;


desc
@@


1.10
log
@remove the Linux emulation code, no longer referenced by anything
@
text
@/*	$OpenBSD: compat_util.h,v 1.9 2014/03/26 05:23:42 guenther Exp $	*/
/*	$NetBSD: compat_util.h,v 1.1 1995/06/24 20:16:05 christos Exp $	*/

/*
 * Copyright (c) 1994 Christos Zoulas
 * Copyright (c) 1995 Frank van der Linden
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. The name of the author may not be used to endorse or promote products
 *    derived from this software without specific prior written permission
 *
 * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
 * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
 * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
 * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
 * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
 * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 */

#ifndef	_COMPAT_UTIL_H_
#define	_COMPAT_UTIL_H_

#include <sys/exec.h>

struct proc;

caddr_t stackgap_init(struct proc *);
void    *stackgap_alloc(caddr_t *, size_t);

int emul_find(struct proc *, caddr_t *, const char *, char *, char **, int);

#define CHECK_ALT_EXIST(p, sgp, root, path) \
    emul_find(p, sgp, root, path, &(path), 0)

#define CHECK_ALT_CREAT(p, sgp, root, path) \
    emul_find(p, sgp, root, path, &(path), 1)

#endif /* !_COMPAT_UTIL_H_ */
@


1.9
log
@Move p_emul and p_sigcode from proc to process.
Tweak the handling of ktrace EMUL when changing ktracing: only
generate one per process (not one per thread) and pass the correct
proc pointer down to the VFS layer.  Permit generating of NAMI and
CSW records inside ktrace(2) itself.

ok deraadt@@ millert@@
@
text
@d1 1
a1 1
/*	$OpenBSD: compat_util.h,v 1.8 2014/01/15 05:31:51 deraadt Exp $	*/
@


1.8
log
@remove functions that were uses by other (non-linux) compat; and
convert to ANSI protos while here
@
text
@d1 1
a1 1
/*	$OpenBSD: compat_util.h,v 1.7 2002/03/14 01:26:49 millert Exp $	*/
d38 1
a38 1
struct emul;
d40 1
a40 1
caddr_t stackgap_init(struct emul *);
@


1.7
log
@First round of __P removal in sys
@
text
@d1 1
a1 1
/*	$OpenBSD: compat_util.h,v 1.6 2001/11/06 19:53:17 miod Exp $	*/
a35 1
#include <uvm/uvm_extern.h>
a38 1
/* struct proc; */
d43 1
a43 11
struct emul_flags_xtab {
        unsigned long omask;
        unsigned long oval;
        unsigned long nval;
};

int emul_find(struct proc *, caddr_t *, const char *, char *,
		   char **, int);

unsigned long emul_flags_translate(const struct emul_flags_xtab *tab,
		   unsigned long in, unsigned long *leftover);
@


1.6
log
@Replace inclusion of <vm/foo.h> with the correct <uvm/bar.h> when necessary.
(Look ma, I might have broken the tree)
@
text
@d1 1
a1 1
/*	$OpenBSD: compat_util.h,v 1.5 2001/08/12 20:33:50 mickey Exp $	*/
d42 2
a43 2
caddr_t stackgap_init __P((struct emul *));
void    *stackgap_alloc __P((caddr_t *, size_t));
d51 2
a52 2
int emul_find __P((struct proc *, caddr_t *, const char *, char *,
		   char **, int));
@


1.6.2.1
log
@Sync UBC branch to -current
@
text
@d1 1
a1 1
/*	$OpenBSD: compat_util.h,v 1.6 2001/11/06 19:53:17 miod Exp $	*/
d42 2
a43 2
caddr_t stackgap_init(struct emul *);
void    *stackgap_alloc(caddr_t *, size_t);
d51 2
a52 2
int emul_find(struct proc *, caddr_t *, const char *, char *,
		   char **, int);
@


1.5
log
@absolutely no need to include vm_parm.h after vm.h
@
text
@d1 1
a1 1
/*	$OpenBSD: compat_util.h,v 1.4 2000/07/27 18:32:35 ericj Exp $	*/
d36 1
a36 1
#include <vm/vm.h>
@


1.4
log
@
some cleanup and add the emul_flags_translate from netbsd to translate
flags. deraadt@@ OK
@
text
@d1 1
a1 1
/*	$OpenBSD: compat_util.h,v 1.3 1999/09/17 09:39:21 deraadt Exp $	*/
a36 1
#include <vm/vm_param.h>
@


1.3
log
@bad style to include machine/vmparam.h carelessly
@
text
@d1 1
a1 1
/*	$OpenBSD: compat_util.h,v 1.2 1996/08/02 20:34:41 niklas Exp $	*/
a35 1
#include <sys/param.h>
a38 2
#include <sys/cdefs.h>
#include <sys/proc.h>
d40 2
a41 2
static __inline caddr_t	stackgap_init __P((struct emul *));
static __inline void *stackgap_alloc __P((caddr_t *, size_t));
d43 8
a50 18
static __inline caddr_t
stackgap_init(e)
	struct emul *e;
{
#define szsigcode ((caddr_t)(e->e_esigcode - e->e_sigcode))
	return STACKGAPBASE;
}


static __inline void *
stackgap_alloc(sgp, sz)
	caddr_t	*sgp;
	size_t   sz;
{
	void	*p = (void *) *sgp;
	*sgp += ALIGN(sz);
	return p;
}
d54 3
@


1.3.4.1
log
@merge in approximately 2.9 into SMP branch
@
text
@d1 1
a1 1
/*	$OpenBSD: compat_util.h,v 1.4 2000/07/27 18:32:35 ericj Exp $	*/
d36 1
d40 2
d43 2
a44 2
struct emul;
/* struct proc; */
d46 18
a63 8
caddr_t stackgap_init __P((struct emul *));
void    *stackgap_alloc __P((caddr_t *, size_t));

struct emul_flags_xtab {
        unsigned long omask;
        unsigned long oval;
        unsigned long nval;
};
a66 3

unsigned long emul_flags_translate(const struct emul_flags_xtab *tab,
		   unsigned long in, unsigned long *leftover);
@


1.3.4.2
log
@Sync the SMP branch to something just after 3.0
@
text
@d1 1
a1 1
/*	$OpenBSD: compat_util.h,v 1.3.4.1 2001/05/14 22:04:18 niklas Exp $	*/
d37 1
@


1.3.4.3
log
@Merge in -current
@
text
@d1 1
a1 1
/*	$OpenBSD$	*/
d36 1
a36 1
#include <uvm/uvm_extern.h>
@


1.3.4.4
log
@Merge in -current from about a week ago
@
text
@d42 2
a43 2
caddr_t stackgap_init(struct emul *);
void    *stackgap_alloc(caddr_t *, size_t);
d51 2
a52 2
int emul_find(struct proc *, caddr_t *, const char *, char *,
		   char **, int);
@


1.2
log
@Added Makefiles to build stuff from syscalls.master in some emulations.
Regenerated derived files from various syscalls.master files. Added $OpenBSD$.
@
text
@d1 1
a1 1
/*	$OpenBSD: compat_util.h,v 1.1 1995/06/24 20:16:05 christos Exp $	*/
d36 3
a38 1
#include <machine/vmparam.h>
@


1.1
log
@Initial revision
@
text
@d1 1
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
