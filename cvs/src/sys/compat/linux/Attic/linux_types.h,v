head	1.15;
access;
symbols
	OPENBSD_5_9:1.14.0.4
	OPENBSD_5_9_BASE:1.14
	OPENBSD_5_8:1.14.0.6
	OPENBSD_5_8_BASE:1.14
	OPENBSD_5_7:1.14.0.2
	OPENBSD_5_7_BASE:1.14
	OPENBSD_5_6:1.13.0.6
	OPENBSD_5_6_BASE:1.13
	OPENBSD_5_5:1.13.0.4
	OPENBSD_5_5_BASE:1.13
	OPENBSD_5_4:1.12.0.2
	OPENBSD_5_4_BASE:1.12
	OPENBSD_5_3:1.11.0.4
	OPENBSD_5_3_BASE:1.11
	OPENBSD_5_2:1.11.0.2
	OPENBSD_5_2_BASE:1.11
	OPENBSD_5_1_BASE:1.10
	OPENBSD_5_1:1.10.0.4
	OPENBSD_5_0:1.10.0.2
	OPENBSD_5_0_BASE:1.10
	OPENBSD_4_9:1.9.0.2
	OPENBSD_4_9_BASE:1.9
	OPENBSD_4_8:1.8.0.22
	OPENBSD_4_8_BASE:1.8
	OPENBSD_4_7:1.8.0.18
	OPENBSD_4_7_BASE:1.8
	OPENBSD_4_6:1.8.0.20
	OPENBSD_4_6_BASE:1.8
	OPENBSD_4_5:1.8.0.16
	OPENBSD_4_5_BASE:1.8
	OPENBSD_4_4:1.8.0.14
	OPENBSD_4_4_BASE:1.8
	OPENBSD_4_3:1.8.0.12
	OPENBSD_4_3_BASE:1.8
	OPENBSD_4_2:1.8.0.10
	OPENBSD_4_2_BASE:1.8
	OPENBSD_4_1:1.8.0.8
	OPENBSD_4_1_BASE:1.8
	OPENBSD_4_0:1.8.0.6
	OPENBSD_4_0_BASE:1.8
	OPENBSD_3_9:1.8.0.4
	OPENBSD_3_9_BASE:1.8
	OPENBSD_3_8:1.8.0.2
	OPENBSD_3_8_BASE:1.8
	OPENBSD_3_7:1.7.0.10
	OPENBSD_3_7_BASE:1.7
	OPENBSD_3_6:1.7.0.8
	OPENBSD_3_6_BASE:1.7
	SMP_SYNC_A:1.7
	SMP_SYNC_B:1.7
	OPENBSD_3_5:1.7.0.6
	OPENBSD_3_5_BASE:1.7
	OPENBSD_3_4:1.7.0.4
	OPENBSD_3_4_BASE:1.7
	UBC_SYNC_A:1.7
	OPENBSD_3_3:1.7.0.2
	OPENBSD_3_3_BASE:1.7
	OPENBSD_3_2:1.5.0.4
	OPENBSD_3_2_BASE:1.5
	OPENBSD_3_1:1.5.0.2
	OPENBSD_3_1_BASE:1.5
	UBC_SYNC_B:1.6
	UBC:1.4.0.6
	UBC_BASE:1.4
	OPENBSD_3_0:1.4.0.4
	OPENBSD_3_0_BASE:1.4
	OPENBSD_2_9_BASE:1.4
	OPENBSD_2_9:1.4.0.2
	OPENBSD_2_8:1.3.0.20
	OPENBSD_2_8_BASE:1.3
	OPENBSD_2_7:1.3.0.18
	OPENBSD_2_7_BASE:1.3
	SMP:1.3.0.16
	SMP_BASE:1.3
	kame_19991208:1.3
	OPENBSD_2_6:1.3.0.14
	OPENBSD_2_6_BASE:1.3
	OPENBSD_2_5:1.3.0.12
	OPENBSD_2_5_BASE:1.3
	OPENBSD_2_4:1.3.0.10
	OPENBSD_2_4_BASE:1.3
	OPENBSD_2_3:1.3.0.8
	OPENBSD_2_3_BASE:1.3
	OPENBSD_2_2:1.3.0.6
	OPENBSD_2_2_BASE:1.3
	OPENBSD_2_1:1.3.0.4
	OPENBSD_2_1_BASE:1.3
	OPENBSD_2_0:1.3.0.2
	OPENBSD_2_0_BASE:1.3
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@ * @;


1.15
date	2016.03.02.15.41.48;	author naddy;	state dead;
branches;
next	1.14;
commitid	ZfNt0OHZhMg52abA;

1.14
date	2014.09.08.01.47.06;	author guenther;	state Exp;
branches;
next	1.13;
commitid	QKTb36RFnfteZJPE;

1.13
date	2013.10.25.04.51.39;	author guenther;	state Exp;
branches;
next	1.12;

1.12
date	2013.05.10.10.31.16;	author pirofti;	state Exp;
branches;
next	1.11;

1.11
date	2012.05.23.11.08.57;	author pirofti;	state Exp;
branches;
next	1.10;

1.10
date	2011.04.05.22.54.31;	author pirofti;	state Exp;
branches;
next	1.9;

1.9
date	2011.02.10.11.58.43;	author pirofti;	state Exp;
branches;
next	1.8;

1.8
date	2005.05.19.18.27.28;	author mickey;	state Exp;
branches;
next	1.7;

1.7
date	2002.12.16.16.27.41;	author fgsch;	state Exp;
branches;
next	1.6;

1.6
date	2002.10.28.03.39.30;	author fgsch;	state Exp;
branches;
next	1.5;

1.5
date	2002.02.04.20.04.52;	author provos;	state Exp;
branches;
next	1.4;

1.4
date	2000.12.22.07.34.02;	author jasoni;	state Exp;
branches
	1.4.6.1;
next	1.3;

1.3
date	96.05.22.12.01.51;	author deraadt;	state Exp;
branches
	1.3.16.1;
next	1.2;

1.2
date	96.04.17.05.24.10;	author mickey;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.52.19;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.52.19;	author deraadt;	state Exp;
branches;
next	;

1.3.16.1
date	2001.05.14.22.04.54;	author niklas;	state Exp;
branches;
next	1.3.16.2;

1.3.16.2
date	2002.03.06.02.07.08;	author niklas;	state Exp;
branches;
next	1.3.16.3;

1.3.16.3
date	2003.03.27.23.53.47;	author niklas;	state Exp;
branches;
next	;

1.4.6.1
date	2002.06.11.03.28.08;	author art;	state Exp;
branches;
next	1.4.6.2;

1.4.6.2
date	2002.10.29.00.30.51;	author art;	state Exp;
branches;
next	1.4.6.3;

1.4.6.3
date	2003.05.19.21.52.09;	author tedu;	state Exp;
branches;
next	;


desc
@@


1.15
log
@remove the Linux emulation code, no longer referenced by anything
@
text
@/*	$OpenBSD: linux_types.h,v 1.14 2014/09/08 01:47:06 guenther Exp $	*/
/*	$NetBSD: linux_types.h,v 1.5 1996/05/20 01:59:28 fvdl Exp $	*/

/*
 * Copyright (c) 1995 Frank van der Linden
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 *      This product includes software developed for the NetBSD Project
 *      by Frank van der Linden
 * 4. The name of the author may not be used to endorse or promote products
 *    derived from this software without specific prior written permission
 *
 * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
 * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
 * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
 * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
 * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
 * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef _LINUX_TYPES_H_
#define _LINUX_TYPES_H_

typedef struct {
	long	val[2];
} linux_fsid_t;

typedef unsigned short linux_uid_t;
typedef unsigned short linux_gid_t;
typedef unsigned short linux_dev_t;
typedef unsigned long long linux_ino64_t;
typedef unsigned long linux_ino_t;
typedef unsigned short linux_mode_t;
typedef unsigned short linux_nlink_t;
typedef long linux_time_t;
typedef long linux_clock_t;
typedef long long linux_off64_t;
typedef long linux_off_t;
typedef u_int64_t linux_loff_t;
typedef int linux_pid_t;

#define LINUX_TIME_MAX	LONG_MAX
#define LINUX_INO_MAX	ULONG_MAX
#define LINUX_INO64_MAX	ULLONG_MAX

#define LINUX_FSTYPE_FFS	0x11954
#define LINUX_FSTYPE_NFS	0x6969
#define LINUX_FSTYPE_MSDOS	0x4d44
#define LINUX_FSTYPE_EXT2FS	0xef53
#define LINUX_FSTYPE_CD9660	0x9660
#define LINUX_FSTYPE_NCPFS	0x6969
#define LINUX_FSTYPE_NTFS	0x5346544e	/* "NTFS" */
#define LINUX_FSTYPE_UDF	0x15013346
#define LINUX_FSTYPE_AFS	0x5346414f

/*
 * Linux version of time-based structures, passed to many system calls
 */
struct linux_timespec {
	linux_time_t	tv_sec;
	long		tv_nsec;
};

struct linux_timeval {
	linux_time_t	tv_sec;
	long		tv_usec;
};

struct linux_itimerval {
	struct linux_timeval	it_interval;
	struct linux_timeval	it_value;
};

/*
 * Passed to the statfs(2) system call family
 */
struct linux_statfs {
	long		l_ftype;
	long		l_fbsize;
	long		l_fblocks;
	long		l_fbfree;
	long		l_fbavail;
	long		l_ffiles;
	long		l_fffree;
	linux_fsid_t	l_ffsid;
	long		l_fnamelen;
	long		l_fspare[6];
};

struct linux_statfs64 {
        int		l_ftype;
        int		l_fbsize;
        uint64_t	l_fblocks;
        uint64_t	l_fbfree;
        uint64_t	l_fbavail;
        uint64_t	l_ffiles;
        uint64_t	l_fffree;
        linux_fsid_t	l_ffsid;
        int		l_fnamelen;
        int		l_fspare[6];
};

/*
 * Passed to the uname(2) system call
 */
struct linux_utsname {
	char l_sysname[65];
	char l_nodename[65];
	char l_release[65];
	char l_version[65];
	char l_machine[65];
	char l_domainname[65];
};

struct linux_oldutsname {
	char l_sysname[65];
	char l_nodename[65];
	char l_release[65];
	char l_version[65];
	char l_machine[65];
};

struct linux_oldoldutsname {
	char l_sysname[9];
	char l_nodename[9];
	char l_release[9];
	char l_version[9];
	char l_machine[9];
};

/*
 * Passed to the mmap() system call
 */
struct linux_mmap {
	caddr_t lm_addr;
	int lm_len;
	int lm_prot;
	int lm_flags;
	int lm_fd;
	int lm_pos;
};

/*
 * Passed to the select() system call
 */
struct linux_select {
	int nfds;
	fd_set *readfds;
	fd_set *writefds;
	fd_set *exceptfds;
	struct linux_timeval *timeout;
};

struct linux_stat {
	linux_dev_t		lst_dev;
	unsigned short		pad1;
	linux_ino_t		lst_ino;
	linux_mode_t		lst_mode;
	linux_nlink_t		lst_nlink;
	linux_uid_t		lst_uid;
	linux_gid_t		lst_gid;
	linux_dev_t		lst_rdev;
	unsigned short		pad2;
	linux_off_t		lst_size;
	unsigned long		lst_blksize;
	unsigned long		lst_blocks;
	linux_time_t		lst_atime;
	unsigned long		unused1;
	linux_time_t		lst_mtime;
	unsigned long		unused2;
	linux_time_t		lst_ctime;
	unsigned long		unused3;
	unsigned long		unused4;
	unsigned long		unused5;
};

struct linux_tms {
	linux_clock_t ltms_utime;	
	linux_clock_t ltms_stime;
	linux_clock_t ltms_cutime;
	linux_clock_t ltms_cstime;
};

struct linux_utimbuf {
	linux_time_t l_actime;
	linux_time_t l_modtime;
};

struct linux___sysctl {
	int          *name;
	int           namelen;
	void         *old;
	size_t       *oldlenp;
	void         *new;
	size_t        newlen;
	unsigned long __unused0[4];
};

/* This matches struct stat64 in glibc2.1, hence the absolutely
 * insane amounts of padding around dev_t's.
 */
struct linux_stat64 {
	unsigned long long lst_dev;
	unsigned int	__pad1;

#define LINUX_STAT64_HAS_BROKEN_ST_INO	1
	linux_ino_t	__lst_ino;
	unsigned int	lst_mode;
	unsigned int	lst_nlink;

	unsigned int	lst_uid;
	unsigned int	lst_gid;

	unsigned long long lst_rdev;
	unsigned int	__pad2;

	long long	lst_size;
	unsigned int	lst_blksize;

	unsigned long long lst_blocks;	/* Number 512-byte blocks allocated. */

	unsigned int	lst_atime;
	unsigned int	__unused1;

	unsigned int	lst_mtime;
	unsigned int	__unused2;

	unsigned int	lst_ctime;
	unsigned int	__unused3;	/* will be high 32 bits of ctime someday */

	linux_ino64_t	lst_ino;
};

#endif /* !_LINUX_TYPES_H_ */
@


1.14
log
@Delete procfs; it's always had races and is now unused: no one noticed for
months that I broke it before the 5.5 release.

confirmed as not being required by ports by sthen@@, ajacoutot@@, dcoppa@@
@
text
@d1 1
a1 1
/*	$OpenBSD: linux_types.h,v 1.13 2013/10/25 04:51:39 guenther Exp $	*/
@


1.13
log
@Start to deal with the time_t change's effect on compat/linux:
 - add Linux versions of struct rusage, timeval, and itimerval and
   conversion functions for them
 - add Linux versions of getrusage(), gettimeofday(), {set,get}itimer(),
   and nanosleep()
 - fix various inconsistencies in naming of Linux versions of types
   and conversion functions
 - add mappings for LINUX_CLOCK_{PROCESS,THREAD}_CPUTIME_ID to the
   native versions

Originally written months ago as part of the time_t work; long
memory, prodding, and ok from pirofti@@
@
text
@d1 1
a1 1
/*	$OpenBSD: linux_types.h,v 1.12 2013/05/10 10:31:16 pirofti Exp $	*/
a62 1
#define LINUX_FSTYPE_PROCFS	0x9fa0
@


1.12
log
@compat_linux: Add support for future time_t and ino_t size enlargements.

Reviewed by guenther@@.
@
text
@d1 1
a1 1
/*	$OpenBSD: linux_types.h,v 1.11 2012/05/23 11:08:57 pirofti Exp $	*/
d71 21
d119 1
a119 1
 * Structure for uname(2)
d166 1
a166 1
	struct timeval *timeout;
a246 5
};

struct l_timespec {
	linux_time_t	tv_sec;
	long		tv_nsec;
@


1.11
log
@Add support for statfs64.

While at it get rid of some magic numbers and add support for more
filesystem types (like NTFS, AFS etc.).

Suggestions and feedback from ajacoutot@@, jsing@@ and matthew@@.

Okay matthew@@.
@
text
@d1 1
a1 1
/*	$OpenBSD: linux_types.h,v 1.10 2011/04/05 22:54:31 pirofti Exp $	*/
d56 4
d201 1
a201 1
	unsigned int	__lst_ino;
d225 1
a225 1
	unsigned long long lst_ino;
@


1.10
log
@Unify header sentinel names.
@
text
@d1 1
a1 1
/*	$OpenBSD: linux_types.h,v 1.9 2011/02/10 11:58:43 pirofti Exp $	*/
d56 11
d78 13
@


1.9
log
@Add time related syscalls clock_gettime() and clock_getres().

Okay miod@@.
@
text
@d1 1
a1 1
/*	$OpenBSD: linux_types.h,v 1.8 2005/05/19 18:27:28 mickey Exp $	*/
d35 2
a36 2
#ifndef _LINUX_TYPES_H
#define _LINUX_TYPES_H
d205 1
a205 1
#endif /* !_LINUX_TYPES_H */
@


1.8
log
@__unused is used now
@
text
@d1 1
a1 1
/*	$OpenBSD: linux_types.h,v 1.7 2002/12/16 16:27:41 fgsch Exp $	*/
d198 5
@


1.7
log
@unbust *stat64. From NetBSD.
deraadt@@ ok.
@
text
@d1 1
a1 1
/*	$OpenBSD: linux_types.h,v 1.3 1996/05/22 12:01:51 deraadt Exp $	*/
d162 1
a162 1
	unsigned long __unused[4];
@


1.6
log
@getdents64 support, based on FreeBSD.
thanks to jpmk@@fibertel.com.ar for providing a testbed; jasoni ok.
@
text
@d169 2
a170 2
	unsigned short	lst_dev;
	unsigned char	__pad0[10];
d172 2
a173 1
	unsigned long	lst_ino;
d177 2
a178 2
	unsigned long	lst_uid;
	unsigned long	lst_gid;
d180 2
a181 2
	unsigned short	lst_rdev;
	unsigned char	__pad3[10];
d184 1
a184 1
	unsigned long	lst_blksize;
d186 1
a186 2
	unsigned long	lst_blocks;	/* Number 512-byte blocks allocated. */
	unsigned long	__pad4;		/* future possible st_blocks high bits*/
d188 2
a189 2
	unsigned long	lst_atime;
	unsigned long	__pad5;
d191 2
a192 2
	unsigned long	lst_mtime;
	unsigned long	__pad6;
d194 2
a195 2
	unsigned long	lst_ctime;
	unsigned long	__pad7;		/* will be high 32 bits of ctime someday */
d197 1
a197 2
	unsigned long	__unused1;
	unsigned long	__unused2;
@


1.5
log
@fcntl64 support; okay deraadt@@
@
text
@d45 1
d51 1
@


1.4
log
@Implement truncate64, stat64, lstat64, fstat64; from NetBSD
@
text
@d51 1
@


1.4.6.1
log
@Sync UBC branch to -current
@
text
@d1 1
a1 1
/*	$OpenBSD: linux_types.h,v 1.4 2000/12/22 07:34:02 jasoni Exp $	*/
a50 1
typedef u_int64_t linux_loff_t;
@


1.4.6.2
log
@sync to -current
@
text
@d1 1
a1 1
/*	$OpenBSD: linux_types.h,v 1.4.6.1 2002/06/11 03:28:08 art Exp $	*/
a44 1
typedef unsigned long long linux_ino64_t;
a49 1
typedef long long linux_off64_t;
@


1.4.6.3
log
@sync
@
text
@d1 1
a1 1
/*	$OpenBSD$	*/
d169 2
a170 2
	unsigned long long lst_dev;
	unsigned int	__pad1;
d172 1
a172 2
#define LINUX_STAT64_HAS_BROKEN_ST_INO	1
	unsigned int	__lst_ino;
d176 2
a177 2
	unsigned int	lst_uid;
	unsigned int	lst_gid;
d179 2
a180 2
	unsigned long long lst_rdev;
	unsigned int	__pad2;
d183 1
a183 1
	unsigned int	lst_blksize;
d185 2
a186 1
	unsigned long long lst_blocks;	/* Number 512-byte blocks allocated. */
d188 2
a189 2
	unsigned int	lst_atime;
	unsigned int	__unused1;
d191 2
a192 2
	unsigned int	lst_mtime;
	unsigned int	__unused2;
d194 2
a195 2
	unsigned int	lst_ctime;
	unsigned int	__unused3;	/* will be high 32 bits of ctime someday */
d197 2
a198 1
	unsigned long long lst_ino;
@


1.3
log
@sync
@
text
@d1 1
a1 1
/*	$OpenBSD$	*/
d160 36
@


1.3.16.1
log
@merge in approximately 2.9 into SMP branch
@
text
@d1 1
a1 1
/*	$OpenBSD: linux_types.h,v 1.4 2000/12/22 07:34:02 jasoni Exp $	*/
a159 36
};

/* This matches struct stat64 in glibc2.1, hence the absolutely
 * insane amounts of padding around dev_t's.
 */
struct linux_stat64 {
	unsigned short	lst_dev;
	unsigned char	__pad0[10];

	unsigned long	lst_ino;
	unsigned int	lst_mode;
	unsigned int	lst_nlink;

	unsigned long	lst_uid;
	unsigned long	lst_gid;

	unsigned short	lst_rdev;
	unsigned char	__pad3[10];

	long long	lst_size;
	unsigned long	lst_blksize;

	unsigned long	lst_blocks;	/* Number 512-byte blocks allocated. */
	unsigned long	__pad4;		/* future possible st_blocks high bits*/

	unsigned long	lst_atime;
	unsigned long	__pad5;

	unsigned long	lst_mtime;
	unsigned long	__pad6;

	unsigned long	lst_ctime;
	unsigned long	__pad7;		/* will be high 32 bits of ctime someday */

	unsigned long	__unused1;
	unsigned long	__unused2;
@


1.3.16.2
log
@Merge in trunk
@
text
@d1 1
a1 1
/*	$OpenBSD$	*/
a50 1
typedef u_int64_t linux_loff_t;
@


1.3.16.3
log
@Sync the SMP branch with 3.3
@
text
@a44 1
typedef unsigned long long linux_ino64_t;
a49 1
typedef long long linux_off64_t;
d167 2
a168 2
	unsigned long long lst_dev;
	unsigned int	__pad1;
d170 1
a170 2
#define LINUX_STAT64_HAS_BROKEN_ST_INO	1
	unsigned int	__lst_ino;
d174 2
a175 2
	unsigned int	lst_uid;
	unsigned int	lst_gid;
d177 2
a178 2
	unsigned long long lst_rdev;
	unsigned int	__pad2;
d181 1
a181 1
	unsigned int	lst_blksize;
d183 2
a184 1
	unsigned long long lst_blocks;	/* Number 512-byte blocks allocated. */
d186 2
a187 2
	unsigned int	lst_atime;
	unsigned int	__unused1;
d189 2
a190 2
	unsigned int	lst_mtime;
	unsigned int	__unused2;
d192 2
a193 2
	unsigned int	lst_ctime;
	unsigned int	__unused3;	/* will be high 32 bits of ctime someday */
d195 2
a196 1
	unsigned long long lst_ino;
@


1.2
log
@Good fixes and changes from latest Net.
@
text
@d2 1
a2 1
/*	$NetBSD: linux_types.h,v 1.4 1995/08/21 03:42:11 mycroft Exp $	*/
d150 10
@


1.1
log
@Initial revision
@
text
@d1 1
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
