head	1.8;
access;
symbols
	OPENBSD_6_2_BASE:1.8
	OPENBSD_6_1:1.8.0.54
	OPENBSD_6_1_BASE:1.8
	OPENBSD_6_0:1.8.0.52
	OPENBSD_6_0_BASE:1.8
	OPENBSD_5_9:1.8.0.46
	OPENBSD_5_9_BASE:1.8
	OPENBSD_5_8:1.8.0.48
	OPENBSD_5_8_BASE:1.8
	OPENBSD_5_7:1.8.0.40
	OPENBSD_5_7_BASE:1.8
	OPENBSD_5_6:1.8.0.44
	OPENBSD_5_6_BASE:1.8
	OPENBSD_5_5:1.8.0.42
	OPENBSD_5_5_BASE:1.8
	OPENBSD_5_4:1.8.0.38
	OPENBSD_5_4_BASE:1.8
	OPENBSD_5_3:1.8.0.36
	OPENBSD_5_3_BASE:1.8
	OPENBSD_5_2:1.8.0.34
	OPENBSD_5_2_BASE:1.8
	OPENBSD_5_1_BASE:1.8
	OPENBSD_5_1:1.8.0.32
	OPENBSD_5_0:1.8.0.30
	OPENBSD_5_0_BASE:1.8
	OPENBSD_4_9:1.8.0.28
	OPENBSD_4_9_BASE:1.8
	OPENBSD_4_8:1.8.0.26
	OPENBSD_4_8_BASE:1.8
	OPENBSD_4_7:1.8.0.22
	OPENBSD_4_7_BASE:1.8
	OPENBSD_4_6:1.8.0.24
	OPENBSD_4_6_BASE:1.8
	OPENBSD_4_5:1.8.0.20
	OPENBSD_4_5_BASE:1.8
	OPENBSD_4_4:1.8.0.18
	OPENBSD_4_4_BASE:1.8
	OPENBSD_4_3:1.8.0.16
	OPENBSD_4_3_BASE:1.8
	OPENBSD_4_2:1.8.0.14
	OPENBSD_4_2_BASE:1.8
	OPENBSD_4_1:1.8.0.12
	OPENBSD_4_1_BASE:1.8
	OPENBSD_4_0:1.8.0.10
	OPENBSD_4_0_BASE:1.8
	OPENBSD_3_9:1.8.0.8
	OPENBSD_3_9_BASE:1.8
	OPENBSD_3_8:1.8.0.6
	OPENBSD_3_8_BASE:1.8
	OPENBSD_3_7:1.8.0.4
	OPENBSD_3_7_BASE:1.8
	OPENBSD_3_6:1.8.0.2
	OPENBSD_3_6_BASE:1.8
	SMP_SYNC_A:1.7
	SMP_SYNC_B:1.7
	OPENBSD_3_5:1.7.0.4
	OPENBSD_3_5_BASE:1.7
	OPENBSD_3_4:1.7.0.2
	OPENBSD_3_4_BASE:1.7
	UBC_SYNC_A:1.6
	OPENBSD_3_3:1.5.0.10
	OPENBSD_3_3_BASE:1.5
	OPENBSD_3_2:1.5.0.8
	OPENBSD_3_2_BASE:1.5
	OPENBSD_3_1:1.5.0.6
	OPENBSD_3_1_BASE:1.5
	UBC_SYNC_B:1.5
	UBC:1.5.0.4
	UBC_BASE:1.5
	OPENBSD_3_0:1.5.0.2
	OPENBSD_3_0_BASE:1.5
	OPENBSD_2_9_BASE:1.4
	OPENBSD_2_9:1.4.0.16
	OPENBSD_2_8:1.4.0.14
	OPENBSD_2_8_BASE:1.4
	OPENBSD_2_7:1.4.0.12
	OPENBSD_2_7_BASE:1.4
	SMP:1.4.0.10
	SMP_BASE:1.4
	kame_19991208:1.4
	OPENBSD_2_6:1.4.0.8
	OPENBSD_2_6_BASE:1.4
	OPENBSD_2_5:1.4.0.6
	OPENBSD_2_5_BASE:1.4
	OPENBSD_2_4:1.4.0.4
	OPENBSD_2_4_BASE:1.4
	OPENBSD_2_3:1.4.0.2
	OPENBSD_2_3_BASE:1.4
	OPENBSD_2_2:1.3.0.2
	OPENBSD_2_2_BASE:1.3
	OPENBSD_2_1:1.2.0.2
	OPENBSD_2_1_BASE:1.2
	OPENBSD_2_0:1.1.1.1.0.2
	OPENBSD_2_0_BASE:1.1.1.1
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@ * @;


1.8
date	2004.07.06.13.52.31;	author markus;	state Exp;
branches;
next	1.7;

1.7
date	2003.06.02.23.28.14;	author millert;	state Exp;
branches;
next	1.6;

1.6
date	2003.03.28.14.51.46;	author henning;	state Exp;
branches;
next	1.5;

1.5
date	2001.06.09.07.03.43;	author angelos;	state Exp;
branches
	1.5.4.1;
next	1.4;

1.4
date	97.11.08.19.54.12;	author deraadt;	state Exp;
branches
	1.4.10.1;
next	1.3;

1.3
date	97.06.14.05.37.12;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	97.02.24.14.06.45;	author niklas;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.53.12;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.53.12;	author deraadt;	state Exp;
branches;
next	;

1.4.10.1
date	2001.07.04.10.55.05;	author niklas;	state Exp;
branches;
next	1.4.10.2;

1.4.10.2
date	2003.05.13.19.36.17;	author ho;	state Exp;
branches;
next	1.4.10.3;

1.4.10.3
date	2003.06.07.11.06.08;	author ho;	state Exp;
branches;
next	;

1.5.4.1
date	2003.05.19.22.40.41;	author tedu;	state Exp;
branches;
next	;


desc
@@


1.8
log
@backout rev 1.3, it breaks simultaneous close (no FIN set for retransmits)
ok deraadt, henning, itojun
@
text
@/*	$OpenBSD: tcp_fsm.h,v 1.7 2003/06/02 23:28:14 millert Exp $	*/
/*	$NetBSD: tcp_fsm.h,v 1.6 1994/10/14 16:01:48 mycroft Exp $	*/

/*
 * Copyright (c) 1982, 1986, 1993
 *	The Regents of the University of California.  All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. Neither the name of the University nor the names of its contributors
 *    may be used to endorse or promote products derived from this software
 *    without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 *
 *	@@(#)tcp_fsm.h	8.1 (Berkeley) 6/10/93
 */

#ifndef _NETINET_TCP_FSM_H_
#define _NETINET_TCP_FSM_H_

/*
 * TCP FSM state definitions.
 * Per RFC793, September, 1981.
 */

#define	TCP_NSTATES	11

#define	TCPS_CLOSED		0	/* closed */
#define	TCPS_LISTEN		1	/* listening for connection */
#define	TCPS_SYN_SENT		2	/* active, have sent syn */
#define	TCPS_SYN_RECEIVED	3	/* have sent and received syn */
/* states < TCPS_ESTABLISHED are those where connections not established */
#define	TCPS_ESTABLISHED	4	/* established */
#define	TCPS_CLOSE_WAIT		5	/* rcvd fin, waiting for close */
/* states > TCPS_CLOSE_WAIT are those where user has closed */
#define	TCPS_FIN_WAIT_1		6	/* have closed, sent fin */
#define	TCPS_CLOSING		7	/* closed xchd FIN; await ACK */
#define	TCPS_LAST_ACK		8	/* had fin and close; await FIN ACK */
/* states > TCPS_CLOSE_WAIT && < TCPS_FIN_WAIT_2 await ACK of FIN */
#define	TCPS_FIN_WAIT_2		9	/* have closed, fin is acked */
#define	TCPS_TIME_WAIT		10	/* in 2*msl quiet wait after close */

#define	TCPS_HAVERCVDSYN(s)	((s) >= TCPS_SYN_RECEIVED)
#define	TCPS_HAVEESTABLISHED(s)	((s) >= TCPS_ESTABLISHED)
#define	TCPS_HAVERCVDFIN(s)	((s) >= TCPS_TIME_WAIT)

#ifdef	TCPOUTFLAGS
/*
 * Flags used when sending segments in tcp_output.
 * Basic flags (TH_RST,TH_ACK,TH_SYN,TH_FIN) are totally
 * determined by state, with the proviso that TH_FIN is sent only
 * if all data queued for output is included in the segment.
 */
u_char	tcp_outflags[TCP_NSTATES] = {
    TH_RST|TH_ACK, 0, TH_SYN, TH_SYN|TH_ACK,
    TH_ACK, TH_ACK,
    TH_FIN|TH_ACK, TH_FIN|TH_ACK, TH_FIN|TH_ACK, TH_ACK, TH_ACK,
};
#endif /* TCPOUTFLAGS */

#ifdef KPROF
int	tcp_acounts[TCP_NSTATES][PRU_NREQ];
#endif /* KPROF */

#ifdef	TCPSTATES
const char *tcpstates[] = {
	"CLOSED",	"LISTEN",	"SYN_SENT",	"SYN_RCVD",
	"ESTABLISHED",	"CLOSE_WAIT",	"FIN_WAIT_1",	"CLOSING",
	"LAST_ACK",	"FIN_WAIT_2",	"TIME_WAIT",
};
#endif /* TCPSTATES */
#endif /* _NETINET_TCP_FSM_H_ */
@


1.7
log
@Remove the advertising clause in the UCB license which Berkeley
rescinded 22 July 1999.  Proofed by myself and Theo.
@
text
@d1 1
a1 1
/*	$OpenBSD: tcp_fsm.h,v 1.6 2003/03/28 14:51:46 henning Exp $	*/
d74 1
a74 1
    TH_FIN|TH_ACK, TH_ACK, TH_FIN|TH_ACK, TH_ACK, TH_ACK,
@


1.6
log
@const char *
from David Hill <david at phobia.ms>
@
text
@d1 1
a1 1
/*	$OpenBSD: tcp_fsm.h,v 1.5 2001/06/09 07:03:43 angelos Exp $	*/
d16 1
a16 5
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 *	This product includes software developed by the University of
 *	California, Berkeley and its contributors.
 * 4. Neither the name of the University nor the names of its contributors
@


1.5
log
@Inclusion protection.
@
text
@d1 1
a1 1
/*	$OpenBSD: tcp_fsm.h,v 1.4 1997/11/08 19:54:12 deraadt Exp $	*/
d87 1
a87 1
char *tcpstates[] = {
@


1.5.4.1
log
@sync
@
text
@d1 1
a1 1
/*	$OpenBSD$	*/
d87 1
a87 1
const char *tcpstates[] = {
@


1.4
log
@grammar; bane@@mournblade.NETural.com
@
text
@d1 1
a1 1
/*	$OpenBSD: tcp_fsm.h,v 1.3 1997/06/14 05:37:12 deraadt Exp $	*/
d39 3
d80 1
a80 1
#endif
d84 1
a84 1
#endif
d92 2
a93 1
#endif
@


1.4.10.1
log
@Merge in -current from two days ago in the SMP branch.
As usual with merges, they do not indicate progress, so do not hold
your breath for working SMP, and do not mail me and ask about the
state of it.  It has not changed.  There is work ongoing, but very, very
slowly.  The commit is done in parts as to not lock up the tree in too
big chunks at a time.
@
text
@d1 1
a1 1
/*	$OpenBSD: tcp_fsm.h,v 1.4 1997/11/08 19:54:12 deraadt Exp $	*/
a38 3
#ifndef _NETINET_TCP_FSM_H_
#define _NETINET_TCP_FSM_H_

d77 1
a77 1
#endif /* TCPOUTFLAGS */
d81 1
a81 1
#endif /* KPROF */
d89 1
a89 2
#endif /* TCPSTATES */
#endif /* _NETINET_TCP_FSM_H_ */
@


1.4.10.2
log
@Sync the SMP branch to -current. This includes moving to ELF.
@
text
@d1 1
a1 1
/*	$OpenBSD: tcp_fsm.h,v 1.4.10.1 2001/07/04 10:55:05 niklas Exp $	*/
d87 1
a87 1
const char *tcpstates[] = {
@


1.4.10.3
log
@Sync SMP branch to -current
@
text
@d1 1
a1 1
/*	$OpenBSD: tcp_fsm.h,v 1.4.10.2 2003/05/13 19:36:17 ho Exp $	*/
d16 5
a20 1
 * 3. Neither the name of the University nor the names of its contributors
@


1.3
log
@TCP/IP Illustrated Vol.2", pg 1005 + 1090, exercise 29.5; fixes
simultaneous close extra packet exchange; frueauf@@ira.uka.de, checked
by Andreas.Gunnarsson@@emw.ericsson.se
@
text
@d1 1
a1 1
/*	$OpenBSD: tcp_fsm.h,v 1.2 1997/02/24 14:06:45 niklas Exp $	*/
d49 1
a49 1
#define	TCPS_SYN_RECEIVED	3	/* have send and received syn */
@


1.2
log
@OpenBSD tags + some prototyping police
@
text
@d1 1
a1 1
/*	$OpenBSD: tcp_fsm.h,v 1.6 1994/10/14 16:01:48 mycroft Exp $	*/
d55 1
a55 1
#define	TCPS_CLOSING		7	/* closed xchd FIN; await FIN ACK */
d75 1
a75 1
    TH_FIN|TH_ACK, TH_FIN|TH_ACK, TH_FIN|TH_ACK, TH_ACK, TH_ACK,
@


1.1
log
@Initial revision
@
text
@d1 1
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
