head	1.10;
access;
symbols
	SMP_SYNC_A:1.10
	SMP_SYNC_B:1.10
	UBC_SYNC_A:1.10
	UBC_SYNC_B:1.10
	OPENBSD_2_9_BASE:1.9
	OPENBSD_2_9:1.9.0.2
	OPENBSD_2_8:1.8.0.2
	OPENBSD_2_8_BASE:1.8
	OPENBSD_2_7:1.7.0.2
	OPENBSD_2_7_BASE:1.7
	SMP:1.5.0.2
	SMP_BASE:1.5
	kame_19991208:1.3
	OPENBSD_2_6:1.3.0.4
	OPENBSD_2_6_BASE:1.3
	OPENBSD_2_5:1.3.0.2
	OPENBSD_2_5_BASE:1.3
	OPENBSD_2_4:1.2.0.4
	OPENBSD_2_4_BASE:1.2
	OPENBSD_2_3:1.2.0.2
	OPENBSD_2_3_BASE:1.2;
locks; strict;
comment	@ * @;


1.10
date	2001.05.30.02.14.08;	author deraadt;	state dead;
branches;
next	1.9;

1.9
date	2001.01.17.04.47.12;	author fgsch;	state Exp;
branches;
next	1.8;

1.8
date	2000.05.24.21.59.11;	author kjell;	state Exp;
branches;
next	1.7;

1.7
date	2000.03.13.23.40.17;	author kjell;	state Exp;
branches
	1.7.2.1;
next	1.6;

1.6
date	2000.02.16.22.34.18;	author kjell;	state Exp;
branches;
next	1.5;

1.5
date	2000.02.01.19.29.58;	author kjell;	state Exp;
branches
	1.5.2.1;
next	1.4;

1.4
date	99.12.15.05.20.21;	author kjell;	state Exp;
branches;
next	1.3;

1.3
date	99.02.05.05.58.50;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	98.02.17.01.39.02;	author dgregor;	state Exp;
branches;
next	1.1;

1.1
date	98.01.26.04.10.38;	author dgregor;	state Exp;
branches;
next	;

1.5.2.1
date	2000.02.20.11.57.23;	author niklas;	state Exp;
branches;
next	1.5.2.2;

1.5.2.2
date	2001.05.14.22.40.09;	author niklas;	state Exp;
branches;
next	1.5.2.3;

1.5.2.3
date	2001.07.04.10.54.39;	author niklas;	state dead;
branches;
next	;

1.7.2.1
date	2000.05.27.20.45.17;	author jason;	state Exp;
branches;
next	;


desc
@@


1.10
log
@Remove ipf.  Darren Reed has interpreted his (old, new, whichever)
licence in a way that makes ipf not free according to the rules we
established over 5 years ago, at www.openbsd.org/goals.html (and those
same basic rules govern the other *BSD projects too).  Specifically,
Darren says that modified versions are not permitted.  But software
which OpenBSD uses and redistributes must be free to all (be they
people or companies), for any purpose they wish to use it, including
modification, use, peeing on, or even integration into baby mulching
machines or atomic bombs to be dropped on Australia.  Furthermore, we
know of a number of companies using ipf with modification like us, who
are now in the same situation, and we hope that some of them will work
with us to fill this gap that now exists in OpenBSD (temporarily, we
hope).
@
text
@/*	$OpenBSD: ip_auth.h,v 1.9 2001/01/17 04:47:12 fgsch Exp $	*/

/*
 * Copyright (C) 1997-2000 by Darren Reed & Guido Van Rooij.
 *
 * Redistribution and use in source and binary forms are permitted
 * provided that this notice is preserved and due credit is given
 * to the original author and the contributors.
 *
 * $IPFilter: ip_auth.h,v 2.3.2.2 2000/10/19 15:38:44 darrenr Exp $
 *
 */
#ifndef	__IP_AUTH_H__
#define	__IP_AUTH_H__

#define FR_NUMAUTH      32

typedef struct  frauth {
	int	fra_age;
	int	fra_index;
	u_32_t	fra_pass;
	fr_info_t	fra_info;
#if SOLARIS
	queue_t	*fra_q;
#endif
} frauth_t;

typedef	struct	frauthent  {
	struct	frentry	fae_fr;
	struct	frauthent	*fae_next;
	u_long	fae_age;
} frauthent_t;

typedef struct  fr_authstat {
	U_QUAD_T	fas_hits;
	U_QUAD_T	fas_miss;
	u_long		fas_nospace;
	u_long		fas_added;
	u_long		fas_sendfail;
	u_long		fas_sendok;
	u_long		fas_queok;
	u_long		fas_quefail;
	u_long		fas_expire;
	frauthent_t	*fas_faelist;
} fr_authstat_t;


extern	frentry_t	*ipauth;
extern	struct fr_authstat	fr_authstats;
extern	int	fr_defaultauthage;
extern	int	fr_authsize;
extern	int	fr_authused;
extern	int	fr_auth_lock;
extern	u_32_t	fr_checkauth __P((ip_t *, fr_info_t *));
extern	void	fr_authexpire __P((void));
extern	void	fr_authunload __P((void));
extern	mb_t	*fr_authpkts[];
extern	int	fr_newauth __P((mb_t *, fr_info_t *, ip_t *));
#if defined(__NetBSD__) || defined(__OpenBSD__)
extern	int	fr_auth_ioctl __P((caddr_t, u_long, frentry_t *, frentry_t **));
#else
extern	int	fr_auth_ioctl __P((caddr_t, int, frentry_t *, frentry_t **));
#endif
#endif	/* __IP_AUTH_H__ */
@


1.9
log
@IPF 3.4.15. (IPv6 not working yet).

Note: before building the userland part you need to do make includes.
@
text
@d1 1
a1 1
/*	$OpenBSD$	*/
@


1.8
log
@Update to ipf 3.3.16. among other things, this addresses a security issue
with certain rule configurations:

* don't add TCP state if it is an RST packet and (attempt) to send out
  RST/ICMP packets in a manner that bypasses IP Filter.
@
text
@d1 1
a1 1
/*	$OpenBSD: ip_auth.h,v 1.7 2000/03/13 23:40:17 kjell Exp $	*/
d4 1
a4 1
 * Copyright (C) 1997-1998 by Darren Reed & Guido Van Rooij.
d10 1
a10 1
 * $IPFilter: ip_auth.h,v 2.1.2.1 2000/05/22 06:57:47 darrenr Exp $
a50 2
extern	int	fr_authstart;
extern	int	fr_authend;
d53 1
@


1.7
log
@Import of Darren Reed's IPFilter 3.3.11. See sbin/ipf/HISTORY for detailed
changelog. Documentation changes are now way behind. Volunteers?
@
text
@d1 1
a1 1
/*	$OpenBSD$	*/
d10 1
a10 1
 * $IPFilter: ip_auth.h,v 2.1 1999/08/04 17:29:54 darrenr Exp $
a58 3
#if defined(_KERNEL) && SOLARIS
extern	int	fr_newauth __P((mb_t *, fr_info_t *, ip_t *, qif_t *));
#else
a59 1
#endif
@


1.7.2.1
log
@Pull in patch from current:
Errata:
A misuse of ipf(8) keep-state rules can result in firewall rules being bypassed.
Fix (kjell):
Update to ipf 3.3.16. among other things, this addresses a security issue
with certain rule configurations:

* don't add TCP state if it is an RST packet and (attempt) to send out
RST/ICMP packets in a manner that bypasses IP Filter.
@
text
@d1 1
a1 1
/*	$OpenBSD: ip_auth.h,v 1.8 2000/05/24 21:59:11 kjell Exp $	*/
d10 1
a10 1
 * $IPFilter: ip_auth.h,v 2.1.2.1 2000/05/22 06:57:47 darrenr Exp $
d59 3
d63 1
@


1.6
log
@Import IPFilter 3.3.9. Primarily, bugfixes since 3.3.8. See sbin/ipf/HISTORY
for details.
@
text
@@


1.5
log
@Update to IPFilter 3.3.8. Man pages still to go. See sbin/ipf/HISTORY
for details.
@
text
@@


1.5.2.1
log
@Merge in recent code from the trunk
@
text
@d1 1
a1 1
/*	$OpenBSD: ip_auth.h,v 1.6 2000/02/16 22:34:18 kjell Exp $	*/
@


1.5.2.2
log
@merge in approximately 2.9 into SMP branch
@
text
@d1 1
a1 1
/*	$OpenBSD: ip_auth.h,v 1.9 2001/01/17 04:47:12 fgsch Exp $	*/
d4 1
a4 1
 * Copyright (C) 1997-2000 by Darren Reed & Guido Van Rooij.
d10 1
a10 1
 * $IPFilter: ip_auth.h,v 2.3.2.2 2000/10/19 15:38:44 darrenr Exp $
d51 2
a54 1
extern	int	fr_auth_lock;
d59 3
d63 1
@


1.5.2.3
log
@Merge in -current from two days ago in the SMP branch.
As usual with merges, they do not indicate progress, so do not hold
your breath for working SMP, and do not mail me and ask about the
state of it.  It has not changed.  There is work ongoing, but very, very
slowly.  The commit is done in parts as to not lock up the tree in too
big chunks at a time.
@
text
@d1 1
a1 1
/*	$OpenBSD: ip_auth.h,v 1.5.2.2 2001/05/14 22:40:09 niklas Exp $	*/
@


1.4
log
@Import of Darren Reed's IPFilter 3.3.4, including OpenBSD patches.

Many, many enhancements and improvements, including new in-kernel
proxies, enhancements to logging, and many bugfixes.

Note: Man pages have not yet been re-converted to mdoc.
@
text
@d1 2
a2 1
/* $OpenBSD$ */
d10 1
a10 1
 * $Id: ip_auth.h,v 2.1 1999/08/04 17:29:54 darrenr Exp $
@


1.3
log
@ipf 3.2.10; work by kjell
@
text
@d1 1
a1 1
/*       $OpenBSD: ip_auth.h,v 1.2 1998/02/17 01:39:02 dgregor Exp $       */
d9 1
a9 1
 * $Id: ip_auth.h,v 1.2 1998/02/17 01:39:02 dgregor Exp $
a16 12
typedef struct  fr_authstat {
	U_QUAD_T	fas_hits;
	U_QUAD_T	fas_miss;
	u_long		fas_nospace;
	u_long		fas_added;
	u_long		fas_sendfail;
	u_long		fas_sendok;
	u_long		fas_queok;
	u_long		fas_quefail;
	u_long		fas_expire;
} fr_authstat_t;

d33 13
d54 1
a54 1
extern	int	fr_checkauth __P((ip_t *, fr_info_t *));
@


1.2
log
@$OpenBSD$
@
text
@d1 1
a1 1
/*       $OpenBSD$       */
d3 1
a3 1
 * Copyright (C) 1997 by Darren Reed & Guido Van Rooij.
d9 1
a9 1
 * $Id: ip_auth.h,v 1.1 1998/01/26 04:10:38 dgregor Exp $
@


1.1
log
@IPF 3.2.3
@
text
@d1 1
d9 1
a9 1
 * $Id: ip_auth.h,v 2.0.2.10 1997/10/29 12:14:07 darrenr Exp $
@
