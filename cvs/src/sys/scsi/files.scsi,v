head	1.25;
access;
symbols
	OPENBSD_6_2:1.25.0.28
	OPENBSD_6_2_BASE:1.25
	OPENBSD_6_1:1.25.0.26
	OPENBSD_6_1_BASE:1.25
	OPENBSD_6_0:1.25.0.22
	OPENBSD_6_0_BASE:1.25
	OPENBSD_5_9:1.25.0.18
	OPENBSD_5_9_BASE:1.25
	OPENBSD_5_8:1.25.0.20
	OPENBSD_5_8_BASE:1.25
	OPENBSD_5_7:1.25.0.12
	OPENBSD_5_7_BASE:1.25
	OPENBSD_5_6:1.25.0.16
	OPENBSD_5_6_BASE:1.25
	OPENBSD_5_5:1.25.0.14
	OPENBSD_5_5_BASE:1.25
	OPENBSD_5_4:1.25.0.10
	OPENBSD_5_4_BASE:1.25
	OPENBSD_5_3:1.25.0.8
	OPENBSD_5_3_BASE:1.25
	OPENBSD_5_2:1.25.0.6
	OPENBSD_5_2_BASE:1.25
	OPENBSD_5_1_BASE:1.25
	OPENBSD_5_1:1.25.0.4
	OPENBSD_5_0:1.25.0.2
	OPENBSD_5_0_BASE:1.25
	OPENBSD_4_9:1.22.0.4
	OPENBSD_4_9_BASE:1.22
	OPENBSD_4_8:1.22.0.2
	OPENBSD_4_8_BASE:1.22
	OPENBSD_4_7:1.20.0.18
	OPENBSD_4_7_BASE:1.20
	OPENBSD_4_6:1.20.0.20
	OPENBSD_4_6_BASE:1.20
	OPENBSD_4_5:1.20.0.16
	OPENBSD_4_5_BASE:1.20
	OPENBSD_4_4:1.20.0.14
	OPENBSD_4_4_BASE:1.20
	OPENBSD_4_3:1.20.0.12
	OPENBSD_4_3_BASE:1.20
	OPENBSD_4_2:1.20.0.10
	OPENBSD_4_2_BASE:1.20
	OPENBSD_4_1:1.20.0.8
	OPENBSD_4_1_BASE:1.20
	OPENBSD_4_0:1.20.0.6
	OPENBSD_4_0_BASE:1.20
	OPENBSD_3_9:1.20.0.4
	OPENBSD_3_9_BASE:1.20
	OPENBSD_3_8:1.20.0.2
	OPENBSD_3_8_BASE:1.20
	OPENBSD_3_7:1.13.0.2
	OPENBSD_3_7_BASE:1.13
	OPENBSD_3_6:1.11.0.4
	OPENBSD_3_6_BASE:1.11
	SMP_SYNC_A:1.11
	SMP_SYNC_B:1.11
	OPENBSD_3_5:1.11.0.2
	OPENBSD_3_5_BASE:1.11
	OPENBSD_3_4:1.10.0.10
	OPENBSD_3_4_BASE:1.10
	UBC_SYNC_A:1.10
	OPENBSD_3_3:1.10.0.8
	OPENBSD_3_3_BASE:1.10
	OPENBSD_3_2:1.10.0.6
	OPENBSD_3_2_BASE:1.10
	OPENBSD_3_1:1.10.0.4
	OPENBSD_3_1_BASE:1.10
	UBC_SYNC_B:1.10
	UBC:1.10.0.2
	UBC_BASE:1.10
	OPENBSD_3_0:1.9.0.8
	OPENBSD_3_0_BASE:1.9
	OPENBSD_2_9_BASE:1.9
	OPENBSD_2_9:1.9.0.6
	OPENBSD_2_8:1.9.0.4
	OPENBSD_2_8_BASE:1.9
	OPENBSD_2_7:1.9.0.2
	OPENBSD_2_7_BASE:1.9
	SMP:1.8.0.4
	SMP_BASE:1.8
	kame_19991208:1.8
	OPENBSD_2_6:1.8.0.2
	OPENBSD_2_6_BASE:1.8
	OPENBSD_2_5:1.5.0.10
	OPENBSD_2_5_BASE:1.5
	OPENBSD_2_4:1.5.0.8
	OPENBSD_2_4_BASE:1.5
	OPENBSD_2_3:1.5.0.6
	OPENBSD_2_3_BASE:1.5
	OPENBSD_2_2:1.5.0.4
	OPENBSD_2_2_BASE:1.5
	OPENBSD_2_1:1.5.0.2
	OPENBSD_2_1_BASE:1.5
	OPENBSD_2_0:1.4.0.2
	OPENBSD_2_0_BASE:1.4
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@# @;


1.25
date	2011.04.27.11.36.20;	author dlg;	state Exp;
branches;
next	1.24;

1.24
date	2011.04.22.23.22.56;	author deraadt;	state Exp;
branches;
next	1.23;

1.23
date	2011.04.05.14.25.42;	author dlg;	state Exp;
branches;
next	1.22;

1.22
date	2010.07.03.03.59.17;	author krw;	state Exp;
branches;
next	1.21;

1.21
date	2010.07.02.20.21.13;	author miod;	state Exp;
branches;
next	1.20;

1.20
date	2005.08.05.00.08.58;	author dlg;	state Exp;
branches;
next	1.19;

1.19
date	2005.08.01.23.14.31;	author dlg;	state Exp;
branches;
next	1.18;

1.18
date	2005.07.31.06.22.56;	author dlg;	state Exp;
branches;
next	1.17;

1.17
date	2005.07.25.23.32.33;	author dlg;	state Exp;
branches;
next	1.16;

1.16
date	2005.07.02.03.49.47;	author krw;	state Exp;
branches;
next	1.15;

1.15
date	2005.05.27.16.07.51;	author krw;	state Exp;
branches;
next	1.14;

1.14
date	2005.05.14.00.20.43;	author krw;	state Exp;
branches;
next	1.13;

1.13
date	2005.03.08.20.00.25;	author tdeval;	state Exp;
branches;
next	1.12;

1.12
date	2004.09.15.23.49.11;	author mickey;	state Exp;
branches;
next	1.11;

1.11
date	2004.01.16.21.11.21;	author miod;	state Exp;
branches;
next	1.10;

1.10
date	2001.11.23.00.35.50;	author miod;	state Exp;
branches;
next	1.9;

1.9
date	2000.02.21.08.24.00;	author mjacob;	state Exp;
branches;
next	1.8;

1.8
date	99.07.25.10.53.11;	author deraadt;	state Exp;
branches
	1.8.4.1;
next	1.7;

1.7
date	99.07.20.17.02.04;	author csapuntz;	state Exp;
branches;
next	1.6;

1.6
date	99.07.20.06.21.59;	author csapuntz;	state Exp;
branches;
next	1.5;

1.5
date	96.10.31.01.09.21;	author niklas;	state Exp;
branches;
next	1.4;

1.4
date	96.05.22.12.07.54;	author deraadt;	state Exp;
branches;
next	1.3;

1.3
date	96.04.21.22.30.46;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	96.02.20.02.28.50;	author briggs;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.53.24;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.53.24;	author deraadt;	state Exp;
branches;
next	;

1.8.4.1
date	2000.02.21.22.29.14;	author niklas;	state Exp;
branches;
next	1.8.4.2;

1.8.4.2
date	2001.12.05.01.02.40;	author niklas;	state Exp;
branches;
next	1.8.4.3;

1.8.4.3
date	2004.02.19.11.01.30;	author niklas;	state Exp;
branches;
next	;


desc
@@


1.25
log
@hds(4) is a path driver that knows how to talk to some hitachi modular
storage arrays.

at the moment it makes a naive decision about which controller in an array
to talk to. it does work, but a smarter version is being worked on.

tested by and ok deraadt@@
@
text
@#	$OpenBSD: files.scsi,v 1.24 2011/04/22 23:22:56 deraadt Exp $
#	$NetBSD: files.scsi,v 1.4 1996/05/16 04:01:08 mycroft Exp $
#
# Config.new file and device description for machine-independent SCSI code.
# Included by ports that need it.  Ports that use it must provide
# their own "major" declarations for the appropriate devices.

file	scsi/scsi_base.c		scsi
file	scsi/scsi_ioctl.c		scsi
file	scsi/scsiconf.c			scsi

device	scsibus {[target = -1], [lun = -1]}
attach	scsibus at scsi

device	cd: disk
attach	cd at scsibus
file	scsi/cd.c			cd needs-flag

device	ch: disk
attach	ch at scsibus
file	scsi/ch.c			ch needs-flag

device	sd: disk
attach	sd at scsibus
file	scsi/sd.c			sd needs-flag

device	st: tape
attach	st at scsibus
file	scsi/st.c			st needs-flag

device	uk: disk
attach	uk at scsibus
file	scsi/uk.c			uk needs-flag

device	safte: disk
attach	safte at scsibus
file	scsi/safte.c			safte needs-flag

device	ses: disk
attach	ses at scsibus
file	scsi/ses.c			ses needs-flag

device	sym
attach	sym at scsibus
file	scsi/mpath_sym.c		sym

device	rdac
attach	rdac at scsibus
file	scsi/mpath_rdac.c		rdac

device	emc
attach	emc at scsibus
file	scsi/mpath_emc.c		emc

device	hds
attach	hds at scsibus
file	scsi/mpath_hds.c		hds
@


1.24
log
@delete a bogus blank line
@
text
@d1 1
a1 1
#	$OpenBSD: files.scsi,v 1.23 2011/04/05 14:25:42 dlg Exp $
d54 4
@


1.23
log
@move forward with scsi multipathing.

the big change is how paths between mpath capable devices and the
kernel are managed.

originally the midlayer would steal the links to the devices and
hide them behind mpath. all the changes an adapter made to a link
(eg activate or detach), the midlayer had to test if it was an mpath
link and then call special mpath code to handle it.

the original code also assumed that all paths behaved the same, but
the reality is that different devices have different command sets
and behaviours. figuring out which behaviour to pick and prioritising
them is basically the same job autoconf does with match and attach.

rather than special casing mpath in the midlayer and reimplimenting
autoconf, this turns paths into actual device drivers with match
and attach routines. after they figure out if the path is active,
they then give it to mpath(4) to use as a backend.

i have written drivers for symmetric access devices (sym(4)) where
all paths to the same logical unit are as good as each other,
lsi/engenio arrays (rdac(4), and emc arrays (emc(4)).

the rdac and emc drivers only detect active paths at attach time,
the do not cope if the controller changes state unless you unplug
the path and plug it in again to retest the active state. they also
do not have support for directing array failover.

operating and hoplugging has been tested with mpii(4), fc and sas
mpi(4), and iscsi via vscsi (claudio did this too).

ok krw@@ deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: files.scsi,v 1.22 2010/07/03 03:59:17 krw Exp $
a41 1

@


1.22
log
@No more ss(4) or usscanner(4). Unused, unloved and unmaintained.
General huzzahs.

"go for it" deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: files.scsi,v 1.21 2010/07/02 20:21:13 miod Exp $
d42 13
@


1.21
log
@ss(4) does not need the tape attribute; only tape devices do (and only on vax,
really).
@
text
@d1 1
a1 1
#	$OpenBSD: files.scsi,v 1.20 2005/08/05 00:08:58 dlg Exp $
a29 6

device	ss
attach	ss at scsibus
file	scsi/ss.c			ss needs-flag
file	scsi/ss_mustek.c		ss
file	scsi/ss_scanjet.c		ss
@


1.20
log
@make the naming of the safte files consisten with the rest of the scsi
drivers

ok krw@@ deraadt@@ marco@@
@
text
@d1 1
a1 1
#	$OpenBSD: files.scsi,v 1.19 2005/08/01 23:14:31 dlg Exp $
d31 1
a31 1
device	ss: tape
@


1.19
log
@a new scsi enclosure services driver. this and safte replace the old ses
driver. rather than relying on its own set of tools, ses reports the
enclosure status via the hw.sensors sysctl tree. so far only temperature
is reported

ok marco@@ deraadt@@ krw@@
@
text
@d1 1
a1 1
#	$OpenBSD: files.scsi,v 1.18 2005/07/31 06:22:56 dlg Exp $
d43 1
a43 1
file	scsi/scsi_safte.c		safte needs-flag
@


1.18
log
@remove the ses driver. it has never been enabled in GENERIC on any arch
in openbsds lifetime so noone is going to miss it.

if you did enable it, it either didnt work or the data was hard to read
and usually wrong.

ok deraadt@@ marco@@
@
text
@d1 1
a1 1
#	$OpenBSD: files.scsi,v 1.17 2005/07/25 23:32:33 dlg Exp $
d45 3
@


1.17
log
@add safte, a small driver for monitoring scsi accessed fault-tolerant
enclosures via the hw.sensors sysctl tree.

ok marco@@ krw@@ please do tdeval@@ looks ok grange@@
@
text
@d1 1
a1 1
#	$OpenBSD: files.scsi,v 1.16 2005/07/02 03:49:47 krw Exp $
a25 4

device	ses: disk
attach	ses at scsibus
file	scsi/ses.c			ses needs-flag
@


1.16
log
@Don't use READ FORMAT CAPACITIES to determine the size of ATAPI sd
devices. Use READ CAPACITY like NetBSD, FreeBSD, Linux and OpenSolaris
do. Well, NetBSD keeps READ FORMAT CAPACITIES as a backup. Fixes
problems with devices (such as my IBM USB Memory Key) which return
block counts that are off by one for READ FORMAT CAPACITIES.

This eliminates the significant difference between sd_atapi.c and
sd_scsi.c so merge sd_scsi.c into sd.c and just be careful to mark
ATAPI removable devices as both SDEV_NOSYNCCACHE and unable to return
MODE SENSE page 4 info.

All geometry faking is now in one place. Where it can be 'improved'.

sd_scsi.c, sd_atapi.c and atapi_disk.h will be removed as a result.
@
text
@d1 1
a1 1
#	$OpenBSD: files.scsi,v 1.15 2005/05/27 16:07:51 krw Exp $
d44 5
@


1.15
log
@Convert cd code to new mode sense framework. Merge cd_scsi and
cd_atapi into cd since code is now almost identical, and only affects
volume adjusting ioctl's. Minor side effect of allowing
cd_load_unload() attempts to scsi cd's as NetBSD does.
@
text
@d1 1
a1 1
#	$OpenBSD: files.scsi,v 1.14 2005/05/14 00:20:43 krw Exp $
a25 2
file	scsi/sd_atapi.c			sd needs-flag
file	scsi/sd_scsi.c			sd needs-flag
@


1.14
log
@Add scsi_mode_[sense|select]_big() and use it instead of
atapi_mode_[sense|select](). This will allow the removal of
atapi_base.c and atapi_all.h files, and sets the stage for better usb
mode sense handling amoung other things.

Remove cd_scsibus_[get|set]_mode() and
sd_scsibus_mode_sense() shims in favour of scsi_mode_[sense|select]().
Add zero'ing of reserved length field in scsi_mode_select(). Change
some uchar * type parameters to scsi_mode_header *.

No functional changes. Mostly from NetBSD.

ok dlg@@.
@
text
@d1 1
a1 1
#	$OpenBSD: files.scsi,v 1.13 2005/03/08 20:00:25 tdeval Exp $
a17 2
file	scsi/cd_scsi.c			cd
file	scsi/cd_atapi.c			cd
@


1.13
log
@Cosmetics...
Mainly remove space between locators parens, replace spaces with tabs
where appropriate and consistently align dependencies.
@
text
@d1 1
a1 1
#	$OpenBSD: files.scsi,v 1.12 2004/09/15 23:49:11 mickey Exp $
a10 1
file	scsi/atapi_base.c		scsi
@


1.12
log
@target/lun attributes are optional
@
text
@d1 1
a1 1
#	$OpenBSD: files.scsi,v 1.11 2004/01/16 21:11:21 miod Exp $
d11 1
a11 1
file    scsi/atapi_base.c               scsi
d19 2
a20 2
file    scsi/cd_scsi.c                  cd
file    scsi/cd_atapi.c                 cd
@


1.11
log
@Remove this farce.
@
text
@d1 1
a1 1
#	$OpenBSD: files.scsi,v 1.10 2001/11/23 00:35:50 miod Exp $
d13 1
a13 1
device	scsibus {target = -1, lun = -1}
@


1.10
log
@Typo in comment.
@
text
@d1 1
a1 1
#	$OpenBSD: files.scsi,v 1.9 2000/02/21 08:24:00 mjacob Exp $
a44 4

device	su: disk
attach	su at scsibus
file	scsi/su.c			su needs-flag
@


1.9
log
@add SES/SAF-TE SCSI device
@
text
@d1 1
a1 1
#	$OpenBSD: files.scsi,v 1.8 1999/07/25 10:53:11 deraadt Exp $
d5 1
a5 1
# Included by ports that need it.  Ports that usee it must provide
@


1.8
log
@fake sd_atapi.c and sd_scsi.c until costa fixes it for real
@
text
@d1 1
a1 1
#	$OpenBSD: files.scsi,v 1.7 1999/07/20 17:02:04 csapuntz Exp $
d31 4
@


1.8.4.1
log
@sync with -current
@
text
@d1 1
a1 1
#	$OpenBSD: files.scsi,v 1.9 2000/02/21 08:24:00 mjacob Exp $
a30 4

device	ses: disk
attach	ses at scsibus
file	scsi/ses.c			ses needs-flag
@


1.8.4.2
log
@Merge in -current
@
text
@d1 1
a1 1
#	$OpenBSD$
d5 1
a5 1
# Included by ports that need it.  Ports that use it must provide
@


1.8.4.3
log
@Merge of current from two weeks agointo the SMP branch
@
text
@d46 4
@


1.7
log
@

Don't pull in cd_scsi/cd_atapi stuff unless cd device is used
@
text
@d1 1
a1 1
#	$OpenBSD: files.scsi,v 1.6 1999/07/20 06:21:59 csapuntz Exp $
d29 2
@


1.6
log
@

Make acd redundant.

Mostly based on NetBSD-current
@
text
@d1 1
a1 1
#	$OpenBSD: files.scsi,v 1.5 1996/10/31 01:09:21 niklas Exp $
d19 2
a20 2
file    scsi/cd_scsi.c
file    scsi/cd_atapi.c
@


1.5
log
@$OpenBSD RCSIDs + comment fix in sd.c
@
text
@d1 1
a1 1
#	$OpenBSD: files.scsi,v 1.4 1996/05/16 04:01:08 mycroft Exp $
d11 1
d19 2
@


1.4
log
@scsi attribute elsewhere
@
text
@d1 1
@


1.3
log
@partial sync with netbsd 960418, more to come
@
text
@d1 1
a1 1
#	$NetBSD: files.scsi,v 1.3 1996/03/17 00:59:45 thorpej Exp $
a6 1
define	scsi {}
@


1.2
log
@Sync. with NetBSD:
- scsi prototypes.
- Add SCSI scanner support by Kenneth Stailey and Joachim Koenig-Baltes,
  hacked a but.  Needs more work.
ss.c:
- Truncate to the window size in ssminphys(), not ssread().
- Missed some prototyping foo.
- Minor tweak; make sure window size is 0 on close.
- Change variable name to avoid GCC warning.
- Handle EOF a little differently.
@
text
@d1 1
a1 1
#	$NetBSD: files.scsi,v 1.2 1996/02/18 20:32:40 mycroft Exp $
d12 2
a13 1
device	scsibus at scsi {target = -1, lun = -1}
d15 2
a16 1
device	cd at scsibus: disk
d18 3
a20 1
device	ch at scsibus: disk
d22 3
a24 1
device	sd at scsibus: disk
d26 3
a28 1
device	st at scsibus: tape
d30 3
a32 1
device	ss at scsibus: tape
d36 3
a38 1
device	su at scsibus: disk
d40 3
a42 1
device	uk at scsibus: disk
a43 1

@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
#	$NetBSD: files.scsi,v 1.1 1995/04/17 07:15:40 cgd Exp $
d22 4
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
