head	1.8;
access;
symbols
	OPENBSD_6_1:1.8.0.8
	OPENBSD_6_1_BASE:1.8
	OPENBSD_6_0:1.8.0.6
	OPENBSD_6_0_BASE:1.8
	OPENBSD_5_9:1.8.0.2
	OPENBSD_5_9_BASE:1.8
	OPENBSD_5_8:1.8.0.4
	OPENBSD_5_8_BASE:1.8
	OPENBSD_5_7:1.7.0.2
	OPENBSD_5_7_BASE:1.7
	OPENBSD_5_6:1.6.0.8
	OPENBSD_5_6_BASE:1.6
	OPENBSD_5_5:1.6.0.6
	OPENBSD_5_5_BASE:1.6
	OPENBSD_5_4:1.6.0.2
	OPENBSD_5_4_BASE:1.6
	OPENBSD_5_3:1.5.0.22
	OPENBSD_5_3_BASE:1.5
	OPENBSD_5_2:1.5.0.20
	OPENBSD_5_2_BASE:1.5
	OPENBSD_5_1_BASE:1.5
	OPENBSD_5_1:1.5.0.18
	OPENBSD_5_0:1.5.0.16
	OPENBSD_5_0_BASE:1.5
	OPENBSD_4_9:1.5.0.14
	OPENBSD_4_9_BASE:1.5
	OPENBSD_4_8:1.5.0.12
	OPENBSD_4_8_BASE:1.5
	OPENBSD_4_7:1.5.0.8
	OPENBSD_4_7_BASE:1.5
	OPENBSD_4_6:1.5.0.10
	OPENBSD_4_6_BASE:1.5
	OPENBSD_4_5:1.5.0.6
	OPENBSD_4_5_BASE:1.5
	OPENBSD_4_4:1.5.0.4
	OPENBSD_4_4_BASE:1.5
	OPENBSD_4_3:1.5.0.2
	OPENBSD_4_3_BASE:1.5
	OPENBSD_4_2:1.4.0.10
	OPENBSD_4_2_BASE:1.4
	OPENBSD_4_1:1.4.0.8
	OPENBSD_4_1_BASE:1.4
	OPENBSD_4_0:1.4.0.6
	OPENBSD_4_0_BASE:1.4
	OPENBSD_3_9:1.4.0.4
	OPENBSD_3_9_BASE:1.4
	OPENBSD_3_8:1.4.0.2
	OPENBSD_3_8_BASE:1.4
	OPENBSD_3_7:1.3.0.8
	OPENBSD_3_7_BASE:1.3
	OPENBSD_3_6:1.3.0.6
	OPENBSD_3_6_BASE:1.3
	SMP_SYNC_A:1.3
	SMP_SYNC_B:1.3
	OPENBSD_3_5:1.3.0.4
	OPENBSD_3_5_BASE:1.3
	OPENBSD_3_4:1.3.0.2
	OPENBSD_3_4_BASE:1.3
	UBC_SYNC_A:1.2
	OPENBSD_3_3:1.2.0.6
	OPENBSD_3_3_BASE:1.2
	OPENBSD_3_2:1.2.0.4
	OPENBSD_3_2_BASE:1.2
	OPENBSD_3_1:1.2.0.2
	OPENBSD_3_1_BASE:1.2
	UBC_SYNC_B:1.2
	UBC:1.1.0.4
	UBC_BASE:1.1
	SMP:1.1.0.2;
locks; strict;
comment	@ * @;


1.8
date	2015.03.14.03.38.53;	author jsg;	state Exp;
branches;
next	1.7;
commitid	p4LJxGKbi0BU2cG6;

1.7
date	2014.09.14.14.17.27;	author jsg;	state Exp;
branches;
next	1.6;
commitid	uzzBR7hz9ncd4O6G;

1.6
date	2013.06.11.16.42.19;	author deraadt;	state Exp;
branches;
next	1.5;

1.5
date	2008.01.05.19.49.26;	author otto;	state Exp;
branches;
next	1.4;

1.4
date	2005.07.03.20.14.03;	author drahn;	state Exp;
branches;
next	1.3;

1.3
date	2003.05.26.18.33.17;	author tedu;	state Exp;
branches;
next	1.2;

1.2
date	2002.02.22.20.51.24;	author drahn;	state Exp;
branches;
next	1.1;

1.1
date	2001.11.21.21.23.56;	author csapuntz;	state Exp;
branches
	1.1.2.1
	1.1.4.1;
next	;

1.1.2.1
date	2002.03.06.02.17.14;	author niklas;	state Exp;
branches;
next	1.1.2.2;

1.1.2.2
date	2003.06.07.11.09.09;	author ho;	state Exp;
branches;
next	;

1.1.4.1
date	2002.06.11.03.32.50;	author art;	state Exp;
branches;
next	;


desc
@@


1.8
log
@Remove some includes include-what-you-use claims don't
have any direct symbols used.  Tested for indirect use by compiling
amd64/i386/sparc64 kernels.

ok tedu@@ deraadt@@
@
text
@/*	$OpenBSD: ufs_quota_stub.c,v 1.7 2014/09/14 14:17:27 jsg Exp $	*/

#include <sys/param.h>
#include <sys/kernel.h>
#include <sys/systm.h>
#include <sys/namei.h>
#include <sys/malloc.h>
#include <sys/vnode.h>
#include <sys/mount.h>

#include <ufs/ufs/quota.h>
#include <ufs/ufs/inode.h>
#include <ufs/ufs/ufsmount.h>
#include <ufs/ufs/ufs_extern.h>

#ifndef QUOTA

int
getinoquota(struct inode *ip) {
	return (0);
}

int
ufs_quota_alloc_blocks2(struct inode *ip, daddr_t change, 
    struct ucred *cred, enum ufs_quota_flags flags) {
	return (0);
}

int
ufs_quota_free_blocks2(struct inode *ip, daddr_t change, 
    struct ucred *cred, enum ufs_quota_flags flags) {
	return (0);
}

int
ufs_quota_alloc_inode2(struct inode *ip, struct ucred *cred,
    enum ufs_quota_flags flags) {
	return (0);
}

int
ufs_quota_free_inode2(struct inode *ip, struct ucred *cred,
    enum ufs_quota_flags flags) {
	return (0);
}

int
quotaoff(struct proc *p, struct mount *mp, int flags) {
	return (0);
}

int
qsync(struct mount *mp) {
	return (0);
}

int
ufs_quotactl(struct mount *mp, int a, uid_t u, caddr_t addr, struct proc *p) {
	return (EOPNOTSUPP);
}

void
ufs_quota_init(void) {
}

int
ufs_quota_delete(struct inode *ip) {
	return (0);
}

#endif
@


1.7
log
@remove uneeded proc.h includes
ok mpi@@ kspillner@@
@
text
@d1 1
a1 1
/*	$OpenBSD: ufs_quota_stub.c,v 1.6 2013/06/11 16:42:19 deraadt Exp $	*/
a7 1
#include <sys/file.h>
@


1.6
log
@final removal of daddr64_t.  daddr_t has been 64 bit for a long enough
test period; i think 3 years ago the last bugs fell out.
ok otto beck others
@
text
@d1 1
a1 1
/*	$OpenBSD: ufs_quota_stub.c,v 1.5 2008/01/05 19:49:26 otto Exp $	*/
a8 1
#include <sys/proc.h>
@


1.5
log
@Make the ffs code 64-bit disk block number clean.  Based on a diff
from Pedro Martelleto.  Two things remain: the on-disk quota
structures are still 32-bit and statfs does not do 64-bit numbers
yet. ok deraadt@@
@
text
@d1 1
a1 1
/*	$OpenBSD: ufs_quota_stub.c,v 1.4 2005/07/03 20:14:03 drahn Exp $	*/
d26 1
a26 1
ufs_quota_alloc_blocks2(struct inode *ip, daddr64_t change, 
d32 1
a32 1
ufs_quota_free_blocks2(struct inode *ip, daddr64_t change, 
@


1.4
log
@Extended Attributes was a piece to get to ACLs, however ACLs have not
been worked on, so EA is pointless. Also the code is not enabled
in GENERIC so it is not being tested or maintained.
@
text
@d1 1
a1 1
/*	$OpenBSD: ufs_quota_stub.c,v 1.3 2003/05/26 18:33:17 tedu Exp $	*/
d26 1
a26 1
ufs_quota_alloc_blocks2(struct inode *ip, daddr_t change, 
d32 1
a32 1
ufs_quota_free_blocks2(struct inode *ip, daddr_t change, 
@


1.3
log
@fiddle with some type names.  change most instances of ufs_daddr_t to
ufs1_daddr_t, a few to daddr_t.  ufs_daddr_t typedef is retained, but consider
it deprecated.  no functional changes.  inspired by freebsd.  ok art@@
@
text
@d1 1
a1 1
/*	$OpenBSD: ufs_quota_stub.c,v 1.2 2002/02/22 20:51:24 drahn Exp $	*/
a12 1
#include <ufs/ufs/extattr.h>
@


1.2
log
@Extended Attribute support from FreeBSD/TrustedBSD ok art@@, deraadt@@
@
text
@d1 1
a1 1
/*	$OpenBSD: ufs_quota_stub.c,v 1.1 2001/11/21 21:23:56 csapuntz Exp $	*/
d27 1
a27 1
ufs_quota_alloc_blocks2(struct inode *ip, ufs_daddr_t change, 
d33 1
a33 1
ufs_quota_free_blocks2(struct inode *ip, ufs_daddr_t change, 
@


1.1
log
@Don't use #define QUOTA - use stub file instead

Pass over the quota code in ufs/. Make code paths clearer. Clean up some names.
Move all code that manipulates quotas directly into ufs_quota.c

Use vfs_mount_foreach_vnode to traverse list of vnodes in mountpoint.
@
text
@d1 1
a1 1
/*	$OpenBSD: ufs_quota.c,v 1.7 1999/04/28 09:28:18 art Exp $	*/
d13 1
@


1.1.4.1
log
@Sync UBC branch to -current
@
text
@d1 1
a1 1
/*	$OpenBSD: ufs_quota_stub.c,v 1.1 2001/11/21 21:23:56 csapuntz Exp $	*/
a12 1
#include <ufs/ufs/extattr.h>
@


1.1.2.1
log
@Merge in trunk
@
text
@d1 1
a1 1
/*	$OpenBSD$	*/
a12 1
#include <ufs/ufs/extattr.h>
@


1.1.2.2
log
@Sync SMP branch to -current
@
text
@d1 1
a1 1
/*	$OpenBSD: ufs_quota_stub.c,v 1.1.2.1 2002/03/06 02:17:14 niklas Exp $	*/
d27 1
a27 1
ufs_quota_alloc_blocks2(struct inode *ip, daddr_t change, 
d33 1
a33 1
ufs_quota_free_blocks2(struct inode *ip, daddr_t change, 
@


