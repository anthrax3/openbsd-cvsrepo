head	1.14;
access;
symbols
	OPENBSD_6_2:1.14.0.32
	OPENBSD_6_2_BASE:1.14
	OPENBSD_6_1:1.14.0.30
	OPENBSD_6_1_BASE:1.14
	OPENBSD_6_0:1.14.0.26
	OPENBSD_6_0_BASE:1.14
	OPENBSD_5_9:1.14.0.16
	OPENBSD_5_9_BASE:1.14
	OPENBSD_5_8:1.14.0.24
	OPENBSD_5_8_BASE:1.14
	OPENBSD_5_7:1.14.0.22
	OPENBSD_5_7_BASE:1.14
	OPENBSD_5_6:1.14.0.20
	OPENBSD_5_6_BASE:1.14
	OPENBSD_5_5:1.14.0.18
	OPENBSD_5_5_BASE:1.14
	OPENBSD_5_4:1.14.0.14
	OPENBSD_5_4_BASE:1.14
	OPENBSD_5_3:1.14.0.12
	OPENBSD_5_3_BASE:1.14
	OPENBSD_5_2:1.14.0.10
	OPENBSD_5_2_BASE:1.14
	OPENBSD_5_1_BASE:1.14
	OPENBSD_5_1:1.14.0.8
	OPENBSD_5_0:1.14.0.6
	OPENBSD_5_0_BASE:1.14
	OPENBSD_4_9:1.14.0.4
	OPENBSD_4_9_BASE:1.14
	OPENBSD_4_8:1.14.0.2
	OPENBSD_4_8_BASE:1.14
	OPENBSD_4_7:1.13.0.18
	OPENBSD_4_7_BASE:1.13
	OPENBSD_4_6:1.13.0.20
	OPENBSD_4_6_BASE:1.13
	OPENBSD_4_5:1.13.0.16
	OPENBSD_4_5_BASE:1.13
	OPENBSD_4_4:1.13.0.14
	OPENBSD_4_4_BASE:1.13
	OPENBSD_4_3:1.13.0.12
	OPENBSD_4_3_BASE:1.13
	OPENBSD_4_2:1.13.0.10
	OPENBSD_4_2_BASE:1.13
	OPENBSD_4_1:1.13.0.8
	OPENBSD_4_1_BASE:1.13
	OPENBSD_4_0:1.13.0.6
	OPENBSD_4_0_BASE:1.13
	OPENBSD_3_9:1.13.0.4
	OPENBSD_3_9_BASE:1.13
	OPENBSD_3_8:1.13.0.2
	OPENBSD_3_8_BASE:1.13
	OPENBSD_3_7:1.12.0.2
	OPENBSD_3_7_BASE:1.12
	OPENBSD_3_6:1.11.0.4
	OPENBSD_3_6_BASE:1.11
	SMP_SYNC_A:1.11
	SMP_SYNC_B:1.11
	OPENBSD_3_5:1.11.0.2
	OPENBSD_3_5_BASE:1.11
	OPENBSD_3_4:1.7.0.4
	OPENBSD_3_4_BASE:1.7
	UBC_SYNC_A:1.7
	OPENBSD_3_3:1.7.0.2
	OPENBSD_3_3_BASE:1.7
	OPENBSD_3_2:1.6.0.2
	OPENBSD_3_2_BASE:1.6
	OPENBSD_3_1:1.5.0.2
	OPENBSD_3_1_BASE:1.5
	UBC_SYNC_B:1.6
	UBC:1.4.0.4
	UBC_BASE:1.4
	OPENBSD_3_0:1.4.0.2
	OPENBSD_3_0_BASE:1.4
	OPENBSD_2_9_BASE:1.3
	OPENBSD_2_9:1.3.0.2
	OPENBSD_2_8:1.2.0.8
	OPENBSD_2_8_BASE:1.2
	OPENBSD_2_7:1.2.0.6
	OPENBSD_2_7_BASE:1.2
	SMP:1.2.0.4
	SMP_BASE:1.2
	kame_19991208:1.2
	OPENBSD_2_6:1.2.0.2
	OPENBSD_2_6_BASE:1.2;
locks; strict;
comment	@ * @;


1.14
date	2010.07.23.07.47.13;	author jsg;	state Exp;
branches;
next	1.13;

1.13
date	2005.08.10.15.22.39;	author jsg;	state Exp;
branches;
next	1.12;

1.12
date	2004.09.24.07.15.22;	author grange;	state Exp;
branches;
next	1.11;

1.11
date	2003.10.21.09.57.04;	author jmc;	state Exp;
branches;
next	1.10;

1.10
date	2003.10.16.20.03.40;	author grange;	state Exp;
branches;
next	1.9;

1.9
date	2003.10.16.10.02.45;	author grange;	state Exp;
branches;
next	1.8;

1.8
date	2003.09.28.21.01.42;	author grange;	state Exp;
branches;
next	1.7;

1.7
date	2003.02.25.19.21.14;	author grange;	state Exp;
branches;
next	1.6;

1.6
date	2002.06.14.21.34.59;	author todd;	state Exp;
branches;
next	1.5;

1.5
date	2002.03.27.17.42.37;	author gluk;	state Exp;
branches;
next	1.4;

1.4
date	2001.06.25.19.31.47;	author csapuntz;	state Exp;
branches
	1.4.4.1;
next	1.3;

1.3
date	2001.03.23.02.16.41;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	99.09.05.21.45.22;	author niklas;	state Exp;
branches
	1.2.4.1;
next	1.1;

1.1
date	99.07.18.21.25.17;	author csapuntz;	state Exp;
branches;
next	;

1.2.4.1
date	2001.05.14.22.23.05;	author niklas;	state Exp;
branches;
next	1.2.4.2;

1.2.4.2
date	2001.07.04.10.40.16;	author niklas;	state Exp;
branches;
next	1.2.4.3;

1.2.4.3
date	2003.03.28.00.38.10;	author niklas;	state Exp;
branches;
next	1.2.4.4;

1.2.4.4
date	2004.02.19.10.56.14;	author niklas;	state Exp;
branches;
next	;

1.4.4.1
date	2002.06.11.03.42.16;	author art;	state Exp;
branches;
next	1.4.4.2;

1.4.4.2
date	2002.10.29.00.33.23;	author art;	state Exp;
branches;
next	1.4.4.3;

1.4.4.3
date	2003.05.19.22.01.42;	author tedu;	state Exp;
branches;
next	;


desc
@@


1.14
log
@Manuel Bouyer rescinded clauses 3 and 4 of his license text.
@
text
@/*	$OpenBSD: atareg.h,v 1.13 2005/08/10 15:22:39 jsg Exp $	*/
/*	$NetBSD: atareg.h,v 1.5 1999/01/18 20:06:24 bouyer Exp $	*/

/*
 * Copyright (c) 1998, 2001 Manuel Bouyer.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 *
 * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
 * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
 * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,     
 * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
 * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
 * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef _DEV_ATA_ATAREG_H_
#define _DEV_ATA_ATAREG_H_

/*
 * Drive parameter structure for ATA/ATAPI.
 * Bit fields: WDC_* : common to ATA/ATAPI
 *             ATA_* : ATA only
 *             ATAPI_* : ATAPI only.
 */
struct ataparams {
    /* drive info */
    u_int16_t	atap_config;		/* 0: general configuration */
#define WDC_CFG_ATAPI_MASK		0xc000
#define WDC_CFG_ATAPI			0x8000
#define ATA_CFG_REMOVABLE		0x0080
#define ATA_CFG_FIXED			0x0040
#define ATAPI_CFG_TYPE_MASK		0x1f00
#define ATAPI_CFG_TYPE(x)		(((x) & ATAPI_CFG_TYPE_MASK) >> 8)
#define ATAPI_CFG_TYPE_DIRECT		0x00
#define ATAPI_CFG_TYPE_SEQUENTIAL	0x01
#define ATAPI_CFG_TYPE_CDROM		0x05
#define ATAPI_CFG_TYPE_OPTICAL		0x07
#define ATAPI_CFG_TYPE_NODEVICE		0x1F
#define ATAPI_CFG_REMOV			0x0080
#define ATAPI_CFG_DRQ_MASK		0x0060
#define ATAPI_CFG_STD_DRQ		0x0000
#define ATAPI_CFG_IRQ_DRQ		0x0020
#define ATAPI_CFG_ACCEL_DRQ		0x0040
#define ATAPI_CFG_CMD_MASK		0x0003
#define ATAPI_CFG_CMD_12		0x0000
#define ATAPI_CFG_CMD_16		0x0001
/* words 1-9 are ATA only */
    u_int16_t	atap_cylinders;		/* 1: # of non-removable cylinders */
    u_int16_t	__reserved1;
    u_int16_t	atap_heads;		/* 3: # of heads */
    u_int16_t	__retired1[2];		/* 4-5: # of unform. bytes/track */
    u_int16_t	atap_sectors;		/* 6: # of sectors */
    u_int16_t	__retired2[3];

    u_int8_t	atap_serial[20];	/* 10-19: serial number */
    u_int16_t	__retired3[2];
    u_int16_t	__obsolete1;
    u_int8_t	atap_revision[8];	/* 23-26: firmware revision */
    u_int8_t	atap_model[40];		/* 27-46: model number */
    u_int16_t	atap_multi;		/* 47: maximum sectors per irq (ATA) */
    u_int16_t	__reserved2;
    u_int16_t	atap_capabilities1;	/* 49: capability flags */
#define WDC_CAP_IORDY	0x0800
#define WDC_CAP_IORDY_DSBL 0x0400
#define WDC_CAP_LBA	0x0200
#define WDC_CAP_DMA	0x0100
#define ATA_CAP_STBY	0x2000
#define ATAPI_CAP_INTERL_DMA	0x8000
#define ATAPI_CAP_CMD_QUEUE	0x4000
#define ATAPI_CAP_OVERLP	0x2000
#define ATAPI_CAP_ATA_RST	0x1000
    u_int16_t	atap_capabilities2;	/* 50: capability flags (ATA) */
#if BYTE_ORDER == LITTLE_ENDIAN
    u_int8_t	__junk2;
    u_int8_t	atap_oldpiotiming;	/* 51: old PIO timing mode */
    u_int8_t	__junk3;
    u_int8_t	atap_olddmatiming;	/* 52: old DMA timing mode (ATA) */
#else
    u_int8_t	atap_oldpiotiming;	/* 51: old PIO timing mode */
    u_int8_t	__junk2;
    u_int8_t	atap_olddmatiming;	/* 52: old DMA timing mode (ATA) */
    u_int8_t	__junk3;
#endif
    u_int16_t	atap_extensions;	/* 53: extensions supported */
#define WDC_EXT_UDMA_MODES	0x0004
#define WDC_EXT_MODES		0x0002
#define WDC_EXT_GEOM		0x0001
/* words 54-62 are ATA only */
    u_int16_t	atap_curcylinders;	/* 54: current logical cylinders */
    u_int16_t	atap_curheads;		/* 55: current logical heads */
    u_int16_t	atap_cursectors;	/* 56: current logical sectors/tracks */
    u_int16_t	atap_curcapacity[2];	/* 57-58: current capacity */
    u_int16_t	atap_curmulti;		/* 59: current multi-sector setting */
#define WDC_MULTI_VALID 0x0100
#define WDC_MULTI_MASK  0x00ff
    u_int16_t	atap_capacity[2];	/* 60-61: total capacity (LBA only) */
    u_int16_t	__retired4;
#if BYTE_ORDER == LITTLE_ENDIAN
    u_int8_t	atap_dmamode_supp;	/* 63: multiword DMA mode supported */
    u_int8_t	atap_dmamode_act;	/*     multiword DMA mode active */
    u_int8_t	atap_piomode_supp;	/* 64: PIO mode supported */
    u_int8_t	__junk4;
#else
    u_int8_t	atap_dmamode_act;	/*     multiword DMA mode active */
    u_int8_t	atap_dmamode_supp;	/* 63: multiword DMA mode supported */
    u_int8_t	__junk4;
    u_int8_t	atap_piomode_supp;	/* 64: PIO mode supported */
#endif
    u_int16_t	atap_dmatiming_mimi;	/* 65: minimum DMA cycle time */
    u_int16_t	atap_dmatiming_recom;	/* 66: recommended DMA cycle time */
    u_int16_t	atap_piotiming;		/* 67: mini PIO cycle time without FC */
    u_int16_t	atap_piotiming_iordy;	/* 68: mini PIO cycle time with IORDY FC */
    u_int16_t	__reserved3[2];
/* words 71-72 are ATAPI only */
    u_int16_t	atap_pkt_br;		/* 71: time (ns) to bus release */
    u_int16_t	atap_pkt_bsyclr;	/* 72: tme to clear BSY after service */
    u_int16_t	__reserved4[2];
    u_int16_t	atap_queuedepth;	/* 75: */
#define WDC_QUEUE_DEPTH_MASK 0x1f
    u_int16_t	atap_sata_caps;		/* 76: SATA capabilities */
#define SATA_SIGNAL_GEN1	0x0002	/* SATA Gen-1 signaling speed */
#define SATA_SIGNAL_GEN2	0x0004	/* SATA Gen-2 signaling speed */
#define SATA_NATIVE_CMDQ	0x0100	/* native command queuing */
#define SATA_HOST_PWR_MGMT	0x0200	/* power management (host) */
    u_int16_t	atap_sata_reserved;	/* 77: reserved */
    u_int16_t	atap_sata_features_supp;/* 78: SATA features supported */
#define SATA_NONZERO_OFFSETS	0x0002	/* non-zero buffer offsets */
#define SATA_DMA_SETUP_AUTO	0x0004	/* DMA setup auto-activate */
#define SATA_DRIVE_PWR_MGMT	0x0008	/* power management (device) */
    u_int16_t	atap_sata_features_en;	/* 79: SATA features enabled */
    u_int16_t	atap_ata_major;		/* 80: Major version number */
#define WDC_VER_ATA1	0x0002
#define WDC_VER_ATA2	0x0004
#define WDC_VER_ATA3	0x0008
#define WDC_VER_ATA4	0x0010
#define WDC_VER_ATA5	0x0020
#define WDC_VER_ATA6	0x0040
#define WDC_VER_ATA7	0x0080
#define WDC_VER_ATA8	0x0100
#define WDC_VER_ATA9	0x0200
#define WDC_VER_ATA10	0x0400
#define WDC_VER_ATA11	0x0800
#define WDC_VER_ATA12	0x1000
#define WDC_VER_ATA13	0x2000
#define WDC_VER_ATA14	0x4000
    u_int16_t	atap_ata_minor;		/* 81: Minor version number */
    u_int16_t	atap_cmd_set1;		/* 82: command set supported */
#define WDC_CMD1_NOP	0x4000
#define WDC_CMD1_RB	0x2000
#define WDC_CMD1_WB	0x1000
#define WDC_CMD1_HPA	0x0400
#define WDC_CMD1_DVRST	0x0200
#define WDC_CMD1_SRV	0x0100
#define WDC_CMD1_RLSE	0x0080
#define WDC_CMD1_AHEAD	0x0040
#define WDC_CMD1_CACHE	0x0020
#define WDC_CMD1_PKT	0x0010
#define WDC_CMD1_PM	0x0008
#define WDC_CMD1_REMOV	0x0004
#define WDC_CMD1_SEC	0x0002
#define WDC_CMD1_SMART	0x0001
    u_int16_t	atap_cmd_set2;		/* 83: command set supported */
#define ATAPI_CMD2_FCE	0x2000 /* Flush Cache Ext supported */
#define ATAPI_CMD2_FC	0x1000 /* Flush Cache supported */
#define ATAPI_CMD2_DCO	0x0800 /* Device Configuration Overlay supported */
#define ATAPI_CMD2_48AD	0x0400 /* 48bit address supported */
#define ATAPI_CMD2_AAM	0x0200 /* Automatic Acoustic Management supported */
#define ATAPI_CMD2_SM	0x0100 /* Set Max security extension supported */
#define ATAPI_CMD2_SF	0x0040 /* Set Features subcommand required */
#define ATAPI_CMD2_PUIS	0x0020 /* Power up in standby supported */
#define WDC_CMD2_RMSN	0x0010
#define ATA_CMD2_APM	0x0008
#define ATA_CMD2_CFA	0x0004
#define ATA_CMD2_RWQ	0x0002
#define WDC_CMD2_DM	0x0001 /* Download Microcode supported */
    u_int16_t	atap_cmd_ext;		/* 84: command/features supp. ext. */
#define ATAPI_CMDE_IIUF	0x2000 /* IDLE IMMEDIATE with UNLOAD FEATURE */	
#define ATAPI_CMDE_MSER	0x0004 /* Media serial number supported */
#define ATAPI_CMDE_TEST	0x0002 /* SMART self-test supported */
#define ATAPI_CMDE_SLOG	0x0001 /* SMART error logging supported */
    u_int16_t	atap_cmd1_en;		/* 85: cmd/features enabled */
/* bits are the same as atap_cmd_set1 */
    u_int16_t	atap_cmd2_en;		/* 86: cmd/features enabled */
/* bits are the same as atap_cmd_set2 */
    u_int16_t	atap_cmd_def;		/* 87: cmd/features default */
/* bits are NOT the same as atap_cmd_ext */
#if BYTE_ORDER == LITTLE_ENDIAN
    u_int8_t	atap_udmamode_supp;	/* 88: Ultra-DMA mode supported */
    u_int8_t	atap_udmamode_act;	/*     Ultra-DMA mode active */
#else
    u_int8_t	atap_udmamode_act;	/*     Ultra-DMA mode active */
    u_int8_t	atap_udmamode_supp;	/* 88: Ultra-DMA mode supported */
#endif
/* 89-92 are ATA-only */
    u_int16_t	atap_seu_time;		/* 89: Sec. Erase Unit compl. time */
    u_int16_t	atap_eseu_time;		/* 90: Enhanced SEU compl. time */
    u_int16_t	atap_apm_val;		/* 91: current APM value */
    u_int16_t	atap_mpasswd_rev;	/* 92: Master Password revision */
    u_int16_t	atap_hwreset_res;	/* 93: Hardware reset value */
#define ATA_HWRES_CBLID    0x2000  /* CBLID above Vih */
#define ATA_HWRES_D1_PDIAG 0x0800  /* Device 1 PDIAG detect OK */
#define ATA_HWRES_D1_CSEL  0x0400  /* Device 1 used CSEL for address */
#define ATA_HWRES_D1_JUMP  0x0200  /* Device 1 jumpered to address */
#define ATA_HWRES_D0_SEL   0x0040  /* Device 0 responds when Dev 1 selected */
#define ATA_HWRES_D0_DASP  0x0020  /* Device 0 DASP detect OK */
#define ATA_HWRES_D0_PDIAG 0x0010  /* Device 0 PDIAG detect OK */
#define ATA_HWRES_D0_DIAG  0x0008  /* Device 0 diag OK */
#define ATA_HWRES_D0_CSEL  0x0004  /* Device 0 used CSEL for address */
#define ATA_HWRES_D0_JUMP  0x0002  /* Device 0 jumpered to address */
#if BYTE_ORDER == LITTLE_ENDIAN
    u_int8_t	atap_acoustic_val;	/* 94: Current acoustic level */
    u_int8_t	atap_acoustic_def;	/*     recommended level */
#else
    u_int8_t	atap_acoustic_def;	/*     recommended level */
    u_int8_t	atap_acoustic_val;	/* 94: Current acoustic level */
#endif
    u_int16_t	__reserved6[5];		/* 95-99: reserved */
    u_int16_t	atap_max_lba[4];	/* 100-103: Max. user LBA add */
    u_int16_t	__reserved7[23];	/* 104-126: reserved */
    u_int16_t	atap_rmsn_supp;		/* 127: remov. media status notif. */
#define WDC_RMSN_SUPP_MASK 0x0003
#define WDC_RMSN_SUPP 0x0001
    u_int16_t	atap_sec_st;		/* 128: security status */
#define WDC_SEC_LEV_MAX	0x0100
#define WDC_SEC_ESE_SUPP 0x0020
#define WDC_SEC_EXP	0x0010
#define WDC_SEC_FROZEN	0x0008
#define WDC_SEC_LOCKED	0x0004
#define WDC_SEC_EN	0x0002
#define WDC_SEC_SUPP	0x0001
    u_int16_t	__reserved8[31];	/* 129-159: vendor specific */
    u_int16_t	atap_cfa_power;		/* 160: CFA powermode */
#define ATAPI_CFA_MAX_MASK  0x0FFF
#define ATAPI_CFA_MODE1_DIS 0x1000 /* CFA Mode 1 Disabled */
#define ATAPI_CFA_MODE1_REQ 0x2000 /* CFA Mode 1 Required */
#define ATAPI_CFA_WORD160   0x8000 /* Word 160 supported */
    u_int16_t	__reserved9[15];	/* 161-175: reserved for CFA */
    u_int8_t	atap_media_serial[60];	/* 176-205: media serial number */
    u_int16_t	__reserved10[49];	/* 206-254: reserved */
#if BYTE_ORDER == LITTLE_ENDIAN
    u_int8_t	atap_signature;		/* 255: Signature */
    u_int8_t	atap_checksum;		/*      Checksum */
#else
    u_int8_t	atap_checksum;		/*      Checksum */
    u_int8_t	atap_signature;		/* 255: Signature */
#endif
};

#endif	/* !_DEV_ATA_ATAREG_H_ */
@


1.13
log
@Mention if the disk supports IDLE IMMEDIATE with UNLOAD FEATURE
when listing information about it. ok grange@@
@
text
@d1 1
a1 1
/*	$OpenBSD: atareg.h,v 1.12 2004/09/24 07:15:22 grange Exp $	*/
a14 5
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 *	This product includes software developed by Manuel Bouyer.
 * 4. The name of the author may not be used to endorse or promote products
 *    derived from this software without specific prior written permission.
@


1.12
log
@Add missing Manuel Bouyer copyright.
@
text
@d1 1
a1 1
/*	$OpenBSD: atareg.h,v 1.11 2003/10/21 09:57:04 jmc Exp $	*/
d194 1
@


1.11
log
@typos from Tom Cosgrove;
@
text
@d1 1
a1 1
/*	$OpenBSD: atareg.h,v 1.10 2003/10/16 20:03:40 grange Exp $	*/
d4 31
a34 2
#ifndef __DEV_ATA_ATAREG_H__
#define __DEV_ATA_ATAREG_H__
d265 1
a265 1
#endif
@


1.10
log
@spaces/tabs cleanup
@
text
@d1 1
a1 1
/*	$OpenBSD: atareg.h,v 1.9 2003/10/16 10:02:45 grange Exp $	*/
d72 1
a72 1
    u_int16_t	atap_extensions;	/* 53: extentions supported */
d77 1
a77 1
    u_int16_t	atap_curcylinders;	/* 54: current logical cyliners */
d98 1
a98 1
    u_int16_t	atap_dmatiming_recom;	/* 66: recomended DMA cycle time */
@


1.9
log
@Define some SATA fields in the IDENTIFY structure.
Names match NetBSD.
@
text
@d1 1
a1 1
/*	$OpenBSD: atareg.h,v 1.8 2003/09/28 21:01:42 grange Exp $	*/
d16 4
a19 4
#define WDC_CFG_ATAPI_MASK    		0xc000
#define WDC_CFG_ATAPI    		0x8000
#define	ATA_CFG_REMOVABLE		0x0080
#define	ATA_CFG_FIXED			0x0040
d27 1
a27 1
#define	ATAPI_CFG_REMOV			0x0080
d53 2
a54 2
#define	WDC_CAP_LBA	0x0200
#define	WDC_CAP_DMA	0x0100
d58 1
a58 1
#define	ATAPI_CAP_OVERLP	0x2000
d84 1
a84 1
    u_int16_t	atap_capacity[2];  	/* 60-61: total capacity (LBA only) */
d87 3
a89 3
    u_int8_t	atap_dmamode_supp; 	/* 63: multiword DMA mode supported */
    u_int8_t	atap_dmamode_act; 	/*     multiword DMA mode active */
    u_int8_t	atap_piomode_supp;       /* 64: PIO mode supported */
d92 2
a93 2
    u_int8_t	atap_dmamode_act; 	/*     multiword DMA mode active */
    u_int8_t	atap_dmamode_supp; 	/* 63: multiword DMA mode supported */
d95 1
a95 1
    u_int8_t	atap_piomode_supp;       /* 64: PIO mode supported */
d99 1
a99 1
    u_int16_t	atap_piotiming;    	/* 67: mini PIO cycle time without FC */
d106 1
a106 1
    u_int16_t	atap_queuedepth;   	/* 75: */
d119 17
a135 17
    u_int16_t	atap_ata_major;  	/* 80: Major version number */
#define	WDC_VER_ATA1	0x0002
#define	WDC_VER_ATA2	0x0004
#define	WDC_VER_ATA3	0x0008
#define	WDC_VER_ATA4	0x0010
#define	WDC_VER_ATA5	0x0020
#define	WDC_VER_ATA6	0x0040
#define	WDC_VER_ATA7	0x0080
#define	WDC_VER_ATA8	0x0100
#define	WDC_VER_ATA9	0x0200
#define	WDC_VER_ATA10	0x0400
#define	WDC_VER_ATA11	0x0800
#define	WDC_VER_ATA12	0x1000
#define	WDC_VER_ATA13	0x2000
#define	WDC_VER_ATA14	0x4000
    u_int16_t   atap_ata_minor;  	/* 81: Minor version number */
    u_int16_t	atap_cmd_set1;    	/* 82: command set supported */
d150 1
a150 1
    u_int16_t	atap_cmd_set2;    	/* 83: command set supported */
d175 2
a176 2
    u_int8_t	atap_udmamode_supp; 	/* 88: Ultra-DMA mode supported */
    u_int8_t	atap_udmamode_act; 	/*     Ultra-DMA mode active */
d178 2
a179 2
    u_int8_t	atap_udmamode_act; 	/*     Ultra-DMA mode active */
    u_int8_t	atap_udmamode_supp; 	/* 88: Ultra-DMA mode supported */
d198 2
a199 2
    u_int8_t	atap_acoustic_val; 	/* 94: Current acoustic level */
    u_int8_t	atap_acoustic_def; 	/*     recommended level */
d201 2
a202 2
    u_int8_t	atap_acoustic_def; 	/*     recommended level */
    u_int8_t	atap_acoustic_val; 	/* 94: Current acoustic level */
d220 1
a220 1
#define	ATAPI_CFA_MAX_MASK 0x0FFF
d228 2
a229 2
    u_int8_t	atap_signature; 	/* 255: Signature */
    u_int8_t	atap_checksum; 		/*      Checksum */
d231 2
a232 2
    u_int8_t	atap_checksum; 		/*      Checksum */
    u_int8_t	atap_signature; 	/* 255: Signature */
@


1.8
log
@kill trailing spaces, no functional changes
@
text
@d1 1
a1 1
/*	$OpenBSD: atareg.h,v 1.7 2003/02/25 19:21:14 grange Exp $	*/
d108 11
a118 1
    u_int16_t	__reserved5[4];
@


1.7
log
@Correct the size of __reserved9 field in struct ataparams;
from Yichen Xie's bounds checker via tedu@@
ok costa@@
@
text
@d1 1
a1 1
/*	$OpenBSD: atareg.h,v 1.6 2002/06/14 21:34:59 todd Exp $	*/
d105 1
a105 1
    u_int16_t	__reserved4[2];	
d108 1
a108 1
    u_int16_t	__reserved5[4];   	
@


1.6
log
@spelling; from Brian Poole <raj@@cerias.purdue.edu>
@
text
@d1 1
a1 1
/*	$OpenBSD: atareg.h,v 1.5 2002/03/27 17:42:37 gluk Exp $	*/
d214 1
a214 1
    u_int16_t	__reserved9[31];	/* 161-175: reserved for CFA */
@


1.5
log
@Calculate the maximum queue depth correctly.
PR2490 from Alexander Yurchenko <grange@@rt.mipt.ru>
@
text
@d1 1
a1 1
/*	$OpenBSD: atareg.h,v 1.4 2001/06/25 19:31:47 csapuntz Exp $	*/
d125 1
a125 1
    u_int16_t	atap_cmd_set1;    	/* 82: command set suported */
d140 1
a140 1
    u_int16_t	atap_cmd_set2;    	/* 83: command set suported */
@


1.4
log
@

Fix excessive resets and device probes by storing IDENTIFY results in the
drvp structure
@
text
@d1 1
a1 1
/*	$OpenBSD: atareg.h,v 1.3 2001/03/23 02:16:41 deraadt Exp $	*/
d107 1
a107 1
#define WDC_QUEUE_DEPTH_MASK 0x0F
@


1.4.4.1
log
@Sync UBC branch to -current
@
text
@d1 1
a1 1
/*	$OpenBSD: atareg.h,v 1.4 2001/06/25 19:31:47 csapuntz Exp $	*/
d107 1
a107 1
#define WDC_QUEUE_DEPTH_MASK 0x1f
@


1.4.4.2
log
@sync to -current
@
text
@d1 1
a1 1
/*	$OpenBSD: atareg.h,v 1.4.4.1 2002/06/11 03:42:16 art Exp $	*/
d125 1
a125 1
    u_int16_t	atap_cmd_set1;    	/* 82: command set supported */
d140 1
a140 1
    u_int16_t	atap_cmd_set2;    	/* 83: command set supported */
@


1.4.4.3
log
@sync
@
text
@d1 1
a1 1
/*	$OpenBSD$	*/
d214 1
a214 1
    u_int16_t	__reserved9[15];	/* 161-175: reserved for CFA */
@


1.3
log
@atactl SMART support; wouter@@yourcreativesolutions.nl
@
text
@d1 1
a1 1
/*	$OpenBSD: atareg.h,v 1.2 1999/09/05 21:45:22 niklas Exp $	*/
d4 3
d225 2
@


1.2
log
@Support for ATAPI tapes, works but still has some rough edges.  Some style.
@
text
@d1 1
a1 1
/*	$OpenBSD: atareg.h,v 1.1 1999/07/18 21:25:17 csapuntz Exp $	*/
d112 9
d138 8
a146 1
#define WDC_CMD2_DM	0x0001
d150 1
d152 3
d160 1
d172 22
a193 1
    u_int16_t	__reserved6[35];	/* 92-126: reserved */
d205 16
@


1.2.4.1
log
@merge in approximately 2.9 into SMP branch
@
text
@d1 1
a1 1
/*	$OpenBSD: atareg.h,v 1.3 2001/03/23 02:16:41 deraadt Exp $	*/
a111 9
#define	WDC_VER_ATA6	0x0040
#define	WDC_VER_ATA7	0x0080
#define	WDC_VER_ATA8	0x0100
#define	WDC_VER_ATA9	0x0200
#define	WDC_VER_ATA10	0x0400
#define	WDC_VER_ATA11	0x0800
#define	WDC_VER_ATA12	0x1000
#define	WDC_VER_ATA13	0x2000
#define	WDC_VER_ATA14	0x4000
a128 8
#define ATAPI_CMD2_FCE	0x2000 /* Flush Cache Ext supported */
#define ATAPI_CMD2_FC	0x1000 /* Flush Cache supported */
#define ATAPI_CMD2_DCO	0x0800 /* Device Configuration Overlay supported */
#define ATAPI_CMD2_48AD	0x0400 /* 48bit address supported */
#define ATAPI_CMD2_AAM	0x0200 /* Automatic Acoustic Management supported */
#define ATAPI_CMD2_SM	0x0100 /* Set Max security extension supported */
#define ATAPI_CMD2_SF	0x0040 /* Set Features subcommand required */
#define ATAPI_CMD2_PUIS	0x0020 /* Power up in standby supported */
d130 1
a133 1
#define WDC_CMD2_DM	0x0001 /* Download Microcode supported */
a134 3
#define ATAPI_CMDE_MSER	0x0004 /* Media serial number supported */
#define ATAPI_CMDE_TEST	0x0002 /* SMART self-test supported */
#define ATAPI_CMDE_SLOG	0x0001 /* SMART error logging supported */
a139 1
/* bits are NOT the same as atap_cmd_ext */
d151 1
a151 22
    u_int16_t	atap_mpasswd_rev;	/* 92: Master Password revision */
    u_int16_t	atap_hwreset_res;	/* 93: Hardware reset value */
#define ATA_HWRES_CBLID    0x2000  /* CBLID above Vih */
#define ATA_HWRES_D1_PDIAG 0x0800  /* Device 1 PDIAG detect OK */
#define ATA_HWRES_D1_CSEL  0x0400  /* Device 1 used CSEL for address */
#define ATA_HWRES_D1_JUMP  0x0200  /* Device 1 jumpered to address */
#define ATA_HWRES_D0_SEL   0x0040  /* Device 0 responds when Dev 1 selected */
#define ATA_HWRES_D0_DASP  0x0020  /* Device 0 DASP detect OK */
#define ATA_HWRES_D0_PDIAG 0x0010  /* Device 0 PDIAG detect OK */
#define ATA_HWRES_D0_DIAG  0x0008  /* Device 0 diag OK */
#define ATA_HWRES_D0_CSEL  0x0004  /* Device 0 used CSEL for address */
#define ATA_HWRES_D0_JUMP  0x0002  /* Device 0 jumpered to address */
#if BYTE_ORDER == LITTLE_ENDIAN
    u_int8_t	atap_acoustic_val; 	/* 94: Current acoustic level */
    u_int8_t	atap_acoustic_def; 	/*     recommended level */
#else
    u_int8_t	atap_acoustic_def; 	/*     recommended level */
    u_int8_t	atap_acoustic_val; 	/* 94: Current acoustic level */
#endif
    u_int16_t	__reserved6[5];		/* 95-99: reserved */
    u_int16_t	atap_max_lba[4];	/* 100-103: Max. user LBA add */
    u_int16_t	__reserved7[23];	/* 104-126: reserved */
a162 16
    u_int16_t	__reserved8[31];	/* 129-159: vendor specific */
    u_int16_t	atap_cfa_power;		/* 160: CFA powermode */
#define	ATAPI_CFA_MAX_MASK 0x0FFF
#define ATAPI_CFA_MODE1_DIS 0x1000 /* CFA Mode 1 Disabled */
#define ATAPI_CFA_MODE1_REQ 0x2000 /* CFA Mode 1 Required */
#define ATAPI_CFA_WORD160   0x8000 /* Word 160 supported */
    u_int16_t	__reserved9[31];	/* 161-175: reserved for CFA */
    u_int8_t	atap_media_serial[60];	/* 176-205: media serial number */
    u_int16_t	__reserved10[49];	/* 206-254: reserved */
#if BYTE_ORDER == LITTLE_ENDIAN
    u_int8_t	atap_signature; 	/* 255: Signature */
    u_int8_t	atap_checksum; 		/*      Checksum */
#else
    u_int8_t	atap_checksum; 		/*      Checksum */
    u_int8_t	atap_signature; 	/* 255: Signature */
#endif
@


1.2.4.2
log
@Merge in -current from two days ago in the SMP branch.
As usual with merges, they do not indicate progress, so do not hold
your breath for working SMP, and do not mail me and ask about the
state of it.  It has not changed.  There is work ongoing, but very, very
slowly.  The commit is done in parts as to not lock up the tree in too
big chunks at a time.
@
text
@d1 1
a1 1
/*	$OpenBSD: atareg.h,v 1.2.4.1 2001/05/14 22:23:05 niklas Exp $	*/
a3 3
#ifndef __DEV_ATA_ATAREG_H__
#define __DEV_ATA_ATAREG_H__

a221 2

#endif
@


1.2.4.3
log
@Sync the SMP branch with 3.3
@
text
@d1 1
a1 1
/*	$OpenBSD$	*/
d107 1
a107 1
#define WDC_QUEUE_DEPTH_MASK 0x1f
d125 1
a125 1
    u_int16_t	atap_cmd_set1;    	/* 82: command set supported */
d140 1
a140 1
    u_int16_t	atap_cmd_set2;    	/* 83: command set supported */
d214 1
a214 1
    u_int16_t	__reserved9[15];	/* 161-175: reserved for CFA */
@


1.2.4.4
log
@Merge of current from two weeks agointo the SMP branch
@
text
@d16 4
a19 4
#define WDC_CFG_ATAPI_MASK		0xc000
#define WDC_CFG_ATAPI			0x8000
#define ATA_CFG_REMOVABLE		0x0080
#define ATA_CFG_FIXED			0x0040
d27 1
a27 1
#define ATAPI_CFG_REMOV			0x0080
d53 2
a54 2
#define WDC_CAP_LBA	0x0200
#define WDC_CAP_DMA	0x0100
d58 1
a58 1
#define ATAPI_CAP_OVERLP	0x2000
d72 1
a72 1
    u_int16_t	atap_extensions;	/* 53: extensions supported */
d77 1
a77 1
    u_int16_t	atap_curcylinders;	/* 54: current logical cylinders */
d84 1
a84 1
    u_int16_t	atap_capacity[2];	/* 60-61: total capacity (LBA only) */
d87 3
a89 3
    u_int8_t	atap_dmamode_supp;	/* 63: multiword DMA mode supported */
    u_int8_t	atap_dmamode_act;	/*     multiword DMA mode active */
    u_int8_t	atap_piomode_supp;	/* 64: PIO mode supported */
d92 2
a93 2
    u_int8_t	atap_dmamode_act;	/*     multiword DMA mode active */
    u_int8_t	atap_dmamode_supp;	/* 63: multiword DMA mode supported */
d95 1
a95 1
    u_int8_t	atap_piomode_supp;	/* 64: PIO mode supported */
d98 2
a99 2
    u_int16_t	atap_dmatiming_recom;	/* 66: recommended DMA cycle time */
    u_int16_t	atap_piotiming;		/* 67: mini PIO cycle time without FC */
d105 2
a106 2
    u_int16_t	__reserved4[2];
    u_int16_t	atap_queuedepth;	/* 75: */
d108 18
a125 28
    u_int16_t	atap_sata_caps;		/* 76: SATA capabilities */
#define SATA_SIGNAL_GEN1	0x0002	/* SATA Gen-1 signaling speed */
#define SATA_SIGNAL_GEN2	0x0004	/* SATA Gen-2 signaling speed */
#define SATA_NATIVE_CMDQ	0x0100	/* native command queuing */
#define SATA_HOST_PWR_MGMT	0x0200	/* power management (host) */
    u_int16_t	atap_sata_reserved;	/* 77: reserved */
    u_int16_t	atap_sata_features_supp;/* 78: SATA features supported */
#define SATA_NONZERO_OFFSETS	0x0002	/* non-zero buffer offsets */
#define SATA_DMA_SETUP_AUTO	0x0004	/* DMA setup auto-activate */
#define SATA_DRIVE_PWR_MGMT	0x0008	/* power management (device) */
    u_int16_t	atap_sata_features_en;	/* 79: SATA features enabled */
    u_int16_t	atap_ata_major;		/* 80: Major version number */
#define WDC_VER_ATA1	0x0002
#define WDC_VER_ATA2	0x0004
#define WDC_VER_ATA3	0x0008
#define WDC_VER_ATA4	0x0010
#define WDC_VER_ATA5	0x0020
#define WDC_VER_ATA6	0x0040
#define WDC_VER_ATA7	0x0080
#define WDC_VER_ATA8	0x0100
#define WDC_VER_ATA9	0x0200
#define WDC_VER_ATA10	0x0400
#define WDC_VER_ATA11	0x0800
#define WDC_VER_ATA12	0x1000
#define WDC_VER_ATA13	0x2000
#define WDC_VER_ATA14	0x4000
    u_int16_t	atap_ata_minor;		/* 81: Minor version number */
    u_int16_t	atap_cmd_set1;		/* 82: command set supported */
d140 1
a140 1
    u_int16_t	atap_cmd_set2;		/* 83: command set supported */
d165 2
a166 2
    u_int8_t	atap_udmamode_supp;	/* 88: Ultra-DMA mode supported */
    u_int8_t	atap_udmamode_act;	/*     Ultra-DMA mode active */
d168 2
a169 2
    u_int8_t	atap_udmamode_act;	/*     Ultra-DMA mode active */
    u_int8_t	atap_udmamode_supp;	/* 88: Ultra-DMA mode supported */
d188 2
a189 2
    u_int8_t	atap_acoustic_val;	/* 94: Current acoustic level */
    u_int8_t	atap_acoustic_def;	/*     recommended level */
d191 2
a192 2
    u_int8_t	atap_acoustic_def;	/*     recommended level */
    u_int8_t	atap_acoustic_val;	/* 94: Current acoustic level */
d210 1
a210 1
#define ATAPI_CFA_MAX_MASK  0x0FFF
d218 2
a219 2
    u_int8_t	atap_signature;		/* 255: Signature */
    u_int8_t	atap_checksum;		/*      Checksum */
d221 2
a222 2
    u_int8_t	atap_checksum;		/*      Checksum */
    u_int8_t	atap_signature;		/* 255: Signature */
@


1.1
log
@

Import of NetBSD ATA/IDE stuff.

Introduction of home-grown

To enable this stuff in your configuration, look at the NEWATA conf file
and go through

dev/isa/files.isa
dev/pci/files.pci
conf/files
arch/i386/conf/files.i386

and follow the instructions on commenting/uncommenting stuff
@
text
@d1 1
a1 1
/*	$OpenBSD: atareg.h,v 1.5 1999/01/18 20:06:24 bouyer Exp $	*/
d13 19
a31 14
#define WDC_CFG_ATAPI_MASK    	0xc000
#define WDC_CFG_ATAPI    	0x8000
#define	ATA_CFG_REMOVABLE	0x0080
#define	ATA_CFG_FIXED		0x0040
#define ATAPI_CFG_TYPE_MASK	0x1f00
#define ATAPI_CFG_TYPE(x) (((x) & ATAPI_CFG_TYPE_MASK) >> 8)
#define	ATAPI_CFG_REMOV		0x0080
#define ATAPI_CFG_DRQ_MASK	0x0060
#define ATAPI_CFG_STD_DRQ	0x0000
#define ATAPI_CFG_IRQ_DRQ	0x0020
#define ATAPI_CFG_ACCEL_DRQ	0x0040
#define ATAPI_CFG_CMD_MASK	0x0003
#define ATAPI_CFG_CMD_12	0x0000
#define ATAPI_CFG_CMD_16	0x0001
d55 1
a55 1
#define	ATAPI_CAP_OVERLP	0X2000
@

