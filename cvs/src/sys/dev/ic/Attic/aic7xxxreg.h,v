head	1.14;
access;
symbols
	SMP_SYNC_A:1.14
	SMP_SYNC_B:1.14
	OPENBSD_3_4:1.13.0.2
	OPENBSD_3_4_BASE:1.13
	UBC_SYNC_A:1.12
	OPENBSD_3_3:1.12.0.4
	OPENBSD_3_3_BASE:1.12
	OPENBSD_3_2:1.12.0.2
	OPENBSD_3_2_BASE:1.12
	OPENBSD_3_1:1.9.0.2
	OPENBSD_3_1_BASE:1.9
	UBC_SYNC_B:1.12
	UBC:1.7.0.10
	UBC_BASE:1.7
	OPENBSD_3_0:1.7.0.8
	OPENBSD_3_0_BASE:1.7
	OPENBSD_2_9_BASE:1.7
	OPENBSD_2_9:1.7.0.6
	OPENBSD_2_8:1.7.0.4
	OPENBSD_2_8_BASE:1.7
	OPENBSD_2_7:1.7.0.2
	OPENBSD_2_7_BASE:1.7
	SMP:1.5.0.14
	SMP_BASE:1.5
	kame_19991208:1.5
	OPENBSD_2_6:1.5.0.12
	OPENBSD_2_6_BASE:1.5
	OPENBSD_2_5:1.5.0.10
	OPENBSD_2_5_BASE:1.5
	OPENBSD_2_4:1.5.0.8
	OPENBSD_2_4_BASE:1.5
	OPENBSD_2_3:1.5.0.6
	OPENBSD_2_3_BASE:1.5
	OPENBSD_2_2:1.5.0.4
	OPENBSD_2_2_BASE:1.5
	OPENBSD_2_1:1.5.0.2
	OPENBSD_2_1_BASE:1.5
	OPENBSD_2_0:1.2.0.2
	OPENBSD_2_0_BASE:1.2;
locks; strict;
comment	@ * @;


1.14
date	2004.02.13.00.46.15;	author krw;	state dead;
branches;
next	1.13;

1.13
date	2003.08.28.02.32.47;	author krw;	state Exp;
branches;
next	1.12;

1.12
date	2002.07.05.05.41.03;	author smurph;	state Exp;
branches;
next	1.11;

1.11
date	2002.06.30.19.39.09;	author smurph;	state Exp;
branches;
next	1.10;

1.10
date	2002.06.28.00.34.54;	author smurph;	state Exp;
branches;
next	1.9;

1.9
date	2002.03.19.02.49.20;	author millert;	state Exp;
branches;
next	1.8;

1.8
date	2002.02.16.04.36.33;	author smurph;	state Exp;
branches;
next	1.7;

1.7
date	2000.04.04.03.48.48;	author smurph;	state Exp;
branches
	1.7.10.1;
next	1.6;

1.6
date	2000.03.22.02.48.47;	author smurph;	state Exp;
branches;
next	1.5;

1.5
date	97.04.10.22.52.19;	author deraadt;	state Exp;
branches
	1.5.14.1;
next	1.4;

1.4
date	96.11.28.23.27.45;	author niklas;	state Exp;
branches;
next	1.3;

1.3
date	96.10.31.01.01.25;	author niklas;	state Exp;
branches;
next	1.2;

1.2
date	96.06.27.21.15.49;	author shawn;	state Exp;
branches;
next	1.1;

1.1
date	96.05.26.00.26.58;	author deraadt;	state Exp;
branches;
next	;

1.5.14.1
date	2000.03.24.09.09.09;	author niklas;	state Exp;
branches;
next	1.5.14.2;

1.5.14.2
date	2001.05.14.22.23.25;	author niklas;	state Exp;
branches;
next	1.5.14.3;

1.5.14.3
date	2002.03.06.02.11.42;	author niklas;	state Exp;
branches;
next	1.5.14.4;

1.5.14.4
date	2002.03.28.11.51.00;	author niklas;	state Exp;
branches;
next	1.5.14.5;

1.5.14.5
date	2003.03.28.00.38.12;	author niklas;	state Exp;
branches;
next	1.5.14.6;

1.5.14.6
date	2004.02.19.10.56.17;	author niklas;	state Exp;
branches;
next	1.5.14.7;

1.5.14.7
date	2004.06.05.23.12.40;	author niklas;	state dead;
branches;
next	;

1.7.10.1
date	2002.10.29.00.33.24;	author art;	state Exp;
branches;
next	;


desc
@@


1.14
log
@Not used in updated ahc.
@
text
@/* $OpenBSD: aic7xxxreg.h,v 1.13 2003/08/28 02:32:47 krw Exp $ */
/*
 * DO NOT EDIT - This file is automatically generated
 *		 from the following source files:
 *
 * $Id: aic7xxxreg.h,v 1.13 2003/08/28 02:32:47 krw Exp $
 * $Id: aic7xxxreg.h,v 1.13 2003/08/28 02:32:47 krw Exp $
 */

#define	SCSISEQ         		0x00
#define		TEMODE          	0x80
#define		SCSIRSTO        	0x01

#define	SXFRCTL0        		0x01
#define		DFON            	0x80
#define		DFPEXP          	0x40
#define		FAST20          	0x20
#define		CLRSTCNT        	0x10
#define		SPIOEN          	0x08
#define		SCAMEN          	0x04
#define		CLRCHN          	0x02

#define	SXFRCTL1        		0x02
#define		BITBUCKET       	0x80
#define		SWRAPEN         	0x40
#define		STIMESEL        	0x18
#define		ENSTIMER        	0x04
#define		ACTNEGEN        	0x02
#define		STPWEN          	0x01

#define	SCSISIGI        		0x03
#define		P_DATAIN_DT     	0x60
#define		P_DATAOUT_DT    	0x20
#define		ATNI            	0x10
#define		SELI            	0x08
#define		BSYI            	0x04
#define		REQI            	0x02
#define		ACKI            	0x01

#define	SCSISIGO        		0x03
#define		CDO             	0x80
#define		IOO             	0x40
#define		MSGO            	0x20
#define		ATNO            	0x10
#define		SELO            	0x08
#define		BSYO            	0x04
#define		REQO            	0x02
#define		ACKO            	0x01

#define	SCSIRATE        		0x04
#define		WIDEXFER        	0x80
#define		SXFR            	0x70
#define		ENABLE_CRC      	0x40
#define		SINGLE_EDGE     	0x10
#define		SXFR_ULTRA2     	0x0f
#define		SOFS            	0x0f

#define	SCSIID          		0x05
#define	SCSIOFFSET      		0x05
#define		SOFS_ULTRA2     	0x7f

#define	SCSIDATL        		0x06

#define	SCSIDATH        		0x07

#define	OPTIONMODE      		0x08
#define		AUTORATEEN      	0x80
#define		AUTOACKEN       	0x40
#define		ATNMGMNTEN      	0x20
#define		BUSFREEREV      	0x10
#define		EXPPHASEDIS     	0x08
#define		SCSIDATL_IMGEN  	0x04
#define		OPTIONMODE_DEFAULTS	0x03
#define		AUTO_MSGOUT_DE  	0x02
#define		DIS_MSGIN_DUALEDGE	0x01

#define	STCNT           		0x08

#define	TARGCRCCNT      		0x0a

#define	CLRSINT0        		0x0b
#define		CLRSELDO        	0x40
#define		CLRSELDI        	0x20
#define		CLRSELINGO      	0x10
#define		CLRIOERR        	0x08
#define		CLRSWRAP        	0x08
#define		CLRSPIORDY      	0x02

#define	SSTAT0          		0x0b
#define		TARGET          	0x80
#define		SELDO           	0x40
#define		SELDI           	0x20
#define		SELINGO         	0x10
#define		IOERR           	0x08
#define		SWRAP           	0x08
#define		SDONE           	0x04
#define		SPIORDY         	0x02
#define		DMADONE         	0x01

#define	CLRSINT1        		0x0c
#define		CLRSELTIMEO     	0x80
#define		CLRATNO         	0x40
#define		CLRSCSIRSTI     	0x20
#define		CLRBUSFREE      	0x08
#define		CLRSCSIPERR     	0x04
#define		CLRPHASECHG     	0x02
#define		CLRREQINIT      	0x01

#define	SSTAT1          		0x0c
#define		SELTO           	0x80
#define		ATNTARG         	0x40
#define		SCSIRSTI        	0x20
#define		PHASEMIS        	0x10
#define		BUSFREE         	0x08
#define		SCSIPERR        	0x04
#define		PHASECHG        	0x02
#define		REQINIT         	0x01

#define	SSTAT2          		0x0d
#define		OVERRUN         	0x80
#define		SHVALID         	0x40
#define		SFCNT           	0x1f
#define		EXP_ACTIVE      	0x10
#define		CRCVALERR       	0x08
#define		CRCENDERR       	0x04
#define		CRCREQERR       	0x02
#define		DUAL_EDGE_ERR   	0x01

#define	SSTAT3          		0x0e
#define		SCSICNT         	0xf0
#define		OFFCNT          	0x0f

#define	SCSIID_ULTRA2   		0x0f

#define	SIMODE0         		0x10
#define		ENSELDO         	0x40
#define		ENSELDI         	0x20
#define		ENSELINGO       	0x10
#define		ENIOERR         	0x08
#define		ENSWRAP         	0x08
#define		ENSDONE         	0x04
#define		ENSPIORDY       	0x02
#define		ENDMADONE       	0x01

#define	SIMODE1         		0x11
#define		ENSELTIMO       	0x80
#define		ENATNTARG       	0x40
#define		ENSCSIRST       	0x20
#define		ENPHASEMIS      	0x10
#define		ENBUSFREE       	0x08
#define		ENSCSIPERR      	0x04
#define		ENPHASECHG      	0x02
#define		ENREQINIT       	0x01

#define	SCSIBUSL        		0x12

#define	SCSIBUSH        		0x13

#define	SHADDR          		0x14

#define	SELTIMER        		0x18
#define	TARGIDIN        		0x18
#define		STAGE6          	0x20
#define		STAGE5          	0x10
#define		STAGE4          	0x08
#define		STAGE3          	0x04
#define		STAGE2          	0x02
#define		STAGE1          	0x01

#define	SELID           		0x19
#define		SELID_MASK      	0xf0
#define		ONEBIT          	0x08

#define	SCAMCTL         		0x1a
#define		ENSCAMSELO      	0x80
#define		CLRSCAMSELID    	0x40
#define		ALTSTIM         	0x20
#define		DFLTTID         	0x10
#define		SCAMLVL         	0x03

#define	TARGID          		0x1b

#define	SPIOCAP         		0x1b
#define		SOFT1           	0x80
#define		SOFT0           	0x40
#define		SOFTCMDEN       	0x20
#define		HAS_BRDCTL      	0x10
#define		SEEPROM         	0x08
#define		EEPROM          	0x04
#define		ROM             	0x02
#define		SSPIOCPS        	0x01

#define	BRDCTL          		0x1d
#define		BRDDAT7         	0x80
#define		BRDDAT6         	0x40
#define		BRDDAT5         	0x20
#define		BRDDAT4         	0x10
#define		BRDSTB          	0x10
#define		BRDDAT3         	0x08
#define		BRDCS           	0x08
#define		BRDDAT2         	0x04
#define		BRDRW           	0x04
#define		BRDCTL1         	0x02
#define		BRDRW_ULTRA2    	0x02
#define		BRDCTL0         	0x01
#define		BRDSTB_ULTRA2   	0x01

#define	SEECTL          		0x1e
#define		EXTARBACK       	0x80
#define		EXTARBREQ       	0x40
#define		SEEMS           	0x20
#define		SEERDY          	0x10
#define		SEECS           	0x08
#define		SEECK           	0x04
#define		SEEDO           	0x02
#define		SEEDI           	0x01

#define	SBLKCTL         		0x1f
#define		DIAGLEDEN       	0x80
#define		DIAGLEDON       	0x40
#define		AUTOFLUSHDIS    	0x20
#define		ENAB40          	0x08
#define		SELBUSB         	0x08
#define		ENAB20          	0x04
#define		SELWIDE         	0x02
#define		XCVR            	0x01

#define	BUSY_TARGETS    		0x20
#define	TARG_SCSIRATE   		0x20

#define	ULTRA_ENB       		0x30
#define	CMDSIZE_TABLE   		0x30

#define	DISC_DSB        		0x32

#define	CMDSIZE_TABLE_TAIL		0x34

#define	MWI_RESIDUAL    		0x38

#define	NEXT_QUEUED_SCB 		0x39

#define	MSG_OUT         		0x3a

#define	DMAPARAMS       		0x3b
#define		PRELOADEN       	0x80
#define		WIDEODD         	0x40
#define		SCSIEN          	0x20
#define		SDMAENACK       	0x10
#define		SDMAEN          	0x10
#define		HDMAENACK       	0x08
#define		HDMAEN          	0x08
#define		DIRECTION       	0x04
#define		FIFOFLUSH       	0x02
#define		FIFORESET       	0x01

#define	SEQ_FLAGS       		0x3c
#define		IDENTIFY_SEEN   	0x80
#define		TARGET_CMD_IS_TAGGED	0x40
#define		DPHASE          	0x20
#define		TARG_CMD_PENDING	0x10
#define		CMDPHASE_PENDING	0x08
#define		DPHASE_PENDING  	0x04
#define		SPHASE_PENDING  	0x02
#define		NO_DISCONNECT   	0x01

#define	SAVED_SCSIID    		0x3d

#define	SAVED_LUN       		0x3e

#define	LASTPHASE       		0x3f
#define		PHASE_MASK      	0xe0
#define		P_MESGIN        	0xe0
#define		P_STATUS        	0xc0
#define		P_MESGOUT       	0xa0
#define		P_COMMAND       	0x80
#define		CDI             	0x80
#define		IOI             	0x40
#define		P_DATAIN        	0x40
#define		MSGI            	0x20
#define		P_BUSFREE       	0x01
#define		P_DATAOUT       	0x00

#define	WAITING_SCBH    		0x40

#define	DISCONNECTED_SCBH		0x41

#define	FREE_SCBH       		0x42

#define	COMPLETE_SCBH   		0x43

#define	HSCB_ADDR       		0x44

#define	SHARED_DATA_ADDR		0x48

#define	KERNEL_QINPOS   		0x4c

#define	QINPOS          		0x4d

#define	QOUTPOS         		0x4e

#define	KERNEL_TQINPOS  		0x4f

#define	TQINPOS         		0x50

#define	ARG_1           		0x51
#define	RETURN_1        		0x51
#define		SEND_MSG        	0x80
#define		SEND_SENSE      	0x40
#define		SEND_REJ        	0x20
#define		MSGOUT_PHASEMIS 	0x10
#define		EXIT_MSG_LOOP   	0x08
#define		CONT_MSG_LOOP   	0x04
#define		CONT_TARG_SESSION	0x02

#define	ARG_2           		0x52
#define	RETURN_2        		0x52

#define	LAST_MSG        		0x53

#define	SCSISEQ_TEMPLATE		0x54
#define		ENSELO          	0x40
#define		ENSELI          	0x20
#define		ENRSELI         	0x10
#define		ENAUTOATNO      	0x08
#define		ENAUTOATNI      	0x04
#define		ENAUTOATNP      	0x02

#define	DATA_COUNT_ODD  		0x55

#define	INITIATOR_TAG   		0x56

#define	SEQ_FLAGS2      		0x57
#define		SCB_DMA         	0x01

#define	SCSICONF        		0x5a
#define		TERM_ENB        	0x80
#define		RESET_SCSI      	0x40
#define		ENSPCHK         	0x20
#define		HWSCSIID        	0x0f
#define		HSCSIID         	0x07

#define	INTDEF          		0x5c
#define		EDGE_TRIG       	0x80
#define		VECTOR          	0x0f

#define	HOSTCONF        		0x5d

#define	HA_274_BIOSCTRL 		0x5f
#define		BIOSMODE        	0x30
#define		BIOSDISABLED    	0x30
#define		CHANNEL_B_PRIMARY	0x08

#define	SEQCTL          		0x60
#define		PERRORDIS       	0x80
#define		PAUSEDIS        	0x40
#define		FAILDIS         	0x20
#define		FASTMODE        	0x10
#define		BRKADRINTEN     	0x08
#define		STEP            	0x04
#define		SEQRESET        	0x02
#define		LOADRAM         	0x01

#define	SEQRAM          		0x61

#define	SEQADDR0        		0x62

#define	SEQADDR1        		0x63
#define		SEQADDR1_MASK   	0x01

#define	ACCUM           		0x64

#define	SINDEX          		0x65

#define	DINDEX          		0x66

#define	ALLONES         		0x69

#define	NONE            		0x6a

#define	ALLZEROS        		0x6a

#define	FLAGS           		0x6b
#define		ZERO            	0x02
#define		CARRY           	0x01

#define	SINDIR          		0x6c

#define	DINDIR          		0x6d

#define	FUNCTION1       		0x6e

#define	STACK           		0x6f

#define	SRAM_BASE       		0x70

#define	TARG_OFFSET     		0x70

#define	BCTL            		0x84
#define		ACE             	0x08
#define		ENABLE          	0x01

#define	DSCOMMAND0      		0x84
#define		CACHETHEN       	0x80
#define		DPARCKEN        	0x40
#define		MPARCKEN        	0x20
#define		EXTREQLCK       	0x10
#define		INTSCBRAMSEL    	0x08
#define		RAMPS           	0x04
#define		USCBSIZE32      	0x02
#define		CIOPARCKEN      	0x01

#define	BUSTIME         		0x85
#define		BOFF            	0xf0
#define		BON             	0x0f

#define	DSCOMMAND1      		0x85
#define		DSLATT          	0xfc
#define		HADDLDSEL1      	0x02
#define		HADDLDSEL0      	0x01

#define	BUSSPD          		0x86
#define		DFTHRSH         	0xc0
#define		DFTHRSH_75      	0x80
#define		STBOFF          	0x38
#define		STBON           	0x07

#define	HS_MAILBOX      		0x86
#define		HOST_MAILBOX    	0xf0
#define		HOST_TQINPOS    	0x80
#define		HOST_REQ_INT    	0x10
#define		SEQ_MAILBOX     	0x0f

#define	DSPCISTATUS     		0x86
#define		DFTHRSH_100     	0xc0

#define	HCNTRL          		0x87
#define		POWRDN          	0x40
#define		SWINT           	0x10
#define		IRQMS           	0x08
#define		PAUSE           	0x04
#define		INTEN           	0x02
#define		CHIPRSTACK      	0x01
#define		CHIPRST         	0x01

#define	HADDR           		0x88

#define	HCNT            		0x8c

#define	SCBPTR          		0x90

#define	INTSTAT         		0x91
#define		SEQINT_MASK     	0xf1
#define		OUT_OF_RANGE    	0xe1
#define		NO_FREE_SCB     	0xd1
#define		SCB_MISMATCH    	0xc1
#define		MISSED_BUSFREE  	0xb1
#define		MKMSG_FAILED    	0xa1
#define		DATA_OVERRUN    	0x91
#define		PERR_DETECTED   	0x81
#define		BAD_STATUS      	0x71
#define		HOST_MSG_LOOP   	0x61
#define		PDATA_REINIT    	0x51
#define		IGN_WIDE_RES    	0x41
#define		NO_MATCH        	0x31
#define		NO_IDENT        	0x21
#define		SEND_REJECT     	0x11
#define		INT_PEND        	0x0f
#define		BRKADRINT       	0x08
#define		SCSIINT         	0x04
#define		CMDCMPLT        	0x02
#define		SEQINT          	0x01
#define		BAD_PHASE       	0x01

#define	ERROR           		0x92
#define		CIOPARERR       	0x80
#define		PCIERRSTAT      	0x40
#define		MPARERR         	0x20
#define		DPARERR         	0x10
#define		SQPARERR        	0x08
#define		ILLOPCODE       	0x04
#define		ILLSADDR        	0x02
#define		ILLHADDR        	0x01

#define	CLRINT          		0x92
#define		CLRPARERR       	0x10
#define		CLRBRKADRINT    	0x08
#define		CLRSCSIINT      	0x04
#define		CLRCMDINT       	0x02
#define		CLRSEQINT       	0x01

#define	DFCNTRL         		0x93

#define	DFSTATUS        		0x94
#define		PRELOAD_AVAIL   	0x80
#define		DFCACHETH       	0x40
#define		FIFOQWDEMP      	0x20
#define		MREQPEND        	0x10
#define		HDONE           	0x08
#define		DFTHRESH        	0x04
#define		FIFOFULL        	0x02
#define		FIFOEMP         	0x01

#define	DFWADDR         		0x95

#define	DFRADDR         		0x97

#define	DFDAT           		0x99

#define	SCBCNT          		0x9a
#define		SCBAUTO         	0x80
#define		SCBCNT_MASK     	0x1f

#define	QINFIFO         		0x9b

#define	QINCNT          		0x9c

#define	QOUTFIFO        		0x9d

#define	CRCCONTROL1     		0x9d
#define		CRCONSEEN       	0x80
#define		CRCVALCHKEN     	0x40
#define		CRCENDCHKEN     	0x20
#define		CRCREQCHKEN     	0x10
#define		TARGCRCENDEN    	0x08
#define		TARGCRCCNTEN    	0x04

#define	QOUTCNT         		0x9e

#define	SCSIPHASE       		0x9e
#define		STATUS_PHASE    	0x20
#define		COMMAND_PHASE   	0x10
#define		MSG_IN_PHASE    	0x08
#define		MSG_OUT_PHASE   	0x04
#define		DATA_PHASE_MASK 	0x03
#define		DATA_IN_PHASE   	0x02
#define		DATA_OUT_PHASE  	0x01

#define	SFUNCT          		0x9f
#define		ALT_MODE        	0x80

#define	SCB_CDB_PTR     		0xa0
#define	SCB_TARGET_INFO 		0xa0
#define	SCB_RESIDUAL_DATACNT		0xa0
#define	SCB_CDB_STORE   		0xa0

#define	SCB_BASE        		0xa0

#define	SCB_RESIDUAL_SGPTR		0xa4

#define	SCB_SCSI_STATUS 		0xa8

#define	SCB_CDB_STORE_PAD		0xa9

#define	SCB_DATAPTR     		0xac

#define	SCB_DATACNT     		0xb0
#define		SG_LAST_SEG     	0x80
#define		SG_HIGH_ADDR_BITS	0x7f

#define	SCB_SGPTR       		0xb4
#define		SG_RESID_VALID  	0x04
#define		SG_FULL_RESID   	0x02
#define		SG_LIST_NULL    	0x01

#define	SCB_CONTROL     		0xb8
#define		TARGET_SCB      	0x80
#define		DISCENB         	0x40
#define		TAG_ENB         	0x20
#define		MK_MESSAGE      	0x10
#define		ULTRAENB        	0x08
#define		DISCONNECTED    	0x04
#define		SCB_TAG_TYPE    	0x03

#define	SCB_SCSIID      		0xb9
#define		TID             	0xf0
#define		TWIN_CHNLB      	0x80
#define		TWIN_TID        	0x70
#define		OID             	0x0f

#define	SCB_LUN         		0xba
#define		LID             	0xff

#define	SCB_TAG         		0xbb

#define	SCB_CDB_LEN     		0xbc

#define	SCB_SCSIRATE    		0xbd

#define	SCB_SCSIOFFSET  		0xbe

#define	SCB_NEXT        		0xbf

#define	SEECTL_2840     		0xc0
#define		CS_2840         	0x04
#define		CK_2840         	0x02
#define		DO_2840         	0x01

#define	SCB_64_SPARE    		0xc0

#define	STATUS_2840     		0xc1
#define		EEPROM_TF       	0x80
#define		BIOS_SEL        	0x60
#define		ADSEL           	0x1e
#define		DI_2840         	0x01

#define	SCB_64_BTT      		0xd0

#define	CCHADDR         		0xe0

#define	CCHCNT          		0xe8

#define	CCSGRAM         		0xe9

#define	CCSGADDR        		0xea

#define	CCSGCTL         		0xeb
#define		CCSGDONE        	0x80
#define		CCSGEN          	0x08
#define		SG_FETCH_NEEDED 	0x02
#define		CCSGRESET       	0x01

#define	CCSCBRAM        		0xec

#define	CCSCBADDR       		0xed

#define	CCSCBCTL        		0xee
#define		CCSCBDONE       	0x80
#define		ARRDONE         	0x40
#define		CCARREN         	0x10
#define		CCSCBEN         	0x08
#define		CCSCBDIR        	0x04
#define		CCSCBRESET      	0x01

#define	CCSCBCNT        		0xef

#define	SCBBADDR        		0xf0

#define	CCSCBPTR        		0xf1

#define	HNSCB_QOFF      		0xf4

#define	SNSCB_QOFF      		0xf6

#define	SDSCB_QOFF      		0xf8

#define	QOFF_CTLSTA     		0xfa
#define		SCB_AVAIL       	0x40
#define		SNSCB_ROLLOVER  	0x20
#define		SDSCB_ROLLOVER  	0x10
#define		SCB_QSIZE       	0x07
#define		SCB_QSIZE_256   	0x06

#define	DFF_THRSH       		0xfb
#define		WR_DFTHRSH      	0x70
#define		WR_DFTHRSH_MAX  	0x70
#define		WR_DFTHRSH_90   	0x60
#define		WR_DFTHRSH_85   	0x50
#define		WR_DFTHRSH_75   	0x40
#define		WR_DFTHRSH_63   	0x30
#define		WR_DFTHRSH_50   	0x20
#define		WR_DFTHRSH_25   	0x10
#define		RD_DFTHRSH_MAX  	0x07
#define		RD_DFTHRSH      	0x07
#define		RD_DFTHRSH_90   	0x06
#define		RD_DFTHRSH_85   	0x05
#define		RD_DFTHRSH_75   	0x04
#define		RD_DFTHRSH_63   	0x03
#define		RD_DFTHRSH_50   	0x02
#define		RD_DFTHRSH_25   	0x01
#define		RD_DFTHRSH_MIN  	0x00
#define		WR_DFTHRSH_MIN  	0x00

#define	SG_CACHE_SHADOW 		0xfc
#define		SG_ADDR_MASK    	0xf8
#define		ODD_SEG         	0x04
#define		LAST_SEG        	0x02
#define		LAST_SEG_DONE   	0x01

#define	SG_CACHE_PRE    		0xfc


#define	HOST_MSG	0xff
#define	BUS_32_BIT	0x02
#define	CMD_GROUP_CODE_SHIFT	0x05
#define	BUS_8_BIT	0x00
#define	CCSGRAM_MAXSEGS	0x10
#define	TARGET_DATA_IN	0x01
#define	STATUS_QUEUE_FULL	0x28
#define	STATUS_BUSY	0x08
#define	MAX_OFFSET_8BIT	0x0f
#define	BUS_16_BIT	0x01
#define	TID_SHIFT	0x04
#define	SCB_DOWNLOAD_SIZE_64	0x30
#define	SCB_UPLOAD_SIZE	0x20
#define	HOST_MAILBOX_SHIFT	0x04
#define	SCB_INITIATOR_TAG	0x03
#define	SCB_TARGET_STATUS	0x02
#define	SCB_TARGET_DATA_DIR	0x01
#define	SCB_TARGET_PHASES	0x00
#define	MAX_OFFSET_ULTRA2	0x7f
#define	MAX_OFFSET_16BIT	0x08
#define	TARGET_CMD_CMPLT	0xfe
#define	SCB_LIST_NULL	0xff
#define	SG_SIZEOF	0x08
#define	SCB_DOWNLOAD_SIZE	0x20
#define	SEQ_MAILBOX_SHIFT	0x00
#define	CCSGADDR_MAX	0x80


/* Downloaded Constant Definitions */
#define	SG_PREFETCH_ADDR_MASK	0x06
#define	SG_PREFETCH_ALIGN_MASK	0x05
#define	QOUTFIFO_OFFSET	0x00
#define	SG_PREFETCH_CNT	0x04
#define	INVERTED_CACHESIZE_MASK	0x03
#define	CACHESIZE_MASK	0x02
#define	QINFIFO_OFFSET	0x01
#define	DOWNLOAD_CONST_COUNT	0x07


/* Exported Labels */
@


1.13
log
@Sync ('make microcode') with change to aicasm_symbol.c:

Fix use of uninitialized variable by porting NetBSD patch to correctly
initialize it.

Said variable is used as the value of the define DOWNLOAD_CONST_COUNT
in the generated file aic7xxxreg.h.

This define is currently not used anywhere.

Spotted and ok mickey@@.
@
text
@d1 1
a1 1
/* $OpenBSD: aic7xxx.reg,v 1.6 2002/06/30 18:25:58 smurph Exp $ */
d6 2
a7 2
 * $Id: aic7xxx.seq,v 1.13 2002/07/05 05:41:03 smurph Exp $
 * $Id: aic7xxx.reg,v 1.6 2002/06/30 18:25:58 smurph Exp $
@


1.12
log
@attempt to make ahc smaller.  change PCI interrupt handler.
@
text
@d6 1
a6 1
 * $Id: aic7xxx.seq,v 1.12 2002/06/30 18:25:58 smurph Exp $
d718 1
a718 1
#define	DOWNLOAD_CONST_COUNT	0xb003
@


1.11
log
@aicasm generated file.
@
text
@@


1.10
log
@Return of new ahc
@
text
@d1 1
a1 1
/* $OpenBSD: src/sys/dev/microcode/aic7xxx/aic7xxx.reg,v $ */
d4 1
a4 1
 *               from the following source files:
d6 2
a7 2
 * $Id: src/sys/dev/microcode/aic7xxx/aic7xxx.seq#32 $
 * $Id: src/sys/dev/microcode/aic7xxx/aic7xxx.reg#19 $
a227 2
#define	SRAM_BASE       		0x20

d394 2
d718 4
@


1.9
log
@revert to older ahc driver until the new one's bugs are fixed
@
text
@d1 1
d3 5
a7 1
 * DO NOT EDIT - This file is automatically generated.
d31 9
a49 7
#define	SCSISIGI        		0x03
#define		ATNI            	0x10
#define		SELI            	0x08
#define		BSYI            	0x04
#define		REQI            	0x02
#define		ACKI            	0x01

d55 1
a56 1
#define		SXFR_ULTRA2     	0x0f
a65 2
#define	STCNT           		0x08

d77 2
d85 1
d121 1
d124 4
a133 1
#define		OID             	0x0f
d199 1
a200 1
#define		BRDDAT3         	0x08
d203 1
a204 1
#define		BRDCTL1         	0x02
d223 1
d230 1
a231 1
#define	CMDSIZE_TABLE   		0x20
d234 1
d238 3
a240 1
#define	MSG_OUT         		0x34
d242 5
a246 1
#define	DMAPARAMS       		0x35
d252 1
a253 1
#define		HDMAENACK       	0x08
d258 1
a258 1
#define	SEQ_FLAGS       		0x36
d260 1
a260 1
#define		SCBPTR_VALID    	0x40
d268 1
a268 1
#define	SAVED_TCL       		0x37
d270 1
a270 1
#define	SG_COUNT        		0x38
d272 2
a273 3
#define	SG_NEXT         		0x39

#define	LASTPHASE       		0x3d
a274 1
#define		PHASE_MASK      	0xe0
d285 1
a285 1
#define	WAITING_SCBH    		0x3e
d287 1
a287 1
#define	DISCONNECTED_SCBH		0x3f
d289 1
a289 1
#define	FREE_SCBH       		0x40
d291 1
a291 1
#define	HSCB_ADDR       		0x41
d293 1
a293 1
#define	SCBID_ADDR      		0x45
d295 1
a295 1
#define	TMODE_CMDADDR   		0x49
d297 1
a297 1
#define	KERNEL_QINPOS   		0x4d
d299 1
a299 1
#define	QINPOS          		0x4e
d301 1
a301 1
#define	QOUTPOS         		0x4f
d303 1
a303 1
#define	KERNEL_TQINPOS  		0x50
d305 1
a305 1
#define	TQINPOS         		0x51
d307 2
a308 2
#define	ARG_1           		0x52
#define	RETURN_1        		0x52
d317 2
a318 6
#define	ARG_2           		0x53
#define	RETURN_2        		0x53

#define	LAST_MSG        		0x54

#define	PREFETCH_CNT    		0x55
d320 1
a320 1
#define	TARGET_MSG_REQUEST		0x56
d322 1
a322 1
#define	SCSISEQ_TEMPLATE		0x58
d330 6
a335 1
#define	DATA_COUNT_ODD  		0x59
d344 3
a346 1
#define	INITIATOR_TAG   		0x5a
d380 2
a383 2
#define	NONE            		0x6a

d416 5
d423 1
d442 1
a443 1
#define		CHIPRSTACK      	0x01
d453 7
a459 7
#define		DATA_OVERRUN    	0xf1
#define		MSGIN_PHASEMIS  	0xe1
#define		TRACEPOINT      	0xd1
#define		PERR_DETECTED   	0xb1
#define		HOST_MSG_LOOP   	0xa1
#define		TRACE_POINT     	0x91
#define		RESIDUAL        	0x81
d461 3
a463 1
#define		UPDATE_TMSG_REQ 	0x61
d471 1
a472 8
#define		SEQINT          	0x01

#define	CLRINT          		0x92
#define		CLRPARERR       	0x10
#define		CLRBRKADRINT    	0x08
#define		CLRSCSIINT      	0x04
#define		CLRCMDINT       	0x02
#define		CLRSEQINT       	0x01
d484 7
d495 2
a496 1
#define		DWORDEMP        	0x20
d534 1
d541 4
a544 8
#define	SCB_CONTROL     		0xa0
#define		TARGET_SCB      	0x80
#define		DISCENB         	0x40
#define		TAG_ENB         	0x20
#define		MK_MESSAGE      	0x10
#define		ULTRAENB        	0x08
#define		DISCONNECTED    	0x04
#define		SCB_TAG_TYPE    	0x03
d548 1
a548 6
#define	SCB_TCL         		0xa1
#define		TID             	0xf0
#define		SELBUSB         	0x08
#define		LID             	0x07

#define	SCB_TARGET_STATUS		0xa2
d550 1
a550 1
#define	SCB_SGCOUNT     		0xa3
d552 1
a552 5
#define	SCB_SGPTR       		0xa4

#define	SCB_RESID_SGCNT 		0xa8

#define	SCB_RESID_DCNT  		0xa9
d557 7
d565 8
a572 3
#define	SCB_CMDPTR      		0xb4
#define	SCB_TARGET_PHASES		0xb4
#define		TARGET_DATA_IN  	0x01
d574 5
a578 2
#define	SCB_CMDLEN      		0xb8
#define	SCB_INITIATOR_TAG		0xb8
d580 2
a581 1
#define	SCB_TAG         		0xb9
d583 1
a583 1
#define	SCB_NEXT        		0xba
d585 1
a585 1
#define	SCB_SCSIRATE    		0xbb
d587 1
a587 1
#define	SCB_SCSIOFFSET  		0xbc
d589 1
a589 1
#define	SCB_SPARE       		0xbd
d591 1
a591 1
#define	SCB_CMDSTORE    		0xc0
d598 2
d606 1
a606 3
#define	SCB_CMDSTORE_BUSADDR		0xd0

#define	SCB_64BYTE_SPARE		0xd4
d619 1
a619 1
#define		FLAG            	0x02
d673 3
a675 2
#define	SG_CACHEPTR     		0xfc
#define		SG_USER_DATA    	0xfc
d679 2
d682 2
a685 1
#define	QOUTFIFO_OFFSET	0x00
d687 1
a687 1
#define	SCB_64BYTE_SIZE	0x30
a689 2
#define	TQINFIFO_UPDATE_CNT	0x20
#define	TCL_TARGET_SHIFT	0x04
d692 3
a694 2
#define	QINFIFO_OFFSET	0x01
#define	SCB_32BYTE_SIZE	0x1c
d696 4
a701 1
#define	UNTAGGEDSCB_OFFSET	0x02
d705 1
a706 2
#define	HOST_MSG	0xff
#define	BUS_32_BIT	0x02
d711 7
@


1.8
log
@New port of FreeBSD's ahc driver
@
text
@a0 1
/* $OpenBSD: src/sys/dev/microcode/aic7xxx/aic7xxx.reg,v $ */
d2 1
a2 5
 * DO NOT EDIT - This file is automatically generated
 *               from the following source files:
 *
 * $Id: src/sys/dev/microcode/aic7xxx/aic7xxx.seq#32 $
 * $Id: src/sys/dev/microcode/aic7xxx/aic7xxx.reg#19 $
a25 9
#define	SCSISIGI        		0x03
#define		P_DATAIN_DT     	0x60
#define		P_DATAOUT_DT    	0x20
#define		ATNI            	0x10
#define		SELI            	0x08
#define		BSYI            	0x04
#define		REQI            	0x02
#define		ACKI            	0x01

d36 7
d48 1
a49 1
#define		SOFS            	0x0f
d59 2
a71 2
#define	STCNT           		0x08

a77 1
#define		CLRIOERR        	0x08
a112 1
#define		SHVALID         	0x40
a114 4
#define		CRCVALERR       	0x08
#define		CRCENDERR       	0x04
#define		CRCREQERR       	0x02
#define		DUAL_EDGE_ERR   	0x01
d121 1
d187 1
a188 1
#define		BRDCS           	0x08
d191 1
a192 1
#define		BRDRW_ULTRA2    	0x02
a210 1
#define		SELBUSB         	0x08
a216 1
#define	BUSY_TARGETS    		0x20
d218 1
a220 1
#define	CMDSIZE_TABLE   		0x30
d224 1
a224 3
#define	CMDSIZE_TABLE_TAIL		0x34

#define	MWI_RESIDUAL    		0x38
d226 1
a226 5
#define	NEXT_QUEUED_SCB 		0x39

#define	MSG_OUT         		0x3a

#define	DMAPARAMS       		0x3b
d232 1
a233 1
#define		HDMAEN          	0x08
d238 1
a238 1
#define	SEQ_FLAGS       		0x3c
d240 1
a240 1
#define		TARGET_CMD_IS_TAGGED	0x40
d248 3
a250 1
#define	SAVED_SCSIID    		0x3d
d252 1
a252 1
#define	SAVED_LUN       		0x3e
d254 2
a255 1
#define	LASTPHASE       		0x3f
a256 1
#define		P_MESGIN        	0xe0
d267 1
a267 1
#define	WAITING_SCBH    		0x40
d269 1
a269 1
#define	DISCONNECTED_SCBH		0x41
d271 1
a271 1
#define	FREE_SCBH       		0x42
d273 1
a273 1
#define	COMPLETE_SCBH   		0x43
d275 1
a275 1
#define	HSCB_ADDR       		0x44
d277 1
a277 1
#define	SHARED_DATA_ADDR		0x48
d279 1
a279 1
#define	KERNEL_QINPOS   		0x4c
d281 1
a281 1
#define	QINPOS          		0x4d
d283 1
a283 1
#define	QOUTPOS         		0x4e
d285 1
a285 1
#define	KERNEL_TQINPOS  		0x4f
d287 1
a287 1
#define	TQINPOS         		0x50
d289 2
a290 2
#define	ARG_1           		0x51
#define	RETURN_1        		0x51
d299 6
a304 2
#define	ARG_2           		0x52
#define	RETURN_2        		0x52
d306 1
a306 1
#define	LAST_MSG        		0x53
d308 1
a308 1
#define	SCSISEQ_TEMPLATE		0x54
d316 1
a316 6
#define	DATA_COUNT_ODD  		0x55

#define	INITIATOR_TAG   		0x56

#define	SEQ_FLAGS2      		0x57
#define		SCB_DMA         	0x01
d325 1
a325 3
#define	INTDEF          		0x5c
#define		EDGE_TRIG       	0x80
#define		VECTOR          	0x0f
d359 2
a362 2
#define	ALLZEROS        		0x6a

a394 5
#define	DSCOMMAND1      		0x85
#define		DSLATT          	0xfc
#define		HADDLDSEL1      	0x02
#define		HADDLDSEL0      	0x01

a396 1
#define		DFTHRSH_75      	0x80
d415 1
a416 1
#define		CHIPRST         	0x01
d426 7
a432 7
#define		OUT_OF_RANGE    	0xe1
#define		NO_FREE_SCB     	0xd1
#define		SCB_MISMATCH    	0xc1
#define		MISSED_BUSFREE  	0xb1
#define		MKMSG_FAILED    	0xa1
#define		DATA_OVERRUN    	0x91
#define		PERR_DETECTED   	0x81
d434 1
a434 3
#define		HOST_MSG_LOOP   	0x61
#define		PDATA_REINIT    	0x51
#define		IGN_WIDE_RES    	0x41
d442 1
d444 7
a450 1
#define		BAD_PHASE       	0x01
a461 7
#define	CLRINT          		0x92
#define		CLRPARERR       	0x10
#define		CLRBRKADRINT    	0x08
#define		CLRSCSIINT      	0x04
#define		CLRCMDINT       	0x02
#define		CLRSEQINT       	0x01

d466 1
a466 2
#define		DFCACHETH       	0x40
#define		FIFOQWDEMP      	0x20
a503 1
#define		DATA_PHASE_MASK 	0x03
d510 8
a517 4
#define	SCB_CDB_PTR     		0xa0
#define	SCB_TARGET_INFO 		0xa0
#define	SCB_RESIDUAL_DATACNT		0xa0
#define	SCB_CDB_STORE   		0xa0
d521 6
a526 1
#define	SCB_RESIDUAL_SGPTR		0xa4
d528 1
a528 1
#define	SCB_SCSI_STATUS 		0xa8
d530 5
a534 1
#define	SCB_CDB_STORE_PAD		0xa9
a538 7
#define		SG_LAST_SEG     	0x80
#define		SG_HIGH_ADDR_BITS	0x7f

#define	SCB_SGPTR       		0xb4
#define		SG_RESID_VALID  	0x04
#define		SG_FULL_RESID   	0x02
#define		SG_LIST_NULL    	0x01
d540 3
a542 8
#define	SCB_CONTROL     		0xb8
#define		TARGET_SCB      	0x80
#define		DISCENB         	0x40
#define		TAG_ENB         	0x20
#define		MK_MESSAGE      	0x10
#define		ULTRAENB        	0x08
#define		DISCONNECTED    	0x04
#define		SCB_TAG_TYPE    	0x03
d544 2
a545 5
#define	SCB_SCSIID      		0xb9
#define		TID             	0xf0
#define		TWIN_CHNLB      	0x80
#define		TWIN_TID        	0x70
#define		OID             	0x0f
d547 1
a547 2
#define	SCB_LUN         		0xba
#define		LID             	0xff
d549 1
a549 1
#define	SCB_TAG         		0xbb
d551 1
a551 1
#define	SCB_CDB_LEN     		0xbc
d553 1
a553 1
#define	SCB_SCSIRATE    		0xbd
d555 1
a555 1
#define	SCB_SCSIOFFSET  		0xbe
d557 1
a557 1
#define	SCB_NEXT        		0xbf
a563 2
#define	SCB_64_SPARE    		0xc0

d570 3
a572 1
#define	SCB_64_BTT      		0xd0
d585 1
a585 1
#define		SG_FETCH_NEEDED 	0x02
d639 2
a640 3
#define	SG_CACHE_SHADOW 		0xfc
#define		SG_ADDR_MASK    	0xf8
#define		ODD_SEG         	0x04
a643 2
#define	SG_CACHE_PRE    		0xfc

a644 2
#define	HOST_MSG	0xff
#define	BUS_32_BIT	0x02
d647 1
d649 1
a649 1
#define	TARGET_DATA_IN	0x01
d652 2
d656 2
a657 3
#define	TID_SHIFT	0x04
#define	SCB_DOWNLOAD_SIZE_64	0x30
#define	SCB_UPLOAD_SIZE	0x20
a658 4
#define	SCB_INITIATOR_TAG	0x03
#define	SCB_TARGET_STATUS	0x02
#define	SCB_TARGET_DATA_DIR	0x01
#define	SCB_TARGET_PHASES	0x00
d661 1
a664 1
#define	SCB_DOWNLOAD_SIZE	0x20
d666 2
a671 7
#define	SG_PREFETCH_ADDR_MASK	0x06
#define	SG_PREFETCH_ALIGN_MASK	0x05
#define	QOUTFIFO_OFFSET	0x00
#define	SG_PREFETCH_CNT	0x04
#define	INVERTED_CACHESIZE_MASK	0x03
#define	CACHESIZE_MASK	0x02
#define	QINFIFO_OFFSET	0x01
@


1.7
log
@Import tagging code and try to resolve locking problem.
@
text
@d1 1
d3 5
a7 1
 * DO NOT EDIT - This file is automatically generated.
d31 9
a49 7
#define	SCSISIGI        		0x03
#define		ATNI            	0x10
#define		SELI            	0x08
#define		BSYI            	0x04
#define		REQI            	0x02
#define		ACKI            	0x01

d55 1
a56 1
#define		SXFR_ULTRA2     	0x0f
a65 2
#define	STCNT           		0x08

d77 2
d85 1
d121 1
d124 4
a133 1
#define		OID             	0x0f
d199 1
a200 1
#define		BRDDAT3         	0x08
d203 1
a204 1
#define		BRDCTL1         	0x02
d223 1
d230 1
a231 1
#define	CMDSIZE_TABLE   		0x20
d234 1
d238 3
a240 1
#define	MSG_OUT         		0x34
d242 5
a246 1
#define	DMAPARAMS       		0x35
d252 1
a253 1
#define		HDMAENACK       	0x08
d258 1
a258 1
#define	SEQ_FLAGS       		0x36
d260 1
a260 1
#define		SCBPTR_VALID    	0x40
d268 1
a268 1
#define	SAVED_TCL       		0x37
d270 1
a270 1
#define	SG_COUNT        		0x38
d272 2
a273 3
#define	SG_NEXT         		0x39

#define	LASTPHASE       		0x3d
a274 1
#define		PHASE_MASK      	0xe0
d285 1
a285 1
#define	WAITING_SCBH    		0x3e
d287 1
a287 1
#define	DISCONNECTED_SCBH		0x3f
d289 1
a289 1
#define	FREE_SCBH       		0x40
d291 1
a291 1
#define	HSCB_ADDR       		0x41
d293 1
a293 1
#define	SCBID_ADDR      		0x45
d295 1
a295 1
#define	TMODE_CMDADDR   		0x49
d297 1
a297 1
#define	KERNEL_QINPOS   		0x4d
d299 1
a299 1
#define	QINPOS          		0x4e
d301 1
a301 1
#define	QOUTPOS         		0x4f
d303 1
a303 1
#define	KERNEL_TQINPOS  		0x50
d305 1
a305 1
#define	TQINPOS         		0x51
d307 2
a308 2
#define	ARG_1           		0x52
#define	RETURN_1        		0x52
d317 2
a318 6
#define	ARG_2           		0x53
#define	RETURN_2        		0x53

#define	LAST_MSG        		0x54

#define	PREFETCH_CNT    		0x55
d320 1
a320 1
#define	TARGET_MSG_REQUEST		0x56
d322 1
a322 1
#define	SCSISEQ_TEMPLATE		0x58
d330 6
a335 1
#define	DATA_COUNT_ODD  		0x59
d344 3
a346 1
#define	INITIATOR_TAG   		0x5a
d380 2
a383 2
#define	NONE            		0x6a

d416 5
d423 1
d442 1
a443 1
#define		CHIPRSTACK      	0x01
d453 7
a459 7
#define		DATA_OVERRUN    	0xf1
#define		MSGIN_PHASEMIS  	0xe1
#define		TRACEPOINT      	0xd1
#define		PERR_DETECTED   	0xb1
#define		HOST_MSG_LOOP   	0xa1
#define		TRACE_POINT     	0x91
#define		RESIDUAL        	0x81
d461 3
a463 1
#define		UPDATE_TMSG_REQ 	0x61
d471 1
a472 8
#define		SEQINT          	0x01

#define	CLRINT          		0x92
#define		CLRPARERR       	0x10
#define		CLRBRKADRINT    	0x08
#define		CLRSCSIINT      	0x04
#define		CLRCMDINT       	0x02
#define		CLRSEQINT       	0x01
d484 7
d495 2
a496 1
#define		DWORDEMP        	0x20
d534 1
d541 4
a544 8
#define	SCB_CONTROL     		0xa0
#define		TARGET_SCB      	0x80
#define		DISCENB         	0x40
#define		TAG_ENB         	0x20
#define		MK_MESSAGE      	0x10
#define		ULTRAENB        	0x08
#define		DISCONNECTED    	0x04
#define		SCB_TAG_TYPE    	0x03
d548 1
a548 6
#define	SCB_TCL         		0xa1
#define		TID             	0xf0
#define		SELBUSB         	0x08
#define		LID             	0x07

#define	SCB_TARGET_STATUS		0xa2
d550 1
a550 1
#define	SCB_SGCOUNT     		0xa3
d552 1
a552 5
#define	SCB_SGPTR       		0xa4

#define	SCB_RESID_SGCNT 		0xa8

#define	SCB_RESID_DCNT  		0xa9
d557 7
d565 8
a572 3
#define	SCB_CMDPTR      		0xb4
#define	SCB_TARGET_PHASES		0xb4
#define		TARGET_DATA_IN  	0x01
d574 5
a578 2
#define	SCB_CMDLEN      		0xb8
#define	SCB_INITIATOR_TAG		0xb8
d580 2
a581 1
#define	SCB_TAG         		0xb9
d583 1
a583 1
#define	SCB_NEXT        		0xba
d585 1
a585 1
#define	SCB_SCSIRATE    		0xbb
d587 1
a587 1
#define	SCB_SCSIOFFSET  		0xbc
d589 1
a589 1
#define	SCB_SPARE       		0xbd
d591 1
a591 1
#define	SCB_CMDSTORE    		0xc0
d598 2
d606 1
a606 3
#define	SCB_CMDSTORE_BUSADDR		0xd0

#define	SCB_64BYTE_SPARE		0xd4
d619 1
a619 1
#define		FLAG            	0x02
d673 3
a675 2
#define	SG_CACHEPTR     		0xfc
#define		SG_USER_DATA    	0xfc
d679 2
d682 2
a685 1
#define	QOUTFIFO_OFFSET	0x00
d687 1
a687 1
#define	SCB_64BYTE_SIZE	0x30
a689 2
#define	TQINFIFO_UPDATE_CNT	0x20
#define	TCL_TARGET_SHIFT	0x04
d692 3
a694 2
#define	QINFIFO_OFFSET	0x01
#define	SCB_32BYTE_SIZE	0x1c
d696 4
a701 1
#define	UNTAGGEDSCB_OFFSET	0x02
d705 1
a706 2
#define	HOST_MSG	0xff
#define	BUS_32_BIT	0x02
d711 7
@


1.7.10.1
log
@sync to -current
@
text
@a0 1
/* $OpenBSD$ */
d2 1
a2 5
 * DO NOT EDIT - This file is automatically generated
 *		 from the following source files:
 *
 * $Id$
 * $Id$
a25 9
#define	SCSISIGI        		0x03
#define		P_DATAIN_DT     	0x60
#define		P_DATAOUT_DT    	0x20
#define		ATNI            	0x10
#define		SELI            	0x08
#define		BSYI            	0x04
#define		REQI            	0x02
#define		ACKI            	0x01

d36 7
d48 1
a49 1
#define		SOFS            	0x0f
d59 2
a71 2
#define	STCNT           		0x08

a77 1
#define		CLRIOERR        	0x08
a112 1
#define		SHVALID         	0x40
a114 4
#define		CRCVALERR       	0x08
#define		CRCENDERR       	0x04
#define		CRCREQERR       	0x02
#define		DUAL_EDGE_ERR   	0x01
d121 1
d187 1
a188 1
#define		BRDCS           	0x08
d191 1
a192 1
#define		BRDRW_ULTRA2    	0x02
a210 1
#define		SELBUSB         	0x08
d215 2
a216 1
#define	BUSY_TARGETS    		0x20
d218 1
a220 1
#define	CMDSIZE_TABLE   		0x30
d224 1
a224 3
#define	CMDSIZE_TABLE_TAIL		0x34

#define	MWI_RESIDUAL    		0x38
d226 1
a226 5
#define	NEXT_QUEUED_SCB 		0x39

#define	MSG_OUT         		0x3a

#define	DMAPARAMS       		0x3b
d232 1
a233 1
#define		HDMAEN          	0x08
d238 1
a238 1
#define	SEQ_FLAGS       		0x3c
d240 1
a240 1
#define		TARGET_CMD_IS_TAGGED	0x40
d248 3
a250 1
#define	SAVED_SCSIID    		0x3d
d252 1
a252 1
#define	SAVED_LUN       		0x3e
d254 2
a255 1
#define	LASTPHASE       		0x3f
a256 1
#define		P_MESGIN        	0xe0
d267 1
a267 1
#define	WAITING_SCBH    		0x40
d269 1
a269 1
#define	DISCONNECTED_SCBH		0x41
d271 1
a271 1
#define	FREE_SCBH       		0x42
d273 1
a273 1
#define	COMPLETE_SCBH   		0x43
d275 1
a275 1
#define	HSCB_ADDR       		0x44
d277 1
a277 1
#define	SHARED_DATA_ADDR		0x48
d279 1
a279 1
#define	KERNEL_QINPOS   		0x4c
d281 1
a281 1
#define	QINPOS          		0x4d
d283 1
a283 1
#define	QOUTPOS         		0x4e
d285 1
a285 1
#define	KERNEL_TQINPOS  		0x4f
d287 1
a287 1
#define	TQINPOS         		0x50
d289 2
a290 2
#define	ARG_1           		0x51
#define	RETURN_1        		0x51
d299 6
a304 2
#define	ARG_2           		0x52
#define	RETURN_2        		0x52
d306 1
a306 1
#define	LAST_MSG        		0x53
d308 1
a308 1
#define	SCSISEQ_TEMPLATE		0x54
d316 1
a316 6
#define	DATA_COUNT_ODD  		0x55

#define	INITIATOR_TAG   		0x56

#define	SEQ_FLAGS2      		0x57
#define		SCB_DMA         	0x01
d325 1
a325 3
#define	INTDEF          		0x5c
#define		EDGE_TRIG       	0x80
#define		VECTOR          	0x0f
d359 2
a362 2
#define	ALLZEROS        		0x6a

a374 2
#define	SRAM_BASE       		0x70

a394 5
#define	DSCOMMAND1      		0x85
#define		DSLATT          	0xfc
#define		HADDLDSEL1      	0x02
#define		HADDLDSEL0      	0x01

a396 1
#define		DFTHRSH_75      	0x80
d415 1
a416 1
#define		CHIPRST         	0x01
d426 7
a432 7
#define		OUT_OF_RANGE    	0xe1
#define		NO_FREE_SCB     	0xd1
#define		SCB_MISMATCH    	0xc1
#define		MISSED_BUSFREE  	0xb1
#define		MKMSG_FAILED    	0xa1
#define		DATA_OVERRUN    	0x91
#define		PERR_DETECTED   	0x81
d434 1
a434 3
#define		HOST_MSG_LOOP   	0x61
#define		PDATA_REINIT    	0x51
#define		IGN_WIDE_RES    	0x41
d442 1
d444 7
a450 1
#define		BAD_PHASE       	0x01
a461 7
#define	CLRINT          		0x92
#define		CLRPARERR       	0x10
#define		CLRBRKADRINT    	0x08
#define		CLRSCSIINT      	0x04
#define		CLRCMDINT       	0x02
#define		CLRSEQINT       	0x01

d466 1
a466 2
#define		DFCACHETH       	0x40
#define		FIFOQWDEMP      	0x20
a503 1
#define		DATA_PHASE_MASK 	0x03
d510 8
a517 4
#define	SCB_CDB_PTR     		0xa0
#define	SCB_TARGET_INFO 		0xa0
#define	SCB_RESIDUAL_DATACNT		0xa0
#define	SCB_CDB_STORE   		0xa0
d521 8
a528 1
#define	SCB_RESIDUAL_SGPTR		0xa4
d530 1
a530 1
#define	SCB_SCSI_STATUS 		0xa8
d532 3
a534 1
#define	SCB_CDB_STORE_PAD		0xa9
a538 7
#define		SG_LAST_SEG     	0x80
#define		SG_HIGH_ADDR_BITS	0x7f

#define	SCB_SGPTR       		0xb4
#define		SG_RESID_VALID  	0x04
#define		SG_FULL_RESID   	0x02
#define		SG_LIST_NULL    	0x01
d540 3
a542 8
#define	SCB_CONTROL     		0xb8
#define		TARGET_SCB      	0x80
#define		DISCENB         	0x40
#define		TAG_ENB         	0x20
#define		MK_MESSAGE      	0x10
#define		ULTRAENB        	0x08
#define		DISCONNECTED    	0x04
#define		SCB_TAG_TYPE    	0x03
d544 2
a545 5
#define	SCB_SCSIID      		0xb9
#define		TID             	0xf0
#define		TWIN_CHNLB      	0x80
#define		TWIN_TID        	0x70
#define		OID             	0x0f
d547 1
a547 2
#define	SCB_LUN         		0xba
#define		LID             	0xff
d549 1
a549 1
#define	SCB_TAG         		0xbb
d551 1
a551 1
#define	SCB_CDB_LEN     		0xbc
d553 1
a553 1
#define	SCB_SCSIRATE    		0xbd
d555 1
a555 1
#define	SCB_SCSIOFFSET  		0xbe
d557 1
a557 1
#define	SCB_NEXT        		0xbf
a563 2
#define	SCB_64_SPARE    		0xc0

d570 3
a572 1
#define	SCB_64_BTT      		0xd0
d585 1
a585 1
#define		SG_FETCH_NEEDED 	0x02
d639 2
a640 3
#define	SG_CACHE_SHADOW 		0xfc
#define		SG_ADDR_MASK    	0xf8
#define		ODD_SEG         	0x04
a643 2
#define	SG_CACHE_PRE    		0xfc

a644 2
#define	HOST_MSG	0xff
#define	BUS_32_BIT	0x02
d647 1
d649 1
a649 1
#define	TARGET_DATA_IN	0x01
d652 2
d656 2
a657 3
#define	TID_SHIFT	0x04
#define	SCB_DOWNLOAD_SIZE_64	0x30
#define	SCB_UPLOAD_SIZE	0x20
a658 4
#define	SCB_INITIATOR_TAG	0x03
#define	SCB_TARGET_STATUS	0x02
#define	SCB_TARGET_DATA_DIR	0x01
#define	SCB_TARGET_PHASES	0x00
d661 1
a664 1
#define	SCB_DOWNLOAD_SIZE	0x20
d666 2
a671 11
#define	SG_PREFETCH_ADDR_MASK	0x06
#define	SG_PREFETCH_ALIGN_MASK	0x05
#define	QOUTFIFO_OFFSET	0x00
#define	SG_PREFETCH_CNT	0x04
#define	INVERTED_CACHESIZE_MASK	0x03
#define	CACHESIZE_MASK	0x02
#define	QINFIFO_OFFSET	0x01
#define	DOWNLOAD_CONST_COUNT	0xb003


/* Exported Labels */
@


1.6
log
@new ahc driver.  Adds suport for newer Adaptec controllers.  This represents two months of work.
@
text
@d402 2
@


1.5
log
@queue handling hacks for chips like aic7860 which have small numbers of SCB's.
by gibbs@@freebsd.org
@
text
@a0 2
/*	$OpenBSD: aic7xxxreg.h,v 1.4 1996/11/28 23:27:45 niklas Exp $	*/
/*	$NetBSD: aic7xxxreg.h,v 1.4 1996/10/08 03:04:04 gibbs Exp $	*/
d2 1
a2 28
 * Aic7xxx register and scratch ram definitions.
 *
 * Copyright (c) 1994, 1995, 1996 Justin T. Gibbs.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice immediately at the beginning of the file, without modification,
 *    this list of conditions, and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. The name of the author may not be used to endorse or promote products
 *    derived from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE FOR
 * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
d5 662
a666 61
/*
 * This header is shared by the sequencer code and the kernel level driver.
 *
 * All page numbers refer to the Adaptec AIC-7770 Data Book available from
 * Adaptec's Technical Documents Department 1-800-934-2766
 */

/*
 * SCSI Sequence Control (p. 3-11).
 * Each bit, when set starts a specific SCSI sequence on the bus
 */
#define SCSISEQ			0x000
#define		TEMODEO		0x80
#define		ENSELO		0x40
#define		ENSELI		0x20
#define		ENRSELI		0x10
#define		ENAUTOATNO	0x08
#define		ENAUTOATNI	0x04
#define		ENAUTOATNP	0x02
#define		SCSIRSTO	0x01

/*
 * SCSI Transfer Control 0 Register (pp. 3-13).
 * Controls the SCSI module data path.
 */
#define	SXFRCTL0		0x001
#define		DFON		0x80
#define		DFPEXP		0x40
#define		ULTRAEN		0x20
#define		CLRSTCNT	0x10
#define		SPIOEN		0x08
#define		SCAMEN		0x04
#define		CLRCHN		0x02
/*  UNUSED			0x01 */

/*
 * SCSI Transfer Control 1 Register (pp. 3-14,15).
 * Controls the SCSI module data path.
 */
#define	SXFRCTL1		0x002
#define		BITBUCKET	0x80
#define		SWRAPEN		0x40
#define		ENSPCHK		0x20
#define		STIMESEL	0x18
#define		ENSTIMER	0x04
#define		ACTNEGEN	0x02
#define		STPWEN		0x01	/* Powered Termination */

/*
 * SCSI Control Signal Read Register (p. 3-15).
 * Reads the actual state of the SCSI bus pins
 */
#define SCSISIGI		0x003
#define		CDI		0x80
#define		IOI		0x40
#define		MSGI		0x20
#define		ATNI		0x10
#define		SELI		0x08
#define		BSYI		0x04
#define		REQI		0x02
#define		ACKI		0x01
a667 677
/*
 * Possible phases in SCSISIGI
 */
#define		PHASE_MASK	0xe0
#define		P_DATAOUT	0x00
#define		P_DATAIN	0x40
#define		P_COMMAND	0x80
#define		P_MESGOUT	0xa0
#define		P_STATUS	0xc0
#define		P_MESGIN	0xe0
/*
 * SCSI Control Signal Write Register (p. 3-16).
 * Writing to this register modifies the control signals on the bus.  Only
 * those signals that are allowed in the current mode (Initiator/Target) are
 * asserted.
 */
#define SCSISIGO		0x003
#define		CDO		0x80
#define		IOO		0x40
#define		MSGO		0x20
#define		ATNO		0x10
#define		SELO		0x08
#define		BSYO		0x04
#define		REQO		0x02
#define		ACKO		0x01

/* 
 * SCSI Rate Control (p. 3-17).
 * Contents of this register determine the Synchronous SCSI data transfer
 * rate and the maximum synchronous Req/Ack offset.  An offset of 0 in the
 * SOFS (3:0) bits disables synchronous data transfers.  Any offset value
 * greater than 0 enables synchronous transfers.
 */
#define SCSIRATE		0x004
#define		WIDEXFER	0x80		/* Wide transfer control */
#define		SXFR		0x70		/* Sync transfer rate */
#define		SOFS		0x0f		/* Sync offset */

/*
 * SCSI ID (p. 3-18).
 * Contains the ID of the board and the current target on the
 * selected channel.
 */
#define SCSIID			0x005
#define		TID		0xf0		/* Target ID mask */
#define		OID		0x0f		/* Our ID mask */

/*
 * SCSI Latched Data (p. 3-19).
 * Read/Write latches used to transfer data on the SCSI bus during
 * Automatic or Manual PIO mode.  SCSIDATH can be used for the
 * upper byte of a 16bit wide asynchronous data phase transfer.
 */
#define SCSIDATL		0x006
#define SCSIDATH		0x007

/*
 * SCSI Transfer Count (pp. 3-19,20)
 * These registers count down the number of bytes transferred
 * across the SCSI bus.  The counter is decremented only once
 * the data has been safely transferred.  SDONE in SSTAT0 is
 * set when STCNT goes to 0
 */ 
#define STCNT			0x008
#define STCNT0			0x008
#define STCNT1			0x009
#define STCNT2			0x00a

/*
 * Clear SCSI Interrupt 0 (p. 3-20)
 * Writing a 1 to a bit clears the associated SCSI Interrupt in SSTAT0.
 */
#define	CLRSINT0		0x00b
#define		CLRSELDO	0x40
#define		CLRSELDI	0x20
#define		CLRSELINGO	0x10
#define		CLRSWRAP	0x08
/*  UNUSED			0x04 */
#define		CLRSPIORDY	0x02
/*  UNUSED			0x01 */

/*
 * SCSI Status 0 (p. 3-21)
 * Contains one set of SCSI Interrupt codes
 * These are most likely of interest to the sequencer
 */
#define SSTAT0			0x00b
#define		TARGET		0x80		/* Board acting as target */
#define		SELDO		0x40		/* Selection Done */
#define		SELDI		0x20		/* Board has been selected */
#define		SELINGO		0x10		/* Selection In Progress */
#define		SWRAP		0x08		/* 24bit counter wrap */
#define		SDONE		0x04		/* STCNT = 0x000000 */
#define		SPIORDY		0x02		/* SCSI PIO Ready */
#define		DMADONE		0x01		/* DMA transfer completed */

/*
 * Clear SCSI Interrupt 1 (p. 3-23)
 * Writing a 1 to a bit clears the associated SCSI Interrupt in SSTAT1.
 */
#define CLRSINT1		0x00c
#define		CLRSELTIMEO	0x80
#define		CLRATNO		0x40
#define		CLRSCSIRSTI	0x20
/*  UNUSED			0x10 */
#define		CLRBUSFREE	0x08
#define		CLRSCSIPERR	0x04
#define		CLRPHASECHG	0x02
#define		CLRREQINIT	0x01

/*
 * SCSI Status 1 (p. 3-24)
 */
#define SSTAT1			0x00c
#define		SELTO		0x80
#define		ATNTARG 	0x40
#define		SCSIRSTI	0x20
#define		PHASEMIS	0x10
#define		BUSFREE		0x08
#define		SCSIPERR	0x04
#define		PHASECHG	0x02
#define		REQINIT		0x01

/*
 * SCSI Interrupt Mode 1 (pp. 3-28,29)
 * Setting any bit will enable the corresponding function
 * in SIMODE1 to interrupt via the IRQ pin.
 */
#define	SIMODE1			0x011
#define		ENSELTIMO	0x80
#define		ENATNTARG	0x40
#define		ENSCSIRST	0x20
#define		ENPHASEMIS	0x10
#define		ENBUSFREE	0x08
#define		ENSCSIPERR	0x04
#define		ENPHASECHG	0x02
#define		ENREQINIT	0x01

/*
 * SCSI Data Bus (High) (p. 3-29)
 * This register reads data on the SCSI Data bus directly.
 */
#define	SCSIBUSL		0x012
#define	SCSIBUSH		0x013

/*
 * SCSI/Host Address (p. 3-30)
 * These registers hold the host address for the byte about to be
 * transfered on the SCSI bus.  They are counted up in the same
 * manner as STCNT is counted down.  SHADDR should always be used
 * to determine the address of the last byte transfered since HADDR
 * can be skewed by write-ahead.
 */
#define	SHADDR			0x014
#define	SHADDR0			0x014
#define	SHADDR1			0x015
#define	SHADDR2			0x016
#define	SHADDR3			0x017

/*
 * Selection/Reselection ID (p. 3-31)
 * Upper four bits are the device id.  The ONEBIT is set when the re/selecting
 * device did not set its own ID.
 */
#define SELID			0x019
#define		SELID_MASK	0xf0
#define		ONEBIT		0x08
/*  UNUSED			0x07 */

/*
 * SCSI Block Control (p. 3-32)
 * Controls Bus type and channel selection.  In a twin channel configuration
 * addresses 0x00-0x1e are gated to the appropriate channel based on this
 * register.  SELWIDE allows for the coexistence of 8bit and 16bit devices
 * on a wide bus.
 */
#define SBLKCTL			0x01f
#define		DIAGLEDEN	0x80	/* Aic78X0 only */
#define		DIAGLEDON	0x40	/* Aic78X0 only */
#define		AUTOFLUSHDIS	0x20
/*  UNUSED			0x10 */
#define		SELBUS_MASK	0x0a
#define		SELBUSB		0x08
/*  UNUSED			0x04 */
#define		SELWIDE		0x02
/*  UNUSED			0x01 */
#define		SELNARROW	0x00

/*
 * Sequencer Control (p. 3-33)
 * Error detection mode and speed configuration
 */
#define SEQCTL			0x060
#define		PERRORDIS	0x80
#define		PAUSEDIS	0x40
#define		FAILDIS		0x20
#define 	FASTMODE	0x10
#define		BRKADRINTEN	0x08
#define		STEP		0x04
#define		SEQRESET	0x02
#define		LOADRAM		0x01

/*
 * Sequencer RAM Data (p. 3-34)
 * Single byte window into the Scratch Ram area starting at the address
 * specified by SEQADDR0 and SEQADDR1.  To write a full word, simply write
 * four bytes in sucessesion.  The SEQADDRs will increment after the most
 * significant byte is written
 */
#define SEQRAM			0x061

/*
 * Sequencer Address Registers (p. 3-35)
 * Only the first bit of SEQADDR1 holds addressing information
 */
#define SEQADDR0		0x062
#define SEQADDR1		0x063
#define 	SEQADDR1_MASK	0x01

/*
 * Accumulator
 * We cheat by passing arguments in the Accumulator up to the kernel driver
 */
#define ACCUM			0x064

#define SINDEX			0x065
#define DINDEX			0x066
#define ALLZEROS		0x06a
#define NONE			0x06a
#define SINDIR			0x06c
#define DINDIR			0x06d
#define FUNCTION1		0x06e

/*
 * Host Address (p. 3-48)
 * This register contains the address of the byte about
 * to be transferred across the host bus.
 */
#define HADDR			0x088
#define HADDR0			0x088
#define HADDR1			0x089
#define HADDR2			0x08a
#define HADDR3			0x08b

#define HCNT			0x08c
#define HCNT0			0x08c
#define HCNT1			0x08d
#define HCNT2			0x08e
/*
 * SCB Pointer (p. 3-49)
 * Gate one of the four SCBs into the SCBARRAY window.
 */
#define SCBPTR			0x090

/*
 * Board Control (p. 3-43)
 */
#define BCTL			0x084
/*   RSVD			0xf0 */
#define		ACE		0x08	/* Support for external processors */
/*   RSVD			0x06 */
#define		ENABLE		0x01

/*
 * On the aic78X0 chips, Board Control is replaced by the DSCommand
 * register (p. 4-64)
 */
#define	DSCOMMAND		0x084
#define		CACHETHEN	0x80	/* Cache Threshold enable */
#define		DPARCKEN	0x40	/* Data Parity Check Enable */
#define		MPARCKEN	0x20	/* Memory Parity Check Enable */
#define		EXTREQLCK	0x10	/* External Request Lock */

/*
 * Bus On/Off Time (p. 3-44)
 */
#define BUSTIME			0x085
#define		BOFF		0xf0
#define		BON		0x0f

/*
 * Bus Speed (p. 3-45)
 */
#define	BUSSPD			0x086
#define		DFTHRSH		0xc0
#define		STBOFF		0x38
#define		STBON		0x07
#define		DFTHRSH_100	0xc0

/*
 * Host Control (p. 3-47) R/W
 * Overall host control of the device.
 */
#define HCNTRL			0x087
/*    UNUSED			0x80 */
#define		POWRDN		0x40
/*    UNUSED			0x20 */
#define		SWINT		0x10
#define		IRQMS		0x08
#define		PAUSE		0x04
#define		INTEN		0x02
#define		CHIPRST		0x01
#define		CHIPRSTACK	0x01

/*
 * Interrupt Status (p. 3-50)
 * Status for system interrupts
 */
#define INTSTAT			0x091
#define		SEQINT_MASK	0xf1		/* SEQINT Status Codes */
#define			BAD_PHASE	0x01	/* unknown scsi bus phase */
#define			SEND_REJECT	0x11	/* sending a message reject */
#define			NO_IDENT	0x21	/* no IDENTIFY after reconnect*/
#define			NO_MATCH	0x31	/* no cmd match for reconnect */
#define			EXTENDED_MSG	0x41	/* Extended message received */
#define			REJECT_MSG	0x61	/* Reject message received */
#define			BAD_STATUS	0x71	/* Bad status from target */
#define			RESIDUAL	0x81	/* Residual byte count != 0 */
#define			ABORT_TAG	0x91	/* Sent an ABORT_TAG message */
#define			AWAITING_MSG	0xa1	/*
						 * Kernel requested to specify
                                                 * a message to this target
                                                 * (command was null), so tell
                                                 * it that it can fill the
                                                 * message buffer.
                                                 */
#define			IMMEDDONE	0xb1	/*
						 * An immediate command has
						 * completed
						 */
#define			MSG_BUFFER_BUSY	0xc1	/*
						 * Sequencer wants to use the
						 * message buffer, but it
						 * already contains a message
						 */
#define			MSGIN_PHASEMIS	0xd1	/*
						 * Target changed phase on us
						 * when we were expecting
						 * another msgin byte.
						 */
#define			DATA_OVERRUN	0xe1	/*
						 * Target attempted to write
						 * beyond the bounds of its
						 * command.
						 */
#define 	BRKADRINT 0x08
#define		SCSIINT	  0x04
#define		CMDCMPLT  0x02
#define		SEQINT    0x01
#define		INT_PEND  (BRKADRINT | SEQINT | SCSIINT | CMDCMPLT)

/*
 * Hard Error (p. 3-53)
 * Reporting of catastrophic errors.  You usually cannot recover from
 * these without a full board reset.
 */
#define ERROR			0x092
/*    UNUSED			0xf0 */
#define		PARERR		0x08
#define		ILLOPCODE	0x04
#define		ILLSADDR	0x02
#define		ILLHADDR	0x01

/*
 * Clear Interrupt Status (p. 3-52)
 */
#define CLRINT			0x092
#define		CLRBRKADRINT	0x08
#define		CLRSCSIINT      0x04
#define		CLRCMDINT 	0x02
#define		CLRSEQINT 	0x01

#define	DFCNTRL			0x093
#define		WIDEODD		0x40
#define		SCSIEN		0x20
#define		SDMAEN		0x10
#define		SDMAENACK	0x10
#define		HDMAEN		0x08
#define		HDMAENACK	0x08
#define		DIRECTION	0x04
#define		FIFOFLUSH	0x02
#define		FIFORESET	0x01

#define	DFSTATUS		0x094
#define		HDONE		0x08
#define		FIFOEMP		0x01

#define	DFDAT			0x099

/*
 * SCB Auto Increment (p. 3-59)
 * Byte offset into the SCB Array and an optional bit to allow auto
 * incrementing of the address during download and upload operations
 */
#define SCBCNT			0x09a
#define		SCBAUTO		0x80
#define		SCBCNT_MASK	0x1f

/*
 * Queue In FIFO (p. 3-60)
 * Input queue for queued SCBs (commands that the seqencer has yet to start)
 */
#define QINFIFO			0x09b

/*
 * Queue In Count (p. 3-60)
 * Number of queued SCBs
 */
#define QINCNT			0x09c

/*
 * Queue Out FIFO (p. 3-61)
 * Queue of SCBs that have completed and await the host
 */
#define QOUTFIFO		0x09d

/*
 * Queue Out Count (p. 3-61)
 * Number of queued SCBs in the Out FIFO
 */
#define QOUTCNT			0x09e

/*
 * SCB Definition (p. 5-4)
 * The two reserved bytes at SCBARRAY+1[23] are expected to be set to
 * zero. Bit 3 in SCBARRAY+0 is used as an internal flag to indicate
 * whether or not to DMA an SCB from host ram. This flag prevents the
 * "re-fetching" of transactions that are requeued because the target is
 * busy with another command. We also use bits 6 & 7 to indicate whether
 * or not to initiate SDTR or WDTR repectively when starting this command.
 */
#define SCBARRAY		0x0a0
#define	SCB_CONTROL		0x0a0
#define		MK_MESSAGE      0x80
#define		DISCENB         0x40
#define		TAG_ENB		0x20
#define		DISCONNECTED	0x04
#define		SCB_TAG_TYPE	0x03
#define	SCB_TCL			0x0a1
#define	SCB_TARGET_STATUS	0x0a2
#define	SCB_SGCOUNT		0x0a3
#define	SCB_SGPTR		0x0a4
#define		SCB_SGPTR0	0x0a4
#define		SCB_SGPTR1	0x0a5
#define		SCB_SGPTR2	0x0a6
#define		SCB_SGPTR3	0x0a7
#define	SCB_RESID_SGCNT		0x0a8
#define SCB_RESID_DCNT		0x0a9
#define		SCB_RESID_DCNT0	0x0a9
#define		SCB_RESID_DCNT1	0x0aa
#define		SCB_RESID_DCNT2	0x0ab
#define SCB_DATAPTR		0x0ac
#define		SCB_DATAPTR0	0x0ac
#define		SCB_DATAPTR1	0x0ad
#define		SCB_DATAPTR2	0x0ae
#define		SCB_DATAPTR3	0x0af
#define	SCB_DATACNT		0x0b0
#define		SCB_DATACNT0	0x0b0
#define		SCB_DATACNT1	0x0b1
#define		SCB_DATACNT2	0x0b2
/* UNUSED - QUAD PADDING	0x0b3 */
#define SCB_CMDPTR		0x0b4
#define		SCB_CMDPTR0	0x0b4
#define		SCB_CMDPTR1	0x0b5
#define		SCB_CMDPTR2	0x0b6
#define		SCB_CMDPTR3	0x0b7
#define	SCB_CMDLEN		0x0b8
#define SCB_TAG			0x0b9
#define	SCB_NEXT		0x0ba
#define	SCB_PREV		0x0bb

#ifdef __linux__
#define	SG_SIZEOF		0x0c		/* sizeof(struct scatterlist) */
#else
#define	SG_SIZEOF		0x08		/* sizeof(struct ahc_dma) */
#endif

/* --------------------- AHA-2840-only definitions -------------------- */

#define	SEECTL_2840		0x0c0
/*	UNUSED			0xf8 */
#define		CS_2840		0x04
#define		CK_2840		0x02
#define		DO_2840		0x01

#define	STATUS_2840		0x0c1
#define		EEPROM_TF	0x80
#define		BIOS_SEL	0x60
#define		ADSEL		0x1e
#define		DI_2840		0x01

/* --------------------- AIC-7870-only definitions -------------------- */

#define DSPCISTATUS		0x086

/*
 * Serial EEPROM Control (p. 4-92 in 7870 Databook)
 * Controls the reading and writing of an external serial 1-bit
 * EEPROM Device.  In order to access the serial EEPROM, you must
 * first set the SEEMS bit that generates a request to the memory
 * port for access to the serial EEPROM device.  When the memory
 * port is not busy servicing another request, it reconfigures
 * to allow access to the serial EEPROM.  When this happens, SEERDY
 * gets set high to verify that the memory port access has been
 * granted.  
 *
 * After successful arbitration for the memory port, the SEECS bit of 
 * the SEECTL register is connected to the chip select.  The SEECK, 
 * SEEDO, and SEEDI are connected to the clock, data out, and data in 
 * lines respectively.  The SEERDY bit of SEECTL is useful in that it 
 * gives us an 800 nsec timer.  After a write to the SEECTL register, 
 * the SEERDY goes high 800 nsec later.  The one exception to this is 
 * when we first request access to the memory port.  The SEERDY goes 
 * high to signify that access has been granted and, for this case, has 
 * no implied timing.
 *
 * See 93cx6.c for detailed information on the protocol necessary to 
 * read the serial EEPROM.
 */
#define SEECTL			0x01e
#define		EXTARBACK	0x80
#define		EXTARBREQ	0x40
#define		SEEMS		0x20
#define		SEERDY		0x10
#define		SEECS		0x08
#define		SEECK		0x04
#define		SEEDO		0x02
#define		SEEDI		0x01

/* ---------------------- Scratch RAM Offsets ------------------------- */
/* These offsets are either to values that are initialized by the board's
 * BIOS or are specified by the sequencer code.
 *
 * The host adapter card (at least the BIOS) uses 20-2f for SCSI
 * device information, 32-33 and 5a-5f as well. As it turns out, the
 * BIOS trashes 20-2f, writing the synchronous negotiation results
 * on top of the BIOS values, so we re-use those for our per-target
 * scratchspace (actually a value that can be copied directly into
 * SCSIRATE).  The kernel driver will enable synchronous negotiation
 * for all targets that have a value other than 0 in the lower four
 * bits of the target scratch space.  This should work regardless of
 * whether the bios has been installed.
 */

/*
 * 1 byte per target starting at this address for configuration values
 */
#define TARG_SCRATCH		0x020

/*
 * The sequencer will stick the first byte of any rejected message here so
 * we can see what is getting thrown away.  Extended messages put the
 * extended message type in REJBYTE_EXT.
 */
#define REJBYTE			0x030
#define REJBYTE_EXT		0x031

/*
 * Bit vector of targets that have disconnection disabled.
 */
#define	DISC_DSB		0x032
#define		DISC_DSB_A	0x032
#define		DISC_DSB_B	0x033

/*
 * Length of pending message
 */
#define MSG_LEN			0x034

/* We reserve 8bytes to store outgoing messages */
#define MSG0			0x035
#define		COMP_MSG0	0xcb      /* 2's complement of MSG0 */
#define MSG1			0x036
#define MSG2			0x037
#define MSG3			0x038
#define MSG4			0x039
#define MSG5			0x03a
#define MSG6			0x03b
#define MSG7			0x03c

/*
 * These are offsets into the card's scratch ram.  Some of the values are
 * specified in the AHA2742 technical reference manual and are initialized
 * by the BIOS at boot time.
 */
#define LASTPHASE		0x03d
#define ARG_1			0x03e
#define RETURN_1		0x03f
#define		SEND_MSG	0x80
#define		SEND_SENSE	0x40
#define		SEND_REJ	0x20
#define		SCB_PAGEDIN	0x10

#define SIGSTATE		0x040

#define DMAPARAMS		0x041	/* Parameters for DMA Logic */

#define	SG_COUNT		0x042
#define	SG_NEXT			0x043	/* working value of SG pointer */
#define		SG_NEXT0	0x043
#define		SG_NEXT1	0x044
#define		SG_NEXT2	0x045
#define		SG_NEXT3	0x046

#define	SCBCOUNT		0x047	/*
					 * Number of SCBs supported by
					 * this card.
					 */
#define	COMP_SCBCOUNT		0x048	/*
					 * Two's complement of SCBCOUNT
					 */
#define QCNTMASK		0x049	/*
					 * Mask of bits to test against
					 * when looking at the Queue Count
					 * registers.  Works around a bug
					 * on aic7850 chips. 
					 */
#define FLAGS			0x04a
#define		SINGLE_BUS	0x00
#define		TWIN_BUS	0x01
#define		WIDE_BUS	0x02
#define		PAGESCBS	0x04
#define		DPHASE		0x10
#define		SELECTED	0x20
#define		IDENTIFY_SEEN	0x40
#define		RESELECTED	0x80

#define	SAVED_TCL		0x04b	/*
					 * Temporary storage for the
					 * target/channel/lun of a
					 * reconnecting target
					 */
#define	ACTIVE_A		0x04c
#define	ACTIVE_B		0x04d
#define WAITING_SCBH		0x04e	/*
					 * head of list of SCBs awaiting
					 * selection
					 */
#define DISCONNECTED_SCBH	0x04f	/*
					 * head of list of SCBs that are
					 * disconnected.  Used for SCB
					 * paging.
					 */
#define		SCB_LIST_NULL	0xff

#define SAVED_LINKPTR		0x050
#define SAVED_SCBPTR		0x051
#define ULTRA_ENB		0x052
#define ULTRA_ENB_B		0x053

#define MSGIN_EXT_LEN		0x054
#define MSGIN_EXT_OPCODE	0x055
#define MSGIN_EXT_BYTE0		0x056
#define MSGIN_EXT_BYTE1		0x057
#define	MSGIN_EXT_LASTBYTE	0x058	/*
					 * We don't use this location, but
					 * continue to store bytes until
					 * we reach this address (avoids
					 * a more complicated compare).
					 * So, we can store at most 2
					 * bytes for now.
					 */

#define SCSICONF		0x05a
#define		RESET_SCSI	0x40

#define HOSTCONF		0x05d

#define HA_274_BIOSCTRL		0x05f
#define BIOSMODE		0x30
#define BIOSDISABLED		0x30
#define CHANNEL_B_PRIMARY	0x08

/* WDTR Message values */
#define	BUS_8_BIT		0x00
#define BUS_16_BIT		0x01
#define BUS_32_BIT		0x02
d669 1
a669 2
#define MAX_OFFSET_8BIT		0x0f
#define MAX_OFFSET_16BIT	0x08
@


1.5.14.1
log
@Sync with -current
@
text
@d1 2
d4 28
a31 1
 * DO NOT EDIT - This file is automatically generated.
d34 61
a94 662
#define	SCSISEQ         		0x00
#define		TEMODE          	0x80
#define		SCSIRSTO        	0x01

#define	SXFRCTL0        		0x01
#define		DFON            	0x80
#define		DFPEXP          	0x40
#define		FAST20          	0x20
#define		CLRSTCNT        	0x10
#define		SPIOEN          	0x08
#define		SCAMEN          	0x04
#define		CLRCHN          	0x02

#define	SXFRCTL1        		0x02
#define		BITBUCKET       	0x80
#define		SWRAPEN         	0x40
#define		STIMESEL        	0x18
#define		ENSTIMER        	0x04
#define		ACTNEGEN        	0x02
#define		STPWEN          	0x01

#define	SCSISIGO        		0x03
#define		CDO             	0x80
#define		IOO             	0x40
#define		MSGO            	0x20
#define		ATNO            	0x10
#define		SELO            	0x08
#define		BSYO            	0x04
#define		REQO            	0x02
#define		ACKO            	0x01

#define	SCSISIGI        		0x03
#define		ATNI            	0x10
#define		SELI            	0x08
#define		BSYI            	0x04
#define		REQI            	0x02
#define		ACKI            	0x01

#define	SCSIRATE        		0x04
#define		WIDEXFER        	0x80
#define		SXFR            	0x70
#define		ENABLE_CRC      	0x40
#define		SINGLE_EDGE     	0x10
#define		SOFS            	0x0f
#define		SXFR_ULTRA2     	0x0f

#define	SCSIID          		0x05
#define	SCSIOFFSET      		0x05
#define		SOFS_ULTRA2     	0x7f

#define	SCSIDATL        		0x06

#define	SCSIDATH        		0x07

#define	STCNT           		0x08

#define	OPTIONMODE      		0x08
#define		AUTORATEEN      	0x80
#define		AUTOACKEN       	0x40
#define		ATNMGMNTEN      	0x20
#define		BUSFREEREV      	0x10
#define		EXPPHASEDIS     	0x08
#define		SCSIDATL_IMGEN  	0x04
#define		OPTIONMODE_DEFAULTS	0x03
#define		AUTO_MSGOUT_DE  	0x02
#define		DIS_MSGIN_DUALEDGE	0x01

#define	TARGCRCCNT      		0x0a

#define	CLRSINT0        		0x0b
#define		CLRSELDO        	0x40
#define		CLRSELDI        	0x20
#define		CLRSELINGO      	0x10
#define		CLRSWRAP        	0x08
#define		CLRSPIORDY      	0x02

#define	SSTAT0          		0x0b
#define		TARGET          	0x80
#define		SELDO           	0x40
#define		SELDI           	0x20
#define		SELINGO         	0x10
#define		IOERR           	0x08
#define		SWRAP           	0x08
#define		SDONE           	0x04
#define		SPIORDY         	0x02
#define		DMADONE         	0x01

#define	CLRSINT1        		0x0c
#define		CLRSELTIMEO     	0x80
#define		CLRATNO         	0x40
#define		CLRSCSIRSTI     	0x20
#define		CLRBUSFREE      	0x08
#define		CLRSCSIPERR     	0x04
#define		CLRPHASECHG     	0x02
#define		CLRREQINIT      	0x01

#define	SSTAT1          		0x0c
#define		SELTO           	0x80
#define		ATNTARG         	0x40
#define		SCSIRSTI        	0x20
#define		PHASEMIS        	0x10
#define		BUSFREE         	0x08
#define		SCSIPERR        	0x04
#define		PHASECHG        	0x02
#define		REQINIT         	0x01

#define	SSTAT2          		0x0d
#define		OVERRUN         	0x80
#define		SFCNT           	0x1f
#define		EXP_ACTIVE      	0x10

#define	SSTAT3          		0x0e
#define		SCSICNT         	0xf0
#define		OFFCNT          	0x0f

#define	SCSIID_ULTRA2   		0x0f
#define		OID             	0x0f

#define	SIMODE0         		0x10
#define		ENSELDO         	0x40
#define		ENSELDI         	0x20
#define		ENSELINGO       	0x10
#define		ENIOERR         	0x08
#define		ENSWRAP         	0x08
#define		ENSDONE         	0x04
#define		ENSPIORDY       	0x02
#define		ENDMADONE       	0x01

#define	SIMODE1         		0x11
#define		ENSELTIMO       	0x80
#define		ENATNTARG       	0x40
#define		ENSCSIRST       	0x20
#define		ENPHASEMIS      	0x10
#define		ENBUSFREE       	0x08
#define		ENSCSIPERR      	0x04
#define		ENPHASECHG      	0x02
#define		ENREQINIT       	0x01

#define	SCSIBUSL        		0x12

#define	SCSIBUSH        		0x13

#define	SHADDR          		0x14

#define	SELTIMER        		0x18
#define	TARGIDIN        		0x18
#define		STAGE6          	0x20
#define		STAGE5          	0x10
#define		STAGE4          	0x08
#define		STAGE3          	0x04
#define		STAGE2          	0x02
#define		STAGE1          	0x01

#define	SELID           		0x19
#define		SELID_MASK      	0xf0
#define		ONEBIT          	0x08

#define	SCAMCTL         		0x1a
#define		ENSCAMSELO      	0x80
#define		CLRSCAMSELID    	0x40
#define		ALTSTIM         	0x20
#define		DFLTTID         	0x10
#define		SCAMLVL         	0x03

#define	TARGID          		0x1b

#define	SPIOCAP         		0x1b
#define		SOFT1           	0x80
#define		SOFT0           	0x40
#define		SOFTCMDEN       	0x20
#define		HAS_BRDCTL      	0x10
#define		SEEPROM         	0x08
#define		EEPROM          	0x04
#define		ROM             	0x02
#define		SSPIOCPS        	0x01

#define	BRDCTL          		0x1d
#define		BRDDAT7         	0x80
#define		BRDDAT6         	0x40
#define		BRDDAT5         	0x20
#define		BRDDAT4         	0x10
#define		BRDSTB          	0x10
#define		BRDCS           	0x08
#define		BRDDAT3         	0x08
#define		BRDDAT2         	0x04
#define		BRDRW           	0x04
#define		BRDRW_ULTRA2    	0x02
#define		BRDCTL1         	0x02
#define		BRDCTL0         	0x01
#define		BRDSTB_ULTRA2   	0x01

#define	SEECTL          		0x1e
#define		EXTARBACK       	0x80
#define		EXTARBREQ       	0x40
#define		SEEMS           	0x20
#define		SEERDY          	0x10
#define		SEECS           	0x08
#define		SEECK           	0x04
#define		SEEDO           	0x02
#define		SEEDI           	0x01

#define	SBLKCTL         		0x1f
#define		DIAGLEDEN       	0x80
#define		DIAGLEDON       	0x40
#define		AUTOFLUSHDIS    	0x20
#define		ENAB40          	0x08
#define		ENAB20          	0x04
#define		SELWIDE         	0x02
#define		XCVR            	0x01

#define	SRAM_BASE       		0x20

#define	TARG_SCSIRATE   		0x20
#define	CMDSIZE_TABLE   		0x20

#define	ULTRA_ENB       		0x30

#define	DISC_DSB        		0x32

#define	MSG_OUT         		0x34

#define	DMAPARAMS       		0x35
#define		PRELOADEN       	0x80
#define		WIDEODD         	0x40
#define		SCSIEN          	0x20
#define		SDMAENACK       	0x10
#define		SDMAEN          	0x10
#define		HDMAEN          	0x08
#define		HDMAENACK       	0x08
#define		DIRECTION       	0x04
#define		FIFOFLUSH       	0x02
#define		FIFORESET       	0x01

#define	SEQ_FLAGS       		0x36
#define		IDENTIFY_SEEN   	0x80
#define		SCBPTR_VALID    	0x40
#define		DPHASE          	0x20
#define		TARG_CMD_PENDING	0x10
#define		CMDPHASE_PENDING	0x08
#define		DPHASE_PENDING  	0x04
#define		SPHASE_PENDING  	0x02
#define		NO_DISCONNECT   	0x01

#define	SAVED_TCL       		0x37

#define	SG_COUNT        		0x38

#define	SG_NEXT         		0x39

#define	LASTPHASE       		0x3d
#define		P_MESGIN        	0xe0
#define		PHASE_MASK      	0xe0
#define		P_STATUS        	0xc0
#define		P_MESGOUT       	0xa0
#define		P_COMMAND       	0x80
#define		CDI             	0x80
#define		IOI             	0x40
#define		P_DATAIN        	0x40
#define		MSGI            	0x20
#define		P_BUSFREE       	0x01
#define		P_DATAOUT       	0x00

#define	WAITING_SCBH    		0x3e

#define	DISCONNECTED_SCBH		0x3f

#define	FREE_SCBH       		0x40

#define	HSCB_ADDR       		0x41

#define	SCBID_ADDR      		0x45

#define	TMODE_CMDADDR   		0x49

#define	KERNEL_QINPOS   		0x4d

#define	QINPOS          		0x4e

#define	QOUTPOS         		0x4f

#define	KERNEL_TQINPOS  		0x50

#define	TQINPOS         		0x51

#define	ARG_1           		0x52
#define	RETURN_1        		0x52
#define		SEND_MSG        	0x80
#define		SEND_SENSE      	0x40
#define		SEND_REJ        	0x20
#define		MSGOUT_PHASEMIS 	0x10
#define		EXIT_MSG_LOOP   	0x08
#define		CONT_MSG_LOOP   	0x04
#define		CONT_TARG_SESSION	0x02

#define	ARG_2           		0x53
#define	RETURN_2        		0x53

#define	LAST_MSG        		0x54

#define	PREFETCH_CNT    		0x55

#define	TARGET_MSG_REQUEST		0x56

#define	SCSISEQ_TEMPLATE		0x58
#define		ENSELO          	0x40
#define		ENSELI          	0x20
#define		ENRSELI         	0x10
#define		ENAUTOATNO      	0x08
#define		ENAUTOATNI      	0x04
#define		ENAUTOATNP      	0x02

#define	DATA_COUNT_ODD  		0x59

#define	SCSICONF        		0x5a
#define		TERM_ENB        	0x80
#define		RESET_SCSI      	0x40
#define		ENSPCHK         	0x20
#define		HWSCSIID        	0x0f
#define		HSCSIID         	0x07

#define	INITIATOR_TAG   		0x5a

#define	HOSTCONF        		0x5d

#define	HA_274_BIOSCTRL 		0x5f
#define		BIOSMODE        	0x30
#define		BIOSDISABLED    	0x30
#define		CHANNEL_B_PRIMARY	0x08

#define	SEQCTL          		0x60
#define		PERRORDIS       	0x80
#define		PAUSEDIS        	0x40
#define		FAILDIS         	0x20
#define		FASTMODE        	0x10
#define		BRKADRINTEN     	0x08
#define		STEP            	0x04
#define		SEQRESET        	0x02
#define		LOADRAM         	0x01

#define	SEQRAM          		0x61

#define	SEQADDR0        		0x62

#define	SEQADDR1        		0x63
#define		SEQADDR1_MASK   	0x01

#define	ACCUM           		0x64

#define	SINDEX          		0x65

#define	DINDEX          		0x66

#define	ALLONES         		0x69

#define	ALLZEROS        		0x6a

#define	NONE            		0x6a

#define	FLAGS           		0x6b
#define		ZERO            	0x02
#define		CARRY           	0x01

#define	SINDIR          		0x6c

#define	DINDIR          		0x6d

#define	FUNCTION1       		0x6e

#define	STACK           		0x6f

#define	TARG_OFFSET     		0x70

#define	BCTL            		0x84
#define		ACE             	0x08
#define		ENABLE          	0x01

#define	DSCOMMAND0      		0x84
#define		CACHETHEN       	0x80
#define		DPARCKEN        	0x40
#define		MPARCKEN        	0x20
#define		EXTREQLCK       	0x10
#define		INTSCBRAMSEL    	0x08
#define		RAMPS           	0x04
#define		USCBSIZE32      	0x02
#define		CIOPARCKEN      	0x01

#define	BUSTIME         		0x85
#define		BOFF            	0xf0
#define		BON             	0x0f

#define	BUSSPD          		0x86
#define		DFTHRSH         	0xc0
#define		STBOFF          	0x38
#define		STBON           	0x07

#define	HS_MAILBOX      		0x86
#define		HOST_MAILBOX    	0xf0
#define		SEQ_MAILBOX     	0x0f

#define	DSPCISTATUS     		0x86
#define		DFTHRSH_100     	0xc0

#define	HCNTRL          		0x87
#define		POWRDN          	0x40
#define		SWINT           	0x10
#define		IRQMS           	0x08
#define		PAUSE           	0x04
#define		INTEN           	0x02
#define		CHIPRST         	0x01
#define		CHIPRSTACK      	0x01

#define	HADDR           		0x88

#define	HCNT            		0x8c

#define	SCBPTR          		0x90

#define	INTSTAT         		0x91
#define		SEQINT_MASK     	0xf1
#define		DATA_OVERRUN    	0xf1
#define		MSGIN_PHASEMIS  	0xe1
#define		TRACEPOINT      	0xd1
#define		PERR_DETECTED   	0xb1
#define		HOST_MSG_LOOP   	0xa1
#define		TRACE_POINT     	0x91
#define		RESIDUAL        	0x81
#define		BAD_STATUS      	0x71
#define		UPDATE_TMSG_REQ 	0x61
#define		NO_MATCH        	0x31
#define		NO_IDENT        	0x21
#define		SEND_REJECT     	0x11
#define		INT_PEND        	0x0f
#define		BRKADRINT       	0x08
#define		SCSIINT         	0x04
#define		CMDCMPLT        	0x02
#define		BAD_PHASE       	0x01
#define		SEQINT          	0x01

#define	CLRINT          		0x92
#define		CLRPARERR       	0x10
#define		CLRBRKADRINT    	0x08
#define		CLRSCSIINT      	0x04
#define		CLRCMDINT       	0x02
#define		CLRSEQINT       	0x01

#define	ERROR           		0x92
#define		CIOPARERR       	0x80
#define		PCIERRSTAT      	0x40
#define		MPARERR         	0x20
#define		DPARERR         	0x10
#define		SQPARERR        	0x08
#define		ILLOPCODE       	0x04
#define		ILLSADDR        	0x02
#define		ILLHADDR        	0x01

#define	DFCNTRL         		0x93

#define	DFSTATUS        		0x94
#define		PRELOAD_AVAIL   	0x80
#define		DWORDEMP        	0x20
#define		MREQPEND        	0x10
#define		HDONE           	0x08
#define		DFTHRESH        	0x04
#define		FIFOFULL        	0x02
#define		FIFOEMP         	0x01

#define	DFWADDR         		0x95

#define	DFRADDR         		0x97

#define	DFDAT           		0x99

#define	SCBCNT          		0x9a
#define		SCBAUTO         	0x80
#define		SCBCNT_MASK     	0x1f

#define	QINFIFO         		0x9b

#define	QINCNT          		0x9c

#define	QOUTFIFO        		0x9d

#define	CRCCONTROL1     		0x9d
#define		CRCONSEEN       	0x80
#define		CRCVALCHKEN     	0x40
#define		CRCENDCHKEN     	0x20
#define		CRCREQCHKEN     	0x10
#define		TARGCRCENDEN    	0x08
#define		TARGCRCCNTEN    	0x04

#define	QOUTCNT         		0x9e

#define	SCSIPHASE       		0x9e
#define		STATUS_PHASE    	0x20
#define		COMMAND_PHASE   	0x10
#define		MSG_IN_PHASE    	0x08
#define		MSG_OUT_PHASE   	0x04
#define		DATA_IN_PHASE   	0x02
#define		DATA_OUT_PHASE  	0x01

#define	SFUNCT          		0x9f
#define		ALT_MODE        	0x80

#define	SCB_CONTROL     		0xa0
#define		TARGET_SCB      	0x80
#define		DISCENB         	0x40
#define		TAG_ENB         	0x20
#define		MK_MESSAGE      	0x10
#define		ULTRAENB        	0x08
#define		DISCONNECTED    	0x04
#define		SCB_TAG_TYPE    	0x03

#define	SCB_BASE        		0xa0

#define	SCB_TCL         		0xa1
#define		TID             	0xf0
#define		SELBUSB         	0x08
#define		LID             	0x07

#define	SCB_TARGET_STATUS		0xa2

#define	SCB_SGCOUNT     		0xa3

#define	SCB_SGPTR       		0xa4

#define	SCB_RESID_SGCNT 		0xa8

#define	SCB_RESID_DCNT  		0xa9

#define	SCB_DATAPTR     		0xac

#define	SCB_DATACNT     		0xb0

#define	SCB_CMDPTR      		0xb4
#define	SCB_TARGET_PHASES		0xb4
#define		TARGET_DATA_IN  	0x01

#define	SCB_CMDLEN      		0xb8
#define	SCB_INITIATOR_TAG		0xb8

#define	SCB_TAG         		0xb9

#define	SCB_NEXT        		0xba

#define	SCB_SCSIRATE    		0xbb

#define	SCB_SCSIOFFSET  		0xbc

#define	SCB_SPARE       		0xbd

#define	SCB_CMDSTORE    		0xc0

#define	SEECTL_2840     		0xc0
#define		CS_2840         	0x04
#define		CK_2840         	0x02
#define		DO_2840         	0x01

#define	STATUS_2840     		0xc1
#define		EEPROM_TF       	0x80
#define		BIOS_SEL        	0x60
#define		ADSEL           	0x1e
#define		DI_2840         	0x01

#define	SCB_CMDSTORE_BUSADDR		0xd0

#define	SCB_64BYTE_SPARE		0xd4

#define	CCHADDR         		0xe0

#define	CCHCNT          		0xe8

#define	CCSGRAM         		0xe9

#define	CCSGADDR        		0xea

#define	CCSGCTL         		0xeb
#define		CCSGDONE        	0x80
#define		CCSGEN          	0x08
#define		FLAG            	0x02
#define		CCSGRESET       	0x01

#define	CCSCBRAM        		0xec

#define	CCSCBADDR       		0xed

#define	CCSCBCTL        		0xee
#define		CCSCBDONE       	0x80
#define		ARRDONE         	0x40
#define		CCARREN         	0x10
#define		CCSCBEN         	0x08
#define		CCSCBDIR        	0x04
#define		CCSCBRESET      	0x01

#define	CCSCBCNT        		0xef

#define	SCBBADDR        		0xf0

#define	CCSCBPTR        		0xf1

#define	HNSCB_QOFF      		0xf4

#define	SNSCB_QOFF      		0xf6

#define	SDSCB_QOFF      		0xf8

#define	QOFF_CTLSTA     		0xfa
#define		SCB_AVAIL       	0x40
#define		SNSCB_ROLLOVER  	0x20
#define		SDSCB_ROLLOVER  	0x10
#define		SCB_QSIZE       	0x07
#define		SCB_QSIZE_256   	0x06

#define	DFF_THRSH       		0xfb
#define		WR_DFTHRSH      	0x70
#define		WR_DFTHRSH_MAX  	0x70
#define		WR_DFTHRSH_90   	0x60
#define		WR_DFTHRSH_85   	0x50
#define		WR_DFTHRSH_75   	0x40
#define		WR_DFTHRSH_63   	0x30
#define		WR_DFTHRSH_50   	0x20
#define		WR_DFTHRSH_25   	0x10
#define		RD_DFTHRSH_MAX  	0x07
#define		RD_DFTHRSH      	0x07
#define		RD_DFTHRSH_90   	0x06
#define		RD_DFTHRSH_85   	0x05
#define		RD_DFTHRSH_75   	0x04
#define		RD_DFTHRSH_63   	0x03
#define		RD_DFTHRSH_50   	0x02
#define		RD_DFTHRSH_25   	0x01
#define		RD_DFTHRSH_MIN  	0x00
#define		WR_DFTHRSH_MIN  	0x00

#define	SG_CACHEPTR     		0xfc
#define		SG_USER_DATA    	0xfc
#define		LAST_SEG        	0x02
#define		LAST_SEG_DONE   	0x01


#define	CMD_GROUP_CODE_SHIFT	0x05
#define	BUS_8_BIT	0x00
#define	QOUTFIFO_OFFSET	0x00
#define	CCSGRAM_MAXSEGS	0x10
#define	SCB_64BYTE_SIZE	0x30
#define	STATUS_QUEUE_FULL	0x28
#define	STATUS_BUSY	0x08
#define	TQINFIFO_UPDATE_CNT	0x20
#define	TCL_TARGET_SHIFT	0x04
#define	MAX_OFFSET_8BIT	0x0f
#define	BUS_16_BIT	0x01
#define	QINFIFO_OFFSET	0x01
#define	SCB_32BYTE_SIZE	0x1c
#define	HOST_MAILBOX_SHIFT	0x04
#define	MAX_OFFSET_ULTRA2	0x7f
#define	MAX_OFFSET_16BIT	0x08
#define	UNTAGGEDSCB_OFFSET	0x02
#define	TARGET_CMD_CMPLT	0xfe
#define	SCB_LIST_NULL	0xff
#define	SG_SIZEOF	0x08
#define	SEQ_MAILBOX_SHIFT	0x00
#define	HOST_MSG	0xff
#define	BUS_32_BIT	0x02
#define	CCSGADDR_MAX	0x80
d96 677
d774 2
a775 1
/* Downloaded Constant Definitions */
@


1.5.14.2
log
@merge in approximately 2.9 into SMP branch
@
text
@a401 2
#define		HOST_TQINPOS    	0x80
#define		HOST_REQ_INT    	0x10
@


1.5.14.3
log
@Merge in trunk
@
text
@a0 1
/* $OpenBSD$ */
d2 1
a2 5
 * DO NOT EDIT - This file is automatically generated
 *               from the following source files:
 *
 * $Id$
 * $Id$
a25 9
#define	SCSISIGI        		0x03
#define		P_DATAIN_DT     	0x60
#define		P_DATAOUT_DT    	0x20
#define		ATNI            	0x10
#define		SELI            	0x08
#define		BSYI            	0x04
#define		REQI            	0x02
#define		ACKI            	0x01

d36 7
d48 1
a49 1
#define		SOFS            	0x0f
d59 2
a71 2
#define	STCNT           		0x08

a77 1
#define		CLRIOERR        	0x08
a112 1
#define		SHVALID         	0x40
a114 4
#define		CRCVALERR       	0x08
#define		CRCENDERR       	0x04
#define		CRCREQERR       	0x02
#define		DUAL_EDGE_ERR   	0x01
d121 1
d187 1
a188 1
#define		BRDCS           	0x08
d191 1
a192 1
#define		BRDRW_ULTRA2    	0x02
a210 1
#define		SELBUSB         	0x08
a216 1
#define	BUSY_TARGETS    		0x20
d218 1
a220 1
#define	CMDSIZE_TABLE   		0x30
d224 1
a224 3
#define	CMDSIZE_TABLE_TAIL		0x34

#define	MWI_RESIDUAL    		0x38
d226 1
a226 5
#define	NEXT_QUEUED_SCB 		0x39

#define	MSG_OUT         		0x3a

#define	DMAPARAMS       		0x3b
d232 1
a233 1
#define		HDMAEN          	0x08
d238 1
a238 1
#define	SEQ_FLAGS       		0x3c
d240 1
a240 1
#define		TARGET_CMD_IS_TAGGED	0x40
d248 3
a250 1
#define	SAVED_SCSIID    		0x3d
d252 1
a252 1
#define	SAVED_LUN       		0x3e
d254 2
a255 1
#define	LASTPHASE       		0x3f
a256 1
#define		P_MESGIN        	0xe0
d267 1
a267 1
#define	WAITING_SCBH    		0x40
d269 1
a269 1
#define	DISCONNECTED_SCBH		0x41
d271 1
a271 1
#define	FREE_SCBH       		0x42
d273 1
a273 1
#define	COMPLETE_SCBH   		0x43
d275 1
a275 1
#define	HSCB_ADDR       		0x44
d277 1
a277 1
#define	SHARED_DATA_ADDR		0x48
d279 1
a279 1
#define	KERNEL_QINPOS   		0x4c
d281 1
a281 1
#define	QINPOS          		0x4d
d283 1
a283 1
#define	QOUTPOS         		0x4e
d285 1
a285 1
#define	KERNEL_TQINPOS  		0x4f
d287 1
a287 1
#define	TQINPOS         		0x50
d289 2
a290 2
#define	ARG_1           		0x51
#define	RETURN_1        		0x51
d299 6
a304 2
#define	ARG_2           		0x52
#define	RETURN_2        		0x52
d306 1
a306 1
#define	LAST_MSG        		0x53
d308 1
a308 1
#define	SCSISEQ_TEMPLATE		0x54
d316 1
a316 6
#define	DATA_COUNT_ODD  		0x55

#define	INITIATOR_TAG   		0x56

#define	SEQ_FLAGS2      		0x57
#define		SCB_DMA         	0x01
d325 1
a325 3
#define	INTDEF          		0x5c
#define		EDGE_TRIG       	0x80
#define		VECTOR          	0x0f
d359 2
a362 2
#define	ALLZEROS        		0x6a

a394 5
#define	DSCOMMAND1      		0x85
#define		DSLATT          	0xfc
#define		HADDLDSEL1      	0x02
#define		HADDLDSEL0      	0x01

a396 1
#define		DFTHRSH_75      	0x80
d415 1
a416 1
#define		CHIPRST         	0x01
d426 7
a432 7
#define		OUT_OF_RANGE    	0xe1
#define		NO_FREE_SCB     	0xd1
#define		SCB_MISMATCH    	0xc1
#define		MISSED_BUSFREE  	0xb1
#define		MKMSG_FAILED    	0xa1
#define		DATA_OVERRUN    	0x91
#define		PERR_DETECTED   	0x81
d434 1
a434 3
#define		HOST_MSG_LOOP   	0x61
#define		PDATA_REINIT    	0x51
#define		IGN_WIDE_RES    	0x41
d442 1
d444 7
a450 1
#define		BAD_PHASE       	0x01
a461 7
#define	CLRINT          		0x92
#define		CLRPARERR       	0x10
#define		CLRBRKADRINT    	0x08
#define		CLRSCSIINT      	0x04
#define		CLRCMDINT       	0x02
#define		CLRSEQINT       	0x01

d466 1
a466 2
#define		DFCACHETH       	0x40
#define		FIFOQWDEMP      	0x20
a503 1
#define		DATA_PHASE_MASK 	0x03
d510 8
a517 4
#define	SCB_CDB_PTR     		0xa0
#define	SCB_TARGET_INFO 		0xa0
#define	SCB_RESIDUAL_DATACNT		0xa0
#define	SCB_CDB_STORE   		0xa0
d521 6
a526 1
#define	SCB_RESIDUAL_SGPTR		0xa4
d528 1
a528 1
#define	SCB_SCSI_STATUS 		0xa8
d530 5
a534 1
#define	SCB_CDB_STORE_PAD		0xa9
a538 7
#define		SG_LAST_SEG     	0x80
#define		SG_HIGH_ADDR_BITS	0x7f

#define	SCB_SGPTR       		0xb4
#define		SG_RESID_VALID  	0x04
#define		SG_FULL_RESID   	0x02
#define		SG_LIST_NULL    	0x01
d540 3
a542 8
#define	SCB_CONTROL     		0xb8
#define		TARGET_SCB      	0x80
#define		DISCENB         	0x40
#define		TAG_ENB         	0x20
#define		MK_MESSAGE      	0x10
#define		ULTRAENB        	0x08
#define		DISCONNECTED    	0x04
#define		SCB_TAG_TYPE    	0x03
d544 2
a545 5
#define	SCB_SCSIID      		0xb9
#define		TID             	0xf0
#define		TWIN_CHNLB      	0x80
#define		TWIN_TID        	0x70
#define		OID             	0x0f
d547 1
a547 2
#define	SCB_LUN         		0xba
#define		LID             	0xff
d549 1
a549 1
#define	SCB_TAG         		0xbb
d551 1
a551 1
#define	SCB_CDB_LEN     		0xbc
d553 1
a553 1
#define	SCB_SCSIRATE    		0xbd
d555 1
a555 1
#define	SCB_SCSIOFFSET  		0xbe
d557 1
a557 1
#define	SCB_NEXT        		0xbf
a563 2
#define	SCB_64_SPARE    		0xc0

d570 3
a572 1
#define	SCB_64_BTT      		0xd0
d585 1
a585 1
#define		SG_FETCH_NEEDED 	0x02
d639 2
a640 3
#define	SG_CACHE_SHADOW 		0xfc
#define		SG_ADDR_MASK    	0xf8
#define		ODD_SEG         	0x04
a643 2
#define	SG_CACHE_PRE    		0xfc

a644 2
#define	HOST_MSG	0xff
#define	BUS_32_BIT	0x02
d647 1
d649 1
a649 1
#define	TARGET_DATA_IN	0x01
d652 2
d656 2
a657 3
#define	TID_SHIFT	0x04
#define	SCB_DOWNLOAD_SIZE_64	0x30
#define	SCB_UPLOAD_SIZE	0x20
a658 4
#define	SCB_INITIATOR_TAG	0x03
#define	SCB_TARGET_STATUS	0x02
#define	SCB_TARGET_DATA_DIR	0x01
#define	SCB_TARGET_PHASES	0x00
d661 1
a664 1
#define	SCB_DOWNLOAD_SIZE	0x20
d666 2
a671 7
#define	SG_PREFETCH_ADDR_MASK	0x06
#define	SG_PREFETCH_ALIGN_MASK	0x05
#define	QOUTFIFO_OFFSET	0x00
#define	SG_PREFETCH_CNT	0x04
#define	INVERTED_CACHESIZE_MASK	0x03
#define	CACHESIZE_MASK	0x02
#define	QINFIFO_OFFSET	0x01
@


1.5.14.4
log
@Merge in -current from about a week ago
@
text
@d1 1
d3 5
a7 1
 * DO NOT EDIT - This file is automatically generated.
d31 9
a49 7
#define	SCSISIGI        		0x03
#define		ATNI            	0x10
#define		SELI            	0x08
#define		BSYI            	0x04
#define		REQI            	0x02
#define		ACKI            	0x01

d55 1
a56 1
#define		SXFR_ULTRA2     	0x0f
a65 2
#define	STCNT           		0x08

d77 2
d85 1
d121 1
d124 4
a133 1
#define		OID             	0x0f
d199 1
a200 1
#define		BRDDAT3         	0x08
d203 1
a204 1
#define		BRDCTL1         	0x02
d223 1
d230 1
a231 1
#define	CMDSIZE_TABLE   		0x20
d234 1
d238 3
a240 1
#define	MSG_OUT         		0x34
d242 5
a246 1
#define	DMAPARAMS       		0x35
d252 1
a253 1
#define		HDMAENACK       	0x08
d258 1
a258 1
#define	SEQ_FLAGS       		0x36
d260 1
a260 1
#define		SCBPTR_VALID    	0x40
d268 1
a268 1
#define	SAVED_TCL       		0x37
d270 1
a270 1
#define	SG_COUNT        		0x38
d272 2
a273 3
#define	SG_NEXT         		0x39

#define	LASTPHASE       		0x3d
a274 1
#define		PHASE_MASK      	0xe0
d285 1
a285 1
#define	WAITING_SCBH    		0x3e
d287 1
a287 1
#define	DISCONNECTED_SCBH		0x3f
d289 1
a289 1
#define	FREE_SCBH       		0x40
d291 1
a291 1
#define	HSCB_ADDR       		0x41
d293 1
a293 1
#define	SCBID_ADDR      		0x45
d295 1
a295 1
#define	TMODE_CMDADDR   		0x49
d297 1
a297 1
#define	KERNEL_QINPOS   		0x4d
d299 1
a299 1
#define	QINPOS          		0x4e
d301 1
a301 1
#define	QOUTPOS         		0x4f
d303 1
a303 1
#define	KERNEL_TQINPOS  		0x50
d305 1
a305 1
#define	TQINPOS         		0x51
d307 2
a308 2
#define	ARG_1           		0x52
#define	RETURN_1        		0x52
d317 2
a318 6
#define	ARG_2           		0x53
#define	RETURN_2        		0x53

#define	LAST_MSG        		0x54

#define	PREFETCH_CNT    		0x55
d320 1
a320 1
#define	TARGET_MSG_REQUEST		0x56
d322 1
a322 1
#define	SCSISEQ_TEMPLATE		0x58
d330 6
a335 1
#define	DATA_COUNT_ODD  		0x59
d344 3
a346 1
#define	INITIATOR_TAG   		0x5a
d380 2
a383 2
#define	NONE            		0x6a

d416 5
d423 1
d442 1
a443 1
#define		CHIPRSTACK      	0x01
d453 7
a459 7
#define		DATA_OVERRUN    	0xf1
#define		MSGIN_PHASEMIS  	0xe1
#define		TRACEPOINT      	0xd1
#define		PERR_DETECTED   	0xb1
#define		HOST_MSG_LOOP   	0xa1
#define		TRACE_POINT     	0x91
#define		RESIDUAL        	0x81
d461 3
a463 1
#define		UPDATE_TMSG_REQ 	0x61
d471 1
a472 8
#define		SEQINT          	0x01

#define	CLRINT          		0x92
#define		CLRPARERR       	0x10
#define		CLRBRKADRINT    	0x08
#define		CLRSCSIINT      	0x04
#define		CLRCMDINT       	0x02
#define		CLRSEQINT       	0x01
d484 7
d495 2
a496 1
#define		DWORDEMP        	0x20
d534 1
d541 4
a544 8
#define	SCB_CONTROL     		0xa0
#define		TARGET_SCB      	0x80
#define		DISCENB         	0x40
#define		TAG_ENB         	0x20
#define		MK_MESSAGE      	0x10
#define		ULTRAENB        	0x08
#define		DISCONNECTED    	0x04
#define		SCB_TAG_TYPE    	0x03
d548 1
a548 6
#define	SCB_TCL         		0xa1
#define		TID             	0xf0
#define		SELBUSB         	0x08
#define		LID             	0x07

#define	SCB_TARGET_STATUS		0xa2
d550 1
a550 1
#define	SCB_SGCOUNT     		0xa3
d552 1
a552 5
#define	SCB_SGPTR       		0xa4

#define	SCB_RESID_SGCNT 		0xa8

#define	SCB_RESID_DCNT  		0xa9
d557 7
d565 8
a572 3
#define	SCB_CMDPTR      		0xb4
#define	SCB_TARGET_PHASES		0xb4
#define		TARGET_DATA_IN  	0x01
d574 5
a578 2
#define	SCB_CMDLEN      		0xb8
#define	SCB_INITIATOR_TAG		0xb8
d580 2
a581 1
#define	SCB_TAG         		0xb9
d583 1
a583 1
#define	SCB_NEXT        		0xba
d585 1
a585 1
#define	SCB_SCSIRATE    		0xbb
d587 1
a587 1
#define	SCB_SCSIOFFSET  		0xbc
d589 1
a589 1
#define	SCB_SPARE       		0xbd
d591 1
a591 1
#define	SCB_CMDSTORE    		0xc0
d598 2
d606 1
a606 3
#define	SCB_CMDSTORE_BUSADDR		0xd0

#define	SCB_64BYTE_SPARE		0xd4
d619 1
a619 1
#define		FLAG            	0x02
d673 3
a675 2
#define	SG_CACHEPTR     		0xfc
#define		SG_USER_DATA    	0xfc
d679 2
d682 2
a685 1
#define	QOUTFIFO_OFFSET	0x00
d687 1
a687 1
#define	SCB_64BYTE_SIZE	0x30
a689 2
#define	TQINFIFO_UPDATE_CNT	0x20
#define	TCL_TARGET_SHIFT	0x04
d692 3
a694 2
#define	QINFIFO_OFFSET	0x01
#define	SCB_32BYTE_SIZE	0x1c
d696 4
a701 1
#define	UNTAGGEDSCB_OFFSET	0x02
d705 1
a706 2
#define	HOST_MSG	0xff
#define	BUS_32_BIT	0x02
d711 7
@


1.5.14.5
log
@Sync the SMP branch with 3.3
@
text
@a0 1
/* $OpenBSD$ */
d2 1
a2 5
 * DO NOT EDIT - This file is automatically generated
 *		 from the following source files:
 *
 * $Id$
 * $Id$
a25 9
#define	SCSISIGI        		0x03
#define		P_DATAIN_DT     	0x60
#define		P_DATAOUT_DT    	0x20
#define		ATNI            	0x10
#define		SELI            	0x08
#define		BSYI            	0x04
#define		REQI            	0x02
#define		ACKI            	0x01

d36 7
d48 1
a49 1
#define		SOFS            	0x0f
d59 2
a71 2
#define	STCNT           		0x08

a77 1
#define		CLRIOERR        	0x08
a112 1
#define		SHVALID         	0x40
a114 4
#define		CRCVALERR       	0x08
#define		CRCENDERR       	0x04
#define		CRCREQERR       	0x02
#define		DUAL_EDGE_ERR   	0x01
d121 1
d187 1
a188 1
#define		BRDCS           	0x08
d191 1
a192 1
#define		BRDRW_ULTRA2    	0x02
a210 1
#define		SELBUSB         	0x08
d215 2
a216 1
#define	BUSY_TARGETS    		0x20
d218 1
a220 1
#define	CMDSIZE_TABLE   		0x30
d224 1
a224 3
#define	CMDSIZE_TABLE_TAIL		0x34

#define	MWI_RESIDUAL    		0x38
d226 1
a226 5
#define	NEXT_QUEUED_SCB 		0x39

#define	MSG_OUT         		0x3a

#define	DMAPARAMS       		0x3b
d232 1
a233 1
#define		HDMAEN          	0x08
d238 1
a238 1
#define	SEQ_FLAGS       		0x3c
d240 1
a240 1
#define		TARGET_CMD_IS_TAGGED	0x40
d248 3
a250 1
#define	SAVED_SCSIID    		0x3d
d252 1
a252 1
#define	SAVED_LUN       		0x3e
d254 2
a255 1
#define	LASTPHASE       		0x3f
a256 1
#define		P_MESGIN        	0xe0
d267 1
a267 1
#define	WAITING_SCBH    		0x40
d269 1
a269 1
#define	DISCONNECTED_SCBH		0x41
d271 1
a271 1
#define	FREE_SCBH       		0x42
d273 1
a273 1
#define	COMPLETE_SCBH   		0x43
d275 1
a275 1
#define	HSCB_ADDR       		0x44
d277 1
a277 1
#define	SHARED_DATA_ADDR		0x48
d279 1
a279 1
#define	KERNEL_QINPOS   		0x4c
d281 1
a281 1
#define	QINPOS          		0x4d
d283 1
a283 1
#define	QOUTPOS         		0x4e
d285 1
a285 1
#define	KERNEL_TQINPOS  		0x4f
d287 1
a287 1
#define	TQINPOS         		0x50
d289 2
a290 2
#define	ARG_1           		0x51
#define	RETURN_1        		0x51
d299 6
a304 2
#define	ARG_2           		0x52
#define	RETURN_2        		0x52
d306 1
a306 1
#define	LAST_MSG        		0x53
d308 1
a308 1
#define	SCSISEQ_TEMPLATE		0x54
d316 1
a316 6
#define	DATA_COUNT_ODD  		0x55

#define	INITIATOR_TAG   		0x56

#define	SEQ_FLAGS2      		0x57
#define		SCB_DMA         	0x01
d325 1
a325 3
#define	INTDEF          		0x5c
#define		EDGE_TRIG       	0x80
#define		VECTOR          	0x0f
d359 2
a362 2
#define	ALLZEROS        		0x6a

a374 2
#define	SRAM_BASE       		0x70

a394 5
#define	DSCOMMAND1      		0x85
#define		DSLATT          	0xfc
#define		HADDLDSEL1      	0x02
#define		HADDLDSEL0      	0x01

a396 1
#define		DFTHRSH_75      	0x80
d415 1
a416 1
#define		CHIPRST         	0x01
d426 7
a432 7
#define		OUT_OF_RANGE    	0xe1
#define		NO_FREE_SCB     	0xd1
#define		SCB_MISMATCH    	0xc1
#define		MISSED_BUSFREE  	0xb1
#define		MKMSG_FAILED    	0xa1
#define		DATA_OVERRUN    	0x91
#define		PERR_DETECTED   	0x81
d434 1
a434 3
#define		HOST_MSG_LOOP   	0x61
#define		PDATA_REINIT    	0x51
#define		IGN_WIDE_RES    	0x41
d442 1
d444 7
a450 1
#define		BAD_PHASE       	0x01
a461 7
#define	CLRINT          		0x92
#define		CLRPARERR       	0x10
#define		CLRBRKADRINT    	0x08
#define		CLRSCSIINT      	0x04
#define		CLRCMDINT       	0x02
#define		CLRSEQINT       	0x01

d466 1
a466 2
#define		DFCACHETH       	0x40
#define		FIFOQWDEMP      	0x20
a503 1
#define		DATA_PHASE_MASK 	0x03
d510 8
a517 4
#define	SCB_CDB_PTR     		0xa0
#define	SCB_TARGET_INFO 		0xa0
#define	SCB_RESIDUAL_DATACNT		0xa0
#define	SCB_CDB_STORE   		0xa0
d521 8
a528 1
#define	SCB_RESIDUAL_SGPTR		0xa4
d530 1
a530 1
#define	SCB_SCSI_STATUS 		0xa8
d532 3
a534 1
#define	SCB_CDB_STORE_PAD		0xa9
a538 7
#define		SG_LAST_SEG     	0x80
#define		SG_HIGH_ADDR_BITS	0x7f

#define	SCB_SGPTR       		0xb4
#define		SG_RESID_VALID  	0x04
#define		SG_FULL_RESID   	0x02
#define		SG_LIST_NULL    	0x01
d540 3
a542 8
#define	SCB_CONTROL     		0xb8
#define		TARGET_SCB      	0x80
#define		DISCENB         	0x40
#define		TAG_ENB         	0x20
#define		MK_MESSAGE      	0x10
#define		ULTRAENB        	0x08
#define		DISCONNECTED    	0x04
#define		SCB_TAG_TYPE    	0x03
d544 2
a545 5
#define	SCB_SCSIID      		0xb9
#define		TID             	0xf0
#define		TWIN_CHNLB      	0x80
#define		TWIN_TID        	0x70
#define		OID             	0x0f
d547 1
a547 2
#define	SCB_LUN         		0xba
#define		LID             	0xff
d549 1
a549 1
#define	SCB_TAG         		0xbb
d551 1
a551 1
#define	SCB_CDB_LEN     		0xbc
d553 1
a553 1
#define	SCB_SCSIRATE    		0xbd
d555 1
a555 1
#define	SCB_SCSIOFFSET  		0xbe
d557 1
a557 1
#define	SCB_NEXT        		0xbf
a563 2
#define	SCB_64_SPARE    		0xc0

d570 3
a572 1
#define	SCB_64_BTT      		0xd0
d585 1
a585 1
#define		SG_FETCH_NEEDED 	0x02
d639 2
a640 3
#define	SG_CACHE_SHADOW 		0xfc
#define		SG_ADDR_MASK    	0xf8
#define		ODD_SEG         	0x04
a643 2
#define	SG_CACHE_PRE    		0xfc

a644 2
#define	HOST_MSG	0xff
#define	BUS_32_BIT	0x02
d647 1
d649 1
a649 1
#define	TARGET_DATA_IN	0x01
d652 2
d656 2
a657 3
#define	TID_SHIFT	0x04
#define	SCB_DOWNLOAD_SIZE_64	0x30
#define	SCB_UPLOAD_SIZE	0x20
a658 4
#define	SCB_INITIATOR_TAG	0x03
#define	SCB_TARGET_STATUS	0x02
#define	SCB_TARGET_DATA_DIR	0x01
#define	SCB_TARGET_PHASES	0x00
d661 1
a664 1
#define	SCB_DOWNLOAD_SIZE	0x20
d666 2
a671 11
#define	SG_PREFETCH_ADDR_MASK	0x06
#define	SG_PREFETCH_ALIGN_MASK	0x05
#define	QOUTFIFO_OFFSET	0x00
#define	SG_PREFETCH_CNT	0x04
#define	INVERTED_CACHESIZE_MASK	0x03
#define	CACHESIZE_MASK	0x02
#define	QINFIFO_OFFSET	0x01
#define	DOWNLOAD_CONST_COUNT	0xb003


/* Exported Labels */
@


1.5.14.6
log
@Merge of current from two weeks agointo the SMP branch
@
text
@d718 1
a718 1
#define	DOWNLOAD_CONST_COUNT	0x07
@


1.5.14.7
log
@Merge with the trunk
@
text
@d1 1
a1 1
/* $OpenBSD: aic7xxxreg.h,v 1.5.14.6 2004/02/19 10:56:17 niklas Exp $ */
d6 2
a7 2
 * $Id: aic7xxxreg.h,v 1.5.14.6 2004/02/19 10:56:17 niklas Exp $
 * $Id: aic7xxxreg.h,v 1.5.14.6 2004/02/19 10:56:17 niklas Exp $
@


1.4
log
@Adaption to new bus.h from NetBSD.  Various driver has been updated to
NetBSD 961107 state.  Other has not, partly because sometimes the bus.h
changes was coupled with other changes.
@
text
@d1 1
a1 1
/*	$OpenBSD: aic7xxxreg.h,v 1.3 1996/10/31 01:01:25 niklas Exp $	*/
d37 1
a37 1
 * All page numbers refer to the Adaptec AIC-7770 Data Book availible from
d107 1
a107 1
 * SCSI Contol Signal Write Register (p. 3-16).
d145 1
a145 1
 * Read/Write latchs used to transfer data on the SCSI bus during
d147 1
a147 1
 * upper byte of a 16bit wide asyncronouse data phase transfer.
d154 1
a154 1
 * These registers count down the number of bytes transfered
d156 1
a156 1
 * the data has been safely transfered.  SDONE in SSTAT0 is
d247 1
a247 1
 * can be squewed by write ahead.
d332 1
a332 1
 * to be transfered across the host bus.
d387 1
a387 1
 * Overal host control of the device.
d523 1
a523 1
 * "re-fetching" of transactions that are requed because the target is
d646 1
a646 1
 * The sequencer will stick the frist byte of any rejected message here so
d705 1
a705 1
					 * Two's compliment of SCBCOUNT
@


1.3
log
@$OpenBSD RCSIDs
@
text
@d1 2
a2 1
/*	$OpenBSD: aic7xxxreg.h,v 1.2 1996/06/27 21:15:49 shawn Exp $	*/
d410 1
a410 2
#define			SDTR_MSG	0x41	/* SDTR message received */
#define			WDTR_MSG	0x51	/* WDTR message received */
d529 1
a529 1
#define		NEEDWDTR        0x80
a531 1
#define		NEEDSDTR	0x10
a682 1
#define		MAXOFFSET	0x01
d684 1
a684 2
#define		SEND_WDTR	0x80
#define		SEND_SDTR	0x60
d746 13
a767 17

/* Message codes */
#define MSG_EXTENDED		0x01
#define		MSG_SDTR	0x01
#define		MSG_WDTR	0x03
#define MSG_SDPTRS		0x02
#define MSG_RDPTRS		0x03
#define MSG_DISCONNECT		0x04
#define MSG_INITIATOR_DET_ERROR	0x05
#define MSG_ABORT		0x06
#define	MSG_REJECT		0x07
#define MSG_NOP			0x08
#define MSG_MSG_PARITY_ERROR	0x09
#define MSG_BUS_DEVICE_RESET	0x0c
#define MSG_ABORT_TAG		0x0d
#define MSG_SIMPLE_TAG		0x20
#define MSG_IDENTIFY		0x80
@


1.2
log
@new 2940 driver merged from freebsd sources 960623
@
text
@d1 1
a30 2
 *
 *	$Id: aic7xxx_reg.h,v 1.12 1996/06/09 17:29:12 gibbs Exp $
@


1.1
log
@sync 0521
@
text
@a0 2
/*	$NetBSD: aic7xxxreg.h,v 1.2 1996/05/20 00:58:10 thorpej Exp $	*/

d30 2
d437 5
d747 2
@
