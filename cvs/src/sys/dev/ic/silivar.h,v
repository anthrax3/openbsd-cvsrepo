head	1.7;
access;
symbols
	OPENBSD_6_0:1.7.0.28
	OPENBSD_6_0_BASE:1.7
	OPENBSD_5_9:1.7.0.22
	OPENBSD_5_9_BASE:1.7
	OPENBSD_5_8:1.7.0.24
	OPENBSD_5_8_BASE:1.7
	OPENBSD_5_7:1.7.0.16
	OPENBSD_5_7_BASE:1.7
	OPENBSD_5_6:1.7.0.20
	OPENBSD_5_6_BASE:1.7
	OPENBSD_5_5:1.7.0.18
	OPENBSD_5_5_BASE:1.7
	OPENBSD_5_4:1.7.0.14
	OPENBSD_5_4_BASE:1.7
	OPENBSD_5_3:1.7.0.12
	OPENBSD_5_3_BASE:1.7
	OPENBSD_5_2:1.7.0.8
	OPENBSD_5_2_BASE:1.7
	OPENBSD_5_1_BASE:1.7
	OPENBSD_5_1:1.7.0.10
	OPENBSD_5_0:1.7.0.6
	OPENBSD_5_0_BASE:1.7
	OPENBSD_4_9:1.7.0.4
	OPENBSD_4_9_BASE:1.7
	OPENBSD_4_8:1.7.0.2
	OPENBSD_4_8_BASE:1.7
	OPENBSD_4_7:1.6.0.4
	OPENBSD_4_7_BASE:1.6
	OPENBSD_4_6:1.6.0.6
	OPENBSD_4_6_BASE:1.6
	OPENBSD_4_5:1.6.0.2
	OPENBSD_4_5_BASE:1.6
	OPENBSD_4_4:1.5.0.6
	OPENBSD_4_4_BASE:1.5
	OPENBSD_4_3:1.5.0.4
	OPENBSD_4_3_BASE:1.5
	OPENBSD_4_2:1.5.0.2
	OPENBSD_4_2_BASE:1.5;
locks; strict;
comment	@ * @;


1.7
date	2010.08.05.20.21.36;	author kettenis;	state Exp;
branches;
next	1.6;

1.6
date	2008.11.23.12.46.51;	author dlg;	state Exp;
branches;
next	1.5;

1.5
date	2007.04.07.05.59.49;	author dlg;	state Exp;
branches;
next	1.4;

1.4
date	2007.03.31.03.59.53;	author dlg;	state Exp;
branches;
next	1.3;

1.3
date	2007.03.30.04.50.54;	author dlg;	state Exp;
branches;
next	1.2;

1.2
date	2007.03.22.06.32.14;	author dlg;	state Exp;
branches;
next	1.1;

1.1
date	2007.03.22.02.48.42;	author dlg;	state Exp;
branches;
next	;


desc
@@


1.7
log
@Suspend/resume support for sili(4).  Not perfect yet, but prevents us from
getting stuck.  Based on an initial diff from deraadt@@.
@
text
@/*	$OpenBSD: silivar.h,v 1.6 2008/11/23 12:46:51 dlg Exp $ */

/*
 * Copyright (c) 2007 David Gwynne <dlg@@openbsd.org>
 *
 * Permission to use, copy, modify, and distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 */

struct sili_port;

struct sili_softc {
	struct device		sc_dev;

	bus_dma_tag_t		sc_dmat;

	bus_space_tag_t		sc_iot_global;
	bus_space_handle_t	sc_ioh_global;
	bus_size_t		sc_ios_global;

	bus_space_tag_t		sc_iot_port;
	bus_space_handle_t	sc_ioh_port;
	bus_size_t		sc_ios_port;

	u_int			sc_nports;
	struct sili_port	*sc_ports;

	struct atascsi		*sc_atascsi;
};
#define DEVNAME(_sc)	((_sc)->sc_dev.dv_xname)

int	sili_attach(struct sili_softc *);
int	sili_detach(struct sili_softc *, int);

void	sili_resume(struct sili_softc *);

int	sili_intr(void *);
@


1.6
log
@sizeofa -> nitems
@
text
@d1 1
a1 1
/*	$OpenBSD: silivar.h,v 1.5 2007/04/07 05:59:49 dlg Exp $ */
d43 2
@


1.5
log
@sizeofa will give us the number of elements in an array. use it when
iterating over the pci device ids.
@
text
@d1 1
a1 1
/*	$OpenBSD: silivar.h,v 1.4 2007/03/31 03:59:53 dlg Exp $ */
a17 2

#define sizeofa(_a)	(sizeof(_a) / sizeof((_a)[0]))
@


1.4
log
@initial atascsi glue.
@
text
@d1 1
a1 1
/*	$OpenBSD: silivar.h,v 1.3 2007/03/30 04:50:54 dlg Exp $ */
d18 2
@


1.3
log
@start filling out stuff for managing each port. this allocates it, set a
register window up, and provides access to the port registers.
@
text
@d1 1
a1 1
/*	$OpenBSD: silivar.h,v 1.2 2007/03/22 06:32:14 dlg Exp $ */
d37 1
@


1.2
log
@map the global and port register spaces.
@
text
@d1 1
a1 1
/*	$OpenBSD: silivar.h,v 1.1 2007/03/22 02:48:42 dlg Exp $ */
d19 2
d33 4
@


1.1
log
@import sili(4) so it can be worked on in the tree. this will support the
silicon image 3124/3132/3531 sata chipsets eventually.

so far this is the autoconf glue, an actual match routine for the 3124, and
interrupt establishment code. it is split up between pci and ic cos there
are cardbus variants of these controllers that we can support in the
future.

thanks to jolan@@ for the name, it was better liked than my initial
suggestion of siisl(4).
@
text
@d1 1
a1 1
/*	$OpenBSD$ */
a21 3
	bus_space_tag_t		sc_iot;
	bus_space_handle_t	sc_ioh;
	bus_size_t		sc_ios;
d23 8
@

