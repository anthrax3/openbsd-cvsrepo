head	1.16;
access;
symbols
	OPENBSD_6_2:1.16.0.26
	OPENBSD_6_2_BASE:1.16
	OPENBSD_6_1:1.16.0.30
	OPENBSD_6_1_BASE:1.16
	OPENBSD_6_0:1.16.0.28
	OPENBSD_6_0_BASE:1.16
	OPENBSD_5_9:1.16.0.22
	OPENBSD_5_9_BASE:1.16
	OPENBSD_5_8:1.16.0.24
	OPENBSD_5_8_BASE:1.16
	OPENBSD_5_7:1.16.0.16
	OPENBSD_5_7_BASE:1.16
	OPENBSD_5_6:1.16.0.20
	OPENBSD_5_6_BASE:1.16
	OPENBSD_5_5:1.16.0.18
	OPENBSD_5_5_BASE:1.16
	OPENBSD_5_4:1.16.0.14
	OPENBSD_5_4_BASE:1.16
	OPENBSD_5_3:1.16.0.12
	OPENBSD_5_3_BASE:1.16
	OPENBSD_5_2:1.16.0.10
	OPENBSD_5_2_BASE:1.16
	OPENBSD_5_1_BASE:1.16
	OPENBSD_5_1:1.16.0.8
	OPENBSD_5_0:1.16.0.6
	OPENBSD_5_0_BASE:1.16
	OPENBSD_4_9:1.16.0.4
	OPENBSD_4_9_BASE:1.16
	OPENBSD_4_8:1.16.0.2
	OPENBSD_4_8_BASE:1.16
	OPENBSD_4_7:1.14.0.2
	OPENBSD_4_7_BASE:1.14
	OPENBSD_4_6:1.13.0.8
	OPENBSD_4_6_BASE:1.13
	OPENBSD_4_5:1.13.0.4
	OPENBSD_4_5_BASE:1.13
	OPENBSD_4_4:1.13.0.2
	OPENBSD_4_4_BASE:1.13
	OPENBSD_4_3:1.10.0.8
	OPENBSD_4_3_BASE:1.10
	OPENBSD_4_2:1.10.0.6
	OPENBSD_4_2_BASE:1.10
	OPENBSD_4_1:1.10.0.2
	OPENBSD_4_1_BASE:1.10
	OPENBSD_4_0:1.10.0.4
	OPENBSD_4_0_BASE:1.10
	OPENBSD_3_9:1.9.0.20
	OPENBSD_3_9_BASE:1.9
	OPENBSD_3_8:1.9.0.18
	OPENBSD_3_8_BASE:1.9
	OPENBSD_3_7:1.9.0.14
	OPENBSD_3_7_BASE:1.9
	OPENBSD_3_6:1.9.0.16
	OPENBSD_3_6_BASE:1.9
	SMP_SYNC_A:1.9
	SMP_SYNC_B:1.9
	OPENBSD_3_5:1.9.0.12
	OPENBSD_3_5_BASE:1.9
	OPENBSD_3_4:1.9.0.10
	OPENBSD_3_4_BASE:1.9
	UBC_SYNC_A:1.9
	OPENBSD_3_3:1.9.0.8
	OPENBSD_3_3_BASE:1.9
	OPENBSD_3_2:1.9.0.6
	OPENBSD_3_2_BASE:1.9
	OPENBSD_3_1:1.9.0.4
	OPENBSD_3_1_BASE:1.9
	UBC_SYNC_B:1.9
	UBC:1.9.0.2
	UBC_BASE:1.9
	OPENBSD_3_0:1.8.0.2
	OPENBSD_3_0_BASE:1.8
	OPENBSD_2_9_BASE:1.7
	OPENBSD_2_9:1.7.0.2
	OPENBSD_2_8:1.5.0.2
	OPENBSD_2_8_BASE:1.5
	OPENBSD_2_7:1.4.0.2
	OPENBSD_2_7_BASE:1.4
	SMP:1.2.0.2
	SMP_BASE:1.2
	kame_19991208:1.2
	OPENBSD_2_6:1.1.0.2
	OPENBSD_2_6_BASE:1.1;
locks; strict;
comment	@ * @;


1.16
date	2010.07.19.05.08.37;	author jakemsr;	state Exp;
branches;
next	1.15;

1.15
date	2010.04.07.20.52.56;	author sthen;	state Exp;
branches;
next	1.14;

1.14
date	2009.10.17.07.10.38;	author jakemsr;	state Exp;
branches;
next	1.13;

1.13
date	2008.06.29.10.04.15;	author yuo;	state Exp;
branches;
next	1.12;

1.12
date	2008.06.26.05.42.19;	author ray;	state Exp;
branches;
next	1.11;

1.11
date	2008.05.08.13.57.43;	author miod;	state Exp;
branches;
next	1.10;

1.10
date	2006.05.14.12.00.04;	author matthieu;	state Exp;
branches;
next	1.9;

1.9
date	2001.10.31.04.24.44;	author nate;	state Exp;
branches;
next	1.8;

1.8
date	2001.05.03.02.20.34;	author aaron;	state Exp;
branches;
next	1.7;

1.7
date	2001.01.28.09.43.42;	author aaron;	state Exp;
branches;
next	1.6;

1.6
date	2000.11.08.18.10.39;	author aaron;	state Exp;
branches;
next	1.5;

1.5
date	2000.07.04.11.44.25;	author fgsch;	state Exp;
branches;
next	1.4;

1.4
date	2000.03.28.19.37.51;	author aaron;	state Exp;
branches;
next	1.3;

1.3
date	2000.03.26.08.39.46;	author aaron;	state Exp;
branches;
next	1.2;

1.2
date	99.11.07.21.30.19;	author fgsch;	state Exp;
branches
	1.2.2.1;
next	1.1;

1.1
date	99.08.13.05.28.04;	author fgsch;	state Exp;
branches;
next	;

1.2.2.1
date	2001.05.14.22.26.24;	author niklas;	state Exp;
branches;
next	1.2.2.2;

1.2.2.2
date	2001.07.04.10.44.01;	author niklas;	state Exp;
branches;
next	1.2.2.3;

1.2.2.3
date	2001.11.13.21.10.04;	author niklas;	state Exp;
branches;
next	;


desc
@@


1.16
log
@move audio specific quirks out of usb_quirks and into uaudio

ok krw
@
text
@/*	$OpenBSD: usb_quirks.h,v 1.15 2010/04/07 20:52:56 sthen Exp $ */
/*	$NetBSD: usb_quirks.h,v 1.20 2001/04/15 09:38:01 augustss Exp $	*/
/*	$FreeBSD: src/sys/dev/usb/usb_quirks.h,v 1.9 1999/11/12 23:31:03 n_hibma Exp $	*/

/*
 * Copyright (c) 1998 The NetBSD Foundation, Inc.
 * All rights reserved.
 *
 * This code is derived from software contributed to The NetBSD Foundation
 * by Lennart Augustsson (lennart@@augustsson.net) at
 * Carlstedt Research & Technology.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 *
 * THIS SOFTWARE IS PROVIDED BY THE NETBSD FOUNDATION, INC. AND CONTRIBUTORS
 * ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED
 * TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE FOUNDATION OR CONTRIBUTORS
 * BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 * POSSIBILITY OF SUCH DAMAGE.
 */

struct usbd_quirks {
	u_int32_t uq_flags;	/* Device problems: */
#define UQ_NO_SET_PROTO		0x00000001 /* cannot handle SET PROTOCOL */
#define UQ_SWAP_UNICODE		0x00000002 /* some Unicode strings swapped */
#define UQ_MS_REVZ		0x00000004 /* mouse has Z-axis reversed */
#define UQ_NO_STRINGS		0x00000008 /* string descriptors are broken */
#define UQ_BUS_POWERED		0x00000020 /* is bus-powered, despite claim */
#define UQ_SPUR_BUT_UP		0x00000080 /* spurious mouse button up events */
#define UQ_POWER_CLAIM		0x00000200 /* hub lies about power status */
#define UQ_ASSUME_CM_OVER_DATA	0x00001000 /* modem device breaks on cm
						over data */
#define UQ_BROKEN_BIDIR		0x00002000 /* printer has broken bidir mode */
#define UQ_BAD_HID		0x00004000 /* device claims uhid, but isn't */
#define UQ_MS_BAD_CLASS		0x00008000 /* mouse doesn't identify properly */
#define UQ_MS_LEADING_BYTE	0x00010000 /* mouse sends unknown leading byte */
#define UQ_EHCI_NEEDTO_DISOWN	0x00020000 /* must hand device over to USB 1.1
						if attached to EHCI */
};

extern const struct usbd_quirks usbd_no_quirk;

const struct usbd_quirks *usbd_find_quirk(usb_device_descriptor_t *);
@


1.15
log
@Move descriptive comments right onto the line with the definition
to ease grepping, rewording them slightly to mostly fit onto 1 line
and to clarify UQ_EHCI_NEEDTO_DISOWN.  ok deraadt@@
@
text
@d1 1
a1 1
/*	$OpenBSD: usb_quirks.h,v 1.14 2009/10/17 07:10:38 jakemsr Exp $ */
a40 1
#define UQ_BAD_ADC		0x00000010 /* bad audio spec version number */
a41 1
#define UQ_BAD_AUDIO		0x00000040 /* claims audio class, but isn't */
a42 2
#define UQ_AU_NO_XU		0x00000100 /* audio device has broken
						extension unit */
a43 2
#define UQ_AU_NO_FRAC		0x00000400 /* don't adjust for fractional
						samples */
@


1.14
log
@remove bogus quirk.  these devices do not lie about their type, but
they do have bSynchAddress set to 0 in their endpoint descriptor.
uaudio(4) used to not handle that correctly, but now does.

positive response from krw, deraadt, ratchov
@
text
@d1 1
a1 1
/*	$OpenBSD: usb_quirks.h,v 1.13 2008/06/29 10:04:15 yuo Exp $ */
d37 21
a57 34
	/* cannot handle SET PROTOCOL. */
#define UQ_NO_SET_PROTO		0x00000001
	/* has some Unicode strings swapped. */
#define UQ_SWAP_UNICODE		0x00000002
	/* mouse has Z-axis reversed */
#define UQ_MS_REVZ		0x00000004
	/* string descriptors are broken. */
#define UQ_NO_STRINGS		0x00000008
	/* bad audio spec version number. */
#define UQ_BAD_ADC		0x00000010
	/* device is bus powered, despite claim */
#define UQ_BUS_POWERED		0x00000020
	/* device claims audio class, but isn't */
#define UQ_BAD_AUDIO		0x00000040
	/* spurious mouse button up events */
#define UQ_SPUR_BUT_UP		0x00000080
	/* audio device has broken extension unit */
#define UQ_AU_NO_XU		0x00000100
	/* hub lies about power status */
#define UQ_POWER_CLAIM		0x00000200
	/* don't adjust for fractional samples */
#define UQ_AU_NO_FRAC		0x00000400
	/* modem device breaks on cm over data */
#define UQ_ASSUME_CM_OVER_DATA	0x00001000
	/* printer has broken bidir mode */
#define UQ_BROKEN_BIDIR		0x00002000
	/* device claims uhid, but isn't */
#define UQ_BAD_HID		0x00004000
	/* doesn't identify properly */
#define UQ_MS_BAD_CLASS		0x00008000
	/* mouse sends an unknown leading byte. */
#define UQ_MS_LEADING_BYTE	0x00010000
	/* need to attach as 1.1 device if it is 2.0 */
#define UQ_EHCI_NEEDTO_DISOWN	0x00020000
@


1.13
log
@add usb2.0 to usb1.1(ohci/uchi) handover request to usb subsystem.
add new quirk entry for uvideo which is required isoc transfer.

Some usb2.0 devices use isochronous transfer but current usb
subsystem does not support isoc transfer in ehci(usb2.0) bus.
This patch introduce new psuedo usb hub request UHF_PORT_DISOWN_TO_1_1
to handover the device to ehci to usb1.1 bus(ohci or uhci).

ok mglocker@@ deraadt@@ fgsch@@
@
text
@d1 1
a1 1
/*	$OpenBSD: usb_quirks.h,v 1.12 2008/06/26 05:42:19 ray Exp $ */
a58 2
	/* input is async despite claim of adaptive */
#define UQ_AU_INP_ASYNC		0x00000800
@


1.12
log
@First pass at removing clauses 3 and 4 from NetBSD licenses.

Not sure what's more surprising: how long it took for NetBSD to
catch up to the rest of the BSDs (including UCB), or the amount of
code that NetBSD has claimed for itself without attributing to the
actual authors.

OK deraadt@@
@
text
@d1 1
a1 1
/*	$OpenBSD: usb_quirks.h,v 1.11 2008/05/08 13:57:43 miod Exp $ */
d71 2
@


1.11
log
@Add support for Microsoft Wireless Intellimouse, from FreeBSD. Not only does
this device bends the uhid specs backwards, it is also completely unusable
for left-handed people due to its shape.

Tested on actual hardware thanks to a donation from Maxim Belooussov.
@
text
@d1 1
a1 1
/*	$OpenBSD: usb_quirks.h,v 1.10 2006/05/14 12:00:04 matthieu Exp $ */
a20 7
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 *        This product includes software developed by the NetBSD
 *        Foundation, Inc. and its contributors.
 * 4. Neither the name of The NetBSD Foundation nor the names of its
 *    contributors may be used to endorse or promote products derived
 *    from this software without specific prior written permission.
@


1.10
log
@Add a quirk to force the Wi-spy spectrum analyser to attach as ugen.
It claims to be a HID device, but it's not really one. ok miod@@, jsg@@.
@
text
@d1 1
a1 1
/*	$OpenBSD: usb_quirks.h,v 1.9 2001/10/31 04:24:44 nate Exp $ */
d44 34
a77 15
#define UQ_NO_SET_PROTO	0x0001	/* cannot handle SET PROTOCOL. */
#define UQ_SWAP_UNICODE	0x0002	/* has some Unicode strings swapped. */
#define UQ_MS_REVZ	0x0004	/* mouse has Z-axis reversed */
#define UQ_NO_STRINGS	0x0008	/* string descriptors are broken. */
#define UQ_BAD_ADC	0x0010	/* bad audio spec version number. */
#define UQ_BUS_POWERED	0x0020	/* device is bus powered, despite claim */
#define UQ_BAD_AUDIO	0x0040	/* device claims audio class, but isn't */
#define UQ_SPUR_BUT_UP	0x0080	/* spurious mouse button up events */
#define UQ_AU_NO_XU	0x0100	/* audio device has broken extension unit */
#define UQ_POWER_CLAIM	0x0200	/* hub lies about power status */
#define UQ_AU_NO_FRAC	0x0400	/* don't adjust for fractional samples */
#define UQ_AU_INP_ASYNC	0x0800	/* input is async despite claim of adaptive */
#define UQ_ASSUME_CM_OVER_DATA 0x1000 /* modem device breaks on cm over data */
#define UQ_BROKEN_BIDIR	0x2000	/* printer has broken bidir mode */
#define UQ_BAD_HID	0x4000	/* device claims uhid, but isn't */
@


1.9
log
@Synchronize usb code with NetBSD.
@
text
@d1 1
a1 1
/*	$OpenBSD: usb_quirks.h,v 1.8 2001/05/03 02:20:34 aaron Exp $ */
d58 1
@


1.8
log
@Sync with NetBSD. Tested with a USB keyboard, USB mouse, and three different
kue(4) Ethernet devices.
@
text
@d1 1
a1 1
/*	$OpenBSD: usb_quirks.h,v 1.7 2001/01/28 09:43:42 aaron Exp $ */
d57 1
a57 1
#define UQ_BROKEN_BIDIR	       0x2000	/* printer has broken bidir mode */
@


1.7
log
@Another USB sync with NetBSD. We are still lacking an up-to-date umass(4)
driver. I would appreciate it if someone with the hardware looked into it.
I also have to take a closer look at changes to the USB Ethernet drivers,
as well as import some drivers we are missing (uftdi, if_upl, yap, etc.)
@
text
@d1 2
a2 2
/*	$OpenBSD: usb_quirks.h,v 1.6 2000/11/08 18:10:39 aaron Exp $ */
/*	$NetBSD: usb_quirks.h,v 1.15 2000/10/24 14:56:09 augustss Exp $	*/
d57 1
@


1.6
log
@Sync with NetBSD. Too many changes to mention. For now I have skipped
umass.c and ukbd.c as the diffs are a bit hairier.
@
text
@d1 1
a1 1
/*	$OpenBSD: usb_quirks.h,v 1.5 2000/07/04 11:44:25 fgsch Exp $ */
d52 5
a56 3
#define UQ_NO_XU	0x0100	/* audio device has broken extension unit */
#define UQ_ASSUME_CM_OVER_DATA 0x0200 /* modem device breaks on cm over data */
#define UQ_POWER_CLAIM	0x0400	/* hub lies about power status */
d59 1
a59 1
extern struct usbd_quirks usbd_no_quirk;
d61 1
a61 1
struct usbd_quirks *usbd_find_quirk(usb_device_descriptor_t *);
@


1.5
log
@sync with NetBSD... well almost. someone w/ the hw should check umass.
@
text
@d1 2
a2 2
/*	$OpenBSD: usb_quirks.h,v 1.4 2000/03/28 19:37:51 aaron Exp $ */
/*	$NetBSD: usb_quirks.h,v 1.10 1999/11/18 23:32:31 augustss Exp $	*/
d44 11
a54 8
#define UQ_NO_SET_PROTO	0x01	/* cannot handle SET PROTOCOL. */
#define UQ_SWAP_UNICODE	0x02	/* has some Unicode strings swapped. */
#define UQ_MS_REVZ	0x04	/* mouse has Z-axis reversed */
#define UQ_NO_STRINGS	0x08	/* string descriptors are broken. */
#define UQ_BAD_ADC	0x10	/* bad audio spec version number. */
#define UQ_BUS_POWERED	0x20	/* device is bus powered, despite claim */
#define UQ_BAD_AUDIO	0x40	/* device claims audio class, but isn't */
#define UQ_SPUR_BUT_UP	0x80	/* spurious mouse button up events */
d59 1
a59 1
struct usbd_quirks *usbd_find_quirk __P((usb_device_descriptor_t *));
@


1.4
log
@Much cleaner sync with NetBSD. Some #if defined() magic has been sent in the
form of a diff to augustss@@netbsd.org so that future syncs will be very easy.
This commit also adds support for ADMtek AN986 "Pegasus" based USB Ethernet,
CATC USB-EL1210A based USB Ethernet, and USB Printers (all untested).
@
text
@d1 1
a1 1
/*	$OpenBSD$ */
d10 1
a10 1
 * by Lennart Augustsson (augustss@@carlstedt.se) at
@


1.3
log
@Sync with NetBSD.
@
text
@d1 1
a1 1
/*	$OpenBSD: usb_quirks.h,v 1.2 1999/11/07 21:30:19 fgsch Exp $	*/
d3 1
@


1.2
log
@sync with NetBSD.
@
text
@d1 2
a2 2
/*	$OpenBSD$	*/
/*	$NetBSD: usb_quirks.h,v 1.8 1999/10/11 09:16:39 augustss Exp $	*/
d49 2
@


1.2.2.1
log
@merge in approximately 2.9 into SMP branch
@
text
@d1 2
a2 3
/*	$OpenBSD: usb_quirks.h,v 1.7 2001/01/28 09:43:42 aaron Exp $ */
/*	$NetBSD: usb_quirks.h,v 1.15 2000/10/24 14:56:09 augustss Exp $	*/
/*	$FreeBSD: src/sys/dev/usb/usb_quirks.h,v 1.9 1999/11/12 23:31:03 n_hibma Exp $	*/
d9 1
a9 1
 * by Lennart Augustsson (lennart@@augustsson.net) at
d43 6
a48 13
#define UQ_NO_SET_PROTO	0x0001	/* cannot handle SET PROTOCOL. */
#define UQ_SWAP_UNICODE	0x0002	/* has some Unicode strings swapped. */
#define UQ_MS_REVZ	0x0004	/* mouse has Z-axis reversed */
#define UQ_NO_STRINGS	0x0008	/* string descriptors are broken. */
#define UQ_BAD_ADC	0x0010	/* bad audio spec version number. */
#define UQ_BUS_POWERED	0x0020	/* device is bus powered, despite claim */
#define UQ_BAD_AUDIO	0x0040	/* device claims audio class, but isn't */
#define UQ_SPUR_BUT_UP	0x0080	/* spurious mouse button up events */
#define UQ_AU_NO_XU	0x0100	/* audio device has broken extension unit */
#define UQ_POWER_CLAIM	0x0200	/* hub lies about power status */
#define UQ_AU_NO_FRAC	0x0400	/* don't adjust for fractional samples */
#define UQ_AU_INP_ASYNC	0x0800	/* input is async despite claim of adaptive */
#define UQ_ASSUME_CM_OVER_DATA 0x1000 /* modem device breaks on cm over data */
d51 1
a51 1
extern const struct usbd_quirks usbd_no_quirk;
d53 1
a53 1
const struct usbd_quirks *usbd_find_quirk(usb_device_descriptor_t *);
@


1.2.2.2
log
@Merge in -current from two days ago in the SMP branch.
As usual with merges, they do not indicate progress, so do not hold
your breath for working SMP, and do not mail me and ask about the
state of it.  It has not changed.  There is work ongoing, but very, very
slowly.  The commit is done in parts as to not lock up the tree in too
big chunks at a time.
@
text
@d1 2
a2 2
/*	$OpenBSD$ */
/*	$NetBSD: usb_quirks.h,v 1.20 2001/04/15 09:38:01 augustss Exp $	*/
a56 1
#define UQ_BROKEN_BIDIR	       0x2000	/* printer has broken bidir mode */
@


1.2.2.3
log
@Merge in -current
@
text
@d57 1
a57 1
#define UQ_BROKEN_BIDIR	0x2000	/* printer has broken bidir mode */
@


1.1
log
@From NetBSD; USB support.
@
text
@d2 1
a2 1
/*	$NetBSD: usb_quirks.h,v 1.7 1999/06/26 00:09:15 augustss Exp $	*/
d48 1
@

