head	1.4;
access;
symbols
	OPENBSD_5_8:1.3.0.10
	OPENBSD_5_8_BASE:1.3
	OPENBSD_5_7:1.3.0.2
	OPENBSD_5_7_BASE:1.3
	OPENBSD_5_6:1.3.0.6
	OPENBSD_5_6_BASE:1.3
	OPENBSD_5_5:1.3.0.4
	OPENBSD_5_5_BASE:1.3
	OPENBSD_5_4:1.2.0.10
	OPENBSD_5_4_BASE:1.2
	OPENBSD_5_3:1.2.0.8
	OPENBSD_5_3_BASE:1.2
	OPENBSD_5_2:1.2.0.6
	OPENBSD_5_2_BASE:1.2
	OPENBSD_5_1_BASE:1.2
	OPENBSD_5_1:1.2.0.4
	OPENBSD_5_0:1.2.0.2
	OPENBSD_5_0_BASE:1.2
	OPENBSD_4_9:1.1.0.4
	OPENBSD_4_9_BASE:1.1
	OPENBSD_4_8:1.1.0.2
	OPENBSD_4_8_BASE:1.1;
locks; strict;
comment	@ * @;


1.4
date	2016.01.08.15.54.14;	author jcs;	state dead;
branches;
next	1.3;
commitid	kI4H556ZKYkRQGw5;

1.3
date	2013.08.09.22.10.17;	author edd;	state Exp;
branches;
next	1.2;

1.2
date	2011.03.04.23.57.52;	author kettenis;	state Exp;
branches;
next	1.1;

1.1
date	2010.07.31.16.04.50;	author miod;	state Exp;
branches;
next	;


desc
@@


1.4
log
@Move HID support files out of dev/usb into new dev/hid directory

These files aren't USB-specific and were used by the previous
Bluetooth implementation, and will be used by the upcoming
HID-over-i2C implementation

ok deraadt
previous version ok kettenis and mpi
@
text
@/*	$OpenBSD: hidmsvar.h,v 1.3 2013/08/09 22:10:17 edd Exp $ */
/*	$NetBSD: ums.c,v 1.60 2003/03/11 16:44:00 augustss Exp $	*/

/*
 * Copyright (c) 1998 The NetBSD Foundation, Inc.
 * All rights reserved.
 *
 * This code is derived from software contributed to The NetBSD Foundation
 * by Lennart Augustsson (lennart@@augustsson.net) at
 * Carlstedt Research & Technology.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 *
 * THIS SOFTWARE IS PROVIDED BY THE NETBSD FOUNDATION, INC. AND CONTRIBUTORS
 * ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED
 * TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE FOUNDATION OR CONTRIBUTORS
 * BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 * POSSIBILITY OF SUCH DAMAGE.
 */

#define MAX_BUTTONS	31	/* must not exceed size of sc_buttons */

struct tsscale {
	int	minx, maxx;
	int	miny, maxy;
	int	swapxy;
	int	resx, resy;
};

struct hidms {
	int		sc_enabled;
	int		sc_flags;	/* device configuration */
#define HIDMS_SPUR_BUT_UP	0x001	/* spurious button up events */
#define HIDMS_Z			0x002	/* Z direction available */
#define HIDMS_REVZ		0x004	/* Z-axis is reversed */
#define HIDMS_W			0x008	/* W direction available */
#define HIDMS_REVW		0x010	/* W-axis is reversed */
#define HIDMS_LEADINGBYTE	0x020	/* Unknown leading byte */
#define HIDMS_ABSX		0x040	/* X-axis is absolute */
#define HIDMS_ABSY		0x080	/* Y-axis is absolute */
#define HIDMS_TIP		0x100   /* Tip switch on a digitiser pen */
#define HIDMS_BARREL		0x200	/* Barrel switch on a digitiser pen */
#define HIDMS_ERASER		0x400   /* Eraser switch on a digitiser pen */

	int		sc_num_buttons;
	u_int32_t	sc_buttons;	/* mouse button status */

	struct device	*sc_device;
	struct device	*sc_wsmousedev;

	/* locators */
	struct hid_location sc_loc_x;
	struct hid_location sc_loc_y;
	struct hid_location sc_loc_z;
	struct hid_location sc_loc_w;
	struct hid_location sc_loc_btn[MAX_BUTTONS];

	struct tsscale	sc_tsscale;
	int		sc_rawmode;
};

void	hidms_attach(struct hidms *, const struct wsmouse_accessops *);
int	hidms_detach(struct hidms *, int);
void	hidms_disable(struct hidms *);
int	hidms_enable(struct hidms *);
void	hidms_input(struct hidms *, uint8_t *, u_int);
int	hidms_ioctl(struct hidms *, u_long, caddr_t, int, struct proc *);
int	hidms_setup(struct device *, struct hidms *, uint32_t, int, void *,
	    int);
@


1.3
log
@Merge uhts(1) into ums(1). The code is amost the same, so no need to duplicate.

A part of ongoing work to improve touchscreen/digitiser support.

A diff will follow shortly to remove uhts(1).

OK matthieu@@, with input from mpi@@
@
text
@d1 1
a1 1
/*	$OpenBSD: hidmsvar.h,v 1.2 2011/03/04 23:57:52 kettenis Exp $ */
@


1.2
log
@Add TouchScreen support.  Makes newer Gunze USB TouchScreen devices work.

ok deraadt@@
@
text
@d1 1
a1 1
/*	$OpenBSD: hidmsvar.h,v 1.1 2010/07/31 16:04:50 miod Exp $ */
d46 11
a56 8
#define HIDMS_SPUR_BUT_UP	0x01	/* spurious button up events */
#define HIDMS_Z			0x02	/* Z direction available */
#define HIDMS_REVZ		0x04	/* Z-axis is reversed */
#define HIDMS_W			0x08	/* W direction available */
#define HIDMS_REVW		0x10	/* W-axis is reversed */
#define HIDMS_LEADINGBYTE	0x20	/* Unknown leading byte */
#define HIDMS_ABSX		0x40	/* X-axis is absolute */
#define HIDMS_ABSY		0x80	/* Y-axis is absolute */
@


1.1
log
@Factorization of the bluetooth and usb hid input driver logic, to reduce code
duplication and divergence.
Thanks to mlarkin@@ for bluetooth devices tests.
@
text
@d1 1
a1 1
/*	$OpenBSD: ums.c,v 1.31 2009/10/13 19:33:19 pirofti Exp $ */
d36 7
d52 2
d67 3
@

