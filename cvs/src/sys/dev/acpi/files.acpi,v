head	1.37;
access;
symbols
	OPENBSD_6_1:1.37.0.4
	OPENBSD_6_1_BASE:1.37
	OPENBSD_6_0:1.33.0.2
	OPENBSD_6_0_BASE:1.33
	OPENBSD_5_9:1.30.0.2
	OPENBSD_5_9_BASE:1.30
	OPENBSD_5_8:1.27.0.10
	OPENBSD_5_8_BASE:1.27
	OPENBSD_5_7:1.27.0.8
	OPENBSD_5_7_BASE:1.27
	OPENBSD_5_6:1.27.0.6
	OPENBSD_5_6_BASE:1.27
	OPENBSD_5_5:1.27.0.4
	OPENBSD_5_5_BASE:1.27
	OPENBSD_5_4:1.26.0.10
	OPENBSD_5_4_BASE:1.26
	OPENBSD_5_3:1.26.0.8
	OPENBSD_5_3_BASE:1.26
	OPENBSD_5_2:1.26.0.6
	OPENBSD_5_2_BASE:1.26
	OPENBSD_5_1_BASE:1.26
	OPENBSD_5_1:1.26.0.4
	OPENBSD_5_0:1.26.0.2
	OPENBSD_5_0_BASE:1.26
	OPENBSD_4_9:1.25.0.2
	OPENBSD_4_9_BASE:1.25
	OPENBSD_4_8:1.24.0.2
	OPENBSD_4_8_BASE:1.24
	OPENBSD_4_7:1.23.0.2
	OPENBSD_4_7_BASE:1.23
	OPENBSD_4_6:1.22.0.4
	OPENBSD_4_6_BASE:1.22
	OPENBSD_4_5:1.20.0.4
	OPENBSD_4_5_BASE:1.20
	OPENBSD_4_4:1.20.0.2
	OPENBSD_4_4_BASE:1.20
	OPENBSD_4_3:1.16.0.2
	OPENBSD_4_3_BASE:1.16
	OPENBSD_4_2:1.15.0.2
	OPENBSD_4_2_BASE:1.15
	OPENBSD_4_1:1.14.0.2
	OPENBSD_4_1_BASE:1.14
	OPENBSD_4_0:1.12.0.2
	OPENBSD_4_0_BASE:1.12
	OPENBSD_3_9:1.8.0.2
	OPENBSD_3_9_BASE:1.8
	OPENBSD_3_8:1.2.0.2
	OPENBSD_3_8_BASE:1.2;
locks; strict;
comment	@# @;


1.37
date	2017.02.22.16.39.56;	author jcs;	state Exp;
branches;
next	1.36;
commitid	8xjYWoiSUtOS1eaI;

1.36
date	2017.01.10.08.54.14;	author jsg;	state Exp;
branches;
next	1.35;
commitid	uTOVReWcZpBMEaqE;

1.35
date	2016.08.03.17.23.38;	author jcs;	state Exp;
branches;
next	1.34;
commitid	xNzAQvg5oqM2b0pn;

1.34
date	2016.07.30.16.25.04;	author jcs;	state Exp;
branches;
next	1.33;
commitid	0iHstzSDIo5uCevU;

1.33
date	2016.07.01.15.02.49;	author jcs;	state Exp;
branches;
next	1.32;
commitid	7VGftpHEnI1BYnCr;

1.32
date	2016.05.07.23.10.50;	author kettenis;	state Exp;
branches;
next	1.31;
commitid	jJZjQ9wS5ik34ivo;

1.31
date	2016.03.28.17.29.11;	author kettenis;	state Exp;
branches;
next	1.30;
commitid	x65S9NX9geJkVh9i;

1.30
date	2016.01.12.01.11.15;	author jcs;	state Exp;
branches;
next	1.29;
commitid	vNDeumNiEMwV2q08;

1.29
date	2016.01.11.14.09.37;	author kettenis;	state Exp;
branches;
next	1.28;
commitid	3VFdt81hukUAe3jE;

1.28
date	2016.01.11.07.36.10;	author kettenis;	state Exp;
branches;
next	1.27;
commitid	Jxj5zO1Gs9vOWUOW;

1.27
date	2013.11.06.10.40.36;	author mpi;	state Exp;
branches;
next	1.26;

1.26
date	2011.06.16.23.02.11;	author pirofti;	state Exp;
branches;
next	1.25;

1.25
date	2011.01.04.21.17.49;	author kettenis;	state Exp;
branches;
next	1.24;

1.24
date	2010.07.26.11.29.23;	author pirofti;	state Exp;
branches;
next	1.23;

1.23
date	2009.07.23.01.38.16;	author cnst;	state Exp;
branches;
next	1.22;

1.22
date	2009.06.03.07.13.48;	author pirofti;	state Exp;
branches;
next	1.21;

1.21
date	2009.06.03.00.36.59;	author pirofti;	state Exp;
branches;
next	1.20;

1.20
date	2008.07.02.03.14.54;	author fgsch;	state Exp;
branches;
next	1.19;

1.19
date	2008.06.24.08.24.57;	author sobrado;	state Exp;
branches;
next	1.18;

1.18
date	2008.04.27.16.23.16;	author jcs;	state Exp;
branches;
next	1.17;

1.17
date	2008.04.24.13.57.49;	author jsing;	state Exp;
branches;
next	1.16;

1.16
date	2007.12.05.19.17.13;	author deraadt;	state Exp;
branches;
next	1.15;

1.15
date	2007.05.31.17.49.16;	author gwk;	state Exp;
branches;
next	1.14;

1.14
date	2007.01.22.19.46.23;	author mk;	state Exp;
branches;
next	1.13;

1.13
date	2006.11.15.21.39.06;	author kettenis;	state Exp;
branches;
next	1.12;

1.12
date	2006.05.29.00.54.23;	author canacar;	state Exp;
branches;
next	1.11;

1.11
date	2006.05.19.09.24.32;	author canacar;	state Exp;
branches;
next	1.10;

1.10
date	2006.03.06.03.13.42;	author marco;	state Exp;
branches;
next	1.9;

1.9
date	2006.03.05.14.46.46;	author marco;	state Exp;
branches;
next	1.8;

1.8
date	2006.02.26.02.49.28;	author marco;	state Exp;
branches;
next	1.7;

1.7
date	2006.02.20.00.48.10;	author marco;	state Exp;
branches;
next	1.6;

1.6
date	2005.12.16.00.08.53;	author jordan;	state Exp;
branches;
next	1.5;

1.5
date	2005.12.14.04.16.25;	author marco;	state Exp;
branches;
next	1.4;

1.4
date	2005.12.13.07.23.34;	author marco;	state Exp;
branches;
next	1.3;

1.3
date	2005.12.07.04.25.38;	author jordan;	state Exp;
branches;
next	1.2;

1.2
date	2005.07.10.19.39.01;	author grange;	state Exp;
branches;
next	1.1;

1.1
date	2005.06.02.20.09.39;	author tholo;	state Exp;
branches;
next	;


desc
@@


1.37
log
@add acpisbs, an acpi smart battery subsystem driver reading data
over smbus

currently disabled because it conflicts with acpibat

ok deraadt, kettenis
@
text
@#	$OpenBSD: files.acpi,v 1.36 2017/01/10 08:54:14 jsg Exp $
#
# Config file and device description for machine-independent ACPI code.
# Included by ports that need it.

define	acpi {}
device	acpi
attach	acpi at bios
file	dev/acpi/acpi.c			acpi needs-flag
file	dev/acpi/acpiutil.c		acpi
file	dev/acpi/dsdt.c			acpi
file	dev/acpi/acpidebug.c		acpi & ddb

# ACPI timer
device	acpitimer
attach	acpitimer at acpi
file	dev/acpi/acpitimer.c		acpitimer

# AC device
device	acpiac
attach	acpiac at acpi
file	dev/acpi/acpiac.c		acpiac

# battery device
device	acpibat
attach	acpibat at acpi
file	dev/acpi/acpibat.c		acpibat

# button device
device	acpibtn
attach	acpibtn at acpi
file	dev/acpi/acpibtn.c		acpibtn

# cpu device
device	acpicpu
attach	acpicpu at acpi
file	dev/acpi/acpicpu.c		acpicpu needs-flag

# High Precision Event Timer
device	acpihpet
attach	acpihpet at acpi
file	dev/acpi/acpihpet.c		acpihpet

# Embedded Controller
device	acpiec
attach	acpiec at acpi
file	dev/acpi/acpiec.c		acpiec

# Thermal Zone
device	acpitz
attach	acpitz at acpi
file	dev/acpi/acpitz.c		acpitz

# Multiple APIC Description Table
device	acpimadt
attach	acpimadt at acpi
file	dev/acpi/acpimadt.c		acpimadt

# Memory Mapped Configuration Space Address Description Table
device	acpimcfg
attach	acpimcfg at acpi
file	dev/acpi/acpimcfg.c		acpimcfg

# PCI Routing Table
device	acpiprt
attach	acpiprt at acpi
file	dev/acpi/acpiprt.c		acpiprt needs-flag

# Docking station
device	acpidock
attach	acpidock at acpi
file	dev/acpi/acpidock.c		acpidock

# ASUS ACPI Hotkeys
device	acpiasus
attach	acpiasus at acpi
file	dev/acpi/acpiasus.c		acpiasus

# IBM/Lenovo ThinkPad support
device	acpithinkpad
attach	acpithinkpad at acpi
file	dev/acpi/acpithinkpad.c		acpithinkpad

# Toshiba support
device	acpitoshiba
attach	acpitoshiba at acpi
file	dev/acpi/acpitoshiba.c		acpitoshiba

# Sony support
device	acpisony
attach	acpisony at acpi
file	dev/acpi/acpisony.c		acpisony

# ACPI video
define	acpivideo {}
device	acpivideo
attach	acpivideo at acpi
file	dev/acpi/acpivideo.c		acpivideo

# ACPI vout
device	acpivout
attach	acpivout at acpivideo
file	dev/acpi/acpivout.c		acpivout

# ACPI pwrres
device	acpipwrres
attach	acpipwrres at acpi
file	dev/acpi/acpipwrres.c		acpipwrres needs-flag

# ASUSTeK AI Booster ATK0110
device	aibs
attach	aibs at acpi
file	dev/acpi/atk0110.c		aibs

# Intel Bay Trail GPIO
device	bytgpio
attach	bytgpio at acpi
file	dev/acpi/bytgpio.c		bytgpio

# Intel Cherry View GPIO
device	chvgpio
attach	chvgpio at acpi
file	dev/acpi/chvgpio.c		chvgpio

# SD Host Controller
attach	sdhc at acpi with sdhc_acpi
file	dev/acpi/sdhc_acpi.c		sdhc_acpi

# Synopsys DesignWare I2C controller
device	dwiic: i2cbus
attach	dwiic at acpi
file	dev/acpi/dwiic.c		dwiic

# Chromebook keyboard backlight
device	acpicbkbd
attach	acpicbkbd at acpi
file	dev/acpi/acpicbkbd.c		acpicbkbd

# Ambient Light Sensor
device	acpials
attach	acpials at acpi
file	dev/acpi/acpials.c		acpials

# Trusted Platform Module
device	tpm
attach	tpm at acpi
file	dev/acpi/tpm.c			tpm

# Hyper-V Entropy
device	acpihve
attach	acpihve at acpi
file	dev/acpi/acpihve.c		acpihve

# Smart Battery Subsystem
device	acpisbs
attach	acpisbs at acpi
file	dev/acpi/acpisbs.c		acpisbs
@


1.36
log
@Hyper-V hosts make 64 bytes of entropy available to guests in the form
of a OEM0 ACPI table.  acpihve(4) feeds this data into the kernel
entropy pool.

This is less interesting for machines with rdrand, but there are still
pre ivy bridge machines running Hyper-V (including parts of Azure).

ok mikeb@@ reyk@@ deraadt@@ mlarkin@@
@
text
@d1 1
a1 1
#	$OpenBSD: files.acpi,v 1.35 2016/08/03 17:23:38 jcs Exp $
d153 5
@


1.35
log
@add a minimal TPM 1.2 driver just to issue a "save state" command
before suspending, in order to fix suspend/resume on some newer
machines.

more cleanup and TPM 2.0 support coming later.

earlier version ok pirofti
ok deraadt
@
text
@d1 1
a1 1
#	$OpenBSD: files.acpi,v 1.34 2016/07/30 16:25:04 jcs Exp $
d148 5
@


1.34
log
@add acpials(4), an acpi driver for ambient light sensors

hw.sensors.acpials0.illuminance0=11.00 lx (ambient light sensor)
@
text
@d1 1
a1 1
#	$OpenBSD: files.acpi,v 1.33 2016/07/01 15:02:49 jcs Exp $
d143 5
@


1.33
log
@add a simple keyboard backlight driver for some chromebooks,
adjustable with wsconsctl keyboard.backlight

ok bmercer, kettenis
@
text
@d1 1
a1 1
#	$OpenBSD: files.acpi,v 1.32 2016/05/07 23:10:50 kettenis Exp $
d138 5
@


1.32
log
@Add chvgpio(4), a driver for the GPIO controllers found on Intel's Cherry View
SoC.
@
text
@d1 1
a1 1
#	$OpenBSD: files.acpi,v 1.31 2016/03/28 17:29:11 kettenis Exp $
d133 5
@


1.31
log
@Add bytgpio(4) a driver for the gpio controllers found on Intel's Bay Trail
SoC.
@
text
@d1 1
a1 1
#	$OpenBSD: files.acpi,v 1.30 2016/01/12 01:11:15 jcs Exp $
d119 5
@


1.30
log
@Add dwiic, a driver for the Synopsys DesignWare i2c controller found
on the Samsung ATIV Book 9 laptop.  This initial version only
supports ACPI config/attachment.

Add ihidev, a HID-over-i2c driver largely based on uhidev.  dwiic
handles attaching ihidev devices found in ACPI.

Add ims, a HID-over-i2c mouse/trackpad driver to get basic cursor
and button functionality from HID-compliant i2c trackpads.

ok kettenis deraadt
@
text
@d1 1
a1 1
#	$OpenBSD: files.acpi,v 1.29 2016/01/11 14:09:37 kettenis Exp $
d114 5
@


1.29
log
@Only include sdhc_acpi.c if shdc* at acpi? is included in the kernel config.
@
text
@d1 1
a1 1
#	$OpenBSD: files.acpi,v 1.28 2016/01/11 07:36:10 kettenis Exp $
d118 5
@


1.28
log
@Add glue to make sdhc(4) attach to acpi(4).  Needed to support the SD host
controllers integrated on Intel's Bay Trail SoCs.
@
text
@d1 1
a1 1
#	$OpenBSD: files.acpi,v 1.27 2013/11/06 10:40:36 mpi Exp $
d117 1
a117 1
file	dev/acpi/sdhc_acpi.c		sdhc
@


1.27
log
@Add support for Power Resources for Dx states and the necessary hook
for PCI devices.  This hook should be called twice, before and after
changing the power state of a PCI device.

Before setting the device to the new state, the ACPI layer will notify
every power resources linked to the device for that state and make sure
they are turned "_ON".  After changing the state of the device, it will
decrement the reference of every power resources linked to that device
for the old state and turn them "_OFF" if they are no longer referenced.

This fixes the no-USB after resume problem seen on various ThinkPad,
problem initialy diagnosed with Alexander Polakov.

ok kettenis@@, deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: files.acpi,v 1.26 2011/06/16 23:02:11 pirofti Exp $
d114 4
@


1.26
log
@Import acpitoshiba driver.

This is originally written by Hiroyuki Aizu, ported and integrated
in our tree by Javier Vazquez <javama4 AT gmail> with tweaks and
suggestions by me.

Import prodded by deraadt@@ and the lack of testers on tech@@.
@
text
@d1 1
a1 1
#	$OpenBSD: files.acpi,v 1.25 2011/01/04 21:17:49 kettenis Exp $
d108 1
a108 1
file	dev/acpi/acpipwrres.c		acpipwrres
@


1.25
log
@Add support for Memory Mapped Configuration space access.  This gives us
access to PCIe extended configuration space access on modern i386 and amd64
machines.
@
text
@d1 1
a1 1
#	$OpenBSD: files.acpi,v 1.24 2010/07/26 11:29:23 pirofti Exp $
d83 5
@


1.24
log
@Add support for Sony ACPI hotkeys via a new driver: acpisony(4).

Currently it only works for the suspend button and tries to do right for
the brightness events, but I haven't found a Sony laptop that like to do
right so far.

In the future I want to make the brightness keys work on all Sony's and
also add support for the zoom hotkeys and whatever other funky keys I can
find on those things.

Okay deraadt@@.
@
text
@d1 1
a1 1
#	$OpenBSD: files.acpi,v 1.23 2009/07/23 01:38:16 cnst Exp $
d58 5
@


1.23
log
@New aibs(4) driver for ASUSTeK AI Booster (ACPI ATK0110) hardware monitoring,
with sensor state support through limits provided by the ACPI.

Tested on several ASUS motherboards kindly networked by Sam Fourman Jr.

ok deraadt marco jordan
@
text
@d1 1
a1 1
#	$OpenBSD: files.acpi,v 1.22 2009/06/03 07:13:48 pirofti Exp $
d78 5
@


1.22
log
@Import acpi power resource driver. This is needed for suspend/resume logic.

Okay jordan@@ and marco@@.
@
text
@d1 1
a1 1
#	$OpenBSD: files.acpi,v 1.21 2009/06/03 00:36:59 pirofti Exp $
d94 5
@


1.21
log
@Add acpivideo support. This adds brightness support for all laptops
except thinkpads, they will use the acpithinkpad driver. The driver is
also hooked into wsconsole. So brightness can be adjusted via:

$ wsconsctl display.brightness=<percentage>

This is very helpfull on some laptops that have a nasty bios and get two
steps instead of one when pressing the brightness button.

Tested on various dell, fujitsu, acer, samsung and other laptops.

Okay marco@@, miod@@. Suggestions from kettenis@@.
Lots of reviews and help from miod@@, thanks!
@
text
@d1 1
a1 1
#	$OpenBSD: files.acpi,v 1.20 2008/07/02 03:14:54 fgsch Exp $
d89 5
@


1.20
log
@add acpivideo. for now almost an empty skel so others can work on
suspend/resume. eventually it will also manage output switching and
brightness where supported.  prodded by marco@@
@
text
@d1 1
a1 1
#	$OpenBSD: files.acpi,v 1.19 2008/06/24 08:24:57 sobrado Exp $
d80 1
d84 5
@


1.19
log
@Thinkpad -> ThinkPad
@
text
@d1 1
a1 1
#	$OpenBSD: files.acpi,v 1.18 2008/04/27 16:23:16 jcs Exp $
d78 5
@


1.18
log
@add acpithinkpad(4), an acpi support driver for ibm/lenovo
thinkpads.

provides functionality that the bios did on older, non-acpi
thinkpads like respond to screen brightness keys and toggle the
bluetooth device on and off.

ok deraadt@@ and marco@@
@
text
@d1 1
a1 1
#	$OpenBSD: files.acpi,v 1.17 2008/04/24 13:57:49 jsing Exp $
d74 1
a74 1
# IBM/Lenovo Thinkpad support
@


1.17
log
@Introduce acpiasus(4), a driver for the ACPI based hotkeys found in many
ASUS laptops (including the ASUS EeePC) - largely based on NetBSD's
asus(4) driver. On the ASUS EeePC this allows us to enable/disable
wireless, change screen brightness and use the volume keys.

ok jsg@@, weingart@@
@
text
@d1 1
a1 1
#	$OpenBSD: files.acpi,v 1.15 2007/05/31 17:49:16 gwk Exp $
d73 5
@


1.16
log
@Hang acpi(4) below bios(4) instead of mainbus(4).  This lets us move acpi(4)
before pcibios(4), and then.... if acpi(4) attaches, skip pcibios(4) since
it messes the machines up.  Fixes claudio's HP dl320 G5, and almost assuredly
others.
ok kettenis
@
text
@d69 4
@


1.15
log
@Make powernow-k8 on amd64 and i386 use the _PSS object from acpi to
retreive p_state data as spelled out in the amd64 bios and kernel
developers guide. This code is still a little rough around the edges but
has been tested by myself on a tyan machine and by phessler at theapt
dot org on an HP DL145. This diff also takes a first stab and cleaning up
the acpicpu dmesg spam.

ok tedu, marco
@
text
@d1 1
a1 1
#	$OpenBSD: files.acpi,v 1.14 2007/01/22 19:46:23 mk Exp $
d8 1
a8 1
attach	acpi at mainbus
@


1.14
log
@Tell config about acpidock.

ok marco
@
text
@d1 1
a1 1
#	$OpenBSD: files.acpi,v 1.13 2006/11/15 21:39:06 kettenis Exp $
d37 1
a37 1
file	dev/acpi/acpicpu.c		acpicpu
@


1.13
log
@dd pseudo-devices to handle acpi apic interrupt routing.

ok jordan@@
@
text
@d1 1
a1 1
#	$OpenBSD: files.acpi,v 1.12 2006/05/29 00:54:23 canacar Exp $
d63 6
@


1.12
log
@Add embedded controller support.
ok marco@@ deraadt@@ testing & ok gwk@@
@
text
@d1 1
a1 1
#	$OpenBSD: files.acpi,v 1.11 2006/05/19 09:24:32 canacar Exp $
d53 10
@


1.11
log
@Minimal thermal zone driver. Monitors thermal zone temperature,
shuts down the system if the 'critical temperature' is reached.
ok marco@@
@
text
@d1 1
a1 1
#	$OpenBSD: files.acpi,v 1.10 2006/03/06 03:13:42 marco Exp $
d43 5
@


1.10
log
@Rename hpet to acpihpet so that all devices use the same naming convention.

discussed with jordan.
@
text
@d1 1
a1 1
#	$OpenBSD: files.acpi,v 1.9 2006/03/05 14:46:46 marco Exp $
d43 5
@


1.9
log
@Hook acpi to ddb since we need to be able to do some live debugging.

Lots and lots of help from miod@@ and deraadt@@
ok deraadt@@ miod@@
@
text
@d1 1
a1 1
#	$OpenBSD: files.acpi,v 1.8 2006/02/26 02:49:28 marco Exp $
d40 3
a42 4
device	hpet
attach	hpet at acpi
file	dev/acpi/hpet.c			hpet

@


1.8
log
@Add acpicpu device.  Remains disabled.

ok jordan@@
@
text
@d1 1
a1 1
#	$OpenBSD: files.acpi,v 1.7 2006/02/20 00:48:10 marco Exp $
d12 1
@


1.7
log
@Add acpibtn device.  Remains disabled for now.
@
text
@d1 1
a1 1
#	$OpenBSD: files.acpi,v 1.6 2005/12/16 00:08:53 jordan Exp $
d32 5
@


1.6
log
@Moved DSDT AML parsing into parent ACPI driver
ok marco@@
@
text
@d1 1
a1 1
#	$OpenBSD: files.acpi,v 1.5 2005/12/14 04:16:25 marco Exp $
d27 5
@


1.5
log
@Add AC device glue.
@
text
@d1 1
a1 1
#	$OpenBSD: files.acpi,v 1.4 2005/12/13 07:23:34 marco Exp $
d11 1
a32 4
# DSDT (AML Parser)
device	dsdt
attach	dsdt at acpi
file	dev/acpi/dsdt.c			dsdt
@


1.4
log
@Add glue to attach devices to apci.
@
text
@d1 1
a1 1
#	$OpenBSD: files.acpi,v 1.3 2005/12/07 04:25:38 jordan Exp $
d17 6
a22 1
# generic device
@


1.3
log
@Added DSDT Table for AML Parser glue
DO NOT USE YET
marco@@
@
text
@d1 1
a1 1
#	$OpenBSD: files.acpi,v 1.2 2005/07/10 19:39:01 grange Exp $
d16 5
@


1.2
log
@Spacing cleanup.
@
text
@d1 1
a1 1
#	$OpenBSD: files.acpi,v 1.1 2005/06/02 20:09:39 tholo Exp $
d21 5
@


1.1
log
@Start on a basic ACPI framework -- does not do much more than read out the
ACPI tables into kernel memory and attach ACPI and HPET timers currently.

In order to test this code, enabling the devices in GENERIC as well as
the ACPI_ENABLE option is needed.  This code does not do any thermal
control yet, so this should be done with care depending on the platform.

In the tree so more people can contribute to making this more fully
featured.

Ok niklas@@ grange@@ tedu@@
@
text
@d1 1
a1 1
#	$OpenBSD$
d20 1
a20 1
file	dev/acpi/hpet.c			hpet@

