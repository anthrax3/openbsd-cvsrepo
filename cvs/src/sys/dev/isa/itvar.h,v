head	1.15;
access;
symbols
	OPENBSD_6_0:1.15.0.14
	OPENBSD_6_0_BASE:1.15
	OPENBSD_5_9:1.15.0.4
	OPENBSD_5_9_BASE:1.15
	OPENBSD_5_8:1.15.0.12
	OPENBSD_5_8_BASE:1.15
	OPENBSD_5_7:1.15.0.10
	OPENBSD_5_7_BASE:1.15
	OPENBSD_5_6:1.15.0.8
	OPENBSD_5_6_BASE:1.15
	OPENBSD_5_5:1.15.0.6
	OPENBSD_5_5_BASE:1.15
	OPENBSD_5_4:1.15.0.2
	OPENBSD_5_4_BASE:1.15
	OPENBSD_5_3:1.14.0.2
	OPENBSD_5_3_BASE:1.14
	OPENBSD_5_2:1.13.0.8
	OPENBSD_5_2_BASE:1.13
	OPENBSD_5_1_BASE:1.13
	OPENBSD_5_1:1.13.0.6
	OPENBSD_5_0:1.13.0.4
	OPENBSD_5_0_BASE:1.13
	OPENBSD_4_9:1.13.0.2
	OPENBSD_4_9_BASE:1.13
	OPENBSD_4_8:1.12.0.8
	OPENBSD_4_8_BASE:1.12
	OPENBSD_4_7:1.12.0.4
	OPENBSD_4_7_BASE:1.12
	OPENBSD_4_6:1.12.0.6
	OPENBSD_4_6_BASE:1.12
	OPENBSD_4_5:1.12.0.2
	OPENBSD_4_5_BASE:1.12
	OPENBSD_4_4:1.9.0.2
	OPENBSD_4_4_BASE:1.9
	OPENBSD_4_3:1.7.0.2
	OPENBSD_4_3_BASE:1.7
	OPENBSD_4_2:1.4.0.2
	OPENBSD_4_2_BASE:1.4
	OPENBSD_4_1:1.3.0.2
	OPENBSD_4_1_BASE:1.3
	OPENBSD_4_0:1.2.0.12
	OPENBSD_4_0_BASE:1.2
	OPENBSD_3_9:1.2.0.10
	OPENBSD_3_9_BASE:1.2
	OPENBSD_3_8:1.2.0.8
	OPENBSD_3_8_BASE:1.2
	OPENBSD_3_7:1.2.0.6
	OPENBSD_3_7_BASE:1.2
	OPENBSD_3_6:1.2.0.4
	OPENBSD_3_6_BASE:1.2
	SMP_SYNC_A:1.2
	SMP_SYNC_B:1.2
	OPENBSD_3_5:1.2.0.2
	OPENBSD_3_5_BASE:1.2
	OPENBSD_3_4:1.1.0.4
	OPENBSD_3_4_BASE:1.1
	SMP:1.1.0.2;
locks; strict;
comment	@ * @;


1.15
date	2013.03.21.18.20.00;	author brynet;	state Exp;
branches;
next	1.14;

1.14
date	2012.12.14.13.17.29;	author mikeb;	state Exp;
branches;
next	1.13;

1.13
date	2011.01.20.16.59.55;	author form;	state Exp;
branches;
next	1.12;

1.12
date	2009.01.16.06.58.32;	author form;	state Exp;
branches;
next	1.11;

1.11
date	2008.10.22.05.38.17;	author form;	state Exp;
branches;
next	1.10;

1.10
date	2008.10.08.15.06.49;	author form;	state Exp;
branches;
next	1.9;

1.9
date	2008.04.07.09.43.54;	author form;	state Exp;
branches;
next	1.8;

1.8
date	2008.04.03.20.28.05;	author form;	state Exp;
branches;
next	1.7;

1.7
date	2007.12.23.17.44.07;	author form;	state Exp;
branches;
next	1.6;

1.6
date	2007.12.20.12.02.14;	author form;	state Exp;
branches;
next	1.5;

1.5
date	2007.12.18.21.17.54;	author form;	state Exp;
branches;
next	1.4;

1.4
date	2007.03.22.16.55.31;	author deraadt;	state Exp;
branches;
next	1.3;

1.3
date	2006.12.23.17.46.39;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	2003.11.05.20.57.10;	author grange;	state Exp;
branches;
next	1.1;

1.1
date	2003.05.20.20.26.27;	author grange;	state Exp;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2003.06.07.10.32.24;	author ho;	state Exp;
branches;
next	1.1.2.2;

1.1.2.2
date	2004.02.19.10.56.22;	author niklas;	state Exp;
branches;
next	;


desc
@@


1.15
log
@Attach on ITE 8728.

it0 at isa0 port 0x2e/2: IT8728F rev 1, EC port 0x228

ok deraadt@@
@
text
@/*	$OpenBSD: itvar.h,v 1.14 2012/12/14 13:17:29 mikeb Exp $	*/

/*
 * Copyright (c) 2007-2008 Oleg Safiullin <form@@pdp-11.org.ru>
 * Copyright (c) 2006-2007 Juan Romero Pardines <juan@@xtrarom.org>
 * Copyright (c) 2003 Julien Bordet <zejames@@greyhats.org>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 *
 * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
 * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
 * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
 * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
 * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
 * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef _DEV_ISA_ITVAR_H_
#define _DEV_ISA_ITVAR_H_

#define IT_EC_INTERVAL		5
#define IT_EC_NUMSENSORS	17
#define IT_EC_VREF		4096

#define IO_IT1			0x2e
#define IO_IT2			0x4e

#define IT_IO_ADDR		0x00
#define IT_IO_DATA		0x01

#define IT_ID_8705		0x8705
#define IT_ID_8712		0x8712
#define IT_ID_8716		0x8716
#define IT_ID_8718		0x8718
#define IT_ID_8720		0x8720
#define IT_ID_8721		0x8721
#define IT_ID_8726		0x8726
#define IT_ID_8728		0x8728
#define IT_ID_8772		0x8772

#define IT_CCR			0x02
#define IT_LDN			0x07
#define IT_CHIPID1		0x20
#define IT_CHIPID2		0x21
#define IT_CHIPREV		0x22

#define IT_EC_LDN		0x04
#define IT_EC_MSB		0x60
#define IT_EC_LSB		0x61

#define IT_EC_ADDR		0x05
#define IT_EC_DATA		0x06

#define IT_EC_CFG		0x00
#define IT_EC_FAN_DIV		0x0b
#define IT_EC_FAN_ECER		0x0c
#define IT_EC_FAN_TAC1		0x0d
#define IT_EC_FAN_TAC2		0x0e
#define IT_EC_FAN_TAC3		0x0f
#define IT_EC_FAN_MCR		0x13
#define IT_EC_FAN_EXT_TAC1	0x18
#define IT_EC_FAN_EXT_TAC2	0x19
#define IT_EC_FAN_EXT_TAC3	0x1a
#define IT_EC_VOLTBASE		0x20
#define IT_EC_TEMPBASE		0x29
#define IT_EC_ADC_VINER		0x50
#define IT_EC_ADC_TEMPER	0x51
#define IT_EC_FAN_TAC4_LSB	0x80
#define IT_EC_FAN_TAC4_MSB	0x81
#define IT_EC_FAN_TAC5_LSB	0x82
#define IT_EC_FAN_TAC5_MSB	0x83

#define IT_EC_CFG_START		0x01
#define IT_EC_CFG_INTCLR	0x08
#define IT_EC_CFG_UPDVBAT	0x40

#define IT_WDT_LDN		0x07

#define IT_WDT_CSR		0x71
#define IT_WDT_TCR		0x72
#define IT_WDT_TMO_LSB		0x73
#define IT_WDT_TMO_MSB		0x74

#define IT_WDT_TCR_SECS		0x80
#define IT_WDT_TCR_KRST		0x40
#define IT_WDT_TCR_PWROK	0x10


struct it_softc {
	struct device		sc_dev;

	bus_space_tag_t		sc_iot;
	bus_space_handle_t	sc_ioh;
	int			sc_iobase;
	int			sc_ec_iobase;
	u_int16_t		sc_chipid;
	u_int8_t		sc_chiprev;

	bus_space_tag_t		sc_ec_iot;
	bus_space_handle_t	sc_ec_ioh;

	struct ksensor		sc_sensors[IT_EC_NUMSENSORS];
	struct ksensordev	sc_sensordev;

	LIST_ENTRY(it_softc)	sc_list;
};

#endif	/* _DEV_ISA_ITVAR_H_ */
@


1.14
log
@Support IT8772F; from form@@, ok kettenis
@
text
@d1 1
a1 1
/*	$OpenBSD: itvar.h,v 1.13 2011/01/20 16:59:55 form Exp $	*/
d50 1
@


1.13
log
@add IT8721 support
@
text
@d1 1
a1 1
/*	$OpenBSD: itvar.h,v 1.12 2009/01/16 06:58:32 form Exp $	*/
d50 1
@


1.12
log
@add IT8720F support
thanks to Vit Skibinskiy <bucker(ik)skibinski.pp.ru>
@
text
@d1 1
a1 1
/*	$OpenBSD: itvar.h,v 1.11 2008/10/22 05:38:17 form Exp $	*/
d48 1
@


1.11
log
@o add FAN4 and FAN5 sensors for IT8716/8718/8726
o always use 16-bit FAN counters for IT8716/8718/8726
o do not try to poll sensors disabled by BIOS
o sync VIN5 & VIN6 sensors description w/ ITE docs

tested by naddy@@ weerd@@
@
text
@d1 1
a1 1
/*	$OpenBSD: itvar.h,v 1.10 2008/10/08 15:06:49 form Exp $	*/
d47 1
@


1.10
log
@o chip revision is 4-bit value
o some #define's instead of digits
@
text
@d1 1
a1 1
/*	$OpenBSD: itvar.h,v 1.9 2008/04/07 09:43:54 form Exp $	*/
d34 1
a34 1
#define IT_EC_NUMSENSORS	15
d64 8
a71 3
#define IT_EC_FAN_ECR		0x0c
#define IT_EC_FANBASE		0x0d
#define IT_EC_FANEXTBASE	0x18
d74 6
d82 1
a82 1
#define IT_EC_INT_CLEAR		0x08
@


1.9
log
@more cosmetic changes
@
text
@d1 1
a1 1
/*	$OpenBSD: itvar.h,v 1.8 2008/04/03 20:28:05 form Exp $	*/
d69 4
@


1.8
log
@Switch it(4) back to PnP config mode. Avoid possible
conflicts with SMSC or similar chips.
@
text
@d1 1
a1 1
/*	$OpenBSD: itvar.h,v 1.7 2007/12/23 17:44:07 form Exp $	*/
d74 6
a79 2
#define IT_WDT_LSB		0x73
#define IT_WDT_MSB		0x74
@


1.7
log
@Look for environment controller first, and access ITE SuperIO address/data
ports only if we found one. Fixes possible issues with some notebook
chipsets.

ok deraadt@@
tested by me, jcs@@ and Rodolfo Gouveia
@
text
@d1 1
a1 1
/*	$OpenBSD: itvar.h,v 1.6 2007/12/20 12:02:14 form Exp $	*/
d4 1
a4 1
 * Copyright (c) 2007 Oleg Safiullin <form@@pdp-11.org.ru>
d37 2
a38 1
#define IO_IT			0x2e
a42 2
#define IT_VEND_ITE		0x90

a68 1
#define IT_EC_VENDID		0x58
d83 2
d93 2
@


1.6
log
@add original copyright
bad me
@
text
@d1 1
a1 1
/*	$OpenBSD: itvar.h,v 1.5 2007/12/18 21:17:54 form Exp $	*/
d37 1
a37 2
#define IO_IT1			0x2e
#define IO_IT2			0x4e
d42 2
d70 1
a84 1
	int			sc_iobase;
@


1.5
log
@New it(4) driver.
Supports ITE IT8705/8712/8716/8718/8726 and SiS SiS950
hardware monitors and ITE IT8712F/8716F/8718F/8726F watchdog timer.
@
text
@d1 1
a1 1
/*	$OpenBSD: itvar.h,v 1.4 2007/03/22 16:55:31 deraadt Exp $	*/
d5 2
@


1.4
log
@split userland & kernel struct sensor/sensordev so that the addition
of new fields in the future is less disruptive.  This is done similar
to how struct proc is handled for ps(1).  ok jmc (man page changes)
tested fkr simon, and more suggestions from millert
@
text
@d1 1
a1 1
/*	$OpenBSD: itvar.h,v 1.3 2006/12/23 17:46:39 deraadt Exp $	*/
d4 1
a4 1
 * Copyright (c) 2003 Julien Bordet <zejames@@greyhats.org>
d28 2
a29 2
#ifndef _DEV_ISA_ITVAR_H
#define _DEV_ISA_ITVAR_H
d31 43
a73 1
#define IT_NUM_SENSORS	15
a74 43
/* chip ids */
#define IT_ID_IT87	0x90

/* ctl registers */

#define ITC_ADDR	0x05
#define ITC_DATA	0x06

/* data registers */

#define ITD_CONFIG	0x00
#define ITD_ISR1	0x01
#define ITD_ISR2	0x02
#define ITD_ISR3	0x03
#define ITD_SMI1	0x04
#define ITD_SMI2	0x05
#define ITD_SMI3	0x06
#define ITD_IMR1	0x07
#define ITD_IMR2	0x08
#define ITD_IMR3	0x09
#define ITD_VID		0x0a
#define ITD_FAN		0x0b

#define ITD_FANMINBASE	0x10
#define ITD_FANENABLE	0x13

#define ITD_SENSORFANBASE	0x0d	/* Fan from 0x0d to 0x0f */
#define ITD_SENSORVOLTBASE	0x20	/* Fan from 0x20 to 0x28 */
#define ITD_SENSORTEMPBASE	0x29	/* Fan from 0x29 to 0x2b */

#define ITD_VOLTMAXBASE	0x30
#define ITD_VOLTMINBASE	0x31

#define ITD_TEMPMAXBASE 0x40
#define ITD_TEMPMINBASE 0x41

#define ITD_SBUSADDR	0x48
#define ITD_VOLTENABLE	0x50
#define ITD_TEMPENABLE	0x51

#define ITD_CHIPID	0x58

#define IT_VREF		(4096) /* Vref = 4.096 V */
d77 1
a77 1
	struct device sc_dev;
d79 5
a83 2
	bus_space_tag_t it_iot;
	bus_space_handle_t it_ioh;
d85 2
a86 4
	struct ksensor sensors[IT_NUM_SENSORS];
	struct ksensordev sensordev;
	u_int numsensors;
	void (*refresh_sensor_data)(struct it_softc *);
d88 2
a89 2
	u_int8_t (*it_readreg)(struct it_softc *, int);
	void (*it_writereg)(struct it_softc *, int, int);
d92 1
a92 1
#endif
@


1.3
log
@adapt to new two-level sensor api; Constantine A. Murenin
@
text
@d1 1
a1 1
/*	$OpenBSD: itvar.h,v 1.2 2003/11/05 20:57:10 grange Exp $	*/
d83 2
a84 2
	struct sensor sensors[IT_NUM_SENSORS];
	struct sensordev sensordev;
@


1.2
log
@Correct author's email address per his request.
@
text
@d1 1
a1 1
/*	$OpenBSD: itvar.h,v 1.1 2003/05/20 20:26:27 grange Exp $	*/
d84 1
@


1.1
log
@it(4) driver provides support for ITE IT8705F, IT8712F and SiS SiS950
hardware monitoring chips to be used with hw.sensors sysctl interface.
Work by Julien Bordet <zejames@@greyhats.org> with my little help.
@
text
@d1 1
a1 1
/*	$OpenBSD$	*/
d4 1
a4 1
 * Copyright (c) 2003 Julien Bordet <zejames@@greygats.org>
@


1.1.2.1
log
@add file to SMP branch
@
text
@@


1.1.2.2
log
@Merge of current from two weeks agointo the SMP branch
@
text
@d4 1
a4 1
 * Copyright (c) 2003 Julien Bordet <zejames@@greyhats.org>
@


