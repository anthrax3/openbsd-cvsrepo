head	1.13;
access;
symbols
	OPENBSD_6_1:1.12.0.4
	OPENBSD_6_1_BASE:1.12
	OPENBSD_6_0:1.7.0.2
	OPENBSD_6_0_BASE:1.7
	OPENBSD_5_9:1.5.0.2
	OPENBSD_5_9_BASE:1.5
	OPENBSD_5_8:1.2.0.4
	OPENBSD_5_8_BASE:1.2;
locks; strict;
comment	@# @;


1.13
date	2017.06.14.10.25.40;	author mikeb;	state Exp;
branches;
next	1.12;
commitid	GkH2WnTdqoMXGtbI;

1.12
date	2017.01.22.20.08.10;	author reyk;	state Exp;
branches;
next	1.11;
commitid	1DxbC3qUASBRgUkI;

1.11
date	2017.01.21.11.33.01;	author reyk;	state Exp;
branches;
next	1.10;
commitid	FL7XZxsmRKhLx3RH;

1.10
date	2017.01.21.10.58.15;	author reyk;	state Exp;
branches;
next	1.9;
commitid	swIiw8mtZ7Pk0W3t;

1.9
date	2016.12.07.15.30.04;	author mikeb;	state Exp;
branches;
next	1.8;
commitid	hdJjb4I9Ezxr7sgL;

1.8
date	2016.10.11.11.46.49;	author mikeb;	state Exp;
branches;
next	1.7;
commitid	EdcKmtCuROaO2Xuz;

1.7
date	2016.07.13.21.59.35;	author mikeb;	state Exp;
branches;
next	1.6;
commitid	8jURlFl7WujRXJsd;

1.6
date	2016.06.22.01.13.07;	author mikeb;	state Exp;
branches;
next	1.5;
commitid	qi2GLlgF1qtf4Kfm;

1.5
date	2016.01.07.11.13.19;	author mikeb;	state Exp;
branches;
next	1.4;
commitid	gA9qUqkZDRFXzE4f;

1.4
date	2015.12.08.22.14.40;	author mikeb;	state Exp;
branches;
next	1.3;
commitid	TtYskjHMvQp6NRMk;

1.3
date	2015.12.08.18.46.25;	author mikeb;	state Exp;
branches;
next	1.2;
commitid	Ij2SOB19ATTH0yEx;

1.2
date	2015.07.21.09.13.11;	author reyk;	state Exp;
branches;
next	1.1;
commitid	d27V1FOGj1cGBUt8;

1.1
date	2015.07.21.03.38.22;	author reyk;	state Exp;
branches;
next	;
commitid	t8p39jbat5DBrbFu;


desc
@@


1.13
log
@Hookup hvs(4)
@
text
@#	$OpenBSD: files.pv,v 1.12 2017/01/22 20:08:10 reyk Exp $
#
# Config file and device description for paravirtual devices.
# Included by ports that need it.

define	pvbus {}
device	pvbus
attach	pvbus at mainbus
file	dev/pv/pvbus.c			pvbus	needs-flag

# VMware Tools
device	vmt
attach	vmt at pvbus
file	dev/pv/vmt.c			vmt	needs-flag

# Xen
device	xen {}
attach	xen at pvbus
file	dev/pv/xen.c			xen	needs-flag
file	dev/pv/xenstore.c		xen

# Xen Netfront
device	xnf: ether, ifnet, ifmedia
attach	xnf at xen
file	dev/pv/if_xnf.c			xnf

# Xen Blkfront
device	xbf: scsi
attach	xbf at xen
file	dev/pv/xbf.c			xbf

# Hyper-V
device	hyperv {}
attach	hyperv at pvbus
file	dev/pv/hyperv.c			hyperv	needs-flag
file	dev/pv/hypervic.c		hyperv

# Hyper-V NetVSC
device	hvn: ether, ifnet, ifmedia
attach	hvn at hyperv
file	dev/pv/if_hvn.c			hvn

# Hyper-V StorVSC
device	hvs: scsi
attach	hvs at hyperv
file	dev/pv/hvs.c			hvs

# VirtIO
file	dev/pv/virtio.c			virtio

device	vio
attach	vio at virtio
file	dev/pv/if_vio.c			vio

device	vioblk: scsi
attach	vioblk at virtio
file	dev/pv/vioblk.c			vioblk

device	viocon
attach	viocon at virtio
file	dev/pv/viocon.c			viocon		needs-flag

device	viomb
attach	viomb at virtio
file	dev/pv/viomb.c			viomb

device	viornd
attach	viornd at virtio
file	dev/pv/viornd.c			viornd

device	vioscsi: scsi
attach	vioscsi at virtio
file	dev/pv/vioscsi.c		vioscsi

device	vmmci
attach	vmmci at virtio
file	dev/pv/vmmci.c			vmmci
@


1.12
log
@define virtio in conf/files

This unbreaks build on archs that are non-pv but PCI because I moved
virtio out of files.pci but kept a virtio dependency for the
virtio_pci driver.

Issue report and fix suggested by visa@@ and miod@@
@
text
@d1 1
a1 1
#	$OpenBSD: files.pv,v 1.11 2017/01/21 11:33:01 reyk Exp $
d42 5
@


1.11
log
@Switch include of virtio header from dev/pci/ to dev/pv/
@
text
@d1 1
a1 1
#	$OpenBSD: files.pv,v 1.10 2017/01/21 10:58:15 reyk Exp $
a43 1
device	virtio {}
@


1.10
log
@Move virtio config from files.pci to files.pci

virtio itself is not PCI, it is a paravirtual bus on top of either PCI
or MMIO (arm).  This is the first step of moving the virtio files to
dev/pv.  No functional change.

arm kernel changes tested by jsg@@ and patrick@@
no objections from sf@@ mlarkin@@
@
text
@d1 1
a1 1
#	$OpenBSD: files.pv,v 1.9 2016/12/07 15:30:04 mikeb Exp $
d45 1
a45 1
file	dev/pci/virtio.c		virtio
d49 1
a49 1
file	dev/pci/if_vio.c		vio
d53 1
a53 1
file	dev/pci/vioblk.c		vioblk
d57 1
a57 1
file	dev/pci/viocon.c		viocon		needs-flag
d61 1
a61 1
file	dev/pci/viomb.c			viomb
d65 1
a65 1
file	dev/pci/viornd.c		viornd
d69 1
a69 1
file	dev/pci/vioscsi.c		vioscsi
d73 1
a73 1
file	dev/pci/vmmci.c			vmmci
@


1.9
log
@Add xbf(4)
@
text
@d1 1
a1 1
#	$OpenBSD: files.pv,v 1.8 2016/10/11 11:46:49 mikeb Exp $
d42 32
@


1.8
log
@Move Hyper-V integration components into a separate source file

Input & OK reyk.
@
text
@d1 1
a1 1
#	$OpenBSD: files.pv,v 1.7 2016/07/13 21:59:35 mikeb Exp $
d22 1
d27 5
d38 1
@


1.7
log
@A work-in-progress driver for the Hyper-V NetVSC

Network VSC is an RNDIS device using NVSP protocol to communicate
with the Hyper-V VMBus via VMBus channels and/or shared memory. The
code was ported from FreeBSD with some API changes and simplifications.

While the Rx path is nearly complete, packet transmition is not
implemented yet.

ok deraadt, mlarkin
@
text
@d1 1
a1 1
#	$OpenBSD: files.pv,v 1.6 2016/06/22 01:13:07 mikeb Exp $
d30 1
@


1.6
log
@Main Hyper-V nexus driver, work in progress.

ok mlarkin, deraadt
@
text
@d1 1
a1 1
#	$OpenBSD: files.pv,v 1.5 2016/01/07 11:13:19 mikeb Exp $
d30 4
@


1.5
log
@Xen virtual networking interface (Netfront) driver.

Encouragement from deraadt@@, ok reyk
@
text
@d1 1
a1 1
#	$OpenBSD: files.pv,v 1.4 2015/12/08 22:14:40 mikeb Exp $
d25 5
@


1.4
log
@Driver for XenStore, the configuration storage

XenStore provides a hierarchical storage for Xen configuration
in a style of an OpenFirmware.  Itself it's an interrupt driven
producer/consumer interface with two 1kb rings for input and
output.

It's required in order to do virtual device discovery and device
configuration (fetch MAC address, various parameters).

With input from and OK mlarkin, reyk
@
text
@d1 1
a1 1
#	$OpenBSD: files.pv,v 1.3 2015/12/08 18:46:25 mikeb Exp $
d21 4
@


1.3
log
@Xen basic infrastructure files and pvbus(4) attachment.

With input from and OK mpi, mlarkin, reyk
@
text
@d1 1
a1 1
#	$OpenBSD: files.pv,v 1.2 2015/07/21 09:13:11 reyk Exp $
d20 1
@


1.2
log
@Move vmt.c to sys/dev/pv/vmt.c.  The history is lost but can be found
in the Attic of sys/dev/vmt.c.

OK to do it deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: files.pv,v 1.1 2015/07/21 03:38:22 reyk Exp $
d15 5
@


1.1
log
@Add pvbus(4), a pseudo-bus to attach non-PCI paravirtual devices and buses.
vmt(4) is moved from mainbus0 to pvbus0, more devices will follow.

OK sf@@ deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD$
d14 1
a14 1
file	dev/vmt.c			vmt	needs-flag
@

