head	1.20;
access;
symbols
	OPENBSD_6_1:1.20.0.4
	OPENBSD_6_1_BASE:1.20
	OPENBSD_6_0:1.19.0.4
	OPENBSD_6_0_BASE:1.19
	OPENBSD_5_9:1.19.0.2
	OPENBSD_5_9_BASE:1.19
	OPENBSD_5_8:1.17.0.4
	OPENBSD_5_8_BASE:1.17
	OPENBSD_5_7:1.16.0.10
	OPENBSD_5_7_BASE:1.16
	OPENBSD_5_6:1.16.0.14
	OPENBSD_5_6_BASE:1.16
	OPENBSD_5_5:1.16.0.12
	OPENBSD_5_5_BASE:1.16
	OPENBSD_5_4:1.16.0.8
	OPENBSD_5_4_BASE:1.16
	OPENBSD_5_3:1.16.0.6
	OPENBSD_5_3_BASE:1.16
	OPENBSD_5_2:1.16.0.4
	OPENBSD_5_2_BASE:1.16
	OPENBSD_5_1_BASE:1.16
	OPENBSD_5_1:1.16.0.2
	OPENBSD_5_0:1.14.0.2
	OPENBSD_5_0_BASE:1.14
	OPENBSD_4_9:1.13.0.20
	OPENBSD_4_9_BASE:1.13
	OPENBSD_4_8:1.13.0.18
	OPENBSD_4_8_BASE:1.13
	OPENBSD_4_7:1.13.0.14
	OPENBSD_4_7_BASE:1.13
	OPENBSD_4_6:1.13.0.16
	OPENBSD_4_6_BASE:1.13
	OPENBSD_4_5:1.13.0.12
	OPENBSD_4_5_BASE:1.13
	OPENBSD_4_4:1.13.0.10
	OPENBSD_4_4_BASE:1.13
	OPENBSD_4_3:1.13.0.8
	OPENBSD_4_3_BASE:1.13
	OPENBSD_4_2:1.13.0.6
	OPENBSD_4_2_BASE:1.13
	OPENBSD_4_1:1.13.0.4
	OPENBSD_4_1_BASE:1.13
	OPENBSD_4_0:1.13.0.2
	OPENBSD_4_0_BASE:1.13
	OPENBSD_3_9:1.12.0.6
	OPENBSD_3_9_BASE:1.12
	OPENBSD_3_8:1.12.0.4
	OPENBSD_3_8_BASE:1.12
	OPENBSD_3_7:1.12.0.2
	OPENBSD_3_7_BASE:1.12
	OPENBSD_3_6:1.10.0.4
	OPENBSD_3_6_BASE:1.10
	OPENBSD_3_5:1.10.0.2
	OPENBSD_3_5_BASE:1.10
	OPENBSD_3_4:1.9.0.2
	OPENBSD_3_4_BASE:1.9
	OPENBSD_3_3:1.8.0.2
	OPENBSD_3_3_BASE:1.8
	OPENBSD_3_2:1.7.0.4
	OPENBSD_3_2_BASE:1.7
	OPENBSD_3_1:1.7.0.2
	OPENBSD_3_1_BASE:1.7
	OPENBSD_3_0:1.5.0.18
	OPENBSD_3_0_BASE:1.5
	OPENBSD_2_9:1.5.0.16
	OPENBSD_2_9_BASE:1.5
	OPENBSD_2_8:1.5.0.14
	OPENBSD_2_8_BASE:1.5
	OPENBSD_2_7:1.5.0.12
	OPENBSD_2_7_BASE:1.5
	OPENBSD_2_6:1.5.0.10
	OPENBSD_2_6_BASE:1.5
	OPENBSD_2_5:1.5.0.8
	OPENBSD_2_5_BASE:1.5
	OPENBSD_2_4:1.5.0.6
	OPENBSD_2_4_BASE:1.5
	OPENBSD_2_3:1.5.0.4
	OPENBSD_2_3_BASE:1.5
	OPENBSD_2_2:1.5.0.2
	OPENBSD_2_2_BASE:1.5
	OPENBSD_2_1:1.2.0.4
	OPENBSD_2_1_BASE:1.2
	OPENBSD_2_0:1.2.0.2
	OPENBSD_2_0_BASE:1.2
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@ * @;


1.20
date	2016.09.08.15.11.29;	author tedu;	state Exp;
branches;
next	1.19;
commitid	Ektj5UIXo8ssHb1H;

1.19
date	2016.01.10.14.04.16;	author schwarze;	state Exp;
branches;
next	1.18;
commitid	LRaYILYXBFr3pchR;

1.18
date	2015.12.30.14.59.10;	author tedu;	state Exp;
branches;
next	1.17;
commitid	pcpM0SacneEDdJB8;

1.17
date	2015.06.29.15.03.33;	author bluhm;	state Exp;
branches;
next	1.16;
commitid	zqqB6c65L8hxs5Kq;

1.16
date	2011.12.29.17.13.55;	author guenther;	state Exp;
branches;
next	1.15;

1.15
date	2011.12.11.00.16.49;	author nicm;	state Exp;
branches;
next	1.14;

1.14
date	2011.04.10.03.20.58;	author guenther;	state Exp;
branches;
next	1.13;

1.13
date	2006.05.02.05.25.19;	author hugh;	state Exp;
branches;
next	1.12;

1.12
date	2005.01.07.20.41.13;	author otto;	state Exp;
branches;
next	1.11;

1.11
date	2004.09.14.23.45.14;	author deraadt;	state Exp;
branches;
next	1.10;

1.10
date	2004.01.08.18.18.35;	author millert;	state Exp;
branches;
next	1.9;

1.9
date	2003.06.02.23.32.09;	author millert;	state Exp;
branches;
next	1.8;

1.8
date	2002.12.19.21.29.46;	author mickey;	state Exp;
branches;
next	1.7;

1.7
date	2002.02.16.21.27.07;	author millert;	state Exp;
branches;
next	1.6;

1.6
date	2001.12.05.02.23.59;	author art;	state Exp;
branches;
next	1.5;

1.5
date	97.09.03.13.51.39;	author kstailey;	state Exp;
branches;
next	1.4;

1.4
date	97.08.22.20.08.13;	author kstailey;	state Exp;
branches;
next	1.3;

1.3
date	97.08.04.05.37.03;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	96.06.23.14.20.48;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.37.19;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.37.19;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.20
log
@etime isn't just an alias for start. the output format is different.
diff from Carlin Bingham. ok millert.
@
text
@/*	$OpenBSD: extern.h,v 1.19 2016/01/10 14:04:16 schwarze Exp $	*/
/*	$NetBSD: extern.h,v 1.10 1995/05/21 13:38:27 mycroft Exp $	*/

/*-
 * Copyright (c) 1991, 1993, 1994
 *	The Regents of the University of California.  All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. Neither the name of the University nor the names of its contributors
 *    may be used to endorse or promote products derived from this software
 *    without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 *
 *	@@(#)extern.h	8.3 (Berkeley) 4/2/94
 */

struct nlist;
struct var;
struct varent;

extern fixpt_t ccpu;
extern int eval, fscale, nlistread, maxslp;
extern u_int mempages;
extern int sumrusage, termwidth, totwidth, kvm_sysctl_only, needheader;
extern VAR var[];
extern VARENT *vhead;

__BEGIN_DECLS
void	 command(const struct kinfo_proc *, VARENT *);
void	 cputime(const struct kinfo_proc *, VARENT *);
int	 donlist(void);
void	 emulname(const struct kinfo_proc *, VARENT *);
void	 elapsed(const struct kinfo_proc *, VARENT *);
double	 getpcpu(const struct kinfo_proc *);
double	 getpmem(const struct kinfo_proc *);
void	 gname(const struct kinfo_proc *, VARENT *);
void	 logname(const struct kinfo_proc *, VARENT *);
void	 longtname(const struct kinfo_proc *, VARENT *);
void	 lstarted(const struct kinfo_proc *, VARENT *);
void	 maxrss(const struct kinfo_proc *, VARENT *);
void	 nlisterr(struct nlist *);
void	 p_rssize(const struct kinfo_proc *, VARENT *);
void	 pagein(const struct kinfo_proc *, VARENT *);
void	 parsefmt(char *);
void	 pcpu(const struct kinfo_proc *, VARENT *);
void	 pmem(const struct kinfo_proc *, VARENT *);
void	 pri(const struct kinfo_proc *, VARENT *);
void	 printheader(void);
void	 pvar(const struct kinfo_proc *kp, VARENT *);
void	 pnice(const struct kinfo_proc *kp, VARENT *);
void	 rgname(const struct kinfo_proc *, VARENT *);
void	 rssize(const struct kinfo_proc *, VARENT *);
void	 runame(const struct kinfo_proc *, VARENT *);
void	 showkey(void);
void	 started(const struct kinfo_proc *, VARENT *);
void	 printstate(const struct kinfo_proc *, VARENT *);
void	 tdev(const struct kinfo_proc *, VARENT *);
void	 tname(const struct kinfo_proc *, VARENT *);
void	 tsize(const struct kinfo_proc *, VARENT *);
void	 dsize(const struct kinfo_proc *, VARENT *);
void	 ssize(const struct kinfo_proc *, VARENT *);
void	 ucomm(const struct kinfo_proc *, VARENT *);
void	 curwd(const struct kinfo_proc *, VARENT *);
void	 euname(const struct kinfo_proc *, VARENT *);
void	 vsize(const struct kinfo_proc *, VARENT *);
void	 wchan(const struct kinfo_proc *, VARENT *);
__END_DECLS
@


1.19
log
@UTF-8 support:
In a UTF-8 locale, columnate correctly and replace valid, but non-
printable characters with the Unicode replacement character U+FFFD.
No change in the C/POSIX locale, and no change for invalid bytes.
Grand total, the code becomes shorter by almost 30 lines.
Feedback from czarkoff@@, OK millert@@.
@
text
@d1 1
a1 1
/*	$OpenBSD: extern.h,v 1.18 2015/12/30 14:59:10 tedu Exp $	*/
d51 1
@


1.18
log
@rename a few variables/functions to avoid shadowing
@
text
@d1 1
a1 1
/*	$OpenBSD: extern.h,v 1.17 2015/06/29 15:03:33 bluhm Exp $	*/
a50 2
void	 fmt_puts(const char *, int *);
void	 fmt_putc(int, int *);
@


1.17
log
@After removing the p_swtime from the kernel, ps always printed 0.0
as %cpu time.  Remove the calculation in ps that includes the process
lifetime.  Just print the p_pctcpu value, that was done before when
ps was called with -C.  Keep -C as a no-op for existing scripts.
OK millert@@
@
text
@d1 1
a1 1
/*	$OpenBSD: extern.h,v 1.16 2011/12/29 17:13:55 guenther Exp $	*/
d75 1
a75 1
void	 state(const struct kinfo_proc *, VARENT *);
@


1.16
log
@Suppress the header line if all the field headers have been set to empty.

ok millert@@
@
text
@d1 1
a1 1
/*	$OpenBSD: extern.h,v 1.15 2011/12/11 00:16:49 nicm Exp $	*/
d40 1
a40 1
extern int eval, fscale, nlistread, rawcpu, maxslp;
@


1.15
log
@Make ps understand -o cwd using the new KERN_PROC_CWD sysctl. Some help
and suggestions from guenther.

ok guenther
@
text
@d1 1
a1 1
/*	$OpenBSD: extern.h,v 1.14 2011/04/10 03:20:58 guenther Exp $	*/
d42 1
a42 1
extern int sumrusage, termwidth, totwidth, kvm_sysctl_only;
@


1.14
log
@Switch back from KERN_PROC2/kinfo_proc2 to KERN_PROC/kinfo_proc now
that we've got name we want for the API we want

"ZAP!" deraadt@@
@
text
@d1 1
a1 1
/*	$OpenBSD: extern.h,v 1.13 2006/05/02 05:25:19 hugh Exp $	*/
d42 1
a42 1
extern int sumrusage, termwidth, totwidth;
d82 1
@


1.13
log
@Format nicelevel relative NZERO as other tools do.
Surely, says millert.
@
text
@d1 1
a1 1
/*	$OpenBSD: extern.h,v 1.12 2005/01/07 20:41:13 otto Exp $	*/
d47 2
a48 2
void	 command(const struct kinfo_proc2 *, VARENT *);
void	 cputime(const struct kinfo_proc2 *, VARENT *);
d50 1
a50 1
void	 emulname(const struct kinfo_proc2 *, VARENT *);
d53 7
a59 7
double	 getpcpu(const struct kinfo_proc2 *);
double	 getpmem(const struct kinfo_proc2 *);
void	 gname(const struct kinfo_proc2 *, VARENT *);
void	 logname(const struct kinfo_proc2 *, VARENT *);
void	 longtname(const struct kinfo_proc2 *, VARENT *);
void	 lstarted(const struct kinfo_proc2 *, VARENT *);
void	 maxrss(const struct kinfo_proc2 *, VARENT *);
d61 2
a62 2
void	 p_rssize(const struct kinfo_proc2 *, VARENT *);
void	 pagein(const struct kinfo_proc2 *, VARENT *);
d64 3
a66 3
void	 pcpu(const struct kinfo_proc2 *, VARENT *);
void	 pmem(const struct kinfo_proc2 *, VARENT *);
void	 pri(const struct kinfo_proc2 *, VARENT *);
d68 5
a72 5
void	 pvar(const struct kinfo_proc2 *kp, VARENT *);
void	 pnice(const struct kinfo_proc2 *kp, VARENT *);
void	 rgname(const struct kinfo_proc2 *, VARENT *);
void	 rssize(const struct kinfo_proc2 *, VARENT *);
void	 runame(const struct kinfo_proc2 *, VARENT *);
d74 11
a84 11
void	 started(const struct kinfo_proc2 *, VARENT *);
void	 state(const struct kinfo_proc2 *, VARENT *);
void	 tdev(const struct kinfo_proc2 *, VARENT *);
void	 tname(const struct kinfo_proc2 *, VARENT *);
void	 tsize(const struct kinfo_proc2 *, VARENT *);
void	 dsize(const struct kinfo_proc2 *, VARENT *);
void	 ssize(const struct kinfo_proc2 *, VARENT *);
void	 ucomm(const struct kinfo_proc2 *, VARENT *);
void	 euname(const struct kinfo_proc2 *, VARENT *);
void	 vsize(const struct kinfo_proc2 *, VARENT *);
void	 wchan(const struct kinfo_proc2 *, VARENT *);
@


1.12
log
@avoid negative memory sizes, ok deraadt@@
@
text
@d1 1
a1 1
/*	$OpenBSD: extern.h,v 1.11 2004/09/14 23:45:14 deraadt Exp $	*/
d69 1
@


1.11
log
@rename internal uname() to euname() to avoid libc conflict
@
text
@d1 1
a1 1
/*	$OpenBSD: extern.h,v 1.10 2004/01/08 18:18:35 millert Exp $	*/
d40 2
a41 1
extern int eval, fscale, mempages, nlistread, rawcpu, maxslp;
@


1.10
log
@Convert to kinfo_proc2.  The sort order for -u and -m will be different
due to a bug fix in the sort routine.
@
text
@d1 1
a1 1
/*	$OpenBSD: extern.h,v 1.9 2003/06/02 23:32:09 millert Exp $	*/
d80 1
a80 1
void	 uname(const struct kinfo_proc2 *, VARENT *);
@


1.9
log
@Remove the advertising clause in the UCB license which Berkeley
rescinded 22 July 1999.  Proofed by myself and Theo.
@
text
@d1 1
a1 1
/*	$OpenBSD: extern.h,v 1.8 2002/12/19 21:29:46 mickey Exp $	*/
a34 1
struct kinfo;
d46 2
a47 2
void	 command(KINFO *, VARENT *);
void	 cputime(KINFO *, VARENT *);
d49 2
a50 3
void	 evar(KINFO *, VARENT *);
void	 emulname(KINFO *, VARENT *);
void	 fmt_puts(char *, int *);
d52 7
a58 7
double	 getpcpu(KINFO *);
double	 getpmem(KINFO *);
void	 gname(KINFO *, VARENT *);
void	 logname(KINFO *, VARENT *);
void	 longtname(KINFO *, VARENT *);
void	 lstarted(KINFO *, VARENT *);
void	 maxrss(KINFO *, VARENT *);
d60 2
a61 2
void	 p_rssize(KINFO *, VARENT *);
void	 pagein(KINFO *, VARENT *);
d63 3
a65 3
void	 pcpu(KINFO *, VARENT *);
void	 pmem(KINFO *, VARENT *);
void	 pri(KINFO *, VARENT *);
d67 4
a70 5
void	 pvar(KINFO *, VARENT *);
void	 rgname(KINFO *, VARENT *);
void	 rssize(KINFO *, VARENT *);
void	 runame(KINFO *, VARENT *);
void	 rvar(KINFO *, VARENT *);
d72 11
a82 12
void	 started(KINFO *, VARENT *);
void	 state(KINFO *, VARENT *);
void	 tdev(KINFO *, VARENT *);
void	 tname(KINFO *, VARENT *);
void	 tsize(KINFO *, VARENT *);
void	 dsize(KINFO *, VARENT *);
void	 ssize(KINFO *, VARENT *);
void	 ucomm(KINFO *, VARENT *);
void	 uname(KINFO *, VARENT *);
void	 uvar(KINFO *, VARENT *);
void	 vsize(KINFO *, VARENT *);
void	 wchan(KINFO *, VARENT *);
@


1.8
log
@add dsiz and ssiz to accompany tsiz; millert@@ ok
@
text
@d1 1
a1 1
/*	$OpenBSD: extern.h,v 1.7 2002/02/16 21:27:07 millert Exp $	*/
d16 1
a16 5
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 *	This product includes software developed by the University of
 *	California, Berkeley and its contributors.
 * 4. Neither the name of the University nor the names of its contributors
@


1.7
log
@Part one of userland __P removal.  Done with a simple regexp with some minor hand editing to make comments line up correctly.  Another pass is forthcoming that handles the cases that could not be done automatically.
@
text
@d1 1
a1 1
/*	$OpenBSD: extern.h,v 1.6 2001/12/05 02:23:59 art Exp $	*/
d84 2
@


1.6
log
@Get MAXSLP from kvm/sysctl. It's patchable in the kernel now.
@
text
@d1 1
a1 1
/*	$OpenBSD: extern.h,v 1.5 1997/09/03 13:51:39 kstailey Exp $	*/
d51 38
a88 38
void	 command __P((KINFO *, VARENT *));
void	 cputime __P((KINFO *, VARENT *));
int	 donlist __P((void));
void	 evar __P((KINFO *, VARENT *));
void	 emulname  __P((KINFO *, VARENT *));
void	 fmt_puts __P((char *, int *));
void	 fmt_putc __P((int, int *));
double	 getpcpu __P((KINFO *));
double	 getpmem __P((KINFO *));
void	 gname __P((KINFO *, VARENT *));
void	 logname __P((KINFO *, VARENT *));
void	 longtname __P((KINFO *, VARENT *));
void	 lstarted __P((KINFO *, VARENT *));
void	 maxrss __P((KINFO *, VARENT *));
void	 nlisterr __P((struct nlist *));
void	 p_rssize __P((KINFO *, VARENT *));
void	 pagein __P((KINFO *, VARENT *));
void	 parsefmt __P((char *));
void	 pcpu __P((KINFO *, VARENT *));
void	 pmem __P((KINFO *, VARENT *));
void	 pri __P((KINFO *, VARENT *));
void	 printheader __P((void));
void	 pvar __P((KINFO *, VARENT *));
void	 rgname __P((KINFO *, VARENT *));
void	 rssize __P((KINFO *, VARENT *));
void	 runame __P((KINFO *, VARENT *));
void	 rvar __P((KINFO *, VARENT *));
void	 showkey __P((void));
void	 started __P((KINFO *, VARENT *));
void	 state __P((KINFO *, VARENT *));
void	 tdev __P((KINFO *, VARENT *));
void	 tname __P((KINFO *, VARENT *));
void	 tsize __P((KINFO *, VARENT *));
void	 ucomm __P((KINFO *, VARENT *));
void	 uname __P((KINFO *, VARENT *));
void	 uvar __P((KINFO *, VARENT *));
void	 vsize __P((KINFO *, VARENT *));
void	 wchan __P((KINFO *, VARENT *));
@


1.5
log
@add ps "emul" option
@
text
@d1 1
a1 1
/*	$OpenBSD: extern.h,v 1.4 1997/08/22 20:08:13 kstailey Exp $	*/
d45 1
a45 1
extern int eval, fscale, mempages, nlistread, rawcpu;
@


1.4
log
@XPG4 compatibility for format options:
two new options: group and rgroup.
three new aliases: etime for start, comm for ucomm, and args for command.
@
text
@d1 1
a1 1
/*	$OpenBSD: extern.h,v 1.3 1997/08/04 05:37:03 deraadt Exp $	*/
d55 1
@


1.3
log
@toast non-NEWVM code; freebsd
@
text
@d1 1
a1 1
/*	$OpenBSD: extern.h,v 1.2 1996/06/23 14:20:48 deraadt Exp $	*/
d59 1
d73 1
@


1.2
log
@update rcsid
@
text
@d1 1
a1 1
/*	$OpenBSD: extern.h,v 1.10 1995/05/21 13:38:27 mycroft Exp $	*/
a79 3
#ifndef NEWVM
void	 trss __P((KINFO *, VARENT *));
#endif
@


1.1
log
@Initial revision
@
text
@d1 1
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
