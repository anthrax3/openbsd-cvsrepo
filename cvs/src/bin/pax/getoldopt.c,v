head	1.9;
access;
symbols
	OPENBSD_6_1_BASE:1.9
	OPENBSD_6_0:1.9.0.28
	OPENBSD_6_0_BASE:1.9
	OPENBSD_5_9:1.9.0.24
	OPENBSD_5_9_BASE:1.9
	OPENBSD_5_8:1.9.0.26
	OPENBSD_5_8_BASE:1.9
	OPENBSD_5_7:1.9.0.18
	OPENBSD_5_7_BASE:1.9
	OPENBSD_5_6:1.9.0.22
	OPENBSD_5_6_BASE:1.9
	OPENBSD_5_5:1.9.0.20
	OPENBSD_5_5_BASE:1.9
	OPENBSD_5_4:1.9.0.16
	OPENBSD_5_4_BASE:1.9
	OPENBSD_5_3:1.9.0.14
	OPENBSD_5_3_BASE:1.9
	OPENBSD_5_2:1.9.0.12
	OPENBSD_5_2_BASE:1.9
	OPENBSD_5_1_BASE:1.9
	OPENBSD_5_1:1.9.0.10
	OPENBSD_5_0:1.9.0.8
	OPENBSD_5_0_BASE:1.9
	OPENBSD_4_9:1.9.0.6
	OPENBSD_4_9_BASE:1.9
	OPENBSD_4_8:1.9.0.4
	OPENBSD_4_8_BASE:1.9
	OPENBSD_4_7:1.9.0.2
	OPENBSD_4_7_BASE:1.9
	OPENBSD_4_6:1.8.0.28
	OPENBSD_4_6_BASE:1.8
	OPENBSD_4_5:1.8.0.24
	OPENBSD_4_5_BASE:1.8
	OPENBSD_4_4:1.8.0.22
	OPENBSD_4_4_BASE:1.8
	OPENBSD_4_3:1.8.0.20
	OPENBSD_4_3_BASE:1.8
	OPENBSD_4_2:1.8.0.18
	OPENBSD_4_2_BASE:1.8
	OPENBSD_4_1:1.8.0.16
	OPENBSD_4_1_BASE:1.8
	OPENBSD_4_0:1.8.0.14
	OPENBSD_4_0_BASE:1.8
	OPENBSD_3_9:1.8.0.12
	OPENBSD_3_9_BASE:1.8
	OPENBSD_3_8:1.8.0.10
	OPENBSD_3_8_BASE:1.8
	OPENBSD_3_7:1.8.0.8
	OPENBSD_3_7_BASE:1.8
	OPENBSD_3_6:1.8.0.6
	OPENBSD_3_6_BASE:1.8
	OPENBSD_3_5:1.8.0.4
	OPENBSD_3_5_BASE:1.8
	OPENBSD_3_4:1.8.0.2
	OPENBSD_3_4_BASE:1.8
	OPENBSD_3_3:1.7.0.2
	OPENBSD_3_3_BASE:1.7
	OPENBSD_3_2:1.4.0.12
	OPENBSD_3_2_BASE:1.4
	OPENBSD_3_1:1.4.0.10
	OPENBSD_3_1_BASE:1.4
	OPENBSD_3_0:1.4.0.8
	OPENBSD_3_0_BASE:1.4
	OPENBSD_2_9:1.4.0.6
	OPENBSD_2_9_BASE:1.4
	OPENBSD_2_8:1.4.0.4
	OPENBSD_2_8_BASE:1.4
	OPENBSD_2_7:1.4.0.2
	OPENBSD_2_7_BASE:1.4
	OPENBSD_2_6:1.3.0.10
	OPENBSD_2_6_BASE:1.3
	OPENBSD_2_5:1.3.0.8
	OPENBSD_2_5_BASE:1.3
	OPENBSD_2_4:1.3.0.6
	OPENBSD_2_4_BASE:1.3
	OPENBSD_2_3:1.3.0.4
	OPENBSD_2_3_BASE:1.3
	OPENBSD_2_2:1.3.0.2
	OPENBSD_2_2_BASE:1.3
	OPENBSD_2_1:1.2.0.4
	OPENBSD_2_1_BASE:1.2
	OPENBSD_2_0:1.2.0.2
	OPENBSD_2_0_BASE:1.2
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@ * @;


1.9
date	2009.10.27.23.59.22;	author deraadt;	state Exp;
branches;
next	1.8;

1.8
date	2003.07.02.21.19.33;	author deraadt;	state Exp;
branches;
next	1.7;

1.7
date	2002.10.16.19.20.02;	author millert;	state Exp;
branches;
next	1.6;

1.6
date	2002.10.16.18.44.19;	author millert;	state Exp;
branches;
next	1.5;

1.5
date	2002.10.16.18.40.30;	author millert;	state Exp;
branches;
next	1.4;

1.4
date	2000.01.22.20.24.51;	author deraadt;	state Exp;
branches;
next	1.3;

1.3
date	97.09.01.18.29.52;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	96.06.23.14.20.36;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.37.17;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.37.17;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.9
log
@rcsid[] and sccsid[] and copyright[] are essentially unmaintained (and
unmaintainable).  these days, people use source.  these id's do not provide
any benefit, and do hurt the small install media
(the 33,000 line diff is essentially mechanical)
ok with the idea millert, ok dms
@
text
@/*	$OpenBSD: getoldopt.c,v 1.8 2003/07/02 21:19:33 deraadt Exp $	*/
/*	$NetBSD: getoldopt.c,v 1.3 1995/03/21 09:07:28 cgd Exp $	*/

/*
 * Plug-compatible replacement for getopt() for parsing tar-like
 * arguments.  If the first argument begins with "-", it uses getopt;
 * otherwise, it uses the old rules used by tar, dump, and ps.
 *
 * Written 25 August 1985 by John Gilmore (ihnp4!hoptoad!gnu) and placed
 * in the Public Domain for your edification and enjoyment.
 */

#include <sys/types.h>
#include <sys/stat.h>
#include <stdio.h>
#include <string.h>
#include <unistd.h>
#include "pax.h"
#include "extern.h"

int
getoldopt(int argc, char **argv, const char *optstring)
{
	static char	*key;		/* Points to next keyletter */
	static char	use_getopt;	/* !=0 if argv[1][0] was '-' */
	char		c;
	char		*place;

	optarg = NULL;

	if (key == NULL) {		/* First time */
		if (argc < 2)
			return (-1);
		key = argv[1];
		if (*key == '-')
			use_getopt++;
		else
			optind = 2;
	}

	if (use_getopt)
		return (getopt(argc, argv, optstring));

	c = *key++;
	if (c == '\0') {
		key--;
		return (-1);
	}
	place = strchr(optstring, c);

	if (place == NULL || c == ':') {
		fprintf(stderr, "%s: unknown option %c\n", argv[0], c);
		return ('?');
	}

	place++;
	if (*place == ':') {
		if (optind < argc) {
			optarg = argv[optind];
			optind++;
		} else {
			fprintf(stderr, "%s: %c argument missing\n",
				argv[0], c);
			return ('?');
		}
	}

	return (c);
}
@


1.8
log
@missing protos
@
text
@d1 1
a1 1
/*	$OpenBSD: getoldopt.c,v 1.7 2002/10/16 19:20:02 millert Exp $	*/
a11 4

#ifndef lint
static const char rcsid[] = "$OpenBSD: getoldopt.c,v 1.7 2002/10/16 19:20:02 millert Exp $";
#endif /* not lint */
@


1.7
log
@sprinkle const; mostly from NetBSD
@
text
@d1 1
a1 1
/*	$OpenBSD: getoldopt.c,v 1.6 2002/10/16 18:44:19 millert Exp $	*/
d14 1
a14 1
static const char rcsid[] = "$OpenBSD: getoldopt.c,v 1.6 2002/10/16 18:44:19 millert Exp $";
d17 2
d22 2
@


1.6
log
@Slight KNF and return -1 on no match, not EOF
@
text
@d1 1
a1 1
/*	$OpenBSD: getoldopt.c,v 1.5 2002/10/16 18:40:30 millert Exp $	*/
d14 1
a14 1
static char rcsid[] = "$OpenBSD: getoldopt.c,v 1.5 2002/10/16 18:40:30 millert Exp $";
d22 1
a22 1
getoldopt(int argc, char **argv, char *optstring)
@


1.5
log
@Fix comment typos; most from NetBSD and FreeBSD
@
text
@d1 1
a1 1
/*	$OpenBSD: getoldopt.c,v 1.4 2000/01/22 20:24:51 deraadt Exp $	*/
d14 1
a14 1
static char rcsid[] = "$OpenBSD: getoldopt.c,v 1.4 2000/01/22 20:24:51 deraadt Exp $";
d22 1
a22 4
getoldopt(argc, argv, optstring)
	int	argc;
	char	**argv;
	char	*optstring;
d32 2
a33 1
		if (argc < 2) return EOF;
d42 1
a42 1
		return getopt(argc, argv, optstring);
d47 1
a47 1
		return EOF;
d53 1
a53 1
		return('?');
d64 1
a64 1
			return('?');
d68 1
a68 1
	return(c);
@


1.4
log
@remove extra externs not needed because of unistd.h (rest of tree will be done later.. contact me if you want to help)
@
text
@d1 1
a1 1
/*	$OpenBSD: getoldopt.c,v 1.3 1997/09/01 18:29:52 deraadt Exp $	*/
d10 1
a10 1
 * in the Pubic Domain for your edification and enjoyment.
d14 1
a14 1
static char rcsid[] = "$OpenBSD: getoldopt.c,v 1.3 1997/09/01 18:29:52 deraadt Exp $";
@


1.3
log
@i am bored enough to fix terminal space/tab uglies
@
text
@d1 1
a1 1
/*	$OpenBSD: getoldopt.c,v 1.2 1996/06/23 14:20:36 deraadt Exp $	*/
d14 1
a14 1
static char rcsid[] = "$OpenBSD: getoldopt.c,v 1.2 1996/06/23 14:20:36 deraadt Exp $";
a26 2
	extern char	*optarg;	/* Points to next arg */
	extern int	optind;		/* Global argv index */
@


1.2
log
@update rcsid
@
text
@d1 1
a1 1
/*	$OpenBSD: getoldopt.c,v 1.3 1995/03/21 09:07:28 cgd Exp $	*/
d14 1
a14 1
static char rcsid[] = "$OpenBSD: getoldopt.c,v 1.3 1995/03/21 09:07:28 cgd Exp $";
d35 1
a35 1
	
@


1.1
log
@Initial revision
@
text
@d1 1
d14 1
a14 1
static char rcsid[] = "$NetBSD: getoldopt.c,v 1.3 1995/03/21 09:07:28 cgd Exp $";
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
