head	1.29;
access;
symbols
	OPENBSD_6_0:1.29.0.6
	OPENBSD_6_0_BASE:1.29
	OPENBSD_5_9:1.29.0.2
	OPENBSD_5_9_BASE:1.29
	OPENBSD_5_8:1.23.0.6
	OPENBSD_5_8_BASE:1.23
	OPENBSD_5_7:1.23.0.2
	OPENBSD_5_7_BASE:1.23
	OPENBSD_5_6:1.22.0.8
	OPENBSD_5_6_BASE:1.22
	OPENBSD_5_5:1.22.0.4
	OPENBSD_5_5_BASE:1.22
	OPENBSD_5_4:1.22.0.2
	OPENBSD_5_4_BASE:1.22
	OPENBSD_5_3:1.21.0.2
	OPENBSD_5_3_BASE:1.21
	OPENBSD_5_2:1.17.0.2
	OPENBSD_5_2_BASE:1.17
	OPENBSD_5_1_BASE:1.15
	OPENBSD_5_1:1.15.0.2
	OPENBSD_5_0:1.14.0.4
	OPENBSD_5_0_BASE:1.14
	OPENBSD_4_9:1.14.0.2
	OPENBSD_4_9_BASE:1.14
	OPENBSD_4_8:1.13.0.4
	OPENBSD_4_8_BASE:1.13
	OPENBSD_4_7:1.13.0.2
	OPENBSD_4_7_BASE:1.13
	OPENBSD_4_6:1.7.0.4
	OPENBSD_4_6_BASE:1.7
	OPENBSD_4_5:1.5.0.2
	OPENBSD_4_5_BASE:1.5;
locks; strict;
comment	@.\" @;


1.29
date	2016.02.13.08.53.18;	author gilles;	state Exp;
branches;
next	1.28;
commitid	746RTjP2xtXLq8rn;

1.28
date	2015.12.14.10.17.45;	author jmc;	state Exp;
branches;
next	1.27;
commitid	nzkFyymvKj0flvVK;

1.27
date	2015.12.14.09.22.57;	author sunil;	state Exp;
branches;
next	1.26;
commitid	NfthZiGDp6LRItGf;

1.26
date	2015.12.11.07.10.06;	author guenther;	state Exp;
branches;
next	1.25;
commitid	G9fbs9KCMydJ1jec;

1.25
date	2015.10.17.19.42.12;	author gilles;	state Exp;
branches;
next	1.24;
commitid	NLlKwcQw1t36xyNt;

1.24
date	2015.09.29.13.57.01;	author millert;	state Exp;
branches;
next	1.23;
commitid	VYlLS8e6fTuq72Gu;

1.23
date	2014.09.16.21.18.19;	author jmc;	state Exp;
branches;
next	1.22;
commitid	bZIjVIhWdygfgLCK;

1.22
date	2013.07.19.15.17.01;	author eric;	state Exp;
branches;
next	1.21;

1.21
date	2013.01.26.14.13.25;	author jmc;	state Exp;
branches;
next	1.20;

1.20
date	2013.01.26.09.37.23;	author gilles;	state Exp;
branches;
next	1.19;

1.19
date	2012.11.18.22.38.57;	author jmc;	state Exp;
branches;
next	1.18;

1.18
date	2012.11.18.22.08.56;	author rpe;	state Exp;
branches;
next	1.17;

1.17
date	2012.05.13.13.57.24;	author jmc;	state Exp;
branches;
next	1.16;

1.16
date	2012.05.12.21.49.31;	author gilles;	state Exp;
branches;
next	1.15;

1.15
date	2011.10.10.21.06.06;	author gilles;	state Exp;
branches;
next	1.14;

1.14
date	2010.09.03.11.22.36;	author jmc;	state Exp;
branches;
next	1.13;

1.13
date	2009.11.04.08.31.26;	author jmc;	state Exp;
branches;
next	1.12;

1.12
date	2009.11.03.23.10.31;	author gilles;	state Exp;
branches;
next	1.11;

1.11
date	2009.10.19.21.19.13;	author gilles;	state Exp;
branches;
next	1.10;

1.10
date	2009.10.11.17.40.49;	author gilles;	state Exp;
branches;
next	1.9;

1.9
date	2009.09.25.13.44.33;	author jmc;	state Exp;
branches;
next	1.8;

1.8
date	2009.09.22.13.05.20;	author jmc;	state Exp;
branches;
next	1.7;

1.7
date	2009.03.23.21.48.40;	author jmc;	state Exp;
branches;
next	1.6;

1.6
date	2009.03.16.20.43.29;	author gilles;	state Exp;
branches;
next	1.5;

1.5
date	2009.02.17.23.46.03;	author jacekm;	state Exp;
branches;
next	1.4;

1.4
date	2009.02.14.18.37.12;	author jacekm;	state Exp;
branches;
next	1.3;

1.3
date	2008.12.17.22.59.36;	author jacekm;	state Exp;
branches;
next	1.2;

1.2
date	2008.12.04.06.22.05;	author jmc;	state Exp;
branches;
next	1.1;

1.1
date	2008.12.03.21.20.20;	author gilles;	state Exp;
branches;
next	;


desc
@@


1.29
log
@remove support for 'dbm' which is really 'recno' from our makemap, it can't
work because it requires dbopen() to be the call that creates the db, while
we want mkstemp() to create an empty db ourselves.

it has never worked, no one could ever create a recno db with our makemap &
no one actually noticed so drop it.

ok millert@@, sunil@@, jung@@
@
text
@.\"	$OpenBSD: makemap.8,v 1.28 2015/12/14 10:17:45 jmc Exp $
.\"
.\" Copyright (c) 2009 Jacek Masiulaniec <jacekm@@openbsd.org>
.\" Copyright (c) 2008-2009 Gilles Chehade <gilles@@poolp.org>
.\"
.\" Permission to use, copy, modify, and distribute this software for any
.\" purpose with or without fee is hereby granted, provided that the above
.\" copyright notice and this permission notice appear in all copies.
.\"
.\" THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
.\" WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
.\" MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
.\" ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
.\" WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
.\" ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
.\" OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
.\"
.Dd $Mdocdate: December 14 2015 $
.Dt MAKEMAP 8
.Os
.Sh NAME
.Nm makemap
.Nd create database maps for smtpd
.Sh SYNOPSIS
.Nm makemap
.Op Fl U
.Op Fl d Ar dbtype
.Op Fl o Ar dbfile
.Op Fl t Ar type
.Ar file
.Sh DESCRIPTION
Maps provide a generic interface for associating textual key to a value.
Such associations may be accessed through a plaintext file, database, or DNS.
The format of these file types is described below.
.Nm
itself creates the database maps used by keyed map lookups specified in
.Xr smtpd.conf 5 .
.Pp
.Nm
reads input from
.Ar file
and writes data to a file whose name is made by adding a
.Dq .db
suffix to
.Ar file .
The current line can be extended over multiple lines using a backslash
.Pq Sq \e .
Comments can be put anywhere in the file using a hash mark
.Pq Sq # ,
and extend to the end of the current line.
Care should be taken when commenting out multi-line text:
the comment is effective until the end of the entire block.
In all cases,
.Nm
reads lines consisting of words separated by whitespace.
The first word of a line is the database key;
the remainder represents the mapped value.
The database key and value may optionally be separated
by the colon character.
.Pp
The options are as follows:
.Bl -tag -width Ds
.It Fl d Ar dbtype
Specify the format of the database.
Available formats are
.Ar hash
and
.Ar btree .
The default value is
.Ar hash .
.It Fl o Ar dbfile
Write the generated database to
.Ar dbfile .
.It Fl t Ar type
Specify the format of the resulting map file.
The default map format is suitable for storing simple, unstructured,
key-to-value string associations.
However, if the mapped value has special meaning,
as in the case of the virtual domains file,
a suitable
.Ar type
must be provided.
The available output types are:
.Bl -tag -width "aliases"
.It Cm aliases
The mapped value is a comma-separated list of mail destinations.
This format can be used for building user aliases and
user mappings for virtual domain files.
.It Cm set
There is no mapped value \(en a map of this type will only allow for
the lookup of keys.
This format can be used for building primary domain maps.
.El
.It Fl U
Instead of generating a database map from text input,
dump the contents of a database map as text
with the key and value separated with a tab.
.El
.Sh PRIMARY DOMAINS
Primary domains can be kept in tables.
To create a primary domain table, add each primary domain on a
single line by itself.
.Pp
In addition to adding an entry to the primary domain map,
one must add a filter rule that accepts mail for the domain
map, for example:
.Bd -literal -offset indent
table domains "/etc/mail/domains"
accept for domain <domains> deliver to mbox
.Ed
.Sh VIRTUAL DOMAINS
Virtual domains may also be kept in tables.
To create a virtual domain table, add each virtual domain on a
single line by itself.
.Pp
Virtual domains expect a mapping of virtual users to real users
in order to determine if a recipient is accepted or not.
The mapping format is an extension to
.Xr aliases 5 ,
which allows the use of
.Dq user@@domain.tld
to accept user only on the specified domain,
.Dq user
to accept the user for any of the virtual domains,
.Dq @@domain.tld
to provide a catch-all for the specified domain and
.Dq @@
to provide a global catch-all for all domains.
.Xr smtpd 8
will perform the lookups in that specific order.
.Pp
To create single virtual address, add
.Dq user@@example.com user
to the users map.
To handle all mail destined to any user at example.com, add
.Dq @@example.com user
to the virtual map.
.Pp
In addition to adding an entry to the virtual map,
one must add a filter rule that accepts mail for virtual domains,
for example:
.Bd -literal -offset indent
table vdomains "/etc/mail/vdomains"
table vusers "/etc/mail/users"

accept for domain <vdomains> virtual <vusers> deliver to mbox
accept for domain example.org virtual <vusers> deliver to mbox
.Ed
.Sh FILES
.Bl -tag -width "/etc/mail/aliasesXXX" -compact
.It Pa /etc/mail/aliases
List of user mail aliases.
.It Pa /etc/mail/secrets
List of remote host credentials.
.El
.Sh EXIT STATUS
.Ex -std makemap
.Sh SEE ALSO
.Xr aliases 5 ,
.Xr smtpd.conf 5 ,
.Xr table 5 ,
.Xr newaliases 8 ,
.Xr smtpd 8
.Sh HISTORY
The
.Nm
command first appeared in
.Ox 4.6
as a replacement for the equivalent command shipped with sendmail.
@


1.28
log
@oops, sorry sunil, -d was in the wrong place:
so much for my ok ;(
@
text
@d1 1
a1 1
.\"	$OpenBSD: makemap.8,v 1.27 2015/12/14 09:22:57 sunil Exp $
d66 1
a66 2
.Ar hash ,
.Ar btree
d68 1
a68 1
.Ar dbm .
@


1.27
log
@Document -d option.

Ok gilles@@ jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: makemap.8,v 1.26 2015/12/11 07:10:06 guenther Exp $
d18 1
a18 1
.Dd $Mdocdate: December 11 2015 $
d63 9
a98 9
.It Fl d Ar dbtype
Specify the format of the database.
Available formats are
.Ar hash ,
.Ar btree
and
.Ar dbm .
The default value is
.Ar hash .
@


1.26
log
@Add -U option like the sendmail makemap, for dumping DB files back to text

ok sunil@@ gilles@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: makemap.8,v 1.25 2015/10/17 19:42:12 gilles Exp $
d18 1
a18 1
.Dd $Mdocdate: October 17 2015 $
d27 1
d90 9
@


1.25
log
@document handling of comments in makemap

ok millert@@, ok sunil@@, ok jung@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: makemap.8,v 1.24 2015/09/29 13:57:01 millert Exp $
d18 1
a18 1
.Dd $Mdocdate: September 29 2015 $
d26 1
d85 4
@


1.24
log
@makemap(8) should Xr table(5); OK gilles@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: makemap.8,v 1.23 2014/09/16 21:18:19 jmc Exp $
d18 1
a18 1
.Dd $Mdocdate: September 16 2014 $
d44 7
@


1.23
log
@there is no editmap;
@
text
@d1 1
a1 1
.\"	$OpenBSD: makemap.8,v 1.22 2013/07/19 15:17:01 eric Exp $
d18 1
a18 1
.Dd $Mdocdate: July 19 2013 $
d140 1
@


1.22
log
@typo in copyright
@
text
@d1 1
a1 1
.\"	$OpenBSD$
d18 1
a18 1
.Dd $Mdocdate: January 26 2013 $
a139 1
.Xr editmap 8 ,
@


1.21
log
@tweak previous;
@
text
@d1 1
a1 1
.\"	$OpenBSD: makemap.8,v 1.20 2013/01/26 09:37:23 gilles Exp $
d4 1
a4 1
.\" Copyright (c) 2008-2009 Gilles Chechade <gilles@@poolp.org>
@


1.20
log
@Sync with our smtpd repo:

* first bricks of ldap and sqlite support (not finished but both working)
* new table API to replace map API, all lookups are done through tables
* improved handling of temporary errors throughout the daemon
* improved scheduler and mta logic: connection reuse, optimizes batches
* improved queue: more tolerant to admin errors, new layout, less disk-IO
* improved memory usage under high load
* SSL certs/keys isolated to lookup process to avoid facing network
* VIRTUAL support improved, fully virtual setups possible now
* runtime tracing of processes through smtpctl trace
* ssl_privsep.c sync-ed with relayd
* ssl.c no longer contains smtpd specific interfaces
* smtpd-specific ssl bits moved to ssl_smtpd.c
* update mail address in copyright

FLUSH YOUR QUEUE. FLUSH YOUR QUEUE. FLUSH YOUR QUEUE. FLUSH YOUR QUEUE.

smtpd.conf(5) simplified, it will require adaptations

ok eric@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: makemap.8,v 1.17 2012/05/13 13:57:24 jmc Exp $
d18 1
a18 1
.Dd $Mdocdate: May 13 2012 $
d71 1
a71 1
user mappings for virtual domains files.
a76 1
.Pp
@


1.19
log
@knock out a useless .Pp;
@
text
@d1 1
a1 1
.\"	$OpenBSD: makemap.8,v 1.18 2012/11/18 22:08:56 rpe Exp $
d4 1
a4 1
.\" Copyright (c) 2008-2009 Gilles Chechade <gilles@@openbsd.org>
d18 1
a18 1
.Dd $Mdocdate: November 18 2012 $
d71 1
a71 1
virtual domains files.
d77 1
d80 2
a81 2
Primary domains can be kept in maps.
To create a primary domain map, add each primary domain on a
d88 2
a89 2
map "primary" source db "/etc/mail/primary.db"
accept for domain map "primary" deliver to mbox
d92 20
a111 4
Virtual domains are kept in maps.
To add support for a virtual domain, add a domain key
.Dq example.com whatever
to the virtual map.
d114 1
a114 1
to the virtual map.
d123 5
a127 2
map "vdomains" source db "/etc/mail/vdomains.db"
accept for virtual map "vdomains" deliver to mbox
a132 2
.It Pa /etc/mail/virtual
List of hosted virtual domains.
@


1.18
log
@remove { } from example in PRIMARY DOMAIN section

ok gilles
@
text
@d1 1
a1 1
.\"	$OpenBSD: makemap.8,v 1.17 2012/05/13 13:57:24 jmc Exp $
d18 1
a18 1
.Dd $Mdocdate: May 13 2012 $
a76 1
.Pp
@


1.17
log
@replace tabs with spaces, to avoid markup problems; ok gilles
@
text
@d1 1
a1 1
.\"	$OpenBSD: makemap.8,v 1.16 2012/05/12 21:49:31 gilles Exp $
d18 1
a18 1
.Dd $Mdocdate: May 12 2012 $
d88 1
a88 1
map "primary" { source db "/etc/mail/primary.db" }
@


1.16
log
@- remove unused sources S_EXT, S_DYN and S_EXT from enum map_src
- continue simplification of parse.y
- remove "for network", if we ever need it we can reimport, probably no
  one knows of that undocumented strange feature ;-)
- change syntax for virtual domains configuration:

	  accept for virtual vmap	[...] <- wrong
	  accept for virtual map vmap	[...] <- right

  the reason for this change is that we will soon implement relay rules
  through maps and that keeping that syntax would make it inconsistent
  with the other rules.

- update man pages for makemap and smtpd.conf to reflect changes

ok eric@@, looks ok chl@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: makemap.8,v 1.15 2011/10/10 21:06:06 gilles Exp $
d18 1
a18 1
.Dd $Mdocdate: October 10 2011 $
d94 1
a94 1
.Dq example.com		whatever
d97 1
a97 1
.Dq user@@example.com	user
d100 1
a100 1
.Dq @@example.com	user
@


1.15
log
@document that virtual maps require a domain key
@
text
@d1 1
a1 1
.\"	$OpenBSD: makemap.8,v 1.14 2010/09/03 11:22:36 jmc Exp $
d18 1
a18 1
.Dd $Mdocdate: September 3 2010 $
d107 2
a108 2
map "vdomains" { source db "/etc/mail/vdomains.db" }
accept for virtual "vdomains" deliver to mbox
@


1.14
log
@add an EXIT STATUS section for /usr/sbin;
@
text
@d1 1
a1 1
.\"	$OpenBSD: makemap.8,v 1.13 2009/11/04 08:31:26 jmc Exp $
d18 1
a18 1
.Dd $Mdocdate: November 4 2009 $
d93 3
@


1.13
log
@tweak previous;
@
text
@d1 1
a1 1
.\"	$OpenBSD: makemap.8,v 1.12 2009/11/03 23:10:31 gilles Exp $
d18 1
a18 1
.Dd $Mdocdate: November 3 2009 $
a78 1
.Ex -std makemap
d116 2
@


1.12
log
@document the new -t set mode of makemap, and add a paragraph describing
the use of makemap to generate a primary domains map
@
text
@d1 1
a1 1
.\"	$OpenBSD: makemap.8,v 1.11 2009/10/19 21:19:13 gilles Exp $
d18 1
a18 1
.Dd $Mdocdate: October 19 2009 $
d73 3
a75 3
There is no mapped value, a map of this type will only allow for
the lookup of keys. This format can be used for building primary
domains maps.
a89 1

a105 1

@


1.11
log
@update man pages
@
text
@d1 1
a1 1
.\"	$OpenBSD: makemap.8,v 1.10 2009/10/11 17:40:49 gilles Exp $
d18 1
a18 1
.Dd $Mdocdate: October 11 2009 $
d72 4
d80 13
@


1.10
log
@implement proper virtual domains instead of faking them on top of primary
domains. this means that:

- virtual domains no longer deliver to a local user when not told to
- they no longer attempt to resolve aliases when not told to
- they no longer need an explicit rule in smtpd.conf for EACH domain
- the "virtual" map is no longer hardcoded
- smtpd no longer needs a restart to support a new domain

instead we introduce the: accept for virtual map "mapname" [...] syntax
which refers to a map that can be manipulated at runtime.

idea discussed and okayd with jacekm@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: makemap.8,v 1.9 2009/09/25 13:44:33 jmc Exp $
d18 1
a18 1
.Dd $Mdocdate: September 25 2009 $
d91 1
a91 1
accept for virtual map "vdomains" deliver to mbox
@


1.9
log
@move the smtpd.conf-specific map bits back from makemap to smtpd.conf,
along with some tweakage;

ok jacekm gilles
@
text
@d1 1
a1 1
.\"	$OpenBSD: makemap.8,v 1.8 2009/09/22 13:05:20 jmc Exp $
d18 1
a18 1
.Dd $Mdocdate: September 22 2009 $
d77 1
a77 1
Virtual domains are kept in the virtual map.
d79 1
a79 1
.Dq user@@example.com
d82 1
a82 1
.Dq @@example.com
d86 1
a86 1
one must add a filter rule that accepts mail for the virtual domain,
d89 3
a91 1
accept for domain "example.com" deliver to mbox
@


1.8
log
@- move the map stuff to makemap.8
- use a single list for smtpd.conf keywords

ok jacekm gilles
@
text
@d1 1
a1 1
.\"	$OpenBSD: makemap.8,v 1.7 2009/03/23 21:48:40 jmc Exp $
d18 1
a18 1
.Dd $Mdocdate: March 23 2009 $
a75 46
.Sh MAP TYPES
There are three types of map known to
.Xr smtpd 8 :
.Bl -tag -width Ds
.It alias
Map queried when resolving mail aliases.
Query key is the user part of mail address.
.It virtual
Map used for creating virtual domains.
See the
.Sx VIRTUAL DOMAINS
section below.
.It secrets
Map queried for credentials
when relaying mail via server that requires SMTPAUTH
before accepting mail for relaying.
Query key is the domain name of the server acting as relay.
.El
.Pp
The configuration directives that are valid in the
.Ic map
context are described below:
.Bl -tag -width Ds
.It Ic type Ar maptype
Specifies method of accessing data.
The following map types are supported:
.Bl -tag -width Ds
.It db
Mappings are stored in a file created using
.Nm .
This is the default type if none is specified.
.It dns
Not implemented yet.
.It file
Not implemented yet.
.El
.It Ic source Ar mapsource
Specifies the source of mapping data.
It must be absolute path to a file in case of
.Dq file
and
.Dq db
.Ar maptype ,
and a domain name in case of
.Dq dns .
.El
@


1.7
log
@various minor improvements; ok jacekm gilles
@
text
@d1 1
a1 1
.\"	$OpenBSD: makemap.8,v 1.6 2009/03/16 20:43:29 gilles Exp $
d18 1
a18 1
.Dd $Mdocdate: March 16 2009 $
d30 3
d34 5
a38 3
creates the database maps used by keyed map lookups in
.Xr smtpd 8 .
It reads input from
a43 1
.Pp
d76 61
d148 1
a148 1
.Xr mailer.conf 5 ,
@


1.6
log
@mention /etc/mail/secrets in the FILES section
@
text
@d1 1
a1 1
.\"	$OpenBSD: makemap.8,v 1.5 2009/02/17 23:46:03 jacekm Exp $
d18 1
a18 1
.Dd $Mdocdate: February 17 2009 $
d35 3
a37 2
and writes database to a file
whose name is made by adding .db suffix to
d43 3
a45 3
The first is the database key,
the remaining specify mapped value.
Database key and value may optionally be separated
d51 1
a51 1
Write generated database to
d54 2
a55 2
Specify format of resulting map file.
Default map format is suitable for storing simple, unstructured
d57 3
a59 3
However, if mapped value has special meaning,
as in case of virtual domains definition file,
suitable
d61 2
a62 2
argument must be provided.
Available output types are:
d65 1
a65 1
Mapped value is comma-separated list of mail destinations.
d67 1
a67 1
virtual domains database files.
d79 1
a79 1
List of remote hosts credentials.
d92 1
a92 1
as the replacement for equivalent command shipped with sendmail.
@


1.5
log
@sync makemap man page with the code. create separate page for newaliases
which points at makemap as the preferred utility; ok gilles@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: makemap.8,v 1.4 2009/02/14 18:37:12 jacekm Exp $
d18 1
a18 1
.Dd $Mdocdate: February 14 2009 $
d77 2
@


1.4
log
@Implement makemap -t and -o, for output type and dest resp.; ok gilles@@
@
text
@d1 1
a1 5
.\"	$OpenBSD: makemap.8,v 1.3 2008/12/17 22:59:36 jacekm Exp $
.\" Copyright (c) 1998-2002 Sendmail, Inc. and its suppliers.
.\"	All rights reserved.
.\" Copyright (c) 1988, 1991, 1993
.\"	The Regents of the University of California.  All rights reserved.
d3 2
a4 3
.\" By using this file, you agree to the terms and conditions set
.\" forth in the LICENSE file which can be found at the top level of
.\" the sendmail distribution.
d6 3
d10 7
a16 1
.\"     $Sendmail: makemap.8,v 8.30 2002/06/27 23:41:04 gshapiro Exp $
d18 1
a18 1
.Dd $Mdocdate: December 17 2008 $
d22 1
a22 2
.Nm makemap ,
.Nm newaliases
d26 1
a27 1
.Op Fl o Ar dbfile
a28 1
.Nm newaliases
d31 1
a31 1
creates the database maps used by the keyed map lookups in
d35 2
a36 6
and outputs them to
.Ar dbfile .
If
.Ar dbfile
is not specified, output file name is made by appending .db
to
d41 1
a41 3
reads lines from 
.Ar file
consisting of words separated by whitespace.
d45 1
a45 1
using colon character.
d47 7
a53 3
The 
.Ar type
argument specifies format of resulting map file.
d69 1
a70 8
.Pp
.Nm newaliases 
rebuilds the random access database for the mail aliases file
.Pa /etc/mail/aliases .
It must be run each time this file is changed
in order for the change to take effect.
.Pp
.Ex -std newaliases
d79 2
d82 2
a83 3
.Xr smtpd 8 ,
.Xr aliases 5 ,
.Xr mailer.conf 5
d85 1
a85 1
These
d87 3
a89 5
and
.Nm newaliases
commands first appeared in
.Ox 4.5
as the replacement for equivalent commands shipped with sendmail.
@


1.3
log
@Merge newaliases into makemap.

ok gilles@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: makemap.8,v 1.2 2008/12/04 06:22:05 jmc Exp $
d14 1
a14 1
.Dd $Mdocdate: December 4 2008 $
d23 2
d34 6
a39 1
.Ar file.db .
d48 20
d81 3
a83 1
The mail aliases file.
@


1.2
log
@some basic cleanup;
@
text
@d1 1
a1 1
.\"	$OpenBSD$
d14 1
a14 1
.Dd $Mdocdate$
d18 2
a19 1
.Nm makemap
d23 2
a24 1
.Ar mapdesc
d29 4
a32 4
It reads input from the
.Ar mapdesc
file and outputs them to
.Ar mapdesc.db .
d36 3
a38 2
reads lines from the standard input consisting of two
words separated by whitespace.
d40 3
a42 1
the second is the value.
d44 12
a55 6
Note:
use
.Xr newaliases 8
to create the aliases database, not
.Nm ,
as the input formats differ for historical reasons.
d58 3
a60 2
.Xr newaliases 8 ,
.Xr smtpd 8
d62 1
a62 1
This
d64 3
a66 1
command first appeared in
d68 1
a68 3
as a replacement for the
.Nm
command that was shipped with sendmail.
@


1.1
log
@- smtpd's db maps are incompatible with sendmail's and needs a distinct
	makemap utility, this is needed for virtual users support amongst
	other things. links to smtpd's aliases.c and only provides a
	frontent to parse map descriptions. contains code from pyr@@, chl@@
	and I. Should have also been imported with smtpd.
@
text
@d1 1
d14 1
a14 1
.Dd October 21, 2008
d39 1
a39 2
Notice: do
.Em not
a40 2
.Nm
to create the aliases data base, but
d42 2
d50 1
a50 1
The
d52 1
a52 1
command appeared in
@

