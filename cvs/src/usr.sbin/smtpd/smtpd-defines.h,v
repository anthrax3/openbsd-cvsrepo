head	1.7;
access;
symbols
	OPENBSD_6_1:1.7.0.2
	OPENBSD_6_1_BASE:1.7
	OPENBSD_6_0:1.6.0.6
	OPENBSD_6_0_BASE:1.6
	OPENBSD_5_9:1.6.0.2
	OPENBSD_5_9_BASE:1.6
	OPENBSD_5_8:1.4.0.6
	OPENBSD_5_8_BASE:1.4
	OPENBSD_5_7:1.4.0.2
	OPENBSD_5_7_BASE:1.4
	OPENBSD_5_6:1.3.0.4
	OPENBSD_5_6_BASE:1.3
	OPENBSD_5_5:1.2.0.2
	OPENBSD_5_5_BASE:1.2
	OPENBSD_5_4:1.1.0.2
	OPENBSD_5_4_BASE:1.1;
locks; strict;
comment	@ * @;


1.7
date	2016.08.31.10.18.08;	author gilles;	state Exp;
branches;
next	1.6;
commitid	jWkTljYAPNXFatSw;

1.6
date	2015.11.30.14.39.21;	author gilles;	state Exp;
branches;
next	1.5;
commitid	cm6kHJnSYLBedNhj;

1.5
date	2015.10.09.14.37.38;	author gilles;	state Exp;
branches;
next	1.4;
commitid	Av5gnXBLeZb6m0W2;

1.4
date	2015.01.20.17.37.54;	author deraadt;	state Exp;
branches;
next	1.3;
commitid	ZBTFreARDSMmzOIV;

1.3
date	2014.04.30.09.17.29;	author gilles;	state Exp;
branches;
next	1.2;

1.2
date	2013.12.05.10.06.32;	author eric;	state Exp;
branches;
next	1.1;

1.1
date	2013.05.24.17.03.14;	author eric;	state Exp;
branches;
next	;


desc
@@


1.7
log
@allow overriding the subaddressing delimiter with subaddressing-delimiter
keyword, the default is still +

ok eric@@, sunil@@
@
text
@/*	$OpenBSD: smtpd-defines.h,v 1.6 2015/11/30 14:39:21 gilles Exp $	*/

/*
 * Copyright (c) 2013 Gilles Chehade <gilles@@poolp.org>
 *
 * Permission to use, copy, modify, and distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 */

#ifndef nitems
#define nitems(_a) (sizeof((_a)) / sizeof((_a)[0]))
#endif

#define	SMTPD_TABLENAME_SIZE	 (64 + 1)
#define	SMTPD_TAG_SIZE		 (32 + 1)

/* buffer sizes for email address components */
#define SMTPD_MAXLOCALPARTSIZE	 (255 + 1)
#define SMTPD_MAXDOMAINPARTSIZE	 (255 + 1)
#define	SMTPD_MAXMAILADDRSIZE	 (255 + 1)

/* buffer size for virtual username (can be email addresses) */
#define	SMTPD_VUSERNAME_SIZE	 (255 + 1)

#define SMTPD_USER		"_smtpd"
#define PATH_CHROOT		"/var/empty"
#define SMTPD_QUEUE_USER	"_smtpq"
#define SMTPD_QUEUE_GROUP	"_smtpq"
#define PATH_SPOOL		"/var/spool/smtpd"

#define SUBADDRESSING_DELIMITER	"+"


/* sendmail compat */

#define	EX_OK			0
#define	EX_NOHOST		68
#define	EX_UNAVAILABLE		69
#define	EX_SOFTWARE		70
#define	EX_TEMPFAIL		75
@


1.6
log
@add a couple smtpd-specific defines we want to expose to filters
and comment to clarify what they are used for
@
text
@d1 1
a1 1
/*	$OpenBSD: smtpd-defines.h,v 1.5 2015/10/09 14:37:38 gilles Exp $	*/
d40 1
a40 1
#define TAG_CHAR		'+'
@


1.5
log
@turn our local enqueuer setgid _smtpq and restrict access to offline queue,
the enqueuer will revoke group and regain real gid right after mkstemp.

this would have prevented the symlink/hardlink attacks against offline, and
it will avoid having to deal with new ways users can mess with it.

ok eric@@, ok millert@@
@
text
@d1 1
a1 1
/*	$OpenBSD: smtpd-defines.h,v 1.4 2015/01/20 17:37:54 deraadt Exp $	*/
d23 4
d29 4
@


1.4
log
@use <limits.h> comprehensively.  For now try to push <> includes to
each .c file, and out of the .h files.  To avoid overinclude.
ok gilles, in principle.  If this has been done right, -portable should
become easier to maintain.
@
text
@d1 1
a1 1
/*	$OpenBSD: smtpd-defines.h,v 1.3 2014/04/30 09:17:29 gilles Exp $	*/
d28 2
a29 1
#define SMTPD_QUEUE_USER	 "_smtpq"
d33 9
@


1.3
log
@when using maildir, do not create automatically create folders to match tag
in email address (ie: gilles+tag => ~/Maildir/.tag), instead use the folder
if it already exists and deliver to the mail Maildir otherwise.

ok eric@@ and chl@@
@
text
@d1 1
a1 1
/*	$OpenBSD: smtpd-defines.h,v 1.2 2013/12/05 10:06:32 eric Exp $	*/
a24 5

#define	SMTPD_MAXLOGNAME	32
#define	SMTPD_MAXPATHLEN	1024
#define	SMTPD_MAXHOSTNAMELEN	256
#define	SMTPD_MAXLINESIZE	2048
@


1.2
log
@move defines around
@
text
@d1 1
a1 1
/*	$OpenBSD$	*/
d35 2
@


1.1
log
@sync with OpenSMTPD 5.3.2

ok gilles@@
@
text
@d30 5
@

