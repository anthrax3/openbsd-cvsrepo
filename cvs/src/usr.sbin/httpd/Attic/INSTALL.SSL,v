head	1.12;
access;
symbols
	OPENBSD_5_5:1.11.0.34
	OPENBSD_5_5_BASE:1.11
	OPENBSD_5_4:1.11.0.30
	OPENBSD_5_4_BASE:1.11
	OPENBSD_5_3:1.11.0.28
	OPENBSD_5_3_BASE:1.11
	OPENBSD_5_2:1.11.0.26
	OPENBSD_5_2_BASE:1.11
	OPENBSD_5_1_BASE:1.11
	OPENBSD_5_1:1.11.0.24
	OPENBSD_5_0:1.11.0.22
	OPENBSD_5_0_BASE:1.11
	OPENBSD_4_9:1.11.0.20
	OPENBSD_4_9_BASE:1.11
	OPENBSD_4_8:1.11.0.18
	OPENBSD_4_8_BASE:1.11
	OPENBSD_4_7:1.11.0.14
	OPENBSD_4_7_BASE:1.11
	OPENBSD_4_6:1.11.0.16
	OPENBSD_4_6_BASE:1.11
	OPENBSD_4_5:1.11.0.12
	OPENBSD_4_5_BASE:1.11
	OPENBSD_4_4:1.11.0.10
	OPENBSD_4_4_BASE:1.11
	OPENBSD_4_3:1.11.0.8
	OPENBSD_4_3_BASE:1.11
	OPENBSD_4_2:1.11.0.6
	OPENBSD_4_2_BASE:1.11
	OPENBSD_4_1:1.11.0.4
	OPENBSD_4_1_BASE:1.11
	OPENBSD_4_0:1.11.0.2
	OPENBSD_4_0_BASE:1.11
	OPENBSD_3_9:1.10.0.14
	OPENBSD_3_9_BASE:1.10
	OPENBSD_3_8:1.10.0.12
	OPENBSD_3_8_BASE:1.10
	OPENBSD_3_7:1.10.0.10
	OPENBSD_3_7_BASE:1.10
	OPENBSD_3_6:1.10.0.8
	OPENBSD_3_6_BASE:1.10
	OPENBSD_3_5:1.10.0.6
	OPENBSD_3_5_BASE:1.10
	apache_1_3_29-mod_ssl_2_8_16:1.1.1.1
	OPENBSD_3_4:1.10.0.4
	OPENBSD_3_4_BASE:1.10
	apache_1_3_28-mod_ssl_2_8_15:1.1.1.1
	OPENBSD_3_3:1.10.0.2
	OPENBSD_3_3_BASE:1.10
	apache_1_3_27-mod_ssl_2_8_12:1.1.1.1
	apache_1_3_27:1.1.1.1
	apache:1.1.1
	OPENBSD_3_2:1.9.0.8
	OPENBSD_3_2_BASE:1.9
	OPENBSD_3_1:1.9.0.6
	OPENBSD_3_1_BASE:1.9
	OPENBSD_3_0:1.9.0.4
	OPENBSD_3_0_BASE:1.9
	OPENBSD_2_9_BASE:1.9
	OPENBSD_2_9:1.9.0.2
	OPENBSD_2_8:1.6.0.2
	OPENBSD_2_8_BASE:1.6
	OPENBSD_2_7:1.5.0.2
	OPENBSD_2_7_BASE:1.5
	OPENBSD_2_6:1.2.0.2
	OPENBSD_2_6_BASE:1.2
	OPENBSD_2_5:1.1.0.2
	OPENBSD_2_5_BASE:1.1;
locks; strict;
comment	@# @;


1.12
date	2014.04.22.14.47.23;	author henning;	state dead;
branches;
next	1.11;

1.11
date	2006.04.04.08.51.28;	author henning;	state Exp;
branches;
next	1.10;

1.10
date	2003.02.08.12.39.14;	author henning;	state Exp;
branches;
next	1.9;

1.9
date	2001.04.13.18.25.29;	author brad;	state Exp;
branches;
next	1.8;

1.8
date	2001.03.29.10.21.21;	author beck;	state Exp;
branches;
next	1.7;

1.7
date	2000.12.18.20.49.12;	author beck;	state Exp;
branches;
next	1.6;

1.6
date	2000.08.15.13.11.19;	author brad;	state Exp;
branches;
next	1.5;

1.5
date	2000.03.19.11.16.14;	author beck;	state Exp;
branches;
next	1.4;

1.4
date	2000.01.28.18.24.19;	author beck;	state Exp;
branches;
next	1.3;

1.3
date	99.12.08.02.45.48;	author beck;	state Exp;
branches;
next	1.2;

1.2
date	99.09.29.06.42.42;	author beck;	state Exp;
branches;
next	1.1;

1.1
date	99.03.01.04.27.46;	author beck;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2002.10.07.19.48.06;	author henning;	state Exp;
branches;
next	;


desc
@@


1.12
log
@this commit is really florian@@'s, since he's the one who made removal
of our forked apache possible by his work on nginx and slowcgi, but he
doesn't want it - so it is my pleasure to tedu it. I spent so much work
on chroot in it 10 years ago - and am very happy to see it go now, nginx
is a far better choice today.
Bye bye, Apache, won't miss you.
@
text
@                       _             _ 
   _ __ ___   ___   __| |    ___ ___| |  mod_ssl
  | '_ ` _ \ / _ \ / _` |   / __/ __| |  Apache Interface to OpenSSL
  | | | | | | (_) | (_| |   \__ \__ \ |  www.modssl.org
  |_| |_| |_|\___/ \__,_|___|___/___/_|  ftp.modssl.org
                       |_____|         
  _____________________________________________________________________________
  
                                         ``The world does not really need 
                                           Apache-SSL easier to install.''
                                            -- Ben Laurie, Apache-SSL author
  INSTALLATION (Unix)

  Introduction
  ____________

  Because mod_ssl is a complex package there are a lot of installation
  variants and options. For this different documents exists which explain
  special things: Read this document when you want to install Apache+mod_ssl
  under Unix. Read the INSTALL.Win32 document when you want to install it
  under the Win32 (Windows 95/98/NT) platform.

  Prerequisites
  _____________

  To use mod_ssl you need the following packages:

   o  Package:      Apache 
      Version:      1.3.x
      Description:  The Apache Group HTTP Server
      Reason:       The webserver base package on which all is based
      Homepage:     http://www.apache.org/
      Distribution: http://www.apache.org/dist/
      Tarball:      apache_1.3.x.tar.gz
      Location:     SF, USA
      Author(s):    The Apache Group <apache@@apache.org>
      Type:         MANDATORY

   o  Package:      mod_ssl
      Version:      2.8.x
      Description:  The Apache Interface to OpenSSL
      Reason:       The interface module for Apache
      Homepage:     http://www.modssl.org/
      Distribution: ftp://ftp.modssl.org/source/
      Tarball:      mod_ssl-2.8.x-1.3.x.tar.gz
      Location:     Zurich, Switzerland, Europe
      Author(s):    Ralf S. Engelschall <rse@@engelschall.com>
      Type:         MANDATORY

   o  Package:      OpenSSL
      Version:      0.9.x
      Description:  The Open Source Toolkit for SSL/TLS
      Reason:       The library which implements SSL/TLS
      Homepage:     http://www.openssl.org/
      Distribution: ftp://ftp.openssl.org/source/
      Tarball:      openssl-0.9.x.tar.gz
      Location:     Zurich, Switzerland, Europe
      Author(s):    The OpenSSL Project <openssl@@openssl.org>
      Type:         MANDATORY 

   o  Package:      MM
      Version:      1.1.x
      Description:  Shared Memory Library
      Reason:       The portable library for shared memory in Apache/EAPI
      Homepage:     http://www.engelschall.com/sw/mm/
      Distribution: http://www.engelschall.com/sw/mm/
      Tarball:      mm-1.1.x.tar.gz
      Location:     Zurich, Switzerland, Europe
      Author(s):    Ralf S. Engelschall <rse@@engelschall.com>
      Type:         OPTIONAL

   o  Package:      GZip
      Version:      1.2.4
      Description:  The compression utility
      Reason:       To unpack the above tarballs
      Homepage:     http://www.gnu.org/
      Distribution: ftp://ftp.gnu.org/pub/gnu/
      Tarball:      gzip-1.2.4.tar.Z
      Location:     USA
      Author(s):    Free Software Foundation (FSF)
      Type:         MANDATORY
 
   o  Package:      Perl
      Version:      5.6.0
      Description:  The Practical Extraction and Reporting Language
      Reason:       To configure OpenSSL and for APXS tool in Apache
      Homepage:     http://www.perl.com/
      Distribution: http://www.cpan.org/src/5.0/
      Tarball:      perl-5.6.0.tar.gz
      Location:     USA
      Author(s):    Larry Wall
      Type:         MANDATORY

  Installation
  ____________

  The following is a step-by-step list on how to install an SSL-aware Apache.
  The actual steps you have to perform depend on the location where _YOU_ and
  your webserver stay.  So the commands are marked at the right-side with the
  following tags:
  
  EU ........ Command has to be run by citizens of a European state ONLY
  ALL ....... Command has to be run by ANYONE, independent of location
  OPTIONAL .. Command is optional and not really needed

  Now follow these steps:
  (the syntax is for a Bourne-Shell style shell, when you're using a C-Shell
  style shell you've to adjust the commands according to your shell's manual)

  1. Make sure GZip and Perl are already installed and available through the
     commands `gzip' and `perl'. They are needed for unpacking the tarballs
     and for configuring OpenSSL. When you've these packages still not
     installed, do this first.

  2. Extract the required packages:

     $ gzip -d -c apache_1.3.x.tar.gz | tar xvf -                          ALL
     $ gzip -d -c mod_ssl-2.8.x-1.3.x.tar.gz | tar xvf -                   ALL
     $ gzip -d -c openssl-0.9.x.tar.gz | tar xvf -                         ALL
     $ gzip -d -c mm-1.1.x.tar.gz | tar xvf -                         OPTIONAL

  3. Configure and build the OpenSSL library: 

     $ cd openssl-0.9.x                                                    ALL
     $ sh config \                                                         ALL
            no-idea \                                                       EU
            no-threads \                                              OPTIONAL
            -fPIC                                                     OPTIONAL
     $ make                                                                ALL
     $ make test                                                      OPTIONAL
     $ cd ..                                                               ALL

     NOTE: OpenSSL understands a lot more options on the `config'
           command line. For instance you can add some command line
           options (like `-DSSL_FORBID_ENULL' for not allowing Null
           encryptions, or adding `-DSSL_ALLOW_ADH' for allowing
           Anonymous Diffie-Hellman ciphers, etc) to adjust the OpenSSL
           internals (see OpenSSL's top-level Makefile for details).

     NOTE: When your system already has OpenSSL installed (for instance some
           Linux distributions ship with OpenSSL installed out-of-the-box) in
           system locations you can ignore the OpenSSL steps above, too.  Then
           use `SSL_BASE=SYSTEM' instead of `SSL_BASE=../openssl-0.9.x' below
           and mod_ssl will search for OpenSSL's binary, header and library
           files in $PATH and system locations.

     NOTE: The -fPIC option builds OpenSSL with Position Independent Code
           (PIC) which is only important when building mod_ssl as a
           Dynamic Shared Object (DSO). Please notice, that you really
           have to use -fPIC and not -fpic, as the latter will usually
           cause the build to fail. See below for more details.

     NOTE: The optional `no-threads' keyword above is to increase
           performance inside OpenSSL, because Apache 1.3 does not
           use threads anyway. However, OpenSSL, if built without
           `no-threads', by default builds with multi-threading support.
           This multi-threading support involves using locking around a
           lot of internal object manipulation (esp. reference counts).
           The fact that it is not possible in Apache 1.3 to have
           threads racing on any kind of object internal to OpenSSL
           means that any overhead (memory and/or time) relating to
           these locking mechanisms is wasted by default.

  4. Optionally you now can build the MM Shared Memory library when you want
     shared memory support in Apache/EAPI. For instance this allows mod_ssl to
     use a high-performance RAM-based session cache instead of a disk-based
     one.

     $ cd mm-1.1.x                                                    OPTIONAL
     $ ./configure --disable-shared                                   OPTIONAL
     $ make                                                           OPTIONAL
     $ cd ..                                                          OPTIONAL

     NOTE: When your system already has MM installed in system locations
           you can ignore the steps above and then use `EAPI_MM=SYSTEM'
           instead of `EAPI_MM=../mm-1.1.x' below.

     NOTE: Do not forget the --disable-shared option above. Else you've
           to establish an explicit LD_LIBRARY_PATH which includes the
           /path/to/mm-1.1.x/.libs/ directory or the compilation of Apache
           will fail because the shared library cannot be found.

  5. Now apply the mod_ssl source extension and source patches to the Apache
     source tree, configure the Apache sources and build Apache with mod_ssl
     and OpenSSL. 
     
     Actually here you have three options: 
     (dependent on your situation and personal skill ;-)

     a) The All-In-One mod_ssl+APACI way [FOR JOE AVERAGE]:

        You configure Apache semi-automatically from within mod_ssl's
        `configure' script. You don't have to fiddle with the SSL_BASE
        variable but get no intermediate chance to add more third-party
        Apache modules (e.g. mod_perl, PHP3, etc).

        $ cd mod_ssl-2.8.x-1.3.x                                           ALL
        $ ./configure \                                                    ALL
              --with-apache=../apache_1.3.x \                              ALL
              --with-ssl=../openssl-0.9.x \                                ALL
              --with-mm=../mm-1.1.x \                                 OPTIONAL
              --with-crt=/path/to/your/server.crt \                   OPTIONAL
              --with-key=/path/to/your/server.key \                   OPTIONAL
              --prefix=/path/to/apache \                                   ALL
             [--enable-shared=ssl] \                                  OPTIONAL
             [--disable-rule=SSL_COMPAT] \                            OPTIONAL
             [--enable-rule=SSL_EXPERIMENTAL] \                       OPTIONAL
             [--enable-rule=SSL_VENDOR] \                             OPTIONAL
             [...more APACI options...]                               OPTIONAL
        $ cd ..                                                            ALL
        $ cd apache_1.3.x                                                  ALL
        $ make                                                             ALL
        $ make certificate                                            OPTIONAL
        $ make install                                                     ALL
        $ cd ..                                                            ALL

        NOTE: The --enable-shared=ssl option enables the building of mod_ssl
              as a DSO `libssl.so'. Read the INSTALL and
              htdocs/manual/dso.html documents in the Apache source tree for
              more information about DSO support in Apache. We strongly advise
              ISPs and package maintainers to use the DSO facility for maximum
              flexibility with mod_ssl.  But notice that DSO is not supported
              by Apache on all platforms.

              Additionally OpenSSL has problems under DSO situations on some
              platforms. For instance under smart ix86 platforms like Linux
              and FreeBSD when you compile a the standard OpenSSL
              libcrypto.a/libssl.a libraries and link those to a mod_ssl DSO
              libssl.so all works fine.  While on other platforms like Solaris
              2.6 on a SPARC OpenSSL's code will dump core under run-time.
              When this is the case for you, then try to recompile OpenSSL
              with Position Independent Code (PIC) by adding a `-fPIC' (for
              GCC) or `-KPIC' (for SVR4-style compilers) to the platform
              configuration line in OpenSSL's `Configure' script.  The
              -fPIC option above when you build OpenSSL.

        NOTE: The --disable-rule=SSL_COMPAT option disables the building of
              SSL compatibility code for older mod_ssl versions and other
              Apache SSL solutions like Apache-SSL, Sioux, Stronghold, etc.

        NOTE: The --enable-rule=SSL_EXPERIMENTAL and --enable-rule=SSL_VENDOR
              options enable various experimental and vendor extension code.
              Please read the src/Configuration.tmpl file inside the Apache
              source tree for more details.

        NOTE: You either use `--with-crt'/`--with-key' or `make certificate'
              above - but never both. The `--with-crt'/`--with-key' options is
              used only when you already have a real server certificate and
              private key at hand while `make certificate' is to create a test
              server test certificate. Read the message box which occurs after
              the `make' command when building Apache for details.

     b) The flexible APACI-only way [FOR REAL HACKERS]:

        You configure Apache manually and have the chance to configure
        and add third-party Apache modules like mod_perl, mod_php,
        mod_frontpage, mod_dav, etc. But you have to provide the
        SSL_BASE and EAPI_MM variables manually and either copy your
        existing certificate manually to conf/ssl.crt/server.crt or use
        `make certificate':

        $ cd mod_ssl-2.8.x-1.3.x                                           ALL
        $ ./configure \                                                    ALL
              --with-apache=../apache_1.3.x \                              ALL
              --with-crt=/path/to/your/server.crt \                   OPTIONAL
              --with-key=/path/to/your/server.key                     OPTIONAL
        $ cd ..                                                            ALL

        [...Now add more Apache modules to the Apache source tree...] OPTIONAL

        $ cd apache_1.3.x                                                  ALL
        $ SSL_BASE=../openssl-0.9.x \                                      ALL
          EAPI_MM=../mm-1.1.x \                                       OPTIONAL
          ./configure \                                                    ALL
              --enable-module=ssl \                                        ALL
              --prefix=/path/to/apache \                                   ALL
             [--enable-shared=ssl] \                                  OPTIONAL
             [--disable-rule=SSL_COMPAT] \                            OPTIONAL
             [--enable-rule=SSL_EXPERIMENTAL] \                       OPTIONAL
             [--enable-rule=SSL_VENDOR] \                             OPTIONAL
             [...more APACI options...]                               OPTIONAL
        $ make                                                             ALL
        $ make certificate                                            OPTIONAL
        $ make install                                                OPTIONAL
        $ cd ..                                                            ALL

        NOTE: The optional --enable-shared=ssl option enables the building
              of mod_ssl as a DSO `libssl.so'. Read the INSTALL and
              htdocs/manual/dso.html documents in the Apache source tree for
              more information about DSO support in Apache. We strongly advise
              ISPs and package maintainers to use the DSO facility for maximum
              flexibility with mod_ssl.  But notice that DSO is not supported
              by Apache on all platforms.

              Additionally OpenSSL has problems under DSO situations on some
              platforms. For instance under smart ix86 platforms like Linux
              and FreeBSD when you compile a the standard OpenSSL
              libcrypto.a/libssl.a libraries and link those to a mod_ssl DSO
              libssl.so all works fine.  While on other platforms like Solaris
              2.6 on a SPARC OpenSSL's code will dump core under run-time.
              When this is the case for you, then try to recompile OpenSSL
              with Position Independent Code (PIC) by adding a `-fPIC' (for
              GCC) or `-KPIC' (for SVR4-style compilers) to the platform
              configuration line in OpenSSL's `Configure' script.  The
              -fPIC option above when you build OpenSSL.

        NOTE: The --disable-rule=SSL_COMPAT option disables the building of
              SSL compatibility code for older mod_ssl versions and other
              Apache SSL solutions like Apache-SSL, Sioux, Stronghold, etc.

        NOTE: The --enable-rule=SSL_EXPERIMENTAL and --enable-rule=SSL_VENDOR
              options enable various experimental and vendor extension code.
              Please read the src/Configuration.tmpl file inside the Apache
              source tree for more details.

     c) The poor mans way known from Apache 1.2 [FOR COMPATIBILITY]:

        You configure Apache manually by editing the src/Configuration
        file and running the deep-level src/Configure script. The
        advantage here is that this directly follows the steps you might
        be familiar with from Apache 1.2 and additionally you also have
        a chance to add more third-party Apache modules like mod_perl or
        mod_php because anything is done manually. But you have to edit
        the SSL_BASE and EAPI_MM variables manually and more important:
        you have to install the Apache package manually, too. But feel
        free to be masochistic ;-)

        $ cd mod_ssl-2.8.x-1.3.x                                           ALL
        $ ./configure \                                                    ALL
              --with-apache=../apache_1.3.x \                              ALL
              --with-crt=/path/to/your/server.crt \                   OPTIONAL
              --with-key=/path/to/your/server.key                     OPTIONAL
        $ cd ..                                                            ALL

        [...Add more Apache modules to the Apache source tree...]     OPTIONAL

        $ cd apache_1.3.x/src                                              ALL
        $ cp Configuration.tmpl Configuration                              ALL
        $ vi Configuration                                                 ALL
        [...edit the SSL_BASE variable...]                                 ALL
        [...edit the EAPI_MM variable...]                             OPTIONAL
        [...edit the `AddModule' line of libssl.a...]                      ALL
        $ ./Configure                                                      ALL
        $ make                                                             ALL
        $ make certificate                                            OPTIONAL

        Up to this point it can be acceptable, yeah? But now the friendly
        world stops. The remaining installation steps have to be done manually
        by coping the various files to /path/to/apache, including your
        certificate, etc. That's the price for staying with the good old
        days...

  6. Try out Apache without SSL (only HTTP protocol possible):

     $ /path/to/apache/bin/apachectl start                                 ALL
     $ netscape http://<local-host-name>/                                  ALL
     $ /path/to/apache/bin/apachectl stop                                  ALL

  7. Try out Apache with SSL (both HTTP and HTTPS protocol possible):

     $ /path/to/apache/bin/apachectl startssl                              ALL
     $ netscape http://<local-host-name><http-port>/                       ALL
     $ netscape https://<local-host-name><https-port>/                     ALL
     $ /path/to/apache/bin/apachectl stop                                  ALL

     NOTE: Replace the `<local-host-name>' with the official name of your
           host. Do not enter `localhost' here, because this name has to match
           the Common Name (CN) of the Subject's Distinguished Name (DN)
           inside your server certificate.

     NOTE: If you have built and installed under root (uid 0), 
           leave out the the `<http-port>' and `<https-port>' strings above.
           If you have built and installed under a different user than root,
           replace `<http-port>' with `:8080' and `<https-port>' with `:8443'
           above. The reason just is that Apache pre-configures the installed
           configuration file for direct use (at least as long the APACI
           option --without-confadjust is not used). For using the official
           ports (80 for HTTP and 443 for HTTPS) root privileges are required
           under run-time, so APACI assumes that it has to use alternate ports
           (8080 for HTTP and 8443 for HTTPS) if the built and installation is
           done under non-root users.

     NOTE: When the above tests (steps 6 and 7) fail for some reasons
           you are _STRONGLY ADVISED_ to look into the Apache error logfile
           before you ask someone other for help. In the error logfile there
           should be a hint where to find the reason for the failure.

     NOTE: When you *re*install Apache many times, make sure you restart your
           browsers between the tests if you created test or custom
           certificates.  Else connections might fail because the browser
           cached the certificate details of the previous installation.

  8. Finally you're advised to do the following:

     o Read the mod_ssl user manual very carefully to
       understand the SSL-part of your Apache configuration:

       $ netscape http://www.modssl.org/docs/2.8/                 (official)
       $ netscape http://localhost/manual/mod/mod_ssl/            (local copy)
       
     o Adjust your Apache configuration to your personal requirements.
       The configuration is already pre-configured for SSL, but usually it has
       to be tweaked a little bit more to fit the local situation. When you
       had already a httpd.conf file, this one is preserved. Then look inside
       /path/to/apache/etc/httpd.conf.default for the pre-configured SSL
       configuration and take it over manually into httpd.conf.

       $ vi /path/to/apache/etc/httpd.conf

     o Subscribe to the modssl-users@@modssl.org support mailing list
       with the provided web interface:
       
       $ netscape http://www.modssl.org/news/list.html

  8. Bask in the glow ;-)

  Upgrading with APXS (EXPERTS ONLY)
  __________________________________

  Once you've built and installed Apache with mod_ssl as a DSO (libssl.so) you
  can easily upgrade this libssl.so file with a stand-alone built procedure as
  long as the Extended API (EAPI) didn't change and you've OpenSSL installed
  somewhere. For this you can use the following procedure:

    $ cd mod_ssl-2.8.x-1.3.x                                               ALL
    $ ./configure \                                                        ALL
          --with-apxs[=/path/to/apache/bin/apxs] \                         ALL
          --with-ssl=/path/to/openssl                                      ALL
    $ make                                                                 ALL
    $ make install                                                         ALL
    $ make distclean                                                       ALL

  This will build mod_ssl locally inside the pkg.modssl/ directory and then
  upgrades your existing libssl.so file. This approach is also interesting for
  package vendors. Because those can create an Apache+EAPI package (with the
  use of --with-eapi-only) and a APXS-based mod_ssl package (with the use of
  --with-apxs).

  Examples
  ________

  As you noticed above there are a lot of possibilities, variants and options
  for installing mod_ssl. So, in the following we provide some step-by-step
  examples where you can see how to build mod_ssl with other third-party
  modules to form your SSL-aware Apache. For simplification we assume some
  prerequisites for each example. If these don't fit your situation you have
  to adjust the steps with the help of the above detailed instructions, of
  course.
  
  o Apache + mod_ssl/OpenSSL + mod_perl/Perl
    ---------------------------------------

    Prerequisites:

    o Apache should be installed to /path/to/apache
    o Perl is installed and `perl' is in $PATH
    o OpenSSL is installed under /path/to/openssl

    Steps:

    #   extract the packages
    $ gzip -d -c apache_1.3.x.tar.gz | tar xvf -
    $ gzip -d -c mod_ssl-2.8.x-1.3.x.tar.gz | tar xvf -
    $ gzip -d -c mod_perl-1.xx.tar.gz | tar xvf -

    #   apply mod_ssl to Apache source tree
    $ cd mod_ssl-2.8.x-1.3.x
    $ ./configure \
          --with-apache=../apache_1.3.x
    $ cd ..

    #   apply mod_perl to Apache source tree
    #   and build/install the Perl-side of mod_perl
    $ cd mod_perl-1.xx
    $ perl Makefile.PL \
          EVERYTHING=1 \
          APACHE_SRC=../apache_1.3.x/src \
          USE_APACI=1 \
          PREP_HTTPD=1 \
          DO_HTTPD=1
    $ make
    $ make install
    $ cd ..

    #   build/install Apache with mod_ssl and mod_perl
    $ cd apache_1.3.x
    $ SSL_BASE=/path/to/openssl \
      ./configure \
          --prefix=/path/to/apache \
          --enable-module=ssl \
          --activate-module=src/modules/perl/libperl.a \
          --enable-module=perl
    $ make 
    $ make certificate
    $ make install
    $ cd ..

    #   cleanup after work
    $ rm -rf mod_perl-1.xx
    $ rm -rf mod_ssl-2.8.x-1.3.x
    $ rm -rf apache_1.3.x

  o Apache + mod_ssl/OpenSSL + PHP3/MySQL
    -------------------------------------

    Prerequisites:

    o Apache should be installed to /path/to/apache
    o MySQL is installed under /path/to/mysql
    o OpenSSL is installed under /path/to/openssl
    o GNU Make is available as `gmake' in $PATH
   
    Steps:

    #   extract the packages
    $ gzip -d -c apache_1.3.x.tar.gz | tar xvf -
    $ gzip -d -c mod_ssl-2.8.x-1.3.x.tar.gz | tar xvf -
    $ gzip -d -c php-3.0.x.tar.gz | tar xvf -

    #   apply mod_ssl to Apache source tree
    $ cd /mod_ssl-2.8.x-1.3.x
    $ ./configure \
          --with-apache=../apache_1.3.x
    $ cd ..

    #   pre-configure Apache for PHP3's configure step
    $ cd apache_1.3.x
    $ ./configure \
          --prefix=/path/to/apache
    $ cd ..
    
    #   configure PHP3 and apply it to the Apache source tree
    $ cd ../php-3.0.x
    $ CFLAGS='-O2 -I/path/to/openssl/include' \
      ./configure \
          --with-apache=../apache_1.3.x \
          --with-mysql=/path/to/mysql \
          --enable-memory-limit=yes \
          --enable-debug=no 
    $ gmake 
    $ gmake install
    $ cd ..
    
    #   build/install Apache with mod_ssl and PHP3
    $ cd apache_1.3.x
    $ SSL_BASE=/path/to/openssl \
      ./configure \
          --prefix=/path/to/apache \
          --enable-module=ssl \
          --activate-module=src/modules/php3/libphp3.a \
          --enable-module=php3
    $ make
    $ make certificate
    $ make install
    $ cd ..
    
    #   cleanup after work
    $ rm -rf php-3.0.x
    $ rm -rf mod_ssl-2.8.x-1.3.x
    $ rm -rf apache_1.3.x

@


1.11
log
@rip out bundled dbm, we've always used our dbm
From: Daniel Ouellet <daniel@@presscom.net>
@
text
@@


1.10
log
@typo; krause
@
text
@a206 1
             [--enable-rule=SSL_SDBM] \                               OPTIONAL
a240 7
        NOTE: The --enable-rule=SSL_SDBM option enabled the use of the
              built-in SDBM library instead of a custom defined or vendor
              supplied DBM library. This can be useful when the vendor DBM
              library is buggy or restricts the data size too dramatically
              (for SSL sessions to be cacheable the DBM library should allow
              more than 1KB of data to be stored under a particular key).

a278 1
             [--enable-rule=SSL_SDBM] \                               OPTIONAL
a309 7

        NOTE: The --enable-rule=SSL_SDBM option enabled the use of the
              built-in SDBM library instead of a custom defined or vendor
              supplied DBM library. This can be useful when the vendor DBM
              library is buggy or restricts the data size too dramatically
              (for SSL sessions to be cacheable the DBM library should allow
              more than 1KB of data to be stored under a particular key).
@


1.9
log
@merge mod_ssl 2.8.2
--
Ok'd by: beck@@
@
text
@d394 1
a394 1
           ports (80 for HTTP and 443 for HTTPS) root priviledges are required
@


1.8
log
@Apache 1.3.19+mod_ssl 2.8.1 merge - also adds shared build of mod_headers
and mod_expire
@
text
@d127 1
d152 11
@


1.7
log
@Argh. this commit didn't make it when I did it earlier - apache 1.3.14 + mod_ssl 2.7.1 merge
@
text
@d40 1
a40 1
      Version:      2.7.x
d45 1
a45 1
      Tarball:      mod_ssl-2.7.x-1.3.x.tar.gz
d118 1
a118 1
     $ gzip -d -c mod_ssl-2.7.x-1.3.x.tar.gz | tar xvf -                   ALL
d185 1
a185 1
        $ cd mod_ssl-2.7.x-1.3.x                                           ALL
d258 1
a258 1
        $ cd mod_ssl-2.7.x-1.3.x                                           ALL
d332 1
a332 1
        $ cd mod_ssl-2.7.x-1.3.x                                           ALL
d402 1
a402 1
       $ netscape http://www.modssl.org/docs/2.7/                 (official)
d429 1
a429 1
    $ cd mod_ssl-2.7.x-1.3.x                                               ALL
d467 1
a467 1
    $ gzip -d -c mod_ssl-2.7.x-1.3.x.tar.gz | tar xvf -
d471 1
a471 1
    $ cd mod_ssl-2.7.x-1.3.x
d491 1
a491 1
    $ SSL_BASE=/path/to/openssl 
d504 1
a504 1
    $ rm -rf mod_ssl-2.7.x-1.3.x
d521 1
a521 1
    $ gzip -d -c mod_ssl-2.7.x-1.3.x.tar.gz | tar xvf -
d525 1
a525 1
    $ cd /mod_ssl-2.7.x-1.3.x
d563 1
a563 1
    $ rm -rf mod_ssl-2.7.x-1.3.x
@


1.6
log
@merge mod_ssl 2.6.6
@
text
@d33 1
a33 1
      Distribution: ftp://ftp.apache.org/apache/dist/
d40 1
a40 1
      Version:      2.6.x
d45 1
a45 1
      Tarball:      mod_ssl-2.6.x-1.3.x.tar.gz
a60 11
   o  Package:      RSAref
      Version:      2.0
      Description:  RSA Reference Implementation
      Reason:       Deprecated RSA library for US citizens
      Homepage:     -
      Distribution: Search on http://ftpsearch.lycos.com/ for "rsaref20.tar.Z" !!
      Tarball:      rsaref20.tar.Z
      Location:     Netherlands (because no longer distributed by RSA DSI)
      Author(s):    RSA DSI
      Type:         OPTIONAL (only mandatory for US-citizens)

d84 1
a84 1
      Version:      5.004 or 5.005
d88 2
a89 2
      Distribution: http://www.perl.com/CPAN/src/
      Tarball:      perl5.00x.tar.gz
a101 1
  US ........ Command has to be run by citizens of the United States ONLY
d118 1
a118 1
     $ gzip -d -c mod_ssl-2.6.x-1.3.x.tar.gz | tar xvf -                   ALL
a120 2
     $ mkdir rsaref-2.0                                                     US
     $ (cd rsaref-2.0; gzip -d -c ../rsaref20.tar.Z | tar xvf -)            US
a122 29
     (When you're an US-citizen you have to build OpenSSL in conjunction with
     the RSAref library. Others can ignore the first six commands, of course)

     $ cd rsaref-2.0
     $ cp -rp install/unix local                                            US
     $ cd local                                                             US
     $ make                                                                 US
     $ mv rsaref.a librsaref.a                                              US
     $ cd ../..                                                             US

     NOTE: RSAref has some portability problems and nasty restrictions.
           Especially it assumes that an `unsigned long int' represents a four
           byte word. One result of this bad assumption is that it fails under
           run-time (not compile-time) on platforms/CPUs, like Alphas, where
           larger integer sizes are used by the compiler. For instance when
           mod_ssl's `make certificate' command hangs, you get memory faults
           or Apache hangs when connecting to it through HTTPS, this all
           indicates that you ran into this portability problem.  

           The solution is to replace the `typedef unsigned long int UINT4' in
           rsaref-2.0/source/global.h, line 26. The best is to use `typedef
           u_int32_t UINT4' when `u_int32_t' is defined by your vendor include
           files. If not try to use a standard type which is four bytes in
           length on your platform, e.g. on Alphas `typedef unsigned int
           UINT4' works.

           Additionally with RSAref not all RSA functionality in OpenSSL will
           be available. It'll still work for the requirements of mod_ssl, but
           for instance the RSA OEAP functionality isn't supported by RSAref.
a126 1
            -L`pwd`/../rsaref-2.0/local/rsaref \                            US
a145 5
     NOTE: When your system already has RSAref installed in system locations
           you can ignore the RSAref-related steps above and then use
           `RSAREF_BASE=SYSTEM' instead of `RSAREF_BASE=../rsaref-2.0/local/'
           below.

d181 3
a183 3
        `configure' script. You don't have to fiddle with the SSL_BASE and
        RSA_BASE variables but get no intermediate chance to add more
        third-party Apache modules (e.g. mod_perl, PHP3, etc).
d185 1
a185 1
        $ cd mod_ssl-2.6.x-1.3.x                                           ALL
a188 1
              --with-rsa=../rsaref-2.0/local \                              US
d251 6
a256 5
        You configure Apache manually and have the chance to configure and add
        third-party Apache modules like mod_perl, mod_php, mod_frontpage,
        mod_dav, etc. But you have to provide the SSL_BASE, RSA_BASE and
        EAPI_MM variables manually and either copy your existing certificate
        manually to conf/ssl.crt/server.crt or use `make certificate':
d258 1
a258 1
        $ cd mod_ssl-2.6.x-1.3.x                                           ALL
a268 1
          RSA_BASE=../rsaref-2.0/local \                                    US
d322 9
a330 8
        You configure Apache manually by editing the src/Configuration file
        and running the deep-level src/Configure script. The advantage here is
        that this directly follows the steps you might be familiar with from
        Apache 1.2 and additionally you also have a chance to add more
        third-party Apache modules like mod_perl or mod_php because anything
        is done manually. But you have to edit the SSL_BASE, RSA_BASE and
        EAPI_MM variables manually and more important: you have to install the
        Apache package manually, too. But feel free to be masochistic ;-)
d332 1
a332 1
        $ cd mod_ssl-2.6.x-1.3.x                                           ALL
d345 1
a345 2
        [...edit the RSA_BASE variable...]                                  US
        [...edit the EAPI_MM variable...]                                   US
d402 1
a402 1
       $ netscape http://www.modssl.org/docs/2.6/                 (official)
d429 1
a429 1
    $ cd mod_ssl-2.6.x-1.3.x                                               ALL
d432 1
a432 2
          --with-ssl=/path/to/openssl \                                    ALL
          --with-rsa=/path/to/rsaref                                        US
a461 1
    o RSAref is not used in this example
d467 1
a467 1
    $ gzip -d -c mod_ssl-2.6.x-1.3.x.tar.gz | tar xvf -
d471 1
a471 1
    $ cd mod_ssl-2.6.x-1.3.x
d504 1
a504 1
    $ rm -rf mod_ssl-2.6.x-1.3.x
a514 1
    o RSAref have not to be used
d521 1
a521 1
    $ gzip -d -c mod_ssl-2.6.x-1.3.x.tar.gz | tar xvf -
d525 1
a525 1
    $ cd /mod_ssl-2.6.x-1.3.x
d563 1
a563 1
    $ rm -rf mod_ssl-2.6.x-1.3.x
@


1.5
log
@apache 1.3.12 + mod_ssl 2.6.2 merge
@
text
@d73 1
a73 1
      Version:      1.0.x
d78 1
a78 1
      Tarball:      mm-1.0.x.tar.gz
d132 1
a132 1
     $ gzip -d -c mm-1.0.x.tar.gz | tar xvf -                         OPTIONAL
d170 1
a170 1
            -L`pwd`/../rsaref-2.0/local/ rsaref \                           US
d206 1
a206 1
     $ cd mm-1.0.x                                                    OPTIONAL
d213 1
a213 1
           instead of `EAPI_MM=../mm-1.0.x' below.
d217 1
a217 1
           /path/to/mm-1.0.x/.libs/ directory or the compilation of Apache
d239 1
a239 1
              --with-mm=../mm-1.0.x \                                 OPTIONAL
d319 1
a319 1
          EAPI_MM=../mm-1.0.x \                                       OPTIONAL
d409 1
a409 1
     $ /path/to/apache/sbin/apachectl start                                ALL
d411 1
a411 1
     $ /path/to/apache/sbin/apachectl stop                                 ALL
d415 4
a418 4
     $ /path/to/apache/sbin/apachectl startssl                             ALL
     $ netscape http://<local-host-name>/                                  ALL
     $ netscape https://<local-host-name>/                                 ALL
     $ /path/to/apache/sbin/apachectl stop                                 ALL
d425 12
d481 1
a481 1
          --with-apxs[=/path/to/apache/sbin/apxs] \                        ALL
@


1.4
log
@More apache 1.3.11 changes
@
text
@d40 1
a40 1
      Version:      2.5.x
d45 1
a45 1
      Tarball:      mod_ssl-2.5.x-1.3.x.tar.gz
d130 1
a130 1
     $ gzip -d -c mod_ssl-2.5.x-1.3.x.tar.gz | tar xvf -                   ALL
d234 1
a234 1
        $ cd mod_ssl-2.5.x-1.3.x                                           ALL
d307 1
a307 1
        $ cd mod_ssl-2.5.x-1.3.x                                           ALL
d381 1
a381 1
        $ cd mod_ssl-2.5.x-1.3.x                                           ALL
d440 1
a440 1
       $ netscape http://www.modssl.org/docs/2.5/                 (official)
d467 1
a467 1
    $ cd mod_ssl-2.5.x-1.3.x                                               ALL
d507 1
a507 1
    $ gzip -d -c mod_ssl-2.5.x-1.3.x.tar.gz | tar xvf -
d511 1
a511 1
    $ cd mod_ssl-2.5.x-1.3.x
d544 1
a544 1
    $ rm -rf mod_ssl-2.5.x-1.3.x
d562 1
a562 1
    $ gzip -d -c mod_ssl-2.5.x-1.3.x.tar.gz | tar xvf -
d566 1
a566 1
    $ cd /mod_ssl-2.5.x-1.3.x
d604 1
a604 1
    $ rm -rf mod_ssl-2.5.x-1.3.x
@


1.3
log
@mod_ssl 2.4.9 merge
@
text
@d40 1
a40 1
      Version:      2.4.x
d45 1
a45 1
      Tarball:      mod_ssl-2.4.x-1.3.x.tar.gz
d130 1
a130 1
     $ gzip -d -c mod_ssl-2.4.x-1.3.x.tar.gz | tar xvf -                   ALL
d234 1
a234 1
        $ cd mod_ssl-2.4.x-1.3.x                                           ALL
d307 1
a307 1
        $ cd mod_ssl-2.4.x-1.3.x                                           ALL
d381 1
a381 1
        $ cd mod_ssl-2.4.x-1.3.x                                           ALL
d440 1
a440 1
       $ netscape http://www.modssl.org/docs/2.4/                 (official)
d467 1
a467 1
    $ cd mod_ssl-2.4.x-1.3.x                                               ALL
d507 1
a507 1
    $ gzip -d -c mod_ssl-2.4.x-1.3.x.tar.gz | tar xvf -
d511 1
a511 1
    $ cd mod_ssl-2.4.x-1.3.x
d544 1
a544 1
    $ rm -rf mod_ssl-2.4.x-1.3.x
d562 1
a562 1
    $ gzip -d -c mod_ssl-2.4.x-1.3.x.tar.gz | tar xvf -
d566 1
a566 1
    $ cd /mod_ssl-2.4.x-1.3.x
d604 1
a604 1
    $ rm -rf mod_ssl-2.4.x-1.3.x
@


1.2
log
@add makefile.bsd-wrapper
@
text
@d66 1
a66 3
      Distribution: ftp://ftp.replay.com/pub/crypto/crypto/LIBS/rsa/
                    ftp://utopia.hacktic.nl/pub/replay/pub/crypto/LIBS/rsa/
                    Or ask http://ftpsearch.lycos.com/ for "rsaref20.tar.Z" !!
d177 5
a181 4
           command line. For instance you can add some command line options
           (like `-DSSL_FORBID_ENULL' for not allowing Null encryptions, etc)
           to adjust the OpenSSL internals (see OpenSSL's top-level Makefile
           for details).
d273 1
a273 1
              configuration line in OpenSSL's `Configure' script.  The the
d351 1
a351 1
              configuration line in OpenSSL's `Configure' script.  The the
@


1.1
log
@mod_ssl-2.2.3-1.3.4 (will require libssl-1.1 for https to work, but
mostly harmless otherwise).
@
text
@d2 4
a5 4
   _ __ ___   ___   __| |    ___ ___| |  
  | '_ ` _ \ / _ \ / _` |   / __/ __| |  
  | | | | | | (_) | (_| |   \__ \__ \ |  mod_ssl - Apache Interface to SSLeay  
  |_| |_| |_|\___/ \__,_|___|___/___/_|  http://www.engelschall.com/sw/mod_ssl/
d26 1
a26 1
  To use mod_ssl you need at least the following two packages:
d30 2
a31 1
      Description:  Apache Group HTTP Server
d37 1
d40 6
a45 5
      Version:      2.2.x
      Description:  Apache Interface to SSLeay
      Homepage:     http://www.engelschall.com/sw/mod_ssl/
      Distribution: ftp://ftp.engelschall.com/sw/mod_ssl/
      Tarball:      mod_ssl-2.2.x-1.3.x.tar.gz
d48 1
d50 1
a50 4
  If you have the SSLeay package not already installed on your system you
  additionally need the following package:

   o  Package:      SSLeay
d52 8
a59 11
      Description:  SSL Toolkit 
      Homepage:     http://www.ssleay.org/
      Distribution: ftp://ftp.psy.uq.oz.au/pub/Crypto/SSL/
      Tarball:      SSLeay-0.9.x.tar.gz
      Location:     Brisbane, Australia
      Author(s):    Eric A. Young <eay@@cryptsoft.com>
                    Tim J. Hudson <tjh@@cryptsoft.com>

  And if you're an US-citizen then you usually need (because of patent
  legalities; but check your personal organisation situation first because
  there are exceptions) also the following package in conjunction with SSLeay:
d64 1
d66 1
a66 1
      Distribution: ftp://ftp.rsa.com/rsaref/ (read the README file there!)
d68 1
d70 1
a70 1
      Location:     USA
d72 1
d74 10
a83 2
  Finally you need the following auxiliary packages already installed (GZip
  for unpacking the above tarballs and Perl when configuring SSLeay):
d88 1
d94 1
d99 1
d105 1
d121 2
d124 96
a219 76
   1. Make sure GZip and Perl are already installed and available through the
      commands `gzip' and `perl' They are needed for unpacking the tarballs
      and for configuring SSLeay.

   2. Extract the required packages:

      $ gzip -d -c apache_1.3.x.tar.gz | tar xvf -                         ALL
      $ gzip -d -c mod_ssl-2.2.x-1.3.x.tar.gz | tar xvf -                  ALL
      $ gzip -d -c SSLeay-0.9.x.tar.gz | tar xvf -                         ALL

      $ mkdir rsaref-2.0                                                    US
      $ (cd rsaref-2.0; gzip -d -c ../rsaref20.tar.Z | tar xvf -)           US

   3. Configure and build the SSLeay library: 
      (When you're an US-citizen you have to build SSLeay in conjunction with
      the RSAref library. Others can ignore the first six commands, of course)

      $ cd rsaref-2.0
      $ cp -rp install/unix local                                           US
      $ cd local                                                            US
      $ make                                                                US
      $ mv rsaref.a librsaref.a                                             US
      $ cd ../..                                                            US

      NOTE: RSAref has some portability problems. Especially it assumes that
            an `unsigned long int' represents a four byte word. One result of
            this bad assumption is that it fails under run-time (not
            compile-time) on platforms/CPUs, like Alphas, where larger integer
            sizes are used by the compiler. For instance when mod_ssl's `make
            certificate' command hangs, you get memory faults or Apache hangs
            when connecting to it through HTTPS, this all indicates that you
            ran into this portability problem.  The solution is to replace the
            `typedef unsigned long int UINT4' in rsaref-2.0/source/global.h,
            line 26. The best is to use `typedef u_int32_t UINT4' when
            `u_int32_t' is defined by your vendor include files. If not try to
            use a standard type which is four bytes in length on your
            platform, e.g. on Alphas `typedef unsigned int UINT4' works.

      $ cd SSLeay-0.9.x                                                    ALL
      $ make -f Makefile.ssl links                                         ALL
      $ perl ./Configure gcc \                                             ALL
             -DNO_IDEA \                                                    EU
             -DRSAref -lRSAglue -L`pwd`/../rsaref-2.0/local/ -lrsaref       US
      $ cp rsaref/rsaref.h include/                                         US
      $ make                                                               ALL
      $ make test                                                     OPTIONAL
      $ cd ..                                                              ALL

      NOTE: SSLeay understands a lot more options on the `Configure'
            command line. For instance you can (AND SHOULD!) replace the
            generic `gcc' with your platform name (run `perl Configure'
            without arguments to see a list of supported platforms) to get
            maximum performance (because on some platforms assembler routines
            are used instead of C variants) and platform correctness (some
            platforms don't work with the generic `gcc' build variant).
            Additionally you can add some command line options (like
            `-DSSL_ALLOW_ENULL' for allowing Null encryptions, etc) to adjust
            the SSLeay internals (see SSLeay's Makefile for details).

      NOTE: When your system already has SSLeay installed (for instance some
            Linux distributions ship with SSLeay installed out-of-the-box) in
            system locations you can ignore the SSLeay steps above, too.  Then
            use `SSL_BASE=SYSTEM' instead of `SSL_BASE=../SSLeay-0.9.0b'
            below.

      NOTE: When your system already has RSAref installed in system locations
            you can ignore the RSAref-related steps above and then use
            `RSAREF_BASE=SYSTEM' instead of `RSAREF_BASE=../rsaref-2.0/local'
            above.

      NOTE: You are STRONGLY ADVISES to use SSLeay 0.9.x and not any
            0.8.x version. Because although Apache/mod_ssl compiles fine with
            0.8.x versions there are known runtime problems with SSLeay 0.8.x.
            Especially when transferring large files SSLeay 0.8.x fails
            horrible. So, in your own interest: Use SSLeay 0.9.x, please!
            BTW, TLS v1 support is also available with SSLeay 0.9.x only.
d221 1
a221 1
  4. Now apply the mod_ssl source extension and source patches to the Apache
d223 1
a223 1
     and SSLeay. 
d225 1
a225 1
     Actually here you have three options :
d235 1
a235 1
        $ cd mod_ssl-2.2.x-1.3.x                                           ALL
d238 3
a240 2
              --with-ssleay=../SSLeay-0.9.x \                              ALL
              --with-rsaref=../rsaref-2.0/local \                           US
d247 2
d255 1
a255 1
        $ cd ..
d260 1
a260 1
              more information about DSO support in Apache. I strongly advise
d265 1
a265 1
              Additionally SSLeay has problems under DSO situations on some
d267 1
a267 1
              and FreeBSD when you compile a the standard SSLeay
d270 6
a275 5
              2.6 on a SPARC SSLeay's code will dump core under run-time. When
              this is the case for you, then try to recompile SSLeay with
              Position Independent Code (PIC) by adding a `-fPIC' (for GCC) or
              `-KPIC' (for SVR4-style compilers) to the platform configuration
              line in SSLeay's `Configure' script.
d288 5
d304 3
a306 3
        mod_dav, etc. But you have to provide the SSL_BASE and RSA_BASE
        variables manually and either copy your existing certificate manually
        to conf/ssl.crt/server.crt or use `make certificate':
d308 1
a308 1
        $ cd mod_ssl-2.2.x-1.3.x                                           ALL
d318 1
a318 1
        $ SSL_BASE=../SSLeay-0.9.x \                                       ALL
d320 1
d327 2
d333 1
d338 1
a338 1
              more information about DSO support in Apache. I strongly advise
d343 12
d366 5
d378 3
a380 3
        is done manually. But you have to edit the SSL_BASE and RSA_BASE
        variables manually and more important: you have to install the Apache
        package manually, too. But feel free to be masochistic ;-)
d382 1
a382 1
        $ cd mod_ssl-2.2.x-1.3.x                                           ALL
d396 1
d402 3
a404 3
        Up to this point it can be acceptable. But now the friendly world
        stops. The remaining installation steps have to be done manually by
        coping the various files to /path/to/apache, including your
d408 1
a408 1
  5. Try out Apache without SSL (only HTTP possible):
d414 1
a414 6
     NOTE: Replace the `<local-host-name>' with the official name of your
           host. Do not enter `localhost' here, because this name has to match
           the Common Name (CN) of the Subject's Distinguished Name (DN)
           inside your server certificate.

  6. Try out Apache with SSL (HTTP and HTTPS possible):
d431 4
a434 1
  7. Finally you're advised to do the following:
d436 3
a438 1
     o Read the mod_ssl documentation very carefully to
d441 1
a441 1
       $ netscape http://www.engelschall.com/sw/mod_ssl/docs/2.2/   (official)
d444 6
a449 1
     o Adjust your Apache configuration to your personal requirements:
d453 2
a454 1
     o Subscribe to the sw-mod-ssl support mailing list:
d456 1
a456 4
       $ netscape http://www.engelschall.com/sw/mod_ssl/news/list.html
       $ echo "subscribe sw-mod-ssl <addr>" | mutt -s '' majordomo@@engelschall.com

       NOTE: Replace `<addr>' with your official Email address!!
d465 1
a465 1
  long as the Extended API (EAPI) didn't change and you've SSLeay installed
d468 8
a475 8
    $ cd mod_ssl-2.2.x-1.3.x                                           ALL
    $ ./configure \                                                    ALL
          --with-apxs[=/path/to/apache/sbin/apxs] \                    ALL
          --with-ssleay=/path/to/ssleay \                              ALL
          --with-rsaref=/path/to/rsaref                                 US
    $ make                                                             ALL
    $ make install                                                     ALL
    $ make distclean                                                   ALL
d494 1
a494 1
  o Apache + mod_ssl/SSLeay + mod_perl/Perl
d501 1
a501 1
    o SSLeay is installed under /path/to/ssleay
d508 1
a508 1
    $ gzip -d -c mod_ssl-2.2.x-1.3.x.tar.gz | tar xvf -
d512 1
a512 1
    $ cd mod_ssl-2.2.x-1.3.x
d532 1
a532 1
    $ SSL_BASE=/path/to/ssleay 
d545 1
a545 1
    $ rm -rf mod_ssl-2.2.x-1.3.x
d548 2
a549 2
  o Apache + mod_ssl/SSLeay + PHP3/MySQL
    ------------------------------------
d555 1
a555 1
    o SSLeay is installed under /path/to/ssleay
d563 1
a563 1
    $ gzip -d -c mod_ssl-2.2.x-1.3.x.tar.gz | tar xvf -
d567 1
a567 1
    $ cd /mod_ssl-2.2.x-1.3.x
d580 1
a580 1
    $ CFLAGS='-O2 -I/path/to/ssleay/include' \
d592 1
a592 1
    $ SSL_BASE=/path/to/ssleay \
d605 1
a605 1
    $ rm -rf mod_ssl-2.2.x-1.3.x
@


1.1.1.1
log
@import apache 1.3.27 and mod_ssl 2.8.11
@
text
@d2 4
a5 4
   _ __ ___   ___   __| |    ___ ___| |  mod_ssl
  | '_ ` _ \ / _ \ / _` |   / __/ __| |  Apache Interface to OpenSSL
  | | | | | | (_) | (_| |   \__ \__ \ |  www.modssl.org
  |_| |_| |_|\___/ \__,_|___|___/___/_|  ftp.modssl.org
d26 1
a26 1
  To use mod_ssl you need the following packages:
d30 1
a30 2
      Description:  The Apache Group HTTP Server
      Reason:       The webserver base package on which all is based
d32 1
a32 1
      Distribution: http://www.apache.org/dist/
a35 1
      Type:         MANDATORY
d38 5
a42 6
      Version:      2.8.x
      Description:  The Apache Interface to OpenSSL
      Reason:       The interface module for Apache
      Homepage:     http://www.modssl.org/
      Distribution: ftp://ftp.modssl.org/source/
      Tarball:      mod_ssl-2.8.x-1.3.x.tar.gz
a44 1
      Type:         MANDATORY
d46 4
a49 1
   o  Package:      OpenSSL
d51 21
a71 8
      Description:  The Open Source Toolkit for SSL/TLS
      Reason:       The library which implements SSL/TLS
      Homepage:     http://www.openssl.org/
      Distribution: ftp://ftp.openssl.org/source/
      Tarball:      openssl-0.9.x.tar.gz
      Location:     Zurich, Switzerland, Europe
      Author(s):    The OpenSSL Project <openssl@@openssl.org>
      Type:         MANDATORY 
d73 2
a74 10
   o  Package:      MM
      Version:      1.1.x
      Description:  Shared Memory Library
      Reason:       The portable library for shared memory in Apache/EAPI
      Homepage:     http://www.engelschall.com/sw/mm/
      Distribution: http://www.engelschall.com/sw/mm/
      Tarball:      mm-1.1.x.tar.gz
      Location:     Zurich, Switzerland, Europe
      Author(s):    Ralf S. Engelschall <rse@@engelschall.com>
      Type:         OPTIONAL
a78 1
      Reason:       To unpack the above tarballs
a83 1
      Type:         MANDATORY
d86 1
a86 1
      Version:      5.6.0
a87 1
      Reason:       To configure OpenSSL and for APXS tool in Apache
d89 2
a90 2
      Distribution: http://www.cpan.org/src/5.0/
      Tarball:      perl-5.6.0.tar.gz
a92 1
      Type:         MANDATORY
d102 1
a107 2
  (the syntax is for a Bourne-Shell style shell, when you're using a C-Shell
  style shell you've to adjust the commands according to your shell's manual)
d109 76
a184 72
  1. Make sure GZip and Perl are already installed and available through the
     commands `gzip' and `perl'. They are needed for unpacking the tarballs
     and for configuring OpenSSL. When you've these packages still not
     installed, do this first.

  2. Extract the required packages:

     $ gzip -d -c apache_1.3.x.tar.gz | tar xvf -                          ALL
     $ gzip -d -c mod_ssl-2.8.x-1.3.x.tar.gz | tar xvf -                   ALL
     $ gzip -d -c openssl-0.9.x.tar.gz | tar xvf -                         ALL
     $ gzip -d -c mm-1.1.x.tar.gz | tar xvf -                         OPTIONAL

  3. Configure and build the OpenSSL library: 

     $ cd openssl-0.9.x                                                    ALL
     $ sh config \                                                         ALL
            no-idea \                                                       EU
            no-threads \                                              OPTIONAL
            -fPIC                                                     OPTIONAL
     $ make                                                                ALL
     $ make test                                                      OPTIONAL
     $ cd ..                                                               ALL

     NOTE: OpenSSL understands a lot more options on the `config'
           command line. For instance you can add some command line
           options (like `-DSSL_FORBID_ENULL' for not allowing Null
           encryptions, or adding `-DSSL_ALLOW_ADH' for allowing
           Anonymous Diffie-Hellman ciphers, etc) to adjust the OpenSSL
           internals (see OpenSSL's top-level Makefile for details).

     NOTE: When your system already has OpenSSL installed (for instance some
           Linux distributions ship with OpenSSL installed out-of-the-box) in
           system locations you can ignore the OpenSSL steps above, too.  Then
           use `SSL_BASE=SYSTEM' instead of `SSL_BASE=../openssl-0.9.x' below
           and mod_ssl will search for OpenSSL's binary, header and library
           files in $PATH and system locations.

     NOTE: The -fPIC option builds OpenSSL with Position Independent Code
           (PIC) which is only important when building mod_ssl as a
           Dynamic Shared Object (DSO). Please notice, that you really
           have to use -fPIC and not -fpic, as the latter will usually
           cause the build to fail. See below for more details.

     NOTE: The optional `no-threads' keyword above is to increase
           performance inside OpenSSL, because Apache 1.3 does not
           use threads anyway. However, OpenSSL, if built without
           `no-threads', by default builds with multi-threading support.
           This multi-threading support involves using locking around a
           lot of internal object manipulation (esp. reference counts).
           The fact that it is not possible in Apache 1.3 to have
           threads racing on any kind of object internal to OpenSSL
           means that any overhead (memory and/or time) relating to
           these locking mechanisms is wasted by default.

  4. Optionally you now can build the MM Shared Memory library when you want
     shared memory support in Apache/EAPI. For instance this allows mod_ssl to
     use a high-performance RAM-based session cache instead of a disk-based
     one.

     $ cd mm-1.1.x                                                    OPTIONAL
     $ ./configure --disable-shared                                   OPTIONAL
     $ make                                                           OPTIONAL
     $ cd ..                                                          OPTIONAL

     NOTE: When your system already has MM installed in system locations
           you can ignore the steps above and then use `EAPI_MM=SYSTEM'
           instead of `EAPI_MM=../mm-1.1.x' below.

     NOTE: Do not forget the --disable-shared option above. Else you've
           to establish an explicit LD_LIBRARY_PATH which includes the
           /path/to/mm-1.1.x/.libs/ directory or the compilation of Apache
           will fail because the shared library cannot be found.
d186 1
a186 1
  5. Now apply the mod_ssl source extension and source patches to the Apache
d188 1
a188 1
     and OpenSSL. 
d190 1
a190 1
     Actually here you have three options: 
d196 3
a198 3
        `configure' script. You don't have to fiddle with the SSL_BASE
        variable but get no intermediate chance to add more third-party
        Apache modules (e.g. mod_perl, PHP3, etc).
d200 1
a200 1
        $ cd mod_ssl-2.8.x-1.3.x                                           ALL
d203 2
a204 2
              --with-ssl=../openssl-0.9.x \                                ALL
              --with-mm=../mm-1.1.x \                                 OPTIONAL
a210 2
             [--enable-rule=SSL_EXPERIMENTAL] \                       OPTIONAL
             [--enable-rule=SSL_VENDOR] \                             OPTIONAL
d217 1
a217 1
        $ cd ..                                                            ALL
d222 1
a222 1
              more information about DSO support in Apache. We strongly advise
d227 1
a227 1
              Additionally OpenSSL has problems under DSO situations on some
d229 1
a229 1
              and FreeBSD when you compile a the standard OpenSSL
d232 5
a236 6
              2.6 on a SPARC OpenSSL's code will dump core under run-time.
              When this is the case for you, then try to recompile OpenSSL
              with Position Independent Code (PIC) by adding a `-fPIC' (for
              GCC) or `-KPIC' (for SVR4-style compilers) to the platform
              configuration line in OpenSSL's `Configure' script.  The
              -fPIC option above when you build OpenSSL.
a248 5
        NOTE: The --enable-rule=SSL_EXPERIMENTAL and --enable-rule=SSL_VENDOR
              options enable various experimental and vendor extension code.
              Please read the src/Configuration.tmpl file inside the Apache
              source tree for more details.

d258 5
a262 6
        You configure Apache manually and have the chance to configure
        and add third-party Apache modules like mod_perl, mod_php,
        mod_frontpage, mod_dav, etc. But you have to provide the
        SSL_BASE and EAPI_MM variables manually and either copy your
        existing certificate manually to conf/ssl.crt/server.crt or use
        `make certificate':
d264 1
a264 1
        $ cd mod_ssl-2.8.x-1.3.x                                           ALL
d274 2
a275 2
        $ SSL_BASE=../openssl-0.9.x \                                      ALL
          EAPI_MM=../mm-1.1.x \                                       OPTIONAL
a281 2
             [--enable-rule=SSL_EXPERIMENTAL] \                       OPTIONAL
             [--enable-rule=SSL_VENDOR] \                             OPTIONAL
a285 1
        $ cd ..                                                            ALL
d290 1
a290 1
              more information about DSO support in Apache. We strongly advise
a294 12
              Additionally OpenSSL has problems under DSO situations on some
              platforms. For instance under smart ix86 platforms like Linux
              and FreeBSD when you compile a the standard OpenSSL
              libcrypto.a/libssl.a libraries and link those to a mod_ssl DSO
              libssl.so all works fine.  While on other platforms like Solaris
              2.6 on a SPARC OpenSSL's code will dump core under run-time.
              When this is the case for you, then try to recompile OpenSSL
              with Position Independent Code (PIC) by adding a `-fPIC' (for
              GCC) or `-KPIC' (for SVR4-style compilers) to the platform
              configuration line in OpenSSL's `Configure' script.  The
              -fPIC option above when you build OpenSSL.

a305 5
        NOTE: The --enable-rule=SSL_EXPERIMENTAL and --enable-rule=SSL_VENDOR
              options enable various experimental and vendor extension code.
              Please read the src/Configuration.tmpl file inside the Apache
              source tree for more details.

d308 8
a315 9
        You configure Apache manually by editing the src/Configuration
        file and running the deep-level src/Configure script. The
        advantage here is that this directly follows the steps you might
        be familiar with from Apache 1.2 and additionally you also have
        a chance to add more third-party Apache modules like mod_perl or
        mod_php because anything is done manually. But you have to edit
        the SSL_BASE and EAPI_MM variables manually and more important:
        you have to install the Apache package manually, too. But feel
        free to be masochistic ;-)
d317 1
a317 1
        $ cd mod_ssl-2.8.x-1.3.x                                           ALL
d330 1
a330 1
        [...edit the EAPI_MM variable...]                             OPTIONAL
d336 3
a338 3
        Up to this point it can be acceptable, yeah? But now the friendly
        world stops. The remaining installation steps have to be done manually
        by coping the various files to /path/to/apache, including your
d342 1
a342 1
  6. Try out Apache without SSL (only HTTP protocol possible):
d344 1
a344 1
     $ /path/to/apache/bin/apachectl start                                 ALL
d346 1
a346 1
     $ /path/to/apache/bin/apachectl stop                                  ALL
d348 4
a351 1
  7. Try out Apache with SSL (both HTTP and HTTPS protocol possible):
d353 6
a358 4
     $ /path/to/apache/bin/apachectl startssl                              ALL
     $ netscape http://<local-host-name><http-port>/                       ALL
     $ netscape https://<local-host-name><https-port>/                     ALL
     $ /path/to/apache/bin/apachectl stop                                  ALL
a364 12
     NOTE: If you have built and installed under root (uid 0), 
           leave out the the `<http-port>' and `<https-port>' strings above.
           If you have built and installed under a different user than root,
           replace `<http-port>' with `:8080' and `<https-port>' with `:8443'
           above. The reason just is that Apache pre-configures the installed
           configuration file for direct use (at least as long the APACI
           option --without-confadjust is not used). For using the official
           ports (80 for HTTP and 443 for HTTPS) root priviledges are required
           under run-time, so APACI assumes that it has to use alternate ports
           (8080 for HTTP and 8443 for HTTPS) if the built and installation is
           done under non-root users.

d370 1
a370 4
     NOTE: When you *re*install Apache many times, make sure you restart your
           browsers between the tests if you created test or custom
           certificates.  Else connections might fail because the browser
           cached the certificate details of the previous installation.
d372 1
a372 3
  8. Finally you're advised to do the following:

     o Read the mod_ssl user manual very carefully to
d375 1
a375 1
       $ netscape http://www.modssl.org/docs/2.8/                 (official)
d378 1
a378 6
     o Adjust your Apache configuration to your personal requirements.
       The configuration is already pre-configured for SSL, but usually it has
       to be tweaked a little bit more to fit the local situation. When you
       had already a httpd.conf file, this one is preserved. Then look inside
       /path/to/apache/etc/httpd.conf.default for the pre-configured SSL
       configuration and take it over manually into httpd.conf.
d382 1
a382 2
     o Subscribe to the modssl-users@@modssl.org support mailing list
       with the provided web interface:
d384 4
a387 1
       $ netscape http://www.modssl.org/news/list.html
d396 1
a396 1
  long as the Extended API (EAPI) didn't change and you've OpenSSL installed
d399 8
a406 7
    $ cd mod_ssl-2.8.x-1.3.x                                               ALL
    $ ./configure \                                                        ALL
          --with-apxs[=/path/to/apache/bin/apxs] \                         ALL
          --with-ssl=/path/to/openssl                                      ALL
    $ make                                                                 ALL
    $ make install                                                         ALL
    $ make distclean                                                       ALL
d425 1
a425 1
  o Apache + mod_ssl/OpenSSL + mod_perl/Perl
d432 2
a433 1
    o OpenSSL is installed under /path/to/openssl
d439 1
a439 1
    $ gzip -d -c mod_ssl-2.8.x-1.3.x.tar.gz | tar xvf -
d443 1
a443 1
    $ cd mod_ssl-2.8.x-1.3.x
d463 1
a463 1
    $ SSL_BASE=/path/to/openssl \
d476 1
a476 1
    $ rm -rf mod_ssl-2.8.x-1.3.x
d479 2
a480 2
  o Apache + mod_ssl/OpenSSL + PHP3/MySQL
    -------------------------------------
d486 2
a487 1
    o OpenSSL is installed under /path/to/openssl
d494 1
a494 1
    $ gzip -d -c mod_ssl-2.8.x-1.3.x.tar.gz | tar xvf -
d498 1
a498 1
    $ cd /mod_ssl-2.8.x-1.3.x
d511 1
a511 1
    $ CFLAGS='-O2 -I/path/to/openssl/include' \
d523 1
a523 1
    $ SSL_BASE=/path/to/openssl \
d536 1
a536 1
    $ rm -rf mod_ssl-2.8.x-1.3.x
@


